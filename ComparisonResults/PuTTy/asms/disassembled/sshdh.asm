.data:00000000 ;
.data:00000000 ; +-------------------------------------------------------------------------+
.data:00000000 ; |   This file has been generated by The Interactive Disassembler (IDA)    |
.data:00000000 ; |           Copyright (c) 2015 Hex-Rays, <support@hex-rays.com>           |
.data:00000000 ; |                      License info: 48-3677-7074-51                      |
.data:00000000 ; |             Michalis Polychronakis, Stony Brook University              |
.data:00000000 ; +-------------------------------------------------------------------------+
.data:00000000 ;
.data:00000000 ; Input MD5   : 36A974F423C7E7C25887AC3B011DE129
.data:00000000 ; Input CRC32 : ED60B83F
.data:00000000
.data:00000000 ; File Name   : C:\workspace\Putty\windows\VS2010\putty\Debug\sshdh.obj
.data:00000000 ; Format      : COFF (X386MAGIC)
.data:00000000 ; includelib "LIBCMTD"
.data:00000000 ; includelib "OLDNAMES"
.data:00000000
.data:00000000                 .686p
.data:00000000                 .mmx
.data:00000000                 .model flat
.data:00000000 .intel_syntax noprefix
.data:00000000
.data:00000000 ; ===========================================================================
.data:00000000
.data:00000000 ; Segment type: Pure data
.data:00000000 ; Segment permissions: Read/Write
.data:00000000 _data           segment dword public 'DATA' use32
.data:00000000                 assume cs:_data
.data:00000000 $SG5911         db 'diffie-hellman-group1-sha1',0
.data:00000000                                         ; DATA XREF: .rdata:_ssh_diffiehellman_group1_sha1o
.data:0000001B                 align 4
.data:0000001C $SG5912         db 'group1',0           ; DATA XREF: .rdata:0000025Co
.data:00000023                 align 4
.data:00000024 $SG5915         db 'diffie-hellman-group14-sha1',0
.data:00000024                                         ; DATA XREF: .rdata:_ssh_diffiehellman_group14_sha1o
.data:00000040 $SG5916         db 'group14',0          ; DATA XREF: .rdata:00000288o
.data:00000048 $SG5919         db 'diffie-hellman-group-exchange-sha256',0
.data:00000048                                         ; DATA XREF: .rdata:_ssh_diffiehellman_gex_sha256o
.data:0000006D                 align 10h
.data:00000070 $SG5924         db 'diffie-hellman-group-exchange-sha1',0
.data:00000070                                         ; DATA XREF: .rdata:_ssh_diffiehellman_gex_sha1o
.data:00000093                 align 4
.data:00000094 $SG5996         db 'f value received is too small',0
.data:00000094                                         ; DATA XREF: _dh_validate_f+38o
.data:000000B2                 align 4
.data:000000B4 $SG6001         db 'f value received is too large',0
.data:000000B4                                         ; DATA XREF: _dh_validate_f+7Eo
.data:000000D2                 align 4
.data:000000D2 _data           ends
.data:000000D2
.rdata:000000D4 ; ===========================================================================
.rdata:000000D4
.rdata:000000D4 ; Segment type: Pure data
.rdata:000000D4 ; Segment permissions: Read
.rdata:000000D4 ; Segment alignment 'qword' can not be represented in assembly
.rdata:000000D4 _rdata          segment para public 'DATA' use32
.rdata:000000D4                 assume cs:_rdata
.rdata:000000D4                 ;org 0D4h
.rdata:000000D4 _P1             db 0FFh                 ; DATA XREF: .rdata:00000264o
.rdata:000000D5                 db 0FFh
.rdata:000000D6                 db 0FFh
.rdata:000000D7                 db 0FFh
.rdata:000000D8                 db 0FFh
.rdata:000000D9                 db 0FFh
.rdata:000000DA                 db 0FFh
.rdata:000000DB                 db 0FFh
.rdata:000000DC                 db 0C9h ; +
.rdata:000000DD                 db  0Fh
.rdata:000000DE                 db 0DAh ; +
.rdata:000000DF                 db 0A2h ; ó
.rdata:000000E0                 db  21h ; !
.rdata:000000E1                 db  68h ; h
.rdata:000000E2                 db 0C2h ; -
.rdata:000000E3                 db  34h ; 4
.rdata:000000E4                 db 0C4h ; -
.rdata:000000E5                 db 0C6h ; ¦
.rdata:000000E6                 db  62h ; b
.rdata:000000E7                 db  8Bh ; ï
.rdata:000000E8                 db  80h ; Ç
.rdata:000000E9                 db 0DCh ; _
.rdata:000000EA                 db  1Ch
.rdata:000000EB                 db 0D1h ; -
.rdata:000000EC                 db  29h ; )
.rdata:000000ED                 db    2
.rdata:000000EE                 db  4Eh ; N
.rdata:000000EF                 db    8
.rdata:000000F0                 db  8Ah ; è
.rdata:000000F1                 db  67h ; g
.rdata:000000F2                 db 0CCh ; ¦
.rdata:000000F3                 db  74h ; t
.rdata:000000F4                 db    2
.rdata:000000F5                 db  0Bh
.rdata:000000F6                 db 0BEh ; +
.rdata:000000F7                 db 0A6h ; ª
.rdata:000000F8                 db  3Bh ; ;
.rdata:000000F9                 db  13h
.rdata:000000FA                 db  9Bh ; ¢
.rdata:000000FB                 db  22h ; "
.rdata:000000FC                 db  51h ; Q
.rdata:000000FD                 db  4Ah ; J
.rdata:000000FE                 db    8
.rdata:000000FF                 db  79h ; y
.rdata:00000100 unk_100         db  8Eh ; Ä             ; DATA XREF: .rdata:00000298o
.rdata:00000101                 db  34h ; 4
.rdata:00000102                 db    4
.rdata:00000103                 db 0DDh ; ¦
.rdata:00000104                 db 0EFh ; n
.rdata:00000105                 db  95h ; ò
.rdata:00000106                 db  19h
.rdata:00000107                 db 0B3h ; ¦
.rdata:00000108                 db 0CDh ; -
.rdata:00000109                 db  3Ah ; :
.rdata:0000010A                 db  43h ; C
.rdata:0000010B                 db  1Bh
.rdata:0000010C                 db  30h ; 0
.rdata:0000010D                 db  2Bh ; +
.rdata:0000010E                 db  0Ah
.rdata:0000010F                 db  6Dh ; m
.rdata:00000110                 db 0F2h ; =
.rdata:00000111                 db  5Fh ; _
.rdata:00000112                 db  14h
.rdata:00000113                 db  37h ; 7
.rdata:00000114                 db  4Fh ; O
.rdata:00000115                 db 0E1h ; ß
.rdata:00000116                 db  35h ; 5
.rdata:00000117                 db  6Dh ; m
.rdata:00000118                 db  6Dh ; m
.rdata:00000119                 db  51h ; Q
.rdata:0000011A                 db 0C2h ; -
.rdata:0000011B                 db  45h ; E
.rdata:0000011C                 db 0E4h ; S
.rdata:0000011D                 db  85h ; à
.rdata:0000011E                 db 0B5h ; ¦
.rdata:0000011F                 db  76h ; v
.rdata:00000120                 db  62h ; b
.rdata:00000121                 db  5Eh ; ^
.rdata:00000122                 db  7Eh ; ~
.rdata:00000123                 db 0C6h ; ¦
.rdata:00000124                 db 0F4h ; (
.rdata:00000125                 db  4Ch ; L
.rdata:00000126                 db  42h ; B
.rdata:00000127                 db 0E9h ; T
.rdata:00000128                 db 0A6h ; ª
.rdata:00000129                 db  37h ; 7
.rdata:0000012A                 db 0EDh ; f
.rdata:0000012B                 db  6Bh ; k
.rdata:0000012C                 db  0Bh
.rdata:0000012D                 db 0FFh
.rdata:0000012E                 db  5Ch ; \
.rdata:0000012F                 db 0B6h ; ¦
.rdata:00000130                 db 0F4h ; (
.rdata:00000131                 db    6
.rdata:00000132                 db 0B7h ; +
.rdata:00000133                 db 0EDh ; f
.rdata:00000134                 db 0EEh ; e
.rdata:00000135                 db  38h ; 8
.rdata:00000136                 db  6Bh ; k
.rdata:00000137                 db 0FBh ; v
.rdata:00000138                 db  5Ah ; Z
.rdata:00000139                 db  89h ; ë
.rdata:0000013A                 db  9Fh ; ƒ
.rdata:0000013B                 db 0A5h ; Ñ
.rdata:0000013C                 db 0AEh ; «
.rdata:0000013D                 db  9Fh ; ƒ
.rdata:0000013E                 db  24h ; $
.rdata:0000013F                 db  11h
.rdata:00000140                 db  7Ch ; |
.rdata:00000141                 db  4Bh ; K
.rdata:00000142                 db  1Fh
.rdata:00000143                 db 0E6h ; µ
.rdata:00000144                 db  49h ; I
.rdata:00000145                 db  28h ; (
.rdata:00000146                 db  66h ; f
.rdata:00000147                 db  51h ; Q
.rdata:00000148                 db 0ECh ; 8
.rdata:00000149                 db 0E6h ; µ
.rdata:0000014A                 db  53h ; S
.rdata:0000014B                 db  81h ; ü
.rdata:0000014C                 db 0FFh
.rdata:0000014D                 db 0FFh
.rdata:0000014E                 db 0FFh
.rdata:0000014F                 db 0FFh
.rdata:00000150                 db 0FFh
.rdata:00000151                 db 0FFh
.rdata:00000152                 db 0FFh
.rdata:00000153                 db 0FFh
.rdata:00000154 _P14            db 0FFh                 ; DATA XREF: .rdata:00000290o
.rdata:00000155                 db 0FFh
.rdata:00000156                 db 0FFh
.rdata:00000157                 db 0FFh
.rdata:00000158                 db 0FFh
.rdata:00000159                 db 0FFh
.rdata:0000015A                 db 0FFh
.rdata:0000015B                 db 0FFh
.rdata:0000015C                 db 0C9h ; +
.rdata:0000015D                 db  0Fh
.rdata:0000015E                 db 0DAh ; +
.rdata:0000015F                 db 0A2h ; ó
.rdata:00000160                 db  21h ; !
.rdata:00000161                 db  68h ; h
.rdata:00000162                 db 0C2h ; -
.rdata:00000163                 db  34h ; 4
.rdata:00000164                 db 0C4h ; -
.rdata:00000165                 db 0C6h ; ¦
.rdata:00000166                 db  62h ; b
.rdata:00000167                 db  8Bh ; ï
.rdata:00000168                 db  80h ; Ç
.rdata:00000169                 db 0DCh ; _
.rdata:0000016A                 db  1Ch
.rdata:0000016B                 db 0D1h ; -
.rdata:0000016C                 db  29h ; )
.rdata:0000016D                 db    2
.rdata:0000016E                 db  4Eh ; N
.rdata:0000016F                 db    8
.rdata:00000170                 db  8Ah ; è
.rdata:00000171                 db  67h ; g
.rdata:00000172                 db 0CCh ; ¦
.rdata:00000173                 db  74h ; t
.rdata:00000174                 db    2
.rdata:00000175                 db  0Bh
.rdata:00000176                 db 0BEh ; +
.rdata:00000177                 db 0A6h ; ª
.rdata:00000178                 db  3Bh ; ;
.rdata:00000179                 db  13h
.rdata:0000017A                 db  9Bh ; ¢
.rdata:0000017B                 db  22h ; "
.rdata:0000017C                 db  51h ; Q
.rdata:0000017D                 db  4Ah ; J
.rdata:0000017E                 db    8
.rdata:0000017F                 db  79h ; y
.rdata:00000180                 db  8Eh ; Ä
.rdata:00000181                 db  34h ; 4
.rdata:00000182                 db    4
.rdata:00000183                 db 0DDh ; ¦
.rdata:00000184                 db 0EFh ; n
.rdata:00000185                 db  95h ; ò
.rdata:00000186                 db  19h
.rdata:00000187                 db 0B3h ; ¦
.rdata:00000188                 db 0CDh ; -
.rdata:00000189                 db  3Ah ; :
.rdata:0000018A                 db  43h ; C
.rdata:0000018B                 db  1Bh
.rdata:0000018C                 db  30h ; 0
.rdata:0000018D                 db  2Bh ; +
.rdata:0000018E                 db  0Ah
.rdata:0000018F                 db  6Dh ; m
.rdata:00000190                 db 0F2h ; =
.rdata:00000191                 db  5Fh ; _
.rdata:00000192                 db  14h
.rdata:00000193                 db  37h ; 7
.rdata:00000194                 db  4Fh ; O
.rdata:00000195                 db 0E1h ; ß
.rdata:00000196                 db  35h ; 5
.rdata:00000197                 db  6Dh ; m
.rdata:00000198                 db  6Dh ; m
.rdata:00000199                 db  51h ; Q
.rdata:0000019A                 db 0C2h ; -
.rdata:0000019B                 db  45h ; E
.rdata:0000019C                 db 0E4h ; S
.rdata:0000019D                 db  85h ; à
.rdata:0000019E                 db 0B5h ; ¦
.rdata:0000019F                 db  76h ; v
.rdata:000001A0                 db  62h ; b
.rdata:000001A1                 db  5Eh ; ^
.rdata:000001A2                 db  7Eh ; ~
.rdata:000001A3                 db 0C6h ; ¦
.rdata:000001A4                 db 0F4h ; (
.rdata:000001A5                 db  4Ch ; L
.rdata:000001A6                 db  42h ; B
.rdata:000001A7                 db 0E9h ; T
.rdata:000001A8                 db 0A6h ; ª
.rdata:000001A9                 db  37h ; 7
.rdata:000001AA                 db 0EDh ; f
.rdata:000001AB                 db  6Bh ; k
.rdata:000001AC                 db  0Bh
.rdata:000001AD                 db 0FFh
.rdata:000001AE                 db  5Ch ; \
.rdata:000001AF                 db 0B6h ; ¦
.rdata:000001B0                 db 0F4h ; (
.rdata:000001B1                 db    6
.rdata:000001B2                 db 0B7h ; +
.rdata:000001B3                 db 0EDh ; f
.rdata:000001B4                 db 0EEh ; e
.rdata:000001B5                 db  38h ; 8
.rdata:000001B6                 db  6Bh ; k
.rdata:000001B7                 db 0FBh ; v
.rdata:000001B8                 db  5Ah ; Z
.rdata:000001B9                 db  89h ; ë
.rdata:000001BA                 db  9Fh ; ƒ
.rdata:000001BB                 db 0A5h ; Ñ
.rdata:000001BC                 db 0AEh ; «
.rdata:000001BD                 db  9Fh ; ƒ
.rdata:000001BE                 db  24h ; $
.rdata:000001BF                 db  11h
.rdata:000001C0                 db  7Ch ; |
.rdata:000001C1                 db  4Bh ; K
.rdata:000001C2                 db  1Fh
.rdata:000001C3                 db 0E6h ; µ
.rdata:000001C4                 db  49h ; I
.rdata:000001C5                 db  28h ; (
.rdata:000001C6                 db  66h ; f
.rdata:000001C7                 db  51h ; Q
.rdata:000001C8                 db 0ECh ; 8
.rdata:000001C9                 db 0E4h ; S
.rdata:000001CA                 db  5Bh ; [
.rdata:000001CB                 db  3Dh ; =
.rdata:000001CC                 db 0C2h ; -
.rdata:000001CD                 db    0
.rdata:000001CE                 db  7Ch ; |
.rdata:000001CF                 db 0B8h ; +
.rdata:000001D0                 db 0A1h ; í
.rdata:000001D1                 db  63h ; c
.rdata:000001D2                 db 0BFh ; +
.rdata:000001D3                 db    5
.rdata:000001D4                 db  98h ; ÿ
.rdata:000001D5                 db 0DAh ; +
.rdata:000001D6                 db  48h ; H
.rdata:000001D7                 db  36h ; 6
.rdata:000001D8                 db  1Ch
.rdata:000001D9                 db  55h ; U
.rdata:000001DA                 db 0D3h ; +
.rdata:000001DB                 db  9Ah ; Ü
.rdata:000001DC                 db  69h ; i
.rdata:000001DD                 db  16h
.rdata:000001DE                 db  3Fh ; ?
.rdata:000001DF                 db 0A8h ; ¿
.rdata:000001E0                 db 0FDh ; ²
.rdata:000001E1                 db  24h ; $
.rdata:000001E2                 db 0CFh ; -
.rdata:000001E3                 db  5Fh ; _
.rdata:000001E4                 db  83h ; â
.rdata:000001E5                 db  65h ; e
.rdata:000001E6                 db  5Dh ; ]
.rdata:000001E7                 db  23h ; #
.rdata:000001E8                 db 0DCh ; _
.rdata:000001E9                 db 0A3h ; ú
.rdata:000001EA                 db 0ADh ; ¡
.rdata:000001EB                 db  96h ; û
.rdata:000001EC                 db  1Ch
.rdata:000001ED                 db  62h ; b
.rdata:000001EE                 db 0F3h ; =
.rdata:000001EF                 db  56h ; V
.rdata:000001F0                 db  20h
.rdata:000001F1                 db  85h ; à
.rdata:000001F2                 db  52h ; R
.rdata:000001F3                 db 0BBh ; +
.rdata:000001F4                 db  9Eh ; P
.rdata:000001F5                 db 0D5h ; +
.rdata:000001F6                 db  29h ; )
.rdata:000001F7                 db    7
.rdata:000001F8                 db  70h ; p
.rdata:000001F9                 db  96h ; û
.rdata:000001FA                 db  96h ; û
.rdata:000001FB                 db  6Dh ; m
.rdata:000001FC                 db  67h ; g
.rdata:000001FD                 db  0Ch
.rdata:000001FE                 db  35h ; 5
.rdata:000001FF                 db  4Eh ; N
.rdata:00000200                 db  4Ah ; J
.rdata:00000201                 db 0BCh ; +
.rdata:00000202                 db  98h ; ÿ
.rdata:00000203                 db    4
.rdata:00000204                 db 0F1h ; ±
.rdata:00000205                 db  74h ; t
.rdata:00000206                 db  6Ch ; l
.rdata:00000207                 db    8
.rdata:00000208                 db 0CAh ; -
.rdata:00000209                 db  18h
.rdata:0000020A                 db  21h ; !
.rdata:0000020B                 db  7Ch ; |
.rdata:0000020C                 db  32h ; 2
.rdata:0000020D                 db  90h ; É
.rdata:0000020E                 db  5Eh ; ^
.rdata:0000020F                 db  46h ; F
.rdata:00000210                 db  2Eh ; .
.rdata:00000211                 db  36h ; 6
.rdata:00000212                 db 0CEh ; +
.rdata:00000213                 db  3Bh ; ;
.rdata:00000214                 db 0E3h ; p
.rdata:00000215                 db  9Eh ; P
.rdata:00000216                 db  77h ; w
.rdata:00000217                 db  2Ch ; ,
.rdata:00000218                 db  18h
.rdata:00000219                 db  0Eh
.rdata:0000021A                 db  86h ; å
.rdata:0000021B                 db    3
.rdata:0000021C                 db  9Bh ; ¢
.rdata:0000021D                 db  27h ; '
.rdata:0000021E                 db  83h ; â
.rdata:0000021F                 db 0A2h ; ó
.rdata:00000220                 db 0ECh ; 8
.rdata:00000221                 db    7
.rdata:00000222                 db 0A2h ; ó
.rdata:00000223                 db  8Fh ; Å
.rdata:00000224                 db 0B5h ; ¦
.rdata:00000225                 db 0C5h ; +
.rdata:00000226                 db  5Dh ; ]
.rdata:00000227                 db 0F0h ; =
.rdata:00000228                 db  6Fh ; o
.rdata:00000229                 db  4Ch ; L
.rdata:0000022A                 db  52h ; R
.rdata:0000022B                 db 0C9h ; +
.rdata:0000022C                 db 0DEh ; ¦
.rdata:0000022D                 db  2Bh ; +
.rdata:0000022E                 db 0CBh ; -
.rdata:0000022F                 db 0F6h ; ÷
.rdata:00000230                 db  95h ; ò
.rdata:00000231                 db  58h ; X
.rdata:00000232                 db  17h
.rdata:00000233                 db  18h
.rdata:00000234                 db  39h ; 9
.rdata:00000235                 db  95h ; ò
.rdata:00000236                 db  49h ; I
.rdata:00000237                 db  7Ch ; |
.rdata:00000238                 db 0EAh ; O
.rdata:00000239                 db  95h ; ò
.rdata:0000023A                 db  6Ah ; j
.rdata:0000023B                 db 0E5h ; s
.rdata:0000023C                 db  15h
.rdata:0000023D                 db 0D2h ; -
.rdata:0000023E                 db  26h ; &
.rdata:0000023F                 db  18h
.rdata:00000240                 db  98h ; ÿ
.rdata:00000241                 db 0FAh ; ·
.rdata:00000242                 db    5
.rdata:00000243                 db  10h
.rdata:00000244                 db  15h
.rdata:00000245                 db  72h ; r
.rdata:00000246                 db  8Eh ; Ä
.rdata:00000247                 db  5Ah ; Z
.rdata:00000248                 db  8Ah ; è
.rdata:00000249                 db 0ACh ; ¼
.rdata:0000024A                 db 0AAh ; ¬
.rdata:0000024B                 db  68h ; h
.rdata:0000024C                 db 0FFh
.rdata:0000024D                 db 0FFh
.rdata:0000024E                 db 0FFh
.rdata:0000024F                 db 0FFh
.rdata:00000250                 db 0FFh
.rdata:00000251                 db 0FFh
.rdata:00000252                 db 0FFh
.rdata:00000253                 db 0FFh
.rdata:00000254 _G              db    2                 ; DATA XREF: .rdata:00000268o
.rdata:00000254                                         ; .rdata:00000294o
.rdata:00000255                 db    0
.rdata:00000256                 db    0
.rdata:00000257                 db    0
.rdata:00000258 _ssh_diffiehellman_group1_sha1 dd offset $SG5911
.rdata:00000258                                         ; DATA XREF: .rdata:_group1_listo
.rdata:00000258                                         ; "diffie-hellman-group1-sha1"
.rdata:0000025C                 dd offset $SG5912       ; "group1"
.rdata:00000260                 db    0
.rdata:00000261                 db    0
.rdata:00000262                 db    0
.rdata:00000263                 db    0
.rdata:00000264                 dd offset _P1
.rdata:00000268                 dd offset _G
.rdata:0000026C                 dd offset $SG5924+10h   ; "roup-exchange-sha1"
.rdata:00000270                 db    1
.rdata:00000271                 db    0
.rdata:00000272                 db    0
.rdata:00000273                 db    0
.rdata:00000274                 dd offset _ssh_sha1
.rdata:00000278 _group1_list    dd offset _ssh_diffiehellman_group1_sha1
.rdata:00000278                                         ; DATA XREF: .rdata:00000280o
.rdata:0000027C                 public _ssh_diffiehellman_group1
.rdata:0000027C _ssh_diffiehellman_group1 db    1
.rdata:0000027D                 db    0
.rdata:0000027E                 db    0
.rdata:0000027F                 db    0
.rdata:00000280                 dd offset _group1_list
.rdata:00000284 _ssh_diffiehellman_group14_sha1 dd offset $SG5915
.rdata:00000284                                         ; DATA XREF: .rdata:_group14_listo
.rdata:00000284                                         ; "diffie-hellman-group14-sha1"
.rdata:00000288                 dd offset $SG5916       ; "group14"
.rdata:0000028C                 align 10h
.rdata:00000290                 dd offset _P14
.rdata:00000294                 dd offset _G
.rdata:00000298                 dd offset unk_100
.rdata:0000029C                 db    1
.rdata:0000029D                 db    0
.rdata:0000029E                 db    0
.rdata:0000029F                 db    0
.rdata:000002A0                 dd offset _ssh_sha1
.rdata:000002A4 _group14_list   dd offset _ssh_diffiehellman_group14_sha1
.rdata:000002A4                                         ; DATA XREF: .rdata:000002ACo
.rdata:000002A8                 public _ssh_diffiehellman_group14
.rdata:000002A8 _ssh_diffiehellman_group14 db    1
.rdata:000002A9                 db    0
.rdata:000002AA                 db    0
.rdata:000002AB                 db    0
.rdata:000002AC                 dd offset _group14_list
.rdata:000002B0 _ssh_diffiehellman_gex_sha256 dd offset $SG5919
.rdata:000002B0                                         ; DATA XREF: .rdata:_gex_listo
.rdata:000002B0                                         ; "diffie-hellman-group-exchange-sha256"
.rdata:000002B4                 db    0
.rdata:000002B5                 db    0
.rdata:000002B6                 db    0
.rdata:000002B7                 db    0
.rdata:000002B8                 db    0
.rdata:000002B9                 db    0
.rdata:000002BA                 db    0
.rdata:000002BB                 db    0
.rdata:000002BC                 db    0
.rdata:000002BD                 db    0
.rdata:000002BE                 db    0
.rdata:000002BF                 db    0
.rdata:000002C0                 db    0
.rdata:000002C1                 db    0
.rdata:000002C2                 db    0
.rdata:000002C3                 db    0
.rdata:000002C4                 db    0
.rdata:000002C5                 db    0
.rdata:000002C6                 db    0
.rdata:000002C7                 db    0
.rdata:000002C8                 db    0
.rdata:000002C9                 db    0
.rdata:000002CA                 db    0
.rdata:000002CB                 db    0
.rdata:000002CC                 dd offset _ssh_sha256
.rdata:000002D0 _ssh_diffiehellman_gex_sha1 dd offset $SG5924 ; DATA XREF: .rdata:000002F4o
.rdata:000002D0                                         ; "diffie-hellman-group-exchange-sha1"
.rdata:000002D4                 db    0
.rdata:000002D5                 db    0
.rdata:000002D6                 db    0
.rdata:000002D7                 db    0
.rdata:000002D8                 db    0
.rdata:000002D9                 db    0
.rdata:000002DA                 db    0
.rdata:000002DB                 db    0
.rdata:000002DC                 db    0
.rdata:000002DD                 db    0
.rdata:000002DE                 db    0
.rdata:000002DF                 db    0
.rdata:000002E0                 db    0
.rdata:000002E1                 db    0
.rdata:000002E2                 db    0
.rdata:000002E3                 db    0
.rdata:000002E4                 db    0
.rdata:000002E5                 db    0
.rdata:000002E6                 db    0
.rdata:000002E7                 db    0
.rdata:000002E8                 db    0
.rdata:000002E9                 db    0
.rdata:000002EA                 db    0
.rdata:000002EB                 db    0
.rdata:000002EC                 dd offset _ssh_sha1
.rdata:000002F0 _gex_list       dd offset _ssh_diffiehellman_gex_sha256
.rdata:000002F0                                         ; DATA XREF: .rdata:000002FCo
.rdata:000002F4                 dd offset _ssh_diffiehellman_gex_sha1
.rdata:000002F8                 public _ssh_diffiehellman_gex
.rdata:000002F8 _ssh_diffiehellman_gex db    2
.rdata:000002F9                 db    0
.rdata:000002FA                 db    0
.rdata:000002FB                 db    0
.rdata:000002FC                 dd offset _gex_list
.rdata:000002FC _rdata          ends
.rdata:000002FC
.text:00000300 ; ===========================================================================
.text:00000300
.text:00000300 ; Segment type: Pure code
.text:00000300 ; Segment permissions: Read/Execute
.text:00000300 _text           segment para public 'CODE' use32
.text:00000300                 assume cs:_text
.text:00000300                 ;org 300h
.text:00000300                 assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
.text:00000300
.text:00000300 ; =============== S U B R O U T I N E =======================================
.text:00000300
.text:00000300 ; Attributes: bp-based frame
.text:00000300
.text:00000300                 public _dh_setup_group
.text:00000300 _dh_setup_group proc near
.text:00000300
.text:00000300 var_4           = dword ptr -4
.text:00000300 arg_0           = dword ptr  8
.text:00000300
.text:00000300                 push    ebp
.text:00000301                 mov     ebp, esp
.text:00000303                 push    ecx
.text:00000304                 mov     [ebp+var_4], 0CCCCCCCCh
.text:0000030B                 push    18h
.text:0000030D                 push    1
.text:0000030F                 call    _safemalloc
.text:00000314                 add     esp, 8
.text:00000317                 mov     [ebp+var_4], eax
.text:0000031A                 mov     eax, [ebp+arg_0]
.text:0000031D                 mov     ecx, [eax+14h]
.text:00000320                 push    ecx
.text:00000321                 mov     edx, [ebp+arg_0]
.text:00000324                 mov     eax, [edx+0Ch]
.text:00000327                 push    eax
.text:00000328                 call    _bignum_from_bytes
.text:0000032D                 add     esp, 8
.text:00000330                 mov     ecx, [ebp+var_4]
.text:00000333                 mov     [ecx+8], eax
.text:00000336                 mov     edx, [ebp+arg_0]
.text:00000339                 mov     eax, [edx+18h]
.text:0000033C                 push    eax
.text:0000033D                 mov     ecx, [ebp+arg_0]
.text:00000340                 mov     edx, [ecx+10h]
.text:00000343                 push    edx
.text:00000344                 call    _bignum_from_bytes
.text:00000349                 add     esp, 8
.text:0000034C                 mov     ecx, [ebp+var_4]
.text:0000034F                 mov     [ecx+14h], eax
.text:00000352                 mov     edx, [ebp+var_4]
.text:00000355                 push    edx
.text:00000356                 call    _dh_init
.text:0000035B                 add     esp, 4
.text:0000035E                 mov     eax, [ebp+var_4]
.text:00000361                 add     esp, 4
.text:00000364                 cmp     ebp, esp
.text:00000366                 call    __RTC_CheckEsp
.text:0000036B                 mov     esp, ebp
.text:0000036D                 pop     ebp
.text:0000036E                 retn
.text:0000036E _dh_setup_group endp
.text:0000036E
.text:0000036E ; ---------------------------------------------------------------------------
.text:0000036F                 align 10h
.text:00000370
.text:00000370 ; =============== S U B R O U T I N E =======================================
.text:00000370
.text:00000370 ; Attributes: bp-based frame
.text:00000370
.text:00000370 _dh_init        proc near               ; CODE XREF: _dh_setup_group+56p
.text:00000370                                         ; _dh_setup_gex+42p
.text:00000370
.text:00000370 arg_0           = dword ptr  8
.text:00000370
.text:00000370                 push    ebp
.text:00000371                 mov     ebp, esp
.text:00000373                 push    1
.text:00000375                 mov     eax, [ebp+arg_0]
.text:00000378                 mov     ecx, [eax+8]
.text:0000037B                 push    ecx
.text:0000037C                 call    _bignum_rshift
.text:00000381                 add     esp, 8
.text:00000384                 mov     edx, [ebp+arg_0]
.text:00000387                 mov     [edx+0Ch], eax
.text:0000038A                 mov     eax, [ebp+arg_0]
.text:0000038D                 mov     ecx, [eax+0Ch]
.text:00000390                 push    ecx
.text:00000391                 call    _bignum_bitmask
.text:00000396                 add     esp, 4
.text:00000399                 mov     edx, [ebp+arg_0]
.text:0000039C                 mov     [edx+10h], eax
.text:0000039F                 mov     eax, [ebp+arg_0]
.text:000003A2                 mov     dword ptr [eax+4], 0
.text:000003A9                 mov     ecx, [ebp+arg_0]
.text:000003AC                 mov     dword ptr [ecx], 0
.text:000003B2                 cmp     ebp, esp
.text:000003B4                 call    __RTC_CheckEsp
.text:000003B9                 pop     ebp
.text:000003BA                 retn
.text:000003BA _dh_init        endp
.text:000003BA
.text:000003BA ; ---------------------------------------------------------------------------
.text:000003BB                 align 10h
.text:000003C0
.text:000003C0 ; =============== S U B R O U T I N E =======================================
.text:000003C0
.text:000003C0 ; Attributes: bp-based frame
.text:000003C0
.text:000003C0                 public _dh_setup_gex
.text:000003C0 _dh_setup_gex   proc near
.text:000003C0
.text:000003C0 var_4           = dword ptr -4
.text:000003C0 arg_0           = dword ptr  8
.text:000003C0 arg_4           = dword ptr  0Ch
.text:000003C0
.text:000003C0                 push    ebp
.text:000003C1                 mov     ebp, esp
.text:000003C3                 push    ecx
.text:000003C4                 mov     [ebp+var_4], 0CCCCCCCCh
.text:000003CB                 push    18h
.text:000003CD                 push    1
.text:000003CF                 call    _safemalloc
.text:000003D4                 add     esp, 8
.text:000003D7                 mov     [ebp+var_4], eax
.text:000003DA                 mov     eax, [ebp+arg_0]
.text:000003DD                 push    eax
.text:000003DE                 call    _copybn
.text:000003E3                 add     esp, 4
.text:000003E6                 mov     ecx, [ebp+var_4]
.text:000003E9                 mov     [ecx+8], eax
.text:000003EC                 mov     edx, [ebp+arg_4]
.text:000003EF                 push    edx
.text:000003F0                 call    _copybn
.text:000003F5                 add     esp, 4
.text:000003F8                 mov     ecx, [ebp+var_4]
.text:000003FB                 mov     [ecx+14h], eax
.text:000003FE                 mov     edx, [ebp+var_4]
.text:00000401                 push    edx
.text:00000402                 call    _dh_init
.text:00000407                 add     esp, 4
.text:0000040A                 mov     eax, [ebp+var_4]
.text:0000040D                 add     esp, 4
.text:00000410                 cmp     ebp, esp
.text:00000412                 call    __RTC_CheckEsp
.text:00000417                 mov     esp, ebp
.text:00000419                 pop     ebp
.text:0000041A                 retn
.text:0000041A _dh_setup_gex   endp
.text:0000041A
.text:0000041A ; ---------------------------------------------------------------------------
.text:0000041B                 align 10h
.text:00000420
.text:00000420 ; =============== S U B R O U T I N E =======================================
.text:00000420
.text:00000420 ; Attributes: bp-based frame
.text:00000420
.text:00000420                 public _dh_cleanup
.text:00000420 _dh_cleanup     proc near
.text:00000420
.text:00000420 var_4           = dword ptr -4
.text:00000420 arg_0           = dword ptr  8
.text:00000420
.text:00000420                 push    ebp
.text:00000421                 mov     ebp, esp
.text:00000423                 push    ecx
.text:00000424                 mov     [ebp+var_4], 0CCCCCCCCh
.text:0000042B                 mov     eax, [ebp+arg_0]
.text:0000042E                 mov     [ebp+var_4], eax
.text:00000431                 mov     ecx, [ebp+var_4]
.text:00000434                 mov     edx, [ecx]
.text:00000436                 push    edx
.text:00000437                 call    _freebn
.text:0000043C                 add     esp, 4
.text:0000043F                 mov     eax, [ebp+var_4]
.text:00000442                 mov     ecx, [eax+4]
.text:00000445                 push    ecx
.text:00000446                 call    _freebn
.text:0000044B                 add     esp, 4
.text:0000044E                 mov     edx, [ebp+var_4]
.text:00000451                 mov     eax, [edx+8]
.text:00000454                 push    eax
.text:00000455                 call    _freebn
.text:0000045A                 add     esp, 4
.text:0000045D                 mov     ecx, [ebp+var_4]
.text:00000460                 mov     edx, [ecx+14h]
.text:00000463                 push    edx
.text:00000464                 call    _freebn
.text:00000469                 add     esp, 4
.text:0000046C                 mov     eax, [ebp+var_4]
.text:0000046F                 mov     ecx, [eax+0Ch]
.text:00000472                 push    ecx
.text:00000473                 call    _freebn
.text:00000478                 add     esp, 4
.text:0000047B                 mov     edx, [ebp+var_4]
.text:0000047E                 mov     eax, [edx+10h]
.text:00000481                 push    eax
.text:00000482                 call    _freebn
.text:00000487                 add     esp, 4
.text:0000048A                 mov     ecx, [ebp+var_4]
.text:0000048D                 push    ecx
.text:0000048E                 call    _safefree
.text:00000493                 add     esp, 4
.text:00000496                 add     esp, 4
.text:00000499                 cmp     ebp, esp
.text:0000049B                 call    __RTC_CheckEsp
.text:000004A0                 mov     esp, ebp
.text:000004A2                 pop     ebp
.text:000004A3                 retn
.text:000004A3 _dh_cleanup     endp
.text:000004A3
.text:000004A3 ; ---------------------------------------------------------------------------
.text:000004A4                 align 10h
.text:000004B0
.text:000004B0 ; =============== S U B R O U T I N E =======================================
.text:000004B0
.text:000004B0 ; Attributes: bp-based frame
.text:000004B0
.text:000004B0                 public _dh_create_e
.text:000004B0 _dh_create_e    proc near
.text:000004B0
.text:000004B0 var_18          = dword ptr -18h
.text:000004B0 var_14          = dword ptr -14h
.text:000004B0 var_10          = dword ptr -10h
.text:000004B0 var_C           = dword ptr -0Ch
.text:000004B0 var_8           = dword ptr -8
.text:000004B0 var_4           = dword ptr -4
.text:000004B0 arg_0           = dword ptr  8
.text:000004B0 arg_4           = dword ptr  0Ch
.text:000004B0
.text:000004B0                 push    ebp
.text:000004B1                 mov     ebp, esp
.text:000004B3                 sub     esp, 18h
.text:000004B6                 mov     eax, 0CCCCCCCCh
.text:000004BB                 mov     [ebp+var_18], eax
.text:000004BE                 mov     [ebp+var_14], eax
.text:000004C1                 mov     [ebp+var_10], eax
.text:000004C4                 mov     [ebp+var_C], eax
.text:000004C7                 mov     [ebp+var_8], eax
.text:000004CA                 mov     [ebp+var_4], eax
.text:000004CD                 mov     eax, [ebp+arg_0]
.text:000004D0                 mov     [ebp+var_4], eax
.text:000004D3                 mov     ecx, [ebp+var_4]
.text:000004D6                 mov     edx, [ecx+10h]
.text:000004D9                 push    edx
.text:000004DA                 call    _ssh1_bignum_length
.text:000004DF                 add     esp, 4
.text:000004E2                 mov     [ebp+var_C], eax
.text:000004E5                 push    1
.text:000004E7                 mov     eax, [ebp+var_C]
.text:000004EA                 push    eax
.text:000004EB                 call    _safemalloc
.text:000004F0                 add     esp, 8
.text:000004F3                 mov     [ebp+var_10], eax
.text:000004F6
.text:000004F6 loc_4F6:                                ; CODE XREF: _dh_create_e+163j
.text:000004F6                                         ; _dh_create_e+180j
.text:000004F6                 mov     ecx, [ebp+var_4]
.text:000004F9                 cmp     dword ptr [ecx], 0
.text:000004FC                 jz      short loc_50C
.text:000004FE                 mov     edx, [ebp+var_4]
.text:00000501                 mov     eax, [edx]
.text:00000503                 push    eax
.text:00000504                 call    _freebn
.text:00000509                 add     esp, 4
.text:0000050C
.text:0000050C loc_50C:                                ; CODE XREF: _dh_create_e+4Cj
.text:0000050C                 cmp     [ebp+arg_4], 0
.text:00000510                 jz      short loc_526
.text:00000512                 mov     ecx, [ebp+var_4]
.text:00000515                 mov     edx, [ecx+10h]
.text:00000518                 push    edx
.text:00000519                 call    _bignum_bitcount
.text:0000051E                 add     esp, 4
.text:00000521                 cmp     [ebp+arg_4], eax
.text:00000524                 jle     short loc_583
.text:00000526
.text:00000526 loc_526:                                ; CODE XREF: _dh_create_e+60j
.text:00000526                 mov     eax, [ebp+var_4]
.text:00000529                 mov     ecx, [eax+10h]
.text:0000052C                 push    ecx
.text:0000052D                 mov     edx, [ebp+var_10]
.text:00000530                 push    edx
.text:00000531                 call    _ssh1_write_bignum
.text:00000536                 add     esp, 8
.text:00000539                 mov     [ebp+var_8], 2
.text:00000540                 jmp     short loc_54B
.text:00000542 ; ---------------------------------------------------------------------------
.text:00000542
.text:00000542 loc_542:                                ; CODE XREF: _dh_create_e+BBj
.text:00000542                 mov     eax, [ebp+var_8]
.text:00000545                 add     eax, 1
.text:00000548                 mov     [ebp+var_8], eax
.text:0000054B
.text:0000054B loc_54B:                                ; CODE XREF: _dh_create_e+90j
.text:0000054B                 mov     ecx, [ebp+var_8]
.text:0000054E                 cmp     ecx, [ebp+var_C]
.text:00000551                 jge     short loc_56D
.text:00000553                 call    _random_byte
.text:00000558                 mov     edx, [ebp+var_10]
.text:0000055B                 add     edx, [ebp+var_8]
.text:0000055E                 movzx   ecx, byte ptr [edx]
.text:00000561                 and     ecx, eax
.text:00000563                 mov     edx, [ebp+var_10]
.text:00000566                 add     edx, [ebp+var_8]
.text:00000569                 mov     [edx], cl
.text:0000056B                 jmp     short loc_542
.text:0000056D ; ---------------------------------------------------------------------------
.text:0000056D
.text:0000056D loc_56D:                                ; CODE XREF: _dh_create_e+A1j
.text:0000056D                 mov     eax, [ebp+var_4]
.text:00000570                 push    eax
.text:00000571                 mov     ecx, [ebp+var_C]
.text:00000574                 push    ecx
.text:00000575                 mov     edx, [ebp+var_10]
.text:00000578                 push    edx
.text:00000579                 call    _ssh1_read_bignum
.text:0000057E                 add     esp, 0Ch
.text:00000581                 jmp     short loc_5FC
.text:00000583 ; ---------------------------------------------------------------------------
.text:00000583
.text:00000583 loc_583:                                ; CODE XREF: _dh_create_e+74j
.text:00000583                 mov     eax, [ebp+arg_4]
.text:00000586                 push    eax
.text:00000587                 call    _bn_power_2
.text:0000058C                 add     esp, 4
.text:0000058F                 mov     ecx, [ebp+var_4]
.text:00000592                 mov     [ecx], eax
.text:00000594                 mov     [ebp+var_18], 0
.text:0000059B                 mov     edx, [ebp+var_18]
.text:0000059E                 mov     [ebp+var_14], edx
.text:000005A1                 mov     [ebp+var_8], 0
.text:000005A8                 jmp     short loc_5B3
.text:000005AA ; ---------------------------------------------------------------------------
.text:000005AA
.text:000005AA loc_5AA:                                ; CODE XREF: _dh_create_e+14Aj
.text:000005AA                 mov     eax, [ebp+var_8]
.text:000005AD                 add     eax, 1
.text:000005B0                 mov     [ebp+var_8], eax
.text:000005B3
.text:000005B3 loc_5B3:                                ; CODE XREF: _dh_create_e+F8j
.text:000005B3                 mov     ecx, [ebp+var_8]
.text:000005B6                 cmp     ecx, [ebp+arg_4]
.text:000005B9                 jge     short loc_5FC
.text:000005BB                 cmp     [ebp+var_18], 0
.text:000005BF                 jnz     short loc_5D0
.text:000005C1                 mov     [ebp+var_18], 8
.text:000005C8                 call    _random_byte
.text:000005CD                 mov     [ebp+var_14], eax
.text:000005D0
.text:000005D0 loc_5D0:                                ; CODE XREF: _dh_create_e+10Fj
.text:000005D0                 mov     edx, [ebp+var_14]
.text:000005D3                 and     edx, 1
.text:000005D6                 push    edx
.text:000005D7                 mov     eax, [ebp+var_8]
.text:000005DA                 push    eax
.text:000005DB                 mov     ecx, [ebp+var_4]
.text:000005DE                 mov     edx, [ecx]
.text:000005E0                 push    edx
.text:000005E1                 call    _bignum_set_bit
.text:000005E6                 add     esp, 0Ch
.text:000005E9                 mov     eax, [ebp+var_14]
.text:000005EC                 sar     eax, 1
.text:000005EE                 mov     [ebp+var_14], eax
.text:000005F1                 mov     ecx, [ebp+var_18]
.text:000005F4                 sub     ecx, 1
.text:000005F7                 mov     [ebp+var_18], ecx
.text:000005FA                 jmp     short loc_5AA
.text:000005FC ; ---------------------------------------------------------------------------
.text:000005FC
.text:000005FC loc_5FC:                                ; CODE XREF: _dh_create_e+D1j
.text:000005FC                                         ; _dh_create_e+109j
.text:000005FC                 mov     edx, dword ptr ds:_One
.text:00000602                 push    edx
.text:00000603                 mov     eax, [ebp+var_4]
.text:00000606                 mov     ecx, [eax]
.text:00000608                 push    ecx
.text:00000609                 call    _bignum_cmp
.text:0000060E                 add     esp, 8
.text:00000611                 test    eax, eax
.text:00000613                 jle     loc_4F6
.text:00000619                 mov     edx, [ebp+var_4]
.text:0000061C                 mov     eax, [edx+0Ch]
.text:0000061F                 push    eax
.text:00000620                 mov     ecx, [ebp+var_4]
.text:00000623                 mov     edx, [ecx]
.text:00000625                 push    edx
.text:00000626                 call    _bignum_cmp
.text:0000062B                 add     esp, 8
.text:0000062E                 test    eax, eax
.text:00000630                 jge     loc_4F6
.text:00000636                 mov     eax, [ebp+var_10]
.text:00000639                 push    eax
.text:0000063A                 call    _safefree
.text:0000063F                 add     esp, 4
.text:00000642                 mov     ecx, [ebp+var_4]
.text:00000645                 mov     edx, [ecx+8]
.text:00000648                 push    edx
.text:00000649                 mov     eax, [ebp+var_4]
.text:0000064C                 mov     ecx, [eax]
.text:0000064E                 push    ecx
.text:0000064F                 mov     edx, [ebp+var_4]
.text:00000652                 mov     eax, [edx+14h]
.text:00000655                 push    eax
.text:00000656                 call    _modpow
.text:0000065B                 add     esp, 0Ch
.text:0000065E                 mov     ecx, [ebp+var_4]
.text:00000661                 mov     [ecx+4], eax
.text:00000664                 mov     edx, [ebp+var_4]
.text:00000667                 mov     eax, [edx+4]
.text:0000066A                 add     esp, 18h
.text:0000066D                 cmp     ebp, esp
.text:0000066F                 call    __RTC_CheckEsp
.text:00000674                 mov     esp, ebp
.text:00000676                 pop     ebp
.text:00000677                 retn
.text:00000677 _dh_create_e    endp
.text:00000677
.text:00000677 ; ---------------------------------------------------------------------------
.text:00000678                 align 10h
.text:00000680
.text:00000680 ; =============== S U B R O U T I N E =======================================
.text:00000680
.text:00000680 ; Attributes: bp-based frame
.text:00000680
.text:00000680                 public _dh_validate_f
.text:00000680 _dh_validate_f  proc near
.text:00000680
.text:00000680 var_C           = dword ptr -0Ch
.text:00000680 var_8           = dword ptr -8
.text:00000680 var_4           = dword ptr -4
.text:00000680 arg_0           = dword ptr  8
.text:00000680 arg_4           = dword ptr  0Ch
.text:00000680
.text:00000680                 push    ebp
.text:00000681                 mov     ebp, esp
.text:00000683                 sub     esp, 0Ch
.text:00000686                 mov     [ebp+var_C], 0CCCCCCCCh
.text:0000068D                 mov     [ebp+var_8], 0CCCCCCCCh
.text:00000694                 mov     [ebp+var_4], 0CCCCCCCCh
.text:0000069B                 mov     eax, [ebp+arg_0]
.text:0000069E                 mov     [ebp+var_4], eax
.text:000006A1                 mov     ecx, dword ptr ds:_One
.text:000006A7                 push    ecx
.text:000006A8                 mov     edx, [ebp+arg_4]
.text:000006AB                 push    edx
.text:000006AC                 call    _bignum_cmp
.text:000006B1                 add     esp, 8
.text:000006B4                 test    eax, eax
.text:000006B6                 jg      short loc_6C1
.text:000006B8                 mov     eax, offset $SG5996 ; "f value received is too small"
.text:000006BD                 jmp     short loc_707
.text:000006BF ; ---------------------------------------------------------------------------
.text:000006BF                 jmp     short loc_705
.text:000006C1 ; ---------------------------------------------------------------------------
.text:000006C1
.text:000006C1 loc_6C1:                                ; CODE XREF: _dh_validate_f+36j
.text:000006C1                 mov     eax, dword ptr ds:_One
.text:000006C6                 push    eax
.text:000006C7                 mov     ecx, [ebp+var_4]
.text:000006CA                 mov     edx, [ecx+8]
.text:000006CD                 push    edx
.text:000006CE                 call    _bigsub
.text:000006D3                 add     esp, 8
.text:000006D6                 mov     [ebp+var_8], eax
.text:000006D9                 mov     eax, [ebp+var_8]
.text:000006DC                 push    eax
.text:000006DD                 mov     ecx, [ebp+arg_4]
.text:000006E0                 push    ecx
.text:000006E1                 call    _bignum_cmp
.text:000006E6                 add     esp, 8
.text:000006E9                 mov     [ebp+var_C], eax
.text:000006EC                 mov     edx, [ebp+var_8]
.text:000006EF                 push    edx
.text:000006F0                 call    _freebn
.text:000006F5                 add     esp, 4
.text:000006F8                 cmp     [ebp+var_C], 0
.text:000006FC                 jl      short loc_705
.text:000006FE                 mov     eax, offset $SG6001 ; "f value received is too large"
.text:00000703                 jmp     short loc_707
.text:00000705 ; ---------------------------------------------------------------------------
.text:00000705
.text:00000705 loc_705:                                ; CODE XREF: _dh_validate_f+3Fj
.text:00000705                                         ; _dh_validate_f+7Cj
.text:00000705                 xor     eax, eax
.text:00000707
.text:00000707 loc_707:                                ; CODE XREF: _dh_validate_f+3Dj
.text:00000707                                         ; _dh_validate_f+83j
.text:00000707                 add     esp, 0Ch
.text:0000070A                 cmp     ebp, esp
.text:0000070C                 call    __RTC_CheckEsp
.text:00000711                 mov     esp, ebp
.text:00000713                 pop     ebp
.text:00000714                 retn
.text:00000714 _dh_validate_f  endp
.text:00000714
.text:00000714 ; ---------------------------------------------------------------------------
.text:00000715                 align 10h
.text:00000720
.text:00000720 ; =============== S U B R O U T I N E =======================================
.text:00000720
.text:00000720 ; Attributes: bp-based frame
.text:00000720
.text:00000720                 public _dh_find_K
.text:00000720 _dh_find_K      proc near
.text:00000720
.text:00000720 var_8           = dword ptr -8
.text:00000720 var_4           = dword ptr -4
.text:00000720 arg_0           = dword ptr  8
.text:00000720 arg_4           = dword ptr  0Ch
.text:00000720
.text:00000720                 push    ebp
.text:00000721                 mov     ebp, esp
.text:00000723                 sub     esp, 8
.text:00000726                 mov     [ebp+var_8], 0CCCCCCCCh
.text:0000072D                 mov     [ebp+var_4], 0CCCCCCCCh
.text:00000734                 mov     eax, [ebp+arg_0]
.text:00000737                 mov     [ebp+var_4], eax
.text:0000073A                 mov     ecx, [ebp+var_4]
.text:0000073D                 mov     edx, [ecx+8]
.text:00000740                 push    edx
.text:00000741                 mov     eax, [ebp+var_4]
.text:00000744                 mov     ecx, [eax]
.text:00000746                 push    ecx
.text:00000747                 mov     edx, [ebp+arg_4]
.text:0000074A                 push    edx
.text:0000074B                 call    _modpow
.text:00000750                 add     esp, 0Ch
.text:00000753                 mov     [ebp+var_8], eax
.text:00000756                 mov     eax, [ebp+var_8]
.text:00000759                 add     esp, 8
.text:0000075C                 cmp     ebp, esp
.text:0000075E                 call    __RTC_CheckEsp
.text:00000763                 mov     esp, ebp
.text:00000765                 pop     ebp
.text:00000766                 retn
.text:00000766 _dh_find_K      endp
.text:00000766
.text:00000766 ; ---------------------------------------------------------------------------
.text:00000767                 align 4
.text:00000767 _text           ends
.text:00000767
.rtc$TMZ:00000768 ; ===========================================================================
.rtc$TMZ:00000768
.rtc$TMZ:00000768 ; Segment type: Pure data
.rtc$TMZ:00000768 ; Segment permissions: Read
.rtc$TMZ:00000768 _rtc$TMZ        segment dword public 'DATA' use32
.rtc$TMZ:00000768                 assume cs:_rtc$TMZ
.rtc$TMZ:00000768                 ;org 768h
.rtc$TMZ:00000768 ; COMDAT (pick any)
.rtc$TMZ:00000768 __RTC_Shutdown_rtc$TMZ dd offset __RTC_Shutdown
.rtc$TMZ:00000768 _rtc$TMZ        ends
.rtc$TMZ:00000768
.rtc$IMZ:0000076C ; ===========================================================================
.rtc$IMZ:0000076C
.rtc$IMZ:0000076C ; Segment type: Pure data
.rtc$IMZ:0000076C ; Segment permissions: Read
.rtc$IMZ:0000076C _rtc$IMZ        segment dword public 'DATA' use32
.rtc$IMZ:0000076C                 assume cs:_rtc$IMZ
.rtc$IMZ:0000076C                 ;org 76Ch
.rtc$IMZ:0000076C ; COMDAT (pick any)
.rtc$IMZ:0000076C __RTC_InitBase_rtc$IMZ dd offset __RTC_InitBase
.rtc$IMZ:0000076C _rtc$IMZ        ends
.rtc$IMZ:0000076C
UNDEF:00000770 ; ===========================================================================
UNDEF:00000770
UNDEF:00000770 ; Segment type: Externs
UNDEF:00000770 ; UNDEF
UNDEF:00000770                 extrn _ssh_sha256:near  ; DATA XREF: .rdata:000002CCo
UNDEF:00000774                 extrn _ssh_sha1:near    ; DATA XREF: .rdata:00000274o
UNDEF:00000774                                         ; .rdata:000002A0o ...
UNDEF:00000778                 extrn _bignum_from_bytes:near
UNDEF:00000778                                         ; CODE XREF: _dh_setup_group+28p
UNDEF:00000778                                         ; _dh_setup_group+44p
UNDEF:0000077C                 extrn _safemalloc:near  ; CODE XREF: _dh_setup_group+Fp
UNDEF:0000077C                                         ; _dh_setup_gex+Fp ...
UNDEF:00000780                 extrn __RTC_CheckEsp:near ; CODE XREF: _dh_setup_group+66p
UNDEF:00000780                                         ; _dh_init+44p ...
UNDEF:00000784                 extrn __RTC_Shutdown:near
UNDEF:00000784                                         ; DATA XREF: .rtc$TMZ:__RTC_Shutdown_rtc$TMZo
UNDEF:00000788                 extrn __RTC_InitBase:near
UNDEF:00000788                                         ; DATA XREF: .rtc$IMZ:__RTC_InitBase_rtc$IMZo
UNDEF:0000078C                 extrn _bignum_bitmask:near ; CODE XREF: _dh_init+21p
UNDEF:00000790                 extrn _bignum_rshift:near ; CODE XREF: _dh_init+Cp
UNDEF:00000794                 extrn _copybn:near      ; CODE XREF: _dh_setup_gex+1Ep
UNDEF:00000794                                         ; _dh_setup_gex+30p
UNDEF:00000798                 extrn _safefree:near    ; CODE XREF: _dh_cleanup+6Ep
UNDEF:00000798                                         ; _dh_create_e+18Ap
UNDEF:0000079C                 extrn _freebn:near      ; CODE XREF: _dh_cleanup+17p
UNDEF:0000079C                                         ; _dh_cleanup+26p ...
UNDEF:000007A0                 extrn _modpow:near      ; CODE XREF: _dh_create_e+1A6p
UNDEF:000007A0                                         ; _dh_find_K+2Bp
UNDEF:000007A4                 extrn _bignum_cmp:near  ; CODE XREF: _dh_create_e+159p
UNDEF:000007A4                                         ; _dh_create_e+176p ...
UNDEF:000007A8                 extrn _One:near         ; DATA XREF: _dh_create_e:loc_5FCr
UNDEF:000007A8                                         ; _dh_validate_f+21r ...
UNDEF:000007AC                 extrn _bignum_set_bit:near ; CODE XREF: _dh_create_e+131p
UNDEF:000007B0                 extrn _bn_power_2:near  ; CODE XREF: _dh_create_e+D7p
UNDEF:000007B4                 extrn _ssh1_read_bignum:near ; CODE XREF: _dh_create_e+C9p
UNDEF:000007B8                 extrn _random_byte:near ; CODE XREF: _dh_create_e+A3p
UNDEF:000007B8                                         ; _dh_create_e+118p
UNDEF:000007BC                 extrn _ssh1_write_bignum:near ; CODE XREF: _dh_create_e+81p
UNDEF:000007C0                 extrn _bignum_bitcount:near ; CODE XREF: _dh_create_e+69p
UNDEF:000007C4                 extrn _ssh1_bignum_length:near ; CODE XREF: _dh_create_e+2Ap
UNDEF:000007C8                 extrn _bigsub:near      ; CODE XREF: _dh_validate_f+4Ep
UNDEF:000007C8
UNDEF:000007C8
UNDEF:000007C8                 end