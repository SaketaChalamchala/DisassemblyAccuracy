_IsPlatformNT   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0A0h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_A0]']
mov ['ecx,', '28h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+VersionInformation.dwOSVersionInfoSize],', '0']
push ['90h']
push ['0']
lea ['eax,', '[ebp+VersionInformation.dwMajorVersion]']
push ['eax']
call ['_memset']
add ['esp,', '0Ch']
mov ['[ebp+VersionInformation.dwOSVersionInfoSize],', '94h']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+VersionInformation]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetVersionExA@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
cmp ['[ebp+VersionInformation.dwPlatformId],', '2']
setz ['al']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '0A0h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_InitMultipleMonitorStubs proc near     
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+hModule],', '0CCCCCCCCh']
cmp ['ds:_g_fMultiMonInitDone,', '0']
jz ['short', 'loc_227E']
xor ['eax,', 'eax']
cmp ['ds:_g_pfnGetMonitorInfo,', '0']
setnz ['al']
jmp ['loc_2428']
call ['_IsPlatformNT']
mov ['ds:_g_fMultimonPlatformNT,', 'eax']
mov ['esi,', 'esp']
push ['offset', '$SG85935']
call ['dword', 'ptr', 'ds:__imp__GetModuleHandleA@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hModule],', 'eax']
cmp ['[ebp+hModule],', '0']
jz ['loc_23D6']
mov ['esi,', 'esp']
push ['offset', '$SG85951']
mov ['eax,', '[ebp+hModule]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_g_pfnGetSystemMetrics,', 'eax']
cmp ['ds:_g_pfnGetSystemMetrics,', '0']
jz ['loc_23D6']
mov ['esi,', 'esp']
push ['offset', '$SG85952']
mov ['ecx,', '[ebp+hModule]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_g_pfnMonitorFromWindow,', 'eax']
cmp ['ds:_g_pfnMonitorFromWindow,', '0']
jz ['loc_23D6']
mov ['esi,', 'esp']
push ['offset', '$SG85953']
mov ['edx,', '[ebp+hModule]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_g_pfnMonitorFromRect,', 'eax']
cmp ['ds:_g_pfnMonitorFromRect,', '0']
jz ['loc_23D6']
mov ['esi,', 'esp']
push ['offset', '$SG85954']
mov ['eax,', '[ebp+hModule]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_g_pfnMonitorFromPoint,', 'eax']
cmp ['ds:_g_pfnMonitorFromPoint,', '0']
jz ['loc_23D6']
mov ['esi,', 'esp']
push ['offset', '$SG85955']
mov ['ecx,', '[ebp+hModule]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_g_pfnEnumDisplayMonitors,', 'eax']
cmp ['ds:_g_pfnEnumDisplayMonitors,', '0']
jz ['short', 'loc_23D6']
mov ['esi,', 'esp']
push ['offset', '$SG85956']
mov ['edx,', '[ebp+hModule]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_g_pfnGetMonitorInfo,', 'eax']
cmp ['ds:_g_pfnGetMonitorInfo,', '0']
jz ['short', 'loc_23D6']
mov ['esi,', 'esp']
push ['offset', '$SG85957']
mov ['eax,', '[ebp+hModule]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_g_pfnEnumDisplayDevices,', 'eax']
cmp ['ds:_g_pfnEnumDisplayDevices,', '0']
jz ['short', 'loc_23D6']
mov ['ds:_g_fMultiMonInitDone,', '1']
mov ['eax,', '1']
jmp ['short', 'loc_2428']
jmp ['short', 'loc_2428']
mov ['ds:_g_pfnGetSystemMetrics,', '0']
mov ['ds:_g_pfnMonitorFromWindow,', '0']
mov ['ds:_g_pfnMonitorFromRect,', '0']
mov ['ds:_g_pfnMonitorFromPoint,', '0']
mov ['ds:_g_pfnGetMonitorInfo,', '0']
mov ['ds:_g_pfnEnumDisplayMonitors,', '0']
mov ['ds:_g_pfnEnumDisplayDevices,', '0']
mov ['ds:_g_fMultiMonInitDone,', '1']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_xGetSystemMetrics@4 proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
call ['_InitMultipleMonitorStubs']
test ['eax,', 'eax']
jz ['short', 'loc_2462']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+nIndex]']
push ['eax']
call ['ds:_g_pfnGetSystemMetrics']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_24AF']
mov ['ecx,', '[ebp+nIndex]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
sub ['edx,', '4Ch']
mov ['[ebp+var_4],', 'edx']
cmp ['[ebp+var_4],', '5']
ja ['short', 'loc_249C']
mov ['eax,', '[ebp+var_4]']
jmp ['ds:$LN10[eax*4]']
mov ['eax,', '1']
jmp ['short', 'loc_24AF']
xor ['eax,', 'eax']
jmp ['short', 'loc_24AF']
mov ['[ebp+nIndex],', '0']
jmp ['short', 'loc_249C']
mov ['[ebp+nIndex],', '1']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+nIndex]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetSystemMetrics@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['4']
endp
_xMonitorFromPoint@12 proc near         
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
call ['_InitMultipleMonitorStubs']
test ['eax,', 'eax']
jz ['short', 'loc_2502']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0.y]']
push ['ecx']
mov ['edx,', '[ebp+arg_0.x]']
push ['edx']
call ['ds:_g_pfnMonitorFromPoint']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_254B']
mov ['eax,', '[ebp+arg_8]']
and ['eax,', '3']
jnz ['short', 'loc_2542']
cmp ['[ebp+arg_0.x],', '0']
jl ['short', 'loc_2549']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__GetSystemMetrics@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+arg_0.x],', 'eax']
jge ['short', 'loc_2549']
cmp ['[ebp+arg_0.y],', '0']
jl ['short', 'loc_2549']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__GetSystemMetrics@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+arg_0.y],', 'eax']
jge ['short', 'loc_2549']
mov ['eax,', '12340042h']
jmp ['short', 'loc_254B']
xor ['eax,', 'eax']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn ['0Ch']
endp
_xMonitorFromRect@8 proc near           
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
call ['_InitMultipleMonitorStubs']
test ['eax,', 'eax']
jz ['short', 'loc_257E']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['ds:_g_pfnMonitorFromRect']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_25D2']
mov ['edx,', '[ebp+arg_4]']
and ['edx,', '3']
jnz ['short', 'loc_25C9']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+8],', '0']
jle ['short', 'loc_25D0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0']
jle ['short', 'loc_25D0']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__GetSystemMetrics@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
cmp ['[edx],', 'eax']
jge ['short', 'loc_25D0']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__GetSystemMetrics@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
cmp ['[ecx+4],', 'eax']
jge ['short', 'loc_25D0']
mov ['eax,', '12340042h']
jmp ['short', 'loc_25D2']
xor ['eax,', 'eax']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn ['8']
endp
_xMonitorFromWindow@8 proc near         
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '3Ch']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_3C]']
mov ['ecx,', '0Fh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
call ['_InitMultipleMonitorStubs']
test ['eax,', 'eax']
jz ['short', 'loc_262B']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['ds:_g_pfnMonitorFromWindow']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_269E']
mov ['edx,', '[ebp+arg_4]']
and ['edx,', '3']
jz ['short', 'loc_263A']
mov ['eax,', '12340042h']
jmp ['short', 'loc_269E']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsIconic@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_266D']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+wndpl]']
push ['ecx']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetWindowPlacement@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3C],', 'eax']
jmp ['short', 'loc_2687']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+wndpl.rcNormalPosition]']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetWindowRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3C],', 'eax']
cmp ['[ebp+var_3C],', '0']
jz ['short', 'loc_269C']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
lea ['eax,', '[ebp+wndpl.rcNormalPosition]']
push ['eax']
call ['_xMonitorFromRect@8']
jmp ['short', 'loc_269E']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN10_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '3Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['8']
endp
_xGetMonitorInfo@8 proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+pvParam],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
call ['_InitMultipleMonitorStubs']
test ['eax,', 'eax']
jz ['short', 'loc_2741']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['ds:_g_pfnGetMonitorInfo']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_20],', 'eax']
mov ['eax,', '[ebp+var_20]']
jmp ['loc_2817']
cmp ['[ebp+arg_0],', '12340042h']
jnz ['loc_2815']
cmp ['[ebp+arg_4],', '0']
jz ['loc_2815']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx],', '28h']
jb ['loc_2815']
mov ['esi,', 'esp']
push ['0']
lea ['eax,', '[ebp+pvParam]']
push ['eax']
push ['0']
push ['30h']
call ['dword', 'ptr', 'ds:__imp__SystemParametersInfoA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['loc_2815']
mov ['ecx,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['edx,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[edx+8],', '0']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__GetSystemMetrics@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx+0Ch],', 'eax']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__GetSystemMetrics@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx+10h],', 'eax']
mov ['eax,', '[ebp+arg_4]']
add ['eax,', '14h']
mov ['ecx,', '[ebp+pvParam]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+var_14]']
mov ['[eax+4],', 'edx']
mov ['ecx,', '[ebp+var_10]']
mov ['[eax+8],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[eax+0Ch],', 'edx']
mov ['eax,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[eax+24h],', '1']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx],', '48h']
jb ['short', 'loc_280E']
push ['1Fh']
push ['offset', '$SG86032']
push ['20h']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '28h']
push ['edx']
call ['_strncpy_s']
add ['esp,', '10h']
mov ['eax,', '1']
jmp ['short', 'loc_2817']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN8_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['8']
endp
_xEnumDisplayMonitors@16 proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '48h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_48]']
mov ['ecx,', '12h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
call ['_InitMultipleMonitorStubs']
test ['eax,', 'eax']
jz ['short', 'loc_28B6']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['ds:_g_pfnEnumDisplayMonitors']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_2A0E']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_28C3']
xor ['eax,', 'eax']
jmp ['loc_2A0E']
mov ['[ebp+rc.left],', '0']
mov ['[ebp+rc.top],', '0']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__GetSystemMetrics@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+rc.right],', 'eax']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__GetSystemMetrics@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+rc.bottom],', 'eax']
cmp ['[ebp+hdc],', '0']
jz ['loc_29C5']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+rect]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetClipBox@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_48],', 'eax']
cmp ['[ebp+var_48],', '0']
jz ['loc_29BF']
cmp ['[ebp+var_48],', '1']
jz ['loc_29B8']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+pt]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetDCOrgEx@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_2953']
xor ['eax,', 'eax']
jmp ['loc_2A0E']
mov ['edx,', '[ebp+pt.y]']
neg ['edx']
mov ['esi,', 'esp']
push ['edx']
mov ['eax,', '[ebp+pt.x]']
neg ['eax']
push ['eax']
lea ['ecx,', '[ebp+rc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__OffsetRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+rect]']
push ['edx']
lea ['eax,', '[ebp+rc]']
push ['eax']
lea ['ecx,', '[ebp+rc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__IntersectRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_29B8']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_29B6']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
lea ['eax,', '[ebp+rc]']
push ['eax']
lea ['ecx,', '[ebp+rc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__IntersectRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_29B8']
jmp ['short', 'loc_29C3']
mov ['eax,', '1']
jmp ['short', 'loc_2A0E']
xor ['eax,', 'eax']
jmp ['short', 'loc_2A0E']
jmp ['short', 'loc_29F1']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_29F1']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
lea ['eax,', '[ebp+rc]']
push ['eax']
lea ['ecx,', '[ebp+rc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__IntersectRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_29F1']
mov ['eax,', '1']
jmp ['short', 'loc_2A0E']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
lea ['eax,', '[ebp+rc]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
push ['12340042h']
call ['[ebp+arg_8]']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN20']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '48h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['10h']
endp
_xEnumDisplayDevices@16 proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
call ['_InitMultipleMonitorStubs']
test ['eax,', 'eax']
jz ['short', 'loc_2AB6']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['ds:_g_pfnEnumDisplayDevices']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_2B24']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_2AC0']
xor ['eax,', 'eax']
jmp ['short', 'loc_2B24']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_2ACA']
xor ['eax,', 'eax']
jmp ['short', 'loc_2B24']
cmp ['[ebp+arg_8],', '0']
jz ['short', 'loc_2ADB']
mov ['ecx,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[ecx],', '1A8h']
jnb ['short', 'loc_2ADF']
xor ['eax,', 'eax']
jmp ['short', 'loc_2B24']
push ['1Fh']
push ['offset', '$SG86083']
push ['20h']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '4']
push ['edx']
call ['_strncpy_s']
add ['esp,', '10h']
push ['1Fh']
push ['offset', '$SG86087']
push ['80h']
mov ['eax,', '[ebp+arg_8]']
add ['eax,', '24h']
push ['eax']
call ['_strncpy_s']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_8]']
mov ['dword', 'ptr', '[ecx+0A4h],', '5']
mov ['eax,', '1']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn ['10h']
endp
_ldisc_update   proc near
push ['ebp']
mov ['ebp,', 'esp']
pop ['ebp']
retn
endp
_get_ttymode    proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_get_ttymode']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_WinMain@16     proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '194h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_194]']
mov ['ecx,', '65h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+hInstance]']
mov ['dword', 'ptr', 'ds:_hinst,', 'eax']
mov ['dword', 'ptr', 'ds:_hwnd,', '0']
mov ['dword', 'ptr', 'ds:_flags,', '5']
call ['_sk_init']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__InitCommonControls@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
call ['_defuse_showwindow']
call ['_init_winver']
test ['eax,', 'eax']
jnz ['short', 'loc_2C16']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG89025']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpCaption],', 'eax']
mov ['esi,', 'esp']
push ['30h']
mov ['edx,', '[ebp+lpCaption]']
push ['edx']
push ['offset', '$SG89027']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+lpCaption]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['loc_3F80']
cmp ['dword', 'ptr', 'ds:_osVersion+4,', '4']
jb ['short', 'loc_2C31']
cmp ['dword', 'ptr', 'ds:_osVersion+4,', '4']
jnz ['short', 'loc_2C4A']
cmp ['dword', 'ptr', 'ds:_osVersion+10h,', '2']
jz ['short', 'loc_2C4A']
mov ['esi,', 'esp']
push ['offset', '$SG89030']
call ['dword', 'ptr', 'ds:__imp__RegisterWindowMessageA@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['_wm_mousewheel,', 'eax']
call ['_init_help']
call ['_init_winfuncs']
call ['_conf_new']
mov ['dword', 'ptr', 'ds:_conf,', 'eax']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__CoInitialize@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_5C],', 'eax']
cmp ['[ebp+var_5C],', '0']
jz ['short', 'loc_2CC7']
cmp ['[ebp+var_5C],', '1']
jz ['short', 'loc_2CC7']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG89036']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_6C],', 'eax']
mov ['esi,', 'esp']
push ['30h']
mov ['edx,', '[ebp+var_6C]']
push ['edx']
push ['offset', '$SG89038']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_6C]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['loc_3F80']
mov ['[ebp+var_74],', '0']
mov ['[ebp+var_78],', '0']
mov ['ecx,', 'dword', 'ptr', 'ds:_be_default_protocol']
mov ['dword', 'ptr', 'ds:_default_protocol,', 'ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_default_protocol']
push ['edx']
call ['_backend_from_proto']
add ['esp,', '4']
mov ['[ebp+var_7C],', 'eax']
mov ['dword', 'ptr', 'ds:_default_port,', '0']
cmp ['[ebp+var_7C],', '0']
jz ['short', 'loc_2D0F']
mov ['eax,', '[ebp+var_7C]']
mov ['ecx,', '[eax+48h]']
mov ['dword', 'ptr', 'ds:_default_port,', 'ecx']
push ['0']
push ['73h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_set_int']
add ['esp,', '0Ch']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
push ['0']
call ['_do_defaults']
add ['esp,', '8']
mov ['ecx,', '[ebp+lpCmdLine]']
mov ['[ebp+Str],', 'ecx']
mov ['edx,', '[ebp+Str]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['short', 'loc_2D60']
mov ['ecx,', '[ebp+Str]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
push ['edx']
call ['_isspace']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_2D60']
mov ['eax,', '[ebp+Str]']
add ['eax,', '1']
mov ['[ebp+Str],', 'eax']
jmp ['short', 'loc_2D38']
mov ['ecx,', '[ebp+Str]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '40h']
jnz ['loc_2DF7']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_80],', 'eax']
cmp ['[ebp+var_80],', '1']
jle ['short', 'loc_2DA6']
mov ['ecx,', '[ebp+Str]']
add ['ecx,', '[ebp+var_80]']
movsx ['edx,', 'byte', 'ptr', '[ecx-1]']
push ['edx']
call ['_isspace']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_2DA6']
mov ['eax,', '[ebp+var_80]']
sub ['eax,', '1']
mov ['[ebp+var_80],', 'eax']
jmp ['short', 'loc_2D7E']
mov ['ecx,', '[ebp+Str]']
add ['ecx,', '[ebp+var_80]']
mov ['byte', 'ptr', '[ecx],', '0']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
mov ['eax,', '[ebp+Str]']
add ['eax,', '1']
push ['eax']
call ['_do_defaults']
add ['esp,', '8']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_launchable']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_2DEB']
call ['_do_config']
test ['eax,', 'eax']
jnz ['short', 'loc_2DEB']
push ['0']
call ['_cleanup_exit']
db ['83h']
db ['0C4h']
db ['4']
mov ['[ebp+var_78],', '1']
jmp ['loc_332C']
mov ['edx,', '[ebp+Str]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '26h']
jnz ['loc_2EC9']
lea ['ecx,', '[ebp+dwNumberOfBytesToMap]']
push ['ecx']
lea ['edx,', '[ebp+hFileMappingObject]']
push ['edx']
push ['offset', '$SG89061']
mov ['eax,', '[ebp+Str]']
add ['eax,', '1']
push ['eax']
call ['_sscanf']
add ['esp,', '10h']
cmp ['eax,', '2']
jnz ['short', 'loc_2EAA']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+dwNumberOfBytesToMap]']
push ['ecx']
push ['0']
push ['0']
push ['4']
mov ['edx,', '[ebp+hFileMappingObject]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__MapViewOfFile@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+lpBaseAddress],', 'eax']
cmp ['[ebp+lpBaseAddress],', '0']
jz ['short', 'loc_2EAA']
mov ['eax,', '[ebp+dwNumberOfBytesToMap]']
push ['eax']
mov ['ecx,', '[ebp+lpBaseAddress]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_deserialise']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+lpBaseAddress]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__UnmapViewOfFile@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hFileMappingObject]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__CloseHandle@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_2EBD']
call ['_do_config']
test ['eax,', 'eax']
jnz ['short', 'loc_2EBD']
push ['0']
call ['_cleanup_exit']
db ['83h']
db ['0C4h']
db ['4']
mov ['[ebp+var_78],', '1']
jmp ['loc_332C']
push ['0']
lea ['edx,', '[ebp+var_B4]']
push ['edx']
lea ['eax,', '[ebp+var_A4]']
push ['eax']
mov ['ecx,', '[ebp+lpCmdLine]']
push ['ecx']
call ['_split_into_argv']
add ['esp,', '10h']
mov ['[ebp+var_AC],', '0']
jmp ['short', 'loc_2F00']
mov ['edx,', '[ebp+var_AC]']
add ['edx,', '1']
mov ['[ebp+var_AC],', 'edx']
mov ['eax,', '[ebp+var_AC]']
cmp ['eax,', '[ebp+var_A4]']
jge ['loc_332C']
mov ['ecx,', '[ebp+var_AC]']
mov ['edx,', '[ebp+var_B4]']
mov ['eax,', '[edx+ecx*4]']
mov ['[ebp+Str1],', 'eax']
mov ['ecx,', '[ebp+var_AC]']
add ['ecx,', '1']
cmp ['ecx,', '[ebp+var_A4]']
jge ['short', 'loc_2F50']
mov ['edx,', '[ebp+var_AC]']
mov ['eax,', '[ebp+var_B4]']
mov ['ecx,', '[eax+edx*4+4]']
mov ['[ebp+var_194],', 'ecx']
jmp ['short', 'loc_2F5A']
mov ['[ebp+var_194],', '0']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
push ['1']
mov ['eax,', '[ebp+var_194]']
push ['eax']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_cmdline_process_param']
add ['esp,', '10h']
mov ['[ebp+var_C0],', 'eax']
cmp ['[ebp+var_C0],', '0FFFFFFFEh']
jnz ['short', 'loc_2FA1']
mov ['edx,', '[ebp+Str1]']
push ['edx']
push ['offset', '$SG89076']
call ['_cmdline_error']
add ['esp,', '8']
jmp ['loc_3327']
cmp ['[ebp+var_C0],', '2']
jnz ['short', 'loc_2FBE']
mov ['eax,', '[ebp+var_AC]']
add ['eax,', '1']
mov ['[ebp+var_AC],', 'eax']
jmp ['loc_3327']
cmp ['[ebp+var_C0],', '1']
jnz ['short', 'loc_2FD1']
jmp ['loc_2EF1']
jmp ['loc_3327']
push ['offset', '$SG89084']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_3005']
push ['offset', '$SG89085']
mov ['edx,', '[ebp+Str1]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['loc_30D7']
push ['offset', '$SG89089']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_3053']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG89090']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_C4],', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_appname']
push ['edx']
push ['offset', '$SG89091']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_C8],', 'eax']
jmp ['short', 'loc_3086']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG89093']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_C4],', 'eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG89094']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_C8],', 'eax']
push ['4']
push ['134h']
mov ['edx,', '[ebp+var_C8]']
push ['edx']
mov ['eax,', '[ebp+var_C4]']
push ['eax']
call ['_message_box']
add ['esp,', '10h']
cmp ['eax,', '6']
jnz ['short', 'loc_30AD']
call ['_cleanup_all']
mov ['ecx,', '[ebp+var_C4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_C8]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['0']
call ['_exit']
jmp ['loc_3327']
push ['offset', '$SG89098']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_3100']
call ['_pgp_fingerprints']
push ['1']
call ['_exit']
jmp ['loc_3327']
mov ['ecx,', '[ebp+Str1]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '2Dh']
jz ['loc_3313']
mov ['eax,', '[ebp+Str1]']
mov ['[ebp+var_CC],', 'eax']
cmp ['[ebp+var_74],', '0']
jz ['short', 'loc_316C']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+Str1]']
push ['edx']
push ['offset', '$SG89104']
call ['_cmdline_process_param']
add ['esp,', '10h']
mov ['[ebp+var_D0],', 'eax']
cmp ['[ebp+var_D0],', '2']
jz ['short', 'loc_3167']
push ['219h']
push ['offset', '$SG89106']
push ['offset', '$SG89107']
call ['__wassert']
add ['esp,', '0Ch']
jmp ['loc_3311']
push ['7']
push ['offset', '$SG89110']
mov ['ecx,', '[ebp+var_CC]']
push ['ecx']
call ['_strncmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_329A']
mov ['edx,', '[ebp+var_CC]']
add ['edx,', '7']
mov ['[ebp+var_CC],', 'edx']
mov ['eax,', '[ebp+var_CC]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '2Fh']
jnz ['short', 'loc_31C5']
mov ['edx,', '[ebp+var_CC]']
movsx ['eax,', 'byte', 'ptr', '[edx+1]']
cmp ['eax,', '2Fh']
jnz ['short', 'loc_31C5']
mov ['ecx,', '[ebp+var_CC]']
add ['ecx,', '2']
mov ['[ebp+var_CC],', 'ecx']
push ['1']
push ['2']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_set_int']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_CC]']
mov ['[ebp+Str1],', 'eax']
push ['offset', '$SG89113']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_host_strcspn']
add ['esp,', '8']
add ['eax,', '[ebp+Str1]']
mov ['[ebp+Str1],', 'eax']
mov ['edx,', '[ebp+Str1]']
mov ['al,', '[edx]']
mov ['[ebp+var_D1],', 'al']
mov ['ecx,', '[ebp+Str1]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_3237']
mov ['eax,', '[ebp+Str1]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+Str1]']
add ['ecx,', '1']
mov ['[ebp+Str1],', 'ecx']
movsx ['edx,', '[ebp+var_D1]']
cmp ['edx,', '3Ah']
jnz ['short', 'loc_3266']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_atoi']
add ['esp,', '4']
push ['eax']
push ['1']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_set_int']
add ['esp,', '0Ch']
jmp ['short', 'loc_3279']
push ['0FFFFFFFFh']
push ['1']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_set_int']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_CC]']
push ['eax']
push ['0']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_set_str']
add ['esp,', '0Ch']
mov ['[ebp+var_74],', '1']
jmp ['short', 'loc_3311']
mov ['edx,', '[ebp+Str1]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['short', 'loc_32CE']
mov ['ecx,', '[ebp+Str1]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
push ['edx']
call ['_isspace']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_32CE']
mov ['eax,', '[ebp+Str1]']
add ['eax,', '1']
mov ['[ebp+Str1],', 'eax']
jmp ['short', 'loc_329A']
mov ['ecx,', '[ebp+Str1]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_32F3']
mov ['eax,', '[ebp+Str1]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+Str1]']
add ['ecx,', '1']
mov ['[ebp+Str1],', 'ecx']
mov ['edx,', '[ebp+var_CC]']
push ['edx']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_set_str']
add ['esp,', '0Ch']
mov ['[ebp+var_74],', '1']
jmp ['short', 'loc_3327']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
push ['offset', '$SG89123']
call ['_cmdline_error']
add ['esp,', '8']
jmp ['loc_2EF1']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_cmdline_run_saved']
add ['esp,', '4']
cmp ['dword', 'ptr', 'ds:_loaded_session,', '0']
jnz ['short', 'loc_334A']
cmp ['[ebp+var_74],', '0']
jz ['short', 'loc_3351']
mov ['[ebp+var_78],', '1']
cmp ['[ebp+var_78],', '0']
jz ['short', 'loc_3369']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_launchable']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_337C']
call ['_do_config']
test ['eax,', 'eax']
jnz ['short', 'loc_337C']
push ['0']
call ['_cleanup_exit']
db ['83h']
db ['0C4h']
db ['4']
push ['0']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+var_D8],', 'eax']
mov ['edx,', '[ebp+var_D8]']
mov ['[ebp+var_DC],', 'edx']
push ['offset', '$SG89132']
mov ['eax,', '[ebp+var_DC]']
push ['eax']
call ['_strspn']
add ['esp,', '8']
add ['eax,', '[ebp+var_DC]']
mov ['[ebp+var_DC],', 'eax']
mov ['ecx,', '[ebp+var_DC]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_3424']
push ['40h']
mov ['eax,', '[ebp+var_DC]']
push ['eax']
call ['_strrchr']
add ['esp,', '8']
mov ['[ebp+var_E8],', 'eax']
cmp ['[ebp+var_E8],', '0']
jz ['short', 'loc_3424']
mov ['ecx,', '[ebp+var_E8]']
mov ['byte', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+var_DC]']
push ['edx']
push ['32h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_set_str']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_E8]']
add ['ecx,', '1']
mov ['[ebp+var_DC],', 'ecx']
push ['3Ah']
mov ['edx,', '[ebp+var_DC]']
push ['edx']
call ['_host_strchr']
add ['esp,', '8']
mov ['[ebp+var_EC],', 'eax']
cmp ['[ebp+var_EC],', '0']
jz ['short', 'loc_3470']
push ['3Ah']
mov ['eax,', '[ebp+var_EC]']
add ['eax,', '1']
push ['eax']
call ['_host_strchr']
add ['esp,', '8']
mov ['[ebp+var_F0],', 'eax']
cmp ['[ebp+var_F0],', '0']
jnz ['short', 'loc_3470']
mov ['ecx,', '[ebp+var_EC]']
mov ['byte', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+var_D8]']
mov ['[ebp+var_E0],', 'edx']
mov ['eax,', '[ebp+var_DC]']
mov ['[ebp+var_E4],', 'eax']
mov ['ecx,', '[ebp+var_E4]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_34E1']
mov ['eax,', '[ebp+var_E4]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '20h']
jz ['short', 'loc_34D0']
mov ['edx,', '[ebp+var_E4]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '9']
jz ['short', 'loc_34D0']
mov ['ecx,', '[ebp+var_E0]']
mov ['edx,', '[ebp+var_E4]']
mov ['al,', '[edx]']
mov ['[ecx],', 'al']
mov ['ecx,', '[ebp+var_E0]']
add ['ecx,', '1']
mov ['[ebp+var_E0],', 'ecx']
mov ['edx,', '[ebp+var_E4]']
add ['edx,', '1']
mov ['[ebp+var_E4],', 'edx']
jmp ['short', 'loc_3488']
mov ['eax,', '[ebp+var_E0]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+var_D8]']
push ['ecx']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_set_str']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_D8]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+hPrevInstance],', '0']
jnz ['short', 'loc_3596']
mov ['[ebp+WndClass.style],', '0']
mov ['[ebp+WndClass.lpfnWndProc],', 'offset', '_WndProc@16']
mov ['[ebp+WndClass.cbClsExtra],', '0']
mov ['[ebp+WndClass.cbWndExtra],', '0']
mov ['ecx,', '[ebp+hInstance]']
mov ['[ebp+WndClass.hInstance],', 'ecx']
mov ['esi,', 'esp']
push ['offset', 'IconName']
mov ['edx,', '[ebp+hInstance]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__LoadIconA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+WndClass.hIcon],', 'eax']
mov ['esi,', 'esp']
push ['offset', 'CursorName']
push ['0']
call ['dword', 'ptr', 'ds:__imp__LoadCursorA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+WndClass.hCursor],', 'eax']
mov ['[ebp+WndClass.hbrBackground],', '0']
mov ['[ebp+WndClass.lpszMenuName],', '0']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
mov ['[ebp+WndClass.lpszClassName],', 'eax']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+WndClass]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__RegisterClassA@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0B10h']
push ['0']
push ['offset', '_ucsdata']
call ['_memset_0']
add ['esp,', '0Ch']
call ['_conf_cache_data']
call ['_conftopalette']
mov ['ds:_font_width,', '0Ah']
mov ['ds:_font_height,', '14h']
mov ['ds:_extra_width,', '19h']
mov ['ds:_extra_height,', '1Ch']
push ['6Eh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
imul ['eax,', 'ds:_font_width']
add ['eax,', 'ds:_extra_width']
mov ['[ebp+nWidth],', 'eax']
push ['6Fh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
imul ['eax,', 'ds:_font_height']
add ['eax,', 'ds:_extra_height']
mov ['[ebp+nHeight],', 'eax']
lea ['ecx,', '[ebp+var_104]']
push ['ecx']
call ['_get_fullscreen_rect']
add ['esp,', '4']
mov ['edx,', '[ebp+var_FC]']
sub ['edx,', '[ebp+var_104]']
cmp ['[ebp+nWidth],', 'edx']
jle ['short', 'loc_364C']
mov ['eax,', '[ebp+var_FC]']
sub ['eax,', '[ebp+var_104]']
mov ['[ebp+nWidth],', 'eax']
mov ['ecx,', '[ebp+var_F8]']
sub ['ecx,', '[ebp+var_100]']
cmp ['[ebp+nHeight],', 'ecx']
jle ['short', 'loc_366C']
mov ['edx,', '[ebp+var_F8]']
sub ['edx,', '[ebp+var_100]']
mov ['[ebp+nHeight],', 'edx']
mov ['[ebp+dwStyle],', '0EF0000h']
mov ['[ebp+dwExStyle],', '0']
push ['68h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_36A6']
mov ['ecx,', '[ebp+dwStyle]']
and ['ecx,', '0FFDFFFFFh']
mov ['[ebp+dwStyle],', 'ecx']
push ['6Ah']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '1']
jnz ['short', 'loc_36CD']
mov ['eax,', '[ebp+dwStyle]']
and ['eax,', '0FFFAFFFFh']
mov ['[ebp+dwStyle],', 'eax']
push ['53h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_36F1']
mov ['edx,', '[ebp+dwExStyle]']
or ['edx,', '8']
mov ['[ebp+dwExStyle],', 'edx']
push ['79h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_3717']
mov ['ecx,', '[ebp+dwExStyle]']
or ['ecx,', '200h']
mov ['[ebp+dwExStyle],', 'ecx']
mov ['esi,', 'esp']
push ['0']
mov ['edx,', '[ebp+hInstance]']
push ['edx']
push ['0']
push ['0']
mov ['eax,', '[ebp+nHeight]']
push ['eax']
mov ['ecx,', '[ebp+nWidth]']
push ['ecx']
push ['80000000h']
push ['80000000h']
mov ['edx,', '[ebp+dwStyle]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
mov ['edx,', '[ebp+dwExStyle]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__CreateWindowExA@48']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['dword', 'ptr', 'ds:_hwnd,', 'eax']
push ['0']
push ['0']
call ['_init_fonts']
add ['esp,', '8']
push ['0']
push ['offset', '_ucsdata']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_term_init']
add ['esp,', '0Ch']
mov ['dword', 'ptr', 'ds:_term,', 'eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
push ['0']
call ['_log_init']
add ['esp,', '8']
mov ['dword', 'ptr', 'ds:_logctx,', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_logctx']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_provide_logctx']
add ['esp,', '8']
push ['5Bh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
push ['6Eh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
push ['6Fh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_size']
add ['esp,', '10h']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+Rect]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetWindowRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_124]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetClientRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['7Ah']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['ds:_offset_height,', 'eax']
mov ['ecx,', 'ds:_offset_height']
mov ['ds:_offset_width,', 'ecx']
mov ['edx,', '[ebp+Rect.right]']
sub ['edx,', '[ebp+Rect.left]']
sub ['edx,', '[ebp+var_124.right]']
add ['edx,', '[ebp+var_124.left]']
mov ['eax,', 'ds:_offset_width']
lea ['ecx,', '[edx+eax*2]']
mov ['ds:_extra_width,', 'ecx']
mov ['edx,', '[ebp+Rect.bottom]']
sub ['edx,', '[ebp+Rect.top]']
sub ['edx,', '[ebp+var_124.bottom]']
add ['edx,', '[ebp+var_124.top]']
mov ['eax,', 'ds:_offset_height']
lea ['ecx,', '[edx+eax*2]']
mov ['ds:_extra_height,', 'ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_width']
imul ['eax,', '[edx+12Ch]']
add ['eax,', 'ds:_extra_width']
mov ['[ebp+nWidth],', 'eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', 'ds:_font_height']
imul ['edx,', '[ecx+128h]']
add ['edx,', 'ds:_extra_height']
mov ['[ebp+nHeight],', 'edx']
mov ['esi,', 'esp']
push ['0Eh']
mov ['eax,', '[ebp+nHeight]']
push ['eax']
mov ['ecx,', '[ebp+nWidth]']
push ['ecx']
push ['0']
push ['0']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', 'ds:_font_width']
add ['eax,', '0Fh']
cdq
and ['edx,', '0Fh']
add ['eax,', 'edx']
sar ['eax,', '4']
shl ['eax,', '1']
imul ['eax,', 'ds:_font_height']
mov ['[ebp+Size],', 'eax']
push ['1']
mov ['eax,', '[ebp+Size]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Dst],', 'eax']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+Dst]']
push ['edx']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Dst]']
push ['eax']
push ['1']
push ['1']
mov ['ecx,', 'ds:_font_height']
push ['ecx']
mov ['edx,', 'ds:_font_width']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__CreateBitmap@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_caretbm,', 'eax']
mov ['eax,', '[ebp+Dst]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:_font_height']
push ['ecx']
mov ['edx,', 'ds:_font_width']
push ['edx']
mov ['eax,', 'ds:_caretbm']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__CreateCaret@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_168.cbSize],', '1Ch']
mov ['[ebp+var_168.fMask],', '1Fh']
mov ['[ebp+var_168.nMin],', '0']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+128h]']
sub ['eax,', '1']
mov ['[ebp+var_168.nMax],', 'eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', '[ecx+128h]']
mov ['[ebp+var_168.nPage],', 'edx']
mov ['[ebp+var_168.nPos],', '0']
mov ['esi,', 'esp']
push ['0']
lea ['eax,', '[ebp+var_168]']
push ['eax']
push ['1']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetScrollInfo@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_lastact,', '0']
mov ['ds:_lastbtn,', '0']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetDoubleClickTime@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_dbltime,', 'eax']
mov ['esi,', 'esp']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetSystemMenu@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_popup_menus,', 'eax']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__CreatePopupMenu@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:hMenu,', 'eax']
mov ['esi,', 'esp']
push ['offset', '$SG89181']
push ['190h']
push ['0']
mov ['eax,', 'ds:hMenu']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__CreateMenu@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_savedsess_menu,', 'eax']
push ['1']
push ['offset', '_sesslist']
call ['_get_sesslist']
add ['esp,', '8']
call ['_update_savedsess_menu']
mov ['[ebp+var_174],', '0']
jmp ['short', 'loc_3ADC']
mov ['ecx,', '[ebp+var_174]']
add ['ecx,', '1']
mov ['[ebp+var_174],', 'ecx']
cmp ['[ebp+var_174],', '2']
jnb ['loc_3D4E']
mov ['edx,', '[ebp+var_174]']
mov ['eax,', 'ds:_popup_menus[edx*4]']
mov ['[ebp+hMenu],', 'eax']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['800h']
mov ['ecx,', '[ebp+hMenu]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89185']
push ['10h']
push ['0']
mov ['edx,', '[ebp+hMenu]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['800h']
mov ['eax,', '[ebp+hMenu]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89186']
push ['20h']
push ['0']
mov ['ecx,', '[ebp+hMenu]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89187']
push ['30h']
push ['0']
mov ['edx,', '[ebp+hMenu]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89189']
mov ['eax,', 'ds:_savedsess_menu']
push ['eax']
push ['10h']
mov ['ecx,', '[ebp+hMenu]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89190']
push ['50h']
push ['0']
mov ['edx,', '[ebp+hMenu]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['800h']
mov ['eax,', '[ebp+hMenu]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89191']
push ['170h']
push ['0']
mov ['ecx,', '[ebp+hMenu]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89192']
push ['60h']
push ['0']
mov ['edx,', '[ebp+hMenu]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89193']
push ['70h']
push ['0']
mov ['eax,', '[ebp+hMenu]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['800h']
mov ['ecx,', '[ebp+hMenu]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89194']
push ['180h']
push ['6Ah']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
sub ['eax,', '1']
neg ['eax']
sbb ['eax,', 'eax']
add ['eax,', '1']
push ['eax']
mov ['eax,', '[ebp+hMenu]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['800h']
mov ['ecx,', '[ebp+hMenu]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
call ['_has_help']
test ['eax,', 'eax']
jz ['short', 'loc_3CFD']
mov ['esi,', 'esp']
push ['offset', '$SG89196']
push ['140h']
push ['0']
mov ['edx,', '[ebp+hMenu]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG89197']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpNewItem],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+lpNewItem]']
push ['ecx']
push ['150h']
push ['0']
mov ['edx,', '[ebp+hMenu]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+lpNewItem]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_3ACD']
call ['_start_backend']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__GetKeyboardLayout@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
call ['_set_input_locale']
add ['esp,', '4']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+nShowCmd]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetForegroundWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_pal,', '0']
mov ['ds:_logpal,', '0']
call ['_init_palette']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetForegroundWindow@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['ecx,', 'ecx']
cmp ['eax,', 'dword', 'ptr', 'ds:_hwnd']
setz ['cl']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_set_focus']
add ['esp,', '8']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__UpdateWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '1']
test ['ecx,', 'ecx']
jz ['$finished$89220']
call ['_toplevel_callback_pending']
test ['eax,', 'eax']
jnz ['short', 'loc_3E29']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['0']
push ['0']
lea ['edx,', '[ebp+Msg]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__PeekMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_3E35']
mov ['[ebp+dwMilliseconds],', '0']
jmp ['short', 'loc_3E69']
mov ['[ebp+dwMilliseconds],', '0FFFFFFFFh']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetForegroundWindow@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['ecx,', 'ecx']
cmp ['eax,', 'dword', 'ptr', 'ds:_hwnd']
setz ['cl']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_set_focus']
add ['esp,', '8']
lea ['eax,', '[ebp+nCount]']
push ['eax']
call ['_handle_get_events']
add ['esp,', '4']
mov ['[ebp+pHandles],', 'eax']
mov ['esi,', 'esp']
push ['4FFh']
mov ['ecx,', '[ebp+dwMilliseconds]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+pHandles]']
push ['edx']
mov ['eax,', '[ebp+nCount]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__MsgWaitForMultipleObjects@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_18C],', 'eax']
mov ['ecx,', '[ebp+var_18C]']
cmp ['ecx,', '[ebp+nCount]']
jnb ['short', 'loc_3EE6']
mov ['edx,', '[ebp+var_18C]']
mov ['eax,', '[ebp+pHandles]']
mov ['ecx,', '[eax+edx*4]']
push ['ecx']
call ['_handle_got_event']
add ['esp,', '4']
mov ['edx,', '[ebp+pHandles]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_3EF5']
mov ['eax,', '[ebp+pHandles]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['1']
push ['0']
push ['0']
push ['0']
lea ['ecx,', '[ebp+Msg]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__PeekMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_3F67']
cmp ['[ebp+Msg.message],', '12h']
jnz ['short', 'loc_3F1C']
jmp ['short', '$finished$89220']
mov ['esi,', 'esp']
mov ['edx,', 'dword', 'ptr', 'ds:_logbox']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__IsWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_3F54']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Msg]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_logbox']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__IsDialogMessageA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_3F67']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+Msg]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DispatchMessageA@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
call ['_run_toplevel_callbacks']
jmp ['loc_3DF4']
mov ['eax,', '[ebp+Msg.wParam]']
push ['eax']
call ['_cleanup_exit']
db ['83h']
db ['0C4h']
db ['4']
db ['8Bh']
db ['45h']
db ['0B4h']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN98']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '194h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['10h']
endp
_start_backend  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '42Ch']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_42C]']
mov ['ecx,', '10Bh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
push ['2']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
call ['_backend_from_proto']
add ['esp,', '4']
mov ['ds:_back,', 'eax']
cmp ['ds:_back,', '0']
jnz ['short', 'loc_4118']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG88969']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpCaption],', 'eax']
mov ['esi,', 'esp']
push ['30h']
mov ['edx,', '[ebp+lpCaption]']
push ['edx']
push ['offset', '$SG88971']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+lpCaption]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['1']
call ['_cleanup_exit']
db ['83h']
db ['0C4h']
db ['4']
push ['8']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'esp']
push ['eax']
push ['7']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
lea ['eax,', '[ebp+var_41C]']
push ['eax']
push ['1']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
push ['offset', '_backhandle']
push ['0']
mov ['ecx,', 'ds:_back']
mov ['edx,', '[ecx]']
call ['edx']
add ['esp,', '20h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_logctx']
push ['eax']
mov ['ecx,', 'ds:_backhandle']
push ['ecx']
mov ['edx,', 'ds:_back']
mov ['eax,', '[edx+34h]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_422F']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG88975']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_42C],', 'eax']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_dest']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG88976']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '10h']
mov ['esi,', 'esp']
push ['10h']
mov ['edx,', '[ebp+var_42C]']
push ['edx']
lea ['eax,', '[ebp+Dest]']
push ['eax']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_42C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
push ['0']
call ['_exit']
mov ['ds:_icon_name,', '0']
mov ['edx,', 'ds:_icon_name']
mov ['ds:_window_name,', 'edx']
push ['5Ah']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+Str],', 'eax']
mov ['ecx,', '[ebp+Str]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jnz ['short', 'loc_4295']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
mov ['ecx,', '[ebp+var_41C]']
push ['ecx']
push ['offset', '$SG88980']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_sprintf']
add ['esp,', '10h']
lea ['eax,', '[ebp+Dest]']
mov ['[ebp+Str],', 'eax']
mov ['ecx,', '[ebp+var_41C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['0']
call ['_set_title']
add ['esp,', '8']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['0']
call ['_set_icon']
add ['esp,', '8']
mov ['ecx,', 'ds:_backhandle']
push ['ecx']
mov ['edx,', 'ds:_back']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_provide_resize_fn']
add ['esp,', '0Ch']
push ['0']
mov ['edx,', 'ds:_backhandle']
push ['edx']
mov ['eax,', 'ds:_back']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_ldisc_create']
add ['esp,', '14h']
mov ['ds:_ldisc,', 'eax']
mov ['[ebp+var_424],', '0']
jmp ['short', 'loc_432B']
mov ['eax,', '[ebp+var_424]']
add ['eax,', '1']
mov ['[ebp+var_424],', 'eax']
cmp ['[ebp+var_424],', '2']
jnb ['short', 'loc_4357']
mov ['esi,', 'esp']
push ['0']
push ['40h']
mov ['ecx,', '[ebp+var_424]']
mov ['edx,', 'ds:_popup_menus[ecx*4]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DeleteMenu@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_431C']
mov ['ds:_session_closed,', '0']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN12']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '42Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_cleanup_exit   proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
call ['_deinit_fonts']
mov ['eax,', 'ds:_logpal']
push ['eax']
call ['_safefree']
add ['esp,', '4']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_43FE']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:_pal']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
call ['_sk_cleanup']
push ['2']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '3']
jnz ['short', 'loc_441E']
call ['_random_save_seed']
call ['_shutdown_help']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__CoUninitialize@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+Code]']
push ['eax']
call ['_exit']
endp
_do_select      proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_447A']
mov ['[ebp+var_4],', '8005h']
mov ['[ebp+var_8],', '3Fh']
jmp ['short', 'loc_4487']
mov ['[ebp+var_8],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['[ebp+var_4],', 'eax']
cmp ['dword', 'ptr', 'ds:_hwnd,', '0']
jnz ['short', 'loc_4497']
mov ['eax,', 'offset', '$SG89239']
jmp ['short', 'loc_44EA']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['dword', 'ptr', 'ds:_p_WSAAsyncSelect']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '0FFFFFFFFh']
jnz ['short', 'loc_44E8']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '2742h']
jz ['short', 'loc_44DA']
jmp ['short', 'loc_44E1']
mov ['eax,', 'offset', '$SG89246']
jmp ['short', 'loc_44EA']
mov ['eax,', 'offset', '$SG89248']
jmp ['short', 'loc_44EA']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_update_savedsess_menu proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['esi,', 'esp']
push ['400h']
push ['0']
mov ['eax,', 'ds:_savedsess_menu']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DeleteMenu@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_453F']
jmp ['short', 'loc_451D']
mov ['[ebp+var_4],', '1']
jmp ['short', 'loc_4551']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '1']
mov ['[ebp+var_4],', 'ecx']
cmp ['ds:_sesslist,', '401h']
jg ['short', 'loc_4568']
mov ['edx,', 'ds:_sesslist']
mov ['[ebp+var_8],', 'edx']
jmp ['short', 'loc_456F']
mov ['[ebp+var_8],', '401h']
mov ['eax,', '[ebp+var_4]']
cmp ['eax,', '[ebp+var_8]']
jge ['short', 'loc_45AE']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', 'ds:dword_10E0']
mov ['eax,', '[edx+ecx*4]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
sub ['ecx,', '1']
shl ['ecx,', '4']
add ['ecx,', '1000h']
push ['ecx']
push ['0']
mov ['edx,', 'ds:_savedsess_menu']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_4548']
cmp ['ds:_sesslist,', '1']
jg ['short', 'loc_45D8']
mov ['esi,', 'esp']
push ['offset', '$SG89260']
push ['1000h']
push ['1']
mov ['eax,', 'ds:_savedsess_menu']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_update_specials_menu proc near         
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+hMenu],', 'eax']
cmp ['ds:_back,', '0']
jz ['short', 'loc_4633']
mov ['esi,', 'esp']
mov ['eax,', 'ds:_backhandle']
push ['eax']
mov ['ecx,', 'ds:_back']
mov ['edx,', '[ecx+1Ch]']
call ['edx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_specials,', 'eax']
jmp ['short', 'loc_463D']
mov ['ds:_specials,', '0']
cmp ['ds:_specials,', '0']
jz ['loc_47BE']
mov ['[ebp+var_10],', '0']
mov ['[ebp+var_14],', '1']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__CreatePopupMenu@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hMenu],', 'eax']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_467C']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_14],', '0']
jle ['loc_47B0']
mov ['ecx,', '[ebp+var_8]']
shl ['ecx,', '4']
add ['ecx,', '400h']
cmp ['ecx,', '800h']
jl ['short', 'loc_46B1']
push ['3E8h']
push ['offset', '$SG89278']
push ['offset', '$SG89279']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', 'ds:_specials']
mov ['edx,', '[ecx+eax*8+4]']
mov ['[ebp+var_18],', 'edx']
cmp ['[ebp+var_18],', '1Fh']
jz ['short', 'loc_46DC']
cmp ['[ebp+var_18],', '20h']
jz ['short', 'loc_46FD']
cmp ['[ebp+var_18],', '21h']
jz ['loc_4763']
jmp ['loc_477D']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['800h']
mov ['eax,', '[ebp+hMenu]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_47AB']
cmp ['[ebp+var_14],', '2']
jl ['short', 'loc_471A']
push ['3EEh']
push ['offset', '$SG89287']
push ['offset', '$SG89288']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '1']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+hMenu]']
mov ['[ebp+var_10],', 'eax']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__CreatePopupMenu@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hMenu],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', 'ds:_specials']
mov ['eax,', '[edx+ecx*8]']
push ['eax']
mov ['ecx,', '[ebp+hMenu]']
push ['ecx']
push ['10h']
mov ['edx,', '[ebp+var_10]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_47AB']
mov ['eax,', '[ebp+var_14]']
sub ['eax,', '1']
mov ['[ebp+var_14],', 'eax']
jz ['short', 'loc_477B']
mov ['ecx,', '[ebp+var_10]']
mov ['[ebp+hMenu],', 'ecx']
mov ['[ebp+var_10],', '0']
jmp ['short', 'loc_47AB']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', 'ds:_specials']
mov ['ecx,', '[eax+edx*8]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
shl ['edx,', '4']
add ['edx,', '400h']
push ['edx']
push ['0']
mov ['eax,', '[ebp+hMenu]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__AppendMenuA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_4673']
mov ['ecx,', '[ebp+var_8]']
sub ['ecx,', '1']
mov ['ds:_n_specials,', 'ecx']
jmp ['short', 'loc_47CF']
mov ['[ebp+hMenu],', '0']
mov ['ds:_n_specials,', '0']
mov ['[ebp+var_C],', '0']
jmp ['short', 'loc_47E1']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '1']
mov ['[ebp+var_C],', 'edx']
cmp ['[ebp+var_C],', '2']
jnb ['loc_4891']
cmp ['ds:_specials_menu,', '0']
jz ['short', 'loc_4837']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', 'ds:_specials_menu']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', 'ds:_popup_menus[ecx*4]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DeleteMenu@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['200h']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', 'ds:_popup_menus[eax*4]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__DeleteMenu@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+hMenu],', '0']
jz ['short', 'loc_488C']
mov ['esi,', 'esp']
push ['offset', '$SG89303']
mov ['edx,', '[ebp+hMenu]']
push ['edx']
push ['10h']
push ['10h']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', 'ds:_popup_menus[eax*4]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__InsertMenuA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['200h']
push ['800h']
push ['10h']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', 'ds:_popup_menus[edx*4]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__InsertMenuA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_47D8']
mov ['ecx,', '[ebp+hMenu]']
mov ['ds:_specials_menu,', 'ecx']
pop ['esi']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_set_busy_status proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
mov ['ds:_busy_status,', 'eax']
call ['_update_mouse_pointer']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_update_mouse_pointer proc near         
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+dwNewLong],', 'eax']
mov ['[ebp+bShow],', 'eax']
mov ['[ebp+lpCursorName],', 'eax']
mov ['byte', 'ptr', '[ebp+var_10+3],', '0']
mov ['[ebp+bShow],', '0']
mov ['eax,', 'ds:_busy_status']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_491A']
cmp ['[ebp+var_14],', '1']
jz ['short', 'loc_493D']
cmp ['[ebp+var_14],', '2']
jz ['short', 'loc_4951']
jmp ['short', 'loc_4965']
cmp ['ds:_send_raw_mouse,', '0']
jz ['short', 'loc_4930']
mov ['byte', 'ptr', '[ebp+var_10+3],', '1']
mov ['[ebp+lpCursorName],', '7F00h']
jmp ['short', 'loc_493B']
mov ['byte', 'ptr', '[ebp+var_10+3],', '1']
mov ['[ebp+lpCursorName],', '7F01h']
jmp ['short', 'loc_4980']
mov ['byte', 'ptr', '[ebp+var_10+3],', '1']
mov ['[ebp+lpCursorName],', '7F8Ah']
mov ['[ebp+bShow],', '1']
jmp ['short', 'loc_4980']
mov ['byte', 'ptr', '[ebp+var_10+3],', '1']
mov ['[ebp+lpCursorName],', '7F02h']
mov ['[ebp+bShow],', '1']
jmp ['short', 'loc_4980']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_4980']
push ['42Fh']
push ['offset', '$SG89334']
push ['offset', '$SG89335']
call ['__wassert']
add ['esp,', '0Ch']
cmp ['byte', 'ptr', '[ebp+var_10+3],', '0']
jnz ['short', 'loc_4993']
push ['offset', '$LN14']
call ['__RTC_UninitUse']
add ['esp,', '4']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+lpCursorName]']
push ['eax']
push ['0']
call ['dword', 'ptr', 'ds:__imp__LoadCursorA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwNewLong],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+dwNewLong]']
push ['ecx']
push ['0FFFFFFF4h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetClassLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+dwNewLong]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetCursor@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+bShow]']
cmp ['ecx,', 'ds:?forced_visible@?1??update_mouse_pointer@@9@9']
jz ['short', 'loc_4A00']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+bShow]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ShowCursor@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+bShow]']
mov ['ds:?forced_visible@?1??update_mouse_pointer@@9@9,', 'eax']
pop ['esi']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_set_raw_mouse_mode proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_4A46']
push ['42h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_4A46']
mov ['[ebp+var_4],', '1']
jmp ['short', 'loc_4A4D']
mov ['[ebp+var_4],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['[ebp+arg_4],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['ds:_send_raw_mouse,', 'edx']
call ['_update_mouse_pointer']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_connection_fatal proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '78h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_78]']
mov ['ecx,', '1Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_dupvprintf']
add ['esp,', '8']
mov ['[ebp+lpText],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG89362']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['10h']
lea ['edx,', '[ebp+Dest]']
push ['edx']
mov ['eax,', '[ebp+lpText]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+lpText]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['4']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_4B23']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__PostQuitMessage@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_4B32']
push ['0']
push ['offset', '_close_session']
call ['_queue_toplevel_callback']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN7_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '78h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_close_session  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '74h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_74]']
mov ['ecx,', '1Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['ds:_session_closed,', '1']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG88993']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
lea ['edx,', '[ebp+Dest]']
push ['edx']
push ['0']
call ['_set_icon']
add ['esp,', '8']
lea ['eax,', '[ebp+Dest]']
push ['eax']
push ['0']
call ['_set_title']
add ['esp,', '8']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_4C08']
mov ['ecx,', 'ds:_ldisc']
push ['ecx']
call ['_ldisc_free']
add ['esp,', '4']
mov ['ds:_ldisc,', '0']
cmp ['ds:_back,', '0']
jz ['short', 'loc_4C5F']
mov ['esi,', 'esp']
mov ['edx,', 'ds:_backhandle']
push ['edx']
mov ['eax,', 'ds:_back']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_backhandle,', '0']
mov ['ds:_back,', '0']
push ['0']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_provide_resize_fn']
add ['esp,', '0Ch']
push ['0']
call ['_update_specials_menu']
add ['esp,', '4']
mov ['[ebp+var_74],', '0']
jmp ['short', 'loc_4C71']
mov ['eax,', '[ebp+var_74]']
add ['eax,', '1']
mov ['[ebp+var_74],', 'eax']
cmp ['[ebp+var_74],', '2']
jnb ['short', 'loc_4CBC']
mov ['esi,', 'esp']
push ['0']
push ['40h']
mov ['ecx,', '[ebp+var_74]']
mov ['edx,', 'ds:_popup_menus[ecx*4]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DeleteMenu@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '$SG89007']
push ['40h']
push ['0']
push ['30h']
mov ['eax,', '[ebp+var_74]']
mov ['ecx,', 'ds:_popup_menus[eax*4]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__InsertMenuA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_4C68']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN10_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '74h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_cmdline_error  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '78h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_78]']
mov ['ecx,', '1Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dupvprintf']
add ['esp,', '8']
mov ['[ebp+lpText],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG89376']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['10h']
lea ['edx,', '[ebp+Dest]']
push ['edx']
mov ['eax,', '[ebp+lpText]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+lpText]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['1']
call ['_exit']
endp
_conftopalette  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_4E20']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '16h']
jge ['loc_4EB7']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', 'ds:?ww@?1??conftopalette@@9@9[ecx*4]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
push ['eax']
push ['84h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '3']
mov ['ds:byte_282[edx],', 'al']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
add ['eax,', '1']
push ['eax']
push ['84h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '3']
mov ['ds:byte_281[edx],', 'al']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
add ['eax,', '2']
push ['eax']
push ['84h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '3']
mov ['ds:_defpal[edx],', 'al']
jmp ['loc_4E17']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_4EC9']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0F0h']
jge ['loc_4FF1']
cmp ['[ebp+var_4],', '0D8h']
jge ['loc_4F9E']
mov ['eax,', '[ebp+var_4]']
cdq
mov ['ecx,', '24h']
idiv ['ecx']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_4]']
cdq
mov ['ecx,', '6']
idiv ['ecx']
cdq
mov ['ecx,', '6']
idiv ['ecx']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_4]']
cdq
mov ['ecx,', '6']
idiv ['ecx']
mov ['[ebp+var_14],', 'edx']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_4F29']
mov ['edx,', '[ebp+var_C]']
imul ['edx,', '28h']
add ['edx,', '37h']
mov ['[ebp+var_1C],', 'edx']
jmp ['short', 'loc_4F30']
mov ['[ebp+var_1C],', '0']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '10h']
imul ['eax,', '3']
mov ['cl,', 'byte', 'ptr', '[ebp+var_1C]']
mov ['ds:byte_282[eax],', 'cl']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_4F56']
mov ['edx,', '[ebp+var_10]']
imul ['edx,', '28h']
add ['edx,', '37h']
mov ['[ebp+var_20],', 'edx']
jmp ['short', 'loc_4F5D']
mov ['[ebp+var_20],', '0']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '10h']
imul ['eax,', '3']
mov ['cl,', 'byte', 'ptr', '[ebp+var_20]']
mov ['ds:byte_281[eax],', 'cl']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_4F83']
mov ['edx,', '[ebp+var_14]']
imul ['edx,', '28h']
add ['edx,', '37h']
mov ['[ebp+var_24],', 'edx']
jmp ['short', 'loc_4F8A']
mov ['[ebp+var_24],', '0']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '10h']
imul ['eax,', '3']
mov ['cl,', 'byte', 'ptr', '[ebp+var_24]']
mov ['ds:_defpal[eax],', 'cl']
jmp ['short', 'loc_4FEC']
mov ['edx,', '[ebp+var_4]']
sub ['edx,', '0D8h']
mov ['[ebp+var_18],', 'edx']
mov ['eax,', '[ebp+var_18]']
imul ['eax,', '0Ah']
add ['eax,', '8']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '10h']
imul ['ecx,', '3']
mov ['dl,', 'byte', 'ptr', '[ebp+var_18]']
mov ['ds:_defpal[ecx],', 'dl']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '10h']
imul ['eax,', '3']
mov ['cl,', 'byte', 'ptr', '[ebp+var_18]']
mov ['ds:byte_281[eax],', 'cl']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '10h']
imul ['edx,', '3']
mov ['al,', 'byte', 'ptr', '[ebp+var_18]']
mov ['ds:byte_282[edx],', 'al']
jmp ['loc_4EC0']
push ['81h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_500E']
call ['_systopalette']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_systopalette   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_5055']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '4']
jnb ['loc_513D']
mov ['ecx,', '[ebp+var_4]']
imul ['ecx,', '0Ch']
mov ['esi,', 'esp']
mov ['edx,', 'ds:?or@?1??systopalette@@9@9[ecx]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetSysColor@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+var_8]']
and ['eax,', '0FFh']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_4]']
imul ['ecx,', '0Ch']
mov ['edx,', 'ds:off_2170[ecx]']
imul ['edx,', '3']
mov ['al,', 'byte', 'ptr', '[ebp+var_C]']
mov ['ds:byte_282[edx],', 'al']
mov ['ecx,', '[ebp+var_4]']
imul ['ecx,', '0Ch']
mov ['edx,', 'ds:off_216C[ecx]']
imul ['edx,', '3']
mov ['al,', 'byte', 'ptr', '[ebp+var_C]']
mov ['ds:byte_282[edx],', 'al']
movzx ['ecx,', 'word', 'ptr', '[ebp+var_8]']
sar ['ecx,', '8']
and ['ecx,', '0FFh']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '0Ch']
mov ['eax,', 'ds:off_2170[edx]']
imul ['eax,', '3']
mov ['cl,', 'byte', 'ptr', '[ebp+var_10]']
mov ['ds:byte_281[eax],', 'cl']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '0Ch']
mov ['eax,', 'ds:off_216C[edx]']
imul ['eax,', '3']
mov ['cl,', 'byte', 'ptr', '[ebp+var_10]']
mov ['ds:byte_281[eax],', 'cl']
mov ['edx,', '[ebp+var_8]']
shr ['edx,', '10h']
and ['edx,', '0FFh']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', 'ds:off_2170[eax]']
imul ['ecx,', '3']
mov ['dl,', 'byte', 'ptr', '[ebp+var_14]']
mov ['ds:_defpal[ecx],', 'dl']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', 'ds:off_216C[eax]']
imul ['ecx,', '3']
mov ['dl,', 'byte', 'ptr', '[ebp+var_14]']
mov ['ds:_defpal[ecx],', 'dl']
jmp ['loc_504C']
pop ['esi']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_init_palette   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
push ['edi']
mov ['[ebp+hdc],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetDC@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hdc],', 'eax']
cmp ['[ebp+hdc],', '0']
jz ['loc_5304']
push ['82h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_52EA']
mov ['esi,', 'esp']
push ['26h']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetDeviceCaps@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
and ['eax,', '100h']
jz ['loc_52EA']
push ['1']
push ['41Ch']
call ['_safemalloc']
add ['esp,', '8']
mov ['ds:_logpal,', 'eax']
mov ['eax,', '300h']
mov ['ecx,', 'ds:_logpal']
mov ['[ecx],', 'ax']
mov ['edx,', '106h']
mov ['eax,', 'ds:_logpal']
mov ['[eax+2],', 'dx']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_520E']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '1']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+var_4],', '106h']
jge ['short', 'loc_5270']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '3']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', 'ds:_logpal']
mov ['dl,', 'ds:byte_282[edx]']
mov ['[ecx+eax*4+4],', 'dl']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', 'ds:_logpal']
mov ['al,', 'ds:byte_281[eax]']
mov ['[edx+ecx*4+5],', 'al']
mov ['ecx,', '[ebp+var_4]']
imul ['ecx,', '3']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', 'ds:_logpal']
mov ['cl,', 'ds:_defpal[ecx]']
mov ['[eax+edx*4+6],', 'cl']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', 'ds:_logpal']
mov ['byte', 'ptr', '[eax+edx*4+7],', '4']
jmp ['short', 'loc_5205']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:_logpal']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__CreatePalette@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_pal,', 'eax']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_52EA']
mov ['esi,', 'esp']
push ['0']
mov ['edx,', 'ds:_pal']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SelectPalette@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__RealizePalette@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
mov ['edi,', 'esp']
push ['0Fh']
call ['dword', 'ptr', 'ds:__imp__GetStockObject@4']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectPalette@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hdc]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ReleaseDC@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_536D']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_531F']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '1']
mov ['[ebp+var_4],', 'edx']
cmp ['[ebp+var_4],', '106h']
jge ['short', 'loc_536B']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
movzx ['ecx,', 'ds:byte_282[eax]']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '3']
movzx ['eax,', 'ds:byte_281[edx]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '3']
movzx ['eax,', 'ds:_defpal[edx]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
or ['ecx,', '2000000h']
mov ['edx,', '[ebp+var_4]']
mov ['ds:_colours[edx*4],', 'ecx']
jmp ['short', 'loc_5316']
jmp ['short', 'loc_53C5']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_537F']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '106h']
jge ['short', 'loc_53C5']
mov ['ecx,', '[ebp+var_4]']
imul ['ecx,', '3']
movzx ['edx,', 'ds:byte_282[ecx]']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
movzx ['ecx,', 'ds:byte_281[eax]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
movzx ['ecx,', 'ds:_defpal[eax]']
shl ['ecx,', '10h']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ds:_colours[eax*4],', 'edx']
jmp ['short', 'loc_5376']
pop ['edi']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_init_fonts     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0E8h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_E8]']
mov ['ecx,', '3Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_7C],', '0']
jmp ['short', 'loc_5411']
mov ['eax,', '[ebp+var_7C]']
add ['eax,', '1']
mov ['[ebp+var_7C],', 'eax']
cmp ['[ebp+var_7C],', '40h']
jge ['short', 'loc_5427']
mov ['ecx,', '[ebp+var_7C]']
mov ['ds:_fonts[ecx*4],', '0']
jmp ['short', 'loc_5408']
push ['83h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
and ['eax,', '1']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '2']
mov ['ds:_bold_font_mode,', 'eax']
push ['83h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
and ['eax,', '2']
neg ['eax']
sbb ['eax,', 'eax']
neg ['eax']
mov ['ds:_bold_colours,', 'eax']
mov ['ds:_und_mode,', '1']
push ['70h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_fontspec']
add ['esp,', '8']
mov ['[ebp+var_64],', 'eax']
mov ['edx,', '[ebp+var_64]']
cmp ['dword', 'ptr', '[edx+4],', '0']
jz ['short', 'loc_54A8']
mov ['[ebp+cWeight],', '2BCh']
mov ['[ebp+var_8C],', '384h']
jmp ['short', 'loc_54BC']
mov ['[ebp+cWeight],', '0']
mov ['[ebp+var_8C],', '2BCh']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetDC@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hdc],', 'eax']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_54E8']
mov ['ecx,', '[ebp+arg_4]']
mov ['ds:_font_height,', 'ecx']
jmp ['short', 'loc_5534']
mov ['edx,', '[ebp+var_64]']
mov ['eax,', '[edx+8]']
mov ['ds:_font_height,', 'eax']
cmp ['ds:_font_height,', '0']
jle ['short', 'loc_5534']
mov ['esi,', 'esp']
push ['48h']
mov ['edi,', 'esp']
push ['5Ah']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetDeviceCaps@8']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
mov ['edx,', 'ds:_font_height']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__MulDiv@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
neg ['eax']
mov ['ds:_font_height,', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ds:_font_width,', 'eax']
push ['71h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_80],', 'eax']
cmp ['[ebp+var_80],', '0']
jnz ['short', 'loc_5562']
mov ['[ebp+iQuality],', '0']
jmp ['short', 'loc_5593']
cmp ['[ebp+var_80],', '1']
jnz ['short', 'loc_5574']
mov ['[ebp+var_D8],', '4']
jmp ['short', 'loc_5587']
xor ['edx,', 'edx']
cmp ['[ebp+var_80],', '2']
setnz ['dl']
lea ['edx,', '[edx+edx+3]']
mov ['[ebp+var_D8],', 'edx']
mov ['eax,', '[ebp+var_D8]']
mov ['[ebp+iQuality],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_64]']
mov ['edx,', '[ecx]']
push ['edx']
push ['1']
mov ['eax,', '[ebp+iQuality]']
push ['eax']
push ['0']
push ['0']
mov ['ecx,', '[ebp+var_64]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
push ['0']
push ['0']
push ['0']
mov ['eax,', '[ebp+cWeight]']
push ['eax']
push ['0']
push ['0']
mov ['ecx,', 'ds:_font_width']
push ['ecx']
mov ['edx,', 'ds:_font_height']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__CreateFontA@56']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_fonts,', 'eax']
mov ['esi,', 'esp']
mov ['eax,', 'ds:_fonts']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+tm]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetTextMetricsA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '_lfont']
push ['3Ch']
mov ['ecx,', 'ds:_fonts']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetObjectA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
movzx ['edx,', '[ebp+tm.tmPitchAndFamily]']
and ['edx,', '1']
jnz ['short', 'loc_5659']
mov ['ds:_font_varpitch,', '0']
mov ['eax,', '[ebp+tm.tmAveCharWidth]']
xor ['ecx,', 'ecx']
cmp ['eax,', '[ebp+tm.tmMaxCharWidth]']
setnz ['cl']
mov ['ds:_font_dualwidth,', 'ecx']
jmp ['short', 'loc_566D']
mov ['ds:_font_varpitch,', '1']
mov ['ds:_font_dualwidth,', '1']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_5679']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_569A']
mov ['edx,', '[ebp+tm.tmHeight]']
mov ['ds:_font_height,', 'edx']
lea ['eax,', '[ebp+tm]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['_get_font_width']
add ['esp,', '8']
mov ['ds:_font_width,', 'eax']
movzx ['edx,', '[ebp+tm.tmCharSet]']
mov ['[ebp+lpSrc],', 'edx']
push ['20h']
push ['0FFh']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
cmp ['[ebp+lpSrc],', '0FFh']
jnz ['short', 'loc_56DC']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetOEMCP@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:CodePage,', 'eax']
jmp ['short', 'loc_5716']
mov ['esi,', 'esp']
push ['1']
lea ['ecx,', '[ebp+Dst]']
push ['ecx']
mov ['edx,', '[ebp+lpSrc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__TranslateCharsetInfo@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_570C']
mov ['eax,', '[ebp+var_AC]']
mov ['ds:CodePage,', 'eax']
jmp ['short', 'loc_5716']
mov ['ds:CodePage,', '0FFFFFFFFh']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+CPInfo]']
push ['ecx']
mov ['edx,', 'ds:CodePage']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetCPInfo@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
cmp ['eax,', '[ebp+CPInfo.MaxCharSize]']
sbb ['ecx,', 'ecx']
neg ['ecx']
mov ['ds:dword_5C4,', 'ecx']
cmp ['[ebp+var_80],', '0']
jnz ['short', 'loc_5754']
mov ['[ebp+var_DC],', '0']
jmp ['short', 'loc_5785']
cmp ['[ebp+var_80],', '1']
jnz ['short', 'loc_5766']
mov ['[ebp+var_E0],', '4']
jmp ['short', 'loc_5779']
xor ['edx,', 'edx']
cmp ['[ebp+var_80],', '2']
setnz ['dl']
lea ['edx,', '[edx+edx+3]']
mov ['[ebp+var_E0],', 'edx']
mov ['eax,', '[ebp+var_E0]']
mov ['[ebp+var_DC],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_64]']
mov ['edx,', '[ecx]']
push ['edx']
push ['1']
mov ['eax,', '[ebp+var_DC]']
push ['eax']
push ['0']
push ['0']
mov ['ecx,', '[ebp+var_64]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
push ['0']
push ['1']
push ['0']
mov ['eax,', '[ebp+cWeight]']
push ['eax']
push ['0']
push ['0']
mov ['ecx,', 'ds:_font_width']
push ['ecx']
mov ['edx,', 'ds:_font_height']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__CreateFontA@56']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:ho,', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__CreateCompatibleDC@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_BC],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:_font_height']
push ['ecx']
mov ['edx,', 'ds:_font_width']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__CreateCompatibleBitmap@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+h],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+h]']
push ['ecx']
mov ['edx,', '[ebp+var_BC]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C4],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', 'ds:ho']
push ['eax']
mov ['ecx,', '[ebp+var_BC]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
mov ['edx,', '[ebp+var_BC]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetTextAlign@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0FFFFFFh']
mov ['eax,', '[ebp+var_BC]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetTextColor@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+var_BC]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetBkColor@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['2']
mov ['edx,', '[ebp+var_BC]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetBkMode@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['1']
push ['offset', '$SG89593']
push ['0']
push ['2']
push ['0']
push ['0']
mov ['eax,', '[ebp+var_BC]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__ExtTextOutA@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_CC],', '0']
mov ['[ebp+y],', '0']
jmp ['short', 'loc_5906']
mov ['ecx,', '[ebp+y]']
add ['ecx,', '1']
mov ['[ebp+y],', 'ecx']
mov ['edx,', '[ebp+y]']
cmp ['edx,', 'ds:_font_height']
jge ['short', 'loc_5957']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+y]']
push ['eax']
mov ['eax,', 'ds:_font_width']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
push ['eax']
mov ['ecx,', '[ebp+var_BC]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetPixel@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_D0],', 'eax']
cmp ['[ebp+var_D0],', '0']
jz ['short', 'loc_5955']
mov ['[ebp+var_CC],', '1']
jmp ['short', 'loc_58F7']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_C4]']
push ['edx']
mov ['eax,', '[ebp+var_BC]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+h]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_BC]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DeleteDC@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+var_CC],', '0']
jnz ['short', 'loc_59D2']
mov ['ds:_und_mode,', '0']
mov ['esi,', 'esp']
mov ['eax,', 'ds:ho']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:ho,', '0']
cmp ['ds:_bold_font_mode,', '2']
jnz ['loc_5A6E']
cmp ['[ebp+var_80],', '0']
jnz ['short', 'loc_59F1']
mov ['[ebp+var_E4],', '0']
jmp ['short', 'loc_5A22']
cmp ['[ebp+var_80],', '1']
jnz ['short', 'loc_5A03']
mov ['[ebp+var_E8],', '4']
jmp ['short', 'loc_5A16']
xor ['ecx,', 'ecx']
cmp ['[ebp+var_80],', '2']
setnz ['cl']
lea ['ecx,', '[ecx+ecx+3]']
mov ['[ebp+var_E8],', 'ecx']
mov ['edx,', '[ebp+var_E8]']
mov ['[ebp+var_E4],', 'edx']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_64]']
mov ['ecx,', '[eax]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+var_E4]']
push ['edx']
push ['0']
push ['0']
mov ['eax,', '[ebp+var_64]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
push ['0']
push ['0']
push ['0']
mov ['edx,', '[ebp+var_8C]']
push ['edx']
push ['0']
push ['0']
mov ['eax,', 'ds:_font_width']
push ['eax']
mov ['ecx,', 'ds:_font_height']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__CreateFontA@56']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:dword_164,', 'eax']
mov ['edx,', '[ebp+tm.tmAscent]']
add ['edx,', '1']
mov ['ds:_descent,', 'edx']
mov ['eax,', 'ds:_descent']
cmp ['eax,', 'ds:_font_height']
jl ['short', 'loc_5A96']
mov ['ecx,', 'ds:_font_height']
sub ['ecx,', '1']
mov ['ds:_descent,', 'ecx']
mov ['[ebp+var_7C],', '0']
jmp ['short', 'loc_5AA8']
mov ['edx,', '[ebp+var_7C]']
add ['edx,', '1']
mov ['[ebp+var_7C],', 'edx']
cmp ['[ebp+var_7C],', '3']
jge ['loc_5B45']
mov ['eax,', '[ebp+var_7C]']
cmp ['ds:_fonts[eax*4],', '0']
jz ['short', 'loc_5B34']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_7C]']
mov ['edx,', 'ds:_fonts[ecx*4]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_5B26']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+tm]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetTextMetricsA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_5B26']
lea ['eax,', '[ebp+tm]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['_get_font_width']
add ['esp,', '8']
mov ['edx,', '[ebp+tm.tmHeight]']
shl ['edx,', '8']
add ['eax,', 'edx']
mov ['ecx,', '[ebp+var_7C]']
mov ['[ebp+ecx*4+var_74],', 'eax']
jmp ['short', 'loc_5B32']
mov ['edx,', '[ebp+var_7C]']
neg ['edx']
mov ['eax,', '[ebp+var_7C]']
mov ['[ebp+eax*4+var_74],', 'edx']
jmp ['short', 'loc_5B40']
mov ['ecx,', '[ebp+var_7C]']
neg ['ecx']
mov ['edx,', '[ebp+var_7C]']
mov ['[ebp+edx*4+var_74],', 'ecx']
jmp ['loc_5A9F']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hdc]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ReleaseDC@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_6C]']
cmp ['edx,', '[ebp+var_74]']
jz ['short', 'loc_5B93']
mov ['ds:_und_mode,', '0']
mov ['esi,', 'esp']
mov ['eax,', 'ds:ho']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:ho,', '0']
cmp ['ds:_bold_font_mode,', '2']
jnz ['short', 'loc_5BCE']
mov ['ecx,', '[ebp+var_70]']
cmp ['ecx,', '[ebp+var_74]']
jz ['short', 'loc_5BCE']
mov ['ds:_bold_font_mode,', '1']
mov ['esi,', 'esp']
mov ['edx,', 'ds:dword_164']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:dword_164,', '0']
mov ['ds:dword_48,', '1']
mov ['eax,', 'ds:dword_48']
mov ['ds:dword_44,', 'eax']
mov ['ecx,', 'ds:dword_44']
mov ['ds:_fontflag,', 'ecx']
push ['offset', '_ucsdata']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_init_ucs']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN52']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '0E8h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_get_font_width proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '90h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_90]']
mov ['ecx,', '24h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
movzx ['ecx,', 'byte', 'ptr', '[eax+33h]']
and ['ecx,', '1']
jnz ['short', 'loc_5CC9']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
mov ['[ebp+var_8],', 'eax']
jmp ['loc_5D86']
mov ['ds:_font_varpitch,', '1']
mov ['ds:_font_dualwidth,', '1']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+ABC]']
push ['ecx']
push ['39h']
push ['30h']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetCharABCWidthsFloatA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_5D7D']
mov ['[ebp+var_8],', '0']
mov ['[ebp+var_8C],', '0']
jmp ['short', 'loc_5D21']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '1']
mov ['[ebp+var_8C],', 'eax']
cmp ['[ebp+var_8C],', '0Ah']
jnb ['short', 'loc_5D7B']
mov ['ecx,', '[ebp+var_8C]']
imul ['ecx,', '0Ch']
fld ['[ebp+ecx+ABC.abcfA]']
fadd ['ds:__real@3fe0000000000000']
mov ['edx,', '[ebp+var_8C]']
imul ['edx,', '0Ch']
fadd ['[ebp+edx+ABC.abcfB]']
mov ['eax,', '[ebp+var_8C]']
imul ['eax,', '0Ch']
fadd ['[ebp+eax+ABC.abcfC]']
call ['__ftol2_sse']
mov ['[ebp+var_90],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[ebp+var_90]']
jge ['short', 'loc_5D79']
mov ['edx,', '[ebp+var_90]']
mov ['[ebp+var_8],', 'edx']
jmp ['short', 'loc_5D12']
jmp ['short', 'loc_5D86']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+18h]']
mov ['[ebp+var_8],', 'ecx']
mov ['eax,', '[ebp+var_8]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN13']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '90h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_deinit_fonts   proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_5DF6']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '40h']
jge ['short', 'loc_5E41']
mov ['ecx,', '[ebp+var_4]']
cmp ['ds:_fonts[ecx*4],', '0']
jz ['short', 'loc_5E23']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', 'ds:_fonts[edx*4]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_4]']
mov ['ds:_fonts[ecx*4],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['ds:_fontflag[edx*4],', '0']
jmp ['short', 'loc_5DED']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_request_resize proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+cy],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_5EA7']
push ['6Ah']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_5EA7']
jmp ['loc_6055']
push ['6Ah']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '1']
jnz ['short', 'loc_5EC2']
jmp ['loc_6055']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', '[ebp+arg_8]']
cmp ['ecx,', '[eax+128h]']
jnz ['short', 'loc_5EE8']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[edx+12Ch]']
jnz ['short', 'loc_5EE8']
jmp ['loc_6055']
mov ['ecx,', '?first_time@?3??request_resize@@9@9']
mov ['[ebp+var_C],', 'ecx']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_5F21']
cmp ['[ebp+var_C],', '1']
jz ['short', 'loc_5F02']
jmp ['loc_5F89']
push ['offset', '?ss@?3??request_resize@@9@9']
call ['_get_fullscreen_rect']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_5F15']
jmp ['short', 'loc_5F21']
mov ['?first_time@?3??request_resize@@9@9,', '2']
jmp ['short', 'loc_5F89']
mov ['eax,', 'ds:dword_59C']
sub ['eax,', 'ds:?ss@?3??request_resize@@9@9']
sub ['eax,', 'ds:_extra_width']
cdq
and ['edx,', '3']
add ['eax,', 'edx']
sar ['eax,', '2']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'ds:dword_5A0']
sub ['eax,', 'ds:dword_598']
sub ['eax,', 'ds:_extra_height']
cdq
mov ['ecx,', '6']
idiv ['ecx']
mov ['[ebp+cy],', 'eax']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ebp+var_4]']
jg ['short', 'loc_5F6A']
mov ['eax,', '[ebp+arg_8]']
cmp ['eax,', '[ebp+cy]']
jle ['short', 'loc_5F6F']
jmp ['loc_6055']
cmp ['[ebp+arg_4],', '0Fh']
jge ['short', 'loc_5F7C']
mov ['[ebp+arg_4],', '0Fh']
cmp ['[ebp+arg_8],', '1']
jge ['short', 'loc_5F89']
mov ['[ebp+arg_8],', '1']
push ['5Bh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_size']
add ['esp,', '10h']
push ['6Ah']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jz ['short', 'loc_6032']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_6032']
mov ['ecx,', 'ds:_font_width']
imul ['ecx,', '[ebp+arg_4]']
add ['ecx,', 'ds:_extra_width']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', 'ds:_font_height']
imul ['edx,', '[ebp+arg_8]']
add ['edx,', 'ds:_extra_height']
mov ['[ebp+cy],', 'edx']
mov ['esi,', 'esp']
push ['116h']
mov ['eax,', '[ebp+cy]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
push ['0']
push ['0']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_603C']
push ['0']
call ['_reset_window']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_reset_window   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '4Ch']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_4C]']
mov ['ecx,', '13h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Rect]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetWindowRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_28]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetClientRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_28.right]']
sub ['ecx,', '[ebp+var_28.left]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_28.bottom]']
sub ['edx,', '[ebp+var_28.top]']
mov ['[ebp+var_C],', 'edx']
push ['6Ah']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_10],', 'eax']
push ['7Ah']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_10],', '1']
jnz ['short', 'loc_6102']
mov ['[ebp+arg_0],', '2']
cmp ['[ebp+arg_0],', '1']
jle ['short', 'loc_6119']
call ['_deinit_fonts']
push ['0']
push ['0']
call ['_init_fonts']
add ['esp,', '8']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_6125']
cmp ['[ebp+var_C],', '0']
jnz ['short', 'loc_612A']
jmp ['loc_6885']
cmp ['[ebp+arg_0],', '0']
jnz ['loc_61E0']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_width']
imul ['eax,', '[edx+12Ch]']
mov ['ecx,', '[ebp+var_8]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
cmp ['ds:_offset_width,', 'eax']
jnz ['short', 'loc_6180']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_height']
imul ['eax,', '[edx+128h]']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
cmp ['ds:_offset_height,', 'eax']
jz ['short', 'loc_61E0']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_width']
imul ['eax,', '[edx+12Ch]']
mov ['ecx,', '[ebp+var_8]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ds:_offset_width,', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_height']
imul ['eax,', '[edx+128h]']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ds:_offset_height,', 'eax']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['loc_63BF']
mov ['ecx,', '[ebp+Rect.right]']
sub ['ecx,', '[ebp+Rect.left]']
sub ['ecx,', '[ebp+var_28.right]']
add ['ecx,', '[ebp+var_28.left]']
mov ['ds:_extra_width,', 'ecx']
mov ['edx,', '[ebp+Rect.bottom]']
sub ['edx,', '[ebp+Rect.top]']
sub ['edx,', '[ebp+var_28.bottom]']
add ['edx,', '[ebp+var_28.top]']
mov ['ds:_extra_height,', 'edx']
cmp ['[ebp+var_10],', '0']
jz ['loc_62F3']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[ebp+var_8]']
cdq
idiv ['dword', 'ptr', '[ecx+12Ch]']
cmp ['ds:_font_width,', 'eax']
jnz ['short', 'loc_625F']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[ebp+var_C]']
cdq
idiv ['dword', 'ptr', '[ecx+128h]']
cmp ['ds:_font_height,', 'eax']
jz ['loc_62EE']
call ['_deinit_fonts']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[ebp+var_C]']
cdq
idiv ['dword', 'ptr', '[ecx+128h]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[ebp+var_8]']
cdq
idiv ['dword', 'ptr', '[ecx+12Ch]']
push ['eax']
call ['_init_fonts']
add ['esp,', '8']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_width']
imul ['eax,', '[edx+12Ch]']
mov ['ecx,', '[ebp+var_8]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ds:_offset_width,', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_height']
imul ['eax,', '[edx+128h]']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ds:_offset_height,', 'eax']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_63BA']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', 'ds:_font_width']
imul ['ecx,', '[eax+12Ch]']
cmp ['ecx,', '[ebp+var_8]']
jnz ['short', 'loc_6325']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_height']
imul ['eax,', '[edx+128h]']
cmp ['eax,', '[ebp+var_C]']
jz ['loc_63BA']
push ['5Bh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['eax,', '[ebp+var_8]']
cdq
idiv ['ds:_font_width']
push ['eax']
mov ['eax,', '[ebp+var_C]']
cdq
idiv ['ds:_font_height']
push ['eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_size']
add ['esp,', '10h']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', 'ds:_font_width']
imul ['ecx,', '[eax+12Ch]']
mov ['eax,', '[ebp+var_8]']
sub ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ds:_offset_width,', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_height']
imul ['eax,', '[edx+128h]']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ds:_offset_height,', 'eax']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_6885']
cmp ['[ebp+arg_0],', '0']
jle ['loc_64C0']
mov ['eax,', '[ebp+var_14]']
mov ['ds:_offset_height,', 'eax']
mov ['ecx,', 'ds:_offset_height']
mov ['ds:_offset_width,', 'ecx']
mov ['edx,', '[ebp+Rect.right]']
sub ['edx,', '[ebp+Rect.left]']
sub ['edx,', '[ebp+var_28.right]']
add ['edx,', '[ebp+var_28.left]']
mov ['eax,', 'ds:_offset_width']
lea ['ecx,', '[edx+eax*2]']
mov ['ds:_extra_width,', 'ecx']
mov ['edx,', '[ebp+Rect.bottom]']
sub ['edx,', '[ebp+Rect.top]']
sub ['edx,', '[ebp+var_28.bottom]']
add ['edx,', '[ebp+var_28.top]']
mov ['eax,', 'ds:_offset_height']
lea ['ecx,', '[edx+eax*2]']
mov ['ds:_extra_height,', 'ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_width']
imul ['eax,', '[edx+12Ch]']
mov ['ecx,', 'ds:_offset_width']
lea ['edx,', '[eax+ecx*2]']
cmp ['[ebp+var_8],', 'edx']
jnz ['short', 'loc_6451']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', 'ds:_font_height']
imul ['ecx,', '[eax+128h]']
mov ['edx,', 'ds:_offset_height']
lea ['eax,', '[ecx+edx*2]']
cmp ['[ebp+var_C],', 'eax']
jz ['short', 'loc_64A2']
mov ['esi,', 'esp']
push ['6']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', 'ds:_font_height']
imul ['edx,', '[ecx+128h]']
add ['edx,', 'ds:_extra_height']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', 'ds:_font_width']
imul ['ecx,', '[eax+12Ch]']
add ['ecx,', 'ds:_extra_width']
push ['ecx']
push ['0']
push ['0']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_6885']
cmp ['[ebp+var_10],', '0']
jnz ['short', 'loc_64CC']
cmp ['[ebp+arg_0],', '0']
jle ['short', 'loc_64E2']
cmp ['[ebp+var_10],', '3']
jnz ['short', 'loc_64D8']
cmp ['[ebp+arg_0],', '0']
jl ['short', 'loc_64E2']
cmp ['[ebp+arg_0],', '0']
jle ['loc_6772']
mov ['ecx,', '[ebp+var_14]']
mov ['ds:_offset_height,', 'ecx']
mov ['edx,', 'ds:_offset_height']
mov ['ds:_offset_width,', 'edx']
mov ['eax,', '[ebp+Rect.right]']
sub ['eax,', '[ebp+Rect.left]']
sub ['eax,', '[ebp+var_28.right]']
add ['eax,', '[ebp+var_28.left]']
mov ['ecx,', 'ds:_offset_width']
lea ['edx,', '[eax+ecx*2]']
mov ['ds:_extra_width,', 'edx']
mov ['eax,', '[ebp+Rect.bottom]']
sub ['eax,', '[ebp+Rect.top]']
sub ['eax,', '[ebp+var_28.bottom]']
add ['eax,', '[ebp+var_28.top]']
mov ['ecx,', 'ds:_offset_height']
lea ['edx,', '[eax+ecx*2]']
mov ['ds:_extra_height,', 'edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', 'ds:_font_width']
imul ['ecx,', '[eax+12Ch]']
mov ['edx,', 'ds:_offset_width']
lea ['eax,', '[ecx+edx*2]']
cmp ['[ebp+var_8],', 'eax']
jnz ['short', 'loc_6571']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', 'ds:_font_height']
imul ['edx,', '[ecx+128h]']
mov ['eax,', 'ds:_offset_height']
lea ['ecx,', '[edx+eax*2]']
cmp ['[ebp+var_C],', 'ecx']
jz ['loc_676D']
push ['offset', '?ss@?N@??reset_window@@9@9']
call ['_get_fullscreen_rect']
add ['esp,', '4']
mov ['eax,', 'ds:dword_10F4']
sub ['eax,', 'ds:?ss@?N@??reset_window@@9@9']
sub ['eax,', 'ds:_extra_width']
cdq
idiv ['ds:_font_width']
mov ['[ebp+var_48],', 'eax']
mov ['eax,', 'ds:dword_10F8']
sub ['eax,', 'ds:dword_10F0']
sub ['eax,', 'ds:_extra_height']
cdq
idiv ['ds:_font_height']
mov ['[ebp+var_4C],', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+128h]']
cmp ['eax,', '[ebp+var_4C]']
jg ['short', 'loc_65DA']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', '[ecx+12Ch]']
cmp ['edx,', '[ebp+var_48]']
jle ['loc_6703']
cmp ['[ebp+var_10],', '3']
jnz ['loc_669D']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', '[eax+12Ch]']
cmp ['ecx,', '[ebp+var_48]']
jle ['short', 'loc_6617']
mov ['eax,', 'ds:dword_10F4']
sub ['eax,', 'ds:?ss@?N@??reset_window@@9@9']
sub ['eax,', 'ds:_extra_width']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cdq
idiv ['dword', 'ptr', '[ecx+12Ch]']
mov ['ds:_font_width,', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+128h]']
cmp ['eax,', '[ebp+var_4C]']
jle ['short', 'loc_664B']
mov ['eax,', 'ds:dword_10F8']
sub ['eax,', 'ds:dword_10F0']
sub ['eax,', 'ds:_extra_height']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cdq
idiv ['dword', 'ptr', '[ecx+128h]']
mov ['ds:_font_height,', 'eax']
call ['_deinit_fonts']
mov ['edx,', 'ds:_font_height']
push ['edx']
mov ['eax,', 'ds:_font_width']
push ['eax']
call ['_init_fonts']
add ['esp,', '8']
mov ['eax,', 'ds:dword_10F4']
sub ['eax,', 'ds:?ss@?N@??reset_window@@9@9']
sub ['eax,', 'ds:_extra_width']
cdq
idiv ['ds:_font_width']
mov ['[ebp+var_48],', 'eax']
mov ['eax,', 'ds:dword_10F8']
sub ['eax,', 'ds:dword_10F0']
sub ['eax,', 'ds:_extra_height']
cdq
idiv ['ds:_font_height']
mov ['[ebp+var_4C],', 'eax']
jmp ['short', 'loc_6703']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', '[ebp+var_4C]']
cmp ['edx,', '[ecx+128h]']
jle ['short', 'loc_66BC']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', '[eax+128h]']
mov ['[ebp+var_4C],', 'ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[ebp+var_48]']
cmp ['eax,', '[edx+12Ch]']
jle ['short', 'loc_66DC']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', '[ecx+12Ch]']
mov ['[ebp+var_48],', 'edx']
push ['5Bh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['ecx,', '[ebp+var_48]']
push ['ecx']
mov ['edx,', '[ebp+var_4C]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_size']
add ['esp,', '10h']
mov ['esi,', 'esp']
push ['6']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', 'ds:_font_height']
imul ['edx,', '[ecx+128h]']
add ['edx,', 'ds:_extra_height']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', 'ds:_font_width']
imul ['ecx,', '[eax+12Ch]']
add ['ecx,', 'ds:_extra_width']
push ['ecx']
push ['0']
push ['0']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_6885']
mov ['ecx,', '[ebp+var_14]']
shl ['ecx,', '1']
mov ['eax,', '[ebp+var_8]']
sub ['eax,', 'ecx']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cdq
idiv ['dword', 'ptr', '[ecx+12Ch]']
cmp ['ds:_font_width,', 'eax']
jnz ['short', 'loc_67B4']
mov ['edx,', '[ebp+var_14]']
shl ['edx,', '1']
mov ['eax,', '[ebp+var_C]']
sub ['eax,', 'edx']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cdq
idiv ['dword', 'ptr', '[ecx+128h]']
cmp ['ds:_font_height,', 'eax']
jz ['loc_6885']
call ['_deinit_fonts']
mov ['edx,', '[ebp+var_14]']
shl ['edx,', '1']
mov ['eax,', '[ebp+var_C]']
sub ['eax,', 'edx']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cdq
idiv ['dword', 'ptr', '[ecx+128h]']
push ['eax']
mov ['edx,', '[ebp+var_14]']
shl ['edx,', '1']
mov ['eax,', '[ebp+var_8]']
sub ['eax,', 'edx']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cdq
idiv ['dword', 'ptr', '[ecx+12Ch]']
push ['eax']
call ['_init_fonts']
add ['esp,', '8']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_width']
imul ['eax,', '[edx+12Ch]']
mov ['ecx,', '[ebp+var_8]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ds:_offset_width,', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_height']
imul ['eax,', '[edx+128h]']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ds:_offset_height,', 'eax']
mov ['edx,', '[ebp+Rect.right]']
sub ['edx,', '[ebp+Rect.left]']
sub ['edx,', '[ebp+var_28.right]']
add ['edx,', '[ebp+var_28.left]']
mov ['eax,', 'ds:_offset_width']
lea ['ecx,', '[edx+eax*2]']
mov ['ds:_extra_width,', 'ecx']
mov ['edx,', '[ebp+Rect.bottom]']
sub ['edx,', '[ebp+Rect.top]']
sub ['edx,', '[ebp+var_28.bottom]']
add ['edx,', '[ebp+var_28.top]']
mov ['eax,', 'ds:_offset_height']
lea ['ecx,', '[edx+eax*2]']
mov ['ds:_extra_height,', 'ecx']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN38']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '4Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_set_input_locale proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['dword', 'ptr', '[ebp+LCData],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
push ['14h']
lea ['eax,', '[ebp+LCData]']
push ['eax']
push ['1004h']
mov ['ecx,', '[ebp+arg_0]']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetLocaleInfoA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
lea ['eax,', '[ebp+LCData]']
push ['eax']
call ['_atoi']
add ['esp,', '4']
mov ['ds:_kbd_codepage,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_notify_remote_exit proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['ds:_session_closed,', '0']
jnz ['loc_6A55']
mov ['esi,', 'esp']
mov ['eax,', 'ds:_backhandle']
push ['eax']
mov ['ecx,', 'ds:_back']
mov ['edx,', '[ecx+24h]']
call ['edx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jl ['loc_6A55']
push ['4']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_69FC']
cmp ['[ebp+var_8],', '2']
jnz ['short', 'loc_6A0F']
cmp ['[ebp+var_4],', '7FFFFFFFh']
jz ['short', 'loc_6A0F']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__PostQuitMessage@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_6A55']
push ['0']
push ['offset', '_close_session']
call ['_queue_toplevel_callback']
add ['esp,', '8']
mov ['ds:_session_closed,', '1']
cmp ['[ebp+var_4],', '7FFFFFFFh']
jz ['short', 'loc_6A55']
mov ['esi,', 'esp']
push ['40h']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG89794']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_timer_change_notify proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+uElapse],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
sub ['eax,', '[ebp+arg_0]']
cmp ['eax,', '7FFFFFFFh']
jnb ['short', 'loc_6AA5']
mov ['[ebp+uElapse],', '0']
jmp ['short', 'loc_6AAE']
mov ['ecx,', '[ebp+arg_0]']
sub ['ecx,', '[ebp+var_4]']
mov ['[ebp+uElapse],', 'ecx']
mov ['esi,', 'esp']
push ['4D2h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__KillTimer@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', '[ebp+uElapse]']
push ['eax']
push ['4D2h']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetTimer@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['ds:_timing_next_time,', 'edx']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_conf_cache_data proc near              
push ['ebp']
mov ['ebp,', 'esp']
push ['5Fh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['dword', 'ptr', 'ds:_cursor_type,', 'eax']
push ['8Bh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['dword', 'ptr', 'ds:_vtmode,', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_WndProc@16     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0C3Ch']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_C3C]']
mov ['ecx,', '30Fh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_C00],', 'eax']
cmp ['[ebp+var_C00],', '101h']
ja ['short', 'loc_6BC7']
cmp ['[ebp+var_C00],', '100h']
jnb ['$LN49_0']
mov ['ecx,', '[ebp+var_C00]']
sub ['ecx,', '1']
mov ['[ebp+var_C00],', 'ecx']
cmp ['[ebp+var_C00],', '9Fh']
ja ['$LN16_0']
mov ['edx,', '[ebp+var_C00]']
movzx ['eax,', 'ds:$LN287[edx]']
jmp ['ds:$LN310[eax*4]']
cmp ['[ebp+var_C00],', '10Dh']
ja ['short', 'loc_6C0F']
cmp ['[ebp+var_C00],', '10Dh']
jz ['loc_93C0']
mov ['ecx,', '[ebp+var_C00]']
sub ['ecx,', '102h']
mov ['[ebp+var_C00],', 'ecx']
cmp ['[ebp+var_C00],', '4']
ja ['$LN16_0']
mov ['edx,', '[ebp+var_C00]']
jmp ['ds:$LN311[edx*4]']
cmp ['[ebp+var_C00],', '200h']
ja ['short', 'loc_6C56']
cmp ['[ebp+var_C00],', '200h']
jz ['loc_8013']
mov ['eax,', '[ebp+var_C00]']
sub ['eax,', '10Fh']
mov ['[ebp+var_C00],', 'eax']
cmp ['[ebp+var_C00],', '8']
ja ['$LN16_0']
mov ['ecx,', '[ebp+var_C00]']
jmp ['ds:$LN312[ecx*4]']
cmp ['[ebp+var_C00],', '307h']
ja ['short', 'loc_6CA8']
cmp ['[ebp+var_C00],', '307h']
jz ['loc_8213']
mov ['edx,', '[ebp+var_C00]']
sub ['edx,', '201h']
mov ['[ebp+var_C00],', 'edx']
cmp ['[ebp+var_C00],', '85h']
ja ['$LN16_0']
mov ['eax,', '[ebp+var_C00]']
movzx ['ecx,', 'ds:$LN288[eax]']
jmp ['ds:$LN313[ecx*4]']
cmp ['[ebp+var_C00],', '8002h']
ja ['short', 'loc_6CE9']
cmp ['[ebp+var_C00],', '8002h']
jz ['loc_8205']
cmp ['[ebp+var_C00],', '30Fh']
jz ['loc_9230']
cmp ['[ebp+var_C00],', '311h']
jz ['loc_91C2']
jmp ['$LN16_0']
mov ['edx,', '[ebp+var_C00]']
sub ['edx,', '8003h']
mov ['[ebp+var_C00],', 'edx']
cmp ['[ebp+var_C00],', '3']
ja ['$LN16_0']
mov ['eax,', '[ebp+var_C00]']
jmp ['ds:$LN314[eax*4]']
cmp ['[ebp+lParam],', '4D2h']
jnz ['short', 'loc_6D58']
mov ['esi,', 'esp']
push ['4D2h']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__KillTimer@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
lea ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', 'ds:_timing_next_time']
push ['eax']
call ['_run_timers']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_6D58']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
call ['_timer_change_notify']
add ['esp,', '4']
xor ['eax,', 'eax']
jmp ['loc_9A43']
jmp ['loc_9A24']
push ['1']
call ['_show_mouseptr']
add ['esp,', '4']
mov ['edx,', 'dword', 'ptr', 'ds:_appname']
push ['edx']
push ['offset', '$SG89839']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpCaption],', 'eax']
cmp ['ds:_session_closed,', '0']
jnz ['short', 'loc_6DC5']
push ['5']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_6DC5']
mov ['esi,', 'esp']
push ['31h']
mov ['ecx,', '[ebp+lpCaption]']
push ['ecx']
push ['offset', '$SG89842']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '1']
jnz ['short', 'loc_6DD8']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DestroyWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+lpCaption]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
xor ['eax,', 'eax']
jmp ['loc_9A43']
push ['1']
call ['_show_mouseptr']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__PostQuitMessage@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['edx,', '[ebp+lParam]']
cmp ['edx,', 'ds:_savedsess_menu']
jnz ['short', 'loc_6E42']
push ['0']
push ['offset', '_sesslist']
call ['_get_sesslist']
add ['esp,', '8']
push ['1']
push ['offset', '_sesslist']
call ['_get_sesslist']
add ['esp,', '8']
call ['_update_savedsess_menu']
xor ['eax,', 'eax']
jmp ['loc_9A43']
jmp ['loc_9A24']
mov ['eax,', '[ebp+lParam]']
and ['eax,', '0FFFFFFF0h']
mov ['[ebp+var_C04],', 'eax']
cmp ['[ebp+var_C04],', '140h']
ja ['short', 'loc_6E9F']
cmp ['[ebp+var_C04],', '140h']
jz ['loc_7A97']
mov ['ecx,', '[ebp+var_C04]']
sub ['ecx,', '10h']
mov ['[ebp+var_C04],', 'ecx']
cmp ['[ebp+var_C04],', '60h']
ja ['$LN178']
mov ['edx,', '[ebp+var_C04]']
movzx ['eax,', 'ds:$LN289[edx]']
jmp ['ds:$LN315[eax*4]']
cmp ['[ebp+var_C04],', '180h']
ja ['short', 'loc_6EEC']
cmp ['[ebp+var_C04],', '180h']
jz ['loc_7AEA']
cmp ['[ebp+var_C04],', '150h']
jz ['loc_7A86']
cmp ['[ebp+var_C04],', '160h']
jz ['short', '$LN236']
cmp ['[ebp+var_C04],', '170h']
jz ['loc_7A1C']
jmp ['$LN178']
cmp ['[ebp+var_C04],', '190h']
jz ['loc_7A30']
cmp ['[ebp+var_C04],', '0F090h']
jz ['loc_7AAA']
cmp ['[ebp+var_C04],', '0F100h']
jz ['loc_7AB9']
jmp ['$LN178']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['_showeventlog']
add ['esp,', '4']
jmp ['loc_7B93']
mov ['[ebp+var_854],', '0']
mov ['[ebp+hFileMappingObject],', '0']
cmp ['[ebp+lParam],', '30h']
jnz ['loc_705B']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_serialised_size']
add ['esp,', '4']
mov ['[ebp+dwMaximumSizeLow],', 'eax']
mov ['[ebp+FileMappingAttributes.nLength],', '0Ch']
mov ['[ebp+FileMappingAttributes.lpSecurityDescriptor],', '0']
mov ['[ebp+FileMappingAttributes.bInheritHandle],', '1']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', '[ebp+dwMaximumSizeLow]']
push ['eax']
push ['0']
push ['4']
lea ['ecx,', '[ebp+FileMappingAttributes]']
push ['ecx']
push ['0FFFFFFFFh']
call ['dword', 'ptr', 'ds:__imp__CreateFileMappingA@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hFileMappingObject],', 'eax']
cmp ['[ebp+hFileMappingObject],', '0']
jz ['short', 'loc_701E']
cmp ['[ebp+hFileMappingObject],', '0FFFFFFFFh']
jz ['short', 'loc_701E']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+dwMaximumSizeLow]']
push ['edx']
push ['0']
push ['0']
push ['2']
mov ['eax,', '[ebp+hFileMappingObject]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__MapViewOfFile@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+lpBaseAddress],', 'eax']
cmp ['[ebp+lpBaseAddress],', '0']
jz ['short', 'loc_701E']
mov ['ecx,', '[ebp+lpBaseAddress]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_serialise']
add ['esp,', '8']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+lpBaseAddress]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__UnmapViewOfFile@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+bInheritHandles],', '1']
mov ['ecx,', '[ebp+dwMaximumSizeLow]']
push ['ecx']
mov ['edx,', '[ebp+hFileMappingObject]']
push ['edx']
push ['offset', '$SG89876']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '10h']
lea ['ecx,', '[ebp+Dest]']
mov ['[ebp+lpCommandLine],', 'ecx']
jmp ['loc_70EC']
cmp ['[ebp+lParam],', '160h']
jnz ['short', 'loc_70D8']
mov ['eax,', '[ebp+arg_C]']
sub ['eax,', '1000h']
cdq
and ['edx,', '0Fh']
add ['eax,', 'edx']
sar ['eax,', '4']
add ['eax,', '1']
mov ['[ebp+var_8E0],', 'eax']
mov ['edx,', '[ebp+var_8E0]']
cmp ['edx,', 'ds:_sesslist']
jnb ['short', 'loc_70D1']
mov ['eax,', '[ebp+var_8E0]']
mov ['ecx,', 'ds:dword_10E0']
mov ['edx,', '[ecx+eax*4]']
mov ['[ebp+var_8E4],', 'edx']
mov ['eax,', '[ebp+var_8E4]']
push ['eax']
push ['offset', '$SG89883']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpCommandLine],', 'eax']
mov ['[ebp+bInheritHandles],', '0']
mov ['[ebp+var_854],', '1']
jmp ['short', 'loc_70D6']
jmp ['loc_7B93']
jmp ['short', 'loc_70EC']
mov ['[ebp+lpCommandLine],', '0']
mov ['[ebp+bInheritHandles],', '0']
mov ['esi,', 'esp']
push ['7FFh']
lea ['ecx,', '[ebp+Filename]']
push ['ecx']
push ['0']
call ['dword', 'ptr', 'ds:__imp__GetModuleFileNameA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+StartupInfo.cb],', '44h']
mov ['[ebp+StartupInfo.lpReserved],', '0']
mov ['[ebp+StartupInfo.lpDesktop],', '0']
mov ['[ebp+StartupInfo.lpTitle],', '0']
mov ['[ebp+StartupInfo.dwFlags],', '0']
xor ['edx,', 'edx']
mov ['[ebp+StartupInfo.cbReserved2],', 'dx']
mov ['[ebp+StartupInfo.lpReserved2],', '0']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+ProcessInformation]']
push ['eax']
lea ['ecx,', '[ebp+StartupInfo]']
push ['ecx']
push ['0']
push ['0']
push ['20h']
mov ['edx,', '[ebp+bInheritHandles]']
push ['edx']
push ['0']
push ['0']
mov ['eax,', '[ebp+lpCommandLine]']
push ['eax']
lea ['ecx,', '[ebp+Filename]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__CreateProcessA@40']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+ProcessInformation.hProcess]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__CloseHandle@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+ProcessInformation.hThread]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__CloseHandle@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+hFileMappingObject],', '0']
jz ['short', 'loc_71D5']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hFileMappingObject]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__CloseHandle@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+var_854],', '0']
jz ['short', 'loc_71ED']
mov ['edx,', '[ebp+lpCommandLine]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_7B93']
cmp ['ds:_back,', '0']
jnz ['short', 'loc_721F']
push ['offset', '$SG89901']
push ['0']
call ['_logevent']
add ['esp,', '8']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_pwron']
add ['esp,', '8']
call ['_start_backend']
jmp ['loc_7B93']
mov ['[ebp+var_8EC],', '1']
cmp ['ds:_reconfiguring,', '0']
jz ['short', 'loc_723E']
jmp ['loc_7B93']
jmp ['short', 'loc_7248']
mov ['ds:_reconfiguring,', '1']
mov ['ecx,', 'ds:_window_name']
push ['ecx']
push ['5Ah']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_set_str']
add ['esp,', '0Ch']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_copy']
add ['esp,', '4']
mov ['[ebp+var_8E8],', 'eax']
cmp ['ds:_back,', '0']
jz ['short', 'loc_72A3']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:_backhandle']
push ['ecx']
mov ['edx,', 'ds:_back']
mov ['eax,', '[edx+3Ch]']
call ['eax']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C08],', 'eax']
jmp ['short', 'loc_72AD']
mov ['[ebp+var_C08],', '0']
mov ['ecx,', '[ebp+var_C08]']
push ['ecx']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['_do_reconfig']
add ['esp,', '8']
mov ['[ebp+var_8F0],', 'eax']
mov ['ds:_reconfiguring,', '0']
cmp ['[ebp+var_8F0],', '0']
jnz ['short', 'loc_72ED']
mov ['eax,', '[ebp+var_8E8]']
push ['eax']
call ['_conf_free']
add ['esp,', '4']
jmp ['loc_7B93']
call ['_conf_cache_data']
push ['6Ah']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8F4],', '0']
jmp ['short', 'loc_7321']
mov ['edx,', '[ebp+var_8F4]']
add ['edx,', '1']
mov ['[ebp+var_8F4],', 'edx']
cmp ['[ebp+var_8F4],', '2']
jnb ['short', 'loc_735E']
xor ['eax,', 'eax']
cmp ['[ebp+var_C],', '1']
setz ['al']
neg ['eax']
sbb ['eax,', 'eax']
neg ['eax']
mov ['esi,', 'esp']
push ['eax']
push ['180h']
mov ['ecx,', '[ebp+var_8F4]']
mov ['edx,', 'ds:_popup_menus[ecx*4]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__EnableMenuItem@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_7312']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_7390']
cmp ['[ebp+var_C],', '1']
jnz ['short', 'loc_7390']
mov ['esi,', 'esp']
push ['9']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_logctx']
push ['eax']
call ['_log_reconfig']
add ['esp,', '8']
mov ['ecx,', 'ds:_logpal']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_73E7']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
mov ['eax,', 'ds:_ldisc']
push ['eax']
call ['_ldisc_configure']
add ['esp,', '8']
push ['0']
push ['0']
push ['0']
mov ['ecx,', 'ds:_ldisc']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_7406']
mov ['esi,', 'esp']
mov ['edx,', 'ds:_pal']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_logpal,', '0']
mov ['ds:_pal,', '0']
call ['_conftopalette']
call ['_init_palette']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_reconfig']
add ['esp,', '8']
cmp ['ds:_back,', '0']
jz ['short', 'loc_7466']
mov ['esi,', 'esp']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
mov ['eax,', 'ds:_backhandle']
push ['eax']
mov ['ecx,', 'ds:_back']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['6Fh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['6Fh']
mov ['ecx,', '[ebp+var_8E8]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jnz ['short', 'loc_7506']
push ['6Eh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['6Eh']
mov ['eax,', '[ebp+var_8E8]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jnz ['short', 'loc_7506']
push ['5Bh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['5Bh']
mov ['edx,', '[ebp+var_8E8]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jnz ['short', 'loc_7506']
cmp ['[ebp+var_C],', '2']
jz ['short', 'loc_7506']
cmp ['[ebp+var_C],', '3']
jnz ['short', 'loc_7500']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_7506']
cmp ['[ebp+var_C],', '1']
jnz ['short', 'loc_754A']
push ['5Bh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
push ['6Eh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
push ['6Fh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_size']
add ['esp,', '10h']
mov ['esi,', 'esp']
push ['0FFFFFFF0h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetWindowLongA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8FC],', 'eax']
mov ['esi,', 'esp']
push ['0FFFFFFECh']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetWindowLongA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_904],', 'eax']
mov ['ecx,', '[ebp+var_904]']
mov ['[ebp+var_900],', 'ecx']
push ['53h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['53h']
mov ['eax,', '[ebp+var_8E8]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jz ['short', 'loc_7627']
push ['53h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_75F9']
mov ['edx,', '[ebp+var_900]']
or ['edx,', '8']
mov ['[ebp+var_900],', 'edx']
mov ['esi,', 'esp']
push ['3']
push ['0']
push ['0']
push ['0']
push ['0']
push ['0FFFFFFFFh']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_7627']
mov ['ecx,', '[ebp+var_900]']
and ['ecx,', '0FFFFFFF7h']
mov ['[ebp+var_900],', 'ecx']
mov ['esi,', 'esp']
push ['3']
push ['0']
push ['0']
push ['0']
push ['0']
push ['0FFFFFFFEh']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['79h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_764F']
mov ['ecx,', '[ebp+var_900]']
or ['ecx,', '200h']
mov ['[ebp+var_900],', 'ecx']
jmp ['short', 'loc_7661']
mov ['edx,', '[ebp+var_900]']
and ['edx,', '0FFFFFDFFh']
mov ['[ebp+var_900],', 'edx']
mov ['eax,', '[ebp+var_8FC]']
mov ['[ebp+dwNewLong],', 'eax']
call ['_is_full_screen']
neg ['eax']
sbb ['eax,', 'eax']
neg ['eax']
add ['eax,', '68h']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_76A3']
mov ['edx,', '[ebp+dwNewLong]']
or ['edx,', '200000h']
mov ['[ebp+dwNewLong],', 'edx']
jmp ['short', 'loc_76B4']
mov ['eax,', '[ebp+dwNewLong]']
and ['eax,', '0FFDFFFFFh']
mov ['[ebp+dwNewLong],', 'eax']
cmp ['[ebp+var_C],', '1']
jz ['short', 'loc_76C3']
call ['_is_full_screen']
test ['eax,', 'eax']
jz ['short', 'loc_76D7']
mov ['ecx,', '[ebp+dwNewLong]']
and ['ecx,', '0FFFBFFFFh']
mov ['[ebp+dwNewLong],', 'ecx']
jmp ['short', 'loc_76E9']
mov ['edx,', '[ebp+dwNewLong]']
or ['edx,', '40000h']
mov ['[ebp+dwNewLong],', 'edx']
cmp ['[ebp+var_C],', '1']
jnz ['short', 'loc_7702']
mov ['eax,', '[ebp+dwNewLong]']
and ['eax,', '0FFFEFFFFh']
mov ['[ebp+dwNewLong],', 'eax']
jmp ['short', 'loc_7714']
mov ['ecx,', '[ebp+dwNewLong]']
or ['ecx,', 'offset', 'loc_10000']
mov ['[ebp+dwNewLong],', 'ecx']
mov ['edx,', '[ebp+dwNewLong]']
cmp ['edx,', '[ebp+var_8FC]']
jnz ['short', 'loc_7734']
mov ['eax,', '[ebp+var_900]']
cmp ['eax,', '[ebp+var_904]']
jz ['loc_77B4']
mov ['ecx,', '[ebp+dwNewLong]']
cmp ['ecx,', '[ebp+var_8FC]']
jz ['short', 'loc_775E']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+dwNewLong]']
push ['edx']
push ['0FFFFFFF0h']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_900]']
cmp ['ecx,', '[ebp+var_904]']
jz ['short', 'loc_7788']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_900]']
push ['edx']
push ['0FFFFFFECh']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['137h']
push ['0']
push ['0']
push ['0']
push ['0']
push ['0']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8EC],', '2']
cmp ['[ebp+var_C],', '1']
jnz ['short', 'loc_77E7']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_77E7']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['_force_normal']
add ['esp,', '4']
mov ['[ebp+var_8EC],', '2']
push ['5Ah']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
push ['0']
call ['_set_title']
add ['esp,', '8']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__IsIconic@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_7862']
push ['6Dh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_783C']
mov ['ecx,', 'ds:_window_name']
mov ['[ebp+lpString],', 'ecx']
jmp ['short', 'loc_7848']
mov ['edx,', 'ds:_icon_name']
mov ['[ebp+lpString],', 'edx']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+lpString]']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowTextA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['70h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_fontspec']
add ['esp,', '8']
mov ['[ebp+var_908],', 'eax']
push ['70h']
mov ['eax,', '[ebp+var_8E8]']
push ['eax']
call ['_conf_get_fontspec']
add ['esp,', '8']
mov ['[ebp+var_90C],', 'eax']
mov ['ecx,', '[ebp+var_90C]']
mov ['edx,', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+var_908]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_79D8']
push ['8Ch']
mov ['edx,', '[ebp+var_8E8]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
push ['8Ch']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_79D8']
mov ['ecx,', '[ebp+var_908]']
mov ['edx,', '[ebp+var_90C]']
mov ['eax,', '[ecx+4]']
cmp ['eax,', '[edx+4]']
jnz ['loc_79D8']
mov ['ecx,', '[ebp+var_908]']
mov ['edx,', '[ebp+var_90C]']
mov ['eax,', '[ecx+8]']
cmp ['eax,', '[edx+8]']
jnz ['loc_79D8']
mov ['ecx,', '[ebp+var_908]']
mov ['edx,', '[ebp+var_90C]']
mov ['eax,', '[ecx+0Ch]']
cmp ['eax,', '[edx+0Ch]']
jnz ['loc_79D8']
push ['71h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['71h']
mov ['edx,', '[ebp+var_8E8]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jnz ['short', 'loc_79D8']
push ['8Bh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['8Bh']
mov ['ecx,', '[ebp+var_8E8]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jnz ['short', 'loc_79D8']
push ['83h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['83h']
mov ['eax,', '[ebp+var_8E8]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jnz ['short', 'loc_79D8']
cmp ['[ebp+var_C],', '1']
jz ['short', 'loc_79D8']
cmp ['[ebp+var_C],', '3']
jz ['short', 'loc_79D8']
push ['6Ah']
mov ['ecx,', '[ebp+var_8E8]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['[ebp+var_C],', 'eax']
jz ['short', 'loc_79E2']
mov ['[ebp+var_8EC],', '2']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_8EC]']
push ['eax']
call ['_reset_window']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8E8]']
push ['ecx']
call ['_conf_free']
add ['esp,', '4']
jmp ['loc_7B93']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_copyall']
add ['esp,', '4']
jmp ['loc_7B93']
push ['0']
call ['_request_paste']
add ['esp,', '4']
jmp ['loc_7B93']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_clrsb']
add ['esp,', '4']
jmp ['loc_7B93']
push ['1']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_pwron']
add ['esp,', '8']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_7A81']
push ['0']
push ['0']
push ['0']
mov ['edx,', 'ds:_ldisc']
push ['edx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['loc_7B93']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['_showabout']
add ['esp,', '4']
jmp ['loc_7B93']
push ['0']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['_launch_help']
add ['esp,', '8']
jmp ['loc_7B93']
push ['1']
call ['_show_mouseptr']
add ['esp,', '4']
jmp ['loc_7B93']
push ['1']
call ['_show_mouseptr']
add ['esp,', '4']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_7AE5']
mov ['esi,', 'esp']
push ['0']
push ['20h']
push ['102h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__PostMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_7B93']
call ['_flip_full_screen']
jmp ['loc_7B93']
cmp ['[ebp+lParam],', '1000h']
jb ['short', 'loc_7B27']
cmp ['[ebp+lParam],', '5000h']
jnb ['short', 'loc_7B27']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+lParam]']
push ['eax']
push ['160h']
push ['112h']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+lParam],', '400h']
jb ['short', 'loc_7B93']
cmp ['[ebp+lParam],', '800h']
ja ['short', 'loc_7B93']
mov ['edx,', '[ebp+lParam]']
sub ['edx,', '400h']
shr ['edx,', '4']
mov ['[ebp+var_910],', 'edx']
mov ['eax,', '[ebp+var_910]']
cmp ['eax,', 'ds:_n_specials']
jl ['short', 'loc_7B5B']
jmp ['short', 'loc_7B93']
cmp ['ds:_back,', '0']
jz ['short', 'loc_7B93']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_910]']
mov ['edx,', 'ds:_specials']
mov ['eax,', '[edx+ecx*8+4]']
push ['eax']
mov ['ecx,', 'ds:_backhandle']
push ['ecx']
mov ['edx,', 'ds:_back']
mov ['eax,', '[edx+18h]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_9A24']
cmp ['[ebp+arg_4],', '204h']
jnz ['short', 'loc_7C15']
mov ['ecx,', '[ebp+lParam]']
and ['ecx,', '8']
jnz ['short', 'loc_7BC2']
push ['85h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_7C15']
push ['1']
call ['_show_mouseptr']
add ['esp,', '4']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Point]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetCursorPos@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+Point.y]']
push ['edx']
mov ['eax,', '[ebp+Point.x]']
push ['eax']
push ['2']
mov ['ecx,', 'ds:hMenu']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__TrackPopupMenu@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_9A24']
mov ['edx,', '[ebp+arg_4]']
mov ['[ebp+var_C10],', 'edx']
mov ['eax,', '[ebp+var_C10]']
sub ['eax,', '201h']
mov ['[ebp+var_C10],', 'eax']
cmp ['[ebp+var_C10],', '7']
ja ['$LN162']
mov ['ecx,', '[ebp+var_C10]']
jmp ['ds:$LN316[ecx*4]']
mov ['[ebp+var_924],', '1']
mov ['edx,', '[ebp+lParam]']
or ['edx,', '1']
mov ['[ebp+lParam],', 'edx']
mov ['[ebp+var_928],', '1']
jmp ['loc_7D1F']
mov ['[ebp+var_924],', '2']
mov ['eax,', '[ebp+lParam]']
or ['eax,', '10h']
mov ['[ebp+lParam],', 'eax']
mov ['[ebp+var_928],', '1']
jmp ['loc_7D1F']
mov ['[ebp+var_924],', '3']
mov ['ecx,', '[ebp+lParam]']
or ['ecx,', '2']
mov ['[ebp+lParam],', 'ecx']
mov ['[ebp+var_928],', '1']
jmp ['short', 'loc_7D1F']
mov ['[ebp+var_924],', '1']
mov ['edx,', '[ebp+lParam]']
and ['edx,', '0FFFFFFFEh']
mov ['[ebp+lParam],', 'edx']
mov ['[ebp+var_928],', '0']
jmp ['short', 'loc_7D1F']
mov ['[ebp+var_924],', '2']
mov ['eax,', '[ebp+lParam]']
and ['eax,', '0FFFFFFEFh']
mov ['[ebp+lParam],', 'eax']
mov ['[ebp+var_928],', '0']
jmp ['short', 'loc_7D1F']
mov ['[ebp+var_924],', '3']
mov ['ecx,', '[ebp+lParam]']
and ['ecx,', '0FFFFFFFDh']
mov ['[ebp+lParam],', 'ecx']
mov ['[ebp+var_928],', '0']
jmp ['short', 'loc_7D1F']
mov ['[ebp+var_928],', '0']
mov ['edx,', '[ebp+var_928]']
mov ['[ebp+var_924],', 'edx']
push ['1']
call ['_show_mouseptr']
add ['esp,', '4']
mov ['[ebp+var_929],', '0']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_938]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetCursorPos@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
mov ['ecx,', '[ebp+var_938.y]']
push ['ecx']
mov ['edx,', '[ebp+var_938.x]']
push ['edx']
call ['_xMonitorFromPoint@12']
mov ['[ebp+var_940],', 'eax']
cmp ['[ebp+var_940],', '0']
jz ['short', 'loc_7DAA']
mov ['[ebp+var_96C.cbSize],', '28h']
lea ['eax,', '[ebp+var_96C]']
push ['eax']
mov ['ecx,', '[ebp+var_940]']
push ['ecx']
call ['_xGetMonitorInfo@8']
mov ['edx,', '[ebp+var_96C.rcMonitor.left]']
cmp ['edx,', '[ebp+var_938.x]']
jnz ['short', 'loc_7DAA']
mov ['eax,', '[ebp+var_96C.rcMonitor.top]']
cmp ['eax,', '[ebp+var_938.y]']
jnz ['short', 'loc_7DAA']
mov ['[ebp+var_929],', '1']
call ['_is_full_screen']
test ['eax,', 'eax']
jz ['short', 'loc_7E18']
cmp ['[ebp+var_928],', '0']
jz ['short', 'loc_7E18']
cmp ['[ebp+var_924],', '1']
jnz ['short', 'loc_7E18']
movsx ['ecx,', '[ebp+var_929]']
test ['ecx,', 'ecx']
jz ['short', 'loc_7E18']
mov ['edx,', '[ebp+var_938.x]']
and ['edx,', '0FFFFh']
movzx ['eax,', 'dx']
mov ['ecx,', '[ebp+var_938.y]']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
shl ['edx,', '10h']
or ['eax,', 'edx']
mov ['esi,', 'esp']
push ['eax']
push ['0F090h']
push ['112h']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_9A43']
cmp ['[ebp+var_928],', '0']
jz ['loc_7F0D']
mov ['ecx,', '[ebp+arg_C]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movsx ['edx,', 'cx']
test ['edx,', 'edx']
jge ['short', 'loc_7E57']
mov ['eax,', '[ebp+arg_C]']
shr ['eax,', '10h']
and ['eax,', '0FFFFh']
movsx ['ecx,', 'ax']
sub ['ecx,', 'ds:_font_height']
add ['ecx,', '1']
mov ['[ebp+var_C14],', 'ecx']
jmp ['short', 'loc_7E6C']
mov ['edx,', '[ebp+arg_C]']
shr ['edx,', '10h']
and ['edx,', '0FFFFh']
movsx ['eax,', 'dx']
mov ['[ebp+var_C14],', 'eax']
mov ['ecx,', '[ebp+arg_C]']
and ['ecx,', '0FFFFh']
movsx ['edx,', 'cx']
test ['edx,', 'edx']
jge ['short', 'loc_7E98']
mov ['eax,', '[ebp+arg_C]']
and ['eax,', '0FFFFh']
movsx ['ecx,', 'ax']
sub ['ecx,', 'ds:_font_width']
add ['ecx,', '1']
mov ['[ebp+var_C18],', 'ecx']
jmp ['short', 'loc_7EAA']
mov ['edx,', '[ebp+arg_C]']
and ['edx,', '0FFFFh']
movsx ['eax,', 'dx']
mov ['[ebp+var_C18],', 'eax']
call ['_is_alt_pressed']
push ['eax']
mov ['ecx,', '[ebp+lParam]']
and ['ecx,', '8']
push ['ecx']
mov ['edx,', '[ebp+lParam]']
and ['edx,', '4']
push ['edx']
mov ['eax,', '[ebp+var_C14]']
sub ['eax,', 'ds:_offset_height']
cdq
idiv ['ds:_font_height']
push ['eax']
mov ['eax,', '[ebp+var_C18]']
sub ['eax,', 'ds:_offset_width']
cdq
idiv ['ds:_font_width']
push ['eax']
mov ['eax,', '[ebp+var_924]']
push ['eax']
call ['_click']
add ['esp,', '18h']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetCapture@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_800C']
mov ['edx,', '[ebp+arg_C]']
shr ['edx,', '10h']
and ['edx,', '0FFFFh']
movsx ['eax,', 'dx']
test ['eax,', 'eax']
jge ['short', 'loc_7F40']
mov ['ecx,', '[ebp+arg_C]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movsx ['edx,', 'cx']
sub ['edx,', 'ds:_font_height']
add ['edx,', '1']
mov ['[ebp+var_C1C],', 'edx']
jmp ['short', 'loc_7F54']
mov ['eax,', '[ebp+arg_C]']
shr ['eax,', '10h']
and ['eax,', '0FFFFh']
movsx ['ecx,', 'ax']
mov ['[ebp+var_C1C],', 'ecx']
mov ['edx,', '[ebp+arg_C]']
and ['edx,', '0FFFFh']
movsx ['eax,', 'dx']
test ['eax,', 'eax']
jge ['short', 'loc_7F81']
mov ['ecx,', '[ebp+arg_C]']
and ['ecx,', '0FFFFh']
movsx ['edx,', 'cx']
sub ['edx,', 'ds:_font_width']
add ['edx,', '1']
mov ['[ebp+var_C20],', 'edx']
jmp ['short', 'loc_7F92']
mov ['eax,', '[ebp+arg_C]']
and ['eax,', '0FFFFh']
movsx ['ecx,', 'ax']
mov ['[ebp+var_C20],', 'ecx']
call ['_is_alt_pressed']
push ['eax']
mov ['edx,', '[ebp+lParam]']
and ['edx,', '8']
push ['edx']
mov ['eax,', '[ebp+lParam]']
and ['eax,', '4']
push ['eax']
mov ['eax,', '[ebp+var_C1C]']
sub ['eax,', 'ds:_offset_height']
cdq
idiv ['ds:_font_height']
push ['eax']
mov ['eax,', '[ebp+var_C20]']
sub ['eax,', 'ds:_offset_width']
cdq
idiv ['ds:_font_width']
push ['eax']
push ['5']
mov ['ecx,', '[ebp+var_924]']
push ['ecx']
call ['_translate_button']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+var_924]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_mouse']
add ['esp,', '24h']
mov ['ecx,', '[ebp+lParam]']
and ['ecx,', '13h']
jnz ['short', 'loc_800C']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__ReleaseCapture@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['edx,', '[ebp+lParam]']
cmp ['edx,', 'ds:?wp@?CK@??WndProc@@9@9']
jnz ['short', 'loc_8035']
mov ['eax,', '[ebp+arg_C]']
cmp ['eax,', 'ds:?lp@?CK@??WndProc@@9@9']
jnz ['short', 'loc_8035']
cmp ['ds:?last_mousemove@?1??WndProc@@9@9,', '200h']
jz ['short', 'loc_805B']
push ['1']
call ['_show_mouseptr']
add ['esp,', '4']
mov ['ecx,', '[ebp+lParam]']
mov ['ds:?wp@?CK@??WndProc@@9@9,', 'ecx']
mov ['edx,', '[ebp+arg_C]']
mov ['ds:?lp@?CK@??WndProc@@9@9,', 'edx']
mov ['ds:?last_mousemove@?1??WndProc@@9@9,', '200h']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_noise_ultralight']
add ['esp,', '4']
mov ['ecx,', '[ebp+lParam]']
and ['ecx,', '13h']
jz ['loc_81A6']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetCapture@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '[ebp+hWnd]']
jnz ['loc_81A6']
mov ['edx,', '[ebp+lParam]']
and ['edx,', '1']
jz ['short', 'loc_809F']
mov ['[ebp+var_974],', '1']
jmp ['short', 'loc_80BD']
mov ['eax,', '[ebp+lParam]']
and ['eax,', '10h']
jz ['short', 'loc_80B3']
mov ['[ebp+var_974],', '2']
jmp ['short', 'loc_80BD']
mov ['[ebp+var_974],', '3']
mov ['ecx,', '[ebp+arg_C]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movsx ['edx,', 'cx']
test ['edx,', 'edx']
jge ['short', 'loc_80EF']
mov ['eax,', '[ebp+arg_C]']
shr ['eax,', '10h']
and ['eax,', '0FFFFh']
movsx ['ecx,', 'ax']
sub ['ecx,', 'ds:_font_height']
add ['ecx,', '1']
mov ['[ebp+var_C24],', 'ecx']
jmp ['short', 'loc_8104']
mov ['edx,', '[ebp+arg_C]']
shr ['edx,', '10h']
and ['edx,', '0FFFFh']
movsx ['eax,', 'dx']
mov ['[ebp+var_C24],', 'eax']
mov ['ecx,', '[ebp+arg_C]']
and ['ecx,', '0FFFFh']
movsx ['edx,', 'cx']
test ['edx,', 'edx']
jge ['short', 'loc_8130']
mov ['eax,', '[ebp+arg_C]']
and ['eax,', '0FFFFh']
movsx ['ecx,', 'ax']
sub ['ecx,', 'ds:_font_width']
add ['ecx,', '1']
mov ['[ebp+var_C28],', 'ecx']
jmp ['short', 'loc_8142']
mov ['edx,', '[ebp+arg_C]']
and ['edx,', '0FFFFh']
movsx ['eax,', 'dx']
mov ['[ebp+var_C28],', 'eax']
call ['_is_alt_pressed']
push ['eax']
mov ['ecx,', '[ebp+lParam]']
and ['ecx,', '8']
push ['ecx']
mov ['edx,', '[ebp+lParam]']
and ['edx,', '4']
push ['edx']
mov ['eax,', '[ebp+var_C24]']
sub ['eax,', 'ds:_offset_height']
cdq
idiv ['ds:_font_height']
push ['eax']
mov ['eax,', '[ebp+var_C28]']
sub ['eax,', 'ds:_offset_width']
cdq
idiv ['ds:_font_width']
push ['eax']
push ['4']
mov ['eax,', '[ebp+var_974]']
push ['eax']
call ['_translate_button']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+var_974]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_mouse']
add ['esp,', '24h']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['eax,', '[ebp+lParam]']
cmp ['eax,', 'ds:?wp@?CN@??WndProc@@9@9']
jnz ['short', 'loc_81CF']
mov ['ecx,', '[ebp+arg_C]']
cmp ['ecx,', 'ds:?lp@?CN@??WndProc@@9@9']
jnz ['short', 'loc_81CF']
cmp ['ds:?last_mousemove@?1??WndProc@@9@9,', '0A0h']
jz ['short', 'loc_81F4']
push ['1']
call ['_show_mouseptr']
add ['esp,', '4']
mov ['edx,', '[ebp+lParam]']
mov ['ds:?wp@?CN@??WndProc@@9@9,', 'edx']
mov ['eax,', '[ebp+arg_C]']
mov ['ds:?lp@?CN@??WndProc@@9@9,', 'eax']
mov ['ds:?last_mousemove@?1??WndProc@@9@9,', '0A0h']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_noise_ultralight']
add ['esp,', '4']
jmp ['loc_9A24']
mov ['edx,', '[ebp+lParam]']
mov ['ds:?ignore_clip@?1??WndProc@@9@9,', 'edx']
jmp ['loc_9A24']
cmp ['ds:?ignore_clip@?1??WndProc@@9@9,', '0']
jnz ['short', 'loc_822A']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_deselect']
add ['esp,', '4']
mov ['ds:?ignore_clip@?1??WndProc@@9@9,', '0']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__HideCaret@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+Paint]']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__BeginPaint@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hdc],', 'eax']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_82A3']
mov ['esi,', 'esp']
push ['1']
mov ['ecx,', 'ds:_pal']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectPalette@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__RealizePalette@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
xor ['edx,', 'edx']
cmp ['dword', 'ptr', '[ecx+109Ch],', '0']
setz ['dl']
push ['edx']
mov ['eax,', '[ebp+Paint.rcPaint.bottom]']
sub ['eax,', 'ds:_offset_height']
sub ['eax,', '1']
cdq
idiv ['ds:_font_height']
push ['eax']
mov ['eax,', '[ebp+Paint.rcPaint.right]']
sub ['eax,', 'ds:_offset_width']
sub ['eax,', '1']
cdq
idiv ['ds:_font_width']
push ['eax']
mov ['eax,', '[ebp+Paint.rcPaint.top]']
sub ['eax,', 'ds:_offset_height']
cdq
idiv ['ds:_font_height']
push ['eax']
mov ['eax,', '[ebp+Paint.rcPaint.left]']
sub ['eax,', 'ds:_offset_width']
cdq
idiv ['ds:_font_width']
push ['eax']
mov ['eax,', '[ebp+hdc]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_paint']
add ['esp,', '1Ch']
cmp ['[ebp+Paint.fErase],', '0']
jnz ['short', 'loc_8389']
mov ['edx,', '[ebp+Paint.rcPaint.left]']
cmp ['edx,', 'ds:_offset_width']
jl ['short', 'loc_8389']
mov ['eax,', '[ebp+Paint.rcPaint.top]']
cmp ['eax,', 'ds:_offset_height']
jl ['short', 'loc_8389']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', 'ds:_font_width']
imul ['edx,', '[ecx+12Ch]']
add ['edx,', 'ds:_offset_width']
cmp ['[ebp+Paint.rcPaint.right],', 'edx']
jge ['short', 'loc_8389']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', 'ds:_font_height']
imul ['ecx,', '[eax+128h]']
add ['ecx,', 'ds:_offset_height']
cmp ['[ebp+Paint.rcPaint.bottom],', 'ecx']
jl ['loc_8516']
mov ['esi,', 'esp']
mov ['edx,', 'ds:color']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__CreateSolidBrush@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+h],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+h]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_9C4],', 'eax']
mov ['esi,', 'esp']
mov ['edx,', 'ds:color']
push ['edx']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__CreatePen@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+ho],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+ho]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_9CC],', 'eax']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+Paint.rcPaint.bottom]']
push ['edx']
mov ['eax,', '[ebp+Paint.rcPaint.right]']
push ['eax']
mov ['ecx,', '[ebp+Paint.rcPaint.top]']
push ['ecx']
mov ['edx,', '[ebp+Paint.rcPaint.left]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IntersectClipRect@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', 'ds:_font_height']
imul ['edx,', '[ecx+128h]']
add ['edx,', 'ds:_offset_height']
mov ['esi,', 'esp']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', 'ds:_font_width']
imul ['ecx,', '[eax+12Ch]']
add ['ecx,', 'ds:_offset_width']
push ['ecx']
mov ['edx,', 'ds:_offset_height']
push ['edx']
mov ['eax,', 'ds:_offset_width']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ExcludeClipRect@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+Paint.rcPaint.bottom]']
push ['edx']
mov ['eax,', '[ebp+Paint.rcPaint.right]']
push ['eax']
mov ['ecx,', '[ebp+Paint.rcPaint.top]']
push ['ecx']
mov ['edx,', '[ebp+Paint.rcPaint.left]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__Rectangle@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_9C4]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+h]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_9CC]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+ho]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0Dh']
call ['dword', 'ptr', 'ds:__imp__GetStockObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['6']
call ['dword', 'ptr', 'ds:__imp__GetStockObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['eax']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Paint]']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__EndPaint@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ShowCaret@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_9A43']
push ['8']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_9D0],', 'eax']
mov ['eax,', '[ebp+var_9D0]']
mov ['ecx,', '[ebp+lParam]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+var_9D0]']
mov ['eax,', '[ebp+arg_C]']
mov ['[edx+4],', 'eax']
mov ['ecx,', '[ebp+var_9D0]']
push ['ecx']
push ['offset', '_wm_netevent_callback']
call ['_queue_toplevel_callback']
add ['esp,', '8']
xor ['eax,', 'eax']
jmp ['loc_9A43']
push ['1']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_set_focus']
add ['esp,', '8']
mov ['esi,', 'esp']
mov ['eax,', 'ds:_font_height']
push ['eax']
mov ['ecx,', 'ds:_font_width']
push ['ecx']
mov ['edx,', 'ds:_caretbm']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__CreateCaret@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ShowCaret@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
call ['_flash_window']
add ['esp,', '4']
mov ['ds:_compose_state,', '0']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_update']
add ['esp,', '4']
jmp ['loc_9A24']
push ['1']
call ['_show_mouseptr']
add ['esp,', '4']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_set_focus']
add ['esp,', '8']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__DestroyCaret@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['_caret_y,', '0FFFFFFFFh']
mov ['ecx,', '_caret_y']
mov ['_caret_x,', 'ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_update']
add ['esp,', '4']
jmp ['loc_9A24']
push ['1']
call ['_EnableSizeTip']
add ['esp,', '4']
mov ['ds:_resizing,', '1']
mov ['ds:?need_backend_resize@?1??WndProc@@9@9,', '0']
jmp ['loc_9A24']
push ['0']
call ['_EnableSizeTip']
add ['esp,', '4']
mov ['ds:_resizing,', '0']
cmp ['ds:?need_backend_resize@?1??WndProc@@9@9,', '0']
jz ['short', 'loc_8738']
push ['5Bh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
push ['6Eh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
push ['6Fh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_size']
add ['esp,', '10h']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_9A24']
push ['6Ah']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_876E']
cmp ['[ebp+var_C],', '3']
jnz ['loc_89D5']
call ['_is_alt_pressed']
test ['eax,', 'eax']
jnz ['loc_89D5']
mov ['eax,', '[ebp+arg_C]']
mov ['[ebp+var_9EC],', 'eax']
cmp ['ds:?need_backend_resize@?1??WndProc@@9@9,', '0']
jnz ['loc_8828']
cmp ['[ebp+var_C],', '3']
jnz ['loc_8828']
push ['6Fh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
cmp ['eax,', '[edx+128h]']
jnz ['short', 'loc_87CB']
push ['6Eh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['eax,', '[ecx+12Ch]']
jz ['short', 'loc_8828']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+128h]']
push ['eax']
push ['6Fh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_set_int']
add ['esp,', '0Ch']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+12Ch]']
push ['eax']
push ['6Eh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_set_int']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:?need_backend_resize@?1??WndProc@@9@9,', '1']
mov ['eax,', '[ebp+var_9EC]']
mov ['ecx,', '[ebp+var_9EC]']
mov ['edx,', '[eax+8]']
sub ['edx,', '[ecx]']
sub ['edx,', 'ds:_extra_width']
mov ['[ebp+var_9D4],', 'edx']
mov ['eax,', '[ebp+var_9EC]']
mov ['ecx,', '[ebp+var_9EC]']
mov ['edx,', '[eax+0Ch]']
sub ['edx,', '[ecx+4]']
sub ['edx,', 'ds:_extra_height']
mov ['[ebp+var_9D8],', 'edx']
mov ['eax,', 'ds:_font_width']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
add ['eax,', '[ebp+var_9D4]']
cdq
idiv ['ds:_font_width']
mov ['[ebp+var_9DC],', 'eax']
cmp ['[ebp+var_9DC],', '1']
jge ['short', 'loc_8893']
mov ['[ebp+var_9DC],', '1']
mov ['eax,', 'ds:_font_height']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
add ['eax,', '[ebp+var_9D8]']
cdq
idiv ['ds:_font_height']
mov ['[ebp+var_9E0],', 'eax']
cmp ['[ebp+var_9E0],', '1']
jge ['short', 'loc_88C3']
mov ['[ebp+var_9E0],', '1']
mov ['eax,', '[ebp+var_9E0]']
push ['eax']
mov ['ecx,', '[ebp+var_9DC]']
push ['ecx']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['_UpdateSizeTip']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_9DC]']
imul ['eax,', 'ds:_font_width']
mov ['ecx,', '[ebp+var_9D4]']
sub ['ecx,', 'eax']
mov ['[ebp+var_9E4],', 'ecx']
mov ['edx,', '[ebp+var_9E0]']
imul ['edx,', 'ds:_font_height']
mov ['eax,', '[ebp+var_9D8]']
sub ['eax,', 'edx']
mov ['[ebp+var_9E8],', 'eax']
cmp ['[ebp+var_9E4],', '0']
jz ['short', 'loc_895E']
cmp ['[ebp+lParam],', '1']
jz ['short', 'loc_892E']
cmp ['[ebp+lParam],', '7']
jz ['short', 'loc_892E']
cmp ['[ebp+lParam],', '4']
jnz ['short', 'loc_8946']
mov ['ecx,', '[ebp+var_9EC]']
mov ['edx,', '[ecx]']
add ['edx,', '[ebp+var_9E4]']
mov ['eax,', '[ebp+var_9EC]']
mov ['[eax],', 'edx']
jmp ['short', 'loc_895E']
mov ['ecx,', '[ebp+var_9EC]']
mov ['edx,', '[ecx+8]']
sub ['edx,', '[ebp+var_9E4]']
mov ['eax,', '[ebp+var_9EC]']
mov ['[eax+8],', 'edx']
cmp ['[ebp+var_9E8],', '0']
jz ['short', 'loc_89AB']
cmp ['[ebp+lParam],', '3']
jz ['short', 'loc_8979']
cmp ['[ebp+lParam],', '5']
jz ['short', 'loc_8979']
cmp ['[ebp+lParam],', '4']
jnz ['short', 'loc_8993']
mov ['ecx,', '[ebp+var_9EC]']
mov ['edx,', '[ecx+4]']
add ['edx,', '[ebp+var_9E8]']
mov ['eax,', '[ebp+var_9EC]']
mov ['[eax+4],', 'edx']
jmp ['short', 'loc_89AB']
mov ['ecx,', '[ebp+var_9EC]']
mov ['edx,', '[ecx+0Ch]']
sub ['edx,', '[ebp+var_9E8]']
mov ['eax,', '[ebp+var_9EC]']
mov ['[eax+0Ch],', 'edx']
cmp ['[ebp+var_9E4],', '0']
jnz ['short', 'loc_89BD']
cmp ['[ebp+var_9E8],', '0']
jz ['short', 'loc_89C9']
mov ['eax,', '1']
jmp ['loc_9A43']
jmp ['short', 'loc_89D0']
xor ['eax,', 'eax']
jmp ['loc_9A43']
jmp ['$LN104']
mov ['[ebp+var_A00],', '0']
push ['7Ah']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_A04],', 'eax']
mov ['edx,', '[ebp+var_A04]']
sub ['edx,', 'ds:_offset_width']
mov ['eax,', 'ds:_extra_width']
lea ['ecx,', '[eax+edx*2]']
mov ['[ebp+var_A08],', 'ecx']
mov ['edx,', '[ebp+var_A04]']
sub ['edx,', 'ds:_offset_height']
mov ['eax,', 'ds:_extra_height']
lea ['ecx,', '[eax+edx*2]']
mov ['[ebp+var_A0C],', 'ecx']
mov ['edx,', '[ebp+arg_C]']
mov ['[ebp+var_A10],', 'edx']
mov ['eax,', '[ebp+var_A10]']
mov ['ecx,', '[ebp+var_A10]']
mov ['edx,', '[eax+8]']
sub ['edx,', '[ecx]']
sub ['edx,', '[ebp+var_A08]']
mov ['[ebp+var_9F0],', 'edx']
mov ['eax,', '[ebp+var_A10]']
mov ['ecx,', '[ebp+var_A10]']
mov ['edx,', '[eax+0Ch]']
sub ['edx,', '[ecx+4]']
sub ['edx,', '[ebp+var_A0C]']
mov ['[ebp+var_9F4],', 'edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[eax+12Ch]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
add ['eax,', '[ebp+var_9F0]']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cdq
idiv ['dword', 'ptr', '[ecx+12Ch]']
mov ['[ebp+var_9F8],', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+128h]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
add ['eax,', '[ebp+var_9F4]']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cdq
idiv ['dword', 'ptr', '[ecx+128h]']
mov ['[ebp+var_9FC],', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[ebp+var_9F8]']
imul ['eax,', '[edx+12Ch]']
mov ['ecx,', '[ebp+var_A10]']
mov ['edx,', '[ecx]']
add ['edx,', 'eax']
add ['edx,', '[ebp+var_A08]']
mov ['eax,', '[ebp+var_A10]']
cmp ['[eax+8],', 'edx']
jz ['short', 'loc_8AF9']
mov ['[ebp+var_A00],', '1']
cmp ['[ebp+lParam],', '1']
jz ['short', 'loc_8B0B']
cmp ['[ebp+lParam],', '7']
jz ['short', 'loc_8B0B']
cmp ['[ebp+lParam],', '4']
jnz ['short', 'loc_8B39']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', '[ebp+var_9F8]']
imul ['edx,', '[ecx+12Ch]']
mov ['eax,', '[ebp+var_A10]']
mov ['ecx,', '[eax+8]']
sub ['ecx,', 'edx']
sub ['ecx,', '[ebp+var_A08]']
mov ['edx,', '[ebp+var_A10]']
mov ['[edx],', 'ecx']
jmp ['short', 'loc_8B64']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', '[ebp+var_9F8]']
imul ['ecx,', '[eax+12Ch]']
mov ['edx,', '[ebp+var_A10]']
mov ['eax,', '[edx]']
add ['eax,', 'ecx']
add ['eax,', '[ebp+var_A08]']
mov ['ecx,', '[ebp+var_A10]']
mov ['[ecx+8],', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[ebp+var_9FC]']
imul ['eax,', '[edx+128h]']
mov ['ecx,', '[ebp+var_A10]']
mov ['edx,', '[ecx+4]']
add ['edx,', 'eax']
add ['edx,', '[ebp+var_A0C]']
mov ['eax,', '[ebp+var_A10]']
cmp ['[eax+0Ch],', 'edx']
jz ['short', 'loc_8B9D']
mov ['[ebp+var_A00],', '1']
cmp ['[ebp+lParam],', '3']
jz ['short', 'loc_8BAF']
cmp ['[ebp+lParam],', '5']
jz ['short', 'loc_8BAF']
cmp ['[ebp+lParam],', '4']
jnz ['short', 'loc_8BDE']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', '[ebp+var_9FC]']
imul ['edx,', '[ecx+128h]']
mov ['eax,', '[ebp+var_A10]']
mov ['ecx,', '[eax+0Ch]']
sub ['ecx,', 'edx']
sub ['ecx,', '[ebp+var_A0C]']
mov ['edx,', '[ebp+var_A10]']
mov ['[edx+4],', 'ecx']
jmp ['short', 'loc_8C0A']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', '[ebp+var_9FC]']
imul ['ecx,', '[eax+128h]']
mov ['edx,', '[ebp+var_A10]']
mov ['eax,', '[edx+4]']
add ['eax,', 'ecx']
add ['eax,', '[ebp+var_A0C]']
mov ['ecx,', '[ebp+var_A10]']
mov ['[ecx+0Ch],', 'eax']
mov ['eax,', '[ebp+var_A00]']
jmp ['loc_9A43']
mov ['ds:?fullscr_on_max@?1??WndProc@@9@9,', '1']
jmp ['loc_9A24']
call ['_sys_cursor_update']
jmp ['loc_9A24']
push ['6Ah']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+lParam],', '1']
jnz ['short', 'loc_8C90']
push ['6Dh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_8C6A']
mov ['ecx,', 'ds:_window_name']
mov ['[ebp+var_C2C],', 'ecx']
jmp ['short', 'loc_8C76']
mov ['edx,', 'ds:_icon_name']
mov ['[ebp+var_C2C],', 'edx']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_C2C]']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowTextA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+lParam],', '0']
jz ['short', 'loc_8C9C']
cmp ['[ebp+lParam],', '2']
jnz ['short', 'loc_8CB6']
mov ['esi,', 'esp']
mov ['edx,', 'ds:_window_name']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowTextA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+lParam],', '0']
jnz ['short', 'loc_8CDB']
mov ['ds:?processed_resize@?1??WndProc@@9@9,', '0']
call ['_clear_full_screen']
cmp ['ds:?processed_resize@?1??WndProc@@9@9,', '0']
jz ['short', 'loc_8CDB']
xor ['eax,', 'eax']
jmp ['loc_9A43']
cmp ['[ebp+lParam],', '2']
jnz ['short', 'loc_8D13']
cmp ['ds:?fullscr_on_max@?1??WndProc@@9@9,', '0']
jz ['short', 'loc_8D13']
mov ['ds:?fullscr_on_max@?1??WndProc@@9@9,', '0']
mov ['ds:?processed_resize@?1??WndProc@@9@9,', '0']
call ['_make_full_screen']
cmp ['ds:?processed_resize@?1??WndProc@@9@9,', '0']
jz ['short', 'loc_8D13']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['ds:?processed_resize@?1??WndProc@@9@9,', '1']
cmp ['[ebp+var_C],', '1']
jnz ['short', 'loc_8D32']
push ['0FFFFFFFFh']
call ['_reset_window']
add ['esp,', '4']
jmp ['loc_907A']
push ['7Ah']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_A24],', 'eax']
mov ['edx,', '[ebp+arg_C]']
and ['edx,', '0FFFFh']
movzx ['eax,', 'dx']
mov ['[ebp+var_A14],', 'eax']
mov ['ecx,', '[ebp+arg_C]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
mov ['[ebp+var_A18],', 'edx']
cmp ['[ebp+lParam],', '2']
jnz ['loc_8E8C']
cmp ['ds:_was_zoomed,', '0']
jnz ['loc_8E8C']
mov ['ds:_was_zoomed,', '1']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', '[eax+128h]']
mov ['ds:_prev_rows,', 'ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+12Ch]']
mov ['ds:_prev_cols,', 'eax']
cmp ['[ebp+var_C],', '0']
jnz ['loc_8E7D']
mov ['eax,', '[ebp+var_A14]']
cdq
idiv ['ds:_font_width']
mov ['[ebp+var_A1C],', 'eax']
cmp ['[ebp+var_A1C],', '1']
jge ['short', 'loc_8DE3']
mov ['[ebp+var_A1C],', '1']
mov ['eax,', '[ebp+var_A18]']
cdq
idiv ['ds:_font_height']
mov ['[ebp+var_A20],', 'eax']
cmp ['[ebp+var_A20],', '1']
jge ['short', 'loc_8E09']
mov ['[ebp+var_A20],', '1']
cmp ['ds:_resizing,', '0']
jz ['short', 'loc_8E4E']
mov ['ds:?need_backend_resize@?1??WndProc@@9@9,', '1']
mov ['ecx,', '[ebp+var_A20]']
push ['ecx']
push ['6Fh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_set_int']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_A1C]']
push ['eax']
push ['6Eh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_set_int']
add ['esp,', '0Ch']
jmp ['short', 'loc_8E7D']
push ['5Bh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['eax,', '[ebp+var_A1C]']
push ['eax']
mov ['ecx,', '[ebp+var_A20]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_size']
add ['esp,', '10h']
push ['0']
call ['_reset_window']
add ['esp,', '4']
jmp ['loc_907A']
cmp ['[ebp+lParam],', '0']
jnz ['loc_8F73']
cmp ['ds:_was_zoomed,', '0']
jz ['loc_8F73']
mov ['ds:_was_zoomed,', '0']
cmp ['[ebp+var_C],', '0']
jnz ['loc_8F52']
mov ['eax,', '[ebp+var_A24]']
shl ['eax,', '1']
mov ['ecx,', '[ebp+var_A14]']
sub ['ecx,', 'eax']
mov ['eax,', 'ecx']
cdq
idiv ['ds:_font_width']
mov ['[ebp+var_A1C],', 'eax']
cmp ['[ebp+var_A1C],', '1']
jge ['short', 'loc_8EE9']
mov ['[ebp+var_A1C],', '1']
mov ['edx,', '[ebp+var_A24]']
shl ['edx,', '1']
mov ['eax,', '[ebp+var_A18]']
sub ['eax,', 'edx']
cdq
idiv ['ds:_font_height']
mov ['[ebp+var_A20],', 'eax']
cmp ['[ebp+var_A20],', '1']
jge ['short', 'loc_8F19']
mov ['[ebp+var_A20],', '1']
push ['5Bh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['ecx,', '[ebp+var_A1C]']
push ['ecx']
mov ['edx,', '[ebp+var_A20]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_size']
add ['esp,', '10h']
push ['2']
call ['_reset_window']
add ['esp,', '4']
jmp ['short', 'loc_8F6E']
cmp ['[ebp+var_C],', '2']
jz ['short', 'loc_8F64']
push ['2']
call ['_reset_window']
add ['esp,', '4']
jmp ['short', 'loc_8F6E']
push ['0']
call ['_reset_window']
add ['esp,', '4']
jmp ['loc_907A']
cmp ['[ebp+lParam],', '1']
jnz ['short', 'loc_8F7E']
jmp ['loc_907A']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_8F9B']
cmp ['[ebp+var_C],', '3']
jnz ['loc_9070']
call ['_is_alt_pressed']
test ['eax,', 'eax']
jnz ['loc_9070']
mov ['ecx,', '[ebp+var_A24]']
shl ['ecx,', '1']
mov ['eax,', '[ebp+var_A14]']
sub ['eax,', 'ecx']
cdq
idiv ['ds:_font_width']
mov ['[ebp+var_A1C],', 'eax']
cmp ['[ebp+var_A1C],', '1']
jge ['short', 'loc_8FCB']
mov ['[ebp+var_A1C],', '1']
mov ['edx,', '[ebp+var_A24]']
shl ['edx,', '1']
mov ['eax,', '[ebp+var_A18]']
sub ['eax,', 'edx']
cdq
idiv ['ds:_font_height']
mov ['[ebp+var_A20],', 'eax']
cmp ['[ebp+var_A20],', '1']
jge ['short', 'loc_8FFB']
mov ['[ebp+var_A20],', '1']
cmp ['ds:_resizing,', '0']
jz ['short', 'loc_903F']
mov ['ds:?need_backend_resize@?1??WndProc@@9@9,', '1']
mov ['eax,', '[ebp+var_A20]']
push ['eax']
push ['6Fh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_set_int']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_A1C]']
push ['edx']
push ['6Eh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_set_int']
add ['esp,', '0Ch']
jmp ['short', 'loc_906E']
push ['5Bh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+var_A1C]']
push ['edx']
mov ['eax,', '[ebp+var_A20]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_size']
add ['esp,', '10h']
jmp ['short', 'loc_907A']
push ['0']
call ['_reset_window']
add ['esp,', '4']
call ['_sys_cursor_update']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['edx,', '[ebp+lParam]']
and ['edx,', '0FFFFh']
movzx ['eax,', 'dx']
mov ['[ebp+var_C30],', 'eax']
cmp ['[ebp+var_C30],', '7']
ja ['loc_91BD']
mov ['ecx,', '[ebp+var_C30]']
jmp ['ds:$LN317[ecx*4]']
push ['0']
push ['0FFFFFFFFh']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_scroll']
add ['esp,', '0Ch']
jmp ['loc_91BD']
push ['0']
push ['1']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_scroll']
add ['esp,', '0Ch']
jmp ['loc_91BD']
push ['1']
push ['0']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_scroll']
add ['esp,', '0Ch']
jmp ['loc_91BD']
push ['0FFFFFFFFh']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_scroll']
add ['esp,', '0Ch']
jmp ['loc_91BD']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[eax+128h]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
push ['eax']
push ['0']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_scroll']
add ['esp,', '0Ch']
jmp ['loc_91BD']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+128h]']
neg ['eax']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
push ['eax']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_scroll']
add ['esp,', '0Ch']
jmp ['short', 'loc_91BD']
mov ['[ebp+var_A44.cbSize],', '1Ch']
mov ['[ebp+var_A44.fMask],', '10h']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_A44]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetScrollInfo@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_91A6']
mov ['eax,', '[ebp+lParam]']
shr ['eax,', '10h']
and ['eax,', '0FFFFh']
movzx ['ecx,', 'ax']
mov ['[ebp+var_A44.nTrackPos],', 'ecx']
mov ['edx,', '[ebp+var_A44.nTrackPos]']
push ['edx']
push ['1']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_scroll']
add ['esp,', '0Ch']
jmp ['loc_9A24']
mov ['ecx,', '[ebp+lParam]']
cmp ['ecx,', '[ebp+hWnd]']
jz ['short', 'loc_922B']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_922B']
push ['0']
call ['_get_ctx']
add ['esp,', '4']
mov ['[ebp+var_A4C],', 'eax']
cmp ['[ebp+var_A4C],', '0']
jz ['short', 'loc_922B']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_A4C]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__RealizePalette@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jbe ['short', 'loc_921C']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_A4C]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__UpdateColors@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_A4C]']
push ['ecx']
call ['_free_ctx']
add ['esp,', '4']
jmp ['loc_9A24']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_929B']
push ['0']
call ['_get_ctx']
add ['esp,', '4']
mov ['[ebp+var_A50],', 'eax']
cmp ['[ebp+var_A50],', '0']
jz ['short', 'loc_929B']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_A50]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__RealizePalette@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jbe ['short', 'loc_9282']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_A50]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__UpdateColors@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_A50]']
push ['ecx']
call ['_free_ctx']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['loc_9A43']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_noise_ultralight']
add ['esp,', '4']
cmp ['[ebp+lParam],', '0E5h']
jnz ['short', 'loc_930D']
cmp ['[ebp+arg_4],', '100h']
jnz ['short', 'loc_9303']
mov ['eax,', '[ebp+hWnd]']
mov ['[ebp+Msg.hwnd],', 'eax']
mov ['[ebp+Msg.message],', '100h']
mov ['ecx,', '[ebp+lParam]']
mov ['[ebp+Msg.wParam],', 'ecx']
mov ['edx,', '[ebp+arg_C]']
and ['edx,', '0DFFFh']
mov ['[ebp+Msg.lParam],', 'edx']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Msg]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__TranslateMessage@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_9308']
jmp ['loc_9A24']
jmp ['loc_93A3']
lea ['ecx,', '[ebp+var_A68]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+lParam]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_TranslateKey']
add ['esp,', '10h']
mov ['[ebp+var_A70],', 'eax']
cmp ['[ebp+var_A70],', '0FFFFFFFFh']
jnz ['short', 'loc_935B']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+lParam]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DefWindowProcA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_9A43']
cmp ['[ebp+var_A70],', '0']
jz ['short', 'loc_93A3']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_9399']
push ['1']
mov ['ecx,', '[ebp+var_A70]']
push ['ecx']
lea ['edx,', '[ebp+var_A68]']
push ['edx']
mov ['eax,', 'ds:_ldisc']
push ['eax']
call ['_ldisc_send']
add ['esp,', '10h']
push ['0']
call ['_show_mouseptr']
add ['esp,', '4']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_set_input_locale']
add ['esp,', '4']
call ['_sys_cursor_update']
jmp ['loc_9A24']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['_ImmGetContext@4']
mov ['[ebp+var_A98],', 'eax']
push ['offset', '_lfont']
mov ['eax,', '[ebp+var_A98]']
push ['eax']
call ['_ImmSetCompositionFontA@8']
mov ['ecx,', '[ebp+var_A98]']
push ['ecx']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['_ImmReleaseContext@8']
jmp ['loc_9A24']
cmp ['dword', 'ptr', 'ds:_osVersion+10h,', '1']
jz ['short', 'loc_9407']
cmp ['dword', 'ptr', 'ds:_osVersion+10h,', '0']
jnz ['short', 'loc_940C']
jmp ['loc_9A24']
mov ['eax,', '[ebp+arg_C]']
and ['eax,', '800h']
jnz ['short', 'loc_941B']
jmp ['loc_9A24']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['_ImmGetContext@4']
mov ['[ebp+var_A9C],', 'eax']
push ['0']
push ['0']
push ['800h']
mov ['edx,', '[ebp+var_A9C]']
push ['edx']
call ['_ImmGetCompositionStringW@16']
mov ['[ebp+dwBufLen],', 'eax']
cmp ['[ebp+dwBufLen],', '0']
jle ['loc_95B5']
push ['1']
mov ['eax,', '[ebp+dwBufLen]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+lpBuf],', 'eax']
mov ['ecx,', '[ebp+dwBufLen]']
push ['ecx']
mov ['edx,', '[ebp+lpBuf]']
push ['edx']
push ['800h']
mov ['eax,', '[ebp+var_A9C]']
push ['eax']
call ['_ImmGetCompositionStringW@16']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['loc_95A6']
mov ['[ebp+var_AA8],', '0']
jmp ['short', 'loc_94BF']
mov ['edx,', '[ebp+var_AA8]']
add ['edx,', '2']
mov ['[ebp+var_AA8],', 'edx']
mov ['eax,', '[ebp+var_AA8]']
cmp ['eax,', '[ebp+dwBufLen]']
jge ['loc_95A6']
mov ['ecx,', '[ebp+lpBuf]']
add ['ecx,', '[ebp+var_AA8]']
mov ['dx,', '[ecx]']
mov ['[ebp+var_AAC],', 'dx']
movzx ['eax,', '[ebp+var_AAC]']
cmp ['eax,', '0D800h']
jl ['loc_9581']
movzx ['ecx,', '[ebp+var_AAC]']
cmp ['ecx,', '0DBFFh']
jg ['short', 'loc_9581']
mov ['edx,', '[ebp+var_AA8]']
add ['edx,', '2']
cmp ['edx,', '[ebp+dwBufLen]']
jge ['short', 'loc_9581']
mov ['eax,', '[ebp+lpBuf]']
add ['eax,', '[ebp+var_AA8]']
mov ['cx,', '[eax+2]']
mov ['[ebp+var_AB0],', 'cx']
movzx ['edx,', '[ebp+var_AB0]']
cmp ['edx,', '0DC00h']
jl ['short', 'loc_9581']
movzx ['eax,', '[ebp+var_AB0]']
cmp ['eax,', '0DFFFh']
jg ['short', 'loc_9581']
push ['1']
push ['2']
mov ['ecx,', '[ebp+lpBuf]']
add ['ecx,', '[ebp+var_AA8]']
push ['ecx']
mov ['edx,', 'ds:_ldisc']
push ['edx']
call ['_luni_send']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_AA8]']
add ['eax,', '2']
mov ['[ebp+var_AA8],', 'eax']
jmp ['loc_94B0']
push ['1']
push ['1']
mov ['ecx,', '[ebp+lpBuf]']
add ['ecx,', '[ebp+var_AA8]']
push ['ecx']
mov ['edx,', 'ds:_ldisc']
push ['edx']
call ['_luni_send']
add ['esp,', '10h']
jmp ['loc_94B0']
mov ['eax,', '[ebp+lpBuf]']
push ['eax']
call ['_free']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_A9C]']
push ['ecx']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['_ImmReleaseContext@8']
mov ['eax,', '1']
jmp ['loc_9A43']
mov ['eax,', '[ebp+lParam]']
and ['eax,', '0FF00h']
jz ['short', 'loc_9627']
mov ['cl,', 'byte', 'ptr', '[ebp+lParam]']
mov ['[ebp+var_AB7],', 'cl']
mov ['edx,', '[ebp+lParam]']
shr ['edx,', '8']
mov ['[ebp+var_AB8],', 'dl']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_9625']
push ['1']
push ['2']
lea ['ecx,', '[ebp+var_AB8]']
push ['ecx']
mov ['edx,', 'ds:_kbd_codepage']
push ['edx']
mov ['eax,', 'ds:_ldisc']
push ['eax']
call ['_lpage_send']
add ['esp,', '14h']
jmp ['short', 'loc_9669']
mov ['cl,', 'byte', 'ptr', '[ebp+lParam]']
mov ['[ebp+var_AC1],', 'cl']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_9669']
push ['1']
push ['1']
lea ['eax,', '[ebp+var_AC1]']
push ['eax']
mov ['ecx,', 'ds:_kbd_codepage']
push ['ecx']
mov ['edx,', 'ds:_ldisc']
push ['edx']
call ['_lpage_send']
add ['esp,', '14h']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['al,', 'byte', 'ptr', '[ebp+lParam]']
mov ['[ebp+var_ACD],', 'al']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_96AC']
push ['1']
push ['1']
lea ['edx,', '[ebp+var_ACD]']
push ['edx']
push ['0']
mov ['eax,', 'ds:_ldisc']
push ['eax']
call ['_lpage_send']
add ['esp,', '14h']
xor ['eax,', 'eax']
jmp ['loc_9A43']
push ['81h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_96E4']
call ['_systopalette']
call ['_init_palette']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_invalidate']
add ['esp,', '4']
jmp ['loc_9A24']
mov ['eax,', '[ebp+arg_C]']
mov ['[ebp+var_AD8],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_AD8]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+var_AD8]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+var_AD8]']
mov ['eax,', '[edx+4]']
push ['eax']
mov ['ecx,', '[ebp+var_AD8]']
mov ['edx,', '[ecx]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_AD8]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['ecx,', '[ebp+lParam]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_process_clipdata']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_975E']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_do_paste']
add ['esp,', '4']
xor ['eax,', 'eax']
jmp ['loc_9A43']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '_wm_mousewheel']
jz ['short', 'loc_977D']
cmp ['[ebp+arg_4],', '20Ah']
jnz ['loc_9A24']
mov ['[ebp+var_ADC],', '0']
mov ['[ebp+var_AE0],', '0']
cmp ['[ebp+arg_4],', '20Ah']
jnz ['short', 'loc_97DF']
mov ['edx,', '[ebp+lParam]']
shr ['edx,', '10h']
and ['edx,', '0FFFFh']
movsx ['eax,', 'dx']
add ['eax,', 'ds:_wheel_accumulator']
mov ['ds:_wheel_accumulator,', 'eax']
mov ['ecx,', '[ebp+lParam]']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
and ['edx,', '4']
mov ['[ebp+var_ADC],', 'edx']
mov ['eax,', '[ebp+lParam]']
and ['eax,', '0FFFFh']
movzx ['ecx,', 'ax']
and ['ecx,', '8']
mov ['[ebp+var_AE0],', 'ecx']
jmp ['short', 'loc_982E']
mov ['edx,', 'ds:_wheel_accumulator']
add ['edx,', '[ebp+lParam]']
mov ['ds:_wheel_accumulator,', 'edx']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+KeyState]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetKeyboardState@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_982E']
movzx ['ecx,', '[ebp+var_BD4]']
and ['ecx,', '80h']
mov ['[ebp+var_ADC],', 'ecx']
movzx ['edx,', '[ebp+var_BD3]']
and ['edx,', '80h']
mov ['[ebp+var_AE0],', 'edx']
mov ['eax,', 'ds:_wheel_accumulator']
push ['eax']
call ['_abs']
add ['esp,', '4']
cmp ['eax,', '78h']
jl ['loc_9A20']
cmp ['ds:_wheel_accumulator,', '0']
jle ['short', 'loc_9869']
mov ['[ebp+var_BEC],', '7']
mov ['ecx,', 'ds:_wheel_accumulator']
sub ['ecx,', '78h']
mov ['ds:_wheel_accumulator,', 'ecx']
jmp ['short', 'loc_9892']
cmp ['ds:_wheel_accumulator,', '0']
jge ['short', 'loc_988D']
mov ['[ebp+var_BEC],', '8']
mov ['edx,', 'ds:_wheel_accumulator']
add ['edx,', '78h']
mov ['ds:_wheel_accumulator,', 'edx']
jmp ['short', 'loc_9892']
jmp ['loc_9A20']
cmp ['ds:_send_raw_mouse,', '0']
jz ['loc_99C8']
push ['89h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_98C3']
cmp ['[ebp+var_ADC],', '0']
jnz ['loc_99C8']
mov ['ecx,', '[ebp+arg_C]']
and ['ecx,', '0FFFFh']
movsx ['edx,', 'cx']
mov ['[ebp+var_BF8.x],', 'edx']
mov ['eax,', '[ebp+arg_C]']
shr ['eax,', '10h']
and ['eax,', '0FFFFh']
movsx ['ecx,', 'ax']
mov ['[ebp+var_BF8.y],', 'ecx']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_BF8]']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__ScreenToClient@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['loc_99C6']
cmp ['[ebp+var_BF8.y],', '0']
jge ['short', 'loc_992B']
mov ['ecx,', '[ebp+var_BF8.y]']
sub ['ecx,', 'ds:_font_height']
add ['ecx,', '1']
mov ['[ebp+var_C34],', 'ecx']
jmp ['short', 'loc_9937']
mov ['edx,', '[ebp+var_BF8.y]']
mov ['[ebp+var_C34],', 'edx']
cmp ['[ebp+var_BF8.x],', '0']
jge ['short', 'loc_9957']
mov ['eax,', '[ebp+var_BF8.x]']
sub ['eax,', 'ds:_font_width']
add ['eax,', '1']
mov ['[ebp+var_C38],', 'eax']
jmp ['short', 'loc_9963']
mov ['ecx,', '[ebp+var_BF8.x]']
mov ['[ebp+var_C38],', 'ecx']
call ['_is_alt_pressed']
push ['eax']
mov ['edx,', '[ebp+var_AE0]']
push ['edx']
mov ['eax,', '[ebp+var_ADC]']
push ['eax']
mov ['eax,', '[ebp+var_C34]']
sub ['eax,', 'ds:_offset_height']
cdq
idiv ['ds:_font_height']
push ['eax']
mov ['eax,', '[ebp+var_C38]']
sub ['eax,', 'ds:_offset_width']
cdq
idiv ['ds:_font_width']
push ['eax']
push ['1']
mov ['ecx,', '[ebp+var_BEC]']
push ['ecx']
call ['_translate_button']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+var_BEC]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_mouse']
add ['esp,', '24h']
jmp ['short', 'loc_9A1B']
cmp ['[ebp+var_BEC],', '7']
jnz ['short', 'loc_99EC']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[ecx+128h]']
neg ['eax']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['[ebp+var_C3C],', 'eax']
jmp ['short', 'loc_9A03']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+128h]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['[ebp+var_C3C],', 'eax']
mov ['eax,', '[ebp+var_C3C]']
push ['eax']
push ['0']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_scroll']
add ['esp,', '0Ch']
jmp ['loc_982E']
xor ['eax,', 'eax']
jmp ['short', 'loc_9A43']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+lParam]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DefWindowProcA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN309']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '0C3Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['10h']
endp
_wm_netevent_callback proc near         
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['_select_result']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_click          proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetMessageTime@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', 'eax']
cmp ['ds:_send_raw_mouse,', '0']
jz ['short', 'loc_9EE1']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_9E9C']
push ['89h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_9EE1']
mov ['ds:_lastbtn,', '0']
mov ['ecx,', '[ebp+arg_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['1']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_translate_button']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_mouse']
add ['esp,', '24h']
jmp ['loc_9F9F']
mov ['eax,', 'ds:_lastbtn']
cmp ['eax,', '[ebp+arg_0]']
jnz ['short', 'loc_9F40']
mov ['ecx,', '[ebp+var_4]']
sub ['ecx,', 'ds:_lasttime']
cmp ['ecx,', 'ds:_dbltime']
jge ['short', 'loc_9F40']
cmp ['ds:_lastact,', '1']
jnz ['short', 'loc_9F0E']
mov ['[ebp+var_8],', '2']
jmp ['short', 'loc_9F35']
cmp ['ds:_lastact,', '2']
jnz ['short', 'loc_9F20']
mov ['[ebp+var_C],', '3']
jmp ['short', 'loc_9F2F']
xor ['edx,', 'edx']
cmp ['ds:_lastact,', '3']
setz ['dl']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
mov ['ds:_lastact,', 'ecx']
jmp ['short', 'loc_9F53']
mov ['edx,', '[ebp+arg_0]']
mov ['ds:_lastbtn,', 'edx']
mov ['ds:_lastact,', '1']
cmp ['ds:_lastact,', '0']
jz ['short', 'loc_9F97']
mov ['eax,', '[ebp+arg_14]']
push ['eax']
mov ['ecx,', '[ebp+arg_10]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', 'ds:_lastact']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_translate_button']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_mouse']
add ['esp,', '24h']
mov ['eax,', '[ebp+var_4]']
mov ['ds:_lasttime,', 'eax']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_translate_button proc near             
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_0],', '1']
jnz ['short', 'loc_9FC8']
mov ['eax,', '4']
jmp ['short', 'loc_A017']
cmp ['[ebp+arg_0],', '2']
jnz ['short', 'loc_9FED']
push ['85h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
sub ['eax,', '1']
neg ['eax']
sbb ['eax,', 'eax']
add ['eax,', '6']
jmp ['short', 'loc_A017']
cmp ['[ebp+arg_0],', '3']
jnz ['short', 'loc_A015']
push ['85h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
sub ['eax,', '1']
neg ['eax']
sbb ['eax,', 'eax']
neg ['eax']
add ['eax,', '5']
jmp ['short', 'loc_A017']
xor ['eax,', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_show_mouseptr  proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
push ['78h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_A047']
mov ['[ebp+arg_0],', '1']
cmp ['?cursor_visible@?1??show_mouseptr@@9@9,', '0']
jz ['short', 'loc_A069']
cmp ['[ebp+arg_0],', '0']
jnz ['short', 'loc_A069']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__ShowCursor@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_A089']
cmp ['?cursor_visible@?1??show_mouseptr@@9@9,', '0']
jnz ['short', 'loc_A089']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_A089']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__ShowCursor@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['?cursor_visible@?1??show_mouseptr@@9@9,', 'ecx']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_is_alt_pressed proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '110h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_110]']
mov ['ecx,', '44h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+KeyState]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetKeyboardState@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_110],', 'eax']
cmp ['[ebp+var_110],', '0']
jnz ['short', 'loc_A0F8']
xor ['eax,', 'eax']
jmp ['short', 'loc_A123']
movzx ['ecx,', '[ebp+var_F6]']
and ['ecx,', '80h']
jz ['short', 'loc_A10E']
mov ['eax,', '1']
jmp ['short', 'loc_A123']
movzx ['edx,', '[ebp+var_63]']
and ['edx,', '80h']
jz ['short', 'loc_A121']
mov ['eax,', '1']
jmp ['short', 'loc_A123']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN8_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '110h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sys_cursor     proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[eax+134h],', '0']
jnz ['short', 'loc_A19C']
jmp ['short', 'loc_A1F0']
mov ['ecx,', '[ebp+arg_4]']
imul ['ecx,', 'ds:_font_width']
add ['ecx,', 'ds:_offset_width']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
imul ['edx,', 'ds:_font_height']
add ['edx,', 'ds:_offset_height']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_4]']
cmp ['eax,', '_caret_x']
jnz ['short', 'loc_A1DA']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '_caret_y']
jnz ['short', 'loc_A1DA']
jmp ['short', 'loc_A1F0']
mov ['edx,', '[ebp+var_4]']
mov ['_caret_x,', 'edx']
mov ['eax,', '[ebp+var_8]']
mov ['_caret_y,', 'eax']
call ['_sys_cursor_update']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sys_cursor_update proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '2Ch']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_2C]']
mov ['ecx,', '0Bh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[eax+134h],', '0']
jnz ['short', 'loc_A23C']
jmp ['loc_A2CF']
cmp ['_caret_x,', '0']
jl ['short', 'loc_A24E']
cmp ['_caret_y,', '0']
jge ['short', 'loc_A250']
jmp ['short', 'loc_A2CF']
mov ['esi,', 'esp']
mov ['ecx,', '_caret_y']
push ['ecx']
mov ['edx,', '_caret_x']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetCaretPos@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['dword', 'ptr', 'ds:_osVersion+10h,', '0']
jnz ['short', 'loc_A278']
jmp ['short', 'loc_A2CF']
cmp ['dword', 'ptr', 'ds:_osVersion+10h,', '1']
jnz ['short', 'loc_A28C']
cmp ['dword', 'ptr', 'ds:_osVersion+8,', '0']
jnz ['short', 'loc_A28C']
jmp ['short', 'loc_A2CF']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['_ImmGetContext@4']
mov ['[ebp+var_2C],', 'eax']
mov ['[ebp+CompForm.dwStyle],', '2']
mov ['ecx,', '_caret_x']
mov ['[ebp+CompForm.ptCurrentPos.x],', 'ecx']
mov ['edx,', '_caret_y']
mov ['[ebp+CompForm.ptCurrentPos.y],', 'edx']
lea ['eax,', '[ebp+CompForm]']
push ['eax']
mov ['ecx,', '[ebp+var_2C]']
push ['ecx']
call ['_ImmSetCompositionWindow@8']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['_ImmReleaseContext@8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN10_3']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '2Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_text_internal proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0B4h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_B4]']
mov ['ecx,', '2Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+hdc],', 'eax']
mov ['[ebp+var_3C],', '0']
mov ['[ebp+var_48],', '0']
mov ['[ebp+var_4C],', '0']
mov ['[ebp+var_5C],', '0']
mov ['ecx,', '[ebp+arg_18]']
and ['ecx,', '3']
mov ['[ebp+arg_18],', 'ecx']
xor ['edx,', 'edx']
cmp ['[ebp+arg_18],', '0']
setnz ['dl']
add ['edx,', '1']
imul ['edx,', 'ds:_font_width']
mov ['[ebp+var_40],', 'edx']
mov ['eax,', '[ebp+var_40]']
mov ['[ebp+var_44],', 'eax']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '400000h']
jz ['short', 'loc_A399']
mov ['edx,', '[ebp+var_44]']
shl ['edx,', '1']
mov ['[ebp+var_44],', 'edx']
cmp ['[ebp+arg_18],', '0']
jz ['short', 'loc_A3B7']
mov ['eax,', '[ebp+arg_4]']
shl ['eax,', '1']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['eax,', '[ecx+12Ch]']
jl ['short', 'loc_A3B7']
jmp ['loc_B372']
mov ['edx,', '[ebp+arg_4]']
imul ['edx,', '[ebp+var_40]']
mov ['[ebp+arg_4],', 'edx']
mov ['eax,', '[ebp+arg_8]']
imul ['eax,', 'ds:_font_height']
mov ['[ebp+arg_8],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', 'ds:_offset_width']
mov ['[ebp+arg_4],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', 'ds:_offset_height']
mov ['[ebp+arg_8],', 'edx']
mov ['eax,', '[ebp+arg_14]']
and ['eax,', '40000000h']
jz ['short', 'loc_A426']
cmp ['dword', 'ptr', 'ds:_cursor_type,', '0']
jz ['short', 'loc_A408']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[ecx+158h],', '0']
jz ['short', 'loc_A426']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '0FFCC0000h']
mov ['[ebp+arg_14],', 'edx']
mov ['eax,', '[ebp+arg_14]']
or ['eax,', '20B04h']
mov ['[ebp+arg_14],', 'eax']
mov ['[ebp+var_5C],', '1']
mov ['[ebp+var_1C],', '0']
cmp ['dword', 'ptr', 'ds:_vtmode,', '3']
jnz ['short', 'loc_A445']
cmp ['[ebp+arg_18],', '0']
jz ['short', 'loc_A445']
mov ['[ebp+arg_18],', '1']
jmp ['short', 'loc_A478']
mov ['ecx,', '[ebp+arg_18]']
mov ['[ebp+var_A8],', 'ecx']
cmp ['[ebp+var_A8],', '0']
jz ['short', 'loc_A462']
cmp ['[ebp+var_A8],', '1']
jz ['short', 'loc_A464']
jmp ['short', 'loc_A46F']
jmp ['short', 'loc_A478']
mov ['edx,', '[ebp+var_1C]']
or ['edx,', '4']
mov ['[ebp+var_1C],', 'edx']
jmp ['short', 'loc_A478']
mov ['eax,', '[ebp+var_1C]']
or ['eax,', '0Ch']
mov ['[ebp+var_1C],', 'eax']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '800000h']
jz ['short', 'loc_A48C']
mov ['edx,', '[ebp+var_1C]']
or ['edx,', '10h']
mov ['[ebp+var_1C],', 'edx']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
cmp ['ecx,', '23BAh']
jl ['loc_A56E']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx]']
cmp ['eax,', '23BDh']
jg ['loc_A56E']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
mov ['[ebp+var_AC],', 'edx']
mov ['eax,', '[ebp+var_AC]']
sub ['eax,', '0BAh']
mov ['[ebp+var_AC],', 'eax']
cmp ['[ebp+var_AC],', '3']
ja ['short', 'loc_A530']
mov ['ecx,', '[ebp+var_AC]']
jmp ['ds:$LN121[ecx*4]']
mov ['eax,', 'ds:_font_height']
imul ['eax,', '-2']
cdq
mov ['ecx,', '5']
idiv ['ecx']
mov ['[ebp+var_48],', 'eax']
jmp ['short', 'loc_A530']
mov ['eax,', 'ds:_font_height']
imul ['eax,', '-1']
cdq
mov ['ecx,', '5']
idiv ['ecx']
mov ['[ebp+var_48],', 'eax']
jmp ['short', 'loc_A530']
mov ['eax,', 'ds:_font_height']
cdq
mov ['ecx,', '5']
idiv ['ecx']
mov ['[ebp+var_48],', 'eax']
jmp ['short', 'loc_A530']
mov ['eax,', 'ds:_font_height']
shl ['eax,', '1']
cdq
mov ['ecx,', '5']
idiv ['ecx']
mov ['[ebp+var_48],', 'eax']
cmp ['[ebp+arg_18],', '2']
jz ['short', 'loc_A53C']
cmp ['[ebp+arg_18],', '3']
jnz ['short', 'loc_A544']
mov ['edx,', '[ebp+var_48]']
shl ['edx,', '1']
mov ['[ebp+var_48],', 'edx']
mov ['eax,', '[ebp+arg_C]']
mov ['cx,', 'ds:word_CB2']
mov ['[eax],', 'cx']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '80000h']
jz ['short', 'loc_A56E']
mov ['eax,', '[ebp+arg_14]']
and ['eax,', '0FFF7FFFFh']
mov ['[ebp+arg_14],', 'eax']
mov ['[ebp+var_3C],', '1']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
and ['edx,', '0FFFFFC00h']
cmp ['edx,', '0D800h']
jnz ['short', 'loc_A5EC']
cmp ['[ebp+arg_10],', '2']
jl ['short', 'loc_A5C1']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
cmp ['ecx,', '0D800h']
jl ['short', 'loc_A5C1']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx]']
cmp ['eax,', '0DBFFh']
jg ['short', 'loc_A5C1']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+2]']
cmp ['edx,', '0DC00h']
jl ['short', 'loc_A5C1']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+2]']
cmp ['ecx,', '0DFFFh']
jle ['short', 'loc_A5EC']
mov ['[ebp+var_68],', '0']
jmp ['short', 'loc_A5D3']
mov ['edx,', '[ebp+var_68]']
add ['edx,', '1']
mov ['[ebp+var_68],', 'edx']
mov ['eax,', '[ebp+var_68]']
cmp ['eax,', '[ebp+arg_10]']
jge ['short', 'loc_A5EC']
mov ['ecx,', '0FFFDh']
mov ['edx,', '[ebp+var_68]']
mov ['eax,', '[ebp+arg_C]']
mov ['[eax+edx*2],', 'cx']
jmp ['short', 'loc_A5CA']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
and ['edx,', '0FFFFFF00h']
cmp ['edx,', '0F000h']
jnz ['short', 'loc_A609']
mov ['eax,', '[ebp+var_1C]']
or ['eax,', '20h']
mov ['[ebp+var_1C],', 'eax']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '1FFh']
mov ['[ebp+var_14],', 'ecx']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '3FE00h']
shr ['edx,', '9']
mov ['[ebp+var_18],', 'edx']
cmp ['ds:_bold_font_mode,', '2']
jnz ['short', 'loc_A640']
mov ['eax,', '[ebp+arg_14]']
and ['eax,', '40000h']
jz ['short', 'loc_A640']
mov ['ecx,', '[ebp+var_1C]']
or ['ecx,', '1']
mov ['[ebp+var_1C],', 'ecx']
cmp ['ds:_und_mode,', '1']
jnz ['short', 'loc_A65D']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '80000h']
jz ['short', 'loc_A65D']
mov ['eax,', '[ebp+var_1C]']
or ['eax,', '2']
mov ['[ebp+var_1C],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
call ['_another_font']
add ['esp,', '4']
mov ['edx,', '[ebp+var_1C]']
cmp ['ds:_fonts[edx*4],', '0']
jnz ['short', 'loc_A68E']
mov ['eax,', '[ebp+var_1C]']
and ['eax,', '2']
jz ['short', 'loc_A685']
mov ['[ebp+var_3C],', '1']
mov ['ecx,', '[ebp+var_1C]']
and ['ecx,', '0FFFFFFFCh']
mov ['[ebp+var_1C],', 'ecx']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
call ['_another_font']
add ['esp,', '4']
mov ['eax,', '[ebp+var_1C]']
cmp ['ds:_fonts[eax*4],', '0']
jnz ['short', 'loc_A6AE']
mov ['[ebp+var_1C],', '0']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '100000h']
jz ['short', 'loc_A6CB']
mov ['edx,', '[ebp+var_14]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_18]']
mov ['[ebp+var_14],', 'eax']
mov ['ecx,', '[ebp+var_10]']
mov ['[ebp+var_18],', 'ecx']
cmp ['ds:_bold_colours,', '0']
jz ['short', 'loc_A708']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '40000h']
jz ['short', 'loc_A708']
cmp ['[ebp+var_5C],', '0']
jnz ['short', 'loc_A708']
cmp ['[ebp+var_14],', '10h']
jge ['short', 'loc_A6F6']
mov ['eax,', '[ebp+var_14]']
or ['eax,', '8']
mov ['[ebp+var_14],', 'eax']
jmp ['short', 'loc_A708']
cmp ['[ebp+var_14],', '100h']
jl ['short', 'loc_A708']
mov ['ecx,', '[ebp+var_14]']
or ['ecx,', '1']
mov ['[ebp+var_14],', 'ecx']
cmp ['ds:_bold_colours,', '0']
jz ['short', 'loc_A73F']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '200000h']
jz ['short', 'loc_A73F']
cmp ['[ebp+var_18],', '10h']
jge ['short', 'loc_A72D']
mov ['eax,', '[ebp+var_18]']
or ['eax,', '8']
mov ['[ebp+var_18],', 'eax']
jmp ['short', 'loc_A73F']
cmp ['[ebp+var_18],', '100h']
jl ['short', 'loc_A73F']
mov ['ecx,', '[ebp+var_18]']
or ['ecx,', '1']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', 'ds:_colours[edx*4]']
mov ['[ebp+color],', 'eax']
mov ['ecx,', '[ebp+var_18]']
mov ['edx,', 'ds:_colours[ecx*4]']
mov ['[ebp+var_C],', 'edx']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', 'ds:_fonts[eax*4]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+color]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetTextColor@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetBkColor@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '80000000h']
jz ['short', 'loc_A7C7']
mov ['esi,', 'esp']
push ['1']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetBkMode@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_A7DC']
mov ['esi,', 'esp']
push ['2']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetBkMode@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+rect.left],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+rect.top],', 'edx']
mov ['eax,', '[ebp+var_44]']
imul ['eax,', '[ebp+arg_10]']
add ['eax,', '[ebp+arg_4]']
mov ['[ebp+rect.right],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
add ['ecx,', 'ds:_font_height']
mov ['[ebp+rect.bottom],', 'ecx']
mov ['[ebp+var_70],', '0']
mov ['[ebp+var_6C],', '0']
jmp ['short', 'loc_A81A']
mov ['edx,', '[ebp+var_6C]']
add ['edx,', '1']
mov ['[ebp+var_6C],', 'edx']
mov ['eax,', '[ebp+var_6C]']
cmp ['eax,', '[ebp+arg_10]']
jge ['loc_A934']
mov ['ecx,', '[ebp+var_6C]']
add ['ecx,', '1']
cmp ['ecx,', '[ebp+arg_10]']
jge ['short', 'loc_A877']
mov ['edx,', '[ebp+var_6C]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
cmp ['ecx,', '0DB40h']
jnz ['short', 'loc_A877']
mov ['edx,', '[ebp+var_6C]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2+2]']
cmp ['ecx,', '0DD00h']
jl ['short', 'loc_A877']
mov ['edx,', '[ebp+var_6C]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2+2]']
cmp ['ecx,', '0DDEFh']
jg ['short', 'loc_A877']
mov ['edx,', '[ebp+var_6C]']
add ['edx,', '1']
mov ['[ebp+var_6C],', 'edx']
jmp ['loc_A92F']
mov ['eax,', '[ebp+var_6C]']
add ['eax,', '1']
cmp ['eax,', '[ebp+arg_10]']
jge ['short', 'loc_A8DC']
mov ['ecx,', '[ebp+var_6C]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '0D800h']
jl ['short', 'loc_A8DC']
mov ['ecx,', '[ebp+var_6C]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '0DBFFh']
jg ['short', 'loc_A8DC']
mov ['ecx,', '[ebp+var_6C]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2+2]']
cmp ['eax,', '0DC00h']
jl ['short', 'loc_A8DC']
mov ['ecx,', '[ebp+var_6C]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2+2]']
cmp ['eax,', '0DFFFh']
jg ['short', 'loc_A8DC']
mov ['ecx,', '[ebp+var_70]']
add ['ecx,', '[ebp+var_44]']
mov ['[ebp+var_70],', 'ecx']
mov ['edx,', '[ebp+var_6C]']
add ['edx,', '1']
mov ['[ebp+var_6C],', 'edx']
jmp ['short', 'loc_A92F']
mov ['eax,', '[ebp+var_6C]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2]']
cmp ['edx,', '180Bh']
jl ['short', 'loc_A900']
mov ['eax,', '[ebp+var_6C]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2]']
cmp ['edx,', '180Dh']
jle ['short', 'loc_A924']
mov ['eax,', '[ebp+var_6C]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2]']
cmp ['edx,', '0FE00h']
jl ['short', 'loc_A926']
mov ['eax,', '[ebp+var_6C]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2]']
cmp ['edx,', '0FE0Fh']
jg ['short', 'loc_A926']
jmp ['short', 'loc_A92F']
mov ['eax,', '[ebp+var_70]']
add ['eax,', '[ebp+var_44]']
mov ['[ebp+var_70],', 'eax']
jmp ['loc_A811']
mov ['ecx,', '[ebp+rect.left]']
add ['ecx,', '[ebp+var_70]']
mov ['[ebp+rect.right],', 'ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', 'ds:_font_width']
imul ['eax,', '[edx+12Ch]']
add ['eax,', 'ds:_offset_width']
cmp ['[ebp+rect.right],', 'eax']
jle ['short', 'loc_A976']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
mov ['edx,', 'ds:_font_width']
imul ['edx,', '[ecx+12Ch]']
add ['edx,', 'ds:_offset_width']
mov ['[ebp+rect.right],', 'edx']
cmp ['ds:_font_varpitch,', '0']
jz ['short', 'loc_A9AF']
mov ['eax,', '[ebp+var_44]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['[ebp+var_4C],', 'eax']
mov ['esi,', 'esp']
push ['6']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetTextAlign@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+lpDx],', '0']
mov ['[ebp+var_50],', '1']
jmp ['short', 'loc_A9DA']
mov ['[ebp+var_4C],', '0']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetTextAlign@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['[ebp+lpDx],', 'edx']
mov ['eax,', '[ebp+arg_10]']
mov ['[ebp+var_50],', 'eax']
mov ['[ebp+var_58],', '1']
mov ['ecx,', '[ebp+arg_10]']
mov ['[ebp+var_54],', 'ecx']
jmp ['short', 'loc_AA0B']
mov ['edx,', '[ebp+arg_10]']
mov ['eax,', '[ebp+arg_C]']
lea ['ecx,', '[eax+edx*2]']
mov ['[ebp+arg_C],', 'ecx']
mov ['edx,', '[ebp+var_54]']
sub ['edx,', '[ebp+arg_10]']
mov ['[ebp+var_54],', 'edx']
mov ['eax,', '[ebp+var_44]']
imul ['eax,', '[ebp+var_64]']
add ['eax,', '[ebp+arg_4]']
mov ['[ebp+arg_4],', 'eax']
cmp ['[ebp+var_54],', '0']
jle ['loc_B275']
mov ['ecx,', '[ebp+var_50]']
cmp ['ecx,', '[ebp+var_54]']
jge ['short', 'loc_AA28']
mov ['edx,', '[ebp+var_50]']
mov ['[ebp+var_B0],', 'edx']
jmp ['short', 'loc_AA31']
mov ['eax,', '[ebp+var_54]']
mov ['[ebp+var_B0],', 'eax']
mov ['ecx,', '[ebp+var_B0]']
mov ['[ebp+arg_10],', 'ecx']
mov ['edx,', '[ebp+arg_10]']
mov ['[ebp+var_64],', 'edx']
cmp ['[ebp+var_50],', '1']
jnz ['loc_AB38']
cmp ['[ebp+var_54],', '1']
jl ['short', 'loc_AA92']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
cmp ['ecx,', '0D800h']
jl ['short', 'loc_AA92']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx]']
cmp ['eax,', '0DBFFh']
jg ['short', 'loc_AA92']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+2]']
cmp ['edx,', '0DC00h']
jl ['short', 'loc_AA92']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+2]']
cmp ['ecx,', '0DFFFh']
jg ['short', 'loc_AA92']
mov ['edx,', '[ebp+arg_10]']
add ['edx,', '1']
mov ['[ebp+arg_10],', 'edx']
mov ['eax,', '[ebp+var_54]']
sub ['eax,', '[ebp+arg_10]']
cmp ['eax,', '1']
jl ['short', 'loc_AAEC']
mov ['ecx,', '[ebp+arg_10]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '180Bh']
jl ['short', 'loc_AABF']
mov ['ecx,', '[ebp+arg_10]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '180Dh']
jle ['short', 'loc_AAE1']
mov ['ecx,', '[ebp+arg_10]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '0FE00h']
jl ['short', 'loc_AAEC']
mov ['ecx,', '[ebp+arg_10]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '0FE0Fh']
jg ['short', 'loc_AAEC']
mov ['ecx,', '[ebp+arg_10]']
add ['ecx,', '1']
mov ['[ebp+arg_10],', 'ecx']
jmp ['short', 'loc_AB38']
mov ['edx,', '[ebp+var_54]']
sub ['edx,', '[ebp+arg_10]']
cmp ['edx,', '2']
jl ['short', 'loc_AB38']
mov ['eax,', '[ebp+arg_10]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2]']
cmp ['edx,', '0DB40h']
jnz ['short', 'loc_AB38']
mov ['eax,', '[ebp+arg_10]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2+2]']
cmp ['edx,', '0DD00h']
jl ['short', 'loc_AB38']
mov ['eax,', '[ebp+arg_10]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2+2]']
cmp ['edx,', '0DDEFh']
jg ['short', 'loc_AB38']
mov ['eax,', '[ebp+arg_10]']
add ['eax,', '2']
mov ['[ebp+arg_10],', 'eax']
mov ['ecx,', '[ebp+arg_10]']
cmp ['ecx,', 'ds:?lpDx_len@?1??do_text_internal@@9@9']
jle ['short', 'loc_AB85']
mov ['eax,', '[ebp+arg_10]']
imul ['eax,', '9']
cdq
and ['edx,', '7']
add ['eax,', 'edx']
sar ['eax,', '3']
add ['eax,', '10h']
mov ['ds:?lpDx_len@?1??do_text_internal@@9@9,', 'eax']
push ['4']
mov ['edx,', 'ds:?lpDx_len@?1??do_text_internal@@9@9']
push ['edx']
mov ['eax,', 'ds:?lpDx@?1??do_text_internal@@9@9']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ds:?lpDx@?1??do_text_internal@@9@9,', 'eax']
cmp ['[ebp+lpDx],', '0']
jz ['short', 'loc_AB85']
mov ['ecx,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['[ebp+lpDx],', 'ecx']
mov ['[ebp+var_74],', '0']
jmp ['short', 'loc_AB97']
mov ['edx,', '[ebp+var_74]']
add ['edx,', '1']
mov ['[ebp+var_74],', 'edx']
mov ['eax,', '[ebp+var_74]']
cmp ['eax,', '[ebp+arg_10]']
jge ['loc_AD27']
mov ['ecx,', '[ebp+var_74]']
mov ['edx,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['eax,', '[ebp+var_44]']
mov ['[edx+ecx*4],', 'eax']
mov ['ecx,', '[ebp+var_74]']
add ['ecx,', '1']
cmp ['ecx,', '[ebp+arg_10]']
jge ['short', 'loc_AC38']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
cmp ['ecx,', '0DB40h']
jnz ['short', 'loc_AC38']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2+2]']
cmp ['ecx,', '0DD00h']
jl ['short', 'loc_AC38']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2+2]']
cmp ['ecx,', '0DDEFh']
jg ['short', 'loc_AC38']
cmp ['[ebp+var_74],', '0']
jle ['short', 'loc_AC0B']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['dword', 'ptr', '[eax+edx*4-4],', '0']
mov ['ecx,', '[ebp+var_74]']
mov ['edx,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['dword', 'ptr', '[edx+ecx*4],', '0']
mov ['eax,', '[ebp+var_74]']
add ['eax,', '1']
mov ['[ebp+var_74],', 'eax']
mov ['ecx,', '[ebp+var_74]']
mov ['edx,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['eax,', '[ebp+var_44]']
mov ['[edx+ecx*4],', 'eax']
jmp ['loc_AD22']
mov ['ecx,', '[ebp+var_74]']
add ['ecx,', '1']
cmp ['ecx,', '[ebp+arg_10]']
jge ['short', 'loc_ACB5']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
cmp ['ecx,', '0D800h']
jl ['short', 'loc_ACB5']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
cmp ['ecx,', '0DBFFh']
jg ['short', 'loc_ACB5']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2+2]']
cmp ['ecx,', '0DC00h']
jl ['short', 'loc_ACB5']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2+2]']
cmp ['ecx,', '0DFFFh']
jg ['short', 'loc_ACB5']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['dword', 'ptr', '[eax+edx*4],', '0']
mov ['ecx,', '[ebp+var_74]']
add ['ecx,', '1']
mov ['[ebp+var_74],', 'ecx']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['ecx,', '[ebp+var_44]']
mov ['[eax+edx*4],', 'ecx']
jmp ['short', 'loc_AD22']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
cmp ['ecx,', '180Bh']
jl ['short', 'loc_ACD9']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
cmp ['ecx,', '180Dh']
jle ['short', 'loc_ACFD']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
cmp ['ecx,', '0FE00h']
jl ['short', 'loc_AD22']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
cmp ['ecx,', '0FE0Fh']
jg ['short', 'loc_AD22']
cmp ['[ebp+var_74],', '0']
jle ['short', 'loc_AD13']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['dword', 'ptr', '[eax+edx*4-4],', '0']
mov ['ecx,', '[ebp+var_74]']
mov ['edx,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['eax,', '[ebp+var_44]']
mov ['[edx+ecx*4],', 'eax']
jmp ['loc_AB8E']
cmp ['ds:dword_5C4,', '0']
jz ['loc_AF9A']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
and ['edx,', '0FFFFFF00h']
cmp ['edx,', '0F100h']
jnz ['loc_AF9A']
mov ['eax,', '[ebp+arg_10]']
cmp ['eax,', 'ds:?uni_len@?BO@??do_text_internal@@9@9']
jle ['short', 'loc_AD84']
mov ['ecx,', 'ds:?uni_buf@?BO@??do_text_internal@@9@9']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_10]']
mov ['ds:?uni_len@?BO@??do_text_internal@@9@9,', 'edx']
push ['2']
mov ['eax,', 'ds:?uni_len@?BO@??do_text_internal@@9@9']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ds:?uni_buf@?BO@??do_text_internal@@9@9,', 'eax']
mov ['[ebp+var_7C],', '0']
mov ['ecx,', '[ebp+var_7C]']
mov ['[ebp+c],', 'ecx']
jmp ['short', 'loc_AD9C']
mov ['edx,', '[ebp+var_7C]']
add ['edx,', '1']
mov ['[ebp+var_7C],', 'edx']
mov ['eax,', '[ebp+var_7C]']
cmp ['eax,', '[ebp+arg_10]']
jge ['loc_AEB6']
mov ['ecx,', '0FFFDh']
mov ['edx,', '[ebp+c]']
mov ['eax,', 'ds:?uni_buf@?BO@??do_text_internal@@9@9']
mov ['[eax+edx*2],', 'cx']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_7C]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'byte', 'ptr', '[edx+ecx*2]']
push ['eax']
mov ['ecx,', 'ds:CodePage']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__IsDBCSLeadByteEx@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['loc_AE63']
mov ['edx,', '[ebp+var_7C]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
and ['ecx,', '0FFh']
mov ['[ebp+MultiByteStr],', 'cl']
mov ['edx,', '[ebp+var_7C]']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2+2]']
and ['ecx,', '0FFh']
mov ['[ebp+var_83],', 'cl']
mov ['edx,', '[ebp+c]']
mov ['eax,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['ecx,', '[eax+edx*4]']
add ['ecx,', '[ebp+var_44]']
mov ['edx,', '[ebp+c]']
mov ['eax,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['[eax+edx*4],', 'ecx']
mov ['esi,', 'esp']
push ['1']
mov ['ecx,', '[ebp+c]']
mov ['edx,', 'ds:?uni_buf@?BO@??do_text_internal@@9@9']
lea ['eax,', '[edx+ecx*2]']
push ['eax']
push ['2']
lea ['ecx,', '[ebp+MultiByteStr]']
push ['ecx']
push ['4']
mov ['edx,', 'ds:CodePage']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__MultiByteToWideChar@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_7C]']
add ['eax,', '1']
mov ['[ebp+var_7C],', 'eax']
jmp ['short', 'loc_AEA8']
mov ['ecx,', '[ebp+var_7C]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
and ['eax,', '0FFh']
mov ['[ebp+var_8D],', 'al']
mov ['esi,', 'esp']
push ['1']
mov ['ecx,', '[ebp+c]']
mov ['edx,', 'ds:?uni_buf@?BO@??do_text_internal@@9@9']
lea ['eax,', '[edx+ecx*2]']
push ['eax']
push ['1']
lea ['ecx,', '[ebp+var_8D]']
push ['ecx']
push ['4']
mov ['edx,', 'ds:CodePage']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__MultiByteToWideChar@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+c]']
add ['eax,', '1']
mov ['[ebp+c],', 'eax']
jmp ['loc_AD93']
cmp ['[ebp+c],', '0']
jg ['short', 'loc_AEC1']
jmp ['loc_B372']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+lpDx]']
push ['ecx']
mov ['edx,', '[ebp+c]']
push ['edx']
mov ['eax,', 'ds:?uni_buf@?BO@??do_text_internal@@9@9']
push ['eax']
lea ['ecx,', '[ebp+rect]']
push ['ecx']
mov ['edx,', '[ebp+var_58]']
neg ['edx']
sbb ['edx,', 'edx']
and ['edx,', '2']
or ['edx,', '4']
push ['edx']
xor ['eax,', 'eax']
cmp ['[ebp+arg_18],', '3']
setz ['al']
imul ['eax,', 'ds:_font_height']
mov ['ecx,', '[ebp+arg_8]']
sub ['ecx,', 'eax']
add ['ecx,', '[ebp+var_48]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '[ebp+var_4C]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__ExtTextOutW@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['ds:_bold_font_mode,', '1']
jnz ['short', 'loc_AF89']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '40000h']
jz ['short', 'loc_AF89']
mov ['esi,', 'esp']
push ['1']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetBkMode@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+lpDx]']
push ['eax']
mov ['ecx,', '[ebp+c]']
push ['ecx']
mov ['edx,', 'ds:?uni_buf@?BO@??do_text_internal@@9@9']
push ['edx']
lea ['eax,', '[ebp+rect]']
push ['eax']
push ['4']
xor ['ecx,', 'ecx']
cmp ['[ebp+arg_18],', '3']
setz ['cl']
imul ['ecx,', 'ds:_font_height']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', 'ecx']
add ['edx,', '[ebp+var_48]']
push ['edx']
mov ['eax,', '[ebp+var_4C]']
mov ['ecx,', '[ebp+arg_4]']
lea ['edx,', '[ecx+eax-1]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__ExtTextOutW@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', 'ds:?lpDx@?1??do_text_internal@@9@9']
mov ['dword', 'ptr', '[ecx],', '0FFFFFFFFh']
jmp ['loc_B254']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx]']
and ['eax,', '0FFFFFE00h']
cmp ['eax,', '0F000h']
jnz ['loc_B0F5']
mov ['ecx,', '[ebp+arg_10]']
cmp ['ecx,', 'ds:?directlen@?CE@??do_text_internal@@9@9']
jle ['short', 'loc_AFE0']
mov ['edx,', '[ebp+arg_10]']
mov ['ds:?directlen@?CE@??do_text_internal@@9@9,', 'edx']
push ['1']
mov ['eax,', 'ds:?directlen@?CE@??do_text_internal@@9@9']
push ['eax']
mov ['ecx,', 'ds:?directbuf@?CE@??do_text_internal@@9@9']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ds:?directbuf@?CE@??do_text_internal@@9@9,', 'eax']
mov ['[ebp+var_98],', '0']
jmp ['short', 'loc_AFFB']
mov ['edx,', '[ebp+var_98]']
add ['edx,', '1']
mov ['[ebp+var_98],', 'edx']
mov ['eax,', '[ebp+var_98]']
cmp ['eax,', '[ebp+arg_10]']
jge ['short', 'loc_B028']
mov ['ecx,', '[ebp+var_98]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
and ['eax,', '0FFh']
mov ['ecx,', 'ds:?directbuf@?CE@??do_text_internal@@9@9']
add ['ecx,', '[ebp+var_98]']
mov ['[ecx],', 'al']
jmp ['short', 'loc_AFEC']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+lpDx]']
push ['edx']
mov ['eax,', '[ebp+arg_10]']
push ['eax']
mov ['ecx,', 'ds:?directbuf@?CE@??do_text_internal@@9@9']
push ['ecx']
lea ['edx,', '[ebp+rect]']
push ['edx']
mov ['eax,', '[ebp+var_58]']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '2']
or ['eax,', '4']
push ['eax']
xor ['ecx,', 'ecx']
cmp ['[ebp+arg_18],', '3']
setz ['cl']
imul ['ecx,', 'ds:_font_height']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', 'ecx']
add ['edx,', '[ebp+var_48]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
add ['eax,', '[ebp+var_4C]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ExtTextOutA@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['ds:_bold_font_mode,', '1']
jnz ['short', 'loc_B0F0']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '40000h']
jz ['short', 'loc_B0F0']
mov ['esi,', 'esp']
push ['1']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetBkMode@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+lpDx]']
push ['ecx']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', 'ds:?directbuf@?CE@??do_text_internal@@9@9']
push ['eax']
lea ['ecx,', '[ebp+rect]']
push ['ecx']
push ['4']
xor ['edx,', 'edx']
cmp ['[ebp+arg_18],', '3']
setz ['dl']
imul ['edx,', 'ds:_font_height']
mov ['eax,', '[ebp+arg_8]']
sub ['eax,', 'edx']
add ['eax,', '[ebp+var_48]']
push ['eax']
mov ['ecx,', '[ebp+var_4C]']
mov ['edx,', '[ebp+arg_4]']
lea ['eax,', '[edx+ecx-1]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ExtTextOutA@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_B254']
mov ['edx,', 'ds:?wlen@?CH@??do_text_internal@@9@9']
cmp ['edx,', '[ebp+arg_10]']
jge ['short', 'loc_B12D']
mov ['eax,', 'ds:?wbuf@?CH@??do_text_internal@@9@9']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_10]']
mov ['ds:?wlen@?CH@??do_text_internal@@9@9,', 'ecx']
push ['2']
mov ['edx,', 'ds:?wlen@?CH@??do_text_internal@@9@9']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['ds:?wbuf@?CH@??do_text_internal@@9@9,', 'eax']
mov ['[ebp+var_9C],', '0']
jmp ['short', 'loc_B148']
mov ['eax,', '[ebp+var_9C]']
add ['eax,', '1']
mov ['[ebp+var_9C],', 'eax']
mov ['ecx,', '[ebp+var_9C]']
cmp ['ecx,', '[ebp+arg_10]']
jge ['short', 'loc_B171']
mov ['edx,', '[ebp+var_9C]']
mov ['eax,', 'ds:?wbuf@?CH@??do_text_internal@@9@9']
mov ['ecx,', '[ebp+var_9C]']
mov ['esi,', '[ebp+arg_C]']
mov ['cx,', '[esi+ecx*2]']
mov ['[eax+edx*2],', 'cx']
jmp ['short', 'loc_B139']
cmp ['[ebp+var_58],', '0']
jz ['short', 'loc_B18E']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '80000000h']
jnz ['short', 'loc_B18E']
mov ['[ebp+var_B4],', '1']
jmp ['short', 'loc_B198']
mov ['[ebp+var_B4],', '0']
mov ['eax,', '[ebp+var_B4]']
push ['eax']
mov ['ecx,', 'ds:?lpDx@?1??do_text_internal@@9@9']
push ['ecx']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', 'ds:?wbuf@?CH@??do_text_internal@@9@9']
push ['eax']
lea ['ecx,', '[ebp+rect]']
push ['ecx']
xor ['edx,', 'edx']
cmp ['[ebp+arg_18],', '3']
setz ['dl']
imul ['edx,', 'ds:_font_height']
mov ['eax,', '[ebp+arg_8]']
sub ['eax,', 'edx']
add ['eax,', '[ebp+var_48]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '[ebp+var_4C]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['_general_textout']
add ['esp,', '20h']
cmp ['ds:_bold_font_mode,', '1']
jnz ['short', 'loc_B254']
mov ['eax,', '[ebp+arg_14]']
and ['eax,', '40000h']
jz ['short', 'loc_B254']
mov ['esi,', 'esp']
push ['1']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetBkMode@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+lpDx]']
push ['edx']
mov ['eax,', '[ebp+arg_10]']
push ['eax']
mov ['ecx,', 'ds:?wbuf@?CH@??do_text_internal@@9@9']
push ['ecx']
lea ['edx,', '[ebp+rect]']
push ['edx']
push ['4']
xor ['eax,', 'eax']
cmp ['[ebp+arg_18],', '3']
setz ['al']
imul ['eax,', 'ds:_font_height']
mov ['ecx,', '[ebp+arg_8]']
sub ['ecx,', 'eax']
add ['ecx,', '[ebp+var_48]']
push ['ecx']
mov ['edx,', '[ebp+var_4C]']
mov ['eax,', '[ebp+arg_4]']
lea ['ecx,', '[eax+edx-1]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ExtTextOutW@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetBkMode@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_58],', '0']
jmp ['loc_A9E9']
cmp ['[ebp+arg_18],', '2']
jz ['loc_B372']
cmp ['[ebp+var_3C],', '0']
jnz ['short', 'loc_B2A1']
cmp ['ds:_und_mode,', '0']
jnz ['loc_B372']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '80000h']
jz ['loc_B372']
mov ['edx,', 'ds:_descent']
mov ['[ebp+var_A4],', 'edx']
cmp ['[ebp+arg_18],', '3']
jnz ['short', 'loc_B2C7']
mov ['eax,', '[ebp+var_A4]']
shl ['eax,', '1']
sub ['eax,', 'ds:_font_height']
mov ['[ebp+var_A4],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+color]']
push ['ecx']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__CreatePen@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['eax']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+h],', 'eax']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', '[ebp+rect.top]']
add ['eax,', '[ebp+var_A4]']
push ['eax']
mov ['ecx,', '[ebp+rect.left]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__MoveToEx@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+rect.top]']
add ['eax,', '[ebp+var_A4]']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+rect.right]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__LineTo@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+h]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+h],', 'eax']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+h]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN120']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '0B4h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_general_textout proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+lpDx],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+mode],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+x],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+mode],', '0']
mov ['[ebp+var_18],', '0']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_10]']
mov ['[ebp+x],', 'ecx']
mov ['[ebp+var_4],', '0']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ebp+arg_14]']
jge ['loc_B5B9']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_10]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2]']
push ['edx']
call ['_is_rtl']
add ['esp,', '4']
mov ['[ebp+var_1C],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_18]']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ecx+eax*4]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
jmp ['short', 'loc_B485']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ebp+arg_14]']
jge ['short', 'loc_B4B8']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_10]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2]']
push ['edx']
call ['_is_rtl']
add ['esp,', '4']
cmp ['[ebp+var_1C],', 'eax']
jz ['short', 'loc_B4A7']
jmp ['short', 'loc_B4B8']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_18]']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ecx+eax*4]']
mov ['[ebp+var_10],', 'edx']
jmp ['short', 'loc_B47C']
cmp ['[ebp+var_1C],', '0']
jz ['short', 'loc_B50F']
cmp ['ds:_font_varpitch,', '0']
jz ['short', 'loc_B4D0']
mov ['[ebp+var_20],', '0']
jmp ['short', 'loc_B4DC']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_18]']
lea ['edx,', '[ecx+eax*4]']
mov ['[ebp+var_20],', 'edx']
mov ['eax,', '[ebp+arg_1C]']
push ['eax']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
sub ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_10]']
lea ['edx,', '[ecx+eax*2]']
push ['edx']
mov ['eax,', '[ebp+lprect]']
push ['eax']
mov ['ecx,', '[ebp+y]']
push ['ecx']
mov ['edx,', '[ebp+x]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['_exact_textout']
add ['esp,', '20h']
jmp ['short', 'loc_B56F']
cmp ['ds:_font_varpitch,', '0']
jz ['short', 'loc_B521']
mov ['[ebp+lpDx],', '0']
jmp ['short', 'loc_B52D']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_18]']
lea ['eax,', '[edx+ecx*4]']
mov ['[ebp+lpDx],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+lpDx]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
sub ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_10]']
lea ['edx,', '[ecx+eax*2]']
push ['edx']
mov ['eax,', '[ebp+lprect]']
push ['eax']
mov ['ecx,', '[ebp+arg_1C]']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '2']
or ['ecx,', '4']
push ['ecx']
mov ['edx,', '[ebp+y]']
push ['edx']
mov ['eax,', '[ebp+x]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ExtTextOutW@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_8]']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+var_10]']
mov ['[ebp+x],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetBkMode@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+mode],', 'eax']
mov ['[ebp+var_18],', '1']
mov ['esi,', 'esp']
push ['1']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetBkMode@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+arg_1C],', '0']
jmp ['loc_B440']
cmp ['[ebp+var_18],', '0']
jz ['short', 'loc_B5D6']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+mode]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetBkMode@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_exact_textout  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '34h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_34]']
mov ['ecx,', '0Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
push ['1']
mov ['eax,', '[ebp+Size]']
lea ['ecx,', '[eax+eax+2]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_30],', 'eax']
push ['1']
mov ['edx,', '[ebp+Size]']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_34],', 'eax']
push ['24h']
push ['0']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Size]']
lea ['edx,', '[ecx+ecx+2]']
push ['edx']
push ['0']
mov ['eax,', '[ebp+var_30]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
push ['3']
mov ['edx,', '[ebp+var_34]']
push ['edx']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['[ebp+Dst],', '24h']
mov ['eax,', '[ebp+var_30]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_34]']
mov ['[ebp+var_14],', 'ecx']
mov ['edx,', '[ebp+Size]']
mov ['[ebp+var_C],', 'edx']
mov ['esi,', 'esp']
push ['8113Bh']
lea ['eax,', '[ebp+Dst]']
push ['eax']
push ['0']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+lpString]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetCharacterPlacementW@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+lpDx]']
push ['ecx']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+var_30]']
push ['eax']
mov ['ecx,', '[ebp+lprect]']
push ['ecx']
mov ['edx,', '[ebp+arg_1C]']
neg ['edx']
sbb ['edx,', 'edx']
and ['edx,', '2']
or ['edx,', '14h']
push ['edx']
mov ['eax,', '[ebp+y]']
push ['eax']
mov ['ecx,', '[ebp+x]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ExtTextOutA@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_3']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '34h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_another_font   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '30h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_30]']
mov ['ecx,', '0Ch']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
cmp ['[ebp+arg_0],', '0']
jl ['short', 'loc_B748']
cmp ['[ebp+arg_0],', '40h']
jge ['short', 'loc_B748']
mov ['eax,', '[ebp+arg_0]']
cmp ['ds:_fontflag[eax*4],', '0']
jz ['short', 'loc_B74D']
jmp ['loc_B8D6']
mov ['ecx,', '[ebp+arg_0]']
and ['ecx,', '0FFFFFFFCh']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ebp+arg_0]']
jz ['short', 'loc_B777']
mov ['eax,', '[ebp+var_4]']
cmp ['ds:_fontflag[eax*4],', '0']
jnz ['short', 'loc_B777']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_another_font']
add ['esp,', '4']
push ['70h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_fontspec']
add ['esp,', '8']
mov ['[ebp+var_28],', 'eax']
mov ['eax,', '[ebp+var_28]']
cmp ['dword', 'ptr', '[eax+4],', '0']
jz ['short', 'loc_B7A4']
mov ['[ebp+var_8],', '2BCh']
mov ['[ebp+var_C],', '384h']
jmp ['short', 'loc_B7B2']
mov ['[ebp+var_8],', '0']
mov ['[ebp+var_C],', '2BCh']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ecx+0Ch]']
mov ['[ebp+iCharSet],', 'edx']
mov ['eax,', '[ebp+var_8]']
mov ['[ebp+cWeight],', 'eax']
mov ['[ebp+bUnderline],', '0']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ecx]']
mov ['[ebp+pszFaceName],', 'edx']
mov ['eax,', 'ds:_font_width']
mov ['[ebp+cWidth],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
and ['ecx,', '4']
jz ['short', 'loc_B7E8']
mov ['edx,', '[ebp+cWidth]']
shl ['edx,', '1']
mov ['[ebp+cWidth],', 'edx']
mov ['eax,', '[ebp+arg_0]']
and ['eax,', '10h']
jz ['short', 'loc_B7FE']
mov ['eax,', '[ebp+cWidth]']
add ['eax,', '1']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['[ebp+cWidth],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
and ['ecx,', '20h']
jz ['short', 'loc_B80D']
mov ['[ebp+iCharSet],', '0FFh']
mov ['edx,', '[ebp+arg_0]']
and ['edx,', '1']
jz ['short', 'loc_B81B']
mov ['eax,', '[ebp+var_C]']
mov ['[ebp+cWeight],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
and ['ecx,', '2']
jz ['short', 'loc_B82A']
mov ['[ebp+bUnderline],', '1']
push ['71h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jnz ['short', 'loc_B84D']
mov ['[ebp+iQuality],', '0']
jmp ['short', 'loc_B872']
cmp ['[ebp+var_10],', '1']
jnz ['short', 'loc_B85C']
mov ['[ebp+var_30],', '4']
jmp ['short', 'loc_B86C']
xor ['eax,', 'eax']
cmp ['[ebp+var_10],', '2']
setnz ['al']
lea ['eax,', '[eax+eax+3]']
mov ['[ebp+var_30],', 'eax']
mov ['ecx,', '[ebp+var_30]']
mov ['[ebp+iQuality],', 'ecx']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+pszFaceName]']
push ['edx']
push ['0']
mov ['eax,', '[ebp+iQuality]']
push ['eax']
push ['0']
push ['0']
mov ['ecx,', '[ebp+iCharSet]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+bUnderline]']
push ['edx']
push ['0']
mov ['eax,', '[ebp+cWeight]']
push ['eax']
push ['0']
push ['0']
mov ['ecx,', '[ebp+cWidth]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
and ['edx,', '8']
neg ['edx']
sbb ['edx,', 'edx']
neg ['edx']
add ['edx,', '1']
imul ['edx,', 'ds:_font_height']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__CreateFontA@56']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['ds:_fonts[ecx*4],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['ds:_fontflag[edx*4],', '1']
pop ['edi']
pop ['esi']
add ['esp,', '30h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_text        proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_14]']
and ['eax,', '80000000h']
jz ['loc_BB88']
mov ['[ebp+var_4],', '0']
mov ['[ebp+var_8],', '1']
cmp ['[ebp+arg_10],', '2']
jl ['short', 'loc_B965']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
cmp ['edx,', '0D800h']
jl ['short', 'loc_B965']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
cmp ['ecx,', '0DBFFh']
jg ['short', 'loc_B965']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+2]']
cmp ['eax,', '0DC00h']
jl ['short', 'loc_B965']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+2]']
cmp ['edx,', '0DFFFh']
jg ['short', 'loc_B965']
mov ['[ebp+var_8],', '2']
mov ['eax,', '[ebp+arg_10]']
sub ['eax,', '[ebp+var_8]']
cmp ['eax,', '1']
jl ['loc_BA12']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '180Bh']
jl ['short', 'loc_B996']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '180Dh']
jle ['short', 'loc_B9B8']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '0FE00h']
jl ['short', 'loc_BA12']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', '0FE0Fh']
jg ['short', 'loc_BA12']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '7FFFFFFFh']
mov ['[ebp+arg_14],', 'ecx']
mov ['edx,', '[ebp+arg_18]']
push ['edx']
mov ['eax,', '[ebp+arg_14]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_text_internal']
add ['esp,', '1Ch']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_C]']
lea ['edx,', '[ecx+eax*2+2]']
mov ['[ebp+arg_C],', 'edx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_10]']
sub ['ecx,', 'eax']
mov ['[ebp+arg_10],', 'ecx']
mov ['[ebp+var_4],', '80000000h']
jmp ['loc_BABB']
mov ['edx,', '[ebp+arg_10]']
sub ['edx,', '[ebp+var_8]']
cmp ['edx,', '2']
jl ['loc_BAAF']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2]']
cmp ['edx,', '0DB40h']
jnz ['short', 'loc_BAAF']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2+2]']
cmp ['edx,', '0DD00h']
jl ['short', 'loc_BAAF']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax*2+2]']
cmp ['edx,', '0DDEFh']
jg ['short', 'loc_BAAF']
mov ['eax,', '[ebp+arg_14]']
and ['eax,', '7FFFFFFFh']
mov ['[ebp+arg_14],', 'eax']
mov ['ecx,', '[ebp+arg_18]']
push ['ecx']
mov ['edx,', '[ebp+arg_14]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '2']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_do_text_internal']
add ['esp,', '1Ch']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+arg_C]']
lea ['ecx,', '[eax+edx*2+4]']
mov ['[ebp+arg_C],', 'ecx']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '2']
mov ['eax,', '[ebp+arg_10]']
sub ['eax,', 'edx']
mov ['[ebp+arg_10],', 'eax']
mov ['[ebp+var_4],', '80000000h']
jmp ['short', 'loc_BABB']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '7FFFFFFFh']
mov ['[ebp+arg_14],', 'ecx']
mov ['edx,', '[ebp+arg_10]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+arg_10]']
sub ['eax,', '1']
mov ['[ebp+arg_10],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['loc_BB86']
cmp ['[ebp+arg_10],', '1']
jl ['short', 'loc_BB4C']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
cmp ['edx,', '0D800h']
jl ['short', 'loc_BB4C']
mov ['eax,', '[ebp+arg_C]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
cmp ['ecx,', '0DBFFh']
jg ['short', 'loc_BB4C']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx+2]']
cmp ['eax,', '0DC00h']
jl ['short', 'loc_BB4C']
mov ['ecx,', '[ebp+arg_C]']
movzx ['edx,', 'word', 'ptr', '[ecx+2]']
cmp ['edx,', '0DFFFh']
jg ['short', 'loc_BB4C']
mov ['eax,', '[ebp+arg_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_14]']
or ['ecx,', '[ebp+var_4]']
push ['ecx']
push ['2']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_text_internal']
add ['esp,', '1Ch']
mov ['eax,', '[ebp+arg_10]']
sub ['eax,', '1']
mov ['[ebp+arg_10],', 'eax']
mov ['ecx,', '[ebp+arg_C]']
add ['ecx,', '2']
mov ['[ebp+arg_C],', 'ecx']
jmp ['short', 'loc_BB71']
mov ['edx,', '[ebp+arg_18]']
push ['edx']
mov ['eax,', '[ebp+arg_14]']
or ['eax,', '[ebp+var_4]']
push ['eax']
push ['1']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_do_text_internal']
add ['esp,', '1Ch']
mov ['edx,', '[ebp+arg_C]']
add ['edx,', '2']
mov ['[ebp+arg_C],', 'edx']
mov ['[ebp+var_4],', '80000000h']
jmp ['loc_BABB']
jmp ['short', 'loc_BBAC']
mov ['eax,', '[ebp+arg_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_do_text_internal']
add ['esp,', '1Ch']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_cursor      proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '68h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+ho]']
mov ['ecx,', '1Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+hdc],', 'eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_cursor_type']
mov ['[ebp+var_14],', 'ecx']
mov ['edx,', '[ebp+arg_18]']
and ['edx,', '3']
mov ['[ebp+arg_18],', 'edx']
mov ['eax,', '[ebp+arg_14]']
and ['eax,', '40000000h']
jz ['short', 'loc_BC69']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_BC20']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[ecx+158h],', '0']
jz ['short', 'loc_BC69']
mov ['edx,', '[ebp+arg_C]']
movzx ['eax,', 'word', 'ptr', '[edx]']
cmp ['eax,', '0DFFFh']
jz ['short', 'loc_BC56']
mov ['ecx,', '[ebp+arg_18]']
push ['ecx']
mov ['edx,', '[ebp+arg_14]']
push ['edx']
mov ['eax,', '[ebp+arg_10]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_do_text']
add ['esp,', '1Ch']
jmp ['loc_BF55']
mov ['[ebp+var_14],', '2']
mov ['edx,', '[ebp+arg_14]']
or ['edx,', '10000000h']
mov ['[ebp+arg_14],', 'edx']
xor ['eax,', 'eax']
cmp ['[ebp+arg_18],', '0']
setnz ['al']
add ['eax,', '1']
imul ['eax,', 'ds:_font_width']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '400000h']
jz ['short', 'loc_BC98']
mov ['eax,', '[ebp+var_C]']
shl ['eax,', '1']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
imul ['ecx,', '[ebp+var_8]']
mov ['[ebp+arg_4],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
imul ['edx,', 'ds:_font_height']
mov ['[ebp+arg_8],', 'edx']
mov ['eax,', '[ebp+arg_4]']
add ['eax,', 'ds:_offset_width']
mov ['[ebp+arg_4],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
add ['ecx,', 'ds:_offset_height']
mov ['[ebp+arg_8],', 'ecx']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '20000000h']
jz ['loc_BDB6']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_BCEE']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[eax+158h],', '0']
jz ['loc_BDB6']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_20],', 'ecx']
mov ['edx,', '[ebp+var_20]']
mov ['[ebp+var_38],', 'edx']
mov ['eax,', '[ebp+var_38]']
mov ['[ebp+apt.x],', 'eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+arg_4]']
lea ['eax,', '[edx+ecx-1]']
mov ['[ebp+var_28],', 'eax']
mov ['ecx,', '[ebp+var_28]']
mov ['[ebp+var_30],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+var_1C],', 'edx']
mov ['eax,', '[ebp+var_1C]']
mov ['[ebp+var_24],', 'eax']
mov ['ecx,', '[ebp+var_24]']
mov ['[ebp+apt.y],', 'ecx']
mov ['edx,', 'ds:_font_height']
mov ['eax,', '[ebp+arg_8]']
lea ['ecx,', '[eax+edx-1]']
mov ['[ebp+var_2C],', 'ecx']
mov ['edx,', '[ebp+var_2C]']
mov ['[ebp+var_34],', 'edx']
mov ['esi,', 'esp']
mov ['eax,', 'ds:dword_1544']
push ['eax']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__CreatePen@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+h],', 'eax']
mov ['esi,', 'esp']
push ['5']
lea ['edx,', '[ebp+apt]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__Polyline@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+h]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+h],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+h]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_BF55']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '60000000h']
jz ['loc_BF55']
cmp ['[ebp+var_14],', '0']
jz ['loc_BF55']
cmp ['[ebp+var_14],', '1']
jnz ['short', 'loc_BDFD']
mov ['edx,', '[ebp+arg_4]']
mov ['[ebp+x],', 'edx']
mov ['eax,', '[ebp+arg_8]']
add ['eax,', 'ds:_descent']
mov ['[ebp+y],', 'eax']
mov ['[ebp+var_54],', '1']
mov ['[ebp+var_58],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_5C],', 'ecx']
jmp ['short', 'loc_BE3D']
mov ['[ebp+var_64],', '0']
mov ['edx,', '[ebp+arg_14]']
and ['edx,', '10000000h']
jz ['short', 'loc_BE18']
mov ['eax,', '[ebp+var_C]']
sub ['eax,', '1']
mov ['[ebp+var_64],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '[ebp+var_64]']
mov ['[ebp+x],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+y],', 'edx']
mov ['[ebp+var_54],', '0']
mov ['[ebp+var_58],', '1']
mov ['eax,', 'ds:_font_height']
mov ['[ebp+var_5C],', 'eax']
mov ['ecx,', '[ebp+arg_14]']
and ['ecx,', '40000000h']
jz ['loc_BEF2']
mov ['esi,', 'esp']
mov ['edx,', 'ds:dword_1544']
push ['edx']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__CreatePen@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['eax']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+ho],', 'eax']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+y]']
push ['ecx']
mov ['edx,', '[ebp+x]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__MoveToEx@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_58]']
imul ['ecx,', '[ebp+var_5C]']
add ['ecx,', '[ebp+y]']
mov ['esi,', 'esp']
push ['ecx']
mov ['edx,', '[ebp+var_54]']
imul ['edx,', '[ebp+var_5C]']
add ['edx,', '[ebp+x]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__LineTo@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+ho]']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+ho],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+ho]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DeleteObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_BF55']
mov ['[ebp+var_60],', '0']
jmp ['short', 'loc_BF04']
mov ['ecx,', '[ebp+var_60]']
add ['ecx,', '1']
mov ['[ebp+var_60],', 'ecx']
mov ['edx,', '[ebp+var_60]']
cmp ['edx,', '[ebp+var_5C]']
jge ['short', 'loc_BF55']
mov ['eax,', '[ebp+var_60]']
and ['eax,', '80000001h']
jns ['short', 'loc_BF1B']
dec ['eax']
or ['eax,', '0FFFFFFFEh']
inc ['eax']
test ['eax,', 'eax']
jnz ['short', 'loc_BF41']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:dword_1544']
push ['ecx']
mov ['edx,', '[ebp+y]']
push ['edx']
mov ['eax,', '[ebp+x]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetPixel@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+x]']
add ['edx,', '[ebp+var_54]']
mov ['[ebp+x],', 'edx']
mov ['eax,', '[ebp+y]']
add ['eax,', '[ebp+var_58]']
mov ['[ebp+y],', 'eax']
jmp ['short', 'loc_BEFB']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN22']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '68h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_char_width     proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+Buffer],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+hdc],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+hdc],', 'eax']
mov ['[ebp+Buffer],', '0']
cmp ['ds:_font_dualwidth,', '0']
jnz ['short', 'loc_BFD3']
mov ['eax,', '1']
jmp ['loc_C210']
mov ['ecx,', '[ebp+iFirst]']
and ['ecx,', '0FFFFFF00h']
mov ['[ebp+var_14],', 'ecx']
cmp ['[ebp+var_14],', '0D800h']
jz ['short', 'loc_BFFC']
cmp ['[ebp+var_14],', '0D900h']
jz ['short', 'loc_C012']
cmp ['[ebp+var_14],', '0DA00h']
jz ['short', 'loc_C028']
jmp ['short', 'loc_C03B']
mov ['edx,', '[ebp+iFirst]']
and ['edx,', '0FFh']
movzx ['eax,', 'ds:word_7D0[edx*2]']
mov ['[ebp+iFirst],', 'eax']
jmp ['short', 'loc_C03B']
mov ['ecx,', '[ebp+iFirst]']
and ['ecx,', '0FFh']
movzx ['edx,', 'ds:word_BD0[ecx*2]']
mov ['[ebp+iFirst],', 'edx']
jmp ['short', 'loc_C03B']
mov ['eax,', '[ebp+iFirst]']
and ['eax,', '0FFh']
movzx ['ecx,', 'ds:word_5D0[eax*2]']
mov ['[ebp+iFirst],', 'ecx']
mov ['edx,', '[ebp+iFirst]']
and ['edx,', '0FFFFFE00h']
cmp ['edx,', '0F000h']
jnz ['loc_C16C']
cmp ['ds:dword_5C4,', '0']
jz ['short', 'loc_C063']
mov ['eax,', '1']
jmp ['loc_C210']
mov ['eax,', '[ebp+iFirst]']
and ['eax,', '0FFh']
cmp ['eax,', '20h']
jb ['short', 'loc_C088']
mov ['ecx,', '[ebp+iFirst]']
and ['ecx,', '0FFh']
cmp ['ecx,', '7Eh']
ja ['short', 'loc_C088']
mov ['eax,', '1']
jmp ['loc_C210']
mov ['edx,', '[ebp+iFirst]']
and ['edx,', '0FFFFFF00h']
cmp ['edx,', '0F100h']
jnz ['short', 'loc_C0B4']
mov ['esi,', 'esp']
mov ['eax,', 'ds:_fonts']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_C101']
mov ['edx,', '[ebp+iFirst]']
and ['edx,', '0FFFFFF00h']
cmp ['edx,', '0F000h']
jnz ['short', 'loc_C0FA']
push ['20h']
call ['_another_font']
add ['esp,', '4']
cmp ['ds:h,', '0']
jnz ['short', 'loc_C0DF']
xor ['eax,', 'eax']
jmp ['loc_C210']
mov ['esi,', 'esp']
mov ['eax,', 'ds:h']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_C101']
xor ['eax,', 'eax']
jmp ['loc_C210']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+Buffer]']
push ['edx']
mov ['eax,', '[ebp+iFirst]']
and ['eax,', '0FFh']
push ['eax']
mov ['ecx,', '[ebp+iFirst]']
and ['ecx,', '0FFh']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetCharWidth32A@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '1']
jz ['short', 'loc_C167']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Buffer]']
push ['eax']
mov ['ecx,', '[ebp+iFirst]']
and ['ecx,', '0FFh']
push ['ecx']
mov ['edx,', '[ebp+iFirst]']
and ['edx,', '0FFh']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetCharWidthA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '1']
jz ['short', 'loc_C167']
xor ['eax,', 'eax']
jmp ['loc_C210']
jmp ['loc_C1EC']
cmp ['[ebp+iFirst],', '20h']
jl ['short', 'loc_C182']
cmp ['[ebp+iFirst],', '7Eh']
jg ['short', 'loc_C182']
mov ['eax,', '1']
jmp ['loc_C210']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:_fonts']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectObject@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Buffer]']
push ['eax']
mov ['ecx,', '[ebp+iFirst]']
push ['ecx']
mov ['edx,', '[ebp+iFirst]']
push ['edx']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetCharWidth32W@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '1']
jnz ['short', 'loc_C1C2']
jmp ['short', 'loc_C1EC']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+Buffer]']
push ['ecx']
mov ['edx,', '[ebp+iFirst]']
push ['edx']
mov ['eax,', '[ebp+iFirst]']
push ['eax']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetCharWidthW@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '1']
jnz ['short', 'loc_C1E8']
jmp ['short', 'loc_C1EC']
xor ['eax,', 'eax']
jmp ['short', 'loc_C210']
mov ['eax,', 'ds:_font_width']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['edx,', '[ebp+Buffer]']
lea ['eax,', '[edx+eax-1]']
mov ['[ebp+Buffer],', 'eax']
mov ['eax,', '[ebp+Buffer]']
cdq
idiv ['ds:_font_width']
mov ['[ebp+Buffer],', 'eax']
mov ['eax,', '[ebp+Buffer]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN26']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_init_winfuncs  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+hModule],', '0CCCCCCCCh']
push ['offset', '$SG90683']
call ['_load_system32_dll']
add ['esp,', '4']
mov ['[ebp+hModule],', 'eax']
cmp ['[ebp+hModule],', '0']
jz ['short', 'loc_C2A7']
mov ['esi,', 'esp']
push ['offset', '$SG90686']
mov ['eax,', '[ebp+hModule]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
jmp ['short', 'loc_C2AE']
mov ['[ebp+var_8],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['ds:_p_FlashWindowEx,', 'ecx']
cmp ['[ebp+hModule],', '0']
jz ['short', 'loc_C2DA']
mov ['esi,', 'esp']
push ['offset', '$SG90689']
mov ['edx,', '[ebp+hModule]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_C2E1']
mov ['[ebp+var_C],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['ds:_p_ToUnicodeEx,', 'eax']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_TranslateKey   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20Ch']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_20C]']
mov ['ecx,', '83h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_114],', '0']
mov ['eax,', '[ebp+arg_C]']
mov ['[ebp+Dest],', 'eax']
push ['3Fh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_130],', 'eax']
push ['41h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_134],', 'eax']
push ['59h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_138],', 'eax']
push ['4Bh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_13C],', 'eax']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__GetKeyboardLayout@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwhkl],', 'eax']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+KeyState]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetKeyboardState@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+cbMultiByte],', 'eax']
cmp ['[ebp+cbMultiByte],', '0']
jnz ['short', 'loc_C3E4']
push ['100h']
push ['0']
lea ['eax,', '[ebp+KeyState]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
jmp ['loc_C489']
cmp ['[ebp+uVirtKey],', '12h']
jnz ['short', 'loc_C40A']
mov ['ecx,', '[ebp+arg_8]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
and ['edx,', '100h']
jz ['short', 'loc_C40A']
mov ['al,', '[ebp+var_F6]']
mov ['[ebp+var_63],', 'al']
cmp ['[ebp+var_130],', '3']
jz ['short', 'loc_C434']
cmp ['[ebp+var_130],', '1']
jg ['short', 'loc_C473']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[ecx+144h],', '0']
jz ['short', 'loc_C473']
cmp ['[ebp+var_134],', '0']
jnz ['short', 'loc_C473']
cmp ['[ebp+uVirtKey],', '90h']
jnz ['short', 'loc_C473']
movzx ['edx,', '[ebp+var_F8]']
and ['edx,', '80h']
jnz ['short', 'loc_C473']
mov ['[ebp+uVirtKey],', '2Bh']
mov ['eax,', '[ebp+arg_8]']
shr ['eax,', '10h']
and ['eax,', '0FFFFh']
movzx ['ecx,', 'ax']
and ['ecx,', '0C000h']
jnz ['short', 'loc_C473']
movzx ['edx,', '[ebp+var_78]']
xor ['edx,', '1']
mov ['[ebp+var_78],', 'dl']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+KeyState]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetKeyboardState@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[ecx+14Ch],', '0']
jz ['short', 'loc_C4BA']
mov ['edx,', '[ebp+arg_8]']
shr ['edx,', '10h']
and ['edx,', '0FFFFh']
movzx ['eax,', 'dx']
and ['eax,', '0C000h']
cmp ['eax,', '4000h']
jnz ['short', 'loc_C4BA']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
mov ['ecx,', '[ebp+arg_8]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
and ['edx,', '2000h']
jz ['short', 'loc_C4E6']
movzx ['eax,', '[ebp+var_63]']
and ['eax,', '80h']
jnz ['short', 'loc_C4E6']
mov ['[ebp+var_114],', '1']
mov ['ecx,', '[ebp+arg_8]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
and ['edx,', '8000h']
neg ['edx']
sbb ['edx,', 'edx']
add ['edx,', '1']
mov ['[ebp+var_118],', 'edx']
cmp ['[ebp+var_114],', '0']
jz ['short', 'loc_C53F']
movzx ['eax,', '[ebp+var_F7]']
and ['eax,', '80h']
jz ['short', 'loc_C53F']
cmp ['[ebp+var_138],', '0']
jz ['short', 'loc_C531']
mov ['[ebp+var_F6],', '0']
jmp ['short', 'loc_C53F']
mov ['[ebp+var_63],', '80h']
mov ['[ebp+var_114],', '0']
mov ['ecx,', '[ebp+arg_8]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
and ['edx,', '81FFh']
mov ['[ebp+uScanCode],', 'edx']
movzx ['eax,', '[ebp+var_F8]']
and ['eax,', '80h']
neg ['eax']
sbb ['eax,', 'eax']
neg ['eax']
movzx ['ecx,', '[ebp+var_F7]']
and ['ecx,', '80h']
neg ['ecx']
sbb ['ecx,', 'ecx']
neg ['ecx']
lea ['edx,', '[eax+ecx*2]']
mov ['[ebp+var_11C],', 'edx']
cmp ['ds:_compose_state,', '0']
jnz ['short', 'loc_C5E3']
mov ['ds:?compose_keycode@?1??TranslateKey@@9@9,', '100h']
push ['58h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_C5D4']
cmp ['[ebp+uVirtKey],', '12h']
jnz ['short', 'loc_C5D4']
mov ['ecx,', '[ebp+arg_8]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
and ['edx,', '100h']
jz ['short', 'loc_C5D4']
mov ['eax,', '[ebp+uVirtKey]']
mov ['ds:?compose_keycode@?1??TranslateKey@@9@9,', 'eax']
cmp ['[ebp+uVirtKey],', '5Dh']
jnz ['short', 'loc_C5E3']
mov ['ecx,', '[ebp+uVirtKey]']
mov ['ds:?compose_keycode@?1??TranslateKey@@9@9,', 'ecx']
mov ['edx,', '[ebp+uVirtKey]']
cmp ['edx,', 'ds:?compose_keycode@?1??TranslateKey@@9@9']
jnz ['short', 'loc_C650']
cmp ['ds:_compose_state,', '0']
jnz ['short', 'loc_C619']
mov ['eax,', '[ebp+arg_8]']
shr ['eax,', '10h']
and ['eax,', '0FFFFh']
movzx ['ecx,', 'ax']
and ['ecx,', '0C000h']
jnz ['short', 'loc_C619']
mov ['ds:_compose_state,', '1']
jmp ['short', 'loc_C64E']
cmp ['ds:_compose_state,', '1']
jnz ['short', 'loc_C644']
mov ['edx,', '[ebp+arg_8]']
shr ['edx,', '10h']
and ['edx,', '0FFFFh']
movzx ['eax,', 'dx']
and ['eax,', '8000h']
jz ['short', 'loc_C644']
mov ['ds:_compose_state,', '2']
jmp ['short', 'loc_C64E']
mov ['ds:_compose_state,', '0']
jmp ['short', 'loc_C669']
cmp ['ds:_compose_state,', '1']
jnz ['short', 'loc_C669']
cmp ['[ebp+uVirtKey],', '11h']
jz ['short', 'loc_C669']
mov ['ds:_compose_state,', '0']
cmp ['ds:_compose_state,', '1']
jle ['short', 'loc_C685']
cmp ['[ebp+var_114],', '0']
jz ['short', 'loc_C685']
mov ['ds:_compose_state,', '0']
cmp ['[ebp+var_114],', '0']
jnz ['short', 'loc_C6CE']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[ecx+144h],', '0']
jz ['short', 'loc_C6AF']
cmp ['[ebp+var_134],', '0']
jnz ['short', 'loc_C6AF']
cmp ['[ebp+var_130],', '2']
jnz ['short', 'loc_C6CE']
cmp ['[ebp+var_130],', '3']
jz ['short', 'loc_C6CE']
cmp ['[ebp+var_13C],', '0']
jnz ['short', 'loc_C6CE']
cmp ['ds:_compose_state,', '0']
jz ['loc_C7D7']
mov ['edx,', '[ebp+arg_8]']
shr ['edx,', '10h']
and ['edx,', '0FFFFh']
movzx ['eax,', 'dx']
and ['eax,', '100h']
jnz ['loc_C7D7']
mov ['[ebp+var_144],', '0']
mov ['ecx,', '[ebp+uVirtKey]']
mov ['[ebp+var_1EC],', 'ecx']
mov ['edx,', '[ebp+var_1EC]']
sub ['edx,', '0Ch']
mov ['[ebp+var_1EC],', 'edx']
cmp ['[ebp+var_1EC],', '22h']
ja ['$LN209']
mov ['eax,', '[ebp+var_1EC]']
movzx ['ecx,', 'ds:$LN242_0[eax]']
jmp ['ds:$LN257[ecx*4]']
mov ['[ebp+var_144],', '60h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '61h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '62h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '63h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '64h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '65h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '66h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '67h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '68h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '69h']
jmp ['short', '$LN209']
mov ['[ebp+var_144],', '6Eh']
cmp ['[ebp+var_144],', '0']
jz ['short', 'loc_C7D7']
movzx ['edx,', '[ebp+var_78]']
and ['edx,', '1']
jz ['short', 'loc_C7CE']
mov ['eax,', '[ebp+var_11C]']
or ['eax,', '1']
mov ['[ebp+var_11C],', 'eax']
mov ['ecx,', '[ebp+var_144]']
mov ['[ebp+uVirtKey],', 'ecx']
cmp ['[ebp+var_118],', '0']
jz ['loc_DBC4']
movzx ['edx,', '[ebp+var_63]']
and ['edx,', '80h']
jnz ['loc_DBC4']
cmp ['ds:_compose_state,', '0']
jnz ['loc_DBC4']
cmp ['[ebp+var_114],', '0']
jz ['short', 'loc_C822']
mov ['eax,', '[ebp+Dest]']
mov ['byte', 'ptr', '[eax],', '1Bh']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
cmp ['[ebp+uVirtKey],', '21h']
jnz ['short', 'loc_C857']
cmp ['[ebp+var_11C],', '1']
jnz ['short', 'loc_C857']
mov ['esi,', 'esp']
push ['0']
push ['2']
push ['115h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '21h']
jnz ['short', 'loc_C88B']
cmp ['[ebp+var_11C],', '2']
jnz ['short', 'loc_C88B']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['115h']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '22h']
jnz ['short', 'loc_C8C0']
cmp ['[ebp+var_11C],', '1']
jnz ['short', 'loc_C8C0']
mov ['esi,', 'esp']
push ['0']
push ['3']
push ['115h']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '22h']
jnz ['short', 'loc_C8F5']
cmp ['[ebp+var_11C],', '2']
jnz ['short', 'loc_C8F5']
mov ['esi,', 'esp']
push ['0']
push ['1']
push ['115h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '21h']
jz ['short', 'loc_C901']
cmp ['[ebp+uVirtKey],', '22h']
jnz ['short', 'loc_C92A']
cmp ['[ebp+var_11C],', '3']
jnz ['short', 'loc_C92A']
xor ['eax,', 'eax']
cmp ['[ebp+uVirtKey],', '21h']
setnz ['al']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_scroll_to_selection']
add ['esp,', '8']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '2Dh']
jnz ['short', 'loc_C94A']
cmp ['[ebp+var_11C],', '1']
jnz ['short', 'loc_C94A']
push ['0']
call ['_request_paste']
add ['esp,', '4']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
cmp ['[ebp+var_114],', '0']
jz ['short', 'loc_C976']
cmp ['[ebp+uVirtKey],', '73h']
jnz ['short', 'loc_C976']
push ['4Eh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_C976']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_E0F5']
cmp ['[ebp+var_114],', '0']
jz ['short', 'loc_C9C3']
cmp ['[ebp+uVirtKey],', '20h']
jnz ['short', 'loc_C9C3']
push ['4Fh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_C9C3']
mov ['esi,', 'esp']
push ['0']
push ['0F100h']
push ['112h']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_E0F5']
cmp ['[ebp+var_114],', '0']
jz ['short', 'loc_CA26']
cmp ['[ebp+uVirtKey],', '0Dh']
jnz ['short', 'loc_CA26']
push ['54h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_CA26']
push ['6Ah']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '1']
jz ['short', 'loc_CA26']
mov ['ecx,', '[ebp+arg_8]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
and ['edx,', '0C000h']
cmp ['edx,', '4000h']
jz ['short', 'loc_CA1E']
call ['_flip_full_screen']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '13h']
jnz ['short', 'loc_CA56']
cmp ['[ebp+var_11C],', '2']
jnz ['short', 'loc_CA56']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', '[eax+144h]']
xor ['ecx,', '1']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['[edx+144h],', 'ecx']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
cmp ['[ebp+var_13C],', '0']
jz ['loc_CC77']
cmp ['[ebp+var_114],', '0']
jnz ['loc_CC77']
mov ['eax,', '[ebp+uVirtKey]']
mov ['[ebp+var_1F0],', 'eax']
mov ['ecx,', '[ebp+var_1F0]']
sub ['ecx,', '61h']
mov ['[ebp+var_1F0],', 'ecx']
cmp ['[ebp+var_1F0],', '8']
ja ['loc_CC77']
mov ['edx,', '[ebp+var_1F0]']
jmp ['ds:$LN258[edx*4]']
mov ['eax,', '[ebp+var_11C]']
and ['eax,', '3']
mov ['ecx,', '[ebp+Dest]']
mov ['dl,', '$SG90809[eax]']
mov ['[ecx],', 'dl']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['ecx,', '[ebp+var_11C]']
and ['ecx,', '3']
mov ['edx,', '[ebp+Dest]']
mov ['al,', '$SG90811[ecx]']
mov ['[edx],', 'al']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['edx,', '[ebp+var_11C]']
and ['edx,', '3']
mov ['eax,', '[ebp+Dest]']
mov ['cl,', '$SG90813[edx]']
mov ['[eax],', 'cl']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '1']
mov ['[ebp+Dest],', 'edx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['eax,', '[ebp+var_11C]']
and ['eax,', '3']
mov ['ecx,', '[ebp+Dest]']
mov ['dl,', '$SG90815[eax]']
mov ['[ecx],', 'dl']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['ecx,', '[ebp+var_11C]']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '0']
add ['ecx,', '2Eh']
mov ['edx,', '[ebp+Dest]']
mov ['[edx],', 'cl']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['ecx,', '[ebp+var_11C]']
and ['ecx,', '3']
mov ['edx,', '[ebp+Dest]']
mov ['al,', '$SG90818[ecx]']
mov ['[edx],', 'al']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['edx,', '[ebp+var_11C]']
and ['edx,', '3']
mov ['eax,', '[ebp+Dest]']
mov ['cl,', '$SG90820[edx]']
mov ['[eax],', 'cl']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '1']
mov ['[ebp+Dest],', 'edx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['eax,', '[ebp+var_11C]']
and ['eax,', '3']
mov ['ecx,', '[ebp+Dest]']
mov ['dl,', '$SG90822[eax]']
mov ['[ecx],', 'dl']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['ecx,', '[ebp+var_11C]']
and ['ecx,', '3']
mov ['edx,', '[ebp+Dest]']
mov ['al,', '$SG90824[ecx]']
mov ['[edx],', 'al']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_114],', '0']
jnz ['loc_CF78']
mov ['[ebp+var_148],', '0']
cmp ['[ebp+var_130],', '3']
jz ['short', 'loc_CCB8']
cmp ['[ebp+var_130],', '1']
jg ['short', '$LN168_0']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[edx+144h],', '0']
jz ['short', '$LN168_0']
cmp ['[ebp+var_134],', '0']
jnz ['short', '$LN168_0']
mov ['eax,', '[ebp+uVirtKey]']
mov ['[ebp+var_1F4],', 'eax']
mov ['ecx,', '[ebp+var_1F4]']
sub ['ecx,', '2Bh']
mov ['[ebp+var_1F4],', 'ecx']
cmp ['[ebp+var_1F4],', '44h']
ja ['short', '$LN168_0']
mov ['edx,', '[ebp+var_1F4]']
movzx ['eax,', 'ds:$LN243_0[edx]']
jmp ['ds:$LN259[eax*4]']
mov ['[ebp+var_148],', '50h']
jmp ['short', '$LN168_0']
mov ['[ebp+var_148],', '51h']
jmp ['short', '$LN168_0']
mov ['[ebp+var_148],', '52h']
jmp ['short', '$LN168_0']
mov ['[ebp+var_148],', '53h']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[ecx+144h],', '0']
jz ['$LN160']
cmp ['[ebp+var_134],', '0']
jnz ['$LN160']
mov ['edx,', '[ebp+uVirtKey]']
mov ['[ebp+var_1F8],', 'edx']
mov ['eax,', '[ebp+var_1F8]']
sub ['eax,', '0Dh']
mov ['[ebp+var_1F8],', 'eax']
cmp ['[ebp+var_1F8],', '62h']
ja ['$LN160']
mov ['ecx,', '[ebp+var_1F8]']
movzx ['edx,', 'ds:$LN244[ecx]']
jmp ['ds:$LN260[edx*4]']
mov ['[ebp+var_148],', '70h']
jmp ['$LN160']
mov ['[ebp+var_148],', '71h']
jmp ['$LN160']
mov ['[ebp+var_148],', '72h']
jmp ['$LN160']
mov ['[ebp+var_148],', '73h']
jmp ['$LN160']
mov ['[ebp+var_148],', '74h']
jmp ['$LN160']
mov ['[ebp+var_148],', '75h']
jmp ['$LN160']
mov ['[ebp+var_148],', '76h']
jmp ['$LN160']
mov ['[ebp+var_148],', '77h']
jmp ['$LN160']
mov ['[ebp+var_148],', '78h']
jmp ['$LN160']
mov ['[ebp+var_148],', '79h']
jmp ['$LN160']
mov ['[ebp+var_148],', '6Eh']
jmp ['$LN160']
cmp ['[ebp+var_130],', '2']
jnz ['short', 'loc_CE43']
cmp ['[ebp+var_11C],', '0']
jz ['short', 'loc_CE37']
mov ['[ebp+var_148],', '6Ch']
jmp ['short', 'loc_CE41']
mov ['[ebp+var_148],', '6Bh']
jmp ['short', 'loc_CE62']
cmp ['[ebp+var_11C],', '0']
jz ['short', 'loc_CE58']
mov ['[ebp+var_148],', '6Dh']
jmp ['short', 'loc_CE62']
mov ['[ebp+var_148],', '6Ch']
jmp ['short', '$LN160']
cmp ['[ebp+var_130],', '2']
jnz ['short', 'loc_CE77']
mov ['[ebp+var_148],', '6Fh']
jmp ['short', '$LN160']
cmp ['[ebp+var_130],', '2']
jnz ['short', 'loc_CE8C']
mov ['[ebp+var_148],', '6Ah']
jmp ['short', '$LN160']
cmp ['[ebp+var_130],', '2']
jnz ['short', 'loc_CEA1']
mov ['[ebp+var_148],', '6Dh']
jmp ['short', '$LN160']
mov ['eax,', '[ebp+arg_8]']
shr ['eax,', '10h']
and ['eax,', '0FFFFh']
movzx ['ecx,', 'ax']
and ['ecx,', '100h']
jz ['short', '$LN160']
mov ['[ebp+var_148],', '4Dh']
cmp ['[ebp+var_148],', '0']
jz ['loc_CF78']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[edx+148h],', '0']
jz ['short', 'loc_CF43']
cmp ['[ebp+var_148],', '50h']
jl ['short', 'loc_CF1A']
cmp ['[ebp+var_148],', '53h']
jg ['short', 'loc_CF1A']
mov ['eax,', '[ebp+var_148]']
push ['eax']
push ['offset', '$SG90874']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
jmp ['short', 'loc_CF41']
mov ['edx,', '[ebp+var_148]']
push ['edx']
push ['offset', '$SG90877']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
jmp ['short', 'loc_CF6A']
mov ['ecx,', '[ebp+var_148]']
push ['ecx']
push ['offset', '$SG90880']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '8']
jnz ['short', 'loc_CFDA']
cmp ['[ebp+var_11C],', '0']
jnz ['short', 'loc_CFDA']
push ['3Dh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '77h']
add ['eax,', '8']
mov ['ecx,', '[ebp+Dest]']
mov ['[ecx],', 'al']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '1']
mov ['[ebp+Dest],', 'edx']
mov ['eax,', '[ebp+Dest]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['eax,', '0FFFFFFFEh']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '8']
jnz ['short', 'loc_D03D']
cmp ['[ebp+var_11C],', '1']
jnz ['short', 'loc_D03D']
push ['3Dh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '0FFFFFF89h']
add ['eax,', '7Fh']
mov ['ecx,', '[ebp+Dest]']
mov ['[ecx],', 'al']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '1']
mov ['[ebp+Dest],', 'edx']
mov ['eax,', '[ebp+Dest]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['eax,', '0FFFFFFFEh']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '9']
jnz ['short', 'loc_D0A2']
cmp ['[ebp+var_11C],', '1']
jnz ['short', 'loc_D0A2']
mov ['edx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[edx],', '1Bh']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['ecx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[ecx],', '5Bh']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '1']
mov ['[ebp+Dest],', 'edx']
mov ['eax,', '[ebp+Dest]']
mov ['byte', 'ptr', '[eax],', '5Ah']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '20h']
jnz ['short', 'loc_D0D7']
cmp ['[ebp+var_11C],', '2']
jnz ['short', 'loc_D0D7']
mov ['edx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '20h']
jnz ['short', 'loc_D10C']
cmp ['[ebp+var_11C],', '3']
jnz ['short', 'loc_D10C']
mov ['ecx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[ecx],', '0A0h']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '1']
mov ['[ebp+Dest],', 'edx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '3']
jnz ['short', 'loc_D14A']
cmp ['[ebp+var_11C],', '2']
jnz ['short', 'loc_D14A']
cmp ['ds:_back,', '0']
jz ['short', 'loc_D143']
mov ['esi,', 'esp']
push ['1']
mov ['eax,', 'ds:_backhandle']
push ['eax']
mov ['ecx,', 'ds:_back']
mov ['edx,', '[ecx+18h]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '13h']
jnz ['short', 'loc_D18A']
mov ['eax,', '[ebp+Dest]']
mov ['byte', 'ptr', '[eax],', '1Ah']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['edx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '0FFFFFFFEh']
jmp ['loc_E0F5']
cmp ['[ebp+var_11C],', '2']
jnz ['short', 'loc_D1CD']
cmp ['[ebp+uVirtKey],', '32h']
jb ['short', 'loc_D1CD']
cmp ['[ebp+uVirtKey],', '38h']
ja ['short', 'loc_D1CD']
mov ['ecx,', '[ebp+Dest]']
mov ['edx,', '[ebp+uVirtKey]']
mov ['al,', 'byte_1E4A[edx]']
mov ['[ecx],', 'al']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_11C],', '2']
jnz ['short', 'loc_D20E']
cmp ['[ebp+uVirtKey],', '0BDh']
jz ['short', 'loc_D1E8']
cmp ['[ebp+uVirtKey],', '0BFh']
jnz ['short', 'loc_D20E']
mov ['edx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[edx],', '1Fh']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_11C],', '2']
jnz ['short', 'loc_D24F']
cmp ['[ebp+uVirtKey],', '0DFh']
jz ['short', 'loc_D229']
cmp ['[ebp+uVirtKey],', '0DCh']
jnz ['short', 'loc_D24F']
mov ['ecx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[ecx],', '1Ch']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '1']
mov ['[ebp+Dest],', 'edx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_11C],', '3']
jnz ['short', 'loc_D287']
cmp ['[ebp+uVirtKey],', '0DEh']
jnz ['short', 'loc_D287']
mov ['eax,', '[ebp+Dest]']
mov ['byte', 'ptr', '[eax],', '1Eh']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_11C],', '0']
jnz ['short', 'loc_D2E3']
cmp ['[ebp+uVirtKey],', '0Dh']
jnz ['short', 'loc_D2E3']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[edx+150h],', '0']
jz ['short', 'loc_D2E3']
mov ['eax,', '[ebp+Dest]']
mov ['byte', 'ptr', '[eax],', '0Dh']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['edx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[edx],', '0Ah']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['[ebp+var_128],', '0']
mov ['ecx,', '[ebp+uVirtKey]']
mov ['[ebp+var_1FC],', 'ecx']
mov ['edx,', '[ebp+var_1FC]']
sub ['edx,', '70h']
mov ['[ebp+var_1FC],', 'edx']
cmp ['[ebp+var_1FC],', '13h']
ja ['loc_D4E3']
mov ['eax,', '[ebp+var_1FC]']
jmp ['ds:$LN261[eax*4]']
movzx ['ecx,', '[ebp+var_F8]']
and ['ecx,', '80h']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '0Ch']
add ['ecx,', '0Bh']
mov ['[ebp+var_128],', 'ecx']
jmp ['loc_D4E3']
movzx ['edx,', '[ebp+var_F8]']
and ['edx,', '80h']
neg ['edx']
sbb ['edx,', 'edx']
and ['edx,', '0Ch']
add ['edx,', '0Ch']
mov ['[ebp+var_128],', 'edx']
jmp ['loc_D4E3']
movzx ['eax,', '[ebp+var_F8]']
and ['eax,', '80h']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '0Ch']
add ['eax,', '0Dh']
mov ['[ebp+var_128],', 'eax']
jmp ['loc_D4E3']
movzx ['ecx,', '[ebp+var_F8]']
and ['ecx,', '80h']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '0Ch']
add ['ecx,', '0Eh']
mov ['[ebp+var_128],', 'ecx']
jmp ['loc_D4E3']
movzx ['edx,', '[ebp+var_F8]']
and ['edx,', '80h']
neg ['edx']
sbb ['edx,', 'edx']
and ['edx,', '0Dh']
add ['edx,', '0Fh']
mov ['[ebp+var_128],', 'edx']
jmp ['loc_D4E3']
movzx ['eax,', '[ebp+var_F8]']
and ['eax,', '80h']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '0Ch']
add ['eax,', '11h']
mov ['[ebp+var_128],', 'eax']
jmp ['loc_D4E3']
movzx ['ecx,', '[ebp+var_F8]']
and ['ecx,', '80h']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '0Dh']
add ['ecx,', '12h']
mov ['[ebp+var_128],', 'ecx']
jmp ['loc_D4E3']
movzx ['edx,', '[ebp+var_F8]']
and ['edx,', '80h']
neg ['edx']
sbb ['edx,', 'edx']
and ['edx,', '0Dh']
add ['edx,', '13h']
mov ['[ebp+var_128],', 'edx']
jmp ['loc_D4E3']
movzx ['eax,', '[ebp+var_F8]']
and ['eax,', '80h']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '0Dh']
add ['eax,', '14h']
mov ['[ebp+var_128],', 'eax']
jmp ['loc_D4E3']
movzx ['ecx,', '[ebp+var_F8]']
and ['ecx,', '80h']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '0Dh']
add ['ecx,', '15h']
mov ['[ebp+var_128],', 'ecx']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '17h']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '18h']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '19h']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '1Ah']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '1Ch']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '1Dh']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '1Fh']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '20h']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '21h']
jmp ['short', 'loc_D4E3']
mov ['[ebp+var_128],', '22h']
mov ['edx,', '[ebp+var_11C]']
and ['edx,', '2']
jnz ['short', '$LN89_0']
mov ['eax,', '[ebp+uVirtKey]']
mov ['[ebp+var_200],', 'eax']
mov ['ecx,', '[ebp+var_200]']
sub ['ecx,', '21h']
mov ['[ebp+var_200],', 'ecx']
cmp ['[ebp+var_200],', '0Dh']
ja ['short', '$LN89_0']
mov ['edx,', '[ebp+var_200]']
movzx ['eax,', 'ds:$LN245[edx]']
jmp ['ds:$LN262[eax*4]']
mov ['[ebp+var_128],', '1']
jmp ['short', '$LN89_0']
mov ['[ebp+var_128],', '2']
jmp ['short', '$LN89_0']
mov ['[ebp+var_128],', '3']
jmp ['short', '$LN89_0']
mov ['[ebp+var_128],', '4']
jmp ['short', '$LN89_0']
mov ['[ebp+var_128],', '5']
jmp ['short', '$LN89_0']
mov ['[ebp+var_128],', '6']
cmp ['[ebp+var_130],', '3']
jnz ['short', 'loc_D58E']
cmp ['[ebp+var_128],', '6']
jg ['short', 'loc_D58E']
mov ['ecx,', '[ebp+var_128]']
movsx ['edx,', '$SG90933[ecx]']
mov ['[ebp+var_128],', 'edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[eax+148h],', '0']
jz ['short', 'loc_D5EA']
cmp ['[ebp+var_128],', '0']
jle ['short', 'loc_D5EA']
cmp ['[ebp+var_128],', '6']
jg ['short', 'loc_D5EA']
mov ['ecx,', '[ebp+var_128]']
movsx ['edx,', '$SG90936[ecx]']
push ['edx']
push ['offset', '$SG90937']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_130],', '5']
jnz ['loc_D769']
cmp ['[ebp+var_128],', '0Bh']
jl ['loc_D769']
cmp ['[ebp+var_128],', '22h']
jg ['loc_D769']
mov ['ecx,', '0Ch']
mov ['esi,', 'offset', '$SG90940']
lea ['edi,', '[ebp+var_180]']
rep ['movsd']
movsb
mov ['[ebp+var_188],', '0']
mov ['ecx,', '[ebp+uVirtKey]']
mov ['[ebp+var_204],', 'ecx']
mov ['edx,', '[ebp+var_204]']
sub ['edx,', '70h']
mov ['[ebp+var_204],', 'edx']
cmp ['[ebp+var_204],', '0Bh']
ja ['loc_D6F1']
mov ['eax,', '[ebp+var_204]']
jmp ['ds:$LN263[eax*4]']
mov ['[ebp+var_188],', '0']
jmp ['loc_D6F1']
mov ['[ebp+var_188],', '1']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '2']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '3']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '4']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '5']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '6']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '7']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '8']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '9']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '0Ah']
jmp ['short', 'loc_D6F1']
mov ['[ebp+var_188],', '0Bh']
movzx ['ecx,', '[ebp+var_F8]']
and ['ecx,', '80h']
jz ['short', 'loc_D70F']
mov ['edx,', '[ebp+var_188]']
add ['edx,', '0Ch']
mov ['[ebp+var_188],', 'edx']
movzx ['eax,', '[ebp+var_F7]']
and ['eax,', '80h']
jz ['short', 'loc_D72C']
mov ['ecx,', '[ebp+var_188]']
add ['ecx,', '18h']
mov ['[ebp+var_188],', 'ecx']
mov ['edx,', '[ebp+var_188]']
movsx ['eax,', '[ebp+edx+var_180]']
push ['eax']
push ['offset', '$SG90961']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_130],', '5']
jnz ['loc_D815']
cmp ['[ebp+var_128],', '1']
jl ['loc_D815']
cmp ['[ebp+var_128],', '6']
jg ['loc_D815']
mov ['edx,', '$SG90964']
mov ['[ebp+var_194],', 'edx']
mov ['ax,', 'word_1ED8']
mov ['[ebp+var_190],', 'ax']
mov ['cl,', 'byte_1EDA']
mov ['[ebp+var_18E],', 'cl']
cmp ['[ebp+var_128],', '3']
jnz ['short', 'loc_D7D8']
mov ['edx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[edx],', '7Fh']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
jmp ['short', 'loc_D807']
mov ['ecx,', '[ebp+var_128]']
movsx ['edx,', '[ebp+ecx+var_195]']
push ['edx']
push ['offset', '$SG90968']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[ecx+148h],', '0']
jnz ['short', 'loc_D831']
cmp ['[ebp+var_130],', '4']
jnz ['loc_D904']
cmp ['[ebp+var_128],', '0Bh']
jl ['loc_D904']
cmp ['[ebp+var_128],', '18h']
jg ['loc_D904']
mov ['[ebp+var_19C],', '0']
cmp ['[ebp+var_128],', '0Fh']
jle ['short', 'loc_D86D']
mov ['edx,', '[ebp+var_19C]']
add ['edx,', '1']
mov ['[ebp+var_19C],', 'edx']
cmp ['[ebp+var_128],', '15h']
jle ['short', 'loc_D885']
mov ['eax,', '[ebp+var_19C]']
add ['eax,', '1']
mov ['[ebp+var_19C],', 'eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[ecx+148h],', '0']
jz ['short', 'loc_D8C6']
mov ['edx,', '[ebp+var_128]']
add ['edx,', '45h']
sub ['edx,', '[ebp+var_19C]']
push ['edx']
push ['offset', '$SG90976']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
jmp ['short', 'loc_D8F6']
mov ['ecx,', '[ebp+var_128]']
add ['ecx,', '45h']
sub ['ecx,', '[ebp+var_19C]']
push ['ecx']
push ['offset', '$SG90979']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_130],', '1']
jnz ['short', 'loc_D957']
cmp ['[ebp+var_128],', '0Bh']
jl ['short', 'loc_D957']
cmp ['[ebp+var_128],', '0Fh']
jg ['short', 'loc_D957']
mov ['eax,', '[ebp+var_128]']
add ['eax,', '36h']
push ['eax']
push ['offset', '$SG90982']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_130],', '2']
jnz ['loc_D9E9']
cmp ['[ebp+var_128],', '0Bh']
jl ['short', 'loc_D9E9']
cmp ['[ebp+var_128],', '0Eh']
jg ['short', 'loc_D9E9']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[edx+148h],', '0']
jz ['short', 'loc_D9B1']
mov ['eax,', '[ebp+var_128]']
add ['eax,', '45h']
push ['eax']
push ['offset', '$SG90986']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
jmp ['short', 'loc_D9DB']
mov ['edx,', '[ebp+var_128]']
add ['edx,', '45h']
push ['edx']
push ['offset', '$SG90989']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_128],', '1']
jz ['short', 'loc_D9FB']
cmp ['[ebp+var_128],', '4']
jnz ['short', 'loc_DA5F']
push ['3Eh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_DA5F']
cmp ['[ebp+var_128],', '1']
jnz ['short', 'loc_DA25']
mov ['[ebp+Format],', 'offset', '$SG90993']
jmp ['short', 'loc_DA2F']
mov ['[ebp+Format],', 'offset', '$SG90994']
mov ['edx,', '[ebp+Format]']
push ['edx']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '8']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+var_128],', '0']
jz ['short', 'loc_DA9D']
mov ['ecx,', '[ebp+var_128]']
push ['ecx']
push ['offset', '$SG90997']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
mov ['[ebp+var_19D],', '0']
mov ['eax,', '[ebp+uVirtKey]']
mov ['[ebp+var_20C],', 'eax']
mov ['ecx,', '[ebp+var_20C]']
sub ['ecx,', '0Ch']
mov ['[ebp+var_20C],', 'ecx']
cmp ['[ebp+var_20C],', '1Ch']
ja ['short', '$LN44']
mov ['edx,', '[ebp+var_20C]']
movzx ['eax,', 'ds:$LN246_0[edx]']
jmp ['ds:$LN264[eax*4]']
mov ['[ebp+var_19D],', '41h']
jmp ['short', '$LN44']
mov ['[ebp+var_19D],', '42h']
jmp ['short', '$LN44']
mov ['[ebp+var_19D],', '43h']
jmp ['short', '$LN44']
mov ['[ebp+var_19D],', '44h']
jmp ['short', '$LN44']
mov ['[ebp+var_19D],', '47h']
movsx ['ecx,', '[ebp+var_19D]']
test ['ecx,', 'ecx']
jz ['short', 'loc_DB4E']
mov ['edx,', '[ebp+var_11C]']
push ['edx']
movsx ['eax,', '[ebp+var_19D]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_format_arrow_key']
add ['esp,', '10h']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['loc_E0F5']
cmp ['[ebp+uVirtKey],', '0Dh']
jnz ['short', 'loc_DB8E']
mov ['eax,', '[ebp+Dest]']
mov ['byte', 'ptr', '[eax],', '0Dh']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
mov ['edx,', '[ebp+Dest]']
mov ['byte', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '1']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '0FFFFFFFEh']
jmp ['loc_E0F5']
cmp ['[ebp+var_114],', '0']
jz ['short', 'loc_DBBA']
cmp ['[ebp+uVirtKey],', '60h']
jb ['short', 'loc_DBBA']
cmp ['[ebp+uVirtKey],', '69h']
ja ['short', 'loc_DBBA']
mov ['ecx,', 'ds:?alt_sum@?1??TranslateKey@@9@9']
imul ['ecx,', '0Ah']
mov ['edx,', '[ebp+uVirtKey]']
lea ['eax,', '[ecx+edx-60h]']
mov ['ds:?alt_sum@?1??TranslateKey@@9@9,', 'eax']
jmp ['short', 'loc_DBC4']
mov ['ds:?alt_sum@?1??TranslateKey@@9@9,', '0']
mov ['[ebp+var_1A4],', '0']
movzx ['ecx,', '[ebp+var_F4]']
test ['ecx,', 'ecx']
jz ['short', 'loc_DC0A']
push ['8Fh']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_DC0A']
xor ['eax,', 'eax']
cmp ['[ebp+var_114],', '0']
setz ['al']
mov ['[ebp+var_1A4],', 'eax']
mov ['[ebp+var_F4],', '0']
cmp ['dword', 'ptr', 'ds:_osVersion+10h,', '2']
jnz ['short', 'loc_DC58']
cmp ['ds:_p_ToUnicodeEx,', '0']
jz ['short', 'loc_DC58']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+dwhkl]']
push ['ecx']
push ['0']
push ['3']
push ['offset', '?keys_unicode@?1??TranslateKey@@9@9']
lea ['edx,', '[ebp+KeyState]']
push ['edx']
mov ['eax,', '[ebp+uScanCode]']
push ['eax']
mov ['ecx,', '[ebp+uVirtKey]']
push ['ecx']
call ['ds:_p_ToUnicodeEx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+cbMultiByte],', 'eax']
jmp ['loc_DD00']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+dwhkl]']
push ['edx']
push ['0']
push ['offset', '?keys@?EC@??TranslateKey@@9@9']
lea ['eax,', '[ebp+KeyState]']
push ['eax']
mov ['ecx,', '[ebp+uScanCode]']
push ['ecx']
mov ['edx,', '[ebp+uVirtKey]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ToAsciiEx@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+cbMultiByte],', 'eax']
cmp ['[ebp+cbMultiByte],', '0']
jle ['short', 'loc_DD00']
mov ['[ebp+var_1A8],', '0']
jmp ['short', 'loc_DCB1']
mov ['eax,', '[ebp+var_1A8]']
add ['eax,', '1']
mov ['[ebp+var_1A8],', 'eax']
mov ['ecx,', '[ebp+var_1A8]']
cmp ['ecx,', '[ebp+cbMultiByte]']
jge ['short', 'loc_DCDA']
mov ['edx,', '[ebp+var_1A8]']
mov ['eax,', '[ebp+var_1A8]']
mov ['cl,', 'ds:?keys@?EC@??TranslateKey@@9@9[eax*2]']
mov ['ds:?keysb@?EC@??TranslateKey@@9@9[edx],', 'cl']
jmp ['short', 'loc_DCA2']
mov ['esi,', 'esp']
push ['3']
push ['offset', '?keys_unicode@?1??TranslateKey@@9@9']
mov ['edx,', '[ebp+cbMultiByte]']
push ['edx']
push ['offset', '?keysb@?EC@??TranslateKey@@9@9']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MultiByteToWideChar@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+cbMultiByte],', '0']
jle ['loc_E07B']
mov ['eax,', '[ebp+arg_C]']
mov ['[ebp+Dest],', 'eax']
mov ['[ebp+var_124],', '0']
jmp ['short', 'loc_DD31']
mov ['ecx,', '[ebp+var_124]']
add ['ecx,', '1']
mov ['[ebp+var_124],', 'ecx']
mov ['edx,', '[ebp+var_124]']
cmp ['edx,', '[ebp+cbMultiByte]']
jge ['loc_E067']
mov ['eax,', '[ebp+var_124]']
mov ['cx,', 'ds:?keys_unicode@?1??TranslateKey@@9@9[eax*2]']
mov ['[ebp+var_1BC],', 'cx']
cmp ['ds:_compose_state,', '2']
jnz ['short', 'loc_DD99']
movzx ['edx,', '[ebp+var_1BC]']
cmp ['edx,', '20h']
jl ['short', 'loc_DD99']
movzx ['eax,', '[ebp+var_1BC]']
cmp ['eax,', '80h']
jge ['short', 'loc_DD99']
movzx ['ecx,', '[ebp+var_1BC]']
mov ['ds:?compose_char@?1??TranslateKey@@9@9,', 'ecx']
mov ['edx,', 'ds:_compose_state']
add ['edx,', '1']
mov ['ds:_compose_state,', 'edx']
jmp ['short', 'loc_DD22']
cmp ['ds:_compose_state,', '3']
jnz ['loc_DE55']
movzx ['eax,', '[ebp+var_1BC]']
cmp ['eax,', '20h']
jl ['loc_DE55']
movzx ['ecx,', '[ebp+var_1BC]']
cmp ['ecx,', '80h']
jge ['loc_DE55']
mov ['ds:_compose_state,', '0']
movzx ['edx,', '[ebp+var_1BC]']
push ['edx']
mov ['eax,', 'ds:?compose_char@?1??TranslateKey@@9@9']
push ['eax']
call ['_check_compose']
add ['esp,', '8']
mov ['[ebp+var_1C4],', 'eax']
cmp ['[ebp+var_1C4],', '0FFFFFFFFh']
jnz ['short', 'loc_DE10']
mov ['esi,', 'esp']
push ['10h']
call ['dword', 'ptr', 'ds:__imp__MessageBeep@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_E0F5']
mov ['cx,', 'word', 'ptr', '[ebp+var_1C4]']
mov ['[ebp+var_1B0],', 'cx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_DE50']
push ['1']
push ['1']
lea ['eax,', '[ebp+var_1B0]']
push ['eax']
mov ['ecx,', 'ds:_ldisc']
push ['ecx']
call ['_luni_send']
add ['esp,', '10h']
jmp ['loc_DD22']
mov ['ds:_compose_state,', '0']
cmp ['[ebp+var_118],', '0']
jnz ['loc_DF64']
cmp ['ds:?alt_sum@?1??TranslateKey@@9@9,', '0']
jz ['loc_DF2E']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[edx+0DCh],', '0']
jnz ['short', 'loc_DEA5']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
mov ['ecx,', '[eax+1090h]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0FDE9h']
jz ['short', 'loc_DEA5']
cmp ['ds:dword_5C4,', '0']
jz ['short', 'loc_DEE6']
mov ['dx,', 'word', 'ptr', 'ds:?alt_sum@?1??TranslateKey@@9@9']
mov ['[ebp+var_1B0],', 'dx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_DEE4']
push ['1']
push ['1']
lea ['ecx,', '[ebp+var_1B0]']
push ['ecx']
mov ['edx,', 'ds:_ldisc']
push ['edx']
call ['_luni_send']
add ['esp,', '10h']
jmp ['short', 'loc_DF22']
mov ['al,', 'byte', 'ptr', 'ds:?alt_sum@?1??TranslateKey@@9@9']
mov ['[ebp+var_1C9],', 'al']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_DF22']
push ['1']
push ['1']
lea ['edx,', '[ebp+var_1C9]']
push ['edx']
mov ['eax,', 'ds:_ldisc']
push ['eax']
call ['_ldisc_send']
add ['esp,', '10h']
mov ['ds:?alt_sum@?1??TranslateKey@@9@9,', '0']
jmp ['short', 'loc_DF5F']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_DF5F']
push ['1']
push ['1']
lea ['edx,', '[ebp+var_1BC]']
push ['edx']
mov ['eax,', 'ds:_ldisc']
push ['eax']
call ['_luni_send']
add ['esp,', '10h']
jmp ['loc_E058']
cmp ['[ebp+var_1A4],', '0']
jz ['loc_DFF2']
movzx ['ecx,', '[ebp+var_1BC]']
cmp ['ecx,', '80h']
jge ['short', 'loc_DFF2']
mov ['edx,', '1Bh']
mov ['[ebp+var_1D8],', 'dx']
movzx ['eax,', '[ebp+var_1BC]']
push ['eax']
call ['_xlat_uskbd2cyrllic']
add ['esp,', '4']
mov ['[ebp+var_1D6],', 'ax']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
push ['ecx']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_DFF0']
push ['1']
xor ['edx,', 'edx']
cmp ['[ebp+var_114],', '0']
setnz ['dl']
add ['edx,', '1']
push ['edx']
xor ['eax,', 'eax']
cmp ['[ebp+var_114],', '0']
setz ['al']
lea ['ecx,', '[ebp+eax*2+var_1D8]']
push ['ecx']
mov ['edx,', 'ds:_ldisc']
push ['edx']
call ['_luni_send']
add ['esp,', '10h']
jmp ['short', 'loc_E058']
mov ['eax,', '1Bh']
mov ['[ebp+var_1E4],', 'ax']
mov ['cx,', '[ebp+var_1BC]']
mov ['[ebp+var_1E2],', 'cx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_seen_key_event']
add ['esp,', '4']
cmp ['ds:_ldisc,', '0']
jz ['short', 'loc_E058']
push ['1']
xor ['eax,', 'eax']
cmp ['[ebp+var_114],', '0']
setnz ['al']
add ['eax,', '1']
push ['eax']
xor ['ecx,', 'ecx']
cmp ['[ebp+var_114],', '0']
setz ['cl']
lea ['edx,', '[ebp+ecx*2+var_1E4]']
push ['edx']
mov ['eax,', 'ds:_ldisc']
push ['eax']
call ['_luni_send']
add ['esp,', '10h']
push ['0']
call ['_show_mouseptr']
add ['esp,', '4']
jmp ['loc_DD22']
xor ['ecx,', 'ecx']
mov ['ds:?keys_unicode@?1??TranslateKey@@9@9,', 'cx']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_C]']
jmp ['short', 'loc_E0F5']
cmp ['[ebp+var_114],', '0']
jnz ['short', 'loc_E08F']
xor ['edx,', 'edx']
mov ['ds:?keys_unicode@?1??TranslateKey@@9@9,', 'dx']
jmp ['short', 'loc_E0D3']
movzx ['eax,', 'ds:?keys_unicode@?1??TranslateKey@@9@9']
test ['eax,', 'eax']
jz ['short', 'loc_E0D3']
mov ['ecx,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[ecx+0DCh],', '0']
jnz ['short', 'loc_E0C7']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
mov ['eax,', '[edx+1090h]']
cmp ['dword', 'ptr', '[eax+0Ch],', '0FDE9h']
jz ['short', 'loc_E0C7']
cmp ['ds:dword_5C4,', '0']
jz ['short', 'loc_E0D3']
mov ['ecx,', '0Ah']
mov ['ds:?keys_unicode@?1??TranslateKey@@9@9,', 'cx']
cmp ['[ebp+uVirtKey],', '12h']
jnz ['short', 'loc_E0F2']
push ['50h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_E0F2']
xor ['eax,', 'eax']
jmp ['short', 'loc_E0F5']
or ['eax,', '0FFFFFFFFh']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN256']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '20Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_set_title      proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['eax,', 'ds:_window_name']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['1']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '1']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ds:_window_name,', 'eax']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', 'ds:_window_name']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
push ['6Dh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_E49A']
mov ['esi,', 'esp']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__IsIconic@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_E4B4']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowTextA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_set_icon       proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['eax,', 'ds:_icon_name']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['1']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '1']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ds:_icon_name,', 'eax']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', 'ds:_icon_name']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
push ['6Dh']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_E554']
mov ['esi,', 'esp']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__IsIconic@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_E554']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowTextA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_set_sbar       proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
call ['_is_full_screen']
neg ['eax']
sbb ['eax,', 'eax']
neg ['eax']
add ['eax,', '68h']
push ['eax']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_E5AC']
jmp ['short', 'loc_E5FD']
mov ['[ebp+var_24.cbSize],', '1Ch']
mov ['[ebp+var_24.fMask],', '1Fh']
mov ['[ebp+var_24.nMin],', '0']
mov ['ecx,', '[ebp+arg_4]']
sub ['ecx,', '1']
mov ['[ebp+var_24.nMax],', 'ecx']
mov ['edx,', '[ebp+arg_C]']
mov ['[ebp+var_24.nPage],', 'edx']
mov ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_24.nPos],', 'eax']
cmp ['dword', 'ptr', 'ds:_hwnd,', '0']
jz ['short', 'loc_E5FD']
mov ['esi,', 'esp']
push ['1']
lea ['ecx,', '[ebp+var_24]']
push ['ecx']
push ['1']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetScrollInfo@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN7_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_get_ctx        proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+hdc],', '0CCCCCCCCh']
cmp ['dword', 'ptr', 'ds:_hwnd,', '0']
jz ['short', 'loc_E6A7']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetDC@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hdc],', 'eax']
cmp ['[ebp+hdc],', '0']
jz ['short', 'loc_E6A0']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_E6A0']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', 'ds:_pal']
push ['ecx']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SelectPalette@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+hdc]']
jmp ['short', 'loc_E6A9']
jmp ['short', 'loc_E6A9']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_free_ctx       proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
push ['edi']
mov ['esi,', 'esp']
push ['0']
mov ['edi,', 'esp']
push ['0Fh']
call ['dword', 'ptr', 'ds:__imp__GetStockObject@4']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SelectPalette@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ReleaseDC@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['edi']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_palette_set    proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+hdc],', '0CCCCCCCCh']
cmp ['[ebp+arg_4],', '10h']
jl ['short', 'loc_E735']
mov ['eax,', '[ebp+arg_4]']
add ['eax,', '0F0h']
mov ['[ebp+arg_4],', 'eax']
cmp ['[ebp+arg_4],', '106h']
jl ['short', 'loc_E743']
jmp ['loc_E7CB']
mov ['ecx,', '[ebp+arg_10]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_real_palette_set']
add ['esp,', '10h']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_E7A9']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_get_ctx']
add ['esp,', '4']
mov ['[ebp+hdc],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', 'ds:_pal']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__UnrealizeObject@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__RealizePalette@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+hdc]']
push ['edx']
call ['_free_ctx']
add ['esp,', '4']
jmp ['short', 'loc_E7CB']
cmp ['[ebp+arg_4],', '102h']
jnz ['short', 'loc_E7CB']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_real_palette_set proc near             
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
cmp ['ds:_pal,', '0']
jz ['loc_E886']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', 'ds:_logpal']
mov ['dl,', '[ebp+arg_4]']
mov ['[ecx+eax*4+4],', 'dl']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', 'ds:_logpal']
mov ['dl,', '[ebp+arg_8]']
mov ['[ecx+eax*4+5],', 'dl']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', 'ds:_logpal']
mov ['dl,', '[ebp+arg_C]']
mov ['[ecx+eax*4+6],', 'dl']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', 'ds:_logpal']
mov ['byte', 'ptr', '[ecx+eax*4+7],', '4']
movzx ['edx,', '[ebp+arg_4]']
movzx ['eax,', '[ebp+arg_8]']
shl ['eax,', '8']
or ['edx,', 'eax']
movzx ['ecx,', '[ebp+arg_C]']
shl ['ecx,', '10h']
or ['edx,', 'ecx']
or ['edx,', '2000000h']
mov ['eax,', '[ebp+arg_0]']
mov ['ds:_colours[eax*4],', 'edx']
mov ['ecx,', 'ds:_logpal']
add ['ecx,', '4']
mov ['esi,', 'esp']
push ['ecx']
push ['106h']
push ['0']
mov ['edx,', 'ds:_pal']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetPaletteEntries@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_E8A6']
movzx ['eax,', '[ebp+arg_4]']
movzx ['ecx,', '[ebp+arg_8]']
shl ['ecx,', '8']
or ['eax,', 'ecx']
movzx ['edx,', '[ebp+arg_C]']
shl ['edx,', '10h']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['ds:_colours[ecx*4],', 'eax']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_palette_reset  proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+hdc],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_E8DF']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '106h']
jge ['loc_E9D4']
cmp ['ds:_pal,', '0']
jz ['loc_E994']
mov ['ecx,', '[ebp+var_4]']
imul ['ecx,', '3']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', 'ds:_logpal']
mov ['cl,', 'ds:byte_282[ecx]']
mov ['[eax+edx*4+4],', 'cl']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '3']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', 'ds:_logpal']
mov ['dl,', 'ds:byte_281[edx]']
mov ['[ecx+eax*4+5],', 'dl']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', 'ds:_logpal']
mov ['al,', 'ds:_defpal[eax]']
mov ['[edx+ecx*4+6],', 'al']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', 'ds:_logpal']
mov ['byte', 'ptr', '[edx+ecx*4+7],', '0']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
movzx ['ecx,', 'ds:byte_282[eax]']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '3']
movzx ['eax,', 'ds:byte_281[edx]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '3']
movzx ['eax,', 'ds:_defpal[edx]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
or ['ecx,', '2000000h']
mov ['edx,', '[ebp+var_4]']
mov ['ds:_colours[edx*4],', 'ecx']
jmp ['short', 'loc_E9CF']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '3']
movzx ['ecx,', 'ds:byte_282[eax]']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '3']
movzx ['eax,', 'ds:byte_281[edx]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '3']
movzx ['eax,', 'ds:_defpal[edx]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['ds:_colours[edx*4],', 'ecx']
jmp ['loc_E8D6']
cmp ['ds:_pal,', '0']
jz ['short', 'loc_EA33']
mov ['eax,', 'ds:_logpal']
add ['eax,', '4']
mov ['esi,', 'esp']
push ['eax']
push ['106h']
push ['0']
mov ['ecx,', 'ds:_pal']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetPaletteEntries@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_get_ctx']
add ['esp,', '4']
mov ['[ebp+hdc],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hdc]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__RealizePalette@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+hdc]']
push ['ecx']
call ['_free_ctx']
add ['esp,', '4']
jmp ['short', 'loc_EA4D']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_write_aclip    proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+Dst],', '0CCCCCCCCh']
mov ['[ebp+hMem],', '0CCCCCCCCh']
mov ['eax,', '[ebp+Size]']
add ['eax,', '1']
mov ['esi,', 'esp']
push ['eax']
push ['2002h']
call ['dword', 'ptr', 'ds:__imp__GlobalAlloc@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hMem],', 'eax']
cmp ['[ebp+hMem],', '0']
jnz ['short', 'loc_EAA6']
jmp ['loc_EBA3']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hMem]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GlobalLock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+Dst],', 'eax']
cmp ['[ebp+Dst],', '0']
jnz ['short', 'loc_EAC7']
jmp ['loc_EBA3']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+Dst]']
add ['edx,', '[ebp+Size]']
mov ['byte', 'ptr', '[edx],', '0']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hMem]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GlobalUnlock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_EB1C']
mov ['esi,', 'esp']
push ['0']
push ['1']
push ['8002h']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__OpenClipboard@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_EB6B']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__EmptyClipboard@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hMem]']
push ['eax']
push ['1']
call ['dword', 'ptr', 'ds:__imp__SetClipboardData@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__CloseClipboard@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_EB7E']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hMem]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GlobalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_EBA3']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['8002h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_write_clip     proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '6DCh']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_6DC]']
mov ['ecx,', '1B7h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['0']
push ['0']
mov ['eax,', '[ebp+cchWideChar]']
push ['eax']
mov ['ecx,', '[ebp+lpWideCharStr]']
push ['ecx']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__WideCharToMultiByte@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwBytes],', 'eax']
mov ['edx,', '[ebp+cchWideChar]']
shl ['edx,', '1']
mov ['esi,', 'esp']
push ['edx']
push ['2002h']
call ['dword', 'ptr', 'ds:__imp__GlobalAlloc@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hMem],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+dwBytes]']
push ['eax']
push ['2002h']
call ['dword', 'ptr', 'ds:__imp__GlobalAlloc@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+hMem],', '0']
jz ['short', 'loc_EC49']
cmp ['[ebp+var_C],', '0']
jnz ['short', 'loc_EC80']
cmp ['[ebp+hMem],', '0']
jz ['short', 'loc_EC62']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hMem]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GlobalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_EC7B']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GlobalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_FD04']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hMem]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GlobalLock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+Dst],', 'eax']
cmp ['[ebp+Dst],', '0']
jnz ['short', 'loc_ECC7']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hMem]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GlobalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GlobalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_FD04']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GlobalLock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+lpMultiByteStr],', 'eax']
cmp ['[ebp+lpMultiByteStr],', '0']
jnz ['short', 'loc_ED21']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hMem]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GlobalUnlock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+hMem]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GlobalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GlobalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_FD04']
mov ['ecx,', '[ebp+cchWideChar]']
shl ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+lpWideCharStr]']
push ['edx']
mov ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['0']
push ['0']
mov ['ecx,', '[ebp+dwBytes]']
push ['ecx']
mov ['edx,', '[ebp+lpMultiByteStr]']
push ['edx']
mov ['eax,', '[ebp+cchWideChar]']
push ['eax']
mov ['ecx,', '[ebp+lpWideCharStr]']
push ['ecx']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__WideCharToMultiByte@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['88h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_FBD7']
mov ['[ebp+Dest],', '0']
mov ['eax,', '[ebp+lpMultiByteStr]']
mov ['[ebp+var_230],', 'eax']
mov ['ecx,', '[ebp+Dst]']
mov ['[ebp+var_234],', 'ecx']
mov ['[ebp+var_238],', '0']
mov ['[ebp+var_23C],', '0']
mov ['[ebp+var_240],', '0']
mov ['[ebp+var_244],', '0']
mov ['[ebp+var_284],', '0']
mov ['[ebp+var_28C],', '0']
mov ['[ebp+var_294],', '0']
mov ['[ebp+var_29C],', '0']
push ['70h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_get_fontspec']
add ['esp,', '8']
mov ['[ebp+var_6C4],', 'eax']
push ['0']
lea ['eax,', '[ebp+WideCharStr]']
push ['eax']
push ['0']
call ['_get_unitab']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_6C4]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '64h']
mov ['[ebp+var_244],', 'eax']
push ['1']
mov ['eax,', '[ebp+var_244]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Dest],', 'eax']
mov ['ecx,', '[ebp+var_6C4]']
mov ['edx,', '[ecx+8]']
shl ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+var_6C4]']
mov ['ecx,', '[eax]']
push ['ecx']
push ['offset', '$SG91248']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_sprintf']
add ['esp,', '10h']
mov ['[ebp+var_238],', 'eax']
cmp ['[ebp+arg_8],', '0']
jz ['loc_F175']
push ['418h']
push ['0']
lea ['eax,', '[ebp+var_6B8]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['[ebp+var_258],', '0']
jmp ['short', 'loc_EEAB']
mov ['ecx,', '[ebp+var_258]']
add ['ecx,', '1']
mov ['[ebp+var_258],', 'ecx']
mov ['edx,', '[ebp+cchWideChar]']
sub ['edx,', '1']
cmp ['[ebp+var_258],', 'edx']
jge ['loc_F002']
mov ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx+eax*4]']
and ['edx,', '1FFh']
mov ['[ebp+var_280],', 'edx']
mov ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx+eax*4]']
and ['edx,', '3FE00h']
shr ['edx,', '9']
mov ['[ebp+var_288],', 'edx']
mov ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx+eax*4]']
and ['edx,', '100000h']
jz ['short', 'loc_EF28']
mov ['eax,', '[ebp+var_280]']
mov ['[ebp+var_6C8],', 'eax']
mov ['ecx,', '[ebp+var_288]']
mov ['[ebp+var_280],', 'ecx']
mov ['edx,', '[ebp+var_6C8]']
mov ['[ebp+var_288],', 'edx']
cmp ['ds:_bold_colours,', '0']
jz ['short', 'loc_EF7A']
mov ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx+eax*4]']
and ['edx,', '40000h']
jz ['short', 'loc_EF7A']
cmp ['[ebp+var_280],', '8']
jge ['short', 'loc_EF5F']
mov ['eax,', '[ebp+var_280]']
add ['eax,', '8']
mov ['[ebp+var_280],', 'eax']
jmp ['short', 'loc_EF7A']
cmp ['[ebp+var_280],', '100h']
jl ['short', 'loc_EF7A']
mov ['ecx,', '[ebp+var_280]']
add ['ecx,', '1']
mov ['[ebp+var_280],', 'ecx']
mov ['edx,', '[ebp+var_258]']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax+edx*4]']
and ['ecx,', '200000h']
jz ['short', 'loc_EFC3']
cmp ['[ebp+var_288],', '8']
jge ['short', 'loc_EFA8']
mov ['edx,', '[ebp+var_288]']
add ['edx,', '8']
mov ['[ebp+var_288],', 'edx']
jmp ['short', 'loc_EFC3']
cmp ['[ebp+var_288],', '100h']
jl ['short', 'loc_EFC3']
mov ['eax,', '[ebp+var_288]']
add ['eax,', '1']
mov ['[ebp+var_288],', 'eax']
mov ['ecx,', '[ebp+var_280]']
mov ['edx,', '[ebp+ecx*4+var_6B8]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_280]']
mov ['[ebp+eax*4+var_6B8],', 'edx']
mov ['ecx,', '[ebp+var_288]']
mov ['edx,', '[ebp+ecx*4+var_6B8]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_288]']
mov ['[ebp+eax*4+var_6B8],', 'edx']
jmp ['loc_EE9C']
mov ['[ebp+var_6C0],', '0']
mov ['[ebp+var_258],', '0']
jmp ['short', 'loc_F027']
mov ['ecx,', '[ebp+var_258]']
add ['ecx,', '1']
mov ['[ebp+var_258],', 'ecx']
cmp ['[ebp+var_258],', '106h']
jge ['short', 'loc_F067']
mov ['edx,', '[ebp+var_258]']
cmp ['[ebp+edx*4+var_6B8],', '0']
jz ['short', 'loc_F065']
mov ['eax,', '[ebp+var_6C0]']
add ['eax,', '1']
mov ['[ebp+var_6C0],', 'eax']
mov ['ecx,', '[ebp+var_258]']
mov ['edx,', '[ebp+var_6C0]']
mov ['[ebp+ecx*4+var_6B8],', 'edx']
jmp ['short', 'loc_F018']
push ['1']
mov ['eax,', '[ebp+var_6C0]']
imul ['eax,', '19h']
add ['eax,', '[ebp+var_244]']
push ['eax']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+Dest],', 'eax']
push ['offset', '$SG91270']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_238],', 'eax']
mov ['[ebp+var_258],', '0']
jmp ['short', 'loc_F0D2']
mov ['ecx,', '[ebp+var_258]']
add ['ecx,', '1']
mov ['[ebp+var_258],', 'ecx']
cmp ['[ebp+var_258],', '106h']
jge ['short', 'loc_F14C']
mov ['edx,', '[ebp+var_258]']
cmp ['[ebp+edx*4+var_6B8],', '0']
jz ['short', 'loc_F147']
mov ['eax,', '[ebp+var_258]']
imul ['eax,', '3']
movzx ['ecx,', 'ds:_defpal[eax]']
push ['ecx']
mov ['edx,', '[ebp+var_258]']
imul ['edx,', '3']
movzx ['eax,', 'ds:byte_281[edx]']
push ['eax']
mov ['ecx,', '[ebp+var_258]']
imul ['ecx,', '3']
movzx ['edx,', 'ds:byte_282[ecx]']
push ['edx']
push ['offset', '$SG91275']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '[ebp+var_238]']
push ['eax']
call ['_sprintf']
add ['esp,', '14h']
add ['eax,', '[ebp+var_238]']
mov ['[ebp+var_238],', 'eax']
jmp ['loc_F0C3']
push ['offset', '$SG91276']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '[ebp+var_238]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
mov ['edx,', '[ebp+var_238]']
add ['edx,', '1']
mov ['[ebp+var_238],', 'edx']
mov ['eax,', '[ebp+var_240]']
cmp ['eax,', '[ebp+dwBytes]']
jge ['loc_FAFF']
mov ['ecx,', '[ebp+var_23C]']
cmp ['ecx,', '[ebp+cchWideChar]']
jge ['loc_FAFF']
mov ['edx,', '[ebp+var_230]']
add ['edx,', '[ebp+var_240]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['loc_FAFF']
mov ['ecx,', '[ebp+var_23C]']
mov ['edx,', '[ebp+var_234]']
movzx ['eax,', 'word', 'ptr', '[edx+ecx*2]']
test ['eax,', 'eax']
jz ['loc_FAFF']
mov ['ecx,', '[ebp+var_240]']
add ['ecx,', '1']
cmp ['ecx,', '[ebp+dwBytes]']
jge ['short', 'loc_F217']
mov ['edx,', '[ebp+var_230]']
add ['edx,', '[ebp+var_240]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '0Dh']
jnz ['short', 'loc_F217']
mov ['ecx,', '[ebp+var_230]']
add ['ecx,', '[ebp+var_240]']
movzx ['edx,', 'byte', 'ptr', '[ecx+1]']
cmp ['edx,', '0Ah']
jnz ['short', 'loc_F217']
mov ['eax,', '[ebp+var_240]']
add ['eax,', '1']
mov ['[ebp+var_240],', 'eax']
mov ['ecx,', '[ebp+var_23C]']
add ['ecx,', '1']
mov ['[ebp+var_23C],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jz ['loc_F5BA']
mov ['edx,', '[ebp+var_238]']
add ['edx,', '40h']
cmp ['[ebp+var_244],', 'edx']
jge ['short', 'loc_F261']
mov ['eax,', '[ebp+var_238]']
add ['eax,', '200h']
mov ['[ebp+var_244],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_244]']
push ['ecx']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+var_240]']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx+eax*4]']
and ['edx,', '1FFh']
mov ['[ebp+var_280],', 'edx']
mov ['eax,', '[ebp+var_240]']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx+eax*4]']
and ['edx,', '3FE00h']
shr ['edx,', '9']
mov ['[ebp+var_288],', 'edx']
mov ['eax,', '[ebp+var_240]']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx+eax*4]']
and ['edx,', '100000h']
jz ['short', 'loc_F2CC']
mov ['eax,', '[ebp+var_280]']
mov ['[ebp+var_6CC],', 'eax']
mov ['ecx,', '[ebp+var_288]']
mov ['[ebp+var_280],', 'ecx']
mov ['edx,', '[ebp+var_6CC]']
mov ['[ebp+var_288],', 'edx']
cmp ['ds:_bold_colours,', '0']
jz ['short', 'loc_F31E']
mov ['eax,', '[ebp+var_240]']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx+eax*4]']
and ['edx,', '40000h']
jz ['short', 'loc_F31E']
cmp ['[ebp+var_280],', '8']
jge ['short', 'loc_F303']
mov ['eax,', '[ebp+var_280]']
add ['eax,', '8']
mov ['[ebp+var_280],', 'eax']
jmp ['short', 'loc_F31E']
cmp ['[ebp+var_280],', '100h']
jl ['short', 'loc_F31E']
mov ['ecx,', '[ebp+var_280]']
add ['ecx,', '1']
mov ['[ebp+var_280],', 'ecx']
mov ['edx,', '[ebp+var_240]']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax+edx*4]']
and ['ecx,', '200000h']
jz ['short', 'loc_F367']
cmp ['[ebp+var_288],', '8']
jge ['short', 'loc_F34C']
mov ['edx,', '[ebp+var_288]']
add ['edx,', '8']
mov ['[ebp+var_288],', 'edx']
jmp ['short', 'loc_F367']
cmp ['[ebp+var_288],', '100h']
jl ['short', 'loc_F367']
mov ['eax,', '[ebp+var_288]']
add ['eax,', '1']
mov ['[ebp+var_288],', 'eax']
cmp ['ds:_bold_font_mode,', '0']
jz ['short', 'loc_F389']
mov ['ecx,', '[ebp+var_240]']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx+ecx*4]']
and ['eax,', '40000h']
mov ['[ebp+var_290],', 'eax']
jmp ['short', 'loc_F393']
mov ['[ebp+var_290],', '0']
mov ['ecx,', '[ebp+var_240]']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx+ecx*4]']
and ['eax,', '80000h']
mov ['[ebp+var_298],', 'eax']
mov ['ecx,', '[ebp+var_240]']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx+ecx*4]']
and ['eax,', '100000h']
jnz ['short', 'loc_F410']
cmp ['[ebp+var_288],', '100h']
jl ['short', 'loc_F3D3']
mov ['[ebp+var_288],', '0FFFFFFFFh']
cmp ['[ebp+var_280],', '100h']
jl ['short', 'loc_F410']
cmp ['ds:_bold_colours,', '0']
jz ['short', 'loc_F406']
mov ['ecx,', '[ebp+var_280]']
and ['ecx,', '1']
jz ['short', 'loc_F406']
cmp ['[ebp+var_288],', '0FFFFFFFFh']
jnz ['short', 'loc_F406']
mov ['[ebp+var_290],', '40000h']
mov ['[ebp+var_280],', '0FFFFFFFFh']
mov ['edx,', '[ebp+var_284]']
cmp ['edx,', '[ebp+var_280]']
jz ['short', 'loc_F47F']
mov ['eax,', '[ebp+var_280]']
mov ['[ebp+var_284],', 'eax']
cmp ['[ebp+var_280],', '0']
jl ['short', 'loc_F448']
mov ['ecx,', '[ebp+var_280]']
mov ['edx,', '[ebp+ecx*4+var_6B8]']
mov ['[ebp+var_6D0],', 'edx']
jmp ['short', 'loc_F452']
mov ['[ebp+var_6D0],', '0']
mov ['eax,', '[ebp+var_6D0]']
push ['eax']
push ['offset', '$SG91303']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '[ebp+var_238]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+var_238]']
mov ['[ebp+var_238],', 'eax']
mov ['edx,', '[ebp+var_28C]']
cmp ['edx,', '[ebp+var_288]']
jz ['short', 'loc_F4EE']
mov ['eax,', '[ebp+var_288]']
mov ['[ebp+var_28C],', 'eax']
cmp ['[ebp+var_288],', '0']
jl ['short', 'loc_F4B7']
mov ['ecx,', '[ebp+var_288]']
mov ['edx,', '[ebp+ecx*4+var_6B8]']
mov ['[ebp+var_6D4],', 'edx']
jmp ['short', 'loc_F4C1']
mov ['[ebp+var_6D4],', '0']
mov ['eax,', '[ebp+var_6D4]']
push ['eax']
push ['offset', '$SG91305']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '[ebp+var_238]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+var_238]']
mov ['[ebp+var_238],', 'eax']
mov ['edx,', '[ebp+var_294]']
cmp ['edx,', '[ebp+var_290]']
jz ['short', 'loc_F554']
mov ['eax,', '[ebp+var_290]']
mov ['[ebp+var_294],', 'eax']
cmp ['[ebp+var_290],', '0']
jz ['short', 'loc_F51D']
mov ['[ebp+var_6D8],', 'offset', '$SG91307']
jmp ['short', 'loc_F527']
mov ['[ebp+var_6D8],', 'offset', '$SG91308']
mov ['ecx,', '[ebp+var_6D8]']
push ['ecx']
push ['offset', '$SG91309']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '[ebp+var_238]']
push ['edx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+var_238]']
mov ['[ebp+var_238],', 'eax']
mov ['eax,', '[ebp+var_29C]']
cmp ['eax,', '[ebp+var_298]']
jz ['short', 'loc_F5BA']
mov ['ecx,', '[ebp+var_298]']
mov ['[ebp+var_29C],', 'ecx']
cmp ['[ebp+var_298],', '0']
jz ['short', 'loc_F583']
mov ['[ebp+var_6DC],', 'offset', '$SG91311']
jmp ['short', 'loc_F58D']
mov ['[ebp+var_6DC],', 'offset', '$SG91312']
mov ['edx,', '[ebp+var_6DC]']
push ['edx']
push ['offset', '$SG91313']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '[ebp+var_238]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+var_238]']
mov ['[ebp+var_238],', 'eax']
mov ['ecx,', '[ebp+var_230]']
add ['ecx,', '[ebp+var_240]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
movzx ['eax,', '[ebp+edx*2+WideCharStr]']
mov ['ecx,', '[ebp+var_23C]']
mov ['edx,', '[ebp+var_234]']
movzx ['ecx,', 'word', 'ptr', '[edx+ecx*2]']
cmp ['eax,', 'ecx']
jnz ['short', 'loc_F618']
mov ['[ebp+var_248],', '1']
mov ['[ebp+Source],', '0']
mov ['[ebp+var_278],', '0']
mov ['[ebp+var_250],', '0']
mov ['edx,', '[ebp+var_250]']
mov ['[ebp+var_24C],', 'edx']
jmp ['loc_F6E0']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['0']
push ['0']
push ['1']
mov ['eax,', '[ebp+var_23C]']
lea ['ecx,', '[ebp+eax*2+WideCharStr]']
push ['ecx']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__WideCharToMultiByte@32']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_248],', 'eax']
cmp ['[ebp+var_248],', '1']
jz ['short', 'loc_F6A4']
mov ['edx,', '[ebp+var_23C]']
mov ['eax,', '[ebp+var_234]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
push ['ecx']
mov ['edx,', '[ebp+var_248]']
push ['edx']
push ['offset', '$SG91320']
lea ['eax,', '[ebp+Source]']
push ['eax']
call ['_sprintf']
add ['esp,', '10h']
mov ['[ebp+var_24C],', 'eax']
mov ['[ebp+var_250],', '1']
push ['offset', '$SG91321']
lea ['ecx,', '[ebp+var_278]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
jmp ['short', 'loc_F6E0']
mov ['edx,', '[ebp+var_23C]']
mov ['eax,', '[ebp+var_234]']
movzx ['ecx,', 'word', 'ptr', '[eax+edx*2]']
push ['ecx']
push ['offset', '$SG91323']
lea ['edx,', '[ebp+Source]']
push ['edx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_24C],', 'eax']
mov ['[ebp+var_250],', '0']
mov ['[ebp+var_278],', '0']
mov ['eax,', '[ebp+var_240]']
add ['eax,', '[ebp+var_248]']
cmp ['eax,', '[ebp+dwBytes]']
jle ['short', 'loc_F708']
push ['1415h']
push ['offset', '$SG91325']
push ['offset', '$SG91326']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_24C]']
add ['edx,', '[ebp+var_250]']
mov ['[ebp+var_254],', 'edx']
mov ['[ebp+var_258],', '0']
jmp ['short', 'loc_F735']
mov ['eax,', '[ebp+var_258]']
add ['eax,', '1']
mov ['[ebp+var_258],', 'eax']
mov ['ecx,', '[ebp+var_258]']
cmp ['ecx,', '[ebp+var_248]']
jge ['loc_F84E']
mov ['edx,', '[ebp+var_240]']
add ['edx,', '[ebp+var_258]']
mov ['eax,', '[ebp+var_230]']
movzx ['ecx,', 'byte', 'ptr', '[eax+edx]']
cmp ['ecx,', '5Ch']
jz ['short', 'loc_F798']
mov ['edx,', '[ebp+var_240]']
add ['edx,', '[ebp+var_258]']
mov ['eax,', '[ebp+var_230]']
movzx ['ecx,', 'byte', 'ptr', '[eax+edx]']
cmp ['ecx,', '7Bh']
jz ['short', 'loc_F798']
mov ['edx,', '[ebp+var_240]']
add ['edx,', '[ebp+var_258]']
mov ['eax,', '[ebp+var_230]']
movzx ['ecx,', 'byte', 'ptr', '[eax+edx]']
cmp ['ecx,', '7Dh']
jnz ['short', 'loc_F7AC']
mov ['edx,', '[ebp+var_254]']
add ['edx,', '2']
mov ['[ebp+var_254],', 'edx']
jmp ['loc_F849']
mov ['eax,', '[ebp+var_240]']
add ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+var_230]']
movzx ['edx,', 'byte', 'ptr', '[ecx+eax]']
cmp ['edx,', '0Dh']
jz ['short', 'loc_F7E2']
mov ['eax,', '[ebp+var_240]']
add ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+var_230]']
movzx ['edx,', 'byte', 'ptr', '[ecx+eax]']
cmp ['edx,', '0Ah']
jnz ['short', 'loc_F7F3']
mov ['eax,', '[ebp+var_254]']
add ['eax,', '6']
mov ['[ebp+var_254],', 'eax']
jmp ['short', 'loc_F849']
mov ['ecx,', '[ebp+var_240]']
add ['ecx,', '[ebp+var_258]']
mov ['edx,', '[ebp+var_230]']
movzx ['eax,', 'byte', 'ptr', '[edx+ecx]']
cmp ['eax,', '7Eh']
jg ['short', 'loc_F829']
mov ['ecx,', '[ebp+var_240]']
add ['ecx,', '[ebp+var_258]']
mov ['edx,', '[ebp+var_230]']
movzx ['eax,', 'byte', 'ptr', '[edx+ecx]']
cmp ['eax,', '20h']
jge ['short', 'loc_F83A']
mov ['ecx,', '[ebp+var_254]']
add ['ecx,', '4']
mov ['[ebp+var_254],', 'ecx']
jmp ['short', 'loc_F849']
mov ['edx,', '[ebp+var_254]']
add ['edx,', '1']
mov ['[ebp+var_254],', 'edx']
jmp ['loc_F726']
mov ['eax,', '[ebp+var_254]']
mov ['ecx,', '[ebp+var_238]']
lea ['edx,', '[ecx+eax+3]']
cmp ['[ebp+var_244],', 'edx']
jge ['short', 'loc_F89D']
mov ['eax,', '[ebp+var_254]']
mov ['ecx,', '[ebp+var_238]']
lea ['edx,', '[ecx+eax+200h]']
mov ['[ebp+var_244],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_244]']
push ['eax']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+Dest],', 'eax']
lea ['edx,', '[ebp+Source]']
push ['edx']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '[ebp+var_238]']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_238]']
add ['ecx,', '[ebp+var_24C]']
mov ['[ebp+var_238],', 'ecx']
mov ['[ebp+var_258],', '0']
jmp ['short', 'loc_F8E6']
mov ['edx,', '[ebp+var_258]']
add ['edx,', '1']
mov ['[ebp+var_258],', 'edx']
mov ['eax,', '[ebp+var_258]']
cmp ['eax,', '[ebp+var_248]']
jge ['loc_FAAB']
mov ['ecx,', '[ebp+var_240]']
add ['ecx,', '[ebp+var_258]']
mov ['edx,', '[ebp+var_230]']
movzx ['eax,', 'byte', 'ptr', '[edx+ecx]']
cmp ['eax,', '5Ch']
jz ['short', 'loc_F949']
mov ['ecx,', '[ebp+var_240]']
add ['ecx,', '[ebp+var_258]']
mov ['edx,', '[ebp+var_230]']
movzx ['eax,', 'byte', 'ptr', '[edx+ecx]']
cmp ['eax,', '7Bh']
jz ['short', 'loc_F949']
mov ['ecx,', '[ebp+var_240]']
add ['ecx,', '[ebp+var_258]']
mov ['edx,', '[ebp+var_230]']
movzx ['eax,', 'byte', 'ptr', '[edx+ecx]']
cmp ['eax,', '7Dh']
jnz ['short', 'loc_F99E']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '[ebp+var_238]']
mov ['byte', 'ptr', '[ecx],', '5Ch']
mov ['edx,', '[ebp+var_238]']
add ['edx,', '1']
mov ['[ebp+var_238],', 'edx']
mov ['eax,', '[ebp+var_240]']
add ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '[ebp+var_238]']
mov ['edx,', '[ebp+var_230]']
mov ['al,', '[edx+eax]']
mov ['[ecx],', 'al']
mov ['ecx,', '[ebp+var_238]']
add ['ecx,', '1']
mov ['[ebp+var_238],', 'ecx']
jmp ['loc_FAA6']
mov ['edx,', '[ebp+var_240]']
add ['edx,', '[ebp+var_258]']
mov ['eax,', '[ebp+var_230]']
movzx ['ecx,', 'byte', 'ptr', '[eax+edx]']
cmp ['ecx,', '0Dh']
jz ['short', 'loc_F9D4']
mov ['edx,', '[ebp+var_240]']
add ['edx,', '[ebp+var_258]']
mov ['eax,', '[ebp+var_230]']
movzx ['ecx,', 'byte', 'ptr', '[eax+edx]']
cmp ['ecx,', '0Ah']
jnz ['short', 'loc_F9FF']
push ['offset', '$SG91351']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '[ebp+var_238]']
push ['edx']
call ['_sprintf']
add ['esp,', '8']
add ['eax,', '[ebp+var_238]']
mov ['[ebp+var_238],', 'eax']
jmp ['loc_FAA6']
mov ['eax,', '[ebp+var_240]']
add ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+var_230]']
movzx ['edx,', 'byte', 'ptr', '[ecx+eax]']
cmp ['edx,', '7Eh']
jg ['short', 'loc_FA35']
mov ['eax,', '[ebp+var_240]']
add ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+var_230]']
movzx ['edx,', 'byte', 'ptr', '[ecx+eax]']
cmp ['edx,', '20h']
jge ['short', 'loc_FA74']
mov ['eax,', '[ebp+var_240]']
add ['eax,', '[ebp+var_258]']
mov ['ecx,', '[ebp+var_230]']
movzx ['edx,', 'byte', 'ptr', '[ecx+eax]']
push ['edx']
push ['offset', '$SG91355']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '[ebp+var_238]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+var_238]']
mov ['[ebp+var_238],', 'eax']
jmp ['short', 'loc_FAA6']
mov ['ecx,', '[ebp+var_240]']
add ['ecx,', '[ebp+var_258]']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '[ebp+var_238]']
mov ['eax,', '[ebp+var_230]']
mov ['cl,', '[eax+ecx]']
mov ['[edx],', 'cl']
mov ['edx,', '[ebp+var_238]']
add ['edx,', '1']
mov ['[ebp+var_238],', 'edx']
jmp ['loc_F8D7']
lea ['eax,', '[ebp+var_278]']
push ['eax']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '[ebp+var_238]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
mov ['edx,', '[ebp+var_238]']
add ['edx,', '[ebp+var_250]']
mov ['[ebp+var_238],', 'edx']
mov ['eax,', '[ebp+var_240]']
add ['eax,', '[ebp+var_248]']
mov ['[ebp+var_240],', 'eax']
mov ['ecx,', '[ebp+var_23C]']
add ['ecx,', '1']
mov ['[ebp+var_23C],', 'ecx']
jmp ['loc_F175']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '[ebp+var_238]']
mov ['byte', 'ptr', '[edx],', '7Dh']
mov ['eax,', '[ebp+var_238]']
add ['eax,', '1']
mov ['[ebp+var_238],', 'eax']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '[ebp+var_238]']
mov ['byte', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+var_238]']
add ['edx,', '1']
mov ['[ebp+var_238],', 'edx']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '[ebp+var_238]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+var_238]']
add ['ecx,', '1']
mov ['[ebp+var_238],', 'ecx']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_238]']
push ['edx']
push ['2002h']
call ['dword', 'ptr', 'ds:__imp__GlobalAlloc@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_FBC6']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_10]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GlobalLock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_20],', 'eax']
cmp ['[ebp+var_20],', '0']
jz ['short', 'loc_FBC6']
mov ['ecx,', '[ebp+var_238]']
push ['ecx']
mov ['edx,', '[ebp+Dest]']
push ['edx']
mov ['eax,', '[ebp+var_20]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GlobalUnlock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_FBDE']
mov ['[ebp+var_10],', '0']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hMem]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GlobalUnlock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GlobalUnlock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+arg_10],', '0']
jnz ['short', 'loc_FC29']
mov ['esi,', 'esp']
push ['0']
push ['1']
push ['8002h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__OpenClipboard@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_FCBA']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__EmptyClipboard@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hMem]']
push ['ecx']
push ['0Dh']
call ['dword', 'ptr', 'ds:__imp__SetClipboardData@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_C]']
push ['edx']
push ['1']
call ['dword', 'ptr', 'ds:__imp__SetClipboardData@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_FCA9']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_10]']
push ['eax']
mov ['edi,', 'esp']
push ['offset', '$SG91364']
call ['dword', 'ptr', 'ds:__imp__RegisterClipboardFormatA@4']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetClipboardData@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__CloseClipboard@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_FCE0']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hMem]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GlobalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GlobalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+arg_10],', '0']
jnz ['short', 'loc_FD04']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['8002h']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN105_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '6DCh']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_process_clipdata proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+cchWideChar],', 'eax']
mov ['[ebp+Str],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+Src],', 'eax']
mov ['eax,', 'ds:_clipboard_contents']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ds:_clipboard_contents,', '0']
mov ['ds:_clipboard_length,', '0']
cmp ['[ebp+arg_4],', '0']
jz ['loc_FE67']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hMem]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GlobalLock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+Src],', 'eax']
cmp ['[ebp+Src],', '0']
jz ['short', 'loc_FE62']
mov ['edx,', '[ebp+Src]']
mov ['[ebp+var_8],', 'edx']
jmp ['short', 'loc_FDF9']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '2']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_FE05']
jmp ['short', 'loc_FDF0']
mov ['eax,', '[ebp+var_8]']
sub ['eax,', '[ebp+Src]']
sar ['eax,', '1']
mov ['ds:_clipboard_length,', 'eax']
push ['2']
mov ['ecx,', 'ds:_clipboard_length']
add ['ecx,', '1']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['ds:_clipboard_contents,', 'eax']
mov ['edx,', 'ds:_clipboard_length']
shl ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', 'ds:_clipboard_contents']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
xor ['edx,', 'edx']
mov ['eax,', 'ds:_clipboard_length']
mov ['ecx,', 'ds:_clipboard_contents']
mov ['[ecx+eax*2],', 'dx']
mov ['eax,', '1']
jmp ['loc_FF20']
jmp ['loc_FF1E']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+hMem]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GlobalLock@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+Str],', 'eax']
cmp ['[ebp+Str],', '0']
jz ['loc_FF1E']
mov ['esi,', 'esp']
push ['0']
push ['0']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '1']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MultiByteToWideChar@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+cchWideChar],', 'eax']
push ['2']
mov ['edx,', '[ebp+cchWideChar]']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['ds:_clipboard_contents,', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+cchWideChar]']
push ['eax']
mov ['ecx,', 'ds:_clipboard_contents']
push ['ecx']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '1']
push ['eax']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MultiByteToWideChar@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+cchWideChar]']
sub ['ecx,', '1']
mov ['ds:_clipboard_length,', 'ecx']
xor ['edx,', 'edx']
mov ['eax,', 'ds:_clipboard_length']
mov ['ecx,', 'ds:_clipboard_contents']
mov ['[ecx+eax*2],', 'dx']
mov ['eax,', '1']
jmp ['short', 'loc_FF20']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_request_paste  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+ThreadId],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+ThreadId]']
push ['eax']
push ['0']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
push ['offset', '_clipboard_read_threadfunc@4']
push ['0']
push ['0']
call ['dword', 'ptr', 'ds:__imp__CreateThread@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_5']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_clipboard_read_threadfunc@4 proc near  
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+lParam],', '0CCCCCCCCh']
mov ['[ebp+hWnd],', '0CCCCCCCCh']
mov ['eax,', '[ebp+lpThreadParameter]']
mov ['[ebp+hWnd],', 'eax']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__OpenClipboard@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['loc_1007D']
mov ['esi,', 'esp']
push ['0Dh']
call ['dword', 'ptr', 'ds:__imp__GetClipboardData@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+lParam],', 'eax']
cmp ['[ebp+lParam],', '0']
jz ['short', 'loc_10036']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+lParam]']
push ['ecx']
push ['1']
push ['8006h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_1006E']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__GetClipboardData@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+lParam],', 'eax']
cmp ['[ebp+lParam],', '0']
jz ['short', 'loc_1006E']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+lParam]']
push ['eax']
push ['0']
push ['8006h']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__CloseClipboard@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['4']
endp
_get_clip       proc near
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_100B6']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', 'ds:_clipboard_contents']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', 'ds:_clipboard_length']
mov ['[edx],', 'eax']
pop ['ebp']
retn
endp
_fatalbox       proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '78h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_78]']
mov ['ecx,', '1Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dupvprintf']
add ['esp,', '8']
mov ['[ebp+lpText],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG91428']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['10h']
lea ['edx,', '[ebp+Dest]']
push ['edx']
mov ['eax,', '[ebp+lpText]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+lpText]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['1']
call ['_cleanup_exit']
endp
_modalfatalbox  proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '78h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_78]']
mov ['ecx,', '1Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dupvprintf']
add ['esp,', '8']
mov ['[ebp+lpText],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG91439']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['1010h']
lea ['edx,', '[ebp+Dest]']
push ['edx']
mov ['eax,', '[ebp+lpText]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+lpText]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['1']
call ['_cleanup_exit']
endp
_nonfatal       proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '78h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_78]']
mov ['ecx,', '1Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dupvprintf']
add ['esp,', '8']
mov ['[ebp+lpText],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG91450']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['10h']
lea ['edx,', '[ebp+Dest]']
push ['edx']
mov ['eax,', '[ebp+lpText]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+lpText]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_8']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '78h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_flash_window   proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['62h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_10373']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_103BC']
cmp ['ds:_flashing,', '0']
jz ['short', 'loc_103B7']
mov ['ds:_flashing,', '0']
cmp ['ds:_p_FlashWindowEx,', '0']
jz ['short', 'loc_1039F']
push ['0']
push ['0']
push ['0']
call ['_flash_window_ex']
add ['esp,', '0Ch']
jmp ['short', 'loc_103B7']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__FlashWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_10484']
cmp ['[ebp+arg_0],', '2']
jnz ['short', 'loc_10431']
cmp ['ds:_flashing,', '0']
jnz ['short', 'loc_1042F']
mov ['ds:_flashing,', '1']
cmp ['ds:_p_FlashWindowEx,', '0']
jz ['short', 'loc_103FA']
push ['0']
mov ['edx,', '[ebp+var_4]']
sub ['edx,', '1']
neg ['edx']
sbb ['edx,', 'edx']
and ['edx,', '2']
push ['edx']
push ['7']
call ['_flash_window_ex']
add ['esp,', '0Ch']
jmp ['short', 'loc_1042F']
mov ['esi,', 'esp']
push ['1']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__FlashWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
push ['offset', '_flash_window_timer']
push ['1C2h']
call ['_schedule_timer']
add ['esp,', '0Ch']
mov ['ds:_next_flash,', 'eax']
jmp ['short', 'loc_10484']
cmp ['[ebp+arg_0],', '1']
jnz ['short', 'loc_10484']
cmp ['[ebp+var_4],', '1']
jnz ['short', 'loc_10484']
cmp ['ds:_flashing,', '0']
jz ['short', 'loc_10484']
cmp ['ds:_p_FlashWindowEx,', '0']
jnz ['short', 'loc_10484']
mov ['esi,', 'esp']
push ['1']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__FlashWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
push ['offset', '_flash_window_timer']
push ['1C2h']
call ['_schedule_timer']
add ['esp,', '0Ch']
mov ['ds:_next_flash,', 'eax']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_flash_window_ex proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1Ch']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
cmp ['ds:_p_FlashWindowEx,', '0']
jz ['short', 'loc_104FA']
mov ['[ebp+var_18],', '14h']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
mov ['[ebp+var_14],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_8],', 'eax']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_18]']
push ['ecx']
call ['ds:_p_FlashWindowEx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_104FC']
jmp ['short', 'loc_104FC']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN7_3']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '1Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_flash_window_timer proc near           
push ['ebp']
mov ['ebp,', 'esp']
cmp ['ds:_flashing,', '0']
jz ['short', 'loc_10559']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', 'ds:_next_flash']
jnz ['short', 'loc_10559']
push ['1']
call ['_flash_window']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_do_beep        proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0D8h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_D8]']
mov ['ecx,', '36h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_105E4']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
sub ['eax,', 'ds:?lastbeep@?2??do_beep@@9@9']
mov ['[ebp+var_8],', 'eax']
js ['short', 'loc_105BA']
cmp ['[ebp+var_8],', '32h']
jge ['short', 'loc_105BA']
jmp ['loc_10716']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBeep@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:?lastbeep@?2??do_beep@@9@9,', 'eax']
jmp ['loc_106FE']
cmp ['[ebp+arg_4],', '3']
jnz ['loc_1068A']
push ['67h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_filename']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['esi,', 'esp']
push ['20001h']
push ['0']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__PlaySoundA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_10688']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax]']
push ['ecx']
push ['offset', '$SG91507']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG91508']
lea ['ecx,', '[ebp+Caption]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['30h']
lea ['edx,', '[ebp+Caption]']
push ['edx']
lea ['eax,', '[ebp+Dest]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['1']
push ['61h']
mov ['edx,', 'dword', 'ptr', 'ds:_conf']
push ['edx']
call ['_conf_set_int']
add ['esp,', '0Ch']
jmp ['short', 'loc_106FE']
cmp ['[ebp+arg_4],', '4']
jnz ['short', 'loc_106FE']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
sub ['eax,', 'ds:?lastbeep@?5??do_beep@@9@9']
mov ['[ebp+var_D8],', 'eax']
js ['short', 'loc_106B8']
cmp ['[ebp+var_D8],', '32h']
jge ['short', 'loc_106B8']
jmp ['short', 'loc_10716']
cmp ['dword', 'ptr', 'ds:_osVersion+10h,', '2']
jnz ['short', 'loc_106D9']
mov ['esi,', 'esp']
push ['64h']
push ['320h']
call ['dword', 'ptr', 'ds:__imp__Beep@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_106EA']
mov ['esi,', 'esp']
push ['0FFFFFFFFh']
call ['dword', 'ptr', 'ds:__imp__MessageBeep@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:?lastbeep@?5??do_beep@@9@9,', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
cmp ['dword', 'ptr', '[eax+134h],', '0']
jnz ['short', 'loc_10716']
push ['2']
call ['_flash_window']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN17_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '0D8h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_set_iconic     proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsIconic@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_107B5']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_107B3']
mov ['esi,', 'esp']
push ['9']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_107D3']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_107D3']
mov ['esi,', 'esp']
push ['6']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_move_window    proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['6Ah']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '1']
jz ['short', 'loc_1082D']
cmp ['[ebp+var_4],', '2']
jz ['short', 'loc_1082D']
mov ['esi,', 'esp']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_1082F']
jmp ['short', 'loc_10855']
mov ['esi,', 'esp']
push ['5']
push ['0']
push ['0']
mov ['edx,', '[ebp+Y]']
push ['edx']
mov ['eax,', '[ebp+X]']
push ['eax']
push ['0']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_set_zorder     proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
push ['53h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_10882']
jmp ['short', 'loc_108AC']
mov ['esi,', 'esp']
push ['3']
push ['0']
push ['0']
push ['0']
push ['0']
xor ['ecx,', 'ecx']
cmp ['[ebp+arg_4],', '0']
setz ['cl']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_refresh_window proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_set_zoomed     proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_10925']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_10923']
mov ['esi,', 'esp']
push ['9']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_10943']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_10943']
mov ['esi,', 'esp']
push ['3']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_is_iconic      proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsIconic@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_get_window_pos proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1Ch']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+Rect.left],', 'eax']
mov ['[ebp+Rect.top],', 'eax']
mov ['[ebp+Rect.right],', 'eax']
mov ['[ebp+Rect.bottom],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Rect]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetWindowRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+Rect.left]']
mov ['[edx],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ebp+Rect.top]']
mov ['[ecx],', 'edx']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_10']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '1Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_get_window_pixels proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1Ch']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+Rect.left],', 'eax']
mov ['[ebp+Rect.top],', 'eax']
mov ['[ebp+Rect.right],', 'eax']
mov ['[ebp+Rect.bottom],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Rect]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetWindowRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+Rect.right]']
sub ['edx,', '[ebp+Rect.left]']
mov ['eax,', '[ebp+arg_4]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+Rect.bottom]']
sub ['ecx,', '[ebp+Rect.top]']
mov ['edx,', '[ebp+arg_8]']
mov ['[edx],', 'ecx']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_11']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '1Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_get_window_title proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_10AE3']
mov ['eax,', 'ds:_icon_name']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_10AEC']
mov ['ecx,', 'ds:_window_name']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_is_full_screen proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_10B19']
xor ['eax,', 'eax']
jmp ['short', 'loc_10B41']
mov ['esi,', 'esp']
push ['0FFFFFFF0h']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetWindowLongA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
and ['eax,', '0C00000h']
jz ['short', 'loc_10B3C']
xor ['eax,', 'eax']
jmp ['short', 'loc_10B41']
mov ['eax,', '1']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_get_fullscreen_rect proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '38h']
push ['edi']
lea ['edi,', '[ebp+var_38]']
mov ['ecx,', '0Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
push ['2']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['_xMonitorFromWindow@8']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_34.cbSize],', '28h']
lea ['ecx,', '[ebp+var_34]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_xGetMonitorInfo@8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_34.rcMonitor.left]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+var_34.rcMonitor.top]']
mov ['[eax+4],', 'edx']
mov ['ecx,', '[ebp+var_34.rcMonitor.right]']
mov ['[eax+8],', 'ecx']
mov ['edx,', '[ebp+var_34.rcMonitor.bottom]']
mov ['[eax+0Ch],', 'edx']
mov ['eax,', '1']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_12']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '38h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_make_full_screen proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+X],', 'eax']
mov ['[ebp+Y],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+dwNewLong],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_10C69']
push ['161Dh']
push ['offset', '$SG91595']
push ['offset', '$SG91596']
call ['__wassert']
add ['esp,', '0Ch']
call ['_is_full_screen']
test ['eax,', 'eax']
jz ['short', 'loc_10C77']
jmp ['loc_10D68']
mov ['esi,', 'esp']
push ['0FFFFFFF0h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetWindowLongA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwNewLong],', 'eax']
mov ['eax,', '[ebp+dwNewLong]']
and ['eax,', '0FF3BFFFFh']
mov ['[ebp+dwNewLong],', 'eax']
push ['69h']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_10CC0']
mov ['edx,', '[ebp+dwNewLong]']
or ['edx,', '200000h']
mov ['[ebp+dwNewLong],', 'edx']
jmp ['short', 'loc_10CCB']
mov ['eax,', '[ebp+dwNewLong]']
and ['eax,', '0FFDFFFFFh']
mov ['[ebp+dwNewLong],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+dwNewLong]']
push ['ecx']
push ['0FFFFFFF0h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
lea ['eax,', '[ebp+X]']
push ['eax']
call ['_get_fullscreen_rect']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['20h']
mov ['ecx,', '[ebp+var_10]']
sub ['ecx,', '[ebp+Y]']
push ['ecx']
mov ['edx,', '[ebp+var_14]']
sub ['edx,', '[ebp+X]']
push ['edx']
mov ['eax,', '[ebp+Y]']
push ['eax']
mov ['ecx,', '[ebp+X]']
push ['ecx']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
call ['_reset_window']
add ['esp,', '4']
mov ['[ebp+var_24],', '0']
jmp ['short', 'loc_10D3F']
mov ['eax,', '[ebp+var_24]']
add ['eax,', '1']
mov ['[ebp+var_24],', 'eax']
cmp ['[ebp+var_24],', '2']
jnb ['short', 'loc_10D68']
mov ['esi,', 'esp']
push ['8']
push ['180h']
mov ['ecx,', '[ebp+var_24]']
mov ['edx,', 'ds:_popup_menus[ecx*4]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__CheckMenuItem@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_10D36']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN12_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_clear_full_screen proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+dwNewLong],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['esi,', 'esp']
push ['0FFFFFFF0h']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetWindowLongA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['[ebp+dwNewLong],', 'ecx']
mov ['edx,', '[ebp+dwNewLong]']
or ['edx,', '0C00000h']
mov ['[ebp+dwNewLong],', 'edx']
push ['6Ah']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '1']
jnz ['short', 'loc_10E23']
mov ['ecx,', '[ebp+dwNewLong]']
and ['ecx,', '0FFFBFFFFh']
mov ['[ebp+dwNewLong],', 'ecx']
jmp ['short', 'loc_10E2F']
mov ['edx,', '[ebp+dwNewLong]']
or ['edx,', '40000h']
mov ['[ebp+dwNewLong],', 'edx']
push ['68h']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_10E51']
mov ['ecx,', '[ebp+dwNewLong]']
or ['ecx,', '200000h']
mov ['[ebp+dwNewLong],', 'ecx']
jmp ['short', 'loc_10E5D']
mov ['edx,', '[ebp+dwNewLong]']
and ['edx,', '0FFDFFFFFh']
mov ['[ebp+dwNewLong],', 'edx']
mov ['eax,', '[ebp+dwNewLong]']
cmp ['eax,', '[ebp+var_4]']
jz ['short', 'loc_10EA2']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+dwNewLong]']
push ['ecx']
push ['0FFFFFFF0h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['27h']
push ['0']
push ['0']
push ['0']
push ['0']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowPos@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', '0']
jmp ['short', 'loc_10EB4']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '1']
mov ['[ebp+var_C],', 'ecx']
cmp ['[ebp+var_C],', '2']
jnb ['short', 'loc_10EDD']
mov ['esi,', 'esp']
push ['0']
push ['180h']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', 'ds:_popup_menus[edx*4]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__CheckMenuItem@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_10EAB']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_flip_full_screen proc near             
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
call ['_is_full_screen']
test ['eax,', 'eax']
jz ['short', 'loc_10F1E']
mov ['esi,', 'esp']
push ['9']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_10F75']
mov ['esi,', 'esp']
mov ['ecx,', 'dword', 'ptr', 'ds:_hwnd']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__IsZoomed@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_10F3F']
call ['_make_full_screen']
jmp ['short', 'loc_10F75']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['8003h']
mov ['edx,', 'dword', 'ptr', 'ds:_hwnd']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['3']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_frontend_keypress proc near
push ['ebp']
mov ['ebp,', 'esp']
pop ['ebp']
retn
endp
_from_backend   proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_data']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_from_backend_untrusted proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', 'dword', 'ptr', 'ds:_term']
push ['edx']
call ['_term_data_untrusted']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_from_backend_eof proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '1']
pop ['ebp']
retn
endp
_get_userpass_input proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_cmdline_get_passwd_input']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0FFFFFFFFh']
jnz ['short', 'loc_1104D']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
mov ['eax,', 'dword', 'ptr', 'ds:_term']
push ['eax']
call ['_term_get_userpass_input']
add ['esp,', '10h']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_agent_schedule_callback proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+lParam],', '0CCCCCCCCh']
push ['10h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+lParam],', 'eax']
mov ['eax,', '[ebp+lParam]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+lParam]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+4],', 'eax']
mov ['ecx,', '[ebp+lParam]']
mov ['edx,', '[ebp+arg_8]']
mov ['[ecx+8],', 'edx']
mov ['eax,', '[ebp+lParam]']
mov ['ecx,', '[ebp+arg_C]']
mov ['[eax+0Ch],', 'ecx']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+lParam]']
push ['edx']
push ['0']
push ['8004h']
mov ['eax,', 'dword', 'ptr', 'ds:_hwnd']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__PostMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
