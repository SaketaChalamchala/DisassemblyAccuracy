_ssh_comp_none_init proc near           
push ['ebp']
mov ['ebp,', 'esp']
xor ['eax,', 'eax']
pop ['ebp']
retn
endp
_ssh_comp_none_cleanup proc near        
push ['ebp']
mov ['ebp,', 'esp']
pop ['ebp']
retn
endp
_ssh_comp_none_block proc near          
push ['ebp']
mov ['ebp,', 'esp']
xor ['eax,', 'eax']
pop ['ebp']
retn
endp
_ssh_comp_none_disable proc near        
push ['ebp']
mov ['ebp,', 'esp']
xor ['eax,', 'eax']
pop ['ebp']
retn
endp
_ssh_socket_log proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '114h']
push ['edi']
lea ['edi,', '[ebp+var_114]']
mov ['ecx,', '45h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+0C8h],', '0']
jz ['short', 'loc_67A5']
jmp ['loc_6855']
push ['100h']
lea ['edx,', '[ebp+var_10C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_sk_getaddr']
add ['esp,', '0Ch']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_680F']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
call ['_sk_addr_needs_port']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_67F3']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
lea ['eax,', '[ebp+var_10C]']
push ['eax']
push ['offset', '$SG89753']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_114],', 'eax']
jmp ['short', 'loc_680D']
lea ['ecx,', '[ebp+var_10C]']
push ['ecx']
push ['offset', '$SG89755']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_114],', 'eax']
jmp ['short', 'loc_682D']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
lea ['eax,', '[ebp+var_10C]']
push ['eax']
push ['offset', '$SG89757']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_114],', 'eax']
mov ['ecx,', '[ebp+var_114]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_114]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '114h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_connshare_log proc near
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_6906']
cmp ['[ebp+arg_8],', '0']
jz ['short', 'loc_68CE']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
push ['offset', '$SG89771']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
jmp ['short', 'loc_6904']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_68E9']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
push ['offset', '$SG89774']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
cmp ['[ebp+arg_10],', '0']
jz ['short', 'loc_6904']
mov ['ecx,', '[ebp+arg_10]']
push ['ecx']
push ['offset', '$SG89776']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
jmp ['short', 'loc_6964']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_6949']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
push ['offset', '$SG89779']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', 'dword', 'ptr', 'ds:_flags']
and ['edx,', '1']
jnz ['short', 'loc_6936']
mov ['eax,', 'dword', 'ptr', 'ds:_flags']
and ['eax,', '4']
jz ['short', 'loc_6947']
push ['offset', '$SG89782']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
jmp ['short', 'loc_6964']
cmp ['[ebp+arg_4],', '2']
jnz ['short', 'loc_6964']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
push ['offset', '$SG89785']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_logeventf      proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
lea ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_dupvprintf']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', '0']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_c_write_str    proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_c_write        proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_flags']
and ['eax,', '2']
jz ['short', 'loc_6A39']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['1']
call ['_c_write_stderr']
add ['esp,', '0Ch']
jmp ['short', 'loc_6A55']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_from_backend']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_c_write_stderr proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_6A85']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[ebp+arg_8]']
jge ['short', 'loc_6ADA']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '[ebp+var_4]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '0Dh']
jz ['short', 'loc_6AD8']
cmp ['[ebp+arg_0],', '0']
jnz ['short', 'loc_6ABD']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '[ebp+var_4]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '0Ah']
jz ['short', 'loc_6ABD']
mov ['eax,', '[ebp+arg_4]']
add ['eax,', '[ebp+var_4]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
and ['ecx,', '60h']
jz ['short', 'loc_6AD8']
call ['___iob_func']
add ['eax,', '40h']
push ['eax']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '[ebp+var_4]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
push ['eax']
call ['_fputc']
add ['esp,', '8']
jmp ['short', 'loc_6A7C']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_closing    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
push ['0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_do_close']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_6B35']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+108h],', '0']
jnz ['short', 'loc_6B2E']
mov ['[ebp+arg_4],', 'offset', '$SG89801']
jmp ['short', 'loc_6B35']
mov ['[ebp+arg_4],', 'offset', '$SG89803']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+108h],', '0']
jz ['short', 'loc_6B66']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+10Ch],', '0']
jz ['short', 'loc_6B66']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+104h],', '0']
jge ['short', 'loc_6B66']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+104h],', '0']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_6B7E']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_notify_remote_exit']
add ['esp,', '4']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_6B9A']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+108h],', '0']
jz ['short', 'loc_6BB2']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+10Ch],', '0']
jnz ['short', 'loc_6BCD']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['offset', '$SG89809']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_connection_fatal']
add ['esp,', '0Ch']
xor ['eax,', 'eax']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_do_close   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_4],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+118h],', '4']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_expire_timer_context']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jz ['short', 'loc_6C74']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+10h],', '0']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_6C6D']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_notify_remote_exit']
add ['esp,', '4']
jmp ['short', 'loc_6C74']
mov ['[ebp+var_4],', '1']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0F8h],', '0']
jz ['loc_6D20']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F8h]']
push ['edx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_6D20']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+0Ch]']
mov ['[ebp+var_10],', 'ecx']
cmp ['[ebp+var_10],', '1']
jz ['short', 'loc_6CBE']
cmp ['[ebp+var_10],', '2']
jle ['short', 'loc_6CDE']
cmp ['[ebp+var_10],', '4']
jle ['short', 'loc_6CCF']
jmp ['short', 'loc_6CDE']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_x11_close']
add ['esp,', '4']
jmp ['short', 'loc_6CDE']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_pfd_close']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F8h]']
push ['edx']
call ['_del234']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+16Ch],', '2']
jnz ['short', 'loc_6D0F']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '20h']
push ['ecx']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_6C84']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+114h],', '0']
jz ['loc_6DF1']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+114h]']
push ['edx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['loc_6DD2']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+28h],', '0']
jz ['short', 'loc_6D69']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+28h]']
push ['edx']
call ['_pfl_terminate']
add ['esp,', '4']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+114h]']
push ['edx']
call ['_del234']
add ['esp,', '8']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_6DC1']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+14h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+18h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_6D30']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+114h]']
push ['ecx']
call ['_freetree234']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+114h],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0CCh],', '0']
jz ['short', 'loc_6E1C']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0CCh]']
push ['edx']
call ['_sharestate_free']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0CCh],', '0']
mov ['eax,', '[ebp+var_4]']
pop ['esi']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_receive    proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh_gotdata']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+118h],', '4']
jnz ['short', 'loc_6E7B']
push ['1']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_do_close']
add ['esp,', '8']
xor ['eax,', 'eax']
jmp ['short', 'loc_6E80']
mov ['eax,', '1']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_gotdata    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+18h],', '0']
jz ['short', 'loc_6EE4']
push ['0']
push ['0']
push ['0']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['0']
push ['0FFFFFFFFh']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_log_packet']
add ['esp,', '2Ch']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '190h']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+190h]']
mov ['[ebp+var_C],', 'ecx']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_6F1D']
cmp ['[ebp+var_C],', '0C7Bh']
jz ['short', 'loc_6F3A']
cmp ['[ebp+var_C],', '0CA0h']
jz ['loc_7021']
jmp ['loc_702A']
mov ['edx,', '1']
test ['edx,', 'edx']
jz ['short', 'loc_6F7F']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_6F3E']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0C7Bh']
jmp ['loc_7033']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_6F2C']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_4]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+218h]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '1']
mov ['[ebp+arg_4],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', '1']
mov ['[ebp+arg_8],', 'edx']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_6F7D']
jmp ['short', 'loc_6F7F']
jmp ['short', 'loc_6F1D']
mov ['eax,', '1']
test ['eax,', 'eax']
jz ['loc_702A']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '238h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jg ['short', 'loc_6FA8']
cmp ['[ebp+arg_8],', '0']
jle ['short', 'loc_7016']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+234h],', '0']
jz ['short', 'loc_6FCC']
lea ['eax,', '[ebp+arg_8]']
push ['eax']
lea ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_queue_incoming_data']
add ['esp,', '0Ch']
jmp ['short', 'loc_7016']
jmp ['short', 'loc_7003']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '238h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jle ['short', 'loc_6FEF']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_process_queued_incoming_data']
add ['esp,', '4']
jmp ['short', 'loc_7003']
lea ['edx,', '[ebp+arg_8]']
push ['edx']
lea ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_process_incoming_data']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+118h],', '4']
jnz ['short', 'loc_7011']
jmp ['short', 'loc_7033']
jmp ['loc_6F8C']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0CA0h']
jmp ['short', 'loc_7033']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_7016']
jmp ['loc_6F7F']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx],', '0']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_process_incoming_data proc near    
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+214h]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_70AF']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_4]']
push ['edx']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+210h]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh_free_packet']
add ['esp,', '4']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_free_packet proc near              
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_queue_incoming_data proc near      
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '238h']
push ['ecx']
call ['_bufchain_add']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+arg_8]']
add ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+arg_8]']
mov ['dword', 'ptr', '[eax],', '0']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_process_queued_incoming_data proc near 
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+234h],', '0']
jnz ['loc_71F8']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '238h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_71F8']
lea ['edx,', '[ebp+var_20]']
push ['edx']
lea ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '238h']
push ['ecx']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_20]']
mov ['[ebp+var_28],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+234h],', '0']
jnz ['short', 'loc_71D2']
cmp ['[ebp+var_20],', '0']
jle ['short', 'loc_71D2']
lea ['edx,', '[ebp+var_20]']
push ['edx']
lea ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_process_incoming_data']
add ['esp,', '0Ch']
jmp ['short', 'loc_71AA']
mov ['edx,', '[ebp+var_28]']
cmp ['edx,', '[ebp+var_20]']
jle ['short', 'loc_71F3']
mov ['eax,', '[ebp+var_28]']
sub ['eax,', '[ebp+var_20]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '238h']
push ['ecx']
call ['_bufchain_consume']
add ['esp,', '8']
jmp ['loc_715E']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN12']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_sent       proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_4],', '8000h']
jge ['short', 'loc_7284']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_throttle_all']
add ['esp,', '0Ch']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_throttle_all proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+178h]']
jnz ['short', 'loc_72C6']
jmp ['loc_7362']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+178h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_8]']
mov ['[ecx+174h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0F8h],', '0']
jnz ['short', 'loc_72EC']
jmp ['short', 'loc_7362']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_72FE']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '1']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0F8h]']
push ['ecx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_7362']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+0Ch]']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '1']
jz ['short', 'loc_7336']
cmp ['[ebp+var_C],', '3']
jz ['short', 'loc_734D']
jmp ['short', 'loc_7360']
jmp ['short', 'loc_7360']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_x11_override_throttle']
add ['esp,', '8']
jmp ['short', 'loc_7360']
jmp ['short', 'loc_7360']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_pfd_override_throttle']
add ['esp,', '8']
jmp ['short', 'loc_72F5']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_verify_ssh_manual_host_key proc near   
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
push ['0']
push ['0A7h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_str_nthstrkey']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_73C4']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_758F']
cmp ['[ebp+Str],', '0']
jz ['loc_74A3']
push ['20h']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strrchr']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_73F0']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_24],', 'eax']
jmp ['short', 'loc_73F6']
mov ['ecx,', '[ebp+Str]']
mov ['[ebp+var_24],', 'ecx']
mov ['edx,', '[ebp+var_24]']
mov ['[ebp+Str],', 'edx']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
cmp ['eax,', '2Fh']
jz ['short', 'loc_7424']
push ['0E7Ch']
push ['offset', '$SG90006']
push ['offset', '$SG90007']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+Str]']
movsx ['eax,', 'byte', 'ptr', '[edx+2]']
cmp ['eax,', '3Ah']
jz ['short', 'loc_7447']
push ['0E7Dh']
push ['offset', '$SG90009']
push ['offset', '$SG90010']
call ['__wassert']
add ['esp,', '0Ch']
push ['offset', '$SG90012']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strspn']
add ['esp,', '8']
mov ['ecx,', '[ebp+Str]']
movsx ['edx,', 'byte', 'ptr', '[ecx+eax]']
test ['edx,', 'edx']
jz ['short', 'loc_747A']
push ['0E7Eh']
push ['offset', '$SG90013']
push ['offset', '$SG90014']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['0A7h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_str_str_opt']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_74A3']
mov ['eax,', '1']
jmp ['loc_758F']
cmp ['[ebp+arg_C],', '0']
jz ['loc_758D']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax+0Ch]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+var_14]']
add ['eax,', '2']
cdq
mov ['ecx,', '3']
idiv ['ecx']
mov ['[ebp+var_1C],', 'eax']
push ['1']
mov ['edx,', '[ebp+var_1C]']
lea ['eax,', 'ds:1[edx*4]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_20],', '0']
jmp ['short', 'loc_7507']
mov ['ecx,', '[ebp+var_20]']
add ['ecx,', '1']
mov ['[ebp+var_20],', 'ecx']
mov ['edx,', '[ebp+var_20]']
cmp ['edx,', '[ebp+var_1C]']
jge ['short', 'loc_7539']
mov ['eax,', '[ebp+var_20]']
mov ['ecx,', '[ebp+var_C]']
lea ['edx,', '[ecx+eax*4]']
push ['edx']
mov ['eax,', '[ebp+var_20]']
imul ['eax,', '3']
mov ['ecx,', '[ebp+var_14]']
sub ['ecx,', 'eax']
push ['ecx']
mov ['edx,', '[ebp+var_20]']
imul ['edx,', '3']
add ['edx,', '[ebp+var_8]']
push ['edx']
call ['_base64_encode_atom']
add ['esp,', '0Ch']
jmp ['short', 'loc_74FE']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[ebp+var_C]']
mov ['byte', 'ptr', '[ecx+eax*4],', '0']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_C]']
push ['eax']
push ['0A7h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_str_str_opt']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_7581']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['short', 'loc_758F']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN18']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sshfwd_get_conf proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+21Ch]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sshfwd_write_eof proc near             
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+118h],', '4']
jnz ['short', 'loc_7619']
jmp ['short', 'loc_763C']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
and ['ecx,', '1']
jz ['short', 'loc_7626']
jmp ['short', 'loc_763C']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+18h],', '1']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_channel_try_eof']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_channel_try_eof proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+18h],', '0']
jnz ['short', 'loc_7694']
push ['1283h']
push ['offset', '$SG90720']
push ['offset', '$SG90721']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jz ['short', 'loc_76A2']
jmp ['loc_7751']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+16Ch],', '2']
jnz ['short', 'loc_76C6']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '20h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jle ['short', 'loc_76C6']
jmp ['loc_7751']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+18h],', '0']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+16Ch],', '1']
jnz ['short', 'loc_7706']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
push ['1']
push ['18h']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_send_packet']
add ['esp,', '14h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
or ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+14h],', 'ecx']
jmp ['short', 'loc_7751']
push ['60h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
or ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_channel_check_close']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_send_packet    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
lea ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_construct_packet']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_s_wrpkt']
add ['esp,', '8']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_s_wrpkt        proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_10]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_s_wrpkt_prepare']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
add ['edx,', '[ebp+var_10]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_s_write']
add ['esp,', '0Ch']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '8000h']
jle ['short', 'loc_7831']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_throttle_all']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_free_packet']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN6']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_s_wrpkt_prepare proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '30h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_30]']
mov ['ecx,', '0Ch']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+18h],', '0']
jz ['short', 'loc_78A8']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh1_log_outgoing_packet']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+3Ch],', '0']
jz ['short', 'loc_7922']
lea ['ecx,', '[ebp+Size]']
push ['ecx']
lea ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
sub ['ecx,', '0Ch']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+10h]']
add ['eax,', '0Ch']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+88h]']
push ['edx']
call ['_zlib_compress_block']
add ['esp,', '14h']
mov ['eax,', '[ebp+Size]']
add ['eax,', '2']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_ensure']
add ['esp,', '8']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
add ['edx,', '0Ch']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+Src]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+Size]']
add ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
add ['ecx,', '4']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_ensure']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
add ['ecx,', '4']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
sub ['ecx,', '0Ch']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', '[ebp+var_18]']
and ['edx,', '80000007h']
jns ['short', 'loc_795F']
dec ['edx']
or ['edx,', '0FFFFFFF8h']
inc ['edx']
mov ['eax,', '8']
sub ['eax,', 'edx']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '8']
sub ['ecx,', '[ebp+var_4]']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_18]']
add ['edx,', '[ebp+var_4]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_10]']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_798E']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '1']
mov ['[ebp+var_C],', 'ecx']
cmp ['[ebp+var_C],', '0Ch']
jge ['short', 'loc_79A7']
call ['_random_byte']
mov ['edx,', '[ebp+arg_4]']
mov ['ecx,', '[edx+10h]']
mov ['edx,', '[ebp+var_C]']
mov ['[ecx+edx],', 'al']
jmp ['short', 'loc_7985']
mov ['eax,', '[ebp+var_8]']
sub ['eax,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
mov ['eax,', '[ebp+var_10]']
lea ['ecx,', '[edx+eax+4]']
push ['ecx']
call ['_crc32_compute']
add ['esp,', '8']
mov ['[ebp+var_14],', 'eax']
mov ['edx,', '[ebp+var_14]']
shr ['edx,', '18h']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
add ['ecx,', '[ebp+var_10]']
mov ['eax,', '[ebp+var_8]']
mov ['[ecx+eax],', 'dl']
mov ['ecx,', '[ebp+var_14]']
shr ['ecx,', '10h']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+10h]']
add ['eax,', '[ebp+var_10]']
mov ['edx,', '[ebp+var_8]']
mov ['[eax+edx+1],', 'cl']
mov ['eax,', '[ebp+var_14]']
shr ['eax,', '8']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
add ['edx,', '[ebp+var_10]']
mov ['ecx,', '[ebp+var_8]']
mov ['[edx+ecx+2],', 'al']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+10h]']
add ['eax,', '[ebp+var_10]']
mov ['ecx,', '[ebp+var_8]']
mov ['dl,', 'byte', 'ptr', '[ebp+var_14]']
mov ['[eax+ecx+3],', 'dl']
mov ['eax,', '[ebp+var_18]']
sar ['eax,', '18h']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
mov ['ecx,', '[ebp+var_10]']
mov ['[edx+ecx],', 'al']
mov ['edx,', '[ebp+var_18]']
sar ['edx,', '10h']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
mov ['eax,', '[ebp+var_10]']
mov ['[ecx+eax+1],', 'dl']
mov ['ecx,', '[ebp+var_18]']
sar ['ecx,', '8']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+10h]']
mov ['edx,', '[ebp+var_10]']
mov ['[eax+edx+2],', 'cl']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
mov ['edx,', '[ebp+var_10]']
mov ['al,', 'byte', 'ptr', '[ebp+var_18]']
mov ['[ecx+edx+3],', 'al']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+54h],', '0']
jz ['short', 'loc_7A9C']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
mov ['edx,', '[ebp+var_10]']
lea ['eax,', '[ecx+edx+4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+58h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+54h]']
mov ['edx,', '[ecx+0Ch]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+arg_8],', '0']
jz ['short', 'loc_7AAA']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[ebp+var_10]']
mov ['[eax],', 'ecx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN13']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '30h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_log_outgoing_packet proc near     
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '58h']
push ['edi']
lea ['edi,', '[ebp+var_58]']
mov ['ecx,', '16h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[eax+14h]']
sub ['edx,', '[ecx+10h]']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
sub ['ecx,', 'edx']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[eax+18h],', '0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+220h],', '0']
jz ['short', 'loc_7BD5']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '10h']
jz ['short', 'loc_7B6F']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '17h']
jnz ['short', 'loc_7BD5']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+8],', '17h']
jnz ['short', 'loc_7B84']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+18h]']
add ['ecx,', '4']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['[ebp+edx+var_3C],', 'ecx']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['[ebp+eax+var_34],', '2']
lea ['ecx,', '[ebp+var_54]']
push ['ecx']
lea ['edx,', '[ebp+var_48]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_48],', '0']
jz ['short', 'loc_7BD5']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_54]']
mov ['[ebp+ecx+var_38],', 'edx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+8],', '9']
jz ['short', 'loc_7BF0']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '29h']
jz ['short', 'loc_7BF0']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '48h']
jnz ['short', 'loc_7C41']
push ['76h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_7C41']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['[ebp+eax+var_3C],', '0']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
mov ['[ebp+ecx+var_38],', 'eax']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['[ebp+ecx+var_34],', '1']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
jmp ['loc_7CDF']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '22h']
jnz ['loc_7CDF']
push ['76h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_7CDF']
mov ['eax,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[eax+18h],', '0']
lea ['ecx,', '[ebp+var_54]']
push ['ecx']
lea ['edx,', '[ebp+var_48]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+18h]']
mov ['[ebp+ecx+var_3C],', 'eax']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['[ebp+ecx+var_34],', '1']
lea ['edx,', '[ebp+var_54]']
push ['edx']
lea ['eax,', '[ebp+var_48]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_48],', '0']
jz ['short', 'loc_7CDF']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+18h]']
sub ['ecx,', '[ebp+edx+var_3C]']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['[ebp+edx+var_38],', 'ecx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
push ['0']
push ['0']
push ['0']
lea ['ecx,', '[ebp+var_3C]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
movzx ['eax,', 'byte', 'ptr', '[edx+0Ch]']
push ['eax']
call ['_ssh1_pkt_type']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
movzx ['eax,', 'byte', 'ptr', '[edx+0Ch]']
push ['eax']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
push ['edx']
call ['_log_packet']
add ['esp,', '2Ch']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[eax+14h]']
sub ['edx,', '[ecx+10h]']
mov ['eax,', '[ebp+arg_4]']
add ['edx,', '[eax]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx],', 'edx']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN16_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '58h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_pkt_type  proc near               
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_0],', '1']
jnz ['short', 'loc_7DBB']
mov ['eax,', 'offset', '$SG87403']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '2']
jnz ['short', 'loc_7DCB']
mov ['eax,', 'offset', '$SG87405']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '3']
jnz ['short', 'loc_7DDB']
mov ['eax,', 'offset', '$SG87407']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '4']
jnz ['short', 'loc_7DEB']
mov ['eax,', 'offset', '$SG87409']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '6']
jnz ['short', 'loc_7DFB']
mov ['eax,', 'offset', '$SG87411']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '7']
jnz ['short', 'loc_7E0B']
mov ['eax,', 'offset', '$SG87413']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '8']
jnz ['short', 'loc_7E1B']
mov ['eax,', 'offset', '$SG87415']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '9']
jnz ['short', 'loc_7E2B']
mov ['eax,', 'offset', '$SG87417']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '0Ah']
jnz ['short', 'loc_7E3B']
mov ['eax,', 'offset', '$SG87419']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '0Bh']
jnz ['short', 'loc_7E4B']
mov ['eax,', 'offset', '$SG87421']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '0Ch']
jnz ['short', 'loc_7E5B']
mov ['eax,', 'offset', '$SG87423']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '0Dh']
jnz ['short', 'loc_7E6B']
mov ['eax,', 'offset', '$SG87425']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '0Eh']
jnz ['short', 'loc_7E7B']
mov ['eax,', 'offset', '$SG87427']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '0Fh']
jnz ['short', 'loc_7E8B']
mov ['eax,', 'offset', '$SG87429']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '10h']
jnz ['short', 'loc_7E9B']
mov ['eax,', 'offset', '$SG87431']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '11h']
jnz ['short', 'loc_7EAB']
mov ['eax,', 'offset', '$SG87433']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '12h']
jnz ['short', 'loc_7EBB']
mov ['eax,', 'offset', '$SG87435']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '13h']
jnz ['short', 'loc_7ECB']
mov ['eax,', 'offset', '$SG87437']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '14h']
jnz ['short', 'loc_7EDB']
mov ['eax,', 'offset', '$SG87439']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '15h']
jnz ['short', 'loc_7EEB']
mov ['eax,', 'offset', '$SG87441']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '16h']
jnz ['short', 'loc_7EFB']
mov ['eax,', 'offset', '$SG87443']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '17h']
jnz ['short', 'loc_7F0B']
mov ['eax,', 'offset', '$SG87445']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '18h']
jnz ['short', 'loc_7F1B']
mov ['eax,', 'offset', '$SG87447']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '19h']
jnz ['short', 'loc_7F2B']
mov ['eax,', 'offset', '$SG87449']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '1Bh']
jnz ['short', 'loc_7F3B']
mov ['eax,', 'offset', '$SG87451']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '1Ch']
jnz ['short', 'loc_7F4B']
mov ['eax,', 'offset', '$SG87453']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '1Dh']
jnz ['short', 'loc_7F5B']
mov ['eax,', 'offset', '$SG87455']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '1Eh']
jnz ['short', 'loc_7F6B']
mov ['eax,', 'offset', '$SG87457']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '1Fh']
jnz ['short', 'loc_7F7B']
mov ['eax,', 'offset', '$SG87459']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '20h']
jnz ['short', 'loc_7F8B']
mov ['eax,', 'offset', '$SG87461']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '21h']
jnz ['short', 'loc_7F9B']
mov ['eax,', 'offset', '$SG87463']
jmp ['loc_8022']
cmp ['[ebp+arg_0],', '22h']
jnz ['short', 'loc_7FA8']
mov ['eax,', 'offset', '$SG87465']
jmp ['short', 'loc_8022']
cmp ['[ebp+arg_0],', '23h']
jnz ['short', 'loc_7FB5']
mov ['eax,', 'offset', '$SG87467']
jmp ['short', 'loc_8022']
cmp ['[ebp+arg_0],', '24h']
jnz ['short', 'loc_7FC2']
mov ['eax,', 'offset', '$SG87469']
jmp ['short', 'loc_8022']
cmp ['[ebp+arg_0],', '25h']
jnz ['short', 'loc_7FCF']
mov ['eax,', 'offset', '$SG87471']
jmp ['short', 'loc_8022']
cmp ['[ebp+arg_0],', '27h']
jnz ['short', 'loc_7FDC']
mov ['eax,', 'offset', '$SG87473']
jmp ['short', 'loc_8022']
cmp ['[ebp+arg_0],', '28h']
jnz ['short', 'loc_7FE9']
mov ['eax,', 'offset', '$SG87475']
jmp ['short', 'loc_8022']
cmp ['[ebp+arg_0],', '29h']
jnz ['short', 'loc_7FF6']
mov ['eax,', 'offset', '$SG87477']
jmp ['short', 'loc_8022']
cmp ['[ebp+arg_0],', '46h']
jnz ['short', 'loc_8003']
mov ['eax,', 'offset', '$SG87479']
jmp ['short', 'loc_8022']
cmp ['[ebp+arg_0],', '47h']
jnz ['short', 'loc_8010']
mov ['eax,', 'offset', '$SG87481']
jmp ['short', 'loc_8022']
cmp ['[ebp+arg_0],', '48h']
jnz ['short', 'loc_801D']
mov ['eax,', 'offset', '$SG87483']
jmp ['short', 'loc_8022']
mov ['eax,', 'offset', '$SG87484']
pop ['ebp']
retn
endp
_s_write        proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+18h],', '0']
jz ['short', 'loc_805C']
push ['0']
push ['0']
push ['0']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['0']
push ['0FFFFFFFFh']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_log_packet']
add ['esp,', '2Ch']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jnz ['short', 'loc_8069']
xor ['eax,', 'eax']
jmp ['short', 'loc_8091']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+8]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_construct_packet proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+Size],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+Str],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+Src],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh1_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
add ['ecx,', '4']
mov ['[ebp+arg_8],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx-4]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['loc_81F0']
mov ['ecx,', '[ebp+var_4]']
mov ['[ebp+var_24],', 'ecx']
mov ['edx,', '[ebp+var_24]']
sub ['edx,', '1']
mov ['[ebp+var_24],', 'edx']
cmp ['[ebp+var_24],', '4']
ja ['loc_81EB']
mov ['eax,', '[ebp+var_24]']
jmp ['ds:$LN12_2[eax*4]']
mov ['ecx,', '[ebp+arg_8]']
add ['ecx,', '4']
mov ['[ebp+arg_8],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx-4]']
mov ['[ebp+var_1C],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
jmp ['loc_81EB']
mov ['eax,', '[ebp+arg_8]']
add ['eax,', '4']
mov ['[ebp+arg_8],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
mov ['dl,', '[ecx-4]']
mov ['byte', 'ptr', '[ebp+var_14+3],', 'dl']
movzx ['eax,', 'byte', 'ptr', '[ebp+var_14+3]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
jmp ['loc_81EB']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '4']
mov ['[ebp+arg_8],', 'edx']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax-4]']
mov ['[ebp+Src],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '4']
mov ['[ebp+arg_8],', 'edx']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax-4]']
mov ['[ebp+Size],', 'ecx']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
jmp ['short', 'loc_81EB']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '4']
mov ['[ebp+arg_8],', 'edx']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax-4]']
mov ['[ebp+Str],', 'ecx']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
jmp ['short', 'loc_81EB']
mov ['ecx,', '[ebp+arg_8]']
add ['ecx,', '4']
mov ['[ebp+arg_8],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx-4]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_ssh1_pkt_addmp']
add ['esp,', '8']
jmp ['loc_80DD']
mov ['eax,', '[ebp+var_C]']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_pkt_ensure proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1Ch]']
cmp ['ecx,', '[ebp+arg_4]']
jge ['short', 'loc_82AA']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_825B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
sub ['edx,', '[ecx+10h]']
mov ['[ebp+var_C],', 'edx']
jmp ['short', 'loc_8262']
mov ['[ebp+var_C],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '100h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1Ch],', 'ecx']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10h],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_82AA']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
add ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+14h],', 'eax']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_pkt_adddata proc near              
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
add ['ecx,', '[ebp+Size]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_pkt_ensure']
add ['esp,', '8']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
mov ['ecx,', '[ebp+arg_0]']
add ['eax,', '[ecx]']
sub ['eax,', '[ebp+Size]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_pkt_addbyte proc near              
push ['ebp']
mov ['ebp,', 'esp']
push ['1']
lea ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_pkt_adduint32 proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+Src],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
shr ['eax,', '18h']
mov ['byte', 'ptr', '[ebp+Src],', 'al']
mov ['ecx,', '[ebp+arg_4]']
shr ['ecx,', '10h']
mov ['byte', 'ptr', '[ebp+Src+1],', 'cl']
mov ['edx,', '[ebp+arg_4]']
shr ['edx,', '8']
mov ['byte', 'ptr', '[ebp+Src+2],', 'dl']
mov ['al,', 'byte', 'ptr', '[ebp+arg_4]']
mov ['byte', 'ptr', '[ebp+Src+3],', 'al']
push ['4']
lea ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_pkt_addstring proc near            
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_pkt_addstring_start proc near      
push ['ebp']
mov ['ebp,', 'esp']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
mov ['[ecx+18h],', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_pkt_addstring_str proc near        
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+18h]']
sar ['edx,', '18h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+18h]']
mov ['[ecx+eax-4],', 'dl']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx]']
sub ['eax,', '[edx+18h]']
sar ['eax,', '10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+18h]']
mov ['[edx+ecx-3],', 'al']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx]']
sub ['ecx,', '[eax+18h]']
sar ['ecx,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+18h]']
mov ['[eax+edx-2],', 'cl']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+18h]']
mov ['[ecx+eax-1],', 'dl']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh1_pkt_addmp proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+Src],', '0CCCCCCCCh']
mov ['[ebp+Size],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh1_bignum_length']
add ['esp,', '4']
mov ['[ebp+Size],', 'eax']
push ['1']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Src],', 'eax']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
call ['_ssh1_write_bignum']
add ['esp,', '8']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_pkt_init  proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
call ['_ssh_new_packet']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0Ch']
movzx ['ecx,', 'byte', 'ptr', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
mov ['edx,', '[ebp+var_4]']
add ['ecx,', '[edx]']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+14h],', 'ecx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['[ecx+8],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+24h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+28h],', '0']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_new_packet proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['2Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+10h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+14h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+1Ch],', '0']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_init  proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
call ['_ssh_new_packet']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '5']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_0]']
mov ['[edx+8],', 'eax']
movzx ['ecx,', 'byte', 'ptr', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
mov ['edx,', '[ebp+var_4]']
add ['ecx,', '[edx]']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+14h],', 'ecx']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+24h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+28h],', '0']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_send  proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+138h],', '0']
jz ['short', 'loc_8699']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_queue']
add ['esp,', '8']
jmp ['short', 'loc_86A9']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send_noqueue']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh2_pkt_send_noqueue proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+60h],', '0']
jz ['short', 'loc_8706']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+60h]']
mov ['eax,', '[edx+24h]']
and ['eax,', '1']
jz ['short', 'loc_8706']
push ['0']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_defer_noqueue']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_pkt_defersend']
add ['esp,', '4']
jmp ['loc_87BF']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_construct']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_s_write']
add ['esp,', '0Ch']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '8000h']
jle ['short', 'loc_874E']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_throttle_all']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+65Ch]']
mov ['edx,', '[ebp+arg_4]']
add ['ecx,', '[edx+20h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+65Ch],', 'ecx']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+668h],', '0']
jnz ['short', 'loc_87B3']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0C4h],', '0']
jnz ['short', 'loc_87B3']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+664h],', '0']
jz ['short', 'loc_87B3']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+65Ch]']
cmp ['eax,', '[edx+664h]']
jbe ['short', 'loc_87B3']
push ['0']
push ['0FFFFFFFFh']
push ['offset', '$SG89049']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_do_ssh2_transport']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_free_packet']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_construct proc near           
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '34h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_34]']
mov ['ecx,', '0Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+18h],', '0']
jz ['short', 'loc_8808']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_log_outgoing_packet']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0C4h],', '0']
jz ['short', 'loc_8892']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
sub ['edx,', '5']
sar ['edx,', '18h']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
mov ['[ecx+1],', 'dl']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
sub ['eax,', '5']
sar ['eax,', '10h']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
mov ['[edx+2],', 'al']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
sub ['ecx,', '5']
sar ['ecx,', '8']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+10h]']
mov ['[eax+3],', 'cl']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
sub ['edx,', '5']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
mov ['[ecx+4],', 'dl']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+10h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+180h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+180h],', 'eax']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
sub ['eax,', '1']
jmp ['loc_8B31']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+80h],', '0']
jz ['short', 'loc_890A']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+Size]']
push ['ecx']
lea ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
sub ['ecx,', '5']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+10h]']
add ['eax,', '5']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+88h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+80h]']
mov ['edx,', '[ecx+10h]']
call ['edx']
add ['esp,', '14h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_890A']
mov ['eax,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[eax],', '5']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+60h],', '0']
jz ['short', 'loc_8921']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+60h]']
mov ['edx,', '[ecx+1Ch]']
mov ['[ebp+var_2C],', 'edx']
jmp ['short', 'loc_8928']
mov ['[ebp+var_2C],', '8']
mov ['eax,', '[ebp+var_2C]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '8']
jge ['short', 'loc_893D']
mov ['[ebp+var_30],', '8']
jmp ['short', 'loc_8943']
mov ['ecx,', '[ebp+var_4]']
mov ['[ebp+var_30],', 'ecx']
mov ['edx,', '[ebp+var_30]']
mov ['[ebp+var_4],', 'edx']
mov ['[ebp+var_C],', '4']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
add ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+arg_4]']
cmp ['ecx,', '[edx+4]']
jge ['short', 'loc_896E']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[eax+4]']
sub ['edx,', '[ecx]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+arg_4]']
mov ['eax,', '[eax]']
add ['eax,', '[ebp+var_C]']
cdq
idiv ['[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
sub ['eax,', 'edx']
cdq
idiv ['[ebp+var_4]']
add ['edx,', '[ebp+var_C]']
mov ['[ebp+var_C],', 'edx']
cmp ['[ebp+var_C],', '0FFh']
jle ['short', 'loc_89A9']
push ['887h']
push ['offset', '$SG89020']
push ['offset', '$SG89021']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+70h],', '0']
jz ['short', 'loc_89C0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
mov ['edx,', '[ecx+28h]']
mov ['[ebp+var_34],', 'edx']
jmp ['short', 'loc_89C7']
mov ['[ebp+var_34],', '0']
mov ['eax,', '[ebp+var_34]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
add ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_ensure']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
mov ['al,', 'byte', 'ptr', '[ebp+var_C]']
mov ['[edx+4],', 'al']
mov ['[ebp+var_10],', '0']
jmp ['short', 'loc_8A03']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '1']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_10]']
cmp ['edx,', '[ebp+var_C]']
jge ['short', 'loc_8A23']
call ['_random_byte']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
add ['edx,', '[ebp+var_10]']
mov ['ecx,', '[ebp+arg_4]']
mov ['ecx,', '[ecx+10h]']
mov ['[edx+ecx],', 'al']
jmp ['short', 'loc_89FA']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_C]']
lea ['edx,', '[eax+ecx-4]']
sar ['edx,', '18h']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
mov ['[ecx],', 'dl']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_C]']
lea ['edx,', '[eax+ecx-4]']
sar ['edx,', '10h']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
mov ['[ecx+1],', 'dl']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_C]']
lea ['edx,', '[eax+ecx-4]']
sar ['edx,', '8']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
mov ['[ecx+2],', 'dl']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_C]']
lea ['edx,', '[eax+ecx-4]']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
mov ['[ecx+3],', 'dl']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+70h],', '0']
jz ['short', 'loc_8AC0']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+180h]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
add ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+78h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
mov ['ecx,', '[eax+0Ch]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+180h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+180h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+60h],', '0']
jz ['short', 'loc_8B0C']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
add ['ecx,', '[ebp+var_C]']
mov ['esi,', 'esp']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+10h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+68h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+60h]']
mov ['edx,', '[ecx+10h]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
add ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx+20h],', 'ecx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+10h]']
mov ['[eax+14h],', 'edx']
mov ['eax,', '[ebp+arg_4]']
mov ['eax,', '[eax]']
add ['eax,', '[ebp+var_C]']
add ['eax,', '[ebp+var_8]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN22']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '34h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_log_outgoing_packet proc near     
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '58h']
push ['edi']
lea ['edi,', '[ebp+var_58]']
mov ['ecx,', '16h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[eax+14h]']
sub ['edx,', '[ecx+10h]']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
sub ['ecx,', 'edx']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[eax+18h],', '0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+220h],', '0']
jz ['loc_8C65']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '5Eh']
jz ['short', 'loc_8BF3']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '5Fh']
jnz ['short', 'loc_8C65']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '5Fh']
jnz ['short', 'loc_8C14']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+18h]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['[ebp+eax+var_3C],', 'edx']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['[ebp+ecx+var_34],', '2']
lea ['edx,', '[ebp+var_54]']
push ['edx']
lea ['eax,', '[ebp+Buf1]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf1],', '0']
jz ['short', 'loc_8C65']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_54]']
mov ['[ebp+edx+var_38],', 'eax']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '32h']
jnz ['loc_8D9C']
push ['76h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_8D9C']
mov ['edx,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[edx+18h],', '0']
lea ['eax,', '[ebp+var_54]']
push ['eax']
lea ['ecx,', '[ebp+Buf1]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
lea ['eax,', '[ebp+var_54]']
push ['eax']
lea ['ecx,', '[ebp+Buf1]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
lea ['eax,', '[ebp+var_54]']
push ['eax']
lea ['ecx,', '[ebp+Buf1]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_54],', '8']
jnz ['loc_8D97']
push ['8']
push ['offset', '$SG88466']
mov ['eax,', '[ebp+Buf1]']
push ['eax']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_8D97']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+18h]']
mov ['[ebp+edx+var_3C],', 'ecx']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['[ebp+edx+var_34],', '1']
lea ['eax,', '[ebp+var_54]']
push ['eax']
lea ['ecx,', '[ebp+Buf1]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf1],', '0']
jz ['short', 'loc_8D97']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+18h]']
sub ['edx,', '[ebp+eax+var_3C]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['[ebp+eax+var_38],', 'edx']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
lea ['edx,', '[ebp+var_54]']
push ['edx']
lea ['eax,', '[ebp+Buf1]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf1],', '0']
jz ['short', 'loc_8D97']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+18h]']
sub ['ecx,', '[ebp+edx+var_3C]']
mov ['edx,', '[ebp+var_8]']
sub ['edx,', '1']
imul ['edx,', '0Ch']
mov ['[ebp+edx+var_38],', 'ecx']
jmp ['loc_8F57']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+15Ch],', '4']
jnz ['loc_8E58']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+8],', '3Dh']
jnz ['loc_8E58']
push ['76h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_8E58']
mov ['ecx,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[ecx+18h],', '0']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+18h]']
mov ['[ebp+eax+var_3C],', 'edx']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['[ebp+eax+var_34],', '1']
mov ['ecx,', '1']
test ['ecx,', 'ecx']
jz ['short', 'loc_8E30']
lea ['edx,', '[ebp+var_54]']
push ['edx']
lea ['eax,', '[ebp+Buf1]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf1],', '0']
jnz ['short', 'loc_8E2E']
jmp ['short', 'loc_8E30']
jmp ['short', 'loc_8E09']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+18h]']
sub ['ecx,', '[ebp+edx+var_3C]']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['[ebp+edx+var_38],', 'ecx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
jmp ['loc_8F57']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+8],', '62h']
jnz ['loc_8F57']
push ['76h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_8F57']
mov ['ecx,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[ecx+18h],', '0']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
lea ['eax,', '[ebp+var_54]']
push ['eax']
lea ['ecx,', '[ebp+Buf1]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_54],', '7']
jnz ['loc_8F57']
push ['0']
push ['offset', '$SG88478']
mov ['eax,', '[ebp+Buf1]']
push ['eax']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_8F57']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
lea ['eax,', '[ebp+var_54]']
push ['eax']
lea ['ecx,', '[ebp+Buf1]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+18h]']
mov ['[ebp+eax+var_3C],', 'edx']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['[ebp+eax+var_34],', '1']
lea ['ecx,', '[ebp+var_54]']
push ['ecx']
lea ['edx,', '[ebp+Buf1]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf1],', '0']
jz ['short', 'loc_8F57']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+18h]']
sub ['eax,', '[ebp+ecx+var_3C]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['[ebp+ecx+var_38],', 'eax']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+24h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '180h']
push ['ecx']
lea ['edx,', '[ebp+var_3C]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+10h]']
movzx ['ecx,', 'byte', 'ptr', '[eax+5]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+15Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+158h]']
push ['edx']
call ['_ssh2_pkt_type']
add ['esp,', '0Ch']
push ['eax']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+5]']
push ['edx']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_log_packet']
add ['esp,', '2Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[edx+14h]']
sub ['ecx,', '[eax+10h]']
mov ['edx,', '[ebp+arg_4]']
add ['ecx,', '[edx]']
mov ['eax,', '[ebp+arg_4]']
mov ['[eax],', 'ecx']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN24']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '58h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_type  proc near               
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_8],', '3Ch']
jnz ['short', 'loc_9061']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_9061']
mov ['eax,', 'offset', '$SG87494']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '3Dh']
jnz ['short', 'loc_9077']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_9077']
mov ['eax,', 'offset', '$SG87496']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '3Fh']
jnz ['short', 'loc_908D']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_908D']
mov ['eax,', 'offset', '$SG87498']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '40h']
jnz ['short', 'loc_90A3']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_90A3']
mov ['eax,', 'offset', '$SG87500']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '41h']
jnz ['short', 'loc_90B9']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_90B9']
mov ['eax,', 'offset', '$SG87502']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '42h']
jnz ['short', 'loc_90CF']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_90CF']
mov ['eax,', 'offset', '$SG87504']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '1']
jnz ['short', 'loc_90DF']
mov ['eax,', 'offset', '$SG87506']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '2']
jnz ['short', 'loc_90EF']
mov ['eax,', 'offset', '$SG87508']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '3']
jnz ['short', 'loc_90FF']
mov ['eax,', 'offset', '$SG87510']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '4']
jnz ['short', 'loc_910F']
mov ['eax,', 'offset', '$SG87512']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '5']
jnz ['short', 'loc_911F']
mov ['eax,', 'offset', '$SG87514']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '6']
jnz ['short', 'loc_912F']
mov ['eax,', 'offset', '$SG87516']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '14h']
jnz ['short', 'loc_913F']
mov ['eax,', 'offset', '$SG87518']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '15h']
jnz ['short', 'loc_914F']
mov ['eax,', 'offset', '$SG87520']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '1Eh']
jnz ['short', 'loc_9165']
cmp ['[ebp+arg_0],', '1']
jnz ['short', 'loc_9165']
mov ['eax,', 'offset', '$SG87522']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '1Fh']
jnz ['short', 'loc_917B']
cmp ['[ebp+arg_0],', '1']
jnz ['short', 'loc_917B']
mov ['eax,', 'offset', '$SG87524']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '1Eh']
jnz ['short', 'loc_9191']
cmp ['[ebp+arg_0],', '2']
jnz ['short', 'loc_9191']
mov ['eax,', 'offset', '$SG87526']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '1Fh']
jnz ['short', 'loc_91A7']
cmp ['[ebp+arg_0],', '2']
jnz ['short', 'loc_91A7']
mov ['eax,', 'offset', '$SG87528']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '20h']
jnz ['short', 'loc_91BD']
cmp ['[ebp+arg_0],', '2']
jnz ['short', 'loc_91BD']
mov ['eax,', 'offset', '$SG87530']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '21h']
jnz ['short', 'loc_91D3']
cmp ['[ebp+arg_0],', '2']
jnz ['short', 'loc_91D3']
mov ['eax,', 'offset', '$SG87532']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '1Eh']
jnz ['short', 'loc_91E9']
cmp ['[ebp+arg_0],', '3']
jnz ['short', 'loc_91E9']
mov ['eax,', 'offset', '$SG87534']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '1Fh']
jnz ['short', 'loc_91FF']
cmp ['[ebp+arg_0],', '3']
jnz ['short', 'loc_91FF']
mov ['eax,', 'offset', '$SG87536']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '20h']
jnz ['short', 'loc_9215']
cmp ['[ebp+arg_0],', '3']
jnz ['short', 'loc_9215']
mov ['eax,', 'offset', '$SG87538']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '32h']
jnz ['short', 'loc_9225']
mov ['eax,', 'offset', '$SG87540']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '33h']
jnz ['short', 'loc_9235']
mov ['eax,', 'offset', '$SG87542']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '34h']
jnz ['short', 'loc_9245']
mov ['eax,', 'offset', '$SG87544']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '35h']
jnz ['short', 'loc_9255']
mov ['eax,', 'offset', '$SG87546']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '3Ch']
jnz ['short', 'loc_926B']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_926B']
mov ['eax,', 'offset', '$SG87548']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '3Ch']
jnz ['short', 'loc_9281']
cmp ['[ebp+arg_4],', '2']
jnz ['short', 'loc_9281']
mov ['eax,', 'offset', '$SG87550']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '3Ch']
jnz ['short', 'loc_9297']
cmp ['[ebp+arg_4],', '4']
jnz ['short', 'loc_9297']
mov ['eax,', 'offset', '$SG87552']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '3Dh']
jnz ['short', 'loc_92AD']
cmp ['[ebp+arg_4],', '4']
jnz ['short', 'loc_92AD']
mov ['eax,', 'offset', '$SG87554']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '50h']
jnz ['short', 'loc_92BD']
mov ['eax,', 'offset', '$SG87556']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '51h']
jnz ['short', 'loc_92CD']
mov ['eax,', 'offset', '$SG87558']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '52h']
jnz ['short', 'loc_92DD']
mov ['eax,', 'offset', '$SG87560']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '5Ah']
jnz ['short', 'loc_92ED']
mov ['eax,', 'offset', '$SG87562']
jmp ['loc_9374']
cmp ['[ebp+arg_8],', '5Bh']
jnz ['short', 'loc_92FA']
mov ['eax,', 'offset', '$SG87564']
jmp ['short', 'loc_9374']
cmp ['[ebp+arg_8],', '5Ch']
jnz ['short', 'loc_9307']
mov ['eax,', 'offset', '$SG87566']
jmp ['short', 'loc_9374']
cmp ['[ebp+arg_8],', '5Dh']
jnz ['short', 'loc_9314']
mov ['eax,', 'offset', '$SG87568']
jmp ['short', 'loc_9374']
cmp ['[ebp+arg_8],', '5Eh']
jnz ['short', 'loc_9321']
mov ['eax,', 'offset', '$SG87570']
jmp ['short', 'loc_9374']
cmp ['[ebp+arg_8],', '5Fh']
jnz ['short', 'loc_932E']
mov ['eax,', 'offset', '$SG87572']
jmp ['short', 'loc_9374']
cmp ['[ebp+arg_8],', '60h']
jnz ['short', 'loc_933B']
mov ['eax,', 'offset', '$SG87574']
jmp ['short', 'loc_9374']
cmp ['[ebp+arg_8],', '61h']
jnz ['short', 'loc_9348']
mov ['eax,', 'offset', '$SG87576']
jmp ['short', 'loc_9374']
cmp ['[ebp+arg_8],', '62h']
jnz ['short', 'loc_9355']
mov ['eax,', 'offset', '$SG87578']
jmp ['short', 'loc_9374']
cmp ['[ebp+arg_8],', '63h']
jnz ['short', 'loc_9362']
mov ['eax,', 'offset', '$SG87580']
jmp ['short', 'loc_9374']
cmp ['[ebp+arg_8],', '64h']
jnz ['short', 'loc_936F']
mov ['eax,', 'offset', '$SG87582']
jmp ['short', 'loc_9374']
mov ['eax,', 'offset', '$SG87583']
pop ['ebp']
retn
endp
_ssh2_pkt_defer_noqueue proc near       
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+Size],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+60h],', '0']
jz ['short', 'loc_93ED']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+60h]']
mov ['eax,', '[edx+24h]']
and ['eax,', '1']
jz ['short', 'loc_93ED']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+140h],', '0']
jnz ['short', 'loc_93ED']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_93ED']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
and ['eax,', '200h']
jnz ['short', 'loc_93ED']
push ['2']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
push ['1']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_defer_noqueue']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_construct']
add ['esp,', '8']
mov ['[ebp+Size],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+140h]']
add ['ecx,', '[ebp+Size]']
mov ['edx,', '[ebp+arg_0]']
cmp ['ecx,', '[edx+144h]']
jle ['short', 'loc_945A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+140h]']
mov ['edx,', '[ebp+Size]']
lea ['eax,', '[ecx+edx+80h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+144h],', 'eax']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+144h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+13Ch]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+13Ch],', 'eax']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+13Ch]']
mov ['ecx,', '[ebp+arg_0]']
add ['eax,', '[ecx+140h]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+140h]']
add ['eax,', '[ebp+Size]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+140h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+660h]']
mov ['ecx,', '[ebp+arg_4]']
add ['eax,', '[ecx+20h]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+660h],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_free_packet']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_queue proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+138h],', '0']
jnz ['short', 'loc_94EE']
push ['906h']
push ['offset', '$SG89072']
push ['offset', '$SG89073']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+130h]']
cmp ['ecx,', '[eax+134h]']
jl ['short', 'loc_953E']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+130h]']
add ['eax,', '20h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+134h],', 'eax']
push ['4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+134h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+12Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+130h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[edx+eax*4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+130h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+130h],', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_pkt_defersend proc near            
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+140h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+13Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_s_write']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+144h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+140h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+13Ch]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+13Ch],', '0']
cmp ['[ebp+var_4],', '8000h']
jle ['short', 'loc_95FA']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_throttle_all']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+65Ch]']
mov ['edx,', '[ebp+arg_0]']
add ['ecx,', '[edx+660h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+65Ch],', 'ecx']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+668h],', '0']
jnz ['short', 'loc_9662']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0C4h],', '0']
jnz ['short', 'loc_9662']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+664h],', '0']
jz ['short', 'loc_9662']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+65Ch]']
cmp ['eax,', '[edx+664h]']
jbe ['short', 'loc_9662']
push ['0']
push ['0FFFFFFFFh']
push ['offset', '$SG89101']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_do_ssh2_transport']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+660h],', '0']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_pkt_getuint32 proc near            
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+18h]']
cmp ['edx,', '4']
jge ['short', 'loc_96A7']
xor ['eax,', 'eax']
jmp ['short', 'loc_970E']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
movzx ['ecx,', 'byte', 'ptr', '[ecx+eax]']
shl ['ecx,', '18h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+18h]']
movzx ['eax,', 'byte', 'ptr', '[eax+edx+1]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+18h]']
movzx ['eax,', 'byte', 'ptr', '[eax+edx+2]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+18h]']
movzx ['eax,', 'byte', 'ptr', '[eax+edx+3]']
or ['ecx,', 'eax']
mov ['[ebp+var_4],', 'ecx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
add ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+18h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_getbool proc near             
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+18h]']
cmp ['edx,', '1']
jge ['short', 'loc_9737']
xor ['eax,', 'eax']
jmp ['short', 'loc_9762']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
movzx ['ecx,', 'byte', 'ptr', '[ecx+eax]']
neg ['ecx']
sbb ['ecx,', 'ecx']
neg ['ecx']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+18h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_pkt_getstring proc near            
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+arg_8]']
mov ['dword', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx]']
sub ['ecx,', '[eax+18h]']
cmp ['ecx,', '4']
jge ['short', 'loc_979A']
jmp ['loc_984D']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
movzx ['eax,', 'byte', 'ptr', '[eax+edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+18h]']
movzx ['edx,', 'byte', 'ptr', '[edx+ecx+1]']
shl ['edx,', '10h']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+18h]']
movzx ['edx,', 'byte', 'ptr', '[edx+ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+18h]']
movzx ['edx,', 'byte', 'ptr', '[edx+ecx+3]']
or ['eax,', 'edx']
push ['eax']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jge ['short', 'loc_9800']
jmp ['short', 'loc_984D']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
add ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+18h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx]']
sub ['ecx,', '[eax+18h]']
mov ['edx,', '[ebp+arg_8]']
cmp ['ecx,', '[edx]']
jge ['short', 'loc_982B']
jmp ['short', 'loc_984D']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[ebp+arg_0]']
add ['ecx,', '[edx+18h]']
mov ['eax,', '[ebp+arg_4]']
mov ['[eax],', 'ecx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+arg_8]']
add ['edx,', '[eax]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+18h],', 'edx']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sshfwd_unclean_close proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+118h],', '4']
jnz ['short', 'loc_9895']
jmp ['loc_991C']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['[ebp+var_8],', 'ecx']
cmp ['[ebp+var_8],', '1']
jz ['short', 'loc_98B2']
cmp ['[ebp+var_8],', '2']
jle ['short', 'loc_98FC']
cmp ['[ebp+var_8],', '4']
jle ['short', 'loc_98D8']
jmp ['short', 'loc_98FC']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_x11_close']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
push ['offset', '$SG90749']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
jmp ['short', 'loc_98FC']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_pfd_close']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['offset', '$SG90751']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0Ch],', '6']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+18h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_channel_check_close']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sshfwd_write   proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+118h],', '4']
jnz ['short', 'loc_995B']
xor ['eax,', 'eax']
jmp ['short', 'loc_99B6']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+16Ch],', '1']
jnz ['short', 'loc_9996']
push ['0']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['3']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
push ['1']
push ['17h']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_send_packet']
add ['esp,', '28h']
xor ['eax,', 'eax']
jmp ['short', 'loc_99B6']
jmp ['short', 'loc_99B6']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_add_channel_data']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_try_send']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sshfwd_unthrottle proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+118h],', '4']
jnz ['short', 'loc_99F9']
jmp ['short', 'loc_9A6A']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+16Ch],', '1']
jnz ['short', 'loc_9A0E']
mov ['[ebp+var_8],', '8000h']
jmp ['short', 'loc_9A41']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+38h]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[ebp+var_8]']
jge ['short', 'loc_9A2A']
mov ['ecx,', '[ebp+var_8]']
sub ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_C],', 'ecx']
jmp ['short', 'loc_9A31']
mov ['[ebp+var_C],', '0']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_set_window']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1Ch],', '0']
jz ['short', 'loc_9A6A']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ebp+var_8]']
jg ['short', 'loc_9A6A']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+1Ch],', '0']
push ['0FFFFFFFFh']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_throttle_conn']
add ['esp,', '8']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_throttle_conn proc near            
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+170h]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+170h]']
add ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+170h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+170h],', '0']
jge ['short', 'loc_9AC7']
push ['0DDFh']
push ['offset', '$SG89891']
push ['offset', '$SG89892']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+170h],', '0']
jz ['short', 'loc_9AE9']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_9AE9']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
jmp ['short', 'loc_9B09']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+170h],', '0']
jnz ['short', 'loc_9B09']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_9B09']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_set_frozen']
add ['esp,', '8']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_set_frozen proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10h],', '0']
jz ['short', 'loc_9B49']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+18h]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+234h],', 'eax']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_alloc_sharing_rportfwd proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['1Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0Ch],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_C]']
mov ['[edx+14h],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+8],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+110h],', '0']
jnz ['short', 'loc_9C08']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '2']
jz ['short', 'loc_9BF2']
push ['1353h']
push ['offset', '$SG90857']
push ['offset', '$SG90858']
call ['__wassert']
add ['esp,', '0Ch']
push ['offset', '_ssh_rportcmp_ssh2']
call ['_newtree234']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+110h],', 'eax']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+110h]']
push ['ecx']
call ['_add234']
add ['esp,', '8']
cmp ['eax,', '[ebp+var_4]']
jz ['short', 'loc_9C42']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
xor ['eax,', 'eax']
jmp ['short', 'loc_9C47']
mov ['eax,', '1']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_rportcmp_ssh2 proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_9CAD']
xor ['eax,', 'eax']
cmp ['[ebp+var_C],', '0']
setnl ['al']
lea ['eax,', '[eax+eax-1]']
jmp ['short', 'loc_9CD3']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[eax]']
cmp ['edx,', '[ecx]']
jbe ['short', 'loc_9CC0']
mov ['eax,', '1']
jmp ['short', 'loc_9CD3']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[eax]']
cmp ['edx,', '[ecx]']
jnb ['short', 'loc_9CD1']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_9CD3']
xor ['eax,', 'eax']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_sharing_queue_global_request proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['offset', '_ssh_sharing_global_request_response']
push ['52h']
push ['51h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_queue_handler']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_queue_handler proc near            
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['14h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_8]']
mov ['[edx+4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_C]']
mov ['[ecx+8],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_10]']
mov ['[eax+0Ch],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+648h],', '0']
jnz ['loc_9DF2']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx+644h],', 'edx']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax],', '0']
jle ['short', 'loc_9DB4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+644h]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+eax*4+244h]']
mov ['[ecx+64Ch],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx]']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+edx*4+244h],', 'offset', '_ssh_queueing_handler']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jle ['short', 'loc_9DF0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+644h]']
mov ['ecx,', '[eax+4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+ecx*4+244h]']
mov ['[edx+650h],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+eax*4+244h],', 'offset', '_ssh_queueing_handler']
jmp ['short', 'loc_9E01']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+648h]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+10h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+648h],', 'eax']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_queueing_handler proc near         
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+644h]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_9E5D']
push ['12F7h']
push ['offset', '$SG90783']
push ['offset', '$SG90784']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+8]']
cmp ['edx,', '[ecx]']
jz ['short', 'loc_9E8F']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+8]']
cmp ['edx,', '[ecx+4]']
jz ['short', 'loc_9E8F']
push ['12F9h']
push ['offset', '$SG90786']
push ['offset', '$SG90787']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx],', '0']
jle ['short', 'loc_9EDB']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+eax*4+244h],', 'offset', '_ssh_queueing_handler']
jz ['short', 'loc_9EC3']
push ['12FCh']
push ['offset', '$SG90790']
push ['offset', '$SG90791']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+64Ch]']
mov ['[edx+ecx*4+244h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jle ['short', 'loc_9F2A']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+eax*4+244h],', 'offset', '_ssh_queueing_handler']
jz ['short', 'loc_9F11']
push ['1300h']
push ['offset', '$SG90794']
push ['offset', '$SG90795']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+650h]']
mov ['[edx+ecx*4+244h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jz ['loc_9FD5']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
mov ['[edx+644h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+644h]']
cmp ['dword', 'ptr', '[eax],', '0']
jle ['short', 'loc_9F8B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+644h]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+eax*4+244h]']
mov ['[ecx+64Ch],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+644h]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+eax*4+244h],', 'offset', '_ssh_queueing_handler']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+644h]']
cmp ['dword', 'ptr', '[eax+4],', '0']
jle ['short', 'loc_9FD3']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+644h]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+eax*4+244h]']
mov ['[ecx+650h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+644h]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+eax*4+244h],', 'offset', '_ssh_queueing_handler']
jmp ['short', 'loc_9FEF']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+648h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+644h],', '0']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_sharing_global_request_response proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_agent_forwarding_permitted proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['1Bh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_A09D']
call ['_agent_exists']
test ['eax,', 'eax']
jz ['short', 'loc_A09D']
mov ['[ebp+var_4],', '1']
jmp ['short', 'loc_A0A4']
mov ['[ebp+var_4],', '0']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_ssh2_transport proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '160h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_160]']
mov ['ecx,', '58h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1A0h],', '0']
jnz ['short', 'loc_A127']
push ['0FCh']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_140],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_140]']
mov ['[edx+1A0h],', 'eax']
mov ['ecx,', '[ebp+var_140]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1A0h]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0C4h],', '0']
jz ['short', 'loc_A156']
push ['17A8h']
push ['offset', '$SG91548']
push ['offset', '$SG91549']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx]']
mov ['[ebp+var_144],', 'eax']
cmp ['[ebp+var_144],', '19C6h']
jg ['loc_A1FA']
cmp ['[ebp+var_144],', '19C6h']
jz ['loc_BA66']
cmp ['[ebp+var_144],', '1976h']
jg ['short', 'loc_A1D5']
cmp ['[ebp+var_144],', '1976h']
jz ['loc_B77F']
cmp ['[ebp+var_144],', '0']
jz ['loc_A270']
cmp ['[ebp+var_144],', '1884h']
jz ['loc_ABAD']
cmp ['[ebp+var_144],', '195Dh']
jz ['loc_B680']
jmp ['loc_D14C']
cmp ['[ebp+var_144],', '198Fh']
jz ['loc_B87E']
cmp ['[ebp+var_144],', '19A1h']
jz ['loc_B92F']
jmp ['loc_D14C']
cmp ['[ebp+var_144],', '1AA5h']
jg ['short', 'loc_A24B']
cmp ['[ebp+var_144],', '1AA5h']
jz ['loc_C680']
cmp ['[ebp+var_144],', '19E9h']
jz ['loc_BC55']
cmp ['[ebp+var_144],', '1A1Ch']
jz ['loc_BF51']
cmp ['[ebp+var_144],', '1A6Eh']
jz ['loc_C37E']
jmp ['loc_D14C']
cmp ['[ebp+var_144],', '1B1Ah']
jz ['loc_CB9E']
cmp ['[ebp+var_144],', '1B83h']
jz ['loc_D021']
jmp ['loc_D14C']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+48h],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+44h],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+50h],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+4Ch],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+58h],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+54h],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+0E8h],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+0E4h],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+0DCh],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+0E0h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
and ['eax,', '2']
jz ['short', 'loc_A301']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+3Ch],', 'offset', '_buggymacs']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+40h],', '3']
jmp ['short', '$begin_key_exchange$91561']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+3Ch],', 'offset', '_macs']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+40h],', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+158h],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+0A4h],', '0']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_A341']
mov ['ecx,', '[ebp+var_14]']
add ['ecx,', '1']
mov ['[ebp+var_14],', 'ecx']
cmp ['[ebp+var_14],', '5']
jge ['loc_A478']
mov ['edx,', '[ebp+var_14]']
push ['edx']
push ['17h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['[ebp+var_148],', 'eax']
cmp ['[ebp+var_148],', '4']
ja ['loc_A473']
mov ['edx,', '[ebp+var_148]']
jmp ['ds:$LN435[edx*4]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+ecx*4+0A8h],', 'offset', '_ssh_diffiehellman_gex']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+0A4h],', 'ecx']
jmp ['loc_A473']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+ecx*4+0A8h],', 'offset', '_ssh_diffiehellman_group14']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+0A4h],', 'ecx']
jmp ['loc_A473']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+ecx*4+0A8h],', 'offset', '_ssh_diffiehellman_group1']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+0A4h],', 'ecx']
jmp ['short', 'loc_A473']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+ecx*4+0A8h],', 'offset', '_ssh_rsa_kex']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+0A4h],', 'ecx']
jmp ['short', 'loc_A473']
cmp ['[ebp+var_14],', '4']
jge ['short', 'loc_A473']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+ecx*4+0A8h],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0A4h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+0A4h],', 'ecx']
jmp ['loc_A338']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+0BCh],', '0']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_A497']
mov ['ecx,', '[ebp+var_14]']
add ['ecx,', '1']
mov ['[ebp+var_14],', 'ecx']
cmp ['[ebp+var_14],', '6']
jge ['loc_A617']
mov ['edx,', '[ebp+var_14]']
push ['edx']
push ['1Dh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['[ebp+var_14C],', 'eax']
cmp ['[ebp+var_14C],', '5']
ja ['loc_A612']
mov ['edx,', '[ebp+var_14C]']
jmp ['ds:$LN436[edx*4]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0BCh]']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+ecx*4+0C0h],', 'offset', '_ssh2_blowfish']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0BCh]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+0BCh],', 'ecx']
jmp ['loc_A612']
push ['20h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_A54E']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+eax*4+0C0h],', 'offset', '_ssh2_des']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0BCh],', 'eax']
jmp ['loc_A612']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+eax*4+0C0h],', 'offset', '_ssh2_3des']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0BCh],', 'eax']
jmp ['loc_A612']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+eax*4+0C0h],', 'offset', '_ssh2_aes']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0BCh],', 'eax']
jmp ['short', 'loc_A612']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+eax*4+0C0h],', 'offset', '_ssh2_arcfour']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0BCh],', 'eax']
jmp ['short', 'loc_A612']
cmp ['[ebp+var_14],', '5']
jge ['short', 'loc_A612']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+eax*4+0C0h],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0BCh]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0BCh],', 'eax']
jmp ['loc_A48E']
push ['16h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_A63E']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+0D8h],', 'offset', '_ssh_zlib']
jmp ['short', 'loc_A64B']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+0D8h],', 'offset', '_ssh_comp_none']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+138h],', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+668h],', '1']
push ['14h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+0ECh],', 'eax']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_A68A']
mov ['eax,', '[ebp+var_14]']
add ['eax,', '1']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '10h']
jge ['short', 'loc_A6AA']
call ['_random_byte']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
jmp ['short', 'loc_A681']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['[ebp+var_20],', '0']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_A6D5']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '1']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_14]']
cmp ['ecx,', '[eax+0A4h]']
jge ['loc_A767']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+edx*4+0A8h]']
mov ['[ebp+var_24],', 'ecx']
cmp ['[ebp+var_24],', '0']
jnz ['short', 'loc_A6FF']
jmp ['short', 'loc_A6CC']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_A711']
mov ['edx,', '[ebp+var_18]']
add ['edx,', '1']
mov ['[ebp+var_18],', 'edx']
mov ['eax,', '[ebp+var_24]']
mov ['ecx,', '[ebp+var_18]']
cmp ['ecx,', '[eax]']
jge ['short', 'loc_A762']
cmp ['[ebp+var_20],', '0']
jz ['short', 'loc_A738']
push ['offset', '$SG91611']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_24]']
mov ['edx,', '[ecx+4]']
mov ['eax,', '[ebp+var_18]']
mov ['ecx,', '[edx+eax*4]']
mov ['edx,', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['[ebp+var_20],', '1']
jmp ['short', 'loc_A708']
jmp ['loc_A6CC']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0E4h],', '0']
jnz ['short', 'loc_A7DE']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_A797']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '1']
mov ['[ebp+var_14],', 'edx']
cmp ['[ebp+var_14],', '2']
jnb ['short', 'loc_A7DC']
mov ['eax,', '[ebp+var_14]']
mov ['ecx,', '_hostkey_algs[eax*4]']
mov ['edx,', '[ecx+30h]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
cmp ['[ebp+var_14],', '1']
jnb ['short', 'loc_A7DA']
push ['offset', '$SG91617']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
jmp ['short', 'loc_A78E']
jmp ['short', 'loc_A820']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+90h],', '0']
jnz ['short', 'loc_A801']
push ['183Ch']
push ['offset', '$SG91620']
push ['offset', '$SG91621']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+94h]']
mov ['edx,', '[ecx+30h]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['[ebp+var_1C],', '0']
jmp ['short', 'loc_A832']
mov ['edx,', '[ebp+var_1C]']
add ['edx,', '1']
mov ['[ebp+var_1C],', 'edx']
cmp ['[ebp+var_1C],', '2']
jge ['loc_A8FF']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['[ebp+var_20],', '0']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_A867']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '1']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_14]']
cmp ['ecx,', '[eax+0BCh]']
jge ['loc_A8FA']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+edx*4+0C0h]']
mov ['[ebp+var_28],', 'ecx']
cmp ['[ebp+var_28],', '0']
jnz ['short', 'loc_A891']
jmp ['short', 'loc_A85E']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_A8A3']
mov ['edx,', '[ebp+var_18]']
add ['edx,', '1']
mov ['[ebp+var_18],', 'edx']
mov ['eax,', '[ebp+var_28]']
mov ['ecx,', '[ebp+var_18]']
cmp ['ecx,', '[eax]']
jge ['short', 'loc_A8F5']
cmp ['[ebp+var_20],', '0']
jz ['short', 'loc_A8CA']
push ['offset', '$SG91634']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ecx+4]']
mov ['eax,', '[ebp+var_18]']
mov ['ecx,', '[edx+eax*4]']
mov ['edx,', '[ecx+18h]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['[ebp+var_20],', '1']
jmp ['short', 'loc_A89A']
jmp ['loc_A85E']
jmp ['loc_A829']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_A911']
mov ['edx,', '[ebp+var_18]']
add ['edx,', '1']
mov ['[ebp+var_18],', 'edx']
cmp ['[ebp+var_18],', '2']
jge ['short', 'loc_A994']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_A93B']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '1']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_14]']
cmp ['ecx,', '[eax+40h]']
jge ['short', 'loc_A98F']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+3Ch]']
mov ['ecx,', '[ebp+var_14]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[edx+24h]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+40h]']
sub ['ecx,', '1']
cmp ['[ebp+var_14],', 'ecx']
jge ['short', 'loc_A98D']
push ['offset', '$SG91642']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
jmp ['short', 'loc_A932']
jmp ['loc_A908']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_A9A6']
mov ['ecx,', '[ebp+var_18]']
add ['ecx,', '1']
mov ['[ebp+var_18],', 'ecx']
cmp ['[ebp+var_18],', '2']
jge ['loc_AAE6']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0D8h]']
mov ['eax,', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+0DCh],', '0']
jz ['short', 'loc_AA31']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0D8h]']
cmp ['dword', 'ptr', '[edx+4],', '0']
jz ['short', 'loc_AA31']
push ['offset', '$SG91648']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0D8h]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_AA43']
mov ['ecx,', '[ebp+var_14]']
add ['ecx,', '1']
mov ['[ebp+var_14],', 'ecx']
cmp ['[ebp+var_14],', '2']
jnb ['loc_AAE1']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', '_compressions[edx*4]']
mov ['[ebp+var_2C],', 'eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_2C]']
cmp ['edx,', '[ecx+0D8h]']
jz ['short', 'loc_AADC']
push ['offset', '$SG91654']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['edx,', '[ebp+var_2C]']
mov ['eax,', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+0DCh],', '0']
jz ['short', 'loc_AADC']
mov ['ecx,', '[ebp+var_2C]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jz ['short', 'loc_AADC']
push ['offset', '$SG91656']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_2C]']
mov ['edx,', '[ecx+4]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_str']
add ['esp,', '8']
jmp ['loc_AA3A']
jmp ['loc_A99D']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
push ['0']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
push ['0']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
mov ['eax,', '[edx]']
sub ['eax,', '5']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+30h],', 'eax']
push ['1']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+30h]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+2Ch],', 'eax']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+30h]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
mov ['eax,', '[edx+10h]']
add ['eax,', '5']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+2Ch]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send_noqueue']
add ['esp,', '8']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_ABB7']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '1884h']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_AB9F']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_AB9F']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '14h']
jz ['short', 'loc_ABEC']
push ['offset', '$SG91673']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_ABDA']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+90h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+94h],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+44h],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+48h],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+4Ch],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+50h],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+54h],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+58h],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+14h],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+10h],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+0Ch],', '0']
mov ['edx,', '[ebp+arg_C]']
mov ['eax,', '[edx+18h]']
add ['eax,', '10h']
mov ['ecx,', '[ebp+arg_C]']
mov ['[ecx+18h],', 'eax']
lea ['edx,', '[ebp+var_4C]']
push ['edx']
lea ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_ACB5']
push ['offset', '$SG91686']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_ACA3']
mov ['[ebp+Str],', '0']
mov ['[ebp+var_40],', '0']
jmp ['short', 'loc_ACCE']
mov ['edx,', '[ebp+var_40]']
add ['edx,', '1']
mov ['[ebp+var_40],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_40]']
cmp ['ecx,', '[eax+0A4h]']
jge ['loc_AD84']
mov ['edx,', '[ebp+var_40]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+edx*4+0A8h]']
mov ['[ebp+var_54],', 'ecx']
cmp ['[ebp+var_54],', '0']
jnz ['short', 'loc_AD02']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+0Ch],', '1']
jmp ['short', 'loc_AD71']
mov ['[ebp+var_44],', '0']
jmp ['short', 'loc_AD14']
mov ['eax,', '[ebp+var_44]']
add ['eax,', '1']
mov ['[ebp+var_44],', 'eax']
mov ['ecx,', '[ebp+var_54]']
mov ['edx,', '[ebp+var_44]']
cmp ['edx,', '[ecx]']
jge ['short', 'loc_AD71']
cmp ['[ebp+Str],', '0']
jnz ['short', 'loc_AD35']
mov ['eax,', '[ebp+var_54]']
mov ['ecx,', '[eax+4]']
mov ['edx,', '[ebp+var_44]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[eax]']
mov ['[ebp+Str],', 'ecx']
mov ['edx,', '[ebp+var_4C]']
push ['edx']
mov ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+var_54]']
mov ['edx,', '[ecx+4]']
mov ['eax,', '[ebp+var_44]']
mov ['ecx,', '[edx+eax*4]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_AD6F']
mov ['eax,', '[ebp+var_54]']
mov ['ecx,', '[eax+4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_44]']
mov ['ecx,', '[ecx+eax*4]']
mov ['[edx+90h],', 'ecx']
jmp ['short', 'loc_AD71']
jmp ['short', 'loc_AD0B']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+90h],', '0']
jz ['short', 'loc_AD7F']
jmp ['short', 'loc_AD84']
jmp ['loc_ACC5']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+90h],', '0']
jnz ['short', 'loc_ADC4']
mov ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+var_4C]']
push ['edx']
push ['offset', '$SG91704']
call ['_dupprintf']
add ['esp,', '0Ch']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_ADB2']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
mov ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_first_in_commasep_string']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0F4h],', 'eax']
lea ['edx,', '[ebp+var_4C]']
push ['edx']
lea ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_AE27']
push ['offset', '$SG91709']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_AE15']
mov ['[ebp+var_40],', '0']
jmp ['short', 'loc_AE39']
mov ['edx,', '[ebp+var_40]']
add ['edx,', '1']
mov ['[ebp+var_40],', 'edx']
cmp ['[ebp+var_40],', '2']
jnb ['short', 'loc_AE78']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
mov ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+var_40]']
mov ['eax,', '_hostkey_algs[edx*4]']
mov ['ecx,', '[eax+30h]']
push ['ecx']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_AE76']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_40]']
mov ['ecx,', '_hostkey_algs[eax*4]']
mov ['[edx+94h],', 'ecx']
jmp ['short', 'loc_AE78']
jmp ['short', 'loc_AE30']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+94h],', '0']
jnz ['short', 'loc_AEB8']
mov ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
push ['offset', '$SG91718']
call ['_dupprintf']
add ['esp,', '0Ch']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_AEA6']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0F4h],', '0']
jz ['short', 'loc_AEEE']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
mov ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '_hostkey_algs']
mov ['eax,', '[edx+30h]']
push ['eax']
call ['_first_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_AEEE']
mov ['[ebp+var_150],', '1']
jmp ['short', 'loc_AEF8']
mov ['[ebp+var_150],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_150]']
mov ['[ecx+0F4h],', 'edx']
lea ['eax,', '[ebp+var_4C]']
push ['eax']
lea ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_AF4D']
push ['offset', '$SG91723']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_AF3B']
mov ['[ebp+var_40],', '0']
jmp ['short', 'loc_AF5F']
mov ['eax,', '[ebp+var_40]']
add ['eax,', '1']
mov ['[ebp+var_40],', 'eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_40]']
cmp ['edx,', '[ecx+0BCh]']
jge ['loc_AFF9']
mov ['eax,', '[ebp+var_40]']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+eax*4+0C0h]']
mov ['[ebp+var_58],', 'edx']
cmp ['[ebp+var_58],', '0']
jnz ['short', 'loc_AF93']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+10h],', '1']
jmp ['short', 'loc_AFE9']
mov ['[ebp+var_44],', '0']
jmp ['short', 'loc_AFA5']
mov ['ecx,', '[ebp+var_44]']
add ['ecx,', '1']
mov ['[ebp+var_44],', 'ecx']
mov ['edx,', '[ebp+var_58]']
mov ['eax,', '[ebp+var_44]']
cmp ['eax,', '[edx]']
jge ['short', 'loc_AFE9']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
mov ['edx,', '[ebp+Buf2]']
push ['edx']
mov ['eax,', '[ebp+var_58]']
mov ['ecx,', '[eax+4]']
mov ['edx,', '[ebp+var_44]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_AFE7']
mov ['edx,', '[ebp+var_58]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_44]']
mov ['eax,', '[eax+edx*4]']
mov ['[ecx+44h],', 'eax']
jmp ['short', 'loc_AFE9']
jmp ['short', 'loc_AF9C']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+44h],', '0']
jz ['short', 'loc_AFF4']
jmp ['short', 'loc_AFF9']
jmp ['loc_AF56']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+44h],', '0']
jnz ['short', 'loc_B036']
mov ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
push ['offset', '$SG91739']
call ['_dupprintf']
add ['esp,', '0Ch']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_B024']
lea ['edx,', '[ebp+var_4C]']
push ['edx']
lea ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_B07C']
push ['offset', '$SG91744']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_B06A']
mov ['[ebp+var_40],', '0']
jmp ['short', 'loc_B08E']
mov ['edx,', '[ebp+var_40]']
add ['edx,', '1']
mov ['[ebp+var_40],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_40]']
cmp ['ecx,', '[eax+0BCh]']
jge ['loc_B128']
mov ['edx,', '[ebp+var_40]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+edx*4+0C0h]']
mov ['[ebp+var_5C],', 'ecx']
cmp ['[ebp+var_5C],', '0']
jnz ['short', 'loc_B0C2']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+14h],', '1']
jmp ['short', 'loc_B118']
mov ['[ebp+var_44],', '0']
jmp ['short', 'loc_B0D4']
mov ['eax,', '[ebp+var_44]']
add ['eax,', '1']
mov ['[ebp+var_44],', 'eax']
mov ['ecx,', '[ebp+var_5C]']
mov ['edx,', '[ebp+var_44]']
cmp ['edx,', '[ecx]']
jge ['short', 'loc_B118']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
mov ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+var_5C]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+var_44]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[edx+18h]']
push ['eax']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_B116']
mov ['ecx,', '[ebp+var_5C]']
mov ['edx,', '[ecx+4]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_44]']
mov ['edx,', '[edx+ecx*4]']
mov ['[eax+48h],', 'edx']
jmp ['short', 'loc_B118']
jmp ['short', 'loc_B0CB']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+48h],', '0']
jz ['short', 'loc_B123']
jmp ['short', 'loc_B128']
jmp ['loc_B085']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+48h],', '0']
jnz ['short', 'loc_B165']
mov ['edx,', '[ebp+Buf2]']
push ['edx']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
push ['offset', '$SG91760']
call ['_dupprintf']
add ['esp,', '0Ch']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_B153']
lea ['ecx,', '[ebp+var_4C]']
push ['ecx']
lea ['edx,', '[ebp+Buf2]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_B1AB']
push ['offset', '$SG91765']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_B199']
mov ['[ebp+var_40],', '0']
jmp ['short', 'loc_B1BD']
mov ['ecx,', '[ebp+var_40]']
add ['ecx,', '1']
mov ['[ebp+var_40],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+var_40]']
cmp ['eax,', '[edx+40h]']
jge ['short', 'loc_B202']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
mov ['edx,', '[ebp+Buf2]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+3Ch]']
mov ['edx,', '[ebp+var_40]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_B200']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+3Ch]']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_40]']
mov ['eax,', '[eax+edx*4]']
mov ['[ecx+4Ch],', 'eax']
jmp ['short', 'loc_B202']
jmp ['short', 'loc_B1B4']
lea ['ecx,', '[ebp+var_4C]']
push ['ecx']
lea ['edx,', '[ebp+Buf2]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_B248']
push ['offset', '$SG91774']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_B236']
mov ['[ebp+var_40],', '0']
jmp ['short', 'loc_B25A']
mov ['ecx,', '[ebp+var_40]']
add ['ecx,', '1']
mov ['[ebp+var_40],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+var_40]']
cmp ['eax,', '[edx+40h]']
jge ['short', 'loc_B29F']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
mov ['edx,', '[ebp+Buf2]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+3Ch]']
mov ['edx,', '[ebp+var_40]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_B29D']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+3Ch]']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_40]']
mov ['eax,', '[eax+edx*4]']
mov ['[ecx+50h],', 'eax']
jmp ['short', 'loc_B29F']
jmp ['short', 'loc_B251']
lea ['ecx,', '[ebp+var_4C]']
push ['ecx']
lea ['edx,', '[ebp+Buf2]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_B2E5']
push ['offset', '$SG91783']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_B2D3']
mov ['[ebp+var_40],', '0']
jmp ['short', 'loc_B2F7']
mov ['ecx,', '[ebp+var_40]']
add ['ecx,', '1']
mov ['[ebp+var_40],', 'ecx']
cmp ['[ebp+var_40],', '3']
jnb ['loc_B39E']
cmp ['[ebp+var_40],', '0']
jnz ['short', 'loc_B318']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0D8h]']
mov ['[ebp+var_154],', 'eax']
jmp ['short', 'loc_B328']
mov ['ecx,', '[ebp+var_40]']
mov ['edx,', 'dword_C28[ecx*4]']
mov ['[ebp+var_154],', 'edx']
mov ['eax,', '[ebp+var_154]']
mov ['[ebp+var_60],', 'eax']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
mov ['edx,', '[ebp+Buf2]']
push ['edx']
mov ['eax,', '[ebp+var_60]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_B358']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+var_60]']
mov ['[edx+54h],', 'eax']
jmp ['short', 'loc_B39E']
jmp ['short', 'loc_B399']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
mov ['edx,', '[ebp+Buf2]']
push ['edx']
mov ['eax,', '[ebp+var_60]']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_B399']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0DCh],', '0']
jz ['short', 'loc_B38C']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_60]']
mov ['[eax+54h],', 'ecx']
jmp ['short', 'loc_B39E']
jmp ['short', 'loc_B399']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+0E0h],', '1']
jmp ['loc_B2EE']
lea ['eax,', '[ebp+var_4C]']
push ['eax']
lea ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_B3E4']
push ['offset', '$SG91797']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_B3D2']
mov ['[ebp+var_40],', '0']
jmp ['short', 'loc_B3F6']
mov ['eax,', '[ebp+var_40]']
add ['eax,', '1']
mov ['[ebp+var_40],', 'eax']
cmp ['[ebp+var_40],', '3']
jnb ['loc_B49D']
cmp ['[ebp+var_40],', '0']
jnz ['short', 'loc_B417']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0D8h]']
mov ['[ebp+var_158],', 'edx']
jmp ['short', 'loc_B427']
mov ['eax,', '[ebp+var_40]']
mov ['ecx,', 'dword_C28[eax*4]']
mov ['[ebp+var_158],', 'ecx']
mov ['edx,', '[ebp+var_158]']
mov ['[ebp+var_64],', 'edx']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
mov ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+var_64]']
mov ['eax,', '[edx]']
push ['eax']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_B457']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_64]']
mov ['[ecx+58h],', 'edx']
jmp ['short', 'loc_B49D']
jmp ['short', 'loc_B498']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
mov ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+var_64]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_B498']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+0DCh],', '0']
jz ['short', 'loc_B48B']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+var_64]']
mov ['[edx+58h],', 'eax']
jmp ['short', 'loc_B49D']
jmp ['short', 'loc_B498']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+0E0h],', '1']
jmp ['loc_B3ED']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0E0h],', '0']
jz ['short', 'loc_B4C0']
push ['offset', '$SG91811']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
lea ['edx,', '[ebp+var_4C]']
push ['edx']
lea ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
lea ['edx,', '[ebp+var_4C]']
push ['edx']
lea ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_B510']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+0F4h],', '0']
jnz ['short', 'loc_B510']
mov ['[ebp+var_15C],', '1']
jmp ['short', 'loc_B51A']
mov ['[ebp+var_15C],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_15C]']
mov ['[ecx+0F8h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
mov ['esi,', 'esp']
mov ['eax,', '[edx]']
call ['eax']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_hash_string']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_hash_string']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+30h]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+2Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_hash_string']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+2Ch]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_C]']
mov ['edx,', '[ecx]']
add ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
mov ['ecx,', '[eax+14h]']
sub ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_hash_string']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0']
jz ['loc_B717']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '_ssh_dialog_callback']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['eax,', '[edx]']
push ['eax']
push ['offset', '$SG91813']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_askalg']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0F0h],', 'eax']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0F0h],', '0']
jge ['short', 'loc_B6D4']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '195Dh']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_B672']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_B6B6']
push ['offset', '$SG91823']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_B6A4']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_B672']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_B672']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+230h]']
mov ['[edx+0F0h],', 'ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+0F0h],', '0']
jnz ['short', 'loc_B717']
push ['1']
push ['0']
push ['0']
push ['offset', '$SG91829']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_B705']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jz ['loc_B816']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '_ssh_dialog_callback']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+44h]']
mov ['eax,', '[edx+18h]']
push ['eax']
push ['offset', '$SG91834']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_askalg']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0F0h],', 'eax']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0F0h],', '0']
jge ['short', 'loc_B7D3']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '1976h']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_B771']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_B7B5']
push ['offset', '$SG91844']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_B7A3']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_B771']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_B771']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+230h]']
mov ['[edx+0F0h],', 'ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+0F0h],', '0']
jnz ['short', 'loc_B816']
push ['1']
push ['0']
push ['0']
push ['offset', '$SG91850']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_B804']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+14h],', '0']
jz ['loc_B915']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '_ssh_dialog_callback']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+48h]']
mov ['eax,', '[edx+18h]']
push ['eax']
push ['offset', '$SG91855']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_askalg']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0F0h],', 'eax']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0F0h],', '0']
jge ['short', 'loc_B8D2']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '198Fh']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_B870']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_B8B4']
push ['offset', '$SG91865']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_B8A2']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_B870']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_B870']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+230h]']
mov ['[edx+0F0h],', 'ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+0F0h],', '0']
jnz ['short', 'loc_B915']
push ['1']
push ['0']
push ['0']
push ['offset', '$SG91871']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_B903']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+0F8h],', '0']
jz ['short', 'loc_B939']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '19A1h']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_B921']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_B921']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jnz ['loc_BF15']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+44h]']
mov ['edx,', '[ecx+20h]']
mov ['[ebp+var_68],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+48h]']
mov ['edx,', '[ecx+20h]']
mov ['[ebp+var_6C],', 'edx']
mov ['eax,', '[ebp+var_68]']
cmp ['eax,', '[ebp+var_6C]']
jle ['short', 'loc_B977']
mov ['ecx,', '[ebp+var_68]']
mov ['[ebp+var_160],', 'ecx']
jmp ['short', 'loc_B980']
mov ['edx,', '[ebp+var_6C]']
mov ['[ebp+var_160],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_160]']
mov ['[eax+4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
mov ['edx,', '[ecx+0Ch]']
shl ['edx,', '3']
mov ['eax,', '[ebp+var_C]']
cmp ['[eax+4],', 'edx']
jle ['short', 'loc_B9BE']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['eax,', '[edx+1Ch]']
mov ['ecx,', '[eax+0Ch]']
shl ['ecx,', '3']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+4],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0']
jnz ['loc_BB3C']
push ['offset', '$SG91888']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+158h],', '2']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+4]']
sub ['eax,', '1']
cdq
and ['edx,', '3Fh']
add ['eax,', 'edx']
sar ['eax,', '6']
mov ['edx,', '200h']
mov ['ecx,', 'eax']
shl ['edx,', 'cl']
mov ['eax,', '[ebp+var_C]']
mov ['[eax+8],', 'edx']
push ['1Eh']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0ECh],', 'eax']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send_noqueue']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '19C6h']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_BA58']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_BA58']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '1Fh']
jz ['short', 'loc_BAA5']
push ['offset', '$SG91897']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_BA93']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh2_pkt_getmp']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+18h],', 'eax']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh2_pkt_getmp']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+1Ch],', 'eax']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+18h],', '0']
jz ['short', 'loc_BADB']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+1Ch],', '0']
jnz ['short', 'loc_BB07']
push ['offset', '$SG91903']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_BAF5']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+1Ch]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_dh_setup_gex']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0C0h],', 'eax']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+34h],', '20h']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+38h],', '21h']
jmp ['short', 'loc_BB96']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+158h],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
push ['ecx']
call ['_dh_setup_group']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0C0h],', 'eax']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+34h],', '1Eh']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+38h],', '1Fh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+4]']
push ['ecx']
push ['offset', '$SG91908']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
mov ['eax,', '[edx+10h]']
push ['eax']
push ['offset', '$SG91909']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
push ['2']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_set_busy_status']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+4]']
shl ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0C0h]']
push ['ecx']
call ['_dh_create_e']
add ['esp,', '8']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+20h],', 'eax']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+34h]']
push ['ecx']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+0ECh],', 'eax']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+20h]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
call ['_ssh2_pkt_addmp']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send_noqueue']
add ['esp,', '8']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_set_busy_status']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '19E9h']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_BC47']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_BC47']
mov ['edx,', '[ebp+arg_C]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[edx+8]']
cmp ['ecx,', '[eax+38h]']
jz ['short', 'loc_BC99']
push ['offset', '$SG91918']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_BC87']
push ['2']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_set_busy_status']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '70h']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '5Ch']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+5Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+94h]']
mov ['ecx,', '[eax]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+7Ch],', 'eax']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh2_pkt_getmp']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+24h],', 'eax']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+24h],', '0']
jnz ['short', 'loc_BD3B']
push ['offset', '$SG91923']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_BD29']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '74h']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '60h']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0C0h]']
push ['eax']
call ['_dh_validate_f']
add ['esp,', '8']
mov ['[ebp+var_70],', 'eax']
cmp ['[ebp+var_70],', '0']
jz ['short', 'loc_BDA7']
mov ['ecx,', '[ebp+var_70]']
push ['ecx']
push ['offset', '$SG91929']
call ['_dupprintf']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_BD95']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+24h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0C0h]']
push ['edx']
call ['_dh_find_K']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+28h],', 'eax']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_set_busy_status']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+5Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_hash_string']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
cmp ['dword', 'ptr', '[edx+0Ch],', '0']
jnz ['short', 'loc_BE7C']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_hash_uint32']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+18h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_hash_mpint']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
push ['edx']
call ['_hash_mpint']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+20h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_hash_mpint']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+24h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_hash_mpint']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0C0h]']
push ['eax']
call ['_dh_cleanup']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+24h]']
push ['edx']
call ['_freebn']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0']
jnz ['short', 'loc_BF10']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_freebn']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+18h]']
push ['edx']
call ['_freebn']
add ['esp,', '4']
jmp ['loc_C3F5']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
mov ['eax,', '[edx+10h]']
push ['eax']
push ['offset', '$SG91936']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+158h],', '3']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '1A1Ch']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_BF43']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_BF43']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '1Eh']
jz ['short', 'loc_BF90']
push ['offset', '$SG91945']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_BF7E']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '70h']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '5Ch']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+5Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
push ['edx']
call ['_hash_string']
add ['esp,', '10h']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+5Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+94h]']
mov ['eax,', '[edx]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+7Ch],', 'eax']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '78h']
push ['edx']
lea ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
push ['1']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+78h]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+64h],', 'eax']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+78h]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+64h]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+78h]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+64h]']
push ['ecx']
call ['_ssh_rsakex_newkey']
add ['esp,', '8']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+80h],', 'eax']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+80h],', '0']
jnz ['short', 'loc_C0AF']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+64h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['offset', '$SG91953']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_C09D']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+78h]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+64h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
push ['edx']
call ['_hash_string']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+80h]']
push ['ecx']
call ['_ssh_rsakex_klen']
add ['esp,', '4']
mov ['[ebp+var_80],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
mov ['edx,', '[ecx+0Ch]']
shl ['edx,', '1']
lea ['eax,', 'ds:31h[edx*8]']
mov ['ecx,', '[ebp+var_80]']
sub ['ecx,', 'eax']
mov ['[ebp+var_84],', 'ecx']
mov ['[ebp+var_8C],', '0']
mov ['edx,', '[ebp+var_84]']
sub ['edx,', '1']
push ['edx']
call ['_bn_power_2']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+28h],', 'eax']
mov ['[ebp+var_88],', '0']
jmp ['short', 'loc_C14E']
mov ['edx,', '[ebp+var_88]']
add ['edx,', '1']
mov ['[ebp+var_88],', 'edx']
mov ['eax,', '[ebp+var_88]']
cmp ['eax,', '[ebp+var_84]']
jge ['short', 'loc_C19F']
mov ['ecx,', '[ebp+var_88]']
and ['ecx,', '7']
jnz ['short', 'loc_C172']
call ['_random_byte']
mov ['[ebp+var_8C],', 'eax']
mov ['ecx,', '[ebp+var_88]']
and ['ecx,', '7']
mov ['edx,', '[ebp+var_8C]']
sar ['edx,', 'cl']
and ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+var_88]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+28h]']
push ['edx']
call ['_bignum_set_bit']
add ['esp,', '0Ch']
jmp ['short', 'loc_C13F']
lea ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+28h]']
push ['edx']
call ['_ssh2_mpint_fmt']
add ['esp,', '8']
mov ['[ebp+var_90],', 'eax']
mov ['eax,', '[ebp+Size]']
add ['eax,', '4']
mov ['[ebp+var_A8],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_A8]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_94],', 'eax']
mov ['edx,', '[ebp+Size]']
sar ['edx,', '18h']
mov ['eax,', '[ebp+var_94]']
mov ['[eax],', 'dl']
mov ['ecx,', '[ebp+Size]']
sar ['ecx,', '10h']
mov ['edx,', '[ebp+var_94]']
mov ['[edx+1],', 'cl']
mov ['eax,', '[ebp+Size]']
sar ['eax,', '8']
mov ['ecx,', '[ebp+var_94]']
mov ['[ecx+2],', 'al']
mov ['edx,', '[ebp+var_94]']
mov ['al,', 'byte', 'ptr', '[ebp+Size]']
mov ['[edx+3],', 'al']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+var_90]']
push ['edx']
mov ['eax,', '[ebp+var_94]']
add ['eax,', '4']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_80]']
add ['eax,', '7']
cdq
and ['edx,', '7']
add ['eax,', 'edx']
sar ['eax,', '3']
mov ['[ebp+var_AC],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_AC]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_98],', 'eax']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+80h]']
push ['eax']
mov ['ecx,', '[ebp+var_AC]']
push ['ecx']
mov ['edx,', '[ebp+var_98]']
push ['edx']
mov ['eax,', '[ebp+var_A8]']
push ['eax']
mov ['ecx,', '[ebp+var_94]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_ssh_rsakex_encrypt']
add ['esp,', '18h']
push ['1Fh']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+0ECh],', 'eax']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['edx,', '[ebp+var_AC]']
push ['edx']
mov ['eax,', '[ebp+var_98]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+0ECh]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send_noqueue']
add ['esp,', '8']
mov ['eax,', '[ebp+var_AC]']
push ['eax']
mov ['ecx,', '[ebp+var_98]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_hash_string']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_94]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_90]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_98]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+80h]']
push ['edx']
call ['_ssh_rsakex_freekey']
add ['esp,', '4']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '1A6Eh']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_C370']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_C370']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '20h']
jz ['short', 'loc_C3CC']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+64h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
push ['offset', '$SG91988']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_C3BA']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '74h']
push ['edx']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '60h']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+64h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+28h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_hash_mpint']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '20h']
jbe ['short', 'loc_C441']
push ['1A7Bh']
push ['offset', '$SG91993']
push ['offset', '$SG91994']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '84h']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
mov ['eax,', '[edx+8]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0C0h],', '0']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+7Ch],', '0']
jz ['short', 'loc_C4D1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
mov ['esi,', 'esp']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '84h']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+74h]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+60h]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+94h]']
mov ['ecx,', '[eax+28h]']
call ['ecx']
add ['esp,', '14h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_C4FD']
push ['offset', '$SG91999']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_C4EB']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+7Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+94h]']
mov ['eax,', '[edx+8]']
call ['eax']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+68h],', 'eax']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0E4h],', '0']
jnz ['loc_C737']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+94h]']
mov ['ecx,', '[eax+24h]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_C]']
mov ['[edx+6Ch],', 'eax']
push ['offset', '$SG92004']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+94h]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_verify_ssh_manual_host_key']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0F0h],', 'eax']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0F0h],', '0']
jnz ['short', 'loc_C5F5']
push ['offset', '$SG92006']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_C5DE']
jmp ['loc_C717']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+0F0h],', '0']
jge ['loc_C717']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
push ['offset', '_ssh_dialog_callback']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+68h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+94h]']
mov ['eax,', '[edx+34h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0D4h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0D0h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_verify_ssh_host_key']
add ['esp,', '20h']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0F0h],', 'eax']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0F0h],', '0']
jge ['short', 'loc_C6D4']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '1AA5h']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_C672']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_C6B6']
push ['offset', '$SG92021']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_C6A4']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_C672']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_C672']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+230h]']
mov ['[edx+0F0h],', 'ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+0F0h],', '0']
jnz ['short', 'loc_C717']
push ['1']
push ['0']
push ['0']
push ['offset', '$SG92027']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_C705']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+68h]']
mov ['[eax+98h],', 'edx']
jmp ['short', 'loc_C78F']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+68h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+98h]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_C780']
push ['offset', '$SG92033']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_C76E']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+68h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+94h]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+0E4h],', '0']
jnz ['short', 'loc_C821']
push ['20h']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '84h']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '9Ch']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+0Ch]']
mov ['[edx+0BCh],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0BCh],', '20h']
jbe ['short', 'loc_C814']
push ['1AD4h']
push ['offset', '$SG92040']
push ['offset', '$SG92041']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+0E4h],', '1']
push ['15h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0ECh],', 'eax']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send_noqueue']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+65Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+68h],', '0']
jz ['short', 'loc_C87E']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+68h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+60h]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+44h]']
mov ['[eax+60h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+60h]']
mov ['esi,', 'esp']
mov ['edx,', '[ecx]']
call ['edx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+68h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+78h],', '0']
jz ['short', 'loc_C8CA']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+78h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+4Ch]']
mov ['[edx+70h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
mov ['esi,', 'esp']
mov ['ecx,', '[eax]']
call ['ecx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+78h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+88h],', '0']
jz ['short', 'loc_C91F']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+88h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+80h]']
mov ['edx,', '[ecx+0Ch]']
call ['edx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+54h]']
mov ['[eax+80h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+80h]']
mov ['esi,', 'esp']
mov ['edx,', '[ecx+8]']
call ['edx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+88h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['ecx,', '[eax+1Ch]']
mov ['edx,', '[ecx+0Ch]']
shl ['edx,', '1']
cmp ['edx,', '40h']
jbe ['short', 'loc_C97B']
push ['1AF8h']
push ['offset', '$SG92047']
push ['offset', '$SG92048']
call ['__wassert']
add ['esp,', '0Ch']
lea ['ecx,', '[ebp+var_F0]']
push ['ecx']
push ['43h']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '84h']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_mkkey']
add ['esp,', '14h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+60h]']
mov ['eax,', '[ecx+20h]']
add ['eax,', '7']
cdq
and ['edx,', '7']
add ['eax,', 'edx']
sar ['eax,', '3']
mov ['edx,', '[ebp+arg_0]']
mov ['ecx,', '[edx+90h]']
mov ['edx,', '[ecx+1Ch]']
mov ['ecx,', '[edx+0Ch]']
shl ['ecx,', '1']
cmp ['eax,', 'ecx']
jle ['short', 'loc_C9E2']
push ['1AFBh']
push ['offset', '$SG92050']
push ['offset', '$SG92051']
call ['__wassert']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_F0]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+68h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+60h]']
mov ['edx,', '[ecx+0Ch]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
lea ['eax,', '[ebp+var_F0]']
push ['eax']
push ['41h']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '84h']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+28h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_mkkey']
add ['esp,', '14h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+60h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['ecx,', '[edx+1Ch]']
mov ['edx,', '[ecx+0Ch]']
shl ['edx,', '1']
cmp ['[eax+1Ch],', 'edx']
jle ['short', 'loc_CA60']
push ['1AFFh']
push ['offset', '$SG92053']
push ['offset', '$SG92054']
call ['__wassert']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_F0]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+68h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+60h]']
mov ['eax,', '[edx+8]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
lea ['ecx,', '[ebp+var_F0]']
push ['ecx']
push ['45h']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '84h']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_mkkey']
add ['esp,', '14h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['edx,', '[eax+1Ch]']
mov ['eax,', '[edx+0Ch]']
shl ['eax,', '1']
cmp ['[ecx+28h],', 'eax']
jle ['short', 'loc_CADE']
push ['1B03h']
push ['offset', '$SG92056']
push ['offset', '$SG92057']
call ['__wassert']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_F0]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+78h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
mov ['ecx,', '[eax+8]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['40h']
lea ['edx,', '[ebp+var_F0]']
push ['edx']
call ['_smemclr']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+60h]']
mov ['edx,', '[ecx+28h]']
push ['edx']
push ['offset', '$SG92058']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
mov ['eax,', '[edx+2Ch]']
push ['eax']
push ['offset', '$SG92059']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+80h]']
cmp ['dword', 'ptr', '[eax+24h],', '0']
jz ['short', 'loc_CB77']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+80h]']
mov ['eax,', '[edx+24h]']
push ['eax']
push ['offset', '$SG92061']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+138h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_queuesend']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '1B1Ah']
jmp ['loc_D155']
xor ['edx,', 'edx']
jnz ['short', 'loc_CB90']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_CB90']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '15h']
jz ['short', 'loc_CBDD']
push ['offset', '$SG92070']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_D155']
xor ['eax,', 'eax']
jnz ['short', 'loc_CBCB']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+658h],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+6Ch],', '0']
jz ['short', 'loc_CC11']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+64h]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+48h]']
mov ['[edx+64h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+64h]']
mov ['esi,', 'esp']
mov ['ecx,', '[eax]']
call ['ecx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+6Ch],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+7Ch],', '0']
jz ['short', 'loc_CC5D']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+7Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+50h]']
mov ['[eax+74h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
mov ['esi,', 'esp']
mov ['edx,', '[ecx]']
call ['edx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+7Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+8Ch],', '0']
jz ['short', 'loc_CCB2']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+84h]']
mov ['ecx,', '[eax+18h]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+58h]']
mov ['[edx+84h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+84h]']
mov ['esi,', 'esp']
mov ['ecx,', '[eax+14h]']
call ['ecx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+8Ch],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
mov ['eax,', '[edx+0Ch]']
shl ['eax,', '1']
cmp ['eax,', '40h']
jbe ['short', 'loc_CD0E']
push ['1B3Ah']
push ['offset', '$SG92079']
push ['offset', '$SG92080']
call ['__wassert']
add ['esp,', '0Ch']
lea ['edx,', '[ebp+var_138]']
push ['edx']
push ['44h']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '84h']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+28h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_mkkey']
add ['esp,', '14h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+64h]']
mov ['eax,', '[edx+20h]']
add ['eax,', '7']
cdq
and ['edx,', '7']
add ['eax,', 'edx']
sar ['eax,', '3']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['ecx,', '[edx+1Ch]']
mov ['edx,', '[ecx+0Ch]']
shl ['edx,', '1']
cmp ['eax,', 'edx']
jle ['short', 'loc_CD74']
push ['1B3Dh']
push ['offset', '$SG92082']
push ['offset', '$SG92083']
call ['__wassert']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_138]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+64h]']
mov ['eax,', '[edx+0Ch]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
lea ['ecx,', '[ebp+var_138]']
push ['ecx']
push ['42h']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '84h']
push ['edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_mkkey']
add ['esp,', '14h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+64h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+90h]']
mov ['edx,', '[eax+1Ch]']
mov ['eax,', '[edx+0Ch]']
shl ['eax,', '1']
cmp ['[ecx+1Ch],', 'eax']
jle ['short', 'loc_CDF2']
push ['1B41h']
push ['offset', '$SG92085']
push ['offset', '$SG92086']
call ['__wassert']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_138]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+64h]']
mov ['ecx,', '[eax+8]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
lea ['edx,', '[ebp+var_138]']
push ['edx']
push ['46h']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '84h']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+28h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_mkkey']
add ['esp,', '14h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+74h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['eax,', '[ecx+1Ch]']
mov ['ecx,', '[eax+0Ch]']
shl ['ecx,', '1']
cmp ['[edx+28h],', 'ecx']
jle ['short', 'loc_CE6F']
push ['1B45h']
push ['offset', '$SG92088']
push ['offset', '$SG92089']
call ['__wassert']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_138]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+7Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['40h']
lea ['eax,', '[ebp+var_138]']
push ['eax']
call ['_smemclr']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+64h]']
mov ['eax,', '[edx+28h]']
push ['eax']
push ['offset', '$SG92090']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+74h]']
mov ['ecx,', '[eax+2Ch]']
push ['ecx']
push ['offset', '$SG92091']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+84h]']
cmp ['dword', 'ptr', '[ecx+24h],', '0']
jz ['short', 'loc_CF08']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+84h]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
push ['offset', '$SG92093']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
call ['_freebn']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+674h],', '0']
jz ['short', 'loc_CF58']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+674h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['[ebp+arg_C],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+674h],', '0']
jmp ['$begin_key_exchange$91561']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+668h],', '0']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+670h],', 'eax']
push ['18h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_CFCD']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '_ssh2_timer']
push ['18h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
imul ['eax,', '3Ch']
imul ['eax,', '3E8h']
push ['eax']
call ['_schedule_timer']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+66Ch],', 'eax']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_CFDC']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '14h']
jz ['short', 'loc_D027']
cmp ['[ebp+arg_C],', '0']
jnz ['short', '$wait_for_rekey$92103']
cmp ['[ebp+arg_8],', '0']
jl ['short', 'loc_D027']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+20Ch],', '0']
jnz ['short', 'loc_D013']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+20Ch],', '1']
push ['0']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_ssh2_authconn']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '1B83h']
jmp ['loc_D155']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_D013']
jmp ['short', 'loc_CFCD']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_D049']
push ['offset', '$SG92112']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_D147']
cmp ['[ebp+arg_8],', '0FFFFFFFEh']
jnz ['short', 'loc_D09D']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+0DCh],', '0']
jz ['short', 'loc_D072']
push ['1B9Bh']
push ['offset', '$SG92116']
push ['offset', '$SG92117']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+0DCh],', '1']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+0E0h],', '0']
jnz ['short', 'loc_D090']
jmp ['$wait_for_rekey$92103']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+0E0h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
and ['ecx,', '40h']
jz ['loc_D132']
mov ['edx,', '[ebp+var_8]']
push ['edx']
push ['offset', '$SG92121']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+65Ch],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+658h],', '0']
push ['18h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_D12B']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
push ['offset', '_ssh2_timer']
push ['18h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
imul ['eax,', '3Ch']
imul ['eax,', '3E8h']
push ['eax']
call ['_schedule_timer']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+66Ch],', 'eax']
jmp ['$wait_for_rekey$92103']
jmp ['short', 'loc_D147']
mov ['eax,', '[ebp+var_8]']
push ['eax']
push ['offset', '$SG92125']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
jmp ['$begin_key_exchange$91561']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '0']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN434']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '160h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_bomb_out       proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_do_close']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
push ['offset', '$SG88133']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_connection_fatal']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_hash_string    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_C]']
sar ['eax,', '18h']
mov ['byte', 'ptr', '[ebp+var_8],', 'al']
mov ['ecx,', '[ebp+arg_C]']
sar ['ecx,', '10h']
mov ['byte', 'ptr', '[ebp+var_8+1],', 'cl']
mov ['edx,', '[ebp+arg_C]']
sar ['edx,', '8']
mov ['byte', 'ptr', '[ebp+var_8+2],', 'dl']
mov ['al,', 'byte', 'ptr', '[ebp+arg_C]']
mov ['byte', 'ptr', '[ebp+var_8+3],', 'al']
mov ['esi,', 'esp']
push ['4']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_hash_uint32    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_8]']
shr ['eax,', '18h']
mov ['byte', 'ptr', '[ebp+var_8],', 'al']
mov ['ecx,', '[ebp+arg_8]']
shr ['ecx,', '10h']
mov ['byte', 'ptr', '[ebp+var_8+1],', 'cl']
mov ['edx,', '[ebp+arg_8]']
shr ['edx,', '8']
mov ['byte', 'ptr', '[ebp+var_8+2],', 'dl']
mov ['al,', 'byte', 'ptr', '[ebp+arg_8]']
mov ['byte', 'ptr', '[ebp+var_8+3],', 'al']
mov ['esi,', 'esp']
push ['4']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_3']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_addbool proc near             
push ['ebp']
mov ['ebp,', 'esp']
push ['1']
lea ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_pkt_addstring_data proc near       
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+18h]']
sar ['edx,', '18h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+18h]']
mov ['[ecx+eax-4],', 'dl']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx]']
sub ['eax,', '[edx+18h]']
sar ['eax,', '10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+18h]']
mov ['[edx+ecx-3],', 'al']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx]']
sub ['ecx,', '[eax+18h]']
sar ['ecx,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+18h]']
mov ['[eax+edx-2],', 'cl']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+18h]']
mov ['[ecx+eax-1],', 'dl']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh2_mpint_fmt proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+Dst],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bignum_bitcount']
add ['esp,', '4']
add ['eax,', '7']
cdq
and ['edx,', '7']
add ['eax,', 'edx']
sar ['eax,', '3']
mov ['[ebp+var_C],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '1']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Dst],', 'eax']
mov ['edx,', '[ebp+Dst]']
mov ['byte', 'ptr', '[edx],', '0']
mov ['[ebp+var_8],', '1']
jmp ['short', 'loc_D51A']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[ebp+var_C]']
jg ['short', 'loc_D53F']
mov ['edx,', '[ebp+var_C]']
sub ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bignum_byte']
add ['esp,', '8']
mov ['ecx,', '[ebp+Dst]']
add ['ecx,', '[ebp+var_8]']
mov ['[ecx],', 'al']
jmp ['short', 'loc_D511']
mov ['[ebp+var_8],', '0']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ebp+var_C]']
jg ['short', 'loc_D577']
mov ['eax,', '[ebp+Dst]']
add ['eax,', '[ebp+var_8]']
movzx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_D577']
mov ['edx,', '[ebp+Dst]']
add ['edx,', '[ebp+var_8]']
movzx ['eax,', 'byte', 'ptr', '[edx+1]']
and ['eax,', '80h']
jnz ['short', 'loc_D577']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
jmp ['short', 'loc_D546']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '1']
sub ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+Dst]']
add ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_memmove']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '1']
sub ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+arg_4]']
mov ['[eax],', 'edx']
mov ['eax,', '[ebp+Dst]']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_addmp proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+Size],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+Src],', 'eax']
lea ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh2_mpint_fmt']
add ['esp,', '8']
mov ['[ebp+Src],', 'eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+Src]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_4']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_queuesend proc near           
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+138h],', '0']
jz ['short', 'loc_D676']
push ['996h']
push ['offset', '$SG89125']
push ['offset', '$SG89126']
call ['__wassert']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_D688']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '1']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[eax+130h]']
jge ['short', 'loc_D6B6']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_defer_noqueue']
add ['esp,', '0Ch']
jmp ['short', 'loc_D67F']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+130h],', '0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_pkt_defersend']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_hash_mpint     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
call ['_ssh2_mpint_fmt']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_hash_string']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN5_5']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_getmp proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1Ch']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_14]']
push ['eax']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_D7B6']
xor ['eax,', 'eax']
jmp ['short', 'loc_D7DE']
mov ['eax,', '[ebp+var_8]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
and ['ecx,', '80h']
jz ['short', 'loc_D7C8']
xor ['eax,', 'eax']
jmp ['short', 'loc_D7DE']
mov ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_bignum_from_bytes']
add ['esp,', '8']
mov ['[ebp+var_1C],', 'eax']
mov ['eax,', '[ebp+var_1C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN8_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '1Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_dialog_callback proc near          
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+230h],', 'edx']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+16Ch],', '1']
jnz ['short', 'loc_D875']
push ['0']
push ['0FFFFFFFFh']
push ['0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_do_ssh1_login']
add ['esp,', '10h']
jmp ['short', 'loc_D887']
push ['0']
push ['0FFFFFFFFh']
push ['0']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_do_ssh2_transport']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh_process_queued_incoming_data']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_disconnect proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_D8C8']
mov ['eax,', '[ebp+Str]']
mov ['[ebp+arg_4],', 'eax']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_D8E4']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
push ['offset', '$SG89982']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_D8F4']
push ['offset', '$SG89984']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+Str],', '0']
jz ['short', 'loc_D978']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+16Ch],', '1']
jnz ['short', 'loc_D91E']
push ['0']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['4']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '14h']
jmp ['short', 'loc_D978']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+16Ch],', '2']
jnz ['short', 'loc_D978']
push ['1']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG89990']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send_noqueue']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+108h],', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_10]']
mov ['[edx+10Ch],', 'eax']
push ['0']
push ['0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_closing']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_ssh1_login  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '2F4h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_2F4]']
mov ['ecx,', '0BDh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+19Ch],', '0']
jnz ['short', 'loc_DA37']
push ['0FCh']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_2CC],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_2CC]']
mov ['[ecx+19Ch],', 'edx']
mov ['eax,', '[ebp+var_2CC]']
mov ['[ebp+var_8C],', 'eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+19Ch]']
mov ['[ebp+var_8C],', 'eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ebp+var_90],', 'ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx]']
mov ['[ebp+var_2D0],', 'eax']
cmp ['[ebp+var_2D0],', '10A4h']
jg ['loc_DB25']
cmp ['[ebp+var_2D0],', '10A4h']
jz ['loc_F706']
cmp ['[ebp+var_2D0],', '0FC2h']
jg ['short', 'loc_DAEF']
cmp ['[ebp+var_2D0],', '0FC2h']
jz ['loc_E8CC']
cmp ['[ebp+var_2D0],', '0F29h']
jg ['short', 'loc_DADA']
cmp ['[ebp+var_2D0],', '0F29h']
jz ['loc_E114']
cmp ['[ebp+var_2D0],', '0']
jz ['loc_DBAC']
cmp ['[ebp+var_2D0],', '0EC9h']
jz ['loc_DBC5']
jmp ['$LN379']
cmp ['[ebp+var_2D0],', '0F7Fh']
jz ['loc_E56D']
jmp ['$LN379']
mov ['ecx,', '[ebp+var_2D0]']
sub ['ecx,', '0FD6h']
mov ['[ebp+var_2D0],', 'ecx']
cmp ['[ebp+var_2D0],', '0A9h']
ja ['$LN379']
mov ['edx,', '[ebp+var_2D0]']
movzx ['eax,', 'ds:$LN401[edx]']
jmp ['ds:$LN420[eax*4]']
cmp ['[ebp+var_2D0],', '1177h']
jg ['short', 'loc_DB77']
cmp ['[ebp+var_2D0],', '1177h']
jz ['loc_1007D']
mov ['ecx,', '[ebp+var_2D0]']
sub ['ecx,', '10B8h']
mov ['[ebp+var_2D0],', 'ecx']
cmp ['[ebp+var_2D0],', '0A4h']
ja ['$LN379']
mov ['edx,', '[ebp+var_2D0]']
movzx ['eax,', 'ds:$LN402[edx]']
jmp ['ds:$LN421[eax*4]']
cmp ['[ebp+var_2D0],', '11A2h']
jz ['loc_102FE']
cmp ['[ebp+var_2D0],', '11DDh']
jz ['loc_105EF']
cmp ['[ebp+var_2D0],', '126Ah']
jz ['loc_10A37']
jmp ['$LN379']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_DBCF']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0EC9h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_DBB2']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_DBB2']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '2']
jz ['short', 'loc_DC09']
push ['offset', '$SG90098']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_DBF2']
push ['offset', '$SG90102']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['8']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getdata']
add ['esp,', '8']
mov ['[ebp+Src],', 'eax']
cmp ['[ebp+Src],', '0']
jnz ['short', 'loc_DC68']
push ['offset', '$SG90104']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_DC51']
push ['8']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
lea ['edx,', '[ebp+Dst]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '0Ch']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '0B4h']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh1_pkt_getrsakey']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_DCC8']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '10h']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '0D8h']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh1_pkt_getrsakey']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_DCF9']
push ['offset', '$SG90110']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_DCE2']
push ['offset', '$SG90115']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
push ['offset', '$SG90116']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+0F8h],', '0']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '0D8h']
push ['ecx']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
mov ['ecx,', '50h']
sub ['ecx,', 'eax']
push ['ecx']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
lea ['eax,', '[ebp+eax+Dest]']
push ['eax']
call ['_rsa_fingerprint']
add ['esp,', '0Ch']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'eax']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+18h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
and ['eax,', '8']
jz ['short', 'loc_DDEC']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+18h]']
and ['edx,', '0FFFFFFFBh']
mov ['eax,', '[ebp+var_8C]']
mov ['[eax+18h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+40h]']
and ['edx,', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+44h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+44h]']
or ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+44h],', 'edx']
lea ['ecx,', '[ebp+var_84]']
push ['ecx']
call ['_MD5Init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0DCh]']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+10h]']
push ['edx']
lea ['eax,', '[ebp+var_84]']
push ['eax']
call ['_MD5Update']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
lea ['edx,', '[ebp+var_84]']
push ['edx']
call ['_MD5Update']
add ['esp,', '0Ch']
push ['8']
lea ['eax,', '[ebp+Dst]']
push ['eax']
lea ['ecx,', '[ebp+var_84]']
push ['ecx']
call ['_MD5Update']
add ['esp,', '0Ch']
lea ['edx,', '[ebp+var_84]']
push ['edx']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '2Ch']
push ['eax']
call ['_MD5Final']
add ['esp,', '8']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_DEA5']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
cmp ['[ebp+var_8],', '20h']
jge ['short', 'loc_DEBB']
call ['_random_byte']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '[ebp+var_8]']
mov ['[edx+1Ch],', 'al']
jmp ['short', 'loc_DE9C']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0DCh]']
shl ['ecx,', '3']
mov ['edx,', '[ebp+var_8C]']
cmp ['[edx+0D8h],', 'ecx']
jg ['short', 'loc_DEF5']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0B8h]']
shl ['ecx,', '3']
mov ['edx,', '[ebp+var_8C]']
cmp ['[edx+0B4h],', 'ecx']
jle ['short', 'loc_DF26']
push ['offset', '$SG90124']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_DF0F']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[eax+0DCh]']
cmp ['edx,', '[ecx+0B8h]']
jle ['short', 'loc_DF54']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0DCh]']
mov ['[ebp+var_2D4],', 'ecx']
jmp ['short', 'loc_DF66']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0B8h]']
mov ['[ebp+var_2D4],', 'eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ebp+var_2D4]']
mov ['[ecx+4],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8C]']
mov ['[edx+8],', 'eax']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '0D8h']
push ['eax']
call ['_rsastr_len']
add ['esp,', '4']
mov ['[ebp+var_EC],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_EC]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_15C],', 'eax']
mov ['edx,', '[ebp+var_8C]']
add ['edx,', '0D8h']
push ['edx']
mov ['eax,', '[ebp+var_15C]']
push ['eax']
call ['_rsastr_fmt']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '0D8h']
push ['ecx']
push ['64h']
lea ['edx,', '[ebp+var_154]']
push ['edx']
call ['_rsa_fingerprint']
add ['esp,', '0Ch']
push ['0']
push ['0']
lea ['eax,', '[ebp+var_154]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_verify_ssh_manual_host_key']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_8C]']
mov ['[edx+0ACh],', 'eax']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+0ACh],', '0']
jnz ['short', 'loc_E074']
push ['offset', '$SG90138']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_15C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_E058']
jmp ['loc_E1CC']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+0ACh],', '0']
jge ['loc_E1BD']
push ['1']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '_ssh_dialog_callback']
lea ['edx,', '[ebp+var_154]']
push ['edx']
mov ['eax,', '[ebp+var_15C]']
push ['eax']
push ['offset', '$SG90144']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0D4h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0D0h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_verify_ssh_host_key']
add ['esp,', '20h']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+0ACh],', 'eax']
mov ['edx,', '[ebp+var_15C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+0ACh],', '0']
jge ['short', 'loc_E170']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0F29h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_E101']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_E14F']
push ['offset', '$SG90154']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_E138']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_E101']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_E101']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+230h]']
mov ['[eax+0ACh],', 'edx']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+0ACh],', '0']
jnz ['short', 'loc_E1BB']
push ['1']
push ['0']
push ['0']
push ['offset', '$SG90160']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_E1A4']
jmp ['short', 'loc_E1CC']
mov ['edx,', '[ebp+var_15C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_E1DE']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '20h']
jge ['short', 'loc_E232']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_8]']
mov ['al,', '[eax+1Ch]']
mov ['[edx+ecx],', 'al']
cmp ['[ebp+var_8],', '10h']
jge ['short', 'loc_E230']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '[ebp+var_8]']
movzx ['ecx,', 'byte', 'ptr', '[eax+2Ch]']
mov ['eax,', '[ebp+var_8]']
movzx ['edx,', 'byte', 'ptr', '[edx+eax]']
xor ['edx,', 'ecx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+8]']
mov ['eax,', '[ebp+var_8]']
mov ['[ecx+eax],', 'dl']
jmp ['short', 'loc_E1D5']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ecx+0DCh]']
cmp ['eax,', '[edx+0B8h]']
jle ['short', 'loc_E2A7']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '0B4h']
push ['ecx']
push ['20h']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_rsaencrypt']
add ['esp,', '0Ch']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_E2A5']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '0D8h']
push ['ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_rsaencrypt']
add ['esp,', '0Ch']
mov ['[ebp+var_10],', 'eax']
jmp ['short', 'loc_E2FE']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '0D8h']
push ['eax']
push ['20h']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_rsaencrypt']
add ['esp,', '0Ch']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_E2FE']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '0B4h']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+0DCh]']
push ['edx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['_rsaencrypt']
add ['esp,', '0Ch']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jnz ['short', 'loc_E335']
push ['offset', '$SG90174']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_E31E']
push ['offset', '$SG90178']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['[ebp+var_160],', '0']
mov ['[ebp+var_164],', '0']
mov ['[ebp+var_168],', '0']
mov ['[ebp+var_16C],', '0']
jmp ['short', 'loc_E385']
mov ['ecx,', '[ebp+var_16C]']
add ['ecx,', '1']
mov ['[ebp+var_16C],', 'ecx']
cmp ['[ebp+var_160],', '0']
jnz ['loc_E499']
cmp ['[ebp+var_16C],', '6']
jge ['loc_E499']
mov ['edx,', '[ebp+var_16C]']
push ['edx']
push ['1Dh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['[ebp+var_170],', 'eax']
cmp ['[ebp+var_170],', '0']
jnz ['short', 'loc_E3D8']
mov ['[ebp+var_164],', '1']
jmp ['loc_E494']
cmp ['[ebp+var_170],', '3']
jnz ['short', 'loc_E3FD']
push ['offset', '$SG90191']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_E494']
mov ['ecx,', '[ebp+var_170]']
mov ['[ebp+var_2D8],', 'ecx']
cmp ['[ebp+var_2D8],', '1']
jz ['short', 'loc_E426']
cmp ['[ebp+var_2D8],', '2']
jz ['short', 'loc_E43F']
cmp ['[ebp+var_2D8],', '4']
jz ['short', 'loc_E458']
jmp ['short', 'loc_E46F']
mov ['edx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[edx+3Ch],', '3']
mov ['[ebp+var_168],', 'offset', '$SG90198']
jmp ['short', 'loc_E46F']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+3Ch],', '6']
mov ['[ebp+var_168],', 'offset', '$SG90200']
jmp ['short', 'loc_E46F']
mov ['ecx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[ecx+3Ch],', '2']
mov ['[ebp+var_168],', 'offset', '$SG90202']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '1']
mov ['ecx,', '[edx+3Ch]']
shl ['eax,', 'cl']
mov ['ecx,', '[ebp+var_8C]']
and ['eax,', '[ecx+14h]']
jz ['short', 'loc_E494']
mov ['[ebp+var_160],', '1']
jmp ['loc_E376']
cmp ['[ebp+var_160],', '0']
jnz ['short', 'loc_E4FD']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+14h]']
and ['eax,', '8']
jnz ['short', 'loc_E4CC']
push ['offset', '$SG90206']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
jmp ['short', 'loc_E4E6']
push ['offset', '$SG90208']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_E4E6']
cmp ['[ebp+var_164],', '0']
jz ['loc_E614']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '_ssh_dialog_callback']
mov ['ecx,', '[ebp+var_168]']
push ['ecx']
push ['offset', '$SG90213']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_askalg']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+0ACh],', 'eax']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+0ACh],', '0']
jge ['short', 'loc_E5C9']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0F7Fh']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_E55A']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_E5A8']
push ['offset', '$SG90223']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_E591']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_E55A']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_E55A']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+230h]']
mov ['[edx+0ACh],', 'ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_set_frozen']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+0ACh],', '0']
jnz ['short', 'loc_E614']
push ['1']
push ['0']
push ['0']
push ['offset', '$SG90229']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_E5FD']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+3Ch]']
mov ['[ebp+var_2DC],', 'edx']
cmp ['[ebp+var_2DC],', '2']
jz ['short', 'loc_E659']
cmp ['[ebp+var_2DC],', '3']
jz ['short', 'loc_E640']
cmp ['[ebp+var_2DC],', '6']
jz ['short', 'loc_E672']
jmp ['short', 'loc_E689']
push ['offset', '$SG90238']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_E689']
push ['offset', '$SG90240']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_E689']
push ['offset', '$SG90242']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+44h]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+4]']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+8]']
push ['edx']
push ['3']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+4]']
shl ['ecx,', '3']
and ['ecx,', '0FFh']
push ['ecx']
push ['2']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+4]']
shl ['eax,', '3']
sar ['eax,', '8']
push ['eax']
push ['2']
push ['8']
lea ['ecx,', '[ebp+Dst]']
push ['ecx']
push ['3']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
push ['2']
push ['3']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '44h']
push ['offset', '$SG90243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+3Ch],', '6']
jnz ['short', 'loc_E734']
mov ['[ebp+var_2E0],', 'offset', '_ssh_blowfish_ssh1']
jmp ['short', 'loc_E762']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+3Ch],', '2']
jnz ['short', 'loc_E74C']
mov ['[ebp+var_2E4],', 'offset', '_ssh_des']
jmp ['short', 'loc_E756']
mov ['[ebp+var_2E4],', 'offset', '_ssh_3des']
mov ['edx,', '[ebp+var_2E4]']
mov ['[ebp+var_2E0],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_2E0]']
mov ['[eax+54h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+54h]']
mov ['esi,', 'esp']
mov ['ecx,', '[eax]']
call ['ecx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+58h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '1Ch']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+58h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+54h]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+54h]']
mov ['edx,', '[ecx+18h]']
push ['edx']
push ['offset', '$SG90244']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
call ['_crcda_make_context']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+5Ch],', 'eax']
push ['offset', '$SG90245']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+0BCh],', '0']
jz ['short', 'loc_E81D']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0BCh]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[ecx+0BCh],', '0']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+0C0h],', '0']
jz ['short', 'loc_E851']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0C0h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[edx+0C0h],', '0']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+0E0h],', '0']
jz ['short', 'loc_E885']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+0E0h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+0E0h],', '0']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+0E4h],', '0']
jz ['short', 'loc_E8B9']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[ecx+0E4h],', '0']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '0FC2h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_E8B9']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_E8B9']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '0Eh']
jz ['short', 'loc_E910']
push ['offset', '$SG90262']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_E8F9']
push ['offset', '$SG90266']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
call ['___iob_func']
add ['eax,', '20h']
push ['eax']
call ['_fflush']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_get_remote_username']
add ['esp,', '4']
mov ['[ebp+var_2E8],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_2E8]']
mov ['[eax+224h],', 'ecx']
cmp ['[ebp+var_2E8],', '0']
jnz ['loc_EACD']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_new_prompts']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+50h],', 'eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
mov ['dword', 'ptr', '[eax],', '1']
push ['offset', '$SG90270']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['[edx+4],', 'eax']
push ['1']
push ['offset', '$SG90271']
call ['_dupstr']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
call ['_add_prompt']
add ['esp,', '0Ch']
push ['0']
push ['0']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
push ['eax']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_174],', 'eax']
cmp ['[ebp+var_174],', '0']
jge ['short', 'loc_EA4F']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D8h],', '1']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '0FD6h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_EA03']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_EA03']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_174],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0D8h],', '0']
jmp ['short', 'loc_E9ED']
cmp ['[ebp+var_174],', '0']
jnz ['short', 'loc_EA98']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
call ['_free_prompts']
add ['esp,', '4']
push ['1']
push ['0']
push ['0']
push ['offset', '$SG90285']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_EA81']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+224h],', 'eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+224h]']
push ['edx']
push ['4']
push ['4']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_send_packet']
add ['esp,', '14h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+224h]']
push ['edx']
push ['offset', '$SG90290']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_178],', 'eax']
mov ['eax,', '[ebp+var_178]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', 'dword', 'ptr', 'ds:_flags']
and ['eax,', '4']
jz ['short', 'loc_EB63']
mov ['ecx,', 'dword', 'ptr', 'ds:_flags']
and ['ecx,', '2']
jz ['short', 'loc_EB3F']
mov ['edx,', 'dword', 'ptr', 'ds:_flags']
and ['edx,', '1']
jnz ['short', 'loc_EB63']
mov ['eax,', '[ebp+var_178]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG90293']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
mov ['eax,', '[ebp+var_178]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0FF3h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_EB72']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_EB72']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+18h]']
and ['ecx,', '4']
jnz ['short', 'loc_EBB9']
mov ['edx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[edx+20h],', '1']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+1Ch],', '1']
jmp ['short', 'loc_EBD3']
mov ['ecx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[ecx+20h],', '0']
mov ['edx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[edx+1Ch],', '0']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+28h],', '0']
mov ['ecx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[ecx+24h],', '0']
push ['1Eh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_filename']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+0B0h],', 'eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0B0h]']
push ['eax']
call ['_filename_is_null']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['loc_EDE0']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+0B0h]']
push ['edx']
call ['_filename_to_str']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG90305']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+0B0h]']
push ['edx']
call ['_key_type']
add ['esp,', '4']
mov ['[ebp+var_17C],', 'eax']
cmp ['[ebp+var_17C],', '2']
jnz ['loc_ED55']
lea ['eax,', '[ebp+var_184]']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '48h']
push ['ecx']
mov ['edx,', '[ebp+var_8C]']
add ['edx,', '44h']
push ['edx']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '40h']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+0B0h]']
push ['edx']
call ['_rsakey_pubblob']
add ['esp,', '14h']
test ['eax,', 'eax']
jz ['short', 'loc_ECD9']
push ['0']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0B0h]']
push ['ecx']
call ['_rsakey_encrypted']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8C]']
mov ['[edx+4Ch],', 'eax']
jmp ['short', 'loc_ED50']
mov ['eax,', '[ebp+var_184]']
push ['eax']
push ['offset', '$SG90312']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_184]']
push ['edx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0B0h]']
push ['ecx']
call ['_filename_to_str']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG90313']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_18C],', 'eax']
mov ['edx,', '[ebp+var_18C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_18C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[edx+40h],', '0']
jmp ['loc_EDDE']
mov ['eax,', '[ebp+var_17C]']
push ['eax']
call ['_key_type_to_str']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG90317']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_17C]']
push ['edx']
call ['_key_type_to_str']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0B0h]']
push ['ecx']
call ['_filename_to_str']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG90318']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_190],', 'eax']
mov ['edx,', '[ebp+var_190]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_190]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[edx+40h],', '0']
jmp ['short', 'loc_EDED']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+40h],', '0']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '0Fh']
jnz ['loc_10AC2']
mov ['edx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[edx+58h],', '9']
push ['1Ah']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_F99F']
call ['_agent_exists']
test ['eax,', 'eax']
jz ['loc_F99F']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+20h],', '0']
jnz ['loc_F99F']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+78h],', '0']
mov ['ecx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[ecx+20h],', '1']
push ['offset', '$SG90327']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8C]']
mov ['byte', 'ptr', '[ecx+5Ch],', '0']
mov ['edx,', '[ebp+var_8C]']
mov ['byte', 'ptr', '[edx+5Dh],', '0']
mov ['eax,', '[ebp+var_8C]']
mov ['byte', 'ptr', '[eax+5Eh],', '0']
mov ['ecx,', '[ebp+var_8C]']
mov ['byte', 'ptr', '[ecx+5Fh],', '1']
mov ['edx,', '[ebp+var_8C]']
mov ['byte', 'ptr', '[edx+60h],', '1']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '_ssh_agent_callback']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '6Ch']
push ['ecx']
lea ['edx,', '[ebp+var_198]']
push ['edx']
push ['5']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '5Ch']
push ['eax']
call ['_agent_query']
add ['esp,', '18h']
test ['eax,', 'eax']
jnz ['short', 'loc_EF50']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '1039h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_EED5']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_EF23']
push ['offset', '$SG90341']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_EF0C']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_EED5']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_EED5']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+228h]']
mov ['[ebp+var_198],', 'ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+22Ch]']
mov ['[edx+6Ch],', 'ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ebp+var_198]']
mov ['[edx+64h],', 'eax']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+64h],', '0']
jz ['loc_F977']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+6Ch],', '5']
jl ['loc_F977']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+64h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+4]']
cmp ['edx,', '2']
jnz ['loc_F977']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+64h]']
add ['ecx,', '5']
mov ['edx,', '[ebp+var_8C]']
mov ['[edx+68h],', 'ecx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+68h]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
shl ['edx,', '18h']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+68h]']
movzx ['eax,', 'byte', 'ptr', '[ecx+1]']
shl ['eax,', '10h']
or ['edx,', 'eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['eax,', '[ecx+68h]']
movzx ['ecx,', 'byte', 'ptr', '[eax+2]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+68h]']
movzx ['eax,', 'byte', 'ptr', '[ecx+3]']
or ['edx,', 'eax']
push ['edx']
call ['_toint']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+74h],', 'eax']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+74h],', '0']
jge ['short', 'loc_F032']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+74h]']
push ['ecx']
push ['offset', '$SG90356']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+74h],', '0']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+68h]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_8C]']
mov ['[eax+68h],', 'edx']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+74h]']
push ['edx']
push ['offset', '$SG90357']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[ecx+70h],', '0']
jmp ['short', 'loc_F086']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+70h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+70h],', 'eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[edx+70h]']
cmp ['ecx,', '[eax+74h]']
jge ['loc_F934']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+68h]']
mov ['[ebp+Buf1],', 'eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+68h]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_8C]']
mov ['[eax+68h],', 'edx']
mov ['[ebp+var_1A8],', '0']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '88h']
push ['ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[edx+68h]']
sub ['ecx,', '[eax+64h]']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+6Ch]']
sub ['eax,', 'ecx']
push ['eax']
call ['_toint']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+68h]']
push ['edx']
call ['_ssh1_read_bignum']
add ['esp,', '0Ch']
mov ['[ebp+var_1A4],', 'eax']
cmp ['[ebp+var_1A4],', '0']
jge ['short', 'loc_F126']
jmp ['loc_F2CC']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+68h]']
add ['ecx,', '[ebp+var_1A4]']
mov ['edx,', '[ebp+var_8C]']
mov ['[edx+68h],', 'ecx']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '84h']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ecx+68h]']
sub ['eax,', '[edx+64h]']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+6Ch]']
sub ['edx,', 'eax']
push ['edx']
call ['_toint']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+68h]']
push ['ecx']
call ['_ssh1_read_bignum']
add ['esp,', '0Ch']
mov ['[ebp+var_1A4],', 'eax']
cmp ['[ebp+var_1A4],', '0']
jge ['short', 'loc_F197']
jmp ['loc_F2CC']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+68h]']
add ['eax,', '[ebp+var_1A4]']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+68h],', 'eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[edx+68h]']
sub ['ecx,', '[eax+64h]']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+6Ch]']
sub ['eax,', 'ecx']
cmp ['eax,', '4']
jge ['short', 'loc_F1D6']
jmp ['loc_F2CC']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+68h]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+68h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+1]']
shl ['ecx,', '10h']
or ['eax,', 'ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['ecx,', '[edx+68h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+68h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+3]']
or ['eax,', 'ecx']
push ['eax']
call ['_toint']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['[edx+0A8h],', 'eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+68h]']
add ['ecx,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['[edx+68h],', 'ecx']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+0A8h],', '0']
jl ['short', 'loc_F285']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ecx+68h]']
sub ['eax,', '[edx+64h]']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+6Ch]']
sub ['edx,', 'eax']
push ['edx']
call ['_toint']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
cmp ['eax,', '[ecx+0A8h]']
jge ['short', 'loc_F287']
jmp ['short', 'loc_F2CC']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+68h]']
mov ['[edx+0A4h],', 'ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+68h]']
mov ['ecx,', '[ebp+var_8C]']
add ['eax,', '[ecx+0A8h]']
mov ['edx,', '[ebp+var_8C]']
mov ['[edx+68h],', 'eax']
mov ['[ebp+var_1A8],', '1']
xor ['eax,', 'eax']
jnz ['loc_F0CC']
cmp ['[ebp+var_1A8],', '0']
jnz ['short', 'loc_F2F1']
push ['offset', '$SG90382']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_F934']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+40h],', '0']
jz ['short', 'loc_F353']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+44h]']
push ['edx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+40h]']
push ['ecx']
mov ['edx,', '[ebp+Buf1]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_F34E']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
push ['offset', '$SG90385']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+1Ch],', '1']
jmp ['short', 'loc_F353']
jmp ['loc_F071']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+70h]']
push ['edx']
push ['offset', '$SG90387']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
push ['0']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+84h]']
push ['edx']
push ['5']
push ['6']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_send_packet']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '107Fh']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_F38D']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_F38D']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '7']
jz ['short', 'loc_F3CF']
push ['offset', '$SG90396']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_F071']
push ['offset', '$SG90397']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh1_pkt_getmp']
add ['esp,', '4']
mov ['[ebp+var_2EC],', 'eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[ebp+var_2EC]']
mov ['[eax+0A0h],', 'ecx']
cmp ['[ebp+var_2EC],', '0']
jnz ['short', 'loc_F444']
push ['offset', '$SG90400']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_F42D']
mov ['[ebp+var_1C4],', '5']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+88h]']
push ['eax']
call ['_ssh1_bignum_length']
add ['esp,', '4']
add ['eax,', '[ebp+var_1C4]']
mov ['[ebp+var_1C4],', 'eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+84h]']
push ['edx']
call ['_ssh1_bignum_length']
add ['esp,', '4']
add ['eax,', '[ebp+var_1C4]']
mov ['[ebp+var_1C4],', 'eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0A0h]']
push ['ecx']
call ['_ssh1_bignum_length']
add ['esp,', '4']
add ['eax,', '[ebp+var_1C4]']
mov ['[ebp+var_1C4],', 'eax']
mov ['edx,', '[ebp+var_1C4]']
add ['edx,', '10h']
mov ['[ebp+var_1C4],', 'edx']
mov ['eax,', '[ebp+var_1C4]']
add ['eax,', '4']
mov ['[ebp+var_1C4],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_1C4]']
add ['ecx,', '4']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_1AC],', 'eax']
mov ['edx,', '[ebp+var_1C4]']
sar ['edx,', '18h']
mov ['eax,', '[ebp+var_1AC]']
mov ['[eax],', 'dl']
mov ['ecx,', '[ebp+var_1C4]']
sar ['ecx,', '10h']
mov ['edx,', '[ebp+var_1AC]']
mov ['[edx+1],', 'cl']
mov ['eax,', '[ebp+var_1C4]']
sar ['eax,', '8']
mov ['ecx,', '[ebp+var_1AC]']
mov ['[ecx+2],', 'al']
mov ['edx,', '[ebp+var_1AC]']
mov ['al,', 'byte', 'ptr', '[ebp+var_1C4]']
mov ['[edx+3],', 'al']
mov ['ecx,', '[ebp+var_1AC]']
add ['ecx,', '4']
mov ['[ebp+var_1B0],', 'ecx']
mov ['edx,', '[ebp+var_1B0]']
mov ['byte', 'ptr', '[edx],', '3']
mov ['eax,', '[ebp+var_1B0]']
add ['eax,', '1']
mov ['[ebp+var_1B0],', 'eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+84h]']
push ['edx']
call ['_bignum_bitcount']
add ['esp,', '4']
sar ['eax,', '18h']
mov ['ecx,', '[ebp+var_1B0]']
mov ['[ecx],', 'al']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+84h]']
push ['eax']
call ['_bignum_bitcount']
add ['esp,', '4']
sar ['eax,', '10h']
mov ['ecx,', '[ebp+var_1B0]']
mov ['[ecx+1],', 'al']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+84h]']
push ['eax']
call ['_bignum_bitcount']
add ['esp,', '4']
sar ['eax,', '8']
mov ['ecx,', '[ebp+var_1B0]']
mov ['[ecx+2],', 'al']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+84h]']
push ['eax']
call ['_bignum_bitcount']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_1B0]']
mov ['[ecx+3],', 'al']
mov ['edx,', '[ebp+var_1B0]']
add ['edx,', '4']
mov ['[ebp+var_1B0],', 'edx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+88h]']
push ['ecx']
mov ['edx,', '[ebp+var_1B0]']
push ['edx']
call ['_ssh1_write_bignum']
add ['esp,', '8']
add ['eax,', '[ebp+var_1B0]']
mov ['[ebp+var_1B0],', 'eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+84h]']
push ['ecx']
mov ['edx,', '[ebp+var_1B0]']
push ['edx']
call ['_ssh1_write_bignum']
add ['esp,', '8']
add ['eax,', '[ebp+var_1B0]']
mov ['[ebp+var_1B0],', 'eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0A0h]']
push ['ecx']
mov ['edx,', '[ebp+var_1B0]']
push ['edx']
call ['_ssh1_write_bignum']
add ['esp,', '8']
add ['eax,', '[ebp+var_1B0]']
mov ['[ebp+var_1B0],', 'eax']
push ['10h']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '2Ch']
push ['eax']
mov ['ecx,', '[ebp+var_1B0]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_1B0]']
add ['edx,', '10h']
mov ['[ebp+var_1B0],', 'edx']
mov ['eax,', '[ebp+var_1B0]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+var_1B0]']
mov ['byte', 'ptr', '[ecx+1],', '0']
mov ['edx,', '[ebp+var_1B0]']
mov ['byte', 'ptr', '[edx+2],', '0']
mov ['eax,', '[ebp+var_1B0]']
mov ['byte', 'ptr', '[eax+3],', '1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '_ssh_agent_callback']
lea ['edx,', '[ebp+var_1CC]']
push ['edx']
lea ['eax,', '[ebp+var_1BC]']
push ['eax']
mov ['ecx,', '[ebp+var_1C4]']
add ['ecx,', '4']
push ['ecx']
mov ['edx,', '[ebp+var_1AC]']
push ['edx']
call ['_agent_query']
add ['esp,', '18h']
test ['eax,', 'eax']
jnz ['loc_F76D']
mov ['eax,', '[ebp+var_1AC]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '10A4h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_F6F3']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_F741']
push ['offset', '$SG90433']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_F72A']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_F6F3']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_F6F3']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+228h]']
mov ['[ebp+var_1BC],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+22Ch]']
mov ['[ebp+var_1CC],', 'eax']
jmp ['short', 'loc_F77C']
mov ['ecx,', '[ebp+var_1AC]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_1BC]']
mov ['[ebp+var_1B4],', 'edx']
cmp ['[ebp+var_1B4],', '0']
jz ['loc_F8CB']
mov ['eax,', '[ebp+var_1B4]']
movsx ['ecx,', 'byte', 'ptr', '[eax+4]']
cmp ['ecx,', '4']
jnz ['loc_F8A3']
push ['offset', '$SG90440']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
push ['0']
push ['10h']
mov ['ecx,', '[ebp+var_1B4]']
add ['ecx,', '5']
push ['ecx']
push ['3']
push ['8']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '18h']
mov ['eax,', '[ebp+var_1B4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '10B8h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_F7EC']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_F7EC']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '0Eh']
jnz ['short', 'loc_F88A']
push ['offset', '$SG90449']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', 'dword', 'ptr', 'ds:_flags']
and ['eax,', '1']
jz ['short', 'loc_F87B']
push ['offset', '$SG90451']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0A8h]']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+0A4h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write']
add ['esp,', '0Ch']
push ['offset', '$SG90452']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[edx+78h],', '1']
jmp ['short', 'loc_F8A1']
push ['offset', '$SG90454']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_F8C9']
push ['offset', '$SG90456']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_1B4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_F8E2']
push ['offset', '$SG90458']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+88h]']
push ['edx']
call ['_freebn']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+84h]']
push ['ecx']
call ['_freebn']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0A0h]']
push ['eax']
call ['_freebn']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+78h],', '0']
jz ['short', 'loc_F92F']
jmp ['short', 'loc_F934']
jmp ['loc_F071']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+64h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+40h],', '0']
jz ['short', 'loc_F975']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+1Ch],', '0']
jnz ['short', 'loc_F975']
push ['offset', '$SG90461']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_F98E']
push ['offset', '$SG90463']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+78h],', '0']
jz ['short', 'loc_F99F']
jmp ['loc_10AC2']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+40h],', '0']
jz ['loc_FFDD']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+1Ch],', '0']
jnz ['loc_FFDD']
mov ['ecx,', 'dword', 'ptr', 'ds:_flags']
and ['ecx,', '1']
jz ['short', 'loc_F9DB']
push ['offset', '$SG90468']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
push ['1Eh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_filename']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8C]']
mov ['[edx+0B0h],', 'eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+0B0h]']
push ['ecx']
call ['_filename_to_str']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG90469']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+1Ch],', '1']
mov ['[ebp+var_1D4],', '0']
cmp ['[ebp+var_1D4],', '0']
jnz ['loc_FD54']
mov ['[ebp+Str],', '0']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+4Ch],', '0']
jnz ['short', 'loc_FA87']
mov ['edx,', 'dword', 'ptr', 'ds:_flags']
and ['edx,', '1']
jz ['short', 'loc_FA78']
push ['offset', '$SG90478']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
mov ['[ebp+Str],', '0']
jmp ['loc_FBEF']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_new_prompts']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+50h],', 'eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
mov ['dword', 'ptr', '[eax],', '0']
push ['offset', '$SG90482']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['[edx+4],', 'eax']
push ['0']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+48h]']
push ['ecx']
push ['offset', '$SG90483']
call ['_dupprintf']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
push ['eax']
call ['_add_prompt']
add ['esp,', '0Ch']
push ['0']
push ['0']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
push ['edx']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_1E8],', 'eax']
cmp ['[ebp+var_1E8],', '0']
jge ['short', 'loc_FB74']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D8h],', '1']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '1101h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_FB28']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_FB28']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
push ['eax']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_1E8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D8h],', '0']
jmp ['short', 'loc_FB12']
cmp ['[ebp+var_1E8],', '0']
jnz ['short', 'loc_FBBD']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
push ['1']
push ['0']
push ['offset', '$SG90497']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_FBA6']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+Str],', 'eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
call ['_free_prompts']
add ['esp,', '4']
push ['1Eh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_filename']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+0B0h],', 'eax']
lea ['edx,', '[ebp+var_1E0]']
push ['edx']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
add ['ecx,', '7Ch']
push ['ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0B0h]']
push ['eax']
call ['_loadrsakey']
add ['esp,', '10h']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+Str],', '0']
jz ['short', 'loc_FC76']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_smemclr']
add ['esp,', '8']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+var_10],', '1']
jnz ['short', 'loc_FC8B']
mov ['[ebp+var_1D4],', '1']
jmp ['loc_FD4F']
cmp ['[ebp+var_10],', '0']
jnz ['short', 'loc_FD07']
push ['offset', '$SG90505']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+0B0h]']
push ['eax']
call ['_filename_to_str']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG90506']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
mov ['eax,', '[ebp+var_1E0]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG90507']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
mov ['[ebp+var_1D4],', '0']
jmp ['short', 'loc_FD54']
jmp ['short', 'loc_FD4F']
cmp ['[ebp+var_10],', '0FFFFFFFFh']
jnz ['short', 'loc_FD2A']
push ['offset', '$SG90510']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
mov ['[ebp+var_1D4],', '0']
jmp ['short', 'loc_FD4F']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_FD45']
push ['1129h']
push ['offset', '$SG90513']
push ['offset', '$SG90514']
call ['__wassert']
add ['esp,', '0Ch']
mov ['[ebp+var_1D4],', '0']
jmp ['loc_FA39']
cmp ['[ebp+var_1D4],', '0']
jz ['loc_FFDD']
push ['0']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+84h]']
push ['ecx']
push ['5']
push ['6']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '14h']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '1136h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_FD80']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_FD80']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '0Fh']
jnz ['short', 'loc_FDBC']
push ['offset', '$SG90524']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
jmp ['loc_EDED']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '7']
jz ['short', 'loc_FDF6']
push ['offset', '$SG90526']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_FDDF']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh1_pkt_getmp']
add ['esp,', '4']
mov ['[ebp+var_218],', 'eax']
cmp ['[ebp+var_218],', '0']
jnz ['short', 'loc_FE42']
push ['offset', '$SG90536']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_FE2B']
mov ['eax,', '[ebp+var_8C]']
add ['eax,', '7Ch']
push ['eax']
mov ['ecx,', '[ebp+var_218]']
push ['ecx']
call ['_rsadecrypt']
add ['esp,', '8']
mov ['[ebp+var_21C],', 'eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+8Ch]']
push ['eax']
call ['_freebn']
add ['esp,', '4']
mov ['[ebp+var_1EC],', '0']
jmp ['short', 'loc_FE91']
mov ['ecx,', '[ebp+var_1EC]']
add ['ecx,', '1']
mov ['[ebp+var_1EC],', 'ecx']
cmp ['[ebp+var_1EC],', '20h']
jge ['short', 'loc_FEC4']
mov ['edx,', '1Fh']
sub ['edx,', '[ebp+var_1EC]']
push ['edx']
mov ['eax,', '[ebp+var_21C]']
push ['eax']
call ['_bignum_byte']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_1EC]']
mov ['[ebp+ecx+var_210],', 'al']
jmp ['short', 'loc_FE82']
lea ['edx,', '[ebp+var_84]']
push ['edx']
call ['_MD5Init']
add ['esp,', '4']
push ['20h']
lea ['eax,', '[ebp+var_210]']
push ['eax']
lea ['ecx,', '[ebp+var_84]']
push ['ecx']
call ['_MD5Update']
add ['esp,', '0Ch']
push ['10h']
mov ['edx,', '[ebp+var_8C]']
add ['edx,', '2Ch']
push ['edx']
lea ['eax,', '[ebp+var_84]']
push ['eax']
call ['_MD5Update']
add ['esp,', '0Ch']
lea ['ecx,', '[ebp+var_84]']
push ['ecx']
lea ['edx,', '[ebp+var_210]']
push ['edx']
call ['_MD5Final']
add ['esp,', '8']
push ['0']
push ['10h']
lea ['eax,', '[ebp+var_210]']
push ['eax']
push ['3']
push ['8']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '18h']
mov ['edx,', '[ebp+var_218]']
push ['edx']
call ['_freebn']
add ['esp,', '4']
mov ['eax,', '[ebp+var_21C]']
push ['eax']
call ['_freebn']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '115Ch']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_FF55']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_FF55']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '0Fh']
jnz ['short', 'loc_FF9E']
mov ['ecx,', 'dword', 'ptr', 'ds:_flags']
and ['ecx,', '1']
jz ['short', 'loc_FF97']
push ['offset', '$SG90552']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
jmp ['loc_EDED']
jmp ['short', 'loc_FFD8']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '0Eh']
jz ['short', 'loc_FFD8']
push ['offset', '$SG90555']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_FFC1']
jmp ['loc_10AC2']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_new_prompts']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ecx+50h],', 'eax']
push ['23h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_10277']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+18h]']
and ['edx,', '20h']
jz ['loc_10277']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+24h],', '0']
jnz ['loc_10277']
mov ['ecx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[ecx+58h],', '29h']
push ['offset', '$SG90560']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
push ['0']
push ['27h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '1177h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_1006A']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1006A']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '28h']
jz ['short', 'loc_100DA']
push ['offset', '$SG90569']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', 'dword', 'ptr', 'ds:_flags']
and ['ecx,', '4']
jz ['short', 'loc_100C3']
push ['offset', '$SG90571']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+24h],', '1']
jmp ['loc_EDED']
jmp ['loc_10277']
lea ['ecx,', '[ebp+MaxCount]']
push ['ecx']
lea ['edx,', '[ebp+Buf]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Buf],', '0']
jnz ['short', 'loc_1012E']
push ['offset', '$SG90578']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_10117']
push ['offset', '$SG90582']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+50h]']
mov ['dword', 'ptr', '[ecx],', '1']
push ['offset', '$SG90583']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['ecx,', '[edx+50h]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+MaxCount]']
push ['edx']
push ['0Ah']
mov ['eax,', '[ebp+Buf]']
push ['eax']
call ['_memchr']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_101BF']
push ['offset', '$SG90585']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+var_238],', 'eax']
mov ['ecx,', '[ebp+Buf]']
push ['ecx']
mov ['edx,', '[ebp+MaxCount]']
push ['edx']
push ['offset', '$SG90586']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_23C],', 'eax']
jmp ['short', 'loc_101F3']
mov ['eax,', '[ebp+Buf]']
push ['eax']
mov ['ecx,', '[ebp+MaxCount]']
push ['ecx']
push ['offset', '$SG90588']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_238],', 'eax']
push ['offset', '$SG90589']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+var_23C],', 'eax']
mov ['edx,', '[ebp+var_238]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['short', 'loc_1020C']
mov ['[ebp+var_2F0],', 'offset', '$SG90590']
jmp ['short', 'loc_10216']
mov ['[ebp+var_2F0],', 'offset', '$SG90591']
mov ['ecx,', '[ebp+var_238]']
push ['ecx']
mov ['edx,', '[ebp+var_2F0]']
push ['edx']
push ['offset', '$SG90592']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['[edx+0Ch],', 'eax']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+50h]']
mov ['dword', 'ptr', '[ecx+10h],', '1']
push ['0']
mov ['edx,', '[ebp+var_23C]']
push ['edx']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
call ['_add_prompt']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_238]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['23h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_104FD']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+18h]']
and ['eax,', '10000h']
jz ['loc_104FD']
mov ['ecx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[ecx+28h],', '0']
jnz ['loc_104FD']
mov ['edx,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[edx+58h],', '48h']
push ['offset', '$SG90594']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
push ['0']
push ['46h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '11A2h']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_102EB']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_102EB']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '47h']
jz ['short', 'loc_10350']
push ['offset', '$SG90603']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
push ['offset', '$SG90604']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8C]']
mov ['dword', 'ptr', '[eax+28h],', '1']
jmp ['loc_EDED']
jmp ['loc_104FD']
lea ['ecx,', '[ebp+var_250]']
push ['ecx']
lea ['edx,', '[ebp+var_244]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_244],', '0']
jnz ['short', 'loc_103A4']
push ['offset', '$SG90611']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['eax,', 'eax']
jnz ['short', 'loc_1038D']
push ['offset', '$SG90615']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+50h]']
mov ['dword', 'ptr', '[ecx],', '1']
push ['offset', '$SG90616']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['ecx,', '[edx+50h]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
mov ['dword', 'ptr', '[eax+8],', '0']
mov ['ecx,', '[ebp+var_250]']
push ['ecx']
push ['0Ah']
mov ['edx,', '[ebp+var_244]']
push ['edx']
call ['_memchr']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_10445']
push ['offset', '$SG90618']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+var_258],', 'eax']
mov ['eax,', '[ebp+var_244]']
push ['eax']
mov ['ecx,', '[ebp+var_250]']
push ['ecx']
push ['offset', '$SG90619']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_25C],', 'eax']
jmp ['short', 'loc_10479']
mov ['edx,', '[ebp+var_244]']
push ['edx']
mov ['eax,', '[ebp+var_250]']
push ['eax']
push ['offset', '$SG90621']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_258],', 'eax']
push ['offset', '$SG90622']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+var_25C],', 'eax']
mov ['ecx,', '[ebp+var_258]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_10492']
mov ['[ebp+var_2F4],', 'offset', '$SG90623']
jmp ['short', 'loc_1049C']
mov ['[ebp+var_2F4],', 'offset', '$SG90624']
mov ['eax,', '[ebp+var_258]']
push ['eax']
mov ['ecx,', '[ebp+var_2F4]']
push ['ecx']
push ['offset', '$SG90625']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8C]']
mov ['ecx,', '[edx+50h]']
mov ['[ecx+0Ch],', 'eax']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
mov ['dword', 'ptr', '[eax+10h],', '1']
push ['0']
mov ['ecx,', '[ebp+var_25C]']
push ['ecx']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
push ['eax']
call ['_add_prompt']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_258]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+58h],', '9']
jnz ['loc_105AA']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+18h]']
and ['ecx,', '8']
jnz ['short', 'loc_1054C']
push ['offset', '$SG90628']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_10535']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
mov ['dword', 'ptr', '[eax],', '1']
push ['offset', '$SG90632']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['[edx+4],', 'eax']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0D0h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+224h]']
push ['eax']
push ['offset', '$SG90633']
call ['_dupprintf']
add ['esp,', '0Ch']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
push ['edx']
call ['_add_prompt']
add ['esp,', '0Ch']
push ['0']
push ['0']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_260],', 'eax']
cmp ['[ebp+var_260],', '0']
jge ['short', 'loc_10628']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0D8h],', '1']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '11DDh']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_105DC']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_105DC']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
push ['edx']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_260],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D8h],', '0']
jmp ['short', 'loc_105C6']
cmp ['[ebp+var_260],', '0']
jnz ['short', 'loc_10671']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
push ['edx']
call ['_free_prompts']
add ['esp,', '4']
push ['1']
push ['0']
push ['offset', '$SG90648']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_1065A']
mov ['eax,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[eax+58h],', '9']
jnz ['loc_109CF']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+50h]']
and ['edx,', '1']
jnz ['loc_10857']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
and ['ecx,', '4']
jnz ['loc_10857']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_26C],', 'eax']
cmp ['[ebp+var_26C],', '10h']
jge ['short', 'loc_106DE']
mov ['[ebp+var_264],', '0']
mov ['[ebp+var_268],', '0Fh']
jmp ['short', 'loc_106FC']
mov ['ecx,', '[ebp+var_26C]']
and ['ecx,', '0FFFFFFF8h']
mov ['[ebp+var_264],', 'ecx']
mov ['edx,', '[ebp+var_264]']
add ['edx,', '7']
mov ['[ebp+var_268],', 'edx']
mov ['eax,', '[ebp+var_26C]']
cmp ['eax,', '[ebp+var_264]']
jl ['short', 'loc_10718']
mov ['ecx,', '[ebp+var_26C]']
cmp ['ecx,', '[ebp+var_268]']
jle ['short', 'loc_1072F']
push ['1225h']
push ['offset', '$SG90662']
push ['offset', '$SG90663']
call ['__wassert']
add ['esp,', '0Ch']
push ['1']
mov ['eax,', '[ebp+var_268]']
add ['eax,', '1']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_274],', 'eax']
mov ['ecx,', '[ebp+var_264]']
mov ['[ebp+var_270],', 'ecx']
jmp ['short', 'loc_10766']
mov ['edx,', '[ebp+var_270]']
add ['edx,', '1']
mov ['[ebp+var_270],', 'edx']
mov ['eax,', '[ebp+var_270]']
cmp ['eax,', '[ebp+var_268]']
jg ['loc_10820']
mov ['ecx,', '[ebp+var_270]']
cmp ['ecx,', '[ebp+var_26C]']
jnz ['short', 'loc_107B4']
push ['0']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+8]']
push ['eax']
push ['4']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+58h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_defer_packet']
add ['esp,', '14h']
jmp ['short', 'loc_1081B']
mov ['[ebp+var_C],', '0']
jmp ['short', 'loc_107C6']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '1']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_C]']
cmp ['edx,', '[ebp+var_270]']
jge ['short', 'loc_107F3']
call ['_random_byte']
mov ['ecx,', '[ebp+var_274]']
add ['ecx,', '[ebp+var_C]']
mov ['[ecx],', 'al']
mov ['edx,', '[ebp+var_274]']
add ['edx,', '[ebp+var_C]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['short', 'loc_107D1']
jmp ['short', 'loc_107BD']
mov ['ecx,', '[ebp+var_274]']
add ['ecx,', '[ebp+var_270]']
mov ['byte', 'ptr', '[ecx],', '0']
push ['0']
mov ['edx,', '[ebp+var_274]']
push ['edx']
push ['4']
push ['20h']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_defer_packet']
add ['esp,', '14h']
jmp ['loc_10757']
push ['offset', '$SG90677']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_pkt_defersend']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_274]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_109CD']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
and ['eax,', '4']
jnz ['loc_1095A']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_2C4],', 'eax']
cmp ['[ebp+var_2C4],', '40h']
jnb ['short', 'loc_108F9']
lea ['eax,', '[ebp+var_2B8]']
mov ['[ebp+var_2C0],', 'eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
push ['edx']
lea ['eax,', '[ebp+var_2B8]']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_2C4]']
add ['ecx,', '1']
mov ['[ebp+var_2C4],', 'ecx']
cmp ['[ebp+var_2C4],', '40h']
jnb ['short', 'loc_108F7']
call ['_random_byte']
mov ['edx,', '[ebp+var_2C4]']
mov ['[ebp+edx+var_2B8],', 'al']
mov ['eax,', '[ebp+var_2C4]']
add ['eax,', '1']
mov ['[ebp+var_2C4],', 'eax']
jmp ['short', 'loc_108CB']
jmp ['short', 'loc_10910']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
mov ['[ebp+var_2C0],', 'edx']
push ['offset', '$SG90689']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
push ['0']
mov ['edx,', '[ebp+var_2C4]']
push ['edx']
mov ['eax,', '[ebp+var_2C0]']
push ['eax']
push ['3']
mov ['ecx,', '[ebp+var_2C4]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+58h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '20h']
jmp ['short', 'loc_109CD']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_2C8],', 'eax']
push ['offset', '$SG90692']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['0']
mov ['eax,', '[ebp+var_2C8]']
push ['eax']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
push ['edx']
push ['3']
mov ['eax,', '[ebp+var_2C8]']
push ['eax']
push ['1']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+58h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_send_packet']
add ['esp,', '20h']
jmp ['short', 'loc_109FB']
push ['0']
mov ['ecx,', '[ebp+var_8C]']
mov ['edx,', '[ecx+50h]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
push ['edx']
push ['4']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+58h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '14h']
push ['offset', '$SG90694']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+50h]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_90]']
mov ['dword', 'ptr', '[ecx],', '126Ah']
xor ['eax,', 'eax']
jmp ['loc_10B1A']
xor ['edx,', 'edx']
jnz ['short', 'loc_10A24']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_10A24']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '0Fh']
jnz ['short', 'loc_10A7F']
mov ['ecx,', 'dword', 'ptr', 'ds:_flags']
and ['ecx,', '1']
jz ['short', 'loc_10A66']
push ['offset', '$SG90704']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG90705']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_10ABD']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '0Eh']
jz ['short', 'loc_10ABD']
mov ['eax,', '[ebp+arg_C]']
mov ['ecx,', '[eax+8]']
push ['ecx']
push ['offset', '$SG90708']
call ['_dupprintf']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['short', 'loc_10B1A']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_10AA9']
jmp ['loc_EDED']
mov ['edx,', '[ebp+var_8C]']
cmp ['dword', 'ptr', '[edx+40h],', '0']
jz ['short', 'loc_10AF2']
mov ['eax,', '[ebp+var_8C]']
mov ['ecx,', '[eax+40h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8C]']
mov ['eax,', '[edx+48h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['offset', '$SG90713']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_90]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['eax,', '1']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN419']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '2F4h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_defer_packet   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
lea ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_construct_packet']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_s_wrpkt_defer']
add ['esp,', '8']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_s_wrpkt_defer  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+Size],', 'eax']
lea ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_s_wrpkt_prepare']
add ['esp,', '0Ch']
mov ['[ebp+Size],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+140h]']
add ['ecx,', '[ebp+Size]']
mov ['edx,', '[ebp+arg_0]']
cmp ['ecx,', '[edx+144h]']
jle ['short', 'loc_10EE0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+140h]']
mov ['edx,', '[ebp+Size]']
lea ['eax,', '[ecx+edx+80h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+144h],', 'eax']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+144h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+13Ch]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+13Ch],', 'eax']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+10h]']
add ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+13Ch]']
mov ['ecx,', '[ebp+arg_0]']
add ['eax,', '[ecx+140h]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+140h]']
add ['eax,', '[ebp+Size]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+140h],', 'eax']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_free_packet']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN6_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_pkt_getdata proc near              
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+18h]']
cmp ['edx,', '[ebp+arg_4]']
jge ['short', 'loc_10F7F']
xor ['eax,', 'eax']
jmp ['short', 'loc_10F9D']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
add ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+18h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+18h]']
sub ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_0]']
add ['eax,', '[ecx+14h]']
pop ['ebp']
retn
endp
_ssh1_pkt_getrsakey proc near           
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['0']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx]']
sub ['ecx,', '[eax+18h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[ebp+arg_0]']
add ['eax,', '[ecx+18h]']
push ['eax']
call ['_makekey']
add ['esp,', '14h']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jge ['short', 'loc_10FEB']
xor ['eax,', 'eax']
jmp ['short', 'loc_11023']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
add ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+18h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+18h]']
cmp ['ecx,', '[eax]']
jl ['short', 'loc_1101E']
push ['9F0h']
push ['offset', '$SG89198']
push ['offset', '$SG89199']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '1']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_pkt_getmp proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx]']
sub ['eax,', '[edx+18h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['eax,', '[ebp+arg_0]']
add ['edx,', '[eax+18h]']
push ['edx']
call ['_ssh1_read_bignum']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jge ['short', 'loc_11081']
xor ['eax,', 'eax']
jmp ['short', 'loc_11093']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
add ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+18h],', 'edx']
mov ['eax,', '[ebp+var_C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN6_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_agent_callback proc near           
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+228h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+22Ch],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+16Ch],', '1']
jnz ['short', 'loc_11121']
push ['0']
push ['0FFFFFFFFh']
push ['0']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_do_ssh1_login']
add ['esp,', '10h']
jmp ['short', 'loc_11133']
push ['0']
push ['0FFFFFFFFh']
push ['0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_do_ssh2_authconn']
add ['esp,', '10h']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_in_commasep_string proc near           
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+Size],', '0CCCCCCCCh']
cmp ['[ebp+Str],', '0']
jz ['short', 'loc_1115F']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_11166']
xor ['eax,', 'eax']
jmp ['loc_11205']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+Size],', 'eax']
mov ['ecx,', '1']
test ['ecx,', 'ecx']
jz ['loc_11205']
mov ['edx,', '[ebp+arg_8]']
cmp ['edx,', '[ebp+Size]']
jl ['short', 'loc_111BF']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_111BF']
mov ['eax,', '[ebp+arg_8]']
cmp ['eax,', '[ebp+Size]']
jz ['short', 'loc_111B8']
mov ['ecx,', '[ebp+Buf2]']
add ['ecx,', '[ebp+Size]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '2Ch']
jnz ['short', 'loc_111BF']
mov ['eax,', '1']
jmp ['short', 'loc_11205']
cmp ['[ebp+arg_8],', '0']
jle ['short', 'loc_111E4']
mov ['eax,', '[ebp+Buf2]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '2Ch']
jz ['short', 'loc_111E4']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', '1']
mov ['[ebp+arg_8],', 'edx']
mov ['eax,', '[ebp+Buf2]']
add ['eax,', '1']
mov ['[ebp+Buf2],', 'eax']
jmp ['short', 'loc_111BF']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_111EE']
xor ['eax,', 'eax']
jmp ['short', 'loc_11205']
mov ['ecx,', '[ebp+arg_8]']
sub ['ecx,', '1']
mov ['[ebp+arg_8],', 'ecx']
mov ['edx,', '[ebp+Buf2]']
add ['edx,', '1']
mov ['[ebp+Buf2],', 'edx']
jmp ['loc_11175']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_first_in_commasep_string proc near     
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+Size],', '0CCCCCCCCh']
cmp ['[ebp+Str],', '0']
jz ['short', 'loc_1122F']
cmp ['[ebp+Buf2],', '0']
jnz ['short', 'loc_11233']
xor ['eax,', 'eax']
jmp ['short', 'loc_11281']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+Size],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
cmp ['ecx,', '[ebp+Size]']
jl ['short', 'loc_1127F']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_1127F']
mov ['edx,', '[ebp+arg_8]']
cmp ['edx,', '[ebp+Size]']
jz ['short', 'loc_11278']
mov ['eax,', '[ebp+Buf2]']
add ['eax,', '[ebp+Size]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '2Ch']
jnz ['short', 'loc_1127F']
mov ['eax,', '1']
jmp ['short', 'loc_11281']
xor ['eax,', 'eax']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_mkkey     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ecx+1Ch]']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['esi,', 'esp']
mov ['ecx,', '[eax]']
call ['ecx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
and ['eax,', '20h']
jnz ['short', 'loc_112EE']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_hash_mpint']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
lea ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0BCh]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '9Ch']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
mov ['esi,', 'esp']
mov ['ecx,', '[eax]']
call ['ecx']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
and ['eax,', '20h']
jnz ['short', 'loc_113A9']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_hash_mpint']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_10]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_10]']
add ['edx,', '[ecx+0Ch]']
mov ['esi,', 'esp']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_add_channel_data proc near        
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '20h']
push ['edx']
call ['_bufchain_add']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh2_try_send  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+Src],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+Size],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+2Ch],', '0']
jbe ['loc_11560']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '20h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jle ['loc_11560']
lea ['ecx,', '[ebp+Size]']
push ['ecx']
lea ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '20h']
push ['eax']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+Size]']
cmp ['edx,', '[ecx+2Ch]']
jbe ['short', 'loc_114D5']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+2Ch]']
mov ['[ebp+Size],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+Size]']
cmp ['eax,', '[edx+30h]']
jbe ['short', 'loc_114E9']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+30h]']
mov ['[ebp+Size],', 'edx']
push ['5Eh']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '20h']
push ['ecx']
call ['_bufchain_consume']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+2Ch]']
sub ['eax,', '[ebp+Size]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+2Ch],', 'eax']
jmp ['loc_11486']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '20h']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jnz ['short', 'loc_1158D']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+18h],', '0']
jz ['short', 'loc_1158D']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_channel_try_eof']
add ['esp,', '4']
mov ['eax,', '[ebp+var_C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_set_window proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
and ['eax,', '6']
jz ['short', 'loc_1161B']
jmp ['loc_1173D']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '1']
jnz ['short', 'loc_11632']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+50h],', '0']
jz ['short', 'loc_11632']
jmp ['loc_1173D']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+50h]']
and ['ecx,', '100h']
jz ['short', 'loc_11650']
cmp ['[ebp+arg_4],', '4000h']
jbe ['short', 'loc_11650']
mov ['[ebp+arg_4],', '4000h']
mov ['eax,', '[ebp+arg_4]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['edx,', '[ebp+arg_0]']
cmp ['eax,', '[edx+34h]']
jl ['loc_1173D']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+38h]']
jnz ['short', 'loc_116DB']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+50h]']
and ['eax,', '400h']
jnz ['short', 'loc_116DB']
push ['4']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
sub ['edx,', '[ecx+34h]']
mov ['eax,', '[ebp+var_C]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
push ['offset', '_ssh2_handle_winadj_response']
push ['offset', '$SG92236']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+48h],', '2']
jz ['short', 'loc_116D9']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+48h],', '1']
jmp ['short', 'loc_116EE']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+3Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+48h],', '0']
push ['5Dh']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
sub ['edx,', '[ecx+34h]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+34h],', 'ecx']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_chanreq_init proc near            
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
and ['ecx,', '0Ah']
jz ['short', 'loc_11785']
push ['1C63h']
push ['offset', '$SG92212']
push ['offset', '$SG92213']
call ['__wassert']
add ['esp,', '0Ch']
push ['62h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
xor ['edx,', 'edx']
cmp ['[ebp+arg_8],', '0']
setnz ['dl']
movzx ['eax,', 'dl']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
cmp ['[ebp+arg_8],', '0']
jz ['short', 'loc_117E8']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_queue_chanreq_handler']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_queue_chanreq_handler proc near   
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['0Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
and ['ecx,', '0Ah']
jz ['short', 'loc_11844']
push ['1C46h']
push ['offset', '$SG92195']
push ['offset', '$SG92196']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_8]']
mov ['[edx+4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+8],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+40h],', '0']
jnz ['short', 'loc_11873']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+40h],', 'ecx']
jmp ['short', 'loc_1187F']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+44h]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+44h],', 'eax']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_handle_winadj_response proc near  
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+3Ch]']
mov ['eax,', '[ebp+var_4]']
add ['edx,', '[eax]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+3Ch],', 'edx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+48h],', '1']
jnz ['short', 'loc_118D9']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+48h],', '2']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_sharing_downstream_connected proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['offset', '$SG92350']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_sharing_downstream_disconnected proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['offset', '$SG92356']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_check_termination']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_check_termination proc near        
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+16Ch],', '2']
jnz ['short', 'loc_119BE']
push ['2Bh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_119BE']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0F8h]']
push ['ecx']
call ['_count234']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_119BE']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0CCh],', '0']
jz ['short', 'loc_119A7']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0CCh]']
push ['ecx']
call ['_share_ndownstreams']
add ['esp,', '4']
test ['eax,', 'eax']
jg ['short', 'loc_119BE']
push ['1']
push ['0']
push ['0']
push ['offset', '$SG92344']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_disconnect']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_sharing_logf proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
lea ['eax,', '[ebp+arg_C]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
call ['_dupvprintf']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', '0']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_11A1D']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
push ['offset', '$SG92371']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '10h']
jmp ['short', 'loc_11A32']
mov ['eax,', '[ebp+var_8]']
push ['eax']
push ['offset', '$SG92373']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_channel_check_close proc near     
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jz ['short', 'loc_11A82']
jmp ['loc_11B24']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
not ['ecx']
and ['ecx,', '5']
jz ['short', 'loc_11A98']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0Ch],', '6']
jnz ['short', 'loc_11AEB']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+40h],', '0']
jnz ['short', 'loc_11AEB']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
and ['edx,', '2']
jnz ['short', 'loc_11AEB']
push ['61h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
or ['eax,', '3']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
not ['eax']
and ['eax,', '0Ah']
jnz ['short', 'loc_11B24']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+40h],', '0']
jz ['short', 'loc_11B18']
push ['1DF7h']
push ['offset', '$SG92409']
push ['offset', '$SG92410']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_channel_destroy']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_channel_destroy proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '3']
ja ['loc_11C03']
mov ['ecx,', '[ebp+var_8]']
jmp ['ds:$LN13_1[ecx*4]']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0FCh],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_update_specials_menu']
add ['esp,', '4']
jmp ['short', 'loc_11C03']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+4Ch],', '0']
jz ['short', 'loc_11BAA']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_x11_close']
add ['esp,', '4']
push ['offset', '$SG92387']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_11C03']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_11C03']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+4Ch],', '0']
jz ['short', 'loc_11BEC']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_pfd_close']
add ['esp,', '4']
push ['offset', '$SG92392']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0F8h]']
push ['ecx']
call ['_del234']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+16Ch],', '2']
jnz ['short', 'loc_11C54']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '20h']
push ['eax']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+40h],', '0']
jz ['short', 'loc_11C54']
push ['1DCDh']
push ['offset', '$SG92396']
push ['offset', '$SG92397']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_check_termination']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_sharing_add_x11_display proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+168h]']
push ['edx']
call ['_x11_invent_fake_auth']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+20h],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_C]']
mov ['[edx+24h],', 'eax']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_sharing_remove_x11_display proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+168h]']
push ['edx']
call ['_del234']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_x11_free_fake_auth']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_sshfwd_x11_sharing_handover proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0Ch],', '5']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+4Ch],', 'edx']
mov ['eax,', '[ebp+arg_24]']
push ['eax']
mov ['ecx,', '[ebp+arg_20]']
push ['ecx']
mov ['edx,', '[ebp+arg_1C]']
push ['edx']
mov ['eax,', '[ebp+arg_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+34h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+30h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+2Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_share_setup_x11_channel']
add ['esp,', '38h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_sshfwd_x11_is_local proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+50h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_ssh_is_simple']
add ['esp,', '4']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '7FFFBFFFh']
add ['eax,', '4000h']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_set_window']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_is_simple  proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['0A3h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_11E0F']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0C4h],', '0']
jnz ['short', 'loc_11E0F']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0CCh],', '0']
jnz ['short', 'loc_11E0F']
mov ['[ebp+var_4],', '1']
jmp ['short', 'loc_11E16']
mov ['[ebp+var_4],', '0']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_ssh2_authconn proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1B8h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_1B8]']
mov ['ecx,', '6Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1A4h],', '0']
jnz ['short', 'loc_11E87']
push ['0E8h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_1A4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_1A4]']
mov ['[ecx+1A4h],', 'edx']
mov ['eax,', '[ebp+var_1A4]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1A4h]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['[ebp+var_1A8],', 'eax']
cmp ['[ebp+var_1A8],', '2567h']
jg ['loc_11FA9']
cmp ['[ebp+var_1A8],', '2567h']
jz ['loc_149CB']
cmp ['[ebp+var_1A8],', '230Ch']
jg ['short', 'loc_11F43']
cmp ['[ebp+var_1A8],', '230Ch']
jz ['loc_12C87']
cmp ['[ebp+var_1A8],', '21F1h']
jg ['short', 'loc_11F1E']
cmp ['[ebp+var_1A8],', '21F1h']
jz ['loc_1225B']
cmp ['[ebp+var_1A8],', '0']
jz ['loc_12051']
cmp ['[ebp+var_1A8],', '21E6h']
jz ['loc_121E3']
jmp ['$LN412_0']
cmp ['[ebp+var_1A8],', '2249h']
jz ['loc_12540']
cmp ['[ebp+var_1A8],', '22CDh']
jz ['loc_12A4C']
jmp ['$LN412_0']
cmp ['[ebp+var_1A8],', '2441h']
jg ['short', 'loc_11F84']
cmp ['[ebp+var_1A8],', '2441h']
jz ['loc_13CB6']
cmp ['[ebp+var_1A8],', '23B3h']
jz ['loc_133F4']
cmp ['[ebp+var_1A8],', '23F8h']
jz ['loc_13948']
jmp ['$LN412_0']
cmp ['[ebp+var_1A8],', '2465h']
jz ['loc_13DF3']
cmp ['[ebp+var_1A8],', '2516h']
jz ['loc_145A7']
jmp ['$LN412_0']
cmp ['[ebp+var_1A8],', '26B6h']
jg ['short', 'loc_11FFB']
cmp ['[ebp+var_1A8],', '26B6h']
jz ['loc_155B3']
mov ['ecx,', '[ebp+var_1A8]']
sub ['ecx,', '25ABh']
mov ['[ebp+var_1A8],', 'ecx']
cmp ['[ebp+var_1A8],', '0CCh']
ja ['$LN412_0']
mov ['edx,', '[ebp+var_1A8]']
movzx ['eax,', 'ds:$LN444[edx]']
jmp ['ds:$LN466[eax*4]']
cmp ['[ebp+var_1A8],', '27E7h']
jg ['short', 'loc_1203C']
cmp ['[ebp+var_1A8],', '27E7h']
jz ['loc_15FCD']
cmp ['[ebp+var_1A8],', '26F9h']
jz ['loc_15800']
cmp ['[ebp+var_1A8],', '2762h']
jz ['loc_15ABC']
jmp ['$LN412_0']
cmp ['[ebp+var_1A8],', '2814h']
jz ['loc_1617D']
jmp ['$LN412_0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+25Ch],', 'offset', '_ssh2_msg_authconn']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+30Ch],', 'offset', '_ssh2_msg_authconn']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+310h],', 'offset', '_ssh2_msg_authconn']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+314h],', 'offset', '_ssh2_msg_authconn']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+318h],', 'offset', '_ssh2_msg_authconn']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+334h],', 'offset', '_ssh2_msg_authconn']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+338h],', 'offset', '_ssh2_msg_authconn']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+384h],', 'offset', '_ssh2_msg_authconn']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+388h],', 'offset', '_ssh2_msg_authconn']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+38Ch],', 'offset', '_ssh2_msg_authconn']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3ACh],', 'offset', '_ssh2_msg_authconn']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3B0h],', 'offset', '_ssh2_msg_authconn']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3B4h],', 'offset', '_ssh2_msg_authconn']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3B8h],', 'offset', '_ssh2_msg_authconn']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3BCh],', 'offset', '_ssh2_msg_authconn']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3C0h],', 'offset', '_ssh2_msg_authconn']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3C4h],', 'offset', '_ssh2_msg_authconn']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3C8h],', 'offset', '_ssh2_msg_authconn']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+8],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+38h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+34h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+6Ch],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+2Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0C4h],', '0']
jnz ['loc_122A8']
push ['21h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_12200']
push ['5']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
push ['offset', '$SG93057']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '21E6h']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_121D5']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_121D5']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '6']
jnz ['short', 'loc_12200']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+8],', '1']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jnz ['loc_122A6']
push ['5']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
push ['offset', '$SG93067']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '21F1h']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_1224D']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1224D']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '6']
jnz ['short', 'loc_1227A']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+34h],', '1']
jmp ['short', 'loc_122A6']
push ['offset', '$SG93077']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_12294']
jmp ['short', 'loc_122B2']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+34h],', '1']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '14Ch']
push ['eax']
call ['_bufchain_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+318h],', 'offset', '_ssh2_msg_userauth_banner']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+50h],', '0']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+34h],', '0']
jnz ['$done_agent_query$93136']
push ['1Eh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_filename']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0BCh],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0BCh]']
push ['eax']
call ['_filename_is_null']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['loc_12485']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0BCh]']
push ['edx']
call ['_filename_to_str']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG93086']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0BCh]']
push ['edx']
call ['_key_type']
add ['esp,', '4']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '3']
jnz ['loc_12411']
lea ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '60h']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '54h']
push ['edx']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '5Ch']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0BCh]']
push ['edx']
call ['_ssh2_userkey_loadpub']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+50h],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+50h],', '0']
jz ['short', 'loc_123B7']
push ['0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0BCh]']
push ['ecx']
call ['_ssh2_userkey_encrypted']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+58h],', 'eax']
jmp ['short', 'loc_1240F']
mov ['eax,', '[ebp+var_14]']
push ['eax']
push ['offset', '$SG93093']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0BCh]']
push ['ecx']
call ['_filename_to_str']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG93094']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_1C],', 'eax']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_12485']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_key_type_to_str']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG93097']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_key_type_to_str']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0BCh]']
push ['eax']
call ['_filename_to_str']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG93098']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
mov ['eax,', '[ebp+var_20]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+50h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+80h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+6Ch],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+78h],', '0']
push ['1Ah']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['$done_agent_query$93136']
call ['_agent_exists']
test ['eax,', 'eax']
jz ['$done_agent_query$93136']
push ['offset', '$SG93104']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['byte', 'ptr', '[eax+64h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['byte', 'ptr', '[ecx+65h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['byte', 'ptr', '[edx+66h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['byte', 'ptr', '[eax+67h],', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['byte', 'ptr', '[ecx+68h],', '0Bh']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
push ['offset', '_ssh_agent_callback']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '74h']
push ['eax']
lea ['ecx,', '[ebp+var_28]']
push ['ecx']
push ['5']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '64h']
push ['edx']
call ['_agent_query']
add ['esp,', '18h']
test ['eax,', 'eax']
jnz ['short', 'loc_1259D']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '2249h']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_12532']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_12576']
push ['offset', '$SG93118']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_12564']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_12532']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_12532']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+228h]']
mov ['[ebp+var_28],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+22Ch]']
mov ['[ecx+74h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_28]']
mov ['[ecx+6Ch],', 'edx']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+6Ch],', '0']
jz ['loc_12934']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+74h],', '5']
jl ['loc_12934']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+6Ch]']
movzx ['ecx,', 'byte', 'ptr', '[eax+4]']
cmp ['ecx,', '0Ch']
jnz ['loc_12934']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+6Ch]']
add ['eax,', '5']
mov ['[ebp+var_34],', 'eax']
mov ['ecx,', '[ebp+var_34]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
shl ['edx,', '18h']
mov ['eax,', '[ebp+var_34]']
movzx ['ecx,', 'byte', 'ptr', '[eax+1]']
shl ['ecx,', '10h']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_34]']
movzx ['ecx,', 'byte', 'ptr', '[eax+2]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_34]']
movzx ['ecx,', 'byte', 'ptr', '[eax+3]']
or ['edx,', 'ecx']
push ['edx']
call ['_toint']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+80h],', 'eax']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+80h],', '0']
jge ['short', 'loc_12659']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+80h]']
push ['edx']
push ['offset', '$SG93135']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+80h],', '0']
jmp ['$done_agent_query$93136']
jmp ['loc_127C4']
mov ['edx,', '[ebp+var_34]']
add ['edx,', '4']
mov ['[ebp+var_38],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+74h]']
sub ['ecx,', '9']
mov ['[ebp+var_3C],', 'ecx']
mov ['[ebp+var_30],', '0']
jmp ['short', 'loc_12680']
mov ['edx,', '[ebp+var_30]']
add ['edx,', '1']
mov ['[ebp+var_30],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_30]']
cmp ['ecx,', '[eax+80h]']
jge ['loc_127C4']
cmp ['[ebp+var_3C],', '4']
jge ['short', 'loc_126BB']
push ['offset', '$SG93146']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+80h],', '0']
jmp ['$done_agent_query$93136']
mov ['ecx,', '[ebp+var_38]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
shl ['edx,', '18h']
mov ['eax,', '[ebp+var_38]']
movzx ['ecx,', 'byte', 'ptr', '[eax+1]']
shl ['ecx,', '10h']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_38]']
movzx ['ecx,', 'byte', 'ptr', '[eax+2]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_38]']
movzx ['ecx,', 'byte', 'ptr', '[eax+3]']
or ['edx,', 'ecx']
push ['edx']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_40],', 'eax']
cmp ['[ebp+var_40],', '0']
jl ['short', 'loc_126FF']
mov ['edx,', '[ebp+var_40]']
cmp ['edx,', '[ebp+var_3C]']
jle ['short', 'loc_12722']
push ['offset', '$SG93157']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+80h],', '0']
jmp ['$done_agent_query$93136']
mov ['edx,', '[ebp+var_40]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_3C]']
sub ['eax,', 'edx']
mov ['[ebp+var_3C],', 'eax']
mov ['ecx,', '[ebp+var_40]']
mov ['edx,', '[ebp+var_38]']
lea ['eax,', '[edx+ecx+4]']
mov ['[ebp+var_38],', 'eax']
mov ['ecx,', '[ebp+var_38]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
shl ['edx,', '18h']
mov ['eax,', '[ebp+var_38]']
movzx ['ecx,', 'byte', 'ptr', '[eax+1]']
shl ['ecx,', '10h']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_38]']
movzx ['ecx,', 'byte', 'ptr', '[eax+2]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_38]']
movzx ['ecx,', 'byte', 'ptr', '[eax+3]']
or ['edx,', 'ecx']
push ['edx']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_44],', 'eax']
cmp ['[ebp+var_44],', '0']
jl ['short', 'loc_12781']
mov ['edx,', '[ebp+var_44]']
cmp ['edx,', '[ebp+var_3C]']
jle ['short', 'loc_127A4']
push ['offset', '$SG93168']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+80h],', '0']
jmp ['$done_agent_query$93136']
mov ['edx,', '[ebp+var_44]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_3C]']
sub ['eax,', 'edx']
mov ['[ebp+var_3C],', 'eax']
mov ['ecx,', '[ebp+var_44]']
mov ['edx,', '[ebp+var_38]']
lea ['eax,', '[edx+ecx+4]']
mov ['[ebp+var_38],', 'eax']
jmp ['loc_12677']
mov ['ecx,', '[ebp+var_34]']
add ['ecx,', '4']
mov ['[ebp+var_34],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+80h]']
push ['eax']
push ['offset', '$SG93169']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+50h],', '0']
jz ['loc_12932']
mov ['[ebp+var_30],', '0']
jmp ['short', 'loc_12807']
mov ['eax,', '[ebp+var_30]']
add ['eax,', '1']
mov ['[ebp+var_30],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_30]']
cmp ['edx,', '[ecx+80h]']
jge ['loc_12905']
mov ['eax,', '[ebp+var_34]']
movzx ['ecx,', 'byte', 'ptr', '[eax]']
shl ['ecx,', '18h']
mov ['edx,', '[ebp+var_34]']
movzx ['eax,', 'byte', 'ptr', '[edx+1]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_34]']
movzx ['eax,', 'byte', 'ptr', '[edx+2]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_34]']
movzx ['eax,', 'byte', 'ptr', '[edx+3]']
or ['ecx,', 'eax']
push ['ecx']
call ['_toint']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+90h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+90h]']
cmp ['ecx,', '[eax+54h]']
jnz ['short', 'loc_128B0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+54h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+50h]']
push ['edx']
mov ['eax,', '[ebp+var_34]']
add ['eax,', '4']
push ['eax']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_128B0']
mov ['ecx,', '[ebp+var_30]']
push ['ecx']
push ['offset', '$SG93183']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_30]']
mov ['[eax+7Ch],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_34]']
mov ['[edx+78h],', 'eax']
jmp ['short', 'loc_12905']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+90h]']
mov ['eax,', '[ebp+var_34]']
lea ['ecx,', '[eax+edx+4]']
mov ['[ebp+var_34],', 'ecx']
mov ['edx,', '[ebp+var_34]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_34]']
movzx ['edx,', 'byte', 'ptr', '[ecx+1]']
shl ['edx,', '10h']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_34]']
movzx ['edx,', 'byte', 'ptr', '[ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_34]']
movzx ['edx,', 'byte', 'ptr', '[ecx+3]']
or ['eax,', 'edx']
push ['eax']
call ['_toint']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_34]']
lea ['edx,', '[ecx+eax+4]']
mov ['[ebp+var_34],', 'edx']
jmp ['loc_127FE']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+78h],', '0']
jnz ['short', 'loc_12932']
push ['offset', '$SG93193']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+80h],', '0']
jmp ['short', '$done_agent_query$93136']
push ['offset', '$SG93195']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+4Ch],', '0']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+34h],', '0']
jnz ['loc_158E4']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+4Ch],', '0']
jz ['short', 'loc_12988']
push ['1Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_12988']
jmp ['loc_12B3A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_get_remote_username']
add ['esp,', '4']
mov ['[ebp+var_1AC],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_1AC]']
mov ['[ecx+224h],', 'edx']
cmp ['[ebp+var_1AC],', '0']
jnz ['loc_12AEE']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_new_prompts']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+3Ch],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
mov ['dword', 'ptr', '[ecx],', '1']
push ['offset', '$SG93204']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+3Ch]']
mov ['[ecx+4],', 'eax']
push ['1']
push ['offset', '$SG93205']
call ['_dupstr']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_add_prompt']
add ['esp,', '0Ch']
push ['0']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
push ['edx']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_48],', 'eax']
cmp ['[ebp+var_48],', '0']
jge ['short', 'loc_12A7F']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D8h],', '1']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '22CDh']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_12A3E']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_12A3E']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_48],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D8h],', '0']
jmp ['short', 'loc_12A2B']
cmp ['[ebp+var_48],', '0']
jnz ['short', 'loc_12ABD']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
push ['1']
push ['0']
push ['0']
push ['offset', '$SG93219']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_12AAB']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+224h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
jmp ['short', 'loc_12B3A']
mov ['ecx,', 'dword', 'ptr', 'ds:_flags']
and ['ecx,', '1']
jnz ['short', 'loc_12B04']
mov ['edx,', 'dword', 'ptr', 'ds:_flags']
and ['edx,', '4']
jz ['short', 'loc_12B3A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+224h]']
push ['ecx']
push ['offset', '$SG93227']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_4C],', 'eax']
mov ['edx,', '[ebp+var_4C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4Ch],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+15Ch],', '0']
push ['32h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+224h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93228']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93229']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0Ch],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+34h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+20h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+30h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+24h],', '0']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+6Ch],', '0']
jz ['short', 'loc_12C39']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+78h],', '0']
jz ['short', 'loc_12C20']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+78h]']
mov ['[eax+70h],', 'edx']
jmp ['short', 'loc_12C39']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+6Ch]']
add ['ecx,', '9']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+70h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+7Ch],', '0']
mov ['ecx,', '1']
test ['ecx,', 'ecx']
jz ['loc_158DF']
mov ['[ebp+var_19E],', '0']
mov ['[ebp+var_19D],', '0']
mov ['[ebp+var_19D],', '1']
mov ['[ebp+Buf2],', '0']
mov ['[ebp+var_19E],', '1']
mov ['[ebp+var_60],', '0']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0Ch],', '0']
jnz ['short', 'loc_12C91']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '230Ch']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_12C79']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_12C79']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '14Ch']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
mov ['[ebp+var_68],', 'eax']
cmp ['[ebp+var_68],', '0']
jz ['short', 'loc_12D01']
mov ['eax,', 'dword', 'ptr', 'ds:_flags']
and ['eax,', '5']
jz ['short', 'loc_12D01']
push ['1']
mov ['ecx,', '[ebp+var_68]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_6C],', 'eax']
mov ['edx,', '[ebp+var_68]']
push ['edx']
mov ['eax,', '[ebp+var_6C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '14Ch']
push ['ecx']
call ['_bufchain_fetch']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_68]']
push ['edx']
mov ['eax,', '[ebp+var_6C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_untrusted']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_6C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '14Ch']
push ['eax']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '34h']
jnz ['short', 'loc_12D4B']
push ['offset', '$SG93253']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+38h],', '1']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+34h],', '1']
jmp ['loc_158DF']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '33h']
jz ['short', 'loc_12D90']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '5']
jz ['short', 'loc_12D90']
mov ['edx,', '[ebp+arg_C]']
mov ['eax,', '[edx+8]']
push ['eax']
push ['offset', '$SG93255']
call ['_dupprintf']
add ['esp,', '8']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_12D7E']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0Ch],', '0']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '33h']
jnz ['loc_1312A']
mov ['[ebp+var_19E],', '1']
lea ['eax,', '[ebp+var_60]']
push ['eax']
mov ['[ebp+var_19D],', '1']
lea ['ecx,', '[ebp+Buf2]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['loc_12F40']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jnz ['short', 'loc_12DEB']
jmp ['loc_12F3E']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+4],', '2']
jz ['short', 'loc_12DFD']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+4],', '3']
jnz ['short', 'loc_12E33']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '2']
jnz ['short', 'loc_12E17']
push ['offset', '$SG93266']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG93267']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_12F3E']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+4],', '1']
jnz ['short', 'loc_12E69']
push ['offset', '$SG93270']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG93271']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_12F3E']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+4],', '7']
jnz ['short', 'loc_12E8E']
push ['offset', '$SG93274']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_12F3E']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+4],', '5']
jnz ['short', 'loc_12E9C']
jmp ['loc_12F3E']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '6']
jnz ['short', 'loc_12ECF']
push ['offset', '$SG93279']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
push ['offset', '$SG93280']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
jmp ['short', 'loc_12F3E']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+4],', '4']
jz ['short', 'loc_12EEF']
push ['236Ch']
push ['offset', '$SG93283']
push ['offset', '$SG93284']
call ['__wassert']
add ['esp,', '0Ch']
push ['offset', '$SG93285']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['offset', '$SG93286']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
push ['1Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_12F3E']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+34h],', '0']
jmp ['loc_158DF']
jmp ['short', 'loc_12F68']
push ['offset', '$SG93289']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG93290']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
cmp ['[ebp+var_19E],', '0']
jnz ['short', 'loc_12F7E']
push ['offset', '$LN433_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
cmp ['[ebp+var_19D],', '0']
jnz ['short', 'loc_12F94']
push ['offset', '$LN435_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_60]']
push ['ecx']
mov ['edx,', '[ebp+Buf2]']
push ['edx']
push ['offset', '$SG93291']
call ['_in_commasep_string']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+14h],', 'eax']
cmp ['[ebp+var_19E],', '0']
jnz ['short', 'loc_12FC5']
push ['offset', '$LN433_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
cmp ['[ebp+var_19D],', '0']
jnz ['short', 'loc_12FDB']
push ['offset', '$LN435_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
mov ['edx,', '[ebp+var_60]']
push ['edx']
mov ['eax,', '[ebp+Buf2]']
push ['eax']
push ['offset', '$SG93292']
call ['_in_commasep_string']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+18h],', 'eax']
push ['24h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1305F']
cmp ['[ebp+var_19E],', '0']
jnz ['short', 'loc_13024']
push ['offset', '$LN433_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
cmp ['[ebp+var_19D],', '0']
jnz ['short', 'loc_1303A']
push ['offset', '$LN435_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_60]']
push ['ecx']
mov ['edx,', '[ebp+Buf2]']
push ['edx']
push ['offset', '$SG93293']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_1305F']
mov ['[ebp+var_1B0],', '1']
jmp ['short', 'loc_13069']
mov ['[ebp+var_1B0],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_1B0]']
mov ['[eax+1Ch],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+67Ch],', '0']
jnz ['short', 'loc_1309C']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_ssh_gss_setup']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+67Ch],', 'eax']
push ['25h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_13114']
cmp ['[ebp+var_19E],', '0']
jnz ['short', 'loc_130CA']
push ['offset', '$LN433_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
cmp ['[ebp+var_19D],', '0']
jnz ['short', 'loc_130E0']
push ['offset', '$LN435_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
mov ['edx,', '[ebp+var_60]']
push ['edx']
mov ['eax,', '[ebp+Buf2]']
push ['eax']
push ['offset', '$SG93295']
call ['_in_commasep_string']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_13114']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+67Ch]']
cmp ['dword', 'ptr', '[edx+4],', '0']
jle ['short', 'loc_13114']
mov ['[ebp+var_1B4],', '1']
jmp ['short', 'loc_1311E']
mov ['[ebp+var_1B4],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_1B4]']
mov ['[eax+28h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+15Ch],', '0']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+14h],', '0']
jz ['loc_13B81']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+24h],', '0']
jnz ['loc_13B81']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+80h],', '0']
jz ['loc_13B81']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+15Ch],', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+7Ch]']
push ['edx']
push ['offset', '$SG93297']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+70h]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+70h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+1]']
shl ['ecx,', '10h']
or ['eax,', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+70h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+70h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+3]']
or ['eax,', 'ecx']
push ['eax']
call ['_toint']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+90h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+70h]']
add ['ecx,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+70h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+70h]']
mov ['[eax+84h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+70h]']
mov ['edx,', '[ebp+var_4]']
add ['ecx,', '[edx+90h]']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+70h],', 'ecx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+84h]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+84h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+1]']
shl ['ecx,', '10h']
or ['eax,', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+84h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+84h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+3]']
or ['eax,', 'ecx']
push ['eax']
call ['_toint']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+94h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+84h]']
add ['ecx,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+88h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+70h]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
shl ['edx,', '18h']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+70h]']
movzx ['eax,', 'byte', 'ptr', '[ecx+1]']
shl ['eax,', '10h']
or ['edx,', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+70h]']
movzx ['ecx,', 'byte', 'ptr', '[eax+2]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+70h]']
movzx ['eax,', 'byte', 'ptr', '[ecx+3]']
or ['edx,', 'eax']
push ['edx']
call ['_toint']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+98h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+70h]']
add ['eax,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+70h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+70h]']
mov ['[edx+8Ch],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+70h]']
mov ['ecx,', '[ebp+var_4]']
add ['eax,', '[ecx+98h]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+70h],', 'eax']
push ['32h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+224h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93324']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93325']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+94h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+88h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+90h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+84h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '3']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '23B3h']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_133E6']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_133E6']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '3Ch']
jz ['short', 'loc_13416']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0Ch],', '1']
jmp ['loc_13B33']
mov ['eax,', 'dword', 'ptr', 'ds:_flags']
and ['eax,', '1']
jz ['short', 'loc_13462']
push ['offset', '$SG93337']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+98h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write']
add ['esp,', '0Ch']
push ['offset', '$SG93338']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
push ['32h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0B8h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+224h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93339']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93340']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+94h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+88h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+90h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+84h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0BCh]']
lea ['ecx,', '[ecx+eax-1]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+9Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
and ['ecx,', '80h']
jz ['short', 'loc_13587']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+9Ch]']
sub ['eax,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+9Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0A4h],', '1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+90h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A4h]']
lea ['ecx,', '[ecx+eax+4]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0A4h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+9Ch]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A4h]']
lea ['ecx,', '[ecx+eax+4]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0A4h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A4h]']
add ['ecx,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0A4h],', 'ecx']
push ['1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A4h]']
add ['ecx,', '4']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0ACh],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A4h]']
sar ['ecx,', '18h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0ACh]']
mov ['[eax],', 'cl']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0A4h]']
sar ['edx,', '10h']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0ACh]']
mov ['[ecx+1],', 'dl']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A4h]']
sar ['eax,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0ACh]']
mov ['[edx+2],', 'al']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0ACh]']
mov ['edx,', '[ebp+var_4]']
mov ['al,', '[edx+0A4h]']
mov ['[ecx+3],', 'al']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0ACh]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+0A8h],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0A8h]']
mov ['byte', 'ptr', '[edx],', '0Dh']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0A8h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+90h]']
sar ['ecx,', '18h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A8h]']
mov ['[eax],', 'cl']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+90h]']
sar ['edx,', '10h']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
mov ['[ecx+1],', 'dl']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+90h]']
sar ['eax,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0A8h]']
mov ['[edx+2],', 'al']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
mov ['edx,', '[ebp+var_4]']
mov ['al,', '[edx+90h]']
mov ['[ecx+3],', 'al']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0A8h]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+0A8h],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+90h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+84h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A8h]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0A8h]']
mov ['eax,', '[ebp+var_4]']
add ['edx,', '[eax+90h]']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0A8h],', 'edx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+9Ch]']
sar ['eax,', '18h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0A8h]']
mov ['[edx],', 'al']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+9Ch]']
sar ['ecx,', '10h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A8h]']
mov ['[eax+1],', 'cl']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+9Ch]']
sar ['edx,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
mov ['[ecx+2],', 'dl']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A8h]']
mov ['ecx,', '[ebp+var_4]']
mov ['dl,', '[ecx+9Ch]']
mov ['[eax+3],', 'dl']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
add ['ecx,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0A8h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
and ['ecx,', '80h']
jnz ['short', 'loc_1383B']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0BCh]']
sar ['eax,', '18h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0A8h]']
mov ['[edx],', 'al']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0BCh]']
sar ['ecx,', '10h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A8h]']
mov ['[eax+1],', 'cl']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0BCh]']
sar ['edx,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
mov ['[ecx+2],', 'dl']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A8h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['dl,', '[ecx+0BCh]']
mov ['[eax+3],', 'dl']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
add ['ecx,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0A8h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0BCh]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '9Ch']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A8h]']
mov ['ecx,', '[ebp+arg_0]']
add ['eax,', '[ecx+0BCh]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0A8h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
mov ['edx,', '[ecx]']
sub ['edx,', '5']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
mov ['edx,', '[ecx+10h]']
add ['edx,', '5']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A8h]']
lea ['ecx,', '[ecx+eax-5]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0A8h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
mov ['byte', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A8h]']
mov ['byte', 'ptr', '[eax+1],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0A8h]']
mov ['byte', 'ptr', '[edx+2],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0A8h]']
mov ['byte', 'ptr', '[ecx+3],', '0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
push ['offset', '_ssh_agent_callback']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '0A0h']
push ['eax']
lea ['ecx,', '[ebp+var_74]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0A4h]']
add ['eax,', '4']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0ACh]']
push ['edx']
call ['_agent_query']
add ['esp,', '18h']
test ['eax,', 'eax']
jnz ['short', 'loc_139A8']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '23F8h']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1393A']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1397E']
push ['offset', '$SG93374']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1396C']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_1393A']
cmp ['[ebp+arg_8],', '0']
jg ['short', 'loc_1393A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+228h]']
mov ['[ebp+var_74],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+22Ch]']
mov ['[ecx+0A0h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_74]']
mov ['[ecx+0B0h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0ACh]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0B0h],', '0']
jz ['loc_13B33']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+0A0h],', '9']
jl ['loc_13B07']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B0h]']
movsx ['eax,', 'byte', 'ptr', '[edx+4]']
cmp ['eax,', '0Eh']
jnz ['loc_13B07']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B0h]']
movzx ['eax,', 'byte', 'ptr', '[edx+5]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B0h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+6]']
shl ['ecx,', '10h']
or ['eax,', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+0B0h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+7]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B0h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+8]']
or ['eax,', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+0A0h]']
sub ['ecx,', '9']
cmp ['eax,', 'ecx']
ja ['loc_13B07']
push ['offset', '$SG93389']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B0h]']
movzx ['eax,', 'byte', 'ptr', '[edx+5]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B0h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+6]']
shl ['ecx,', '10h']
or ['eax,', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+0B0h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+7]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B0h]']
movzx ['ecx,', 'byte', 'ptr', '[edx+8]']
or ['eax,', 'ecx']
push ['eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B0h]']
add ['eax,', '9']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+90h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+84h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_add_sigblob']
add ['esp,', '18h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4],', '1']
jmp ['short', 'loc_13B33']
push ['offset', '$SG93399']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_13B21']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+78h],', '0']
jz ['short', 'loc_13B52']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+24h],', '1']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+20h],', '1']
jmp ['short', 'loc_13B7C']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+7Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+7Ch],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+7Ch]']
cmp ['edx,', '[ecx+80h]']
jl ['short', 'loc_13B7C']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+24h],', '1']
jmp ['loc_158DA']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+14h],', '0']
jz ['loc_142F3']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+50h],', '0']
jz ['loc_142F3']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+20h],', '0']
jnz ['loc_142F3']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+15Ch],', '1']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+20h],', '1']
push ['32h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+224h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93410']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93411']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+5Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+54h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+50h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
push ['offset', '$SG93413']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '2441h']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_13CA8']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_13CA8']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '3Ch']
jz ['short', 'loc_13CE2']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0Ch],', '1']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+4],', '2']
jmp ['loc_12C39']
push ['offset', '$SG93422']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', 'dword', 'ptr', 'ds:_flags']
and ['eax,', '1']
jz ['short', 'loc_13D38']
push ['offset', '$SG93424']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+60h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG93425']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
mov ['[ebp+var_7C],', '0']
cmp ['[ebp+var_7C],', '0']
jnz ['loc_13F7F']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+58h],', '0']
jz ['loc_13E95']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_new_prompts']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+3Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
mov ['dword', 'ptr', '[eax],', '0']
push ['offset', '$SG93433']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['[edx+4],', 'eax']
push ['0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+60h]']
push ['ecx']
push ['offset', '$SG93434']
call ['_dupprintf']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_add_prompt']
add ['esp,', '0Ch']
push ['0']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
push ['edx']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_90],', 'eax']
cmp ['[ebp+var_90],', '0']
jge ['short', 'loc_13E29']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D8h],', '1']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '2465h']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_13DE5']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_13DE5']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_90],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D8h],', '0']
jmp ['short', 'loc_13DCF']
cmp ['[ebp+var_90],', '0']
jnz ['short', 'loc_13E6A']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
push ['1']
push ['0Dh']
push ['offset', '$SG93448']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_13E58']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+Str],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
push ['ecx']
call ['_free_prompts']
add ['esp,', '4']
jmp ['short', 'loc_13E9C']
mov ['[ebp+Str],', '0']
push ['1Eh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_filename']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0BCh],', 'eax']
lea ['edx,', '[ebp+var_88]']
push ['edx']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0BCh]']
push ['edx']
call ['_ssh2_load_userkey']
add ['esp,', '0Ch']
mov ['[ebp+var_7C],', 'eax']
cmp ['[ebp+Str],', '0']
jz ['short', 'loc_13F04']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_smemclr']
add ['esp,', '8']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+var_7C],', 'offset', '_ssh2_wrong_passphrase']
jz ['short', 'loc_13F13']
cmp ['[ebp+var_7C],', '0']
jnz ['short', 'loc_13F7A']
cmp ['[ebp+Str],', '0']
jz ['short', 'loc_13F3C']
cmp ['[ebp+var_7C],', 'offset', '_ssh2_wrong_passphrase']
jnz ['short', 'loc_13F3C']
push ['offset', '$SG93459']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
mov ['[ebp+var_7C],', '0']
jmp ['short', 'loc_13F7A']
push ['offset', '$SG93462']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
mov ['edx,', '[ebp+var_88]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG93463']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
mov ['[ebp+var_7C],', '0']
jmp ['short', 'loc_13F7F']
jmp ['loc_13D3F']
cmp ['[ebp+var_7C],', '0']
jz ['loc_142EE']
push ['32h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0B8h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+224h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93473']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93474']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_7C]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+30h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+var_7C]']
mov ['edx,', '[ecx+4]']
push ['edx']
mov ['eax,', '[ebp+var_7C]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+0Ch]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+Src],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
mov ['edx,', '[ecx]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0BCh]']
lea ['edx,', '[edx+ecx-1]']
mov ['[ebp+var_B8],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
and ['ecx,', '80h']
jz ['short', 'loc_140AC']
mov ['edx,', '[ebp+var_B8]']
sub ['edx,', '4']
mov ['[ebp+var_B8],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_B8]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_9C],', 'eax']
mov ['[ebp+var_BC],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+50h]']
and ['edx,', '80h']
jnz ['short', 'loc_14152']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0BCh]']
sar ['ecx,', '18h']
mov ['edx,', '[ebp+var_9C]']
add ['edx,', '[ebp+var_BC]']
mov ['[edx],', 'cl']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0BCh]']
sar ['ecx,', '10h']
mov ['edx,', '[ebp+var_9C]']
add ['edx,', '[ebp+var_BC]']
mov ['[edx+1],', 'cl']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0BCh]']
sar ['ecx,', '8']
mov ['edx,', '[ebp+var_9C]']
add ['edx,', '[ebp+var_BC]']
mov ['[edx+2],', 'cl']
mov ['eax,', '[ebp+var_9C]']
add ['eax,', '[ebp+var_BC]']
mov ['ecx,', '[ebp+arg_0]']
mov ['dl,', '[ecx+0BCh]']
mov ['[eax+3],', 'dl']
mov ['eax,', '[ebp+var_BC]']
add ['eax,', '4']
mov ['[ebp+var_BC],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0BCh]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '9Ch']
push ['eax']
mov ['ecx,', '[ebp+var_9C]']
add ['ecx,', '[ebp+var_BC]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_BC]']
add ['eax,', '[edx+0BCh]']
mov ['[ebp+var_BC],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
mov ['eax,', '[edx]']
sub ['eax,', '5']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
mov ['eax,', '[edx+10h]']
add ['eax,', '5']
push ['eax']
mov ['ecx,', '[ebp+var_9C]']
add ['ecx,', '[ebp+var_BC]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ebp+var_BC]']
lea ['eax,', '[edx+ecx-5]']
mov ['[ebp+var_BC],', 'eax']
mov ['ecx,', '[ebp+var_BC]']
cmp ['ecx,', '[ebp+var_B8]']
jz ['short', 'loc_14203']
push ['24C5h']
push ['offset', '$SG93485']
push ['offset', '$SG93486']
call ['__wassert']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_B0]']
push ['eax']
mov ['ecx,', '[ebp+var_B8]']
push ['ecx']
mov ['edx,', '[ebp+var_9C]']
push ['edx']
mov ['eax,', '[ebp+var_7C]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_7C]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+2Ch]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_98],', 'eax']
mov ['edx,', '[ebp+var_B0]']
push ['edx']
mov ['eax,', '[ebp+var_98]']
push ['eax']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_add_sigblob']
add ['esp,', '18h']
mov ['eax,', '[ebp+Src]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_98]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_9C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
push ['offset', '$SG93488']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4],', '1']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_7C]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_7C]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_158DA']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+28h],', '0']
jz ['loc_14CF1']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+2Ch],', '0']
jnz ['loc_14CF1']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '5']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+2Ch],', '1']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0Ch],', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+15Ch],', '3']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0C0h],', '0']
mov ['[ebp+var_EC],', '0']
jmp ['short', 'loc_14360']
mov ['eax,', '[ebp+var_EC]']
add ['eax,', '1']
mov ['[ebp+var_EC],', 'eax']
mov ['ecx,', '[ebp+var_EC]']
cmp ['ecx,', 'dword', 'ptr', 'ds:_ngsslibs']
jge ['$got_gsslib$93506']
mov ['edx,', '[ebp+var_EC]']
push ['edx']
push ['27h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['[ebp+var_F4],', 'eax']
mov ['[ebp+var_F0],', '0']
jmp ['short', 'loc_143AE']
mov ['edx,', '[ebp+var_F0]']
add ['edx,', '1']
mov ['[ebp+var_F0],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+67Ch]']
mov ['edx,', '[ebp+var_F0]']
cmp ['edx,', '[ecx+4]']
jge ['short', 'loc_14402']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+67Ch]']
mov ['edx,', '[ebp+var_F0]']
imul ['edx,', '54h']
mov ['eax,', '[ecx]']
mov ['ecx,', '[edx+eax]']
cmp ['ecx,', '[ebp+var_F4]']
jnz ['short', 'loc_14400']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+67Ch]']
mov ['ecx,', '[ebp+var_F0]']
imul ['ecx,', '54h']
add ['ecx,', '[eax]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0C0h],', 'ecx']
jmp ['short', '$got_gsslib$93506']
jmp ['short', 'loc_1439F']
jmp ['loc_14351']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+0C0h],', '0']
jnz ['short', 'loc_1442A']
push ['24F9h']
push ['offset', '$SG93508']
push ['offset', '$SG93509']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C0h]']
cmp ['dword', 'ptr', '[eax+4],', '0']
jz ['short', 'loc_14458']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0C0h]']
mov ['eax,', '[edx+4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['32h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+224h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93511']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93512']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93513']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '0C8h']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0C0h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C8h]']
add ['eax,', '2']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['6']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
movzx ['eax,', 'byte', 'ptr', '[edx+0C8h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C8h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0CCh]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '2516h']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_14599']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_14599']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '3Ch']
jz ['short', 'loc_145D6']
push ['offset', '$SG93523']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_12C39']
lea ['edx,', '[ebp+var_C8]']
push ['edx']
lea ['eax,', '[ebp+var_D4]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_D4]']
mov ['[edx+0D4h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_C8]']
mov ['[ecx+0D0h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C8h]']
add ['ecx,', '2']
mov ['edx,', '[ebp+var_4]']
cmp ['[edx+0D0h],', 'ecx']
jnz ['short', 'loc_1467B']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0D4h]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '6']
jnz ['short', 'loc_1467B']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0D4h]']
movsx ['edx,', 'byte', 'ptr', '[ecx+1]']
mov ['eax,', '[ebp+var_4]']
cmp ['edx,', '[eax+0C8h]']
jnz ['short', 'loc_1467B']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0C8h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0CCh]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0D4h]']
add ['eax,', '2']
push ['eax']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_14697']
push ['offset', '$SG93529']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_12C39']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '0E0h']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+678h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C0h]']
mov ['ecx,', '[eax+0Ch]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0E4h],', 'eax']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+0E4h],', '0']
jz ['short', 'loc_14724']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0E4h],', '3']
jnz ['short', 'loc_14708']
push ['offset', '$SG93532']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_1471F']
push ['offset', '$SG93534']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_12C39']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '0C4h']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0C0h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
mov ['edx,', '[ecx+1Ch]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0E4h],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0E4h],', '0']
jz ['short', 'loc_147B0']
push ['offset', '$SG93536']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '0E0h']
mov ['esi,', 'esp']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C0h]']
mov ['ecx,', '[eax+10h]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_12C39']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0D0h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0D4h],', '0']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_147B0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0D8h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0DCh],', '0']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_147CE']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '0D8h']
mov ['esi,', 'esp']
push ['edx']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '0D0h']
push ['eax']
push ['26h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E0h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '0C4h']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C0h]']
mov ['ecx,', '[eax+14h]']
call ['ecx']
add ['esp,', '18h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0E4h],', 'eax']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+0E4h],', '0']
jz ['loc_148FB']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0E4h],', '1']
jz ['loc_148FB']
push ['offset', '$SG93549']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0C8h']
mov ['esi,', 'esp']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C4h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0C0h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
mov ['edx,', '[ecx+2Ch]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_148F6']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0CCh]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0CCh]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_14A4C']
push ['offset', '$SG93551']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0D8h],', '0']
jz ['loc_149B1']
push ['3Dh']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0D8h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0DCh]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0D8h']
mov ['esi,', 'esp']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C0h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0C0h]']
mov ['eax,', '[edx+18h]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0E4h],', '1']
jnz ['short', 'loc_14A3C']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '2567h']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_149BD']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_149BD']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '3Dh']
jz ['short', 'loc_14A04']
push ['offset', '$SG93562']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0E4h],', '4']
jmp ['short', 'loc_14A4C']
lea ['edx,', '[ebp+var_C8]']
push ['edx']
lea ['eax,', '[ebp+var_D4]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_D4]']
mov ['[edx+0D4h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_C8]']
mov ['[ecx+0D0h],', 'edx']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+0E4h],', '1']
jz ['loc_147EC']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0E4h],', '0']
jz ['short', 'loc_14AB9']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '0E0h']
mov ['esi,', 'esp']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C0h]']
mov ['ecx,', '[eax+10h]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '0C4h']
mov ['esi,', 'esp']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C0h]']
mov ['ecx,', '[eax+20h]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_12C39']
push ['offset', '$SG93564']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
push ['0']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_C0],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0BCh]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '9Ch']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
push ['32h']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+224h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93566']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93567']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
mov ['eax,', '[edx+10h]']
add ['eax,', '[ebp+var_C0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0CCh],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
mov ['ecx,', '[eax]']
sub ['ecx,', '[ebp+var_C0]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0C8h],', 'ecx']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_E4]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0C8h']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C4h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0C0h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
mov ['edx,', '[ecx+24h]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['42h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_E4]']
push ['ecx']
mov ['edx,', '[ebp+var_E0]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_E4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0C0h]']
mov ['ecx,', '[eax+28h]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0Ch],', '0']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '0E0h']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0C0h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
mov ['edx,', '[ecx+10h]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '0C4h']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0C0h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0C0h]']
mov ['edx,', '[ecx+20h]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_12C39']
jmp ['loc_158DA']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+1Ch],', '0']
jz ['loc_151C5']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+30h],', '0']
jnz ['loc_151C5']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4],', '6']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+15Ch],', '4']
push ['32h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+224h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93571']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93572']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93573']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93574']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
push ['offset', '$SG93575']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '25ABh']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_14DDA']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_14DDA']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '3Ch']
jz ['short', 'loc_14E1E']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0Ch],', '1']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4],', '7']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+30h],', '1']
jmp ['loc_12C39']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '3Ch']
jnz ['loc_151B6']
lea ['edx,', '[ebp+var_120]']
push ['edx']
lea ['eax,', '[ebp+var_FC]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
lea ['edx,', '[ebp+var_12C]']
push ['edx']
lea ['eax,', '[ebp+var_108]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
lea ['edx,', '[ebp+var_138]']
push ['edx']
lea ['eax,', '[ebp+var_114]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_new_prompts']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+3Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
mov ['dword', 'ptr', '[eax],', '1']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+40h],', 'eax']
mov ['[ebp+var_140],', '0']
jmp ['short', 'loc_14ECA']
mov ['eax,', '[ebp+var_140]']
add ['eax,', '1']
mov ['[ebp+var_140],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_140]']
cmp ['edx,', '[ecx+40h]']
jge ['loc_14F5C']
lea ['eax,', '[ebp+var_154]']
push ['eax']
lea ['ecx,', '[ebp+var_148]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
mov ['[ebp+var_15C],', 'eax']
cmp ['[ebp+var_154],', '0']
jnz ['short', 'loc_14F25']
mov ['[ebp+var_148],', 'offset', '?noprompt@?II@??do_ssh2_authconn@@9@9']
mov ['[ebp+var_154],', '20h']
mov ['ecx,', '[ebp+var_15C]']
push ['ecx']
mov ['edx,', '[ebp+var_148]']
push ['edx']
mov ['eax,', '[ebp+var_154]']
push ['eax']
push ['offset', '$SG93603']
call ['_dupprintf']
add ['esp,', '0Ch']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
push ['edx']
call ['_add_prompt']
add ['esp,', '0Ch']
jmp ['loc_14EBB']
cmp ['[ebp+var_120],', '0']
jz ['short', 'loc_14F98']
mov ['eax,', '[ebp+var_FC]']
push ['eax']
mov ['ecx,', '[ebp+var_120]']
push ['ecx']
push ['offset', '$SG93605']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+3Ch]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
mov ['dword', 'ptr', '[eax+8],', '1']
jmp ['short', 'loc_14FBB']
push ['offset', '$SG93607']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
mov ['dword', 'ptr', '[ecx+8],', '0']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+40h],', '0']
jnz ['short', 'loc_14FD6']
cmp ['[ebp+var_120],', '0']
jnz ['short', 'loc_14FD6']
cmp ['[ebp+var_12C],', '0']
jz ['short', 'loc_1502F']
cmp ['[ebp+var_12C],', '0']
jz ['short', 'loc_14FEB']
mov ['[ebp+var_1B8],', 'offset', '$SG93610']
jmp ['short', 'loc_14FF5']
mov ['[ebp+var_1B8],', 'offset', '$SG93611']
mov ['eax,', '[ebp+var_108]']
push ['eax']
mov ['ecx,', '[ebp+var_12C]']
push ['ecx']
mov ['edx,', '[ebp+var_1B8]']
push ['edx']
push ['offset', '$SG93612']
call ['_dupprintf']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['[edx+0Ch],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
mov ['dword', 'ptr', '[ecx+10h],', '1']
jmp ['short', 'loc_1503C']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
mov ['dword', 'ptr', '[eax+10h],', '0']
push ['0']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
push ['edx']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_160],', 'eax']
cmp ['[ebp+var_160],', '0']
jge ['short', 'loc_150AF']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D8h],', '1']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '2604h']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_1506B']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_1506B']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_160],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D8h],', '0']
jmp ['short', 'loc_15055']
cmp ['[ebp+var_160],', '0']
jnz ['short', 'loc_150F0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
push ['1']
push ['0Dh']
push ['offset', '$SG93628']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_150DE']
push ['3Dh']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+40h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['[ebp+var_140],', '0']
jmp ['short', 'loc_15137']
mov ['eax,', '[ebp+var_140]']
add ['eax,', '1']
mov ['[ebp+var_140],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_140]']
cmp ['edx,', '[ecx+40h]']
jge ['short', 'loc_1516F']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_140]']
mov ['ecx,', '[edx+eax*4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
jmp ['short', 'loc_15128']
push ['100h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send_with_padding']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '262Ah']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_15199']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_15199']
jmp ['loc_14E1E']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0Ch],', '1']
jmp ['loc_158DA']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+18h],', '0']
jz ['loc_15856']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+15Ch],', '2']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_new_prompts']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+3Ch],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
mov ['dword', 'ptr', '[ecx],', '1']
push ['offset', '$SG93646']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+3Ch]']
mov ['[ecx+4],', 'eax']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0D0h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+224h]']
push ['edx']
push ['offset', '$SG93647']
call ['_dupprintf']
add ['esp,', '0Ch']
push ['eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
push ['ecx']
call ['_add_prompt']
add ['esp,', '0Ch']
push ['0']
push ['0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_164],', 'eax']
cmp ['[ebp+var_164],', '0']
jge ['short', 'loc_152BF']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D8h],', '1']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '2648h']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_1527B']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_1527B']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
push ['ecx']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_164],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0D8h],', '0']
jmp ['short', 'loc_15265']
cmp ['[ebp+var_164],', '0']
jnz ['short', 'loc_15300']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
push ['ecx']
call ['_free_prompts']
add ['esp,', '4']
push ['1']
push ['0Dh']
push ['offset', '$SG93661']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_152EE']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+48h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
push ['32h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+224h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93665']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93666']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+48h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['100h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send_with_padding']
add ['esp,', '0Ch']
push ['offset', '$SG93667']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+4],', '4']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '2677h']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_153F2']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_153F2']
mov ['[ebp+var_168],', '1']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '3Ch']
jnz ['loc_15819']
mov ['[ebp+var_16C],', '0']
cmp ['[ebp+var_168],', '0']
jz ['short', 'loc_15440']
mov ['[ebp+var_188],', 'offset', '$SG93683']
jmp ['short', 'loc_1544A']
mov ['[ebp+var_188],', 'offset', '$SG93685']
mov ['ecx,', '[ebp+var_188]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_188]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG93686']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
lea ['ecx,', '[ebp+var_180]']
push ['ecx']
lea ['edx,', '[ebp+var_174]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_new_prompts']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+3Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
mov ['dword', 'ptr', '[eax],', '1']
push ['offset', '$SG93687']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+var_174]']
push ['eax']
mov ['ecx,', '[ebp+var_180]']
push ['ecx']
push ['offset', '$SG93688']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+3Ch]']
mov ['[ecx+0Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
mov ['dword', 'ptr', '[eax+10h],', '1']
push ['0']
push ['offset', '$SG93689']
call ['_dupstr']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
push ['edx']
call ['_add_prompt']
add ['esp,', '0Ch']
push ['0']
push ['offset', '$SG93690']
call ['_dupstr']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+3Ch]']
push ['ecx']
call ['_add_prompt']
add ['esp,', '0Ch']
push ['0']
push ['offset', '$SG93691']
call ['_dupstr']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_add_prompt']
add ['esp,', '0Ch']
cmp ['[ebp+var_16C],', '0']
jnz ['loc_15705']
push ['0']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
push ['edx']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_164],', 'eax']
cmp ['[ebp+var_164],', '0']
jge ['short', 'loc_155E9']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D8h],', '1']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '26B6h']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_155A5']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_155A5']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_get_userpass_input']
add ['esp,', '0Ch']
mov ['[ebp+var_164],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D8h],', '0']
jmp ['short', 'loc_1558F']
cmp ['[ebp+var_164],', '0']
jnz ['short', 'loc_15658']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+48h]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+48h]']
push ['ecx']
call ['_smemclr']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+48h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['1']
push ['0Dh']
push ['offset', '$SG93708']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_15646']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['short', 'loc_156B8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+48h]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+48h]']
push ['ecx']
call ['_smemclr']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+48h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+48h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax+4]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
neg ['eax']
sbb ['eax,', 'eax']
add ['eax,', '1']
mov ['[ebp+var_16C],', 'eax']
jnz ['short', 'loc_15700']
push ['offset', '$SG93714']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
jmp ['loc_15569']
push ['32h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+224h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93715']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG93716']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['1']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+48h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+3Ch]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax+4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['_free_prompts']
add ['esp,', '4']
push ['100h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send_with_padding']
add ['esp,', '0Ch']
push ['offset', '$SG93717']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '26F9h']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_157F2']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_157F2']
mov ['[ebp+var_168],', '0']
jmp ['loc_15414']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0Ch],', '1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+48h]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+48h]']
push ['eax']
call ['_smemclr']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+48h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_158DA']
cmp ['[ebp+var_19D],', '0']
jnz ['short', 'loc_1586C']
push ['offset', '$LN435_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
cmp ['[ebp+var_19E],', '0']
jnz ['short', 'loc_15882']
push ['offset', '$LN433_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
mov ['eax,', '[ebp+Buf2]']
push ['eax']
mov ['ecx,', '[ebp+var_60]']
push ['ecx']
push ['offset', '$SG93727']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_18C],', 'eax']
push ['0']
push ['0Eh']
push ['offset', '$SG93728']
mov ['edx,', '[ebp+var_18C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_18C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_158C8']
jmp ['loc_12C39']
jmp ['loc_12955']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+318h],', '0']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+50h],', '0']
jz ['short', 'loc_15918']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+60h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+6Ch],', '0']
jz ['short', 'loc_15930']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+38h],', '0']
jz ['short', 'loc_1595A']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0C4h],', '0']
jnz ['short', 'loc_1595A']
push ['0']
push ['0FFFFFFFEh']
push ['offset', '$SG93737']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_do_ssh2_transport']
add ['esp,', '10h']
push ['offset', '_ssh_channelcmp']
call ['_newtree234']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0F8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3B8h],', 'offset', '_ssh2_msg_channel_window_adjust']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+384h],', 'offset', '_ssh2_msg_global_request']
push ['2Bh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_159B4']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0FCh],', '0']
jmp ['loc_15BEE']
push ['60h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0FCh],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0FCh]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh2_channel_init']
add ['esp,', '4']
push ['2Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
movsx ['eax,', 'byte', 'ptr', '[eax]']
test ['eax,', 'eax']
jz ['short', 'loc_15A54']
push ['offset', '$SG93744']
push ['2Dh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
push ['2Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh_send_port_open']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+100h],', '1']
jmp ['short', 'loc_15AAE']
push ['offset', '$SG93746']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh2_chanopen_init']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
push ['offset', '$SG93747']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+100h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '2762h']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_15AAE']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_15AAE']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '5Bh']
jz ['short', 'loc_15AFB']
push ['offset', '$SG93756']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_15AE9']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0FCh]']
cmp ['eax,', '[edx+8]']
jz ['short', 'loc_15B41']
push ['offset', '$SG93761']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_15B2F']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0FCh]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0FCh]']
mov ['dword', 'ptr', '[ecx+10h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0FCh]']
mov ['dword', 'ptr', '[eax+0Ch],', '0']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['ecx,', '[edx+0FCh]']
mov ['[ecx+2Ch],', 'eax']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0FCh]']
mov ['[edx+30h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0F8h]']
push ['eax']
call ['_add234']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_update_specials_menu']
add ['esp,', '4']
push ['offset', '$SG93765']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3C0h],', 'offset', '_ssh2_msg_channel_data']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+3C0h]']
mov ['[eax+3BCh],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3C4h],', 'offset', '_ssh2_msg_channel_eof']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3C8h],', 'offset', '_ssh2_msg_channel_close']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3B0h],', 'offset', '_ssh2_msg_channel_open_confirmation']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3B4h],', 'offset', '_ssh2_msg_channel_open_failure']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3CCh],', 'offset', '_ssh2_msg_channel_request']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3ACh],', 'offset', '_ssh2_msg_channel_open']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3D0h],', 'offset', '_ssh2_msg_channel_response']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3D4h],', 'offset', '_ssh2_msg_channel_response']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0CCh],', '0']
jz ['short', 'loc_15C9A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0CCh]']
push ['eax']
call ['_share_activate']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0FCh],', '0']
jz ['short', 'loc_15CF0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_is_simple']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_15CF0']
push ['0']
push ['0']
push ['offset', '$SG93770']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0B8h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_setup_portfwd']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0FCh],', '0']
jz ['loc_160BE']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+100h],', '0']
jnz ['loc_160BE']
push ['90h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_15DFB']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
push ['91h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
call ['_x11_setup_display']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+160h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+160h],', '0']
jnz ['short', 'loc_15D9D']
push ['offset', '$SG93774']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_15DFB']
push ['92h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+168h]']
push ['eax']
call ['_x11_invent_fake_auth']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+164h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+164h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+160h]']
mov ['[eax+1Ch],', 'edx']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
call ['_ssh2_setup_x11']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_agent_forwarding_permitted']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_15E21']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
call ['_ssh2_setup_agent']
add ['esp,', '0Ch']
push ['15h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_15E4F']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0FCh]']
push ['edx']
call ['_ssh2_setup_pty']
add ['esp,', '0Ch']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
call ['_ssh2_setup_env']
add ['esp,', '0Ch']
mov ['edx,', '1']
test ['edx,', 'edx']
jz ['loc_160BC']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+148h],', '0']
jz ['short', 'loc_15EB4']
push ['2Ah']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_190],', 'eax']
push ['14h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_194],', 'eax']
jmp ['short', 'loc_15EE8']
push ['29h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_190],', 'eax']
push ['13h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_194],', 'eax']
cmp ['[ebp+var_190],', '0']
jz ['short', 'loc_15F33']
push ['0']
push ['offset', '_ssh2_response_authconn']
push ['offset', '$SG93795']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0B8h],', 'eax']
mov ['eax,', '[ebp+var_194]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0B8h]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
jmp ['short', 'loc_15FA9']
mov ['eax,', '[ebp+var_194]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_15F82']
push ['0']
push ['offset', '_ssh2_response_authconn']
push ['offset', '$SG93799']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+var_194]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0B8h]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
jmp ['short', 'loc_15FA9']
push ['0']
push ['offset', '_ssh2_response_authconn']
push ['offset', '$SG93802']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0B8h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '27E7h']
jmp ['loc_1626E']
xor ['eax,', 'eax']
jnz ['short', 'loc_15FBF']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_15FBF']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '63h']
jz ['loc_1609E']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '64h']
jz ['short', 'loc_16020']
mov ['eax,', '[ebp+arg_C]']
mov ['ecx,', '[eax+8]']
push ['ecx']
push ['offset', '$SG93812']
call ['_dupprintf']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_1626E']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1600E']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+148h],', '0']
jnz ['short', 'loc_16070']
push ['14h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
movsx ['edx,', 'byte', 'ptr', '[eax]']
test ['edx,', 'edx']
jz ['short', 'loc_16070']
push ['offset', '$SG93817']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+148h],', '1']
jmp ['loc_15E65']
push ['offset', '$SG93818']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_1608A']
jmp ['short', 'loc_160B5']
push ['offset', '$SG93823']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_160BC']
jmp ['loc_15E65']
jmp ['short', 'loc_160D8']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0DCh],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E0h],', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+118h],', '3']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+11Ch],', '0']
jz ['short', 'loc_16111']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0F4h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0F0h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_size']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+120h],', '0']
jz ['short', 'loc_1612B']
push ['0Ch']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_special']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+14h],', '0']
jz ['short', 'loc_16149']
push ['0']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
push ['eax']
call ['_ldisc_send']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0FCh],', '0']
jz ['short', 'loc_16162']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0D8h],', '1']
mov ['eax,', '1']
test ['eax,', 'eax']
jz ['$LN412_0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '2814h']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_1616F']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0B4h],', '0']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_161C9']
mov ['ecx,', '[ebp+arg_C]']
mov ['edx,', '[ecx+8]']
push ['edx']
push ['offset', '$SG93838']
call ['_dupprintf']
add ['esp,', '8']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['loc_1626E']
xor ['edx,', 'edx']
jnz ['short', 'loc_161B5']
jmp ['short', 'loc_161FC']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0FCh],', '0']
jz ['short', 'loc_161FC']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
call ['_ssh2_add_channel_data']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0B4h],', '1']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+0B4h],', '0']
jz ['short', 'loc_16260']
mov ['[ebp+var_198],', '0']
jmp ['short', 'loc_16223']
mov ['ecx,', '[ebp+var_198]']
add ['ecx,', '1']
mov ['[ebp+var_198],', 'ecx']
mov ['edx,', '[ebp+var_198]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0F8h]']
push ['ecx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_19C],', 'eax']
cmp ['[ebp+var_19C],', '0']
jz ['short', 'loc_16260']
mov ['edx,', '[ebp+var_19C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_try_send_and_unthrottle']
add ['esp,', '8']
jmp ['short', 'loc_16214']
jmp ['loc_16162']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN465']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '1B8h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_channelcmp proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+8]']
cmp ['ecx,', '[eax+8]']
jnb ['short', 'loc_1654B']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_16562']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+8]']
cmp ['ecx,', '[eax+8]']
jbe ['short', 'loc_16560']
mov ['eax,', '1']
jmp ['short', 'loc_16562']
xor ['eax,', 'eax']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_c_write_untrusted proc near            
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_flags']
and ['eax,', '2']
jz ['short', 'loc_16589']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['0']
call ['_c_write_stderr']
add ['esp,', '0Ch']
jmp ['short', 'loc_165A3']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_from_backend_untrusted']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh2_pkt_send_with_padding proc near   
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+Src],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_defer']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+60h],', '0']
jz ['loc_166D2']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
and ['ecx,', '200h']
jnz ['loc_166D2']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '100h']
sub ['eax,', '[edx+140h]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+60h]']
mov ['eax,', '[edx+1Ch]']
mov ['ecx,', '[ebp+var_4]']
lea ['edx,', '[ecx+eax-1]']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+60h]']
mov ['eax,', '[ebp+var_4]']
cdq
idiv ['dword', 'ptr', '[ecx+1Ch]']
mov ['eax,', '[ebp+var_4]']
sub ['eax,', 'edx']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+80h],', '0']
jz ['short', 'loc_16673']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+88h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+80h]']
mov ['eax,', '[edx+20h]']
call ['eax']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_4]']
sub ['ecx,', 'eax']
mov ['[ebp+var_4],', 'ecx']
push ['2']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+arg_4],', 'eax']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_1669E']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[ebp+var_4]']
jge ['short', 'loc_166C2']
call ['_random_byte']
mov ['byte', 'ptr', '[ebp+Src+3],', 'al']
push ['1']
lea ['edx,', '[ebp+Src+3]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
jmp ['short', 'loc_16695']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_defer']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_pkt_defersend']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN10_3']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_pkt_defer proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+138h],', '0']
jz ['short', 'loc_16739']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_queue']
add ['esp,', '8']
jmp ['short', 'loc_1674B']
push ['0']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_defer_noqueue']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh2_add_sigblob proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+Size],', 'eax']
mov ['[ebp+Src],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_10]']
mov ['[ebp+Src],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
and ['eax,', '10h']
jz ['$give_up$89261']
cmp ['[ebp+arg_C],', '0Fh']
jle ['$give_up$89261']
mov ['ecx,', '[ebp+var_4]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
shl ['edx,', '18h']
mov ['eax,', '[ebp+var_4]']
movzx ['ecx,', 'byte', 'ptr', '[eax+1]']
shl ['ecx,', '10h']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_4]']
movzx ['ecx,', 'byte', 'ptr', '[eax+2]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_4]']
movzx ['ecx,', 'byte', 'ptr', '[eax+3]']
or ['edx,', 'ecx']
cmp ['edx,', '7']
jnz ['$give_up$89261']
push ['7']
push ['offset', '$SG89247']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '4']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['$give_up$89261']
mov ['[ebp+Size],', '0Bh']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '[ebp+Size]']
movzx ['ecx,', 'byte', 'ptr', '[eax]']
shl ['ecx,', '18h']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '[ebp+Size]']
movzx ['eax,', 'byte', 'ptr', '[edx+1]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '[ebp+Size]']
movzx ['eax,', 'byte', 'ptr', '[edx+2]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '[ebp+Size]']
movzx ['eax,', 'byte', 'ptr', '[edx+3]']
or ['ecx,', 'eax']
push ['ecx']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jl ['short', 'loc_16851']
mov ['ecx,', '[ebp+arg_C]']
sub ['ecx,', '[ebp+Size]']
sub ['ecx,', '4']
cmp ['[ebp+var_10],', 'ecx']
jle ['short', 'loc_16856']
jmp ['$give_up$89261']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[ebp+Size]']
lea ['ecx,', '[eax+edx+4]']
mov ['[ebp+Size],', 'ecx']
mov ['edx,', '[ebp+arg_C]']
sub ['edx,', '[ebp+Size]']
cmp ['edx,', '4']
jge ['short', 'loc_16873']
jmp ['$give_up$89261']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '[ebp+Size]']
movzx ['ecx,', 'byte', 'ptr', '[eax]']
shl ['ecx,', '18h']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '[ebp+Size]']
movzx ['eax,', 'byte', 'ptr', '[edx+1]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '[ebp+Size]']
movzx ['eax,', 'byte', 'ptr', '[edx+2]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '[ebp+Size]']
movzx ['eax,', 'byte', 'ptr', '[edx+3]']
or ['ecx,', 'eax']
push ['ecx']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jl ['short', 'loc_168C9']
mov ['ecx,', '[ebp+arg_C]']
sub ['ecx,', '[ebp+Size]']
sub ['ecx,', '4']
cmp ['[ebp+var_10],', 'ecx']
jle ['short', 'loc_168CE']
jmp ['$give_up$89261']
mov ['edx,', '[ebp+Size]']
add ['edx,', '4']
mov ['[ebp+Size],', 'edx']
cmp ['[ebp+var_10],', '0']
jle ['short', 'loc_168FE']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '[ebp+Size]']
movzx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_168FE']
mov ['edx,', '[ebp+var_10]']
sub ['edx,', '1']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+Size]']
add ['eax,', '1']
mov ['[ebp+Size],', 'eax']
jmp ['short', 'loc_168D7']
mov ['[ebp+Size],', '0Bh']
mov ['ecx,', '[ebp+Size]']
add ['ecx,', '4']
cmp ['[ebp+arg_14],', 'ecx']
jge ['short', 'loc_16915']
jmp ['$give_up$89261']
mov ['edx,', '[ebp+Src]']
add ['edx,', '[ebp+Size]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+Src]']
add ['ecx,', '[ebp+Size]']
movzx ['edx,', 'byte', 'ptr', '[ecx+1]']
shl ['edx,', '10h']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+Src]']
add ['ecx,', '[ebp+Size]']
movzx ['edx,', 'byte', 'ptr', '[ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+Src]']
add ['ecx,', '[ebp+Size]']
movzx ['edx,', 'byte', 'ptr', '[ecx+3]']
or ['eax,', 'edx']
push ['eax']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_14],', 'eax']
mov ['eax,', '[ebp+arg_14]']
sub ['eax,', '[ebp+Size]']
sub ['eax,', '4']
cmp ['[ebp+var_14],', 'eax']
jz ['short', 'loc_1696A']
jmp ['$give_up$89261']
mov ['ecx,', '[ebp+var_10]']
cmp ['ecx,', '[ebp+var_14]']
jz ['$give_up$89261']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+Size]']
add ['eax,', '4']
mov ['[ebp+Size],', 'eax']
mov ['ecx,', '[ebp+var_10]']
sar ['ecx,', '18h']
mov ['byte', 'ptr', '[ebp+var_1C],', 'cl']
mov ['edx,', '[ebp+var_10]']
sar ['edx,', '10h']
mov ['byte', 'ptr', '[ebp+var_1C+1],', 'dl']
mov ['eax,', '[ebp+var_10]']
sar ['eax,', '8']
mov ['byte', 'ptr', '[ebp+var_1C+2],', 'al']
mov ['cl,', 'byte', 'ptr', '[ebp+var_10]']
mov ['byte', 'ptr', '[ebp+var_1C+3],', 'cl']
push ['4']
lea ['edx,', '[ebp+var_1C]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['byte', 'ptr', '[ebp+var_1C],', '0']
mov ['ecx,', '[ebp+var_10]']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', '[ebp+var_10]']
sub ['eax,', '1']
mov ['[ebp+var_10],', 'eax']
cmp ['ecx,', 'edx']
jle ['short', 'loc_169F2']
mov ['[ebp+var_24],', '1']
jmp ['short', 'loc_169F9']
mov ['[ebp+var_24],', '0']
cmp ['[ebp+var_24],', '0']
jz ['short', 'loc_16A13']
push ['1']
lea ['ecx,', '[ebp+var_1C]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
jmp ['short', 'loc_169D6']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
add ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
jmp ['short', 'loc_16A4C']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_14]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN20_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_setup_portfwd proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0E4h']
push ['edi']
lea ['edi,', '[ebp+var_E4]']
mov ['ecx,', '39h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+114h],', '0']
jnz ['short', 'loc_16AC8']
push ['offset', '_ssh_portcmp']
call ['_newtree234']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+114h],', 'eax']
jmp ['short', 'loc_16B04']
mov ['[ebp+var_20],', '0']
jmp ['short', 'loc_16ADA']
mov ['edx,', '[ebp+var_20]']
add ['edx,', '1']
mov ['[ebp+var_20],', 'edx']
mov ['eax,', '[ebp+var_20]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+114h]']
push ['edx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_1C],', 'eax']
cmp ['[ebp+var_1C],', '0']
jz ['short', 'loc_16B04']
mov ['eax,', '[ebp+var_1C]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['short', 'loc_16AD1']
lea ['ecx,', '[ebp+var_10]']
push ['ecx']
push ['0']
push ['96h']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_conf_get_str_strs']
add ['esp,', '10h']
mov ['[ebp+Str1],', 'eax']
jmp ['short', 'loc_16B3C']
lea ['eax,', '[ebp+var_10]']
push ['eax']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
push ['96h']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_conf_get_str_strs']
add ['esp,', '10h']
mov ['[ebp+Str1],', 'eax']
cmp ['[ebp+Str1],', '0']
jz ['loc_16EE7']
mov ['eax,', '[ebp+var_10]']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_31],', '41h']
mov ['[ebp+var_32],', '4Ch']
mov ['ecx,', '[ebp+var_24]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '41h']
jz ['short', 'loc_16B75']
mov ['eax,', '[ebp+var_24]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '34h']
jz ['short', 'loc_16B75']
mov ['edx,', '[ebp+var_24]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '36h']
jnz ['short', 'loc_16B86']
mov ['ecx,', '[ebp+var_24]']
mov ['dl,', '[ecx]']
mov ['[ebp+var_31],', 'dl']
mov ['eax,', '[ebp+var_24]']
add ['eax,', '1']
mov ['[ebp+var_24],', 'eax']
mov ['ecx,', '[ebp+var_24]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '4Ch']
jz ['short', 'loc_16B9C']
mov ['eax,', '[ebp+var_24]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '52h']
jnz ['short', 'loc_16BAD']
mov ['edx,', '[ebp+var_24]']
mov ['al,', '[edx]']
mov ['[ebp+var_32],', 'al']
mov ['ecx,', '[ebp+var_24]']
add ['ecx,', '1']
mov ['[ebp+var_24],', 'ecx']
push ['3Ah']
mov ['edx,', '[ebp+var_24]']
push ['edx']
call ['_host_strchr']
add ['esp,', '8']
mov ['[ebp+var_28],', 'eax']
cmp ['[ebp+var_28],', '0']
jz ['short', 'loc_16C05']
mov ['eax,', '[ebp+var_24]']
push ['eax']
mov ['ecx,', '[ebp+var_28]']
sub ['ecx,', '[ebp+var_24]']
push ['ecx']
push ['offset', '$SG90918']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_58],', 'eax']
mov ['edx,', '[ebp+var_58]']
push ['edx']
call ['_host_strduptrim']
add ['esp,', '4']
mov ['[ebp+var_50],', 'eax']
mov ['eax,', '[ebp+var_58]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_28]']
add ['ecx,', '1']
mov ['[ebp+Str],', 'ecx']
jmp ['short', 'loc_16C12']
mov ['[ebp+var_50],', '0']
mov ['edx,', '[ebp+var_24]']
mov ['[ebp+Str],', 'edx']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_atoi']
add ['esp,', '4']
mov ['[ebp+var_38],', 'eax']
mov ['[ebp+var_40],', '0']
cmp ['[ebp+var_38],', '0']
jnz ['short', 'loc_16C5F']
mov ['[ebp+var_40],', '1']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_net_service_lookup']
add ['esp,', '4']
mov ['[ebp+var_38],', 'eax']
cmp ['[ebp+var_38],', '0']
jnz ['short', 'loc_16C5F']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '$SG90923']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
movsx ['ecx,', '[ebp+var_32]']
cmp ['ecx,', '4Ch']
jnz ['short', 'loc_16CA2']
push ['offset', '$SG90925']
mov ['edx,', '[ebp+Str1]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_16CA2']
mov ['[ebp+var_54],', '0']
mov ['[ebp+var_4C],', '0']
mov ['[ebp+var_3C],', '0FFFFFFFFh']
mov ['[ebp+var_44],', '0']
mov ['[ebp+var_32],', '44h']
jmp ['loc_16D40']
mov ['eax,', '[ebp+Str1]']
mov ['[ebp+var_2C],', 'eax']
push ['offset', '$SG90929']
mov ['ecx,', '[ebp+var_2C]']
push ['ecx']
call ['_host_strcspn']
add ['esp,', '8']
add ['eax,', '[ebp+var_2C]']
mov ['[ebp+var_30],', 'eax']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', '[ebp+var_30]']
sub ['eax,', '[ebp+var_2C]']
push ['eax']
push ['offset', '$SG90931']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_54],', 'eax']
mov ['ecx,', '[ebp+var_30]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_16CED']
mov ['eax,', '[ebp+var_30]']
add ['eax,', '1']
mov ['[ebp+var_30],', 'eax']
mov ['ecx,', '[ebp+var_30]']
mov ['[ebp+var_4C],', 'ecx']
mov ['edx,', '[ebp+var_4C]']
push ['edx']
call ['_atoi']
add ['esp,', '4']
mov ['[ebp+var_3C],', 'eax']
mov ['[ebp+var_44],', '0']
cmp ['[ebp+var_3C],', '0']
jnz ['short', 'loc_16D40']
mov ['[ebp+var_44],', '1']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
call ['_net_service_lookup']
add ['esp,', '4']
mov ['[ebp+var_3C],', 'eax']
cmp ['[ebp+var_3C],', '0']
jnz ['short', 'loc_16D40']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
push ['offset', '$SG90935']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
cmp ['[ebp+var_38],', '0']
jz ['loc_16ECA']
cmp ['[ebp+var_3C],', '0']
jz ['loc_16ECA']
push ['2Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_5C],', 'eax']
movsx ['eax,', '[ebp+var_32]']
mov ['ecx,', '[ebp+var_5C]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+var_5C]']
mov ['eax,', '[ebp+var_50]']
mov ['[edx+10h],', 'eax']
cmp ['[ebp+var_40],', '0']
jz ['short', 'loc_16D90']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+var_8C],', 'eax']
jmp ['short', 'loc_16D9A']
mov ['[ebp+var_8C],', '0']
mov ['edx,', '[ebp+var_5C]']
mov ['eax,', '[ebp+var_8C]']
mov ['[edx+18h],', 'eax']
mov ['ecx,', '[ebp+var_5C]']
mov ['edx,', '[ebp+var_38]']
mov ['[ecx+8],', 'edx']
mov ['eax,', '[ebp+var_5C]']
mov ['ecx,', '[ebp+var_54]']
mov ['[eax+14h],', 'ecx']
cmp ['[ebp+var_44],', '0']
jz ['short', 'loc_16DD2']
mov ['edx,', '[ebp+var_4C]']
push ['edx']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+var_90],', 'eax']
jmp ['short', 'loc_16DDC']
mov ['[ebp+var_90],', '0']
mov ['eax,', '[ebp+var_5C]']
mov ['ecx,', '[ebp+var_90]']
mov ['[eax+1Ch],', 'ecx']
mov ['edx,', '[ebp+var_5C]']
mov ['eax,', '[ebp+var_3C]']
mov ['[edx+0Ch],', 'eax']
mov ['ecx,', '[ebp+var_5C]']
mov ['dword', 'ptr', '[ecx+28h],', '0']
mov ['edx,', '[ebp+var_5C]']
mov ['dword', 'ptr', '[edx+20h],', '0']
movsx ['eax,', '[ebp+var_31]']
cmp ['eax,', '34h']
jnz ['short', 'loc_16E1A']
mov ['[ebp+var_94],', '1']
jmp ['short', 'loc_16E31']
movsx ['ecx,', '[ebp+var_31]']
sub ['ecx,', '36h']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '0FFFFFFFEh']
add ['ecx,', '2']
mov ['[ebp+var_94],', 'ecx']
mov ['edx,', '[ebp+var_5C]']
mov ['eax,', '[ebp+var_94]']
mov ['[edx+24h],', 'eax']
mov ['ecx,', '[ebp+var_5C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+114h]']
push ['eax']
call ['_add234']
add ['esp,', '8']
mov ['[ebp+var_60],', 'eax']
mov ['ecx,', '[ebp+var_60]']
cmp ['ecx,', '[ebp+var_5C]']
jz ['short', 'loc_16EBF']
mov ['edx,', '[ebp+var_60]']
cmp ['dword', 'ptr', '[edx],', '0']
jnz ['short', 'loc_16E6F']
mov ['eax,', '[ebp+var_60]']
mov ['dword', 'ptr', '[eax],', '1']
cmp ['[ebp+var_5C],', '0']
jz ['short', 'loc_16EB1']
mov ['ecx,', '[ebp+var_5C]']
mov ['edx,', '[ecx+10h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_5C]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_5C]']
mov ['eax,', '[edx+18h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_5C]']
mov ['edx,', '[ecx+1Ch]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_5C]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_16EC8']
mov ['ecx,', '[ebp+var_5C]']
mov ['dword', 'ptr', '[ecx],', '2']
jmp ['short', 'loc_16EE2']
mov ['edx,', '[ebp+var_50]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_54]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_16B20']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_16EF9']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+114h]']
push ['ecx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['loc_171AD']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx],', '0']
jnz ['loc_171A8']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+10h],', '0']
jz ['short', 'loc_16F3D']
mov ['[ebp+var_98],', 'offset', '$SG90956']
jmp ['short', 'loc_16F47']
mov ['[ebp+var_98],', 'offset', '$SG90957']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jz ['short', 'loc_16F5E']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+10h]']
mov ['[ebp+var_9C],', 'eax']
jmp ['short', 'loc_16F68']
mov ['[ebp+var_9C],', 'offset', '$SG90958']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '4Ch']
jnz ['short', 'loc_16F7D']
mov ['[ebp+var_A0],', 'offset', '$SG90959']
jmp ['short', 'loc_16FA8']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+4],', '52h']
jnz ['short', 'loc_16F92']
mov ['[ebp+var_A4],', 'offset', '$SG90960']
jmp ['short', 'loc_16F9C']
mov ['[ebp+var_A4],', 'offset', '$SG90961']
mov ['eax,', '[ebp+var_A4]']
mov ['[ebp+var_A0],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_98]']
push ['eax']
mov ['ecx,', '[ebp+var_9C]']
push ['ecx']
mov ['edx,', '[ebp+var_A0]']
push ['edx']
push ['offset', '$SG90962']
call ['_dupprintf']
add ['esp,', '14h']
mov ['[ebp+var_64],', 'eax']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+4],', '44h']
jz ['short', 'loc_17011']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
mov ['edx,', '[ebp+var_64]']
push ['edx']
push ['offset', '$SG90965']
call ['_dupprintf']
add ['esp,', '10h']
mov ['[ebp+var_68],', 'eax']
mov ['eax,', '[ebp+var_64]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_68]']
mov ['[ebp+var_64],', 'ecx']
mov ['edx,', '[ebp+var_64]']
push ['edx']
push ['offset', '$SG90966']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_64]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+20h],', '0']
jz ['loc_17123']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['[ebp+var_6C],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+16Ch],', '1']
jnz ['short', 'loc_17059']
jmp ['loc_170FF']
push ['50h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_70],', 'eax']
push ['offset', '$SG90972']
mov ['eax,', '[ebp+var_70]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['0']
mov ['ecx,', '[ebp+var_70]']
push ['ecx']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jz ['short', 'loc_170A3']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
mov ['edx,', '[ebp+var_70]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
jmp ['short', 'loc_170DC']
push ['95h']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_170CB']
push ['offset', '$SG90976']
mov ['ecx,', '[ebp+var_70]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
jmp ['short', 'loc_170DC']
push ['offset', '$SG90978']
mov ['edx,', '[ebp+var_70]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+var_70]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_70]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['edx,', '[ebp+var_6C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+110h]']
push ['ecx']
call ['_del234']
add ['esp,', '8']
mov ['edx,', '[ebp+var_6C]']
push ['edx']
call ['_free_rportfwd']
add ['esp,', '4']
jmp ['short', 'loc_1713B']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+28h],', '0']
jz ['short', 'loc_1713B']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+28h]']
push ['edx']
call ['_pfl_terminate']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+114h]']
push ['edx']
call ['_delpos234']
add ['esp,', '8']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_17193']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+18h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
sub ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
jmp ['loc_16EF0']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_171BF']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+114h]']
push ['ecx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['loc_1780E']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx],', '2']
jnz ['loc_17809']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+18h],', '0']
jz ['short', 'loc_17203']
mov ['[ebp+var_A8],', 'offset', '$SG90989']
jmp ['short', 'loc_1720D']
mov ['[ebp+var_A8],', 'offset', '$SG90990']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+18h],', '0']
jz ['short', 'loc_17222']
mov ['[ebp+var_AC],', 'offset', '$SG90991']
jmp ['short', 'loc_1722C']
mov ['[ebp+var_AC],', 'offset', '$SG90992']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+18h],', '0']
jz ['short', 'loc_17243']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+18h]']
mov ['[ebp+var_B0],', 'ecx']
jmp ['short', 'loc_1724D']
mov ['[ebp+var_B0],', 'offset', '$SG90993']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jz ['short', 'loc_17262']
mov ['[ebp+var_B4],', 'offset', '$SG90994']
jmp ['short', 'loc_1726C']
mov ['[ebp+var_B4],', 'offset', '$SG90995']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+10h],', '0']
jz ['short', 'loc_17283']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+10h]']
mov ['[ebp+var_B8],', 'edx']
jmp ['short', 'loc_1728D']
mov ['[ebp+var_B8],', 'offset', '$SG90996']
mov ['eax,', '[ebp+var_A8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_AC]']
push ['eax']
mov ['ecx,', '[ebp+var_B0]']
push ['ecx']
mov ['edx,', '[ebp+var_B4]']
push ['edx']
mov ['eax,', '[ebp+var_B8]']
push ['eax']
push ['offset', '$SG90997']
call ['_dupprintf']
add ['esp,', '1Ch']
mov ['[ebp+var_74],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '44h']
jnz ['short', 'loc_172DC']
mov ['[ebp+var_78],', '0']
jmp ['loc_1736E']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+1Ch],', '0']
jz ['short', 'loc_172F1']
mov ['[ebp+var_BC],', 'offset', '$SG91001']
jmp ['short', 'loc_172FB']
mov ['[ebp+var_BC],', 'offset', '$SG91002']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+1Ch],', '0']
jz ['short', 'loc_17310']
mov ['[ebp+var_C0],', 'offset', '$SG91003']
jmp ['short', 'loc_1731A']
mov ['[ebp+var_C0],', 'offset', '$SG91004']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+1Ch],', '0']
jz ['short', 'loc_17331']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
mov ['[ebp+var_C4],', 'eax']
jmp ['short', 'loc_1733B']
mov ['[ebp+var_C4],', 'offset', '$SG91005']
mov ['ecx,', '[ebp+var_BC]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_C0]']
push ['ecx']
mov ['edx,', '[ebp+var_C4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
push ['offset', '$SG91006']
call ['_dupprintf']
add ['esp,', '18h']
mov ['[ebp+var_78],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+4],', '4Ch']
jnz ['loc_17474']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '28h']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+10h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
call ['_pfl_listen']
add ['esp,', '20h']
mov ['[ebp+var_7C],', 'eax']
cmp ['[ebp+var_7C],', '0']
jz ['short', 'loc_173C9']
mov ['ecx,', '[ebp+var_7C]']
mov ['[ebp+var_C8],', 'ecx']
jmp ['short', 'loc_173D3']
mov ['[ebp+var_C8],', 'offset', '$SG91009']
cmp ['[ebp+var_7C],', '0']
jz ['short', 'loc_173E5']
mov ['[ebp+var_CC],', 'offset', '$SG91010']
jmp ['short', 'loc_173EF']
mov ['[ebp+var_CC],', 'offset', '$SG91011']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+24h],', '1']
jnz ['short', 'loc_17404']
mov ['[ebp+var_D0],', 'offset', '$SG91012']
jmp ['short', 'loc_1742F']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+24h],', '2']
jnz ['short', 'loc_17419']
mov ['[ebp+var_D4],', 'offset', '$SG91013']
jmp ['short', 'loc_17423']
mov ['[ebp+var_D4],', 'offset', '$SG91014']
mov ['ecx,', '[ebp+var_D4]']
mov ['[ebp+var_D0],', 'ecx']
mov ['edx,', '[ebp+var_C8]']
push ['edx']
mov ['eax,', '[ebp+var_CC]']
push ['eax']
mov ['ecx,', '[ebp+var_78]']
push ['ecx']
mov ['edx,', '[ebp+var_74]']
push ['edx']
mov ['eax,', '[ebp+var_D0]']
push ['eax']
push ['offset', '$SG91015']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '1Ch']
cmp ['[ebp+var_7C],', '0']
jz ['short', 'loc_1746F']
mov ['edx,', '[ebp+var_7C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_177F1']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+4],', '44h']
jnz ['loc_1756C']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '28h']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+10h]']
push ['eax']
push ['0FFFFFFFFh']
push ['0']
call ['_pfl_listen']
add ['esp,', '20h']
mov ['[ebp+var_80],', 'eax']
cmp ['[ebp+var_80],', '0']
jz ['short', 'loc_174C5']
mov ['ecx,', '[ebp+var_80]']
mov ['[ebp+var_D8],', 'ecx']
jmp ['short', 'loc_174CF']
mov ['[ebp+var_D8],', 'offset', '$SG91021']
cmp ['[ebp+var_80],', '0']
jz ['short', 'loc_174E1']
mov ['[ebp+var_DC],', 'offset', '$SG91022']
jmp ['short', 'loc_174EB']
mov ['[ebp+var_DC],', 'offset', '$SG91023']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+24h],', '1']
jnz ['short', 'loc_17500']
mov ['[ebp+var_E0],', 'offset', '$SG91024']
jmp ['short', 'loc_1752B']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+24h],', '2']
jnz ['short', 'loc_17515']
mov ['[ebp+var_E4],', 'offset', '$SG91025']
jmp ['short', 'loc_1751F']
mov ['[ebp+var_E4],', 'offset', '$SG91026']
mov ['ecx,', '[ebp+var_E4]']
mov ['[ebp+var_E0],', 'ecx']
mov ['edx,', '[ebp+var_D8]']
push ['edx']
mov ['eax,', '[ebp+var_DC]']
push ['eax']
mov ['ecx,', '[ebp+var_74]']
push ['ecx']
mov ['edx,', '[ebp+var_E0]']
push ['edx']
push ['offset', '$SG91027']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '18h']
cmp ['[ebp+var_80],', '0']
jz ['short', 'loc_17567']
mov ['ecx,', '[ebp+var_80]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_177F1']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+110h],', '0']
jnz ['short', 'loc_175B2']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+16Ch],', '1']
jnz ['short', 'loc_1759C']
push ['offset', '_ssh_rportcmp_ssh1']
call ['_newtree234']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+110h],', 'eax']
jmp ['short', 'loc_175B2']
push ['offset', '_ssh_rportcmp_ssh2']
call ['_newtree234']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+110h],', 'eax']
push ['1Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_84],', 'eax']
mov ['eax,', '[ebp+var_84]']
mov ['dword', 'ptr', '[eax+14h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_84]']
mov ['[ecx+0Ch],', 'eax']
mov ['edx,', '[ebp+var_84]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
mov ['[edx+4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jz ['short', 'loc_1761B']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+var_84]']
mov ['[edx+8],', 'eax']
jmp ['short', 'loc_1765E']
push ['95h']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_17648']
push ['offset', '$SG91040']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_84]']
mov ['[ecx+8],', 'eax']
jmp ['short', 'loc_1765E']
push ['offset', '$SG91042']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+var_84]']
mov ['[edx+8],', 'eax']
mov ['eax,', '[ebp+var_84]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
mov ['[eax],', 'edx']
mov ['eax,', '[ebp+var_84]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+110h]']
push ['edx']
call ['_add234']
add ['esp,', '8']
cmp ['eax,', '[ebp+var_84]']
jz ['short', 'loc_176C0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
push ['offset', '$SG91044']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_84]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_177F1']
mov ['eax,', '[ebp+var_78]']
push ['eax']
mov ['ecx,', '[ebp+var_74]']
push ['ecx']
push ['offset', '$SG91046']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_84]']
mov ['ecx,', '[ebp+var_74]']
mov ['[eax+10h],', 'ecx']
mov ['[ebp+var_74],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_84]']
mov ['[edx+20h],', 'eax']
mov ['ecx,', '[ebp+var_84]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx+18h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+16Ch],', '1']
jnz ['short', 'loc_1775C']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
push ['1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
push ['4']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
push ['1']
push ['1Ch']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '24h']
mov ['edx,', '[ebp+var_84]']
push ['edx']
push ['offset', '_ssh_rportfwd_succfail']
push ['0Fh']
push ['0Eh']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_queue_handler']
add ['esp,', '14h']
jmp ['loc_177F1']
push ['50h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_88],', 'eax']
push ['offset', '$SG91051']
mov ['ecx,', '[ebp+var_88]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['1']
mov ['edx,', '[ebp+var_88]']
push ['edx']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
mov ['eax,', '[ebp+var_84]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+var_88]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['eax,', '[ebp+var_84]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+var_88]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_88]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['edx,', '[ebp+var_84]']
push ['edx']
push ['offset', '_ssh_rportfwd_succfail']
push ['52h']
push ['51h']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_queue_handler']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_74]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_78]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_171B6']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN118_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '0E4h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_free_rportfwd  proc near               
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_1789A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_rportcmp_ssh1 proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_178FD']
xor ['eax,', 'eax']
cmp ['[ebp+var_C],', '0']
setnl ['al']
lea ['eax,', '[eax+eax-1]']
jmp ['short', 'loc_17927']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[eax+4]']
cmp ['edx,', '[ecx+4]']
jbe ['short', 'loc_17912']
mov ['eax,', '1']
jmp ['short', 'loc_17927']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[eax+4]']
cmp ['edx,', '[ecx+4]']
jnb ['short', 'loc_17925']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_17927']
xor ['eax,', 'eax']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_portcmp    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+4]']
cmp ['ecx,', '[eax+4]']
jle ['short', 'loc_17977']
mov ['eax,', '1']
jmp ['loc_17A75']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+4]']
cmp ['ecx,', '[eax+4]']
jge ['short', 'loc_1798D']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_17A75']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+24h]']
cmp ['ecx,', '[eax+24h]']
jle ['short', 'loc_179A5']
mov ['eax,', '1']
jmp ['loc_17A75']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+24h]']
cmp ['ecx,', '[eax+24h]']
jge ['short', 'loc_179BB']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_17A75']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+10h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+10h]']
push ['edx']
call ['_nullstrcmp']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_179EC']
xor ['eax,', 'eax']
cmp ['[ebp+var_C],', '0']
setnl ['al']
lea ['eax,', '[eax+eax-1]']
jmp ['loc_17A75']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[eax+8]']
cmp ['edx,', '[ecx+8]']
jbe ['short', 'loc_17A01']
mov ['eax,', '1']
jmp ['short', 'loc_17A75']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[eax+8]']
cmp ['edx,', '[ecx+8]']
jnb ['short', 'loc_17A14']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_17A75']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+4],', '44h']
jz ['short', 'loc_17A73']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+14h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
call ['_nullstrcmp']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_17A4B']
xor ['eax,', 'eax']
cmp ['[ebp+var_C],', '0']
setnl ['al']
lea ['eax,', '[eax+eax-1]']
jmp ['short', 'loc_17A75']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+0Ch]']
cmp ['ecx,', '[eax+0Ch]']
jbe ['short', 'loc_17A60']
mov ['eax,', '1']
jmp ['short', 'loc_17A75']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+0Ch]']
cmp ['ecx,', '[eax+0Ch]']
jnb ['short', 'loc_17A73']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_17A75']
xor ['eax,', 'eax']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_nullstrcmp     proc near               
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+Str1],', '0']
jnz ['short', 'loc_17A9B']
cmp ['[ebp+Str2],', '0']
jnz ['short', 'loc_17A9B']
xor ['eax,', 'eax']
jmp ['short', 'loc_17AC3']
cmp ['[ebp+Str1],', '0']
jnz ['short', 'loc_17AA6']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_17AC3']
cmp ['[ebp+Str2],', '0']
jnz ['short', 'loc_17AB3']
mov ['eax,', '1']
jmp ['short', 'loc_17AC3']
mov ['eax,', '[ebp+Str2]']
push ['eax']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_strcmp']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_rportfwd_succfail proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+16Ch]']
sub ['edx,', '1']
neg ['edx']
sbb ['edx,', 'edx']
and ['edx,', '43h']
add ['edx,', '0Eh']
mov ['eax,', '[ebp+arg_4]']
cmp ['[eax+8],', 'edx']
jnz ['short', 'loc_17B2A']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+10h]']
push ['edx']
push ['offset', '$SG90834']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
jmp ['short', 'loc_17B93']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+10h]']
push ['edx']
push ['offset', '$SG90836']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+110h]']
push ['eax']
call ['_del234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[ebp+var_8]']
jz ['short', 'loc_17B7A']
push ['1342h']
push ['offset', '$SG90838']
push ['offset', '$SG90839']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+18h]']
mov ['dword', 'ptr', '[ecx+20h],', '0']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_free_rportfwd']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_try_send_and_unthrottle proc near 
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+14h]']
and ['ecx,', '1']
jz ['short', 'loc_17BC9']
jmp ['short', 'loc_17C19']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh2_try_send']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_17C19']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+0Ch]']
mov ['[ebp+var_8],', 'ecx']
cmp ['[ebp+var_8],', '1']
jz ['short', 'loc_17BF7']
cmp ['[ebp+var_8],', '3']
jz ['short', 'loc_17C0A']
jmp ['short', 'loc_17C19']
jmp ['short', 'loc_17C19']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_x11_unthrottle']
add ['esp,', '4']
jmp ['short', 'loc_17C19']
jmp ['short', 'loc_17C19']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_pfd_unthrottle']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_channel_init proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_alloc_channel_id']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+8],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+14h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+18h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_is_simple']
add ['esp,', '4']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '7FFFBFFFh']
add ['eax,', '4000h']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_8]']
mov ['[eax+3Ch],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_8]']
mov ['[edx+38h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
mov ['[ecx+34h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+40h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+48h],', '2']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '20h']
push ['edx']
call ['_bufchain_init']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_alloc_channel_id proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_4],', '100h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0F8h]']
push ['ecx']
call ['_count234']
add ['esp,', '4']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_8],', '0FFFFFFFFh']
mov ['edx,', '[ebp+var_14]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_C]']
sub ['eax,', '[ebp+var_8]']
cmp ['eax,', '1']
jbe ['short', 'loc_17D84']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '[ebp+var_8]']
shr ['ecx,', '1']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_10]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0F8h]']
push ['ecx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_18],', 'eax']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_18]']
cmp ['[eax+8],', 'edx']
jnz ['short', 'loc_17D7C']
mov ['ecx,', '[ebp+var_10]']
mov ['[ebp+var_8],', 'ecx']
jmp ['short', 'loc_17D82']
mov ['edx,', '[ebp+var_10]']
mov ['[ebp+var_C],', 'edx']
jmp ['short', 'loc_17D37']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
lea ['edx,', '[ecx+eax+1]']
mov ['[ebp+var_20],', 'edx']
push ['offset', '_ssh_channelfind']
lea ['eax,', '[ebp+var_20]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F8h]']
push ['edx']
call ['_find234']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_17DC7']
push ['45Fh']
push ['offset', '$SG88263']
push ['offset', '$SG88264']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_8]']
lea ['eax,', '[edx+ecx+1]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN10_4']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_channelfind proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx]']
cmp ['ecx,', '[eax+8]']
jnb ['short', 'loc_17E3A']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_17E50']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx]']
cmp ['ecx,', '[eax+8]']
jbe ['short', 'loc_17E4E']
mov ['eax,', '1']
jmp ['short', 'loc_17E50']
xor ['eax,', 'eax']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_chanopen_init proc near           
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['5Ah']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+34h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['4000h']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_channel_response proc near    
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_channel_msg']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_17EFB']
jmp ['loc_17F90']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0Ch],', '5']
jnz ['short', 'loc_17F29']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
jmp ['short', 'loc_17F90']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+40h]']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_17F4A']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_msg_unexpected']
add ['esp,', '8']
jmp ['short', 'loc_17F90']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+8]']
mov ['[eax+40h],', 'edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh2_channel_check_close']
add ['esp,', '4']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_channel_msg proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+Str],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
push ['offset', '_ssh_channelfind']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0F8h]']
push ['eax']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_18028']
mov ['ecx,', '[ebp+var_10]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '5']
jz ['loc_180A0']
mov ['edx,', '[ebp+var_10]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jz ['loc_180A0']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '5Bh']
jz ['loc_180A0']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+8],', '5Ch']
jz ['short', 'loc_180A0']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_18037']
mov ['[ebp+var_18],', 'offset', '$SG92250']
jmp ['short', 'loc_1803E']
mov ['[ebp+var_18],', 'offset', '$SG92251']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+15Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+158h]']
push ['eax']
call ['_ssh2_pkt_type']
add ['esp,', '0Ch']
push ['eax']
push ['offset', '$SG92252']
call ['_dupprintf']
add ['esp,', '10h']
mov ['[ebp+Str],', 'eax']
push ['0']
push ['2']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
xor ['eax,', 'eax']
jmp ['short', 'loc_180A3']
mov ['eax,', '[ebp+var_10]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN9_4']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_channel_window_adjust proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_channel_msg']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_1810E']
jmp ['short', 'loc_1816F']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0Ch],', '5']
jnz ['short', 'loc_1813C']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
jmp ['short', 'loc_1816F']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
and ['eax,', '1']
jnz ['short', 'loc_1816F']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
add ['eax,', '[edx+2Ch]']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+2Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_try_send_and_unthrottle']
add ['esp,', '8']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_channel_data proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '50h']
push ['edi']
lea ['edi,', '[ebp+var_50]']
mov ['ecx,', '14h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_channel_msg']
add ['esp,', '8']
mov ['[ebp+var_1C],', 'eax']
cmp ['[ebp+var_1C],', '0']
jnz ['short', 'loc_181BC']
jmp ['loc_1856A']
mov ['edx,', '[ebp+var_1C]']
cmp ['dword', 'ptr', '[edx+0Ch],', '5']
jnz ['short', 'loc_181ED']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
jmp ['loc_1856A']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '5Fh']
jnz ['short', 'loc_1820C']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
cmp ['eax,', '1']
jz ['short', 'loc_1820C']
jmp ['loc_1856A']
lea ['ecx,', '[ebp+var_14]']
push ['ecx']
lea ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Src],', '0']
jz ['loc_1856A']
mov ['[ebp+var_20],', '0']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[ecx+34h]']
sub ['edx,', '[ebp+var_14]']
mov ['eax,', '[ebp+var_1C]']
mov ['[eax+34h],', 'edx']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[ecx+3Ch]']
sub ['edx,', '[ebp+var_14]']
mov ['eax,', '[ebp+var_1C]']
mov ['[eax+3Ch],', 'edx']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[ecx+0Ch]']
mov ['[ebp+var_44],', 'edx']
cmp ['[ebp+var_44],', '3']
ja ['loc_184C9']
mov ['eax,', '[ebp+var_44]']
jmp ['ds:$LN35[eax*4]']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
xor ['ecx,', 'ecx']
cmp ['dword', 'ptr', '[eax+8],', '5Fh']
setz ['cl']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_from_backend']
add ['esp,', '10h']
mov ['[ebp+var_20],', 'eax']
jmp ['loc_184C9']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_x11_send']
add ['esp,', '0Ch']
mov ['[ebp+var_20],', 'eax']
jmp ['loc_184C9']
mov ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_pfd_send']
add ['esp,', '0Ch']
mov ['[ebp+var_20],', 'eax']
jmp ['loc_184C9']
cmp ['[ebp+var_14],', '0']
jle ['loc_184C2']
mov ['eax,', '[ebp+var_1C]']
cmp ['dword', 'ptr', '[eax+54h],', '4']
jnb ['short', 'loc_18357']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '4']
sub ['edx,', '[ecx+54h]']
cmp ['edx,', '[ebp+var_14]']
jnb ['short', 'loc_1830C']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '4']
sub ['ecx,', '[eax+54h]']
mov ['[ebp+var_48],', 'ecx']
jmp ['short', 'loc_18312']
mov ['edx,', '[ebp+var_14]']
mov ['[ebp+var_48],', 'edx']
mov ['eax,', '[ebp+var_48]']
mov ['[ebp+Size],', 'eax']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[eax+54h]']
mov ['edx,', '[ebp+var_1C]']
lea ['eax,', '[edx+ecx+50h]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Src]']
add ['ecx,', '[ebp+Size]']
mov ['[ebp+Src],', 'ecx']
mov ['edx,', '[ebp+var_14]']
sub ['edx,', '[ebp+Size]']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[eax+54h]']
add ['ecx,', '[ebp+Size]']
mov ['edx,', '[ebp+var_1C]']
mov ['[edx+54h],', 'ecx']
mov ['eax,', '[ebp+var_1C]']
cmp ['dword', 'ptr', '[eax+54h],', '4']
jnz ['short', 'loc_183C3']
mov ['ecx,', '[ebp+var_1C]']
movzx ['edx,', 'byte', 'ptr', '[ecx+50h]']
shl ['edx,', '18h']
mov ['eax,', '[ebp+var_1C]']
movzx ['ecx,', 'byte', 'ptr', '[eax+51h]']
shl ['ecx,', '10h']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_1C]']
movzx ['ecx,', 'byte', 'ptr', '[eax+52h]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_1C]']
movzx ['ecx,', 'byte', 'ptr', '[eax+53h]']
or ['edx,', 'ecx']
add ['edx,', '4']
mov ['eax,', '[ebp+var_1C]']
mov ['[eax+58h],', 'edx']
push ['1']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[ecx+58h]']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_1C]']
mov ['[ecx+4Ch],', 'eax']
push ['4']
mov ['edx,', '[ebp+var_1C]']
add ['edx,', '50h']
push ['edx']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_1C]']
cmp ['dword', 'ptr', '[edx+54h],', '4']
jb ['short', 'loc_1843E']
cmp ['[ebp+var_14],', '0']
jle ['short', 'loc_1843E']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[eax+58h]']
sub ['edx,', '[ecx+54h]']
cmp ['edx,', '[ebp+var_14]']
jnb ['short', 'loc_183F4']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[eax+58h]']
sub ['edx,', '[ecx+54h]']
mov ['[ebp+var_4C],', 'edx']
jmp ['short', 'loc_183FA']
mov ['eax,', '[ebp+var_14]']
mov ['[ebp+var_4C],', 'eax']
mov ['ecx,', '[ebp+var_4C]']
mov ['[ebp+var_28],', 'ecx']
mov ['edx,', '[ebp+var_28]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[ecx+4Ch]']
mov ['eax,', '[ebp+var_1C]']
add ['edx,', '[eax+54h]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Src]']
add ['ecx,', '[ebp+var_28]']
mov ['[ebp+Src],', 'ecx']
mov ['edx,', '[ebp+var_14]']
sub ['edx,', '[ebp+var_28]']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[eax+54h]']
add ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ebp+var_1C]']
mov ['[edx+54h],', 'ecx']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[eax+54h]']
cmp ['edx,', '[ecx+58h]']
jnz ['short', 'loc_184BD']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[eax+5Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_1C]']
mov ['[edx+5Ch],', 'ecx']
mov ['eax,', '[ebp+var_1C]']
push ['eax']
push ['offset', '_ssh_agentf_callback']
lea ['ecx,', '[ebp+var_3C]']
push ['ecx']
lea ['edx,', '[ebp+var_30]']
push ['edx']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[eax+58h]']
push ['ecx']
mov ['edx,', '[ebp+var_1C]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_agent_query']
add ['esp,', '18h']
test ['eax,', 'eax']
jz ['short', 'loc_1849A']
mov ['ecx,', '[ebp+var_3C]']
push ['ecx']
mov ['edx,', '[ebp+var_30]']
push ['edx']
mov ['eax,', '[ebp+var_1C]']
push ['eax']
call ['_ssh_agentf_callback']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_1C]']
mov ['dword', 'ptr', '[eax+4Ch],', '0']
mov ['ecx,', '[ebp+var_1C]']
mov ['dword', 'ptr', '[ecx+54h],', '0']
jmp ['$LN10_5']
mov ['[ebp+var_20],', '0']
mov ['edx,', '[ebp+var_1C]']
cmp ['dword', 'ptr', '[edx+3Ch],', '0']
jg ['short', 'loc_184F8']
mov ['eax,', '[ebp+var_1C]']
cmp ['dword', 'ptr', '[eax+48h],', '2']
jnz ['short', 'loc_184F8']
mov ['ecx,', '[ebp+var_1C]']
cmp ['dword', 'ptr', '[ecx+38h],', '40000000h']
jge ['short', 'loc_184F8']
mov ['edx,', '[ebp+var_1C]']
mov ['eax,', '[edx+38h]']
add ['eax,', '4000h']
mov ['ecx,', '[ebp+var_1C]']
mov ['[ecx+38h],', 'eax']
mov ['edx,', '[ebp+var_1C]']
mov ['eax,', '[ebp+var_20]']
cmp ['eax,', '[edx+38h]']
jge ['short', 'loc_18511']
mov ['ecx,', '[ebp+var_1C]']
mov ['edx,', '[ecx+38h]']
sub ['edx,', '[ebp+var_20]']
mov ['[ebp+var_50],', 'edx']
jmp ['short', 'loc_18518']
mov ['[ebp+var_50],', '0']
mov ['eax,', '[ebp+var_50]']
push ['eax']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
call ['_ssh2_set_window']
add ['esp,', '8']
mov ['edx,', '[ebp+var_1C]']
mov ['eax,', '[ebp+var_20]']
cmp ['eax,', '[edx+38h]']
jg ['short', 'loc_18549']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_is_simple']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_1856A']
cmp ['[ebp+var_20],', '0']
jle ['short', 'loc_1856A']
mov ['edx,', '[ebp+var_1C]']
cmp ['dword', 'ptr', '[edx+1Ch],', '0']
jnz ['short', 'loc_1856A']
mov ['eax,', '[ebp+var_1C]']
mov ['dword', 'ptr', '[eax+1Ch],', '1']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_throttle_conn']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN34']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '50h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_agentf_callback proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+5Ch]']
sub ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+5Ch],', 'edx']
cmp ['[ebp+var_C],', '0']
jnz ['short', 'loc_1864A']
mov ['[ebp+var_C],', 'offset', '$SG89962']
mov ['[ebp+arg_8],', '5']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '2']
jnz ['short', 'loc_18678']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh2_add_channel_data']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_try_send']
add ['esp,', '4']
jmp ['short', 'loc_186A1']
push ['0']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
push ['3']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
push ['1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
push ['ecx']
push ['1']
push ['17h']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_send_packet']
add ['esp,', '28h']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_186B3']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+5Ch],', '0']
jnz ['short', 'loc_186D3']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
and ['eax,', '4']
jz ['short', 'loc_186D3']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_sshfwd_write_eof']
add ['esp,', '4']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_channel_eof proc near         
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_channel_msg']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_1870E']
jmp ['short', 'loc_18748']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0Ch],', '5']
jnz ['short', 'loc_1873C']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
jmp ['short', 'loc_18748']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_channel_got_eof']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_channel_got_eof proc near         
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
and ['ecx,', '4']
jz ['short', 'loc_18773']
jmp ['loc_1883D']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
or ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0Ch],', '1']
jnz ['short', 'loc_1879F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_x11_send_eof']
add ['esp,', '4']
jmp ['loc_18831']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0Ch],', '2']
jnz ['short', 'loc_187BF']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+5Ch],', '0']
jnz ['short', 'loc_187BD']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_sshfwd_write_eof']
add ['esp,', '4']
jmp ['short', 'loc_18831']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0Ch],', '3']
jnz ['short', 'loc_187D9']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_pfd_send_eof']
add ['esp,', '4']
jmp ['short', 'loc_18831']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0Ch],', '0']
jnz ['short', 'loc_18831']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+124h],', '0']
jnz ['short', 'loc_18824']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_from_backend_eof']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_18818']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+128h],', '0']
jz ['short', 'loc_18824']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sshfwd_write_eof']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+124h],', '1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_channel_check_close']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_channel_close proc near       
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_channel_msg']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_18892']
jmp ['loc_189C5']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0Ch],', '5']
jnz ['short', 'loc_188C3']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
jmp ['loc_189C5']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_channel_got_eof']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
and ['ecx,', '800h']
jnz ['short', 'loc_18929']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+40h],', '0']
jz ['short', 'loc_18929']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+40h]']
mov ['[ebp+var_8],', 'ecx']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+4]']
push ['eax']
push ['0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+8]']
mov ['[ecx+40h],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_188DD']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
and ['eax,', '1']
jnz ['short', 'loc_1899F']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['[ebp+var_C],', 'edx']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_18951']
cmp ['[ebp+var_C],', '1']
jz ['short', 'loc_18960']
cmp ['[ebp+var_C],', '3']
jz ['short', 'loc_18973']
jmp ['short', 'loc_18984']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D8h],', '0']
jmp ['short', 'loc_18984']
push ['1']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_x11_override_throttle']
add ['esp,', '8']
jmp ['short', 'loc_18984']
push ['1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_pfd_override_throttle']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '20h']
push ['edx']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_sshfwd_write_eof']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
and ['edx,', '8']
jnz ['short', 'loc_189C5']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
or ['ecx,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+14h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh2_channel_check_close']
add ['esp,', '4']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_channel_open_confirmation proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_channel_msg']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_18A01']
jmp ['loc_18B0B']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0Ch],', '5']
jnz ['short', 'loc_18A32']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
jmp ['loc_18B0B']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jnz ['short', 'loc_18A52']
push ['1E91h']
push ['offset', '$SG92470']
push ['offset', '$SG92471']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+10h],', '0']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+2Ch],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+30h],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0Ch],', '4']
jnz ['short', 'loc_18ABF']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0Ch],', '3']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4Ch],', '0']
jz ['short', 'loc_18ABD']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_pfd_confirm']
add ['esp,', '4']
jmp ['short', 'loc_18AF6']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '6']
jnz ['short', 'loc_18AD6']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_channel_check_close']
add ['esp,', '4']
jmp ['short', 'loc_18AF6']
mov ['eax,', 'offset', '$SG92478']
test ['eax,', 'eax']
jz ['short', 'loc_18AF6']
push ['1EB0h']
push ['offset', '$SG92479']
push ['offset', '$SG92480']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+18h],', '0']
jz ['short', 'loc_18B0B']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh_channel_try_eof']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_channel_open_failure proc near 
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_channel_msg']
add ['esp,', '8']
mov ['[ebp+var_20],', 'eax']
cmp ['[ebp+var_20],', '0']
jnz ['short', 'loc_18B69']
jmp ['loc_18C75']
mov ['edx,', '[ebp+var_20]']
cmp ['dword', 'ptr', '[edx+0Ch],', '5']
jnz ['short', 'loc_18B9A']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_20]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
jmp ['loc_18C75']
mov ['edx,', '[ebp+var_20]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jnz ['short', 'loc_18BBA']
push ['1ECDh']
push ['offset', '$SG92502']
push ['offset', '$SG92503']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_20]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '4']
jnz ['short', 'loc_18C28']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '5']
jb ['short', 'loc_18BDF']
mov ['[ebp+var_4],', '0']
lea ['eax,', '[ebp+var_18]']
push ['eax']
lea ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', 'ds:?reasons@?1??ssh2_msg_channel_open_failure@@9@9[edx*4]']
push ['eax']
push ['offset', '$SG92506']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_20]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_pfd_close']
add ['esp,', '4']
jmp ['short', 'loc_18C53']
mov ['ecx,', '[ebp+var_20]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '6']
jnz ['short', 'loc_18C33']
jmp ['short', 'loc_18C53']
mov ['edx,', 'offset', '$SG92511']
test ['edx,', 'edx']
jz ['short', 'loc_18C53']
push ['1EEAh']
push ['offset', '$SG92512']
push ['offset', '$SG92513']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0F8h]']
push ['eax']
call ['_del234']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN15_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_channel_request proc near     
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '90h']
push ['edi']
lea ['edi,', '[ebp+var_90]']
mov ['ecx,', '24h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['[ebp+var_20],', '64h']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_channel_msg']
add ['esp,', '8']
mov ['[ebp+var_24],', 'eax']
cmp ['[ebp+var_24],', '0']
jnz ['short', 'loc_18D19']
jmp ['loc_1937B']
mov ['edx,', '[ebp+var_24]']
cmp ['dword', 'ptr', '[edx+0Ch],', '5']
jnz ['short', 'loc_18D4A']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_24]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
jmp ['loc_1937B']
lea ['edx,', '[ebp+var_14]']
push ['edx']
lea ['eax,', '[ebp+Buf1]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
mov ['[ebp+var_1C],', 'eax']
mov ['eax,', '[ebp+var_24]']
mov ['ecx,', '[eax+14h]']
and ['ecx,', '2']
jz ['short', 'loc_18D7F']
mov ['[ebp+var_1C],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_24]']
cmp ['eax,', '[edx+0FCh]']
jnz ['loc_1933C']
cmp ['[ebp+var_14],', '0Bh']
jnz ['short', 'loc_18DEA']
push ['0Bh']
push ['offset', '$SG92531']
mov ['ecx,', '[ebp+Buf1]']
push ['ecx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_18DEA']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+104h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+104h]']
push ['eax']
push ['offset', '$SG92532']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['[ebp+var_20],', '63h']
jmp ['loc_1933A']
cmp ['[ebp+var_14],', '0Bh']
jnz ['loc_1933A']
push ['0Bh']
push ['offset', '$SG92535']
mov ['edx,', '[ebp+Buf1]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_1933A']
mov ['[ebp+var_2C],', '1']
mov ['[ebp+var_30],', '0']
mov ['[ebp+var_34],', 'offset', '$SG92539']
mov ['[ebp+var_38],', 'offset', '$SG92541']
mov ['[ebp+var_4C],', '0']
mov ['[ebp+var_54],', '0']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[ebp+arg_4]']
add ['ecx,', '[edx+18h]']
mov ['[ebp+var_58],', 'ecx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+18h]']
mov ['[ebp+var_5C],', 'edx']
mov ['eax,', '[ebp+var_58]']
movzx ['ecx,', 'byte', 'ptr', '[eax]']
shl ['ecx,', '18h']
mov ['edx,', '[ebp+var_58]']
movzx ['eax,', 'byte', 'ptr', '[edx+1]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_58]']
movzx ['eax,', 'byte', 'ptr', '[edx+2]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_58]']
movzx ['eax,', 'byte', 'ptr', '[edx+3]']
or ['ecx,', 'eax']
mov ['[ebp+var_60],', 'ecx']
jnz ['short', 'loc_18E91']
mov ['[ebp+var_30],', '0']
jmp ['loc_190A1']
mov ['[ebp+var_64],', '0']
mov ['[ebp+var_68],', '0']
push ['5']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_6C],', 'eax']
cmp ['[ebp+var_6C],', '0']
jl ['loc_18F7D']
mov ['ecx,', '[ebp+var_6C]']
add ['ecx,', '4']
cmp ['ecx,', '[ebp+var_5C]']
jg ['loc_18F7D']
mov ['edx,', '[ebp+var_58]']
add ['edx,', '[ebp+var_6C]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_58]']
add ['ecx,', '[ebp+var_6C]']
movzx ['edx,', 'byte', 'ptr', '[ecx+1]']
shl ['edx,', '10h']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_58]']
add ['ecx,', '[ebp+var_6C]']
movzx ['edx,', 'byte', 'ptr', '[ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_58]']
add ['ecx,', '[ebp+var_6C]']
movzx ['edx,', 'byte', 'ptr', '[ecx+3]']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_6C]']
lea ['edx,', '[ecx+eax+4]']
push ['edx']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_6C],', 'eax']
cmp ['[ebp+var_6C],', '0']
jl ['short', 'loc_18F7D']
mov ['eax,', '[ebp+var_6C]']
add ['eax,', '4']
cmp ['eax,', '[ebp+var_5C]']
jg ['short', 'loc_18F7D']
mov ['ecx,', '[ebp+var_58]']
add ['ecx,', '[ebp+var_6C]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
shl ['edx,', '18h']
mov ['eax,', '[ebp+var_58]']
add ['eax,', '[ebp+var_6C]']
movzx ['ecx,', 'byte', 'ptr', '[eax+1]']
shl ['ecx,', '10h']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_58]']
add ['eax,', '[ebp+var_6C]']
movzx ['ecx,', 'byte', 'ptr', '[eax+2]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_58]']
add ['eax,', '[ebp+var_6C]']
movzx ['ecx,', 'byte', 'ptr', '[eax+3]']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_6C]']
lea ['ecx,', '[eax+edx+4]']
push ['ecx']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_6C],', 'eax']
cmp ['[ebp+var_6C],', '0']
jz ['short', 'loc_18F7D']
mov ['edx,', '[ebp+var_6C]']
cmp ['edx,', '[ebp+var_5C]']
jnz ['short', 'loc_18F7D']
mov ['[ebp+var_64],', '1']
xor ['eax,', 'eax']
jnz ['loc_18E9F']
mov ['ecx,', '[ebp+var_60]']
add ['ecx,', '5']
push ['ecx']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_70],', 'eax']
cmp ['[ebp+var_70],', '0']
jl ['loc_19068']
mov ['edx,', '[ebp+var_70]']
add ['edx,', '4']
cmp ['edx,', '[ebp+var_5C]']
jg ['loc_19068']
mov ['eax,', '[ebp+var_58]']
add ['eax,', '[ebp+var_70]']
movzx ['ecx,', 'byte', 'ptr', '[eax]']
shl ['ecx,', '18h']
mov ['edx,', '[ebp+var_58]']
add ['edx,', '[ebp+var_70]']
movzx ['eax,', 'byte', 'ptr', '[edx+1]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_58]']
add ['edx,', '[ebp+var_70]']
movzx ['eax,', 'byte', 'ptr', '[edx+2]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_58]']
add ['edx,', '[ebp+var_70]']
movzx ['eax,', 'byte', 'ptr', '[edx+3]']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_70]']
lea ['eax,', '[edx+ecx+4]']
push ['eax']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_70],', 'eax']
cmp ['[ebp+var_70],', '0']
jl ['short', 'loc_19068']
mov ['ecx,', '[ebp+var_70]']
add ['ecx,', '4']
cmp ['ecx,', '[ebp+var_5C]']
jg ['short', 'loc_19068']
mov ['edx,', '[ebp+var_58]']
add ['edx,', '[ebp+var_70]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_58]']
add ['ecx,', '[ebp+var_70]']
movzx ['edx,', 'byte', 'ptr', '[ecx+1]']
shl ['edx,', '10h']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_58]']
add ['ecx,', '[ebp+var_70]']
movzx ['edx,', 'byte', 'ptr', '[ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_58]']
add ['ecx,', '[ebp+var_70]']
movzx ['edx,', 'byte', 'ptr', '[ecx+3]']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_70]']
lea ['edx,', '[ecx+eax+4]']
push ['edx']
call ['_toint']
add ['esp,', '4']
mov ['[ebp+var_70],', 'eax']
cmp ['[ebp+var_70],', '0']
jz ['short', 'loc_19068']
mov ['eax,', '[ebp+var_70]']
cmp ['eax,', '[ebp+var_5C]']
jnz ['short', 'loc_19068']
mov ['[ebp+var_68],', '1']
xor ['ecx,', 'ecx']
jnz ['loc_18F85']
cmp ['[ebp+var_64],', '0']
jz ['short', 'loc_19085']
cmp ['[ebp+var_68],', '0']
jnz ['short', 'loc_19085']
mov ['[ebp+var_30],', '1']
jmp ['short', 'loc_190A1']
cmp ['[ebp+var_64],', '0']
jnz ['short', 'loc_1909A']
cmp ['[ebp+var_68],', '0']
jz ['short', 'loc_1909A']
mov ['[ebp+var_30],', '0']
jmp ['short', 'loc_190A1']
mov ['[ebp+var_2C],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+104h],', '80h']
cmp ['[ebp+var_2C],', '0']
jz ['loc_192CB']
cmp ['[ebp+var_30],', '0']
jz ['short', 'loc_190F8']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_74],', 'eax']
mov ['ecx,', '[ebp+var_74]']
push ['ecx']
push ['offset', '$SG92611']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_34],', 'eax']
mov ['edx,', '[ebp+var_74]']
add ['edx,', '80h']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+104h],', 'edx']
jmp ['loc_1928A']
lea ['ecx,', '[ebp+Size]']
push ['ecx']
lea ['edx,', '[ebp+var_7C]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+Size],', '0']
jz ['short', 'loc_19133']
mov ['ecx,', '[ebp+var_7C]']
push ['ecx']
mov ['edx,', '[ebp+Size]']
push ['edx']
push ['offset', '$SG92616']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_34],', 'eax']
xor ['eax,', 'eax']
jz ['short', 'loc_1913C']
jmp ['loc_1928A']
cmp ['[ebp+Size],', '4']
jnz ['short', 'loc_19173']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
push ['offset', '$SG92620']
mov ['edx,', '[ebp+var_7C]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_19173']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+104h],', '96h']
jmp ['loc_1928A']
cmp ['[ebp+Size],', '3']
jnz ['short', 'loc_191AA']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
push ['offset', '$SG92623']
mov ['edx,', '[ebp+var_7C]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_191AA']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+104h],', '88h']
jmp ['loc_1928A']
cmp ['[ebp+Size],', '3']
jnz ['short', 'loc_191E1']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
push ['offset', '$SG92626']
mov ['edx,', '[ebp+var_7C]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_191E1']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+104h],', '84h']
jmp ['loc_1928A']
cmp ['[ebp+Size],', '3']
jnz ['short', 'loc_19215']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
push ['offset', '$SG92629']
mov ['edx,', '[ebp+var_7C]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_19215']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+104h],', '82h']
jmp ['short', 'loc_1928A']
cmp ['[ebp+Size],', '4']
jnz ['short', 'loc_19249']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
push ['offset', '$SG92632']
mov ['edx,', '[ebp+var_7C]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_19249']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+104h],', '8Bh']
jmp ['short', 'loc_1928A']
cmp ['[ebp+Size],', '4']
jnz ['short', 'loc_1927D']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
push ['offset', '$SG92635']
mov ['edx,', '[ebp+var_7C]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_1927D']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+104h],', '8Fh']
jmp ['short', 'loc_1928A']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+104h],', '80h']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
mov ['[ebp+var_54],', 'eax']
lea ['eax,', '[ebp+var_4C]']
push ['eax']
lea ['ecx,', '[ebp+var_40]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_4C],', '0']
jz ['short', 'loc_192CB']
mov ['eax,', '[ebp+var_40]']
push ['eax']
mov ['ecx,', '[ebp+var_4C]']
push ['ecx']
push ['offset', '$SG92638']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_38],', 'eax']
cmp ['[ebp+var_54],', '0']
jz ['short', 'loc_192DD']
mov ['[ebp+var_90],', 'offset', '$SG92639']
jmp ['short', 'loc_192E7']
mov ['[ebp+var_90],', 'offset', '$SG92640']
mov ['edx,', '[ebp+var_38]']
push ['edx']
mov ['eax,', '[ebp+var_90]']
push ['eax']
mov ['ecx,', '[ebp+var_34]']
push ['ecx']
push ['offset', '$SG92641']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '14h']
mov ['eax,', '[ebp+var_34]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_1931D']
mov ['edx,', '[ebp+var_34]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_38]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_19333']
mov ['edx,', '[ebp+var_38]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['[ebp+var_20],', '63h']
jmp ['short', 'loc_19343']
mov ['[ebp+var_20],', '64h']
cmp ['[ebp+var_1C],', '0']
jz ['short', 'loc_1937B']
mov ['eax,', '[ebp+var_20]']
push ['eax']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_28],', 'eax']
mov ['ecx,', '[ebp+var_24]']
mov ['edx,', '[ecx+4]']
push ['edx']
mov ['eax,', '[ebp+var_28]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_28]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN58']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '90h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_global_request proc near      
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_14]']
push ['eax']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
mov ['[ebp+var_1C],', 'eax']
cmp ['[ebp+var_1C],', '0']
jz ['short', 'loc_19481']
push ['52h']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN7_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_channel_open proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '98h']
push ['edi']
lea ['edi,', '[ebp+var_98]']
mov ['ecx,', '26h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['[ebp+Str],', '0']
mov ['[ebp+var_4C],', '0']
lea ['eax,', '[ebp+var_14]']
push ['eax']
lea ['ecx,', '[ebp+Buf1]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
push ['60h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_3C],', 'eax']
mov ['eax,', '[ebp+var_3C]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_40],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_44],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_48],', 'eax']
cmp ['[ebp+var_14],', '3']
jnz ['loc_1967D']
push ['3']
push ['offset', '$SG92694']
mov ['edx,', '[ebp+Buf1]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_1967D']
lea ['eax,', '[ebp+Size]']
push ['eax']
lea ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
push ['1']
mov ['eax,', '[ebp+Size]']
add ['eax,', '1']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Dst],', 'eax']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Dst]']
add ['ecx,', '[ebp+Size]']
mov ['byte', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_34],', 'eax']
mov ['eax,', '[ebp+var_34]']
push ['eax']
mov ['ecx,', '[ebp+Dst]']
push ['ecx']
push ['offset', '$SG92698']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '10h']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+4Ch],', '0']
jnz ['short', 'loc_1960A']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0CCh],', '0']
jnz ['short', 'loc_1960A']
mov ['[ebp+Str],', 'offset', '$SG92700']
jmp ['short', 'loc_1966C']
mov ['edx,', '[ebp+var_34]']
push ['edx']
mov ['eax,', '[ebp+Dst]']
push ['eax']
mov ['ecx,', '[ebp+var_3C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+168h]']
push ['eax']
call ['_x11_init']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_3C]']
mov ['[ecx+4Ch],', 'eax']
mov ['edx,', '[ebp+var_3C]']
mov ['dword', 'ptr', '[edx+0Ch],', '1']
mov ['eax,', '[ebp+var_3C]']
mov ['dword', 'ptr', '[eax+50h],', '1']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0CCh],', '0']
jz ['short', 'loc_19655']
mov ['[ebp+var_4C],', '80h']
push ['offset', '$SG92703']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_198B9']
cmp ['[ebp+var_14],', '0Fh']
jnz ['loc_19859']
push ['0Fh']
push ['offset', '$SG92706']
mov ['edx,', '[ebp+Buf1]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_19859']
lea ['eax,', '[ebp+var_90]']
push ['eax']
lea ['ecx,', '[ebp+var_84]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_84]']
push ['eax']
mov ['ecx,', '[ebp+var_90]']
push ['ecx']
push ['offset', '$SG92711']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_6C],', 'eax']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_74],', 'eax']
lea ['eax,', '[ebp+Size]']
push ['eax']
lea ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_34],', 'eax']
push ['0']
lea ['ecx,', '[ebp+var_74]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+110h]']
push ['eax']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_7C],', 'eax']
mov ['ecx,', '[ebp+var_34]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+var_74]']
push ['eax']
mov ['ecx,', '[ebp+var_6C]']
push ['ecx']
push ['offset', '$SG92713']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '18h']
mov ['eax,', '[ebp+var_6C]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+var_7C],', '0']
jnz ['short', 'loc_19766']
mov ['[ebp+Str],', 'offset', '$SG92716']
jmp ['loc_19857']
mov ['ecx,', '[ebp+var_7C]']
cmp ['dword', 'ptr', '[ecx+14h],', '0']
jz ['short', 'loc_197A3']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+var_7C]']
mov ['eax,', '[edx+14h]']
push ['eax']
call ['_share_got_pkt_from_server']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_3C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_19A17']
mov ['edx,', '[ebp+var_7C]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_3C]']
push ['ecx']
mov ['edx,', '[ebp+var_7C]']
mov ['eax,', '[edx+4]']
push ['eax']
mov ['ecx,', '[ebp+var_7C]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+var_3C]']
add ['eax,', '4Ch']
push ['eax']
call ['_pfd_connect']
add ['esp,', '18h']
mov ['[ebp+var_98],', 'eax']
mov ['ecx,', '[ebp+var_7C]']
mov ['edx,', '[ecx+4]']
push ['edx']
mov ['eax,', '[ebp+var_7C]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
push ['offset', '$SG92720']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '10h']
cmp ['[ebp+var_98],', '0']
jz ['short', 'loc_19836']
mov ['eax,', '[ebp+var_98]']
push ['eax']
push ['offset', '$SG92723']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_98]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['[ebp+Str],', 'offset', '$SG92724']
jmp ['short', 'loc_19857']
push ['offset', '$SG92726']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+var_3C]']
mov ['dword', 'ptr', '[edx+0Ch],', '3']
jmp ['short', 'loc_198B9']
cmp ['[ebp+var_14],', '16h']
jnz ['short', 'loc_198B2']
push ['16h']
push ['offset', '$SG92729']
mov ['eax,', '[ebp+Buf1]']
push ['eax']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_198B2']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+48h],', '0']
jnz ['short', 'loc_19888']
mov ['[ebp+Str],', 'offset', '$SG92731']
jmp ['short', 'loc_198B0']
mov ['edx,', '[ebp+var_3C]']
mov ['dword', 'ptr', '[edx+0Ch],', '2']
mov ['eax,', '[ebp+var_3C]']
mov ['dword', 'ptr', '[eax+54h],', '0']
mov ['ecx,', '[ebp+var_3C]']
mov ['dword', 'ptr', '[ecx+4Ch],', '0']
mov ['edx,', '[ebp+var_3C]']
mov ['dword', 'ptr', '[edx+5Ch],', '0']
jmp ['short', 'loc_198B9']
mov ['[ebp+Str],', 'offset', '$SG92735']
mov ['eax,', '[ebp+var_3C]']
mov ['ecx,', '[ebp+var_40]']
mov ['[eax+4],', 'ecx']
mov ['edx,', '[ebp+var_3C]']
mov ['dword', 'ptr', '[edx+10h],', '0']
cmp ['[ebp+Str],', '0']
jz ['loc_1995B']
push ['5Ch']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_50],', 'eax']
mov ['eax,', '[ebp+var_3C]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_50]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['2']
mov ['eax,', '[ebp+var_50]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+var_50]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['offset', '$SG92737']
mov ['eax,', '[ebp+var_50]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_50]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '$SG92738']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_3C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_19A17']
mov ['eax,', '[ebp+var_3C]']
push ['eax']
call ['_ssh2_channel_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_3C]']
mov ['edx,', '[ebp+var_44]']
mov ['[ecx+2Ch],', 'edx']
mov ['eax,', '[ebp+var_3C]']
mov ['ecx,', '[ebp+var_48]']
mov ['[eax+30h],', 'ecx']
cmp ['[ebp+var_4C],', '0']
jz ['short', 'loc_1999A']
mov ['edx,', '[ebp+var_3C]']
mov ['eax,', '[ebp+var_4C]']
mov ['[edx+3Ch],', 'eax']
mov ['ecx,', '[ebp+var_3C]']
mov ['edx,', '[ebp+var_4C]']
mov ['[ecx+38h],', 'edx']
mov ['eax,', '[ebp+var_3C]']
mov ['ecx,', '[ebp+var_4C]']
mov ['[eax+34h],', 'ecx']
mov ['edx,', '[ebp+var_3C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0F8h]']
push ['ecx']
call ['_add234']
add ['esp,', '8']
push ['5Bh']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_50],', 'eax']
mov ['edx,', '[ebp+var_3C]']
mov ['eax,', '[edx+4]']
push ['eax']
mov ['ecx,', '[ebp+var_50]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['edx,', '[ebp+var_3C]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_50]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['edx,', '[ebp+var_3C]']
mov ['eax,', '[edx+34h]']
push ['eax']
mov ['ecx,', '[ebp+var_50]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['4000h']
mov ['edx,', '[ebp+var_50]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_50]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN30_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '98h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_userauth_banner proc near     
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
push ['22h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_19B68']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '14Ch']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
cmp ['eax,', 'offset', 'off_20000']
jg ['short', 'loc_19B68']
mov ['[ebp+var_8],', '0']
mov ['[ebp+var_14],', '0']
lea ['eax,', '[ebp+var_14]']
push ['eax']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_19B68']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '14Ch']
push ['edx']
call ['_bufchain_add']
add ['esp,', '0Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN8_5']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_setup_x11 proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_19BFE']
push ['4']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+arg_8],', 'eax']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_14],', 'ecx']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_19C2A']
cmp ['[ebp+var_14],', '20D5h']
jz ['loc_19CD8']
jmp ['loc_19D25']
push ['offset', '$SG92820']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
push ['offset', '_ssh2_setup_x11']
push ['offset', '$SG92821']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
push ['0']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh2_pkt_addbool']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+164h]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+164h]']
mov ['edx,', '[ecx+10h]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+160h]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '20D5h']
jmp ['short', 'loc_19D31']
xor ['edx,', 'edx']
jnz ['short', 'loc_19CCD']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_19D25']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '63h']
jnz ['short', 'loc_19D0E']
push ['offset', '$SG92828']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+4Ch],', '1']
jmp ['short', 'loc_19D25']
push ['offset', '$SG92830']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_setup_agent proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_19D8E']
push ['4']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+arg_8],', 'eax']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_14],', 'ecx']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_19DB6']
cmp ['[ebp+var_14],', '20F5h']
jz ['short', 'loc_19E0B']
jmp ['loc_19E58']
push ['offset', '$SG92853']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
push ['offset', '_ssh2_setup_agent']
push ['offset', '$SG92854']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['dword', 'ptr', '[eax],', '20F5h']
jmp ['short', 'loc_19E64']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_19E00']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_19E58']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '63h']
jnz ['short', 'loc_19E41']
push ['offset', '$SG92861']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+48h],', '1']
jmp ['short', 'loc_19E58']
push ['offset', '$SG92863']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_setup_pty proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_19EBE']
push ['4']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+arg_8],', 'eax']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_14],', 'ecx']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_19EEA']
cmp ['[ebp+var_14],', '2126h']
jz ['loc_1A070']
jmp ['loc_1A0E2']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0E8h],', '9600h']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0ECh],', '9600h']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0ECh']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '0E8h']
push ['edx']
push ['offset', '$SG92886']
push ['2Fh']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
call ['_sscanf']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_C]']
push ['edx']
push ['offset', '_ssh2_setup_pty']
push ['offset', '$SG92887']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
push ['2Eh']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0F0h]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0F4h]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['0']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['0']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
push ['edx']
push ['offset', '_ssh2_send_ttymode']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_parse_ttymodes']
add ['esp,', '0Ch']
push ['80h']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['81h']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E8h]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['1']
push ['offset', '$SG92889']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_addstring_data']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+118h],', '2']
mov ['ecx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[ecx],', '2126h']
jmp ['short', 'loc_1A0EE']
xor ['edx,', 'edx']
jnz ['short', 'loc_1A065']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_1A0E2']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '63h']
jnz ['short', 'loc_1A0B7']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E8h]']
push ['ecx']
push ['offset', '$SG92896']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_logeventf']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+128h],', '1']
jmp ['short', 'loc_1A0E2']
push ['offset', '$SG92898']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0DCh],', '1']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0E0h],', '1']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_parse_ttymodes proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_8]']
push ['eax']
push ['0']
push ['30h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_str_strs']
add ['esp,', '10h']
mov ['[ebp+var_10],', 'eax']
jmp ['short', 'loc_1A15E']
lea ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
push ['30h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_str_strs']
add ['esp,', '10h']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_1A1DA']
mov ['ecx,', '[ebp+var_10]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '41h']
jnz ['short', 'loc_1A1B7']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_get_ttymode']
add ['esp,', '8']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_1A1B5']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_10]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
call ['[ebp+arg_4]']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_10]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_1A1D5']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '1']
mov ['esi,', 'esp']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['[ebp+arg_4]']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_1A13F']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11_3']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_send_ttymode proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['[ebp+var_C],', '0']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', 'ds:_ssh_ttymodes[ecx]']
push ['edx']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1A26B']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
jmp ['short', 'loc_1A243']
cmp ['[ebp+var_8],', '35h']
jnz ['short', 'loc_1A273']
jmp ['short', 'loc_1A2DA']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', 'ds:dword_62C4[edx]']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_1A290']
cmp ['[ebp+var_10],', '1']
jz ['short', 'loc_1A2A1']
jmp ['short', 'loc_1A2B0']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
call ['_ssh_tty_parse_specchar']
add ['esp,', '4']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_1A2B0']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
call ['_ssh_tty_parse_boolean']
add ['esp,', '4']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
movzx ['ecx,', 'ds:byte_62C0[eax]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_tty_parse_specchar proc near       
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_1A337']
mov ['[ebp+var_C],', '0']
lea ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ctrlparse']
add ['esp,', '8']
movsx ['ecx,', 'al']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+var_C],', '0']
jnz ['short', 'loc_1A335']
mov ['edx,', '[ebp+arg_0]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_1A33E']
mov ['[ebp+var_4],', '0FFh']
mov ['eax,', '[ebp+var_4]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN8_6']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_tty_parse_boolean proc near        
push ['ebp']
mov ['ebp,', 'esp']
push ['offset', '$SG87386']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_stricmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1A3DF']
push ['offset', '$SG87387']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_stricmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1A3DF']
push ['offset', '$SG87388']
mov ['edx,', '[ebp+Str1]']
push ['edx']
call ['_stricmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1A3DF']
push ['offset', '$SG87389']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_stricmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1A3E8']
mov ['eax,', '1']
jmp ['short', 'loc_1A454']
jmp ['short', 'loc_1A454']
push ['offset', '$SG87393']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_stricmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1A43C']
push ['offset', '$SG87394']
mov ['edx,', '[ebp+Str1]']
push ['edx']
call ['_stricmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1A43C']
push ['offset', '$SG87395']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_stricmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1A43C']
push ['offset', '$SG87396']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_stricmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1A442']
xor ['eax,', 'eax']
jmp ['short', 'loc_1A454']
jmp ['short', 'loc_1A454']
mov ['edx,', '[ebp+Str1]']
push ['edx']
call ['_atoi']
add ['esp,', '4']
neg ['eax']
sbb ['eax,', 'eax']
neg ['eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh2_setup_env proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+Str],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_1A4BA']
push ['10h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+arg_8],', 'eax']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_24],', 'ecx']
cmp ['[ebp+var_24],', '0']
jz ['short', 'loc_1A4E6']
cmp ['[ebp+var_24],', '2162h']
jz ['loc_1A5F6']
jmp ['$out$92943']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+4],', '0']
lea ['eax,', '[ebp+Str]']
push ['eax']
push ['0']
push ['31h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_str_strs']
add ['esp,', '10h']
mov ['[ebp+var_20],', 'eax']
jmp ['short', 'loc_1A52E']
lea ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['31h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_str_strs']
add ['esp,', '10h']
mov ['[ebp+var_20],', 'eax']
cmp ['[ebp+var_20],', '0']
jz ['short', 'loc_1A59B']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
push ['offset', '_ssh2_setup_env']
push ['offset', '$SG92931']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['eax,', '[ebp+var_20]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+4]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_C]']
mov ['[eax+4],', 'edx']
jmp ['loc_1A50F']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jz ['short', 'loc_1A5BC']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+4]']
push ['eax']
push ['offset', '$SG92933']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+4],', '0']
jz ['$out$92943']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+0Ch],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+4]']
mov ['[ecx+8],', 'eax']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+8],', '0']
jle ['short', 'loc_1A62E']
mov ['edx,', '[ebp+var_10]']
mov ['dword', 'ptr', '[edx],', '2162h']
jmp ['loc_1A6C3']
xor ['eax,', 'eax']
jnz ['short', 'loc_1A5E8']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_1A605']
jmp ['$out$92943']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+8],', '63h']
jnz ['short', 'loc_1A61D']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+0Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+0Ch],', 'eax']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+8]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+8],', 'eax']
jmp ['short', 'loc_1A5DF']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[edx+0Ch]']
cmp ['ecx,', '[eax+4]']
jnz ['short', 'loc_1A655']
push ['offset', '$SG92946']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
jmp ['short', '$out$92943']
mov ['ecx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0']
jnz ['short', 'loc_1A688']
push ['offset', '$SG92949']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
push ['offset', '$SG92950']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_c_write_str']
add ['esp,', '8']
jmp ['short', '$out$92943']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[edx+4]']
sub ['ecx,', '[eax+0Ch]']
push ['ecx']
push ['offset', '$SG92952']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
push ['offset', '$SG92953']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN26_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_authconn proc near            
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_do_ssh2_authconn']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh2_response_authconn proc near       
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_1A747']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_do_ssh2_authconn']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh2_msg_unexpected proc near          
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+Str],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+15Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+158h]']
push ['edx']
call ['_ssh2_pkt_type']
add ['esp,', '0Ch']
push ['eax']
push ['offset', '$SG93891']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+Str],', 'eax']
push ['0']
push ['2']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_disconnect']
add ['esp,', '14h']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_timer     proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+118h],', '4']
jnz ['short', 'loc_1A7E7']
jmp ['short', 'loc_1A83A']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+668h],', '0']
jnz ['short', 'loc_1A83A']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+0C4h],', '0']
jnz ['short', 'loc_1A83A']
push ['18h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1A83A']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+66Ch]']
jnz ['short', 'loc_1A83A']
push ['0']
push ['0FFFFFFFFh']
push ['offset', '$SG93924']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_do_ssh2_transport']
add ['esp,', '10h']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_init       proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['680h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_conf_copy']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8]']
mov ['[ecx+21Ch],', 'eax']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_cache_conf_values']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+16Ch],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+10h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+54h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+58h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+5Ch],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+60h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+68h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+64h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+6Ch],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+70h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+78h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+74h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+7Ch],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+80h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+88h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+84h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+8Ch],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+90h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+0C0h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+94h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+98h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+104h],', '0FFFFFFFFh']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+108h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+10Ch],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+118h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+11Ch],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+120h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+14h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+18h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+13Ch],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+140h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+144h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+148h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+158h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+15Ch],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+160h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+164h],', '0']
push ['offset', '_x11_authcmp']
call ['_newtree234']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8]']
mov ['[ecx+168h],', 'eax']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+3Ch],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+180h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+184h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+188h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+18Ch],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+190h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+194h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+198h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+1A8h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+19Ch],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+1A0h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+1A4h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+4],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+8],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+0FCh],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+178h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+17Ch],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+12Ch],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+134h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+130h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+138h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+648h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+644h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+674h],', '0']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '238h']
push ['edx']
call ['_bufchain_init']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+234h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+224h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+124h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+128h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+0C4h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+4Ch],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+0CCh],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+0C8h],', '0']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+var_8]']
mov ['[edx],', 'eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_0]']
mov ['[ecx+0E4h],', 'edx']
push ['6Eh']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
mov ['[edx+0F0h],', 'eax']
push ['6Fh']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
mov ['[edx+0F4h],', 'eax']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+0F8h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+110h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+114h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+0D8h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+0E0h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+0DCh],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+170h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+174h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+148h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+210h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+20Ch],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+654h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+660h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+65Ch],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+658h],', '0']
push ['19h']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
call ['_parse_blocksize']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['[edx+664h],', 'eax']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+668h],', '0']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+67Ch],', '0']
call ['_random_ref']
mov ['edx,', '[ebp+arg_1C]']
push ['edx']
mov ['eax,', '[ebp+arg_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_connect_to_host']
add ['esp,', '18h']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_1AD8B']
call ['_random_unref']
mov ['eax,', '[ebp+var_4]']
jmp ['short', 'loc_1AD8D']
xor ['eax,', 'eax']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_connect_to_host proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+Str],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
push ['9']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['edx,', '[ebp+var_C]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['loc_1AE8B']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_dupstr']
add ['esp,', '4']
mov ['[ebp+var_18],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0D4h],', '16h']
push ['3Ah']
mov ['eax,', '[ebp+var_18]']
push ['eax']
call ['_host_strrchr']
add ['esp,', '8']
mov ['[ebp+Str],', 'eax']
cmp ['[ebp+Str],', '0']
jz ['short', 'loc_1AE68']
push ['3Ah']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
call ['_host_strchr']
add ['esp,', '8']
cmp ['[ebp+Str],', 'eax']
jnz ['short', 'loc_1AE68']
mov ['edx,', '[ebp+Str]']
mov ['byte', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+Str]']
add ['eax,', '1']
mov ['[ebp+Str],', 'eax']
mov ['ecx,', '[ebp+Str]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_1AE68']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_atoi']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0D4h],', 'eax']
mov ['edx,', '[ebp+var_18]']
push ['edx']
call ['_host_strduptrim']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0D0h],', 'eax']
mov ['edx,', '[ebp+var_18]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_1AEB9']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_host_strduptrim']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0D0h],', 'eax']
cmp ['[ebp+arg_8],', '0']
jge ['short', 'loc_1AEAD']
mov ['[ebp+arg_8],', '16h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_8]']
mov ['[edx+0D4h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx],', 'offset', '?fn_table@?1??connect_to_host@@9@9']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0CCh],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0C8h],', '1']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '0CCh']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0D4h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0D0h]']
push ['edx']
call ['_ssh_connection_sharing_init']
add ['esp,', '14h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0C8h],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10h],', '0']
jz ['short', 'loc_1AF69']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0C4h],', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+218h],', 'offset', '_do_ssh_connection_init']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+678h],', '0']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_C]']
mov ['[edx],', 'eax']
jmp ['loc_1B0B9']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+218h],', 'offset', '_do_ssh_init']
push ['3']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '1']
jnz ['short', 'loc_1AF9C']
mov ['[ebp+var_20],', 'offset', '$SG89867']
jmp ['short', 'loc_1AFB8']
cmp ['[ebp+var_10],', '2']
jnz ['short', 'loc_1AFAB']
mov ['[ebp+var_24],', 'offset', '$SG89868']
jmp ['short', 'loc_1AFB2']
mov ['[ebp+var_24],', 'offset', '$SG89869']
mov ['eax,', '[ebp+var_24]']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['offset', '$SG89870']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_name_lookup']
add ['esp,', '14h']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_sk_addr_error']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_1B01F']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_sk_addr_free']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
jmp ['loc_1B140']
mov ['eax,', '[ebp+arg_C]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+678h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
mov ['eax,', '[ebp+arg_14]']
push ['eax']
mov ['ecx,', '[ebp+arg_10]']
push ['ecx']
push ['1']
push ['0']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_new_connection']
add ['esp,', '24h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10h],', 'eax']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+1Ch]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_1B0B9']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_notify_remote_exit']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
jmp ['loc_1B140']
push ['1Fh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '0']
jnz ['short', 'loc_1B0E3']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+16Ch],', '1']
cmp ['[ebp+var_14],', '3']
jnz ['short', 'loc_1B115']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0C4h],', '0']
jnz ['short', 'loc_1B115']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+16Ch],', '2']
push ['0']
push ['offset', '$SG89880']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_send_verstring']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_C]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['short', 'loc_1B13E']
mov ['ecx,', '[ebp+arg_C]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_C]']
mov ['[ecx],', 'eax']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_send_verstring proc near           
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+Size],', '0CCCCCCCCh']
mov ['[ebp+Str],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+16Ch],', '2']
jnz ['short', 'loc_1B19A']
push ['offset', '_sshver']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
push ['offset', '$SG89413']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+Str],', 'eax']
jmp ['short', 'loc_1B203']
push ['offset', '$SG89416']
mov ['edx,', '[ebp+Str1]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1B1C6']
push ['0B32h']
push ['offset', '$SG89417']
push ['offset', '$SG89418']
call ['__wassert']
add ['esp,', '0Ch']
push ['offset', '$SG89419']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
call ['_ssh_versioncmp']
add ['esp,', '8']
test ['eax,', 'eax']
jg ['short', 'loc_1B1E3']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+var_C],', 'edx']
jmp ['short', 'loc_1B1EA']
mov ['[ebp+var_C],', 'offset', '$SG89420']
push ['offset', '_sshver']
mov ['eax,', '[ebp+var_C]']
push ['eax']
push ['offset', '$SG89421']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+Str],', 'eax']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '[ebp+Str]']
push ['eax']
call ['_ssh_fix_verstring']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+16Ch],', '2']
jnz ['short', 'loc_1B276']
push ['offset', '$SG89424']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strcspn']
add ['esp,', '8']
mov ['[ebp+Size],', 'eax']
push ['1']
mov ['ecx,', '[ebp+Size]']
add ['ecx,', '1']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
mov ['eax,', '[ebp+Size]']
mov ['byte', 'ptr', '[edx+eax],', '0']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89427']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strcspn']
add ['esp,', '8']
push ['eax']
push ['offset', '$SG89428']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '10h']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_s_write']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_versioncmp proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+EndPtr],', 'eax']
mov ['[ebp+var_4],', 'eax']
push ['0Ah']
lea ['eax,', '[ebp+EndPtr]']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strtoul']
add ['esp,', '0Ch']
mov ['[ebp+var_1C],', 'eax']
push ['0Ah']
lea ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_strtoul']
add ['esp,', '0Ch']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
cmp ['ecx,', '[ebp+var_20]']
jz ['short', 'loc_1B33D']
mov ['edx,', '[ebp+var_1C]']
cmp ['edx,', '[ebp+var_20]']
sbb ['eax,', 'eax']
and ['eax,', '0FFFFFFFEh']
add ['eax,', '1']
jmp ['short', 'loc_1B3A9']
mov ['eax,', '[ebp+EndPtr]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '2Eh']
jnz ['short', 'loc_1B351']
mov ['edx,', '[ebp+EndPtr]']
add ['edx,', '1']
mov ['[ebp+EndPtr],', 'edx']
mov ['eax,', '[ebp+var_14]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '2Eh']
jnz ['short', 'loc_1B365']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '1']
mov ['[ebp+var_14],', 'edx']
push ['0Ah']
lea ['eax,', '[ebp+EndPtr]']
push ['eax']
mov ['ecx,', '[ebp+EndPtr]']
push ['ecx']
call ['_strtoul']
add ['esp,', '0Ch']
mov ['[ebp+var_1C],', 'eax']
push ['0Ah']
lea ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+var_14]']
push ['eax']
call ['_strtoul']
add ['esp,', '0Ch']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
cmp ['ecx,', '[ebp+var_20]']
jz ['short', 'loc_1B3A7']
mov ['edx,', '[ebp+var_1C]']
cmp ['edx,', '[ebp+var_20]']
sbb ['eax,', 'eax']
and ['eax,', '0FFFFFFFEh']
add ['eax,', '1']
jmp ['short', 'loc_1B3A9']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN10_7']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_fix_verstring proc near            
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_1B41B']
mov ['edx,', '[ebp+arg_0]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '2Dh']
jz ['short', 'loc_1B41B']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '1']
mov ['[ebp+arg_0],', 'ecx']
jmp ['short', 'loc_1B3FB']
mov ['edx,', '[ebp+arg_0]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '2Dh']
jz ['short', 'loc_1B43D']
push ['0B17h']
push ['offset', '$SG89396']
push ['offset', '$SG89397']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '1']
mov ['[ebp+arg_0],', 'edx']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_1B477']
mov ['edx,', '[ebp+arg_0]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '2Dh']
jz ['short', 'loc_1B466']
mov ['ecx,', '[ebp+arg_0]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '20h']
jnz ['short', 'loc_1B46C']
mov ['eax,', '[ebp+arg_0]']
mov ['byte', 'ptr', '[eax],', '5Fh']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '1']
mov ['[ebp+arg_0],', 'ecx']
jmp ['short', 'loc_1B446']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_do_ssh_init    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+Size],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+198h],', '0']
jnz ['short', 'loc_1B4D8']
push ['28h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_10]']
mov ['[ecx+198h],', 'edx']
mov ['eax,', '[ebp+var_10]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+198h]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '0B67h']
jg ['short', 'loc_1B51C']
cmp ['[ebp+var_14],', '0B67h']
jz ['loc_1B5B5']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_1B53B']
cmp ['[ebp+var_14],', '0B62h']
jz ['short', 'loc_1B591']
jmp ['loc_1BA15']
cmp ['[ebp+var_14],', '0B68h']
jz ['loc_1B5CE']
cmp ['[ebp+var_14],', '0B7Eh']
jz ['loc_1B709']
jmp ['loc_1BA15']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0']
jmp ['short', 'loc_1B556']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+1Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
movsx ['ecx,', 'ds:?protoname@?1??do_ssh_init@@9@9[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_1B597']
movsx ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1Ch]']
movsx ['eax,', 'ds:?protoname@?1??do_ssh_init@@9@9[ecx]']
cmp ['edx,', 'eax']
jz ['short', 'loc_1B57E']
jmp ['short', '$no$89464']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0B62h']
mov ['eax,', '1']
jmp ['loc_1BA20']
xor ['edx,', 'edx']
jnz ['short', 'loc_1B57E']
jmp ['short', 'loc_1B547']
jmp ['short', 'loc_1B5D7']
movzx ['eax,', '[ebp+arg_4]']
cmp ['eax,', '0Ah']
jz ['short', 'loc_1B5BB']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0B67h']
mov ['eax,', '1']
jmp ['loc_1BA20']
xor ['edx,', 'edx']
jnz ['short', 'loc_1B5A2']
jmp ['short', '$no$89464']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0B68h']
mov ['eax,', '1']
jmp ['loc_1BA20']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1B5BB']
jmp ['loc_1B53B']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+18h],', '15h']
push ['1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+14h],', 'eax']
push ['offset', '?protoname@?1??do_ssh_init@@9@9']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '?protoname@?1??do_ssh_init@@9@9']
call ['_strlen']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+1Ch],', '0']
mov ['ecx,', '1']
test ['ecx,', 'ecx']
jz ['loc_1B712']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+18h]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
cmp ['[ecx+4],', 'eax']
jl ['short', 'loc_1B674']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+18h]']
add ['eax,', '10h']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+18h],', 'eax']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+18h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
mov ['cl,', '[ebp+arg_4]']
mov ['[eax+edx],', 'cl']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+1Ch],', '0']
jl ['short', 'loc_1B6EB']
movzx ['eax,', '[ebp+arg_4]']
cmp ['eax,', '2Dh']
jnz ['short', 'loc_1B6C1']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+1Ch]']
mov ['eax,', '[ebp+var_4]']
mov ['byte', 'ptr', '[eax+edx+8],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0FFFFFFFFh']
jmp ['short', 'loc_1B6E9']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+1Ch],', '9']
jnb ['short', 'loc_1B6E9']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1Ch]']
mov ['edx,', '[ebp+var_4]']
mov ['al,', '[ebp+arg_4]']
mov ['[edx+ecx+8],', 'al']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+1Ch]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+1Ch],', 'edx']
jmp ['short', 'loc_1B6F6']
movzx ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '0Ah']
jnz ['short', 'loc_1B6F6']
jmp ['short', 'loc_1B712']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0B7Eh']
mov ['eax,', '1']
jmp ['loc_1BA20']
xor ['eax,', 'eax']
jnz ['short', 'loc_1B6F6']
jmp ['loc_1B629']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+48h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+1F0h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
mov ['byte', 'ptr', '[ecx+eax],', '0']
push ['offset', '$SG89499']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
call ['_strcspn']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
mov ['byte', 'ptr', '[eax+edx],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
push ['offset', '$SG89500']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_detect_bugs']
add ['esp,', '8']
push ['offset', '$SG89501']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '8']
push ['eax']
call ['_ssh_versioncmp']
add ['esp,', '8']
xor ['ecx,', 'ecx']
test ['eax,', 'eax']
setl ['cl']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+20h],', 'ecx']
push ['offset', '$SG89502']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '8']
push ['eax']
call ['_ssh_versioncmp']
add ['esp,', '8']
xor ['ecx,', 'ecx']
test ['eax,', 'eax']
setnl ['cl']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+24h],', 'ecx']
push ['1Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1B813']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+20h],', '0']
jnz ['short', 'loc_1B813']
push ['offset', '$SG89504']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1BA20']
xor ['edx,', 'edx']
jnz ['short', 'loc_1B7FF']
push ['1Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '3']
jnz ['short', 'loc_1B863']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+24h],', '0']
jnz ['short', 'loc_1B863']
push ['offset', '$SG89509']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1BA20']
xor ['edx,', 'edx']
jnz ['short', 'loc_1B84F']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+24h],', '0']
jz ['short', 'loc_1B89D']
push ['1Fh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jge ['short', 'loc_1B88E']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+20h],', '0']
jnz ['short', 'loc_1B89D']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+16Ch],', '2']
jmp ['short', 'loc_1B8AA']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+16Ch],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+16Ch]']
push ['ecx']
push ['offset', '$SG89516']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
push ['1Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '3']
jz ['short', 'loc_1B8F6']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '8']
push ['edx']
push ['offset', '?protoname@?1??do_ssh_init@@9@9']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_send_verstring']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '2']
jnz ['short', 'loc_1B97F']
push ['offset', '$SG89520']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
call ['_strcspn']
add ['esp,', '8']
mov ['[ebp+Size],', 'eax']
push ['1']
mov ['ecx,', '[ebp+Size]']
add ['ecx,', '1']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+8],', 'eax']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[ebp+Size]']
mov ['byte', 'ptr', '[eax+ecx],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+210h],', 'offset', '_ssh2_protocol']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_protocol_setup']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+214h],', 'offset', '_ssh2_rdpkt']
jmp ['short', 'loc_1B9A5']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+210h],', 'offset', '_ssh1_protocol']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh1_protocol_setup']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+214h],', 'offset', '_ssh1_rdpkt']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+16Ch],', '2']
jnz ['short', 'loc_1B9C3']
push ['0']
push ['0FFFFFFFFh']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_do_ssh2_transport']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_update_specials_menu']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+118h],', '1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '_ssh_backend']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_pinger_new']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+654h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_rdpkt     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+Size],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+Src],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '1ACh']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '184h']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+184h]']
mov ['[ebp+var_24],', 'eax']
cmp ['[ebp+var_24],', '0']
jz ['short', 'loc_1BAA3']
cmp ['[ebp+var_24],', '511h']
jz ['short', 'loc_1BB0C']
cmp ['[ebp+var_24],', '529h']
jz ['loc_1BC40']
jmp ['loc_1BFB5']
call ['_ssh_new_packet']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+24h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+24h]']
mov ['dword', 'ptr', '[eax+8],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['dword', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0']
jmp ['short', 'loc_1BAEB']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+1Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+1Ch],', '4']
jge ['short', 'loc_1BB45']
mov ['eax,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[eax],', '0']
jnz ['short', 'loc_1BB12']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '511h']
xor ['eax,', 'eax']
jmp ['loc_1BFC4']
xor ['edx,', 'edx']
jnz ['short', 'loc_1BAFC']
jmp ['short', 'loc_1BAF4']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax]']
shl ['ecx,', '8']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
movzx ['edx,', 'byte', 'ptr', '[eax]']
add ['ecx,', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['[eax],', 'ecx']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_4]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_8]']
mov ['[eax],', 'edx']
jmp ['short', 'loc_1BADC']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx]']
and ['edx,', '80000007h']
jns ['short', 'loc_1BB57']
dec ['edx']
or ['edx,', '0FFFFFFF8h']
inc ['edx']
mov ['eax,', '8']
sub ['eax,', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_4]']
add ['eax,', '[ecx+4]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+8],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax]']
sub ['ecx,', '5']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+24h]']
mov ['[eax],', 'ecx']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+8],', '0']
jge ['short', 'loc_1BBCB']
push ['offset', '$SG88380']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
call ['_ssh_free_packet']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1BFC4']
xor ['eax,', 'eax']
jnz ['short', 'loc_1BBB7']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
mov ['[edx+1Ch],', 'ecx']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['[edx+10h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
mov ['[eax+0Ch],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+10h]']
mov ['[edx+18h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0']
jle ['loc_1BCC3']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
mov ['[edx+20h],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[edx],', '0']
jnz ['short', 'loc_1BC46']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '529h']
xor ['eax,', 'eax']
jmp ['loc_1BFC4']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1BC30']
jmp ['short', 'loc_1BC28']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[edx+20h]']
cmp ['ecx,', '[eax]']
jle ['short', 'loc_1BC5E']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax]']
mov ['[edx+20h],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_4]']
add ['eax,', '[ecx+20h]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+20h]']
mov ['eax,', '[ebp+arg_8]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_4]']
add ['edx,', '[eax+20h]']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+18h],', 'edx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+0Ch]']
sub ['ecx,', '[eax+20h]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0Ch],', 'ecx']
jmp ['loc_1BC0F']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+54h],', '0']
jz ['short', 'loc_1BD2F']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['edx,', '[ecx+10h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+5Ch]']
push ['ecx']
call ['_detect_attack']
add ['esp,', '10h']
test ['eax,', 'eax']
jz ['short', 'loc_1BD2F']
push ['offset', '$SG88401']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
call ['_ssh_free_packet']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1BFC4']
xor ['eax,', 'eax']
jnz ['short', 'loc_1BD1B']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+54h],', '0']
jz ['short', 'loc_1BD67']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['eax,', '[edx+10h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+58h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+54h]']
mov ['edx,', '[ecx+10h]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
sub ['ecx,', '4']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+24h]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
call ['_crc32_compute']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+10h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['edx,', '[ecx+10h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
movzx ['edx,', 'byte', 'ptr', '[edx+ecx-4]']
shl ['edx,', '18h']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['eax,', '[ecx+10h]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+8]']
movzx ['eax,', 'byte', 'ptr', '[eax+ecx-3]']
shl ['eax,', '10h']
or ['edx,', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+24h]']
mov ['ecx,', '[eax+10h]']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+8]']
movzx ['ecx,', 'byte', 'ptr', '[ecx+eax-2]']
shl ['ecx,', '8']
or ['edx,', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['eax,', '[ecx+10h]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+8]']
movzx ['eax,', 'byte', 'ptr', '[eax+ecx-1]']
or ['edx,', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+14h],', 'edx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+14h]']
cmp ['ecx,', '[eax+10h]']
jz ['short', 'loc_1BE39']
push ['offset', '$SG88416']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
call ['_ssh_free_packet']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1BFC4']
xor ['eax,', 'eax']
jnz ['short', 'loc_1BE25']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['eax,', '[edx+10h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
lea ['eax,', '[eax+edx+1]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['[edx+14h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+3Ch],', '0']
jz ['loc_1BF76']
lea ['ecx,', '[ebp+Size]']
push ['ecx']
lea ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['edx,', '[ecx]']
add ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['edx,', '[ecx+14h]']
sub ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8Ch]']
push ['ecx']
call ['_zlib_decompress_block']
add ['esp,', '14h']
test ['eax,', 'eax']
jnz ['short', 'loc_1BED6']
push ['offset', '$SG88425']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
call ['_ssh_free_packet']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1BFC4']
xor ['eax,', 'eax']
jnz ['short', 'loc_1BEC2']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
add ['ecx,', '[ebp+Size]']
cmp ['[edx+1Ch],', 'ecx']
jge ['short', 'loc_1BF3F']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
add ['eax,', '[ebp+Size]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['[edx+1Ch],', 'eax']
push ['1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['edx,', '[ecx+1Ch]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['edx,', '[ecx+10h]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['[edx+10h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['edx,', '[ecx+10h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
lea ['edx,', '[edx+ecx+1]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['[ecx+14h],', 'edx']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
mov ['eax,', '[edx+14h]']
sub ['eax,', '1']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+Size]']
sub ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['[ecx],', 'edx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+24h]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+24h]']
movzx ['ecx,', 'byte', 'ptr', '[ecx-1]']
mov ['[eax+8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+18h],', '0']
jz ['short', 'loc_1BFA8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh1_log_incoming_packet']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+24h]']
mov ['dword', 'ptr', '[ecx+18h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+24h]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN47']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_log_incoming_packet proc near     
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '58h']
push ['edi']
lea ['edi,', '[ebp+var_58]']
mov ['ecx,', '16h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[eax+18h],', '0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+220h],', '0']
jz ['loc_1C0DA']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '11h']
jz ['short', 'loc_1C074']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '12h']
jz ['short', 'loc_1C074']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+8],', '17h']
jnz ['short', 'loc_1C0DA']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '17h']
jnz ['short', 'loc_1C089']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+18h]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['[ebp+eax+var_3C],', 'edx']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['[ebp+ecx+var_34],', '2']
lea ['edx,', '[ebp+var_54]']
push ['edx']
lea ['eax,', '[ebp+var_48]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_48],', '0']
jz ['short', 'loc_1C0DA']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_54]']
mov ['[ebp+edx+var_38],', 'eax']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
push ['0']
push ['0']
push ['0']
lea ['edx,', '[ebp+var_3C]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_ssh1_pkt_type']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_log_packet']
add ['esp,', '2Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11_4']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '58h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_rdpkt     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '34h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_34]']
mov ['ecx,', '0Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '1D4h']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '188h']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+188h]']
mov ['[ebp+var_30],', 'eax']
cmp ['[ebp+var_30],', '63Ch']
jg ['short', 'loc_1C1F0']
cmp ['[ebp+var_30],', '63Ch']
jz ['loc_1C413']
cmp ['[ebp+var_30],', '0']
jz ['short', 'loc_1C20F']
cmp ['[ebp+var_30],', '62Bh']
jz ['loc_1C31E']
jmp ['loc_1CB68']
cmp ['[ebp+var_30],', '661h']
jz ['loc_1C65D']
cmp ['[ebp+var_30],', '68Dh']
jz ['loc_1C816']
jmp ['loc_1CB68']
call ['_ssh_new_packet']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+20h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['dword', 'ptr', '[eax+8],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['dword', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+64h],', '0']
jz ['short', 'loc_1C24D']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+64h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+1Ch]']
mov ['[eax+18h],', 'ecx']
jmp ['short', 'loc_1C257']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+18h],', '8']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+18h],', '8']
jge ['short', 'loc_1C26A']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+18h],', '8']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+74h],', '0']
jz ['short', 'loc_1C281']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
mov ['edx,', '[ecx+28h]']
mov ['[ebp+var_34],', 'edx']
jmp ['short', 'loc_1C288']
mov ['[ebp+var_34],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_34]']
mov ['[eax+10h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+64h],', '0']
jz ['loc_1C5F9']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+64h]']
mov ['edx,', '[ecx+24h]']
and ['edx,', '1']
jz ['loc_1C5F9']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+74h],', '0']
jz ['loc_1C5F9']
push ['1']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+10h]']
add ['edx,', '9000h']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['[edx+10h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+14h],', '0']
jmp ['short', 'loc_1C2F8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+14h],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+14h]']
cmp ['eax,', '[edx+10h]']
jge ['short', 'loc_1C359']
mov ['ecx,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[ecx],', '0']
jnz ['short', 'loc_1C324']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '62Bh']
xor ['eax,', 'eax']
jmp ['loc_1CB77']
xor ['eax,', 'eax']
jnz ['short', 'loc_1C30E']
jmp ['short', 'loc_1C306']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['eax,', '[ecx+10h]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+14h]']
mov ['dl,', '[edx]']
mov ['[eax+ecx],', 'dl']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_8]']
mov ['[edx],', 'ecx']
jmp ['short', 'loc_1C2E9']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0Ch],', '0']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+7Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
mov ['edx,', '[ecx+14h]']
call ['edx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1Ch]']
shr ['ecx,', '18h']
mov ['[ebp+var_10],', 'cl']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
shr ['eax,', '10h']
mov ['[ebp+var_F],', 'al']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+1Ch]']
shr ['edx,', '8']
mov ['[ebp+var_E],', 'dl']
mov ['eax,', '[ebp+var_4]']
mov ['cl,', '[eax+1Ch]']
mov ['[ebp+var_D],', 'cl']
mov ['esi,', 'esp']
push ['4']
lea ['edx,', '[ebp+var_10]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+74h]']
mov ['ecx,', '[eax+18h]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+14h],', '0']
jmp ['short', 'loc_1C3ED']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+14h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+14h]']
cmp ['edx,', '[ecx+18h]']
jge ['short', 'loc_1C45A']
mov ['eax,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[eax],', '0']
jnz ['short', 'loc_1C419']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '63Ch']
xor ['eax,', 'eax']
jmp ['loc_1CB77']
xor ['edx,', 'edx']
jnz ['short', 'loc_1C403']
jmp ['short', 'loc_1C3FB']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['edx,', '[ebp+var_4]']
mov ['edx,', '[edx+0Ch]']
mov ['esi,', '[ebp+var_4]']
add ['edx,', '[esi+10h]']
mov ['esi,', '[ebp+var_4]']
add ['edx,', '[esi+14h]']
mov ['eax,', '[eax+10h]']
mov ['cl,', '[ecx]']
mov ['[edx+eax],', 'cl']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ecx],', 'eax']
jmp ['short', 'loc_1C3DE']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+18h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx+10h]']
mov ['ecx,', '[ebp+var_4]']
add ['eax,', '[ecx+0Ch]']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+64h]']
mov ['eax,', '[edx+14h]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+18h]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['edx,', '[ecx+10h]']
mov ['eax,', '[ebp+var_4]']
add ['edx,', '[eax+0Ch]']
push ['edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+7Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
mov ['edx,', '[ecx+18h]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ebp+var_4]']
add ['ecx,', '[edx+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+0Ch],', 'ecx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx+10h]']
mov ['ecx,', '[ebp+var_4]']
add ['eax,', '[ecx+0Ch]']
mov ['esi,', 'esp']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+7Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+74h]']
mov ['eax,', '[edx+20h]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_1C56A']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx+10h]']
movzx ['ecx,', 'byte', 'ptr', '[eax]']
shl ['ecx,', '18h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['edx,', '[eax+10h]']
movzx ['eax,', 'byte', 'ptr', '[edx+1]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['edx,', '[eax+10h]']
movzx ['eax,', 'byte', 'ptr', '[edx+2]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['edx,', '[eax+10h]']
movzx ['eax,', 'byte', 'ptr', '[edx+3]']
or ['ecx,', 'eax']
push ['ecx']
call ['_toint']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0Ch]']
sub ['eax,', '4']
mov ['ecx,', '[ebp+var_4]']
cmp ['[ecx],', 'eax']
jnz ['short', 'loc_1C56A']
jmp ['short', 'loc_1C5B8']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0Ch],', '9000h']
jb ['short', 'loc_1C5B3']
push ['offset', '$SG88541']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
push ['edx']
call ['_ssh_free_packet']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0']
xor ['eax,', 'eax']
jmp ['loc_1CB77']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1C59F']
jmp ['loc_1C3D2']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[ebp+var_4]']
add ['eax,', '[ecx+10h]']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+20h]']
mov ['[ecx+1Ch],', 'eax']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+20h]']
mov ['[ecx+10h],', 'eax']
jmp ['loc_1C917']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+18h]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['[edx+10h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+14h],', '0']
jmp ['short', 'loc_1C637']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+14h]']
cmp ['ecx,', '[eax+18h]']
jge ['short', 'loc_1C698']
mov ['edx,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[edx],', '0']
jnz ['short', 'loc_1C663']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '661h']
xor ['eax,', 'eax']
jmp ['loc_1CB77']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1C64D']
jmp ['short', 'loc_1C645']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['ecx,', '[edx+10h]']
mov ['edx,', '[ebp+var_4]']
mov ['edx,', '[edx+14h]']
mov ['al,', '[eax]']
mov ['[ecx+edx],', 'al']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_4]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_8]']
mov ['[eax],', 'edx']
jmp ['short', 'loc_1C628']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+64h],', '0']
jz ['short', 'loc_1C6D0']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+18h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx+10h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+64h]']
mov ['edx,', '[ecx+14h]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['edx,', '[ecx+10h]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['ecx,', '[edx+10h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+1]']
shl ['edx,', '10h']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['ecx,', '[edx+10h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['ecx,', '[edx+10h]']
movzx ['edx,', 'byte', 'ptr', '[ecx+3]']
or ['eax,', 'edx']
push ['eax']
call ['_toint']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx],', '0']
jl ['short', 'loc_1C746']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax],', '9000h']
ja ['short', 'loc_1C746']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx]']
add ['eax,', '4']
mov ['ecx,', '[ebp+var_4]']
cdq
idiv ['dword', 'ptr', '[ecx+18h]']
test ['edx,', 'edx']
jz ['short', 'loc_1C783']
push ['offset', '$SG88574']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
push ['ecx']
call ['_ssh_free_packet']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1CB77']
xor ['eax,', 'eax']
jnz ['short', 'loc_1C76F']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+0Ch],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[ebp+var_4]']
add ['edx,', '[eax+10h]']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+20h]']
mov ['[eax+1Ch],', 'edx']
push ['1']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx+10h]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['[edx+10h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+18h]']
mov ['[eax+14h],', 'edx']
jmp ['short', 'loc_1C7EA']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+14h],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ebp+var_4]']
add ['ecx,', '[edx+10h]']
mov ['eax,', '[ebp+var_4]']
cmp ['[eax+14h],', 'ecx']
jge ['short', 'loc_1C851']
mov ['ecx,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[ecx],', '0']
jnz ['short', 'loc_1C81C']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '68Dh']
xor ['eax,', 'eax']
jmp ['loc_1CB77']
xor ['eax,', 'eax']
jnz ['short', 'loc_1C806']
jmp ['short', 'loc_1C7FE']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['eax,', '[ecx+10h]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+14h]']
mov ['dl,', '[edx]']
mov ['[eax+ecx],', 'dl']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_8]']
mov ['[edx],', 'ecx']
jmp ['short', 'loc_1C7DB']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+64h],', '0']
jz ['short', 'loc_1C895']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+0Ch]']
sub ['eax,', '[edx+18h]']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx+10h]']
mov ['ecx,', '[ebp+var_4]']
add ['eax,', '[ecx+18h]']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+64h]']
mov ['eax,', '[edx+14h]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+74h],', '0']
jz ['short', 'loc_1C917']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx]']
add ['edx,', '4']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['edx,', '[ecx+10h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+74h]']
mov ['ecx,', '[eax+10h]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_1C917']
push ['offset', '$SG88595']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
push ['ecx']
call ['_ssh_free_packet']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1CB77']
xor ['eax,', 'eax']
jnz ['short', 'loc_1C903']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx+10h]']
movzx ['ecx,', 'byte', 'ptr', '[eax+4]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+4],', '4']
jl ['short', 'loc_1C943']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx]']
sub ['eax,', '[edx+4]']
cmp ['eax,', '1']
jge ['short', 'loc_1C980']
push ['offset', '$SG88602']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
push ['eax']
call ['_ssh_free_packet']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1CB77']
xor ['edx,', 'edx']
jnz ['short', 'loc_1C96C']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax]']
sub ['edx,', '[ecx+4]']
sub ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+8],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
add ['edx,', '5']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['[ecx],', 'edx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['[eax+20h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
mov ['[ecx+0Ch],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+1Ch]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+1Ch],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+0Ch]']
sub ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
cmp ['dword', 'ptr', '[ecx],', '0']
jge ['short', 'loc_1CA08']
push ['6B4h']
push ['offset', '$SG88608']
push ['offset', '$SG88609']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+84h],', '0']
jz ['loc_1CADF']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+Size]']
push ['ecx']
lea ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['edx,', '[ecx]']
sub ['edx,', '5']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['edx,', '[ecx+10h]']
add ['edx,', '5']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+84h]']
mov ['ecx,', '[eax+1Ch]']
call ['ecx']
add ['esp,', '14h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_1CADF']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['ecx,', '[ebp+Size]']
add ['ecx,', '5']
cmp ['[eax+1Ch],', 'ecx']
jge ['short', 'loc_1CAA8']
mov ['edx,', '[ebp+Size]']
add ['edx,', '5']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['[ecx+1Ch],', 'edx']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['ecx,', '[edx+20h]']
mov ['[ecx+10h],', 'eax']
mov ['edx,', '[ebp+Size]']
add ['edx,', '5']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
mov ['[ecx],', 'edx']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx+10h]']
add ['eax,', '5']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['ecx,', '[eax+10h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
movzx ['ecx,', 'byte', 'ptr', '[ecx+5]']
mov ['[eax+8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['ecx,', '[eax+10h]']
add ['ecx,', '6']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
mov ['[eax+14h],', 'ecx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[edx]']
sub ['eax,', '6']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+20h]']
cmp ['dword', 'ptr', '[ecx],', '0']
jge ['short', 'loc_1CB3F']
push ['6D3h']
push ['offset', '$SG88618']
push ['offset', '$SG88619']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+18h],', '0']
jz ['short', 'loc_1CB5B']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_log_incoming_packet']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+20h]']
mov ['dword', 'ptr', '[edx+18h],', '0']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+20h]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN82']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '34h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_log_incoming_packet proc near     
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '58h']
push ['edi']
lea ['edi,', '[ebp+var_58]']
mov ['ecx,', '16h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[eax+18h],', '0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+220h],', '0']
jz ['loc_1CCAD']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '5Eh']
jz ['short', 'loc_1CC3B']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '5Fh']
jnz ['short', 'loc_1CCAD']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '5Fh']
jnz ['short', 'loc_1CC5C']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+18h]']
add ['edx,', '4']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['[ebp+eax+var_3C],', 'edx']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['[ebp+ecx+var_34],', '2']
lea ['edx,', '[ebp+var_54]']
push ['edx']
lea ['eax,', '[ebp+var_48]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_48],', '0']
jz ['short', 'loc_1CCAD']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_54]']
mov ['[ebp+edx+var_38],', 'eax']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '0Ch']
push ['edx']
lea ['eax,', '[ebp+var_3C]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+15Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+158h]']
push ['edx']
call ['_ssh2_pkt_type']
add ['esp,', '0Ch']
push ['eax']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
push ['eax']
call ['_log_packet']
add ['esp,', '2Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11_5']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '58h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_detect_bugs proc near              
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+Str],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+Str],', 'eax']
push ['offset', '$SG89307']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strcspn']
add ['esp,', '8']
add ['eax,', '[ebp+Str]']
mov ['[ebp+Str],', 'eax']
mov ['edx,', '[ebp+Str]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['short', 'loc_1CDB3']
mov ['ecx,', '[ebp+Str]']
add ['ecx,', '1']
mov ['[ebp+Str],', 'ecx']
push ['offset', '$SG89309']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strcspn']
add ['esp,', '8']
add ['eax,', '[ebp+Str]']
mov ['[ebp+Str],', 'eax']
mov ['eax,', '[ebp+Str]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_1CDDD']
mov ['edx,', '[ebp+Str]']
add ['edx,', '1']
mov ['[ebp+Str],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+50h],', '0']
push ['97h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_1CED2']
push ['97h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['loc_1CEF8']
push ['offset', '$SG89314']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_1CED2']
push ['offset', '$SG89315']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1CED2']
push ['offset', '$SG89316']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1CED2']
push ['offset', '$SG89317']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1CED2']
push ['offset', '$SG89318']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1CED2']
push ['offset', '$SG89319']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1CED2']
push ['offset', '$SG89320']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1CED2']
push ['offset', '$SG89321']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1CEF8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+50h]']
or ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+50h],', 'edx']
push ['offset', '$SG89322']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['98h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1CF59']
push ['98h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_1CF7F']
push ['offset', '$SG89326']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1CF59']
push ['offset', '$SG89327']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1CF7F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
or ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+50h],', 'ecx']
push ['offset', '$SG89328']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
push ['99h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1CFCB']
push ['99h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_1CFF1']
push ['offset', '$SG89331']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1CFF1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+50h]']
or ['edx,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+50h],', 'edx']
push ['offset', '$SG89332']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['9Ah']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_1D0B2']
push ['9Ah']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['loc_1D0D8']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89335']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['loc_1D0D8']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '$SG89337']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D0B2']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '$SG89338']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D0B2']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89339']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D0B2']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '$SG89340']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D0B2']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '$SG89341']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D0D8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+50h]']
or ['edx,', '2']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+50h],', 'edx']
push ['offset', '$SG89342']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['9Bh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D14E']
push ['9Bh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_1D174']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89345']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D174']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '$SG89347']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D14E']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '$SG89348']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D174']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+50h]']
or ['edx,', '20h']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+50h],', 'edx']
push ['offset', '$SG89349']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['9Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D1FF']
push ['9Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_1D225']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89353']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D1FF']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '$SG89354']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D1FF']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '$SG89355']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D1FF']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89356']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D225']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
or ['eax,', '10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+50h],', 'eax']
push ['offset', '$SG89357']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
push ['9Dh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D271']
push ['9Dh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_1D29A']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '$SG89360']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D29A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
or ['ecx,', '80h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+50h],', 'ecx']
push ['offset', '$SG89361']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
push ['9Eh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_1D357']
push ['9Eh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['loc_1D37D']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '$SG89365']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D357']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89366']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D357']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '$SG89367']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D357']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '$SG89368']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D357']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89369']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D357']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '$SG89370']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D37D']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
or ['ecx,', '40h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+50h],', 'ecx']
push ['offset', '$SG89371']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
push ['9Fh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D3DE']
push ['9Fh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_1D406']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '$SG89375']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D3DE']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89376']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D406']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
or ['eax,', '100h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+50h],', 'eax']
push ['offset', '$SG89377']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
push ['0A0h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D44A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
or ['ecx,', '200h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+50h],', 'ecx']
push ['offset', '$SG89379']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
push ['0A1h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D48E']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+50h]']
or ['edx,', '400h']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+50h],', 'edx']
push ['offset', '$SG89381']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['0A2h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D4EF']
push ['0A2h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_1D518']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
push ['offset', '$SG89385']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D4EF']
mov ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '$SG89386']
call ['_wc_match']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1D518']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
or ['ecx,', '800h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+50h],', 'ecx']
push ['offset', '$SG89387']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_ssh_connection_init proc near       
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1A8h],', '0']
jnz ['short', 'loc_1D575']
push ['20h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_C]']
mov ['[ecx+1A8h],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1A8h]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0BF0h']
jg ['short', 'loc_1D5B9']
cmp ['[ebp+var_10],', '0BF0h']
jz ['loc_1D652']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_1D5D8']
cmp ['[ebp+var_10],', '0BEBh']
jz ['short', 'loc_1D62E']
jmp ['loc_1D96B']
cmp ['[ebp+var_10],', '0BF1h']
jz ['loc_1D66B']
cmp ['[ebp+var_10],', '0C07h']
jz ['loc_1D7A6']
jmp ['loc_1D96B']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0']
jmp ['short', 'loc_1D5F3']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+1Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
movsx ['ecx,', 'ds:?protoname@?1??do_ssh_connection_init@@9@9[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_1D634']
movsx ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1Ch]']
movsx ['eax,', 'ds:?protoname@?1??do_ssh_connection_init@@9@9[ecx]']
cmp ['edx,', 'eax']
jz ['short', 'loc_1D61B']
jmp ['short', '$no$89560']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0BEBh']
mov ['eax,', '1']
jmp ['loc_1D976']
xor ['edx,', 'edx']
jnz ['short', 'loc_1D61B']
jmp ['short', 'loc_1D5E4']
jmp ['short', 'loc_1D674']
movzx ['eax,', '[ebp+arg_4]']
cmp ['eax,', '0Ah']
jz ['short', 'loc_1D658']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0BF0h']
mov ['eax,', '1']
jmp ['loc_1D976']
xor ['edx,', 'edx']
jnz ['short', 'loc_1D63F']
jmp ['short', '$no$89560']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', '0BF1h']
mov ['eax,', '1']
jmp ['loc_1D976']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1D658']
jmp ['loc_1D5D8']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+18h],', '3Bh']
push ['1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+14h],', 'eax']
push ['offset', '?protoname@?1??do_ssh_connection_init@@9@9']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '?protoname@?1??do_ssh_connection_init@@9@9']
call ['_strlen']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+1Ch],', '0']
mov ['ecx,', '1']
test ['ecx,', 'ecx']
jz ['loc_1D7AF']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+18h]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
cmp ['[ecx+4],', 'eax']
jl ['short', 'loc_1D711']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+18h]']
add ['eax,', '10h']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+18h],', 'eax']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+18h]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
mov ['cl,', '[ebp+arg_4]']
mov ['[eax+edx],', 'cl']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+1Ch],', '0']
jl ['short', 'loc_1D788']
movzx ['eax,', '[ebp+arg_4]']
cmp ['eax,', '2Dh']
jnz ['short', 'loc_1D75E']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+1Ch]']
mov ['eax,', '[ebp+var_4]']
mov ['byte', 'ptr', '[eax+edx+8],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0FFFFFFFFh']
jmp ['short', 'loc_1D786']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+1Ch],', '9']
jnb ['short', 'loc_1D786']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1Ch]']
mov ['edx,', '[ebp+var_4]']
mov ['al,', '[ebp+arg_4]']
mov ['[edx+ecx+8],', 'al']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+1Ch]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+1Ch],', 'edx']
jmp ['short', 'loc_1D793']
movzx ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '0Ah']
jnz ['short', 'loc_1D793']
jmp ['short', 'loc_1D7AF']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0C07h']
mov ['eax,', '1']
jmp ['loc_1D976']
xor ['eax,', 'eax']
jnz ['short', 'loc_1D793']
jmp ['loc_1D6C6']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+48h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+204h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
mov ['byte', 'ptr', '[ecx+eax],', '0']
push ['offset', '$SG89595']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
call ['_strcspn']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
mov ['byte', 'ptr', '[eax+edx],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
push ['offset', '$SG89596']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_detect_bugs']
add ['esp,', '8']
push ['offset', '$SG89598']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '8']
push ['eax']
call ['_ssh_versioncmp']
add ['esp,', '8']
test ['eax,', 'eax']
jge ['short', 'loc_1D865']
push ['offset', '$SG89599']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1D976']
xor ['eax,', 'eax']
jnz ['short', 'loc_1D851']
push ['1Fh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1D8AB']
push ['offset', '$SG89604']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1D976']
xor ['edx,', 'edx']
jnz ['short', 'loc_1D897']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+16Ch],', '2']
push ['offset', '$SG89608']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '8']
push ['edx']
push ['offset', '?protoname@?1??do_ssh_connection_init@@9@9']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_send_verstring']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+210h],', 'offset', '_ssh2_bare_connection_protocol']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_bare_connection_protocol_setup']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+214h],', 'offset', '_ssh2_bare_connection_rdpkt']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_update_specials_menu']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+118h],', '1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '_ssh_backend']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_pinger_new']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+654h],', 'eax']
push ['0']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_ssh2_authconn']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_bare_connection_rdpkt proc near   
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '1F8h']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '18Ch']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18Ch]']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_1D9E7']
cmp ['[ebp+var_C],', '6E9h']
jz ['short', 'loc_1DA23']
cmp ['[ebp+var_C],', '700h']
jz ['loc_1DB67']
jmp ['loc_1DC06']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+8],', '0']
jmp ['short', 'loc_1DA02']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+8],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+8],', '4']
jge ['short', 'loc_1DA58']
mov ['eax,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[eax],', '0']
jnz ['short', 'loc_1DA29']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '6E9h']
xor ['eax,', 'eax']
jmp ['loc_1DC15']
xor ['edx,', 'edx']
jnz ['short', 'loc_1DA13']
jmp ['short', 'loc_1DA0B']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
mov ['edx,', '[ebp+var_4]']
mov ['cl,', '[ecx]']
mov ['[edx+eax],', 'cl']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ecx],', 'eax']
jmp ['short', 'loc_1D9F3']
mov ['edx,', '[ebp+var_4]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+var_4]']
movzx ['edx,', 'byte', 'ptr', '[ecx+1]']
shl ['edx,', '10h']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_4]']
movzx ['edx,', 'byte', 'ptr', '[ecx+2]']
shl ['edx,', '8']
or ['eax,', 'edx']
mov ['ecx,', '[ebp+var_4]']
movzx ['edx,', 'byte', 'ptr', '[ecx+3]']
or ['eax,', 'edx']
push ['eax']
call ['_toint']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+4],', '0']
jle ['short', 'loc_1DAA6']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+4],', '9000h']
jb ['short', 'loc_1DAD4']
push ['offset', '$SG88657']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
xor ['eax,', 'eax']
jmp ['loc_1DC15']
xor ['eax,', 'eax']
jnz ['short', 'loc_1DAC0']
call ['_ssh_new_packet']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+10h],', 'eax']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+10h]']
mov ['[edx+10h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
mov ['[ecx+20h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+10h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
mov ['[edx+0Ch],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+8],', '0']
jmp ['short', 'loc_1DB41']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+8],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+8]']
cmp ['edx,', '[ecx+4]']
jge ['short', 'loc_1DBA2']
mov ['eax,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[eax],', '0']
jnz ['short', 'loc_1DB6D']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx],', '700h']
xor ['eax,', 'eax']
jmp ['loc_1DC15']
xor ['edx,', 'edx']
jnz ['short', 'loc_1DB57']
jmp ['short', 'loc_1DB4F']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+10h]']
mov ['edx,', '[eax+10h]']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+8]']
mov ['cl,', '[ecx]']
mov ['[edx+eax],', 'cl']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ecx],', 'eax']
jmp ['short', 'loc_1DB32']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+10h]']
mov ['ecx,', '[eax+10h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+10h]']
movzx ['ecx,', 'byte', 'ptr', '[ecx]']
mov ['[eax+8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+10h]']
mov ['ecx,', '[eax+10h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+10h]']
mov ['[eax+14h],', 'ecx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
sub ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
mov ['[ecx],', 'edx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+18h],', '0']
jz ['short', 'loc_1DBF9']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh2_log_incoming_packet']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+10h]']
mov ['dword', 'ptr', '[ecx+18h],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+10h]']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_protocol_setup proc near          
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_1DC45']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '100h']
jge ['short', 'loc_1DC61']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+ecx*4+244h],', '0']
jmp ['short', 'loc_1DC3C']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+248h],', 'offset', '_ssh1_msg_disconnect']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+2C4h],', 'offset', '_ssh_msg_ignore']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+2D4h],', 'offset', '_ssh1_msg_debug']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_msg_debug proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_14]']
push ['eax']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
push ['offset', '$SG91395']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '10h']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN6_7']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_msg_disconnect proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_14]']
push ['eax']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
push ['offset', '$SG91404']
call ['_dupprintf']
add ['esp,', '0Ch']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN6_8']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_msg_ignore proc near               
push ['ebp']
mov ['ebp,', 'esp']
pop ['ebp']
retn
endp
_ssh1_protocol  proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+118h],', '4']
jnz ['short', 'loc_1DE0B']
jmp ['loc_1DE9D']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1DE4C']
mov ['edx,', '[ebp+arg_C]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+eax*4+244h],', '0']
jz ['short', 'loc_1DE4C']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+edx*4+244h]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_1DE9D']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+20Ch],', '0']
jnz ['short', 'loc_1DE85']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_do_ssh1_login']
add ['esp,', '10h']
test ['eax,', 'eax']
jz ['short', 'loc_1DE83']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+20Ch],', '1']
jmp ['short', 'loc_1DE85']
jmp ['short', 'loc_1DE9D']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_ssh1_connection']
add ['esp,', '10h']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_ssh1_connection proc near           
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '194h']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+194h]']
mov ['[ebp+var_14],', 'edx']
cmp ['[ebp+var_14],', '1682h']
jg ['short', 'loc_1DF27']
cmp ['[ebp+var_14],', '1682h']
jz ['loc_1E435']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_1DF46']
cmp ['[ebp+var_14],', '162Fh']
jz ['loc_1E001']
cmp ['[ebp+var_14],', '1659h']
jz ['loc_1E1FA']
jmp ['loc_1E822']
cmp ['[ebp+var_14],', '1697h']
jz ['loc_1E541']
cmp ['[ebp+var_14],', '16D0h']
jz ['loc_1E773']
jmp ['loc_1E822']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+28Ch],', 'offset', '_ssh1_smsg_stdout_stderr_data']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+28Ch]']
mov ['[ecx+288h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+298h],', 'offset', '_ssh1_msg_channel_open_confirmation']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+29Ch],', 'offset', '_ssh1_msg_channel_open_failure']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+2A8h],', 'offset', '_ssh1_msg_channel_close']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+2A8h]']
mov ['[ecx+2A4h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+2A0h],', 'offset', '_ssh1_msg_channel_data']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+294h],', 'offset', '_ssh1_smsg_exit_status']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_agent_forwarding_permitted']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['loc_1E09B']
push ['offset', '$SG91274']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
push ['0']
push ['1Eh']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_send_packet']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx],', '162Fh']
jmp ['loc_1E82B']
xor ['edx,', 'edx']
jnz ['short', 'loc_1DFF3']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1DFF3']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '0Eh']
jz ['short', 'loc_1E04B']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '0Fh']
jz ['short', 'loc_1E04B']
push ['offset', '$SG91283']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_1E82B']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1E037']
jmp ['short', 'loc_1E09B']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '0Fh']
jnz ['short', 'loc_1E06D']
push ['offset', '$SG91289']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_1E09B']
push ['offset', '$SG91291']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+48h],', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+2C0h],', 'offset', '_ssh1_smsg_agent_open']
push ['90h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_1E294']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
push ['91h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
call ['_x11_setup_display']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+160h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+160h],', '0']
jnz ['short', 'loc_1E115']
push ['offset', '$SG91294']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_1E294']
push ['92h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+168h]']
push ['edx']
call ['_x11_invent_fake_auth']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+164h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+164h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+160h]']
mov ['[eax+1Ch],', 'edx']
push ['offset', '$SG91296']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+44h]']
and ['eax,', '1']
jz ['short', 'loc_1E1BE']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+160h]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+164h]']
mov ['eax,', '[edx+10h]']
push ['eax']
push ['4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+164h]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
push ['4']
push ['22h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '24h']
jmp ['short', 'loc_1E1EC']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+164h]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
push ['4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+164h]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
push ['4']
push ['22h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '1Ch']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '1659h']
jmp ['loc_1E82B']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1E1EC']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1E1EC']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '0Eh']
jz ['short', 'loc_1E244']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '0Fh']
jz ['short', 'loc_1E244']
push ['offset', '$SG91307']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_1E82B']
xor ['eax,', 'eax']
jnz ['short', 'loc_1E230']
jmp ['short', 'loc_1E294']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '0Fh']
jnz ['short', 'loc_1E266']
push ['offset', '$SG91313']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_1E294']
push ['offset', '$SG91315']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+4Ch],', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+2B0h],', 'offset', '_ssh1_smsg_x11_open']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_setup_portfwd']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+2B8h],', 'offset', '_ssh1_msg_port_open']
push ['15h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['loc_1E4E9']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E8h],', '9600h']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0ECh],', '9600h']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '0ECh']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '0E8h']
push ['edx']
push ['offset', '$SG91318']
push ['2Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
call ['_sscanf']
add ['esp,', '10h']
push ['0Ah']
call ['_ssh1_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
push ['2Eh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0F4h]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0F0h]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['0']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['0']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
push ['offset', '_ssh1_send_ttymode']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_parse_ttymodes']
add ['esp,', '0Ch']
push ['0C0h']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0ECh]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['0C1h']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E8h]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['0']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_s_wrpkt']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+118h],', '2']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '1682h']
jmp ['loc_1E82B']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1E427']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1E427']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '0Eh']
jz ['short', 'loc_1E47F']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '0Fh']
jz ['short', 'loc_1E47F']
push ['offset', '$SG91328']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx],', '0']
jmp ['loc_1E82B']
xor ['eax,', 'eax']
jnz ['short', 'loc_1E46B']
jmp ['short', 'loc_1E4E7']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '0Fh']
jnz ['short', 'loc_1E4B5']
push ['offset', '$SG91334']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_c_write_str']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0DCh],', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E0h],', '1']
jmp ['short', 'loc_1E4E7']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0ECh]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E8h]']
push ['edx']
push ['offset', '$SG91336']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+128h],', '1']
jmp ['short', 'loc_1E503']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0DCh],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E0h],', '1']
push ['16h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_1E610']
push ['0']
push ['6']
push ['1']
push ['25h']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_send_packet']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx],', '1697h']
jmp ['loc_1E82B']
xor ['edx,', 'edx']
jnz ['short', 'loc_1E533']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1E533']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '0Eh']
jz ['short', 'loc_1E58B']
mov ['ecx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[ecx+8],', '0Fh']
jz ['short', 'loc_1E58B']
push ['offset', '$SG91347']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_bomb_out']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0']
jmp ['loc_1E82B']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1E577']
jmp ['short', 'loc_1E5A5']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '0Fh']
jnz ['short', 'loc_1E5A5']
push ['offset', '$SG91353']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_c_write_str']
add ['esp,', '8']
push ['offset', '$SG91354']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3Ch],', '1']
call ['_zlib_compress_init']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+88h],', 'eax']
push ['offset', '$SG91355']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
call ['_zlib_decompress_init']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+8Ch],', 'eax']
push ['offset', '$SG91356']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
push ['13h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
push ['29h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1E67B']
push ['14h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1E67B']
push ['14h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+148h],', '1']
mov ['ecx,', '[ebp+var_C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_1E69D']
push ['0']
mov ['eax,', '[ebp+var_C]']
push ['eax']
push ['4']
push ['0Dh']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '14h']
jmp ['short', 'loc_1E6AD']
push ['0']
push ['0Ch']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '0Ch']
push ['offset', '$SG91361']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+118h],', '3']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+11Ch],', '0']
jz ['short', 'loc_1E6FD']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F4h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0F0h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ssh_size']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+120h],', '0']
jz ['short', 'loc_1E717']
push ['0Ch']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_special']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+14h],', '0']
jz ['short', 'loc_1E735']
push ['0']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0D8h],', '1']
push ['offset', '_ssh_channelcmp']
call ['_newtree234']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0F8h],', 'eax']
mov ['edx,', '1']
test ['edx,', 'edx']
jz ['loc_1E822']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '16D0h']
jmp ['loc_1E82B']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_1E765']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1E7C5']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '0Eh']
jnz ['short', 'loc_1E788']
jmp ['short', 'loc_1E7C3']
mov ['eax,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[eax+8],', '0Fh']
jnz ['short', 'loc_1E793']
jmp ['short', 'loc_1E7C3']
mov ['ecx,', '[ebp+arg_C]']
mov ['edx,', '[ecx+8]']
push ['edx']
push ['offset', '$SG91378']
call ['_dupprintf']
add ['esp,', '8']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx],', '0']
jmp ['short', 'loc_1E82B']
xor ['edx,', 'edx']
jnz ['short', 'loc_1E7B4']
jmp ['short', 'loc_1E81D']
cmp ['[ebp+arg_8],', '0']
jle ['short', 'loc_1E81D']
cmp ['[ebp+arg_8],', '200h']
jge ['short', 'loc_1E7DC']
mov ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_18],', 'eax']
jmp ['short', 'loc_1E7E3']
mov ['[ebp+var_18],', '200h']
mov ['ecx,', '[ebp+var_18]']
mov ['[ebp+var_10],', 'ecx']
push ['0']
mov ['edx,', '[ebp+var_10]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['3']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
push ['1']
push ['10h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '20h']
mov ['eax,', '[ebp+arg_4]']
add ['eax,', '[ebp+var_10]']
mov ['[ebp+arg_4],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
sub ['ecx,', '[ebp+var_10]']
mov ['[ebp+arg_8],', 'ecx']
jmp ['short', 'loc_1E7C5']
jmp ['loc_1E758']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx],', '0']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_smsg_stdout_stderr_data proc near 
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1Ch']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_14]']
push ['eax']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_1E89E']
push ['offset', '$SG91063']
call ['_dupprintf']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
jmp ['short', 'loc_1E8F8']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
xor ['ecx,', 'ecx']
cmp ['dword', 'ptr', '[eax+8],', '12h']
setz ['cl']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_from_backend']
add ['esp,', '10h']
mov ['[ebp+var_1C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+17Ch],', '0']
jnz ['short', 'loc_1E8F8']
cmp ['[ebp+var_1C],', '8000h']
jle ['short', 'loc_1E8F8']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+17Ch],', '1']
push ['1']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_throttle_conn']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN8_10']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '1Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_smsg_x11_open proc near           
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
push ['offset', '$SG91073']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
push ['edx']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+4Ch],', '0']
jnz ['short', 'loc_1E9CD']
push ['0']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
push ['1']
push ['16h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '14h']
push ['offset', '$SG91075']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_1EAA0']
push ['60h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_0]']
mov ['[edx],', 'eax']
push ['0FFFFFFFFh']
push ['0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+168h]']
push ['eax']
call ['_x11_init']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+4Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['[edx+4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+10h],', '0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_alloc_channel_id']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+8],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+14h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+18h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0Ch],', '1']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F8h]']
push ['edx']
call ['_add234']
add ['esp,', '8']
push ['0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
push ['eax']
push ['1']
push ['15h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '1Ch']
push ['offset', '$SG91080']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_smsg_agent_open proc near         
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+48h],', '0']
jnz ['short', 'loc_1EAFF']
push ['0']
mov ['edx,', '[ebp+var_8]']
push ['edx']
push ['1']
push ['16h']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_send_packet']
add ['esp,', '14h']
jmp ['loc_1EBB9']
push ['60h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['[ecx],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['[eax+4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_alloc_channel_id']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+8],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+14h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+18h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0Ch],', '2']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+54h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4Ch],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+5Ch],', '0']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F8h]']
push ['edx']
call ['_add234']
add ['esp,', '8']
push ['0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4]']
push ['eax']
push ['1']
push ['15h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '1Ch']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_msg_port_open proc near           
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '50h']
push ['edi']
lea ['edi,', '[ebp+var_50]']
mov ['ecx,', '14h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_2C],', 'eax']
lea ['ecx,', '[ebp+var_34]']
push ['ecx']
lea ['edx,', '[ebp+var_44]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_3C],', 'eax']
mov ['edx,', '[ebp+var_44]']
push ['edx']
mov ['eax,', '[ebp+var_34]']
push ['eax']
push ['offset', '$SG91107']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_14],', 'eax']
mov ['ecx,', '[ebp+var_3C]']
mov ['[ebp+var_1C],', 'ecx']
push ['0']
lea ['edx,', '[ebp+var_20]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+110h]']
push ['ecx']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_28],', 'eax']
cmp ['[ebp+var_28],', '0']
jnz ['short', 'loc_1EC83']
mov ['edx,', '[ebp+var_3C]']
push ['edx']
mov ['eax,', '[ebp+var_14]']
push ['eax']
push ['offset', '$SG91111']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '10h']
push ['0']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
push ['1']
push ['16h']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_send_packet']
add ['esp,', '14h']
jmp ['loc_1EDCF']
push ['60h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_50],', 'eax']
mov ['ecx,', '[ebp+var_50]']
mov ['edx,', '[ebp+arg_0]']
mov ['[ecx],', 'edx']
mov ['eax,', '[ebp+var_3C]']
push ['eax']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
push ['offset', '$SG91116']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logeventf']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_28]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx+24h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_50]']
push ['edx']
mov ['eax,', '[ebp+var_3C]']
push ['eax']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+var_50]']
add ['edx,', '4Ch']
push ['edx']
call ['_pfd_connect']
add ['esp,', '18h']
mov ['[ebp+var_4C],', 'eax']
cmp ['[ebp+var_4C],', '0']
jz ['short', 'loc_1ED33']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
push ['offset', '$SG91119']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_50]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['0']
mov ['ecx,', '[ebp+var_2C]']
push ['ecx']
push ['1']
push ['16h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '14h']
jmp ['loc_1EDCF']
mov ['eax,', '[ebp+var_50]']
mov ['ecx,', '[ebp+var_2C]']
mov ['[eax+4],', 'ecx']
mov ['edx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_alloc_channel_id']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_50]']
mov ['[ecx+8],', 'eax']
mov ['edx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[edx+14h],', '0']
mov ['eax,', '[ebp+var_50]']
mov ['dword', 'ptr', '[eax+18h],', '0']
mov ['ecx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0']
mov ['edx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[edx+0Ch],', '3']
mov ['eax,', '[ebp+var_50]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F8h]']
push ['edx']
call ['_add234']
add ['esp,', '8']
push ['0']
mov ['eax,', '[ebp+var_50]']
mov ['ecx,', '[eax+8]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+var_50]']
mov ['eax,', '[edx+4]']
push ['eax']
push ['1']
push ['15h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '1Ch']
push ['offset', '$SG91121']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11_6']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '50h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_msg_channel_open_confirmation proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_10],', 'eax']
push ['offset', '_ssh_channelfind']
lea ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0F8h]']
push ['ecx']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_1EEE3']
mov ['edx,', '[ebp+var_14]']
cmp ['dword', 'ptr', '[edx+0Ch],', '4']
jnz ['short', 'loc_1EEE3']
mov ['eax,', '[ebp+var_14]']
mov ['ecx,', '[ebp+var_10]']
mov ['[eax+4],', 'ecx']
mov ['edx,', '[ebp+var_14]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+var_14]']
mov ['dword', 'ptr', '[eax+0Ch],', '3']
mov ['ecx,', '[ebp+var_14]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_pfd_confirm']
add ['esp,', '4']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_1EEFE']
mov ['ecx,', '[ebp+var_14]']
cmp ['dword', 'ptr', '[ecx+18h],', '0']
jz ['short', 'loc_1EEFE']
mov ['edx,', '[ebp+var_14]']
push ['edx']
call ['_ssh_channel_try_eof']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN7_10']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_msg_channel_open_failure proc near 
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
push ['offset', '_ssh_channelfind']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0F8h]']
push ['eax']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_1EFE3']
mov ['ecx,', '[ebp+var_10]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '4']
jnz ['short', 'loc_1EFE3']
push ['offset', '$SG91142']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_pfd_close']
add ['esp,', '4']
mov ['eax,', '[ebp+var_10]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F8h]']
push ['edx']
call ['_del234']
add ['esp,', '8']
mov ['eax,', '[ebp+var_10]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN6_11']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_msg_channel_close proc near       
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
push ['offset', '_ssh_channelfind']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0F8h]']
push ['eax']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['loc_1F20B']
mov ['ecx,', '[ebp+var_10]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jnz ['loc_1F20B']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '18h']
jnz ['loc_1F164']
mov ['eax,', '[ebp+var_10]']
mov ['ecx,', '[eax+14h]']
and ['ecx,', '4']
jnz ['loc_1F164']
mov ['[ebp+var_14],', '0']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[edx+14h]']
or ['eax,', '4']
mov ['ecx,', '[ebp+var_10]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[edx+0Ch]']
mov ['[ebp+var_18],', 'eax']
cmp ['[ebp+var_18],', '1']
jz ['short', 'loc_1F0DE']
cmp ['[ebp+var_18],', '2']
jz ['short', 'loc_1F124']
cmp ['[ebp+var_18],', '3']
jz ['short', 'loc_1F101']
jmp ['short', 'loc_1F12B']
mov ['ecx,', '[ebp+var_10]']
cmp ['dword', 'ptr', '[ecx+4Ch],', '0']
jz ['short', 'loc_1F0F8']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_x11_send_eof']
add ['esp,', '4']
jmp ['short', 'loc_1F0FF']
mov ['[ebp+var_14],', '1']
jmp ['short', 'loc_1F12B']
mov ['ecx,', '[ebp+var_10]']
cmp ['dword', 'ptr', '[ecx+4Ch],', '0']
jz ['short', 'loc_1F11B']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_pfd_send_eof']
add ['esp,', '4']
jmp ['short', 'loc_1F122']
mov ['[ebp+var_14],', '1']
jmp ['short', 'loc_1F12B']
mov ['[ebp+var_14],', '1']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_1F164']
mov ['ecx,', '[ebp+var_10]']
mov ['edx,', '[ecx+14h]']
and ['edx,', '1']
jnz ['short', 'loc_1F164']
push ['0']
mov ['eax,', '[ebp+var_10]']
mov ['ecx,', '[eax+4]']
push ['ecx']
push ['1']
push ['18h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '14h']
mov ['eax,', '[ebp+var_10]']
mov ['ecx,', '[eax+14h]']
or ['ecx,', '1']
mov ['edx,', '[ebp+var_10]']
mov ['[edx+14h],', 'ecx']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '19h']
jnz ['short', 'loc_1F1B0']
mov ['ecx,', '[ebp+var_10]']
mov ['edx,', '[ecx+14h]']
and ['edx,', '8']
jnz ['short', 'loc_1F1B0']
mov ['eax,', '[ebp+var_10]']
mov ['ecx,', '[eax+14h]']
and ['ecx,', '1']
jnz ['short', 'loc_1F1A1']
mov ['edx,', '[ebp+var_8]']
push ['edx']
push ['offset', '$SG91168']
call ['_dupprintf']
add ['esp,', '8']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_10]']
mov ['edx,', '[ecx+14h]']
or ['edx,', '8']
mov ['eax,', '[ebp+var_10]']
mov ['[eax+14h],', 'edx']
mov ['ecx,', '[ebp+var_10]']
mov ['edx,', '[ecx+14h]']
not ['edx']
and ['edx,', '5']
jnz ['short', 'loc_1F1F0']
mov ['eax,', '[ebp+var_10]']
mov ['ecx,', '[eax+14h]']
and ['ecx,', '2']
jnz ['short', 'loc_1F1F0']
push ['0']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[edx+4]']
push ['eax']
push ['1']
push ['19h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_send_packet']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[edx+14h]']
or ['eax,', '2']
mov ['ecx,', '[ebp+var_10]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[edx+14h]']
not ['eax']
and ['eax,', '0Ah']
jnz ['short', 'loc_1F209']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
call ['_ssh_channel_destroy']
add ['esp,', '4']
jmp ['short', 'loc_1F260']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_1F21A']
mov ['[ebp+var_1C],', 'offset', '$SG91172']
jmp ['short', 'loc_1F221']
mov ['[ebp+var_1C],', 'offset', '$SG91173']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '18h']
jnz ['short', 'loc_1F233']
mov ['[ebp+var_20],', 'offset', '$SG91174']
jmp ['short', 'loc_1F23A']
mov ['[ebp+var_20],', 'offset', '$SG91175']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
mov ['edx,', '[ebp+var_20]']
push ['edx']
push ['offset', '$SG91176']
call ['_dupprintf']
add ['esp,', '10h']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_bomb_out']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN26_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_msg_channel_data proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '58h']
push ['edi']
lea ['edi,', '[ebp+var_58]']
mov ['ecx,', '16h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
lea ['ecx,', '[ebp+var_20]']
push ['ecx']
lea ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
push ['offset', '_ssh_channelfind']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0F8h]']
push ['eax']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_28],', 'eax']
cmp ['[ebp+var_28],', '0']
jz ['loc_1F56E']
mov ['[ebp+var_2C],', '0']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ecx+0Ch]']
mov ['[ebp+var_50],', 'edx']
cmp ['[ebp+var_50],', '1']
jz ['short', 'loc_1F320']
cmp ['[ebp+var_50],', '2']
jz ['short', 'loc_1F35E']
cmp ['[ebp+var_50],', '3']
jz ['short', 'loc_1F33F']
jmp ['loc_1F544']
mov ['eax,', '[ebp+var_20]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_x11_send']
add ['esp,', '0Ch']
mov ['[ebp+var_2C],', 'eax']
jmp ['loc_1F544']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+var_28]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_pfd_send']
add ['esp,', '0Ch']
mov ['[ebp+var_2C],', 'eax']
jmp ['loc_1F544']
cmp ['[ebp+var_20],', '0']
jle ['loc_1F53D']
mov ['edx,', '[ebp+var_28]']
cmp ['dword', 'ptr', '[edx+54h],', '4']
jnb ['short', 'loc_1F3DC']
mov ['eax,', '[ebp+var_28]']
mov ['ecx,', '4']
sub ['ecx,', '[eax+54h]']
cmp ['ecx,', '[ebp+var_20]']
jnb ['short', 'loc_1F391']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '4']
sub ['eax,', '[edx+54h]']
mov ['[ebp+var_54],', 'eax']
jmp ['short', 'loc_1F397']
mov ['ecx,', '[ebp+var_20]']
mov ['[ebp+var_54],', 'ecx']
mov ['edx,', '[ebp+var_54]']
mov ['[ebp+Size],', 'edx']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '[edx+54h]']
mov ['ecx,', '[ebp+var_28]']
lea ['edx,', '[ecx+eax+50h]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+Src]']
add ['eax,', '[ebp+Size]']
mov ['[ebp+Src],', 'eax']
mov ['ecx,', '[ebp+var_20]']
sub ['ecx,', '[ebp+Size]']
mov ['[ebp+var_20],', 'ecx']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '[edx+54h]']
add ['eax,', '[ebp+Size]']
mov ['ecx,', '[ebp+var_28]']
mov ['[ecx+54h],', 'eax']
mov ['edx,', '[ebp+var_28]']
cmp ['dword', 'ptr', '[edx+54h],', '4']
jnz ['short', 'loc_1F448']
mov ['eax,', '[ebp+var_28]']
movzx ['ecx,', 'byte', 'ptr', '[eax+50h]']
shl ['ecx,', '18h']
mov ['edx,', '[ebp+var_28]']
movzx ['eax,', 'byte', 'ptr', '[edx+51h]']
shl ['eax,', '10h']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_28]']
movzx ['eax,', 'byte', 'ptr', '[edx+52h]']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['edx,', '[ebp+var_28]']
movzx ['eax,', 'byte', 'ptr', '[edx+53h]']
or ['ecx,', 'eax']
add ['ecx,', '4']
mov ['edx,', '[ebp+var_28]']
mov ['[edx+58h],', 'ecx']
push ['1']
mov ['eax,', '[ebp+var_28]']
mov ['ecx,', '[eax+58h]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['edx,', '[ebp+var_28]']
mov ['[edx+4Ch],', 'eax']
push ['4']
mov ['eax,', '[ebp+var_28]']
add ['eax,', '50h']
push ['eax']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_28]']
cmp ['dword', 'ptr', '[eax+54h],', '4']
jb ['short', 'loc_1F4C3']
cmp ['[ebp+var_20],', '0']
jle ['short', 'loc_1F4C3']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '[ecx+58h]']
sub ['eax,', '[edx+54h]']
cmp ['eax,', '[ebp+var_20]']
jnb ['short', 'loc_1F479']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '[ecx+58h]']
sub ['eax,', '[edx+54h]']
mov ['[ebp+var_58],', 'eax']
jmp ['short', 'loc_1F47F']
mov ['ecx,', '[ebp+var_20]']
mov ['[ebp+var_58],', 'ecx']
mov ['edx,', '[ebp+var_58]']
mov ['[ebp+var_34],', 'edx']
mov ['eax,', '[ebp+var_34]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '[edx+4Ch]']
mov ['ecx,', '[ebp+var_28]']
add ['eax,', '[ecx+54h]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+Src]']
add ['edx,', '[ebp+var_34]']
mov ['[ebp+Src],', 'edx']
mov ['eax,', '[ebp+var_20]']
sub ['eax,', '[ebp+var_34]']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ecx+54h]']
add ['edx,', '[ebp+var_34]']
mov ['eax,', '[ebp+var_28]']
mov ['[eax+54h],', 'edx']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '[ecx+54h]']
cmp ['eax,', '[edx+58h]']
jnz ['short', 'loc_1F538']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ecx+5Ch]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_28]']
mov ['[eax+5Ch],', 'edx']
mov ['ecx,', '[ebp+var_28]']
push ['ecx']
push ['offset', '_ssh_agentf_callback']
lea ['edx,', '[ebp+var_48]']
push ['edx']
lea ['eax,', '[ebp+var_3C]']
push ['eax']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ecx+58h]']
push ['edx']
mov ['eax,', '[ebp+var_28]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_agent_query']
add ['esp,', '18h']
test ['eax,', 'eax']
jz ['short', 'loc_1F51F']
mov ['edx,', '[ebp+var_48]']
push ['edx']
mov ['eax,', '[ebp+var_3C]']
push ['eax']
mov ['ecx,', '[ebp+var_28]']
push ['ecx']
call ['_ssh_agentf_callback']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_28]']
mov ['dword', 'ptr', '[ecx+54h],', '0']
jmp ['loc_1F35E']
mov ['[ebp+var_2C],', '0']
mov ['edx,', '[ebp+var_28]']
cmp ['dword', 'ptr', '[edx+1Ch],', '0']
jnz ['short', 'loc_1F56E']
cmp ['[ebp+var_2C],', '8000h']
jle ['short', 'loc_1F56E']
mov ['eax,', '[ebp+var_28]']
mov ['dword', 'ptr', '[eax+1Ch],', '1']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh_throttle_conn']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN27_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '58h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh1_smsg_exit_status proc near        
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+104h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+104h]']
push ['eax']
push ['offset', '$SG91229']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
push ['0']
push ['21h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_send_packet']
add ['esp,', '0Ch']
push ['1']
push ['0']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh_disconnect']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh1_send_ttymode proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['[ebp+var_C],', '0']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', 'ds:_ssh_ttymodes[ecx]']
push ['edx']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1F6AB']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
jmp ['short', 'loc_1F683']
cmp ['[ebp+var_8],', '35h']
jnz ['short', 'loc_1F6B3']
jmp ['short', 'loc_1F71B']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', 'ds:dword_62C4[edx]']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_1F6D0']
cmp ['[ebp+var_10],', '1']
jz ['short', 'loc_1F6E1']
jmp ['short', 'loc_1F6F0']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
call ['_ssh_tty_parse_specchar']
add ['esp,', '4']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_1F6F0']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
call ['_ssh_tty_parse_boolean']
add ['esp,', '4']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
movzx ['ecx,', 'ds:byte_62C0[eax]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
movzx ['eax,', 'byte', 'ptr', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_pkt_addbyte']
add ['esp,', '8']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_protocol_setup proc near          
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_1F755']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '100h']
jge ['short', 'loc_1F771']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+ecx*4+244h],', 'offset', '_ssh2_msg_something_unimplemented']
jmp ['short', 'loc_1F74C']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+250h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+258h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+25Ch],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+294h],', 'offset', '_ssh2_msg_transport']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+298h],', 'offset', '_ssh2_msg_transport']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+2BCh],', 'offset', '_ssh2_msg_transport']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+2C0h],', 'offset', '_ssh2_msg_transport']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+2C4h],', 'offset', '_ssh2_msg_transport']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+2C8h],', 'offset', '_ssh2_msg_transport']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+30Ch],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+310h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+314h],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+318h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+334h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+338h],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+384h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+388h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+38Ch],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3ACh],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3B0h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3B4h],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3B8h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3BCh],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3C0h],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3C4h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3C8h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3CCh],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3D0h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3D4h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+248h],', 'offset', '_ssh2_msg_disconnect']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+24Ch],', 'offset', '_ssh_msg_ignore']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+254h],', 'offset', '_ssh2_msg_debug']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_disconnect proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getuint32']
add ['esp,', '4']
mov ['[ebp+var_14],', 'eax']
lea ['ecx,', '[ebp+var_1C]']
push ['ecx']
lea ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
cmp ['[ebp+var_14],', '0']
jle ['short', 'loc_1F98A']
cmp ['[ebp+var_14],', '10h']
jnb ['short', 'loc_1F98A']
mov ['ecx,', '[ebp+var_14]']
mov ['edx,', 'ds:_ssh2_disconnect_reasons[ecx*4]']
push ['edx']
push ['offset', '$SG93863']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_1F99E']
mov ['eax,', '[ebp+var_14]']
push ['eax']
push ['offset', '$SG93865']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+var_1C]']
push ['eax']
push ['offset', '$SG93866']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
cmp ['[ebp+var_14],', '0']
jle ['short', 'loc_1FA09']
cmp ['[ebp+var_14],', '10h']
jnb ['short', 'loc_1FA09']
mov ['ecx,', '[ebp+var_14]']
mov ['edx,', 'ds:_ssh2_disconnect_reasons[ecx*4]']
mov ['[ebp+var_24],', 'edx']
jmp ['short', 'loc_1FA10']
mov ['[ebp+var_24],', 'offset', '$SG93867']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
mov ['edx,', '[ebp+var_24]']
push ['edx']
mov ['eax,', '[ebp+var_14]']
push ['eax']
push ['offset', '$SG93868']
call ['_dupprintf']
add ['esp,', '14h']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_bomb_out']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN10_11']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_debug proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh2_pkt_getbool']
add ['esp,', '4']
lea ['ecx,', '[ebp+var_14]']
push ['ecx']
lea ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_ssh_pkt_getstring']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_14]']
push ['edx']
push ['offset', '$SG93877']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_logeventf']
add ['esp,', '10h']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN6_12']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_msg_transport proc near           
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_do_ssh2_transport']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh2_msg_something_unimplemented proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['3']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ssh2_pkt_send_noqueue']
add ['esp,', '8']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_bare_connection_protocol_setup proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_1FBD5']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '100h']
jge ['short', 'loc_1FBF1']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+ecx*4+244h],', 'offset', '_ssh2_msg_something_unimplemented']
jmp ['short', 'loc_1FBCC']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+384h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+388h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+38Ch],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3ACh],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3B0h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3B4h],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3B8h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3BCh],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3C0h],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3C4h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3C8h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3CCh],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+3D0h],', 'offset', '_ssh2_msg_unexpected']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+3D4h],', 'offset', '_ssh2_msg_unexpected']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+250h],', 'offset', '_ssh2_msg_unexpected']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+248h],', 'offset', '_ssh2_msg_disconnect']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+24Ch],', 'offset', '_ssh_msg_ignore']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+254h],', 'offset', '_ssh2_msg_debug']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_protocol  proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+118h],', '4']
jnz ['short', 'loc_1FD0B']
jmp ['loc_1FDD6']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1FD6A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+658h]']
mov ['ecx,', '[ebp+arg_C]']
add ['eax,', '[ecx+20h]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+658h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+668h],', '0']
jnz ['short', 'loc_1FD6A']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+664h],', '0']
jz ['short', 'loc_1FD6A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+658h]']
cmp ['ecx,', '[eax+664h]']
jbe ['short', 'loc_1FD6A']
push ['0']
push ['0FFFFFFFFh']
push ['offset', '$SG93940']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_ssh2_transport']
add ['esp,', '10h']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1FD98']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+eax*4+244h]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_1FDD6']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+20Ch],', '0']
jnz ['short', 'loc_1FDBE']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_do_ssh2_transport']
add ['esp,', '10h']
jmp ['short', 'loc_1FDD6']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_ssh2_authconn']
add ['esp,', '10h']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh2_bare_connection_protocol proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+118h],', '4']
jnz ['short', 'loc_1FE08']
jmp ['short', 'loc_1FE4E']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_1FE36']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+edx*4+244h]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_1FE4E']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_ssh2_authconn']
add ['esp,', '10h']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_cache_conf_values proc near        
push ['ebp']
mov ['ebp,', 'esp']
push ['77h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+21Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+220h],', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_ssh_reconfig   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['byte', 'ptr', '[ebp+var_C+3],', '0']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+654h]']
push ['edx']
call ['_pinger_reconfig']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+114h],', '0']
jz ['short', 'loc_204E9']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_setup_portfwd']
add ['esp,', '8']
push ['18h']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_18],', 'eax']
push ['18h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '[ebp+var_18]']
jz ['short', 'loc_20589']
cmp ['[ebp+var_18],', '0']
jz ['short', 'loc_20589']
mov ['eax,', '[ebp+var_18]']
imul ['eax,', '3Ch']
imul ['eax,', '3E8h']
mov ['ecx,', '[ebp+var_4]']
add ['eax,', '[ecx+670h]']
mov ['[ebp+var_1C],', 'eax']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_20],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_20]']
sub ['eax,', '[edx+670h]']
mov ['ecx,', '[ebp+var_18]']
imul ['ecx,', '3Ch']
imul ['ecx,', '3E8h']
cmp ['eax,', 'ecx']
jbe ['short', 'loc_20568']
mov ['[ebp+var_8],', 'offset', '$SG94120']
jmp ['short', 'loc_20589']
mov ['edx,', '[ebp+var_4]']
push ['edx']
push ['offset', '_ssh2_timer']
mov ['eax,', '[ebp+var_1C]']
sub ['eax,', '[ebp+var_20]']
push ['eax']
call ['_schedule_timer']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+66Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+664h]']
mov ['[ebp+var_10],', 'eax']
push ['19h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
call ['_parse_blocksize']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+664h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_10]']
cmp ['eax,', '[edx+664h]']
jz ['short', 'loc_20604']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+664h],', '0']
jz ['short', 'loc_20604']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+65Ch]']
cmp ['ecx,', '[eax+664h]']
ja ['short', 'loc_205FD']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+658h]']
cmp ['ecx,', '[eax+664h]']
jbe ['short', 'loc_20604']
mov ['[ebp+var_8],', 'offset', '$SG94125']
push ['16h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['16h']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jz ['short', 'loc_20637']
mov ['[ebp+var_8],', 'offset', '$SG94127']
mov ['byte', 'ptr', '[ebp+var_C+3],', '1']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_20649']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '1']
mov ['[ebp+var_14],', 'edx']
cmp ['[ebp+var_14],', '6']
jge ['short', 'loc_2068C']
mov ['eax,', '[ebp+var_14]']
push ['eax']
push ['1Dh']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+21Ch]']
push ['edx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['esi,', 'eax']
mov ['eax,', '[ebp+var_14]']
push ['eax']
push ['1Dh']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
cmp ['esi,', 'eax']
jz ['short', 'loc_2068A']
mov ['[ebp+var_8],', 'offset', '$SG94132']
mov ['byte', 'ptr', '[ebp+var_C+3],', '1']
jmp ['short', 'loc_20640']
push ['20h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['20h']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jz ['short', 'loc_206BF']
mov ['[ebp+var_8],', 'offset', '$SG94134']
mov ['byte', 'ptr', '[ebp+var_C+3],', '1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_free']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_copy']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+21Ch],', 'eax']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh_cache_conf_values']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0C4h],', '0']
jnz ['short', 'loc_2073A']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_2073A']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+668h],', '0']
jnz ['short', 'loc_20726']
push ['0']
push ['0FFFFFFFFh']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_do_ssh2_transport']
add ['esp,', '10h']
jmp ['short', 'loc_2073A']
movsx ['edx,', 'byte', 'ptr', '[ebp+var_C+3]']
test ['edx,', 'edx']
jz ['short', 'loc_2073A']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['[eax+674h],', 'ecx']
pop ['esi']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_send       proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_20785']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jz ['short', 'loc_20785']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+210h],', '0']
jnz ['short', 'loc_20789']
xor ['eax,', 'eax']
jmp ['short', 'loc_207BA']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+210h]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh_sendbuffer']
add ['esp,', '4']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_sendbuffer proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_2080D']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jz ['short', 'loc_2080D']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+210h],', '0']
jnz ['short', 'loc_20811']
xor ['eax,', 'eax']
jmp ['short', 'loc_2087E']
mov ['[ebp+var_8],', '0']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+178h],', '0']
jz ['short', 'loc_20830']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+174h]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+16Ch],', '1']
jnz ['short', 'loc_20843']
mov ['eax,', '[ebp+var_8]']
jmp ['short', 'loc_2087E']
jmp ['short', 'loc_2087C']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '2']
jnz ['short', 'loc_2087C']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0FCh],', '0']
jnz ['short', 'loc_20862']
mov ['eax,', '[ebp+var_8]']
jmp ['short', 'loc_2087E']
jmp ['short', 'loc_2087C']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0FCh]']
add ['ecx,', '20h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
add ['eax,', '[ebp+var_8]']
jmp ['short', 'loc_2087E']
xor ['eax,', 'eax']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_size       proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+0F0h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+0F4h],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+118h]']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '2']
jz ['short', 'loc_208F3']
cmp ['[ebp+var_C],', '3']
jz ['short', 'loc_20905']
jmp ['loc_209E4']
jmp ['loc_209E4']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+11Ch],', '1']
jmp ['loc_209E4']
push ['15h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+21Ch]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['loc_209E4']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '1']
jnz ['short', 'loc_20962']
push ['0']
push ['0']
push ['1']
push ['0']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0F0h]']
push ['eax']
push ['1']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0F4h]']
push ['edx']
push ['1']
push ['0Bh']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_send_packet']
add ['esp,', '2Ch']
jmp ['loc_209E4']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0FCh],', '0']
jz ['short', 'loc_209E4']
push ['0']
push ['0']
push ['offset', '$SG94196']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0F0h]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0F4h]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['0']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['0']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_get_specials proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '1']
jnz ['short', 'loc_20A7E']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+50h]']
and ['eax,', '1']
jnz ['short', 'loc_20A79']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
cmp ['ecx,', '14h']
jbe ['short', 'loc_20A52']
push ['2AEDh']
push ['offset', '$SG94243']
push ['offset', '$SG94244']
call ['__wassert']
add ['esp,', '0Ch']
push ['8']
push ['offset', '?ssh1_ignore_special@?1??ssh_get_specials@@9@9']
mov ['eax,', '[ebp+var_8]']
lea ['ecx,', '?ssh_specials@?1??ssh_get_specials@@9@9[eax*8]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
xor ['eax,', 'eax']
jnz ['short', 'loc_20A30']
jmp ['loc_20B9C']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '2']
jnz ['loc_20B9C']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+50h]']
and ['eax,', '200h']
jnz ['short', 'loc_20AE4']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
cmp ['ecx,', '14h']
jbe ['short', 'loc_20ABD']
push ['2AF0h']
push ['offset', '$SG94252']
push ['offset', '$SG94253']
call ['__wassert']
add ['esp,', '0Ch']
push ['8']
push ['offset', '?ssh2_ignore_special@?1??ssh_get_specials@@9@9']
mov ['eax,', '[ebp+var_8]']
lea ['ecx,', '?ssh_specials@?1??ssh_get_specials@@9@9[eax*8]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
xor ['eax,', 'eax']
jnz ['short', 'loc_20A9B']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+50h]']
and ['edx,', '40h']
jnz ['short', 'loc_20B44']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+0C4h],', '0']
jnz ['short', 'loc_20B44']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
cmp ['ecx,', '14h']
jbe ['short', 'loc_20B1D']
push ['2AF2h']
push ['offset', '$SG94259']
push ['offset', '$SG94260']
call ['__wassert']
add ['esp,', '0Ch']
push ['8']
push ['offset', '?ssh2_rekey_special@?1??ssh_get_specials@@9@9']
mov ['eax,', '[ebp+var_8]']
lea ['ecx,', '?ssh_specials@?1??ssh_get_specials@@9@9[eax*8]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
xor ['eax,', 'eax']
jnz ['short', 'loc_20AFB']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0FCh],', '0']
jz ['short', 'loc_20B9C']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '11h']
cmp ['edx,', '14h']
jbe ['short', 'loc_20B72']
push ['2AF4h']
push ['offset', '$SG94266']
push ['offset', '$SG94267']
call ['__wassert']
add ['esp,', '0Ch']
push ['88h']
push ['offset', '?ssh2_session_specials@?1??ssh_get_specials@@9@9']
mov ['ecx,', '[ebp+var_8]']
lea ['edx,', '?ssh_specials@?1??ssh_get_specials@@9@9[ecx*8]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '11h']
mov ['[ebp+var_8],', 'eax']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_20B50']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_20BF4']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
cmp ['edx,', '14h']
jbe ['short', 'loc_20BC4']
push ['2AF8h']
push ['offset', '$SG94273']
push ['offset', '$SG94274']
call ['__wassert']
add ['esp,', '0Ch']
push ['8']
push ['offset', '?specials_end@?1??ssh_get_specials@@9@9']
mov ['ecx,', '[ebp+var_8]']
lea ['edx,', '?ssh_specials@?1??ssh_get_specials@@9@9[ecx*8]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_20BA2']
mov ['eax,', 'offset', '?ssh_specials@?1??ssh_get_specials@@9@9']
jmp ['short', 'loc_20BF6']
jmp ['short', 'loc_20BF6']
xor ['eax,', 'eax']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_special    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+Str],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_4],', '0Ch']
jnz ['loc_20CBC']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+118h],', '3']
jz ['short', 'loc_20C57']
cmp ['[ebp+arg_4],', '0Ch']
jnz ['short', 'loc_20C52']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+120h],', '1']
jmp ['loc_20F52']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+16Ch],', '1']
jnz ['short', 'loc_20C75']
push ['0']
push ['13h']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_send_packet']
add ['esp,', '0Ch']
jmp ['short', 'loc_20CA0']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0FCh],', '0']
jz ['short', 'loc_20CA0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
call ['_sshfwd_write_eof']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0D8h],', '0']
push ['offset', '$SG94291']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0E4h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
jmp ['loc_20F52']
cmp ['[ebp+arg_4],', '0Fh']
jz ['short', 'loc_20CCC']
cmp ['[ebp+arg_4],', '6']
jnz ['loc_20D54']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+118h],', '4']
jz ['short', 'loc_20CE4']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+118h],', '0']
jnz ['short', 'loc_20CE9']
jmp ['loc_20F52']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '1']
jnz ['short', 'loc_20D19']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+50h]']
and ['eax,', '1']
jnz ['short', 'loc_20D17']
push ['0']
push ['offset', '$SG94299']
push ['4']
push ['20h']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_send_packet']
add ['esp,', '14h']
jmp ['short', 'loc_20D4F']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+50h]']
and ['eax,', '200h']
jnz ['short', 'loc_20D4F']
push ['2']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_addstring_start']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh2_pkt_send_noqueue']
add ['esp,', '8']
jmp ['loc_20F52']
cmp ['[ebp+arg_4],', '11h']
jnz ['short', 'loc_20D98']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+668h],', '0']
jnz ['short', 'loc_20D93']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0C4h],', '0']
jnz ['short', 'loc_20D93']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+16Ch],', '2']
jnz ['short', 'loc_20D93']
push ['0']
push ['0FFFFFFFFh']
push ['offset', '$SG94306']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_do_ssh2_transport']
add ['esp,', '10h']
jmp ['loc_20F52']
cmp ['[ebp+arg_4],', '1']
jnz ['loc_20E31']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+118h],', '4']
jz ['short', 'loc_20DBA']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+118h],', '0']
jnz ['short', 'loc_20DBF']
jmp ['loc_20F52']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '1']
jnz ['short', 'loc_20DE4']
push ['offset', '$SG94312']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0E4h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
jmp ['short', 'loc_20E2C']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+0FCh],', '0']
jz ['short', 'loc_20E2C']
push ['0']
push ['0']
push ['offset', '$SG94317']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0FCh]']
push ['eax']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
push ['0']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
jmp ['loc_20F52']
mov ['[ebp+Str],', '0']
cmp ['[ebp+arg_4],', '12h']
jnz ['short', 'loc_20E45']
mov ['[ebp+Str],', 'offset', '$SG94322']
cmp ['[ebp+arg_4],', '13h']
jnz ['short', 'loc_20E52']
mov ['[ebp+Str],', 'offset', '$SG94324']
cmp ['[ebp+arg_4],', '14h']
jnz ['short', 'loc_20E5F']
mov ['[ebp+Str],', 'offset', '$SG94326']
cmp ['[ebp+arg_4],', '15h']
jnz ['short', 'loc_20E6C']
mov ['[ebp+Str],', 'offset', '$SG94328']
cmp ['[ebp+arg_4],', '16h']
jnz ['short', 'loc_20E79']
mov ['[ebp+Str],', 'offset', '$SG94330']
cmp ['[ebp+arg_4],', '17h']
jnz ['short', 'loc_20E86']
mov ['[ebp+Str],', 'offset', '$SG94332']
cmp ['[ebp+arg_4],', '18h']
jnz ['short', 'loc_20E93']
mov ['[ebp+Str],', 'offset', '$SG94334']
cmp ['[ebp+arg_4],', '19h']
jnz ['short', 'loc_20EA0']
mov ['[ebp+Str],', 'offset', '$SG94336']
cmp ['[ebp+arg_4],', '1Ah']
jnz ['short', 'loc_20EAD']
mov ['[ebp+Str],', 'offset', '$SG94338']
cmp ['[ebp+arg_4],', '1Bh']
jnz ['short', 'loc_20EBA']
mov ['[ebp+Str],', 'offset', '$SG94340']
cmp ['[ebp+arg_4],', '1Ch']
jnz ['short', 'loc_20EC7']
mov ['[ebp+Str],', 'offset', '$SG94342']
cmp ['[ebp+arg_4],', '1Dh']
jnz ['short', 'loc_20ED4']
mov ['[ebp+Str],', 'offset', '$SG94344']
cmp ['[ebp+arg_4],', '1Eh']
jnz ['short', 'loc_20EE1']
mov ['[ebp+Str],', 'offset', '$SG94346']
cmp ['[ebp+Str],', '0']
jz ['short', 'loc_20F52']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '2']
jnz ['short', 'loc_20F52']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0FCh],', '0']
jz ['short', 'loc_20F52']
push ['0']
push ['0']
push ['offset', '$SG94351']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0FCh]']
push ['ecx']
call ['_ssh2_chanreq_init']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '$SG94352']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_logeventf']
add ['esp,', '0Ch']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_new_sock_channel proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
push ['60h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx],', 'edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_ssh2_channel_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+10h],', '1']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+0Ch],', '4']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+4Ch],', 'ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0F8h]']
push ['ecx']
call ['_add234']
add ['esp,', '8']
mov ['eax,', '[ebp+var_8]']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_alloc_sharing_channel proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['60h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ssh2_channel_init']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0Ch],', '5']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+4Ch],', 'edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F8h]']
push ['edx']
call ['_add234']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+8]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_delete_sharing_channel proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['offset', '_ssh_channelfind']
lea ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0F8h]']
push ['edx']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_210A3']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh_channel_destroy']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_send_packet_from_downstream proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_ssh2_pkt_init']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+24h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_14]']
mov ['[eax+28h],', 'ecx']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_pkt_adddata']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ssh2_pkt_send']
add ['esp,', '8']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_unthrottle proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '1']
jnz ['short', 'loc_2117A']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+17Ch],', '0']
jz ['short', 'loc_21175']
cmp ['[ebp+arg_4],', '8000h']
jge ['short', 'loc_21175']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+17Ch],', '0']
push ['0FFFFFFFFh']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_throttle_conn']
add ['esp,', '8']
jmp ['loc_21229']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0FCh],', '0']
jz ['loc_21229']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0FCh]']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ecx+38h]']
jge ['short', 'loc_211AF']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0FCh]']
mov ['edx,', '[ecx+38h]']
sub ['edx,', '[ebp+arg_4]']
mov ['[ebp+var_C],', 'edx']
jmp ['short', 'loc_211B6']
mov ['[ebp+var_C],', '0']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0FCh]']
push ['edx']
call ['_ssh2_set_window']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh_is_simple']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_211E5']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_211F4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0FCh]']
mov ['eax,', '[edx+38h]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0FCh]']
cmp ['dword', 'ptr', '[edx+1Ch],', '0']
jz ['short', 'loc_21229']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[ebp+var_8]']
jg ['short', 'loc_21229']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0FCh]']
mov ['dword', 'ptr', '[edx+1Ch],', '0']
push ['0FFFFFFFFh']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ssh_throttle_conn']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh_process_queued_incoming_data']
add ['esp,', '4']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_send_port_open proc near           
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+Str],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['offset', '$SG94422']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_logeventf']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '1']
jnz ['short', 'loc_212BD']
push ['0']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
push ['1']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
push ['1']
push ['1Dh']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_send_packet']
add ['esp,', '24h']
jmp ['short', 'loc_2133B']
push ['offset', '$SG94425']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ssh2_chanopen_init']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_host_strduptrim']
add ['esp,', '4']
mov ['[ebp+Str],', 'eax']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
push ['offset', '$SG94427']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_ssh_pkt_addstring']
add ['esp,', '8']
push ['0']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_ssh_pkt_adduint32']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_ssh2_pkt_send']
add ['esp,', '8']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_connected  proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
xor ['eax,', 'eax']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
setnz ['al']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_sendok     proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+0D8h]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_ldisc      proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_213CA']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+0DCh]']
jmp ['short', 'loc_213DD']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_213DB']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0E0h]']
jmp ['short', 'loc_213DD']
xor ['eax,', 'eax']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_provide_ldisc proc near            
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+14h],', 'edx']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_provide_logctx proc near           
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+18h],', 'edx']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_return_exitcode proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jz ['short', 'loc_21452']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_21476']
jmp ['short', 'loc_21476']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+104h],', '0']
jl ['short', 'loc_2146C']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+104h]']
mov ['[ebp+var_8],', 'ecx']
jmp ['short', 'loc_21473']
mov ['[ebp+var_8],', '7FFFFFFFh']
mov ['eax,', '[ebp+var_8]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_cfg_info   proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+16Ch],', '0']
jnz ['short', 'loc_214AB']
xor ['eax,', 'eax']
jmp ['short', 'loc_214C7']
jmp ['short', 'loc_214C7']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+0C4h],', '0']
jz ['short', 'loc_214BE']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_214C7']
jmp ['short', 'loc_214C7']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+16Ch]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ssh_fallback_cmd proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+148h]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
