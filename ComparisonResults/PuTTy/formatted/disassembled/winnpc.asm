_new_named_pipe_client proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
push ['9']
push ['offset', '$SG88011']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_strncmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_1EE']
push ['1Eh']
push ['offset', '$SG88012']
push ['offset', '$SG88013']
call ['__wassert']
add ['esp,', '0Ch']
push ['5Ch']
mov ['edx,', '[ebp+Str1]']
add ['edx,', '9']
push ['edx']
call ['_strchr']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_217']
push ['1Fh']
push ['offset', '$SG88016']
push ['offset', '$SG88017']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '1']
test ['ecx,', 'ecx']
jz ['loc_333']
mov ['esi,', 'esp']
push ['0']
push ['40000000h']
push ['3']
push ['0']
push ['0']
push ['0C0000000h']
mov ['edx,', '[ebp+Str1]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__CreateFileA@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hObject],', 'eax']
cmp ['[ebp+hObject],', '0FFFFFFFFh']
jz ['short', 'loc_257']
jmp ['loc_333']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetLastError@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '0E7h']
jz ['short', 'loc_2C1']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetLastError@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
call ['_win_strerror']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+Str1]']
push ['eax']
push ['offset', '$SG88027']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_24],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_24]']
push ['edx']
call ['_new_error_socket']
add ['esp,', '8']
mov ['[ebp+var_28],', 'eax']
mov ['eax,', '[ebp+var_24]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_28]']
jmp ['loc_4DD']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__WaitNamedPipeA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_32E']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetLastError@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
call ['_win_strerror']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+Str1]']
push ['edx']
push ['offset', '$SG88029']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_24],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+var_24]']
push ['ecx']
call ['_new_error_socket']
add ['esp,', '8']
mov ['[ebp+var_28],', 'eax']
mov ['edx,', '[ebp+var_24]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_28]']
jmp ['loc_4DD']
jmp ['loc_217']
call ['_get_user_sid']
mov ['[ebp+pSid2],', 'eax']
cmp ['[ebp+pSid2],', '0']
jnz ['short', 'loc_38B']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hObject]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__CloseHandle@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['offset', '$SG88032']
call ['_dupprintf']
add ['esp,', '4']
mov ['[ebp+var_24],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_24]']
push ['edx']
call ['_new_error_socket']
add ['esp,', '8']
mov ['[ebp+var_28],', 'eax']
mov ['eax,', '[ebp+var_24]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_28]']
jmp ['loc_4DD']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+hMem]']
push ['ecx']
push ['0']
push ['0']
push ['0']
lea ['edx,', '[ebp+pSid1]']
push ['edx']
push ['1']
push ['6']
mov ['eax,', '[ebp+hObject]']
push ['eax']
call ['dword', 'ptr', 'ds:_p_GetSecurityInfo']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_423']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetLastError@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
call ['_win_strerror']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG88037']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_24],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_24]']
push ['edx']
call ['_new_error_socket']
add ['esp,', '8']
mov ['[ebp+var_28],', 'eax']
mov ['eax,', '[ebp+var_24]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hObject]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__CloseHandle@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+pSid2]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_28]']
jmp ['loc_4DD']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+pSid2]']
push ['eax']
mov ['ecx,', '[ebp+pSid1]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__EqualSid@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_4A8']
mov ['edx,', '[ebp+Str1]']
push ['edx']
push ['offset', '$SG88039']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_24],', 'eax']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+var_24]']
push ['ecx']
call ['_new_error_socket']
add ['esp,', '8']
mov ['[ebp+var_28],', 'eax']
mov ['edx,', '[ebp+var_24]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hObject]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__CloseHandle@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hMem]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__LocalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+pSid2]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_28]']
jmp ['short', 'loc_4DD']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hMem]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__LocalFree@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+pSid2]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
push ['1']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+hObject]']
push ['eax']
mov ['ecx,', '[ebp+hObject]']
push ['ecx']
call ['_make_handle_socket']
add ['esp,', '10h']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN16']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
