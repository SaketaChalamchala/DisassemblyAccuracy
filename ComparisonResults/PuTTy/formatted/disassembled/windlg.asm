_force_normal   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '38h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_38]']
mov ['ecx,', '0Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
cmp ['ds:?recurse@?1??force_normal@@9@9,', '0']
jz ['short', 'loc_AD4']
jmp ['short', 'loc_B2E']
mov ['ds:?recurse@?1??force_normal@@9@9,', '1']
mov ['[ebp+wndpl.length],', '2Ch']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+wndpl]']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetWindowPlacement@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_B24']
cmp ['[ebp+wndpl.showCmd],', '3']
jnz ['short', 'loc_B24']
mov ['[ebp+wndpl.showCmd],', '1']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+wndpl]']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowPlacement@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:?recurse@?1??force_normal@@9@9,', '0']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN7']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '38h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_modal_about_box proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__EnableWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['offset', '_AboutProc@16']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
push ['offset', 'TemplateName']
mov ['edx,', 'dword', 'ptr', 'ds:_hinst']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DialogBoxParamA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__EnableWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetActiveWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_AboutProc@16   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+lpString],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '10h']
jz ['loc_DA2']
cmp ['[ebp+var_8],', '110h']
jz ['short', 'loc_C2F']
cmp ['[ebp+var_8],', '111h']
jz ['loc_CAF']
jmp ['loc_DBB']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG90307']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpString],', 'eax']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+lpString]']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowTextA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+lpString]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['esi,', 'esp']
mov ['edx,', 'dword', 'ptr', 'ds:_appname']
push ['edx']
push ['3EAh']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetDlgItemTextA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '_ver']
push ['3EBh']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetDlgItemTextA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_DBD']
mov ['edx,', '[ebp+arg_8]']
and ['edx,', '0FFFFh']
movzx ['eax,', 'dx']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '3EDh']
jg ['short', 'loc_CE5']
cmp ['[ebp+var_C],', '3EDh']
jz ['short', 'loc_D13']
cmp ['[ebp+var_C],', '0']
jle ['loc_D9E']
cmp ['[ebp+var_C],', '2']
jle ['short', 'loc_CF7']
jmp ['loc_D9E']
cmp ['[ebp+var_C],', '3EEh']
jz ['loc_D77']
jmp ['loc_D9E']
mov ['esi,', 'esp']
push ['1']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__EndDialog@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_DBD']
mov ['esi,', 'esp']
push ['0']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__EnableWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['offset', '_LicenceProc@16']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
push ['(offset', 'TemplateName+2)']
mov ['ecx,', 'dword', 'ptr', 'ds:_hinst']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__DialogBoxParamA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__EnableWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetActiveWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['short', 'loc_DBD']
mov ['esi,', 'esp']
push ['0Ah']
push ['0']
push ['0']
push ['offset', '$SG90321']
push ['offset', '$SG90322']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ShellExecuteA@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['short', 'loc_DBD']
xor ['eax,', 'eax']
jmp ['short', 'loc_DBD']
mov ['esi,', 'esp']
push ['1']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__EndDialog@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['short', 'loc_DBD']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['10h']
endp
_LicenceProc@16 proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+lpString],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '10h']
jz ['loc_E96']
cmp ['[ebp+var_8],', '110h']
jz ['short', 'loc_E1B']
cmp ['[ebp+var_8],', '111h']
jz ['short', 'loc_E5C']
jmp ['loc_EAF']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG90281']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpString],', 'eax']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+lpString]']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowTextA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+lpString]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['short', 'loc_EB1']
mov ['edx,', '[ebp+arg_8]']
and ['edx,', '0FFFFh']
movzx ['eax,', 'dx']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jle ['short', 'loc_E92']
cmp ['[ebp+var_C],', '2']
jle ['short', 'loc_E79']
jmp ['short', 'loc_E92']
mov ['esi,', 'esp']
push ['1']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__EndDialog@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['short', 'loc_EB1']
xor ['eax,', 'eax']
jmp ['short', 'loc_EB1']
mov ['esi,', 'esp']
push ['1']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__EndDialog@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['short', 'loc_EB1']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['10h']
endp
_show_help      proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_launch_help']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_defuse_showwindow proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+hWnd],', '0CCCCCCCCh']
mov ['esi,', 'esp']
push ['0']
push ['offset', '_NullDlgProc@16']
push ['0']
push ['offset', 'TemplateName']
mov ['eax,', 'dword', 'ptr', 'ds:_hinst']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__CreateDialogParamA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hWnd],', 'eax']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetActiveWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DestroyWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_NullDlgProc@16 proc near               
push ['ebp']
mov ['ebp,', 'esp']
xor ['eax,', 'eax']
pop ['ebp']
retn ['10h']
endp
_do_config      proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
call ['_ctrl_new_box']
mov ['ds:_ctrlbox,', 'eax']
push ['0']
push ['0']
push ['0']
mov ['eax,', 'ds:_ctrlbox']
push ['eax']
call ['_setup_config_box']
add ['esp,', '10h']
push ['0']
push ['0']
call ['_has_help']
push ['eax']
push ['offset', '_dp']
mov ['ecx,', 'ds:_ctrlbox']
push ['ecx']
call ['_win_setup_config_box']
add ['esp,', '14h']
push ['offset', '_dp']
call ['_dp_init']
add ['esp,', '4']
push ['offset', '_ctrls_base']
call ['_winctrl_init']
add ['esp,', '4']
push ['offset', '_ctrls_panel']
call ['_winctrl_init']
add ['esp,', '4']
push ['offset', '_ctrls_base']
push ['offset', '_dp']
call ['_dp_add_tree']
add ['esp,', '8']
push ['offset', '_ctrls_panel']
push ['offset', '_dp']
call ['_dp_add_tree']
add ['esp,', '8']
mov ['edx,', 'dword', 'ptr', 'ds:_appname']
push ['edx']
push ['offset', '$SG90583']
call ['_dupprintf']
add ['esp,', '8']
mov ['ds:lpString,', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '$SG90584']
call ['_dupprintf']
add ['esp,', '8']
mov ['ds:dword_2C,', 'eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
mov ['ds:dword_30,', 'ecx']
push ['offset', '_dp']
call ['_dlg_auto_set_fixed_pitch_flag']
add ['esp,', '4']
mov ['ds:byte_A3,', '1']
push ['offset', '_GenericMainDlgProc@16']
push ['0']
push ['offset', 'byte_66']
mov ['edx,', 'dword', 'ptr', 'ds:_hinst']
push ['edx']
call ['_SaneDialogBox']
add ['esp,', '10h']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'ds:_ctrlbox']
push ['eax']
call ['_ctrl_free_box']
add ['esp,', '4']
push ['offset', '_ctrls_panel']
call ['_winctrl_cleanup']
add ['esp,', '4']
push ['offset', '_ctrls_base']
call ['_winctrl_cleanup']
add ['esp,', '4']
push ['offset', '_dp']
call ['_dp_cleanup']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_SaneDialogBox  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '64h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_64]']
mov ['ecx,', '19h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['[ebp+WndClass.style],', '2808h']
mov ['eax,', 'dword', 'ptr', 'ds:__imp__DefDlgProcA@16']
mov ['[ebp+WndClass.lpfnWndProc],', 'eax']
mov ['[ebp+WndClass.cbClsExtra],', '0']
mov ['[ebp+WndClass.cbWndExtra],', '26h']
mov ['ecx,', '[ebp+hInstance]']
mov ['[ebp+WndClass.hInstance],', 'ecx']
mov ['[ebp+WndClass.hIcon],', '0']
mov ['esi,', 'esp']
push ['7F00h']
push ['0']
call ['dword', 'ptr', 'ds:__imp__LoadCursorA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+WndClass.hCursor],', 'eax']
mov ['[ebp+WndClass.hbrBackground],', '2']
mov ['[ebp+WndClass.lpszMenuName],', '0']
mov ['[ebp+WndClass.lpszClassName],', 'offset', '$SG90348']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+WndClass]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__RegisterClassA@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', '[ebp+lpDialogFunc]']
push ['eax']
mov ['ecx,', '[ebp+hWndParent]']
push ['ecx']
mov ['edx,', '[ebp+lpTemplateName]']
push ['edx']
mov ['eax,', '[ebp+hInstance]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__CreateDialogParamA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+hWnd],', 'eax']
mov ['esi,', 'esp']
push ['0']
push ['1Eh']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['22h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['0']
lea ['eax,', '[ebp+Msg]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_64],', 'eax']
cmp ['[ebp+var_64],', '0']
jle ['short', 'loc_1218']
mov ['esi,', 'esp']
push ['1Eh']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetWindowLongA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_5C],', 'eax']
mov ['edx,', '[ebp+var_5C]']
and ['edx,', '1']
jnz ['short', 'loc_120C']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Msg]']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__IsDialogMessageA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_120C']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+Msg]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DispatchMessageA@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_5C]']
and ['eax,', '1']
jz ['short', 'loc_1216']
jmp ['short', 'loc_1218']
jmp ['short', 'loc_119C']
cmp ['[ebp+var_64],', '0']
jnz ['short', 'loc_1231']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+Msg.wParam]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__PostQuitMessage@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['22h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetWindowLongA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_60],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DestroyWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_60]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '64h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_GenericMainDlgProc@16 proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '134h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_134]']
mov ['ecx,', '4Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_130],', 'eax']
cmp ['[ebp+var_130],', '53h']
ja ['short', 'loc_131A']
cmp ['[ebp+var_130],', '53h']
jz ['loc_1B23']
cmp ['[ebp+var_130],', '5']
jz ['loc_1B70']
cmp ['[ebp+var_130],', '10h']
jz ['loc_1B52']
cmp ['[ebp+var_130],', '4Eh']
jz ['loc_189D']
jmp ['loc_1AA9']
cmp ['[ebp+var_130],', '110h']
jz ['short', 'loc_133B']
cmp ['[ebp+var_130],', '202h']
jz ['loc_1867']
jmp ['loc_1AA9']
mov ['ecx,', '[ebp+hWnd]']
mov ['ds:_dp,', 'ecx']
push ['offset', '$SG90447']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['_create_controls']
add ['esp,', '8']
mov ['esi,', 'esp']
mov ['eax,', 'ds:lpString']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowTextA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['0FFFFFFEBh']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
call ['_has_help']
test ['eax,', 'eax']
jz ['short', 'loc_13C0']
mov ['esi,', 'esp']
push ['0FFFFFFECh']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetWindowLongA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
or ['eax,', '400h']
mov ['esi,', 'esp']
push ['eax']
push ['0FFFFFFECh']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_13F4']
mov ['esi,', 'esp']
push ['3EDh']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetDlgItem@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_30],', 'eax']
cmp ['[ebp+var_30],', '0']
jz ['short', 'loc_13F4']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_30]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DestroyWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['(offset', 'dword_C8+1)']
mov ['ecx,', 'dword', 'ptr', 'ds:_hinst']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__LoadIconA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['eax']
push ['1']
push ['80h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetDesktopWindow@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Rect]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetWindowRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_14B9']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_5C]']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetWindowRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_14B9']
mov ['esi,', 'esp']
push ['1']
mov ['ecx,', '[ebp+var_5C.bottom]']
sub ['ecx,', '[ebp+var_5C.top]']
push ['ecx']
mov ['edx,', '[ebp+var_5C.right]']
sub ['edx,', '[ebp+var_5C.left]']
push ['edx']
mov ['eax,', '[ebp+Rect.bottom]']
add ['eax,', '[ebp+Rect.top]']
add ['eax,', '[ebp+var_5C.top]']
sub ['eax,', '[ebp+var_5C.bottom]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
push ['eax']
mov ['eax,', '[ebp+Rect.right]']
add ['eax,', '[ebp+Rect.left]']
add ['eax,', '[ebp+var_5C.left]']
sub ['eax,', '[ebp+var_5C.right]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
push ['eax']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__MoveWindow@24']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_74.left],', '3']
mov ['ecx,', '[ebp+var_74.left]']
add ['ecx,', '5Fh']
mov ['[ebp+var_74.right],', 'ecx']
mov ['[ebp+var_74.top],', '3']
mov ['edx,', '[ebp+var_74.top]']
add ['edx,', '0Ah']
mov ['[ebp+var_74.bottom],', 'edx']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_74]']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__MapDialogRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
mov ['edx,', 'dword', 'ptr', 'ds:_hinst']
push ['edx']
push ['offset', 'unk_3EF']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
mov ['ecx,', '[ebp+var_74.bottom]']
sub ['ecx,', '[ebp+var_74.top]']
push ['ecx']
mov ['edx,', '[ebp+var_74.right]']
sub ['edx,', '[ebp+var_74.left]']
push ['edx']
mov ['eax,', '[ebp+var_74.top]']
push ['eax']
mov ['ecx,', '[ebp+var_74.left]']
push ['ecx']
push ['50000000h']
push ['offset', '$SG90465']
push ['offset', '$SG90466']
push ['0']
call ['dword', 'ptr', 'ds:__imp__CreateWindowExA@48']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_80],', 'eax']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['31h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+wParam],', 'eax']
mov ['esi,', 'esp']
push ['1']
mov ['eax,', '[ebp+wParam]']
push ['eax']
push ['30h']
mov ['ecx,', '[ebp+var_80]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_74.left],', '3']
mov ['edx,', '[ebp+var_74.left]']
add ['edx,', '5Fh']
mov ['[ebp+var_74.right],', 'edx']
mov ['[ebp+var_74.top],', '0Dh']
mov ['eax,', '[ebp+var_74.top]']
add ['eax,', '0DBh']
mov ['[ebp+var_74.bottom],', 'eax']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_74]']
push ['ecx']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__MapDialogRect@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', 'dword', 'ptr', 'ds:_hinst']
push ['eax']
push ['offset', 'hMenu']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
mov ['edx,', '[ebp+var_74.bottom]']
sub ['edx,', '[ebp+var_74.top]']
push ['edx']
mov ['eax,', '[ebp+var_74.right]']
sub ['eax,', '[ebp+var_74.left]']
push ['eax']
mov ['ecx,', '[ebp+var_74.top]']
push ['ecx']
mov ['edx,', '[ebp+var_74.left]']
push ['edx']
push ['50010037h']
push ['offset', '$SG90477']
push ['offset', '$SG90478']
push ['200h']
call ['dword', 'ptr', 'ds:__imp__CreateWindowExA@48']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', 'eax']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['31h']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+wParam],', 'eax']
mov ['esi,', 'esp']
push ['1']
mov ['ecx,', '[ebp+wParam]']
push ['ecx']
push ['30h']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
mov ['[ebp+var_24],', 'eax']
push ['10h']
push ['0']
lea ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_memset']
add ['esp,', '0Ch']
mov ['[ebp+lParam],', '0']
mov ['[ebp+var_8C],', '0']
mov ['[ebp+var_88],', '0']
jmp ['short', 'loc_1674']
mov ['edx,', '[ebp+var_88]']
add ['edx,', '1']
mov ['[ebp+var_88],', 'edx']
mov ['eax,', 'ds:_ctrlbox']
mov ['ecx,', '[ebp+var_88]']
cmp ['ecx,', '[eax]']
jge ['loc_17C5']
mov ['edx,', 'ds:_ctrlbox']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[ebp+var_88]']
mov ['edx,', '[eax+ecx*4]']
mov ['[ebp+var_90],', 'edx']
mov ['eax,', '[ebp+var_90]']
mov ['ecx,', '[eax]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jnz ['short', 'loc_16B0']
jmp ['short', 'loc_1665']
cmp ['[ebp+var_8C],', '0']
jz ['short', 'loc_16D9']
mov ['eax,', '[ebp+var_8C]']
push ['eax']
mov ['ecx,', '[ebp+var_90]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_ctrl_path_compare']
add ['esp,', '8']
mov ['[ebp+var_134],', 'eax']
jmp ['short', 'loc_16E3']
mov ['[ebp+var_134],', '0']
mov ['eax,', '[ebp+var_134]']
mov ['[ebp+var_98],', 'eax']
cmp ['[ebp+var_98],', '7FFFFFFFh']
jnz ['short', 'loc_1700']
jmp ['loc_1665']
mov ['ecx,', '[ebp+var_90]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_ctrl_path_elements']
add ['esp,', '4']
sub ['eax,', '1']
cmp ['[ebp+var_98],', 'eax']
jz ['short', 'loc_1733']
push ['1E0h']
push ['offset', '$SG90502']
push ['offset', '$SG90503']
call ['__wassert']
add ['esp,', '0Ch']
push ['2Fh']
mov ['ecx,', '[ebp+var_90]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_strrchr']
add ['esp,', '8']
mov ['[ebp+Str],', 'eax']
cmp ['[ebp+Str],', '0']
jnz ['short', 'loc_1765']
mov ['eax,', '[ebp+var_90]']
mov ['ecx,', '[eax]']
mov ['[ebp+Str],', 'ecx']
jmp ['short', 'loc_1774']
mov ['edx,', '[ebp+Str]']
add ['edx,', '1']
mov ['[ebp+Str],', 'edx']
mov ['eax,', '[ebp+var_90]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+var_98]']
push ['eax']
lea ['ecx,', '[ebp+var_24]']
push ['ecx']
call ['_treeview_insert']
add ['esp,', '10h']
mov ['[ebp+var_94],', 'eax']
cmp ['[ebp+lParam],', '0']
jnz ['short', 'loc_17B2']
mov ['edx,', '[ebp+var_94]']
mov ['[ebp+lParam],', 'edx']
mov ['eax,', '[ebp+var_90]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_8C],', 'ecx']
jmp ['loc_1665']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+lParam]']
push ['edx']
push ['9']
push ['110Bh']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_A0],', '0']
jmp ['short', 'loc_1801']
mov ['ecx,', '[ebp+var_A0]']
add ['ecx,', '1']
mov ['[ebp+var_A0],', 'ecx']
mov ['edx,', '[ebp+var_A0]']
push ['edx']
push ['offset', '_ctrls_panel']
call ['_winctrl_findbyindex']
add ['esp,', '8']
mov ['[ebp+var_A4],', 'eax']
cmp ['[ebp+var_A4],', '0']
jz ['short', 'loc_1849']
mov ['eax,', '[ebp+var_A4]']
cmp ['dword', 'ptr', '[eax],', '0']
jz ['short', 'loc_1847']
push ['offset', '_dp']
mov ['ecx,', '[ebp+var_A4]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_dlg_set_focus']
add ['esp,', '8']
jmp ['short', 'loc_1849']
jmp ['short', 'loc_17F2']
mov ['esi,', 'esp']
push ['1']
push ['0FFFFFFEBh']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_1B88']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__ReleaseCapture@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['ds:dword_C8,', '0']
jz ['short', 'loc_1898']
xor ['ecx,', 'ecx']
cmp ['ds:dword_CC,', '0']
setnz ['cl']
push ['ecx']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['_SaneEndDialog']
add ['esp,', '8']
jmp ['loc_1B86']
mov ['eax,', '[ebp+arg_8]']
and ['eax,', '0FFFFh']
movzx ['ecx,', 'ax']
cmp ['ecx,', '3F0h']
jnz ['loc_1AA4']
mov ['edx,', '[ebp+arg_C]']
cmp ['dword', 'ptr', '[edx+8],', '0FFFFFE6Eh']
jnz ['loc_1AA4']
mov ['esi,', 'esp']
push ['0']
push ['9']
push ['110Ah']
mov ['eax,', '[ebp+arg_C]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_A8],', 'eax']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['0Bh']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_A8]']
mov ['[ebp+var_D0],', 'eax']
lea ['ecx,', '[ebp+var_11C]']
mov ['[ebp+var_C4],', 'ecx']
mov ['[ebp+var_C0],', '40h']
mov ['[ebp+var_D4],', '5']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_D4]']
push ['edx']
push ['0']
push ['110Ch']
mov ['eax,', '[ebp+arg_C]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
push ['offset', '_ctrls_panel']
call ['_winctrl_findbyindex']
add ['esp,', '8']
mov ['[ebp+var_12C],', 'eax']
cmp ['[ebp+var_12C],', '0']
jz ['loc_1A36']
mov ['[ebp+var_124],', '0']
jmp ['short', 'loc_198D']
mov ['edx,', '[ebp+var_124]']
add ['edx,', '1']
mov ['[ebp+var_124],', 'edx']
mov ['eax,', '[ebp+var_12C]']
mov ['ecx,', '[ebp+var_124]']
cmp ['ecx,', '[eax+8]']
jge ['short', 'loc_19E8']
mov ['edx,', '[ebp+var_12C]']
mov ['eax,', '[edx+4]']
add ['eax,', '[ebp+var_124]']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetDlgItem@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_128],', 'eax']
cmp ['[ebp+var_128],', '0']
jz ['short', 'loc_19E6']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_128]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DestroyWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_197E']
mov ['eax,', '[ebp+var_12C]']
push ['eax']
push ['offset', '_dp']
call ['_winctrl_rem_shortcuts']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_12C]']
push ['ecx']
push ['offset', '_ctrls_panel']
call ['_winctrl_remove']
add ['esp,', '8']
mov ['edx,', '[ebp+var_12C]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_12C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_1950']
mov ['edx,', '[ebp+var_B0]']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['_create_controls']
add ['esp,', '8']
push ['offset', '_dp']
push ['0']
call ['_dlg_refresh']
add ['esp,', '8']
mov ['esi,', 'esp']
push ['0']
push ['1']
push ['0Bh']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
push ['0']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__InvalidateRect@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_C]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetFocus@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_1B88']
jmp ['loc_1B86']
mov ['esi,', 'esp']
push ['0FFFFFFEBh']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetWindowLongA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '1']
jnz ['short', 'loc_1B17']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
push ['offset', '_dp']
call ['_winctrl_handle_command']
add ['esp,', '10h']
mov ['[ebp+var_2C],', 'eax']
cmp ['ds:dword_C8,', '0']
jz ['short', 'loc_1B15']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetCapture@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '[ebp+hWnd]']
jz ['short', 'loc_1B15']
xor ['eax,', 'eax']
cmp ['ds:dword_CC,', '0']
setnz ['al']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['_SaneEndDialog']
add ['esp,', '8']
jmp ['short', 'loc_1B1E']
mov ['[ebp+var_2C],', '0']
mov ['eax,', '[ebp+var_2C]']
jmp ['short', 'loc_1B88']
mov ['edx,', '[ebp+arg_C]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
push ['offset', '_dp']
call ['_winctrl_context_help']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_1B50']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBeep@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_1B86']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['_quit_help']
add ['esp,', '4']
push ['0']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['_SaneEndDialog']
add ['esp,', '8']
xor ['eax,', 'eax']
jmp ['short', 'loc_1B88']
cmp ['[ebp+arg_8],', '2']
jnz ['short', 'loc_1B82']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['_force_normal']
add ['esp,', '4']
xor ['eax,', 'eax']
jmp ['short', 'loc_1B88']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN52']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '134h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['10h']
endp
_SaneEndDialog  proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+dwNewLong]']
push ['eax']
push ['22h']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
push ['1Eh']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SetWindowLongA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_treeview_insert proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '58h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_58]']
mov ['ecx,', '16h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
cmp ['[ebp+arg_4],', '0']
jle ['short', 'loc_1C93']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+eax*4]']
mov ['[ebp+var_58],', 'edx']
jmp ['short', 'loc_1C9A']
mov ['[ebp+var_58],', '0FFFF0000h']
mov ['eax,', '[ebp+var_58]']
mov ['[ebp+lParam],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+ecx*4+4]']
mov ['[ebp+var_44],', 'eax']
mov ['[ebp+var_40],', '5']
mov ['ecx,', '[ebp+Str]']
mov ['[ebp+var_30],', 'ecx']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '1']
mov ['[ebp+var_2C],', 'eax']
mov ['eax,', '[ebp+arg_C]']
mov ['[ebp+var_1C],', 'eax']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+lParam]']
push ['ecx']
push ['0']
push ['1100h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_54],', 'eax']
cmp ['[ebp+arg_4],', '0']
jle ['short', 'loc_1D2C']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+ecx*4]']
push ['eax']
xor ['ecx,', 'ecx']
cmp ['[ebp+arg_4],', '1']
setle ['cl']
add ['ecx,', '1']
push ['ecx']
push ['1102h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendMessageA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_54]']
mov ['[edx+ecx*4+4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '1']
mov ['[ebp+var_50],', 'ecx']
jmp ['short', 'loc_1D4D']
mov ['edx,', '[ebp+var_50]']
add ['edx,', '1']
mov ['[ebp+var_50],', 'edx']
cmp ['[ebp+var_50],', '4']
jge ['short', 'loc_1D63']
mov ['eax,', '[ebp+var_50]']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+eax*4+4],', '0']
jmp ['short', 'loc_1D44']
mov ['eax,', '[ebp+var_54]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '58h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_create_controls proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '44h']
push ['edi']
lea ['edi,', '[ebp+var_44]']
mov ['ecx,', '11h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_4]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_1DF1']
push ['0EBh']
push ['3']
push ['3']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
lea ['eax,', '[ebp+var_28]']
push ['eax']
call ['_ctlposinit']
add ['esp,', '14h']
mov ['[ebp+var_40],', 'offset', '_ctrls_base']
mov ['[ebp+var_38],', '3F1h']
jmp ['short', 'loc_1E15']
push ['0Dh']
push ['3']
push ['64h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
lea ['edx,', '[ebp+var_28]']
push ['edx']
call ['_ctlposinit']
add ['esp,', '14h']
mov ['[ebp+var_40],', 'offset', '_ctrls_panel']
mov ['[ebp+var_38],', '411h']
mov ['[ebp+var_30],', '0FFFFFFFFh']
mov ['eax,', '[ebp+var_30]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', 'ds:_ctrlbox']
push ['edx']
call ['_ctrl_find_path']
add ['esp,', '0Ch']
mov ['[ebp+var_30],', 'eax']
cmp ['[ebp+var_30],', '0']
jl ['short', 'loc_1E6C']
mov ['eax,', 'ds:_ctrlbox']
mov ['ecx,', '[eax+8]']
mov ['edx,', '[ebp+var_30]']
mov ['eax,', '[ecx+edx*4]']
mov ['[ebp+var_44],', 'eax']
lea ['ecx,', '[ebp+var_38]']
push ['ecx']
mov ['edx,', '[ebp+var_44]']
push ['edx']
lea ['eax,', '[ebp+var_28]']
push ['eax']
mov ['ecx,', '[ebp+var_40]']
push ['ecx']
push ['offset', '_dp']
call ['_winctrl_layout']
add ['esp,', '14h']
jmp ['short', 'loc_1E1C']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN10_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '44h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_reconfig    proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
push ['eax']
call ['_conf_copy']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
call ['_ctrl_new_box']
mov ['ds:_ctrlbox,', 'eax']
push ['2']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
push ['1']
mov ['ecx,', 'ds:_ctrlbox']
push ['ecx']
call ['_setup_config_box']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_C]']
push ['edx']
push ['1']
call ['_has_help']
push ['eax']
push ['offset', '_dp']
mov ['eax,', 'ds:_ctrlbox']
push ['eax']
call ['_win_setup_config_box']
add ['esp,', '14h']
push ['offset', '_dp']
call ['_dp_init']
add ['esp,', '4']
push ['offset', '_ctrls_base']
call ['_winctrl_init']
add ['esp,', '4']
push ['offset', '_ctrls_panel']
call ['_winctrl_init']
add ['esp,', '4']
push ['offset', '_ctrls_base']
push ['offset', '_dp']
call ['_dp_add_tree']
add ['esp,', '8']
push ['offset', '_ctrls_panel']
push ['offset', '_dp']
call ['_dp_add_tree']
add ['esp,', '8']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG90597']
call ['_dupprintf']
add ['esp,', '8']
mov ['ds:lpString,', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_appname']
push ['edx']
push ['offset', '$SG90598']
call ['_dupprintf']
add ['esp,', '8']
mov ['ds:dword_2C,', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:_conf']
mov ['ds:dword_30,', 'eax']
push ['offset', '_dp']
call ['_dlg_auto_set_fixed_pitch_flag']
add ['esp,', '4']
mov ['ds:byte_A3,', '1']
push ['offset', '_GenericMainDlgProc@16']
push ['0']
push ['offset', 'byte_66']
mov ['ecx,', 'dword', 'ptr', 'ds:_hinst']
push ['ecx']
call ['_SaneDialogBox']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
mov ['edx,', 'ds:_ctrlbox']
push ['edx']
call ['_ctrl_free_box']
add ['esp,', '4']
push ['offset', '_ctrls_base']
call ['_winctrl_cleanup']
add ['esp,', '4']
push ['offset', '_ctrls_panel']
call ['_winctrl_cleanup']
add ['esp,', '4']
push ['offset', '_dp']
call ['_dp_cleanup']
add ['esp,', '4']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_203F']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_conf']
push ['ecx']
call ['_conf_copy_into']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_conf_free']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_logevent       proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '88h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_88]']
mov ['ecx,', '22h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_logctx']
push ['ecx']
call ['_log_eventlog']
add ['esp,', '8']
mov ['edx,', 'ds:_nevents']
cmp ['edx,', 'ds:_negsize']
jl ['short', 'loc_20DA']
mov ['eax,', 'ds:_negsize']
add ['eax,', '40h']
mov ['ds:_negsize,', 'eax']
push ['4']
mov ['ecx,', 'ds:_negsize']
push ['ecx']
mov ['edx,', 'ds:_events']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ds:_events,', 'eax']
lea ['eax,', '[ebp+var_88]']
push ['eax']
call ['_ltime']
add ['esp,', '4']
mov ['ecx,', '9']
mov ['esi,', 'eax']
lea ['edi,', '[ebp+Tm]']
rep ['movsd']
lea ['ecx,', '[ebp+Tm]']
push ['ecx']
push ['offset', '$SG90615']
push ['28h']
lea ['edx,', '[ebp+Buf]']
push ['edx']
call ['_strftime']
add ['esp,', '10h']
push ['1']
lea ['eax,', '[ebp+Buf]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['esi,', 'eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
lea ['edx,', '[esi+eax+1]']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', 'ds:_nevents']
mov ['edx,', 'ds:_events']
mov ['[edx+ecx*4],', 'eax']
lea ['eax,', '[ebp+Buf]']
push ['eax']
mov ['ecx,', 'ds:_nevents']
mov ['edx,', 'ds:_events']
mov ['eax,', '[edx+ecx*4]']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', 'ds:_nevents']
mov ['eax,', 'ds:_events']
mov ['ecx,', '[eax+edx*4]']
push ['ecx']
call ['_strcat']
add ['esp,', '8']
cmp ['dword', 'ptr', 'ds:_logbox,', '0']
jz ['loc_2208']
mov ['esi,', 'esp']
mov ['edx,', 'ds:_nevents']
mov ['eax,', 'ds:_events']
mov ['ecx,', '[eax+edx*4]']
push ['ecx']
push ['0']
push ['180h']
push ['3E9h']
mov ['edx,', 'dword', 'ptr', 'ds:_logbox']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendDlgItemMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['18Bh']
push ['3E9h']
mov ['eax,', 'dword', 'ptr', 'ds:_logbox']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendDlgItemMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_64],', 'eax']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+var_64]']
sub ['ecx,', '1']
push ['ecx']
push ['197h']
push ['3E9h']
mov ['edx,', 'dword', 'ptr', 'ds:_logbox']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendDlgItemMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', 'ds:_nevents']
add ['eax,', '1']
mov ['ds:_nevents,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN8_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '88h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_showeventlog   proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
cmp ['dword', 'ptr', 'ds:_logbox,', '0']
jnz ['short', 'loc_22C5']
mov ['esi,', 'esp']
push ['0']
push ['offset', '_LogProc@16']
mov ['eax,', '[ebp+hWndParent]']
push ['eax']
push ['offset', 'byte_6E']
mov ['ecx,', 'dword', 'ptr', 'ds:_hinst']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__CreateDialogParamA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['dword', 'ptr', 'ds:_logbox,', 'eax']
mov ['esi,', 'esp']
push ['1']
mov ['edx,', 'dword', 'ptr', 'ds:_logbox']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__ShowWindow@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', 'dword', 'ptr', 'ds:_logbox']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetActiveWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_LogProc@16     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '34h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_34]']
mov ['ecx,', '0Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_30],', 'eax']
cmp ['[ebp+var_30],', '10h']
jz ['loc_266F']
cmp ['[ebp+var_30],', '110h']
jz ['short', 'loc_232A']
cmp ['[ebp+var_30],', '111h']
jz ['loc_23DC']
jmp ['loc_26B3']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '$SG90209']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpString],', 'eax']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+lpString]']
push ['edx']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetWindowTextA@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+lpString]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['offset', '?tabs@?4??LogProc@@9@9']
push ['2']
push ['192h']
push ['3E9h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendDlgItemMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_239A']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', 'ds:_nevents']
jge ['short', 'loc_23D2']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', 'ds:_events']
mov ['ecx,', '[eax+edx*4]']
push ['ecx']
push ['0']
push ['180h']
push ['3E9h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendDlgItemMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_2391']
mov ['eax,', '1']
jmp ['loc_26B5']
mov ['eax,', '[ebp+arg_8]']
and ['eax,', '0FFFFh']
movzx ['ecx,', 'ax']
mov ['[ebp+var_34],', 'ecx']
cmp ['[ebp+var_34],', '0']
jle ['loc_266B']
cmp ['[ebp+var_34],', '2']
jle ['short', 'loc_2408']
cmp ['[ebp+var_34],', '3EAh']
jz ['short', 'loc_244F']
jmp ['loc_266B']
mov ['dword', 'ptr', 'ds:_logbox,', '0']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetParent@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetActiveWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__DestroyWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_26B5']
mov ['ecx,', '[ebp+arg_8]']
shr ['ecx,', '10h']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
test ['edx,', 'edx']
jz ['short', 'loc_2479']
mov ['eax,', '[ebp+arg_8]']
shr ['eax,', '10h']
and ['eax,', '0FFFFh']
movzx ['ecx,', 'ax']
cmp ['ecx,', '5']
jnz ['loc_2667']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['190h']
push ['3E9h']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__SendDlgItemMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+wParam],', 'eax']
cmp ['[ebp+wParam],', '0']
jnz ['short', 'loc_24B9']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBeep@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_266B']
push ['4']
mov ['eax,', '[ebp+wParam]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+lParam],', 'eax']
cmp ['[ebp+lParam],', '0']
jz ['loc_2667']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+lParam]']
push ['ecx']
mov ['edx,', '[ebp+wParam]']
push ['edx']
push ['191h']
push ['3E9h']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendDlgItemMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '0']
jnz ['short', 'loc_2518']
mov ['esi,', 'esp']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBeep@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_266B']
mov ['[ebp+var_1C],', '0']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_2531']
mov ['ecx,', '[ebp+var_18]']
add ['ecx,', '1']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', '[ebp+var_18]']
cmp ['edx,', '[ebp+var_14]']
jge ['short', 'loc_255F']
mov ['eax,', '[ebp+var_18]']
mov ['ecx,', '[ebp+lParam]']
mov ['edx,', '[ecx+eax*4]']
mov ['eax,', 'ds:_events']
mov ['ecx,', '[eax+edx*4]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['edx,', '[ebp+var_1C]']
lea ['eax,', '[edx+eax+2]']
mov ['[ebp+var_1C],', 'eax']
jmp ['short', 'loc_2528']
push ['1']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_20],', 'eax']
cmp ['[ebp+var_20],', '0']
jz ['loc_2619']
mov ['edx,', '[ebp+var_20]']
mov ['[ebp+Dst],', 'edx']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_2592']
mov ['eax,', '[ebp+var_18]']
add ['eax,', '1']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[ebp+var_18]']
cmp ['ecx,', '[ebp+var_14]']
jge ['short', 'loc_25F9']
mov ['edx,', '[ebp+var_18]']
mov ['eax,', '[ebp+lParam]']
mov ['ecx,', '[eax+edx*4]']
mov ['edx,', 'ds:_events']
mov ['eax,', '[edx+ecx*4]']
mov ['[ebp+Str],', 'eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+Size],', 'eax']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+Dst]']
add ['edx,', '[ebp+Size]']
mov ['[ebp+Dst],', 'edx']
push ['2']
push ['offset', '?sel_nl@?8??LogProc@@9@9']
mov ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Dst]']
add ['ecx,', '2']
mov ['[ebp+Dst],', 'ecx']
jmp ['short', 'loc_2589']
push ['1']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
mov ['eax,', '[ebp+var_20]']
push ['eax']
push ['0']
call ['_write_aclip']
add ['esp,', '10h']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+lParam]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_2637']
mov ['eax,', '[ebp+var_18]']
add ['eax,', '1']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[ebp+var_18]']
cmp ['ecx,', 'ds:_nevents']
jge ['short', 'loc_2667']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_18]']
push ['edx']
push ['0']
push ['185h']
push ['3E9h']
mov ['eax,', '[ebp+hWnd]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SendDlgItemMessageA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_262E']
xor ['eax,', 'eax']
jmp ['short', 'loc_26B5']
xor ['eax,', 'eax']
jmp ['short', 'loc_26B5']
mov ['dword', 'ptr', 'ds:_logbox,', '0']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+hWnd]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetParent@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__SetActiveWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+hWnd]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__DestroyWindow@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['short', 'loc_26B5']
xor ['eax,', 'eax']
pop ['edi']
pop ['esi']
add ['esp,', '34h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['10h']
endp
_showabout      proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['esi,', 'esp']
push ['0']
push ['offset', '_AboutProc@16']
mov ['eax,', '[ebp+hWndParent]']
push ['eax']
push ['offset', 'TemplateName']
mov ['ecx,', 'dword', 'ptr', 'ds:_hinst']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__DialogBoxParamA@20']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_verify_ssh_host_key proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1Ch']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_10]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_verify_host_key']
add ['esp,', '10h']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_2758']
mov ['eax,', '1']
jmp ['loc_2908']
jmp ['loc_2906']
cmp ['[ebp+var_4],', '2']
jnz ['loc_2839']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
mov ['edx,', '[ebp+arg_14]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '?wrongmsg@?1??verify_ssh_host_key@@9@9']
call ['_dupprintf']
add ['esp,', '14h']
mov ['[ebp+var_C],', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_appname']
push ['edx']
push ['offset', '?mbtitle@?1??verify_ssh_host_key@@9@9']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_10],', 'eax']
push ['2']
push ['233h']
mov ['eax,', '[ebp+var_10]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_message_box']
add ['esp,', '10h']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '6']
jz ['short', 'loc_27E2']
cmp ['[ebp+var_8],', '7']
jz ['short', 'loc_27E2']
cmp ['[ebp+var_8],', '2']
jz ['short', 'loc_27E2']
push ['321h']
push ['offset', '$SG90669']
push ['offset', '$SG90670']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+var_8],', '6']
jnz ['short', 'loc_2824']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_store_host_key']
add ['esp,', '10h']
mov ['eax,', '1']
jmp ['loc_2908']
jmp ['short', 'loc_2834']
cmp ['[ebp+var_8],', '7']
jnz ['short', 'loc_2834']
mov ['eax,', '1']
jmp ['loc_2908']
jmp ['loc_2906']
cmp ['[ebp+var_4],', '1']
jnz ['loc_2906']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
mov ['ecx,', '[ebp+arg_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
push ['offset', '?absentmsg@?1??verify_ssh_host_key@@9@9']
call ['_dupprintf']
add ['esp,', '10h']
mov ['[ebp+var_18],', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '?mbtitle@?1??verify_ssh_host_key@@9@9']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_1C],', 'eax']
push ['1']
push ['233h']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
mov ['edx,', '[ebp+var_18]']
push ['edx']
call ['_message_box']
add ['esp,', '10h']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '6']
jz ['short', 'loc_28BA']
cmp ['[ebp+var_14],', '7']
jz ['short', 'loc_28BA']
cmp ['[ebp+var_14],', '2']
jz ['short', 'loc_28BA']
push ['330h']
push ['offset', '$SG90680']
push ['offset', '$SG90681']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+var_14],', '6']
jnz ['short', 'loc_28F9']
mov ['eax,', '[ebp+arg_10]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_store_host_key']
add ['esp,', '10h']
mov ['eax,', '1']
jmp ['short', 'loc_2908']
jmp ['short', 'loc_2906']
cmp ['[ebp+var_14],', '7']
jnz ['short', 'loc_2906']
mov ['eax,', '1']
jmp ['short', 'loc_2908']
xor ['eax,', 'eax']
add ['esp,', '1Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_askalg         proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+lpCaption],', '0CCCCCCCCh']
mov ['[ebp+lpText],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
push ['offset', '?msg@?1??askalg@@9@9']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+lpText],', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_appname']
push ['edx']
push ['offset', '?mbtitle@?1??askalg@@9@9']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpCaption],', 'eax']
mov ['esi,', 'esp']
push ['134h']
mov ['eax,', '[ebp+lpCaption]']
push ['eax']
mov ['ecx,', '[ebp+lpText]']
push ['ecx']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', 'eax']
call ['_socket_reselect_all']
mov ['edx,', '[ebp+lpText]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+lpCaption]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+var_C],', '6']
jnz ['short', 'loc_29B0']
mov ['eax,', '1']
jmp ['short', 'loc_29B2']
jmp ['short', 'loc_29B2']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_askappend      proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+lpCaption],', '0CCCCCCCCh']
mov ['[ebp+lpText],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
push ['104h']
push ['offset', '?msgtemplate@?1??askappend@@9@9']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+lpText],', 'eax']
mov ['edx,', 'dword', 'ptr', 'ds:_appname']
push ['edx']
push ['offset', '$SG90728']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpCaption],', 'eax']
mov ['esi,', 'esp']
push ['223h']
mov ['eax,', '[ebp+lpCaption]']
push ['eax']
mov ['ecx,', '[ebp+lpText]']
push ['ecx']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', 'eax']
call ['_socket_reselect_all']
mov ['edx,', '[ebp+lpText]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+lpCaption]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+var_C],', '6']
jnz ['short', 'loc_2A63']
mov ['eax,', '2']
jmp ['short', 'loc_2A74']
jmp ['short', 'loc_2A74']
cmp ['[ebp+var_C],', '7']
jnz ['short', 'loc_2A72']
mov ['eax,', '1']
jmp ['short', 'loc_2A74']
jmp ['short', 'loc_2A74']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_old_keyfile_warning proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+lpCaption],', '0CCCCCCCCh']
mov ['[ebp+lpText],', '0CCCCCCCCh']
mov ['eax,', 'dword', 'ptr', 'ds:_appname']
push ['eax']
push ['offset', '?message@?1??old_keyfile_warning@@9@9']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpText],', 'eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_appname']
push ['ecx']
push ['offset', '?mbtitle@?1??old_keyfile_warning@@9@9']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+lpCaption],', 'eax']
mov ['esi,', 'esp']
push ['0']
mov ['edx,', '[ebp+lpCaption]']
push ['edx']
mov ['eax,', '[ebp+lpText]']
push ['eax']
push ['0']
call ['dword', 'ptr', 'ds:__imp__MessageBoxA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
call ['_socket_reselect_all']
mov ['ecx,', '[ebp+lpText]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+lpCaption]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
