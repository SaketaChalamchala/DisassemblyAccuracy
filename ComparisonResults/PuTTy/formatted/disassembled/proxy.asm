_proxy_activate proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+44h],', '0']
mov ['esi,', 'esp']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+18h]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '24h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
mov ['esi,', 'eax']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '18h']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['[ebp+var_1C],', 'esi']
mov ['[ebp+var_20],', '0']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '24h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jle ['short', 'loc_7F1']
lea ['ecx,', '[ebp+var_14]']
push ['ecx']
lea ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '24h']
push ['eax']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+0Ch]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '[ebp+var_20]']
mov ['[ebp+var_20],', 'eax']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '24h']
push ['ecx']
call ['_bufchain_consume']
add ['esp,', '8']
jmp ['short', 'loc_784']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '18h']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jle ['short', 'loc_85E']
lea ['eax,', '[ebp+var_14]']
push ['eax']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '18h']
push ['edx']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+8]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '[ebp+var_20]']
mov ['[ebp+var_20],', 'eax']
mov ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '18h']
push ['eax']
call ['_bufchain_consume']
add ['esp,', '8']
jmp ['short', 'loc_7F1']
mov ['ecx,', '[ebp+var_20]']
cmp ['ecx,', '[ebp+var_1C]']
jge ['short', 'loc_88A']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_20]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+0Ch]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+30h],', '0']
jz ['short', 'loc_8B3']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+14h]']
call ['eax']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+40h],', '0']
jz ['short', 'loc_8DC']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+10h]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+48h],', '0']
jnz ['short', 'loc_901']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+18h]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN14']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_proxy_plug  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['[ebp+var_8],', 'edx']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_98A']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+0Ch],', 'ecx']
mov ['eax,', '[ebp+var_8]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_proxy_close proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+10h]']
push ['edx']
call ['_sk_addr_free']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_proxy_write proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+44h],', '0']
jz ['short', 'loc_A3B']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '18h']
push ['ecx']
call ['_bufchain_add']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '18h']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
jmp ['short', 'loc_A63']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+8]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_proxy_write_oob proc near           
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+44h],', '0']
jz ['short', 'loc_ACD']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '18h']
push ['edx']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '24h']
push ['eax']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '24h']
push ['eax']
call ['_bufchain_add']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_8]']
jmp ['short', 'loc_AF5']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+0Ch]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_proxy_write_eof proc near           
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+44h],', '0']
jz ['short', 'loc_B2F']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+40h],', '1']
jmp ['short', 'loc_B4F']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+10h]']
call ['edx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_proxy_flush proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+44h],', '0']
jz ['short', 'loc_B8F']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+30h],', '1']
jmp ['short', 'loc_BAF']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+14h]']
call ['edx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_proxy_set_frozen proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '228h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_228]']
mov ['ecx,', '8Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+44h],', '0']
jz ['short', 'loc_C0C']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+48h],', 'eax']
jmp ['loc_D14']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '34h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jle ['loc_CF0']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+48h],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+48h],', '0']
jnz ['loc_CE5']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '34h']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jle ['loc_CE5']
lea ['eax,', '[ebp+Size]']
push ['eax']
lea ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '34h']
push ['edx']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
cmp ['[ebp+Size],', '200h']
jbe ['short', 'loc_C80']
mov ['[ebp+Size],', '200h']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
lea ['edx,', '[ebp+Dst]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+Size]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '34h']
push ['ecx']
call ['_bufchain_consume']
add ['esp,', '8']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+Size]']
push ['edx']
lea ['eax,', '[ebp+Dst]']
push ['eax']
push ['0']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+8]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_C2C']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+48h],', '0']
jz ['short', 'loc_CF0']
jmp ['short', 'loc_D14']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+18h]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN13_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '228h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_proxy_socket_error proc near        
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jnz ['short', 'loc_DAC']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jnz ['short', 'loc_DB4']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+4]']
jmp ['short', 'loc_DD4']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+1Ch]']
call ['eax']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_plug_proxy_log proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_8],', 'edx']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_14]']
push ['eax']
mov ['ecx,', '[ebp+arg_10]']
push ['ecx']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax]']
call ['ecx']
add ['esp,', '18h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_plug_proxy_closing proc near           
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax+44h],', '0']
jz ['short', 'loc_EBC']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+50h],', 'edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+54h],', 'ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+arg_C]']
mov ['[edx+58h],', 'eax']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+4Ch]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_EE8']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_plug_proxy_receive proc near           
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax+44h],', '0']
jz ['short', 'loc_F73']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '34h']
push ['eax']
call ['_bufchain_add']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+5Ch],', 'edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+60h],', 'ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+arg_C]']
mov ['[edx+64h],', 'eax']
mov ['esi,', 'esp']
push ['2']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+4Ch]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_F9F']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+8]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_plug_proxy_sent proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax+44h],', '0']
jz ['short', 'loc_100A']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+68h],', 'edx']
mov ['esi,', 'esp']
push ['1']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+4Ch]']
call ['edx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_102E']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+0Ch]']
call ['eax']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_plug_proxy_accepting proc near         
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax+44h],', '0']
jz ['short', 'loc_10A3']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+6Ch],', 'edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+70h],', 'ecx']
mov ['esi,', 'esp']
push ['3']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+4Ch]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_10CB']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+10h]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_proxy_for_destination proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '60h']
push ['edi']
lea ['edi,', '[ebp+var_60]']
mov ['ecx,', '18h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['[ebp+var_C],', '0']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_1133']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sk_address_is_special_local']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_1133']
xor ['eax,', 'eax']
jmp ['loc_13FC']
push ['0Ch']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1172']
mov ['edx,', '[ebp+Str1]']
push ['edx']
call ['_sk_hostname_is_local']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_116B']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_1172']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sk_address_is_local']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_1172']
xor ['eax,', 'eax']
jmp ['loc_13FC']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_119B']
push ['40h']
lea ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_sk_getaddr']
add ['esp,', '0Ch']
lea ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_58],', 'eax']
jmp ['short', 'loc_11A2']
mov ['[ebp+var_58],', '0']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_5C],', 'eax']
push ['0Ah']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_60],', 'eax']
mov ['eax,', '[ebp+var_60]']
add ['eax,', '[ebp+var_8]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['loc_13F7']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_8]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['short', 'loc_120F']
mov ['ecx,', '[ebp+var_60]']
add ['ecx,', '[ebp+var_8]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
push ['edx']
call ['_isspace']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_1204']
mov ['eax,', '[ebp+var_60]']
add ['eax,', '[ebp+var_8]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '2Ch']
jnz ['short', 'loc_120F']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
jmp ['short', 'loc_11D3']
mov ['eax,', '[ebp+var_60]']
add ['eax,', '[ebp+var_8]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_1221']
jmp ['loc_13F7']
mov ['edx,', '[ebp+var_8]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_60]']
add ['eax,', '[ebp+var_C]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_127F']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_C]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
push ['eax']
call ['_isalnum']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_1274']
mov ['ecx,', '[ebp+var_60]']
add ['ecx,', '[ebp+var_C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '2Dh']
jz ['short', 'loc_1274']
mov ['eax,', '[ebp+var_60]']
add ['eax,', '[ebp+var_C]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '2Eh']
jz ['short', 'loc_1274']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_C]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '2Ah']
jnz ['short', 'loc_127F']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '1']
mov ['[ebp+var_C],', 'ecx']
jmp ['short', 'loc_1227']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_8]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '2Ah']
jnz ['short', 'loc_1306']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_12C7']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', '[ebp+var_8]']
sub ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+var_60]']
lea ['ecx,', '[eax+edx+1]']
push ['ecx']
mov ['edx,', '[ebp+var_58]']
lea ['eax,', '[ebp+edx+Str]']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', '[ebp+var_8]']
sub ['ecx,', '1']
sub ['eax,', 'ecx']
push ['eax']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_12FA']
mov ['edx,', '[ebp+var_C]']
sub ['edx,', '[ebp+var_8]']
sub ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_60]']
lea ['edx,', '[ecx+eax+1]']
push ['edx']
mov ['eax,', '[ebp+Str1]']
add ['eax,', '[ebp+var_5C]']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', '[ebp+var_8]']
sub ['ecx,', '1']
sub ['eax,', 'ecx']
push ['eax']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_1301']
xor ['eax,', 'eax']
jmp ['loc_13FC']
jmp ['loc_13B0']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_C]']
movsx ['eax,', 'byte', 'ptr', '[edx-1]']
cmp ['eax,', '2Ah']
jnz ['short', 'loc_1366']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_133C']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', '[ebp+var_8]']
sub ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_8]']
push ['edx']
lea ['eax,', '[ebp+Str]']
push ['eax']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_135D']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', '[ebp+var_8]']
sub ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_1364']
xor ['eax,', 'eax']
jmp ['loc_13FC']
jmp ['short', 'loc_13B0']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_138E']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_8]']
push ['edx']
lea ['eax,', '[ebp+Str]']
push ['eax']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_138E']
xor ['eax,', 'eax']
jmp ['short', 'loc_13FC']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_13B0']
xor ['eax,', 'eax']
jmp ['short', 'loc_13FC']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_60]']
add ['edx,', '[ebp+var_8]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['short', 'loc_13F2']
mov ['ecx,', '[ebp+var_60]']
add ['ecx,', '[ebp+var_8]']
movzx ['edx,', 'byte', 'ptr', '[ecx]']
push ['edx']
call ['_isspace']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_13F2']
mov ['eax,', '[ebp+var_60]']
add ['eax,', '[ebp+var_8]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '2Ch']
jz ['short', 'loc_13F2']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
jmp ['short', 'loc_13B6']
jmp ['loc_11C2']
mov ['eax,', '1']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN33']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '60h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_name_lookup    proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['0Dh']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_14CE']
push ['0Bh']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_1495']
push ['0Bh']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_14CE']
push ['0Dh']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['eax,', '1']
jz ['short', 'loc_14CE']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+Str1]']
push ['eax']
push ['0']
call ['_proxy_for_destination']
add ['esp,', '10h']
test ['eax,', 'eax']
jz ['short', 'loc_14CE']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_dupstr']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_8]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_sk_nonamelookup']
add ['esp,', '4']
jmp ['short', 'loc_14E2']
mov ['ecx,', '[ebp+arg_10]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_sk_namelookup']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_new_connection proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
push ['0Dh']
mov ['eax,', '[ebp+arg_20]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_17E8']
mov ['ecx,', '[ebp+arg_20]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+Str1]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_proxy_for_destination']
add ['esp,', '10h']
test ['eax,', 'eax']
jz ['loc_17E8']
mov ['edx,', '[ebp+arg_20]']
push ['edx']
mov ['eax,', '[ebp+arg_1C]']
push ['eax']
mov ['ecx,', '[ebp+arg_18]']
push ['ecx']
mov ['edx,', '[ebp+arg_14]']
push ['edx']
mov ['eax,', '[ebp+arg_10]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+Str1]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_platform_new_connection']
add ['esp,', '24h']
mov ['[ebp+var_1C],', 'eax']
cmp ['[ebp+var_1C],', '0']
jz ['short', 'loc_158F']
mov ['eax,', '[ebp+var_1C]']
jmp ['loc_180C']
push ['88h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx],', 'offset', '?socket_fn_table@?1??new_connection@@9@9']
mov ['eax,', '[ebp+arg_20]']
push ['eax']
call ['_conf_copy']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+74h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_1C]']
mov ['[edx+0Ch],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['[ecx+10h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+14h],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+30h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+40h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+48h],', '0']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '34h']
push ['eax']
call ['_bufchain_init']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '18h']
push ['ecx']
call ['_bufchain_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '24h']
push ['edx']
call ['_bufchain_init']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+8],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+44h],', '0FFFFFFFFh']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4Ch],', '0']
push ['0Dh']
mov ['eax,', '[ebp+arg_20]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_20],', 'eax']
cmp ['[ebp+var_20],', '3']
jnz ['short', 'loc_166D']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4Ch],', 'offset', '_proxy_http_negotiate']
jmp ['short', 'loc_16B5']
cmp ['[ebp+var_20],', '1']
jnz ['short', 'loc_167F']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4Ch],', 'offset', '_proxy_socks4_negotiate']
jmp ['short', 'loc_16B5']
cmp ['[ebp+var_20],', '2']
jnz ['short', 'loc_1691']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+4Ch],', 'offset', '_proxy_socks5_negotiate']
jmp ['short', 'loc_16B5']
cmp ['[ebp+var_20],', '4']
jnz ['short', 'loc_16A3']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4Ch],', 'offset', '_proxy_telnet_negotiate']
jmp ['short', 'loc_16B5']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4],', 'offset', '$SG85889']
mov ['eax,', '[ebp+var_4]']
jmp ['loc_180C']
push ['8']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax],', 'offset', '?plug_fn_table@?1??new_connection@@9@9']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx+4],', 'edx']
push ['3']
mov ['eax,', '[ebp+arg_20]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
lea ['ecx,', '[ebp+var_14]']
push ['ecx']
push ['0Eh']
mov ['edx,', '[ebp+arg_20]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
call ['_sk_namelookup']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_sk_addr_error']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_173D']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', 'offset', '$SG85895']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_sk_addr_free']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
jmp ['loc_180C']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
push ['0Fh']
mov ['ecx,', '[ebp+arg_20]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
push ['eax']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_sk_new']
add ['esp,', '1Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+8],', 'eax']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+1Ch]']
call ['ecx']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_17A7']
mov ['eax,', '[ebp+var_4]']
jmp ['short', 'loc_180C']
mov ['esi,', 'esp']
push ['0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+18h]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0FFFFFFFFh']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4Ch]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
jmp ['short', 'loc_180C']
mov ['edx,', '[ebp+arg_1C]']
push ['edx']
mov ['eax,', '[ebp+arg_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_10]']
push ['edx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_sk_new']
add ['esp,', '1Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN17']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_new_listener   proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_14]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_sk_newlistener']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_proxy_http_negotiate proc near         
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '268h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_268]']
mov ['ecx,', '9Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+44h],', '0FFFFFFFFh']
jnz ['loc_1B4C']
push ['200h']
lea ['ecx,', '[ebp+var_20C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
push ['eax']
call ['_sk_getaddr']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
push ['edx']
lea ['eax,', '[ebp+var_20C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
push ['edx']
lea ['eax,', '[ebp+var_20C]']
push ['eax']
push ['offset', '$SG85938']
call ['_dupprintf']
add ['esp,', '14h']
mov ['[ebp+Str],', 'eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['eax']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
push ['10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+74h]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_214],', 'eax']
push ['11h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_218],', 'eax']
mov ['edx,', '[ebp+var_214]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jnz ['short', 'loc_198C']
mov ['ecx,', '[ebp+var_218]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['loc_1B14']
mov ['eax,', '[ebp+var_218]']
push ['eax']
mov ['ecx,', '[ebp+var_214]']
push ['ecx']
push ['offset', '$SG85946']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_21C],', 'eax']
mov ['edx,', '[ebp+var_21C]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_22C],', 'eax']
push ['1']
mov ['eax,', '[ebp+var_22C]']
shl ['eax,', '2']
cdq
mov ['ecx,', '3']
idiv ['ecx']
add ['eax,', '64h']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Dest],', 'eax']
push ['offset', '$SG85949']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_sprintf']
add ['esp,', '8']
mov ['[ebp+var_224],', '0']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_228],', 'eax']
jmp ['short', 'loc_1A3A']
mov ['ecx,', '[ebp+var_224]']
add ['ecx,', '3']
mov ['[ebp+var_224],', 'ecx']
mov ['edx,', '[ebp+var_228]']
add ['edx,', '4']
mov ['[ebp+var_228],', 'edx']
mov ['eax,', '[ebp+var_224]']
cmp ['eax,', '[ebp+var_22C]']
jge ['short', 'loc_1AA5']
mov ['ecx,', '[ebp+var_22C]']
sub ['ecx,', '[ebp+var_224]']
cmp ['ecx,', '3']
jle ['short', 'loc_1A65']
mov ['[ebp+var_268],', '3']
jmp ['short', 'loc_1A77']
mov ['edx,', '[ebp+var_22C]']
sub ['edx,', '[ebp+var_224]']
mov ['[ebp+var_268],', 'edx']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '[ebp+var_228]']
push ['eax']
mov ['ecx,', '[ebp+var_268]']
push ['ecx']
mov ['edx,', '[ebp+var_21C]']
add ['edx,', '[ebp+var_224]']
push ['edx']
call ['_base64_encode_atom']
add ['esp,', '0Ch']
jmp ['loc_1A1C']
push ['offset', '$SG85954']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '[ebp+var_228]']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['eax']
mov ['edx,', '[ebp+Dest]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_21C]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['2']
push ['offset', '$SG85955']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+8]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+44h],', '1']
xor ['eax,', 'eax']
jmp ['loc_1FF0']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_1B8C']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+58h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+54h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+50h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_1FF0']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_1B99']
xor ['eax,', 'eax']
jmp ['loc_1FF0']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_1BD2']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+10h]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_1FF0']
cmp ['[ebp+arg_4],', '2']
jnz ['loc_1FBF']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+44h],', '1']
jnz ['loc_1E4C']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '34h']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
mov ['[ebp+var_238],', 'eax']
cmp ['[ebp+var_238],', '0']
jg ['short', 'loc_1C1E']
push ['273h']
push ['offset', '$SG85969']
push ['offset', '$SG85970']
call ['__wassert']
add ['esp,', '0Ch']
push ['1']
mov ['ecx,', '[ebp+var_238]']
add ['ecx,', '1']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Src],', 'eax']
mov ['edx,', '[ebp+var_238]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '34h']
push ['ecx']
call ['_bufchain_fetch']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+Src]']
add ['edx,', '[ebp+var_238]']
mov ['byte', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+var_238]']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
call ['_get_line_end']
add ['esp,', '8']
mov ['[ebp+var_23C],', 'eax']
cmp ['[ebp+var_23C],', '0']
jge ['short', 'loc_1CA2']
mov ['edx,', '[ebp+Src]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['loc_1FF0']
mov ['[ebp+var_25C],', '0FFFFFFFFh']
lea ['eax,', '[ebp+var_25C]']
push ['eax']
lea ['ecx,', '[ebp+var_244]']
push ['ecx']
lea ['edx,', '[ebp+var_250]']
push ['edx']
push ['offset', '$SG85977']
mov ['eax,', '[ebp+Src]']
push ['eax']
call ['_sscanf']
add ['esp,', '14h']
cmp ['eax,', '2']
jl ['short', 'loc_1CE3']
cmp ['[ebp+var_25C],', '0FFFFFFFFh']
jnz ['short', 'loc_1D28']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG85978']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['loc_1FF0']
mov ['edx,', '[ebp+var_23C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '34h']
push ['eax']
call ['_bufchain_consume']
add ['esp,', '8']
mov ['ecx,', '[ebp+Src]']
add ['ecx,', '[ebp+var_25C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '32h']
jz ['loc_1E33']
mov ['eax,', '[ebp+Src]']
add ['eax,', '[ebp+var_23C]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+var_23C]']
cmp ['ecx,', '[ebp+var_25C]']
jle ['short', 'loc_1DBD']
mov ['edx,', '[ebp+Src]']
add ['edx,', '[ebp+var_23C]']
movsx ['eax,', 'byte', 'ptr', '[edx-1]']
cmp ['eax,', '0Dh']
jz ['short', 'loc_1D9D']
mov ['ecx,', '[ebp+Src]']
add ['ecx,', '[ebp+var_23C]']
movsx ['edx,', 'byte', 'ptr', '[ecx-1]']
cmp ['edx,', '0Ah']
jnz ['short', 'loc_1DBD']
mov ['eax,', '[ebp+var_23C]']
sub ['eax,', '1']
mov ['[ebp+var_23C],', 'eax']
mov ['ecx,', '[ebp+Src]']
add ['ecx,', '[ebp+var_23C]']
mov ['byte', 'ptr', '[ecx],', '0']
jmp ['short', 'loc_1D65']
mov ['edx,', '[ebp+Src]']
add ['edx,', '[ebp+var_25C]']
push ['edx']
push ['offset', '$SG85985']
call ['_dupprintf']
add ['esp,', '8']
mov ['[ebp+var_264],', 'eax']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
mov ['eax,', '[ebp+var_264]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_264]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+Src]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['loc_1FF0']
mov ['eax,', '[ebp+Src]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+44h],', '2']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+44h],', '2']
jnz ['loc_1FBF']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '34h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
mov ['[ebp+var_238],', 'eax']
cmp ['[ebp+var_238],', '0']
jg ['short', 'loc_1E8E']
push ['2A9h']
push ['offset', '$SG85988']
push ['offset', '$SG85989']
call ['__wassert']
add ['esp,', '0Ch']
push ['1']
mov ['edx,', '[ebp+var_238]']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Src],', 'eax']
mov ['eax,', '[ebp+Src]']
mov ['[ebp+var_234],', 'eax']
mov ['ecx,', '[ebp+var_238]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '34h']
push ['eax']
call ['_bufchain_fetch']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_238]']
push ['ecx']
mov ['edx,', '[ebp+var_234]']
push ['edx']
call ['_get_line_end']
add ['esp,', '8']
mov ['[ebp+var_23C],', 'eax']
cmp ['[ebp+var_23C],', '0']
jge ['short', 'loc_1F0C']
mov ['eax,', '[ebp+Src]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['loc_1FF0']
cmp ['[ebp+var_23C],', '2']
jle ['short', 'loc_1F6D']
mov ['ecx,', '[ebp+var_23C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '34h']
push ['edx']
call ['_bufchain_consume']
add ['esp,', '8']
mov ['eax,', '[ebp+var_234]']
add ['eax,', '[ebp+var_23C]']
mov ['[ebp+var_234],', 'eax']
mov ['ecx,', '[ebp+var_238]']
sub ['ecx,', '[ebp+var_23C]']
mov ['[ebp+var_238],', 'ecx']
mov ['edx,', '[ebp+var_238]']
push ['edx']
mov ['eax,', '[ebp+var_234]']
push ['eax']
call ['_get_line_end']
add ['esp,', '8']
mov ['[ebp+var_23C],', 'eax']
jmp ['short', 'loc_1F0C']
cmp ['[ebp+var_23C],', '2']
jnz ['short', 'loc_1FA9']
push ['2']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '34h']
push ['ecx']
call ['_bufchain_consume']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_proxy_activate']
add ['esp,', '4']
mov ['eax,', '[ebp+Src]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['short', 'loc_1FF0']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['short', 'loc_1FF0']
mov ['esi,', 'esp']
push ['0']
push ['1F41h']
push ['offset', '$SG85997']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN35']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '268h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_get_line_end   proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
mov ['eax,', '[ebp+var_4]']
cmp ['eax,', '[ebp+arg_4]']
jge ['short', 'loc_20F6']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '[ebp+var_4]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '0Ah']
jnz ['short', 'loc_20EB']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '2']
jg ['short', 'loc_20B4']
mov ['eax,', '[ebp+var_4]']
jmp ['short', 'loc_20F9']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '1']
cmp ['ecx,', '[ebp+arg_4]']
jge ['short', 'loc_20E2']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '[ebp+var_4]']
movsx ['eax,', 'byte', 'ptr', '[edx+1]']
cmp ['eax,', '20h']
jz ['short', 'loc_20E2']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '[ebp+var_4]']
movsx ['edx,', 'byte', 'ptr', '[ecx+1]']
cmp ['edx,', '9']
jz ['short', 'loc_20E2']
mov ['eax,', '[ebp+var_4]']
jmp ['short', 'loc_20F9']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '1']
mov ['[ebp+var_4],', 'ecx']
jmp ['short', 'loc_208A']
or ['eax,', '0FFFFFFFFh']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_proxy_socks4_negotiate proc near       
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '240h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_240]']
mov ['ecx,', '90h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+44h],', '0FFFFFFFFh']
jnz ['loc_2312']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
push ['edx']
call ['_sk_addrtype']
add ['esp,', '4']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '2']
jnz ['short', 'loc_216D']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+4],', 'offset', '$SG86012']
mov ['eax,', '1']
jmp ['loc_253A']
jmp ['loc_21F0']
cmp ['[ebp+var_C],', '1']
jnz ['short', 'loc_218F']
mov ['[ebp+Size],', '0']
lea ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
push ['eax']
call ['_sk_addrcopy']
add ['esp,', '8']
jmp ['short', 'loc_21F0']
cmp ['[ebp+var_C],', '3']
jz ['short', 'loc_21AC']
push ['2EEh']
push ['offset', '$SG86017']
push ['offset', '$SG86018']
call ['__wassert']
add ['esp,', '0Ch']
push ['200h']
lea ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
call ['_sk_getaddr']
add ['esp,', '0Ch']
lea ['edx,', '[ebp+Str]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '1']
mov ['[ebp+Size],', 'eax']
mov ['[ebp+var_1A],', '0']
mov ['al,', '[ebp+var_1A]']
mov ['[ebp+var_1B],', 'al']
mov ['cl,', '[ebp+var_1B]']
mov ['[ebp+Src],', 'cl']
mov ['[ebp+var_19],', '1']
push ['10h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+74h]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+Source],', 'eax']
mov ['ecx,', '[ebp+Source]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['edx,', '[ebp+Size]']
lea ['eax,', '[eax+edx+9]']
mov ['[ebp+var_8],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_14],', 'eax']
mov ['edx,', '[ebp+Source]']
push ['edx']
mov ['eax,', '[ebp+var_14]']
add ['eax,', '8']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_14]']
mov ['byte', 'ptr', '[ecx],', '4']
mov ['edx,', '[ebp+var_14]']
mov ['byte', 'ptr', '[edx+1],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
sar ['ecx,', '8']
movsx ['edx,', 'cl']
and ['edx,', '0FFh']
mov ['eax,', '[ebp+var_14]']
mov ['[eax+2],', 'dl']
mov ['ecx,', '[ebp+arg_0]']
movsx ['edx,', 'byte', 'ptr', '[ecx+14h]']
and ['edx,', '0FFh']
mov ['eax,', '[ebp+var_14]']
mov ['[eax+3],', 'dl']
push ['4']
lea ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '4']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+Size]']
push ['eax']
lea ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+Source]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_14]']
lea ['edx,', '[ecx+eax+9]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+8]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+Source]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_14]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+44h],', '1']
xor ['eax,', 'eax']
jmp ['loc_253A']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_2352']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+58h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+54h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_253A']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_235F']
xor ['eax,', 'eax']
jmp ['loc_253A']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_2398']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+10h]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_253A']
cmp ['[ebp+arg_4],', '2']
jnz ['loc_2509']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+44h],', '1']
jnz ['loc_2509']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '34h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
cmp ['eax,', '8']
jge ['short', 'loc_23CD']
mov ['eax,', '1']
jmp ['loc_253A']
push ['8']
lea ['edx,', '[ebp+var_238]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '34h']
push ['eax']
call ['_bufchain_fetch']
add ['esp,', '0Ch']
movsx ['ecx,', '[ebp+var_238]']
test ['ecx,', 'ecx']
jz ['short', 'loc_2426']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86031']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_253A']
movsx ['edx,', '[ebp+var_237]']
cmp ['edx,', '5Ah']
jz ['loc_24E5']
mov ['al,', '[ebp+var_237]']
mov ['[ebp+var_240],', 'al']
cmp ['[ebp+var_240],', '5Ch']
jz ['short', 'loc_2456']
cmp ['[ebp+var_240],', '5Dh']
jz ['short', 'loc_2484']
jmp ['short', 'loc_24B2']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86038']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_24DE']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86040']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_24DE']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86042']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['short', 'loc_253A']
push ['8']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '34h']
push ['ecx']
call ['_bufchain_consume']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_proxy_activate']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['short', 'loc_253A']
mov ['esi,', 'esp']
push ['0']
push ['1F41h']
push ['offset', '$SG86043']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN26']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '240h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_proxy_socks5_negotiate proc near       
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '598h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_598]']
mov ['ecx,', '166h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+44h],', '0FFFFFFFFh']
jnz ['loc_269B']
mov ['[ebp+var_10],', '5']
push ['10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+74h]']
push ['edx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_18],', 'eax']
push ['11h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_1C],', 'eax']
mov ['edx,', '[ebp+var_18]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jnz ['short', 'loc_261C']
mov ['ecx,', '[ebp+var_1C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_2653']
mov ['[ebp+var_E],', '0']
mov ['[ebp+var_24],', '3']
lea ['eax,', '[ebp+var_24]']
push ['eax']
lea ['ecx,', '[ebp+var_10]']
push ['ecx']
call ['_proxy_socks5_offerencryptedauth']
add ['esp,', '8']
mov ['edx,', '[ebp+var_24]']
mov ['[ebp+edx+var_10],', '2']
mov ['eax,', '[ebp+var_24]']
add ['eax,', '1']
mov ['[ebp+var_24],', 'eax']
mov ['ecx,', '[ebp+var_24]']
sub ['ecx,', '2']
mov ['[ebp+var_F],', 'cl']
jmp ['short', 'loc_2662']
mov ['[ebp+var_F],', '1']
mov ['[ebp+var_E],', '0']
mov ['[ebp+var_24],', '3']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_24]']
push ['edx']
lea ['eax,', '[ebp+var_10]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+8]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+44h],', '1']
xor ['eax,', 'eax']
jmp ['loc_2FFC']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_26DB']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+58h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+54h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_2FFC']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_26E8']
xor ['eax,', 'eax']
jmp ['loc_2FFC']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_2721']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+10h]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_2FFC']
cmp ['[ebp+arg_4],', '2']
jnz ['loc_2FCB']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+44h],', '1']
jnz ['loc_2844']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '34h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
cmp ['eax,', '2']
jge ['short', 'loc_2756']
mov ['eax,', '1']
jmp ['loc_2FFC']
push ['2']
lea ['edx,', '[ebp+var_30]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '34h']
push ['eax']
call ['_bufchain_fetch']
add ['esp,', '0Ch']
movsx ['ecx,', '[ebp+var_30]']
cmp ['ecx,', '5']
jz ['short', 'loc_27AA']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86065']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2FFC']
movsx ['edx,', '[ebp+var_2F]']
test ['edx,', 'edx']
jnz ['short', 'loc_27BE']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+44h],', '2']
jmp ['short', 'loc_2833']
movsx ['ecx,', '[ebp+var_2F]']
cmp ['ecx,', '1']
jnz ['short', 'loc_27D3']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+44h],', '4']
jmp ['short', 'loc_2833']
movsx ['eax,', '[ebp+var_2F]']
cmp ['eax,', '2']
jnz ['short', 'loc_27E8']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+44h],', '5']
jmp ['short', 'loc_2833']
movsx ['edx,', '[ebp+var_2F]']
cmp ['edx,', '3']
jnz ['short', 'loc_27FD']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+44h],', '6']
jmp ['short', 'loc_2833']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86074']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2FFC']
push ['2']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '34h']
push ['ecx']
call ['_bufchain_consume']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+44h],', '7']
jnz ['loc_291C']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '34h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
cmp ['eax,', '2']
jge ['short', 'loc_286F']
mov ['eax,', '1']
jmp ['loc_2FFC']
push ['2']
lea ['ecx,', '[ebp+var_3C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '34h']
push ['edx']
call ['_bufchain_fetch']
add ['esp,', '0Ch']
movsx ['eax,', '[ebp+var_3C]']
cmp ['eax,', '1']
jz ['short', 'loc_28C3']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86079']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2FFC']
movsx ['ecx,', '[ebp+var_3B]']
test ['ecx,', 'ecx']
jz ['short', 'loc_2901']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86081']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2FFC']
push ['2']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '34h']
push ['edx']
call ['_bufchain_consume']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+44h],', '2']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+44h],', '8']
jnz ['short', 'loc_2942']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_proxy_socks5_handlechap']
add ['esp,', '4']
mov ['[ebp+var_44],', 'eax']
cmp ['[ebp+var_44],', '0']
jz ['short', 'loc_2942']
mov ['eax,', '[ebp+var_44]']
jmp ['loc_2FFC']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+44h],', '2']
jnz ['loc_2AC2']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
push ['edx']
call ['_sk_addrtype']
add ['esp,', '4']
mov ['[ebp+var_254],', 'eax']
cmp ['[ebp+var_254],', '1']
jnz ['short', 'loc_2999']
mov ['[ebp+var_250],', '0Ah']
mov ['[ebp+var_245],', '1']
lea ['eax,', '[ebp+var_244]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
push ['edx']
call ['_sk_addrcopy']
add ['esp,', '8']
jmp ['loc_2A32']
cmp ['[ebp+var_254],', '2']
jnz ['short', 'loc_29CB']
mov ['[ebp+var_250],', '16h']
mov ['[ebp+var_245],', '4']
lea ['eax,', '[ebp+var_244]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
push ['edx']
call ['_sk_addrcopy']
add ['esp,', '8']
jmp ['short', 'loc_2A32']
cmp ['[ebp+var_254],', '3']
jz ['short', 'loc_29EB']
push ['42Eh']
push ['offset', '$SG86094']
push ['offset', '$SG86095']
call ['__wassert']
add ['esp,', '0Ch']
mov ['[ebp+var_245],', '3']
push ['100h']
lea ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
push ['eax']
call ['_sk_getaddr']
add ['esp,', '0Ch']
lea ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_244],', 'al']
movsx ['edx,', '[ebp+var_244]']
add ['edx,', '7']
mov ['[ebp+var_250],', 'edx']
mov ['[ebp+var_248],', '5']
mov ['[ebp+var_247],', '1']
mov ['[ebp+var_246],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
sar ['ecx,', '8']
movsx ['edx,', 'cl']
and ['edx,', '0FFh']
mov ['eax,', '[ebp+var_250]']
mov ['[ebp+eax+var_24A],', 'dl']
mov ['ecx,', '[ebp+arg_0]']
movsx ['edx,', 'byte', 'ptr', '[ecx+14h]']
and ['edx,', '0FFh']
mov ['eax,', '[ebp+var_250]']
mov ['[ebp+eax+var_249],', 'dl']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_250]']
push ['ecx']
lea ['edx,', '[ebp+var_248]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+44h],', '3']
mov ['eax,', '1']
jmp ['loc_2FFC']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+44h],', '3']
jnz ['loc_2DAD']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '34h']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
cmp ['eax,', '5']
jge ['short', 'loc_2AED']
mov ['eax,', '1']
jmp ['loc_2FFC']
push ['5']
lea ['eax,', '[ebp+var_260]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '34h']
push ['ecx']
call ['_bufchain_fetch']
add ['esp,', '0Ch']
movsx ['edx,', '[ebp+var_260]']
cmp ['edx,', '5']
jz ['short', 'loc_2B47']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86103']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2FFC']
movsx ['eax,', '[ebp+var_25F]']
test ['eax,', 'eax']
jz ['loc_2CC0']
push ['offset', '$SG86106']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
movsx ['edx,', '[ebp+var_25F]']
mov ['[ebp+var_594],', 'edx']
mov ['eax,', '[ebp+var_594]']
sub ['eax,', '1']
mov ['[ebp+var_594],', 'eax']
cmp ['[ebp+var_594],', '7']
ja ['loc_2C5C']
mov ['ecx,', '[ebp+var_594]']
jmp ['ds:$LN77[ecx*4]']
push ['offset', '$SG86112']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcat']
add ['esp,', '8']
jmp ['loc_2C88']
push ['offset', '$SG86114']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
jmp ['loc_2C88']
push ['offset', '$SG86116']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strcat']
add ['esp,', '8']
jmp ['loc_2C88']
push ['offset', '$SG86118']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcat']
add ['esp,', '8']
jmp ['loc_2C88']
push ['offset', '$SG86120']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
jmp ['short', 'loc_2C88']
push ['offset', '$SG86122']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strcat']
add ['esp,', '8']
jmp ['short', 'loc_2C88']
push ['offset', '$SG86124']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcat']
add ['esp,', '8']
jmp ['short', 'loc_2C88']
push ['offset', '$SG86126']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
jmp ['short', 'loc_2C88']
movsx ['ecx,', '[ebp+var_25F]']
push ['ecx']
push ['offset', '$SG86128']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
lea ['eax,', '[ebp+eax+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2FFC']
mov ['[ebp+var_268],', '6']
mov ['dl,', '[ebp+var_25D]']
mov ['[ebp+var_598],', 'dl']
cmp ['[ebp+var_598],', '1']
jz ['short', 'loc_2CF3']
cmp ['[ebp+var_598],', '3']
jz ['short', 'loc_2D15']
cmp ['[ebp+var_598],', '4']
jz ['short', 'loc_2D04']
jmp ['short', 'loc_2D2A']
mov ['eax,', '[ebp+var_268]']
add ['eax,', '4']
mov ['[ebp+var_268],', 'eax']
jmp ['short', 'loc_2D60']
mov ['ecx,', '[ebp+var_268]']
add ['ecx,', '10h']
mov ['[ebp+var_268],', 'ecx']
jmp ['short', 'loc_2D60']
movzx ['edx,', '[ebp+var_25C]']
add ['edx,', '[ebp+var_268]']
mov ['[ebp+var_268],', 'edx']
jmp ['short', 'loc_2D60']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86138']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2FFC']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '34h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
cmp ['eax,', '[ebp+var_268]']
jge ['short', 'loc_2D81']
mov ['eax,', '1']
jmp ['loc_2FFC']
mov ['ecx,', '[ebp+var_268]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '34h']
push ['edx']
call ['_bufchain_consume']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_proxy_activate']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['loc_2FFC']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+44h],', '4']
jnz ['short', 'loc_2DEC']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86141']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2FFC']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+44h],', '5']
jnz ['loc_2F9F']
push ['10h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_374],', 'eax']
push ['11h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+74h]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_378],', 'eax']
mov ['ecx,', '[ebp+var_374]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jnz ['short', 'loc_2E45']
mov ['eax,', '[ebp+var_378]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['loc_2F6C']
mov ['edx,', '[ebp+var_374]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+Size],', 'eax']
cmp ['[ebp+Size],', '0FFh']
jle ['short', 'loc_2E70']
mov ['[ebp+Size],', '0FFh']
cmp ['[ebp+Size],', '1']
jge ['short', 'loc_2E83']
mov ['[ebp+Size],', '1']
mov ['eax,', '[ebp+var_378]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_58C],', 'eax']
cmp ['[ebp+var_58C],', '0FFh']
jle ['short', 'loc_2EAE']
mov ['[ebp+var_58C],', '0FFh']
cmp ['[ebp+var_58C],', '1']
jge ['short', 'loc_2EC1']
mov ['[ebp+var_58C],', '1']
mov ['[ebp+var_580],', '1']
mov ['cl,', 'byte', 'ptr', '[ebp+Size]']
mov ['[ebp+var_57F],', 'cl']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+var_374]']
push ['eax']
lea ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+Size]']
mov ['al,', 'byte', 'ptr', '[ebp+var_58C]']
mov ['[ebp+edx+Dst],', 'al']
mov ['ecx,', '[ebp+var_58C]']
push ['ecx']
mov ['edx,', '[ebp+var_378]']
push ['edx']
mov ['eax,', '[ebp+Size]']
lea ['ecx,', '[ebp+eax+var_57D]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_58C]']
mov ['eax,', '[ebp+Size]']
lea ['ecx,', '[eax+edx+3]']
mov ['esi,', 'esp']
push ['ecx']
lea ['edx,', '[ebp+var_580]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+44h],', '7']
jmp ['short', 'loc_2F98']
mov ['esi,', 'esp']
push ['0']
push ['1F40h']
push ['offset', '$SG86155']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['short', 'loc_2FFC']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+44h],', '6']
jnz ['short', 'loc_2FCB']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_proxy_socks5_selectchap']
add ['esp,', '4']
mov ['[ebp+var_590],', 'eax']
cmp ['[ebp+var_590],', '0']
jz ['short', 'loc_2FCB']
mov ['eax,', '[ebp+var_590]']
jmp ['short', 'loc_2FFC']
mov ['esi,', 'esp']
push ['0']
push ['1F41h']
push ['offset', '$SG86159']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN76']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '598h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_format_telnet_command proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '2A4h']
push ['edi']
lea ['edi,', '[ebp+var_2A4]']
mov ['ecx,', '0A9h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
push ['12h']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_C],', '0']
mov ['[ebp+var_10],', '0']
mov ['[ebp+var_14],', '0']
mov ['[ebp+var_18],', '0']
mov ['[ebp+var_1C],', '0']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_1C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['loc_3AD8']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '[ebp+var_1C]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_3187']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_1C]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '25h']
jz ['short', 'loc_3187']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_1C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '5Ch']
jz ['short', 'loc_3187']
mov ['eax,', '[ebp+var_1C]']
add ['eax,', '1']
mov ['[ebp+var_1C],', 'eax']
jmp ['short', 'loc_3153']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_1C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jnz ['short', 'loc_3199']
jmp ['loc_3AD8']
mov ['eax,', '[ebp+var_1C]']
cmp ['eax,', '[ebp+var_18]']
jz ['short', 'loc_3203']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '[ebp+var_1C]']
sub ['ecx,', '[ebp+var_18]']
cmp ['[ebp+var_14],', 'ecx']
jge ['short', 'loc_31D6']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ebp+var_1C]']
sub ['edx,', '[ebp+var_18]']
add ['edx,', '200h']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_31A1']
mov ['eax,', '[ebp+var_1C]']
sub ['eax,', '[ebp+var_18]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_18]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_10]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_1C]']
sub ['eax,', '[ebp+var_18]']
add ['eax,', '[ebp+var_10]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', '[ebp+var_1C]']
add ['edx,', '1']
mov ['[ebp+var_1C],', 'edx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '[ebp+var_1C]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_3224']
jmp ['loc_3AD8']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_18]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '5Ch']
jnz ['loc_35C9']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_1C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
mov ['[ebp+var_2A4],', 'edx']
mov ['eax,', '[ebp+var_2A4]']
sub ['eax,', '25h']
mov ['[ebp+var_2A4],', 'eax']
cmp ['[ebp+var_2A4],', '53h']
ja ['$LN60']
mov ['ecx,', '[ebp+var_2A4]']
movzx ['edx,', 'ds:$LN121[ecx]']
jmp ['ds:$LN127[edx*4]']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '1']
cmp ['[ebp+var_14],', 'eax']
jge ['short', 'loc_32A1']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '201h']
mov ['[ebp+var_14],', 'ecx']
push ['1']
mov ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['ecx,', 'ecx']
jnz ['short', '$LN103']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_10]']
mov ['byte', 'ptr', '[edx],', '5Ch']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '1']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
add ['ecx,', '1']
mov ['[ebp+var_1C],', 'ecx']
jmp ['loc_35C4']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
cmp ['[ebp+var_14],', 'edx']
jge ['short', 'loc_32F0']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '201h']
mov ['[ebp+var_14],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['eax,', 'eax']
jnz ['short', '$LN98']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '[ebp+var_10]']
mov ['byte', 'ptr', '[ecx],', '25h']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_1C]']
add ['eax,', '1']
mov ['[ebp+var_1C],', 'eax']
jmp ['loc_35C4']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '1']
cmp ['[ebp+var_14],', 'ecx']
jge ['short', 'loc_3340']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '201h']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', '$LN93']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '[ebp+var_10]']
mov ['byte', 'ptr', '[eax],', '0Dh']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '1']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_1C]']
add ['edx,', '1']
mov ['[ebp+var_1C],', 'edx']
jmp ['loc_35C4']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '1']
cmp ['[ebp+var_14],', 'eax']
jge ['short', 'loc_3390']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '201h']
mov ['[ebp+var_14],', 'ecx']
push ['1']
mov ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['ecx,', 'ecx']
jnz ['short', '$LN88']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_10]']
mov ['byte', 'ptr', '[edx],', '0Ah']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '1']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
add ['ecx,', '1']
mov ['[ebp+var_1C],', 'ecx']
jmp ['loc_35C4']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
cmp ['[ebp+var_14],', 'edx']
jge ['short', 'loc_33DF']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '201h']
mov ['[ebp+var_14],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['eax,', 'eax']
jnz ['short', '$LN83']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '[ebp+var_10]']
mov ['byte', 'ptr', '[ecx],', '9']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_1C]']
add ['eax,', '1']
mov ['[ebp+var_1C],', 'eax']
jmp ['loc_35C4']
mov ['[ebp+var_1D],', '0']
mov ['[ebp+var_24],', '0']
mov ['ecx,', '[ebp+var_1C]']
add ['ecx,', '1']
mov ['[ebp+var_1C],', 'ecx']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_1C]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '30h']
jl ['short', 'loc_344C']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_1C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '39h']
jg ['short', 'loc_344C']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '[ebp+var_1C]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
movzx ['edx,', '[ebp+var_1D]']
lea ['eax,', '[edx+ecx-30h]']
mov ['[ebp+var_1D],', 'al']
jmp ['loc_34FC']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_1C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
cmp ['edx,', '61h']
jl ['short', 'loc_347E']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '[ebp+var_1C]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '66h']
jg ['short', 'loc_347E']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_1C]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
movzx ['ecx,', '[ebp+var_1D]']
lea ['edx,', '[ecx+eax-57h]']
mov ['[ebp+var_1D],', 'dl']
jmp ['short', 'loc_34FC']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '[ebp+var_1C]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '41h']
jl ['short', 'loc_34B0']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_1C]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '46h']
jg ['short', 'loc_34B0']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_1C]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
movzx ['eax,', '[ebp+var_1D]']
lea ['ecx,', '[eax+edx-37h]']
mov ['[ebp+var_1D],', 'cl']
jmp ['short', 'loc_34FC']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
cmp ['[ebp+var_14],', 'edx']
jge ['short', 'loc_34DB']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '201h']
mov ['[ebp+var_14],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['eax,', 'eax']
jnz ['short', 'loc_34B0']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '[ebp+var_10]']
mov ['byte', 'ptr', '[ecx],', '5Ch']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_18]']
add ['eax,', '1']
mov ['[ebp+var_1C],', 'eax']
jmp ['short', 'loc_3568']
cmp ['[ebp+var_24],', '1']
jnz ['short', 'loc_3551']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '1']
cmp ['[ebp+var_14],', 'ecx']
jge ['short', 'loc_352E']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '201h']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_3502']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '[ebp+var_10]']
mov ['cl,', '[ebp+var_1D]']
mov ['[eax],', 'cl']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_1C]']
add ['eax,', '1']
mov ['[ebp+var_1C],', 'eax']
jmp ['short', 'loc_3568']
mov ['ecx,', '[ebp+var_24]']
add ['ecx,', '1']
mov ['[ebp+var_24],', 'ecx']
mov ['dl,', '[ebp+var_1D]']
shl ['dl,', '4']
mov ['[ebp+var_1D],', 'dl']
jmp ['loc_340E']
jmp ['short', 'loc_35C4']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '2']
cmp ['[ebp+var_14],', 'eax']
jge ['short', 'loc_3596']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '202h']
mov ['[ebp+var_14],', 'ecx']
push ['1']
mov ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['ecx,', 'ecx']
jnz ['short', '$LN60']
push ['2']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_18]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '[ebp+var_10]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '2']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_1C]']
add ['edx,', '1']
mov ['[ebp+var_1C],', 'edx']
jmp ['loc_3ACD']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '[ebp+var_1C]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '25h']
jnz ['short', 'loc_3626']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
cmp ['[ebp+var_14],', 'edx']
jge ['short', 'loc_3602']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '201h']
mov ['[ebp+var_14],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['eax,', 'eax']
jnz ['short', 'loc_35D7']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '[ebp+var_10]']
mov ['byte', 'ptr', '[ecx],', '25h']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_1C]']
add ['eax,', '1']
mov ['[ebp+var_1C],', 'eax']
jmp ['loc_3ACD']
push ['4']
push ['offset', '$SG86281']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_1C]']
push ['ecx']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_36E2']
push ['200h']
lea ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sk_getaddr']
add ['esp,', '0Ch']
lea ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+Size],', 'eax']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ebp+Size]']
cmp ['[ebp+var_14],', 'edx']
jge ['short', 'loc_36A7']
mov ['eax,', '[ebp+Size]']
mov ['ecx,', '[ebp+var_10]']
lea ['edx,', '[ecx+eax+200h]']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_3671']
mov ['eax,', '[ebp+Size]']
push ['eax']
lea ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_10]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '[ebp+Size]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
add ['ecx,', '4']
mov ['[ebp+var_1C],', 'ecx']
jmp ['loc_3ACD']
push ['4']
push ['offset', '$SG86293']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_1C]']
push ['edx']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_3793']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['offset', '$SG86296']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_241],', 'al']
movsx ['edx,', '[ebp+var_241]']
add ['edx,', '[ebp+var_10]']
cmp ['[ebp+var_14],', 'edx']
jge ['short', 'loc_3756']
movsx ['eax,', '[ebp+var_241]']
mov ['ecx,', '[ebp+var_10]']
lea ['edx,', '[ecx+eax+200h]']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_371E']
movsx ['eax,', '[ebp+var_241]']
push ['eax']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_10]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
movsx ['eax,', '[ebp+var_241]']
add ['eax,', '[ebp+var_10]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
add ['ecx,', '4']
mov ['[ebp+var_1C],', 'ecx']
jmp ['loc_3ACD']
push ['4']
push ['offset', '$SG86306']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_1C]']
push ['edx']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_384B']
push ['10h']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_248],', 'eax']
mov ['ecx,', '[ebp+var_248]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_24C],', 'eax']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ebp+var_24C]']
cmp ['[ebp+var_14],', 'edx']
jge ['short', 'loc_3810']
mov ['eax,', '[ebp+var_24C]']
mov ['ecx,', '[ebp+var_10]']
lea ['edx,', '[ecx+eax+200h]']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_37DA']
mov ['eax,', '[ebp+var_24C]']
push ['eax']
mov ['ecx,', '[ebp+var_248]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_10]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '[ebp+var_24C]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
add ['ecx,', '4']
mov ['[ebp+var_1C],', 'ecx']
jmp ['loc_3ACD']
push ['4']
push ['offset', '$SG86318']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_1C]']
push ['edx']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_3903']
push ['11h']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_250],', 'eax']
mov ['ecx,', '[ebp+var_250]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_254],', 'eax']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ebp+var_254]']
cmp ['[ebp+var_14],', 'edx']
jge ['short', 'loc_38C8']
mov ['eax,', '[ebp+var_254]']
mov ['ecx,', '[ebp+var_10]']
lea ['edx,', '[ecx+eax+200h]']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_3892']
mov ['eax,', '[ebp+var_254]']
push ['eax']
mov ['ecx,', '[ebp+var_250]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_10]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '[ebp+var_254]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
add ['ecx,', '4']
mov ['[ebp+var_1C],', 'ecx']
jmp ['loc_3ACD']
push ['9']
push ['offset', '$SG86330']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_1C]']
push ['edx']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_39BB']
push ['0Eh']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_258],', 'eax']
mov ['ecx,', '[ebp+var_258]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_25C],', 'eax']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ebp+var_25C]']
cmp ['[ebp+var_14],', 'edx']
jge ['short', 'loc_3980']
mov ['eax,', '[ebp+var_25C]']
mov ['ecx,', '[ebp+var_10]']
lea ['edx,', '[ecx+eax+200h]']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_394A']
mov ['eax,', '[ebp+var_25C]']
push ['eax']
mov ['ecx,', '[ebp+var_258]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_10]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '[ebp+var_25C]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
add ['ecx,', '9']
mov ['[ebp+var_1C],', 'ecx']
jmp ['loc_3ACD']
push ['9']
push ['offset', '$SG86342']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+var_1C]']
push ['edx']
call ['_strnicmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_3A8B']
push ['0Fh']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_260],', 'eax']
mov ['ecx,', '[ebp+var_260]']
push ['ecx']
push ['offset', '$SG86346']
lea ['edx,', '[ebp+Src]']
push ['edx']
call ['_sprintf']
add ['esp,', '0Ch']
lea ['eax,', '[ebp+Src]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_2A0],', 'eax']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '[ebp+var_2A0]']
cmp ['[ebp+var_14],', 'ecx']
jge ['short', 'loc_3A53']
mov ['edx,', '[ebp+var_2A0]']
mov ['eax,', '[ebp+var_10]']
lea ['ecx,', '[eax+edx+200h]']
mov ['[ebp+var_14],', 'ecx']
push ['1']
mov ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['ecx,', 'ecx']
jnz ['short', 'loc_3A1D']
mov ['edx,', '[ebp+var_2A0]']
push ['edx']
lea ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '[ebp+var_10]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ebp+var_2A0]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_1C]']
add ['eax,', '9']
mov ['[ebp+var_1C],', 'eax']
jmp ['short', 'loc_3ACD']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '1']
cmp ['[ebp+var_14],', 'ecx']
jge ['short', 'loc_3AB7']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '201h']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_3A8B']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '[ebp+var_10]']
mov ['byte', 'ptr', '[eax],', '25h']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '1']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_1C]']
mov ['[ebp+var_18],', 'edx']
jmp ['loc_3142']
mov ['eax,', '[ebp+var_1C]']
cmp ['eax,', '[ebp+var_18]']
jz ['short', 'loc_3B42']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '[ebp+var_1C]']
sub ['ecx,', '[ebp+var_18]']
cmp ['[ebp+var_14],', 'ecx']
jge ['short', 'loc_3B15']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '[ebp+var_1C]']
sub ['edx,', '[ebp+var_18]']
add ['edx,', '200h']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_3AE0']
mov ['eax,', '[ebp+var_1C]']
sub ['eax,', '[ebp+var_18]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '[ebp+var_18]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
add ['edx,', '[ebp+var_10]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_1C]']
sub ['eax,', '[ebp+var_18]']
add ['eax,', '[ebp+var_10]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '1']
cmp ['[ebp+var_14],', 'ecx']
jge ['short', 'loc_3B6E']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '201h']
mov ['[ebp+var_14],', 'edx']
push ['1']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
xor ['edx,', 'edx']
jnz ['short', 'loc_3B42']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '[ebp+var_10]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['eax,', '[ebp+var_C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN126']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '2A4h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_proxy_telnet_negotiate proc near       
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+Str],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+44h],', '0FFFFFFFFh']
jnz ['short', 'loc_3CEB']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+74h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
push ['eax']
call ['_format_telnet_command']
add ['esp,', '0Ch']
mov ['[ebp+Str],', 'eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['eax']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+44h],', '1']
xor ['eax,', 'eax']
jmp ['loc_3DB8']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_3D2B']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+58h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+54h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_3DB8']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_3D38']
xor ['eax,', 'eax']
jmp ['loc_3DB8']
cmp ['[ebp+arg_4],', '3']
jnz ['short', 'loc_3D6E']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+10h]']
call ['edx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_3DB8']
cmp ['[ebp+arg_4],', '2']
jnz ['short', 'loc_3D87']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_proxy_activate']
add ['esp,', '4']
mov ['eax,', '1']
jmp ['short', 'loc_3DB8']
mov ['esi,', 'esp']
push ['0']
push ['1F41h']
push ['offset', '$SG86388']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
