_ser_setup_config_box proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_4],', '0']
jnz ['loc_415']
push ['offset', '$SG86349']
push ['offset', '$SG86350']
push ['offset', '$SG86351']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_ctrl_getset']
add ['esp,', '10h']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_C],', '0']
jmp ['short', 'loc_30D']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '1']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_C]']
cmp ['eax,', '[edx+10h]']
jge ['loc_415']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[edx+eax*4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[edx],', '2']
jnz ['loc_410']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax+10h],', 'offset', '_config_protocolbuttons_handler']
jnz ['loc_410']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+24h]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_8]']
mov ['[eax+24h],', 'edx']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+20h]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_8]']
mov ['[eax+20h],', 'edx']
push ['4']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+24h]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
mov ['[edx+28h],', 'eax']
push ['offset', '$SG86359']
call ['_dupstr']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+24h]']
mov ['ecx,', '[ebp+var_8]']
mov ['ecx,', '[ecx+28h]']
mov ['[ecx+edx*4-4],', 'eax']
push ['4']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+24h]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+30h]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
mov ['[ecx+30h],', 'eax']
push ['4']
call ['_I']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
mov ['ecx,', '[edx+24h]']
mov ['edx,', '[ebp+var_8]']
mov ['edx,', '[edx+30h]']
mov ['[edx+ecx*4-4],', 'eax']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax+2Ch],', '0']
jz ['short', 'loc_410']
push ['1']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+24h]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+2Ch]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
mov ['[edx+2Ch],', 'eax']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+24h]']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+2Ch]']
mov ['byte', 'ptr', '[ecx+eax-1],', '72h']
jmp ['loc_304']
push ['offset', '$SG86367']
push ['offset', '$SG86368']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ctrl_settitle']
add ['esp,', '0Ch']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_48D']
push ['offset', '$SG86370']
push ['offset', '$SG86371']
push ['offset', '$SG86372']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_ctrl_getset']
add ['esp,', '10h']
mov ['[ebp+var_4],', 'eax']
push ['1']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['37h']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['offset', '_conf_editbox_handler']
push ['offset', '$SG86373']
call ['_P']
add ['esp,', '4']
push ['eax']
push ['28h']
push ['6Ch']
push ['offset', '$SG86374']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ctrl_editbox']
add ['esp,', '20h']
push ['offset', '$SG86375']
push ['offset', '$SG86376']
push ['offset', '$SG86377']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_ctrl_getset']
add ['esp,', '10h']
mov ['[ebp+var_4],', 'eax']
push ['0FFFFFFFFh']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['38h']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['offset', '_conf_editbox_handler']
push ['offset', '$SG86378']
call ['_P']
add ['esp,', '4']
push ['eax']
push ['28h']
push ['73h']
push ['offset', '$SG86379']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ctrl_editbox']
add ['esp,', '20h']
push ['0FFFFFFFFh']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['39h']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['offset', '_conf_editbox_handler']
push ['offset', '$SG86380']
call ['_P']
add ['esp,', '4']
push ['eax']
push ['28h']
push ['62h']
push ['offset', '$SG86381']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ctrl_editbox']
add ['esp,', '20h']
push ['0FFFFFFFEh']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['3Ah']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['offset', '_conf_editbox_handler']
push ['offset', '$SG86382']
call ['_P']
add ['esp,', '4']
push ['eax']
push ['28h']
push ['74h']
push ['offset', '$SG86383']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_ctrl_editbox']
add ['esp,', '20h']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['offset', '_serial_parity_handler']
push ['offset', '$SG86384']
call ['_P']
add ['esp,', '4']
push ['eax']
push ['28h']
push ['70h']
push ['offset', '$SG86385']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_ctrl_droplist']
add ['esp,', '1Ch']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
call ['_I']
add ['esp,', '4']
push ['eax']
push ['offset', '_serial_flow_handler']
push ['offset', '$SG86386']
call ['_P']
add ['esp,', '4']
push ['eax']
push ['28h']
push ['66h']
push ['offset', '$SG86387']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_ctrl_droplist']
add ['esp,', '1Ch']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_serial_parity_handler proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+var_10],', 'edx']
cmp ['[ebp+arg_C],', '0']
jnz ['loc_73E']
push ['3Bh']
mov ['eax,', '[ebp+var_10]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_14],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_update_start']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_dlg_listbox_clear']
add ['esp,', '8']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_661']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
cmp ['[ebp+var_8],', '5']
jnb ['short', 'loc_69E']
mov ['eax,', '1']
mov ['ecx,', '[ebp+var_8]']
shl ['eax,', 'cl']
and ['eax,', '[ebp+var_4]']
jz ['short', 'loc_69C']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', 'ds:dword_274[ecx*8]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', 'ds:?parities@?1??serial_parity_handler@@9@9[eax*8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_dlg_listbox_addwithid']
add ['esp,', '10h']
jmp ['short', 'loc_658']
mov ['[ebp+var_C],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'ecx']
jmp ['short', 'loc_6B6']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
cmp ['[ebp+var_8],', '5']
jnb ['short', 'loc_6FB']
mov ['eax,', '1']
mov ['ecx,', '[ebp+var_8]']
shl ['eax,', 'cl']
and ['eax,', '[ebp+var_4]']
jz ['short', 'loc_6F9']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+var_14]']
cmp ['edx,', 'ds:dword_274[ecx*8]']
jnz ['short', 'loc_6F0']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_listbox_select']
add ['esp,', '0Ch']
jmp ['short', 'loc_6FB']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '1']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_6AD']
cmp ['[ebp+var_8],', '5']
jnz ['short', 'loc_71A']
push ['0']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_listbox_select']
add ['esp,', '0Ch']
mov ['[ebp+var_14],', '0']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_dlg_update_done']
add ['esp,', '8']
mov ['edx,', '[ebp+var_14]']
push ['edx']
push ['3Bh']
mov ['eax,', '[ebp+var_10]']
push ['eax']
call ['_conf_set_int']
add ['esp,', '0Ch']
jmp ['short', 'loc_78F']
cmp ['[ebp+arg_C],', '3']
jnz ['short', 'loc_78F']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_listbox_index']
add ['esp,', '8']
mov ['[ebp+var_18],', 'eax']
cmp ['[ebp+var_18],', '0']
jge ['short', 'loc_766']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_77D']
mov ['eax,', '[ebp+var_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_listbox_getid']
add ['esp,', '0Ch']
mov ['[ebp+var_18],', 'eax']
mov ['eax,', '[ebp+var_18]']
push ['eax']
push ['3Bh']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
call ['_conf_set_int']
add ['esp,', '0Ch']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_serial_flow_handler proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['[ebp+var_10],', 'edx']
cmp ['[ebp+arg_C],', '0']
jnz ['loc_8FE']
push ['3Ch']
mov ['eax,', '[ebp+var_10]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_14],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_update_start']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_dlg_listbox_clear']
add ['esp,', '8']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_821']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
cmp ['[ebp+var_8],', '4']
jnb ['short', 'loc_85E']
mov ['eax,', '1']
mov ['ecx,', '[ebp+var_8]']
shl ['eax,', 'cl']
and ['eax,', '[ebp+var_4]']
jz ['short', 'loc_85C']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', 'ds:dword_29C[ecx*8]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', 'ds:?flows@?1??serial_flow_handler@@9@9[eax*8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_dlg_listbox_addwithid']
add ['esp,', '10h']
jmp ['short', 'loc_818']
mov ['[ebp+var_C],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'ecx']
jmp ['short', 'loc_876']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
cmp ['[ebp+var_8],', '4']
jnb ['short', 'loc_8BB']
mov ['eax,', '1']
mov ['ecx,', '[ebp+var_8]']
shl ['eax,', 'cl']
and ['eax,', '[ebp+var_4]']
jz ['short', 'loc_8B9']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+var_14]']
cmp ['edx,', 'ds:dword_29C[ecx*8]']
jnz ['short', 'loc_8B0']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_listbox_select']
add ['esp,', '0Ch']
jmp ['short', 'loc_8BB']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '1']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_86D']
cmp ['[ebp+var_8],', '4']
jnz ['short', 'loc_8DA']
push ['0']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_listbox_select']
add ['esp,', '0Ch']
mov ['[ebp+var_14],', '0']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_dlg_update_done']
add ['esp,', '8']
mov ['edx,', '[ebp+var_14]']
push ['edx']
push ['3Ch']
mov ['eax,', '[ebp+var_10]']
push ['eax']
call ['_conf_set_int']
add ['esp,', '0Ch']
jmp ['short', 'loc_94F']
cmp ['[ebp+arg_C],', '3']
jnz ['short', 'loc_94F']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_listbox_index']
add ['esp,', '8']
mov ['[ebp+var_18],', 'eax']
cmp ['[ebp+var_18],', '0']
jge ['short', 'loc_926']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_93D']
mov ['eax,', '[ebp+var_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_dlg_listbox_getid']
add ['esp,', '0Ch']
mov ['[ebp+var_18],', 'eax']
mov ['eax,', '[ebp+var_18]']
push ['eax']
push ['3Ch']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
call ['_conf_set_int']
add ['esp,', '0Ch']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
