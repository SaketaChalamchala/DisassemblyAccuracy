_init_help      proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '824h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_824]']
mov ['ecx,', '209h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
push ['7FFh']
lea ['eax,', '[ebp+Filename]']
push ['eax']
push ['0']
call ['dword', 'ptr', 'ds:__imp__GetModuleFileNameA@12']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
lea ['ecx,', '[ebp+Filename]']
mov ['[ebp+Dest],', 'ecx']
push ['5Ch']
lea ['edx,', '[ebp+Filename]']
push ['edx']
call ['_strrchr']
add ['esp,', '8']
mov ['[ebp+var_810],', 'eax']
cmp ['[ebp+var_810],', '0']
jz ['short', 'loc_14D']
mov ['eax,', '[ebp+var_810]']
cmp ['eax,', '[ebp+Dest]']
jb ['short', 'loc_14D']
mov ['ecx,', '[ebp+var_810]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
push ['3Ah']
lea ['edx,', '[ebp+Filename]']
push ['edx']
call ['_strrchr']
add ['esp,', '8']
mov ['[ebp+var_814],', 'eax']
cmp ['[ebp+var_814],', '0']
jz ['short', 'loc_18A']
mov ['eax,', '[ebp+var_814]']
cmp ['eax,', '[ebp+Dest]']
jb ['short', 'loc_18A']
mov ['ecx,', '[ebp+var_814]']
add ['ecx,', '1']
mov ['[ebp+Dest],', 'ecx']
push ['offset', '$SG85747']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '$SG85750']
lea ['eax,', '[ebp+Filename]']
push ['eax']
call ['_fopen']
add ['esp,', '8']
mov ['[ebp+File],', 'eax']
cmp ['[ebp+File],', '0']
jz ['short', 'loc_1E6']
lea ['ecx,', '[ebp+Filename]']
push ['ecx']
call ['_dupstr']
add ['esp,', '4']
mov ['ds:_help_path,', 'eax']
mov ['edx,', '[ebp+File]']
push ['edx']
call ['_fclose']
add ['esp,', '4']
jmp ['short', 'loc_1F0']
mov ['ds:_help_path,', '0']
push ['offset', '$SG85753']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '$SG85756']
lea ['ecx,', '[ebp+Filename]']
push ['ecx']
call ['_fopen']
add ['esp,', '8']
mov ['[ebp+File],', 'eax']
cmp ['[ebp+File],', '0']
jz ['short', 'loc_242']
mov ['ds:_help_has_contents,', '1']
mov ['edx,', '[ebp+File]']
push ['edx']
call ['_fclose']
add ['esp,', '4']
jmp ['short', 'loc_24C']
mov ['ds:_help_has_contents,', '0']
push ['offset', '$SG85758']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '$SG85761']
lea ['ecx,', '[ebp+Filename]']
push ['ecx']
call ['_fopen']
add ['esp,', '8']
mov ['[ebp+File],', 'eax']
cmp ['[ebp+File],', '0']
jz ['short', 'loc_2A8']
lea ['edx,', '[ebp+Filename]']
push ['edx']
call ['_dupstr']
add ['esp,', '4']
mov ['ds:_chm_path,', 'eax']
mov ['eax,', '[ebp+File]']
push ['eax']
call ['_fclose']
add ['esp,', '4']
jmp ['short', 'loc_2B2']
mov ['ds:_chm_path,', '0']
cmp ['ds:_chm_path,', '0']
jz ['loc_346']
push ['offset', '$SG85766']
call ['_load_system32_dll']
add ['esp,', '4']
mov ['[ebp+hModule],', 'eax']
cmp ['[ebp+hModule],', '0']
jz ['short', 'loc_2FE']
mov ['esi,', 'esp']
push ['offset', '$SG85769']
mov ['ecx,', '[ebp+hModule]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_824],', 'eax']
jmp ['short', 'loc_308']
mov ['[ebp+var_824],', '0']
mov ['edx,', '[ebp+var_824]']
mov ['ds:_p_HtmlHelpA,', 'edx']
cmp ['ds:_p_HtmlHelpA,', '0']
jnz ['short', 'loc_346']
mov ['ds:_chm_path,', '0']
cmp ['[ebp+hModule],', '0']
jz ['short', 'loc_346']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+hModule]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__FreeLibrary@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN18']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '824h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_shutdown_help  proc near
push ['ebp']
mov ['ebp,', 'esp']
pop ['ebp']
retn
endp
_has_help       proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['ds:_help_path,', '0']
jnz ['short', 'loc_3C6']
cmp ['ds:_chm_path,', '0']
jnz ['short', 'loc_3C6']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_3CD']
mov ['[ebp+var_4],', '1']
mov ['eax,', '[ebp+var_4]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_launch_help    proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+dwData],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+Str],', '0']
jz ['loc_4E1']
push ['offset', '$SG85785']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strcspn']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['ds:_chm_path,', '0']
jz ['short', 'loc_48F']
mov ['ecx,', '[ebp+Str]']
add ['ecx,', '[ebp+var_4]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jnz ['short', 'loc_444']
push ['63h']
push ['offset', '$SG85789']
push ['offset', '$SG85790']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+Str]']
lea ['eax,', '[edx+ecx+1]']
push ['eax']
mov ['ecx,', 'ds:_chm_path']
push ['ecx']
push ['offset', '$SG85791']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+var_8],', 'eax']
mov ['esi,', 'esp']
push ['0']
push ['0']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+hWndMain]']
push ['eax']
call ['ds:_p_HtmlHelpA']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_4DF']
cmp ['ds:_help_path,', '0']
jz ['short', 'loc_4DF']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
push ['offset', '$SG85795']
call ['_dupprintf']
add ['esp,', '0Ch']
mov ['[ebp+dwData],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+dwData]']
push ['ecx']
push ['102h']
mov ['edx,', 'ds:_help_path']
push ['edx']
mov ['eax,', '[ebp+hWndMain]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__WinHelpA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+dwData]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_543']
cmp ['ds:_chm_path,', '0']
jz ['short', 'loc_50A']
mov ['esi,', 'esp']
push ['0']
push ['0']
mov ['edx,', 'ds:_chm_path']
push ['edx']
mov ['eax,', '[ebp+hWndMain]']
push ['eax']
call ['ds:_p_HtmlHelpA']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_543']
cmp ['ds:_help_path,', '0']
jz ['short', 'loc_543']
mov ['esi,', 'esp']
push ['0']
xor ['ecx,', 'ecx']
cmp ['ds:_help_has_contents,', '0']
setnz ['cl']
lea ['ecx,', 'ds:3[ecx*8]']
push ['ecx']
mov ['edx,', 'ds:_help_path']
push ['edx']
mov ['eax,', '[ebp+hWndMain]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__WinHelpA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_requested_help,', '1']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_quit_help      proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
cmp ['ds:_requested_help,', '0']
jz ['short', 'loc_5BF']
cmp ['ds:_chm_path,', '0']
jz ['short', 'loc_58F']
mov ['esi,', 'esp']
push ['0']
push ['12h']
push ['0']
push ['0']
call ['ds:_p_HtmlHelpA']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_5B5']
cmp ['ds:_help_path,', '0']
jz ['short', 'loc_5B5']
mov ['esi,', 'esp']
push ['0']
push ['2']
mov ['eax,', 'ds:_help_path']
push ['eax']
mov ['ecx,', '[ebp+hWndMain]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__WinHelpA@16']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ds:_requested_help,', '0']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
