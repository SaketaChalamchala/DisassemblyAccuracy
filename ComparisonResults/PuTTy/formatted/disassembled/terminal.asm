_term_update    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+109Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1088h]']
push ['edx']
call ['_get_ctx']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['loc_E44']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+154h]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+154h],', '0']
jz ['short', 'loc_DEE']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1164h],', '0']
jz ['short', 'loc_DEE']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+10h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+154h],', '0']
mov ['[ebp+var_8],', '1']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_E00']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_update_sbar']
add ['esp,', '4']
push ['1']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_paint']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+6Ch]']
sub ['edx,', '[ecx+10h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_sys_cursor']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_free_ctx']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_seen_key_event proc near          
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+34h],', '0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+28h],', '0']
jz ['short', 'loc_E9C']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+28h]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['[ecx+28h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_E71']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+2Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+30h],', '0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1168h],', '0']
jz ['short', 'loc_ED2']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_seen_disp_event proc near              
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+154h],', '1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_schedule_update']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_schedule_update proc near         
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+109Ch],', '0']
jnz ['short', 'loc_F54']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+109Ch],', '1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
push ['offset', '_term_timer']
push ['14h']
call ['_schedule_timer']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10A0h],', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_timer     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+10A4h],', '0']
jz ['short', 'loc_FDF']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[edx+10ACh]']
jnz ['short', 'loc_FDF']
mov ['ecx,', '[ebp+var_4]']
xor ['edx,', 'edx']
cmp ['dword', 'ptr', '[ecx+0C0h],', '0']
setz ['dl']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+0C0h],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+10A4h],', '0']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_term_schedule_tblink']
add ['esp,', '4']
mov ['[ebp+var_8],', '1']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+10A8h],', '0']
jz ['short', 'loc_1031']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ecx+10B0h]']
jnz ['short', 'loc_1031']
mov ['eax,', '[ebp+var_4]']
xor ['ecx,', 'ecx']
cmp ['dword', 'ptr', '[eax+0BCh],', '0']
setz ['cl']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+0BCh],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+10A8h],', '0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_term_schedule_cblink']
add ['esp,', '4']
mov ['[ebp+var_8],', '1']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+138h],', '0']
jz ['short', 'loc_105F']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+13Ch]']
jnz ['short', 'loc_105F']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+138h],', '0']
mov ['[ebp+var_8],', '1']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_107F']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+109Ch],', '0']
jz ['short', 'loc_108B']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ecx+10A0h]']
jnz ['short', 'loc_108B']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_term_update']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_schedule_tblink proc near         
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0C4h],', '0']
jz ['short', 'loc_10E5']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+10A4h],', '0']
jnz ['short', 'loc_10D6']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
push ['offset', '_term_timer']
push ['1C2h']
call ['_schedule_timer']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10ACh],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10A4h],', '1']
jmp ['short', 'loc_10FF']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0C0h],', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+10A4h],', '0']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_schedule_cblink proc near         
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1100h],', '0']
jz ['short', 'loc_116D']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+134h],', '0']
jz ['short', 'loc_116D']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+10A8h],', '0']
jnz ['short', 'loc_115E']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '_term_timer']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetCaretBlinkTime@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
call ['_schedule_timer']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10B0h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10A8h],', '1']
jmp ['short', 'loc_1187']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0BCh],', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+10A8h],', '0']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_pwron     proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_power_on']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1084h],', '0']
jz ['short', 'loc_11D3']
push ['0']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_deselect']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_update']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_power_on       proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+17Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+178h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+74h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+78h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+108h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+7Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+19Ch],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+128h],', '0FFFFFFFFh']
jz ['short', 'loc_12BA']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
sub ['ecx,', '1']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_C]']
mov ['[edx+80h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_C]']
mov ['[ecx+1A0h],', 'edx']
jmp ['short', 'loc_12D4']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+80h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1A0h],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+12Ch],', '0FFFFFFFFh']
jz ['short', 'loc_1327']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_12F2']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ecx+12Ch]']
jge ['short', 'loc_1327']
mov ['eax,', '[ebp+var_4]']
and ['eax,', '80000007h']
jns ['short', 'loc_130F']
dec ['eax']
or ['eax,', '0FFFFFFF8h']
inc ['eax']
neg ['eax']
sbb ['eax,', 'eax']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E40h]']
mov ['ecx,', '[ebp+var_4]']
mov ['[edx+ecx],', 'al']
jmp ['short', 'loc_12E9']
push ['5Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_10]']
mov ['[ecx+84h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_10]']
mov ['[eax+180h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+90h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+18Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+120h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0A4h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+8Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+188h],', '0']
push ['5Dh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_14],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_14]']
mov ['[ecx+88h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_14]']
mov ['[eax+184h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+114h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+98h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+94h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+190h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+11Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0A0h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0DCh],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+198h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E0h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+124h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D4h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D0h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+194h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+118h],', '0D800h']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+9Ch],', '0D800h']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+174h],', '0D800h']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+170h],', '0D800h']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0A8h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+138h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0B0h],', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+158h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+40h],', '20500h']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+110h],', '20500h']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+44h],', '20500h']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+3Ch],', '20500h']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0C8h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0CCh],', '0']
push ['49h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+140h],', 'eax']
push ['4Ah']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+144h],', 'eax']
push ['6Bh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0B8h],', 'eax']
push ['6Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0C4h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '48h']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '54h']
mov ['ecx,', '[edx]']
mov ['[eax],', 'ecx']
mov ['ecx,', '[edx+4]']
mov ['[eax+4],', 'ecx']
mov ['edx,', '[edx+8]']
mov ['[eax+8],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+1A4h],', '0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_print_finish']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+15Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+160h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+164h],', '0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_set_raw_mouse_mode']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+16Ch],', '0']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_162C']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
cmp ['[ebp+var_8],', '100h']
jge ['short', 'loc_1660']
mov ['eax,', '[ebp+var_8]']
push ['eax']
push ['8Ah']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1094h]']
push ['edx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+ecx*2+0E6Ch],', 'ax']
jmp ['short', 'loc_1623']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+8],', '0']
jz ['loc_1718']
push ['0']
push ['0']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_swap_screen']
add ['esp,', '10h']
push ['1']
push ['1']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_erase_lots']
add ['esp,', '10h']
push ['0']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_swap_screen']
add ['esp,', '10h']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_16BB']
push ['1']
push ['1']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_erase_lots']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_find_last_nonempty_line']
add ['esp,', '8']
add ['eax,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+6Ch],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+6Ch]']
cmp ['edx,', '[ecx+128h]']
jnz ['short', 'loc_1716']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+6Ch],', 'ecx']
push ['1']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
sub ['ecx,', '1']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_1722']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+6Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+70h],', '0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_schedule_tblink']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_schedule_cblink']
add ['esp,', '4']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_copy_stuff_from_conf proc near    
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+Str],', 'eax']
push ['7Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10D4h],', 'eax']
push ['7Dh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10E0h],', 'eax']
push ['61h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10E4h],', 'eax']
push ['63h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10E8h],', 'eax']
push ['64h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10ECh],', 'eax']
push ['66h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10F0h],', 'eax']
push ['65h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10F4h],', 'eax']
push ['7Eh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10F8h],', 'eax']
push ['3Dh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10FCh],', 'eax']
push ['60h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1100h],', 'eax']
push ['6Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1104h],', 'eax']
push ['8Dh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1108h],', 'eax']
push ['6Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+110Ch],', 'eax']
push ['6Eh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1110h],', 'eax']
push ['0B0h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1114h],', 'eax']
push ['57h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1118h],', 'eax']
push ['3Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+111Ch],', 'eax']
push ['5Eh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1120h],', 'eax']
push ['75h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1124h],', 'eax']
push ['73h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1128h],', 'eax']
push ['89h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+112Ch],', 'eax']
push ['4Bh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1130h],', 'eax']
push ['44h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1134h],', 'eax']
push ['40h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1138h],', 'eax']
push ['41h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+113Ch],', 'eax']
push ['46h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1140h],', 'eax']
push ['42h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1144h],', 'eax']
push ['47h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1148h],', 'eax']
push ['43h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+114Ch],', 'eax']
push ['45h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1150h],', 'eax']
push ['87h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1154h],', 'eax']
push ['86h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1158h],', 'eax']
push ['48h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+115Ch],', 'eax']
push ['3Eh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1160h],', 'eax']
push ['56h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1164h],', 'eax']
push ['55h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1168h],', 'eax']
push ['80h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+116Ch],', 'eax']
push ['7Bh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+Str],', 'eax']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
push ['1']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10D8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10DCh],', '0']
mov ['eax,', '[ebp+Str]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['loc_1C9F']
lea ['edx,', '[ebp+var_10]']
push ['edx']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_ctrlparse']
add ['esp,', '8']
mov ['byte', 'ptr', '[ebp+var_18+3],', 'al']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_1C62']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10D8h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10DCh]']
mov ['al,', 'byte', 'ptr', '[ebp+var_18+3]']
mov ['[edx+ecx],', 'al']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10DCh]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+10DCh],', 'edx']
mov ['ecx,', '[ebp+var_10]']
mov ['[ebp+Str],', 'ecx']
jmp ['short', 'loc_1C9A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10D8h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10DCh]']
mov ['ecx,', '[ebp+Str]']
mov ['cl,', '[ecx]']
mov ['[eax+edx],', 'cl']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10DCh]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10DCh],', 'eax']
mov ['edx,', '[ebp+Str]']
add ['edx,', '1']
mov ['[ebp+Str],', 'edx']
jmp ['loc_1C06']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN9']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_reconfig  proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
push ['5Dh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['5Dh']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
xor ['ecx,', 'ecx']
cmp ['esi,', 'eax']
setnz ['cl']
mov ['[ebp+var_4],', 'ecx']
push ['5Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['5Ch']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
xor ['edx,', 'edx']
cmp ['esi,', 'eax']
setnz ['dl']
mov ['[ebp+var_8],', 'edx']
push ['6Bh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['6Bh']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
xor ['ecx,', 'ecx']
cmp ['esi,', 'eax']
setnz ['cl']
mov ['[ebp+var_C],', 'ecx']
push ['6Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['6Ch']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
xor ['edx,', 'edx']
cmp ['esi,', 'eax']
setnz ['dl']
mov ['[ebp+var_10],', 'edx']
mov ['[ebp+var_14],', '0']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_1DD1']
mov ['eax,', '[ebp+var_18]']
add ['eax,', '1']
mov ['[ebp+var_18],', 'eax']
cmp ['[ebp+var_18],', '100h']
jge ['short', 'loc_1E19']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
push ['8Ah']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['esi,', 'eax']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
push ['8Ah']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
cmp ['esi,', 'eax']
jz ['short', 'loc_1E17']
mov ['[ebp+var_14],', '1']
jmp ['short', 'loc_1DC8']
push ['7Dh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['7Dh']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jnz ['short', 'loc_1E6D']
push ['7Eh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['7Eh']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jz ['loc_1F28']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_1E7F']
mov ['eax,', '[ebp+var_18]']
add ['eax,', '1']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_18]']
cmp ['edx,', '[ecx+10D0h]']
jge ['loc_1F28']
mov ['eax,', '[ebp+var_18]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10C8h]']
mov ['eax,', '[edx+eax+4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_18]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
mov ['ecx,', '[eax+ecx+4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_18]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10C8h]']
mov ['dword', 'ptr', '[edx+ecx],', '0FFFFFFFFh']
mov ['edx,', '[ebp+var_18]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10C8h]']
mov ['dword', 'ptr', '[ecx+edx+4],', '0']
mov ['edx,', '[ebp+var_18]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10CCh]']
mov ['dword', 'ptr', '[edx+ecx],', '0FFFFFFFFh']
mov ['edx,', '[ebp+var_18]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10CCh]']
mov ['dword', 'ptr', '[ecx+edx+4],', '0']
jmp ['loc_1E76']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_free']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_copy']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1094h],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_1F84']
push ['5Dh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_1C],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_1C]']
mov ['[edx+88h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_1C]']
mov ['[ecx+184h],', 'edx']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_1FB9']
push ['5Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_20],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_20]']
mov ['[edx+84h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_20]']
mov ['[ecx+180h],', 'edx']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_1FE8']
push ['6Bh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0B8h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_set_erase_char']
add ['esp,', '4']
cmp ['[ebp+var_10],', '0']
jz ['short', 'loc_200B']
push ['6Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1094h]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0C4h],', 'eax']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_2057']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_2023']
mov ['edx,', '[ebp+var_18]']
add ['edx,', '1']
mov ['[ebp+var_18],', 'edx']
cmp ['[ebp+var_18],', '100h']
jge ['short', 'loc_2057']
mov ['eax,', '[ebp+var_18]']
push ['eax']
push ['8Ah']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1094h]']
push ['edx']
call ['_conf_get_int_int']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_18]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+ecx*2+0E6Ch],', 'ax']
jmp ['short', 'loc_201A']
push ['44h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_2081']
push ['0']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_swap_screen']
add ['esp,', '10h']
push ['42h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_20BA']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+15Ch],', '0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1088h]']
push ['ecx']
call ['_set_raw_mouse_mode']
add ['esp,', '8']
push ['47h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_2113']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+174h],', '0D800h']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+170h],', '0D800h']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+194h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D0h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0DCh],', '0']
push ['7Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1094h]']
push ['ecx']
call ['_conf_get_str']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_2137']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_print_finish']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_schedule_tblink']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_schedule_cblink']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_copy_stuff_from_conf']
add ['esp,', '4']
pop ['esi']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_set_erase_char proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '48h']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '54h']
mov ['edx,', '[eax]']
mov ['[ecx],', 'edx']
mov ['edx,', '[eax+4]']
mov ['[ecx+4],', 'edx']
mov ['eax,', '[eax+8]']
mov ['[ecx+8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0B8h],', '0']
jz ['short', 'loc_21A8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '3FFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+58h],', 'eax']
pop ['ebp']
retn
endp
_term_clrsb     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+10h],', '0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_21F2']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_21CA']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_2204']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[edx+128h]']
jge ['short', 'loc_2238']
push ['1']
push ['613h']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_lineptr']
add ['esp,', '10h']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_check_line_size']
add ['esp,', '8']
jmp ['short', 'loc_21FB']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+14h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+1A8h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_update_sbar']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_lineptr        proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_4],', '0']
jl ['short', 'loc_22A1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['[ebp+var_C],', 'edx']
jmp ['loc_2339']
mov ['[ebp+var_10],', '0']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_22C5']
push ['3F9h']
push ['offset', '$SG86283']
push ['offset', '$SG86284']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1118h],', '0']
jz ['short', 'loc_22F2']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1A4h],', '0']
jz ['short', 'loc_22F2']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0Ch],', '0']
jz ['short', 'loc_22F2']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1A8h]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_10]']
neg ['eax']
cmp ['[ebp+arg_4],', 'eax']
jge ['short', 'loc_2321']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_8],', 'edx']
mov ['esi,', '[ebp+arg_4]']
add ['esi,', '[ebp+var_10]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_count234']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['[ebp+var_C],', 'esi']
jmp ['short', 'loc_2339']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '[ecx+1A8h]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[eax+4]']
jnz ['short', 'loc_236A']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_14],', 'eax']
push ['0']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
call ['_decompressline']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_237D']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jnz ['loc_2407']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1A8h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
call ['_count234']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['_count234']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
call ['_count234']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
push ['offset', '$SG86294']
call ['_fatalbox']
add ['esp,', '38h']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_2424']
push ['41Fh']
push ['offset', '$SG86297']
push ['offset', '$SG86298']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+12Ch]']
cmp ['edx,', '[ecx+4]']
jle ['short', 'loc_244F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_resizeline']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
pop ['esi']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_decompressline proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '2Ch']
push ['edi']
lea ['edi,', '[ebp+var_2C]']
mov ['ecx,', '0Bh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
lea ['eax,', '[ebp+var_1C]']
mov ['[ebp+var_24],', 'eax']
mov ['ecx,', '[ebp+var_24]']
mov ['edx,', '[ebp+arg_0]']
mov ['[ecx],', 'edx']
mov ['eax,', '[ebp+var_24]']
mov ['dword', 'ptr', '[eax+4],', '0']
mov ['[ebp+var_C],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_24]']
push ['edx']
call ['_get']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+var_8]']
and ['eax,', '7Fh']
mov ['ecx,', '[ebp+var_C]']
shl ['eax,', 'cl']
or ['eax,', '[ebp+var_4]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '7']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_8]']
and ['edx,', '80h']
jnz ['short', 'loc_24A7']
push ['18h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_28],', 'eax']
push ['0Ch']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_28]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+var_28]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+8],', 'eax']
mov ['ecx,', '[ebp+var_28]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx+4],', 'edx']
mov ['eax,', '[ebp+var_28]']
mov ['dword', 'ptr', '[eax+0Ch],', '1']
mov ['ecx,', '[ebp+var_28]']
mov ['dword', 'ptr', '[ecx+10h],', '0']
mov ['[ebp+var_2C],', '0']
jmp ['short', 'loc_2536']
mov ['edx,', '[ebp+var_2C]']
add ['edx,', '1']
mov ['[ebp+var_2C],', 'edx']
mov ['eax,', '[ebp+var_28]']
mov ['ecx,', '[ebp+var_2C]']
cmp ['ecx,', '[eax+4]']
jge ['short', 'loc_2557']
mov ['edx,', '[ebp+var_2C]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_28]']
mov ['ecx,', '[eax+14h]']
mov ['dword', 'ptr', '[ecx+edx+8],', '0']
jmp ['short', 'loc_252D']
mov ['[ebp+var_C],', '0']
mov ['edx,', '[ebp+var_28]']
mov ['ax,', 'word', 'ptr', '[ebp+var_C]']
mov ['[edx],', 'ax']
mov ['ecx,', '[ebp+var_24]']
push ['ecx']
call ['_get']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['edx,', '[ebp+var_8]']
and ['edx,', '7Fh']
mov ['ecx,', '[ebp+var_C]']
shl ['edx,', 'cl']
mov ['eax,', '[ebp+var_28]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
or ['ecx,', 'edx']
mov ['edx,', '[ebp+var_28]']
mov ['[edx],', 'cx']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '7']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_8]']
and ['ecx,', '80h']
jnz ['short', 'loc_2568']
push ['offset', '_readliteral_chr']
mov ['edx,', '[ebp+var_28]']
push ['edx']
mov ['eax,', '[ebp+var_24]']
push ['eax']
call ['_readrle']
add ['esp,', '0Ch']
push ['offset', '_readliteral_attr']
mov ['ecx,', '[ebp+var_28]']
push ['ecx']
mov ['edx,', '[ebp+var_24]']
push ['edx']
call ['_readrle']
add ['esp,', '0Ch']
push ['offset', '_readliteral_cc']
mov ['eax,', '[ebp+var_28]']
push ['eax']
mov ['ecx,', '[ebp+var_24]']
push ['ecx']
call ['_readrle']
add ['esp,', '0Ch']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_25F4']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+var_24]']
mov ['ecx,', '[eax+4]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+var_28]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN15']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '2Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_get            proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
mov ['cl,', '[ecx+eax]']
mov ['byte', 'ptr', '[ebp+var_4+3],', 'cl']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+4],', 'eax']
movzx ['eax,', 'byte', 'ptr', '[ebp+var_4+3]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_readrle        proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['[ebp+var_4],', '0']
mov ['[ebp+var_C],', '0']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[eax+4]']
jge ['loc_27CB']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_get']
add ['esp,', '4']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '80h']
jl ['loc_2753']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', '[ebp+var_14]']
sub ['edx,', '7Eh']
mov ['[ebp+var_1C],', 'edx']
mov ['eax,', '[ebp+var_1C]']
mov ['[ebp+var_24],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
sub ['ecx,', '1']
mov ['[ebp+var_1C],', 'ecx']
cmp ['[ebp+var_24],', '0']
jz ['short', 'loc_2751']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+var_4]']
cmp ['eax,', '[edx+4]']
jl ['short', 'loc_2715']
push ['2E8h']
push ['offset', '$SG86141']
push ['offset', '$SG86142']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_18]']
mov ['[edx+4],', 'eax']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
add ['eax,', '[ecx+14h]']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['[ebp+arg_8]']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_26DE']
jmp ['short', 'loc_27C6']
mov ['ecx,', '[ebp+var_14]']
add ['ecx,', '1']
mov ['[ebp+var_20],', 'ecx']
mov ['edx,', '[ebp+var_20]']
mov ['[ebp+var_28],', 'edx']
mov ['eax,', '[ebp+var_20]']
sub ['eax,', '1']
mov ['[ebp+var_20],', 'eax']
cmp ['[ebp+var_28],', '0']
jz ['short', 'loc_27C6']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ecx+4]']
jl ['short', 'loc_2793']
push ['2F2h']
push ['offset', '$SG86149']
push ['offset', '$SG86150']
call ['__wassert']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
add ['eax,', '[ecx+14h]']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['[ebp+arg_8]']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_275C']
jmp ['loc_26A1']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ecx+4]']
jz ['short', 'loc_27ED']
push ['2F9h']
push ['offset', '$SG86152']
push ['offset', '$SG86153']
call ['__wassert']
add ['esp,', '0Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN16']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_readliteral_chr proc near              
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_get']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '80h']
jge ['short', 'loc_2861']
mov ['ecx,', '[ebp+arg_C]']
mov ['edx,', '[ebp+var_4]']
or ['edx,', '[ecx]']
mov ['eax,', '[ebp+arg_4]']
mov ['[eax],', 'edx']
jmp ['loc_29C2']
cmp ['[ebp+var_4],', '0C0h']
jge ['short', 'loc_2896']
mov ['ecx,', '[ebp+var_4]']
and ['ecx,', '0FFFFFF3Fh']
shl ['ecx,', '8']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_get']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
or ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
jmp ['loc_29C2']
cmp ['[ebp+var_4],', '0E0h']
jge ['short', 'loc_28E3']
mov ['eax,', '[ebp+var_4]']
and ['eax,', '0FFFFFF1Fh']
shl ['eax,', '10h']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_get']
add ['esp,', '4']
shl ['eax,', '8']
mov ['ecx,', '[ebp+arg_4]']
or ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_get']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
or ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
jmp ['loc_29C2']
cmp ['[ebp+var_4],', '0F0h']
jge ['short', 'loc_2946']
mov ['eax,', '[ebp+var_4]']
and ['eax,', '0FFFFFF0Fh']
shl ['eax,', '18h']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_get']
add ['esp,', '4']
shl ['eax,', '10h']
mov ['ecx,', '[ebp+arg_4]']
or ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_get']
add ['esp,', '4']
shl ['eax,', '8']
mov ['ecx,', '[ebp+arg_4]']
or ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_get']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
or ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
jmp ['short', 'loc_29C2']
cmp ['[ebp+var_4],', '0F0h']
jz ['short', 'loc_2966']
push ['318h']
push ['offset', '$SG86174']
push ['offset', '$SG86175']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_get']
add ['esp,', '4']
shl ['eax,', '18h']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_get']
add ['esp,', '4']
shl ['eax,', '10h']
mov ['ecx,', '[ebp+arg_4]']
or ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_get']
add ['esp,', '4']
shl ['eax,', '8']
mov ['ecx,', '[ebp+arg_4]']
or ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_get']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
or ['eax,', '[ecx]']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
and ['ecx,', '0FFFFFF00h']
mov ['edx,', '[ebp+arg_C]']
mov ['[edx],', 'ecx']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_readliteral_attr proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_get']
add ['esp,', '4']
shl ['eax,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_get']
add ['esp,', '4']
or ['eax,', '[ebp+var_4]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '8000h']
jb ['short', 'loc_2A70']
mov ['edx,', '[ebp+var_4]']
and ['edx,', '0FFFF7FFFh']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+var_4]']
shl ['eax,', '10h']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_get']
add ['esp,', '4']
shl ['eax,', '8']
or ['eax,', '[ebp+var_4]']
mov ['[ebp+var_4],', 'eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_get']
add ['esp,', '4']
or ['eax,', '[ebp+var_4]']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
shr ['eax,', '17h']
and ['eax,', '0FFh']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_4]']
and ['ecx,', '7FFFFFh']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_8]']
shr ['edx,', '4']
shl ['edx,', '8']
mov ['eax,', '[ebp+var_8]']
and ['eax,', '0Fh']
or ['edx,', 'eax']
mov ['[ebp+var_8],', 'edx']
mov ['ecx,', '[ebp+var_8]']
shr ['ecx,', '0Dh']
shl ['ecx,', '11h']
mov ['edx,', '[ebp+var_8]']
and ['edx,', '1FFFh']
or ['ecx,', 'edx']
mov ['[ebp+var_8],', 'ecx']
mov ['eax,', '[ebp+var_C]']
shr ['eax,', '4']
shl ['eax,', '0Dh']
or ['eax,', '[ebp+var_8]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_C]']
and ['ecx,', '0Fh']
shl ['ecx,', '4']
or ['ecx,', '[ebp+var_8]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+var_8]']
mov ['[edx+4],', 'eax']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_readliteral_cc proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[ebp+arg_4]']
sub ['ecx,', '[eax+14h]']
mov ['eax,', 'ecx']
cdq
mov ['ecx,', '0Ch']
idiv ['ecx']
mov ['[ebp+var_28],', 'eax']
mov ['edx,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[edx+8],', '0']
mov ['eax,', '1']
test ['eax,', 'eax']
jz ['short', 'loc_2B72']
mov ['[ebp+var_20],', '0']
lea ['ecx,', '[ebp+var_20]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
lea ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_readliteral_chr']
add ['esp,', '10h']
cmp ['[ebp+var_14],', '0']
jnz ['short', 'loc_2B5C']
jmp ['short', 'loc_2B72']
mov ['edx,', '[ebp+var_14]']
push ['edx']
mov ['eax,', '[ebp+var_28]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
call ['_add_cc']
add ['esp,', '0Ch']
jmp ['short', 'loc_2B2C']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN9_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_add_cc         proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_4],', '0']
jl ['short', 'loc_2BF1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+4]']
jl ['short', 'loc_2C08']
push ['0CDh']
push ['offset', '$SG85860']
push ['offset', '$SG85861']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10h],', '0']
jnz ['loc_2CB4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['eax,', '[eax+8]']
sub ['eax,', '[ecx+4]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['ecx,', '[edx+8]']
lea ['edx,', '[eax+ecx+10h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+8],', 'edx']
push ['0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+14h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_8]']
mov ['[eax+10h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[edx+8]']
jge ['short', 'loc_2CB4']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
cmp ['ecx,', '[edx+8]']
jge ['short', 'loc_2C95']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['dword', 'ptr', '[edx+eax+8],', '1']
jmp ['short', 'loc_2CA9']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['dword', 'ptr', '[edx+eax+8],', '0']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
jmp ['short', 'loc_2C66']
mov ['ecx,', '[ebp+arg_4]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
cmp ['dword', 'ptr', '[eax+ecx+8],', '0']
jz ['short', 'loc_2CDF']
mov ['ecx,', '[ebp+arg_4]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '[eax+ecx+8]']
mov ['[ebp+arg_4],', 'edx']
jmp ['short', 'loc_2CB4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
cmp ['dword', 'ptr', '[ecx+edx+8],', '0']
jz ['short', 'loc_2D16']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '[ecx+edx+8]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10h],', 'eax']
jmp ['short', 'loc_2D20']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['dword', 'ptr', '[edx+eax+8],', '0']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+edx],', 'ecx']
mov ['edx,', '[ebp+var_4]']
sub ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+arg_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+14h]']
mov ['[ecx+eax+8],', 'edx']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_resizeline     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+4]']
cmp ['ecx,', '[ebp+arg_8]']
jz ['loc_2F27']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+4]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ebp+var_4],', 'ecx']
jmp ['short', 'loc_2DA9']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '1']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+var_4]']
cmp ['eax,', '[ebp+var_8]']
jge ['short', 'loc_2DC3']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_clear_cc']
add ['esp,', '8']
jmp ['short', 'loc_2DA0']
mov ['eax,', '[ebp+arg_8]']
cmp ['eax,', '[ebp+var_8]']
jge ['short', 'loc_2DFD']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ecx+8]']
sub ['eax,', '[edx+4]']
imul ['eax,', '0Ch']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
add ['ecx,', '[edx+14h]']
push ['ecx']
mov ['eax,', '[ebp+arg_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
add ['eax,', '[ecx+14h]']
push ['eax']
call ['_memmove']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+arg_4]']
add ['edx,', '[eax+8]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx+8],', 'edx']
push ['0Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+arg_8]']
mov ['[edx+4],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
cmp ['ecx,', '[ebp+var_8]']
jle ['short', 'loc_2E70']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[edx+8]']
sub ['ecx,', '[eax+4]']
imul ['ecx,', '0Ch']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
add ['edx,', '[eax+14h]']
push ['edx']
mov ['ecx,', '[ebp+arg_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
add ['ecx,', '[edx+14h]']
push ['ecx']
call ['_memmove']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_2E82']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[ebp+var_8]']
jge ['short', 'loc_2ECD']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ebp+arg_8]']
jge ['short', 'loc_2ECD']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+14h]']
cmp ['dword', 'ptr', '[edx+eax+8],', '0']
jz ['short', 'loc_2ECB']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+14h]']
mov ['ecx,', '[ebp+arg_8]']
sub ['ecx,', '[ebp+var_8]']
add ['ecx,', '[edx+eax+8]']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
mov ['eax,', '[eax+14h]']
mov ['[eax+edx+8],', 'ecx']
jmp ['short', 'loc_2E79']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jz ['short', 'loc_2EE8']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+arg_4]']
add ['edx,', '[eax+10h]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx+10h],', 'edx']
mov ['edx,', '[ebp+var_8]']
mov ['[ebp+var_4],', 'edx']
jmp ['short', 'loc_2EF9']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[ebp+arg_8]']
jge ['short', 'loc_2F27']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '48h']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
mov ['ecx,', '[ecx+14h]']
add ['ecx,', 'eax']
mov ['eax,', '[edx]']
mov ['[ecx],', 'eax']
mov ['eax,', '[edx+4]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[edx+8]']
mov ['[ecx+8],', 'edx']
jmp ['short', 'loc_2EF0']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_clear_cc       proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+arg_4],', '0']
jl ['short', 'loc_2F67']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ecx+4]']
jl ['short', 'loc_2F7E']
push ['0FFh']
push ['offset', '$SG85886']
push ['offset', '$SG85887']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
cmp ['dword', 'ptr', '[eax+ecx+8],', '0']
jnz ['short', 'loc_2F96']
jmp ['loc_3029']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+arg_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '[edx+eax+8]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10h],', 'ecx']
mov ['eax,', '[ebp+arg_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
cmp ['dword', 'ptr', '[edx+eax+8],', '0']
jz ['short', 'loc_2FE3']
mov ['eax,', '[ebp+arg_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '[edx+eax+8]']
mov ['[ebp+arg_4],', 'ecx']
jmp ['short', 'loc_2FB8']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_3001']
mov ['edx,', '[ebp+var_4]']
sub ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+arg_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+14h]']
mov ['[ecx+eax+8],', 'edx']
jmp ['short', 'loc_3015']
mov ['edx,', '[ebp+arg_4]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
mov ['dword', 'ptr', '[ecx+edx+8],', '0']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
mov ['dword', 'ptr', '[ecx+edx+8],', '0']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_check_line_size proc near              
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[eax+12Ch]']
cmp ['edx,', '[ecx+4]']
jz ['short', 'loc_306A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_resizeline']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_init      proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['1170h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+1088h],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+1090h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_conf_copy']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+1094h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+108Ch],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx],', '0FFFFh']
push ['offset', '$SG86486']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '0A40h']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+10A4h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+10A8h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+1070h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+1074h],', '0']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '60h']
push ['ecx']
call ['_bufchain_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '0F8h']
push ['edx']
call ['_bufchain_init']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0F0h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0ECh],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+104h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+148h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+150h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+154h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+168h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0B4h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0C0h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0BCh],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+134h],', '1']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+14Ch],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0E48h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+24h],', '0']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_term_copy_stuff_from_conf']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+0Ch],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+8],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+14h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+1A8h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+10h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+18h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+20h],', '0FFFFFFFFh']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+1Ch],', '0FFFFFFFFh']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0E40h],', '0']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_deselect']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+12Ch],', '0FFFFFFFFh']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+128h],', '0FFFFFFFFh']
push ['1']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_power_on']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+2Ch],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+28h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+30h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+38h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+34h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+106Ch],', '0FFFFFFFFh']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+107Ch],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+1080h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+1098h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+10B4h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+10B8h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+10BCh],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+10C0h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+10C4h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+109Ch],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+10D0h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+10CCh],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+10C8h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+48h],', '0D820h']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4Ch],', '20500h']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+50h],', '0']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '48h']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '54h']
mov ['edx,', '[eax]']
mov ['[ecx],', 'edx']
mov ['edx,', '[eax+4]']
mov ['[ecx+4],', 'edx']
mov ['eax,', '[eax+8]']
mov ['[ecx+8],', 'eax']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_free      proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_341F']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_33F7']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_freetree234']
add ['esp,', '4']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_3456']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_freeline']
add ['esp,', '4']
jmp ['short', 'loc_342E']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_freetree234']
add ['esp,', '4']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_348D']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_freeline']
add ['esp,', '4']
jmp ['short', 'loc_3465']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
call ['_freetree234']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+18h],', '0']
jz ['short', 'loc_34DC']
mov ['[ebp+var_C],', '0']
jmp ['short', 'loc_34B7']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '1']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_C]']
cmp ['eax,', '[edx+128h]']
jge ['short', 'loc_34DC']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[edx+eax*4]']
push ['ecx']
call ['_freeline']
add ['esp,', '4']
jmp ['short', 'loc_34AE']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+28h],', '0']
jz ['short', 'loc_3516']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+28h]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx]']
mov ['[ecx+28h],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_34EB']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '60h']
push ['edx']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+104h],', '0']
jz ['short', 'loc_3543']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+104h]']
push ['edx']
call ['_printer_finish_job']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '0F8h']
push ['eax']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1070h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10B4h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10BCh]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10C0h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['[ebp+var_C],', '0']
jmp ['short', 'loc_35AE']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '1']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_C]']
cmp ['edx,', '[ecx+10D0h]']
jge ['short', 'loc_3631']
mov ['eax,', '[ebp+var_C]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10C8h]']
mov ['eax,', '[edx+eax+4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
mov ['ecx,', '[eax+ecx+4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_C]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10CCh]']
mov ['edx,', '[ecx+edx+8]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_C]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10CCh]']
mov ['eax,', '[edx+eax+0Ch]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
jmp ['loc_35A5']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10C8h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10CCh]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E40h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_expire_timer_context']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_free']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_freeline       proc near               
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_36D0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_size      proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '34h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_34]']
mov ['ecx,', '0Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1A4h]']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ecx+128h]']
jnz ['short', 'loc_373A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_8]']
cmp ['ecx,', '[eax+12Ch]']
jnz ['short', 'loc_373A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_C]']
cmp ['eax,', '[edx+130h]']
jnz ['short', 'loc_373A']
jmp ['loc_3F83']
cmp ['[ebp+arg_4],', '1']
jge ['short', 'loc_3747']
mov ['[ebp+arg_4],', '1']
cmp ['[ebp+arg_8],', '1']
jge ['short', 'loc_3754']
mov ['[ebp+arg_8],', '1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_deselect']
add ['esp,', '4']
push ['0']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_swap_screen']
add ['esp,', '10h']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+7Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+19Ch],', '0']
mov ['edx,', '[ebp+arg_4]']
sub ['edx,', '1']
mov ['[ebp+var_2C],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_2C]']
mov ['[eax+80h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_2C]']
mov ['[edx+1A0h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+128h],', '0FFFFFFFFh']
jnz ['short', 'loc_37ED']
push ['0']
call ['_newtree234']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+4],', 'eax']
push ['0']
call ['_newtree234']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+8],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+14h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+128h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
call ['_count234']
add ['esp,', '4']
mov ['[ebp+var_1C],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['_count234']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
cmp ['[edx+128h],', 'eax']
jz ['short', 'loc_3830']
push ['6DEh']
push ['offset', '$SG86552']
push ['offset', '$SG86553']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
cmp ['edx,', '[ebp+arg_4]']
jge ['loc_3977']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+14h],', '0']
jle ['loc_3925']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_1C]']
cmp ['edx,', '[ecx+14h]']
jge ['short', 'loc_3871']
push ['6E3h']
push ['offset', '$SG86560']
push ['offset', '$SG86561']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_1C]']
sub ['ecx,', '1']
mov ['[ebp+var_1C],', 'ecx']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_24],', 'eax']
push ['0']
mov ['edx,', '[ebp+var_24]']
push ['edx']
call ['_decompressline']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_24]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+0Ch],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+14h],', 'eax']
push ['0']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['_addpos234']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+6Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+74h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+74h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+17Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+17Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+108h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+108h],', 'eax']
jmp ['short', 'loc_395D']
push ['0']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_newline']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_count234']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_addpos234']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+128h],', 'ecx']
jmp ['loc_3830']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
cmp ['ecx,', '[ebp+arg_4]']
jle ['loc_3A8D']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
cmp ['[ecx+6Ch],', 'eax']
jge ['short', 'loc_39CD']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
sub ['eax,', '1']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_freeline']
add ['esp,', '4']
jmp ['loc_3A73']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_1C]']
mov ['[ebp+var_30],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
add ['ecx,', '1']
mov ['[ebp+var_1C],', 'ecx']
mov ['edx,', '[ebp+var_30]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_compressline']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
call ['_addpos234']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_freeline']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+14h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+6Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+74h]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+74h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+17Ch]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+17Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+108h]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+108h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+128h],', 'edx']
jmp ['loc_3977']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
cmp ['edx,', '[ebp+arg_4]']
jz ['short', 'loc_3AB2']
push ['708h']
push ['offset', '$SG86570']
push ['offset', '$SG86571']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_count234']
add ['esp,', '4']
cmp ['eax,', '[ebp+arg_4]']
jz ['short', 'loc_3ADD']
push ['709h']
push ['offset', '$SG86573']
push ['offset', '$SG86574']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_1C]']
cmp ['ecx,', '[ebp+arg_C]']
jle ['short', 'loc_3B10']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_1C]']
sub ['edx,', '1']
mov ['[ebp+var_1C],', 'edx']
jmp ['short', 'loc_3ADD']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_1C]']
cmp ['ecx,', '[eax+14h]']
jge ['short', 'loc_3B24']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_1C]']
mov ['[edx+14h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
call ['_count234']
add ['esp,', '4']
cmp ['eax,', '[ebp+arg_C]']
jle ['short', 'loc_3B4F']
push ['713h']
push ['offset', '$SG86580']
push ['offset', '$SG86581']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
call ['_count234']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
cmp ['eax,', '[ecx+14h]']
jge ['short', 'loc_3B7D']
push ['714h']
push ['offset', '$SG86583']
push ['offset', '$SG86584']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+10h],', '0']
push ['4']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_10],', '0']
jmp ['short', 'loc_3BAA']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_10]']
cmp ['eax,', '[ebp+arg_4]']
jge ['short', 'loc_3C05']
push ['0']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_newline']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_10]']
mov ['edx,', '[ebp+var_8]']
mov ['[edx+ecx*4],', 'eax']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_3BDF']
mov ['eax,', '[ebp+var_14]']
add ['eax,', '1']
mov ['[ebp+var_14],', 'eax']
mov ['ecx,', '[ebp+var_14]']
cmp ['ecx,', '[ebp+arg_8]']
jge ['short', 'loc_3C03']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+edx*4]']
mov ['edx,', '[ebp+var_14]']
imul ['edx,', '0Ch']
mov ['eax,', '[ecx+14h]']
mov ['dword', 'ptr', '[eax+edx+4],', '3FFFFh']
jmp ['short', 'loc_3BD6']
jmp ['short', 'loc_3BA1']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+18h],', '0']
jz ['short', 'loc_3C3F']
mov ['[ebp+var_10],', '0']
jmp ['short', 'loc_3C20']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_10]']
cmp ['eax,', '[ebp+var_18]']
jge ['short', 'loc_3C3F']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_10]']
mov ['ecx,', '[edx+eax*4]']
push ['ecx']
call ['_freeline']
add ['esp,', '4']
jmp ['short', 'loc_3C17']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
mov ['[ecx+18h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+20h],', '0FFFFFFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0FFFFFFFFh']
push ['0']
call ['_newtree234']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_10],', '0']
jmp ['short', 'loc_3C8A']
mov ['edx,', '[ebp+var_10]']
add ['edx,', '1']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_10]']
cmp ['eax,', '[ebp+arg_4]']
jge ['short', 'loc_3CBD']
push ['1']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_newline']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_10]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_addpos234']
add ['esp,', '0Ch']
jmp ['short', 'loc_3C81']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0Ch],', '0']
jz ['short', 'loc_3CFD']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_3CEE']
mov ['eax,', '[ebp+var_C]']
push ['eax']
call ['_freeline']
add ['esp,', '4']
jmp ['short', 'loc_3CC6']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
call ['_freetree234']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+0Ch],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+1A8h],', '0']
push ['1']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E40h]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E40h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+12Ch],', '0']
jle ['short', 'loc_3D4E']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
mov ['[ebp+var_34],', 'ecx']
jmp ['short', 'loc_3D55']
mov ['[ebp+var_34],', '0']
mov ['edx,', '[ebp+var_34]']
mov ['[ebp+var_28],', 'edx']
jmp ['short', 'loc_3D66']
mov ['eax,', '[ebp+var_28]']
add ['eax,', '1']
mov ['[ebp+var_28],', 'eax']
mov ['ecx,', '[ebp+var_28]']
cmp ['ecx,', '[ebp+arg_8]']
jge ['short', 'loc_3D96']
mov ['edx,', '[ebp+var_28]']
and ['edx,', '80000007h']
jns ['short', 'loc_3D7E']
dec ['edx']
or ['edx,', '0FFFFFFF8h']
inc ['edx']
neg ['edx']
sbb ['edx,', 'edx']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E40h]']
mov ['eax,', '[ebp+var_28]']
mov ['[ecx+eax],', 'dl']
jmp ['short', 'loc_3D5D']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+74h],', '0']
jge ['short', 'loc_3DA9']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+74h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
cmp ['ecx,', '[ebp+arg_4]']
jl ['short', 'loc_3DC0']
mov ['edx,', '[ebp+arg_4]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+74h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+78h]']
cmp ['edx,', '[ebp+arg_8]']
jl ['short', 'loc_3DD7']
mov ['eax,', '[ebp+arg_8]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+78h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+108h],', '0']
jge ['short', 'loc_3DF0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+108h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+108h]']
cmp ['edx,', '[ebp+arg_4]']
jl ['short', 'loc_3E0D']
mov ['eax,', '[ebp+arg_4]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+108h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10Ch]']
cmp ['eax,', '[ebp+arg_8]']
jl ['short', 'loc_3E2A']
mov ['ecx,', '[ebp+arg_8]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+6Ch],', '0']
jge ['short', 'loc_3E3D']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+6Ch],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
cmp ['eax,', '[ebp+arg_4]']
jl ['short', 'loc_3E54']
mov ['ecx,', '[ebp+arg_4]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+6Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
cmp ['ecx,', '[ebp+arg_8]']
jl ['short', 'loc_3E6B']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+70h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+17Ch],', '0']
jge ['short', 'loc_3E84']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+17Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+17Ch]']
cmp ['ecx,', '[ebp+arg_4]']
jl ['short', 'loc_3EA1']
mov ['edx,', '[ebp+arg_4]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+17Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+178h]']
cmp ['edx,', '[ebp+arg_8]']
jl ['short', 'loc_3EBE']
mov ['eax,', '[ebp+arg_8]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+178h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+17Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+178h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+188h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+8Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+128h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_8]']
mov ['[edx+12Ch],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_C]']
mov ['[ecx+130h],', 'edx']
push ['0']
push ['0']
mov ['eax,', '[ebp+var_20]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_swap_screen']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_update_sbar']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_update']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+107Ch],', '0']
jz ['short', 'loc_3F83']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1080h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+107Ch]']
call ['eax']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['edi']
pop ['esi']
add ['esp,', '34h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_newline        proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['18h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
push ['0Ch']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+14h],', 'eax']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_3FEC']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[ebp+arg_4]']
jge ['short', 'loc_4031']
cmp ['[ebp+arg_8],', '0']
jz ['short', 'loc_4005']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '54h']
mov ['[ebp+var_C],', 'ecx']
jmp ['short', 'loc_400E']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '48h']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['edx,', '[edx+14h]']
add ['edx,', 'ecx']
mov ['ecx,', '[eax]']
mov ['[edx],', 'ecx']
mov ['ecx,', '[eax+4]']
mov ['[edx+4],', 'ecx']
mov ['eax,', '[eax+8]']
mov ['[edx+8],', 'eax']
jmp ['short', 'loc_3FE3']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+8],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+4],', 'ecx']
xor ['edx,', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['[eax],', 'dx']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0Ch],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_compressline   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_10],', '0']
mov ['[ebp+var_C],', '0']
mov ['[ebp+var_8],', '0']
lea ['eax,', '[ebp+var_10]']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_1C],', 'edx']
cmp ['[ebp+var_1C],', '80h']
jl ['short', 'loc_40EF']
mov ['eax,', '[ebp+var_1C]']
and ['eax,', '7Fh']
or ['eax,', '80h']
push ['eax']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
call ['_add']
add ['esp,', '8']
mov ['edx,', '[ebp+var_1C]']
sar ['edx,', '7']
mov ['[ebp+var_1C],', 'edx']
jmp ['short', 'loc_40C3']
movzx ['eax,', 'byte', 'ptr', '[ebp+var_1C]']
push ['eax']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
call ['_add']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
movzx ['eax,', 'word', 'ptr', '[edx]']
mov ['[ebp+var_20],', 'eax']
cmp ['[ebp+var_20],', '80h']
jl ['short', 'loc_4136']
mov ['ecx,', '[ebp+var_20]']
and ['ecx,', '7Fh']
or ['ecx,', '80h']
push ['ecx']
mov ['edx,', '[ebp+var_18]']
push ['edx']
call ['_add']
add ['esp,', '8']
mov ['eax,', '[ebp+var_20]']
sar ['eax,', '7']
mov ['[ebp+var_20],', 'eax']
jmp ['short', 'loc_4109']
movzx ['ecx,', 'byte', 'ptr', '[ebp+var_20]']
push ['ecx']
mov ['edx,', '[ebp+var_18]']
push ['edx']
call ['_add']
add ['esp,', '8']
push ['offset', '_makeliteral_chr']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
call ['_makerle']
add ['esp,', '0Ch']
push ['offset', '_makeliteral_attr']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
mov ['eax,', '[ebp+var_18]']
push ['eax']
call ['_makerle']
add ['esp,', '0Ch']
push ['offset', '_makeliteral_cc']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', '[ebp+var_18]']
push ['edx']
call ['_makerle']
add ['esp,', '0Ch']
push ['1']
mov ['eax,', '[ebp+var_18]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_18]']
mov ['eax,', '[edx]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN9_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '20h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_add            proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+4]']
cmp ['edx,', '[ecx+8]']
jl ['short', 'loc_4222']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+4]']
imul ['eax,', '3']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
add ['eax,', '200h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+8],', 'eax']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
mov ['cl,', '[ebp+arg_4]']
mov ['[eax+edx],', 'cl']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+4],', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_makerle        proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '4Ch']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_4C]']
mov ['ecx,', '13h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+14h]']
mov ['[ebp+var_24],', 'ecx']
mov ['[ebp+var_2C],', '0']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+4]']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_4],', 'edx']
mov ['[ebp+var_8],', '0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
mov ['[ebp+var_14],', '0']
mov ['ecx,', '[ebp+var_14]']
mov ['[ebp+var_10],', 'ecx']
mov ['[ebp+var_20],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+var_C]']
sub ['eax,', '1']
mov ['[ebp+var_C],', 'eax']
test ['edx,', 'edx']
jle ['short', 'loc_42C7']
mov ['[ebp+var_48],', '1']
jmp ['short', 'loc_42CE']
mov ['[ebp+var_48],', '0']
cmp ['[ebp+var_48],', '0']
jz ['loc_45EF']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_1C],', 'edx']
mov ['eax,', '[ebp+var_24]']
mov ['[ebp+var_4C],', 'eax']
mov ['ecx,', '[ebp+var_24]']
add ['ecx,', '0Ch']
mov ['[ebp+var_24],', 'ecx']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['[ebp+arg_8]']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
sub ['eax,', '[ebp+var_1C]']
mov ['[ebp+Size],', 'eax']
mov ['ecx,', '[ebp+Size]']
cmp ['ecx,', '[ebp+var_10]']
jnz ['loc_4582']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
add ['ecx,', '[ebp+var_1C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
add ['eax,', '[ebp+var_14]']
push ['eax']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['loc_4582']
cmp ['[ebp+Size],', '1']
jg ['short', 'loc_4359']
cmp ['[ebp+var_20],', '0']
jz ['loc_456D']
mov ['ecx,', '[ebp+var_8]']
sub ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
cmp ['[ebp+var_20],', '0']
jz ['short', 'loc_4397']
cmp ['[ebp+var_8],', '0']
jg ['short', 'loc_4385']
push ['1A0h']
push ['offset', '$SG85992']
push ['offset', '$SG85993']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8]']
sub ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_14]']
sub ['ecx,', '[ebp+var_10]']
mov ['[ebp+var_14],', 'ecx']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_43D3']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '1']
cmp ['[ebp+var_14],', 'edx']
jz ['short', 'loc_43BF']
push ['1A6h']
push ['offset', '$SG85996']
push ['offset', '$SG85997']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['[ebp+var_38],', 'ecx']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '[ebp+var_10]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+4],', 'edx']
jmp ['short', 'loc_4442']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
add ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
mov ['eax,', '[ebp+var_14]']
lea ['ecx,', '[edx+eax+1]']
push ['ecx']
call ['_memmove']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_14]']
mov ['[ebp+var_38],', 'edx']
mov ['eax,', '[ebp+var_10]']
mov ['ecx,', '[ebp+var_14]']
lea ['edx,', '[ecx+eax+1]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+4],', 'edx']
cmp ['[ebp+var_8],', '1']
jl ['short', 'loc_441A']
cmp ['[ebp+var_8],', '80h']
jle ['short', 'loc_4431']
push ['1B1h']
push ['offset', '$SG86000']
push ['offset', '$SG86001']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['eax,', '[ebp+var_4]']
mov ['[ecx+eax],', 'dl']
xor ['ecx,', 'ecx']
cmp ['[ebp+var_20],', '0']
setnz ['cl']
add ['ecx,', '2']
mov ['[ebp+var_3C],', 'ecx']
cmp ['[ebp+var_C],', '0']
jle ['loc_44FD']
cmp ['[ebp+var_3C],', '81h']
jge ['loc_44FD']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
mov ['[ebp+var_40],', 'eax']
mov ['ecx,', '[ebp+var_2C]']
mov ['[ebp+var_34],', 'ecx']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', '[ebp+var_24]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['[ebp+arg_8]']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
sub ['eax,', '[ebp+var_40]']
mov ['[ebp+var_44],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_40]']
mov ['[ecx+4],', 'edx']
mov ['eax,', '[ebp+var_44]']
cmp ['eax,', '[ebp+Size]']
jnz ['short', 'loc_44D5']
mov ['ecx,', '[ebp+var_44]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
add ['eax,', '[ebp+var_40]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
mov ['eax,', '[ebp+var_38]']
lea ['ecx,', '[edx+eax+1]']
push ['ecx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_44DD']
mov ['edx,', '[ebp+var_34]']
mov ['[ebp+var_2C],', 'edx']
jmp ['short', 'loc_44FD']
mov ['eax,', '[ebp+var_C]']
sub ['eax,', '1']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_24]']
add ['ecx,', '0Ch']
mov ['[ebp+var_24],', 'ecx']
mov ['edx,', '[ebp+var_3C]']
add ['edx,', '1']
mov ['[ebp+var_3C],', 'edx']
jmp ['loc_4451']
cmp ['[ebp+var_3C],', '2']
jl ['short', 'loc_450C']
cmp ['[ebp+var_3C],', '81h']
jle ['short', 'loc_4523']
push ['1C6h']
push ['offset', '$SG86010']
push ['offset', '$SG86011']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_3C]']
add ['ecx,', '7Eh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
mov ['edx,', '[ebp+var_38]']
mov ['[eax+edx],', 'cl']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
mov ['[ebp+var_4],', 'ecx']
mov ['[ebp+var_8],', '0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_add']
add ['esp,', '8']
mov ['[ebp+var_14],', '0']
mov ['eax,', '[ebp+var_14]']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_20],', '0']
jmp ['loc_42AE']
jmp ['short', 'loc_4580']
mov ['[ebp+var_20],', '1']
mov ['ecx,', '[ebp+Size]']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_1C]']
mov ['[ebp+var_14],', 'edx']
jmp ['short', 'loc_4595']
mov ['[ebp+var_20],', '0']
mov ['eax,', '[ebp+Size]']
mov ['[ebp+var_10],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
mov ['[ebp+var_14],', 'ecx']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
cmp ['[ebp+var_8],', '80h']
jnz ['short', 'loc_45EA']
mov ['eax,', '[ebp+var_8]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
mov ['ecx,', '[ebp+var_4]']
mov ['[edx+ecx],', 'al']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_8],', '0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_add']
add ['esp,', '8']
mov ['[ebp+var_14],', '0']
mov ['edx,', '[ebp+var_14]']
mov ['[ebp+var_10],', 'edx']
mov ['[ebp+var_20],', '0']
jmp ['loc_42AE']
cmp ['[ebp+var_8],', '0']
jle ['short', 'loc_4628']
cmp ['[ebp+var_8],', '80h']
jle ['short', 'loc_4615']
push ['1F4h']
push ['offset', '$SG86017']
push ['offset', '$SG86018']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
mov ['edx,', '[ebp+var_4]']
mov ['[eax+edx],', 'cl']
jmp ['short', 'loc_4631']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+4],', 'ecx']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN32']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '4Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_makeliteral_chr proc near              
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
and ['ecx,', '0FFFFFF80h']
mov ['edx,', '[ebp+arg_8]']
cmp ['ecx,', '[edx]']
jnz ['short', 'loc_46A8']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
and ['ecx,', '7Fh']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_add']
add ['esp,', '8']
jmp ['loc_483F']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax],', '4000h']
jnb ['short', 'loc_46EE']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
shr ['edx,', '8']
and ['edx,', '3Fh']
or ['edx,', '80h']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
and ['edx,', '0FFh']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
jmp ['loc_483F']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx],', '200000h']
jnb ['short', 'loc_474C']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
shr ['eax,', '10h']
and ['eax,', '1Fh']
or ['eax,', '0C0h']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_add']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
shr ['eax,', '8']
and ['eax,', '0FFh']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_add']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
and ['eax,', '0FFh']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_add']
add ['esp,', '8']
jmp ['loc_483F']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx],', '10000000h']
jnb ['short', 'loc_47C5']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
shr ['ecx,', '18h']
and ['ecx,', '0Fh']
or ['ecx,', '0E0h']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_add']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
shr ['ecx,', '10h']
and ['ecx,', '0FFh']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_add']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
shr ['ecx,', '8']
and ['ecx,', '0FFh']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_add']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
and ['ecx,', '0FFh']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_add']
add ['esp,', '8']
jmp ['short', 'loc_483F']
push ['0F0h']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
shr ['edx,', '18h']
and ['edx,', '0FFh']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
shr ['edx,', '10h']
and ['edx,', '0FFh']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
shr ['edx,', '8']
and ['edx,', '0FFh']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
and ['edx,', '0FFh']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
and ['edx,', '0FFFFFF00h']
mov ['eax,', '[ebp+arg_8]']
mov ['[eax],', 'edx']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_makeliteral_attr proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+4]']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
shr ['edx,', '0Dh']
and ['edx,', '0Fh']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+var_8]']
shl ['eax,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_4]']
shr ['ecx,', '4']
and ['ecx,', '0Fh']
or ['ecx,', '[ebp+var_8]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
shr ['edx,', '11h']
shl ['edx,', '0Dh']
mov ['eax,', '[ebp+var_4]']
and ['eax,', '1FFFh']
or ['edx,', 'eax']
mov ['[ebp+var_4],', 'edx']
mov ['ecx,', '[ebp+var_4]']
shr ['ecx,', '8']
shl ['ecx,', '4']
mov ['edx,', '[ebp+var_4]']
and ['edx,', '0Fh']
or ['ecx,', 'edx']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_8]']
shl ['eax,', '17h']
or ['eax,', '[ebp+var_4]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '8000h']
jnb ['short', 'loc_490C']
mov ['ecx,', '[ebp+var_4]']
shr ['ecx,', '8']
and ['ecx,', '0FFh']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_add']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
and ['eax,', '0FFh']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_add']
add ['esp,', '8']
jmp ['short', 'loc_496F']
mov ['edx,', '[ebp+var_4]']
shr ['edx,', '18h']
and ['edx,', '7Fh']
or ['edx,', '80h']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
shr ['ecx,', '10h']
and ['ecx,', '0FFh']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_add']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4]']
shr ['eax,', '8']
and ['eax,', '0FFh']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_add']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
and ['edx,', '0FFh']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add']
add ['esp,', '8']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_makeliteral_cc proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '0']
jz ['short', 'loc_4A10']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+8]']
imul ['edx,', '0Ch']
add ['edx,', '[ebp+arg_4]']
mov ['[ebp+arg_4],', 'edx']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax],', '0']
jnz ['short', 'loc_49F3']
push ['271h']
push ['offset', '$SG86083']
push ['offset', '$SG86084']
call ['__wassert']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', '0']
lea ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_makeliteral_chr']
add ['esp,', '0Ch']
jmp ['short', 'loc_49BC']
mov ['[ebp+var_20],', '0']
mov ['[ebp+var_C],', '0']
lea ['edx,', '[ebp+var_C]']
push ['edx']
lea ['eax,', '[ebp+var_20]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_makeliteral_chr']
add ['esp,', '0Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN9_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_provide_resize_fn proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+107Ch],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_8]']
mov ['[edx+1080h],', 'eax']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_4AED']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+12Ch],', '0']
jle ['short', 'loc_4AED']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+128h],', '0']
jle ['short', 'loc_4AED']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
call ['[ebp+arg_4]']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_find_last_nonempty_line proc near      
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_count234']
add ['esp,', '4']
sub ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_4B34']
mov ['ecx,', '[ebp+var_4]']
sub ['ecx,', '1']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+var_4],', '0']
jl ['short', 'loc_4B9D']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_C],', '0']
jmp ['short', 'loc_4B5F']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '1']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+var_C]']
cmp ['eax,', '[edx+4]']
jge ['short', 'loc_4B8E']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '54h']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_8]']
add ['edx,', '[eax+14h]']
push ['edx']
call ['_termchars_equal']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_4B8C']
jmp ['short', 'loc_4B8E']
jmp ['short', 'loc_4B56']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+var_C]']
cmp ['edx,', '[ecx+4]']
jz ['short', 'loc_4B9B']
jmp ['short', 'loc_4B9D']
jmp ['short', 'loc_4B2B']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_termchars_equal proc near              
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_termchars_equal_override']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_termchars_equal_override proc near     
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
cmp ['ecx,', '[ebp+arg_8]']
jz ['short', 'loc_4BFD']
xor ['eax,', 'eax']
jmp ['short', 'loc_4C76']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
and ['eax,', '0FFFFFFFh']
mov ['ecx,', '[ebp+arg_C]']
and ['ecx,', '0FFFFFFFh']
cmp ['eax,', 'ecx']
jz ['short', 'loc_4C19']
xor ['eax,', 'eax']
jmp ['short', 'loc_4C76']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jnz ['short', 'loc_4C2B']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '0']
jz ['short', 'loc_4C71']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+8],', '0']
jz ['short', 'loc_4C3D']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jnz ['short', 'loc_4C41']
xor ['eax,', 'eax']
jmp ['short', 'loc_4C76']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
imul ['ecx,', '0Ch']
add ['ecx,', '[ebp+arg_0]']
mov ['[ebp+arg_0],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+8]']
imul ['eax,', '0Ch']
add ['eax,', '[ebp+arg_4]']
mov ['[ebp+arg_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ecx]']
cmp ['eax,', '[edx]']
jz ['short', 'loc_4C6F']
xor ['eax,', 'eax']
jmp ['short', 'loc_4C76']
jmp ['short', 'loc_4C19']
mov ['eax,', '1']
pop ['ebp']
retn
endp
_swap_screen    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_4CA6']
mov ['[ebp+arg_8],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+1A4h]']
jz ['loc_5091']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+1A4h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0Ch]']
mov ['[ebp+var_18],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
mov ['[eax+0Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_18]']
mov ['[eax+8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_find_last_nonempty_line']
add ['esp,', '8']
add ['eax,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1A8h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4D25']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_4D25']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+178h]']
mov ['[edx+70h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+178h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
mov ['[ebp+var_4],', 'edx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4D55']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_4D55']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+17Ch]']
mov ['[eax+6Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+17Ch],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+7Ch]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4D7F']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+19Ch]']
mov ['[ecx+7Ch],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx+19Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+80h]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4DAF']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1A0h]']
mov ['[edx+80h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+1A0h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+84h]']
mov ['[ebp+var_4],', 'edx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4DDF']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+180h]']
mov ['[eax+84h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+180h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+88h]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4E0F']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+184h]']
mov ['[ecx+88h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx+184h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8Ch]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4E3F']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+188h]']
mov ['[edx+8Ch],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+188h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+90h]']
mov ['[ebp+var_4],', 'edx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4E6F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18Ch]']
mov ['[eax+90h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+18Ch],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+94h]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4E9F']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+190h]']
mov ['[ecx+94h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx+190h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0DCh]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4ECF']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+198h]']
mov ['[edx+0DCh],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+198h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0D0h]']
mov ['[ebp+var_4],', 'edx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4EFF']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+194h]']
mov ['[eax+0D0h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+194h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+74h]']
mov ['ecx,', '[edx+78h]']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4F3E']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_4F3E']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+108h]']
mov ['ecx,', '[edx+10Ch]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+74h],', 'eax']
mov ['[edx+78h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_10]']
mov ['[eax+108h],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[eax+10Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+98h]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4F7D']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_4F7D']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+114h]']
mov ['[edx+98h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+114h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+9Ch]']
mov ['[ebp+var_4],', 'edx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4FB3']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_4FB3']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+118h]']
mov ['[eax+9Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+118h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+44h]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_4FE3']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_4FE3']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+110h]']
mov ['[ecx+44h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx+110h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0A0h]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_5019']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_5019']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+11Ch]']
mov ['[edx+0A0h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+11Ch],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0A4h]']
mov ['[ebp+var_4],', 'edx']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_504F']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_504F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+120h]']
mov ['[eax+0A4h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+120h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0D4h]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_5085']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_5085']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+124h]']
mov ['[ecx+0D4h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
mov ['[ecx+124h],', 'edx']
cmp ['[ebp+arg_8],', '0']
jz ['short', 'loc_50B2']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+8],', '0']
jz ['short', 'loc_50B2']
push ['1']
push ['1']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_erase_lots']
add ['esp,', '10h']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN26']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_update_sbar    proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sblines']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '[eax+10h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '[edx+128h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1088h]']
push ['edx']
call ['_set_sbar']
add ['esp,', '10h']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sblines        proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_count234']
add ['esp,', '4']
mov ['[ebp+var_4],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1118h],', '0']
jz ['short', 'loc_5199']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1A4h],', '0']
jz ['short', 'loc_5199']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0']
jz ['short', 'loc_5199']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '[edx+1A8h]']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_scroll         proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_51E4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1A4h],', '0']
jz ['short', 'loc_51EB']
mov ['[ebp+arg_10],', '0']
mov ['ecx,', '[ebp+arg_8]']
sub ['ecx,', '[ebp+arg_4]']
add ['ecx,', '1']
mov ['[ebp+var_10],', 'ecx']
cmp ['[ebp+arg_C],', '0']
jge ['loc_5389']
mov ['edx,', '[ebp+arg_C]']
neg ['edx']
mov ['[ebp+arg_C],', 'edx']
mov ['eax,', '[ebp+arg_C]']
cmp ['eax,', '[ebp+var_10]']
jle ['short', 'loc_5217']
mov ['ecx,', '[ebp+var_10]']
mov ['[ebp+arg_C],', 'ecx']
mov ['edx,', '[ebp+arg_C]']
mov ['eax,', '[ebp+arg_C]']
sub ['eax,', '1']
mov ['[ebp+arg_C],', 'eax']
test ['edx,', 'edx']
jle ['short', 'loc_5230']
mov ['[ebp+var_1C],', '1']
jmp ['short', 'loc_5237']
mov ['[ebp+var_1C],', '0']
cmp ['[ebp+var_1C],', '0']
jz ['loc_5384']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_resizeline']
add ['esp,', '0Ch']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_5283']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[eax+12Ch]']
jge ['short', 'loc_52AA']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '54h']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_copy_termchar']
add ['esp,', '0Ch']
jmp ['short', 'loc_527A']
xor ['edx,', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['[eax],', 'dx']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['_addpos234']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E54h]']
cmp ['eax,', '[ebp+arg_4]']
jl ['short', 'loc_5324']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E54h]']
cmp ['edx,', '[ebp+arg_8]']
jg ['short', 'loc_5324']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E54h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E54h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E54h]']
cmp ['ecx,', '[ebp+arg_8]']
jle ['short', 'loc_5324']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+0E54h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E58h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E5Ch]']
cmp ['eax,', '[ebp+arg_4]']
jl ['short', 'loc_537F']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E5Ch]']
cmp ['edx,', '[ebp+arg_8]']
jg ['short', 'loc_537F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E5Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E5Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E5Ch]']
cmp ['ecx,', '[ebp+arg_8]']
jle ['short', 'loc_537F']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+0E5Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E60h],', '0']
jmp ['loc_5217']
jmp ['loc_5647']
mov ['edx,', '[ebp+arg_C]']
cmp ['edx,', '[ebp+var_10]']
jle ['short', 'loc_5397']
mov ['eax,', '[ebp+var_10]']
mov ['[ebp+arg_C],', 'eax']
mov ['ecx,', '[ebp+arg_C]']
mov ['edx,', '[ebp+arg_C]']
sub ['edx,', '1']
mov ['[ebp+arg_C],', 'edx']
test ['ecx,', 'ecx']
jle ['short', 'loc_53B0']
mov ['[ebp+var_20],', '1']
jmp ['short', 'loc_53B7']
mov ['[ebp+var_20],', '0']
cmp ['[ebp+var_20],', '0']
jz ['loc_5647']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_10],', '0']
jz ['loc_5496']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+130h],', '0']
jle ['loc_5496']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4]']
push ['edx']
call ['_count234']
add ['esp,', '4']
mov ['[ebp+var_14],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_14]']
cmp ['ecx,', '[eax+130h]']
jnz ['short', 'loc_543C']
mov ['edx,', '[ebp+var_14]']
sub ['edx,', '1']
mov ['[ebp+var_14],', 'edx']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_delpos234']
add ['esp,', '8']
mov ['[ebp+var_18],', 'eax']
mov ['edx,', '[ebp+var_18]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
jmp ['short', 'loc_544B']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+14h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+14h],', 'ecx']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_compressline']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_addpos234']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+130h]']
neg ['edx']
mov ['eax,', '[ebp+arg_0]']
cmp ['[eax+10h],', 'edx']
jle ['short', 'loc_5496']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jge ['short', 'loc_5496']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_resizeline']
add ['esp,', '0Ch']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_54C2']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ecx+12Ch]']
jge ['short', 'loc_54E9']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '54h']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_copy_termchar']
add ['esp,', '0Ch']
jmp ['short', 'loc_54B9']
xor ['eax,', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx],', 'ax']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_addpos234']
add ['esp,', '0Ch']
cmp ['[ebp+arg_10],', '0']
jz ['short', 'loc_551E']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+130h]']
neg ['ecx']
mov ['[ebp+var_24],', 'ecx']
jmp ['short', 'loc_5524']
mov ['edx,', '[ebp+arg_4]']
mov ['[ebp+var_24],', 'edx']
mov ['eax,', '[ebp+var_24]']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0E48h],', '0']
jz ['loc_5642']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E54h]']
cmp ['eax,', '[ebp+var_C]']
jl ['short', 'loc_5592']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E54h]']
cmp ['edx,', '[ebp+arg_8]']
jg ['short', 'loc_5592']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E54h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E54h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E54h]']
cmp ['ecx,', '[ebp+var_C]']
jge ['short', 'loc_5592']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_C]']
mov ['[edx+0E54h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E58h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E5Ch]']
cmp ['eax,', '[ebp+var_C]']
jl ['short', 'loc_55EA']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E5Ch]']
cmp ['edx,', '[ebp+arg_8]']
jg ['short', 'loc_55EA']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E5Ch]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E5Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E5Ch]']
cmp ['ecx,', '[ebp+var_C]']
jge ['short', 'loc_55EA']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_C]']
mov ['[edx+0E5Ch],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E60h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E64h]']
cmp ['eax,', '[ebp+var_C]']
jl ['short', 'loc_5642']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E64h]']
cmp ['edx,', '[ebp+arg_8]']
jg ['short', 'loc_5642']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E64h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E64h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E64h]']
cmp ['ecx,', '[ebp+var_C]']
jge ['short', 'loc_5642']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_C]']
mov ['[edx+0E64h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E68h],', '0']
jmp ['loc_5397']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_copy_termchar  proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_clear_cc']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[ebp+arg_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+14h]']
add ['ecx,', 'eax']
mov ['eax,', '[edx]']
mov ['[ecx],', 'eax']
mov ['eax,', '[edx+4]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[edx+8]']
mov ['[ecx+8],', 'edx']
mov ['eax,', '[ebp+arg_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['dword', 'ptr', '[edx+eax+8],', '0']
mov ['eax,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[eax+8],', '0']
jz ['short', 'loc_56D4']
mov ['ecx,', '[ebp+arg_8]']
mov ['edx,', '[ecx+8]']
imul ['edx,', '0Ch']
add ['edx,', '[ebp+arg_8]']
mov ['[ebp+arg_8],', 'edx']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_add_cc']
add ['esp,', '0Ch']
jmp ['short', 'loc_56A4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_erase_lots     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '38h']
push ['edi']
lea ['edi,', '[ebp+var_38]']
mov ['ecx,', '0Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['[ebp+var_28],', '0']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_573B']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
mov ['[ebp+var_C],', 'ecx']
mov ['[ebp+var_8],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
add ['eax,', '1']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', '0']
mov ['[ebp+var_24],', '0']
jmp ['short', 'loc_5763']
mov ['[ebp+var_C],', '0']
mov ['[ebp+var_8],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
mov ['[ebp+var_1C],', 'edx']
mov ['[ebp+var_18],', '0']
mov ['[ebp+var_24],', '1']
cmp ['[ebp+arg_8],', '0']
jnz ['short', 'loc_5778']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
mov ['edx,', '[eax+70h]']
mov ['[ebp+var_C],', 'ecx']
mov ['[ebp+var_8],', 'edx']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_57C4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
mov ['edx,', '[eax+70h]']
mov ['[ebp+var_1C],', 'ecx']
mov ['[ebp+var_18],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_18]']
cmp ['ecx,', '[eax+12Ch]']
jnz ['short', 'loc_57B4']
mov ['[ebp+var_18],', '0']
mov ['edx,', '[ebp+var_1C]']
add ['edx,', '1']
mov ['[ebp+var_1C],', 'edx']
mov ['[ebp+var_34],', '1']
jmp ['short', 'loc_57C4']
mov ['eax,', '[ebp+var_18]']
add ['eax,', '1']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_34],', '0']
cmp ['[ebp+arg_8],', '0']
jz ['short', 'loc_57D0']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_57EA']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_18]']
push ['eax']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_selection']
add ['esp,', '14h']
cmp ['[ebp+var_C],', '0']
jnz ['short', 'loc_582C']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_582C']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_1C]']
cmp ['eax,', '[edx+128h]']
jnz ['short', 'loc_582C']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_invalidate']
add ['esp,', '4']
cmp ['[ebp+var_C],', '0']
jnz ['short', 'loc_584B']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_584B']
cmp ['[ebp+var_18],', '0']
jnz ['short', 'loc_584B']
cmp ['[ebp+var_24],', '0']
jz ['short', 'loc_584B']
mov ['[ebp+var_28],', '1']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1118h],', '0']
jz ['short', 'loc_58B0']
cmp ['[ebp+var_28],', '0']
jz ['short', 'loc_58B0']
mov ['eax,', '[ebp+var_1C]']
mov ['[ebp+var_2C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_1C]']
cmp ['edx,', '[ecx+128h]']
jnz ['short', 'loc_588A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_find_last_nonempty_line']
add ['esp,', '8']
add ['eax,', '1']
mov ['[ebp+var_2C],', 'eax']
cmp ['[ebp+var_2C],', '0']
jle ['short', 'loc_58AB']
push ['1']
mov ['eax,', '[ebp+var_2C]']
push ['eax']
mov ['ecx,', '[ebp+var_2C]']
sub ['ecx,', '1']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_scroll']
add ['esp,', '14h']
jmp ['loc_59AA']
push ['1']
push ['973h']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_30],', 'eax']
mov ['edx,', '[ebp+var_C]']
cmp ['edx,', '[ebp+var_1C]']
jl ['short', 'loc_58EA']
mov ['eax,', '[ebp+var_C]']
cmp ['eax,', '[ebp+var_1C]']
jnz ['loc_59AA']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[ebp+var_18]']
jge ['loc_59AA']
mov ['edx,', '[ebp+var_30]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_check_line_size']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ecx+12Ch]']
jnz ['short', 'loc_5929']
cmp ['[ebp+var_24],', '0']
jnz ['short', 'loc_591F']
mov ['eax,', '[ebp+var_30]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
and ['ecx,', '0FFFFFFCFh']
mov ['edx,', '[ebp+var_30]']
mov ['[edx],', 'cx']
jmp ['short', 'loc_5927']
xor ['eax,', 'eax']
mov ['ecx,', '[ebp+var_30]']
mov ['[ecx],', 'ax']
jmp ['short', 'loc_5940']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '54h']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_30]']
push ['ecx']
call ['_copy_termchar']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[edx+12Ch]']
jnz ['short', 'loc_5967']
mov ['[ebp+var_8],', '0']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '1']
mov ['[ebp+var_C],', 'ecx']
mov ['[ebp+var_38],', '1']
jmp ['short', 'loc_5977']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
mov ['[ebp+var_38],', '0']
cmp ['[ebp+var_38],', '0']
jz ['short', 'loc_59A5']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_C]']
cmp ['ecx,', '[eax+128h]']
jge ['short', 'loc_59A5']
push ['1']
push ['97Fh']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_30],', 'eax']
jmp ['loc_58CA']
cmp ['[ebp+var_28],', '0']
jz ['short', 'loc_59C6']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1A4h],', '0']
jnz ['short', 'loc_59C6']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+14h],', '0']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN31_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '38h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_check_selection proc near              
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+0E5Ch]']
jl ['short', 'loc_5A49']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[edx+0E5Ch]']
jnz ['short', 'loc_5A7F']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_8]']
cmp ['edx,', '[ecx+0E60h]']
jge ['short', 'loc_5A7F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E54h]']
cmp ['ecx,', '[ebp+arg_C]']
jl ['short', 'loc_5A73']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E54h]']
cmp ['eax,', '[ebp+arg_C]']
jnz ['short', 'loc_5A7F']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E58h]']
cmp ['edx,', '[ebp+arg_10]']
jge ['short', 'loc_5A7F']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_deselect']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_check_boundary proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_5AAB']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+12Ch]']
jle ['short', 'loc_5AB0']
jmp ['loc_5B76']
push ['1']
push ['92Dh']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_check_line_size']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+12Ch]']
jnz ['short', 'loc_5AF9']
mov ['edx,', '[ebp+var_4]']
movzx ['eax,', 'word', 'ptr', '[edx]']
and ['eax,', '0FFFFFFDFh']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx],', 'ax']
jmp ['short', 'loc_5B76']
mov ['edx,', '[ebp+arg_4]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
cmp ['dword', 'ptr', '[edx+ecx],', '0DFFFh']
jnz ['short', 'loc_5B76']
mov ['edx,', '[ebp+arg_4]']
sub ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_clear_cc']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_clear_cc']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_4]']
sub ['eax,', '1']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
mov ['dword', 'ptr', '[eax+edx],', '0D820h']
mov ['eax,', '[ebp+arg_4]']
sub ['eax,', '1']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
add ['edx,', 'eax']
mov ['eax,', '[ebp+arg_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+14h]']
add ['ecx,', 'eax']
mov ['eax,', '[edx]']
mov ['[ecx],', 'eax']
mov ['eax,', '[edx+4]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[edx+8]']
mov ['[ecx+8],', 'edx']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_print_finish proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0ECh],', '0']
jnz ['short', 'loc_5BBF']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0F0h],', '0']
jnz ['short', 'loc_5BBF']
jmp ['loc_5C9B']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_print_flush']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '0F8h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
mov ['[ebp+var_1C],', 'eax']
cmp ['[ebp+var_1C],', '0']
jle ['short', 'loc_5C62']
lea ['ecx,', '[ebp+var_14]']
push ['ecx']
lea ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '0F8h']
push ['eax']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
mov ['dl,', '[ecx]']
mov ['[ebp+var_21],', 'dl']
movsx ['eax,', '[ebp+var_21]']
cmp ['eax,', '1Bh']
jz ['short', 'loc_5C18']
movsx ['ecx,', '[ebp+var_21]']
cmp ['ecx,', '0FFFFFF9Bh']
jnz ['short', 'loc_5C31']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '0F8h']
push ['eax']
call ['_bufchain_consume']
add ['esp,', '8']
jmp ['short', 'loc_5C62']
jmp ['short', 'loc_5C5D']
push ['1']
lea ['ecx,', '[ebp+var_21]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+104h]']
push ['eax']
call ['_printer_job_data']
add ['esp,', '0Ch']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '0F8h']
push ['ecx']
call ['_bufchain_consume']
add ['esp,', '8']
jmp ['loc_5BCB']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+104h]']
push ['eax']
call ['_printer_finish_job']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+104h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0F0h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0ECh],', '0']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN13_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_print_flush proc near             
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1Ch']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '0F8h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
mov ['[ebp+var_1C],', 'eax']
cmp ['[ebp+var_1C],', '5']
jle ['short', 'loc_5D95']
lea ['ecx,', '[ebp+var_14]']
push ['ecx']
lea ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '0F8h']
push ['eax']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_1C]']
sub ['ecx,', '5']
cmp ['[ebp+var_14],', 'ecx']
jle ['short', 'loc_5D63']
mov ['edx,', '[ebp+var_1C]']
sub ['edx,', '5']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_14]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+104h]']
push ['eax']
call ['_printer_job_data']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '0F8h']
push ['edx']
call ['_bufchain_consume']
add ['esp,', '8']
jmp ['short', 'loc_5D1C']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN9_4']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '1Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_paint       proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0C0h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_C0]']
mov ['ecx,', '30h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['[ebp+var_30],', '400h']
push ['2']
mov ['eax,', '[ebp+var_30]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_2C],', 'eax']
push ['0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_34],', 'eax']
mov ['eax,', '[ebp+arg_0]']
xor ['ecx,', 'ecx']
cmp ['dword', 'ptr', '[eax+0A8h],', '0']
setz ['cl']
mov ['edx,', '[ebp+arg_0]']
xor ['eax,', 'eax']
cmp ['dword', 'ptr', '[edx+138h],', '0']
setz ['al']
xor ['ecx,', 'eax']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '100000h']
mov ['[ebp+var_14],', 'ecx']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0B0h],', '0']
jz ['short', 'loc_5EC7']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+134h],', '0']
jz ['short', 'loc_5EA7']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0BCh],', '0']
jnz ['short', 'loc_5E95']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1100h],', '0']
jnz ['short', 'loc_5E9E']
mov ['[ebp+var_18],', '40000000h']
jmp ['short', 'loc_5EA5']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_5EAE']
mov ['[ebp+var_18],', '20000000h']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+8Ch],', '0']
jz ['short', 'loc_5EC5']
mov ['eax,', '[ebp+var_18]']
or ['eax,', '10000000h']
mov ['[ebp+var_18],', 'eax']
jmp ['short', 'loc_5ECE']
mov ['[ebp+var_18],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+6Ch]']
sub ['eax,', '[edx+10h]']
mov ['[ebp+var_C],', 'eax']
push ['0']
push ['1344h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_38],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+var_38]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_bidi_line']
add ['esp,', '0Ch']
mov ['[ebp+var_3C],', 'eax']
cmp ['[ebp+var_3C],', '0']
jz ['short', 'loc_5F3E']
mov ['eax,', '[ebp+var_C]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10CCh]']
mov ['eax,', '[edx+eax+8]']
mov ['ecx,', '[ebp+var_10]']
mov ['edx,', '[eax+ecx*4]']
mov ['[ebp+var_10],', 'edx']
jmp ['short', 'loc_5F47']
mov ['eax,', '[ebp+var_38]']
mov ['ecx,', '[eax+14h]']
mov ['[ebp+var_3C],', 'ecx']
cmp ['[ebp+var_10],', '0']
jle ['short', 'loc_5F68']
mov ['edx,', '[ebp+var_10]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_3C]']
cmp ['dword', 'ptr', '[eax+edx],', '0DFFFh']
jnz ['short', 'loc_5F68']
mov ['ecx,', '[ebp+var_10]']
sub ['ecx,', '1']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_38]']
push ['edx']
call ['_unlineptr']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+20h],', '0']
jl ['loc_6036']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+24h]']
cmp ['edx,', '[ebp+var_18]']
jnz ['short', 'loc_5FA6']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+20h]']
cmp ['ecx,', '[ebp+var_C]']
jnz ['short', 'loc_5FA6']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1Ch]']
cmp ['eax,', '[ebp+var_10]']
jz ['loc_6036']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+20h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx+edx*4]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1Ch]']
imul ['ecx,', '0Ch']
add ['ecx,', '[edx+14h]']
mov ['[ebp+var_40],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1Ch],', '0']
jle ['short', 'loc_5FEA']
mov ['eax,', '[ebp+var_40]']
cmp ['dword', 'ptr', '[eax],', '0DFFFh']
jnz ['short', 'loc_5FEA']
mov ['ecx,', '[ebp+var_40]']
mov ['edx,', '[ecx-8]']
or ['edx,', '3FFFFh']
mov ['eax,', '[ebp+var_40]']
mov ['[eax-8],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
cmp ['[eax+1Ch],', 'edx']
jge ['short', 'loc_601B']
mov ['ecx,', '[ebp+var_40]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0DFFFh']
jnz ['short', 'loc_601B']
mov ['edx,', '[ebp+var_40]']
mov ['eax,', '[edx+10h]']
or ['eax,', '3FFFFh']
mov ['ecx,', '[ebp+var_40]']
mov ['[ecx+10h],', 'eax']
mov ['edx,', '[ebp+var_40]']
mov ['eax,', '[edx+4]']
or ['eax,', '3FFFFh']
mov ['ecx,', '[ebp+var_40]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+24h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+20h],', '0FFFFFFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1Ch],', '0FFFFFFFFh']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_605C']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '1']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[eax+128h]']
jge ['loc_6E3D']
mov ['[ebp+var_58],', '0']
mov ['[ebp+var_5C],', '0']
mov ['[ebp+var_60],', '0']
mov ['[ebp+var_64],', '0']
mov ['[ebp+var_68],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '[edx+10h]']
mov ['[ebp+var_24],', 'eax']
push ['0']
push ['1384h']
mov ['ecx,', '[ebp+var_24]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_44],', 'eax']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+var_44]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_bidi_line']
add ['esp,', '0Ch']
mov ['[ebp+var_48],', 'eax']
cmp ['[ebp+var_48],', '0']
jz ['short', 'loc_60EC']
mov ['eax,', '[ebp+var_4]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10CCh]']
mov ['eax,', '[edx+eax+0Ch]']
mov ['[ebp+var_74],', 'eax']
jmp ['short', 'loc_60FC']
mov ['ecx,', '[ebp+var_44]']
mov ['edx,', '[ecx+14h]']
mov ['[ebp+var_48],', 'edx']
mov ['[ebp+var_74],', '0']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_610E']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ecx+12Ch]']
jge ['loc_651E']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
add ['eax,', '[ebp+var_48]']
mov ['[ebp+var_80],', 'eax']
cmp ['[ebp+var_74],', '0']
jz ['short', 'loc_6143']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ebp+var_74]']
mov ['eax,', '[edx+ecx*4]']
mov ['[ebp+var_A8],', 'eax']
jmp ['short', 'loc_614C']
mov ['ecx,', '[ebp+var_8]']
mov ['[ebp+var_A8],', 'ecx']
mov ['edx,', '[ebp+var_A8]']
mov ['[ebp+var_20],', 'edx']
mov ['eax,', '[ebp+var_80]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_7C],', 'ecx']
mov ['edx,', '[ebp+var_80]']
mov ['eax,', '[edx+4]']
mov ['[ebp+var_78],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+10D4h],', '0']
jnz ['short', 'loc_618A']
mov ['edx,', '[ebp+var_78]']
and ['edx,', '0FFFC0000h']
or ['edx,', '100h']
or ['edx,', '20400h']
mov ['[ebp+var_78],', 'edx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+116Ch],', '0']
jnz ['short', 'loc_6204']
mov ['ecx,', '[ebp+var_78]']
and ['ecx,', '1FFh']
mov ['[ebp+var_84],', 'ecx']
cmp ['[ebp+var_84],', '10h']
jl ['short', 'loc_61CC']
cmp ['[ebp+var_84],', '100h']
jge ['short', 'loc_61CC']
mov ['edx,', '[ebp+var_78]']
and ['edx,', '0FFFFFE00h']
or ['edx,', '100h']
mov ['[ebp+var_78],', 'edx']
mov ['eax,', '[ebp+var_78]']
and ['eax,', '3FE00h']
shr ['eax,', '9']
mov ['[ebp+var_84],', 'eax']
cmp ['[ebp+var_84],', '10h']
jl ['short', 'loc_6204']
cmp ['[ebp+var_84],', '100h']
jge ['short', 'loc_6204']
mov ['ecx,', '[ebp+var_78]']
and ['ecx,', '0FFFC01FFh']
or ['ecx,', '20400h']
mov ['[ebp+var_78],', 'ecx']
mov ['edx,', '[ebp+var_7C]']
and ['edx,', '0FFFFFF00h']
mov ['[ebp+var_AC],', 'edx']
cmp ['[ebp+var_AC],', '0D800h']
jz ['short', 'loc_6239']
cmp ['[ebp+var_AC],', '0D900h']
jz ['short', 'loc_6258']
cmp ['[ebp+var_AC],', '0DA00h']
jz ['short', 'loc_6276']
jmp ['short', 'loc_6290']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+var_7C]']
and ['edx,', '0FFh']
movzx ['eax,', 'word', 'ptr', '[ecx+edx*2+210h]']
mov ['[ebp+var_7C],', 'eax']
jmp ['short', 'loc_6290']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
mov ['eax,', '[ebp+var_7C]']
and ['eax,', '0FFh']
movzx ['ecx,', 'word', 'ptr', '[edx+eax*2+610h]']
mov ['[ebp+var_7C],', 'ecx']
jmp ['short', 'loc_6290']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[ebp+var_7C]']
and ['ecx,', '0FFh']
movzx ['edx,', 'word', 'ptr', '[eax+ecx*2+10h]']
mov ['[ebp+var_7C],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
sub ['ecx,', '1']
cmp ['[ebp+var_8],', 'ecx']
jge ['short', 'loc_62B8']
mov ['edx,', '[ebp+var_80]']
cmp ['dword', 'ptr', '[edx+0Ch],', '0DFFFh']
jnz ['short', 'loc_62B8']
mov ['eax,', '[ebp+var_78]']
or ['eax,', '400000h']
mov ['[ebp+var_78],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0E48h],', '2']
jz ['short', 'loc_62D4']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E48h],', '3']
jnz ['loc_63AE']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E4Ch],', '0']
jnz ['short', 'loc_6355']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E54h]']
cmp ['edx,', '[ebp+var_24]']
jl ['short', 'loc_630A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E54h]']
cmp ['ecx,', '[ebp+var_24]']
jnz ['short', 'loc_6340']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E58h]']
cmp ['eax,', '[ebp+var_20]']
jg ['short', 'loc_6340']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_24]']
cmp ['edx,', '[ecx+0E5Ch]']
jl ['short', 'loc_6334']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_24]']
cmp ['ecx,', '[eax+0E5Ch]']
jnz ['short', 'loc_6340']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_20]']
cmp ['eax,', '[edx+0E60h]']
jge ['short', 'loc_6340']
mov ['[ebp+var_B0],', '1']
jmp ['short', 'loc_634A']
mov ['[ebp+var_B0],', '0']
mov ['ecx,', '[ebp+var_B0]']
mov ['[ebp+var_54],', 'ecx']
jmp ['short', 'loc_63AC']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E54h]']
cmp ['eax,', '[ebp+var_24]']
jg ['short', 'loc_6399']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E58h]']
cmp ['edx,', '[ebp+var_20]']
jg ['short', 'loc_6399']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_24]']
cmp ['ecx,', '[eax+0E5Ch]']
jg ['short', 'loc_6399']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_20]']
cmp ['eax,', '[edx+0E60h]']
jge ['short', 'loc_6399']
mov ['[ebp+var_B4],', '1']
jmp ['short', 'loc_63A3']
mov ['[ebp+var_B4],', '0']
mov ['ecx,', '[ebp+var_B4]']
mov ['[ebp+var_54],', 'ecx']
jmp ['short', 'loc_63B5']
mov ['[ebp+var_54],', '0']
mov ['edx,', '[ebp+var_78]']
xor ['edx,', '[ebp+var_14]']
mov ['eax,', '[ebp+var_54]']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '100000h']
xor ['edx,', 'eax']
mov ['[ebp+var_78],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0C4h],', '0']
jz ['short', 'loc_641A']
mov ['edx,', '[ebp+var_78]']
and ['edx,', '200000h']
jz ['short', 'loc_641A']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+134h],', '0']
jz ['short', 'loc_640E']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0C0h],', '0']
jz ['short', 'loc_640E']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
movzx ['ecx,', 'word', 'ptr', '[eax+250h]']
mov ['[ebp+var_7C],', 'ecx']
mov ['edx,', '[ebp+var_78]']
and ['edx,', '0FFDFFFFFh']
mov ['[ebp+var_78],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[eax+14h]']
mov ['eax,', '[ebp+var_7C]']
cmp ['eax,', '[ecx+edx]']
jnz ['short', 'loc_645B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+eax*4]']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ecx+14h]']
mov ['ecx,', '[eax+edx+4]']
and ['ecx,', '0F7FFFFFh']
cmp ['[ebp+var_78],', 'ecx']
jz ['short', 'loc_6489']
mov ['edx,', '[ebp+var_78]']
and ['edx,', '400000h']
jnz ['short', 'loc_6487']
mov ['eax,', '[ebp+var_7C]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_char_width']
add ['esp,', '8']
cmp ['eax,', '2']
jnz ['short', 'loc_6487']
mov ['edx,', '[ebp+var_78]']
or ['edx,', '800000h']
mov ['[ebp+var_78],', 'edx']
jmp ['short', 'loc_64B5']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[eax+14h]']
mov ['eax,', '[edx+ecx+4]']
and ['eax,', '800000h']
jz ['short', 'loc_64B5']
mov ['ecx,', '[ebp+var_78]']
or ['ecx,', '800000h']
mov ['[ebp+var_78],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ebp+var_C]']
jnz ['short', 'loc_64E9']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[ebp+var_10]']
jnz ['short', 'loc_64E9']
mov ['ecx,', '[ebp+var_78]']
or ['ecx,', '[ebp+var_18]']
mov ['[ebp+var_78],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_18]']
mov ['[edx+24h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
mov ['[ecx+1Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+20h],', 'ecx']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
mov ['ecx,', '[ebp+var_78]']
mov ['[eax+edx+4],', 'ecx']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
mov ['ecx,', '[ebp+var_7C]']
mov ['[eax+edx],', 'ecx']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
mov ['dword', 'ptr', '[eax+edx+8],', '0']
jmp ['loc_6105']
mov ['[ebp+var_6C],', '0']
mov ['[ebp+var_70],', '0']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_653E']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[edx+12Ch]']
jge ['loc_6687']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+eax*4]']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ecx+14h]']
mov ['ecx,', '[eax+edx+4]']
and ['ecx,', '80000000h']
jz ['short', 'loc_657E']
mov ['edx,', '[ebp+var_8]']
mov ['[ebp+var_6C],', 'edx']
mov ['[ebp+var_70],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[eax+14h]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['esi,', '[ebp+var_34]']
mov ['ecx,', '[ecx+edx]']
cmp ['ecx,', '[esi+eax]']
jnz ['short', 'loc_65D2']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[ecx+eax+4]']
and ['edx,', '0FFFFFFFh']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_34]']
cmp ['edx,', '[ecx+eax+4]']
jz ['short', 'loc_6644']
cmp ['[ebp+var_70],', '0']
jnz ['short', 'loc_6644']
mov ['edx,', '[ebp+var_6C]']
mov ['[ebp+var_88],', 'edx']
jmp ['short', 'loc_65F2']
mov ['eax,', '[ebp+var_88]']
add ['eax,', '1']
mov ['[ebp+var_88],', 'eax']
mov ['ecx,', '[ebp+var_88]']
cmp ['ecx,', '[ebp+var_8]']
jge ['short', 'loc_663D']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_88]']
imul ['eax,', '0Ch']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[ecx+eax+4]']
or ['edx,', '3FFFFh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ecx+eax*4]']
mov ['eax,', '[ebp+var_88]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ecx+14h]']
mov ['[ecx+eax+4],', 'edx']
jmp ['short', 'loc_65E3']
mov ['[ebp+var_70],', '1']
cmp ['[ebp+var_70],', '0']
jz ['short', 'loc_6682']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[ecx+eax+4]']
or ['edx,', '3FFFFh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ecx+eax*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ecx+14h]']
mov ['[ecx+eax+4],', 'edx']
jmp ['loc_6535']
mov ['edx,', '[ebp+var_44]']
movzx ['eax,', 'word', 'ptr', '[edx]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[edx+ecx*4]']
movzx ['ecx,', 'word', 'ptr', '[edx]']
xor ['edx,', 'edx']
cmp ['eax,', 'ecx']
setnz ['dl']
mov ['[ebp+var_4C],', 'edx']
mov ['eax,', '[ebp+var_4C]']
mov ['[ebp+var_50],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+eax*4]']
mov ['edx,', '[ebp+var_44]']
mov ['ax,', '[edx]']
mov ['[ecx],', 'ax']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_66D3']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[edx+12Ch]']
jge ['loc_6DC8']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
add ['ecx,', '[ebp+var_48]']
mov ['[ebp+var_9C],', 'ecx']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
mov ['ecx,', '[eax+edx+4]']
mov ['[ebp+var_8C],', 'ecx']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
mov ['ecx,', '[eax+edx]']
mov ['[ebp+var_90],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[ecx+eax+4]']
xor ['edx,', '[ebp+var_8C]']
and ['edx,', '400000h']
jz ['short', 'loc_6747']
mov ['[ebp+var_4C],', '1']
mov ['eax,', '[ebp+var_8C]']
xor ['eax,', '[ebp+var_58]']
mov ['ecx,', '[ebp+arg_0]']
and ['eax,', '[ecx+106Ch]']
neg ['eax']
sbb ['eax,', 'eax']
neg ['eax']
mov ['[ebp+var_94],', 'eax']
cmp ['[ebp+var_90],', '23BAh']
jb ['short', 'loc_677D']
cmp ['[ebp+var_90],', '23BDh']
jbe ['short', 'loc_67AD']
cmp ['[ebp+var_8],', '0']
jle ['short', 'loc_67B7']
mov ['edx,', '[ebp+var_8]']
sub ['edx,', '1']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
cmp ['dword', 'ptr', '[eax+edx],', '23BAh']
jb ['short', 'loc_67B7']
mov ['ecx,', '[ebp+var_8]']
sub ['ecx,', '1']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_34]']
cmp ['dword', 'ptr', '[edx+ecx],', '23BDh']
ja ['short', 'loc_67B7']
mov ['[ebp+var_94],', '1']
mov ['eax,', '[ebp+var_90]']
and ['eax,', '0FFFFFC00h']
cmp ['eax,', '0D800h']
jz ['short', 'loc_67E9']
mov ['ecx,', '[ebp+var_90]']
and ['ecx,', '0FFFFFE00h']
cmp ['ecx,', '0F000h']
jz ['short', 'loc_67E9']
mov ['[ebp+var_B8],', '0']
jmp ['short', 'loc_67FB']
mov ['edx,', '[ebp+var_90]']
and ['edx,', '0FFFFFF00h']
mov ['[ebp+var_B8],', 'edx']
mov ['eax,', '[ebp+var_B8]']
cmp ['eax,', '[ebp+var_5C]']
jz ['short', 'loc_6810']
mov ['[ebp+var_94],', '1']
mov ['ecx,', '[ebp+var_9C]']
cmp ['dword', 'ptr', '[ecx+8],', '0']
jnz ['short', 'loc_682E']
cmp ['[ebp+var_8],', '0']
jle ['short', 'loc_6838']
mov ['edx,', '[ebp+var_9C]']
cmp ['dword', 'ptr', '[edx-4],', '0']
jz ['short', 'loc_6838']
mov ['[ebp+var_94],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jnz ['short', 'loc_68B5']
cmp ['[ebp+var_4C],', '0']
jnz ['short', 'loc_68B5']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[eax+ecx]']
cmp ['edx,', '[ebp+var_90]']
jnz ['short', 'loc_689F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[eax+14h]']
mov ['eax,', '[edx+ecx+4]']
and ['eax,', '0FFFFFFFh']
cmp ['eax,', '[ebp+var_8C]']
jnz ['short', 'loc_689F']
mov ['[ebp+var_94],', '1']
jmp ['short', 'loc_68B5']
cmp ['[ebp+var_50],', '0']
jnz ['short', 'loc_68B5']
cmp ['[ebp+var_64],', '1']
jnz ['short', 'loc_68B5']
mov ['[ebp+var_94],', '1']
cmp ['[ebp+var_94],', '0']
jz ['loc_69AA']
cmp ['[ebp+var_50],', '0']
jnz ['short', 'loc_68CE']
cmp ['[ebp+var_68],', '0']
jz ['short', 'loc_692C']
cmp ['[ebp+var_64],', '0']
jle ['short', 'loc_692C']
mov ['ecx,', '[ebp+var_44]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+var_58]']
push ['eax']
mov ['ecx,', '[ebp+var_64]']
push ['ecx']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+var_60]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_do_text']
add ['esp,', '1Ch']
mov ['eax,', '[ebp+var_58]']
and ['eax,', '60000000h']
jz ['short', 'loc_692C']
mov ['ecx,', '[ebp+var_44]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+var_58]']
push ['eax']
mov ['ecx,', '[ebp+var_64]']
push ['ecx']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+var_60]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_do_cursor']
add ['esp,', '1Ch']
mov ['eax,', '[ebp+var_8]']
mov ['[ebp+var_60],', 'eax']
mov ['[ebp+var_64],', '0']
mov ['ecx,', '[ebp+var_8C]']
mov ['[ebp+var_58],', 'ecx']
mov ['edx,', '[ebp+var_90]']
and ['edx,', '0FFFFFC00h']
cmp ['edx,', '0D800h']
jz ['short', 'loc_6974']
mov ['eax,', '[ebp+var_90]']
and ['eax,', '0FFFFFE00h']
cmp ['eax,', '0F000h']
jz ['short', 'loc_6974']
mov ['[ebp+var_BC],', '0']
jmp ['short', 'loc_6986']
mov ['ecx,', '[ebp+var_90]']
and ['ecx,', '0FFFFFF00h']
mov ['[ebp+var_BC],', 'ecx']
mov ['edx,', '[ebp+var_BC]']
mov ['[ebp+var_5C],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jz ['short', 'loc_69A4']
mov ['edx,', '[ebp+var_50]']
mov ['[ebp+var_68],', 'edx']
mov ['eax,', '[ebp+var_4C]']
mov ['[ebp+var_50],', 'eax']
mov ['[ebp+var_98],', '0']
mov ['ecx,', '[ebp+var_8C]']
push ['ecx']
mov ['edx,', '[ebp+var_90]']
push ['edx']
mov ['eax,', '[ebp+var_9C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+eax*4]']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
add ['edx,', '[ecx+14h]']
push ['edx']
call ['_termchars_equal_override']
add ['esp,', '10h']
test ['eax,', 'eax']
jnz ['short', 'loc_69FC']
mov ['[ebp+var_98],', '1']
mov ['[ebp+var_50],', '1']
mov ['eax,', '[ebp+var_64]']
add ['eax,', '2']
cmp ['eax,', '[ebp+var_30]']
jle ['short', 'loc_6A28']
mov ['ecx,', '[ebp+var_64]']
add ['ecx,', '100h']
mov ['[ebp+var_30],', 'ecx']
push ['2']
mov ['edx,', '[ebp+var_30]']
push ['edx']
mov ['eax,', '[ebp+var_2C]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_2C],', 'eax']
cmp ['[ebp+var_90],', '(offset', 'loc_FFFF+1)']
jbe ['short', 'loc_6A95']
cmp ['[ebp+var_90],', '110000h']
jnb ['short', 'loc_6A95']
mov ['ecx,', '[ebp+var_90]']
sub ['ecx,', '(offset', 'loc_FFFF+1)']
shr ['ecx,', '0Ah']
add ['ecx,', '0D800h']
mov ['edx,', '[ebp+var_64]']
mov ['eax,', '[ebp+var_2C]']
mov ['[eax+edx*2],', 'cx']
mov ['ecx,', '[ebp+var_64]']
add ['ecx,', '1']
mov ['[ebp+var_64],', 'ecx']
mov ['edx,', '[ebp+var_90]']
sub ['edx,', '(offset', 'loc_FFFF+1)']
and ['edx,', '3FFh']
add ['edx,', '0DC00h']
mov ['eax,', '[ebp+var_64]']
mov ['ecx,', '[ebp+var_2C]']
mov ['[ecx+eax*2],', 'dx']
mov ['edx,', '[ebp+var_64]']
add ['edx,', '1']
mov ['[ebp+var_64],', 'edx']
jmp ['short', 'loc_6AAF']
mov ['eax,', '[ebp+var_64]']
mov ['ecx,', '[ebp+var_2C]']
mov ['dx,', 'word', 'ptr', '[ebp+var_90]']
mov ['[ecx+eax*2],', 'dx']
mov ['eax,', '[ebp+var_64]']
add ['eax,', '1']
mov ['[ebp+var_64],', 'eax']
mov ['ecx,', '[ebp+var_9C]']
cmp ['dword', 'ptr', '[ecx+8],', '0']
jz ['loc_6C66']
mov ['edx,', '[ebp+var_9C]']
mov ['[ebp+var_A0],', 'edx']
mov ['eax,', '[ebp+var_A0]']
cmp ['dword', 'ptr', '[eax+8],', '0']
jz ['loc_6C5A']
mov ['ecx,', '[ebp+var_A0]']
mov ['edx,', '[ecx+8]']
imul ['edx,', '0Ch']
add ['edx,', '[ebp+var_A0]']
mov ['[ebp+var_A0],', 'edx']
mov ['eax,', '[ebp+var_A0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_A4],', 'ecx']
mov ['edx,', '[ebp+var_A4]']
and ['edx,', '0FFFFFF00h']
mov ['[ebp+var_C0],', 'edx']
cmp ['[ebp+var_C0],', '0D800h']
jz ['short', 'loc_6B39']
cmp ['[ebp+var_C0],', '0D900h']
jz ['short', 'loc_6B5E']
cmp ['[ebp+var_C0],', '0DA00h']
jz ['short', 'loc_6B82']
jmp ['short', 'loc_6BA2']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+var_A4]']
and ['edx,', '0FFh']
movzx ['eax,', 'word', 'ptr', '[ecx+edx*2+210h]']
mov ['[ebp+var_A4],', 'eax']
jmp ['short', 'loc_6BA2']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
mov ['eax,', '[ebp+var_A4]']
and ['eax,', '0FFh']
movzx ['ecx,', 'word', 'ptr', '[edx+eax*2+610h]']
mov ['[ebp+var_A4],', 'ecx']
jmp ['short', 'loc_6BA2']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[ebp+var_A4]']
and ['ecx,', '0FFh']
movzx ['edx,', 'word', 'ptr', '[eax+ecx*2+10h]']
mov ['[ebp+var_A4],', 'edx']
mov ['eax,', '[ebp+var_64]']
add ['eax,', '2']
cmp ['eax,', '[ebp+var_30]']
jle ['short', 'loc_6BCE']
mov ['ecx,', '[ebp+var_64]']
add ['ecx,', '100h']
mov ['[ebp+var_30],', 'ecx']
push ['2']
mov ['edx,', '[ebp+var_30]']
push ['edx']
mov ['eax,', '[ebp+var_2C]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_2C],', 'eax']
cmp ['[ebp+var_A4],', '(offset', 'loc_FFFF+1)']
jbe ['short', 'loc_6C3B']
cmp ['[ebp+var_A4],', '110000h']
jnb ['short', 'loc_6C3B']
mov ['ecx,', '[ebp+var_A4]']
sub ['ecx,', '(offset', 'loc_FFFF+1)']
shr ['ecx,', '0Ah']
add ['ecx,', '0D800h']
mov ['edx,', '[ebp+var_64]']
mov ['eax,', '[ebp+var_2C]']
mov ['[eax+edx*2],', 'cx']
mov ['ecx,', '[ebp+var_64]']
add ['ecx,', '1']
mov ['[ebp+var_64],', 'ecx']
mov ['edx,', '[ebp+var_A4]']
sub ['edx,', '(offset', 'loc_FFFF+1)']
and ['edx,', '3FFh']
add ['edx,', '0DC00h']
mov ['eax,', '[ebp+var_64]']
mov ['ecx,', '[ebp+var_2C]']
mov ['[ecx+eax*2],', 'dx']
mov ['edx,', '[ebp+var_64]']
add ['edx,', '1']
mov ['[ebp+var_64],', 'edx']
jmp ['short', 'loc_6C55']
mov ['eax,', '[ebp+var_64]']
mov ['ecx,', '[ebp+var_2C]']
mov ['dx,', 'word', 'ptr', '[ebp+var_A4]']
mov ['[ecx+eax*2],', 'dx']
mov ['eax,', '[ebp+var_64]']
add ['eax,', '1']
mov ['[ebp+var_64],', 'eax']
jmp ['loc_6ACB']
mov ['ecx,', '[ebp+var_58]']
or ['ecx,', '80000000h']
mov ['[ebp+var_58],', 'ecx']
cmp ['[ebp+var_98],', '0']
jz ['loc_6D10']
mov ['edx,', '[ebp+var_9C]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+eax*4]']
push ['ecx']
call ['_copy_termchar']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[ebp+var_90]']
mov ['[eax+ecx],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[eax+14h]']
mov ['eax,', '[ebp+var_8C]']
mov ['[edx+ecx+4],', 'eax']
mov ['ecx,', '[ebp+var_60]']
cmp ['ecx,', '[ebp+var_8]']
jnz ['short', 'loc_6D10']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[ecx+eax+4]']
or ['edx,', '80000000h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ecx+eax*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ecx+14h]']
mov ['[ecx+eax+4],', 'edx']
mov ['edx,', '[ebp+var_8C]']
and ['edx,', '400000h']
jz ['loc_6DC3']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ecx+12Ch]']
jge ['loc_6DC3']
mov ['eax,', '[ebp+var_9C]']
add ['eax,', '0Ch']
mov ['[ebp+var_9C],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[ebp+var_C]']
jnz ['short', 'loc_6D73']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ebp+var_10]']
jnz ['short', 'loc_6D73']
push ['149Bh']
push ['offset', '$SG88038']
push ['offset', '$SG88039']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_9C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
add ['eax,', '[edx+14h]']
push ['eax']
call ['_termchars_equal']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_6DA3']
mov ['[ebp+var_50],', '1']
mov ['ecx,', '[ebp+var_9C]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+edx*4]']
push ['eax']
call ['_copy_termchar']
add ['esp,', '0Ch']
jmp ['loc_66CA']
cmp ['[ebp+var_50],', '0']
jz ['short', 'loc_6E2C']
cmp ['[ebp+var_64],', '0']
jle ['short', 'loc_6E2C']
mov ['ecx,', '[ebp+var_44]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+var_58]']
push ['eax']
mov ['ecx,', '[ebp+var_64]']
push ['ecx']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+var_60]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_do_text']
add ['esp,', '1Ch']
mov ['eax,', '[ebp+var_58]']
and ['eax,', '60000000h']
jz ['short', 'loc_6E2C']
mov ['ecx,', '[ebp+var_44]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+var_58]']
push ['eax']
mov ['ecx,', '[ebp+var_64]']
push ['ecx']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+var_60]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_do_cursor']
add ['esp,', '1Ch']
mov ['eax,', '[ebp+var_44]']
push ['eax']
call ['_unlineptr']
add ['esp,', '4']
jmp ['loc_6053']
mov ['ecx,', '[ebp+var_34]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN118']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '0C0h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_unlineptr      proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0Ch],', '0']
jz ['short', 'loc_6EB4']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_freeline']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_bidi_line proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10F8h],', '0']
jz ['short', 'loc_6F03']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+10E0h],', '0']
jnz ['loc_73A2']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_bidi_cache_hit']
add ['esp,', '10h']
test ['eax,', 'eax']
jnz ['loc_738A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+10C4h]']
cmp ['ecx,', '[eax+12Ch]']
jge ['short', 'loc_6FA0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
mov ['[edx+10C4h],', 'ecx']
push ['0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10C4h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10BCh]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10BCh],', 'eax']
push ['0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10C4h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10C0h]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10C0h],', 'eax']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_6FB2']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[eax+12Ch]']
jge ['loc_7104']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[edx+ecx]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_C]']
and ['eax,', '0FFFFFF00h']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0D800h']
jz ['short', 'loc_7029']
cmp ['[ebp+var_10],', '0D900h']
jz ['short', 'loc_6FFE']
cmp ['[ebp+var_10],', '0DA00h']
jz ['short', 'loc_7048']
jmp ['short', 'loc_7061']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1154h],', '0']
jnz ['short', 'loc_7029']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[ebp+var_C]']
and ['ecx,', '0FFh']
movzx ['edx,', 'word', 'ptr', '[eax+ecx*2+610h]']
mov ['[ebp+var_C],', 'edx']
jmp ['short', 'loc_7061']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+var_C]']
and ['edx,', '0FFh']
movzx ['eax,', 'word', 'ptr', '[ecx+edx*2+210h]']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_7061']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
mov ['eax,', '[ebp+var_C]']
and ['eax,', '0FFh']
movzx ['ecx,', 'word', 'ptr', '[edx+eax*2+10h]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_C]']
and ['edx,', '0FFFFFF00h']
mov ['[ebp+var_14],', 'edx']
cmp ['[ebp+var_14],', '0F000h']
jz ['short', 'loc_70A0']
cmp ['[ebp+var_14],', '0F100h']
jz ['short', 'loc_7081']
jmp ['short', 'loc_70BC']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+var_C]']
and ['edx,', '0FFh']
movzx ['eax,', 'word', 'ptr', '[ecx+edx*2+410h]']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_70BC']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
mov ['eax,', '[ebp+var_C]']
and ['eax,', '0FFh']
movzx ['ecx,', 'word', 'ptr', '[edx+eax*2+810h]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10BCh]']
mov ['eax,', '[ebp+var_C]']
mov ['[ecx+edx+4],', 'eax']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10BCh]']
mov ['edx,', '[ebp+var_C]']
mov ['[ecx+eax],', 'edx']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10BCh]']
mov ['cx,', 'word', 'ptr', '[ebp+var_8]']
mov ['[edx+eax+8],', 'cx']
jmp ['loc_6FA9']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+10F8h],', '0']
jnz ['short', 'loc_712C']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10BCh]']
push ['eax']
call ['_do_bidi']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+10F8h],', '0']
jnz ['short', 'loc_7198']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+10E0h],', '0']
jz ['short', 'loc_7198']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_7156']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ecx+12Ch]']
jge ['short', 'loc_7198']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10BCh]']
add ['edx,', 'eax']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+10C0h]']
add ['ecx,', 'eax']
mov ['eax,', '[edx]']
mov ['[ecx],', 'eax']
mov ['eax,', '[edx+4]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[edx+8]']
mov ['[ecx+8],', 'edx']
jmp ['short', 'loc_714D']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10E0h],', '0']
jnz ['short', 'loc_71CA']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10C0h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10BCh]']
push ['eax']
call ['_do_shape']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ecx+10B8h]']
cmp ['eax,', '[edx+8]']
jge ['short', 'loc_7211']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+8]']
mov ['[ecx+10B8h],', 'eax']
push ['0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10B8h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10B4h]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10B4h],', 'eax']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+8]']
imul ['ecx,', '0Ch']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+14h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10B4h]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_7246']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ecx+12Ch]']
jge ['loc_7340']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10C0h]']
movzx ['eax,', 'word', 'ptr', '[edx+eax+8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+14h]']
add ['edx,', 'eax']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+10B4h]']
add ['ecx,', 'eax']
mov ['eax,', '[edx]']
mov ['[ecx],', 'eax']
mov ['eax,', '[edx+4]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[edx+8]']
mov ['[ecx+8],', 'edx']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10B4h]']
cmp ['dword', 'ptr', '[edx+eax+8],', '0']
jz ['short', 'loc_72EF']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10B4h]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['esi,', '[ebp+arg_0]']
mov ['esi,', '[esi+10C0h]']
movzx ['ecx,', 'word', 'ptr', '[esi+ecx+8]']
mov ['esi,', '[ebp+var_8]']
sub ['esi,', 'ecx']
mov ['edx,', '[edx+eax+8]']
sub ['edx,', 'esi']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+10B4h]']
mov ['[ecx+eax+8],', 'edx']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10C0h]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['esi,', '[ebp+arg_0]']
mov ['esi,', '[esi+10C0h]']
mov ['ecx,', '[edx+ecx]']
cmp ['ecx,', '[esi+eax+4]']
jz ['short', 'loc_733B']
mov ['edx,', '[ebp+var_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10C0h]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['esi,', '[ebp+arg_0]']
mov ['esi,', '[esi+10B4h]']
mov ['ecx,', '[ecx+edx+4]']
mov ['[eax+esi],', 'ecx']
jmp ['loc_723D']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10C0h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10B4h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_bidi_cache_store']
add ['esp,', '1Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10B4h]']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_73A0']
mov ['ecx,', '[ebp+arg_8]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
mov ['ecx,', '[eax+ecx+4]']
mov ['[ebp+var_4],', 'ecx']
jmp ['short', 'loc_73A9']
mov ['[ebp+var_4],', '0']
mov ['eax,', '[ebp+var_4]']
pop ['esi']
add ['esp,', '14h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_bidi_cache_hit proc near          
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10C8h],', '0']
jnz ['short', 'loc_73DA']
xor ['eax,', 'eax']
jmp ['loc_7479']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ecx+10D0h]']
jl ['short', 'loc_73EF']
xor ['eax,', 'eax']
jmp ['loc_7479']
mov ['eax,', '[ebp+arg_4]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10C8h]']
cmp ['dword', 'ptr', '[edx+eax+4],', '0']
jnz ['short', 'loc_7409']
xor ['eax,', 'eax']
jmp ['short', 'loc_7479']
mov ['eax,', '[ebp+arg_4]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10C8h]']
mov ['eax,', '[eax+edx]']
cmp ['eax,', '[ebp+arg_C]']
jz ['short', 'loc_7424']
xor ['eax,', 'eax']
jmp ['short', 'loc_7479']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_7436']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '1']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ebp+arg_C]']
jge ['short', 'loc_7474']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
add ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10C8h]']
mov ['edx,', '[ebp+var_4]']
imul ['edx,', '0Ch']
add ['edx,', '[eax+ecx+4]']
push ['edx']
call ['_termchars_equal']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_7472']
xor ['eax,', 'eax']
jmp ['short', 'loc_7479']
jmp ['short', 'loc_742D']
mov ['eax,', '1']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_bidi_cache_store proc near        
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10C8h],', '0']
jz ['short', 'loc_74C5']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10D0h]']
cmp ['edx,', '[ebp+arg_4]']
jg ['loc_7604']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10D0h]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+10D0h],', 'edx']
push ['10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10D0h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10C8h]']
push ['ecx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+10C8h],', 'eax']
push ['10h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10D0h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10CCh],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[edx+10D0h]']
jge ['loc_7604']
mov ['ecx,', '[ebp+var_8]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
mov ['dword', 'ptr', '[eax+ecx+4],', '0']
mov ['ecx,', '[ebp+var_8]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10C8h]']
mov ['dword', 'ptr', '[eax+ecx+4],', '0']
mov ['ecx,', '[ebp+var_8]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
mov ['dword', 'ptr', '[ecx+eax],', '0FFFFFFFFh']
mov ['ecx,', '[ebp+var_8]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10C8h]']
mov ['dword', 'ptr', '[ecx+eax],', '0FFFFFFFFh']
mov ['ecx,', '[ebp+var_8]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
mov ['dword', 'ptr', '[eax+ecx+8],', '0']
mov ['ecx,', '[ebp+var_8]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10C8h]']
mov ['dword', 'ptr', '[eax+ecx+8],', '0']
mov ['ecx,', '[ebp+var_8]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
mov ['dword', 'ptr', '[eax+ecx+0Ch],', '0']
mov ['ecx,', '[ebp+var_8]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10C8h]']
mov ['dword', 'ptr', '[eax+ecx+0Ch],', '0']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
jmp ['loc_752E']
mov ['edx,', '[ebp+arg_4]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10C8h]']
mov ['edx,', '[ecx+edx+4]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_4]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10CCh]']
mov ['eax,', '[edx+eax+4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
mov ['ecx,', '[eax+ecx+8]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_4]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10CCh]']
mov ['edx,', '[ecx+edx+0Ch]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_4]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10C8h]']
mov ['ecx,', '[ebp+arg_14]']
mov ['[eax+edx],', 'ecx']
push ['0Ch']
mov ['edx,', '[ebp+arg_18]']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+10C8h]']
mov ['[edx+ecx+4],', 'eax']
mov ['eax,', '[ebp+arg_4]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10CCh]']
mov ['ecx,', '[ebp+arg_14]']
mov ['[eax+edx],', 'ecx']
push ['0Ch']
mov ['edx,', '[ebp+arg_18]']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+10CCh]']
mov ['[edx+ecx+4],', 'eax']
push ['4']
mov ['eax,', '[ebp+arg_14]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+10CCh]']
mov ['[edx+ecx+8],', 'eax']
push ['4']
mov ['eax,', '[ebp+arg_14]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+10CCh]']
mov ['[edx+ecx+0Ch],', 'eax']
mov ['eax,', '[ebp+arg_18]']
imul ['eax,', '0Ch']
push ['eax']
mov ['ecx,', '[ebp+Src]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10C8h]']
mov ['edx,', '[ecx+edx+4]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_18]']
imul ['eax,', '0Ch']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10CCh]']
mov ['edx,', '[ecx+edx+4]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_14]']
shl ['eax,', '2']
push ['eax']
push ['0']
mov ['ecx,', '[ebp+arg_4]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10CCh]']
mov ['ecx,', '[eax+ecx+8]']
push ['ecx']
call ['_memset']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_14]']
shl ['edx,', '2']
push ['edx']
push ['0']
mov ['eax,', '[ebp+arg_4]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10CCh]']
mov ['eax,', '[edx+eax+0Ch]']
push ['eax']
call ['_memset']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_77CC']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '1']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ebp+arg_14]']
jge ['short', 'loc_7847']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_10]']
movzx ['edx,', 'word', 'ptr', '[ecx+eax+8]']
mov ['[ebp+var_C],', 'edx']
cmp ['[ebp+var_C],', '0']
jl ['short', 'loc_77F3']
mov ['eax,', '[ebp+var_C]']
cmp ['eax,', '[ebp+arg_14]']
jl ['short', 'loc_780A']
push ['12A1h']
push ['offset', '$SG87813']
push ['offset', '$SG87814']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10CCh]']
mov ['edx,', '[ecx+edx+0Ch]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_C]']
mov ['[edx+eax*4],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10CCh]']
mov ['edx,', '[ecx+edx+8]']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+var_4]']
mov ['[edx+eax*4],', 'ecx']
jmp ['loc_77C3']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_invalidate proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_7882']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ecx+128h]']
jge ['short', 'loc_78EB']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_78A2']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ecx+12Ch]']
jge ['short', 'loc_78E9']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+edx*4]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[eax+14h]']
mov ['eax,', '[edx+ecx+4]']
or ['eax,', '3FFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[edx+ecx*4]']
mov ['ecx,', '[ebp+var_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[edx+14h]']
mov ['[edx+ecx+4],', 'eax']
jmp ['short', 'loc_7899']
jmp ['short', 'loc_7879']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_schedule_update']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_paint     proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_8],', '0']
jge ['short', 'loc_792D']
mov ['[ebp+arg_8],', '0']
cmp ['[ebp+arg_C],', '0']
jge ['short', 'loc_793A']
mov ['[ebp+arg_C],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_10]']
cmp ['ecx,', '[eax+12Ch]']
jl ['short', 'loc_7957']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
sub ['eax,', '1']
mov ['[ebp+arg_10],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_14]']
cmp ['edx,', '[ecx+128h]']
jl ['short', 'loc_7974']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
sub ['ecx,', '1']
mov ['[ebp+arg_14],', 'ecx']
mov ['edx,', '[ebp+arg_C]']
mov ['[ebp+var_4],', 'edx']
jmp ['short', 'loc_7985']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[ebp+arg_14]']
jg ['loc_7A8D']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_4]']
cmp ['eax,', '[edx+128h]']
jge ['loc_7A8D']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+eax*4]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
and ['edx,', '3']
jnz ['short', 'loc_7A1A']
mov ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_8],', 'eax']
jmp ['short', 'loc_79C8']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ebp+arg_10]']
jg ['short', 'loc_7A18']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[eax+12Ch]']
jge ['short', 'loc_7A18']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[ecx+eax+4]']
or ['edx,', '3FFFFh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ecx+eax*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ecx+14h]']
mov ['[ecx+eax+4],', 'edx']
jmp ['short', 'loc_79BF']
jmp ['short', 'loc_7A88']
mov ['eax,', '[ebp+arg_8]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
jmp ['short', 'loc_7A30']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '1']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+arg_10]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
add ['eax,', '1']
cmp ['[ebp+var_8],', 'eax']
jg ['short', 'loc_7A88']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[eax+12Ch]']
jge ['short', 'loc_7A88']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+18h]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+ecx*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[ecx+eax+4]']
or ['edx,', '3FFFFh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ecx+eax*4]']
mov ['eax,', '[ebp+var_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ecx+14h]']
mov ['[ecx+eax+4],', 'edx']
jmp ['short', 'loc_7A27']
jmp ['loc_797C']
cmp ['[ebp+arg_18],', '0']
jz ['short', 'loc_7AA7']
push ['0']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_do_paint']
add ['esp,', '0Ch']
jmp ['short', 'loc_7AB3']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_schedule_update']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_scroll    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sblines']
add ['esp,', '4']
neg ['eax']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_4],', '0']
jge ['short', 'loc_7B07']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_7B24']
cmp ['[ebp+arg_4],', '0']
jle ['short', 'loc_7B15']
mov ['ecx,', '[ebp+var_4]']
mov ['[ebp+var_C],', 'ecx']
jmp ['short', 'loc_7B1E']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_8]']
add ['edx,', '[ebp+arg_8]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+10h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
cmp ['edx,', '[ebp+var_4]']
jge ['short', 'loc_7B44']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['[eax+10h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+10h],', '0']
jle ['short', 'loc_7B57']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+10h],', '0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_update_sbar']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_update']
add ['esp,', '4']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_scroll_to_selection proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sblines']
add ['esp,', '4']
neg ['eax']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0E48h],', '3']
jz ['short', 'loc_7BC8']
jmp ['short', 'loc_7C3F']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_7BE5']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E5Ch]']
mov ['ecx,', '[edx+0E60h]']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'ecx']
jmp ['short', 'loc_7BFA']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E54h]']
mov ['ecx,', '[edx+0E58h]']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ecx,', '[ebp+var_C]']
sub ['ecx,', 'eax']
mov ['[ebp+var_14],', 'ecx']
mov ['edx,', '[ebp+var_14]']
cmp ['edx,', '[ebp+var_18]']
jge ['short', 'loc_7C20']
mov ['eax,', '[ebp+var_18]']
mov ['[ebp+var_14],', 'eax']
jmp ['short', 'loc_7C2D']
cmp ['[ebp+var_14],', '0']
jle ['short', 'loc_7C2D']
mov ['[ebp+var_14],', '0']
mov ['ecx,', '[ebp+var_14]']
push ['ecx']
push ['0FFFFFFFFh']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_scroll']
add ['esp,', '0Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_copyall   proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
mov ['[ebp+var_24],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_sblines']
add ['esp,', '4']
neg ['eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', '0']
mov ['eax,', '[ebp+var_24]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_find_last_nonempty_line']
add ['esp,', '8']
mov ['[ebp+var_1C],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
mov ['[ebp+var_18],', 'eax']
push ['1']
push ['0']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_clipme']
add ['esp,', '1Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN6_2']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_clipme         proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0B4h']
push ['edi']
lea ['edi,', '[ebp+var_B4]']
mov ['ecx,', '2Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_20],', '1400h']
mov ['[ebp+var_1C],', '0']
push ['2']
mov ['eax,', '[ebp+var_20]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[ebp+var_18]']
mov ['[ebp+var_14],', 'ecx']
push ['4']
mov ['edx,', '[ebp+var_20]']
push ['edx']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_10],', 'eax']
mov ['eax,', '[ebp+var_10]']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ebp+var_28],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ebp+arg_C]']
jl ['short', 'loc_7DE4']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[ebp+arg_C]']
jnz ['loc_837A']
mov ['ecx,', '[ebp+arg_8]']
cmp ['ecx,', '[ebp+arg_10]']
jge ['loc_837A']
mov ['[ebp+var_30],', '0']
push ['0']
push ['153Ah']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_34],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_40],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
mov ['[ebp+var_3C],', 'eax']
mov ['ecx,', '[ebp+var_34]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
and ['edx,', '10h']
jnz ['loc_7F12']
cmp ['[ebp+var_3C],', '0']
jz ['loc_7EF1']
mov ['eax,', '[ebp+var_3C]']
sub ['eax,', '1']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_34]']
mov ['edx,', '[ecx+14h]']
cmp ['dword', 'ptr', '[eax+edx],', '20h']
jz ['short', 'loc_7E84']
mov ['eax,', '[ebp+var_3C]']
sub ['eax,', '1']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_34]']
mov ['edx,', '[ecx+14h]']
mov ['eax,', '[edx+eax]']
and ['eax,', '0FFFFFC00h']
cmp ['eax,', '0D800h']
jnz ['loc_7EF1']
mov ['ecx,', '[ebp+var_3C]']
sub ['ecx,', '1']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_34]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[eax+ecx]']
and ['ecx,', '0FFh']
cmp ['ecx,', '20h']
jnz ['short', 'loc_7EF1']
mov ['edx,', '[ebp+var_3C]']
sub ['edx,', '1']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
mov ['ecx,', '[eax+14h]']
cmp ['dword', 'ptr', '[ecx+edx+8],', '0']
jnz ['short', 'loc_7EF1']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ebp+var_40]']
jl ['short', 'loc_7EB2']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[ebp+var_40]']
jnz ['short', 'loc_7EF1']
mov ['ecx,', '[ebp+arg_8]']
cmp ['ecx,', '[ebp+var_3C]']
jge ['short', 'loc_7EF1']
cmp ['[ebp+var_3C],', '0']
jnz ['short', 'loc_7ED9']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
mov ['[ebp+var_3C],', 'eax']
mov ['ecx,', '[ebp+var_40]']
sub ['ecx,', '1']
mov ['[ebp+var_40],', 'ecx']
mov ['[ebp+var_A4],', '1']
jmp ['short', 'loc_7EEC']
mov ['edx,', '[ebp+var_3C]']
sub ['edx,', '1']
mov ['[ebp+var_3C],', 'edx']
mov ['[ebp+var_A4],', '0']
jmp ['loc_7E26']
mov ['eax,', '[ebp+var_40]']
cmp ['eax,', '[ebp+arg_C]']
jl ['short', 'loc_7F09']
mov ['ecx,', '[ebp+var_40]']
cmp ['ecx,', '[ebp+arg_C]']
jnz ['short', 'loc_7F10']
mov ['edx,', '[ebp+var_3C]']
cmp ['edx,', '[ebp+arg_10]']
jge ['short', 'loc_7F10']
mov ['[ebp+var_30],', '1']
jmp ['short', 'loc_7F57']
mov ['eax,', '[ebp+var_34]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
and ['ecx,', '20h']
jz ['short', 'loc_7F57']
cmp ['[ebp+var_3C],', '0']
jnz ['short', 'loc_7F44']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
mov ['[ebp+var_3C],', 'eax']
mov ['ecx,', '[ebp+var_40]']
sub ['ecx,', '1']
mov ['[ebp+var_40],', 'ecx']
mov ['[ebp+var_A8],', '1']
jmp ['short', 'loc_7F57']
mov ['edx,', '[ebp+var_3C]']
sub ['edx,', '1']
mov ['[ebp+var_3C],', 'edx']
mov ['[ebp+var_A8],', '0']
cmp ['[ebp+arg_14],', '0']
jz ['short', 'loc_7F79']
mov ['eax,', '[ebp+var_3C]']
cmp ['eax,', '[ebp+arg_10]']
jle ['short', 'loc_7F6B']
mov ['ecx,', '[ebp+arg_10]']
mov ['[ebp+var_3C],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
xor ['eax,', 'eax']
cmp ['edx,', '[ebp+arg_C]']
setl ['al']
mov ['[ebp+var_30],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[ebp+arg_C]']
jl ['short', 'loc_7F99']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ebp+arg_C]']
jnz ['loc_82F3']
mov ['eax,', '[ebp+arg_8]']
cmp ['eax,', '[ebp+arg_10]']
jge ['loc_82F3']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[ebp+var_40]']
jl ['short', 'loc_7FB9']
mov ['edx,', '[ebp+arg_4]']
cmp ['edx,', '[ebp+var_40]']
jnz ['loc_82F3']
mov ['eax,', '[ebp+arg_8]']
cmp ['eax,', '[ebp+var_3C]']
jge ['loc_82F3']
mov ['ecx,', '[ebp+arg_8]']
mov ['[ebp+var_78],', 'ecx']
mov ['edx,', '[ebp+var_78]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
mov ['ecx,', '[eax+14h]']
cmp ['dword', 'ptr', '[edx+ecx],', '0DFFFh']
jnz ['short', 'loc_7FDF']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '1']
mov ['[ebp+arg_8],', 'edx']
jmp ['short', 'loc_7F79']
mov ['eax,', '1']
test ['eax,', 'eax']
jz ['loc_82E5']
mov ['ecx,', '[ebp+var_78]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_34]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[ecx+eax]']
mov ['[ebp+var_7C],', 'ecx']
mov ['edx,', '[ebp+var_78]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[ecx+edx+4]']
mov ['[ebp+var_2C],', 'edx']
mov ['eax,', '[ebp+var_7C]']
and ['eax,', '0FFFFFF00h']
mov ['[ebp+var_AC],', 'eax']
cmp ['[ebp+var_AC],', '0D800h']
jz ['short', 'loc_8070']
cmp ['[ebp+var_AC],', '0D900h']
jz ['short', 'loc_8045']
cmp ['[ebp+var_AC],', '0DA00h']
jz ['short', 'loc_808F']
jmp ['short', 'loc_80A8']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1154h],', '0']
jnz ['short', 'loc_8070']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[ebp+var_7C]']
and ['ecx,', '0FFh']
movzx ['edx,', 'word', 'ptr', '[eax+ecx*2+610h]']
mov ['[ebp+var_7C],', 'edx']
jmp ['short', 'loc_80A8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+var_7C]']
and ['edx,', '0FFh']
movzx ['eax,', 'word', 'ptr', '[ecx+edx*2+210h]']
mov ['[ebp+var_7C],', 'eax']
jmp ['short', 'loc_80A8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
mov ['eax,', '[ebp+var_7C]']
and ['eax,', '0FFh']
movzx ['ecx,', 'word', 'ptr', '[edx+eax*2+10h]']
mov ['[ebp+var_7C],', 'ecx']
mov ['edx,', '[ebp+var_7C]']
and ['edx,', '0FFFFFF00h']
mov ['[ebp+var_B0],', 'edx']
cmp ['[ebp+var_B0],', '0F000h']
jz ['short', 'loc_80F0']
cmp ['[ebp+var_B0],', '0F100h']
jz ['short', 'loc_80D1']
jmp ['short', 'loc_810C']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+var_7C]']
and ['edx,', '0FFh']
movzx ['eax,', 'word', 'ptr', '[ecx+edx*2+410h]']
mov ['[ebp+var_7C],', 'eax']
jmp ['short', 'loc_810C']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
mov ['eax,', '[ebp+var_7C]']
and ['eax,', '0FFh']
movzx ['ecx,', 'word', 'ptr', '[edx+eax*2+810h]']
mov ['[ebp+var_7C],', 'ecx']
mov ['edx,', '[ebp+var_7C]']
and ['edx,', '0FFh']
mov ['[ebp+var_74],', 'edx']
cmp ['[ebp+var_7C],', '(offset', 'loc_FFFF+1)']
jle ['short', 'loc_815F']
cmp ['[ebp+var_7C],', '110000h']
jge ['short', 'loc_815F']
mov ['eax,', '[ebp+var_7C]']
sub ['eax,', '(offset', 'loc_FFFF+1)']
sar ['eax,', '0Ah']
or ['eax,', '0D800h']
mov ['[ebp+Dst],', 'ax']
mov ['ecx,', '[ebp+var_7C]']
sub ['ecx,', '(offset', 'loc_FFFF+1)']
and ['ecx,', '3FFh']
or ['ecx,', '0DC00h']
mov ['[ebp+var_66],', 'cx']
xor ['edx,', 'edx']
mov ['[ebp+var_64],', 'dx']
jmp ['short', 'loc_816D']
mov ['ax,', 'word', 'ptr', '[ebp+var_7C]']
mov ['[ebp+Dst],', 'ax']
xor ['ecx,', 'ecx']
mov ['[ebp+var_66],', 'cx']
mov ['edx,', '[ebp+var_7C]']
and ['edx,', '0FFFFFE00h']
cmp ['edx,', '0F000h']
jnz ['loc_827F']
cmp ['[ebp+var_74],', '20h']
jl ['loc_827F']
cmp ['[ebp+var_74],', '7Fh']
jz ['loc_827F']
movzx ['eax,', 'byte', 'ptr', '[ebp+var_74]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_is_dbcs_leadbyte']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_8215']
mov ['cl,', 'byte', 'ptr', '[ebp+var_74]']
mov ['[ebp+var_84],', 'cl']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '1']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_34]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[ecx+edx]']
and ['edx,', '0FFh']
mov ['[ebp+var_83],', 'dl']
push ['4']
lea ['eax,', '[ebp+Src]']
push ['eax']
push ['2']
lea ['ecx,', '[ebp+var_84]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['_mb_to_wc']
add ['esp,', '18h']
mov ['[ebp+var_9C],', 'eax']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '1']
mov ['[ebp+arg_8],', 'edx']
jmp ['short', 'loc_824D']
mov ['al,', 'byte', 'ptr', '[ebp+var_74]']
mov ['[ebp+var_84],', 'al']
push ['4']
lea ['ecx,', '[ebp+Src]']
push ['ecx']
push ['1']
lea ['edx,', '[ebp+var_84]']
push ['edx']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_mb_to_wc']
add ['esp,', '18h']
mov ['[ebp+var_9C],', 'eax']
cmp ['[ebp+var_9C],', '0']
jle ['short', 'loc_827F']
mov ['eax,', '[ebp+var_9C]']
shl ['eax,', '1']
push ['eax']
lea ['ecx,', '[ebp+Src]']
push ['ecx']
lea ['edx,', '[ebp+Dst]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
xor ['eax,', 'eax']
mov ['ecx,', '[ebp+var_9C]']
mov ['[ebp+ecx*2+Dst],', 'ax']
lea ['edx,', '[ebp+Dst]']
mov ['[ebp+var_70],', 'edx']
jmp ['short', 'loc_8290']
mov ['eax,', '[ebp+var_70]']
add ['eax,', '2']
mov ['[ebp+var_70],', 'eax']
mov ['ecx,', '[ebp+var_70]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_82B3']
mov ['eax,', '[ebp+var_2C]']
push ['eax']
mov ['ecx,', '[ebp+var_70]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
push ['edx']
lea ['eax,', '[ebp+var_20]']
push ['eax']
call ['_clip_addchar']
add ['esp,', '0Ch']
jmp ['short', 'loc_8287']
mov ['ecx,', '[ebp+var_78]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_34]']
mov ['eax,', '[edx+14h]']
cmp ['dword', 'ptr', '[eax+ecx+8],', '0']
jz ['short', 'loc_82DE']
mov ['ecx,', '[ebp+var_78]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_34]']
mov ['eax,', '[edx+14h]']
mov ['edx,', '[ebp+var_78]']
add ['edx,', '[eax+ecx+8]']
mov ['[ebp+var_78],', 'edx']
jmp ['short', 'loc_82E0']
jmp ['short', 'loc_82E5']
jmp ['loc_7FDF']
mov ['eax,', '[ebp+arg_8]']
add ['eax,', '1']
mov ['[ebp+arg_8],', 'eax']
jmp ['loc_7F79']
cmp ['[ebp+var_30],', '0']
jz ['short', 'loc_833C']
mov ['[ebp+var_A0],', '0']
jmp ['short', 'loc_8314']
mov ['ecx,', '[ebp+var_A0]']
add ['ecx,', '1']
mov ['[ebp+var_A0],', 'ecx']
cmp ['[ebp+var_A0],', '2']
jnb ['short', 'loc_833C']
push ['0']
mov ['edx,', '[ebp+var_A0]']
movzx ['eax,', 'ds:_sel_nl[edx*2]']
push ['eax']
lea ['ecx,', '[ebp+var_20]']
push ['ecx']
call ['_clip_addchar']
add ['esp,', '0Ch']
jmp ['short', 'loc_8305']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '1']
mov ['[ebp+arg_4],', 'edx']
cmp ['[ebp+arg_14],', '0']
jz ['short', 'loc_8356']
mov ['eax,', '[ebp+var_28]']
mov ['[ebp+var_B4],', 'eax']
jmp ['short', 'loc_8360']
mov ['[ebp+var_B4],', '0']
mov ['ecx,', '[ebp+var_B4]']
mov ['[ebp+arg_8],', 'ecx']
mov ['edx,', '[ebp+var_34]']
push ['edx']
call ['_unlineptr']
add ['esp,', '4']
jmp ['loc_7DC4']
push ['0']
push ['0']
lea ['eax,', '[ebp+var_20]']
push ['eax']
call ['_clip_addchar']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_18]']
push ['ecx']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
mov ['eax,', '[ebp+var_10]']
push ['eax']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_write_clip']
add ['esp,', '14h']
mov ['ecx,', '[ebp+var_18]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_10]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN63']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '0B4h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_clip_addchar   proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+4]']
cmp ['edx,', '[ecx]']
jl ['short', 'loc_84E0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
add ['ecx,', '80h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx],', 'ecx']
push ['2']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+8],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
lea ['eax,', '[edx+eax*2]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0Ch],', 'eax']
push ['4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+10h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10h]']
lea ['eax,', '[edx+eax*4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['cx,', '[ebp+arg_4]']
mov ['[eax],', 'cx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
add ['eax,', '2']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
add ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+4],', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_do_paste  proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '24h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+Buf1],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
lea ['eax,', '[ebp+var_14]']
push ['eax']
lea ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_get_clip']
add ['esp,', '0Ch']
cmp ['[ebp+var_8],', '0']
jz ['loc_8814']
cmp ['[ebp+var_14],', '0']
jle ['loc_8814']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_seen_key_event']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1070h],', '0']
jz ['short', 'loc_85BB']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1070h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+1074h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+1078h],', '0']
push ['2']
mov ['ecx,', '[ebp+var_14]']
add ['ecx,', '0Ch']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1070h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+16Ch],', '0']
jz ['short', 'loc_8629']
push ['0Ch']
push ['offset', '$SG88354']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1070h]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1074h]']
add ['ecx,', '6']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1074h],', 'ecx']
mov ['eax,', '[ebp+var_8]']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+var_20]']
mov ['[ebp+Buf1],', 'ecx']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', '[ebp+var_8]']
lea ['ecx,', '[eax+edx*2]']
cmp ['[ebp+Buf1],', 'ecx']
jnb ['loc_8746']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', '[ebp+var_8]']
lea ['ecx,', '[eax+edx*2]']
cmp ['[ebp+Buf1],', 'ecx']
jnb ['short', 'loc_8686']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', '[ebp+var_8]']
lea ['ecx,', '[eax+edx*2-4]']
cmp ['[ebp+Buf1],', 'ecx']
ja ['short', 'loc_867B']
push ['4']
push ['offset', '_sel_nl']
mov ['edx,', '[ebp+Buf1]']
push ['edx']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_8686']
mov ['eax,', '[ebp+Buf1]']
add ['eax,', '2']
mov ['[ebp+Buf1],', 'eax']
jmp ['short', 'loc_8647']
mov ['[ebp+var_24],', '0']
jmp ['short', 'loc_8698']
mov ['ecx,', '[ebp+var_24]']
add ['ecx,', '1']
mov ['[ebp+var_24],', 'ecx']
mov ['edx,', '[ebp+Buf1]']
sub ['edx,', '[ebp+var_20]']
sar ['edx,', '1']
cmp ['[ebp+var_24],', 'edx']
jge ['short', 'loc_86DC']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1074h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1070h]']
mov ['edx,', '[ebp+var_24]']
mov ['esi,', '[ebp+var_20]']
mov ['dx,', '[esi+edx*2]']
mov ['[eax+ecx*2],', 'dx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1074h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1074h],', 'ecx']
jmp ['short', 'loc_868F']
mov ['eax,', '[ebp+var_14]']
mov ['ecx,', '[ebp+var_8]']
lea ['edx,', '[ecx+eax*2-4]']
cmp ['[ebp+Buf1],', 'edx']
ja ['short', 'loc_873B']
push ['4']
push ['offset', '_sel_nl']
mov ['eax,', '[ebp+Buf1]']
push ['eax']
call ['_memcmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jnz ['short', 'loc_873B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1074h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1070h]']
mov ['eax,', '0Dh']
mov ['[ecx+edx*2],', 'ax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1074h]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+1074h],', 'edx']
mov ['ecx,', '[ebp+Buf1]']
add ['ecx,', '4']
mov ['[ebp+Buf1],', 'ecx']
mov ['edx,', '[ebp+Buf1]']
mov ['[ebp+var_20],', 'edx']
jmp ['loc_8635']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+16Ch],', '0']
jz ['short', 'loc_878C']
push ['0Ch']
push ['offset', '$SG88372']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1074h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1070h]']
lea ['edx,', '[ecx+edx*2]']
push ['edx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1074h]']
add ['ecx,', '6']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1074h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1074h],', '100h']
jge ['short', 'loc_8814']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['short', 'loc_87CF']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1074h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1070h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_luni_send']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1070h],', '0']
jz ['short', 'loc_87ED']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1070h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+1070h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+1074h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1078h],', '0']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_get_clip']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '_term_paste_callback']
call ['_queue_toplevel_callback']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN22']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '24h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_paste_callback proc near          
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+1074h],', '0']
jnz ['short', 'loc_88BE']
jmp ['loc_89DC']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+1078h]']
cmp ['ecx,', '[eax+1074h]']
jge ['loc_89B0']
mov ['[ebp+var_8],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '[edx+1078h]']
mov ['ecx,', '[ebp+var_4]']
cmp ['eax,', '[ecx+1074h]']
jge ['short', 'loc_8935']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1078h]']
add ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+1070h]']
movzx ['eax,', 'word', 'ptr', '[edx+eax*2]']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '1']
mov ['[ebp+var_8],', 'ecx']
cmp ['eax,', '0Dh']
jnz ['short', 'loc_8924']
mov ['[ebp+var_C],', '1']
jmp ['short', 'loc_892B']
mov ['[ebp+var_C],', '0']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_8933']
jmp ['short', 'loc_8935']
jmp ['short', 'loc_88DD']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+1084h],', '0']
jz ['short', 'loc_896F']
push ['0']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+1078h]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1070h]']
lea ['edx,', '[ecx+edx*2]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_luni_send']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1078h]']
add ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+1078h],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[edx+1078h]']
cmp ['ecx,', '[eax+1074h]']
jge ['short', 'loc_89AB']
mov ['edx,', '[ebp+var_4]']
push ['edx']
push ['offset', '_term_paste_callback']
call ['_queue_toplevel_callback']
add ['esp,', '8']
jmp ['short', 'loc_89DC']
jmp ['loc_88BE']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1070h]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+1070h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+1074h],', '0']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_mouse     proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '88h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_88]']
mov ['ecx,', '22h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+15Ch],', '0']
jz ['short', 'loc_8A46']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1144h],', '0']
jnz ['short', 'loc_8A46']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+112Ch],', '0']
jz ['short', 'loc_8A3D']
cmp ['[ebp+arg_18],', '0']
jnz ['short', 'loc_8A46']
mov ['[ebp+var_60],', '1']
jmp ['short', 'loc_8A4D']
mov ['[ebp+var_60],', '0']
mov ['eax,', '[ebp+var_60]']
mov ['[ebp+var_1C],', 'eax']
cmp ['[ebp+arg_14],', '0']
jge ['short', 'loc_8A7C']
mov ['[ebp+arg_14],', '0']
cmp ['[ebp+arg_C],', '4']
jnz ['short', 'loc_8A7C']
cmp ['[ebp+var_1C],', '0']
jnz ['short', 'loc_8A7C']
push ['0FFFFFFFFh']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_scroll']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_14]']
cmp ['eax,', '[edx+128h]']
jl ['short', 'loc_8AB5']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
sub ['edx,', '1']
mov ['[ebp+arg_14],', 'edx']
cmp ['[ebp+arg_C],', '4']
jnz ['short', 'loc_8AB5']
cmp ['[ebp+var_1C],', '0']
jnz ['short', 'loc_8AB5']
push ['1']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_scroll']
add ['esp,', '0Ch']
cmp ['[ebp+arg_10],', '0']
jge ['short', 'loc_8AE2']
cmp ['[ebp+arg_14],', '0']
jle ['short', 'loc_8ADB']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
sub ['edx,', '1']
mov ['[ebp+arg_10],', 'edx']
mov ['eax,', '[ebp+arg_14]']
sub ['eax,', '1']
mov ['[ebp+arg_14],', 'eax']
jmp ['short', 'loc_8AE2']
mov ['[ebp+arg_10],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_10]']
cmp ['edx,', '[ecx+12Ch]']
jl ['short', 'loc_8AFF']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
sub ['ecx,', '1']
mov ['[ebp+arg_10],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_14]']
add ['eax,', '[edx+10h]']
mov ['[ebp+var_10],', 'eax']
push ['0']
push ['1739h']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_18],', 'eax']
mov ['eax,', '[ebp+var_18]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
and ['ecx,', '3']
jz ['short', 'loc_8B3B']
mov ['eax,', '[ebp+arg_10]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['[ebp+arg_10],', 'eax']
mov ['edx,', '[ebp+arg_14]']
push ['edx']
mov ['eax,', '[ebp+var_18]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_bidi_line']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_8B6F']
mov ['edx,', '[ebp+arg_14]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10CCh]']
mov ['edx,', '[ecx+edx+0Ch]']
mov ['eax,', '[ebp+arg_10]']
mov ['ecx,', '[edx+eax*4]']
mov ['[ebp+arg_10],', 'ecx']
mov ['edx,', '[ebp+arg_10]']
mov ['[ebp+var_C],', 'edx']
mov ['eax,', '[ebp+var_18]']
push ['eax']
call ['_unlineptr']
add ['esp,', '4']
cmp ['[ebp+var_1C],', '0']
jz ['loc_8DCA']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0E48h],', '1']
jz ['loc_8DCA']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E48h],', '2']
jz ['loc_8DCA']
mov ['[ebp+var_24],', '0']
mov ['[ebp+var_5C],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1084h],', '0']
jz ['loc_8DC5']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_64],', 'ecx']
mov ['edx,', '[ebp+var_64]']
sub ['edx,', '1']
mov ['[ebp+var_64],', 'edx']
cmp ['[ebp+var_64],', '7']
ja ['short', '$LN56']
mov ['eax,', '[ebp+var_64]']
jmp ['ds:$LN101[eax*4]']
mov ['[ebp+var_24],', '0']
mov ['[ebp+var_30],', '0']
jmp ['short', 'loc_8C3D']
mov ['[ebp+var_24],', '1']
mov ['[ebp+var_30],', '0']
jmp ['short', 'loc_8C3D']
mov ['[ebp+var_24],', '2']
mov ['[ebp+var_30],', '0']
jmp ['short', 'loc_8C3D']
mov ['[ebp+var_24],', '40h']
mov ['[ebp+var_30],', '1']
jmp ['short', 'loc_8C3D']
mov ['[ebp+var_24],', '41h']
mov ['[ebp+var_30],', '1']
jmp ['short', 'loc_8C3D']
jmp ['loc_94BF']
cmp ['[ebp+var_30],', '0']
jz ['short', 'loc_8C50']
cmp ['[ebp+arg_C],', '1']
jz ['short', 'loc_8C4E']
jmp ['loc_94BF']
jmp ['short', 'loc_8CCE']
mov ['ecx,', '[ebp+arg_C]']
mov ['[ebp+var_68],', 'ecx']
cmp ['[ebp+var_68],', '1']
jz ['short', 'loc_8CA8']
cmp ['[ebp+var_68],', '4']
jz ['short', 'loc_8C6A']
cmp ['[ebp+var_68],', '5']
jz ['short', 'loc_8C86']
jmp ['short', 'loc_8CC9']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+15Ch],', '1']
jnz ['short', 'loc_8C7B']
jmp ['loc_94BF']
mov ['eax,', '[ebp+var_24]']
add ['eax,', '20h']
mov ['[ebp+var_24],', 'eax']
jmp ['short', 'loc_8CCE']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+160h],', '0']
jnz ['short', 'loc_8C99']
mov ['[ebp+var_24],', '3']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+168h],', '0']
jmp ['short', 'loc_8CCE']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+168h]']
cmp ['ecx,', '[ebp+arg_4]']
jnz ['short', 'loc_8CBB']
jmp ['loc_94BF']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+168h],', 'eax']
jmp ['short', 'loc_8CCE']
jmp ['loc_94BF']
cmp ['[ebp+arg_18],', '0']
jz ['short', 'loc_8CDD']
mov ['ecx,', '[ebp+var_24]']
add ['ecx,', '4']
mov ['[ebp+var_24],', 'ecx']
cmp ['[ebp+arg_1C],', '0']
jz ['short', 'loc_8CEC']
mov ['edx,', '[ebp+var_24]']
add ['edx,', '10h']
mov ['[ebp+var_24],', 'edx']
mov ['eax,', '[ebp+arg_14]']
add ['eax,', '1']
mov ['[ebp+var_28],', 'eax']
mov ['ecx,', '[ebp+arg_10]']
add ['ecx,', '1']
mov ['[ebp+var_2C],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+160h],', '0']
jz ['short', 'loc_8D3D']
mov ['eax,', '[ebp+arg_C]']
sub ['eax,', '5']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '0FFFFFFE0h']
add ['eax,', '6Dh']
push ['eax']
mov ['ecx,', '[ebp+var_28]']
push ['ecx']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', '[ebp+var_24]']
push ['eax']
push ['offset', '$SG88447']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '18h']
mov ['[ebp+var_5C],', 'eax']
jmp ['short', 'loc_8DA9']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+164h],', '0']
jz ['short', 'loc_8D6E']
mov ['eax,', '[ebp+var_28]']
push ['eax']
mov ['ecx,', '[ebp+var_2C]']
push ['ecx']
mov ['edx,', '[ebp+var_24]']
add ['edx,', '20h']
push ['edx']
push ['offset', '$SG88450']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '14h']
mov ['[ebp+var_5C],', 'eax']
jmp ['short', 'loc_8DA9']
cmp ['[ebp+var_2C],', '0DFh']
jg ['short', 'loc_8DA9']
cmp ['[ebp+var_28],', '0DFh']
jg ['short', 'loc_8DA9']
mov ['ecx,', '[ebp+var_28]']
add ['ecx,', '20h']
push ['ecx']
mov ['edx,', '[ebp+var_2C]']
add ['edx,', '20h']
push ['edx']
mov ['eax,', '[ebp+var_24]']
add ['eax,', '20h']
push ['eax']
push ['offset', '$SG88453']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '14h']
mov ['[ebp+var_5C],', 'eax']
push ['0']
mov ['edx,', '[ebp+var_5C]']
push ['edx']
lea ['eax,', '[ebp+Dest]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1084h]']
push ['edx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['loc_94BF']
xor ['eax,', 'eax']
cmp ['[ebp+arg_20],', '0']
setz ['al']
mov ['ecx,', '[ebp+arg_0]']
xor ['edx,', 'edx']
cmp ['dword', 'ptr', '[ecx+1158h],', '0']
setz ['dl']
xor ['eax,', 'edx']
jz ['short', 'loc_8DEF']
mov ['[ebp+var_20],', '1']
jmp ['short', 'loc_8DF6']
mov ['[ebp+var_20],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E48h],', '0']
jnz ['short', 'loc_8E0E']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_20]']
mov ['[ecx+0E4Ch],', 'edx']
cmp ['[ebp+arg_8],', '4']
jnz ['short', 'loc_8E66']
cmp ['[ebp+arg_C],', '1']
jnz ['short', 'loc_8E66']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_deselect']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E48h],', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_20]']
mov ['[edx+0E4Ch],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_10]']
mov ['[ecx+0E64h],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['[ecx+0E68h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E50h],', '0']
jmp ['loc_949B']
cmp ['[ebp+arg_8],', '4']
jnz ['loc_8F62']
cmp ['[ebp+arg_C],', '2']
jz ['short', 'loc_8E80']
cmp ['[ebp+arg_C],', '3']
jnz ['loc_8F62']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_deselect']
add ['esp,', '4']
xor ['eax,', 'eax']
cmp ['[ebp+arg_C],', '2']
setnz ['al']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E50h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E48h],', '2']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_10]']
mov ['[eax+0E64h],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[eax+0E68h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_10]']
mov ['[eax+0E54h],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[eax+0E58h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E54h]']
mov ['edx,', '[eax+0E58h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+0E5Ch],', 'ecx']
mov ['[eax+0E60h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+0E60h]']
cmp ['eax,', '[edx+12Ch]']
jnz ['short', 'loc_8F35']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E60h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E5Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E5Ch],', 'eax']
mov ['[ebp+var_6C],', '1']
jmp ['short', 'loc_8F51']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E60h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E60h],', 'eax']
mov ['[ebp+var_6C],', '0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_sel_spread']
add ['esp,', '4']
jmp ['loc_949B']
cmp ['[ebp+arg_8],', '4']
jnz ['short', 'loc_8F6E']
cmp ['[ebp+arg_C],', '4']
jz ['short', 'loc_8F82']
cmp ['[ebp+arg_8],', '5']
jnz ['loc_93F5']
cmp ['[ebp+arg_C],', '5']
jz ['loc_93F5']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E48h],', '1']
jnz ['short', 'loc_8FAF']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E64h]']
cmp ['edx,', '[ebp+var_10]']
jnz ['short', 'loc_8FAF']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E68h]']
cmp ['ecx,', '[ebp+var_C]']
jnz ['short', 'loc_8FAF']
jmp ['loc_94BF']
cmp ['[ebp+arg_8],', '5']
jnz ['loc_9175']
cmp ['[ebp+arg_C],', '4']
jz ['loc_9175']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E48h],', '3']
jnz ['loc_9175']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E4Ch],', '0']
jnz ['loc_90E3']
mov ['ecx,', '[ebp+arg_0]']
mov ['esi,', '[ebp+var_10]']
sub ['esi,', '[ecx+0E54h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
add ['eax,', '1']
imul ['esi,', 'eax']
add ['esi,', '[ebp+var_C]']
mov ['ecx,', '[ebp+arg_0]']
sub ['esi,', '[ecx+0E58h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+0E5Ch]']
sub ['ecx,', '[eax+0E54h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
add ['eax,', '1']
imul ['ecx,', 'eax']
mov ['edx,', '[ebp+arg_0]']
add ['ecx,', '[edx+0E60h]']
mov ['eax,', '[ebp+arg_0]']
sub ['ecx,', '[eax+0E58h]']
mov ['eax,', 'ecx']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
cmp ['esi,', 'eax']
jge ['short', 'loc_90C0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E5Ch]']
mov ['eax,', '[ecx+0E60h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E64h],', 'edx']
mov ['[ecx+0E68h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E68h],', '0']
jnz ['short', 'loc_90A2']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
mov ['[eax+0E68h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E64h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E64h],', 'ecx']
mov ['[ebp+var_70],', '1']
jmp ['short', 'loc_90BE']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E68h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E68h],', 'ecx']
mov ['[ebp+var_70],', '0']
jmp ['short', 'loc_90DE']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E54h]']
mov ['edx,', '[eax+0E58h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+0E64h],', 'ecx']
mov ['[eax+0E68h],', 'edx']
jmp ['loc_9168']
mov ['ecx,', '[ebp+var_C]']
shl ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E58h]']
mov ['edx,', '[ebp+arg_0]']
add ['eax,', '[edx+0E60h]']
cmp ['ecx,', 'eax']
jge ['short', 'loc_9115']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E60h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E68h],', 'ecx']
jmp ['short', 'loc_9127']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E58h]']
mov ['[eax+0E68h],', 'edx']
mov ['eax,', '[ebp+var_10]']
shl ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E54h]']
mov ['ecx,', '[ebp+arg_0]']
add ['edx,', '[ecx+0E5Ch]']
cmp ['eax,', 'edx']
jge ['short', 'loc_9156']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E5Ch]']
mov ['[edx+0E64h],', 'ecx']
jmp ['short', 'loc_9168']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E54h]']
mov ['[edx+0E64h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E48h],', '2']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E48h],', '1']
jz ['short', 'loc_91A2']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0E48h],', '2']
jz ['short', 'loc_91A2']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_10]']
mov ['[edx+0E64h],', 'eax']
mov ['ecx,', '[ebp+var_C]']
mov ['[edx+0E68h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E48h],', '2']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E4Ch],', '0']
jnz ['loc_9317']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_10]']
cmp ['edx,', '[ecx+0E64h]']
jl ['short', 'loc_91F1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_10]']
cmp ['ecx,', '[eax+0E64h]']
jnz ['loc_9284']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_C]']
cmp ['eax,', '[edx+0E68h]']
jge ['loc_9284']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_10]']
mov ['[ecx+0E54h],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['[ecx+0E58h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E64h]']
mov ['eax,', '[ecx+0E68h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E5Ch],', 'edx']
mov ['[ecx+0E60h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+0E60h]']
cmp ['ecx,', '[eax+12Ch]']
jnz ['short', 'loc_9263']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E60h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E5Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E5Ch],', 'ecx']
mov ['[ebp+var_74],', '1']
jmp ['short', 'loc_927F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E60h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E60h],', 'ecx']
mov ['[ebp+var_74],', '0']
jmp ['loc_9312']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E64h]']
mov ['edx,', '[eax+0E68h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+0E54h],', 'ecx']
mov ['[eax+0E58h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_10]']
mov ['[ecx+0E5Ch],', 'edx']
mov ['eax,', '[ebp+var_C]']
mov ['[ecx+0E60h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+0E60h]']
cmp ['eax,', '[edx+12Ch]']
jnz ['short', 'loc_92F6']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E60h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E5Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E5Ch],', 'eax']
mov ['[ebp+var_78],', '1']
jmp ['short', 'loc_9312']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E60h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E60h],', 'eax']
mov ['[ebp+var_78],', '0']
jmp ['loc_93E4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E68h]']
cmp ['eax,', '[ebp+var_C]']
jge ['short', 'loc_9333']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E68h]']
mov ['[ebp+var_7C],', 'edx']
jmp ['short', 'loc_9339']
mov ['eax,', '[ebp+var_C]']
mov ['[ebp+var_7C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_7C]']
mov ['[ecx+0E58h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E68h]']
cmp ['ecx,', '[ebp+var_C]']
jle ['short', 'loc_9361']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E68h]']
mov ['[ebp+var_80],', 'eax']
jmp ['short', 'loc_9367']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_80],', 'ecx']
mov ['edx,', '[ebp+var_80]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+0E60h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E64h]']
cmp ['edx,', '[ebp+var_10]']
jge ['short', 'loc_9395']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E64h]']
mov ['[ebp+var_84],', 'ecx']
jmp ['short', 'loc_939E']
mov ['edx,', '[ebp+var_10]']
mov ['[ebp+var_84],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_84]']
mov ['[eax+0E54h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E64h]']
cmp ['eax,', '[ebp+var_10]']
jle ['short', 'loc_93CC']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E64h]']
mov ['[ebp+var_88],', 'edx']
jmp ['short', 'loc_93D5']
mov ['eax,', '[ebp+var_10]']
mov ['[ebp+var_88],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_88]']
mov ['[ecx+0E5Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sel_spread']
add ['esp,', '4']
jmp ['loc_949B']
cmp ['[ebp+arg_8],', '4']
jz ['short', 'loc_9401']
cmp ['[ebp+arg_8],', '5']
jnz ['short', 'loc_9471']
cmp ['[ebp+arg_C],', '5']
jnz ['short', 'loc_9471']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0E48h],', '2']
jnz ['short', 'loc_9462']
push ['0']
mov ['edx,', '[ebp+arg_0]']
xor ['eax,', 'eax']
cmp ['dword', 'ptr', '[edx+0E4Ch],', '1']
setz ['al']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E60h]']
push ['edx']
mov ['eax,', '[ecx+0E5Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E58h]']
push ['edx']
mov ['eax,', '[ecx+0E54h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_clipme']
add ['esp,', '1Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E48h],', '3']
jmp ['short', 'loc_946F']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E48h],', '0']
jmp ['short', 'loc_949B']
cmp ['[ebp+arg_8],', '6']
jnz ['short', 'loc_949B']
cmp ['[ebp+arg_C],', '1']
jz ['short', 'loc_9489']
cmp ['[ebp+arg_C],', '2']
jz ['short', 'loc_9489']
cmp ['[ebp+arg_C],', '3']
jnz ['short', 'loc_949B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1088h]']
push ['edx']
call ['_request_paste']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E48h],', '2']
jz ['short', 'loc_94B3']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_out']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_update']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN100']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '88h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_out       proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '418h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_418]']
mov ['ecx,', '106h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+Size],', '0']
mov ['[ebp+var_14],', '0FFFFFFFFh']
mov ['[ebp+var_120],', '0']
cmp ['[ebp+Size],', '0']
jg ['short', 'loc_95B4']
cmp ['[ebp+var_14],', '0FFFFFFFFh']
jnz ['short', 'loc_95B4']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '60h']
push ['eax']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jle ['loc_E514']
cmp ['[ebp+var_14],', '0FFFFFFFFh']
jnz ['loc_96BA']
cmp ['[ebp+Size],', '0']
jnz ['loc_965D']
lea ['ecx,', '[ebp+Size]']
push ['ecx']
lea ['edx,', '[ebp+Src]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '60h']
push ['eax']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
cmp ['[ebp+Size],', '100h']
jbe ['short', 'loc_95FE']
mov ['[ebp+Size],', '100h']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+Src]']
push ['edx']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Size]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '60h']
push ['edx']
call ['_bufchain_consume']
add ['esp,', '8']
lea ['eax,', '[ebp+Dst]']
mov ['[ebp+var_120],', 'eax']
cmp ['[ebp+var_120],', '0']
jnz ['short', 'loc_965D']
push ['0AC0h']
push ['offset', '$SG87020']
push ['offset', '$SG87021']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_120]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
mov ['[ebp+C],', 'eax']
mov ['ecx,', '[ebp+var_120]']
add ['ecx,', '1']
mov ['[ebp+var_120],', 'ecx']
mov ['edx,', '[ebp+Size]']
sub ['edx,', '1']
mov ['[ebp+Size],', 'edx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1128h],', '2']
jnz ['short', 'loc_96B8']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+108Ch],', '0']
jz ['short', 'loc_96B8']
push ['2']
movzx ['edx,', 'byte', 'ptr', '[ebp+C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+108Ch]']
push ['ecx']
call ['_logtraffic']
add ['esp,', '0Ch']
jmp ['short', 'loc_96C7']
mov ['edx,', '[ebp+var_14]']
mov ['[ebp+C],', 'edx']
mov ['[ebp+var_14],', '0FFFFFFFFh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0ECh],', '0']
jz ['loc_97BC']
push ['1']
lea ['ecx,', '[ebp+C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '0F8h']
push ['edx']
call ['_bufchain_add']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0F0h],', '0']
jz ['loc_97BC']
cmp ['[ebp+C],', '1Bh']
jnz ['short', 'loc_9717']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0F4h],', '1']
jmp ['loc_979F']
cmp ['[ebp+C],', '9Bh']
jnz ['short', 'loc_972F']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0F4h],', '2']
jmp ['short', 'loc_979F']
cmp ['[ebp+C],', '5Bh']
jnz ['short', 'loc_9750']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0F4h],', '1']
jnz ['short', 'loc_9750']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0F4h],', '2']
jmp ['short', 'loc_979F']
cmp ['[ebp+C],', '34h']
jnz ['short', 'loc_9771']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0F4h],', '2']
jnz ['short', 'loc_9771']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0F4h],', '3']
jmp ['short', 'loc_979F']
cmp ['[ebp+C],', '69h']
jnz ['short', 'loc_9792']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0F4h],', '3']
jnz ['short', 'loc_9792']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0F4h],', '4']
jmp ['short', 'loc_979F']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0F4h],', '0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0F4h],', '4']
jnz ['short', 'loc_97B7']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_print_finish']
add ['esp,', '4']
jmp ['loc_958E']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E44h],', '0']
jnz ['loc_9C95']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0DCh],', '0']
jnz ['short', 'loc_97EE']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
cmp ['dword', 'ptr', '[eax+0Ch],', '0FDE9h']
jnz ['loc_9B3C']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E0h]']
mov ['[ebp+var_338],', 'edx']
cmp ['[ebp+var_338],', '0']
jz ['short', 'loc_9825']
cmp ['[ebp+var_338],', '0']
jle ['loc_9B37']
cmp ['[ebp+var_338],', '5']
jle ['loc_99BB']
jmp ['loc_9B37']
cmp ['[ebp+C],', '80h']
jnb ['short', 'loc_9879']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+C]']
movzx ['eax,', 'byte', 'ptr', '[ecx+edx+0A10h]']
cmp ['eax,', '0FFh']
jz ['short', 'loc_9862']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
mov ['eax,', '[ebp+C]']
movzx ['ecx,', 'byte', 'ptr', '[edx+eax+0A10h]']
mov ['[ebp+C],', 'ecx']
jmp ['short', 'loc_986F']
movzx ['edx,', 'byte', 'ptr', '[ebp+C]']
or ['edx,', '0D800h']
mov ['[ebp+C],', 'edx']
jmp ['loc_9B37']
jmp ['loc_99B6']
mov ['eax,', '[ebp+C]']
and ['eax,', '0E0h']
cmp ['eax,', '0C0h']
jnz ['short', 'loc_98B6']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E0h],', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E8h],', '1']
mov ['eax,', '[ebp+C]']
and ['eax,', '1Fh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E4h],', 'eax']
jmp ['loc_99B6']
mov ['edx,', '[ebp+C]']
and ['edx,', '0F0h']
cmp ['edx,', '0E0h']
jnz ['short', 'loc_98F5']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E0h],', '2']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E8h],', '2']
mov ['edx,', '[ebp+C]']
and ['edx,', '0Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+0E4h],', 'edx']
jmp ['loc_99B6']
mov ['ecx,', '[ebp+C]']
and ['ecx,', '0F8h']
cmp ['ecx,', '0F0h']
jnz ['short', 'loc_9934']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E0h],', '3']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E8h],', '3']
mov ['ecx,', '[ebp+C]']
and ['ecx,', '7']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E4h],', 'ecx']
jmp ['loc_99B6']
mov ['eax,', '[ebp+C]']
and ['eax,', '0FCh']
cmp ['eax,', '0F8h']
jnz ['short', 'loc_996E']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E0h],', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E8h],', '4']
mov ['eax,', '[ebp+C]']
and ['eax,', '3']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E4h],', 'eax']
jmp ['short', 'loc_99B6']
mov ['edx,', '[ebp+C]']
and ['edx,', '0FEh']
cmp ['edx,', '0FCh']
jnz ['short', 'loc_99AA']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E0h],', '5']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E8h],', '5']
mov ['edx,', '[ebp+C]']
and ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+0E4h],', 'edx']
jmp ['short', 'loc_99B6']
mov ['[ebp+C],', '0D961h']
jmp ['loc_9B37']
jmp ['loc_958E']
mov ['ecx,', '[ebp+C]']
and ['ecx,', '0C0h']
cmp ['ecx,', '80h']
jz ['short', 'loc_99EB']
mov ['edx,', '[ebp+C]']
mov ['[ebp+var_14],', 'edx']
mov ['[ebp+C],', '0D961h']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E0h],', '0']
jmp ['loc_9B37']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E4h]']
shl ['edx,', '6']
mov ['eax,', '[ebp+C]']
and ['eax,', '3Fh']
or ['edx,', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E4h],', 'edx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E0h]']
sub ['eax,', '1']
mov ['[ebp+var_33C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_33C]']
mov ['[ecx+0E0h],', 'edx']
cmp ['[ebp+var_33C],', '0']
jz ['short', 'loc_9A37']
jmp ['loc_958E']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E4h]']
mov ['[ebp+C],', 'ecx']
cmp ['[ebp+C],', '80h']
jb ['short', 'loc_9AA0']
cmp ['[ebp+C],', '800h']
jnb ['short', 'loc_9A61']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E8h],', '2']
jge ['short', 'loc_9AA0']
cmp ['[ebp+C],', '(offset', 'loc_FFFF+1)']
jnb ['short', 'loc_9A76']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E8h],', '3']
jge ['short', 'loc_9AA0']
cmp ['[ebp+C],', '200000h']
jnb ['short', 'loc_9A8B']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0E8h],', '4']
jge ['short', 'loc_9AA0']
cmp ['[ebp+C],', '4000000h']
jnb ['short', 'loc_9AA7']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E8h],', '5']
jl ['short', 'loc_9AA7']
mov ['[ebp+C],', '0D961h']
cmp ['[ebp+C],', '2028h']
jz ['short', 'loc_9AB9']
cmp ['[ebp+C],', '2029h']
jnz ['short', 'loc_9AC0']
mov ['[ebp+C],', '85h']
cmp ['[ebp+C],', '0A0h']
jnb ['short', 'loc_9AD0']
mov ['[ebp+C],', '0FFFDh']
cmp ['[ebp+C],', '0D800h']
jb ['short', 'loc_9AE9']
cmp ['[ebp+C],', '0E000h']
jnb ['short', 'loc_9AE9']
mov ['[ebp+C],', '0D961h']
cmp ['[ebp+C],', '10FFFFh']
jbe ['short', 'loc_9AF9']
mov ['[ebp+C],', '0D961h']
cmp ['[ebp+C],', '0E0000h']
jb ['short', 'loc_9B10']
cmp ['[ebp+C],', '0E007Fh']
ja ['short', 'loc_9B10']
jmp ['loc_958E']
cmp ['[ebp+C],', '0FEFFh']
jnz ['short', 'loc_9B1E']
jmp ['loc_958E']
cmp ['[ebp+C],', '0FFFEh']
jz ['short', 'loc_9B30']
cmp ['[ebp+C],', '0FFFFh']
jnz ['short', 'loc_9B37']
mov ['[ebp+C],', '0D961h']
jmp ['loc_9C95']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0D0h],', '0']
jz ['short', 'loc_9B88']
cmp ['[ebp+C],', '1Bh']
jz ['short', 'loc_9B88']
cmp ['[ebp+C],', '0Ah']
jz ['short', 'loc_9B88']
cmp ['[ebp+C],', '0Dh']
jz ['short', 'loc_9B88']
cmp ['[ebp+C],', '8']
jz ['short', 'loc_9B88']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0D0h],', '2']
jnz ['short', 'loc_9B78']
mov ['edx,', '[ebp+C]']
or ['edx,', '80h']
mov ['[ebp+C],', 'edx']
mov ['eax,', '[ebp+C]']
or ['eax,', '0DA00h']
mov ['[ebp+C],', 'eax']
jmp ['loc_9C95']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+94h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+edx*4+170h]']
mov ['[ebp+var_340],', 'ecx']
cmp ['[ebp+var_340],', '0DA00h']
jg ['short', 'loc_9BDA']
cmp ['[ebp+var_340],', '0DA00h']
jz ['loc_9C82']
cmp ['[ebp+var_340],', '0D800h']
jz ['short', 'loc_9C3E']
cmp ['[ebp+var_340],', '0D900h']
jz ['short', 'loc_9BEB']
jmp ['loc_9C95']
cmp ['[ebp+var_340],', '0DB00h']
jz ['short', 'loc_9C2F']
jmp ['loc_9C95']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[ebp+C]']
movzx ['edx,', 'byte', 'ptr', '[eax+ecx+0A10h]']
cmp ['edx,', '0FFh']
jz ['short', 'loc_9C20']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+C]']
movzx ['eax,', 'byte', 'ptr', '[ecx+edx+0A10h]']
mov ['[ebp+C],', 'eax']
jmp ['short', 'loc_9C2D']
movzx ['ecx,', 'byte', 'ptr', '[ebp+C]']
or ['ecx,', '0D900h']
mov ['[ebp+C],', 'ecx']
jmp ['short', 'loc_9C95']
cmp ['[ebp+C],', '23h']
jnz ['short', 'loc_9C3E']
mov ['[ebp+C],', '0D97Dh']
jmp ['short', 'loc_9C95']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[ebp+C]']
movzx ['edx,', 'byte', 'ptr', '[eax+ecx+0A10h]']
cmp ['edx,', '0FFh']
jz ['short', 'loc_9C73']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+C]']
movzx ['eax,', 'byte', 'ptr', '[ecx+edx+0A10h]']
mov ['[ebp+C],', 'eax']
jmp ['short', 'loc_9C80']
movzx ['ecx,', 'byte', 'ptr', '[ebp+C]']
or ['ecx,', '0D800h']
mov ['[ebp+C],', 'ecx']
jmp ['short', 'loc_9C95']
cmp ['[ebp+C],', '20h']
jb ['short', 'loc_9C95']
movzx ['edx,', 'byte', 'ptr', '[ebp+C]']
or ['edx,', '0DA00h']
mov ['[ebp+C],', 'edx']
mov ['eax,', '[ebp+C]']
and ['eax,', '0FFFFFFE0h']
cmp ['eax,', '80h']
jnz ['short', 'loc_9CFC']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0E44h],', '5']
jge ['short', 'loc_9CFC']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+148h],', '0']
jnz ['short', 'loc_9CFC']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '10h']
jz ['short', 'loc_9CFC']
cmp ['[ebp+C],', '9Ah']
jnz ['short', 'loc_9CD6']
mov ['[ebp+C],', '0']
jmp ['short', 'loc_9CFC']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+230h],', '0']
mov ['ecx,', '[ebp+C]']
and ['ecx,', '1Fh']
add ['ecx,', '40h']
mov ['[ebp+C],', 'ecx']
cmp ['[ebp+C],', '7Fh']
jnz ['loc_9DD1']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E44h],', '5']
jge ['loc_9DD1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '4000h']
jz ['loc_9DD1']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+70h],', '0']
jz ['short', 'loc_9D4B']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+8Ch],', '0']
jnz ['short', 'loc_9D4B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+70h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+8Ch],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1140h],', '0']
jnz ['short', 'loc_9DCC']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
add ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '54h']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
push ['1']
push ['0B8Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_lineptr']
add ['esp,', '10h']
push ['eax']
call ['_copy_termchar']
add ['esp,', '0Ch']
jmp ['$LN526']
mov ['ecx,', '[ebp+C]']
and ['ecx,', '0FFFFFFE0h']
jnz ['loc_A471']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E44h],', '5']
jge ['loc_A471']
mov ['eax,', '[ebp+C]']
mov ['[ebp+var_344],', 'eax']
mov ['ecx,', '[ebp+var_344]']
sub ['ecx,', '5']
mov ['[ebp+var_344],', 'ecx']
cmp ['[ebp+var_344],', '16h']
ja ['$LN523']
mov ['edx,', '[ebp+var_344]']
movzx ['eax,', 'ds:$LN705[edx]']
jmp ['ds:$LN731[eax*4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '1']
jnz ['short', 'loc_9E42']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN523']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['short', 'loc_9E78']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10DCh]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10D8h]']
push ['edx']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_lpage_send']
add ['esp,', '14h']
jmp ['$LN523']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_140],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+34h],', '0']
jnz ['short', 'loc_9F08']
push ['8']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_13C],', 'eax']
mov ['eax,', '[ebp+var_13C]']
mov ['ecx,', '[ebp+var_140]']
mov ['[eax+4],', 'ecx']
mov ['edx,', '[ebp+var_13C]']
mov ['dword', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+28h],', '0']
jnz ['short', 'loc_9EDF']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_13C]']
mov ['[ecx+28h],', 'edx']
jmp ['short', 'loc_9EED']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+2Ch]']
mov ['edx,', '[ebp+var_13C]']
mov ['[ecx],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_13C]']
mov ['[eax+2Ch],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+30h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+30h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+28h],', '0']
jz ['short', 'loc_9F78']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+28h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_140]']
sub ['eax,', '[edx+10F4h]']
cmp ['[ecx+4],', 'eax']
jnb ['short', 'loc_9F78']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+28h]']
mov ['[ebp+var_144],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_144]']
mov ['edx,', '[ecx]']
mov ['[eax+28h],', 'edx']
mov ['eax,', '[ebp+var_144]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+28h],', '0']
jnz ['short', 'loc_9F67']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+2Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+30h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+30h],', 'ecx']
jmp ['short', 'loc_9F08']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10E8h],', '0']
jz ['short', 'loc_9FB0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+34h],', '0']
jz ['short', 'loc_9FB0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_140]']
sub ['eax,', '[edx+38h]']
mov ['ecx,', '[ebp+arg_0]']
cmp ['eax,', '[ecx+10F0h]']
jb ['short', 'loc_9FB0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+34h],', '0']
jmp ['short', 'loc_9FE0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10E8h],', '0']
jz ['short', 'loc_9FE0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+34h],', '0']
jnz ['short', 'loc_9FE0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+30h]']
cmp ['ecx,', '[eax+10ECh]']
jl ['short', 'loc_9FE0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+34h],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_140]']
mov ['[eax+38h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+10E8h],', '0']
jz ['short', 'loc_A001']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+34h],', '0']
jnz ['short', 'loc_A039']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+10E4h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1088h]']
push ['ecx']
call ['_do_beep']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+10E4h],', '2']
jnz ['short', 'loc_A039']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_schedule_vbell']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN523']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+70h],', '0']
jnz ['short', 'loc_A06A']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+6Ch],', '0']
jz ['short', 'loc_A068']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+88h],', '0']
jnz ['short', 'loc_A06A']
jmp ['short', 'loc_A0C9']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+70h],', '0']
jnz ['short', 'loc_A09F']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+6Ch],', '0']
jle ['short', 'loc_A09F']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+70h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+6Ch],', 'edx']
jmp ['short', 'loc_A0C9']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+8Ch],', '0']
jz ['short', 'loc_A0BA']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+8Ch],', '0']
jmp ['short', 'loc_A0C9']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+70h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN523']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_A0F6']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN523']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+94h],', '1']
jmp ['$LN523']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_A124']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN523']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+94h],', '0']
jmp ['$LN523']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+148h],', '0']
jz ['short', 'loc_A151']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '9']
jmp ['short', 'loc_A187']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '1']
jnz ['short', 'loc_A16D']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN523']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+230h],', '0']
jmp ['$LN523']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+70h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+8Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1114h],', '0']
jz ['short', 'loc_A212']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+6Ch]']
cmp ['ecx,', '[eax+80h]']
jnz ['short', 'loc_A1EF']
push ['1']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+80h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+7Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_A212']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
cmp ['[eax+6Ch],', 'edx']
jge ['short', 'loc_A212']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+6Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+108Ch],', '0']
jz ['short', 'loc_A237']
push ['1']
movzx ['edx,', 'byte', 'ptr', '[ebp+C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+108Ch]']
push ['ecx']
call ['_logtraffic']
add ['esp,', '0Ch']
jmp ['$LN523']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '1000h']
jz ['short', '$LN481']
push ['0']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_move']
add ['esp,', '10h']
push ['1']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_erase_lots']
add ['esp,', '10h']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1164h],', '0']
jz ['short', 'loc_A282']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+10h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+8Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN523']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', '$LN479']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN523']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+6Ch]']
cmp ['eax,', '[edx+80h]']
jnz ['short', 'loc_A2F0']
push ['1']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+80h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_A313']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
cmp ['[edx+6Ch],', 'ecx']
jge ['short', 'loc_A313']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+6Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1120h],', '0']
jz ['short', 'loc_A329']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+70h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+8Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+108Ch],', '0']
jz ['short', 'loc_A367']
push ['1']
movzx ['edx,', 'byte', 'ptr', '[ebp+C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+108Ch]']
push ['ecx']
call ['_logtraffic']
add ['esp,', '0Ch']
jmp ['$LN523']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
mov ['ecx,', '[edx+70h]']
mov ['[ebp+var_150],', 'eax']
mov ['[ebp+var_14C],', 'ecx']
push ['1']
push ['0C28h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_158],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+70h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
cmp ['[ecx+70h],', 'eax']
jge ['short', 'loc_A3DB']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E40h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
movzx ['eax,', 'byte', 'ptr', '[eax+edx]']
test ['eax,', 'eax']
jz ['short', 'loc_A3A1']
mov ['ecx,', '[ebp+var_158]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
and ['edx,', '3']
jz ['short', 'loc_A418']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+12Ch]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
cmp ['[ecx+70h],', 'eax']
jl ['short', 'loc_A416']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
cdq
sub ['eax,', 'edx']
sar ['eax,', '1']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+70h],', 'eax']
jmp ['short', 'loc_A43B']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+70h]']
cmp ['ecx,', '[eax+12Ch]']
jl ['short', 'loc_A43B']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+70h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[edx+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_14C]']
push ['edx']
mov ['eax,', '[ebp+var_150]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_selection']
add ['esp,', '14h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN526']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E44h]']
mov ['[ebp+var_348],', 'ecx']
cmp ['[ebp+var_348],', '0Dh']
ja ['$LN526']
mov ['edx,', '[ebp+var_348]']
jmp ['ds:$LN732[edx*4]']
push ['1']
push ['0C42h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_15C],', 'eax']
mov ['[ebp+var_160],', '0']
mov ['eax,', '[ebp+C]']
and ['eax,', '0FFFFFC00h']
cmp ['eax,', '0D800h']
jnz ['short', 'loc_A4DD']
mov ['[ebp+var_160],', '1']
cmp ['[ebp+var_160],', '0']
jnz ['short', 'loc_A524']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1108h],', '0']
jz ['short', 'loc_A506']
mov ['edx,', '[ebp+C]']
push ['edx']
call ['_mk_wcwidth_cjk']
add ['esp,', '4']
mov ['[ebp+var_34C],', 'eax']
jmp ['short', 'loc_A518']
mov ['eax,', '[ebp+C]']
push ['eax']
call ['_mk_wcwidth']
add ['esp,', '4']
mov ['[ebp+var_34C],', 'eax']
mov ['ecx,', '[ebp+var_34C]']
mov ['[ebp+var_160],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+8Ch],', '0']
jz ['loc_A5F4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+88h],', '0']
jz ['loc_A5F4']
cmp ['[ebp+var_160],', '0']
jle ['loc_A5F4']
mov ['ecx,', '[ebp+var_15C]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
or ['edx,', '10h']
mov ['eax,', '[ebp+var_15C]']
mov ['[eax],', 'dx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+6Ch]']
cmp ['eax,', '[edx+80h]']
jnz ['short', 'loc_A59A']
push ['1']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+80h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_A5BD']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
cmp ['[edx+6Ch],', 'ecx']
jge ['short', 'loc_A5BD']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+6Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+70h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+8Ch],', '0']
push ['1']
push ['0C53h']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_15C],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+90h],', '0']
jz ['short', 'loc_A61C']
cmp ['[ebp+var_160],', '0']
jle ['short', 'loc_A61C']
mov ['eax,', '[ebp+var_160]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_insch']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E48h],', '0']
jz ['loc_A6B5']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
mov ['edx,', '[eax+70h]']
mov ['[ebp+var_16C],', 'ecx']
mov ['[ebp+var_168],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_168]']
cmp ['ecx,', '[eax+12Ch]']
jnz ['short', 'loc_A677']
mov ['[ebp+var_168],', '0']
mov ['edx,', '[ebp+var_16C]']
add ['edx,', '1']
mov ['[ebp+var_16C],', 'edx']
mov ['[ebp+var_350],', '1']
jmp ['short', 'loc_A690']
mov ['eax,', '[ebp+var_168]']
add ['eax,', '1']
mov ['[ebp+var_168],', 'eax']
mov ['[ebp+var_350],', '0']
mov ['ecx,', '[ebp+var_168]']
push ['ecx']
mov ['edx,', '[ebp+var_16C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[eax+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_check_selection']
add ['esp,', '14h']
mov ['ecx,', '[ebp+C]']
and ['ecx,', '0FFFFFF00h']
cmp ['ecx,', '0D800h']
jz ['short', 'loc_A6D1']
mov ['edx,', '[ebp+C]']
and ['edx,', '0FFFFFF00h']
jnz ['short', 'loc_A6F6']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+108Ch],', '0']
jz ['short', 'loc_A6F6']
push ['1']
movzx ['ecx,', 'byte', 'ptr', '[ebp+C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+108Ch]']
push ['eax']
call ['_logtraffic']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_160]']
mov ['[ebp+var_354],', 'ecx']
cmp ['[ebp+var_354],', '0']
jz ['loc_A992']
cmp ['[ebp+var_354],', '1']
jz ['loc_A90C']
cmp ['[ebp+var_354],', '2']
jz ['short', 'loc_A72A']
jmp ['loc_AA3E']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
add ['ecx,', '2']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
cmp ['[edx+70h],', 'ecx']
jnz ['loc_A863']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '54h']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ebp+var_15C]']
push ['eax']
call ['_copy_termchar']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_15C]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
or ['edx,', '30h']
mov ['eax,', '[ebp+var_15C]']
mov ['[eax],', 'dx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+6Ch]']
cmp ['eax,', '[edx+80h]']
jnz ['short', 'loc_A7DF']
push ['1']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+80h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_A802']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
cmp ['[edx+6Ch],', 'ecx']
jge ['short', 'loc_A802']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+6Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+70h],', '0']
push ['1']
push ['0C83h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_15C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
add ['eax,', '2']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[ebp+var_15C]']
push ['ecx']
call ['_clear_cc']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_15C]']
mov ['edx,', '[ecx+14h]']
mov ['ecx,', '[ebp+C]']
mov ['[eax+edx],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_15C]']
mov ['edx,', '[ecx+14h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['ecx,', '[ecx+40h]']
mov ['[edx+eax+4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+70h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[ebp+var_15C]']
push ['ecx']
call ['_clear_cc']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_15C]']
mov ['edx,', '[ecx+14h]']
mov ['dword', 'ptr', '[eax+edx],', '0DFFFh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_15C]']
mov ['eax,', '[edx+14h]']
mov ['edx,', '[ebp+arg_0]']
mov ['edx,', '[edx+40h]']
mov ['[eax+ecx+4],', 'edx']
jmp ['loc_AA43']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
add ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ebp+var_15C]']
push ['eax']
call ['_clear_cc']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_15C]']
mov ['ecx,', '[eax+14h]']
mov ['eax,', '[ebp+C]']
mov ['[edx+ecx],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_15C]']
mov ['ecx,', '[eax+14h]']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+40h]']
mov ['[ecx+edx+4],', 'eax']
jmp ['loc_AA43']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+70h],', '0']
jle ['loc_AA39']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
sub ['eax,', '1']
mov ['[ebp+var_174],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+8Ch],', '0']
jz ['short', 'loc_A9C9']
mov ['edx,', '[ebp+var_174]']
add ['edx,', '1']
mov ['[ebp+var_174],', 'edx']
mov ['eax,', '[ebp+var_174]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_15C]']
mov ['edx,', '[ecx+14h]']
cmp ['dword', 'ptr', '[eax+edx],', '0DFFFh']
jnz ['short', 'loc_AA13']
cmp ['[ebp+var_174],', '0']
jg ['short', 'loc_AA04']
push ['0CAEh']
push ['offset', '$SG87221']
push ['offset', '$SG87222']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_174]']
sub ['ecx,', '1']
mov ['[ebp+var_174],', 'ecx']
mov ['edx,', '[ebp+C]']
push ['edx']
mov ['eax,', '[ebp+var_174]']
push ['eax']
mov ['ecx,', '[ebp+var_15C]']
push ['ecx']
call ['_add_cc']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['loc_958E']
jmp ['loc_958E']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+70h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+70h]']
cmp ['edx,', '[ecx+12Ch]']
jnz ['loc_AB26']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+70h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+8Ch],', '1']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+88h],', '0']
jz ['loc_AB26']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+148h],', '0']
jz ['loc_AB26']
mov ['eax,', '[ebp+var_15C]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
or ['ecx,', '10h']
mov ['edx,', '[ebp+var_15C]']
mov ['[edx],', 'cx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+6Ch]']
cmp ['edx,', '[ecx+80h]']
jnz ['short', 'loc_AAEC']
push ['1']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+80h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+7Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_AB0F']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
cmp ['[ecx+6Ch],', 'eax']
jge ['short', 'loc_AB0F']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+6Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+70h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+8Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN526']
cmp ['[ebp+C],', '5Ch']
jnz ['short', '$LN430']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_do_osc']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN526']
cmp ['[ebp+C],', '20h']
jb ['short', 'loc_AB93']
cmp ['[ebp+C],', '2Fh']
ja ['short', 'loc_AB93']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+230h],', '0']
jz ['short', 'loc_AB82']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+230h],', '0FFFFFFFFh']
jmp ['short', 'loc_AB8E']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+C]']
mov ['[eax+230h],', 'ecx']
jmp ['$LN526']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+230h]']
shl ['ecx,', '8']
add ['ecx,', '[ebp+C]']
mov ['[ebp+var_358],', 'ecx']
cmp ['[ebp+var_358],', '2336h']
ja ['short', 'loc_AC01']
cmp ['[ebp+var_358],', '2333h']
jnb ['loc_B2A4']
mov ['edx,', '[ebp+var_358]']
sub ['edx,', '37h']
mov ['[ebp+var_358],', 'edx']
cmp ['[ebp+var_358],', '2Ch']
ja ['$LN425']
mov ['eax,', '[ebp+var_358]']
movzx ['ecx,', 'ds:$LN706[eax]']
jmp ['ds:$LN733[ecx*4]']
cmp ['[ebp+var_358],', '2842h']
ja ['loc_AC97']
cmp ['[ebp+var_358],', '2842h']
jz ['loc_B3AB']
cmp ['[ebp+var_358],', '2547h']
ja ['short', 'loc_AC72']
cmp ['[ebp+var_358],', '2547h']
jz ['loc_B544']
cmp ['[ebp+var_358],', '2338h']
jz ['loc_B133']
cmp ['[ebp+var_358],', '2538h']
jz ['loc_B544']
cmp ['[ebp+var_358],', '2540h']
jz ['loc_B57A']
jmp ['$LN425']
cmp ['[ebp+var_358],', '2830h']
jz ['loc_B3E5']
cmp ['[ebp+var_358],', '2841h']
jz ['loc_B371']
jmp ['$LN425']
cmp ['[ebp+var_358],', '2941h']
ja ['short', 'loc_ACD8']
cmp ['[ebp+var_358],', '2941h']
jz ['loc_B45C']
cmp ['[ebp+var_358],', '2855h']
jz ['loc_B41F']
cmp ['[ebp+var_358],', '2930h']
jz ['loc_B4D0']
jmp ['$LN425']
cmp ['[ebp+var_358],', '2942h']
jz ['loc_B496']
cmp ['[ebp+var_358],', '2955h']
jz ['loc_B50A']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '2']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+22Ch],', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1ACh],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+230h],', '0']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '4000h']
jnz ['short', 'loc_AD55']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '3']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1ACh],', '0']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_AD90']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN425']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_save_cursor']
add ['esp,', '8']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '2']
jnz ['short', 'loc_ADBF']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN425']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_save_cursor']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_ADFA']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+144h],', '1']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '2']
jnz ['short', 'loc_AE28']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+144h],', '0']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_AE56']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+6Ch]']
cmp ['eax,', '[edx+80h]']
jnz ['short', 'loc_AE8A']
push ['1']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+80h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_AEAD']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
cmp ['[edx+6Ch],', 'ecx']
jge ['short', 'loc_AEAD']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+6Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+8Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_AEE7']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+70h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+6Ch]']
cmp ['edx,', '[ecx+80h]']
jnz ['short', 'loc_AF25']
push ['1']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+80h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+7Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_AF48']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
cmp ['[ecx+6Ch],', 'eax']
jge ['short', 'loc_AF48']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+6Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+8Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_AF82']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+6Ch]']
cmp ['eax,', '[edx+7Ch]']
jnz ['short', 'loc_AFB3']
push ['1']
push ['0FFFFFFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+80h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+7Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_AFCB']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+6Ch],', '0']
jle ['short', 'loc_AFCB']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+6Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+8Ch],', '0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '2']
jnz ['short', 'loc_B005']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1084h],', '0']
jz ['short', 'loc_B042']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '0A40h']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '0A40h']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_B063']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN425']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_power_on']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1084h],', '0']
jz ['short', 'loc_B095']
push ['0']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1084h]']
push ['edx']
call ['_ldisc_send']
add ['esp,', '10h']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0B4h],', '0']
jz ['short', 'loc_B0D8']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+114Ch],', '0']
jnz ['short', 'loc_B0CB']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
push ['eax']
push ['50h']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1088h]']
push ['edx']
call ['_request_resize']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0B4h],', '0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1164h],', '0']
jz ['short', 'loc_B0EE']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_B11B']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E40h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
mov ['byte', 'ptr', '[edx+ecx],', '1']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_B14F']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN425']
mov ['[ebp+var_17C],', '0']
jmp ['short', 'loc_B16A']
mov ['edx,', '[ebp+var_17C]']
add ['edx,', '1']
mov ['[ebp+var_17C],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_17C]']
cmp ['ecx,', '[eax+128h]']
jge ['loc_B226']
push ['1']
push ['0D3Bh']
mov ['edx,', '[ebp+var_17C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_178],', 'eax']
mov ['ecx,', '[ebp+var_178]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_check_line_size']
add ['esp,', '8']
mov ['[ebp+var_180],', '0']
jmp ['short', 'loc_B1CD']
mov ['eax,', '[ebp+var_180]']
add ['eax,', '1']
mov ['[ebp+var_180],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_180]']
cmp ['edx,', '[ecx+12Ch]']
jge ['short', 'loc_B216']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '48h']
push ['eax']
mov ['ecx,', '[ebp+var_180]']
push ['ecx']
mov ['edx,', '[ebp+var_178]']
push ['edx']
call ['_copy_termchar']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_180]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_178]']
mov ['edx,', '[ecx+14h]']
mov ['dword', 'ptr', '[eax+edx],', '45h']
jmp ['short', 'loc_B1BE']
xor ['eax,', 'eax']
mov ['ecx,', '[ebp+var_178]']
mov ['[ecx],', 'ax']
jmp ['loc_B15B']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1164h],', '0']
jz ['short', 'loc_B23C']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+10h],', '0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
mov ['[ebp+var_18C],', '0']
mov ['edx,', '[ebp+var_18C]']
mov ['[ebp+var_188],', 'edx']
mov ['[ebp+var_198],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
mov ['[ebp+var_19C],', 'ecx']
mov ['edx,', '[ebp+var_198]']
push ['edx']
mov ['eax,', '[ebp+var_19C]']
push ['eax']
mov ['ecx,', '[ebp+var_188]']
push ['ecx']
mov ['edx,', '[ebp+var_18C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_check_selection']
add ['esp,', '14h']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_B2C0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+230h]']
shl ['edx,', '8']
add ['edx,', '[ebp+C]']
mov ['[ebp+var_35C],', 'edx']
cmp ['[ebp+var_35C],', '2333h']
jz ['short', 'loc_B2FB']
cmp ['[ebp+var_35C],', '2334h']
jz ['short', 'loc_B307']
cmp ['[ebp+var_35C],', '2335h']
jz ['short', 'loc_B313']
jmp ['short', 'loc_B31F']
mov ['[ebp+var_1A4],', '2']
jmp ['short', 'loc_B329']
mov ['[ebp+var_1A4],', '3']
jmp ['short', 'loc_B329']
mov ['[ebp+var_1A4],', '0']
jmp ['short', 'loc_B329']
mov ['[ebp+var_1A4],', '1']
push ['1']
push ['0D65h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_1A8],', 'eax']
mov ['eax,', '[ebp+var_1A8]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_line_size']
add ['esp,', '8']
mov ['edx,', '[ebp+var_1A8]']
mov ['ax,', 'word', 'ptr', '[ebp+var_1A4]']
mov ['[edx],', 'ax']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_B38D']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1148h],', '0']
jnz ['short', 'loc_B3A6']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+170h],', '0DB00h']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '2']
jnz ['short', 'loc_B3C7']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1148h],', '0']
jnz ['short', 'loc_B3E0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+170h],', '0D800h']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_B401']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1148h],', '0']
jnz ['short', 'loc_B41A']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+170h],', '0D900h']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '4000h']
jnz ['short', 'loc_B43E']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1148h],', '0']
jnz ['short', 'loc_B457']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+170h],', '0DA00h']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '2']
jnz ['short', 'loc_B478']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1148h],', '0']
jnz ['short', 'loc_B491']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+174h],', '0DB00h']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_B4B2']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN425']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1148h],', '0']
jnz ['short', 'loc_B4CB']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+174h],', '0D800h']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_B4EC']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN425']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1148h],', '0']
jnz ['short', 'loc_B505']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+174h],', '0D900h']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '4000h']
jnz ['short', 'loc_B529']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN425']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1148h],', '0']
jnz ['short', 'loc_B542']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+174h],', '0DA00h']
jmp ['short', '$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4000h']
jnz ['short', 'loc_B55F']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['short', '$LN425']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1148h],', '0']
jnz ['short', 'loc_B578']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0DCh],', '1']
jmp ['short', '$LN425']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '4000h']
jnz ['short', 'loc_B596']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['short', '$LN425']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1148h],', '0']
jnz ['short', '$LN425']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0DCh],', '0']
jmp ['$LN526']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
mov ['ecx,', '[ebp+C]']
push ['ecx']
call ['_isdigit']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_B64C']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+22Ch],', '20h']
jg ['short', 'loc_B63A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+22Ch]']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+ecx*4+1A8h],', '0']
jnz ['short', 'loc_B60A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+22Ch]']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+ecx*4+1A8h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+22Ch]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+ecx*4+1A8h]']
imul ['eax,', '0Ah']
mov ['ecx,', '[ebp+C]']
lea ['edx,', '[eax+ecx-30h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+22Ch]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+ecx*4+1A8h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '2']
jmp ['$LN336']
cmp ['[ebp+C],', '3Bh']
jnz ['short', 'loc_B69C']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+22Ch],', '20h']
jge ['short', 'loc_B68A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+22Ch]']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+ecx*4+1ACh],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+22Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+22Ch],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '2']
jmp ['$LN336']
cmp ['[ebp+C],', '40h']
jnb ['short', 'loc_B6F0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+230h],', '0']
jz ['short', 'loc_B6BD']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+230h],', '0FFFFFFFFh']
jmp ['short', 'loc_B6DE']
cmp ['[ebp+C],', '3Fh']
jnz ['short', 'loc_B6D2']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+230h],', '1']
jmp ['short', 'loc_B6DE']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+C]']
mov ['[ecx+230h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '2']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+230h]']
shl ['edx,', '8']
add ['edx,', '[ebp+C]']
mov ['[ebp+var_360],', 'edx']
cmp ['[ebp+var_360],', '168h']
ja ['short', 'loc_B751']
cmp ['[ebp+var_360],', '168h']
jz ['$LN278']
mov ['eax,', '[ebp+var_360]']
sub ['eax,', '40h']
mov ['[ebp+var_360],', 'eax']
cmp ['[ebp+var_360],', '38h']
ja ['$LN336']
mov ['ecx,', '[ebp+var_360]']
movzx ['edx,', 'ds:$LN707[ecx]']
jmp ['ds:$LN734[edx*4]']
cmp ['[ebp+var_360],', '3D43h']
ja ['short', 'loc_B7D3']
cmp ['[ebp+var_360],', '3D43h']
jz ['loc_D70C']
cmp ['[ebp+var_360],', '2270h']
ja ['short', 'loc_B7AE']
cmp ['[ebp+var_360],', '2270h']
jz ['loc_D9E1']
cmp ['[ebp+var_360],', '169h']
jz ['$LN273']
cmp ['[ebp+var_360],', '16Ch']
jz ['$LN267']
jmp ['$LN336']
cmp ['[ebp+var_360],', '247Ch']
jz ['loc_D2A8']
cmp ['[ebp+var_360],', '2A7Ch']
jz ['loc_D208']
jmp ['$LN336']
cmp ['[ebp+var_360],', '3D4Ch']
ja ['short', 'loc_B81A']
cmp ['[ebp+var_360],', '3D4Ch']
jz ['loc_D99A']
mov ['eax,', '[ebp+var_360]']
sub ['eax,', '3D44h']
mov ['[ebp+var_360],', 'eax']
cmp ['[ebp+var_360],', '3']
ja ['$LN336']
mov ['ecx,', '[ebp+var_360]']
jmp ['ds:$LN735[ecx*4]']
cmp ['[ebp+var_360],', '3D63h']
jz ['loc_D678']
cmp ['[ebp+var_360],', '3E63h']
jz ['loc_B911']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_B857']
mov ['[ebp+var_364],', '1']
jmp ['short', 'loc_B866']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_364],', 'ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
sub ['eax,', '[ebp+var_364]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_move']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2000h']
jnz ['short', '$LN321']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_B8CF']
mov ['[ebp+var_368],', '1']
jmp ['short', 'loc_B8DE']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_368],', 'ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
add ['eax,', '[ebp+var_368]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_move']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4000h']
jnz ['short', 'loc_B92F']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1084h],', '0']
jz ['short', 'loc_B956']
push ['0']
push ['0Bh']
push ['offset', '$SG87358']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2000h']
jnz ['short', '$LN315']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_B991']
mov ['[ebp+var_36C],', '1']
jmp ['short', 'loc_B9A0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_36C],', 'ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
add ['edx,', '[ebp+var_36C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_move']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_B9EB']
mov ['[ebp+var_370],', '1']
jmp ['short', 'loc_B9FA']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_370],', 'ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
sub ['edx,', '[ebp+var_370]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_move']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2000h']
jnz ['short', 'loc_BA4B']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_BA63']
mov ['[ebp+var_374],', '1']
jmp ['short', 'loc_BA72']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_374],', 'ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
add ['eax,', '[ebp+var_374]']
push ['eax']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_move']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '2000h']
jnz ['short', 'loc_BABF']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '0']
jnz ['short', 'loc_BAD7']
mov ['[ebp+var_378],', '1']
jmp ['short', 'loc_BAE6']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1ACh]']
mov ['[ebp+var_378],', 'edx']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
sub ['ecx,', '[ebp+var_378]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_move']
add ['esp,', '10h']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2000h']
jnz ['short', 'loc_BB33']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '0']
jnz ['short', 'loc_BB4B']
mov ['[ebp+var_37C],', '1']
jmp ['short', 'loc_BB5A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
mov ['[ebp+var_37C],', 'eax']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+var_37C]']
sub ['eax,', '1']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_move']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '2000h']
jnz ['short', 'loc_BBA9']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+84h],', '0']
jz ['short', 'loc_BBC3']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+7Ch]']
mov ['[ebp+var_380],', 'edx']
jmp ['short', 'loc_BBCD']
mov ['[ebp+var_380],', '0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '0']
jnz ['short', 'loc_BBE5']
mov ['[ebp+var_384],', '1']
jmp ['short', 'loc_BBF4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1ACh]']
mov ['[ebp+var_384],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+84h]']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '2']
push ['ecx']
mov ['edx,', '[ebp+var_384]']
mov ['eax,', '[ebp+var_380]']
lea ['ecx,', '[eax+edx-1]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_move']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+22Ch],', '2']
jge ['short', 'loc_BC53']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1B0h],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+84h],', '0']
jz ['short', 'loc_BC6D']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+7Ch]']
mov ['[ebp+var_388],', 'ecx']
jmp ['short', 'loc_BC77']
mov ['[ebp+var_388],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_BC8F']
mov ['[ebp+var_38C],', '1']
jmp ['short', 'loc_BC9E']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_38C],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1B0h],', '0']
jnz ['short', 'loc_BCB6']
mov ['[ebp+var_390],', '1']
jmp ['short', 'loc_BCC5']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1B0h]']
mov ['[ebp+var_390],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+84h]']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '2']
push ['eax']
mov ['ecx,', '[ebp+var_38C]']
mov ['edx,', '[ebp+var_388]']
lea ['eax,', '[edx+ecx-1]']
push ['eax']
mov ['ecx,', '[ebp+var_390]']
sub ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_move']
add ['esp,', '10h']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '0']
jnz ['short', 'loc_BD26']
mov ['[ebp+var_394],', '0']
jmp ['short', 'loc_BD35']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
mov ['[ebp+var_394],', 'eax']
mov ['ecx,', '[ebp+var_394]']
mov ['[ebp+var_1AC],', 'ecx']
cmp ['[ebp+var_1AC],', '3']
jnz ['short', 'loc_BD58']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_clrsb']
add ['esp,', '4']
jmp ['short', 'loc_BDA8']
mov ['eax,', '[ebp+var_1AC]']
add ['eax,', '1']
mov ['[ebp+var_1AC],', 'eax']
cmp ['[ebp+var_1AC],', '3']
jbe ['short', 'loc_BD7A']
mov ['[ebp+var_1AC],', '0']
mov ['ecx,', '[ebp+var_1AC]']
and ['ecx,', '1']
neg ['ecx']
sbb ['ecx,', 'ecx']
neg ['ecx']
push ['ecx']
mov ['edx,', '[ebp+var_1AC]']
and ['edx,', '2']
neg ['edx']
sbb ['edx,', 'edx']
neg ['edx']
push ['edx']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_erase_lots']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1164h],', '0']
jz ['short', 'loc_BDBE']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '0']
jnz ['short', 'loc_BDE7']
mov ['[ebp+var_398],', '0']
jmp ['short', 'loc_BDF6']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
mov ['[ebp+var_398],', 'eax']
mov ['ecx,', '[ebp+var_398]']
add ['ecx,', '1']
mov ['[ebp+var_1B0],', 'ecx']
cmp ['[ebp+var_1B0],', '3']
jbe ['short', 'loc_BE18']
mov ['[ebp+var_1B0],', '0']
mov ['edx,', '[ebp+var_1B0]']
and ['edx,', '1']
neg ['edx']
sbb ['edx,', 'edx']
neg ['edx']
push ['edx']
mov ['eax,', '[ebp+var_1B0]']
and ['eax,', '2']
neg ['eax']
sbb ['eax,', 'eax']
neg ['eax']
push ['eax']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_erase_lots']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '8']
jnz ['short', 'loc_BE73']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+6Ch]']
cmp ['edx,', '[ecx+80h]']
jg ['short', 'loc_BED3']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '0']
jnz ['short', 'loc_BE9C']
mov ['[ebp+var_39C],', '1']
jmp ['short', 'loc_BEAB']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1ACh]']
mov ['[ebp+var_39C],', 'edx']
push ['0']
mov ['eax,', '[ebp+var_39C]']
neg ['eax']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+80h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_scroll']
add ['esp,', '14h']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '8']
jnz ['short', 'loc_BF00']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+6Ch]']
cmp ['eax,', '[edx+80h]']
jg ['short', 'loc_BF5E']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '0']
jnz ['short', 'loc_BF29']
mov ['[ebp+var_3A0],', '1']
jmp ['short', 'loc_BF38']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
mov ['[ebp+var_3A0],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_3A0]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+80h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_scroll']
add ['esp,', '14h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '8']
jnz ['short', 'loc_BF8B']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_BFA3']
mov ['[ebp+var_3A4],', '1']
jmp ['short', 'loc_BFB2']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_3A4],', 'ecx']
mov ['edx,', '[ebp+var_3A4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_insch']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '8']
jnz ['short', 'loc_BFF2']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_C00A']
mov ['[ebp+var_3A8],', '1']
jmp ['short', 'loc_C019']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_3A8],', 'ecx']
mov ['edx,', '[ebp+var_3A8]']
neg ['edx']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_insch']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_C05B']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1084h],', '0']
jz ['short', 'loc_C097']
push ['0']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '0A40h']
push ['eax']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '0A40h']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1084h]']
push ['eax']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['loc_C134']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '6']
jnz ['short', 'loc_C10D']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
add ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
add ['eax,', '1']
push ['eax']
push ['offset', '$SG87399']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_sprintf']
add ['esp,', '10h']
push ['0']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
push ['eax']
lea ['eax,', '[ebp+Dest]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1084h]']
push ['edx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['short', 'loc_C134']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '5']
jnz ['short', 'loc_C134']
push ['0']
push ['4']
push ['offset', '$SG87402']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1084h]']
push ['edx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '2']
jnz ['short', 'loc_C155']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['[ebp+var_1DC],', '0']
jmp ['short', 'loc_C170']
mov ['eax,', '[ebp+var_1DC]']
add ['eax,', '1']
mov ['[ebp+var_1DC],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_1DC]']
cmp ['edx,', '[ecx+22Ch]']
jge ['short', 'loc_C1AC']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+230h]']
push ['ecx']
mov ['edx,', '[ebp+var_1DC]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+edx*4+1ACh]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_toggle_mode']
add ['esp,', '10h']
jmp ['short', 'loc_C161']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '2']
jnz ['short', 'loc_C1CD']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+22Ch],', '1']
jz ['short', 'loc_C1DE']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '5']
jnz ['short', 'loc_C258']
push ['7Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1094h]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
mov ['[ebp+var_1E0],', 'eax']
mov ['ecx,', '[ebp+var_1E0]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['short', 'loc_C258']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0ECh],', '1']
mov ['ecx,', '[ebp+arg_0]']
xor ['edx,', 'edx']
cmp ['dword', 'ptr', '[ecx+230h],', '0']
setz ['dl']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+0F0h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0F4h],', '0']
mov ['edx,', '[ebp+var_1E0]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_print_setup']
add ['esp,', '8']
jmp ['short', 'loc_C27C']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '4']
jnz ['short', 'loc_C27C']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0ECh],', '0']
jz ['short', 'loc_C27C']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_print_finish']
add ['esp,', '4']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_C29D']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN336']
mov ['[ebp+var_1E4],', '0']
jmp ['short', 'loc_C2B8']
mov ['ecx,', '[ebp+var_1E4]']
add ['ecx,', '1']
mov ['[ebp+var_1E4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_1E4]']
cmp ['eax,', '[edx+22Ch]']
jge ['short', 'loc_C2F4']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+230h]']
push ['edx']
mov ['eax,', '[ebp+var_1E4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+eax*4+1ACh]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_toggle_mode']
add ['esp,', '10h']
jmp ['short', 'loc_C2A9']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_C315']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+22Ch],', '1']
jnz ['short', 'loc_C38F']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_C342']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E40h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
mov ['byte', 'ptr', '[ecx+eax],', '0']
jmp ['short', 'loc_C38F']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '3']
jnz ['short', 'loc_C38F']
mov ['[ebp+var_1E8],', '0']
jmp ['short', 'loc_C369']
mov ['edx,', '[ebp+var_1E8]']
add ['edx,', '1']
mov ['[ebp+var_1E8],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_1E8]']
cmp ['ecx,', '[eax+12Ch]']
jge ['short', 'loc_C38F']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E40h]']
mov ['ecx,', '[ebp+var_1E8]']
mov ['byte', 'ptr', '[eax+ecx],', '0']
jmp ['short', 'loc_C35A']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '2']
jnz ['short', 'loc_C3B0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+22Ch],', '2']
jg ['loc_C4FA']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '0']
jnz ['short', 'loc_C3D8']
mov ['[ebp+var_3AC],', '1']
jmp ['short', 'loc_C3E7']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1ACh]']
mov ['[ebp+var_3AC],', 'edx']
mov ['eax,', '[ebp+var_3AC]']
sub ['eax,', '1']
mov ['[ebp+var_1EC],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+22Ch],', '1']
jle ['short', 'loc_C448']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1B0h],', '0']
jz ['short', 'loc_C448']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1B0h],', '0']
jnz ['short', 'loc_C42B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
mov ['[ebp+var_3B0],', 'edx']
jmp ['short', 'loc_C43A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1B0h]']
mov ['[ebp+var_3B0],', 'ecx']
mov ['edx,', '[ebp+var_3B0]']
mov ['[ebp+var_3B4],', 'edx']
jmp ['short', 'loc_C457']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
mov ['[ebp+var_3B4],', 'ecx']
mov ['edx,', '[ebp+var_3B4]']
sub ['edx,', '1']
mov ['[ebp+var_1F0],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_1F0]']
cmp ['ecx,', '[eax+128h]']
jl ['short', 'loc_C489']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
sub ['eax,', '1']
mov ['[ebp+var_1F0],', 'eax']
mov ['ecx,', '[ebp+var_1F0]']
sub ['ecx,', '[ebp+var_1EC]']
test ['ecx,', 'ecx']
jle ['short', 'loc_C4FA']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_1EC]']
mov ['[edx+7Ch],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_1F0]']
mov ['[ecx+80h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+70h],', '0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+84h],', '0']
jz ['short', 'loc_C4D8']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+7Ch]']
mov ['[ebp+var_3B8],', 'eax']
jmp ['short', 'loc_C4E2']
mov ['[ebp+var_3B8],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_3B8]']
mov ['[ecx+6Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['[ebp+var_1F4],', '0']
jmp ['short', 'loc_C51A']
mov ['ecx,', '[ebp+var_1F4]']
add ['ecx,', '1']
mov ['[ebp+var_1F4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_1F4]']
cmp ['eax,', '[edx+22Ch]']
jge ['loc_CA5F']
mov ['ecx,', '[ebp+var_1F4]']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+ecx*4+1ACh],', '0']
jnz ['short', 'loc_C54E']
mov ['[ebp+var_3BC],', '0']
jmp ['short', 'loc_C564']
mov ['eax,', '[ebp+var_1F4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+eax*4+1ACh]']
mov ['[ebp+var_3BC],', 'edx']
mov ['eax,', '[ebp+var_3BC]']
mov ['[ebp+var_3C0],', 'eax']
cmp ['[ebp+var_3C0],', '6Bh']
ja ['$LN243']
mov ['ecx,', '[ebp+var_3C0]']
movzx ['edx,', 'ds:$LN708[ecx]']
jmp ['ds:$LN736[edx*4]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+3Ch]']
mov ['[eax+40h],', 'edx']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '4']
jnz ['short', 'loc_C5BE']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
or ['ecx,', '40000h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '4000h']
jnz ['short', '$LN237']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '4']
jnz ['short', 'loc_C610']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
or ['ecx,', '80000h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '4']
jnz ['short', 'loc_C643']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
or ['ecx,', '200000h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '1000h']
jnz ['short', 'loc_C679']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0C4h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+40h]']
or ['edx,', '200000h']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_schedule_tblink']
add ['esp,', '4']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
or ['eax,', '100000h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '1000h']
jnz ['short', 'loc_C6DD']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1148h],', '0']
jz ['short', 'loc_C6EE']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D0h],', '0']
jmp ['$LN243']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '1000h']
jnz ['short', 'loc_C71F']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN243']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1148h],', '0']
jz ['short', 'loc_C730']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0D0h],', '1']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '1000h']
jnz ['short', 'loc_C761']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1148h],', '0']
jz ['short', 'loc_C772']
jmp ['$LN243']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D0h],', '2']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4010h']
jnz ['short', 'loc_C7A2']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFFBFFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4010h']
jnz ['short', 'loc_C7D6']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFF7FFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4010h']
jnz ['short', 'loc_C80A']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFDFFFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4010h']
jnz ['short', 'loc_C83E']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFEFFFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFFFFE00h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
mov ['edx,', '[ebp+var_1F4]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+edx*4+1ACh]']
sub ['ecx,', '1Eh']
mov ['edx,', '[ebp+arg_0]']
or ['ecx,', '[edx+40h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'ecx']
jmp ['$LN243']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+40h]']
and ['edx,', '0FFFFFE00h']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'edx']
mov ['ecx,', '[ebp+var_1F4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+ecx*4+1ACh]']
sub ['eax,', '52h']
mov ['ecx,', '[ebp+arg_0]']
or ['eax,', '[ecx+40h]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'eax']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
and ['ecx,', '0FFFFFE00h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
or ['ecx,', '100h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
jmp ['$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
and ['ecx,', '0FFFC01FFh']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
mov ['eax,', '[ebp+var_1F4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+eax*4+1ACh]']
sub ['edx,', '28h']
shl ['edx,', '9']
mov ['eax,', '[ebp+arg_0]']
or ['edx,', '[eax+40h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'edx']
jmp ['$LN243']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFFC01FFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
mov ['edx,', '[ebp+var_1F4]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+edx*4+1ACh]']
sub ['ecx,', '5Ch']
shl ['ecx,', '9']
mov ['edx,', '[ebp+arg_0]']
or ['ecx,', '[edx+40h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'ecx']
jmp ['$LN243']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+40h]']
and ['edx,', '0FFFC01FFh']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+40h]']
or ['edx,', '20400h']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'edx']
jmp ['$LN243']
mov ['ecx,', '[ebp+var_1F4]']
add ['ecx,', '2']
mov ['edx,', '[ebp+arg_0]']
cmp ['ecx,', '[edx+22Ch]']
jge ['short', 'loc_C9EB']
mov ['eax,', '[ebp+var_1F4]']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+eax*4+1B0h],', '5']
jnz ['short', 'loc_C9EB']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFFFFE00h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
mov ['edx,', '[ebp+var_1F4]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+edx*4+1B4h]']
and ['ecx,', '0FFh']
mov ['edx,', '[ebp+arg_0]']
or ['ecx,', '[edx+40h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'ecx']
mov ['ecx,', '[ebp+var_1F4]']
add ['ecx,', '2']
mov ['[ebp+var_1F4],', 'ecx']
jmp ['short', '$LN243']
mov ['edx,', '[ebp+var_1F4]']
add ['edx,', '2']
mov ['eax,', '[ebp+arg_0]']
cmp ['edx,', '[eax+22Ch]']
jge ['short', '$LN243']
mov ['ecx,', '[ebp+var_1F4]']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+ecx*4+1B0h],', '5']
jnz ['short', '$LN243']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
and ['ecx,', '0FFFC01FFh']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
mov ['eax,', '[ebp+var_1F4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+eax*4+1B4h]']
and ['edx,', '0FFh']
shl ['edx,', '9']
mov ['eax,', '[ebp+arg_0]']
or ['edx,', '[eax+40h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'edx']
mov ['edx,', '[ebp+var_1F4]']
add ['edx,', '2']
mov ['[ebp+var_1F4],', 'edx']
jmp ['loc_C50B']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_set_erase_char']
add ['esp,', '4']
jmp ['$LN336']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_save_cursor']
add ['esp,', '8']
jmp ['$LN336']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_save_cursor']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+22Ch],', '1']
jg ['loc_CB54']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '1']
jl ['short', 'loc_CACE']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '18h']
jl ['loc_CB54']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '100h']
jnz ['short', 'loc_CAED']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+114Ch],', '0']
jnz ['short', 'loc_CB43']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_CB11']
mov ['[ebp+var_3C4],', '18h']
jmp ['short', 'loc_CB20']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_3C4],', 'ecx']
mov ['edx,', '[ebp+var_3C4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_request_resize']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_deselect']
add ['esp,', '4']
jmp ['$LN196']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+22Ch],', '1']
jl ['$LN196']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '1']
jl ['$LN196']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '18h']
jge ['$LN196']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4000h']
jnz ['short', 'loc_CBA2']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
mov ['[ebp+var_3C8],', 'eax']
mov ['ecx,', '[ebp+var_3C8]']
sub ['ecx,', '1']
mov ['[ebp+var_3C8],', 'ecx']
cmp ['[ebp+var_3C8],', '14h']
ja ['$LN196']
mov ['edx,', '[ebp+var_3C8]']
jmp ['ds:$LN737[edx*4]']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1088h]']
push ['ecx']
call ['_set_iconic']
add ['esp,', '8']
jmp ['$LN196']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_set_iconic']
add ['esp,', '8']
jmp ['$LN196']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+22Ch],', '3']
jl ['short', 'loc_CC92']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+114Ch],', '0']
jnz ['short', 'loc_CC92']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1B4h],', '0']
jnz ['short', 'loc_CC3C']
mov ['[ebp+var_3CC],', '0']
jmp ['short', 'loc_CC4B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1B4h]']
mov ['[ebp+var_3CC],', 'edx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1B0h],', '0']
jnz ['short', 'loc_CC63']
mov ['[ebp+var_3D0],', '0']
jmp ['short', 'loc_CC72']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1B0h]']
mov ['[ebp+var_3D0],', 'edx']
mov ['eax,', '[ebp+var_3CC]']
push ['eax']
mov ['ecx,', '[ebp+var_3D0]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_move_window']
add ['esp,', '0Ch']
jmp ['$LN196']
jmp ['$LN196']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1088h]']
push ['edx']
call ['_set_zorder']
add ['esp,', '8']
jmp ['$LN196']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1088h]']
push ['ecx']
call ['_set_zorder']
add ['esp,', '8']
jmp ['$LN196']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_refresh_window']
add ['esp,', '4']
jmp ['$LN196']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+22Ch],', '3']
jl ['loc_CD79']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+114Ch],', '0']
jnz ['short', 'loc_CD79']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1B0h],', '0']
jnz ['short', 'loc_CD1E']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+110Ch]']
mov ['[ebp+var_3D4],', 'edx']
jmp ['short', 'loc_CD2D']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1B0h]']
mov ['[ebp+var_3D4],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1B4h],', '0']
jnz ['short', 'loc_CD4A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1110h]']
mov ['[ebp+var_3D8],', 'ecx']
jmp ['short', 'loc_CD59']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1B4h]']
mov ['[ebp+var_3D8],', 'eax']
mov ['ecx,', '[ebp+var_3D4]']
push ['ecx']
mov ['edx,', '[ebp+var_3D8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1088h]']
push ['ecx']
call ['_request_resize']
add ['esp,', '0Ch']
jmp ['$LN196']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+22Ch],', '2']
jl ['short', 'loc_CDAC']
mov ['eax,', '[ebp+arg_0]']
xor ['ecx,', 'ecx']
cmp ['dword', 'ptr', '[eax+1B0h],', '0']
setnz ['cl']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_set_zoomed']
add ['esp,', '8']
jmp ['$LN196']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['short', 'loc_CE06']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_is_iconic']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_CDDF']
mov ['[ebp+var_3DC],', 'offset', '$SG87522']
jmp ['short', 'loc_CDE9']
mov ['[ebp+var_3DC],', 'offset', '$SG87523']
push ['0']
push ['4']
mov ['ecx,', '[ebp+var_3DC]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1084h]']
push ['eax']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN196']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['short', 'loc_CE81']
lea ['edx,', '[ebp+var_208]']
push ['edx']
lea ['eax,', '[ebp+var_1FC]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1088h]']
push ['edx']
call ['_get_window_pos']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_208]']
push ['eax']
mov ['ecx,', '[ebp+var_1FC]']
push ['ecx']
push ['offset', '$SG87526']
lea ['edx,', '[ebp+var_264]']
push ['edx']
call ['_sprintf']
add ['esp,', '10h']
mov ['[ebp+var_210],', 'eax']
push ['0']
mov ['eax,', '[ebp+var_210]']
push ['eax']
lea ['ecx,', '[ebp+var_264]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1084h]']
push ['eax']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN196']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['short', 'loc_CEFC']
lea ['edx,', '[ebp+var_208]']
push ['edx']
lea ['eax,', '[ebp+var_1FC]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1088h]']
push ['edx']
call ['_get_window_pixels']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_1FC]']
push ['eax']
mov ['ecx,', '[ebp+var_208]']
push ['ecx']
push ['offset', '$SG87529']
lea ['edx,', '[ebp+var_264]']
push ['edx']
call ['_sprintf']
add ['esp,', '10h']
mov ['[ebp+var_210],', 'eax']
push ['0']
mov ['eax,', '[ebp+var_210]']
push ['eax']
lea ['ecx,', '[ebp+var_264]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1084h]']
push ['eax']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN196']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['short', 'loc_CF5D']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
push ['edx']
push ['offset', '$SG87532']
lea ['eax,', '[ebp+var_264]']
push ['eax']
call ['_sprintf']
add ['esp,', '10h']
mov ['[ebp+var_210],', 'eax']
push ['0']
mov ['ecx,', '[ebp+var_210]']
push ['ecx']
lea ['edx,', '[ebp+var_264]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN196']
jmp ['$LN196']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1084h],', '0']
jz ['loc_D028']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+115Ch],', '0']
jz ['loc_D028']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+115Ch],', '2']
jnz ['short', 'loc_CFAF']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_get_window_title']
add ['esp,', '8']
mov ['[ebp+Str],', 'eax']
jmp ['short', 'loc_CFBB']
mov ['ecx,', '_EMPTY_WINDOW_TITLE']
mov ['[ebp+Str],', 'ecx']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_210],', 'eax']
push ['0']
push ['3']
push ['offset', '$SG87538']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
push ['0']
mov ['edx,', '[ebp+var_210]']
push ['edx']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1084h]']
push ['edx']
call ['_ldisc_send']
add ['esp,', '10h']
push ['0']
push ['2']
push ['offset', '$SG87539']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN196']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1084h],', '0']
jz ['$LN196']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+115Ch],', '0']
jz ['$LN196']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+115Ch],', '2']
jnz ['short', 'loc_D075']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_get_window_title']
add ['esp,', '8']
mov ['[ebp+Str],', 'eax']
jmp ['short', 'loc_D081']
mov ['ecx,', '_EMPTY_WINDOW_TITLE']
mov ['[ebp+Str],', 'ecx']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_210],', 'eax']
push ['0']
push ['3']
push ['offset', '$SG87544']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
push ['0']
mov ['edx,', '[ebp+var_210]']
push ['edx']
mov ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1084h]']
push ['edx']
call ['_ldisc_send']
add ['esp,', '10h']
push ['0']
push ['2']
push ['offset', '$SG87545']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '1000h']
jnz ['short', 'loc_D111']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_D129']
mov ['[ebp+var_3E0],', '1']
jmp ['short', 'loc_D138']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_3E0],', 'ecx']
push ['1']
mov ['edx,', '[ebp+var_3E0]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+80h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+7Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_scroll']
add ['esp,', '14h']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+8Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '1000h']
jnz ['short', 'loc_D19B']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '0']
jnz ['short', 'loc_D1B3']
mov ['[ebp+var_3E4],', '1']
jmp ['short', 'loc_D1C2']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
mov ['[ebp+var_3E4],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_3E4]']
neg ['ecx']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+80h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+7Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_scroll']
add ['esp,', '14h']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+8Ch],', '0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '40h']
jnz ['short', 'loc_D224']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+22Ch],', '1']
jnz ['short', 'loc_D2A3']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '0']
jle ['short', 'loc_D2A3']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+114Ch],', '0']
jnz ['short', 'loc_D297']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '0']
jnz ['short', 'loc_D265']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+110Ch]']
mov ['[ebp+var_3E8],', 'edx']
jmp ['short', 'loc_D274']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_3E8],', 'ecx']
mov ['edx,', '[ebp+var_3E8]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_request_resize']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_deselect']
add ['esp,', '4']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '100h']
jnz ['short', 'loc_D2C6']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+22Ch],', '1']
jg ['short', 'loc_D339']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+114Ch],', '0']
jnz ['short', 'loc_D32D']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '0']
jnz ['short', 'loc_D2FB']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1110h]']
mov ['[ebp+var_3EC],', 'eax']
jmp ['short', 'loc_D30A']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1ACh]']
mov ['[ebp+var_3EC],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
push ['ecx']
mov ['edx,', '[ebp+var_3EC]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1088h]']
push ['ecx']
call ['_request_resize']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_deselect']
add ['esp,', '4']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '1']
jnz ['short', 'loc_D35A']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '0']
jnz ['short', 'loc_D372']
mov ['[ebp+var_3F0],', '1']
jmp ['short', 'loc_D381']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1ACh]']
mov ['[ebp+var_3F0],', 'edx']
mov ['eax,', '[ebp+var_3F0]']
mov ['[ebp+var_270],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
mov ['[ebp+var_284],', 'edx']
push ['1']
push ['1014h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_288],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+12Ch]']
sub ['edx,', '[ecx+70h]']
cmp ['[ebp+var_270],', 'edx']
jle ['short', 'loc_D3E5']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+12Ch]']
sub ['edx,', '[ecx+70h]']
mov ['[ebp+var_270],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
mov ['edx,', '[eax+70h]']
mov ['[ebp+var_27C],', 'ecx']
mov ['[ebp+var_278],', 'edx']
mov ['eax,', '[ebp+var_278]']
add ['eax,', '[ebp+var_270]']
mov ['[ebp+var_278],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
add ['eax,', '[ebp+var_270]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_boundary']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_278]']
push ['edx']
mov ['eax,', '[ebp+var_27C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ecx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_selection']
add ['esp,', '14h']
mov ['edx,', '[ebp+var_270]']
mov ['[ebp+var_3F4],', 'edx']
mov ['eax,', '[ebp+var_270]']
sub ['eax,', '1']
mov ['[ebp+var_270],', 'eax']
cmp ['[ebp+var_3F4],', '0']
jz ['short', 'loc_D4C9']
mov ['ecx,', '[ebp+var_284]']
mov ['[ebp+var_3F8],', 'ecx']
mov ['edx,', '[ebp+var_284]']
add ['edx,', '1']
mov ['[ebp+var_284],', 'edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '54h']
push ['eax']
mov ['ecx,', '[ebp+var_3F8]']
push ['ecx']
mov ['edx,', '[ebp+var_288]']
push ['edx']
call ['_copy_termchar']
add ['esp,', '0Ch']
jmp ['short', 'loc_D46B']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '2']
jnz ['short', 'loc_D4F6']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['loc_D58F']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_D51E']
mov ['[ebp+var_3FC],', '0']
jmp ['short', 'loc_D52D']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_3FC],', 'ecx']
mov ['edx,', '[ebp+var_3FC]']
mov ['[ebp+var_2B4],', 'edx']
cmp ['[ebp+var_2B4],', '0']
jz ['short', 'loc_D54B']
cmp ['[ebp+var_2B4],', '1']
jnz ['short', 'loc_D58F']
push ['offset', '$SG87575']
lea ['eax,', '[ebp+var_2AC]']
push ['eax']
call ['_strcpy']
add ['esp,', '8']
movsx ['ecx,', '[ebp+var_2AA]']
add ['ecx,', '[ebp+var_2B4]']
mov ['[ebp+var_2AA],', 'cl']
push ['0']
push ['14h']
lea ['edx,', '[ebp+var_2AC]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1084h]']
push ['ecx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4000h']
jnz ['short', 'loc_D5B2']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
jnz ['short', 'loc_D5CA']
mov ['[ebp+var_400],', '1']
jmp ['short', 'loc_D5D9']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_400],', 'ecx']
mov ['edx,', '[ebp+var_400]']
mov ['[ebp+var_2B8],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
mov ['edx,', '[eax+70h]']
mov ['[ebp+var_2C4],', 'ecx']
mov ['[ebp+var_2C0],', 'edx']
jmp ['short', 'loc_D60B']
mov ['eax,', '[ebp+var_2B8]']
sub ['eax,', '1']
mov ['[ebp+var_2B8],', 'eax']
cmp ['[ebp+var_2B8],', '0']
jle ['short', 'loc_D64E']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+70h],', '0']
jle ['short', 'loc_D64E']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+70h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+70h],', '0']
jle ['short', 'loc_D64C']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E40h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
movzx ['ecx,', 'byte', 'ptr', '[ecx+eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_D61D']
jmp ['short', 'loc_D5FC']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
push ['eax']
mov ['ecx,', '[edx+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_2C0]']
push ['edx']
mov ['eax,', '[ebp+var_2C4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_selection']
add ['esp,', '14h']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '1000h']
jnz ['short', 'loc_D696']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
mov ['[ebp+var_404],', 'eax']
cmp ['[ebp+var_404],', '0']
jz ['short', 'loc_D6C2']
cmp ['[ebp+var_404],', '1']
jz ['short', 'loc_D6D1']
cmp ['[ebp+var_404],', '2']
jz ['short', 'loc_D6ED']
jmp ['short', 'loc_D707']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0B0h],', '0']
jmp ['short', 'loc_D707']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+158h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0B0h],', '1']
jmp ['short', 'loc_D707']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+158h],', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0B0h],', '1']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '1000h']
jnz ['short', 'loc_D72B']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+22Ch],', '2']
jl ['short', 'loc_D767']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+1ACh]']
cmp ['eax,', '[edx+1B0h]']
jle ['short', 'loc_D75A']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0B0h],', '0']
jmp ['short', 'loc_D767']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0B0h],', '1']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '1000h']
jnz ['short', 'loc_D78B']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0C4h],', '0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_schedule_tblink']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '1']
jl ['short', 'loc_D7C4']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
or ['ecx,', '200000h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
jmp ['short', 'loc_D7D6']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
and ['ecx,', '0FFDFFFFFh']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '1000h']
jnz ['short', 'loc_D7FA']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
xor ['ecx,', 'ecx']
cmp ['dword', 'ptr', '[eax+1ACh],', '1']
setnl ['cl']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0C4h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_schedule_tblink']
add ['esp,', '4']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '1000h']
jnz ['short', 'loc_D842']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN336']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '0']
jl ['loc_D8D7']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '10h']
jge ['short', 'loc_D8D7']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
and ['ecx,', '7']
movsx ['edx,', 'ds:_sco2ansicolour[ecx]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
and ['ecx,', '8']
or ['edx,', 'ecx']
mov ['[ebp+var_2CC],', 'edx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFFFFE00h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
or ['eax,', '[ebp+var_2CC]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+3Ch]']
and ['eax,', '0FFFFFE00h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+3Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+3Ch]']
or ['eax,', '[ebp+var_2CC]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+3Ch],', 'eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_set_erase_char']
add ['esp,', '4']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '1000h']
jnz ['short', 'loc_D8FB']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '0']
jl ['loc_D995']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '10h']
jge ['short', 'loc_D995']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
and ['eax,', '7']
movsx ['ecx,', 'ds:_sco2ansicolour[eax]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
and ['eax,', '8']
or ['ecx,', 'eax']
shl ['ecx,', '9']
mov ['[ebp+var_2D0],', 'ecx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+40h]']
and ['edx,', '0FFFC01FFh']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+40h]']
or ['edx,', '[ebp+var_2D0]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+3Ch]']
and ['edx,', '0FFFC01FFh']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+3Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+3Ch]']
or ['edx,', '[ebp+var_2D0]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+3Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_set_erase_char']
add ['esp,', '4']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '1000h']
jnz ['short', 'loc_D9B8']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN336']
mov ['edx,', '[ebp+arg_0]']
xor ['eax,', 'eax']
cmp ['dword', 'ptr', '[edx+1ACh],', '0']
setle ['al']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0B8h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_set_erase_char']
add ['esp,', '4']
jmp ['$LN336']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_408],', 'ecx']
cmp ['[ebp+var_408],', '3Eh']
ja ['short', '$LN98_0']
mov ['edx,', '[ebp+var_408]']
movzx ['eax,', 'ds:$LN709[edx]']
jmp ['ds:$LN738[eax*4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '0FFFFFE00h']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
or ['edx,', '0Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax],', 'edx']
jmp ['short', '$LN101_0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '0FFFFFE00h']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
or ['edx,', '1Fh']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax],', 'edx']
jmp ['short', '$LN101_0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '3Ch']
jle ['short', 'loc_DA73']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '46h']
jge ['short', 'loc_DA73']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
or ['ecx,', '1FFh']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx],', 'ecx']
jmp ['short', '$LN101_0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '1FFh']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx],', 'ecx']
jmp ['short', '$LN101_0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax],', '0FFFFh']
jmp ['short', '$LN101_0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx],', '1001h']
jmp ['short', '$LN101_0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx],', '0FFFFh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1ACh],', '32h']
jnz ['$LN336']
push ['offset', '$SG87634']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '0A40h']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
mov ['[ebp+var_2D4],', '1']
jmp ['short', 'loc_DAE8']
mov ['edx,', '[ebp+var_2D4]']
add ['edx,', '1']
mov ['[ebp+var_2D4],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_2D4]']
cmp ['ecx,', '[eax+22Ch]']
jge ['short', 'loc_DB59']
cmp ['[ebp+var_2D4],', '1']
jz ['short', 'loc_DB19']
push ['offset', '$SG87639']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '0A40h']
push ['edx']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+var_2D4]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+eax*4+1ACh]']
push ['edx']
push ['offset', '$SG87640']
lea ['eax,', '[ebp+Source]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
lea ['ecx,', '[ebp+Source]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '0A40h']
push ['edx']
call ['_strcat']
add ['esp,', '8']
jmp ['short', 'loc_DAD9']
push ['offset', '$SG87641']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '0A40h']
push ['eax']
call ['_strcat']
add ['esp,', '8']
jmp ['$LN526']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0A3Ch],', '0']
mov ['edx,', '[ebp+C]']
mov ['[ebp+var_40C],', 'edx']
mov ['eax,', '[ebp+var_40C]']
sub ['eax,', '30h']
mov ['[ebp+var_40C],', 'eax']
cmp ['[ebp+var_40C],', '27h']
ja ['$LN77']
mov ['ecx,', '[ebp+var_40C]']
movzx ['edx,', 'ds:$LN710[ecx]']
jmp ['ds:$LN739[edx*4]']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '6']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+234h],', '0']
jmp ['loc_DC75']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_palette_reset']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_invalidate']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['short', 'loc_DC75']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0A3Ch],', '1']
jmp ['short', 'loc_DC75']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1ACh]']
imul ['eax,', '0Ah']
mov ['ecx,', '[ebp+C]']
lea ['edx,', '[eax+ecx-30h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+1ACh],', 'edx']
jmp ['short', 'loc_DC75']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1ACh],', '2']
jnz ['short', '$LN77']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+1ACh],', '1']
jmp ['short', 'loc_DC75']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '7']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+234h],', '0']
jmp ['$LN526']
cmp ['[ebp+C],', '0Ah']
jz ['short', 'loc_DC86']
cmp ['[ebp+C],', '0Dh']
jnz ['short', 'loc_DC95']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['short', 'loc_DD0E']
cmp ['[ebp+C],', '9Ch']
jz ['short', 'loc_DCA4']
cmp ['[ebp+C],', '7']
jnz ['short', 'loc_DCBF']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_do_osc']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['short', 'loc_DD0E']
cmp ['[ebp+C],', '1Bh']
jnz ['short', 'loc_DCD4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '8']
jmp ['short', 'loc_DD0E']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+234h],', '800h']
jge ['short', 'loc_DD0E']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+234h]']
mov ['eax,', '[ebp+arg_0]']
mov ['cl,', 'byte', 'ptr', '[ebp+C]']
mov ['[eax+edx+238h],', 'cl']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+234h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+234h],', 'eax']
jmp ['$LN526']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+234h]']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '0FFFFFFFAh']
add ['eax,', '15h']
mov ['[ebp+var_320],', 'eax']
cmp ['[ebp+C],', '30h']
jl ['short', 'loc_DD46']
cmp ['[ebp+C],', '39h']
jg ['short', 'loc_DD46']
mov ['ecx,', '[ebp+C]']
sub ['ecx,', '30h']
mov ['[ebp+var_324],', 'ecx']
jmp ['short', 'loc_DD9C']
cmp ['[ebp+C],', '41h']
jl ['short', 'loc_DD68']
mov ['edx,', '[ebp+var_320]']
add ['edx,', '37h']
cmp ['[ebp+C],', 'edx']
jg ['short', 'loc_DD68']
mov ['eax,', '[ebp+C]']
sub ['eax,', '37h']
mov ['[ebp+var_324],', 'eax']
jmp ['short', 'loc_DD9C']
cmp ['[ebp+C],', '61h']
jl ['short', 'loc_DD8A']
mov ['ecx,', '[ebp+var_320]']
add ['ecx,', '57h']
cmp ['[ebp+C],', 'ecx']
jg ['short', 'loc_DD8A']
mov ['edx,', '[ebp+C]']
sub ['edx,', '57h']
mov ['[ebp+var_324],', 'edx']
jmp ['short', 'loc_DD9C']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN526']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+234h]']
mov ['eax,', '[ebp+arg_0]']
mov ['cl,', 'byte', 'ptr', '[ebp+var_324]']
mov ['[eax+edx+238h],', 'cl']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+234h]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+234h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+234h],', '7']
jl ['loc_DE5E']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+23Dh]']
shl ['ecx,', '4']
mov ['edx,', '[ebp+arg_0]']
movsx ['eax,', 'byte', 'ptr', '[edx+23Eh]']
add ['ecx,', 'eax']
push ['ecx']
mov ['ecx,', '[ebp+arg_0]']
movsx ['edx,', 'byte', 'ptr', '[ecx+23Bh]']
shl ['edx,', '4']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+23Ch]']
add ['edx,', 'ecx']
push ['edx']
mov ['edx,', '[ebp+arg_0]']
movsx ['eax,', 'byte', 'ptr', '[edx+239h]']
shl ['eax,', '4']
mov ['ecx,', '[ebp+arg_0]']
movsx ['edx,', 'byte', 'ptr', '[ecx+23Ah]']
add ['eax,', 'edx']
push ['eax']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+238h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_palette_set']
add ['esp,', '14h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_invalidate']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN526']
mov ['eax,', '[ebp+C]']
mov ['[ebp+var_410],', 'eax']
cmp ['[ebp+var_410],', '30h']
jb ['short', 'loc_DE9E']
cmp ['[ebp+var_410],', '39h']
jbe ['short', 'loc_DE80']
jmp ['short', 'loc_DE9E']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1ACh]']
imul ['edx,', '0Ah']
mov ['eax,', '[ebp+C]']
lea ['ecx,', '[edx+eax-30h]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+1ACh],', 'ecx']
jmp ['short', 'loc_DEB8']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '7']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+234h],', '0']
jmp ['$LN526']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
mov ['ecx,', '[ebp+C]']
mov ['[ebp+var_414],', 'ecx']
mov ['edx,', '[ebp+var_414]']
sub ['edx,', '3Ch']
mov ['[ebp+var_414],', 'edx']
cmp ['[ebp+var_414],', '3Bh']
ja ['$LN51']
mov ['eax,', '[ebp+var_414]']
movzx ['ecx,', 'ds:$LN711[eax]']
jmp ['ds:$LN740[ecx*4]']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
sub ['eax,', '1']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_move']
add ['esp,', '10h']
jmp ['$LN51']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
add ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_move']
add ['esp,', '10h']
jmp ['$LN51']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
add ['eax,', '1']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_move']
add ['esp,', '10h']
jmp ['$LN51']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
sub ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_move']
add ['esp,', '10h']
jmp ['$LN51']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+94h],', '0']
mov ['edx,', '4']
imul ['edx,', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+edx+170h],', '0D900h']
jmp ['$LN51']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+94h],', '0']
mov ['edx,', '4']
imul ['edx,', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+edx+170h],', '0D800h']
jmp ['$LN51']
push ['0']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_move']
add ['esp,', '10h']
jmp ['$LN51']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+6Ch],', '0']
jnz ['short', 'loc_E030']
push ['1']
push ['0FFFFFFFFh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+128h]']
sub ['ecx,', '1']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_scroll']
add ['esp,', '14h']
jmp ['short', 'loc_E048']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+6Ch],', '0']
jle ['short', 'loc_E048']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+6Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+8Ch],', '0']
jmp ['$LN51']
push ['1']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_erase_lots']
add ['esp,', '10h']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1164h],', '0']
jz ['short', 'loc_E082']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+10h],', '0']
jmp ['$LN51']
push ['1']
push ['0']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_erase_lots']
add ['esp,', '10h']
jmp ['$LN51']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0Ah']
jmp ['$LN51']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['short', 'loc_E0D7']
push ['0']
push ['3']
push ['offset', '$SG87710']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1084h]']
push ['eax']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN51']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+144h],', '1']
jmp ['$LN51']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+144h],', '0']
jmp ['$LN51']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+148h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1104h]']
mov ['[ecx+0C4h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_schedule_tblink']
add ['esp,', '4']
jmp ['$LN51']
push ['0']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_move']
add ['esp,', '10h']
push ['1']
push ['0']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_erase_lots']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1164h],', '0']
jz ['short', 'loc_E16A']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10h],', '0']
jmp ['$LN51']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+6Ch]']
cmp ['edx,', '[ecx+80h]']
jg ['short', 'loc_E1A1']
push ['0']
push ['0FFFFFFFFh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+80h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_scroll']
add ['esp,', '14h']
jmp ['$LN51']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+6Ch]']
cmp ['ecx,', '[eax+80h]']
jg ['short', 'loc_E1D8']
push ['1']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+80h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_scroll']
add ['esp,', '14h']
jmp ['$LN51']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0Ch']
jmp ['$LN51']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0Dh']
jmp ['$LN51']
push ['0']
push ['1']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_erase_lots']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1164h],', '0']
jz ['short', 'loc_E229']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10h],', '0']
jmp ['$LN51']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0B0h],', '1']
jmp ['$LN51']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0B0h],', '0']
jmp ['$LN51']
push ['1']
push ['1']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_erase_lots']
add ['esp,', '10h']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+70h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+8Ch],', '0']
jmp ['$LN51']
push ['0']
push ['1']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_erase_lots']
add ['esp,', '10h']
jmp ['$LN51']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
or ['ecx,', '100000h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
jmp ['$LN51']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
and ['ecx,', '0FFEFFFFFh']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
jmp ['$LN51']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+88h],', '1']
jmp ['$LN51']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+88h],', '0']
jmp ['$LN51']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0D8h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+40h],', '20500h']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_set_erase_char']
add ['esp,', '4']
jmp ['short', '$LN51']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
or ['eax,', '80000h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
jmp ['short', '$LN51']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFF7FFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
jmp ['short', '$LN51']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0D8h],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
or ['ecx,', '40000h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
jmp ['short', '$LN51']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0D8h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+40h]']
and ['edx,', '0FFFBFFFFh']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+40h],', 'edx']
jmp ['$LN526']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0Bh']
push ['0']
mov ['edx,', '[ebp+C]']
sub ['edx,', '20h']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_move']
add ['esp,', '10h']
jmp ['$LN526']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+C]']
sub ['eax,', '20h']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_move']
add ['esp,', '10h']
jmp ['$LN526']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
and ['ecx,', '0FFFFFE00h']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+40h]']
and ['ecx,', '0FFFBFFFFh']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'ecx']
mov ['eax,', '[ebp+C]']
and ['eax,', '0Fh']
mov ['ecx,', '[ebp+arg_0]']
or ['eax,', '[ecx+40h]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+40h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_set_erase_char']
add ['esp,', '4']
jmp ['short', '$LN526']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFFC01FFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
and ['eax,', '0FFDFFFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'eax']
mov ['edx,', '[ebp+C]']
and ['edx,', '0Fh']
shl ['edx,', '9']
mov ['eax,', '[ebp+arg_0]']
or ['edx,', '[eax+40h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+40h],', 'edx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_set_erase_char']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E48h],', '0']
jz ['loc_E50F']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
mov ['eax,', '[ecx+70h]']
mov ['[ebp+var_330],', 'edx']
mov ['[ebp+var_32C],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_32C]']
cmp ['edx,', '[ecx+12Ch]']
jnz ['short', 'loc_E4D1']
mov ['[ebp+var_32C],', '0']
mov ['eax,', '[ebp+var_330]']
add ['eax,', '1']
mov ['[ebp+var_330],', 'eax']
mov ['[ebp+var_418],', '1']
jmp ['short', 'loc_E4EA']
mov ['ecx,', '[ebp+var_32C]']
add ['ecx,', '1']
mov ['[ebp+var_32C],', 'ecx']
mov ['[ebp+var_418],', '0']
mov ['edx,', '[ebp+var_32C]']
push ['edx']
mov ['eax,', '[ebp+var_330]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ecx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_check_selection']
add ['esp,', '14h']
jmp ['loc_958E']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_print_flush']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1124h],', '0']
jz ['short', 'loc_E53E']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+108Ch]']
push ['edx']
call ['_logflush']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN730']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '418h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_schedule_vbell proc near          
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_EB15']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
sub ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_EB1C']
mov ['[ebp+var_4],', '0']
cmp ['[ebp+var_4],', '64h']
jge ['short', 'loc_EB54']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+138h],', '1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '_term_timer']
mov ['edx,', '64h']
sub ['edx,', '[ebp+var_4]']
push ['edx']
call ['_schedule_timer']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+13Ch],', 'eax']
jmp ['short', 'loc_EB61']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+138h],', '0']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_move           proc near               
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_4],', '0']
jge ['short', 'loc_EB8C']
mov ['[ebp+arg_4],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax+12Ch]']
jl ['short', 'loc_EBA9']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
sub ['eax,', '1']
mov ['[ebp+arg_4],', 'eax']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_EC08']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+6Ch]']
cmp ['eax,', '[edx+7Ch]']
jge ['short', 'loc_EBC3']
cmp ['[ebp+arg_C],', '2']
jnz ['short', 'loc_EBD7']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_8]']
cmp ['edx,', '[ecx+7Ch]']
jge ['short', 'loc_EBD7']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+7Ch]']
mov ['[ebp+arg_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+6Ch]']
cmp ['ecx,', '[eax+80h]']
jle ['short', 'loc_EBEE']
cmp ['[ebp+arg_C],', '2']
jnz ['short', 'loc_EC08']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_8]']
cmp ['eax,', '[edx+80h]']
jle ['short', 'loc_EC08']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+80h]']
mov ['[ebp+arg_8],', 'edx']
cmp ['[ebp+arg_8],', '0']
jge ['short', 'loc_EC15']
mov ['[ebp+arg_8],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_8]']
cmp ['ecx,', '[eax+128h]']
jl ['short', 'loc_EC32']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
sub ['eax,', '1']
mov ['[ebp+arg_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_4]']
mov ['[ecx+70h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+6Ch],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+8Ch],', '0']
pop ['ebp']
retn
endp
_save_cursor    proc near               
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_4],', '0']
jz ['loc_ECF0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
mov ['edx,', '[eax+70h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+74h],', 'ecx']
mov ['[eax+78h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+40h]']
mov ['[ecx+44h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+94h]']
mov ['[ecx+98h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0DCh]']
mov ['[ecx+0A0h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8Ch]']
mov ['[ecx+0A4h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+94h]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+edx*4+170h]']
mov ['[eax+9Ch],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0D0h]']
mov ['[eax+0D4h],', 'edx']
jmp ['loc_EDF1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+74h]']
mov ['edx,', '[eax+78h]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+6Ch],', 'ecx']
mov ['[eax+70h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+70h]']
cmp ['eax,', '[edx+12Ch]']
jl ['short', 'loc_ED25']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+70h],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+6Ch]']
cmp ['eax,', '[edx+128h]']
jl ['short', 'loc_ED48']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+128h]']
sub ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+6Ch],', 'edx']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+44h]']
mov ['[ecx+40h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+98h]']
mov ['[ecx+94h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0A0h]']
mov ['[ecx+0DCh],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0A4h]']
mov ['[ecx+8Ch],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+8Ch],', '0']
jz ['short', 'loc_EDB7']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
cmp ['[ecx+70h],', 'eax']
jge ['short', 'loc_EDB7']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+8Ch],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+94h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+9Ch]']
mov ['[edx+ecx*4+170h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0D4h]']
mov ['[ecx+0D0h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_set_erase_char']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_insch          proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '54h']
push ['edi']
lea ['edi,', '[ebp+var_54]']
mov ['ecx,', '15h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
xor ['eax,', 'eax']
cmp ['[ebp+arg_4],', '0']
setnl ['al']
lea ['eax,', '[eax+eax-1]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_4],', '0']
jge ['short', 'loc_EE32']
mov ['ecx,', '[ebp+arg_4]']
neg ['ecx']
mov ['[ebp+var_44],', 'ecx']
jmp ['short', 'loc_EE38']
mov ['edx,', '[ebp+arg_4]']
mov ['[ebp+var_44],', 'edx']
mov ['eax,', '[ebp+var_44]']
mov ['[ebp+arg_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+12Ch]']
sub ['eax,', '[edx+70h]']
cmp ['[ebp+arg_4],', 'eax']
jle ['short', 'loc_EE64']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+12Ch]']
sub ['eax,', '[edx+70h]']
mov ['[ebp+arg_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+12Ch]']
sub ['eax,', '[edx+70h]']
sub ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
mov ['[ebp+var_18],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
mov ['[ebp+var_14],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+6Ch]']
cmp ['ecx,', '[eax+0E5Ch]']
jl ['short', 'loc_EEC9']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+6Ch]']
cmp ['ecx,', '[eax+0E5Ch]']
jnz ['loc_F07A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+70h]']
cmp ['ecx,', '[eax+0E60h]']
jge ['loc_F07A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E54h]']
cmp ['eax,', '[ebp+var_18]']
jl ['short', 'loc_EEFB']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E54h]']
cmp ['edx,', '[ebp+var_18]']
jnz ['loc_F07A']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E58h]']
cmp ['ecx,', '[ebp+var_14]']
jge ['loc_F07A']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
mov ['ecx,', '[edx+70h]']
mov ['[ebp+var_2C],', 'eax']
mov ['[ebp+var_28],', 'ecx']
mov ['edx,', '[ebp+var_18]']
mov ['[ebp+var_3C],', 'edx']
mov ['eax,', '[ebp+var_14]']
mov ['[ebp+var_38],', 'eax']
cmp ['[ebp+var_4],', '0']
jle ['short', 'loc_EF27']
mov ['ecx,', '[ebp+var_38]']
sub ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_38],', 'ecx']
jmp ['short', 'loc_EF30']
mov ['edx,', '[ebp+var_28]']
add ['edx,', '[ebp+arg_4]']
mov ['[ebp+var_28],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_2C]']
cmp ['ecx,', '[eax+0E54h]']
jl ['short', 'loc_EF62']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_2C]']
cmp ['eax,', '[edx+0E54h]']
jnz ['loc_F06E']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_28]']
cmp ['edx,', '[ecx+0E58h]']
jg ['loc_F06E']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E5Ch]']
cmp ['ecx,', '[ebp+var_3C]']
jl ['short', 'loc_EF94']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0E5Ch]']
cmp ['eax,', '[ebp+var_3C]']
jnz ['loc_F06E']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E60h]']
cmp ['edx,', '[ebp+var_38]']
jg ['loc_F06E']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_0]']
add ['eax,', '[ecx+0E58h]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E58h],', 'eax']
mov ['eax,', '[ebp+var_4]']
imul ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[ebp+arg_0]']
add ['eax,', '[ecx+0E60h]']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E60h],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+0E58h]']
cmp ['edx,', '[ecx+70h]']
jge ['short', 'loc_EFEE']
push ['9B5h']
push ['offset', '$SG86855']
push ['offset', '$SG86856']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+0E58h]']
cmp ['eax,', '[edx+12Ch]']
jl ['short', 'loc_F019']
push ['9B6h']
push ['offset', '$SG86858']
push ['offset', '$SG86859']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+0E60h]']
cmp ['ecx,', '[eax+70h]']
jg ['short', 'loc_F041']
push ['9B7h']
push ['offset', '$SG86861']
push ['offset', '$SG86862']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[eax+0E60h]']
cmp ['edx,', '[ecx+12Ch]']
jle ['short', 'loc_F06C']
push ['9B8h']
push ['offset', '$SG86864']
push ['offset', '$SG86865']
call ['__wassert']
add ['esp,', '0Ch']
jmp ['short', 'loc_F07A']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_deselect']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+6Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_check_boundary']
add ['esp,', '0Ch']
cmp ['[ebp+var_4],', '0']
jge ['short', 'loc_F0B7']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+6Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
add ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_check_boundary']
add ['esp,', '0Ch']
push ['1']
push ['9C3h']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+6Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_20],', 'eax']
cmp ['[ebp+var_4],', '0']
jge ['loc_F18A']
mov ['[ebp+var_C],', '0']
jmp ['short', 'loc_F0F0']
mov ['eax,', '[ebp+var_C]']
add ['eax,', '1']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_C]']
cmp ['ecx,', '[ebp+var_8]']
jge ['short', 'loc_F142']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_20]']
mov ['edx,', '[ecx+14h]']
add ['edx,', 'eax']
mov ['eax,', '[ebp+var_C]']
imul ['eax,', '0Ch']
add ['edx,', 'eax']
mov ['ecx,', '[ebp+arg_4]']
imul ['ecx,', '0Ch']
add ['edx,', 'ecx']
push ['edx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+70h]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_20]']
mov ['edx,', '[ecx+14h]']
add ['edx,', 'eax']
mov ['eax,', '[ebp+var_C]']
imul ['eax,', '0Ch']
add ['edx,', 'eax']
push ['edx']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
call ['_move_termchar']
add ['esp,', '0Ch']
jmp ['short', 'loc_F0E7']
mov ['edx,', '[ebp+arg_4]']
mov ['[ebp+var_48],', 'edx']
mov ['eax,', '[ebp+arg_4]']
sub ['eax,', '1']
mov ['[ebp+arg_4],', 'eax']
cmp ['[ebp+var_48],', '0']
jz ['short', 'loc_F185']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
add ['edx,', '[ebp+var_8]']
mov ['[ebp+var_4C],', 'edx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '54h']
push ['ecx']
mov ['edx,', '[ebp+var_4C]']
push ['edx']
mov ['eax,', '[ebp+var_20]']
push ['eax']
call ['_copy_termchar']
add ['esp,', '0Ch']
jmp ['short', 'loc_F142']
jmp ['loc_F223']
mov ['ecx,', '[ebp+var_8]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[ebp+var_50],', 'edx']
mov ['eax,', '[ebp+var_C]']
sub ['eax,', '1']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_50],', '0']
jz ['short', 'loc_F1EF']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_20]']
mov ['ecx,', '[eax+14h]']
add ['ecx,', 'edx']
mov ['edx,', '[ebp+var_C]']
imul ['edx,', '0Ch']
add ['ecx,', 'edx']
push ['ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+70h]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_20]']
mov ['eax,', '[edx+14h]']
add ['eax,', 'ecx']
mov ['ecx,', '[ebp+var_C]']
imul ['ecx,', '0Ch']
add ['eax,', 'ecx']
mov ['edx,', '[ebp+arg_4]']
imul ['edx,', '0Ch']
add ['eax,', 'edx']
push ['eax']
mov ['eax,', '[ebp+var_20]']
push ['eax']
call ['_move_termchar']
add ['esp,', '0Ch']
jmp ['short', 'loc_F190']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_54],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
sub ['edx,', '1']
mov ['[ebp+arg_4],', 'edx']
cmp ['[ebp+var_54],', '0']
jz ['short', 'loc_F223']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '54h']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+70h]']
add ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+var_20]']
push ['eax']
call ['_copy_termchar']
add ['esp,', '0Ch']
jmp ['short', 'loc_F1EF']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN35_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '54h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_move_termchar  proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
sub ['ecx,', '[eax+14h]']
mov ['eax,', 'ecx']
cdq
mov ['ecx,', '0Ch']
idiv ['ecx']
push ['eax']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_clear_cc']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[eax]']
mov ['[ecx],', 'edx']
mov ['edx,', '[eax+4]']
mov ['[ecx+4],', 'edx']
mov ['eax,', '[eax+8]']
mov ['[ecx+8],', 'eax']
mov ['ecx,', '[ebp+arg_8]']
cmp ['dword', 'ptr', '[ecx+8],', '0']
jz ['short', 'loc_F2EA']
mov ['eax,', '[ebp+arg_4]']
sub ['eax,', '[ebp+arg_8]']
cdq
mov ['ecx,', '0Ch']
idiv ['ecx']
mov ['edx,', '[ebp+arg_8]']
mov ['ecx,', '[edx+8]']
sub ['ecx,', 'eax']
mov ['edx,', '[ebp+arg_4]']
mov ['[edx+8],', 'ecx']
mov ['eax,', '[ebp+arg_8]']
mov ['dword', 'ptr', '[eax+8],', '0']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_toggle_mode    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['[ebp+arg_8],', '0']
jz ['loc_F87D']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '3E8h']
jg ['short', 'loc_F372']
cmp ['[ebp+var_4],', '3E8h']
jz ['loc_F689']
mov ['ecx,', '[ebp+var_4]']
sub ['ecx,', '1']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+var_4],', '2Eh']
ja ['$LN48_0']
mov ['edx,', '[ebp+var_4]']
movzx ['eax,', 'ds:$LN55[edx]']
jmp ['ds:$LN57_1[eax*4]']
cmp ['[ebp+var_4],', '417h']
jg ['short', 'loc_F3B4']
cmp ['[ebp+var_4],', '417h']
jz ['loc_F712']
cmp ['[ebp+var_4],', '3EAh']
jz ['loc_F6B6']
cmp ['[ebp+var_4],', '3EEh']
jz ['loc_F6E4']
cmp ['[ebp+var_4],', '3F7h']
jz ['loc_F6FB']
jmp ['$LN48_0']
cmp ['[ebp+var_4],', '418h']
jz ['loc_F77B']
cmp ['[ebp+var_4],', '419h']
jz ['loc_F7AE']
cmp ['[ebp+var_4],', '7D4h']
jz ['loc_F866']
jmp ['$LN48_0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_C]']
mov ['[ecx+140h],', 'edx']
jmp ['$LN48_0']
xor ['eax,', 'eax']
cmp ['[ebp+arg_C],', '0']
setz ['al']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+148h],', 'eax']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+148h],', '0']
jz ['short', 'loc_F42B']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0C4h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0D8h],', '0']
jmp ['short', 'loc_F43D']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1104h]']
mov ['[edx+0C4h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_schedule_tblink']
add ['esp,', '4']
jmp ['$LN48_0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_deselect']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+114Ch],', '0']
jnz ['short', 'loc_F490']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
push ['eax']
mov ['ecx,', '[ebp+arg_C]']
neg ['ecx']
sbb ['ecx,', 'ecx']
and ['ecx,', '34h']
add ['ecx,', '50h']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_request_resize']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_C]']
mov ['[ecx+0B4h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+7Ch],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+19Ch],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+128h]']
sub ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
mov ['[ecx+80h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_8]']
mov ['[eax+1A0h],', 'ecx']
push ['0']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_move']
add ['esp,', '10h']
push ['1']
push ['1']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_erase_lots']
add ['esp,', '10h']
jmp ['$LN48_0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+0A8h],', '0']
jz ['short', 'loc_F52F']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_F52F']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0ACh]']
push ['eax']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_schedule_vbell']
add ['esp,', '0Ch']
jmp ['short', 'loc_F559']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0A8h],', '0']
jnz ['short', 'loc_F559']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_F559']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetTickCount@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0ACh],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_C]']
mov ['[edx+0A8h],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN48_0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_C]']
mov ['[edx+84h],', 'eax']
jmp ['$LN48_0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_C]']
mov ['[ecx+88h],', 'edx']
jmp ['$LN48_0']
xor ['eax,', 'eax']
cmp ['[ebp+arg_C],', '0']
setz ['al']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+14Ch],', 'eax']
jmp ['$LN48_0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_C]']
mov ['[edx+0CCh],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1084h],', '0']
jz ['short', 'loc_F5DF']
push ['0']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1084h]']
push ['eax']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['$LN48_0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '4010h']
jnz ['short', 'loc_F603']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN48_0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_C]']
mov ['[ecx+0B0h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN48_0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
and ['edx,', '4000h']
jnz ['short', 'loc_F63F']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E44h],', '0']
jmp ['$LN48_0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_deselect']
add ['esp,', '4']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1134h]']
neg ['eax']
sbb ['eax,', 'eax']
not ['eax']
and ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_swap_screen']
add ['esp,', '10h']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1164h],', '0']
jz ['short', 'loc_F684']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+10h],', '0']
jmp ['$LN48_0']
xor ['ecx,', 'ecx']
cmp ['[ebp+arg_C],', '0']
setnz ['cl']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+15Ch],', 'ecx']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1088h]']
push ['edx']
call ['_set_raw_mouse_mode']
add ['esp,', '8']
jmp ['$LN48_0']
mov ['eax,', '[ebp+arg_C]']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '2']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+15Ch],', 'eax']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1088h]']
push ['ecx']
call ['_set_raw_mouse_mode']
add ['esp,', '8']
jmp ['$LN48_0']
xor ['edx,', 'edx']
cmp ['[ebp+arg_C],', '0']
setnz ['dl']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+160h],', 'edx']
jmp ['$LN48_0']
xor ['ecx,', 'ecx']
cmp ['[ebp+arg_C],', '0']
setnz ['cl']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+164h],', 'ecx']
jmp ['$LN48_0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
and ['ecx,', '4000h']
jnz ['short', 'loc_F731']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E44h],', '0']
jmp ['$LN48_0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_deselect']
add ['esp,', '4']
push ['1']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1134h]']
neg ['edx']
sbb ['edx,', 'edx']
not ['edx']
and ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_swap_screen']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1164h],', '0']
jz ['short', 'loc_F776']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10h],', '0']
jmp ['$LN48_0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1134h],', '0']
jnz ['short', 'loc_F797']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_save_cursor']
add ['esp,', '8']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_F7A9']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
jmp ['$LN48_0']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_F7D0']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1134h],', '0']
jnz ['short', 'loc_F7D0']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_save_cursor']
add ['esp,', '8']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_F7E2']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_seen_disp_event']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4000h']
jnz ['short', 'loc_F7FD']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['short', '$LN48_0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_deselect']
add ['esp,', '4']
push ['0']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1134h]']
neg ['ecx']
sbb ['ecx,', 'ecx']
not ['ecx']
and ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_swap_screen']
add ['esp,', '10h']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_F84E']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1134h],', '0']
jnz ['short', 'loc_F84E']
mov ['ecx,', '[ebp+arg_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_save_cursor']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1164h],', '0']
jz ['short', 'loc_F864']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+10h],', '0']
jmp ['short', '$LN48_0']
xor ['edx,', 'edx']
cmp ['[ebp+arg_C],', '0']
setnz ['dl']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+16Ch],', 'edx']
jmp ['$LN51_0']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_C],', 'ecx']
mov ['edx,', '[ebp+var_C]']
sub ['edx,', '4']
mov ['[ebp+var_C],', 'edx']
cmp ['[ebp+var_C],', '1Eh']
ja ['$LN51_0']
mov ['eax,', '[ebp+var_C]']
movzx ['ecx,', 'ds:$LN56_0[eax]']
jmp ['ds:$LN58_2[ecx*4]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '8']
jnz ['short', 'loc_F8C3']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['$LN51_0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_C]']
mov ['[edx+90h],', 'eax']
jmp ['short', '$LN51_0']
xor ['ecx,', 'ecx']
cmp ['[ebp+arg_C],', '0']
setz ['cl']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0C8h],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1084h],', '0']
jz ['short', 'loc_F907']
push ['0']
push ['0']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1084h]']
push ['edx']
call ['_ldisc_send']
add ['esp,', '10h']
jmp ['short', '$LN51_0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_C]']
mov ['[eax+150h],', 'ecx']
jmp ['short', '$LN51_0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
and ['eax,', '4010h']
jnz ['short', 'loc_F932']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E44h],', '0']
jmp ['short', '$LN51_0']
xor ['edx,', 'edx']
cmp ['[ebp+arg_C],', '0']
setz ['dl']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+158h],', 'edx']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_do_osc         proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0A3Ch],', '0']
jz ['short', 'loc_FA63']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+234h]']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+234h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+234h],', 'ecx']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_FA5E']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+234h]']
mov ['edx,', '[ebp+arg_0]']
movzx ['eax,', 'byte', 'ptr', '[edx+ecx+238h]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+arg_0]']
mov ['dx,', '[edx+1ACh]']
mov ['[ecx+eax*2+0E6Ch],', 'dx']
jmp ['short', 'loc_FA0C']
jmp ['$LN12_1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+234h]']
mov ['edx,', '[ebp+arg_0]']
mov ['byte', 'ptr', '[edx+ecx+238h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1ACh]']
mov ['[ebp+var_8],', 'ecx']
cmp ['[ebp+var_8],', '15h']
ja ['short', '$LN12_1']
mov ['edx,', '[ebp+var_8]']
movzx ['eax,', 'ds:$LN14_2[edx]']
jmp ['ds:$LN15_2[eax*4]']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+1150h],', '0']
jnz ['short', 'loc_FAC2']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '238h']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1088h]']
push ['ecx']
call ['_set_icon']
add ['esp,', '8']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+1ACh],', '1']
jnz ['short', '$LN2_0']
jmp ['short', '$LN12_1']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1150h],', '0']
jnz ['short', '$LN12_1']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '238h']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1088h]']
push ['eax']
call ['_set_title']
add ['esp,', '8']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_print_setup proc near             
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '0F8h']
push ['eax']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_printer_start_job']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+104h],', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_sel_spread     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E4Ch],', '0']
jnz ['loc_FC9F']
push ['0FFFFFFFFh']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+0E58h]']
push ['edx']
mov ['eax,', '[ecx+0E54h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_sel_spread_half']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E54h],', 'eax']
mov ['[ecx+0E58h],', 'edx']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E60h],', '0']
jnz ['short', 'loc_FBFA']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
mov ['[eax+0E60h],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E5Ch]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E5Ch],', 'ecx']
mov ['[ebp+var_4],', '1']
jmp ['short', 'loc_FC16']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E60h]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E60h],', 'ecx']
mov ['[ebp+var_4],', '0']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E60h]']
push ['ecx']
mov ['edx,', '[eax+0E5Ch]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sel_spread_half']
add ['esp,', '10h']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+0E5Ch],', 'eax']
mov ['[ecx+0E60h],', 'edx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[edx+0E60h]']
cmp ['ecx,', '[eax+12Ch]']
jnz ['short', 'loc_FC83']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E60h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E5Ch]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E5Ch],', 'ecx']
mov ['[ebp+var_8],', '1']
jmp ['short', 'loc_FC9F']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E60h]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+0E60h],', 'ecx']
mov ['[ebp+var_8],', '0']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sel_spread_half proc near              
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '44h']
push ['edi']
lea ['edi,', '[ebp+var_44]']
mov ['ecx,', '11h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sblines']
add ['esp,', '4']
neg ['eax']
mov ['[ebp+var_C],', 'eax']
push ['0']
push ['1654h']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0E50h]']
mov ['[ebp+var_24],', 'ecx']
cmp ['[ebp+var_24],', '0']
jz ['short', 'loc_FD28']
cmp ['[ebp+var_24],', '1']
jz ['loc_FE05']
cmp ['[ebp+var_24],', '2']
jz ['loc_10155']
jmp ['loc_10179']
mov ['edx,', '[ebp+var_4]']
movzx ['eax,', 'word', 'ptr', '[edx]']
and ['eax,', '10h']
jnz ['loc_FE00']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_4]']
add ['edx,', '[eax+14h]']
mov ['[ebp+var_10],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_10]']
cmp ['edx,', '[ecx+14h]']
jbe ['short', 'loc_FD99']
mov ['eax,', '[ebp+var_10]']
cmp ['dword', 'ptr', '[eax-0Ch],', '20h']
jz ['short', 'loc_FD85']
mov ['ecx,', '[ebp+var_10]']
mov ['edx,', '[ecx-0Ch]']
and ['edx,', '0FFFFFC00h']
cmp ['edx,', '0D800h']
jnz ['short', 'loc_FD99']
mov ['eax,', '[ebp+var_10]']
mov ['ecx,', '[eax-0Ch]']
and ['ecx,', '0FFh']
cmp ['ecx,', '20h']
jnz ['short', 'loc_FD99']
mov ['edx,', '[ebp+var_10]']
cmp ['dword', 'ptr', '[edx-4],', '0']
jnz ['short', 'loc_FD99']
mov ['eax,', '[ebp+var_10]']
sub ['eax,', '0Ch']
mov ['[ebp+var_10],', 'eax']
jmp ['short', 'loc_FD4C']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_4]']
add ['edx,', '[eax+14h]']
cmp ['[ebp+var_10],', 'edx']
jnz ['short', 'loc_FDB9']
mov ['ecx,', '[ebp+var_10]']
sub ['ecx,', '0Ch']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_10]']
sub ['eax,', '[edx+14h]']
cdq
mov ['ecx,', '0Ch']
idiv ['ecx']
cmp ['[ebp+arg_8],', 'eax']
jl ['short', 'loc_FE00']
cmp ['[ebp+arg_C],', '0FFFFFFFFh']
jnz ['short', 'loc_FDEB']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_10]']
sub ['eax,', '[edx+14h]']
cdq
mov ['ecx,', '0Ch']
idiv ['ecx']
mov ['[ebp+var_28],', 'eax']
jmp ['short', 'loc_FDFA']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
sub ['eax,', '1']
mov ['[ebp+var_28],', 'eax']
mov ['ecx,', '[ebp+var_28]']
mov ['[ebp+arg_8],', 'ecx']
jmp ['loc_10179']
cmp ['[ebp+arg_8],', '0']
jle ['short', 'loc_FE37']
mov ['edx,', '[ebp+arg_8]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
cmp ['dword', 'ptr', '[edx+ecx],', '0DFFFh']
jnz ['short', 'loc_FE37']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', '1']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[edx+ecx]']
mov ['[ebp+var_2C],', 'edx']
jmp ['short', 'loc_FE49']
mov ['eax,', '[ebp+arg_8]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
mov ['eax,', '[eax+edx]']
mov ['[ebp+var_2C],', 'eax']
mov ['ecx,', '[ebp+var_2C]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_wordtype']
add ['esp,', '8']
mov ['[ebp+var_8],', 'ax']
cmp ['[ebp+arg_C],', '1']
jnz ['loc_FFBB']
mov ['eax,', '1']
test ['eax,', 'eax']
jz ['loc_FFB6']
mov ['ecx,', '[ebp+var_4]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
and ['edx,', '20h']
jz ['short', 'loc_FE90']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+12Ch]']
sub ['ecx,', '1']
mov ['[ebp+var_30],', 'ecx']
jmp ['short', 'loc_FE9C']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
mov ['[ebp+var_30],', 'eax']
mov ['ecx,', '[ebp+var_30]']
mov ['[ebp+var_14],', 'ecx']
mov ['edx,', '[ebp+var_14]']
sub ['edx,', '1']
cmp ['[ebp+arg_8],', 'edx']
jge ['short', 'loc_FF25']
mov ['eax,', '[ebp+arg_8]']
add ['eax,', '1']
test ['eax,', 'eax']
jle ['short', 'loc_FEE3']
mov ['ecx,', '[ebp+arg_8]']
add ['ecx,', '1']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
cmp ['dword', 'ptr', '[ecx+eax],', '0DFFFh']
jnz ['short', 'loc_FEE3']
mov ['ecx,', '[ebp+arg_8]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[ecx+eax]']
mov ['[ebp+var_34],', 'ecx']
jmp ['short', 'loc_FEF8']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '1']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[edx+ecx]']
mov ['[ebp+var_34],', 'edx']
mov ['eax,', '[ebp+var_34]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_wordtype']
add ['esp,', '8']
movsx ['edx,', '[ebp+var_8]']
cmp ['eax,', 'edx']
jnz ['short', 'loc_FF1B']
mov ['eax,', '[ebp+arg_8]']
add ['eax,', '1']
mov ['[ebp+arg_8],', 'eax']
jmp ['short', 'loc_FF20']
jmp ['loc_FFB6']
jmp ['loc_FFB1']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
cmp ['ecx,', '[edx+128h]']
jge ['short', 'loc_FFAF']
mov ['eax,', '[ebp+var_4]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
and ['ecx,', '10h']
jz ['short', 'loc_FFAF']
push ['0']
push ['167Ah']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '1']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[ebp+var_18]']
mov ['edx,', '[ecx+14h]']
mov ['eax,', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_wordtype']
add ['esp,', '8']
movsx ['edx,', '[ebp+var_8]']
cmp ['eax,', 'edx']
jnz ['short', 'loc_FF9F']
mov ['[ebp+arg_8],', '0']
mov ['eax,', '[ebp+arg_4]']
add ['eax,', '1']
mov ['[ebp+arg_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_unlineptr']
add ['esp,', '4']
mov ['edx,', '[ebp+var_18]']
mov ['[ebp+var_4],', 'edx']
jmp ['short', 'loc_FFAD']
mov ['eax,', '[ebp+var_18]']
push ['eax']
call ['_unlineptr']
add ['esp,', '4']
jmp ['short', 'loc_FFB6']
jmp ['short', 'loc_FFB1']
jmp ['short', 'loc_FFB6']
jmp ['loc_FE67']
jmp ['loc_10153']
mov ['ecx,', '1']
test ['ecx,', 'ecx']
jz ['loc_10153']
cmp ['[ebp+arg_8],', '0']
jle ['short', 'loc_10049']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', '1']
test ['edx,', 'edx']
jle ['short', 'loc_10007']
mov ['eax,', '[ebp+arg_8]']
sub ['eax,', '1']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
cmp ['dword', 'ptr', '[eax+edx],', '0DFFFh']
jnz ['short', 'loc_10007']
mov ['eax,', '[ebp+arg_8]']
sub ['eax,', '2']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
mov ['eax,', '[eax+edx]']
mov ['[ebp+var_38],', 'eax']
jmp ['short', 'loc_1001C']
mov ['ecx,', '[ebp+arg_8]']
sub ['ecx,', '1']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[ecx+eax]']
mov ['[ebp+var_38],', 'ecx']
mov ['edx,', '[ebp+var_38]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_wordtype']
add ['esp,', '8']
movsx ['ecx,', '[ebp+var_8]']
cmp ['eax,', 'ecx']
jnz ['short', 'loc_1003F']
mov ['edx,', '[ebp+arg_8]']
sub ['edx,', '1']
mov ['[ebp+arg_8],', 'edx']
jmp ['short', 'loc_10044']
jmp ['loc_10153']
jmp ['loc_1014E']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[ebp+var_C]']
jg ['short', 'loc_10056']
jmp ['loc_10153']
push ['0']
push ['1695h']
mov ['ecx,', '[ebp+arg_4]']
sub ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_lineptr']
add ['esp,', '10h']
mov ['[ebp+var_1C],', 'eax']
mov ['eax,', '[ebp+var_1C]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
and ['ecx,', '20h']
jz ['short', 'loc_1008F']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
sub ['eax,', '1']
mov ['[ebp+var_3C],', 'eax']
jmp ['short', 'loc_1009B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+12Ch]']
mov ['[ebp+var_3C],', 'edx']
mov ['eax,', '[ebp+var_3C]']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+var_1C]']
movzx ['edx,', 'word', 'ptr', '[ecx]']
and ['edx,', '10h']
jz ['loc_1014C']
mov ['eax,', '[ebp+var_20]']
sub ['eax,', '1']
test ['eax,', 'eax']
jle ['short', 'loc_100E9']
mov ['ecx,', '[ebp+var_20]']
sub ['ecx,', '1']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_1C]']
mov ['eax,', '[edx+14h]']
cmp ['dword', 'ptr', '[ecx+eax],', '0DFFFh']
jnz ['short', 'loc_100E9']
mov ['ecx,', '[ebp+var_20]']
sub ['ecx,', '2']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_1C]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[ecx+eax]']
mov ['[ebp+var_40],', 'ecx']
jmp ['short', 'loc_100FE']
mov ['edx,', '[ebp+var_20]']
sub ['edx,', '1']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+var_1C]']
mov ['ecx,', '[eax+14h]']
mov ['edx,', '[edx+ecx]']
mov ['[ebp+var_40],', 'edx']
mov ['eax,', '[ebp+var_40]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_wordtype']
add ['esp,', '8']
movsx ['edx,', '[ebp+var_8]']
cmp ['eax,', 'edx']
jnz ['short', 'loc_1013C']
mov ['eax,', '[ebp+var_20]']
sub ['eax,', '1']
mov ['[ebp+arg_8],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
sub ['ecx,', '1']
mov ['[ebp+arg_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_unlineptr']
add ['esp,', '4']
mov ['eax,', '[ebp+var_1C]']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_1014A']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
call ['_unlineptr']
add ['esp,', '4']
jmp ['short', 'loc_10153']
jmp ['short', 'loc_1014E']
jmp ['short', 'loc_10153']
jmp ['loc_FFBB']
jmp ['short', 'loc_10179']
cmp ['[ebp+arg_C],', '0FFFFFFFFh']
jnz ['short', 'loc_10164']
mov ['[ebp+var_44],', '0']
jmp ['short', 'loc_10173']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+12Ch]']
sub ['eax,', '1']
mov ['[ebp+var_44],', 'eax']
mov ['ecx,', '[ebp+var_44]']
mov ['[ebp+arg_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_unlineptr']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_4]']
mov ['edx,', '[ebp+arg_8]']
pop ['edi']
add ['esp,', '44h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_wordtype       proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
and ['eax,', '0FFFFFF00h']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0D800h']
jz ['short', 'loc_101FD']
cmp ['[ebp+var_8],', '0D900h']
jz ['short', 'loc_101DF']
cmp ['[ebp+var_8],', '0DA00h']
jz ['short', 'loc_1021C']
jmp ['short', 'loc_10236']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
mov ['eax,', '[ebp+arg_4]']
and ['eax,', '0FFh']
movzx ['ecx,', 'word', 'ptr', '[edx+eax*2+610h]']
mov ['[ebp+arg_4],', 'ecx']
jmp ['short', 'loc_10236']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[ebp+arg_4]']
and ['ecx,', '0FFh']
movzx ['edx,', 'word', 'ptr', '[eax+ecx*2+210h]']
mov ['[ebp+arg_4],', 'edx']
jmp ['short', 'loc_10236']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+arg_4]']
and ['edx,', '0FFh']
movzx ['eax,', 'word', 'ptr', '[ecx+edx*2+10h]']
mov ['[ebp+arg_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
and ['ecx,', '0FFFFFF00h']
mov ['[ebp+var_C],', 'ecx']
cmp ['[ebp+var_C],', '0F000h']
jz ['short', 'loc_10275']
cmp ['[ebp+var_C],', '0F100h']
jz ['short', 'loc_10256']
jmp ['short', 'loc_10292']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[ebp+arg_4]']
and ['ecx,', '0FFh']
movzx ['edx,', 'word', 'ptr', '[eax+ecx*2+410h]']
mov ['[ebp+arg_4],', 'edx']
jmp ['short', 'loc_10292']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+arg_4]']
and ['edx,', '0FFh']
movzx ['eax,', 'word', 'ptr', '[ecx+edx*2+810h]']
mov ['[ebp+arg_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1090h]']
cmp ['dword', 'ptr', '[edx+4],', '0']
jz ['short', 'loc_102C6']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1090h]']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+1090h]']
mov ['ecx,', '[ecx+8]']
cmp ['ecx,', '[eax+0Ch]']
jnz ['short', 'loc_102C6']
xor ['eax,', 'eax']
cmp ['[ebp+arg_4],', '20h']
setnz ['al']
jmp ['short', 'loc_1031D']
cmp ['[ebp+arg_4],', '80h']
jge ['short', 'loc_102DF']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+arg_0]']
movsx ['eax,', 'word', 'ptr', '[eax+edx*2+0E6Ch]']
jmp ['short', 'loc_1031D']
mov ['[ebp+var_4],', 'offset', '?ucs_words@?1??wordtype@@9@9']
jmp ['short', 'loc_102F1']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0Ch']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx],', '0']
jz ['short', 'loc_10318']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
cmp ['ecx,', '[eax]']
jl ['short', 'loc_10316']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[edx+4]']
jg ['short', 'loc_10316']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+8]']
jmp ['short', 'loc_1031D']
jmp ['short', 'loc_102E8']
mov ['eax,', '2']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_format_arrow_key proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+Dest],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+Dest],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+148h],', '0']
jz ['short', 'loc_10376']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
push ['offset', '$SG88502']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
jmp ['short', 'loc_103F4']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+140h],', '0']
jz ['short', 'loc_10397']
mov ['edx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[edx+1138h],', '0']
jnz ['short', 'loc_10397']
mov ['[ebp+var_C],', '1']
jmp ['short', 'loc_1039E']
mov ['[ebp+var_C],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_103B6']
xor ['ecx,', 'ecx']
cmp ['[ebp+var_8],', '0']
setz ['cl']
mov ['[ebp+var_8],', 'ecx']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_103D9']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
push ['offset', '$SG88508']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
jmp ['short', 'loc_103F4']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
push ['offset', '$SG88511']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_sprintf']
add ['esp,', '0Ch']
add ['eax,', '[ebp+Dest]']
mov ['[ebp+Dest],', 'eax']
mov ['eax,', '[ebp+Dest]']
sub ['eax,', '[ebp+arg_0]']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_nopaste   proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1074h],', '0']
jnz ['short', 'loc_1041D']
jmp ['short', 'loc_10449']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+1070h]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+1070h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1074h],', '0']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_deselect       proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E48h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E5Ch],', '0']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+0E60h],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax+0E54h],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0E58h],', '0']
pop ['ebp']
retn
endp
_term_deselect  proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_deselect']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_update']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+0E48h],', '2']
jz ['short', 'loc_104DF']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_out']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_ldisc     proc near
push ['ebp']
mov ['ebp,', 'esp']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_10500']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+0C8h]']
jmp ['short', 'loc_10513']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_10511']
mov ['ecx,', '[ebp+arg_0]']
mov ['eax,', '[ecx+0CCh]']
jmp ['short', 'loc_10513']
xor ['eax,', 'eax']
pop ['ebp']
retn
endp
_term_data      proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '60h']
push ['edx']
call ['_bufchain_add']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+1098h],', '0']
jnz ['short', 'loc_10580']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+1098h],', '1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_reset_cblink']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+0E48h],', '2']
jz ['short', 'loc_10573']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_out']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+1098h],', '0']
xor ['eax,', 'eax']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_reset_cblink proc near            
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_seen_disp_event']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+0BCh],', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+10A8h],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_schedule_cblink']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_data_untrusted proc near          
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_105E9']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['ecx,', '[ebp+arg_8]']
jge ['short', 'loc_1063D']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '[ebp+var_4]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '0Ah']
jnz ['short', 'loc_10616']
push ['2']
push ['offset', '$SG88554']
push ['1']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_data']
add ['esp,', '10h']
jmp ['short', 'loc_1063B']
mov ['edx,', '[ebp+arg_4]']
add ['edx,', '[ebp+var_4]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
and ['eax,', '60h']
jz ['short', 'loc_1063B']
push ['1']
mov ['ecx,', '[ebp+arg_4]']
add ['ecx,', '[ebp+var_4]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_data']
add ['esp,', '10h']
jmp ['short', 'loc_105E0']
xor ['eax,', 'eax']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_provide_logctx proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+108Ch],', 'ecx']
pop ['ebp']
retn
endp
_term_set_focus proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+134h],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_schedule_cblink']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_term_get_ttymode proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0']
push ['offset', '$SG88575']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_106FE']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+10FCh],', '0']
jz ['short', 'loc_106F1']
mov ['[ebp+var_8],', 'offset', '$SG88576']
jmp ['short', 'loc_106F8']
mov ['[ebp+var_8],', 'offset', '$SG88577']
mov ['edx,', '[ebp+var_8]']
mov ['[ebp+var_4],', 'edx']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_dupstr']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_term_get_userpass_input proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax+20h]']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+var_4],', '0']
jnz ['loc_10862']
push ['0Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+var_4]']
mov ['[edx+20h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4],', '0']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax+8],', '0']
jz ['short', 'loc_107D1']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jz ['short', 'loc_107D1']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_data_untrusted']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+var_8]']
movsx ['edx,', 'byte', 'ptr', '[eax+ecx-1]']
cmp ['edx,', '0Ah']
jz ['short', 'loc_107D1']
push ['1']
push ['offset', '$SG88599']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_data_untrusted']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[ecx+0Ch],', '0']
jz ['short', 'loc_10829']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_data_untrusted']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[ebp+var_C]']
movsx ['edx,', 'byte', 'ptr', '[eax+ecx-1]']
cmp ['edx,', '0Ah']
jz ['short', 'loc_10829']
push ['1']
push ['offset', '$SG88603']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_data_untrusted']
add ['esp,', '0Ch']
mov ['[ebp+var_10],', '0']
jmp ['short', 'loc_1083B']
mov ['ecx,', '[ebp+var_10]']
add ['ecx,', '1']
mov ['[ebp+var_10],', 'ecx']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+var_10]']
cmp ['eax,', '[edx+14h]']
jge ['short', 'loc_10862']
push ['offset', '$SG88609']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[ebp+var_10]']
mov ['ecx,', '[edx+eax*4]']
push ['ecx']
call ['_prompt_set_result']
add ['esp,', '8']
jmp ['short', 'loc_10832']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[edx]']
cmp ['ecx,', '[eax+14h]']
jnb ['loc_10AC0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[edx+eax*4]']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_18],', '0']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jnz ['short', 'loc_108C9']
mov ['edx,', '[ebp+var_14]']
mov ['eax,', '[edx]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+var_14]']
mov ['edx,', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_term_data_untrusted']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '1']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+8],', '0']
cmp ['[ebp+arg_8],', '0']
jz ['short', 'loc_108D5']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_108DA']
jmp ['loc_10AC0']
cmp ['[ebp+var_18],', '0']
jnz ['loc_10ABB']
cmp ['[ebp+arg_C],', '0']
jz ['loc_10ABB']
mov ['eax,', '[ebp+arg_8]']
mov ['cl,', '[eax]']
mov ['[ebp+var_1D],', 'cl']
mov ['edx,', '[ebp+arg_8]']
add ['edx,', '1']
mov ['[ebp+arg_8],', 'edx']
mov ['eax,', '[ebp+arg_C]']
sub ['eax,', '1']
mov ['[ebp+arg_C],', 'eax']
movsx ['ecx,', '[ebp+var_1D]']
mov ['[ebp+var_28],', 'ecx']
mov ['edx,', '[ebp+var_28]']
sub ['edx,', '3']
mov ['[ebp+var_28],', 'edx']
cmp ['[ebp+var_28],', '7Ch']
ja ['$LN7_6']
mov ['eax,', '[ebp+var_28]']
movzx ['ecx,', 'ds:$LN36_1[eax]']
jmp ['ds:$LN40[ecx*4]']
push ['2']
push ['offset', '$SG88627']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_data']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
add ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+var_14]']
push ['edx']
call ['_prompt_ensure_result_size']
add ['esp,', '8']
mov ['eax,', '[ebp+var_14]']
mov ['ecx,', '[eax+8]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
mov ['byte', 'ptr', '[ecx+eax],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['[ebp+var_18],', '1']
jmp ['loc_10AB6']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jbe ['short', 'loc_109C7']
mov ['eax,', '[ebp+var_14]']
cmp ['dword', 'ptr', '[eax+4],', '0']
jz ['short', 'loc_109B8']
push ['3']
push ['offset', '$SG88631']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_data']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+8],', 'eax']
jmp ['loc_10AB6']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jbe ['short', 'loc_10A04']
mov ['eax,', '[ebp+var_14]']
cmp ['dword', 'ptr', '[eax+4],', '0']
jz ['short', 'loc_109F3']
push ['3']
push ['offset', '$SG88637']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_term_data']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
sub ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+8],', 'eax']
jmp ['short', '$LN11_2']
jmp ['loc_10AB6']
push ['2']
push ['offset', '$SG88639']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_data']
add ['esp,', '10h']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[ecx+20h],', '0']
xor ['eax,', 'eax']
jmp ['loc_10AEF']
mov ['edx,', '[ebp+var_14]']
cmp ['dword', 'ptr', '[edx+4],', '0']
jz ['short', 'loc_10A62']
movsx ['eax,', '[ebp+var_1D]']
cmp ['eax,', '20h']
jl ['short', 'loc_10A56']
movsx ['ecx,', '[ebp+var_1D]']
cmp ['ecx,', '7Eh']
jle ['short', 'loc_10A62']
movzx ['edx,', '[ebp+var_1D]']
cmp ['edx,', '0A0h']
jl ['short', 'loc_10AB6']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
add ['ecx,', '1']
push ['ecx']
mov ['edx,', '[ebp+var_14]']
push ['edx']
call ['_prompt_ensure_result_size']
add ['esp,', '8']
mov ['eax,', '[ebp+var_14]']
mov ['ecx,', '[eax+8]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
mov ['dl,', '[ebp+var_1D]']
mov ['[ecx+eax],', 'dl']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+8],', 'ecx']
mov ['eax,', '[ebp+var_14]']
cmp ['dword', 'ptr', '[eax+4],', '0']
jz ['short', 'loc_10AB6']
push ['1']
lea ['ecx,', '[ebp+var_1D]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_term_data']
add ['esp,', '10h']
jmp ['loc_108DA']
jmp ['loc_10862']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[eax]']
cmp ['edx,', '[ecx+14h]']
jnb ['short', 'loc_10AD4']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_10AEF']
jmp ['short', 'loc_10AEF']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[ecx+20h],', '0']
mov ['eax,', '1']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN39_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
