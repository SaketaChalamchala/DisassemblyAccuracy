_logflush       proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+20h],', '0']
jle ['short', 'loc_325']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+4],', '2']
jnz ['short', 'loc_325']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['_fflush']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_logfopen       proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '60h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_60]']
mov ['ecx,', '18h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jz ['short', 'loc_369']
jmp ['loc_487']
mov ['edx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[edx+20h],', '0']
jnz ['short', 'loc_377']
jmp ['loc_487']
lea ['eax,', '[ebp+var_60]']
push ['eax']
call ['_ltime']
add ['esp,', '4']
mov ['ecx,', '9']
mov ['esi,', 'eax']
lea ['edi,', '[ebp+var_30]']
rep ['movsd']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+14h],', '0']
jz ['short', 'loc_3A7']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+14h]']
push ['eax']
call ['_filename_free']
add ['esp,', '4']
lea ['ecx,', '[ebp+var_30]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_conf_get_str']
add ['esp,', '8']
push ['eax']
push ['72h']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+1Ch]']
push ['edx']
call ['_conf_get_filename']
add ['esp,', '8']
push ['eax']
call ['_xlatlognam']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
mov ['[ecx+14h],', 'eax']
push ['offset', '$SG85651']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+14h]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['_fopen']
add ['esp,', '8']
mov ['edx,', '[ebp+var_8]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax],', '0']
jz ['short', 'loc_45E']
push ['74h']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+1Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['[ebp+var_3C],', 'eax']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['_fclose']
add ['esp,', '4']
cmp ['[ebp+var_3C],', '0FFFFFFFFh']
jz ['short', 'loc_43A']
mov ['edx,', '[ebp+var_3C]']
sub ['edx,', '1']
neg ['edx']
sbb ['edx,', 'edx']
add ['edx,', '2']
mov ['[ebp+var_38],', 'edx']
jmp ['short', 'loc_45C']
mov ['eax,', '[ebp+var_8]']
push ['eax']
push ['offset', '_logfopen_callback']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+14h]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_askappend']
add ['esp,', '10h']
mov ['[ebp+var_38],', 'eax']
jmp ['short', 'loc_465']
mov ['[ebp+var_38],', '2']
cmp ['[ebp+var_38],', '0']
jge ['short', 'loc_477']
mov ['edx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[edx+4],', '1']
jmp ['short', 'loc_487']
mov ['eax,', '[ebp+var_38]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logfopen_callback']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN14']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '60h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_logfopen_callback proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1A0h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_1A0]']
mov ['ecx,', '68h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_513']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+4],', '3']
jmp ['short', 'loc_576']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_525']
mov ['[ebp+var_184],', 'offset', '$SG85616']
jmp ['short', 'loc_52F']
mov ['[ebp+var_184],', 'offset', '$SG85617']
mov ['edx,', '[ebp+var_184]']
mov ['[ebp+var_144],', 'edx']
mov ['eax,', '[ebp+var_144]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+14h]']
mov ['eax,', '[edx]']
push ['eax']
call ['_fopen']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_8]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[edx],', '0']
jz ['short', 'loc_56C']
mov ['eax,', '[ebp+var_8]']
mov ['dword', 'ptr', '[eax+4],', '2']
jmp ['short', 'loc_576']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', '[ecx+4],', '3']
mov ['edx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[edx+4],', '2']
jnz ['short', 'loc_5D2']
lea ['eax,', '[ebp+var_180]']
push ['eax']
call ['_ltime']
add ['esp,', '4']
mov ['ecx,', '9']
mov ['esi,', 'eax']
lea ['edi,', '[ebp+var_13C]']
rep ['movsd']
lea ['ecx,', '[ebp+var_13C]']
push ['ecx']
push ['offset', '$SG85621']
push ['18h']
lea ['edx,', '[ebp+var_10C]']
push ['edx']
call ['_strftime']
add ['esp,', '10h']
lea ['eax,', '[ebp+var_10C]']
push ['eax']
push ['offset', '$SG85622']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logprintf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[edx+20h],', '1']
jnz ['short', 'loc_5E7']
mov ['[ebp+var_188],', 'offset', '$SG85623']
jmp ['short', 'loc_654']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax+20h],', '2']
jnz ['short', 'loc_5FC']
mov ['[ebp+var_18C],', 'offset', '$SG85624']
jmp ['short', 'loc_648']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+20h],', '3']
jnz ['short', 'loc_611']
mov ['[ebp+var_190],', 'offset', '$SG85625']
jmp ['short', 'loc_63C']
mov ['edx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[edx+20h],', '4']
jnz ['short', 'loc_626']
mov ['[ebp+var_194],', 'offset', '$SG85626']
jmp ['short', 'loc_630']
mov ['[ebp+var_194],', 'offset', '$SG85627']
mov ['eax,', '[ebp+var_194]']
mov ['[ebp+var_190],', 'eax']
mov ['ecx,', '[ebp+var_190]']
mov ['[ebp+var_18C],', 'ecx']
mov ['edx,', '[ebp+var_18C]']
mov ['[ebp+var_188],', 'edx']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax+4],', '3']
jnz ['short', 'loc_687']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_66F']
mov ['[ebp+var_198],', 'offset', '$SG85628']
jmp ['short', 'loc_679']
mov ['[ebp+var_198],', 'offset', '$SG85629']
mov ['ecx,', '[ebp+var_198]']
mov ['[ebp+var_19C],', 'ecx']
jmp ['short', 'loc_6AF']
cmp ['[ebp+arg_4],', '1']
jnz ['short', 'loc_699']
mov ['[ebp+var_1A0],', 'offset', '$SG85630']
jmp ['short', 'loc_6A3']
mov ['[ebp+var_1A0],', 'offset', '$SG85631']
mov ['edx,', '[ebp+var_1A0]']
mov ['[ebp+var_19C],', 'edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[eax+14h]']
push ['ecx']
call ['_filename_to_str']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+var_188]']
push ['edx']
mov ['eax,', '[ebp+var_19C]']
push ['eax']
push ['offset', '$SG85632']
call ['_dupprintf']
add ['esp,', '10h']
mov ['[ebp+var_114],', 'eax']
mov ['ecx,', '[ebp+var_114]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[edx+18h]']
push ['eax']
call ['_logevent']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_114]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['edx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[edx+4],', '1']
jnz ['short', 'loc_722']
push ['7Fh']
push ['offset', '$SG85634']
push ['offset', '$SG85635']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '8']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_784']
lea ['edx,', '[ebp+var_158]']
push ['edx']
lea ['eax,', '[ebp+var_14C]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
add ['ecx,', '8']
push ['ecx']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_158]']
push ['edx']
mov ['eax,', '[ebp+var_14C]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logwrite']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_158]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '8']
push ['eax']
call ['_bufchain_consume']
add ['esp,', '8']
jmp ['short', 'loc_722']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN32']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '1A0h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_logwrite       proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+4],', '0']
jnz ['short', 'loc_81C']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logfopen']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+4],', '1']
jnz ['short', 'loc_83E']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '8']
push ['edx']
call ['_bufchain_add']
add ['esp,', '0Ch']
jmp ['short', 'loc_8AA']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+4],', '2']
jnz ['short', 'loc_8AA']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx],', '0']
jnz ['short', 'loc_863']
push ['2Eh']
push ['offset', '$SG85578']
push ['offset', '$SG85579']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
push ['ecx']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
push ['1']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_fwrite']
add ['esp,', '10h']
cmp ['eax,', '[ebp+arg_8]']
jnb ['short', 'loc_8AA']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_logfclose']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+4],', '3']
push ['offset', '$SG85582']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_logevent']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_logprintf      proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
lea ['eax,', '[ebp+arg_8]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
call ['_dupvprintf']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', '0']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['_logwrite']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_logfclose      proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx],', '0']
jz ['short', 'loc_954']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
push ['eax']
call ['_fclose']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+4],', '0']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_logtraffic     proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+20h],', '0']
jle ['short', 'loc_9AB']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+20h]']
cmp ['eax,', '[ebp+arg_8]']
jnz ['short', 'loc_9AB']
push ['1']
lea ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_logwrite']
add ['esp,', '0Ch']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_log_eventlog   proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', 'dword', 'ptr', 'ds:_flags']
and ['ecx,', '2']
jz ['short', 'loc_A16']
mov ['edx,', 'dword', 'ptr', 'ds:_flags']
and ['edx,', '1']
jz ['short', 'loc_A16']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['offset', '$SG85685']
call ['___iob_func']
add ['eax,', '40h']
push ['eax']
call ['_fprintf']
add ['esp,', '0Ch']
call ['___iob_func']
add ['eax,', '40h']
push ['eax']
call ['_fflush']
add ['esp,', '4']
cmp ['[ebp+var_4],', '0']
jnz ['short', 'loc_A1E']
jmp ['short', 'loc_A53']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+20h],', '3']
jz ['short', 'loc_A32']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx+20h],', '4']
jz ['short', 'loc_A32']
jmp ['short', 'loc_A53']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['offset', '$SG85688']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_logprintf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_logflush']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_log_packet     proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '1F4h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_1F4]']
mov ['ecx,', '7Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_74],', '0']
mov ['[ebp+var_78],', '0']
mov ['[ebp+var_7C],', '0']
mov ['[ebp+var_80],', '0']
mov ['ecx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[ecx+20h],', '4']
jz ['short', 'loc_ACA']
mov ['edx,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[edx+20h],', '3']
jnz ['short', 'loc_AC5']
cmp ['[ebp+arg_C],', '0']
jnz ['short', 'loc_ACA']
jmp ['loc_EC3']
cmp ['[ebp+arg_C],', '0']
jz ['loc_B8B']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_AE6']
mov ['[ebp+var_1E4],', 'offset', '$SG85723']
jmp ['short', 'loc_AF0']
mov ['[ebp+var_1E4],', 'offset', '$SG85724']
mov ['eax,', '[ebp+var_1E4]']
push ['eax']
push ['offset', '$SG85725']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logprintf']
add ['esp,', '0Ch']
cmp ['[ebp+arg_20],', '0']
jz ['short', 'loc_B25']
mov ['edx,', '[ebp+arg_20]']
mov ['eax,', '[edx]']
push ['eax']
push ['offset', '$SG85727']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logprintf']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_C]']
push ['edx']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
push ['offset', '$SG85728']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_logprintf']
add ['esp,', '14h']
cmp ['[ebp+arg_24],', '0']
jz ['short', 'loc_B78']
mov ['eax,', '[ebp+arg_24]']
push ['eax']
push ['offset', '$SG85730']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logprintf']
add ['esp,', '0Ch']
cmp ['[ebp+arg_28],', '0']
jz ['short', 'loc_B78']
mov ['edx,', '[ebp+arg_28]']
push ['edx']
push ['offset', '$SG85732']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_logprintf']
add ['esp,', '0Ch']
push ['offset', '$SG85733']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logprintf']
add ['esp,', '8']
jmp ['short', 'loc_C01']
lea ['edx,', '[ebp+var_1E0]']
push ['edx']
call ['_ltime']
add ['esp,', '4']
mov ['ecx,', '9']
mov ['esi,', 'eax']
lea ['edi,', '[ebp+var_1B0]']
rep ['movsd']
lea ['eax,', '[ebp+var_1B0]']
push ['eax']
push ['offset', '$SG85737']
push ['18h']
lea ['ecx,', '[ebp+var_184]']
push ['ecx']
call ['_strftime']
add ['esp,', '10h']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_BD8']
mov ['[ebp+var_1E8],', 'offset', '$SG85738']
jmp ['short', 'loc_BE2']
mov ['[ebp+var_1E8],', 'offset', '$SG85739']
lea ['edx,', '[ebp+var_184]']
push ['edx']
mov ['eax,', '[ebp+var_1E8]']
push ['eax']
push ['offset', '$SG85740']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logprintf']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_74]']
cmp ['edx,', '[ebp+arg_14]']
jge ['loc_E79']
mov ['eax,', '[ebp+var_78]']
cmp ['eax,', '[ebp+arg_18]']
jge ['short', 'loc_C3E']
mov ['ecx,', '[ebp+var_78]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+var_78]']
imul ['edx,', '0Ch']
mov ['eax,', '[ebp+arg_1C]']
mov ['ecx,', '[eax+ecx]']
mov ['eax,', '[ebp+arg_1C]']
add ['ecx,', '[eax+edx+4]']
cmp ['[ebp+var_74],', 'ecx']
jl ['short', 'loc_C3E']
mov ['ecx,', '[ebp+var_78]']
add ['ecx,', '1']
mov ['[ebp+var_78],', 'ecx']
jmp ['short', 'loc_C0D']
mov ['[ebp+var_1B8],', '0']
mov ['edx,', '[ebp+var_78]']
cmp ['edx,', '[ebp+arg_18]']
jge ['short', 'loc_C92']
mov ['eax,', '[ebp+var_78]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_1C]']
mov ['edx,', '[ebp+var_74]']
cmp ['edx,', '[ecx+eax]']
jl ['short', 'loc_C92']
mov ['eax,', '[ebp+var_78]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+var_78]']
imul ['ecx,', '0Ch']
mov ['edx,', '[ebp+arg_1C]']
mov ['eax,', '[edx+eax]']
mov ['edx,', '[ebp+arg_1C]']
add ['eax,', '[edx+ecx+4]']
cmp ['[ebp+var_74],', 'eax']
jge ['short', 'loc_C92']
mov ['eax,', '[ebp+var_78]']
imul ['eax,', '0Ch']
mov ['ecx,', '[ebp+arg_1C]']
mov ['edx,', '[ecx+eax+8]']
mov ['[ebp+var_1B8],', 'edx']
cmp ['[ebp+var_1B8],', '2']
jz ['short', 'loc_CE0']
cmp ['[ebp+var_7C],', '0']
jz ['short', 'loc_CE0']
cmp ['[ebp+var_7C],', '1']
jnz ['short', 'loc_CB3']
mov ['[ebp+var_1EC],', 'offset', '$SG85750']
jmp ['short', 'loc_CBD']
mov ['[ebp+var_1EC],', 'offset', '$SG85751']
mov ['eax,', '[ebp+var_1EC]']
push ['eax']
mov ['ecx,', '[ebp+var_7C]']
push ['ecx']
push ['offset', '$SG85752']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_logprintf']
add ['esp,', '10h']
mov ['[ebp+var_7C],', '0']
cmp ['[ebp+var_80],', '0']
jnz ['short', 'loc_D19']
cmp ['[ebp+var_7C],', '0']
jnz ['short', 'loc_D19']
push ['offset', '$SG85754']
push ['43h']
mov ['eax,', '[ebp+var_74]']
and ['eax,', '8000000Fh']
jns ['short', 'loc_D02']
dec ['eax']
or ['eax,', '0FFFFFFF0h']
inc ['eax']
mov ['ecx,', '[ebp+var_74]']
sub ['ecx,', 'eax']
push ['ecx']
push ['offset', '$SG85755']
lea ['edx,', '[ebp+var_5C]']
push ['edx']
call ['_sprintf']
add ['esp,', '14h']
cmp ['[ebp+var_1B8],', '2']
jnz ['short', 'loc_D30']
mov ['eax,', '[ebp+var_7C]']
add ['eax,', '1']
mov ['[ebp+var_7C],', 'eax']
jmp ['loc_E0A']
cmp ['[ebp+var_1B8],', '1']
jnz ['short', 'loc_D56']
mov ['[ebp+var_1BC],', '58h']
push ['offset', '$SG85760']
lea ['ecx,', '[ebp+var_6C]']
push ['ecx']
call ['_sprintf']
add ['esp,', '8']
jmp ['short', 'loc_D7D']
mov ['edx,', '[ebp+arg_10]']
add ['edx,', '[ebp+var_74]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
mov ['[ebp+var_1BC],', 'eax']
mov ['ecx,', '[ebp+var_1BC]']
push ['ecx']
push ['offset', '$SG85763']
lea ['edx,', '[ebp+var_6C]']
push ['edx']
call ['_sprintf']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_74]']
and ['eax,', '8000000Fh']
jns ['short', 'loc_D8C']
dec ['eax']
or ['eax,', '0FFFFFFF0h']
inc ['eax']
imul ['eax,', '3']
mov ['cl,', '[ebp+var_6C]']
mov ['[ebp+eax+var_50],', 'cl']
mov ['edx,', '[ebp+var_74]']
and ['edx,', '8000000Fh']
jns ['short', 'loc_DA6']
dec ['edx']
or ['edx,', '0FFFFFFF0h']
inc ['edx']
imul ['edx,', '3']
mov ['al,', '[ebp+var_6B]']
mov ['[ebp+edx+var_4F],', 'al']
mov ['ecx,', '[ebp+var_1BC]']
push ['ecx']
call ['_isprint']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_DD1']
mov ['edx,', '[ebp+var_1BC]']
mov ['[ebp+var_1F0],', 'edx']
jmp ['short', 'loc_DDB']
mov ['[ebp+var_1F0],', '2Eh']
mov ['eax,', '[ebp+var_74]']
and ['eax,', '8000000Fh']
jns ['short', 'loc_DEA']
dec ['eax']
or ['eax,', '0FFFFFFF0h']
inc ['eax']
mov ['cl,', 'byte', 'ptr', '[ebp+var_1F0]']
mov ['[ebp+eax+var_1F],', 'cl']
mov ['edx,', '[ebp+var_74]']
and ['edx,', '8000000Fh']
jns ['short', 'loc_E04']
dec ['edx']
or ['edx,', '0FFFFFFF0h']
inc ['edx']
add ['edx,', '1']
mov ['[ebp+var_80],', 'edx']
mov ['eax,', '[ebp+var_74]']
add ['eax,', '1']
mov ['[ebp+var_74],', 'eax']
mov ['ecx,', '[ebp+var_74]']
and ['ecx,', '8000000Fh']
jns ['short', 'loc_E23']
dec ['ecx']
or ['ecx,', '0FFFFFFF0h']
inc ['ecx']
test ['ecx,', 'ecx']
jz ['short', 'loc_E35']
mov ['edx,', '[ebp+var_74]']
cmp ['edx,', '[ebp+arg_14]']
jz ['short', 'loc_E35']
cmp ['[ebp+var_7C],', '0']
jz ['short', 'loc_E74']
cmp ['[ebp+var_80],', '0']
jz ['short', 'loc_E74']
push ['offset', '$SG85767']
mov ['eax,', '[ebp+var_80]']
lea ['ecx,', '[ebp+eax+var_1F]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
lea ['edx,', '[ebp+var_5C]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
push ['eax']
lea ['eax,', '[ebp+var_5C]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logwrite']
add ['esp,', '0Ch']
mov ['[ebp+var_80],', '0']
jmp ['loc_C01']
cmp ['[ebp+var_7C],', '0']
jz ['short', 'loc_EB7']
cmp ['[ebp+var_7C],', '1']
jnz ['short', 'loc_E91']
mov ['[ebp+var_1F4],', 'offset', '$SG85769']
jmp ['short', 'loc_E9B']
mov ['[ebp+var_1F4],', 'offset', '$SG85770']
mov ['edx,', '[ebp+var_1F4]']
push ['edx']
mov ['eax,', '[ebp+var_7C]']
push ['eax']
push ['offset', '$SG85771']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['_logprintf']
add ['esp,', '10h']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['_logflush']
add ['esp,', '4']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN40']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '1F4h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_log_init       proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['24h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_0]']
mov ['[edx+18h],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_copy']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+1Ch],', 'eax']
push ['73h']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+20h],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+14h],', '0']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '8']
push ['ecx']
call ['_bufchain_init']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_log_free       proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_logfclose']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '8']
push ['edx']
call ['_bufchain_clear']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+14h],', '0']
jz ['short', 'loc_1028']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
push ['edx']
call ['_filename_free']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_conf_free']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_log_reconfig   proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
push ['72h']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_get_filename']
add ['esp,', '8']
push ['eax']
push ['72h']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_conf_get_filename']
add ['esp,', '8']
push ['eax']
call ['_filename_equal']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_10C1']
push ['73h']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+1Ch]']
push ['edx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['esi,', 'eax']
push ['73h']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_conf_get_int']
add ['esp,', '8']
cmp ['esi,', 'eax']
jz ['short', 'loc_10CA']
mov ['[ebp+var_8],', '1']
jmp ['short', 'loc_10D1']
mov ['[ebp+var_8],', '0']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_10E3']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_logfclose']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_conf_free']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
call ['_conf_copy']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+1Ch],', 'eax']
push ['73h']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
call ['_conf_get_int']
add ['esp,', '8']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+20h],', 'eax']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_112D']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_logfopen']
add ['esp,', '4']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_xlatlognam     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '3Ch']
push ['edi']
lea ['edi,', '[ebp+var_3C]']
mov ['ecx,', '0Fh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_2C],', '104h']
push ['1']
mov ['eax,', '[ebp+var_2C]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_24],', 'eax']
mov ['[ebp+var_28],', '0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_filename_to_str']
add ['esp,', '4']
mov ['[ebp+var_30],', 'eax']
mov ['edx,', '[ebp+var_30]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['loc_1342']
lea ['ecx,', '[ebp+var_14]']
mov ['[ebp+var_1C],', 'ecx']
mov ['edx,', '[ebp+var_30]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
cmp ['eax,', '26h']
jnz ['loc_12CB']
mov ['ecx,', '[ebp+var_30]']
add ['ecx,', '1']
mov ['[ebp+var_30],', 'ecx']
mov ['[ebp+var_20],', '0']
mov ['edx,', '[ebp+var_30]']
movsx ['eax,', 'byte', 'ptr', '[edx]']
test ['eax,', 'eax']
jz ['loc_12C9']
mov ['ecx,', '[ebp+var_30]']
mov ['dl,', '[ecx]']
mov ['[ebp+var_35],', 'dl']
mov ['eax,', '[ebp+var_30]']
add ['eax,', '1']
mov ['[ebp+var_30],', 'eax']
movzx ['ecx,', '[ebp+var_35]']
push ['ecx']
call ['_tolower']
add ['esp,', '4']
mov ['[ebp+var_3C],', 'eax']
mov ['edx,', '[ebp+var_3C]']
sub ['edx,', '64h']
mov ['[ebp+var_3C],', 'edx']
cmp ['[ebp+var_3C],', '15h']
ja ['$LN4']
mov ['eax,', '[ebp+var_3C]']
movzx ['ecx,', 'ds:$LN18[eax]']
jmp ['ds:$LN22[ecx*4]']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
push ['offset', '$SG85830']
push ['0Ah']
lea ['eax,', '[ebp+var_14]']
push ['eax']
call ['_strftime']
add ['esp,', '10h']
mov ['[ebp+var_20],', 'eax']
jmp ['loc_12C9']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
push ['offset', '$SG85832']
push ['0Ah']
lea ['edx,', '[ebp+var_14]']
push ['edx']
call ['_strftime']
add ['esp,', '10h']
mov ['[ebp+var_20],', 'eax']
jmp ['short', 'loc_12C9']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
push ['offset', '$SG85834']
push ['0Ah']
lea ['ecx,', '[ebp+var_14]']
push ['ecx']
call ['_strftime']
add ['esp,', '10h']
mov ['[ebp+var_20],', 'eax']
jmp ['short', 'loc_12C9']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
push ['offset', '$SG85836']
push ['0Ah']
lea ['eax,', '[ebp+var_14]']
push ['eax']
call ['_strftime']
add ['esp,', '10h']
mov ['[ebp+var_20],', 'eax']
jmp ['short', 'loc_12C9']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_1C],', 'ecx']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_20],', 'eax']
jmp ['short', 'loc_12C9']
mov ['[ebp+var_14],', '26h']
mov ['[ebp+var_20],', '1']
movsx ['eax,', '[ebp+var_35]']
cmp ['eax,', '26h']
jz ['short', 'loc_12C9']
mov ['ecx,', '[ebp+var_20]']
mov ['dl,', '[ebp+var_35]']
mov ['[ebp+ecx+var_14],', 'dl']
mov ['eax,', '[ebp+var_20]']
add ['eax,', '1']
mov ['[ebp+var_20],', 'eax']
jmp ['short', 'loc_12E3']
mov ['ecx,', '[ebp+var_30]']
mov ['dl,', '[ecx]']
mov ['[ebp+var_14],', 'dl']
mov ['eax,', '[ebp+var_30]']
add ['eax,', '1']
mov ['[ebp+var_30],', 'eax']
mov ['[ebp+var_20],', '1']
mov ['ecx,', '[ebp+var_28]']
add ['ecx,', '[ebp+var_20]']
cmp ['[ebp+var_2C],', 'ecx']
jg ['short', 'loc_131D']
mov ['eax,', '[ebp+var_28]']
add ['eax,', '[ebp+var_20]']
imul ['eax,', '5']
cdq
and ['edx,', '3']
add ['eax,', 'edx']
sar ['eax,', '2']
add ['eax,', '200h']
mov ['[ebp+var_2C],', 'eax']
push ['1']
mov ['edx,', '[ebp+var_2C]']
push ['edx']
mov ['eax,', '[ebp+var_24]']
push ['eax']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+var_24],', 'eax']
mov ['ecx,', '[ebp+var_20]']
push ['ecx']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
mov ['eax,', '[ebp+var_24]']
add ['eax,', '[ebp+var_28]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_28]']
add ['ecx,', '[ebp+var_20]']
mov ['[ebp+var_28],', 'ecx']
jmp ['loc_1192']
mov ['edx,', '[ebp+var_24]']
add ['edx,', '[ebp+var_28]']
mov ['byte', 'ptr', '[edx],', '0']
mov ['eax,', '[ebp+var_24]']
push ['eax']
call ['_filename_from_str']
add ['esp,', '4']
mov ['[ebp+var_34],', 'eax']
mov ['ecx,', '[ebp+var_24]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_34]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN21']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '3Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
