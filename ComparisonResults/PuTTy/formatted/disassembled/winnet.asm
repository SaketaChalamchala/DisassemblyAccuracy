_sk_startup     proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
and ['eax,', '0FFh']
movzx ['ecx,', 'al']
mov ['edx,', '[ebp+arg_4]']
and ['edx,', '0FFh']
movzx ['eax,', 'dl']
shl ['eax,', '8']
or ['ecx,', 'eax']
mov ['word', 'ptr', '[ebp+var_4],', 'cx']
mov ['esi,', 'esp']
push ['offset', '_wsadata']
movzx ['ecx,', 'word', 'ptr', '[ebp+var_4]']
push ['ecx']
call ['ds:_p_WSAStartup']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_1519']
xor ['eax,', 'eax']
jmp ['short', 'loc_1543']
movzx ['edx,', 'ds:_wsadata']
and ['edx,', '0FFh']
movzx ['eax,', 'dl']
movzx ['ecx,', 'word', 'ptr', '[ebp+var_4]']
and ['ecx,', '0FFh']
movzx ['edx,', 'cl']
cmp ['eax,', 'edx']
jz ['short', 'loc_153E']
xor ['eax,', 'eax']
jmp ['short', 'loc_1543']
mov ['eax,', '1']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_init        proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '94h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_94]']
mov ['ecx,', '25h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
push ['offset', '$SG86468']
call ['_load_system32_dll']
add ['esp,', '4']
mov ['ds:_winsock_module,', 'eax']
mov ['eax,', 'ds:_winsock_module']
mov ['ds:_winsock2_module,', 'eax']
cmp ['ds:_winsock_module,', '0']
jnz ['short', 'loc_15B0']
push ['offset', '$SG86470']
call ['_load_system32_dll']
add ['esp,', '4']
mov ['ds:_winsock_module,', 'eax']
cmp ['ds:_winsock_module,', '0']
jnz ['short', 'loc_15C6']
push ['offset', '$SG86472']
call ['_fatalbox']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['offset', '$SG86475']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['loc_16CF']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1612']
mov ['esi,', 'esp']
push ['offset', '$SG86478']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', 'eax']
jmp ['short', 'loc_1619']
mov ['[ebp+var_4],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ds:_p_getaddrinfo,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_164A']
mov ['esi,', 'esp']
push ['offset', '$SG86481']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
jmp ['short', 'loc_1651']
mov ['[ebp+var_8],', '0']
mov ['edx,', '[ebp+var_8]']
mov ['ds:_p_freeaddrinfo,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1682']
mov ['esi,', 'esp']
push ['offset', '$SG86484']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_1689']
mov ['[ebp+var_C],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['ds:_p_getnameinfo,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_16BB']
mov ['esi,', 'esp']
push ['offset', '$SG86487']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_10],', 'eax']
jmp ['short', 'loc_16C2']
mov ['[ebp+var_10],', '0']
mov ['eax,', '[ebp+var_10]']
mov ['ds:_p_gai_strerror,', 'eax']
jmp ['loc_17D0']
push ['offset', '$SG86489']
call ['_load_system32_dll']
add ['esp,', '4']
mov ['ds:_wship6_module,', 'eax']
cmp ['ds:_wship6_module,', '0']
jz ['loc_17D0']
cmp ['ds:_wship6_module,', '0']
jz ['short', 'loc_1717']
mov ['esi,', 'esp']
push ['offset', '$SG86493']
mov ['ecx,', 'ds:_wship6_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_14],', 'eax']
jmp ['short', 'loc_171E']
mov ['[ebp+var_14],', '0']
mov ['edx,', '[ebp+var_14]']
mov ['ds:_p_getaddrinfo,', 'edx']
cmp ['ds:_wship6_module,', '0']
jz ['short', 'loc_174F']
mov ['esi,', 'esp']
push ['offset', '$SG86496']
mov ['eax,', 'ds:_wship6_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_18],', 'eax']
jmp ['short', 'loc_1756']
mov ['[ebp+var_18],', '0']
mov ['ecx,', '[ebp+var_18]']
mov ['ds:_p_freeaddrinfo,', 'ecx']
cmp ['ds:_wship6_module,', '0']
jz ['short', 'loc_1788']
mov ['esi,', 'esp']
push ['offset', '$SG86499']
mov ['edx,', 'ds:_wship6_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_1C],', 'eax']
jmp ['short', 'loc_178F']
mov ['[ebp+var_1C],', '0']
mov ['eax,', '[ebp+var_1C]']
mov ['ds:_p_getnameinfo,', 'eax']
cmp ['ds:_wship6_module,', '0']
jz ['short', 'loc_17C0']
mov ['esi,', 'esp']
push ['offset', '$SG86502']
mov ['ecx,', 'ds:_wship6_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_20],', 'eax']
jmp ['short', 'loc_17C7']
mov ['[ebp+var_20],', '0']
mov ['edx,', '[ebp+var_20]']
mov ['ds:_p_gai_strerror,', 'edx']
cmp ['ds:_winsock2_module,', '0']
jz ['short', 'loc_17F8']
mov ['esi,', 'esp']
push ['offset', '$SG86506']
mov ['eax,', 'ds:_winsock2_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_24],', 'eax']
jmp ['short', 'loc_17FF']
mov ['[ebp+var_24],', '0']
mov ['ecx,', '[ebp+var_24]']
mov ['ds:_p_WSAAddressToStringA,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1831']
mov ['esi,', 'esp']
push ['offset', '$SG86509']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_28],', 'eax']
jmp ['short', 'loc_1838']
mov ['[ebp+var_28],', '0']
mov ['eax,', '[ebp+var_28]']
mov ['dword', 'ptr', 'ds:_p_WSAAsyncSelect,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1869']
mov ['esi,', 'esp']
push ['offset', '$SG86512']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_2C],', 'eax']
jmp ['short', 'loc_1870']
mov ['[ebp+var_2C],', '0']
mov ['edx,', '[ebp+var_2C]']
mov ['dword', 'ptr', 'ds:_p_WSAEventSelect,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_18A1']
mov ['esi,', 'esp']
push ['offset', '$SG86515']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_30],', 'eax']
jmp ['short', 'loc_18A8']
mov ['[ebp+var_30],', '0']
mov ['ecx,', '[ebp+var_30]']
mov ['dword', 'ptr', 'ds:_p_select,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_18DA']
mov ['esi,', 'esp']
push ['offset', '$SG86518']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_34],', 'eax']
jmp ['short', 'loc_18E1']
mov ['[ebp+var_34],', '0']
mov ['eax,', '[ebp+var_34]']
mov ['dword', 'ptr', 'ds:_p_WSAGetLastError,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1912']
mov ['esi,', 'esp']
push ['offset', '$SG86521']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_38],', 'eax']
jmp ['short', 'loc_1919']
mov ['[ebp+var_38],', '0']
mov ['edx,', '[ebp+var_38]']
mov ['dword', 'ptr', 'ds:_p_WSAEnumNetworkEvents,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_194A']
mov ['esi,', 'esp']
push ['offset', '$SG86524']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3C],', 'eax']
jmp ['short', 'loc_1951']
mov ['[ebp+var_3C],', '0']
mov ['ecx,', '[ebp+var_3C]']
mov ['ds:_p_WSAStartup,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1983']
mov ['esi,', 'esp']
push ['offset', '$SG86527']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_40],', 'eax']
jmp ['short', 'loc_198A']
mov ['[ebp+var_40],', '0']
mov ['eax,', '[ebp+var_40]']
mov ['ds:_p_WSACleanup,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_19BB']
mov ['esi,', 'esp']
push ['offset', '$SG86530']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_44],', 'eax']
jmp ['short', 'loc_19C2']
mov ['[ebp+var_44],', '0']
mov ['edx,', '[ebp+var_44]']
mov ['ds:_p_closesocket,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_19F3']
mov ['esi,', 'esp']
push ['offset', '$SG86533']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_48],', 'eax']
jmp ['short', 'loc_19FA']
mov ['[ebp+var_48],', '0']
mov ['ecx,', '[ebp+var_48]']
mov ['ds:_p_ntohl,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1A2C']
mov ['esi,', 'esp']
push ['offset', '$SG86536']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4C],', 'eax']
jmp ['short', 'loc_1A33']
mov ['[ebp+var_4C],', '0']
mov ['eax,', '[ebp+var_4C]']
mov ['ds:_p_htonl,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1A64']
mov ['esi,', 'esp']
push ['offset', '$SG86539']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_50],', 'eax']
jmp ['short', 'loc_1A6B']
mov ['[ebp+var_50],', '0']
mov ['edx,', '[ebp+var_50]']
mov ['ds:_p_htons,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1A9C']
mov ['esi,', 'esp']
push ['offset', '$SG86542']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_54],', 'eax']
jmp ['short', 'loc_1AA3']
mov ['[ebp+var_54],', '0']
mov ['ecx,', '[ebp+var_54]']
mov ['ds:_p_ntohs,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1AD5']
mov ['esi,', 'esp']
push ['offset', '$SG86545']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_58],', 'eax']
jmp ['short', 'loc_1ADC']
mov ['[ebp+var_58],', '0']
mov ['eax,', '[ebp+var_58]']
mov ['ds:_p_gethostname,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1B0D']
mov ['esi,', 'esp']
push ['offset', '$SG86548']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_5C],', 'eax']
jmp ['short', 'loc_1B14']
mov ['[ebp+var_5C],', '0']
mov ['edx,', '[ebp+var_5C]']
mov ['ds:_p_gethostbyname,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1B45']
mov ['esi,', 'esp']
push ['offset', '$SG86551']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_60],', 'eax']
jmp ['short', 'loc_1B4C']
mov ['[ebp+var_60],', '0']
mov ['ecx,', '[ebp+var_60]']
mov ['ds:_p_getservbyname,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1B7E']
mov ['esi,', 'esp']
push ['offset', '$SG86554']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_64],', 'eax']
jmp ['short', 'loc_1B85']
mov ['[ebp+var_64],', '0']
mov ['eax,', '[ebp+var_64]']
mov ['ds:_p_inet_addr,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1BB6']
mov ['esi,', 'esp']
push ['offset', '$SG86557']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_68],', 'eax']
jmp ['short', 'loc_1BBD']
mov ['[ebp+var_68],', '0']
mov ['edx,', '[ebp+var_68]']
mov ['ds:_p_inet_ntoa,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1BEE']
mov ['esi,', 'esp']
push ['offset', '$SG86560']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_6C],', 'eax']
jmp ['short', 'loc_1BF5']
mov ['[ebp+var_6C],', '0']
mov ['ecx,', '[ebp+var_6C]']
mov ['ds:_p_connect,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1C27']
mov ['esi,', 'esp']
push ['offset', '$SG86563']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_70],', 'eax']
jmp ['short', 'loc_1C2E']
mov ['[ebp+var_70],', '0']
mov ['eax,', '[ebp+var_70]']
mov ['ds:_p_bind,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1C5F']
mov ['esi,', 'esp']
push ['offset', '$SG86566']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_74],', 'eax']
jmp ['short', 'loc_1C66']
mov ['[ebp+var_74],', '0']
mov ['edx,', '[ebp+var_74]']
mov ['ds:_p_setsockopt,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1C97']
mov ['esi,', 'esp']
push ['offset', '$SG86569']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_78],', 'eax']
jmp ['short', 'loc_1C9E']
mov ['[ebp+var_78],', '0']
mov ['ecx,', '[ebp+var_78]']
mov ['ds:_p_socket,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1CD0']
mov ['esi,', 'esp']
push ['offset', '$SG86572']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_7C],', 'eax']
jmp ['short', 'loc_1CD7']
mov ['[ebp+var_7C],', '0']
mov ['eax,', '[ebp+var_7C]']
mov ['ds:_p_listen,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1D08']
mov ['esi,', 'esp']
push ['offset', '$SG86575']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_80],', 'eax']
jmp ['short', 'loc_1D0F']
mov ['[ebp+var_80],', '0']
mov ['edx,', '[ebp+var_80]']
mov ['ds:_p_send,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1D43']
mov ['esi,', 'esp']
push ['offset', '$SG86578']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_84],', 'eax']
jmp ['short', 'loc_1D4D']
mov ['[ebp+var_84],', '0']
mov ['ecx,', '[ebp+var_84]']
mov ['ds:_p_shutdown,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1D85']
mov ['esi,', 'esp']
push ['offset', '$SG86581']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_88],', 'eax']
jmp ['short', 'loc_1D8F']
mov ['[ebp+var_88],', '0']
mov ['eax,', '[ebp+var_88]']
mov ['ds:_p_ioctlsocket,', 'eax']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1DC6']
mov ['esi,', 'esp']
push ['offset', '$SG86584']
mov ['ecx,', 'ds:_winsock_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8C],', 'eax']
jmp ['short', 'loc_1DD0']
mov ['[ebp+var_8C],', '0']
mov ['edx,', '[ebp+var_8C]']
mov ['ds:_p_accept,', 'edx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1E07']
mov ['esi,', 'esp']
push ['offset', '$SG86587']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_90],', 'eax']
jmp ['short', 'loc_1E11']
mov ['[ebp+var_90],', '0']
mov ['ecx,', '[ebp+var_90]']
mov ['ds:_p_recv,', 'ecx']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1E49']
mov ['esi,', 'esp']
push ['offset', '$SG86590']
mov ['edx,', 'ds:_winsock_module']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__GetProcAddress@8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_94],', 'eax']
jmp ['short', 'loc_1E53']
mov ['[ebp+var_94],', '0']
mov ['eax,', '[ebp+var_94]']
mov ['ds:_p_WSAIoctl,', 'eax']
push ['2']
push ['2']
call ['_sk_startup']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1E9B']
push ['0']
push ['2']
call ['_sk_startup']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1E9B']
push ['1']
push ['1']
call ['_sk_startup']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_1E9B']
push ['offset', '$SG86592']
call ['_fatalbox']
add ['esp,', '4']
push ['offset', '_cmpfortree']
call ['_newtree234']
add ['esp,', '4']
mov ['ds:_sktree,', 'eax']
pop ['edi']
pop ['esi']
add ['esp,', '94h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_cmpfortree     proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[ecx+8]']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', '[ebp+var_C]']
cmp ['eax,', '[ebp+var_10]']
jnb ['short', 'loc_1F0E']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_1F3B']
mov ['ecx,', '[ebp+var_C]']
cmp ['ecx,', '[ebp+var_10]']
jbe ['short', 'loc_1F1D']
mov ['eax,', '1']
jmp ['short', 'loc_1F3B']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ebp+var_8]']
jnb ['short', 'loc_1F2A']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_1F3B']
mov ['eax,', '[ebp+var_4]']
cmp ['eax,', '[ebp+var_8]']
jbe ['short', 'loc_1F39']
mov ['eax,', '1']
jmp ['short', 'loc_1F3B']
xor ['eax,', 'eax']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_cleanup     proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
cmp ['ds:_sktree,', '0']
jz ['short', 'loc_1FC9']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_1F7C']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', 'ds:_sktree']
push ['edx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_1FB0']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['ds:_p_closesocket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_1F73']
mov ['edx,', 'ds:_sktree']
push ['edx']
call ['_freetree234']
add ['esp,', '4']
mov ['ds:_sktree,', '0']
cmp ['ds:_p_WSACleanup,', '0']
jz ['short', 'loc_1FE1']
mov ['esi,', 'esp']
call ['ds:_p_WSACleanup']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['ds:_winsock_module,', '0']
jz ['short', 'loc_1FFF']
mov ['esi,', 'esp']
mov ['eax,', 'ds:_winsock_module']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__FreeLibrary@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['ds:_wship6_module,', '0']
jz ['short', 'loc_201E']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:_wship6_module']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__FreeLibrary@4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_winsock_error_string proc near         
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '30h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_30]']
mov ['ecx,', '0Ch']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'ds:$SG86636']
mov ['dword', 'ptr', '[ebp+Source],', 'eax']
mov ['ecx,', 'ds:dword_994']
mov ['[ebp+var_14],', 'ecx']
mov ['edx,', 'ds:dword_998']
mov ['[ebp+var_10],', 'edx']
mov ['eax,', 'ds:dword_99C']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+dwMessageId]']
mov ['[ebp+var_30],', 'ecx']
mov ['edx,', '[ebp+var_30]']
sub ['edx,', '2714h']
mov ['[ebp+var_30],', 'edx']
cmp ['[ebp+var_30],', '61h']
ja ['$LN41']
mov ['eax,', '[ebp+var_30]']
movzx ['ecx,', 'ds:$LN45[eax]']
jmp ['ds:$LN49[ecx*4]']
mov ['eax,', 'offset', '$SG86643']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86645']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86647']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86649']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86651']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86653']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86655']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86657']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86659']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86661']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86663']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86665']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86667']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86669']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86671']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86673']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86675']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86677']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86679']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86681']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86683']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86685']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86687']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86689']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86691']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86693']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86695']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86697']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86699']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86701']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86703']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86705']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86707']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86709']
jmp ['loc_237E']
mov ['eax,', 'offset', '$SG86711']
jmp ['loc_237E']
cmp ['ds:_errstrings,', '0']
jnz ['short', 'loc_2225']
push ['offset', '_errstring_compare']
call ['_newtree234']
add ['esp,', '4']
mov ['ds:_errstrings,', 'eax']
push ['offset', '_errstring_find']
lea ['edx,', '[ebp+dwMessageId]']
push ['edx']
mov ['eax,', 'ds:_errstrings']
push ['eax']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_20],', 'eax']
cmp ['[ebp+var_20],', '0']
jnz ['loc_2378']
push ['8']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[ebp+var_20]']
mov ['edx,', '[ebp+dwMessageId]']
mov ['[ecx],', 'edx']
mov ['[ebp+var_24],', '1000Fh']
push ['1']
mov ['eax,', '[ebp+var_24]']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_20]']
mov ['[ecx+4],', 'eax']
lea ['edx,', '[ebp+Source]']
push ['edx']
mov ['eax,', '[ebp+var_20]']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
mov ['edx,', '[ebp+var_20]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_28],', 'eax']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+var_24]']
sub ['ecx,', '[ebp+var_28]']
push ['ecx']
mov ['edx,', '[ebp+var_20]']
mov ['eax,', '[edx+4]']
add ['eax,', '[ebp+var_28]']
push ['eax']
push ['400h']
mov ['ecx,', '[ebp+dwMessageId]']
push ['ecx']
push ['0']
push ['1200h']
call ['dword', 'ptr', 'ds:__imp__FormatMessageA@28']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_2303']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:__imp__GetLastError@0']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
mov ['edx,', '[ebp+dwMessageId]']
push ['edx']
push ['offset', '$SG86725']
mov ['eax,', '[ebp+var_20]']
mov ['ecx,', '[eax+4]']
add ['ecx,', '[ebp+var_28]']
push ['ecx']
call ['_sprintf']
add ['esp,', '10h']
jmp ['short', 'loc_233C']
mov ['edx,', '[ebp+var_20]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_2C],', 'eax']
cmp ['[ebp+var_2C],', '0']
jle ['short', 'loc_233C']
mov ['ecx,', '[ebp+var_20]']
mov ['edx,', '[ecx+4]']
mov ['eax,', '[ebp+var_2C]']
movsx ['ecx,', 'byte', 'ptr', '[edx+eax-1]']
cmp ['ecx,', '0Ah']
jnz ['short', 'loc_233C']
mov ['edx,', '[ebp+var_20]']
mov ['eax,', '[edx+4]']
mov ['ecx,', '[ebp+var_2C]']
mov ['byte', 'ptr', '[ecx+eax-1],', '0']
push ['1']
mov ['edx,', '[ebp+var_20]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '1']
push ['eax']
mov ['ecx,', '[ebp+var_20]']
mov ['edx,', '[ecx+4]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_20]']
mov ['[ecx+4],', 'eax']
mov ['edx,', '[ebp+var_20]']
push ['edx']
mov ['eax,', 'ds:_errstrings']
push ['eax']
call ['_add234']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_20]']
mov ['eax,', '[ecx+4]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN48']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '30h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_errstring_find proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx]']
cmp ['ecx,', '[eax]']
jge ['short', 'loc_24ED']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_2502']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx]']
cmp ['ecx,', '[eax]']
jle ['short', 'loc_2500']
mov ['eax,', '1']
jmp ['short', 'loc_2502']
xor ['eax,', 'eax']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_errstring_compare proc near            
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_errstring_find']
add ['esp,', '8']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_namelookup  proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '2070h']
call ['__chkstk']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_2070]']
mov ['ecx,', '81Ch']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
push ['21Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Dst],', 'eax']
cmp ['[ebp+arg_8],', '1']
jnz ['short', 'loc_258B']
mov ['[ebp+var_2060],', '2']
jmp ['short', 'loc_25A0']
xor ['eax,', 'eax']
cmp ['[ebp+arg_8],', '2']
setnz ['al']
sub ['eax,', '1']
and ['eax,', '17h']
mov ['[ebp+var_2060],', 'eax']
mov ['ecx,', '[ebp+var_2060]']
mov ['[ebp+var_2020],', 'ecx']
push ['21Ch']
push ['0']
mov ['edx,', '[ebp+Dst]']
push ['edx']
call ['_memset']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+Dst]']
mov ['dword', 'ptr', '[eax+10h],', '0']
mov ['ecx,', '[ebp+Dst]']
mov ['dword', 'ptr', '[ecx+0Ch],', '0']
mov ['edx,', '[ebp+Dst]']
mov ['dword', 'ptr', '[edx+14h],', '0']
mov ['eax,', '[ebp+Dst]']
mov ['dword', 'ptr', '[eax+8],', '0']
mov ['ecx,', '[ebp+Dst]']
mov ['dword', 'ptr', '[ecx],', '1']
mov ['[ebp+Dest],', '0']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+Source]']
push ['edx']
call ['ds:_p_inet_addr']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '0FFFFFFFFh']
jnz ['loc_29C8']
mov ['[ebp+var_2059],', '0']
mov ['[ebp+var_2024],', '0']
cmp ['ds:_p_getaddrinfo,', '0']
jz ['loc_26DD']
push ['20h']
push ['0']
lea ['eax,', '[ebp+var_204C]']
push ['eax']
call ['_memset']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+var_2020]']
mov ['[ebp+var_2048],', 'ecx']
mov ['[ebp+var_204C],', '2']
mov ['edx,', '[ebp+Source]']
push ['edx']
call ['_host_strduptrim']
add ['esp,', '4']
mov ['[ebp+var_2054],', 'eax']
mov ['eax,', '[ebp+Dst]']
add ['eax,', '10h']
mov ['esi,', 'esp']
push ['eax']
lea ['ecx,', '[ebp+var_204C]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+var_2054]']
push ['edx']
call ['ds:_p_getaddrinfo']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_2059],', '1']
mov ['[ebp+var_2028],', 'eax']
mov ['eax,', '[ebp+var_2054]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+var_2059],', '0']
jnz ['short', 'loc_26C8']
push ['offset', '$LN34_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
cmp ['[ebp+var_2028],', '0']
jnz ['short', 'loc_26DB']
mov ['ecx,', '[ebp+Dst]']
mov ['dword', 'ptr', '[ecx+8],', '1']
jmp ['short', 'loc_2727']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+Source]']
push ['edx']
call ['ds:_p_gethostbyname']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_2024],', 'eax']
cmp ['[ebp+var_2024],', '0']
jz ['short', 'loc_270B']
mov ['eax,', '[ebp+Dst]']
mov ['dword', 'ptr', '[eax+8],', '1']
jmp ['short', 'loc_2727']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_2059],', '1']
mov ['[ebp+var_2028],', 'eax']
mov ['ecx,', '[ebp+Dst]']
cmp ['dword', 'ptr', '[ecx+8],', '0']
jnz ['loc_2849']
cmp ['[ebp+var_2059],', '0']
jnz ['short', 'loc_274A']
push ['offset', '$LN34_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
cmp ['[ebp+var_2028],', '2742h']
jnz ['short', 'loc_2765']
mov ['[ebp+var_2064],', 'offset', '$SG86762']
jmp ['loc_2838']
cmp ['[ebp+var_2059],', '0']
jnz ['short', 'loc_277B']
push ['offset', '$LN34_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
cmp ['[ebp+var_2028],', '2AF9h']
jnz ['short', 'loc_2796']
mov ['[ebp+var_2068],', 'offset', '$SG86763']
jmp ['loc_282C']
cmp ['[ebp+var_2059],', '0']
jnz ['short', 'loc_27AC']
push ['offset', '$LN34_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
cmp ['[ebp+var_2028],', '2AFAh']
jnz ['short', 'loc_27C4']
mov ['[ebp+var_206C],', 'offset', '$SG86764']
jmp ['short', 'loc_2820']
cmp ['ds:_p_getaddrinfo,', '0']
jz ['short', 'loc_280A']
cmp ['ds:_p_gai_strerror,', '0']
jz ['short', 'loc_280A']
cmp ['[ebp+var_2059],', '0']
jnz ['short', 'loc_27EC']
push ['offset', '$LN34_0']
call ['__RTC_UninitUse']
add ['esp,', '4']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_2028]']
push ['edx']
call ['ds:_p_gai_strerror']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_2070],', 'eax']
jmp ['short', 'loc_2814']
mov ['[ebp+var_2070],', 'offset', '$SG86765']
mov ['eax,', '[ebp+var_2070]']
mov ['[ebp+var_206C],', 'eax']
mov ['ecx,', '[ebp+var_206C]']
mov ['[ebp+var_2068],', 'ecx']
mov ['edx,', '[ebp+var_2068]']
mov ['[ebp+var_2064],', 'edx']
mov ['eax,', '[ebp+Dst]']
mov ['ecx,', '[ebp+var_2064]']
mov ['[eax+4],', 'ecx']
jmp ['loc_29C6']
mov ['edx,', '[ebp+Dst]']
mov ['dword', 'ptr', '[edx+4],', '0']
mov ['eax,', '[ebp+Dst]']
cmp ['dword', 'ptr', '[eax+10h],', '0']
jz ['short', 'loc_28CC']
mov ['ecx,', '[ebp+Dst]']
mov ['edx,', '[ecx+10h]']
cmp ['dword', 'ptr', '[edx+4],', '2']
jnz ['short', 'loc_2883']
push ['4']
mov ['eax,', '[ebp+Dst]']
mov ['ecx,', '[eax+10h]']
mov ['edx,', '[ecx+18h]']
add ['edx,', '4']
push ['edx']
lea ['eax,', '[ebp+var_10]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Dst]']
mov ['edx,', '[ecx+10h]']
cmp ['dword', 'ptr', '[edx+14h],', '0']
jz ['short', 'loc_28AF']
push ['2000h']
mov ['eax,', '[ebp+Dst]']
mov ['ecx,', '[eax+10h]']
mov ['edx,', '[ecx+14h]']
push ['edx']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strncpy']
add ['esp,', '0Ch']
jmp ['short', 'loc_28C7']
push ['2000h']
mov ['ecx,', '[ebp+Source]']
push ['ecx']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strncpy']
add ['esp,', '0Ch']
jmp ['loc_29C6']
mov ['[ebp+var_2058],', '0']
jmp ['short', 'loc_28E7']
mov ['eax,', '[ebp+var_2058]']
add ['eax,', '1']
mov ['[ebp+var_2058],', 'eax']
mov ['ecx,', '[ebp+var_2024]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[ebp+var_2058]']
cmp ['dword', 'ptr', '[edx+eax*4],', '0']
jz ['short', 'loc_28FE']
jmp ['short', 'loc_28D8']
push ['4']
mov ['ecx,', '[ebp+var_2058]']
push ['ecx']
call ['_safemalloc']
add ['esp,', '8']
mov ['edx,', '[ebp+Dst]']
mov ['[edx+14h],', 'eax']
mov ['eax,', '[ebp+Dst]']
mov ['ecx,', '[ebp+var_2058]']
mov ['[eax+18h],', 'ecx']
mov ['[ebp+var_2058],', '0']
jmp ['short', 'loc_293C']
mov ['edx,', '[ebp+var_2058]']
add ['edx,', '1']
mov ['[ebp+var_2058],', 'edx']
mov ['eax,', '[ebp+Dst]']
mov ['ecx,', '[ebp+var_2058]']
cmp ['ecx,', '[eax+18h]']
jge ['short', 'loc_298F']
push ['4']
mov ['edx,', '[ebp+var_2024]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[ebp+var_2058]']
mov ['edx,', '[eax+ecx*4]']
push ['edx']
lea ['eax,', '[ebp+var_10]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
call ['ds:_p_ntohl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+Dst]']
mov ['ecx,', '[edx+14h]']
mov ['edx,', '[ebp+var_2058]']
mov ['[ecx+edx*4],', 'eax']
jmp ['short', 'loc_292D']
push ['4']
mov ['eax,', '[ebp+var_2024]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
push ['edx']
lea ['eax,', '[ebp+var_10]']
push ['eax']
call ['_memcpy']
add ['esp,', '0Ch']
push ['2000h']
mov ['ecx,', '[ebp+var_2024]']
mov ['edx,', '[ecx]']
push ['edx']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strncpy']
add ['esp,', '0Ch']
jmp ['short', 'loc_2A21']
push ['4']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+Dst]']
mov ['[ecx+14h],', 'eax']
mov ['edx,', '[ebp+Dst]']
mov ['dword', 'ptr', '[edx+18h],', '1']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_10]']
push ['eax']
call ['ds:_p_ntohl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+Dst]']
mov ['edx,', '[ecx+14h]']
mov ['[edx],', 'eax']
mov ['eax,', '[ebp+Dst]']
mov ['dword', 'ptr', '[eax+8],', '1']
push ['2000h']
mov ['ecx,', '[ebp+Source]']
push ['ecx']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strncpy']
add ['esp,', '0Ch']
mov ['[ebp+var_19],', '0']
push ['1']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
add ['eax,', '1']
push ['eax']
call ['_safemalloc']
add ['esp,', '8']
mov ['ecx,', '[ebp+arg_4]']
mov ['[ecx],', 'eax']
lea ['edx,', '[ebp+Dest]']
push ['edx']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
mov ['eax,', '[ebp+Dst]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN43']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '2070h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_nonamelookup proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['21Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+4],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+8],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0Ch],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+14h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+18h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '1']
push ['200h']
mov ['ecx,', '[ebp+Source]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '1Ch']
push ['edx']
call ['_strncpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['byte', 'ptr', '[eax+21Bh],', '0']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_namedpipe_addr proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['21Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+4],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+8],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+10h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+0Ch],', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+14h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+18h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '1']
push ['200h']
mov ['ecx,', '[ebp+Source]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '1Ch']
push ['edx']
call ['_strncpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['byte', 'ptr', '[eax+21Bh],', '0']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_nextaddr    proc near               
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_4]']
cmp ['dword', 'ptr', '[eax],', '0']
jz ['short', 'loc_2C4C']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx]']
cmp ['dword', 'ptr', '[edx+1Ch],', '0']
jz ['short', 'loc_2C48']
mov ['eax,', '[ebp+arg_4]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ecx+1Ch]']
mov ['[edx],', 'eax']
mov ['eax,', '1']
jmp ['short', 'loc_2C77']
jmp ['short', 'loc_2C4C']
xor ['eax,', 'eax']
jmp ['short', 'loc_2C77']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+4]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_0]']
cmp ['edx,', '[eax+18h]']
jge ['short', 'loc_2C75']
mov ['ecx,', '[ebp+arg_4]']
mov ['edx,', '[ecx+4]']
add ['edx,', '1']
mov ['eax,', '[ebp+arg_4]']
mov ['[eax+4],', 'edx']
mov ['eax,', '1']
jmp ['short', 'loc_2C77']
jmp ['short', 'loc_2C77']
xor ['eax,', 'eax']
pop ['ebp']
retn
endp
_sk_getaddr     proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '34h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_34]']
mov ['ecx,', '0Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
mov ['[ebp+var_C],', 'ecx']
mov ['[ebp+var_8],', '0']
cmp ['[ebp+var_C],', '0']
jz ['loc_2D41']
mov ['[ebp+var_14],', '0']
cmp ['ds:_p_WSAAddressToStringA,', '0']
jz ['short', 'loc_2CEF']
mov ['edx,', '[ebp+Count]']
mov ['[ebp+var_1C],', 'edx']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_1C]']
push ['eax']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
push ['0']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+10h]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+18h]']
push ['edx']
call ['ds:_p_WSAAddressToStringA']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_14],', 'eax']
jmp ['short', 'loc_2CF6']
mov ['[ebp+var_14],', '0FFFFFFFFh']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_2D3C']
mov ['eax,', '[ebp+Count]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '1Ch']
push ['ecx']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strncpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+Dest]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_2D32']
mov ['edx,', '[ebp+Count]']
push ['edx']
push ['offset', '$SG86835']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strncpy']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Dest]']
add ['ecx,', '[ebp+Count]']
mov ['byte', 'ptr', '[ecx-1],', '0']
jmp ['loc_2E12']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jnz ['short', 'loc_2D53']
mov ['[ebp+var_30],', '0']
jmp ['short', 'loc_2D71']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_2D64']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+4]']
mov ['[ebp+var_34],', 'ecx']
jmp ['short', 'loc_2D6B']
mov ['[ebp+var_34],', '2']
mov ['edx,', '[ebp+var_34]']
mov ['[ebp+var_30],', 'edx']
cmp ['[ebp+var_30],', '2']
jnz ['short', 'loc_2DF1']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+14h],', '0']
jz ['short', 'loc_2D8B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ecx+18h]']
jl ['short', 'loc_2DA2']
push ['2B3h']
push ['offset', '$SG86840']
push ['offset', '$SG86841']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+eax*4]']
push ['ecx']
call ['ds:_p_htonl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_28],', 'eax']
mov ['edx,', '[ebp+Count]']
push ['edx']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_28]']
push ['eax']
call ['ds:_p_inet_ntoa']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strncpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+Dest]']
add ['edx,', '[ebp+Count]']
mov ['byte', 'ptr', '[edx-1],', '0']
jmp ['short', 'loc_2E12']
mov ['eax,', '[ebp+Count]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '1Ch']
push ['ecx']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strncpy']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+Dest]']
add ['eax,', '[ebp+Count]']
mov ['byte', 'ptr', '[eax-1],', '0']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN21_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '34h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_addr_needs_port proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
xor ['ecx,', 'ecx']
cmp ['dword', 'ptr', '[eax+0Ch],', '0']
setz ['cl']
mov ['eax,', 'ecx']
pop ['ebp']
retn
endp
_sk_hostname_is_local proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['offset', '$SG86849']
mov ['eax,', '[ebp+Str1]']
push ['eax']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_2EF1']
push ['offset', '$SG86850']
mov ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_2EF1']
push ['4']
push ['offset', '$SG86851']
mov ['edx,', '[ebp+Str1]']
push ['edx']
call ['_strncmp']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_2EF1']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_2EF8']
mov ['[ebp+var_4],', '1']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_address_is_local proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
mov ['[ebp+var_C],', 'ecx']
mov ['[ebp+var_8],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jnz ['short', 'loc_2F45']
mov ['[ebp+var_24],', '0']
jmp ['short', 'loc_2F63']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_2F56']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+4]']
mov ['[ebp+var_28],', 'ecx']
jmp ['short', 'loc_2F5D']
mov ['[ebp+var_28],', '2']
mov ['edx,', '[ebp+var_28]']
mov ['[ebp+var_24],', 'edx']
mov ['eax,', '[ebp+var_24]']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '17h']
jnz ['short', 'loc_2F8E']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx+18h]']
add ['edx,', '8']
push ['edx']
call ['_IN6_IS_ADDR_LOOPBACK']
add ['esp,', '4']
movzx ['eax,', 'al']
jmp ['loc_3029']
jmp ['loc_3029']
cmp ['[ebp+var_14],', '2']
jnz ['short', 'loc_300A']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_2FB0']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx+4]']
push ['edx']
call ['_ipv4_is_local_addr']
add ['esp,', '4']
jmp ['short', 'loc_3029']
jmp ['short', 'loc_3008']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+14h],', '0']
jz ['short', 'loc_2FC4']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ecx+18h]']
jl ['short', 'loc_2FDB']
push ['2FDh']
push ['offset', '$SG86894']
push ['offset', '$SG86895']
call ['__wassert']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+14h]']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[edx+eax*4]']
push ['ecx']
call ['ds:_p_htonl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_1C],', 'eax']
mov ['edx,', '[ebp+var_1C]']
push ['edx']
call ['_ipv4_is_local_addr']
add ['esp,', '4']
jmp ['short', 'loc_3029']
jmp ['short', 'loc_3029']
cmp ['[ebp+var_14],', '0']
jz ['short', 'loc_3027']
push ['302h']
push ['offset', '$SG86898']
push ['offset', '$SG86899']
call ['__wassert']
add ['esp,', '0Ch']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN19_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_ipv4_is_local_addr proc near           
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['ds:_p_ntohl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
and ['eax,', '0FF000000h']
cmp ['eax,', '7F000000h']
jnz ['short', 'loc_30C3']
mov ['eax,', '1']
jmp ['loc_318C']
cmp ['ds:_n_local_interfaces,', '0']
jnz ['short', 'loc_3141']
mov ['esi,', 'esp']
push ['0']
push ['2']
push ['2']
call ['ds:_p_socket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', 'eax']
cmp ['ds:_p_WSAIoctl,', '0']
jz ['short', 'loc_3132']
mov ['esi,', 'esp']
push ['0']
push ['0']
lea ['ecx,', '[ebp+var_C]']
push ['ecx']
push ['4C0h']
push ['offset', '_local_interfaces']
push ['0']
push ['0']
push ['4004747Fh']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['ds:_p_WSAIoctl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jnz ['short', 'loc_3132']
mov ['eax,', '[ebp+var_C]']
xor ['edx,', 'edx']
mov ['ecx,', '4Ch']
div ['ecx']
mov ['ds:_n_local_interfaces,', 'eax']
jmp ['short', 'loc_3141']
push ['offset', '$SG86871']
push ['0']
call ['_logevent']
add ['esp,', '8']
cmp ['ds:_n_local_interfaces,', '0']
jle ['short', 'loc_318A']
mov ['[ebp+var_14],', '0']
jmp ['short', 'loc_315C']
mov ['edx,', '[ebp+var_14]']
add ['edx,', '1']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_14]']
cmp ['eax,', 'ds:_n_local_interfaces']
jge ['short', 'loc_318A']
mov ['ecx,', '[ebp+var_14]']
imul ['ecx,', '4Ch']
add ['ecx,', 'offset', 'unk_254']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', '[ebp+var_18]']
mov ['eax,', '[edx+4]']
cmp ['eax,', '[ebp+arg_0]']
jnz ['short', 'loc_3188']
mov ['eax,', '1']
jmp ['short', 'loc_318C']
jmp ['short', 'loc_3153']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN14_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_address_is_special_local proc near
push ['ebp']
mov ['ebp,', 'esp']
xor ['eax,', 'eax']
pop ['ebp']
retn
endp
_sk_addrtype    proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '20h']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_20],', 'eax']
mov ['[ebp+var_1C],', 'eax']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
mov ['[ebp+var_C],', 'ecx']
mov ['[ebp+var_8],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jnz ['short', 'loc_3221']
mov ['[ebp+var_18],', '0']
jmp ['short', 'loc_323F']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_3232']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+4]']
mov ['[ebp+var_1C],', 'ecx']
jmp ['short', 'loc_3239']
mov ['[ebp+var_1C],', '2']
mov ['edx,', '[ebp+var_1C]']
mov ['[ebp+var_18],', 'edx']
mov ['eax,', '[ebp+var_18]']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '2']
jnz ['short', 'loc_3254']
mov ['[ebp+var_20],', '1']
jmp ['short', 'loc_3263']
xor ['ecx,', 'ecx']
cmp ['[ebp+var_14],', '17h']
setnz ['cl']
add ['ecx,', '2']
mov ['[ebp+var_20],', 'ecx']
mov ['eax,', '[ebp+var_20]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_addrcopy    proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
mov ['[ebp+var_C],', 'ecx']
mov ['[ebp+var_8],', '0']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+8],', '0']
jnz ['short', 'loc_32D5']
mov ['[ebp+var_24],', '0']
jmp ['short', 'loc_32F3']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_32E6']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+4]']
mov ['[ebp+var_28],', 'ecx']
jmp ['short', 'loc_32ED']
mov ['[ebp+var_28],', '2']
mov ['edx,', '[ebp+var_28]']
mov ['[ebp+var_24],', 'edx']
mov ['eax,', '[ebp+var_24]']
mov ['[ebp+var_14],', 'eax']
cmp ['[ebp+var_14],', '0']
jnz ['short', 'loc_3316']
push ['321h']
push ['offset', '$SG86916']
push ['offset', '$SG86917']
call ['__wassert']
add ['esp,', '0Ch']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_3379']
cmp ['[ebp+var_14],', '2']
jnz ['short', 'loc_333C']
push ['4']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+18h]']
add ['eax,', '4']
push ['eax']
mov ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
jmp ['short', 'loc_3377']
cmp ['[ebp+var_14],', '17h']
jnz ['short', 'loc_335C']
push ['10h']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx+18h]']
add ['eax,', '8']
push ['eax']
mov ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
jmp ['short', 'loc_3377']
xor ['edx,', 'edx']
jnz ['short', 'loc_3377']
push ['32Bh']
push ['offset', '$SG86928']
push ['offset', '$SG86929']
call ['__wassert']
add ['esp,', '0Ch']
jmp ['short', 'loc_33DB']
cmp ['[ebp+var_14],', '2']
jnz ['short', 'loc_33DB']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+14h],', '0']
jz ['short', 'loc_3393']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[edx+18h]']
jl ['short', 'loc_33AA']
push ['330h']
push ['offset', '$SG86934']
push ['offset', '$SG86935']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_8]']
mov ['edx,', '[eax+ecx*4]']
push ['edx']
call ['ds:_p_htonl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+Src],', 'eax']
push ['4']
lea ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN21_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_addr_free   proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['esi']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
sub ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax],', '0']
jle ['short', 'loc_3447']
jmp ['short', 'loc_3493']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+10h],', '0']
jz ['short', 'loc_346F']
cmp ['ds:_p_freeaddrinfo,', '0']
jz ['short', 'loc_346F']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+10h]']
push ['eax']
call ['ds:_p_freeaddrinfo']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+14h],', '0']
jz ['short', 'loc_3487']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+14h]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
pop ['esi']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
pop ['ebp']
retn
endp
_sk_addr_dup    proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
pop ['ebp']
retn
endp
_sk_tcp_plug    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['[ebp+var_8],', 'edx']
cmp ['[ebp+arg_4],', '0']
jz ['short', 'loc_34FE']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+0Ch],', 'ecx']
mov ['eax,', '[ebp+var_8]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_tcp_flush   proc near               
push ['ebp']
mov ['ebp,', 'esp']
pop ['ebp']
retn
endp
_sk_new         proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['68h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', 'offset', '?fn_table@?1??sk_new@@9@9']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_18]']
mov ['[edx+0Ch],', 'eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '10h']
push ['ecx']
call ['_bufchain_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+1Ch],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+20h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+34h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+48h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+24h],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+28h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+2Ch],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+5Ch],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+64h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+60h],', '0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_C]']
mov ['[eax+38h],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_10]']
mov ['[edx+3Ch],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_14]']
mov ['[ecx+40h],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_8]']
mov ['[eax+44h],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+58h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
mov ['[ecx+4Ch],', 'edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4Ch]']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ecx+10h]']
mov ['[edx+50h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+54h],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+8],', '0FFFFFFFFh']
mov ['[ebp+var_8],', '0']
mov ['eax,', '[ebp+var_4]']
push ['eax']
call ['_try_connect']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_365D']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '50h']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_sk_nextaddr']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_362E']
mov ['eax,', '[ebp+var_4]']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_try_connect    proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8Ch']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_8C]']
mov ['ecx,', '23h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+8],', '0FFFFFFFFh']
jz ['short', 'loc_36D3']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_do_select']
add ['esp,', '8']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['ds:_p_closesocket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['0']
push ['0']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+58h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx]']
call ['edx']
add ['esp,', '18h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4Ch]']
cmp ['dword', 'ptr', '[ecx+8],', '0']
jnz ['short', 'loc_371B']
mov ['[ebp+var_80],', '0']
jmp ['short', 'loc_3748']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+50h],', '0']
jz ['short', 'loc_3735']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_84],', 'edx']
jmp ['short', 'loc_373F']
mov ['[ebp+var_84],', '2']
mov ['eax,', '[ebp+var_84]']
mov ['[ebp+var_80],', 'eax']
mov ['ecx,', '[ebp+var_80]']
mov ['[ebp+var_54],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
mov ['eax,', 'ds:_sktree']
push ['eax']
call ['_del234']
add ['esp,', '8']
mov ['esi,', 'esp']
push ['0']
push ['1']
mov ['ecx,', '[ebp+var_54]']
push ['ecx']
call ['ds:_p_socket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+var_8]']
mov ['[edx+8],', 'eax']
cmp ['[ebp+var_8],', '0FFFFFFFFh']
jnz ['short', 'loc_37B2']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwMessageId],', 'eax']
mov ['ecx,', '[ebp+dwMessageId]']
push ['ecx']
call ['_winsock_error_string']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx+4],', 'eax']
jmp ['$ret$87032']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+38h],', '0']
jz ['short', 'loc_37E5']
mov ['[ebp+var_5C],', '1']
mov ['esi,', 'esp']
push ['4']
lea ['ecx,', '[ebp+var_5C]']
push ['ecx']
push ['100h']
push ['0FFFFh']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['ds:_p_setsockopt']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+3Ch],', '0']
jz ['short', 'loc_3812']
mov ['[ebp+var_68],', '1']
mov ['esi,', 'esp']
push ['4']
lea ['ecx,', '[ebp+var_68]']
push ['ecx']
push ['1']
push ['6']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['ds:_p_setsockopt']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+40h],', '0']
jz ['short', 'loc_3842']
mov ['[ebp+var_74],', '1']
mov ['esi,', 'esp']
push ['4']
lea ['ecx,', '[ebp+var_74]']
push ['ecx']
push ['8']
push ['0FFFFh']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['ds:_p_setsockopt']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+44h],', '0']
jz ['short', 'loc_3856']
mov ['ecx,', '3FFh']
mov ['[ebp+var_50],', 'cx']
jmp ['short', 'loc_385C']
xor ['edx,', 'edx']
mov ['[ebp+var_50],', 'dx']
mov ['eax,', '1']
test ['eax,', 'eax']
jz ['loc_3972']
cmp ['[ebp+var_54],', '17h']
jnz ['short', 'loc_38A2']
push ['1Ch']
push ['0']
lea ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_memset']
add ['esp,', '0Ch']
mov ['edx,', '17h']
mov ['[ebp+Dst],', 'dx']
mov ['esi,', 'esp']
movzx ['eax,', '[ebp+var_50]']
push ['eax']
call ['ds:_p_htons']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_26],', 'ax']
jmp ['short', 'loc_38D7']
mov ['ecx,', '2']
mov ['[ebp+var_40],', 'cx']
mov ['esi,', 'esp']
push ['0']
call ['ds:_p_htonl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3C],', 'eax']
mov ['esi,', 'esp']
movzx ['edx,', '[ebp+var_50]']
push ['edx']
call ['ds:_p_htons']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3E],', 'ax']
cmp ['[ebp+var_54],', '17h']
jnz ['short', 'loc_38E8']
lea ['eax,', '[ebp+Dst]']
mov ['[ebp+var_88],', 'eax']
jmp ['short', 'loc_38F1']
lea ['ecx,', '[ebp+var_40]']
mov ['[ebp+var_88],', 'ecx']
mov ['edx,', '[ebp+var_54]']
sub ['edx,', '17h']
neg ['edx']
sbb ['edx,', 'edx']
and ['edx,', '0FFFFFFF4h']
add ['edx,', '1Ch']
mov ['esi,', 'esp']
push ['edx']
mov ['eax,', '[ebp+var_88]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['ds:_p_bind']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_7C],', 'eax']
cmp ['[ebp+var_7C],', '0FFFFFFFFh']
jz ['short', 'loc_3930']
mov ['[ebp+dwMessageId],', '0']
jmp ['short', 'loc_3972']
jmp ['short', 'loc_394D']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwMessageId],', 'eax']
cmp ['[ebp+dwMessageId],', '2740h']
jz ['short', 'loc_394D']
jmp ['short', 'loc_3972']
movsx ['edx,', '[ebp+var_50]']
test ['edx,', 'edx']
jnz ['short', 'loc_3957']
jmp ['short', 'loc_3972']
mov ['ax,', '[ebp+var_50]']
sub ['ax,', '1']
mov ['[ebp+var_50],', 'ax']
movsx ['ecx,', '[ebp+var_50]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_396D']
jmp ['short', 'loc_3972']
jmp ['loc_385C']
cmp ['[ebp+dwMessageId],', '0']
jz ['short', 'loc_398F']
mov ['edx,', '[ebp+dwMessageId]']
push ['edx']
call ['_winsock_error_string']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+4],', 'eax']
jmp ['$ret$87032']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+50h],', '0']
jz ['loc_3A3E']
cmp ['[ebp+var_54],', '17h']
jnz ['short', 'loc_3A09']
mov ['eax,', '17h']
mov ['[ebp+Dst],', 'ax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_0]']
movzx ['edx,', 'word', 'ptr', '[ecx+58h]']
push ['edx']
call ['ds:_p_htons']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_26],', 'ax']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
mov ['edx,', '[ecx+18h]']
add ['edx,', '8']
mov ['eax,', '[edx]']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[edx+4]']
mov ['[ebp+var_1C],', 'ecx']
mov ['eax,', '[edx+8]']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[edx+0Ch]']
mov ['[ebp+var_14],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_24],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+50h]']
mov ['edx,', '[ecx+18h]']
mov ['eax,', '[edx+18h]']
mov ['[ebp+var_10],', 'eax']
jmp ['short', 'loc_3A3C']
mov ['ecx,', '2']
mov ['[ebp+var_40],', 'cx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+50h]']
mov ['ecx,', '[eax+18h]']
mov ['edx,', '[ecx+4]']
mov ['[ebp+var_3C],', 'edx']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
movzx ['ecx,', 'word', 'ptr', '[eax+58h]']
push ['ecx']
call ['ds:_p_htons']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3E],', 'ax']
jmp ['short', 'loc_3ABB']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4Ch]']
cmp ['dword', 'ptr', '[eax+14h],', '0']
jz ['short', 'loc_3A5B']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4Ch]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+54h]']
cmp ['ecx,', '[edx+18h]']
jl ['short', 'loc_3A72']
push ['420h']
push ['offset', '$SG87070']
push ['offset', '$SG87071']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '2']
mov ['[ebp+var_40],', 'ax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4Ch]']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+54h]']
mov ['edx,', '[edx+14h]']
mov ['esi,', 'esp']
mov ['eax,', '[edx+ecx*4]']
push ['eax']
call ['ds:_p_htonl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3C],', 'eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_0]']
movzx ['edx,', 'word', 'ptr', '[ecx+58h]']
push ['edx']
call ['ds:_p_htons']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3E],', 'ax']
push ['1']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_do_select']
add ['esp,', '8']
mov ['[ebp+var_4C],', 'eax']
cmp ['[ebp+var_4C],', '0']
jz ['short', 'loc_3AE7']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ebp+var_4C]']
mov ['[ecx+4],', 'edx']
mov ['[ebp+dwMessageId],', '1']
jmp ['$ret$87032']
cmp ['[ebp+var_54],', '17h']
jnz ['short', 'loc_3AF8']
lea ['eax,', '[ebp+Dst]']
mov ['[ebp+var_8C],', 'eax']
jmp ['short', 'loc_3B01']
lea ['ecx,', '[ebp+var_40]']
mov ['[ebp+var_8C],', 'ecx']
mov ['edx,', '[ebp+var_54]']
sub ['edx,', '17h']
neg ['edx']
sbb ['edx,', 'edx']
and ['edx,', '0FFFFFFF4h']
add ['edx,', '1Ch']
mov ['esi,', 'esp']
push ['edx']
mov ['eax,', '[ebp+var_8C]']
push ['eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['ds:_p_connect']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '0FFFFFFFFh']
jnz ['short', 'loc_3B62']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwMessageId],', 'eax']
cmp ['[ebp+dwMessageId],', '2733h']
jz ['short', 'loc_3B60']
mov ['edx,', '[ebp+dwMessageId]']
push ['edx']
call ['_winsock_error_string']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+4],', 'eax']
jmp ['short', '$ret$87032']
jmp ['short', 'loc_3B6C']
mov ['edx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[edx+20h],', '1']
mov ['[ebp+dwMessageId],', '0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', 'ds:_sktree']
push ['ecx']
call ['_add234']
add ['esp,', '8']
cmp ['[ebp+dwMessageId],', '0']
jz ['short', 'loc_3BC6']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+dwMessageId]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+58h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
push ['1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx]']
call ['edx']
add ['esp,', '18h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+dwMessageId]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN45_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '8Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_newlistener proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0B0h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_B0]']
mov ['ecx,', '2Ch']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_5C],', '1']
push ['68h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_50],', 'eax']
mov ['eax,', '[ebp+var_50]']
mov ['dword', 'ptr', '[eax],', 'offset', '?fn_table@?1??sk_newlistener@@9@9']
mov ['ecx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['edx,', '[ebp+var_50]']
mov ['eax,', '[ebp+arg_8]']
mov ['[edx+0Ch],', 'eax']
mov ['ecx,', '[ebp+var_50]']
add ['ecx,', '10h']
push ['ecx']
call ['_bufchain_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[edx+20h],', '0']
mov ['eax,', '[ebp+var_50]']
mov ['dword', 'ptr', '[eax+34h],', '0']
mov ['ecx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[ecx+48h],', '0']
mov ['edx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[edx+24h],', '0']
mov ['eax,', '[ebp+var_50]']
mov ['dword', 'ptr', '[eax+28h],', '0']
mov ['ecx,', '[ebp+var_50]']
mov ['edx,', '[ebp+arg_C]']
mov ['[ecx+2Ch],', 'edx']
mov ['eax,', '[ebp+var_50]']
mov ['dword', 'ptr', '[eax+5Ch],', '0']
mov ['ecx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[ecx+64h],', '0']
mov ['edx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[edx+60h],', '0']
mov ['eax,', '[ebp+var_50]']
mov ['dword', 'ptr', '[eax+4Ch],', '0']
cmp ['[ebp+arg_10],', '1']
jnz ['short', 'loc_3D29']
mov ['[ebp+var_AC],', '2']
jmp ['short', 'loc_3D3E']
xor ['ecx,', 'ecx']
cmp ['[ebp+arg_10],', '2']
setnz ['cl']
sub ['ecx,', '1']
and ['ecx,', '17h']
mov ['[ebp+var_AC],', 'ecx']
mov ['edx,', '[ebp+var_AC]']
mov ['[ebp+var_64],', 'edx']
cmp ['[ebp+var_64],', '0']
jnz ['short', 'loc_3D54']
mov ['[ebp+var_64],', '2']
mov ['esi,', 'esp']
push ['0']
push ['1']
mov ['eax,', '[ebp+var_64]']
push ['eax']
call ['ds:_p_socket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_50]']
mov ['edx,', '[ebp+var_8]']
mov ['[ecx+8],', 'edx']
cmp ['[ebp+var_8],', '0FFFFFFFFh']
jnz ['short', 'loc_3DA9']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwMessageId],', 'eax']
mov ['eax,', '[ebp+dwMessageId]']
push ['eax']
call ['_winsock_error_string']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_50]']
mov ['[ecx+4],', 'eax']
mov ['eax,', '[ebp+var_50]']
jmp ['loc_418C']
mov ['edx,', '[ebp+var_50]']
mov ['dword', 'ptr', '[edx+38h],', '0']
mov ['esi,', 'esp']
push ['4']
lea ['eax,', '[ebp+var_5C]']
push ['eax']
push ['4']
push ['0FFFFh']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['ds:_p_setsockopt']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+var_64],', '17h']
jnz ['loc_3F24']
push ['1Ch']
push ['0']
lea ['edx,', '[ebp+Dst]']
push ['edx']
call ['_memset']
add ['esp,', '0Ch']
mov ['eax,', '17h']
mov ['[ebp+Dst],', 'ax']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_3E21']
mov ['ecx,', 'dword', 'ptr', '_in6addr_loopback.u']
mov ['[ebp+var_20],', 'ecx']
mov ['edx,', 'dword', 'ptr', '_in6addr_loopback.u+4']
mov ['[ebp+var_1C],', 'edx']
mov ['eax,', 'dword', 'ptr', '_in6addr_loopback.u+8']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', 'dword', 'ptr', '_in6addr_loopback.u+0Ch']
mov ['[ebp+var_14],', 'ecx']
jmp ['short', 'loc_3E44']
mov ['edx,', 'dword', 'ptr', '_in6addr_any.u']
mov ['[ebp+var_20],', 'edx']
mov ['eax,', 'dword', 'ptr', '_in6addr_any.u+4']
mov ['[ebp+var_1C],', 'eax']
mov ['ecx,', 'dword', 'ptr', '_in6addr_any.u+8']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', 'dword', 'ptr', '_in6addr_any.u+0Ch']
mov ['[ebp+var_14],', 'edx']
cmp ['[ebp+arg_0],', '0']
jz ['loc_3F07']
cmp ['ds:_p_getaddrinfo,', '0']
jz ['loc_3F07']
push ['20h']
push ['0']
lea ['eax,', '[ebp+var_88]']
push ['eax']
call ['_memset']
add ['esp,', '0Ch']
mov ['[ebp+var_84],', '17h']
mov ['[ebp+var_88],', '0']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_host_strduptrim']
add ['esp,', '4']
mov ['[ebp+var_A0],', 'eax']
mov ['esi,', 'esp']
lea ['edx,', '[ebp+var_94]']
push ['edx']
lea ['eax,', '[ebp+var_88]']
push ['eax']
push ['0']
mov ['ecx,', '[ebp+var_A0]']
push ['ecx']
call ['ds:_p_getaddrinfo']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_9C],', 'eax']
mov ['edx,', '[ebp+var_A0]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
cmp ['[ebp+var_9C],', '0']
jnz ['short', 'loc_3F07']
mov ['eax,', '[ebp+var_94]']
cmp ['dword', 'ptr', '[eax+4],', '17h']
jnz ['short', 'loc_3F07']
mov ['ecx,', '[ebp+var_94]']
mov ['edx,', '[ecx+18h]']
add ['edx,', '8']
mov ['eax,', '[edx]']
mov ['[ebp+var_20],', 'eax']
mov ['ecx,', '[edx+4]']
mov ['[ebp+var_1C],', 'ecx']
mov ['eax,', '[edx+8]']
mov ['[ebp+var_18],', 'eax']
mov ['ecx,', '[edx+0Ch]']
mov ['[ebp+var_14],', 'ecx']
mov ['esi,', 'esp']
movzx ['edx,', 'word', 'ptr', '[ebp+arg_4]']
push ['edx']
call ['ds:_p_htons']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_26],', 'ax']
jmp ['loc_3FDF']
mov ['[ebp+var_A4],', '0']
mov ['eax,', '2']
mov ['[ebp+var_40],', 'ax']
cmp ['[ebp+arg_0],', '0']
jz ['short', 'loc_3F8B']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['ds:_p_inet_addr']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3C],', 'eax']
cmp ['[ebp+var_3C],', '0FFFFFFFFh']
jz ['short', 'loc_3F8B']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_3C]']
push ['edx']
call ['ds:_p_ntohl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
and ['eax,', '0FF000000h']
xor ['ecx,', 'ecx']
cmp ['eax,', '7F000000h']
setz ['cl']
mov ['edx,', '[ebp+var_50]']
mov ['[edx+2Ch],', 'ecx']
mov ['[ebp+var_A4],', '1']
cmp ['[ebp+var_A4],', '0']
jnz ['short', 'loc_3FC7']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_3FB3']
mov ['esi,', 'esp']
push ['7F000001h']
call ['ds:_p_htonl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3C],', 'eax']
jmp ['short', 'loc_3FC7']
mov ['esi,', 'esp']
push ['0']
call ['ds:_p_htonl']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3C],', 'eax']
mov ['esi,', 'esp']
movzx ['eax,', 'word', 'ptr', '[ebp+arg_4]']
push ['eax']
call ['ds:_p_htons']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_3E],', 'ax']
cmp ['[ebp+var_64],', '17h']
jnz ['short', 'loc_3FF0']
lea ['ecx,', '[ebp+Dst]']
mov ['[ebp+var_B0],', 'ecx']
jmp ['short', 'loc_3FF9']
lea ['edx,', '[ebp+var_40]']
mov ['[ebp+var_B0],', 'edx']
mov ['eax,', '[ebp+var_64]']
sub ['eax,', '17h']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', '0FFFFFFF4h']
add ['eax,', '1Ch']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+var_B0]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
push ['edx']
call ['ds:_p_bind']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_54],', 'eax']
cmp ['[ebp+var_54],', '0FFFFFFFFh']
jz ['short', 'loc_4036']
mov ['[ebp+dwMessageId],', '0']
jmp ['short', 'loc_4048']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwMessageId],', 'eax']
cmp ['[ebp+dwMessageId],', '0']
jz ['short', 'loc_407B']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['ds:_p_closesocket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+dwMessageId]']
push ['ecx']
call ['_winsock_error_string']
add ['esp,', '4']
mov ['edx,', '[ebp+var_50]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+var_50]']
jmp ['loc_418C']
mov ['esi,', 'esp']
push ['7FFFFFFFh']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['ds:_p_listen']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['eax,', '0FFFFFFFFh']
jnz ['short', 'loc_40D1']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['ds:_p_closesocket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
call ['_winsock_error_string']
add ['esp,', '4']
mov ['edx,', '[ebp+var_50]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+var_50]']
jmp ['loc_418C']
push ['1']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_do_select']
add ['esp,', '8']
mov ['[ebp+var_4C],', 'eax']
cmp ['[ebp+var_4C],', '0']
jz ['short', 'loc_410C']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
call ['ds:_p_closesocket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_50]']
mov ['eax,', '[ebp+var_4C]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+var_50]']
jmp ['loc_418C']
mov ['ecx,', '[ebp+var_50]']
push ['ecx']
mov ['edx,', 'ds:_sktree']
push ['edx']
call ['_add234']
add ['esp,', '8']
cmp ['[ebp+var_64],', '2']
jnz ['short', 'loc_4189']
cmp ['[ebp+arg_10],', '0']
jnz ['short', 'loc_4189']
push ['2']
mov ['eax,', '[ebp+arg_C]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
mov ['edx,', '[ebp+arg_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_sk_newlistener']
add ['esp,', '14h']
mov ['[ebp+var_A8],', 'eax']
cmp ['[ebp+var_A8],', '0']
jz ['short', 'loc_4189']
mov ['ecx,', '[ebp+var_A8]']
cmp ['dword', 'ptr', '[ecx+4],', '0']
jnz ['short', 'loc_417A']
mov ['edx,', '[ebp+var_A8]']
mov ['eax,', '[ebp+var_50]']
mov ['[edx+60h],', 'eax']
mov ['ecx,', '[ebp+var_50]']
mov ['edx,', '[ebp+var_A8]']
mov ['[ecx+64h],', 'edx']
jmp ['short', 'loc_4189']
mov ['eax,', '[ebp+var_A8]']
push ['eax']
call ['_safefree']
add ['esp,', '4']
mov ['eax,', '[ebp+var_50]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN35_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '0B0h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_tcp_close   proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+64h],', '0']
jz ['short', 'loc_4246']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+64h]']
push ['eax']
call ['_sk_tcp_close']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', 'ds:_sktree']
push ['edx']
call ['_del234']
add ['esp,', '8']
push ['0']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['_do_select']
add ['esp,', '8']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['ds:_p_closesocket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+4Ch],', '0']
jz ['short', 'loc_4298']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+4Ch]']
push ['eax']
call ['_sk_addr_free']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_safefree']
add ['esp,', '4']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_try_send       proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '28h']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_28]']
mov ['ecx,', '0Ah']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+34h],', '0']
jnz ['short', 'loc_42F3']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '10h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
test ['eax,', 'eax']
jle ['loc_4490']
mov ['edx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[edx+34h],', '0']
jz ['short', 'loc_4317']
mov ['[ebp+var_24],', '1']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+34h]']
mov ['[ebp+var_1C],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '30h']
mov ['[ebp+var_10],', 'edx']
jmp ['short', 'loc_4335']
mov ['[ebp+var_24],', '0']
lea ['eax,', '[ebp+var_1C]']
push ['eax']
lea ['ecx,', '[ebp+var_10]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '10h']
push ['edx']
call ['_bufchain_prefix']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_24]']
push ['eax']
mov ['ecx,', '[ebp+var_1C]']
push ['ecx']
mov ['edx,', '[ebp+var_10]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['ds:_p_send']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', 'eax']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_noise_ultralight']
add ['esp,', '4']
cmp ['[ebp+var_4],', '0']
jg ['loc_442C']
cmp ['[ebp+var_4],', '0']
jge ['short', 'loc_438A']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_28],', 'eax']
jmp ['short', 'loc_4391']
mov ['[ebp+var_28],', '0']
mov ['eax,', '[ebp+var_28]']
mov ['[ebp+dwMessageId],', 'eax']
cmp ['[ebp+dwMessageId],', '2710h']
jnb ['short', 'loc_43A6']
cmp ['[ebp+var_4],', '0']
jl ['short', 'loc_43AF']
cmp ['[ebp+dwMessageId],', '2733h']
jnz ['short', 'loc_43C0']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+20h],', '0']
jmp ['loc_44BB']
jmp ['short', 'loc_442A']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_43D8']
cmp ['[ebp+dwMessageId],', '2745h']
jz ['short', 'loc_43D8']
cmp ['[ebp+dwMessageId],', '2746h']
jnz ['short', 'loc_43F9']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[ebp+dwMessageId]']
mov ['[edx+5Ch],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '_socket_error_callback']
call ['_queue_toplevel_callback']
add ['esp,', '8']
jmp ['loc_44BB']
jmp ['short', 'loc_442A']
mov ['edx,', '[ebp+dwMessageId]']
push ['edx']
call ['_winsock_error_string']
add ['esp,', '4']
push ['eax']
push ['0']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+dwMessageId]']
push ['eax']
call ['_winsock_error_string']
add ['esp,', '4']
push ['eax']
push ['offset', '$SG87225']
call ['_fatalbox']
add ['esp,', '8']
jmp ['short', 'loc_448B']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+34h],', '0']
jz ['short', 'loc_4478']
mov ['edx,', '[ebp+var_4]']
cmp ['edx,', '[ebp+var_1C]']
jge ['short', 'loc_446C']
mov ['eax,', '[ebp+var_1C]']
sub ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+arg_0]']
lea ['eax,', '[edx+ecx+30h]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
add ['ecx,', '30h']
push ['ecx']
call ['_memmove']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_1C]']
sub ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+arg_0]']
mov ['[eax+34h],', 'edx']
jmp ['short', 'loc_4476']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+34h],', '0']
jmp ['short', 'loc_448B']
mov ['edx,', '[ebp+var_4]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
add ['eax,', '10h']
push ['eax']
call ['_bufchain_consume']
add ['esp,', '8']
jmp ['loc_42D3']
mov ['ecx,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[ecx+48h],', '1']
jnz ['short', 'loc_44BB']
mov ['esi,', 'esp']
push ['1']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['ds:_p_shutdown']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['ecx,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[ecx+48h],', '2']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN27_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
add ['esp,', '28h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_socket_error_callback proc near        
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
push ['0']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', 'ds:_sktree']
push ['edx']
call ['_find234']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['short', 'loc_4540']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+5Ch],', '0']
jnz ['short', 'loc_4542']
jmp ['short', 'loc_457B']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+5Ch]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+5Ch]']
push ['ecx']
call ['_winsock_error_string']
add ['esp,', '4']
push ['eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+4]']
call ['ecx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_tcp_write   proc near               
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+48h],', '0']
jz ['short', 'loc_45BD']
push ['5D3h']
push ['offset', '$SG87242']
push ['offset', '$SG87243']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '10h']
push ['edx']
call ['_bufchain_add']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+20h],', '0']
jz ['short', 'loc_45E9']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
call ['_try_send']
add ['esp,', '4']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '10h']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_tcp_write_oob proc near             
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+48h],', '0']
jz ['short', 'loc_463D']
push ['5E7h']
push ['offset', '$SG87255']
push ['offset', '$SG87256']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '10h']
push ['eax']
call ['_bufchain_clear']
add ['esp,', '4']
cmp ['[ebp+Size],', '1']
jbe ['short', 'loc_4669']
push ['5EDh']
push ['offset', '$SG87258']
push ['offset', '$SG87259']
call ['__wassert']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+Size]']
push ['edx']
mov ['eax,', '[ebp+Src]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '30h']
push ['ecx']
call ['_memcpy']
add ['esp,', '0Ch']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+Size]']
mov ['[edx+34h],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+20h],', '0']
jz ['short', 'loc_469E']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_try_send']
add ['esp,', '4']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+34h]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_tcp_write_eof proc near             
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+48h],', '0']
jz ['short', 'loc_46ED']
push ['5FEh']
push ['offset', '$SG87267']
push ['offset', '$SG87268']
call ['__wassert']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+48h],', '1']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+20h],', '0']
jz ['short', 'loc_470C']
mov ['edx,', '[ebp+var_4]']
push ['edx']
call ['_try_send']
add ['esp,', '4']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_select_result  proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '50E0h']
call ['__chkstk']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_50E0]']
mov ['ecx,', '1438h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_0],', '0']
jnz ['short', 'loc_4757']
mov ['eax,', '1']
jmp ['loc_4E63']
push ['offset', '_cmpforsearch']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', 'ds:_sktree']
push ['ecx']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_501C],', 'eax']
cmp ['[ebp+var_501C],', '0']
jnz ['short', 'loc_4788']
mov ['eax,', '1']
jmp ['loc_4E63']
mov ['edx,', '[ebp+arg_4]']
shr ['edx,', '10h']
and ['edx,', '0FFFFh']
movzx ['eax,', 'dx']
mov ['[ebp+dwMessageId],', 'eax']
cmp ['[ebp+dwMessageId],', '0']
jz ['loc_4890']
mov ['ecx,', '[ebp+var_501C]']
cmp ['dword', 'ptr', '[ecx+4Ch],', '0']
jz ['loc_4840']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+dwMessageId]']
push ['edx']
mov ['eax,', '[ebp+dwMessageId]']
push ['eax']
call ['_winsock_error_string']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+var_501C]']
mov ['edx,', '[ecx+58h]']
push ['edx']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
push ['1']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_501C]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax]']
call ['ecx']
add ['esp,', '18h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_501C]']
cmp ['dword', 'ptr', '[edx+4Ch],', '0']
jz ['short', 'loc_4840']
mov ['eax,', '[ebp+var_501C]']
add ['eax,', '50h']
push ['eax']
mov ['ecx,', '[ebp+var_501C]']
mov ['edx,', '[ecx+4Ch]']
push ['edx']
call ['_sk_nextaddr']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['short', 'loc_4840']
mov ['eax,', '[ebp+var_501C]']
push ['eax']
call ['_try_connect']
add ['esp,', '4']
mov ['[ebp+dwMessageId],', 'eax']
jmp ['short', 'loc_4800']
cmp ['[ebp+dwMessageId],', '0']
jz ['short', 'loc_4886']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+dwMessageId]']
push ['ecx']
mov ['edx,', '[ebp+dwMessageId]']
push ['edx']
call ['_winsock_error_string']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_4E63']
jmp ['short', 'loc_4890']
mov ['eax,', '1']
jmp ['loc_4E63']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
call ['_noise_ultralight']
add ['esp,', '4']
mov ['ecx,', '[ebp+arg_4]']
and ['ecx,', '0FFFFh']
movzx ['edx,', 'cx']
mov ['[ebp+var_50DC],', 'edx']
mov ['eax,', '[ebp+var_50DC]']
sub ['eax,', '1']
mov ['[ebp+var_50DC],', 'eax']
cmp ['[ebp+var_50DC],', '1Fh']
ja ['$LN33_1']
mov ['ecx,', '[ebp+var_50DC]']
movzx ['edx,', 'ds:$LN47_0[ecx]']
jmp ['ds:$LN55[edx*4]']
mov ['eax,', '[ebp+var_501C]']
mov ['dword', 'ptr', '[eax+20h],', '1']
mov ['ecx,', '[ebp+var_501C]']
mov ['dword', 'ptr', '[ecx+1Ch],', '1']
mov ['edx,', '[ebp+var_501C]']
cmp ['dword', 'ptr', '[edx+4Ch],', '0']
jz ['short', 'loc_4923']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+4Ch]']
push ['ecx']
call ['_sk_addr_free']
add ['esp,', '4']
mov ['edx,', '[ebp+var_501C]']
mov ['dword', 'ptr', '[edx+4Ch],', '0']
jmp ['$LN33_1']
mov ['eax,', '[ebp+var_501C]']
cmp ['dword', 'ptr', '[eax+24h],', '0']
jz ['short', 'loc_4946']
mov ['ecx,', '[ebp+var_501C]']
mov ['dword', 'ptr', '[ecx+28h],', '1']
jmp ['$LN33_1']
mov ['edx,', '[ebp+var_501C]']
cmp ['dword', 'ptr', '[edx+38h],', '0']
jz ['short', 'loc_4983']
mov ['[ebp+var_5024],', '1']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_5024]']
push ['eax']
push ['40047307h']
mov ['ecx,', '[ebp+var_501C]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['ds:_p_ioctlsocket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_498D']
mov ['[ebp+var_5024],', '1']
mov ['esi,', 'esp']
push ['0']
push ['5000h']
lea ['eax,', '[ebp+var_5014]']
push ['eax']
mov ['ecx,', '[ebp+var_501C]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['ds:_p_recv']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_noise_ultralight']
add ['esp,', '4']
cmp ['[ebp+var_8],', '0']
jge ['short', 'loc_49E9']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwMessageId],', 'eax']
cmp ['[ebp+dwMessageId],', '2733h']
jnz ['short', 'loc_49E9']
jmp ['$LN33_1']
cmp ['[ebp+var_8],', '0']
jge ['short', 'loc_4A2F']
mov ['esi,', 'esp']
push ['0']
mov ['ecx,', '[ebp+dwMessageId]']
push ['ecx']
mov ['edx,', '[ebp+dwMessageId]']
push ['edx']
call ['_winsock_error_string']
add ['esp,', '4']
push ['eax']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_4E63']
jmp ['short', 'loc_4AAB']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_4A68']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['0']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_4E63']
jmp ['short', 'loc_4AAB']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_8]']
push ['eax']
lea ['ecx,', '[ebp+var_5014]']
push ['ecx']
xor ['edx,', 'edx']
cmp ['[ebp+var_5024],', '0']
setz ['dl']
push ['edx']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_4E63']
jmp ['$LN33_1']
mov ['esi,', 'esp']
push ['1']
push ['5000h']
lea ['eax,', '[ebp+var_5014]']
push ['eax']
mov ['ecx,', '[ebp+var_501C]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['ds:_p_recv']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+var_8]']
push ['eax']
call ['_noise_ultralight']
add ['esp,', '4']
cmp ['[ebp+var_8],', '0']
jg ['short', 'loc_4B4F']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_4AFE']
mov ['[ebp+var_50E0],', 'offset', '$SG87318']
jmp ['short', 'loc_4B1C']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['eax']
call ['_winsock_error_string']
add ['esp,', '4']
mov ['[ebp+var_50E0],', 'eax']
mov ['ecx,', '[ebp+var_50E0]']
mov ['[ebp+var_502C],', 'ecx']
mov ['edx,', '[ebp+var_502C]']
push ['edx']
push ['0']
call ['_logevent']
add ['esp,', '8']
mov ['eax,', '[ebp+var_502C]']
push ['eax']
push ['offset', '$SG87320']
call ['_fatalbox']
add ['esp,', '8']
jmp ['short', 'loc_4B87']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
lea ['edx,', '[ebp+var_5014]']
push ['edx']
push ['2']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_4E63']
jmp ['$LN33_1']
mov ['eax,', '[ebp+var_501C]']
mov ['dword', 'ptr', '[eax+20h],', '1']
mov ['ecx,', '[ebp+var_501C]']
add ['ecx,', '10h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
mov ['edx,', '[ebp+var_501C]']
add ['eax,', '[edx+34h]']
mov ['[ebp+var_5030],', 'eax']
mov ['eax,', '[ebp+var_501C]']
push ['eax']
call ['_try_send']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_501C]']
add ['ecx,', '10h']
push ['ecx']
call ['_bufchain_size']
add ['esp,', '4']
mov ['edx,', '[ebp+var_501C]']
add ['eax,', '[edx+34h]']
mov ['[ebp+var_5034],', 'eax']
mov ['eax,', '[ebp+var_5034]']
cmp ['eax,', '[ebp+var_5030]']
jge ['short', 'loc_4C25']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_5034]']
push ['ecx']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_501C]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+0Ch]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['$LN33_1']
mov ['[ebp+var_C],', '1']
mov ['esi,', 'esp']
push ['0']
push ['5000h']
lea ['edx,', '[ebp+var_5014]']
push ['edx']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['ds:_p_recv']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jge ['short', 'loc_4CC1']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwMessageId],', 'eax']
cmp ['[ebp+dwMessageId],', '2733h']
jnz ['short', 'loc_4C81']
jmp ['loc_4D3E']
mov ['esi,', 'esp']
push ['0']
mov ['edx,', '[ebp+dwMessageId]']
push ['edx']
mov ['eax,', '[ebp+dwMessageId]']
push ['eax']
call ['_winsock_error_string']
add ['esp,', '4']
push ['eax']
mov ['ecx,', '[ebp+var_501C]']
mov ['edx,', '[ecx+0Ch]']
push ['edx']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+0Ch]']
mov ['edx,', '[ecx]']
mov ['eax,', '[edx+4]']
call ['eax']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_4E63']
jmp ['short', 'loc_4D34']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_4D02']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
lea ['edx,', '[ebp+var_5014]']
push ['edx']
push ['0']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+8]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
and ['eax,', '[ebp+var_C]']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_4D34']
mov ['esi,', 'esp']
push ['0']
push ['0']
push ['0']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+0Ch]']
push ['ecx']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx+4]']
call ['edx']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
and ['eax,', '[ebp+var_C]']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_8],', '0']
jg ['loc_4C31']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_4E63']
mov ['[ebp+var_50C4],', '80h']
push ['80h']
push ['0']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset']
add ['esp,', '0Ch']
mov ['[ebp+dwMessageId],', '0']
mov ['esi,', 'esp']
lea ['ecx,', '[ebp+var_50C4]']
push ['ecx']
lea ['edx,', '[ebp+Dst]']
push ['edx']
mov ['eax,', '[ebp+var_501C]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['ds:_p_accept']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_50CC],', 'eax']
cmp ['[ebp+var_50CC],', '0FFFFFFFFh']
jnz ['short', 'loc_4DC3']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwMessageId],', 'eax']
cmp ['[ebp+dwMessageId],', '2AFAh']
jnz ['short', 'loc_4DC3']
jmp ['$LN33_1']
mov ['edx,', '[ebp+var_50CC]']
mov ['[ebp+var_50D4],', 'edx']
movzx ['eax,', '[ebp+Dst]']
cmp ['eax,', '2']
jnz ['short', 'loc_4E12']
mov ['ecx,', '[ebp+var_501C]']
cmp ['dword', 'ptr', '[ecx+2Ch],', '0']
jz ['short', 'loc_4E12']
mov ['edx,', '[ebp+var_50B4]']
push ['edx']
call ['_ipv4_is_local_addr']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_4E12']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_50CC]']
push ['eax']
call ['ds:_p_closesocket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', '$LN33_1']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_50D4]']
push ['ecx']
push ['offset', '_sk_tcp_accept']
mov ['edx,', '[ebp+var_501C]']
mov ['eax,', '[edx+0Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_501C]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+10h]']
call ['ecx']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', '$LN33_1']
mov ['esi,', 'esp']
mov ['edx,', '[ebp+var_50CC]']
push ['edx']
call ['ds:_p_closesocket']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN54']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '50E0h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_cmpforsearch   proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_4]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
mov ['[ebp+var_C],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[ebp+var_C]']
jnb ['short', 'loc_4F79']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_4F8A']
mov ['edx,', '[ebp+var_8]']
cmp ['edx,', '[ebp+var_C]']
jbe ['short', 'loc_4F88']
mov ['eax,', '1']
jmp ['short', 'loc_4F8A']
xor ['eax,', 'eax']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_tcp_accept  proc near               
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
push ['esi']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+dwMessageId],', '0CCCCCCCCh']
push ['68h']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax],', 'offset', '?fn_table@?1??sk_tcp_accept@@9@9']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+4],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+arg_4]']
mov ['[edx+0Ch],', 'eax']
mov ['ecx,', '[ebp+var_C]']
add ['ecx,', '10h']
push ['ecx']
call ['_bufchain_init']
add ['esp,', '4']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+20h],', '1']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+34h],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+48h],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+24h],', '1']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+28h],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+2Ch],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+5Ch],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', '[eax+64h],', '0']
mov ['ecx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[ecx+60h],', '0']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+4Ch],', '0']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[ebp+arg_0]']
mov ['[eax+8],', 'ecx']
mov ['edx,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[edx+8],', '0FFFFFFFFh']
jnz ['short', 'loc_5091']
mov ['esi,', 'esp']
call ['dword', 'ptr', 'ds:_p_WSAGetLastError']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+dwMessageId],', 'eax']
mov ['eax,', '[ebp+dwMessageId]']
push ['eax']
call ['_winsock_error_string']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_C]']
mov ['[ecx+4],', 'eax']
mov ['eax,', '[ebp+var_C]']
jmp ['short', 'loc_50D9']
mov ['edx,', '[ebp+var_C]']
mov ['dword', 'ptr', '[edx+38h],', '0']
push ['1']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['_do_select']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_50C3']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+var_8]']
mov ['[edx+4],', 'eax']
mov ['eax,', '[ebp+var_C]']
jmp ['short', 'loc_50D9']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', 'ds:_sktree']
push ['edx']
call ['_add234']
add ['esp,', '8']
mov ['eax,', '[ebp+var_C]']
pop ['esi']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_addr_error  proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['eax,', '[eax+4]']
pop ['ebp']
retn
endp
_sk_tcp_socket_error proc near          
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+4]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_sk_tcp_set_frozen proc near            
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', '[ebp+arg_0]']
mov ['[ebp+var_4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+24h]']
cmp ['edx,', '[ebp+arg_4]']
jnz ['short', 'loc_5147']
jmp ['short', 'loc_5198']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+arg_4]']
mov ['[eax+24h],', 'ecx']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_518E']
push ['1']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_do_select']
add ['esp,', '8']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+28h],', '0']
jz ['short', 'loc_518E']
mov ['esi,', 'esp']
push ['2']
push ['1']
lea ['edx,', '[ebp+var_C+3]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+8]']
push ['ecx']
call ['ds:_p_recv']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+28h],', '0']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN8_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['esi']
add ['esp,', '10h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_socket_reselect_all proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_5202']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
push ['ecx']
mov ['edx,', 'ds:_sktree']
push ['edx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_523A']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+24h],', '0']
jnz ['short', 'loc_5238']
push ['1']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
push ['edx']
call ['_do_select']
add ['esp,', '8']
jmp ['short', 'loc_51F9']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_first_socket   proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx]']
mov ['[ebp+var_8],', 'edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
add ['ecx,', '1']
mov ['edx,', '[ebp+arg_0]']
mov ['[edx],', 'ecx']
mov ['eax,', '[ebp+var_8]']
push ['eax']
mov ['ecx,', 'ds:_sktree']
push ['ecx']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_52AC']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_52B3']
mov ['[ebp+var_C],', '0FFFFFFFFh']
mov ['eax,', '[ebp+var_C]']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_next_socket    proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_C],', '0CCCCCCCCh']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_8],', 'ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx]']
add ['eax,', '1']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx],', 'eax']
mov ['edx,', '[ebp+var_8]']
push ['edx']
mov ['eax,', 'ds:_sktree']
push ['eax']
call ['_index234']
add ['esp,', '8']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_5322']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
mov ['[ebp+var_C],', 'edx']
jmp ['short', 'loc_5329']
mov ['[ebp+var_C],', '0FFFFFFFFh']
mov ['eax,', '[ebp+var_C]']
add ['esp,', '0Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_socket_writable proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
push ['offset', '_cmpforsearch']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', 'ds:_sktree']
push ['ecx']
call ['_find234']
add ['esp,', '0Ch']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_5384']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '10h']
push ['edx']
call ['_bufchain_size']
add ['esp,', '4']
xor ['ecx,', 'ecx']
test ['eax,', 'eax']
setnle ['cl']
mov ['eax,', 'ecx']
jmp ['short', 'loc_5386']
jmp ['short', 'loc_5386']
xor ['eax,', 'eax']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_net_service_lookup proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
push ['esi']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['esi,', 'esp']
push ['0']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['ds:_p_getservbyname']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_53E4']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+var_4]']
movzx ['edx,', 'word', 'ptr', '[ecx+8]']
push ['edx']
call ['ds:_p_ntohs']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
movzx ['eax,', 'ax']
jmp ['short', 'loc_53E6']
jmp ['short', 'loc_53E6']
xor ['eax,', 'eax']
pop ['esi']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_get_hostname   proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+Str],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '80h']
mov ['[ebp+Str],', '0']
mov ['eax,', '[ebp+var_4]']
shl ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
push ['1']
mov ['ecx,', '[ebp+var_4]']
push ['ecx']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_saferealloc']
add ['esp,', '0Ch']
mov ['[ebp+Str],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_4]']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['ds:_p_gethostname']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jge ['short', 'loc_546C']
mov ['edx,', '[ebp+Str]']
push ['edx']
call ['_safefree']
add ['esp,', '4']
mov ['[ebp+Str],', '0']
jmp ['short', 'loc_5482']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_4]']
sub ['ecx,', '1']
cmp ['eax,', 'ecx']
jnb ['short', 'loc_541F']
mov ['eax,', '[ebp+Str]']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_platform_get_x11_unix_address proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+Dst],', '0CCCCCCCCh']
push ['21Ch']
push ['1']
call ['_safemalloc']
add ['esp,', '8']
mov ['[ebp+Dst],', 'eax']
push ['21Ch']
push ['0']
mov ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+Dst]']
mov ['dword', 'ptr', '[ecx+4],', 'offset', '$SG87431']
mov ['edx,', '[ebp+Dst]']
mov ['dword', 'ptr', '[edx],', '1']
mov ['eax,', '[ebp+Dst]']
add ['esp,', '4']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
_IN6_IS_ADDR_LOOPBACK proc near         
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['eax,', '[ebp+a]']
movzx ['ecx,', 'word', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_5563']
mov ['edx,', '[ebp+a]']
movzx ['eax,', 'word', 'ptr', '[edx+2]']
test ['eax,', 'eax']
jnz ['short', 'loc_5563']
mov ['ecx,', '[ebp+a]']
movzx ['edx,', 'word', 'ptr', '[ecx+4]']
test ['edx,', 'edx']
jnz ['short', 'loc_5563']
mov ['eax,', '[ebp+a]']
movzx ['ecx,', 'word', 'ptr', '[eax+6]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_5563']
mov ['edx,', '[ebp+a]']
movzx ['eax,', 'word', 'ptr', '[edx+8]']
test ['eax,', 'eax']
jnz ['short', 'loc_5563']
mov ['ecx,', '[ebp+a]']
movzx ['edx,', 'word', 'ptr', '[ecx+0Ah]']
test ['edx,', 'edx']
jnz ['short', 'loc_5563']
mov ['eax,', '[ebp+a]']
movzx ['ecx,', 'word', 'ptr', '[eax+0Ch]']
test ['ecx,', 'ecx']
jnz ['short', 'loc_5563']
mov ['edx,', '[ebp+a]']
movzx ['eax,', 'word', 'ptr', '[edx+0Eh]']
cmp ['eax,', '100h']
jnz ['short', 'loc_5563']
mov ['byte', 'ptr', '[ebp+var_4+3],', '1']
jmp ['short', 'loc_5567']
mov ['byte', 'ptr', '[ebp+var_4+3],', '0']
mov ['al,', 'byte', 'ptr', '[ebp+var_4+3]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
