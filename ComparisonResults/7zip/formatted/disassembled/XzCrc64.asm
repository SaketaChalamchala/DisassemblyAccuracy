@Crc64Update@16 proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_8],', 'edx']
mov ['[ebp+var_4],', 'ecx']
mov ['esi,', 'esp']
push ['offset', '_g_Crc64Table']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_4]']
call ['ds:_g_Crc64Update']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['8']
endp
@Crc64Calc@8    proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_8],', '0CCCCCCCCh']
mov ['[ebp+var_4],', '0CCCCCCCCh']
mov ['[ebp+var_8],', 'edx']
mov ['[ebp+var_4],', 'ecx']
mov ['esi,', 'esp']
push ['offset', '_g_Crc64Table']
push ['0FFFFFFFFh']
push ['0FFFFFFFFh']
mov ['edx,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_4]']
call ['ds:_g_Crc64Update']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', '0FFFFFFFFh']
xor ['edx,', '0FFFFFFFFh']
pop ['esi']
add ['esp,', '8']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
@Crc64GenerateTable@0 proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_D0']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '1']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+var_4],', '100h']
jnb ['short', 'loc_153']
mov ['ecx,', '[ebp+var_4]']
xor ['edx,', 'edx']
mov ['[ebp+var_C],', 'ecx']
mov ['[ebp+var_8],', 'edx']
mov ['[ebp+var_10],', '0']
jmp ['short', 'loc_F6']
mov ['eax,', '[ebp+var_10]']
add ['eax,', '1']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '8']
jnb ['short', 'loc_137']
mov ['eax,', '[ebp+var_C]']
mov ['edx,', '[ebp+var_8]']
mov ['cl,', '1']
call ['__aullshr']
mov ['ecx,', '[ebp+var_C]']
and ['ecx,', '1']
mov ['esi,', '[ebp+var_8]']
and ['esi,', '0']
sub ['ecx,', '1']
sbb ['esi,', '0']
not ['ecx']
not ['esi']
and ['ecx,', '0D7870F42h']
and ['esi,', '0C96C5795h']
xor ['eax,', 'ecx']
xor ['edx,', 'esi']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'edx']
jmp ['short', 'loc_ED']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_C]']
mov ['dword', 'ptr', 'ds:_g_Crc64Table[edx*8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
mov ['dword', 'ptr', 'ds:(_g_Crc64Table+4)[edx*8],', 'ecx']
jmp ['loc_C7']
jmp ['short', 'loc_15E']
mov ['edx,', '[ebp+var_4]']
add ['edx,', '1']
mov ['[ebp+var_4],', 'edx']
cmp ['[ebp+var_4],', '400h']
jnb ['short', 'loc_1C5']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', 'dword', 'ptr', '(_g_Crc64Table-800h)[eax*8]']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', 'dword', 'ptr', '(_g_Crc64Table-7FCh)[eax*8]']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', '[ebp+var_18]']
and ['eax,', '0FFh']
mov ['ecx,', '[ebp+var_14]']
and ['ecx,', '0']
push ['0']
push ['8']
push ['ecx']
push ['eax']
call ['__allmul']
mov ['esi,', 'eax']
mov ['eax,', '[ebp+var_18]']
mov ['edx,', '[ebp+var_14]']
mov ['cl,', '8']
call ['__aullshr']
xor ['eax,', 'dword', 'ptr', 'ds:_g_Crc64Table[esi]']
xor ['edx,', 'dword', 'ptr', 'ds:(_g_Crc64Table+4)[esi]']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', 'ds:_g_Crc64Table[ecx*8],', 'eax']
mov ['dword', 'ptr', 'ds:(_g_Crc64Table+4)[ecx*8],', 'edx']
jmp ['short', 'loc_155']
mov ['ds:_g_Crc64Update,', 'offset', '@XzCrc64UpdateT4@20']
pop ['esi']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
