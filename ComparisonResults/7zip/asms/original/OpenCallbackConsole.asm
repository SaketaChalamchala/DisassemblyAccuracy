; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.40219.01 

	TITLE	C:\workspace\7z1505-src\CPP\7zip\UI\Console\OpenCallbackConsole.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?Open_CheckBreak@COpenCallbackConsole@@UAEJXZ	; COpenCallbackConsole::Open_CheckBreak
EXTRN	__RTC_CheckEsp:PROC
EXTRN	__RTC_Shutdown:PROC
EXTRN	__RTC_InitBase:PROC
;	COMDAT rtc$TMZ
; File c:\workspace\7z1505-src\cpp\7zip\ui\console\opencallbackconsole.cpp
rtc$TMZ	SEGMENT
__RTC_Shutdown.rtc$TMZ DD FLAT:__RTC_Shutdown
rtc$TMZ	ENDS
;	COMDAT rtc$IMZ
rtc$IMZ	SEGMENT
__RTC_InitBase.rtc$IMZ DD FLAT:__RTC_InitBase
; Function compile flags: /Odtp /RTCsu
rtc$IMZ	ENDS
_TEXT	SEGMENT
_this$ = -4						; size = 4
?Open_CheckBreak@COpenCallbackConsole@@UAEJXZ PROC	; COpenCallbackConsole::Open_CheckBreak
; _this$ = ecx
; Line 16
	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR [ebp-4], -858993460		; ccccccccH
	mov	DWORD PTR _this$[ebp], ecx
; Line 17
	call	?CheckBreak2@@YGJXZ			; CheckBreak2
; Line 18
	add	esp, 4
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	0
?Open_CheckBreak@COpenCallbackConsole@@UAEJXZ ENDP	; COpenCallbackConsole::Open_CheckBreak
_TEXT	ENDS
PUBLIC	?TestBreakSignal@NConsoleClose@@YG_NXZ		; NConsoleClose::TestBreakSignal
; Function compile flags: /Odtp /RTCsu
_TEXT	SEGMENT
?CheckBreak2@@YGJXZ PROC				; CheckBreak2
; Line 11
	push	ebp
	mov	ebp, esp
; Line 12
	call	?TestBreakSignal@NConsoleClose@@YG_NXZ	; NConsoleClose::TestBreakSignal
	movzx	eax, al
	neg	eax
	sbb	eax, eax
	and	eax, -2147467260			; 80004004H
; Line 13
	cmp	ebp, esp
	call	__RTC_CheckEsp
	pop	ebp
	ret	0
?CheckBreak2@@YGJXZ ENDP				; CheckBreak2
_TEXT	ENDS
EXTRN	?g_BreakCounter@NConsoleClose@@3IA:DWORD	; NConsoleClose::g_BreakCounter
; Function compile flags: /Odtp /RTCsu
;	COMDAT ?TestBreakSignal@NConsoleClose@@YG_NXZ
_TEXT	SEGMENT
?TestBreakSignal@NConsoleClose@@YG_NXZ PROC		; NConsoleClose::TestBreakSignal, COMDAT
; File c:\workspace\7z1505-src\cpp\7zip\ui\console\consoleclose.h
; Line 11
	push	ebp
	mov	ebp, esp
; Line 15
	xor	eax, eax
	cmp	DWORD PTR ?g_BreakCounter@NConsoleClose@@3IA, 0 ; NConsoleClose::g_BreakCounter
	setne	al
; Line 17
	pop	ebp
	ret	0
?TestBreakSignal@NConsoleClose@@YG_NXZ ENDP		; NConsoleClose::TestBreakSignal
_TEXT	ENDS
PUBLIC	?NeedPercents@COpenCallbackConsole@@IBE_NXZ	; COpenCallbackConsole::NeedPercents
PUBLIC	?Open_SetTotal@COpenCallbackConsole@@UAEJPB_K0@Z ; COpenCallbackConsole::Open_SetTotal
; Function compile flags: /Odtp /RTCsu
_TEXT	SEGMENT
_this$ = -4						; size = 4
_files$ = 8						; size = 4
_bytes$ = 12						; size = 4
?Open_SetTotal@COpenCallbackConsole@@UAEJPB_K0@Z PROC	; COpenCallbackConsole::Open_SetTotal
; _this$ = ecx
; File c:\workspace\7z1505-src\cpp\7zip\ui\console\opencallbackconsole.cpp
; Line 21
	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR [ebp-4], -858993460		; ccccccccH
	mov	DWORD PTR _this$[ebp], ecx
; Line 22
	mov	eax, DWORD PTR _this$[ebp]
	movzx	ecx, BYTE PTR [eax+194]
	test	ecx, ecx
	jne	SHORT $LN6@Open_SetTo
	mov	ecx, DWORD PTR _this$[ebp]
	call	?NeedPercents@COpenCallbackConsole@@IBE_NXZ ; COpenCallbackConsole::NeedPercents
	movzx	edx, al
	test	edx, edx
	je	SHORT $LN6@Open_SetTo
; Line 24
	cmp	DWORD PTR _files$[ebp], 0
	je	SHORT $LN5@Open_SetTo
; Line 26
	mov	eax, DWORD PTR _this$[ebp]
	mov	BYTE PTR [eax+192], 1
; Line 28
	mov	ecx, DWORD PTR _this$[ebp]
	mov	edx, DWORD PTR _files$[ebp]
	mov	eax, DWORD PTR [edx]
	mov	DWORD PTR [ecx+16], eax
	mov	edx, DWORD PTR [edx+4]
	mov	DWORD PTR [ecx+20], edx
; Line 30
	jmp	SHORT $LN4@Open_SetTo
$LN5@Open_SetTo:
; Line 31
	mov	eax, DWORD PTR _this$[ebp]
	mov	BYTE PTR [eax+192], 0
$LN4@Open_SetTo:
; Line 33
	cmp	DWORD PTR _bytes$[ebp], 0
	je	SHORT $LN3@Open_SetTo
; Line 35
	mov	ecx, DWORD PTR _this$[ebp]
	mov	BYTE PTR [ecx+193], 1
; Line 37
	cmp	DWORD PTR _files$[ebp], 0
	jne	SHORT $LN2@Open_SetTo
; Line 38
	mov	edx, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR _bytes$[ebp]
	mov	ecx, DWORD PTR [eax]
	mov	DWORD PTR [edx+16], ecx
	mov	eax, DWORD PTR [eax+4]
	mov	DWORD PTR [edx+20], eax
$LN2@Open_SetTo:
; Line 40
	jmp	SHORT $LN6@Open_SetTo
$LN3@Open_SetTo:
; Line 41
	mov	ecx, DWORD PTR _this$[ebp]
	mov	BYTE PTR [ecx+193], 0
$LN6@Open_SetTo:
; Line 44
	call	?CheckBreak2@@YGJXZ			; CheckBreak2
; Line 45
	add	esp, 4
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	8
?Open_SetTotal@COpenCallbackConsole@@UAEJPB_K0@Z ENDP	; COpenCallbackConsole::Open_SetTotal
; Function compile flags: /Odtp /RTCsu
_TEXT	ENDS
;	COMDAT ?NeedPercents@COpenCallbackConsole@@IBE_NXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?NeedPercents@COpenCallbackConsole@@IBE_NXZ PROC	; COpenCallbackConsole::NeedPercents, COMDAT
; _this$ = ecx
; File c:\workspace\7z1505-src\cpp\7zip\ui\console\opencallbackconsole.h
; Line 25
	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR [ebp-4], -858993460		; ccccccccH
	mov	DWORD PTR _this$[ebp], ecx
	mov	eax, DWORD PTR _this$[ebp]
	xor	ecx, ecx
	cmp	DWORD PTR [eax+172], 0
	setne	cl
	mov	al, cl
	mov	esp, ebp
	pop	ebp
	ret	0
?NeedPercents@COpenCallbackConsole@@IBE_NXZ ENDP	; COpenCallbackConsole::NeedPercents
_TEXT	ENDS
PUBLIC	?Open_SetCompleted@COpenCallbackConsole@@UAEJPB_K0@Z ; COpenCallbackConsole::Open_SetCompleted
EXTRN	?Print@CPercentPrinter@@QAEXXZ:PROC		; CPercentPrinter::Print
; Function compile flags: /Odtp /RTCsu
_TEXT	SEGMENT
_this$ = -4						; size = 4
_files$ = 8						; size = 4
_bytes$ = 12						; size = 4
?Open_SetCompleted@COpenCallbackConsole@@UAEJPB_K0@Z PROC ; COpenCallbackConsole::Open_SetCompleted
; _this$ = ecx
; File c:\workspace\7z1505-src\cpp\7zip\ui\console\opencallbackconsole.cpp
; Line 48
	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR [ebp-4], -858993460		; ccccccccH
	mov	DWORD PTR _this$[ebp], ecx
; Line 49
	mov	eax, DWORD PTR _this$[ebp]
	movzx	ecx, BYTE PTR [eax+194]
	test	ecx, ecx
	jne	SHORT $LN5@Open_SetCo
	mov	ecx, DWORD PTR _this$[ebp]
	call	?NeedPercents@COpenCallbackConsole@@IBE_NXZ ; COpenCallbackConsole::NeedPercents
	movzx	edx, al
	test	edx, edx
	je	SHORT $LN5@Open_SetCo
; Line 51
	cmp	DWORD PTR _files$[ebp], 0
	je	SHORT $LN4@Open_SetCo
; Line 53
	mov	eax, DWORD PTR _this$[ebp]
	mov	ecx, DWORD PTR _files$[ebp]
	mov	edx, DWORD PTR [ecx]
	mov	DWORD PTR [eax+24], edx
	mov	ecx, DWORD PTR [ecx+4]
	mov	DWORD PTR [eax+28], ecx
; Line 54
	mov	edx, DWORD PTR _this$[ebp]
	movzx	eax, BYTE PTR [edx+192]
	test	eax, eax
	je	SHORT $LN4@Open_SetCo
; Line 55
	mov	ecx, DWORD PTR _this$[ebp]
	mov	edx, DWORD PTR _files$[ebp]
	mov	eax, DWORD PTR [edx]
	mov	DWORD PTR [ecx+8], eax
	mov	edx, DWORD PTR [edx+4]
	mov	DWORD PTR [ecx+12], edx
$LN4@Open_SetCo:
; Line 58
	cmp	DWORD PTR _bytes$[ebp], 0
	je	SHORT $LN2@Open_SetCo
; Line 60
	mov	eax, DWORD PTR _this$[ebp]
	movzx	ecx, BYTE PTR [eax+192]
	test	ecx, ecx
	jne	SHORT $LN2@Open_SetCo
; Line 61
	mov	edx, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR _bytes$[ebp]
	mov	ecx, DWORD PTR [eax]
	mov	DWORD PTR [edx+8], ecx
	mov	eax, DWORD PTR [eax+4]
	mov	DWORD PTR [edx+12], eax
$LN2@Open_SetCo:
; Line 63
	mov	ecx, DWORD PTR _this$[ebp]
	add	ecx, 8
	call	?Print@CPercentPrinter@@QAEXXZ		; CPercentPrinter::Print
$LN5@Open_SetCo:
; Line 66
	call	?CheckBreak2@@YGJXZ			; CheckBreak2
; Line 67
	add	esp, 4
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	8
?Open_SetCompleted@COpenCallbackConsole@@UAEJPB_K0@Z ENDP ; COpenCallbackConsole::Open_SetCompleted
_TEXT	ENDS
PUBLIC	?ClosePercents@COpenCallbackConsole@@QAEXXZ	; COpenCallbackConsole::ClosePercents
PUBLIC	?Open_Finished@COpenCallbackConsole@@UAEJXZ	; COpenCallbackConsole::Open_Finished
; Function compile flags: /Odtp /RTCsu
_TEXT	SEGMENT
_this$ = -4						; size = 4
?Open_Finished@COpenCallbackConsole@@UAEJXZ PROC	; COpenCallbackConsole::Open_Finished
; _this$ = ecx
; Line 70
	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR [ebp-4], -858993460		; ccccccccH
	mov	DWORD PTR _this$[ebp], ecx
; Line 71
	mov	ecx, DWORD PTR _this$[ebp]
	call	?ClosePercents@COpenCallbackConsole@@QAEXXZ ; COpenCallbackConsole::ClosePercents
; Line 72
	xor	eax, eax
; Line 73
	add	esp, 4
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	0
?Open_Finished@COpenCallbackConsole@@UAEJXZ ENDP	; COpenCallbackConsole::Open_Finished
_TEXT	ENDS
EXTRN	?ClosePrint@CPercentPrinter@@QAEX_N@Z:PROC	; CPercentPrinter::ClosePrint
; Function compile flags: /Odtp /RTCsu
;	COMDAT ?ClosePercents@COpenCallbackConsole@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?ClosePercents@COpenCallbackConsole@@QAEXXZ PROC	; COpenCallbackConsole::ClosePercents, COMDAT
; _this$ = ecx
; File c:\workspace\7z1505-src\cpp\7zip\ui\console\opencallbackconsole.h
; Line 32
	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR [ebp-4], -858993460		; ccccccccH
	mov	DWORD PTR _this$[ebp], ecx
; Line 33
	mov	ecx, DWORD PTR _this$[ebp]
	call	?NeedPercents@COpenCallbackConsole@@IBE_NXZ ; COpenCallbackConsole::NeedPercents
	movzx	eax, al
	test	eax, eax
	je	SHORT $LN2@ClosePerce
; Line 34
	push	1
	mov	ecx, DWORD PTR _this$[ebp]
	add	ecx, 8
	call	?ClosePrint@CPercentPrinter@@QAEX_N@Z	; CPercentPrinter::ClosePrint
$LN2@ClosePerce:
; Line 35
	add	esp, 4
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	0
?ClosePercents@COpenCallbackConsole@@QAEXXZ ENDP	; COpenCallbackConsole::ClosePercents
_TEXT	ENDS
PUBLIC	?StringToBstr@@YGJPB_WPAPA_W@Z			; StringToBstr
PUBLIC	??BUString@@QBEPB_WXZ				; UString::operator wchar_t const *
PUBLIC	??1UString@@QAE@XZ				; UString::~UString
PUBLIC	?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z ; COpenCallbackConsole::Open_CryptoGetTextPassword
EXTRN	??4UString@@QAEAAV0@ABV0@@Z:PROC		; UString::operator=
EXTRN	?GetPassword@@YG?AVUString@@PAVCStdOutStream@@@Z:PROC ; GetPassword
EXTRN	___security_cookie:DWORD
EXTRN	___CxxFrameHandler3:PROC
EXTRN	@__security_check_cookie@4:PROC
xdata$x	SEGMENT
__unwindtable$?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z DD 0ffffffffH
	DD	FLAT:__unwindfunclet$?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z$0
__ehfuncinfo$?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
; Function compile flags: /Odtp /RTCsu
xdata$x	ENDS
_TEXT	SEGMENT
tv87 = -40						; size = 4
tv88 = -36						; size = 4
$T70174 = -32						; size = 12
___result__$69872 = -20					; size = 4
_this$ = -16						; size = 4
__$EHRec$ = -12						; size = 12
_password$ = 8						; size = 4
?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z PROC ; COpenCallbackConsole::Open_CryptoGetTextPassword
; _this$ = ecx
; File c:\workspace\7z1505-src\cpp\7zip\ui\console\opencallbackconsole.cpp
; Line 79
	push	ebp
	mov	ebp, esp
	push	-1
	push	__ehhandler$?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z
	mov	eax, DWORD PTR fs:0
	push	eax
	sub	esp, 28					; 0000001cH
	mov	eax, -858993460				; ccccccccH
	mov	DWORD PTR [ebp-40], eax
	mov	DWORD PTR [ebp-36], eax
	mov	DWORD PTR [ebp-32], eax
	mov	DWORD PTR [ebp-28], eax
	mov	DWORD PTR [ebp-24], eax
	mov	DWORD PTR [ebp-20], eax
	mov	DWORD PTR [ebp-16], eax
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, ebp
	push	eax
	lea	eax, DWORD PTR __$EHRec$[ebp]
	mov	DWORD PTR fs:0, eax
	mov	DWORD PTR _this$[ebp], ecx
; Line 80
	mov	eax, DWORD PTR _password$[ebp]
	mov	DWORD PTR [eax], 0
; Line 81
	call	?CheckBreak2@@YGJXZ			; CheckBreak2
	mov	DWORD PTR ___result__$69872[ebp], eax
	cmp	DWORD PTR ___result__$69872[ebp], 0
	je	SHORT $LN2@Open_Crypt
	mov	eax, DWORD PTR ___result__$69872[ebp]
	jmp	SHORT $LN3@Open_Crypt
$LN2@Open_Crypt:
; Line 83
	mov	ecx, DWORD PTR _this$[ebp]
	movzx	edx, BYTE PTR [ecx+195]
	test	edx, edx
	jne	SHORT $LN1@Open_Crypt
; Line 85
	mov	ecx, DWORD PTR _this$[ebp]
	call	?ClosePercents@COpenCallbackConsole@@QAEXXZ ; COpenCallbackConsole::ClosePercents
; Line 86
	mov	eax, DWORD PTR _this$[ebp]
	mov	ecx, DWORD PTR [eax+184]
	push	ecx
	lea	edx, DWORD PTR $T70174[ebp]
	push	edx
	call	?GetPassword@@YG?AVUString@@PAVCStdOutStream@@@Z ; GetPassword
	mov	DWORD PTR tv88[ebp], eax
	mov	eax, DWORD PTR tv88[ebp]
	mov	DWORD PTR tv87[ebp], eax
	mov	DWORD PTR __$EHRec$[ebp+8], 0
	mov	ecx, DWORD PTR tv87[ebp]
	push	ecx
	mov	ecx, DWORD PTR _this$[ebp]
	add	ecx, 196				; 000000c4H
	call	??4UString@@QAEAAV0@ABV0@@Z		; UString::operator=
	mov	DWORD PTR __$EHRec$[ebp+8], -1
	lea	ecx, DWORD PTR $T70174[ebp]
	call	??1UString@@QAE@XZ			; UString::~UString
; Line 87
	mov	edx, DWORD PTR _this$[ebp]
	mov	BYTE PTR [edx+195], 1
$LN1@Open_Crypt:
; Line 89
	mov	eax, DWORD PTR _password$[ebp]
	push	eax
	mov	ecx, DWORD PTR _this$[ebp]
	add	ecx, 196				; 000000c4H
	call	??BUString@@QBEPB_WXZ			; UString::operator wchar_t const *
	push	eax
	call	?StringToBstr@@YGJPB_WPAPA_W@Z		; StringToBstr
$LN3@Open_Crypt:
; Line 90
	mov	ecx, DWORD PTR __$EHRec$[ebp]
	mov	DWORD PTR fs:0, ecx
	pop	ecx
	add	esp, 40					; 00000028H
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	4
_TEXT	ENDS
text$x	SEGMENT
__unwindfunclet$?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z$0:
	lea	ecx, DWORD PTR $T70174[ebp]
	jmp	??1UString@@QAE@XZ			; UString::~UString
__ehhandler$?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z:
	mov	edx, DWORD PTR [esp+8]
	lea	eax, DWORD PTR [edx+12]
	mov	ecx, DWORD PTR [edx-32]
	xor	ecx, eax
	call	@__security_check_cookie@4
	mov	eax, OFFSET __ehfuncinfo$?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z
	jmp	___CxxFrameHandler3
text$x	ENDS
?Open_CryptoGetTextPassword@COpenCallbackConsole@@UAEJPAPA_W@Z ENDP ; COpenCallbackConsole::Open_CryptoGetTextPassword
EXTRN	??3@YAXPAX@Z:PROC				; operator delete
; Function compile flags: /Odtp /RTCsu
;	COMDAT ??1UString@@QAE@XZ
_TEXT	SEGMENT
$T70186 = -8						; size = 4
_this$ = -4						; size = 4
??1UString@@QAE@XZ PROC					; UString::~UString, COMDAT
; _this$ = ecx
; File c:\workspace\7z1505-src\cpp\common\mystring.h
; Line 470
	push	ebp
	mov	ebp, esp
	sub	esp, 8
	mov	DWORD PTR [ebp-8], -858993460		; ccccccccH
	mov	DWORD PTR [ebp-4], -858993460		; ccccccccH
	mov	DWORD PTR _this$[ebp], ecx
	mov	eax, DWORD PTR _this$[ebp]
	mov	ecx, DWORD PTR [eax]
	mov	DWORD PTR $T70186[ebp], ecx
	mov	edx, DWORD PTR $T70186[ebp]
	push	edx
	call	??3@YAXPAX@Z				; operator delete
	add	esp, 4
	add	esp, 8
	cmp	ebp, esp
	call	__RTC_CheckEsp
	mov	esp, ebp
	pop	ebp
	ret	0
??1UString@@QAE@XZ ENDP					; UString::~UString
; Function compile flags: /Odtp /RTCsu
_TEXT	ENDS
;	COMDAT ??BUString@@QBEPB_WXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??BUString@@QBEPB_WXZ PROC				; UString::operator wchar_t const *, COMDAT
; _this$ = ecx
; Line 476
	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR [ebp-4], -858993460		; ccccccccH
	mov	DWORD PTR _this$[ebp], ecx
	mov	eax, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR [eax]
	mov	esp, ebp
	pop	ebp
	ret	0
??BUString@@QBEPB_WXZ ENDP				; UString::operator wchar_t const *
_TEXT	ENDS
EXTRN	__imp__SysAllocString@4:PROC
; Function compile flags: /Odtp /RTCsu
;	COMDAT ?StringToBstr@@YGJPB_WPAPA_W@Z
_TEXT	SEGMENT
_src$ = 8						; size = 4
_bstr$ = 12						; size = 4
?StringToBstr@@YGJPB_WPAPA_W@Z PROC			; StringToBstr, COMDAT
; File c:\workspace\7z1505-src\cpp\common\mycom.h
; Line 77
	push	ebp
	mov	ebp, esp
	push	esi
; Line 78
	mov	esi, esp
	mov	eax, DWORD PTR _src$[ebp]
	push	eax
	call	DWORD PTR __imp__SysAllocString@4
	cmp	esi, esp
	call	__RTC_CheckEsp
	mov	ecx, DWORD PTR _bstr$[ebp]
	mov	DWORD PTR [ecx], eax
; Line 79
	mov	edx, DWORD PTR _bstr$[ebp]
	mov	eax, DWORD PTR [edx]
	neg	eax
	sbb	eax, eax
	and	eax, 2147024882				; 7ff8fff2H
	add	eax, -2147024882			; 8007000eH
; Line 80
	pop	esi
	cmp	ebp, esp
	call	__RTC_CheckEsp
	pop	ebp
	ret	8
?StringToBstr@@YGJPB_WPAPA_W@Z ENDP			; StringToBstr
_TEXT	ENDS
END
