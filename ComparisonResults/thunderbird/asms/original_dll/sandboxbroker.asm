;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	E6A1F40E1EFB32C9E764F9400E9E5785
; Input	CRC32 :	D1B2BCBF

; File Name   :	C:\compspace\compare\thunderbird\dlls\original\sandboxbroker.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	10000000
; Section 1. (virtual address 00001000)
; Virtual size			: 0001A8FB ( 108795.)
; Section size in file		: 0001AA00 ( 109056.)
; Offset to raw	data for section: 00000400
; Flags	60000020: Text Executable Readable
; Alignment	: default
; PDB File Name	: c:\builds\moz2_slave\tb-rel-c-esr38-w32_bld-0000000\build\objdir-tb\security\sandbox\win\src\sandboxbroker\sandboxbroker.pdb
; OS type	  :  MS	Windows
; Application type:  DLL 32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 10001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_10001000	proc near		; DATA XREF: .rdata:1001C374o
		push	offset sub_1001B8C6 ; _onexit_t
		call	sub_1001AC7F
		pop	ecx
		retn
sub_10001000	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000100C	proc near		; DATA XREF: .rdata:1001C378o
		push	offset sub_1001B8D1 ; _onexit_t
		call	sub_1001AC7F
		pop	ecx
		retn
sub_1000100C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001018	proc near		; DATA XREF: .rdata:1001C37Co
		push	offset sub_1001B8DC ; _onexit_t
		call	sub_1001AC7F
		pop	ecx
		retn
sub_10001018	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001024	proc near		; DATA XREF: .rdata:1001C380o
		mov	ecx, offset CriticalSection ; lpCriticalSection
		call	sub_10004D78
		push	offset sub_1001B8E7 ; _onexit_t
		call	sub_1001AC7F
		pop	ecx
		retn
sub_10001024	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000103A	proc near		; DATA XREF: .rdata:1001C370o
		push	offset sub_1001B8F1 ; _onexit_t
		call	sub_1001AC7F
		pop	ecx
		retn
sub_1000103A	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001050	proc near		; CODE XREF: sub_10001637+43p
					; sub_10002507+B9p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10001072
		cmp	eax, 0FFFFFFFFh
		ja	short loc_1000106C
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10001072

loc_1000106C:				; CODE XREF: sub_10001050+Dj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_10001072:				; CODE XREF: sub_10001050+8j
					; sub_10001050+1Aj
		mov	eax, ecx
		retn
sub_10001050	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10001075(void *)
sub_10001075	proc near		; CODE XREF: sub_100019F3+19p
					; sub_10001A18+11p ...

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, ecx
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [esi],	0
		call	sub_100019DA
		pop	ecx
		push	eax		; size_t
		push	[esp+8+arg_0]	; void *
		mov	ecx, esi
		call	sub_1000183E
		mov	eax, esi
		pop	esi
		retn	4
sub_10001075	endp

; Exported entry   1. ??0SandboxBroker@mozilla@@QAE@ABV01@@Z

; =============== S U B	R O U T	I N E =======================================


; _DWORD __thiscall mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker *this,	const struct mozilla::SandboxBroker *)
		public ??0SandboxBroker@mozilla@@QAE@ABV01@@Z
??0SandboxBroker@mozilla@@QAE@ABV01@@Z proc near ; DATA	XREF: .rdata:off_10030468o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword ptr [ecx], offset	??_7SandboxBroker@mozilla@@6B@ ; const mozilla::SandboxBroker::`vftable'
		mov	eax, [eax+4]
		mov	[ecx+4], eax
		mov	eax, ecx
		retn	4
??0SandboxBroker@mozilla@@QAE@ABV01@@Z endp

; Exported entry   2. ??0SandboxBroker@mozilla@@QAE@XZ

; =============== S U B	R O U T	I N E =======================================


; _DWORD __thiscall mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker *__hidden this)
		public ??0SandboxBroker@mozilla@@QAE@XZ
??0SandboxBroker@mozilla@@QAE@XZ proc near ; DATA XREF:	.rdata:off_10030468o
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	??_7SandboxBroker@mozilla@@6B@ ; const mozilla::SandboxBroker::`vftable'
		mov	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		test	ecx, ecx
		jnz	short loc_100010F3
		call	sub_10015868
		mov	ecx, eax
		mov	?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A, ecx ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		test	ecx, ecx
		jz	short loc_100010F3
		mov	edx, [ecx]
		call	dword ptr [edx]
		mov	ecx, eax
		neg	ecx
		sbb	ecx, ecx
		not	ecx
		and	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		mov	?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A, ecx ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService

loc_100010F3:				; CODE XREF: mozilla::SandboxBroker::SandboxBroker(void)+11j
					; mozilla::SandboxBroker::SandboxBroker(void)+22j
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		mov	[esi+4], eax
		mov	eax, esi
		pop	esi
		retn
??0SandboxBroker@mozilla@@QAE@XZ endp

; Exported entry   3. ??1SandboxBroker@mozilla@@UAE@XZ

; =============== S U B	R O U T	I N E =======================================


; _DWORD __thiscall mozilla::SandboxBroker::~SandboxBroker(mozilla::SandboxBroker *__hidden this)
		public ??1SandboxBroker@mozilla@@UAE@XZ
??1SandboxBroker@mozilla@@UAE@XZ proc near ; CODE XREF:	sub_10001145+1Bp
					; sub_10001145:loc_1000117Cp
					; DATA XREF: ...
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+4]
		mov	dword ptr [esi], offset	??_7SandboxBroker@mozilla@@6B@ ; const mozilla::SandboxBroker::`vftable'
		test	ecx, ecx
		jz	short loc_10001118
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		and	dword ptr [esi+4], 0

loc_10001118:				; CODE XREF: mozilla::SandboxBroker::~SandboxBroker(void)+Ej
		pop	esi
		retn
??1SandboxBroker@mozilla@@UAE@XZ endp

; Exported entry   4. ??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z

; =============== S U B	R O U T	I N E =======================================


; public: class	mozilla::SandboxBroker & __thiscall mozilla::SandboxBroker::operator=(class mozilla::SandboxBroker const &)
		public ??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z
??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z proc near ;	DATA XREF: .rdata:off_10030468o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+4]
		mov	[ecx+4], eax
		mov	eax, ecx
		retn	4
??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z endp


; =============== S U B	R O U T	I N E =======================================


sub_10001129	proc near		; CODE XREF: sub_1000190C+16p

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		mov	eax, [ecx+4]
		cmp	eax, [edx+4]
		jnz	short loc_10001140
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_10001140
		xor	eax, eax
		inc	eax
		jmp	short locret_10001142
; ---------------------------------------------------------------------------

loc_10001140:				; CODE XREF: sub_10001129+Aj
					; sub_10001129+10j
		xor	eax, eax

locret_10001142:			; CODE XREF: sub_10001129+15j
		retn	4
sub_10001129	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10001145(void *, char)
sub_10001145	proc near		; DATA XREF: .rdata:const mozilla::SandboxBroker::`vftable'o

arg_0		= byte ptr  4

		test	[esp+arg_0], 2
		push	esi
		mov	esi, ecx
		jz	short loc_1000117C
		push	ebx
		lea	ebx, [esi-4]
		push	edi
		mov	edi, [ebx]
		lea	esi, [esi+edi*8]
		jmp	short loc_10001165
; ---------------------------------------------------------------------------

loc_1000115B:				; CODE XREF: sub_10001145+21j
		sub	esi, 8
		mov	ecx, esi	; this
		call	??1SandboxBroker@mozilla@@UAE@XZ ; mozilla::SandboxBroker::~SandboxBroker(void)

loc_10001165:				; CODE XREF: sub_10001145+14j
		dec	edi
		jns	short loc_1000115B
		test	[esp+0Ch+arg_0], 1
		jz	short loc_10001176
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10001176:				; CODE XREF: sub_10001145+28j
		pop	edi
		mov	eax, ebx
		pop	ebx
		jmp	short loc_10001191
; ---------------------------------------------------------------------------

loc_1000117C:				; CODE XREF: sub_10001145+8j
		call	??1SandboxBroker@mozilla@@UAE@XZ ; mozilla::SandboxBroker::~SandboxBroker(void)
		test	[esp+4+arg_0], 1
		jz	short loc_1000118F
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1000118F:				; CODE XREF: sub_10001145+41j
		mov	eax, esi

loc_10001191:				; CODE XREF: sub_10001145+35j
		pop	esi
		retn	4
sub_10001145	endp

; [0000001D BYTES: COLLAPSED FUNCTION unknown_libname_1]
; Exported entry   6. ?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AllowDirectory(mozilla::SandboxBroker	*this, const wchar_t *)
		public ?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z
?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z proc	near
					; DATA XREF: .rdata:off_10030468o

arg_0		= dword	ptr  4

		mov	ecx, [ecx+4]
		push	[esp+arg_0]
		push	3
		mov	eax, [ecx]
		push	0
		call	dword ptr [eax+5Ch]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z endp

; Exported entry   7. ?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AllowReadFile(mozilla::SandboxBroker *this, const wchar_t *)
		public ?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z proc near
					; DATA XREF: .rdata:off_10030468o

arg_0		= dword	ptr  4

		mov	ecx, [ecx+4]
		push	[esp+arg_0]
		push	1
		mov	eax, [ecx]
		push	0
		call	dword ptr [eax+5Ch]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z endp

; Exported entry   8. ?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AllowReadWriteFile(mozilla::SandboxBroker *this, const wchar_t *)
		public ?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z proc near
					; DATA XREF: .rdata:off_10030468o

arg_0		= dword	ptr  4

		mov	ecx, [ecx+4]
		push	[esp+arg_0]
		push	0
		mov	eax, [ecx]
		push	0
		call	dword ptr [eax+5Ch]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z endp

; Exported entry   9. ?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; bool __thiscall mozilla::SandboxBroker::LaunchApp(mozilla::SandboxBroker *this, const	wchar_t	*, const wchar_t *, bool, void **)
		public ?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z
?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z proc near
					; DATA XREF: .rdata:off_10030468o

var_10		= dword	ptr -10h
hThread		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A, 0	; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		push	ebx
		push	esi
		mov	ebx, ecx
		jz	short loc_1000127E
		mov	esi, [ebx+4]
		test	esi, esi
		jz	short loc_1000127E
		mov	esi, [esi]
		push	0FFFFFFF5h	; nStdHandle
		call	ds:GetStdHandle
		mov	ecx, [ebx+4]
		push	eax
		call	dword ptr [esi+54h]
		mov	eax, [ebx+4]
		push	0FFFFFFF4h	; nStdHandle
		mov	esi, [eax]
		call	ds:GetStdHandle
		mov	ecx, [ebx+4]
		push	eax
		call	dword ptr [esi+58h]
		cmp	[ebp+arg_8], 0
		jz	short loc_10001248
		push	dword ptr [ebx+4]
		call	sub_10002B24
		pop	ecx

loc_10001248:				; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+43j
		mov	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		lea	edx, [ebp+var_10]
		push	edx
		push	dword ptr [ebx+4]
		push	[ebp+arg_4]
		mov	eax, [ecx]
		push	[ebp+arg_0]
		call	dword ptr [eax+8]
		push	[ebp+hThread]	; hThread
		call	ds:ResumeThread
		push	[ebp+hThread]	; hObject
		call	ds:CloseHandle
		mov	ecx, [ebp+arg_C]
		mov	eax, [ebp+var_10]
		mov	[ecx], eax
		mov	al, 1
		jmp	short loc_10001280
; ---------------------------------------------------------------------------

loc_1000127E:				; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+11j
					; mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void *	*)+18j
		xor	al, al

loc_10001280:				; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+82j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z endp

; Exported entry  11. ?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(mozilla::SandboxBroker *this)
		public ?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ
?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ proc near
					; DATA XREF: .rdata:off_10030468o

var_1		= byte ptr -1
arg_7		= byte ptr  0Bh

		push	ecx
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+4]
		test	ecx, ecx
		jnz	short loc_1000129A
		xor	al, al
		jmp	loc_100014D2
; ---------------------------------------------------------------------------

loc_1000129A:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+9j
		mov	eax, [ecx]
		push	ebx
		push	0
		push	0
		call	dword ptr [eax+14h]
		mov	ecx, [esi+4]
		mov	ebx, eax
		push	0
		neg	ebx
		push	5
		mov	edx, [ecx]
		sbb	bl, bl
		call	dword ptr [edx+8]
		inc	bl
		jz	short loc_100012C7
		test	eax, eax
		jnz	short loc_100012C7
		xor	ebx, ebx
		inc	ebx
		mov	[esp+0Bh], bl
		jmp	short loc_100012CF
; ---------------------------------------------------------------------------

loc_100012C7:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+30j
					; mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+34j
		xor	ebx, ebx
		mov	byte ptr [esp+0Bh], 0
		inc	ebx

loc_100012CF:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+3Dj
		mov	ecx, [esi+4]
		push	ebx
		mov	eax, [ecx]
		call	dword ptr [eax+1Ch]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_100012E7
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_100012EC

loc_100012E7:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+55j
		mov	byte ptr [esp+0Bh], 0

loc_100012EC:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+5Dj
		mov	ecx, [esi+4]
		push	4
		mov	eax, [ecx]
		call	dword ptr [eax+2Ch]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_10001305
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_1000130A

loc_10001305:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+73j
		mov	byte ptr [esp+0Bh], 0

loc_1000130A:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+7Bj
		mov	ecx, [esi+4]
		push	6
		mov	eax, [ecx]
		call	dword ptr [eax+34h]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_10001323
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_10001328

loc_10001323:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+91j
		mov	byte ptr [esp+0Bh], 0

loc_10001328:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+99j
		mov	ecx, [esi+4]
		push	0
		push	67h
		mov	eax, [ecx]
		call	dword ptr [eax+40h]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_10001343
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_10001348

loc_10001343:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+B1j
		mov	byte ptr [esp+0Bh], 0

loc_10001348:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+B9j
		mov	ecx, [esi+4]
		push	ebx
		push	100h
		mov	eax, [ecx]
		call	dword ptr [eax+48h]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_10001365
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_1000136A

loc_10001365:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+D3j
		mov	byte ptr [esp+0Bh], 0

loc_1000136A:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+DBj
		mov	ecx, [esi+4]
		push	offset a??PipeChrome_ ;	"\\??\\pipe\\chrome.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_1000138A
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_1000138F

loc_1000138A:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+F8j
		mov	byte ptr [esp+0Bh], 0

loc_1000138F:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+100j
		mov	ecx, [esi+4]
		push	offset a??PipeGeckoCra ; "\\??\\pipe\\gecko-crash-server-pipe.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_100013AF
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_100013B4

loc_100013AF:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+11Dj
		mov	byte ptr [esp+0Bh], 0

loc_100013B4:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+125j
		mov	ecx, [esi+4]
		push	ebp
		push	edi
		push	offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	eax, [ecx]
		push	0Bh
		pop	edi
		push	edi
		push	3
		pop	ebp
		push	ebp
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_100013DA
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_100013DF

loc_100013DA:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+148j
		mov	[esp+8+arg_7], 0

loc_100013DF:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+150j
		mov	ecx, [esi+4]
		push	offset aHkey_current_0 ; "HKEY_CURRENT_USER\\Control Panel\\Deskt"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_100013FD
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_10001402

loc_100013FD:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+16Bj
		mov	[esp+8+arg_7], 0

loc_10001402:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+173j
		mov	ecx, [esi+4]
		push	offset aHkey_current_1 ; "HKEY_CURRENT_USER\\Control Panel\\Deskt"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_10001420
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_10001425

loc_10001420:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+18Ej
		mov	[esp+8+arg_7], 0

loc_10001425:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+196j
		mov	ecx, [esi+4]
		push	offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_10001443
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_10001448

loc_10001443:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1B1j
		mov	[esp+8+arg_7], 0

loc_10001448:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1B9j
		mov	ecx, [esi+4]
		push	offset aHkey_local_m_0 ; "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_10001466
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_1000146B

loc_10001466:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1D4j
		mov	[esp+8+arg_7], 0

loc_1000146B:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1DCj
		mov	ecx, [esi+4]
		push	offset aHkey_current_2 ; "HKEY_CURRENT_USER\\Software\\Policies\\"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_10001489
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_1000148E

loc_10001489:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1F7j
		mov	[esp+8+arg_7], 0

loc_1000148E:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1FFj
		mov	ecx, [esi+4]
		push	offset aHkey_current_3 ; "HKEY_CURRENT_USER\\Control Panel\\Deskt"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_100014AC
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_100014B1

loc_100014AC:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+21Aj
		mov	[esp+8+arg_7], 0

loc_100014B1:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+222j
		mov	ecx, [esi+4]
		push	offset aHkey_local_m_1 ; "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+14h+var_1], 0
		pop	edi
		pop	ebp
		jz	short loc_100014CD
		test	eax, eax
		jz	short loc_100014CF

loc_100014CD:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+23Fj
		xor	bl, bl

loc_100014CF:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+243j
		mov	al, bl
		pop	ebx

loc_100014D2:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+Dj
		pop	esi
		pop	ecx
		retn
?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ endp

; Exported entry  12. ?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(mozilla::SandboxBroker	*__hidden this)
		public ?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ
?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ proc near
					; DATA XREF: .rdata:off_10030468o
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+4]
		test	ecx, ecx
		jnz	short loc_100014E3
		xor	al, al
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100014E3:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(void)+8j
		mov	eax, [ecx]
		push	ebx
		push	0
		push	5
		call	dword ptr [eax+14h]
		mov	ecx, [esi+4]
		mov	ebx, eax
		push	5
		neg	ebx
		push	5
		mov	eax, [ecx]
		sbb	bl, bl
		call	dword ptr [eax+8]
		inc	bl
		pop	ebx
		jz	short loc_1000150C
		test	eax, eax
		jnz	short loc_1000150C
		mov	al, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000150C:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(void)+2Dj
					; mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(void)+31j
		xor	eax, eax
		pop	esi
		retn
?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ endp

; Exported entry  13. ?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; bool __thiscall mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(mozilla::SandboxBroker *this, int)
		public ?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z
?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z proc near
					; DATA XREF: .rdata:off_10030468o

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+4]
		test	ecx, ecx
		jnz	short loc_10001524
		xor	al, al
		jmp	loc_10001632
; ---------------------------------------------------------------------------

loc_10001524:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+Bj
		cmp	[ebp+arg_0], 2
		mov	eax, [ecx]
		push	ebx
		push	0
		jl	loc_100015C9
		push	4
		call	dword ptr [eax+14h]
		mov	ecx, [esi+4]
		mov	ebx, eax
		neg	ebx
		sbb	bl, bl
		xor	edx, edx
		cmp	[ebp+arg_0], 3
		mov	eax, [ecx]
		setl	dl
		add	edx, 2
		push	edx
		push	5
		call	dword ptr [eax+8]
		inc	bl
		jz	short loc_10001565
		test	eax, eax
		jnz	short loc_10001565
		xor	ebx, ebx
		inc	ebx
		mov	byte ptr [ebp+arg_0+3],	bl
		jmp	short loc_1000156C
; ---------------------------------------------------------------------------

loc_10001565:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+47j
					; mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+4Bj
		xor	ebx, ebx
		mov	byte ptr [ebp+arg_0+3],	0
		inc	ebx

loc_1000156C:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+53j
		mov	ecx, [esi+4]
		push	0
		push	67h
		mov	eax, [ecx]
		call	dword ptr [eax+40h]
		cmp	byte ptr [ebp+arg_0+3],	0
		jz	short loc_10001585
		mov	byte ptr [ebp+arg_0+3],	bl
		test	eax, eax
		jz	short loc_10001589

loc_10001585:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+6Cj
		mov	byte ptr [ebp+arg_0+3],	0

loc_10001589:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+73j
		mov	ecx, [esi+4]
		push	0
		push	100h
		mov	eax, [ecx]
		call	dword ptr [eax+48h]
		cmp	byte ptr [ebp+arg_0+3],	0
		jz	short loc_100015A5
		mov	byte ptr [ebp+arg_0+3],	bl
		test	eax, eax
		jz	short loc_100015A9

loc_100015A5:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+8Cj
		mov	byte ptr [ebp+arg_0+3],	0

loc_100015A9:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+93j
		mov	ecx, [esi+4]
		push	offset a??PipeJpi2_pid ; "\\??\\pipe\\jpi2_pid*_pipe*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	byte ptr [ebp+arg_0+3],	0
		jz	short loc_100015F0
		test	eax, eax
		jnz	short loc_100015F0
		mov	byte ptr [ebp+arg_0+3],	bl
		jmp	short loc_100015F4
; ---------------------------------------------------------------------------

loc_100015C9:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+1Dj
		push	5
		call	dword ptr [eax+14h]
		mov	ecx, [esi+4]
		mov	ebx, eax
		push	4
		neg	ebx
		push	5
		mov	eax, [ecx]
		sbb	bl, bl
		call	dword ptr [eax+8]
		inc	bl
		jz	short loc_100015F0
		test	eax, eax
		jnz	short loc_100015F0
		xor	ebx, ebx
		inc	ebx
		mov	byte ptr [ebp+arg_0+3],	bl
		jmp	short loc_100015F7
; ---------------------------------------------------------------------------

loc_100015F0:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+AEj
					; mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+B2j ...
		mov	byte ptr [ebp+arg_0+3],	0

loc_100015F4:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+B7j
		xor	ebx, ebx
		inc	ebx

loc_100015F7:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+DEj
		mov	ecx, [esi+4]
		push	2
		mov	eax, [ecx]
		call	dword ptr [eax+34h]
		cmp	byte ptr [ebp+arg_0+3],	0
		jz	short loc_1000160E
		mov	byte ptr [ebp+arg_0+3],	bl
		test	eax, eax
		jz	short loc_10001612

loc_1000160E:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+F5j
		mov	byte ptr [ebp+arg_0+3],	0

loc_10001612:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+FCj
		mov	ecx, [esi+4]
		push	offset a??PipeChrome_ ;	"\\??\\pipe\\chrome.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	byte ptr [ebp+arg_0+3],	0
		jz	short loc_1000162D
		test	eax, eax
		jz	short loc_1000162F

loc_1000162D:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+117j
		xor	bl, bl

loc_1000162F:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+11Bj
		mov	al, bl
		pop	ebx

loc_10001632:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+Fj
		pop	esi
		pop	ebp
		retn	4
?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10001637(void *, int, size_t)
sub_10001637	proc near		; CODE XREF: sub_100016CF+1Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	esi, ecx
		or	edi, 0Fh
		cmp	edi, 0FFFFFFFEh
		jbe	short loc_1000164F
		mov	edi, [esp+10h+arg_0]
		jmp	short loc_10001674
; ---------------------------------------------------------------------------

loc_1000164F:				; CODE XREF: sub_10001637+10j
		push	3
		xor	edx, edx
		mov	ebx, [esi+14h]
		mov	eax, edi
		mov	ecx, ebx
		pop	ebp
		div	ebp
		shr	ecx, 1
		cmp	ecx, eax
		jbe	short loc_10001674
		push	0FFFFFFFEh
		pop	eax
		sub	eax, ecx
		cmp	ebx, eax
		ja	short loc_10001671
		lea	edi, [ecx+ebx]
		jmp	short loc_10001674
; ---------------------------------------------------------------------------

loc_10001671:				; CODE XREF: sub_10001637+33j
		push	0FFFFFFFEh
		pop	edi

loc_10001674:				; CODE XREF: sub_10001637+16j
					; sub_10001637+2Aj ...
		lea	eax, [edi+1]
		push	0
		push	eax
		call	sub_10001050
		mov	ebx, [esp+18h+arg_4]
		mov	ebp, eax
		pop	ecx
		pop	ecx
		test	ebx, ebx
		jz	short loc_100016A6
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10001695
		mov	ecx, [esi]
		jmp	short loc_10001697
; ---------------------------------------------------------------------------

loc_10001695:				; CODE XREF: sub_10001637+58j
		mov	ecx, esi

loc_10001697:				; CODE XREF: sub_10001637+5Cj
		test	ebx, ebx
		jz	short loc_100016A6
		push	ebx		; size_t
		push	ecx		; void *
		push	ebp		; void *
		call	memcpy
		add	esp, 0Ch

loc_100016A6:				; CODE XREF: sub_10001637+52j
					; sub_10001637+62j
		push	0		; size_t
		push	1		; char
		mov	ecx, esi	; void *
		call	sub_10001769
		test	esi, esi
		jz	short loc_100016B7
		mov	[esi], ebp

loc_100016B7:				; CODE XREF: sub_10001637+7Cj
		mov	[esi+14h], edi
		mov	[esi+10h], ebx
		cmp	edi, 10h
		jb	short loc_100016C4
		mov	esi, [esi]

loc_100016C4:				; CODE XREF: sub_10001637+89j
		pop	edi
		mov	byte ptr [esi+ebx], 0
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_10001637	endp


; =============== S U B	R O U T	I N E =======================================


sub_100016CF	proc near		; CODE XREF: sub_100017AB+48p
					; sub_1000183E+39p ...

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	esi, 0FFFFFFFEh
		jbe	short loc_100016E4
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100016E4:				; CODE XREF: sub_100016CF+8j
		cmp	[ecx+14h], esi
		jnb	short loc_100016F4
		push	dword ptr [ecx+10h] ; size_t
		push	esi		; int
		call	sub_10001637
		jmp	short loc_10001725
; ---------------------------------------------------------------------------

loc_100016F4:				; CODE XREF: sub_100016CF+18j
		cmp	[esp+4+arg_4], 0
		jz	short loc_10001713
		cmp	esi, 10h
		jnb	short loc_10001713
		mov	eax, [ecx+10h]
		cmp	esi, eax
		jnb	short loc_10001709
		mov	eax, esi

loc_10001709:				; CODE XREF: sub_100016CF+36j
		push	eax		; size_t
		push	1		; char
		call	sub_10001769
		jmp	short loc_10001725
; ---------------------------------------------------------------------------

loc_10001713:				; CODE XREF: sub_100016CF+2Aj
					; sub_100016CF+2Fj
		test	esi, esi
		jnz	short loc_10001725
		and	[ecx+10h], esi
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10001722
		mov	ecx, [ecx]

loc_10001722:				; CODE XREF: sub_100016CF+4Fj
		mov	byte ptr [ecx],	0

loc_10001725:				; CODE XREF: sub_100016CF+23j
					; sub_100016CF+42j ...
		xor	eax, eax
		cmp	eax, esi
		pop	esi
		sbb	eax, eax
		neg	eax
		retn	8
sub_100016CF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001731	proc near		; CODE XREF: sub_1000183E+9p

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		test	edx, edx
		jz	short loc_10001764
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10001743
		mov	eax, [ecx]
		jmp	short loc_10001745
; ---------------------------------------------------------------------------

loc_10001743:				; CODE XREF: sub_10001731+Cj
		mov	eax, ecx

loc_10001745:				; CODE XREF: sub_10001731+10j
		cmp	edx, eax
		jb	short loc_10001764
		cmp	dword ptr [ecx+14h], 10h
		push	esi
		jb	short loc_10001754
		mov	esi, [ecx]
		jmp	short loc_10001756
; ---------------------------------------------------------------------------

loc_10001754:				; CODE XREF: sub_10001731+1Dj
		mov	esi, ecx

loc_10001756:				; CODE XREF: sub_10001731+21j
		mov	eax, [ecx+10h]
		add	eax, esi
		pop	esi
		cmp	eax, edx
		jbe	short loc_10001764
		mov	al, 1
		jmp	short locret_10001766
; ---------------------------------------------------------------------------

loc_10001764:				; CODE XREF: sub_10001731+6j
					; sub_10001731+16j ...
		xor	al, al

locret_10001766:			; CODE XREF: sub_10001731+31j
		retn	4
sub_10001731	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10001769(void *, char, size_t)
sub_10001769	proc near		; CODE XREF: sub_10001637+75p
					; sub_100016CF+3Dp ...

arg_0		= byte ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_0], 0
		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	esi, ecx
		jz	short loc_10001798
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10001798
		push	ebx
		mov	ebx, [esi]
		test	edi, edi
		jz	short loc_10001790
		push	edi		; size_t
		push	ebx		; void *
		push	esi		; void *
		call	memcpy
		add	esp, 0Ch

loc_10001790:				; CODE XREF: sub_10001769+1Aj
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	ebx

loc_10001798:				; CODE XREF: sub_10001769+Dj
					; sub_10001769+13j
		mov	[esi+10h], edi
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [edi+esi], 0
		pop	edi
		pop	esi
		retn	8
sub_10001769	endp


; =============== S U B	R O U T	I N E =======================================


sub_100017AB	proc near		; CODE XREF: sub_1000183E+28p
					; sub_10003AD7+18p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		push	edi
		mov	edi, [ebx+10h]
		mov	esi, ecx
		cmp	edi, ebp
		jnb	short loc_100017CB
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_100017CB:				; CODE XREF: sub_100017AB+13j
		sub	edi, ebp
		cmp	[esp+10h+arg_8], edi
		jnb	short loc_100017D7
		mov	edi, [esp+10h+arg_8]

loc_100017D7:				; CODE XREF: sub_100017AB+26j
		cmp	esi, ebx
		jnz	short loc_100017F0
		lea	eax, [edi+ebp]
		push	eax
		call	sub_1000192D
		push	ebp
		push	0
		mov	ecx, esi
		call	sub_10001959
		jmp	short loc_10001835
; ---------------------------------------------------------------------------

loc_100017F0:				; CODE XREF: sub_100017AB+2Ej
		push	0
		push	edi
		call	sub_100016CF
		test	al, al
		jz	short loc_10001835
		cmp	dword ptr [ebx+14h], 10h
		jb	short loc_10001804
		mov	ebx, [ebx]

loc_10001804:				; CODE XREF: sub_100017AB+55j
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000180E
		mov	ecx, [esi]
		jmp	short loc_10001810
; ---------------------------------------------------------------------------

loc_1000180E:				; CODE XREF: sub_100017AB+5Dj
		mov	ecx, esi

loc_10001810:				; CODE XREF: sub_100017AB+61j
		test	edi, edi
		jz	short loc_10001822
		push	edi		; size_t
		lea	eax, [ebx+ebp]
		push	eax		; void *
		push	ecx		; void *
		call	memcpy
		add	esp, 0Ch

loc_10001822:				; CODE XREF: sub_100017AB+67j
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], edi
		jb	short loc_1000182F
		mov	eax, [esi]
		jmp	short loc_10001831
; ---------------------------------------------------------------------------

loc_1000182F:				; CODE XREF: sub_100017AB+7Ej
		mov	eax, esi

loc_10001831:				; CODE XREF: sub_100017AB+82j
		mov	byte ptr [eax+edi], 0

loc_10001835:				; CODE XREF: sub_100017AB+43j
					; sub_100017AB+4Fj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_100017AB	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000183E(void *, size_t)
sub_1000183E	proc near		; CODE XREF: sub_10001075+22p
					; sub_10001E69+19p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		push	ebx
		mov	esi, ecx
		call	sub_10001731
		test	al, al
		jz	short loc_1000186D
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000185A
		mov	eax, [esi]
		jmp	short loc_1000185C
; ---------------------------------------------------------------------------

loc_1000185A:				; CODE XREF: sub_1000183E+16j
		mov	eax, esi

loc_1000185C:				; CODE XREF: sub_1000183E+1Aj
		push	[esp+8+arg_4]
		sub	ebx, eax
		mov	ecx, esi
		push	ebx
		push	esi
		call	sub_100017AB
		jmp	short loc_100018B1
; ---------------------------------------------------------------------------

loc_1000186D:				; CODE XREF: sub_1000183E+10j
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		mov	ecx, esi
		push	0
		push	edi
		call	sub_100016CF
		test	al, al
		jz	short loc_100018AE
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000188A
		mov	eax, [esi]
		jmp	short loc_1000188C
; ---------------------------------------------------------------------------

loc_1000188A:				; CODE XREF: sub_1000183E+46j
		mov	eax, esi

loc_1000188C:				; CODE XREF: sub_1000183E+4Aj
		test	edi, edi
		jz	short loc_1000189B
		push	edi		; size_t
		push	ebx		; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch

loc_1000189B:				; CODE XREF: sub_1000183E+50j
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], edi
		jb	short loc_100018A8
		mov	eax, [esi]
		jmp	short loc_100018AA
; ---------------------------------------------------------------------------

loc_100018A8:				; CODE XREF: sub_1000183E+64j
		mov	eax, esi

loc_100018AA:				; CODE XREF: sub_1000183E+68j
		mov	byte ptr [eax+edi], 0

loc_100018AE:				; CODE XREF: sub_1000183E+40j
		mov	eax, esi
		pop	edi

loc_100018B1:				; CODE XREF: sub_1000183E+2Dj
		pop	esi
		pop	ebx
		retn	8
sub_1000183E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100018B6	proc near		; DATA XREF: .rdata:1001C46Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	esi
		call	ds:?_Syserror_map@std@@YAPBDH@Z	; std::_Syserror_map(int)
		test	eax, eax
		mov	eax, [esp+8+arg_0]
		pop	ecx
		mov	[eax], esi
		jz	short loc_100018D6
		mov	dword ptr [eax+4], offset off_10033000
		jmp	short loc_100018DD
; ---------------------------------------------------------------------------

loc_100018D6:				; CODE XREF: sub_100018B6+15j
		mov	dword ptr [eax+4], offset off_10033008

loc_100018DD:				; CODE XREF: sub_100018B6+1Ej
		pop	esi
		retn	8
sub_100018B6	endp


; =============== S U B	R O U T	I N E =======================================


sub_100018E1	proc near		; DATA XREF: .rdata:1001C3E8o
					; .rdata:1001C400o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		mov	[eax], edx
		mov	[eax+4], ecx
		retn	8
sub_100018E1	endp


; =============== S U B	R O U T	I N E =======================================


sub_100018F1	proc near		; DATA XREF: .rdata:1001C3ECo
					; .rdata:1001C404o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	ecx, [eax+4]
		jnz	short loc_10001907
		mov	eax, [eax]
		cmp	eax, [esp+arg_4]
		jnz	short loc_10001907
		xor	eax, eax
		inc	eax
		jmp	short locret_10001909
; ---------------------------------------------------------------------------

loc_10001907:				; CODE XREF: sub_100018F1+7j
					; sub_100018F1+Fj
		xor	eax, eax

locret_10001909:			; CODE XREF: sub_100018F1+14j
		retn	8
sub_100018F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000190C	proc near		; DATA XREF: .rdata:1001C3F0o
					; .rdata:1001C408o ...

var_8		= byte ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	[ebp+arg_4]
		mov	eax, [ecx]
		lea	edx, [ebp+var_8]
		push	[ebp+arg_0]
		push	edx
		call	dword ptr [eax+0Ch]
		mov	ecx, eax
		call	sub_10001129
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000190C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000192D	proc near		; CODE XREF: sub_100017AB+34p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	[ecx+10h], eax
		jnb	short loc_10001941
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10001941:				; CODE XREF: sub_1000192D+7j
		cmp	dword ptr [ecx+14h], 10h
		mov	[ecx+10h], eax
		jb	short loc_1000194E
		mov	edx, [ecx]
		jmp	short loc_10001950
; ---------------------------------------------------------------------------

loc_1000194E:				; CODE XREF: sub_1000192D+1Bj
		mov	edx, ecx

loc_10001950:				; CODE XREF: sub_1000192D+1Fj
		mov	byte ptr [edx+eax], 0
		mov	eax, ecx
		retn	4
sub_1000192D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001959	proc near		; CODE XREF: sub_100017AB+3Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, ecx
		mov	ecx, [esp+4+arg_0]
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, ecx
		jnb	short loc_10001973
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10001973:				; CODE XREF: sub_10001959+Dj
		mov	edx, [esp+8+arg_4]
		mov	eax, edi
		sub	eax, ecx
		cmp	eax, edx
		ja	short loc_10001994
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], ecx
		jb	short loc_1000198C
		mov	eax, [esi]
		jmp	short loc_1000198E
; ---------------------------------------------------------------------------

loc_1000198C:				; CODE XREF: sub_10001959+2Dj
		mov	eax, esi

loc_1000198E:				; CODE XREF: sub_10001959+31j
		mov	byte ptr [eax+ecx], 0
		jmp	short loc_100019D3
; ---------------------------------------------------------------------------

loc_10001994:				; CODE XREF: sub_10001959+24j
		test	edx, edx
		jz	short loc_100019D3
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100019A2
		mov	eax, [esi]
		jmp	short loc_100019A4
; ---------------------------------------------------------------------------

loc_100019A2:				; CODE XREF: sub_10001959+43j
		mov	eax, esi

loc_100019A4:				; CODE XREF: sub_10001959+47j
		sub	edi, edx
		push	ebx
		lea	ebx, [eax+ecx]
		mov	eax, edi
		sub	eax, ecx
		jz	short loc_100019BF
		push	eax		; size_t
		lea	eax, [ebx+edx]
		push	eax		; void *
		push	ebx		; void *
		call	ds:memmove
		add	esp, 0Ch

loc_100019BF:				; CODE XREF: sub_10001959+55j
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], edi
		pop	ebx
		jb	short loc_100019CD
		mov	eax, [esi]
		jmp	short loc_100019CF
; ---------------------------------------------------------------------------

loc_100019CD:				; CODE XREF: sub_10001959+6Ej
		mov	eax, esi

loc_100019CF:				; CODE XREF: sub_10001959+72j
		mov	byte ptr [eax+edi], 0

loc_100019D3:				; CODE XREF: sub_10001959+39j
					; sub_10001959+3Dj
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_10001959	endp


; =============== S U B	R O U T	I N E =======================================


sub_100019DA	proc near		; CODE XREF: sub_10001075+15p
					; sub_10001C6D+Dp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	byte ptr [eax],	0
		jnz	short loc_100019E6
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100019E6:				; CODE XREF: sub_100019DA+7j
		lea	edx, [eax+1]

loc_100019E9:				; CODE XREF: sub_100019DA+14j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100019E9
		sub	eax, edx
		retn
sub_100019DA	endp


; =============== S U B	R O U T	I N E =======================================


sub_100019F3	proc near		; CODE XREF: sub_10001A18+1Ep
					; DATA XREF: .rdata:1001C3FCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		call	ds:?_Syserror_map@std@@YAPBDH@Z	; std::_Syserror_map(int)
		pop	ecx
		test	eax, eax
		jnz	short loc_10001A07
		mov	eax, offset aUnknownError ; "unknown error"

loc_10001A07:				; CODE XREF: sub_100019F3+Dj
		mov	ecx, [esp+arg_0]
		push	eax		; void *
		call	sub_10001075
		mov	eax, [esp+arg_0]
		retn	8
sub_100019F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10001A18	proc near		; DATA XREF: .rdata:1001C42Co

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		jnz	short loc_10001A30
		mov	ecx, [ebp+arg_0]
		push	offset aIostreamStream ; "iostream stream error"
		call	sub_10001075
		jmp	short loc_10001A3B
; ---------------------------------------------------------------------------

loc_10001A30:				; CODE XREF: sub_10001A18+7j
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100019F3

loc_10001A3B:				; CODE XREF: sub_10001A18+16j
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn	8
sub_10001A18	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001A42	proc near		; DATA XREF: .rdata:1001C468o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		call	ds:?_Winerror_map@std@@YAPBDH@Z	; std::_Winerror_map(int)
		pop	ecx
		test	eax, eax
		jnz	short loc_10001A56
		mov	eax, offset aUnknownError ; "unknown error"

loc_10001A56:				; CODE XREF: sub_10001A42+Dj
		mov	ecx, [esp+arg_0]
		push	eax		; void *
		call	sub_10001075
		mov	eax, [esp+arg_0]
		retn	8
sub_10001A42	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001A67	proc near		; DATA XREF: .rdata:1001C3F8o
		mov	eax, offset aGeneric ; "generic"
		retn
sub_10001A67	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001A6D	proc near		; DATA XREF: .rdata:1001C428o
		mov	eax, offset aIostream ;	"iostream"
		retn
sub_10001A6D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001A73	proc near		; DATA XREF: .rdata:1001C464o
		mov	eax, offset aSystem ; "system"
		retn
sub_10001A73	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001A79	proc near		; CODE XREF: sub_100033FFj

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	edx, edi
		test	edi, edi
		jle	loc_10001B39
		mov	ebx, [esp+8+arg_0]
		test	ebx, ebx
		jz	loc_10001B39
		push	esi
		mov	esi, edi
		and	esi, 3
		sar	edi, 2
		jmp	short loc_10001AC0
; ---------------------------------------------------------------------------

loc_10001AA0:				; CODE XREF: sub_10001A79+49j
		movzx	eax, word ptr [ebx]
		movzx	ecx, word ptr [ebx+2]
		add	edx, eax
		mov	eax, edx
		add	ebx, 4
		shl	eax, 5
		xor	ecx, eax
		shl	ecx, 0Bh
		xor	edx, ecx
		mov	eax, edx
		shr	eax, 0Bh
		add	edx, eax
		dec	edi

loc_10001AC0:				; CODE XREF: sub_10001A79+25j
		test	edi, edi
		jg	short loc_10001AA0
		dec	esi
		jz	short loc_10001AFA
		dec	esi
		jz	short loc_10001AE7
		dec	esi
		jnz	short loc_10001B0C
		movzx	eax, word ptr [ebx]
		add	edx, eax
		movsx	eax, byte ptr [ebx+2]
		shl	eax, 2
		xor	eax, edx
		shl	eax, 10h
		xor	edx, eax
		mov	eax, edx
		shr	eax, 0Bh
		jmp	short loc_10001B0A
; ---------------------------------------------------------------------------

loc_10001AE7:				; CODE XREF: sub_10001A79+4Fj
		movzx	eax, word ptr [ebx]
		add	edx, eax
		mov	eax, edx
		shl	eax, 0Bh
		xor	edx, eax
		mov	eax, edx
		shr	eax, 11h
		jmp	short loc_10001B0A
; ---------------------------------------------------------------------------

loc_10001AFA:				; CODE XREF: sub_10001A79+4Cj
		movsx	eax, byte ptr [ebx]
		add	edx, eax
		mov	eax, edx
		shl	eax, 0Ah
		xor	edx, eax
		mov	eax, edx
		shr	eax, 1

loc_10001B0A:				; CODE XREF: sub_10001A79+6Cj
					; sub_10001A79+7Fj
		add	edx, eax

loc_10001B0C:				; CODE XREF: sub_10001A79+52j
		mov	eax, edx
		shl	eax, 3
		xor	edx, eax
		mov	eax, edx
		shr	eax, 5
		add	edx, eax
		mov	eax, edx
		shl	eax, 4
		xor	edx, eax
		mov	eax, edx
		shr	eax, 11h
		add	edx, eax
		mov	eax, edx
		shl	eax, 19h
		xor	edx, eax
		mov	eax, edx
		shr	eax, 6
		add	eax, edx
		pop	esi
		jmp	short loc_10001B3B
; ---------------------------------------------------------------------------

loc_10001B39:				; CODE XREF: sub_10001A79+Aj
					; sub_10001A79+16j
		xor	eax, eax

loc_10001B3B:				; CODE XREF: sub_10001A79+BEj
		pop	edi
		pop	ebx
		retn
sub_10001A79	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001B3E	proc near		; CODE XREF: sub_10002039+2Cp

var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_4]
		xor	ebx, ebx
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		mov	ecx, [ebp+10h]
		mov	[esp+18h+arg_4], ecx
		mov	eax, [edi]
		mov	esi, [eax+4]
		cmp	[esi+edi+24h], ebx
		jl	short loc_10001B74
		jg	short loc_10001B68
		cmp	[esi+edi+20h], ebx
		jbe	short loc_10001B74

loc_10001B68:				; CODE XREF: sub_10001B3E+22j
		mov	esi, [esi+edi+20h]
		cmp	esi, ecx
		jbe	short loc_10001B74
		sub	esi, ecx
		jmp	short loc_10001B76
; ---------------------------------------------------------------------------

loc_10001B74:				; CODE XREF: sub_10001B3E+20j
					; sub_10001B3E+28j ...
		xor	esi, esi

loc_10001B76:				; CODE XREF: sub_10001B3E+34j
		push	edi
		lea	ecx, [esp+1Ch+var_8]
		call	sub_10001F97
		cmp	[esp+18h+var_4], bl
		jnz	short loc_10001B8E
		push	4
		pop	ebx
		jmp	loc_10001C36
; ---------------------------------------------------------------------------

loc_10001B8E:				; CODE XREF: sub_10001B3E+46j
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_10001BC8
		test	esi, esi
		jz	short loc_10001BC8

loc_10001BA5:				; CODE XREF: sub_10001B3E+88j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		mov	al, [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		mov	byte ptr [esp+18h+arg_0], al
		push	[esp+18h+arg_0]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10001C1A
		dec	esi
		jnz	short loc_10001BA5

loc_10001BC8:				; CODE XREF: sub_10001B3E+61j
					; sub_10001B3E+65j
		cmp	dword ptr [ebp+14h], 10h
		jb	short loc_10001BD1
		mov	ebp, [ebp+0]

loc_10001BD1:				; CODE XREF: sub_10001B3E+8Ej
		mov	eax, [edi]
		push	0
		push	[esp+1Ch+arg_4]
		mov	eax, [eax+4]
		push	ebp
		mov	ecx, [eax+edi+38h]
		call	ds:?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::sputn(char const *,__int64)
		cmp	eax, [esp+18h+arg_4]
		jnz	short loc_10001C24
		test	edx, edx
		jnz	short loc_10001C24

loc_10001BF1:				; CODE XREF: sub_10001B3E+DFj
		test	esi, esi
		jz	short loc_10001C27

loc_10001BF5:				; CODE XREF: sub_10001B3E+D8j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		mov	al, [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		mov	byte ptr [esp+18h+arg_4], al
		push	[esp+18h+arg_4]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10001C1F
		dec	esi
		jnz	short loc_10001BF5
		jmp	short loc_10001C27
; ---------------------------------------------------------------------------

loc_10001C1A:				; CODE XREF: sub_10001B3E+85j
		push	4
		pop	ebx
		jmp	short loc_10001BF1
; ---------------------------------------------------------------------------

loc_10001C1F:				; CODE XREF: sub_10001B3E+D5j
		or	ebx, 4
		jmp	short loc_10001C27
; ---------------------------------------------------------------------------

loc_10001C24:				; CODE XREF: sub_10001B3E+ADj
					; sub_10001B3E+B1j
		push	4
		pop	ebx

loc_10001C27:				; CODE XREF: sub_10001B3E+B5j
					; sub_10001B3E+DAj ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_10001C36:				; CODE XREF: sub_10001B3E+4Bj
		mov	eax, [edi]
		push	0
		push	ebx
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z	; std::basic_ios<char,std::char_traits<char>>::setstate(int,bool)
		mov	esi, [esp+18h+var_8]
		mov	ecx, esi
		call	ds:?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ ;	std::basic_ostream<char,std::char_traits<char>>::_Osfx(void)
		mov	eax, [esi]
		mov	ecx, [eax+4]
		mov	ecx, [ecx+esi+38h]
		test	ecx, ecx
		jz	short loc_10001C64
		mov	edx, [ecx]
		call	dword ptr [edx+8]

loc_10001C64:				; CODE XREF: sub_10001B3E+11Fj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_10001B3E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001C6D	proc near		; CODE XREF: sub_100035CB+3Cp
					; sub_100035CB+44p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	[esp+1Ch+arg_4]
		xor	ebp, ebp
		call	sub_100019DA
		mov	edi, [esp+20h+arg_0]
		pop	ecx
		mov	[esp+1Ch+var_C], eax
		mov	ecx, [edi]
		mov	ecx, [ecx+4]
		mov	ebx, [ecx+edi+24h]
		mov	esi, [ecx+edi+20h]
		test	ebx, ebx
		jl	short loc_10001CAF
		jg	short loc_10001CA9
		test	esi, esi
		jz	short loc_10001CAF
		test	ebx, ebx
		jl	short loc_10001CAF
		jg	short loc_10001CA9
		cmp	esi, eax
		jbe	short loc_10001CAF

loc_10001CA9:				; CODE XREF: sub_10001C6D+2Cj
					; sub_10001C6D+36j
		sub	esi, eax
		sbb	ebx, ebp
		jmp	short loc_10001CB3
; ---------------------------------------------------------------------------

loc_10001CAF:				; CODE XREF: sub_10001C6D+2Aj
					; sub_10001C6D+30j ...
		xor	esi, esi
		xor	ebx, ebx

loc_10001CB3:				; CODE XREF: sub_10001C6D+40j
		push	edi
		lea	ecx, [esp+20h+var_8]
		call	sub_10001F97
		cmp	[esp+1Ch+var_4], 0
		jnz	short loc_10001CCC
		push	4
		pop	ebp
		jmp	loc_10001D82
; ---------------------------------------------------------------------------

loc_10001CCC:				; CODE XREF: sub_10001C6D+55j
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_10001D15
		test	ebx, ebx
		jl	short loc_10001D15
		jle	short loc_10001D11

loc_10001CE5:				; CODE XREF: sub_10001C6D+A0j
					; sub_10001C6D+A6j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		mov	al, [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		mov	byte ptr [esp+1Ch+arg_0], al
		push	[esp+1Ch+arg_0]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10001D70
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_10001CE5
		jl	short loc_10001D15

loc_10001D11:				; CODE XREF: sub_10001C6D+76j
		test	esi, esi
		jnz	short loc_10001CE5

loc_10001D15:				; CODE XREF: sub_10001C6D+70j
					; sub_10001C6D+74j ...
		mov	eax, [edi]
		push	0
		push	[esp+20h+var_C]
		mov	eax, [eax+4]
		push	[esp+24h+arg_4]
		mov	ecx, [eax+edi+38h]
		call	ds:?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::sputn(char const *,__int64)
		cmp	eax, [esp+1Ch+var_C]
		jnz	short loc_10001D70
		test	edx, edx
		jnz	short loc_10001D70
		test	ebx, ebx
		jl	short loc_10001D73
		jle	short loc_10001D6A

loc_10001D3E:				; CODE XREF: sub_10001C6D+F9j
					; sub_10001C6D+FFj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		mov	al, [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		mov	byte ptr [esp+1Ch+arg_0], al
		push	[esp+1Ch+arg_0]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10001D70
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_10001D3E
		jl	short loc_10001D73

loc_10001D6A:				; CODE XREF: sub_10001C6D+CFj
		test	esi, esi
		jnz	short loc_10001D3E
		jmp	short loc_10001D73
; ---------------------------------------------------------------------------

loc_10001D70:				; CODE XREF: sub_10001C6D+96j
					; sub_10001C6D+C5j ...
		push	4
		pop	ebp

loc_10001D73:				; CODE XREF: sub_10001C6D+CDj
					; sub_10001C6D+FBj ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_10001D82:				; CODE XREF: sub_10001C6D+5Aj
		mov	eax, [edi]
		push	0
		push	ebp
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z	; std::basic_ios<char,std::char_traits<char>>::setstate(int,bool)
		mov	esi, [esp+1Ch+var_8]
		mov	ecx, esi
		call	ds:?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ ;	std::basic_ostream<char,std::char_traits<char>>::_Osfx(void)
		mov	eax, [esi]
		mov	ecx, [eax+4]
		mov	ecx, [ecx+esi+38h]
		test	ecx, ecx
		jz	short loc_10001DB0
		mov	edx, [ecx]
		call	dword ptr [edx+8]

loc_10001DB0:				; CODE XREF: sub_10001C6D+13Cj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_10001C6D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001DBA	proc near		; CODE XREF: sub_10002150+45p
					; sub_100049CD+2Fp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10001DE0
		cmp	eax, 7FFFFFFFh
		ja	short loc_10001DDA
		add	eax, eax
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10001DE0

loc_10001DDA:				; CODE XREF: sub_10001DBA+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_10001DE0:				; CODE XREF: sub_10001DBA+8j
					; sub_10001DBA+1Ej
		mov	eax, ecx
		retn
sub_10001DBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10001DE3	proc near		; CODE XREF: sub_10001EE3+10p
					; sub_10001F1E+13p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		push	edi
		mov	edi, ecx
		xor	ecx, ecx
		mov	[ebp+var_4], ecx
		cmp	[ebp+arg_4], ecx
		jz	short loc_10001E0B
		mov	dword ptr [edi], offset	dword_1001C950
		mov	eax, ds:??_7ios_base@std@@6B@ ;	const std::ios_base::`vftable'
		mov	[edi+50h], eax
		mov	eax, ds:??_7?$basic_ios@DU?$char_traits@D@std@@@std@@6B@ ; const std::basic_ios<char,std::char_traits<char>>::`vftable'
		mov	[edi+50h], eax

loc_10001E0B:				; CODE XREF: sub_10001DE3+10j
		push	ecx
		push	ecx
		lea	esi, [edi+4]
		mov	ecx, edi
		push	esi
		call	ds:??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_streambuf@DU?$char_traits@D@std@@@1@_N@Z ; std::basic_ostream<char,std::char_traits<char>>::basic_ostream<char,std::char_traits<char>>(std::basic_streambuf<char,std::char_traits<char>> *,bool)
		mov	eax, [edi]
		mov	ecx, esi
		mov	eax, [eax+4]
		mov	dword ptr [edi+eax], offset off_1001C94C
		mov	eax, [edi]
		mov	edx, [eax+4]
		lea	eax, [edx-50h]
		mov	[edx+edi-4], eax
		mov	eax, [ebp+arg_0]
		or	eax, 2
		push	eax
		call	sub_10001EBC
		mov	eax, edi
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10001DE3	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10001E49(void *)
sub_10001E49	proc near		; CODE XREF: sub_10004F23+1Ep

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]	; void *
		mov	esi, ecx
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [esi],	0
		call	sub_10002104
		mov	eax, esi
		pop	esi
		retn	4
sub_10001E49	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10001E69(void *, size_t)
sub_10001E69	proc near		; CODE XREF: sub_100029B6+39p
					; sub_100029B6+87p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	[esp+4+arg_4]	; size_t
		mov	esi, ecx
		push	[esp+8+arg_0]	; void *
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [esi],	0
		call	sub_1000183E
		mov	eax, esi
		pop	esi
		retn	8
sub_10001E69	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10001E8D(void *)
sub_10001E8D	proc near		; CODE XREF: sub_10002039+1Bp
					; sub_10002B92+24p ...

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, ecx
		xor	eax, eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	[esp+8+arg_0]	; void *
		mov	ecx, esi
		call	sub_100023C8
		mov	eax, esi
		pop	esi
		retn	4
sub_10001E8D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001EBC	proc near		; CODE XREF: sub_10001DE3+57p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		call	ds:??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAE@XZ ; std::basic_streambuf<char,std::char_traits<char>>::basic_streambuf<char,std::char_traits<char>>(void)
		push	[esp+4+arg_0]
		and	dword ptr [esi+38h], 0
		mov	ecx, esi
		mov	dword ptr [esi], offset	off_1001C910
		call	sub_100021F8
		mov	[esi+3Ch], eax
		mov	eax, esi
		pop	esi
		retn	4
sub_10001EBC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001EE3	proc near		; CODE XREF: sub_100061EE+29p
					; sub_100062C9+A2p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		push	esi
		mov	esi, ecx
		push	1
		push	2
		lea	ecx, [esi+8]
		mov	[esi], eax
		call	sub_10001DE3
		mov	eax, [esp+4+arg_0]
		mov	[esi+0A4h], eax
		mov	eax, [esp+4+arg_4]
		mov	[esi+0A8h], eax
		call	ds:GetLastError
		mov	[esi+0ACh], eax
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10001EE3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10001F1E(int, int, void *)
sub_10001F1E	proc near		; CODE XREF: sub_1000EE9A+3Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ecx
		push	1
		push	2
		lea	ecx, [esi+8]
		mov	dword ptr [esi], 3
		call	sub_10001DE3
		mov	eax, [ebp+arg_0]
		mov	[esi+0A4h], eax
		mov	eax, [ebp+arg_4]
		mov	[esi+0A8h], eax
		call	ds:GetLastError
		cmp	[ebp+arg_8], 0
		mov	[esi+0ACh], eax
		jz	short loc_10001F6F
		mov	ecx, [ebp+arg_8] ; void	*
		push	0		; size_t
		push	1		; char
		call	sub_10001769
		push	[ebp+arg_8]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10001F6F:				; CODE XREF: sub_10001F1E+3Aj
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	0Ch
sub_10001F1E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001F76	proc near		; CODE XREF: sub_10001F97+9p
					; sub_100074B0+9p

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, ecx
		mov	[esi], edx
		mov	eax, [edx]
		mov	eax, [eax+4]
		mov	ecx, [eax+edx+38h]
		test	ecx, ecx
		jz	short loc_10001F91
		mov	eax, [ecx]
		call	dword ptr [eax+4]

loc_10001F91:				; CODE XREF: sub_10001F76+14j
		mov	eax, esi
		pop	esi
		retn	4
sub_10001F76	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001F97	proc near		; CODE XREF: sub_10001B3E+3Dp
					; sub_10001C6D+4Bp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	esi
		mov	edi, ecx
		call	sub_10001F76
		mov	eax, [esi]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+esi+0Ch], 0
		jnz	short loc_10001FC3
		mov	ecx, [ecx+esi+3Ch]
		test	ecx, ecx
		jz	short loc_10001FC3
		cmp	ecx, esi
		jz	short loc_10001FC3
		call	ds:?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ ; std::basic_ostream<char,std::char_traits<char>>::flush(void)

loc_10001FC3:				; CODE XREF: sub_10001F97+18j
					; sub_10001F97+20j ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		cmp	dword ptr [eax+esi+0Ch], 0
		setz	al
		mov	[edi+4], al
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_10001F97	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001FDA	proc near		; CODE XREF: sub_10002098+6p
		push	esi
		mov	esi, ecx
		mov	eax, [esi-50h]
		lea	ecx, [esi-4Ch]
		mov	eax, [eax+4]
		mov	dword ptr [eax+esi-50h], offset	off_1001C94C
		mov	eax, [esi-50h]
		mov	edx, [eax+4]
		lea	eax, [edx-50h]
		mov	[edx+esi-54h], eax
		call	sub_1000200A
		lea	ecx, [esi-48h]
		pop	esi
		jmp	ds:??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UAE@XZ ; std::basic_ostream<char,std::char_traits<char>>::~basic_ostream<char,std::char_traits<char>>(void)
sub_10001FDA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000200A	proc near		; CODE XREF: sub_10001FDA+21p
					; sub_100020E2+3p
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1001C910
		call	sub_10002307
		mov	ecx, esi
		pop	esi
		jmp	ds:??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAE@XZ ; std::basic_streambuf<char,std::char_traits<char>>::~basic_streambuf<char,std::char_traits<char>>(void)
sub_1000200A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002021	proc near		; CODE XREF: sub_100061EE+44p
					; sub_100062C9+BDp ...
		push	esi
		mov	esi, ecx
		push	dword ptr [esi+0ACh] ; dwErrCode
		call	ds:SetLastError
		lea	ecx, [esi+8]
		pop	esi
		jmp	sub_10002098
sub_10002021	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10002039(int,	void *)
sub_10002039	proc near		; CODE XREF: sub_10016434+BDp

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		lea	ecx, [ebp+var_34]
		push	esi
		mov	esi, [ebp+arg_0]
		push	eax		; void *
		call	sub_10001E8D
		push	eax		; int
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		call	sub_10004CB1
		push	eax
		push	esi
		call	sub_10001B3E
		add	esp, 10h
		lea	ecx, [ebp+var_1C] ; void *
		mov	esi, eax
		push	0		; size_t
		push	1		; char
		call	sub_10001769
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002039	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002098	proc near		; CODE XREF: sub_10002021+13j
					; sub_100020BB+Ep ...
		push	esi
		lea	esi, [ecx+50h]
		mov	ecx, esi
		call	sub_10001FDA
		mov	eax, ds:??_7?$basic_ios@DU?$char_traits@D@std@@@std@@6B@ ; const std::basic_ios<char,std::char_traits<char>>::`vftable'
		mov	[esi], eax
		mov	eax, ds:??_7ios_base@std@@6B@ ;	const std::ios_base::`vftable'
		push	esi
		mov	[esi], eax
		call	ds:?_Ios_base_dtor@ios_base@std@@CAXPAV12@@Z ; std::ios_base::_Ios_base_dtor(std::ios_base *)
		pop	ecx
		pop	esi
		retn
sub_10002098	endp


; =============== S U B	R O U T	I N E =======================================


sub_100020BB	proc near		; DATA XREF: .rdata:off_1001C94Co

arg_0		= byte ptr  4

		sub	ecx, [ecx-4]
		jmp	$+5
; ---------------------------------------------------------------------------

loc_100020C3:				; CODE XREF: sub_100020BB+3j
		push	esi
		lea	esi, [ecx-50h]
		mov	ecx, esi
		call	sub_10002098
		test	[esp+4+arg_0], 1
		jz	short loc_100020DC
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_100020DC:				; CODE XREF: sub_100020BB+18j
		mov	eax, esi
		pop	esi
		retn	4
sub_100020BB	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100020E2(void *, char)
sub_100020E2	proc near		; DATA XREF: .rdata:off_1001C910o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_1000200A
		test	[esp+4+arg_0], 1
		jz	short loc_100020F8
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_100020F8:				; CODE XREF: sub_100020E2+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_100020E2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100020FE	proc near		; CODE XREF: sub_10016434+23p
		mov	eax, dword_10033088
		retn
sub_100020FE	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10002104(void *, void *)
sub_10002104	proc near		; CODE XREF: sub_10001E49+15p
					; sub_100029B6+52p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		cmp	dword ptr [esi+14h], 10h
		jnb	short loc_10002126
		mov	eax, [esi+10h]
		inc	eax
		jz	short loc_10002131
		push	eax		; size_t
		push	esi		; void *
		push	edi		; void *
		call	ds:memmove
		add	esp, 0Ch
		jmp	short loc_10002131
; ---------------------------------------------------------------------------

loc_10002126:				; CODE XREF: sub_10002104+Cj
		test	edi, edi
		jz	short loc_1000212E
		mov	eax, [esi]
		mov	[edi], eax

loc_1000212E:				; CODE XREF: sub_10002104+24j
		and	dword ptr [esi], 0

loc_10002131:				; CODE XREF: sub_10002104+12j
					; sub_10002104+20j
		mov	eax, [esi+10h]
		mov	[edi+10h], eax
		mov	eax, [esi+14h]
		mov	[edi+14h], eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		pop	edi
		mov	byte ptr [esi],	0
		pop	esi
		retn	4
sub_10002104	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10002150(void *, int, int)
sub_10002150	proc near		; CODE XREF: sub_10002221+21p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		or	esi, 7
		push	edi
		mov	edi, ecx
		cmp	esi, 7FFFFFFEh
		jbe	short loc_1000216B
		mov	esi, [esp+10h+arg_0]
		jmp	short loc_1000218F
; ---------------------------------------------------------------------------

loc_1000216B:				; CODE XREF: sub_10002150+13j
		push	3
		xor	edx, edx
		mov	ebx, [edi+14h]
		mov	eax, esi
		mov	ecx, ebx
		pop	ebp
		div	ebp
		shr	ecx, 1
		cmp	ecx, eax
		jbe	short loc_1000218F
		mov	esi, 7FFFFFFEh
		mov	eax, esi
		sub	eax, ecx
		cmp	ebx, eax
		ja	short loc_1000218F
		lea	esi, [ecx+ebx]

loc_1000218F:				; CODE XREF: sub_10002150+19j
					; sub_10002150+2Dj ...
		lea	eax, [esi+1]
		push	0
		push	eax
		call	sub_10001DBA
		mov	ebx, [esp+18h+arg_4]
		mov	ebp, eax
		pop	ecx
		pop	ecx
		test	ebx, ebx
		jz	short loc_100021BD
		cmp	dword ptr [edi+14h], 8
		jb	short loc_100021B0
		mov	ecx, [edi]
		jmp	short loc_100021B2
; ---------------------------------------------------------------------------

loc_100021B0:				; CODE XREF: sub_10002150+5Aj
		mov	ecx, edi

loc_100021B2:				; CODE XREF: sub_10002150+5Ej
		push	ebx		; int
		push	ecx		; void *
		push	ebp		; void *
		call	sub_10002435
		add	esp, 0Ch

loc_100021BD:				; CODE XREF: sub_10002150+54j
		push	0		; int
		push	1		; char
		mov	ecx, edi	; void *
		call	sub_100022C1
		test	edi, edi
		jz	short loc_100021CE
		mov	[edi], ebp

loc_100021CE:				; CODE XREF: sub_10002150+7Aj
		push	ebx
		mov	ecx, edi
		mov	[edi+14h], esi
		call	sub_100021E0
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_10002150	endp


; =============== S U B	R O U T	I N E =======================================


sub_100021E0	proc near		; CODE XREF: sub_10002150+84p
					; sub_100022C1+3Dp ...

arg_0		= dword	ptr  4

		cmp	dword ptr [ecx+14h], 8
		mov	eax, [esp+arg_0]
		mov	[ecx+10h], eax
		jb	short loc_100021EF
		mov	ecx, [ecx]

loc_100021EF:				; CODE XREF: sub_100021E0+Bj
		xor	edx, edx
		mov	[ecx+eax*2], dx
		retn	4
sub_100021E0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100021F8	proc near		; CODE XREF: sub_10001EBC+19p
					; sub_10007422+19p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		xor	eax, eax
		test	cl, 1
		jnz	short loc_10002206
		push	4
		pop	eax

loc_10002206:				; CODE XREF: sub_100021F8+9j
		test	cl, 2
		jnz	short loc_1000220E
		or	eax, 2

loc_1000220E:				; CODE XREF: sub_100021F8+11j
		test	cl, 8
		jz	short loc_10002216
		or	eax, 8

loc_10002216:				; CODE XREF: sub_100021F8+19j
		test	cl, 4
		jz	short locret_1000221E
		or	eax, 10h

locret_1000221E:			; CODE XREF: sub_100021F8+21j
		retn	4
sub_100021F8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002221	proc near		; CODE XREF: sub_10002344+48p
					; sub_100023C8+39p ...

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	esi, 7FFFFFFEh
		jbe	short loc_10002239
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10002239:				; CODE XREF: sub_10002221+Bj
		cmp	[ecx+14h], esi
		jnb	short loc_10002249
		push	dword ptr [ecx+10h] ; int
		push	esi		; int
		call	sub_10002150
		jmp	short loc_1000227C
; ---------------------------------------------------------------------------

loc_10002249:				; CODE XREF: sub_10002221+1Bj
		cmp	[esp+4+arg_4], 0
		jz	short loc_10002268
		cmp	esi, 8
		jnb	short loc_10002268
		mov	eax, [ecx+10h]
		cmp	esi, eax
		jnb	short loc_1000225E
		mov	eax, esi

loc_1000225E:				; CODE XREF: sub_10002221+39j
		push	eax		; int
		push	1		; char
		call	sub_100022C1
		jmp	short loc_1000227C
; ---------------------------------------------------------------------------

loc_10002268:				; CODE XREF: sub_10002221+2Dj
					; sub_10002221+32j
		test	esi, esi
		jnz	short loc_1000227C
		and	[ecx+10h], esi
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_10002277
		mov	ecx, [ecx]

loc_10002277:				; CODE XREF: sub_10002221+52j
		xor	eax, eax
		mov	[ecx], ax

loc_1000227C:				; CODE XREF: sub_10002221+26j
					; sub_10002221+45j ...
		xor	eax, eax
		cmp	eax, esi
		pop	esi
		sbb	eax, eax
		neg	eax
		retn	8
sub_10002221	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002288	proc near		; CODE XREF: sub_100023C8+Bp
					; sub_10003950+9p ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		test	edx, edx
		jz	short loc_100022BC
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000229A
		mov	eax, [ecx]
		jmp	short loc_1000229C
; ---------------------------------------------------------------------------

loc_1000229A:				; CODE XREF: sub_10002288+Cj
		mov	eax, ecx

loc_1000229C:				; CODE XREF: sub_10002288+10j
		cmp	edx, eax
		jb	short loc_100022BC
		cmp	dword ptr [ecx+14h], 8
		push	esi
		jb	short loc_100022AB
		mov	esi, [ecx]
		jmp	short loc_100022AD
; ---------------------------------------------------------------------------

loc_100022AB:				; CODE XREF: sub_10002288+1Dj
		mov	esi, ecx

loc_100022AD:				; CODE XREF: sub_10002288+21j
		mov	eax, [ecx+10h]
		lea	eax, [esi+eax*2]
		pop	esi
		cmp	eax, edx
		jbe	short loc_100022BC
		mov	al, 1
		jmp	short locret_100022BE
; ---------------------------------------------------------------------------

loc_100022BC:				; CODE XREF: sub_10002288+6j
					; sub_10002288+16j ...
		xor	al, al

locret_100022BE:			; CODE XREF: sub_10002288+32j
		retn	4
sub_10002288	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100022C1(void *, char, int)
sub_100022C1	proc near		; CODE XREF: sub_10002039+49p
					; sub_10002150+73p ...

arg_0		= byte ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_0], 0
		push	esi
		mov	esi, ecx
		jz	short loc_100022F1
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100022F1
		cmp	[esp+4+arg_4], 0
		push	ebx
		mov	ebx, [esi]
		jbe	short loc_100022E9
		push	[esp+8+arg_4]	; int
		push	ebx		; void *
		push	esi		; void *
		call	sub_10002435
		add	esp, 0Ch

loc_100022E9:				; CODE XREF: sub_100022C1+18j
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	ebx

loc_100022F1:				; CODE XREF: sub_100022C1+8j
					; sub_100022C1+Ej
		push	[esp+4+arg_4]
		mov	ecx, esi
		mov	dword ptr [esi+14h], 7
		call	sub_100021E0
		pop	esi
		retn	8
sub_100022C1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002307	proc near		; CODE XREF: sub_1000200A+9p
					; sub_100074F3+9p
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 1
		jz	short loc_1000231B
		mov	eax, [esi+0Ch]
		push	dword ptr [eax]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1000231B:				; CODE XREF: sub_10002307+7j
		mov	eax, [esi+0Ch]
		xor	ecx, ecx
		mov	[eax], ecx
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], ecx
		mov	eax, [esi+10h]
		mov	[eax], ecx
		mov	eax, [esi+20h]
		mov	[eax], ecx
		mov	eax, [esi+30h]
		mov	[eax], ecx
		and	dword ptr [esi+3Ch], 0FFFFFFFEh
		mov	[esi+38h], ecx
		pop	esi
		retn
sub_10002307	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002344	proc near		; CODE XREF: sub_100023C8+2Bp
					; sub_10003B1C+1Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		push	edi
		mov	edi, [ebx+10h]
		mov	esi, ecx
		cmp	edi, ebp
		jnb	short loc_10002364
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10002364:				; CODE XREF: sub_10002344+13j
		sub	edi, ebp
		cmp	[esp+10h+arg_8], edi
		jnb	short loc_10002370
		mov	edi, [esp+10h+arg_8]

loc_10002370:				; CODE XREF: sub_10002344+26j
		cmp	esi, ebx
		jnz	short loc_10002389
		lea	eax, [edi+ebp]
		push	eax
		call	sub_10002456
		push	ebp
		push	0
		mov	ecx, esi
		call	sub_10002479
		jmp	short loc_100023BF
; ---------------------------------------------------------------------------

loc_10002389:				; CODE XREF: sub_10002344+2Ej
		push	0
		push	edi
		call	sub_10002221
		test	al, al
		jz	short loc_100023BF
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_1000239D
		mov	ebx, [ebx]

loc_1000239D:				; CODE XREF: sub_10002344+55j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100023A7
		mov	ecx, [esi]
		jmp	short loc_100023A9
; ---------------------------------------------------------------------------

loc_100023A7:				; CODE XREF: sub_10002344+5Dj
		mov	ecx, esi

loc_100023A9:				; CODE XREF: sub_10002344+61j
		push	edi		; int
		lea	eax, [ebx+ebp*2]
		push	eax		; void *
		push	ecx		; void *
		call	sub_10002435
		add	esp, 0Ch
		mov	ecx, esi
		push	edi
		call	sub_100021E0

loc_100023BF:				; CODE XREF: sub_10002344+43j
					; sub_10002344+4Fj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_10002344	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100023C8(void *, int)
sub_100023C8	proc near		; CODE XREF: sub_10001E8D+24p
					; sub_10002AFE+1Bp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		mov	esi, ecx
		push	edi
		call	sub_10002288
		test	al, al
		jz	short loc_100023FA
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100023E6
		mov	eax, [esi]
		jmp	short loc_100023E8
; ---------------------------------------------------------------------------

loc_100023E6:				; CODE XREF: sub_100023C8+18j
		mov	eax, esi

loc_100023E8:				; CODE XREF: sub_100023C8+1Cj
		push	[ebp+arg_4]
		sub	edi, eax
		mov	ecx, esi
		sar	edi, 1
		push	edi
		push	esi
		call	sub_10002344
		jmp	short loc_1000242F
; ---------------------------------------------------------------------------

loc_100023FA:				; CODE XREF: sub_100023C8+12j
		push	0
		push	[ebp+arg_4]
		mov	ecx, esi
		call	sub_10002221
		test	al, al
		jz	short loc_1000242D
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10002414
		mov	eax, [esi]
		jmp	short loc_10002416
; ---------------------------------------------------------------------------

loc_10002414:				; CODE XREF: sub_100023C8+46j
		mov	eax, esi

loc_10002416:				; CODE XREF: sub_100023C8+4Aj
		push	[ebp+arg_4]	; int
		push	edi		; void *
		push	eax		; void *
		call	sub_10002435
		add	esp, 0Ch
		mov	ecx, esi
		push	[ebp+arg_4]
		call	sub_100021E0

loc_1000242D:				; CODE XREF: sub_100023C8+40j
		mov	eax, esi

loc_1000242F:				; CODE XREF: sub_100023C8+30j
		pop	edi
		pop	esi
		pop	ebp
		retn	8
sub_100023C8	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10002435(void	*, void	*, int)
sub_10002435	proc near		; CODE XREF: sub_10002150+65p
					; sub_100022C1+20p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		test	eax, eax
		jnz	short loc_10002442
		mov	eax, [esp+arg_0]
		retn
; ---------------------------------------------------------------------------

loc_10002442:				; CODE XREF: sub_10002435+6j
		add	eax, eax
		push	eax		; size_t
		push	[esp+4+arg_4]	; void *
		push	[esp+8+arg_0]	; void *
		call	memcpy
		add	esp, 0Ch
		retn
sub_10002435	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002456	proc near		; CODE XREF: sub_10002344+34p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		cmp	[esi+10h], eax
		jnb	short loc_1000246D
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_1000246D:				; CODE XREF: sub_10002456+Aj
		push	eax
		call	sub_100021E0
		mov	eax, esi
		pop	esi
		retn	4
sub_10002456	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002479	proc near		; CODE XREF: sub_10002344+3Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, ecx
		mov	ecx, [esp+4+arg_0]
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, ecx
		jnb	short loc_10002493
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10002493:				; CODE XREF: sub_10002479+Dj
		mov	edx, [esp+8+arg_4]
		mov	eax, edi
		sub	eax, ecx
		cmp	eax, edx
		ja	short loc_100024A9
		push	ecx
		mov	ecx, esi
		call	sub_100021E0
		jmp	short loc_100024DC
; ---------------------------------------------------------------------------

loc_100024A9:				; CODE XREF: sub_10002479+24j
		test	edx, edx
		jz	short loc_100024DC
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100024B7
		mov	eax, [esi]
		jmp	short loc_100024B9
; ---------------------------------------------------------------------------

loc_100024B7:				; CODE XREF: sub_10002479+38j
		mov	eax, esi

loc_100024B9:				; CODE XREF: sub_10002479+3Cj
		sub	edi, edx
		push	ebx
		lea	ebx, [eax+ecx*2]
		mov	eax, edi
		sub	eax, ecx
		jz	short loc_100024D3
		push	eax		; int
		lea	eax, [ebx+edx*2]
		push	eax		; void *
		push	ebx		; void *
		call	sub_10002AE5
		add	esp, 0Ch

loc_100024D3:				; CODE XREF: sub_10002479+4Aj
		push	edi
		mov	ecx, esi
		call	sub_100021E0
		pop	ebx

loc_100024DC:				; CODE XREF: sub_10002479+2Ej
					; sub_10002479+32j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_10002479	endp


; =============== S U B	R O U T	I N E =======================================


sub_100024E3	proc near		; CODE XREF: sub_10001E8D+17p
					; sub_1000712E+Dp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	ecx, ecx
		cmp	[edx], cx
		jz	short loc_10002504
		push	esi
		lea	esi, [edx+2]

loc_100024F2:				; CODE XREF: sub_100024E3+18j
		mov	ax, [edx]
		add	edx, 2
		cmp	ax, cx
		jnz	short loc_100024F2
		mov	ecx, edx
		sub	ecx, esi
		sar	ecx, 1
		pop	esi

loc_10002504:				; CODE XREF: sub_100024E3+9j
		mov	eax, ecx
		retn
sub_100024E3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002507	proc near		; DATA XREF: .rdata:1001C91Co

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 2
		jz	short loc_10002519
		or	eax, 0FFFFFFFFh
		jmp	loc_10002699
; ---------------------------------------------------------------------------

loc_10002519:				; CODE XREF: sub_10002507+8j
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_1000252A
		xor	eax, eax
		jmp	loc_10002698
; ---------------------------------------------------------------------------

loc_1000252A:				; CODE XREF: sub_10002507+1Aj
		test	byte ptr [esi+3Ch], 8
		push	edi
		jz	short loc_10002550
		mov	edi, [esi+20h]
		cmp	dword ptr [edi], 0
		jz	short loc_10002550
		mov	edx, [esi+38h]
		cmp	[edi], edx
		jnb	short loc_10002550
		mov	eax, [esi+30h]
		mov	ecx, [eax]
		add	ecx, [edi]
		mov	[edi], edx
		sub	ecx, edx
		mov	eax, [esi+30h]
		mov	[eax], ecx

loc_10002550:				; CODE XREF: sub_10002507+28j
					; sub_10002507+30j ...
		mov	eax, [esi+20h]
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_10002579
		mov	ecx, [esi+30h]
		mov	ecx, [ecx]
		add	ecx, edx
		cmp	edx, ecx
		jnb	short loc_10002575
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Pninc(void)
		mov	[eax], bl
		mov	eax, ebx
		jmp	loc_10002697
; ---------------------------------------------------------------------------

loc_10002575:				; CODE XREF: sub_10002507+5Bj
		test	edx, edx
		jnz	short loc_1000257D

loc_10002579:				; CODE XREF: sub_10002507+50j
		xor	ebx, ebx
		jmp	short loc_10002589
; ---------------------------------------------------------------------------

loc_1000257D:				; CODE XREF: sub_10002507+70j
		mov	eax, [esi+30h]
		mov	ecx, [esi+0Ch]
		mov	ebx, [eax]
		sub	ebx, [ecx]
		add	ebx, edx

loc_10002589:				; CODE XREF: sub_10002507+74j
		mov	eax, ebx
		push	20h
		shr	eax, 1
		pop	ecx
		cmp	eax, ecx
		jb	short loc_1000259A
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_100025AD

loc_1000259A:				; CODE XREF: sub_10002507+8Bj
					; sub_10002507+A0j
		mov	eax, 7FFFFFFFh
		sub	eax, ecx
		cmp	eax, ebx
		jnb	short loc_100025A9
		shr	ecx, 1
		jnz	short loc_1000259A

loc_100025A9:				; CODE XREF: sub_10002507+9Cj
		test	ecx, ecx
		jnz	short loc_100025B5

loc_100025AD:				; CODE XREF: sub_10002507+91j
		or	eax, 0FFFFFFFFh
		jmp	loc_10002697
; ---------------------------------------------------------------------------

loc_100025B5:				; CODE XREF: sub_10002507+A4j
		push	ebp
		lea	eax, [ecx+ebx]
		push	0
		push	eax
		mov	[esp+1Ch+var_4], eax
		call	sub_10001050
		mov	edi, eax
		pop	ecx
		pop	ecx
		mov	ecx, [esi+0Ch]
		mov	ebp, [ecx]
		test	ebx, ebx
		jz	short loc_100025E1
		push	ebx		; size_t
		push	ebp		; void *
		push	edi		; void *
		call	memcpy
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_10002612

loc_100025E1:				; CODE XREF: sub_10002507+C9j
		mov	eax, [esi+10h]
		mov	edx, [esp+14h+var_4]
		mov	[esi+38h], edi
		mov	[eax], edi
		mov	eax, [esi+20h]
		mov	[eax], edi
		mov	eax, [esi+30h]
		mov	[eax], edx
		mov	eax, [esi+0Ch]
		test	byte ptr [esi+3Ch], 4
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		jnz	short loc_1000264B
		mov	[eax], edi
		mov	eax, [esi+2Ch]
		mov	dword ptr [eax], 1
		jmp	short loc_10002675
; ---------------------------------------------------------------------------

loc_10002612:				; CODE XREF: sub_10002507+D8j
		mov	ecx, [esi+10h]
		mov	eax, edi
		sub	eax, ebp
		add	[esi+38h], eax
		mov	eax, [esi+20h]
		mov	edx, [eax]
		mov	eax, edi
		sub	eax, ebp
		sub	edx, ebp
		add	[ecx], eax
		add	edx, edi
		mov	eax, [esi+20h]
		mov	ecx, edi
		sub	ecx, edx
		add	ecx, [esp+14h+var_4]
		mov	[eax], edx
		mov	eax, [esi+30h]
		mov	[eax], ecx
		test	byte ptr [esi+3Ch], 4
		jz	short loc_10002655
		mov	eax, [esi+0Ch]
		mov	[eax], edi
		mov	eax, [esi+1Ch]

loc_1000264B:				; CODE XREF: sub_10002507+FCj
		and	dword ptr [eax], 0
		mov	eax, [esi+2Ch]
		mov	[eax], edi
		jmp	short loc_10002675
; ---------------------------------------------------------------------------

loc_10002655:				; CODE XREF: sub_10002507+13Aj
		mov	eax, [esi+20h]
		mov	edx, [eax]
		mov	eax, [esi+1Ch]
		mov	ecx, [eax]
		mov	eax, [esi+0Ch]
		sub	ecx, ebp
		add	ecx, edi
		sub	edx, ecx
		inc	edx
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], edx

loc_10002675:				; CODE XREF: sub_10002507+109j
					; sub_10002507+14Cj
		test	byte ptr [esi+3Ch], 1
		jz	short loc_10002682
		push	ebp		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10002682:				; CODE XREF: sub_10002507+172j
		or	dword ptr [esi+3Ch], 1
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Pninc(void)
		mov	ecx, [esp+14h+arg_0]
		pop	ebp
		mov	[eax], cl
		mov	eax, ecx

loc_10002697:				; CODE XREF: sub_10002507+69j
					; sub_10002507+A9j
		pop	edi

loc_10002698:				; CODE XREF: sub_10002507+1Ej
		pop	ebx

loc_10002699:				; CODE XREF: sub_10002507+Dj
		pop	esi
		pop	ecx
		retn	4
sub_10002507	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000269E	proc near		; DATA XREF: .rdata:1001C920o

arg_0		= dword	ptr  4

		mov	edx, ecx
		push	esi
		mov	eax, [edx+1Ch]
		mov	esi, [eax]
		test	esi, esi
		jz	short loc_100026E3
		mov	eax, [edx+0Ch]
		cmp	esi, [eax]
		jbe	short loc_100026E3
		mov	ecx, [esp+4+arg_0]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_100026C5
		cmp	cl, [esi-1]
		jz	short loc_100026C5
		test	byte ptr [edx+3Ch], 2
		jnz	short loc_100026E3

loc_100026C5:				; CODE XREF: sub_1000269E+1Aj
					; sub_1000269E+1Fj
		mov	eax, [edx+2Ch]
		inc	dword ptr [eax]
		mov	eax, [edx+1Ch]
		dec	dword ptr [eax]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_100026DD
		mov	eax, [edx+1Ch]
		mov	eax, [eax]
		mov	[eax], cl
		jmp	short loc_100026DF
; ---------------------------------------------------------------------------

loc_100026DD:				; CODE XREF: sub_1000269E+34j
		xor	ecx, ecx

loc_100026DF:				; CODE XREF: sub_1000269E+3Dj
		mov	eax, ecx
		jmp	short loc_100026E6
; ---------------------------------------------------------------------------

loc_100026E3:				; CODE XREF: sub_1000269E+Aj
					; sub_1000269E+11j ...
		or	eax, 0FFFFFFFFh

loc_100026E6:				; CODE XREF: sub_1000269E+43j
		pop	esi
		retn	4
sub_1000269E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100026EA	proc near		; DATA XREF: .rdata:1001C938o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	ecx, [ebx+20h]
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_10002702
		cmp	[ebx+38h], eax
		jnb	short loc_10002702
		mov	[ebx+38h], eax

loc_10002702:				; CODE XREF: sub_100026EA+Ej
					; sub_100026EA+13j
		test	byte ptr [esp+14h+arg_10], 1
		jz	loc_100027D8
		mov	eax, [ebx+1Ch]
		mov	edx, [eax]
		mov	[esp+14h+var_4], edx
		test	edx, edx
		jz	loc_100027D8
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10002732
		mov	eax, [ebx+38h]
		jmp	short loc_10002740
; ---------------------------------------------------------------------------

loc_10002732:				; CODE XREF: sub_100026EA+41j
		cmp	eax, 1
		jnz	short loc_10002754
		test	byte ptr [esp+14h+arg_10], 2
		jnz	short loc_10002758
		mov	eax, edx

loc_10002740:				; CODE XREF: sub_100026EA+46j
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10002768
; ---------------------------------------------------------------------------

loc_10002754:				; CODE XREF: sub_100026EA+4Bj
		test	eax, eax
		jz	short loc_10002760

loc_10002758:				; CODE XREF: sub_100026EA+52j
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10002768
; ---------------------------------------------------------------------------

loc_10002760:				; CODE XREF: sub_100026EA+6Cj
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10002768:				; CODE XREF: sub_100026EA+68j
					; sub_100026EA+74j
		test	edi, edi
		jl	loc_10002861
		jg	short loc_1000277A
		test	esi, esi
		jb	loc_10002861

loc_1000277A:				; CODE XREF: sub_100026EA+86j
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		cdq
		cmp	edi, edx
		jg	loc_10002861
		jl	short loc_10002797
		cmp	esi, eax
		ja	loc_10002861

loc_10002797:				; CODE XREF: sub_100026EA+A3j
		mov	eax, [ebx+2Ch]
		sub	ecx, [esp+14h+var_4]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [ebx+1Ch]
		add	[eax], ecx
		test	byte ptr [esp+14h+arg_10], 2
		jz	loc_10002881
		mov	edx, [ebx+20h]
		cmp	dword ptr [edx], 0
		jz	loc_10002881
		mov	eax, [ebx+30h]
		mov	ecx, [eax]
		mov	eax, [ebx+1Ch]
		add	ecx, [edx]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [ebx+30h]
		mov	[eax], ecx
		jmp	loc_10002881
; ---------------------------------------------------------------------------

loc_100027D8:				; CODE XREF: sub_100026EA+1Dj
					; sub_100026EA+2Ej
		test	byte ptr [esp+14h+arg_10], 2
		jz	loc_10002869
		mov	edx, [ecx]
		mov	[esp+14h+arg_10], edx
		test	edx, edx
		jz	short loc_10002869
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10002801
		mov	eax, [ebx+38h]
		jmp	short loc_10002808
; ---------------------------------------------------------------------------

loc_10002801:				; CODE XREF: sub_100026EA+110j
		cmp	eax, 1
		jnz	short loc_1000281C
		mov	eax, edx

loc_10002808:				; CODE XREF: sub_100026EA+115j
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10002830
; ---------------------------------------------------------------------------

loc_1000281C:				; CODE XREF: sub_100026EA+11Aj
		test	eax, eax
		jz	short loc_10002828
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10002830
; ---------------------------------------------------------------------------

loc_10002828:				; CODE XREF: sub_100026EA+134j
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10002830:				; CODE XREF: sub_100026EA+130j
					; sub_100026EA+13Cj
		test	edi, edi
		jl	short loc_10002861
		jg	short loc_1000283A
		test	esi, esi
		jb	short loc_10002861

loc_1000283A:				; CODE XREF: sub_100026EA+14Aj
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		cdq
		cmp	edi, edx
		jg	short loc_10002861
		jl	short loc_1000284F
		cmp	esi, eax
		ja	short loc_10002861

loc_1000284F:				; CODE XREF: sub_100026EA+15Fj
		mov	eax, [ebx+30h]
		sub	ecx, [esp+14h+arg_10]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [ebx+20h]
		add	[eax], ecx
		jmp	short loc_10002881
; ---------------------------------------------------------------------------

loc_10002861:				; CODE XREF: sub_100026EA+80j
					; sub_100026EA+8Aj ...
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10002881
; ---------------------------------------------------------------------------

loc_10002869:				; CODE XREF: sub_100026EA+F3j
					; sub_100026EA+101j
		mov	esi, [esp+14h+arg_4]
		mov	eax, esi
		mov	edi, [esp+14h+arg_8]
		or	eax, edi
		jz	short loc_10002881
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	esi, [eax]
		mov	edi, [eax+4]

loc_10002881:				; CODE XREF: sub_100026EA+C2j
					; sub_100026EA+CEj ...
		mov	eax, [esp+14h+arg_0]
		xor	ecx, ecx
		mov	[eax+4], edi
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		pop	ebx
		pop	ecx
		retn	14h
sub_100026EA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000289D	proc near		; DATA XREF: .rdata:1001C93Co

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_1C		= dword	ptr  20h

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_10]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_C]
		add	esi, [esp+14h+arg_4]
		push	edi
		adc	ebx, [esp+18h+arg_8]
		mov	edi, ecx
		mov	edx, [edi+20h]
		mov	eax, [edx]
		test	eax, eax
		jz	short loc_100028C6
		cmp	[edi+38h], eax
		jnb	short loc_100028C6
		mov	[edi+38h], eax

loc_100028C6:				; CODE XREF: sub_1000289D+1Fj
					; sub_1000289D+24j
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	ecx, [eax]
		mov	ebp, [eax+4]
		mov	eax, ecx
		mov	[esp+18h+var_8], ecx
		cmp	esi, eax
		jnz	short loc_100028E2
		cmp	ebx, ebp
		jz	loc_10002999

loc_100028E2:				; CODE XREF: sub_1000289D+3Bj
		test	byte ptr [esp+18h+arg_1C], 1
		jz	short loc_10002953
		mov	eax, [edi+1Ch]
		mov	eax, [eax]
		mov	[esp+18h+var_4], eax
		test	eax, eax
		jz	short loc_10002951
		test	ebx, ebx
		jl	short loc_1000294B
		jg	short loc_10002900
		test	esi, esi
		jb	short loc_1000294B

loc_10002900:				; CODE XREF: sub_1000289D+5Dj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		cdq
		cmp	ebx, edx
		jg	short loc_1000294B
		jl	short loc_10002915
		cmp	esi, eax
		ja	short loc_1000294B

loc_10002915:				; CODE XREF: sub_1000289D+72j
		mov	eax, [edi+2Ch]
		sub	ecx, [esp+18h+var_4]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [edi+1Ch]
		add	[eax], ecx
		test	byte ptr [esp+18h+arg_1C], 2
		jz	short loc_10002999
		mov	edx, [edi+20h]
		cmp	dword ptr [edx], 0
		jz	short loc_10002999
		mov	eax, [edi+30h]
		mov	ecx, [eax]
		mov	eax, [edi+1Ch]
		add	ecx, [edx]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [edi+30h]
		mov	[eax], ecx
		jmp	short loc_10002999
; ---------------------------------------------------------------------------

loc_1000294B:				; CODE XREF: sub_1000289D+5Bj
					; sub_1000289D+61j ...
		mov	esi, [esp+18h+var_8]
		jmp	short loc_10002997
; ---------------------------------------------------------------------------

loc_10002951:				; CODE XREF: sub_1000289D+57j
		mov	eax, ecx

loc_10002953:				; CODE XREF: sub_1000289D+4Aj
		test	byte ptr [esp+18h+arg_1C], 2
		jz	short loc_10002995
		mov	ecx, [edx]
		mov	[esp+18h+arg_1C], ecx
		test	ecx, ecx
		jz	short loc_10002995
		test	ebx, ebx
		jl	short loc_1000294B
		jg	short loc_1000296E
		test	esi, esi
		jb	short loc_1000294B

loc_1000296E:				; CODE XREF: sub_1000289D+CBj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		cdq
		cmp	ebx, edx
		jg	short loc_1000294B
		jl	short loc_10002983
		cmp	esi, eax
		ja	short loc_1000294B

loc_10002983:				; CODE XREF: sub_1000289D+E0j
		mov	eax, [edi+30h]
		sub	ecx, [esp+18h+arg_1C]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [edi+20h]
		add	[eax], ecx
		jmp	short loc_10002999
; ---------------------------------------------------------------------------

loc_10002995:				; CODE XREF: sub_1000289D+BBj
					; sub_1000289D+C5j
		mov	esi, eax

loc_10002997:				; CODE XREF: sub_1000289D+B2j
		mov	ebx, ebp

loc_10002999:				; CODE XREF: sub_1000289D+3Fj
					; sub_1000289D+8Dj ...
		mov	eax, [esp+18h+arg_0]
		xor	ecx, ecx
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+4], ebx
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		pop	ebx
		pop	ecx
		pop	ecx
		retn	20h
sub_1000289D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100029B6(void *)
sub_100029B6	proc near		; CODE XREF: sub_100035CB+80p

var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	edx, ecx
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		test	byte ptr [edx+3Ch], 2
		jnz	short loc_10002A1A
		mov	eax, [edx+20h]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_10002A1A
		cmp	[edx+38h], ecx
		jb	short loc_100029E4
		mov	ecx, [edx+38h]

loc_100029E4:				; CODE XREF: sub_100029B6+29j
		mov	eax, [edx+10h]
		sub	ecx, [eax]
		push	ecx		; size_t
		push	dword ptr [eax]	; void *
		lea	ecx, [ebp+var_1C]
		call	sub_10001E69
		xor	ebx, ebx
		mov	dword ptr [esi+14h], 0Fh
		lea	eax, [ebp+var_1C]
		mov	[esi+10h], ebx
		push	eax		; void *
		mov	ecx, esi	; void *
		mov	[esi], bl
		call	sub_10002104
		push	ebx		; size_t
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_10001769
		jmp	short loc_10002A7A
; ---------------------------------------------------------------------------

loc_10002A1A:				; CODE XREF: sub_100029B6+1Bj
					; sub_100029B6+24j
		test	byte ptr [edx+3Ch], 4
		push	edi
		jnz	short loc_10002A4D
		mov	eax, [edx+1Ch]
		mov	edi, [eax]
		test	edi, edi
		jz	short loc_10002A4D
		mov	eax, [edx+0Ch]
		mov	ecx, [eax]
		mov	eax, [edx+2Ch]
		mov	eax, [eax]
		sub	eax, ecx
		add	eax, edi
		push	eax		; size_t
		push	ecx		; void *
		lea	ecx, [ebp+var_1C]
		call	sub_10001E69
		mov	dword ptr [esi+14h], 0Fh
		xor	ebx, ebx
		jmp	short loc_10002A5E
; ---------------------------------------------------------------------------

loc_10002A4D:				; CODE XREF: sub_100029B6+69j
					; sub_100029B6+72j
		push	0Fh
		pop	eax
		xor	ebx, ebx
		mov	[ebp+var_8], eax
		mov	[ebp+var_C], ebx
		mov	[ebp+var_1C], bl
		mov	[esi+14h], eax

loc_10002A5E:				; CODE XREF: sub_100029B6+95j
		lea	eax, [ebp+var_1C]
		mov	[esi+10h], ebx
		push	eax		; void *
		mov	ecx, esi	; void *
		mov	[esi], bl
		call	sub_10002104
		push	ebx		; size_t
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_10001769
		pop	edi

loc_10002A7A:				; CODE XREF: sub_100029B6+62j
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100029B6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002A8E	proc near		; DATA XREF: .rdata:1001C928o
		push	esi
		mov	esi, [ecx+1Ch]
		mov	edx, [esi]
		test	edx, edx
		jnz	short loc_10002A9D
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10002A9D:				; CODE XREF: sub_10002A8E+8j
		push	edi
		mov	edi, [ecx+2Ch]
		mov	eax, [edi]
		add	eax, edx
		cmp	edx, eax
		jnb	short loc_10002AAE
		movzx	eax, byte ptr [edx]
		jmp	short loc_10002AE2
; ---------------------------------------------------------------------------

loc_10002AAE:				; CODE XREF: sub_10002A8E+19j
		test	byte ptr [ecx+3Ch], 4
		jnz	short loc_10002ADF
		mov	eax, [ecx+20h]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_10002ADF
		cmp	eax, edx
		ja	short loc_10002AC6
		cmp	[ecx+38h], edx
		jbe	short loc_10002ADF

loc_10002AC6:				; CODE XREF: sub_10002A8E+31j
		cmp	[ecx+38h], eax
		jnb	short loc_10002ACE
		mov	[ecx+38h], eax

loc_10002ACE:				; CODE XREF: sub_10002A8E+3Bj
		mov	eax, [ecx+38h]
		sub	eax, [esi]
		mov	[edi], eax
		mov	eax, [ecx+1Ch]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		jmp	short loc_10002AE2
; ---------------------------------------------------------------------------

loc_10002ADF:				; CODE XREF: sub_10002A8E+24j
					; sub_10002A8E+2Dj ...
		or	eax, 0FFFFFFFFh

loc_10002AE2:				; CODE XREF: sub_10002A8E+1Ej
					; sub_10002A8E+4Fj
		pop	edi
		pop	esi
		retn
sub_10002A8E	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10002AE5(void	*, void	*, int)
sub_10002AE5	proc near		; CODE XREF: sub_10002479+52p
					; sub_10003B8A+17p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		add	eax, eax
		push	eax		; size_t
		push	[esp+4+arg_4]	; void *
		push	[esp+8+arg_0]	; void *
		call	ds:memmove
		add	esp, 0Ch
		retn
sub_10002AE5	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10002AFE(void *, int)
sub_10002AFE	proc near		; CODE XREF: sub_10002C02+2Bp
					; sub_10002D0B+2Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	[esp+4+arg_4]	; int
		mov	esi, ecx
		xor	eax, eax
		push	[esp+8+arg_0]	; void *
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_100023C8
		mov	eax, esi
		pop	esi
		retn	8
sub_10002AFE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002B24	proc near		; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+48p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	ecx, esi
		push	edi
		mov	edi, offset aDummy ; "dummy"
		push	edi
		mov	eax, [esi]
		push	6
		push	1
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	edi
		push	7
		push	2
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	offset aHkey_current_4 ; "HKEY_CURRENT_USER\\dummy"
		push	0Bh
		push	3
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	edi
		push	0Ah
		push	4
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	edi
		push	5
		push	5
		call	dword ptr [eax+5Ch]
		pop	edi
		pop	esi
		retn
sub_10002B24	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002B72	proc near		; CODE XREF: sub_10002B92+42p
					; sub_10002C02+46p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, dword_10033090
		test	eax, eax
		jz	short locret_10002B91
		push	0
		push	0
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	offset aBrokerAllowed ;	"Broker	ALLOWED"
		call	eax ; dword_10033090
		add	esp, 14h

locret_10002B91:			; CODE XREF: sub_10002B72+7j
		retn
sub_10002B72	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10002B92(int,	void *)
sub_10002B92	proc near		; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+172p
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+183p

var_34		= byte ptr -34h
var_1C		= dword	ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		cmp	dword_10033090,	0
		mov	eax, [ebp+arg_4]
		push	esi
		mov	esi, [ebp+arg_0]
		jz	short loc_10002BF3
		push	eax		; void *
		lea	ecx, [ebp+var_1C]
		call	sub_10001E8D
		lea	eax, [ebp+var_1C]
		push	eax		; int
		lea	eax, [ebp+var_34]
		push	eax		; void *
		call	sub_10004CB1
		pop	ecx
		pop	ecx
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002BD2
		mov	eax, [eax]

loc_10002BD2:				; CODE XREF: sub_10002B92+3Cj
		push	eax
		push	esi
		call	sub_10002B72
		pop	ecx
		pop	ecx
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_10001769
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1

loc_10002BF3:				; CODE XREF: sub_10002B92+1Ej
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002B92	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10002C02(int,	void *,	int)
sub_10002C02	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+1FEp
					; TargetNtOpenFile(x,x,x,x,x,x,x)+1DFp	...

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		cmp	dword_10033090,	0
		mov	eax, [ebp+arg_8]
		mov	ecx, [ebp+arg_4]
		push	esi
		mov	esi, [ebp+arg_0]
		movzx	eax, ax
		jz	short loc_10002C67
		push	eax		; int
		push	ecx		; void *
		lea	ecx, [ebp+var_34]
		call	sub_10002AFE
		push	eax		; int
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		call	sub_10004CB1
		pop	ecx
		pop	ecx
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002C46
		mov	eax, [eax]

loc_10002C46:				; CODE XREF: sub_10002C02+40j
		push	eax
		push	esi
		call	sub_10002B72
		pop	ecx
		pop	ecx
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_10001769
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1

loc_10002C67:				; CODE XREF: sub_10002C02+24j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002C02	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002C76	proc near		; CODE XREF: sub_10002C98+44p
					; sub_10002D0B+48p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, dword_10033090
		test	eax, eax
		jz	short locret_10002C97
		push	[esp+arg_8]
		push	1
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		push	offset aBlocked	; "BLOCKED"
		call	eax ; dword_10033090
		add	esp, 14h

locret_10002C97:			; CODE XREF: sub_10002C76+7j
		retn
sub_10002C76	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10002C98(int,	void *)
sub_10002C98	proc near		; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+9Bp
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+9Dp

var_34		= byte ptr -34h
var_1C		= dword	ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		cmp	dword_10033090,	0
		mov	eax, [ebp+arg_4]
		push	esi
		mov	esi, [ebp+arg_0]
		jz	short loc_10002CFC
		push	eax		; void *
		lea	ecx, [ebp+var_1C]
		call	sub_10001E8D
		lea	eax, [ebp+var_1C]
		push	eax		; int
		lea	eax, [ebp+var_34]
		push	eax		; void *
		call	sub_10004CB1
		pop	ecx
		pop	ecx
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002CD8
		mov	eax, [eax]

loc_10002CD8:				; CODE XREF: sub_10002C98+3Cj
		push	3
		push	eax
		push	esi
		call	sub_10002C76
		add	esp, 0Ch
		lea	ecx, [ebp+var_34] ; void *
		push	0		; size_t
		push	1		; char
		call	sub_10001769
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1

loc_10002CFC:				; CODE XREF: sub_10002C98+1Ej
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002C98	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10002D0B(int,	void *,	int)
sub_10002D0B	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+63p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+55p ...

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		cmp	dword_10033090,	0
		mov	eax, [ebp+arg_8]
		mov	ecx, [ebp+arg_4]
		push	esi
		mov	esi, [ebp+arg_0]
		movzx	eax, ax
		jz	short loc_10002D73
		push	eax		; int
		push	ecx		; void *
		lea	ecx, [ebp+var_34]
		call	sub_10002AFE
		push	eax		; int
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		call	sub_10004CB1
		pop	ecx
		pop	ecx
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002D4F
		mov	eax, [eax]

loc_10002D4F:				; CODE XREF: sub_10002D0B+40j
		push	3
		push	eax
		push	esi
		call	sub_10002C76
		add	esp, 0Ch
		lea	ecx, [ebp+var_1C] ; void *
		push	0		; size_t
		push	1		; char
		call	sub_10001769
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1

loc_10002D73:				; CODE XREF: sub_10002D0B+24j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002D0B	endp

; Exported entry  10. ?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z

; =============== S U B	R O U T	I N E =======================================


; void __cdecl mozilla::sandboxing::ProvideLogFunction(mozilla::sandboxing *this, void (__cdecl	*)(const char *, const char *, const char *, bool, unsigned int))
		public ?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z
?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z proc near
					; DATA XREF: .rdata:off_10030468o

this		= dword	ptr  4

		mov	eax, [esp+this]
		mov	dword_10033090,	eax
		retn
?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002D8C	proc near		; CODE XREF: sub_10002E8D+14p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	10h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10002DB2
		mov	ecx, [ebp+arg_4]
		push	[ebp+arg_8]
		mov	[ebp+var_4], ecx
		lea	ecx, [ebp+var_4]
		push	ecx
		mov	ecx, eax
		call	sub_10002E0F
		jmp	short loc_10002DB4
; ---------------------------------------------------------------------------

loc_10002DB2:				; CODE XREF: sub_10002D8C+Ej
		xor	eax, eax

loc_10002DB4:				; CODE XREF: sub_10002D8C+24j
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ecx, esi
		push	eax
		call	sub_100030E4
		mov	dword ptr [esi+4], offset sub_10002F23
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10002D8C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002DCE	proc near		; CODE XREF: sub_10002F2F+A1p
					; sub_10002F2F+B6p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		test	edx, edx
		jz	short loc_10002DEA
		push	esi
		mov	esi, [esp+4+arg_8]

loc_10002DDF:				; CODE XREF: sub_10002DCE+19j
		mov	eax, [esi]
		mov	[ecx], eax
		add	ecx, 4
		dec	edx
		jnz	short loc_10002DDF
		pop	esi

loc_10002DEA:				; CODE XREF: sub_10002DCE+Aj
		mov	eax, ecx
		retn
sub_10002DCE	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10002DED(void	*, int,	void *)
sub_10002DED	proc near		; CODE XREF: sub_10002F2F+69p
					; sub_10002F2F+98p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_4]
		sub	esi, [esp+4+arg_0]
		and	esi, 0FFFFFFFCh
		push	esi		; size_t
		push	[esp+8+arg_0]	; void *
		push	[esp+0Ch+arg_8]	; void *
		call	ds:memmove
		add	esp, 0Ch
		add	eax, esi
		pop	esi
		retn
sub_10002DED	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002E0F	proc near		; CODE XREF: sub_10002D8C+1Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, ecx
		lea	ecx, [esi+4]
		call	sub_10003596
		mov	eax, [esp+4+arg_0]
		mov	dword ptr [esi], offset	off_1001C9BC
		mov	eax, [eax]
		mov	[esi+8], eax
		mov	eax, [esp+4+arg_4]
		mov	eax, [eax]
		mov	[esi+0Ch], eax
		mov	eax, esi
		pop	esi
		retn	8
sub_10002E0F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002E38	proc near		; CODE XREF: sub_10003068+70p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, ecx
		mov	eax, [edi]
		mov	[esi], eax
		test	eax, eax
		jz	short loc_10002E4F
		push	eax
		call	sub_10002E81
		pop	ecx

loc_10002E4F:				; CODE XREF: sub_10002E38+Ej
		mov	eax, [edi+4]
		mov	[esi+4], eax
		mov	eax, esi
		pop	edi
		pop	esi
		retn	4
sub_10002E38	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10002E5C(void *, char)
sub_10002E5C	proc near		; DATA XREF: .rdata:off_1001C9BCo

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		lea	ecx, [esi+4]
		mov	dword ptr [esi], offset	off_1001C9BC
		call	nullsub_1
		test	[esp+4+arg_0], 1
		jz	short loc_10002E7B
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10002E7B:				; CODE XREF: sub_10002E5C+16j
		mov	eax, esi
		pop	esi
		retn	4
sub_10002E5C	endp

; [0000000C BYTES: COLLAPSED FUNCTION sub_10002E81]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002E8D	proc near		; CODE XREF: sub_10003404+17p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	ecx
		push	ecx
		mov	eax, esp
		lea	ecx, [ebp+arg_4]
		push	ecx
		push	[ebp+arg_0]
		push	eax
		call	sub_10002D8C
		add	esp, 0Ch
		call	sub_10002EB4
		pop	ecx
		pop	ecx
		mov	esp, ebp
		pop	ebp
		retn
sub_10002E8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002EB4	proc near		; CODE XREF: sub_10002E8D+1Cp

var_4		= dword	ptr -4
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		mov	esi, lpCriticalSection
		test	esi, esi
		jz	short loc_10002EE7
		mov	ecx, esi	; lpCriticalSection
		call	sub_10004D93
		mov	ecx, lpCriticalSection
		lea	eax, [ebp+arg_0]
		push	eax
		lea	ecx, [ecx+18h]
		call	sub_10003068
		mov	ecx, esi	; lpCriticalSection
		call	sub_10004D9B

loc_10002EE7:				; CODE XREF: sub_10002EB4+11j
		lea	ecx, [ebp+arg_0]
		call	sub_1000310C
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10002EB4	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10002F17

loc_10002EF4:				; CODE XREF: sub_10002F17+7j
		push	esi
		mov	esi, ecx
		call	sub_100035A5
		test	al, al
		jz	short loc_10002F15
		test	esi, esi
		jz	short loc_10002F09
		lea	ecx, [esi-4]
		jmp	short loc_10002F0B
; ---------------------------------------------------------------------------

loc_10002F09:				; CODE XREF: sub_10002F17-15j
		xor	ecx, ecx

loc_10002F0B:				; CODE XREF: sub_10002F17-10j
		test	ecx, ecx
		jz	short loc_10002F15
		mov	eax, [ecx]
		push	1
		call	dword ptr [eax]

loc_10002F15:				; CODE XREF: sub_10002F17-19j
					; sub_10002F17-Aj
		pop	esi
		retn
; END OF FUNCTION CHUNK	FOR sub_10002F17

; =============== S U B	R O U T	I N E =======================================


sub_10002F17	proc near		; CODE XREF: sub_1000310C+7p

arg_0		= dword	ptr  4

; FUNCTION CHUNK AT 10002EF4 SIZE 00000023 BYTES

		mov	ecx, [esp+arg_0]
		lea	ecx, [ecx+4]
		jmp	loc_10002EF4
sub_10002F17	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F23	proc near		; DATA XREF: sub_10002D8C+34o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	dword ptr [eax+0Ch]
		call	dword ptr [eax+8]
		pop	ecx
		retn
sub_10002F23	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F2F	proc near		; CODE XREF: sub_10003068+1Dp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		push	edi
		mov	ecx, [ebx+8]
		test	ecx, ecx
		jz	short loc_10002F40
		mov	edi, ecx
		jmp	short loc_10002F43
; ---------------------------------------------------------------------------

loc_10002F40:				; CODE XREF: sub_10002F2F+Bj
		xor	edi, edi
		inc	edi

loc_10002F43:				; CODE XREF: sub_10002F2F+Fj
					; sub_10002F2F+34j
		mov	eax, edi
		sub	eax, ecx
		cmp	eax, [esp+10h+arg_0]
		jb	short loc_10002F52
		cmp	edi, 8
		jnb	short loc_10002F65

loc_10002F52:				; CODE XREF: sub_10002F2F+1Cj
		mov	eax, 0FFFFFFFh
		sub	eax, edi
		cmp	eax, edi
		jb	loc_1000305C
		add	edi, edi
		jmp	short loc_10002F43
; ---------------------------------------------------------------------------

loc_10002F65:				; CODE XREF: sub_10002F2F+21j
		push	ebp
		mov	ebp, [ebx+0Ch]
		sub	edi, ecx
		push	esi
		push	0
		shr	ebp, 1
		lea	eax, [ecx+edi]
		push	eax
		call	sub_10005F4A
		mov	edx, [ebx+4]
		mov	ecx, [ebx+8]
		push	[esp+20h+arg_0]
		mov	[esp+24h+var_8], eax
		lea	eax, [eax+ebp*4]
		lea	esi, [edx+ecx*4]
		lea	ecx, [edx+ebp*4]
		lea	edx, [esp+24h+arg_0]
		push	edx
		push	eax		; void *
		push	esi		; int
		push	ecx		; void *
		call	sub_10002DED
		add	esp, 1Ch
		mov	esi, eax
		cmp	ebp, edi
		ja	short loc_10002FEF
		mov	edx, [ebx+4]
		lea	eax, [esp+18h+var_4]
		and	[esp+18h+var_4], 0
		push	eax
		mov	eax, edi
		sub	eax, ebp
		lea	ecx, [edx+ebp*4]
		push	eax
		push	[esp+20h+arg_0]
		lea	eax, [esp+24h+arg_0]
		push	eax
		push	esi		; void *
		push	ecx		; int
		push	edx		; void *
		call	sub_10002DED
		add	esp, 14h
		push	eax
		call	sub_10002DCE
		mov	esi, [esp+24h+var_8]
		lea	eax, [esp+24h+arg_0]
		and	[esp+24h+arg_0], 0
		push	eax
		push	ebp
		push	esi
		call	sub_10002DCE
		add	esp, 18h
		jmp	short loc_1000303E
; ---------------------------------------------------------------------------

loc_10002FEF:				; CODE XREF: sub_10002F2F+75j
		push	[esp+18h+arg_0]
		mov	ecx, [ebx+4]
		lea	eax, [esp+1Ch+arg_0]
		push	eax
		push	esi		; void *
		lea	eax, [ecx+edi*4]
		push	eax		; int
		push	ecx		; void *
		call	sub_10002DED
		mov	eax, [ebx+4]
		lea	edx, [esp+2Ch+var_4]
		mov	esi, [esp+2Ch+var_8]
		add	esp, 14h
		and	[esp+18h+var_4], 0
		lea	ecx, [eax+ebp*4]
		push	edx
		push	edi
		push	[esp+20h+arg_0]
		lea	edx, [esp+24h+arg_0]
		push	edx
		push	esi		; void *
		lea	eax, [eax+edi*4]
		push	ecx		; int
		push	eax		; void *
		call	sub_10002DED
		add	esp, 14h
		push	eax
		call	sub_10002DCE
		add	esp, 0Ch

loc_1000303E:				; CODE XREF: sub_10002F2F+BEj
		cmp	dword ptr [ebx+4], 0
		jz	short loc_1000304D
		push	dword ptr [ebx+4] ; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1000304D:				; CODE XREF: sub_10002F2F+113j
		add	[ebx+8], edi
		mov	[ebx+4], esi
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		pop	ecx
		pop	ecx
		retn	4
; ---------------------------------------------------------------------------

loc_1000305C:				; CODE XREF: sub_10002F2F+2Cj
		push	offset aDequeTTooLong ;	"deque<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)
		int	3		; Trap to Debugger
sub_10002F2F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003068	proc near		; CODE XREF: sub_10002EB4+27p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	eax, [esi+0Ch]
		mov	ecx, [esi+10h]
		add	eax, ecx
		test	al, 1
		jnz	short loc_1000308A
		lea	eax, [ecx+2]
		shr	eax, 1
		cmp	[esi+8], eax
		ja	short loc_1000308A
		push	1
		mov	ecx, esi
		call	sub_10002F2F

loc_1000308A:				; CODE XREF: sub_10003068+Dj
					; sub_10003068+17j
		mov	ecx, [esi+8]
		push	ebx
		push	edi
		mov	edi, [esi+10h]
		lea	eax, ds:0FFFFFFFFh[ecx*2]
		and	[esi+0Ch], eax
		lea	ebx, [ecx-1]
		add	edi, [esi+0Ch]
		mov	eax, edi
		shr	eax, 1
		and	ebx, eax
		mov	eax, [esi+4]
		cmp	dword ptr [eax+ebx*4], 0
		jnz	short loc_100030C2
		push	0
		push	2
		call	sub_100144B1
		pop	ecx
		pop	ecx
		mov	ecx, [esi+4]
		mov	[ecx+ebx*4], eax

loc_100030C2:				; CODE XREF: sub_10003068+47j
		mov	eax, [esi+4]
		and	edi, 1
		mov	eax, [eax+ebx*4]
		lea	ecx, [eax+edi*8]
		pop	edi
		pop	ebx
		test	ecx, ecx
		jz	short loc_100030DD
		push	[esp+4+arg_0]
		call	sub_10002E38

loc_100030DD:				; CODE XREF: sub_10003068+6Aj
		inc	dword ptr [esi+10h]
		pop	esi
		retn	4
sub_10003068	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100030E4	proc near		; CODE XREF: sub_10002D8C+2Fp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_0]
		and	[ebp+var_4], 0
		push	esi
		mov	esi, ecx
		mov	[esi], eax
		test	eax, eax
		jz	short loc_100030FF
		push	eax
		call	sub_10002E81
		pop	ecx

loc_100030FF:				; CODE XREF: sub_100030E4+12j
		and	dword ptr [esi+4], 0
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100030E4	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000310C	proc near		; CODE XREF: sub_10002EB4+36p
		cmp	dword ptr [ecx], 0
		jz	short locret_10003119
		push	dword ptr [ecx]
		call	sub_10002F17
		pop	ecx

locret_10003119:			; CODE XREF: sub_1000310C+3j
		retn
sub_1000310C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000311A	proc near		; CODE XREF: sub_10005910+24p
					; sub_100059CF+14p
		push	ebx
		xor	ebx, ebx
		push	esi
		mov	esi, ecx
		push	offset aUnknown	; "unknown"
		lea	ecx, [esi+28h]
		mov	[esi], ebx
		mov	[esi+4], ebx
		mov	[esi+8], ebx
		mov	[esi+0Ch], ebx
		mov	[esi+10h], ebx
		mov	[esi+14h], ebx
		mov	[esi+18h], ebx
		mov	[esi+1Ch], ebx
		mov	[esi+20h], ebx
		mov	[esi+24h], ebx
		call	sub_10001075
		mov	dword ptr [esi+54h], 0Fh
		mov	ecx, esi
		mov	[esi+50h], ebx
		mov	[esi+40h], bl
		call	sub_10003163
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_1000311A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003163	proc near		; CODE XREF: sub_1000311A+3Fp

var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_4		= dword	ptr -4

		sub	esp, 50h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+50h+var_4], eax
		or	[esp+50h+var_50], 0FFFFFFFFh
		xor	eax, eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		lea	edi, [esp+60h+var_4C]
		mov	ebp, ecx
		stosd
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		mov	[esp+60h+var_38], ebp
		push	0Ch		; size_t
		stosd
		stosd
		xor	eax, eax
		cpuid
		mov	[esi], eax
		lea	edi, [esp+64h+var_34]
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		lea	esi, [esp+64h+var_4C]
		mov	ecx, [esp+64h+var_48]
		mov	eax, [esp+64h+var_44]
		mov	[esp+64h+var_48], eax
		lea	eax, [esp+64h+var_34]
		mov	[esp+64h+var_44], ecx
		lea	ecx, [ebp+28h]
		movsd
		push	eax		; void *
		movsd
		movsd
		call	sub_1000183E
		cmp	[esp+60h+var_50], 0
		jle	loc_100032C4
		xor	eax, eax
		lea	esi, [esp+60h+var_50]
		inc	eax
		xor	ecx, ecx
		cpuid
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	esi, [esp+60h+var_50]
		mov	eax, esi
		push	0Fh
		pop	edi
		and	eax, edi
		mov	ebx, [esp+60h+var_48]
		mov	[ebp+10h], eax
		mov	edx, esi
		sar	edx, 0Ch
		mov	ecx, esi
		sar	ecx, 4
		mov	eax, edx
		and	eax, 0F0h
		mov	[ebp+0], esi
		and	ecx, edi
		and	edx, 3
		add	ecx, eax
		mov	[ebp+4], edx
		mov	eax, esi
		mov	[ebp+0Ch], ecx
		sar	eax, 8
		mov	ecx, [esp+60h+var_44]
		and	eax, edi
		mov	[ebp+8], eax
		mov	eax, esi
		sar	eax, 10h
		and	eax, edi
		sar	esi, 14h
		mov	[ebp+14h], eax
		and	esi, 0FFh
		mov	eax, ecx
		mov	[ebp+18h], esi
		shr	eax, 17h
		and	al, 1
		mov	[ebp+1Ch], al
		mov	eax, ecx
		shr	eax, 19h
		and	al, 1
		shr	ecx, 1Ah
		mov	[ebp+1Dh], al
		and	cl, 1
		mov	al, bl
		mov	[ebp+1Eh], cl
		and	al, 1
		mov	[ebp+1Fh], al
		mov	eax, ebx
		shr	eax, 9
		and	al, 1
		mov	[ebp+20h], al
		mov	eax, ebx
		shr	eax, 13h
		and	al, 1
		mov	[ebp+21h], al
		mov	eax, ebx
		shr	eax, 14h
		and	al, 1
		mov	[ebp+22h], al
		mov	eax, ebx
		shr	eax, 1Ch
		and	al, 1
		push	0
		mov	[ebp+24h], al
		pop	eax
		jz	short loc_100032B8
		test	ebx, 4000000h
		jz	short loc_100032B8
		test	ebx, 8000000h
		jz	short loc_100032B8
		xor	ecx, ecx
		xgetbv
		and	eax, 6
		cmp	eax, 6
		jnz	short loc_100032B6
		xor	eax, eax
		cmp	eax, eax
		jnz	short loc_100032B8
		inc	eax
		jmp	short loc_100032B8
; ---------------------------------------------------------------------------

loc_100032B6:				; CODE XREF: sub_10003163+148j
		xor	eax, eax

loc_100032B8:				; CODE XREF: sub_10003163+12Bj
					; sub_10003163+133j ...
		shr	ebx, 19h
		and	bl, 1
		mov	[ebp+23h], al
		mov	[ebp+25h], bl

loc_100032C4:				; CODE XREF: sub_10003163+69j
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		mov	eax, 80000000h
		cpuid
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	ebx, [esp+60h+var_50]
		mov	[esp+60h+var_3C], ebx
		cmp	ebx, 80000004h
		jl	short loc_10003345
		mov	eax, 80000002h
		lea	ebp, [esp+60h+var_34]
		mov	[esp+60h+var_40], eax

loc_100032F9:				; CODE XREF: sub_10003163+1C8j
		lea	ecx, [esp+60h+var_4]
		cmp	ebp, ecx
		jnb	short loc_1000332D
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		cpuid
		mov	[esi], eax
		mov	edi, ebp
		mov	eax, [esp+60h+var_40]
		add	ebp, 10h
		mov	[esi+4], ebx
		inc	eax
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		movsd
		mov	[esp+60h+var_40], eax
		movsd
		movsd
		movsd
		cmp	eax, 80000004h
		jle	short loc_100032F9

loc_1000332D:				; CODE XREF: sub_10003163+19Cj
		lea	eax, [esp+60h+var_34]
		sub	ebp, eax
		push	ebp		; size_t
		mov	ebp, [esp+64h+var_38]
		push	eax		; void *
		lea	ecx, [ebp+40h]
		call	sub_1000183E
		mov	ebx, [esp+60h+var_3C]

loc_10003345:				; CODE XREF: sub_10003163+187j
		mov	eax, 80000007h
		cmp	ebx, eax
		jl	short loc_1000336D
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		cpuid
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	eax, [esp+60h+var_44]
		shr	eax, 8
		and	al, 1
		mov	[ebp+26h], al

loc_1000336D:				; CODE XREF: sub_10003163+1E9j
		mov	ecx, [esp+60h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 50h
		retn
sub_10003163	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10003380	proc near		; CODE XREF: sub_100062C9+8Dp
					; sub_10006399+ABp
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_10003380	endp

; [0000001D BYTES: COLLAPSED FUNCTION unknown_libname_2]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100033A2	proc near		; CODE XREF: sub_10004E1F+5Bp

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		mov	ecx, dword_100330A8
		test	ecx, ecx
		jnz	short loc_100033F3
		push	offset a_thunks	; ".thunks"
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001CAC8
		mov	[ebp+var_4], 10000000h
		call	sub_10005D35
		test	eax, eax
		jz	short loc_100033EA
		push	offset a_syzygy	; ".syzygy"
		lea	ecx, [ebp+var_8]
		call	sub_10005D35
		test	eax, eax
		jz	short loc_100033EA
		xor	ecx, ecx
		inc	ecx
		jmp	short loc_100033ED
; ---------------------------------------------------------------------------

loc_100033EA:				; CODE XREF: sub_100033A2+30j
					; sub_100033A2+41j
		push	2
		pop	ecx

loc_100033ED:				; CODE XREF: sub_100033A2+46j
		mov	dword_100330A8,	ecx

loc_100033F3:				; CODE XREF: sub_100033A2+11j
		xor	eax, eax
		cmp	ecx, 1
		setz	al
		mov	esp, ebp
		pop	ebp
		retn
sub_100033A2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_100033FF	proc near		; CODE XREF: sub_10006187+16p
		jmp	sub_10001A79
sub_100033FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10003404	proc near		; CODE XREF: sub_10005A93+9Bp
					; sub_10006260+25p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_C], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		mov	[eax], ecx
		jz	short loc_10003422
		push	[ebp+arg_8]
		push	[ebp+arg_C]
		call	sub_10002E8D
		pop	ecx
		pop	ecx

loc_10003422:				; CODE XREF: sub_10003404+Fj
		pop	ebp
		retn
sub_10003404	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003424	proc near		; CODE XREF: sub_10005A93+7Cp
					; sub_10006260+Dp ...

arg_0		= dword	ptr  4

		xor	ecx, ecx
		xor	eax, eax
		push	esi
		mov	esi, [esp+4+arg_0]
		inc	ecx
		lock cmpxchg [esi], ecx
		test	eax, eax
		jnz	short loc_1000343F
		mov	al, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000343A:				; CODE XREF: sub_10003424+20j
		call	__Thrd_yield

loc_1000343F:				; CODE XREF: sub_10003424+10j
		mov	eax, [esi]
		cmp	eax, 1
		jz	short loc_1000343A
		xor	al, al
		pop	esi
		retn
sub_10003424	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000344A	proc near		; CODE XREF: sub_10004DA3+Fp
					; sub_10004DE8+1Ep ...
		mov	eax, [esp+0]
		retn
sub_1000344A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000344E(int, size_t, int)
sub_1000344E	proc near		; CODE XREF: sub_100034CC+84p
					; sub_1000377A+3Fp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		mov	edx, ecx
		jnz	short loc_1000346C
		cmp	dword ptr [edx+14h], 10h
		jb	short loc_10003461
		mov	edx, [edx]

loc_10003461:				; CODE XREF: sub_1000344E+Fj
		mov	eax, [ebp+arg_0]
		mov	cl, byte ptr [ebp+arg_8]
		mov	[edx+eax], cl
		jmp	short loc_1000348C
; ---------------------------------------------------------------------------

loc_1000346C:				; CODE XREF: sub_1000344E+9j
		cmp	dword ptr [edx+14h], 10h
		jb	short loc_10003474
		mov	edx, [edx]

loc_10003474:				; CODE XREF: sub_1000344E+22j
		push	[ebp+arg_4]	; size_t
		mov	eax, [ebp+arg_8]
		movsx	eax, al
		push	eax		; int
		mov	eax, [ebp+arg_0]
		add	eax, edx
		push	eax		; void *
		call	memset
		add	esp, 0Ch

loc_1000348C:				; CODE XREF: sub_1000344E+1Cj
		pop	ebp
		retn	0Ch
sub_1000344E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003490	proc near		; CODE XREF: sub_10003571+1Cp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, ecx
		push	edi
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000349E
		mov	eax, [esi]
		jmp	short loc_100034A0
; ---------------------------------------------------------------------------

loc_1000349E:				; CODE XREF: sub_10003490+8j
		mov	eax, esi

loc_100034A0:				; CODE XREF: sub_10003490+Cj
		mov	edi, [esp+8+arg_4]
		test	edi, edi
		jz	short loc_100034AA
		sub	edi, eax

loc_100034AA:				; CODE XREF: sub_10003490+16j
		push	[esp+8+arg_8]	; int
		push	1		; size_t
		push	edi		; int
		call	sub_100034CC
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100034BE
		mov	esi, [esi]

loc_100034BE:				; CODE XREF: sub_10003490+2Aj
		mov	eax, [esp+8+arg_0]
		lea	ecx, [esi+edi]
		pop	edi
		pop	esi
		mov	[eax], ecx
		retn	0Ch
sub_10003490	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100034CC(int, size_t, int)
sub_100034CC	proc near		; CODE XREF: sub_10003490+21p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+10h]
		cmp	ecx, ebx
		jnb	short loc_100034E6
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_100034E6:				; CODE XREF: sub_100034CC+Dj
		or	eax, 0FFFFFFFFh
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_100034FF
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100034FF:				; CODE XREF: sub_100034CC+26j
		test	edi, edi
		jz	short loc_10003569
		push	ebp
		lea	ebp, [ecx+edi]
		mov	ecx, esi
		push	0
		push	ebp
		call	sub_100016CF
		test	al, al
		jz	short loc_10003568
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000351F
		mov	edx, [esi]
		jmp	short loc_10003521
; ---------------------------------------------------------------------------

loc_1000351F:				; CODE XREF: sub_100034CC+4Dj
		mov	edx, esi

loc_10003521:				; CODE XREF: sub_100034CC+51j
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000352B
		mov	ecx, [esi]
		jmp	short loc_1000352D
; ---------------------------------------------------------------------------

loc_1000352B:				; CODE XREF: sub_100034CC+59j
		mov	ecx, esi

loc_1000352D:				; CODE XREF: sub_100034CC+5Dj
		mov	eax, [esi+10h]
		sub	eax, ebx
		jz	short loc_10003548
		push	eax		; size_t
		lea	eax, [edx+ebx]
		push	eax		; void *
		lea	eax, [ecx+ebx]
		add	eax, edi
		push	eax		; void *
		call	ds:memmove
		add	esp, 0Ch

loc_10003548:				; CODE XREF: sub_100034CC+66j
		push	[esp+10h+arg_8]	; int
		mov	ecx, esi
		push	edi		; size_t
		push	ebx		; int
		call	sub_1000344E
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], ebp
		jb	short loc_10003562
		mov	eax, [esi]
		jmp	short loc_10003564
; ---------------------------------------------------------------------------

loc_10003562:				; CODE XREF: sub_100034CC+90j
		mov	eax, esi

loc_10003564:				; CODE XREF: sub_100034CC+94j
		mov	byte ptr [eax+ebp], 0

loc_10003568:				; CODE XREF: sub_100034CC+47j
		pop	ebp

loc_10003569:				; CODE XREF: sub_100034CC+35j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn	0Ch
sub_100034CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10003571	proc near		; CODE XREF: sub_10004B01+Fp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000357E
		mov	edx, [ecx]
		jmp	short loc_10003580
; ---------------------------------------------------------------------------

loc_1000357E:				; CODE XREF: sub_10003571+7j
		mov	edx, ecx

loc_10003580:				; CODE XREF: sub_10003571+Bj
		mov	eax, [ecx+10h]
		push	[ebp+arg_0]
		add	eax, edx
		push	eax
		lea	eax, [ebp+arg_0]
		push	eax
		call	sub_10003490
		pop	ebp
		retn	4
sub_10003571	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003596	proc near		; CODE XREF: sub_10002E0F+6p
		and	dword ptr [ecx], 0
		mov	eax, ecx
		retn
sub_10003596	endp

; [00000001 BYTES: COLLAPSED FUNCTION nullsub_1]
; ---------------------------------------------------------------------------
; [00000008 BYTES: COLLAPSED CHUNK OF FUNCTION sub_10002E81]

; =============== S U B	R O U T	I N E =======================================


sub_100035A5	proc near		; CODE XREF: sub_10002F17-20p
		or	eax, 0FFFFFFFFh
		lock xadd [ecx], eax
		dec	eax
		setnz	al
		test	al, al
		setz	al
		retn
sub_100035A5	endp


; =============== S U B	R O U T	I N E =======================================


sub_100035B6	proc near		; CODE XREF: sub_10005861+2Bp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		jmp	short loc_100035C2
; ---------------------------------------------------------------------------

loc_100035BD:				; CODE XREF: sub_100035B6+11j
		call	__Thrd_yield

loc_100035C2:				; CODE XREF: sub_100035B6+5j
		mov	eax, [esi]
		cmp	eax, 1
		jz	short loc_100035BD
		pop	esi
		retn
sub_100035B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100035CB	proc near		; CODE XREF: sub_1000EE9A+22p

var_98		= byte ptr -98h
var_94		= byte ptr -94h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		lea	ecx, [ebp+var_98]
		push	esi
		push	1
		push	2
		call	sub_10001DE3
		mov	eax, [ebp+arg_4]
		push	offset dword_1001C958
		push	dword ptr [eax]
		mov	eax, [ebp+arg_0]
		push	offset aVs_	; " vs.	"
		push	dword ptr [eax]
		lea	eax, [ebp+var_98]
		push	offset asc_1001C964 ; "	("
		push	[ebp+arg_8]
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(uint)
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(uint)
		push	eax
		call	sub_10001C6D
		push	18h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jz	short loc_10003652
		push	esi		; void *
		lea	ecx, [ebp+var_94]
		call	sub_100029B6
		jmp	short loc_10003654
; ---------------------------------------------------------------------------

loc_10003652:				; CODE XREF: sub_100035CB+77j
		xor	esi, esi

loc_10003654:				; CODE XREF: sub_100035CB+85j
		lea	ecx, [ebp+var_98]
		call	sub_10002098
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100035CB	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10003666(void	*, int,	void *)
sub_10003666	proc near		; CODE XREF: sub_100036ED+1Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_4]
		sub	esi, [esp+4+arg_0]
		push	esi		; size_t
		push	[esp+8+arg_0]	; void *
		push	[esp+0Ch+arg_8]	; void *
		call	ds:memmove
		add	esp, 0Ch
		add	eax, esi
		pop	esi
		retn
sub_10003666	endp

; [00000041 BYTES: COLLAPSED FUNCTION unknown_libname_4]

; =============== S U B	R O U T	I N E =======================================


sub_100036C6	proc near		; CODE XREF: sub_1000373B+2Ep

arg_0		= dword	ptr  4

		mov	edx, [ecx+8]
		or	eax, 0FFFFFFFFh
		sub	edx, [ecx]
		mov	ecx, edx
		shr	ecx, 1
		sub	eax, ecx
		cmp	eax, edx
		jnb	short loc_100036DC
		xor	edx, edx
		jmp	short loc_100036DE
; ---------------------------------------------------------------------------

loc_100036DC:				; CODE XREF: sub_100036C6+10j
		add	edx, ecx

loc_100036DE:				; CODE XREF: sub_100036C6+14j
		cmp	edx, [esp+arg_0]
		jnb	short loc_100036E8
		mov	edx, [esp+arg_0]

loc_100036E8:				; CODE XREF: sub_100036C6+1Cj
		mov	eax, edx
		retn	4
sub_100036C6	endp


; =============== S U B	R O U T	I N E =======================================


sub_100036ED	proc near		; CODE XREF: sub_1000373B+36p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		push	0
		push	ebp
		mov	esi, ecx
		call	sub_10001050
		mov	edi, eax
		lea	eax, [esp+18h+arg_0]
		push	eax
		push	edi		; void *
		push	dword ptr [esi+4] ; int
		push	dword ptr [esi]	; void *
		call	sub_10003666
		mov	ebx, [esi+4]
		add	esp, 18h
		sub	ebx, [esi]
		cmp	dword ptr [esi], 0
		jz	short loc_10003726
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10003726:				; CODE XREF: sub_100036ED+2Fj
		lea	eax, [edi+ebp]
		mov	[esi], edi
		mov	[esi+8], eax
		lea	eax, [ebx+edi]
		pop	edi
		mov	[esi+4], eax
		pop	esi
		pop	ebp
		pop	ebx
		retn	4
sub_100036ED	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000373B	proc near		; CODE XREF: sub_1000E5A5+1Dp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	eax, [esi+8]
		mov	edx, [esi+4]
		sub	eax, edx
		cmp	eax, [esp+4+arg_0]
		jnb	short loc_10003776
		mov	eax, [esi]
		sub	eax, edx
		dec	eax
		cmp	eax, [esp+4+arg_0]
		jnb	short loc_10003762
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003762:				; CODE XREF: sub_1000373B+1Aj
		sub	edx, [esi]
		add	edx, [esp+4+arg_0]
		push	edx
		call	sub_100036C6
		push	eax
		mov	ecx, esi
		call	sub_100036ED

loc_10003776:				; CODE XREF: sub_1000373B+Fj
		pop	esi
		retn	4
sub_1000373B	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000377A(size_t, int)
sub_1000377A	proc near		; CODE XREF: sub_10004824+22p
					; sub_10004C68+35p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, ecx
		or	eax, 0FFFFFFFFh
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+10h]
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_10003799
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003799:				; CODE XREF: sub_1000377A+12j
		test	edi, edi
		jz	short loc_100037D2
		push	ebx
		lea	ebx, [ecx+edi]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_100016CF
		test	al, al
		jz	short loc_100037D1
		push	[esp+0Ch+arg_4]	; int
		mov	ecx, esi
		push	edi		; size_t
		push	dword ptr [esi+10h] ; int
		call	sub_1000344E
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], ebx
		jb	short loc_100037CB
		mov	eax, [esi]
		jmp	short loc_100037CD
; ---------------------------------------------------------------------------

loc_100037CB:				; CODE XREF: sub_1000377A+4Bj
		mov	eax, esi

loc_100037CD:				; CODE XREF: sub_1000377A+4Fj
		mov	byte ptr [eax+ebx], 0

loc_100037D1:				; CODE XREF: sub_1000377A+33j
		pop	ebx

loc_100037D2:				; CODE XREF: sub_1000377A+21j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_1000377A	endp


; =============== S U B	R O U T	I N E =======================================


sub_100037D9	proc near		; CODE XREF: sub_1000484E+19p
					; sub_10011215+ADp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, ecx
		or	eax, 0FFFFFFFFh
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+10h]
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_100037F8
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100037F8:				; CODE XREF: sub_100037D9+12j
		test	edi, edi
		jz	short loc_10003826
		push	ebx
		lea	ebx, [ecx+edi]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_10002221
		test	al, al
		jz	short loc_10003825
		push	[esp+0Ch+arg_4]
		mov	ecx, esi
		push	edi
		push	dword ptr [esi+10h]
		call	unknown_libname_4 ; Microsoft VisualC 2-11/net runtime
		push	ebx
		mov	ecx, esi
		call	sub_100021E0

loc_10003825:				; CODE XREF: sub_100037D9+33j
		pop	ebx

loc_10003826:				; CODE XREF: sub_100037D9+21j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_100037D9	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000382D	proc near		; CODE XREF: sub_10004A56:loc_10004A8Cp
					; sub_10004C68+15p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, eax
		ja	short loc_1000385C
		cmp	[esi+14h], eax
		jz	short loc_1000385C
		push	1
		push	eax
		call	sub_100016CF
		test	al, al
		jz	short loc_1000385C
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], edi
		jb	short loc_10003858
		mov	esi, [esi]

loc_10003858:				; CODE XREF: sub_1000382D+27j
		mov	byte ptr [esi+edi], 0

loc_1000385C:				; CODE XREF: sub_1000382D+Dj
					; sub_1000382D+12j ...
		pop	edi
		pop	esi
		retn	4
sub_1000382D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003861	proc near		; CODE XREF: sub_10019D09+28p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, eax
		ja	short loc_10003889
		cmp	[esi+14h], eax
		jz	short loc_10003889
		push	1
		push	eax
		call	sub_10002221
		test	al, al
		jz	short loc_10003889
		push	edi
		mov	ecx, esi
		call	sub_100021E0

loc_10003889:				; CODE XREF: sub_10003861+Dj
					; sub_10003861+12j ...
		pop	edi
		pop	esi
		retn	4
sub_10003861	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000388E	proc near		; CODE XREF: unknown_libname_4+35p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		test	ecx, ecx
		jz	short loc_100038B3
		mov	eax, [esp+arg_4]
		movzx	edx, ax
		mov	eax, edx
		shl	edx, 10h
		push	edi
		mov	edi, [esp+4+arg_0]
		or	eax, edx
		shr	ecx, 1
		rep stosd
		adc	ecx, ecx
		rep stosw
		pop	edi

loc_100038B3:				; CODE XREF: sub_1000388E+6j
		mov	eax, [esp+arg_0]
		retn
sub_1000388E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100038B8	proc near		; CODE XREF: sub_10003950+2Ap
					; sub_10013687+3Dp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	eax, [ebx+10h]
		mov	esi, ecx
		cmp	eax, ebp
		jnb	short loc_100038D7
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_100038D7:				; CODE XREF: sub_100038B8+12j
		push	edi
		mov	edi, [esp+10h+arg_8]
		sub	eax, ebp
		cmp	eax, edi
		jnb	short loc_100038E4
		mov	edi, eax

loc_100038E4:				; CODE XREF: sub_100038B8+28j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_100038FB
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100038FB:				; CODE XREF: sub_100038B8+36j
		test	edi, edi
		jz	short loc_10003947
		lea	eax, [ecx+edi]
		mov	ecx, esi
		push	0
		push	eax
		mov	[esp+18h+arg_0], eax
		call	sub_10002221
		test	al, al
		jz	short loc_10003947
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_1000391C
		mov	ebx, [ebx]

loc_1000391C:				; CODE XREF: sub_100038B8+60j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003926
		mov	ecx, [esi]
		jmp	short loc_10003928
; ---------------------------------------------------------------------------

loc_10003926:				; CODE XREF: sub_100038B8+68j
		mov	ecx, esi

loc_10003928:				; CODE XREF: sub_100038B8+6Cj
		push	edi		; int
		lea	eax, [ebx+ebp*2]
		push	eax		; void *
		mov	eax, [esi+10h]
		lea	eax, [ecx+eax*2]
		push	eax		; void *
		call	sub_10002435
		add	esp, 0Ch
		mov	ecx, esi
		push	[esp+10h+arg_0]
		call	sub_100021E0

loc_10003947:				; CODE XREF: sub_100038B8+45j
					; sub_100038B8+5Aj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_100038B8	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003950(void *, int)
sub_10003950	proc near		; CODE XREF: sub_1000486F+5Dp
					; sub_1000486F+ABp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, ecx
		push	edi
		call	sub_10002288
		test	al, al
		jz	short loc_10003981
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000396C
		mov	eax, [esi]
		jmp	short loc_1000396E
; ---------------------------------------------------------------------------

loc_1000396C:				; CODE XREF: sub_10003950+16j
		mov	eax, esi

loc_1000396E:				; CODE XREF: sub_10003950+1Aj
		push	[esp+8+arg_4]
		sub	edi, eax
		mov	ecx, esi
		sar	edi, 1
		push	edi
		push	esi
		call	sub_100038B8
		jmp	short loc_100039DC
; ---------------------------------------------------------------------------

loc_10003981:				; CODE XREF: sub_10003950+10j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		sub	eax, ecx
		cmp	eax, ebx
		ja	short loc_1000399D
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000399D:				; CODE XREF: sub_10003950+40j
		test	ebx, ebx
		jz	short loc_100039D9
		push	ebp
		lea	ebp, [ecx+ebx]
		mov	ecx, esi
		push	0
		push	ebp
		call	sub_10002221
		test	al, al
		jz	short loc_100039D8
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100039BD
		mov	ecx, [esi]
		jmp	short loc_100039BF
; ---------------------------------------------------------------------------

loc_100039BD:				; CODE XREF: sub_10003950+67j
		mov	ecx, esi

loc_100039BF:				; CODE XREF: sub_10003950+6Bj
		mov	eax, [esi+10h]
		push	ebx		; int
		push	edi		; void *
		lea	eax, [ecx+eax*2]
		push	eax		; void *
		call	sub_10002435
		add	esp, 0Ch
		mov	ecx, esi
		push	ebp
		call	sub_100021E0

loc_100039D8:				; CODE XREF: sub_10003950+61j
		pop	ebp

loc_100039D9:				; CODE XREF: sub_10003950+4Fj
		mov	eax, esi
		pop	ebx

loc_100039DC:				; CODE XREF: sub_10003950+2Fj
		pop	edi
		pop	esi
		retn	8
sub_10003950	endp


; =============== S U B	R O U T	I N E =======================================


sub_100039E1	proc near		; CODE XREF: sub_10003B6B+13p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= byte ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+20h+var_4], eax
		push	ebx
		mov	ebx, [esp+24h+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+30h+arg_C]
		mov	ecx, edi
		push	dword ptr [edi+4] ; int
		push	dword ptr [edi]	; void *
		call	sub_10003BD7
		mov	eax, [edi]
		xor	esi, esi
		mov	[edi+4], eax
		xor	ecx, ecx
		mov	ebp, [ebx+10h]
		cmp	esi, ebp

loc_10003A15:				; CODE XREF: sub_100039E1+ADj
		jz	short loc_10003A2E
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_10003A21
		mov	eax, [ebx]
		jmp	short loc_10003A23
; ---------------------------------------------------------------------------

loc_10003A21:				; CODE XREF: sub_100039E1+3Aj
		mov	eax, ebx

loc_10003A23:				; CODE XREF: sub_100039E1+3Ej
		mov	dx, [esp+30h+arg_4]
		cmp	[eax+esi*2], dx
		jnz	short loc_10003A8B

loc_10003A2E:				; CODE XREF: sub_100039E1:loc_10003A15j
		mov	eax, esi
		sub	eax, ecx
		push	eax
		push	ecx
		push	ebx
		lea	ecx, [esp+3Ch+var_1C]
		call	sub_10003B41
		cmp	[esp+30h+arg_8], 0
		jz	short loc_10003A55
		lea	eax, [esp+30h+var_1C]
		push	eax		; void *
		push	3		; int
		push	eax		; int
		call	sub_100040AC
		add	esp, 0Ch

loc_10003A55:				; CODE XREF: sub_100039E1+62j
		cmp	esi, ebp
		jnz	short loc_10003A67
		mov	eax, [edi]
		cmp	eax, [edi+4]
		jnz	short loc_10003A67
		cmp	[esp+30h+var_C], 0
		jz	short loc_10003A73

loc_10003A67:				; CODE XREF: sub_100039E1+76j
					; sub_100039E1+7Dj
		lea	eax, [esp+30h+var_1C]
		mov	ecx, edi
		push	eax
		call	sub_10003DFC

loc_10003A73:				; CODE XREF: sub_100039E1+84j
		push	0		; int
		lea	eax, [esi+1]
		push	1		; char
		lea	ecx, [esp+38h+var_1C] ;	void *
		mov	[esp+38h+var_20], eax
		call	sub_100022C1
		mov	ecx, [esp+30h+var_20]

loc_10003A8B:				; CODE XREF: sub_100039E1+4Bj
		inc	esi
		cmp	esi, ebp
		jbe	short loc_10003A15
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 20h
		retn
sub_100039E1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003AA3	proc near		; CODE XREF: sub_10003C23+1Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_8]
		push	edi
		mov	edi, [esp+8+arg_0]
		cmp	edi, [esp+8+arg_4]
		jz	short loc_10003AD0
		sub	edi, esi

loc_10003AB5:				; CODE XREF: sub_10003AA3+2Bj
		test	esi, esi
		jz	short loc_10003AC4
		lea	eax, [edi+esi]
		mov	ecx, esi
		push	eax		; void *
		call	sub_10003AFA

loc_10003AC4:				; CODE XREF: sub_10003AA3+14j
		add	esi, 18h
		lea	ecx, [edi+esi]
		cmp	ecx, [esp+8+arg_4]
		jnz	short loc_10003AB5

loc_10003AD0:				; CODE XREF: sub_10003AA3+Ej
		pop	edi
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10003AA3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003AD7	proc near		; CODE XREF: sub_10004F7A+1Ep
					; sub_100055F9+58p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	0FFFFFFFFh
		push	eax
		push	[esp+0Ch+arg_0]
		mov	dword ptr [esi+14h], 0Fh
		mov	[esi+10h], eax
		mov	[esi], al
		call	sub_100017AB
		mov	eax, esi
		pop	esi
		retn	4
sub_10003AD7	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003AFA(void *)
sub_10003AFA	proc near		; CODE XREF: sub_10003AA3+1Cp
					; sub_10003D92+3Bp ...

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]	; void *
		mov	esi, ecx
		xor	eax, eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_10003B8A
		mov	eax, esi
		pop	esi
		retn	4
sub_10003AFA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003B1C	proc near		; CODE XREF: sub_10003DFC+3Bp
					; sub_10003DFC+5Cp ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	0FFFFFFFFh
		push	eax
		push	[esp+0Ch+arg_0]
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_10002344
		mov	eax, esi
		pop	esi
		retn	4
sub_10003B1C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003B41	proc near		; CODE XREF: sub_100039E1+58p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	[esp+4+arg_8]
		mov	esi, ecx
		xor	eax, eax
		push	[esp+8+arg_4]
		push	[esp+0Ch+arg_0]
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_10002344
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10003B41	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10003B6B	proc near		; CODE XREF: sub_1000FD37+4Dp
					; sub_1000FD37+67p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	[ebp+arg_8]
		and	[ebp+var_4], 0
		push	1
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100039E1
		add	esp, 10h
		mov	esp, ebp
		pop	ebp
		retn
sub_10003B6B	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10003B8A(void *, void *)
sub_10003B8A	proc near		; CODE XREF: sub_10003AFA+17p
					; sub_1000402F+18p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		cmp	dword ptr [esi+14h], 8
		jnb	short loc_10003BAB
		mov	eax, [esi+10h]
		inc	eax
		jz	short loc_10003BB6
		push	eax		; int
		push	esi		; void *
		push	edi		; void *
		call	sub_10002AE5
		add	esp, 0Ch
		jmp	short loc_10003BB6
; ---------------------------------------------------------------------------

loc_10003BAB:				; CODE XREF: sub_10003B8A+Cj
		test	edi, edi
		jz	short loc_10003BB3
		mov	eax, [esi]
		mov	[edi], eax

loc_10003BB3:				; CODE XREF: sub_10003B8A+23j
		and	dword ptr [esi], 0

loc_10003BB6:				; CODE XREF: sub_10003B8A+12j
					; sub_10003B8A+1Fj
		mov	eax, [esi+10h]
		mov	[edi+10h], eax
		mov	eax, [esi+14h]
		mov	[edi+14h], eax
		xor	eax, eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		pop	edi
		mov	[esi], ax
		pop	esi
		retn	4
sub_10003B8A	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003BD7(void *, int)
sub_10003BD7	proc near		; CODE XREF: sub_100039E1+21p
					; sub_10003C23+3Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		jmp	short loc_10003BEC
; ---------------------------------------------------------------------------

loc_10003BDE:				; CODE XREF: sub_10003BD7+19j
		push	0		; int
		push	1		; char
		mov	ecx, esi	; void *
		call	sub_100022C1
		add	esi, 18h

loc_10003BEC:				; CODE XREF: sub_10003BD7+5j
		cmp	esi, [esp+4+arg_4]
		jnz	short loc_10003BDE
		pop	esi
		retn	8
sub_10003BD7	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003BF6	proc near		; CODE XREF: sub_10003C85+3Dp

arg_0		= dword	ptr  4

		mov	eax, [ecx+8]
		sub	eax, [ecx]
		push	18h
		pop	ecx
		cdq
		idiv	ecx
		mov	ecx, 0AAAAAAAh
		mov	edx, eax
		shr	edx, 1
		sub	ecx, edx
		cmp	ecx, eax
		jnb	short loc_10003C14
		xor	eax, eax
		jmp	short loc_10003C16
; ---------------------------------------------------------------------------

loc_10003C14:				; CODE XREF: sub_10003BF6+18j
		add	eax, edx

loc_10003C16:				; CODE XREF: sub_10003BF6+1Cj
		cmp	eax, [esp+arg_0]
		jnb	short locret_10003C20
		mov	eax, [esp+arg_0]

locret_10003C20:			; CODE XREF: sub_10003BF6+24j
		retn	4
sub_10003BF6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003C23	proc near		; CODE XREF: sub_10003C85+45p

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		push	0
		push	ebx
		mov	esi, ecx
		call	sub_100087AC
		pop	ecx
		pop	ecx
		mov	edi, eax
		mov	ecx, esi
		push	edi
		push	dword ptr [esi+4]
		push	dword ptr [esi]
		call	sub_10003AA3
		mov	eax, [esi+4]
		sub	eax, [esi]
		push	18h
		cdq
		pop	ecx
		idiv	ecx
		cmp	dword ptr [esi], 0
		mov	ebp, eax
		jz	short loc_10003C6C
		push	dword ptr [esi+4] ; int
		mov	ecx, esi
		push	dword ptr [esi]	; void *
		call	sub_10003BD7
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10003C6C:				; CODE XREF: sub_10003C23+33j
		imul	eax, ebx, 18h
		mov	[esi], edi
		add	eax, edi
		mov	[esi+8], eax
		imul	eax, ebp, 18h
		add	eax, edi
		pop	edi
		mov	[esi+4], eax
		pop	esi
		pop	ebp
		pop	ebx
		retn	4
sub_10003C23	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003C85	proc near		; CODE XREF: sub_10003D92+29p
					; sub_10003D92+4Fp ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		push	18h
		pop	ebx
		mov	eax, [esi+8]
		mov	ecx, [esi+4]
		sub	eax, ecx
		cdq
		idiv	ebx
		mov	edi, [esp+0Ch+arg_0]
		cmp	eax, edi
		jnb	short loc_10003CCF
		sub	ecx, [esi]
		mov	eax, ecx
		mov	ecx, 0AAAAAAAh
		cdq
		idiv	ebx
		sub	ecx, eax
		cmp	ecx, edi
		jnb	short loc_10003CBD
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003CBD:				; CODE XREF: sub_10003C85+2Bj
		add	eax, edi
		mov	ecx, esi
		push	eax
		call	sub_10003BF6
		push	eax
		mov	ecx, esi
		call	sub_10003C23

loc_10003CCF:				; CODE XREF: sub_10003C85+19j
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_10003C85	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003CD5	proc near		; CODE XREF: sub_10012315+53p
					; sub_10012315+7Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		mov	ebp, [esp+4+arg_8]
		push	esi
		mov	esi, ecx
		mov	ecx, [esp+8+arg_4]
		test	ebp, ebp
		jnz	short loc_10003CEE
		cmp	ecx, [esi+10h]
		ja	short loc_10003CEE
		mov	eax, ecx
		jmp	short loc_10003D5A
; ---------------------------------------------------------------------------

loc_10003CEE:				; CODE XREF: sub_10003CD5+Ej
					; sub_10003CD5+13j
		push	ebx
		mov	ebx, [esi+10h]
		push	edi
		cmp	ecx, ebx
		jnb	short loc_10003D55
		sub	ebx, ecx
		cmp	ebp, ebx
		ja	short loc_10003D55
		xor	eax, eax
		inc	eax
		sub	eax, ebp
		add	ebx, eax
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003D0E
		mov	eax, [esi]
		jmp	short loc_10003D10
; ---------------------------------------------------------------------------

loc_10003D0E:				; CODE XREF: sub_10003CD5+33j
		mov	eax, esi

loc_10003D10:				; CODE XREF: sub_10003CD5+37j
		lea	eax, [eax+ecx*2]
		jmp	short loc_10003D3D
; ---------------------------------------------------------------------------

loc_10003D15:				; CODE XREF: sub_10003CD5+7Ej
		test	ebp, ebp
		jz	short loc_10003D5F
		push	ebp
		push	[esp+14h+arg_0]
		push	edi
		call	sub_10003E85
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10003D5F
		mov	ecx, edi
		or	eax, 0FFFFFFFFh
		sub	ecx, [esp+10h+arg_8]
		sar	ecx, 1
		sub	eax, ecx
		add	ebx, eax
		lea	eax, [edi+2]

loc_10003D3D:				; CODE XREF: sub_10003CD5+3Ej
		push	[esp+10h+arg_0]
		mov	[esp+14h+arg_8], eax
		push	ebx
		push	eax
		call	sub_10003D6F
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_10003D15

loc_10003D55:				; CODE XREF: sub_10003CD5+20j
					; sub_10003CD5+26j
		or	eax, 0FFFFFFFFh

loc_10003D58:				; CODE XREF: sub_10003CD5+98j
		pop	edi
		pop	ebx

loc_10003D5A:				; CODE XREF: sub_10003CD5+17j
		pop	esi
		pop	ebp
		retn	0Ch
; ---------------------------------------------------------------------------

loc_10003D5F:				; CODE XREF: sub_10003CD5+42j
					; sub_10003CD5+54j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003D67
		mov	esi, [esi]

loc_10003D67:				; CODE XREF: sub_10003CD5+8Ej
		sub	edi, esi
		sar	edi, 1
		mov	eax, edi
		jmp	short loc_10003D58
sub_10003CD5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003D6F	proc near		; CODE XREF: sub_10003CD5+72p
					; sub_10004225+35p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	[esp+arg_4], 0
		jnz	short loc_10003D79
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10003D79:				; CODE XREF: sub_10003D6F+5j
		mov	eax, [esp+arg_8]
		push	[esp+arg_4]
		movzx	eax, word ptr [eax]
		push	eax
		push	[esp+8+arg_0]
		call	sub_10003E66
		add	esp, 0Ch
		retn
sub_10003D6F	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003D92(void *)
sub_10003D92	proc near		; CODE XREF: sub_1001514D+162p
					; sub_1001514D+204p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+4]
		cmp	edi, ecx
		jnb	short loc_10003DD8
		cmp	[esi], edi
		ja	short loc_10003DD8
		sub	edi, [esi]
		push	ebx
		mov	eax, edi
		push	18h
		cdq
		pop	ebx
		idiv	ebx
		mov	edi, eax
		cmp	ecx, [esi+8]
		jnz	short loc_10003DC0
		push	1
		mov	ecx, esi
		call	sub_10003C85

loc_10003DC0:				; CODE XREF: sub_10003D92+23j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10003DD2
		imul	eax, edi, 18h
		add	eax, [esi]
		push	eax		; void *
		call	sub_10003AFA

loc_10003DD2:				; CODE XREF: sub_10003D92+33j
		add	[esi+4], ebx
		pop	ebx
		jmp	short loc_10003DF7
; ---------------------------------------------------------------------------

loc_10003DD8:				; CODE XREF: sub_10003D92+Dj
					; sub_10003D92+11j
		cmp	ecx, [esi+8]
		jnz	short loc_10003DE6
		push	1
		mov	ecx, esi
		call	sub_10003C85

loc_10003DE6:				; CODE XREF: sub_10003D92+49j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10003DF3
		push	edi		; void *
		call	sub_10003AFA

loc_10003DF3:				; CODE XREF: sub_10003D92+59j
		add	dword ptr [esi+4], 18h

loc_10003DF7:				; CODE XREF: sub_10003D92+44j
		pop	edi
		pop	esi
		retn	4
sub_10003D92	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003DFC	proc near		; CODE XREF: sub_100039E1+8Dp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+4]
		cmp	edi, ecx
		jnb	short loc_10003E42
		cmp	[esi], edi
		ja	short loc_10003E42
		sub	edi, [esi]
		push	ebx
		mov	eax, edi
		push	18h
		cdq
		pop	ebx
		idiv	ebx
		mov	edi, eax
		cmp	ecx, [esi+8]
		jnz	short loc_10003E2A
		push	1
		mov	ecx, esi
		call	sub_10003C85

loc_10003E2A:				; CODE XREF: sub_10003DFC+23j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10003E3C
		imul	eax, edi, 18h
		add	eax, [esi]
		push	eax
		call	sub_10003B1C

loc_10003E3C:				; CODE XREF: sub_10003DFC+33j
		add	[esi+4], ebx
		pop	ebx
		jmp	short loc_10003E61
; ---------------------------------------------------------------------------

loc_10003E42:				; CODE XREF: sub_10003DFC+Dj
					; sub_10003DFC+11j
		cmp	ecx, [esi+8]
		jnz	short loc_10003E50
		push	1
		mov	ecx, esi
		call	sub_10003C85

loc_10003E50:				; CODE XREF: sub_10003DFC+49j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10003E5D
		push	edi
		call	sub_10003B1C

loc_10003E5D:				; CODE XREF: sub_10003DFC+59j
		add	dword ptr [esi+4], 18h

loc_10003E61:				; CODE XREF: sub_10003DFC+44j
		pop	edi
		pop	esi
		retn	4
sub_10003DFC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003E66	proc near		; CODE XREF: sub_10003D6F+1Ap

arg_0		= dword	ptr  4
arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		test	ecx, ecx
		jz	short loc_10003E82
		mov	dx, [esp+arg_4]
		mov	eax, [esp+arg_0]

loc_10003E77:				; CODE XREF: sub_10003E66+1Aj
		cmp	[eax], dx
		jz	short locret_10003E84
		add	eax, 2
		dec	ecx
		jnz	short loc_10003E77

loc_10003E82:				; CODE XREF: sub_10003E66+6j
		xor	eax, eax

locret_10003E84:			; CODE XREF: sub_10003E66+14j
		retn
sub_10003E66	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003E85	proc near		; CODE XREF: sub_10003CD5+4Ap
					; sub_10004188+42p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		push	esi
		test	ecx, ecx
		jz	short loc_10003EA7
		mov	edx, [esp+4+arg_4]
		mov	esi, [esp+4+arg_0]

loc_10003E96:				; CODE XREF: sub_10003E85+20j
		mov	ax, [esi]
		cmp	ax, [edx]
		jnz	short loc_10003EAB
		add	esi, 2
		add	edx, 2
		dec	ecx
		jnz	short loc_10003E96

loc_10003EA7:				; CODE XREF: sub_10003E85+7j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003EAB:				; CODE XREF: sub_10003E85+17j
		movzx	eax, word ptr [esi]
		cmp	ax, [edx]
		pop	esi
		sbb	eax, eax
		and	eax, 0FFFFFFFEh
		inc	eax
		retn
sub_10003E85	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003EB9	proc near		; CODE XREF: sub_1000406E+11p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		xor	esi, esi
		push	edi
		mov	edx, esi
		lea	edi, [ebx+eax*2]
		jmp	short loc_10003ED9
; ---------------------------------------------------------------------------

loc_10003ECD:				; CODE XREF: sub_10003EB9+23j
		cmp	ebx, edi
		jz	short loc_10003EDE
		movzx	eax, word ptr [ebx]
		or	edx, eax
		add	ebx, 2

loc_10003ED9:				; CODE XREF: sub_10003EB9+12j
		test	bl, 3
		jnz	short loc_10003ECD

loc_10003EDE:				; CODE XREF: sub_10003EB9+16j
		mov	ecx, edi
		and	ecx, 0FFFFFFFCh
		mov	eax, ecx
		sub	eax, ebx
		add	eax, 3
		shr	eax, 2
		cmp	ecx, ebx
		push	ebp
		sbb	ecx, ecx
		mov	ebp, esi
		not	ecx
		and	ecx, eax
		jbe	short loc_10003F04

loc_10003EFA:				; CODE XREF: sub_10003EB9+49j
		or	edx, [ebx]
		add	ebx, 4
		inc	ebp
		cmp	ebp, ecx
		jb	short loc_10003EFA

loc_10003F04:				; CODE XREF: sub_10003EB9+3Fj
		mov	eax, edi
		sub	eax, ebx
		inc	eax
		shr	eax, 1
		cmp	edi, ebx
		pop	ebp
		sbb	ecx, ecx
		not	ecx
		and	ecx, eax
		jz	short loc_10003F23

loc_10003F16:				; CODE XREF: sub_10003EB9+68j
		movzx	eax, word ptr [ebx]
		lea	ebx, [ebx+2]
		or	edx, eax
		inc	esi
		cmp	esi, ecx
		jnz	short loc_10003F16

loc_10003F23:				; CODE XREF: sub_10003EB9+5Bj
		and	edx, 0FF80FF80h
		neg	edx
		pop	edi
		sbb	edx, edx
		pop	esi
		pop	ebx
		lea	eax, [edx+1]
		retn
sub_10003EB9	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10003F34(int,	int, int, void *)
sub_10003F34	proc near		; CODE XREF: sub_100040AC+2Ap

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		test	byte ptr [esp+24h+arg_8], 1
		push	ebx
		push	ebp
		mov	ebp, [esp+2Ch+arg_0]
		push	esi
		mov	esi, [esp+30h+arg_C]
		push	edi
		mov	ebx, [ebp+10h]
		mov	edi, [esp+34h+arg_4]
		lea	eax, [ebx-1]
		mov	[esp+34h+var_20], eax
		jz	short loc_10003F76
		push	0
		push	edi
		mov	ecx, ebp
		call	sub_10004208
		mov	[esp+34h+var_24], eax
		lea	eax, [ebx-1]
		jmp	short loc_10003F7C
; ---------------------------------------------------------------------------

loc_10003F76:				; CODE XREF: sub_10003F34+2Dj
		xor	ecx, ecx
		mov	[esp+34h+var_24], ecx

loc_10003F7C:				; CODE XREF: sub_10003F34+40j
		test	byte ptr [esp+34h+arg_8], 2
		jz	short loc_10003F8D
		push	0FFFFFFFFh
		push	edi
		mov	ecx, ebp
		call	sub_10004286

loc_10003F8D:				; CODE XREF: sub_10003F34+4Dj
		mov	edi, eax
		test	ebx, ebx
		jz	short loc_10003FFB
		mov	ecx, [esp+34h+var_24]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10003FF9
		cmp	edi, 0FFFFFFFFh
		jz	short loc_10003FF9
		and	[esp+34h+var_C], 0
		xor	eax, eax
		mov	[esp+34h+var_1C], ax
		mov	eax, edi
		sub	eax, ecx
		mov	[esp+34h+var_8], 7
		inc	eax
		push	eax
		push	ecx
		push	ebp
		lea	ecx, [esp+40h+var_1C]
		call	sub_10002344
		lea	eax, [esp+34h+var_1C]
		mov	ecx, esi	; void *
		push	eax		; void *
		call	sub_1000402F
		push	0		; int
		push	1		; char
		lea	ecx, [esp+3Ch+var_1C] ;	void *
		call	sub_100022C1
		sub	edi, [esp+34h+var_20]
		mov	ecx, [esp+34h+var_24]
		neg	edi
		sbb	edi, edi
		xor	eax, eax
		and	edi, 2
		test	ecx, ecx
		setnz	al
		or	eax, edi
		jmp	short loc_1000401C
; ---------------------------------------------------------------------------

loc_10003FF9:				; CODE XREF: sub_10003F34+66j
					; sub_10003F34+6Bj
		test	ebx, ebx

loc_10003FFB:				; CODE XREF: sub_10003F34+5Dj
		setz	al
		and	dword ptr [esi+10h], 0
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000400A
		mov	esi, [esi]

loc_1000400A:				; CODE XREF: sub_10003F34+D2j
		movzx	eax, al
		xor	ecx, ecx
		neg	eax
		mov	[esi], cx
		sbb	eax, eax
		not	eax
		and	eax, [esp+34h+arg_8]

loc_1000401C:				; CODE XREF: sub_10003F34+C3j
		mov	ecx, [esp+34h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_10003F34	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000402F(void *, void *)
sub_1000402F	proc near		; CODE XREF: sub_10003F34+99p
					; sub_1000BFCD+8Ep ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		cmp	esi, [esp+4+arg_0]
		jz	short loc_1000404C
		push	0		; int
		push	1		; char
		call	sub_100022C1
		push	[esp+4+arg_0]	; void *
		mov	ecx, esi	; void *
		call	sub_10003B8A

loc_1000404C:				; CODE XREF: sub_1000402F+7j
		mov	eax, esi
		pop	esi
		retn	4
sub_1000402F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004052	proc near		; CODE XREF: sub_10013687+4Bp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		cmp	esi, [esp+4+arg_0]
		jz	short loc_10004068
		push	0FFFFFFFFh
		push	0
		push	[esp+0Ch+arg_0]
		call	sub_10002344

loc_10004068:				; CODE XREF: sub_10004052+7j
		mov	eax, esi
		pop	esi
		retn	4
sub_10004052	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000406E	proc near		; CODE XREF: sub_10004CB1+19p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+14h], 8
		mov	ecx, [eax+10h]
		jb	short loc_1000407D
		mov	eax, [eax]

loc_1000407D:				; CODE XREF: sub_1000406E+Bj
		push	ecx
		push	eax
		call	sub_10003EB9
		pop	ecx
		pop	ecx
		retn
sub_1000406E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004087	proc near		; CODE XREF: sub_10004A92+64p

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0D800h
		jb	short loc_100040A8
		cmp	[esp+arg_0], 0E000h
		jb	short loc_100040A5
		cmp	[esp+arg_0], 10FFFFh
		jbe	short loc_100040A8

loc_100040A5:				; CODE XREF: sub_10004087+12j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100040A8:				; CODE XREF: sub_10004087+8j
					; sub_10004087+1Cj
		xor	eax, eax
		inc	eax
		retn
sub_10004087	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100040AC(int,	int, void *)
sub_100040AC	proc near		; CODE XREF: sub_100039E1+6Cp

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		lea	ecx, [ebp+var_1C]
		push	esi
		mov	esi, [ebp+arg_0]
		push	eax		; void *
		push	[ebp+arg_4]	; int
		push	offset asc_1001CB58 ; "\t\n\v"
		call	sub_10001E8D
		push	eax		; int
		push	esi		; int
		call	sub_10003F34
		add	esp, 10h
		lea	ecx, [ebp+var_1C] ; void *
		mov	esi, eax
		push	0		; int
		push	1		; char
		call	sub_100022C1
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100040AC	endp


; =============== S U B	R O U T	I N E =======================================


sub_100040FD	proc near		; CODE XREF: sub_1000FD37+146p
					; sub_1000FD37+14Fp ...
		push	esi
		mov	esi, ecx
		cmp	dword ptr [esi], 0
		jz	short loc_10004121
		push	dword ptr [esi+4] ; int
		push	dword ptr [esi]	; void *
		call	sub_10003BD7
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		xor	eax, eax
		pop	ecx
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax

loc_10004121:				; CODE XREF: sub_100040FD+6j
		pop	esi
		retn
sub_100040FD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10004123(int, size_t, void *, int)
sub_10004123	proc near		; CODE XREF: sub_10005804+16p
					; sub_10005C71+19p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		mov	eax, [ecx+10h]
		mov	edx, [ebp+arg_0]
		cmp	eax, edx
		jnb	short loc_1000413B
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_1000413B:				; CODE XREF: sub_10004123+Bj
		push	esi
		mov	esi, [ebp+arg_4]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_10004147
		mov	esi, eax

loc_10004147:				; CODE XREF: sub_10004123+20j
		mov	eax, esi
		cmp	esi, [ebp+arg_C]
		jb	short loc_10004151
		mov	eax, [ebp+arg_C]

loc_10004151:				; CODE XREF: sub_10004123+29j
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10004159
		mov	ecx, [ecx]

loc_10004159:				; CODE XREF: sub_10004123+32j
		test	eax, eax
		jz	short loc_10004171
		push	eax		; size_t
		push	[ebp+arg_8]	; void *
		lea	eax, [ecx+edx]
		push	eax		; void *
		call	memcmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10004183

loc_10004171:				; CODE XREF: sub_10004123+38j
		cmp	esi, [ebp+arg_C]
		jnb	short loc_1000417B
		or	eax, 0FFFFFFFFh
		jmp	short loc_10004183
; ---------------------------------------------------------------------------

loc_1000417B:				; CODE XREF: sub_10004123+51j
		xor	eax, eax
		cmp	esi, [ebp+arg_C]
		setnz	al

loc_10004183:				; CODE XREF: sub_10004123+4Cj
					; sub_10004123+56j
		pop	esi
		pop	ebp
		retn	10h
sub_10004123	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004188	proc near		; CODE XREF: sub_10009F23+19p
					; sub_1000BF23+43p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		mov	eax, [ecx+10h]
		mov	edx, [ebp+arg_0]
		cmp	eax, edx
		jnb	short loc_100041A0
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_100041A0:				; CODE XREF: sub_10004188+Bj
		push	esi
		mov	esi, [ebp+arg_4]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_100041AC
		mov	esi, eax

loc_100041AC:				; CODE XREF: sub_10004188+20j
		mov	eax, esi
		cmp	esi, [ebp+arg_C]
		jb	short loc_100041B6
		mov	eax, [ebp+arg_C]

loc_100041B6:				; CODE XREF: sub_10004188+29j
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_100041BE
		mov	ecx, [ecx]

loc_100041BE:				; CODE XREF: sub_10004188+32j
		test	eax, eax
		jz	short loc_100041D6
		push	eax
		push	[ebp+arg_8]
		lea	eax, [ecx+edx*2]
		push	eax
		call	sub_10003E85
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100041E8

loc_100041D6:				; CODE XREF: sub_10004188+38j
		cmp	esi, [ebp+arg_C]
		jnb	short loc_100041E0
		or	eax, 0FFFFFFFFh
		jmp	short loc_100041E8
; ---------------------------------------------------------------------------

loc_100041E0:				; CODE XREF: sub_10004188+51j
		xor	eax, eax
		cmp	esi, [ebp+arg_C]
		setnz	al

loc_100041E8:				; CODE XREF: sub_10004188+4Cj
					; sub_10004188+56j
		pop	esi
		pop	ebp
		retn	10h
sub_10004188	endp


; =============== S U B	R O U T	I N E =======================================


sub_100041ED	proc near		; CODE XREF: sub_1000D1BB+A3p

arg_0		= dword	ptr  4

		cmp	dword ptr [ecx+14h], 8
		jb	short loc_100041F7
		mov	edx, [ecx]
		jmp	short loc_100041F9
; ---------------------------------------------------------------------------

loc_100041F7:				; CODE XREF: sub_100041ED+4j
		mov	edx, ecx

loc_100041F9:				; CODE XREF: sub_100041ED+8j
		mov	eax, [ecx+10h]
		lea	ecx, [edx+eax*2]
		mov	eax, [esp+arg_0]
		mov	[eax], ecx
		retn	4
sub_100041ED	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004208	proc near		; CODE XREF: sub_10003F34+34p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+14h], 8
		mov	edx, [eax+10h]
		jb	short loc_10004217
		mov	eax, [eax]

loc_10004217:				; CODE XREF: sub_10004208+Bj
		push	edx
		push	[esp+4+arg_4]
		push	eax
		call	sub_10004225
		retn	8
sub_10004208	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004225	proc near		; CODE XREF: sub_10004208+15p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_4]
		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		mov	eax, [esi+10h]
		cmp	edx, eax
		jnb	short loc_1000426D
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000423D
		mov	ecx, [esi]

loc_1000423D:				; CODE XREF: sub_10004225+14j
		cmp	dword ptr [esi+14h], 8
		lea	ebx, [ecx+eax*2]
		jb	short loc_1000424A
		mov	eax, [esi]
		jmp	short loc_1000424C
; ---------------------------------------------------------------------------

loc_1000424A:				; CODE XREF: sub_10004225+1Fj
		mov	eax, esi

loc_1000424C:				; CODE XREF: sub_10004225+23j
		lea	edi, [eax+edx*2]
		jmp	short loc_10004269
; ---------------------------------------------------------------------------

loc_10004251:				; CODE XREF: sub_10004225+46j
		push	edi
		push	[esp+10h+arg_8]
		push	[esp+14h+arg_0]
		call	sub_10003D6F
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10004276
		add	edi, 2

loc_10004269:				; CODE XREF: sub_10004225+2Aj
		cmp	edi, ebx
		jb	short loc_10004251

loc_1000426D:				; CODE XREF: sub_10004225+Ej
		or	eax, 0FFFFFFFFh

loc_10004270:				; CODE XREF: sub_10004225+5Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_10004276:				; CODE XREF: sub_10004225+3Fj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000427E
		mov	esi, [esi]

loc_1000427E:				; CODE XREF: sub_10004225+55j
		sub	edi, esi
		sar	edi, 1
		mov	eax, edi
		jmp	short loc_10004270
sub_10004225	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004286	proc near		; CODE XREF: sub_10003F34+54p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+14h], 8
		mov	edx, [eax+10h]
		jb	short loc_10004295
		mov	eax, [eax]

loc_10004295:				; CODE XREF: sub_10004286+Bj
		push	edx
		push	[esp+4+arg_4]
		push	eax
		call	sub_100042A3
		retn	8
sub_10004286	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100042A3	proc near		; CODE XREF: sub_10004286+15p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ecx
		push	edi
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_10004302
		mov	ecx, [ebp+arg_4]
		cmp	ecx, eax
		jb	short loc_100042BB
		lea	ecx, [eax-1]

loc_100042BB:				; CODE XREF: sub_100042A3+13j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100042C5
		mov	eax, [esi]
		jmp	short loc_100042C7
; ---------------------------------------------------------------------------

loc_100042C5:				; CODE XREF: sub_100042A3+1Cj
		mov	eax, esi

loc_100042C7:				; CODE XREF: sub_100042A3+20j
		lea	edi, [eax+ecx*2]
		jmp	short loc_100042DF
; ---------------------------------------------------------------------------

loc_100042CC:				; CODE XREF: sub_100042A3+4Dj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100042D6
		mov	eax, [esi]
		jmp	short loc_100042D8
; ---------------------------------------------------------------------------

loc_100042D6:				; CODE XREF: sub_100042A3+2Dj
		mov	eax, esi

loc_100042D8:				; CODE XREF: sub_100042A3+31j
		cmp	edi, eax
		jz	short loc_10004302
		sub	edi, 2

loc_100042DF:				; CODE XREF: sub_100042A3+27j
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_0]
		call	sub_10003D6F
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100042CC
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100042FA
		mov	esi, [esi]

loc_100042FA:				; CODE XREF: sub_100042A3+53j
		sub	edi, esi
		sar	edi, 1
		mov	eax, edi
		jmp	short loc_10004305
; ---------------------------------------------------------------------------

loc_10004302:				; CODE XREF: sub_100042A3+Cj
					; sub_100042A3+37j
		or	eax, 0FFFFFFFFh

loc_10004305:				; CODE XREF: sub_100042A3+5Dj
		pop	edi
		pop	esi
		pop	ebp
		retn	0Ch
sub_100042A3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000430B	proc near		; CODE XREF: sub_100046A7+33p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ecx
		push	ebx
		push	esi
		mov	esi, ecx
		mov	ecx, [esp+10h+arg_0]
		mov	edx, [esi+10h]
		cmp	edx, ecx
		jb	loc_1000469B
		mov	eax, [esp+10h+arg_8]
		mov	ebx, [esp+10h+arg_C]
		mov	eax, [eax+10h]
		cmp	eax, ebx
		jb	loc_1000469B
		push	ebp
		mov	ebp, edx
		sub	ebp, ecx
		cmp	ebp, [esp+14h+arg_4]
		jnb	short loc_10004342
		mov	[esp+14h+arg_4], ebp

loc_10004342:				; CODE XREF: sub_1000430B+31j
		sub	eax, ebx
		mov	ebx, [esp+14h+arg_10]
		cmp	eax, ebx
		jnb	short loc_1000434E
		mov	ebx, eax

loc_1000434E:				; CODE XREF: sub_1000430B+3Fj
		push	edi
		or	eax, 0FFFFFFFFh
		mov	edi, edx
		sub	edi, [esp+18h+arg_4]
		sub	eax, ebx
		cmp	eax, edi
		ja	short loc_10004369
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10004369:				; CODE XREF: sub_1000430B+51j
		sub	ebp, [esp+18h+arg_4]
		lea	eax, [edi+ebx]
		mov	[esp+18h+var_4], eax
		cmp	edx, eax
		jnb	short loc_10004386
		push	0
		push	eax
		mov	ecx, esi
		call	sub_10002221
		mov	ecx, [esp+18h+arg_0]

loc_10004386:				; CODE XREF: sub_1000430B+6Bj
		mov	eax, [esp+18h+arg_8]
		push	8
		cmp	esi, eax
		jz	short loc_10004404
		pop	edi
		cmp	[esi+14h], edi
		jb	short loc_1000439E
		mov	edx, [esi]
		mov	[esp+18h+arg_10], edx
		jmp	short loc_100043A2
; ---------------------------------------------------------------------------

loc_1000439E:				; CODE XREF: sub_1000430B+89j
		mov	[esp+18h+arg_10], esi

loc_100043A2:				; CODE XREF: sub_1000430B+91j
		cmp	[esi+14h], edi
		jb	short loc_100043AB
		mov	edx, [esi]
		jmp	short loc_100043AD
; ---------------------------------------------------------------------------

loc_100043AB:				; CODE XREF: sub_1000430B+9Aj
		mov	edx, esi

loc_100043AD:				; CODE XREF: sub_1000430B+9Ej
		test	ebp, ebp
		jz	short loc_100043D7
		mov	eax, [esp+18h+arg_4]
		add	eax, ecx
		push	ebp		; int
		lea	eax, ds:0[eax*2]
		add	eax, [esp+1Ch+arg_10]
		push	eax		; void *
		lea	eax, [ecx+ebx]
		lea	eax, [edx+eax*2]
		push	eax		; void *
		call	sub_10002AE5
		mov	eax, [esp+24h+arg_8]
		add	esp, 0Ch

loc_100043D7:				; CODE XREF: sub_1000430B+A4j
		cmp	[eax+14h], edi
		jb	short loc_100043DE
		mov	eax, [eax]

loc_100043DE:				; CODE XREF: sub_1000430B+CFj
		cmp	[esi+14h], edi
		jb	short loc_100043E7
		mov	edi, [esi]
		jmp	short loc_100043E9
; ---------------------------------------------------------------------------

loc_100043E7:				; CODE XREF: sub_1000430B+D6j
		mov	edi, esi

loc_100043E9:				; CODE XREF: sub_1000430B+DAj
		mov	edx, [esp+18h+arg_C]
		mov	ecx, [esp+18h+arg_0]
		push	ebx		; int
		lea	eax, [eax+edx*2]
		push	eax		; void *
		lea	eax, [edi+ecx*2]
		push	eax		; void *
		call	sub_10002435
		jmp	loc_10004682
; ---------------------------------------------------------------------------

loc_10004404:				; CODE XREF: sub_1000430B+83j
		mov	edx, [esp+1Ch+arg_4]
		cmp	ebx, edx
		ja	loc_10004497
		pop	edi
		cmp	[esi+14h], edi
		jb	short loc_1000441E
		mov	eax, [esi]
		mov	[esp+18h+arg_8], eax
		jmp	short loc_10004422
; ---------------------------------------------------------------------------

loc_1000441E:				; CODE XREF: sub_1000430B+109j
		mov	[esp+18h+arg_8], esi

loc_10004422:				; CODE XREF: sub_1000430B+111j
		cmp	[esi+14h], edi
		jb	short loc_1000442F
		mov	eax, [esi]
		mov	[esp+18h+arg_10], eax
		jmp	short loc_10004433
; ---------------------------------------------------------------------------

loc_1000442F:				; CODE XREF: sub_1000430B+11Aj
		mov	[esp+18h+arg_10], esi

loc_10004433:				; CODE XREF: sub_1000430B+122j
		test	ebx, ebx
		jz	short loc_10004458
		mov	edx, [esp+18h+arg_C]
		mov	eax, [esp+18h+arg_8]
		push	ebx		; int
		lea	eax, [eax+edx*2]
		push	eax		; void *
		mov	eax, [esp+20h+arg_10]
		lea	eax, [eax+ecx*2]
		push	eax		; void *
		call	sub_10002AE5
		mov	edx, [esp+24h+arg_4]
		add	esp, 0Ch

loc_10004458:				; CODE XREF: sub_1000430B+12Aj
		cmp	[esi+14h], edi
		jb	short loc_10004465
		mov	eax, [esi]
		mov	[esp+18h+arg_4], eax
		jmp	short loc_10004469
; ---------------------------------------------------------------------------

loc_10004465:				; CODE XREF: sub_1000430B+150j
		mov	[esp+18h+arg_4], esi

loc_10004469:				; CODE XREF: sub_1000430B+158j
		cmp	[esi+14h], edi
		jb	short loc_10004472
		mov	edi, [esi]
		jmp	short loc_10004474
; ---------------------------------------------------------------------------

loc_10004472:				; CODE XREF: sub_1000430B+161j
		mov	edi, esi

loc_10004474:				; CODE XREF: sub_1000430B+165j
		test	ebp, ebp
		jz	loc_10004685
		mov	ecx, [esp+18h+arg_0]
		push	ebp
		lea	eax, [ecx+edx]
		mov	edx, [esp+1Ch+arg_4]
		lea	eax, [edx+eax*2]
		push	eax
		lea	eax, [ecx+ebx]
		lea	eax, [edi+eax*2]
		jmp	loc_1000467C
; ---------------------------------------------------------------------------

loc_10004497:				; CODE XREF: sub_1000430B+FFj
		mov	eax, [esp+1Ch+arg_C]
		cmp	eax, ecx
		ja	loc_1000452A
		pop	edi
		cmp	[esi+14h], edi
		jb	short loc_100044B5
		mov	ecx, [esi]
		mov	[esp+18h+arg_8], ecx
		mov	ecx, [esp+18h+arg_0]
		jmp	short loc_100044B9
; ---------------------------------------------------------------------------

loc_100044B5:				; CODE XREF: sub_1000430B+19Cj
		mov	[esp+18h+arg_8], esi

loc_100044B9:				; CODE XREF: sub_1000430B+1A8j
		cmp	[esi+14h], edi
		jb	short loc_100044CA
		mov	edx, [esi]
		mov	[esp+18h+arg_10], edx
		mov	edx, [esp+18h+arg_4]
		jmp	short loc_100044CE
; ---------------------------------------------------------------------------

loc_100044CA:				; CODE XREF: sub_1000430B+1B1j
		mov	[esp+18h+arg_10], esi

loc_100044CE:				; CODE XREF: sub_1000430B+1BDj
		test	ebp, ebp
		jz	short loc_100044F9
		lea	eax, [ecx+edx]
		mov	edx, [esp+18h+arg_8]
		push	ebp		; int
		lea	eax, [edx+eax*2]
		push	eax		; void *
		lea	eax, [ecx+ebx]
		mov	ecx, [esp+20h+arg_10]
		lea	eax, [ecx+eax*2]
		push	eax		; void *
		call	sub_10002AE5
		mov	ecx, [esp+24h+arg_0]
		add	esp, 0Ch
		mov	eax, [esp+18h+arg_C]

loc_100044F9:				; CODE XREF: sub_1000430B+1C5j
		cmp	[esi+14h], edi
		jb	short loc_10004502
		mov	ebp, [esi]
		jmp	short loc_10004504
; ---------------------------------------------------------------------------

loc_10004502:				; CODE XREF: sub_1000430B+1F1j
		mov	ebp, esi

loc_10004504:				; CODE XREF: sub_1000430B+1F5j
		cmp	[esi+14h], edi
		jb	short loc_1000450D
		mov	edx, [esi]
		jmp	short loc_1000450F
; ---------------------------------------------------------------------------

loc_1000450D:				; CODE XREF: sub_1000430B+1FCj
		mov	edx, esi

loc_1000450F:				; CODE XREF: sub_1000430B+200j
		test	ebx, ebx
		jz	loc_10004685
		lea	eax, ds:0[eax*2]
		add	eax, ebp
		push	ebx
		push	eax
		lea	eax, [edx+ecx*2]
		jmp	loc_1000467C
; ---------------------------------------------------------------------------

loc_1000452A:				; CODE XREF: sub_1000430B+192j
		lea	edi, [ecx+edx]
		mov	[esp+1Ch+arg_8], edi
		cmp	edi, eax
		pop	edi
		ja	loc_100045C9
		cmp	[esi+14h], edi
		jb	short loc_1000454B
		mov	edx, [esi]
		mov	[esp+18h+arg_10], edx
		mov	edx, [esp+18h+arg_4]
		jmp	short loc_1000454F
; ---------------------------------------------------------------------------

loc_1000454B:				; CODE XREF: sub_1000430B+232j
		mov	[esp+18h+arg_10], esi

loc_1000454F:				; CODE XREF: sub_1000430B+23Ej
		cmp	[esi+14h], edi
		jb	short loc_10004560
		mov	ecx, [esi]
		mov	[esp+18h+var_8], ecx
		mov	ecx, [esp+18h+arg_0]
		jmp	short loc_10004564
; ---------------------------------------------------------------------------

loc_10004560:				; CODE XREF: sub_1000430B+247j
		mov	[esp+18h+var_8], esi

loc_10004564:				; CODE XREF: sub_1000430B+253j
		test	ebp, ebp
		jz	short loc_10004594
		mov	eax, [esp+18h+arg_10]
		push	ebp		; int
		mov	ebp, [esp+1Ch+arg_8]
		lea	eax, [eax+ebp*2]
		push	eax		; void *
		lea	eax, [ecx+ebx]
		mov	ecx, [esp+20h+var_8]
		lea	eax, [ecx+eax*2]
		push	eax		; void *
		call	sub_10002AE5
		mov	ecx, [esp+24h+arg_0]
		add	esp, 0Ch
		mov	eax, [esp+18h+arg_C]
		mov	edx, [esp+18h+arg_4]

loc_10004594:				; CODE XREF: sub_1000430B+25Bj
		cmp	[esi+14h], edi
		jb	short loc_1000459D
		mov	ebp, [esi]
		jmp	short loc_1000459F
; ---------------------------------------------------------------------------

loc_1000459D:				; CODE XREF: sub_1000430B+28Cj
		mov	ebp, esi

loc_1000459F:				; CODE XREF: sub_1000430B+290j
		cmp	[esi+14h], edi
		jb	short loc_100045A8
		mov	edi, [esi]
		jmp	short loc_100045AA
; ---------------------------------------------------------------------------

loc_100045A8:				; CODE XREF: sub_1000430B+297j
		mov	edi, esi

loc_100045AA:				; CODE XREF: sub_1000430B+29Bj
		test	ebx, ebx
		jz	loc_10004685
		sub	eax, edx
		add	eax, ebx
		push	ebx
		lea	eax, ds:0[eax*2]
		add	eax, ebp
		push	eax
		lea	eax, [edi+ecx*2]
		jmp	loc_1000467C
; ---------------------------------------------------------------------------

loc_100045C9:				; CODE XREF: sub_1000430B+229j
		cmp	[esi+14h], edi
		jb	short loc_100045DA
		mov	eax, [esi]
		mov	[esp+18h+arg_10], eax
		mov	eax, [esp+18h+arg_C]
		jmp	short loc_100045DE
; ---------------------------------------------------------------------------

loc_100045DA:				; CODE XREF: sub_1000430B+2C1j
		mov	[esp+18h+arg_10], esi

loc_100045DE:				; CODE XREF: sub_1000430B+2CDj
		cmp	[esi+14h], edi
		jb	short loc_100045EF
		mov	ecx, [esi]
		mov	[esp+18h+var_8], ecx
		mov	ecx, [esp+18h+arg_0]
		jmp	short loc_100045F3
; ---------------------------------------------------------------------------

loc_100045EF:				; CODE XREF: sub_1000430B+2D6j
		mov	[esp+18h+var_8], esi

loc_100045F3:				; CODE XREF: sub_1000430B+2E2j
		test	edx, edx
		jz	short loc_10004614
		push	edx		; int
		mov	edx, [esp+1Ch+arg_10]
		lea	eax, [edx+eax*2]
		push	eax		; void *
		mov	eax, [esp+20h+var_8]
		lea	eax, [eax+ecx*2]
		push	eax		; void *
		call	sub_10002AE5
		mov	ecx, [esp+24h+arg_0]
		add	esp, 0Ch

loc_10004614:				; CODE XREF: sub_1000430B+2EAj
		cmp	[esi+14h], edi
		jb	short loc_1000461D
		mov	eax, [esi]
		jmp	short loc_1000461F
; ---------------------------------------------------------------------------

loc_1000461D:				; CODE XREF: sub_1000430B+30Cj
		mov	eax, esi

loc_1000461F:				; CODE XREF: sub_1000430B+310j
		cmp	[esi+14h], edi
		jb	short loc_10004628
		mov	edx, [esi]
		jmp	short loc_1000462A
; ---------------------------------------------------------------------------

loc_10004628:				; CODE XREF: sub_1000430B+317j
		mov	edx, esi

loc_1000462A:				; CODE XREF: sub_1000430B+31Bj
		test	ebp, ebp
		jz	short loc_10004646
		push	ebp		; int
		mov	ebp, [esp+1Ch+arg_8]
		lea	eax, [eax+ebp*2]
		push	eax		; void *
		lea	eax, [ecx+ebx]
		lea	eax, [edx+eax*2]
		push	eax		; void *
		call	sub_10002AE5
		add	esp, 0Ch

loc_10004646:				; CODE XREF: sub_1000430B+321j
		cmp	[esi+14h], edi
		jb	short loc_1000464F
		mov	ebp, [esi]
		jmp	short loc_10004651
; ---------------------------------------------------------------------------

loc_1000464F:				; CODE XREF: sub_1000430B+33Ej
		mov	ebp, esi

loc_10004651:				; CODE XREF: sub_1000430B+342j
		cmp	[esi+14h], edi
		jb	short loc_1000465A
		mov	ecx, [esi]
		jmp	short loc_1000465C
; ---------------------------------------------------------------------------

loc_1000465A:				; CODE XREF: sub_1000430B+349j
		mov	ecx, esi

loc_1000465C:				; CODE XREF: sub_1000430B+34Dj
		mov	eax, ebx
		sub	eax, [esp+18h+arg_4]
		jz	short loc_10004685
		push	eax		; int
		mov	eax, [esp+1Ch+arg_C]
		add	eax, ebx
		lea	eax, ds:0[eax*2]
		add	eax, ebp
		push	eax		; void *
		mov	eax, [esp+20h+arg_8]
		lea	eax, [ecx+eax*2]

loc_1000467C:				; CODE XREF: sub_1000430B+187j
					; sub_1000430B+21Aj ...
		push	eax		; void *
		call	sub_10002AE5

loc_10004682:				; CODE XREF: sub_1000430B+F4j
		add	esp, 0Ch

loc_10004685:				; CODE XREF: sub_1000430B+16Bj
					; sub_1000430B+206j ...
		push	[esp+18h+var_4]
		mov	ecx, esi
		call	sub_100021E0
		pop	edi
		pop	ebp
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		retn	14h
; ---------------------------------------------------------------------------

loc_1000469B:				; CODE XREF: sub_1000430B+Fj
					; sub_1000430B+22j
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)
		int	3		; Trap to Debugger
sub_1000430B	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100046A7(int, int, void *, int)
sub_100046A7	proc near		; CODE XREF: sub_1000BF23+92p
					; sub_1000FD37+109p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebp
		mov	ebp, [esp+8+arg_8]
		push	esi
		push	ebp
		mov	esi, ecx
		call	sub_10002288
		test	al, al
		jz	short loc_100046E4
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100046C4
		mov	eax, [esi]
		jmp	short loc_100046C6
; ---------------------------------------------------------------------------

loc_100046C4:				; CODE XREF: sub_100046A7+17j
		mov	eax, esi

loc_100046C6:				; CODE XREF: sub_100046A7+1Bj
		push	[esp+0Ch+arg_C]
		sub	ebp, eax
		mov	ecx, esi
		sar	ebp, 1
		push	ebp
		push	esi
		push	[esp+18h+arg_4]
		push	[esp+1Ch+arg_0]
		call	sub_1000430B
		jmp	loc_1000481E
; ---------------------------------------------------------------------------

loc_100046E4:				; CODE XREF: sub_100046A7+11j
		mov	ecx, [esi+10h]
		mov	eax, [esp+0Ch+arg_0]
		cmp	ecx, eax
		jnb	short loc_100046FA
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_100046FA:				; CODE XREF: sub_100046A7+46j
		push	ebx
		mov	ebx, [esp+10h+arg_4]
		push	edi
		mov	edi, ecx
		sub	edi, eax
		cmp	edi, ebx
		jnb	short loc_1000470A
		mov	ebx, edi

loc_1000470A:				; CODE XREF: sub_100046A7+5Fj
		mov	edx, [esp+14h+arg_C]
		or	eax, 0FFFFFFFFh
		sub	ecx, ebx
		sub	eax, edx
		cmp	eax, ecx
		ja	short loc_10004724
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10004724:				; CODE XREF: sub_100046A7+70j
		sub	edi, ebx
		cmp	edx, ebx
		jnb	short loc_1000477D
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004738
		mov	eax, [esi]
		mov	[esp+14h+arg_4], eax
		jmp	short loc_1000473C
; ---------------------------------------------------------------------------

loc_10004738:				; CODE XREF: sub_100046A7+87j
		mov	[esp+14h+arg_4], esi

loc_1000473C:				; CODE XREF: sub_100046A7+8Fj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000474A
		mov	eax, [esi]
		mov	[esp+14h+var_4], eax
		jmp	short loc_1000474E
; ---------------------------------------------------------------------------

loc_1000474A:				; CODE XREF: sub_100046A7+99j
		mov	[esp+14h+var_4], esi

loc_1000474E:				; CODE XREF: sub_100046A7+A1j
		test	edi, edi
		jz	short loc_1000477D
		mov	ecx, [esp+14h+arg_0]
		push	edi		; int
		lea	eax, [ecx+ebx]
		lea	eax, ds:0[eax*2]
		add	eax, [esp+18h+arg_4]
		push	eax		; void *
		lea	eax, [ecx+edx]
		mov	ecx, [esp+1Ch+var_4]
		lea	eax, [ecx+eax*2]
		push	eax		; void *
		call	sub_10002AE5
		mov	edx, [esp+20h+arg_C]
		add	esp, 0Ch

loc_1000477D:				; CODE XREF: sub_100046A7+81j
					; sub_100046A7+A9j
		test	edx, edx
		jnz	short loc_10004789
		test	ebx, ebx
		jz	loc_1000481A

loc_10004789:				; CODE XREF: sub_100046A7+D8j
		mov	eax, [esi+10h]
		mov	ecx, esi
		sub	eax, ebx
		add	eax, edx
		push	0
		push	eax
		mov	[esp+1Ch+arg_8], eax
		call	sub_10002221
		test	al, al
		jz	short loc_1000481A
		mov	ecx, [esp+14h+arg_C]
		cmp	ebx, ecx
		jnb	short loc_100047F1
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100047B8
		mov	eax, [esi]
		mov	[esp+14h+arg_4], eax
		jmp	short loc_100047BC
; ---------------------------------------------------------------------------

loc_100047B8:				; CODE XREF: sub_100046A7+107j
		mov	[esp+14h+arg_4], esi

loc_100047BC:				; CODE XREF: sub_100046A7+10Fj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100047C6
		mov	edx, [esi]
		jmp	short loc_100047C8
; ---------------------------------------------------------------------------

loc_100047C6:				; CODE XREF: sub_100046A7+119j
		mov	edx, esi

loc_100047C8:				; CODE XREF: sub_100046A7+11Dj
		test	edi, edi
		jz	short loc_100047F1
		push	edi		; int
		mov	edi, [esp+18h+arg_0]
		lea	eax, [edi+ebx]
		mov	ebx, [esp+18h+arg_4]
		lea	eax, [ebx+eax*2]
		push	eax		; void *
		lea	eax, [edi+ecx]
		lea	eax, [edx+eax*2]
		push	eax		; void *
		call	sub_10002AE5
		mov	ecx, [esp+20h+arg_C]
		add	esp, 0Ch
		jmp	short loc_100047F5
; ---------------------------------------------------------------------------

loc_100047F1:				; CODE XREF: sub_100046A7+101j
					; sub_100046A7+123j
		mov	edi, [esp+14h+arg_0]

loc_100047F5:				; CODE XREF: sub_100046A7+148j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100047FF
		mov	eax, [esi]
		jmp	short loc_10004801
; ---------------------------------------------------------------------------

loc_100047FF:				; CODE XREF: sub_100046A7+152j
		mov	eax, esi

loc_10004801:				; CODE XREF: sub_100046A7+156j
		push	ecx		; int
		lea	eax, [eax+edi*2]
		push	ebp		; void *
		push	eax		; void *
		call	sub_10002435
		add	esp, 0Ch
		mov	ecx, esi
		push	[esp+14h+arg_8]
		call	sub_100021E0

loc_1000481A:				; CODE XREF: sub_100046A7+DCj
					; sub_100046A7+F9j
		pop	edi
		mov	eax, esi
		pop	ebx

loc_1000481E:				; CODE XREF: sub_100046A7+38j
		pop	esi
		pop	ebp
		pop	ecx
		retn	10h
sub_100046A7	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004824	proc near		; CODE XREF: sub_10004B01+2Dp
					; sub_10004B01+D6p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	eax, [ecx+10h]
		ja	short loc_1000483E
		cmp	dword ptr [ecx+14h], 10h
		mov	[ecx+10h], eax
		jb	short loc_10004838
		mov	ecx, [ecx]

loc_10004838:				; CODE XREF: sub_10004824+10j
		mov	byte ptr [ecx+eax], 0
		jmp	short locret_1000484B
; ---------------------------------------------------------------------------

loc_1000483E:				; CODE XREF: sub_10004824+7j
		push	[esp+arg_4]	; int
		sub	eax, [ecx+10h]
		push	eax		; size_t
		call	sub_1000377A

locret_1000484B:			; CODE XREF: sub_10004824+18j
		retn	8
sub_10004824	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000484E	proc near		; CODE XREF: sub_1000774A+7Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	eax, [ecx+10h]
		ja	short loc_1000485F
		push	eax
		call	sub_100021E0
		jmp	short locret_1000486C
; ---------------------------------------------------------------------------

loc_1000485F:				; CODE XREF: sub_1000484E+7j
		push	[esp+arg_4]
		sub	eax, [ecx+10h]
		push	eax
		call	sub_100037D9

locret_1000486C:			; CODE XREF: sub_1000484E+Fj
		retn	8
sub_1000484E	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000486F(int,	wchar_t	*Format, va_list ArgList)
sub_1000486F	proc near		; CODE XREF: sub_100049A2+1Fp

var_818		= dword	ptr -818h
var_814		= dword	ptr -814h
var_808		= dword	ptr -808h
DstBuf		= word ptr -804h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Format		= dword	ptr  8
ArgList		= dword	ptr  0Ch

		sub	esp, 818h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+818h+var_4], eax
		mov	eax, [esp+818h+ArgList]
		and	[esp+818h+var_808], 0
		push	ebx
		mov	ebx, [esp+81Ch+arg_0]
		push	ebp
		mov	ebp, [esp+820h+Format]
		push	esi
		push	edi
		push	eax		; ArgList
		push	ebp		; Format
		mov	[esp+830h+var_818], eax
		mov	edi, 400h
		lea	eax, [esp+830h+DstBuf]
		push	edi		; MaxCount
		push	eax		; DstBuf
		call	sub_10004A15
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		js	short loc_10004928
		cmp	esi, edi
		jge	short loc_100048D3
		push	esi		; int
		lea	eax, [esp+82Ch+DstBuf]
		mov	ecx, ebx
		push	eax		; void *
		call	sub_10003950
		jmp	short loc_10004928
; ---------------------------------------------------------------------------

loc_100048D3:				; CODE XREF: sub_1000486F+53j
					; sub_1000486F+A0j
		lea	edi, [esi+1]
		cmp	edi, 2000000h
		jg	short loc_10004928
		push	edi
		lea	ecx, [esp+82Ch+var_814]
		call	sub_10004962
		push	[esp+828h+var_818] ; ArgList
		push	ebp		; Format
		push	edi		; MaxCount
		push	[esp+834h+var_814] ; DstBuf
		call	sub_10004A15
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		js	short loc_10004904
		cmp	esi, edi
		jl	short loc_10004913

loc_10004904:				; CODE XREF: sub_1000486F+8Fj
		lea	ecx, [esp+828h+var_814]
		call	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime
		test	esi, esi
		jns	short loc_100048D3
		jmp	short loc_10004928
; ---------------------------------------------------------------------------

loc_10004913:				; CODE XREF: sub_1000486F+93j
		push	esi		; int
		push	[esp+82Ch+var_814] ; void *
		mov	ecx, ebx
		call	sub_10003950
		lea	ecx, [esp+828h+var_814]
		call	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime

loc_10004928:				; CODE XREF: sub_1000486F+4Fj
					; sub_1000486F+62j ...
		mov	ecx, [esp+828h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 818h
		retn
sub_1000486F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004941	proc near		; CODE XREF: sub_10004962+29p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		test	edx, edx
		jz	short loc_1000495F
		push	esi
		mov	esi, [esp+4+arg_8]

loc_10004952:				; CODE XREF: sub_10004941+1Bj
		mov	ax, [esi]
		mov	[ecx], ax
		add	ecx, 2
		dec	edx
		jnz	short loc_10004952
		pop	esi

loc_1000495F:				; CODE XREF: sub_10004941+Aj
		mov	eax, ecx
		retn
sub_10004941	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004962	proc near		; CODE XREF: sub_1000486F+74p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, ecx
		xor	ebx, ebx
		push	edi
		mov	edi, [ebp+arg_0]
		push	edi
		mov	[esi], ebx
		mov	[esi+4], ebx
		mov	[esi+8], ebx
		call	sub_100049CD
		test	al, al
		jz	short loc_10004999
		lea	eax, [ebp+arg_0]
		mov	[ebp+arg_0], ebx
		push	eax
		push	edi
		push	dword ptr [esi]
		call	sub_10004941
		lea	eax, [edi+edi]
		add	esp, 0Ch
		add	[esi+4], eax

loc_10004999:				; CODE XREF: sub_10004962+1Dj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	ebp
		retn	4
sub_10004962	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100049A2(int,	wchar_t	*Format, char ArgList)
sub_100049A2	proc near		; CODE XREF: sub_10018F87+81p

arg_0		= dword	ptr  4
Format		= dword	ptr  8
ArgList		= byte ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		xor	eax, eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		lea	eax, [esp+4+ArgList]
		push	eax		; ArgList
		push	[esp+8+Format]	; Format
		push	esi		; int
		call	sub_1000486F
		add	esp, 0Ch
		mov	eax, esi
		pop	esi
		retn
sub_100049A2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100049CD	proc near		; CODE XREF: sub_10004962+16p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		test	edi, edi
		jnz	short loc_100049E7
		xor	al, al
		jmp	short loc_10004A10
; ---------------------------------------------------------------------------

loc_100049E7:				; CODE XREF: sub_100049CD+14j
		cmp	edi, 7FFFFFFFh
		jbe	short loc_100049FA
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100049FA:				; CODE XREF: sub_100049CD+20j
		push	eax
		push	edi
		call	sub_10001DBA
		mov	[esi], eax
		mov	[esi+4], eax
		pop	ecx
		lea	eax, [eax+edi*2]
		mov	[esi+8], eax
		mov	al, 1
		pop	ecx

loc_10004A10:				; CODE XREF: sub_100049CD+18j
		pop	edi
		pop	esi
		retn	4
sub_100049CD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10004A15(wchar_t *DstBuf, size_t MaxCount, wchar_t *Format, va_list ArgList)
sub_10004A15	proc near		; CODE XREF: sub_1000486F+43p
					; sub_1000486F+83p

var_4		= dword	ptr -4
DstBuf		= dword	ptr  8
MaxCount	= dword	ptr  0Ch
Format		= dword	ptr  10h
ArgList		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		push	[ebp+ArgList]	; ArgList
		mov	esi, [ebp+DstBuf]
		push	[ebp+Format]	; Format
		push	[ebp+MaxCount]	; MaxCount
		push	esi		; DstBuf
		call	ds:_vswprintf_p
		add	esp, 10h
		test	eax, eax
		jns	short loc_10004A51
		cmp	[ebp+MaxCount],	0
		jbe	short loc_10004A43
		xor	eax, eax
		mov	[esi], ax

loc_10004A43:				; CODE XREF: sub_10004A15+27j
		push	[ebp+ArgList]	; ArgList
		push	[ebp+Format]	; Format
		call	ds:_vscwprintf_p
		pop	ecx
		pop	ecx

loc_10004A51:				; CODE XREF: sub_10004A15+21j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10004A15	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004A56	proc near		; CODE XREF: sub_10004CB1+70p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		and	dword ptr [ecx+10h], 0
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10004A68
		mov	eax, [ecx]
		jmp	short loc_10004A6A
; ---------------------------------------------------------------------------

loc_10004A68:				; CODE XREF: sub_10004A56+Cj
		mov	eax, ecx

loc_10004A6A:				; CODE XREF: sub_10004A56+10j
		mov	edx, [esp+arg_4]
		mov	byte ptr [eax],	0
		test	edx, edx
		jz	short locret_10004A91
		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, 80h
		cmp	[eax], si
		pop	esi
		jnb	short loc_10004A88
		push	edx
		jmp	short loc_10004A8C
; ---------------------------------------------------------------------------

loc_10004A88:				; CODE XREF: sub_10004A56+2Dj
		imul	eax, edx, 3
		push	eax

loc_10004A8C:				; CODE XREF: sub_10004A56+30j
		call	sub_1000382D

locret_10004A91:			; CODE XREF: sub_10004A56+1Dj
		retn
sub_10004A56	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004A92	proc near		; CODE XREF: sub_10004C0E+20p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		mov	ecx, [esi]
		movzx	edi, word ptr [ebx+ecx*2]
		mov	edx, edi
		mov	eax, edi
		and	eax, 0FFFFF800h
		cmp	eax, 0D800h
		jnz	short loc_10004AEF
		test	edi, 400h
		jnz	short loc_10004AEB
		lea	eax, [ecx+1]
		cmp	eax, [ebp+arg_4]
		jge	short loc_10004AEB
		movzx	ecx, word ptr [ebx+ecx*2+2]
		mov	eax, ecx
		and	eax, 0FFFFFC00h
		cmp	eax, 0DC00h
		jnz	short loc_10004AEB
		lea	eax, [ecx-35FDC00h]
		shl	edx, 0Ah
		mov	ecx, [ebp+arg_C]
		add	eax, edx
		mov	[ecx], eax
		inc	dword ptr [esi]
		jmp	short loc_10004AF4
; ---------------------------------------------------------------------------

loc_10004AEB:				; CODE XREF: sub_10004A92+28j
					; sub_10004A92+30j ...
		xor	al, al
		jmp	short loc_10004AFC
; ---------------------------------------------------------------------------

loc_10004AEF:				; CODE XREF: sub_10004A92+20j
		mov	ecx, [ebp+arg_C]
		mov	[ecx], edx

loc_10004AF4:				; CODE XREF: sub_10004A92+57j
		push	dword ptr [ecx]
		call	sub_10004087
		pop	ecx

loc_10004AFC:				; CODE XREF: sub_10004A92+5Bj
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10004A92	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004B01	proc near		; CODE XREF: sub_10004C0E+32p
					; sub_10004C0E+3Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		cmp	ebx, 7Fh
		ja	short loc_10004B1A
		mov	ecx, [esp+4+arg_4]
		push	ebx
		call	sub_10003571
		xor	eax, eax
		inc	eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10004B1A:				; CODE XREF: sub_10004B01+8j
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		mov	ecx, esi
		push	edi
		push	0
		mov	edi, [esi+10h]
		mov	ebp, edi
		lea	eax, [edi+4]
		push	eax
		call	sub_10004824
		cmp	ebx, 7FFh
		ja	short loc_10004B50
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10004B45
		mov	ecx, [esi]
		jmp	short loc_10004B47
; ---------------------------------------------------------------------------

loc_10004B45:				; CODE XREF: sub_10004B01+3Ej
		mov	ecx, esi

loc_10004B47:				; CODE XREF: sub_10004B01+42j
		mov	eax, ebx
		shr	eax, 6
		or	al, 0C0h
		jmp	short loc_10004BB8
; ---------------------------------------------------------------------------

loc_10004B50:				; CODE XREF: sub_10004B01+38j
		cmp	ebx, 0FFFFh
		ja	short loc_10004B71
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10004B62
		mov	ecx, [esi]
		jmp	short loc_10004B64
; ---------------------------------------------------------------------------

loc_10004B62:				; CODE XREF: sub_10004B01+5Bj
		mov	ecx, esi

loc_10004B64:				; CODE XREF: sub_10004B01+5Fj
		mov	eax, ebx
		shr	eax, 0Ch
		or	al, 0E0h
		mov	[ecx+edi], al
		inc	edi
		jmp	short loc_10004BA3
; ---------------------------------------------------------------------------

loc_10004B71:				; CODE XREF: sub_10004B01+55j
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10004B7B
		mov	ecx, [esi]
		jmp	short loc_10004B7D
; ---------------------------------------------------------------------------

loc_10004B7B:				; CODE XREF: sub_10004B01+74j
		mov	ecx, esi

loc_10004B7D:				; CODE XREF: sub_10004B01+78j
		mov	eax, ebx
		shr	eax, 12h
		or	al, 0F0h
		mov	[ecx+edi], al
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10004B91
		mov	ecx, [esi]
		jmp	short loc_10004B93
; ---------------------------------------------------------------------------

loc_10004B91:				; CODE XREF: sub_10004B01+8Aj
		mov	ecx, esi

loc_10004B93:				; CODE XREF: sub_10004B01+8Ej
		mov	eax, ebx
		shr	eax, 0Ch
		and	al, 3Fh
		or	al, 80h
		mov	[ecx+edi+1], al
		add	edi, 2

loc_10004BA3:				; CODE XREF: sub_10004B01+6Ej
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10004BAD
		mov	ecx, [esi]
		jmp	short loc_10004BAF
; ---------------------------------------------------------------------------

loc_10004BAD:				; CODE XREF: sub_10004B01+A6j
		mov	ecx, esi

loc_10004BAF:				; CODE XREF: sub_10004B01+AAj
		mov	eax, ebx
		shr	eax, 6
		and	al, 3Fh
		or	al, 80h

loc_10004BB8:				; CODE XREF: sub_10004B01+4Dj
		mov	[ecx+edi], al
		inc	edi
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10004BC6
		mov	eax, [esi]
		jmp	short loc_10004BC8
; ---------------------------------------------------------------------------

loc_10004BC6:				; CODE XREF: sub_10004B01+BFj
		mov	eax, esi

loc_10004BC8:				; CODE XREF: sub_10004B01+C3j
		and	bl, 3Fh
		mov	ecx, esi
		or	bl, 80h
		mov	[eax+edi], bl
		inc	edi
		push	0
		push	edi
		call	sub_10004824
		sub	edi, ebp
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10004B01	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004BE5	proc near		; CODE XREF: sub_10004CB1+41p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	[ebp+arg_4]
		mov	esi, ecx
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [esi],	0
		call	sub_10004C68
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	8
sub_10004BE5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004C0E	proc near		; CODE XREF: sub_10004CB1+8Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		cmp	[ebp+arg_4], 0
		push	ebx
		mov	bl, 1
		jle	short loc_10004C61

loc_10004C20:				; CODE XREF: sub_10004C0E+51j
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10004A92
		add	esp, 10h
		push	[ebp+arg_8]
		test	al, al
		jz	short loc_10004C47
		push	[ebp+var_8]
		call	sub_10004B01
		jmp	short loc_10004C53
; ---------------------------------------------------------------------------

loc_10004C47:				; CODE XREF: sub_10004C0E+2Dj
		push	0FFFDh
		call	sub_10004B01
		xor	bl, bl

loc_10004C53:				; CODE XREF: sub_10004C0E+37j
		pop	ecx
		pop	ecx
		mov	ecx, [ebp+var_4]
		inc	ecx
		mov	[ebp+var_4], ecx
		cmp	ecx, [ebp+arg_4]
		jl	short loc_10004C20

loc_10004C61:				; CODE XREF: sub_10004C0E+10j
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10004C0E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004C68	proc near		; CODE XREF: sub_10004BE5+1Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		mov	ebp, ecx
		push	edi
		mov	edi, [esp+10h+arg_0]
		sub	esi, edi
		mov	eax, esi
		sar	eax, 1
		push	eax
		call	sub_1000382D
		lea	eax, [esi+1]
		xor	ebx, ebx
		shr	eax, 1
		cmp	[esp+10h+arg_4], edi
		sbb	esi, esi
		not	esi
		and	esi, eax
		jz	short loc_10004CAA

loc_10004C95:				; CODE XREF: sub_10004C68+40j
		movzx	eax, byte ptr [edi]
		mov	ecx, ebp
		push	eax		; int
		push	1		; size_t
		call	sub_1000377A
		inc	ebx
		lea	edi, [edi+2]
		cmp	ebx, esi
		jnz	short loc_10004C95

loc_10004CAA:				; CODE XREF: sub_10004C68+2Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_10004C68	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10004CB1(void	*, int)
sub_10004CB1	proc near		; CODE XREF: sub_10002039+25p
					; sub_10002B92+31p ...

var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	esi
		mov	esi, [esp+20h+arg_4]
		push	edi
		mov	edi, [esp+24h+arg_0]
		push	esi
		call	sub_1000406E
		pop	ecx
		test	al, al
		jz	short loc_10004CF9
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004CDE
		mov	eax, [esi]
		jmp	short loc_10004CE0
; ---------------------------------------------------------------------------

loc_10004CDE:				; CODE XREF: sub_10004CB1+27j
		mov	eax, esi

loc_10004CE0:				; CODE XREF: sub_10004CB1+2Bj
		cmp	dword ptr [esi+14h], 8
		mov	ecx, [esi+10h]
		jb	short loc_10004CEB
		mov	esi, [esi]

loc_10004CEB:				; CODE XREF: sub_10004CB1+36j
		lea	ecx, [eax+ecx*2]
		push	ecx
		push	esi
		mov	ecx, edi
		call	sub_10004BE5
		jmp	short loc_10004D65
; ---------------------------------------------------------------------------

loc_10004CF9:				; CODE XREF: sub_10004CB1+21j
		push	ebx
		push	ebp
		push	0Fh
		xor	ebx, ebx
		cmp	dword ptr [esi+14h], 8
		pop	ebp
		mov	[esp+2Ch+var_8], ebp
		mov	[esp+2Ch+var_C], ebx
		mov	[esp+2Ch+var_1C], bl
		jb	short loc_10004D16
		mov	eax, [esi]
		jmp	short loc_10004D18
; ---------------------------------------------------------------------------

loc_10004D16:				; CODE XREF: sub_10004CB1+5Fj
		mov	eax, esi

loc_10004D18:				; CODE XREF: sub_10004CB1+63j
		lea	ecx, [esp+2Ch+var_1C]
		push	ecx
		push	dword ptr [esi+10h]
		push	eax
		call	sub_10004A56
		mov	eax, [esi+10h]
		add	esp, 0Ch
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004D34
		mov	esi, [esi]

loc_10004D34:				; CODE XREF: sub_10004CB1+7Fj
		lea	ecx, [esp+2Ch+var_1C]
		push	ecx
		push	eax
		push	esi
		call	sub_10004C0E
		add	esp, 0Ch
		mov	[edi+14h], ebp
		lea	eax, [esp+2Ch+var_1C]
		mov	[edi+10h], ebx
		mov	ecx, edi	; void *
		mov	[edi], bl
		push	eax		; void *
		call	sub_10002104
		push	ebx		; size_t
		push	1		; char
		lea	ecx, [esp+34h+var_1C] ;	void *
		call	sub_10001769
		pop	ebp
		pop	ebx

loc_10004D65:				; CODE XREF: sub_10004CB1+46j
		mov	ecx, [esp+24h+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_10004CB1	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10004D78(LPCRITICAL_SECTION lpCriticalSection)
sub_10004D78	proc near		; CODE XREF: sub_10001024+5p
					; sub_10005405+14p ...
		push	esi
		mov	esi, ecx
		push	7D0h		; dwSpinCount
		push	esi		; lpCriticalSection
		call	ds:InitializeCriticalSectionAndSpinCount
		mov	eax, esi
		pop	esi
		retn
sub_10004D78	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_1001B8E7

loc_10004D8B:				; CODE XREF: sub_1001B8E7+5j
		push	ecx		; lpCriticalSection
		call	ds:DeleteCriticalSection
		retn
; END OF FUNCTION CHUNK	FOR sub_1001B8E7

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10004D93(LPCRITICAL_SECTION lpCriticalSection)
sub_10004D93	proc near		; CODE XREF: sub_10002EB4+15p
					; sub_10005405+7Cp ...
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		retn
sub_10004D93	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10004D9B(LPCRITICAL_SECTION lpCriticalSection)
sub_10004D9B	proc near		; CODE XREF: sub_10002EB4+2Ep
					; sub_10005405+ADp ...
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		retn
sub_10004D9B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004DA3	proc near		; CODE XREF: sub_10004DE8+Cp
					; sub_100069C2+Bp ...
		push	esi
		mov	esi, ecx
		push	dword ptr [esi]
		call	sub_10004DD3
		pop	ecx
		test	al, al
		jz	short loc_10004DD1
		call	sub_1000344A
		push	eax
		push	dword ptr [esp+8]
		push	esi
		push	dword ptr [esi]
		call	sub_10006399
		push	dword ptr [esi]	; hObject
		call	sub_100061AA
		add	esp, 14h
		and	dword ptr [esi], 0

loc_10004DD1:				; CODE XREF: sub_10004DA3+Dj
		pop	esi
		retn
sub_10004DA3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004DD3	proc near		; CODE XREF: sub_10004DA3+5p
					; sub_10004DE8+12p ...

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jz	short loc_10004DE5
		cmp	[esp+arg_0], 0FFFFFFFFh
		jz	short loc_10004DE5
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10004DE5:				; CODE XREF: sub_10004DD3+5j
					; sub_10004DD3+Cj
		xor	eax, eax
		retn
sub_10004DD3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004DE8	proc near		; CODE XREF: sub_100069DA+3Ep
					; sub_10006A9F+1Cp ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		cmp	[esi], edi
		jz	short loc_10004E1A
		call	sub_10004DA3
		push	edi
		call	sub_10004DD3
		pop	ecx
		test	al, al
		jz	short loc_10004E1A
		mov	[esi], edi
		call	sub_1000344A
		push	eax
		push	dword ptr [esp+0Ch]
		push	esi
		push	edi
		call	sub_100062C9
		add	esp, 10h

loc_10004E1A:				; CODE XREF: sub_10004DE8+Aj
					; sub_10004DE8+1Aj
		pop	edi
		pop	esi
		retn	4
sub_10004DE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10004E1F(void	*)
sub_10004E1F	proc near		; CODE XREF: StartAddress+28p

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		mov	esi, [ebp+arg_0]
		call	ds:GetCurrentThreadId
		push	esi		; void *
		push	eax		; int
		call	sub_100055DE
		mov	ecx, eax	; lpCriticalSection
		call	sub_100055F9
		push	0Ch		; size_t
		push	offset aBrokerevent ; "BrokerEvent"
		push	esi		; void *
		call	memcmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10004E70
		push	esi		; void *
		lea	ecx, [ebp+var_1C]
		call	sub_10001075
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_10001769

loc_10004E70:				; CODE XREF: sub_10004E1F+3Aj
		call	ds:IsDebuggerPresent
		test	eax, eax
		jnz	short loc_10004E83
		call	sub_100033A2
		test	al, al
		jz	short loc_10004E92

loc_10004E83:				; CODE XREF: sub_10004E1F+59j
		push	esi
		call	ds:GetCurrentThreadId
		push	eax
		call	sub_10004EA1
		pop	ecx
		pop	ecx

loc_10004E92:				; CODE XREF: sub_10004E1F+62j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10004E1F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004EA1	proc near		; CODE XREF: sub_10004E1F+6Cp

Arguments	= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	18h
		push	offset stru_10030088
		call	__SEH_prolog4
		mov	[ebp+Arguments], 1000h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		xor	ecx, ecx
		mov	[ebp+var_1C], ecx
		mov	[ebp+ms_exc.registration.TryLevel], ecx
		lea	eax, [ebp+Arguments]
		push	eax		; lpArguments
		push	4		; nNumberOfArguments
		push	ecx		; dwExceptionFlags
		push	406D1388h	; dwExceptionCode
		call	ds:RaiseException
		jmp	short loc_10004EE3
; ---------------------------------------------------------------------------

loc_10004EDC:				; DATA XREF: .rdata:stru_10030088o
		or	eax, 0FFFFFFFFh	; Exception filter 0 for function 10004EA1
		retn
; ---------------------------------------------------------------------------

loc_10004EE0:				; DATA XREF: .rdata:stru_10030088o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10004EA1

loc_10004EE3:				; CODE XREF: sub_10004EA1+39j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	__SEH_epilog4
		retn
sub_10004EA1	endp

; [00000009 BYTES: COLLAPSED FUNCTION __Thrd_yield]

; =============== S U B	R O U T	I N E =======================================


sub_10004EF9	proc near		; CODE XREF: sub_100056C0+4p
					; sub_100056EA+7p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10004F20
		cmp	eax, 5D1745Dh
		ja	short loc_10004F1A
		imul	eax, 2Ch
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10004F20

loc_10004F1A:				; CODE XREF: sub_10004EF9+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_10004F20:				; CODE XREF: sub_10004EF9+8j
					; sub_10004EF9+1Fj
		mov	eax, ecx
		retn
sub_10004EF9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004F23	proc near		; CODE XREF: sub_10005522+39p

arg_4		= dword	ptr  8

		push	esi
		push	edi
		call	sub_100056EA
		mov	esi, eax
		lea	edi, [esi+10h]
		mov	word ptr [esi+0Ch], 0
		test	edi, edi
		jz	short loc_10004F4A
		mov	ecx, [esp+8+arg_4]
		push	dword ptr [ecx]	; void *
		mov	ecx, edi
		call	sub_10001E49
		and	dword ptr [edi+18h], 0

loc_10004F4A:				; CODE XREF: sub_10004F23+14j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10004F23	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004F51	proc near		; CODE XREF: sub_100054CC+31p

arg_4		= dword	ptr  8

		push	esi
		call	sub_1000571C
		mov	edx, eax
		lea	esi, [edx+10h]
		mov	word ptr [edx+0Ch], 0
		test	esi, esi
		jz	short loc_10004F74
		mov	ecx, [esp+4+arg_4]
		mov	ecx, [ecx]
		mov	eax, [ecx]
		and	dword ptr [esi+4], 0
		mov	[esi], eax

loc_10004F74:				; CODE XREF: sub_10004F51+13j
		mov	eax, edx
		pop	esi
		retn	0Ch
sub_10004F51	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004F7A	proc near		; CODE XREF: sub_10005580+39p

arg_4		= dword	ptr  8

		push	esi
		push	edi
		call	sub_100056EA
		mov	esi, eax
		lea	edi, [esi+10h]
		mov	word ptr [esi+0Ch], 0
		test	edi, edi
		jz	short loc_10004FA1
		mov	ecx, [esp+8+arg_4]
		push	dword ptr [ecx]
		mov	ecx, edi
		call	sub_10003AD7
		and	dword ptr [edi+18h], 0

loc_10004FA1:				; CODE XREF: sub_10004F7A+14j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10004F7A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10004FA8(int, char,	int, int, void *)
sub_10004FA8	proc near		; CODE XREF: sub_100050C9+1Bp
					; sub_100050C9+128p ...

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	eax, [edi+4]
		cmp	eax, 5D1745Ch
		jb	short loc_10004FCD
		push	[ebp+arg_10]	; void *
		call	sub_1000574E
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10004FCD:				; CODE XREF: sub_10004FA8+10j
		mov	ebx, [ebp+arg_10]
		inc	eax
		mov	[edi+4], eax
		mov	eax, [ebp+arg_8]
		mov	[ebx+4], eax
		mov	ecx, [edi]
		cmp	eax, ecx
		jnz	short loc_10004FEE
		mov	[ecx+4], ebx
		mov	eax, [edi]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	[eax+8], ebx
		jmp	short loc_1000500D
; ---------------------------------------------------------------------------

loc_10004FEE:				; CODE XREF: sub_10004FA8+36j
		cmp	[ebp+arg_4], 0
		jz	short loc_10005000
		mov	[eax], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx]
		jnz	short loc_1000500D
		mov	[ecx], ebx
		jmp	short loc_1000500D
; ---------------------------------------------------------------------------

loc_10005000:				; CODE XREF: sub_10004FA8+4Aj
		mov	[eax+8], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx+8]
		jnz	short loc_1000500D
		mov	[ecx+8], ebx

loc_1000500D:				; CODE XREF: sub_10004FA8+44j
					; sub_10004FA8+52j ...
		mov	eax, [ebx+4]
		mov	esi, ebx
		jmp	loc_100050AA
; ---------------------------------------------------------------------------

loc_10005017:				; CODE XREF: sub_10004FA8+106j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000505B
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_10005061
		cmp	esi, [eax+8]
		jnz	short loc_1000503B
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_100057C3

loc_1000503B:				; CODE XREF: sub_10004FA8+87j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10009EBF
		jmp	short loc_100050A7
; ---------------------------------------------------------------------------

loc_1000505B:				; CODE XREF: sub_10004FA8+79j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000507B

loc_10005061:				; CODE XREF: sub_10004FA8+82j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_100050A7
; ---------------------------------------------------------------------------

loc_1000507B:				; CODE XREF: sub_10004FA8+B7j
		cmp	esi, [eax]
		jnz	short loc_10005089
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10009EBF

loc_10005089:				; CODE XREF: sub_10004FA8+D5j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_100057C3

loc_100050A7:				; CODE XREF: sub_10004FA8+B1j
					; sub_10004FA8+D1j
		mov	eax, [esi+4]

loc_100050AA:				; CODE XREF: sub_10004FA8+6Aj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10005017
		mov	eax, [edi]
		pop	edi
		pop	esi
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], ebx
		pop	ebx
		pop	ebp
		retn	14h
sub_10004FA8	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100050C9(int, int, void *, void *)
sub_100050C9	proc near		; CODE XREF: sub_10005522+4Ap
					; sub_10005580+4Ap

var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		cmp	dword ptr [ebx+4], 0
		jnz	short loc_100050F2
		push	[esp+0Ch+arg_C]	; void *
		push	[esp+10h+arg_8]	; int
		push	dword ptr [ebx]	; int
		push	1		; char
		push	[esp+1Ch+arg_0]	; int
		call	sub_10004FA8
		mov	eax, [esp+0Ch+arg_0]
		jmp	loc_1000521A
; ---------------------------------------------------------------------------

loc_100050F2:				; CODE XREF: sub_100050C9+9j
		mov	ecx, [ebx]
		mov	eax, [esp+0Ch+arg_4]
		push	ebp
		mov	ebp, [esp+10h+arg_8]
		push	esi
		push	edi
		cmp	eax, [ecx]
		jnz	short loc_10005126
		add	eax, 10h
		mov	ecx, ebp
		push	eax		; void *
		call	sub_10005804
		test	eax, eax
		jns	loc_100051FC
		push	[esp+18h+arg_C]
		mov	ecx, ebx
		push	ebp
		push	[esp+20h+arg_4]
		jmp	loc_100051EB
; ---------------------------------------------------------------------------

loc_10005126:				; CODE XREF: sub_100050C9+38j
		cmp	eax, ecx
		jnz	short loc_10005151
		mov	ecx, [ecx+8]
		add	ecx, 10h
		push	ebp		; void *
		call	sub_10005804
		test	eax, eax
		jns	loc_100051FC
		push	[esp+18h+arg_C]
		mov	eax, [ebx]
		mov	ecx, ebx
		push	ebp
		push	dword ptr [eax+8]
		push	0
		jmp	loc_100051ED
; ---------------------------------------------------------------------------

loc_10005151:				; CODE XREF: sub_100050C9+5Fj
		add	eax, 10h
		mov	ecx, ebp
		push	eax		; void *
		call	sub_10005804
		test	eax, eax
		jns	short loc_10005198
		mov	eax, [esp+18h+arg_4]
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], eax
		call	sub_1000911E
		mov	esi, [esp+18h+arg_8]
		push	ebp		; void *
		lea	ecx, [esi+10h]
		call	sub_10005804
		test	eax, eax
		jns	short loc_10005198
		mov	eax, [esi+8]
		mov	ecx, ebx
		push	[esp+18h+arg_C]
		push	ebp
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_100051E5
		push	[esp+20h+arg_4]
		jmp	short loc_100051EB
; ---------------------------------------------------------------------------

loc_10005198:				; CODE XREF: sub_100050C9+95j
					; sub_100050C9+B7j
		mov	ecx, [esp+18h+arg_4]
		push	ebp		; void *
		lea	ecx, [ecx+10h]
		call	sub_10005804
		test	eax, eax
		jns	short loc_100051FC
		mov	esi, [esp+18h+arg_4]
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], esi
		call	sub_1000CDCC
		mov	edi, [esp+18h+arg_8]
		cmp	edi, [ebx]
		jz	short loc_100051D5
		lea	eax, [edi+10h]
		mov	ecx, ebp
		push	eax		; void *
		call	sub_10005804
		test	eax, eax
		jns	short loc_100051FC
		mov	esi, [esp+18h+arg_4]

loc_100051D5:				; CODE XREF: sub_100050C9+F7j
		mov	eax, [esi+8]
		mov	ecx, ebx
		push	[esp+18h+arg_C]	; void *
		push	ebp		; int
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_100051EA

loc_100051E5:				; CODE XREF: sub_100050C9+C7j
		push	esi
		push	0
		jmp	short loc_100051ED
; ---------------------------------------------------------------------------

loc_100051EA:				; CODE XREF: sub_100050C9+11Aj
		push	edi		; int

loc_100051EB:				; CODE XREF: sub_100050C9+58j
					; sub_100050C9+CDj
		push	1		; char

loc_100051ED:				; CODE XREF: sub_100050C9+83j
					; sub_100050C9+11Fj
		push	[esp+28h+arg_0]	; int
		call	sub_10004FA8
		mov	eax, [esp+18h+arg_0]
		jmp	short loc_10005217
; ---------------------------------------------------------------------------

loc_100051FC:				; CODE XREF: sub_100050C9+47j
					; sub_100050C9+6Fj ...
		push	[esp+18h+arg_C]	; void *
		lea	eax, [esp+1Ch+var_8]
		mov	ecx, ebx
		push	ebp		; void *
		push	0		; int
		push	eax		; int
		call	sub_1000532F
		mov	ecx, [eax]
		mov	eax, [esp+18h+arg_0]
		mov	[eax], ecx

loc_10005217:				; CODE XREF: sub_100050C9+131j
		pop	edi
		pop	esi
		pop	ebp

loc_1000521A:				; CODE XREF: sub_100050C9+24j
		pop	ebx
		pop	ecx
		pop	ecx
		retn	10h
sub_100050C9	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10005220(int, int, int, void *)
sub_10005220	proc near		; CODE XREF: sub_100054CC+42p

var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 0
		jnz	short loc_10005249
		push	[esp+0Ch+arg_C]	; void *
		push	[esp+10h+arg_8]	; int
		push	dword ptr [edi]	; int
		push	1		; char
		push	[esp+1Ch+arg_0]	; int
		call	sub_1000898F
		mov	eax, [esp+0Ch+arg_0]
		jmp	loc_10005329
; ---------------------------------------------------------------------------

loc_10005249:				; CODE XREF: sub_10005220+9j
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		push	ebp
		mov	ebp, [edi]
		push	esi
		mov	esi, [esp+18h+arg_4]
		cmp	esi, [ebp+0]
		jnz	short loc_10005271
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	loc_1000530B
		push	[esp+18h+arg_C]
		push	ebx

loc_1000526B:				; CODE XREF: sub_10005220+9Cj
		push	esi
		jmp	loc_100052FA
; ---------------------------------------------------------------------------

loc_10005271:				; CODE XREF: sub_10005220+39j
		cmp	esi, ebp
		jnz	short loc_1000528F
		mov	ecx, [ebp+8]
		mov	eax, [ecx+10h]
		cmp	eax, [ebx]
		jnb	loc_1000530B
		push	[esp+18h+arg_C]
		push	ebx
		push	ecx
		push	0
		mov	ecx, edi
		jmp	short loc_100052FC
; ---------------------------------------------------------------------------

loc_1000528F:				; CODE XREF: sub_10005220+53j
		mov	eax, [ebx]
		cmp	[esi+10h], eax
		jbe	short loc_100052C6
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], esi
		call	sub_1000911E
		mov	eax, [esp+18h+arg_8]
		mov	ecx, [ebx]
		cmp	[eax+10h], ecx
		jnb	short loc_100052C1
		mov	ecx, [eax+8]
		push	[esp+18h+arg_C]
		push	ebx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000526B
		push	eax
		jmp	short loc_100052F5
; ---------------------------------------------------------------------------

loc_100052C1:				; CODE XREF: sub_10005220+8Cj
		mov	eax, ecx
		cmp	[esi+10h], eax

loc_100052C6:				; CODE XREF: sub_10005220+74j
		jnb	short loc_1000530B
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], esi
		call	sub_1000CDCC
		mov	eax, [esp+18h+arg_8]
		cmp	eax, ebp
		jz	short loc_100052E4
		mov	ecx, [ebx]
		cmp	ecx, [eax+10h]
		jnb	short loc_1000530B

loc_100052E4:				; CODE XREF: sub_10005220+BBj
		mov	ecx, [esi+8]
		push	[esp+18h+arg_C]	; void *
		push	ebx		; int
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_100052F9
		push	esi

loc_100052F5:				; CODE XREF: sub_10005220+9Fj
		push	0
		jmp	short loc_100052FC
; ---------------------------------------------------------------------------

loc_100052F9:				; CODE XREF: sub_10005220+D2j
		push	eax		; int

loc_100052FA:				; CODE XREF: sub_10005220+4Cj
		push	1		; char

loc_100052FC:				; CODE XREF: sub_10005220+6Dj
					; sub_10005220+D7j
		push	[esp+28h+arg_0]	; int
		call	sub_1000898F
		mov	eax, [esp+18h+arg_0]
		jmp	short loc_10005326
; ---------------------------------------------------------------------------

loc_1000530B:				; CODE XREF: sub_10005220+40j
					; sub_10005220+5Dj ...
		push	[esp+18h+arg_C]	; void *
		lea	eax, [esp+1Ch+var_8]
		mov	ecx, edi
		push	ebx		; int
		push	0		; int
		push	eax		; int
		call	sub_10008D96
		mov	ecx, [eax]
		mov	eax, [esp+18h+arg_0]
		mov	[eax], ecx

loc_10005326:				; CODE XREF: sub_10005220+E9j
		pop	esi
		pop	ebp
		pop	ebx

loc_10005329:				; CODE XREF: sub_10005220+24j
		pop	edi
		pop	ecx
		pop	ecx
		retn	10h
sub_10005220	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000532F(int, int, void *, void *)
sub_1000532F	proc near		; CODE XREF: sub_100050C9+141p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_8]
		mov	ebx, ecx
		push	esi
		push	edi
		mov	al, 1
		mov	[esp+18h+var_4], ebx
		mov	edi, [ebx]
		mov	byte ptr [esp+18h+var_8], al
		mov	esi, [edi+4]
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_10005393
		mov	bl, byte ptr [esp+18h+arg_4]

loc_10005354:				; CODE XREF: sub_1000532F+5Ej
		mov	edi, esi
		test	bl, bl
		jz	short loc_1000536A
		push	ebp		; void *
		lea	ecx, [esi+10h]
		call	sub_10005804
		test	eax, eax
		setns	al
		jmp	short loc_1000537A
; ---------------------------------------------------------------------------

loc_1000536A:				; CODE XREF: sub_1000532F+29j
		lea	eax, [esi+10h]
		mov	ecx, ebp
		push	eax		; void *
		call	sub_10005804
		test	eax, eax
		sets	al

loc_1000537A:				; CODE XREF: sub_1000532F+39j
		mov	byte ptr [esp+18h+var_8], al
		test	al, al
		jz	short loc_10005386
		mov	esi, [esi]
		jmp	short loc_10005389
; ---------------------------------------------------------------------------

loc_10005386:				; CODE XREF: sub_1000532F+51j
		mov	esi, [esi+8]

loc_10005389:				; CODE XREF: sub_1000532F+55j
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_10005354
		mov	ebx, [esp+18h+var_4]

loc_10005393:				; CODE XREF: sub_1000532F+1Fj
		mov	esi, edi
		mov	[esp+18h+arg_4], esi
		test	al, al
		jz	short loc_100053D2
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_100053C5
		push	[esp+18h+arg_C]	; void *
		mov	ecx, ebx
		push	ebp		; int
		push	edi		; int
		push	1		; char

loc_100053AD:				; CODE XREF: sub_1000532F+BCj
		lea	eax, [esp+28h+arg_4]
		push	eax		; int
		call	sub_10004FA8
		mov	ecx, [eax]
		mov	eax, [esp+18h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_100053FC
; ---------------------------------------------------------------------------

loc_100053C5:				; CODE XREF: sub_1000532F+72j
		lea	ecx, [esp+18h+arg_4]
		call	sub_1000911E
		mov	esi, [esp+18h+arg_4]

loc_100053D2:				; CODE XREF: sub_1000532F+6Cj
		push	ebp		; void *
		lea	ecx, [esi+10h]
		call	sub_10005804
		mov	ecx, ebx
		push	[esp+18h+arg_C]	; void *
		test	eax, eax
		jns	short loc_100053ED
		push	ebp
		push	edi
		push	[esp+24h+var_8]
		jmp	short loc_100053AD
; ---------------------------------------------------------------------------

loc_100053ED:				; CODE XREF: sub_1000532F+B4j
		call	sub_1000574E
		mov	eax, [esp+18h+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_100053FC:				; CODE XREF: sub_1000532F+94j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	10h
sub_1000532F	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10005405(LPCRITICAL_SECTION lpCriticalSection)
sub_10005405	proc near		; CODE XREF: sub_100055E3+Ej

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		call	sub_10004D78
		lea	ebx, [edi+18h]
		xor	ebp, ebp
		mov	ecx, ebx
		mov	[ebx], ebp
		mov	[ebx+4], ebp
		call	sub_100056C0
		lea	esi, [edi+20h]
		mov	[ebx], eax
		mov	ecx, esi
		mov	[esi], ebp
		mov	[esi+4], ebp
		call	sub_10009D93
		mov	[esi], eax
		lea	esi, [edi+28h]
		mov	ecx, esi
		mov	[esi], ebp
		mov	[esi+4], ebp
		call	sub_10009D93
		mov	[esi], eax
		push	18h		; unsigned int
		mov	[edi+30h], ebp
		mov	[edi+34h], ebp
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	esi, offset word_1001CDEA
		pop	ecx
		test	eax, eax
		jz	short loc_10005479
		push	esi		; void *
		mov	ecx, eax
		call	sub_10001075
		mov	dword_10033B14,	eax
		jmp	short loc_1000547F
; ---------------------------------------------------------------------------

loc_10005479:				; CODE XREF: sub_10005405+63j
		mov	dword_10033B14,	ebp

loc_1000547F:				; CODE XREF: sub_10005405+72j
		mov	ecx, edi	; lpCriticalSection
		call	sub_10004D93
		push	esi		; void *
		lea	ecx, [esp+30h+var_1C]
		call	sub_10001075
		lea	eax, [esp+2Ch+var_1C]
		mov	ecx, ebx
		push	eax		; void *
		call	sub_10005522
		mov	ecx, dword_10033B14
		push	ebp		; size_t
		push	1		; char
		mov	[eax], ecx
		lea	ecx, [esp+34h+var_1C] ;	void *
		call	sub_10001769
		mov	ecx, edi	; lpCriticalSection
		call	sub_10004D9B
		mov	ecx, [esp+2Ch+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_10005405	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100054CC	proc near		; CODE XREF: sub_100055F9+9Ap

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		push	ebx
		mov	edi, ecx
		call	sub_1000576A
		mov	esi, eax
		cmp	esi, [edi]
		jz	short loc_100054EB
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	short loc_10005516

loc_100054EB:				; CODE XREF: sub_100054CC+16j
		lea	eax, [ebp+arg_0+3]
		mov	[ebp+var_4], ebx
		push	eax
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		push	offset byte_10033B13
		call	sub_10004F51
		push	eax		; void *
		add	eax, 10h
		mov	ecx, edi
		push	eax		; int
		push	esi		; int
		lea	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_10005220
		mov	esi, [ebp+arg_0]

loc_10005516:				; CODE XREF: sub_100054CC+1Dj
		pop	edi
		lea	eax, [esi+14h]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100054CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10005522(void *)
sub_10005522	proc near		; CODE XREF: sub_10005405+92p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		push	ebx		; void *
		mov	edi, ecx
		call	sub_10005794
		mov	esi, eax
		cmp	esi, [edi]
		jz	short loc_10005549
		lea	eax, [esi+10h]
		mov	ecx, ebx
		push	eax		; void *
		call	sub_10005804
		test	eax, eax
		jns	short loc_10005574

loc_10005549:				; CODE XREF: sub_10005522+16j
		lea	eax, [ebp+arg_0+3]
		mov	[ebp+var_4], ebx
		push	eax
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		push	offset byte_10033B13
		call	sub_10004F23
		push	eax		; void *
		add	eax, 10h
		mov	ecx, edi
		push	eax		; void *
		push	esi		; int
		lea	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_100050C9
		mov	esi, [ebp+arg_0]

loc_10005574:				; CODE XREF: sub_10005522+25j
		pop	edi
		lea	eax, [esi+28h]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10005522	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10005580(void *)
sub_10005580	proc near		; CODE XREF: sub_100055F9+69p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		push	ebx		; void *
		mov	edi, ecx
		call	sub_10005794
		mov	esi, eax
		cmp	esi, [edi]
		jz	short loc_100055A7
		lea	eax, [esi+10h]
		mov	ecx, ebx
		push	eax		; void *
		call	sub_10005804
		test	eax, eax
		jns	short loc_100055D2

loc_100055A7:				; CODE XREF: sub_10005580+16j
		lea	eax, [ebp+arg_0+3]
		mov	[ebp+var_4], ebx
		push	eax
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		push	offset byte_10033B13
		call	sub_10004F7A
		push	eax		; void *
		add	eax, 10h
		mov	ecx, edi
		push	eax		; void *
		push	esi		; int
		lea	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_100050C9
		mov	esi, [ebp+arg_0]

loc_100055D2:				; CODE XREF: sub_10005580+25j
		pop	edi
		lea	eax, [esi+28h]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10005580	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_100055DE	proc near		; CODE XREF: sub_10004E1F+1Cp
		jmp	sub_10005861
sub_100055DE	endp


; =============== S U B	R O U T	I N E =======================================


sub_100055E3	proc near		; CODE XREF: sub_10005861+1Fp
		push	38h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100055F6
		mov	ecx, eax	; lpCriticalSection
		jmp	sub_10005405
; ---------------------------------------------------------------------------

loc_100055F6:				; CODE XREF: sub_100055E3+Aj
		xor	eax, eax
		retn
sub_100055E3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_100055F9(LPCRITICAL_SECTION lpCriticalSection, int, void *)
sub_100055F9	proc near		; CODE XREF: sub_10004E1F+23p

var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		lea	ecx, [ebp+var_1C]
		push	eax		; void *
		call	sub_10001075
		mov	ecx, edi	; lpCriticalSection
		call	sub_10004D93
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		lea	eax, [ebp+var_20]
		lea	esi, [edi+18h]
		push	eax		; int
		mov	ecx, esi
		call	sub_10005822
		mov	eax, [ebp+var_20]
		cmp	eax, [esi]
		jz	short loc_1000563F
		mov	ebx, [eax+28h]
		jmp	short loc_10005669
; ---------------------------------------------------------------------------

loc_1000563F:				; CODE XREF: sub_100055F9+3Fj
		push	18h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_1000565A
		lea	ecx, [ebp+var_1C]
		push	ecx
		mov	ecx, eax
		call	sub_10003AD7
		mov	ebx, eax
		jmp	short loc_1000565C
; ---------------------------------------------------------------------------

loc_1000565A:				; CODE XREF: sub_100055F9+50j
		xor	ebx, ebx

loc_1000565C:				; CODE XREF: sub_100055F9+5Fj
		lea	eax, [ebp+var_1C]
		mov	ecx, esi
		push	eax		; void *
		call	sub_10005580
		mov	[eax], ebx

loc_10005669:				; CODE XREF: sub_100055F9+44j
		lea	eax, [ebp+arg_0]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		lea	ecx, [edi+20h]
		call	sub_1000A208
		mov	eax, [ebp+var_20]
		cmp	eax, [edi+20h]
		jnz	short loc_1000568C
		mov	eax, [ebp+arg_0]
		mov	[edi+30h], ebx
		mov	[edi+34h], eax
		jmp	short loc_1000569A
; ---------------------------------------------------------------------------

loc_1000568C:				; CODE XREF: sub_100055F9+86j
		add	eax, 14h
		lea	ecx, [edi+28h]
		push	eax
		call	sub_100054CC
		mov	[eax], ebx

loc_1000569A:				; CODE XREF: sub_100055F9+91j
		mov	ecx, edi	; lpCriticalSection
		call	sub_10004D9B
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_10001769
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	8
sub_100055F9	endp


; =============== S U B	R O U T	I N E =======================================


sub_100056C0	proc near		; CODE XREF: sub_10005405+25p
		push	0
		push	1
		call	sub_10004EF9
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_100056D1
		mov	[eax], eax

loc_100056D1:				; CODE XREF: sub_100056C0+Dj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_100056DA
		mov	[ecx], eax

loc_100056DA:				; CODE XREF: sub_100056C0+16j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_100056E3
		mov	[ecx], eax

loc_100056E3:				; CODE XREF: sub_100056C0+1Fj
		mov	word ptr [eax+0Ch], 101h
		retn
sub_100056C0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100056EA	proc near		; CODE XREF: sub_10004F23+2p
					; sub_10004F7A+2p
		push	esi
		push	0
		push	1
		mov	esi, ecx
		call	sub_10004EF9
		mov	edx, eax
		pop	ecx
		pop	ecx
		test	edx, edx
		jz	short loc_10005702
		mov	ecx, [esi]
		mov	[edx], ecx

loc_10005702:				; CODE XREF: sub_100056EA+12j
		lea	ecx, [edx+4]
		test	ecx, ecx
		jz	short loc_1000570D
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000570D:				; CODE XREF: sub_100056EA+1Dj
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10005718
		mov	eax, [esi]
		mov	[ecx], eax

loc_10005718:				; CODE XREF: sub_100056EA+28j
		mov	eax, edx
		pop	esi
		retn
sub_100056EA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000571C	proc near		; CODE XREF: sub_10004F51+1p
					; sub_10008820+1p
		push	esi
		push	0
		push	1
		mov	esi, ecx
		call	sub_100087AC
		mov	edx, eax
		pop	ecx
		pop	ecx
		test	edx, edx
		jz	short loc_10005734
		mov	ecx, [esi]
		mov	[edx], ecx

loc_10005734:				; CODE XREF: sub_1000571C+12j
		lea	ecx, [edx+4]
		test	ecx, ecx
		jz	short loc_1000573F
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000573F:				; CODE XREF: sub_1000571C+1Dj
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_1000574A
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000574A:				; CODE XREF: sub_1000571C+28j
		mov	eax, edx
		pop	esi
		retn
sub_1000571C	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000574E(void *)
sub_1000574E	proc near		; CODE XREF: sub_10004FA8+15p
					; sub_1000532F:loc_100053EDp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	0		; size_t
		push	1		; char
		lea	ecx, [esi+10h]	; void *
		call	sub_10001769
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	esi
		retn	4
sub_1000574E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000576A	proc near		; CODE XREF: sub_100054CC+Dp
					; sub_100090C8+Dp ...

arg_0		= dword	ptr  4

		mov	edx, [ecx]
		mov	ecx, [edx+4]
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_1000578F
		mov	eax, [esp+arg_0]
		mov	eax, [eax]

loc_1000577B:				; CODE XREF: sub_1000576A+23j
		cmp	[ecx+10h], eax
		jnb	short loc_10005785
		mov	ecx, [ecx+8]
		jmp	short loc_10005789
; ---------------------------------------------------------------------------

loc_10005785:				; CODE XREF: sub_1000576A+14j
		mov	edx, ecx
		mov	ecx, [ecx]

loc_10005789:				; CODE XREF: sub_1000576A+19j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_1000577B

loc_1000578F:				; CODE XREF: sub_1000576A+9j
		mov	eax, edx
		retn	4
sub_1000576A	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10005794(void *)
sub_10005794	proc near		; CODE XREF: sub_10005522+Dp
					; sub_10005580+Dp ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [ecx]
		mov	esi, [edi+4]
		jmp	short loc_100057B6
; ---------------------------------------------------------------------------

loc_1000579D:				; CODE XREF: sub_10005794+26j
		push	[esp+8+arg_0]	; void *
		lea	ecx, [esi+10h]
		call	sub_10005804
		test	eax, eax
		jns	short loc_100057B2
		mov	esi, [esi+8]
		jmp	short loc_100057B6
; ---------------------------------------------------------------------------

loc_100057B2:				; CODE XREF: sub_10005794+17j
		mov	edi, esi
		mov	esi, [esi]

loc_100057B6:				; CODE XREF: sub_10005794+7j
					; sub_10005794+1Cj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000579D
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_10005794	endp


; =============== S U B	R O U T	I N E =======================================


sub_100057C3	proc near		; CODE XREF: sub_10004FA8+8Ep
					; sub_10004FA8+FAp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, [edx+8]
		mov	eax, [esi]
		mov	[edx+8], eax
		mov	eax, [esi]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_100057DB
		mov	[eax+4], edx

loc_100057DB:				; CODE XREF: sub_100057C3+13j
		mov	eax, [edx+4]
		mov	[esi+4], eax
		mov	eax, [ecx]
		cmp	edx, [eax+4]
		jnz	short loc_100057ED
		mov	[eax+4], esi
		jmp	short loc_100057FB
; ---------------------------------------------------------------------------

loc_100057ED:				; CODE XREF: sub_100057C3+23j
		mov	eax, [edx+4]
		cmp	edx, [eax]
		jnz	short loc_100057F8
		mov	[eax], esi
		jmp	short loc_100057FB
; ---------------------------------------------------------------------------

loc_100057F8:				; CODE XREF: sub_100057C3+2Fj
		mov	[eax+8], esi

loc_100057FB:				; CODE XREF: sub_100057C3+28j
					; sub_100057C3+33j
		mov	[esi], edx
		mov	[edx+4], esi
		pop	esi
		retn	4
sub_100057C3	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10005804(void *)
sub_10005804	proc near		; CODE XREF: sub_100050C9+40p
					; sub_100050C9+68p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+14h], 10h
		mov	edx, [eax+10h]
		jb	short loc_10005813
		mov	eax, [eax]

loc_10005813:				; CODE XREF: sub_10005804+Bj
		push	edx		; int
		push	eax		; void *
		push	dword ptr [ecx+10h] ; size_t
		push	0		; int
		call	sub_10004123
		retn	4
sub_10005804	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10005822(int, void *)
sub_10005822	proc near		; CODE XREF: sub_100055F9+35p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	[ebp+arg_4]	; void *
		mov	edi, ecx
		call	sub_10005794
		mov	esi, eax
		cmp	esi, [edi]
		jz	short loc_1000584C
		mov	ecx, [ebp+arg_4]
		lea	eax, [esi+10h]
		push	eax		; void *
		call	sub_10005804
		test	eax, eax
		js	short loc_1000584C
		mov	[ebp+arg_4], esi
		jmp	short loc_10005851
; ---------------------------------------------------------------------------

loc_1000584C:				; CODE XREF: sub_10005822+13j
					; sub_10005822+23j
		mov	eax, [edi]
		mov	[ebp+arg_4], eax

loc_10005851:				; CODE XREF: sub_10005822+28j
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+arg_4]
		mov	ecx, [ecx]
		pop	edi
		pop	esi
		mov	[eax], ecx
		pop	ebp
		retn	8
sub_10005822	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005861	proc near		; CODE XREF: sub_100055DEj
		mov	eax, dword_10033B18
		xor	ecx, ecx
		inc	ecx
		test	eax, eax
		jz	short loc_10005871
		cmp	eax, ecx
		jnz	short locret_10005892

loc_10005871:				; CODE XREF: sub_10005861+Aj
		mov	edx, offset dword_10033B18
		xor	eax, eax
		lock cmpxchg [edx], ecx
		test	eax, eax
		jnz	short loc_1000588B
		call	sub_100055E3
		mov	dword_10033B18,	eax
		retn
; ---------------------------------------------------------------------------

loc_1000588B:				; CODE XREF: sub_10005861+1Dj
		push	edx
		call	sub_100035B6
		pop	ecx

locret_10005892:			; CODE XREF: sub_10005861+Ej
		retn
sub_10005861	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005893	proc near		; CODE XREF: sub_10005910+6Dp
		push	esi
		mov	esi, ecx
		call	sub_100058BF
		test	al, al
		jz	short loc_100058A9
		or	eax, 0FFFFFFFFh
		mov	edx, 7FFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100058A9:				; CODE XREF: sub_10005893+Aj
		mov	eax, [esi]
		mov	edx, [esi+4]
		pop	esi
		retn
sub_10005893	endp


; =============== S U B	R O U T	I N E =======================================


sub_100058B0	proc near		; CODE XREF: sub_10005A27+19p
					; sub_10005A55+15p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		or	dword ptr [eax], 0FFFFFFFFh
		mov	dword ptr [eax+4], 7FFFFFFFh
		retn
sub_100058B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100058BF	proc near		; CODE XREF: sub_10005893+3p
		cmp	dword ptr [ecx], 0FFFFFFFFh
		jnz	short loc_100058D1
		cmp	dword ptr [ecx+4], 7FFFFFFFh
		jnz	short loc_100058D1
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100058D1:				; CODE XREF: sub_100058BF+3j
					; sub_100058BF+Cj
		xor	eax, eax
		retn
sub_100058BF	endp

; [00000006 BYTES: COLLAPSED FUNCTION timeGetTime]

; =============== S U B	R O U T	I N E =======================================


sub_100058DA	proc near		; DATA XREF: .data:off_10033014o

arg_0		= dword	ptr  4

		call	sub_100059CF
		mov	ecx, offset off_10033014
		test	al, al
		jnz	short loc_100058FA
		mov	eax, offset sub_10005BE9
		xchg	eax, [ecx]
		push	[esp+arg_0]
		call	sub_10005BE9
		jmp	short loc_1000590A
; ---------------------------------------------------------------------------

loc_100058FA:				; CODE XREF: sub_100058DA+Cj
		mov	eax, offset sub_10005A9D
		xchg	eax, [ecx]
		push	[esp+arg_0]
		call	sub_10005A9D

loc_1000590A:				; CODE XREF: sub_100058DA+1Ej
		mov	eax, [esp+4+arg_0]
		pop	ecx
		retn
sub_100058DA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005910	proc near		; CODE XREF: sub_10005A93+8Dp

var_6C		= byte ptr -6Ch
Frequency	= LARGE_INTEGER	ptr -64h
var_5C		= byte ptr -5Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 6Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, ecx
		lea	ecx, [ebp+var_5C]
		push	esi
		xor	esi, esi
		mov	[ebx], esi
		mov	[ebx+4], esi
		mov	[ebx+8], esi
		mov	[ebx+0Ch], esi
		call	sub_1000311A
		lea	eax, [ebp+var_5C]
		push	eax
		call	sub_10005AB2
		pop	ecx
		test	al, al
		jz	short loc_10005951

loc_10005947:				; CODE XREF: sub_10005910+53j
		lea	ecx, [ebp+var_5C]
		call	sub_100059B2
		jmp	short loc_100059A0
; ---------------------------------------------------------------------------

loc_10005951:				; CODE XREF: sub_10005910+35j
		lea	eax, [ebp+Frequency]
		mov	dword ptr [ebp+Frequency], esi
		push	eax		; lpFrequency
		mov	dword ptr [ebp+Frequency+4], esi
		call	ds:QueryPerformanceFrequency
		test	eax, eax
		jz	short loc_10005947
		mov	eax, dword ptr [ebp+Frequency]
		mov	[ebx], eax
		mov	eax, dword ptr [ebp+Frequency+4]
		mov	[ebx+4], eax
		lea	eax, [ebp+var_6C]
		push	edi
		push	eax
		call	sub_10005BE9
		pop	ecx
		mov	ecx, eax
		call	sub_10005893
		mov	ecx, ebx
		mov	esi, eax
		mov	edi, edx
		call	sub_10005C4D
		sub	eax, esi
		lea	ecx, [ebp+var_5C]
		mov	[ebx+8], eax
		sbb	edx, edi
		mov	[ebx+0Ch], edx
		call	sub_100059B2
		pop	edi

loc_100059A0:				; CODE XREF: sub_10005910+3Fj
		mov	ecx, [ebp+var_4]
		mov	eax, ebx
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10005910	endp


; =============== S U B	R O U T	I N E =======================================


sub_100059B2	proc near		; CODE XREF: sub_10005910+3Ap
					; sub_10005910+8Ap ...
		push	esi
		mov	esi, ecx
		push	0		; size_t
		push	1		; char
		lea	ecx, [esi+40h]	; void *
		call	sub_10001769
		push	0		; size_t
		push	1		; char
		lea	ecx, [esi+28h]	; void *
		call	sub_10001769
		pop	esi
		retn
sub_100059B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100059CF	proc near		; CODE XREF: sub_100058DAp

var_5C		= byte ptr -5Ch
var_36		= byte ptr -36h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 5Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		lea	ecx, [ebp+var_5C]
		call	sub_1000311A
		cmp	[ebp+var_36], 0
		jz	short loc_10005A0C
		call	sub_10005A93
		mov	ecx, [eax]
		or	ecx, [eax+4]
		jz	short loc_10005A0C
		lea	eax, [ebp+var_5C]
		push	eax
		call	sub_10005AB2
		pop	ecx
		test	al, al
		jnz	short loc_10005A0C
		mov	bl, 1
		jmp	short loc_10005A0E
; ---------------------------------------------------------------------------

loc_10005A0C:				; CODE XREF: sub_100059CF+1Dj
					; sub_100059CF+29j ...
		xor	bl, bl

loc_10005A0E:				; CODE XREF: sub_100059CF+3Bj
		lea	ecx, [ebp+var_5C]
		call	sub_100059B2
		mov	ecx, [ebp+var_4]
		mov	al, bl
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100059CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005A27	proc near		; CODE XREF: sub_10005AD5+12p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		cmp	edx, 0FFFFFFFFh
		jnz	short loc_10005A4B
		cmp	ecx, 7FFFFFFFh
		jnz	short loc_10005A4B
		push	[ebp+arg_0]
		call	sub_100058B0
		mov	eax, [ebp+arg_0]
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10005A4B:				; CODE XREF: sub_10005A27+Cj
					; sub_10005A27+14j
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[eax+4], ecx
		pop	ebp
		retn
sub_10005A27	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005A55	proc near		; CODE XREF: sub_10005BE9+4Ep

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_10005A75
		cmp	[ebp+arg_8], 7FFFFFFFh
		jnz	short loc_10005A75
		push	[ebp+arg_0]
		call	sub_100058B0
		mov	eax, [ebp+arg_0]
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10005A75:				; CODE XREF: sub_10005A55+7j
					; sub_10005A55+10j
		push	0
		push	3E8h
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	__allmul
		mov	ecx, [ebp+arg_0]
		mov	[ecx], eax
		mov	eax, ecx
		mov	[ecx+4], edx
		pop	ebp
		retn
sub_10005A55	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005A93	proc near		; CODE XREF: sub_100059CF+1Fp
					; sub_10005A9D+4p

; FUNCTION CHUNK AT 10005B02 SIZE 00000038 BYTES

		mov	ecx, offset dword_10033B70
		jmp	loc_10005B02
sub_10005A93	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005A9D	proc near		; CODE XREF: sub_100058DA+2Bp
					; DATA XREF: sub_100058DA:loc_100058FAo

arg_0		= dword	ptr  4

		push	[esp+arg_0]
		call	sub_10005A93
		mov	ecx, eax
		call	sub_10005AD5
		mov	eax, [esp+arg_0]
		retn
sub_10005A9D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005AB2	proc near		; CODE XREF: sub_10005910+2Dp
					; sub_100059CF+2Fp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	offset aAuthenticamd ; "AuthenticAMD"
		lea	ecx, [esi+28h]
		call	sub_10005C71
		test	eax, eax
		jnz	short loc_10005AD1
		cmp	dword ptr [esi+8], 0Fh
		jnz	short loc_10005AD1
		inc	eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005AD1:				; CODE XREF: sub_10005AB2+14j
					; sub_10005AB2+1Aj
		xor	eax, eax
		pop	esi
		retn
sub_10005AB2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005AD5	proc near		; CODE XREF: sub_10005A9D+Bp

arg_0		= dword	ptr  4

		mov	eax, [ecx]
		or	eax, [ecx+4]
		jz	short loc_10005AF1
		call	sub_10005C4D
		push	edx
		push	eax
		push	[esp+8+arg_0]
		call	sub_10005A27
		add	esp, 0Ch
		jmp	short loc_10005AFB
; ---------------------------------------------------------------------------

loc_10005AF1:				; CODE XREF: sub_10005AD5+5j
		push	[esp+arg_0]
		call	sub_10005BE9
		pop	ecx

loc_10005AFB:				; CODE XREF: sub_10005AD5+1Aj
		mov	eax, [esp+arg_0]
		retn	4
sub_10005AD5	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10005A93

loc_10005B02:				; CODE XREF: sub_10005A93+5j
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		test	eax, 0FFFFFFFEh
		jnz	short loc_10005B36
		push	esi
		call	sub_10003424
		pop	ecx
		test	al, al
		jz	short loc_10005B36
		lea	ecx, [esi+8]
		test	ecx, ecx
		jz	short loc_10005B27
		call	sub_10005910
		jmp	short loc_10005B29
; ---------------------------------------------------------------------------

loc_10005B27:				; CODE XREF: sub_10005A93+8Bj
		xor	eax, eax

loc_10005B29:				; CODE XREF: sub_10005A93+92j
		push	0
		push	esi
		push	eax
		push	esi
		call	sub_10003404
		add	esp, 10h

loc_10005B36:				; CODE XREF: sub_10005A93+79j
					; sub_10005A93+84j
		mov	eax, [esi]
		pop	esi
		retn
; END OF FUNCTION CHUNK	FOR sub_10005A93

; =============== S U B	R O U T	I N E =======================================


sub_10005B3A	proc near		; CODE XREF: sub_10005C4D+1Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [ecx]
		mov	eax, ebx
		push	ebp
		mov	ebp, [ecx+4]
		or	eax, ebp
		mov	[esp+10h+var_4], ebx
		mov	[esp+10h+var_8], ebp
		jnz	short loc_10005B58
		xor	edx, edx
		jmp	loc_10005BE2
; ---------------------------------------------------------------------------

loc_10005B58:				; CODE XREF: sub_10005B3A+15j
		push	esi
		mov	esi, [esp+14h+arg_0]
		push	edi
		mov	edi, [esp+18h+arg_4]
		cmp	edi, 863h
		jg	short loc_10005B8D
		jl	short loc_10005B74
		cmp	esi, 7BD05AF7h
		jnb	short loc_10005B8D

loc_10005B74:				; CODE XREF: sub_10005B3A+30j
		push	0
		push	0F4240h
		push	edi
		push	esi
		call	__allmul
		push	ebp
		push	ebx
		push	edx
		push	eax
		call	__alldiv
		jmp	short loc_10005BE0
; ---------------------------------------------------------------------------

loc_10005B8D:				; CODE XREF: sub_10005B3A+2Ej
					; sub_10005B3A+38j
		push	ebp
		push	ebx
		push	edi
		push	esi
		call	__alldiv
		mov	ebx, edx
		mov	ebp, eax
		push	ebx
		push	ebp
		push	[esp+20h+var_8]
		push	[esp+24h+var_4]
		call	__allmul
		sub	esi, eax
		push	0
		push	0F4240h
		sbb	edi, edx
		push	edi
		push	esi
		call	__allmul
		push	[esp+18h+var_8]
		push	[esp+1Ch+var_4]
		push	edx
		push	eax
		call	__alldiv
		push	0
		push	0F4240h
		push	ebx
		push	ebp
		mov	esi, eax
		mov	edi, edx
		call	__allmul
		add	eax, esi
		adc	edx, edi

loc_10005BE0:				; CODE XREF: sub_10005B3A+51j
		pop	edi
		pop	esi

loc_10005BE2:				; CODE XREF: sub_10005B3A+19j
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	8
sub_10005B3A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005BE9	proc near		; CODE XREF: sub_100058DA+19p
					; sub_10005910+65p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, offset CriticalSection
		mov	ecx, edi	; lpCriticalSection
		call	sub_10004D93
		call	off_10033010
		mov	ecx, dword_10033B68
		mov	esi, eax
		mov	edx, dword_10033B6C
		cmp	esi, dword_10033B64
		jnb	short loc_10005C25
		add	ecx, 0
		mov	dword_10033B68,	ecx
		adc	edx, 1
		mov	dword_10033B6C,	edx

loc_10005C25:				; CODE XREF: sub_10005BE9+28j
		xor	eax, eax
		mov	dword_10033B64,	esi
		add	esi, ecx
		adc	eax, edx
		push	eax
		push	esi
		push	[esp+10h+arg_0]
		call	sub_10005A55
		add	esp, 0Ch
		mov	ecx, edi	; lpCriticalSection
		call	sub_10004D9B
		mov	eax, [esp+8+arg_0]
		pop	edi
		pop	esi
		retn
sub_10005BE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005C4D	proc near		; CODE XREF: sub_10005910+78p
					; sub_10005AD5+7p

PerformanceCount= LARGE_INTEGER	ptr -8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		lea	eax, [ebp+PerformanceCount]
		mov	esi, ecx
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		push	dword ptr [ebp+PerformanceCount+4]
		mov	ecx, esi
		push	dword ptr [ebp+PerformanceCount]
		call	sub_10005B3A
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10005C4D	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10005C71(void *)
sub_10005C71	proc near		; CODE XREF: sub_10005AB2+Dp
					; sub_1000F691+1Fp

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, ecx
		call	sub_100019DA
		pop	ecx
		push	eax		; int
		push	[esp+8+arg_0]	; void *
		mov	ecx, esi
		push	dword ptr [esi+10h] ; size_t
		push	0		; int
		call	sub_10004123
		pop	esi
		retn	4
sub_10005C71	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005C93	proc near		; CODE XREF: sub_10005D9A+7p
					; sub_1000A5EB+39p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		push	edi
		push	0
		mov	esi, ecx
		call	sub_10005CDE
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10005CAC

loc_10005CA8:				; CODE XREF: sub_10005C93+2Dj
		xor	eax, eax
		jmp	short loc_10005CD6
; ---------------------------------------------------------------------------

loc_10005CAC:				; CODE XREF: sub_10005C93+13j
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_0]
		mov	ecx, esi
		call	sub_10005DE1
		test	al, al
		jz	short loc_10005CA8
		mov	eax, [esi]
		mov	ecx, esi
		push	dword ptr [edi+1Ch]
		call	dword ptr [eax+4]
		movzx	ecx, word ptr [ebp+var_4]
		sub	ecx, [edi+10h]
		lea	eax, [eax+ecx*4]

loc_10005CD6:				; CODE XREF: sub_10005C93+17j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10005C93	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005CDE	proc near		; CODE XREF: sub_10005C93+Ap
					; sub_10005D9A+22p ...

arg_0		= dword	ptr  4

		mov	eax, [ecx+4]
		mov	edx, [ecx]
		push	esi
		mov	esi, [eax+3Ch]
		add	esi, eax
		mov	eax, [esp+4+arg_0]
		push	dword ptr [esi+eax*8+78h]
		call	dword ptr [edx+4]
		pop	esi
		retn	4
sub_10005CDE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005CF8	proc near		; CODE XREF: sub_10018534+18p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		xor	edi, edi
		jmp	short loc_10005D1F
; ---------------------------------------------------------------------------

loc_10005D01:				; CODE XREF: sub_10005CF8+31j
		push	dword ptr [esi+0Ch]
		mov	ecx, ebx
		call	sub_10005EE3
		cmp	eax, [esp+0Ch+arg_0]
		ja	short loc_10005D1C
		mov	ecx, [esi+8]
		add	ecx, eax
		cmp	ecx, [esp+0Ch+arg_0]
		ja	short loc_10005D31

loc_10005D1C:				; CODE XREF: sub_10005CF8+17j
		inc	edi
		mov	ecx, ebx

loc_10005D1F:				; CODE XREF: sub_10005CF8+7j
		push	edi
		call	sub_10005EB8
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10005D01

loc_10005D2B:				; CODE XREF: sub_10005CF8+3Bj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
; ---------------------------------------------------------------------------

loc_10005D31:				; CODE XREF: sub_10005CF8+22j
		mov	eax, esi
		jmp	short loc_10005D2B
sub_10005CF8	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10005D35(char *)
sub_10005D35	proc near		; CODE XREF: sub_100033A2+29p
					; sub_100033A2+3Ap

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		cmp	[esp+4+arg_0], 0
		push	ebp
		mov	ebp, ecx
		jnz	short loc_10005D44
		xor	eax, eax
		jmp	short loc_10005D8C
; ---------------------------------------------------------------------------

loc_10005D44:				; CODE XREF: sub_10005D35+9j
		mov	ecx, [ebp+4]
		push	esi
		push	edi
		xor	edi, edi
		mov	eax, [ecx+3Ch]
		mov	esi, edi
		movzx	eax, word ptr [eax+ecx+6]
		mov	[esp+10h+var_4], eax
		test	eax, eax
		jle	short loc_10005D88
		push	ebx

loc_10005D5E:				; CODE XREF: sub_10005D35+4Cj
		push	esi
		mov	ecx, ebp
		call	sub_10005EB8
		push	8		; size_t
		push	[esp+18h+arg_0]	; char *
		mov	ebx, eax
		push	ebx		; char *
		call	ds:_strnicmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10005D85
		inc	esi
		cmp	esi, [esp+14h+var_4]
		jl	short loc_10005D5E
		jmp	short loc_10005D87
; ---------------------------------------------------------------------------

loc_10005D85:				; CODE XREF: sub_10005D35+45j
		mov	edi, ebx

loc_10005D87:				; CODE XREF: sub_10005D35+4Ej
		pop	ebx

loc_10005D88:				; CODE XREF: sub_10005D35+26j
		mov	eax, edi
		pop	edi
		pop	esi

loc_10005D8C:				; CODE XREF: sub_10005D35+Dj
		pop	ebp
		pop	ecx
		retn	4
sub_10005D35	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005D91	proc near		; CODE XREF: sub_10015CD9+5Bp
					; sub_10019720+38p
		mov	ecx, [ecx+4]
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		retn
sub_10005D91	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005D9A	proc near		; CODE XREF: sub_1000F01E+67p
					; sub_100103AB+26p ...

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, ecx
		call	sub_10005C93
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_10005DDD
		mov	eax, [esi]
		push	edi
		push	dword ptr [ecx]
		mov	ecx, esi
		call	dword ptr [eax+4]
		push	0
		mov	ecx, esi
		mov	edi, eax
		call	sub_10005CDE
		mov	edx, [esi+4]
		cmp	eax, edi
		ja	short loc_10005DDA
		mov	ecx, [edx+3Ch]
		mov	ecx, [ecx+edx+7Ch]
		add	ecx, eax
		cmp	ecx, edi
		jbe	short loc_10005DDA
		or	eax, 0FFFFFFFFh
		jmp	short loc_10005DDC
; ---------------------------------------------------------------------------

loc_10005DDA:				; CODE XREF: sub_10005D9A+2Cj
					; sub_10005D9A+39j
		mov	eax, edi

loc_10005DDC:				; CODE XREF: sub_10005D9A+3Ej
		pop	edi

loc_10005DDD:				; CODE XREF: sub_10005D9A+10j
		pop	esi
		retn	4
sub_10005D9A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005DE1	proc near		; CODE XREF: sub_10005C93+26p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebp
		mov	ebp, [esp+0Ch+arg_4]
		push	edi
		mov	edi, ecx
		test	ebp, ebp
		jnz	short loc_10005DF6
		xor	al, al
		jmp	loc_10005EB1
; ---------------------------------------------------------------------------

loc_10005DF6:				; CODE XREF: sub_10005DE1+Cj
		push	ebx
		push	0
		call	sub_10005CDE
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_10005E0B
		xor	al, al
		jmp	loc_10005EB0
; ---------------------------------------------------------------------------

loc_10005E0B:				; CODE XREF: sub_10005DE1+21j
		mov	eax, [esp+14h+arg_0]
		push	esi
		cmp	eax, 0FFFFh
		jbe	loc_10005EA5
		mov	eax, [edi]
		mov	ecx, edi
		push	dword ptr [ebx+20h]
		call	dword ptr [eax+4]
		mov	ecx, [ebx+18h]
		mov	edx, eax
		mov	[esp+18h+var_4], edx
		mov	esi, edx
		lea	eax, [edx+ecx*4]
		mov	[esp+18h+var_8], eax
		cmp	edx, eax
		jz	short loc_10005EAD

loc_10005E3B:				; CODE XREF: sub_10005DE1+9Fj
		sub	eax, esi
		sar	eax, 2
		cdq
		sub	eax, edx
		sar	eax, 1
		lea	ecx, [esi+eax*4]
		mov	eax, [edi]
		push	dword ptr [ecx]
		mov	[esp+1Ch+arg_4], ecx
		mov	ecx, edi
		call	dword ptr [eax+4]
		push	eax
		push	[esp+1Ch+arg_0]
		call	sub_10005EF8
		mov	edx, eax
		pop	ecx
		pop	ecx
		test	edx, edx
		jz	short loc_10005E84
		jle	short loc_10005E76
		mov	esi, [esp+18h+arg_4]
		mov	eax, [esp+18h+var_8]
		add	esi, 4
		jmp	short loc_10005E7E
; ---------------------------------------------------------------------------

loc_10005E76:				; CODE XREF: sub_10005DE1+86j
		mov	eax, [esp+18h+arg_4]
		mov	[esp+18h+var_8], eax

loc_10005E7E:				; CODE XREF: sub_10005DE1+93j
		cmp	esi, eax
		jnz	short loc_10005E3B
		jmp	short loc_10005E88
; ---------------------------------------------------------------------------

loc_10005E84:				; CODE XREF: sub_10005DE1+84j
		mov	esi, [esp+18h+arg_4]

loc_10005E88:				; CODE XREF: sub_10005DE1+A1j
		test	edx, edx
		jnz	short loc_10005EAD
		mov	eax, [edi]
		mov	ecx, edi
		push	dword ptr [ebx+24h]
		call	dword ptr [eax+4]
		sub	esi, [esp+18h+var_4]
		sar	esi, 2
		mov	ax, [eax+esi*2]
		add	ax, [ebx+10h]

loc_10005EA5:				; CODE XREF: sub_10005DE1+34j
		mov	[ebp+0], ax
		mov	al, 1
		jmp	short loc_10005EAF
; ---------------------------------------------------------------------------

loc_10005EAD:				; CODE XREF: sub_10005DE1+58j
					; sub_10005DE1+A9j
		xor	al, al

loc_10005EAF:				; CODE XREF: sub_10005DE1+CAj
		pop	esi

loc_10005EB0:				; CODE XREF: sub_10005DE1+25j
		pop	ebx

loc_10005EB1:				; CODE XREF: sub_10005DE1+10j
		pop	edi
		pop	ebp
		pop	ecx
		pop	ecx
		retn	8
sub_10005DE1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005EB8	proc near		; CODE XREF: sub_10005CF8+28p
					; sub_10005D35+2Cp

arg_0		= dword	ptr  4

		mov	eax, [ecx+4]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	edx, [eax+3Ch]
		add	edx, eax
		movzx	eax, word ptr [edx+6]
		cmp	esi, eax
		jnb	short loc_10005EDD
		movzx	ecx, word ptr [edx+14h]
		imul	eax, esi, 28h
		add	ecx, edx
		add	eax, 18h
		add	eax, ecx
		jmp	short loc_10005EDF
; ---------------------------------------------------------------------------

loc_10005EDD:				; CODE XREF: sub_10005EB8+13j
		xor	eax, eax

loc_10005EDF:				; CODE XREF: sub_10005EB8+23j
		pop	esi
		retn	4
sub_10005EB8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005EE3	proc near		; CODE XREF: sub_10005CF8+Ep
					; sub_1000A5EB+51p ...

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jnz	short loc_10005EEE
		xor	eax, eax
		jmp	short locret_10005EF5
; ---------------------------------------------------------------------------

loc_10005EEE:				; CODE XREF: sub_10005EE3+5j
		mov	eax, [ecx+4]
		add	eax, [esp+arg_0]

locret_10005EF5:			; CODE XREF: sub_10005EE3+9j
		retn	4
sub_10005EE3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005EF8	proc near		; CODE XREF: sub_10005DE1+79p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]

loc_10005F00:				; CODE XREF: sub_10005EF8+14j
		mov	dl, [eax]
		test	dl, dl
		jz	short loc_10005F0E
		cmp	dl, [ecx]
		jnz	short loc_10005F0E
		inc	eax
		inc	ecx
		jmp	short loc_10005F00
; ---------------------------------------------------------------------------

loc_10005F0E:				; CODE XREF: sub_10005EF8+Cj
					; sub_10005EF8+10j
		movzx	eax, byte ptr [eax]
		movzx	ecx, byte ptr [ecx]
		sub	eax, ecx
		retn
sub_10005EF8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005F17	proc near		; CODE XREF: sub_1000A5EB+23p
					; sub_100143EE+20p ...
		mov	ecx, [ecx+4]
		mov	eax, 5A4Dh
		cmp	[ecx], ax
		jz	short loc_10005F27

loc_10005F24:				; CODE XREF: sub_10005F17+1Bj
					; sub_10005F17+26j
		xor	al, al
		retn
; ---------------------------------------------------------------------------

loc_10005F27:				; CODE XREF: sub_10005F17+Bj
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		cmp	dword ptr [eax], 4550h
		jnz	short loc_10005F24
		mov	ecx, 0E0h
		cmp	[eax+14h], cx
		jnz	short loc_10005F24
		add	ecx, 2Bh
		cmp	[eax+18h], cx
		setz	al
		retn
sub_10005F17	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005F4A	proc near		; CODE XREF: sub_10002F2F+45p
					; sub_1000667D+62p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10005F71
		cmp	eax, 3FFFFFFFh
		ja	short loc_10005F6B
		shl	eax, 2
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10005F71

loc_10005F6B:				; CODE XREF: sub_10005F4A+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_10005F71:				; CODE XREF: sub_10005F4A+8j
					; sub_10005F4A+1Fj
		mov	eax, ecx
		retn
sub_10005F4A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005F74	proc near		; CODE XREF: sub_10005FEF+11p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1000649A
		push	[ebp+arg_8]
		mov	esi, eax
		lea	ecx, [esi+8]
		push	ecx
		lea	ecx, [ebp+arg_4+3]
		call	sub_10006108
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	0Ch
sub_10005F74	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005F9B	proc near		; CODE XREF: sub_1000667D+174p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		cmp	[ebp+arg_0], edx
		jz	short loc_10005FB8

loc_10005FA9:				; CODE XREF: sub_10005F9B+1Bj
		sub	edx, 4
		sub	ecx, 4
		mov	eax, [edx]
		mov	[ecx], eax
		cmp	edx, [ebp+arg_0]
		jnz	short loc_10005FA9

loc_10005FB8:				; CODE XREF: sub_10005F9B+Cj
		mov	eax, ecx
		pop	ebp
		retn
sub_10005F9B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005FBC	proc near		; CODE XREF: sub_1000667D+142p
					; sub_1000667D+187p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		sub	eax, ecx
		add	eax, 3
		push	esi
		xor	esi, esi
		shr	eax, 2
		cmp	[esp+4+arg_4], ecx
		sbb	edx, edx
		not	edx
		and	edx, eax
		jz	short loc_10005FED
		push	edi
		mov	edi, [esp+8+arg_8]

loc_10005FE0:				; CODE XREF: sub_10005FBC+2Ej
		mov	eax, [edi]
		inc	esi
		mov	[ecx], eax
		lea	ecx, [ecx+4]
		cmp	esi, edx
		jnz	short loc_10005FE0
		pop	edi

loc_10005FED:				; CODE XREF: sub_10005FBC+1Dj
		pop	esi
		retn
sub_10005FBC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005FEF	proc near		; CODE XREF: sub_10006129+Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		push	[esp+0Ch+arg_4]
		push	dword ptr [esi+4]
		push	esi
		call	sub_10005F74
		push	1
		mov	ecx, ebx
		mov	edi, eax
		call	sub_100065CC
		mov	[esi+4], edi
		mov	ecx, [edi+4]
		mov	[ecx], edi
		pop	edi
		pop	esi
		pop	ebx
		retn	8
sub_10005FEF	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000601E(int, int, void *)
sub_1000601E	proc near		; CODE XREF: sub_10006129+1Fp
					; sub_10006823+20p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_4]
		mov	ebx, ecx
		push	edi
		call	sub_1000659D
		mov	ebp, eax
		mov	ecx, ebx
		push	ebp
		lea	eax, [esp+14h+arg_4]
		push	eax
		call	sub_10006512
		mov	ecx, [ebx+8]
		mov	esi, [eax]
		mov	ecx, [ecx+ebp*8]
		cmp	esi, ecx
		jz	short loc_10006057
		mov	eax, [edi]

loc_1000604B:				; CODE XREF: sub_1000601E+37j
		mov	esi, [esi+4]
		cmp	[esi+8], eax
		jz	short loc_1000608C
		cmp	esi, ecx
		jnz	short loc_1000604B

loc_10006057:				; CODE XREF: sub_1000601E+29j
		mov	edi, [esp+10h+arg_8]
		cmp	esi, [edi]
		jz	short loc_1000606A
		push	dword ptr [edi]
		mov	ecx, ebx
		push	edi
		push	esi
		call	sub_10006880

loc_1000606A:				; CODE XREF: sub_1000601E+3Fj
		push	ebp
		push	esi
		push	edi
		mov	ecx, ebx
		call	sub_1000662F
		mov	ecx, ebx
		call	sub_100064C9
		mov	eax, [esp+10h+arg_0]
		mov	[eax], edi
		mov	byte ptr [eax+4], 1

loc_10006085:				; CODE XREF: sub_1000601E+88j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_1000608C:				; CODE XREF: sub_1000601E+33j
		push	[esp+10h+arg_8]	; void *
		lea	eax, [esp+14h+arg_4]
		mov	ecx, ebx
		push	eax		; int
		call	sub_10019CD3
		mov	eax, [esp+10h+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0
		jmp	short loc_10006085
sub_1000601E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100060A8	proc near		; CODE XREF: sub_1000667D+93p
					; sub_1000667D+AEp ...

var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	[ebp+arg_8]
		lea	eax, [ebp+var_1]
		push	0
		push	eax
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100060CC
		add	esp, 18h
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_100060A8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100060CC	proc near		; CODE XREF: sub_100060A8+16p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		sub	eax, edx
		mov	ecx, [ebp+arg_8]
		add	eax, 3
		push	esi
		push	edi
		xor	edi, edi
		shr	eax, 2
		cmp	[ebp+arg_4], edx
		sbb	esi, esi
		not	esi
		and	esi, eax
		jz	short loc_10006102
		sub	edx, ecx

loc_100060F1:				; CODE XREF: sub_100060CC+34j
		test	ecx, ecx
		jz	short loc_100060FA
		mov	eax, [edx+ecx]
		mov	[ecx], eax

loc_100060FA:				; CODE XREF: sub_100060CC+27j
		add	ecx, 4
		inc	edi
		cmp	edi, esi
		jnz	short loc_100060F1

loc_10006102:				; CODE XREF: sub_100060CC+21j
		pop	edi
		mov	eax, ecx
		pop	esi
		pop	ebp
		retn
sub_100060CC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006108	proc near		; CODE XREF: sub_10005F74+1Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	edi
		mov	edi, [esp+4+arg_0]
		test	edi, edi
		jz	short loc_10006125
		push	esi
		mov	esi, [esp+8+arg_4]
		mov	eax, [esi]
		add	esi, 4
		mov	[edi], eax
		add	edi, 4
		movsd
		movsd
		movsd
		movsd
		pop	esi

loc_10006125:				; CODE XREF: sub_10006108+7j
		pop	edi
		retn	8
sub_10006108	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006129	proc near		; CODE XREF: sub_100062C9+71p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	[esp+4+arg_4]
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax]
		call	sub_10005FEF
		mov	eax, [esi]
		mov	ecx, esi
		mov	eax, [eax]
		push	eax		; void *
		add	eax, 8
		push	eax		; int
		push	[esp+0Ch+arg_0]	; int
		call	sub_1000601E
		mov	eax, [esp+4+arg_0]
		pop	esi
		retn	8
sub_10006129	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006155	proc near		; CODE XREF: sub_1000623D+15p
		push	esi
		push	edi
		xor	edi, edi
		mov	esi, ecx
		push	edi
		push	edi
		mov	[esi], edi
		mov	[esi+4], edi
		call	sub_1000649A
		fld1
		mov	ecx, esi
		mov	[esi], eax
		push	8
		fstp	dword ptr [esi+1Ch]
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		mov	[esi+10h], edi
		call	sub_100065F4
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_10006155	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10006187	proc near		; CODE XREF: sub_1000659D+Dp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_0]
		and	[ebp+var_4], 0
		push	4
		mov	eax, [eax]
		mov	[ebp+arg_0], eax
		lea	eax, [ebp+arg_0]
		push	eax
		call	sub_100033FF
		pop	ecx
		pop	ecx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10006187	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100061AA(HANDLE hObject)
sub_100061AA	proc near		; CODE XREF: sub_10004DA3+23p

hObject		= dword	ptr  4

		cmp	byte_10033018, 0
		jz	sub_100061EE
		push	esi
		mov	ecx, offset dword_10033BB0
		call	sub_10006291
		mov	esi, eax
		mov	ecx, esi	; lpCriticalSection
		call	sub_10004D93
		mov	byte_10033BF0, 1
		push	[esp+4+hObject]	; hObject
		call	sub_100061EE
		pop	ecx
		mov	byte_10033BF0, 0
		mov	ecx, esi	; lpCriticalSection
		call	sub_10004D9B
		mov	al, 1
		pop	esi
		retn
sub_100061AA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100061EE(HANDLE hObject)
sub_100061EE	proc near		; CODE XREF: sub_100061AA+7j
					; sub_100061AA+2Cp

var_B4		= byte ptr -0B4h
var_4		= dword	ptr -4
hObject		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0B4h
		push	[ebp+hObject]	; hObject
		and	[ebp+var_4], 0
		call	ds:CloseHandle
		test	eax, eax
		jnz	short loc_10006237
		push	3
		push	32h
		push	offset aCBuildsMoz2_sl ; "c:/builds/moz2_slave/tb-rel-c-esr38-w32"...
		lea	ecx, [ebp+var_B4]
		call	sub_10001EE3
		add	eax, 8
		push	offset aCheckFailedFal ; "Check	failed:	false. "
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		lea	ecx, [ebp+var_B4]
		call	sub_10002021

loc_10006237:				; CODE XREF: sub_100061EE+18j
		mov	al, 1
		mov	esp, ebp
		pop	ebp
		retn
sub_100061EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000623D	proc near		; CODE XREF: sub_10006260+1Bp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		test	esi, esi
		jz	short loc_10006259
		lea	eax, [ebp+arg_0+3]
		mov	ecx, esi
		push	eax
		lea	eax, [ebp+arg_0+3]
		push	eax
		call	sub_10006155
		jmp	short loc_1000625B
; ---------------------------------------------------------------------------

loc_10006259:				; CODE XREF: sub_1000623D+9j
		xor	esi, esi

loc_1000625B:				; CODE XREF: sub_1000623D+1Aj
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
sub_1000623D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006260	proc near		; CODE XREF: sub_100062C9+6Ap
					; sub_10006399+37p ...
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		test	eax, 0FFFFFFFEh
		jnz	short loc_1000628D
		push	esi
		call	sub_10003424
		pop	ecx
		test	al, al
		jz	short loc_1000628D
		lea	eax, [esi+4]
		push	eax
		call	sub_1000623D
		push	0
		push	esi
		push	eax
		push	esi
		call	sub_10003404
		add	esp, 14h

loc_1000628D:				; CODE XREF: sub_10006260+Aj
					; sub_10006260+15j
		mov	eax, [esi]
		pop	esi
		retn
sub_10006260	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006291	proc near		; CODE XREF: sub_100061AA+13p
					; sub_100062C9+29p ...
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		test	eax, 0FFFFFFFEh
		jnz	short loc_100062C5
		push	esi
		call	sub_10003424
		pop	ecx
		test	al, al
		jz	short loc_100062C5
		lea	ecx, [esi+4]	; lpCriticalSection
		test	ecx, ecx
		jz	short loc_100062B6
		call	sub_10004D78
		jmp	short loc_100062B8
; ---------------------------------------------------------------------------

loc_100062B6:				; CODE XREF: sub_10006291+1Cj
		xor	eax, eax

loc_100062B8:				; CODE XREF: sub_10006291+23j
		push	0
		push	esi
		push	eax
		push	esi
		call	sub_10003404
		add	esp, 10h

loc_100062C5:				; CODE XREF: sub_10006291+Aj
					; sub_10006291+15j
		mov	eax, [esi]
		pop	esi
		retn
sub_10006291	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100062C9	proc near		; CODE XREF: sub_10004DE8+2Ap

var_D8		= byte ptr -0D8h
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpCriticalSection= dword ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 0D8h
		and	[ebp+lpCriticalSection], 0
		cmp	byte_10033018, 0
		jz	loc_10006395
		push	esi
		push	edi
		call	ds:GetCurrentThreadId
		mov	ecx, offset dword_10033BB0
		mov	esi, eax
		call	sub_10006291
		mov	ecx, eax	; lpCriticalSection
		mov	[ebp+lpCriticalSection], eax
		call	sub_10004D93
		mov	ecx, [ebp+arg_4]
		lea	edi, [ebp+var_24]
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], ecx
		mov	ecx, [ebp+arg_8]
		mov	[ebp+var_8], esi
		lea	esi, [ebp+var_14]
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_28]
		mov	[ebp+var_10], ecx
		mov	ecx, offset dword_10033BCC
		movsd
		push	eax
		lea	eax, [ebp+var_C]
		push	eax
		movsd
		movsd
		movsd
		call	sub_10006260
		mov	ecx, eax
		call	sub_10006129
		cmp	byte ptr [ebp+var_8], 0
		jnz	short loc_1000638B
		mov	esi, [ebp+var_C]
		lea	edi, [ebp+var_14]
		lea	eax, [ebp+var_14]
		push	eax
		lea	esi, [esi+0Ch]
		movsd
		movsd
		movsd
		movsd
		call	sub_10003380
		pop	ecx
		push	3
		push	6Ah
		push	offset aCBuildsMoz2_sl ; "c:/builds/moz2_slave/tb-rel-c-esr38-w32"...
		lea	ecx, [ebp+var_D8]
		call	sub_10001EE3
		add	eax, 8
		push	offset aCheckFailedFal ; "Check	failed:	false. "
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		lea	ecx, [ebp+var_D8]
		call	sub_10002021

loc_1000638B:				; CODE XREF: sub_100062C9+7Aj
		mov	ecx, [ebp+lpCriticalSection] ; lpCriticalSection
		call	sub_10004D9B
		pop	edi
		pop	esi

loc_10006395:				; CODE XREF: sub_100062C9+14j
		mov	esp, ebp
		pop	ebp
		retn
sub_100062C9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006399	proc near		; CODE XREF: sub_10004DA3+1Cp
					; sub_10006ADC+20p

var_C8		= dword	ptr -0C8h
lpCriticalSection= dword ptr -0C4h
var_C0		= dword	ptr -0C0h
var_B0		= byte ptr -0B0h
arg_0		= byte ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0C8h
		and	[esp+0C8h+lpCriticalSection], 0
		cmp	byte_10033018, 0
		jz	loc_10006493
		push	ebx
		push	ebp
		push	esi
		mov	ecx, offset dword_10033BB0
		call	sub_10006291
		mov	ecx, eax	; lpCriticalSection
		mov	[esp+0D4h+lpCriticalSection], eax
		call	sub_10004D93
		mov	ebx, offset dword_10033BCC
		mov	ecx, ebx
		call	sub_10006260
		lea	ecx, [esp+0D4h+arg_0]
		push	ecx
		lea	ecx, [esp+0D8h+var_C8]
		push	ecx
		mov	ecx, eax
		call	sub_10006935
		mov	ecx, ebx
		call	sub_10006260
		mov	esi, [esp+0D4h+var_C8]
		mov	ebx, offset aCBuildsMoz2_sl ; "c:/builds/moz2_slave/tb-rel-c-esr38-w32"...
		mov	ebp, offset aCheckFailedFal ; "Check failed: false. "
		cmp	esi, [eax]
		jnz	short loc_10006425
		push	3
		push	77h
		push	ebx
		lea	ecx, [esp+0E0h+var_B0]
		call	sub_10001EE3
		add	eax, 8
		push	ebp
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		lea	ecx, [esp+0D4h+var_B0]
		call	sub_10002021

loc_10006425:				; CODE XREF: sub_10006399+67j
		add	esi, 0Ch
		push	edi
		lea	edi, [esp+0D8h+var_C0]
		movsd
		movsd
		movsd
		movsd
		mov	eax, [esp+0D8h+var_C0]
		pop	edi
		cmp	eax, [esp+0D4h+arg_4]
		jz	short loc_1000646D
		lea	eax, [esp+0D4h+var_C0]
		push	eax
		call	sub_10003380
		pop	ecx
		push	3
		push	7Ch
		push	ebx
		lea	ecx, [esp+0E0h+var_B0]
		call	sub_10001EE3
		add	eax, 8
		push	ebp
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		lea	ecx, [esp+0D4h+var_B0]
		call	sub_10002021

loc_1000646D:				; CODE XREF: sub_10006399+A4j
		push	[esp+0D4h+var_C8] ; void *
		lea	eax, [esp+0D8h+var_C8]
		mov	ecx, offset dword_10033BCC
		push	eax		; int
		call	sub_10006260
		mov	ecx, eax
		call	sub_100068C9
		mov	ecx, [esp+0D4h+lpCriticalSection] ; lpCriticalSection
		call	sub_10004D9B
		pop	esi
		pop	ebp
		pop	ebx

loc_10006493:				; CODE XREF: sub_10006399+12j
		add	esp, 0C8h
		retn
sub_10006399	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000649A	proc near		; CODE XREF: sub_10005F74+Ap
					; sub_10006155+Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0
		push	1
		call	sub_10008782
		pop	ecx
		pop	ecx
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_100064B3
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_100064B7
; ---------------------------------------------------------------------------

loc_100064B3:				; CODE XREF: sub_1000649A+11j
		mov	edx, [esp+arg_4]

loc_100064B7:				; CODE XREF: sub_1000649A+17j
		test	eax, eax
		jz	short loc_100064BD
		mov	[eax], ecx

loc_100064BD:				; CODE XREF: sub_1000649A+1Fj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_100064C6
		mov	[ecx], edx

locret_100064C6:			; CODE XREF: sub_1000649A+28j
		retn	8
sub_1000649A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100064C9	proc near		; CODE XREF: sub_1000601E+58p

var_8		= qword	ptr -8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, ecx
		fld	dword ptr [esi+1Ch]
		fstp	[ebp+var_8]
		call	sub_100068FB
		fcomp	[ebp+var_8]
		fnstsw	ax
		test	ah, 41h
		jnz	short loc_1000650D
		mov	eax, [esi+18h]
		cmp	eax, 200h
		jnb	short loc_100064F5
		shl	eax, 3
		jmp	short loc_100064FE
; ---------------------------------------------------------------------------

loc_100064F5:				; CODE XREF: sub_100064C9+25j
		cmp	eax, 1FFFFFFFh
		jnb	short loc_100064FE
		add	eax, eax

loc_100064FE:				; CODE XREF: sub_100064C9+2Aj
					; sub_100064C9+31j
		push	eax
		mov	ecx, esi
		call	sub_100065F4
		mov	ecx, esi
		call	sub_10006823

loc_1000650D:				; CODE XREF: sub_100064C9+1Bj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100064C9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006512	proc near		; CODE XREF: sub_1000601E+1Ap
					; sub_10006935+20p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [ecx+8]
		mov	edx, [esp+arg_4]
		mov	ecx, [ecx]
		cmp	[eax+edx*8], ecx
		jz	short loc_10006526
		mov	eax, [eax+edx*8+4]
		mov	ecx, [eax]

loc_10006526:				; CODE XREF: sub_10006512+Cj
		mov	eax, [esp+arg_0]
		mov	[eax], ecx
		retn	8
sub_10006512	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000652F	proc near		; CODE XREF: sub_100068C9+18p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		mov	eax, [esp+arg_0]
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, [edi+8]
		cmp	[esi+edx*8+4], eax
		jnz	short loc_10006562
		cmp	[esi+edx*8], eax
		jnz	short loc_10006559
		mov	eax, [edi]
		mov	[esi+edx*8], eax
		mov	ecx, [edi+8]
		mov	eax, [edi]
		mov	[ecx+edx*8+4], eax
		jmp	short loc_1000656C
; ---------------------------------------------------------------------------

loc_10006559:				; CODE XREF: sub_1000652F+18j
		mov	eax, [eax+4]
		mov	[esi+edx*8+4], eax
		jmp	short loc_1000656C
; ---------------------------------------------------------------------------

loc_10006562:				; CODE XREF: sub_1000652F+13j
		cmp	[esi+edx*8], eax
		jnz	short loc_1000656C
		mov	eax, [eax]
		mov	[esi+edx*8], eax

loc_1000656C:				; CODE XREF: sub_1000652F+28j
					; sub_1000652F+31j ...
		pop	edi
		pop	esi
		retn	8
sub_1000652F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006571	proc near		; CODE XREF: sub_1000667D+56p

arg_0		= dword	ptr  4

		mov	edx, [ecx+8]
		mov	eax, 3FFFFFFFh
		sub	edx, [ecx]
		sar	edx, 2
		mov	ecx, edx
		shr	ecx, 1
		sub	eax, ecx
		cmp	eax, edx
		jnb	short loc_1000658C
		xor	edx, edx
		jmp	short loc_1000658E
; ---------------------------------------------------------------------------

loc_1000658C:				; CODE XREF: sub_10006571+15j
		add	edx, ecx

loc_1000658E:				; CODE XREF: sub_10006571+19j
		cmp	edx, [esp+arg_0]
		jnb	short loc_10006598
		mov	edx, [esp+arg_0]

loc_10006598:				; CODE XREF: sub_10006571+21j
		mov	eax, edx
		retn	4
sub_10006571	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000659D	proc near		; CODE XREF: sub_1000601E+Bp
					; sub_100068C9+Dp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	[ebp+arg_0]
		mov	esi, ecx
		lea	ecx, [ebp+arg_0+3]
		call	sub_10006187
		mov	edi, [esi+14h]
		mov	edx, edi
		and	edx, eax
		cmp	[esi+18h], edx
		ja	short loc_100065C4
		shr	edi, 1
		or	ecx, 0FFFFFFFFh
		sub	ecx, edi
		add	edx, ecx

loc_100065C4:				; CODE XREF: sub_1000659D+1Cj
		pop	edi
		mov	eax, edx
		pop	esi
		pop	ebp
		retn	4
sub_1000659D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100065CC	proc near		; CODE XREF: sub_10005FEF+1Cp

arg_0		= dword	ptr  4

		mov	edx, [ecx+4]
		mov	eax, 9249248h
		push	esi
		mov	esi, [esp+4+arg_0]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_100065EA
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100065EA:				; CODE XREF: sub_100065CC+11j
		lea	eax, [edx+esi]
		mov	[ecx+4], eax
		pop	esi
		retn	4
sub_100065CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100065F4	proc near		; CODE XREF: sub_10006155+26p
					; sub_100064C9+38p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	edx, [ebp+var_4]
		push	edi
		mov	edi, ecx
		push	edx
		lea	edx, [esi+esi]
		push	edx
		mov	eax, [edi]
		lea	ecx, [edi+8]
		mov	[ebp+var_4], eax
		mov	eax, [ecx]
		push	eax
		mov	[ecx+4], eax
		lea	eax, [ebp+arg_0]
		push	eax
		call	sub_1000667D
		lea	eax, [esi-1]
		mov	[edi+18h], esi
		mov	[edi+14h], eax
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100065F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000662F	proc near		; CODE XREF: sub_1000601E+51p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_8]
		push	esi
		mov	esi, [ecx+8]
		mov	eax, [esi+edx*8]
		cmp	eax, [ecx]
		jnz	short loc_1000664E
		mov	eax, [ebp+arg_0]
		mov	[esi+edx*8], eax
		mov	ecx, [ecx+8]
		mov	eax, [ebp+arg_0]
		jmp	short loc_10006674
; ---------------------------------------------------------------------------

loc_1000664E:				; CODE XREF: sub_1000662F+Fj
		cmp	eax, [ebp+arg_4]
		jnz	short loc_1000665B
		mov	eax, [ebp+arg_0]
		mov	[esi+edx*8], eax
		jmp	short loc_10006678
; ---------------------------------------------------------------------------

loc_1000665B:				; CODE XREF: sub_1000662F+22j
		mov	eax, [esi+edx*8+4]
		mov	eax, [eax]
		mov	[esi+edx*8+4], eax
		cmp	eax, [ebp+arg_0]
		jz	short loc_10006678
		mov	ecx, [ecx+8]
		mov	eax, [ecx+edx*8+4]
		mov	eax, [eax+4]

loc_10006674:				; CODE XREF: sub_1000662F+1Dj
		mov	[ecx+edx*8+4], eax

loc_10006678:				; CODE XREF: sub_1000662F+2Aj
					; sub_1000662F+39j
		pop	esi
		pop	ebp
		retn	0Ch
sub_1000662F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000667D	proc near		; CODE XREF: sub_100065F4+25p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		mov	eax, [esp+4+arg_4]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebx, ecx
		mov	edi, eax
		sub	edi, [ebx]
		sar	edi, 2
		mov	[esp+14h+var_4], edi
		mov	edi, [esp+14h+arg_8]
		test	edi, edi
		jz	loc_1000680C
		mov	ecx, [ebx+8]
		mov	ebp, [ebx+4]
		sub	ecx, ebp
		sar	ecx, 2
		cmp	ecx, edi
		jnb	loc_1000676A
		sub	ebp, [ebx]
		mov	eax, 3FFFFFFFh
		sar	ebp, 2
		sub	eax, ebp
		cmp	eax, edi
		jnb	short loc_100066CD
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100066CD:				; CODE XREF: sub_1000667D+43j
		lea	eax, [edi+ebp]
		mov	ecx, ebx
		push	eax
		call	sub_10006571
		push	0
		push	eax
		mov	[esp+1Ch+arg_8], eax
		call	sub_10005F4A
		mov	esi, [esp+1Ch+arg_4]
		mov	ebp, eax
		sub	esi, [ebx]
		pop	ecx
		pop	ecx
		push	[esp+14h+arg_C]
		sar	esi, 2
		push	edi
		lea	ecx, ds:0[esi*4]
		add	ecx, ebp
		push	ecx
		mov	ecx, ebx
		call	sub_10006852
		push	ebp
		push	[esp+18h+arg_4]
		mov	ecx, ebx
		push	dword ptr [ebx]
		call	sub_100060A8
		lea	eax, [esi+edi]
		mov	ecx, ebx
		lea	eax, ds:0[eax*4]
		add	eax, ebp
		push	eax
		push	dword ptr [ebx+4]
		push	[esp+1Ch+arg_4]
		call	sub_100060A8
		mov	eax, [ebx+4]
		sub	eax, [ebx]
		sar	eax, 2
		add	edi, eax
		cmp	dword ptr [ebx], 0
		jz	short loc_10006747
		push	dword ptr [ebx]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10006747:				; CODE XREF: sub_1000667D+C0j
		mov	eax, [esp+14h+arg_8]
		mov	[ebx], ebp
		lea	eax, ds:0[eax*4]
		add	eax, ebp
		mov	[ebx+8], eax
		lea	eax, ds:0[edi*4]
		add	eax, ebp
		mov	[ebx+4], eax
		jmp	loc_1000680C
; ---------------------------------------------------------------------------

loc_1000676A:				; CODE XREF: sub_1000667D+2Fj
		mov	ecx, ebp
		sub	ecx, eax
		sar	ecx, 2
		cmp	ecx, edi
		jnb	short loc_100067C9
		mov	ecx, [esp+14h+arg_C]
		mov	esi, edi
		shl	esi, 2
		mov	ecx, [ecx]
		mov	[esp+14h+arg_C], ecx
		lea	ecx, [esi+eax]
		push	ecx
		push	ebp
		push	eax
		mov	ecx, ebx
		call	sub_100060A8
		lea	eax, [esp+14h+arg_C]
		mov	ecx, ebx
		push	eax
		mov	eax, [ebx+4]
		sub	eax, [esp+18h+arg_4]
		sar	eax, 2
		sub	edi, eax
		push	edi
		push	dword ptr [ebx+4]
		call	sub_10006852
		add	[ebx+4], esi
		lea	ecx, [esp+14h+arg_C]
		mov	eax, [ebx+4]
		push	ecx
		sub	eax, esi
		push	eax
		push	[esp+1Ch+arg_4]
		call	sub_10005FBC
		add	esp, 0Ch
		jmp	short loc_1000680C
; ---------------------------------------------------------------------------

loc_100067C9:				; CODE XREF: sub_1000667D+F6j
		mov	eax, [esp+14h+arg_C]
		mov	esi, ebp
		push	ebp
		shl	edi, 2
		mov	ecx, ebx
		push	ebp
		mov	eax, [eax]
		sub	esi, edi
		push	esi
		mov	[esp+20h+arg_C], eax
		call	sub_100060A8
		push	[esp+14h+arg_4]
		mov	[ebx+4], eax
		push	ebp
		push	esi
		push	[esp+20h+arg_4]
		call	sub_10005F9B
		lea	eax, [esp+24h+arg_C]
		push	eax
		mov	eax, [esp+28h+arg_4]
		lea	ecx, [edi+eax]
		push	ecx
		push	eax
		call	sub_10005FBC
		add	esp, 1Ch

loc_1000680C:				; CODE XREF: sub_1000667D+1Cj
					; sub_1000667D+E8j ...
		mov	eax, [ebx]
		mov	ecx, [esp+14h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		lea	ecx, [eax+ecx*4]
		mov	eax, [esp+8+arg_0]
		pop	ebx
		mov	[eax], ecx
		pop	ecx
		retn	10h
sub_1000667D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006823	proc near		; CODE XREF: sub_100064C9+3Fp

var_8		= dword	ptr -8

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	eax, [ebx]
		cmp	[eax], eax
		jz	short loc_1000684E
		push	esi
		push	edi
		mov	edi, [eax+4]

loc_10006833:				; CODE XREF: sub_10006823+27j
		mov	esi, [ebx]
		mov	ecx, ebx
		mov	esi, [esi]
		push	esi		; void *
		lea	eax, [esi+8]
		push	eax		; int
		lea	eax, [esp+1Ch+var_8]
		push	eax		; int
		call	sub_1000601E
		cmp	esi, edi
		jnz	short loc_10006833
		pop	edi
		pop	esi

loc_1000684E:				; CODE XREF: sub_10006823+9j
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_10006823	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006852	proc near		; CODE XREF: sub_1000667D+85p
					; sub_1000667D+12Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_4]
		push	esi
		mov	esi, edx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, edi
		test	edx, edx
		jz	short loc_10006878
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]

loc_10006869:				; CODE XREF: sub_10006852+23j
		test	ecx, ecx
		jz	short loc_10006871
		mov	eax, [ebx]
		mov	[ecx], eax

loc_10006871:				; CODE XREF: sub_10006852+19j
		add	ecx, 4
		dec	esi
		jnz	short loc_10006869
		pop	ebx

loc_10006878:				; CODE XREF: sub_10006852+10j
		lea	eax, [edi+edx*4]
		pop	edi
		pop	esi
		retn	0Ch
sub_10006852	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10006880	proc near		; CODE XREF: sub_1000601E+47p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	[ecx], eax
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	[ecx], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[ecx], eax
		mov	ecx, [ebp+arg_0]
		mov	eax, [ebp+arg_8]
		mov	edx, [ecx+4]
		mov	eax, [eax+4]
		mov	[ecx+4], eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	[eax+4], ecx
		mov	eax, [ebp+arg_4]
		mov	[eax+4], edx
		pop	ebp
		retn	0Ch
sub_10006880	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100068C9(int, void *)
sub_100068C9	proc near		; CODE XREF: sub_10006399+E9p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		push	esi
		add	eax, 8
		mov	esi, ecx
		push	eax
		call	sub_1000659D
		push	eax
		push	[ebp+arg_4]
		mov	ecx, esi
		call	sub_1000652F
		push	[ebp+arg_4]	; void *
		mov	ecx, esi
		push	[ebp+arg_0]	; int
		call	sub_10019CD3
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	ebp
		retn	8
sub_100068C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100068FB	proc near		; CODE XREF: sub_100064C9+Ep

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ecx+4]
		fild	dword ptr [ecx+4]
		test	eax, eax
		jns	short loc_1000690F
		fadd	ds:flt_1001CEA4

loc_1000690F:				; CODE XREF: sub_100068FB+Cj
		fstp	[ebp+var_4]
		fld	[ebp+var_4]
		mov	eax, [ecx+18h]
		fild	dword ptr [ecx+18h]
		test	eax, eax
		jns	short loc_10006925
		fadd	ds:flt_1001CEA4

loc_10006925:				; CODE XREF: sub_100068FB+22j
		fstp	[ebp+var_4]
		fdiv	[ebp+var_4]
		fstp	[ebp+var_4]
		fld	[ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_100068FB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006935	proc near		; CODE XREF: sub_10006399+4Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		push	esi
		push	edi
		push	ebx
		mov	edi, ecx
		call	sub_1000659D
		mov	esi, [edi+8]
		mov	ebp, eax
		push	ebp
		lea	eax, [esp+14h+arg_4]
		mov	ecx, edi
		push	eax
		mov	esi, [esi+ebp*8]
		call	sub_10006512
		cmp	esi, [eax]
		jz	short loc_10006978
		mov	ebx, [ebx]

loc_10006960:				; CODE XREF: sub_10006935+41j
		cmp	ebx, [esi+8]
		jz	short loc_10006987
		mov	esi, [esi]
		lea	eax, [esp+10h+arg_4]
		push	ebp
		push	eax
		mov	ecx, edi
		call	sub_10006512
		cmp	esi, [eax]
		jnz	short loc_10006960

loc_10006978:				; CODE XREF: sub_10006935+27j
		mov	ecx, [edi]

loc_1000697A:				; CODE XREF: sub_10006935+5Cj
		mov	eax, [esp+10h+arg_0]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ecx
		pop	ebx
		retn	8
; ---------------------------------------------------------------------------

loc_10006987:				; CODE XREF: sub_10006935+2Ej
		lea	ecx, [esp+10h+arg_4]
		mov	[esp+10h+arg_4], esi
		mov	ecx, [ecx]
		jmp	short loc_1000697A
sub_10006935	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006993	proc near		; CODE XREF: sub_1000774A+178p
					; sub_10019558+D5p

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, ecx
		xor	eax, eax
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	[esi+0Ch], eax
		call	sub_10006A9F
		mov	eax, esi
		pop	esi
		retn	4
sub_10006993	endp

; [00000010 BYTES: COLLAPSED FUNCTION unknown_libname_5]

; =============== S U B	R O U T	I N E =======================================


sub_100069C2	proc near		; CODE XREF: sub_1000774A+1B8p
					; sub_100095AD+4B7p ...
		push	esi
		mov	esi, ecx
		call	sub_10006A23
		lea	ecx, [esi+4]
		call	sub_10004DA3
		mov	ecx, esi
		pop	esi
		jmp	sub_10004DA3
sub_100069C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100069DA(HANDLE hSourceHandle, int)
sub_100069DA	proc near		; CODE XREF: sub_10006A3D+12p
					; sub_10006A3D+24p

TargetHandle	= dword	ptr -4
hSourceHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		xor	eax, eax
		mov	[ebp+TargetHandle], eax
		cmp	[ebp+hSourceHandle], eax
		jz	short loc_10006A1D
		push	2		; dwOptions
		push	eax		; bInheritHandle
		push	eax		; dwDesiredAccess
		mov	[ebp+TargetHandle], eax
		lea	eax, [ebp+TargetHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10006A12
		xor	al, al
		jmp	short loc_10006A1F
; ---------------------------------------------------------------------------

loc_10006A12:				; CODE XREF: sub_100069DA+32j
		push	[ebp+TargetHandle]
		mov	ecx, [ebp+arg_4]
		call	sub_10004DE8

loc_10006A1D:				; CODE XREF: sub_100069DA+Cj
		mov	al, 1

loc_10006A1F:				; CODE XREF: sub_100069DA+36j
		mov	esp, ebp
		pop	ebp
		retn
sub_100069DA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006A23	proc near		; CODE XREF: sub_100069C2+3p
					; sub_10006A9F+Fp
		push	esi
		mov	esi, ecx
		call	sub_10004DA3
		lea	ecx, [esi+4]
		call	sub_10004DA3
		and	dword ptr [esi+8], 0
		and	dword ptr [esi+0Ch], 0
		pop	esi
		retn
sub_10006A23	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10006A3D(int, int)
sub_10006A3D	proc near		; CODE XREF: sub_10019558+153p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		mov	esi, ecx
		push	esi		; int
		push	dword ptr [edi]	; hSourceHandle
		call	sub_100069DA
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_10006A7C
		lea	eax, [esi+4]
		push	eax		; int
		push	dword ptr [edi+4] ; hSourceHandle
		call	sub_100069DA
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_10006A7C
		mov	eax, [edi+8]
		mov	[esi+8], eax
		mov	eax, [edi+0Ch]
		mov	[esi+0Ch], eax
		mov	al, 1
		jmp	short loc_10006A7E
; ---------------------------------------------------------------------------

loc_10006A7C:				; CODE XREF: sub_10006A3D+1Bj
					; sub_10006A3D+2Dj
		xor	al, al

loc_10006A7E:				; CODE XREF: sub_10006A3D+3Dj
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10006A3D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006A86	proc near		; CODE XREF: sub_10006A9F+4p
					; sub_1001944D+Ep ...
		xor	eax, eax
		cmp	[ecx+8], eax
		jnz	short loc_10006A9B
		cmp	[ecx], eax
		jnz	short loc_10006A9B
		cmp	[ecx+0Ch], eax
		jnz	short loc_10006A9B
		cmp	[ecx+4], eax
		jz	short locret_10006A9E

loc_10006A9B:				; CODE XREF: sub_10006A86+5j
					; sub_10006A86+9j ...
		xor	eax, eax
		inc	eax

locret_10006A9E:			; CODE XREF: sub_10006A86+13j
		retn
sub_10006A86	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006A9F	proc near		; CODE XREF: sub_10006993+14p
					; sub_10019558+18Fp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		call	sub_10006A86
		test	al, al
		jz	short loc_10006AB3
		mov	ecx, edi
		call	sub_10006A23

loc_10006AB3:				; CODE XREF: sub_10006A9F+Bj
		mov	esi, [esp+8+arg_0]
		mov	ecx, edi
		push	dword ptr [esi]
		call	sub_10004DE8
		push	dword ptr [esi+4]
		lea	ecx, [edi+4]
		call	sub_10004DE8
		mov	eax, [esi+8]
		mov	[edi+8], eax
		mov	eax, [esi+0Ch]
		mov	[edi+0Ch], eax
		pop	edi
		pop	esi
		retn	4
sub_10006A9F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006ADC	proc near		; CODE XREF: sub_10006B09+11p
					; sub_10006B09+1Bp ...
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, [edi]
		and	dword ptr [edi], 0
		push	esi
		call	sub_10004DD3
		pop	ecx
		test	al, al
		jz	short loc_10006B04
		call	sub_1000344A
		push	eax
		push	dword ptr [esp+0Ch]
		push	edi
		push	esi
		call	sub_10006399
		add	esp, 10h

loc_10006B04:				; CODE XREF: sub_10006ADC+12j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_10006ADC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006B09	proc near		; CODE XREF: sub_100095AD+4A2p
					; sub_10019558+187p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		xor	eax, eax
		push	edi
		mov	edi, esi
		mov	ebx, ecx
		stosd
		stosd
		stosd
		stosd
		call	sub_10006ADC
		lea	ecx, [ebx+4]
		mov	[esi], eax
		call	sub_10006ADC
		mov	ecx, [ebx+8]
		and	dword ptr [ebx+8], 0
		mov	[esi+8], ecx
		mov	ecx, [ebx+0Ch]
		and	dword ptr [ebx+0Ch], 0
		mov	[esi+4], eax
		mov	eax, esi
		pop	edi
		mov	[esi+0Ch], ecx
		pop	esi
		pop	ebx
		retn	4
sub_10006B09	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006B48	proc near		; CODE XREF: sub_1001944D+56p
		and	dword ptr [ecx+8], 0
		jmp	sub_10006ADC
sub_10006B48	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006B51	proc near		; CODE XREF: sub_10019774+159p
		and	dword ptr [ecx+0Ch], 0
		add	ecx, 4
		jmp	sub_10006ADC
sub_10006B51	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10006B5D(void *)
sub_10006B5D	proc near		; CODE XREF: sub_100095AD+1ACp
		push	ebx
		push	esi
		push	48h
		pop	esi
		push	esi		; size_t
		mov	ebx, ecx
		push	0		; int
		push	ebx		; void *
		call	memset
		add	esp, 0Ch
		call	sub_10006EF6
		cmp	eax, 3
		jge	short loc_10006B82
		mov	dword ptr [ebx], 44h
		jmp	short loc_10006BDB
; ---------------------------------------------------------------------------

loc_10006B82:				; CODE XREF: sub_10006B5D+1Bj
		cmp	dword_10033BFC,	0
		mov	[ebx], esi
		jz	short loc_10006B9F
		cmp	dword_10033C00,	0
		jz	short loc_10006B9F
		cmp	dword_10033C04,	0
		jnz	short loc_10006BDB

loc_10006B9F:				; CODE XREF: sub_10006B5D+2Ej
					; sub_10006B5D+37j
		push	edi
		push	offset ModuleName ; "kernel32.dll"
		call	ds:GetModuleHandleW
		mov	esi, ds:GetProcAddress
		mov	edi, eax
		push	offset aInitializeproc ; "InitializeProcThreadAttributeList"
		push	edi		; hModule
		call	esi ; GetProcAddress
		push	offset aUpdateprocthre ; "UpdateProcThreadAttribute"
		push	edi		; hModule
		mov	dword_10033BFC,	eax
		call	esi ; GetProcAddress
		push	offset aDeleteprocthre ; "DeleteProcThreadAttributeList"
		push	edi		; hModule
		mov	dword_10033C00,	eax
		call	esi ; GetProcAddress
		mov	dword_10033C04,	eax
		pop	edi

loc_10006BDB:				; CODE XREF: sub_10006B5D+23j
					; sub_10006B5D+40j
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
sub_10006B5D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006BE0	proc near		; CODE XREF: sub_100095AD+4D0p
		push	esi
		mov	esi, ecx
		cmp	dword ptr [esi+44h], 0
		jz	short loc_10006BFB
		push	dword ptr [esi+44h]
		call	dword_10033C04
		push	dword ptr [esi+44h] ; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_10006BFB:				; CODE XREF: sub_10006BE0+7j
		pop	esi
		retn
sub_10006BE0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10006BFD	proc near		; CODE XREF: sub_100095AD+26Fp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, ecx
		push	edi
		cmp	dword ptr [esi], 48h
		jnz	short loc_10006C53
		xor	edi, edi
		cmp	[esi+44h], edi
		jnz	short loc_10006C53
		lea	eax, [ebp+var_4]
		mov	[ebp+var_4], edi
		push	eax
		push	edi
		push	[ebp+arg_0]
		push	edi
		call	dword_10033BFC
		cmp	[ebp+var_4], edi
		jz	short loc_10006C53
		push	[ebp+var_4]
		call	sub_1001AAE8
		pop	ecx
		lea	ecx, [ebp+var_4]
		mov	[esi+44h], eax
		push	ecx
		push	edi
		push	[ebp+arg_0]
		push	eax
		call	dword_10033BFC
		test	eax, eax
		jnz	short loc_10006C5D
		push	dword ptr [esi+44h] ; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		mov	[esi+44h], edi

loc_10006C53:				; CODE XREF: sub_10006BFD+Bj
					; sub_10006BFD+12j ...
		xor	al, al

loc_10006C55:				; CODE XREF: sub_10006BFD+62j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------

loc_10006C5D:				; CODE XREF: sub_10006BFD+48j
		mov	al, 1
		jmp	short loc_10006C55
sub_10006BFD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006C61	proc near		; CODE XREF: sub_10008707+1Dp
					; sub_100095AD+2B3p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword ptr [ecx+44h], 0
		jnz	short loc_10006C6B
		xor	al, al
		jmp	short locret_10006C8B
; ---------------------------------------------------------------------------

loc_10006C6B:				; CODE XREF: sub_10006C61+4j
		xor	eax, eax
		push	eax
		push	eax
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		push	eax
		push	dword ptr [ecx+44h]
		call	dword_10033C00
		neg	eax
		sbb	eax, eax
		neg	eax

locret_10006C8B:			; CODE XREF: sub_10006C61+8j
		retn	0Ch
sub_10006C61	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006C8E	proc near		; CODE XREF: sub_10006EA9+18p

var_15C		= dword	ptr -15Ch
var_148		= dword	ptr -148h
SystemInfo	= _SYSTEM_INFO ptr -144h
VersionInformation= _OSVERSIONINFOW ptr	-120h
var_C		= word ptr -0Ch
var_A		= word ptr -0Ah
var_8		= word ptr -8
var_6		= byte ptr -6
var_4		= dword	ptr -4

		sub	esp, 148h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+148h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, ecx
		xor	ebx, ebx
		push	3
		mov	[esp+15Ch+var_148], ebx
		pop	edi
		mov	[esi], ebx
		mov	[esi+1Ch], edi
		call	ds:GetCurrentProcess
		push	eax
		call	sub_10006EFE
		mov	[esi+28h], eax
		lea	eax, [esp+15Ch+VersionInformation.dwMajorVersion]
		mov	[esp+15Ch+var_15C], 118h ; size_t
		push	ebx		; int
		mov	dword ptr [esi+40h], 0Fh
		mov	[esi+3Ch], ebx
		mov	[esi+2Ch], bl
		push	eax		; void *
		mov	[esp+164h+VersionInformation.dwOSVersionInfoSize], 11Ch
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+158h+VersionInformation]
		push	eax		; lpVersionInformation
		call	ds:GetVersionExW
		mov	eax, [esp+158h+VersionInformation.dwBuildNumber]
		inc	ebx
		mov	edx, [esp+158h+VersionInformation.dwMajorVersion]
		mov	ecx, [esp+158h+VersionInformation.dwMinorVersion]
		push	6
		pop	ebp
		push	5
		mov	[esi+0Ch], eax
		pop	eax
		mov	[esi+4], edx
		mov	[esi+8], ecx
		cmp	edx, eax
		jnz	short loc_10006D2A
		test	ecx, ecx
		jle	short loc_10006D51
		xor	eax, eax
		cmp	ecx, ebx
		setnz	al
		inc	eax

loc_10006D26:				; CODE XREF: sub_10006C8E+A9j
		mov	[esi], eax
		jmp	short loc_10006D51
; ---------------------------------------------------------------------------

loc_10006D2A:				; CODE XREF: sub_10006C8E+8Aj
		cmp	edx, ebp
		jnz	short loc_10006D49
		sub	ecx, 0
		jz	short loc_10006D45
		dec	ecx
		jz	short loc_10006D3D
		dec	ecx
		jz	short loc_10006D26
		mov	[esi], ebp
		jmp	short loc_10006D51
; ---------------------------------------------------------------------------

loc_10006D3D:				; CODE XREF: sub_10006C8E+A6j
		mov	dword ptr [esi], 4
		jmp	short loc_10006D51
; ---------------------------------------------------------------------------

loc_10006D45:				; CODE XREF: sub_10006C8E+A3j
		mov	[esi], edi
		jmp	short loc_10006D51
; ---------------------------------------------------------------------------

loc_10006D49:				; CODE XREF: sub_10006C8E+9Ej
		jle	short loc_10006D51
		mov	dword ptr [esi], 7

loc_10006D51:				; CODE XREF: sub_10006C8E+8Ej
					; sub_10006C8E+9Aj ...
		movzx	eax, [esp+158h+var_C]
		lea	edi, [esp+158h+SystemInfo.dwPageSize]
		and	dword ptr [esp+158h+SystemInfo.u], 0
		mov	[esi+14h], eax
		movzx	eax, [esp+158h+var_A]
		push	8
		mov	[esi+18h], eax
		xor	eax, eax
		pop	ecx
		rep stosd
		lea	eax, [esp+158h+SystemInfo]
		push	eax		; lpSystemInfo
		call	ds:GetNativeSystemInfo
		mov	ecx, dword ptr [esp+158h+SystemInfo.u]
		push	2
		pop	edi
		movzx	eax, cx
		push	9
		pop	edx
		test	eax, eax
		jz	short loc_10006DA5
		cmp	eax, ebp
		jz	short loc_10006DA0
		cmp	eax, edx
		jnz	short loc_10006DA9
		mov	[esi+1Ch], ebx
		jmp	short loc_10006DA9
; ---------------------------------------------------------------------------

loc_10006DA0:				; CODE XREF: sub_10006C8E+107j
		mov	[esi+1Ch], edi
		jmp	short loc_10006DA9
; ---------------------------------------------------------------------------

loc_10006DA5:				; CODE XREF: sub_10006C8E+103j
		and	dword ptr [esi+1Ch], 0

loc_10006DA9:				; CODE XREF: sub_10006C8E+10Bj
					; sub_10006C8E+110j ...
		mov	eax, [esp+158h+SystemInfo.dwNumberOfProcessors]
		mov	[esi+20h], eax
		mov	eax, [esp+158h+SystemInfo.dwAllocationGranularity]
		mov	[esi+24h], eax
		cmp	[esp+158h+VersionInformation.dwMajorVersion], ebp
		jnz	loc_10006E4A
		push	offset ProcName	; "GetProductInfo"
		push	offset ModuleName ; "kernel32.dll"
		call	ds:GetModuleHandleW
		push	eax		; hModule
		call	ds:GetProcAddress
		lea	ecx, [esp+158h+var_148]
		push	ecx
		push	0
		push	0
		push	[esp+164h+VersionInformation.dwMinorVersion]
		push	[esp+168h+VersionInformation.dwMajorVersion]
		call	eax
		mov	eax, [esp+158h+var_148]
		cmp	eax, 0Fh
		ja	short loc_10006E2C
		cmp	eax, 0Ch
		jnb	short loc_10006E45
		cmp	eax, ebx
		jz	short loc_10006E40
		cmp	eax, 4
		jz	short loc_10006E40
		cmp	eax, ebp
		jz	short loc_10006E40
		jbe	short loc_10006E0D
		cmp	eax, 0Ah
		jbe	short loc_10006E45

loc_10006E0D:				; CODE XREF: sub_10006C8E+178j
					; sub_10006C8E+1A1j ...
		and	dword ptr [esi+10h], 0

loc_10006E11:				; CODE XREF: sub_10006C8E+1B5j
					; sub_10006C8E+1BAj ...
		mov	ecx, [esp+158h+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 148h
		retn
; ---------------------------------------------------------------------------

loc_10006E2C:				; CODE XREF: sub_10006C8E+164j
		cmp	eax, 11h
		jb	short loc_10006E0D
		cmp	eax, 12h
		jbe	short loc_10006E45
		cmp	eax, 19h
		jz	short loc_10006E45
		cmp	eax, 30h
		jnz	short loc_10006E0D

loc_10006E40:				; CODE XREF: sub_10006C8E+16Dj
					; sub_10006C8E+172j ...
		mov	[esi+10h], ebx
		jmp	short loc_10006E11
; ---------------------------------------------------------------------------

loc_10006E45:				; CODE XREF: sub_10006C8E+169j
					; sub_10006C8E+17Dj ...
		mov	[esi+10h], edi
		jmp	short loc_10006E11
; ---------------------------------------------------------------------------

loc_10006E4A:				; CODE XREF: sub_10006C8E+12Dj
		cmp	[esp+158h+VersionInformation.dwMajorVersion], 5
		jnz	short loc_10006E0D
		cmp	[esp+158h+VersionInformation.dwMinorVersion], edi
		jnz	short loc_10006E7B
		cmp	[esp+158h+var_6], 1
		jnz	short loc_10006E66
		cmp	cx, dx
		jz	short loc_10006E40

loc_10006E66:				; CODE XREF: sub_10006C8E+1D1j
		mov	ax, [esp+158h+var_8]
		not	ax
		movzx	eax, ax
		shr	eax, 0Eh
		and	eax, edi
		jmp	short loc_10006E94
; ---------------------------------------------------------------------------

loc_10006E7B:				; CODE XREF: sub_10006C8E+1C7j
		cmp	[esp+158h+VersionInformation.dwMinorVersion], ebx
		jnz	short loc_10006E0D
		mov	ax, [esp+158h+var_8]
		not	ax
		movzx	eax, ax
		shr	eax, 9
		and	eax, ebx

loc_10006E94:				; CODE XREF: sub_10006C8E+1EBj
		mov	[esi+10h], eax
		jmp	loc_10006E11
sub_10006C8E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006E9C	proc near		; CODE XREF: sub_10006EA9+3Ap
		push	0		; size_t
		push	1		; char
		add	ecx, 2Ch	; void *
		call	sub_10001769
		retn
sub_10006E9C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006EA9	proc near		; CODE XREF: sub_10006EF6p
					; sub_10007949+Dp ...
		cmp	dword_10033C0C,	0
		jnz	short loc_10006EF0
		push	esi
		push	44h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10006ECA
		mov	ecx, eax
		call	sub_10006C8E
		mov	esi, eax
		jmp	short loc_10006ECC
; ---------------------------------------------------------------------------

loc_10006ECA:				; CODE XREF: sub_10006EA9+14j
		xor	esi, esi

loc_10006ECC:				; CODE XREF: sub_10006EA9+1Fj
		mov	ecx, esi
		mov	edx, offset dword_10033C0C
		xor	eax, eax
		lock cmpxchg [edx], ecx
		test	eax, eax
		jz	short loc_10006EEF
		test	esi, esi
		jz	short loc_10006EEF
		mov	ecx, esi
		call	sub_10006E9C
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10006EEF:				; CODE XREF: sub_10006EA9+32j
					; sub_10006EA9+36j
		pop	esi

loc_10006EF0:				; CODE XREF: sub_10006EA9+7j
		mov	eax, dword_10033C0C
		retn
sub_10006EA9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006EF6	proc near		; CODE XREF: sub_10006B5D+13p
					; sub_100095AD+1EBp ...
		call	sub_10006EA9
		mov	eax, [eax]
		retn
sub_10006EF6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10006EFE	proc near		; CODE XREF: sub_10006C8E+2Fp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	offset aIswow64process ; "IsWow64Process"
		push	offset ModuleName ; "kernel32.dll"
		call	ds:GetModuleHandleW
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_10006F3B
		and	[ebp+var_4], 0
		lea	ecx, [ebp+var_4]
		push	ecx
		push	[ebp+arg_0]
		call	eax
		test	eax, eax
		jnz	short loc_10006F33
		push	2
		pop	eax
		jmp	short loc_10006F3B
; ---------------------------------------------------------------------------

loc_10006F33:				; CODE XREF: sub_10006EFE+2Ej
		xor	eax, eax
		cmp	[ebp+var_4], eax
		setnz	al

loc_10006F3B:				; CODE XREF: sub_10006EFE+1Dj
					; sub_10006EFE+33j
		mov	esp, ebp
		pop	ebp
		retn
sub_10006EFE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006F3F	proc near		; CODE XREF: sub_1000774A+EDp

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 20h
		and	[esp+20h+var_20], 0
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+2Ch+arg_4]
		push	edi
		lea	ecx, [esi+1]

loc_10006F51:				; CODE XREF: sub_10006F3F+17j
		mov	al, [esi]
		inc	esi
		test	al, al
		jnz	short loc_10006F51
		mov	edi, [esp+30h+arg_0]
		sub	esi, ecx
		xor	ecx, ecx
		mov	[esp+30h+var_14], esi
		mov	[esp+30h+var_1C], ecx
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	ebp, [eax+edi+24h]
		mov	ebx, [eax+edi+20h]
		test	ebp, ebp
		jl	short loc_10006F8F
		jg	short loc_10006F7F
		test	ebx, ebx
		jz	short loc_10006F8F

loc_10006F7F:				; CODE XREF: sub_10006F3F+3Aj
		cmp	ebp, ecx
		jl	short loc_10006F8F
		jg	short loc_10006F89
		cmp	ebx, esi
		jbe	short loc_10006F8F

loc_10006F89:				; CODE XREF: sub_10006F3F+44j
		sub	ebx, esi
		sbb	ebp, ecx
		jmp	short loc_10006F93
; ---------------------------------------------------------------------------

loc_10006F8F:				; CODE XREF: sub_10006F3F+38j
					; sub_10006F3F+3Ej ...
		xor	ebx, ebx
		xor	ebp, ebp

loc_10006F93:				; CODE XREF: sub_10006F3F+4Ej
		push	edi
		lea	ecx, [esp+34h+var_8]
		mov	[esp+34h+var_18], ebp
		mov	[esp+34h+arg_0], ebx
		call	sub_100074B0
		cmp	byte ptr [esp+30h+var_4], 0
		jnz	short loc_10006FB4
		push	4
		pop	ecx
		jmp	loc_100070F6
; ---------------------------------------------------------------------------

loc_10006FB4:				; CODE XREF: sub_10006F3F+6Bj
		lea	eax, [esp+30h+var_10]
		push	eax
		mov	eax, [edi]
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?getloc@ios_base@std@@QBE?AVlocale@2@XZ ; std::ios_base::getloc(void)
		push	eax
		call	sub_100073A6
		pop	ecx
		lea	ecx, [esp+30h+var_10]
		mov	[esp+30h+var_C], eax
		call	sub_1000755D
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_1000702E
		test	ebp, ebp
		jl	short loc_1000702E
		jle	short loc_1000702A

loc_10006FF3:				; CODE XREF: sub_10006F3F+E7j
					; sub_10006F3F+EDj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	loc_100070E4
		add	ebx, 0FFFFFFFFh
		mov	[esp+30h+arg_0], ebx
		adc	ebp, 0FFFFFFFFh
		mov	[esp+30h+var_18], ebp
		test	ebp, ebp
		jg	short loc_10006FF3
		jl	short loc_1000702E

loc_1000702A:				; CODE XREF: sub_10006F3F+B2j
		test	ebx, ebx
		jnz	short loc_10006FF3

loc_1000702E:				; CODE XREF: sub_10006F3F+ACj
					; sub_10006F3F+B0j ...
		mov	ecx, [esp+30h+var_20]
		mov	eax, [esp+30h+var_1C]
		mov	ebx, [esp+30h+arg_4]
		mov	ebp, [esp+30h+var_C]

loc_1000703E:				; CODE XREF: sub_10006F3F+158j
		test	eax, eax
		jl	short loc_10007099
		jg	short loc_10007048
		test	esi, esi
		jz	short loc_10007099

loc_10007048:				; CODE XREF: sub_10006F3F+103j
		mov	eax, [edi]
		mov	ecx, ebp
		mov	eax, [eax+4]
		mov	esi, [eax+edi+38h]
		movzx	eax, byte ptr [ebx]
		push	eax
		call	ds:?widen@?$ctype@_W@std@@QBE_WD@Z ; std::ctype<wchar_t>::widen(char)
		movzx	eax, ax
		mov	ecx, esi
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		mov	ecx, [esp+30h+var_20]
		jnz	short loc_1000707E
		or	ecx, 4
		mov	[esp+30h+var_20], ecx

loc_1000707E:				; CODE XREF: sub_10006F3F+136j
		mov	esi, [esp+30h+var_14]
		mov	eax, [esp+30h+var_1C]
		add	esi, 0FFFFFFFFh
		mov	[esp+30h+var_14], esi
		adc	eax, 0FFFFFFFFh
		inc	ebx
		mov	[esp+30h+var_1C], eax
		test	ecx, ecx
		jz	short loc_1000703E

loc_10007099:				; CODE XREF: sub_10006F3F+101j
					; sub_10006F3F+107j
		mov	ebx, [esp+30h+arg_0]
		mov	ebp, [esp+30h+var_18]
		test	ecx, ecx
		jnz	short loc_100070E7
		test	ebp, ebp
		jl	short loc_100070E7
		jg	short loc_100070AF
		test	ebx, ebx
		jz	short loc_100070E7

loc_100070AF:				; CODE XREF: sub_10006F3F+16Aj
					; sub_10006F3F+197j ...
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_100070E4
		add	ebx, 0FFFFFFFFh
		adc	ebp, 0FFFFFFFFh
		test	ebp, ebp
		jg	short loc_100070AF
		jl	short loc_100070DE
		test	ebx, ebx
		jnz	short loc_100070AF

loc_100070DE:				; CODE XREF: sub_10006F3F+199j
		mov	ecx, [esp+30h+var_20]
		jmp	short loc_100070E7
; ---------------------------------------------------------------------------

loc_100070E4:				; CODE XREF: sub_10006F3F+D1j
					; sub_10006F3F+18Dj
		push	4
		pop	ecx

loc_100070E7:				; CODE XREF: sub_10006F3F+164j
					; sub_10006F3F+168j ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_100070F6:				; CODE XREF: sub_10006F3F+70j
		mov	eax, [edi]
		push	0
		push	ecx
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z ; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::setstate(int,bool)
		mov	esi, [esp+30h+var_8]
		mov	ecx, esi
		call	ds:?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ	; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::_Osfx(void)
		mov	eax, [esi]
		mov	ecx, [eax+4]
		mov	ecx, [ecx+esi+38h]
		test	ecx, ecx
		jz	short loc_10007124
		mov	edx, [ecx]
		call	dword ptr [edx+8]

loc_10007124:				; CODE XREF: sub_10006F3F+1DEj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_10006F3F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000712E	proc near		; CODE XREF: sub_1000774A+CDp
					; sub_1000774A+DDp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	[esp+1Ch+arg_4]
		xor	ebp, ebp
		call	sub_100024E3
		mov	edi, [esp+20h+arg_0]
		pop	ecx
		mov	[esp+1Ch+var_C], eax
		mov	ecx, [edi]
		mov	ecx, [ecx+4]
		mov	ebx, [ecx+edi+24h]
		mov	esi, [ecx+edi+20h]
		test	ebx, ebx
		jl	short loc_10007170
		jg	short loc_1000716A
		test	esi, esi
		jz	short loc_10007170
		test	ebx, ebx
		jl	short loc_10007170
		jg	short loc_1000716A
		cmp	esi, eax
		jbe	short loc_10007170

loc_1000716A:				; CODE XREF: sub_1000712E+2Cj
					; sub_1000712E+36j
		sub	esi, eax
		sbb	ebx, ebp
		jmp	short loc_10007174
; ---------------------------------------------------------------------------

loc_10007170:				; CODE XREF: sub_1000712E+2Aj
					; sub_1000712E+30j ...
		xor	esi, esi
		xor	ebx, ebx

loc_10007174:				; CODE XREF: sub_1000712E+40j
		push	edi
		lea	ecx, [esp+20h+var_8]
		call	sub_100074B0
		cmp	[esp+1Ch+var_4], 0
		jnz	short loc_1000718D
		push	4
		pop	ebp
		jmp	loc_10007241
; ---------------------------------------------------------------------------

loc_1000718D:				; CODE XREF: sub_1000712E+55j
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_100071D5
		test	ebx, ebx
		jl	short loc_100071D5
		jle	short loc_100071D1

loc_100071A6:				; CODE XREF: sub_1000712E+9Fj
					; sub_1000712E+A5j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_1000722F
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_100071A6
		jl	short loc_100071D5

loc_100071D1:				; CODE XREF: sub_1000712E+76j
		test	esi, esi
		jnz	short loc_100071A6

loc_100071D5:				; CODE XREF: sub_1000712E+70j
					; sub_1000712E+74j ...
		mov	eax, [edi]
		push	0
		push	[esp+20h+var_C]
		mov	eax, [eax+4]
		push	[esp+24h+arg_4]
		mov	ecx, [eax+edi+38h]
		call	ds:?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputn(wchar_t const	*,__int64)
		cmp	eax, [esp+1Ch+var_C]
		jnz	short loc_1000722F
		test	edx, edx
		jnz	short loc_1000722F
		test	ebx, ebx
		jl	short loc_10007232
		jle	short loc_10007229

loc_100071FE:				; CODE XREF: sub_1000712E+F7j
					; sub_1000712E+FDj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_1000722F
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_100071FE
		jl	short loc_10007232

loc_10007229:				; CODE XREF: sub_1000712E+CEj
		test	esi, esi
		jnz	short loc_100071FE
		jmp	short loc_10007232
; ---------------------------------------------------------------------------

loc_1000722F:				; CODE XREF: sub_1000712E+95j
					; sub_1000712E+C4j ...
		push	4
		pop	ebp

loc_10007232:				; CODE XREF: sub_1000712E+CCj
					; sub_1000712E+F9j ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_10007241:				; CODE XREF: sub_1000712E+5Aj
		mov	eax, [edi]
		push	0
		push	ebp
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z ; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::setstate(int,bool)
		mov	esi, [esp+1Ch+var_8]
		mov	ecx, esi
		call	ds:?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ	; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::_Osfx(void)
		mov	eax, [esi]
		mov	ecx, [eax+4]
		mov	ecx, [ecx+esi+38h]
		test	ecx, ecx
		jz	short loc_1000726F
		mov	edx, [ecx]
		call	dword ptr [edx+8]

loc_1000726F:				; CODE XREF: sub_1000712E+13Aj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000712E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007279	proc near		; CODE XREF: sub_1000774A+D5p

var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_4]
		xor	ebx, ebx
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		mov	ecx, [ebp+10h]
		mov	[esp+18h+arg_4], ecx
		mov	eax, [edi]
		mov	esi, [eax+4]
		cmp	[esi+edi+24h], ebx
		jl	short loc_100072AF
		jg	short loc_100072A3
		cmp	[esi+edi+20h], ebx
		jbe	short loc_100072AF

loc_100072A3:				; CODE XREF: sub_10007279+22j
		mov	esi, [esi+edi+20h]
		cmp	esi, ecx
		jbe	short loc_100072AF
		sub	esi, ecx
		jmp	short loc_100072B1
; ---------------------------------------------------------------------------

loc_100072AF:				; CODE XREF: sub_10007279+20j
					; sub_10007279+28j ...
		xor	esi, esi

loc_100072B1:				; CODE XREF: sub_10007279+34j
		push	edi
		lea	ecx, [esp+1Ch+var_8]
		call	sub_100074B0
		cmp	[esp+18h+var_4], bl
		jnz	short loc_100072C9
		push	4
		pop	ebx
		jmp	loc_1000736F
; ---------------------------------------------------------------------------

loc_100072C9:				; CODE XREF: sub_10007279+46j
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_10007302
		test	esi, esi
		jz	short loc_10007302

loc_100072E0:				; CODE XREF: sub_10007279+87j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_10007353
		dec	esi
		jnz	short loc_100072E0

loc_10007302:				; CODE XREF: sub_10007279+61j
					; sub_10007279+65j
		cmp	dword ptr [ebp+14h], 8
		jb	short loc_1000730B
		mov	ebp, [ebp+0]

loc_1000730B:				; CODE XREF: sub_10007279+8Dj
		mov	eax, [edi]
		push	0
		push	[esp+1Ch+arg_4]
		mov	eax, [eax+4]
		push	ebp
		mov	ecx, [eax+edi+38h]
		call	ds:?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputn(wchar_t const	*,__int64)
		cmp	eax, [esp+18h+arg_4]
		jnz	short loc_1000735D
		test	edx, edx
		jnz	short loc_1000735D

loc_1000732B:				; CODE XREF: sub_10007279+DDj
		test	esi, esi
		jz	short loc_10007360

loc_1000732F:				; CODE XREF: sub_10007279+D6j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_10007358
		dec	esi
		jnz	short loc_1000732F
		jmp	short loc_10007360
; ---------------------------------------------------------------------------

loc_10007353:				; CODE XREF: sub_10007279+84j
		push	4
		pop	ebx
		jmp	short loc_1000732B
; ---------------------------------------------------------------------------

loc_10007358:				; CODE XREF: sub_10007279+D3j
		or	ebx, 4
		jmp	short loc_10007360
; ---------------------------------------------------------------------------

loc_1000735D:				; CODE XREF: sub_10007279+ACj
					; sub_10007279+B0j
		push	4
		pop	ebx

loc_10007360:				; CODE XREF: sub_10007279+B4j
					; sub_10007279+D8j ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_1000736F:				; CODE XREF: sub_10007279+4Bj
		mov	eax, [edi]
		push	0
		push	ebx
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z ; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::setstate(int,bool)
		mov	esi, [esp+18h+var_8]
		mov	ecx, esi
		call	ds:?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ	; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::_Osfx(void)
		mov	eax, [esi]
		mov	ecx, [eax+4]
		mov	ecx, [ecx+esi+38h]
		test	ecx, ecx
		jz	short loc_1000739D
		mov	edx, [ecx]
		call	dword ptr [edx+8]

loc_1000739D:				; CODE XREF: sub_10007279+11Dj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_10007279	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100073A6	proc near		; CODE XREF: sub_10006F3F+88p

var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	0
		lea	ecx, [ebp+var_8]
		call	ds:??0_Lockit@std@@QAE@H@Z ; std::_Lockit::_Lockit(int)
		mov	eax, dword_10033C14
		mov	ecx, ds:?id@?$ctype@_W@std@@2V0locale@2@A ; std::locale::id std::ctype<wchar_t>::id
		mov	[ebp+var_4], eax
		call	ds:??Bid@locale@std@@QAEIXZ ; std::locale::id::operator	uint(void)
		mov	ecx, [ebp+arg_0]
		push	eax
		call	sub_10007A55
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10007412
		mov	esi, [ebp+var_4]
		test	esi, esi
		jnz	short loc_10007412
		push	[ebp+arg_0]
		lea	eax, [ebp+var_4]
		push	eax
		call	ds:?_Getcat@?$ctype@_W@std@@SAIPAPBVfacet@locale@2@PBV42@@Z ; std::ctype<wchar_t>::_Getcat(std::locale::facet const * *,std::locale const *)
		pop	ecx
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100073FB
		call	ds:abort
; ---------------------------------------------------------------------------

loc_100073FB:				; CODE XREF: sub_100073A6+4Dj
		mov	esi, [ebp+var_4]
		mov	ecx, esi
		mov	dword_10033C14,	esi
		mov	eax, [esi]
		call	dword ptr [eax+4]
		push	esi		; struct std::_Facet_base *
		call	?_Facet_Register@std@@YAXPAV_Facet_base@1@@Z ; std::_Facet_Register(std::_Facet_base *)
		pop	ecx

loc_10007412:				; CODE XREF: sub_100073A6+32j
					; sub_100073A6+39j
		lea	ecx, [ebp+var_8]
		call	ds:??1_Lockit@std@@QAE@XZ ; std::_Lockit::~_Lockit(void)
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100073A6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007422	proc near		; CODE XREF: sub_10007449+58p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		call	ds:??0?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAE@XZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::basic_streambuf<wchar_t,std::char_traits<wchar_t>>(void)
		push	[esp+4+arg_0]
		and	dword ptr [esi+38h], 0
		mov	ecx, esi
		mov	dword ptr [esi], offset	off_1001CF48
		call	sub_100021F8
		mov	[esi+3Ch], eax
		mov	eax, esi
		pop	esi
		retn	4
sub_10007422	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10007449	proc near		; CODE XREF: sub_1000774A+8Dp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		cmp	[ebp+arg_4], 0
		push	esi
		push	edi
		mov	edi, ecx
		jz	short loc_10007478
		mov	dword ptr [edi], offset	dword_1001CF88
		mov	dword ptr [edi+10h], offset dword_1001CF90
		mov	eax, ds:??_7ios_base@std@@6B@ ;	const std::ios_base::`vftable'
		mov	[edi+68h], eax
		mov	eax, ds:??_7?$basic_ios@_WU?$char_traits@_W@std@@@std@@6B@ ; const std::basic_ios<wchar_t,std::char_traits<wchar_t>>::`vftable'
		mov	[edi+68h], eax

loc_10007478:				; CODE XREF: sub_10007449+10j
		push	0
		lea	esi, [edi+18h]
		push	esi
		call	ds:??0?$basic_iostream@_WU?$char_traits@_W@std@@@std@@QAE@PAV?$basic_streambuf@_WU?$char_traits@_W@std@@@1@@Z ;	std::basic_iostream<wchar_t,std::char_traits<wchar_t>>::basic_iostream<wchar_t,std::char_traits<wchar_t>>(std::basic_streambuf<wchar_t,std::char_traits<wchar_t>> *)
		mov	eax, [edi]
		mov	ecx, esi
		push	[ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [edi+eax], offset off_1001CF84
		mov	eax, [edi]
		mov	edx, [eax+4]
		lea	eax, [edx-68h]
		mov	[edx+edi-4], eax
		call	sub_10007422
		mov	eax, edi
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10007449	endp


; =============== S U B	R O U T	I N E =======================================


sub_100074B0	proc near		; CODE XREF: sub_10006F3F+61p
					; sub_1000712E+4Bp ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	esi
		mov	edi, ecx
		call	sub_10001F76
		mov	eax, [esi]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+esi+0Ch], 0
		jnz	short loc_100074DC
		mov	ecx, [ecx+esi+3Ch]
		test	ecx, ecx
		jz	short loc_100074DC
		cmp	ecx, esi
		jz	short loc_100074DC
		call	ds:?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::flush(void)

loc_100074DC:				; CODE XREF: sub_100074B0+18j
					; sub_100074B0+20j ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		cmp	dword ptr [eax+esi+0Ch], 0
		setz	al
		mov	[edi+4], al
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_100074B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100074F3	proc near		; CODE XREF: sub_1000750A+21p
					; sub_100075A0+3p
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1001CF48
		call	sub_10002307
		mov	ecx, esi
		pop	esi
		jmp	ds:??1?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAE@XZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::~basic_streambuf<wchar_t,std::char_traits<wchar_t>>(void)
sub_100074F3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000750A	proc near		; CODE XREF: sub_10007575+6p
		push	esi
		mov	esi, ecx
		mov	eax, [esi-68h]
		lea	ecx, [esi-50h]
		mov	eax, [eax+4]
		mov	dword ptr [eax+esi-68h], offset	off_1001CF84
		mov	eax, [esi-68h]
		mov	edx, [eax+4]
		lea	eax, [edx-68h]
		mov	[edx+esi-6Ch], eax
		call	sub_100074F3
		lea	ecx, [esi-48h]
		pop	esi
		jmp	ds:??1?$basic_iostream@_WU?$char_traits@_W@std@@@std@@UAE@XZ ; std::basic_iostream<wchar_t,std::char_traits<wchar_t>>::~basic_iostream<wchar_t,std::char_traits<wchar_t>>(void)
sub_1000750A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000753A	proc near		; CODE XREF: sub_1000F01E+CAp
					; sub_1000F01E:loc_1000F0F2p
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+8], 0
		jz	short loc_1000754C
		push	dword ptr [edi+8] ; hObject
		call	ds:CloseHandle

loc_1000754C:				; CODE XREF: sub_1000753A+7j
		cmp	dword ptr [edi+0Ch], 0
		jz	short loc_1000755B
		push	dword ptr [edi+0Ch] ; hObject
		call	ds:CloseHandle

loc_1000755B:				; CODE XREF: sub_1000753A+16j
		pop	edi
		retn
sub_1000753A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000755D	proc near		; CODE XREF: sub_10006F3F+96p
		mov	ecx, [ecx]
		test	ecx, ecx
		jz	short locret_10007574
		mov	eax, [ecx]
		call	dword ptr [eax+8]
		test	eax, eax
		jz	short locret_10007574
		mov	edx, [eax]
		mov	ecx, eax
		push	1
		call	dword ptr [edx]

locret_10007574:			; CODE XREF: sub_1000755D+4j
					; sub_1000755D+Dj
		retn
sub_1000755D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007575	proc near		; CODE XREF: sub_10007598+2Ap
					; sub_1000774A+1CFp
		push	esi
		lea	esi, [ecx+68h]
		mov	ecx, esi
		call	sub_1000750A
		mov	eax, ds:??_7?$basic_ios@_WU?$char_traits@_W@std@@@std@@6B@ ; const std::basic_ios<wchar_t,std::char_traits<wchar_t>>::`vftable'
		mov	[esi], eax
		mov	eax, ds:??_7ios_base@std@@6B@ ;	const std::ios_base::`vftable'
		push	esi
		mov	[esi], eax
		call	ds:?_Ios_base_dtor@ios_base@std@@CAXPAV12@@Z ; std::ios_base::_Ios_base_dtor(std::ios_base *)
		pop	ecx
		pop	esi
		retn
sub_10007575	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007598	proc near		; DATA XREF: .rdata:off_1001CF84o

arg_0		= byte ptr  4

; FUNCTION CHUNK AT 100075BC SIZE 0000001F BYTES

		sub	ecx, [ecx-4]
		jmp	loc_100075BC
sub_10007598	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100075A0(void *, char)
sub_100075A0	proc near		; DATA XREF: .rdata:off_1001CF48o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_100074F3
		test	[esp+4+arg_0], 1
		jz	short loc_100075B6
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_100075B6:				; CODE XREF: sub_100075A0+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_100075A0	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10007598

loc_100075BC:				; CODE XREF: sub_10007598+3j
		push	esi
		lea	esi, [ecx-68h]
		mov	ecx, esi
		call	sub_10007575
		test	[esp+4+arg_0], 1
		jz	short loc_100075D5
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_100075D5:				; CODE XREF: sub_10007598+34j
		mov	eax, esi
		pop	esi
		retn	4
; END OF FUNCTION CHUNK	FOR sub_10007598

; =============== S U B	R O U T	I N E =======================================


sub_100075DB	proc near		; CODE XREF: sub_10007949+ECp

var_4		= dword	ptr -4

		push	ecx
		and	[esp+4+var_4], 0
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4] ; hThread
		call	ds:ResumeThread
		cmp	eax, 1
		jz	short loc_100075F7
		xor	al, al
		jmp	short loc_1000765F
; ---------------------------------------------------------------------------

loc_100075F7:				; CODE XREF: sub_100075DB+16j
		push	ebx
		push	ebp
		push	0FFFFFFFFh	; dwMilliseconds
		push	dword ptr [esi+8] ; hHandle
		call	ds:WaitForSingleObject
		mov	ebp, 102h
		jmp	short loc_10007657
; ---------------------------------------------------------------------------

loc_1000760B:				; CODE XREF: sub_100075DB+7Ej
		cmp	eax, 80h
		jz	short loc_1000765B
		push	dword ptr [esi+8] ; hEvent
		call	ds:ResetEvent
		test	eax, eax
		jz	short loc_1000765B
		mov	ecx, esi
		call	sub_10007666
		mov	bl, al
		test	bl, bl
		jz	short loc_1000763B
		mov	eax, [esi]
		push	dword ptr [eax+4] ; hThread
		call	ds:SuspendThread
		test	eax, eax
		jnz	short loc_1000765B

loc_1000763B:				; CODE XREF: sub_100075DB+4Fj
		push	dword ptr [esi+0Ch] ; hEvent
		call	ds:SetEvent
		test	eax, eax
		jz	short loc_1000765B
		test	bl, bl
		jnz	short loc_10007662
		push	0FFFFFFFFh	; dwMilliseconds
		push	dword ptr [esi+8] ; hHandle
		call	ds:WaitForSingleObject

loc_10007657:				; CODE XREF: sub_100075DB+2Ej
		cmp	eax, ebp
		jnz	short loc_1000760B

loc_1000765B:				; CODE XREF: sub_100075DB+35j
					; sub_100075DB+42j ...
		xor	al, al

loc_1000765D:				; CODE XREF: sub_100075DB+89j
		pop	ebp
		pop	ebx

loc_1000765F:				; CODE XREF: sub_100075DB+1Aj
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10007662:				; CODE XREF: sub_100075DB+6Fj
		mov	al, 1
		jmp	short loc_1000765D
sub_100075DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10007666	proc near		; CODE XREF: sub_100075DB+46p

NumberOfBytesRead= dword ptr -208h
Buffer		= byte ptr -204h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 208h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ecx]
		lea	edx, [ebp+NumberOfBytesRead]
		push	esi
		push	edx		; lpNumberOfBytesRead
		mov	esi, 200h
		lea	edx, [ebp+Buffer]
		push	esi		; nSize
		push	edx		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [eax]	; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jnz	short loc_100076A3
		xor	al, al
		jmp	short loc_100076AC
; ---------------------------------------------------------------------------

loc_100076A3:				; CODE XREF: sub_10007666+37j
		cmp	[ebp+NumberOfBytesRead], esi
		setz	al

loc_100076AC:				; CODE XREF: sub_10007666+3Bj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10007666	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100076BB(HANDLE hProcess, LPCVOID lpBaseAddress)
sub_100076BB	proc near		; CODE XREF: sub_10007949+FEp

Buffer		= byte ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
NumberOfBytesRead= dword ptr -18h
var_14		= byte ptr -14h
var_4		= dword	ptr -4
hProcess	= dword	ptr  8
lpBaseAddress	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+lpBaseAddress]
		lea	ecx, [ebp+NumberOfBytesRead]
		push	esi
		mov	esi, [ebp+hProcess]
		push	ecx		; lpNumberOfBytesRead
		push	30h		; nSize
		lea	ecx, [ebp+Buffer]
		push	ecx		; lpBuffer
		push	eax		; lpBaseAddress
		push	esi		; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jnz	short loc_100076EC

loc_100076E8:				; CODE XREF: sub_100076BB+35j
					; sub_100076BB+3Bj ...
		xor	al, al
		jmp	short loc_1000773B
; ---------------------------------------------------------------------------

loc_100076EC:				; CODE XREF: sub_100076BB+2Bj
		cmp	[ebp+NumberOfBytesRead], 30h
		jnz	short loc_100076E8
		cmp	[ebp+var_2C], 0
		jnz	short loc_100076E8
		cmp	[ebp+var_1C], 0
		jnz	short loc_100076E8
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	10h		; nSize
		lea	eax, [ebp+var_14]
		push	eax		; lpBuffer
		push	[ebp+var_30]	; lpBaseAddress
		push	esi		; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_100076E8
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	short loc_100076E8
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesWritten
		push	10h		; nSize
		lea	eax, [ebp+var_14]
		push	eax		; lpBuffer
		push	[ebp+var_20]	; lpBaseAddress
		push	esi		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_100076E8
		cmp	[ebp+NumberOfBytesRead], 10h
		setz	al

loc_1000773B:				; CODE XREF: sub_100076BB+2Fj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100076BB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=2C0h

sub_1000774A	proc near		; CODE XREF: sub_10007949+E1p

var_354		= byte ptr -354h
var_344		= byte ptr -344h
var_33C		= byte ptr -33Ch
StartupInfo	= _STARTUPINFOW	ptr -2A4h
ProcessInformation= _PROCESS_INFORMATION ptr -260h
hHandle		= dword	ptr -250h
ExitCode	= dword	ptr -240h
var_23C		= byte ptr -23Ch
var_224		= dword	ptr -224h
var_210		= dword	ptr -210h
Filename	= word ptr -20Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		lea	ebp, [esp-2C0h]
		sub	esp, 354h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+2C0h+var_4], eax
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+2C0h+arg_0]
		lea	eax, [ebp+2C0h+Filename]
		push	104h		; nSize
		push	eax		; lpFilename
		push	0		; hModule
		mov	esi, ecx
		call	ds:GetModuleFileNameW
		lea	eax, [ebp+2C0h+Filename]
		push	eax		; void *
		lea	ecx, [ebp+2C0h+var_23C]
		call	sub_10001E8D
		mov	ebx, offset asc_1001CF44 ; "\\"
		push	ebx
		call	sub_100024E3
		pop	ecx
		push	eax
		push	0FFFFFFFFh
		push	ebx
		lea	ecx, [ebp+2C0h+var_23C]
		call	sub_10007A8F
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100077BD
		xor	bl, bl
		jmp	loc_1000791E
; ---------------------------------------------------------------------------

loc_100077BD:				; CODE XREF: sub_1000774A+6Aj
		xor	ebx, ebx
		lea	ecx, [ebp+2C0h+var_23C]
		push	ebx
		inc	eax
		push	eax
		call	sub_1000484E
		push	1
		push	3
		lea	ecx, [ebp+2C0h+var_354]
		call	sub_10007449
		mov	eax, [esi]
		lea	ecx, [ebp+2C0h+var_344]
		push	edi
		push	offset dword_1001CF98
		push	dword ptr [eax+8]
		lea	eax, [ebp+2C0h+var_23C]
		push	offset aWow_helper_exe ; "wow_helper.exe\" "
		push	eax
		push	offset asc_1001CFC0 ; "\""
		push	offset loc_1000802D
		push	offset sub_10007AFD
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAVios_base@1@AAV21@@Z@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(std::ios_base & (*)(std::ios_base	&))
		mov	ecx, eax
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAVios_base@1@AAV21@@Z@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(std::ios_base & (*)(std::ios_base	&))
		push	eax
		call	sub_1000712E
		pop	ecx
		pop	ecx
		push	eax
		call	sub_10007279
		pop	ecx
		pop	ecx
		push	eax
		call	sub_1000712E
		pop	ecx
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(ulong)
		push	eax
		call	sub_10006F3F
		pop	ecx
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(ulong)
		lea	eax, [ebp+2C0h+var_224]
		push	eax
		lea	ecx, [ebp+2C0h+var_33C]
		call	sub_10008036
		cmp	[ebp+2C0h+var_210], 8
		mov	eax, [ebp+2C0h+var_224]
		jnb	short loc_1000786A
		lea	eax, [ebp+2C0h+var_224]

loc_1000786A:				; CODE XREF: sub_1000774A+118j
		push	eax		; wchar_t *
		call	ds:_wcsdup
		pop	ecx
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+2C0h+var_224]	; void *
		mov	esi, eax
		call	sub_100022C1
		push	40h		; size_t
		lea	eax, [ebp+2C0h+StartupInfo.lpReserved]
		push	ebx		; int
		push	eax		; void *
		call	memset
		xor	eax, eax
		mov	[ebp+2C0h+StartupInfo.cb], 44h
		lea	edi, [ebp+2C0h+ProcessInformation]
		add	esp, 0Ch
		stosd
		stosd
		stosd
		stosd
		lea	eax, [ebp+2C0h+ProcessInformation]
		push	eax		; lpProcessInformation
		lea	eax, [ebp+2C0h+StartupInfo]
		push	eax		; lpStartupInfo
		push	ebx		; lpCurrentDirectory
		push	ebx		; lpEnvironment
		push	ebx		; dwCreationFlags
		push	ebx		; bInheritHandles
		push	ebx		; lpThreadAttributes
		push	ebx		; lpProcessAttributes
		push	esi		; lpCommandLine
		push	ebx		; lpApplicationName
		call	ds:CreateProcessW
		test	eax, eax
		jz	short loc_10007907
		lea	eax, [ebp+2C0h+ProcessInformation]
		push	eax
		lea	ecx, [ebp+2C0h+hHandle]
		call	sub_10006993
		push	0FFFFFFFFh	; dwMilliseconds
		push	[ebp+2C0h+hHandle] ; hHandle
		call	ds:WaitForSingleObject
		mov	edi, eax
		lea	eax, [ebp+2C0h+ExitCode]
		push	eax		; lpExitCode
		push	[ebp+2C0h+hHandle] ; hProcess
		call	ds:GetExitCodeProcess
		test	eax, eax
		setnz	al
		cmp	edi, 102h
		jz	short loc_100078FF
		test	al, al
		jz	short loc_100078FF
		cmp	[ebp+2C0h+ExitCode], ebx
		jnz	short loc_100078FF
		mov	bl, 1

loc_100078FF:				; CODE XREF: sub_1000774A+1A5j
					; sub_1000774A+1A9j ...
		lea	ecx, [ebp+2C0h+hHandle]
		call	sub_100069C2

loc_10007907:				; CODE XREF: sub_1000774A+16Fj
		test	esi, esi
		jz	short loc_10007913
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_10007913:				; CODE XREF: sub_1000774A+1BFj
		lea	ecx, [ebp+2C0h+var_354]
		call	sub_10007575

loc_1000791E:				; CODE XREF: sub_1000774A+6Ej
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+2C0h+var_23C]	; void *
		call	sub_100022C1
		mov	ecx, [ebp+2C0h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		lea	esp, [ebp+2C0h]
		pop	ebp
		retn	4
sub_1000774A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007949	proc near		; CODE XREF: sub_1000F01E+BAp

TargetHandle	= dword	ptr -3Ch
var_38		= dword	ptr -38h
NumberOfBytesWritten= dword ptr	-34h
Buffer		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h

		sub	esp, 3Ch
		push	ebp
		push	edi
		xor	ebp, ebp
		mov	edi, ecx
		mov	[esp+44h+NumberOfBytesWritten],	ebp
		call	sub_10006EA9
		cmp	dword ptr [eax+28h], 1
		jz	short loc_10007968
		mov	al, 1
		jmp	loc_10007A4F
; ---------------------------------------------------------------------------

loc_10007968:				; CODE XREF: sub_10007949+16j
		push	esi
		mov	esi, ds:CreateEventW
		push	ebp		; lpName
		push	ebp		; bInitialState
		push	1		; bManualReset
		push	ebp		; lpEventAttributes
		call	esi ; CreateEventW
		push	ebp		; lpName
		push	ebp		; bInitialState
		push	1		; bManualReset
		push	ebp		; lpEventAttributes
		mov	[edi+8], eax
		call	esi ; CreateEventW
		mov	[edi+0Ch], eax
		call	ds:GetCurrentProcess
		mov	ecx, [edi]
		mov	esi, eax
		push	ebp		; dwOptions
		push	ebp		; bInheritHandle
		push	100002h		; dwDesiredAccess
		lea	eax, [esp+54h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [ecx]	; hTargetProcessHandle
		push	dword ptr [edi+8] ; hSourceHandle
		push	esi		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	loc_10007A3E
		mov	eax, [edi]
		lea	ecx, [esp+48h+var_38]
		push	ebp		; dwOptions
		push	ebp		; bInheritHandle
		push	100002h		; dwDesiredAccess
		push	ecx		; lpTargetHandle
		push	dword ptr [eax]	; hTargetProcessHandle
		push	dword ptr [edi+0Ch] ; hSourceHandle
		push	esi		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10007A3E
		mov	eax, [edi]
		mov	ecx, 1000h
		push	40h		; flProtect
		push	ecx		; flAllocationType
		push	ecx		; dwSize
		push	ebp		; lpAddress
		push	dword ptr [eax]	; hProcess
		call	ds:VirtualAllocEx
		mov	esi, eax
		test	esi, esi
		jz	short loc_10007A3E
		push	2Ch		; size_t
		lea	eax, [esp+4Ch+var_2C]
		push	ebp		; int
		push	eax		; void *
		call	memset
		mov	eax, [esp+54h+TargetHandle]
		lea	ecx, [esp+54h+NumberOfBytesWritten]
		add	esp, 0Ch
		mov	[esp+48h+Buffer], eax
		mov	eax, [esp+48h+var_38]
		mov	[esp+48h+var_28], eax
		mov	eax, [edi]
		push	ecx		; lpNumberOfBytesWritten
		push	10h		; nSize
		lea	ecx, [esp+50h+Buffer]
		push	ecx		; lpBuffer
		push	esi		; lpBaseAddress
		push	dword ptr [eax]	; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_10007A3E
		cmp	[esp+48h+NumberOfBytesWritten],	10h
		jnz	short loc_10007A3E
		push	esi
		mov	ecx, edi
		call	sub_1000774A
		test	al, al
		jz	short loc_10007A3E
		mov	ecx, edi
		call	sub_100075DB
		test	al, al
		jnz	short loc_10007A42

loc_10007A3E:				; CODE XREF: sub_10007949+5Ej
					; sub_10007949+80j ...
		xor	al, al
		jmp	short loc_10007A4E
; ---------------------------------------------------------------------------

loc_10007A42:				; CODE XREF: sub_10007949+F3j
		mov	eax, [edi]
		push	esi		; lpBaseAddress
		push	dword ptr [eax]	; hProcess
		call	sub_100076BB
		pop	ecx
		pop	ecx

loc_10007A4E:				; CODE XREF: sub_10007949+F7j
		pop	esi

loc_10007A4F:				; CODE XREF: sub_10007949+1Aj
		pop	edi
		pop	ebp
		add	esp, 3Ch
		retn
sub_10007949	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007A55	proc near		; CODE XREF: sub_100073A6+29p

arg_0		= dword	ptr  4

		mov	ecx, [ecx]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		cmp	esi, [ecx+0Ch]
		jnb	short loc_10007A6C
		mov	eax, [ecx+8]
		mov	eax, [eax+esi*4]
		jmp	short loc_10007A6E
; ---------------------------------------------------------------------------

loc_10007A6C:				; CODE XREF: sub_10007A55+Dj
		mov	eax, edi

loc_10007A6E:				; CODE XREF: sub_10007A55+15j
		test	eax, eax
		jnz	short loc_10007A8A
		cmp	[ecx+14h], al
		jz	short loc_10007A8A
		call	ds:?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ ; std::locale::_Getgloballocale(void)
		cmp	esi, [eax+0Ch]
		jnb	short loc_10007A88
		mov	eax, [eax+8]
		mov	edi, [eax+esi*4]

loc_10007A88:				; CODE XREF: sub_10007A55+2Bj
		mov	eax, edi

loc_10007A8A:				; CODE XREF: sub_10007A55+1Bj
					; sub_10007A55+20j
		pop	edi
		pop	esi
		retn	4
sub_10007A55	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10007A8F	proc near		; CODE XREF: sub_1000774A+62p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		push	esi
		push	edi
		mov	esi, ecx
		jbe	short loc_10007AF4
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_10007AF4
		mov	ecx, [ebp+arg_4]
		cmp	ecx, eax
		jb	short loc_10007AAD
		lea	ecx, [eax-1]

loc_10007AAD:				; CODE XREF: sub_10007A8F+19j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10007AB7
		mov	eax, [esi]
		jmp	short loc_10007AB9
; ---------------------------------------------------------------------------

loc_10007AB7:				; CODE XREF: sub_10007A8F+22j
		mov	eax, esi

loc_10007AB9:				; CODE XREF: sub_10007A8F+26j
		lea	edi, [eax+ecx*2]
		jmp	short loc_10007AD1
; ---------------------------------------------------------------------------

loc_10007ABE:				; CODE XREF: sub_10007A8F+53j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10007AC8
		mov	eax, [esi]
		jmp	short loc_10007ACA
; ---------------------------------------------------------------------------

loc_10007AC8:				; CODE XREF: sub_10007A8F+33j
		mov	eax, esi

loc_10007ACA:				; CODE XREF: sub_10007A8F+37j
		cmp	edi, eax
		jz	short loc_10007AF4
		sub	edi, 2

loc_10007AD1:				; CODE XREF: sub_10007A8F+2Dj
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_0]
		call	sub_10003D6F
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10007ABE
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10007AEC
		mov	esi, [esi]

loc_10007AEC:				; CODE XREF: sub_10007A8F+59j
		sub	edi, esi
		sar	edi, 1
		mov	eax, edi
		jmp	short loc_10007AF7
; ---------------------------------------------------------------------------

loc_10007AF4:				; CODE XREF: sub_10007A8F+Bj
					; sub_10007A8F+12j ...
		or	eax, 0FFFFFFFFh

loc_10007AF7:				; CODE XREF: sub_10007A8F+63j
		pop	edi
		pop	esi
		pop	ebp
		retn	0Ch
sub_10007A8F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007AFD	proc near		; DATA XREF: sub_1000774A+B9o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+14h]
		and	ecx, 0FFFFF9FFh
		or	ecx, 800h
		mov	[eax+14h], ecx
		retn
sub_10007AFD	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10007B14(void *)
sub_10007B14	proc near		; DATA XREF: .rdata:1001CF54o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 2
		jz	short loc_10007B28
		mov	eax, 0FFFFh
		jmp	loc_10007CEE
; ---------------------------------------------------------------------------

loc_10007B28:				; CODE XREF: sub_10007B14+8j
		push	ebp
		mov	bp, word ptr [esp+0Ch+arg_0]
		push	edi
		mov	edi, 0FFFFh
		cmp	di, bp
		jnz	short loc_10007B40
		xor	eax, eax
		jmp	loc_10007CEC
; ---------------------------------------------------------------------------

loc_10007B40:				; CODE XREF: sub_10007B14+23j
		test	byte ptr [esi+3Ch], 8
		jz	short loc_10007B6E
		mov	edi, [esi+20h]
		mov	ecx, [edi]
		test	ecx, ecx
		jz	short loc_10007B69
		mov	edx, [esi+38h]
		cmp	ecx, edx
		jnb	short loc_10007B69
		mov	eax, [esi+30h]
		mov	eax, [eax]
		mov	[edi], edx
		lea	ecx, [ecx+eax*2]
		mov	eax, [esi+30h]
		sub	ecx, edx
		sar	ecx, 1
		mov	[eax], ecx

loc_10007B69:				; CODE XREF: sub_10007B14+39j
					; sub_10007B14+40j
		mov	edi, 0FFFFh

loc_10007B6E:				; CODE XREF: sub_10007B14+30j
		mov	eax, [esi+20h]
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_10007B96
		mov	ecx, [esi+30h]
		mov	ecx, [ecx]
		lea	ecx, [edx+ecx*2]
		cmp	edx, ecx
		jnb	short loc_10007B96
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WXZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Pninc(void)
		mov	[eax], bp
		mov	ax, bp
		jmp	loc_10007CEC
; ---------------------------------------------------------------------------

loc_10007B96:				; CODE XREF: sub_10007B14+61j
					; sub_10007B14+6Dj
		push	ebx
		test	edx, edx
		jnz	short loc_10007B9F
		xor	ebx, ebx
		jmp	short loc_10007BAF
; ---------------------------------------------------------------------------

loc_10007B9F:				; CODE XREF: sub_10007B14+85j
		mov	eax, [esi+30h]
		mov	ebx, [eax]
		mov	eax, [esi+0Ch]
		add	ebx, ebx
		sub	ebx, [eax]
		add	ebx, edx
		sar	ebx, 1

loc_10007BAF:				; CODE XREF: sub_10007B14+89j
		mov	eax, ebx
		push	20h
		shr	eax, 1
		pop	ecx
		cmp	eax, ecx
		jb	short loc_10007BC0
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_10007BD3

loc_10007BC0:				; CODE XREF: sub_10007B14+A4j
					; sub_10007B14+B9j
		mov	eax, 7FFFFFFFh
		sub	eax, ecx
		cmp	eax, ebx
		jnb	short loc_10007BCF
		shr	ecx, 1
		jnz	short loc_10007BC0

loc_10007BCF:				; CODE XREF: sub_10007B14+B5j
		test	ecx, ecx
		jnz	short loc_10007BDB

loc_10007BD3:				; CODE XREF: sub_10007B14+AAj
		mov	ax, di
		jmp	loc_10007CEB
; ---------------------------------------------------------------------------

loc_10007BDB:				; CODE XREF: sub_10007B14+BDj
		lea	eax, [ecx+ebx]
		push	0
		push	eax
		mov	[esp+1Ch+var_4], eax
		call	sub_10001DBA
		mov	edi, eax
		pop	ecx
		pop	ecx
		mov	ecx, [esi+0Ch]
		mov	ecx, [ecx]
		mov	[esp+14h+arg_0], ecx
		test	ebx, ebx
		jz	short loc_10007C0E
		push	ebx		; int
		push	ecx		; void *
		push	edi		; void *
		call	sub_10002435
		mov	ecx, [esp+20h+arg_0]
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_10007C4A

loc_10007C0E:				; CODE XREF: sub_10007B14+E5j
		mov	eax, [esi+10h]
		mov	ecx, [esp+14h+var_4]
		mov	ebx, [esp+14h+arg_0]
		add	ecx, ecx
		mov	[esi+38h], edi
		mov	[eax], edi
		mov	eax, [esi+20h]
		sar	ecx, 1
		mov	[eax], edi
		mov	eax, [esi+30h]
		mov	[eax], ecx
		mov	eax, [esi+0Ch]
		test	byte ptr [esi+3Ch], 4
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		jnz	short loc_10007C99
		mov	[eax], edi
		mov	eax, [esi+2Ch]
		mov	dword ptr [eax], 1
		jmp	loc_10007CCC
; ---------------------------------------------------------------------------

loc_10007C4A:				; CODE XREF: sub_10007B14+F8j
		mov	eax, [esi+38h]
		sub	eax, ecx
		mov	ebx, [esp+14h+arg_0]
		sar	eax, 1
		lea	eax, [edi+eax*2]
		mov	[esi+38h], eax
		mov	eax, [esi+20h]
		mov	eax, [eax]
		sub	eax, ecx
		mov	ecx, [esi+10h]
		sar	eax, 1
		lea	edx, [edi+eax*2]
		mov	eax, [ecx]
		sub	eax, ebx
		sar	eax, 1
		lea	eax, [edi+eax*2]
		mov	[ecx], eax
		mov	eax, [esi+20h]
		mov	ecx, [esp+14h+var_4]
		add	ecx, ecx
		sub	ecx, edx
		mov	[eax], edx
		add	ecx, edi
		mov	eax, [esi+30h]
		sar	ecx, 1
		mov	[eax], ecx
		test	byte ptr [esi+3Ch], 4
		jz	short loc_10007CA5
		mov	eax, [esi+0Ch]
		mov	[eax], edi
		mov	eax, [esi+1Ch]

loc_10007C99:				; CODE XREF: sub_10007B14+124j
		and	dword ptr [eax], 0
		mov	eax, [esi+2Ch]
		sar	edi, 1
		mov	[eax], edi
		jmp	short loc_10007CCC
; ---------------------------------------------------------------------------

loc_10007CA5:				; CODE XREF: sub_10007B14+17Bj
		mov	eax, [esi+20h]
		mov	edx, [eax]
		mov	eax, [esi+1Ch]
		mov	eax, [eax]
		sub	eax, ebx
		sar	eax, 1
		lea	ecx, [edi+eax*2]
		mov	eax, [esi+0Ch]
		sub	edx, ecx
		add	edx, 2
		sar	edx, 1
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], edx

loc_10007CCC:				; CODE XREF: sub_10007B14+131j
					; sub_10007B14+18Fj
		test	byte ptr [esi+3Ch], 1
		jz	short loc_10007CD9
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10007CD9:				; CODE XREF: sub_10007B14+1BCj
		or	dword ptr [esi+3Ch], 1
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WXZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Pninc(void)
		mov	[eax], bp
		mov	ax, bp

loc_10007CEB:				; CODE XREF: sub_10007B14+C2j
		pop	ebx

loc_10007CEC:				; CODE XREF: sub_10007B14+27j
					; sub_10007B14+7Dj
		pop	edi
		pop	ebp

loc_10007CEE:				; CODE XREF: sub_10007B14+Fj
		pop	esi
		pop	ecx
		retn	4
sub_10007B14	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007CF3	proc near		; DATA XREF: .rdata:1001CF58o

arg_0		= word ptr  4

		push	ebx
		push	esi
		mov	esi, ecx
		mov	ebx, 0FFFFh
		push	edi
		mov	eax, [esi+1Ch]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_10007D43
		mov	eax, [esi+0Ch]
		cmp	ecx, [eax]
		jbe	short loc_10007D43
		mov	di, [esp+0Ch+arg_0]
		cmp	bx, di
		jz	short loc_10007D23
		cmp	di, [ecx-2]
		jz	short loc_10007D23
		test	byte ptr [esi+3Ch], 2
		jnz	short loc_10007D43

loc_10007D23:				; CODE XREF: sub_10007CF3+22j
					; sub_10007CF3+28j
		push	0FFFFFFFFh
		mov	ecx, esi
		call	ds:?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::gbump(int)
		cmp	bx, di
		jz	short loc_10007D3F
		mov	eax, [esi+1Ch]
		mov	eax, [eax]
		mov	[eax], di
		movzx	eax, di
		jmp	short loc_10007D46
; ---------------------------------------------------------------------------

loc_10007D3F:				; CODE XREF: sub_10007CF3+3Dj
		xor	eax, eax
		jmp	short loc_10007D46
; ---------------------------------------------------------------------------

loc_10007D43:				; CODE XREF: sub_10007CF3+11j
					; sub_10007CF3+18j ...
		mov	ax, bx

loc_10007D46:				; CODE XREF: sub_10007CF3+4Aj
					; sub_10007CF3+4Ej
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_10007CF3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007D4C	proc near		; DATA XREF: .rdata:1001CF70o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= byte ptr  14h

		push	ecx
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	edx, [ebx+20h]
		mov	eax, [edx]
		test	eax, eax
		jz	short loc_10007D64
		cmp	[ebx+38h], eax
		jnb	short loc_10007D64
		mov	[ebx+38h], eax

loc_10007D64:				; CODE XREF: sub_10007D4C+Ej
					; sub_10007D4C+13j
		test	[esp+14h+arg_10], 1
		jz	loc_10007E43
		mov	eax, [ebx+1Ch]
		mov	esi, [eax]
		mov	[esp+14h+var_4], esi
		test	esi, esi
		jz	loc_10007E43
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10007D94
		mov	eax, [ebx+38h]
		jmp	short loc_10007DA2
; ---------------------------------------------------------------------------

loc_10007D94:				; CODE XREF: sub_10007D4C+41j
		cmp	eax, 1
		jnz	short loc_10007DB8
		test	[esp+14h+arg_10], 2
		jnz	short loc_10007DBC
		mov	eax, esi

loc_10007DA2:				; CODE XREF: sub_10007D4C+46j
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		sar	eax, 1
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10007DCC
; ---------------------------------------------------------------------------

loc_10007DB8:				; CODE XREF: sub_10007D4C+4Bj
		test	eax, eax
		jz	short loc_10007DC4

loc_10007DBC:				; CODE XREF: sub_10007D4C+52j
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10007DCC
; ---------------------------------------------------------------------------

loc_10007DC4:				; CODE XREF: sub_10007D4C+6Ej
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10007DCC:				; CODE XREF: sub_10007D4C+6Aj
					; sub_10007D4C+76j
		test	edi, edi
		jl	loc_10007ED1
		jg	short loc_10007DDE
		test	esi, esi
		jb	loc_10007ED1

loc_10007DDE:				; CODE XREF: sub_10007D4C+88j
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	edi, edx
		jg	loc_10007ED1
		jl	short loc_10007DFD
		cmp	esi, eax
		ja	loc_10007ED1

loc_10007DFD:				; CODE XREF: sub_10007D4C+A7j
		sub	ecx, [esp+14h+var_4]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, ebx
		call	ds:?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::gbump(int)
		test	[esp+14h+arg_10], 2
		jz	loc_10007EF1
		mov	edx, [ebx+20h]
		mov	ecx, [edx]
		test	ecx, ecx
		jz	loc_10007EF1
		mov	eax, [ebx+30h]
		mov	eax, [eax]
		lea	ecx, [ecx+eax*2]
		mov	eax, [ebx+1Ch]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [ebx+30h]
		sar	ecx, 1
		mov	[eax], ecx
		jmp	loc_10007EF1
; ---------------------------------------------------------------------------

loc_10007E43:				; CODE XREF: sub_10007D4C+1Dj
					; sub_10007D4C+2Ej
		test	[esp+14h+arg_10], 2
		jz	loc_10007ED9
		cmp	dword ptr [edx], 0
		jz	loc_10007ED9
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10007E6B
		mov	eax, [ebx+38h]
		jmp	short loc_10007E72
; ---------------------------------------------------------------------------

loc_10007E6B:				; CODE XREF: sub_10007D4C+118j
		cmp	eax, 1
		jnz	short loc_10007E88
		mov	eax, [edx]

loc_10007E72:				; CODE XREF: sub_10007D4C+11Dj
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		sar	eax, 1
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10007E9C
; ---------------------------------------------------------------------------

loc_10007E88:				; CODE XREF: sub_10007D4C+122j
		test	eax, eax
		jz	short loc_10007E94
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10007E9C
; ---------------------------------------------------------------------------

loc_10007E94:				; CODE XREF: sub_10007D4C+13Ej
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10007E9C:				; CODE XREF: sub_10007D4C+13Aj
					; sub_10007D4C+146j
		test	edi, edi
		jl	short loc_10007ED1
		jg	short loc_10007EA6
		test	esi, esi
		jb	short loc_10007ED1

loc_10007EA6:				; CODE XREF: sub_10007D4C+154j
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	edi, edx
		jg	short loc_10007ED1
		jl	short loc_10007EBD
		cmp	esi, eax
		ja	short loc_10007ED1

loc_10007EBD:				; CODE XREF: sub_10007D4C+16Bj
		mov	eax, [ebx+20h]
		sub	ecx, [eax]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, ebx
		call	ds:?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::pbump(int)
		jmp	short loc_10007EF1
; ---------------------------------------------------------------------------

loc_10007ED1:				; CODE XREF: sub_10007D4C+82j
					; sub_10007D4C+8Cj ...
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10007EF1
; ---------------------------------------------------------------------------

loc_10007ED9:				; CODE XREF: sub_10007D4C+FCj
					; sub_10007D4C+105j
		mov	esi, [esp+14h+arg_4]
		mov	eax, esi
		mov	edi, [esp+14h+arg_8]
		or	eax, edi
		jz	short loc_10007EF1
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	esi, [eax]
		mov	edi, [eax+4]

loc_10007EF1:				; CODE XREF: sub_10007D4C+C7j
					; sub_10007D4C+D4j ...
		mov	eax, [esp+14h+arg_0]
		xor	ecx, ecx
		mov	[eax+4], edi
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		pop	ebx
		pop	ecx
		retn	14h
sub_10007D4C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007F0D	proc near		; DATA XREF: .rdata:1001CF74o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_1C		= byte ptr  20h

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_4]
		add	esi, [esp+14h+arg_C]
		push	edi
		adc	ebx, [esp+18h+arg_10]
		mov	edi, ecx
		mov	edx, [edi+20h]
		mov	eax, [edx]
		test	eax, eax
		jz	short loc_10007F36
		cmp	[edi+38h], eax
		jnb	short loc_10007F36
		mov	[edi+38h], eax

loc_10007F36:				; CODE XREF: sub_10007F0D+1Fj
					; sub_10007F0D+24j
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	ecx, [eax]
		mov	ebp, [eax+4]
		mov	eax, ecx
		mov	[esp+18h+var_8], ecx
		cmp	esi, eax
		jnz	short loc_10007F52
		cmp	ebx, ebp
		jz	loc_1000800F

loc_10007F52:				; CODE XREF: sub_10007F0D+3Bj
		test	[esp+18h+arg_1C], 1
		jz	short loc_10007FCA
		mov	eax, [edi+1Ch]
		mov	eax, [eax]
		mov	[esp+18h+var_4], eax
		test	eax, eax
		jz	short loc_10007FC8
		test	ebx, ebx
		jl	short loc_10007FC2
		jg	short loc_10007F70
		test	esi, esi
		jb	short loc_10007FC2

loc_10007F70:				; CODE XREF: sub_10007F0D+5Dj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	ebx, edx
		jg	short loc_10007FC2
		jl	short loc_10007F87
		cmp	esi, eax
		ja	short loc_10007FC2

loc_10007F87:				; CODE XREF: sub_10007F0D+74j
		sub	ecx, [esp+18h+var_4]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, edi
		call	ds:?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::gbump(int)
		test	[esp+18h+arg_1C], 2
		jz	short loc_1000800F
		mov	edx, [edi+20h]
		mov	ecx, [edx]
		test	ecx, ecx
		jz	short loc_1000800F
		mov	eax, [edi+30h]
		mov	eax, [eax]
		lea	ecx, [ecx+eax*2]
		mov	eax, [edi+1Ch]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [edi+30h]
		sar	ecx, 1
		mov	[eax], ecx
		jmp	short loc_1000800F
; ---------------------------------------------------------------------------

loc_10007FC2:				; CODE XREF: sub_10007F0D+5Bj
					; sub_10007F0D+61j ...
		mov	esi, [esp+18h+var_8]
		jmp	short loc_1000800D
; ---------------------------------------------------------------------------

loc_10007FC8:				; CODE XREF: sub_10007F0D+57j
		mov	eax, ecx

loc_10007FCA:				; CODE XREF: sub_10007F0D+4Aj
		test	[esp+18h+arg_1C], 2
		jz	short loc_1000800B
		cmp	dword ptr [edx], 0
		jz	short loc_1000800B
		test	ebx, ebx
		jl	short loc_10007FC2
		jg	short loc_10007FE0
		test	esi, esi
		jb	short loc_10007FC2

loc_10007FE0:				; CODE XREF: sub_10007F0D+CDj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	ebx, edx
		jg	short loc_10007FC2
		jl	short loc_10007FF7
		cmp	esi, eax
		ja	short loc_10007FC2

loc_10007FF7:				; CODE XREF: sub_10007F0D+E4j
		mov	eax, [edi+20h]
		sub	ecx, [eax]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, edi
		call	ds:?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::pbump(int)
		jmp	short loc_1000800F
; ---------------------------------------------------------------------------

loc_1000800B:				; CODE XREF: sub_10007F0D+C2j
					; sub_10007F0D+C7j
		mov	esi, eax

loc_1000800D:				; CODE XREF: sub_10007F0D+B9j
		mov	ebx, ebp

loc_1000800F:				; CODE XREF: sub_10007F0D+3Fj
					; sub_10007F0D+90j ...
		mov	eax, [esp+18h+arg_0]
		pop	edi
		and	dword ptr [eax+8], 0
		and	dword ptr [eax+0Ch], 0
		and	dword ptr [eax+10h], 0
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+4], ebx
		pop	ebx
		pop	ecx
		pop	ecx
		retn	20h
sub_10007F0D	endp

; ---------------------------------------------------------------------------

loc_1000802D:				; DATA XREF: sub_1000774A+B4o
		mov	eax, [esp+4]
		or	dword ptr [eax+14h], 8
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10008036	proc near		; CODE XREF: sub_1000774A+106p

var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	edx, ecx
		push	esi
		mov	esi, [ebp+arg_0]
		test	byte ptr [edx+3Ch], 2
		jnz	short loc_1000808E
		mov	eax, [edx+20h]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000808E
		cmp	[edx+38h], ecx
		jb	short loc_10008063
		mov	ecx, [edx+38h]

loc_10008063:				; CODE XREF: sub_10008036+28j
		mov	eax, [edx+10h]
		sub	ecx, [eax]
		sar	ecx, 1
		push	ecx		; int
		push	dword ptr [eax]	; void *
		lea	ecx, [ebp+var_1C]
		call	sub_10002AFE
		lea	eax, [ebp+var_1C]
		mov	ecx, esi
		push	eax		; void *
		call	sub_10003AFA
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1
		jmp	short loc_100080E5
; ---------------------------------------------------------------------------

loc_1000808E:				; CODE XREF: sub_10008036+1Aj
					; sub_10008036+23j
		test	byte ptr [edx+3Ch], 4
		push	edi
		jnz	short loc_100080BC
		mov	eax, [edx+1Ch]
		mov	edi, [eax]
		test	edi, edi
		jz	short loc_100080BC
		mov	eax, [edx+0Ch]
		mov	ecx, [eax]
		mov	eax, [edx+2Ch]
		mov	eax, [eax]
		add	eax, eax
		sub	eax, ecx
		add	eax, edi
		sar	eax, 1
		push	eax		; int
		push	ecx		; void *
		lea	ecx, [ebp+var_1C]
		call	sub_10002AFE
		jmp	short loc_100080CD
; ---------------------------------------------------------------------------

loc_100080BC:				; CODE XREF: sub_10008036+5Dj
					; sub_10008036+66j
		and	[ebp+var_C], 0
		xor	eax, eax
		mov	[ebp+var_8], 7
		mov	[ebp+var_1C], ax

loc_100080CD:				; CODE XREF: sub_10008036+84j
		lea	eax, [ebp+var_1C]
		mov	ecx, esi
		push	eax		; void *
		call	sub_10003AFA
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1
		pop	edi

loc_100080E5:				; CODE XREF: sub_10008036+56j
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10008036	endp


; =============== S U B	R O U T	I N E =======================================


sub_100080F8	proc near		; DATA XREF: .rdata:1001CF60o
		mov	edx, ecx
		push	esi
		push	edi
		mov	edi, [edx+1Ch]
		mov	esi, [edi]
		test	esi, esi
		jnz	short loc_1000810C
		mov	eax, 0FFFFh
		jmp	short loc_10008157
; ---------------------------------------------------------------------------

loc_1000810C:				; CODE XREF: sub_100080F8+Bj
		push	ebx
		mov	ebx, [edx+2Ch]
		mov	ecx, [ebx]
		lea	ecx, [esi+ecx*2]
		cmp	esi, ecx
		jnb	short loc_1000811E
		mov	ax, [esi]
		jmp	short loc_10008156
; ---------------------------------------------------------------------------

loc_1000811E:				; CODE XREF: sub_100080F8+1Fj
		test	byte ptr [edx+3Ch], 4
		jnz	short loc_10008151
		mov	eax, [edx+20h]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_10008151
		cmp	eax, esi
		ja	short loc_10008136
		cmp	[edx+38h], esi
		jbe	short loc_10008151

loc_10008136:				; CODE XREF: sub_100080F8+37j
		cmp	[edx+38h], eax
		jnb	short loc_1000813E
		mov	[edx+38h], eax

loc_1000813E:				; CODE XREF: sub_100080F8+41j
		mov	eax, [edx+38h]
		sub	eax, [edi]
		sar	eax, 1
		mov	[ebx], eax
		mov	eax, [edx+1Ch]
		mov	eax, [eax]
		mov	ax, [eax]
		jmp	short loc_10008156
; ---------------------------------------------------------------------------

loc_10008151:				; CODE XREF: sub_100080F8+2Aj
					; sub_100080F8+33j ...
		mov	eax, 0FFFFh

loc_10008156:				; CODE XREF: sub_100080F8+24j
					; sub_100080F8+57j
		pop	ebx

loc_10008157:				; CODE XREF: sub_100080F8+12j
		pop	edi
		pop	esi
		retn
sub_100080F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000815A(HANDLE handle, SE_OBJECT_TYPE ObjectType, int, int, int)
sub_1000815A	proc near		; CODE XREF: sub_1001A759+141p

ppDacl		= dword	ptr -54h
pDacl		= dword	ptr -50h
ppSecurityDescriptor= dword ptr	-4Ch
pDestinationSid	= byte ptr -48h
var_4		= dword	ptr -4
handle		= dword	ptr  8
ObjectType	= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+handle]
		lea	eax, [ebp+ppSecurityDescriptor]
		push	edi
		mov	edi, [ebp+arg_8]
		xor	ebx, ebx
		push	eax		; ppSecurityDescriptor
		push	ebx		; ppSacl
		lea	eax, [ebp+ppDacl]
		mov	[ebp+ppSecurityDescriptor], ebx
		push	eax		; ppDacl
		push	ebx		; ppsidGroup
		push	ebx		; ppsidOowner
		push	4		; SecurityInfo
		push	[ebp+ObjectType] ; ObjectType
		mov	[ebp+ppDacl], ebx
		push	esi		; handle
		mov	[ebp+pDacl], ebx
		call	ds:GetSecurityInfo
		test	eax, eax
		jz	short loc_1000819D

loc_10008199:				; CODE XREF: sub_1000815A+79j
		xor	al, al
		jmp	short loc_100081FE
; ---------------------------------------------------------------------------

loc_1000819D:				; CODE XREF: sub_1000815A+3Dj
		mov	ecx, edi
		call	sub_10017FC3
		push	eax		; pSourceSid
		lea	ecx, [ebp+pDestinationSid] ; pDestinationSid
		call	sub_10017F82
		lea	eax, [ebp+pDacl]
		push	eax		; NewAcl
		push	[ebp+arg_10]	; int
		lea	eax, [ebp+pDestinationSid]
		push	[ebp+arg_C]	; int
		push	[ebp+ppDacl]	; OldAcl
		push	eax		; int
		call	sub_1000820F
		add	esp, 14h
		test	al, al
		jnz	short loc_100081D5
		push	[ebp+ppSecurityDescriptor] ; hMem
		call	ds:LocalFree
		jmp	short loc_10008199
; ---------------------------------------------------------------------------

loc_100081D5:				; CODE XREF: sub_1000815A+6Ej
		push	ebx		; pSacl
		push	[ebp+pDacl]	; pDacl
		push	ebx		; psidGroup
		push	ebx		; psidOowner
		push	4		; SecurityInfo
		push	[ebp+ObjectType] ; ObjectType
		push	esi		; handle
		call	ds:SetSecurityInfo
		push	[ebp+pDacl]	; hMem
		mov	esi, ds:LocalFree
		mov	edi, eax
		call	esi ; LocalFree
		push	[ebp+ppSecurityDescriptor] ; hMem
		call	esi ; LocalFree
		test	edi, edi
		setz	al

loc_100081FE:				; CODE XREF: sub_1000815A+41j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1000815A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000820F(int,	PACL OldAcl, int, int, PACL *NewAcl)
sub_1000820F	proc near		; CODE XREF: sub_1000815A+64p
					; sub_10008262+3Cp

pListOfExplicitEntries=	_EXPLICIT_ACCESS_W ptr -20h
arg_0		= dword	ptr  8
OldAcl		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
NewAcl		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		push	edi
		xor	eax, eax
		lea	edi, [ebp+pListOfExplicitEntries.grfAccessMode]
		push	7
		pop	ecx
		rep stosd
		mov	eax, [ebp+arg_8]
		mov	ecx, [ebp+arg_0]
		mov	[ebp+pListOfExplicitEntries.grfAccessMode], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+pListOfExplicitEntries.grfAccessPermissions], eax
		xor	eax, eax
		mov	[ebp+pListOfExplicitEntries.grfInheritance], eax
		mov	[ebp+pListOfExplicitEntries.Trustee.pMultipleTrustee], eax
		mov	[ebp+pListOfExplicitEntries.Trustee.MultipleTrusteeOperation], eax
		mov	[ebp+pListOfExplicitEntries.Trustee.TrusteeForm], eax
		call	sub_10017FC3
		push	[ebp+NewAcl]	; NewAcl
		mov	[ebp+pListOfExplicitEntries.Trustee.ptstrName],	eax
		lea	eax, [ebp+pListOfExplicitEntries]
		push	[ebp+OldAcl]	; OldAcl
		push	eax		; pListOfExplicitEntries
		push	1		; cCountOfExplicitEntries
		call	ds:SetEntriesInAclW
		neg	eax
		pop	edi
		sbb	al, al
		inc	al
		mov	esp, ebp
		pop	ebp
		retn
sub_1000820F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10008262(HANDLE TokenHandle, int, int)
sub_10008262	proc near		; CODE XREF: sub_100082E5+4Fp
					; sub_10014AFC+210p

TokenInformation= dword	ptr -8
var_4		= dword	ptr -4
TokenHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	edi
		mov	edi, [ebp+TokenHandle]
		test	edi, edi
		jnz	short loc_10008273
		xor	al, al
		jmp	short loc_100082E0
; ---------------------------------------------------------------------------

loc_10008273:				; CODE XREF: sub_10008262+Bj
		push	ebx
		push	esi
		lea	eax, [ebp+var_4]
		xor	ebx, ebx
		push	eax		; int
		push	edi		; TokenHandle
		mov	[ebp+var_4], ebx
		call	sub_1000835D
		mov	esi, [ebp+var_4]
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_100082D0
		lea	eax, [ebp+TokenHandle]
		mov	[ebp+TokenHandle], ebx
		push	eax		; NewAcl
		push	[ebp+arg_8]	; int
		push	1		; int
		push	dword ptr [esi]	; OldAcl
		push	[ebp+arg_4]	; int
		call	sub_1000820F
		add	esp, 14h
		test	al, al
		jz	short loc_100082D0
		mov	eax, [ebp+TokenHandle]
		push	4		; TokenInformationLength
		mov	[ebp+TokenInformation],	eax
		lea	eax, [ebp+TokenInformation]
		push	eax		; TokenInformation
		push	6		; TokenInformationClass
		push	edi		; TokenHandle
		call	ds:SetTokenInformation
		push	[ebp+TokenHandle] ; hMem
		mov	edi, eax
		call	ds:LocalFree
		cmp	edi, 1
		setz	bl

loc_100082D0:				; CODE XREF: sub_10008262+29j
					; sub_10008262+46j
		test	esi, esi
		jz	short loc_100082DC
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_100082DC:				; CODE XREF: sub_10008262+70j
		pop	esi
		mov	al, bl
		pop	ebx

loc_100082E0:				; CODE XREF: sub_10008262+Fj
		pop	edi
		mov	esp, ebp
		pop	ebp
		retn
sub_10008262	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100082E5(HANDLE TokenHandle, int)
sub_100082E5	proc near		; CODE XREF: sub_10014AFC+221p

ReturnLength	= dword	ptr -4Ch
pDestinationSid	= byte ptr -48h
var_4		= dword	ptr -4
TokenHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+TokenHandle]
		push	4Ch
		pop	ebx
		push	ebx		; size_t
		mov	[ebp+ReturnLength], ebx
		call	ds:malloc
		pop	ecx
		mov	esi, eax
		lea	eax, [ebp+ReturnLength]
		push	eax		; ReturnLength
		push	ebx		; TokenInformationLength
		push	esi		; TokenInformation
		push	1		; TokenInformationClass
		push	edi		; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_10008322
		xor	bl, bl
		jmp	short loc_1000833E
; ---------------------------------------------------------------------------

loc_10008322:				; CODE XREF: sub_100082E5+37j
		push	dword ptr [esi]	; pSourceSid
		lea	ecx, [ebp+pDestinationSid] ; pDestinationSid
		call	sub_10017F82
		push	[ebp+arg_4]	; int
		lea	eax, [ebp+pDestinationSid]
		push	eax		; int
		push	edi		; TokenHandle
		call	sub_10008262
		add	esp, 0Ch
		mov	bl, al

loc_1000833E:				; CODE XREF: sub_100082E5+3Bj
		test	esi, esi
		jz	short loc_1000834A
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_1000834A:				; CODE XREF: sub_100082E5+5Bj
		mov	ecx, [ebp+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100082E5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000835D(HANDLE TokenHandle, int)
sub_1000835D	proc near		; CODE XREF: sub_10008262+1Dp

ReturnLength	= dword	ptr -4
TokenHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		xor	ecx, ecx
		mov	[ebp+ReturnLength], ecx
		cmp	[ebp+TokenHandle], ecx
		jnz	short loc_1000836F

loc_1000836B:				; CODE XREF: sub_1000835D+2Aj
		xor	al, al
		jmp	short loc_100083B9
; ---------------------------------------------------------------------------

loc_1000836F:				; CODE XREF: sub_1000835D+Cj
		lea	eax, [ebp+ReturnLength]
		mov	[ebp+ReturnLength], ecx
		push	eax		; ReturnLength
		push	ecx		; TokenInformationLength
		push	ecx		; TokenInformation
		push	6		; TokenInformationClass
		push	[ebp+TokenHandle] ; TokenHandle
		call	ds:GetTokenInformation
		cmp	[ebp+ReturnLength], 0
		jz	short loc_1000836B
		push	esi
		push	[ebp+ReturnLength] ; size_t
		call	ds:malloc
		mov	esi, [ebp+arg_4]
		pop	ecx
		push	eax
		mov	ecx, esi
		call	sub_100083BD
		lea	eax, [ebp+ReturnLength]
		push	eax		; ReturnLength
		push	[ebp+ReturnLength] ; TokenInformationLength
		push	dword ptr [esi]	; TokenInformation
		push	6		; TokenInformationClass
		push	[ebp+TokenHandle] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		pop	esi
		setnz	al

loc_100083B9:				; CODE XREF: sub_1000835D+10j
		mov	esp, ebp
		pop	ebp
		retn
sub_1000835D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100083BD	proc near		; CODE XREF: sub_1000835D+3Dp
					; sub_1000D022+41p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		and	dword ptr [esi], 0
		test	eax, eax
		jz	short loc_100083D1
		push	eax		; void *
		call	ds:free
		pop	ecx

loc_100083D1:				; CODE XREF: sub_100083BD+Aj
		mov	eax, [esp+4+arg_0]
		mov	[esi], eax
		pop	esi
		retn	4
sub_100083BD	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100083DB(LPCSTR lpProcName)
sub_100083DB	proc near		; CODE XREF: sub_100084A7+34p
					; sub_10008522+34p ...

lpProcName	= dword	ptr  4

		push	offset aKernel32_dll_1 ; "kernel32.dll"
		call	ds:GetModuleHandleW
		push	[esp+lpProcName] ; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jnz	short locret_1000840B
		push	offset aKernelbase_dll ; "kernelbase.dll"
		call	ds:GetModuleHandleW
		push	[esp+lpProcName] ; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress

locret_1000840B:			; CODE XREF: sub_100083DB+18j
		retn
sub_100083DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000840C	proc near		; CODE XREF: sub_10014EF1+1Ep

var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	[ebp+arg_8]
		lea	eax, [ebp+var_1]
		push	0
		push	eax
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10014529
		add	esp, 18h
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000840C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008430	proc near		; CODE XREF: sub_10016CB4+44p
		push	edi
		xor	eax, eax
		mov	edi, ecx
		mov	[ecx+10h], eax
		mov	[ecx+14h], eax
		mov	[ecx+18h], eax
		stosd
		stosd
		stosd
		stosd
		mov	eax, ecx
		pop	edi
		retn
sub_10008430	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008446	proc near		; CODE XREF: sub_10016398+Bp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		xor	edi, edi
		lea	esi, [ebx+10h]
		mov	eax, [esi+4]
		sub	eax, [esi]
		sar	eax, 3
		test	eax, eax
		jz	short loc_10008474

loc_1000845C:				; CODE XREF: sub_10008446+2Cj
		mov	eax, [esi]
		push	dword ptr [eax+edi*8] ;	hMem
		call	ds:LocalFree
		mov	eax, [esi+4]
		inc	edi
		sub	eax, [esi]
		sar	eax, 3
		cmp	edi, eax
		jb	short loc_1000845C

loc_10008474:				; CODE XREF: sub_10008446+14j
		push	dword ptr [ebx]	; hMem
		call	ds:LocalFree
		pop	edi
		mov	ecx, esi
		pop	esi
		pop	ebx
		jmp	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime
sub_10008446	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10008486(LPCWSTR StringSid)
sub_10008486	proc near		; CODE XREF: sub_10008664+10p
					; sub_10008664+42p

StringSid	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+StringSid]
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10008494
		mov	eax, [eax]

loc_10008494:				; CODE XREF: sub_10008486+Aj
		lea	ecx, [ebp+StringSid]
		push	ecx		; Sid
		push	eax		; StringSid
		call	ConvertStringSidToSidW
		neg	eax
		sbb	eax, eax
		and	eax, [ebp+StringSid]
		pop	ebp
		retn
sub_10008486	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100084A7(LPCWSTR StringSid, int)
sub_100084A7	proc near		; CODE XREF: sub_1000942D+6Fp

var_4		= dword	ptr -4
StringSid	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+StringSid]
		and	[ebp+var_4], 0
		cmp	dword ptr [eax+14h], 8
		jb	short loc_100084BA
		mov	eax, [eax]

loc_100084BA:				; CODE XREF: sub_100084A7+Fj
		lea	ecx, [ebp+StringSid]
		push	ecx		; Sid
		push	eax		; StringSid
		call	ConvertStringSidToSidW
		test	eax, eax
		jnz	short loc_100084CD
		push	0Eh
		pop	eax
		jmp	short loc_1000851E
; ---------------------------------------------------------------------------

loc_100084CD:				; CODE XREF: sub_100084A7+1Fj
		mov	eax, dword_10033C1C
		test	eax, eax
		jnz	short loc_100084E6
		push	offset aAppcontainerre ; "AppContainerRegisterSid"
		call	sub_100083DB
		pop	ecx
		mov	dword_10033C1C,	eax

loc_100084E6:				; CODE XREF: sub_100084A7+2Dj
		push	esi
		xor	esi, esi
		inc	esi
		test	eax, eax
		jz	short loc_10008512
		mov	ecx, [ebp+arg_4]
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_100084FB
		mov	edx, [ecx]
		jmp	short loc_100084FD
; ---------------------------------------------------------------------------

loc_100084FB:				; CODE XREF: sub_100084A7+4Ej
		mov	edx, ecx

loc_100084FD:				; CODE XREF: sub_100084A7+52j
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_10008505
		mov	ecx, [ecx]

loc_10008505:				; CODE XREF: sub_100084A7+5Aj
		push	edx
		push	ecx
		push	[ebp+StringSid]
		call	eax ; dword_10033C1C
		test	eax, eax
		js	short loc_10008512
		xor	esi, esi

loc_10008512:				; CODE XREF: sub_100084A7+45j
					; sub_100084A7+67j
		push	[ebp+StringSid]	; hMem
		call	ds:LocalFree
		mov	eax, esi
		pop	esi

loc_1000851E:				; CODE XREF: sub_100084A7+24j
		mov	esp, ebp
		pop	ebp
		retn
sub_100084A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10008522(LPCWSTR StringSid)
sub_10008522	proc near		; CODE XREF: sub_10009C9F+5Fp

var_4		= dword	ptr -4
StringSid	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+StringSid]
		and	[ebp+var_4], 0
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10008535
		mov	eax, [eax]

loc_10008535:				; CODE XREF: sub_10008522+Fj
		lea	ecx, [ebp+StringSid]
		push	ecx		; Sid
		push	eax		; StringSid
		call	ConvertStringSidToSidW
		test	eax, eax
		jnz	short loc_10008548
		push	0Eh
		pop	eax
		jmp	short loc_10008580
; ---------------------------------------------------------------------------

loc_10008548:				; CODE XREF: sub_10008522+1Fj
		mov	eax, dword_10033C20
		test	eax, eax
		jnz	short loc_10008561
		push	offset aAppcontainerun ; "AppContainerUnregisterSid"
		call	sub_100083DB
		pop	ecx
		mov	dword_10033C20,	eax

loc_10008561:				; CODE XREF: sub_10008522+2Dj
		push	esi
		xor	esi, esi
		inc	esi
		test	eax, eax
		jz	short loc_10008574
		push	[ebp+StringSid]
		call	eax ; dword_10033C20
		test	eax, eax
		js	short loc_10008574
		xor	esi, esi

loc_10008574:				; CODE XREF: sub_10008522+45j
					; sub_10008522+4Ej
		push	[ebp+StringSid]	; hMem
		call	ds:LocalFree
		mov	eax, esi
		pop	esi

loc_10008580:				; CODE XREF: sub_10008522+24j
		mov	esp, ebp
		pop	ebp
		retn
sub_10008522	endp

; [00000008 BYTES: COLLAPSED FUNCTION std::_Iterator_base_secure::_Has_container(void)]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000858C(int,	LPCWSTR	StringSid)
sub_1000858C	proc near		; CODE XREF: sub_1000942D+3Cp
					; sub_10009C9F+34p

lpProcName	= dword	ptr -30h
Sid		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
StringSid	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+StringSid]
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		xor	edi, edi
		mov	[ebp+Sid], edi
		cmp	dword ptr [eax+14h], 8
		jb	short loc_100085B1
		mov	eax, [eax]

loc_100085B1:				; CODE XREF: sub_1000858C+21j
		lea	ecx, [ebp+Sid]
		push	ecx		; Sid
		push	eax		; StringSid
		call	ConvertStringSidToSidW
		test	eax, eax
		jz	loc_10008643
		mov	eax, dword_10033C24
		test	eax, eax
		jz	short loc_100085D6
		mov	ecx, dword_10033C28
		test	ecx, ecx
		jnz	short loc_100085FF

loc_100085D6:				; CODE XREF: sub_1000858C+3Ej
		push	offset aAppcontainerlo ; "AppContainerLookupMoniker"
		call	sub_100083DB
		mov	dword_10033C24,	eax
		mov	[esp+30h+lpProcName], offset aAppcontainerfr ; "AppContainerFreeMemory"
		call	sub_100083DB
		pop	ecx
		mov	ecx, eax
		mov	eax, dword_10033C24
		mov	dword_10033C28,	ecx

loc_100085FF:				; CODE XREF: sub_1000858C+48j
		test	eax, eax
		jz	short loc_10008643
		test	ecx, ecx
		jz	short loc_10008643
		lea	ecx, [ebp+var_20]
		mov	[ebp+var_20], edi
		push	ecx
		push	[ebp+Sid]
		call	eax ; dword_10033C24
		test	eax, eax
		js	short loc_10008643
		push	[ebp+var_20]	; void *
		lea	ecx, [ebp+var_1C]
		call	sub_10001E8D
		push	[ebp+var_20]
		call	dword_10033C28
		lea	eax, [ebp+var_1C]
		mov	ecx, esi
		push	eax		; void *
		call	sub_10003AFA
		push	edi		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1
		jmp	short loc_10008652
; ---------------------------------------------------------------------------

loc_10008643:				; CODE XREF: sub_1000858C+31j
					; sub_1000858C+75j ...
		xor	eax, eax
		mov	dword ptr [esi+14h], 7
		mov	[esi+10h], edi
		mov	[esi], ax

loc_10008652:				; CODE XREF: sub_1000858C+B5j
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1000858C	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10008664(LPCWSTR StringSid,	int)
sub_10008664	proc near		; CODE XREF: sub_10016CB4+72p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
StringSid	= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	esi
		push	edi
		push	[esp+10h+StringSid] ; StringSid
		xor	edi, edi
		mov	esi, ecx
		mov	[esp+14h+var_8], edi
		call	sub_10008486
		mov	[esi], eax
		pop	ecx
		test	eax, eax
		jnz	short loc_10008685
		push	0Eh
		pop	eax
		jmp	short loc_100086FB
; ---------------------------------------------------------------------------

loc_10008685:				; CODE XREF: sub_10008664+1Aj
		push	ebx
		mov	ebx, [esp+14h+arg_4]
		push	ebp
		push	18h
		pop	ebp
		mov	eax, [ebx+4]
		mov	ecx, [ebx]
		sub	eax, ecx
		cdq
		idiv	ebp
		mov	[esp+18h+StringSid], ebp
		test	eax, eax
		jz	short loc_100086E2
		mov	ebp, edi

loc_100086A2:				; CODE XREF: sub_10008664+79j
		lea	eax, [ecx+ebp]
		push	eax		; StringSid
		call	sub_10008486
		mov	[esp+1Ch+var_8], eax
		pop	ecx
		test	eax, eax
		jz	short loc_10008702
		lea	eax, [esp+18h+var_8]
		mov	[esp+18h+var_4], 4
		push	eax
		lea	ecx, [esi+10h]
		call	sub_1001502C
		mov	ecx, [ebx]
		inc	edi
		push	18h
		pop	eax
		add	ebp, eax
		mov	eax, [ebx+4]
		sub	eax, ecx
		cdq
		idiv	[esp+18h+StringSid]
		cmp	edi, eax
		jb	short loc_100086A2
		push	18h
		pop	ebp

loc_100086E2:				; CODE XREF: sub_10008664+3Aj
		mov	eax, [ebx+4]
		sub	eax, [ebx]
		cdq
		idiv	ebp
		test	eax, eax
		jz	short loc_100086F7
		mov	[esi+8], eax
		mov	eax, [esi+10h]
		mov	[esi+4], eax

loc_100086F7:				; CODE XREF: sub_10008664+88j
		xor	eax, eax

loc_100086F9:				; CODE XREF: sub_10008664+A1j
		pop	ebp
		pop	ebx

loc_100086FB:				; CODE XREF: sub_10008664+1Fj
		pop	edi
		pop	esi
		pop	ecx
		pop	ecx
		retn	8
; ---------------------------------------------------------------------------

loc_10008702:				; CODE XREF: sub_10008664+4Ej
		push	0Fh
		pop	eax
		jmp	short loc_100086F9
sub_10008664	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10008707	proc near		; CODE XREF: sub_100095AD+285p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		cmp	dword ptr [ecx], 0
		jnz	short loc_10008719
		push	0Eh
		pop	eax
		jmp	short loc_10008736
; ---------------------------------------------------------------------------

loc_10008719:				; CODE XREF: sub_10008707+Bj
		push	10h
		push	ecx
		mov	ecx, [ebp+arg_0]
		push	20009h
		call	sub_10006C61
		movzx	eax, al
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFFFF0h
		add	eax, 10h

loc_10008736:				; CODE XREF: sub_10008707+10j
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10008707	endp

; [0000001C BYTES: COLLAPSED FUNCTION unknown_libname_6]

; =============== S U B	R O U T	I N E =======================================


sub_10008758	proc near		; CODE XREF: sub_10009D3F+4p
					; sub_10009DBD+7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_1000877F
		cmp	eax, 0CCCCCCCh
		ja	short loc_10008779
		imul	eax, 14h
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_1000877F

loc_10008779:				; CODE XREF: sub_10008758+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_1000877F:				; CODE XREF: sub_10008758+8j
					; sub_10008758+1Fj
		mov	eax, ecx
		retn
sub_10008758	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008782	proc near		; CODE XREF: sub_1000649A+4p
					; sub_10009D69+4p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_100087A9
		cmp	eax, 9249249h
		ja	short loc_100087A3
		imul	eax, 1Ch
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_100087A9

loc_100087A3:				; CODE XREF: sub_10008782+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_100087A9:				; CODE XREF: sub_10008782+8j
					; sub_10008782+1Fj
		mov	eax, ecx
		retn
sub_10008782	endp


; =============== S U B	R O U T	I N E =======================================


sub_100087AC	proc near		; CODE XREF: sub_10003C23+Dp
					; sub_1000571C+7p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_100087D3
		cmp	eax, 0AAAAAAAh
		ja	short loc_100087CD
		imul	eax, 18h
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_100087D3

loc_100087CD:				; CODE XREF: sub_100087AC+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_100087D3:				; CODE XREF: sub_100087AC+8j
					; sub_100087AC+1Fj
		mov	eax, ecx
		retn
sub_100087AC	endp


; =============== S U B	R O U T	I N E =======================================


sub_100087D6	proc near		; CODE XREF: sub_100090C8+31p

arg_4		= dword	ptr  8

		push	ebx
		push	esi
		call	sub_10009DEF
		mov	edx, eax
		xor	ebx, ebx
		lea	esi, [edx+10h]
		mov	[edx+0Ch], bx
		test	esi, esi
		jz	short loc_100087FC
		mov	ecx, [esp+8+arg_4]
		mov	ecx, [ecx]
		mov	eax, [ecx]
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ebx

loc_100087FC:				; CODE XREF: sub_100087D6+14j
		pop	esi
		mov	eax, edx
		pop	ebx
		retn	0Ch
sub_100087D6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008803	proc near		; CODE XREF: sub_10008AB2+1Dp

arg_0		= dword	ptr  4

		call	sub_10009DBD
		lea	edx, [eax+10h]
		mov	word ptr [eax+0Ch], 0
		test	edx, edx
		jz	short locret_1000881D
		mov	ecx, [esp+arg_0]
		mov	ecx, [ecx]
		mov	[edx], ecx

locret_1000881D:			; CODE XREF: sub_10008803+10j
		retn	4
sub_10008803	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008820	proc near		; CODE XREF: sub_100091B7+A4p

arg_0		= dword	ptr  4

		push	esi
		call	sub_1000571C
		mov	edx, eax
		lea	esi, [edx+10h]
		mov	word ptr [edx+0Ch], 0
		test	esi, esi
		jz	short loc_10008843
		mov	eax, [esp+4+arg_0]
		mov	ecx, [eax]
		mov	[esi], ecx
		mov	eax, [eax+4]
		mov	[esi+4], eax

loc_10008843:				; CODE XREF: sub_10008820+13j
		mov	eax, edx
		pop	esi
		retn	4
sub_10008820	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10008849	proc near		; CODE XREF: sub_1000A1C0+25p
					; sub_1000E572+22p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_4]
		cmp	[ebp+arg_0], esi
		jz	short loc_10008869
		push	edi
		mov	edi, [ebp+arg_8]

loc_10008859:				; CODE XREF: sub_10008849+1Dj
		inc	dword ptr [edi]
		lea	ecx, [ebp+arg_0]
		call	sub_1000CDCC
		cmp	[ebp+arg_0], esi
		jnz	short loc_10008859
		pop	edi

loc_10008869:				; CODE XREF: sub_10008849+Aj
		pop	esi
		pop	ebp
		retn
sub_10008849	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000886C(int, char,	int, int, void *)
sub_1000886C	proc near		; CODE XREF: sub_10008BD0+1Bp
					; sub_10008BD0+E0p ...

var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 9249248h
		jb	short loc_10008893
		push	[ebp+arg_10]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	[esp+10h+var_10], offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10008893:				; CODE XREF: sub_1000886C+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_100088B4
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_100088D3
; ---------------------------------------------------------------------------

loc_100088B4:				; CODE XREF: sub_1000886C+38j
		cmp	[ebp+arg_4], 0
		jz	short loc_100088C6
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_100088D3
		mov	[ecx], edi
		jmp	short loc_100088D3
; ---------------------------------------------------------------------------

loc_100088C6:				; CODE XREF: sub_1000886C+4Cj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_100088D3
		mov	[ecx+8], edi

loc_100088D3:				; CODE XREF: sub_1000886C+46j
					; sub_1000886C+54j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_10008970
; ---------------------------------------------------------------------------

loc_100088DD:				; CODE XREF: sub_1000886C+108j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_10008921
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_10008927
		cmp	esi, [eax+8]
		jnz	short loc_10008901
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_100057C3

loc_10008901:				; CODE XREF: sub_1000886C+89j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10009EBF
		jmp	short loc_1000896D
; ---------------------------------------------------------------------------

loc_10008921:				; CODE XREF: sub_1000886C+7Bj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10008941

loc_10008927:				; CODE XREF: sub_1000886C+84j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000896D
; ---------------------------------------------------------------------------

loc_10008941:				; CODE XREF: sub_1000886C+B9j
		cmp	esi, [eax]
		jnz	short loc_1000894F
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10009EBF

loc_1000894F:				; CODE XREF: sub_1000886C+D7j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_100057C3

loc_1000896D:				; CODE XREF: sub_1000886C+B3j
					; sub_1000886C+D3j
		mov	eax, [esi+4]

loc_10008970:				; CODE XREF: sub_1000886C+6Cj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_100088DD
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_1000886C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000898F(int, char,	int, int, void *)
sub_1000898F	proc near		; CODE XREF: sub_10005220+1Bp
					; sub_10005220+E0p ...

var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 0AAAAAA9h
		jb	short loc_100089B6
		push	[ebp+arg_10]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	[esp+10h+var_10], offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100089B6:				; CODE XREF: sub_1000898F+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_100089D7
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_100089F6
; ---------------------------------------------------------------------------

loc_100089D7:				; CODE XREF: sub_1000898F+38j
		cmp	[ebp+arg_4], 0
		jz	short loc_100089E9
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_100089F6
		mov	[ecx], edi
		jmp	short loc_100089F6
; ---------------------------------------------------------------------------

loc_100089E9:				; CODE XREF: sub_1000898F+4Cj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_100089F6
		mov	[ecx+8], edi

loc_100089F6:				; CODE XREF: sub_1000898F+46j
					; sub_1000898F+54j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_10008A93
; ---------------------------------------------------------------------------

loc_10008A00:				; CODE XREF: sub_1000898F+108j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_10008A44
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_10008A4A
		cmp	esi, [eax+8]
		jnz	short loc_10008A24
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_100057C3

loc_10008A24:				; CODE XREF: sub_1000898F+89j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10009EBF
		jmp	short loc_10008A90
; ---------------------------------------------------------------------------

loc_10008A44:				; CODE XREF: sub_1000898F+7Bj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10008A64

loc_10008A4A:				; CODE XREF: sub_1000898F+84j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_10008A90
; ---------------------------------------------------------------------------

loc_10008A64:				; CODE XREF: sub_1000898F+B9j
		cmp	esi, [eax]
		jnz	short loc_10008A72
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10009EBF

loc_10008A72:				; CODE XREF: sub_1000898F+D7j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_100057C3

loc_10008A90:				; CODE XREF: sub_1000898F+B3j
					; sub_1000898F+D3j
		mov	eax, [esi+4]

loc_10008A93:				; CODE XREF: sub_1000898F+6Cj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10008A00
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_1000898F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008AB2	proc near		; CODE XREF: sub_10008E4D+6Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 0CCCCCCBh
		jb	short loc_10008AC9
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10008AC9:				; CODE XREF: sub_10008AB2+Aj
		push	ebx
		push	esi
		push	[esp+0Ch+arg_C]
		call	sub_10008803
		inc	dword ptr [edi+4]
		mov	ebx, eax
		mov	eax, [esp+0Ch+arg_8]
		mov	[ebx+4], eax
		mov	ecx, [edi]
		cmp	eax, ecx
		jnz	short loc_10008AF4
		mov	[ecx+4], ebx
		mov	eax, [edi]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	[eax+8], ebx
		jmp	short loc_10008B14
; ---------------------------------------------------------------------------

loc_10008AF4:				; CODE XREF: sub_10008AB2+32j
		cmp	byte ptr [esp+0Ch+arg_4], 0
		jz	short loc_10008B07
		mov	[eax], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx]
		jnz	short loc_10008B14
		mov	[ecx], ebx
		jmp	short loc_10008B14
; ---------------------------------------------------------------------------

loc_10008B07:				; CODE XREF: sub_10008AB2+47j
		mov	[eax+8], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx+8]
		jnz	short loc_10008B14
		mov	[ecx+8], ebx

loc_10008B14:				; CODE XREF: sub_10008AB2+40j
					; sub_10008AB2+4Fj ...
		mov	eax, [ebx+4]
		mov	esi, ebx
		jmp	loc_10008BB1
; ---------------------------------------------------------------------------

loc_10008B1E:				; CODE XREF: sub_10008AB2+103j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_10008B62
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_10008B68
		cmp	esi, [eax+8]
		jnz	short loc_10008B42
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_100057C3

loc_10008B42:				; CODE XREF: sub_10008AB2+84j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10009EBF
		jmp	short loc_10008BAE
; ---------------------------------------------------------------------------

loc_10008B62:				; CODE XREF: sub_10008AB2+76j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10008B82

loc_10008B68:				; CODE XREF: sub_10008AB2+7Fj
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_10008BAE
; ---------------------------------------------------------------------------

loc_10008B82:				; CODE XREF: sub_10008AB2+B4j
		cmp	esi, [eax]
		jnz	short loc_10008B90
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10009EBF

loc_10008B90:				; CODE XREF: sub_10008AB2+D2j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_100057C3

loc_10008BAE:				; CODE XREF: sub_10008AB2+AEj
					; sub_10008AB2+CEj
		mov	eax, [esi+4]

loc_10008BB1:				; CODE XREF: sub_10008AB2+67j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10008B1E
		mov	eax, [edi]
		pop	esi
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esp+8+arg_0]
		mov	[eax], ebx
		pop	ebx
		pop	edi
		retn	14h
sub_10008AB2	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10008BD0(int, int, int, void *)
sub_10008BD0	proc near		; CODE XREF: sub_100090C8+42p

var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 0
		jnz	short loc_10008BF9
		push	[esp+0Ch+arg_C]	; void *
		push	[esp+10h+arg_8]	; int
		push	dword ptr [edi]	; int
		push	1		; char
		push	[esp+1Ch+arg_0]	; int
		call	sub_1000886C
		mov	eax, [esp+0Ch+arg_0]
		jmp	loc_10008CD9
; ---------------------------------------------------------------------------

loc_10008BF9:				; CODE XREF: sub_10008BD0+9j
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		push	ebp
		mov	ebp, [edi]
		push	esi
		mov	esi, [esp+18h+arg_4]
		cmp	esi, [ebp+0]
		jnz	short loc_10008C21
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	loc_10008CBB
		push	[esp+18h+arg_C]
		push	ebx

loc_10008C1B:				; CODE XREF: sub_10008BD0+9Cj
		push	esi
		jmp	loc_10008CAA
; ---------------------------------------------------------------------------

loc_10008C21:				; CODE XREF: sub_10008BD0+39j
		cmp	esi, ebp
		jnz	short loc_10008C3F
		mov	ecx, [ebp+8]
		mov	eax, [ecx+10h]
		cmp	eax, [ebx]
		jnb	loc_10008CBB
		push	[esp+18h+arg_C]
		push	ebx
		push	ecx
		push	0
		mov	ecx, edi
		jmp	short loc_10008CAC
; ---------------------------------------------------------------------------

loc_10008C3F:				; CODE XREF: sub_10008BD0+53j
		mov	eax, [ebx]
		cmp	[esi+10h], eax
		jbe	short loc_10008C76
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], esi
		call	sub_1000911E
		mov	eax, [esp+18h+arg_8]
		mov	ecx, [ebx]
		cmp	[eax+10h], ecx
		jnb	short loc_10008C71
		mov	ecx, [eax+8]
		push	[esp+18h+arg_C]
		push	ebx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10008C1B
		push	eax
		jmp	short loc_10008CA5
; ---------------------------------------------------------------------------

loc_10008C71:				; CODE XREF: sub_10008BD0+8Cj
		mov	eax, ecx
		cmp	[esi+10h], eax

loc_10008C76:				; CODE XREF: sub_10008BD0+74j
		jnb	short loc_10008CBB
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], esi
		call	sub_1000CDCC
		mov	eax, [esp+18h+arg_8]
		cmp	eax, ebp
		jz	short loc_10008C94
		mov	ecx, [ebx]
		cmp	ecx, [eax+10h]
		jnb	short loc_10008CBB

loc_10008C94:				; CODE XREF: sub_10008BD0+BBj
		mov	ecx, [esi+8]
		push	[esp+18h+arg_C]	; void *
		push	ebx		; int
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10008CA9
		push	esi

loc_10008CA5:				; CODE XREF: sub_10008BD0+9Fj
		push	0
		jmp	short loc_10008CAC
; ---------------------------------------------------------------------------

loc_10008CA9:				; CODE XREF: sub_10008BD0+D2j
		push	eax		; int

loc_10008CAA:				; CODE XREF: sub_10008BD0+4Cj
		push	1		; char

loc_10008CAC:				; CODE XREF: sub_10008BD0+6Dj
					; sub_10008BD0+D7j
		push	[esp+28h+arg_0]	; int
		call	sub_1000886C
		mov	eax, [esp+18h+arg_0]
		jmp	short loc_10008CD6
; ---------------------------------------------------------------------------

loc_10008CBB:				; CODE XREF: sub_10008BD0+40j
					; sub_10008BD0+5Dj ...
		push	[esp+18h+arg_C]	; void *
		lea	eax, [esp+1Ch+var_8]
		mov	ecx, edi
		push	ebx		; int
		push	0		; int
		push	eax		; int
		call	sub_10008CDF
		mov	ecx, [eax]
		mov	eax, [esp+18h+arg_0]
		mov	[eax], ecx

loc_10008CD6:				; CODE XREF: sub_10008BD0+E9j
		pop	esi
		pop	ebp
		pop	ebx

loc_10008CD9:				; CODE XREF: sub_10008BD0+24j
		pop	edi
		pop	ecx
		pop	ecx
		retn	10h
sub_10008BD0	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10008CDF(int, int, int, void *)
sub_10008CDF	proc near		; CODE XREF: sub_10008BD0+F9p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	dl, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], dl
		push	esi
		push	edi
		mov	ecx, [ebp+0]
		mov	edi, ecx
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10008D2E
		mov	esi, [ebx]
		mov	dh, byte ptr [esp+14h+arg_4]

loc_10008D04:				; CODE XREF: sub_10008CDF+4Dj
		mov	edi, eax
		test	dh, dh
		jz	short loc_10008D13
		cmp	[eax+10h], esi
		sbb	dl, dl
		inc	dl
		jmp	short loc_10008D19
; ---------------------------------------------------------------------------

loc_10008D13:				; CODE XREF: sub_10008CDF+29j
		cmp	esi, [eax+10h]
		setb	dl

loc_10008D19:				; CODE XREF: sub_10008CDF+32j
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_10008D25
		mov	eax, [eax]
		jmp	short loc_10008D28
; ---------------------------------------------------------------------------

loc_10008D25:				; CODE XREF: sub_10008CDF+40j
		mov	eax, [eax+8]

loc_10008D28:				; CODE XREF: sub_10008CDF+44j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10008D04

loc_10008D2E:				; CODE XREF: sub_10008CDF+1Dj
		mov	esi, edi
		mov	[esp+14h+arg_4], esi
		test	dl, dl
		jz	short loc_10008D6B
		cmp	edi, [ecx]
		jnz	short loc_10008D5E
		push	[esp+14h+arg_C]	; void *
		push	ebx		; int
		push	edi		; int
		push	1		; char

loc_10008D44:				; CODE XREF: sub_10008CDF+9Dj
		lea	eax, [esp+24h+arg_4]
		mov	ecx, ebp
		push	eax		; int
		call	sub_1000886C
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_10008D8E
; ---------------------------------------------------------------------------

loc_10008D5E:				; CODE XREF: sub_10008CDF+5Bj
		lea	ecx, [esp+14h+arg_4]
		call	sub_1000911E
		mov	esi, [esp+14h+arg_4]

loc_10008D6B:				; CODE XREF: sub_10008CDF+57j
		mov	eax, [esi+10h]
		push	[esp+14h+arg_C]	; void *
		cmp	eax, [ebx]
		jnb	short loc_10008D7E
		push	ebx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_10008D44
; ---------------------------------------------------------------------------

loc_10008D7E:				; CODE XREF: sub_10008CDF+95j
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_10008D8E:				; CODE XREF: sub_10008CDF+7Dj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_10008CDF	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10008D96(int, int, int, void *)
sub_10008D96	proc near		; CODE XREF: sub_10005220+F9p
					; sub_100091B7+B6p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	dl, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], dl
		push	esi
		push	edi
		mov	ecx, [ebp+0]
		mov	edi, ecx
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10008DE5
		mov	esi, [ebx]
		mov	dh, byte ptr [esp+14h+arg_4]

loc_10008DBB:				; CODE XREF: sub_10008D96+4Dj
		mov	edi, eax
		test	dh, dh
		jz	short loc_10008DCA
		cmp	[eax+10h], esi
		sbb	dl, dl
		inc	dl
		jmp	short loc_10008DD0
; ---------------------------------------------------------------------------

loc_10008DCA:				; CODE XREF: sub_10008D96+29j
		cmp	esi, [eax+10h]
		setb	dl

loc_10008DD0:				; CODE XREF: sub_10008D96+32j
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_10008DDC
		mov	eax, [eax]
		jmp	short loc_10008DDF
; ---------------------------------------------------------------------------

loc_10008DDC:				; CODE XREF: sub_10008D96+40j
		mov	eax, [eax+8]

loc_10008DDF:				; CODE XREF: sub_10008D96+44j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10008DBB

loc_10008DE5:				; CODE XREF: sub_10008D96+1Dj
		mov	esi, edi
		mov	[esp+14h+arg_4], esi
		test	dl, dl
		jz	short loc_10008E22
		cmp	edi, [ecx]
		jnz	short loc_10008E15
		push	[esp+14h+arg_C]	; void *
		push	ebx		; int
		push	edi		; int
		push	1		; char

loc_10008DFB:				; CODE XREF: sub_10008D96+9Dj
		lea	eax, [esp+24h+arg_4]
		mov	ecx, ebp
		push	eax		; int
		call	sub_1000898F
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_10008E45
; ---------------------------------------------------------------------------

loc_10008E15:				; CODE XREF: sub_10008D96+5Bj
		lea	ecx, [esp+14h+arg_4]
		call	sub_1000911E
		mov	esi, [esp+14h+arg_4]

loc_10008E22:				; CODE XREF: sub_10008D96+57j
		mov	eax, [esi+10h]
		push	[esp+14h+arg_C]	; void *
		cmp	eax, [ebx]
		jnb	short loc_10008E35
		push	ebx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_10008DFB
; ---------------------------------------------------------------------------

loc_10008E35:				; CODE XREF: sub_10008D96+95j
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_10008E45:				; CODE XREF: sub_10008D96+7Dj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_10008D96	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008E4D	proc near		; CODE XREF: sub_100095AD+483p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebp
		mov	ebp, ecx
		mov	dl, 1
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		mov	ecx, [ebp+0]
		mov	esi, ecx
		mov	byte ptr [esp+10h+var_4], dl
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10008E9D
		mov	dh, byte ptr [esp+10h+arg_4]
		push	ebx
		mov	ebx, [edi]

loc_10008E72:				; CODE XREF: sub_10008E4D+4Dj
		mov	esi, eax
		test	dh, dh
		jz	short loc_10008E81
		cmp	[eax+10h], ebx
		sbb	dl, dl
		inc	dl
		jmp	short loc_10008E87
; ---------------------------------------------------------------------------

loc_10008E81:				; CODE XREF: sub_10008E4D+29j
		cmp	ebx, [eax+10h]
		setb	dl

loc_10008E87:				; CODE XREF: sub_10008E4D+32j
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_10008E93
		mov	eax, [eax]
		jmp	short loc_10008E96
; ---------------------------------------------------------------------------

loc_10008E93:				; CODE XREF: sub_10008E4D+40j
		mov	eax, [eax+8]

loc_10008E96:				; CODE XREF: sub_10008E4D+44j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10008E72
		pop	ebx

loc_10008E9D:				; CODE XREF: sub_10008E4D+1Cj
		mov	eax, esi
		mov	[esp+10h+arg_4], eax
		test	dl, dl
		jz	short loc_10008EDA
		cmp	esi, [ecx]
		jnz	short loc_10008ECD
		push	[esp+10h+arg_C]
		push	edi
		push	esi
		push	1

loc_10008EB3:				; CODE XREF: sub_10008E4D+9Ej
		lea	eax, [esp+20h+arg_4]
		mov	ecx, ebp
		push	eax
		call	sub_10008AB2
		mov	ecx, [eax]
		mov	eax, [esp+10h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_10008EF9
; ---------------------------------------------------------------------------

loc_10008ECD:				; CODE XREF: sub_10008E4D+5Cj
		lea	ecx, [esp+10h+arg_4]
		call	sub_1000911E
		mov	eax, [esp+10h+arg_4]

loc_10008EDA:				; CODE XREF: sub_10008E4D+58j
		mov	ecx, [eax+10h]
		cmp	ecx, [edi]
		jnb	short loc_10008EED
		push	[esp+10h+arg_C]
		push	edi
		push	esi
		push	[esp+1Ch+var_4]
		jmp	short loc_10008EB3
; ---------------------------------------------------------------------------

loc_10008EED:				; CODE XREF: sub_10008E4D+92j
		mov	ecx, [esp+10h+arg_0]
		mov	[ecx], eax
		mov	eax, ecx
		mov	byte ptr [ecx+4], 0

loc_10008EF9:				; CODE XREF: sub_10008E4D+7Ej
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn	10h
sub_10008E4D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008F00	proc near		; CODE XREF: sub_1000EAA8+17p
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		push	ebx
		push	ebx
		lea	esi, [edi+2Ch]
		mov	dword ptr [edi], offset	off_1001D080
		mov	[edi+4], ebx
		mov	ecx, esi
		mov	[edi+8], ebx
		mov	[edi+0Ch], ebx
		mov	[edi+28h], ebx
		mov	[esi], ebx
		mov	[esi+4], ebx
		call	sub_10016FBF
		mov	[esi], eax
		lea	esi, [edi+34h]
		mov	ecx, esi
		mov	[esi], ebx
		mov	[esi+4], ebx
		call	sub_10009D93
		mov	[esi], eax
		lea	esi, [edi+3Ch]
		mov	ecx, esi
		mov	[esi], ebx
		mov	[esi+4], ebx
		call	sub_10009D3F
		mov	[esi], eax
		lea	esi, [edi+44h]
		mov	ecx, esi
		mov	[esi], ebx
		mov	[esi+4], ebx
		call	sub_10009D69
		mov	[esi], eax
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10008F00	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008F65	proc near		; CODE XREF: sub_100095AD+365p
		push	esi
		push	edi
		mov	edi, ecx
		xor	eax, eax
		push	eax
		push	eax
		lea	esi, [edi+4]
		mov	dword ptr [edi], offset	off_1001D074
		mov	ecx, esi
		mov	[esi], eax
		mov	[esi+4], eax
		call	sub_10011688
		mov	[esi], eax
		lea	eax, [edi+0Ch]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sub_10008F65	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008F93	proc near		; CODE XREF: sub_10008FB1+EDp
					; sub_10008FB1+F5p ...

var_4		= dword	ptr -4

		push	ecx
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	eax		; int
		push	dword ptr [eax]	; void *
		lea	eax, [esp+10h+var_4]
		push	eax		; int
		call	sub_1000A171
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	esi
		pop	ecx
		retn
sub_10008F93	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008FB1	proc near		; CODE XREF: sub_1000EAA8+49p

var_4		= dword	ptr -4

		push	ecx
		and	[esp+4+var_4], 0
		push	ebx
		mov	ebx, ecx
		push	esi
		cmp	dword ptr [ebx+4], 0
		mov	dword ptr [ebx], offset	off_1001D080
		jz	loc_1000909B
		push	ebp
		push	0		; lpOverlapped
		push	2		; dwCompletionKey
		push	0		; dwNumberOfBytesTransferred
		push	dword ptr [ebx+4] ; CompletionPort
		call	ds:PostQueuedCompletionStatus
		push	dword ptr [ebx+4] ; hObject
		mov	ebp, ds:CloseHandle
		call	ebp ; CloseHandle
		push	3E8h		; dwMilliseconds
		push	dword ptr [ebx+0Ch] ; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 102h
		jz	loc_1000909A
		mov	eax, [ebx+2Ch]
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_10009021
		push	edi

loc_10009008:				; CODE XREF: sub_10008FB1+6Dj
		mov	edi, [esi+8]
		push	edi
		call	sub_1000934F
		push	edi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	esi, [esi]
		pop	ecx
		pop	ecx
		cmp	esi, [ebx+2Ch]
		jnz	short loc_10009008
		pop	edi

loc_10009021:				; CODE XREF: sub_10008FB1+54j
		push	dword ptr [ebx+0Ch] ; hObject
		call	ebp ; CloseHandle
		mov	ecx, [ebx+28h]
		test	ecx, ecx
		jz	short loc_10009034
		mov	eax, [ecx]
		push	1
		call	dword ptr [eax+8]

loc_10009034:				; CODE XREF: sub_10008FB1+7Aj
		push	dword ptr [ebx+8] ; hObject
		call	ebp ; CloseHandle
		mov	ecx, [ebx+34h]
		mov	eax, [ecx]
		mov	[esp+10h+var_4], eax
		cmp	eax, ecx
		jz	short loc_10009061

loc_10009046:				; CODE XREF: sub_10008FB1+AEj
		push	dword ptr [eax+14h] ; void *
		call	sub_10009321
		pop	ecx
		lea	ecx, [esp+10h+var_4]
		call	sub_1000CDCC
		mov	eax, [esp+10h+var_4]
		cmp	eax, [ebx+34h]
		jnz	short loc_10009046

loc_10009061:				; CODE XREF: sub_10008FB1+93j
		cmp	dword ptr [ebx+4], 0
		jz	short loc_10009071
		lea	eax, [ebx+10h]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection

loc_10009071:				; CODE XREF: sub_10008FB1+B4j
		mov	eax, [ebx+44h]
		mov	esi, [eax]
		mov	[esp+10h+var_4], esi
		cmp	esi, eax
		jz	short loc_1000909A

loc_1000907E:				; CODE XREF: sub_10008FB1+E7j
		push	dword ptr [esi+14h] ; hObject
		call	ebp ; CloseHandle
		push	dword ptr [esi+18h] ; hObject
		call	ebp ; CloseHandle
		lea	ecx, [esp+10h+var_4]
		call	sub_1000CDCC
		mov	esi, [esp+10h+var_4]
		cmp	esi, [ebx+44h]
		jnz	short loc_1000907E

loc_1000909A:				; CODE XREF: sub_10008FB1+47j
					; sub_10008FB1+CBj
		pop	ebp

loc_1000909B:				; CODE XREF: sub_10008FB1+13j
		lea	ecx, [ebx+44h]
		call	sub_10008F93
		lea	ecx, [ebx+3Ch]
		call	sub_10008F93
		lea	ecx, [ebx+34h]
		call	sub_10008F93
		lea	ecx, [ebx+2Ch]
		call	sub_10011712
		push	dword ptr [ebx+2Ch] ; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	esi
		pop	ebx
		pop	ecx
		retn
sub_10008FB1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100090C8	proc near		; CODE XREF: sub_100095AD+F8p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		push	ebx
		mov	edi, ecx
		call	sub_1000576A
		mov	esi, eax
		cmp	esi, [edi]
		jz	short loc_100090E7
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	short loc_10009112

loc_100090E7:				; CODE XREF: sub_100090C8+16j
		lea	eax, [ebp+arg_0+3]
		mov	[ebp+var_4], ebx
		push	eax
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		push	offset byte_10033C2F
		call	sub_100087D6
		push	eax		; void *
		add	eax, 10h
		mov	ecx, edi
		push	eax		; int
		push	esi		; int
		lea	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_10008BD0
		mov	esi, [ebp+arg_0]

loc_10009112:				; CODE XREF: sub_100090C8+1Dj
		pop	edi
		lea	eax, [esi+14h]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100090C8	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000911E	proc near		; CODE XREF: sub_100050C9+A3p
					; sub_10005220+7Ep ...
		mov	edx, [ecx]
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_1000912B
		mov	eax, [edx+8]
		jmp	short loc_10009140
; ---------------------------------------------------------------------------

loc_1000912B:				; CODE XREF: sub_1000911E+6j
		mov	eax, [edx]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_1000914C
		jmp	short loc_10009137
; ---------------------------------------------------------------------------

loc_10009135:				; CODE XREF: sub_1000911E+20j
		mov	eax, edx

loc_10009137:				; CODE XREF: sub_1000911E+15j
		mov	edx, [eax+8]
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10009135

loc_10009140:				; CODE XREF: sub_1000911E+Bj
		mov	[ecx], eax
		jmp	short loc_1000915F
; ---------------------------------------------------------------------------

loc_10009144:				; CODE XREF: sub_1000911E+35j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_10009155
		mov	[ecx], edx

loc_1000914C:				; CODE XREF: sub_1000911E+13j
		mov	edx, [edx+4]
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10009144

loc_10009155:				; CODE XREF: sub_1000911E+2Aj
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_1000915F
		mov	[ecx], edx

loc_1000915F:				; CODE XREF: sub_1000911E+24j
					; sub_1000911E+3Dj
		mov	eax, ecx
		retn
sub_1000911E	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10009162(void *)
sub_10009162	proc near		; CODE XREF: sub_100091B7+107p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_1000917A
		lea	ecx, [esi+4]
		call	sub_10004DA3
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1000917A:				; CODE XREF: sub_10009162+7j
		pop	esi
		retn	4
sub_10009162	endp

; [0000001D BYTES: COLLAPSED FUNCTION unknown_libname_7]

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000919B(void *, char)
sub_1000919B	proc near		; DATA XREF: .rdata:1001D07Co

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10019B9C
		test	[esp+4+arg_0], 1
		jz	short loc_100091B1
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_100091B1:				; CODE XREF: sub_1000919B+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_1000919B	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100091B7(HANDLE Process)
sub_100091B7	proc near		; DATA XREF: .rdata:1001D090o

TargetHandle	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Process		= dword	ptr  4

		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		push	10h		; unsigned int
		mov	[esp+1Ch+var_8], ebx
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_100091ED
		push	[esp+18h+Process] ; Process
		mov	edi, [ebx+4]
		call	ds:GetProcessId
		xor	ebx, ebx
		mov	[esi], ebx
		mov	[esi+4], ebx
		mov	[esi+8], eax
		mov	[esi+0Ch], edi
		jmp	short loc_100091F1
; ---------------------------------------------------------------------------

loc_100091ED:				; CODE XREF: sub_100091B7+18j
		xor	ebx, ebx
		mov	esi, ebx

loc_100091F1:				; CODE XREF: sub_100091B7+34j
		push	ebp
		lea	ebp, [esi+8]
		cmp	[ebp+0], ebx
		jz	loc_100092B1
		mov	edi, ds:GetCurrentProcess
		lea	eax, [esp+1Ch+TargetHandle]
		push	ebx		; dwOptions
		push	ebx		; bInheritHandle
		push	100000h		; dwDesiredAccess
		push	eax		; lpTargetHandle
		call	edi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[esp+30h+Process] ; hSourceHandle
		call	edi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	loc_100092B1
		push	[esp+1Ch+TargetHandle]
		lea	ecx, [esi+4]
		call	sub_10004DE8
		mov	edi, [esp+1Ch+var_8]
		lea	eax, [edi+10h]
		push	eax		; lpCriticalSection
		mov	[esp+20h+Process], eax
		call	ds:EnterCriticalSection
		mov	eax, [ebp+0]
		add	edi, 34h
		mov	[esp+1Ch+var_8], eax
		mov	ecx, edi
		lea	eax, [esp+1Ch+var_8]
		mov	[esp+1Ch+var_4], esi
		push	eax
		call	sub_10008820
		push	eax		; void *
		add	eax, 10h
		mov	ecx, edi
		push	eax		; int
		push	ebx		; int
		lea	eax, [esp+28h+var_8]
		push	eax		; int
		call	sub_10008D96
		cmp	byte ptr [esp+1Ch+var_4], 0
		jnz	short loc_1000927E
		push	2
		pop	ebx
		jmp	short loc_100092A5
; ---------------------------------------------------------------------------

loc_1000927E:				; CODE XREF: sub_100091B7+C0j
		push	0Ch		; dwFlags
		push	0FFFFFFFFh	; dwMilliseconds
		push	esi		; Context
		push	offset Callback	; Callback
		push	dword ptr [esi+4] ; hObject
		push	esi		; phNewWaitObject
		call	ds:RegisterWaitForSingleObject
		test	eax, eax
		jnz	short loc_100092A3
		push	ebp
		mov	ecx, edi
		call	sub_1000A1C0
		xor	ebx, ebx
		inc	ebx
		jmp	short loc_100092A5
; ---------------------------------------------------------------------------

loc_100092A3:				; CODE XREF: sub_100091B7+DDj
		mov	esi, ebx

loc_100092A5:				; CODE XREF: sub_100091B7+C5j
					; sub_100091B7+EAj
		push	[esp+1Ch+Process] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_100092B4
; ---------------------------------------------------------------------------

loc_100092B1:				; CODE XREF: sub_100091B7+41j
					; sub_100091B7+6Bj
		xor	ebx, ebx
		inc	ebx

loc_100092B4:				; CODE XREF: sub_100091B7+F8j
		pop	ebp
		test	esi, esi
		jz	short loc_100092C3
		push	esi		; void *
		lea	ecx, [esp+1Ch+Process]
		call	sub_10009162

loc_100092C3:				; CODE XREF: sub_100091B7+100j
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		add	esp, 0Ch
		retn	4
sub_100091B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100092CE(HANDLE hJob,	int, int)
sub_100092CE	proc near		; CODE XREF: sub_100095AD+430p

JobObjectInformation= dword ptr	-8
var_4		= dword	ptr -4
hJob		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_8]
		mov	[ebp+JobObjectInformation], eax
		mov	eax, [ebp+arg_4]
		push	8		; cbJobObjectInformationLength
		mov	[ebp+var_4], eax
		lea	eax, [ebp+JobObjectInformation]
		push	eax		; lpJobObjectInformation
		push	7		; JobObjectInformationClass
		push	[ebp+hJob]	; hJob
		call	ds:SetInformationJobObject
		test	eax, eax
		setnz	al
		mov	esp, ebp
		pop	ebp
		retn
sub_100092CE	endp


; =============== S U B	R O U T	I N E =======================================


sub_100092F9	proc near		; DATA XREF: .rdata:1001D084o
		push	esi
		push	0F8h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		xor	esi, esi
		pop	ecx
		test	eax, eax
		jz	short loc_10009314
		mov	ecx, eax
		call	sub_10016099
		jmp	short loc_10009316
; ---------------------------------------------------------------------------

loc_10009314:				; CODE XREF: sub_100092F9+10j
		mov	eax, esi

loc_10009316:				; CODE XREF: sub_100092F9+19j
		test	eax, eax
		jz	short loc_1000931D
		lea	esi, [eax+10h]

loc_1000931D:				; CODE XREF: sub_100092F9+1Fj
		mov	eax, esi
		pop	esi
		retn
sub_100092F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10009321(void	*)
sub_10009321	proc near		; CODE XREF: sub_10008FB1+98p
					; StartAddress+155p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		mov	esi, [ebp+arg_0]
		push	0FFFFFFFFh	; CompletionEvent
		push	dword ptr [esi]	; WaitHandle
		call	ds:UnregisterWaitEx
		test	eax, eax
		jz	short loc_1000934A
		lea	ecx, [esi+4]
		call	sub_10004DA3
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1000934A:				; CODE XREF: sub_10009321+18j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10009321	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000934F	proc near		; CODE XREF: sub_10008FB1+5Bp
					; StartAddress+11Dp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		xor	edi, edi
		mov	[ebp+var_4], edi
		cmp	[esi+4], edi
		jz	short loc_1000938B
		push	edi		; uExitCode
		push	dword ptr [esi]	; hJob
		call	ds:TerminateJobObject
		push	dword ptr [esi]	; hObject
		call	ds:CloseHandle
		push	dword ptr [esi]
		mov	ecx, [esi+4]
		call	sub_10016B82
		mov	ecx, [esi+4]
		add	ecx, 10h
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		mov	[esi+4], edi

loc_1000938B:				; CODE XREF: sub_1000934F+11j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000934F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009391	proc near		; CODE XREF: sub_100095AD+98p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	ebx
		mov	ebx, [ebp+arg_0]
		add	ebx, 10h
		push	esi
		push	edi
		mov	ecx, ebx
		mov	eax, [ebx]
		call	dword ptr [eax+0Ch]
		mov	edx, [ebx]
		mov	esi, eax
		mov	ecx, ebx
		shl	esi, 3
		call	dword ptr [edx+10h]
		mov	edx, [ebx]
		mov	edi, eax
		or	edi, esi
		mov	ecx, ebx
		shl	edi, 3
		call	dword ptr [edx+30h]
		or	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10009391	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100093CC(LPVOID lpParameter)
sub_100093CC	proc near		; DATA XREF: .rdata:off_1001D080o
		push	esi
		mov	esi, ecx
		push	edi
		xor	edi, edi
		cmp	[esi+4], edi
		jnz	short loc_10009427
		cmp	[esi+28h], edi
		jnz	short loc_10009427
		lea	eax, [esi+10h]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		push	edi		; NumberOfConcurrentThreads
		push	edi		; CompletionKey
		push	edi		; ExistingCompletionPort
		push	0FFFFFFFFh	; FileHandle
		call	ds:CreateIoCompletionPort
		mov	[esi+4], eax
		test	eax, eax
		jnz	short loc_100093FB
		inc	eax
		jmp	short loc_1000942A
; ---------------------------------------------------------------------------

loc_100093FB:				; CODE XREF: sub_100093CC+2Aj
		push	edi		; lpName
		push	edi		; bInitialState
		push	1		; bManualReset
		push	edi		; lpEventAttributes
		call	ds:CreateEventW
		push	edi		; lpThreadId
		push	edi		; dwCreationFlags
		push	esi		; lpParameter
		push	offset StartAddress ; lpStartAddress
		push	edi		; dwStackSize
		push	edi		; lpThreadAttributes
		mov	[esi+8], eax
		call	ds:CreateThread
		xor	ecx, ecx
		mov	[esi+0Ch], eax
		test	eax, eax
		setz	cl
		mov	eax, ecx
		jmp	short loc_1000942A
; ---------------------------------------------------------------------------

loc_10009427:				; CODE XREF: sub_100093CC+9j
					; sub_100093CC+Ej
		push	8
		pop	eax

loc_1000942A:				; CODE XREF: sub_100093CC+2Dj
					; sub_100093CC+59j
		pop	edi
		pop	esi
		retn
sub_100093CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000942D(void *, void *)
sub_1000942D	proc near		; DATA XREF: .rdata:1001D094o

var_4C		= dword	ptr -4Ch
var_34		= dword	ptr -34h
var_24		= dword	ptr -24h
StringSid	= word ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+arg_0]
		call	sub_10006EA9
		cmp	dword ptr [eax], 5
		jge	short loc_10009457
		push	3
		pop	eax
		jmp	loc_100094DE
; ---------------------------------------------------------------------------

loc_10009457:				; CODE XREF: sub_1000942D+20j
		push	ebx
		push	edi		; void *
		lea	ecx, [ebp+StringSid]
		call	sub_10001E8D
		lea	eax, [ebp+StringSid]
		push	eax		; StringSid
		lea	eax, [ebp+var_34]
		push	eax		; int
		call	sub_1000858C
		pop	ecx
		pop	ecx
		xor	ebx, ebx
		lea	ecx, [ebp+StringSid] ; void *
		push	ebx		; int
		push	1		; char
		call	sub_100022C1
		push	esi		; void *
		cmp	[ebp+var_24], ebx
		jnz	short loc_100094BD
		lea	ecx, [ebp+var_4C]
		call	sub_10001E8D
		push	edi		; void *
		lea	ecx, [ebp+StringSid]
		call	sub_10001E8D
		lea	eax, [ebp+var_4C]
		push	eax		; int
		lea	eax, [ebp+StringSid]
		push	eax		; StringSid
		call	sub_100084A7
		pop	ecx
		pop	ecx
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+StringSid] ; void *
		mov	esi, eax
		call	sub_100022C1
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+var_4C] ; void *
		call	sub_100022C1
		jmp	short loc_100094D0
; ---------------------------------------------------------------------------

loc_100094BD:				; CODE XREF: sub_1000942D+54j
		lea	ecx, [ebp+var_34]
		call	sub_10009F23
		test	eax, eax
		jz	short loc_100094CE
		push	0Eh
		pop	esi
		jmp	short loc_100094D0
; ---------------------------------------------------------------------------

loc_100094CE:				; CODE XREF: sub_1000942D+9Aj
		mov	esi, ebx

loc_100094D0:				; CODE XREF: sub_1000942D+8Ej
					; sub_1000942D+9Fj
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1
		mov	eax, esi
		pop	ebx

loc_100094DE:				; CODE XREF: sub_1000942D+25j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000942D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100094F0	proc near		; CODE XREF: sub_1000E983+2Ap

var_8		= byte ptr -8
var_4		= byte ptr -4
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		lea	edi, [ebx+10h]
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		lea	eax, [ebp+arg_0]
		push	eax
		lea	eax, [ebp+var_4]
		push	eax
		lea	ecx, [ebx+3Ch]
		call	sub_1000A208
		mov	eax, [eax]
		cmp	eax, [ebx+3Ch]
		jnz	short loc_10009536
		lea	eax, [ebp+arg_0]
		push	eax
		lea	eax, [ebp+var_8]
		push	eax
		lea	ecx, [ebx+34h]
		call	sub_1000A208
		mov	eax, [eax]
		cmp	eax, [ebx+34h]
		jnz	short loc_10009536
		xor	bl, bl
		jmp	short loc_10009538
; ---------------------------------------------------------------------------

loc_10009536:				; CODE XREF: sub_100094F0+29j
					; sub_100094F0+40j
		mov	bl, 1

loc_10009538:				; CODE XREF: sub_100094F0+44j
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100094F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000954A	proc near		; CODE XREF: sub_100095AD+89p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		call	sub_100169AE
		neg	eax
		sbb	al, al
		inc	al
		retn
sub_1000954A	endp


; =============== S U B	R O U T	I N E =======================================


; void __stdcall Callback(PVOID, BOOLEAN)
Callback	proc near		; DATA XREF: sub_100091B7+CCo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	dword ptr [eax+8] ; lpOverlapped
		push	1		; dwCompletionKey
		push	0		; dwNumberOfBytesTransferred
		push	dword ptr [eax+0Ch] ; CompletionPort
		call	ds:PostQueuedCompletionStatus
		retn	8
Callback	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10009571(void	*, DWORD dwErrCode)
sub_10009571	proc near		; CODE XREF: sub_100095AD+3E3p
					; sub_100095AD+43Fp

arg_0		= dword	ptr  4
dwErrCode	= dword	ptr  8

		push	esi
		mov	esi, [esp+4+dwErrCode]
		push	edi
		test	esi, esi
		jnz	short loc_10009583
		call	ds:GetLastError
		mov	esi, eax

loc_10009583:				; CODE XREF: sub_10009571+8j
		mov	edi, [esp+8+arg_0]
		mov	ecx, edi
		call	sub_100198E3
		test	edi, edi
		jz	short loc_100095A0
		mov	ecx, edi
		call	sub_1001944D
		push	edi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_100095A0:				; CODE XREF: sub_10009571+1Fj
		push	esi		; dwErrCode
		call	ds:SetLastError
		xor	eax, eax
		pop	edi
		inc	eax
		pop	esi
		retn
sub_10009571	endp


; =============== S U B	R O U T	I N E =======================================


sub_100095AD	proc near		; DATA XREF: .rdata:1001D088o

hExistingToken	= dword	ptr -0C8h
DuplicateTokenHandle= dword ptr	-0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
lpCriticalSection= dword ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_74		= dword	ptr -74h
var_6C		= dword	ptr -6Ch
var_64		= dword	ptr -64h
var_5C		= dword	ptr -5Ch
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0C8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0C8h+var_4], eax
		mov	eax, [esp+0C8h+arg_0]
		and	[esp+0C8h+lpCriticalSection], 0
		mov	[esp+0C8h+var_B8], eax
		push	ebp
		mov	ebp, ecx
		mov	ecx, [esp+0CCh+arg_4]
		mov	[esp+0CCh+var_94], ecx
		mov	ecx, [esp+0CCh+arg_C]
		mov	[esp+0CCh+var_8C], ecx
		push	edi
		mov	edi, [esp+0D0h+arg_8]
		mov	[esp+0D0h+var_A8], edi
		test	eax, eax
		jnz	short loc_10009602

loc_100095FA:				; CODE XREF: sub_100095AD+57j
		push	2
		pop	eax
		jmp	loc_10009AAB
; ---------------------------------------------------------------------------

loc_10009602:				; CODE XREF: sub_100095AD+4Bj
		test	edi, edi
		jz	short loc_100095FA
		mov	eax, dword_10033C38
		test	al, 1
		jnz	short loc_10009622
		or	eax, 1
		mov	dword_10033C38,	eax
		call	ds:GetCurrentThreadId
		mov	dword_10033C34,	eax

loc_10009622:				; CODE XREF: sub_100095AD+60j
		push	ebx
		lea	eax, [ebp+10h]
		push	esi
		push	eax		; lpCriticalSection
		mov	[esp+0DCh+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		lea	ebx, [edi-10h]
		push	ebx
		call	sub_1000954A
		pop	ecx
		test	al, al
		jz	loc_100096EF
		push	ebx
		call	sub_10009391
		pop	ecx
		mov	[esp+0D8h+var_C0], eax
		lea	ecx, [ebp+44h]
		lea	eax, [esp+0D8h+var_C0]
		push	eax
		lea	eax, [esp+0DCh+var_B4]
		push	eax
		call	sub_1000A208
		mov	eax, [esp+0D8h+var_B4]
		cmp	eax, [ebp+44h]
		jz	short loc_1000967A
		mov	ecx, [eax+14h]
		mov	[esp+0D8h+DuplicateTokenHandle], ecx
		mov	eax, [eax+18h]
		mov	[esp+0D8h+hExistingToken], eax
		jmp	short loc_100096B7
; ---------------------------------------------------------------------------

loc_1000967A:				; CODE XREF: sub_100095AD+BBj
		lea	eax, [esp+0D8h+hExistingToken]
		mov	ecx, ebx
		push	eax		; lpTargetHandle
		lea	eax, [esp+0DCh+DuplicateTokenHandle]
		push	eax		; LPHANDLE
		call	sub_10016AB5
		mov	esi, eax
		test	esi, esi
		jnz	loc_10009A9D
		mov	esi, [esp+0D8h+DuplicateTokenHandle]
		lea	eax, [esp+0D8h+var_C0]
		mov	edi, [esp+0D8h+hExistingToken]
		lea	ecx, [ebp+44h]
		push	eax
		call	sub_100090C8
		mov	[eax+4], edi
		mov	edi, [esp+0D8h+var_A8]
		mov	[eax], esi
		mov	ecx, [esp+0D8h+DuplicateTokenHandle]

loc_100096B7:				; CODE XREF: sub_100095AD+CBj
		lea	eax, [esp+0D8h+DuplicateTokenHandle]
		push	eax		; DuplicateTokenHandle
		push	2		; ImpersonationLevel
		push	ecx		; ExistingTokenHandle
		call	ds:DuplicateToken
		test	eax, eax
		jz	short loc_100096E7
		lea	eax, [esp+0D8h+hExistingToken]
		push	eax		; phNewToken
		push	1		; TokenType
		push	1		; ImpersonationLevel
		push	0		; lpTokenAttributes
		push	0F01FFh		; dwDesiredAccess
		push	[esp+0ECh+hExistingToken] ; hExistingToken
		call	ds:DuplicateTokenEx
		test	eax, eax
		jnz	short loc_1000970A

loc_100096E7:				; CODE XREF: sub_100095AD+11Aj
		xor	esi, esi
		inc	esi
		jmp	loc_10009A9D
; ---------------------------------------------------------------------------

loc_100096EF:				; CODE XREF: sub_100095AD+91j
		lea	eax, [esp+0D8h+hExistingToken]
		mov	ecx, ebx
		push	eax		; lpTargetHandle
		lea	eax, [esp+0DCh+DuplicateTokenHandle]
		push	eax		; LPHANDLE
		call	sub_10016AB5
		mov	esi, eax
		test	esi, esi
		jnz	loc_10009A9D

loc_1000970A:				; CODE XREF: sub_100095AD+138j
		push	[esp+0D8h+DuplicateTokenHandle]
		and	[esp+0DCh+var_B0], 0
		lea	ecx, [esp+0DCh+var_B0]
		call	sub_10004DE8
		push	[esp+0D8h+hExistingToken]
		and	[esp+0DCh+var_AC], 0
		lea	ecx, [esp+0DCh+var_AC]
		call	sub_10004DE8
		lea	eax, [esp+0D8h+var_88]
		mov	ecx, ebx
		push	eax
		call	sub_10016A61
		mov	esi, eax
		test	esi, esi
		jnz	loc_10009A8B
		push	[esp+0D8h+var_88]
		and	[esp+0DCh+var_BC], eax
		lea	ecx, [esp+0DCh+var_BC]
		call	sub_10004DE8
		lea	ecx, [esp+0D8h+var_64] ; void *
		call	sub_10006B5D
		lea	ecx, [ebx+10h]
		mov	eax, [ecx]
		lea	edx, [esp+0D8h+var_1C]
		push	edx
		call	dword ptr [eax+20h]
		cmp	[esp+0D8h+var_C], esi
		jz	short loc_10009793
		cmp	[esp+0D8h+var_8], 8
		mov	eax, [esp+0D8h+var_1C]
		jnb	short loc_1000978F
		lea	eax, [esp+0D8h+var_1C]

loc_1000978F:				; CODE XREF: sub_100095AD+1D9j
		mov	[esp+0D8h+var_5C], eax

loc_10009793:				; CODE XREF: sub_100095AD+1C8j
		mov	byte ptr [esp+0D8h+var_C0], 0
		call	sub_10006EF6
		cmp	eax, 3
		jl	loc_100098BA
		mov	ecx, ebx
		xor	esi, esi
		call	sub_100169AE
		mov	[esp+0D8h+var_A8], eax
		test	eax, eax
		jz	short loc_100097B8
		inc	esi

loc_100097B8:				; CODE XREF: sub_100095AD+208j
		lea	eax, [esp+0D8h+var_98]
		mov	ecx, edi
		push	eax
		lea	eax, [esp+0DCh+var_A4]
		push	eax
		mov	eax, [edi]
		call	dword ptr [eax+44h]
		push	edx
		push	eax
		call	sub_10011E16
		mov	eax, [esp+0E8h+var_A4]
		add	esp, 10h
		or	eax, [esp+0D8h+var_A0]
		jz	short loc_100097DE
		inc	esi

loc_100097DE:				; CODE XREF: sub_100095AD+22Ej
		mov	ecx, ebx
		call	sub_10016A05
		mov	ecx, ebx
		mov	[esp+0D8h+var_B4], eax
		call	sub_10016A01
		mov	ecx, [esp+0D8h+var_B4]
		xor	edi, edi
		mov	[esp+0D8h+var_90], eax
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10009804
		mov	[esp+0D8h+var_84], ecx
		inc	edi

loc_10009804:				; CODE XREF: sub_100095AD+250j
		cmp	eax, ecx
		jz	short loc_10009812
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10009812
		mov	[esp+edi*4+0D8h+var_84], eax
		inc	edi

loc_10009812:				; CODE XREF: sub_100095AD+259j
					; sub_100095AD+25Ej
		test	edi, edi
		jz	short loc_10009817
		inc	esi

loc_10009817:				; CODE XREF: sub_100095AD+267j
		push	esi
		lea	ecx, [esp+0DCh+var_64]
		call	sub_10006BFD
		test	al, al
		jz	short loc_1000988E
		mov	ecx, [esp+0D8h+var_A8]
		test	ecx, ecx
		jz	short loc_10009841
		lea	eax, [esp+0D8h+var_64]
		push	eax
		call	sub_10008707
		mov	esi, eax
		test	esi, esi
		jnz	loc_10009A69

loc_10009841:				; CODE XREF: sub_100095AD+27Ej
		mov	eax, [esp+0D8h+var_A4]
		or	eax, [esp+0D8h+var_A0]
		jz	short loc_10009869
		push	[esp+0D8h+var_98]
		lea	eax, [esp+0DCh+var_A4]
		push	eax
		push	20007h
		lea	ecx, [esp+0E4h+var_64]
		call	sub_10006C61
		test	al, al
		jz	short loc_1000988E

loc_10009869:				; CODE XREF: sub_100095AD+29Cj
		test	edi, edi
		jz	loc_100098FE
		mov	eax, edi
		lea	ecx, [esp+0D8h+var_64]
		shl	eax, 2
		push	eax
		lea	eax, [esp+0DCh+var_84]
		push	eax
		push	20002h
		call	sub_10006C61
		test	al, al
		jnz	short loc_10009896

loc_1000988E:				; CODE XREF: sub_100095AD+276j
					; sub_100095AD+2BAj
		push	11h
		pop	esi
		jmp	loc_10009A69
; ---------------------------------------------------------------------------

loc_10009896:				; CODE XREF: sub_100095AD+2DFj
		mov	eax, [esp+0D8h+var_B4]
		or	[esp+0D8h+var_38], 100h
		or	[esp+0D8h+var_2C], 0FFFFFFFFh
		mov	[esp+0D8h+var_28], eax
		mov	eax, [esp+0D8h+var_90]
		jmp	short loc_100098F2
; ---------------------------------------------------------------------------

loc_100098BA:				; CODE XREF: sub_100095AD+1F3j
		push	offset aMoz_win_inheri ; "MOZ_WIN_INHERIT_STD_HANDLES_PRE_VISTA"
		call	ds:getenv
		pop	ecx
		test	eax, eax
		jz	short loc_100098FE
		or	[esp+0D8h+var_38], 100h
		mov	ecx, ebx
		or	[esp+0D8h+var_2C], 0FFFFFFFFh
		call	sub_10016A05
		mov	ecx, ebx
		mov	[esp+0D8h+var_28], eax
		call	sub_10016A01

loc_100098F2:				; CODE XREF: sub_100095AD+30Bj
		mov	byte ptr [esp+0D8h+var_C0], 1
		mov	[esp+0D8h+var_24], eax

loc_100098FE:				; CODE XREF: sub_100095AD+2BEj
					; sub_100095AD+31Bj
		cmp	dword ptr [ebp+28h], 0
		jnz	short loc_1000991E
		push	24h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10009919
		mov	ecx, eax
		call	sub_10008F65
		jmp	short loc_1000991B
; ---------------------------------------------------------------------------

loc_10009919:				; CODE XREF: sub_100095AD+361j
		xor	eax, eax

loc_1000991B:				; CODE XREF: sub_100095AD+36Aj
		mov	[ebp+28h], eax

loc_1000991E:				; CODE XREF: sub_100095AD+355j
		lea	ecx, [esp+0D8h+var_74]
		call	unknown_libname_5 ; Microsoft VisualC 2-11/net runtime
		push	30h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_1000995B
		push	dword ptr [ebp+28h]
		lea	ecx, [esp+0DCh+var_AC]
		push	[esp+0DCh+var_BC]
		call	sub_10006ADC
		push	eax
		lea	ecx, [esp+0E4h+var_B0]
		call	sub_10006ADC
		push	eax
		mov	ecx, esi
		call	sub_10019405
		mov	esi, eax
		jmp	short loc_1000995D
; ---------------------------------------------------------------------------

loc_1000995B:				; CODE XREF: sub_100095AD+386j
		xor	esi, esi

loc_1000995D:				; CODE XREF: sub_100095AD+3ACj
		lea	eax, [esp+0D8h+var_74]
		mov	ecx, esi
		push	eax		; int
		lea	eax, [esp+0DCh+var_64]
		push	eax		; int
		push	[esp+0E0h+var_C0] ; int
		push	[esp+0E4h+var_94] ; wchar_t *
		push	[esp+0E8h+var_B8] ; wchar_t *
		call	sub_10019558
		test	eax, eax
		jz	short loc_10009981
		push	eax
		jmp	short loc_1000998F
; ---------------------------------------------------------------------------

loc_10009981:				; CODE XREF: sub_100095AD+3CFj
		push	esi
		mov	ecx, ebx
		call	sub_1001664B
		test	al, al
		jnz	short loc_1000999E
		push	0		; dwErrCode

loc_1000998F:				; CODE XREF: sub_100095AD+3D2j
		push	esi		; void *
		call	sub_10009571
		pop	ecx
		pop	ecx
		mov	esi, eax
		jmp	loc_10009A60
; ---------------------------------------------------------------------------

loc_1000999E:				; CODE XREF: sub_100095AD+3DEj
		lea	ecx, [ebx+10h]
		mov	eax, [ecx]
		call	dword ptr [eax]
		push	[esp+0D8h+var_BC]
		call	sub_10004DD3
		pop	ecx
		test	al, al
		jz	loc_10009A37
		push	8		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_100099D5
		lea	ecx, [esp+0D8h+var_BC]
		call	sub_10006ADC
		mov	[edi], eax
		mov	[edi+4], ebx
		jmp	short loc_100099D7
; ---------------------------------------------------------------------------

loc_100099D5:				; CODE XREF: sub_100095AD+416j
		xor	edi, edi

loc_100099D7:				; CODE XREF: sub_100095AD+426j
		push	edi		; int
		push	dword ptr [ebp+4] ; int
		push	dword ptr [edi]	; hJob
		call	sub_100092CE
		add	esp, 0Ch
		test	al, al
		jnz	short loc_100099FE
		push	0		; dwErrCode
		push	esi		; void *
		call	sub_10009571
		push	edi		; void *
		mov	esi, eax
		call	??3@YAXPAX@Z	; operator delete(void *)
		add	esp, 0Ch
		jmp	short loc_10009A60
; ---------------------------------------------------------------------------

loc_100099FE:				; CODE XREF: sub_100095AD+43Aj
		lea	eax, [esp+0D8h+var_B8]
		mov	[esp+0D8h+var_B8], edi
		lea	ecx, [ebp+2Ch]
		push	eax
		push	dword ptr [ecx]
		call	sub_10010C9A
		mov	eax, [esp+0D8h+var_6C]
		lea	ecx, [ebp+3Ch]
		mov	[esp+0D8h+var_B8], eax
		movzx	eax, byte_10033C30
		push	eax
		lea	eax, [esp+0DCh+var_B8]
		push	eax
		push	0
		lea	eax, [esp+0E4h+var_84]
		push	eax
		call	sub_10008E4D
		jmp	short loc_10009A46
; ---------------------------------------------------------------------------

loc_10009A37:				; CODE XREF: sub_100095AD+404j
		cmp	dword ptr [ebp+40h], 0
		jnz	short loc_10009A46
		push	dword ptr [ebp+8] ; hEvent
		call	ds:SetEvent

loc_10009A46:				; CODE XREF: sub_100095AD+488j
					; sub_100095AD+48Ej
		lea	eax, [esp+0D8h+var_84]
		push	eax
		lea	ecx, [esp+0DCh+var_74]
		call	sub_10006B09
		mov	edi, [esp+0D8h+var_8C]
		mov	esi, eax
		movsd
		movsd
		movsd
		movsd
		xor	esi, esi

loc_10009A60:				; CODE XREF: sub_100095AD+3ECj
					; sub_100095AD+44Fj
		lea	ecx, [esp+0D8h+var_74]
		call	sub_100069C2

loc_10009A69:				; CODE XREF: sub_100095AD+28Ej
					; sub_100095AD+2E4j
		push	0		; int
		push	1		; char
		lea	ecx, [esp+0E0h+var_1C] ; void *
		call	sub_100022C1
		lea	ecx, [esp+0D8h+var_64]
		call	sub_10006BE0
		lea	ecx, [esp+0D8h+var_BC]
		call	sub_10004DA3

loc_10009A8B:				; CODE XREF: sub_100095AD+191j
		lea	ecx, [esp+0D8h+var_AC]
		call	sub_10004DA3
		lea	ecx, [esp+0D8h+var_B0]
		call	sub_10004DA3

loc_10009A9D:				; CODE XREF: sub_100095AD+E2j
					; sub_100095AD+13Dj ...
		push	[esp+0D8h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, esi
		pop	esi
		pop	ebx

loc_10009AAB:				; CODE XREF: sub_100095AD+50j
		mov	ecx, [esp+0D0h+var_4]
		pop	edi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C8h
		retn	10h
sub_100095AD	endp


; =============== S U B	R O U T	I N E =======================================


; DWORD	__stdcall StartAddress(LPVOID lpThreadParameter)
StartAddress	proc near		; DATA XREF: sub_100093CC+3Do

Overlapped	= dword	ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
CompletionKey	= dword	ptr -22Ch
NumberOfBytesTransferred= dword	ptr -228h
hEvent		= dword	ptr -224h
CompletionPort	= dword	ptr -220h
var_21C		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_214		= dword	ptr -214h
var_210		= byte ptr -210h
var_160		= byte ptr -160h
var_B0		= byte ptr -0B0h
lpThreadParameter= dword ptr  4

		sub	esp, 238h
		push	ebx
		push	ebp
		mov	ebp, [esp+240h+lpThreadParameter]
		xor	ebx, ebx
		mov	[esp+240h+var_230], ebx
		test	ebp, ebp
		jnz	short loc_10009AE5
		xor	eax, eax
		inc	eax
		jmp	loc_10009C90
; ---------------------------------------------------------------------------

loc_10009AE5:				; CODE XREF: StartAddress+17j
		push	esi
		push	edi
		push	offset aBrokerevent ; "BrokerEvent"
		call	sub_10004E1F
		mov	eax, [ebp+4]
		xor	edi, edi
		mov	esi, [ebp+8]
		pop	ecx
		mov	[esp+248h+CompletionPort], eax
		mov	[esp+248h+hEvent], esi
		mov	[esp+248h+var_234], edi
		jmp	loc_10009BD7
; ---------------------------------------------------------------------------

loc_10009B0B:				; CODE XREF: StartAddress+1C3j
		mov	ecx, [esp+248h+CompletionKey]
		cmp	ecx, 3
		jbe	loc_10009BE9
		mov	eax, [esp+248h+NumberOfBytesTransferred]
		cmp	eax, 3
		jz	loc_10009C5C
		cmp	eax, 4
		jz	loc_10009BE0
		cmp	eax, 6
		jz	loc_10009BC9
		jbe	short loc_10009BB8
		cmp	eax, 8
		jbe	short loc_10009B68
		cmp	eax, 9
		jnz	short loc_10009BB8
		push	1B64h		; uExitCode
		push	dword ptr [ecx]	; hJob
		call	ds:TerminateJobObject
		test	bl, 2
		jz	loc_10009C5C
		and	ebx, 0FFFFFFFDh
		lea	ecx, [esp+248h+var_B0]
		jmp	loc_10009C53
; ---------------------------------------------------------------------------

loc_10009B68:				; CODE XREF: StartAddress+78j
		lea	esi, [ebp+10h]
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esp+248h+Overlapped]
		lea	ecx, [ebp+3Ch]
		mov	[esp+248h+var_234], eax
		lea	eax, [esp+248h+var_234]
		push	eax
		call	sub_1000A1C0
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	esi, [esp+248h+hEvent]
		dec	edi
		mov	[esp+248h+var_234], edi
		jnz	short loc_10009BA0
		push	esi		; hEvent
		call	ds:SetEvent

loc_10009BA0:				; CODE XREF: StartAddress+D3j
		test	bl, 1
		jz	loc_10009C5C
		and	ebx, 0FFFFFFFEh
		lea	ecx, [esp+248h+var_160]
		jmp	loc_10009C53
; ---------------------------------------------------------------------------

loc_10009BB8:				; CODE XREF: StartAddress+73j
					; StartAddress+7Dj
		test	bl, 4
		jz	loc_10009C5C
		and	ebx, 0FFFFFFFBh
		jmp	loc_10009C4F
; ---------------------------------------------------------------------------

loc_10009BC9:				; CODE XREF: StartAddress+6Dj
		inc	edi
		mov	[esp+248h+var_234], edi
		cmp	edi, 1
		jnz	loc_10009C5C

loc_10009BD7:				; CODE XREF: StartAddress+42j
		push	esi		; hEvent
		call	ds:ResetEvent
		jmp	short loc_10009C5C
; ---------------------------------------------------------------------------

loc_10009BE0:				; CODE XREF: StartAddress+64j
		push	ecx
		call	sub_1000934F
		pop	ecx
		jmp	short loc_10009C5C
; ---------------------------------------------------------------------------

loc_10009BE9:				; CODE XREF: StartAddress+4Ej
		cmp	ecx, 1
		jnz	short loc_10009C42
		lea	ebx, [ebp+10h]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esp+248h+Overlapped]
		lea	ecx, [ebp+34h]
		mov	[esp+248h+var_21C], eax
		lea	eax, [esp+248h+var_21C]
		push	eax
		lea	eax, [esp+24Ch+var_218]
		push	eax
		call	sub_1000A208
		mov	esi, [esp+248h+var_218]
		push	dword ptr [esi+14h] ; void *
		call	sub_10009321
		pop	ecx
		push	esi		; void *
		lea	eax, [esp+24Ch+var_214]
		push	eax		; int
		lea	ecx, [ebp+34h]
		call	sub_10009F45
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ebx, [esp+248h+var_230]
		mov	edi, [esp+248h+var_234]
		mov	esi, [esp+248h+hEvent]
		jmp	short loc_10009C5C
; ---------------------------------------------------------------------------

loc_10009C42:				; CODE XREF: StartAddress+128j
		cmp	ecx, 2
		jz	short loc_10009C9B
		test	bl, 8
		jz	short loc_10009C5C
		and	ebx, 0FFFFFFF7h

loc_10009C4F:				; CODE XREF: StartAddress+100j
		lea	ecx, [esp+248h+var_210]

loc_10009C53:				; CODE XREF: StartAddress+9Fj
					; StartAddress+EFj
		mov	[esp+248h+var_230], ebx
		call	sub_10002021

loc_10009C5C:				; CODE XREF: StartAddress+5Bj
					; StartAddress+8Fj ...
		xor	eax, eax
		mov	[esp+248h+NumberOfBytesTransferred], eax
		mov	[esp+248h+CompletionKey], eax
		mov	[esp+248h+Overlapped], eax
		lea	eax, [esp+248h+Overlapped]
		push	0FFFFFFFFh	; dwMilliseconds
		push	eax		; lpOverlapped
		lea	eax, [esp+250h+CompletionKey]
		push	eax		; lpCompletionKey
		lea	eax, [esp+254h+NumberOfBytesTransferred]
		push	eax		; lpNumberOfBytesTransferred
		push	[esp+258h+CompletionPort] ; CompletionPort
		call	ds:GetQueuedCompletionStatus
		test	eax, eax
		jnz	loc_10009B0B
		inc	eax

loc_10009C8E:				; CODE XREF: StartAddress+1D9j
		pop	edi
		pop	esi

loc_10009C90:				; CODE XREF: StartAddress+1Cj
		pop	ebp
		pop	ebx
		add	esp, 238h
		retn	4
; ---------------------------------------------------------------------------

loc_10009C9B:				; CODE XREF: StartAddress+181j
		xor	eax, eax
		jmp	short loc_10009C8E
StartAddress	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10009C9F(void *)
sub_10009C9F	proc near		; DATA XREF: .rdata:1001D098o

var_34		= dword	ptr -34h
var_24		= dword	ptr -24h
StringSid	= word ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		mov	esi, [ebp+arg_0]
		call	sub_10006EA9
		cmp	dword ptr [eax], 5
		jge	short loc_10009CC2
		push	3
		pop	eax
		jmp	short loc_10009D20
; ---------------------------------------------------------------------------

loc_10009CC2:				; CODE XREF: sub_10009C9F+1Cj
		push	esi		; void *
		lea	ecx, [ebp+StringSid]
		call	sub_10001E8D
		lea	eax, [ebp+StringSid]
		push	eax		; StringSid
		lea	eax, [ebp+var_34]
		push	eax		; int
		call	sub_1000858C
		pop	ecx
		pop	ecx
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+StringSid] ; void *
		call	sub_100022C1
		cmp	[ebp+var_24], 0
		jnz	short loc_10009CF1
		push	0Eh
		pop	esi
		jmp	short loc_10009D12
; ---------------------------------------------------------------------------

loc_10009CF1:				; CODE XREF: sub_10009C9F+4Bj
		push	esi		; void *
		lea	ecx, [ebp+StringSid]
		call	sub_10001E8D
		lea	eax, [ebp+StringSid]
		push	eax		; StringSid
		call	sub_10008522
		pop	ecx
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+StringSid] ; void *
		mov	esi, eax
		call	sub_100022C1

loc_10009D12:				; CODE XREF: sub_10009C9F+50j
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1
		mov	eax, esi

loc_10009D20:				; CODE XREF: sub_10009C9F+21j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10009C9F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009D31	proc near		; DATA XREF: .rdata:1001D08Co
		push	0FFFFFFFFh	; dwMilliseconds
		push	dword ptr [ecx+8] ; hHandle
		call	ds:WaitForSingleObject
		xor	eax, eax
		retn
sub_10009D31	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009D3F	proc near		; CODE XREF: sub_10008F00+47p
		push	0
		push	1
		call	sub_10008758
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10009D50
		mov	[eax], eax

loc_10009D50:				; CODE XREF: sub_10009D3F+Dj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_10009D59
		mov	[ecx], eax

loc_10009D59:				; CODE XREF: sub_10009D3F+16j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10009D62
		mov	[ecx], eax

loc_10009D62:				; CODE XREF: sub_10009D3F+1Fj
		mov	word ptr [eax+0Ch], 101h
		retn
sub_10009D3F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009D69	proc near		; CODE XREF: sub_10008F00+58p
					; sub_10011356+1Bp
		push	0
		push	1
		call	sub_10008782
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10009D7A
		mov	[eax], eax

loc_10009D7A:				; CODE XREF: sub_10009D69+Dj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_10009D83
		mov	[ecx], eax

loc_10009D83:				; CODE XREF: sub_10009D69+16j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10009D8C
		mov	[ecx], eax

loc_10009D8C:				; CODE XREF: sub_10009D69+1Fj
		mov	word ptr [eax+0Ch], 101h
		retn
sub_10009D69	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009D93	proc near		; CODE XREF: sub_10005405+36p
					; sub_10005405+47p ...
		push	0
		push	1
		call	sub_100087AC
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10009DA4
		mov	[eax], eax

loc_10009DA4:				; CODE XREF: sub_10009D93+Dj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_10009DAD
		mov	[ecx], eax

loc_10009DAD:				; CODE XREF: sub_10009D93+16j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10009DB6
		mov	[ecx], eax

loc_10009DB6:				; CODE XREF: sub_10009D93+1Fj
		mov	word ptr [eax+0Ch], 101h
		retn
sub_10009D93	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009DBD	proc near		; CODE XREF: sub_10008803p
		push	esi
		push	0
		push	1
		mov	esi, ecx
		call	sub_10008758
		mov	edx, eax
		pop	ecx
		pop	ecx
		test	edx, edx
		jz	short loc_10009DD5
		mov	ecx, [esi]
		mov	[edx], ecx

loc_10009DD5:				; CODE XREF: sub_10009DBD+12j
		lea	ecx, [edx+4]
		test	ecx, ecx
		jz	short loc_10009DE0
		mov	eax, [esi]
		mov	[ecx], eax

loc_10009DE0:				; CODE XREF: sub_10009DBD+1Dj
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10009DEB
		mov	eax, [esi]
		mov	[ecx], eax

loc_10009DEB:				; CODE XREF: sub_10009DBD+28j
		mov	eax, edx
		pop	esi
		retn
sub_10009DBD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009DEF	proc near		; CODE XREF: sub_100087D6+2p
					; sub_10010C6D+4p
		push	esi
		push	0
		push	1
		mov	esi, ecx
		call	sub_10008782
		mov	edx, eax
		pop	ecx
		pop	ecx
		test	edx, edx
		jz	short loc_10009E07
		mov	ecx, [esi]
		mov	[edx], ecx

loc_10009E07:				; CODE XREF: sub_10009DEF+12j
		lea	ecx, [edx+4]
		test	ecx, ecx
		jz	short loc_10009E12
		mov	eax, [esi]
		mov	[ecx], eax

loc_10009E12:				; CODE XREF: sub_10009DEF+1Dj
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10009E1D
		mov	eax, [esi]
		mov	[ecx], eax

loc_10009E1D:				; CODE XREF: sub_10009DEF+28j
		mov	eax, edx
		pop	esi
		retn
sub_10009DEF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009E21	proc near		; CODE XREF: sub_1000A1C0+Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	esi
		mov	esi, [ecx]
		mov	edx, esi
		mov	eax, [esi+4]
		mov	ecx, eax
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10009E5B
		push	edi
		mov	edi, [ebx]

loc_10009E39:				; CODE XREF: sub_10009E21+37j
		cmp	[ecx+10h], edi
		jnb	short loc_10009E43
		mov	ecx, [ecx+8]
		jmp	short loc_10009E54
; ---------------------------------------------------------------------------

loc_10009E43:				; CODE XREF: sub_10009E21+1Bj
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10009E50
		cmp	edi, [ecx+10h]
		jnb	short loc_10009E50
		mov	edx, ecx

loc_10009E50:				; CODE XREF: sub_10009E21+26j
					; sub_10009E21+2Bj
		mov	esi, ecx
		mov	ecx, [ecx]

loc_10009E54:				; CODE XREF: sub_10009E21+20j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10009E39
		pop	edi

loc_10009E5B:				; CODE XREF: sub_10009E21+13j
		cmp	byte ptr [edx+0Dh], 0
		jnz	short loc_10009E63
		mov	eax, [edx]

loc_10009E63:				; CODE XREF: sub_10009E21+3Ej
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10009E7F
		mov	ecx, [ebx]

loc_10009E6B:				; CODE XREF: sub_10009E21+5Cj
		cmp	ecx, [eax+10h]
		jnb	short loc_10009E76
		mov	edx, eax
		mov	eax, [eax]
		jmp	short loc_10009E79
; ---------------------------------------------------------------------------

loc_10009E76:				; CODE XREF: sub_10009E21+4Dj
		mov	eax, [eax+8]

loc_10009E79:				; CODE XREF: sub_10009E21+53j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10009E6B

loc_10009E7F:				; CODE XREF: sub_10009E21+46j
		mov	eax, [esp+8+arg_0]
		mov	[eax], esi
		pop	esi
		mov	[eax+4], edx
		pop	ebx
		retn	8
sub_10009E21	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10009E8D(void *)
sub_10009E8D	proc near		; CODE XREF: sub_10009E8D+16p
					; sub_10009F02+8p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	ebx, ecx
		mov	esi, edi
		cmp	byte ptr [edi+0Dh], 0
		jnz	short loc_10009EB9

loc_10009E9E:				; CODE XREF: sub_10009E8D+2Aj
		push	dword ptr [esi+8] ; void *
		mov	ecx, ebx
		call	sub_10009E8D
		mov	esi, [esi]
		push	edi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		cmp	byte ptr [esi+0Dh], 0
		mov	edi, esi
		pop	ecx
		jz	short loc_10009E9E

loc_10009EB9:				; CODE XREF: sub_10009E8D+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_10009E8D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009EBF	proc near		; CODE XREF: sub_10004FA8+ACp
					; sub_10004FA8+DCp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, [edx]
		mov	eax, [esi+8]
		mov	[edx], eax
		mov	eax, [esi+8]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10009ED7
		mov	[eax+4], edx

loc_10009ED7:				; CODE XREF: sub_10009EBF+13j
		mov	eax, [edx+4]
		mov	[esi+4], eax
		mov	eax, [ecx]
		cmp	edx, [eax+4]
		jnz	short loc_10009EE9
		mov	[eax+4], esi
		jmp	short loc_10009EF8
; ---------------------------------------------------------------------------

loc_10009EE9:				; CODE XREF: sub_10009EBF+23j
		mov	eax, [edx+4]
		cmp	edx, [eax+8]
		jnz	short loc_10009EF6
		mov	[eax+8], esi
		jmp	short loc_10009EF8
; ---------------------------------------------------------------------------

loc_10009EF6:				; CODE XREF: sub_10009EBF+30j
		mov	[eax], esi

loc_10009EF8:				; CODE XREF: sub_10009EBF+28j
					; sub_10009EBF+35j
		mov	[esi+8], edx
		mov	[edx+4], esi
		pop	esi
		retn	4
sub_10009EBF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009F02	proc near		; CODE XREF: sub_1000A171+16p
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4] ; void *
		call	sub_10009E8D
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		and	dword ptr [esi+4], 0
		pop	esi
		retn
sub_10009F02	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009F23	proc near		; CODE XREF: sub_1000942D+93p
					; sub_1000CE06+64p ...

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, ecx
		call	sub_100024E3
		pop	ecx
		push	eax
		push	[esp+8+arg_0]
		mov	ecx, esi
		push	dword ptr [esi+10h]
		push	0
		call	sub_10004188
		pop	esi
		retn	4
sub_10009F23	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10009F45(int, void *)
sub_10009F45	proc near		; CODE XREF: StartAddress+164p
					; sub_1000A171+35p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		push	esi
		mov	ebp, ecx
		lea	ecx, [esp+0Ch+arg_4]
		push	edi
		call	sub_1000CDCC
		mov	ecx, [ebx]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10009F65
		mov	edi, [ebx+8]
		jmp	short loc_10009F7D
; ---------------------------------------------------------------------------

loc_10009F65:				; CODE XREF: sub_10009F45+19j
		mov	eax, [ebx+8]
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10009F72
		mov	edi, ecx
		jmp	short loc_10009F7D
; ---------------------------------------------------------------------------

loc_10009F72:				; CODE XREF: sub_10009F45+27j
		mov	edx, [esp+10h+arg_4]
		mov	edi, [edx+8]
		cmp	edx, ebx
		jnz	short loc_10009FED

loc_10009F7D:				; CODE XREF: sub_10009F45+1Ej
					; sub_10009F45+2Bj
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [ebx+4]
		jnz	short loc_10009F89
		mov	[edi+4], esi

loc_10009F89:				; CODE XREF: sub_10009F45+3Fj
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_10009F96
		mov	[eax+4], edi
		jmp	short loc_10009FA1
; ---------------------------------------------------------------------------

loc_10009F96:				; CODE XREF: sub_10009F45+4Aj
		cmp	[esi], ebx
		jnz	short loc_10009F9E
		mov	[esi], edi
		jmp	short loc_10009FA1
; ---------------------------------------------------------------------------

loc_10009F9E:				; CODE XREF: sub_10009F45+53j
		mov	[esi+8], edi

loc_10009FA1:				; CODE XREF: sub_10009F45+4Fj
					; sub_10009F45+57j
		mov	edx, [ebp+0]
		cmp	[edx], ebx
		jnz	short loc_10009FC4
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_10009FB2
		mov	eax, esi
		jmp	short loc_10009FC2
; ---------------------------------------------------------------------------

loc_10009FB2:				; CODE XREF: sub_10009F45+67j
		mov	ecx, [edi]
		mov	eax, edi
		jmp	short loc_10009FBC
; ---------------------------------------------------------------------------

loc_10009FB8:				; CODE XREF: sub_10009F45+7Bj
		mov	eax, ecx
		mov	ecx, [eax]

loc_10009FBC:				; CODE XREF: sub_10009F45+71j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10009FB8

loc_10009FC2:				; CODE XREF: sub_10009F45+6Bj
		mov	[edx], eax

loc_10009FC4:				; CODE XREF: sub_10009F45+61j
		mov	edx, [ebp+0]
		cmp	[edx+8], ebx
		jnz	short loc_1000A044
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_10009FD6
		mov	eax, esi
		jmp	short loc_10009FE8
; ---------------------------------------------------------------------------

loc_10009FD6:				; CODE XREF: sub_10009F45+8Bj
		mov	ecx, [edi+8]
		mov	eax, edi
		jmp	short loc_10009FE2
; ---------------------------------------------------------------------------

loc_10009FDD:				; CODE XREF: sub_10009F45+A1j
		mov	eax, ecx
		mov	ecx, [eax+8]

loc_10009FE2:				; CODE XREF: sub_10009F45+96j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10009FDD

loc_10009FE8:				; CODE XREF: sub_10009F45+8Fj
		mov	[edx+8], eax
		jmp	short loc_1000A044
; ---------------------------------------------------------------------------

loc_10009FED:				; CODE XREF: sub_10009F45+36j
		mov	[ecx+4], edx
		mov	eax, [ebx]
		mov	[edx], eax
		cmp	edx, [ebx+8]
		jnz	short loc_10009FFD
		mov	esi, edx
		jmp	short loc_1000A017
; ---------------------------------------------------------------------------

loc_10009FFD:				; CODE XREF: sub_10009F45+B2j
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [edx+4]
		jnz	short loc_1000A009
		mov	[edi+4], esi

loc_1000A009:				; CODE XREF: sub_10009F45+BFj
		mov	[esi], edi
		mov	eax, [ebx+8]
		mov	[edx+8], eax
		mov	eax, [ebx+8]
		mov	[eax+4], edx

loc_1000A017:				; CODE XREF: sub_10009F45+B6j
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_1000A024
		mov	[eax+4], edx
		jmp	short loc_1000A032
; ---------------------------------------------------------------------------

loc_1000A024:				; CODE XREF: sub_10009F45+D8j
		mov	eax, [ebx+4]
		cmp	[eax], ebx
		jnz	short loc_1000A02F
		mov	[eax], edx
		jmp	short loc_1000A032
; ---------------------------------------------------------------------------

loc_1000A02F:				; CODE XREF: sub_10009F45+E4j
		mov	[eax+8], edx

loc_1000A032:				; CODE XREF: sub_10009F45+DDj
					; sub_10009F45+E8j
		mov	eax, [ebx+4]
		mov	[edx+4], eax
		mov	al, [ebx+0Ch]
		mov	cl, [edx+0Ch]
		mov	[edx+0Ch], al
		mov	[ebx+0Ch], cl

loc_1000A044:				; CODE XREF: sub_10009F45+85j
					; sub_10009F45+A6j
		cmp	byte ptr [ebx+0Ch], 1
		jnz	loc_1000A14E
		jmp	loc_1000A107
; ---------------------------------------------------------------------------

loc_1000A053:				; CODE XREF: sub_10009F45+1C8j
		cmp	byte ptr [edi+0Ch], 1
		jnz	loc_1000A14A
		mov	ecx, [esi]
		cmp	edi, ecx
		jnz	short loc_1000A0CF
		mov	ecx, [esi+8]
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000A07F
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_100057C3
		mov	ecx, [esi+8]

loc_1000A07F:				; CODE XREF: sub_10009F45+125j
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_1000A102
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000A096
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jz	short loc_1000A0FE

loc_1000A096:				; CODE XREF: sub_10009F45+146j
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000A0B4
		mov	eax, [ecx]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_10009EBF
		mov	ecx, [esi+8]

loc_1000A0B4:				; CODE XREF: sub_10009F45+158j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx+8]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_100057C3
		jmp	short loc_1000A14A
; ---------------------------------------------------------------------------

loc_1000A0CF:				; CODE XREF: sub_10009F45+11Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000A0E7
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_10009EBF
		mov	ecx, [esi]

loc_1000A0E7:				; CODE XREF: sub_10009F45+18Ej
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_1000A102
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000A115
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000A115

loc_1000A0FE:				; CODE XREF: sub_10009F45+14Fj
		mov	byte ptr [ecx+0Ch], 0

loc_1000A102:				; CODE XREF: sub_10009F45+13Ej
					; sub_10009F45+1A6j
		mov	edi, esi
		mov	esi, [esi+4]

loc_1000A107:				; CODE XREF: sub_10009F45+109j
		mov	eax, [ebp+0]
		cmp	edi, [eax+4]
		jnz	loc_1000A053
		jmp	short loc_1000A14A
; ---------------------------------------------------------------------------

loc_1000A115:				; CODE XREF: sub_10009F45+1AFj
					; sub_10009F45+1B7j
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000A132
		mov	eax, [ecx+8]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_100057C3
		mov	ecx, [esi]

loc_1000A132:				; CODE XREF: sub_10009F45+1D6j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_10009EBF

loc_1000A14A:				; CODE XREF: sub_10009F45+112j
					; sub_10009F45+188j ...
		mov	byte ptr [edi+0Ch], 1

loc_1000A14E:				; CODE XREF: sub_10009F45+103j
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [ebp+4]
		pop	ecx
		test	eax, eax
		jz	short loc_1000A160
		dec	eax
		mov	[ebp+4], eax

loc_1000A160:				; CODE XREF: sub_10009F45+215j
		mov	eax, [esp+10h+arg_0]
		mov	ecx, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ecx
		pop	ebx
		retn	8
sub_10009F45	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000A171(int, void *, int)
sub_1000A171	proc near		; CODE XREF: sub_10008F93+Ep
					; sub_1000A1C0+39p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		cmp	esi, [eax]
		jnz	short loc_1000A1AE
		cmp	[ebp+arg_8], eax
		jnz	short loc_1000A1AE
		call	sub_10009F02
		mov	eax, [edi]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		jmp	short loc_1000A1B8
; ---------------------------------------------------------------------------

loc_1000A197:				; CODE XREF: sub_1000A171+40j
		lea	ecx, [ebp+arg_4]
		call	sub_1000CDCC
		push	esi		; void *
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax		; int
		call	sub_10009F45
		mov	esi, [ebp+arg_4]

loc_1000A1AE:				; CODE XREF: sub_1000A171+Fj
					; sub_1000A171+14j
		cmp	esi, [ebp+arg_8]
		jnz	short loc_1000A197
		mov	eax, [ebp+arg_0]
		mov	[eax], esi

loc_1000A1B8:				; CODE XREF: sub_1000A171+24j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000A171	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A1C0	proc near		; CODE XREF: sub_100091B7+E2p
					; StartAddress+BEp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	[ebp+arg_0]
		lea	eax, [ebp+var_8]
		mov	esi, ecx
		push	eax
		call	sub_10009E21
		and	[ebp+arg_0], 0
		lea	eax, [ebp+arg_0]
		push	[ebp+arg_0]
		push	eax
		push	[ebp+var_4]
		push	[ebp+var_8]
		call	sub_10008849
		add	esp, 10h
		lea	eax, [ebp+var_4]
		mov	ecx, esi
		push	[ebp+var_4]	; int
		push	[ebp+var_8]	; void *
		push	eax		; int
		call	sub_1000A171
		mov	eax, [ebp+arg_0]
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000A1C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A208	proc near		; CODE XREF: sub_100055F9+7Bp
					; sub_100094F0+1Fp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		mov	esi, ecx
		push	edi
		call	sub_1000576A
		mov	edx, [esi]
		cmp	eax, edx
		jz	short loc_1000A228
		mov	ecx, [edi]
		mov	[ebp+arg_4], eax
		cmp	ecx, [eax+10h]
		jnb	short loc_1000A22B

loc_1000A228:				; CODE XREF: sub_1000A208+14j
		mov	[ebp+arg_4], edx

loc_1000A22B:				; CODE XREF: sub_1000A208+1Ej
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+arg_4]
		mov	ecx, [ecx]
		pop	edi
		pop	esi
		mov	[eax], ecx
		pop	ebp
		retn	8
sub_1000A208	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A23B	proc near		; CODE XREF: sub_10017AA5+321p

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jnz	??_V@YAXPAX@Z	; operator delete[](void *)
		retn
sub_1000A23B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000A247(void	*, int,	int)
sub_1000A247	proc near		; CODE XREF: sub_10017AA5+50p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	28h
		push	offset stru_100300A8
		call	__SEH_prolog4
		mov	ecx, [ebp+arg_0]
		test	ecx, ecx
		jz	loc_1000A38D
		mov	edi, [ebp+arg_4]
		cmp	edi, 40h
		jb	loc_1000A38D
		cmp	edi, 400h
		ja	loc_1000A38D
		and	[ebp+var_24], 0
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	edx, [ecx+3Ch]
		mov	[ebp+var_20], edx
		mov	[ebp+var_30], edx
		imul	esi, edx, 0Ch
		add	esi, 4Ch
		mov	[ebp+var_1C], esi
		push	ecx
		push	edx
		call	sub_1000A395
		mov	ebx, eax
		mov	[ebp+var_34], ebx
		push	ebx
		push	esi
		push	edi
		call	sub_1000A53F
		add	esp, 14h
		test	al, al
		jz	loc_1000A386
		mov	eax, [ebp+arg_8]
		mov	[eax], ebx
		push	ebx
		call	sub_1001AAE8
		mov	esi, eax
		mov	[ebp+var_24], esi
		mov	[ebp+var_38], esi
		push	ebx		; size_t
		push	[ebp+arg_0]	; void *
		push	esi		; void *
		call	memcpy
		add	esp, 10h
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		cmp	[esi+3Ch], eax
		jnz	loc_1000A373
		push	esi
		push	eax
		call	sub_1000A395
		pop	ecx
		pop	ecx
		cmp	eax, ebx
		jnz	loc_1000A373
		push	ebx
		push	[ebp+var_1C]
		push	edi
		call	sub_1000A53F
		add	esp, 0Ch
		test	al, al
		jz	short loc_1000A373
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		lea	eax, [esi+ebx]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		add	eax, esi
		mov	[ebp+var_28], eax
		xor	ebx, ebx
		mov	edi, [ebp+var_20]
		test	edi, edi
		jz	short loc_1000A366

loc_1000A321:				; CODE XREF: sub_1000A247+11Dj
		and	[ebp+arg_0], 0
		lea	eax, [ebp+var_20]
		push	eax
		lea	eax, [ebp+arg_0]
		push	eax
		push	ebx
		mov	ecx, esi
		call	sub_1000A509
		mov	edx, eax
		test	edx, edx
		jz	short loc_1000A36A
		mov	ecx, [ebp+var_20]
		dec	ecx
		cmp	ecx, 5
		ja	short loc_1000A36A
		cmp	edx, esi
		jb	short loc_1000A36A
		cmp	edx, [ebp+var_28]
		jb	short loc_1000A36A
		mov	ecx, [ebp+var_2C]
		cmp	edx, ecx
		ja	short loc_1000A36A
		mov	eax, [ebp+arg_0]
		add	eax, edx
		cmp	eax, edx
		jb	short loc_1000A36A
		cmp	eax, ecx
		ja	short loc_1000A36A
		inc	ebx
		cmp	ebx, edi
		jnz	short loc_1000A321

loc_1000A366:				; CODE XREF: sub_1000A247+D8j
		mov	eax, esi
		jmp	short loc_1000A38F
; ---------------------------------------------------------------------------

loc_1000A36A:				; CODE XREF: sub_1000A247+F2j
					; sub_1000A247+FBj ...
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		jmp	short loc_1000A38D
; ---------------------------------------------------------------------------

loc_1000A373:				; CODE XREF: sub_1000A247+94j
					; sub_1000A247+A5j ...
		push	esi
		jmp	short loc_1000A380
; ---------------------------------------------------------------------------

loc_1000A376:				; DATA XREF: .rdata:stru_100300A8o
		xor	eax, eax	; Exception filter 0 for function 1000A247
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A37A:				; DATA XREF: .rdata:stru_100300A8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000A247
		push	[ebp+var_24]	; void *

loc_1000A380:				; CODE XREF: sub_1000A247+12Dj
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_1000A386:				; CODE XREF: sub_1000A247+62j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000A38D:				; CODE XREF: sub_1000A247+11j
					; sub_1000A247+1Dj ...
		xor	eax, eax

loc_1000A38F:				; CODE XREF: sub_1000A247+121j
		call	__SEH_epilog4
		retn
sub_1000A247	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A395	proc near		; CODE XREF: sub_1000A247+4Bp
					; sub_1000A247+9Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 9		; switch 10 cases
		ja	short loc_1000A3FE ; jumptable 1000A3A0	default	case
		jmp	ds:off_1000A405[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000A3A7:				; CODE XREF: sub_1000A395+Bj
					; DATA XREF: .text:off_1000A405o
		mov	eax, [ebp+arg_4] ; jumptable 1000A3A0 case 1
		mov	eax, [eax+50h]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3AF:				; CODE XREF: sub_1000A395+Bj
					; DATA XREF: .text:off_1000A405o
		mov	eax, [ebp+arg_4] ; jumptable 1000A3A0 case 2
		mov	eax, [eax+5Ch]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3B7:				; CODE XREF: sub_1000A395+Bj
					; DATA XREF: .text:off_1000A405o
		mov	eax, [ebp+arg_4] ; jumptable 1000A3A0 case 3
		mov	eax, [eax+68h]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3BF:				; CODE XREF: sub_1000A395+Bj
					; DATA XREF: .text:off_1000A405o
		mov	eax, [ebp+arg_4] ; jumptable 1000A3A0 case 4
		mov	eax, [eax+74h]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3C7:				; CODE XREF: sub_1000A395+Bj
					; DATA XREF: .text:off_1000A405o
		mov	eax, [ebp+arg_4] ; jumptable 1000A3A0 case 5
		mov	eax, [eax+80h]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3D2:				; CODE XREF: sub_1000A395+Bj
					; DATA XREF: .text:off_1000A405o
		mov	eax, [ebp+arg_4] ; jumptable 1000A3A0 case 6
		mov	eax, [eax+8Ch]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3DD:				; CODE XREF: sub_1000A395+Bj
					; DATA XREF: .text:off_1000A405o
		mov	eax, [ebp+arg_4] ; jumptable 1000A3A0 case 7
		mov	eax, [eax+98h]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3E8:				; CODE XREF: sub_1000A395+Bj
					; DATA XREF: .text:off_1000A405o
		mov	eax, [ebp+arg_4] ; jumptable 1000A3A0 case 8
		mov	eax, [eax+0A4h]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3F3:				; CODE XREF: sub_1000A395+Bj
					; DATA XREF: .text:off_1000A405o
		mov	eax, [ebp+arg_4] ; jumptable 1000A3A0 case 9
		mov	eax, [eax+0B0h]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A3FE:				; CODE XREF: sub_1000A395+9j
					; sub_1000A395+Bj
					; DATA XREF: ...
		xor	eax, eax	; jumptable 1000A3A0 default case
		pop	ebp
		retn
sub_1000A395	endp

; ---------------------------------------------------------------------------
		db 8Dh,	49h, 0
off_1000A405	dd offset loc_1000A3FE	; DATA XREF: sub_1000A395+Br
		dd offset loc_1000A3A7	; jump table for switch	statement
		dd offset loc_1000A3AF
		dd offset loc_1000A3B7
		dd offset loc_1000A3BF
		dd offset loc_1000A3C7
		dd offset loc_1000A3D2
		dd offset loc_1000A3DD
		dd offset loc_1000A3E8
		dd offset loc_1000A3F3

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A42D	proc near		; CODE XREF: sub_10017818+B1p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_0]
		call	sub_1000A509
		test	eax, eax
		jz	short loc_1000A461
		cmp	[ebp+var_4], 4
		jnz	short loc_1000A461
		cmp	[ebp+var_8], 2
		jnz	short loc_1000A461
		mov	ecx, [eax]
		mov	eax, [ebp+arg_4]
		mov	[eax], ecx
		mov	al, 1
		jmp	short loc_1000A463
; ---------------------------------------------------------------------------

loc_1000A461:				; CODE XREF: sub_1000A42D+1Bj
					; sub_1000A42D+21j ...
		xor	al, al

loc_1000A463:				; CODE XREF: sub_1000A42D+32j
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000A42D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A469	proc near		; CODE XREF: sub_10017818+EBp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_0]
		call	sub_1000A509
		cmp	[ebp+var_8], 1
		mov	ecx, eax
		jnz	short loc_1000A4C5
		mov	eax, [ebp+var_4]
		test	eax, eax
		jnz	short loc_1000A4AD
		push	esi
		mov	esi, offset SubKey
		push	esi
		call	sub_100024E3
		pop	ecx
		mov	ecx, [ebp+arg_4]
		push	eax		; int
		push	esi		; void *
		call	sub_100023C8
		mov	al, 1
		pop	esi
		jmp	short loc_1000A4C7
; ---------------------------------------------------------------------------

loc_1000A4AD:				; CODE XREF: sub_1000A469+26j
		test	ecx, ecx
		jz	short loc_1000A4C5
		test	al, 1
		jnz	short loc_1000A4C5
		shr	eax, 1
		push	eax		; int
		push	ecx		; void *
		mov	ecx, [ebp+arg_4]
		call	sub_10003950
		mov	al, 1
		jmp	short loc_1000A4C7
; ---------------------------------------------------------------------------

loc_1000A4C5:				; CODE XREF: sub_1000A469+1Fj
					; sub_1000A469+46j ...
		xor	al, al

loc_1000A4C7:				; CODE XREF: sub_1000A469+42j
					; sub_1000A469+5Aj
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000A469	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A4CD	proc near		; CODE XREF: sub_10017818+9Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_0]
		call	sub_1000A509
		test	eax, eax
		jz	short loc_1000A501
		cmp	[ebp+var_4], 4
		jnz	short loc_1000A501
		cmp	[ebp+var_8], 4
		jnz	short loc_1000A501
		mov	ecx, [eax]
		mov	eax, [ebp+arg_4]
		mov	[eax], ecx
		mov	al, 1
		jmp	short loc_1000A503
; ---------------------------------------------------------------------------

loc_1000A501:				; CODE XREF: sub_1000A4CD+1Bj
					; sub_1000A4CD+21j ...
		xor	al, al

loc_1000A503:				; CODE XREF: sub_1000A4CD+32j
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000A4CD	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A509	proc near		; CODE XREF: sub_1000A247+E9p
					; sub_1000A42D+14p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, ecx
		cmp	edx, [esi+3Ch]
		jb	short loc_1000A519
		xor	eax, eax
		jmp	short loc_1000A53B
; ---------------------------------------------------------------------------

loc_1000A519:				; CODE XREF: sub_1000A509+Aj
		lea	eax, [edx+6]
		imul	edx, 0Ch
		imul	eax, 0Ch
		mov	ecx, [eax+esi]
		mov	eax, [esp+4+arg_4]
		mov	[eax], ecx
		mov	eax, [esp+4+arg_8]
		mov	ecx, [edx+esi+40h]
		mov	[eax], ecx
		mov	eax, [edx+esi+44h]
		add	eax, esi

loc_1000A53B:				; CODE XREF: sub_1000A509+Ej
		pop	esi
		retn	0Ch
sub_1000A509	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A53F	proc near		; CODE XREF: sub_1000A247+58p
					; sub_1000A247+B0p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jb	short loc_1000A560
		cmp	[ebp+arg_4], 4Ch
		jb	short loc_1000A560
		mov	ecx, [ebp+arg_8]
		cmp	ecx, eax
		ja	short loc_1000A560
		cmp	ecx, [ebp+arg_4]
		jb	short loc_1000A560
		mov	al, 1
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000A560:				; CODE XREF: sub_1000A53F+9j
					; sub_1000A53F+Fj ...
		xor	al, al
		pop	ebp
		retn
sub_1000A53F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A564	proc near		; CODE XREF: sub_1000A590+16p
					; sub_10016BEB+15p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		xor	edx, edx

loc_1000A56D:				; CODE XREF: sub_1000A564+15j
		mov	eax, [ecx+edx*4]
		cmp	eax, [esi+edx*4]
		jnz	short loc_1000A584
		inc	edx
		cmp	edx, 0Ah
		jnz	short loc_1000A56D
		mov	[ebp+arg_0], 1
		jmp	short loc_1000A588
; ---------------------------------------------------------------------------

loc_1000A584:				; CODE XREF: sub_1000A564+Fj
		and	[ebp+arg_0], 0

loc_1000A588:				; CODE XREF: sub_1000A564+1Ej
		mov	al, byte ptr [ebp+arg_0]
		pop	esi
		pop	ebp
		retn	4
sub_1000A564	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A590	proc near		; DATA XREF: .rdata:off_1001D0DCo
					; .rdata:off_1001D0E8o	...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, [edi+4]
		jmp	short loc_1000A5B2
; ---------------------------------------------------------------------------

loc_1000A5A1:				; CODE XREF: sub_1000A590+25j
		push	[ebp+arg_0]
		mov	ecx, esi
		call	sub_1000A564
		test	al, al
		jnz	short loc_1000A5C1
		add	esi, 2Ch

loc_1000A5B2:				; CODE XREF: sub_1000A590+Fj
		cmp	esi, [edi+8]
		jnz	short loc_1000A5A1
		xor	eax, eax

loc_1000A5B9:				; CODE XREF: sub_1000A590+3Bj
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
; ---------------------------------------------------------------------------

loc_1000A5C1:				; CODE XREF: sub_1000A590+1Dj
		mov	eax, [ebp+arg_4]
		mov	ecx, [esi+28h]
		mov	[eax], ecx
		mov	eax, edi
		jmp	short loc_1000A5B9
sub_1000A590	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A5CD	proc near		; CODE XREF: sub_10017AA5+3Ep
					; sub_10017AA5+2FAp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		mov	eax, [esp+arg_0]
		and	dword ptr [ecx+0Ch], 0
		mov	[ecx+4], eax
		retn
sub_1000A5CD	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A5DD	proc near		; CODE XREF: sub_10017AA5+2D4p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		and	dword ptr [eax+4], 0
		retn
sub_1000A5DD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_1000A5E6	proc near		; DATA XREF: .rdata:1001D788o
		jmp	sub_10014477
sub_1000A5E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A5EB	proc near		; DATA XREF: .rdata:1001D784o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		test	eax, eax
		jnz	short loc_1000A601
		mov	eax, 0C000000Dh
		jmp	short loc_1000A648
; ---------------------------------------------------------------------------

loc_1000A601:				; CODE XREF: sub_1000A5EB+Dj
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001CAC8
		mov	[ebp+var_4], eax
		call	sub_10005F17
		test	al, al
		jnz	short loc_1000A61E
		mov	eax, 0C000007Bh
		jmp	short loc_1000A648
; ---------------------------------------------------------------------------

loc_1000A61E:				; CODE XREF: sub_1000A5EB+2Aj
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_8]
		call	sub_10005C93
		mov	[esi+0Ch], eax
		test	eax, eax
		jnz	short loc_1000A637
		mov	eax, 0C000007Ah
		jmp	short loc_1000A648
; ---------------------------------------------------------------------------

loc_1000A637:				; CODE XREF: sub_1000A5EB+43j
		push	dword ptr [eax]
		lea	ecx, [ebp+var_8]
		call	sub_10005EE3
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		xor	eax, eax

loc_1000A648:				; CODE XREF: sub_1000A5EB+14j
					; sub_1000A5EB+31j ...
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000A5EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A64F	proc near		; DATA XREF: .rdata:1001D77Co

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	esi
		push	edi
		push	[ebp+arg_18]
		mov	edi, [ebp+arg_14]
		mov	esi, ecx
		push	edi
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		mov	eax, [esi]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword ptr [eax+14h]
		test	eax, eax
		js	short loc_1000A6E7
		push	ebx
		xor	ebx, ebx
		cmp	[esi+0Ch], ebx
		jnz	short loc_1000A687
		mov	eax, 0C000000Dh
		jmp	short loc_1000A6E6
; ---------------------------------------------------------------------------

loc_1000A687:				; CODE XREF: sub_1000A64F+2Fj
		push	dword ptr [esi+8]
		mov	ecx, esi
		push	dword ptr [esi+4]
		push	[ebp+arg_18]
		push	edi
		call	sub_10014480
		test	al, al
		jnz	short loc_1000A6A3
		mov	eax, 0C0000023h
		jmp	short loc_1000A6E6
; ---------------------------------------------------------------------------

loc_1000A6A3:				; CODE XREF: sub_1000A64F+4Bj
		push	4
		push	4
		push	dword ptr [esi+0Ch]
		lea	ecx, [ebp+var_10]
		mov	[ebp+var_10], bl
		mov	[ebp+var_C], ebx
		mov	[ebp+var_8], ebx
		mov	[ebp+var_4], ebx
		call	sub_10015B24
		mov	ebx, eax
		test	ebx, ebx
		js	short loc_1000A6DC
		mov	ecx, [esi+0Ch]
		sub	edi, [ebp+arg_0]
		mov	[ecx], edi
		mov	edi, [ebp+arg_1C]
		test	edi, edi
		jz	short loc_1000A6DC
		mov	eax, [esi]
		mov	ecx, esi
		call	dword ptr [eax+10h]
		mov	[edi], eax

loc_1000A6DC:				; CODE XREF: sub_1000A64F+73j
					; sub_1000A64F+82j
		lea	ecx, [ebp+var_10]
		call	sub_10015F6F
		mov	eax, ebx

loc_1000A6E6:				; CODE XREF: sub_1000A64F+36j
					; sub_1000A64F+52j
		pop	ebx

loc_1000A6E7:				; CODE XREF: sub_1000A64F+27j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	20h
sub_1000A64F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A6EF	proc near		; CODE XREF: sub_1000AD42+1Ep

var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	[ebp+arg_8]
		lea	eax, [ebp+var_1]
		push	0
		push	eax
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1000A713
		add	esp, 18h
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000A6EF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A713	proc near		; CODE XREF: sub_1000A6EF+16p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+arg_8]
		cmp	edx, [ebp+arg_4]
		jz	short loc_1000A73D
		push	esi
		push	edi

loc_1000A723:				; CODE XREF: sub_1000A713+26j
		test	eax, eax
		jz	short loc_1000A730
		push	0Bh
		pop	ecx
		mov	esi, edx
		mov	edi, eax
		rep movsd

loc_1000A730:				; CODE XREF: sub_1000A713+12j
		add	edx, 2Ch
		add	eax, 2Ch
		cmp	edx, [ebp+arg_4]
		jnz	short loc_1000A723
		pop	edi
		pop	esi

loc_1000A73D:				; CODE XREF: sub_1000A713+Cj
		pop	ebp
		retn
sub_1000A713	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A73F	proc near		; CODE XREF: sub_1000A7BC+4Dp
					; sub_1000A8A5+4Dp ...
		push	3
		mov	dword ptr [ecx], 4
		lea	eax, [ecx+4]
		pop	edx

loc_1000A74B:				; CODE XREF: sub_1000A73F+17j
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	edx
		jns	short loc_1000A74B
		mov	eax, ecx
		retn
sub_1000A73F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A75B	proc near		; CODE XREF: sub_10016099+DBp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	eax, eax
		push	offset dword_1001D0F4
		lea	esi, [edi+4]
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_0]
		mov	dword ptr [edi], offset	off_1001D0E8
		mov	[edi+10h], eax
		call	sub_1000ADE8
		push	offset dword_1001D120
		mov	ecx, esi
		call	sub_1000ADE8
		push	offset dword_1001D14C
		mov	ecx, esi
		call	sub_1000ADE8
		push	offset dword_1001D178
		mov	ecx, esi
		call	sub_1000ADE8
		push	offset dword_1001D1A4
		mov	ecx, esi
		call	sub_1000ADE8
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_1000A75B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A7BC	proc near		; DATA XREF: .rdata:1001D11Co

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
TargetHandle	= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_0]
		push	esi
		push	esi
		call	sub_1000C388
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_1000A7F0

loc_1000A7E4:				; CODE XREF: sub_1000A7BC+BCj
		mov	dword ptr [edi+10h], 0C0000022h
		jmp	loc_1000A890
; ---------------------------------------------------------------------------

loc_1000A7F0:				; CODE XREF: sub_1000A7BC+26j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000A7FA
		mov	eax, [esi]
		jmp	short loc_1000A7FC
; ---------------------------------------------------------------------------

loc_1000A7FA:				; CODE XREF: sub_1000A7BC+38j
		mov	eax, esi

loc_1000A7FC:				; CODE XREF: sub_1000A7BC+3Cj
		lea	ecx, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	[ebp+var_30], 1
		call	sub_1000A73F
		lea	eax, [ebp+var_3C]
		mov	[ebp+var_24], 1
		mov	[ebp+var_20], eax
		lea	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		lea	eax, [ebp+arg_1C]
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_30]
		push	2
		pop	ecx
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_28]
		push	eax
		mov	[ebp+var_14], ecx
		mov	[ebp+var_C], ecx
		mov	[ebp+var_1C], ecx
		mov	ecx, [ebx+10h]
		push	3
		call	sub_100168E1
		lea	ecx, [ebp+var_2C]
		and	[ebp+var_2C], 0
		push	ecx		; int
		lea	ecx, [ebp+var_38]
		push	ecx		; int
		lea	ecx, [ebp+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_1C]	; int
		push	[ebp+arg_18]	; int
		push	[ebp+arg_14]	; int
		push	[ebp+arg_10]	; int
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	esi		; int
		push	dword ptr [edi+4] ; int
		push	eax		; int
		call	sub_1000BE96
		add	esp, 30h
		test	al, al
		jz	loc_1000A7E4
		mov	eax, [ebp+var_2C]
		mov	[edi+1Ch], eax
		mov	eax, [ebp+var_38]
		mov	[edi+10h], eax
		mov	eax, [ebp+TargetHandle]
		mov	[edi+18h], eax

loc_1000A890:				; CODE XREF: sub_1000A7BC+2Fj
		mov	ecx, [ebp+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	20h
sub_1000A7BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A8A5	proc near		; DATA XREF: .rdata:1001D148o

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
TargetHandle	= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_0]
		push	esi
		push	esi
		call	sub_1000C388
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_1000A8D9

loc_1000A8CD:				; CODE XREF: sub_1000A8A5+B6j
		mov	dword ptr [edi+10h], 0C0000022h
		jmp	loc_1000A973
; ---------------------------------------------------------------------------

loc_1000A8D9:				; CODE XREF: sub_1000A8A5+26j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000A8E3
		mov	eax, [esi]
		jmp	short loc_1000A8E5
; ---------------------------------------------------------------------------

loc_1000A8E3:				; CODE XREF: sub_1000A8A5+38j
		mov	eax, esi

loc_1000A8E5:				; CODE XREF: sub_1000A8A5+3Cj
		lea	ecx, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	[ebp+var_30], 1
		call	sub_1000A73F
		lea	eax, [ebp+var_3C]
		mov	[ebp+var_24], 1
		mov	[ebp+var_20], eax
		lea	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		lea	eax, [ebp+arg_14]
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_30]
		push	2
		pop	ecx
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_28]
		push	eax
		mov	[ebp+var_14], ecx
		mov	[ebp+var_C], ecx
		mov	[ebp+var_1C], ecx
		mov	ecx, [ebx+10h]
		push	4
		call	sub_100168E1
		and	[ebp+var_2C], 0
		lea	ecx, [ebp+var_2C]
		push	ecx		; int
		lea	ecx, [ebp+var_38]
		push	ecx		; int
		lea	ecx, [ebp+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_14]	; int
		push	[ebp+arg_10]	; int
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	esi		; int
		push	dword ptr [edi+4] ; int
		push	eax		; int
		call	sub_1000C300
		add	esp, 28h
		test	al, al
		jz	loc_1000A8CD
		mov	eax, [ebp+var_2C]
		mov	[edi+1Ch], eax
		mov	eax, [ebp+var_38]
		mov	[edi+10h], eax
		mov	eax, [ebp+TargetHandle]
		mov	[edi+18h], eax

loc_1000A973:				; CODE XREF: sub_1000A8A5+2Fj
		mov	ecx, [ebp+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	18h
sub_1000A8A5	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A988	proc near		; DATA XREF: .rdata:1001D174o

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		mov	ebx, [esp+28h+arg_C]
		push	ebp
		push	esi
		mov	esi, [esp+30h+arg_4]
		mov	ebp, ecx
		cmp	dword ptr [ebx], 28h
		push	edi
		mov	edi, [esp+34h+arg_0]
		jz	short loc_1000A9B4
		xor	al, al
		jmp	loc_1000AA40
; ---------------------------------------------------------------------------

loc_1000A9B4:				; CODE XREF: sub_1000A988+23j
		push	esi
		push	esi
		call	sub_1000C388
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_1000A9CA

loc_1000A9C1:				; CODE XREF: sub_1000A988+ADj
		mov	dword ptr [edi+10h], 0C0000022h
		jmp	short loc_1000AA3E
; ---------------------------------------------------------------------------

loc_1000A9CA:				; CODE XREF: sub_1000A988+37j
		cmp	dword ptr [esi+14h], 8
		mov	[esp+34h+var_24], 1
		jb	short loc_1000A9DC
		mov	eax, [esi]
		jmp	short loc_1000A9DE
; ---------------------------------------------------------------------------

loc_1000A9DC:				; CODE XREF: sub_1000A988+4Ej
		mov	eax, esi

loc_1000A9DE:				; CODE XREF: sub_1000A988+52j
		lea	ecx, [esp+34h+var_18]
		mov	[esp+34h+var_1C], eax
		call	sub_10018707
		mov	ecx, [ebp+10h]
		lea	eax, [esp+34h+var_1C]
		mov	[esp+34h+var_10], eax
		lea	eax, [esp+34h+var_24]
		mov	[esp+34h+var_8], eax
		lea	eax, [esp+34h+var_18]
		push	eax
		push	5
		mov	[esp+3Ch+var_14], 1
		mov	[esp+3Ch+var_C], 2
		call	sub_100168E1
		lea	ecx, [esp+34h+var_20]
		push	ecx
		push	dword ptr [ebx+4]
		push	[esp+3Ch+arg_8]
		push	esi
		push	dword ptr [edi+4]
		push	eax
		call	sub_1000C3BE
		add	esp, 18h
		test	al, al
		jz	short loc_1000A9C1
		mov	eax, [esp+34h+var_20]
		mov	[edi+10h], eax

loc_1000AA3E:				; CODE XREF: sub_1000A988+40j
		mov	al, 1

loc_1000AA40:				; CODE XREF: sub_1000A988+27j
		mov	ecx, [esp+34h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn	10h
sub_1000A988	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000AA55	proc near		; DATA XREF: .rdata:1001D1A0o

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		mov	ebx, [esp+28h+arg_C]
		push	ebp
		push	esi
		mov	esi, [esp+30h+arg_4]
		mov	ebp, ecx
		cmp	dword ptr [ebx], 38h
		push	edi
		mov	edi, [esp+34h+arg_0]
		jz	short loc_1000AA81
		xor	al, al
		jmp	loc_1000AB0D
; ---------------------------------------------------------------------------

loc_1000AA81:				; CODE XREF: sub_1000AA55+23j
		push	esi
		push	esi
		call	sub_1000C388
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_1000AA97

loc_1000AA8E:				; CODE XREF: sub_1000AA55+ADj
		mov	dword ptr [edi+10h], 0C0000022h
		jmp	short loc_1000AB0B
; ---------------------------------------------------------------------------

loc_1000AA97:				; CODE XREF: sub_1000AA55+37j
		cmp	dword ptr [esi+14h], 8
		mov	[esp+34h+var_24], 1
		jb	short loc_1000AAA9
		mov	eax, [esi]
		jmp	short loc_1000AAAB
; ---------------------------------------------------------------------------

loc_1000AAA9:				; CODE XREF: sub_1000AA55+4Ej
		mov	eax, esi

loc_1000AAAB:				; CODE XREF: sub_1000AA55+52j
		lea	ecx, [esp+34h+var_18]
		mov	[esp+34h+var_1C], eax
		call	sub_10018707
		mov	ecx, [ebp+10h]
		lea	eax, [esp+34h+var_1C]
		mov	[esp+34h+var_10], eax
		lea	eax, [esp+34h+var_24]
		mov	[esp+34h+var_8], eax
		lea	eax, [esp+34h+var_18]
		push	eax
		push	6
		mov	[esp+3Ch+var_14], 1
		mov	[esp+3Ch+var_C], 2
		call	sub_100168E1
		lea	ecx, [esp+34h+var_20]
		push	ecx
		push	dword ptr [ebx+4]
		push	[esp+3Ch+arg_8]
		push	esi
		push	dword ptr [edi+4]
		push	eax
		call	sub_1000C430
		add	esp, 18h
		test	al, al
		jz	short loc_1000AA8E
		mov	eax, [esp+34h+var_20]
		mov	[edi+10h], eax

loc_1000AB0B:				; CODE XREF: sub_1000AA55+40j
		mov	al, 1

loc_1000AB0D:				; CODE XREF: sub_1000AA55+27j
		mov	ecx, [esp+34h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn	10h
sub_1000AA55	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000AB22	proc near		; DATA XREF: .rdata:1001D1CCo

hSourceHandle	= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [esp+44h+arg_4]
		push	ebp
		mov	ebp, [esp+48h+arg_8]
		push	esi
		mov	esi, [esp+4Ch+arg_0]
		mov	[esp+4Ch+hSourceHandle], eax
		cmp	dword ptr [ebp+0], 8
		mov	eax, [esp+4Ch+arg_C]
		mov	[esp+4Ch+var_38], ecx
		jz	short loc_1000AB57
		xor	al, al
		jmp	loc_1000AC53
; ---------------------------------------------------------------------------

loc_1000AB57:				; CODE XREF: sub_1000AB22+2Cj
		push	ebx
		mov	ebx, [esp+50h+arg_10]
		cmp	ebx, [eax]
		jz	short loc_1000AB67
		xor	al, al
		jmp	loc_1000AC52
; ---------------------------------------------------------------------------

loc_1000AB67:				; CODE XREF: sub_1000AB22+3Cj
		push	edi
		push	[esp+54h+arg_14]
		mov	edi, [eax+4]
		push	ebx
		push	edi
		call	sub_10015E34
		add	esp, 0Ch
		test	al, al
		jz	loc_1000AC51
		and	[esp+54h+var_20], 0
		lea	ecx, [esp+54h+var_30]
		xor	eax, eax
		mov	[esp+54h+var_1C], 7
		mov	word ptr [esp+54h+var_30], ax
		mov	eax, [edi+8]
		shr	eax, 1
		push	eax		; int
		lea	eax, [edi+0Ch]
		push	eax		; void *
		call	sub_100023C8
		lea	eax, [esp+54h+var_30]
		push	eax
		push	eax
		call	sub_1000C388
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_1000AC32
		cmp	[esp+54h+var_1C], 8
		mov	eax, [esp+54h+var_30]
		mov	[esp+54h+var_34], 1
		jnb	short loc_1000ABD0
		lea	eax, [esp+54h+var_30]

loc_1000ABD0:				; CODE XREF: sub_1000AB22+A8j
		lea	ecx, [esp+54h+var_18]
		mov	[esp+54h+var_40], eax
		call	sub_10018707
		mov	ecx, [esp+54h+var_38]
		lea	eax, [esp+54h+var_40]
		mov	[esp+54h+var_10], eax
		lea	eax, [esp+54h+var_34]
		mov	[esp+54h+var_8], eax
		lea	eax, [esp+54h+var_18]
		push	eax
		mov	ecx, [ecx+10h]
		push	7
		mov	[esp+5Ch+var_14], 1
		mov	[esp+5Ch+var_C], 2
		call	sub_100168E1
		lea	ecx, [esp+54h+var_3C]
		push	ecx		; int
		push	dword ptr [ebp+4] ; int
		push	[esp+5Ch+arg_14] ; int
		push	ebx		; int
		push	edi		; int
		push	[esp+68h+hSourceHandle]	; hSourceHandle
		push	dword ptr [esi+4] ; int
		push	eax		; TargetHandle
		call	sub_1000C4A2
		add	esp, 20h
		test	al, al
		jnz	short loc_1000AC3B

loc_1000AC32:				; CODE XREF: sub_1000AB22+95j
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	short loc_1000AC42
; ---------------------------------------------------------------------------

loc_1000AC3B:				; CODE XREF: sub_1000AB22+10Ej
		mov	ecx, [esp+54h+var_3C]
		mov	[esi+10h], ecx

loc_1000AC42:				; CODE XREF: sub_1000AB22+117j
		push	0		; int
		push	1		; char
		lea	ecx, [esp+5Ch+var_30] ;	void *
		call	sub_100022C1
		mov	al, 1

loc_1000AC51:				; CODE XREF: sub_1000AB22+59j
		pop	edi

loc_1000AC52:				; CODE XREF: sub_1000AB22+40j
		pop	ebx

loc_1000AC53:				; CODE XREF: sub_1000AB22+30j
		mov	ecx, [esp+4Ch+var_4]
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn	18h
sub_1000AB22	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000AC66	proc near		; DATA XREF: .rdata:1001D0ECo

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		sub	eax, 3
		jz	short loc_1000ACE9
		dec	eax
		jz	short loc_1000ACD0
		dec	eax
		jz	short loc_1000ACB7
		dec	eax
		jz	short loc_1000AC9E
		dec	eax
		jnz	loc_1000AD0F
		mov	eax, offset _TargetNtSetInformationFile@24 ; TargetNtSetInformationFile(x,x,x,x,x,x)
		test	eax, eax
		jz	loc_1000AD0F
		push	0Dh
		push	offset a_targetntset_1 ; "_TargetNtSetInformationFile@24"
		push	1
		push	offset aNtsetinformati ; "NtSetInformationFile"
		jmp	short loc_1000AD00
; ---------------------------------------------------------------------------

loc_1000AC9E:				; CODE XREF: sub_1000AC66+12j
		mov	eax, offset _TargetNtQueryFullAttributesFile@12	; TargetNtQueryFullAttributesFile(x,x,x)
		test	eax, eax
		jz	short loc_1000AD0F
		push	0Ch
		push	offset a_targetntque_1 ; "_TargetNtQueryFullAttributesFile@12"
		push	1
		push	offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		jmp	short loc_1000AD00
; ---------------------------------------------------------------------------

loc_1000ACB7:				; CODE XREF: sub_1000AC66+Fj
		mov	eax, offset _TargetNtQueryAttributesFile@12 ; TargetNtQueryAttributesFile(x,x,x)
		test	eax, eax
		jz	short loc_1000AD0F
		push	0Bh
		push	offset a_targetntque_2 ; "_TargetNtQueryAttributesFile@12"
		push	1
		push	offset aNtqueryattribu ; "NtQueryAttributesFile"
		jmp	short loc_1000AD00
; ---------------------------------------------------------------------------

loc_1000ACD0:				; CODE XREF: sub_1000AC66+Cj
		mov	eax, offset _TargetNtOpenFile@28 ; TargetNtOpenFile(x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000AD0F
		push	0Ah
		push	offset a_targetntope_5 ; "_TargetNtOpenFile@28"
		push	1
		push	offset aNtopenfile ; "NtOpenFile"
		jmp	short loc_1000AD00
; ---------------------------------------------------------------------------

loc_1000ACE9:				; CODE XREF: sub_1000AC66+9j
		mov	eax, offset _TargetNtCreateFile@48 ; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000AD0F
		push	9		; int
		push	offset a_targetntcre_2 ; "_TargetNtCreateFile@48"
		push	1		; int
		push	offset aNtcreatefile ; "NtCreateFile"

loc_1000AD00:				; CODE XREF: sub_1000AC66+36j
					; sub_1000AC66+4Fj ...
		mov	ecx, [ebp+arg_0]
		push	offset aNtdll_dll ; "ntdll.dll"
		call	sub_1000EC5D
		jmp	short loc_1000AD11
; ---------------------------------------------------------------------------

loc_1000AD0F:				; CODE XREF: sub_1000AC66+15j
					; sub_1000AC66+22j ...
		xor	al, al

loc_1000AD11:				; CODE XREF: sub_1000AC66+A7j
		pop	ebp
		retn	8
sub_1000AC66	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000AD15	proc near		; CODE XREF: sub_1000AD98+3Dp

arg_0		= dword	ptr  4

		mov	eax, [ecx+8]
		sub	eax, [ecx]
		push	2Ch
		pop	ecx
		cdq
		idiv	ecx
		mov	ecx, 5D1745Dh
		mov	edx, eax
		shr	edx, 1
		sub	ecx, edx
		cmp	ecx, eax
		jnb	short loc_1000AD33
		xor	eax, eax
		jmp	short loc_1000AD35
; ---------------------------------------------------------------------------

loc_1000AD33:				; CODE XREF: sub_1000AD15+18j
		add	eax, edx

loc_1000AD35:				; CODE XREF: sub_1000AD15+1Cj
		cmp	eax, [esp+arg_0]
		jnb	short locret_1000AD3F
		mov	eax, [esp+arg_0]

locret_1000AD3F:			; CODE XREF: sub_1000AD15+24j
		retn	4
sub_1000AD15	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000AD42	proc near		; CODE XREF: sub_1000AD98+45p

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		push	0
		push	ebx
		mov	esi, ecx
		call	sub_10004EF9
		pop	ecx
		pop	ecx
		mov	edi, eax
		mov	ecx, esi
		push	edi
		push	dword ptr [esi+4]
		push	dword ptr [esi]
		call	sub_1000A6EF
		mov	eax, [esi+4]
		sub	eax, [esi]
		push	2Ch
		cdq
		pop	ecx
		idiv	ecx
		cmp	dword ptr [esi], 0
		mov	ebp, eax
		jz	short loc_1000AD7F
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1000AD7F:				; CODE XREF: sub_1000AD42+33j
		imul	ecx, ebx, 2Ch
		imul	eax, ebp, 2Ch
		mov	[esi], edi
		add	ecx, edi
		add	eax, edi
		mov	[esi+8], ecx
		pop	edi
		mov	[esi+4], eax
		pop	esi
		pop	ebp
		pop	ebx
		retn	4
sub_1000AD42	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000AD98	proc near		; CODE XREF: sub_1000ADE8+2Ap
					; sub_1000ADE8+4Fp

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		push	2Ch
		pop	ebx
		mov	eax, [esi+8]
		mov	ecx, [esi+4]
		sub	eax, ecx
		cdq
		idiv	ebx
		mov	edi, [esp+0Ch+arg_0]
		cmp	eax, edi
		jnb	short loc_1000ADE2
		sub	ecx, [esi]
		mov	eax, ecx
		mov	ecx, 5D1745Dh
		cdq
		idiv	ebx
		sub	ecx, eax
		cmp	ecx, edi
		jnb	short loc_1000ADD0
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000ADD0:				; CODE XREF: sub_1000AD98+2Bj
		add	eax, edi
		mov	ecx, esi
		push	eax
		call	sub_1000AD15
		push	eax
		mov	ecx, esi
		call	sub_1000AD42

loc_1000ADE2:				; CODE XREF: sub_1000AD98+19j
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000AD98	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000ADE8	proc near		; CODE XREF: sub_1000A75B+25p
					; sub_1000A75B+31p ...

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	ecx, [ebx+4]
		cmp	esi, ecx
		jnb	short loc_1000AE2E
		cmp	[ebx], esi
		ja	short loc_1000AE2E
		sub	esi, [ebx]
		push	ebp
		mov	eax, esi
		push	2Ch
		cdq
		pop	ebp
		idiv	ebp
		mov	esi, eax
		cmp	ecx, [ebx+8]
		jnz	short loc_1000AE17
		push	1
		mov	ecx, ebx
		call	sub_1000AD98

loc_1000AE17:				; CODE XREF: sub_1000ADE8+24j
		mov	edi, [ebx+4]
		imul	esi, 2Ch
		add	esi, [ebx]
		test	edi, edi
		jz	short loc_1000AE28
		push	0Bh
		pop	ecx
		rep movsd

loc_1000AE28:				; CODE XREF: sub_1000ADE8+39j
		add	[ebx+4], ebp
		pop	ebp
		jmp	short loc_1000AE4C
; ---------------------------------------------------------------------------

loc_1000AE2E:				; CODE XREF: sub_1000ADE8+Ej
					; sub_1000ADE8+12j
		cmp	ecx, [ebx+8]
		jnz	short loc_1000AE3C
		push	1
		mov	ecx, ebx
		call	sub_1000AD98

loc_1000AE3C:				; CODE XREF: sub_1000ADE8+49j
		mov	edi, [ebx+4]
		test	edi, edi
		jz	short loc_1000AE48
		push	0Bh
		pop	ecx
		rep movsd

loc_1000AE48:				; CODE XREF: sub_1000ADE8+59j
		add	dword ptr [ebx+4], 2Ch

loc_1000AE4C:				; CODE XREF: sub_1000ADE8+44j
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000ADE8	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000AE52(int,	int, int, int, int, void *, void *, int)
sub_1000AE52	proc near		; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+1E5p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 10h
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		mov	ecx, edi
		call	sub_1001768F
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000AE70
		push	4
		pop	eax
		jmp	loc_1000AF79
; ---------------------------------------------------------------------------

loc_1000AE70:				; CODE XREF: sub_1000AE52+14j
		mov	eax, [esp+18h+arg_4]
		lea	ecx, [esp+18h+var_10]
		push	ebx
		push	4
		pop	ebx
		push	ebx		; int
		xor	edx, edx
		mov	[esi], eax
		mov	eax, [esp+20h+arg_8]
		push	edx		; char
		push	ebx		; size_t
		mov	[esi+4], edx
		mov	dword ptr [esi+3Ch], 5
		push	ecx		; void *
		mov	dword ptr [esi+44h], 88h
		mov	ecx, esi
		mov	eax, [eax]
		push	edx		; int
		mov	[esp+30h+var_10], eax
		call	sub_1000B2EB
		test	al, al
		jz	short loc_1000AECF
		mov	eax, [esp+1Ch+arg_C]
		push	6		; int
		push	1		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; size_t
		push	eax		; void *
		mov	[esp+2Ch+var_10], ecx
		mov	ecx, esi
		push	1		; int
		mov	[esp+30h+var_C], eax
		call	sub_1000B2EB
		test	al, al
		jnz	short loc_1000AED6

loc_1000AECF:				; CODE XREF: sub_1000AE52+57j
		mov	eax, ebx
		jmp	loc_1000AF78
; ---------------------------------------------------------------------------

loc_1000AED6:				; CODE XREF: sub_1000AE52+7Bj
		mov	eax, [esp+1Ch+arg_10]
		push	ebp
		push	6		; int
		push	1		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; size_t
		push	eax		; void *
		push	2
		pop	ebp
		mov	[esp+30h+var_8], ecx
		mov	ecx, esi
		push	ebp		; int
		mov	[esp+34h+var_4], eax
		call	sub_1000B2EB
		test	al, al
		jz	short loc_1000AF75
		push	ebp		; int
		push	0		; char
		push	ebx		; size_t
		push	[esp+2Ch+arg_14] ; void	*
		mov	ecx, esi
		push	3		; int
		call	sub_1000B2EB
		test	al, al
		jz	short loc_1000AF75
		push	ebp		; int
		push	0		; char
		push	ebx		; size_t
		push	[esp+2Ch+arg_18] ; void	*
		mov	ecx, esi
		push	ebx		; int
		call	sub_1000B2EB
		test	al, al
		jz	short loc_1000AF75
		push	[esp+20h+arg_1C]
		mov	ecx, edi
		push	esi
		call	sub_100175C5
		mov	ebx, eax
		cmp	ebx, 0Ah
		jz	short loc_1000AF75
		mov	edx, [esi+50h]
		lea	ecx, [esp+20h+var_10]
		add	edx, esi
		push	edx		; void *
		call	sub_1000B4A1
		test	al, al
		jnz	short loc_1000AF51
		push	esi
		mov	ecx, edi
		jmp	short loc_1000AF67
; ---------------------------------------------------------------------------

loc_1000AF51:				; CODE XREF: sub_1000AE52+F8j
		mov	eax, [esi+5Ch]
		lea	ecx, [esp+20h+var_8]
		add	eax, esi
		push	eax		; void *
		call	sub_1000B4A1
		mov	ecx, edi
		push	esi
		test	al, al
		jnz	short loc_1000AF70

loc_1000AF67:				; CODE XREF: sub_1000AE52+FDj
		call	sub_10017671
		mov	eax, ebp
		jmp	short loc_1000AF77
; ---------------------------------------------------------------------------

loc_1000AF70:				; CODE XREF: sub_1000AE52+113j
		call	sub_10017671

loc_1000AF75:				; CODE XREF: sub_1000AE52+A9j
					; sub_1000AE52+BEj ...
		mov	eax, ebx

loc_1000AF77:				; CODE XREF: sub_1000AE52+11Cj
		pop	ebp

loc_1000AF78:				; CODE XREF: sub_1000AE52+7Fj
		pop	ebx

loc_1000AF79:				; CODE XREF: sub_1000AE52+19j
		pop	edi
		pop	esi
		add	esp, 10h
		retn
sub_1000AE52	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000AF7F(int,	int, int, void *, void *, void *, void *, int)
sub_1000AF7F	proc near		; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+197p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ecx
		mov	ecx, [esp+4+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000AF98
		push	4
		pop	eax
		jmp	loc_1000B055
; ---------------------------------------------------------------------------

loc_1000AF98:				; CODE XREF: sub_1000AF7F+Fj
		mov	eax, [esp+8+arg_4]
		lea	ecx, [esp+8+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_8]
		xor	ebp, ebp
		mov	[edi], eax
		mov	[edi+4], ebp
		mov	dword ptr [edi+3Ch], 5
		mov	dword ptr [edi+44h], 88h
		mov	esi, [esi]
		mov	[esp+10h+var_4], esi
		call	sub_1000B44B
		push	1		; int
		push	ebp		; char
		push	eax		; size_t
		push	esi		; void *
		push	ebp		; int
		mov	ecx, edi
		call	sub_1000B2EB
		test	al, al
		jnz	short loc_1000AFDC
		push	4
		pop	eax
		jmp	short loc_1000B053
; ---------------------------------------------------------------------------

loc_1000AFDC:				; CODE XREF: sub_1000AF7F+56j
		push	ebx
		push	2
		pop	ebx
		push	ebx		; int
		push	ebp		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	1		; int
		call	sub_1000B2EB
		test	al, al
		jz	short loc_1000B050
		push	ebx		; int
		push	ebp		; char
		push	esi		; size_t
		push	[esp+20h+arg_10] ; void	*
		mov	ecx, edi
		push	ebx		; int
		call	sub_1000B2EB
		test	al, al
		jz	short loc_1000B050
		push	ebx		; int
		push	ebp		; char
		push	esi		; size_t
		push	[esp+20h+arg_14] ; void	*
		mov	ecx, edi
		push	3		; int
		call	sub_1000B2EB
		test	al, al
		jz	short loc_1000B050
		push	ebx		; int
		push	ebp		; char
		push	esi		; size_t
		push	[esp+20h+arg_18] ; void	*
		mov	ecx, edi
		push	esi		; int
		call	sub_1000B2EB
		test	al, al
		jz	short loc_1000B050
		push	[esp+14h+arg_1C]
		mov	ecx, [esp+18h+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000B050
		mov	ecx, [esp+14h+arg_0]
		push	edi
		call	sub_10017671

loc_1000B050:				; CODE XREF: sub_1000AF7F+76j
					; sub_1000AF7F+89j ...
		mov	eax, esi
		pop	ebx

loc_1000B053:				; CODE XREF: sub_1000AF7F+5Bj
		pop	esi
		pop	ebp

loc_1000B055:				; CODE XREF: sub_1000AF7F+14j
		pop	edi
		pop	ecx
		retn
sub_1000AF7F	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000B058(int,	int, int, void *, void *, void *, void *, void *, void *, int)
sub_1000B058	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+1B9p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h

		push	ecx
		mov	ecx, [esp+4+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000B071
		push	4
		pop	eax
		jmp	loc_1000B15D
; ---------------------------------------------------------------------------

loc_1000B071:				; CODE XREF: sub_1000B058+Fj
		mov	eax, [esp+8+arg_4]
		lea	ecx, [esp+8+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_8]
		xor	ebp, ebp
		mov	[edi], eax
		mov	[edi+4], ebp
		mov	dword ptr [edi+3Ch], 7
		mov	dword ptr [edi+44h], 0A0h
		mov	esi, [esi]
		mov	[esp+10h+var_4], esi
		call	sub_1000B44B
		push	1		; int
		push	ebp		; char
		push	eax		; size_t
		push	esi		; void *
		push	ebp		; int
		mov	ecx, edi
		call	sub_1000B39B
		test	al, al
		jnz	short loc_1000B0B8
		push	4
		pop	eax
		jmp	loc_1000B15B
; ---------------------------------------------------------------------------

loc_1000B0B8:				; CODE XREF: sub_1000B058+56j
		push	ebx
		push	2
		pop	ebx
		push	ebx		; int
		push	ebp		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	1		; int
		call	sub_1000B39B
		test	al, al
		jz	loc_1000B158
		push	ebx		; int
		push	ebp		; char
		push	esi		; size_t
		push	[esp+20h+arg_10] ; void	*
		mov	ecx, edi
		push	ebx		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000B158
		push	ebx		; int
		push	ebp		; char
		push	esi		; size_t
		push	[esp+20h+arg_14] ; void	*
		mov	ecx, edi
		push	3		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000B158
		push	ebx		; int
		push	ebp		; char
		push	esi		; size_t
		push	[esp+20h+arg_18] ; void	*
		mov	ecx, edi
		push	esi		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000B158
		push	ebx		; int
		push	ebp		; char
		push	esi		; size_t
		push	[esp+20h+arg_1C] ; void	*
		mov	ecx, edi
		push	5		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000B158
		push	ebx		; int
		push	ebp		; char
		push	esi		; size_t
		push	[esp+20h+arg_20] ; void	*
		mov	ecx, edi
		push	6		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000B158
		push	[esp+14h+arg_24]
		mov	ecx, [esp+18h+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000B158
		mov	ecx, [esp+14h+arg_0]
		push	edi
		call	sub_10017671

loc_1000B158:				; CODE XREF: sub_1000B058+79j
					; sub_1000B058+90j ...
		mov	eax, esi
		pop	ebx

loc_1000B15B:				; CODE XREF: sub_1000B058+5Bj
		pop	esi
		pop	ebp

loc_1000B15D:				; CODE XREF: sub_1000B058+14j
		pop	edi
		pop	ecx
		retn
sub_1000B058	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000B160(int,	int, int, void *, int, int)
sub_1000B160	proc near		; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+139p
					; TargetNtQueryFullAttributesFile(x,x,x)+139p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		push	ecx
		mov	ecx, [esp+8+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000B17A
		push	4
		pop	eax
		jmp	loc_1000B237
; ---------------------------------------------------------------------------

loc_1000B17A:				; CODE XREF: sub_1000B160+10j
		mov	eax, [esp+0Ch+arg_4]
		lea	ecx, [esp+0Ch+var_8]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_8]
		xor	ebp, ebp
		mov	[edi], eax
		mov	[edi+4], ebp
		mov	dword ptr [edi+3Ch], 3
		mov	dword ptr [edi+44h], 70h
		mov	esi, [esi]
		mov	[esp+14h+var_8], esi
		call	sub_1000B44B
		push	1		; int
		push	ebp		; char
		push	eax		; size_t
		push	esi		; void *
		push	ebp		; int
		mov	ecx, edi
		call	sub_1000B23B
		test	al, al
		jz	short loc_1000B1F3
		push	2		; int
		push	ebp		; char
		push	4		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	1		; int
		call	sub_1000B23B
		test	al, al
		jz	short loc_1000B1F3
		mov	eax, [esp+14h+arg_10]
		push	6		; int
		push	1		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; size_t
		push	eax		; void *
		mov	[esp+24h+var_8], ecx
		mov	ecx, edi
		push	2		; int
		mov	[esp+28h+var_4], eax
		call	sub_1000B23B
		test	al, al
		jnz	short loc_1000B1F7

loc_1000B1F3:				; CODE XREF: sub_1000B160+57j
					; sub_1000B160+6Dj
		push	4
		jmp	short loc_1000B22B
; ---------------------------------------------------------------------------

loc_1000B1F7:				; CODE XREF: sub_1000B160+91j
		push	[esp+14h+arg_14]
		mov	ecx, [esp+18h+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000B233
		mov	edx, [edi+5Ch]
		lea	ecx, [esp+14h+var_8]
		add	edx, edi
		push	edx		; void *
		call	sub_1000B4A1
		mov	ecx, [esp+14h+arg_0]
		push	edi
		test	al, al
		jnz	short loc_1000B22E
		call	sub_10017671
		push	2

loc_1000B22B:				; CODE XREF: sub_1000B160+95j
		pop	eax
		jmp	short loc_1000B235
; ---------------------------------------------------------------------------

loc_1000B22E:				; CODE XREF: sub_1000B160+C2j
		call	sub_10017671

loc_1000B233:				; CODE XREF: sub_1000B160+AAj
		mov	eax, esi

loc_1000B235:				; CODE XREF: sub_1000B160+CCj
		pop	esi
		pop	ebp

loc_1000B237:				; CODE XREF: sub_1000B160+15j
		pop	edi
		pop	ecx
		pop	ecx
		retn
sub_1000B160	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B23B(int, void *, size_t, char,	int)
sub_1000B23B	proc near		; CODE XREF: sub_1000B160+50p
					; sub_1000B160+66p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_10030128
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 3
		jnb	loc_1000B2E1
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000B2E1
		test	esi, esi
		jz	short loc_1000B26B
		cmp	[ebp+arg_4], 0
		jz	short loc_1000B2E1

loc_1000B26B:				; CODE XREF: sub_1000B23B+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000B2E1
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000B2E1
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000B2AC
		mov	dword ptr [edi+4], 1

loc_1000B2AC:				; CODE XREF: sub_1000B23B+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000B2E3
; ---------------------------------------------------------------------------

loc_1000B2D3:				; DATA XREF: .rdata:stru_10030128o
		xor	eax, eax	; Exception filter 0 for function 1000B23B
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B2D7:				; DATA XREF: .rdata:stru_10030128o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B23B
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000B2E1:				; CODE XREF: sub_1000B23B+14j
					; sub_1000B23B+20j ...
		xor	al, al

loc_1000B2E3:				; CODE XREF: sub_1000B23B+96j
		call	__SEH_epilog4
		retn	14h
sub_1000B23B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B2EB(int, void *, size_t, char,	int)
sub_1000B2EB	proc near		; CODE XREF: sub_1000AE52+50p
					; sub_1000AE52+74p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_100301A8
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 5
		jnb	loc_1000B391
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000B391
		test	esi, esi
		jz	short loc_1000B31B
		cmp	[ebp+arg_4], 0
		jz	short loc_1000B391

loc_1000B31B:				; CODE XREF: sub_1000B2EB+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000B391
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000B391
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000B35C
		mov	dword ptr [edi+4], 1

loc_1000B35C:				; CODE XREF: sub_1000B2EB+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000B393
; ---------------------------------------------------------------------------

loc_1000B383:				; DATA XREF: .rdata:stru_100301A8o
		xor	eax, eax	; Exception filter 0 for function 1000B2EB
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B387:				; DATA XREF: .rdata:stru_100301A8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B2EB
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000B391:				; CODE XREF: sub_1000B2EB+14j
					; sub_1000B2EB+20j ...
		xor	al, al

loc_1000B393:				; CODE XREF: sub_1000B2EB+96j
		call	__SEH_epilog4
		retn	14h
sub_1000B2EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B39B(int, void *, size_t, char,	int)
sub_1000B39B	proc near		; CODE XREF: sub_1000B058+4Fp
					; sub_1000B058+72p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_10030188
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 7
		jnb	loc_1000B441
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000B441
		test	esi, esi
		jz	short loc_1000B3CB
		cmp	[ebp+arg_4], 0
		jz	short loc_1000B441

loc_1000B3CB:				; CODE XREF: sub_1000B39B+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000B441
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000B441
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000B40C
		mov	dword ptr [edi+4], 1

loc_1000B40C:				; CODE XREF: sub_1000B39B+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000B443
; ---------------------------------------------------------------------------

loc_1000B433:				; DATA XREF: .rdata:stru_10030188o
		xor	eax, eax	; Exception filter 0 for function 1000B39B
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B437:				; DATA XREF: .rdata:stru_10030188o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B39B
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000B441:				; CODE XREF: sub_1000B39B+14j
					; sub_1000B39B+20j ...
		xor	al, al

loc_1000B443:				; CODE XREF: sub_1000B39B+96j
		call	__SEH_epilog4
		retn	14h
sub_1000B39B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000B44B	proc near		; CODE XREF: sub_1000AF7F+42p
					; sub_1000B058+42p ...

ms_exc		= CPPEH_RECORD ptr -18h

		push	8
		push	offset stru_10030148
		call	__SEH_prolog4
		xor	eax, eax
		mov	[ebp+ms_exc.registration.TryLevel], eax
		cmp	[ecx], eax
		jz	short loc_1000B46A
		push	dword ptr [ecx]
		call	sub_1000B48A
		pop	ecx
		add	eax, eax

loc_1000B46A:				; CODE XREF: sub_1000B44B+13j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_1000B484
; ---------------------------------------------------------------------------

loc_1000B473:				; DATA XREF: .rdata:stru_10030148o
		xor	eax, eax	; Exception filter 0 for function 1000B44B
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B477:				; DATA XREF: .rdata:stru_10030148o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B44B
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		or	eax, 0FFFFFFFFh

loc_1000B484:				; CODE XREF: sub_1000B44B+26j
		call	__SEH_epilog4
		retn
sub_1000B44B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000B48A	proc near		; CODE XREF: sub_1000B44B+17p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]

loc_1000B48E:				; CODE XREF: sub_1000B48A+Dj
		mov	cx, [eax]
		add	eax, 2
		test	cx, cx
		jnz	short loc_1000B48E
		sub	eax, [esp+arg_0]
		sar	eax, 1
		dec	eax
		retn
sub_1000B48A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B4A1(void *)
sub_1000B4A1	proc near		; CODE XREF: sub_1000AE52+F1p
					; sub_1000AE52+109p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	8
		push	offset stru_10030168
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	dword ptr [ecx]	; size_t
		push	[ebp+arg_0]	; void *
		push	dword ptr [ecx+4] ; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	al, 1
		jmp	short loc_1000B4DC
; ---------------------------------------------------------------------------

loc_1000B4CC:				; DATA XREF: .rdata:stru_10030168o
		xor	eax, eax	; Exception filter 0 for function 1000B4A1
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B4D0:				; DATA XREF: .rdata:stru_10030168o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B4A1
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	al, al

loc_1000B4DC:				; CODE XREF: sub_1000B4A1+29j
		call	__SEH_epilog4
		retn	4
sub_1000B4A1	endp

; Exported entry  22. _TargetNtCreateFile@48

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtCreateFile(x, x, x,	x, x, x, x, x, x, x, x,	x)
		public _TargetNtCreateFile@48
_TargetNtCreateFile@48 proc near	; DATA XREF: sub_1000AC66:loc_1000ACE9o
					; .rdata:off_10030468o

var_A0		= dword	ptr -0A0h
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= byte ptr -70h
var_6C		= dword	ptr -6Ch
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h
arg_2C		= dword	ptr  34h

		push	90h
		push	offset stru_100300C8
		call	__SEH_prolog4_GS
		mov	edx, [ebp+arg_0]
		mov	esi, [ebp+arg_4]
		mov	[ebp+var_88], esi
		mov	edi, [ebp+arg_C]
		mov	[ebp+var_7C], edi
		mov	ebx, [ebp+arg_10]
		mov	ecx, [ebp+arg_14]
		mov	eax, [ebp+arg_28]
		push	[ebp+arg_2C]
		push	eax
		push	[ebp+arg_24]
		push	[ebp+arg_20]
		push	[ebp+arg_1C]
		push	[ebp+arg_18]
		push	ecx
		push	ebx
		push	edi
		push	[ebp+arg_8]
		push	esi
		call	edx
		mov	esi, eax
		mov	[ebp+var_80], esi
		cmp	esi, 0C0000022h
		jnz	loc_1000B712
		mov	ecx, [edi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtcreatefile ; "NtCreateFile"
		call	sub_10002D0B
		add	esp, 0Ch
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jnz	short loc_1000B56D
		mov	eax, esi
		jmp	loc_1000B712
; ---------------------------------------------------------------------------

loc_1000B56D:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+80j
		xor	edi, edi
		mov	[ebp+var_78], edi
		push	1
		push	4
		push	[ebp+var_88]
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_1000B6FF
		push	1
		push	8
		push	ebx
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_1000B6FF
		call	sub_10015CC7
		mov	[ebp+var_98], eax
		test	eax, eax
		jz	loc_1000B6FF
		mov	[ebp+var_84], edi
		push	edi
		lea	eax, [ebp+var_84]
		push	eax
		lea	eax, [ebp+var_78]
		push	eax
		push	[ebp+var_7C]
		call	sub_1001592A
		add	esp, 10h
		test	eax, eax
		js	loc_1000B6FF
		cmp	[ebp+var_78], edi
		jz	loc_1000B6FF
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+arg_24]
		mov	[ebp+var_8C], eax
		mov	[ebp+var_94], edi
		lea	ecx, [ebp+var_40]
		call	sub_1000A73F
		lea	eax, [ebp+var_78]
		mov	[ebp+var_3C], 1
		mov	[ebp+var_38], eax
		push	2
		pop	ecx
		lea	eax, [ebp+var_90]
		mov	[ebp+var_2C], ecx
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_8C]
		mov	[ebp+var_24], ecx
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_94]
		mov	[ebp+var_34], ecx
		mov	[ebp+var_30], eax
		lea	eax, [ebp+var_40]
		push	eax
		push	3
		call	sub_100119BE
		pop	ecx
		pop	ecx
		test	al, al
		jz	loc_1000B6FF
		push	[ebp+var_98]
		lea	ecx, [ebp+var_A0]
		call	sub_100175A8
		mov	[ebp+var_74], edi
		push	30h		; size_t
		push	edi		; int
		lea	eax, [ebp+var_70]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_74]
		push	eax		; int
		lea	eax, [ebp+var_8C]
		push	eax		; void *
		lea	eax, [ebp+arg_20]
		push	eax		; void *
		lea	eax, [ebp+arg_1C]
		push	eax		; void *
		lea	eax, [ebp+arg_18]
		push	eax		; void *
		lea	eax, [ebp+var_90]
		push	eax		; void *
		lea	eax, [ebp+var_84]
		push	eax		; void *
		lea	eax, [ebp+var_78]
		push	eax		; int
		push	3		; int
		lea	eax, [ebp+var_A0]
		push	eax		; int
		call	sub_1000B058
		add	esp, 34h
		test	eax, eax
		jnz	short loc_1000B6FF
		mov	esi, [ebp+var_6C]
		test	esi, esi
		js	short loc_1000B710
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebp+var_64]
		mov	ecx, [ebp+var_88]
		mov	[ecx], eax
		mov	[ebx], esi
		mov	eax, [ebp+var_60]
		mov	[ebx+4], eax
		mov	[ebp+var_80], esi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+var_7C]
		mov	ecx, [eax+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtcreatefile ; "NtCreateFile"
		call	sub_10002C02
		add	esp, 0Ch
		jmp	short loc_1000B6FF
; ---------------------------------------------------------------------------

loc_1000B6EC:				; DATA XREF: .rdata:stru_100300C8o
		xor	eax, eax	; Exception filter 0 for function 1000B4E4
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B6F0:				; DATA XREF: .rdata:stru_100300C8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B4E4
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	edi, edi
		mov	esi, [ebp+var_80]

loc_1000B6FF:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+A2j
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+B7j ...
		cmp	[ebp+var_78], 0
		jz	short loc_1000B710
		push	edi
		push	[ebp+var_78]
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_1000B710:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+1CAj
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+21Fj
		mov	eax, esi

loc_1000B712:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+4Ej
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+84j
		call	__SEH_epilog4_GS
		retn	30h
_TargetNtCreateFile@48 endp

; Exported entry  26. _TargetNtOpenFile@28

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenFile(x,	x, x, x, x, x, x)
		public _TargetNtOpenFile@28
_TargetNtOpenFile@28 proc near		; DATA XREF: sub_1000AC66:loc_1000ACD0o
					; .rdata:off_10030468o

var_A0		= dword	ptr -0A0h
var_98		= byte ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= byte ptr -70h
var_6C		= dword	ptr -6Ch
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	90h
		push	offset stru_100300E8
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		mov	[ebp+var_88], ecx
		mov	edi, [ebp+arg_C]
		mov	[ebp+var_84], edi
		mov	ebx, [ebp+arg_10]
		push	[ebp+arg_18]
		push	[ebp+arg_14]
		push	ebx
		push	edi
		push	[ebp+arg_8]
		push	ecx
		call	eax
		mov	esi, eax
		mov	[ebp+var_7C], esi
		cmp	esi, 0C0000022h
		jnz	loc_1000B929
		mov	ecx, [edi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtopenfile ; "NtOpenFile"
		call	sub_10002D0B
		add	esp, 0Ch
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jnz	short loc_1000B795
		mov	eax, esi
		jmp	loc_1000B929
; ---------------------------------------------------------------------------

loc_1000B795:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+72j
		xor	edi, edi
		mov	[ebp+var_78], edi
		push	1
		push	4
		push	[ebp+var_88]
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_1000B916
		push	1
		push	8
		push	ebx
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_1000B916
		call	sub_10015CC7
		mov	[ebp+var_90], eax
		test	eax, eax
		jz	loc_1000B916
		push	edi
		lea	eax, [ebp+var_98]
		push	eax
		lea	eax, [ebp+var_78]
		push	eax
		push	[ebp+var_84]
		call	sub_1001592A
		add	esp, 10h
		test	eax, eax
		js	loc_1000B916
		cmp	[ebp+var_78], edi
		jz	loc_1000B916
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_80], eax
		mov	[ebp+var_94], edi
		lea	ecx, [ebp+var_40]
		call	sub_1000A73F
		lea	eax, [ebp+var_78]
		mov	[ebp+var_3C], 1
		mov	[ebp+var_38], eax
		push	2
		pop	ecx
		lea	eax, [ebp+var_8C]
		mov	[ebp+var_2C], ecx
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_80]
		mov	[ebp+var_24], ecx
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_94]
		mov	[ebp+var_34], ecx
		mov	[ebp+var_30], eax
		lea	eax, [ebp+var_40]
		push	eax
		push	4
		call	sub_100119BE
		pop	ecx
		pop	ecx
		test	al, al
		jz	loc_1000B916
		push	[ebp+var_90]
		lea	ecx, [ebp+var_A0]
		call	sub_100175A8
		mov	[ebp+var_74], edi
		push	30h		; size_t
		push	edi		; int
		lea	eax, [ebp+var_70]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_74]
		push	eax		; int
		lea	eax, [ebp+var_80]
		push	eax		; void *
		lea	eax, [ebp+arg_14]
		push	eax		; void *
		lea	eax, [ebp+var_8C]
		push	eax		; void *
		lea	eax, [ebp+var_98]
		push	eax		; void *
		lea	eax, [ebp+var_78]
		push	eax		; int
		push	4		; int
		lea	eax, [ebp+var_A0]
		push	eax		; int
		call	sub_1000AF7F
		add	esp, 2Ch
		test	eax, eax
		jnz	short loc_1000B916
		mov	esi, [ebp+var_6C]
		test	esi, esi
		js	short loc_1000B927
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebp+var_64]
		mov	ecx, [ebp+var_88]
		mov	[ecx], eax
		mov	[ebx], esi
		mov	eax, [ebp+var_60]
		mov	[ebx+4], eax
		mov	[ebp+var_7C], esi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+var_84]
		mov	ecx, [eax+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtopenfile ; "NtOpenFile"
		call	sub_10002C02
		add	esp, 0Ch
		jmp	short loc_1000B916
; ---------------------------------------------------------------------------

loc_1000B903:				; DATA XREF: .rdata:stru_100300E8o
		xor	eax, eax	; Exception filter 0 for function 1000B71A
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B907:				; DATA XREF: .rdata:stru_100300E8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B71A
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	edi, edi
		mov	esi, [ebp+var_7C]

loc_1000B916:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+94j
					; TargetNtOpenFile(x,x,x,x,x,x,x)+A9j ...
		cmp	[ebp+var_78], 0
		jz	short loc_1000B927
		push	edi
		push	[ebp+var_78]
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_1000B927:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+1A8j
					; TargetNtOpenFile(x,x,x,x,x,x,x)+200j
		mov	eax, esi

loc_1000B929:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+40j
					; TargetNtOpenFile(x,x,x,x,x,x,x)+76j
		call	__SEH_epilog4_GS
		retn	1Ch
_TargetNtOpenFile@28 endp

; Exported entry  35. _TargetNtQueryAttributesFile@12

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetNtQueryAttributesFile(x, x, x)
		public _TargetNtQueryAttributesFile@12
_TargetNtQueryAttributesFile@12	proc near ; DATA XREF: sub_1000AC66:loc_1000ACB7o
					; .rdata:off_10030468o

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 68h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	eax, [esp+68h+arg_0]
		push	ebx
		push	esi
		mov	esi, [esp+70h+arg_8]
		push	edi
		mov	edi, [esp+74h+arg_4]
		push	esi
		push	edi
		call	eax
		mov	ebx, 0C0000022h
		cmp	eax, ebx
		jnz	loc_1000BAB7
		mov	ecx, [edi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtqueryattribu ; "NtQueryAttributesFile"
		call	sub_10002D0B
		add	esp, 0Ch
		call	sub_10015880
		mov	ecx, eax
		mov	edx, [eax]
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jnz	short loc_1000B994
		mov	eax, ebx
		jmp	loc_1000BAB7
; ---------------------------------------------------------------------------

loc_1000B994:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+5Aj
		push	ebp
		push	1
		push	28h
		xor	ebp, ebp
		push	esi
		mov	[esp+84h+var_68], ebp
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_1000BA9F
		call	sub_10015CC7
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_1000BA9F
		push	ebp
		lea	eax, [esp+7Ch+var_64]
		mov	[esp+7Ch+var_64], ebp
		push	eax
		lea	eax, [esp+80h+var_68]
		push	eax
		push	edi
		call	sub_1001592A
		add	esp, 10h
		test	eax, eax
		js	loc_1000BA9F
		cmp	[esp+78h+var_68], ebp
		jz	loc_1000BAB1
		lea	ecx, [esp+78h+var_4C]
		mov	[esp+78h+var_5C], 28h
		mov	[esp+78h+var_58], esi
		mov	[esp+78h+var_60], ebp
		call	sub_10018707
		lea	eax, [esp+78h+var_68]
		mov	[esp+78h+var_48], 1
		mov	[esp+78h+var_44], eax
		lea	eax, [esp+78h+var_60]
		mov	dword ptr [esp+78h+var_3C], eax
		lea	eax, [esp+78h+var_4C]
		push	eax
		push	5
		mov	[esp+80h+var_40], 2
		call	sub_100119BE
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_1000BA9F
		push	ebx
		lea	ecx, [esp+7Ch+var_54]
		call	sub_100175A8
		push	30h		; size_t
		lea	eax, [esp+7Ch+var_34]
		mov	[esp+7Ch+var_38], ebp
		push	ebp		; int
		push	eax		; void *
		call	memset
		lea	eax, [esp+84h+var_38]
		push	eax		; int
		lea	eax, [esp+88h+var_5C]
		push	eax		; int
		lea	eax, [esp+8Ch+var_64]
		push	eax		; void *
		lea	eax, [esp+90h+var_68]
		push	eax		; int
		lea	eax, [esp+94h+var_54]
		push	5		; int
		push	eax		; int
		call	sub_1000B160
		push	ebp
		push	[esp+0A0h+var_68]
		mov	esi, eax
		call	sub_100158E4
		add	esp, 2Ch
		test	esi, esi
		jnz	short loc_1000BA9F
		mov	ecx, [edi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtqueryattribu ; "NtQueryAttributesFile"
		call	sub_10002C02
		mov	eax, [esp+84h+var_30]
		add	esp, 0Ch
		jmp	short loc_1000BAB6
; ---------------------------------------------------------------------------

loc_1000BA9F:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+79j
					; TargetNtQueryAttributesFile(x,x,x)+88j ...
		cmp	[esp+78h+var_68], ebp
		jz	short loc_1000BAB1
		push	ebp
		push	[esp+7Ch+var_68]
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_1000BAB1:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+B2j
					; TargetNtQueryAttributesFile(x,x,x)+172j
		mov	eax, 0C0000022h

loc_1000BAB6:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+16Cj
		pop	ebp

loc_1000BAB7:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+28j
					; TargetNtQueryAttributesFile(x,x,x)+5Ej
		mov	ecx, [esp+74h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn	0Ch
_TargetNtQueryAttributesFile@12	endp

; Exported entry  36. _TargetNtQueryFullAttributesFile@12

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetNtQueryFullAttributesFile(x, x, x)
		public _TargetNtQueryFullAttributesFile@12
_TargetNtQueryFullAttributesFile@12 proc near ;	DATA XREF: sub_1000AC66:loc_1000AC9Eo
					; .rdata:off_10030468o

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 68h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	eax, [esp+68h+arg_0]
		push	ebx
		push	esi
		mov	esi, [esp+70h+arg_8]
		push	edi
		mov	edi, [esp+74h+arg_4]
		push	esi
		push	edi
		call	eax
		mov	ebx, 0C0000022h
		cmp	eax, ebx
		jnz	loc_1000BC51
		mov	ecx, [edi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		call	sub_10002D0B
		add	esp, 0Ch
		call	sub_10015880
		mov	ecx, eax
		mov	edx, [eax]
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jnz	short loc_1000BB2E
		mov	eax, ebx
		jmp	loc_1000BC51
; ---------------------------------------------------------------------------

loc_1000BB2E:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+5Aj
		push	ebp
		push	1
		push	38h
		xor	ebp, ebp
		push	esi
		mov	[esp+84h+var_68], ebp
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_1000BC39
		call	sub_10015CC7
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_1000BC39
		push	ebp
		lea	eax, [esp+7Ch+var_64]
		mov	[esp+7Ch+var_64], ebp
		push	eax
		lea	eax, [esp+80h+var_68]
		push	eax
		push	edi
		call	sub_1001592A
		add	esp, 10h
		test	eax, eax
		js	loc_1000BC39
		cmp	[esp+78h+var_68], ebp
		jz	loc_1000BC4B
		lea	ecx, [esp+78h+var_4C]
		mov	[esp+78h+var_5C], 38h
		mov	[esp+78h+var_58], esi
		mov	[esp+78h+var_60], ebp
		call	sub_10018707
		lea	eax, [esp+78h+var_68]
		mov	[esp+78h+var_48], 1
		mov	[esp+78h+var_44], eax
		lea	eax, [esp+78h+var_60]
		mov	dword ptr [esp+78h+var_3C], eax
		lea	eax, [esp+78h+var_4C]
		push	eax
		push	6
		mov	[esp+80h+var_40], 2
		call	sub_100119BE
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_1000BC39
		push	ebx
		lea	ecx, [esp+7Ch+var_54]
		call	sub_100175A8
		push	30h		; size_t
		lea	eax, [esp+7Ch+var_34]
		mov	[esp+7Ch+var_38], ebp
		push	ebp		; int
		push	eax		; void *
		call	memset
		lea	eax, [esp+84h+var_38]
		push	eax		; int
		lea	eax, [esp+88h+var_5C]
		push	eax		; int
		lea	eax, [esp+8Ch+var_64]
		push	eax		; void *
		lea	eax, [esp+90h+var_68]
		push	eax		; int
		lea	eax, [esp+94h+var_54]
		push	6		; int
		push	eax		; int
		call	sub_1000B160
		push	ebp
		push	[esp+0A0h+var_68]
		mov	esi, eax
		call	sub_100158E4
		add	esp, 2Ch
		test	esi, esi
		jnz	short loc_1000BC39
		mov	ecx, [edi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		call	sub_10002C02
		mov	eax, [esp+84h+var_30]
		add	esp, 0Ch
		jmp	short loc_1000BC50
; ---------------------------------------------------------------------------

loc_1000BC39:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+79j
					; TargetNtQueryFullAttributesFile(x,x,x)+88j ...
		cmp	[esp+78h+var_68], ebp
		jz	short loc_1000BC4B
		push	ebp
		push	[esp+7Ch+var_68]
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_1000BC4B:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+B2j
					; TargetNtQueryFullAttributesFile(x,x,x)+172j
		mov	eax, 0C0000022h

loc_1000BC50:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+16Cj
		pop	ebp

loc_1000BC51:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+28j
					; TargetNtQueryFullAttributesFile(x,x,x)+5Ej
		mov	ecx, [esp+74h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn	0Ch
_TargetNtQueryFullAttributesFile@12 endp

; Exported entry  37. _TargetNtSetInformationFile@24

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtSetInformationFile(x, x, x,	x, x, x)
		public _TargetNtSetInformationFile@24
_TargetNtSetInformationFile@24 proc near ; DATA	XREF: sub_1000AC66+1Bo
					; .rdata:off_10030468o

var_B0		= dword	ptr -0B0h
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= word ptr -7Ch
var_7A		= word ptr -7Ah
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= byte ptr -60h
var_5C		= dword	ptr -5Ch
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	0A0h
		push	offset stru_10030108
		call	__SEH_prolog4_GS
		mov	ecx, [ebp+arg_0]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_80], eax
		mov	edx, [ebp+arg_8]
		mov	[ebp+var_6C], edx
		mov	ebx, [ebp+arg_C]
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		push	ebx
		push	edx
		push	eax
		call	ecx
		mov	edi, eax
		mov	[ebp+var_70], edi
		cmp	edi, 0C0000022h
		jnz	loc_1000BE8E
		push	2
		xor	esi, esi
		push	esi
		push	offset aNtsetinformati ; "NtSetInformationFile"
		call	sub_10002C76
		add	esp, 0Ch
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jnz	short loc_1000BCD2
		mov	eax, edi
		jmp	loc_1000BE8E
; ---------------------------------------------------------------------------

loc_1000BCD2:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+64j
		mov	[ebp+var_68], esi
		call	sub_10015CC7
		mov	[ebp+var_84], eax
		test	eax, eax
		jz	loc_1000BE7B
		push	1
		push	8
		push	[ebp+var_6C]
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_1000BE7B
		push	esi
		push	[ebp+arg_10]
		push	ebx
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_1000BE7B
		mov	[ebp+var_A8], 18h
		mov	[ebp+var_A4], esi
		mov	[ebp+var_9C], esi
		lea	eax, [ebp+var_7C]
		mov	[ebp+var_A0], eax
		mov	[ebp+var_98], esi
		mov	[ebp+var_94], esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		push	ebx
		call	sub_10015E34
		add	esp, 0Ch
		test	al, al
		jnz	short loc_1000BD61
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	loc_1000BE7B
; ---------------------------------------------------------------------------

loc_1000BD61:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+EEj
		mov	eax, [ebx+4]
		mov	[ebp+var_A4], eax
		lea	eax, [ebx+0Ch]
		mov	[ebp+var_78], eax
		mov	ax, [ebx+8]
		mov	[ebp+var_7A], ax
		mov	[ebp+var_7C], ax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		push	esi
		push	esi
		lea	eax, [ebp+var_68]
		push	eax
		lea	eax, [ebp+var_A8]
		push	eax
		call	sub_1001592A
		add	esp, 10h
		test	eax, eax
		js	loc_1000BE7B
		cmp	[ebp+var_68], 0
		jz	loc_1000BE8C
		mov	[ebp+var_88], esi
		lea	ecx, [ebp+var_30]
		call	sub_10018707
		lea	eax, [ebp+var_68]
		mov	[ebp+var_2C], 1
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_88]
		mov	[ebp+var_24], 2
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_30]
		push	eax
		push	7
		call	sub_100119BE
		pop	ecx
		pop	ecx
		test	al, al
		jz	loc_1000BE7B
		mov	[ebp+var_90], 8
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_74], eax
		mov	[ebp+var_70], ebx
		push	[ebp+var_84]
		lea	ecx, [ebp+var_B0]
		call	sub_100175A8
		mov	[ebp+var_64], esi
		push	30h		; size_t
		push	esi		; int
		lea	eax, [ebp+var_60]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_64]
		push	eax		; int
		lea	eax, [ebp+arg_14]
		push	eax		; void *
		lea	eax, [ebp+arg_10]
		push	eax		; void *
		lea	eax, [ebp+var_74]
		push	eax		; int
		lea	eax, [ebp+var_90]
		push	eax		; int
		lea	eax, [ebp+var_80]
		push	eax		; int
		push	7		; int
		lea	eax, [ebp+var_B0]
		push	eax		; int
		call	sub_1000AE52
		add	esp, 2Ch
		test	eax, eax
		jnz	short loc_1000BE7B
		mov	edi, [ebp+var_5C]
		push	esi
		push	offset aNtsetinformati ; "NtSetInformationFile"
		call	sub_10002B72
		pop	ecx
		pop	ecx
		jmp	short loc_1000BE7B
; ---------------------------------------------------------------------------

loc_1000BE68:				; DATA XREF: .rdata:stru_10030108o
		xor	eax, eax	; Exception filter 0 for function 1000BC65
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000BE6C:				; DATA XREF: .rdata:stru_10030108o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000BC65
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	esi, esi
		mov	edi, [ebp+var_70]

loc_1000BE7B:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+7Dj
					; TargetNtSetInformationFile(x,x,x,x,x,x)+94j ...
		cmp	[ebp+var_68], 0
		jz	short loc_1000BE8C
		push	esi
		push	[ebp+var_68]
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_1000BE8C:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+13Fj
					; TargetNtSetInformationFile(x,x,x,x,x,x)+21Aj
		mov	eax, edi

loc_1000BE8E:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+37j
					; TargetNtSetInformationFile(x,x,x,x,x,x)+68j
		call	__SEH_epilog4_GS
		retn	18h
_TargetNtSetInformationFile@24 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000BE96(int,	int, int, int, int, int, int, int, int,	LPHANDLE lpTargetHandle, int, int)
sub_1000BE96	proc near		; CODE XREF: sub_1000A7BC+B2p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
lpTargetHandle	= dword	ptr  2Ch
arg_28		= dword	ptr  30h
arg_2C		= dword	ptr  34h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 3
		jz	short loc_1000BEAF
		mov	eax, [ebp+arg_28]
		mov	dword ptr [eax], 0C0000022h
		xor	al, al
		jmp	short loc_1000BF1F
; ---------------------------------------------------------------------------

loc_1000BEAF:				; CODE XREF: sub_1000BE96+Aj
		push	esi
		push	edi
		xor	eax, eax
		lea	edi, [ebp+var_24]
		xor	esi, esi
		mov	[ebp+var_8], ax
		mov	[ebp+var_28], esi
		stosd
		mov	[ebp+var_10], esi
		mov	[ebp+var_C], esi
		mov	[ebp+var_6], esi
		stosd
		mov	[ebp+var_2], si
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		push	esi
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		call	sub_1001700A
		mov	eax, [ebp+arg_4]
		push	dword ptr [eax]	; hTargetProcessHandle
		lea	eax, [ebp+var_10]
		push	esi		; int
		push	esi		; int
		push	[ebp+arg_20]	; int
		push	[ebp+arg_1C]	; int
		push	[ebp+arg_18]	; int
		push	[ebp+arg_14]	; int
		push	eax		; int
		lea	eax, [ebp+var_28]
		push	eax		; int
		push	[ebp+arg_10]	; int
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		call	sub_1000C266
		mov	ecx, [ebp+arg_28]
		add	esp, 40h
		mov	[ecx], eax
		mov	ecx, [ebp+arg_2C]
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		mov	[ecx], eax
		mov	al, 1

loc_1000BF1F:				; CODE XREF: sub_1000BE96+17j
		mov	esp, ebp
		pop	ebp
		retn
sub_1000BE96	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000BF23	proc near		; CODE XREF: sub_1000BFCD+82p

var_14		= byte ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		push	ebx
		mov	ebx, [ebp+arg_0]
		mov	ecx, ebx
		push	esi
		push	edi
		push	eax
		call	sub_10003B1C
		mov	esi, offset a??	; "\\/?/?\\"
		lea	edi, [ebp+var_14]
		movsd
		movsd
		movsd
		movsw
		mov	esi, offset a??_0 ; "\\??\\"
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax
		push	esi
		push	4
		xor	esi, esi
		mov	ecx, ebx
		push	esi
		call	sub_10004188
		test	eax, eax
		lea	eax, [ebp+var_14]
		push	eax
		jz	short loc_1000BFA5
		call	sub_100024E3
		pop	ecx
		push	eax
		lea	eax, [ebp+var_14]
		mov	ecx, ebx
		push	eax
		push	6
		push	esi
		call	sub_10004188
		test	eax, eax
		jz	short loc_1000BFBA
		lea	eax, [ebp+var_14]
		push	eax
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		lea	eax, [ebp+var_14]
		mov	ecx, ebx
		push	eax		; void *
		push	esi		; int
		call	sub_1000C79C
		jmp	short loc_1000BFBA
; ---------------------------------------------------------------------------

loc_1000BFA5:				; CODE XREF: sub_1000BF23+4Ej
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		lea	eax, [ebp+var_14]
		mov	ecx, ebx
		push	eax		; void *
		push	4		; int
		push	esi		; int
		call	sub_100046A7

loc_1000BFBA:				; CODE XREF: sub_1000BF23+67j
					; sub_1000BF23+80j
		mov	ecx, [ebp+var_4]
		mov	eax, ebx
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1000BF23	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000BFCD(void	*, int,	int)
sub_1000BFCD	proc near		; CODE XREF: sub_1001651A+11Cp

var_88		= byte ptr -88h
var_78		= byte ptr -78h
var_68		= byte ptr -68h
var_58		= byte ptr -58h
var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_34		= dword	ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 88h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+88h+var_4], eax
		and	[esp+88h+var_48], 0
		lea	ecx, [esp+88h+var_34]
		push	ebx
		push	esi
		mov	esi, [esp+90h+arg_0]
		push	edi
		mov	edi, [esp+94h+arg_8]
		push	esi		; void *
		call	sub_10001E8D
		cmp	[esp+94h+var_24], 0
		jz	loc_1000C23D
		cmp	[esp+94h+var_20], 8
		mov	eax, [esp+94h+var_34]
		jnb	short loc_1000C01B
		lea	eax, [esp+94h+var_34]

loc_1000C01B:				; CODE XREF: sub_1000BFCD+48j
		push	8		; size_t
		push	offset aDevice	; "\\Device\\"
		push	eax		; wchar_t *
		call	ds:_wcsnicmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000C07F
		lea	eax, [esp+94h+var_34]
		push	eax
		push	eax
		call	sub_1000C388
		pop	ecx
		pop	ecx
		test	al, al
		jz	loc_1000C23D
		lea	eax, [esp+94h+var_34]
		push	eax
		lea	eax, [esp+98h+var_1C]
		push	eax
		call	sub_1000BF23
		pop	ecx
		pop	ecx
		push	eax		; void *
		lea	ecx, [esp+98h+var_34] ;	void *
		call	sub_1000402F
		push	0		; int
		push	1		; char
		lea	ecx, [esp+9Ch+var_1C] ;	void *
		call	sub_100022C1
		cmp	[esp+94h+var_20], 8
		mov	esi, [esp+94h+var_34]
		jnb	short loc_1000C07F
		lea	esi, [esp+94h+var_34]

loc_1000C07F:				; CODE XREF: sub_1000BFCD+61j
					; sub_1000BFCD+ACj
		push	ebp
		push	1Fh
		pop	ebx
		push	3
		pop	ebp
		push	ebp
		lea	ecx, [esp+9Ch+var_88]
		call	sub_10011053
		push	ebp
		lea	ecx, [esp+9Ch+var_78]
		call	sub_10011053
		push	ebp
		lea	ecx, [esp+9Ch+var_58]
		call	sub_10011053
		push	ebp
		lea	ecx, [esp+9Ch+var_44]
		call	sub_10011053
		push	ebp
		lea	ecx, [esp+9Ch+var_68]
		call	sub_10011053
		mov	eax, [esp+98h+arg_4]
		xor	ebp, ebp
		sub	eax, ebp
		jz	short loc_1000C120
		dec	eax
		jz	short loc_1000C0F8
		dec	eax
		jz	short loc_1000C0F4
		dec	eax
		jnz	loc_1000C207
		push	1
		push	1
		push	3
		push	ebp
		lea	ecx, [esp+0A8h+var_78]
		call	sub_10011174
		push	1
		push	1
		push	3
		push	ebp
		lea	ecx, [esp+0A8h+var_88]
		call	sub_10011174
		jmp	short loc_1000C120
; ---------------------------------------------------------------------------

loc_1000C0F4:				; CODE XREF: sub_1000BFCD+FCj
		push	0Ch
		jmp	short loc_1000C11F
; ---------------------------------------------------------------------------

loc_1000C0F8:				; CODE XREF: sub_1000BFCD+F9j
		push	1
		mov	ebx, 5FEDFF56h
		lea	ecx, [esp+9Ch+var_78]
		push	ebx
		push	2
		push	1
		call	sub_10011174
		push	1
		push	ebx
		push	2
		push	1
		lea	ecx, [esp+0A8h+var_88]
		call	sub_10011174
		push	0Fh

loc_1000C11F:				; CODE XREF: sub_1000BFCD+129j
		pop	ebx

loc_1000C120:				; CODE XREF: sub_1000BFCD+F6j
					; sub_1000BFCD+125j
		test	bl, 1
		jz	short loc_1000C153
		push	1
		push	esi
		push	0
		push	0
		lea	ecx, [esp+0A8h+var_88]
		call	sub_10011215
		test	al, al
		jz	loc_1000C207
		lea	eax, [esp+98h+var_88]
		mov	ecx, edi
		push	eax
		push	3
		call	sub_100111C8
		test	al, al
		jz	loc_1000C207

loc_1000C153:				; CODE XREF: sub_1000BFCD+156j
		test	bl, 2
		jz	short loc_1000C186
		push	1
		push	esi
		push	0
		push	0
		lea	ecx, [esp+0A8h+var_78]
		call	sub_10011215
		test	al, al
		jz	loc_1000C207
		lea	eax, [esp+98h+var_78]
		mov	ecx, edi
		push	eax
		push	4
		call	sub_100111C8
		test	al, al
		jz	loc_1000C207

loc_1000C186:				; CODE XREF: sub_1000BFCD+189j
		test	bl, 4
		jz	short loc_1000C1B1
		push	1
		push	esi
		push	0
		push	0
		lea	ecx, [esp+0A8h+var_58]
		call	sub_10011215
		test	al, al
		jz	short loc_1000C207
		lea	eax, [esp+98h+var_58]
		mov	ecx, edi
		push	eax
		push	5
		call	sub_100111C8
		test	al, al
		jz	short loc_1000C207

loc_1000C1B1:				; CODE XREF: sub_1000BFCD+1BCj
		test	bl, 8
		jz	short loc_1000C1DC
		push	1
		push	esi
		push	0
		push	0
		lea	ecx, [esp+0A8h+var_44]
		call	sub_10011215
		test	al, al
		jz	short loc_1000C207
		lea	eax, [esp+98h+var_44]
		mov	ecx, edi
		push	eax
		push	6
		call	sub_100111C8
		test	al, al
		jz	short loc_1000C207

loc_1000C1DC:				; CODE XREF: sub_1000BFCD+1E7j
		test	bl, 10h
		jz	short loc_1000C20B
		push	1
		push	esi
		push	0
		push	0
		lea	ecx, [esp+0A8h+var_68]
		call	sub_10011215
		test	al, al
		jz	short loc_1000C207
		lea	eax, [esp+98h+var_68]
		mov	ecx, edi
		push	eax
		push	7
		call	sub_100111C8
		test	al, al
		jnz	short loc_1000C20B

loc_1000C207:				; CODE XREF: sub_1000BFCD+FFj
					; sub_1000BFCD+16Aj ...
		xor	bl, bl
		jmp	short loc_1000C20D
; ---------------------------------------------------------------------------

loc_1000C20B:				; CODE XREF: sub_1000BFCD+212j
					; sub_1000BFCD+238j
		mov	bl, 1

loc_1000C20D:				; CODE XREF: sub_1000BFCD+23Cj
		lea	ecx, [esp+98h+var_68]
		call	sub_10011108
		lea	ecx, [esp+98h+var_44]
		call	sub_10011108
		lea	ecx, [esp+98h+var_58]
		call	sub_10011108
		lea	ecx, [esp+98h+var_78]
		call	sub_10011108
		lea	ecx, [esp+98h+var_88]
		call	sub_10011108
		pop	ebp
		jmp	short loc_1000C23F
; ---------------------------------------------------------------------------

loc_1000C23D:				; CODE XREF: sub_1000BFCD+39j
					; sub_1000BFCD+72j
		xor	bl, bl

loc_1000C23F:				; CODE XREF: sub_1000BFCD+26Ej
		push	0		; int
		push	1		; char
		lea	ecx, [esp+9Ch+var_34] ;	void *
		call	sub_100022C1
		mov	ecx, [esp+94h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 88h
		retn
sub_1000BFCD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000C266(LPHANDLE lpTargetHandle, int, int, int, int,	int, int, int, int, int, HANDLE	hTargetProcessHandle)
sub_1000C266	proc near		; CODE XREF: sub_1000BE96+70p
					; sub_1000C300+6Bp

var_8		= dword	ptr -8
hObject		= dword	ptr -4
lpTargetHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
hTargetProcessHandle= dword ptr	 30h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	edi
		lea	eax, [ebp+var_8]
		xor	edi, edi
		push	eax		; int
		push	offset aNtcreatefile ; "NtCreateFile"
		mov	[ebp+var_8], edi
		call	sub_1001A242
		pop	ecx
		pop	ecx
		push	[ebp+arg_24]
		mov	esi, [ebp+arg_8]
		lea	eax, [ebp+hObject]
		push	[ebp+arg_20]
		or	[ebp+hObject], 0FFFFFFFFh
		push	[ebp+arg_1C]
		push	[ebp+arg_18]
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		push	edi
		push	[ebp+arg_C]
		push	esi
		push	[ebp+arg_4]
		push	eax
		call	[ebp+var_8]
		test	eax, eax
		js	short loc_1000C2FA
		mov	eax, [esi+8]
		push	dword ptr [eax+4] ; void *
		push	[ebp+hObject]	; int
		call	sub_1001A3B3
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_1000C2D2
		push	[ebp+hObject]	; hObject
		call	ds:CloseHandle
		mov	eax, 0C0000022h
		jmp	short loc_1000C2FA
; ---------------------------------------------------------------------------

loc_1000C2D2:				; CODE XREF: sub_1000C266+5Aj
		push	3		; dwOptions
		push	edi		; bInheritHandle
		push	edi		; dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	[ebp+hObject]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		and	eax, 3FFFFFDEh
		add	eax, 0C0000022h

loc_1000C2FA:				; CODE XREF: sub_1000C266+46j
					; sub_1000C266+6Aj
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000C266	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000C300(int,	int, int, int, int, int, int, LPHANDLE lpTargetHandle, int, int)
sub_1000C300	proc near		; CODE XREF: sub_1000A8A5+ACp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
lpTargetHandle	= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 3
		jz	short loc_1000C317
		mov	eax, [ebp+arg_20]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000C382
; ---------------------------------------------------------------------------

loc_1000C317:				; CODE XREF: sub_1000C300+Aj
		push	esi
		push	edi
		xor	eax, eax
		lea	edi, [ebp+var_24]
		xor	esi, esi
		mov	[ebp+var_8], ax
		mov	[ebp+var_28], esi
		stosd
		mov	[ebp+var_10], esi
		mov	[ebp+var_C], esi
		mov	[ebp+var_6], esi
		stosd
		mov	[ebp+var_2], si
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		push	esi
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		call	sub_1001700A
		mov	eax, [ebp+arg_4]
		push	dword ptr [eax]	; hTargetProcessHandle
		lea	eax, [ebp+var_10]
		push	esi		; int
		push	esi		; int
		push	[ebp+arg_18]	; int
		push	1		; int
		push	[ebp+arg_14]	; int
		push	esi		; int
		push	eax		; int
		lea	eax, [ebp+var_28]
		push	eax		; int
		push	[ebp+arg_10]	; int
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		call	sub_1000C266
		mov	ecx, [ebp+arg_20]
		add	esp, 40h
		mov	edx, [ebp+arg_24]
		mov	[ecx], eax
		mov	ecx, [ebp+var_C]
		pop	edi
		mov	[edx], ecx
		pop	esi

loc_1000C382:				; CODE XREF: sub_1000C300+15j
		mov	al, 1
		mov	esp, ebp
		pop	ebp
		retn
sub_1000C300	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C388	proc near		; CODE XREF: sub_1000A7BC+1Dp
					; sub_1000A8A5+1Dp ...

var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10019D54
		lea	eax, [ebp+var_1]
		mov	[ebp+var_1], 0
		push	eax
		push	[ebp+arg_4]
		call	sub_1001A0FF
		add	esp, 10h
		test	eax, eax
		jz	short loc_1000C3B2
		xor	al, al
		jmp	short loc_1000C3BA
; ---------------------------------------------------------------------------

loc_1000C3B2:				; CODE XREF: sub_1000C388+24j
		xor	eax, eax
		cmp	[ebp+var_1], al
		setz	al

loc_1000C3BA:				; CODE XREF: sub_1000C388+28j
		mov	esp, ebp
		pop	ebp
		retn
sub_1000C388	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C3BE	proc near		; CODE XREF: sub_1000A988+A3p

var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		cmp	[ebp+arg_0], 3
		jz	short loc_1000C3D5
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000C42A
; ---------------------------------------------------------------------------

loc_1000C3D5:				; CODE XREF: sub_1000C3BE+Aj
		push	esi
		push	edi
		lea	eax, [ebp+arg_0]
		xor	esi, esi
		push	eax		; int
		push	offset aNtqueryattribu ; "NtQueryAttributesFile"
		mov	[ebp+arg_0], esi
		call	sub_1001A242
		xor	eax, eax
		mov	[ebp+var_20], esi
		mov	[ebp+var_8], ax
		lea	edi, [ebp+var_1C]
		stosd
		mov	[ebp+var_6], esi
		mov	[ebp+var_2], si
		stosd
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		push	esi
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		call	sub_1001700A
		add	esp, 1Ch
		lea	eax, [ebp+var_20]
		push	[ebp+arg_10]
		push	eax
		call	[ebp+arg_0]
		mov	ecx, [ebp+arg_14]
		pop	edi
		pop	esi
		mov	[ecx], eax

loc_1000C42A:				; CODE XREF: sub_1000C3BE+15j
		mov	al, 1
		mov	esp, ebp
		pop	ebp
		retn
sub_1000C3BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C430	proc near		; CODE XREF: sub_1000AA55+A3p

var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		cmp	[ebp+arg_0], 3
		jz	short loc_1000C447
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000C49C
; ---------------------------------------------------------------------------

loc_1000C447:				; CODE XREF: sub_1000C430+Aj
		push	esi
		push	edi
		lea	eax, [ebp+arg_0]
		xor	esi, esi
		push	eax		; int
		push	offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		mov	[ebp+arg_0], esi
		call	sub_1001A242
		xor	eax, eax
		mov	[ebp+var_20], esi
		mov	[ebp+var_8], ax
		lea	edi, [ebp+var_1C]
		stosd
		mov	[ebp+var_6], esi
		mov	[ebp+var_2], si
		stosd
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		push	esi
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		call	sub_1001700A
		add	esp, 1Ch
		lea	eax, [ebp+var_20]
		push	[ebp+arg_10]
		push	eax
		call	[ebp+arg_0]
		mov	ecx, [ebp+arg_14]
		pop	edi
		pop	esi
		mov	[ecx], eax

loc_1000C49C:				; CODE XREF: sub_1000C430+15j
		mov	al, 1
		mov	esp, ebp
		pop	ebp
		retn
sub_1000C430	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000C4A2(HANDLE TargetHandle,	int, HANDLE hSourceHandle, int,	int, int, int, int)
sub_1000C4A2	proc near		; CODE XREF: sub_1000AB22+104p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
TargetHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
hSourceHandle	= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		cmp	[ebp+TargetHandle], 3
		jz	short loc_1000C4B8
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000C52B
; ---------------------------------------------------------------------------

loc_1000C4B8:				; CODE XREF: sub_1000C4A2+9j
		push	esi
		lea	eax, [ebp+var_4]
		xor	esi, esi
		push	eax		; int
		push	offset aNtsetinformati ; "NtSetInformationFile"
		mov	[ebp+var_4], esi
		call	sub_1001A242
		pop	ecx
		pop	ecx
		push	2		; dwOptions
		push	esi		; bInheritHandle
		push	esi		; dwDesiredAccess
		lea	eax, [ebp+TargetHandle]
		mov	[ebp+TargetHandle], esi
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [ebp+arg_4]
		push	[ebp+hSourceHandle] ; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_1000C4FD
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000C52A
; ---------------------------------------------------------------------------

loc_1000C4FD:				; CODE XREF: sub_1000C4A2+4Ej
		push	[ebp+TargetHandle]
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], esi
		call	sub_10004DE8
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_18]
		push	[ebp+TargetHandle]
		call	[ebp+var_4]
		mov	ecx, [ebp+arg_1C]
		mov	[ecx], eax
		lea	ecx, [ebp+var_8]
		call	sub_10004DA3

loc_1000C52A:				; CODE XREF: sub_1000C4A2+59j
		pop	esi

loc_1000C52B:				; CODE XREF: sub_1000C4A2+14j
		mov	al, 1
		mov	esp, ebp
		pop	ebp
		retn
sub_1000C4A2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C531	proc near		; CODE XREF: sub_1001651A+FDp

var_24		= byte ptr -24h
var_14		= byte ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		push	ebx
		push	esi
		push	3
		lea	ecx, [ebp+var_24]
		call	sub_10011053
		push	3
		lea	ecx, [ebp+var_14]
		call	sub_10011053
		xor	eax, eax
		lea	ecx, [ebp+var_24]
		inc	eax
		push	eax
		push	eax
		push	eax
		push	eax
		mov	[ebp+var_4], eax
		call	sub_10011174
		push	0
		mov	bl, al
		lea	ecx, [ebp+var_24]
		push	offset a??_1	; "\\/?/?\\*"
		xor	eax, eax
		push	0
		inc	eax
		push	eax
		call	sub_10011215
		and	bl, al
		lea	ecx, [ebp+var_14]
		xor	eax, eax
		inc	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10011174
		and	bl, al
		lea	ecx, [ebp+var_14]
		xor	eax, eax
		push	eax
		push	offset asc_1001D2FC ; "*~*"
		push	eax
		push	eax
		call	sub_10011215
		test	bl, al
		jz	loc_1000C658
		mov	esi, [ebp+arg_0]
		lea	eax, [ebp+var_24]
		push	eax
		push	3
		mov	ecx, esi
		call	sub_100111C8
		test	al, al
		jz	loc_1000C658
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	3
		call	sub_100111C8
		test	al, al
		jz	loc_1000C658
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	4
		call	sub_100111C8
		test	al, al
		jz	short loc_1000C658
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	4
		call	sub_100111C8
		test	al, al
		jz	short loc_1000C658
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	5
		call	sub_100111C8
		test	al, al
		jz	short loc_1000C658
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	5
		call	sub_100111C8
		test	al, al
		jz	short loc_1000C658
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	6
		call	sub_100111C8
		test	al, al
		jz	short loc_1000C658
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	6
		call	sub_100111C8
		test	al, al
		jz	short loc_1000C658
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	7
		call	sub_100111C8
		test	al, al
		jz	short loc_1000C658
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	7
		call	sub_100111C8
		test	al, al
		jnz	short loc_1000C65C

loc_1000C658:				; CODE XREF: sub_1000C531+6Cj
					; sub_1000C531+84j ...
		mov	byte ptr [ebp+var_4], 0

loc_1000C65C:				; CODE XREF: sub_1000C531+125j
		lea	ecx, [ebp+var_14]
		call	sub_10011108
		lea	ecx, [ebp+var_24]
		call	sub_10011108
		mov	eax, [ebp+var_4]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000C531	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C675	proc near		; CODE XREF: sub_1000C79C+2Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+10h]
		cmp	ecx, [esp+0Ch+arg_0]
		jb	loc_1000C790
		mov	ebx, [esp+0Ch+arg_4]
		mov	ebp, [esp+0Ch+arg_8]
		mov	eax, [ebx+10h]
		cmp	eax, ebp
		jb	loc_1000C790
		push	edi
		mov	edi, [esp+10h+arg_C]
		sub	eax, ebp
		cmp	eax, edi
		jnb	short loc_1000C6A7
		mov	edi, eax

loc_1000C6A7:				; CODE XREF: sub_1000C675+2Ej
		or	eax, 0FFFFFFFFh
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_1000C6BB
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000C6BB:				; CODE XREF: sub_1000C675+39j
		test	edi, edi
		jz	loc_1000C787
		lea	eax, [ecx+edi]
		mov	ecx, esi
		push	0
		push	eax
		mov	[esp+18h+arg_8], eax
		call	sub_10002221
		test	al, al
		jz	loc_1000C787
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000C6EA
		mov	eax, [esi]
		mov	[esp+10h+arg_4], eax
		jmp	short loc_1000C6EE
; ---------------------------------------------------------------------------

loc_1000C6EA:				; CODE XREF: sub_1000C675+6Bj
		mov	[esp+10h+arg_4], esi

loc_1000C6EE:				; CODE XREF: sub_1000C675+73j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000C6F8
		mov	edx, [esi]
		jmp	short loc_1000C6FA
; ---------------------------------------------------------------------------

loc_1000C6F8:				; CODE XREF: sub_1000C675+7Dj
		mov	edx, esi

loc_1000C6FA:				; CODE XREF: sub_1000C675+81j
		mov	eax, [esi+10h]
		mov	ecx, [esp+10h+arg_0]
		sub	eax, ecx
		jz	short loc_1000C721
		push	eax		; int
		mov	eax, [esp+14h+arg_4]
		lea	eax, [eax+ecx*2]
		push	eax		; void *
		lea	eax, [ecx+edi]
		lea	eax, [edx+eax*2]
		push	eax		; void *
		call	sub_10002AE5
		mov	ecx, [esp+1Ch+arg_0]
		add	esp, 0Ch

loc_1000C721:				; CODE XREF: sub_1000C675+8Ej
		cmp	esi, ebx
		jnz	short loc_1000C757
		cmp	ecx, ebp
		jnb	short loc_1000C72B
		add	ebp, edi

loc_1000C72B:				; CODE XREF: sub_1000C675+B2j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000C735
		mov	eax, [esi]
		jmp	short loc_1000C737
; ---------------------------------------------------------------------------

loc_1000C735:				; CODE XREF: sub_1000C675+BAj
		mov	eax, esi

loc_1000C737:				; CODE XREF: sub_1000C675+BEj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000C741
		mov	edx, [esi]
		jmp	short loc_1000C743
; ---------------------------------------------------------------------------

loc_1000C741:				; CODE XREF: sub_1000C675+C6j
		mov	edx, esi

loc_1000C743:				; CODE XREF: sub_1000C675+CAj
		test	edi, edi
		jz	short loc_1000C77C
		lea	eax, [eax+ebp*2]
		push	edi		; int
		push	eax		; void *
		lea	eax, [edx+ecx*2]
		push	eax		; void *
		call	sub_10002AE5
		jmp	short loc_1000C779
; ---------------------------------------------------------------------------

loc_1000C757:				; CODE XREF: sub_1000C675+AEj
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_1000C75F
		mov	ebx, [ebx]

loc_1000C75F:				; CODE XREF: sub_1000C675+E6j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000C769
		mov	edx, [esi]
		jmp	short loc_1000C76B
; ---------------------------------------------------------------------------

loc_1000C769:				; CODE XREF: sub_1000C675+EEj
		mov	edx, esi

loc_1000C76B:				; CODE XREF: sub_1000C675+F2j
		push	edi		; int
		lea	eax, [ebx+ebp*2]
		push	eax		; void *
		lea	eax, [edx+ecx*2]
		push	eax		; void *
		call	sub_10002435

loc_1000C779:				; CODE XREF: sub_1000C675+E0j
		add	esp, 0Ch

loc_1000C77C:				; CODE XREF: sub_1000C675+D0j
		push	[esp+10h+arg_8]
		mov	ecx, esi
		call	sub_100021E0

loc_1000C787:				; CODE XREF: sub_1000C675+48j
					; sub_1000C675+61j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	10h
; ---------------------------------------------------------------------------

loc_1000C790:				; CODE XREF: sub_1000C675+Cj
					; sub_1000C675+1Fj
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)
		int	3		; Trap to Debugger
sub_1000C675	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000C79C(int, void *, int)
sub_1000C79C	proc near		; CODE XREF: sub_1000BF23+7Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	esi, ecx
		push	edi
		call	sub_10002288
		test	al, al
		jz	short loc_1000C7D4
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000C7B8
		mov	eax, [esi]
		jmp	short loc_1000C7BA
; ---------------------------------------------------------------------------

loc_1000C7B8:				; CODE XREF: sub_1000C79C+16j
		mov	eax, esi

loc_1000C7BA:				; CODE XREF: sub_1000C79C+1Aj
		push	[esp+8+arg_8]
		sub	edi, eax
		mov	ecx, esi
		sar	edi, 1
		push	edi
		push	esi
		push	[esp+14h+arg_0]
		call	sub_1000C675
		jmp	loc_1000C879
; ---------------------------------------------------------------------------

loc_1000C7D4:				; CODE XREF: sub_1000C79C+10j
		mov	ecx, [esi+10h]
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		cmp	ecx, ebp
		jnb	short loc_1000C7EB
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_1000C7EB:				; CODE XREF: sub_1000C79C+42j
		or	eax, 0FFFFFFFFh
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		sub	eax, ecx
		cmp	eax, ebx
		ja	short loc_1000C804
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000C804:				; CODE XREF: sub_1000C79C+5Bj
		test	ebx, ebx
		jz	short loc_1000C875
		lea	eax, [ecx+ebx]
		mov	ecx, esi
		push	0
		push	eax
		mov	[esp+18h+arg_0], eax
		call	sub_10002221
		test	al, al
		jz	short loc_1000C875
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000C827
		mov	edx, [esi]
		jmp	short loc_1000C829
; ---------------------------------------------------------------------------

loc_1000C827:				; CODE XREF: sub_1000C79C+85j
		mov	edx, esi

loc_1000C829:				; CODE XREF: sub_1000C79C+89j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000C833
		mov	ecx, [esi]
		jmp	short loc_1000C835
; ---------------------------------------------------------------------------

loc_1000C833:				; CODE XREF: sub_1000C79C+91j
		mov	ecx, esi

loc_1000C835:				; CODE XREF: sub_1000C79C+95j
		mov	eax, [esi+10h]
		sub	eax, ebp
		jz	short loc_1000C850
		push	eax		; int
		lea	eax, [edx+ebp*2]
		push	eax		; void *
		lea	eax, [ebx+ebp]
		lea	eax, [ecx+eax*2]
		push	eax		; void *
		call	sub_10002AE5
		add	esp, 0Ch

loc_1000C850:				; CODE XREF: sub_1000C79C+9Ej
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000C85A
		mov	eax, [esi]
		jmp	short loc_1000C85C
; ---------------------------------------------------------------------------

loc_1000C85A:				; CODE XREF: sub_1000C79C+B8j
		mov	eax, esi

loc_1000C85C:				; CODE XREF: sub_1000C79C+BCj
		push	ebx		; int
		lea	eax, [eax+ebp*2]
		push	edi		; void *
		push	eax		; void *
		call	sub_10002435
		add	esp, 0Ch
		mov	ecx, esi
		push	[esp+10h+arg_0]
		call	sub_100021E0

loc_1000C875:				; CODE XREF: sub_1000C79C+6Aj
					; sub_1000C79C+7Fj
		pop	ebx
		mov	eax, esi
		pop	ebp

loc_1000C879:				; CODE XREF: sub_1000C79C+33j
		pop	edi
		pop	esi
		retn	0Ch
sub_1000C79C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C87E	proc near		; CODE XREF: sub_1000C92A+19p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	esi
		mov	edi, ecx
		call	sub_10003B1C
		lea	eax, [esi+18h]
		push	eax
		lea	ecx, [edi+18h]
		call	sub_1000CD36
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_1000C87E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C89F	proc near		; CODE XREF: sub_1000CFBA+46p
					; sub_1000D1BB+CAp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	edx, eax
		and	edx, 3
		jz	short locret_1000C8B1
		push	4
		pop	ecx
		sub	ecx, edx
		add	eax, ecx

locret_1000C8B1:			; CODE XREF: sub_1000C89F+9j
		retn
sub_1000C89F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C8B2	proc near		; CODE XREF: sub_1000D2C3+4p
					; sub_1000D317+7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_1000C8D9
		cmp	eax, 5555555h
		ja	short loc_1000C8D3
		imul	eax, 30h
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_1000C8D9

loc_1000C8D3:				; CODE XREF: sub_1000C8B2+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_1000C8D9:				; CODE XREF: sub_1000C8B2+8j
					; sub_1000C8B2+1Fj
		mov	eax, ecx
		retn
sub_1000C8B2	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C8DC	proc near		; CODE XREF: sub_1000D2ED+4p
					; sub_1000D349+7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_1000C903
		cmp	eax, 6666666h
		ja	short loc_1000C8FD
		imul	eax, 28h
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_1000C903

loc_1000C8FD:				; CODE XREF: sub_1000C8DC+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_1000C903:				; CODE XREF: sub_1000C8DC+8j
					; sub_1000C8DC+1Fj
		mov	eax, ecx
		retn
sub_1000C8DC	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C906	proc near		; CODE XREF: sub_1000C976+1Dp

arg_0		= dword	ptr  4

		push	esi
		call	sub_1000D349
		mov	esi, eax
		lea	ecx, [esi+10h]
		mov	word ptr [esi+0Ch], 0
		test	ecx, ecx
		jz	short loc_1000C924
		push	[esp+4+arg_0]
		call	sub_10003B1C

loc_1000C924:				; CODE XREF: sub_1000C906+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_1000C906	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C92A	proc near		; CODE XREF: sub_1000CA94+1Dp

arg_0		= dword	ptr  4

		push	esi
		call	sub_1000D317
		mov	esi, eax
		lea	ecx, [esi+10h]
		mov	word ptr [esi+0Ch], 0
		test	ecx, ecx
		jz	short loc_1000C948
		push	[esp+4+arg_0]
		call	sub_1000C87E

loc_1000C948:				; CODE XREF: sub_1000C92A+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_1000C92A	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000C94E(void	*, int,	void *)
sub_1000C94E	proc near		; CODE XREF: sub_1000D1BB+ACp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		sub	eax, [esp+arg_0]
		push	esi
		mov	esi, [esp+4+arg_8]
		sar	eax, 1
		push	edi
		lea	edi, [eax+eax]
		push	edi		; size_t
		push	[esp+0Ch+arg_0]	; void *
		push	esi		; void *
		call	ds:memmove
		add	esp, 0Ch
		lea	eax, [edi+esi]
		pop	edi
		pop	esi
		retn
sub_1000C94E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C976	proc near		; CODE XREF: sub_1000CBB2+77p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 6666665h
		jb	short loc_1000C98D
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000C98D:				; CODE XREF: sub_1000C976+Aj
		push	ebx
		push	esi
		push	[esp+0Ch+arg_C]
		call	sub_1000C906
		inc	dword ptr [edi+4]
		mov	ebx, eax
		mov	eax, [esp+0Ch+arg_8]
		mov	[ebx+4], eax
		mov	ecx, [edi]
		cmp	eax, ecx
		jnz	short loc_1000C9B8
		mov	[ecx+4], ebx
		mov	eax, [edi]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	[eax+8], ebx
		jmp	short loc_1000C9D8
; ---------------------------------------------------------------------------

loc_1000C9B8:				; CODE XREF: sub_1000C976+32j
		cmp	byte ptr [esp+0Ch+arg_4], 0
		jz	short loc_1000C9CB
		mov	[eax], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx]
		jnz	short loc_1000C9D8
		mov	[ecx], ebx
		jmp	short loc_1000C9D8
; ---------------------------------------------------------------------------

loc_1000C9CB:				; CODE XREF: sub_1000C976+47j
		mov	[eax+8], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx+8]
		jnz	short loc_1000C9D8
		mov	[ecx+8], ebx

loc_1000C9D8:				; CODE XREF: sub_1000C976+40j
					; sub_1000C976+4Fj ...
		mov	eax, [ebx+4]
		mov	esi, ebx
		jmp	loc_1000CA75
; ---------------------------------------------------------------------------

loc_1000C9E2:				; CODE XREF: sub_1000C976+103j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000CA26
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000CA2C
		cmp	esi, [eax+8]
		jnz	short loc_1000CA06
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_100057C3

loc_1000CA06:				; CODE XREF: sub_1000C976+84j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10009EBF
		jmp	short loc_1000CA72
; ---------------------------------------------------------------------------

loc_1000CA26:				; CODE XREF: sub_1000C976+76j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000CA46

loc_1000CA2C:				; CODE XREF: sub_1000C976+7Fj
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000CA72
; ---------------------------------------------------------------------------

loc_1000CA46:				; CODE XREF: sub_1000C976+B4j
		cmp	esi, [eax]
		jnz	short loc_1000CA54
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10009EBF

loc_1000CA54:				; CODE XREF: sub_1000C976+D2j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_100057C3

loc_1000CA72:				; CODE XREF: sub_1000C976+AEj
					; sub_1000C976+CEj
		mov	eax, [esi+4]

loc_1000CA75:				; CODE XREF: sub_1000C976+67j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000C9E2
		mov	eax, [edi]
		pop	esi
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esp+8+arg_0]
		mov	[eax], ebx
		pop	ebx
		pop	edi
		retn	14h
sub_1000C976	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CA94	proc near		; CODE XREF: sub_1000CC74+77p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 5555554h
		jb	short loc_1000CAAB
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000CAAB:				; CODE XREF: sub_1000CA94+Aj
		push	ebx
		push	esi
		push	[esp+0Ch+arg_C]
		call	sub_1000C92A
		inc	dword ptr [edi+4]
		mov	ebx, eax
		mov	eax, [esp+0Ch+arg_8]
		mov	[ebx+4], eax
		mov	ecx, [edi]
		cmp	eax, ecx
		jnz	short loc_1000CAD6
		mov	[ecx+4], ebx
		mov	eax, [edi]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	[eax+8], ebx
		jmp	short loc_1000CAF6
; ---------------------------------------------------------------------------

loc_1000CAD6:				; CODE XREF: sub_1000CA94+32j
		cmp	byte ptr [esp+0Ch+arg_4], 0
		jz	short loc_1000CAE9
		mov	[eax], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx]
		jnz	short loc_1000CAF6
		mov	[ecx], ebx
		jmp	short loc_1000CAF6
; ---------------------------------------------------------------------------

loc_1000CAE9:				; CODE XREF: sub_1000CA94+47j
		mov	[eax+8], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx+8]
		jnz	short loc_1000CAF6
		mov	[ecx+8], ebx

loc_1000CAF6:				; CODE XREF: sub_1000CA94+40j
					; sub_1000CA94+4Fj ...
		mov	eax, [ebx+4]
		mov	esi, ebx
		jmp	loc_1000CB93
; ---------------------------------------------------------------------------

loc_1000CB00:				; CODE XREF: sub_1000CA94+103j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000CB44
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000CB4A
		cmp	esi, [eax+8]
		jnz	short loc_1000CB24
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_100057C3

loc_1000CB24:				; CODE XREF: sub_1000CA94+84j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10009EBF
		jmp	short loc_1000CB90
; ---------------------------------------------------------------------------

loc_1000CB44:				; CODE XREF: sub_1000CA94+76j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000CB64

loc_1000CB4A:				; CODE XREF: sub_1000CA94+7Fj
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000CB90
; ---------------------------------------------------------------------------

loc_1000CB64:				; CODE XREF: sub_1000CA94+B4j
		cmp	esi, [eax]
		jnz	short loc_1000CB72
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10009EBF

loc_1000CB72:				; CODE XREF: sub_1000CA94+D2j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_100057C3

loc_1000CB90:				; CODE XREF: sub_1000CA94+AEj
					; sub_1000CA94+CEj
		mov	eax, [esi+4]

loc_1000CB93:				; CODE XREF: sub_1000CA94+67j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000CB00
		mov	eax, [edi]
		pop	esi
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esp+8+arg_0]
		mov	[eax], ebx
		pop	ebx
		pop	edi
		retn	14h
sub_1000CA94	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CBB2	proc near		; CODE XREF: sub_1000CE06:loc_1000CF90p
					; sub_1000EDF7+6Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	al, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], al
		push	esi
		push	edi
		mov	edi, [ebp+0]
		mov	esi, [edi+4]
		jmp	short loc_1000CC03
; ---------------------------------------------------------------------------

loc_1000CBCB:				; CODE XREF: sub_1000CBB2+55j
		cmp	byte ptr [esp+14h+arg_4], 0
		mov	edi, esi
		jz	short loc_1000CBE4
		push	ebx
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		setns	al
		jmp	short loc_1000CBF4
; ---------------------------------------------------------------------------

loc_1000CBE4:				; CODE XREF: sub_1000CBB2+20j
		lea	eax, [esi+10h]
		mov	ecx, ebx
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		sets	al

loc_1000CBF4:				; CODE XREF: sub_1000CBB2+30j
		mov	byte ptr [esp+14h+var_4], al
		test	al, al
		jz	short loc_1000CC00
		mov	esi, [esi]
		jmp	short loc_1000CC03
; ---------------------------------------------------------------------------

loc_1000CC00:				; CODE XREF: sub_1000CBB2+48j
		mov	esi, [esi+8]

loc_1000CC03:				; CODE XREF: sub_1000CBB2+17j
					; sub_1000CBB2+4Cj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000CBCB
		mov	esi, edi
		mov	[esp+14h+arg_4], esi
		test	al, al
		jz	short loc_1000CC49
		mov	eax, [ebp+0]
		cmp	edi, [eax]
		jnz	short loc_1000CC3C
		push	[esp+14h+arg_C]
		push	ebx
		push	edi
		push	1

loc_1000CC22:				; CODE XREF: sub_1000CBB2+AEj
		lea	eax, [esp+24h+arg_4]
		mov	ecx, ebp
		push	eax
		call	sub_1000C976
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000CC6C
; ---------------------------------------------------------------------------

loc_1000CC3C:				; CODE XREF: sub_1000CBB2+66j
		lea	ecx, [esp+14h+arg_4]
		call	sub_1000911E
		mov	esi, [esp+14h+arg_4]

loc_1000CC49:				; CODE XREF: sub_1000CBB2+5Fj
		push	ebx
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000CC62
		push	[esp+14h+arg_C]
		push	ebx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_1000CC22
; ---------------------------------------------------------------------------

loc_1000CC62:				; CODE XREF: sub_1000CBB2+A2j
		mov	eax, [esp+14h+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000CC6C:				; CODE XREF: sub_1000CBB2+88j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1000CBB2	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CC74	proc near		; CODE XREF: sub_1000CE06+11Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	al, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], al
		push	esi
		push	edi
		mov	edi, [ebp+0]
		mov	esi, [edi+4]
		jmp	short loc_1000CCC5
; ---------------------------------------------------------------------------

loc_1000CC8D:				; CODE XREF: sub_1000CC74+55j
		cmp	byte ptr [esp+14h+arg_4], 0
		mov	edi, esi
		jz	short loc_1000CCA6
		push	ebx
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		setns	al
		jmp	short loc_1000CCB6
; ---------------------------------------------------------------------------

loc_1000CCA6:				; CODE XREF: sub_1000CC74+20j
		lea	eax, [esi+10h]
		mov	ecx, ebx
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		sets	al

loc_1000CCB6:				; CODE XREF: sub_1000CC74+30j
		mov	byte ptr [esp+14h+var_4], al
		test	al, al
		jz	short loc_1000CCC2
		mov	esi, [esi]
		jmp	short loc_1000CCC5
; ---------------------------------------------------------------------------

loc_1000CCC2:				; CODE XREF: sub_1000CC74+48j
		mov	esi, [esi+8]

loc_1000CCC5:				; CODE XREF: sub_1000CC74+17j
					; sub_1000CC74+4Cj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000CC8D
		mov	esi, edi
		mov	[esp+14h+arg_4], esi
		test	al, al
		jz	short loc_1000CD0B
		mov	eax, [ebp+0]
		cmp	edi, [eax]
		jnz	short loc_1000CCFE
		push	[esp+14h+arg_C]
		push	ebx
		push	edi
		push	1

loc_1000CCE4:				; CODE XREF: sub_1000CC74+AEj
		lea	eax, [esp+24h+arg_4]
		mov	ecx, ebp
		push	eax
		call	sub_1000CA94
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000CD2E
; ---------------------------------------------------------------------------

loc_1000CCFE:				; CODE XREF: sub_1000CC74+66j
		lea	ecx, [esp+14h+arg_4]
		call	sub_1000911E
		mov	esi, [esp+14h+arg_4]

loc_1000CD0B:				; CODE XREF: sub_1000CC74+5Fj
		push	ebx
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000CD24
		push	[esp+14h+arg_C]
		push	ebx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_1000CCE4
; ---------------------------------------------------------------------------

loc_1000CD24:				; CODE XREF: sub_1000CC74+A2j
		mov	eax, [esp+14h+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000CD2E:				; CODE XREF: sub_1000CC74+88j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1000CC74	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CD36	proc near		; CODE XREF: sub_1000C87E+15p
					; sub_1000CE06+104p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		and	dword ptr [esi], 0
		and	dword ptr [esi+4], 0
		call	sub_1000D2ED
		mov	edx, [esp+4+arg_0]
		mov	[esi], eax
		mov	ecx, [edx]
		mov	[esi], ecx
		mov	[edx], eax
		mov	ecx, [esi+4]
		mov	eax, [edx+4]
		mov	[esi+4], eax
		mov	eax, esi
		mov	[edx+4], ecx
		pop	esi
		retn	4
sub_1000CD36	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CD63	proc near		; CODE XREF: sub_10016099+95p
		push	esi
		mov	esi, ecx
		and	dword ptr [esi], 0
		and	dword ptr [esi+4], 0
		call	sub_1000D2C3
		mov	[esi], eax
		mov	eax, esi
		pop	esi
		retn
sub_1000CD63	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CD78	proc near		; CODE XREF: sub_1001627A+EDp
					; sub_10019991+38p ...

var_4		= dword	ptr -4

		push	ecx
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	eax		; int
		push	dword ptr [eax]	; void *
		lea	eax, [esp+10h+var_4]
		push	eax		; int
		call	sub_1000D4EA
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	esi
		pop	ecx
		retn
sub_1000CD78	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CD96	proc near		; CODE XREF: sub_1000CDB4+6p
					; sub_1000CE06+127p ...

var_4		= dword	ptr -4

		push	ecx
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	eax		; int
		push	dword ptr [eax]	; void *
		lea	eax, [esp+10h+var_4]
		push	eax		; int
		call	sub_1000D76D
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	esi
		pop	ecx
		retn
sub_1000CD96	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000CDB4(void *)
sub_1000CDB4	proc near		; CODE XREF: sub_1000D3E3+20p
					; sub_1000D539+20Cp ...
		push	esi
		mov	esi, ecx
		lea	ecx, [esi+18h]
		call	sub_1000CD96
		push	0		; int
		push	1		; char
		mov	ecx, esi	; void *
		call	sub_100022C1
		pop	esi
		retn
sub_1000CDB4	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CDCC	proc near		; CODE XREF: sub_100050C9+ECp
					; sub_10005220+B0p ...
		mov	edx, ecx
		mov	ecx, [edx]
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_1000CE03
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_1000CDF8
		jmp	short loc_1000CDE3
; ---------------------------------------------------------------------------

loc_1000CDE1:				; CODE XREF: sub_1000CDCC+1Dj
		mov	eax, ecx

loc_1000CDE3:				; CODE XREF: sub_1000CDCC+13j
		mov	ecx, [eax]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_1000CDE1
		mov	[edx], eax
		jmp	short loc_1000CE03
; ---------------------------------------------------------------------------

loc_1000CDEF:				; CODE XREF: sub_1000CDCC+33j
		mov	eax, [edx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000CE01
		mov	[edx], ecx

loc_1000CDF8:				; CODE XREF: sub_1000CDCC+11j
		mov	ecx, [ecx+4]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_1000CDEF

loc_1000CE01:				; CODE XREF: sub_1000CDCC+28j
		mov	[edx], ecx

loc_1000CE03:				; CODE XREF: sub_1000CDCC+8j
					; sub_1000CDCC+21j
		mov	eax, edx
		retn
sub_1000CDCC	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000CE06(void *, void *)
sub_1000CE06	proc near		; CODE XREF: sub_1001641E+6j

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_3C		= word ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+58h+arg_4]
		mov	ebp, ecx
		push	edi
		mov	edi, [esp+5Ch+arg_0]
		test	edi, edi
		jnz	short loc_1000CE2E
		push	2
		pop	eax
		jmp	loc_1000CFA5
; ---------------------------------------------------------------------------

loc_1000CE2E:				; CODE XREF: sub_1000CE06+1Ej
		xor	ebx, ebx
		mov	[esp+5Ch+var_28], 7
		xor	eax, eax
		mov	[esp+5Ch+var_2C], ebx
		mov	[esp+5Ch+var_3C], ax
		test	esi, esi
		jz	short loc_1000CEAE
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	esi		; void *
		lea	ecx, [esp+64h+var_3C]
		call	sub_100023C8
		push	offset aKey	; "Key"
		lea	ecx, [esp+60h+var_24]
		call	sub_10001E8D
		push	edi
		mov	ecx, eax
		call	sub_10009F23
		mov	ebx, eax
		lea	ecx, [esp+5Ch+var_24] ;	void *
		push	0		; int
		neg	ebx
		push	1		; char
		sbb	bl, bl
		call	sub_100022C1
		inc	bl
		jz	short loc_1000CEAC
		lea	eax, [esp+5Ch+var_3C]
		push	eax
		sub	esp, 18h
		mov	ecx, esp
		push	eax
		call	sub_10003B1C
		call	sub_1001A2A8
		add	esp, 1Ch
		xor	ebx, ebx
		test	al, al
		jnz	short loc_1000CEAE
		push	2
		pop	esi
		jmp	loc_1000CF97
; ---------------------------------------------------------------------------

loc_1000CEAC:				; CODE XREF: sub_1000CE06+7Ej
		xor	ebx, ebx

loc_1000CEAE:				; CODE XREF: sub_1000CE06+3Fj
					; sub_1000CE06+9Cj
		push	edi		; void *
		lea	ecx, [esp+60h+var_24]
		call	sub_10001E8D
		lea	eax, [esp+5Ch+var_24]
		mov	ecx, ebp
		push	eax
		lea	eax, [esp+60h+var_4C]
		push	eax
		call	sub_1000D9F4
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+64h+var_24] ;	void *
		call	sub_100022C1
		mov	eax, [esp+5Ch+var_4C]
		cmp	eax, [ebp+0]
		jnz	loc_1000CF67
		lea	ecx, [esp+5Ch+var_4C]
		mov	[esp+5Ch+var_4C], ebx
		mov	[esp+5Ch+var_48], ebx
		call	sub_1000D2ED
		push	edi		; void *
		lea	ecx, [esp+60h+var_24]
		mov	[esp+60h+var_4C], eax
		call	sub_10001E8D
		lea	eax, [esp+5Ch+var_4C]
		push	eax
		lea	ecx, [esp+60h+var_C]
		call	sub_1000CD36
		movzx	eax, byte_10033C4A
		mov	ecx, ebp
		push	eax
		lea	eax, [esp+60h+var_24]
		push	eax
		push	ebx
		lea	eax, [esp+68h+var_44]
		push	eax
		call	sub_1000CC74
		lea	ecx, [esp+5Ch+var_C]
		call	sub_1000CD96
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+64h+var_24] ;	void *
		call	sub_100022C1
		lea	ecx, [esp+5Ch+var_4C]
		call	sub_1000CD96
		test	esi, esi
		jz	short loc_1000CF95
		movzx	eax, byte_10033C4A
		mov	ecx, [esp+5Ch+var_44]
		push	eax
		lea	eax, [esp+60h+var_3C]
		push	eax
		push	ebx
		lea	eax, [esp+68h+var_4C]
		push	eax
		lea	ecx, [ecx+28h]
		jmp	short loc_1000CF90
; ---------------------------------------------------------------------------

loc_1000CF67:				; CODE XREF: sub_1000CE06+D6j
		test	esi, esi
		jnz	short loc_1000CF75
		lea	ecx, [eax+28h]
		call	sub_1000D4AB
		jmp	short loc_1000CF95
; ---------------------------------------------------------------------------

loc_1000CF75:				; CODE XREF: sub_1000CE06+163j
		cmp	[eax+2Ch], ebx
		jz	short loc_1000CF95
		movzx	ecx, byte_10033C4A
		push	ecx
		lea	ecx, [esp+60h+var_3C]
		push	ecx
		lea	ecx, [esp+64h+var_44]
		push	ebx
		push	ecx
		lea	ecx, [eax+28h]

loc_1000CF90:				; CODE XREF: sub_1000CE06+15Fj
		call	sub_1000CBB2

loc_1000CF95:				; CODE XREF: sub_1000CE06+143j
					; sub_1000CE06+16Dj ...
		mov	esi, ebx

loc_1000CF97:				; CODE XREF: sub_1000CE06+A1j
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+64h+var_3C] ;	void *
		call	sub_100022C1
		mov	eax, esi

loc_1000CFA5:				; CODE XREF: sub_1000CE06+23j
		mov	ecx, [esp+5Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn	8
sub_1000CE06	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CFBA	proc near		; CODE XREF: sub_1000D0F8+14p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ecx
		push	ecx
		push	esi
		push	edi
		mov	edi, [ecx]
		push	8
		pop	esi
		mov	eax, [edi]
		mov	[esp+10h+var_4], eax
		cmp	eax, edi
		jz	short loc_1000D01B
		push	ebx
		push	ebp

loc_1000CFCF:				; CODE XREF: sub_1000CFBA+5Dj
		mov	ecx, [eax+20h]
		mov	ebp, [eax+28h]
		lea	ebx, ds:0Eh[ecx*2]
		mov	eax, [ebp+0]
		mov	[esp+18h+var_8], eax
		jmp	short loc_1000CFFB
; ---------------------------------------------------------------------------

loc_1000CFE5:				; CODE XREF: sub_1000CFBA+43j
		mov	eax, [eax+20h]
		lea	ecx, [esp+18h+var_8]
		lea	ebx, [ebx+eax*2]
		add	ebx, 2
		call	sub_1000CDCC
		mov	eax, [esp+18h+var_8]

loc_1000CFFB:				; CODE XREF: sub_1000CFBA+29j
		cmp	eax, ebp
		jnz	short loc_1000CFE5
		push	ebx
		call	sub_1000C89F
		pop	ecx
		lea	ecx, [esp+18h+var_4]
		add	esi, eax
		call	sub_1000CDCC
		mov	eax, [esp+18h+var_4]
		cmp	eax, edi
		jnz	short loc_1000CFCF
		pop	ebp
		pop	ebx

loc_1000D01B:				; CODE XREF: sub_1000CFBA+11j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ecx
		pop	ecx
		retn
sub_1000CFBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D022	proc near		; CODE XREF: sub_1000E09A+146p

var_B8		= byte ptr -0B8h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0B8h
		push	ebx
		xor	ebx, ebx
		mov	[ebp+var_4], ebx
		push	esi
		cmp	dword_10033C4C,	ebx
		jnz	short loc_1000D04B
		push	offset dword_10033C4C ;	int
		push	offset aNtqueryobject ;	"NtQueryObject"
		call	sub_1001A242
		pop	ecx
		pop	ecx

loc_1000D04B:				; CODE XREF: sub_1000D022+16j
		and	[ebp+var_4], ebx
		mov	eax, 104h
		mov	[ebp+var_8], eax
		push	edi

loc_1000D057:				; CODE XREF: sub_1000D022+84j
		push	eax		; size_t
		call	ds:malloc
		pop	ecx
		push	eax
		lea	ecx, [ebp+var_4]
		call	sub_100083BD
		test	bl, 1
		jz	short loc_1000D07B
		lea	ecx, [ebp+var_B8]
		and	ebx, 0FFFFFFFEh
		call	sub_10002021

loc_1000D07B:				; CODE XREF: sub_1000D022+49j
		mov	esi, [ebp+var_4]
		lea	eax, [ebp+var_8]
		push	eax
		push	[ebp+var_8]
		push	esi
		push	1
		push	[ebp+arg_0]
		call	dword_10033C4C
		mov	edi, eax
		cmp	edi, 0C0000004h
		jz	short loc_1000D0A3
		cmp	edi, 80000005h
		jnz	short loc_1000D0A8

loc_1000D0A3:				; CODE XREF: sub_1000D022+77j
		mov	eax, [ebp+var_8]
		jmp	short loc_1000D057
; ---------------------------------------------------------------------------

loc_1000D0A8:				; CODE XREF: sub_1000D022+7Fj
		test	edi, edi
		js	short loc_1000D0CA
		cmp	dword ptr [esi+4], 0
		jz	short loc_1000D0CA
		movzx	eax, word ptr [esi]
		test	ax, ax
		jz	short loc_1000D0CA
		mov	ecx, [ebp+arg_4]
		shr	eax, 1
		push	eax		; int
		push	dword ptr [esi+4] ; void *
		call	sub_100023C8
		jmp	short loc_1000D0DE
; ---------------------------------------------------------------------------

loc_1000D0CA:				; CODE XREF: sub_1000D022+88j
					; sub_1000D022+8Ej ...
		mov	eax, [ebp+arg_4]
		and	dword ptr [eax+10h], 0
		cmp	dword ptr [eax+14h], 8
		jb	short loc_1000D0D9
		mov	eax, [eax]

loc_1000D0D9:				; CODE XREF: sub_1000D022+B3j
		xor	ecx, ecx
		mov	[eax], cx

loc_1000D0DE:				; CODE XREF: sub_1000D022+A6j
		test	edi, edi
		pop	edi
		setns	bl
		test	esi, esi
		jz	short loc_1000D0F0
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_1000D0F0:				; CODE XREF: sub_1000D022+C4j
		pop	esi
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D022	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D0F8	proc near		; CODE XREF: sub_1001664B+4Ap

NumberOfBytesWritten= dword ptr	-4
arg_0		= dword	ptr  4

		push	ecx
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 0
		jnz	short loc_1000D109
		mov	al, 1
		jmp	loc_1000D1B6
; ---------------------------------------------------------------------------

loc_1000D109:				; CODE XREF: sub_1000D0F8+8j
		push	ebx
		push	ebp
		push	esi
		call	sub_1000CFBA
		mov	ebp, eax
		xor	ecx, ecx
		push	4
		shr	eax, 2
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_1001AAE8
		pop	ecx
		mov	esi, eax
		mov	ecx, edi
		push	ebp		; size_t
		push	esi		; void *
		call	sub_1000D1BB
		test	al, al
		jz	short loc_1000D1A4
		mov	ebx, [esp+14h+arg_0]
		push	4		; flProtect
		push	1000h		; flAllocationType
		push	ebp		; dwSize
		mov	ebx, [ebx]
		push	0		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualAllocEx
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000D1A4
		lea	eax, [esp+14h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	ebp		; nSize
		push	esi		; lpBuffer
		push	edi		; lpBaseAddress
		push	ebx		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000D195
		cmp	[esp+14h+NumberOfBytesWritten],	ebp
		jnz	short loc_1000D195
		mov	ecx, [esp+14h+arg_0]
		push	4		; nSize
		push	offset g_handles_to_close ; lpBuffer
		push	offset aG_handles_to_0 ; "g_handles_to_close"
		mov	g_handles_to_close, edi
		call	sub_100198FB
		mov	ebx, eax
		neg	ebx
		sbb	bl, bl
		inc	bl
		jmp	short loc_1000D1A6
; ---------------------------------------------------------------------------

loc_1000D195:				; CODE XREF: sub_1000D0F8+70j
					; sub_1000D0F8+76j
		push	8000h		; dwFreeType
		push	0		; dwSize
		push	edi		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualFreeEx

loc_1000D1A4:				; CODE XREF: sub_1000D0F8+40j
					; sub_1000D0F8+5Dj
		xor	bl, bl

loc_1000D1A6:				; CODE XREF: sub_1000D0F8+9Bj
		test	esi, esi
		jz	short loc_1000D1B1
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_1000D1B1:				; CODE XREF: sub_1000D0F8+B0j
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx

loc_1000D1B6:				; CODE XREF: sub_1000D0F8+Cj
		pop	edi
		pop	ecx
		retn	4
sub_1000D0F8	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000D1BB(void *, size_t)
sub_1000D1BB	proc near		; CODE XREF: sub_1000D0F8+39p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [esp+1Ch+arg_4]
		push	edi		; size_t
		push	0		; int
		push	esi		; void *
		mov	[esp+28h+var_8], ebx
		call	memset
		mov	[esi], edi
		lea	ebp, [esi+edi]
		mov	eax, [ebx+4]
		add	esp, 0Ch
		mov	[esi+4], eax
		lea	ebx, [esi+8]
		mov	eax, [esp+1Ch+var_8]
		mov	eax, [eax]
		mov	esi, [eax]
		mov	[esp+1Ch+var_C], esi
		cmp	esi, eax
		jz	loc_1000D2B0

loc_1000D1FE:				; CODE XREF: sub_1000D1BB+EFj
		cmp	ebx, ebp
		jnb	loc_1000D2BF
		push	0
		push	dword ptr [esi+20h]
		mov	[esp+24h+arg_0], ebx
		lea	ecx, [esi+10h]
		push	dword ptr [esi+20h]
		add	ebx, 0Ch
		push	ebx
		call	sub_1000D37B
		mov	eax, [esi+20h]
		mov	ecx, [esp+1Ch+arg_0]
		lea	edi, [ebx+eax*2]
		xor	eax, eax
		mov	[edi], ax
		add	edi, 2
		mov	eax, edi
		sub	eax, ecx
		mov	[ecx+4], eax
		mov	eax, [esi+2Ch]
		mov	[ecx+8], eax
		mov	ecx, [esi+28h]
		mov	eax, [ecx]
		mov	[esp+1Ch+arg_4], eax
		cmp	eax, ecx
		jz	short loc_1000D284

loc_1000D24A:				; CODE XREF: sub_1000D1BB+C7j
		lea	ecx, [eax+10h]
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000D257
		mov	ebx, [ecx]
		jmp	short loc_1000D259
; ---------------------------------------------------------------------------

loc_1000D257:				; CODE XREF: sub_1000D1BB+96j
		mov	ebx, ecx

loc_1000D259:				; CODE XREF: sub_1000D1BB+9Aj
		lea	eax, [esp+1Ch+var_4]
		push	eax
		call	sub_100041ED
		push	edi		; void *
		push	dword ptr [eax]	; int
		push	ebx		; void *
		call	sub_1000C94E
		add	esp, 0Ch
		lea	ecx, [esp+1Ch+arg_4]
		lea	edi, [eax+2]
		call	sub_1000CDCC
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, [esi+28h]
		jnz	short loc_1000D24A

loc_1000D284:				; CODE XREF: sub_1000D1BB+8Dj
		push	edi
		call	sub_1000C89F
		mov	ebx, eax
		mov	eax, [esp+20h+arg_0]
		pop	ecx
		mov	ecx, ebx
		sub	ecx, eax
		mov	[eax], ecx
		lea	ecx, [esp+1Ch+var_C]
		call	sub_1000CDCC
		mov	eax, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_C]
		cmp	esi, [eax]
		jnz	loc_1000D1FE

loc_1000D2B0:				; CODE XREF: sub_1000D1BB+3Dj
		cmp	ebp, ebx
		sbb	eax, eax
		inc	eax

loc_1000D2B5:				; CODE XREF: sub_1000D1BB+106j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn	8
; ---------------------------------------------------------------------------

loc_1000D2BF:				; CODE XREF: sub_1000D1BB+45j
		xor	al, al
		jmp	short loc_1000D2B5
sub_1000D1BB	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D2C3	proc near		; CODE XREF: sub_1000CD63+Ap
					; sub_10019991+19p
		push	0
		push	1
		call	sub_1000C8B2
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1000D2D4
		mov	[eax], eax

loc_1000D2D4:				; CODE XREF: sub_1000D2C3+Dj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_1000D2DD
		mov	[ecx], eax

loc_1000D2DD:				; CODE XREF: sub_1000D2C3+16j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_1000D2E6
		mov	[ecx], eax

loc_1000D2E6:				; CODE XREF: sub_1000D2C3+1Fj
		mov	word ptr [eax+0Ch], 101h
		retn
sub_1000D2C3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D2ED	proc near		; CODE XREF: sub_1000CD36+Ap
					; sub_1000CE06+E8p ...
		push	0
		push	1
		call	sub_1000C8DC
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1000D2FE
		mov	[eax], eax

loc_1000D2FE:				; CODE XREF: sub_1000D2ED+Dj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_1000D307
		mov	[ecx], eax

loc_1000D307:				; CODE XREF: sub_1000D2ED+16j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_1000D310
		mov	[ecx], eax

loc_1000D310:				; CODE XREF: sub_1000D2ED+1Fj
		mov	word ptr [eax+0Ch], 101h
		retn
sub_1000D2ED	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D317	proc near		; CODE XREF: sub_1000C92A+1p
					; sub_1000DA5A+4p
		push	esi
		push	0
		push	1
		mov	esi, ecx
		call	sub_1000C8B2
		mov	edx, eax
		pop	ecx
		pop	ecx
		test	edx, edx
		jz	short loc_1000D32F
		mov	ecx, [esi]
		mov	[edx], ecx

loc_1000D32F:				; CODE XREF: sub_1000D317+12j
		lea	ecx, [edx+4]
		test	ecx, ecx
		jz	short loc_1000D33A
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000D33A:				; CODE XREF: sub_1000D317+1Dj
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_1000D345
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000D345:				; CODE XREF: sub_1000D317+28j
		mov	eax, edx
		pop	esi
		retn
sub_1000D317	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D349	proc near		; CODE XREF: sub_1000C906+1p
					; sub_1000DA87+1p
		push	esi
		push	0
		push	1
		mov	esi, ecx
		call	sub_1000C8DC
		mov	edx, eax
		pop	ecx
		pop	ecx
		test	edx, edx
		jz	short loc_1000D361
		mov	ecx, [esi]
		mov	[edx], ecx

loc_1000D361:				; CODE XREF: sub_1000D349+12j
		lea	ecx, [edx+4]
		test	ecx, ecx
		jz	short loc_1000D36C
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000D36C:				; CODE XREF: sub_1000D349+1Dj
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_1000D377
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000D377:				; CODE XREF: sub_1000D349+28j
		mov	eax, edx
		pop	esi
		retn
sub_1000D349	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D37B	proc near		; CODE XREF: sub_1000D1BB+5Ep
					; sub_1000F623+54p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [ecx+10h]
		mov	edx, [esp+arg_C]
		cmp	eax, edx
		jnb	short loc_1000D391
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_1000D391:				; CODE XREF: sub_1000D37B+9j
		push	esi
		mov	esi, [esp+4+arg_8]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_1000D39E
		mov	esi, eax

loc_1000D39E:				; CODE XREF: sub_1000D37B+1Fj
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000D3A6
		mov	ecx, [ecx]

loc_1000D3A6:				; CODE XREF: sub_1000D37B+27j
		push	esi
		lea	ecx, [ecx+edx*2]
		push	ecx
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	sub_1000D3C1
		add	esp, 10h
		mov	eax, esi
		pop	esi
		retn	10h
sub_1000D37B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D3C1	proc near		; CODE XREF: sub_1000D37B+38p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_C], 0
		jbe	short loc_1000D3DE
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	wmemcpy_s
		add	esp, 10h

loc_1000D3DE:				; CODE XREF: sub_1000D3C1+7j
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_1000D3C1	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000D3E3(void *)
sub_1000D3E3	proc near		; CODE XREF: sub_1000D3E3+16p
					; sub_1000D48A+8p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, esi
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_1000D417

loc_1000D3F4:				; CODE XREF: sub_1000D3E3+32j
		push	dword ptr [edi+8] ; void *
		mov	ecx, ebx
		call	sub_1000D3E3
		mov	edi, [edi]
		lea	ecx, [esi+10h]	; void *
		call	sub_1000CDB4
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, edi
		pop	ecx
		jz	short loc_1000D3F4

loc_1000D417:				; CODE XREF: sub_1000D3E3+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000D3E3	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000D41D(void *)
sub_1000D41D	proc near		; CODE XREF: sub_1000D41D+16p
					; sub_1000D4AB+8p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, esi
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_1000D455

loc_1000D42E:				; CODE XREF: sub_1000D41D+36j
		push	dword ptr [edi+8] ; void *
		mov	ecx, ebx
		call	sub_1000D41D
		mov	edi, [edi]
		lea	ecx, [esi+10h]	; void *
		push	0		; int
		push	1		; char
		call	sub_100022C1
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, edi
		pop	ecx
		jz	short loc_1000D42E

loc_1000D455:				; CODE XREF: sub_1000D41D+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000D41D	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D45B	proc near		; CODE XREF: sub_1000D9F4+Ap
					; sub_1000E03C+Dp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [ecx]
		mov	esi, [edi+4]
		jmp	short loc_1000D47D
; ---------------------------------------------------------------------------

loc_1000D464:				; CODE XREF: sub_1000D45B+26j
		push	[esp+8+arg_0]
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000D479
		mov	esi, [esi+8]
		jmp	short loc_1000D47D
; ---------------------------------------------------------------------------

loc_1000D479:				; CODE XREF: sub_1000D45B+17j
		mov	edi, esi
		mov	esi, [esi]

loc_1000D47D:				; CODE XREF: sub_1000D45B+7j
					; sub_1000D45B+1Cj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000D464
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_1000D45B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D48A	proc near		; CODE XREF: sub_1000D4EA+16p
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4] ; void *
		call	sub_1000D3E3
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		and	dword ptr [esi+4], 0
		pop	esi
		retn
sub_1000D48A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D4AB	proc near		; CODE XREF: sub_1000CE06+168p
					; sub_1000D76D+16p
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4] ; void *
		call	sub_1000D41D
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		and	dword ptr [esi+4], 0
		pop	esi
		retn
sub_1000D4AB	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D4CC	proc near		; CODE XREF: sub_1000CBB2+26p
					; sub_1000CBB2+38p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+14h], 8
		mov	edx, [eax+10h]
		jb	short loc_1000D4DB
		mov	eax, [eax]

loc_1000D4DB:				; CODE XREF: sub_1000D4CC+Bj
		push	edx
		push	eax
		push	dword ptr [ecx+10h]
		push	0
		call	sub_10004188
		retn	4
sub_1000D4CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000D4EA(int, void *, int)
sub_1000D4EA	proc near		; CODE XREF: sub_1000CD78+Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		cmp	esi, [eax]
		jnz	short loc_1000D527
		cmp	[ebp+arg_8], eax
		jnz	short loc_1000D527
		call	sub_1000D48A
		mov	eax, [edi]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		jmp	short loc_1000D531
; ---------------------------------------------------------------------------

loc_1000D510:				; CODE XREF: sub_1000D4EA+40j
		lea	ecx, [ebp+arg_4]
		call	sub_1000CDCC
		push	esi		; void *
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax		; int
		call	sub_1000D539
		mov	esi, [ebp+arg_4]

loc_1000D527:				; CODE XREF: sub_1000D4EA+Fj
					; sub_1000D4EA+14j
		cmp	esi, [ebp+arg_8]
		jnz	short loc_1000D510
		mov	eax, [ebp+arg_0]
		mov	[eax], esi

loc_1000D531:				; CODE XREF: sub_1000D4EA+24j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000D4EA	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000D539(int, void *)
sub_1000D539	proc near		; CODE XREF: sub_1000D4EA+35p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		push	esi
		mov	ebp, ecx
		lea	ecx, [esp+0Ch+arg_4]
		push	edi
		call	sub_1000CDCC
		mov	ecx, [ebx]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_1000D559
		mov	edi, [ebx+8]
		jmp	short loc_1000D571
; ---------------------------------------------------------------------------

loc_1000D559:				; CODE XREF: sub_1000D539+19j
		mov	eax, [ebx+8]
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_1000D566
		mov	edi, ecx
		jmp	short loc_1000D571
; ---------------------------------------------------------------------------

loc_1000D566:				; CODE XREF: sub_1000D539+27j
		mov	edx, [esp+10h+arg_4]
		mov	edi, [edx+8]
		cmp	edx, ebx
		jnz	short loc_1000D5E1

loc_1000D571:				; CODE XREF: sub_1000D539+1Ej
					; sub_1000D539+2Bj
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [ebx+4]
		jnz	short loc_1000D57D
		mov	[edi+4], esi

loc_1000D57D:				; CODE XREF: sub_1000D539+3Fj
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_1000D58A
		mov	[eax+4], edi
		jmp	short loc_1000D595
; ---------------------------------------------------------------------------

loc_1000D58A:				; CODE XREF: sub_1000D539+4Aj
		cmp	[esi], ebx
		jnz	short loc_1000D592
		mov	[esi], edi
		jmp	short loc_1000D595
; ---------------------------------------------------------------------------

loc_1000D592:				; CODE XREF: sub_1000D539+53j
		mov	[esi+8], edi

loc_1000D595:				; CODE XREF: sub_1000D539+4Fj
					; sub_1000D539+57j
		mov	edx, [ebp+0]
		cmp	[edx], ebx
		jnz	short loc_1000D5B8
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000D5A6
		mov	eax, esi
		jmp	short loc_1000D5B6
; ---------------------------------------------------------------------------

loc_1000D5A6:				; CODE XREF: sub_1000D539+67j
		mov	ecx, [edi]
		mov	eax, edi
		jmp	short loc_1000D5B0
; ---------------------------------------------------------------------------

loc_1000D5AC:				; CODE XREF: sub_1000D539+7Bj
		mov	eax, ecx
		mov	ecx, [eax]

loc_1000D5B0:				; CODE XREF: sub_1000D539+71j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_1000D5AC

loc_1000D5B6:				; CODE XREF: sub_1000D539+6Bj
		mov	[edx], eax

loc_1000D5B8:				; CODE XREF: sub_1000D539+61j
		mov	edx, [ebp+0]
		cmp	[edx+8], ebx
		jnz	short loc_1000D638
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000D5CA
		mov	eax, esi
		jmp	short loc_1000D5DC
; ---------------------------------------------------------------------------

loc_1000D5CA:				; CODE XREF: sub_1000D539+8Bj
		mov	ecx, [edi+8]
		mov	eax, edi
		jmp	short loc_1000D5D6
; ---------------------------------------------------------------------------

loc_1000D5D1:				; CODE XREF: sub_1000D539+A1j
		mov	eax, ecx
		mov	ecx, [eax+8]

loc_1000D5D6:				; CODE XREF: sub_1000D539+96j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_1000D5D1

loc_1000D5DC:				; CODE XREF: sub_1000D539+8Fj
		mov	[edx+8], eax
		jmp	short loc_1000D638
; ---------------------------------------------------------------------------

loc_1000D5E1:				; CODE XREF: sub_1000D539+36j
		mov	[ecx+4], edx
		mov	eax, [ebx]
		mov	[edx], eax
		cmp	edx, [ebx+8]
		jnz	short loc_1000D5F1
		mov	esi, edx
		jmp	short loc_1000D60B
; ---------------------------------------------------------------------------

loc_1000D5F1:				; CODE XREF: sub_1000D539+B2j
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [edx+4]
		jnz	short loc_1000D5FD
		mov	[edi+4], esi

loc_1000D5FD:				; CODE XREF: sub_1000D539+BFj
		mov	[esi], edi
		mov	eax, [ebx+8]
		mov	[edx+8], eax
		mov	eax, [ebx+8]
		mov	[eax+4], edx

loc_1000D60B:				; CODE XREF: sub_1000D539+B6j
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_1000D618
		mov	[eax+4], edx
		jmp	short loc_1000D626
; ---------------------------------------------------------------------------

loc_1000D618:				; CODE XREF: sub_1000D539+D8j
		mov	eax, [ebx+4]
		cmp	[eax], ebx
		jnz	short loc_1000D623
		mov	[eax], edx
		jmp	short loc_1000D626
; ---------------------------------------------------------------------------

loc_1000D623:				; CODE XREF: sub_1000D539+E4j
		mov	[eax+8], edx

loc_1000D626:				; CODE XREF: sub_1000D539+DDj
					; sub_1000D539+E8j
		mov	eax, [ebx+4]
		mov	[edx+4], eax
		mov	al, [ebx+0Ch]
		mov	cl, [edx+0Ch]
		mov	[edx+0Ch], al
		mov	[ebx+0Ch], cl

loc_1000D638:				; CODE XREF: sub_1000D539+85j
					; sub_1000D539+A6j
		cmp	byte ptr [ebx+0Ch], 1
		jnz	loc_1000D742
		jmp	loc_1000D6FB
; ---------------------------------------------------------------------------

loc_1000D647:				; CODE XREF: sub_1000D539+1C8j
		cmp	byte ptr [edi+0Ch], 1
		jnz	loc_1000D73E
		mov	ecx, [esi]
		cmp	edi, ecx
		jnz	short loc_1000D6C3
		mov	ecx, [esi+8]
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000D673
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_100057C3
		mov	ecx, [esi+8]

loc_1000D673:				; CODE XREF: sub_1000D539+125j
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_1000D6F6
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D68A
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jz	short loc_1000D6F2

loc_1000D68A:				; CODE XREF: sub_1000D539+146j
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D6A8
		mov	eax, [ecx]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_10009EBF
		mov	ecx, [esi+8]

loc_1000D6A8:				; CODE XREF: sub_1000D539+158j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx+8]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_100057C3
		jmp	short loc_1000D73E
; ---------------------------------------------------------------------------

loc_1000D6C3:				; CODE XREF: sub_1000D539+11Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000D6DB
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_10009EBF
		mov	ecx, [esi]

loc_1000D6DB:				; CODE XREF: sub_1000D539+18Ej
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_1000D6F6
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D709
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D709

loc_1000D6F2:				; CODE XREF: sub_1000D539+14Fj
		mov	byte ptr [ecx+0Ch], 0

loc_1000D6F6:				; CODE XREF: sub_1000D539+13Ej
					; sub_1000D539+1A6j
		mov	edi, esi
		mov	esi, [esi+4]

loc_1000D6FB:				; CODE XREF: sub_1000D539+109j
		mov	eax, [ebp+0]
		cmp	edi, [eax+4]
		jnz	loc_1000D647
		jmp	short loc_1000D73E
; ---------------------------------------------------------------------------

loc_1000D709:				; CODE XREF: sub_1000D539+1AFj
					; sub_1000D539+1B7j
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D726
		mov	eax, [ecx+8]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_100057C3
		mov	ecx, [esi]

loc_1000D726:				; CODE XREF: sub_1000D539+1D6j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_10009EBF

loc_1000D73E:				; CODE XREF: sub_1000D539+112j
					; sub_1000D539+188j ...
		mov	byte ptr [edi+0Ch], 1

loc_1000D742:				; CODE XREF: sub_1000D539+103j
		lea	ecx, [ebx+10h]	; void *
		call	sub_1000CDB4
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [ebp+4]
		pop	ecx
		test	eax, eax
		jz	short loc_1000D75C
		dec	eax
		mov	[ebp+4], eax

loc_1000D75C:				; CODE XREF: sub_1000D539+21Dj
		mov	eax, [esp+10h+arg_0]
		mov	ecx, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ecx
		pop	ebx
		retn	8
sub_1000D539	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000D76D(int, void *, int)
sub_1000D76D	proc near		; CODE XREF: sub_1000CD96+Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		cmp	esi, [eax]
		jnz	short loc_1000D7AA
		cmp	[ebp+arg_8], eax
		jnz	short loc_1000D7AA
		call	sub_1000D4AB
		mov	eax, [edi]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		jmp	short loc_1000D7B4
; ---------------------------------------------------------------------------

loc_1000D793:				; CODE XREF: sub_1000D76D+40j
		lea	ecx, [ebp+arg_4]
		call	sub_1000CDCC
		push	esi		; void *
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax		; int
		call	sub_1000D7BC
		mov	esi, [ebp+arg_4]

loc_1000D7AA:				; CODE XREF: sub_1000D76D+Fj
					; sub_1000D76D+14j
		cmp	esi, [ebp+arg_8]
		jnz	short loc_1000D793
		mov	eax, [ebp+arg_0]
		mov	[eax], esi

loc_1000D7B4:				; CODE XREF: sub_1000D76D+24j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000D76D	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000D7BC(int, void *)
sub_1000D7BC	proc near		; CODE XREF: sub_1000D76D+35p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		push	esi
		mov	ebp, ecx
		lea	ecx, [esp+0Ch+arg_4]
		push	edi
		call	sub_1000CDCC
		mov	ecx, [ebx]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_1000D7DC
		mov	edi, [ebx+8]
		jmp	short loc_1000D7F4
; ---------------------------------------------------------------------------

loc_1000D7DC:				; CODE XREF: sub_1000D7BC+19j
		mov	eax, [ebx+8]
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_1000D7E9
		mov	edi, ecx
		jmp	short loc_1000D7F4
; ---------------------------------------------------------------------------

loc_1000D7E9:				; CODE XREF: sub_1000D7BC+27j
		mov	edx, [esp+10h+arg_4]
		mov	edi, [edx+8]
		cmp	edx, ebx
		jnz	short loc_1000D864

loc_1000D7F4:				; CODE XREF: sub_1000D7BC+1Ej
					; sub_1000D7BC+2Bj
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [ebx+4]
		jnz	short loc_1000D800
		mov	[edi+4], esi

loc_1000D800:				; CODE XREF: sub_1000D7BC+3Fj
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_1000D80D
		mov	[eax+4], edi
		jmp	short loc_1000D818
; ---------------------------------------------------------------------------

loc_1000D80D:				; CODE XREF: sub_1000D7BC+4Aj
		cmp	[esi], ebx
		jnz	short loc_1000D815
		mov	[esi], edi
		jmp	short loc_1000D818
; ---------------------------------------------------------------------------

loc_1000D815:				; CODE XREF: sub_1000D7BC+53j
		mov	[esi+8], edi

loc_1000D818:				; CODE XREF: sub_1000D7BC+4Fj
					; sub_1000D7BC+57j
		mov	edx, [ebp+0]
		cmp	[edx], ebx
		jnz	short loc_1000D83B
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000D829
		mov	eax, esi
		jmp	short loc_1000D839
; ---------------------------------------------------------------------------

loc_1000D829:				; CODE XREF: sub_1000D7BC+67j
		mov	ecx, [edi]
		mov	eax, edi
		jmp	short loc_1000D833
; ---------------------------------------------------------------------------

loc_1000D82F:				; CODE XREF: sub_1000D7BC+7Bj
		mov	eax, ecx
		mov	ecx, [eax]

loc_1000D833:				; CODE XREF: sub_1000D7BC+71j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_1000D82F

loc_1000D839:				; CODE XREF: sub_1000D7BC+6Bj
		mov	[edx], eax

loc_1000D83B:				; CODE XREF: sub_1000D7BC+61j
		mov	edx, [ebp+0]
		cmp	[edx+8], ebx
		jnz	short loc_1000D8BB
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000D84D
		mov	eax, esi
		jmp	short loc_1000D85F
; ---------------------------------------------------------------------------

loc_1000D84D:				; CODE XREF: sub_1000D7BC+8Bj
		mov	ecx, [edi+8]
		mov	eax, edi
		jmp	short loc_1000D859
; ---------------------------------------------------------------------------

loc_1000D854:				; CODE XREF: sub_1000D7BC+A1j
		mov	eax, ecx
		mov	ecx, [eax+8]

loc_1000D859:				; CODE XREF: sub_1000D7BC+96j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_1000D854

loc_1000D85F:				; CODE XREF: sub_1000D7BC+8Fj
		mov	[edx+8], eax
		jmp	short loc_1000D8BB
; ---------------------------------------------------------------------------

loc_1000D864:				; CODE XREF: sub_1000D7BC+36j
		mov	[ecx+4], edx
		mov	eax, [ebx]
		mov	[edx], eax
		cmp	edx, [ebx+8]
		jnz	short loc_1000D874
		mov	esi, edx
		jmp	short loc_1000D88E
; ---------------------------------------------------------------------------

loc_1000D874:				; CODE XREF: sub_1000D7BC+B2j
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [edx+4]
		jnz	short loc_1000D880
		mov	[edi+4], esi

loc_1000D880:				; CODE XREF: sub_1000D7BC+BFj
		mov	[esi], edi
		mov	eax, [ebx+8]
		mov	[edx+8], eax
		mov	eax, [ebx+8]
		mov	[eax+4], edx

loc_1000D88E:				; CODE XREF: sub_1000D7BC+B6j
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_1000D89B
		mov	[eax+4], edx
		jmp	short loc_1000D8A9
; ---------------------------------------------------------------------------

loc_1000D89B:				; CODE XREF: sub_1000D7BC+D8j
		mov	eax, [ebx+4]
		cmp	[eax], ebx
		jnz	short loc_1000D8A6
		mov	[eax], edx
		jmp	short loc_1000D8A9
; ---------------------------------------------------------------------------

loc_1000D8A6:				; CODE XREF: sub_1000D7BC+E4j
		mov	[eax+8], edx

loc_1000D8A9:				; CODE XREF: sub_1000D7BC+DDj
					; sub_1000D7BC+E8j
		mov	eax, [ebx+4]
		mov	[edx+4], eax
		mov	al, [ebx+0Ch]
		mov	cl, [edx+0Ch]
		mov	[edx+0Ch], al
		mov	[ebx+0Ch], cl

loc_1000D8BB:				; CODE XREF: sub_1000D7BC+85j
					; sub_1000D7BC+A6j
		cmp	byte ptr [ebx+0Ch], 1
		jnz	loc_1000D9C5
		jmp	loc_1000D97E
; ---------------------------------------------------------------------------

loc_1000D8CA:				; CODE XREF: sub_1000D7BC+1C8j
		cmp	byte ptr [edi+0Ch], 1
		jnz	loc_1000D9C1
		mov	ecx, [esi]
		cmp	edi, ecx
		jnz	short loc_1000D946
		mov	ecx, [esi+8]
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000D8F6
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_100057C3
		mov	ecx, [esi+8]

loc_1000D8F6:				; CODE XREF: sub_1000D7BC+125j
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_1000D979
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D90D
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jz	short loc_1000D975

loc_1000D90D:				; CODE XREF: sub_1000D7BC+146j
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D92B
		mov	eax, [ecx]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_10009EBF
		mov	ecx, [esi+8]

loc_1000D92B:				; CODE XREF: sub_1000D7BC+158j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx+8]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_100057C3
		jmp	short loc_1000D9C1
; ---------------------------------------------------------------------------

loc_1000D946:				; CODE XREF: sub_1000D7BC+11Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000D95E
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_10009EBF
		mov	ecx, [esi]

loc_1000D95E:				; CODE XREF: sub_1000D7BC+18Ej
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_1000D979
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D98C
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D98C

loc_1000D975:				; CODE XREF: sub_1000D7BC+14Fj
		mov	byte ptr [ecx+0Ch], 0

loc_1000D979:				; CODE XREF: sub_1000D7BC+13Ej
					; sub_1000D7BC+1A6j
		mov	edi, esi
		mov	esi, [esi+4]

loc_1000D97E:				; CODE XREF: sub_1000D7BC+109j
		mov	eax, [ebp+0]
		cmp	edi, [eax+4]
		jnz	loc_1000D8CA
		jmp	short loc_1000D9C1
; ---------------------------------------------------------------------------

loc_1000D98C:				; CODE XREF: sub_1000D7BC+1AFj
					; sub_1000D7BC+1B7j
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1000D9A9
		mov	eax, [ecx+8]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_100057C3
		mov	ecx, [esi]

loc_1000D9A9:				; CODE XREF: sub_1000D7BC+1D6j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_10009EBF

loc_1000D9C1:				; CODE XREF: sub_1000D7BC+112j
					; sub_1000D7BC+188j ...
		mov	byte ptr [edi+0Ch], 1

loc_1000D9C5:				; CODE XREF: sub_1000D7BC+103j
		push	0		; int
		lea	ecx, [ebx+10h]	; void *
		push	1		; char
		call	sub_100022C1
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [ebp+4]
		pop	ecx
		test	eax, eax
		jz	short loc_1000D9E3
		dec	eax
		mov	[ebp+4], eax

loc_1000D9E3:				; CODE XREF: sub_1000D7BC+221j
		mov	eax, [esp+10h+arg_0]
		mov	ecx, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ecx
		pop	ebx
		retn	8
sub_1000D7BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D9F4	proc near		; CODE XREF: sub_1000CE06+BEp
					; sub_1000E09A+11Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	[ebp+arg_4]
		mov	edi, ecx
		call	sub_1000D45B
		mov	esi, eax
		cmp	esi, [edi]
		jz	short loc_1000DA1E
		mov	ecx, [ebp+arg_4]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		js	short loc_1000DA1E
		mov	[ebp+arg_4], esi
		jmp	short loc_1000DA23
; ---------------------------------------------------------------------------

loc_1000DA1E:				; CODE XREF: sub_1000D9F4+13j
					; sub_1000D9F4+23j
		mov	eax, [edi]
		mov	[ebp+arg_4], eax

loc_1000DA23:				; CODE XREF: sub_1000D9F4+28j
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+arg_4]
		mov	ecx, [ecx]
		pop	edi
		pop	esi
		mov	[eax], ecx
		pop	ebp
		retn	8
sub_1000D9F4	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000DA33	proc near		; CODE XREF: sub_1000DFE3+1Cp

arg_4		= dword	ptr  8

		push	esi
		push	edi
		push	[esp+8+arg_4]
		mov	edi, ecx
		call	sub_10003B1C
		lea	esi, [edi+18h]
		and	dword ptr [esi], 0
		mov	ecx, esi
		and	dword ptr [esi+4], 0
		call	sub_1000D2ED
		mov	[esi], eax
		mov	eax, edi
		pop	edi
		pop	esi
		retn	0Ch
sub_1000DA33	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000DA5A	proc near		; CODE XREF: sub_1000E03C+39p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		call	sub_1000D317
		push	[ebp+arg_8]
		mov	esi, eax
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		lea	ecx, [esi+10h]
		mov	word ptr [esi+0Ch], 0
		push	ecx
		lea	ecx, [ebp+arg_8+3]
		call	sub_1000DFE3
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	0Ch
sub_1000DA5A	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000DA87(void *)
sub_1000DA87	proc near		; CODE XREF: sub_1000DBD7+1Dp

arg_0		= dword	ptr  4

		push	esi
		call	sub_1000D349
		mov	esi, eax
		lea	ecx, [esi+10h]
		mov	word ptr [esi+0Ch], 0
		test	ecx, ecx
		jz	short loc_1000DAA5
		push	[esp+4+arg_0]	; void *
		call	sub_10003AFA

loc_1000DAA5:				; CODE XREF: sub_1000DA87+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_1000DA87	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000DAAB(int, char,	int, int, void *)
sub_1000DAAB	proc near		; CODE XREF: sub_1000DCF5+1Bp
					; sub_1000DCF5+128p ...

var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 5555554h
		jb	short loc_1000DADB
		mov	esi, [ebp+arg_10]
		lea	ecx, [esi+10h]	; void *
		call	sub_1000CDB4
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	[esp+10h+var_10], offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000DADB:				; CODE XREF: sub_1000DAAB+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000DAFC
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000DB1B
; ---------------------------------------------------------------------------

loc_1000DAFC:				; CODE XREF: sub_1000DAAB+41j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000DB0E
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000DB1B
		mov	[ecx], edi
		jmp	short loc_1000DB1B
; ---------------------------------------------------------------------------

loc_1000DB0E:				; CODE XREF: sub_1000DAAB+55j
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000DB1B
		mov	[ecx+8], edi

loc_1000DB1B:				; CODE XREF: sub_1000DAAB+4Fj
					; sub_1000DAAB+5Dj ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_1000DBB8
; ---------------------------------------------------------------------------

loc_1000DB25:				; CODE XREF: sub_1000DAAB+111j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000DB69
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000DB6F
		cmp	esi, [eax+8]
		jnz	short loc_1000DB49
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_100057C3

loc_1000DB49:				; CODE XREF: sub_1000DAAB+92j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10009EBF
		jmp	short loc_1000DBB5
; ---------------------------------------------------------------------------

loc_1000DB69:				; CODE XREF: sub_1000DAAB+84j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000DB89

loc_1000DB6F:				; CODE XREF: sub_1000DAAB+8Dj
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000DBB5
; ---------------------------------------------------------------------------

loc_1000DB89:				; CODE XREF: sub_1000DAAB+C2j
		cmp	esi, [eax]
		jnz	short loc_1000DB97
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10009EBF

loc_1000DB97:				; CODE XREF: sub_1000DAAB+E0j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_100057C3

loc_1000DBB5:				; CODE XREF: sub_1000DAAB+BCj
					; sub_1000DAAB+DCj
		mov	eax, [esi+4]

loc_1000DBB8:				; CODE XREF: sub_1000DAAB+75j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000DB25
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_1000DAAB	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000DBD7(int, int, int, void *, int)
sub_1000DBD7	proc near		; CODE XREF: sub_1000DF21+77p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 6666665h
		jb	short loc_1000DBEE
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000DBEE:				; CODE XREF: sub_1000DBD7+Aj
		push	ebx
		push	esi
		push	[esp+0Ch+arg_C]	; void *
		call	sub_1000DA87
		inc	dword ptr [edi+4]
		mov	ebx, eax
		mov	eax, [esp+0Ch+arg_8]
		mov	[ebx+4], eax
		mov	ecx, [edi]
		cmp	eax, ecx
		jnz	short loc_1000DC19
		mov	[ecx+4], ebx
		mov	eax, [edi]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	[eax+8], ebx
		jmp	short loc_1000DC39
; ---------------------------------------------------------------------------

loc_1000DC19:				; CODE XREF: sub_1000DBD7+32j
		cmp	byte ptr [esp+0Ch+arg_4], 0
		jz	short loc_1000DC2C
		mov	[eax], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx]
		jnz	short loc_1000DC39
		mov	[ecx], ebx
		jmp	short loc_1000DC39
; ---------------------------------------------------------------------------

loc_1000DC2C:				; CODE XREF: sub_1000DBD7+47j
		mov	[eax+8], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx+8]
		jnz	short loc_1000DC39
		mov	[ecx+8], ebx

loc_1000DC39:				; CODE XREF: sub_1000DBD7+40j
					; sub_1000DBD7+4Fj ...
		mov	eax, [ebx+4]
		mov	esi, ebx
		jmp	loc_1000DCD6
; ---------------------------------------------------------------------------

loc_1000DC43:				; CODE XREF: sub_1000DBD7+103j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000DC87
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000DC8D
		cmp	esi, [eax+8]
		jnz	short loc_1000DC67
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_100057C3

loc_1000DC67:				; CODE XREF: sub_1000DBD7+84j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10009EBF
		jmp	short loc_1000DCD3
; ---------------------------------------------------------------------------

loc_1000DC87:				; CODE XREF: sub_1000DBD7+76j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000DCA7

loc_1000DC8D:				; CODE XREF: sub_1000DBD7+7Fj
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000DCD3
; ---------------------------------------------------------------------------

loc_1000DCA7:				; CODE XREF: sub_1000DBD7+B4j
		cmp	esi, [eax]
		jnz	short loc_1000DCB5
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10009EBF

loc_1000DCB5:				; CODE XREF: sub_1000DBD7+D2j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_100057C3

loc_1000DCD3:				; CODE XREF: sub_1000DBD7+AEj
					; sub_1000DBD7+CEj
		mov	eax, [esi+4]

loc_1000DCD6:				; CODE XREF: sub_1000DBD7+67j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000DC43
		mov	eax, [edi]
		pop	esi
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esp+8+arg_0]
		mov	[eax], ebx
		pop	ebx
		pop	edi
		retn	14h
sub_1000DBD7	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000DCF5(int, int, int, void *)
sub_1000DCF5	proc near		; CODE XREF: sub_1000E03C+4Ap

var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		cmp	dword ptr [ebx+4], 0
		jnz	short loc_1000DD1E
		push	[esp+0Ch+arg_C]	; void *
		push	[esp+10h+arg_8]	; int
		push	dword ptr [ebx]	; int
		push	1		; char
		push	[esp+1Ch+arg_0]	; int
		call	sub_1000DAAB
		mov	eax, [esp+0Ch+arg_0]
		jmp	loc_1000DE46
; ---------------------------------------------------------------------------

loc_1000DD1E:				; CODE XREF: sub_1000DCF5+9j
		mov	ecx, [ebx]
		mov	eax, [esp+0Ch+arg_4]
		push	ebp
		mov	ebp, [esp+10h+arg_8]
		push	esi
		push	edi
		cmp	eax, [ecx]
		jnz	short loc_1000DD52
		add	eax, 10h
		mov	ecx, ebp
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		jns	loc_1000DE28
		push	[esp+18h+arg_C]
		mov	ecx, ebx
		push	ebp
		push	[esp+20h+arg_4]
		jmp	loc_1000DE17
; ---------------------------------------------------------------------------

loc_1000DD52:				; CODE XREF: sub_1000DCF5+38j
		cmp	eax, ecx
		jnz	short loc_1000DD7D
		mov	ecx, [ecx+8]
		add	ecx, 10h
		push	ebp
		call	sub_1000D4CC
		test	eax, eax
		jns	loc_1000DE28
		push	[esp+18h+arg_C]
		mov	eax, [ebx]
		mov	ecx, ebx
		push	ebp
		push	dword ptr [eax+8]
		push	0
		jmp	loc_1000DE19
; ---------------------------------------------------------------------------

loc_1000DD7D:				; CODE XREF: sub_1000DCF5+5Fj
		add	eax, 10h
		mov	ecx, ebp
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000DDC4
		mov	eax, [esp+18h+arg_4]
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], eax
		call	sub_1000911E
		mov	esi, [esp+18h+arg_8]
		push	ebp
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000DDC4
		mov	eax, [esi+8]
		mov	ecx, ebx
		push	[esp+18h+arg_C]
		push	ebp
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_1000DE11
		push	[esp+20h+arg_4]
		jmp	short loc_1000DE17
; ---------------------------------------------------------------------------

loc_1000DDC4:				; CODE XREF: sub_1000DCF5+95j
					; sub_1000DCF5+B7j
		mov	ecx, [esp+18h+arg_4]
		push	ebp
		lea	ecx, [ecx+10h]
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000DE28
		mov	esi, [esp+18h+arg_4]
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], esi
		call	sub_1000CDCC
		mov	edi, [esp+18h+arg_8]
		cmp	edi, [ebx]
		jz	short loc_1000DE01
		lea	eax, [edi+10h]
		mov	ecx, ebp
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000DE28
		mov	esi, [esp+18h+arg_4]

loc_1000DE01:				; CODE XREF: sub_1000DCF5+F7j
		mov	eax, [esi+8]
		mov	ecx, ebx
		push	[esp+18h+arg_C]	; void *
		push	ebp		; int
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_1000DE16

loc_1000DE11:				; CODE XREF: sub_1000DCF5+C7j
		push	esi
		push	0
		jmp	short loc_1000DE19
; ---------------------------------------------------------------------------

loc_1000DE16:				; CODE XREF: sub_1000DCF5+11Aj
		push	edi		; int

loc_1000DE17:				; CODE XREF: sub_1000DCF5+58j
					; sub_1000DCF5+CDj
		push	1		; char

loc_1000DE19:				; CODE XREF: sub_1000DCF5+83j
					; sub_1000DCF5+11Fj
		push	[esp+28h+arg_0]	; int
		call	sub_1000DAAB
		mov	eax, [esp+18h+arg_0]
		jmp	short loc_1000DE43
; ---------------------------------------------------------------------------

loc_1000DE28:				; CODE XREF: sub_1000DCF5+47j
					; sub_1000DCF5+6Fj ...
		push	[esp+18h+arg_C]	; void *
		lea	eax, [esp+1Ch+var_8]
		mov	ecx, ebx
		push	ebp		; int
		push	0		; int
		push	eax		; int
		call	sub_1000DE4C
		mov	ecx, [eax]
		mov	eax, [esp+18h+arg_0]
		mov	[eax], ecx

loc_1000DE43:				; CODE XREF: sub_1000DCF5+131j
		pop	edi
		pop	esi
		pop	ebp

loc_1000DE46:				; CODE XREF: sub_1000DCF5+24j
		pop	ebx
		pop	ecx
		pop	ecx
		retn	10h
sub_1000DCF5	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000DE4C(int, int, int, void *)
sub_1000DE4C	proc near		; CODE XREF: sub_1000DCF5+141p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	al, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], al
		push	esi
		push	edi
		mov	edi, [ebp+0]
		mov	esi, [edi+4]
		jmp	short loc_1000DE9D
; ---------------------------------------------------------------------------

loc_1000DE65:				; CODE XREF: sub_1000DE4C+55j
		cmp	byte ptr [esp+14h+arg_4], 0
		mov	edi, esi
		jz	short loc_1000DE7E
		push	ebx
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		setns	al
		jmp	short loc_1000DE8E
; ---------------------------------------------------------------------------

loc_1000DE7E:				; CODE XREF: sub_1000DE4C+20j
		lea	eax, [esi+10h]
		mov	ecx, ebx
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		sets	al

loc_1000DE8E:				; CODE XREF: sub_1000DE4C+30j
		mov	byte ptr [esp+14h+var_4], al
		test	al, al
		jz	short loc_1000DE9A
		mov	esi, [esi]
		jmp	short loc_1000DE9D
; ---------------------------------------------------------------------------

loc_1000DE9A:				; CODE XREF: sub_1000DE4C+48j
		mov	esi, [esi+8]

loc_1000DE9D:				; CODE XREF: sub_1000DE4C+17j
					; sub_1000DE4C+4Cj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000DE65
		mov	esi, edi
		mov	[esp+14h+arg_4], esi
		test	al, al
		jz	short loc_1000DEE3
		mov	eax, [ebp+0]
		cmp	edi, [eax]
		jnz	short loc_1000DED6
		push	[esp+14h+arg_C]	; void *
		push	ebx		; int
		push	edi		; int
		push	1		; char

loc_1000DEBC:				; CODE XREF: sub_1000DE4C+AEj
		lea	eax, [esp+24h+arg_4]
		mov	ecx, ebp
		push	eax		; int
		call	sub_1000DAAB
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000DF19
; ---------------------------------------------------------------------------

loc_1000DED6:				; CODE XREF: sub_1000DE4C+66j
		lea	ecx, [esp+14h+arg_4]
		call	sub_1000911E
		mov	esi, [esp+14h+arg_4]

loc_1000DEE3:				; CODE XREF: sub_1000DE4C+5Fj
		push	ebx
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000DEFC
		push	[esp+14h+arg_C]
		push	ebx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_1000DEBC
; ---------------------------------------------------------------------------

loc_1000DEFC:				; CODE XREF: sub_1000DE4C+A2j
		mov	edi, [esp+14h+arg_C]
		lea	ecx, [edi+10h]	; void *
		call	sub_1000CDB4
		push	edi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000DF19:				; CODE XREF: sub_1000DE4C+88j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1000DE4C	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000DF21(int, int, void *, int)
sub_1000DF21	proc near		; CODE XREF: sub_1000E258+F0p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	al, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], al
		push	esi
		push	edi
		mov	edi, [ebp+0]
		mov	esi, [edi+4]
		jmp	short loc_1000DF72
; ---------------------------------------------------------------------------

loc_1000DF3A:				; CODE XREF: sub_1000DF21+55j
		cmp	byte ptr [esp+14h+arg_4], 0
		mov	edi, esi
		jz	short loc_1000DF53
		push	ebx
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		setns	al
		jmp	short loc_1000DF63
; ---------------------------------------------------------------------------

loc_1000DF53:				; CODE XREF: sub_1000DF21+20j
		lea	eax, [esi+10h]
		mov	ecx, ebx
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		sets	al

loc_1000DF63:				; CODE XREF: sub_1000DF21+30j
		mov	byte ptr [esp+14h+var_4], al
		test	al, al
		jz	short loc_1000DF6F
		mov	esi, [esi]
		jmp	short loc_1000DF72
; ---------------------------------------------------------------------------

loc_1000DF6F:				; CODE XREF: sub_1000DF21+48j
		mov	esi, [esi+8]

loc_1000DF72:				; CODE XREF: sub_1000DF21+17j
					; sub_1000DF21+4Cj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000DF3A
		mov	esi, edi
		mov	[esp+14h+arg_4], esi
		test	al, al
		jz	short loc_1000DFB8
		mov	eax, [ebp+0]
		cmp	edi, [eax]
		jnz	short loc_1000DFAB
		push	[esp+14h+arg_C]	; int
		push	ebx		; void *
		push	edi		; int
		push	1		; int

loc_1000DF91:				; CODE XREF: sub_1000DF21+AEj
		lea	eax, [esp+24h+arg_4]
		mov	ecx, ebp
		push	eax		; int
		call	sub_1000DBD7
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000DFDB
; ---------------------------------------------------------------------------

loc_1000DFAB:				; CODE XREF: sub_1000DF21+66j
		lea	ecx, [esp+14h+arg_4]
		call	sub_1000911E
		mov	esi, [esp+14h+arg_4]

loc_1000DFB8:				; CODE XREF: sub_1000DF21+5Fj
		push	ebx
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000DFD1
		push	[esp+14h+arg_C]
		push	ebx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_1000DF91
; ---------------------------------------------------------------------------

loc_1000DFD1:				; CODE XREF: sub_1000DF21+A2j
		mov	eax, [esp+14h+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000DFDB:				; CODE XREF: sub_1000DF21+88j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1000DF21	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000DFE3	proc near		; CODE XREF: sub_1000DA5A+21p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		test	ecx, ecx
		jz	short loc_1000E004
		mov	eax, [ebp+arg_8]
		push	ecx
		push	ecx
		mov	edx, esp
		mov	eax, [eax]
		mov	[edx], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		push	eax
		call	sub_1000DA33

loc_1000E004:				; CODE XREF: sub_1000DFE3+8j
		pop	ebp
		retn	10h
sub_1000DFE3	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000E008(size_t)
sub_1000E008	proc near		; CODE XREF: sub_1000E09A+41p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, ecx
		xor	ebx, ebx
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		push	edi
		mov	[esi], ebx
		mov	[esi+4], ebx
		mov	[esi+8], ebx
		call	sub_1000E499
		test	al, al
		jz	short loc_1000E034
		push	edi		; size_t
		push	ebx		; int
		push	dword ptr [esi]	; void *
		call	memset
		add	esp, 0Ch
		add	[esi+4], edi

loc_1000E034:				; CODE XREF: sub_1000E008+1Bj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn	4
sub_1000E008	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E03C	proc near		; CODE XREF: sub_1000E258+97p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		push	ebx
		mov	edi, ecx
		call	sub_1000D45B
		mov	esi, eax
		cmp	esi, [edi]
		jz	short loc_1000E063
		lea	eax, [esi+10h]
		mov	ecx, ebx
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000E08E

loc_1000E063:				; CODE XREF: sub_1000E03C+16j
		lea	eax, [ebp+arg_0+3]
		mov	[ebp+var_4], ebx
		push	eax
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		push	offset byte_10033C57
		call	sub_1000DA5A
		push	eax		; void *
		add	eax, 10h
		mov	ecx, edi
		push	eax		; int
		push	esi		; int
		lea	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_1000DCF5
		mov	esi, [ebp+arg_0]

loc_1000E08E:				; CODE XREF: sub_1000E03C+25j
		pop	edi
		lea	eax, [esi+28h]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000E03C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E09A	proc near		; CODE XREF: sub_10019991+2Cp

var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_38		= dword	ptr -38h
var_34		= word ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		sub	esp, 50h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+50h+var_4], eax
		or	[esp+50h+var_50], 0FFFFFFFFh
		lea	eax, [esp+50h+var_50]
		push	ebp
		mov	ebp, ecx
		push	eax		; pdwHandleCount
		mov	[esp+58h+var_48], ebp
		call	ds:GetCurrentProcess
		push	eax		; hProcess
		call	ds:GetProcessHandleCount
		test	eax, eax
		jnz	short loc_1000E0CF
		xor	al, al
		jmp	loc_1000E241
; ---------------------------------------------------------------------------

loc_1000E0CF:				; CODE XREF: sub_1000E09A+2Cj
		push	ebx
		push	esi
		push	edi
		push	0A0h		; size_t
		lea	ecx, [esp+64h+var_44]
		call	sub_1000E008
		and	[esp+60h+var_24], 0
		xor	eax, eax
		xor	esi, esi
		mov	[esp+60h+var_20], 7
		xor	ebx, ebx
		mov	[esp+60h+var_34], ax
		cmp	[esp+60h+var_50], eax
		jz	loc_1000E224
		mov	edi, [esp+60h+var_44]

loc_1000E106:				; CODE XREF: sub_1000E09A+184j
		cmp	ebx, 64h
		jge	loc_1000E224
		mov	eax, [esp+60h+var_40]
		add	esi, 4
		sub	eax, edi
		mov	[esp+60h+var_4C], eax
		lea	eax, [esp+60h+var_4C]
		push	eax
		push	edi
		push	esi
		call	sub_1000E42B
		add	esp, 0Ch
		mov	ecx, eax

loc_1000E12D:				; CODE XREF: sub_1000E09A+CBj
					; sub_1000E09A+D7j ...
		cmp	ecx, 0C0000004h
		jz	short loc_1000E13D
		cmp	ecx, 80000005h
		jnz	short loc_1000E17A

loc_1000E13D:				; CODE XREF: sub_1000E09A+99j
		mov	eax, [esp+60h+var_4C]
		lea	ecx, [esp+60h+var_44]
		add	eax, 2
		push	eax
		call	sub_1000E5A5
		mov	edi, [esp+60h+var_44]
		lea	eax, [esp+60h+var_4C]
		push	eax
		push	edi
		push	esi
		call	sub_1000E42B
		mov	ecx, eax
		add	esp, 0Ch
		test	ecx, ecx
		js	short loc_1000E12D
		mov	eax, [esp+60h+var_40]
		sub	eax, edi
		cmp	[esp+60h+var_4C], eax
		jnz	short loc_1000E12D
		mov	ecx, 0C0000004h
		jmp	short loc_1000E12D
; ---------------------------------------------------------------------------

loc_1000E17A:				; CODE XREF: sub_1000E09A+A1j
		test	ecx, ecx
		js	loc_1000E251
		cmp	dword ptr [edi+4], 0
		jz	loc_1000E251
		dec	[esp+60h+var_50]
		xor	edx, edx
		movzx	ecx, word ptr [edi]
		mov	eax, [edi+4]
		shr	ecx, 1
		mov	[eax+ecx*2], dx
		lea	ecx, [esp+60h+var_1C]
		push	dword ptr [edi+4] ; void *
		call	sub_10001E8D
		lea	eax, [esp+60h+var_1C]
		mov	ecx, ebp
		push	eax
		lea	eax, [esp+64h+var_38]
		push	eax
		call	sub_1000D9F4
		push	0		; int
		push	1		; char
		lea	ecx, [esp+68h+var_1C] ;	void *
		call	sub_100022C1
		mov	eax, [esp+60h+var_38]
		cmp	eax, [ebp+0]
		jz	short loc_1000E219
		lea	ebp, [eax+28h]
		cmp	dword ptr [ebp+4], 0
		jz	short loc_1000E1FB
		lea	eax, [esp+60h+var_34]
		push	eax
		push	esi
		call	sub_1000D022
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_1000E215
		lea	eax, [esp+60h+var_34]
		mov	ecx, ebp
		push	eax
		call	sub_1000E572
		test	eax, eax
		jz	short loc_1000E215

loc_1000E1FB:				; CODE XREF: sub_1000E09A+13Ej
		push	0		; dwFlags
		push	2		; dwMask
		push	esi		; hObject
		call	ds:SetHandleInformation
		test	eax, eax
		jz	short loc_1000E254
		push	esi		; hObject
		call	ds:CloseHandle
		test	eax, eax
		jz	short loc_1000E254

loc_1000E215:				; CODE XREF: sub_1000E09A+14Fj
					; sub_1000E09A+15Fj
		mov	ebp, [esp+60h+var_48]

loc_1000E219:				; CODE XREF: sub_1000E09A+135j
					; sub_1000E09A+1B8j
		cmp	[esp+60h+var_50], 0
		jnz	loc_1000E106

loc_1000E224:				; CODE XREF: sub_1000E09A+62j
					; sub_1000E09A+6Fj
		mov	bl, 1

loc_1000E226:				; CODE XREF: sub_1000E09A+1BCj
		push	0		; int
		push	1		; char
		lea	ecx, [esp+68h+var_34] ;	void *
		call	sub_100022C1
		lea	ecx, [esp+60h+var_44]
		call	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime
		pop	edi
		pop	esi
		mov	al, bl
		pop	ebx

loc_1000E241:				; CODE XREF: sub_1000E09A+30j
		mov	ecx, [esp+54h+var_4]
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 50h
		retn
; ---------------------------------------------------------------------------

loc_1000E251:				; CODE XREF: sub_1000E09A+E2j
					; sub_1000E09A+ECj
		inc	ebx
		jmp	short loc_1000E219
; ---------------------------------------------------------------------------

loc_1000E254:				; CODE XREF: sub_1000E09A+16Ej
					; sub_1000E09A+179j
		xor	bl, bl
		jmp	short loc_1000E226
sub_1000E09A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E258	proc near		; CODE XREF: sub_10019991+24p

var_FC		= dword	ptr -0FCh
var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= byte ptr -0E8h
var_E4		= byte ptr -0E4h
var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		sub	esp, 0FCh
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0FCh+var_4], eax
		mov	eax, g_handles_to_close
		push	ebx
		push	ebp
		xor	ebx, ebx
		mov	ebp, ecx
		mov	[esp+104h+var_F4], ebp
		mov	[esp+104h+var_F8], ebx
		push	esi
		push	edi
		test	eax, eax
		jnz	short loc_1000E2AD
		push	3
		push	2Eh
		push	offset aCBuildsMoz2__3 ; "c:/builds/moz2_slave/tb-rel-c-esr38-w32"...
		lea	ecx, [esp+118h+var_E4]
		inc	ebx
		call	sub_10001EE3
		add	eax, 8
		push	offset aCheckFailedG_h ; "Check	failed:	g_handles_to_close != NUL"...
		push	eax
		call	sub_10001C6D
		mov	eax, g_handles_to_close
		pop	ecx
		pop	ecx

loc_1000E2AD:				; CODE XREF: sub_1000E258+2Bj
		test	bl, 1
		jz	short loc_1000E2C3
		lea	ecx, [esp+10Ch+var_E4]
		and	ebx, 0FFFFFFFEh
		call	sub_10002021
		mov	eax, g_handles_to_close

loc_1000E2C3:				; CODE XREF: sub_1000E258+58j
		xor	edi, edi
		lea	esi, [eax+8]
		mov	[esp+10Ch+var_FC], edi
		cmp	[eax+4], edi
		jbe	loc_1000E3F1

loc_1000E2D5:				; CODE XREF: sub_1000E258+193j
		lea	eax, [esi+0Ch]
		push	eax		; void *
		lea	ecx, [esp+110h+var_34]
		call	sub_10001E8D
		lea	eax, [esp+10Ch+var_34]
		mov	ecx, ebp
		push	eax
		call	sub_1000E03C
		push	0		; int
		push	1		; char
		lea	ecx, [esp+114h+var_34] ; void *
		mov	[esp+114h+var_F8], eax
		call	sub_100022C1
		mov	ebp, [esi+4]
		and	[esp+10Ch+var_F0], 0
		add	ebp, esi
		cmp	dword ptr [esi+8], 0
		jbe	loc_1000E3B6
		mov	edi, [esp+10Ch+var_F0]

loc_1000E320:				; CODE XREF: sub_1000E258+154j
		push	ebp		; void *
		lea	ecx, [esp+110h+var_1C]
		call	sub_10001E8D
		movzx	eax, byte_10033C58
		mov	ecx, [esp+10Ch+var_F8]
		push	eax		; int
		lea	eax, [esp+110h+var_1C]
		push	eax		; void *
		push	0		; int
		lea	eax, [esp+118h+var_EC]
		push	eax		; int
		call	sub_1000DF21
		push	0		; int
		push	1		; char
		lea	ecx, [esp+114h+var_1C] ; void *
		call	sub_100022C1
		cmp	[esp+10Ch+var_E8], 0
		jnz	short loc_1000E389
		push	3
		push	3Ch
		push	offset aCBuildsMoz2__3 ; "c:/builds/moz2_slave/tb-rel-c-esr38-w32"...
		lea	ecx, [esp+118h+var_E4]
		or	ebx, 2
		call	sub_10001EE3
		add	eax, 8
		push	offset aCheckFailedNam ; "Check	failed:	name.second. "
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx

loc_1000E389:				; CODE XREF: sub_1000E258+10Aj
		test	bl, 2
		jz	short loc_1000E39A
		lea	ecx, [esp+10Ch+var_E4]
		and	ebx, 0FFFFFFFDh
		call	sub_10002021

loc_1000E39A:				; CODE XREF: sub_1000E258+134j
		mov	eax, [esp+10Ch+var_EC]
		mov	eax, [eax+20h]
		lea	ebp, [ebp+eax*2+0]
		add	ebp, 2
		inc	edi
		cmp	edi, [esi+8]
		jb	loc_1000E320
		mov	edi, [esp+10Ch+var_FC]

loc_1000E3B6:				; CODE XREF: sub_1000E258+BEj
		add	esi, [esi]
		test	bl, 4
		jz	short loc_1000E3C9
		lea	ecx, [esp+10Ch+var_E4]
		and	ebx, 0FFFFFFFBh
		call	sub_10002021

loc_1000E3C9:				; CODE XREF: sub_1000E258+163j
		test	bl, 8
		jz	short loc_1000E3DA
		lea	ecx, [esp+10Ch+var_E4]
		and	ebx, 0FFFFFFF7h
		call	sub_10002021

loc_1000E3DA:				; CODE XREF: sub_1000E258+174j
		mov	eax, g_handles_to_close
		inc	edi
		mov	ebp, [esp+10Ch+var_F4]
		mov	[esp+10Ch+var_FC], edi
		cmp	edi, [eax+4]
		jb	loc_1000E2D5

loc_1000E3F1:				; CODE XREF: sub_1000E258+77j
		push	8000h		; dwFreeType
		push	0		; dwSize
		push	eax		; lpAddress
		call	ds:VirtualFree
		mov	ecx, [esp+10Ch+var_4]
		and	g_handles_to_close, 0
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0FCh
		retn
sub_1000E258	endp

; [0000000C BYTES: COLLAPSED FUNCTION __uncaught_exception(void)]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E42B	proc near		; CODE XREF: sub_1000E09A+89p
					; sub_1000E09A+BFp

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	0Ch
		push	offset stru_100301C8
		call	__SEH_prolog4
		mov	ecx, dword_10033C5C
		test	ecx, ecx
		jnz	short loc_1000E458
		push	offset dword_10033C5C ;	int
		push	offset aNtqueryobject ;	"NtQueryObject"
		call	sub_1001A242
		pop	ecx
		pop	ecx
		mov	ecx, dword_10033C5C

loc_1000E458:				; CODE XREF: sub_1000E42B+14j
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	eax, [ebp+arg_8]
		push	eax
		push	dword ptr [eax]
		push	[ebp+arg_4]
		push	2
		push	[ebp+arg_0]
		call	ecx ; dword_10033C5C
		jmp	short loc_1000E489
; ---------------------------------------------------------------------------

loc_1000E46E:				; DATA XREF: .rdata:stru_100301C8o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 1000E42B
		mov	eax, [eax]
		xor	ecx, ecx
		cmp	dword ptr [eax], 0C0000008h
		setz	cl
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_1000E481:				; DATA XREF: .rdata:stru_100301C8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000E42B
		mov	eax, 0C0000008h

loc_1000E489:				; CODE XREF: sub_1000E42B+41j
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	__SEH_epilog4
		retn
sub_1000E42B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E499	proc near		; CODE XREF: sub_1000E008+14p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		test	edi, edi
		jnz	short loc_1000E4B3
		xor	al, al
		jmp	short loc_1000E4D8
; ---------------------------------------------------------------------------

loc_1000E4B3:				; CODE XREF: sub_1000E499+14j
		cmp	edi, 0FFFFFFFFh
		jbe	short loc_1000E4C3
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000E4C3:				; CODE XREF: sub_1000E499+1Dj
		push	eax
		push	edi
		call	sub_10001050
		mov	[esi], eax
		mov	[esi+4], eax
		add	eax, edi
		pop	ecx
		mov	[esi+8], eax
		mov	al, 1
		pop	ecx

loc_1000E4D8:				; CODE XREF: sub_1000E499+18j
		pop	edi
		pop	esi
		retn	4
sub_1000E499	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E4DD	proc near		; CODE XREF: sub_1000E572+Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		mov	eax, ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, [eax]
		mov	edi, ebx
		mov	[esp+10h+var_4], eax
		mov	esi, [ebx+4]
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_1000E531
		push	ebp

loc_1000E4F5:				; CODE XREF: sub_1000E4DD+4Dj
		push	[esp+14h+arg_4]
		lea	ebp, [esi+10h]
		mov	ecx, ebp
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000E50C
		mov	esi, [esi+8]
		jmp	short loc_1000E526
; ---------------------------------------------------------------------------

loc_1000E50C:				; CODE XREF: sub_1000E4DD+28j
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000E522
		mov	ecx, [esp+14h+arg_4]
		push	ebp
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000E522
		mov	edi, esi

loc_1000E522:				; CODE XREF: sub_1000E4DD+33j
					; sub_1000E4DD+41j
		mov	ebx, esi
		mov	esi, [esi]

loc_1000E526:				; CODE XREF: sub_1000E4DD+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000E4F5
		mov	eax, [esp+14h+var_4]
		pop	ebp

loc_1000E531:				; CODE XREF: sub_1000E4DD+15j
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000E53E
		mov	eax, [eax]
		mov	esi, [eax+4]
		jmp	short loc_1000E55C
; ---------------------------------------------------------------------------

loc_1000E53E:				; CODE XREF: sub_1000E4DD+58j
		mov	esi, [edi]
		jmp	short loc_1000E55C
; ---------------------------------------------------------------------------

loc_1000E542:				; CODE XREF: sub_1000E4DD+83j
		mov	ecx, [esp+10h+arg_4]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000D4CC
		test	eax, eax
		jns	short loc_1000E559
		mov	edi, esi
		mov	esi, [esi]
		jmp	short loc_1000E55C
; ---------------------------------------------------------------------------

loc_1000E559:				; CODE XREF: sub_1000E4DD+74j
		mov	esi, [esi+8]

loc_1000E55C:				; CODE XREF: sub_1000E4DD+5Fj
					; sub_1000E4DD+63j ...
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000E542
		mov	eax, [esp+10h+arg_0]
		mov	[eax+4], edi
		pop	edi
		pop	esi
		mov	[eax], ebx
		pop	ebx
		pop	ecx
		retn	8
sub_1000E4DD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E572	proc near		; CODE XREF: sub_1000E09A+158p
					; sub_1000EDF7+41p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	[ebp+arg_0]
		lea	eax, [ebp+var_8]
		push	eax
		call	sub_1000E4DD
		and	[ebp+arg_0], 0
		lea	eax, [ebp+arg_0]
		push	[ebp+arg_0]
		push	eax
		push	[ebp+var_4]
		push	[ebp+var_8]
		call	sub_10008849
		mov	eax, [ebp+arg_0]
		add	esp, 10h
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000E572	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E5A5	proc near		; CODE XREF: sub_1000E09A+AFp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+4]
		mov	eax, [esi]
		sub	ecx, eax
		cmp	ecx, edi
		ja	short loc_1000E5DE
		jnb	short loc_1000E5E3
		sub	eax, [esi+4]
		mov	ecx, esi
		add	eax, edi
		push	eax
		call	sub_1000373B
		mov	eax, [esi]
		sub	eax, [esi+4]
		add	eax, edi
		push	eax		; size_t
		push	0		; int
		push	dword ptr [esi+4] ; void *
		call	memset
		mov	eax, [esi]
		add	esp, 0Ch

loc_1000E5DE:				; CODE XREF: sub_1000E5A5+11j
		add	eax, edi
		mov	[esi+4], eax

loc_1000E5E3:				; CODE XREF: sub_1000E5A5+13j
		pop	edi
		pop	esi
		retn	4
sub_1000E5A5	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E5E8	proc near		; CODE XREF: sub_10016099+1A5p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	offset dword_1001D41C
		lea	ecx, [esi+4]
		mov	[ecx], eax
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		mov	eax, [esp+8+arg_0]
		mov	dword ptr [esi], offset	off_1001D410
		mov	[esi+10h], eax
		call	sub_1000ADE8
		mov	eax, esi
		pop	esi
		retn	4
sub_1000E5E8	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000E615(int, HANDLE hSourceHandle,	int, int, int)
sub_1000E615	proc near		; DATA XREF: .rdata:1001D444o

var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
TargetHandle	= dword	ptr -0BCh
var_B8		= byte ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= word ptr -0A4h
var_A0		= dword	ptr -0A0h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
hSourceHandle	= dword	ptr  8
dwProcessId	= dword	ptr  0Ch
dwDesiredAccess	= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 0C8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0C8h+var_4], eax
		cmp	dword_10033C64,	0
		push	ebx
		push	ebp
		mov	ebp, [esp+0D0h+hSourceHandle]
		push	esi
		mov	esi, [esp+0D4h+arg_0]
		push	edi
		mov	[esp+0D8h+var_C0], ecx
		jnz	short loc_1000E659
		push	offset dword_10033C64 ;	int
		push	offset aNtqueryobject ;	"NtQueryObject"
		call	sub_1001A242
		pop	ecx
		pop	ecx

loc_1000E659:				; CODE XREF: sub_1000E615+31j
		mov	edi, [esp+0D8h+arg_10]
		xor	ebx, ebx
		mov	eax, edi
		or	eax, 2
		push	eax		; dwOptions
		push	ebx		; bInheritHandle
		push	ebx		; dwDesiredAccess
		lea	eax, [esp+0E4h+TargetHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [esi+4]
		push	ebp		; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_1000E696
		call	ds:GetLastError
		mov	[esi+10h], eax
		xor	al, al
		jmp	loc_1000E74B
; ---------------------------------------------------------------------------

loc_1000E696:				; CODE XREF: sub_1000E615+6Fj
		push	[esp+0D8h+TargetHandle]
		lea	ecx, [esp+0DCh+var_C8]
		mov	[esp+0DCh+var_C8], ebx
		call	sub_10004DE8
		lea	eax, [esp+0D8h+var_C4]
		mov	ecx, 9Eh
		push	eax
		push	ecx
		lea	eax, [esp+0E0h+var_A4]
		mov	[esp+0E0h+var_C4], ecx
		push	eax
		push	2
		pop	ebp
		push	ebp
		push	[esp+0E8h+var_C8]
		call	dword_10033C64
		test	eax, eax
		js	short loc_1000E73D
		movzx	ecx, [esp+0D8h+var_A4]
		xor	edx, edx
		mov	eax, [esp+0D8h+var_A0]
		shr	ecx, 1
		mov	[eax+ecx*2], dx
		lea	ecx, [esp+0D8h+var_B8]
		call	sub_10018707
		mov	ecx, [esp+0D8h+var_C0]
		lea	eax, [esp+0D8h+var_A0]
		mov	[esp+0D8h+var_B0], eax
		xor	ebx, ebx
		lea	eax, [esp+0D8h+dwProcessId]
		mov	[esp+0D8h+var_AC], ebp
		mov	[esp+0D8h+var_A8], eax
		inc	ebx
		mov	ecx, [ecx+10h]
		lea	eax, [esp+0D8h+var_B8]
		push	eax
		push	12h
		mov	[esp+0E0h+var_B4], ebx
		call	sub_100168E1
		and	edi, 0FFFFFFFEh
		mov	ecx, eax
		push	edi		; dwOptions
		push	[esp+0DCh+dwDesiredAccess] ; dwDesiredAccess
		lea	eax, [esi+18h]
		push	eax		; lpTargetHandle
		push	[esp+0E4h+dwProcessId] ; dwProcessId
		push	[esp+0E8h+var_C8] ; hSourceHandle
		push	ecx		; hTargetProcessHandle
		call	sub_1000E983
		add	esp, 18h

loc_1000E73D:				; CODE XREF: sub_1000E615+B6j
		lea	ecx, [esp+0D8h+var_C8]
		mov	[esi+10h], eax
		call	sub_10004DA3
		mov	al, bl

loc_1000E74B:				; CODE XREF: sub_1000E615+7Cj
		mov	ecx, [esp+0D8h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C8h
		retn	14h
sub_1000E615	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E766	proc near		; DATA XREF: .rdata:1001D414o

arg_4		= dword	ptr  8

		cmp	[esp+arg_4], 12h
		setz	al
		retn	8
sub_1000E766	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000E771(int,	int, int, void *, void *, void *, int)
sub_1000E771	proc near		; CODE XREF: sub_1000E8D1+5Fp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	ecx, [ebp+arg_0]
		push	esi
		call	sub_1001768F
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000E78C
		push	4
		pop	eax
		jmp	loc_1000E81C
; ---------------------------------------------------------------------------

loc_1000E78C:				; CODE XREF: sub_1000E771+11j
		mov	eax, [ebp+arg_4]
		lea	ecx, [ebp+var_4]
		push	ebx
		push	edi
		push	4
		pop	edi
		push	edi		; int
		xor	ebx, ebx
		mov	[esi], eax
		mov	eax, [ebp+arg_8]
		push	ebx		; char
		push	edi		; size_t
		mov	[esi+4], ebx
		mov	[esi+3Ch], edi
		push	ecx		; void *
		mov	dword ptr [esi+44h], 7Ch
		mov	ecx, esi
		mov	eax, [eax]
		push	ebx		; int
		mov	[ebp+var_4], eax
		call	sub_1000E821
		test	al, al
		jz	short loc_1000E818
		push	2		; int
		push	ebx		; char
		push	edi		; size_t
		push	[ebp+arg_C]	; void *
		mov	ecx, esi
		push	1		; int
		call	sub_1000E821
		test	al, al
		jz	short loc_1000E818
		push	2		; int
		push	ebx		; char
		push	edi		; size_t
		push	[ebp+arg_10]	; void *
		mov	ecx, esi
		push	2		; int
		call	sub_1000E821
		test	al, al
		jz	short loc_1000E818
		push	2		; int
		push	ebx		; char
		push	edi		; size_t
		push	[ebp+arg_14]	; void *
		mov	ecx, esi
		push	3		; int
		call	sub_1000E821
		test	al, al
		jz	short loc_1000E818
		push	[ebp+arg_18]
		mov	ecx, [ebp+arg_0]
		push	esi
		call	sub_100175C5
		mov	edi, eax
		cmp	edi, 0Ah
		jz	short loc_1000E818
		mov	ecx, [ebp+arg_0]
		push	esi
		call	sub_10017671

loc_1000E818:				; CODE XREF: sub_1000E771+4Dj
					; sub_1000E771+61j ...
		mov	eax, edi
		pop	edi
		pop	ebx

loc_1000E81C:				; CODE XREF: sub_1000E771+16j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000E771	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000E821(int, void *, size_t, char,	int)
sub_1000E821	proc near		; CODE XREF: sub_1000E771+46p
					; sub_1000E771+5Ap ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_100301E8
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 4
		jnb	loc_1000E8C7
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000E8C7
		test	esi, esi
		jz	short loc_1000E851
		cmp	[ebp+arg_4], 0
		jz	short loc_1000E8C7

loc_1000E851:				; CODE XREF: sub_1000E821+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000E8C7
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000E8C7
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000E892
		mov	dword ptr [edi+4], 1

loc_1000E892:				; CODE XREF: sub_1000E821+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000E8C9
; ---------------------------------------------------------------------------

loc_1000E8B9:				; DATA XREF: .rdata:stru_100301E8o
		xor	eax, eax	; Exception filter 0 for function 1000E821
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000E8BD:				; DATA XREF: .rdata:stru_100301E8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000E821
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000E8C7:				; CODE XREF: sub_1000E821+14j
					; sub_1000E821+20j ...
		xor	al, al

loc_1000E8C9:				; CODE XREF: sub_1000E821+96j
		call	__SEH_epilog4
		retn	14h
sub_1000E821	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E8D1	proc near		; CODE XREF: sub_100199DD+12p

var_44		= dword	ptr -44h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
dwErrCode	= dword	ptr -30h
var_28		= dword	ptr -28h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= byte ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		xor	edi, edi
		mov	[ebp+var_3C], eax
		mov	[esi], edi
		call	sub_10015CC7
		test	eax, eax
		jnz	short loc_1000E8FE
		push	4
		pop	eax
		jmp	short loc_1000E973
; ---------------------------------------------------------------------------

loc_1000E8FE:				; CODE XREF: sub_1000E8D1+26j
		push	eax
		lea	ecx, [ebp+var_44]
		call	sub_100175A8
		push	30h		; size_t
		lea	eax, [ebp+var_34]
		mov	[ebp+var_38], edi
		push	edi		; int
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_38]
		push	eax		; int
		lea	eax, [ebp+arg_10]
		push	eax		; void *
		lea	eax, [ebp+arg_C]
		push	eax		; void *
		lea	eax, [ebp+arg_4]
		push	eax		; void *
		lea	eax, [ebp+var_3C]
		push	eax		; int
		lea	eax, [ebp+var_44]
		push	12h		; int
		push	eax		; int
		call	sub_1000E771
		add	esp, 28h
		test	eax, eax
		jnz	short loc_1000E973
		cmp	[ebp+dwErrCode], edi
		jz	short loc_1000E95F
		push	[ebp+dwErrCode]	; dwErrCode
		call	ds:SetLastError
		push	2
		push	edi
		push	offset aDuplicatehandl ; "DuplicateHandle"
		call	sub_10002C76
		xor	eax, eax
		add	esp, 0Ch
		inc	eax
		jmp	short loc_1000E973
; ---------------------------------------------------------------------------

loc_1000E95F:				; CODE XREF: sub_1000E8D1+6Ej
		mov	eax, [ebp+var_28]
		push	edi
		push	offset aDuplicatehandl ; "DuplicateHandle"
		mov	[esi], eax
		call	sub_10002B72
		pop	ecx
		pop	ecx
		xor	eax, eax

loc_1000E973:				; CODE XREF: sub_1000E8D1+2Bj
					; sub_1000E8D1+69j ...
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1000E8D1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000E983(HANDLE hTargetProcessHandle,	HANDLE hSourceHandle, DWORD dwProcessId, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, DWORD dwOptions)
sub_1000E983	proc near		; CODE XREF: sub_1000E615+120p

hTargetProcessHandle= dword ptr	 8
hSourceHandle	= dword	ptr  0Ch
dwProcessId	= dword	ptr  10h
lpTargetHandle	= dword	ptr  14h
dwDesiredAccess	= dword	ptr  18h
dwOptions	= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+hTargetProcessHandle], 3
		jz	short loc_1000E991
		push	5
		pop	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E991:				; CODE XREF: sub_1000E983+7j
		push	esi
		push	edi
		xor	edi, edi
		mov	[ebp+hTargetProcessHandle], edi
		call	ds:GetCurrentProcessId
		cmp	[ebp+dwProcessId], eax
		jz	short loc_1000E9E0
		push	[ebp+dwProcessId]
		call	sub_1000EAA8
		mov	ecx, eax
		call	sub_100094F0
		test	al, al
		jnz	short loc_1000E9BB
		push	5
		pop	edi
		jmp	short loc_1000EA1D
; ---------------------------------------------------------------------------

loc_1000E9BB:				; CODE XREF: sub_1000E983+31j
		push	[ebp+dwProcessId] ; dwProcessId
		push	edi		; bInheritHandle
		push	40h		; dwDesiredAccess
		call	ds:OpenProcess
		push	eax
		lea	ecx, [ebp+hTargetProcessHandle]
		call	sub_10004DE8
		mov	esi, [ebp+hTargetProcessHandle]
		push	esi
		call	sub_10004DD3
		pop	ecx
		test	al, al
		jnz	short loc_1000E9E3
		jmp	short loc_1000EA15
; ---------------------------------------------------------------------------

loc_1000E9E0:				; CODE XREF: sub_1000E983+1Ej
		mov	esi, [ebp+hTargetProcessHandle]

loc_1000E9E3:				; CODE XREF: sub_1000E983+59j
		push	esi
		call	sub_10004DD3
		pop	ecx
		test	al, al
		jnz	short loc_1000E9F6
		call	ds:GetCurrentProcess
		mov	esi, eax

loc_1000E9F6:				; CODE XREF: sub_1000E983+69j
		push	[ebp+dwOptions]	; dwOptions
		push	edi		; bInheritHandle
		push	[ebp+dwDesiredAccess] ;	dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		push	esi		; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_1000EA1D

loc_1000EA15:				; CODE XREF: sub_1000E983+5Bj
		call	ds:GetLastError
		mov	edi, eax

loc_1000EA1D:				; CODE XREF: sub_1000E983+36j
					; sub_1000E983+90j
		lea	ecx, [ebp+hTargetProcessHandle]
		call	sub_10004DA3
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_1000E983	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EA2B	proc near		; CODE XREF: sub_1001651A+8Dp

var_10		= byte ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		lea	ecx, [ebp+var_10]
		push	ebx
		push	3
		call	sub_10011053
		mov	eax, [ebp+arg_4]
		sub	eax, 4
		jz	short loc_1000EA57
		dec	eax
		jnz	short loc_1000EA97
		push	eax
		call	ds:GetCurrentProcessId
		xor	ebx, ebx
		push	eax
		inc	ebx
		push	ebx
		push	0
		jmp	short loc_1000EA65
; ---------------------------------------------------------------------------

loc_1000EA57:				; CODE XREF: sub_1000EA2B+17j
		push	0
		call	ds:GetCurrentProcessId
		xor	ebx, ebx
		push	eax
		inc	ebx
		push	ebx
		push	ebx

loc_1000EA65:				; CODE XREF: sub_1000EA2B+2Aj
		lea	ecx, [ebp+var_10]
		call	sub_10011174
		test	al, al
		jz	short loc_1000EA97
		push	ebx
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_10]
		push	0
		push	0
		call	sub_10011215
		test	al, al
		jz	short loc_1000EA97
		mov	ecx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		push	eax
		push	12h
		call	sub_100111C8
		test	al, al
		jnz	short loc_1000EA99

loc_1000EA97:				; CODE XREF: sub_1000EA2B+1Aj
					; sub_1000EA2B+44j ...
		xor	bl, bl

loc_1000EA99:				; CODE XREF: sub_1000EA2B+6Aj
		lea	ecx, [ebp+var_10]
		call	sub_10011108
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000EA2B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EAA8	proc near		; CODE XREF: sub_1000E983+23p
					; sub_1000EAA8+3Cp ...
		mov	eax, dword_10033C70
		test	eax, eax
		jnz	short locret_1000EAE2
		push	4Ch		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_1000EACB
		mov	ecx, eax
		call	sub_10008F00
		mov	dword_10033C70,	eax
		jmp	short loc_1000EAD2
; ---------------------------------------------------------------------------

loc_1000EACB:				; CODE XREF: sub_1000EAA8+13j
		and	dword_10033C70,	0

loc_1000EAD2:				; CODE XREF: sub_1000EAA8+21j
		push	offset loc_1000EAE3 ; _onexit_t
		call	sub_1001ABD6
		mov	eax, dword_10033C70
		pop	ecx

locret_1000EAE2:			; CODE XREF: sub_1000EAA8+7j
		retn
; ---------------------------------------------------------------------------

; int __cdecl loc_1000EAE3()
loc_1000EAE3:				; DATA XREF: sub_1000EAA8:loc_1000EAD2o
		push	esi
		call	sub_1000EAA8
		mov	esi, eax
		test	esi, esi
		jz	short loc_1000EAFD
		mov	ecx, esi
		call	sub_10008FB1
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1000EAFD:				; CODE XREF: sub_1000EAA8+45j
		xor	eax, eax
		pop	esi
		retn
sub_1000EAA8	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EB01	proc near		; CODE XREF: sub_1000F742+4p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_1000EB28
		cmp	eax, 2C8590Bh
		ja	short loc_1000EB22
		imul	eax, 5Ch
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_1000EB28

loc_1000EB22:				; CODE XREF: sub_1000EB01+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_1000EB28:				; CODE XREF: sub_1000EB01+8j
					; sub_1000EB01+1Fj
		mov	eax, ecx
		retn
sub_1000EB01	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EB2B	proc near		; CODE XREF: sub_1000EB51+11p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	sub_1000F742
		mov	esi, eax
		lea	ecx, [esi+8]
		test	ecx, ecx
		jz	short loc_1000EB4B
		push	[esp+4+arg_8]
		call	sub_1000EB80

loc_1000EB4B:				; CODE XREF: sub_1000EB2B+15j
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_1000EB2B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EB51	proc near		; CODE XREF: sub_1000EC5D+7Ep
					; sub_1000ED04+5Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		push	[esp+0Ch+arg_4]
		push	dword ptr [esi+4]
		push	esi
		call	sub_1000EB2B
		push	1
		mov	ecx, ebx
		mov	edi, eax
		call	sub_1000F7D9
		mov	[esi+4], edi
		mov	ecx, [edi+4]
		mov	[ecx], edi
		pop	edi
		pop	esi
		pop	ebx
		retn	8
sub_1000EB51	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EB80	proc near		; CODE XREF: sub_1000EB2B+1Bp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		mov	eax, [esi]
		mov	[edi], eax
		lea	ecx, [edi+8]
		mov	eax, [esi+4]
		mov	[edi+4], eax
		lea	eax, [esi+8]
		push	eax
		call	sub_10003B1C
		lea	eax, [esi+20h]
		push	eax
		lea	ecx, [edi+20h]
		call	sub_10003AD7
		lea	eax, [esi+38h]
		push	eax
		lea	ecx, [edi+38h]
		call	sub_10003AD7
		mov	eax, [esi+50h]
		mov	[edi+50h], eax
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_1000EB80	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EBC3	proc near		; CODE XREF: sub_1000EC5D+24p
					; sub_1000ED04+1Ap
		mov	dword ptr [ecx+1Ch], 7
		xor	edx, edx
		mov	[ecx+18h], edx
		xor	eax, eax
		mov	[ecx+8], ax
		push	0Fh
		pop	eax
		mov	[ecx+34h], eax
		mov	[ecx+30h], edx
		mov	[ecx+20h], dl
		mov	[ecx+4Ch], eax
		mov	eax, ecx
		mov	[ecx+48h], edx
		mov	[ecx+38h], dl
		retn
sub_1000EBC3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EBED	proc near		; CODE XREF: sub_10016EB5+16p

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		mov	eax, [esp+arg_0]
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		push	ebx
		push	ebx
		lea	esi, [edi+4]
		mov	[edi], eax
		mov	ecx, esi
		mov	[esi], ebx
		mov	[esi+4], ebx
		call	sub_1000F742
		mov	[esi], eax
		mov	al, [esp+0Ch+arg_4]
		mov	[edi+0Dh], al
		mov	eax, edi
		mov	[edi+0Ch], bl
		pop	edi
		pop	esi
		pop	ebx
		retn	8
sub_1000EBED	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EC1F	proc near		; CODE XREF: sub_1000EC5D+8Bp
					; sub_1000ED04+65p ...
		push	esi
		mov	esi, ecx
		push	0		; size_t
		push	1		; char
		lea	ecx, [esi+38h]	; void *
		call	sub_10001769
		push	0		; size_t
		push	1		; char
		lea	ecx, [esi+20h]	; void *
		call	sub_10001769
		push	0		; int
		push	1		; char
		lea	ecx, [esi+8]	; void *
		call	sub_100022C1
		pop	esi
		retn
sub_1000EC1F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EC48	proc near		; CODE XREF: sub_10016EB5+BEp
		push	esi
		lea	esi, [ecx+4]
		mov	ecx, esi
		call	sub_1000F801
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_1000EC48	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000EC5D(void *, void *, int, void *, int)
sub_1000EC5D	proc near		; CODE XREF: sub_1000AC66+A2p
					; sub_1000F322+4Bp ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_38		= byte ptr -38h
var_20		= byte ptr -20h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 58h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+58h+var_4], eax
		push	ebx
		mov	ebx, [esp+5Ch+arg_C]
		push	ebp
		push	esi
		mov	esi, [esp+64h+arg_0]
		mov	ebp, ecx
		push	edi
		mov	edi, [esp+68h+arg_4]
		lea	ecx, [esp+68h+var_58]
		call	sub_1000EBC3
		mov	eax, [esp+68h+arg_8]
		mov	[esp+68h+var_58], eax
		mov	eax, [esp+68h+arg_10]
		push	esi
		mov	[esp+6Ch+var_54], eax
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	esi		; void *
		lea	ecx, [esp+70h+var_50]
		call	sub_100023C8
		push	edi
		call	sub_100019DA
		pop	ecx
		push	eax		; size_t
		push	edi		; void *
		lea	ecx, [esp+70h+var_38]
		call	sub_1000183E
		push	ebx
		call	sub_100019DA
		pop	ecx
		push	eax		; size_t
		push	ebx		; void *
		lea	ecx, [esp+70h+var_20]
		call	sub_1000183E
		and	[esp+68h+var_8], 0
		lea	eax, [esp+68h+var_58]
		lea	ecx, [ebp+4]
		push	eax
		push	dword ptr [ecx]
		call	sub_1000EB51
		lea	ecx, [esp+68h+var_58]
		mov	byte ptr [ebp+0Ch], 1
		call	sub_1000EC1F
		mov	ecx, [esp+68h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn	14h
sub_1000EC5D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000ED04(void *)
sub_1000ED04	proc near		; CODE XREF: sub_10016EB5+82p

var_58		= dword	ptr -58h
var_50		= byte ptr -50h
var_38		= byte ptr -38h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		mov	edi, ecx
		lea	ecx, [ebp+var_58]
		call	sub_1000EBC3
		push	esi
		mov	[ebp+var_58], 5
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	esi		; void *
		lea	ecx, [ebp+var_50]
		call	sub_100023C8
		mov	esi, offset dword_1001D55C
		push	esi
		call	sub_100019DA
		pop	ecx
		push	eax		; size_t
		push	esi		; void *
		lea	ecx, [ebp+var_38]
		call	sub_1000183E
		lea	edx, [ebp+var_58]
		mov	[ebp+var_8], 1
		lea	ecx, [edi+4]
		push	edx
		push	dword ptr [ecx]
		call	sub_1000EB51
		lea	ecx, [ebp+var_58]
		call	sub_1000EC1F
		mov	ecx, [ebp+var_4]
		mov	al, 1
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000ED04	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000ED82(LPVOID lpBuffer, DWORD dwSize, int)
sub_1000ED82	proc near		; CODE XREF: sub_1000EF28+38p

var_4		= dword	ptr -4
lpBuffer	= dword	ptr  4
dwSize		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+dwSize]
		xor	ebp, ebp
		mov	[esp+0Ch+var_4], ebp
		test	esi, esi
		jnz	short loc_1000ED9D
		mov	eax, [esp+0Ch+arg_8]
		mov	[eax], ebp
		mov	al, 1
		jmp	short loc_1000EDF1
; ---------------------------------------------------------------------------

loc_1000ED9D:				; CODE XREF: sub_1000ED82+Fj
		mov	eax, [ecx]
		push	ebx
		push	edi
		push	4		; flProtect
		mov	ebx, [eax]
		push	1000h		; flAllocationType
		push	esi		; dwSize
		push	ebp		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualAllocEx
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000EDED
		lea	eax, [esp+14h+dwSize]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nSize
		push	[esp+1Ch+lpBuffer] ; lpBuffer
		push	edi		; lpBaseAddress
		push	ebx		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000EDDF
		cmp	[esp+14h+dwSize], esi
		jnz	short loc_1000EDDF
		mov	eax, [esp+14h+arg_8]
		mov	[eax], edi
		mov	al, 1
		jmp	short loc_1000EDEF
; ---------------------------------------------------------------------------

loc_1000EDDF:				; CODE XREF: sub_1000ED82+4Bj
					; sub_1000ED82+51j
		push	8000h		; dwFreeType
		push	ebp		; dwSize
		push	edi		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualFreeEx

loc_1000EDED:				; CODE XREF: sub_1000ED82+35j
		xor	al, al

loc_1000EDEF:				; CODE XREF: sub_1000ED82+5Bj
		pop	edi
		pop	ebx

loc_1000EDF1:				; CODE XREF: sub_1000ED82+19j
		pop	esi
		pop	ebp
		pop	ecx
		retn	0Ch
sub_1000ED82	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000EDF7	proc near		; CODE XREF: sub_1000EF28+13p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 10h
		and	[esp+10h+var_10], 0
		and	[esp+10h+var_C], 0
		push	ebx
		push	esi
		mov	ebx, ecx
		lea	ecx, [esp+18h+var_10]
		push	edi
		call	sub_1000D2ED
		mov	[esp+1Ch+var_10], eax
		xor	edi, edi
		mov	eax, [ebx+4]
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_1000EE88
		push	ebp

loc_1000EE21:				; CODE XREF: sub_1000EDF7+87j
		lea	eax, [esi+8]
		mov	ecx, ebx
		push	eax
		call	sub_1000EFB8
		test	al, al
		jz	short loc_1000EE79
		lea	ebp, [esi+10h]
		push	ebp
		lea	ecx, [esp+24h+var_10]
		call	sub_1000E572
		test	eax, eax
		jnz	short loc_1000EE6A
		mov	eax, [esi+20h]
		lea	ecx, [esp+20h+var_10]
		lea	eax, ds:13h[eax*2]
		shr	eax, 2
		lea	edi, [edi+eax*4]
		movzx	eax, byte_10033CDE
		push	eax
		push	ebp
		push	0
		lea	eax, [esp+2Ch+var_8]
		push	eax
		call	sub_1000CBB2

loc_1000EE6A:				; CODE XREF: sub_1000EDF7+48j
		mov	eax, [esi+38h]
		add	eax, 15h
		add	eax, [esi+50h]
		shr	eax, 2
		lea	edi, [edi+eax*4]

loc_1000EE79:				; CODE XREF: sub_1000EDF7+37j
		mov	esi, [esi]
		cmp	esi, [ebx+4]
		jnz	short loc_1000EE21
		pop	ebp
		test	edi, edi
		jz	short loc_1000EE88
		add	edi, 8

loc_1000EE88:				; CODE XREF: sub_1000EDF7+27j
					; sub_1000EDF7+8Cj
		lea	ecx, [esp+1Ch+var_10]
		call	sub_1000CD96
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10h
		retn
sub_1000EDF7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EE9A	proc near		; CODE XREF: sub_1000F322+8Dp

var_B4		= byte ptr -0B4h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0B4h
		push	esi
		mov	esi, 10000h
		cmp	[ebp+arg_0], esi
		jbe	short loc_1000EEE6
		push	offset aSizeKallocgran ; "size <= kAllocGranularity"
		lea	eax, [ebp+arg_0]
		push	offset dword_1001D558
		push	eax
		call	sub_100035CB
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000EEE6
		push	eax		; void *
		push	24h		; int
		push	offset aCBuildsMoz2__0 ; "c:/builds/moz2_slave/tb-rel-c-esr38-w32"...
		lea	ecx, [ebp+var_B4]
		call	sub_10001F1E
		lea	ecx, [ebp+var_B4]
		call	sub_10002021

loc_1000EEE6:				; CODE XREF: sub_1000EE9A+12j
					; sub_1000EE9A+2Cj
		sub	esi, [ebp+arg_0]

loc_1000EEE9:				; CODE XREF: sub_1000EE9A+68j
		lea	eax, [ebp+var_4]
		push	eax
		call	ds:rand_s
		pop	ecx
		mov	ecx, [ebp+var_4]
		and	ecx, 0FFFFh
		mov	[ebp+var_4], ecx
		cmp	ecx, esi
		ja	short loc_1000EEE9
		mov	eax, 800h
		mov	edx, 1000h
		pop	esi
		cmp	[ebp+arg_0], eax
		ja	short loc_1000EF1D

loc_1000EF14:				; CODE XREF: sub_1000EE9A+81j
		mov	edx, eax
		shr	eax, 1
		cmp	eax, [ebp+arg_0]
		jnb	short loc_1000EF14

loc_1000EF1D:				; CODE XREF: sub_1000EE9A+78j
		lea	eax, [edx-1]
		not	eax
		and	eax, ecx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000EE9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EF28	proc near		; CODE XREF: sub_10016EB5+A5p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+8], 0
		jnz	short loc_1000EF39
		mov	al, 1
		jmp	short loc_1000EFB3
; ---------------------------------------------------------------------------

loc_1000EF39:				; CODE XREF: sub_1000EF28+Bj
		push	ebx
		push	esi
		call	sub_1000EDF7
		mov	ebx, eax
		push	ebx
		call	sub_1001AAE8
		pop	ecx
		mov	esi, eax
		mov	ecx, edi
		push	ebx
		push	esi
		call	sub_1000F4D2
		test	al, al
		jz	short loc_1000EFA2
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax		; int
		push	ebx		; dwSize
		push	esi		; lpBuffer
		call	sub_1000ED82
		test	al, al
		jz	short loc_1000EFA2
		test	ebx, ebx
		mov	ecx, edi
		setnz	al
		movzx	eax, al
		push	eax
		call	sub_1000F322
		test	al, al
		jz	short loc_1000EFA2
		mov	eax, [ebp+var_4]
		push	4		; nSize
		push	offset g_interceptions ; lpBuffer
		mov	g_interceptions, eax
		mov	ecx, [edi]
		push	offset aG_intercepti_0 ; "g_interceptions"
		call	sub_100198FB
		mov	ebx, eax
		neg	ebx
		sbb	bl, bl
		inc	bl
		jmp	short loc_1000EFA4
; ---------------------------------------------------------------------------

loc_1000EFA2:				; CODE XREF: sub_1000EF28+2Ej
					; sub_1000EF28+3Fj ...
		xor	bl, bl

loc_1000EFA4:				; CODE XREF: sub_1000EF28+78j
		test	esi, esi
		jz	short loc_1000EFAF
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_1000EFAF:				; CODE XREF: sub_1000EF28+7Ej
		pop	esi
		mov	al, bl
		pop	ebx

loc_1000EFB3:				; CODE XREF: sub_1000EF28+Fj
		pop	edi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000EF28	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EFB8	proc near		; CODE XREF: sub_1000EDF7+30p
					; sub_1000F4D2+6Fp

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	dword ptr [esi], 0
		jnz	short loc_1000EFD5

loc_1000EFD1:				; CODE XREF: sub_1000EFB8+20j
					; sub_1000EFB8+25j
		xor	al, al
		jmp	short loc_1000F00D
; ---------------------------------------------------------------------------

loc_1000EFD5:				; CODE XREF: sub_1000EFB8+17j
		cmp	dword ptr [esi], 1
		jz	short loc_1000EFD1
		cmp	dword ptr [esi], 6
		jge	short loc_1000EFD1
		push	ebx
		push	offset aNtdll_dll_0 ; "ntdll.dll"
		lea	ecx, [ebp+var_1C]
		call	sub_10001E8D
		lea	eax, [esi+8]
		push	eax
		lea	ecx, [ebp+var_1C]
		call	sub_1000D4CC
		test	eax, eax
		lea	ecx, [ebp+var_1C] ; void *
		push	0		; int
		push	1		; char
		setnz	bl
		call	sub_100022C1
		mov	al, bl
		pop	ebx

loc_1000F00D:				; CODE XREF: sub_1000EFB8+1Bj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000EFB8	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F01E	proc near		; CODE XREF: sub_1000F322+13Bp

var_F8		= dword	ptr -0F8h
phModule	= dword	ptr -0F4h
hLibModule	= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= byte ptr -0CCh
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0F8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0F8h+var_4], eax
		mov	eax, [esp+0F8h+arg_0]
		push	ebx
		push	ebp
		mov	ebp, ecx
		mov	[esp+100h+var_E0], eax
		mov	eax, [esp+100h+arg_8]
		xor	ebx, ebx
		push	offset aNtdll_dll_0 ; "ntdll.dll"
		mov	[esp+104h+var_D8], ebp
		mov	[esp+104h+var_F8], eax
		mov	[esp+104h+var_EC], ebx
		call	ds:GetModuleHandleW
		mov	[esp+100h+phModule], eax
		test	eax, eax
		jnz	short loc_1000F070
		xor	al, al
		jmp	loc_1000F309
; ---------------------------------------------------------------------------

loc_1000F070:				; CODE XREF: sub_1000F01E+49j
		push	offset aLdrgetdllhandl ; "LdrGetDllHandle"
		lea	ecx, [esp+104h+var_D4]
		mov	[esp+104h+var_D4], offset off_1001CAC8
		mov	[esp+104h+var_D0], eax
		call	sub_10005D9A
		test	eax, eax
		jz	short loc_1000F0A4
		lea	ecx, [esp+100h+phModule]
		push	ecx		; phModule
		push	eax		; lpModuleName
		push	6		; dwFlags
		call	ds:GetModuleHandleExW
		test	eax, eax
		jz	loc_1000F307

loc_1000F0A4:				; CODE XREF: sub_1000F01E+6Ej
		call	sub_10006EF6
		cmp	eax, 3
		jg	short loc_1000F0F7
		mov	eax, [ebp+0]
		lea	ecx, [esp+100h+var_1C]
		mov	[esp+100h+var_1C], eax
		mov	eax, [esp+100h+phModule]
		mov	[esp+100h+var_18], eax
		mov	[esp+100h+var_14], ebx
		mov	[esp+100h+var_10], ebx
		call	sub_10007949
		lea	ecx, [esp+100h+var_1C]
		test	al, al
		jnz	short loc_1000F0F2
		call	sub_1000753A
		jmp	loc_1000F307
; ---------------------------------------------------------------------------

loc_1000F0F2:				; CODE XREF: sub_1000F01E+C8j
		call	sub_1000753A

loc_1000F0F7:				; CODE XREF: sub_1000F01E+8Ej
		mov	eax, [ebp+0]
		push	esi
		push	edi
		mov	ecx, [eax+28h]
		push	dword ptr [eax+2Ch] ; lpLibFileName
		mov	[esp+10Ch+var_E4], ecx
		call	ds:LoadLibraryW
		mov	[esp+108h+hLibModule], eax
		call	sub_10006EA9
		push	1Ch		; unsigned int
		cmp	dword ptr [eax+28h], 1
		jnz	short loc_1000F15A
		cmp	dword ptr [eax], 5
		jl	short loc_1000F13E
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000F1A3
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1001D5DC
		jmp	short loc_1000F195
; ---------------------------------------------------------------------------

loc_1000F13E:				; CODE XREF: sub_1000F01E+102j
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000F1A3
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1001D5B4
		jmp	short loc_1000F195
; ---------------------------------------------------------------------------

loc_1000F15A:				; CODE XREF: sub_1000F01E+FDj
		cmp	dword ptr [eax], 5
		jl	short loc_1000F17B
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000F1A3
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1001D604
		jmp	short loc_1000F195
; ---------------------------------------------------------------------------

loc_1000F17B:				; CODE XREF: sub_1000F01E+13Fj
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000F1A3
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1001D58C

loc_1000F195:				; CODE XREF: sub_1000F01E+11Ej
					; sub_1000F01E+13Aj ...
		mov	[edi+18h], ebx
		mov	[edi+14h], cl
		mov	[edi+10h], eax
		mov	[edi+0Ch], ebx
		jmp	short loc_1000F1A5
; ---------------------------------------------------------------------------

loc_1000F1A3:				; CODE XREF: sub_1000F01E+10Ej
					; sub_1000F01E+12Aj ...
		mov	edi, ebx

loc_1000F1A5:				; CODE XREF: sub_1000F01E+183j
		mov	eax, [ebp+4]
		mov	esi, [eax]
		cmp	esi, eax
		jz	loc_1000F2E3

loc_1000F1B2:				; CODE XREF: sub_1000F01E+2AEj
		push	offset aNtdll_dll_0 ; "ntdll.dll"
		lea	ecx, [esp+10Ch+var_1C]
		call	sub_10001E8D
		lea	eax, [esp+108h+var_1C]
		push	eax
		lea	ecx, [esi+10h]
		call	sub_1000D4CC
		test	eax, eax
		jnz	loc_1000F2D4
		cmp	dword ptr [esi+8], 1
		jnz	loc_1000F2D4
		cmp	[esi+58h], ebx
		jnz	short loc_1000F21D
		lea	ecx, [esi+40h]
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000F1F5
		mov	ecx, [ecx]

loc_1000F1F5:				; CODE XREF: sub_1000F01E+1D3j
		mov	eax, [edi]
		lea	edx, [esp+108h+var_DC]
		push	edx
		push	ecx
		push	[esp+110h+hLibModule]
		mov	ecx, edi
		call	dword ptr [eax+8]
		test	eax, eax
		js	loc_1000F2D4
		mov	eax, [esp+108h+var_DC]
		sub	eax, [esp+108h+hLibModule]
		add	eax, [esp+108h+var_E4]
		mov	[esi+58h], eax

loc_1000F21D:				; CODE XREF: sub_1000F01E+1CAj
		lea	eax, [esi+40h]
		cmp	dword ptr [eax+14h], 10h
		mov	[esp+108h+var_E8], eax
		jb	short loc_1000F230
		mov	eax, [eax]
		mov	[esp+108h+var_E8], eax

loc_1000F230:				; CODE XREF: sub_1000F01E+20Aj
		lea	ecx, [esi+28h]
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000F23B
		mov	ecx, [ecx]

loc_1000F23B:				; CODE XREF: sub_1000F01E+219j
		mov	ebp, [esp+108h+var_F8]
		mov	eax, [esp+108h+arg_4]
		mov	edx, [edi]
		push	ebx
		sub	eax, [ebp+4]
		push	eax
		mov	eax, ebp
		mov	ebp, [esp+110h+var_E0]
		add	ebp, 10h
		mov	eax, [eax+0Ch]
		shl	eax, 6
		add	eax, ebp
		push	eax
		push	dword ptr [esi+58h]
		push	[esp+118h+var_E8]
		push	ecx
		push	[esp+120h+var_E4]
		mov	ecx, edi
		push	[esp+124h+phModule]
		call	dword ptr [edx+4]
		mov	ebp, [esp+108h+var_D8]
		test	eax, eax
		js	short loc_1000F2D4
		mov	eax, [esp+108h+var_EC]
		test	al, 4
		jz	short loc_1000F294
		and	eax, 0FFFFFFFBh
		lea	ecx, [esp+108h+var_CC]
		mov	[esp+108h+var_EC], eax
		call	sub_10002021

loc_1000F294:				; CODE XREF: sub_1000F01E+264j
		mov	edx, [esp+108h+var_F8]
		mov	ecx, [esp+108h+var_E0]
		add	ecx, 10h
		push	ebx		; int
		mov	eax, [edx+0Ch]
		shl	eax, 6
		add	ecx, eax
		mov	eax, [esi+0Ch]
		push	1		; char
		mov	g_originals[eax*4], ecx
		lea	ecx, [esp+110h+var_1C] ; void *
		inc	dword ptr [edx+0Ch]
		add	dword ptr [edx+4], 40h
		call	sub_100022C1
		mov	esi, [esi]
		cmp	esi, [ebp+4]
		jnz	loc_1000F1B2
		jmp	short loc_1000F2E3
; ---------------------------------------------------------------------------

loc_1000F2D4:				; CODE XREF: sub_1000F01E+1B7j
					; sub_1000F01E+1C1j ...
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+110h+var_1C] ; void *
		call	sub_100022C1

loc_1000F2E3:				; CODE XREF: sub_1000F01E+18Ej
					; sub_1000F01E+2B4j
		test	edi, edi
		jz	short loc_1000F2EF
		mov	eax, [edi]
		mov	ecx, edi
		push	1
		call	dword ptr [eax]

loc_1000F2EF:				; CODE XREF: sub_1000F01E+2C7j
		mov	eax, [esp+108h+hLibModule]
		test	eax, eax
		jz	short loc_1000F2FE
		push	eax		; hLibModule
		call	ds:FreeLibrary

loc_1000F2FE:				; CODE XREF: sub_1000F01E+2D7j
		cmp	esi, [ebp+4]
		pop	edi
		pop	esi
		jnz	short loc_1000F307
		mov	bl, 1

loc_1000F307:				; CODE XREF: sub_1000F01E+80j
					; sub_1000F01E+CFj ...
		mov	al, bl

loc_1000F309:				; CODE XREF: sub_1000F01E+4Dj
		mov	ecx, [esp+100h+var_4]
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0F8h
		retn	0Ch
sub_1000F01E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F322	proc near		; CODE XREF: sub_1000EF28+4Cp

var_118		= dword	ptr -118h
hProcess	= dword	ptr -114h
NumberOfBytesWritten= dword ptr	-110h
var_10C		= dword	ptr -10Ch
flOldProtect	= dword	ptr -108h
var_104		= byte ptr -104h
Buffer		= dword	ptr -54h
var_50		= dword	ptr -50h
var_48		= dword	ptr -48h
var_4		= dword	ptr -4
arg_0		= byte ptr  4

		sub	esp, 118h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+118h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	edi, edi
		xor	ebp, ebp
		inc	edi
		mov	[esp+128h+var_118], ebp
		cmp	[esp+128h+arg_0], 0
		mov	ebx, ecx
		jnz	short loc_1000F35B
		cmp	[ebx+8], ebp
		jnz	short loc_1000F386
		mov	al, 1
		jmp	loc_1000F4B7
; ---------------------------------------------------------------------------

loc_1000F35B:				; CODE XREF: sub_1000F322+2Bj
		push	ebp		; int
		push	offset a_targetntmap_0 ; "_TargetNtMapViewOfSection@44"
		push	edi		; int
		push	offset aNtmapviewofsec ; "NtMapViewOfSection"
		mov	esi, offset aNtdll_dll_0 ; "ntdll.dll"
		push	esi		; void *
		call	sub_1000EC5D
		push	edi		; int
		push	offset a_targetntunm_0 ; "_TargetNtUnmapViewOfSection@12"
		push	edi		; int
		push	offset aNtunmapviewofs ; "NtUnmapViewOfSection"
		push	esi		; void *
		mov	ecx, ebx
		call	sub_1000EC5D

loc_1000F386:				; CODE XREF: sub_1000F322+30j
		mov	eax, [ebx]
		push	edi		; flProtect
		mov	edi, ds:VirtualAllocEx
		push	2000h		; flAllocationType
		mov	eax, [eax]
		push	10000h		; dwSize
		push	ebp		; lpAddress
		push	eax		; hProcess
		mov	[esp+13Ch+hProcess], eax
		call	edi ; VirtualAllocEx
		mov	ebp, [ebx+8]
		mov	esi, eax
		shl	ebp, 6
		add	ebp, 50h
		push	ebp
		call	sub_1000EE9A
		pop	ecx
		mov	ecx, eax
		mov	edx, 0FFFFF000h
		and	ecx, edx
		and	eax, 0FFFh
		add	esi, ecx
		mov	[esp+128h+var_10C], eax
		push	40h		; flProtect
		push	1000h		; flAllocationType
		lea	ecx, [ebp+0FFFh]
		and	ecx, edx
		push	ecx		; dwSize
		push	esi		; lpAddress
		push	[esp+138h+hProcess] ; hProcess
		call	edi ; VirtualAllocEx
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000F413
		push	3
		push	195h
		push	offset aCBuildsMoz2__0 ; "c:/builds/moz2_slave/tb-rel-c-esr38-w32"...
		lea	ecx, [esp+134h+var_104]
		mov	[esp+134h+var_118], 1
		call	sub_10001EE3
		add	eax, 8
		push	offset aCheckFailedThu ; "Check	failed:	thunk_base. "
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx

loc_1000F413:				; CODE XREF: sub_1000F322+C2j
		test	byte ptr [esp+128h+var_118], 1
		jz	short loc_1000F423
		lea	ecx, [esp+128h+var_104]
		call	sub_10002021

loc_1000F423:				; CODE XREF: sub_1000F322+F6j
		add	esi, [esp+128h+var_10C]
		and	[esp+128h+var_48], 0
		push	10h
		pop	edi
		push	64h		; size_t
		push	0		; int
		push	offset g_originals ; void *
		mov	[esp+134h+Buffer], ebp
		mov	[esp+134h+var_50], edi
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+128h+Buffer]
		mov	ecx, ebx
		push	eax
		push	ebp
		push	esi
		call	sub_1000F01E
		test	al, al
		jz	short loc_1000F4B5
		lea	eax, [esp+128h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	edi		; nSize
		mov	edi, [esp+130h+hProcess]
		lea	eax, [esp+130h+Buffer]
		push	eax		; lpBuffer
		push	esi		; lpBaseAddress
		push	edi		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000F4B5
		cmp	[esp+128h+NumberOfBytesWritten], 10h
		jnz	short loc_1000F4B5
		lea	eax, [esp+128h+flOldProtect]
		push	eax		; lpflOldProtect
		push	20h		; flNewProtect
		push	ebp		; dwSize
		push	esi		; lpAddress
		push	edi		; hProcess
		call	ds:VirtualProtectEx
		mov	ecx, [ebx]
		push	64h		; nSize
		push	offset g_originals ; lpBuffer
		push	offset aG_originals_0 ;	"g_originals"
		call	sub_100198FB
		neg	eax
		sbb	eax, eax
		inc	eax
		jmp	short loc_1000F4B7
; ---------------------------------------------------------------------------

loc_1000F4B5:				; CODE XREF: sub_1000F322+142j
					; sub_1000F322+160j ...
		xor	al, al

loc_1000F4B7:				; CODE XREF: sub_1000F322+34j
					; sub_1000F322+191j
		mov	ecx, [esp+128h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 118h
		retn	4
sub_1000F322	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F4D2	proc near		; CODE XREF: sub_1000EF28+27p

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 30h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+30h+var_4], eax
		and	[esp+30h+var_30], 0
		mov	edx, [esp+30h+arg_4]
		push	ebx
		mov	ebx, ecx
		mov	ecx, [esp+34h+arg_0]
		mov	[esp+34h+var_24], ecx
		test	edx, edx
		jnz	short loc_1000F4FE
		mov	al, 1
		jmp	loc_1000F600
; ---------------------------------------------------------------------------

loc_1000F4FE:				; CODE XREF: sub_1000F4D2+23j
		push	ebp
		push	edi
		xor	edi, edi
		lea	ebp, [ecx+8]
		cmp	byte ptr [ebx+0Ch], 0
		mov	[esp+3Ch+var_28], ebp
		mov	[esp+3Ch+var_30], edi
		jz	short loc_1000F51A
		mov	eax, [ebx]
		mov	eax, [eax+28h]
		jmp	short loc_1000F51C
; ---------------------------------------------------------------------------

loc_1000F51A:				; CODE XREF: sub_1000F4D2+3Fj
		xor	eax, eax

loc_1000F51C:				; CODE XREF: sub_1000F4D2+46j
		mov	[esp+3Ch+var_2C], ebp
		sub	edx, 8
		mov	[ecx+4], eax
		lea	ebp, [ebx+4]
		mov	eax, [ebp+0]
		push	esi
		mov	[esp+40h+arg_4], edx
		mov	esi, [eax]
		cmp	esi, eax
		jz	loc_1000F5F9

loc_1000F53B:				; CODE XREF: sub_1000F4D2+11Dj
		lea	eax, [esi+8]
		mov	ecx, ebx
		push	eax
		call	sub_1000EFB8
		test	al, al
		jnz	short loc_1000F551
		mov	esi, [esi]
		jmp	loc_1000F5EC
; ---------------------------------------------------------------------------

loc_1000F551:				; CODE XREF: sub_1000F4D2+76j
		lea	eax, [esi+10h]
		push	eax
		lea	ecx, [esp+44h+var_1C]
		call	sub_10003B1C
		lea	eax, [esp+40h+arg_4]
		mov	ecx, ebx
		push	eax
		lea	eax, [esp+44h+var_2C]
		push	eax
		lea	eax, [esi+8]
		push	eax
		call	sub_1000F623
		test	al, al
		jz	loc_1000F612
		mov	edi, esi
		cmp	esi, [ebp+0]
		jz	short loc_1000F5CE

loc_1000F582:				; CODE XREF: sub_1000F4D2+FAj
		lea	eax, [esp+40h+var_1C]
		push	eax
		lea	ecx, [edi+10h]
		call	sub_1000D4CC
		test	eax, eax
		jnz	short loc_1000F5C7
		push	[esp+40h+var_28] ; int
		lea	eax, [esp+44h+arg_4]
		mov	ecx, ebx
		push	eax		; int
		lea	eax, [esp+48h+var_2C]
		push	eax		; int
		lea	eax, [edi+8]
		push	eax		; DstSize
		call	sub_1000F691
		test	al, al
		jz	short loc_1000F612
		cmp	esi, edi
		jnz	short loc_1000F5B6
		mov	esi, [esi]

loc_1000F5B6:				; CODE XREF: sub_1000F4D2+E0j
		push	edi		; void *
		lea	eax, [esp+44h+var_20]
		mov	ecx, ebp
		push	eax		; int
		call	sub_1000F834
		mov	edi, [eax]
		jmp	short loc_1000F5C9
; ---------------------------------------------------------------------------

loc_1000F5C7:				; CODE XREF: sub_1000F4D2+BFj
		mov	edi, [edi]

loc_1000F5C9:				; CODE XREF: sub_1000F4D2+F3j
		cmp	edi, [ebp+0]
		jnz	short loc_1000F582

loc_1000F5CE:				; CODE XREF: sub_1000F4D2+AEj
		mov	edi, [esp+40h+var_30]
		lea	ecx, [esp+40h+var_1C] ;	void *
		mov	eax, [esp+40h+var_2C]
		inc	edi
		push	0		; int
		push	1		; char
		mov	[esp+48h+var_28], eax
		mov	[esp+48h+var_30], edi
		call	sub_100022C1

loc_1000F5EC:				; CODE XREF: sub_1000F4D2+7Aj
		cmp	esi, [ebp+0]
		jnz	loc_1000F53B
		mov	ecx, [esp+40h+var_24]

loc_1000F5F9:				; CODE XREF: sub_1000F4D2+63j
		mov	[ecx], edi
		mov	al, 1

loc_1000F5FD:				; CODE XREF: sub_1000F4D2+14Fj
		pop	esi
		pop	edi
		pop	ebp

loc_1000F600:				; CODE XREF: sub_1000F4D2+27j
		mov	ecx, [esp+34h+var_4]
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 30h
		retn	8
; ---------------------------------------------------------------------------

loc_1000F612:				; CODE XREF: sub_1000F4D2+A3j
					; sub_1000F4D2+DCj
		push	0		; int
		push	1		; char
		lea	ecx, [esp+48h+var_1C] ;	void *
		call	sub_100022C1
		xor	al, al
		jmp	short loc_1000F5FD
sub_1000F4D2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F623	proc near		; CODE XREF: sub_1000F4D2+9Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	edx, [ebp+arg_4]
		and	[ebp+var_4], 0
		push	ebx
		mov	ebx, [ebp+arg_8]
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		mov	edi, [edx]
		mov	eax, [esi+18h]
		lea	ecx, ds:13h[eax*2]
		mov	eax, [ebx]
		and	ecx, 0FFFFFFFCh
		cmp	eax, ecx
		jnb	short loc_1000F650
		xor	al, al
		jmp	short loc_1000F688
; ---------------------------------------------------------------------------

loc_1000F650:				; CODE XREF: sub_1000F623+27j
		sub	eax, ecx
		mov	[ebx], eax
		add	[edx], ecx
		cmp	dword ptr [esi], 5
		push	0
		setz	al
		mov	[edi], ecx
		and	dword ptr [edi+8], 0
		mov	[edi+0Ch], al
		lea	eax, [edi+0Eh]
		mov	[edi+4], ecx
		lea	ecx, [esi+8]
		push	dword ptr [esi+18h]
		push	dword ptr [esi+18h]
		push	eax
		call	sub_1000D37B
		mov	eax, [esi+18h]
		xor	ecx, ecx
		mov	[edi+eax*2+0Eh], cx
		mov	al, 1

loc_1000F688:				; CODE XREF: sub_1000F623+2Bj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000F623	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000F691(rsize_t DstSize, int, int,	int)
sub_1000F691	proc near		; CODE XREF: sub_1000F4D2+D5p

var_4		= dword	ptr -4
DstSize		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		and	[esp+4+var_4], 0
		push	ebx
		mov	ebx, [esp+8+DstSize]
		push	ebp
		mov	ebp, [esp+0Ch+arg_C]
		push	esi
		push	edi
		cmp	byte ptr [ebp+0Ch], 0
		jz	short loc_1000F6B5
		push	offset dword_1001D55C ;	void *
		lea	ecx, [ebx+20h]
		call	sub_10005C71

loc_1000F6B5:				; CODE XREF: sub_1000F691+15j
		mov	eax, [ebx+48h]
		mov	ecx, [ebx+30h]
		mov	edx, [esp+14h+arg_4]
		mov	[esp+14h+DstSize], eax
		lea	edi, [eax+15h]
		mov	[esp+14h+arg_4], ecx
		mov	eax, [esp+14h+arg_8]
		add	edi, ecx
		mov	esi, [edx]
		and	edi, 0FFFFFFFCh
		mov	eax, [eax]
		cmp	eax, edi
		jnb	short loc_1000F6DF
		xor	al, al
		jmp	short loc_1000F73A
; ---------------------------------------------------------------------------

loc_1000F6DF:				; CODE XREF: sub_1000F691+48j
		mov	ebp, [esp+14h+arg_8]
		sub	eax, edi
		push	0		; int
		push	ecx		; MaxCount
		push	ecx		; DstSize
		mov	[ebp+0], eax
		lea	ecx, [ebx+20h]
		add	[edx], edi
		mov	[esi], edi
		mov	eax, [ebx]
		mov	[esi+4], eax
		mov	eax, [ebx+4]
		mov	[esi+8], eax
		mov	eax, [ebx+50h]
		mov	[esi+0Ch], eax
		add	esi, 10h
		push	esi		; Dst
		call	sub_1000F771
		add	esi, [esp+14h+arg_4]
		lea	ecx, [ebx+38h]
		mov	eax, [esp+14h+DstSize]
		push	0		; int
		push	eax		; MaxCount
		mov	byte ptr [esi],	0
		inc	esi
		push	eax		; DstSize
		push	esi		; Dst
		call	sub_1000F771
		mov	eax, [esp+14h+DstSize]
		mov	ebp, [esp+14h+arg_C]
		mov	byte ptr [esi+eax], 0
		mov	al, 1
		inc	dword ptr [ebp+8]
		add	[ebp+0], edi

loc_1000F73A:				; CODE XREF: sub_1000F691+4Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1000F691	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F742	proc near		; CODE XREF: sub_1000EB2B+9p
					; sub_1000EBED+19p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0
		push	1
		call	sub_1000EB01
		pop	ecx
		pop	ecx
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_1000F75B
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_1000F75F
; ---------------------------------------------------------------------------

loc_1000F75B:				; CODE XREF: sub_1000F742+11j
		mov	edx, [esp+arg_4]

loc_1000F75F:				; CODE XREF: sub_1000F742+17j
		test	eax, eax
		jz	short loc_1000F765
		mov	[eax], ecx

loc_1000F765:				; CODE XREF: sub_1000F742+1Fj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_1000F76E
		mov	[ecx], edx

locret_1000F76E:			; CODE XREF: sub_1000F742+28j
		retn	8
sub_1000F742	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000F771(void *Dst,	rsize_t	DstSize, rsize_t MaxCount, int)
sub_1000F771	proc near		; CODE XREF: sub_1000F691+77p
					; sub_1000F691+90p

Dst		= dword	ptr  4
DstSize		= dword	ptr  8
MaxCount	= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [ecx+10h]
		mov	edx, [esp+arg_C]
		cmp	eax, edx
		jnb	short loc_1000F787
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_1000F787:				; CODE XREF: sub_1000F771+9j
		push	esi
		mov	esi, [esp+4+MaxCount]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_1000F794
		mov	esi, eax

loc_1000F794:				; CODE XREF: sub_1000F771+1Fj
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000F79C
		mov	ecx, [ecx]

loc_1000F79C:				; CODE XREF: sub_1000F771+27j
		push	esi		; MaxCount
		add	ecx, edx
		push	ecx		; Src
		push	[esp+0Ch+DstSize] ; DstSize
		push	[esp+10h+Dst]	; Dst
		call	sub_1000F7B6
		add	esp, 10h
		mov	eax, esi
		pop	esi
		retn	10h
sub_1000F771	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000F7B6(void	*Dst, rsize_t DstSize, void *Src, rsize_t MaxCount)
sub_1000F7B6	proc near		; CODE XREF: sub_1000F771+37p

Dst		= dword	ptr  8
DstSize		= dword	ptr  0Ch
Src		= dword	ptr  10h
MaxCount	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+MaxCount],	0
		jbe	short loc_1000F7D4
		push	[ebp+MaxCount]	; MaxCount
		push	[ebp+Src]	; Src
		push	[ebp+DstSize]	; DstSize
		push	[ebp+Dst]	; Dst
		call	ds:memcpy_s
		add	esp, 10h

loc_1000F7D4:				; CODE XREF: sub_1000F7B6+7j
		mov	eax, [ebp+Dst]
		pop	ebp
		retn
sub_1000F7B6	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F7D9	proc near		; CODE XREF: sub_1000EB51+1Cp

arg_0		= dword	ptr  4

		mov	edx, [ecx+4]
		mov	eax, 2C8590Ah
		push	esi
		mov	esi, [esp+4+arg_0]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_1000F7F7
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000F7F7:				; CODE XREF: sub_1000F7D9+11j
		lea	eax, [edx+esi]
		mov	[ecx+4], eax
		pop	esi
		retn	4
sub_1000F7D9	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F801	proc near		; CODE XREF: sub_1000EC48+6p
		push	ebx
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		mov	ebx, [eax]
		mov	[eax], eax
		mov	eax, [edi]
		mov	[eax+4], eax
		and	dword ptr [edi+4], 0
		cmp	ebx, [edi]
		jz	short loc_1000F831
		push	esi

loc_1000F819:				; CODE XREF: sub_1000F801+2Dj
		mov	esi, [ebx]
		lea	ecx, [ebx+8]
		call	sub_1000EC1F
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	ebx, esi
		pop	ecx
		cmp	esi, [edi]
		jnz	short loc_1000F819
		pop	esi

loc_1000F831:				; CODE XREF: sub_1000F801+15j
		pop	edi
		pop	ebx
		retn
sub_1000F801	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000F834(int, void *)
sub_1000F834	proc near		; CODE XREF: sub_1000F4D2+ECp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	edi
		mov	edi, ecx
		mov	eax, [esi]
		mov	[esp+8+arg_4], eax
		mov	edx, [esi+4]
		mov	eax, [esi]
		mov	[edx], eax
		mov	ecx, [esi]
		mov	eax, [esi+4]
		mov	[ecx+4], eax
		lea	ecx, [esi+8]
		dec	dword ptr [edi+4]
		call	sub_1000EC1F
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [esp+0Ch+arg_0]
		pop	ecx
		mov	ecx, [esp+8+arg_4]
		pop	edi
		mov	[eax], ecx
		pop	esi
		retn	8
sub_1000F834	endp

; [0000001D BYTES: COLLAPSED FUNCTION unknown_libname_8]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F88F	proc near		; CODE XREF: sub_1000FA0E+1Ep

var_8		= word ptr -8
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, [ebp+arg_8]
		add	esi, 0Eh
		push	esi
		call	dword_10033D88
		add	eax, eax
		mov	[ebp+var_4], esi
		cmp	[ebp+arg_0], 0
		pop	ecx
		mov	[ebp+var_8], ax
		mov	[ebp+var_6], ax
		pop	esi
		jz	short loc_1000F8CE
		push	1
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_8]
		push	ecx
		call	dword_10033D6C
		test	eax, eax
		jnz	short loc_1000F8CE

loc_1000F8CA:				; CODE XREF: sub_1000F88F+56j
		mov	al, 1
		jmp	short loc_1000F8E9
; ---------------------------------------------------------------------------

loc_1000F8CE:				; CODE XREF: sub_1000F88F+26j
					; sub_1000F88F+39j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000F8E7
		push	1
		push	[ebp+arg_4]
		lea	eax, [ebp+var_8]
		push	eax
		call	dword_10033D6C
		test	eax, eax
		jz	short loc_1000F8CA

loc_1000F8E7:				; CODE XREF: sub_1000F88F+43j
		xor	al, al

loc_1000F8E9:				; CODE XREF: sub_1000F88F+3Dj
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000F88F	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1000F8EF	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x):loc_1001936Ap
					; TargetNtUnmapViewOfSection(x,x,x)+20p
		push	esi
		mov	esi, dword_10033CE4
		test	esi, esi
		jnz	short loc_1000F945
		mov	eax, g_interceptions
		test	eax, eax
		jnz	short loc_1000F905
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F905:				; CODE XREF: sub_1000F8EF+12j
		mov	eax, [eax]
		shl	eax, 2
		push	0
		add	eax, 8
		push	0
		push	eax
		call	sub_100158A4
		add	esp, 0Ch
		mov	esi, eax
		mov	ecx, esi
		mov	dword_10033CE4,	esi
		push	g_interceptions
		call	sub_1000F9EF
		test	al, al
		jnz	short loc_1000F945
		push	0
		push	esi
		call	sub_100158E4
		pop	ecx
		xor	esi, esi
		pop	ecx
		mov	dword_10033CE4,	esi

loc_1000F945:				; CODE XREF: sub_1000F8EF+9j
					; sub_1000F8EF+42j
		mov	eax, esi
		pop	esi
		retn
sub_1000F8EF	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F949	proc near		; CODE XREF: sub_1000FB1A+3Fp

arg_0		= dword	ptr  4

		push	esi
		xor	esi, esi
		cmp	dword_10033CE8,	esi
		jnz	short loc_1000F97A
		push	esi
		push	esi
		push	10h
		call	sub_100158A4
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000F974
		mov	dword ptr [eax], offset	off_1001D778
		mov	[eax+0Ch], esi
		mov	dword_10033CE8,	eax
		jmp	short loc_1000F97A
; ---------------------------------------------------------------------------

loc_1000F974:				; CODE XREF: sub_1000F949+19j
		mov	dword_10033CE8,	esi

loc_1000F97A:				; CODE XREF: sub_1000F949+9j
					; sub_1000F949+29j
		cmp	dword_10033CEC,	esi
		jnz	short loc_1000F9A5
		push	esi
		push	esi
		push	0Ch
		call	sub_100158A4
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000F99F
		mov	dword ptr [eax], offset	off_1001D790
		mov	dword_10033CEC,	eax
		jmp	short loc_1000F9A5
; ---------------------------------------------------------------------------

loc_1000F99F:				; CODE XREF: sub_1000F949+47j
		mov	dword_10033CEC,	esi

loc_1000F9A5:				; CODE XREF: sub_1000F949+37j
					; sub_1000F949+54j
		mov	eax, dword_10033CF0
		test	eax, eax
		jnz	short loc_1000F9CD
		push	esi
		push	esi
		push	0Ch
		call	sub_100158A4
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000F9C6
		mov	dword ptr [eax], offset	off_1001D7A8
		jmp	short loc_1000F9C8
; ---------------------------------------------------------------------------

loc_1000F9C6:				; CODE XREF: sub_1000F949+73j
		mov	eax, esi

loc_1000F9C8:				; CODE XREF: sub_1000F949+7Bj
		mov	dword_10033CF0,	eax

loc_1000F9CD:				; CODE XREF: sub_1000F949+63j
		mov	ecx, [esp+4+arg_0]
		dec	ecx
		pop	esi
		dec	ecx
		jz	short loc_1000F9E7
		dec	ecx
		jz	short loc_1000F9E0
		dec	ecx
		jz	short locret_1000F9EC
		xor	eax, eax
		jmp	short locret_1000F9EC
; ---------------------------------------------------------------------------

loc_1000F9E0:				; CODE XREF: sub_1000F949+8Ej
		mov	eax, dword_10033CEC
		jmp	short locret_1000F9EC
; ---------------------------------------------------------------------------

loc_1000F9E7:				; CODE XREF: sub_1000F949+8Bj
		mov	eax, dword_10033CE8

locret_1000F9EC:			; CODE XREF: sub_1000F949+91j
					; sub_1000F949+95j ...
		retn	4
sub_1000F949	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F9EF	proc near		; CODE XREF: sub_1000F8EF+3Bp

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		mov	[ecx], edx
		cmp	[edx], eax
		jle	short loc_1000FA09
		add	ecx, 4

loc_1000F9FE:				; CODE XREF: sub_1000F9EF+18j
		and	dword ptr [ecx], 0
		inc	eax
		lea	ecx, [ecx+4]
		cmp	eax, [edx]
		jl	short loc_1000F9FE

loc_1000FA09:				; CODE XREF: sub_1000F9EF+Aj
		mov	al, 1
		retn	4
sub_1000F9EF	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FA0E	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+D6p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		xor	edi, edi
		mov	eax, [esi]
		lea	ebx, [eax+8]
		cmp	[eax], edi
		jle	short loc_1000FA3E

loc_1000FA21:				; CODE XREF: sub_1000FA0E+2Ej
		push	ebx
		push	[esp+1Ch+arg_4]
		mov	ecx, esi
		push	[esp+20h+arg_0]
		call	sub_1000F88F
		test	al, al
		jnz	short loc_1000FA3E
		mov	eax, [esi]
		add	ebx, [ebx]
		inc	edi
		cmp	edi, [eax]
		jl	short loc_1000FA21

loc_1000FA3E:				; CODE XREF: sub_1000FA0E+11j
					; sub_1000FA0E+25j
		mov	eax, [esi]
		cmp	edi, [eax]
		jz	loc_1000FACC
		cmp	byte ptr [ebx+0Ch], 0
		jz	short loc_1000FA52
		xor	al, al
		jmp	short loc_1000FACE
; ---------------------------------------------------------------------------

loc_1000FA52:				; CODE XREF: sub_1000FA0E+3Ej
		cmp	dword ptr [esi+edi*4+4], 0
		jnz	short loc_1000FACC
		push	ebp
		mov	ebp, [ebx+8]
		push	[esp+1Ch+arg_8]
		shl	ebp, 6
		add	ebp, 10h
		push	1
		push	ebp
		call	sub_100158A4
		add	esp, 0Ch
		mov	[esi+edi*4+4], eax
		test	eax, eax
		jz	short loc_1000FACB
		mov	ecx, [esp+1Ch+arg_8]
		mov	[eax], ebp
		mov	eax, [esi+edi*4+4]
		and	dword ptr [eax+0Ch], 0
		mov	eax, [esi+edi*4+4]
		mov	[eax+8], ecx
		mov	ecx, esi
		mov	eax, [esi+edi*4+4]
		mov	dword ptr [eax+4], 10h
		push	dword ptr [esi+edi*4+4]
		push	ebx
		call	sub_1000FB1A
		mov	eax, [esi+edi*4+4]
		mov	[esp+1Ch+var_8], eax
		lea	eax, [esp+1Ch+var_4]
		push	eax
		push	20h
		lea	eax, [esp+24h+var_C]
		mov	[esp+24h+var_C], ebp
		push	eax
		lea	eax, [esp+28h+var_8]
		push	eax
		push	0FFFFFFFFh
		call	dword_10033D4C

loc_1000FACB:				; CODE XREF: sub_1000FA0E+6Aj
		pop	ebp

loc_1000FACC:				; CODE XREF: sub_1000FA0E+34j
					; sub_1000FA0E+49j
		mov	al, 1

loc_1000FACE:				; CODE XREF: sub_1000FA0E+42j
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn	0Ch
sub_1000FA0E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FAD7	proc near		; CODE XREF: TargetNtUnmapViewOfSection(x,x,x)+2Ep

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	esi, esi
		mov	eax, [edi]
		mov	edx, [eax]
		test	edx, edx
		jle	short loc_1000FB15
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		lea	eax, [edi+4]

loc_1000FAED:				; CODE XREF: sub_1000FAD7+27j
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000FAF8
		cmp	[ecx+8], ebx
		jz	short loc_1000FB02

loc_1000FAF8:				; CODE XREF: sub_1000FAD7+1Aj
		inc	esi
		add	eax, 4
		cmp	esi, edx
		jl	short loc_1000FAED
		jmp	short loc_1000FB14
; ---------------------------------------------------------------------------

loc_1000FB02:				; CODE XREF: sub_1000FAD7+1Fj
		push	1
		push	dword ptr [edi+esi*4+4]
		call	sub_100158E4
		and	dword ptr [edi+esi*4+4], 0
		pop	ecx
		pop	ecx

loc_1000FB14:				; CODE XREF: sub_1000FAD7+29j
		pop	ebx

loc_1000FB15:				; CODE XREF: sub_1000FAD7+Cj
		pop	edi
		pop	esi
		retn	4
sub_1000FAD7	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FB1A	proc near		; CODE XREF: sub_1000FA0E+93p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		mov	edx, ecx
		and	[esp+18h+arg_0], 0
		mov	[esp+18h+var_8], edx
		mov	esi, [edi+4]
		add	esi, edi
		cmp	dword ptr [edi+8], 0
		jle	loc_1000FBE3
		mov	ebx, [esp+18h+arg_4]
		lea	ebp, [ebx+10h]

loc_1000FB45:				; CODE XREF: sub_1000FB1A+C3j
		mov	eax, [edi]
		lea	ecx, [esi+10h]
		add	eax, edi
		cmp	ecx, eax
		jnb	loc_1000FBEE
		push	dword ptr [esi+4]
		mov	ecx, edx
		call	sub_1000F949
		mov	[esp+18h+arg_4], eax
		test	eax, eax
		jz	loc_1000FBEE
		lea	ecx, [esi+10h]
		push	ecx
		call	dword_10033D84
		pop	ecx
		mov	ecx, [esi]
		lea	edx, [esi+11h]
		add	edx, eax
		add	ecx, esi
		mov	[esp+18h+var_4], edx
		cmp	edx, ecx
		jnb	short loc_1000FBEE
		mov	eax, [edi]
		add	eax, edi
		cmp	edx, eax
		jnb	short loc_1000FBEE
		mov	ecx, [esp+18h+arg_4]
		lea	eax, [esi+10h]
		push	0
		push	40h
		push	ebp
		push	dword ptr [esi+0Ch]
		mov	edx, [ecx]
		push	[esp+28h+var_4]
		push	eax
		mov	eax, [esp+30h+var_8]
		mov	eax, [eax]
		push	dword ptr [eax+4]
		push	dword ptr [ebx+8]
		call	dword ptr [edx+4]
		test	eax, eax
		js	short loc_1000FBEE
		mov	eax, [esi+8]
		mov	ecx, [esp+18h+arg_0]
		mov	edx, [esp+18h+var_8]
		mov	g_originals[eax*4], ebp
		add	ebp, 40h
		inc	dword ptr [ebx+0Ch]
		add	dword ptr [ebx+4], 40h
		add	esi, [esi]
		inc	ecx
		mov	[esp+18h+arg_0], ecx
		cmp	ecx, [edi+8]
		jl	loc_1000FB45

loc_1000FBE3:				; CODE XREF: sub_1000FB1A+1Ej
		mov	al, 1

loc_1000FBE5:				; CODE XREF: sub_1000FB1A+D6j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	8
; ---------------------------------------------------------------------------

loc_1000FBEE:				; CODE XREF: sub_1000FB1A+34j
					; sub_1000FB1A+4Aj ...
		xor	al, al
		jmp	short loc_1000FBE5
sub_1000FB1A	endp

; [0000000E BYTES: COLLAPSED FUNCTION Concurrency::details::UMSFreeVirtualProcessorRoot::InitialThreadParam::~InitialThreadParam(void)]

; =============== S U B	R O U T	I N E =======================================


sub_1000FC00	proc near		; CODE XREF: sub_10016A61:loc_10016A93p
		mov	eax, [ecx]
		and	dword ptr [ecx], 0
		retn
sub_1000FC00	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000FC06(int, LPCWSTR lpName, int, int)
sub_1000FC06	proc near		; CODE XREF: sub_10016A61+1Cp

var_78		= dword	ptr -78h
JobObjectInformation= dword ptr	-74h
var_70		= byte ptr -70h
var_64		= dword	ptr -64h
var_58		= dword	ptr -58h
var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
lpName		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+lpName]
		push	ebx
		mov	ebx, ecx
		push	esi
		xor	esi, esi
		cmp	[ebx], esi
		jz	short loc_1000FC2D
		mov	eax, 4DFh
		jmp	loc_1000FCF8
; ---------------------------------------------------------------------------

loc_1000FC2D:				; CODE XREF: sub_1000FC06+1Bj
		push	edi
		push	eax		; lpName
		push	esi		; lpJobAttributes
		call	ds:CreateJobObjectW
		mov	edi, eax
		mov	[ebx], edi
		test	edi, edi
		jz	loc_1000FCED
		push	6Ch		; size_t
		lea	eax, [ebp+var_70]
		mov	[ebp+JobObjectInformation], esi
		push	esi		; int
		push	eax		; void *
		call	memset
		mov	eax, [ebp+arg_0]
		add	esp, 0Ch
		mov	[ebp+var_78], esi
		sub	eax, esi
		jz	short loc_1000FC88
		dec	eax
		jz	short loc_1000FC83
		dec	eax
		jz	short loc_1000FC7E
		dec	eax
		jz	short loc_1000FC79
		dec	eax
		jz	short loc_1000FC74
		mov	eax, 0A0h
		jmp	loc_1000FCF7
; ---------------------------------------------------------------------------

loc_1000FC74:				; CODE XREF: sub_1000FC06+62j
		mov	eax, [ebp+var_64]
		jmp	short loc_1000FCA9
; ---------------------------------------------------------------------------

loc_1000FC79:				; CODE XREF: sub_1000FC06+5Fj
		mov	eax, [ebp+var_64]
		jmp	short loc_1000FCA0
; ---------------------------------------------------------------------------

loc_1000FC7E:				; CODE XREF: sub_1000FC06+5Cj
		mov	eax, [ebp+var_64]
		jmp	short loc_1000FC93
; ---------------------------------------------------------------------------

loc_1000FC83:				; CODE XREF: sub_1000FC06+59j
		mov	eax, [ebp+var_64]
		jmp	short loc_1000FC90
; ---------------------------------------------------------------------------

loc_1000FC88:				; CODE XREF: sub_1000FC06+56j
		mov	eax, [ebp+var_64]
		or	eax, 400h

loc_1000FC90:				; CODE XREF: sub_1000FC06+80j
		push	27h
		pop	esi

loc_1000FC93:				; CODE XREF: sub_1000FC06+7Bj
		or	esi, 10h
		mov	[ebp+var_58], 1
		or	eax, 8

loc_1000FCA0:				; CODE XREF: sub_1000FC06+76j
		or	esi, 0C8h
		mov	[ebp+var_78], esi

loc_1000FCA9:				; CODE XREF: sub_1000FC06+71j
		mov	ecx, [ebp+arg_C]
		test	ecx, ecx
		jz	short loc_1000FCB8
		or	eax, 100h
		mov	[ebp+var_14], ecx

loc_1000FCB8:				; CODE XREF: sub_1000FC06+A8j
		mov	esi, ds:SetInformationJobObject
		or	eax, 2000h
		push	70h		; cbJobObjectInformationLength
		mov	[ebp+var_64], eax
		lea	eax, [ebp+JobObjectInformation]
		push	eax		; lpJobObjectInformation
		push	9		; JobObjectInformationClass
		push	edi		; hJob
		call	esi ; SetInformationJobObject
		test	eax, eax
		jz	short loc_1000FCED
		mov	eax, [ebp+arg_8]
		not	eax
		and	[ebp+var_78], eax
		lea	eax, [ebp+var_78]
		push	4		; cbJobObjectInformationLength
		push	eax		; lpJobObjectInformation
		push	4		; JobObjectInformationClass
		push	dword ptr [ebx]	; hJob
		call	esi ; SetInformationJobObject
		test	eax, eax
		jnz	short loc_1000FCF5

loc_1000FCED:				; CODE XREF: sub_1000FC06+36j
					; sub_1000FC06+CDj
		call	ds:GetLastError
		jmp	short loc_1000FCF7
; ---------------------------------------------------------------------------

loc_1000FCF5:				; CODE XREF: sub_1000FC06+E5j
		xor	eax, eax

loc_1000FCF7:				; CODE XREF: sub_1000FC06+69j
					; sub_1000FC06+EDj
		pop	edi

loc_1000FCF8:				; CODE XREF: sub_1000FC06+22j
		mov	ecx, [ebp+var_4]
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000FC06	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FD0A	proc near		; CODE XREF: sub_10016099+10Dp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	offset dword_1001D7E8
		lea	ecx, [esi+4]
		mov	[ecx], eax
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		mov	eax, [esp+8+arg_0]
		mov	dword ptr [esi], offset	off_1001D7DC
		mov	[esi+10h], eax
		call	sub_1000ADE8
		mov	eax, esi
		pop	esi
		retn	4
sub_1000FD0A	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000FD37(int, LPCWSTR lpName, DWORD	dwOpenMode, DWORD dwPipeMode, DWORD nMaxInstances, DWORD nOutBufferSize, DWORD nInBufferSize, DWORD nDefaultTimeOut)
sub_1000FD37	proc near		; DATA XREF: .rdata:1001D810o

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
lpName		= dword	ptr  8
dwOpenMode	= dword	ptr  0Ch
dwPipeMode	= dword	ptr  10h
nMaxInstances	= dword	ptr  14h
nOutBufferSize	= dword	ptr  18h
nInBufferSize	= dword	ptr  1Ch
nDefaultTimeOut	= dword	ptr  20h

		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+34h+var_4], eax
		push	ebx
		mov	ebx, [esp+38h+lpName]
		xor	eax, eax
		push	ebp
		mov	ebp, [esp+3Ch+arg_0]
		push	esi
		push	edi
		mov	[esp+44h+var_34], eax
		mov	esi, ecx
		or	dword ptr [ebp+18h], 0FFFFFFFFh
		mov	[esp+44h+var_30], eax
		mov	[esp+44h+var_2C], eax
		mov	[esp+44h+var_28], eax
		mov	[esp+44h+var_24], eax
		mov	[esp+44h+var_20], eax
		lea	eax, [esp+44h+var_34]
		push	eax
		push	2Fh
		push	ebx
		mov	[esp+50h+var_18], esi
		mov	dword ptr [ebp+10h], 5
		call	sub_10003B6B
		mov	edi, [esp+50h+var_34]
		add	esp, 0Ch
		cmp	edi, [esp+44h+var_30]
		jz	short loc_1000FDD6

loc_1000FD96:				; CODE XREF: sub_1000FD37+99j
		lea	eax, [esp+44h+var_28]
		push	eax
		push	5Ch
		push	edi
		call	sub_10003B6B
		mov	esi, [esp+50h+var_28]
		add	esp, 0Ch
		jmp	short loc_1000FDC3
; ---------------------------------------------------------------------------

loc_1000FDAC:				; CODE XREF: sub_1000FD37+90j
		push	offset a__	; ".."
		mov	ecx, esi
		call	sub_10009F23
		test	eax, eax
		jz	loc_1000FE79
		add	esi, 18h

loc_1000FDC3:				; CODE XREF: sub_1000FD37+73j
		cmp	esi, [esp+44h+var_24]
		jnz	short loc_1000FDAC
		add	edi, 18h
		cmp	edi, [esp+44h+var_30]
		jnz	short loc_1000FD96
		mov	esi, [esp+44h+var_18]

loc_1000FDD6:				; CODE XREF: sub_1000FD37+5Dj
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_1000FDE0
		mov	eax, [ebx]
		jmp	short loc_1000FDE2
; ---------------------------------------------------------------------------

loc_1000FDE0:				; CODE XREF: sub_1000FD37+A3j
		mov	eax, ebx

loc_1000FDE2:				; CODE XREF: sub_1000FD37+A7j
		mov	ecx, [esi+10h]
		mov	[esp+44h+var_14], eax
		lea	eax, [esp+44h+var_14]
		mov	[esp+44h+var_8], eax
		lea	eax, [esp+44h+var_10]
		push	eax
		push	8
		mov	[esp+4Ch+var_10], 1
		mov	[esp+4Ch+var_C], 1
		call	sub_100168E1
		mov	edi, offset a_	; "\\\\.\\"
		mov	esi, eax
		push	edi
		call	sub_100024E3
		pop	ecx
		push	eax
		push	edi
		push	4
		push	0
		mov	ecx, ebx
		call	sub_10004188
		test	eax, eax
		jnz	short loc_1000FE45
		mov	edi, offset a?	; "\\\\?\\"
		push	edi
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	edi		; void *
		push	4		; int
		push	0		; int
		mov	ecx, ebx
		call	sub_100046A7

loc_1000FE45:				; CODE XREF: sub_1000FD37+F3j
		lea	eax, [esp+44h+var_1C]
		push	eax		; int
		push	[esp+48h+nDefaultTimeOut] ; nDefaultTimeOut
		push	[esp+4Ch+nInBufferSize]	; nInBufferSize
		push	[esp+50h+nOutBufferSize] ; nOutBufferSize
		push	[esp+54h+nMaxInstances]	; nMaxInstances
		push	[esp+58h+dwPipeMode] ; dwPipeMode
		push	[esp+5Ch+dwOpenMode] ; dwOpenMode
		push	ebx		; lpName
		push	dword ptr [ebp+4] ; int
		push	esi		; int
		call	sub_1001017A
		mov	ecx, [esp+6Ch+var_1C]
		add	esp, 28h
		mov	[ebp+10h], eax
		mov	[ebp+18h], ecx

loc_1000FE79:				; CODE XREF: sub_1000FD37+83j
		lea	ecx, [esp+44h+var_28]
		call	sub_100040FD
		lea	ecx, [esp+44h+var_34]
		call	sub_100040FD
		mov	ecx, [esp+44h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 34h
		retn	20h
sub_1000FD37	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FEA2	proc near		; DATA XREF: .rdata:1001D7E0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_4], 8
		jnz	short loc_1000FED0
		mov	eax, offset _TargetCreateNamedPipeW@36 ; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000FED0
		mov	ecx, [esp+arg_0]
		push	0Eh		; int
		push	offset a_targetcreat_3 ; "_TargetCreateNamedPipeW@36"
		push	2		; int
		push	offset aCreatenamedpip ; "CreateNamedPipeW"
		push	offset aKernel32_dll_0 ; "kernel32.dll"
		call	sub_1000EC5D
		jmp	short locret_1000FED2
; ---------------------------------------------------------------------------

loc_1000FED0:				; CODE XREF: sub_1000FEA2+5j
					; sub_1000FEA2+Ej
		xor	al, al

locret_1000FED2:			; CODE XREF: sub_1000FEA2+2Cj
		retn	8
sub_1000FEA2	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000FED5(int,	int, int, void *, void *, void *, void *, void *, void *, int)
sub_1000FED5	proc near		; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+150p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h

		push	ecx
		mov	ecx, [esp+4+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000FEEE
		push	4
		pop	eax
		jmp	loc_1000FFDA
; ---------------------------------------------------------------------------

loc_1000FEEE:				; CODE XREF: sub_1000FED5+Fj
		mov	eax, [esp+8+arg_4]
		lea	ecx, [esp+8+var_4]
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_8]
		xor	ebx, ebx
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	dword ptr [edi+3Ch], 7
		push	1		; int
		mov	dword ptr [edi+44h], 0A0h
		mov	esi, [esi]
		push	ebx		; char
		mov	[esp+18h+var_4], esi
		call	sub_1000B44B
		push	eax		; size_t
		push	esi		; void *
		push	ebx		; int
		mov	ecx, edi
		call	sub_1000B39B
		test	al, al
		jnz	short loc_1000FF35
		push	4
		pop	eax
		jmp	loc_1000FFD8
; ---------------------------------------------------------------------------

loc_1000FF35:				; CODE XREF: sub_1000FED5+56j
		push	ebp
		push	2
		pop	ebp
		push	ebp		; int
		push	ebx		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	1		; int
		call	sub_1000B39B
		test	al, al
		jz	loc_1000FFD5
		push	ebp		; int
		push	ebx		; char
		push	esi		; size_t
		push	[esp+20h+arg_10] ; void	*
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000FFD5
		push	ebp		; int
		push	ebx		; char
		push	esi		; size_t
		push	[esp+20h+arg_14] ; void	*
		mov	ecx, edi
		push	3		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000FFD5
		push	ebp		; int
		push	ebx		; char
		push	esi		; size_t
		push	[esp+20h+arg_18] ; void	*
		mov	ecx, edi
		push	esi		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000FFD5
		push	ebp		; int
		push	ebx		; char
		push	esi		; size_t
		push	[esp+20h+arg_1C] ; void	*
		mov	ecx, edi
		push	5		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000FFD5
		push	ebp		; int
		push	ebx		; char
		push	esi		; size_t
		push	[esp+20h+arg_20] ; void	*
		mov	ecx, edi
		push	6		; int
		call	sub_1000B39B
		test	al, al
		jz	short loc_1000FFD5
		push	[esp+14h+arg_24]
		mov	ecx, [esp+18h+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000FFD5
		mov	ecx, [esp+14h+arg_0]
		push	edi
		call	sub_10017671

loc_1000FFD5:				; CODE XREF: sub_1000FED5+79j
					; sub_1000FED5+90j ...
		mov	eax, esi
		pop	ebp

loc_1000FFD8:				; CODE XREF: sub_1000FED5+5Bj
		pop	esi
		pop	ebx

loc_1000FFDA:				; CODE XREF: sub_1000FED5+14j
		pop	edi
		pop	ecx
		retn
sub_1000FED5	endp

; Exported entry  16. _TargetCreateNamedPipeW@36

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetCreateNamedPipeW(x, x, x, x, x, x, x,	x, x)
		public _TargetCreateNamedPipeW@36
_TargetCreateNamedPipeW@36 proc	near	; DATA XREF: sub_1000FEA2+7o
					; .rdata:off_10030468o

var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
dwErrCode	= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		sub	esp, 70h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+70h+var_4], eax
		mov	eax, [esp+70h+arg_0]
		mov	ecx, [esp+70h+arg_18]
		mov	edx, [esp+70h+arg_14]
		push	ebx
		mov	ebx, [esp+74h+arg_8]
		push	ebp
		mov	ebp, [esp+78h+arg_4]
		push	esi
		mov	esi, [esp+7Ch+arg_10]
		push	edi
		mov	edi, [esp+80h+arg_C]
		mov	[esp+80h+var_70], ebp
		mov	[esp+80h+var_54], ebp
		mov	ebp, [esp+80h+arg_20]
		push	ebp
		mov	[esp+84h+var_48], eax
		mov	eax, [esp+84h+arg_1C]
		push	eax
		push	ecx
		push	edx
		push	esi
		push	edi
		push	ebx
		mov	[esp+9Ch+var_60], ebp
		mov	ebp, [esp+9Ch+var_54]
		push	ebp
		mov	[esp+0A0h+var_50], ebx
		mov	[esp+0A0h+var_58], edi
		mov	[esp+0A0h+var_64], esi
		mov	[esp+0A0h+var_68], edx
		mov	[esp+0A0h+var_6C], ecx
		mov	[esp+0A0h+var_4C], eax
		call	[esp+0A0h+var_48]
		or	ebx, 0FFFFFFFFh
		cmp	eax, ebx
		jnz	loc_10010165
		push	[esp+80h+var_70] ; void	*
		mov	ebp, offset aCreatenamedpip ; "CreateNamedPipeW"
		push	ebp		; int
		call	sub_10002C98
		pop	ecx
		pop	ecx
		call	sub_10015880
		mov	ecx, eax
		mov	edx, [eax]
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jz	loc_10010163
		call	ds:GetLastError
		cmp	[esp+80h+var_60], 0
		mov	edi, eax
		jnz	loc_10010163
		call	sub_10015CC7
		mov	esi, eax
		test	esi, esi
		jz	loc_1001015C
		lea	eax, [esp+80h+var_70]
		xor	ecx, ecx
		mov	[esp+80h+var_8], eax
		inc	ecx
		lea	eax, [esp+80h+var_10]
		mov	[esp+80h+var_10], ecx
		push	eax
		push	8
		mov	[esp+88h+var_C], ecx
		call	sub_100119BE
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_1001015C
		push	esi
		lea	ecx, [esp+84h+var_60]
		call	sub_100175A8
		and	[esp+80h+var_44], 0
		lea	eax, [esp+80h+var_40]
		push	30h		; size_t
		push	0		; int
		push	eax		; void *
		call	memset
		lea	eax, [esp+8Ch+var_44]
		push	eax		; int
		lea	eax, [esp+90h+var_4C]
		push	eax		; void *
		lea	eax, [esp+94h+var_6C]
		push	eax		; void *
		lea	eax, [esp+98h+var_68]
		push	eax		; void *
		lea	eax, [esp+9Ch+var_64]
		push	eax		; void *
		lea	eax, [esp+0A0h+var_58]
		push	eax		; void *
		lea	eax, [esp+0A4h+var_50]
		push	eax		; void *
		lea	eax, [esp+0A8h+var_70]
		push	eax		; int
		lea	eax, [esp+0ACh+var_60]
		push	8		; int
		push	eax		; int
		call	sub_1000FED5
		add	esp, 34h
		test	eax, eax
		jnz	short loc_1001015C
		push	[esp+80h+dwErrCode] ; dwErrCode
		call	ds:SetLastError
		cmp	[esp+80h+dwErrCode], 0
		jnz	short loc_10010163
		push	[esp+80h+var_70] ; void	*
		push	ebp		; int
		call	sub_10002B92
		mov	eax, [esp+88h+var_34]
		pop	ecx
		pop	ecx
		jmp	short loc_10010165
; ---------------------------------------------------------------------------

loc_1001015C:				; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+D9j
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+102j ...
		push	edi		; dwErrCode
		call	ds:SetLastError

loc_10010163:				; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+B7j
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+CAj ...
		mov	eax, ebx

loc_10010165:				; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+8Bj
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+17Dj
		mov	ecx, [esp+80h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn	24h
_TargetCreateNamedPipeW@36 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001017A(int,	int, LPCWSTR lpName, DWORD dwOpenMode, DWORD dwPipeMode, DWORD nMaxInstances, DWORD nOutBufferSize, DWORD nInBufferSize, DWORD nDefaultTimeOut,	int)
sub_1001017A	proc near		; CODE XREF: sub_1000FD37+130p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpName		= dword	ptr  10h
dwOpenMode	= dword	ptr  14h
dwPipeMode	= dword	ptr  18h
nMaxInstances	= dword	ptr  1Ch
nOutBufferSize	= dword	ptr  20h
nInBufferSize	= dword	ptr  24h
nDefaultTimeOut	= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 3
		jz	short loc_10010188

loc_10010183:				; CODE XREF: sub_1001017A+43j
		push	5
		pop	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10010188:				; CODE XREF: sub_1001017A+7j
		mov	eax, [ebp+lpName]
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10010193
		mov	eax, [eax]

loc_10010193:				; CODE XREF: sub_1001017A+15j
		push	0		; lpSecurityAttributes
		push	[ebp+nDefaultTimeOut] ;	nDefaultTimeOut
		push	[ebp+nInBufferSize] ; nInBufferSize
		push	[ebp+nOutBufferSize] ; nOutBufferSize
		push	[ebp+nMaxInstances] ; nMaxInstances
		push	[ebp+dwPipeMode] ; dwPipeMode
		push	[ebp+dwOpenMode] ; dwOpenMode
		push	eax		; lpName
		mov	eax, [ebp+arg_4]
		push	dword ptr [eax]	; hTargetProcessHandle
		call	sub_100101C3
		mov	ecx, [ebp+arg_24]
		add	esp, 24h
		mov	[ecx], eax
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10010183
		xor	eax, eax
		pop	ebp
		retn
sub_1001017A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100101C3(HANDLE hTargetProcessHandle,	LPCWSTR	lpName,	DWORD dwOpenMode, DWORD	dwPipeMode, DWORD nMaxInstances, DWORD nOutBufferSize, DWORD nInBufferSize, DWORD nDefaultTimeOut, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
sub_100101C3	proc near		; CODE XREF: sub_1001017A+33p

TargetHandle	= dword	ptr -4
hTargetProcessHandle= dword ptr	 8
lpName		= dword	ptr  0Ch
dwOpenMode	= dword	ptr  10h
dwPipeMode	= dword	ptr  14h
nMaxInstances	= dword	ptr  18h
nOutBufferSize	= dword	ptr  1Ch
nInBufferSize	= dword	ptr  20h
nDefaultTimeOut	= dword	ptr  24h
lpSecurityAttributes= dword ptr	 28h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	[ebp+lpSecurityAttributes] ; lpSecurityAttributes
		push	[ebp+nDefaultTimeOut] ;	nDefaultTimeOut
		push	[ebp+nInBufferSize] ; nInBufferSize
		push	[ebp+nOutBufferSize] ; nOutBufferSize
		push	[ebp+nMaxInstances] ; nMaxInstances
		push	[ebp+dwPipeMode] ; dwPipeMode
		push	[ebp+dwOpenMode] ; dwOpenMode
		push	[ebp+lpName]	; lpName
		call	ds:CreateNamedPipeW
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100101EF

loc_100101EA:				; CODE XREF: sub_100101C3+49j
		or	eax, 0FFFFFFFFh
		jmp	short loc_10010211
; ---------------------------------------------------------------------------

loc_100101EF:				; CODE XREF: sub_100101C3+25j
		push	3		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	ecx, [ebp+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	eax		; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_100101EA
		mov	eax, [ebp+TargetHandle]

loc_10010211:				; CODE XREF: sub_100101C3+2Aj
		mov	esp, ebp
		pop	ebp
		retn
sub_100101C3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010215	proc near		; CODE XREF: sub_1001651A+EAp

var_10		= byte ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	[ebp+arg_4], 6
		jz	short loc_10010225
		xor	al, al
		jmp	short loc_10010266
; ---------------------------------------------------------------------------

loc_10010225:				; CODE XREF: sub_10010215+Aj
		push	ebx
		push	3
		lea	ecx, [ebp+var_10]
		call	sub_10011053
		xor	ebx, ebx
		lea	ecx, [ebp+var_10]
		inc	ebx
		push	ebx
		push	[ebp+arg_0]
		push	0
		push	0
		call	sub_10011215
		test	al, al
		jz	short loc_10010259
		mov	ecx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		push	eax
		push	8
		call	sub_100111C8
		test	al, al
		jnz	short loc_1001025B

loc_10010259:				; CODE XREF: sub_10010215+30j
		xor	bl, bl

loc_1001025B:				; CODE XREF: sub_10010215+42j
		lea	ecx, [ebp+var_10]
		call	sub_10011108
		mov	al, bl
		pop	ebx

loc_10010266:				; CODE XREF: sub_10010215+Ej
		mov	esp, ebp
		pop	ebp
		retn
sub_10010215	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001026A	proc near		; CODE XREF: sub_10016EB5+97p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, offset _TargetNtOpenThread@20 ; TargetNtOpenThread(x,x,x,x,x)
		push	edi
		xor	edi, edi
		xor	ebx, ebx
		inc	edi
		mov	ebp, offset aNtdll_dll_1 ; "ntdll.dll"
		test	eax, eax
		jz	short loc_1001029C
		push	5		; int
		push	offset a_targetntope_8 ; "_TargetNtOpenThread@20"
		push	edi		; int
		push	offset aNtopenthread ; "NtOpenThread"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000EC5D
		jmp	short loc_1001029E
; ---------------------------------------------------------------------------

loc_1001029C:				; CODE XREF: sub_1001026A+19j
		mov	al, bl

loc_1001029E:				; CODE XREF: sub_1001026A+30j
		test	al, al
		jz	loc_100103A4
		mov	eax, offset _TargetNtOpenProcess@20 ; TargetNtOpenProcess(x,x,x,x,x)
		test	eax, eax
		jz	short loc_100102C6
		push	6		; int
		push	offset a_targetntope_9 ; "_TargetNtOpenProcess@20"
		push	edi		; int
		push	offset aNtopenprocess ;	"NtOpenProcess"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000EC5D
		jmp	short loc_100102C8
; ---------------------------------------------------------------------------

loc_100102C6:				; CODE XREF: sub_1001026A+43j
		mov	al, bl

loc_100102C8:				; CODE XREF: sub_1001026A+5Aj
		test	al, al
		jz	loc_100103A4
		mov	eax, offset _TargetNtOpenProcessToken@16 ; TargetNtOpenProcessToken(x,x,x,x)
		test	eax, eax
		jz	short loc_100102F0
		push	7		; int
		push	offset a_targetntop_10 ; "_TargetNtOpenProcessToken@16"
		push	edi		; int
		push	offset aNtopenprocesst ; "NtOpenProcessToken"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000EC5D
		jmp	short loc_100102F2
; ---------------------------------------------------------------------------

loc_100102F0:				; CODE XREF: sub_1001026A+6Dj
		mov	al, bl

loc_100102F2:				; CODE XREF: sub_1001026A+84j
		test	al, al
		jz	loc_100103A4
		mov	eax, offset _TargetNtSetInformationThread@20 ; TargetNtSetInformationThread(x,x,x,x,x)
		test	eax, eax
		jz	short loc_1001031A
		push	2		; int
		push	offset a_targetntset_2 ; "_TargetNtSetInformationThread@20"
		push	edi		; int
		push	offset aNtsetinforma_0 ; "NtSetInformationThread"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000EC5D
		jmp	short loc_1001031C
; ---------------------------------------------------------------------------

loc_1001031A:				; CODE XREF: sub_1001026A+97j
		mov	al, bl

loc_1001031C:				; CODE XREF: sub_1001026A+AEj
		test	al, al
		jz	loc_100103A4
		mov	eax, offset _TargetNtOpenThreadToken@20	; TargetNtOpenThreadToken(x,x,x,x,x)
		test	eax, eax
		jz	short loc_10010344
		push	3		; int
		push	offset a_targetntop_11 ; "_TargetNtOpenThreadToken@20"
		push	edi		; int
		push	offset aNtopenthreadto ; "NtOpenThreadToken"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000EC5D
		jmp	short loc_10010346
; ---------------------------------------------------------------------------

loc_10010344:				; CODE XREF: sub_1001026A+C1j
		mov	al, bl

loc_10010346:				; CODE XREF: sub_1001026A+D8j
		test	al, al
		jz	short loc_100103A4
		call	sub_10006EF6
		cmp	eax, 1
		jl	short loc_100103A0
		mov	eax, offset _TargetNtOpenProcessTokenEx@20 ; TargetNtOpenProcessTokenEx(x,x,x,x,x)
		test	eax, eax
		jz	short loc_10010375
		push	8		; int
		push	offset a_targetntop_12 ; "_TargetNtOpenProcessTokenEx@20"
		push	1		; int
		push	offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000EC5D
		jmp	short loc_10010377
; ---------------------------------------------------------------------------

loc_10010375:				; CODE XREF: sub_1001026A+F1j
		mov	al, bl

loc_10010377:				; CODE XREF: sub_1001026A+109j
		test	al, al
		jz	short loc_100103A4
		mov	eax, offset _TargetNtOpenThreadTokenEx@24 ; TargetNtOpenThreadTokenEx(x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1001039C
		push	4		; int
		push	offset a_targetntop_13 ; "_TargetNtOpenThreadTokenEx@24"
		push	1		; int
		push	offset aNtopenthread_0 ; "NtOpenThreadTokenEx"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000EC5D
		mov	bl, al

loc_1001039C:				; CODE XREF: sub_1001026A+118j
		mov	al, bl
		jmp	short loc_100103A6
; ---------------------------------------------------------------------------

loc_100103A0:				; CODE XREF: sub_1001026A+E8j
		mov	al, 1
		jmp	short loc_100103A6
; ---------------------------------------------------------------------------

loc_100103A4:				; CODE XREF: sub_1001026A+36j
					; sub_1001026A+60j ...
		xor	al, al

loc_100103A6:				; CODE XREF: sub_1001026A+134j
					; sub_1001026A+138j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_1001026A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100103AB	proc near		; CODE XREF: sub_10016EB5+B2p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
phModule	= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	offset aNtdll_dll_1 ; "ntdll.dll"
		call	ds:GetModuleHandleW
		push	offset aLdrgetdllhandl ; "LdrGetDllHandle"
		lea	ecx, [ebp+var_C]
		mov	[ebp+phModule],	eax
		mov	[ebp+var_C], offset off_1001CAC8
		mov	[ebp+var_8], eax
		call	sub_10005D9A
		test	eax, eax
		jz	short loc_100103E7
		lea	ecx, [ebp+phModule]
		push	ecx		; phModule
		push	eax		; lpModuleName
		push	6		; dwFlags
		call	ds:GetModuleHandleExW

loc_100103E7:				; CODE XREF: sub_100103AB+2Dj
		push	offset aNtallocatevirt ; "NtAllocateVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	g_nt, eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtclose	; "NtClose"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D3C,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtduplicateobj ; "NtDuplicateObject"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D40,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtfreevirtualm ; "NtFreeVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D44,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtmapviewofsec ; "NtMapViewOfSection"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D48,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtprotectvirtu ; "NtProtectVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D4C,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtqueryinforma ; "NtQueryInformationProcess"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D50,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtqueryobject ;	"NtQueryObject"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D54,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtquerysection ; "NtQuerySection"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D58,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtqueryvirtual ; "NtQueryVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D5C,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aNtunmapviewofs ; "NtUnmapViewOfSection"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D60,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aRtlallocatehea ; "RtlAllocateHeap"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D64,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aRtlansistringt ; "RtlAnsiStringToUnicodeString"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D68,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aRtlcompareunic ; "RtlCompareUnicodeString"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D6C,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aRtlcreateheap ;	"RtlCreateHeap"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D70,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aRtlcreateusert ; "RtlCreateUserThread"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D74,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aRtldestroyheap ; "RtlDestroyHeap"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D78,	eax
		test	eax, eax
		jz	loc_1001062B
		push	offset aRtlfreeheap ; "RtlFreeHeap"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D7C,	eax
		test	eax, eax
		jz	short loc_1001062B
		push	offset a_strnicmp ; "_strnicmp"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D80,	eax
		test	eax, eax
		jz	short loc_1001062B
		push	offset aStrlen	; "strlen"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D84,	eax
		test	eax, eax
		jz	short loc_1001062B
		push	offset aWcslen	; "wcslen"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D88,	eax
		test	eax, eax
		jz	short loc_1001062B
		push	offset aMemcpy	; "memcpy"
		lea	ecx, [ebp+var_C]
		call	sub_10005D9A
		mov	dword_10033D8C,	eax
		test	eax, eax
		jz	short loc_1001062B
		mov	ecx, [ebp+arg_0]
		push	58h		; nSize
		push	offset g_nt	; lpBuffer
		push	offset aG_nt_0	; "g_nt"
		call	sub_100198FB
		neg	eax
		sbb	al, al
		inc	al
		jmp	short loc_1001062D
; ---------------------------------------------------------------------------

loc_1001062B:				; CODE XREF: sub_100103AB+50j
					; sub_100103AB+6Aj ...
		xor	al, al

loc_1001062D:				; CODE XREF: sub_100103AB+27Ej
		mov	esp, ebp
		pop	ebp
		retn
sub_100103AB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010631	proc near		; CODE XREF: sub_100108F7+57p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		cmp	dword ptr [eax], 2
		jnz	short loc_1001064E

loc_1001063A:				; CODE XREF: sub_10010631+20j
		mov	eax, [eax+4]
		xor	edx, edx
		mov	ecx, [eax]
		mov	eax, [esp+arg_0]
		cmp	[eax+8], ecx
		setnz	dl
		mov	eax, edx
		retn
; ---------------------------------------------------------------------------

loc_1001064E:				; CODE XREF: sub_10010631+7j
		cmp	dword ptr [eax], 4
		jz	short loc_1001063A
		push	2
		pop	eax
		retn
sub_10010631	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010657	proc near		; CODE XREF: sub_100108F7+49p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		cmp	dword ptr [eax], 2
		jnz	short loc_1001067A
		mov	eax, [eax+4]
		mov	ecx, [esp+arg_0]
		mov	eax, [eax]
		cmp	[ecx+8], eax
		ja	short loc_10010676
		cmp	[ecx+0Ch], eax
		jb	short loc_10010676
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10010676:				; CODE XREF: sub_10010657+15j
					; sub_10010657+1Aj
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001067A:				; CODE XREF: sub_10010657+7j
		push	2
		pop	eax
		retn
sub_10010657	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001067E	proc near		; CODE XREF: sub_100108F7+3Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		cmp	dword ptr [eax], 2
		jnz	short loc_1001069B
		mov	eax, [eax+4]
		mov	ecx, [eax]
		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		and	eax, ecx
		neg	eax
		sbb	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001069B:				; CODE XREF: sub_1001067E+7j
		push	2
		pop	eax
		retn
sub_1001067E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001069F	proc near		; CODE XREF: sub_100108F7+2Dp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 18h
		push	ebx
		mov	ebx, [esp+1Ch+arg_8]
		push	ebp
		push	esi
		push	edi
		test	ebx, ebx
		jz	loc_100107CD
		mov	eax, [esp+28h+arg_4]
		cmp	dword ptr [eax], 1
		jnz	loc_100107CD
		mov	eax, [eax+4]
		mov	edx, [eax]
		mov	eax, [esp+28h+arg_0]
		mov	ecx, [eax+14h]
		mov	esi, [eax+0Ch]
		mov	edi, [eax+10h]
		mov	[esp+28h+var_14], ecx
		mov	ecx, [eax+8]
		add	ecx, eax
		mov	[esp+28h+arg_8], ecx
		mov	ecx, [ebx]
		lea	eax, [edx+ecx*2]
		push	eax
		mov	[esp+2Ch+var_18], eax
		call	dword_10033D88
		mov	ebp, eax
		pop	ecx
		test	ebp, ebp
		jnz	short loc_100106FD

loc_100106F5:				; CODE XREF: sub_1001069F+60j
					; sub_1001069F+8Aj ...
		xor	eax, eax
		inc	eax
		jmp	loc_100107D0
; ---------------------------------------------------------------------------

loc_100106FD:				; CODE XREF: sub_1001069F+54j
		cmp	esi, ebp
		jg	short loc_100106F5
		mov	ecx, [esp+28h+var_14]
		mov	al, cl
		and	al, 1
		mov	byte ptr [esp+28h+var_14], al
		test	edi, edi
		js	short loc_10010778
		cmp	edi, 0FFFFFh
		jnz	short loc_1001071F
		mov	edi, ebp
		sub	edi, esi
		jmp	short loc_1001072B
; ---------------------------------------------------------------------------

loc_1001071F:				; CODE XREF: sub_1001069F+78j
		test	cl, 2
		jz	short loc_1001072B
		lea	eax, [esi+edi]
		cmp	eax, ebp
		jnz	short loc_100106F5

loc_1001072B:				; CODE XREF: sub_1001069F+7Ej
					; sub_1001069F+83j
		lea	eax, [esi+edi]
		cmp	eax, ebp
		jg	short loc_100106F5
		lea	eax, [esp+28h+var_8]
		push	eax
		push	esi
		push	[esp+30h+arg_8]
		call	sub_10010963
		lea	eax, [esp+34h+var_10]
		push	eax
		mov	eax, [esp+38h+var_18]
		push	esi
		lea	eax, [eax+edi*2]
		push	eax
		call	sub_10010963
		add	esp, 18h
		lea	eax, [esp+28h+var_10]
		push	[esp+28h+var_14]
		push	eax
		lea	eax, [esp+30h+var_8]
		push	eax
		call	dword_10033D6C
		test	eax, eax
		jnz	short loc_100106F5
		lea	eax, [esi+edi]

loc_10010772:				; CODE XREF: sub_1001069F+12Cj
		add	[ebx], eax
		xor	eax, eax
		jmp	short loc_100107D0
; ---------------------------------------------------------------------------

loc_10010778:				; CODE XREF: sub_1001069F+70j
		lea	eax, [esp+28h+var_8]
		push	eax
		push	esi
		push	[esp+30h+arg_8]
		call	sub_10010963
		mov	edi, [esp+34h+var_18]
		lea	eax, [esp+34h+var_10]
		push	eax
		push	esi
		push	edi
		call	sub_10010963
		add	esp, 18h

loc_1001079A:				; CODE XREF: sub_1001069F+11Bj
		push	[esp+28h+var_14]
		lea	eax, [esp+2Ch+var_10]
		push	eax
		lea	eax, [esp+30h+var_8]
		push	eax
		call	dword_10033D6C
		test	eax, eax
		jz	short loc_100107C1
		add	[esp+28h+var_C], 2
		dec	ebp
		cmp	ebp, esi
		jge	short loc_1001079A
		jmp	loc_100106F5
; ---------------------------------------------------------------------------

loc_100107C1:				; CODE XREF: sub_1001069F+111j
		mov	eax, [esp+28h+var_C]
		sub	eax, edi
		sar	eax, 1
		add	eax, esi
		jmp	short loc_10010772
; ---------------------------------------------------------------------------

loc_100107CD:				; CODE XREF: sub_1001069F+Dj
					; sub_1001069F+1Aj
		push	2
		pop	eax

loc_100107D0:				; CODE XREF: sub_1001069F+59j
					; sub_1001069F+D7j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
sub_1001069F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100107D8	proc near		; CODE XREF: sub_1001099A+33p
					; sub_100114C7+4Bp

var_B4		= byte ptr -0B4h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0B4h
		mov	eax, 0FFFFh
		push	ebx
		xor	ebx, ebx
		cmp	eax, [ebp+arg_0]
		mov	[ebp+var_4], ebx
		sbb	eax, eax
		and	eax, 2
		jz	short loc_1001081B
		push	3
		push	1Ch
		push	offset aCBuildsMoz2__1 ; "c:\\builds\\moz2_slave\\tb-rel-c-esr38-"...
		lea	ecx, [ebp+var_B4]
		inc	ebx
		call	sub_10001EE3
		add	eax, 8
		push	offset aCheckFailedIsv ; "Check	failed:	IsValueInRangeForNumericT"...
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx

loc_1001081B:				; CODE XREF: sub_100107D8+1Cj
		test	bl, 1
		pop	ebx
		jz	short loc_1001082C
		lea	ecx, [ebp+var_B4]
		call	sub_10002021

loc_1001082C:				; CODE XREF: sub_100107D8+47j
		mov	ax, word ptr [ebp+arg_0]
		mov	esp, ebp
		pop	ebp
		retn
sub_100107D8	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10010834(int, void *, int)
sub_10010834	proc near		; CODE XREF: sub_10010A4E+51p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		push	esi
		mov	esi, ecx
		push	edi
		lea	edi, [eax+eax]
		mov	edx, [esi+4]
		mov	eax, edx
		sub	eax, [esi]
		cmp	eax, edi
		jnb	short loc_1001084E
		xor	eax, eax
		jmp	short loc_10010875
; ---------------------------------------------------------------------------

loc_1001084E:				; CODE XREF: sub_10010834+14j
		sub	edx, edi
		mov	[esi+4], edx
		test	dl, 1
		jz	short loc_1001085E
		call	ds:DebugBreak

loc_1001085E:				; CODE XREF: sub_10010834+22j
		push	edi		; size_t
		push	[esp+0Ch+arg_4]	; void *
		push	dword ptr [esi+4] ; void *
		call	memcpy
		mov	eax, [esi+4]
		add	esp, 0Ch
		sub	eax, [esp+8+arg_0]

loc_10010875:				; CODE XREF: sub_10010834+18j
		pop	edi
		pop	esi
		retn	0Ch
sub_10010834	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001087A	proc near		; CODE XREF: sub_10010AC9+92p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	edi
		mov	edi, ecx
		test	eax, eax
		jnz	short loc_1001088A

loc_10010885:				; CODE XREF: sub_1001087A+22j
		push	2
		pop	eax
		jmp	short loc_100108F3
; ---------------------------------------------------------------------------

loc_1001088A:				; CODE XREF: sub_1001087A+9j
		movzx	ecx, word ptr [edi+4]
		xor	edx, edx
		test	cx, cx
		js	short loc_100108A1
		movsx	ecx, cx
		cmp	ecx, [esp+4+arg_4]
		jnb	short loc_10010885
		lea	edx, [eax+ecx*8]

loc_100108A1:				; CODE XREF: sub_1001087A+19j
		push	esi
		mov	esi, [esp+8+arg_8]
		mov	ecx, edi
		push	esi
		push	edx
		call	sub_100108F7
		movzx	ecx, word ptr [edi+6]
		xor	edx, edx
		cmp	dx, cx
		jz	short loc_100108F2
		test	cl, 1
		jz	short loc_100108D7
		test	eax, eax
		jnz	short loc_100108C6
		inc	eax
		jmp	short loc_100108D7
; ---------------------------------------------------------------------------

loc_100108C6:				; CODE XREF: sub_1001087A+47j
		cmp	eax, 1
		jnz	short loc_100108CF
		xor	eax, eax
		jmp	short loc_100108D7
; ---------------------------------------------------------------------------

loc_100108CF:				; CODE XREF: sub_1001087A+4Fj
		cmp	eax, 2
		jz	short loc_100108D7
		push	2
		pop	eax

loc_100108D7:				; CODE XREF: sub_1001087A+43j
					; sub_1001087A+4Aj ...
		test	esi, esi
		jz	short loc_100108F2
		test	cl, 2
		jz	short loc_100108E5
		and	[esi], edx
		and	[esi+4], edx

loc_100108E5:				; CODE XREF: sub_1001087A+64j
		test	byte ptr [edi+6], 4
		jz	short loc_100108F2
		mov	dword ptr [esi+4], 4

loc_100108F2:				; CODE XREF: sub_1001087A+3Ej
					; sub_1001087A+5Fj ...
		pop	esi

loc_100108F3:				; CODE XREF: sub_1001087A+Ej
		pop	edi
		retn	0Ch
sub_1001087A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100108F7	proc near		; CODE XREF: sub_1001087A+30p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ecx]
		sub	eax, 0
		jz	short loc_1001095C
		dec	eax
		jz	short loc_10010958
		dec	eax
		jz	short loc_10010947
		dec	eax
		jz	short loc_10010939
		dec	eax
		jz	short loc_1001092B
		dec	eax
		jz	short loc_1001091D
		dec	eax
		jz	short loc_10010918
		push	2
		pop	eax
		jmp	short loc_1001095F
; ---------------------------------------------------------------------------

loc_10010918:				; CODE XREF: sub_100108F7+1Aj
		mov	eax, [ecx+8]
		jmp	short loc_1001095F
; ---------------------------------------------------------------------------

loc_1001091D:				; CODE XREF: sub_100108F7+17j
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	ecx
		call	sub_1001069F
		jmp	short loc_10010953
; ---------------------------------------------------------------------------

loc_1001092B:				; CODE XREF: sub_100108F7+14j
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	ecx
		call	sub_1001067E
		jmp	short loc_10010953
; ---------------------------------------------------------------------------

loc_10010939:				; CODE XREF: sub_100108F7+11j
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	ecx
		call	sub_10010657
		jmp	short loc_10010953
; ---------------------------------------------------------------------------

loc_10010947:				; CODE XREF: sub_100108F7+Ej
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	ecx
		call	sub_10010631

loc_10010953:				; CODE XREF: sub_100108F7+32j
					; sub_100108F7+40j ...
		add	esp, 0Ch
		jmp	short loc_1001095F
; ---------------------------------------------------------------------------

loc_10010958:				; CODE XREF: sub_100108F7+Bj
		xor	eax, eax
		jmp	short loc_1001095F
; ---------------------------------------------------------------------------

loc_1001095C:				; CODE XREF: sub_100108F7+8j
		xor	eax, eax
		inc	eax

loc_1001095F:				; CODE XREF: sub_100108F7+1Fj
					; sub_100108F7+24j ...
		pop	ebp
		retn	8
sub_100108F7	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010963	proc near		; CODE XREF: sub_1001069F+9Dp
					; sub_1001069F+B0p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_8]
		mov	edx, [esp+arg_0]
		push	esi
		lea	esi, [eax+eax]
		mov	[ecx+4], edx
		mov	[ecx], si
		cmp	eax, 0FFFCh
		jbe	short loc_10010984
		xor	al, al
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10010984:				; CODE XREF: sub_10010963+1Bj
		test	edx, edx
		jz	short loc_10010990
		movzx	eax, si
		add	eax, 2
		jmp	short loc_10010992
; ---------------------------------------------------------------------------

loc_10010990:				; CODE XREF: sub_10010963+23j
		xor	eax, eax

loc_10010992:				; CODE XREF: sub_10010963+2Bj
		mov	[ecx+2], ax
		mov	al, 1
		pop	esi
		retn
sub_10010963	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001099A	proc near		; CODE XREF: sub_100109E6+8p
					; sub_10010A05+Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= word ptr  0Ch

		mov	edx, ecx
		push	esi
		mov	eax, [edx+4]
		mov	esi, [edx]
		sub	eax, esi
		cmp	eax, 18h
		jnb	short loc_100109AD
		xor	eax, eax
		jmp	short loc_100109E2
; ---------------------------------------------------------------------------

loc_100109AD:				; CODE XREF: sub_1001099A+Dj
		test	esi, esi
		jz	short loc_100109BE
		push	edi
		push	6
		pop	ecx
		xor	eax, eax
		mov	edi, esi
		rep stosd
		pop	edi
		jmp	short loc_100109C0
; ---------------------------------------------------------------------------

loc_100109BE:				; CODE XREF: sub_1001099A+15j
		xor	esi, esi

loc_100109C0:				; CODE XREF: sub_1001099A+22j
		add	dword ptr [edx], 18h
		mov	ecx, [esp+4+arg_0]
		push	[esp+4+arg_4]
		mov	[esi], ecx
		call	sub_100107D8
		pop	ecx
		mov	cx, [esp+4+arg_8]
		mov	[esi+6], ax
		mov	eax, esi
		mov	[esi+4], cx

loc_100109E2:				; CODE XREF: sub_1001099A+11j
		pop	esi
		retn	0Ch
sub_1001099A	endp


; =============== S U B	R O U T	I N E =======================================


sub_100109E6	proc near		; CODE XREF: sub_1001149D+11p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0
		push	[esp+4+arg_4]
		push	6
		call	sub_1001099A
		mov	ecx, eax
		test	ecx, ecx
		jz	short locret_10010A02
		mov	eax, [esp+arg_0]
		mov	[ecx+8], eax
		mov	eax, ecx

locret_10010A02:			; CODE XREF: sub_100109E6+11j
		retn	8
sub_100109E6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010A05	proc near		; CODE XREF: sub_10011174+4Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	[esp+arg_0]
		push	[esp+4+arg_8]
		push	4
		call	sub_1001099A
		mov	ecx, eax
		test	ecx, ecx
		jz	short locret_10010A23
		mov	eax, [esp+arg_4]
		mov	[ecx+8], eax
		mov	eax, ecx

locret_10010A23:			; CODE XREF: sub_10010A05+13j
		retn	0Ch
sub_10010A05	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010A26	proc near		; CODE XREF: sub_10011174+29p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	[esp+arg_0]
		push	[esp+4+arg_8]
		push	2
		call	sub_1001099A
		mov	ecx, eax
		test	ecx, ecx
		jz	short locret_10010A4B
		mov	eax, [esp+arg_4]
		mov	[ecx+8], eax
		mov	eax, ecx
		mov	dword ptr [ecx+0Ch], 2

locret_10010A4B:			; CODE XREF: sub_10010A26+13j
		retn	0Ch
sub_10010A26	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10010A4E(int, LPCWSTR lpString, int, int, int)
sub_10010A4E	proc near		; CODE XREF: sub_100114C7+BAp
					; sub_100114C7+E5p

arg_0		= dword	ptr  4
lpString	= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		push	edi
		mov	edi, [esp+8+lpString]
		xor	eax, eax
		mov	ebx, ecx
		test	edi, edi
		jz	short loc_10010AC4
		cmp	ax, [edi]
		jz	short loc_10010AC4
		push	ebp
		push	esi
		push	edi		; lpString
		call	ds:lstrlenW
		push	[esp+10h+arg_0]
		mov	ecx, ebx
		mov	ebp, eax
		push	[esp+14h+arg_10]
		push	5
		call	sub_1001099A
		mov	esi, eax
		test	esi, esi
		jz	short loc_10010AA8
		mov	ecx, edi
		lea	edx, [ecx+2]

loc_10010A88:				; CODE XREF: sub_10010A4E+43j
		mov	ax, [ecx]
		add	ecx, 2
		test	ax, ax
		jnz	short loc_10010A88
		sub	ecx, edx
		sar	ecx, 1
		lea	eax, [ecx+1]
		mov	ecx, ebx
		push	eax		; int
		push	edi		; void *
		push	esi		; int
		call	sub_10010834
		test	eax, eax
		jnz	short loc_10010AAC

loc_10010AA8:				; CODE XREF: sub_10010A4E+33j
		xor	eax, eax
		jmp	short loc_10010AC2
; ---------------------------------------------------------------------------

loc_10010AAC:				; CODE XREF: sub_10010A4E+58j
		mov	[esi+8], eax
		mov	eax, [esp+10h+arg_8]
		mov	[esi+10h], eax
		mov	eax, [esp+10h+arg_C]
		mov	[esi+14h], eax
		mov	eax, esi
		mov	[esi+0Ch], ebp

loc_10010AC2:				; CODE XREF: sub_10010A4E+5Cj
		pop	esi
		pop	ebp

loc_10010AC4:				; CODE XREF: sub_10010A4E+Cj
					; sub_10010A4E+11j
		pop	edi
		pop	ebx
		retn	14h
sub_10010A4E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010AC9	proc near		; CODE XREF: sub_100119BE+6Ep
					; sub_100168E1+52p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= byte ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 10h
		push	esi
		mov	esi, ecx
		mov	eax, [esi+8]
		test	eax, eax
		jnz	short loc_10010ADD

loc_10010AD6:				; CODE XREF: sub_10010AC9+18j
		xor	eax, eax
		jmp	loc_10010BA9
; ---------------------------------------------------------------------------

loc_10010ADD:				; CODE XREF: sub_10010AC9+Bj
		xor	edx, edx
		cmp	[eax], edx
		jz	short loc_10010AD6
		test	[esp+14h+arg_0], 2
		jnz	short loc_10010AF2
		push	2
		pop	eax
		jmp	loc_10010BA9
; ---------------------------------------------------------------------------

loc_10010AF2:				; CODE XREF: sub_10010AC9+1Fj
		push	ebx
		push	ebp
		mov	[esp+1Ch+var_8], edx
		mov	bl, dl
		mov	[esp+1Ch+var_4], edx
		mov	[esi], edx
		mov	dword ptr [esi+4], 1
		mov	eax, [eax]
		mov	[esp+1Ch+arg_0], dl
		mov	[esp+1Ch+var_C], eax
		push	edi
		mov	edi, edx
		test	eax, eax
		jz	loc_10010BA4
		mov	ebp, edx

loc_10010B1E:				; CODE XREF: sub_10010AC9+D0j
		mov	eax, [esi+8]
		add	eax, 4
		add	eax, ebp
		cmp	[esp+20h+arg_0], 0
		mov	[esp+20h+var_10], eax
		jz	short loc_10010B4C
		lea	ecx, [esp+20h+arg_0]
		push	ecx
		lea	ecx, [esp+24h+var_8]
		push	ecx
		push	eax
		call	sub_10010BC4
		add	esp, 0Ch
		test	al, al
		jnz	short loc_10010B91
		mov	eax, [esp+20h+var_10]

loc_10010B4C:				; CODE XREF: sub_10010AC9+66j
		lea	ecx, [esp+20h+var_8]
		push	ecx
		push	[esp+24h+arg_8]
		mov	ecx, eax
		push	[esp+28h+arg_4]
		call	sub_1001087A
		xor	edx, edx
		mov	ecx, eax
		sub	eax, edx
		jz	short loc_10010B83
		dec	eax
		jz	short loc_10010B78
		dec	eax
		jz	short loc_10010B91
		xor	eax, eax
		mov	[esi], edi
		mov	[esi+4], ecx
		inc	eax
		jmp	short loc_10010BA6
; ---------------------------------------------------------------------------

loc_10010B78:				; CODE XREF: sub_10010AC9+A0j
		cmp	[esp+20h+var_4], 4
		mov	bl, dl
		jz	short loc_10010B91
		jmp	short loc_10010B8C
; ---------------------------------------------------------------------------

loc_10010B83:				; CODE XREF: sub_10010AC9+9Dj
		cmp	[esp+20h+var_4], 4
		mov	bl, 1
		jnz	short loc_10010B91

loc_10010B8C:				; CODE XREF: sub_10010AC9+B8j
		mov	[esp+20h+arg_0], 1

loc_10010B91:				; CODE XREF: sub_10010AC9+7Dj
					; sub_10010AC9+A3j ...
		inc	edi
		add	ebp, 18h
		cmp	edi, [esp+20h+var_C]
		jnz	short loc_10010B1E
		test	bl, bl
		jz	short loc_10010BA4
		push	2
		pop	eax
		jmp	short loc_10010BA6
; ---------------------------------------------------------------------------

loc_10010BA4:				; CODE XREF: sub_10010AC9+4Dj
					; sub_10010AC9+D4j
		xor	eax, eax

loc_10010BA6:				; CODE XREF: sub_10010AC9+ADj
					; sub_10010AC9+D9j
		pop	edi
		pop	ebp
		pop	ebx

loc_10010BA9:				; CODE XREF: sub_10010AC9+Fj
					; sub_10010AC9+24j
		pop	esi
		add	esp, 10h
		retn	0Ch
sub_10010AC9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010BB0	proc near		; CODE XREF: sub_100119BE+7Ap
					; sub_100168E1+5Fp
		mov	eax, [ecx+4]
		retn
sub_10010BB0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010BB4	proc near		; CODE XREF: sub_100119BE+5Ep
					; sub_100168E1+42p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	[ecx], eax
		mov	eax, [esp+arg_4]
		mov	[ecx+4], eax
		retn	8
sub_10010BB4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010BC4	proc near		; CODE XREF: sub_10010AC9+73p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax], 6
		jnz	short loc_10010BEA
		mov	eax, [esp+arg_4]
		xor	edx, edx
		mov	ecx, [eax+4]
		mov	[eax], edx
		mov	[eax+4], edx
		mov	eax, [esp+arg_8]
		mov	[eax], dl
		xor	eax, eax
		cmp	ecx, 4
		setnz	al
		retn
; ---------------------------------------------------------------------------

loc_10010BEA:				; CODE XREF: sub_10010BC4+7j
		mov	ecx, [esp+arg_8]
		mov	al, 1
		mov	byte ptr [ecx],	1
		retn
sub_10010BC4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010BF4	proc near		; CODE XREF: sub_10010FC8+1Cp

arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		push	edi
		mov	edi, ecx
		mov	eax, [eax]
		mov	[edi], eax
		lea	esi, [edi+4]
		xor	eax, eax
		mov	ecx, esi
		push	eax
		push	eax
		mov	[esi], eax
		mov	[esi+4], eax
		call	sub_10016FBF
		mov	[esi], eax
		mov	eax, edi
		pop	edi
		pop	esi
		retn	0Ch
sub_10010BF4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010C1C	proc near		; CODE XREF: sub_10011688+4p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10010C43
		cmp	eax, 0FFFFFFFh
		ja	short loc_10010C3D
		shl	eax, 4
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10010C43

loc_10010C3D:				; CODE XREF: sub_10010C1C+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_10010C43:				; CODE XREF: sub_10010C1C+8j
					; sub_10010C1C+1Fj
		mov	eax, ecx
		retn
sub_10010C1C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010C46	proc near		; CODE XREF: sub_10019B6D+11p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	[esp+4+arg_4]
		push	[esp+8+arg_0]
		call	sub_10011688
		lea	esi, [eax+8]
		test	esi, esi
		jz	short loc_10010C69
		mov	edx, [esp+4+arg_8]
		mov	ecx, [edx]
		mov	[esi], ecx
		mov	ecx, [edx+4]
		mov	[esi+4], ecx

loc_10010C69:				; CODE XREF: sub_10010C46+13j
		pop	esi
		retn	0Ch
sub_10010C46	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010C6D	proc near		; CODE XREF: sub_1001111E+31p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		call	sub_10009DEF
		push	[ebp+arg_8]
		mov	esi, eax
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		lea	ecx, [esi+10h]
		mov	word ptr [esi+0Ch], 0
		push	ecx
		lea	ecx, [ebp+arg_8+3]
		call	sub_10010FC8
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	0Ch
sub_10010C6D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010C9A	proc near		; CODE XREF: sub_100095AD+45Fp
					; sub_10011356+4Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		push	[esp+0Ch+arg_4]
		push	dword ptr [esi+4]
		push	esi
		call	sub_1001605A
		push	1
		mov	ecx, ebx
		mov	edi, eax
		call	sub_10017F5A
		mov	[esi+4], edi
		mov	ecx, [edi+4]
		mov	[ecx], edi
		pop	edi
		pop	esi
		pop	ebx
		retn	8
sub_10010C9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10010CC9(int, char,	int, int, void *)
sub_10010CC9	proc near		; CODE XREF: sub_10010DF5+1Bp
					; sub_10010DF5+E0p ...

var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 9249248h
		jb	short loc_10010CF9
		mov	esi, [ebp+arg_10]
		lea	ecx, [esi+10h]
		call	sub_100110B8
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	[esp+10h+var_10], offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10010CF9:				; CODE XREF: sub_10010CC9+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_10010D1A
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_10010D39
; ---------------------------------------------------------------------------

loc_10010D1A:				; CODE XREF: sub_10010CC9+41j
		cmp	[ebp+arg_4], 0
		jz	short loc_10010D2C
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_10010D39
		mov	[ecx], edi
		jmp	short loc_10010D39
; ---------------------------------------------------------------------------

loc_10010D2C:				; CODE XREF: sub_10010CC9+55j
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_10010D39
		mov	[ecx+8], edi

loc_10010D39:				; CODE XREF: sub_10010CC9+4Fj
					; sub_10010CC9+5Dj ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_10010DD6
; ---------------------------------------------------------------------------

loc_10010D43:				; CODE XREF: sub_10010CC9+111j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_10010D87
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_10010D8D
		cmp	esi, [eax+8]
		jnz	short loc_10010D67
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_100057C3

loc_10010D67:				; CODE XREF: sub_10010CC9+92j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10009EBF
		jmp	short loc_10010DD3
; ---------------------------------------------------------------------------

loc_10010D87:				; CODE XREF: sub_10010CC9+84j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10010DA7

loc_10010D8D:				; CODE XREF: sub_10010CC9+8Dj
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_10010DD3
; ---------------------------------------------------------------------------

loc_10010DA7:				; CODE XREF: sub_10010CC9+C2j
		cmp	esi, [eax]
		jnz	short loc_10010DB5
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10009EBF

loc_10010DB5:				; CODE XREF: sub_10010CC9+E0j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_100057C3

loc_10010DD3:				; CODE XREF: sub_10010CC9+BCj
					; sub_10010CC9+DCj
		mov	eax, [esi+4]

loc_10010DD6:				; CODE XREF: sub_10010CC9+75j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10010D43
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_10010CC9	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10010DF5(int, int, int, void *)
sub_10010DF5	proc near		; CODE XREF: sub_1001111E+42p

var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 0
		jnz	short loc_10010E1E
		push	[esp+0Ch+arg_C]	; void *
		push	[esp+10h+arg_8]	; int
		push	dword ptr [edi]	; int
		push	1		; char
		push	[esp+1Ch+arg_0]	; int
		call	sub_10010CC9
		mov	eax, [esp+0Ch+arg_0]
		jmp	loc_10010EFE
; ---------------------------------------------------------------------------

loc_10010E1E:				; CODE XREF: sub_10010DF5+9j
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		push	ebp
		mov	ebp, [edi]
		push	esi
		mov	esi, [esp+18h+arg_4]
		cmp	esi, [ebp+0]
		jnz	short loc_10010E46
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	loc_10010EE0
		push	[esp+18h+arg_C]
		push	ebx

loc_10010E40:				; CODE XREF: sub_10010DF5+9Cj
		push	esi
		jmp	loc_10010ECF
; ---------------------------------------------------------------------------

loc_10010E46:				; CODE XREF: sub_10010DF5+39j
		cmp	esi, ebp
		jnz	short loc_10010E64
		mov	ecx, [ebp+8]
		mov	eax, [ecx+10h]
		cmp	eax, [ebx]
		jnb	loc_10010EE0
		push	[esp+18h+arg_C]
		push	ebx
		push	ecx
		push	0
		mov	ecx, edi
		jmp	short loc_10010ED1
; ---------------------------------------------------------------------------

loc_10010E64:				; CODE XREF: sub_10010DF5+53j
		mov	eax, [ebx]
		cmp	[esi+10h], eax
		jbe	short loc_10010E9B
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], esi
		call	sub_1000911E
		mov	eax, [esp+18h+arg_8]
		mov	ecx, [ebx]
		cmp	[eax+10h], ecx
		jnb	short loc_10010E96
		mov	ecx, [eax+8]
		push	[esp+18h+arg_C]
		push	ebx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10010E40
		push	eax
		jmp	short loc_10010ECA
; ---------------------------------------------------------------------------

loc_10010E96:				; CODE XREF: sub_10010DF5+8Cj
		mov	eax, ecx
		cmp	[esi+10h], eax

loc_10010E9B:				; CODE XREF: sub_10010DF5+74j
		jnb	short loc_10010EE0
		lea	ecx, [esp+18h+arg_8]
		mov	[esp+18h+arg_8], esi
		call	sub_1000CDCC
		mov	eax, [esp+18h+arg_8]
		cmp	eax, ebp
		jz	short loc_10010EB9
		mov	ecx, [ebx]
		cmp	ecx, [eax+10h]
		jnb	short loc_10010EE0

loc_10010EB9:				; CODE XREF: sub_10010DF5+BBj
		mov	ecx, [esi+8]
		push	[esp+18h+arg_C]	; void *
		push	ebx		; int
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10010ECE
		push	esi

loc_10010ECA:				; CODE XREF: sub_10010DF5+9Fj
		push	0
		jmp	short loc_10010ED1
; ---------------------------------------------------------------------------

loc_10010ECE:				; CODE XREF: sub_10010DF5+D2j
		push	eax		; int

loc_10010ECF:				; CODE XREF: sub_10010DF5+4Cj
		push	1		; char

loc_10010ED1:				; CODE XREF: sub_10010DF5+6Dj
					; sub_10010DF5+D7j
		push	[esp+28h+arg_0]	; int
		call	sub_10010CC9
		mov	eax, [esp+18h+arg_0]
		jmp	short loc_10010EFB
; ---------------------------------------------------------------------------

loc_10010EE0:				; CODE XREF: sub_10010DF5+40j
					; sub_10010DF5+5Dj ...
		push	[esp+18h+arg_C]	; void *
		lea	eax, [esp+1Ch+var_8]
		mov	ecx, edi
		push	ebx		; int
		push	0		; int
		push	eax		; int
		call	sub_10010F04
		mov	ecx, [eax]
		mov	eax, [esp+18h+arg_0]
		mov	[eax], ecx

loc_10010EFB:				; CODE XREF: sub_10010DF5+E9j
		pop	esi
		pop	ebp
		pop	ebx

loc_10010EFE:				; CODE XREF: sub_10010DF5+24j
		pop	edi
		pop	ecx
		pop	ecx
		retn	10h
sub_10010DF5	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10010F04(int, int, int, void *)
sub_10010F04	proc near		; CODE XREF: sub_10010DF5+F9p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	dl, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], dl
		push	esi
		push	edi
		mov	ecx, [ebp+0]
		mov	edi, ecx
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10010F53
		mov	esi, [ebx]
		mov	dh, byte ptr [esp+14h+arg_4]

loc_10010F29:				; CODE XREF: sub_10010F04+4Dj
		mov	edi, eax
		test	dh, dh
		jz	short loc_10010F38
		cmp	[eax+10h], esi
		sbb	dl, dl
		inc	dl
		jmp	short loc_10010F3E
; ---------------------------------------------------------------------------

loc_10010F38:				; CODE XREF: sub_10010F04+29j
		cmp	esi, [eax+10h]
		setb	dl

loc_10010F3E:				; CODE XREF: sub_10010F04+32j
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_10010F4A
		mov	eax, [eax]
		jmp	short loc_10010F4D
; ---------------------------------------------------------------------------

loc_10010F4A:				; CODE XREF: sub_10010F04+40j
		mov	eax, [eax+8]

loc_10010F4D:				; CODE XREF: sub_10010F04+44j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10010F29

loc_10010F53:				; CODE XREF: sub_10010F04+1Dj
		mov	esi, edi
		mov	[esp+14h+arg_4], esi
		test	dl, dl
		jz	short loc_10010F90
		cmp	edi, [ecx]
		jnz	short loc_10010F83
		push	[esp+14h+arg_C]	; void *
		push	ebx		; int
		push	edi		; int
		push	1		; char

loc_10010F69:				; CODE XREF: sub_10010F04+9Dj
		lea	eax, [esp+24h+arg_4]
		mov	ecx, ebp
		push	eax		; int
		call	sub_10010CC9
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_10010FC0
; ---------------------------------------------------------------------------

loc_10010F83:				; CODE XREF: sub_10010F04+5Bj
		lea	ecx, [esp+14h+arg_4]
		call	sub_1000911E
		mov	esi, [esp+14h+arg_4]

loc_10010F90:				; CODE XREF: sub_10010F04+57j
		mov	eax, [esi+10h]
		cmp	eax, [ebx]
		jnb	short loc_10010FA3
		push	[esp+14h+arg_C]
		push	ebx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_10010F69
; ---------------------------------------------------------------------------

loc_10010FA3:				; CODE XREF: sub_10010F04+91j
		mov	edi, [esp+14h+arg_C]
		lea	ecx, [edi+10h]
		call	sub_100110B8
		push	edi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_10010FC0:				; CODE XREF: sub_10010F04+7Dj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_10010F04	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010FC8	proc near		; CODE XREF: sub_10010C6D+21p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		test	ecx, ecx
		jz	short loc_10010FE9
		mov	eax, [ebp+arg_8]
		push	ecx
		push	ecx
		mov	edx, esp
		mov	eax, [eax]
		mov	[edx], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		push	eax
		call	sub_10010BF4

loc_10010FE9:				; CODE XREF: sub_10010FC8+8j
		pop	ebp
		retn	10h
sub_10010FC8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010FED	proc near		; CODE XREF: sub_100111C8+25p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, ecx
		cmp	esi, edi
		jz	short loc_1001104C
		mov	eax, [edi+8]
		push	ebx
		mov	[esi+8], eax
		mov	ebx, 101Ch
		mov	al, [edi+0Ch]
		push	ebx
		mov	[esi+0Ch], al
		call	sub_1001AAE8
		push	ebx		; size_t
		mov	[esi], eax
		push	dword ptr [edi]	; void *
		push	eax		; void *
		call	memcpy
		mov	ecx, [esi]
		push	8		; unsigned int
		imul	eax, [ecx], 18h
		lea	ebx, [ecx+4]
		add	ebx, eax
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 14h
		test	eax, eax
		jz	short loc_10011046
		mov	ecx, [edi+4]
		mov	edx, [ecx+4]
		sub	edx, [ecx]
		mov	[eax], ebx
		lea	ecx, [edx+ebx]
		mov	[eax+4], ecx
		jmp	short loc_10011048
; ---------------------------------------------------------------------------

loc_10011046:				; CODE XREF: sub_10010FED+45j
		xor	eax, eax

loc_10011048:				; CODE XREF: sub_10010FED+57j
		mov	[esi+4], eax
		pop	ebx

loc_1001104C:				; CODE XREF: sub_10010FED+Aj
		pop	edi
		mov	eax, esi
		pop	esi
		retn	4
sub_10010FED	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011053	proc near		; CODE XREF: sub_1000BFCD+BEp
					; sub_1000BFCD+C8p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	101Ch
		mov	[esi+8], eax
		mov	byte ptr [esi+0Ch], 0
		call	sub_1001AAE8
		mov	[esi], eax
		push	8		; unsigned int
		and	dword ptr [eax], 0
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001108F
		mov	ecx, [esi]
		add	ecx, 4
		mov	[eax], ecx
		add	ecx, 1018h
		mov	[eax+4], ecx
		jmp	short loc_10011091
; ---------------------------------------------------------------------------

loc_1001108F:				; CODE XREF: sub_10011053+28j
		xor	eax, eax

loc_10011091:				; CODE XREF: sub_10011053+3Aj
		mov	[esi+4], eax
		mov	eax, esi
		pop	esi
		retn	4
sub_10011053	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001109A	proc near		; CODE XREF: sub_10011356+138p

var_4		= dword	ptr -4

		push	ecx
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	eax		; int
		push	dword ptr [eax]	; void *
		lea	eax, [esp+10h+var_4]
		push	eax		; int
		call	sub_1001173B
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	esi
		pop	ecx
		retn
sub_1001109A	endp


; =============== S U B	R O U T	I N E =======================================


sub_100110B8	proc near		; CODE XREF: sub_10010CC9+18p
					; sub_10010F04+A6p ...
		push	esi
		lea	esi, [ecx+4]
		mov	ecx, esi
		call	sub_10011712
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_100110B8	endp


; =============== S U B	R O U T	I N E =======================================


sub_100110CD	proc near		; CODE XREF: sub_1001627A+A8p
		push	esi
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_100110F6
		push	ebx

loc_100110DA:				; CODE XREF: sub_100110CD+26j
		mov	ebx, [esi+8]
		test	ebx, ebx
		jz	short loc_100110EF
		mov	ecx, ebx
		call	sub_10011108
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_100110EF:				; CODE XREF: sub_100110CD+12j
		mov	esi, [esi]
		cmp	esi, [edi]
		jnz	short loc_100110DA
		pop	ebx

loc_100110F6:				; CODE XREF: sub_100110CD+Aj
		mov	ecx, edi
		call	sub_10011712
		push	dword ptr [edi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	edi
		pop	esi
		retn
sub_100110CD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011108	proc near		; CODE XREF: sub_1000BFCD+244p
					; sub_1000BFCD+24Dp ...
		push	esi
		mov	esi, ecx
		push	dword ptr [esi]	; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		push	dword ptr [esi+4] ; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	ecx
		pop	esi
		retn
sub_10011108	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001111E	proc near		; CODE XREF: sub_10011356+3Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		push	ebx
		mov	edi, ecx
		call	sub_1000576A
		mov	esi, eax
		cmp	esi, [edi]
		jz	short loc_1001113D
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	short loc_10011168

loc_1001113D:				; CODE XREF: sub_1001111E+16j
		lea	eax, [ebp+arg_0+3]
		mov	[ebp+var_4], ebx
		push	eax
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		push	offset byte_10033D09
		call	sub_10010C6D
		push	eax		; void *
		add	eax, 10h
		mov	ecx, edi
		push	eax		; int
		push	esi		; int
		lea	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_10010DF5
		mov	esi, [ebp+arg_0]

loc_10011168:				; CODE XREF: sub_1001111E+1Dj
		pop	edi
		lea	eax, [esi+14h]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1001111E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011174	proc near		; CODE XREF: sub_1000BFCD+110p
					; sub_1000BFCD+120p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ecx
		cmp	byte ptr [esi+0Ch], 0
		jz	short loc_10011184

loc_10011180:				; CODE XREF: sub_10011174+30j
		xor	al, al
		jmp	short loc_100111AC
; ---------------------------------------------------------------------------

loc_10011184:				; CODE XREF: sub_10011174+Aj
		xor	eax, eax
		cmp	[ebp+arg_0], 1
		setz	al
		cmp	[ebp+arg_C], 0
		jnz	short loc_100111B1
		mov	ecx, [esi+4]
		push	eax
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	sub_10010A26

loc_100111A2:				; CODE XREF: sub_10011174+52j
		test	eax, eax
		jz	short loc_10011180

loc_100111A6:				; CODE XREF: sub_10011174+41j
		mov	ecx, [esi]
		mov	al, 1
		inc	dword ptr [ecx]

loc_100111AC:				; CODE XREF: sub_10011174+Ej
		pop	esi
		pop	ebp
		retn	10h
; ---------------------------------------------------------------------------

loc_100111B1:				; CODE XREF: sub_10011174+1Dj
		cmp	[ebp+arg_C], 1
		jnz	short loc_100111A6
		mov	ecx, [esi+4]
		push	eax
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	sub_10010A05
		jmp	short loc_100111A2
sub_10011174	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100111C8	proc near		; CODE XREF: sub_1000BFCD+179p
					; sub_1000BFCD+1ACp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, ecx
		mov	ecx, [ebp+arg_4]
		call	sub_1001149D
		test	al, al
		jz	short loc_1001120E
		push	10h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100111F4
		push	[ebp+arg_4]
		mov	ecx, eax
		call	sub_10010FED
		jmp	short loc_100111F6
; ---------------------------------------------------------------------------

loc_100111F4:				; CODE XREF: sub_100111C8+1Ej
		xor	eax, eax

loc_100111F6:				; CODE XREF: sub_100111C8+2Aj
		mov	[ebp+var_8], eax
		mov	ecx, esi
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_8]
		push	eax
		push	dword ptr [esi]
		call	sub_10019B6D
		mov	al, 1

loc_1001120E:				; CODE XREF: sub_100111C8+12j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_100111C8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011215	proc near		; CODE XREF: sub_1000BFCD+163p
					; sub_1000BFCD+196p ...

var_20		= dword	ptr -20h
var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+20h+var_4], eax
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+0Ch], 0
		jz	short loc_10011233
		xor	al, al
		jmp	loc_10011344
; ---------------------------------------------------------------------------

loc_10011233:				; CODE XREF: sub_10011215+15j
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+30h+arg_8]
		xor	eax, eax
		and	[esp+30h+var_20], eax
		xor	ecx, ecx
		and	[esp+30h+var_C], eax
		xor	ebx, ebx
		mov	[esp+30h+var_8], 7
		mov	[esp+30h+var_1C], cx
		cmp	cx, [esi]
		jz	loc_10011308
		push	3Fh
		pop	ebp

loc_10011261:				; CODE XREF: sub_10011215+EDj
		movzx	ecx, word ptr [esi]
		cmp	ecx, 2Ah
		jz	short loc_100112CC
		cmp	ecx, 2Fh
		jz	short loc_100112AF
		cmp	ecx, ebp
		jnz	short loc_100112B8
		cmp	eax, 6
		jz	loc_1001132C
		lea	eax, [esp+30h+var_1C]
		mov	ecx, edi
		push	eax
		lea	eax, [esp+34h+var_20]
		push	eax
		push	0
		push	ebx
		push	[esp+40h+arg_4]
		push	[esp+44h+arg_C]
		push	[esp+48h+arg_0]
		call	sub_100114C7
		test	al, al
		jz	loc_1001132C
		inc	[esp+30h+var_20]
		push	0Ah
		pop	eax
		push	2
		pop	ebx
		jmp	short loc_100112FA
; ---------------------------------------------------------------------------

loc_100112AF:				; CODE XREF: sub_10011215+57j
		cmp	bp, [esi+2]
		jnz	short loc_100112B8
		add	esi, 2

loc_100112B8:				; CODE XREF: sub_10011215+5Bj
					; sub_10011215+9Ej
		movzx	eax, word ptr [esi]
		lea	ecx, [esp+30h+var_1C]
		push	eax
		push	1
		call	sub_100037D9
		xor	eax, eax
		inc	eax
		jmp	short loc_100112FA
; ---------------------------------------------------------------------------

loc_100112CC:				; CODE XREF: sub_10011215+52j
		test	al, 2
		jnz	short loc_1001132C
		lea	eax, [esp+30h+var_1C]
		mov	ecx, edi
		push	eax
		lea	eax, [esp+34h+var_20]
		push	eax
		push	0
		push	ebx
		push	[esp+40h+arg_4]
		push	[esp+44h+arg_C]
		push	[esp+48h+arg_0]
		call	sub_100114C7
		test	al, al
		jz	short loc_1001132C
		push	6
		xor	ebx, ebx
		pop	eax
		inc	ebx

loc_100112FA:				; CODE XREF: sub_10011215+98j
					; sub_10011215+B5j
		add	esi, 2
		xor	ecx, ecx
		cmp	cx, [esi]
		jnz	loc_10011261

loc_10011308:				; CODE XREF: sub_10011215+43j
		lea	eax, [esp+30h+var_1C]
		mov	ecx, edi
		push	eax
		lea	eax, [esp+34h+var_20]
		push	eax
		push	1
		push	ebx
		push	[esp+40h+arg_4]
		push	[esp+44h+arg_C]
		push	[esp+48h+arg_0]
		call	sub_100114C7
		test	al, al
		jnz	short loc_10011330

loc_1001132C:				; CODE XREF: sub_10011215+60j
					; sub_10011215+88j ...
		xor	bl, bl
		jmp	short loc_10011332
; ---------------------------------------------------------------------------

loc_10011330:				; CODE XREF: sub_10011215+115j
		mov	bl, 1

loc_10011332:				; CODE XREF: sub_10011215+119j
		push	0		; int
		push	1		; char
		lea	ecx, [esp+38h+var_1C] ;	void *
		call	sub_100022C1
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx

loc_10011344:				; CODE XREF: sub_10011215+19j
		mov	ecx, [esp+24h+var_4]
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 20h
		retn	10h
sub_10011215	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011356	proc near		; CODE XREF: sub_1001664B+13p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 24h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		lea	ecx, [esp+34h+var_8]
		mov	[esp+34h+var_C], edi
		mov	[esp+34h+var_8], ebx
		mov	[esp+34h+var_4], ebx
		call	sub_10009D69
		mov	edx, eax
		mov	eax, [edi]
		mov	[esp+34h+var_8], edx
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_100113B0

loc_10011384:				; CODE XREF: sub_10011356+54j
		mov	eax, [esi+0Ch]
		lea	ecx, [esp+34h+var_8]
		mov	[esp+34h+var_14], eax
		lea	eax, [esp+34h+var_14]
		push	eax
		call	sub_1001111E
		mov	ecx, eax
		lea	eax, [esi+8]
		push	eax
		push	dword ptr [ecx]
		call	sub_10010C9A
		mov	esi, [esi]
		cmp	esi, [edi]
		jnz	short loc_10011384
		mov	edx, [esp+34h+var_8]

loc_100113B0:				; CODE XREF: sub_10011356+2Cj
		mov	eax, [edi+8]
		mov	ebp, [eax+80h]
		lea	esi, [eax+84h]
		mov	[esp+34h+var_20], esi
		lea	eax, [esi+ebp]
		mov	[esp+34h+var_24], eax
		mov	eax, [edx]
		mov	[esp+34h+var_14], eax
		cmp	eax, edx
		jz	loc_10011488

loc_100113D8:				; CODE XREF: sub_10011356+12Cj
		mov	edx, [eax+10h]
		cmp	edx, 20h
		jnb	loc_1001148A
		mov	ecx, [edi+8]
		mov	[ecx+edx*4], esi
		mov	ecx, ebx
		mov	edi, [eax+14h]
		mov	esi, [edi]
		jmp	short loc_1001144A
; ---------------------------------------------------------------------------

loc_100113F3:				; CODE XREF: sub_10011356+FAj
		mov	eax, [esi+8]
		mov	eax, [eax]
		mov	eax, [eax]
		imul	edx, eax, 18h
		mov	[esp+34h+var_10], eax
		cmp	ebp, edx
		jb	loc_1001148A
		mov	eax, ebp
		sub	eax, edx
		mov	[esp+34h+var_1C], eax
		lea	eax, [esp+34h+var_1C]
		push	eax
		push	[esp+38h+var_24]
		imul	eax, ecx, 18h
		mov	ecx, [esp+3Ch+var_20]
		add	ecx, 4
		push	edx
		add	eax, ecx
		mov	ecx, [esi+8]
		push	eax
		call	sub_100115D6
		test	al, al
		jz	short loc_1001148A
		mov	ecx, [esp+34h+var_18]
		mov	eax, ebp
		sub	eax, [esp+34h+var_1C]
		sub	[esp+34h+var_24], eax
		sub	ebp, eax
		add	ecx, [esp+34h+var_10]
		mov	esi, [esi]

loc_1001144A:				; CODE XREF: sub_10011356+9Bj
		mov	[esp+34h+var_18], ecx
		cmp	esi, edi
		jnz	short loc_100113F3
		mov	esi, [esp+34h+var_20]
		xor	edx, edx
		imul	eax, ecx, 18h
		push	1Ch
		add	[esi], ecx
		pop	ecx
		div	ecx
		add	esi, ecx
		lea	ecx, [esp+34h+var_14]
		imul	eax, 1Ch
		add	esi, eax
		mov	[esp+34h+var_20], esi
		call	sub_1000CDCC
		mov	eax, [esp+34h+var_14]
		mov	edi, [esp+34h+var_C]
		cmp	eax, [esp+34h+var_8]
		jnz	loc_100113D8

loc_10011488:				; CODE XREF: sub_10011356+7Cj
		mov	bl, 1

loc_1001148A:				; CODE XREF: sub_10011356+88j
					; sub_10011356+ADj ...
		lea	ecx, [esp+34h+var_8]
		call	sub_1001109A
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		add	esp, 24h
		retn
sub_10011356	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001149D	proc near		; CODE XREF: sub_100111C8+Bp
		push	esi
		mov	esi, ecx
		cmp	byte ptr [esi+0Ch], 0
		jnz	short loc_100114C3
		mov	ecx, [esi+4]
		push	0
		push	dword ptr [esi+8]
		call	sub_100109E6
		test	eax, eax
		jnz	short loc_100114BB
		xor	al, al
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100114BB:				; CODE XREF: sub_1001149D+18j
		mov	eax, [esi]
		inc	dword ptr [eax]
		mov	byte ptr [esi+0Ch], 1

loc_100114C3:				; CODE XREF: sub_1001149D+7j
		mov	al, 1
		pop	esi
		retn
sub_1001149D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100114C7	proc near		; CODE XREF: sub_10011215+81p
					; sub_10011215+D6p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= byte ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	dl, [esp+arg_10]
		push	ebx
		push	ebp
		xor	ebp, ebp
		mov	ebx, ecx
		mov	eax, ebp
		push	esi
		push	edi
		test	dl, dl
		jz	short loc_100114E7
		mov	eax, [esp+10h+arg_0]
		dec	eax
		neg	eax
		sbb	eax, eax
		add	eax, 3
		jmp	short loc_100114F1
; ---------------------------------------------------------------------------

loc_100114E7:				; CODE XREF: sub_100114C7+10j
		cmp	[esp+10h+arg_0], 1
		jnz	short loc_100114F1
		push	5
		pop	eax

loc_100114F1:				; CODE XREF: sub_100114C7+1Ej
					; sub_100114C7+25j
		mov	edi, [esp+10h+arg_18]
		cmp	[edi+10h], ebp
		jnz	short loc_10011522
		test	dl, dl
		jz	loc_100115CD
		mov	edi, [ebx]
		mov	ecx, [edi]
		test	ecx, ecx
		jz	loc_100115CD
		push	eax
		imul	esi, ecx, 18h
		call	sub_100107D8
		pop	ecx
		mov	[esi+edi-0Eh], ax
		jmp	loc_100115CD
; ---------------------------------------------------------------------------

loc_10011522:				; CODE XREF: sub_100114C7+31j
		cmp	[esp+10h+arg_C], 1
		jnz	short loc_1001155B
		test	dl, dl
		jz	short loc_10011546
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10011537
		mov	ecx, [edi]
		jmp	short loc_10011539
; ---------------------------------------------------------------------------

loc_10011537:				; CODE XREF: sub_100114C7+6Aj
		mov	ecx, edi

loc_10011539:				; CODE XREF: sub_100114C7+6Ej
		push	eax
		push	[esp+14h+arg_4]
		push	0FFFFFh

loc_10011543:				; CODE XREF: sub_100114C7+92j
		push	ecx
		jmp	short loc_100115A5
; ---------------------------------------------------------------------------

loc_10011546:				; CODE XREF: sub_100114C7+64j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10011550
		mov	ecx, [edi]
		jmp	short loc_10011552
; ---------------------------------------------------------------------------

loc_10011550:				; CODE XREF: sub_100114C7+83j
		mov	ecx, edi

loc_10011552:				; CODE XREF: sub_100114C7+87j
		push	eax
		push	[esp+14h+arg_4]
		push	0FFFFFFFFh
		jmp	short loc_10011543
; ---------------------------------------------------------------------------

loc_1001155B:				; CODE XREF: sub_100114C7+60j
		cmp	[esp+10h+arg_C], 2
		jnz	short loc_1001158A
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1001156C
		mov	ecx, [edi]
		jmp	short loc_1001156E
; ---------------------------------------------------------------------------

loc_1001156C:				; CODE XREF: sub_100114C7+9Fj
		mov	ecx, edi

loc_1001156E:				; CODE XREF: sub_100114C7+A3j
		mov	esi, [esp+10h+arg_14]
		push	eax		; int
		push	[esp+14h+arg_4]	; int
		push	dword ptr [esi]	; int
		push	ecx		; lpString
		push	[esp+20h+arg_8]	; int
		mov	ecx, [ebx+4]
		call	sub_10010A4E
		mov	[esi], ebp
		jmp	short loc_100115B1
; ---------------------------------------------------------------------------

loc_1001158A:				; CODE XREF: sub_100114C7+99j
		mov	ecx, [esp+10h+arg_4]
		test	dl, dl
		jz	short loc_10011595
		or	ecx, 2

loc_10011595:				; CODE XREF: sub_100114C7+C9j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1001159F
		mov	edx, [edi]
		jmp	short loc_100115A1
; ---------------------------------------------------------------------------

loc_1001159F:				; CODE XREF: sub_100114C7+D2j
		mov	edx, edi

loc_100115A1:				; CODE XREF: sub_100114C7+D6j
		push	eax		; int
		push	ecx		; int
		push	ebp		; int
		push	edx		; lpString

loc_100115A5:				; CODE XREF: sub_100114C7+7Dj
		push	[esp+20h+arg_8]	; int
		mov	ecx, [ebx+4]
		call	sub_10010A4E

loc_100115B1:				; CODE XREF: sub_100114C7+C1j
		test	eax, eax
		jnz	short loc_100115B9
		xor	al, al
		jmp	short loc_100115CF
; ---------------------------------------------------------------------------

loc_100115B9:				; CODE XREF: sub_100114C7+ECj
		mov	eax, [ebx]
		inc	dword ptr [eax]
		cmp	dword ptr [edi+14h], 8
		mov	[edi+10h], ebp
		jb	short loc_100115C8
		mov	edi, [edi]

loc_100115C8:				; CODE XREF: sub_100114C7+FDj
		xor	eax, eax
		mov	[edi], ax

loc_100115CD:				; CODE XREF: sub_100114C7+35j
					; sub_100114C7+41j ...
		mov	al, 1

loc_100115CF:				; CODE XREF: sub_100114C7+F0j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	1Ch
sub_100114C7	endp


; =============== S U B	R O U T	I N E =======================================


sub_100115D6	proc near		; CODE XREF: sub_10011356+D5p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		mov	edx, ecx
		push	ebx
		push	ebp
		push	esi
		mov	eax, [edx]
		xor	ebx, ebx
		push	edi
		mov	[esp+1Ch+var_4], edx
		mov	eax, [eax]
		mov	[esp+1Ch+var_8], eax
		test	eax, eax
		jz	loc_1001167C
		mov	ebp, [esp+1Ch+arg_0]
		mov	ecx, ebx
		mov	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+var_C], ecx

loc_10011603:				; CODE XREF: sub_100115D6+A0j
		cmp	eax, 18h
		jb	short loc_10011678
		mov	edx, [edx]
		add	ecx, 4
		add	edx, ecx
		mov	edi, ebp
		push	6
		pop	ecx
		mov	esi, edx
		rep movsd
		cmp	dword ptr [edx], 5
		jnz	short loc_10011652
		mov	esi, [esp+1Ch+arg_C]
		mov	eax, [edx+0Ch]
		mov	edi, [edx+8]
		add	eax, eax
		mov	ecx, [esi]
		cmp	ecx, eax
		jb	short loc_10011678
		sub	ecx, eax
		mov	[esi], ecx
		mov	esi, [esp+1Ch+arg_8]
		sub	esi, eax
		push	eax		; size_t
		lea	eax, [edi+edx]
		mov	[esp+20h+arg_8], esi
		push	eax		; void *
		push	esi		; void *
		call	memcpy
		mov	eax, esi
		add	esp, 0Ch
		sub	eax, ebp
		mov	[ebp+8], eax

loc_10011652:				; CODE XREF: sub_100115D6+45j
		mov	eax, [esp+1Ch+arg_4]
		add	ebp, 18h
		mov	ecx, [esp+1Ch+var_C]
		sub	eax, 18h
		inc	ebx
		mov	[esp+1Ch+arg_4], eax
		add	ecx, 18h
		mov	[esp+1Ch+var_C], ecx
		cmp	ebx, [esp+1Ch+var_8]
		jz	short loc_1001167C
		mov	edx, [esp+1Ch+var_4]
		jmp	short loc_10011603
; ---------------------------------------------------------------------------

loc_10011678:				; CODE XREF: sub_100115D6+30j
					; sub_100115D6+57j
		xor	al, al
		jmp	short loc_1001167E
; ---------------------------------------------------------------------------

loc_1001167C:				; CODE XREF: sub_100115D6+19j
					; sub_100115D6+9Aj
		mov	al, 1

loc_1001167E:				; CODE XREF: sub_100115D6+A4j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn	10h
sub_100115D6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011688	proc near		; CODE XREF: sub_10008F65+18p
					; sub_10010C46+9p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0
		push	1
		call	sub_10010C1C
		pop	ecx
		pop	ecx
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_100116A1
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_100116A5
; ---------------------------------------------------------------------------

loc_100116A1:				; CODE XREF: sub_10011688+11j
		mov	edx, [esp+arg_4]

loc_100116A5:				; CODE XREF: sub_10011688+17j
		test	eax, eax
		jz	short loc_100116AB
		mov	[eax], ecx

loc_100116AB:				; CODE XREF: sub_10011688+1Fj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_100116B4
		mov	[ecx], edx

locret_100116B4:			; CODE XREF: sub_10011688+28j
		retn	8
sub_10011688	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100116B7(void *)
sub_100116B7	proc near		; CODE XREF: sub_100116B7+16p
					; sub_100116F1+8p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, esi
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_100116EB

loc_100116C8:				; CODE XREF: sub_100116B7+32j
		push	dword ptr [edi+8] ; void *
		mov	ecx, ebx
		call	sub_100116B7
		mov	edi, [edi]
		lea	ecx, [esi+10h]
		call	sub_100110B8
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, edi
		pop	ecx
		jz	short loc_100116C8

loc_100116EB:				; CODE XREF: sub_100116B7+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_100116B7	endp


; =============== S U B	R O U T	I N E =======================================


sub_100116F1	proc near		; CODE XREF: sub_1001173B+16p
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4] ; void *
		call	sub_100116B7
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		and	dword ptr [esi+4], 0
		pop	esi
		retn
sub_100116F1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011712	proc near		; CODE XREF: sub_10008FB1+105p
					; sub_100110B8+6p ...
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		mov	ecx, [eax]
		mov	[eax], eax
		mov	eax, [edi]
		mov	[eax+4], eax
		and	dword ptr [edi+4], 0
		cmp	ecx, [edi]
		jz	short loc_10011739
		push	esi

loc_10011729:				; CODE XREF: sub_10011712+24j
		mov	esi, [ecx]
		push	ecx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		mov	ecx, esi
		cmp	esi, [edi]
		jnz	short loc_10011729
		pop	esi

loc_10011739:				; CODE XREF: sub_10011712+14j
		pop	edi
		retn
sub_10011712	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1001173B(int, void *, int)
sub_1001173B	proc near		; CODE XREF: sub_1001109A+Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		cmp	esi, [eax]
		jnz	short loc_10011778
		cmp	[ebp+arg_8], eax
		jnz	short loc_10011778
		call	sub_100116F1
		mov	eax, [edi]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		jmp	short loc_10011782
; ---------------------------------------------------------------------------

loc_10011761:				; CODE XREF: sub_1001173B+40j
		lea	ecx, [ebp+arg_4]
		call	sub_1000CDCC
		push	esi		; void *
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax		; int
		call	sub_1001178A
		mov	esi, [ebp+arg_4]

loc_10011778:				; CODE XREF: sub_1001173B+Fj
					; sub_1001173B+14j
		cmp	esi, [ebp+arg_8]
		jnz	short loc_10011761
		mov	eax, [ebp+arg_0]
		mov	[eax], esi

loc_10011782:				; CODE XREF: sub_1001173B+24j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1001173B	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1001178A(int, void *)
sub_1001178A	proc near		; CODE XREF: sub_1001173B+35p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		push	esi
		mov	ebp, ecx
		lea	ecx, [esp+0Ch+arg_4]
		push	edi
		call	sub_1000CDCC
		mov	ecx, [ebx]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_100117AA
		mov	edi, [ebx+8]
		jmp	short loc_100117C2
; ---------------------------------------------------------------------------

loc_100117AA:				; CODE XREF: sub_1001178A+19j
		mov	eax, [ebx+8]
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_100117B7
		mov	edi, ecx
		jmp	short loc_100117C2
; ---------------------------------------------------------------------------

loc_100117B7:				; CODE XREF: sub_1001178A+27j
		mov	edx, [esp+10h+arg_4]
		mov	edi, [edx+8]
		cmp	edx, ebx
		jnz	short loc_10011832

loc_100117C2:				; CODE XREF: sub_1001178A+1Ej
					; sub_1001178A+2Bj
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [ebx+4]
		jnz	short loc_100117CE
		mov	[edi+4], esi

loc_100117CE:				; CODE XREF: sub_1001178A+3Fj
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_100117DB
		mov	[eax+4], edi
		jmp	short loc_100117E6
; ---------------------------------------------------------------------------

loc_100117DB:				; CODE XREF: sub_1001178A+4Aj
		cmp	[esi], ebx
		jnz	short loc_100117E3
		mov	[esi], edi
		jmp	short loc_100117E6
; ---------------------------------------------------------------------------

loc_100117E3:				; CODE XREF: sub_1001178A+53j
		mov	[esi+8], edi

loc_100117E6:				; CODE XREF: sub_1001178A+4Fj
					; sub_1001178A+57j
		mov	edx, [ebp+0]
		cmp	[edx], ebx
		jnz	short loc_10011809
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_100117F7
		mov	eax, esi
		jmp	short loc_10011807
; ---------------------------------------------------------------------------

loc_100117F7:				; CODE XREF: sub_1001178A+67j
		mov	ecx, [edi]
		mov	eax, edi
		jmp	short loc_10011801
; ---------------------------------------------------------------------------

loc_100117FD:				; CODE XREF: sub_1001178A+7Bj
		mov	eax, ecx
		mov	ecx, [eax]

loc_10011801:				; CODE XREF: sub_1001178A+71j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_100117FD

loc_10011807:				; CODE XREF: sub_1001178A+6Bj
		mov	[edx], eax

loc_10011809:				; CODE XREF: sub_1001178A+61j
		mov	edx, [ebp+0]
		cmp	[edx+8], ebx
		jnz	short loc_10011889
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1001181B
		mov	eax, esi
		jmp	short loc_1001182D
; ---------------------------------------------------------------------------

loc_1001181B:				; CODE XREF: sub_1001178A+8Bj
		mov	ecx, [edi+8]
		mov	eax, edi
		jmp	short loc_10011827
; ---------------------------------------------------------------------------

loc_10011822:				; CODE XREF: sub_1001178A+A1j
		mov	eax, ecx
		mov	ecx, [eax+8]

loc_10011827:				; CODE XREF: sub_1001178A+96j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10011822

loc_1001182D:				; CODE XREF: sub_1001178A+8Fj
		mov	[edx+8], eax
		jmp	short loc_10011889
; ---------------------------------------------------------------------------

loc_10011832:				; CODE XREF: sub_1001178A+36j
		mov	[ecx+4], edx
		mov	eax, [ebx]
		mov	[edx], eax
		cmp	edx, [ebx+8]
		jnz	short loc_10011842
		mov	esi, edx
		jmp	short loc_1001185C
; ---------------------------------------------------------------------------

loc_10011842:				; CODE XREF: sub_1001178A+B2j
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [edx+4]
		jnz	short loc_1001184E
		mov	[edi+4], esi

loc_1001184E:				; CODE XREF: sub_1001178A+BFj
		mov	[esi], edi
		mov	eax, [ebx+8]
		mov	[edx+8], eax
		mov	eax, [ebx+8]
		mov	[eax+4], edx

loc_1001185C:				; CODE XREF: sub_1001178A+B6j
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_10011869
		mov	[eax+4], edx
		jmp	short loc_10011877
; ---------------------------------------------------------------------------

loc_10011869:				; CODE XREF: sub_1001178A+D8j
		mov	eax, [ebx+4]
		cmp	[eax], ebx
		jnz	short loc_10011874
		mov	[eax], edx
		jmp	short loc_10011877
; ---------------------------------------------------------------------------

loc_10011874:				; CODE XREF: sub_1001178A+E4j
		mov	[eax+8], edx

loc_10011877:				; CODE XREF: sub_1001178A+DDj
					; sub_1001178A+E8j
		mov	eax, [ebx+4]
		mov	[edx+4], eax
		mov	al, [ebx+0Ch]
		mov	cl, [edx+0Ch]
		mov	[edx+0Ch], al
		mov	[ebx+0Ch], cl

loc_10011889:				; CODE XREF: sub_1001178A+85j
					; sub_1001178A+A6j
		cmp	byte ptr [ebx+0Ch], 1
		jnz	loc_10011993
		jmp	loc_1001194C
; ---------------------------------------------------------------------------

loc_10011898:				; CODE XREF: sub_1001178A+1C8j
		cmp	byte ptr [edi+0Ch], 1
		jnz	loc_1001198F
		mov	ecx, [esi]
		cmp	edi, ecx
		jnz	short loc_10011914
		mov	ecx, [esi+8]
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_100118C4
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_100057C3
		mov	ecx, [esi+8]

loc_100118C4:				; CODE XREF: sub_1001178A+125j
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10011947
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_100118DB
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jz	short loc_10011943

loc_100118DB:				; CODE XREF: sub_1001178A+146j
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_100118F9
		mov	eax, [ecx]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_10009EBF
		mov	ecx, [esi+8]

loc_100118F9:				; CODE XREF: sub_1001178A+158j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx+8]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_100057C3
		jmp	short loc_1001198F
; ---------------------------------------------------------------------------

loc_10011914:				; CODE XREF: sub_1001178A+11Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1001192C
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_10009EBF
		mov	ecx, [esi]

loc_1001192C:				; CODE XREF: sub_1001178A+18Ej
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10011947
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1001195A
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_1001195A

loc_10011943:				; CODE XREF: sub_1001178A+14Fj
		mov	byte ptr [ecx+0Ch], 0

loc_10011947:				; CODE XREF: sub_1001178A+13Ej
					; sub_1001178A+1A6j
		mov	edi, esi
		mov	esi, [esi+4]

loc_1001194C:				; CODE XREF: sub_1001178A+109j
		mov	eax, [ebp+0]
		cmp	edi, [eax+4]
		jnz	loc_10011898
		jmp	short loc_1001198F
; ---------------------------------------------------------------------------

loc_1001195A:				; CODE XREF: sub_1001178A+1AFj
					; sub_1001178A+1B7j
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10011977
		mov	eax, [ecx+8]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_100057C3
		mov	ecx, [esi]

loc_10011977:				; CODE XREF: sub_1001178A+1D6j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_10009EBF

loc_1001198F:				; CODE XREF: sub_1001178A+112j
					; sub_1001178A+188j ...
		mov	byte ptr [edi+0Ch], 1

loc_10011993:				; CODE XREF: sub_1001178A+103j
		lea	ecx, [ebx+10h]
		call	sub_100110B8
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [ebp+4]
		pop	ecx
		test	eax, eax
		jz	short loc_100119AD
		dec	eax
		mov	[ebp+4], eax

loc_100119AD:				; CODE XREF: sub_1001178A+21Dj
		mov	eax, [esp+10h+arg_0]
		mov	ecx, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ecx
		pop	ebx
		retn	8
sub_1001178A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100119BE	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+158p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+141p	...

var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		sub	esp, 0Ch
		push	esi
		cmp	eax, 20h
		jnb	short loc_10011A49
		mov	ecx, dword_10033D9C
		cmp	dword ptr [ecx+eax*4], 0
		jz	short loc_10011A49
		mov	eax, [ecx+eax*4]
		mov	edx, dword_10033D9C
		mov	ecx, [ecx+80h]
		add	edx, eax
		cmp	eax, ecx
		ja	short loc_10011A49
		cmp	g_shared_policy_size, ecx
		jb	short loc_10011A49
		mov	esi, [ebp+arg_4]
		xor	eax, eax
		cmp	[esi], eax
		jle	short loc_10011A0F
		lea	ecx, [esi+4]

loc_10011A02:				; CODE XREF: sub_100119BE+4Fj
		cmp	dword ptr [ecx], 0
		jz	short loc_10011A49
		inc	eax
		add	ecx, 8
		cmp	eax, [esi]
		jl	short loc_10011A02

loc_10011A0F:				; CODE XREF: sub_100119BE+3Fj
		push	ebx
		xor	ebx, ebx
		mov	[ebp+var_4], edx
		inc	ebx
		lea	ecx, [ebp+var_C]
		push	ebx
		push	0
		call	sub_10010BB4
		push	dword ptr [esi]
		lea	eax, [esi+4]
		push	eax
		push	2
		lea	ecx, [ebp+var_C]
		call	sub_10010AC9
		cmp	eax, ebx
		jnz	short loc_10011A42
		lea	ecx, [ebp+var_C]
		call	sub_10010BB0
		cmp	eax, 3
		jz	short loc_10011A44

loc_10011A42:				; CODE XREF: sub_100119BE+75j
		xor	ebx, ebx

loc_10011A44:				; CODE XREF: sub_100119BE+82j
		mov	al, bl
		pop	ebx
		jmp	short loc_10011A4B
; ---------------------------------------------------------------------------

loc_10011A49:				; CODE XREF: sub_100119BE+Dj
					; sub_100119BE+19j ...
		xor	al, al

loc_10011A4B:				; CODE XREF: sub_100119BE+89j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100119BE	endp

; Exported entry  33. _TargetNtOpenThreadToken@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenThreadToken(x, x, x, x,	x)
		public _TargetNtOpenThreadToken@20
_TargetNtOpenThreadToken@20 proc near	; DATA XREF: sub_1001026A+BAo
					; .rdata:off_10030468o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		call	sub_10015880
		mov	ecx, eax
		mov	edx, [eax]
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019B58
		push	[ebp+arg_10]
		neg	al
		sbb	al, al
		and	byte ptr [ebp+arg_C], al
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		pop	ebp
		retn	14h
_TargetNtOpenThreadToken@20 endp

; Exported entry  34. _TargetNtOpenThreadTokenEx@24

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenThreadTokenEx(x, x, x, x, x, x)
		public _TargetNtOpenThreadTokenEx@24
_TargetNtOpenThreadTokenEx@24 proc near	; DATA XREF: sub_1001026A+111o
					; .rdata:off_10030468o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		call	sub_10015880
		mov	ecx, eax
		mov	edx, [eax]
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019B58
		push	[ebp+arg_14]
		neg	al
		push	[ebp+arg_10]
		sbb	al, al
		and	byte ptr [ebp+arg_C], al
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		pop	ebp
		retn	18h
_TargetNtOpenThreadTokenEx@24 endp

; Exported entry  38. _TargetNtSetInformationThread@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtSetInformationThread(x, x, x, x, x)
		public _TargetNtSetInformationThread@20
_TargetNtSetInformationThread@20 proc near ; DATA XREF:	sub_1001026A+90o
					; .rdata:off_10030468o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ecx
		call	sub_10015880
		mov	ecx, eax
		mov	edx, [eax]
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019B58
		test	al, al
		jnz	short loc_10011AFF
		cmp	[ebp+arg_8], 5
		jnz	short loc_10011AFF
		cmp	[ebp+arg_C], 0
		jz	short loc_10011AFF
		cmp	[ebp+arg_10], 4
		jb	short loc_10011AFF
		push	4
		push	[ebp+arg_C]
		lea	eax, [ebp+var_4]
		push	eax
		call	sub_10015B5F
		add	esp, 0Ch
		test	eax, eax
		js	short loc_10011AFF
		cmp	[ebp+var_4], 0
		jnz	short loc_10011AFF
		xor	eax, eax
		jmp	short loc_10011B0E
; ---------------------------------------------------------------------------

loc_10011AFF:				; CODE XREF: TargetNtSetInformationThread(x,x,x,x,x)+19j
					; TargetNtSetInformationThread(x,x,x,x,x)+1Fj ...
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]

loc_10011B0E:				; CODE XREF: TargetNtSetInformationThread(x,x,x,x,x)+4Aj
		mov	esp, ebp
		pop	ebp
		retn	14h
_TargetNtSetInformationThread@20 endp


; =============== S U B	R O U T	I N E =======================================


sub_10011B14	proc near		; CODE XREF: sub_10019AA7+98p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 10h
		push	ebx
		mov	ebx, [esp+14h+arg_4]
		push	esi
		mov	esi, [esp+18h+arg_0]
		push	ebx
		push	esi
		call	sub_10011DDE
		pop	ecx
		pop	ecx
		test	al, al
		jz	loc_10011D2C
		push	ebp
		push	edi
		call	sub_10006EF6
		mov	edi, eax
		push	offset aKernel32_dll_3 ; "kernel32.dll"
		mov	[esp+24h+var_4], edi
		call	ds:GetModuleHandleA
		cmp	edi, 3
		mov	ebp, eax
		mov	edi, ds:GetLastError
		jl	short loc_10011BAD
		and	ebx, 1
		xor	eax, eax
		or	eax, ebx
		jz	short loc_10011B86
		push	offset aSetdefaultdlld ; "SetDefaultDllDirectories"
		push	ebp		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_10011B86
		push	1000h
		call	eax
		test	eax, eax
		jnz	short loc_10011B86
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_10011D24

loc_10011B86:				; CODE XREF: sub_10011B14+4Aj
					; sub_10011B14+5Aj ...
		mov	eax, esi
		and	eax, 20h
		or	eax, 0
		jz	short loc_10011BAD
		push	0		; HeapInformationLength
		push	0		; HeapInformation
		push	1		; HeapInformationClass
		push	0		; HeapHandle
		call	ds:HeapSetInformation
		test	eax, eax
		jnz	short loc_10011BAD
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_10011D24

loc_10011BAD:				; CODE XREF: sub_10011B14+41j
					; sub_10011B14+7Aj ...
		mov	eax, esi
		and	eax, 1
		or	eax, 0
		jz	loc_10011C4D
		xor	ebx, ebx
		mov	eax, esi
		inc	ebx
		cmp	[esp+20h+var_4], 3
		setnl	byte ptr [esp+20h+var_10+3]
		and	eax, 2
		or	eax, 0
		jz	short loc_10011BD5
		push	3
		pop	ebx

loc_10011BD5:				; CODE XREF: sub_10011B14+BCj
		push	offset aSetprocessdepp ; "SetProcessDEPPolicy"
		push	ebp		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_10011BFF
		push	ebx
		call	eax
		test	eax, eax
		jnz	short loc_10011C4D

loc_10011BEC:				; CODE XREF: sub_10011B14+137j
		call	edi ; GetLastError
		cmp	eax, 5
		jz	short loc_10011C4D
		cmp	byte ptr [esp+20h+var_10+3], 0
		jz	short loc_10011C4D
		jmp	loc_10011D24
; ---------------------------------------------------------------------------

loc_10011BFF:				; CODE XREF: sub_10011B14+CFj
		and	[esp+20h+var_C], 0
		lea	eax, [esp+20h+var_C]
		push	eax		; int
		push	offset aNtsetinforma_1 ; "NtSetInformationProcess"
		call	sub_1001A242
		cmp	[esp+28h+var_C], 0
		pop	ecx
		pop	ecx
		jz	loc_10011D24
		mov	[esp+20h+var_8], 0Ah
		test	bl, 2
		jnz	short loc_10011C35
		mov	[esp+20h+var_8], 0Eh

loc_10011C35:				; CODE XREF: sub_10011B14+117j
		push	4
		lea	eax, [esp+24h+var_8]
		push	eax
		push	22h
		call	ds:GetCurrentProcess
		push	eax
		call	[esp+30h+var_C]
		test	eax, eax
		js	short loc_10011BEC

loc_10011C4D:				; CODE XREF: sub_10011B14+A1j
					; sub_10011B14+D6j ...
		cmp	[esp+20h+var_4], 5
		jl	loc_10011D28
		push	offset aSetprocessmiti ; "SetProcessMitigationPolicy"
		push	ebp		; hModule
		call	ds:GetProcAddress
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_10011D24
		mov	eax, esi
		xor	ebp, ebp
		and	eax, 8
		or	eax, ebp
		jz	short loc_10011CAC
		mov	eax, esi
		and	eax, 10h
		or	eax, ebp
		jz	short loc_10011C87
		xor	eax, eax
		inc	eax
		jmp	short loc_10011C89
; ---------------------------------------------------------------------------

loc_10011C87:				; CODE XREF: sub_10011B14+16Cj
		mov	eax, ebp

loc_10011C89:				; CODE XREF: sub_10011B14+171j
		and	eax, 1
		shl	eax, 3
		or	eax, 2
		mov	[esp+20h+var_4], eax
		lea	eax, [esp+20h+var_4]
		push	4
		push	eax
		push	1
		call	ebx
		test	eax, eax
		jnz	short loc_10011CAC
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	short loc_10011D24

loc_10011CAC:				; CODE XREF: sub_10011B14+163j
					; sub_10011B14+18Fj
		mov	eax, esi
		and	eax, 100h
		or	eax, ebp
		jz	short loc_10011CD3
		push	3
		pop	ecx
		push	4
		lea	eax, [esp+24h+var_4]
		mov	[esp+24h+var_4], ecx
		push	eax
		push	ecx
		call	ebx
		test	eax, eax
		jnz	short loc_10011CD3
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	short loc_10011D24

loc_10011CD3:				; CODE XREF: sub_10011B14+1A1j
					; sub_10011B14+1B6j
		mov	eax, esi
		and	eax, 200h
		or	eax, ebp
		jz	short loc_10011CFC
		push	4
		lea	eax, [esp+24h+var_4]
		mov	[esp+24h+var_4], 1
		push	eax
		push	4
		call	ebx
		test	eax, eax
		jnz	short loc_10011CFC
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	short loc_10011D24

loc_10011CFC:				; CODE XREF: sub_10011B14+1C8j
					; sub_10011B14+1DFj
		and	esi, 400h
		or	esi, ebp
		jz	short loc_10011D28
		push	4
		lea	eax, [esp+24h+var_4]
		mov	[esp+24h+var_4], 1
		push	eax
		push	6
		call	ebx
		test	eax, eax
		jnz	short loc_10011D28
		call	edi ; GetLastError
		cmp	eax, 5
		jz	short loc_10011D28

loc_10011D24:				; CODE XREF: sub_10011B14+6Cj
					; sub_10011B14+93j ...
		xor	al, al
		jmp	short loc_10011D2A
; ---------------------------------------------------------------------------

loc_10011D28:				; CODE XREF: sub_10011B14+13Ej
					; sub_10011B14+1F0j ...
		mov	al, 1

loc_10011D2A:				; CODE XREF: sub_10011B14+212j
		pop	edi
		pop	ebp

loc_10011D2C:				; CODE XREF: sub_10011B14+18j
		pop	esi
		pop	ebx
		add	esp, 10h
		retn
sub_10011B14	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10011D32(HANDLE hProcess, int)
sub_10011D32	proc near		; CODE XREF: sub_1001664B+24p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-1Ch
hProcess	= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		sub	esp, 24h
		and	eax, 40h
		push	edi
		xor	edi, edi
		or	eax, edi
		jz	loc_10011DD7
		push	ebp
		lea	eax, [esp+2Ch+arg_4]
		push	esi
		push	eax
		call	ds:rand_s
		mov	esi, [esp+34h+arg_4]
		mov	ebp, 0FFFF0000h
		and	esi, 3FFFh
		add	esi, 200h
		shl	esi, 0Ah
		pop	ecx
		and	esi, ebp
		jbe	short loc_10011DD5
		push	ebx

loc_10011D72:				; CODE XREF: sub_10011D32+A0j
		push	1Ch		; dwLength
		lea	eax, [esp+38h+Buffer]
		push	eax		; lpBuffer
		push	edi		; lpAddress
		push	[esp+40h+hProcess] ; hProcess
		call	ds:VirtualQueryEx
		test	eax, eax
		jz	short loc_10011DD4
		mov	eax, [esp+34h+Buffer.RegionSize]
		mov	ecx, esi
		add	eax, 0FFFFh
		sub	ecx, edi
		and	eax, ebp
		mov	[esp+34h+var_24], ecx
		mov	[esp+34h+var_20], eax
		cmp	ecx, eax
		lea	eax, [esp+34h+var_24]
		jb	short loc_10011DAB
		lea	eax, [esp+34h+var_20]

loc_10011DAB:				; CODE XREF: sub_10011D32+73j
		mov	ebx, [eax]
		test	edi, edi
		jz	short loc_10011DCE
		cmp	[esp+34h+Buffer.State],	10000h
		jnz	short loc_10011DCE
		push	1		; flProtect
		push	2000h		; flAllocationType
		push	ebx		; dwSize
		push	edi		; lpAddress
		push	[esp+44h+hProcess] ; hProcess
		call	ds:VirtualAllocEx

loc_10011DCE:				; CODE XREF: sub_10011D32+7Dj
					; sub_10011D32+87j
		add	edi, ebx
		cmp	edi, esi
		jb	short loc_10011D72

loc_10011DD4:				; CODE XREF: sub_10011D32+54j
		pop	ebx

loc_10011DD5:				; CODE XREF: sub_10011D32+3Dj
		pop	esi
		pop	ebp

loc_10011DD7:				; CODE XREF: sub_10011D32+Fj
		mov	al, 1
		pop	edi
		add	esp, 24h
		retn
sub_10011D32	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011DDE	proc near		; CODE XREF: sub_10011B14+Fp
					; sub_1001664B+B6p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		and	ecx, 0FFFFFA84h
		and	eax, 0FFFFFFFEh
		or	ecx, eax
		jnz	short loc_10011DF7
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10011DF7:				; CODE XREF: sub_10011DDE+13j
		xor	eax, eax
		retn
sub_10011DDE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011DFA	proc near		; CODE XREF: sub_10016E23+Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		xor	edx, edx
		mov	eax, [esp+arg_4]
		inc	edx
		and	ecx, 100h
		and	eax, edx
		or	ecx, eax
		jz	short loc_10011E13
		xor	edx, edx

loc_10011E13:				; CODE XREF: sub_10011DFA+15j
		mov	al, dl
		retn
sub_10011DFA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011E16	proc near		; CODE XREF: sub_100095AD+21Ep

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		push	edi
		call	sub_10006EF6
		mov	edx, [esp+8+arg_8]
		mov	esi, eax
		mov	eax, [esp+8+arg_C]
		xor	edi, edi
		xor	ecx, ecx
		cmp	esi, 5
		setnl	cl
		mov	[edx], edi
		mov	[edx+4], edi
		lea	ecx, ds:4[ecx*4]
		mov	[eax], ecx
		cmp	esi, 3
		jle	loc_10011F34
		mov	ecx, [esp+8+arg_0]
		mov	eax, ecx
		and	eax, 1
		or	eax, edi
		jz	short loc_10011E70
		mov	eax, [edx+4]
		or	dword ptr [edx], 1
		mov	[edx+4], eax
		mov	eax, ecx
		and	eax, 2
		or	eax, edi
		jnz	short loc_10011E70
		mov	eax, [edx+4]
		or	dword ptr [edx], 2
		mov	[edx+4], eax

loc_10011E70:				; CODE XREF: sub_10011E16+3Dj
					; sub_10011E16+4Fj
		mov	eax, ecx
		and	eax, 4
		or	eax, edi
		jz	short loc_10011E82
		mov	eax, [edx+4]
		or	dword ptr [edx], 4
		mov	[edx+4], eax

loc_10011E82:				; CODE XREF: sub_10011E16+61j
		cmp	esi, 5
		jl	loc_10011F34
		mov	eax, ecx
		mov	esi, 100h
		and	eax, 8
		or	eax, edi
		jz	short loc_10011EB6
		mov	eax, [edx+4]
		or	[edx], esi
		mov	[edx+4], eax
		mov	eax, ecx
		and	eax, 10h
		or	eax, edi
		jz	short loc_10011EB6
		mov	eax, [edx+4]
		or	dword ptr [edx], 300h
		mov	[edx+4], eax

loc_10011EB6:				; CODE XREF: sub_10011E16+81j
					; sub_10011E16+92j
		mov	eax, ecx
		and	eax, 20h
		or	eax, edi
		jz	short loc_10011ECB
		mov	eax, [edx+4]
		or	dword ptr [edx], 1000h
		mov	[edx+4], eax

loc_10011ECB:				; CODE XREF: sub_10011E16+A7j
		mov	eax, ecx
		and	eax, 40h
		or	eax, edi
		jz	short loc_10011EE0
		mov	eax, [edx+4]
		or	dword ptr [edx], 10000h
		mov	[edx+4], eax

loc_10011EE0:				; CODE XREF: sub_10011E16+BCj
		mov	eax, ecx
		and	eax, 80h
		or	eax, edi
		jz	short loc_10011EF7
		mov	eax, [edx+4]
		or	dword ptr [edx], 100000h
		mov	[edx+4], eax

loc_10011EF7:				; CODE XREF: sub_10011E16+D3j
		mov	eax, ecx
		and	eax, esi
		or	eax, edi
		jz	short loc_10011F0B
		mov	eax, [edx+4]
		or	dword ptr [edx], 1000000h
		mov	[edx+4], eax

loc_10011F0B:				; CODE XREF: sub_10011E16+E7j
		mov	eax, ecx
		and	eax, 200h
		or	eax, edi
		jz	short loc_10011F22
		mov	eax, [edx+4]
		or	dword ptr [edx], 10000000h
		mov	[edx+4], eax

loc_10011F22:				; CODE XREF: sub_10011E16+FEj
		and	ecx, 400h
		or	ecx, edi
		jz	short loc_10011F34
		mov	eax, [edx]
		or	dword ptr [edx+4], 1
		mov	[edx], eax

loc_10011F34:				; CODE XREF: sub_10011E16+2Cj
					; sub_10011E16+6Fj ...
		pop	edi
		pop	esi
		retn
sub_10011E16	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011F37	proc near		; CODE XREF: sub_1001664B+9Ep

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		call	sub_10006EF6
		cmp	eax, 3
		jge	short loc_10011F4E
		mov	eax, [ebp+arg_0]
		and	eax, 3
		xor	edx, edx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10011F4E:				; CODE XREF: sub_10011F37+Bj
		cmp	eax, 4
		jge	short loc_10011F5B
		mov	eax, [ebp+arg_0]

loc_10011F56:				; CODE XREF: sub_10011F37+2Aj
		and	eax, 60h
		jmp	short loc_10011F66
; ---------------------------------------------------------------------------

loc_10011F5B:				; CODE XREF: sub_10011F37+1Aj
		cmp	eax, 5
		mov	eax, [ebp+arg_0]
		jl	short loc_10011F56
		and	eax, 40h

loc_10011F66:				; CODE XREF: sub_10011F37+22j
		mov	edx, [ebp+arg_4]
		and	edx, 1
		pop	ebp
		retn
sub_10011F37	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011F6E	proc near		; CODE XREF: sub_10016099+1C2p

arg_0		= dword	ptr  4

		xor	eax, eax
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		mov	[ecx+0Ch], eax
		mov	eax, [esp+arg_0]
		mov	[ecx+10h], eax
		mov	eax, ecx
		mov	dword ptr [ecx], offset	off_1001DC5C
		retn	4
sub_10011F6E	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10011F8B(void *, char)
sub_10011F8B	proc near		; DATA XREF: .rdata:1001D0E4o
					; .rdata:1001D0F0o ...

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		lea	ecx, [esi+4]
		mov	dword ptr [esi], offset	off_1001D0DC
		call	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime
		test	[esp+4+arg_0], 1
		jz	short loc_10011FAA
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10011FAA:				; CODE XREF: sub_10011F8B+16j
		mov	eax, esi
		pop	esi
		retn	4
sub_10011F8B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011FB0	proc near		; DATA XREF: .rdata:1001DC60o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [ecx+10h]
		add	ecx, 10h
		mov	eax, [ecx]
		call	dword ptr [eax+44h]
		xor	ecx, ecx
		and	eax, 200h
		and	edx, ecx
		or	eax, edx
		jnz	short loc_10011FCC

loc_10011FC8:				; CODE XREF: sub_10011FB0+29j
		xor	al, al
		jmp	short locret_1001203E
; ---------------------------------------------------------------------------

loc_10011FCC:				; CODE XREF: sub_10011FB0+16j
		mov	eax, [esp+arg_4]
		sub	eax, 13h
		jz	short loc_10012012
		dec	eax
		jz	short loc_10011FF9
		dec	eax
		jnz	short loc_10011FC8
		mov	eax, offset _TargetRegisterClassW@8 ; TargetRegisterClassW(x,x)
		test	eax, eax
		jz	short loc_10012039
		push	18h
		push	offset a_targetregis_0 ; "_TargetRegisterClassW@8"
		push	2
		push	offset aRegisterclassw ; "RegisterClassW"
		push	offset aUser32_dll_0 ; "user32.dll"
		jmp	short loc_1001202E
; ---------------------------------------------------------------------------

loc_10011FF9:				; CODE XREF: sub_10011FB0+26j
		mov	eax, offset _TargetGetStockObject@8 ; TargetGetStockObject(x,x)
		test	eax, eax
		jz	short loc_10012039
		push	17h
		push	offset a_targetgetst_0 ; "_TargetGetStockObject@8"
		push	2
		push	offset aGetstockobject ; "GetStockObject"
		jmp	short loc_10012029
; ---------------------------------------------------------------------------

loc_10012012:				; CODE XREF: sub_10011FB0+23j
		mov	eax, offset _TargetGdiDllInitialize@12 ; TargetGdiDllInitialize(x,x,x)
		test	eax, eax
		jz	short loc_10012039
		push	16h		; int
		push	offset a_targetgdidl_0 ; "_TargetGdiDllInitialize@12"
		push	2		; int
		push	offset aGdidllinitiali ; "GdiDllInitialize"

loc_10012029:				; CODE XREF: sub_10011FB0+60j
		push	offset aGdi32_dll ; "gdi32.dll"

loc_1001202E:				; CODE XREF: sub_10011FB0+47j
		mov	ecx, [esp+14h+arg_0]
		call	sub_1000EC5D
		mov	cl, al

loc_10012039:				; CODE XREF: sub_10011FB0+32j
					; sub_10011FB0+50j ...
		test	cl, cl
		setnz	al

locret_1001203E:			; CODE XREF: sub_10011FB0+1Aj
		retn	8
sub_10011FB0	endp

; Exported entry  19. _TargetGdiDllInitialize@12

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetGdiDllInitialize(x, x, x)
		public _TargetGdiDllInitialize@12
_TargetGdiDllInitialize@12 proc	near	; DATA XREF: sub_10011FB0:loc_10012012o
					; .rdata:off_10030468o
		xor	eax, eax
		inc	eax
		retn	0Ch
_TargetGdiDllInitialize@12 endp

; Exported entry  20. _TargetGetStockObject@8

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetGetStockObject(x, x)
		public _TargetGetStockObject@8
_TargetGetStockObject@8	proc near	; DATA XREF: sub_10011FB0:loc_10011FF9o
					; .rdata:off_10030468o
		xor	eax, eax
		retn	8
_TargetGetStockObject@8	endp

; Exported entry  40. _TargetRegisterClassW@8

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetRegisterClassW(x, x)
		public _TargetRegisterClassW@8
_TargetRegisterClassW@8	proc near	; DATA XREF: sub_10011FB0+2Bo
					; .rdata:off_10030468o
		xor	eax, eax
		inc	eax
		retn	8
_TargetRegisterClassW@8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012052	proc near		; CODE XREF: sub_1001651A+77p

var_10		= byte ptr -10h
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		lea	ecx, [ebp+var_10]
		push	ebx
		push	0Ah
		call	sub_10011053
		mov	ecx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		push	eax
		push	13h
		call	sub_100111C8
		test	al, al
		jz	short loc_1001209D
		mov	ecx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		push	eax
		push	14h
		call	sub_100111C8
		test	al, al
		jz	short loc_1001209D
		mov	ecx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		push	eax
		push	15h
		call	sub_100111C8
		test	al, al
		jz	short loc_1001209D
		mov	bl, 1
		jmp	short loc_1001209F
; ---------------------------------------------------------------------------

loc_1001209D:				; CODE XREF: sub_10012052+21j
					; sub_10012052+33j ...
		xor	bl, bl

loc_1001209F:				; CODE XREF: sub_10012052+49j
		lea	ecx, [ebp+var_10]
		call	sub_10011108
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10012052	endp


; =============== S U B	R O U T	I N E =======================================


sub_100120AE	proc near		; CODE XREF: sub_10016099+12Ap

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	eax, eax
		push	offset asc_1001DD4C ; "\t"
		lea	esi, [edi+4]
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_0]
		mov	dword ptr [edi], offset	off_1001DD30
		mov	[edi+10h], eax
		call	sub_1000ADE8
		push	offset dword_1001DD78
		mov	ecx, esi
		call	sub_1000ADE8
		push	offset dword_1001DDA4
		mov	ecx, esi
		call	sub_1000ADE8
		push	offset dword_1001DDD0
		mov	ecx, esi
		call	sub_1000ADE8
		push	offset dword_1001DDFC
		mov	ecx, esi
		call	sub_1000ADE8
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_100120AE	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001210F(LPCWSTR lpPath, char, int)
sub_1001210F	proc near		; CODE XREF: sub_100121D9+B2p

FilePart	= dword	ptr -210h
Buffer		= word ptr -20Ch
var_4		= dword	ptr -4
lpPath		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 210h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+210h+var_4], eax
		push	ebp
		push	esi
		mov	esi, [esp+218h+arg_8]
		xor	ebp, ebp
		cmp	[esp+218h+arg_4], 0
		push	edi
		mov	edi, [esp+21Ch+lpPath]
		mov	[esp+21Ch+FilePart], ebp
		jz	short loc_1001216C
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1001214E
		mov	eax, [esi]
		jmp	short loc_10012150
; ---------------------------------------------------------------------------

loc_1001214E:				; CODE XREF: sub_1001210F+39j
		mov	eax, esi

loc_10012150:				; CODE XREF: sub_1001210F+3Dj
		lea	ecx, [esp+21Ch+FilePart]
		push	ecx		; lpFilePart
		lea	ecx, [esp+220h+Buffer]
		push	ecx		; lpBuffer
		push	104h		; nBufferLength
		push	ebp		; lpExtension
		push	eax		; lpFileName
		push	ebp		; lpPath
		call	ds:SearchPathW
		test	eax, eax
		jnz	short loc_1001219C

loc_1001216C:				; CODE XREF: sub_1001210F+33j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10012176
		mov	eax, [esi]
		jmp	short loc_10012178
; ---------------------------------------------------------------------------

loc_10012176:				; CODE XREF: sub_1001210F+61j
		mov	eax, esi

loc_10012178:				; CODE XREF: sub_1001210F+65j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10012180
		mov	edi, [edi]

loc_10012180:				; CODE XREF: sub_1001210F+6Dj
		lea	ecx, [esp+21Ch+FilePart]
		push	ecx		; lpFilePart
		lea	ecx, [esp+220h+Buffer]
		push	ecx		; lpBuffer
		push	104h		; nBufferLength
		push	ebp		; lpExtension
		push	eax		; lpFileName
		push	edi		; lpPath
		call	ds:SearchPathW
		test	eax, eax
		jz	short loc_100121BF

loc_1001219C:				; CODE XREF: sub_1001210F+5Bj
		cmp	eax, 104h
		jnb	short loc_100121BF
		lea	eax, [esp+21Ch+Buffer]
		push	eax
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		lea	eax, [esp+220h+Buffer]
		mov	ecx, esi
		push	eax		; void *
		call	sub_100023C8
		mov	al, 1
		jmp	short loc_100121C1
; ---------------------------------------------------------------------------

loc_100121BF:				; CODE XREF: sub_1001210F+8Bj
					; sub_1001210F+92j
		xor	al, al

loc_100121C1:				; CODE XREF: sub_1001210F+AEj
		mov	ecx, [esp+21Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 210h
		retn
sub_1001210F	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100121D9(int, int, wchar_t *, int, int)
sub_100121D9	proc near		; DATA XREF: .rdata:1001DE24o

var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
lpPath		= dword	ptr -48h
var_44		= dword	ptr -44h
ApplicationName	= word ptr -40h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 50h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+50h+var_4], eax
		mov	eax, [esp+50h+arg_C]
		push	ebx
		mov	ebx, [esp+54h+arg_10]
		push	ebp
		mov	ebp, [esp+58h+arg_8]
		push	esi
		cmp	dword ptr [ebx], 10h
		mov	esi, [esp+5Ch+arg_4]
		push	edi
		mov	edi, [esp+60h+arg_0]
		mov	[esp+60h+var_50], ecx
		mov	[esp+60h+lpPath], eax
		jz	short loc_10012213
		xor	al, al
		jmp	loc_10012300
; ---------------------------------------------------------------------------

loc_10012213:				; CODE XREF: sub_100121D9+31j
		xor	ecx, ecx
		mov	[esp+60h+var_2C], 7
		xor	eax, eax
		mov	[esp+60h+var_30], ecx
		mov	[esp+60h+ApplicationName], ax
		cmp	[esi+10h], ecx
		jz	short loc_10012242
		lea	eax, [esp+60h+ApplicationName]
		cmp	eax, esi
		jz	short loc_10012266
		push	0FFFFFFFFh
		push	ecx
		push	esi
		mov	ecx, eax
		call	sub_10002344
		jmp	short loc_10012266
; ---------------------------------------------------------------------------

loc_10012242:				; CODE XREF: sub_100121D9+52j
		lea	eax, [esp+60h+var_1C]
		push	ebp
		push	eax
		call	sub_10012315
		pop	ecx
		pop	ecx
		push	eax		; void *
		lea	ecx, [esp+64h+ApplicationName] ; void *
		call	sub_1000402F
		push	0		; int
		push	1		; char
		lea	ecx, [esp+68h+var_1C] ;	void *
		call	sub_100022C1

loc_10012266:				; CODE XREF: sub_100121D9+5Aj
					; sub_100121D9+67j
		lea	eax, [esp+60h+ApplicationName]
		push	eax
		call	sub_10012412
		pop	ecx
		test	al, al
		jz	short loc_100122A0
		cmp	dword ptr [esi+10h], 0
		lea	eax, [esp+60h+ApplicationName]
		push	eax		; int
		setz	[esp+64h+var_4C]
		push	dword ptr [esp+64h+var_4C] ; char
		push	[esp+68h+lpPath] ; lpPath
		call	sub_1001210F
		add	esp, 0Ch
		test	al, al
		jnz	short loc_100122A0
		mov	dword ptr [edi+10h], 2
		jmp	short loc_100122F1
; ---------------------------------------------------------------------------

loc_100122A0:				; CODE XREF: sub_100121D9+9Aj
					; sub_100121D9+BCj
		cmp	[esp+60h+var_2C], 8
		mov	eax, dword ptr [esp+60h+ApplicationName]
		jnb	short loc_100122AF
		lea	eax, [esp+60h+ApplicationName]

loc_100122AF:				; CODE XREF: sub_100121D9+D0j
		xor	ecx, ecx
		mov	[esp+60h+var_44], eax
		inc	ecx
		lea	eax, [esp+60h+var_44]
		mov	[esp+60h+var_28], ecx
		mov	[esp+60h+var_24], ecx
		mov	ecx, [esp+60h+var_50]
		mov	[esp+60h+var_20], eax
		lea	eax, [esp+60h+var_28]
		push	eax
		push	0Dh
		mov	ecx, [ecx+10h]
		call	sub_100168E1
		push	dword ptr [ebx+4] ; lpProcessInformation
		lea	ecx, [esp+64h+ApplicationName]
		push	ebp		; wchar_t *
		push	ecx		; lpApplicationName
		push	dword ptr [edi+4] ; int
		push	eax		; int
		call	sub_100132F9
		add	esp, 14h
		mov	[edi+10h], eax

loc_100122F1:				; CODE XREF: sub_100121D9+C5j
		push	0		; int
		push	1		; char
		lea	ecx, [esp+68h+ApplicationName] ; void *
		call	sub_100022C1
		mov	al, 1

loc_10012300:				; CODE XREF: sub_100121D9+35j
		mov	ecx, [esp+60h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 50h
		retn	14h
sub_100121D9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012315	proc near		; CODE XREF: sub_100121D9+6Fp

var_38		= dword	ptr -38h
var_34		= word ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+38h+var_4], eax
		push	ebx
		mov	ebx, [esp+3Ch+arg_0]
		xor	eax, eax
		push	ebp
		push	esi
		mov	esi, [esp+44h+arg_4]
		xor	ebp, ebp
		push	edi
		mov	[esp+48h+var_8], 7
		mov	[esp+48h+var_C], ebp
		cmp	dword ptr [esi+14h], 8
		mov	[esp+48h+var_1C], ax
		jb	short loc_1001234E
		mov	eax, [esi]
		jmp	short loc_10012350
; ---------------------------------------------------------------------------

loc_1001234E:				; CODE XREF: sub_10012315+33j
		mov	eax, esi

loc_10012350:				; CODE XREF: sub_10012315+37j
		push	22h
		xor	edi, edi
		pop	ecx
		inc	edi
		cmp	[eax], cx
		push	edi
		lea	eax, [esp+4Ch+var_38]
		jnz	short loc_10012383
		push	edi
		mov	[esp+50h+var_38], ecx
		mov	ecx, esi
		push	eax
		call	sub_10003CD5
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001237C
		push	esi
		mov	ecx, ebx
		call	sub_10003B1C
		jmp	short loc_100123F2
; ---------------------------------------------------------------------------

loc_1001237C:				; CODE XREF: sub_10012315+5Bj
		xor	ecx, ecx
		dec	eax
		push	eax
		push	edi
		jmp	short loc_100123B2
; ---------------------------------------------------------------------------

loc_10012383:				; CODE XREF: sub_10012315+49j
		push	ebp
		push	eax
		mov	ecx, esi
		mov	[esp+54h+var_38], 20h
		call	sub_10003CD5
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100123AE
		lea	eax, [esp+48h+var_1C]
		cmp	eax, esi
		jz	short loc_100123E6
		push	0FFFFFFFFh
		push	ebp
		push	esi
		mov	ecx, eax
		call	sub_10002344
		jmp	short loc_100123E6
; ---------------------------------------------------------------------------

loc_100123AE:				; CODE XREF: sub_10012315+82j
		push	eax
		xor	ecx, ecx
		push	ebp

loc_100123B2:				; CODE XREF: sub_10012315+6Cj
		mov	[esp+50h+var_34], cx
		lea	ecx, [esp+50h+var_34]
		push	esi
		mov	[esp+54h+var_20], 7
		mov	[esp+54h+var_24], ebp
		call	sub_10002344
		lea	eax, [esp+48h+var_34]
		push	eax		; void *
		lea	ecx, [esp+4Ch+var_1C] ;	void *
		call	sub_1000402F
		push	ebp		; int
		push	edi		; char
		lea	ecx, [esp+50h+var_34] ;	void *
		call	sub_100022C1

loc_100123E6:				; CODE XREF: sub_10012315+8Aj
					; sub_10012315+97j
		lea	eax, [esp+48h+var_1C]
		mov	ecx, ebx
		push	eax		; void *
		call	sub_10003AFA

loc_100123F2:				; CODE XREF: sub_10012315+65j
		push	ebp		; int
		push	edi		; char
		lea	ecx, [esp+50h+var_1C] ;	void *
		call	sub_100022C1
		mov	ecx, [esp+48h+var_4]
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
sub_10012315	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012412	proc near		; CODE XREF: sub_100121D9+92p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, offset asc_1001DD3C ; "\\\\"
		push	esi
		call	sub_100024E3
		pop	ecx
		mov	ecx, [esp+4+arg_0]
		push	eax
		push	0
		push	esi
		call	sub_10003CD5
		test	eax, eax
		jz	short loc_10012452
		mov	esi, offset asc_1001DD44 ; ":\\"
		push	esi
		call	sub_100024E3
		pop	ecx
		mov	ecx, [esp+4+arg_0]
		push	eax
		push	0
		push	esi
		call	sub_10003CD5
		cmp	eax, 1
		jz	short loc_10012452
		mov	al, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10012452:				; CODE XREF: sub_10012412+1Cj
					; sub_10012412+3Aj
		xor	al, al
		pop	esi
		retn
sub_10012412	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012456	proc near		; DATA XREF: .rdata:1001DDA0o

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	eax, [ebp+TargetHandle]
		push	eax		; lpTargetHandle
		push	[ebp+arg_8]	; int
		push	[ebp+arg_4]	; int
		push	dword ptr [esi+4] ; int
		call	sub_10013415
		add	esp, 10h
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		mov	[esi+18h], eax
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10012456	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012485	proc near		; DATA XREF: .rdata:1001DDCCo

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	eax, [ebp+TargetHandle]
		push	eax		; lpTargetHandle
		push	[ebp+arg_8]	; int
		push	[ebp+arg_4]	; int
		push	dword ptr [esi+4] ; int
		call	sub_100134B0
		add	esp, 10h
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		mov	[esi+18h], eax
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10012485	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100124B4	proc near		; DATA XREF: .rdata:1001DDF8o

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	eax, [ebp+TargetHandle]
		push	eax		; lpTargetHandle
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	[ebp+arg_4]	; int
		push	dword ptr [esi+4] ; int
		call	sub_10013522
		add	esp, 14h
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		mov	[esi+18h], eax
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_100124B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100124E6	proc near		; DATA XREF: .rdata:1001DD74o

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	eax, [ebp+TargetHandle]
		push	eax		; lpTargetHandle
		push	[ebp+arg_8]	; int
		push	[ebp+arg_4]	; int
		push	dword ptr [esi+4] ; int
		call	sub_10013598
		add	esp, 10h
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		mov	[esi+18h], eax
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_100124E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012515	proc near		; DATA XREF: .rdata:1001DD34o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		xor	ebx, ebx
		cmp	[ebp+arg_4], 9
		mov	[ebp+var_4], ebx
		jl	short loc_10012590
		cmp	[ebp+arg_4], 0Ch
		jle	short loc_10012590
		cmp	[ebp+arg_4], 0Dh
		jnz	short loc_10012590
		mov	eax, offset _TargetCreateProcessW@44 ; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10012557
		mov	ecx, [ebp+arg_0]
		push	0Fh		; int
		push	offset a_targetcreat_1 ; "_TargetCreateProcessW@44"
		push	2		; int
		push	offset aCreateprocessw ; "CreateProcessW"
		push	offset aKernel32_dll_2 ; "kernel32.dll"
		call	sub_1000EC5D
		jmp	short loc_10012559
; ---------------------------------------------------------------------------

loc_10012557:				; CODE XREF: sub_10012515+23j
		mov	al, bl

loc_10012559:				; CODE XREF: sub_10012515+40j
		test	al, al
		jz	short loc_1001258C
		mov	eax, offset _TargetCreateProcessA@44 ; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10012583
		mov	ecx, [ebp+arg_0]
		push	10h		; int
		push	offset a_targetcreat_2 ; "_TargetCreateProcessA@44"
		push	2		; int
		push	offset aCreateprocessa ; "CreateProcessA"
		push	offset ModuleName ; "kernel32.dll"
		call	sub_1000EC5D
		jmp	short loc_10012585
; ---------------------------------------------------------------------------

loc_10012583:				; CODE XREF: sub_10012515+4Fj
		mov	al, bl

loc_10012585:				; CODE XREF: sub_10012515+6Cj
		test	al, al
		jz	short loc_1001258C
		xor	ebx, ebx
		inc	ebx

loc_1001258C:				; CODE XREF: sub_10012515+46j
					; sub_10012515+72j
		mov	al, bl
		jmp	short loc_10012592
; ---------------------------------------------------------------------------

loc_10012590:				; CODE XREF: sub_10012515+Ej
					; sub_10012515+14j ...
		xor	al, al

loc_10012592:				; CODE XREF: sub_10012515+79j
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10012515	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10012599(int,	int, void *, void *, int)
sub_10012599	proc near		; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+D8p
					; TargetNtOpenThread(x,x,x,x,x)+FCp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	ecx, [esp+arg_0]
		push	esi
		call	sub_1001768F
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100125AE
		push	4
		pop	eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100125AE:				; CODE XREF: sub_10012599+Ej
		push	ebx
		mov	eax, [esp+8+arg_4]
		xor	ebx, ebx
		push	ebp
		push	edi
		push	2
		pop	ebp
		push	ebp		; int
		push	ebx		; char
		push	4
		pop	edi
		push	edi		; size_t
		push	[esp+1Ch+arg_8]	; void *
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], ebx
		mov	[esi+3Ch], ebp
		push	ebx		; int
		mov	dword ptr [esi+44h], 64h
		call	sub_10012964
		test	al, al
		jz	short loc_10012612
		push	ebp		; int
		push	ebx		; char
		push	edi		; size_t
		push	[esp+1Ch+arg_C]	; void *
		mov	ecx, esi
		push	1		; int
		call	sub_10012964
		test	al, al
		jz	short loc_10012612
		push	[esp+10h+arg_10]
		mov	ecx, [esp+14h+arg_0]
		push	esi
		call	sub_100175C5
		mov	edi, eax
		cmp	edi, 0Ah
		jz	short loc_10012612
		mov	ecx, [esp+10h+arg_0]
		push	esi
		call	sub_10017671

loc_10012612:				; CODE XREF: sub_10012599+44j
					; sub_10012599+58j ...
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
sub_10012599	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10012619(int,	int, int, void *, int)
sub_10012619	proc near		; CODE XREF: TargetNtOpenProcessToken(x,x,x,x)+A7p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	ecx, [ebp+arg_0]
		push	esi
		call	sub_1001768F
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10012631
		push	4
		pop	eax
		jmp	short loc_1001269D
; ---------------------------------------------------------------------------

loc_10012631:				; CODE XREF: sub_10012619+11j
		mov	eax, [ebp+arg_4]
		lea	ecx, [ebp+var_4]
		push	ebx
		push	edi
		push	4
		pop	edi
		push	edi		; int
		xor	ebx, ebx
		mov	[esi], eax
		mov	eax, [ebp+arg_8]
		push	ebx		; char
		push	edi		; size_t
		mov	[esi+4], ebx
		mov	dword ptr [esi+3Ch], 2
		push	ecx		; void *
		mov	dword ptr [esi+44h], 64h
		mov	ecx, esi
		mov	eax, [eax]
		push	ebx		; int
		mov	[ebp+var_4], eax
		call	sub_10012964
		test	al, al
		jz	short loc_10012699
		push	2		; int
		push	ebx		; char
		push	edi		; size_t
		push	[ebp+arg_C]	; void *
		mov	ecx, esi
		push	1		; int
		call	sub_10012964
		test	al, al
		jz	short loc_10012699
		push	[ebp+arg_10]
		mov	ecx, [ebp+arg_0]
		push	esi
		call	sub_100175C5
		mov	edi, eax
		cmp	edi, 0Ah
		jz	short loc_10012699
		mov	ecx, [ebp+arg_0]
		push	esi
		call	sub_10017671

loc_10012699:				; CODE XREF: sub_10012619+4Ej
					; sub_10012619+62j ...
		mov	eax, edi
		pop	edi
		pop	ebx

loc_1001269D:				; CODE XREF: sub_10012619+16j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10012619	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100126A2(int,	int, int, void *, void *, int)
sub_100126A2	proc near		; CODE XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+AEp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	ecx, [ebp+arg_0]
		push	esi
		call	sub_1001768F
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100126BD
		push	4
		pop	eax
		jmp	loc_1001273D
; ---------------------------------------------------------------------------

loc_100126BD:				; CODE XREF: sub_100126A2+11j
		mov	eax, [ebp+arg_4]
		lea	ecx, [ebp+var_4]
		push	ebx
		push	edi
		push	4
		pop	edi
		push	edi		; int
		xor	ebx, ebx
		mov	[esi], eax
		mov	eax, [ebp+arg_8]
		push	ebx		; char
		push	edi		; size_t
		mov	[esi+4], ebx
		mov	dword ptr [esi+3Ch], 3
		push	ecx		; void *
		mov	dword ptr [esi+44h], 70h
		mov	ecx, esi
		mov	eax, [eax]
		push	ebx		; int
		mov	[ebp+var_4], eax
		call	sub_1000B23B
		test	al, al
		jz	short loc_10012739
		push	2		; int
		push	ebx		; char
		push	edi		; size_t
		push	[ebp+arg_C]	; void *
		mov	ecx, esi
		push	1		; int
		call	sub_1000B23B
		test	al, al
		jz	short loc_10012739
		push	2		; int
		push	ebx		; char
		push	edi		; size_t
		push	[ebp+arg_10]	; void *
		mov	ecx, esi
		push	2		; int
		call	sub_1000B23B
		test	al, al
		jz	short loc_10012739
		push	[ebp+arg_14]
		mov	ecx, [ebp+arg_0]
		push	esi
		call	sub_100175C5
		mov	edi, eax
		cmp	edi, 0Ah
		jz	short loc_10012739
		mov	ecx, [ebp+arg_0]
		push	esi
		call	sub_10017671

loc_10012739:				; CODE XREF: sub_100126A2+51j
					; sub_100126A2+65j ...
		mov	eax, edi
		pop	edi
		pop	ebx

loc_1001273D:				; CODE XREF: sub_100126A2+16j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100126A2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012742	proc near		; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+160p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ecx
		push	ecx
		mov	ecx, [esp+8+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1001275C
		push	4
		pop	eax
		jmp	loc_1001284F
; ---------------------------------------------------------------------------

loc_1001275C:				; CODE XREF: sub_10012742+10j
		mov	eax, [esp+0Ch+arg_4]
		lea	ecx, [esp+0Ch+var_8]
		and	dword ptr [edi+4], 0
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_8]
		push	4
		pop	ebp
		mov	[edi], eax
		mov	[edi+3Ch], ebp
		push	1		; int
		mov	dword ptr [edi+44h], 7Ch
		mov	esi, [esi]
		push	0		; char
		mov	[esp+1Ch+var_8], esi
		call	sub_1000B44B
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		mov	ecx, edi
		call	sub_1000E821
		test	al, al
		jz	short loc_1001280B
		mov	esi, [esp+14h+arg_C]
		lea	ecx, [esp+14h+var_8]
		mov	esi, [esi]
		mov	[esp+14h+var_8], esi
		call	sub_1000B44B
		push	1		; int
		push	0		; char
		push	eax		; size_t
		push	esi		; void *
		push	1		; int
		mov	ecx, edi
		call	sub_1000E821
		test	al, al
		jz	short loc_1001280B
		mov	esi, [esp+14h+arg_10]
		lea	ecx, [esp+14h+var_8]
		push	1		; int
		push	0		; char
		mov	esi, [esi]
		mov	[esp+1Ch+var_8], esi
		call	sub_1000B44B
		push	eax		; size_t
		push	esi		; void *
		push	2		; int
		mov	ecx, edi
		call	sub_1000E821
		test	al, al
		jz	short loc_1001280B
		mov	eax, [esp+14h+arg_14]
		push	6		; int
		push	1		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; size_t
		push	eax		; void *
		mov	[esp+24h+var_8], ecx
		mov	ecx, edi
		push	3		; int
		mov	[esp+28h+var_4], eax
		call	sub_1000E821
		test	al, al
		jnz	short loc_1001280F

loc_1001280B:				; CODE XREF: sub_10012742+57j
					; sub_10012742+7Dj ...
		mov	eax, ebp
		jmp	short loc_1001284D
; ---------------------------------------------------------------------------

loc_1001280F:				; CODE XREF: sub_10012742+C7j
		push	[esp+14h+arg_18]
		mov	ecx, [esp+18h+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1001284B
		mov	edx, [edi+68h]
		lea	ecx, [esp+14h+var_8]
		add	edx, edi
		push	edx		; void *
		call	sub_1000B4A1
		mov	ecx, [esp+14h+arg_0]
		push	edi
		test	al, al
		jnz	short loc_10012846
		call	sub_10017671
		push	2
		pop	eax
		jmp	short loc_1001284D
; ---------------------------------------------------------------------------

loc_10012846:				; CODE XREF: sub_10012742+F8j
		call	sub_10017671

loc_1001284B:				; CODE XREF: sub_10012742+E0j
		mov	eax, esi

loc_1001284D:				; CODE XREF: sub_10012742+CBj
					; sub_10012742+102j
		pop	esi
		pop	ebp

loc_1001284F:				; CODE XREF: sub_10012742+15j
		pop	edi
		pop	ecx
		pop	ecx
		retn
sub_10012742	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012853	proc near		; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+1D0p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ecx
		push	ecx
		mov	ecx, [esp+8+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1001286D
		push	4
		pop	eax
		jmp	loc_10012960
; ---------------------------------------------------------------------------

loc_1001286D:				; CODE XREF: sub_10012853+10j
		mov	eax, [esp+0Ch+arg_4]
		lea	ecx, [esp+0Ch+var_8]
		and	dword ptr [edi+4], 0
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_8]
		push	4
		pop	ebp
		mov	[edi], eax
		mov	[edi+3Ch], ebp
		push	1		; int
		mov	dword ptr [edi+44h], 7Ch
		mov	esi, [esi]
		push	0		; char
		mov	[esp+1Ch+var_8], esi
		call	sub_1000B44B
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		mov	ecx, edi
		call	sub_1000E821
		test	al, al
		jz	short loc_1001291C
		mov	esi, [esp+14h+arg_C]
		lea	ecx, [esp+14h+var_8]
		push	1		; int
		push	0		; char
		mov	esi, [esi]
		mov	[esp+1Ch+var_8], esi
		call	sub_1000B44B
		push	eax		; size_t
		push	esi		; void *
		push	1		; int
		mov	ecx, edi
		call	sub_1000E821
		test	al, al
		jz	short loc_1001291C
		mov	esi, [esp+14h+arg_10]
		lea	ecx, [esp+14h+var_8]
		push	1		; int
		push	0		; char
		mov	esi, [esi]
		mov	[esp+1Ch+var_8], esi
		call	sub_1000B44B
		push	eax		; size_t
		push	esi		; void *
		push	2		; int
		mov	ecx, edi
		call	sub_1000E821
		test	al, al
		jz	short loc_1001291C
		mov	eax, [esp+14h+arg_14]
		push	6		; int
		push	1		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; size_t
		push	eax		; void *
		mov	[esp+24h+var_8], ecx
		mov	ecx, edi
		push	3		; int
		mov	[esp+28h+var_4], eax
		call	sub_1000E821
		test	al, al
		jnz	short loc_10012920

loc_1001291C:				; CODE XREF: sub_10012853+57j
					; sub_10012853+7Dj ...
		mov	eax, ebp
		jmp	short loc_1001295E
; ---------------------------------------------------------------------------

loc_10012920:				; CODE XREF: sub_10012853+C7j
		push	[esp+14h+arg_18]
		mov	ecx, [esp+18h+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1001295C
		mov	edx, [edi+68h]
		lea	ecx, [esp+14h+var_8]
		add	edx, edi
		push	edx		; void *
		call	sub_1000B4A1
		mov	ecx, [esp+14h+arg_0]
		push	edi
		test	al, al
		jnz	short loc_10012957
		call	sub_10017671
		push	2
		pop	eax
		jmp	short loc_1001295E
; ---------------------------------------------------------------------------

loc_10012957:				; CODE XREF: sub_10012853+F8j
		call	sub_10017671

loc_1001295C:				; CODE XREF: sub_10012853+E0j
		mov	eax, esi

loc_1001295E:				; CODE XREF: sub_10012853+CBj
					; sub_10012853+102j
		pop	esi
		pop	ebp

loc_10012960:				; CODE XREF: sub_10012853+15j
		pop	edi
		pop	ecx
		pop	ecx
		retn
sub_10012853	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10012964(int, void *, size_t, char,	int)
sub_10012964	proc near		; CODE XREF: sub_10012599+3Dp
					; sub_10012599+51p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_10030298
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 2
		jnb	loc_10012A0A
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_10012A0A
		test	esi, esi
		jz	short loc_10012994
		cmp	[ebp+arg_4], 0
		jz	short loc_10012A0A

loc_10012994:				; CODE XREF: sub_10012964+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_10012A0A
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_10012A0A
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_100129D5
		mov	dword ptr [edi+4], 1

loc_100129D5:				; CODE XREF: sub_10012964+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_10012A0C
; ---------------------------------------------------------------------------

loc_100129FC:				; DATA XREF: .rdata:stru_10030298o
		xor	eax, eax	; Exception filter 0 for function 10012964
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10012A00:				; DATA XREF: .rdata:stru_10030298o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10012964
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_10012A0A:				; CODE XREF: sub_10012964+14j
					; sub_10012964+20j ...
		xor	al, al

loc_10012A0C:				; CODE XREF: sub_10012964+96j
		call	__SEH_epilog4
		retn	14h
sub_10012964	endp

; Exported entry  17. _TargetCreateProcessA@44

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetCreateProcessA(x, x, x, x, x,	x, x, x, x, x, x)
		public _TargetCreateProcessA@44
_TargetCreateProcessA@44 proc near	; DATA XREF: sub_10012515+48o
					; .rdata:off_10030468o

var_264		= dword	ptr -264h
var_260		= dword	ptr -260h
var_25C		= dword	ptr -25Ch
var_258		= dword	ptr -258h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
dwErrCode	= dword	ptr -24Ch
var_248		= byte ptr -248h
var_240		= dword	ptr -240h
var_23C		= byte ptr -23Ch
var_238		= dword	ptr -238h
Buffer		= word ptr -20Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch

		sub	esp, 264h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+264h+var_4], eax
		mov	eax, [esp+264h+arg_8]
		mov	ecx, [esp+264h+arg_20]
		mov	edx, [esp+264h+arg_1C]
		push	ebx
		mov	ebx, [esp+268h+arg_0]
		push	ebp
		push	esi
		mov	esi, [esp+270h+arg_10]
		push	edi
		mov	edi, [esp+274h+arg_C]
		mov	ebp, [esp+274h+arg_4]
		mov	[esp+274h+var_260], ebx
		mov	ebx, [esp+274h+arg_28]
		push	ebx
		mov	[esp+278h+var_264], eax
		mov	eax, [esp+278h+arg_24]
		push	eax
		push	ecx
		push	edx
		push	[esp+284h+arg_18]
		mov	[esp+288h+var_258], ebx
		push	[esp+288h+arg_14]
		mov	ebx, [esp+28Ch+var_260]
		push	esi
		mov	esi, [esp+290h+var_264]
		push	edi
		push	esi
		push	ebp
		call	ebx
		test	eax, eax
		jz	short loc_10012AA3

loc_10012A9B:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+213j
		xor	eax, eax
		inc	eax
		jmp	loc_10012B30
; ---------------------------------------------------------------------------

loc_10012AA3:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+85j
		push	2
		push	ebp
		push	offset aCreateprocessa ; "CreateProcessA"
		call	sub_10002C76
		add	esp, 0Ch
		call	sub_10015880
		mov	ecx, eax
		mov	edx, [eax]
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jz	short loc_10012B2E
		call	ds:GetLastError
		push	1
		push	10h
		push	[esp+27Ch+var_258]
		mov	[esp+280h+dwErrCode], eax
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	short loc_10012B24
		call	sub_10015CC7
		mov	[esp+274h+var_254], eax
		test	eax, eax
		jz	short loc_10012B24
		xor	edi, edi
		xor	ebx, ebx
		test	esi, esi
		jz	short loc_10012B0A
		push	esi
		call	sub_10015AA2
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_10012B24

loc_10012B0A:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+E7j
		test	ebp, ebp
		jz	short loc_10012B4B
		push	ebp
		call	sub_10015AA2
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jnz	short loc_10012B4B
		push	eax
		push	edi
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_10012B24:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+D2j
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+DFj ...
		push	[esp+274h+dwErrCode] ; dwErrCode
		call	ds:SetLastError

loc_10012B2E:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+B4j
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+200j
		xor	eax, eax

loc_10012B30:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+8Aj
		mov	ecx, [esp+274h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 264h
		retn	2Ch
; ---------------------------------------------------------------------------

loc_10012B4B:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+F8j
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+105j
		xor	esi, esi
		test	edi, edi
		jz	short loc_10012B5A
		mov	eax, [edi+4]
		mov	[esp+274h+var_260], eax
		jmp	short loc_10012B5E
; ---------------------------------------------------------------------------

loc_10012B5A:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+13Bj
		mov	[esp+274h+var_260], esi

loc_10012B5E:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+144j
		test	ebx, ebx
		jz	short loc_10012B6B
		mov	eax, [ebx+4]
		mov	[esp+274h+var_264], eax
		jmp	short loc_10012B6F
; ---------------------------------------------------------------------------

loc_10012B6B:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+14Cj
		mov	[esp+274h+var_264], esi

loc_10012B6F:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+155j
		lea	eax, [esp+274h+Buffer]
		mov	[esp+274h+var_25C], esi
		push	eax		; lpBuffer
		push	104h		; nBufferLength
		call	ds:GetCurrentDirectoryW
		test	eax, eax
		jz	short loc_10012B96
		cmp	eax, 104h
		jnb	short loc_10012B96
		lea	eax, [esp+274h+Buffer]
		mov	[esp+274h+var_25C], eax

loc_10012B96:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+171j
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+178j
		push	[esp+274h+var_254]
		lea	ecx, [esp+278h+var_248]
		call	sub_100175A8
		push	30h		; size_t
		lea	eax, [esp+278h+var_23C]
		mov	[esp+278h+var_240], esi
		push	esi		; int
		push	eax		; void *
		call	memset
		mov	eax, [esp+280h+var_258]
		mov	[esp+280h+var_250], eax
		lea	eax, [esp+280h+var_240]
		push	eax
		lea	eax, [esp+284h+var_254]
		mov	[esp+284h+var_254], 10h
		push	eax
		lea	eax, [esp+288h+var_25C]
		push	eax
		lea	eax, [esp+28Ch+var_260]
		push	eax
		lea	eax, [esp+290h+var_264]
		push	eax
		lea	eax, [esp+294h+var_248]
		push	0Dh
		push	eax
		call	sub_10012853
		push	0
		push	edi
		mov	esi, eax
		call	sub_100158E4
		push	0
		push	ebx
		call	sub_100158E4
		add	esp, 38h
		test	esi, esi
		jnz	loc_10012B24
		push	[esp+274h+var_238] ; dwErrCode
		call	ds:SetLastError
		cmp	[esp+274h+var_238], esi
		jnz	loc_10012B2E
		push	ebp
		push	offset aCreateprocessa ; "CreateProcessA"
		call	sub_10002B72
		pop	ecx
		pop	ecx
		jmp	loc_10012A9B
_TargetCreateProcessA@44 endp

; Exported entry  18. _TargetCreateProcessW@44

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetCreateProcessW(x, x, x, x, x,	x, x, x, x, x, x)
		public _TargetCreateProcessW@44
_TargetCreateProcessW@44 proc near	; DATA XREF: sub_10012515+1Co
					; .rdata:off_10030468o

var_25C		= dword	ptr -25Ch
var_258		= dword	ptr -258h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_248		= dword	ptr -248h
var_240		= dword	ptr -240h
var_23C		= byte ptr -23Ch
dwErrCode	= dword	ptr -238h
Buffer		= word ptr -20Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch

		sub	esp, 25Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+25Ch+var_4], eax
		mov	eax, [esp+25Ch+arg_4]
		mov	ecx, [esp+25Ch+arg_20]
		mov	edx, [esp+25Ch+arg_1C]
		push	ebx
		push	ebp
		mov	ebp, [esp+264h+arg_0]
		push	esi
		mov	esi, [esp+268h+arg_10]
		mov	ebx, [esp+268h+arg_8]
		push	edi
		mov	edi, [esp+26Ch+arg_C]
		mov	[esp+26Ch+var_248], ebp
		mov	ebp, [esp+26Ch+arg_28]
		push	ebp
		mov	[esp+270h+var_25C], eax
		mov	[esp+270h+var_24C], eax
		mov	eax, [esp+270h+arg_24]
		push	eax
		push	ecx
		push	edx
		push	[esp+27Ch+arg_18]
		mov	[esp+280h+var_258], ebp
		push	[esp+280h+arg_14]
		mov	ebp, [esp+284h+var_248]
		push	esi
		mov	esi, [esp+288h+var_25C]
		push	edi
		push	ebx
		push	esi
		mov	[esp+294h+var_250], ebx
		call	ebp
		test	eax, eax
		jz	short loc_10012CC3

loc_10012CBB:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+18Aj
		xor	eax, eax
		inc	eax
		jmp	loc_10012DC4
; ---------------------------------------------------------------------------

loc_10012CC3:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+8Dj
		push	esi		; void *
		push	offset aCreateprocessw ; "CreateProcessW"
		call	sub_10002C98
		pop	ecx
		pop	ecx
		call	sub_10015880
		mov	ecx, eax
		mov	edx, [eax]
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jz	loc_10012DC2
		call	ds:GetLastError
		mov	ebx, [esp+26Ch+var_258]
		mov	ebp, eax
		push	1
		push	10h
		push	ebx
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_10012DBB
		call	sub_10015CC7
		mov	edi, eax
		test	edi, edi
		jz	loc_10012DBB
		and	[esp+26Ch+var_25C], 0
		lea	eax, [esp+26Ch+Buffer]
		push	eax		; lpBuffer
		push	104h		; nBufferLength
		call	ds:GetCurrentDirectoryW
		test	eax, eax
		jz	short loc_10012D43
		cmp	eax, 104h
		jnb	short loc_10012D43
		lea	eax, [esp+26Ch+Buffer]
		mov	[esp+26Ch+var_25C], eax

loc_10012D43:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+106j
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+10Dj
		push	edi
		lea	ecx, [esp+270h+var_248]
		call	sub_100175A8
		and	[esp+26Ch+var_240], 0
		lea	eax, [esp+26Ch+var_23C]
		push	30h		; size_t
		push	0		; int
		push	eax		; void *
		call	memset
		lea	eax, [esp+278h+var_240]
		mov	[esp+278h+var_258], 10h
		push	eax
		lea	eax, [esp+27Ch+var_258]
		mov	[esp+27Ch+var_254], ebx
		push	eax
		lea	eax, [esp+280h+var_25C]
		push	eax
		lea	eax, [esp+284h+var_250]
		push	eax
		lea	eax, [esp+288h+var_24C]
		push	eax
		lea	eax, [esp+28Ch+var_248]
		push	0Dh
		push	eax
		call	sub_10012742
		add	esp, 28h
		test	eax, eax
		jnz	short loc_10012DBB
		push	[esp+26Ch+dwErrCode] ; dwErrCode
		call	ds:SetLastError
		cmp	[esp+26Ch+dwErrCode], 0
		jnz	short loc_10012DC2
		push	esi		; void *
		push	offset aCreateprocessw ; "CreateProcessW"
		call	sub_10002B92
		pop	ecx
		pop	ecx
		jmp	loc_10012CBB
; ---------------------------------------------------------------------------

loc_10012DBB:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+DAj
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+E9j ...
		push	ebp		; dwErrCode
		call	ds:SetLastError

loc_10012DC2:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+B9j
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+17Bj
		xor	eax, eax

loc_10012DC4:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+92j
		mov	ecx, [esp+26Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 25Ch
		retn	2Ch
_TargetCreateProcessW@44 endp

; Exported entry  29. _TargetNtOpenProcess@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenProcess(x, x, x, x, x)
		public _TargetNtOpenProcess@20
_TargetNtOpenProcess@20	proc near	; DATA XREF: sub_1001026A+3Co
					; .rdata:off_10030468o

var_68		= dword	ptr -68h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_51		= byte ptr -51h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	58h
		push	offset stru_10030230
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		mov	[ebp+var_5C], ecx
		mov	esi, [ebp+arg_C]
		mov	ebx, [ebp+arg_10]
		push	ebx
		push	esi
		push	[ebp+arg_8]
		push	ecx
		call	eax
		mov	edi, eax
		mov	[ebp+var_58], edi
		test	edi, edi
		jns	loc_10012EF8
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jz	loc_10012EF6
		test	ebx, ebx
		jz	loc_10012EF6
		xor	eax, eax
		mov	cl, al
		mov	[ebp+ms_exc.registration.TryLevel], eax
		test	esi, esi
		jz	short loc_10012E5B
		cmp	[esi+0Ch], eax
		jnz	short loc_10012E56
		cmp	[esi+8], eax
		jnz	short loc_10012E56
		cmp	[esi+4], eax
		jnz	short loc_10012E56
		cmp	[esi+10h], eax
		jnz	short loc_10012E56
		cmp	[esi+14h], eax
		jz	short loc_10012E5B

loc_10012E56:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+61j
					; TargetNtOpenProcess(x,x,x,x,x)+66j ...
		mov	cl, 1
		mov	[ebp+var_51], cl

loc_10012E5B:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+5Cj
					; TargetNtOpenProcess(x,x,x,x,x)+75j
		mov	eax, [ebx]
		mov	[ebp+var_60], eax
		push	0FFFFFFFEh
		pop	ebx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		test	cl, cl
		jnz	loc_10012EF6
		push	1
		push	4
		mov	esi, [ebp+var_5C]
		push	esi
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	short loc_10012EF6
		call	sub_10015CC7
		test	eax, eax
		jz	short loc_10012EF6
		push	eax
		lea	ecx, [ebp+var_68]
		call	sub_100175A8
		and	[ebp+var_50], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+var_60]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		push	0Ah		; int
		lea	eax, [ebp+var_68]
		push	eax		; int
		call	sub_10012599
		add	esp, 20h
		test	eax, eax
		jnz	short loc_10012EF6
		mov	ecx, [ebp+var_48]
		test	ecx, ecx
		jns	short loc_10012ECE

loc_10012ECA:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+FEj
		mov	eax, ecx
		jmp	short loc_10012EF8
; ---------------------------------------------------------------------------

loc_10012ECE:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+E9j
		mov	[ebp+ms_exc.registration.TryLevel], 1
		mov	eax, [ebp+var_40]
		mov	[esi], eax
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		jmp	short loc_10012ECA
; ---------------------------------------------------------------------------

loc_10012EDF:				; DATA XREF: .rdata:stru_10030230o
		xor	eax, eax	; Exception filter 1 for function 10012DDF
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10012EE3:				; DATA XREF: .rdata:stru_10030230o
		jmp	short loc_10012EE9 ; Exception handler 1 for function 10012DDF
; ---------------------------------------------------------------------------

loc_10012EE5:				; DATA XREF: .rdata:stru_10030230o
		xor	eax, eax	; Exception filter 0 for function 10012DDF
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10012EE9:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x):loc_10012EE3j
					; DATA XREF: .rdata:stru_10030230o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10012DDF
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edi, [ebp+var_58]

loc_10012EF6:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+45j
					; TargetNtOpenProcess(x,x,x,x,x)+4Dj ...
		mov	eax, edi

loc_10012EF8:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+2Aj
					; TargetNtOpenProcess(x,x,x,x,x)+EDj
		call	__SEH_epilog4_GS
		retn	14h
_TargetNtOpenProcess@20	endp

; Exported entry  30. _TargetNtOpenProcessToken@16

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenProcessToken(x,	x, x, x)
		public _TargetNtOpenProcessToken@16
_TargetNtOpenProcessToken@16 proc near	; DATA XREF: sub_1001026A+66o
					; .rdata:off_10030468o

var_60		= dword	ptr -60h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	50h
		push	offset stru_10030258
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	edi, [ebp+arg_4]
		mov	[ebp+var_58], edi
		mov	ebx, [ebp+arg_C]
		push	ebx
		push	[ebp+arg_8]
		push	edi
		call	eax
		mov	esi, eax
		mov	[ebp+var_54], esi
		test	esi, esi
		jns	loc_10012FEE
		push	2
		push	0
		push	offset aNtopenprocesst ; "NtOpenProcessToken"
		call	sub_10002C76
		add	esp, 0Ch
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jz	loc_10012FEC
		cmp	edi, 0FFFFFFFFh
		jnz	loc_10012FEC
		push	1
		push	4
		push	ebx
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	short loc_10012FEC
		call	sub_10015CC7
		test	eax, eax
		jz	short loc_10012FEC
		push	eax
		lea	ecx, [ebp+var_60]
		call	sub_100175A8
		xor	edi, edi
		mov	[ebp+var_50], edi
		push	30h		; size_t
		push	edi		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+var_58]
		push	eax		; int
		push	0Bh		; int
		lea	eax, [ebp+var_60]
		push	eax		; int
		call	sub_10012619
		add	esp, 20h
		test	eax, eax
		jnz	short loc_10012FEC
		mov	eax, [ebp+var_48]
		test	eax, eax
		js	short loc_10012FEE
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebp+var_40]
		mov	[ebx], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		push	edi
		push	offset aNtopenprocesst ; "NtOpenProcessToken"
		call	sub_10002B72
		pop	ecx
		pop	ecx
		mov	eax, [ebp+var_48]
		jmp	short loc_10012FEE
; ---------------------------------------------------------------------------

loc_10012FDB:				; DATA XREF: .rdata:stru_10030258o
		xor	eax, eax	; Exception filter 0 for function 10012F00
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10012FDF:				; DATA XREF: .rdata:stru_10030258o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10012F00
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+var_54]

loc_10012FEC:				; CODE XREF: TargetNtOpenProcessToken(x,x,x,x)+52j
					; TargetNtOpenProcessToken(x,x,x,x)+5Bj ...
		mov	eax, esi

loc_10012FEE:				; CODE XREF: TargetNtOpenProcessToken(x,x,x,x)+26j
					; TargetNtOpenProcessToken(x,x,x,x)+B8j ...
		call	__SEH_epilog4_GS
		retn	10h
_TargetNtOpenProcessToken@16 endp

; Exported entry  31. _TargetNtOpenProcessTokenEx@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenProcessTokenEx(x, x, x,	x, x)
		public _TargetNtOpenProcessTokenEx@20
_TargetNtOpenProcessTokenEx@20 proc near ; DATA	XREF: sub_1001026A+EAo
					; .rdata:off_10030468o

var_60		= dword	ptr -60h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	50h
		push	offset stru_10030278
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	edi, [ebp+arg_4]
		mov	[ebp+var_58], edi
		mov	ebx, [ebp+arg_10]
		push	ebx
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		call	eax
		mov	esi, eax
		mov	[ebp+var_54], esi
		test	esi, esi
		jns	loc_100130EB
		push	2
		push	0
		push	offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		call	sub_10002C76
		add	esp, 0Ch
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jz	loc_100130E9
		cmp	edi, 0FFFFFFFFh
		jnz	loc_100130E9
		push	1
		push	4
		push	ebx
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	short loc_100130E9
		call	sub_10015CC7
		test	eax, eax
		jz	short loc_100130E9
		push	eax
		lea	ecx, [ebp+var_60]
		call	sub_100175A8
		xor	edi, edi
		mov	[ebp+var_50], edi
		push	30h		; size_t
		push	edi		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+arg_C]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+var_58]
		push	eax		; int
		push	0Ch		; int
		lea	eax, [ebp+var_60]
		push	eax		; int
		call	sub_100126A2
		add	esp, 24h
		test	eax, eax
		jnz	short loc_100130E9
		mov	eax, [ebp+var_48]
		test	eax, eax
		js	short loc_100130EB
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebp+var_40]
		mov	[ebx], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		push	edi
		push	offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		call	sub_10002B72
		pop	ecx
		pop	ecx
		mov	eax, [ebp+var_48]
		jmp	short loc_100130EB
; ---------------------------------------------------------------------------

loc_100130D8:				; DATA XREF: .rdata:stru_10030278o
		xor	eax, eax	; Exception filter 0 for function 10012FF6
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100130DC:				; DATA XREF: .rdata:stru_10030278o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10012FF6
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+var_54]

loc_100130E9:				; CODE XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+55j
					; TargetNtOpenProcessTokenEx(x,x,x,x,x)+5Ej ...
		mov	eax, esi

loc_100130EB:				; CODE XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+29j
					; TargetNtOpenProcessTokenEx(x,x,x,x,x)+BFj ...
		call	__SEH_epilog4_GS
		retn	14h
_TargetNtOpenProcessTokenEx@20 endp

; Exported entry  32. _TargetNtOpenThread@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenThread(x, x, x,	x, x)
		public _TargetNtOpenThread@20
_TargetNtOpenThread@20 proc near	; DATA XREF: sub_1001026A+7o
					; .rdata:off_10030468o

var_68		= dword	ptr -68h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_51		= byte ptr -51h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	58h
		push	offset stru_10030208
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		mov	[ebp+var_5C], ecx
		mov	edi, [ebp+arg_C]
		mov	ebx, [ebp+arg_10]
		push	ebx
		push	edi
		push	[ebp+arg_8]
		push	ecx
		call	eax
		mov	esi, eax
		mov	[ebp+var_58], esi
		test	esi, esi
		jns	loc_1001323E
		push	2
		push	0
		push	offset aNtopenthread ; "NtOpenThread"
		call	sub_10002C76
		add	esp, 0Ch
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jz	loc_1001323C
		test	ebx, ebx
		jz	loc_1001323C
		xor	eax, eax
		mov	cl, al
		mov	[ebp+ms_exc.registration.TryLevel], eax
		cmp	[ebx], eax
		jz	short loc_10013167
		mov	cl, 1
		mov	[ebp+var_51], cl

loc_10013167:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+6Dj
		test	cl, cl
		jnz	short loc_1001318D
		test	edi, edi
		jz	short loc_1001318D
		cmp	[edi+0Ch], eax
		jnz	short loc_10013188
		cmp	[edi+8], eax
		jnz	short loc_10013188
		cmp	[edi+4], eax
		jnz	short loc_10013188
		cmp	[edi+10h], eax
		jnz	short loc_10013188
		cmp	[edi+14h], eax
		jz	short loc_1001318D

loc_10013188:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+7Fj
					; TargetNtOpenThread(x,x,x,x,x)+84j ...
		mov	cl, 1
		mov	[ebp+var_51], cl

loc_1001318D:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+76j
					; TargetNtOpenThread(x,x,x,x,x)+7Aj ...
		mov	eax, [ebx+4]
		mov	[ebp+var_60], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		test	cl, cl
		jnz	loc_1001323C
		push	1
		push	4
		mov	edi, [ebp+var_5C]
		push	edi
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_1001323C
		call	sub_10015CC7
		test	eax, eax
		jz	short loc_1001323C
		push	eax
		lea	ecx, [ebp+var_68]
		call	sub_100175A8
		xor	ebx, ebx
		mov	[ebp+var_50], ebx
		push	30h		; size_t
		push	ebx		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+var_60]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		push	9		; int
		lea	eax, [ebp+var_68]
		push	eax		; int
		call	sub_10012599
		add	esp, 20h
		test	eax, eax
		jnz	short loc_1001323C
		cmp	[ebp+var_48], ebx
		jl	short loc_1001323C
		mov	[ebp+ms_exc.registration.TryLevel], 1
		mov	eax, [ebp+var_40]
		mov	[edi], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		push	ebx
		push	offset aNtopenthread ; "NtOpenThread"
		call	sub_10002B72
		pop	ecx
		pop	ecx
		mov	eax, [ebp+var_48]
		jmp	short loc_1001323E
; ---------------------------------------------------------------------------

loc_10013225:				; DATA XREF: .rdata:stru_10030208o
		xor	eax, eax	; Exception filter 1 for function 100130F3
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013229:				; DATA XREF: .rdata:stru_10030208o
		jmp	short loc_1001322F ; Exception handler 1 for function 100130F3
; ---------------------------------------------------------------------------

loc_1001322B:				; DATA XREF: .rdata:stru_10030208o
		xor	eax, eax	; Exception filter 0 for function 100130F3
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001322F:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x):loc_10013229j
					; DATA XREF: .rdata:stru_10030208o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100130F3
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+var_58]

loc_1001323C:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+56j
					; TargetNtOpenThread(x,x,x,x,x)+5Ej ...
		mov	eax, esi

loc_1001323E:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+2Aj
					; TargetNtOpenThread(x,x,x,x,x)+130j
		call	__SEH_epilog4_GS
		retn	14h
_TargetNtOpenThread@20 endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10013246(void *)
sub_10013246	proc near		; CODE XREF: sub_1001338E+7Ap
					; sub_1001362E+Dp

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jz	short locret_10013260
		mov	ecx, [esp+arg_0]
		call	sub_10011108
		push	[esp+arg_0]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

locret_10013260:			; CODE XREF: sub_10013246+5j
		retn	4
sub_10013246	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10013263(HANDLE hTargetProcessHandle,	int, LPCWSTR lpApplicationName,	LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL	bInheritHandles, DWORD dwCreationFlags,	LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
sub_10013263	proc near		; CODE XREF: sub_100132F9+6Fp

hTargetProcessHandle= dword ptr	 8
arg_4		= dword	ptr  0Ch
lpApplicationName= dword ptr  10h
lpCommandLine	= dword	ptr  14h
lpProcessAttributes= dword ptr	18h
lpThreadAttributes= dword ptr  1Ch
bInheritHandles	= dword	ptr  20h
dwCreationFlags	= dword	ptr  24h
lpEnvironment	= dword	ptr  28h
lpCurrentDirectory= dword ptr  2Ch
lpStartupInfo	= dword	ptr  30h
lpProcessInformation= dword ptr	 34h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+lpProcessInformation]
		push	esi		; lpProcessInformation
		push	[ebp+lpStartupInfo] ; lpStartupInfo
		push	[ebp+lpCurrentDirectory] ; lpCurrentDirectory
		push	[ebp+lpEnvironment] ; lpEnvironment
		push	[ebp+dwCreationFlags] ;	dwCreationFlags
		push	[ebp+bInheritHandles] ;	bInheritHandles
		push	[ebp+lpThreadAttributes] ; lpThreadAttributes
		push	[ebp+lpProcessAttributes] ; lpProcessAttributes
		push	[ebp+lpCommandLine] ; lpCommandLine
		push	[ebp+lpApplicationName]	; lpApplicationName
		call	ds:CreateProcessW
		test	eax, eax
		jz	short loc_100132F6
		cmp	[ebp+arg_4], 0
		mov	eax, 101C01h
		push	edi
		mov	edi, 100C43h
		jz	short loc_100132AB
		mov	eax, 1F0FFFh
		mov	edi, 1F03FFh

loc_100132AB:				; CODE XREF: sub_10013263+3Cj
		push	1		; dwOptions
		push	0		; bInheritHandle
		push	eax		; dwDesiredAccess
		push	esi		; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	dword ptr [esi]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_100132D4
		push	dword ptr [esi+4] ; hObject
		call	ds:CloseHandle
		xor	eax, eax
		jmp	short loc_100132F5
; ---------------------------------------------------------------------------

loc_100132D4:				; CODE XREF: sub_10013263+62j
		push	1		; dwOptions
		push	0		; bInheritHandle
		push	edi		; dwDesiredAccess
		lea	eax, [esi+4]
		push	eax		; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	dword ptr [eax]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		neg	eax

loc_100132F5:				; CODE XREF: sub_10013263+6Fj
		pop	edi

loc_100132F6:				; CODE XREF: sub_10013263+2Bj
		pop	esi
		pop	ebp
		retn
sub_10013263	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100132F9(int,	int, LPCWSTR lpApplicationName,	wchar_t	*, LPPROCESS_INFORMATION lpProcessInformation)
sub_100132F9	proc near		; CODE XREF: sub_100121D9+10Dp

StartupInfo	= _STARTUPINFOW	ptr -44h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpApplicationName= dword ptr  10h
arg_C		= dword	ptr  14h
lpProcessInformation= dword ptr	 18h

		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		cmp	[ebp+arg_0], 6
		jz	short loc_10013310
		cmp	[ebp+arg_0], 5
		jz	short loc_10013310
		push	5
		pop	eax
		jmp	short loc_1001338A
; ---------------------------------------------------------------------------

loc_10013310:				; CODE XREF: sub_100132F9+Aj
					; sub_100132F9+10j
		push	esi
		push	edi
		push	40h		; size_t
		xor	edi, edi
		lea	eax, [ebp+StartupInfo.lpReserved]
		push	edi		; int
		push	eax		; void *
		call	memset
		mov	eax, [ebp+arg_C]
		add	esp, 0Ch
		mov	[ebp+StartupInfo.cb], 44h
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10013335
		mov	eax, [eax]

loc_10013335:				; CODE XREF: sub_100132F9+38j
		push	eax		; wchar_t *
		call	ds:_wcsdup
		pop	ecx
		xor	ecx, ecx
		mov	esi, eax
		cmp	[ebp+arg_0], 6
		mov	eax, [ebp+lpApplicationName]
		setz	cl
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10013353
		mov	eax, [eax]

loc_10013353:				; CODE XREF: sub_100132F9+56j
		push	[ebp+lpProcessInformation] ; lpProcessInformation
		lea	edx, [ebp+StartupInfo]
		push	edx		; lpStartupInfo
		push	edi		; lpCurrentDirectory
		push	edi		; lpEnvironment
		push	edi		; dwCreationFlags
		push	edi		; bInheritHandles
		push	edi		; lpThreadAttributes
		push	edi		; lpProcessAttributes
		push	esi		; lpCommandLine
		push	eax		; lpApplicationName
		mov	eax, [ebp+arg_4]
		push	ecx		; int
		push	dword ptr [eax]	; hTargetProcessHandle
		call	sub_10013263
		add	esp, 30h
		mov	edi, eax
		neg	edi
		sbb	edi, edi
		and	edi, 0FFFFFFFBh
		test	esi, esi
		jz	short loc_10013385
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_10013385:				; CODE XREF: sub_100132F9+82j
		lea	eax, [edi+5]
		pop	edi
		pop	esi

loc_1001338A:				; CODE XREF: sub_100132F9+15j
		mov	esp, ebp
		pop	ebp
		retn
sub_100132F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001338E	proc near		; CODE XREF: sub_1001651A+D7p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_4]
		push	ebx
		push	esi
		xor	esi, esi
		mov	[ebp+var_4], esi
		sub	eax, 7
		jz	short loc_100133B4
		dec	eax
		jnz	short loc_100133FE
		push	10h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100133CB
		push	6
		jmp	short loc_100133C2
; ---------------------------------------------------------------------------

loc_100133B4:				; CODE XREF: sub_1001338E+11j
		push	10h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100133CB
		push	5

loc_100133C2:				; CODE XREF: sub_1001338E+24j
		mov	ecx, eax
		call	sub_10011053
		jmp	short loc_100133CD
; ---------------------------------------------------------------------------

loc_100133CB:				; CODE XREF: sub_1001338E+20j
					; sub_1001338E+30j
		xor	eax, eax

loc_100133CD:				; CODE XREF: sub_1001338E+3Bj
		push	eax
		lea	ecx, [ebp+var_4]
		call	sub_1001362E
		mov	esi, [ebp+var_4]
		xor	ebx, ebx
		inc	ebx
		mov	ecx, esi
		push	ebx
		push	[ebp+arg_0]
		push	0
		push	0
		call	sub_10011215
		test	al, al
		jz	short loc_100133FE
		mov	ecx, [ebp+arg_8]
		push	esi
		push	0Dh
		call	sub_100111C8
		test	al, al
		jnz	short loc_10013400

loc_100133FE:				; CODE XREF: sub_1001338E+14j
					; sub_1001338E+5Fj
		xor	bl, bl

loc_10013400:				; CODE XREF: sub_1001338E+6Ej
		test	esi, esi
		jz	short loc_1001340D
		push	esi		; void *
		lea	ecx, [ebp+var_4]
		call	sub_10013246

loc_1001340D:				; CODE XREF: sub_1001338E+74j
		pop	esi
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1001338E	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10013415(int,	int, int, LPHANDLE lpTargetHandle)
sub_10013415	proc near		; CODE XREF: sub_10012456+15p

hSourceHandle	= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
lpTargetHandle	= dword	ptr  10h

		sub	esp, 24h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+30h+lpTargetHandle]
		lea	eax, [esp+30h+lpTargetHandle]
		push	eax		; int
		xor	ebp, ebp
		push	offset aNtopenprocess ;	"NtOpenProcess"
		mov	[esi], ebp
		mov	[esp+38h+lpTargetHandle], ebp
		call	sub_1001A242
		mov	ebx, [esp+38h+arg_0]
		pop	ecx
		pop	ecx
		mov	ecx, [ebx+8]
		cmp	ecx, [esp+30h+arg_8]
		jz	short loc_1001344C
		mov	eax, 0C0000022h
		jmp	short loc_100134A9
; ---------------------------------------------------------------------------

loc_1001344C:				; CODE XREF: sub_10013415+2Ej
		push	edi
		xor	eax, eax
		mov	[esp+34h+var_1C], ebp
		lea	edi, [esp+34h+var_14]
		mov	[esp+34h+var_20], ecx
		stosd
		stosd
		stosd
		stosd
		stosd
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_18]
		mov	[esp+38h+var_18], 18h
		push	eax
		push	[esp+3Ch+arg_4]
		lea	eax, [esp+40h+hSourceHandle]
		push	eax
		call	[esp+44h+lpTargetHandle]
		mov	edi, eax
		test	edi, edi
		js	short loc_100134A6
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	esi		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+48h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_100134A8

loc_100134A6:				; CODE XREF: sub_10013415+6Ej
		mov	eax, edi

loc_100134A8:				; CODE XREF: sub_10013415+8Fj
		pop	edi

loc_100134A9:				; CODE XREF: sub_10013415+35j
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 24h
		retn
sub_10013415	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100134B0(int,	int, int, LPHANDLE lpTargetHandle)
sub_100134B0	proc near		; CODE XREF: sub_10012485+15p

hSourceHandle	= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
lpTargetHandle	= dword	ptr  10h

		push	ecx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+lpTargetHandle]
		lea	eax, [esp+0Ch+lpTargetHandle]
		push	eax		; int
		xor	ebp, ebp
		push	offset aNtopenprocesst ; "NtOpenProcessToken"
		mov	[esi], ebp
		mov	[esp+14h+lpTargetHandle], ebp
		call	sub_1001A242
		cmp	[esp+14h+arg_4], 0FFFFFFFFh
		pop	ecx
		pop	ecx
		jz	short loc_100134DE
		mov	eax, 0C0000022h
		jmp	short loc_1001351E
; ---------------------------------------------------------------------------

loc_100134DE:				; CODE XREF: sub_100134B0+25j
		push	ebx
		mov	ebx, [esp+10h+arg_0]
		lea	eax, [esp+10h+hSourceHandle]
		push	edi
		push	eax
		push	[esp+18h+arg_8]
		push	dword ptr [ebx]
		call	[esp+20h+lpTargetHandle]
		mov	edi, eax
		test	edi, edi
		js	short loc_1001351A
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	esi		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+28h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_1001351C

loc_1001351A:				; CODE XREF: sub_100134B0+47j
		mov	eax, edi

loc_1001351C:				; CODE XREF: sub_100134B0+68j
		pop	edi
		pop	ebx

loc_1001351E:				; CODE XREF: sub_100134B0+2Cj
		pop	esi
		pop	ebp
		pop	ecx
		retn
sub_100134B0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10013522(int,	int, int, int, LPHANDLE	lpTargetHandle)
sub_10013522	proc near		; CODE XREF: sub_100124B4+18p

hSourceHandle	= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
lpTargetHandle	= dword	ptr  14h

		push	ecx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+lpTargetHandle]
		lea	eax, [esp+0Ch+lpTargetHandle]
		push	eax		; int
		xor	ebp, ebp
		push	offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		mov	[esi], ebp
		mov	[esp+14h+lpTargetHandle], ebp
		call	sub_1001A242
		cmp	[esp+14h+arg_4], 0FFFFFFFFh
		pop	ecx
		pop	ecx
		jz	short loc_10013550
		mov	eax, 0C0000022h
		jmp	short loc_10013594
; ---------------------------------------------------------------------------

loc_10013550:				; CODE XREF: sub_10013522+25j
		push	ebx
		mov	ebx, [esp+10h+arg_0]
		lea	eax, [esp+10h+hSourceHandle]
		push	edi
		push	eax
		push	[esp+18h+arg_C]
		push	[esp+1Ch+arg_8]
		push	dword ptr [ebx]
		call	[esp+24h+lpTargetHandle]
		mov	edi, eax
		test	edi, edi
		js	short loc_10013590
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	esi		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+28h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10013592

loc_10013590:				; CODE XREF: sub_10013522+4Bj
		mov	eax, edi

loc_10013592:				; CODE XREF: sub_10013522+6Cj
		pop	edi
		pop	ebx

loc_10013594:				; CODE XREF: sub_10013522+2Cj
		pop	esi
		pop	ebp
		pop	ecx
		retn
sub_10013522	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10013598(int,	int, int, LPHANDLE lpTargetHandle)
sub_10013598	proc near		; CODE XREF: sub_100124E6+15p

hSourceHandle	= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
lpTargetHandle	= dword	ptr  10h

		sub	esp, 24h
		push	ebx
		mov	ebx, [esp+28h+lpTargetHandle]
		lea	eax, [esp+28h+lpTargetHandle]
		push	ebp
		push	esi
		push	edi
		push	eax		; int
		xor	ebp, ebp
		push	offset aNtopenthread ; "NtOpenThread"
		mov	[ebx], ebp
		mov	[esp+3Ch+lpTargetHandle], ebp
		call	sub_1001A242
		xor	eax, eax
		mov	[esp+3Ch+var_1C], ebp
		lea	edi, [esp+3Ch+var_14]
		stosd
		pop	ecx
		pop	ecx
		stosd
		stosd
		stosd
		stosd
		mov	edi, [esp+34h+arg_0]
		mov	[esp+34h+var_18], 18h
		mov	eax, [edi+8]
		mov	[esp+34h+var_20], eax
		mov	eax, [esp+34h+arg_8]
		mov	[esp+34h+var_1C], eax
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_18]
		push	eax
		push	[esp+3Ch+arg_4]
		lea	eax, [esp+40h+hSourceHandle]
		push	eax
		call	[esp+44h+lpTargetHandle]
		mov	esi, eax
		test	esi, esi
		js	short loc_10013624
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	ebx		; lpTargetHandle
		push	dword ptr [edi]	; hTargetProcessHandle
		push	[esp+48h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10013626

loc_10013624:				; CODE XREF: sub_10013598+69j
		mov	eax, esi

loc_10013626:				; CODE XREF: sub_10013598+8Aj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 24h
		retn
sub_10013598	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001362E	proc near		; CODE XREF: sub_1001338E+43p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		and	dword ptr [esi], 0
		test	eax, eax
		jz	short loc_10013640
		push	eax		; void *
		call	sub_10013246

loc_10013640:				; CODE XREF: sub_1001362E+Aj
		mov	eax, [esp+4+arg_0]
		mov	[esi], eax
		pop	esi
		retn	4
sub_1001362E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001364A	proc near		; CODE XREF: sub_10016099+182p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	eax, eax
		push	offset dword_1001DEA0
		lea	esi, [edi+4]
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_0]
		mov	dword ptr [edi], offset	off_1001DE94
		mov	[edi+10h], eax
		call	sub_1000ADE8
		push	offset dword_1001DECC
		mov	ecx, esi
		call	sub_1000ADE8
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_1001364A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013687	proc near		; CODE XREF: sub_100136DB+6Cp
					; sub_1001380F+6Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_100136CC
		push	[ebp+arg_8]
		push	[ebp+arg_0]
		call	sub_10019FF6
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_100136A3
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100136A3:				; CODE XREF: sub_10013687+18j
		push	esi
		mov	esi, offset asc_1001CF44 ; "\\"
		push	esi
		call	sub_100024E3
		pop	ecx
		mov	ecx, [ebp+arg_8]
		push	eax		; int
		push	esi		; void *
		call	sub_10003950
		mov	ecx, [ebp+arg_8]
		push	0FFFFFFFFh
		push	0
		push	[ebp+arg_4]
		call	sub_100038B8
		pop	esi
		jmp	short loc_100136D7
; ---------------------------------------------------------------------------

loc_100136CC:				; CODE XREF: sub_10013687+7j
		push	[ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		call	sub_10004052

loc_100136D7:				; CODE XREF: sub_10013687+43j
		mov	al, 1
		pop	ebp
		retn
sub_10013687	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100136DB	proc near		; DATA XREF: .rdata:1001DEC8o

TargetHandle	= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
hSourceHandle	= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_C]
		and	[ebp+var_38], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		lea	ecx, [ebp+var_30]
		push	edi
		mov	[ebp+hSourceHandle], eax
		call	sub_10003B1C
		mov	eax, [ebp+hSourceHandle]
		test	eax, eax
		jz	short loc_10013741
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [ebp+hSourceHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [esi+4]
		push	[ebp+hSourceHandle] ; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10013753
		push	[ebp+hSourceHandle]
		lea	ecx, [ebp+var_38]
		call	sub_10004DE8
		mov	eax, [ebp+hSourceHandle]

loc_10013741:				; CODE XREF: sub_100136DB+33j
		lea	ecx, [ebp+var_30]
		push	ecx
		push	edi
		push	eax
		call	sub_10013687
		add	esp, 0Ch
		test	al, al
		jnz	short loc_1001375A

loc_10013753:				; CODE XREF: sub_100136DB+56j
		xor	bl, bl
		jmp	loc_100137E6
; ---------------------------------------------------------------------------

loc_1001375A:				; CODE XREF: sub_100136DB+76j
		cmp	[ebp+var_1C], 8
		mov	eax, [ebp+var_30]
		jnb	short loc_10013766
		lea	eax, [ebp+var_30]

loc_10013766:				; CODE XREF: sub_100136DB+86j
		lea	ecx, [ebp+var_18]
		mov	[ebp+var_40], eax
		call	sub_10018707
		mov	ecx, [ebx+10h]
		lea	eax, [ebp+var_40]
		mov	[ebp+var_10], eax
		lea	eax, [ebp+arg_10]
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_18]
		push	eax
		push	10h
		mov	[ebp+var_14], 1
		mov	[ebp+var_C], 2
		call	sub_100168E1
		and	[ebp+var_3C], 0
		lea	ecx, [ebp+var_3C]
		push	ecx		; int
		lea	ecx, [ebp+var_44]
		push	ecx		; int
		lea	ecx, [ebp+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_18]	; int
		push	[ebp+arg_14]	; int
		push	[ebp+arg_10]	; int
		push	[ebp+hSourceHandle] ; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		push	dword ptr [esi+4] ; int
		push	eax		; int
		call	sub_10013FC3
		add	esp, 2Ch
		mov	bl, 1
		test	al, al
		jnz	short loc_100137D4
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	short loc_100137E6
; ---------------------------------------------------------------------------

loc_100137D4:				; CODE XREF: sub_100136DB+EEj
		mov	eax, [ebp+var_3C]
		mov	[esi+1Ch], eax
		mov	eax, [ebp+var_44]
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		mov	[esi+18h], eax

loc_100137E6:				; CODE XREF: sub_100136DB+7Aj
					; sub_100136DB+F7j
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_30] ; void *
		call	sub_100022C1
		lea	ecx, [ebp+var_38]
		call	sub_10004DA3
		mov	ecx, [ebp+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	1Ch
sub_100136DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001380F	proc near		; DATA XREF: .rdata:1001DEF4o

TargetHandle	= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
hSourceHandle	= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_C]
		and	[ebp+var_38], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		lea	ecx, [ebp+var_30]
		push	edi
		mov	[ebp+hSourceHandle], eax
		call	sub_10003B1C
		mov	eax, [ebp+hSourceHandle]
		test	eax, eax
		jz	short loc_10013875
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [ebp+hSourceHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [esi+4]
		push	[ebp+hSourceHandle] ; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10013887
		push	[ebp+hSourceHandle]
		lea	ecx, [ebp+var_38]
		call	sub_10004DE8
		mov	eax, [ebp+hSourceHandle]

loc_10013875:				; CODE XREF: sub_1001380F+33j
		lea	ecx, [ebp+var_30]
		push	ecx
		push	edi
		push	eax
		call	sub_10013687
		add	esp, 0Ch
		test	al, al
		jnz	short loc_1001388B

loc_10013887:				; CODE XREF: sub_1001380F+56j
		xor	bl, bl
		jmp	short loc_10013903
; ---------------------------------------------------------------------------

loc_1001388B:				; CODE XREF: sub_1001380F+76j
		cmp	[ebp+var_1C], 8
		mov	eax, [ebp+var_30]
		jnb	short loc_10013897
		lea	eax, [ebp+var_30]

loc_10013897:				; CODE XREF: sub_1001380F+83j
		lea	ecx, [ebp+var_18]
		mov	[ebp+var_40], eax
		call	sub_10018707
		mov	ecx, [ebx+10h]
		lea	eax, [ebp+var_40]
		mov	[ebp+var_10], eax
		lea	eax, [ebp+arg_10]
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_18]
		push	eax
		push	11h
		mov	[ebp+var_14], 1
		mov	[ebp+var_C], 2
		call	sub_100168E1
		lea	ecx, [ebp+var_3C]
		push	ecx		; int
		lea	ecx, [ebp+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_10]	; int
		push	[ebp+hSourceHandle] ; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		push	dword ptr [esi+4] ; int
		push	eax		; int
		call	sub_10014262
		add	esp, 20h
		mov	bl, 1
		test	al, al
		jnz	short loc_100138F7
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	short loc_10013903
; ---------------------------------------------------------------------------

loc_100138F7:				; CODE XREF: sub_1001380F+DDj
		mov	eax, [ebp+var_3C]
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		mov	[esi+18h], eax

loc_10013903:				; CODE XREF: sub_1001380F+7Aj
					; sub_1001380F+E6j
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_30] ; void *
		call	sub_100022C1
		lea	ecx, [ebp+var_38]
		call	sub_10004DA3
		mov	ecx, [ebp+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	14h
sub_1001380F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001392C	proc near		; DATA XREF: .rdata:1001DE98o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 10h
		jnz	short loc_10013962
		mov	eax, offset _TargetNtCreateKey@32 ; TargetNtCreateKey(x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	loc_100139E0
		mov	ecx, [ebp+arg_0]
		push	11h		; int
		push	offset a_targetntcre_3 ; "_TargetNtCreateKey@32"
		push	1		; int
		push	offset aNtcreatekey ; "NtCreateKey"
		push	offset aNtdll_dll_2 ; "ntdll.dll"
		call	sub_1000EC5D
		jmp	loc_100139E2
; ---------------------------------------------------------------------------

loc_10013962:				; CODE XREF: sub_1001392C+7j
		cmp	[ebp+arg_4], 11h
		jnz	short loc_100139E0
		push	ebx
		mov	eax, offset _TargetNtOpenKey@16	; TargetNtOpenKey(x,x,x,x)
		push	esi
		mov	esi, offset aNtdll_dll_2 ; "ntdll.dll"
		test	eax, eax
		jz	short loc_10013993
		mov	ecx, [ebp+arg_0]
		push	12h		; int
		push	offset a_targetntope_6 ; "_TargetNtOpenKey@16"
		push	1		; int
		push	offset aNtopenkey ; "NtOpenKey"
		push	esi		; void *
		call	sub_1000EC5D
		mov	bl, al
		jmp	short loc_10013995
; ---------------------------------------------------------------------------

loc_10013993:				; CODE XREF: sub_1001392C+4Aj
		xor	bl, bl

loc_10013995:				; CODE XREF: sub_1001392C+65j
		call	sub_10006EF6
		cmp	eax, 4
		jge	short loc_100139B4
		call	sub_10006EF6
		cmp	eax, 3
		jnz	short loc_100139DA
		call	sub_10006EA9
		cmp	dword ptr [eax+10h], 2
		jnz	short loc_100139DA

loc_100139B4:				; CODE XREF: sub_1001392C+71j
		mov	eax, offset _TargetNtOpenKeyEx@20 ; TargetNtOpenKeyEx(x,x,x,x,x)
		test	eax, eax
		jz	short loc_100139D6
		mov	ecx, [ebp+arg_0]
		push	13h		; int
		push	offset a_targetntope_7 ; "_TargetNtOpenKeyEx@20"
		push	1		; int
		push	offset aNtopenkeyex ; "NtOpenKeyEx"
		push	esi		; void *
		call	sub_1000EC5D
		jmp	short loc_100139D8
; ---------------------------------------------------------------------------

loc_100139D6:				; CODE XREF: sub_1001392C+8Fj
		xor	eax, eax

loc_100139D8:				; CODE XREF: sub_1001392C+A8j
		and	bl, al

loc_100139DA:				; CODE XREF: sub_1001392C+7Bj
					; sub_1001392C+86j
		pop	esi
		mov	al, bl
		pop	ebx
		jmp	short loc_100139E2
; ---------------------------------------------------------------------------

loc_100139E0:				; CODE XREF: sub_1001392C+10j
					; sub_1001392C+3Aj
		xor	al, al

loc_100139E2:				; CODE XREF: sub_1001392C+31j
					; sub_1001392C+B2j
		pop	ebp
		retn	8
sub_1001392C	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100139E6(int,	int, int, void *, int, void *, int)
sub_100139E6	proc near		; CODE XREF: sub_10013BAD+ACp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ecx
		mov	ecx, [esp+4+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_100139FF
		push	4
		pop	eax
		jmp	loc_10013AAF
; ---------------------------------------------------------------------------

loc_100139FF:				; CODE XREF: sub_100139E6+Fj
		mov	eax, [esp+8+arg_4]
		lea	ecx, [esp+8+var_4]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_8]
		xor	ebp, ebp
		push	4
		pop	ebx
		mov	[edi], eax
		mov	[edi+4], ebp
		mov	[edi+3Ch], ebx
		mov	dword ptr [edi+44h], 7Ch
		mov	esi, [esi]
		mov	[esp+14h+var_4], esi
		call	sub_1000B44B
		push	1		; int
		push	ebp		; char
		push	eax		; size_t
		push	esi		; void *
		push	ebp		; int
		mov	ecx, edi
		call	sub_1000E821
		test	al, al
		jz	short loc_10013A87
		push	2		; int
		push	ebp		; char
		push	ebx		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	1		; int
		call	sub_1000E821
		test	al, al
		jz	short loc_10013A87
		mov	eax, [esp+14h+arg_10]
		mov	ecx, edi
		push	ebx		; int
		push	ebp		; char
		push	ebx		; size_t
		mov	eax, [eax]
		mov	[esp+20h+var_4], eax
		lea	eax, [esp+20h+var_4]
		push	eax		; void *
		push	2		; int
		call	sub_1000E821
		test	al, al
		jz	short loc_10013A87
		push	2		; int
		push	ebp		; char
		push	ebx		; size_t
		push	[esp+20h+arg_14] ; void	*
		mov	ecx, edi
		push	3		; int
		call	sub_1000E821
		test	al, al
		jnz	short loc_10013A8B

loc_10013A87:				; CODE XREF: sub_100139E6+56j
					; sub_100139E6+6Bj ...
		mov	eax, ebx
		jmp	short loc_10013AAC
; ---------------------------------------------------------------------------

loc_10013A8B:				; CODE XREF: sub_100139E6+9Fj
		push	[esp+14h+arg_18]
		mov	ecx, [esp+18h+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10013AAA
		mov	ecx, [esp+14h+arg_0]
		push	edi
		call	sub_10017671

loc_10013AAA:				; CODE XREF: sub_100139E6+B8j
		mov	eax, esi

loc_10013AAC:				; CODE XREF: sub_100139E6+A3j
		pop	esi
		pop	ebp
		pop	ebx

loc_10013AAF:				; CODE XREF: sub_100139E6+14j
		pop	edi
		pop	ecx
		retn
sub_100139E6	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10013AB2(int,	int, int, void *, int, void *, void *, void *, int)
sub_10013AB2	proc near		; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+143p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		push	ecx
		mov	ecx, [esp+4+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10013ACB
		push	4
		pop	eax
		jmp	loc_10013BAA
; ---------------------------------------------------------------------------

loc_10013ACB:				; CODE XREF: sub_10013AB2+Fj
		mov	eax, [esp+8+arg_4]
		lea	ecx, [esp+8+var_4]
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_8]
		xor	ebx, ebx
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	dword ptr [edi+3Ch], 6
		mov	dword ptr [edi+44h], 94h
		mov	esi, [esi]
		mov	[esp+10h+var_4], esi
		call	sub_1000B44B
		push	1		; int
		push	ebx		; char
		push	eax		; size_t
		push	esi		; void *
		push	ebx		; int
		mov	ecx, edi
		call	sub_10013CBC
		test	al, al
		jnz	short loc_10013B12
		push	4
		pop	eax
		jmp	loc_10013BA8
; ---------------------------------------------------------------------------

loc_10013B12:				; CODE XREF: sub_10013AB2+56j
		push	ebp
		push	2
		pop	ebp
		push	ebp		; int
		push	ebx		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	1		; int
		call	sub_10013CBC
		test	al, al
		jz	short loc_10013BA5
		mov	eax, [esp+14h+arg_10]
		mov	ecx, edi
		push	esi		; int
		push	ebx		; char
		push	esi		; size_t
		mov	eax, [eax]
		mov	[esp+20h+var_4], eax
		lea	eax, [esp+20h+var_4]
		push	eax		; void *
		push	ebp		; int
		call	sub_10013CBC
		test	al, al
		jz	short loc_10013BA5
		push	ebp		; int
		push	ebx		; char
		push	esi		; size_t
		push	[esp+20h+arg_14] ; void	*
		mov	ecx, edi
		push	3		; int
		call	sub_10013CBC
		test	al, al
		jz	short loc_10013BA5
		push	ebp		; int
		push	ebx		; char
		push	esi		; size_t
		push	[esp+20h+arg_18] ; void	*
		mov	ecx, edi
		push	esi		; int
		call	sub_10013CBC
		test	al, al
		jz	short loc_10013BA5
		push	ebp		; int
		push	ebx		; char
		push	esi		; size_t
		push	[esp+20h+arg_1C] ; void	*
		mov	ecx, edi
		push	5		; int
		call	sub_10013CBC
		test	al, al
		jz	short loc_10013BA5
		push	[esp+14h+arg_20]
		mov	ecx, [esp+18h+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10013BA5
		mov	ecx, [esp+14h+arg_0]
		push	edi
		call	sub_10017671

loc_10013BA5:				; CODE XREF: sub_10013AB2+79j
					; sub_10013AB2+97j ...
		mov	eax, esi
		pop	ebp

loc_10013BA8:				; CODE XREF: sub_10013AB2+5Bj
		pop	esi
		pop	ebx

loc_10013BAA:				; CODE XREF: sub_10013AB2+14j
		pop	edi
		pop	ecx
		retn
sub_10013AB2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013BAD	proc near		; CODE XREF: TargetNtOpenKey(x,x,x,x)+3Fp
					; TargetNtOpenKeyEx(x,x,x,x,x)+48p

var_64		= dword	ptr -64h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h

		push	54h
		push	offset stru_100302D8
		call	__SEH_prolog4_GS
		mov	edi, [ebp+arg_4]
		mov	ebx, [ebp+arg_C]
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jz	loc_10013CB1
		push	1
		push	4
		push	edi
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_10013CB1
		call	sub_10015CC7
		mov	esi, eax
		test	esi, esi
		jz	loc_10013CB1
		lea	eax, [ebp+var_5C]
		push	eax
		lea	eax, [ebp+var_58]
		push	eax
		lea	eax, [ebp+var_54]
		push	eax
		push	ebx
		call	sub_1001592A
		add	esp, 10h
		test	eax, eax
		js	loc_10013CB1
		cmp	[ebp+var_54], 0
		jz	loc_10013CB1
		push	esi
		lea	ecx, [ebp+var_64]
		call	sub_100175A8
		and	[ebp+var_50], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+var_5C]
		push	eax		; int
		lea	eax, [ebp+var_58]
		push	eax		; void *
		lea	eax, [ebp+var_54]
		push	eax		; int
		push	11h		; int
		lea	eax, [ebp+var_64]
		push	eax		; int
		call	sub_100139E6
		mov	esi, eax
		push	0
		push	[ebp+var_54]
		call	sub_100158E4
		add	esp, 30h
		test	esi, esi
		jnz	short loc_10013CB1
		mov	ecx, [ebp+var_48]
		test	ecx, ecx
		js	short loc_10013CB1
		and	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, [ebp+var_40]
		mov	[edi], eax
		mov	[ebp+arg_0], ecx
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ecx, [ebx+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtopenkeyEx ; "NtOpenKey[Ex]"
		call	sub_10002C02
		add	esp, 0Ch
		jmp	short loc_10013CB1
; ---------------------------------------------------------------------------

loc_10013CA3:				; DATA XREF: .rdata:stru_100302D8o
		xor	eax, eax	; Exception filter 0 for function 10013BAD
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013CA7:				; DATA XREF: .rdata:stru_100302D8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10013BAD
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_10013CB1:				; CODE XREF: sub_10013BAD+27j
					; sub_10013BAD+3Cj ...
		mov	eax, [ebp+arg_0]
		call	__SEH_epilog4_GS
		retn	10h
sub_10013BAD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10013CBC(int, void *, size_t, char,	int)
sub_10013CBC	proc near		; CODE XREF: sub_10013AB2+4Fp
					; sub_10013AB2+72p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_100302F8
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 6
		jnb	loc_10013D62
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_10013D62
		test	esi, esi
		jz	short loc_10013CEC
		cmp	[ebp+arg_4], 0
		jz	short loc_10013D62

loc_10013CEC:				; CODE XREF: sub_10013CBC+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_10013D62
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_10013D62
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_10013D2D
		mov	dword ptr [edi+4], 1

loc_10013D2D:				; CODE XREF: sub_10013CBC+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_10013D64
; ---------------------------------------------------------------------------

loc_10013D54:				; DATA XREF: .rdata:stru_100302F8o
		xor	eax, eax	; Exception filter 0 for function 10013CBC
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013D58:				; DATA XREF: .rdata:stru_100302F8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10013CBC
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_10013D62:				; CODE XREF: sub_10013CBC+14j
					; sub_10013CBC+20j ...
		xor	al, al

loc_10013D64:				; CODE XREF: sub_10013CBC+96j
		call	__SEH_epilog4
		retn	14h
sub_10013CBC	endp

; Exported entry  23. _TargetNtCreateKey@32

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtCreateKey(x, x, x, x, x, x,	x, x)
		public _TargetNtCreateKey@32
_TargetNtCreateKey@32 proc near		; DATA XREF: sub_1001392C+9o
					; .rdata:off_10030468o

var_74		= dword	ptr -74h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	64h
		push	offset stru_100302B8
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[ebp+var_5C], edx
		mov	ecx, [ebp+arg_C]
		mov	[ebp+var_54], ecx
		mov	esi, [ebp+arg_14]
		mov	ebx, [ebp+arg_1C]
		mov	[ebp+var_6C], ebx
		push	ebx
		push	[ebp+arg_18]
		push	esi
		push	[ebp+arg_10]
		push	ecx
		push	[ebp+arg_8]
		push	edx
		call	eax
		mov	edi, eax
		mov	[ebp+var_60], edi
		test	edi, edi
		jns	loc_10013F1E
		cmp	edi, 0C0000034h
		jz	short loc_10013DCE
		mov	ecx, [ebp+var_54]
		mov	ecx, [ecx+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtcreatekey ; "NtCreateKey"
		call	sub_10002D0B
		add	esp, 0Ch

loc_10013DCE:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+46j
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jz	loc_10013F1C
		push	1
		push	4
		push	[ebp+var_5C]
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_10013F1C
		test	ebx, ebx
		jz	short loc_10013E19
		push	1
		push	4
		push	ebx
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_10013F1C

loc_10013E19:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+96j
		xor	ebx, ebx
		test	esi, esi
		jz	short loc_10013E2D
		cmp	[esi+4], ebx
		jz	short loc_10013E2D
		cmp	[esi], bx
		jnz	loc_10013F1C

loc_10013E2D:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+B1j
					; TargetNtCreateKey(x,x,x,x,x,x,x,x)+B6j
		cmp	[ebp+arg_18], 0
		jnz	loc_10013F1C
		call	sub_10015CC7
		mov	esi, eax
		test	esi, esi
		jz	loc_10013F1C
		mov	[ebp+var_64], ebx
		mov	[ebp+var_68], ebx
		lea	eax, [ebp+var_68]
		push	eax
		lea	eax, [ebp+var_64]
		push	eax
		lea	eax, [ebp+var_58]
		push	eax
		push	[ebp+var_54]
		call	sub_1001592A
		add	esp, 10h
		test	eax, eax
		js	loc_10013F1C
		cmp	[ebp+var_58], 0
		jz	loc_10013F1C
		push	esi
		lea	ecx, [ebp+var_74]
		call	sub_100175A8
		mov	[ebp+var_50], ebx
		push	30h		; size_t
		push	ebx		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+arg_18]
		push	eax		; void *
		lea	eax, [ebp+arg_10]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+var_68]
		push	eax		; int
		lea	eax, [ebp+var_64]
		push	eax		; void *
		lea	eax, [ebp+var_58]
		push	eax		; int
		push	10h		; int
		lea	eax, [ebp+var_74]
		push	eax		; int
		call	sub_10013AB2
		mov	esi, eax
		push	ebx
		push	[ebp+var_58]
		call	sub_100158E4
		add	esp, 38h
		test	esi, esi
		jnz	short loc_10013F1C
		cmp	[ebp+var_48], esi
		jl	short loc_10013F1C
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		mov	eax, [ebp+var_40]
		mov	ecx, [ebp+var_5C]
		mov	[ecx], eax
		mov	ecx, [ebp+var_6C]
		test	ecx, ecx
		jz	short loc_10013EE2
		mov	eax, [ebp+var_3C]
		mov	[ecx], eax

loc_10013EE2:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+16Fj
		mov	edi, [ebp+var_48]
		mov	[ebp+var_60], edi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+var_54]
		mov	ecx, [eax+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtcreatekey ; "NtCreateKey"
		call	sub_10002C02
		add	esp, 0Ch
		jmp	short loc_10013F1C
; ---------------------------------------------------------------------------

loc_10013F0B:				; DATA XREF: .rdata:stru_100302B8o
		xor	eax, eax	; Exception filter 0 for function 10013D6C
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013F0F:				; DATA XREF: .rdata:stru_100302B8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10013D6C
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edi, [ebp+var_60]

loc_10013F1C:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+77j
					; TargetNtCreateKey(x,x,x,x,x,x,x,x)+8Ej ...
		mov	eax, edi

loc_10013F1E:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+3Aj
		call	__SEH_epilog4_GS
		retn	20h
_TargetNtCreateKey@32 endp

; Exported entry  27. _TargetNtOpenKey@16

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenKey(x, x, x, x)
		public _TargetNtOpenKey@16
_TargetNtOpenKey@16 proc near		; DATA XREF: sub_1001392C+3Do
					; .rdata:off_10030468o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		test	esi, esi
		jns	short loc_10013F6A
		cmp	esi, 0C0000034h
		jz	short loc_10013F5D
		mov	ecx, [edi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtopenkey ; "NtOpenKey"
		call	sub_10002D0B
		add	esp, 0Ch

loc_10013F5D:				; CODE XREF: TargetNtOpenKey(x,x,x,x)+1Ej
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	esi
		call	sub_10013BAD

loc_10013F6A:				; CODE XREF: TargetNtOpenKey(x,x,x,x)+16j
		pop	edi
		pop	esi
		pop	ebp
		retn	10h
_TargetNtOpenKey@16 endp

; Exported entry  28. _TargetNtOpenKeyEx@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenKeyEx(x, x, x, x, x)
		public _TargetNtOpenKeyEx@20
_TargetNtOpenKeyEx@20 proc near		; DATA XREF: sub_1001392C:loc_100139B4o
					; .rdata:off_10030468o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	[ebp+arg_10]
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		test	esi, esi
		jns	short loc_10013FBD
		cmp	[ebp+arg_10], 0
		jnz	short loc_10013FBD
		cmp	esi, 0C0000034h
		jz	short loc_10013FB0
		mov	ecx, [edi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtopenkeyex ; "NtOpenKeyEx"
		call	sub_10002D0B
		add	esp, 0Ch

loc_10013FB0:				; CODE XREF: TargetNtOpenKeyEx(x,x,x,x,x)+27j
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	esi
		call	sub_10013BAD

loc_10013FBD:				; CODE XREF: TargetNtOpenKeyEx(x,x,x,x,x)+19j
					; TargetNtOpenKeyEx(x,x,x,x,x)+1Fj
		pop	edi
		pop	esi
		pop	ebp
		retn	14h
_TargetNtOpenKeyEx@20 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10013FC3(int,	int, int, int, int, int, int, int, LPHANDLE lpTargetHandle, int, int)
sub_10013FC3	proc near		; CODE XREF: sub_100136DB+E2p

var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
lpTargetHandle	= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		cmp	[ebp+arg_0], 3
		jz	short loc_10013FDC

loc_10013FCF:				; CODE XREF: sub_10013FC3+1Dj
		mov	eax, [ebp+arg_24]
		mov	dword ptr [eax], 0C0000022h
		xor	al, al
		jmp	short loc_1001403C
; ---------------------------------------------------------------------------

loc_10013FDC:				; CODE XREF: sub_10013FC3+Aj
		cmp	[ebp+arg_1C], 0
		jnz	short loc_10013FCF
		push	esi
		push	edi
		xor	eax, eax
		lea	edi, [ebp+var_1C]
		mov	[ebp+var_8], ax
		xor	esi, esi
		mov	[ebp+var_20], esi
		stosd
		mov	[ebp+var_6], esi
		mov	[ebp+var_2], si
		stosd
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		call	sub_1001700A
		mov	eax, [ebp+arg_4]
		push	dword ptr [eax]	; hTargetProcessHandle
		lea	eax, [ebp+var_20]
		push	[ebp+arg_28]	; int
		push	esi		; int
		push	esi		; int
		push	[ebp+arg_18]	; int
		push	eax		; int
		push	[ebp+arg_14]	; int
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		call	sub_10014156
		mov	ecx, [ebp+arg_24]
		add	esp, 34h
		pop	edi
		mov	[ecx], eax
		mov	al, 1
		pop	esi

loc_1001403C:				; CODE XREF: sub_10013FC3+17j
		mov	esp, ebp
		pop	ebp
		retn
sub_10013FC3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10014040(void	*, int,	int)
sub_10014040	proc near		; CODE XREF: sub_1001651A+B6p

var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_2C		= byte ptr -2Ch
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_1C]
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_8]
		xor	ebx, ebx
		push	eax		; void *
		mov	[ebp+var_40], ebx
		call	sub_10001E8D
		cmp	[ebp+var_C], ebx
		jz	loc_10014137
		lea	eax, [ebp+var_1C]
		push	eax
		sub	esp, 18h
		mov	ecx, esp
		push	eax
		call	sub_10003B1C
		call	sub_1001A2A8
		add	esp, 1Ch
		test	al, al
		jz	loc_10014137
		cmp	[ebp+var_8], 8
		mov	esi, [ebp+var_1C]
		jnb	short loc_1001409B
		lea	esi, [ebp+var_1C]

loc_1001409B:				; CODE XREF: sub_10014040+56j
		push	3
		lea	ecx, [ebp+var_3C]
		call	sub_10011053
		push	3
		lea	ecx, [ebp+var_2C]
		call	sub_10011053
		mov	eax, [ebp+arg_4]
		sub	eax, 0Bh
		jz	short loc_100140BC
		dec	eax
		jz	short loc_100140E1
		jmp	short loc_10014127
; ---------------------------------------------------------------------------

loc_100140BC:				; CODE XREF: sub_10014040+75j
		push	1
		mov	ebx, 5DFDFFE6h
		lea	ecx, [ebp+var_3C]
		push	ebx
		push	1
		push	1
		call	sub_10011174
		push	1
		push	ebx
		push	1
		push	1
		lea	ecx, [ebp+var_2C]
		call	sub_10011174
		xor	ebx, ebx

loc_100140E1:				; CODE XREF: sub_10014040+78j
		push	1
		push	esi
		push	ebx
		push	ebx
		lea	ecx, [ebp+var_2C]
		call	sub_10011215
		test	al, al
		jz	short loc_10014127
		lea	eax, [ebp+var_2C]
		mov	ecx, edi
		push	eax
		push	10h
		call	sub_100111C8
		test	al, al
		jz	short loc_10014127
		push	1
		push	esi
		push	ebx
		push	ebx
		lea	ecx, [ebp+var_3C]
		call	sub_10011215
		test	al, al
		jz	short loc_10014127
		lea	eax, [ebp+var_3C]
		mov	ecx, edi
		push	eax
		push	11h
		call	sub_100111C8
		test	al, al
		jz	short loc_10014127
		mov	bl, 1

loc_10014127:				; CODE XREF: sub_10014040+7Aj
					; sub_10014040+B0j ...
		lea	ecx, [ebp+var_2C]
		call	sub_10011108
		lea	ecx, [ebp+var_3C]
		call	sub_10011108

loc_10014137:				; CODE XREF: sub_10014040+2Aj
					; sub_10014040+49j
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1
		mov	ecx, [ebp+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10014040	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10014156(LPHANDLE lpTargetHandle, int, int, int, int,	int, int, HANDLE hTargetProcessHandle)
sub_10014156	proc near		; CODE XREF: sub_10013FC3+68p

hSourceHandle	= dword	ptr -8
var_4		= dword	ptr -4
lpTargetHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
hTargetProcessHandle= dword ptr	 24h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_4]
		push	eax		; int
		push	offset aNtcreatekey ; "NtCreateKey"
		call	sub_1001A242
		mov	eax, [ebp+arg_4]
		pop	ecx
		pop	ecx
		test	eax, 2000000h
		jz	short loc_10014195
		lea	eax, [ebp+arg_4]
		push	eax
		push	[ebp+arg_8]
		call	sub_100142CB
		pop	ecx
		pop	ecx
		test	eax, eax
		jns	short loc_10014192
		mov	eax, 0C0000022h
		jmp	short loc_100141DE
; ---------------------------------------------------------------------------

loc_10014192:				; CODE XREF: sub_10014156+33j
		mov	eax, [ebp+arg_4]

loc_10014195:				; CODE XREF: sub_10014156+21j
		push	[ebp+arg_18]
		or	[ebp+hSourceHandle], 0FFFFFFFFh
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	eax
		lea	eax, [ebp+hSourceHandle]
		push	eax
		call	[ebp+var_4]
		test	eax, eax
		js	short loc_100141DE
		push	3		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		and	eax, 3FFFFFDEh
		add	eax, 0C0000022h

loc_100141DE:				; CODE XREF: sub_10014156+3Aj
					; sub_10014156+5Cj
		mov	esp, ebp
		pop	ebp
		retn
sub_10014156	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100141E2(LPHANDLE lpTargetHandle, int, int, HANDLE hTargetProcessHandle)
sub_100141E2	proc near		; CODE XREF: sub_10014262+55p

hSourceHandle	= dword	ptr -8
var_4		= dword	ptr -4
lpTargetHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
hTargetProcessHandle= dword ptr	 14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_4]
		push	eax		; int
		push	offset aNtopenkey ; "NtOpenKey"
		call	sub_1001A242
		mov	eax, [ebp+arg_4]
		pop	ecx
		pop	ecx
		test	eax, 2000000h
		jz	short loc_10014221
		lea	eax, [ebp+arg_4]
		push	eax
		push	[ebp+arg_8]
		call	sub_100142CB
		pop	ecx
		pop	ecx
		test	eax, eax
		jns	short loc_1001421E
		mov	eax, 0C0000022h
		jmp	short loc_1001425E
; ---------------------------------------------------------------------------

loc_1001421E:				; CODE XREF: sub_100141E2+33j
		mov	eax, [ebp+arg_4]

loc_10014221:				; CODE XREF: sub_100141E2+21j
		push	[ebp+arg_8]
		or	[ebp+hSourceHandle], 0FFFFFFFFh
		push	eax
		lea	eax, [ebp+hSourceHandle]
		push	eax
		call	[ebp+var_4]
		test	eax, eax
		js	short loc_1001425E
		push	3		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		and	eax, 3FFFFFDEh
		add	eax, 0C0000022h

loc_1001425E:				; CODE XREF: sub_100141E2+3Aj
					; sub_100141E2+50j
		mov	esp, ebp
		pop	ebp
		retn
sub_100141E2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10014262(int,	int, int, int, int, int, LPHANDLE lpTargetHandle, int)
sub_10014262	proc near		; CODE XREF: sub_1001380F+D1p

var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
lpTargetHandle	= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		cmp	[ebp+arg_0], 3
		jz	short loc_10014279
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_100142C5
; ---------------------------------------------------------------------------

loc_10014279:				; CODE XREF: sub_10014262+Aj
		push	edi
		xor	eax, eax
		lea	edi, [ebp+var_1C]
		mov	[ebp+var_20], eax
		mov	[ebp+var_8], ax
		mov	[ebp+var_6], eax
		mov	[ebp+var_2], ax
		stosd
		stosd
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		call	sub_1001700A
		mov	eax, [ebp+arg_4]
		push	dword ptr [eax]	; hTargetProcessHandle
		lea	eax, [ebp+var_20]
		push	eax		; int
		push	[ebp+arg_14]	; int
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		call	sub_100141E2
		mov	ecx, [ebp+arg_1C]
		add	esp, 24h
		mov	[ecx], eax
		pop	edi

loc_100142C5:				; CODE XREF: sub_10014262+15j
		mov	al, 1
		mov	esp, ebp
		pop	ebp
		retn
sub_10014262	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100142CB	proc near		; CODE XREF: sub_10014156+2Ap
					; sub_100141E2+2Ap

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	eax, [ebp+var_48]
		push	edi
		mov	edi, [ebp+arg_4]
		xor	ebx, ebx
		push	eax		; int
		push	offset aNtopenkey ; "NtOpenKey"
		mov	[ebp+var_48], ebx
		call	sub_1001A242
		lea	eax, [ebp+var_44]
		mov	[ebp+var_44], ebx
		push	eax		; int
		push	offset aNtclose	; "NtClose"
		call	sub_1001A242
		lea	eax, [ebp+var_4C]
		mov	[ebp+var_4C], ebx
		push	eax		; int
		push	offset aNtqueryobject ;	"NtQueryObject"
		call	sub_1001A242
		add	esp, 18h
		lea	eax, [ebp+var_40]
		push	esi
		push	dword ptr [edi]
		push	eax
		call	[ebp+var_48]
		test	eax, eax
		js	short loc_10014366
		push	34h		; size_t
		lea	eax, [ebp+var_38]
		mov	[ebp+var_3C], ebx
		push	ebx		; int
		push	eax		; void *
		call	memset
		add	esp, 0Ch
		lea	eax, [ebp+var_3C]
		push	ebx
		push	38h
		push	eax
		push	ebx
		push	[ebp+var_40]
		call	[ebp+var_4C]
		push	[ebp+var_40]
		mov	esi, eax
		call	[ebp+var_44]
		test	esi, esi
		jns	short loc_1001435A
		mov	eax, esi
		jmp	short loc_10014366
; ---------------------------------------------------------------------------

loc_1001435A:				; CODE XREF: sub_100142CB+89j
		mov	eax, [ebp+var_38]
		and	eax, 0A0020019h
		mov	[edi], eax
		xor	eax, eax

loc_10014366:				; CODE XREF: sub_100142CB+5Dj
					; sub_100142CB+8Dj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100142CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014377	proc near		; DATA XREF: .rdata:1001D588o
					; .rdata:1001D5A0o ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_14], 0
		push	esi
		mov	esi, ecx
		jz	short loc_100143E4
		cmp	[ebp+arg_18], 0
		jz	short loc_100143E4
		cmp	[ebp+arg_0], 0
		jz	short loc_100143E4
		cmp	[ebp+arg_8], 0
		jz	short loc_100143E4
		mov	eax, [esi]
		call	dword ptr [eax+10h]
		cmp	[ebp+arg_18], eax
		jnb	short loc_100143A6
		mov	eax, 0C0000023h
		jmp	short loc_100143E9
; ---------------------------------------------------------------------------

loc_100143A6:				; CODE XREF: sub_10014377+26j
		cmp	[ebp+arg_10], 0
		jnz	short loc_100143C1
		mov	eax, [esi]
		lea	ecx, [ebp+arg_10]
		push	ecx
		push	[ebp+arg_C]
		mov	ecx, esi
		push	[ebp+arg_4]
		call	dword ptr [eax+8]
		test	eax, eax
		js	short loc_100143E9

loc_100143C1:				; CODE XREF: sub_10014377+33j
		mov	edx, [esi]
		lea	eax, [esi+4]
		push	eax
		push	[ebp+arg_8]
		mov	ecx, esi
		push	[ebp+arg_0]
		call	dword ptr [edx+0Ch]
		mov	ecx, eax
		test	ecx, ecx
		jns	short loc_100143DC

loc_100143D8:				; CODE XREF: sub_10014377+6Bj
		mov	eax, ecx
		jmp	short loc_100143E9
; ---------------------------------------------------------------------------

loc_100143DC:				; CODE XREF: sub_10014377+5Fj
		mov	eax, [ebp+arg_10]
		mov	[esi+8], eax
		jmp	short loc_100143D8
; ---------------------------------------------------------------------------

loc_100143E4:				; CODE XREF: sub_10014377+Aj
					; sub_10014377+10j ...
		mov	eax, 0C000000Dh

loc_100143E9:				; CODE XREF: sub_10014377+2Dj
					; sub_10014377+48j ...
		pop	esi
		pop	ebp
		retn	1Ch
sub_10014377	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100143EE	proc near		; CODE XREF: sub_1001447Bj
					; DATA XREF: .rdata:1001D57Co ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_10014401
		mov	eax, 0C000000Dh
		jmp	short loc_1001443B
; ---------------------------------------------------------------------------

loc_10014401:				; CODE XREF: sub_100143EE+Aj
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001CAC8
		mov	[ebp+var_4], eax
		call	sub_10005F17
		test	al, al
		jnz	short loc_1001441E
		mov	eax, 0C000007Bh
		jmp	short loc_1001443B
; ---------------------------------------------------------------------------

loc_1001441E:				; CODE XREF: sub_100143EE+27j
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_8]
		call	sub_10005D9A
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_10014439
		mov	eax, 0C000007Ah
		jmp	short loc_1001443B
; ---------------------------------------------------------------------------

loc_10014439:				; CODE XREF: sub_100143EE+42j
		xor	eax, eax

loc_1001443B:				; CODE XREF: sub_100143EE+11j
					; sub_100143EE+2Ej ...
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_100143EE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014441	proc near		; CODE XREF: sub_10014480+13p
		and	dword ptr [ecx+10h], 0
		mov	eax, 0C35Ah
		and	dword ptr [ecx+18h], 0
		mov	[ecx+1Ch], ax
		mov	eax, ecx
		mov	dword ptr [ecx], 5208EC83h
		mov	dword ptr [ecx+4], 0C24548Bh
		mov	dword ptr [ecx+8], 8245489h
		mov	dword ptr [ecx+0Ch], 0C2444C7h
		mov	dword ptr [ecx+14h], 42444C7h
		retn
sub_10014441	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014477	proc near		; CODE XREF: sub_1000A5E6j
					; sub_10017128p ...
		push	1Eh
		pop	eax
		retn
sub_10014477	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame thunk

sub_1001447B	proc near		; DATA XREF: .rdata:1001D580o
					; .rdata:1001D79Co ...
		jmp	sub_100143EE
sub_1001447B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014480	proc near		; CODE XREF: sub_1000A64F+44p
					; sub_100173B6+74p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	[esp+arg_4], 1Eh
		jnb	short loc_1001448B
		xor	al, al
		jmp	short locret_100144AE
; ---------------------------------------------------------------------------

loc_1001448B:				; CODE XREF: sub_10014480+5j
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jz	short loc_1001449C
		call	sub_10014441
		mov	ecx, eax
		jmp	short loc_1001449E
; ---------------------------------------------------------------------------

loc_1001449C:				; CODE XREF: sub_10014480+11j
		xor	ecx, ecx

loc_1001449E:				; CODE XREF: sub_10014480+1Aj
		mov	eax, [esp+arg_C]
		mov	[ecx+18h], eax
		mov	eax, [esp+arg_8]
		mov	[ecx+10h], eax
		mov	al, 1

locret_100144AE:			; CODE XREF: sub_10014480+9j
		retn	10h
sub_10014480	endp


; =============== S U B	R O U T	I N E =======================================


sub_100144B1	proc near		; CODE XREF: sub_10003068+4Dp
					; sub_10014EF1+Dp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_100144D8
		cmp	eax, 1FFFFFFFh
		ja	short loc_100144D2
		shl	eax, 3
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_100144D8

loc_100144D2:				; CODE XREF: sub_100144B1+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_100144D8:				; CODE XREF: sub_100144B1+8j
					; sub_100144B1+1Fj
		mov	eax, ecx
		retn
sub_100144B1	endp


; =============== S U B	R O U T	I N E =======================================


sub_100144DB	proc near		; CODE XREF: sub_10014F3E+Dp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10014502
		cmp	eax, 3C3C3C3h
		ja	short loc_100144FC
		imul	eax, 44h
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10014502

loc_100144FC:				; CODE XREF: sub_100144DB+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_10014502:				; CODE XREF: sub_100144DB+8j
					; sub_100144DB+1Fj
		mov	eax, ecx
		retn
sub_100144DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014505	proc near		; CODE XREF: sub_10014F3E+1Ep

var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	[ebp+arg_8]
		lea	eax, [ebp+var_1]
		push	0
		push	eax
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10014551
		add	esp, 18h
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10014505	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014529	proc near		; CODE XREF: sub_1000840C+16p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+arg_8]

loc_10014532:				; CODE XREF: sub_10014529+22j
		cmp	edx, [ebp+arg_4]
		jz	short loc_1001454D
		test	ecx, ecx
		jz	short loc_10014545
		mov	eax, [edx]
		mov	[ecx], eax
		mov	eax, [edx+4]
		mov	[ecx+4], eax

loc_10014545:				; CODE XREF: sub_10014529+10j
		add	ecx, 8
		add	edx, 8
		jmp	short loc_10014532
; ---------------------------------------------------------------------------

loc_1001454D:				; CODE XREF: sub_10014529+Cj
		mov	eax, ecx
		pop	ebp
		retn
sub_10014529	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014551	proc near		; CODE XREF: sub_10014505+16p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+arg_8]
		cmp	edx, [ebp+arg_4]
		jz	short loc_1001457B
		push	esi
		push	edi

loc_10014561:				; CODE XREF: sub_10014551+26j
		test	eax, eax
		jz	short loc_1001456E
		push	11h
		pop	ecx
		mov	esi, edx
		mov	edi, eax
		rep movsd

loc_1001456E:				; CODE XREF: sub_10014551+12j
		add	edx, 44h
		add	eax, 44h
		cmp	edx, [ebp+arg_4]
		jnz	short loc_10014561
		pop	edi
		pop	esi

loc_1001457B:				; CODE XREF: sub_10014551+Cj
		pop	ebp
		retn
sub_10014551	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001457D	proc near		; CODE XREF: sub_1001514D+3F9p

var_61		= byte ptr -61h
ReturnLength	= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
pDestinationSid	= byte ptr -48h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 64h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+64h+var_4], eax
		mov	eax, [esp+64h+arg_0]
		push	ebx
		mov	ebx, ecx
		mov	[esp+68h+var_4C], eax
		xor	ecx, ecx
		mov	[esp+68h+var_50], ecx
		cmp	[ebx+2Ch], cl
		jnz	short loc_100145AB
		mov	eax, 3F0h
		jmp	loc_100146DE
; ---------------------------------------------------------------------------

loc_100145AB:				; CODE XREF: sub_1001457D+22j
		push	edi
		mov	edi, ds:GetTokenInformation
		lea	eax, [esp+6Ch+ReturnLength]
		push	eax		; ReturnLength
		push	ecx		; TokenInformationLength
		push	ecx		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		mov	[esp+80h+ReturnLength],	ecx
		call	edi ; GetTokenInformation
		cmp	[esp+6Ch+ReturnLength],	0
		jnz	short loc_100145D6
		call	ds:GetLastError
		jmp	loc_100146DD
; ---------------------------------------------------------------------------

loc_100145D6:				; CODE XREF: sub_1001457D+4Cj
		push	esi
		push	[esp+70h+ReturnLength]
		call	sub_1001AAE8
		pop	ecx
		mov	esi, eax
		lea	eax, [esp+70h+ReturnLength]
		push	eax		; ReturnLength
		push	[esp+74h+ReturnLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	edi ; GetTokenInformation
		test	eax, eax
		jnz	short loc_1001460A
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	loc_100146DC
; ---------------------------------------------------------------------------

loc_1001460A:				; CODE XREF: sub_1001457D+79j
		push	ebp
		xor	ebp, ebp
		cmp	[esi], ebp
		jbe	loc_100146D2
		lea	edi, [esi+4]
		mov	[esp+74h+var_50], 44h

loc_10014620:				; CODE XREF: sub_1001457D+14Fj
		test	byte ptr [edi+4], 20h
		jnz	loc_100146C6
		test	dword ptr [edi+4], 0C0000000h
		jnz	loc_100146C6
		mov	ecx, [esp+74h+var_4C]
		mov	[esp+74h+var_61], 0
		test	ecx, ecx
		jz	short loc_100146A6
		mov	eax, [ecx+4]
		xor	edx, edx
		mov	[esp+74h+var_5C], edx
		mov	edx, [ecx]
		sub	eax, edx
		mov	[esp+74h+var_54], edx
		push	44h
		cdq
		pop	ecx
		idiv	ecx
		test	eax, eax
		jz	short loc_100146A6
		xor	ecx, ecx
		mov	[esp+74h+var_58], ecx

loc_10014665:				; CODE XREF: sub_1001457D+127j
		push	dword ptr [edi]	; pSid2
		add	ecx, [esp+78h+var_54]
		call	sub_10017FC3
		push	eax		; pSid1
		call	ds:EqualSid
		test	eax, eax
		jnz	short loc_100146F0
		mov	ecx, [esp+74h+var_58]
		push	44h
		pop	eax
		add	ecx, eax
		inc	[esp+74h+var_5C]
		mov	eax, [esp+74h+var_4C]
		mov	[esp+74h+var_58], ecx
		mov	edx, [eax]
		mov	eax, [eax+4]
		sub	eax, edx
		mov	[esp+74h+var_54], edx
		cdq
		idiv	[esp+74h+var_50]
		cmp	[esp+74h+var_5C], eax
		jb	short loc_10014665

loc_100146A6:				; CODE XREF: sub_1001457D+C5j
					; sub_1001457D+E0j
		mov	al, [esp+74h+var_61]

loc_100146AA:				; CODE XREF: sub_1001457D+175j
		test	al, al
		jnz	short loc_100146C6
		push	dword ptr [edi]	; pSourceSid
		lea	ecx, [esp+78h+pDestinationSid] ; pDestinationSid
		call	sub_10017F82
		lea	eax, [esp+74h+pDestinationSid]
		push	eax
		lea	ecx, [ebx+18h]
		call	sub_1001508D

loc_100146C6:				; CODE XREF: sub_1001457D+A7j
					; sub_1001457D+B4j ...
		inc	ebp
		add	edi, 8
		cmp	ebp, [esi]
		jb	loc_10014620

loc_100146D2:				; CODE XREF: sub_1001457D+92j
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		xor	eax, eax
		pop	ebp

loc_100146DC:				; CODE XREF: sub_1001457D+88j
		pop	esi

loc_100146DD:				; CODE XREF: sub_1001457D+54j
		pop	edi

loc_100146DE:				; CODE XREF: sub_1001457D+29j
		mov	ecx, [esp+68h+var_4]
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 64h
		retn	4
; ---------------------------------------------------------------------------

loc_100146F0:				; CODE XREF: sub_1001457D+FCj
		mov	al, 1
		jmp	short loc_100146AA
sub_1001457D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100146F4	proc near		; CODE XREF: sub_10014719+ACp
					; sub_1001514D+22Ep ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		cmp	byte ptr [ecx+2Ch], 0
		jnz	short loc_10014709
		mov	eax, 3F0h
		jmp	short loc_10014713
; ---------------------------------------------------------------------------

loc_10014709:				; CODE XREF: sub_100146F4+Cj
		push	[ebp+arg_0]
		call	sub_1001508D
		xor	eax, eax

loc_10014713:				; CODE XREF: sub_100146F4+13j
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100146F4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014719	proc near		; CODE XREF: sub_1001514D+BFp

ReturnLength	= dword	ptr -4Ch
pDestinationSid	= byte ptr -48h
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		push	ebp
		mov	ebp, ecx
		push	esi
		xor	esi, esi
		mov	[esp+54h+ReturnLength],	esi
		cmp	byte ptr [ebp+2Ch], 0
		jnz	short loc_10014741
		mov	eax, 3F0h
		jmp	loc_100147DD
; ---------------------------------------------------------------------------

loc_10014741:				; CODE XREF: sub_10014719+1Cj
		call	sub_100147EE
		test	eax, eax
		jnz	loc_100147DD
		push	ebx
		mov	ebx, ds:GetTokenInformation
		lea	eax, [esp+58h+ReturnLength]
		push	eax		; ReturnLength
		push	esi		; TokenInformationLength
		push	esi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebp+24h] ; TokenHandle
		mov	[esp+6Ch+ReturnLength],	esi
		call	ebx ; GetTokenInformation
		cmp	[esp+58h+ReturnLength],	esi
		jnz	short loc_10014775
		call	ds:GetLastError
		jmp	short loc_100147DC
; ---------------------------------------------------------------------------

loc_10014775:				; CODE XREF: sub_10014719+52j
		push	edi
		push	[esp+5Ch+ReturnLength]
		call	sub_1001AAE8
		pop	ecx
		mov	edi, eax
		lea	eax, [esp+5Ch+ReturnLength]
		push	eax		; ReturnLength
		push	[esp+60h+ReturnLength] ; TokenInformationLength
		push	edi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebp+24h] ; TokenHandle
		call	ebx ; GetTokenInformation
		test	eax, eax
		jnz	short loc_100147A6
		push	edi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	short loc_100147DB
; ---------------------------------------------------------------------------

loc_100147A6:				; CODE XREF: sub_10014719+7Cj
		cmp	[edi], esi
		jbe	short loc_100147D2
		lea	ebx, [edi+4]

loc_100147AD:				; CODE XREF: sub_10014719+B7j
		test	byte ptr [ebx+4], 20h
		jnz	short loc_100147CA
		push	dword ptr [ebx]	; pSourceSid
		lea	ecx, [esp+60h+pDestinationSid] ; pDestinationSid
		call	sub_10017F82
		lea	eax, [esp+5Ch+pDestinationSid]
		mov	ecx, ebp
		push	eax
		call	sub_100146F4

loc_100147CA:				; CODE XREF: sub_10014719+98j
		inc	esi
		add	ebx, 8
		cmp	esi, [edi]
		jb	short loc_100147AD

loc_100147D2:				; CODE XREF: sub_10014719+8Fj
		push	edi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_100147DB:				; CODE XREF: sub_10014719+8Bj
		pop	edi

loc_100147DC:				; CODE XREF: sub_10014719+5Aj
		pop	ebx

loc_100147DD:				; CODE XREF: sub_10014719+23j
					; sub_10014719+2Fj
		mov	ecx, [esp+54h+var_4]
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
sub_10014719	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100147EE	proc near		; CODE XREF: sub_10014719:loc_10014741p
					; sub_1001514D+277p

TokenInformationLength=	dword ptr -4Ch
pDestinationSid	= byte ptr -48h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+TokenInformationLength], 0
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_10014812
		mov	eax, 3F0h
		jmp	short loc_10014867
; ---------------------------------------------------------------------------

loc_10014812:				; CODE XREF: sub_100147EE+1Bj
		push	esi
		push	4Ch
		pop	eax
		push	eax
		mov	[ebp+TokenInformationLength], eax
		call	sub_1001AAE8
		pop	ecx
		mov	esi, eax
		lea	eax, [ebp+TokenInformationLength]
		push	eax		; ReturnLength
		push	[ebp+TokenInformationLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	1		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_10014848
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	short loc_10014866
; ---------------------------------------------------------------------------

loc_10014848:				; CODE XREF: sub_100147EE+49j
		push	dword ptr [esi]	; pSourceSid
		lea	ecx, [ebp+pDestinationSid] ; pDestinationSid
		call	sub_10017F82
		lea	eax, [ebp+pDestinationSid]
		mov	ecx, edi
		push	eax
		call	sub_1001508D
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_10014866:				; CODE XREF: sub_100147EE+58j
		pop	esi

loc_10014867:				; CODE XREF: sub_100147EE+22j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100147EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014876	proc near		; CODE XREF: sub_1001514D+282p

ReturnLength	= dword	ptr -4Ch
pDestinationSid	= byte ptr -48h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, ecx
		push	esi
		xor	esi, esi
		mov	[ebp+ReturnLength], esi
		cmp	byte ptr [ebx+2Ch], 0
		jnz	short loc_1001489F
		mov	eax, 3F0h
		jmp	loc_10014931
; ---------------------------------------------------------------------------

loc_1001489F:				; CODE XREF: sub_10014876+1Dj
		lea	eax, [ebp+ReturnLength]
		mov	[ebp+ReturnLength], esi
		push	eax		; ReturnLength
		push	esi		; TokenInformationLength
		push	esi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	ds:GetTokenInformation
		cmp	[ebp+ReturnLength], esi
		jnz	short loc_100148C0
		call	ds:GetLastError
		jmp	short loc_10014931
; ---------------------------------------------------------------------------

loc_100148C0:				; CODE XREF: sub_10014876+40j
		push	edi
		push	[ebp+ReturnLength]
		call	sub_1001AAE8
		pop	ecx
		mov	edi, eax
		lea	eax, [ebp+ReturnLength]
		push	eax		; ReturnLength
		push	[ebp+ReturnLength] ; TokenInformationLength
		push	edi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_100148F2
		push	edi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	short loc_10014930
; ---------------------------------------------------------------------------

loc_100148F2:				; CODE XREF: sub_10014876+6Bj
		cmp	[edi], esi
		jbe	short loc_10014927
		lea	eax, [edi+8]

loc_100148F9:				; CODE XREF: sub_10014876+91j
		test	dword ptr [eax], 0C0000000h
		jnz	short loc_1001490B
		inc	esi
		add	eax, 8
		cmp	esi, [edi]
		jb	short loc_100148F9
		jmp	short loc_10014927
; ---------------------------------------------------------------------------

loc_1001490B:				; CODE XREF: sub_10014876+89j
		mov	eax, [edi+esi*8+4]
		test	eax, eax
		jz	short loc_10014927
		push	eax		; pSourceSid
		lea	ecx, [ebp+pDestinationSid] ; pDestinationSid
		call	sub_10017F82
		lea	eax, [ebp+pDestinationSid]
		mov	ecx, ebx
		push	eax
		call	sub_1001508D

loc_10014927:				; CODE XREF: sub_10014876+7Ej
					; sub_10014876+93j ...
		push	edi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_10014930:				; CODE XREF: sub_10014876+7Aj
		pop	edi

loc_10014931:				; CODE XREF: sub_10014876+24j
					; sub_10014876+48j
		mov	ecx, [ebp+var_4]
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10014876	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014941	proc near		; CODE XREF: sub_1001514D+3A9p
					; sub_1001514D+3C9p

TokenInformationLength=	dword ptr -4Ch
pDestinationSid	= byte ptr -48h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+TokenInformationLength], 0
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_10014965
		mov	eax, 3F0h
		jmp	short loc_100149BB
; ---------------------------------------------------------------------------

loc_10014965:				; CODE XREF: sub_10014941+1Bj
		push	esi
		push	4Ch
		pop	eax
		push	eax
		mov	[ebp+TokenInformationLength], eax
		call	sub_1001AAE8
		pop	ecx
		mov	esi, eax
		lea	eax, [ebp+TokenInformationLength]
		push	eax		; ReturnLength
		push	[ebp+TokenInformationLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	1		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_1001499B
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	short loc_100149BA
; ---------------------------------------------------------------------------

loc_1001499B:				; CODE XREF: sub_10014941+49j
		push	dword ptr [esi]	; pSourceSid
		lea	ecx, [ebp+pDestinationSid] ; pDestinationSid
		call	sub_10017F82
		lea	eax, [ebp+pDestinationSid]
		push	eax
		lea	ecx, [edi+18h]
		call	sub_1001508D
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_100149BA:				; CODE XREF: sub_10014941+58j
		pop	esi

loc_100149BB:				; CODE XREF: sub_10014941+22j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10014941	endp


; =============== S U B	R O U T	I N E =======================================


sub_100149CA	proc near		; CODE XREF: sub_1001514D+411p

ReturnLength	= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Luid		= _LUID	ptr -8
arg_0		= dword	ptr  4

		sub	esp, 18h
		push	ebp
		push	edi
		mov	edi, ecx
		xor	ebp, ebp
		mov	[esp+20h+var_C], ebp
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_100149E7
		mov	eax, 3F0h
		jmp	loc_10014AF4
; ---------------------------------------------------------------------------

loc_100149E7:				; CODE XREF: sub_100149CA+11j
		push	ebx
		mov	ebx, ds:GetTokenInformation
		lea	eax, [esp+24h+ReturnLength]
		push	eax		; ReturnLength
		push	ebp		; TokenInformationLength
		push	ebp		; TokenInformation
		push	3		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		mov	[esp+38h+ReturnLength],	ebp
		call	ebx ; GetTokenInformation
		cmp	[esp+24h+ReturnLength],	ebp
		jnz	short loc_10014A11
		call	ds:GetLastError
		jmp	loc_10014AF3
; ---------------------------------------------------------------------------

loc_10014A11:				; CODE XREF: sub_100149CA+3Aj
		push	esi
		push	[esp+28h+ReturnLength]
		call	sub_1001AAE8
		pop	ecx
		mov	esi, eax
		lea	eax, [esp+28h+ReturnLength]
		push	eax		; ReturnLength
		push	[esp+2Ch+ReturnLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	3		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		call	ebx ; GetTokenInformation
		test	eax, eax
		jnz	short loc_10014A45
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	loc_10014AF2
; ---------------------------------------------------------------------------

loc_10014A45:				; CODE XREF: sub_100149CA+67j
		cmp	[esi], ebp
		jbe	loc_10014AE9
		lea	ebx, [esi+4]
		mov	[esp+28h+var_C], 18h

loc_10014A58:				; CODE XREF: sub_100149CA+119j
		mov	ecx, [esp+28h+arg_0]
		test	ecx, ecx
		jz	short loc_10014AD4
		mov	eax, [ecx+4]
		xor	edx, edx
		mov	ecx, [ecx]
		sub	eax, ecx
		mov	[esp+28h+var_14], edx
		cdq
		idiv	[esp+28h+var_C]
		test	eax, eax
		jz	short loc_10014AD4
		xor	eax, eax
		mov	[esp+28h+var_10], eax

loc_10014A7C:				; CODE XREF: sub_100149CA+108j
		and	[esp+28h+Luid.LowPart],	0
		add	eax, ecx
		and	[esp+28h+Luid.HighPart], 0
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10014A90
		mov	eax, [eax]

loc_10014A90:				; CODE XREF: sub_100149CA+C2j
		lea	ecx, [esp+28h+Luid]
		push	ecx		; lpLuid
		push	eax		; lpName
		push	0		; lpSystemName
		call	ds:LookupPrivilegeValueW
		mov	eax, [ebx+4]
		cmp	eax, [esp+28h+Luid.HighPart]
		jnz	short loc_10014AAF
		mov	eax, [ebx]
		cmp	eax, [esp+28h+Luid.LowPart]
		jz	short loc_10014ADD

loc_10014AAF:				; CODE XREF: sub_100149CA+DBj
		push	18h
		pop	eax
		add	[esp+28h+var_10], eax
		mov	eax, [esp+28h+arg_0]
		inc	[esp+28h+var_14]
		mov	ecx, [eax]
		mov	eax, [eax+4]
		sub	eax, ecx
		cdq
		idiv	[esp+28h+var_C]
		cmp	[esp+28h+var_14], eax
		mov	eax, [esp+28h+var_10]
		jb	short loc_10014A7C

loc_10014AD4:				; CODE XREF: sub_100149CA+94j
					; sub_100149CA+AAj
		push	ebx
		lea	ecx, [edi+0Ch]
		call	sub_1001502C

loc_10014ADD:				; CODE XREF: sub_100149CA+E3j
		inc	ebp
		add	ebx, 0Ch
		cmp	ebp, [esi]
		jb	loc_10014A58

loc_10014AE9:				; CODE XREF: sub_100149CA+7Dj
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_10014AF2:				; CODE XREF: sub_100149CA+76j
		pop	esi

loc_10014AF3:				; CODE XREF: sub_100149CA+42j
		pop	ebx

loc_10014AF4:				; CODE XREF: sub_100149CA+18j
		pop	edi
		pop	ebp
		add	esp, 18h
		retn	4
sub_100149CA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014AFC	proc near		; CODE XREF: sub_10014D90+1Cp
					; sub_1001514D+422p

phNewToken	= dword	ptr -68h
RestrictedSidCount= dword ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
SidsToDisable	= dword	ptr -58h
DisableSidCount	= dword	ptr -54h
var_50		= dword	ptr -50h
lpTargetHandle	= dword	ptr -4Ch
pSid		= byte ptr -48h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 68h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		and	[esp+68h+DisableSidCount], 0
		mov	eax, [esp+68h+arg_0]
		push	edi
		mov	edi, ecx
		mov	[esp+6Ch+lpTargetHandle], eax
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_10014B2A
		mov	eax, 3F0h
		jmp	loc_10014D7E
; ---------------------------------------------------------------------------

loc_10014B2A:				; CODE XREF: sub_10014AFC+22j
		mov	eax, [edi+1Ch]
		sub	eax, [edi+18h]
		push	ebx
		push	ebp
		push	esi
		cdq
		push	44h
		pop	ecx
		idiv	ecx
		mov	ebp, [edi+10h]
		mov	ebx, eax
		sub	ebp, [edi+0Ch]
		mov	eax, [edi+4]
		sub	eax, [edi]
		cdq
		idiv	ecx
		and	[esp+78h+SidsToDisable], 0
		sar	ebp, 3
		mov	esi, eax
		mov	[esp+78h+DisableSidCount], ebx
		mov	[esp+78h+RestrictedSidCount], esi
		mov	[esp+78h+var_60], ebp
		push	8
		pop	edx
		test	ebx, ebx
		jz	short loc_10014BD1
		xor	ecx, ecx
		mov	eax, ebx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_1001AAE8
		mov	[esp+7Ch+SidsToDisable], eax
		mov	eax, [edi+1Ch]
		sub	eax, [edi+18h]
		pop	ecx
		push	44h
		cdq
		pop	ecx
		idiv	ecx
		and	[esp+78h+var_5C], 0
		test	eax, eax
		jz	short loc_10014BCE
		mov	ebp, [esp+78h+SidsToDisable]
		xor	ebx, ebx
		mov	esi, [esp+78h+var_5C]

loc_10014B9D:				; CODE XREF: sub_10014AFC+C8j
		mov	dword ptr [ebp+esi*8+4], 10h
		mov	ecx, [edi+18h]
		add	ecx, ebx
		call	sub_10017FC3
		mov	[ebp+esi*8+0], eax
		inc	esi
		mov	eax, [edi+1Ch]
		sub	eax, [edi+18h]
		push	44h
		pop	ecx
		cdq
		add	ebx, ecx
		idiv	ecx
		cmp	esi, eax
		jb	short loc_10014B9D
		mov	ebp, [esp+78h+var_60]
		mov	esi, [esp+78h+RestrictedSidCount]

loc_10014BCE:				; CODE XREF: sub_10014AFC+95j
		push	8
		pop	edx

loc_10014BD1:				; CODE XREF: sub_10014AFC+68j
		xor	ebx, ebx
		mov	[esp+78h+var_5C], ebx
		test	esi, esi
		jz	short loc_10014C2E
		xor	ecx, ecx
		mov	eax, esi
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_1001AAE8
		xor	esi, esi
		mov	ebx, eax
		pop	ecx
		mov	[esp+78h+var_5C], ebx
		cmp	[esp+78h+RestrictedSidCount], esi
		jbe	short loc_10014C2E
		mov	ebp, [esp+78h+RestrictedSidCount]
		xor	eax, eax
		mov	[esp+78h+var_50], eax

loc_10014C07:				; CODE XREF: sub_10014AFC+12Cj
		and	dword ptr [ebx+esi*8+4], 0
		mov	ecx, [edi]
		add	ecx, eax
		call	sub_10017FC3
		mov	[ebx+esi*8], eax
		inc	esi
		mov	eax, [esp+78h+var_50]
		push	44h
		pop	ecx
		add	eax, ecx
		mov	[esp+78h+var_50], eax
		cmp	esi, ebp
		jb	short loc_10014C07
		mov	ebp, [esp+78h+var_60]

loc_10014C2E:				; CODE XREF: sub_10014AFC+DDj
					; sub_10014AFC+FFj
		xor	esi, esi
		test	ebp, ebp
		jz	short loc_10014C7B
		xor	ecx, ecx
		mov	eax, ebp
		push	0Ch
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_1001AAE8
		and	[esp+7Ch+var_60], 0
		mov	esi, eax
		pop	ecx
		test	ebp, ebp
		jz	short loc_10014C7B
		mov	ebx, [esp+78h+var_60]
		mov	edx, esi

loc_10014C5C:				; CODE XREF: sub_10014AFC+179j
		and	dword ptr [edx+8], 0
		mov	ecx, [edi+0Ch]
		mov	eax, [ecx+ebx*8]
		mov	[edx], eax
		lea	edx, [edx+0Ch]
		mov	eax, [ecx+ebx*8+4]
		inc	ebx
		mov	[edx-8], eax
		cmp	ebx, ebp
		jb	short loc_10014C5C
		mov	ebx, [esp+78h+var_5C]

loc_10014C7B:				; CODE XREF: sub_10014AFC+136j
					; sub_10014AFC+158j
		and	[esp+78h+phNewToken], 0
		mov	ecx, [esp+78h+DisableSidCount]
		mov	eax, [esp+78h+RestrictedSidCount]
		test	ecx, ecx
		jnz	short loc_10014CAE
		test	eax, eax
		jnz	short loc_10014CAE
		test	ebp, ebp
		jnz	short loc_10014CAE
		lea	eax, [esp+78h+phNewToken]
		push	eax		; phNewToken
		push	1		; TokenType
		push	1		; ImpersonationLevel
		push	ebp		; lpTokenAttributes
		push	0F01FFh		; dwDesiredAccess
		push	dword ptr [edi+24h] ; hExistingToken
		call	ds:DuplicateTokenEx
		jmp	short loc_10014CC7
; ---------------------------------------------------------------------------

loc_10014CAE:				; CODE XREF: sub_10014AFC+18Ej
					; sub_10014AFC+192j ...
		lea	edx, [esp+78h+phNewToken]
		push	edx		; NewTokenHandle
		push	ebx		; SidsToRestrict
		push	eax		; RestrictedSidCount
		push	esi		; PrivilegesToDelete
		push	ebp		; DeletePrivilegeCount
		push	[esp+8Ch+SidsToDisable]	; SidsToDisable
		push	ecx		; DisableSidCount
		push	2		; Flags
		push	dword ptr [edi+24h] ; ExistingTokenHandle
		call	ds:CreateRestrictedToken

loc_10014CC7:				; CODE XREF: sub_10014AFC+1B0j
		mov	ebp, eax
		mov	eax, [esp+78h+SidsToDisable]
		test	eax, eax
		jz	short loc_10014CD8
		push	eax		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_10014CD8:				; CODE XREF: sub_10014AFC+1D3j
		test	ebx, ebx
		jz	short loc_10014CE3
		push	ebx		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_10014CE3:				; CODE XREF: sub_10014AFC+1DEj
		test	esi, esi
		jz	short loc_10014CEE
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_10014CEE:				; CODE XREF: sub_10014AFC+1E9j
		test	ebp, ebp
		jz	short loc_10014D71
		push	12h		; WellKnownSidType
		lea	ecx, [esp+7Ch+pSid] ; pSid
		call	sub_10017F98
		mov	esi, 10000000h
		lea	eax, [esp+78h+pSid]
		push	esi		; int
		push	eax		; int
		push	[esp+80h+phNewToken] ; TokenHandle
		call	sub_10008262
		add	esp, 0Ch
		test	al, al
		jz	short loc_10014D71
		push	esi		; int
		push	[esp+7Ch+phNewToken] ; TokenHandle
		call	sub_100082E5
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_10014D71
		push	dword ptr [edi+28h] ; int
		push	[esp+7Ch+phNewToken] ; TokenHandle
		call	sub_100157E1
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10014D7B
		mov	esi, ds:GetCurrentProcess
		push	eax		; dwOptions
		push	eax		; bInheritHandle
		push	0F01FFh		; dwDesiredAccess
		push	[esp+84h+lpTargetHandle] ; lpTargetHandle
		call	esi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[esp+8Ch+phNewToken] ; hSourceHandle
		call	esi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		mov	ecx, [esp+78h+phNewToken]
		mov	esi, eax
		cmp	ecx, [edi+24h]
		jz	short loc_10014D6D
		push	ecx		; hObject
		call	ds:CloseHandle

loc_10014D6D:				; CODE XREF: sub_10014AFC+268j
		test	esi, esi
		jnz	short loc_10014D79

loc_10014D71:				; CODE XREF: sub_10014AFC+1F4j
					; sub_10014AFC+21Aj ...
		call	ds:GetLastError
		jmp	short loc_10014D7B
; ---------------------------------------------------------------------------

loc_10014D79:				; CODE XREF: sub_10014AFC+273j
		xor	eax, eax

loc_10014D7B:				; CODE XREF: sub_10014AFC+23Cj
					; sub_10014AFC+27Bj
		pop	esi
		pop	ebp
		pop	ebx

loc_10014D7E:				; CODE XREF: sub_10014AFC+29j
		mov	ecx, [esp+6Ch+var_4]
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn	4
sub_10014AFC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10014D90(LPHANDLE lpTargetHandle)
sub_10014D90	proc near		; CODE XREF: sub_1001514D+430p

DuplicateTokenHandle= dword ptr	-8
ExistingTokenHandle= dword ptr -4
lpTargetHandle	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		xor	esi, esi
		mov	[ebp+DuplicateTokenHandle], esi
		cmp	byte ptr [ecx+2Ch], 0
		jnz	short loc_10014DA8
		mov	eax, 3F0h
		jmp	short loc_10014E0F
; ---------------------------------------------------------------------------

loc_10014DA8:				; CODE XREF: sub_10014D90+Fj
		lea	eax, [ebp+ExistingTokenHandle]
		push	eax
		call	sub_10014AFC
		test	eax, eax
		jnz	short loc_10014E0F
		lea	eax, [ebp+DuplicateTokenHandle]
		push	eax		; DuplicateTokenHandle
		push	2		; ImpersonationLevel
		push	[ebp+ExistingTokenHandle] ; ExistingTokenHandle
		call	ds:DuplicateToken
		push	[ebp+ExistingTokenHandle] ; hObject
		test	eax, eax
		jnz	short loc_10014DD9
		call	ds:CloseHandle

loc_10014DD1:				; CODE XREF: sub_10014D90+7Bj
		call	ds:GetLastError
		jmp	short loc_10014E0F
; ---------------------------------------------------------------------------

loc_10014DD9:				; CODE XREF: sub_10014D90+39j
		call	ds:CloseHandle
		push	esi		; dwOptions
		push	esi		; bInheritHandle
		mov	esi, ds:GetCurrentProcess
		push	0F01FFh		; dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		call	esi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[ebp+DuplicateTokenHandle] ; hSourceHandle
		call	esi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		push	[ebp+DuplicateTokenHandle] ; hObject
		mov	esi, eax
		call	ds:CloseHandle
		test	esi, esi
		jz	short loc_10014DD1
		xor	eax, eax

loc_10014E0F:				; CODE XREF: sub_10014D90+16j
					; sub_10014D90+23j ...
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10014D90	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10014E16(HANDLE hSourceHandle)
sub_10014E16	proc near		; CODE XREF: sub_1001514D+3Dp

TargetHandle	= dword	ptr -4
hSourceHandle	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+2Ch], 0
		jz	short loc_10014E2A
		mov	eax, 4DFh
		jmp	short loc_10014E85
; ---------------------------------------------------------------------------

loc_10014E2A:				; CODE XREF: sub_10014E16+Bj
		cmp	[ebp+hSourceHandle], 0
		jz	short loc_10014E65
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [ebp+TargetHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10014E5D
		mov	eax, [ebp+TargetHandle]
		mov	[edi+24h], eax
		jmp	short loc_10014E7F
; ---------------------------------------------------------------------------

loc_10014E5D:				; CODE XREF: sub_10014E16+3Dj
					; sub_10014E16+67j
		call	ds:GetLastError
		jmp	short loc_10014E85
; ---------------------------------------------------------------------------

loc_10014E65:				; CODE XREF: sub_10014E16+18j
		lea	eax, [edi+24h]
		push	eax		; TokenHandle
		push	0F01FFh		; DesiredAccess
		call	ds:GetCurrentProcess
		push	eax		; ProcessHandle
		call	ds:OpenProcessToken
		test	eax, eax
		jz	short loc_10014E5D

loc_10014E7F:				; CODE XREF: sub_10014E16+45j
		mov	byte ptr [edi+2Ch], 1
		xor	eax, eax

loc_10014E85:				; CODE XREF: sub_10014E16+12j
					; sub_10014E16+4Dj
		pop	edi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10014E16	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014E8C	proc near		; CODE XREF: sub_1001514D+98p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	[ecx+28h], eax
		xor	eax, eax
		retn	4
sub_10014E8C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014E98	proc near		; CODE XREF: sub_10014F94+37p

arg_0		= dword	ptr  4

		mov	edx, [ecx+8]
		mov	eax, 1FFFFFFFh
		sub	edx, [ecx]
		sar	edx, 3
		mov	ecx, edx
		shr	ecx, 1
		sub	eax, ecx
		cmp	eax, edx
		jnb	short loc_10014EB3
		xor	edx, edx
		jmp	short loc_10014EB5
; ---------------------------------------------------------------------------

loc_10014EB3:				; CODE XREF: sub_10014E98+15j
		add	edx, ecx

loc_10014EB5:				; CODE XREF: sub_10014E98+19j
		cmp	edx, [esp+arg_0]
		jnb	short loc_10014EBF
		mov	edx, [esp+arg_0]

loc_10014EBF:				; CODE XREF: sub_10014E98+21j
		mov	eax, edx
		retn	4
sub_10014E98	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014EC4	proc near		; CODE XREF: sub_10014FDC+3Dp

arg_0		= dword	ptr  4

		mov	eax, [ecx+8]
		sub	eax, [ecx]
		push	44h
		pop	ecx
		cdq
		idiv	ecx
		mov	ecx, 3C3C3C3h
		mov	edx, eax
		shr	edx, 1
		sub	ecx, edx
		cmp	ecx, eax
		jnb	short loc_10014EE2
		xor	eax, eax
		jmp	short loc_10014EE4
; ---------------------------------------------------------------------------

loc_10014EE2:				; CODE XREF: sub_10014EC4+18j
		add	eax, edx

loc_10014EE4:				; CODE XREF: sub_10014EC4+1Cj
		cmp	eax, [esp+arg_0]
		jnb	short locret_10014EEE
		mov	eax, [esp+arg_0]

locret_10014EEE:			; CODE XREF: sub_10014EC4+24j
		retn	4
sub_10014EC4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014EF1	proc near		; CODE XREF: sub_10014F94+3Fp

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		push	0
		push	ebp
		mov	esi, ecx
		call	sub_100144B1
		pop	ecx
		pop	ecx
		mov	edi, eax
		mov	ecx, esi
		push	edi
		push	dword ptr [esi+4]
		push	dword ptr [esi]
		call	sub_1000840C
		mov	ebx, [esi+4]
		sub	ebx, [esi]
		sar	ebx, 3
		cmp	dword ptr [esi], 0
		jz	short loc_10014F29
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10014F29:				; CODE XREF: sub_10014EF1+2Ej
		lea	eax, [edi+ebp*8]
		mov	[esi], edi
		mov	[esi+8], eax
		lea	eax, [edi+ebx*8]
		pop	edi
		mov	[esi+4], eax
		pop	esi
		pop	ebp
		pop	ebx
		retn	4
sub_10014EF1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014F3E	proc near		; CODE XREF: sub_10014FDC+45p

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		push	0
		push	ebx
		mov	esi, ecx
		call	sub_100144DB
		pop	ecx
		pop	ecx
		mov	edi, eax
		mov	ecx, esi
		push	edi
		push	dword ptr [esi+4]
		push	dword ptr [esi]
		call	sub_10014505
		mov	eax, [esi+4]
		sub	eax, [esi]
		push	44h
		cdq
		pop	ecx
		idiv	ecx
		cmp	dword ptr [esi], 0
		mov	ebp, eax
		jz	short loc_10014F7B
		push	dword ptr [esi]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10014F7B:				; CODE XREF: sub_10014F3E+33j
		imul	ecx, ebx, 44h
		imul	eax, ebp, 44h
		mov	[esi], edi
		add	ecx, edi
		add	eax, edi
		mov	[esi+8], ecx
		pop	edi
		mov	[esi+4], eax
		pop	esi
		pop	ebp
		pop	ebx
		retn	4
sub_10014F3E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014F94	proc near		; CODE XREF: sub_1001502C+1Fp
					; sub_1001502C+42p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	ecx, [esp+4+arg_0]
		mov	eax, [esi+8]
		mov	edx, [esi+4]
		sub	eax, edx
		sar	eax, 3
		cmp	eax, ecx
		jnb	short loc_10014FD8
		sub	edx, [esi]
		mov	eax, 1FFFFFFFh
		sar	edx, 3
		sub	eax, edx
		cmp	eax, ecx
		jnb	short loc_10014FC5
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10014FC5:				; CODE XREF: sub_10014F94+24j
		lea	eax, [edx+ecx]
		mov	ecx, esi
		push	eax
		call	sub_10014E98
		push	eax
		mov	ecx, esi
		call	sub_10014EF1

loc_10014FD8:				; CODE XREF: sub_10014F94+14j
		pop	esi
		retn	4
sub_10014F94	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014FDC	proc near		; CODE XREF: sub_1001508D+2Ap
					; sub_1001508D+4Fp

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		push	44h
		pop	ebx
		mov	eax, [esi+8]
		mov	ecx, [esi+4]
		sub	eax, ecx
		cdq
		idiv	ebx
		mov	edi, [esp+0Ch+arg_0]
		cmp	eax, edi
		jnb	short loc_10015026
		sub	ecx, [esi]
		mov	eax, ecx
		mov	ecx, 3C3C3C3h
		cdq
		idiv	ebx
		sub	ecx, eax
		cmp	ecx, edi
		jnb	short loc_10015014
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10015014:				; CODE XREF: sub_10014FDC+2Bj
		add	eax, edi
		mov	ecx, esi
		push	eax
		call	sub_10014EC4
		push	eax
		mov	ecx, esi
		call	sub_10014F3E

loc_10015026:				; CODE XREF: sub_10014FDC+19j
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_10014FDC	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001502C	proc near		; CODE XREF: sub_10008664+60p
					; sub_100149CA+10Ep

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	eax, [esi+4]
		cmp	edi, eax
		jnb	short loc_10015067
		cmp	[esi], edi
		ja	short loc_10015067
		sub	edi, [esi]
		sar	edi, 3
		cmp	eax, [esi+8]
		jnz	short loc_10015050
		push	1
		call	sub_10014F94

loc_10015050:				; CODE XREF: sub_1001502C+1Bj
		mov	edx, [esi+4]
		test	edx, edx
		jz	short loc_10015084
		mov	ecx, [esi]
		mov	eax, [ecx+edi*8]
		mov	[edx], eax
		mov	eax, [ecx+edi*8+4]
		mov	[edx+4], eax
		jmp	short loc_10015084
; ---------------------------------------------------------------------------

loc_10015067:				; CODE XREF: sub_1001502C+Dj
					; sub_1001502C+11j
		cmp	eax, [esi+8]
		jnz	short loc_10015073
		push	1
		call	sub_10014F94

loc_10015073:				; CODE XREF: sub_1001502C+3Ej
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10015084
		mov	eax, [edi]
		mov	[ecx], eax
		mov	eax, [edi+4]
		mov	[ecx+4], eax

loc_10015084:				; CODE XREF: sub_1001502C+29j
					; sub_1001502C+39j ...
		add	dword ptr [esi+4], 8
		pop	edi
		pop	esi
		retn	4
sub_1001502C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001508D	proc near		; CODE XREF: sub_1001457D+144p
					; sub_100146F4+18p ...

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	ecx, [ebx+4]
		cmp	esi, ecx
		jnb	short loc_100150D3
		cmp	[ebx], esi
		ja	short loc_100150D3
		sub	esi, [ebx]
		push	ebp
		mov	eax, esi
		push	44h
		cdq
		pop	ebp
		idiv	ebp
		mov	esi, eax
		cmp	ecx, [ebx+8]
		jnz	short loc_100150BC
		push	1
		mov	ecx, ebx
		call	sub_10014FDC

loc_100150BC:				; CODE XREF: sub_1001508D+24j
		mov	edi, [ebx+4]
		imul	esi, 44h
		add	esi, [ebx]
		test	edi, edi
		jz	short loc_100150CD
		push	11h
		pop	ecx
		rep movsd

loc_100150CD:				; CODE XREF: sub_1001508D+39j
		add	[ebx+4], ebp
		pop	ebp
		jmp	short loc_100150F1
; ---------------------------------------------------------------------------

loc_100150D3:				; CODE XREF: sub_1001508D+Ej
					; sub_1001508D+12j
		cmp	ecx, [ebx+8]
		jnz	short loc_100150E1
		push	1
		mov	ecx, ebx
		call	sub_10014FDC

loc_100150E1:				; CODE XREF: sub_1001508D+49j
		mov	edi, [ebx+4]
		test	edi, edi
		jz	short loc_100150ED
		push	11h
		pop	ecx
		rep movsd

loc_100150ED:				; CODE XREF: sub_1001508D+59j
		add	dword ptr [ebx+4], 44h

loc_100150F1:				; CODE XREF: sub_1001508D+44j
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1001508D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100150F7	proc near		; CODE XREF: sub_1001514D+2Fp
		xor	eax, eax
		mov	[ecx], eax
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		mov	[ecx+0Ch], eax
		mov	[ecx+10h], eax
		mov	[ecx+14h], eax
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], eax
		mov	[ecx+20h], eax
		mov	[ecx+24h], eax
		mov	[ecx+2Ch], al
		mov	eax, ecx
		mov	dword ptr [ecx+28h], 7
		retn
sub_100150F7	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015123	proc near		; CODE XREF: sub_1001514D+453p
		push	esi
		mov	esi, ecx
		cmp	dword ptr [esi+24h], 0
		jz	short loc_10015135
		push	dword ptr [esi+24h] ; hObject
		call	ds:CloseHandle

loc_10015135:				; CODE XREF: sub_10015123+7j
		lea	ecx, [esi+18h]
		call	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime
		lea	ecx, [esi+0Ch]
		call	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime
		mov	ecx, esi
		pop	esi
		jmp	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime
sub_10015123	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=68h

; int __cdecl sub_1001514D(LPHANDLE lpTargetHandle, int, int, int)
sub_1001514D	proc near		; CODE XREF: sub_10016AB5+11p
					; sub_10016AB5+B4p

var_5B8		= byte ptr -5B8h
var_588		= dword	ptr -588h
var_584		= dword	ptr -584h
var_580		= dword	ptr -580h
var_57C		= dword	ptr -57Ch
var_578		= dword	ptr -578h
var_574		= dword	ptr -574h
var_570		= byte ptr -570h
var_52C		= byte ptr -52Ch
var_4E8		= byte ptr -4E8h
var_4A4		= byte ptr -4A4h
var_460		= byte ptr -460h
var_41C		= byte ptr -41Ch
var_3D8		= byte ptr -3D8h
var_394		= byte ptr -394h
var_350		= byte ptr -350h
var_30C		= byte ptr -30Ch
var_2C8		= byte ptr -2C8h
var_284		= byte ptr -284h
var_240		= byte ptr -240h
var_1FC		= byte ptr -1FCh
pSid		= byte ptr -1B8h
var_174		= byte ptr -174h
var_130		= byte ptr -130h
var_EC		= byte ptr -0ECh
var_A8		= byte ptr -0A8h
var_64		= byte ptr -64h
var_4C		= byte ptr -4Ch
var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
lpTargetHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		lea	ebp, [esp-68h]
		sub	esp, 5B8h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+68h+var_4], eax
		push	edi
		mov	edi, [ebp+68h+lpTargetHandle]
		test	edi, edi
		jnz	short loc_10015174
		mov	eax, 0A0h
		jmp	loc_100155A9
; ---------------------------------------------------------------------------

loc_10015174:				; CODE XREF: sub_1001514D+1Bj
		push	ebx
		push	esi
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100150F7
		xor	ebx, ebx
		lea	ecx, [ebp+68h+var_5B8]
		push	ebx		; hSourceHandle
		call	sub_10014E16
		mov	eax, [ebp+68h+arg_4]
		mov	[ebp+68h+var_588], ebx
		mov	[ebp+68h+var_584], ebx
		mov	[ebp+68h+var_580], ebx
		mov	[ebp+68h+var_57C], ebx
		mov	[ebp+68h+var_578], ebx
		mov	[ebp+68h+var_574], ebx
		sub	eax, ebx
		jz	loc_10015510
		dec	eax
		jz	loc_100154C9
		dec	eax
		jz	loc_100153D9
		dec	eax
		jz	loc_100152C4
		dec	eax
		jz	short loc_1001521C
		dec	eax
		jz	short loc_10015206
		dec	eax
		jnz	short loc_100151FC

loc_100151DC:				; CODE XREF: sub_1001514D+C8j
		push	[ebp+68h+arg_8]
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_10014E8C
		mov	eax, [ebp+68h+arg_C]
		sub	eax, ebx
		jz	loc_10015576
		dec	eax
		jz	loc_10015568

loc_100151FC:				; CODE XREF: sub_1001514D+8Dj
		mov	esi, 0A0h
		jmp	loc_10015584
; ---------------------------------------------------------------------------

loc_10015206:				; CODE XREF: sub_1001514D+8Aj
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_10014719

loc_10015211:				; CODE XREF: sub_1001514D+416j
		mov	esi, eax
		test	esi, esi
		jz	short loc_100151DC
		jmp	loc_10015584
; ---------------------------------------------------------------------------

loc_1001521C:				; CODE XREF: sub_1001514D+87j
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+68h+pSid] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+pSid]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	1		; WellKnownSidType
		lea	ecx, [ebp+68h+var_3D8] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_3D8]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	0Bh		; WellKnownSidType
		lea	ecx, [ebp+68h+var_240] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_240]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	11h		; WellKnownSidType
		lea	ecx, [ebp+68h+var_52C] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_52C]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+68h+var_1C]
		call	sub_10001E8D
		lea	eax, [ebp+68h+var_1C]
		push	eax		; void *
		lea	ecx, [ebp+68h+var_588]
		call	sub_10003D92
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+68h+var_1C] ;	void *
		call	sub_100022C1
		jmp	loc_10015539
; ---------------------------------------------------------------------------

loc_100152C4:				; CODE XREF: sub_1001514D+80j
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+68h+var_2C8] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_2C8]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	1		; WellKnownSidType
		lea	ecx, [ebp+68h+var_A8] ;	pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_A8]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	0Bh		; WellKnownSidType
		lea	ecx, [ebp+68h+var_350] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_350]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	11h		; WellKnownSidType
		lea	ecx, [ebp+68h+var_130] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_130]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+68h+var_34]
		call	sub_10001E8D
		lea	eax, [ebp+68h+var_34]
		push	eax		; void *
		lea	ecx, [ebp+68h+var_588]
		call	sub_10003D92
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+68h+var_34] ;	void *
		call	sub_100022C1
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+68h+var_EC] ;	pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_EC]
		push	eax
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100146F4
		push	1		; WellKnownSidType
		lea	ecx, [ebp+68h+var_174] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_174]
		push	eax
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100146F4
		push	12h		; WellKnownSidType
		lea	ecx, [ebp+68h+var_1FC] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_1FC]
		push	eax
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100146F4
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100147EE

loc_100153C9:				; CODE XREF: sub_1001514D+377j
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_10014876
		jmp	loc_10015539
; ---------------------------------------------------------------------------

loc_100153D9:				; CODE XREF: sub_1001514D+79j
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+68h+var_284] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_284]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	1		; WellKnownSidType
		lea	ecx, [ebp+68h+var_30C] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_30C]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	0Bh		; WellKnownSidType
		lea	ecx, [ebp+68h+var_394] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_394]
		push	eax
		lea	ecx, [ebp+68h+var_57C]
		call	sub_1001508D
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+68h+var_64]
		call	sub_10001E8D
		lea	eax, [ebp+68h+var_64]
		push	eax		; void *
		lea	ecx, [ebp+68h+var_588]
		call	sub_10003D92
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+68h+var_64] ;	void *
		call	sub_100022C1
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+68h+var_41C] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_41C]
		push	eax
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100146F4
		push	1		; WellKnownSidType
		lea	ecx, [ebp+68h+var_4E8] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_4E8]
		push	eax
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100146F4
		push	12h		; WellKnownSidType
		lea	ecx, [ebp+68h+var_570] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_570]
		push	eax
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100146F4
		call	sub_10006EF6
		cmp	eax, 3
		jl	short loc_10015539
		jmp	loc_100153C9
; ---------------------------------------------------------------------------

loc_100154C9:				; CODE XREF: sub_1001514D+72j
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+68h+var_4C]
		call	sub_10001E8D
		lea	eax, [ebp+68h+var_4C]
		push	eax		; void *
		lea	ecx, [ebp+68h+var_588]
		call	sub_10003D92
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+68h+var_4C] ;	void *
		call	sub_100022C1
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_10014941
		push	12h		; WellKnownSidType
		lea	ecx, [ebp+68h+var_4A4] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_4A4]
		jmp	short loc_1001552D
; ---------------------------------------------------------------------------

loc_10015510:				; CODE XREF: sub_1001514D+6Bj
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_10014941
		push	ebx		; WellKnownSidType
		lea	ecx, [ebp+68h+var_460] ; pSid
		call	sub_10017F98
		lea	eax, [ebp+68h+var_460]

loc_1001552D:				; CODE XREF: sub_1001514D+3C1j
		push	eax
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100146F4

loc_10015539:				; CODE XREF: sub_1001514D+172j
					; sub_1001514D+287j ...
		lea	eax, [ebp+68h+var_57C]
		push	eax
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_1001457D
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10015584
		lea	eax, [ebp+68h+var_588]
		push	eax
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_100149CA
		jmp	loc_10015211
; ---------------------------------------------------------------------------

loc_10015568:				; CODE XREF: sub_1001514D+A9j
		push	edi
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_10014AFC
		jmp	short loc_10015582
; ---------------------------------------------------------------------------

loc_10015576:				; CODE XREF: sub_1001514D+A2j
		push	edi		; lpTargetHandle
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_10014D90

loc_10015582:				; CODE XREF: sub_1001514D+427j
		mov	esi, eax

loc_10015584:				; CODE XREF: sub_1001514D+B4j
					; sub_1001514D+CAj ...
		lea	ecx, [ebp+68h+var_57C]
		call	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime
		lea	ecx, [ebp+68h+var_588]
		call	sub_100040FD
		lea	ecx, [ebp+68h+var_5B8]
		call	sub_10015123
		mov	eax, esi
		pop	esi
		pop	ebx

loc_100155A9:				; CODE XREF: sub_1001514D+22j
		mov	ecx, [ebp+68h+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		lea	esp, [ebp+68h]
		pop	ebp
		retn
sub_1001514D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100155B9	proc near		; CODE XREF: sub_100157E1+17p
					; sub_10016AB5+4Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		mov	eax, [ebp+arg_0]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_10015601 ; jumptable 100155C9	default	case
		jmp	ds:off_10015609[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100155D0:				; CODE XREF: sub_100155B9+10j
					; DATA XREF: .text:off_10015609o
		mov	eax, offset aS11616384 ; jumptable 100155C9 case 0
		jmp	short loc_10015603
; ---------------------------------------------------------------------------

loc_100155D7:				; CODE XREF: sub_100155B9+10j
					; DATA XREF: .text:off_10015609o
		mov	eax, offset aS11612288 ; jumptable 100155C9 case 1
		jmp	short loc_10015603
; ---------------------------------------------------------------------------

loc_100155DE:				; CODE XREF: sub_100155B9+10j
					; DATA XREF: .text:off_10015609o
		mov	eax, offset aS1168192 ;	jumptable 100155C9 case	2
		jmp	short loc_10015603
; ---------------------------------------------------------------------------

loc_100155E5:				; CODE XREF: sub_100155B9+10j
					; DATA XREF: .text:off_10015609o
		mov	eax, offset aS1166144 ;	jumptable 100155C9 case	3
		jmp	short loc_10015603
; ---------------------------------------------------------------------------

loc_100155EC:				; CODE XREF: sub_100155B9+10j
					; DATA XREF: .text:off_10015609o
		mov	eax, offset aS1164096 ;	jumptable 100155C9 case	4
		jmp	short loc_10015603
; ---------------------------------------------------------------------------

loc_100155F3:				; CODE XREF: sub_100155B9+10j
					; DATA XREF: .text:off_10015609o
		mov	eax, offset aS1162048 ;	jumptable 100155C9 case	5
		jmp	short loc_10015603
; ---------------------------------------------------------------------------

loc_100155FA:				; CODE XREF: sub_100155B9+10j
					; DATA XREF: .text:off_10015609o
		mov	eax, offset aS1160 ; jumptable 100155C9	case 6
		jmp	short loc_10015603
; ---------------------------------------------------------------------------

loc_10015601:				; CODE XREF: sub_100155B9+Ej
					; sub_100155B9+10j
					; DATA XREF: ...
		xor	eax, eax	; jumptable 100155C9 default case

loc_10015603:				; CODE XREF: sub_100155B9+1Cj
					; sub_100155B9+23j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_100155B9	endp

; ---------------------------------------------------------------------------
		db 8Bh,	0FFh
off_10015609	dd offset loc_100155D0	; DATA XREF: sub_100155B9+10r
		dd offset loc_100155D7	; jump table for switch	statement
		dd offset loc_100155DE
		dd offset loc_100155E5
		dd offset loc_100155EC
		dd offset loc_100155F3
		dd offset loc_100155FA
		dd offset loc_10015601

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10015629(HANDLE handle, SE_OBJECT_TYPE ObjectType, void *, void *)
sub_10015629	proc near		; CODE XREF: sub_10016AB5+61p

SecurityDescriptor= dword ptr -2Ch
pSacl		= dword	ptr -28h
bSaclDefaulted	= dword	ptr -24h
bSaclPresent	= dword	ptr -20h
StringSecurityDescriptor= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
handle		= dword	ptr  4
ObjectType	= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		push	ebx
		mov	ebx, [esp+30h+handle]
		lea	ecx, [esp+30h+StringSecurityDescriptor]
		push	ebp
		push	esi
		mov	esi, [esp+38h+arg_8]
		push	edi
		mov	edi, [esp+3Ch+arg_C]
		push	offset aS	; "S:("
		call	sub_10001E8D
		mov	ebp, offset aMl	; "ML"
		push	ebp
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	ebp		; void *
		lea	ecx, [esp+44h+StringSecurityDescriptor]
		call	sub_10003950
		mov	ebp, offset asc_1001DFB0 ; ";;"
		push	ebp
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	ebp		; void *
		lea	ecx, [esp+44h+StringSecurityDescriptor]
		call	sub_10003950
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	esi		; void *
		lea	ecx, [esp+44h+StringSecurityDescriptor]
		call	sub_10003950
		mov	esi, offset asc_1001DFB8 ; ";;;"
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	esi		; void *
		lea	ecx, [esp+44h+StringSecurityDescriptor]
		call	sub_10003950
		push	edi
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	edi		; void *
		lea	ecx, [esp+44h+StringSecurityDescriptor]
		call	sub_10003950
		mov	esi, offset asc_1001DFC0 ; ")"
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	esi		; void *
		lea	ecx, [esp+44h+StringSecurityDescriptor]
		call	sub_10003950
		mov	eax, [esp+3Ch+StringSecurityDescriptor]
		xor	edi, edi
		cmp	[esp+3Ch+var_8], 8
		mov	[esp+3Ch+SecurityDescriptor], edi
		mov	[esp+3Ch+pSacl], edi
		mov	[esp+3Ch+bSaclPresent],	edi
		mov	[esp+3Ch+bSaclDefaulted], edi
		jnb	short loc_100156F6
		lea	eax, [esp+3Ch+StringSecurityDescriptor]

loc_100156F6:				; CODE XREF: sub_10015629+C7j
		push	edi		; SecurityDescriptorSize
		lea	ecx, [esp+40h+SecurityDescriptor]
		push	ecx		; SecurityDescriptor
		push	1		; StringSDRevision
		push	eax		; StringSecurityDescriptor
		call	ConvertStringSecurityDescriptorToSecurityDescriptorW
		test	eax, eax
		jz	short loc_1001574F
		lea	eax, [esp+3Ch+bSaclDefaulted]
		push	eax		; lpbSaclDefaulted
		lea	eax, [esp+40h+pSacl]
		push	eax		; pSacl
		lea	eax, [esp+44h+bSaclPresent]
		push	eax		; lpbSaclPresent
		push	[esp+48h+SecurityDescriptor] ; pSecurityDescriptor
		call	ds:GetSecurityDescriptorSacl
		test	eax, eax
		jz	short loc_1001573B
		push	[esp+3Ch+pSacl]	; pSacl
		push	edi		; pDacl
		push	edi		; psidGroup
		push	edi		; psidOowner
		push	10h		; SecurityInfo
		push	[esp+50h+ObjectType] ; ObjectType
		push	ebx		; handle
		call	ds:SetSecurityInfo
		jmp	short loc_10015741
; ---------------------------------------------------------------------------

loc_1001573B:				; CODE XREF: sub_10015629+FAj
		call	ds:GetLastError

loc_10015741:				; CODE XREF: sub_10015629+110j
		push	[esp+3Ch+SecurityDescriptor] ; hMem
		mov	esi, eax
		call	ds:LocalFree
		jmp	short loc_10015757
; ---------------------------------------------------------------------------

loc_1001574F:				; CODE XREF: sub_10015629+DDj
		call	ds:GetLastError
		mov	esi, eax

loc_10015757:				; CODE XREF: sub_10015629+124j
		push	edi		; int
		push	1		; char
		lea	ecx, [esp+44h+StringSecurityDescriptor]	; void *
		call	sub_100022C1
		mov	ecx, [esp+3Ch+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_10015629	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015778	proc near		; CODE XREF: sub_10019AA7+Bp

TokenHandle	= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		call	sub_10006EF6
		cmp	eax, 3
		jge	short loc_1001578B

loc_10015787:				; CODE XREF: sub_10015778+17j
		xor	eax, eax
		jmp	short loc_100157DD
; ---------------------------------------------------------------------------

loc_1001578B:				; CODE XREF: sub_10015778+Dj
		cmp	[ebp+arg_0], 7
		jz	short loc_10015787
		lea	eax, [ebp+TokenHandle]
		push	eax		; TokenHandle
		push	80h		; DesiredAccess
		call	ds:GetCurrentProcess
		push	eax		; ProcessHandle
		call	ds:OpenProcessToken
		test	eax, eax
		jnz	short loc_100157B3
		call	ds:GetLastError
		jmp	short loc_100157DD
; ---------------------------------------------------------------------------

loc_100157B3:				; CODE XREF: sub_10015778+31j
		and	[ebp+var_4], 0
		lea	ecx, [ebp+var_4]
		push	esi
		push	[ebp+TokenHandle]
		call	sub_10004DE8
		push	[ebp+arg_0]	; int
		push	[ebp+var_4]	; TokenHandle
		call	sub_100157E1
		pop	ecx
		pop	ecx
		lea	ecx, [ebp+var_4]
		mov	esi, eax
		call	sub_10004DA3
		mov	eax, esi
		pop	esi

loc_100157DD:				; CODE XREF: sub_10015778+11j
					; sub_10015778+39j
		mov	esp, ebp
		pop	ebp
		retn
sub_10015778	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100157E1(HANDLE TokenHandle, int)
sub_100157E1	proc near		; CODE XREF: sub_10014AFC+233p
					; sub_10015778+51p

TokenInformation= dword	ptr -0Ch
var_8		= dword	ptr -8
Sid		= dword	ptr -4
TokenHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		call	sub_10006EF6
		cmp	eax, 3
		jge	short loc_100157F5

loc_100157F1:				; CODE XREF: sub_100157E1+1Fj
		xor	eax, eax
		jmp	short loc_10015864
; ---------------------------------------------------------------------------

loc_100157F5:				; CODE XREF: sub_100157E1+Ej
		push	[ebp+arg_4]
		call	sub_100155B9
		pop	ecx
		test	eax, eax
		jz	short loc_100157F1
		push	edi
		lea	ecx, [ebp+Sid]
		xor	edi, edi
		push	ecx		; Sid
		push	eax		; StringSid
		mov	[ebp+Sid], edi
		call	ConvertStringSidToSidW
		test	eax, eax
		jnz	short loc_1001581E
		call	ds:GetLastError
		jmp	short loc_10015863
; ---------------------------------------------------------------------------

loc_1001581E:				; CODE XREF: sub_100157E1+33j
		mov	eax, [ebp+Sid]
		push	esi
		mov	[ebp+var_8], edi
		push	eax		; pSid
		mov	[ebp+var_8], 20h
		mov	[ebp+TokenInformation],	eax
		call	ds:GetLengthSid
		add	eax, 8
		push	eax		; TokenInformationLength
		lea	eax, [ebp+TokenInformation]
		push	eax		; TokenInformation
		push	19h		; TokenInformationClass
		push	[ebp+TokenHandle] ; TokenHandle
		call	ds:SetTokenInformation
		push	[ebp+Sid]	; hMem
		mov	esi, eax
		call	ds:LocalFree
		test	esi, esi
		pop	esi
		jnz	short loc_10015861
		call	ds:GetLastError
		mov	edi, eax

loc_10015861:				; CODE XREF: sub_100157E1+76j
		mov	eax, edi

loc_10015863:				; CODE XREF: sub_100157E1+3Bj
		pop	edi

loc_10015864:				; CODE XREF: sub_100157E1+12j
		mov	esp, ebp
		pop	ebp
		retn
sub_100157E1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015868	proc near		; CODE XREF: mozilla::SandboxBroker::SandboxBroker(void)+13p
		cmp	g_shared_section, 0
		jz	short loc_10015874
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10015874:				; CODE XREF: sub_10015868+7j
		mov	byte_10033D28, 1
		jmp	sub_1000EAA8
sub_10015868	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015880	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+6Bp
					; TargetNtOpenFile(x,x,x,x,x,x,x)+5Dp ...

; FUNCTION CHUNK AT 10019A64 SIZE 00000028 BYTES

		cmp	g_shared_section, 0
		jnz	short loc_1001588C
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001588C:				; CODE XREF: sub_10015880+7j
		mov	byte_10033D28, 0
		jmp	loc_10019A64
sub_10015880	endp

; Exported entry  15. IsSandboxedProcess

; =============== S U B	R O U T	I N E =======================================


		public IsSandboxedProcess
IsSandboxedProcess proc	near		; DATA XREF: .rdata:off_10030468o
		xor	eax, eax
		cmp	g_shared_section, eax
		setnz	al
		retn
IsSandboxedProcess endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100158A4	proc near		; CODE XREF: sub_1000F8EF+23p
					; sub_1000F949+Fp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		xor	esi, esi
		cmp	[ebp+arg_4], esi
		jnz	short loc_100158CA
		call	sub_10015D9C
		test	al, al
		jz	short loc_100158DF
		push	[ebp+arg_0]
		push	esi
		push	dword_10033D90
		call	dword_10033D64
		jmp	short loc_100158DD
; ---------------------------------------------------------------------------

loc_100158CA:				; CODE XREF: sub_100158A4+9j
		cmp	[ebp+arg_4], 1
		jnz	short loc_100158DF
		push	[ebp+arg_0]
		push	[ebp+arg_8]
		call	sub_10015A3E
		pop	ecx
		pop	ecx

loc_100158DD:				; CODE XREF: sub_100158A4+24j
		mov	esi, eax

loc_100158DF:				; CODE XREF: sub_100158A4+12j
					; sub_100158A4+2Aj
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
sub_100158A4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100158E4	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+225p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+206p	...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	[ebp+arg_4], 0
		jnz	short loc_10015901
		push	[ebp+arg_0]
		push	0
		push	dword_10033D90
		call	dword_10033D7C
		jmp	short loc_10015926
; ---------------------------------------------------------------------------

loc_10015901:				; CODE XREF: sub_100158E4+8j
		cmp	[ebp+arg_4], 1
		jnz	short loc_10015926
		mov	eax, [ebp+arg_0]
		and	[ebp+arg_4], 0
		mov	[ebp+var_4], eax
		lea	eax, [ebp+arg_4]
		push	8000h
		push	eax
		lea	eax, [ebp+var_4]
		push	eax
		push	0FFFFFFFFh
		call	dword_10033D44

loc_10015926:				; CODE XREF: sub_100158E4+1Bj
					; sub_100158E4+21j
		mov	esp, ebp
		pop	ebp
		retn
sub_100158E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001592A	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+E5p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+D4p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	18h
		push	offset stru_10030358
		call	__SEH_prolog4
		call	sub_10015D9C
		test	al, al
		jnz	short loc_10015949
		mov	eax, 0C0000017h
		jmp	loc_10015A38
; ---------------------------------------------------------------------------

loc_10015949:				; CODE XREF: sub_1001592A+13j
		xor	esi, esi
		mov	eax, [ebp+arg_4]
		mov	[eax], esi
		mov	edi, 0C0000001h
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	ebx, [ebp+arg_0]
		cmp	[ebx+4], esi
		jz	short loc_10015969
		cmp	[ebp+arg_C], esi
		jz	loc_100159F5

loc_10015969:				; CODE XREF: sub_1001592A+34j
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_100159F5
		cmp	[eax+4], esi
		jz	short loc_100159F5
		movzx	eax, word ptr [eax]
		push	2
		pop	edx
		add	eax, edx
		mov	[ebp+var_20], eax
		shr	eax, 1
		mov	[ebp+var_24], eax
		push	esi
		push	esi
		xor	ecx, ecx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_100158A4
		add	esp, 0Ch
		mov	ecx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], ecx
		test	ecx, ecx
		jz	short loc_100159F5
		mov	eax, [ebp+var_20]
		add	eax, 0FFFFFFFEh
		push	eax
		mov	eax, [ebx+8]
		push	dword ptr [eax+4]
		push	ecx
		call	sub_10015B5F
		add	esp, 0Ch
		mov	edi, eax
		mov	[ebp+var_1C], edi
		test	edi, edi
		js	short loc_100159F5
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		xor	edx, edx
		mov	ecx, [ebp+var_24]
		mov	[eax+ecx*2-2], dx
		mov	ecx, [ebp+arg_8]
		test	ecx, ecx
		jz	short loc_100159E4
		mov	eax, [ebx+0Ch]
		mov	[ecx], eax

loc_100159E4:				; CODE XREF: sub_1001592A+B3j
		mov	ecx, [ebp+arg_C]
		test	ecx, ecx
		jz	short loc_100159F0
		mov	eax, [ebx+4]
		mov	[ecx], eax

loc_100159F0:				; CODE XREF: sub_1001592A+BFj
		mov	edi, esi
		mov	[ebp+var_1C], edi

loc_100159F5:				; CODE XREF: sub_1001592A+39j
					; sub_1001592A+44j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_10015A1E
; ---------------------------------------------------------------------------

loc_100159FE:				; DATA XREF: .rdata:stru_10030358o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 1001592A
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_28], eax
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10015A0C:				; DATA XREF: .rdata:stru_10030358o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1001592A
		mov	edi, [ebp+var_28]
		mov	[ebp+var_1C], edi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	esi, esi

loc_10015A1E:				; CODE XREF: sub_1001592A+D2j
		test	edi, edi
		jns	short loc_10015A36
		mov	ebx, [ebp+arg_4]
		cmp	dword ptr [ebx], 0
		jz	short loc_10015A36
		push	esi
		push	dword ptr [ebx]
		call	sub_100158E4
		pop	ecx
		pop	ecx
		mov	[ebx], esi

loc_10015A36:				; CODE XREF: sub_1001592A+F6j
					; sub_1001592A+FEj
		mov	eax, edi

loc_10015A38:				; CODE XREF: sub_1001592A+1Aj
		call	__SEH_epilog4
		retn
sub_1001592A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015A3E	proc near		; CODE XREF: sub_100158A4+32p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx

loc_10015A43:				; CODE XREF: sub_10015A3E+34j
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_8]
		push	1
		push	2000h
		push	eax
		push	0
		lea	eax, [ebp+var_4]
		mov	[ebp+var_8], 10000h
		push	eax
		push	0FFFFFFFFh
		call	g_nt
		test	eax, eax
		js	short loc_10015A9C
		cmp	[ebp+var_4], 80000h
		jb	short loc_10015A43
		mov	eax, [ebp+arg_4]
		push	4
		push	1000h
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_8]
		push	eax
		push	0
		lea	eax, [ebp+var_4]
		push	eax
		push	0FFFFFFFFh
		call	g_nt
		test	eax, eax
		js	short loc_10015A9C
		mov	eax, [ebp+var_4]
		jmp	short loc_10015A9E
; ---------------------------------------------------------------------------

loc_10015A9C:				; CODE XREF: sub_10015A3E+2Bj
					; sub_10015A3E+57j
		xor	eax, eax

loc_10015A9E:				; CODE XREF: sub_10015A3E+5Cj
		mov	esp, ebp
		pop	ebp
		retn
sub_10015A3E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015AA2	proc near		; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+EAp
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+FBp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		push	esi
		call	dword_10033D84
		pop	ecx
		mov	word ptr [ebp+var_8], ax
		mov	ecx, [ebp+var_8]
		inc	ecx
		mov	[ebp+var_4], esi
		mov	word ptr [ebp+var_8+2],	cx
		cmp	ax, cx
		ja	short loc_10015B19
		movzx	eax, cx
		lea	esi, ds:8[eax*2]
		call	sub_10015D9C
		test	al, al
		jz	short loc_10015B19
		push	esi
		push	0
		push	dword_10033D90
		call	dword_10033D64
		mov	esi, eax
		test	esi, esi
		jz	short loc_10015B19
		mov	ecx, [ebp+var_8+2]
		lea	eax, [ebp+var_8]
		add	ecx, ecx
		push	0
		mov	[esi+2], cx
		lea	ecx, [esi+8]
		push	eax
		push	esi
		mov	[esi+4], ecx
		call	dword_10033D68
		test	eax, eax
		jns	short loc_10015B20
		push	0
		push	esi
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_10015B19:				; CODE XREF: sub_10015AA2+23j
					; sub_10015AA2+36j ...
		xor	eax, eax

loc_10015B1B:				; CODE XREF: sub_10015AA2+80j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10015B20:				; CODE XREF: sub_10015AA2+6Bj
		mov	eax, esi
		jmp	short loc_10015B1B
sub_10015AA2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015B24	proc near		; CODE XREF: sub_1000A64F+6Ap
					; sub_1001855A+6Fp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		push	esi
		mov	esi, ecx
		mov	[ebp+arg_4], eax
		lea	eax, [esi+0Ch]
		push	eax
		push	[ebp+arg_8]
		lea	eax, [ebp+arg_4]
		push	eax
		lea	eax, [ebp+arg_0]
		push	eax
		push	0FFFFFFFFh
		call	dword_10033D4C
		test	eax, eax
		js	short loc_10015B5A
		mov	ecx, [ebp+arg_0]
		mov	[esi+4], ecx
		mov	ecx, [ebp+arg_4]
		mov	byte ptr [esi],	1
		mov	[esi+8], ecx

loc_10015B5A:				; CODE XREF: sub_10015B24+25j
		pop	esi
		pop	ebp
		retn	0Ch
sub_10015B24	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015B5F	proc near		; CODE XREF: TargetNtSetInformationThread(x,x,x,x,x)+36p
					; sub_1001592A+8Ep ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	0Ch
		push	offset stru_10030338
		call	__SEH_prolog4
		xor	esi, esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword_10033D8C
		add	esp, 0Ch
		jmp	short loc_10015B98
; ---------------------------------------------------------------------------

loc_10015B84:				; DATA XREF: .rdata:stru_10030338o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 10015B5F
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10015B92:				; DATA XREF: .rdata:stru_10030338o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10015B5F
		mov	esi, [ebp+var_1C]

loc_10015B98:				; CODE XREF: sub_10015B5F+23j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, esi
		call	__SEH_epilog4
		retn
sub_10015B5F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015BA7	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+BFp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	ebx
		push	esi
		push	edi
		test	eax, eax
		jz	short loc_10015BE1
		mov	edx, [eax+4]
		test	edx, edx
		jz	short loc_10015BE1
		movzx	eax, word ptr [eax]
		xor	edi, edi
		shr	eax, 1
		dec	eax
		mov	ecx, eax
		js	short loc_10015BEB
		lea	esi, [edx+eax*2]

loc_10015BC8:				; CODE XREF: sub_10015BA7+2Bj
		cmp	word ptr [esi],	5Ch
		jz	short loc_10015BD6
		sub	esi, 2
		dec	ecx
		jns	short loc_10015BC8
		jmp	short loc_10015BD9
; ---------------------------------------------------------------------------

loc_10015BD6:				; CODE XREF: sub_10015BA7+25j
		lea	edi, [edx+ecx*2]

loc_10015BD9:				; CODE XREF: sub_10015BA7+2Dj
		cmp	ecx, eax
		jnz	short loc_10015BE7
		test	edi, edi
		jz	short loc_10015BEB

loc_10015BE1:				; CODE XREF: sub_10015BA7+9j
					; sub_10015BA7+10j ...
		xor	eax, eax

loc_10015BE3:				; CODE XREF: sub_10015BA7+B2j
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10015BE7:				; CODE XREF: sub_10015BA7+34j
		test	edi, edi
		jnz	short loc_10015BEE

loc_10015BEB:				; CODE XREF: sub_10015BA7+1Cj
					; sub_10015BA7+38j
		lea	edi, [edx-2]

loc_10015BEE:				; CODE XREF: sub_10015BA7+42j
		sub	eax, ecx
		lea	ebx, ds:2[eax*2]
		call	sub_10015D9C
		test	al, al
		jz	short loc_10015BE1
		lea	eax, [ebx+8]
		push	eax
		push	0
		push	dword_10033D90
		call	dword_10033D64
		mov	esi, eax
		test	esi, esi
		jz	short loc_10015BE1
		lea	ecx, [ebx-2]
		mov	[esi+2], bx
		movzx	eax, cx
		lea	edx, [esi+8]
		push	eax
		lea	eax, [edi+2]
		mov	[esi+4], edx
		push	eax
		push	edx
		mov	[esi], cx
		call	sub_10015B5F
		add	esp, 0Ch
		test	eax, eax
		jns	short loc_10015C49
		push	0
		push	esi
		call	sub_100158E4
		pop	ecx
		pop	ecx
		jmp	short loc_10015BE1
; ---------------------------------------------------------------------------

loc_10015C49:				; CODE XREF: sub_10015BA7+94j
		movzx	ecx, word ptr [esi]
		mov	eax, [esi+4]
		shr	ecx, 1
		xor	edx, edx
		mov	[eax+ecx*2], dx
		mov	eax, esi
		jmp	short loc_10015BE3
sub_10015BA7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015C5B	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+A9p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		push	edi
		mov	edi, 208h

loc_10015C66:				; CODE XREF: sub_10015C5B+50j
		call	sub_10015D9C
		test	al, al
		jz	short loc_10015CBB
		push	edi
		push	0
		push	dword_10033D90
		call	dword_10033D64
		mov	esi, eax
		test	esi, esi
		jz	short loc_10015CBB
		lea	eax, [ebp+var_4]
		push	eax
		push	edi
		push	esi
		push	2
		push	[ebp+arg_0]
		push	0FFFFFFFFh
		call	dword_10033D5C
		cmp	eax, 80000005h
		jnz	short loc_10015CAD
		push	0
		push	esi
		call	sub_100158E4
		mov	edi, [ebp+var_4]
		pop	ecx
		pop	ecx
		jmp	short loc_10015C66
; ---------------------------------------------------------------------------

loc_10015CAD:				; CODE XREF: sub_10015C5B+41j
		test	eax, eax
		jns	short loc_10015CC3
		push	0
		push	esi
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_10015CBB:				; CODE XREF: sub_10015C5B+12j
					; sub_10015C5B+27j
		xor	eax, eax

loc_10015CBD:				; CODE XREF: sub_10015C5B+6Aj
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10015CC3:				; CODE XREF: sub_10015C5B+54j
		mov	eax, esi
		jmp	short loc_10015CBD
sub_10015C5B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015CC7	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+BDp
					; TargetNtOpenFile(x,x,x,x,x,x,x)+AFp ...
		call	sub_10015EFD
		test	al, al
		jnz	short loc_10015CD3
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10015CD3:				; CODE XREF: sub_10015CC7+7j
		mov	eax, dword_10033DA0
		retn
sub_10015CC7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015CD9	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+A0p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	14h
		push	offset stru_10030378
		call	__SEH_prolog4
		xor	edi, edi
		mov	[ebp+var_1C], edi
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	esi, [ebp+arg_4]
		mov	[esi], edi
		mov	ebx, offset off_1001CAC8
		mov	[ebp+var_24], ebx
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		lea	ecx, [ebp+var_24]
		call	sub_10005F17
		test	al, al
		jz	short loc_10015D4D
		or	dword ptr [esi], 1
		push	edi
		lea	ecx, [ebp+var_24]
		call	sub_10005CDE
		test	eax, eax
		jz	short loc_10015D31
		push	dword ptr [eax+0Ch]
		lea	ecx, [ebp+var_24]
		call	sub_10005EE3
		push	eax
		call	sub_10015AA2
		pop	ecx
		mov	[ebp+var_1C], eax

loc_10015D31:				; CODE XREF: sub_10015CD9+41j
		lea	ecx, [ebp+var_24]
		call	sub_10005D91
		test	eax, eax
		jz	short loc_10015D4D
		cmp	[eax+28h], edi
		jz	short loc_10015D45
		or	dword ptr [esi], 2

loc_10015D45:				; CODE XREF: sub_10015CD9+67j
		cmp	[eax+1Ch], edi
		jz	short loc_10015D4D
		or	dword ptr [esi], 4

loc_10015D4D:				; CODE XREF: sub_10015CD9+31j
					; sub_10015CD9+62j ...
		mov	[ebp+var_24], ebx
		jmp	short loc_10015D59
; ---------------------------------------------------------------------------

loc_10015D52:				; DATA XREF: .rdata:stru_10030378o
		xor	eax, eax	; Exception filter 0 for function 10015CD9
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10015D56:				; DATA XREF: .rdata:stru_10030378o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10015CD9

loc_10015D59:				; CODE XREF: sub_10015CD9+77j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
sub_10015CD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015D69	proc near		; CODE XREF: sub_10015DE3+1Ep
					; sub_10015DE3+34p

var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		lea	eax, [ebp+var_4]
		push	eax
		push	18h
		lea	eax, [ebp+var_1C]
		push	eax
		push	0
		push	[ebp+arg_0]
		call	dword_10033D50
		test	eax, eax
		js	short loc_10015D98
		cmp	[ebp+var_4], 18h
		jnz	short loc_10015D98
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		mov	[ecx], eax
		xor	eax, eax

loc_10015D98:				; CODE XREF: sub_10015D69+1Dj
					; sub_10015D69+23j
		mov	esp, ebp
		pop	ebp
		retn
sub_10015D69	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015D9C	proc near		; CODE XREF: sub_100158A4+Bp
					; sub_1001592A+Cp ...
		cmp	dword_10033D90,	0
		jnz	short loc_10015DD7
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	2
		call	dword_10033D70
		mov	edx, eax
		test	edx, edx
		jnz	short loc_10015DBD
		xor	al, al
		retn
; ---------------------------------------------------------------------------

loc_10015DBD:				; CODE XREF: sub_10015D9C+1Cj
		push	esi
		mov	ecx, edx
		mov	esi, offset dword_10033D90
		xor	eax, eax
		lock cmpxchg [esi], ecx
		pop	esi
		test	eax, eax
		jz	short loc_10015DD7
		push	edx
		call	dword_10033D78

loc_10015DD7:				; CODE XREF: sub_10015D9C+7j
					; sub_10015D9C+32j
		xor	eax, eax
		cmp	dword_10033D90,	eax
		setnz	al
		retn
sub_10015D9C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015DE3	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+70p
					; TargetNtUnmapViewOfSection(x,x,x)+16p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_10015DF1
		mov	al, 1
		jmp	short loc_10015E30
; ---------------------------------------------------------------------------

loc_10015DF1:				; CODE XREF: sub_10015DE3+8j
		cmp	dword_10033DA8,	0
		jnz	short loc_10015E10
		push	offset dword_10033DA8
		push	0FFFFFFFFh
		call	sub_10015D69
		pop	ecx
		pop	ecx
		test	eax, eax
		jns	short loc_10015E10

loc_10015E0C:				; CODE XREF: sub_10015DE3+3Dj
		xor	al, al
		jmp	short loc_10015E30
; ---------------------------------------------------------------------------

loc_10015E10:				; CODE XREF: sub_10015DE3+15j
					; sub_10015DE3+27j
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_0]
		call	sub_10015D69
		pop	ecx
		pop	ecx
		test	eax, eax
		js	short loc_10015E0C
		mov	ecx, [ebp+var_4]
		xor	eax, eax
		cmp	ecx, dword_10033DA8
		setz	al

loc_10015E30:				; CODE XREF: sub_10015DE3+Cj
					; sub_10015DE3+2Bj
		mov	esp, ebp
		pop	ebp
		retn
sub_10015DE3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015E34	proc near		; CODE XREF: sub_1000AB22+4Fp
					; TargetNtSetInformationFile(x,x,x,x,x,x)+E4p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	[esp+arg_8], 0Ah
		jnz	short loc_10015E86
		mov	eax, [esp+arg_4]
		cmp	eax, 10h
		jb	short loc_10015E86
		mov	ecx, [esp+arg_0]
		add	eax, 0FFFFFFF4h
		cmp	eax, [ecx+8]
		jb	short loc_10015E86
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_10015E86
		cmp	dword ptr [ecx+8], 8
		jb	short loc_10015E86
		cmp	dword ptr [ecx+8], 0FFFFh
		ja	short loc_10015E86
		push	5Ch
		pop	eax
		cmp	[ecx+0Ch], ax
		jnz	short loc_10015E86
		push	3Fh
		pop	edx
		cmp	[ecx+0Eh], dx
		jnz	short loc_10015E86
		cmp	[ecx+10h], dx
		jnz	short loc_10015E86
		cmp	[ecx+12h], ax
		jnz	short loc_10015E86
		mov	al, 1
		retn
; ---------------------------------------------------------------------------

loc_10015E86:				; CODE XREF: sub_10015E34+5j
					; sub_10015E34+Ej ...
		xor	al, al
		retn
sub_10015E34	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015E89	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+8Bp

var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		cmp	[ebp+arg_0], 0
		push	esi
		jz	short loc_10015EF6
		cmp	[ebp+arg_4], 0
		jz	short loc_10015EF6
		cmp	[ebp+arg_C], 0
		jz	short loc_10015EF6
		cmp	[ebp+arg_8], 0
		jnz	short loc_10015EF6
		xor	esi, esi
		lea	eax, [ebp+var_4]
		push	esi
		push	esi
		push	1
		push	eax
		push	0FFFFFFFFh
		push	[ebp+arg_0]
		push	0FFFFFFFFh
		call	dword_10033D40
		test	eax, eax
		js	short loc_10015EF6
		lea	eax, [ebp+arg_0]
		push	eax
		push	10h
		lea	eax, [ebp+var_14]
		push	eax
		push	esi
		push	[ebp+var_4]
		call	dword_10033D58
		push	[ebp+var_4]
		mov	esi, eax
		call	dword_10033D3C
		test	esi, esi
		js	short loc_10015EF6
		cmp	[ebp+arg_0], 10h
		jnz	short loc_10015EF6
		mov	eax, [ebp+var_10]
		shr	eax, 18h
		and	al, 1
		jmp	short loc_10015EF8
; ---------------------------------------------------------------------------

loc_10015EF6:				; CODE XREF: sub_10015E89+Bj
					; sub_10015E89+11j ...
		xor	al, al

loc_10015EF8:				; CODE XREF: sub_10015E89+6Bj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10015E89	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015EFD	proc near		; CODE XREF: sub_10015CC7p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		xor	ecx, ecx
		cmp	dword_10033DA0,	ecx
		jnz	short loc_10015F65
		push	4
		push	ecx
		push	2
		lea	eax, [ebp+var_8]
		mov	[ebp+var_4], ecx
		push	eax
		push	ecx
		push	ecx
		push	ecx
		lea	eax, [ebp+var_4]
		mov	[ebp+var_8], ecx
		push	eax
		push	0FFFFFFFFh
		push	g_shared_section
		call	dword_10033D48
		test	eax, eax
		js	short loc_10015F6B
		mov	ecx, [ebp+var_4]
		test	ecx, ecx
		jz	short loc_10015F6B
		mov	edx, offset dword_10033DA0
		xor	eax, eax
		lock cmpxchg [edx], ecx
		test	eax, eax
		jz	short loc_10015F55
		push	[ebp+var_4]
		push	0FFFFFFFFh
		call	dword_10033D60

loc_10015F55:				; CODE XREF: sub_10015EFD+4Bj
		mov	eax, dword_10033DA0
		add	eax, g_shared_IPC_size
		mov	dword_10033D9C,	eax

loc_10015F65:				; CODE XREF: sub_10015EFD+Dj
		mov	al, 1

loc_10015F67:				; CODE XREF: sub_10015EFD+70j
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10015F6B:				; CODE XREF: sub_10015EFD+35j
					; sub_10015EFD+3Cj
		xor	al, al
		jmp	short loc_10015F67
sub_10015EFD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015F6F	proc near		; CODE XREF: sub_1000A64F+90p
					; sub_1001855A+B7p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, ecx
		cmp	byte ptr [ebx],	0
		jnz	short loc_10015F7F
		xor	eax, eax
		jmp	short loc_10015FAA
; ---------------------------------------------------------------------------

loc_10015F7F:				; CODE XREF: sub_10015F6F+Aj
		mov	eax, [ebx+8]
		push	esi
		push	edi
		lea	edi, [ebx+0Ch]
		mov	[ebp+var_4], eax
		push	edi
		push	dword ptr [edi]
		lea	eax, [ebp+var_4]
		push	eax
		lea	esi, [ebx+4]
		push	esi
		push	0FFFFFFFFh
		call	dword_10033D4C
		xor	ecx, ecx
		mov	[edi], ecx
		pop	edi
		mov	[esi], ecx
		mov	[ebx], cl
		mov	[ebx+8], ecx
		pop	esi

loc_10015FAA:				; CODE XREF: sub_10015F6F+Ej
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10015F6F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015FAF	proc near		; CODE XREF: sub_10015FEE+19p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		xor	edx, edx
		push	esi
		mov	esi, [esp+4+arg_4]
		dec	esi
		add	esi, ecx
		cmp	[esp+4+arg_8], 1
		jnz	short loc_10015FE1
		jmp	short loc_10015FCE
; ---------------------------------------------------------------------------

loc_10015FC6:				; CODE XREF: sub_10015FAF+21j
		mov	[ecx], dl
		add	ecx, 1000h

loc_10015FCE:				; CODE XREF: sub_10015FAF+15j
		cmp	ecx, esi
		jb	short loc_10015FC6
		mov	[esi], dl
		jmp	short loc_10015FEA
; ---------------------------------------------------------------------------

loc_10015FD6:				; CODE XREF: sub_10015FAF+34j
		movsx	eax, byte ptr [ecx]
		add	edx, eax
		add	ecx, 1000h

loc_10015FE1:				; CODE XREF: sub_10015FAF+13j
		cmp	ecx, esi
		jb	short loc_10015FD6
		movsx	ecx, byte ptr [esi]
		add	edx, ecx

loc_10015FEA:				; CODE XREF: sub_10015FAF+25j
		mov	eax, edx
		pop	esi
		retn
sub_10015FAF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015FEE	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+98p
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+ADp ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	8
		push	offset stru_10030318
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10015FAF
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	al, 1
		jmp	short loc_1001602A
; ---------------------------------------------------------------------------

loc_1001601A:				; DATA XREF: .rdata:stru_10030318o
		xor	eax, eax	; Exception filter 0 for function 10015FEE
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001601E:				; DATA XREF: .rdata:stru_10030318o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10015FEE
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	al, al

loc_1001602A:				; CODE XREF: sub_10015FEE+2Aj
		call	__SEH_epilog4
		retn
sub_10015FEE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016030	proc near		; CODE XREF: sub_10016FBF+4p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10016057
		cmp	eax, 15555555h
		ja	short loc_10016051
		imul	eax, 0Ch
		push	eax		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10016057

loc_10016051:				; CODE XREF: sub_10016030+Fj
		jmp	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)
; ---------------------------------------------------------------------------

loc_10016057:				; CODE XREF: sub_10016030+8j
					; sub_10016030+1Fj
		mov	eax, ecx
		retn
sub_10016030	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001605A	proc near		; CODE XREF: sub_10010C9A+11p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	[esp+arg_4]
		push	[esp+4+arg_0]
		call	sub_10016FBF
		lea	edx, [eax+8]
		test	edx, edx
		jz	short locret_10016076
		mov	ecx, [esp+arg_8]
		mov	ecx, [ecx]
		mov	[edx], ecx

locret_10016076:			; CODE XREF: sub_1001605A+12j
		retn	0Ch
sub_1001605A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016079	proc near		; CODE XREF: sub_1001651A+33p

arg_0		= dword	ptr  4

		push	esi
		xor	eax, eax
		mov	esi, ecx
		push	eax
		push	eax
		mov	[esi], eax
		mov	[esi+4], eax
		call	sub_10011688
		mov	[esi], eax
		mov	eax, [esp+4+arg_0]
		mov	[esi+8], eax
		mov	eax, esi
		pop	esi
		retn	4
sub_10016079	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016099	proc near		; CODE XREF: sub_100092F9+14p
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		push	ebx
		push	ebx
		mov	[edi+4], ebx
		lea	esi, [edi+2Ch]
		mov	[edi+8], ebx
		mov	ecx, esi
		mov	[edi+0Ch], ebx
		mov	dword ptr [edi+10h], offset off_1001E070
		mov	dword ptr [edi], offset	off_1001E0D8
		mov	dword ptr [edi+10h], offset off_1001E0E4
		mov	[esi], ebx
		mov	[esi+4], ebx
		call	sub_10016FBF
		mov	[esi], eax
		lea	ecx, [edi+0DCh]
		or	dword ptr [edi+50h], 0FFFFFFFFh
		or	dword ptr [edi+54h], 0FFFFFFFFh
		push	7
		pop	eax
		mov	dword ptr [edi+34h], 1
		mov	[edi+38h], ebx
		mov	[edi+3Ch], ebx
		mov	[edi+40h], ebx
		mov	[edi+44h], ebx
		mov	[edi+48h], ebx
		mov	dword ptr [edi+4Ch], 1000000h
		mov	[edi+58h], eax
		mov	[edi+5Ch], eax
		mov	[edi+60h], ebx
		mov	[edi+64h], ebx
		mov	[edi+68h], ebx
		mov	[edi+6Ch], ebx
		mov	[edi+0C8h], ebx
		mov	[edi+0CCh], ebx
		mov	[edi+0D0h], ebx
		mov	[edi+0D4h], ebx
		mov	[edi+0D8h], ebx
		call	sub_1000CD63
		lea	eax, [edi+14h]
		mov	[edi+0E4h], ebx
		mov	[edi+0E8h], ebx
		mov	[edi+0ECh], ebx
		push	eax		; lpCriticalSection
		mov	[edi+0F0h], ebx
		call	ds:InitializeCriticalSection
		push	58h		; size_t
		lea	eax, [edi+70h]
		push	ebx		; int
		push	eax		; void *
		call	memset
		push	14h
		pop	esi
		push	esi		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001617B
		push	edi
		mov	ecx, eax
		call	sub_1000A75B
		jmp	short loc_1001617D
; ---------------------------------------------------------------------------

loc_1001617B:				; CODE XREF: sub_10016099+D6j
		mov	eax, ebx

loc_1001617D:				; CODE XREF: sub_10016099+E0j
		push	esi		; unsigned int
		mov	[edi+7Ch], eax
		mov	[edi+80h], eax
		mov	[edi+8Ch], eax
		mov	[edi+84h], eax
		mov	[edi+88h], eax
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100161AD
		push	edi
		mov	ecx, eax
		call	sub_1000FD0A
		jmp	short loc_100161AF
; ---------------------------------------------------------------------------

loc_100161AD:				; CODE XREF: sub_10016099+108j
		mov	eax, ebx

loc_100161AF:				; CODE XREF: sub_10016099+112j
		push	esi		; unsigned int
		mov	[edi+90h], eax
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100161CA
		push	edi
		mov	ecx, eax
		call	sub_100120AE
		jmp	short loc_100161CC
; ---------------------------------------------------------------------------

loc_100161CA:				; CODE XREF: sub_10016099+125j
		mov	eax, ebx

loc_100161CC:				; CODE XREF: sub_10016099+12Fj
		push	esi		; unsigned int
		mov	[edi+94h], eax
		mov	[edi+98h], eax
		mov	[edi+0A4h], eax
		mov	[edi+9Ch], eax
		mov	[edi+0A0h], eax
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100161FF
		push	edi
		mov	ecx, eax
		call	sub_10018723
		jmp	short loc_10016201
; ---------------------------------------------------------------------------

loc_100161FF:				; CODE XREF: sub_10016099+15Aj
		mov	eax, ebx

loc_10016201:				; CODE XREF: sub_10016099+164j
		push	esi		; unsigned int
		mov	[edi+0A8h], eax
		mov	[edi+0ACh], eax
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10016222
		push	edi
		mov	ecx, eax
		call	sub_1001364A
		jmp	short loc_10016224
; ---------------------------------------------------------------------------

loc_10016222:				; CODE XREF: sub_10016099+17Dj
		mov	eax, ebx

loc_10016224:				; CODE XREF: sub_10016099+187j
		push	esi		; unsigned int
		mov	[edi+0B0h], eax
		mov	[edi+0B4h], eax
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10016245
		push	edi
		mov	ecx, eax
		call	sub_1000E5E8
		jmp	short loc_10016247
; ---------------------------------------------------------------------------

loc_10016245:				; CODE XREF: sub_10016099+1A0j
		mov	eax, ebx

loc_10016247:				; CODE XREF: sub_10016099+1AAj
		push	esi		; unsigned int
		mov	[edi+0B8h], eax
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10016262
		push	edi
		mov	ecx, eax
		call	sub_10011F6E
		mov	ebx, eax

loc_10016262:				; CODE XREF: sub_10016099+1BDj
		mov	[edi+0BCh], ebx
		mov	eax, edi
		mov	[edi+0C0h], ebx
		mov	[edi+0C4h], ebx
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10016099	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001627A	proc near		; CODE XREF: sub_100163B5+3p
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		lea	ebp, [edi+2Ch]
		mov	dword ptr [edi], offset	off_1001E0D8
		mov	eax, [ebp+0]
		mov	dword ptr [edi+10h], offset off_1001E0E4
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_100162B6
		push	ebx

loc_10016299:				; CODE XREF: sub_1001627A+39j
		mov	ebx, [esi+8]
		test	ebx, ebx
		jz	short loc_100162AE
		mov	ecx, ebx
		call	sub_1001944D
		push	ebx		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_100162AE:				; CODE XREF: sub_1001627A+24j
		mov	esi, [esi]
		cmp	esi, [ebp+0]
		jnz	short loc_10016299
		pop	ebx

loc_100162B6:				; CODE XREF: sub_1001627A+1Cj
		mov	ecx, [edi+7Ch]
		xor	esi, esi
		inc	esi
		test	ecx, ecx
		jz	short loc_100162C6
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_100162C6:				; CODE XREF: sub_1001627A+44j
		mov	ecx, [edi+90h]
		test	ecx, ecx
		jz	short loc_100162D6
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_100162D6:				; CODE XREF: sub_1001627A+54j
		mov	ecx, [edi+94h]
		test	ecx, ecx
		jz	short loc_100162E6
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_100162E6:				; CODE XREF: sub_1001627A+64j
		mov	ecx, [edi+0A8h]
		test	ecx, ecx
		jz	short loc_100162F6
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_100162F6:				; CODE XREF: sub_1001627A+74j
		mov	ecx, [edi+0B0h]
		test	ecx, ecx
		jz	short loc_10016306
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10016306:				; CODE XREF: sub_1001627A+84j
		mov	ecx, [edi+0B8h]
		test	ecx, ecx
		jz	short loc_10016316
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10016316:				; CODE XREF: sub_1001627A+94j
		mov	esi, [edi+0C8h]
		test	esi, esi
		jz	short loc_1001632E
		mov	ecx, esi
		call	sub_100110CD
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1001632E:				; CODE XREF: sub_1001627A+A4j
		push	dword ptr [edi+0CCh] ; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		lea	eax, [edi+14h]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		lea	ecx, [edi+0F0h]
		cmp	dword ptr [ecx], 0
		jz	short loc_10016356
		push	dword ptr [ecx]	; void *
		call	sub_10016398

loc_10016356:				; CODE XREF: sub_1001627A+D3j
		lea	ecx, [edi+0E4h]
		call	sub_100040FD
		lea	ecx, [edi+0DCh]
		call	sub_1000CD78
		lea	ecx, [edi+0D0h]
		call	sub_100040FD
		mov	ecx, ebp
		call	sub_10011712
		push	dword ptr [ebp+0] ; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		mov	dword ptr [edi], offset	off_1001D0DC
		lea	ecx, [edi+4]
		pop	edi
		pop	esi
		pop	ebp
		jmp	unknown_libname_6 ; Microsoft VisualC 2-11/net runtime
sub_1001627A	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10016398(void *)
sub_10016398	proc near		; CODE XREF: sub_1001627A+D7p
					; sub_10016FEE+Dp

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jz	short locret_100163B2
		mov	ecx, [esp+arg_0]
		call	sub_10008446
		push	[esp+arg_0]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

locret_100163B2:			; CODE XREF: sub_10016398+5j
		retn	4
sub_10016398	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100163B5(void *, char)
sub_100163B5	proc near		; DATA XREF: .rdata:1001E0E0o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_1001627A
		test	[esp+4+arg_0], 1
		jz	short loc_100163CB
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_100163CB:				; CODE XREF: sub_100163B5+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_100163B5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100163D1(void *)
sub_100163D1	proc near		; DATA XREF: .rdata:1001E144o

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+var_1C]
		push	eax		; void *
		call	sub_10001E8D
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		lea	ecx, [esi+0C0h]
		call	sub_10003D92
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1
		mov	ecx, [ebp+var_4]
		xor	eax, eax
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100163D1	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001641E	proc near		; DATA XREF: .rdata:1001E148o
		add	ecx, 0CCh
		jmp	sub_1000CE06
sub_1001641E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016429	proc near		; DATA XREF: .rdata:off_1001E0E4o
		xor	eax, eax
		add	ecx, 24h
		inc	eax
		lock xadd [ecx], eax
		retn
sub_10016429	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10016434(int, int, void *)
sub_10016434	proc near		; DATA XREF: .rdata:1001E140o

var_B4		= byte ptr -0B4h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0B4h
		push	ebx
		push	esi
		push	[ebp+arg_8]	; void *
		xor	ebx, ebx
		add	ecx, 0FFFFFFF0h
		push	[ebp+arg_4]	; int
		mov	[ebp+var_4], ebx
		push	[ebp+arg_0]	; int
		call	sub_1001651A
		mov	esi, eax
		call	sub_100020FE
		cmp	eax, 2
		jg	loc_10016500
		test	esi, esi
		jz	loc_10016500
		push	2
		push	17Ch
		push	offset aCBuildsMoz2__2 ; "c:/builds/moz2_slave/tb-rel-c-esr38-w32"...
		lea	ecx, [ebp+var_B4]
		inc	ebx
		call	sub_10001EE3
		push	offset asc_1001E1D4 ; "'"
		push	[ebp+arg_8]	; void *
		add	eax, 8
		push	offset aPattern	; ", pattern = '"
		push	[ebp+arg_4]
		push	offset aSemantics ; ", semantics = "
		push	[ebp+arg_0]
		push	offset aSubsystem ; ", subsystem = "
		push	esi
		push	offset aError	; " error = "
		push	offset aFailedToAddSan ; "Failed to add	sandbox	rule."
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(int)
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(int)
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(int)
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx
		push	eax		; int
		call	sub_10002039
		pop	ecx
		pop	ecx
		push	eax
		call	sub_10001C6D
		pop	ecx
		pop	ecx

loc_10016500:				; CODE XREF: sub_10016434+2Bj
					; sub_10016434+33j
		test	bl, 1
		jz	short loc_10016510
		lea	ecx, [ebp+var_B4]
		call	sub_10002021

loc_10016510:				; CODE XREF: sub_10016434+CFj
		mov	eax, esi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10016434	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1001651A(int, int, void *)
sub_1001651A	proc near		; CODE XREF: sub_10016434+1Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		mov	esi, ecx
		cmp	dword ptr [esi+0CCh], 0
		jnz	short loc_1001655C
		call	sub_10016A31
		push	0Ch		; unsigned int
		mov	[esi+0CCh], eax
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10016554
		push	dword ptr [esi+0CCh]
		mov	ecx, eax
		call	sub_10016079
		jmp	short loc_10016556
; ---------------------------------------------------------------------------

loc_10016554:				; CODE XREF: sub_1001651A+29j
		xor	eax, eax

loc_10016556:				; CODE XREF: sub_1001651A+38j
		mov	[esi+0C8h], eax

loc_1001655C:				; CODE XREF: sub_1001651A+12j
		mov	eax, [ebp+arg_0]
		sub	eax, 0
		jz	loc_1001660B
		dec	eax
		jz	loc_100165F8
		dec	eax
		jz	short loc_100165D7
		dec	eax
		jz	short loc_100165C4
		dec	eax
		jz	short loc_100165B1
		dec	eax
		jz	short loc_1001659B
		dec	eax
		jz	short loc_10016585
		push	3
		jmp	loc_10016623
; ---------------------------------------------------------------------------

loc_10016585:				; CODE XREF: sub_1001651A+62j
		push	dword ptr [esi+0C8h]
		push	[ebp+arg_4]
		push	[ebp+arg_8]
		call	sub_10012052
		jmp	loc_1001663B
; ---------------------------------------------------------------------------

loc_1001659B:				; CODE XREF: sub_1001651A+5Fj
		push	dword ptr [esi+0C8h]
		push	[ebp+arg_4]
		push	[ebp+arg_8]
		call	sub_1000EA2B
		jmp	loc_1001663B
; ---------------------------------------------------------------------------

loc_100165B1:				; CODE XREF: sub_1001651A+5Cj
		push	dword ptr [esi+0C8h] ; int
		push	[ebp+arg_4]	; int
		push	[ebp+arg_8]	; void *
		call	sub_10018E8D
		jmp	short loc_1001663B
; ---------------------------------------------------------------------------

loc_100165C4:				; CODE XREF: sub_1001651A+59j
		push	dword ptr [esi+0C8h] ; int
		push	[ebp+arg_4]	; int
		push	[ebp+arg_8]	; void *
		call	sub_10014040
		jmp	short loc_1001663B
; ---------------------------------------------------------------------------

loc_100165D7:				; CODE XREF: sub_1001651A+56j
		push	3
		pop	eax
		cmp	[esi+38h], eax
		jge	short loc_100165E5
		cmp	[ebp+arg_4], 8
		jz	short loc_10016644

loc_100165E5:				; CODE XREF: sub_1001651A+C3j
		push	dword ptr [esi+0C8h]
		push	[ebp+arg_4]
		push	[ebp+arg_8]
		call	sub_1001338E
		jmp	short loc_1001663B
; ---------------------------------------------------------------------------

loc_100165F8:				; CODE XREF: sub_1001651A+4Fj
		push	dword ptr [esi+0C8h]
		push	[ebp+arg_4]
		push	[ebp+arg_8]
		call	sub_10010215
		jmp	short loc_1001663B
; ---------------------------------------------------------------------------

loc_1001660B:				; CODE XREF: sub_1001651A+48j
		cmp	byte ptr [esi+4Eh], 0
		jnz	short loc_1001662A
		push	dword ptr [esi+0C8h]
		call	sub_1000C531
		pop	ecx
		test	al, al
		jnz	short loc_10016626

loc_10016621:				; CODE XREF: sub_1001651A+126j
		push	2

loc_10016623:				; CODE XREF: sub_1001651A+66j
		pop	eax
		jmp	short loc_10016644
; ---------------------------------------------------------------------------

loc_10016626:				; CODE XREF: sub_1001651A+105j
		mov	byte ptr [esi+4Eh], 1

loc_1001662A:				; CODE XREF: sub_1001651A+F5j
		push	dword ptr [esi+0C8h] ; int
		push	[ebp+arg_4]	; int
		push	[ebp+arg_8]	; void *
		call	sub_1000BFCD

loc_1001663B:				; CODE XREF: sub_1001651A+7Cj
					; sub_1001651A+92j ...
		add	esp, 0Ch
		test	al, al
		jz	short loc_10016621
		xor	eax, eax

loc_10016644:				; CODE XREF: sub_1001651A+C9j
					; sub_1001651A+10Aj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1001651A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001664B	proc near		; CODE XREF: sub_100095AD+3D7p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+0CCh], 0
		jz	short loc_10016663
		mov	ecx, [edi+0C8h]
		call	sub_10011356

loc_10016663:				; CODE XREF: sub_1001664B+Bj
		push	dword ptr [edi+64h]
		mov	esi, [esp+0Ch+arg_0]
		push	dword ptr [edi+60h] ; int
		push	dword ptr [esi]	; hProcess
		call	sub_10011D32
		add	esp, 0Ch
		test	al, al
		jnz	short loc_10016682

loc_1001667B:				; CODE XREF: sub_1001664B+41j
					; sub_1001664B+51j ...
		xor	al, al
		jmp	loc_1001675C
; ---------------------------------------------------------------------------

loc_10016682:				; CODE XREF: sub_1001664B+2Ej
		push	esi
		mov	ecx, edi
		call	sub_10016EB5
		test	al, al
		jz	short loc_1001667B
		push	esi
		lea	ecx, [edi+0DCh]
		call	sub_1000D0F8
		test	al, al
		jz	short loc_1001667B
		push	0E000h		; size_t
		push	2000h		; TargetHandle
		push	dword ptr [edi+0CCh] ; void *
		mov	ecx, esi
		push	edi		; int
		call	sub_10019774
		test	eax, eax
		jnz	short loc_1001667B
		mov	eax, [edi+5Ch]
		mov	ecx, esi
		push	4		; nSize
		push	offset g_shared_delayed_integrity_level	; lpBuffer
		push	offset aG_shared_del_1 ; "g_shared_delayed_integrity_level"
		mov	g_shared_delayed_integrity_level, eax
		call	sub_100198FB
		mov	g_shared_delayed_integrity_level, 7
		test	eax, eax
		jnz	short loc_1001667B
		push	dword ptr [edi+64h]
		push	dword ptr [edi+60h]
		call	sub_10011F37
		or	edx, [edi+6Ch]
		or	eax, [edi+68h]
		push	edx
		push	eax
		mov	g_shared_delayed_mitigations, eax
		mov	dword_10033DEC,	edx
		call	sub_10011DDE
		add	esp, 10h
		test	al, al
		jz	loc_1001667B
		push	8		; nSize
		push	offset g_shared_delayed_mitigations ; lpBuffer
		push	offset aG_shared_del_2 ; "g_shared_delayed_mitigations"
		mov	ecx, esi
		call	sub_100198FB
		and	g_shared_delayed_mitigations, 0
		and	dword_10033DEC,	0
		test	eax, eax
		jnz	loc_1001667B
		lea	esi, [edi+14h]
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		lea	eax, [esp+8+arg_0]
		lea	ecx, [edi+2Ch]
		push	eax
		push	dword ptr [ecx]
		call	sub_10010C9A
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	al, 1

loc_1001675C:				; CODE XREF: sub_1001664B+32j
		pop	edi
		pop	esi
		retn	4
sub_1001664B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016761	proc near		; DATA XREF: .rdata:1001E108o

var_24		= dword	ptr -24h
var_1D		= byte ptr -1Dh
var_1C		= dword	ptr -1Ch
var_4		= dword	ptr -4
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		xor	ebx, ebx
		mov	[ebp+var_24], ebx
		cmp	[ebp+arg_0], bl
		jz	loc_10016861
		cmp	hWinSta, ebx
		jnz	short loc_10016798
		cmp	handle,	ebx
		jz	short loc_100167A4

loc_10016790:				; CODE XREF: sub_10016761+106j
		push	3

loc_10016792:				; CODE XREF: sub_10016761+98j
		pop	eax
		jmp	loc_10016850
; ---------------------------------------------------------------------------

loc_10016798:				; CODE XREF: sub_10016761+25j
		cmp	handle,	ebx
		jnz	loc_1001684E

loc_100167A4:				; CODE XREF: sub_10016761+2Dj
		push	offset hWinSta
		call	sub_1001A8A9
		pop	ecx
		test	eax, eax
		jnz	loc_10016850
		mov	eax, hWinSta
		test	eax, eax
		jz	short loc_100167D9
		push	2
		pop	ebx
		push	eax		; hObj
		lea	eax, [ebp+var_1C]
		push	eax		; int
		call	sub_1001A9FC
		pop	ecx
		pop	ecx
		mov	[ebp+var_1D], 0
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_100167DD

loc_100167D9:				; CODE XREF: sub_10016761+5Dj
		mov	[ebp+var_1D], 1

loc_100167DD:				; CODE XREF: sub_10016761+76j
		test	bl, 2
		jz	short loc_100167F1
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		and	ebx, 0FFFFFFFDh
		call	sub_100022C1

loc_100167F1:				; CODE XREF: sub_10016761+7Fj
		cmp	[ebp+var_1D], 0
		jz	short loc_100167FB

loc_100167F7:				; CODE XREF: sub_10016761+EBj
		push	0Bh
		jmp	short loc_10016792
; ---------------------------------------------------------------------------

loc_100167FB:				; CODE XREF: sub_10016761+94j
		push	offset handle	; int
		push	hWinSta		; hWinSta
		call	sub_1001A759
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10016850
		mov	eax, handle
		test	eax, eax
		jz	short loc_10016833
		push	eax		; hObj
		lea	eax, [ebp+var_1C]
		or	ebx, 4
		push	eax		; int
		call	sub_1001A9FC
		pop	ecx
		pop	ecx
		mov	[ebp+var_1D], 0
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_10016837

loc_10016833:				; CODE XREF: sub_10016761+B7j
		mov	[ebp+var_1D], 1

loc_10016837:				; CODE XREF: sub_10016761+D0j
		test	bl, 4

loc_1001683A:				; CODE XREF: sub_10016761+14Fj
		jz	short loc_10016848
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1

loc_10016848:				; CODE XREF: sub_10016761:loc_1001683Aj
		cmp	[ebp+var_1D], 0
		jnz	short loc_100167F7

loc_1001684E:				; CODE XREF: sub_10016761+3Dj
					; sub_10016761+112j
		xor	eax, eax

loc_10016850:				; CODE XREF: sub_10016761+32j
					; sub_10016761+50j ...
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------

loc_10016861:				; CODE XREF: sub_10016761+19j
		cmp	hWinSta, ebx
		jnz	loc_10016790
		cmp	handle,	ebx
		jnz	short loc_1001684E
		push	offset handle	; int
		push	0		; hWinSta
		call	sub_1001A759
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10016850
		mov	eax, handle
		test	eax, eax
		jz	short loc_100168A9
		push	8
		pop	ebx
		push	eax		; hObj
		lea	eax, [ebp+var_1C]
		push	eax		; int
		call	sub_1001A9FC
		pop	ecx
		pop	ecx
		mov	[ebp+var_1D], 0
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_100168AD

loc_100168A9:				; CODE XREF: sub_10016761+12Dj
		mov	[ebp+var_1D], 1

loc_100168AD:				; CODE XREF: sub_10016761+146j
		test	bl, 8
		jmp	short loc_1001683A
sub_10016761	endp


; =============== S U B	R O U T	I N E =======================================


sub_100168B2	proc near		; DATA XREF: .rdata:1001E10Co
		mov	eax, handle
		test	eax, eax
		jz	short loc_100168C9
		push	eax		; hDesktop
		call	ds:CloseDesktop
		and	handle,	0

loc_100168C9:				; CODE XREF: sub_100168B2+7j
		mov	eax, hWinSta
		test	eax, eax
		jz	short locret_100168E0
		push	eax		; hWinSta
		call	ds:CloseWindowStation
		and	hWinSta, 0

locret_100168E0:			; CODE XREF: sub_100168B2+1Ej
		retn
sub_100168B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100168E1	proc near		; CODE XREF: sub_1000A7BC+86p
					; sub_1000A8A5+86p ...

var_10		= byte ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		and	[ebp+var_4], 0
		mov	ecx, [ecx+0CCh]
		push	esi
		test	ecx, ecx
		jz	short loc_1001694B
		mov	eax, [ebp+arg_0]
		mov	edx, [ecx+eax*4]
		test	edx, edx
		jz	short loc_1001694B
		mov	esi, [ebp+arg_4]
		xor	eax, eax
		cmp	[esi], eax
		jle	short loc_10016919
		lea	ecx, [esi+4]

loc_1001690C:				; CODE XREF: sub_100168E1+36j
		cmp	dword ptr [ecx], 0
		jz	short loc_10016947
		inc	eax
		add	ecx, 8
		cmp	eax, [esi]
		jl	short loc_1001690C

loc_10016919:				; CODE XREF: sub_100168E1+26j
		push	1
		push	0
		lea	ecx, [ebp+var_10]
		mov	[ebp+var_8], edx
		call	sub_10010BB4
		push	dword ptr [esi]
		lea	eax, [esi+4]
		push	eax
		push	2
		lea	ecx, [ebp+var_10]
		call	sub_10010AC9
		cmp	eax, 1
		jnz	short loc_1001694B
		lea	ecx, [ebp+var_10]
		call	sub_10010BB0
		jmp	short loc_1001694E
; ---------------------------------------------------------------------------

loc_10016947:				; CODE XREF: sub_100168E1+2Ej
		push	9
		jmp	short loc_1001694D
; ---------------------------------------------------------------------------

loc_1001694B:				; CODE XREF: sub_100168E1+13j
					; sub_100168E1+1Dj ...
		push	4

loc_1001694D:				; CODE XREF: sub_100168E1+68j
		pop	eax

loc_1001694E:				; CODE XREF: sub_100168E1+64j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_100168E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016955	proc near		; DATA XREF: .rdata:1001E104o

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	al, [ecx+3Ch]
		test	al, al
		jnz	short loc_1001697B
		cmp	[ecx+3Dh], al
		jnz	short loc_10016979

loc_10016964:				; CODE XREF: sub_10016955+2Fj
					; sub_10016955+3Fj ...
		mov	eax, [ebp+arg_0]
		and	dword ptr [eax+10h], 0
		xor	ecx, ecx
		mov	dword ptr [eax+14h], 7
		mov	[eax], cx
		jmp	short loc_100169AA
; ---------------------------------------------------------------------------

loc_10016979:				; CODE XREF: sub_10016955+Dj
		test	al, al

loc_1001697B:				; CODE XREF: sub_10016955+8j
		mov	eax, handle
		jz	short loc_10016986
		test	eax, eax
		jz	short loc_10016964

loc_10016986:				; CODE XREF: sub_10016955+2Bj
		cmp	byte ptr [ecx+3Dh], 0
		mov	ecx, hWinSta
		jz	short loc_1001699A
		test	eax, eax
		jz	short loc_10016964
		test	ecx, ecx
		jz	short loc_10016964

loc_1001699A:				; CODE XREF: sub_10016955+3Bj
		push	eax		; HANDLE
		push	ecx		; hObj
		push	[ebp+arg_0]	; int
		call	sub_1001A906
		mov	eax, [ebp+arg_0]
		add	esp, 0Ch

loc_100169AA:				; CODE XREF: sub_10016955+22j
		pop	ebp
		retn	4
sub_10016955	endp


; =============== S U B	R O U T	I N E =======================================


sub_100169AE	proc near		; CODE XREF: sub_1000954A+4p
					; sub_100095AD+1FDp
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+0F0h]	; this
		test	ecx, ecx
		jz	short loc_100169CC
		call	?_Has_container@_Iterator_base_secure@std@@QBE_NXZ ; std::_Iterator_base_secure::_Has_container(void)
		test	al, al
		jz	short loc_100169CC
		mov	eax, [esi+0F0h]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100169CC:				; CODE XREF: sub_100169AE+Bj
					; sub_100169AE+14j
		xor	eax, eax
		pop	esi
		retn
sub_100169AE	endp


; =============== S U B	R O U T	I N E =======================================


sub_100169D0	proc near		; DATA XREF: .rdata:1001E130o
		mov	eax, [ecx+58h]
		mov	edx, [ecx+5Ch]
		retn
sub_100169D0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100169D7	proc near		; CODE XREF: sub_10016BEB+31p
					; sub_10016F84+17p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		lea	edx, [eax-1]
		cmp	edx, 14h
		ja	short loc_100169E9
		mov	eax, [ecx+eax*4+70h]
		jmp	short locret_100169EB
; ---------------------------------------------------------------------------

loc_100169E9:				; CODE XREF: sub_100169D7+Aj
		xor	eax, eax

locret_100169EB:			; CODE XREF: sub_100169D7+10j
		retn	4
sub_100169D7	endp


; =============== S U B	R O U T	I N E =======================================


sub_100169EE	proc near		; DATA XREF: .rdata:1001E0F0o
		mov	eax, [ecx+2Ch]
		retn
sub_100169EE	endp


; =============== S U B	R O U T	I N E =======================================


sub_100169F2	proc near		; DATA XREF: .rdata:1001E114o
		mov	eax, [ecx+48h]
		retn
sub_100169F2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100169F6	proc near		; DATA XREF: .rdata:1001E0F4o
		mov	eax, [ecx+28h]
		retn
sub_100169F6	endp


; =============== S U B	R O U T	I N E =======================================


sub_100169FA	proc near		; DATA XREF: .rdata:1001E128o
		mov	eax, [ecx+50h]
		mov	edx, [ecx+54h]
		retn
sub_100169FA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016A01	proc near		; CODE XREF: sub_100095AD+23Ep
					; sub_100095AD+340p
		mov	eax, [ecx+54h]
		retn
sub_10016A01	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016A05	proc near		; CODE XREF: sub_100095AD+233p
					; sub_100095AD+332p
		mov	eax, [ecx+50h]
		retn
sub_10016A05	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10016A09(HANDLE hFile)
sub_10016A09	proc near		; CODE XREF: sub_10016E50+9p
					; sub_10016E72+9p

hFile		= dword	ptr  4

		mov	eax, [esp+hFile]
		test	eax, eax
		jnz	short loc_10016A14

loc_10016A11:				; CODE XREF: sub_10016A09+Ej
		xor	al, al
		retn
; ---------------------------------------------------------------------------

loc_10016A14:				; CODE XREF: sub_10016A09+6j
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10016A11
		push	eax		; hFile
		call	ds:GetFileType
		mov	ecx, eax
		xor	eax, eax
		inc	eax
		cmp	ecx, eax
		jz	short locret_10016A30
		cmp	ecx, 3
		jz	short locret_10016A30
		xor	eax, eax

locret_10016A30:			; CODE XREF: sub_10016A09+1Ej
					; sub_10016A09+23j
		retn
sub_10016A09	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016A31	proc near		; CODE XREF: sub_1001651A+14p

var_4		= dword	ptr -4

		push	ecx
		and	[esp+4+var_4], 0
		push	esi
		push	edi
		mov	edi, 0E000h
		push	edi		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		push	edi		; size_t
		mov	esi, eax
		push	0		; int
		push	esi		; void *
		call	memset
		add	esp, 10h
		mov	dword ptr [esi+80h], 0DF60h
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_10016A31	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016A61	proc near		; CODE XREF: sub_100095AD+188p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	dword ptr [ecx+40h], 5
		jz	short loc_10016AA7
		push	dword ptr [ecx+48h] ; int
		and	[ebp+var_4], 0
		push	dword ptr [ecx+44h] ; int
		push	0		; lpName
		push	dword ptr [ecx+40h] ; int
		lea	ecx, [ebp+var_4]
		call	sub_1000FC06
		lea	ecx, [ebp+var_4] ; this
		test	eax, eax
		jz	short loc_10016A93
		call	??1InitialThreadParam@UMSFreeVirtualProcessorRoot@details@Concurrency@@QAE@XZ ;	Concurrency::details::UMSFreeVirtualProcessorRoot::InitialThreadParam::~InitialThreadParam(void)
		xor	eax, eax
		inc	eax
		jmp	short loc_10016AAF
; ---------------------------------------------------------------------------

loc_10016A93:				; CODE XREF: sub_10016A61+26j
		call	sub_1000FC00
		mov	ecx, [ebp+arg_0]
		mov	[ecx], eax
		lea	ecx, [ebp+var_4] ; this
		call	??1InitialThreadParam@UMSFreeVirtualProcessorRoot@details@Concurrency@@QAE@XZ ;	Concurrency::details::UMSFreeVirtualProcessorRoot::InitialThreadParam::~InitialThreadParam(void)
		jmp	short loc_10016AAD
; ---------------------------------------------------------------------------

loc_10016AA7:				; CODE XREF: sub_10016A61+8j
		mov	eax, [ebp+arg_0]
		and	dword ptr [eax], 0

loc_10016AAD:				; CODE XREF: sub_10016A61+44j
		xor	eax, eax

loc_10016AAF:				; CODE XREF: sub_10016A61+30j
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10016A61	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10016AB5(LPHANDLE, LPHANDLE	lpTargetHandle)
sub_10016AB5	proc near		; CODE XREF: sub_100095AD+D9p
					; sub_100095AD+14Ep

arg_0		= dword	ptr  4
lpTargetHandle	= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+lpTargetHandle]
		mov	esi, ecx
		push	1		; int
		push	dword ptr [esi+58h] ; int
		push	dword ptr [esi+38h] ; int
		push	edi		; lpTargetHandle
		call	sub_1001514D
		add	esp, 10h
		test	eax, eax
		jz	short loc_10016AD7

loc_10016AD2:				; CODE XREF: sub_10016AB5+6Bj
					; sub_10016AB5+C8j
		xor	eax, eax
		inc	eax
		jmp	short loc_10016B53
; ---------------------------------------------------------------------------

loc_10016AD7:				; CODE XREF: sub_10016AB5+1Bj
		cmp	handle,	0
		jz	short loc_10016B2A
		cmp	byte ptr [esi+4Ch], 0
		jz	short loc_10016B2A
		mov	eax, [esi+58h]
		cmp	eax, 7
		jz	short loc_10016B2A
		cmp	dword_10033DB4,	eax
		jge	short loc_10016B2A
		call	sub_10006EA9
		cmp	dword ptr [eax], 3
		jl	short loc_10016B2A
		push	dword ptr [esi+58h]
		call	sub_100155B9
		push	eax		; void *
		push	offset SubKey	; void *
		push	7		; ObjectType
		push	handle		; handle
		call	sub_10015629
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10016AD2
		mov	eax, [esi+58h]
		mov	dword_10033DB4,	eax

loc_10016B2A:				; CODE XREF: sub_10016AB5+29j
					; sub_10016AB5+2Fj ...
		mov	ecx, [esi+0F0h]	; this
		test	ecx, ecx
		jz	short loc_10016B5D
		call	?_Has_container@_Iterator_base_secure@std@@QBE_NXZ ; std::_Iterator_base_secure::_Has_container(void)
		test	al, al
		jz	short loc_10016B5D
		mov	eax, [esi+38h]
		cmp	eax, 2
		jl	short loc_10016B58
		cmp	eax, [esi+3Ch]
		jnz	short loc_10016B58
		mov	eax, [esp+8+arg_0]
		or	dword ptr [eax], 0FFFFFFFFh

loc_10016B51:				; CODE XREF: sub_10016AB5+BEj
		xor	eax, eax

loc_10016B53:				; CODE XREF: sub_10016AB5+20j
					; sub_10016AB5+A6j
		pop	edi
		pop	esi
		retn	8
; ---------------------------------------------------------------------------

loc_10016B58:				; CODE XREF: sub_10016AB5+8Ej
					; sub_10016AB5+93j
		push	10h
		pop	eax
		jmp	short loc_10016B53
; ---------------------------------------------------------------------------

loc_10016B5D:				; CODE XREF: sub_10016AB5+7Dj
					; sub_10016AB5+86j
		push	0		; int
		push	dword ptr [esi+58h] ; int
		push	dword ptr [esi+3Ch] ; int
		push	[esp+14h+arg_0]	; lpTargetHandle
		call	sub_1001514D
		add	esp, 10h
		test	eax, eax
		jz	short loc_10016B51
		push	dword ptr [edi]	; hObject
		call	ds:CloseHandle
		jmp	loc_10016AD2
sub_10016AB5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016B82	proc near		; CODE XREF: sub_1000934F+29p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		lea	edi, [esi+14h]
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		lea	ebx, [esi+2Ch]
		mov	edx, [ebx]
		mov	eax, [edx]
		cmp	eax, edx
		jz	short loc_10016BB4
		mov	esi, [ebp+arg_0]

loc_10016BA2:				; CODE XREF: sub_10016B82+2Cj
		mov	ecx, [eax+8]
		cmp	[ecx+1Ch], esi
		jz	short loc_10016BB0
		mov	eax, [eax]
		cmp	eax, edx
		jnz	short loc_10016BA2

loc_10016BB0:				; CODE XREF: sub_10016B82+26j
		cmp	eax, edx
		jnz	short loc_10016BB8

loc_10016BB4:				; CODE XREF: sub_10016B82+1Bj
		xor	bl, bl
		jmp	short loc_10016BDB
; ---------------------------------------------------------------------------

loc_10016BB8:				; CODE XREF: sub_10016B82+30j
		mov	esi, [eax+8]
		mov	ecx, ebx
		push	eax		; void *
		lea	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_10019CD3
		test	esi, esi
		jz	short loc_10016BD9
		mov	ecx, esi
		call	sub_1001944D
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10016BD9:				; CODE XREF: sub_10016B82+47j
		mov	bl, 1

loc_10016BDB:				; CODE XREF: sub_10016B82+34j
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		mov	al, bl
		pop	ebx
		pop	ebp
		retn	4
sub_10016B82	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016BEB	proc near		; DATA XREF: .rdata:off_1001E0D8o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		mov	edi, ecx
		mov	ecx, offset dword_1001E230
		push	esi
		call	sub_1000A564
		test	al, al
		jnz	short loc_10016C31
		push	esi
		mov	ecx, offset dword_1001E258
		call	sub_1000A564
		test	al, al
		jnz	short loc_10016C31
		push	dword ptr [esi]
		mov	ecx, edi
		call	sub_100169D7
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_10016C3C
		push	[ebp+arg_4]
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax]
		jmp	short loc_10016C3C
; ---------------------------------------------------------------------------

loc_10016C31:				; CODE XREF: sub_10016BEB+1Cj
					; sub_10016BEB+2Bj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], offset	sub_10016C44
		mov	eax, edi

loc_10016C3C:				; CODE XREF: sub_10016BEB+3Aj
					; sub_10016BEB+44j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10016BEB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016C44	proc near		; DATA XREF: sub_10016BEB+49o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi]
		dec	eax
		jz	short loc_10016C68
		dec	eax
		jnz	short loc_10016C5A
		mov	ecx, [esp+4+arg_4]
		cmp	dword ptr [ecx], 4
		jz	short loc_10016C5E

loc_10016C5A:				; CODE XREF: sub_10016C44+Bj
		xor	al, al
		jmp	short loc_10016C83
; ---------------------------------------------------------------------------

loc_10016C5E:				; CODE XREF: sub_10016C44+14j
		mov	ecx, [ecx+4]
		imul	eax, [ecx], 3
		mov	[ecx], eax
		jmp	short loc_10016C81
; ---------------------------------------------------------------------------

loc_10016C68:				; CODE XREF: sub_10016C44+8j
		mov	dword ptr [esi+14h], 2
		call	ds:GetTickCount
		mov	[esi+1Ch], eax
		mov	eax, [esp+4+arg_4]
		add	eax, eax
		mov	[esi+20h], eax

loc_10016C81:				; CODE XREF: sub_10016C44+22j
		mov	al, 1

loc_10016C83:				; CODE XREF: sub_10016C44+18j
		pop	esi
		retn	8
sub_10016C44	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016C87	proc near		; DATA XREF: .rdata:1001E0E8o
		lea	eax, [ecx+24h]
		or	edx, 0FFFFFFFFh
		lock xadd [eax], edx
		jnz	short locret_10016C9F
		add	ecx, 0FFFFFFF0h
		jz	short locret_10016C9F
		mov	eax, [ecx]
		push	1
		call	dword ptr [eax+8]

locret_10016C9F:			; CODE XREF: sub_10016C87+Aj
					; sub_10016C87+Fj
		retn
sub_10016C87	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016CA0	proc near		; DATA XREF: .rdata:1001E100o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	edx, [ecx]
		push	eax
		mov	byte ptr [ecx+3Ch], 1
		mov	[ecx+3Dh], al
		call	dword ptr [edx+24h]
		retn	4
sub_10016CA0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10016CB4(void *)
sub_10016CB4	proc near		; DATA XREF: .rdata:1001E11Co

var_20		= dword	ptr -20h
StringSid	= word ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+var_20], 0
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	edi
		mov	edi, ecx
		call	sub_10006EA9
		cmp	dword ptr [eax], 5
		jge	short loc_10016CDD
		xor	eax, eax
		jmp	short loc_10016D41
; ---------------------------------------------------------------------------

loc_10016CDD:				; CODE XREF: sub_10016CB4+23j
		mov	eax, [edi+28h]
		cmp	eax, 2
		jl	short loc_10016D3E
		cmp	eax, [edi+2Ch]
		jnz	short loc_10016D3E
		push	1Ch		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10016CFF
		mov	ecx, eax
		call	sub_10008430
		jmp	short loc_10016D01
; ---------------------------------------------------------------------------

loc_10016CFF:				; CODE XREF: sub_10016CB4+40j
		xor	eax, eax

loc_10016D01:				; CODE XREF: sub_10016CB4+49j
		push	esi
		lea	esi, [edi+0E0h]
		push	eax
		mov	ecx, esi
		call	sub_10016FEE
		push	ebx		; void *
		lea	ecx, [ebp+StringSid]
		call	sub_10001E8D
		mov	ecx, [esi]
		lea	eax, [edi+0D4h]
		push	eax		; int
		lea	eax, [ebp+StringSid]
		push	eax		; StringSid
		call	sub_10008664
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+StringSid] ; void *
		mov	esi, eax
		call	sub_100022C1
		mov	eax, esi
		pop	esi
		jmp	short loc_10016D41
; ---------------------------------------------------------------------------

loc_10016D3E:				; CODE XREF: sub_10016CB4+2Fj
					; sub_10016CB4+34j
		push	10h
		pop	eax

loc_10016D41:				; CODE XREF: sub_10016CB4+27j
					; sub_10016CB4+88j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10016CB4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10016D53(void *)
sub_10016D53	proc near		; DATA XREF: .rdata:1001E120o

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+var_1C]
		push	eax		; void *
		call	sub_10001E8D
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		lea	ecx, [esi+0D4h]
		call	sub_10003D92
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1
		mov	ecx, [ebp+var_4]
		xor	eax, eax
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10016D53	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016DA0	proc near		; DATA XREF: .rdata:1001E118o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	[ecx+4Ch], eax
		xor	eax, eax
		retn	4
sub_10016DA0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016DAC	proc near		; DATA XREF: .rdata:1001E12Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_4]
		mov	ebx, ecx
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		push	esi
		push	edi
		call	sub_10011DDE
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10016DCB
		push	2
		pop	eax
		jmp	short loc_10016DD3
; ---------------------------------------------------------------------------

loc_10016DCB:				; CODE XREF: sub_10016DAC+18j
		mov	[ebx+58h], edi
		xor	eax, eax
		mov	[ebx+5Ch], esi

loc_10016DD3:				; CODE XREF: sub_10016DAC+1Dj
		pop	edi
		pop	esi
		pop	ebx
		retn	8
sub_10016DAC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016DD9	proc near		; DATA XREF: .rdata:1001E110o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	[ecx+48h], eax
		xor	eax, eax
		retn	4
sub_10016DD9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016DE5	proc near		; DATA XREF: .rdata:1001E0F8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword ptr [ecx+38h], 0
		mov	eax, [esp+arg_0]
		jz	short loc_10016DF9
		cmp	eax, 5
		jnz	short loc_10016DF9
		push	2
		pop	eax
		jmp	short locret_10016E05
; ---------------------------------------------------------------------------

loc_10016DF9:				; CODE XREF: sub_10016DE5+8j
					; sub_10016DE5+Dj
		mov	[ecx+30h], eax
		mov	eax, [esp+arg_4]
		mov	[ecx+34h], eax
		xor	eax, eax

locret_10016E05:			; CODE XREF: sub_10016DE5+12j
		retn	8
sub_10016DE5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016E08	proc near		; DATA XREF: .rdata:1001E0FCo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_10016E1B
		cmp	dword ptr [ecx+30h], 5
		jnz	short loc_10016E1B
		push	2
		pop	eax
		jmp	short locret_10016E20
; ---------------------------------------------------------------------------

loc_10016E1B:				; CODE XREF: sub_10016E08+6j
					; sub_10016E08+Cj
		mov	[ecx+38h], eax
		xor	eax, eax

locret_10016E20:			; CODE XREF: sub_10016E08+11j
		retn	4
sub_10016E08	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016E23	proc near		; DATA XREF: .rdata:1001E124o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_4]
		mov	ebx, ecx
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		push	esi
		push	edi
		call	sub_10011DFA
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10016E42
		push	2
		pop	eax
		jmp	short loc_10016E4A
; ---------------------------------------------------------------------------

loc_10016E42:				; CODE XREF: sub_10016E23+18j
		mov	[ebx+50h], edi
		xor	eax, eax
		mov	[ebx+54h], esi

loc_10016E4A:				; CODE XREF: sub_10016E23+1Dj
		pop	edi
		pop	esi
		pop	ebx
		retn	8
sub_10016E23	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10016E50(HANDLE hFile)
sub_10016E50	proc near		; DATA XREF: .rdata:1001E13Co

hFile		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+hFile]
		push	edi
		push	esi		; hFile
		mov	edi, ecx
		call	sub_10016A09
		pop	ecx
		test	al, al
		jnz	short loc_10016E68
		push	2
		pop	eax
		jmp	short loc_10016E6D
; ---------------------------------------------------------------------------

loc_10016E68:				; CODE XREF: sub_10016E50+11j
		mov	[edi+44h], esi
		xor	eax, eax

loc_10016E6D:				; CODE XREF: sub_10016E50+16j
		pop	edi
		pop	esi
		retn	4
sub_10016E50	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10016E72(HANDLE hFile)
sub_10016E72	proc near		; DATA XREF: .rdata:1001E138o

hFile		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+hFile]
		push	edi
		push	esi		; hFile
		mov	edi, ecx
		call	sub_10016A09
		pop	ecx
		test	al, al
		jnz	short loc_10016E8A
		push	2
		pop	eax
		jmp	short loc_10016E8F
; ---------------------------------------------------------------------------

loc_10016E8A:				; CODE XREF: sub_10016E72+11j
		mov	[edi+40h], esi
		xor	eax, eax

loc_10016E8F:				; CODE XREF: sub_10016E72+16j
		pop	edi
		pop	esi
		retn	4
sub_10016E72	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016E94	proc near		; DATA XREF: .rdata:1001E134o
		mov	byte ptr [ecx+3Fh], 0
		retn
sub_10016E94	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016E99	proc near		; DATA XREF: .rdata:1001E0ECo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		cmp	eax, edx
		jge	short loc_10016EAA
		push	2
		pop	eax
		jmp	short locret_10016EB2
; ---------------------------------------------------------------------------

loc_10016EAA:				; CODE XREF: sub_10016E99+Aj
		mov	[ecx+2Ch], eax
		xor	eax, eax
		mov	[ecx+28h], edx

locret_10016EB2:			; CODE XREF: sub_10016E99+Fj
		retn	8
sub_10016E99	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016EB5	proc near		; CODE XREF: sub_1001664B+3Ap

var_14		= dword	ptr -14h
var_10		= byte ptr -10h
arg_0		= dword	ptr  4

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		lea	ecx, [esp+24h+var_10]
		movzx	eax, byte ptr [edi+4Fh]
		push	eax
		push	[esp+28h+arg_0]
		call	sub_1000EBED
		xor	ebx, ebx
		cmp	[edi+0CCh], ebx
		jz	short loc_10016F14
		push	0FFFFFF90h
		pop	ecx
		sub	ecx, edi
		lea	ebp, [edi+70h]
		mov	esi, ebx
		mov	[esp+24h+var_14], ecx

loc_10016EE8:				; CODE XREF: sub_10016EB5+5Dj
		mov	eax, [edi+0CCh]
		add	eax, ecx
		cmp	[eax+ebp], ebx
		jz	short loc_10016F0B
		mov	ecx, [ebp+0]
		lea	edx, [esp+24h+var_10]
		push	esi
		push	edx
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		test	al, al
		jz	short loc_10016F6F
		mov	ecx, [esp+24h+var_14]

loc_10016F0B:				; CODE XREF: sub_10016EB5+3Ej
		inc	esi
		add	ebp, 4
		cmp	esi, 16h
		jl	short loc_10016EE8

loc_10016F14:				; CODE XREF: sub_10016EB5+23j
		mov	eax, [edi+0D0h]
		cmp	eax, [edi+0D4h]
		jz	short loc_10016F47
		mov	esi, eax
		jmp	short loc_10016F3F
; ---------------------------------------------------------------------------

loc_10016F26:				; CODE XREF: sub_10016EB5+90j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10016F30
		mov	eax, [esi]
		jmp	short loc_10016F32
; ---------------------------------------------------------------------------

loc_10016F30:				; CODE XREF: sub_10016EB5+75j
		mov	eax, esi

loc_10016F32:				; CODE XREF: sub_10016EB5+79j
		push	eax		; void *
		lea	ecx, [esp+28h+var_10]
		call	sub_1000ED04
		add	esi, 18h

loc_10016F3F:				; CODE XREF: sub_10016EB5+6Fj
		cmp	esi, [edi+0D4h]
		jnz	short loc_10016F26

loc_10016F47:				; CODE XREF: sub_10016EB5+6Bj
		lea	eax, [esp+24h+var_10]
		push	eax
		call	sub_1001026A
		pop	ecx
		test	al, al
		jz	short loc_10016F6F
		lea	ecx, [esp+24h+var_10]
		call	sub_1000EF28
		test	al, al
		jz	short loc_10016F6F
		push	[esp+24h+arg_0]
		call	sub_100103AB
		pop	ecx
		mov	bl, al

loc_10016F6F:				; CODE XREF: sub_10016EB5+50j
					; sub_10016EB5+9Fj ...
		lea	ecx, [esp+24h+var_10]
		call	sub_1000EC48
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		add	esp, 14h
		retn	4
sub_10016EB5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016F84	proc near		; DATA XREF: .rdata:1001E0DCo

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		cmp	[ebp+arg_4], 1
		jz	short loc_10016FB7
		cmp	[ebp+arg_4], 2
		jz	short loc_10016FB7
		push	[ebp+arg_4]
		call	sub_100169D7
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10016FAA
		xor	al, al
		jmp	short loc_10016FB9
; ---------------------------------------------------------------------------

loc_10016FAA:				; CODE XREF: sub_10016F84+20j
		push	[ebp+arg_4]
		mov	eax, [ecx]
		push	[ebp+arg_0]
		call	dword ptr [eax+4]
		jmp	short loc_10016FB9
; ---------------------------------------------------------------------------

loc_10016FB7:				; CODE XREF: sub_10016F84+Cj
					; sub_10016F84+12j
		mov	al, 1

loc_10016FB9:				; CODE XREF: sub_10016F84+24j
					; sub_10016F84+31j
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10016F84	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016FBF	proc near		; CODE XREF: sub_10008F00+25p
					; sub_10010BF4+1Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0
		push	1
		call	sub_10016030
		pop	ecx
		pop	ecx
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_10016FD8
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_10016FDC
; ---------------------------------------------------------------------------

loc_10016FD8:				; CODE XREF: sub_10016FBF+11j
		mov	edx, [esp+arg_4]

loc_10016FDC:				; CODE XREF: sub_10016FBF+17j
		test	eax, eax
		jz	short loc_10016FE2
		mov	[eax], ecx

loc_10016FE2:				; CODE XREF: sub_10016FBF+1Fj
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_10016FEB
		mov	[ecx], edx

locret_10016FEB:			; CODE XREF: sub_10016FBF+28j
		retn	8
sub_10016FBF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016FEE	proc near		; CODE XREF: sub_10016CB4+57p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		and	dword ptr [esi], 0
		test	eax, eax
		jz	short loc_10017000
		push	eax		; void *
		call	sub_10016398

loc_10017000:				; CODE XREF: sub_10016FEE+Aj
		mov	eax, [esp+4+arg_0]
		mov	[esi], eax
		pop	esi
		retn	4
sub_10016FEE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001700A	proc near		; CODE XREF: sub_1000BE96+4Ap
					; sub_1000C300+48p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		mov	eax, dword_10033DC0
		test	eax, eax
		jnz	short loc_10017037
		push	offset aNtdll_dll_3 ; "ntdll.dll"
		call	ds:GetModuleHandleW
		push	offset aRtlinitunicode ; "RtlInitUnicodeString"
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	dword_10033DC0,	eax

loc_10017037:				; CODE XREF: sub_1001700A+Fj
		mov	ecx, [ebp+arg_0]
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_10017042
		mov	ecx, [ecx]

loc_10017042:				; CODE XREF: sub_1001700A+34j
		push	esi
		mov	esi, [ebp+arg_10]
		push	ecx
		push	esi
		call	eax ; dword_10033DC0
		mov	ecx, [ebp+arg_C]
		mov	eax, [ebp+arg_8]
		and	dword ptr [ecx+10h], 0
		and	dword ptr [ecx+14h], 0
		mov	[ecx+4], eax
		mov	eax, [ebp+arg_4]
		mov	[ecx+8], esi
		mov	dword ptr [ecx], 18h
		mov	[ecx+0Ch], eax
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001700A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001706F	proc near		; DATA XREF: .rdata:1001D5A4o
					; .rdata:1001D5CCo ...
		push	esi
		push	offset aNtdll_dll_5 ; "ntdll.dll"
		mov	esi, ecx
		call	ds:GetModuleHandleW
		mov	[esi+0Ch], eax
		pop	esi
		retn
sub_1001706F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017082	proc near		; DATA XREF: .rdata:1001D594o
					; .rdata:1001D5BCo ...
		mov	eax, [ecx]
		jmp	dword ptr [eax+0Ch]
sub_10017082	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017087	proc near		; DATA XREF: .rdata:1001D598o
					; .rdata:1001D5C0o ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_1001709A

loc_10017093:				; CODE XREF: sub_10017087+2Fj
		mov	eax, 0C0000001h
		jmp	short loc_100170BA
; ---------------------------------------------------------------------------

loc_1001709A:				; CODE XREF: sub_10017087+Aj
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001CAC8
		mov	[ebp+var_4], eax
		call	sub_10005D9A
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		test	eax, eax
		jz	short loc_10017093
		xor	eax, eax

loc_100170BA:				; CODE XREF: sub_10017087+11j
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10017087	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100170C0	proc near		; DATA XREF: .rdata:1001D5A8o
					; .rdata:1001D5D0o ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ecx
		push	edi
		mov	edx, [esi]
		lea	eax, [esi+4]
		push	eax
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword ptr [edx+0Ch]
		mov	edi, eax
		test	edi, edi
		js	short loc_10017122
		mov	eax, [esi]
		mov	ecx, esi
		push	ebx
		call	dword ptr [eax+10h]
		mov	ebx, eax
		cmp	[ebp+arg_C], ebx
		jb	short loc_1001710F
		mov	eax, [esi]
		mov	ecx, esi
		push	[ebp+arg_8]
		call	dword ptr [eax+20h]
		test	al, al
		jnz	short loc_10017116
		cmp	[esi+14h], al
		jz	short loc_1001710F
		push	[ebp+arg_8]
		mov	ecx, esi
		push	[ebp+arg_8]
		call	sub_100174AB
		test	al, al
		jnz	short loc_10017116

loc_1001710F:				; CODE XREF: sub_100170C0+29j
					; sub_100170C0+3Cj
		mov	eax, 0C0000001h
		jmp	short loc_10017121
; ---------------------------------------------------------------------------

loc_10017116:				; CODE XREF: sub_100170C0+37j
					; sub_100170C0+4Dj
		mov	eax, [ebp+arg_10]
		test	eax, eax
		jz	short loc_1001711F
		mov	[eax], ebx

loc_1001711F:				; CODE XREF: sub_100170C0+5Bj
		mov	eax, edi

loc_10017121:				; CODE XREF: sub_100170C0+54j
		pop	ebx

loc_10017122:				; CODE XREF: sub_100170C0+1Aj
		pop	edi
		pop	esi
		pop	ebp
		retn	14h
sub_100170C0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017128	proc near		; DATA XREF: .rdata:1001D59Co
					; .rdata:1001D5C4o ...
		call	sub_10014477
		add	eax, 18h
		retn
sub_10017128	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017131	proc near		; DATA XREF: .rdata:1001D5ACo

lpModuleName	= dword	ptr -24h
phModule	= dword	ptr -20h
var_1C		= dword	ptr -1Ch
NumberOfBytesRead= dword ptr -18h
Buffer		= byte ptr -14h
var_F		= byte ptr -0Fh
lpBaseAddress	= dword	ptr -0Eh
var_A		= word ptr -0Ah
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	esi
		push	edi
		mov	edi, ds:ReadProcessMemory
		mov	esi, ecx
		push	eax		; lpNumberOfBytesRead
		push	10h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [esi+4] ; lpBaseAddress
		push	dword ptr [esi+10h] ; hProcess
		call	edi ; ReadProcessMemory
		test	eax, eax
		jz	loc_10017201
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	loc_10017201
		cmp	[ebp+Buffer], 0B8h
		jnz	loc_10017201
		cmp	[ebp+var_F], 0BAh
		jnz	short loc_10017201
		mov	eax, 12FFh
		mov	ecx, 0D2FFh
		cmp	ax, [ebp+var_A]
		jz	short loc_10017199
		cmp	cx, [ebp+var_A]
		jnz	short loc_10017201

loc_10017199:				; CODE XREF: sub_10017131+60j
		cmp	[ebp+var_8], 0C2h
		jnz	short loc_10017201
		cmp	cx, [ebp+var_A]
		jz	short loc_100171F4
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	4		; nSize
		lea	eax, [ebp+lpModuleName]
		push	eax		; lpBuffer
		push	[ebp+lpBaseAddress] ; lpBaseAddress
		push	dword ptr [esi+10h] ; hProcess
		call	edi ; ReadProcessMemory
		test	eax, eax
		jz	short loc_10017201
		cmp	[ebp+NumberOfBytesRead], 4
		jnz	short loc_10017201
		mov	edi, ds:GetModuleHandleExW
		lea	eax, [ebp+phModule]
		push	eax		; phModule
		push	[ebp+lpModuleName] ; lpModuleName
		push	6		; dwFlags
		call	edi ; GetModuleHandleExW
		test	eax, eax
		jz	short loc_10017201
		mov	eax, [esi+0Ch]
		test	eax, eax
		jnz	short loc_100171EF
		lea	eax, [ebp+var_1C]
		push	eax		; phModule
		push	dword ptr [esi+4] ; lpModuleName
		push	6		; dwFlags
		call	edi ; GetModuleHandleExW
		test	eax, eax
		jz	short loc_10017201
		mov	eax, [ebp+var_1C]

loc_100171EF:				; CODE XREF: sub_10017131+AAj
		cmp	[ebp+phModule],	eax
		jnz	short loc_10017201

loc_100171F4:				; CODE XREF: sub_10017131+72j
		mov	edi, ebx
		lea	esi, [ebp+Buffer]
		mov	al, 1
		movsd
		movsd
		movsd
		movsd
		jmp	short loc_10017203
; ---------------------------------------------------------------------------

loc_10017201:				; CODE XREF: sub_10017131+32j
					; sub_10017131+3Cj ...
		xor	al, al

loc_10017203:				; CODE XREF: sub_10017131+CEj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10017131	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017216	proc near		; DATA XREF: .rdata:1001D624o

NumberOfBytesRead= dword ptr -1Ch
Buffer		= byte ptr -18h
var_13		= byte ptr -13h
var_12		= dword	ptr -12h
var_E		= byte ptr -0Eh
var_B		= word ptr -0Bh
var_9		= word ptr -9
var_7		= byte ptr -7
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	14h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [ecx+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_1001728C
		cmp	[ebp+NumberOfBytesRead], 14h
		jnz	short loc_1001728C
		cmp	[ebp+Buffer], 0B8h
		jnz	short loc_1001728C
		cmp	[ebp+var_13], 0E8h
		jnz	short loc_1001728C
		cmp	[ebp+var_12], 3
		jnz	short loc_1001728C
		cmp	[ebp+var_E], 0C2h
		jnz	short loc_1001728C
		mov	eax, 0D48Bh
		cmp	ax, [ebp+var_B]
		jnz	short loc_1001728C
		mov	eax, 340Fh
		cmp	ax, [ebp+var_9]
		jnz	short loc_1001728C
		cmp	[ebp+var_7], 0C3h
		jnz	short loc_1001728C
		push	esi
		push	5
		pop	ecx
		lea	esi, [ebp+Buffer]
		mov	al, 1
		rep movsd
		pop	esi
		jmp	short loc_1001728E
; ---------------------------------------------------------------------------

loc_1001728C:				; CODE XREF: sub_10017216+2Cj
					; sub_10017216+32j ...
		xor	al, al

loc_1001728E:				; CODE XREF: sub_10017216+74j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10017216	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001729F	proc near		; DATA XREF: .rdata:1001D5D4o

NumberOfBytesRead= dword ptr -20h
Buffer		= byte ptr -1Ch
var_17		= word ptr -17h
var_15		= dword	ptr -15h
var_11		= dword	ptr -11h
var_D		= word ptr -0Dh
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= word ptr -9
var_7		= byte ptr -7
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	18h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [ecx+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_1001732D
		cmp	[ebp+NumberOfBytesRead], 18h
		jnz	short loc_1001732D
		cmp	[ebp+Buffer], 0B8h
		jnz	short loc_1001732D
		mov	eax, 0C933h
		cmp	ax, [ebp+var_17]
		jnz	short loc_1001732D
		cmp	[ebp+var_15], 424548Dh
		jnz	short loc_1001732D
		cmp	[ebp+var_11], 0C015FF64h
		jnz	short loc_1001732D
		xor	eax, eax
		cmp	ax, [ebp+var_D]
		jnz	short loc_1001732D
		cmp	[ebp+var_B], al
		jnz	short loc_1001732D
		mov	al, [ebp+var_A]
		cmp	al, 83h
		jnz	short loc_1001731B
		mov	ecx, 4C4h
		cmp	cx, [ebp+var_9]
		jnz	short loc_1001732D
		cmp	[ebp+var_7], 0C2h
		jz	short loc_1001731F

loc_1001731B:				; CODE XREF: sub_1001729F+69j
		cmp	al, 0C2h
		jnz	short loc_1001732D

loc_1001731F:				; CODE XREF: sub_1001729F+7Aj
		push	esi
		push	6
		pop	ecx
		lea	esi, [ebp+Buffer]
		mov	al, 1
		rep movsd
		pop	esi
		jmp	short loc_1001732F
; ---------------------------------------------------------------------------

loc_1001732D:				; CODE XREF: sub_1001729F+2Cj
					; sub_1001729F+32j ...
		xor	al, al

loc_1001732F:				; CODE XREF: sub_1001729F+8Cj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1001729F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017340	proc near		; DATA XREF: .rdata:1001D5FCo

NumberOfBytesRead= dword ptr -18h
Buffer		= byte ptr -14h
var_F		= dword	ptr -0Fh
var_B		= word ptr -0Bh
var_9		= byte ptr -9
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	10h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [ecx+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_100173A3
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	short loc_100173A3
		cmp	[ebp+Buffer], 0B8h
		jnz	short loc_100173A3
		cmp	[ebp+var_F], 0C015FF64h
		jnz	short loc_100173A3
		xor	eax, eax
		cmp	ax, [ebp+var_B]
		jnz	short loc_100173A3
		cmp	[ebp+var_9], al
		jnz	short loc_100173A3
		cmp	[ebp+var_8], 0C2h
		jnz	short loc_100173A3
		push	esi
		lea	esi, [ebp+Buffer]
		mov	al, 1
		movsd
		movsd
		movsd
		movsd
		pop	esi
		jmp	short loc_100173A5
; ---------------------------------------------------------------------------

loc_100173A3:				; CODE XREF: sub_10017340+2Cj
					; sub_10017340+32j ...
		xor	al, al

loc_100173A5:				; CODE XREF: sub_10017340+61j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10017340	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100173B6(LPVOID lpBuffer, int)
sub_100173B6	proc near		; DATA XREF: .rdata:1001D5B0o
					; .rdata:1001D5D8o ...

NumberOfBytesWritten= dword ptr	-1Ch
lpBaseAddress	= dword	ptr -18h
Buffer		= byte ptr -14h
var_13		= dword	ptr -13h
var_F		= byte ptr -0Fh
var_E		= dword	ptr -0Eh
var_A		= word ptr -0Ah
var_4		= dword	ptr -4
lpBuffer	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+24h+lpBuffer]
		mov	ebx, ecx
		mov	ecx, [esp+24h+arg_4]
		push	esi
		push	edi
		mov	eax, [ebp+1]
		lea	edi, [esp+2Ch+Buffer]
		mov	esi, ebp
		mov	[esp+2Ch+lpBaseAddress], ecx
		push	0Ch
		movsd
		movsd
		movsd
		movsd
		mov	[esp+30h+var_13], eax
		lea	eax, [ecx+18h]
		mov	[esp+30h+var_E], eax
		mov	eax, 0E2FFh
		mov	[esp+30h+var_A], ax
		mov	eax, [ebx+18h]
		mov	[esp+30h+Buffer], 0B8h
		mov	[esp+30h+var_F], 0BAh
		pop	esi
		test	eax, eax
		jz	short loc_10017418
		push	5
		mov	[esp+30h+Buffer], 0E9h
		mov	[esp+30h+var_13], eax
		pop	esi

loc_10017418:				; CODE XREF: sub_100173B6+54j
		push	dword ptr [ebx+8]
		push	ecx
		mov	ecx, ebx
		call	sub_10014477
		push	eax
		lea	eax, [ebp+18h]
		mov	ecx, ebx
		push	eax
		call	sub_10014480
		mov	eax, [ebx]
		mov	ecx, ebx
		call	dword ptr [eax+10h]
		mov	edi, eax
		lea	eax, [esp+2Ch+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	edi		; nSize
		push	ebp		; lpBuffer
		push	[esp+38h+lpBaseAddress]	; lpBaseAddress
		mov	ebp, ds:WriteProcessMemory
		push	dword ptr [ebx+10h] ; hProcess
		call	ebp ; WriteProcessMemory
		test	eax, eax
		jnz	short loc_10017459

loc_10017452:				; CODE XREF: sub_100173B6+A7j
					; sub_100173B6:loc_1001747Aj
		mov	eax, 0C0000001h
		jmp	short loc_1001747E
; ---------------------------------------------------------------------------

loc_10017459:				; CODE XREF: sub_100173B6+9Aj
		cmp	edi, [esp+2Ch+NumberOfBytesWritten]
		jnz	short loc_10017452
		cmp	dword ptr [ebx+0Ch], 0
		jz	short loc_10017493
		lea	eax, [esp+2Ch+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nSize
		lea	eax, [esp+34h+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ebx+4] ; lpBaseAddress
		push	dword ptr [ebx+10h] ; hProcess
		call	ebp ; WriteProcessMemory
		test	eax, eax

loc_1001747A:				; CODE XREF: sub_100173B6+F3j
		jz	short loc_10017452
		xor	eax, eax

loc_1001747E:				; CODE XREF: sub_100173B6+A1j
		mov	ecx, [esp+2Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn	8
; ---------------------------------------------------------------------------

loc_10017493:				; CODE XREF: sub_100173B6+ADj
		push	esi		; dwSize
		lea	eax, [esp+30h+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ebx+4] ; lpAddress
		push	dword ptr [ebx+10h] ; hProcess
		call	sub_1001A611
		add	esp, 10h
		test	al, al
		jmp	short loc_1001747A
sub_100173B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100174AB	proc near		; CODE XREF: sub_100170C0+46p
					; sub_1001751B+53p

NumberOfBytesRead= dword ptr -18h
Buffer		= byte ptr -14h
var_13		= dword	ptr -13h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		mov	esi, ecx
		lea	eax, [ebp+Buffer]
		push	10h		; nSize
		push	eax		; lpBuffer
		push	dword ptr [esi+4] ; lpBaseAddress
		push	dword ptr [esi+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jnz	short loc_100174E0

loc_100174DC:				; CODE XREF: sub_100174AB+39j
		xor	al, al
		jmp	short loc_10017509
; ---------------------------------------------------------------------------

loc_100174E0:				; CODE XREF: sub_100174AB+2Fj
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	short loc_100174DC
		cmp	[ebp+Buffer], 0E9h
		jnz	short loc_10017500
		mov	eax, [esi+4]
		mov	ecx, [ebp+arg_4]
		sub	eax, ecx
		sub	ecx, [esi+4]
		add	[ebp+var_13], eax
		add	ecx, 13h
		mov	[esi+18h], ecx

loc_10017500:				; CODE XREF: sub_100174AB+3Fj
		lea	esi, [ebp+Buffer]
		mov	al, 1
		movsd
		movsd
		movsd
		movsd

loc_10017509:				; CODE XREF: sub_100174AB+33j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	8
sub_100174AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001751B	proc near		; DATA XREF: .rdata:1001D590o
					; .rdata:1001D5B8o ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	[ebp+arg_18]
		mov	edi, ecx
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		mov	eax, [edi]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword ptr [eax+14h]
		test	eax, eax
		js	short loc_100175A3
		mov	eax, [edi]
		mov	ecx, edi
		and	dword ptr [edi+18h], 0
		push	ebx
		push	esi
		call	dword ptr [eax+10h]
		mov	ebx, eax
		push	ebx
		call	sub_1001AAE8
		mov	edx, [edi]
		mov	esi, eax
		pop	ecx
		push	esi
		mov	ecx, edi
		call	dword ptr [edx+20h]
		test	al, al
		jnz	short loc_1001757E
		cmp	[edi+14h], al
		jz	short loc_10017577
		push	[ebp+arg_14]
		mov	ecx, edi
		push	esi
		call	sub_100174AB
		test	al, al
		jnz	short loc_1001757E

loc_10017577:				; CODE XREF: sub_1001751B+4Bj
		mov	edi, 0C0000001h
		jmp	short loc_10017594
; ---------------------------------------------------------------------------

loc_1001757E:				; CODE XREF: sub_1001751B+46j
					; sub_1001751B+5Aj
		push	[ebp+arg_14]
		mov	eax, [edi]
		mov	ecx, edi
		push	esi
		call	dword ptr [eax+24h]
		mov	edi, eax
		mov	eax, [ebp+arg_1C]
		test	eax, eax
		jz	short loc_10017594
		mov	[eax], ebx

loc_10017594:				; CODE XREF: sub_1001751B+61j
					; sub_1001751B+75j
		test	esi, esi
		jz	short loc_1001759F
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_1001759F:				; CODE XREF: sub_1001751B+7Bj
		pop	esi
		mov	eax, edi
		pop	ebx

loc_100175A3:				; CODE XREF: sub_1001751B+22j
		pop	edi
		pop	ebp
		retn	20h
sub_1001751B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100175A8	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+173p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+15Cp	...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	edx, [ebp+arg_0]
		and	[ebp+var_4], 0
		mov	[ecx], edx
		mov	eax, [edx+8]
		add	eax, edx
		mov	[ecx+4], eax
		mov	eax, ecx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100175A8	endp


; =============== S U B	R O U T	I N E =======================================


sub_100175C5	proc near		; CODE XREF: sub_1000AE52+DBp
					; sub_1000AF7F+BBp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, [edi]
		cmp	dword ptr [esi+4], 0
		jnz	short loc_100175D9
		push	0Ah
		pop	eax
		jmp	loc_1001766C
; ---------------------------------------------------------------------------

loc_100175D9:				; CODE XREF: sub_100175C5+Aj
		mov	ecx, [esp+8+arg_0]
		mov	eax, ecx
		sub	eax, [edi+4]
		push	ebx
		shr	eax, 0Ah
		imul	ebx, eax, 14h
		mov	eax, [ecx]
		push	0		; bAlertable
		push	3E8h		; dwMilliseconds
		push	dword ptr [ebx+esi+14h]	; hObjectToWaitOn
		mov	[ebx+esi+18h], eax
		push	dword ptr [ebx+esi+10h]	; hObjectToSignal
		call	ds:SignalObjectAndWait
		cmp	eax, 102h
		jnz	short loc_1001764D

loc_1001760B:				; CODE XREF: sub_100175C5+72j
		mov	eax, [edi]
		push	0		; dwMilliseconds
		push	dword ptr [eax+4] ; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 102h
		jnz	short loc_1001763B
		push	3E8h		; dwMilliseconds
		push	dword ptr [ebx+esi+14h]	; hHandle
		call	ds:WaitForSingleObject
		test	eax, eax
		jz	short loc_10017656
		cmp	eax, 102h
		jz	short loc_1001760B
		jmp	short loc_10017651
; ---------------------------------------------------------------------------

loc_1001763B:				; CODE XREF: sub_100175C5+58j
		push	5
		lea	eax, [esi+0Ch]
		pop	ecx
		add	eax, ebx
		xchg	ecx, [eax]
		mov	eax, [edi]
		and	dword ptr [eax+4], 0
		jmp	short loc_10017651
; ---------------------------------------------------------------------------

loc_1001764D:				; CODE XREF: sub_100175C5+44j
		test	eax, eax
		jz	short loc_10017656

loc_10017651:				; CODE XREF: sub_100175C5+74j
					; sub_100175C5+86j
		push	0Ah
		pop	eax
		jmp	short loc_1001766B
; ---------------------------------------------------------------------------

loc_10017656:				; CODE XREF: sub_100175C5+6Bj
					; sub_100175C5+8Aj
		mov	eax, [esp+0Ch+arg_4]
		mov	edi, eax
		mov	esi, [esp+0Ch+arg_0]
		push	0Dh
		add	esi, 8
		pop	ecx
		rep movsd
		mov	eax, [eax+4]

loc_1001766B:				; CODE XREF: sub_100175C5+8Fj
		pop	ebx

loc_1001766C:				; CODE XREF: sub_100175C5+Fj
		pop	edi
		pop	esi
		retn	8
sub_100175C5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017671	proc near		; CODE XREF: sub_1000AE52:loc_1000AF67p
					; sub_1000AE52:loc_1000AF70p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		sub	eax, [ecx+4]
		shr	eax, 0Ah
		imul	edx, eax, 14h
		mov	eax, [ecx]
		push	esi
		xor	esi, esi
		add	eax, 0Ch
		inc	esi
		add	eax, edx
		xchg	esi, [eax]
		pop	esi
		retn	4
sub_10017671	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001768F	proc near		; CODE XREF: sub_1000AE52+Bp
					; sub_1000AF7F+6p ...

var_1		= byte ptr -1

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		lea	eax, [ebp+var_1]
		mov	[ebp+var_1], 0
		push	eax
		mov	esi, ecx
		call	sub_100176BD
		cmp	[ebp+var_1], 0
		jz	short loc_100176AD
		xor	eax, eax
		jmp	short loc_100176B8
; ---------------------------------------------------------------------------

loc_100176AD:				; CODE XREF: sub_1001768F+18j
		mov	ecx, [esi]
		imul	eax, 14h
		mov	eax, [eax+ecx+8]
		add	eax, ecx

loc_100176B8:				; CODE XREF: sub_1001768F+1Cj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001768F	endp


; =============== S U B	R O U T	I N E =======================================


sub_100176BD	proc near		; CODE XREF: sub_1001768F+Fp

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, ecx
		mov	ebx, [esi]
		cmp	dword ptr [ebx], 0
		jnz	short loc_100176D3
		mov	eax, [esp+8+arg_0]
		mov	byte ptr [eax],	1
		xor	eax, eax
		jmp	short loc_10017716
; ---------------------------------------------------------------------------

loc_100176D3:				; CODE XREF: sub_100176BD+9j
		push	edi

loc_100176D4:				; CODE XREF: sub_100176BD+4Dj
		mov	eax, [esi]
		xor	edx, edx
		cmp	[eax], edx
		jz	short loc_100176F8
		lea	edi, [ebx+0Ch]

loc_100176DF:				; CODE XREF: sub_100176BD+39j
		push	2
		xor	eax, eax
		pop	ecx
		inc	eax
		lock cmpxchg [edi], ecx
		cmp	eax, 1
		jz	short loc_1001771B
		mov	eax, [esi]
		inc	edx
		add	edi, 14h
		cmp	edx, [eax]
		jnz	short loc_100176DF

loc_100176F8:				; CODE XREF: sub_100176BD+1Dj
		mov	eax, [esi]
		push	32h		; dwMilliseconds
		push	dword ptr [eax+4] ; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 102h
		jz	short loc_100176D4
		mov	eax, [esp+0Ch+arg_0]
		mov	byte ptr [eax],	1
		xor	eax, eax

loc_10017715:				; CODE XREF: sub_100176BD+67j
		pop	edi

loc_10017716:				; CODE XREF: sub_100176BD+14j
		pop	esi
		pop	ebx
		retn	4
; ---------------------------------------------------------------------------

loc_1001771B:				; CODE XREF: sub_100176BD+2Fj
		mov	ecx, [esp+0Ch+arg_0]
		mov	eax, edx
		mov	byte ptr [ecx],	0
		jmp	short loc_10017715
sub_100176BD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017726	proc near		; CODE XREF: sub_10019774+12Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		push	ebx
		push	ebx
		lea	esi, [edi+4]
		mov	[edi], ebx
		mov	ecx, esi
		mov	[esi], ebx
		mov	[esi+4], ebx
		call	sub_10016FBF
		mov	[esi], eax
		mov	eax, [ebp+arg_C]
		mov	[edi+0Ch], eax
		mov	eax, [ebp+arg_0]
		mov	[edi+10h], eax
		mov	eax, [ebp+arg_4]
		mov	[edi+14h], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+18h], eax
		mov	eax, [ebp+arg_10]
		mov	[edi+1Ch], eax
		cmp	hSourceHandle, ebx
		jnz	short loc_1001778F
		push	ebx		; lpName
		push	1		; bInitialOwner
		push	ebx		; lpMutexAttributes
		call	ds:CreateMutexW
		mov	edx, eax
		mov	esi, offset hSourceHandle
		mov	ecx, edx
		xor	eax, eax
		lock cmpxchg [esi], ecx
		test	eax, eax
		jz	short loc_1001778F
		push	edx		; hObject
		call	ds:CloseHandle

loc_1001778F:				; CODE XREF: sub_10017726+43j
					; sub_10017726+60j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_10017726	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017798	proc near		; CODE XREF: sub_10019501+Bp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	ebx
		mov	ecx, [ebx+0Ch]
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		test	al, al
		jz	short loc_100177E3
		mov	eax, [ebx+4]
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_100177D6
		push	edi

loc_100177B3:				; CODE XREF: sub_10017798+3Bj
		mov	edi, [esi+8]
		push	dword ptr [edi]	; hObject
		call	ds:CloseHandle
		push	dword ptr [edi+4] ; hObject
		call	ds:CloseHandle
		push	edi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	esi, [esi]
		pop	ecx
		cmp	esi, [ebx+4]
		jnz	short loc_100177B3
		pop	edi

loc_100177D6:				; CODE XREF: sub_10017798+18j
		cmp	dword ptr [ebx], 0
		jz	short loc_100177E3
		push	dword ptr [ebx]	; lpBaseAddress
		call	ds:UnmapViewOfFile

loc_100177E3:				; CODE XREF: sub_10017798+Fj
					; sub_10017798+41j
		lea	ecx, [ebx+4]
		call	sub_10011712
		push	dword ptr [ebx+4] ; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		pop	esi
		pop	ebx
		retn
sub_10017798	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100177F7(void *)
sub_100177F7	proc near		; CODE XREF: sub_10017818+135p

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jz	short locret_10017815
		mov	ecx, [esp+arg_0] ; void	*
		push	0		; int
		push	1		; char
		call	sub_100022C1
		push	[esp+arg_0]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

locret_10017815:			; CODE XREF: sub_100177F7+5j
		retn	4
sub_100177F7	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017818	proc near		; CODE XREF: sub_10017AA5+89p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 14h
		push	ebx
		mov	ebx, [esp+18h+arg_0]
		cmp	dword ptr [ebx+3Ch], 9
		jbe	short loc_1001782D
		xor	al, al
		jmp	loc_10017927
; ---------------------------------------------------------------------------

loc_1001782D:				; CODE XREF: sub_10017818+Cj
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		cmp	[ebx+3Ch], esi
		jbe	loc_10017922
		mov	ebp, [esp+24h+arg_4]
		mov	edi, [esp+24h+arg_8]
		lea	eax, [ebp+4]
		mov	[esp+24h+var_14], eax

loc_1001784A:				; CODE XREF: sub_10017818+104j
		lea	eax, [esp+24h+var_10]
		mov	ecx, ebx
		push	eax
		lea	eax, [esp+28h+var_C]
		push	eax
		push	esi
		call	sub_1000A509
		mov	[edi+esi*4], eax
		test	eax, eax
		jz	loc_10017913
		mov	ecx, [esp+24h+var_14]
		mov	eax, [esp+24h+var_10]
		mov	[ecx], eax
		dec	eax
		jz	short loc_100178DB
		dec	eax
		jz	short loc_100178C1
		dec	eax
		dec	eax
		jz	short loc_100178AA
		dec	eax
		dec	eax
		jnz	loc_10017913
		cmp	[edi+esi*4], eax
		jz	loc_1001792C
		push	8		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100178A6
		mov	edx, [edi+esi*4]
		mov	ecx, [esp+24h+var_C]
		mov	[eax], ecx
		mov	[eax+4], edx
		jmp	short loc_100178D6
; ---------------------------------------------------------------------------

loc_100178A6:				; CODE XREF: sub_10017818+7Ej
		xor	eax, eax
		jmp	short loc_100178D6
; ---------------------------------------------------------------------------

loc_100178AA:				; CODE XREF: sub_10017818+61j
		lea	eax, [esp+24h+var_8]
		mov	ecx, ebx
		push	eax
		push	esi
		call	sub_1000A4CD
		test	al, al
		jz	short loc_1001792C
		mov	eax, [esp+24h+var_8]
		jmp	short loc_100178D6
; ---------------------------------------------------------------------------

loc_100178C1:				; CODE XREF: sub_10017818+5Dj
		lea	eax, [esp+24h+var_4]
		mov	ecx, ebx
		push	eax
		push	esi
		call	sub_1000A42D
		test	al, al
		jz	short loc_1001792C
		mov	eax, [esp+24h+var_4]

loc_100178D6:				; CODE XREF: sub_10017818+8Cj
					; sub_10017818+90j ...
		mov	[edi+esi*4], eax
		jmp	short loc_10017913
; ---------------------------------------------------------------------------

loc_100178DB:				; CODE XREF: sub_10017818+5Aj
		push	18h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jz	short loc_100178FB
		and	dword ptr [ebx+10h], 0
		xor	eax, eax
		mov	dword ptr [ebx+14h], 7
		mov	[ebx], ax
		jmp	short loc_100178FD
; ---------------------------------------------------------------------------

loc_100178FB:				; CODE XREF: sub_10017818+CFj
		xor	ebx, ebx

loc_100178FD:				; CODE XREF: sub_10017818+E1j
		mov	ecx, [esp+24h+arg_0]
		push	ebx
		push	esi
		call	sub_1000A469
		test	al, al
		jz	short loc_10017937
		mov	[edi+esi*4], ebx
		mov	ebx, [esp+24h+arg_0]

loc_10017913:				; CODE XREF: sub_10017818+49j
					; sub_10017818+65j ...
		add	[esp+24h+var_14], 4
		inc	esi
		cmp	esi, [ebx+3Ch]
		jb	loc_1001784A

loc_10017922:				; CODE XREF: sub_10017818+1Dj
		mov	al, 1

loc_10017924:				; CODE XREF: sub_10017818+13Cj
		pop	edi
		pop	esi
		pop	ebp

loc_10017927:				; CODE XREF: sub_10017818+10j
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1001792C:				; CODE XREF: sub_10017818+6Ej
					; sub_10017818+A1j ...
		push	edi
		push	ebp
		call	sub_10017E83
		pop	ecx
		pop	ecx
		jmp	short loc_10017952
; ---------------------------------------------------------------------------

loc_10017937:				; CODE XREF: sub_10017818+F2j
		and	dword ptr [edi+esi*4], 0
		push	edi
		push	ebp
		call	sub_10017E83
		pop	ecx
		pop	ecx
		test	ebx, ebx
		jz	short loc_10017952
		push	ebx		; void *
		lea	ecx, [esp+28h+arg_0]
		call	sub_100177F7

loc_10017952:				; CODE XREF: sub_10017818+11Dj
					; sub_10017818+12Ej
		xor	al, al
		jmp	short loc_10017924
sub_10017818	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017956	proc near		; CODE XREF: sub_10019774+149p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		sub	esp, 0Ch
		push	esi
		push	edi
		mov	edi, [esp+14h+arg_8]
		mov	esi, ecx
		cmp	eax, edi
		jnb	short loc_10017970

loc_10017969:				; CODE XREF: sub_10017956+20j
		xor	al, al
		jmp	loc_10017A9D
; ---------------------------------------------------------------------------

loc_10017970:				; CODE XREF: sub_10017956+11j
		test	edi, 1Fh
		jnz	short loc_10017969
		add	eax, 0FFFFFFF8h
		lea	ecx, [edi+14h]
		xor	edx, edx
		div	ecx
		push	ebp
		mov	ebp, eax
		test	ebp, ebp
		jnz	short loc_10017990
		xor	al, al
		jmp	loc_10017A9C
; ---------------------------------------------------------------------------

loc_10017990:				; CODE XREF: sub_10017956+31j
		and	[esp+18h+var_C], 0
		imul	eax, ebp, 14h
		push	ebx
		add	eax, 8
		mov	[esp+1Ch+arg_8], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esi], eax
		and	dword ptr [eax], 0
		xor	ecx, ecx
		mov	[esp+1Ch+var_8], ecx

loc_100179AF:				; CODE XREF: sub_10017956+10Cj
		mov	eax, [esi]
		add	eax, 8
		add	eax, ecx
		push	28h		; unsigned int
		mov	[esp+20h+arg_4], eax
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		mov	ebx, eax
		lea	ecx, [esi+4]
		lea	eax, [esp+1Ch+var_4]
		mov	[esp+1Ch+var_4], ebx
		push	eax
		push	dword ptr [esi+4]
		call	sub_10010C9A
		mov	eax, [esp+1Ch+arg_4]
		lea	ecx, [eax+0Ch]
		add	eax, 8
		push	ecx		; LPHANDLE
		push	eax		; lpTargetHandle
		lea	eax, [ebx+4]
		mov	ecx, esi
		push	eax		; int
		push	ebx		; int
		call	sub_10017E11
		test	al, al
		jz	loc_10017A99
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+arg_8]
		mov	eax, [esp+1Ch+arg_0]
		push	ebx
		mov	[edx], ecx
		add	ecx, edi
		mov	dword ptr [edx+4], 1
		mov	[ebx+10h], eax
		mov	[ebx+8], edi
		mov	[ebx+14h], edx
		mov	eax, [ebx+10h]
		add	eax, [edx]
		mov	[ebx+0Ch], eax
		mov	eax, [esi+1Ch]
		mov	[ebx+18h], eax
		mov	eax, [esi+10h]
		mov	[ebx+1Ch], eax
		mov	eax, [esi+14h]
		mov	[ebx+24h], eax
		mov	eax, [esi+18h]
		mov	[ebx+20h], eax
		mov	[esp+20h+arg_8], ecx
		mov	ecx, [esi+0Ch]
		push	offset sub_10017ECE
		push	dword ptr [ebx]
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax]
		mov	eax, [esp+1Ch+var_C]
		mov	ecx, [esp+1Ch+var_8]
		inc	eax
		add	ecx, 14h
		mov	[esp+1Ch+var_C], eax
		mov	[esp+1Ch+var_8], ecx
		cmp	eax, ebp
		jnz	loc_100179AF
		mov	eax, [esi]
		push	0		; dwOptions
		push	0		; bInheritHandle
		push	100002h		; dwDesiredAccess
		add	eax, 4
		push	eax		; lpTargetHandle
		push	dword ptr [esi+10h] ; hTargetProcessHandle
		push	hSourceHandle	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10017A99
		mov	ecx, [esi]
		mov	al, 1
		mov	[ecx], ebp
		jmp	short loc_10017A9B
; ---------------------------------------------------------------------------

loc_10017A99:				; CODE XREF: sub_10017956+9Cj
					; sub_10017956+139j
		xor	al, al

loc_10017A9B:				; CODE XREF: sub_10017956+141j
		pop	ebx

loc_10017A9C:				; CODE XREF: sub_10017956+35j
		pop	ebp

loc_10017A9D:				; CODE XREF: sub_10017956+15j
		pop	edi
		pop	esi
		add	esp, 0Ch
		retn	0Ch
sub_10017956	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10017AA5(int,	void *,	int)
sub_10017AA5	proc near		; CODE XREF: sub_10017ECE+52p

var_A5		= byte ptr -0A5h
var_A4		= byte ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= byte ptr -84h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0A8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0A8h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+0B0h+arg_8]
		xor	ebx, ebx
		push	esi
		mov	esi, [esp+0B4h+arg_0]
		push	edi
		mov	edi, [esp+0B8h+arg_4]
		push	ebp
		push	5
		mov	[esp+0C0h+var_98], esi
		mov	[esp+0C0h+var_94], edi
		mov	[esp+0C0h+var_9C], ebx
		call	sub_1000A5CD
		lea	eax, [esp+0C0h+var_A0]
		mov	[esp+0C0h+var_A0], ebx
		push	eax		; int
		push	dword ptr [esi+8] ; int
		push	edi		; void *
		call	sub_1000A247
		mov	esi, eax
		add	esp, 14h
		mov	[esp+0B8h+var_9C], esi
		test	esi, esi
		jz	loc_10017DCC
		mov	edx, [esi]
		lea	edi, [esp+0B8h+var_4C]
		push	9
		pop	ecx
		xor	eax, eax
		mov	[esp+0B8h+var_90], edx
		rep stosd
		lea	eax, [esp+0B8h+var_28]
		mov	[esp+0B8h+var_50], edx
		push	eax
		lea	eax, [esp+0BCh+var_50]
		push	eax
		push	esi
		call	sub_10017818
		add	esp, 0Ch
		test	al, al
		jz	loc_10017DC1
		push	38h		; size_t
		lea	eax, [esp+0BCh+var_88]
		push	ebx		; int
		push	eax		; void *
		call	memset
		mov	ecx, [esp+0C4h+var_98]
		lea	edx, [esp+0C4h+var_A4]
		mov	eax, [esp+0C4h+var_90]
		add	esp, 0Ch
		mov	[esp+0B8h+var_8C], eax
		mov	[esp+0B8h+var_A5], 1
		lea	eax, [ecx+1Ch]
		mov	ecx, [ecx+18h]
		mov	[esp+0B8h+var_88], eax
		push	edx
		lea	edx, [esp+0BCh+var_50]
		mov	eax, [ecx]
		push	edx
		call	dword ptr [eax]
		test	eax, eax
		jz	loc_10017DA6
		mov	ecx, [esi+3Ch]
		cmp	ecx, 9		; switch 10 cases
		ja	loc_10017D9C	; jumptable 10017B8B default case
		jmp	ds:off_10017DE9[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10017B92:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		lea	ecx, [esp+0B8h+var_8C] ; jumptable 10017B8B case 0
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0BCh+var_A4]
		jmp	loc_10017D65
; ---------------------------------------------------------------------------

loc_10017BA2:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		push	[esp+0B8h+var_28] ; jumptable 10017B8B case 1
		lea	ecx, [esp+0BCh+var_8C]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0C0h+var_A4]
		jmp	loc_10017D65
; ---------------------------------------------------------------------------

loc_10017BB9:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		push	[esp+0B8h+var_24] ; jumptable 10017B8B case 2
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0C4h+var_A4]
		jmp	loc_10017D65
; ---------------------------------------------------------------------------

loc_10017BD7:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		push	[esp+0B8h+var_20] ; jumptable 10017B8B case 3
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_24]
		push	[esp+0C0h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0C8h+var_A4]
		jmp	loc_10017D65
; ---------------------------------------------------------------------------

loc_10017BFC:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		push	[esp+0B8h+var_1C] ; jumptable 10017B8B case 4
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_20]
		push	[esp+0C0h+var_24]
		push	[esp+0C4h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0CCh+var_A4]
		jmp	loc_10017D65
; ---------------------------------------------------------------------------

loc_10017C28:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		push	[esp+0B8h+var_18] ; jumptable 10017B8B case 5
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_1C]
		push	[esp+0C0h+var_20]
		push	[esp+0C4h+var_24]
		push	[esp+0C8h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0D0h+var_A4]
		jmp	loc_10017D65
; ---------------------------------------------------------------------------

loc_10017C5B:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		push	[esp+0B8h+var_14] ; jumptable 10017B8B case 6
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_18]
		push	[esp+0C0h+var_1C]
		push	[esp+0C4h+var_20]
		push	[esp+0C8h+var_24]
		push	[esp+0CCh+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0D4h+var_A4]
		jmp	loc_10017D65
; ---------------------------------------------------------------------------

loc_10017C95:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		push	[esp+0B8h+var_10] ; jumptable 10017B8B case 7
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_14]
		push	[esp+0C0h+var_18]
		push	[esp+0C4h+var_1C]
		push	[esp+0C8h+var_20]
		push	[esp+0CCh+var_24]
		push	[esp+0D0h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0D8h+var_A4]
		jmp	loc_10017D65
; ---------------------------------------------------------------------------

loc_10017CD6:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		push	[esp+0B8h+var_C] ; jumptable 10017B8B case 8
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_10]
		push	[esp+0C0h+var_14]
		push	[esp+0C4h+var_18]
		push	[esp+0C8h+var_1C]
		push	[esp+0CCh+var_20]
		push	[esp+0D0h+var_24]
		push	[esp+0D4h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0DCh+var_A4]
		jmp	short loc_10017D65
; ---------------------------------------------------------------------------

loc_10017D1B:				; CODE XREF: sub_10017AA5+E6j
					; DATA XREF: .text:off_10017DE9o
		push	[esp+0B8h+var_8] ; jumptable 10017B8B case 9
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_C]
		push	[esp+0C0h+var_10]
		push	[esp+0C4h+var_14]
		push	[esp+0C8h+var_18]
		push	[esp+0CCh+var_1C]
		push	[esp+0D0h+var_20]
		push	[esp+0D4h+var_24]
		push	[esp+0D8h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0E0h+var_A4]

loc_10017D65:				; CODE XREF: sub_10017AA5+F8j
					; sub_10017AA5+10Fj ...
		test	al, al
		jz	short loc_10017D9C ; jumptable 10017B8B	default	case
		push	0Dh
		pop	ecx
		lea	esi, [esp+0B8h+var_84]
		mov	[esp+0B8h+var_A5], bl
		mov	edi, ebp
		rep movsd
		push	ebp
		call	sub_1000A5DD
		mov	esi, [esp+0BCh+var_9C]
		pop	ecx
		cmp	dword ptr [esi+4], 1
		jnz	short loc_10017DA6
		push	[esp+0B8h+var_A0] ; size_t
		push	esi		; void *
		push	[esp+0C0h+var_94] ; void *
		call	memcpy
		add	esp, 0Ch
		jmp	short loc_10017DA6
; ---------------------------------------------------------------------------

loc_10017D9C:				; CODE XREF: sub_10017AA5+E0j
					; sub_10017AA5+2C2j
		push	ebp		; jumptable 10017B8B default case
		push	6
		call	sub_1000A5CD
		pop	ecx
		pop	ecx

loc_10017DA6:				; CODE XREF: sub_10017AA5+D4j
					; sub_10017AA5+2E2j ...
		lea	eax, [esp+0B8h+var_28]
		push	eax
		lea	eax, [esp+0BCh+var_50]
		push	eax
		call	sub_10017E83
		cmp	[esp+0C0h+var_A5], bl
		pop	ecx
		pop	ecx
		setz	bl

loc_10017DC1:				; CODE XREF: sub_10017AA5+93j
		test	esi, esi
		jz	short loc_10017DCC
		push	esi
		call	sub_1000A23B
		pop	ecx

loc_10017DCC:				; CODE XREF: sub_10017AA5+60j
					; sub_10017AA5+31Ej
		mov	ecx, [esp+0B8h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0A8h
		retn
sub_10017AA5	endp

; ---------------------------------------------------------------------------
		db 8Bh,	0FFh
off_10017DE9	dd offset loc_10017B92	; DATA XREF: sub_10017AA5+E6r
		dd offset loc_10017BA2	; jump table for switch	statement
		dd offset loc_10017BB9
		dd offset loc_10017BD7
		dd offset loc_10017BFC
		dd offset loc_10017C28
		dd offset loc_10017C5B
		dd offset loc_10017C95
		dd offset loc_10017CD6
		dd offset loc_10017D1B

; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10017E11(int, int, LPHANDLE	lpTargetHandle,	LPHANDLE)
sub_10017E11	proc near		; CODE XREF: sub_10017956+95p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
lpTargetHandle	= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	esi
		xor	ebx, ebx
		mov	esi, ecx
		push	ebx		; lpName
		push	ebx		; bInitialState
		push	ebx		; bManualReset
		push	ebx		; lpEventAttributes
		call	ds:CreateEventW
		mov	ecx, [esp+8+arg_0]
		push	ebx		; dwOptions
		push	ebx		; bInheritHandle
		mov	ebx, ds:GetCurrentProcess
		push	100002h		; dwDesiredAccess
		push	[esp+14h+lpTargetHandle] ; lpTargetHandle
		mov	[ecx], eax
		push	dword ptr [esi+10h] ; hTargetProcessHandle
		push	eax		; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10017E4D
		xor	al, al
		jmp	short loc_10017E7E
; ---------------------------------------------------------------------------

loc_10017E4D:				; CODE XREF: sub_10017E11+36j
		xor	eax, eax
		push	eax		; lpName
		push	eax		; bInitialState
		push	eax		; bManualReset
		push	eax		; lpEventAttributes
		call	ds:CreateEventW
		mov	ecx, [esp+8+arg_4]
		push	0		; dwOptions
		push	0		; bInheritHandle
		push	100002h		; dwDesiredAccess
		push	[esp+14h+arg_C]	; lpTargetHandle
		mov	[ecx], eax
		push	dword ptr [esi+10h] ; hTargetProcessHandle
		push	eax		; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		setnz	al

loc_10017E7E:				; CODE XREF: sub_10017E11+3Aj
		pop	esi
		pop	ebx
		retn	10h
sub_10017E11	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017E83	proc near		; CODE XREF: sub_10017818+116p
					; sub_10017818+125p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_4]
		xor	esi, esi
		add	ebx, 4

loc_10017E94:				; CODE XREF: sub_10017E83+44j
		mov	eax, [ebx]
		dec	eax
		jz	short loc_10017EA3
		sub	eax, 5
		jnz	short loc_10017EC0
		push	dword ptr [edi+esi*4]
		jmp	short loc_10017EB6
; ---------------------------------------------------------------------------

loc_10017EA3:				; CODE XREF: sub_10017E83+14j
		mov	ebp, [edi+esi*4]
		test	ebp, ebp
		jz	short loc_10017EBC
		push	0		; int
		push	1		; char
		mov	ecx, ebp	; void *
		call	sub_100022C1
		push	ebp		; void *

loc_10017EB6:				; CODE XREF: sub_10017E83+1Ej
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_10017EBC:				; CODE XREF: sub_10017E83+25j
		and	dword ptr [edi+esi*4], 0

loc_10017EC0:				; CODE XREF: sub_10017E83+19j
		inc	esi
		add	ebx, 4
		cmp	esi, 9
		jb	short loc_10017E94
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10017E83	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017ECE	proc near		; DATA XREF: sub_10017956+EAo

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		push	ebx
		mov	ebx, [esp+40h+arg_0]
		push	esi
		xor	esi, esi
		mov	[esp+44h+var_3C], esi
		test	ebx, ebx
		jz	short loc_10017F47
		mov	ecx, [ebx+14h]
		push	ebp
		push	3
		pop	ebp
		push	2
		mov	edx, ebp
		add	ecx, 4
		pop	eax
		lock cmpxchg [ecx], edx
		cmp	eax, 2
		jnz	short loc_10017F46
		push	edi
		push	30h		; size_t
		lea	eax, [esp+50h+var_34]
		mov	[esp+50h+var_38], esi
		push	esi		; int
		push	eax		; void *
		call	memset
		mov	edi, [ebx+0Ch]
		lea	eax, [esp+58h+var_38]
		push	eax		; int
		push	edi		; void *
		push	ebx		; int
		call	sub_10017AA5
		add	esp, 18h
		lea	esi, [esp+4Ch+var_38]
		add	edi, 8
		push	0Dh
		pop	ecx
		rep movsd
		mov	eax, [ebx+14h]
		add	eax, 4
		xchg	ebp, [eax]
		push	dword ptr [ebx+4] ; hEvent
		call	ds:SetEvent
		pop	edi

loc_10017F46:				; CODE XREF: sub_10017ECE+34j
		pop	ebp

loc_10017F47:				; CODE XREF: sub_10017ECE+1Cj
		mov	ecx, [esp+44h+var_4]
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3Ch
		retn	8
sub_10017ECE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017F5A	proc near		; CODE XREF: sub_10010C9A+1Cp

arg_0		= dword	ptr  4

		mov	edx, [ecx+4]
		mov	eax, 15555554h
		push	esi
		mov	esi, [esp+4+arg_0]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_10017F78
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10017F78:				; CODE XREF: sub_10017F5A+11j
		lea	eax, [edx+esi]
		mov	[ecx+4], eax
		pop	esi
		retn	4
sub_10017F5A	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10017F82(PSID pDestinationSid, PSID pSourceSid)
sub_10017F82	proc near		; CODE XREF: sub_1000815A+4Ep
					; sub_100082E5+42p ...

pSourceSid	= dword	ptr  4

		push	esi
		push	[esp+4+pSourceSid] ; pSourceSid
		mov	esi, ecx
		push	esi		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		mov	eax, esi
		pop	esi
		retn	4
sub_10017F82	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10017F98(PSID pSid, WELL_KNOWN_SID_TYPE WellKnownSidType)
sub_10017F98	proc near		; CODE XREF: sub_10014AFC+1FCp
					; sub_1001514D+D7p ...

cbSid		= dword	ptr -4
WellKnownSidType= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+cbSid], 0
		lea	eax, [ebp+cbSid]
		push	esi
		push	eax		; cbSid
		mov	esi, ecx
		mov	[ebp+cbSid], 44h
		push	esi		; pSid
		push	0		; DomainSid
		push	[ebp+WellKnownSidType] ; WellKnownSidType
		call	ds:CreateWellKnownSid
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10017F98	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017FC3	proc near		; CODE XREF: sub_1000815A+45p
					; sub_1000820F+2Ep ...
		mov	eax, ecx
		retn
sub_10017FC3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017FC6	proc near		; CODE XREF: sub_1001843A+2Fp
		push	esi
		mov	esi, ecx
		mov	byte ptr [esi+0Bh], 1
		mov	byte ptr [esi+0Dh], 1
		call	sub_10018040
		mov	eax, esi
		pop	esi
		retn
sub_10017FC6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017FDA	proc near		; CODE XREF: sub_1001843A+4Ap

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		push	edi
		mov	esi, ecx
		call	sub_10018040
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+var_4]
		and	[ebp+var_4], 0
		mov	ecx, esi
		push	eax
		push	edi
		call	sub_10018353
		cmp	eax, 1
		jz	short loc_10018038
		push	ebx
		mov	ebx, [ebp+var_4]
		lea	eax, [ebp+var_4]
		and	[ebp+var_4], 0
		add	ebx, edi
		push	eax
		push	0
		push	ebx
		mov	ecx, esi
		call	sub_100180D2
		cmp	dword ptr [esi], 1
		jz	short loc_10018034
		cmp	dword ptr [esi], 0
		jz	short loc_10018034
		mov	ecx, [esi+4]
		mov	eax, [ebp+arg_4]
		sub	ecx, edi
		add	ecx, [ebp+var_4]
		add	ecx, ebx
		add	[eax], ecx
		mov	eax, [esi]
		jmp	short loc_10018037
; ---------------------------------------------------------------------------

loc_10018034:				; CODE XREF: sub_10017FDA+40j
					; sub_10017FDA+45j
		xor	eax, eax
		inc	eax

loc_10018037:				; CODE XREF: sub_10017FDA+58j
		pop	ebx

loc_10018038:				; CODE XREF: sub_10017FDA+23j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10017FDA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018040	proc near		; CODE XREF: sub_10017FC6+Bp
					; sub_10017FDA+8p
		mov	al, [ecx+0Bh]
		mov	[ecx+0Ah], al
		mov	al, [ecx+0Dh]
		mov	[ecx+0Ch], al
		xor	eax, eax
		mov	[ecx+4], eax
		mov	[ecx+8], ax
		mov	dword ptr [ecx], 1
		mov	[ecx+0Eh], ax
		mov	[ecx+10h], al
		retn
sub_10018040	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018063	proc near		; CODE XREF: sub_100180D2+E6p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	byte ptr [ecx+9], 0
		jnz	short loc_10018075
		mov	eax, [ebp+arg_4]
		inc	dword ptr [eax]
		mov	al, 1
		jmp	short loc_100180CE
; ---------------------------------------------------------------------------

loc_10018075:				; CODE XREF: sub_10018063+7j
		push	esi
		mov	esi, [ebp+arg_0]
		mov	dl, [esi]
		mov	al, dl
		and	dl, 7
		shr	al, 3
		and	al, 18h
		or	dl, al
		shr	al, 3
		cmp	byte ptr [ecx+0Ch], 0
		mov	byte ptr [ebp+arg_0], al
		movzx	eax, dl
		lea	edx, dword_1001E408[eax*8]
		jnz	short loc_100180A4
		lea	edx, dword_1001E308[eax*8]

loc_100180A4:				; CODE XREF: sub_10018063+38j
		cmp	byte ptr [edx],	0
		jz	short loc_100180AF
		mov	eax, [edx+4]
		add	[ecx+4], eax

loc_100180AF:				; CODE XREF: sub_10018063+44j
		cmp	byte ptr [edx+1], 0
		mov	eax, [ebp+arg_4]
		jz	short loc_100180C9
		inc	dword ptr [eax]
		push	eax
		push	[ebp+arg_0]
		lea	eax, [esi+1]
		push	eax
		call	sub_100183C7
		jmp	short loc_100180CD
; ---------------------------------------------------------------------------

loc_100180C9:				; CODE XREF: sub_10018063+53j
		inc	dword ptr [eax]
		mov	al, 1

loc_100180CD:				; CODE XREF: sub_10018063+64j
		pop	esi

loc_100180CE:				; CODE XREF: sub_10018063+10j
		pop	ebp
		retn	8
sub_10018063	endp


; =============== S U B	R O U T	I N E =======================================


sub_100180D2	proc near		; CODE XREF: sub_10017FDA+38p
					; sub_100180D2+6Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, ecx
		mov	cl, ds:byte_1001E50C[ebx*8]
		mov	al, [ebp+0]
		shr	al, cl
		and	al, ds:byte_1001E50D[ebx*8]
		cmp	al, ds:byte_1001E50E[ebx*8]
		jb	loc_100181DD
		cmp	al, ds:byte_1001E50F[ebx*8]
		ja	loc_100181DD
		movzx	eax, al
		imul	esi, eax, 64h
		add	esi, ds:off_1001E508[ebx*8]
		cmp	dword ptr [esi+4], 0
		jnz	short loc_1001812A
		and	dword ptr [edi], 0
		xor	eax, eax
		jmp	loc_100181E2
; ---------------------------------------------------------------------------

loc_1001812A:				; CODE XREF: sub_100180D2+4Cj
		cmp	dword ptr [esi+4], 2
		jnz	short loc_1001814B
		mov	eax, [esp+10h+arg_8]
		mov	ecx, edi
		push	eax
		inc	dword ptr [eax]
		lea	eax, [ebp+1]
		push	dword ptr [esi]
		push	eax
		call	sub_100180D2
		mov	eax, [edi]
		jmp	loc_100181E2
; ---------------------------------------------------------------------------

loc_1001814B:				; CODE XREF: sub_100180D2+5Cj
		cmp	byte ptr [esi+18h], 0
		jz	short loc_1001817E
		xor	eax, eax
		cmp	[edi+0Eh], al
		jz	short loc_10018162
		cmp	[esi+30h], eax
		jz	short loc_10018162
		add	esi, 1Ch
		jmp	short loc_1001817E
; ---------------------------------------------------------------------------

loc_10018162:				; CODE XREF: sub_100180D2+84j
					; sub_100180D2+89j
		cmp	[edi+0Fh], al
		jz	short loc_10018171
		cmp	[esi+48h], eax
		jz	short loc_10018171
		add	esi, 34h
		jmp	short loc_1001817E
; ---------------------------------------------------------------------------

loc_10018171:				; CODE XREF: sub_100180D2+93j
					; sub_100180D2+98j
		cmp	[edi+10h], al
		jz	short loc_1001817E
		cmp	[esi+60h], eax
		jz	short loc_1001817E
		add	esi, 4Ch

loc_1001817E:				; CODE XREF: sub_100180D2+7Dj
					; sub_100180D2+8Ej ...
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	[edi], eax
		push	dword ptr [esi+8]
		call	sub_100181E9
		push	dword ptr [esi+0Ch]
		mov	ecx, edi
		call	sub_100181E9
		push	dword ptr [esi+10h]
		mov	ecx, edi
		call	sub_100181E9
		cmp	ds:byte_1001E50D[ebx*8], 0FFh
		jz	short loc_100181CA
		cmp	byte ptr [edi+8], 0
		jz	short loc_100181C2
		push	[esp+10h+arg_8]
		push	ebp

loc_100181B6:				; CODE XREF: sub_100180D2+109j
		mov	ecx, edi
		call	sub_10018063

loc_100181BD:				; CODE XREF: sub_100180D2+F6j
		push	8
		pop	eax
		jmp	short loc_100181E2
; ---------------------------------------------------------------------------

loc_100181C2:				; CODE XREF: sub_100180D2+DDj
		mov	eax, [esp+10h+arg_8]

loc_100181C6:				; CODE XREF: sub_100180D2+100j
		inc	dword ptr [eax]
		jmp	short loc_100181BD
; ---------------------------------------------------------------------------

loc_100181CA:				; CODE XREF: sub_100180D2+D7j
		cmp	byte ptr [edi+8], 0
		mov	eax, [esp+10h+arg_8]
		jz	short loc_100181C6
		inc	dword ptr [eax]
		push	eax
		lea	eax, [ebp+1]
		push	eax
		jmp	short loc_100181B6
; ---------------------------------------------------------------------------

loc_100181DD:				; CODE XREF: sub_100180D2+28j
					; sub_100180D2+35j
		xor	eax, eax
		inc	eax
		mov	[edi], eax

loc_100181E2:				; CODE XREF: sub_100180D2+53j
					; sub_100180D2+74j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_100180D2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100181E9	proc near		; CODE XREF: sub_100180D2+B6p
					; sub_100180D2+C0p ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	ebx
		xor	ebx, ebx
		inc	ebx
		test	edx, edx
		jz	loc_1001834D
		mov	eax, edx
		push	esi
		and	eax, 0FF0000h
		mov	esi, 0A0000h
		cmp	eax, esi
		jg	loc_10018315
		jz	short loc_1001825A
		cmp	eax, 20000h
		jz	loc_10018349
		cmp	eax, 30000h
		jz	loc_10018349
		cmp	eax, 40000h
		jz	loc_10018346
		cmp	eax, 60000h
		jz	loc_10018349
		cmp	eax, 70000h
		jz	short loc_1001825A
		cmp	eax, 80000h
		jz	short loc_1001825A
		cmp	eax, 90000h
		jz	loc_10018346
		jmp	loc_1001834C
; ---------------------------------------------------------------------------

loc_1001825A:				; CODE XREF: sub_100181E9+25j
					; sub_100181E9+58j ...
		and	edx, 0FF000000h
		mov	eax, 9000000h
		cmp	edx, eax
		jg	short loc_100182CF
		jz	loc_100182FF
		cmp	edx, 2000000h
		jz	short loc_100182CA
		cmp	edx, 3000000h
		jz	short loc_100182C4
		cmp	edx, 4000000h
		jz	short loc_100182BB
		cmp	edx, 5000000h
		jz	short loc_100182A3
		cmp	edx, 6000000h
		jz	short loc_100182AC
		cmp	edx, 8000000h
		jnz	loc_1001834C

loc_100182A3:				; CODE XREF: sub_100181E9+A4j
		add	dword ptr [ecx+4], 10h
		jmp	loc_1001834C
; ---------------------------------------------------------------------------

loc_100182AC:				; CODE XREF: sub_100181E9+ACj
		cmp	byte ptr [ecx+0Ah], 0
		jz	short loc_100182BB

loc_100182B2:				; CODE XREF: sub_100181E9+ECj
		add	dword ptr [ecx+4], 6
		jmp	loc_1001834C
; ---------------------------------------------------------------------------

loc_100182BB:				; CODE XREF: sub_100181E9+9Cj
					; sub_100181E9+C7j ...
		add	dword ptr [ecx+4], 4
		jmp	loc_1001834C
; ---------------------------------------------------------------------------

loc_100182C4:				; CODE XREF: sub_100181E9+94j
		cmp	byte ptr [ecx+0Ah], 0
		jnz	short loc_1001830B

loc_100182CA:				; CODE XREF: sub_100181E9+8Cj
		inc	dword ptr [ecx+4]
		jmp	short loc_1001834C
; ---------------------------------------------------------------------------

loc_100182CF:				; CODE XREF: sub_100181E9+7Ej
		cmp	edx, 0A000000h
		jz	short loc_100182B2
		cmp	edx, 0B000000h
		jz	short loc_10018311
		cmp	edx, 0D000000h
		jz	short loc_10018305
		cmp	edx, 0E000000h
		jz	short loc_1001830B
		cmp	edx, 0F000000h
		jz	short loc_100182FF
		cmp	edx, 10000000h
		jnz	short loc_1001834C

loc_100182FF:				; CODE XREF: sub_100181E9+80j
					; sub_100181E9+10Cj
		add	dword ptr [ecx+4], 8
		jmp	short loc_1001834C
; ---------------------------------------------------------------------------

loc_10018305:				; CODE XREF: sub_100181E9+FCj
		cmp	byte ptr [ecx+0Ah], 0
		jnz	short loc_100182BB

loc_1001830B:				; CODE XREF: sub_100181E9+DFj
					; sub_100181E9+104j
		add	dword ptr [ecx+4], 2
		jmp	short loc_1001834C
; ---------------------------------------------------------------------------

loc_10018311:				; CODE XREF: sub_100181E9+F4j
		xor	bl, bl
		jmp	short loc_1001834C
; ---------------------------------------------------------------------------

loc_10018315:				; CODE XREF: sub_100181E9+1Fj
		cmp	eax, 0B0000h
		jz	short loc_10018349
		cmp	eax, 0C0000h
		jz	short loc_10018346
		cmp	eax, 0D0000h
		jz	short loc_10018349
		cmp	eax, 0E0000h
		jz	short loc_10018349
		cmp	eax, 0F0000h
		jz	short loc_10018349
		cmp	eax, 100000h
		jz	short loc_10018349
		cmp	eax, 110000h
		jnz	short loc_1001834C

loc_10018346:				; CODE XREF: sub_100181E9+42j
					; sub_100181E9+66j ...
		mov	[ecx+9], bl

loc_10018349:				; CODE XREF: sub_100181E9+2Cj
					; sub_100181E9+37j ...
		mov	[ecx+8], bl

loc_1001834C:				; CODE XREF: sub_100181E9+6Cj
					; sub_100181E9+B4j ...
		pop	esi

loc_1001834D:				; CODE XREF: sub_100181E9+Aj
		mov	al, bl
		pop	ebx
		retn	4
sub_100181E9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018353	proc near		; CODE XREF: sub_10017FDA+1Bp
					; sub_10018353+68p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	edx, ecx
		push	8
		pop	esi
		movzx	eax, byte ptr [edi]
		imul	ecx, eax, 64h
		add	ecx, ds:off_1001E508
		mov	eax, [ecx+4]
		sub	eax, 3
		jz	short loc_1001838D
		dec	eax
		jz	short loc_10018383
		dec	eax
		jnz	short loc_100183C0
		cmp	[edx+0Bh], al
		setz	al
		mov	[edx+0Ah], al
		jmp	short loc_1001838D
; ---------------------------------------------------------------------------

loc_10018383:				; CODE XREF: sub_10018353+20j
		cmp	byte ptr [edx+0Dh], 0
		setz	al
		mov	[edx+0Ch], al

loc_1001838D:				; CODE XREF: sub_10018353+1Dj
					; sub_10018353+2Ej
		mov	al, [edi]
		cmp	al, 0F2h
		jnz	short loc_10018399
		mov	byte ptr [edx+0Eh], 1
		jmp	short loc_100183AB
; ---------------------------------------------------------------------------

loc_10018399:				; CODE XREF: sub_10018353+3Ej
		cmp	al, 0F3h
		jnz	short loc_100183A3
		mov	byte ptr [edx+0Fh], 1
		jmp	short loc_100183AB
; ---------------------------------------------------------------------------

loc_100183A3:				; CODE XREF: sub_10018353+48j
		cmp	al, 66h
		jnz	short loc_100183AB
		mov	byte ptr [edx+10h], 1

loc_100183AB:				; CODE XREF: sub_10018353+44j
					; sub_10018353+4Ej ...
		mov	esi, [ecx+4]
		mov	ecx, [esp+8+arg_4]
		push	ecx
		inc	dword ptr [ecx]
		lea	ecx, [edi+1]
		push	ecx
		mov	ecx, edx
		call	sub_10018353

loc_100183C0:				; CODE XREF: sub_10018353+23j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_10018353	endp


; =============== S U B	R O U T	I N E =======================================


sub_100183C7	proc near		; CODE XREF: sub_10018063+5Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	al, [eax]
		and	al, 7
		cmp	al, 5
		jnz	short loc_100183E9
		mov	eax, [esp+arg_4]
		movzx	eax, al
		sub	eax, 0
		jz	short loc_100183E5
		dec	eax
		jz	short loc_100183F4
		dec	eax
		jnz	short loc_100183E9

loc_100183E5:				; CODE XREF: sub_100183C7+16j
		add	dword ptr [ecx+4], 4

loc_100183E9:				; CODE XREF: sub_100183C7+Aj
					; sub_100183C7+1Cj ...
		mov	eax, [esp+arg_8]
		inc	dword ptr [eax]
		mov	al, 1
		retn	0Ch
; ---------------------------------------------------------------------------

loc_100183F4:				; CODE XREF: sub_100183C7+19j
		inc	dword ptr [ecx+4]
		jmp	short loc_100183E9
sub_100183C7	endp


; =============== S U B	R O U T	I N E =======================================


sub_100183F9	proc near		; CODE XREF: sub_1001843A+87p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_8]
		mov	eax, [esp+arg_0]
		test	edx, edx
		jz	short locret_1001841A
		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	esi, eax
		sub	edi, eax

loc_1001840F:				; CODE XREF: sub_100183F9+1Dj
		mov	cl, [edi+esi]
		mov	[esi], cl
		inc	esi
		dec	edx
		jnz	short loc_1001840F
		pop	edi
		pop	esi

locret_1001841A:			; CODE XREF: sub_100183F9+Aj
		retn
sub_100183F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001841B(void	*, int,	size_t)
sub_1001841B	proc near		; CODE XREF: sub_1001843A+C4p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		jbe	short loc_10018435
		push	[ebp+arg_8]	; size_t
		push	[ebp+arg_4]	; int
		push	[ebp+arg_0]	; void *
		call	memset
		add	esp, 0Ch

loc_10018435:				; CODE XREF: sub_1001841B+7j
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_1001841B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001843A	proc near		; CODE XREF: sub_1001855A+83p

var_14		= byte ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+20h+arg_0]
		push	edi
		test	esi, esi
		jz	loc_10018517
		mov	edi, [esp+24h+arg_4]
		test	edi, edi
		jz	loc_10018517
		mov	ebx, [esp+24h+arg_8]
		test	ebx, ebx
		jz	loc_10018517
		lea	ecx, [esp+24h+var_14]
		call	sub_10017FC6
		xor	ecx, ecx
		push	5
		mov	[esp+28h+arg_0], ecx
		pop	ebp

loc_10018477:				; CODE XREF: sub_1001843A+68j
		lea	eax, [esp+24h+arg_0]
		push	eax
		lea	eax, [ecx+esi]
		push	eax
		lea	ecx, [esp+2Ch+var_14]
		call	sub_10017FDA
		cmp	eax, 6
		jz	loc_10018512
		cmp	eax, 7
		jz	short loc_1001850E
		cmp	eax, 8
		jnz	short loc_1001850A
		mov	ecx, [esp+24h+arg_0]
		cmp	ecx, ebp
		jb	short loc_10018477
		mov	edx, [esp+24h+arg_10]
		test	edx, edx
		jz	short loc_100184B1
		lea	eax, [ecx+5]
		mov	[edx], eax

loc_100184B1:				; CODE XREF: sub_1001843A+70j
		lea	eax, [ecx+5]
		cmp	eax, [esp+24h+arg_C]
		jbe	short loc_100184BE
		push	2
		jmp	short loc_10018514
; ---------------------------------------------------------------------------

loc_100184BE:				; CODE XREF: sub_1001843A+7Ej
		push	ecx
		push	esi
		push	ebx
		call	sub_100183F9
		mov	eax, [esp+30h+arg_0]
		mov	ecx, esi
		sub	ecx, ebx
		sub	edi, esi
		sub	ecx, ebp
		sub	edi, ebp
		add	esp, 0Ch
		mov	byte ptr [eax+ebx], 0E9h
		mov	eax, [esp+24h+arg_0]
		mov	[eax+ebx+1], ecx
		mov	eax, [esp+24h+arg_0]
		mov	byte ptr [esi],	0E9h
		mov	[esi+1], edi
		cmp	eax, ebp
		jbe	short loc_10018506
		add	eax, 0FFFFFFFBh
		push	eax		; size_t
		lea	eax, [esi+5]
		push	0CCh		; int
		push	eax		; void *
		call	sub_1001841B
		add	esp, 0Ch

loc_10018506:				; CODE XREF: sub_1001843A+B5j
		xor	eax, eax
		jmp	short loc_1001851A
; ---------------------------------------------------------------------------

loc_1001850A:				; CODE XREF: sub_1001843A+60j
		mov	eax, ebp
		jmp	short loc_1001851A
; ---------------------------------------------------------------------------

loc_1001850E:				; CODE XREF: sub_1001843A+5Bj
		push	4
		jmp	short loc_10018514
; ---------------------------------------------------------------------------

loc_10018512:				; CODE XREF: sub_1001843A+52j
		push	3

loc_10018514:				; CODE XREF: sub_1001843A+82j
					; sub_1001843A+D6j
		pop	eax
		jmp	short loc_1001851A
; ---------------------------------------------------------------------------

loc_10018517:				; CODE XREF: sub_1001843A+Dj
					; sub_1001843A+19j ...
		xor	eax, eax
		inc	eax

loc_1001851A:				; CODE XREF: sub_1001843A+CEj
					; sub_1001843A+D2j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_1001843A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018522	proc near		; DATA XREF: .rdata:1001D7A0o
		call	sub_10014477
		add	eax, 20h
		retn
sub_10018522	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001852B	proc near		; DATA XREF: .rdata:1001D7B8o
		call	sub_10014477
		add	eax, 28h
		retn
sub_1001852B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018534	proc near		; CODE XREF: sub_10018622+B3p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_8]
		push	[ebp+arg_4]
		mov	[ebp+var_8], offset off_1001CAC8
		mov	[ebp+var_4], eax
		call	sub_10005CF8
		test	eax, eax
		setnz	al
		mov	esp, ebp
		pop	ebp
		retn
sub_10018534	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001855A	proc near		; CODE XREF: sub_10018622+68p
					; DATA XREF: .rdata:1001D794o

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 10h
		push	ebx
		mov	ebx, [esp+14h+arg_14]
		push	esi
		mov	esi, [esp+18h+arg_18]
		push	edi
		push	esi
		push	ebx
		push	[esp+24h+arg_10]
		mov	edi, ecx
		push	[esp+28h+arg_C]
		push	[esp+2Ch+arg_8]
		mov	eax, [edi]
		push	[esp+30h+arg_4]
		push	[esp+34h+arg_0]
		call	dword ptr [eax+14h]
		test	eax, eax
		js	loc_10018619
		push	ebp
		push	dword ptr [edi+8]
		lea	eax, [esi-20h]
		mov	ecx, edi
		push	ebx
		push	eax
		lea	ebp, [ebx+20h]
		push	ebp
		call	sub_10014480
		test	al, al
		jnz	short loc_100185AC
		mov	eax, 0C0000023h
		jmp	short loc_10018618
; ---------------------------------------------------------------------------

loc_100185AC:				; CODE XREF: sub_1001855A+49j
		push	4
		xor	eax, eax
		lea	ecx, [esp+24h+var_10]
		push	20h
		push	dword ptr [edi+4]
		mov	[esp+2Ch+var_10], al
		mov	[esp+2Ch+var_C], eax
		mov	[esp+2Ch+var_8], eax
		mov	[esp+2Ch+var_4], eax
		call	sub_10015B24
		mov	esi, eax
		test	esi, esi
		js	short loc_1001860D
		push	0
		push	20h
		push	ebx
		push	ebp
		push	dword ptr [edi+4]
		call	sub_1001843A
		add	esp, 14h
		cmp	eax, 2
		jnz	short loc_100185F1
		mov	esi, 0C0000023h
		jmp	short loc_1001860D
; ---------------------------------------------------------------------------

loc_100185F1:				; CODE XREF: sub_1001855A+8Ej
		test	eax, eax
		jz	short loc_100185FC
		mov	esi, 0C0000001h
		jmp	short loc_1001860D
; ---------------------------------------------------------------------------

loc_100185FC:				; CODE XREF: sub_1001855A+99j
		mov	ebx, [esp+20h+arg_1C]
		test	ebx, ebx
		jz	short loc_1001860D
		mov	edx, [edi]
		mov	ecx, edi
		call	dword ptr [edx+10h]
		mov	[ebx], eax

loc_1001860D:				; CODE XREF: sub_1001855A+78j
					; sub_1001855A+95j ...
		lea	ecx, [esp+20h+var_10]
		call	sub_10015F6F
		mov	eax, esi

loc_10018618:				; CODE XREF: sub_1001855A+50j
		pop	ebp

loc_10018619:				; CODE XREF: sub_1001855A+2Dj
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10h
		retn	20h
sub_1001855A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018622	proc near		; DATA XREF: .rdata:1001D7ACo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ebp
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		call	dword ptr [eax+10h]
		mov	ebp, [esp+8+arg_18]
		cmp	ebp, eax
		jnb	short loc_1001863D
		mov	eax, 0C0000023h
		jmp	loc_100186BF
; ---------------------------------------------------------------------------

loc_1001863D:				; CODE XREF: sub_10018622+Fj
		mov	eax, [esp+8+arg_10]
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	edi
		mov	edi, [esp+10h+arg_14]
		mov	[edi], ebx
		test	eax, eax
		jz	short loc_10018656
		mov	[edi+4], eax
		jmp	short loc_1001866D
; ---------------------------------------------------------------------------

loc_10018656:				; CODE XREF: sub_10018622+2Dj
		mov	edx, [esi]
		lea	eax, [edi+4]
		push	eax
		push	[esp+14h+arg_C]
		mov	ecx, esi
		push	[esp+18h+arg_4]
		call	dword ptr [edx+8]
		test	eax, eax
		js	short loc_100186BD

loc_1001866D:				; CODE XREF: sub_10018622+32j
		push	0
		lea	eax, [ebp-8]
		mov	ecx, esi
		push	eax
		lea	eax, [edi+8]
		mov	ebp, offset loc_100186C4
		push	eax
		push	ebp
		push	0
		push	dword ptr [esp+30h]
		push	[esp+34h+var_4]
		push	ebx
		call	sub_1001855A
		mov	ebx, eax
		test	ebx, ebx
		js	short loc_100186BB
		push	ebp
		push	edi
		mov	ecx, esi
		call	sub_10014477
		push	eax
		lea	eax, [edi+28h]
		mov	ecx, esi
		push	eax
		call	sub_10014480
		mov	edi, [esp+1Ch+arg_10]
		test	edi, edi
		jz	short loc_100186BB
		mov	eax, [esi]
		mov	ecx, esi
		call	dword ptr [eax+10h]
		mov	[edi], eax

loc_100186BB:				; CODE XREF: sub_10018622+71j
					; sub_10018622+8Ej
		mov	eax, ebx

loc_100186BD:				; CODE XREF: sub_10018622+49j
		pop	edi
		pop	ebx

loc_100186BF:				; CODE XREF: sub_10018622+16j
		pop	esi
		pop	ebp
		retn	20h
; ---------------------------------------------------------------------------

loc_100186C4:				; DATA XREF: sub_10018622+56o
		push	eax
		push	eax
		push	ebx
		push	ecx
		push	edx
		mov	ebx, [esp+38h+var_20]
		mov	edx, [esp+38h+var_24]
		mov	eax, [ebx]
		push	edx
		push	eax
		call	sub_10018534
		add	esp, 8
		test	eax, eax
		lea	edx, [ebx+8]
		jz	short loc_100186F7
		mov	ecx, [esp+38h+var_24]
		mov	[esp+38h+var_20], ecx
		mov	[esp+38h+var_28], edx
		pop	edx
		pop	ecx
		pop	ebx
		pop	eax
		retn	4
; ---------------------------------------------------------------------------

loc_100186F7:				; CODE XREF: sub_10018622+C0j
		mov	ecx, [ebx+4]
		mov	[esp+38h+var_20], edx
		mov	[esp+38h+var_28], ecx
		pop	edx
		pop	ecx
		pop	ebx
		pop	eax
		retn
sub_10018622	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10018707	proc near		; CODE XREF: sub_1000A988+5Ep
					; sub_1000AA55+5Ep ...
		xor	edx, edx
		mov	dword ptr [ecx], 2
		lea	eax, [ecx+4]
		inc	edx

loc_10018713:				; CODE XREF: sub_10018707+17j
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	edx
		jns	short loc_10018713
		mov	eax, ecx
		retn
sub_10018707	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018723	proc near		; CODE XREF: sub_10016099+15Fp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	eax, eax
		push	offset dword_1002FC04
		lea	esi, [edi+4]
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_0]
		mov	dword ptr [edi], offset	off_1002FBF8
		mov	[edi+10h], eax
		call	sub_1000ADE8
		push	offset dword_1002FC30
		mov	ecx, esi
		call	sub_1000ADE8
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_10018723	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018760	proc near		; DATA XREF: .rdata:1002FC2Co

var_18		= dword	ptr -18h
TargetHandle	= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+arg_0]
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10018783
		mov	eax, [esi]
		jmp	short loc_10018785
; ---------------------------------------------------------------------------

loc_10018783:				; CODE XREF: sub_10018760+1Dj
		mov	eax, esi

loc_10018785:				; CODE XREF: sub_10018760+21j
		mov	ecx, [ecx+10h]
		xor	ebx, ebx
		mov	[ebp+var_18], eax
		inc	ebx
		lea	eax, [ebp+var_18]
		mov	[ebp+var_10], ebx
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_10]
		push	eax
		push	0Eh
		mov	[ebp+var_C], ebx
		call	sub_100168E1
		and	[ebp+TargetHandle], 0
		lea	ecx, [ebp+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	esi		; int
		push	dword ptr [edi+4] ; int
		push	eax		; int
		call	sub_10018DDD
		mov	ecx, [ebp+TargetHandle]
		add	esp, 18h
		mov	[edi+18h], ecx
		mov	ecx, [ebp+var_4]
		mov	[edi+10h], eax
		xor	ecx, ebp
		pop	edi
		pop	esi
		mov	al, bl
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10018760	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100187DE	proc near		; DATA XREF: .rdata:1002FC58o

var_20		= dword	ptr -20h
TargetHandle	= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_0]
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10018803
		mov	eax, [esi]
		jmp	short loc_10018805
; ---------------------------------------------------------------------------

loc_10018803:				; CODE XREF: sub_100187DE+1Fj
		mov	eax, esi

loc_10018805:				; CODE XREF: sub_100187DE+23j
		lea	ecx, [ebp+var_18]
		mov	[ebp+var_20], eax
		call	sub_10018707
		mov	ecx, [ebx+10h]
		lea	eax, [ebp+var_20]
		mov	[ebp+var_10], eax
		lea	eax, [ebp+arg_8]
		mov	[ebp+var_8], eax
		lea	eax, [ebp+var_18]
		push	eax
		push	0Fh
		mov	[ebp+var_14], 1
		mov	[ebp+var_C], 2
		call	sub_100168E1
		and	[ebp+TargetHandle], 0
		lea	ecx, [ebp+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_8]	; int
		push	esi		; int
		push	dword ptr [edi+4] ; int
		push	eax		; int
		call	sub_10019099
		mov	ecx, [ebp+TargetHandle]
		add	esp, 14h
		mov	[edi+18h], ecx
		mov	ecx, [ebp+var_4]
		mov	[edi+10h], eax
		xor	ecx, ebp
		pop	edi
		pop	esi
		mov	al, 1
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_100187DE	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001886E	proc near		; DATA XREF: .rdata:1002FBFCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_4], 0Eh
		jnz	short loc_100188A0
		mov	eax, offset _TargetNtCreateEvent@24 ; TargetNtCreateEvent(x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1001889C
		mov	ecx, [esp+arg_0]
		push	14h		; int
		push	offset a_targetntcre_4 ; "_TargetNtCreateEvent@24"
		push	1		; int
		push	offset aNtcreateevent ;	"NtCreateEvent"
		push	offset aNtdll_dll_6 ; "ntdll.dll"
		call	sub_1000EC5D
		jmp	short locret_100188DC
; ---------------------------------------------------------------------------

loc_1001889C:				; CODE XREF: sub_1001886E+Ej
		xor	al, al
		jmp	short locret_100188DC
; ---------------------------------------------------------------------------

loc_100188A0:				; CODE XREF: sub_1001886E+5j
		cmp	[esp+arg_4], 0Fh
		push	ebx
		jnz	short loc_100188D7
		xor	ebx, ebx
		mov	eax, offset _TargetNtOpenEvent@16 ; TargetNtOpenEvent(x,x,x,x)
		inc	ebx
		test	eax, eax
		jz	short loc_100188D1
		mov	ecx, [esp+4+arg_0]
		push	15h		; int
		push	offset a_targetntop_14 ; "_TargetNtOpenEvent@16"
		push	ebx		; int
		push	offset aNtopenevent ; "NtOpenEvent"
		push	offset aNtdll_dll_6 ; "ntdll.dll"
		call	sub_1000EC5D
		jmp	short loc_100188D3
; ---------------------------------------------------------------------------

loc_100188D1:				; CODE XREF: sub_1001886E+44j
		xor	al, al

loc_100188D3:				; CODE XREF: sub_1001886E+61j
		test	al, al
		jnz	short loc_100188D9

loc_100188D7:				; CODE XREF: sub_1001886E+38j
		xor	ebx, ebx

loc_100188D9:				; CODE XREF: sub_1001886E+67j
		mov	al, bl
		pop	ebx

locret_100188DC:			; CODE XREF: sub_1001886E+2Cj
					; sub_1001886E+30j
		retn	8
sub_1001886E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100188DF(int,	int, int, void *, int)
sub_100188DF	proc near		; CODE XREF: sub_10018A94+6Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	ecx, [ebp+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_100188F7
		push	4
		pop	eax
		jmp	short loc_1001896C
; ---------------------------------------------------------------------------

loc_100188F7:				; CODE XREF: sub_100188DF+11j
		mov	eax, [ebp+arg_4]
		lea	ecx, [ebp+var_4]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_8]
		xor	ebx, ebx
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	dword ptr [edi+3Ch], 2
		push	1		; int
		mov	dword ptr [edi+44h], 64h
		mov	esi, [esi]
		push	ebx		; char
		mov	[ebp+var_4], esi
		call	sub_1000B44B
		push	eax		; size_t
		push	esi		; void *
		push	ebx		; int
		mov	ecx, edi
		call	sub_10012964
		test	al, al
		jz	short loc_10018947
		push	2		; int
		push	ebx		; char
		push	4		; size_t
		push	[ebp+arg_C]	; void *
		mov	ecx, edi
		push	1		; int
		call	sub_10012964
		test	al, al
		jnz	short loc_1001894C

loc_10018947:				; CODE XREF: sub_100188DF+51j
		push	4
		pop	eax
		jmp	short loc_1001896A
; ---------------------------------------------------------------------------

loc_1001894C:				; CODE XREF: sub_100188DF+66j
		push	[ebp+arg_10]
		mov	ecx, [ebp+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10018968
		mov	ecx, [ebp+arg_0]
		push	edi
		call	sub_10017671

loc_10018968:				; CODE XREF: sub_100188DF+7Ej
		mov	eax, esi

loc_1001896A:				; CODE XREF: sub_100188DF+6Bj
		pop	esi
		pop	ebx

loc_1001896C:				; CODE XREF: sub_100188DF+16j
		pop	edi
		mov	esp, ebp
		pop	ebp
		retn
sub_100188DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10018971(int,	int, int, void *, void *, int)
sub_10018971	proc near		; CODE XREF: sub_10018A1C+5Fp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	ecx, [ebp+arg_0]
		push	edi
		call	sub_1001768F
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1001898C
		push	4
		pop	eax
		jmp	loc_10018A17
; ---------------------------------------------------------------------------

loc_1001898C:				; CODE XREF: sub_10018971+11j
		mov	eax, [ebp+arg_4]
		lea	ecx, [ebp+var_4]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_8]
		xor	ebx, ebx
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	dword ptr [edi+3Ch], 3
		push	1		; int
		mov	dword ptr [edi+44h], 70h
		mov	esi, [esi]
		push	ebx		; char
		mov	[ebp+var_4], esi
		call	sub_1000B44B
		push	eax		; size_t
		push	esi		; void *
		push	ebx		; int
		mov	ecx, edi
		call	sub_1000B23B
		test	al, al
		jnz	short loc_100189CC
		push	4
		pop	eax
		jmp	short loc_10018A15
; ---------------------------------------------------------------------------

loc_100189CC:				; CODE XREF: sub_10018971+54j
		push	2		; int
		push	ebx		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[ebp+arg_C]	; void *
		mov	ecx, edi
		push	1		; int
		call	sub_1000B23B
		test	al, al
		jz	short loc_10018A13
		push	2		; int
		push	ebx		; char
		push	esi		; size_t
		push	[ebp+arg_10]	; void *
		mov	ecx, edi
		push	2		; int
		call	sub_1000B23B
		test	al, al
		jz	short loc_10018A13
		push	[ebp+arg_14]
		mov	ecx, [ebp+arg_0]
		push	edi
		call	sub_100175C5
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10018A13
		mov	ecx, [ebp+arg_0]
		push	edi
		call	sub_10017671

loc_10018A13:				; CODE XREF: sub_10018971+70j
					; sub_10018971+84j ...
		mov	eax, esi

loc_10018A15:				; CODE XREF: sub_10018971+59j
		pop	esi
		pop	ebx

loc_10018A17:				; CODE XREF: sub_10018971+16j
		pop	edi
		mov	esp, ebp
		pop	ebp
		retn
sub_10018971	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018A1C	proc near		; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+FEp

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_10]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_C]
		xor	ebx, ebx
		push	edi
		mov	edi, [ebp+arg_10]
		inc	ebx
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_14]
		push	ecx
		push	0Eh
		mov	[ebp+var_10], ebx
		mov	[ebp+var_C], ebx
		mov	[ebp+var_8], eax
		call	sub_100119BE
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10018A5F
		mov	eax, ebx
		jmp	short loc_10018A83
; ---------------------------------------------------------------------------

loc_10018A5F:				; CODE XREF: sub_10018A1C+3Dj
		push	esi
		lea	ecx, [ebp+var_1C]
		call	sub_100175A8
		push	edi		; int
		lea	eax, [ebp+arg_4]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+var_14]
		push	eax		; int
		lea	eax, [ebp+var_1C]
		push	0Eh		; int
		push	eax		; int
		call	sub_10018971
		add	esp, 18h

loc_10018A83:				; CODE XREF: sub_10018A1C+41j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10018A1C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018A94	proc near		; CODE XREF: TargetNtOpenEvent(x,x,x,x)+F1p

var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_18]
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		mov	edi, [ebp+arg_C]
		mov	[ebp+var_1C], eax
		call	sub_10018707
		lea	eax, [ebp+var_1C]
		mov	[ebp+var_14], 1
		lea	ecx, [ebp+var_18]
		mov	[ebp+var_10], eax
		push	ecx
		lea	eax, [ebp+arg_4]
		mov	[ebp+var_C], 2
		push	0Fh
		mov	[ebp+var_8], eax
		call	sub_100119BE
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10018AEA
		xor	eax, eax
		inc	eax
		jmp	short loc_10018B0A
; ---------------------------------------------------------------------------

loc_10018AEA:				; CODE XREF: sub_10018A94+4Fj
		push	esi
		lea	ecx, [ebp+var_24]
		call	sub_100175A8
		push	edi		; int
		lea	eax, [ebp+arg_4]
		push	eax		; void *
		lea	eax, [ebp+var_1C]
		push	eax		; int
		lea	eax, [ebp+var_24]
		push	0Fh		; int
		push	eax		; int
		call	sub_100188DF
		add	esp, 14h

loc_10018B0A:				; CODE XREF: sub_10018A94+54j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10018A94	endp

; Exported entry  21. _TargetNtCreateEvent@24

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtCreateEvent(x, x, x, x, x, x)
		public _TargetNtCreateEvent@24
_TargetNtCreateEvent@24	proc near	; DATA XREF: sub_1001886E+7o
					; .rdata:off_10030468o

var_80		= byte ptr -80h
var_7C		= dword	ptr -7Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	70h
		push	offset stru_10030398
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	edi, [ebp+arg_4]
		mov	[ebp+var_68], edi
		mov	esi, [ebp+arg_C]
		mov	[ebp+var_60], esi
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		push	esi
		push	[ebp+arg_8]
		push	edi
		call	eax
		mov	ebx, eax
		mov	[ebp+var_58], ebx
		cmp	ebx, 0C0000022h
		jnz	loc_10018C7A
		test	esi, esi
		jz	loc_10018C7A
		mov	ecx, [esi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtcreatevent ; "NtCreatEvent"
		call	sub_10002D0B
		add	esp, 0Ch
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jnz	short loc_10018B90
		mov	eax, ebx
		jmp	loc_10018C7A
; ---------------------------------------------------------------------------

loc_10018B90:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+6Dj
		push	1
		push	4
		push	edi
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_10018C78
		call	sub_10015CC7
		mov	[ebp+var_5C], eax
		test	eax, eax
		jz	loc_10018C78
		push	6
		pop	ecx
		lea	edi, [ebp+var_80]
		rep movsd
		xor	edi, edi
		mov	[ebp+var_7C], edi
		mov	[ebp+var_54], edi
		mov	[ebp+var_64], edi
		push	edi
		lea	eax, [ebp+var_64]
		push	eax
		lea	eax, [ebp+var_54]
		push	eax
		lea	eax, [ebp+var_80]
		push	eax
		call	sub_1001592A
		add	esp, 10h
		test	eax, eax
		js	loc_10018C78
		cmp	[ebp+var_54], edi
		jz	loc_10018C78
		mov	[ebp+var_50], edi
		push	30h		; size_t
		push	edi		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		mov	[ebp+var_48], 0C0000022h
		lea	eax, [ebp+var_50]
		push	eax
		push	[ebp+var_5C]
		push	[ebp+arg_10]
		mov	eax, [ebp+arg_14]
		movzx	eax, al
		push	eax
		push	[ebp+var_54]
		call	sub_10018A1C
		mov	esi, eax
		push	edi
		push	[ebp+var_54]
		call	sub_100158E4
		add	esp, 28h
		test	esi, esi
		jz	short loc_10018C34
		mov	ebx, [ebp+var_48]
		jmp	short loc_10018C78
; ---------------------------------------------------------------------------

loc_10018C34:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+113j
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebp+var_40]
		mov	ecx, [ebp+var_68]
		mov	[ecx], eax
		mov	ebx, edi
		mov	[ebp+var_58], ebx
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ecx, [ebp+var_60]
		mov	ecx, [ecx+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtcreateevent ;	"NtCreateEvent"
		call	sub_10002C02
		add	esp, 0Ch
		jmp	short loc_10018C78
; ---------------------------------------------------------------------------

loc_10018C67:				; DATA XREF: .rdata:stru_10030398o
		xor	eax, eax	; Exception filter 0 for function 10018B1A
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10018C6B:				; DATA XREF: .rdata:stru_10030398o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10018B1A
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ebx, [ebp+var_58]

loc_10018C78:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+85j
					; TargetNtCreateEvent(x,x,x,x,x,x)+95j	...
		mov	eax, ebx

loc_10018C7A:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+33j
					; TargetNtCreateEvent(x,x,x,x,x,x)+3Bj	...
		call	__SEH_epilog4_GS
		retn	18h
_TargetNtCreateEvent@24	endp

; Exported entry  25. _TargetNtOpenEvent@16

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenEvent(x, x, x, x)
		public _TargetNtOpenEvent@16
_TargetNtOpenEvent@16 proc near		; DATA XREF: sub_1001886E+3Co
					; .rdata:off_10030468o

var_80		= byte ptr -80h
var_7C		= dword	ptr -7Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	70h
		push	offset stru_100303B8
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	edi, [ebp+arg_4]
		mov	[ebp+var_68], edi
		mov	esi, [ebp+arg_C]
		mov	[ebp+var_60], esi
		push	esi
		push	[ebp+arg_8]
		push	edi
		call	eax
		mov	ebx, eax
		mov	[ebp+var_58], ebx
		cmp	ebx, 0C0000022h
		jnz	loc_10018DD5
		test	esi, esi
		jz	loc_10018DD5
		mov	ecx, [esi+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtopenevent ; "NtOpenEvent"
		call	sub_10002D0B
		add	esp, 0Ch
		call	sub_10015880
		mov	edx, [eax]
		mov	ecx, eax
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019A9E
		test	al, al
		jnz	short loc_10018CF2
		mov	eax, ebx
		jmp	loc_10018DD5
; ---------------------------------------------------------------------------

loc_10018CF2:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+67j
		push	1
		push	4
		push	edi
		call	sub_10015FEE
		add	esp, 0Ch
		test	al, al
		jz	loc_10018DD3
		call	sub_10015CC7
		mov	[ebp+var_5C], eax
		test	eax, eax
		jz	loc_10018DD3
		push	6
		pop	ecx
		lea	edi, [ebp+var_80]
		rep movsd
		xor	edi, edi
		mov	[ebp+var_7C], edi
		mov	[ebp+var_54], edi
		mov	[ebp+var_64], edi
		push	edi
		lea	eax, [ebp+var_64]
		push	eax
		lea	eax, [ebp+var_54]
		push	eax
		lea	eax, [ebp+var_80]
		push	eax
		call	sub_1001592A
		add	esp, 10h
		test	eax, eax
		js	loc_10018DD3
		cmp	[ebp+var_54], edi
		jz	loc_10018DD3
		mov	[ebp+var_50], edi
		push	30h		; size_t
		push	edi		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		mov	[ebp+var_48], 0C0000022h
		lea	eax, [ebp+var_50]
		push	eax
		push	[ebp+var_5C]
		push	[ebp+arg_8]
		push	[ebp+var_54]
		call	sub_10018A94
		mov	esi, eax
		push	edi
		push	[ebp+var_54]
		call	sub_100158E4
		add	esp, 24h
		test	esi, esi
		jz	short loc_10018D8F
		mov	ebx, [ebp+var_48]
		jmp	short loc_10018DD3
; ---------------------------------------------------------------------------

loc_10018D8F:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+106j
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebp+var_40]
		mov	ecx, [ebp+var_68]
		mov	[ecx], eax
		mov	ebx, edi
		mov	[ebp+var_58], ebx
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ecx, [ebp+var_60]
		mov	ecx, [ecx+8]
		movzx	eax, word ptr [ecx]
		push	eax		; int
		push	dword ptr [ecx+4] ; void *
		push	offset aNtopenevent ; "NtOpenEvent"
		call	sub_10002C02
		add	esp, 0Ch
		jmp	short loc_10018DD3
; ---------------------------------------------------------------------------

loc_10018DC2:				; DATA XREF: .rdata:stru_100303B8o
		xor	eax, eax	; Exception filter 0 for function 10018C82
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10018DC6:				; DATA XREF: .rdata:stru_100303B8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10018C82
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ebx, [ebp+var_58]

loc_10018DD3:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+7Fj
					; TargetNtOpenEvent(x,x,x,x)+8Fj ...
		mov	eax, ebx

loc_10018DD5:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+2Dj
					; TargetNtOpenEvent(x,x,x,x)+35j ...
		call	__SEH_epilog4_GS
		retn	10h
_TargetNtOpenEvent@16 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10018DDD(int,	int, int, int, int, LPHANDLE lpTargetHandle)
sub_10018DDD	proc near		; CODE XREF: sub_10018760+58p

var_28		= byte ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
hSourceHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
lpTargetHandle	= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	ebx
		lea	eax, [ebp+var_8]
		xor	ebx, ebx
		push	eax		; int
		push	offset aNtcreateevent ;	"NtCreateEvent"
		mov	[ebp+var_8], ebx
		call	sub_1001A242
		cmp	[ebp+arg_0], 3
		pop	ecx
		pop	ecx
		jz	short loc_10018E06
		xor	eax, eax
		jmp	loc_10018E88
; ---------------------------------------------------------------------------

loc_10018E06:				; CODE XREF: sub_10018DDD+20j
		lea	eax, [ebp+arg_0]
		mov	[ebp+arg_0], ebx
		push	eax
		call	sub_10018F87
		pop	ecx
		test	eax, eax
		jnz	short loc_10018E88
		push	esi
		push	edi
		push	6
		pop	ecx
		lea	edi, [ebp+var_28]
		mov	[ebp+var_10], ebx
		rep stosd
		lea	eax, [ebp+var_10]
		mov	[ebp+var_C], ebx
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		push	[ebp+arg_0]
		push	40h
		push	[ebp+arg_8]
		call	sub_1001700A
		add	esp, 14h
		mov	[ebp+hSourceHandle], ebx
		lea	eax, [ebp+var_28]
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	eax
		push	1F0003h
		lea	eax, [ebp+hSourceHandle]
		push	eax
		call	[ebp+var_8]
		mov	esi, eax
		cmp	[ebp+hSourceHandle], ebx
		jz	short loc_10018E86
		mov	eax, [ebp+arg_4]
		push	3		; dwOptions
		push	ebx		; bInheritHandle
		push	ebx		; dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		push	dword ptr [eax]	; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10018E86
		mov	eax, esi

loc_10018E86:				; CODE XREF: sub_10018DDD+80j
					; sub_10018DDD+A5j
		pop	edi
		pop	esi

loc_10018E88:				; CODE XREF: sub_10018DDD+24j
					; sub_10018DDD+38j
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10018DDD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10018E8D(void	*, int,	int)
sub_10018E8D	proc near		; CODE XREF: sub_1001651A+A3p

var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_2C		= byte ptr -2Ch
var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 40h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+var_40], 0
		lea	ecx, [ebp+var_1C]
		push	ebx
		mov	ebx, [ebp+arg_8]
		push	edi
		mov	edi, [ebp+arg_0]
		push	edi		; void *
		call	sub_10001E8D
		cmp	[ebp+var_C], 0
		jz	loc_10018F67
		cmp	[ebp+arg_4], 9
		jz	short loc_10018ECC
		cmp	[ebp+arg_4], 0Ah
		jnz	loc_10018F67

loc_10018ECC:				; CODE XREF: sub_10018E8D+33j
		push	3
		lea	ecx, [ebp+var_3C]
		call	sub_10011053
		push	1
		push	edi
		push	0
		push	0
		lea	ecx, [ebp+var_3C]
		call	sub_10011215
		test	al, al
		jz	short loc_10018F5B
		cmp	[ebp+arg_4], 0Ah
		jnz	short loc_10018F02
		push	1
		push	7FEDFFFFh
		push	1
		push	1
		lea	ecx, [ebp+var_3C]
		call	sub_10011174

loc_10018F02:				; CODE XREF: sub_10018E8D+60j
		lea	eax, [ebp+var_3C]
		mov	ecx, ebx
		push	eax
		push	0Fh
		call	sub_100111C8
		test	al, al
		jz	short loc_10018F5B
		cmp	[ebp+arg_4], 0Ah
		jz	short loc_10018F4F
		push	3
		lea	ecx, [ebp+var_2C]
		call	sub_10011053
		push	1
		push	edi
		push	0
		push	0
		lea	ecx, [ebp+var_2C]
		call	sub_10011215
		test	al, al
		jz	short loc_10018F53
		lea	eax, [ebp+var_2C]
		mov	ecx, ebx
		push	eax
		push	0Eh
		call	sub_100111C8
		test	al, al
		jz	short loc_10018F53
		lea	ecx, [ebp+var_2C]
		call	sub_10011108

loc_10018F4F:				; CODE XREF: sub_10018E8D+8Aj
		mov	bl, 1
		jmp	short loc_10018F5D
; ---------------------------------------------------------------------------

loc_10018F53:				; CODE XREF: sub_10018E8D+A7j
					; sub_10018E8D+B8j
		lea	ecx, [ebp+var_2C]
		call	sub_10011108

loc_10018F5B:				; CODE XREF: sub_10018E8D+5Aj
					; sub_10018E8D+84j
		xor	bl, bl

loc_10018F5D:				; CODE XREF: sub_10018E8D+C4j
		lea	ecx, [ebp+var_3C]
		call	sub_10011108
		jmp	short loc_10018F69
; ---------------------------------------------------------------------------

loc_10018F67:				; CODE XREF: sub_10018E8D+29j
					; sub_10018E8D+39j
		xor	bl, bl

loc_10018F69:				; CODE XREF: sub_10018E8D+D8j
		push	0		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1
		mov	ecx, [ebp+var_4]
		mov	al, bl
		pop	edi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10018E8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018F87	proc near		; CODE XREF: sub_10018DDD+30p
					; sub_10019099+2Dp

var_74		= byte ptr -74h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
pSessionId	= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_34		= byte ptr -34h
var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 74h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		xor	ebx, ebx
		mov	[ebp+var_50], ebx
		mov	eax, dword_10033DD8
		push	esi
		mov	esi, [ebp+arg_0]
		test	eax, eax
		jz	short loc_10018FB3
		mov	[esi], eax
		xor	eax, eax
		jmp	loc_10019089
; ---------------------------------------------------------------------------

loc_10018FB3:				; CODE XREF: sub_10018F87+21j
		push	edi
		lea	eax, [ebp+var_50]
		mov	[ebp+var_50], ebx
		push	eax		; int
		push	offset aNtopendirector ; "NtOpenDirectoryObject"
		call	sub_1001A242
		pop	ecx
		pop	ecx
		lea	eax, [ebp+pSessionId]
		mov	[ebp+pSessionId], ebx
		push	eax		; pSessionId
		call	ds:GetCurrentProcessId
		push	eax		; dwProcessId
		call	ds:ProcessIdToSessionId
		xor	eax, eax
		mov	[ebp+var_8], 7
		push	offset aSessionsBnolin ; "\\Sessions\\BNOLINKS"
		lea	ecx, [ebp+var_34]
		mov	[ebp+var_C], ebx
		mov	[ebp+var_1C], ax
		call	sub_10001E8D
		lea	eax, [ebp+var_1C]
		push	eax
		push	[ebp+pSessionId] ; ArgList
		lea	eax, [ebp+var_4C]
		push	offset aD	; "%d"
		push	eax		; int
		call	sub_100049A2
		add	esp, 0Ch
		push	eax
		lea	eax, [ebp+var_34]
		push	eax
		call	sub_1001913E
		add	esp, 0Ch
		lea	ecx, [ebp+var_4C] ; void *
		mov	edi, eax
		push	ebx		; int
		push	1		; char
		call	sub_100022C1
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1
		test	edi, edi
		jnz	short loc_1001907B
		push	6
		pop	ecx
		xor	eax, eax
		mov	[ebp+var_5C], ebx
		lea	edi, [ebp+var_74]
		mov	[ebp+var_58], ebx
		rep stosd
		lea	eax, [ebp+var_5C]
		push	eax
		lea	eax, [ebp+var_74]
		push	eax
		push	ebx
		lea	eax, [ebp+var_1C]
		push	40h
		push	eax
		call	sub_1001700A
		add	esp, 14h
		lea	eax, [ebp+var_74]
		push	eax
		push	0Fh
		push	offset dword_10033DD8
		call	[ebp+var_50]
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1001907B
		mov	eax, dword_10033DD8
		mov	[esi], eax

loc_1001907B:				; CODE XREF: sub_10018F87+B0j
					; sub_10018F87+EBj
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1
		mov	eax, edi
		pop	edi

loc_10019089:				; CODE XREF: sub_10018F87+27j
		mov	ecx, [ebp+var_4]
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10018F87	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10019099(int,	int, int, int, LPHANDLE	lpTargetHandle)
sub_10019099	proc near		; CODE XREF: sub_100187DE+6Ap

var_28		= byte ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
hSourceHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
lpTargetHandle	= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	ebx
		lea	eax, [ebp+var_8]
		xor	ebx, ebx
		push	eax		; int
		push	offset aNtopenevent ; "NtOpenEvent"
		mov	[ebp+var_8], ebx
		call	sub_1001A242
		cmp	[ebp+arg_0], 3
		pop	ecx
		pop	ecx
		jz	short loc_100190BF
		xor	eax, eax
		jmp	short loc_10019139
; ---------------------------------------------------------------------------

loc_100190BF:				; CODE XREF: sub_10019099+20j
		lea	eax, [ebp+arg_0]
		mov	[ebp+arg_0], ebx
		push	eax
		call	sub_10018F87
		pop	ecx
		test	eax, eax
		jnz	short loc_10019139
		push	esi
		push	edi
		push	6
		pop	ecx
		lea	edi, [ebp+var_28]
		mov	[ebp+var_10], ebx
		rep stosd
		lea	eax, [ebp+var_10]
		mov	[ebp+var_C], ebx
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		push	[ebp+arg_0]
		push	40h
		push	[ebp+arg_8]
		call	sub_1001700A
		add	esp, 14h
		mov	[ebp+hSourceHandle], ebx
		lea	eax, [ebp+var_28]
		push	eax
		push	[ebp+arg_C]
		lea	eax, [ebp+hSourceHandle]
		push	eax
		call	[ebp+var_8]
		mov	esi, eax
		cmp	[ebp+hSourceHandle], ebx
		jz	short loc_10019137
		mov	eax, [ebp+arg_4]
		push	3		; dwOptions
		push	ebx		; bInheritHandle
		push	ebx		; dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		push	dword ptr [eax]	; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10019137
		mov	eax, esi

loc_10019137:				; CODE XREF: sub_10019099+75j
					; sub_10019099+9Aj
		pop	edi
		pop	esi

loc_10019139:				; CODE XREF: sub_10019099+24j
					; sub_10019099+35j
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10019099	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001913E	proc near		; CODE XREF: sub_10018F87+8Ep

var_64		= byte ptr -64h
var_4C		= byte ptr -4Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 64h
		push	ebx
		push	edi
		lea	eax, [ebp+var_18]
		xor	ebx, ebx
		push	eax		; int
		mov	[ebp+var_1C], ebx
		push	offset aNtopendirector ; "NtOpenDirectoryObject"
		mov	[ebp+var_18], ebx
		call	sub_1001A242
		lea	eax, [ebp+var_14]
		mov	[ebp+var_14], ebx
		push	eax		; int
		push	offset aNtquerysymboli ; "NtQuerySymbolicLinkObject"
		call	sub_1001A242
		lea	eax, [ebp+var_1C]
		mov	[ebp+var_1C], ebx
		push	eax		; int
		push	offset aNtopensymbolic ; "NtOpenSymbolicLinkObject"
		call	sub_1001A242
		lea	eax, [ebp+var_C]
		mov	[ebp+var_C], ebx
		push	eax		; int
		push	offset aNtclose	; "NtClose"
		call	sub_1001A242
		push	6
		pop	ecx
		xor	eax, eax
		mov	[ebp+var_2C], ebx
		lea	edi, [ebp+var_4C]
		mov	[ebp+var_28], ebx
		rep stosd
		lea	eax, [ebp+var_2C]
		push	eax
		lea	eax, [ebp+var_4C]
		push	eax
		push	ebx
		push	40h
		push	[ebp+arg_0]
		call	sub_1001700A
		add	esp, 34h
		mov	[ebp+var_10], ebx
		lea	eax, [ebp+var_4C]
		push	eax
		push	1
		lea	eax, [ebp+var_10]
		push	eax
		call	[ebp+var_18]
		test	eax, eax
		jnz	loc_1001929D
		push	esi
		push	6
		pop	ecx
		lea	edi, [ebp+var_64]
		mov	[ebp+var_34], ebx
		rep stosd
		lea	eax, [ebp+var_34]
		mov	[ebp+var_30], ebx
		push	eax
		lea	eax, [ebp+var_64]
		push	eax
		push	[ebp+var_10]
		push	40h
		push	[ebp+arg_4]
		call	sub_1001700A
		add	esp, 14h
		mov	[ebp+var_4], ebx
		lea	eax, [ebp+var_64]
		push	eax
		push	80000000h
		lea	eax, [ebp+var_4]
		push	eax
		call	[ebp+var_1C]
		push	[ebp+var_10]
		mov	esi, eax
		call	[ebp+var_C]
		test	esi, esi
		jnz	loc_1001929A
		lea	eax, [ebp+var_8]
		mov	[ebp+var_24], ebx
		push	eax
		lea	eax, [ebp+var_24]
		mov	[ebp+var_20], ebx
		push	eax
		push	[ebp+var_4]
		mov	[ebp+var_8], ebx
		call	[ebp+var_14]
		mov	esi, eax
		cmp	esi, 0C0000023h
		jz	short loc_10019240
		push	[ebp+var_4]
		call	[ebp+var_C]
		jmp	short loc_1001929A
; ---------------------------------------------------------------------------

loc_10019240:				; CODE XREF: sub_1001913E+F8j
		xor	eax, eax
		xor	ecx, ecx
		mov	word ptr [ebp+var_24], ax
		mov	eax, [ebp+var_8]
		mov	word ptr [ebp+var_24+2], ax
		movzx	eax, ax
		push	2
		inc	eax
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_1001AAE8
		pop	ecx
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_24]
		push	eax
		push	[ebp+var_4]
		call	[ebp+var_14]
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1001928B
		push	[ebp+var_8]	; int
		mov	ecx, [ebp+arg_8]
		push	[ebp+var_20]	; void *
		call	sub_100023C8

loc_1001928B:				; CODE XREF: sub_1001913E+13Dj
		push	[ebp+var_4]
		call	[ebp+var_C]
		push	[ebp+var_20]	; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_1001929A:				; CODE XREF: sub_1001913E+D3j
					; sub_1001913E+100j
		mov	eax, esi
		pop	esi

loc_1001929D:				; CODE XREF: sub_1001913E+89j
		pop	edi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1001913E	endp

; Exported entry  24. _TargetNtMapViewOfSection@44

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetNtMapViewOfSection(x,	x, x, x, x, x, x, x, x,	x, x)
		public _TargetNtMapViewOfSection@44
_TargetNtMapViewOfSection@44 proc near	; DATA XREF: .rdata:off_10030468o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch

		push	ebp
		push	edi
		push	[esp+8+arg_28]
		mov	edi, [esp+0Ch+arg_C]
		push	[esp+0Ch+arg_24]
		push	[esp+10h+arg_20]
		push	[esp+14h+arg_1C]
		push	[esp+18h+arg_18]
		push	[esp+1Ch+arg_14]
		push	[esp+20h+arg_10]
		push	edi
		push	[esp+28h+arg_8]
		push	[esp+2Ch+arg_4]
		call	[esp+30h+arg_0]
		cmp	dword_10033DE0,	1
		mov	ebp, eax
		jnz	short loc_100192FA
		call	sub_10015880
		mov	ecx, eax
		mov	edx, [eax]
		call	dword ptr [edx+8]
		mov	ecx, eax
		call	sub_10019B61
		mov	dword_10033DE0,	2

loc_100192FA:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+38j
		test	ebp, ebp
		js	loc_100193B1
		call	sub_10015D9C
		test	al, al
		jz	loc_100193B1
		push	[esp+8+arg_8]
		call	sub_10015DE3
		pop	ecx
		test	al, al
		jz	loc_100193B1
		push	[esp+8+arg_1C]
		push	[esp+0Ch+arg_18]
		push	edi
		push	[esp+14h+arg_4]
		call	sub_10015E89
		add	esp, 10h
		test	al, al
		jz	short loc_100193B1
		push	ebx
		push	esi
		lea	eax, [esp+10h+arg_28]
		push	eax
		push	dword ptr [edi]
		call	sub_10015CD9
		push	dword ptr [edi]
		mov	esi, eax
		call	sub_10015C5B
		add	esp, 0Ch
		mov	ebx, eax
		test	esi, esi
		jnz	short loc_1001936A
		test	byte ptr [esp+10h+arg_28], 4
		jz	short loc_1001936A
		push	ebx
		call	sub_10015BA7
		pop	ecx
		mov	esi, eax

loc_1001936A:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+B5j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+BCj
		call	sub_1000F8EF
		test	eax, eax
		jz	short loc_10019393
		push	dword ptr [edi]
		mov	ecx, eax
		push	esi
		push	ebx
		call	sub_1000FA0E
		test	al, al
		jnz	short loc_10019393
		push	dword ptr [edi]
		push	[esp+14h+arg_8]
		call	dword_10033D60
		mov	ebp, 0C0000001h

loc_10019393:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+CEj
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+DDj
		test	esi, esi
		jz	short loc_100193A1
		push	0
		push	esi
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_100193A1:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+F2j
		test	ebx, ebx
		jz	short loc_100193AF
		push	0
		push	ebx
		call	sub_100158E4
		pop	ecx
		pop	ecx

loc_100193AF:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+100j
		pop	esi
		pop	ebx

loc_100193B1:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+59j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+66j ...
		cmp	dword_10033DE0,	0
		jnz	short loc_100193C4
		mov	dword_10033DE0,	1

loc_100193C4:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+115j
		pop	edi
		mov	eax, ebp
		pop	ebp
		retn	2Ch
_TargetNtMapViewOfSection@44 endp

; Exported entry  39. _TargetNtUnmapViewOfSection@12

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtUnmapViewOfSection(x, x, x)
		public _TargetNtUnmapViewOfSection@12
_TargetNtUnmapViewOfSection@12 proc near ; DATA	XREF: .rdata:off_10030468o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		test	esi, esi
		js	short loc_10019400
		push	[ebp+arg_4]
		call	sub_10015DE3
		pop	ecx
		test	al, al
		jz	short loc_100193FE
		call	sub_1000F8EF
		test	eax, eax
		jz	short loc_100193FE
		push	[ebp+arg_8]
		mov	ecx, eax
		call	sub_1000FAD7

loc_100193FE:				; CODE XREF: TargetNtUnmapViewOfSection(x,x,x)+1Ej
					; TargetNtUnmapViewOfSection(x,x,x)+27j
		mov	eax, esi

loc_10019400:				; CODE XREF: TargetNtUnmapViewOfSection(x,x,x)+11j
		pop	esi
		pop	ebp
		retn	0Ch
_TargetNtUnmapViewOfSection@12 endp


; =============== S U B	R O U T	I N E =======================================


sub_10019405	proc near		; CODE XREF: sub_100095AD+3A5p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		push	edi
		mov	esi, ecx
		call	unknown_libname_5 ; Microsoft VisualC 2-11/net runtime
		push	[esp+8+arg_4]
		lea	ecx, [esi+10h]
		xor	edi, edi
		mov	[ecx], edi
		call	sub_10004DE8
		push	[esp+8+arg_0]
		lea	ecx, [esi+14h]
		mov	[ecx], edi
		call	sub_10004DE8
		mov	eax, [esp+8+arg_8]
		mov	[esi+18h], edi
		mov	[esi+1Ch], eax
		mov	eax, [esp+8+arg_C]
		mov	[esi+20h], edi
		mov	[esi+24h], eax
		mov	eax, esi
		mov	[esi+28h], edi
		mov	[esi+2Ch], edi
		pop	edi
		pop	esi
		retn	10h
sub_10019405	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001944D	proc near		; CODE XREF: sub_10009571+23p
					; sub_1001627A+28p ...

ExitCode	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		xor	ebx, ebx
		mov	esi, ecx
		push	edi
		mov	[ebp+ExitCode],	ebx
		call	sub_10006A86
		test	al, al
		jz	short loc_100194AA
		push	32h		; dwMilliseconds
		push	dword ptr [esi]	; hHandle
		call	ds:WaitForSingleObject
		lea	eax, [ebp+ExitCode]
		push	eax		; lpExitCode
		push	dword ptr [esi]	; hProcess
		call	ds:GetExitCodeProcess
		test	eax, eax
		jz	short loc_10019487
		cmp	[ebp+ExitCode],	103h
		jnz	short loc_100194AA

loc_10019487:				; CODE XREF: sub_1001944D+2Fj
		push	dword ptr [esi+18h]
		call	sub_10004DD3
		pop	ecx
		test	al, al
		jz	short loc_1001949C
		lea	ecx, [esi+18h]
		call	sub_10006ADC

loc_1001949C:				; CODE XREF: sub_1001944D+45j
		lea	edi, [esi+20h]
		mov	ecx, esi
		mov	[edi], ebx
		call	sub_10006B48
		jmp	short loc_100194BF
; ---------------------------------------------------------------------------

loc_100194AA:				; CODE XREF: sub_1001944D+15j
					; sub_1001944D+38j
		lea	edi, [esi+20h]
		mov	eax, [edi]
		mov	[edi], ebx
		test	eax, eax
		jz	short loc_100194BD
		push	eax		; void *
		mov	ecx, edi
		call	sub_10019501

loc_100194BD:				; CODE XREF: sub_1001944D+66j
		mov	[edi], ebx

loc_100194BF:				; CODE XREF: sub_1001944D+5Bj
		cmp	[esi+2Ch], ebx
		jz	short loc_100194CE
		push	dword ptr [esi+2Ch] ; void *
		call	ds:free
		pop	ecx

loc_100194CE:				; CODE XREF: sub_1001944D+75j
		cmp	[edi], ebx
		jz	short loc_100194DB
		push	dword ptr [edi]	; void *
		mov	ecx, edi
		call	sub_10019501

loc_100194DB:				; CODE XREF: sub_1001944D+83j
		lea	ecx, [esi+18h]
		call	sub_10004DA3
		lea	ecx, [esi+14h]
		call	sub_10004DA3
		lea	ecx, [esi+10h]
		call	sub_10004DA3
		mov	ecx, esi
		call	sub_100069C2
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1001944D	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10019501(void *)
sub_10019501	proc near		; CODE XREF: sub_1001944D+6Bp
					; sub_1001944D+89p ...

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jz	short locret_1001951B
		mov	ecx, [esp+arg_0]
		call	sub_10017798
		push	[esp+arg_0]	; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

locret_1001951B:			; CODE XREF: sub_10019501+5j
		retn	4
sub_10019501	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001951E(void	*, size_t, void	*)
sub_1001951E	proc near		; CODE XREF: sub_10019774+85p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_10019556
		cmp	[ebp+arg_4], 0
		jz	short loc_10019556
		push	edi
		push	[ebp+arg_4]	; size_t
		mov	edi, [ebp+arg_8]
		push	[ebp+arg_0]	; void *
		push	edi		; void *
		call	memcpy
		add	esp, 0Ch
		xor	eax, eax

loc_10019542:				; CODE XREF: sub_1001951E+35j
		mov	ecx, [edi+eax*4]
		test	ecx, ecx
		jz	short loc_1001954F
		sub	ecx, [ebp+arg_0]
		mov	[edi+eax*4], ecx

loc_1001954F:				; CODE XREF: sub_1001951E+29j
		inc	eax
		cmp	eax, 20h
		jb	short loc_10019542
		pop	edi

loc_10019556:				; CODE XREF: sub_1001951E+7j
					; sub_1001951E+Dj
		pop	ebp
		retn
sub_1001951E	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10019558(wchar_t *,	wchar_t	*, int,	int, int)
sub_10019558	proc near		; CODE XREF: sub_100095AD+3C8p

lpApplicationName= dword ptr -30Ch
lpStartupInfo	= dword	ptr -308h
hProcess	= dword	ptr -304h
hThread		= dword	ptr -300h
var_2F4		= dword	ptr -2F4h
ProcessInformation= _PROCESS_INFORMATION ptr -2F0h
var_2E0		= byte ptr -2E0h
Context		= CONTEXT ptr -2D0h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 30Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+30Ch+var_4], eax
		mov	eax, [esp+30Ch+arg_0]
		push	ebx
		push	ebp
		push	esi
		mov	esi, ds:_wcsdup
		mov	ebx, ecx
		mov	ecx, [esp+318h+arg_C]
		push	edi
		mov	edi, [esp+31Ch+arg_4]
		mov	[esp+31Ch+lpStartupInfo], ecx
		mov	ecx, [esp+31Ch+arg_10]
		push	eax		; wchar_t *
		mov	[esp+320h+lpApplicationName], eax
		mov	[esp+320h+var_2F4], ecx
		call	esi ; _wcsdup
		pop	ecx
		push	eax
		lea	ecx, [ebx+2Ch]
		call	sub_100083BD
		push	edi		; wchar_t *
		call	esi ; _wcsdup
		mov	esi, eax
		mov	ebp, 40Ch
		mov	eax, [esp+320h+lpStartupInfo]
		pop	ecx
		cmp	dword ptr [eax+44h], 0
		jz	short loc_100195C7
		mov	ebp, 8040Ch

loc_100195C7:				; CODE XREF: sub_10019558+68j
		cmp	dword ptr [ebx+1Ch], 0
		jz	short loc_100195DD
		call	sub_10006EF6
		cmp	eax, 5
		jge	short loc_100195DD
		or	ebp, 1000000h

loc_100195DD:				; CODE XREF: sub_10019558+73j
					; sub_10019558+7Dj
		xor	eax, eax
		lea	edi, [esp+31Ch+ProcessInformation]
		stosd
		stosd
		stosd
		stosd
		lea	eax, [esp+31Ch+ProcessInformation]
		push	eax		; lpProcessInformation
		push	[esp+320h+lpStartupInfo] ; lpStartupInfo
		mov	eax, [esp+324h+arg_8]
		push	0		; lpCurrentDirectory
		push	0		; lpEnvironment
		push	ebp		; dwCreationFlags
		mov	ebp, [esp+330h+lpApplicationName]
		movzx	eax, al
		push	eax		; bInheritHandles
		push	0		; lpThreadAttributes
		push	0		; lpProcessAttributes
		push	esi		; lpCommandLine
		push	ebp		; lpApplicationName
		push	dword ptr [ebx+10h] ; hToken
		call	ds:CreateProcessAsUserW
		test	eax, eax
		jnz	short loc_10019624
		call	ds:GetLastError
		mov	edi, eax
		jmp	loc_100196F7
; ---------------------------------------------------------------------------

loc_10019624:				; CODE XREF: sub_10019558+BDj
		lea	eax, [esp+31Ch+ProcessInformation]
		push	eax
		lea	ecx, [esp+320h+hProcess]
		call	sub_10006993
		lea	ecx, [ebx+10h]
		call	sub_10004DA3
		cmp	dword ptr [ebx+1Ch], 0
		jz	short loc_10019651
		push	[esp+31Ch+hProcess] ; hProcess
		push	dword ptr [ebx+1Ch] ; hJob
		call	ds:AssignProcessToJobObject
		test	eax, eax
		jz	short loc_100196B4

loc_10019651:				; CODE XREF: sub_10019558+E6j
		lea	edi, [ebx+14h]
		push	dword ptr [edi]
		call	sub_10004DD3
		pop	ecx
		test	al, al
		jz	short loc_10019680
		mov	eax, [esp+31Ch+hThread]
		push	dword ptr [edi]	; Token
		mov	[esp+320h+lpApplicationName], eax
		lea	eax, [esp+320h+lpApplicationName]
		push	eax		; Thread
		call	ds:SetThreadToken
		test	eax, eax
		jz	short loc_100196B4
		mov	ecx, edi
		call	sub_10004DA3

loc_10019680:				; CODE XREF: sub_10019558+106j
		lea	eax, [esp+31Ch+Context]
		mov	[esp+31Ch+Context.ContextFlags], 1003Fh
		push	eax		; lpContext
		push	[esp+320h+hThread] ; hThread
		call	ds:GetThreadContext
		test	eax, eax
		jz	short loc_100196B4
		mov	ecx, [esp+31Ch+var_2F4]	; int
		lea	eax, [esp+31Ch+hProcess]
		mov	edi, [esp+31Ch+Context._Eax]
		push	eax		; int
		call	sub_10006A3D
		test	al, al
		jnz	short loc_100196CA

loc_100196B4:				; CODE XREF: sub_10019558+F7j
					; sub_10019558+11Fj ...
		call	ds:GetLastError
		push	0		; uExitCode
		push	[esp+320h+hProcess] ; hProcess
		mov	edi, eax
		call	ds:TerminateProcess
		jmp	short loc_100196EE
; ---------------------------------------------------------------------------

loc_100196CA:				; CODE XREF: sub_10019558+15Aj
		push	edi		; int
		push	ebp		; lpLibFileName
		call	sub_10019720
		pop	ecx
		pop	ecx
		mov	[ebx+28h], eax
		lea	ecx, [esp+31Ch+hProcess]
		lea	eax, [esp+31Ch+var_2E0]
		push	eax
		call	sub_10006B09
		push	eax
		mov	ecx, ebx
		call	sub_10006A9F
		xor	edi, edi

loc_100196EE:				; CODE XREF: sub_10019558+170j
		lea	ecx, [esp+31Ch+hProcess]
		call	sub_100069C2

loc_100196F7:				; CODE XREF: sub_10019558+C7j
		test	esi, esi
		jz	short loc_10019703
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_10019703:				; CODE XREF: sub_10019558+1A1j
		mov	ecx, [esp+31Ch+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 30Ch
		retn	14h
sub_10019558	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10019720(LPCWSTR lpLibFileName, int)
sub_10019720	proc near		; CODE XREF: sub_10019558+174p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpLibFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	edi
		push	[ebp+lpLibFileName] ; lpLibFileName
		call	ds:LoadLibraryW
		mov	edi, eax
		test	edi, edi
		jz	short loc_1001976F
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001CAC8
		mov	[ebp+var_4], edi
		call	sub_10005F17
		test	al, al
		jnz	short loc_10019754
		push	edi		; hLibModule
		call	ds:FreeLibrary
		jmp	short loc_1001976D
; ---------------------------------------------------------------------------

loc_10019754:				; CODE XREF: sub_10019720+29j
		push	esi
		lea	ecx, [ebp+var_8]
		call	sub_10005D91
		mov	esi, [ebp+arg_4]
		push	edi		; hLibModule
		sub	esi, [eax+28h]
		call	ds:FreeLibrary
		mov	edi, esi
		pop	esi

loc_1001976D:				; CODE XREF: sub_10019720+32j
		mov	eax, edi

loc_1001976F:				; CODE XREF: sub_10019720+13j
		pop	edi
		mov	esp, ebp
		pop	ebp
		retn
sub_10019720	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10019774(int, void *, HANDLE TargetHandle, size_t)
sub_10019774	proc near		; CODE XREF: sub_1001664B+66p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
TargetHandle	= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		mov	eax, [esp+4+arg_C]
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+TargetHandle]
		mov	ebx, ecx
		push	esi
		push	edi
		xor	edi, edi
		add	eax, ebp
		push	edi		; lpName
		push	eax		; dwMaximumSizeLow
		push	edi		; dwMaximumSizeHigh
		push	8000004h	; flProtect
		push	edi		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		lea	esi, [ebx+18h]
		call	ds:CreateFileMappingW
		push	eax
		mov	ecx, esi
		call	sub_10004DE8
		push	dword ptr [esi]
		call	sub_10004DD3
		pop	ecx
		test	al, al
		jnz	short loc_100197BA

loc_100197AF:				; CODE XREF: sub_10019774+62j
					; sub_10019774+77j ...
		call	ds:GetLastError
		jmp	loc_100198DB
; ---------------------------------------------------------------------------

loc_100197BA:				; CODE XREF: sub_10019774+39j
		push	edi		; dwOptions
		push	edi		; bInheritHandle
		push	6		; dwDesiredAccess
		lea	eax, [esp+20h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	dword ptr [esi]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_100197AF
		push	edi		; dwNumberOfBytesToMap
		push	edi		; dwFileOffsetLow
		push	edi		; dwFileOffsetHigh
		push	6		; dwDesiredAccess
		push	dword ptr [esi]	; hFileMappingObject
		call	ds:MapViewOfFile
		mov	[esp+14h+var_4], eax
		test	eax, eax
		jz	short loc_100197AF
		mov	esi, [esp+14h+arg_C]
		add	eax, ebp
		push	eax		; void *
		push	esi		; size_t
		push	[esp+1Ch+arg_4]	; void *
		call	sub_1001951E
		mov	eax, [esp+20h+TargetHandle]
		add	esp, 0Ch
		mov	ecx, ebx
		mov	g_shared_section, eax
		push	4		; nSize
		push	offset g_shared_section	; lpBuffer
		push	offset aG_shared_sec_0 ; "g_shared_section"
		call	sub_100198FB
		mov	ecx, eax
		mov	g_shared_section, edi
		test	ecx, ecx
		jz	short loc_10019839

loc_10019829:				; CODE XREF: sub_10019774+E8j
					; sub_10019774+10Dj
		xor	eax, eax
		inc	eax
		cmp	ecx, eax
		jnz	loc_100198DB
		jmp	loc_100197AF
; ---------------------------------------------------------------------------

loc_10019839:				; CODE XREF: sub_10019774+B3j
		push	4		; nSize
		push	offset g_shared_IPC_size ; lpBuffer
		push	offset aG_shared_ipc_0 ; "g_shared_IPC_size"
		mov	ecx, ebx
		mov	g_shared_IPC_size, ebp
		call	sub_100198FB
		mov	ecx, eax
		mov	g_shared_IPC_size, edi
		test	ecx, ecx
		jnz	short loc_10019829
		push	4		; nSize
		push	offset g_shared_policy_size ; lpBuffer
		push	offset aG_shared_pol_0 ; "g_shared_policy_size"
		mov	ecx, ebx
		mov	g_shared_policy_size, esi
		call	sub_100198FB
		mov	ecx, eax
		mov	g_shared_policy_size, edi
		test	ecx, ecx
		jnz	short loc_10019829
		push	20h		; unsigned int
		call	??2@YAPAXI@Z	; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100198A7
		push	[esp+14h+arg_0]
		mov	ecx, eax
		push	dword ptr [ebx+24h]
		push	dword ptr [ebx+1Ch]
		push	dword ptr [ebx+8]
		push	dword ptr [ebx]
		call	sub_10017726
		mov	edi, eax

loc_100198A7:				; CODE XREF: sub_10019774+119j
		push	edi
		lea	ecx, [ebx+20h]
		call	sub_10019975
		mov	ecx, [ebx+20h]
		push	400h
		push	ebp
		push	[esp+1Ch+var_4]
		call	sub_10017956
		test	al, al
		jnz	short loc_100198CB
		push	8
		pop	eax
		jmp	short loc_100198DB
; ---------------------------------------------------------------------------

loc_100198CB:				; CODE XREF: sub_10019774+150j
		mov	ecx, ebx
		call	sub_10006B51
		push	eax		; hObject
		call	ds:CloseHandle
		xor	eax, eax

loc_100198DB:				; CODE XREF: sub_10019774+41j
					; sub_10019774+BAj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_10019774	endp


; =============== S U B	R O U T	I N E =======================================


sub_100198E3	proc near		; CODE XREF: sub_10009571+18p
		push	esi
		mov	esi, ecx
		call	sub_10006A86
		test	al, al
		jz	short loc_100198F9
		push	0		; uExitCode
		push	dword ptr [esi]	; hProcess
		call	ds:TerminateProcess

loc_100198F9:				; CODE XREF: sub_100198E3+Aj
		pop	esi
		retn
sub_100198E3	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100198FB(LPCSTR lpProcName,	LPVOID lpBuffer, DWORD nSize)
sub_100198FB	proc near		; CODE XREF: sub_1000D0F8+8Ep
					; sub_1000EF28+6Bp ...

NumberOfBytesWritten= dword ptr	-4
lpProcName	= dword	ptr  4
lpBuffer	= dword	ptr  8
nSize		= dword	ptr  0Ch

		push	ecx
		push	edi
		mov	edi, ecx
		call	sub_10006A86
		test	al, al
		jnz	short loc_1001990D
		push	8
		pop	eax
		jmp	short loc_10019970
; ---------------------------------------------------------------------------

loc_1001990D:				; CODE XREF: sub_100198FB+Bj
		push	esi
		push	dword ptr [edi+2Ch] ; lpLibFileName
		call	ds:LoadLibraryW
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10019920
		inc	eax
		jmp	short loc_1001996F
; ---------------------------------------------------------------------------

loc_10019920:				; CODE XREF: sub_100198FB+20j
		push	ebx
		push	[esp+10h+lpProcName] ; lpProcName
		push	esi		; hModule
		call	ds:GetProcAddress
		push	esi		; hLibModule
		mov	ebx, eax
		call	ds:FreeLibrary
		test	ebx, ebx
		jnz	short loc_1001993E
		xor	eax, eax
		inc	eax
		jmp	short loc_1001996E
; ---------------------------------------------------------------------------

loc_1001993E:				; CODE XREF: sub_100198FB+3Cj
		mov	eax, [edi+28h]
		lea	ecx, [esp+10h+NumberOfBytesWritten]
		push	ebp
		mov	ebp, [esp+14h+nSize]
		sub	eax, esi
		push	ecx		; lpNumberOfBytesWritten
		push	ebp		; nSize
		push	[esp+1Ch+lpBuffer] ; lpBuffer
		add	eax, ebx
		push	eax		; lpBaseAddress
		push	dword ptr [edi]	; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jnz	short loc_10019964
		inc	eax
		jmp	short loc_1001996D
; ---------------------------------------------------------------------------

loc_10019964:				; CODE XREF: sub_100198FB+64j
		xor	eax, eax
		cmp	[esp+14h+NumberOfBytesWritten],	ebp
		setnz	al

loc_1001996D:				; CODE XREF: sub_100198FB+67j
		pop	ebp

loc_1001996E:				; CODE XREF: sub_100198FB+41j
		pop	ebx

loc_1001996F:				; CODE XREF: sub_100198FB+23j
		pop	esi

loc_10019970:				; CODE XREF: sub_100198FB+10j
		pop	edi
		pop	ecx
		retn	0Ch
sub_100198FB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019975	proc near		; CODE XREF: sub_10019774+137p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		and	dword ptr [esi], 0
		test	eax, eax
		jz	short loc_10019987
		push	eax		; void *
		call	sub_10019501

loc_10019987:				; CODE XREF: sub_10019975+Aj
		mov	eax, [esp+4+arg_0]
		mov	[esi], eax
		pop	esi
		retn	4
sub_10019975	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019991	proc near		; CODE XREF: sub_10019AA7:loc_10019B18p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		call	?__uncaught_exception@@YA_NXZ ;	__uncaught_exception(void)
		test	al, al
		jz	short loc_100199D7
		and	[ebp+var_8], 0
		lea	ecx, [ebp+var_8]
		and	[ebp+var_4], 0
		call	sub_1000D2C3
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], eax
		call	sub_1000E258
		lea	ecx, [ebp+var_8]
		call	sub_1000E09A
		lea	ecx, [ebp+var_8]
		test	al, al
		jnz	short loc_100199D2
		call	sub_1000CD78
		xor	al, al
		jmp	short loc_100199D9
; ---------------------------------------------------------------------------

loc_100199D2:				; CODE XREF: sub_10019991+36j
		call	sub_1000CD78

loc_100199D7:				; CODE XREF: sub_10019991+Cj
		mov	al, 1

loc_100199D9:				; CODE XREF: sub_10019991+3Fj
		mov	esp, ebp
		pop	ebp
		retn
sub_10019991	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100199DD	proc near		; DATA XREF: .rdata:1002FD84o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1000E8D1
		add	esp, 14h
		pop	ebp
		retn	14h
sub_100199DD	endp


; =============== S U B	R O U T	I N E =======================================


sub_100199FB	proc near		; CODE XREF: sub_10019AA7:loc_10019AF1p
		push	80000002h	; hKey
		call	sub_10019A2F
		pop	ecx
		test	al, al
		jz	short loc_10019A2C
		push	80000000h	; hKey
		call	sub_10019A2F
		pop	ecx
		test	al, al
		jz	short loc_10019A2C
		push	80000003h	; hKey
		call	sub_10019A2F
		pop	ecx
		test	al, al
		jz	short loc_10019A2C
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10019A2C:				; CODE XREF: sub_100199FB+Dj
					; sub_100199FB+1Cj ...
		xor	eax, eax
		retn
sub_100199FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10019A2F(HKEY	hKey)
sub_10019A2F	proc near		; CODE XREF: sub_100199FB+5p
					; sub_100199FB+14p ...

phkResult	= dword	ptr -4
hKey		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		lea	eax, [ebp+phkResult]
		push	eax		; phkResult
		push	2000000h	; samDesired
		push	0		; ulOptions
		push	0		; lpSubKey
		push	[ebp+hKey]	; hKey
		call	ds:RegOpenKeyExW
		test	eax, eax
		jnz	short loc_10019A5E
		push	[ebp+phkResult]	; hKey
		call	ds:RegCloseKey
		test	eax, eax
		jz	short loc_10019A5E
		xor	al, al
		jmp	short loc_10019A60
; ---------------------------------------------------------------------------

loc_10019A5E:				; CODE XREF: sub_10019A2F+1Cj
					; sub_10019A2F+29j
		mov	al, 1

loc_10019A60:				; CODE XREF: sub_10019A2F+2Dj
		mov	esp, ebp
		pop	ebp
		retn
sub_10019A2F	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10015880

loc_10019A64:				; CODE XREF: sub_10015880+13j
		mov	eax, dword_10033DFC
		test	al, 1
		jnz	short loc_10019A86
		or	eax, 1
		mov	dword_10033DF4,	offset off_1002FD78
		and	dword_10033DF8,	0
		mov	dword_10033DFC,	eax

loc_10019A86:				; CODE XREF: sub_10015880+41EBj
		mov	eax, offset dword_10033DF4
		retn
; END OF FUNCTION CHUNK	FOR sub_10015880

; =============== S U B	R O U T	I N E =======================================


sub_10019A8C	proc near		; DATA XREF: .rdata:1002FD80o
		lea	eax, [ecx+4]
		retn
sub_10019A8C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019A90	proc near		; DATA XREF: .rdata:off_1002FD78o
		push	2
		pop	eax
		cmp	[ecx+4], eax
		jge	short loc_10019A9B
		mov	[ecx+4], eax

loc_10019A9B:				; CODE XREF: sub_10019A90+6j
		xor	eax, eax
		retn
sub_10019A90	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019A9E	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+79p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+6Bp ...
		xor	eax, eax
		cmp	dword ptr [ecx], 1
		setnle	al
		retn
sub_10019A9E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019AA7	proc near		; DATA XREF: .rdata:1002FD7Co
		push	ebx
		push	esi
		push	edi
		push	g_shared_delayed_integrity_level
		mov	ebx, ecx
		call	sub_10015778
		mov	esi, ds:TerminateProcess
		mov	edi, ds:GetCurrentProcess
		pop	ecx
		test	eax, eax
		jz	short loc_10019AD2
		push	1B5Eh		; uExitCode
		call	edi ; GetCurrentProcess
		push	eax		; hProcess
		call	esi ; TerminateProcess

loc_10019AD2:				; CODE XREF: sub_10019AA7+1Fj
		push	3
		pop	eax
		cmp	[ebx+4], eax
		jge	short loc_10019ADD
		mov	[ebx+4], eax

loc_10019ADD:				; CODE XREF: sub_10019AA7+31j
		call	ds:RevertToSelf
		test	eax, eax
		jnz	short loc_10019AF1
		push	1B5Fh		; uExitCode
		call	edi ; GetCurrentProcess
		push	eax		; hProcess
		call	esi ; TerminateProcess

loc_10019AF1:				; CODE XREF: sub_10019AA7+3Ej
		call	sub_100199FB
		test	al, al
		jnz	short loc_10019B04
		push	1B60h		; uExitCode
		call	edi ; GetCurrentProcess
		push	eax		; hProcess
		call	esi ; TerminateProcess

loc_10019B04:				; CODE XREF: sub_10019AA7+51j
		call	ds:RegDisablePredefinedCache
		test	eax, eax
		jz	short loc_10019B18
		push	1B61h		; uExitCode
		call	edi ; GetCurrentProcess
		push	eax		; hProcess
		call	esi ; TerminateProcess

loc_10019B18:				; CODE XREF: sub_10019AA7+65j
		call	sub_10019991
		test	al, al
		jnz	short loc_10019B2B
		push	1B62h		; uExitCode
		call	edi ; GetCurrentProcess
		push	eax		; hProcess
		call	esi ; TerminateProcess

loc_10019B2B:				; CODE XREF: sub_10019AA7+78j
		mov	ecx, g_shared_delayed_mitigations
		mov	eax, ecx
		mov	edx, dword_10033DEC
		or	eax, edx
		jz	short loc_10019B54
		push	edx
		push	ecx
		call	sub_10011B14
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10019B54
		push	1B63h		; uExitCode
		call	edi ; GetCurrentProcess
		push	eax		; hProcess
		call	esi ; TerminateProcess

loc_10019B54:				; CODE XREF: sub_10019AA7+94j
					; sub_10019AA7+A1j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10019AA7	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019B58	proc near		; CODE XREF: TargetNtOpenThreadToken(x,x,x,x,x)+11p
					; TargetNtOpenThreadTokenEx(x,x,x,x,x,x)+11p ...
		xor	eax, eax
		cmp	dword ptr [ecx], 2
		setnle	al
		retn
sub_10019B58	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019B61	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+48p
		cmp	dword ptr [ecx], 0
		jnz	short locret_10019B6C
		mov	dword ptr [ecx], 1

locret_10019B6C:			; CODE XREF: sub_10019B61+3j
		retn
sub_10019B61	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019B6D	proc near		; CODE XREF: sub_100111C8+3Fp
					; sub_10019BCA+4Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		push	[esp+0Ch+arg_4]
		push	dword ptr [esi+4]
		push	esi
		call	sub_10010C46
		push	1
		mov	ecx, ebx
		mov	edi, eax
		call	sub_10019CAB
		mov	[esi+4], edi
		mov	ecx, [edi+4]
		mov	[ecx], edi
		pop	edi
		pop	esi
		pop	ebx
		retn	8
sub_10019B6D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019B9C	proc near		; CODE XREF: sub_1000919B+3p
		push	esi
		push	edi
		mov	edi, ecx
		lea	eax, [edi+0Ch]
		mov	dword ptr [edi], offset	off_1001D074
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		lea	ecx, [edi+4]
		call	sub_10011712
		push	dword ptr [edi+4] ; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx
		mov	dword ptr [edi], offset	off_1001D068
		pop	edi
		pop	esi
		retn
sub_10019B9C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10019BCA(HANDLE phNewWaitObject, HANDLE hObject, WAITORTIMERCALLBACK Callback, PVOID Context)
sub_10019BCA	proc near		; DATA XREF: .rdata:off_1001D074o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
phNewWaitObject	= dword	ptr  8
hObject		= dword	ptr  0Ch
Callback	= dword	ptr  10h
Context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, [ebp+phNewWaitObject]
		push	edi
		mov	edi, ecx
		test	esi, esi
		jnz	short loc_10019BDE

loc_10019BDA:				; CODE XREF: sub_10019BCA+31j
		xor	al, al
		jmp	short loc_10019C27
; ---------------------------------------------------------------------------

loc_10019BDE:				; CODE XREF: sub_10019BCA+Ej
		and	[ebp+phNewWaitObject], 0
		lea	eax, [ebp+phNewWaitObject]
		push	0		; dwFlags
		push	0FFFFFFFFh	; dwMilliseconds
		push	[ebp+Context]	; Context
		push	[ebp+Callback]	; Callback
		push	[ebp+hObject]	; hObject
		push	eax		; phNewWaitObject
		call	ds:RegisterWaitForSingleObject
		test	eax, eax
		jz	short loc_10019BDA
		mov	eax, [ebp+phNewWaitObject]
		mov	[ebp+var_8], esi
		lea	esi, [edi+0Ch]
		push	esi		; lpCriticalSection
		mov	[ebp+var_4], eax
		call	ds:EnterCriticalSection
		lea	eax, [ebp+var_8]
		lea	ecx, [edi+4]
		push	eax
		push	dword ptr [ecx]
		call	sub_10019B6D
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	al, 1

loc_10019C27:				; CODE XREF: sub_10019BCA+12j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10019BCA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019C2F	proc near		; DATA XREF: .rdata:1001D078o

lpCriticalSection= dword ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	esi
		mov	esi, ecx
		test	ebx, ebx
		jnz	short loc_10019C41
		xor	al, al
		jmp	short loc_10019CA4
; ---------------------------------------------------------------------------

loc_10019C41:				; CODE XREF: sub_10019C2F+Cj
		lea	eax, [esi+0Ch]
		push	ebp
		push	eax		; lpCriticalSection
		mov	[esp+18h+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		lea	ebp, [esi+4]
		mov	byte ptr [esp+14h+arg_0], 1
		mov	eax, [ebp+0]
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_10019C95
		push	edi

loc_10019C62:				; CODE XREF: sub_10019C2F+63j
		cmp	[esi+8], ebx
		jnz	short loc_10019C8D
		mov	edi, [esi+0Ch]
		lea	eax, [esp+18h+var_4]
		push	esi		; void *
		push	eax		; int
		mov	ecx, ebp
		call	sub_10019CD3
		push	0FFFFFFFFh	; CompletionEvent
		push	edi		; WaitHandle
		mov	esi, [eax]
		call	ds:UnregisterWaitEx
		test	eax, eax
		setnz	al
		and	byte ptr [esp+18h+arg_0], al
		jmp	short loc_10019C8F
; ---------------------------------------------------------------------------

loc_10019C8D:				; CODE XREF: sub_10019C2F+36j
		mov	esi, [esi]

loc_10019C8F:				; CODE XREF: sub_10019C2F+5Cj
		cmp	esi, [ebp+0]
		jnz	short loc_10019C62
		pop	edi

loc_10019C95:				; CODE XREF: sub_10019C2F+30j
		push	[esp+14h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	al, byte ptr [esp+14h+arg_0]
		pop	ebp

loc_10019CA4:				; CODE XREF: sub_10019C2F+10j
		pop	esi
		pop	ebx
		pop	ecx
		pop	ecx
		retn	4
sub_10019C2F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019CAB	proc near		; CODE XREF: sub_10019B6D+1Cp

arg_0		= dword	ptr  4

		mov	edx, [ecx+4]
		mov	eax, 0FFFFFFEh
		push	esi
		mov	esi, [esp+4+arg_0]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_10019CC9
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10019CC9:				; CODE XREF: sub_10019CAB+11j
		lea	eax, [edx+esi]
		mov	[ecx+4], eax
		pop	esi
		retn	4
sub_10019CAB	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10019CD3(int, void *)
sub_10019CD3	proc near		; CODE XREF: sub_1000601E+79p
					; sub_100068C9+25p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		push	edi
		mov	edi, ecx
		mov	edx, [eax]
		mov	[esp+8+arg_4], edx
		mov	esi, [eax+4]
		mov	edx, [eax]
		push	eax		; void *
		mov	[esi], edx
		mov	edx, [eax]
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		dec	dword ptr [edi+4]
		call	??3@YAXPAX@Z	; operator delete(void *)
		mov	eax, [esp+0Ch+arg_0]
		pop	ecx
		mov	ecx, [esp+8+arg_4]
		pop	edi
		mov	[eax], ecx
		pop	esi
		retn	8
sub_10019CD3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019D09	proc near		; CODE XREF: sub_10019D54+1E7p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		xor	eax, eax
		push	esi
		mov	esi, [esp+8+arg_4]
		mov	ecx, ebx
		push	edi
		and	dword ptr [ebx+10h], 0
		mov	edi, [esp+0Ch+arg_8]
		mov	dword ptr [ebx+14h], 7
		mov	[ebx], ax
		mov	eax, [esi+10h]
		add	eax, [edi+10h]
		push	eax
		call	sub_10003861
		push	0FFFFFFFFh
		push	0
		push	esi
		mov	ecx, ebx
		call	sub_100038B8
		push	0FFFFFFFFh
		push	0
		push	edi
		mov	ecx, ebx
		call	sub_100038B8
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
sub_10019D09	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019D54	proc near		; CODE XREF: sub_1000C388+Ap
					; sub_10019D54+1B0p

var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
lpszLongPath	= dword	ptr -68h
lpszShortPath	= dword	ptr -64h
var_50		= dword	ptr -50h
var_4C		= word ptr -4Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= word ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 70h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+70h+var_4], eax
		mov	eax, [esp+70h+arg_0]
		lea	ecx, [esp+70h+lpszShortPath]
		push	ebx
		push	ebp
		mov	ebp, [esp+78h+arg_4]
		xor	ebx, ebx
		push	esi
		push	eax
		mov	[esp+80h+var_6C], ebp
		mov	[esp+80h+var_6D], bl
		call	sub_10003B1C
		mov	esi, offset a??_2 ; "\\??\\"
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax
		push	esi
		push	4
		push	ebx
		lea	ecx, [esp+8Ch+lpszShortPath]
		call	sub_10004188
		test	eax, eax
		jnz	short loc_10019DE4
		push	0FFFFFFFFh
		mov	[esp+80h+var_4C], ax
		lea	ecx, [esp+80h+var_4C]
		push	4
		lea	eax, [esp+84h+lpszShortPath]
		mov	[esp+84h+var_38], 7
		push	eax
		mov	[esp+88h+var_3C], ebx
		call	sub_10002344
		lea	eax, [esp+7Ch+var_4C]
		push	eax		; void *
		lea	ecx, [esp+80h+lpszShortPath] ; void *
		call	sub_1000402F
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+84h+var_4C] ;	void *
		call	sub_100022C1
		mov	[esp+7Ch+var_6D], 1

loc_10019DE4:				; CODE XREF: sub_10019D54+4Cj
		push	edi
		xor	ecx, ecx
		mov	edi, 104h
		push	2
		pop	edx
		mov	eax, edi
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_1001AAE8
		cmp	[esp+84h+var_50], 8
		mov	esi, eax
		mov	eax, [esp+84h+lpszShortPath]
		pop	ecx
		mov	[esp+80h+lpszLongPath],	esi
		jnb	short loc_10019E16
		lea	eax, [esp+80h+lpszShortPath]

loc_10019E16:				; CODE XREF: sub_10019D54+BCj
		push	edi		; cchBuffer
		push	esi		; lpszLongPath
		push	eax		; lpszShortPath
		call	ds:GetLongPathNameW
		mov	ebx, eax
		cmp	ebx, edi
		jb	short loc_10019E6E
		push	2
		pop	ebp

loc_10019E28:				; CODE XREF: sub_10019D54+114j
		add	edi, edi
		xor	ecx, ecx
		mov	eax, edi
		mul	ebp
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_1001AAE8
		pop	ecx
		push	eax
		lea	ecx, [esp+84h+lpszLongPath]
		call	sub_1001A696
		cmp	[esp+80h+var_50], 8
		mov	eax, [esp+80h+lpszShortPath]
		jnb	short loc_10019E57
		lea	eax, [esp+80h+lpszShortPath]

loc_10019E57:				; CODE XREF: sub_10019D54+FDj
		mov	esi, [esp+80h+lpszLongPath]
		push	edi		; cchBuffer
		push	esi		; lpszLongPath
		push	eax		; lpszShortPath
		call	ds:GetLongPathNameW
		mov	ebx, eax
		cmp	ebx, edi
		jnb	short loc_10019E28
		mov	ebp, [esp+80h+var_6C]

loc_10019E6E:				; CODE XREF: sub_10019D54+CFj
		call	ds:GetLastError
		test	ebx, ebx
		jnz	loc_10019F73
		push	2
		pop	ecx
		cmp	eax, ecx
		jz	short loc_10019E8D
		cmp	eax, 3
		jz	short loc_10019E8D
		cmp	eax, 7Bh
		jnz	short loc_10019EAE

loc_10019E8D:				; CODE XREF: sub_10019D54+12Dj
					; sub_10019D54+132j
		push	1
		push	0FFFFFFFFh
		lea	eax, [esp+88h+var_6C]
		mov	[esp+88h+var_6C], 5Ch
		push	eax
		lea	ecx, [esp+8Ch+lpszShortPath]
		call	sub_1001A6B3
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_10019EB5

loc_10019EAE:				; CODE XREF: sub_10019D54+137j
		xor	bl, bl
		jmp	loc_10019FC9
; ---------------------------------------------------------------------------

loc_10019EB5:				; CODE XREF: sub_10019D54+158j
		xor	eax, eax
		mov	[esp+80h+var_20], 7
		push	edi
		xor	ebx, ebx
		mov	[esp+84h+var_34], ax
		push	ebx
		lea	eax, [esp+88h+lpszShortPath]
		mov	[esp+88h+var_24], ebx
		push	eax
		lea	ecx, [esp+8Ch+var_34]
		call	sub_10002344
		xor	eax, eax
		mov	[esp+80h+var_38], 7
		push	0FFFFFFFFh
		mov	[esp+84h+var_4C], ax
		lea	ecx, [esp+84h+var_4C]
		push	edi
		lea	eax, [esp+88h+lpszShortPath]
		mov	[esp+88h+var_3C], ebx
		push	eax
		call	sub_10002344
		lea	eax, [esp+80h+var_34]
		push	eax
		push	eax
		call	sub_10019D54
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10019F2C
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+88h+var_4C] ;	void *
		call	sub_100022C1
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+88h+var_34] ;	void *
		call	sub_100022C1
		jmp	loc_10019FC9
; ---------------------------------------------------------------------------

loc_10019F2C:				; CODE XREF: sub_10019D54+1B9j
		lea	eax, [esp+80h+var_4C]
		push	eax
		lea	eax, [esp+84h+var_34]
		push	eax
		lea	eax, [esp+88h+var_1C]
		push	eax
		call	sub_10019D09
		add	esp, 0Ch
		lea	ecx, [esp+80h+lpszShortPath] ; void *
		push	eax		; void *
		call	sub_1000402F
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+88h+var_1C] ;	void *
		call	sub_100022C1
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+88h+var_4C] ;	void *
		call	sub_100022C1
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+88h+var_34] ;	void *
		call	sub_100022C1
		jmp	short loc_10019F87
; ---------------------------------------------------------------------------

loc_10019F73:				; CODE XREF: sub_10019D54+122j
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	esi		; void *
		lea	ecx, [esp+88h+lpszShortPath]
		call	sub_100023C8
		xor	ebx, ebx

loc_10019F87:				; CODE XREF: sub_10019D54+21Dj
		cmp	[esp+80h+var_6D], 0
		jz	short loc_10019FB4
		mov	edi, offset a??_2 ; "\\??\\"
		push	edi
		call	sub_100024E3
		pop	ecx
		push	eax		; int
		push	edi		; void *
		mov	ecx, ebp
		call	sub_100023C8
		push	0FFFFFFFFh
		push	ebx
		lea	eax, [esp+88h+lpszShortPath]
		mov	ecx, ebp
		push	eax
		call	sub_100038B8
		jmp	short loc_10019FC7
; ---------------------------------------------------------------------------

loc_10019FB4:				; CODE XREF: sub_10019D54+238j
		lea	eax, [esp+80h+lpszShortPath]
		cmp	ebp, eax
		jz	short loc_10019FC7
		push	0FFFFFFFFh
		push	ebx
		push	eax
		mov	ecx, ebp
		call	sub_10002344

loc_10019FC7:				; CODE XREF: sub_10019D54+25Ej
					; sub_10019D54+266j
		mov	bl, 1

loc_10019FC9:				; CODE XREF: sub_10019D54+15Cj
					; sub_10019D54+1D3j
		pop	edi
		test	esi, esi
		jz	short loc_10019FD5
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_10019FD5:				; CODE XREF: sub_10019D54+278j
		push	0		; int
		push	1		; char
		lea	ecx, [esp+84h+lpszShortPath] ; void *
		call	sub_100022C1
		mov	ecx, [esp+7Ch+var_4]
		mov	al, bl
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn
sub_10019D54	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019FF6	proc near		; CODE XREF: sub_10013687+Fp
					; sub_1001A2A8+71p ...

var_14		= byte ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	ebx
		push	esi
		push	edi
		lea	eax, [ebp+var_8]
		xor	ebx, ebx
		push	eax		; int
		push	offset aNtqueryobject ;	"NtQueryObject"
		mov	[ebp+var_8], ebx
		call	sub_1001A242
		pop	ecx
		pop	ecx
		push	8
		pop	ecx
		lea	eax, [ebp+var_4]
		mov	[ebp+var_4], ecx
		push	eax
		push	ecx
		lea	edi, [ebp+var_14]
		mov	eax, edi
		push	eax
		push	1
		push	[ebp+arg_0]
		call	[ebp+var_8]
		mov	esi, ebx
		mov	[ebp+var_C], esi
		cmp	[ebp+var_4], ebx
		jz	short loc_1001A05E
		push	[ebp+var_4]
		call	sub_1001AAE8
		pop	ecx
		mov	edi, eax
		lea	ecx, [ebp+var_C]
		push	edi
		call	sub_1001A679
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+var_4]
		push	edi
		push	1
		push	[ebp+arg_0]
		call	[ebp+var_8]
		mov	esi, [ebp+var_C]

loc_1001A05E:				; CODE XREF: sub_10019FF6+3Fj
		test	eax, eax
		jnz	short loc_1001A075
		movzx	eax, word ptr [edi]
		mov	ecx, [ebp+arg_4]
		shr	eax, 1
		push	eax		; int
		push	dword ptr [edi+4] ; void *
		call	sub_100023C8
		mov	bl, 1

loc_1001A075:				; CODE XREF: sub_10019FF6+6Aj
		test	esi, esi
		jz	short loc_1001A080
		push	esi		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1001A080:				; CODE XREF: sub_10019FF6+81j
		pop	edi
		pop	esi
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10019FF6	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001A089	proc near		; CODE XREF: sub_1001A0FF+7Ap
					; sub_1001A3B3+33p

var_10		= byte ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 10h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+10h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+18h+arg_0]
		xor	ebx, ebx
		push	esi
		push	edi
		mov	esi, offset a??_2 ; "\\??\\"
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax
		push	esi
		push	4
		push	ebx
		mov	ecx, ebp
		call	sub_10004188
		test	eax, eax
		jnz	short loc_1001A0C0
		push	4
		pop	ebx

loc_1001A0C0:				; CODE XREF: sub_1001A089+32j
		mov	esi, offset aPipe ; "pipe\\"
		lea	edi, [esp+20h+var_10]
		lea	eax, [esp+20h+var_10]
		push	eax
		movsd
		movsd
		movsd
		call	sub_100024E3
		pop	ecx
		push	eax
		lea	eax, [esp+24h+var_10]
		mov	ecx, ebp
		push	eax
		push	5
		push	ebx
		call	sub_10004188
		mov	ecx, [esp+20h+var_4]
		neg	eax
		pop	edi
		pop	esi
		pop	ebp
		sbb	eax, eax
		pop	ebx
		xor	ecx, esp
		inc	eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 10h
		retn
sub_1001A089	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001A0FF	proc near		; CODE XREF: sub_1000C388+1Ap

var_38		= dword	ptr -38h
var_34		= word ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
lpFileName	= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+lpFileName]
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		push	eax
		call	sub_10003B1C
		mov	esi, offset a??_2 ; "\\??\\"
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax
		push	esi
		push	4
		xor	ebx, ebx
		lea	ecx, [ebp+lpFileName]
		push	ebx
		call	sub_10004188
		test	eax, eax
		jnz	short loc_1001A175
		push	0FFFFFFFFh
		mov	[ebp+var_34], ax
		lea	ecx, [ebp+var_34]
		push	4
		lea	eax, [ebp+lpFileName]
		mov	[ebp+var_20], 7
		push	eax
		mov	[ebp+var_24], ebx
		call	sub_10002344
		lea	eax, [ebp+var_34]
		push	eax		; void *
		lea	ecx, [ebp+lpFileName] ;	void *
		call	sub_1000402F
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1

loc_1001A175:				; CODE XREF: sub_1001A0FF+3Fj
		lea	eax, [ebp+lpFileName]
		push	eax
		call	sub_1001A089
		pop	ecx
		test	al, al
		jz	short loc_1001A18A

loc_1001A183:				; CODE XREF: sub_1001A0FF+11Bj
		mov	[edi], bl
		jmp	loc_1001A222
; ---------------------------------------------------------------------------

loc_1001A18A:				; CODE XREF: sub_1001A0FF+82j
		or	eax, 0FFFFFFFFh

loc_1001A18D:				; CODE XREF: sub_1001A0FF+115j
		push	eax
		xor	ecx, ecx
		mov	[ebp+var_20], 7
		push	ebx
		lea	eax, [ebp+lpFileName]
		mov	[ebp+var_34], cx
		push	eax
		lea	ecx, [ebp+var_34]
		mov	[ebp+var_24], ebx
		call	sub_10002344
		lea	eax, [ebp+var_34]
		push	eax		; void *
		lea	ecx, [ebp+lpFileName] ;	void *
		call	sub_1000402F
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1
		cmp	[ebp+var_8], 8
		mov	eax, [ebp+lpFileName]
		jnb	short loc_1001A1CE
		lea	eax, [ebp+lpFileName]

loc_1001A1CE:				; CODE XREF: sub_1001A0FF+CAj
		push	eax		; lpFileName
		call	ds:GetFileAttributesW
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001A1F3
		call	ds:GetLastError
		mov	esi, eax
		cmp	esi, 2
		jz	short loc_1001A1FA
		cmp	esi, 3
		jz	short loc_1001A1FA
		cmp	esi, 7Bh
		jnz	short loc_1001A224
		jmp	short loc_1001A1FA
; ---------------------------------------------------------------------------

loc_1001A1F3:				; CODE XREF: sub_1001A0FF+D9j
		test	eax, 400h
		jnz	short loc_1001A21F

loc_1001A1FA:				; CODE XREF: sub_1001A0FF+E6j
					; sub_1001A0FF+EBj ...
		push	1
		push	0FFFFFFFFh
		lea	eax, [ebp+var_38]
		mov	[ebp+var_38], 5Ch
		push	eax
		lea	ecx, [ebp+lpFileName]
		call	sub_1001A6B3
		cmp	eax, 2
		ja	loc_1001A18D
		jmp	loc_1001A183
; ---------------------------------------------------------------------------

loc_1001A21F:				; CODE XREF: sub_1001A0FF+F9j
		mov	byte ptr [edi],	1

loc_1001A222:				; CODE XREF: sub_1001A0FF+86j
		mov	esi, ebx

loc_1001A224:				; CODE XREF: sub_1001A0FF+F0j
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+lpFileName] ;	void *
		call	sub_100022C1
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1001A0FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001A242(LPCSTR lpProcName, int)
sub_1001A242	proc near		; CODE XREF: sub_1000C266+15p
					; sub_1000C3BE+27p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpProcName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		cmp	hModule, 0
		jnz	short loc_1001A28B
		push	esi
		push	offset aNtdll_dll_4 ; "ntdll.dll"
		call	ds:GetModuleHandleW
		mov	esi, eax
		mov	[ebp+var_8], offset off_1001CAC8
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_4], esi
		call	sub_10005F17
		test	al, al
		jnz	short loc_1001A275
		int	3		; Trap to Debugger

loc_1001A275:				; CODE XREF: sub_1001A242+30j
		mov	ecx, offset hModule
		xor	eax, eax
		lock cmpxchg [ecx], esi
		cmp	hModule, 0
		pop	esi
		jnz	short loc_1001A28B
		int	3		; Trap to Debugger

loc_1001A28B:				; CODE XREF: sub_1001A242+Cj
					; sub_1001A242+46j
		push	[ebp+lpProcName] ; lpProcName
		push	hModule		; hModule
		call	ds:GetProcAddress
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_1001A2A4
		int	3		; Trap to Debugger

loc_1001A2A4:				; CODE XREF: sub_1001A242+5Fj
		mov	esp, ebp
		pop	ebp
		retn
sub_1001A242	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001A2A8	proc near		; CODE XREF: sub_1000CE06+90p
					; sub_10014040+3Fp

phkResult	= dword	ptr -24h
dwDisposition	= dword	ptr -20h
var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= byte ptr  4
arg_18		= dword	ptr  1Ch

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+2Ch+arg_18]
		xor	ebx, ebx
		push	esi
		push	edi
		mov	edi, ebx

loc_1001A2C2:				; CODE XREF: sub_1001A2A8+3Cj
		mov	esi, ds:off_1002FDA8[edi*8]
		push	esi
		call	sub_100024E3
		pop	ecx
		push	eax
		push	ebx
		push	esi
		lea	ecx, [esp+40h+arg_0]
		call	sub_10003CD5
		test	eax, eax
		jz	short loc_1001A2EB
		inc	edi
		cmp	edi, 9
		jb	short loc_1001A2C2
		jmp	loc_1001A390
; ---------------------------------------------------------------------------

loc_1001A2EB:				; CODE XREF: sub_1001A2A8+36j
		lea	eax, [esp+34h+dwDisposition]
		push	eax		; lpdwDisposition
		lea	eax, [esp+38h+phkResult]
		push	eax		; phkResult
		push	ebx		; lpSecurityAttributes
		push	2000000h	; samDesired
		push	ebx		; dwOptions
		push	ebx		; lpClass
		push	ebx		; Reserved
		push	offset SubKey	; lpSubKey
		push	ds:hKey[edi*8]	; hKey
		call	ds:RegCreateKeyExW
		test	eax, eax
		jnz	short loc_1001A390
		push	ebp
		push	[esp+38h+phkResult]
		call	sub_10019FF6
		pop	ecx
		pop	ecx
		push	[esp+34h+phkResult] ; hKey
		mov	bl, al
		call	ds:RegCloseKey
		test	bl, bl
		jz	short loc_1001A38E
		mov	edx, ds:off_1002FDA8[edi*8]
		xor	esi, esi
		lea	ecx, [edx+2]

loc_1001A33C:				; CODE XREF: sub_1001A2A8+9Dj
		mov	ax, [edx]
		add	edx, 2
		cmp	ax, si
		jnz	short loc_1001A33C
		sub	edx, ecx
		mov	[esp+34h+var_8], 7
		xor	eax, eax
		sar	edx, 1
		push	0FFFFFFFFh
		mov	[esp+38h+var_1C], ax
		lea	ecx, [esp+38h+var_1C]
		push	edx
		lea	eax, [esp+3Ch+arg_0]
		mov	[esp+3Ch+var_C], esi
		push	eax
		call	sub_10002344
		push	0FFFFFFFFh
		push	esi
		lea	eax, [esp+3Ch+var_1C]
		mov	ecx, ebp
		push	eax
		call	sub_100038B8
		push	esi		; int
		push	1		; char
		lea	ecx, [esp+3Ch+var_1C] ;	void *
		call	sub_100022C1
		mov	bl, 1
		jmp	short loc_1001A392
; ---------------------------------------------------------------------------

loc_1001A38E:				; CODE XREF: sub_1001A2A8+86j
		xor	ebx, ebx

loc_1001A390:				; CODE XREF: sub_1001A2A8+3Ej
					; sub_1001A2A8+6Aj
		xor	esi, esi

loc_1001A392:				; CODE XREF: sub_1001A2A8+E4j
		push	esi		; int
		push	1		; char
		lea	ecx, [esp+3Ch+arg_0] ; void *
		call	sub_100022C1
		mov	ecx, [esp+34h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_1001A2A8	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001A3B3(int,	void *)
sub_1001A3B3	proc near		; CODE XREF: sub_1000C266+51p

var_260		= dword	ptr -260h
var_25C		= dword	ptr -25Ch
var_24C		= dword	ptr -24Ch
var_248		= dword	ptr -248h
var_244		= dword	ptr -244h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= word ptr -22Ch
var_21C		= dword	ptr -21Ch
var_218		= dword	ptr -218h
DeviceName	= word ptr -214h
var_20E		= word ptr -20Eh
TargetPath	= word ptr -20Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 260h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+260h+var_4], eax
		mov	eax, [esp+260h+arg_4]
		lea	ecx, [esp+260h+var_25C]
		push	ebx
		push	esi
		mov	esi, [esp+268h+arg_0]
		push	eax		; void *
		call	sub_10001E8D
		lea	eax, [esp+268h+var_25C]
		push	eax
		call	sub_1001A089
		xor	ebx, ebx
		pop	ecx
		test	al, al
		jz	short loc_1001A3F9
		mov	bl, 1
		jmp	loc_1001A5EA
; ---------------------------------------------------------------------------

loc_1001A3F9:				; CODE XREF: sub_1001A3B3+3Dj
		push	ebp
		push	edi
		xor	eax, eax
		mov	[esp+270h+var_234], ebx
		push	7
		pop	edi
		mov	word ptr [esp+270h+var_244], ax
		lea	eax, [esp+270h+var_244]
		push	eax
		push	esi
		mov	[esp+278h+var_230], edi
		call	sub_10019FF6
		pop	ecx
		pop	ecx
		test	al, al
		jz	loc_1001A5DA
		mov	ecx, [esp+270h+var_248]
		mov	eax, [esp+270h+var_25C]
		mov	edx, eax
		push	8
		pop	ebp
		cmp	ecx, ebp
		jnb	short loc_1001A437
		lea	edx, [esp+270h+var_25C]

loc_1001A437:				; CODE XREF: sub_1001A3B3+7Ej
		mov	esi, [esp+270h+var_24C]
		push	5Ch
		pop	ebp
		push	8
		cmp	[edx+esi*2-2], bp
		pop	ebp
		jnz	short loc_1001A48C
		xor	eax, eax
		mov	[esp+270h+var_218], edi
		mov	[esp+270h+var_22C], ax
		lea	ecx, [esp+270h+var_22C]
		lea	eax, [esi-1]
		mov	[esp+270h+var_21C], ebx
		push	eax
		push	ebx
		lea	eax, [esp+278h+var_25C]
		push	eax
		call	sub_10002344
		lea	eax, [esp+270h+var_22C]
		push	eax		; void *
		lea	ecx, [esp+274h+var_25C]	; void *
		call	sub_1000402F
		push	ebx		; int
		push	1		; char
		lea	ecx, [esp+278h+var_22C]	; void *
		call	sub_100022C1
		mov	ecx, [esp+270h+var_248]
		mov	eax, [esp+270h+var_25C]

loc_1001A48C:				; CODE XREF: sub_1001A3B3+93j
		cmp	ecx, ebp
		jnb	short loc_1001A494
		lea	eax, [esp+270h+var_25C]

loc_1001A494:				; CODE XREF: sub_1001A3B3+DBj
		mov	ecx, [esp+270h+var_244]
		cmp	[esp+270h+var_230], ebp
		jnb	short loc_1001A4A2
		lea	ecx, [esp+270h+var_244]

loc_1001A4A2:				; CODE XREF: sub_1001A3B3+E9j
		mov	ebx, ds:_wcsicmp
		push	eax		; wchar_t *
		push	ecx		; wchar_t *
		call	ebx ; _wcsicmp
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001A4B9

loc_1001A4B2:				; CODE XREF: sub_1001A3B3+217j
		mov	bl, 1
		jmp	loc_1001A5DA
; ---------------------------------------------------------------------------

loc_1001A4B9:				; CODE XREF: sub_1001A3B3+FDj
		push	1
		xor	eax, eax
		mov	[esp+274h+var_260], 3Ah
		push	eax
		lea	eax, [esp+278h+var_260]
		push	eax
		lea	ecx, [esp+27Ch+var_25C]
		call	sub_10003CD5
		mov	edi, eax
		test	edi, edi
		jz	loc_1001A5D6
		cmp	edi, 0FFFFFFFFh
		jz	loc_1001A5D6
		mov	eax, [esp+270h+var_25C]
		cmp	edi, 1
		jbe	short loc_1001A50F
		mov	ecx, eax
		cmp	[esp+270h+var_248], ebp
		jnb	short loc_1001A4FC
		lea	ecx, [esp+270h+var_25C]

loc_1001A4FC:				; CODE XREF: sub_1001A3B3+143j
		push	5Ch
		pop	edx
		cmp	[ecx+edi*2-4], dx
		jz	short loc_1001A50F
		xor	edx, edx

loc_1001A508:				; CODE XREF: sub_1001A3B3+1C6j
		mov	bl, dl
		jmp	loc_1001A5DA
; ---------------------------------------------------------------------------

loc_1001A50F:				; CODE XREF: sub_1001A3B3+13Bj
					; sub_1001A3B3+151j
		xor	ecx, ecx
		mov	[esp+270h+DeviceName], cx
		mov	dword ptr [esp+270h+DeviceName+2], ecx
		mov	[esp+270h+var_20E], cx
		cmp	[esp+270h+var_248], ebp
		jnb	short loc_1001A529
		lea	eax, [esp+270h+var_25C]

loc_1001A529:				; CODE XREF: sub_1001A3B3+170j
		mov	eax, [eax+edi*2-2]
		mov	esi, 104h
		mov	dword ptr [esp+270h+DeviceName], eax
		lea	eax, [esp+270h+TargetPath]
		push	esi		; ucchMax
		push	eax		; lpTargetPath
		lea	eax, [esp+278h+DeviceName]
		push	eax		; lpDeviceName
		call	ds:QueryDosDeviceW
		cmp	eax, 2
		jb	loc_1001A5D0
		cmp	eax, esi
		jz	short loc_1001A5D0
		lea	esi, [esp+270h+TargetPath]
		xor	edx, edx
		lea	ecx, [esi+2]

loc_1001A55D:				; CODE XREF: sub_1001A3B3+1B3j
		mov	ax, [esi]
		add	esi, 2
		cmp	ax, dx
		jnz	short loc_1001A55D
		mov	eax, [esp+270h+var_24C]
		sub	esi, ecx
		sub	eax, edi
		sar	esi, 1
		dec	eax
		add	eax, esi
		cmp	eax, [esp+270h+var_234]
		jnz	short loc_1001A508
		mov	eax, [esp+270h+var_244]
		cmp	[esp+270h+var_230], ebp
		jnb	short loc_1001A589
		lea	eax, [esp+270h+var_244]

loc_1001A589:				; CODE XREF: sub_1001A3B3+1D0j
		push	esi		; size_t
		lea	ecx, [esp+274h+TargetPath]
		push	ecx		; wchar_t *
		push	eax		; wchar_t *
		call	ds:_wcsnicmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001A5D0
		mov	eax, [esp+270h+var_25C]
		cmp	[esp+270h+var_248], ebp
		jnb	short loc_1001A5AB
		lea	eax, [esp+270h+var_25C]

loc_1001A5AB:				; CODE XREF: sub_1001A3B3+1F2j
		mov	ecx, [esp+270h+var_244]
		cmp	[esp+270h+var_230], ebp
		jnb	short loc_1001A5B9
		lea	ecx, [esp+270h+var_244]

loc_1001A5B9:				; CODE XREF: sub_1001A3B3+200j
		lea	eax, [eax+edi*2]
		add	eax, 2
		push	eax		; wchar_t *
		lea	eax, [ecx+esi*2]
		push	eax		; wchar_t *
		call	ebx ; _wcsicmp
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	loc_1001A4B2

loc_1001A5D0:				; CODE XREF: sub_1001A3B3+197j
					; sub_1001A3B3+19Fj ...
		xor	eax, eax
		mov	bl, al
		jmp	short loc_1001A5DC
; ---------------------------------------------------------------------------

loc_1001A5D6:				; CODE XREF: sub_1001A3B3+125j
					; sub_1001A3B3+12Ej
		xor	eax, eax
		mov	bl, al

loc_1001A5DA:				; CODE XREF: sub_1001A3B3+69j
					; sub_1001A3B3+101j ...
		xor	eax, eax

loc_1001A5DC:				; CODE XREF: sub_1001A3B3+221j
		push	eax		; int
		push	1		; char
		lea	ecx, [esp+278h+var_244]	; void *
		call	sub_100022C1
		pop	edi
		pop	ebp

loc_1001A5EA:				; CODE XREF: sub_1001A3B3+41j
		xor	eax, eax
		lea	ecx, [esp+268h+var_25C]	; void *
		push	eax		; int
		push	1		; char
		call	sub_100022C1
		mov	ecx, [esp+268h+var_4]
		mov	al, bl
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 260h
		retn
sub_1001A3B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001A611(HANDLE hProcess, LPVOID lpAddress, LPVOID lpBuffer, DWORD dwSize)
sub_1001A611	proc near		; CODE XREF: sub_100173B6+E9p

NumberOfBytesWritten= dword ptr	-8
flOldProtect	= dword	ptr -4
hProcess	= dword	ptr  8
lpAddress	= dword	ptr  0Ch
lpBuffer	= dword	ptr  10h
dwSize		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, [ebp+dwSize]
		lea	eax, [ebp+flOldProtect]
		push	eax		; lpflOldProtect
		push	8		; flNewProtect
		push	esi		; dwSize
		push	[ebp+lpAddress]	; lpAddress
		push	[ebp+hProcess]	; hProcess
		call	ds:VirtualProtectEx
		test	eax, eax
		jnz	short loc_1001A635
		xor	al, al
		jmp	short loc_1001A674
; ---------------------------------------------------------------------------

loc_1001A635:				; CODE XREF: sub_1001A611+1Ej
		push	ebx
		lea	eax, [ebp+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nSize
		push	[ebp+lpBuffer]	; lpBuffer
		push	[ebp+lpAddress]	; lpBaseAddress
		push	[ebp+hProcess]	; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1001A657
		cmp	esi, [ebp+NumberOfBytesWritten]
		jnz	short loc_1001A657
		mov	bl, 1
		jmp	short loc_1001A659
; ---------------------------------------------------------------------------

loc_1001A657:				; CODE XREF: sub_1001A611+3Bj
					; sub_1001A611+40j
		xor	bl, bl

loc_1001A659:				; CODE XREF: sub_1001A611+44j
		lea	eax, [ebp+flOldProtect]
		push	eax		; lpflOldProtect
		push	[ebp+flOldProtect] ; flNewProtect
		push	esi		; dwSize
		push	[ebp+lpAddress]	; lpAddress
		push	[ebp+hProcess]	; hProcess
		call	ds:VirtualProtectEx
		neg	eax
		sbb	al, al
		and	al, bl
		pop	ebx

loc_1001A674:				; CODE XREF: sub_1001A611+22j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001A611	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001A679	proc near		; CODE XREF: sub_10019FF6+50p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		and	dword ptr [esi], 0
		test	eax, eax
		jz	short loc_1001A68C
		push	eax		; void *
		call	??3@YAXPAX@Z	; operator delete(void *)
		pop	ecx

loc_1001A68C:				; CODE XREF: sub_1001A679+Aj
		mov	eax, [esp+4+arg_0]
		mov	[esi], eax
		pop	esi
		retn	4
sub_1001A679	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001A696	proc near		; CODE XREF: sub_10019D54+EFp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		and	dword ptr [esi], 0
		test	eax, eax
		jz	short loc_1001A6A9
		push	eax		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_1001A6A9:				; CODE XREF: sub_1001A696+Aj
		mov	eax, [esp+4+arg_0]
		mov	[esi], eax
		pop	esi
		retn	4
sub_1001A696	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001A6B3	proc near		; CODE XREF: sub_10019D54+14Ep
					; sub_1001A0FF+10Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	esi
		mov	esi, ecx
		test	ebx, ebx
		jnz	short loc_1001A6CD
		mov	eax, [esp+8+arg_4]
		cmp	eax, [esi+10h]
		jb	short loc_1001A737
		mov	eax, [esi+10h]
		jmp	short loc_1001A737
; ---------------------------------------------------------------------------

loc_1001A6CD:				; CODE XREF: sub_1001A6B3+Aj
		mov	eax, [esi+10h]
		push	ebp
		push	edi
		cmp	ebx, eax
		ja	short loc_1001A732
		mov	ecx, [esp+10h+arg_4]
		sub	eax, ebx
		cmp	ecx, eax
		jb	short loc_1001A6E2
		mov	ecx, eax

loc_1001A6E2:				; CODE XREF: sub_1001A6B3+2Bj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1001A6EC
		mov	eax, [esi]
		jmp	short loc_1001A6EE
; ---------------------------------------------------------------------------

loc_1001A6EC:				; CODE XREF: sub_1001A6B3+33j
		mov	eax, esi

loc_1001A6EE:				; CODE XREF: sub_1001A6B3+37j
		mov	ebp, [esp+10h+arg_0]
		lea	edi, [eax+ecx*2]

loc_1001A6F5:				; CODE XREF: sub_1001A6B3+6Dj
		movzx	eax, word ptr [ebp+0]
		cmp	[edi], ax
		jnz	short loc_1001A70D
		push	ebx
		push	ebp
		push	edi
		call	sub_10003E85
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001A722

loc_1001A70D:				; CODE XREF: sub_1001A6B3+49j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1001A717
		mov	eax, [esi]
		jmp	short loc_1001A719
; ---------------------------------------------------------------------------

loc_1001A717:				; CODE XREF: sub_1001A6B3+5Ej
		mov	eax, esi

loc_1001A719:				; CODE XREF: sub_1001A6B3+62j
		cmp	edi, eax
		jz	short loc_1001A732
		sub	edi, 2
		jmp	short loc_1001A6F5
; ---------------------------------------------------------------------------

loc_1001A722:				; CODE XREF: sub_1001A6B3+58j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1001A72A
		mov	esi, [esi]

loc_1001A72A:				; CODE XREF: sub_1001A6B3+73j
		sub	edi, esi
		sar	edi, 1
		mov	eax, edi
		jmp	short loc_1001A735
; ---------------------------------------------------------------------------

loc_1001A732:				; CODE XREF: sub_1001A6B3+21j
					; sub_1001A6B3+68j
		or	eax, 0FFFFFFFFh

loc_1001A735:				; CODE XREF: sub_1001A6B3+7Dj
		pop	edi
		pop	ebp

loc_1001A737:				; CODE XREF: sub_1001A6B3+13j
					; sub_1001A6B3+18j
		pop	esi
		pop	ebx
		retn	0Ch
sub_1001A6B3	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001A73C(wchar_t *DstBuf, size_t MaxCount, wchar_t *Format, char ArgList)
sub_1001A73C	proc near		; CODE XREF: sub_1001A759+46p

DstBuf		= dword	ptr  4
MaxCount	= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= byte ptr  10h

		lea	eax, [esp+ArgList]
		push	eax		; ArgList
		push	[esp+4+Format]	; Format
		push	[esp+8+MaxCount] ; MaxCount
		push	10h		; SizeInWords
		push	[esp+10h+DstBuf] ; DstBuf
		call	ds:_vsnwprintf_s
		add	esp, 14h
		retn
sub_1001A73C	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001A759(HWINSTA hWinSta, int)
sub_1001A759	proc near		; CODE XREF: sub_10016761+A5p
					; sub_10016761+11Bp

sa		= _SECURITY_ATTRIBUTES ptr -8Ch
lpszDesktop	= dword	ptr -80h
var_6C		= dword	ptr -6Ch
pSid		= byte ptr -68h
DstBuf		= word ptr -24h
var_4		= dword	ptr -4
hWinSta		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+8Ch+var_4], eax
		push	ebp
		push	esi
		mov	esi, [esp+94h+arg_4]
		lea	ecx, [esp+94h+lpszDesktop]
		push	edi
		mov	edi, [esp+98h+hWinSta]
		push	offset aSbox_alternate ; "sbox_alternate_desktop_"
		call	sub_10001E8D
		call	ds:GetCurrentProcessId
		push	eax		; ArgList
		push	offset Format	; "0x%X"
		lea	eax, [esp+0A0h+DstBuf]
		push	10h		; MaxCount
		push	eax		; DstBuf
		call	sub_1001A73C
		lea	eax, [esp+0A8h+DstBuf]
		push	eax
		call	sub_100024E3
		add	esp, 14h
		lea	ecx, [esp+98h+lpszDesktop]
		push	eax		; int
		lea	eax, [esp+9Ch+DstBuf]
		push	eax		; void *
		call	sub_10003950
		xor	eax, eax
		mov	[esp+98h+sa.nLength], eax
		mov	[esp+98h+sa.lpSecurityDescriptor], eax
		mov	[esp+98h+sa.bInheritHandle], eax
		lea	eax, [esp+98h+sa]
		push	eax		; ppDacl
		call	ds:GetCurrentThreadId
		push	eax		; dwThreadId
		call	ds:GetThreadDesktop
		push	eax		; handle
		call	sub_1001A9C8
		pop	ecx
		pop	ecx
		test	al, al
		jz	short loc_1001A810
		call	ds:GetProcessWindowStation
		mov	ebp, eax
		test	edi, edi
		jz	short loc_1001A83A
		push	edi		; hWinSta
		call	ds:SetProcessWindowStation
		test	eax, eax
		jnz	short loc_1001A83A
		push	[esp+98h+sa.lpSecurityDescriptor] ; hMem
		call	ds:LocalFree

loc_1001A810:				; CODE XREF: sub_1001A759+94j
					; sub_1001A759+128j
		push	0Bh

loc_1001A812:				; CODE XREF: sub_1001A759+123j
		pop	esi

loc_1001A813:				; CODE XREF: sub_1001A759+14Bj
		push	0		; int
		push	1		; char
		lea	ecx, [esp+0A0h+lpszDesktop] ; void *
		call	sub_100022C1
		mov	ecx, [esp+98h+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 8Ch
		retn
; ---------------------------------------------------------------------------

loc_1001A83A:				; CODE XREF: sub_1001A759+A0j
					; sub_1001A759+ABj
		cmp	[esp+98h+var_6C], 8
		mov	eax, [esp+98h+lpszDesktop]
		jnb	short loc_1001A849
		lea	eax, [esp+98h+lpszDesktop]

loc_1001A849:				; CODE XREF: sub_1001A759+EAj
		lea	ecx, [esp+98h+sa]
		push	ecx		; lpsa
		push	0E0003h		; dwDesiredAccess
		xor	ecx, ecx
		push	ecx		; dwFlags
		push	ecx		; pDevmode
		push	ecx		; lpszDevice
		push	eax		; lpszDesktop
		call	ds:CreateDesktopW
		push	[esp+98h+sa.lpSecurityDescriptor] ; hMem
		mov	[esi], eax
		call	ds:LocalFree
		test	edi, edi
		jz	short loc_1001A87E
		push	ebp		; hWinSta
		call	ds:SetProcessWindowStation
		test	eax, eax
		jnz	short loc_1001A87E
		push	0Dh
		jmp	short loc_1001A812
; ---------------------------------------------------------------------------

loc_1001A87E:				; CODE XREF: sub_1001A759+114j
					; sub_1001A759+11Fj
		cmp	dword ptr [esi], 0
		jz	short loc_1001A810
		push	0D013Eh		; int
		push	3		; int
		push	12h		; WellKnownSidType
		lea	ecx, [esp+0A4h+pSid] ; pSid
		call	sub_10017F98
		push	eax		; int
		push	7		; ObjectType
		push	dword ptr [esi]	; handle
		call	sub_1000815A
		add	esp, 14h
		xor	esi, esi
		jmp	loc_1001A813
sub_1001A759	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001A8A9	proc near		; CODE XREF: sub_10016761+48p

sa		= _SECURITY_ATTRIBUTES ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	esi
		xor	esi, esi
		lea	eax, [ebp+sa]
		push	eax		; ppDacl
		mov	[ebp+sa.nLength], esi
		mov	[ebp+sa.lpSecurityDescriptor], esi
		mov	[ebp+sa.bInheritHandle], esi
		call	ds:GetProcessWindowStation
		push	eax		; handle
		call	sub_1001A9C8
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_1001A8D6
		push	0Ch
		pop	eax
		jmp	short loc_1001A901
; ---------------------------------------------------------------------------

loc_1001A8D6:				; CODE XREF: sub_1001A8A9+26j
		lea	eax, [ebp+sa]
		push	eax		; lpsa
		push	80000008h	; dwDesiredAccess
		push	esi		; dwReserved
		push	esi		; lpwinsta
		call	ds:CreateWindowStationW
		mov	esi, [ebp+arg_0]
		push	[ebp+sa.lpSecurityDescriptor] ;	hMem
		mov	[esi], eax
		call	ds:LocalFree
		mov	eax, [esi]
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFFFF4h
		add	eax, 0Ch

loc_1001A901:				; CODE XREF: sub_1001A8A9+2Bj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001A8A9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001A906(int,	HANDLE hObj, HANDLE)
sub_1001A906	proc near		; CODE XREF: sub_10016955+4Ap

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
hObj		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+hObj]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		xor	ebx, ebx
		push	edi
		mov	edi, [ebp+arg_8]
		mov	[ebp+var_38], ebx
		test	edi, edi
		jnz	short loc_1001A93C
		xor	eax, eax
		mov	dword ptr [esi+14h], 7
		mov	[esi+10h], ebx
		mov	[esi], ax
		jmp	short loc_1001A9B5
; ---------------------------------------------------------------------------

loc_1001A93C:				; CODE XREF: sub_1001A906+23j
		xor	ecx, ecx
		mov	[ebp+var_8], 7
		mov	[ebp+var_C], ebx
		mov	[ebp+var_1C], cx
		test	eax, eax
		jz	short loc_1001A97C
		push	eax		; hObj
		lea	eax, [ebp+var_34]
		push	eax		; int
		call	sub_1001A9FC
		pop	ecx
		pop	ecx
		push	eax		; void *
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_1000402F
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1
		push	5Ch
		push	1
		lea	ecx, [ebp+var_1C]
		call	sub_100037D9

loc_1001A97C:				; CODE XREF: sub_1001A906+48j
		lea	eax, [ebp+var_34]
		push	edi		; hObj
		push	eax		; int
		call	sub_1001A9FC
		pop	ecx
		pop	ecx
		push	0FFFFFFFFh
		push	ebx
		push	eax
		lea	ecx, [ebp+var_1C]
		call	sub_100038B8
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+var_34] ; void *
		call	sub_100022C1
		lea	eax, [ebp+var_1C]
		mov	ecx, esi
		push	eax		; void *
		call	sub_10003AFA
		push	ebx		; int
		push	1		; char
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100022C1

loc_1001A9B5:				; CODE XREF: sub_1001A906+34j
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1001A906	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001A9C8(HANDLE handle, PACL ppDacl)
sub_1001A9C8	proc near		; CODE XREF: sub_1001A759+8Bp
					; sub_1001A8A9+1Dp

handle		= dword	ptr  8
ppDacl		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+ppDacl]
		xor	ecx, ecx
		mov	[ebp+ppDacl], ecx
		mov	[eax+8], ecx
		mov	dword ptr [eax], 0Ch
		add	eax, 4
		push	eax		; ppSecurityDescriptor
		push	ecx		; ppSacl
		lea	eax, [ebp+ppDacl]
		push	eax		; ppDacl
		push	ecx		; ppsidGroup
		push	ecx		; ppsidOowner
		push	4		; SecurityInfo
		push	7		; ObjectType
		push	[ebp+handle]	; handle
		call	ds:GetSecurityInfo
		neg	eax
		sbb	al, al
		inc	al
		pop	ebp
		retn
sub_1001A9C8	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001A9FC(int,	HANDLE hObj)
sub_1001A9FC	proc near		; CODE XREF: sub_10016761+67p
					; sub_10016761+C1p ...

nLengthNeeded	= dword	ptr -4
arg_0		= dword	ptr  4
hObj		= dword	ptr  8

		push	ecx
		push	ebx
		push	ebp
		push	edi
		xor	ebx, ebx
		lea	eax, [esp+10h+nLengthNeeded]
		push	eax		; lpnLengthNeeded
		push	ebx		; nLength
		push	ebx		; pvInfo
		push	2
		pop	ebp
		push	ebp		; nIndex
		push	[esp+20h+hObj]	; hObj
		mov	[esp+24h+nLengthNeeded], ebx
		mov	edi, ds:GetUserObjectInformationW
		mov	[esp+24h+nLengthNeeded], ebx
		call	edi ; GetUserObjectInformationW
		mov	eax, [esp+10h+nLengthNeeded]
		xor	ecx, ecx
		test	eax, eax
		jnz	short loc_1001AA3E
		mov	eax, [esp+10h+arg_0]
		mov	dword ptr [eax+14h], 7
		mov	[eax+10h], ebx
		mov	[eax], cx
		jmp	short loc_1001AAA0
; ---------------------------------------------------------------------------

loc_1001AA3E:				; CODE XREF: sub_1001A9FC+2Dj
		mul	ebp
		push	esi
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_1001AAE8
		pop	ecx
		mov	esi, eax
		lea	eax, [esp+14h+nLengthNeeded]
		push	eax		; lpnLengthNeeded
		push	[esp+18h+nLengthNeeded]	; nLength
		push	esi		; pvInfo
		push	ebp		; nIndex
		push	[esp+24h+hObj]	; hObj
		call	edi ; GetUserObjectInformationW
		test	eax, eax
		jnz	short loc_1001AA86
		mov	edi, [esp+14h+arg_0]
		mov	dword ptr [edi+14h], 7
		mov	[edi+10h], ebx
		mov	[edi], ax
		test	esi, esi
		jz	short loc_1001AA82
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_1001AA82:				; CODE XREF: sub_1001A9FC+7Dj
		mov	eax, edi
		jmp	short loc_1001AA9F
; ---------------------------------------------------------------------------

loc_1001AA86:				; CODE XREF: sub_1001A9FC+68j
		mov	ecx, [esp+14h+arg_0]
		push	esi		; void *
		call	sub_10001E8D
		test	esi, esi
		jz	short loc_1001AA9B
		push	esi		; void *
		call	??_V@YAXPAX@Z	; operator delete[](void *)
		pop	ecx

loc_1001AA9B:				; CODE XREF: sub_1001A9FC+96j
		mov	eax, [esp+14h+arg_0]

loc_1001AA9F:				; CODE XREF: sub_1001A9FC+88j
		pop	esi

loc_1001AAA0:				; CODE XREF: sub_1001A9FC+40j
		pop	edi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_1001A9FC	endp

; ---------------------------------------------------------------------------
		align 2
; [00000006 BYTES: COLLAPSED FUNCTION ConvertStringSidToSidW]
; [00000006 BYTES: COLLAPSED FUNCTION ConvertStringSecurityDescriptorToSecurityDescriptorW]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::_Lock(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::_Unlock(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::imbue(std::locale const &)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::setbuf(char *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::showmanyc(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::sync(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::uflow(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::xsgetn(char *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::xsputn(char const *,__int64)]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001AAE8	proc near		; CODE XREF: sub_10006BFD+2Ep
					; sub_1000A247+6Ep ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	??2@YAPAXI@Z	; operator new(uint)
sub_1001AAE8	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001AAF1	proc near		; CODE XREF: std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)+Cp
		mov	ecx, [ecx+4]
		mov	eax, [ecx]
		call	dword ptr [eax+8]
		test	eax, eax
		jz	short locret_1001AB05
		mov	edx, [eax]
		mov	ecx, eax
		push	1
		call	dword ptr [edx]

locret_1001AB05:			; CODE XREF: sub_1001AAF1+Aj
		retn
sub_1001AAF1	endp

; [00000024 BYTES: COLLAPSED FUNCTION std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)]
; [00000028 BYTES: COLLAPSED FUNCTION std::_Facet_Register(std::_Facet_base *)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Lock(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Unlock(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::imbue(std::locale const &)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::setbuf(wchar_t *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::showmanyc(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sync(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::uflow(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsgetn(wchar_t *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsputn(wchar_t const *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION _purecall]
; [00000006 BYTES: COLLAPSED FUNCTION operator new(uint)]
; [00000006 BYTES: COLLAPSED FUNCTION operator delete(void *)]
; [0000003C BYTES: COLLAPSED FUNCTION ___atonexitinit]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001ABD6(_onexit_t)
sub_1001ABD6	proc near		; CODE XREF: sub_1000EAA8+2Fp
					; sub_1001AC7F+6p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Ptr		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	14h
		push	offset stru_100303D8
		call	__SEH_prolog4
		and	[ebp+var_24], 0
		push	Ptr		; Ptr
		mov	esi, ds:DecodePointer
		call	esi ; DecodePointer
		mov	[ebp+Ptr], eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001AC08
		push	[ebp+arg_0]	; _onexit_t
		call	ds:_onexit
		pop	ecx
		jmp	short loc_1001AC6D
; ---------------------------------------------------------------------------

loc_1001AC08:				; CODE XREF: sub_1001ABD6+24j
		push	8
		call	_lock
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	Ptr		; Ptr
		call	esi ; DecodePointer
		mov	[ebp+Ptr], eax
		push	dword_1003415C	; Ptr
		call	esi ; DecodePointer
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		push	eax
		lea	eax, [ebp+Ptr]
		push	eax
		push	[ebp+arg_0]	; Ptr
		mov	esi, ds:EncodePointer
		call	esi ; EncodePointer
		push	eax
		call	__dllonexit
		add	esp, 0Ch
		mov	edi, eax
		mov	[ebp+var_24], edi
		push	[ebp+Ptr]	; Ptr
		call	esi ; EncodePointer
		mov	Ptr, eax
		push	[ebp+var_20]	; Ptr
		call	esi ; EncodePointer
		mov	dword_1003415C,	eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1001AC76
; ---------------------------------------------------------------------------

loc_1001AC6B:				; CODE XREF: sub_1001ABD6+A8j
		mov	eax, edi

loc_1001AC6D:				; CODE XREF: sub_1001ABD6+30j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1001AC73:				; DATA XREF: .rdata:stru_100303D8o
		mov	edi, [ebp+var_24] ; Finally handler 0 for function 1001ABD6

loc_1001AC76:				; CODE XREF: sub_1001ABD6+90j
		push	8
		call	_unlock
		pop	ecx
		retn
sub_1001ABD6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001AC7F(_onexit_t)
sub_1001AC7F	proc near		; CODE XREF: sub_10001000+5p
					; sub_1000100C+5p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	[ebp+arg_0]	; _onexit_t
		call	sub_1001ABD6
		neg	eax
		pop	ecx
		sbb	eax, eax
		neg	eax
		dec	eax
		pop	ebp
		retn
sub_1001AC7F	endp

; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 10h
; [0000000F BYTES: COLLAPSED FUNCTION __security_check_cookie(x)]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 10h
; [00000034 BYTES: COLLAPSED FUNCTION __allmul]
		align 10h

__aulldvrm:
		push	esi
		mov	eax, [esp+14h]
		or	eax, eax
		jnz	short loc_1001AD31
		mov	ecx, [esp+10h]
		mov	eax, [esp+0Ch]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+8]
		div	ecx
		mov	esi, eax
		mov	eax, ebx
		mul	dword ptr [esp+10h]
		mov	ecx, eax
		mov	eax, esi
		mul	dword ptr [esp+10h]
		add	edx, ecx
		jmp	short loc_1001AD78
; ---------------------------------------------------------------------------

loc_1001AD31:				; CODE XREF: .text:1001AD07j
		mov	ecx, eax
		mov	ebx, [esp+10h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]

loc_1001AD3F:				; CODE XREF: .text:1001AD49j
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_1001AD3F
		div	ebx
		mov	esi, eax
		mul	dword ptr [esp+14h]
		mov	ecx, eax
		mov	eax, [esp+10h]
		mul	esi
		add	edx, ecx
		jb	short loc_1001AD6D
		cmp	edx, [esp+0Ch]
		ja	short loc_1001AD6D
		jb	short loc_1001AD76
		cmp	eax, [esp+8]
		jbe	short loc_1001AD76

loc_1001AD6D:				; CODE XREF: .text:1001AD5Dj
					; .text:1001AD63j
		dec	esi
		sub	eax, [esp+10h]
		sbb	edx, [esp+14h]

loc_1001AD76:				; CODE XREF: .text:1001AD65j
					; .text:1001AD6Bj
		xor	ebx, ebx

loc_1001AD78:				; CODE XREF: .text:1001AD2Fj
		sub	eax, [esp+8]
		sbb	edx, [esp+0Ch]
		neg	edx
		neg	eax
		sbb	edx, 0
		mov	ecx, edx
		mov	edx, ebx
		mov	ebx, ecx
		mov	ecx, eax
		mov	eax, esi
		pop	esi
		retn	10h
; ---------------------------------------------------------------------------
		align 2
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 10h

__ftol2_sse:
		cmp	dword_10034140,	0
		jz	short __ftol2
; [00000013 BYTES: COLLAPSED FUNCTION __ftol2_pentium4]
; ---------------------------------------------------------------------------

__ftol2_sse_excpt:
		cmp	dword_10034140,	0
		jz	short __ftol2
		sub	esp, 4
		fnstcw	word ptr [esp]
		pop	eax
		and	ax, 7Fh
		cmp	ax, 7Fh
		jz	short __ftol2_pentium4
; [00000075 BYTES: COLLAPSED FUNCTION __ftol2]
		align 10h
; [00000045 BYTES: COLLAPSED FUNCTION __SEH_prolog4]
; [00000014 BYTES: COLLAPSED FUNCTION __SEH_epilog4]
; [00000023 BYTES: COLLAPSED FUNCTION __except_handler4]
		align 10h
; [000000AA BYTES: COLLAPSED FUNCTION __alldiv]
; [00000006 BYTES: COLLAPSED FUNCTION operator delete[](void *)]
; [00000048 BYTES: COLLAPSED FUNCTION __SEH_prolog4_GS]
; [0000000F BYTES: COLLAPSED FUNCTION __SEH_epilog4_GS]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION wmemcpy_s]
; [0000004C BYTES: COLLAPSED FUNCTION _pre_c_init]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001B02A	proc near		; CODE XREF: ___DllMainCRTStartup+64p
					; ___DllMainCRTStartup+A3p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		cmp	[ebp+arg_4], 0
		push	ebx
		push	esi
		push	edi
		jnz	loc_1001B165
		mov	eax, dword_10033E18
		test	eax, eax
		jle	loc_1001B15E
		dec	eax
		mov	ebx, offset dword_10034150
		mov	dword_10033E18,	eax
		xor	edi, edi
		mov	eax, large fs:18h
		mov	[ebp+var_4], edi
		mov	edx, [eax+4]
		jmp	short loc_1001B068
; ---------------------------------------------------------------------------

loc_1001B064:				; CODE XREF: sub_1001B02A+48j
		cmp	eax, edx
		jz	short loc_1001B076

loc_1001B068:				; CODE XREF: sub_1001B02A+38j
		xor	eax, eax
		mov	ecx, edx
		lock cmpxchg [ebx], ecx
		test	eax, eax
		jnz	short loc_1001B064
		jmp	short loc_1001B07D
; ---------------------------------------------------------------------------

loc_1001B076:				; CODE XREF: sub_1001B02A+3Cj
		mov	[ebp+var_4], 1

loc_1001B07D:				; CODE XREF: sub_1001B02A+4Aj
		cmp	dword_10034154,	2
		jz	short loc_1001B093
		push	1Fh
		call	_amsg_exit
		pop	ecx
		jmp	loc_1001B215
; ---------------------------------------------------------------------------

loc_1001B093:				; CODE XREF: sub_1001B02A+5Aj
		push	Ptr		; Ptr
		call	ds:DecodePointer
		mov	esi, eax
		mov	[ebp+arg_8], esi
		test	esi, esi
		jz	loc_1001B146
		push	dword_1003415C	; Ptr
		call	ds:DecodePointer
		mov	ebx, eax
		mov	[ebp+arg_4], esi
		mov	[ebp+arg_0], ebx

loc_1001B0C0:				; CODE XREF: sub_1001B02A+9Fj
					; sub_1001B02A+AAj ...
		sub	ebx, 4
		cmp	ebx, esi
		jb	short loc_1001B123
		cmp	[ebx], edi
		jz	short loc_1001B0C0
		push	edi		; Ptr
		call	ds:EncodePointer
		cmp	[ebx], eax
		jz	short loc_1001B0C0
		push	dword ptr [ebx]	; Ptr
		call	ds:DecodePointer
		push	edi		; Ptr
		mov	esi, eax
		call	ds:EncodePointer
		mov	[ebx], eax
		call	esi
		push	Ptr		; Ptr
		mov	esi, ds:DecodePointer
		call	esi ; DecodePointer
		push	dword_1003415C	; Ptr
		mov	[ebp+var_8], eax
		call	esi ; DecodePointer
		mov	ecx, [ebp+var_8]
		cmp	[ebp+arg_4], ecx
		jnz	short loc_1001B114
		mov	esi, [ebp+arg_8]
		cmp	[ebp+arg_0], eax
		jz	short loc_1001B0C0

loc_1001B114:				; CODE XREF: sub_1001B02A+E0j
		mov	esi, ecx
		mov	[ebp+arg_4], ecx
		mov	[ebp+arg_8], esi
		mov	ebx, eax
		mov	[ebp+arg_0], eax
		jmp	short loc_1001B0C0
; ---------------------------------------------------------------------------

loc_1001B123:				; CODE XREF: sub_1001B02A+9Bj
		cmp	esi, 0FFFFFFFFh
		jz	short loc_1001B130
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_1001B130:				; CODE XREF: sub_1001B02A+FCj
		push	edi		; Ptr
		call	ds:EncodePointer
		mov	dword_1003415C,	eax
		mov	ebx, offset dword_10034150
		mov	Ptr, eax

loc_1001B146:				; CODE XREF: sub_1001B02A+7Cj
		mov	dword_10034154,	edi
		cmp	[ebp+var_4], edi
		jnz	loc_1001B215
		xor	eax, eax
		xchg	eax, [ebx]
		jmp	loc_1001B215
; ---------------------------------------------------------------------------

loc_1001B15E:				; CODE XREF: sub_1001B02A+19j
					; sub_1001B02A+19Fj
		xor	eax, eax
		jmp	loc_1001B218
; ---------------------------------------------------------------------------

loc_1001B165:				; CODE XREF: sub_1001B02A+Cj
		cmp	[ebp+arg_4], 1
		jnz	loc_1001B215
		mov	eax, large fs:18h
		xor	edi, edi
		mov	esi, edi
		mov	ebx, offset dword_10034150
		mov	edx, [eax+4]
		jmp	short loc_1001B187
; ---------------------------------------------------------------------------

loc_1001B183:				; CODE XREF: sub_1001B02A+167j
		cmp	eax, edx
		jz	short loc_1001B195

loc_1001B187:				; CODE XREF: sub_1001B02A+157j
		xor	eax, eax
		mov	ecx, edx
		lock cmpxchg [ebx], ecx
		test	eax, eax
		jnz	short loc_1001B183
		jmp	short loc_1001B198
; ---------------------------------------------------------------------------

loc_1001B195:				; CODE XREF: sub_1001B02A+15Bj
		xor	esi, esi
		inc	esi

loc_1001B198:				; CODE XREF: sub_1001B02A+169j
		cmp	dword_10034154,	edi
		push	2
		pop	edi
		jz	short loc_1001B1AC
		push	1Fh
		call	_amsg_exit
		jmp	short loc_1001B1E1
; ---------------------------------------------------------------------------

loc_1001B1AC:				; CODE XREF: sub_1001B02A+177j
		push	offset dword_1001C398
		push	offset dword_1001C388
		mov	dword_10034154,	1
		call	_initterm_e
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001B15E
		push	offset dword_1001C384
		push	offset dword_1001C36C
		call	_initterm
		pop	ecx
		mov	dword_10034154,	edi

loc_1001B1E1:				; CODE XREF: sub_1001B02A+180j
		pop	ecx
		test	esi, esi
		jnz	short loc_1001B1EA
		xor	eax, eax
		xchg	eax, [ebx]

loc_1001B1EA:				; CODE XREF: sub_1001B02A+1BAj
		cmp	dword_10034158,	0
		jz	short loc_1001B20F
		push	offset dword_10034158
		call	__IsNonwritableInCurrentImage
		pop	ecx
		test	eax, eax
		jz	short loc_1001B20F
		push	[ebp+arg_8]
		push	edi
		push	[ebp+arg_0]
		call	dword_10034158

loc_1001B20F:				; CODE XREF: sub_1001B02A+1C7j
					; sub_1001B02A+1D6j
		inc	dword_10033E18

loc_1001B215:				; CODE XREF: sub_1001B02A+64j
					; sub_1001B02A+125j ...
		xor	eax, eax
		inc	eax

loc_1001B218:				; CODE XREF: sub_1001B02A+136j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1001B02A	endp

; [00000023 BYTES: COLLAPSED FUNCTION DllEntryPoint]
; [00000133 BYTES: COLLAPSED FUNCTION ___DllMainCRTStartup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
; [0000003D BYTES: COLLAPSED FUNCTION ___raise_securityfailure]
; [000000FB BYTES: COLLAPSED FUNCTION ___report_gsfailure]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001B4C2	proc near		; DATA XREF: .rdata:1001C394o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8

		push	ebp
		mov	ebp, esp
		and	dword_10034140,	0
		sub	esp, 1Ch
		push	ebx
		xor	ebx, ebx
		inc	ebx
		or	dword_10033070,	ebx
		push	0Ah		; ProcessorFeature
		call	IsProcessorFeaturePresent
		test	eax, eax
		jz	loc_1001B634
		xor	ecx, ecx
		mov	dword_10034140,	ebx
		xor	eax, eax
		cpuid
		push	esi
		mov	esi, dword_10033070
		push	edi
		lea	edi, [ebp+var_1C]
		or	esi, 2
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+var_10]
		mov	[ebp+var_C], eax
		xor	ecx, 49656E69h
		mov	eax, [ebp+var_14]
		xor	eax, 6C65746Eh
		mov	dword_10033070,	esi
		or	ecx, eax
		mov	eax, [ebp+var_18]
		xor	eax, 756E6547h
		or	ecx, eax
		neg	ecx
		push	1
		sbb	cl, cl
		pop	eax
		inc	cl
		push	0
		pop	ecx
		cpuid
		mov	[edi], eax
		mov	[edi+4], ebx
		mov	[edi+8], ecx
		mov	[edi+0Ch], edx
		mov	ecx, [ebp+var_14]
		mov	[ebp+var_8], ecx
		jz	short loc_1001B59A
		mov	eax, [ebp+var_1C]
		and	eax, 0FFF3FF0h
		cmp	eax, 106C0h
		jz	short loc_1001B589
		cmp	eax, 20660h
		jz	short loc_1001B589
		cmp	eax, 20670h
		jz	short loc_1001B589
		cmp	eax, 30650h
		jz	short loc_1001B589
		cmp	eax, 30660h
		jz	short loc_1001B589
		cmp	eax, 30670h
		jnz	short loc_1001B59A

loc_1001B589:				; CODE XREF: sub_1001B4C2+A2j
					; sub_1001B4C2+A9j ...
		mov	edi, dword_10034144
		or	edi, 1
		mov	dword_10034144,	edi
		jmp	short loc_1001B5A0
; ---------------------------------------------------------------------------

loc_1001B59A:				; CODE XREF: sub_1001B4C2+93j
					; sub_1001B4C2+C5j
		mov	edi, dword_10034144

loc_1001B5A0:				; CODE XREF: sub_1001B4C2+D6j
		cmp	[ebp+var_C], 7
		jl	short loc_1001B5DB
		push	7
		xor	ecx, ecx
		lea	esi, [ebp+var_1C]
		pop	eax
		cpuid
		mov	[esi], eax
		mov	eax, esi
		mov	esi, dword_10033070
		mov	[eax+4], ebx
		mov	[eax+8], ecx
		mov	ecx, [ebp+var_8]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_18]
		test	eax, 200h
		jz	short loc_1001B5DD
		or	edi, 2
		mov	dword_10034144,	edi
		jmp	short loc_1001B5DD
; ---------------------------------------------------------------------------

loc_1001B5DB:				; CODE XREF: sub_1001B4C2+E2j
		xor	eax, eax

loc_1001B5DD:				; CODE XREF: sub_1001B4C2+10Cj
					; sub_1001B4C2+117j
		test	ecx, 100000h
		jz	short loc_1001B632
		or	esi, 4
		mov	dword_10034140,	2
		mov	dword_10033070,	esi
		test	ecx, 8000000h
		jz	short loc_1001B632
		test	ecx, 10000000h
		jz	short loc_1001B632
		or	esi, 8
		mov	dword_10034140,	3
		mov	dword_10033070,	esi
		test	al, 20h
		jz	short loc_1001B632
		or	esi, 20h
		mov	dword_10034140,	5
		mov	dword_10033070,	esi

loc_1001B632:				; CODE XREF: sub_1001B4C2+121j
					; sub_1001B4C2+13Cj ...
		pop	edi
		pop	esi

loc_1001B634:				; CODE XREF: sub_1001B4C2+20j
		xor	eax, eax
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1001B4C2	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _except_handler4_common]
; [00000006 BYTES: COLLAPSED FUNCTION __CppXcptFilter]
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001B650	proc near		; CODE XREF: __IsNonwritableInCurrentImage+59p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		xor	edx, edx
		push	ebx
		push	esi
		push	edi
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		movzx	eax, word ptr [ecx+14h]
		movzx	ebx, word ptr [ecx+6]
		add	eax, 18h
		add	eax, ecx
		test	ebx, ebx
		jz	short loc_1001B68C
		mov	edi, [ebp+arg_4]

loc_1001B674:				; CODE XREF: sub_1001B650+3Aj
		mov	esi, [eax+0Ch]
		cmp	edi, esi
		jb	short loc_1001B684
		mov	ecx, [eax+8]
		add	ecx, esi
		cmp	edi, ecx
		jb	short loc_1001B68E

loc_1001B684:				; CODE XREF: sub_1001B650+29j
		inc	edx
		add	eax, 28h
		cmp	edx, ebx
		jb	short loc_1001B674

loc_1001B68C:				; CODE XREF: sub_1001B650+1Fj
		xor	eax, eax

loc_1001B68E:				; CODE XREF: sub_1001B650+32j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1001B650	endp

; ---------------------------------------------------------------------------
		align 10h
; [000000BA BYTES: COLLAPSED FUNCTION __IsNonwritableInCurrentImage]
		align 10h
; [00000031 BYTES: COLLAPSED FUNCTION __ValidateImageBase]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001B791	proc near		; CODE XREF: DllEntryPoint+9p

PerformanceCount= LARGE_INTEGER	ptr -14h
SystemTimeAsFileTime= _FILETIME	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		and	[ebp+SystemTimeAsFileTime.dwLowDateTime], 0
		and	[ebp+SystemTimeAsFileTime.dwHighDateTime], 0
		mov	eax, ___security_cookie
		push	esi
		push	edi
		mov	edi, 0BB40E64Eh
		mov	esi, 0FFFF0000h
		cmp	eax, edi
		jz	short loc_1001B7C1
		test	esi, eax
		jz	short loc_1001B7C1
		not	eax
		mov	dword_10033064,	eax
		jmp	short loc_1001B827
; ---------------------------------------------------------------------------

loc_1001B7C1:				; CODE XREF: sub_1001B791+21j
					; sub_1001B791+25j
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		mov	eax, [ebp+SystemTimeAsFileTime.dwHighDateTime]
		xor	eax, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		mov	[ebp+var_4], eax
		call	ds:GetCurrentThreadId
		xor	[ebp+var_4], eax
		call	ds:GetCurrentProcessId
		xor	[ebp+var_4], eax
		lea	eax, [ebp+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		mov	ecx, dword ptr [ebp+PerformanceCount+4]
		lea	eax, [ebp+var_4]
		xor	ecx, dword ptr [ebp+PerformanceCount]
		xor	ecx, [ebp+var_4]
		xor	ecx, eax
		cmp	ecx, edi
		jnz	short loc_1001B809
		mov	ecx, 0BB40E64Fh
		jmp	short loc_1001B819
; ---------------------------------------------------------------------------

loc_1001B809:				; CODE XREF: sub_1001B791+6Fj
		test	esi, ecx
		jnz	short loc_1001B819
		mov	eax, ecx
		or	eax, 4711h
		shl	eax, 10h
		or	ecx, eax

loc_1001B819:				; CODE XREF: sub_1001B791+76j
					; sub_1001B791+7Aj
		mov	___security_cookie, ecx
		not	ecx
		mov	dword_10033064,	ecx

loc_1001B827:				; CODE XREF: sub_1001B791+2Ej
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001B791	endp

; [00000022 BYTES: COLLAPSED FUNCTION DllMain(x,x,x)]

; =============== S U B	R O U T	I N E =======================================


sub_1001B84F	proc near		; CODE XREF: _pre_c_init+2Cp
		push	esi
		push	edi
		mov	esi, offset dword_10030078
		mov	edi, offset dword_10030078
		jmp	short loc_1001B868
; ---------------------------------------------------------------------------

loc_1001B85D:				; CODE XREF: sub_1001B84F+1Bj
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1001B865
		call	eax

loc_1001B865:				; CODE XREF: sub_1001B84F+12j
		add	esi, 4

loc_1001B868:				; CODE XREF: sub_1001B84F+Cj
		cmp	esi, edi
		jb	short loc_1001B85D
		pop	edi
		pop	esi
		retn
sub_1001B84F	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001B86F()
sub_1001B86F	proc near		; DATA XREF: _pre_c_init+31o
		push	esi
		push	edi
		mov	esi, offset dword_10030080
		mov	edi, offset dword_10030080
		jmp	short loc_1001B888
; ---------------------------------------------------------------------------

loc_1001B87D:				; CODE XREF: sub_1001B86F+1Bj
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1001B885
		call	eax

loc_1001B885:				; CODE XREF: sub_1001B86F+12j
		add	esi, 4

loc_1001B888:				; CODE XREF: sub_1001B86F+Cj
		cmp	esi, edi
		jb	short loc_1001B87D
		pop	edi
		pop	esi
		retn
sub_1001B86F	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
; [00000006 BYTES: COLLAPSED FUNCTION _initterm_e]

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001B89C()
sub_1001B89C	proc near		; DATA XREF: _pre_c_init+3Bo
		push	offset dword_10034148
		call	__clean_type_info_names_internal
		pop	ecx
		retn
sub_1001B89C	endp

; [00000006 BYTES: COLLAPSED FUNCTION _crt_debugger_hook]
; [00000006 BYTES: COLLAPSED FUNCTION __crtUnhandledException]
; [00000006 BYTES: COLLAPSED FUNCTION __crtTerminateProcess]
; [00000006 BYTES: COLLAPSED FUNCTION __clean_type_info_names_internal]
; [00000006 BYTES: COLLAPSED FUNCTION IsProcessorFeaturePresent]

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001B8C6()
sub_1001B8C6	proc near		; DATA XREF: sub_10001000o
		mov	off_10033000, offset off_1001C3DC
		retn
sub_1001B8C6	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001B8D1()
sub_1001B8D1	proc near		; DATA XREF: sub_1000100Co
		mov	off_10033004, offset off_1001C3DC
		retn
sub_1001B8D1	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001B8DC()
sub_1001B8DC	proc near		; DATA XREF: sub_10001018o
		mov	off_10033008, offset off_1001C3DC
		retn
sub_1001B8DC	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001B8E7()
sub_1001B8E7	proc near		; DATA XREF: sub_10001024+Ao

; FUNCTION CHUNK AT 10004D8B SIZE 00000008 BYTES

		mov	ecx, offset CriticalSection
		jmp	loc_10004D8B
sub_1001B8E7	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001B8F1()
sub_1001B8F1	proc near		; DATA XREF: sub_1000103Ao
		mov	ecx, offset dword_10033E14 ; this
		jmp	??1_Fac_tidy_reg_t@std@@QAE@XZ ; std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)
sub_1001B8F1	endp

; ---------------------------------------------------------------------------
		align 200h
		dd 180h	dup(?)
_text		ends

; Section 2. (virtual address 0001C000)
; Virtual size			: 00016A62 (  92770.)
; Section size in file		: 00016C00 (  93184.)
; Offset to raw	data for section: 0001AE00
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; BOOL __stdcall RevertToSelf()
		extrn RevertToSelf:dword ; CODE	XREF: sub_10019AA7:loc_10019ADDp
					; DATA XREF: sub_10019AA7:loc_10019ADDr ...
; BOOL __stdcall EqualSid(PSID pSid1, PSID pSid2)
		extrn EqualSid:dword	; CODE XREF: sub_1001457D+F4p
					; DATA XREF: sub_1001457D+F4r
; BOOL __stdcall CreateRestrictedToken(HANDLE ExistingTokenHandle, DWORD Flags,	DWORD DisableSidCount, PSID_AND_ATTRIBUTES SidsToDisable, DWORD	DeletePrivilegeCount, PLUID_AND_ATTRIBUTES PrivilegesToDelete, DWORD RestrictedSidCount, PSID_AND_ATTRIBUTES SidsToRestrict, PHANDLE NewTokenHandle)
		extrn CreateRestrictedToken:dword ; CODE XREF: sub_10014AFC+1C5p
					; DATA XREF: sub_10014AFC+1C5r
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: sub_10014E16+5Fp
					; sub_10015778+29p
					; DATA XREF: ...
; BOOL __stdcall DuplicateTokenEx(HANDLE hExistingToken, DWORD dwDesiredAccess,	LPSECURITY_ATTRIBUTES lpTokenAttributes, SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, TOKEN_TYPE TokenType,	PHANDLE	phNewToken)
		extrn DuplicateTokenEx:dword ; CODE XREF: sub_100095AD+130p
					; sub_10014AFC+1AAp
					; DATA XREF: ...
; BOOL __stdcall DuplicateToken(HANDLE ExistingTokenHandle, SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, PHANDLE DuplicateTokenHandle)
		extrn DuplicateToken:dword ; CODE XREF:	sub_100095AD+112p
					; sub_10014D90+2Ep
					; DATA XREF: ...
; BOOL __stdcall ConvertStringSidToSidW(LPCWSTR	StringSid, PSID	*Sid)
		extrn __imp_ConvertStringSidToSidW:dword
					; DATA XREF: ConvertStringSidToSidWr
; DWORD	__stdcall SetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE	ObjectType, SECURITY_INFORMATION SecurityInfo, PSID psidOowner,	PSID psidGroup,	PACL pDacl, PACL pSacl)
		extrn SetSecurityInfo:dword ; CODE XREF: sub_1000815A+87p
					; sub_10015629+10Ap
					; DATA XREF: ...
; DWORD	__stdcall GetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE	ObjectType, SECURITY_INFORMATION SecurityInfo, PSID *ppsidOowner, PSID *ppsidGroup, PACL *ppDacl, PACL *ppSacl,	PSECURITY_DESCRIPTOR *ppSecurityDescriptor)
		extrn GetSecurityInfo:dword ; CODE XREF: sub_1000815A+35p
					; sub_1001A9C8+26p
					; DATA XREF: ...
; DWORD	__stdcall SetEntriesInAclW(ULONG cCountOfExplicitEntries, PEXPLICIT_ACCESS_W pListOfExplicitEntries, PACL OldAcl, PACL *NewAcl)
		extrn SetEntriesInAclW:dword ; CODE XREF: sub_1000820F+42p
					; DATA XREF: sub_1000820F+42r
; BOOL __stdcall SetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength)
		extrn SetTokenInformation:dword	; CODE XREF: sub_10008262+57p
					; sub_100157E1+62p
					; DATA XREF: ...
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn GetTokenInformation:dword	; CODE XREF: sub_100082E5+2Fp
					; sub_1000835D+20p ...
; BOOL __stdcall CreateProcessAsUserW(HANDLE hToken, LPCWSTR lpApplicationName,	LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL	bInheritHandles, DWORD dwCreationFlags,	LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessAsUserW:dword ; CODE	XREF: sub_10019558+B5p
					; DATA XREF: sub_10019558+B5r
; BOOL __stdcall SetThreadToken(PHANDLE	Thread,	HANDLE Token)
		extrn SetThreadToken:dword ; CODE XREF:	sub_10019558+117p
					; DATA XREF: sub_10019558+117r
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn GetLengthSid:dword ; CODE	XREF: sub_100157E1+4Fp
					; DATA XREF: sub_100157E1+4Fr
; BOOL __stdcall GetSecurityDescriptorSacl(PSECURITY_DESCRIPTOR	pSecurityDescriptor, LPBOOL lpbSaclPresent, PACL *pSacl, LPBOOL	lpbSaclDefaulted)
		extrn GetSecurityDescriptorSacl:dword ;	CODE XREF: sub_10015629+F2p
					; DATA XREF: sub_10015629+F2r
; BOOL __stdcall ConvertStringSecurityDescriptorToSecurityDescriptorW(LPCWSTR StringSecurityDescriptor,	DWORD StringSDRevision,	PSECURITY_DESCRIPTOR *SecurityDescriptor, PULONG SecurityDescriptorSize)
		extrn __imp_ConvertStringSecurityDescriptorToSecurityDescriptorW:dword
					; DATA XREF: ConvertStringSecurityDescriptorToSecurityDescriptorWr
; BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid)
		extrn CopySid:dword	; CODE XREF: sub_10017F82+Ap
					; DATA XREF: sub_10017F82+Ar
; BOOL __stdcall CreateWellKnownSid(WELL_KNOWN_SID_TYPE	WellKnownSidType, PSID DomainSid, PSID pSid, DWORD *cbSid)
		extrn CreateWellKnownSid:dword ; CODE XREF: sub_10017F98+1Cp
					; DATA XREF: sub_10017F98+1Cr
; LONG __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_10019A2F+21p
					; sub_1001A2A8+7Ep
					; DATA XREF: ...
; LSTATUS __stdcall RegDisablePredefinedCache()
		extrn RegDisablePredefinedCache:dword
					; CODE XREF: sub_10019AA7:loc_10019B04p
					; DATA XREF: sub_10019AA7:loc_10019B04r
; LONG __stdcall RegOpenKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD ulOptions, REGSAM samDesired,	PHKEY phkResult)
		extrn RegOpenKeyExW:dword ; CODE XREF: sub_10019A2F+14p
					; DATA XREF: sub_10019A2F+14r
; LONG __stdcall RegCreateKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD Reserved, LPWSTR lpClass, DWORD dwOptions, REGSAM samDesired, LPSECURITY_ATTRIBUTES	lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition)
		extrn RegCreateKeyExW:dword ; CODE XREF: sub_1001A2A8+62p
					; DATA XREF: sub_1001A2A8+62r
; BOOL __stdcall LookupPrivilegeValueW(LPCWSTR lpSystemName, LPCWSTR lpName, PLUID lpLuid)
		extrn LookupPrivilegeValueW:dword ; CODE XREF: sub_100149CA+CEp
					; DATA XREF: sub_100149CA+CEr

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_10005C4D+Cp
					; sub_1001B791+59p
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceFrequency(LARGE_INTEGER *lpFrequency)
		extrn QueryPerformanceFrequency:dword ;	CODE XREF: sub_10005910+4Bp
					; DATA XREF: sub_10005910+4Br
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_1001B791+34p
					; DATA XREF: sub_1001B791+34r
; HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName)
		extrn GetModuleHandleW:dword ; CODE XREF: sub_10006B5D+48p
					; sub_10006C8E+13Dp ...
; BOOL __stdcall GetVersionExW(LPOSVERSIONINFOW	lpVersionInformation)
		extrn GetVersionExW:dword ; CODE XREF: sub_10006C8E+66p
					; DATA XREF: sub_10006C8E+66r
; void __stdcall GetNativeSystemInfo(LPSYSTEM_INFO lpSystemInfo)
		extrn GetNativeSystemInfo:dword	; CODE XREF: sub_10006C8E+EEp
					; DATA XREF: sub_10006C8E+EEr
; BOOL __stdcall SetEvent(HANDLE hEvent)
		extrn SetEvent:dword	; CODE XREF: sub_100075DB+63p
					; sub_100095AD+493p ...
; BOOL __stdcall ResetEvent(HANDLE hEvent)
		extrn ResetEvent:dword	; CODE XREF: sub_100075DB+3Ap
					; StartAddress+114p
					; DATA XREF: ...
; HANDLE __stdcall CreateEventW(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState,	LPCWSTR	lpName)
		extrn CreateEventW:dword ; CODE	XREF: sub_10007949+2Bp
					; sub_10007949+35p ...
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: sub_1000774A+194p
					; sub_1001944D+27p
					; DATA XREF: ...
; DWORD	__stdcall SuspendThread(HANDLE hThread)
		extrn SuspendThread:dword ; CODE XREF: sub_100075DB+56p
					; DATA XREF: sub_100075DB+56r
; BOOL __stdcall CreateProcessW(LPCWSTR	lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessW:dword ; CODE XREF:	sub_1000774A+167p
					; sub_10013263+23p
					; DATA XREF: ...
; LPVOID __stdcall VirtualAllocEx(HANDLE hProcess, LPVOID lpAddress, DWORD dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAllocEx:dword ; CODE XREF:	sub_10007949+90p
					; sub_1000D0F8+53p ...
; BOOL __stdcall ReadProcessMemory(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, DWORD nSize, LPDWORD lpNumberOfBytesRead)
		extrn ReadProcessMemory:dword ;	CODE XREF: sub_10007666+2Fp
					; sub_100076BB+23p ...
; BOOL __stdcall WriteProcessMemory(HANDLE hProcess, LPVOID lpBaseAddress, LPVOID lpBuffer, DWORD nSize, LPDWORD lpNumberOfBytesWritten)
		extrn WriteProcessMemory:dword ; CODE XREF: sub_100076BB+6Fp
					; sub_10007949+CDp ...
; DWORD	__stdcall GetModuleFileNameW(HMODULE hModule, LPWSTR lpFilename, DWORD nSize)
		extrn GetModuleFileNameW:dword ; CODE XREF: sub_1000774A+34p
					; DATA XREF: sub_1000774A+34r
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
		extrn LocalFree:dword	; CODE XREF: sub_1000815A+73p
					; sub_1000815A+98p ...
; HANDLE __stdcall CreateIoCompletionPort(HANDLE FileHandle, HANDLE ExistingCompletionPort, DWORD CompletionKey, DWORD NumberOfConcurrentThreads)
		extrn CreateIoCompletionPort:dword ; CODE XREF:	sub_100093CC+1Fp
					; DATA XREF: sub_100093CC+1Fr
; BOOL __stdcall GetQueuedCompletionStatus(HANDLE CompletionPort, LPDWORD lpNumberOfBytesTransferred, LPDWORD lpCompletionKey, LPOVERLAPPED *lpOverlapped, DWORD dwMilliseconds)
		extrn GetQueuedCompletionStatus:dword ;	CODE XREF: StartAddress+1BBp
					; DATA XREF: StartAddress+1BBr
; BOOL __stdcall PostQueuedCompletionStatus(HANDLE CompletionPort, DWORD dwNumberOfBytesTransferred, DWORD dwCompletionKey, LPOVERLAPPED lpOverlapped)
		extrn PostQueuedCompletionStatus:dword ; CODE XREF: sub_10008FB1+23p
					; Callback+Ep
					; DATA XREF: ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_10008F65+23p
					; sub_100093CC+14p ...
; DWORD	__stdcall GetProcessId(HANDLE Process)
		extrn GetProcessId:dword ; CODE	XREF: sub_100091B7+21p
					; DATA XREF: sub_100091B7+21r
; BOOL __stdcall UnregisterWaitEx(HANDLE WaitHandle, HANDLE CompletionEvent)
		extrn UnregisterWaitEx:dword ; CODE XREF: sub_10009321+10p
					; sub_10019C2F+4Dp
					; DATA XREF: ...
; BOOL __stdcall RegisterWaitForSingleObject(PHANDLE phNewWaitObject, HANDLE hObject, WAITORTIMERCALLBACK Callback, PVOID Context, ULONG dwMilliseconds, ULONG dwFlags)
		extrn RegisterWaitForSingleObject:dword	; CODE XREF: sub_100091B7+D5p
					; sub_10019BCA+29p
					; DATA XREF: ...
; BOOL __stdcall TerminateJobObject(HANDLE hJob, UINT uExitCode)
		extrn TerminateJobObject:dword ; CODE XREF: sub_1000934F+16p
					; StartAddress+86p
					; DATA XREF: ...
; BOOL __stdcall SetInformationJobObject(HANDLE	hJob, JOBOBJECTINFOCLASS JobObjectInformationClass, LPVOID lpJobObjectInformation, DWORD cbJobObjectInformationLength)
		extrn SetInformationJobObject:dword ; CODE XREF: sub_100092CE+1Cp
					; sub_1000FC06+C9p ...
; BOOL __stdcall VirtualFreeEx(HANDLE hProcess,	LPVOID lpAddress, DWORD	dwSize,	DWORD dwFreeType)
		extrn VirtualFreeEx:dword ; CODE XREF: sub_1000D0F8+A6p
					; sub_1000ED82+65p
					; DATA XREF: ...
; BOOL __stdcall GetProcessHandleCount(HANDLE hProcess,	PDWORD pdwHandleCount)
		extrn GetProcessHandleCount:dword ; CODE XREF: sub_1000E09A+24p
					; DATA XREF: sub_1000E09A+24r
; BOOL __stdcall VirtualFree(LPVOID lpAddress, DWORD dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: sub_1000E258+1A1p
					; DATA XREF: sub_1000E258+1A1r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_1000E983+15p
					; sub_1000EA2B+1Dp ...
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: sub_1000E983+3Ep
					; DATA XREF: sub_1000E983+3Er
; BOOL __stdcall VirtualProtectEx(HANDLE hProcess, LPVOID lpAddress, DWORD dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtectEx:dword ; CODE XREF: sub_1000F322+173p
					; sub_1001A611+16p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: sub_1000F01E+2DAp
					; sub_10019720+2Cp ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_1000F01E+E8p
					; sub_10019720+9p ...
; HANDLE __stdcall CreateJobObjectW(LPSECURITY_ATTRIBUTES lpJobAttributes, LPCWSTR lpName)
		extrn CreateJobObjectW:dword ; CODE XREF: sub_1000FC06+2Ap
					; DATA XREF: sub_1000FC06+2Ar
; BOOL __stdcall AssignProcessToJobObject(HANDLE hJob, HANDLE hProcess)
		extrn AssignProcessToJobObject:dword ; CODE XREF: sub_10019558+EFp
					; DATA XREF: sub_10019558+EFr
; HANDLE __stdcall CreateNamedPipeW(LPCWSTR lpName, DWORD dwOpenMode, DWORD dwPipeMode,	DWORD nMaxInstances, DWORD nOutBufferSize, DWORD nInBufferSize,	DWORD nDefaultTimeOut, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateNamedPipeW:dword ; CODE XREF: sub_100101C3+1Cp
					; DATA XREF: sub_100101C3+1Cr
; void __stdcall DebugBreak()
		extrn DebugBreak:dword	; CODE XREF: sub_10010834+24p
					; DATA XREF: sub_10010834+24r
; int __stdcall	lstrlenW(LPCWSTR lpString)
		extrn lstrlenW:dword	; CODE XREF: sub_10010A4E+16p
					; DATA XREF: sub_10010A4E+16r
; BOOL __stdcall HeapSetInformation(HANDLE HeapHandle, HEAP_INFORMATION_CLASS HeapInformationClass, PVOID HeapInformation, SIZE_T HeapInformationLength)
		extrn HeapSetInformation:dword ; CODE XREF: sub_10011B14+84p
					; DATA XREF: sub_10011B14+84r
; DWORD	__stdcall VirtualQueryEx(HANDLE	hProcess, LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, DWORD dwLength)
		extrn VirtualQueryEx:dword ; CODE XREF:	sub_10011D32+4Cp
					; DATA XREF: sub_10011D32+4Cr
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_10011B14+30p
					; DATA XREF: sub_10011B14+30r
; DWORD	__stdcall SearchPathW(LPCWSTR lpPath, LPCWSTR lpFileName, LPCWSTR lpExtension, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart)
		extrn SearchPathW:dword	; CODE XREF: sub_1001210F+53p
					; sub_1001210F+83p
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentDirectoryW(DWORD nBufferLength, LPWSTR lpBuffer)
		extrn GetCurrentDirectoryW:dword
					; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+169p
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+FEp
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: sub_10019558+16Ap
					; sub_100198E3+10p ...
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: sub_10016A09+11p
					; DATA XREF: sub_10016A09+11r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_10016C44+2Bp
					; DATA XREF: sub_10016C44+2Br
; DWORD	__stdcall SignalObjectAndWait(HANDLE hObjectToSignal, HANDLE hObjectToWaitOn, DWORD dwMilliseconds, BOOL bAlertable)
		extrn SignalObjectAndWait:dword	; CODE XREF: sub_100175C5+39p
					; DATA XREF: sub_100175C5+39r
; HANDLE __stdcall CreateMutexW(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCWSTR lpName)
		extrn CreateMutexW:dword ; CODE	XREF: sub_10017726+49p
					; DATA XREF: sub_10017726+49r
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; CODE XREF: sub_10017798+45p
					; DATA XREF: sub_10017798+45r
; BOOL __stdcall ProcessIdToSessionId(DWORD dwProcessId, DWORD *pSessionId)
		extrn ProcessIdToSessionId:dword ; CODE	XREF: sub_10018F87+4Ep
					; DATA XREF: sub_10018F87+4Er
; BOOL __stdcall GetThreadContext(HANDLE hThread, LPCONTEXT lpContext)
		extrn GetThreadContext:dword ; CODE XREF: sub_10019558+139p
					; DATA XREF: sub_10019558+139r
; HANDLE __stdcall CreateFileMappingW(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCWSTR lpName)
		extrn CreateFileMappingW:dword ; CODE XREF: sub_10019774+21p
					; DATA XREF: sub_10019774+21r
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, DWORD	dwNumberOfBytesToMap)
		extrn MapViewOfFile:dword ; CODE XREF: sub_10019774+6Bp
					; DATA XREF: sub_10019774+6Br
; DWORD	__stdcall GetFileAttributesW(LPCWSTR lpFileName)
		extrn GetFileAttributesW:dword ; CODE XREF: sub_1001A0FF+D0p
					; DATA XREF: sub_1001A0FF+D0r
; DWORD	__stdcall GetLongPathNameW(LPCWSTR lpszShortPath, LPWSTR lpszLongPath, DWORD cchBuffer)
		extrn GetLongPathNameW:dword ; CODE XREF: sub_10019D54+C5p
					; sub_10019D54+10Ap
					; DATA XREF: ...
; DWORD	__stdcall QueryDosDeviceW(LPCWSTR lpDeviceName,	LPWSTR lpTargetPath, DWORD ucchMax)
		extrn QueryDosDeviceW:dword ; CODE XREF: sub_1001A3B3+18Ep
					; DATA XREF: sub_1001A3B3+18Er
; PVOID	__stdcall DecodePointer(PVOID Ptr)
		extrn DecodePointer:dword ; CODE XREF: sub_1001ABD6+1Cp
					; sub_1001ABD6+44p ...
; PVOID	__stdcall EncodePointer(PVOID Ptr)
		extrn EncodePointer:dword ; CODE XREF: ___atonexitinit+1Cp
					; sub_1001ABD6+65p ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_10004E1F+14p
					; sub_10004E1F+65p ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, DWORD	dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter,	DWORD dwCreationFlags, LPDWORD lpThreadId)
		extrn CreateThread:dword ; CODE	XREF: sub_100093CC+47p
					; DATA XREF: sub_100093CC+47r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_100069DA+19p
					; sub_100069DA+23p ...
; BOOL __stdcall DisableThreadLibraryCalls(HMODULE hLibModule)
		extrn DisableThreadLibraryCalls:dword ;	CODE XREF: DllMain(x,x,x)+15p
					; DATA XREF: DllMain(x,x,x)+15r
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: __Thrd_yield+2p
					; DATA XREF: __Thrd_yield+2r
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: sub_100075DB+23p
					; sub_100075DB+76p ...
; void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const DWORD *lpArguments)
		extrn RaiseException:dword ; CODE XREF:	sub_10004EA1+33p
					; DATA XREF: sub_10004EA1+33r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: sub_100069DA+2Ap
					; sub_10007949+56p ...
; BOOL __stdcall IsDebuggerPresent()
		extrn IsDebuggerPresent:dword ;	CODE XREF: sub_10004E1F:loc_10004E70p
					; ___raise_securityfailure+3p
					; DATA XREF: ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_1001B8E7-16B5Bp
					; sub_10008FB1+BAp ...
; BOOL __stdcall InitializeCriticalSectionAndSpinCount(LPCRITICAL_SECTION lpCriticalSection, DWORD dwSpinCount)
		extrn InitializeCriticalSectionAndSpinCount:dword
					; CODE XREF: sub_10004D78+9p
					; DATA XREF: sub_10004D78+9r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_10004D9B+1p
					; sub_100091B7+F2p ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_10004D93+1p
					; sub_100091B7+89p ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_10006B5D+5Cp
					; sub_10006B5D+69p ...
; BOOL __stdcall GetModuleHandleExW(DWORD dwFlags, LPCWSTR lpModuleName, HMODULE *phModule)
		extrn GetModuleHandleExW:dword ; CODE XREF: sub_1000F01E+78p
					; sub_100103AB+36p ...
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn SetLastError:dword ; CODE	XREF: sub_10002021+9p
					; sub_10009571+30p ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_10001EE3+29p
					; sub_10001F1E+2Ap ...
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword
					; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+69p
					; sub_100075DB+Dp
					; DATA XREF: ...
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+72p
					; sub_100061EE+10p ...
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword
					; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+1Ep
					; mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void *	*)+32p
					; DATA XREF: ...
; BOOL __stdcall IsProcessorFeaturePresent(DWORD ProcessorFeature)
		extrn __imp_IsProcessorFeaturePresent:dword
					; DATA XREF: IsProcessorFeaturePresentr
; BOOL __stdcall SetHandleInformation(HANDLE hObject, DWORD dwMask, DWORD dwFlags)
		extrn SetHandleInformation:dword ; CODE	XREF: sub_1000E09A+166p
					; DATA XREF: sub_1000E09A+166r

;
; Imports from MSVCP120.dll
;
; public: class	std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>> &	__thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::flush(void)
		extrn ?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ:dword
					; CODE XREF: sub_100074B0+26p
					; DATA XREF: sub_100074B0+26r ...
; const	std::basic_ios<wchar_t,	struct std::char_traits<wchar_t>>::`vftable'
		extrn ??_7?$basic_ios@_WU?$char_traits@_W@std@@@std@@6B@:dword
					; DATA XREF: sub_10007449+27r
					; sub_10007575+Br
; public: static class std::locale::id std::ctype<wchar_t>::id
		extrn ?id@?$ctype@_W@std@@2V0locale@2@A:dword ;	DATA XREF: sub_100073A6+16r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::xsputn(wchar_t const *, __int64)
		extrn __imp_?xsputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPB_W_J@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsputn(wchar_t const *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::xsgetn(wchar_t *, __int64)
		extrn __imp_?xsgetn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPA_W_J@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsgetn(wchar_t *,__int64)r
; __declspec(dllimport)	protected: virtual unsigned short __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::uflow(void)
		extrn __imp_?uflow@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEGXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::uflow(void)r
; __declspec(dllimport)	protected: virtual int __thiscall std::basic_streambuf<wchar_t,	struct std::char_traits<wchar_t>>::sync(void)
		extrn __imp_?sync@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEHXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sync(void)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::showmanyc(void)
		extrn __imp_?showmanyc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::showmanyc(void)r
; __declspec(dllimport)	protected: virtual class std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>> * __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::setbuf(wchar_t *, __int64)
		extrn __imp_?setbuf@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEPAV12@PA_W_J@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::setbuf(wchar_t *,__int64)r
; __declspec(dllimport)	protected: virtual void	__thiscall std::basic_streambuf<wchar_t, struct	std::char_traits<wchar_t>>::imbue(class	std::locale const &)
		extrn __imp_?imbue@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEXABVlocale@2@@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::imbue(std::locale	const &)r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::_Unlock(void)
		extrn __imp_?_Unlock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Unlock(void)r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::_Lock(void)
		extrn __imp_?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Lock(void)r
; void __cdecl std::_Xbad_alloc(void)
		extrn ?_Xbad_alloc@std@@YAXXZ:dword ; DATA XREF: sub_10001050:loc_1000106Cr
					; sub_10001DBA:loc_10001DDAr ...
; void __cdecl std::_Xlength_error(char	const *)
		extrn ?_Xlength_error@std@@YAXPBD@Z:dword ; CODE XREF: sub_100016CF+Fp
					; sub_10002221+12p ...
; void __cdecl std::_Xout_of_range(char	const *)
		extrn ?_Xout_of_range@std@@YAXPBD@Z:dword ; CODE XREF: sub_100017AB+1Ap
					; sub_1000192D+Ep ...
; char const * __cdecl std::_Syserror_map(int)
		extrn ?_Syserror_map@std@@YAPBDH@Z:dword ; CODE	XREF: sub_100018B6+6p
					; sub_100019F3+4p
					; DATA XREF: ...
; char const * __cdecl std::_Winerror_map(int)
		extrn ?_Winerror_map@std@@YAPBDH@Z:dword ; CODE	XREF: sub_10001A42+4p
					; DATA XREF: sub_10001A42+4r
; private: static void __cdecl std::ios_base::_Ios_base_dtor(class std::ios_base *)
		extrn ?_Ios_base_dtor@ios_base@std@@CAXPAV12@@Z:dword
					; CODE XREF: sub_10002098+1Ap
					; sub_10007575+1Ap
					; DATA XREF: ...
; protected: __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::basic_streambuf<char, struct	std::char_traits<char>>(void)
		extrn ??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10001EBC+3p
					; DATA XREF: sub_10001EBC+3r
; public: virtual __thiscall std::basic_streambuf<char,	struct std::char_traits<char>>::~basic_streambuf<char, struct std::char_traits<char>>(void)
		extrn ??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_1000200A+11r
; public: int __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::sputc(char)
		extrn ?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z:dword
					; CODE XREF: sub_10001B3E+7Cp
					; sub_10001B3E+CCp ...
; public: __int64 __thiscall std::basic_streambuf<char,	struct std::char_traits<char>>::sputn(char const *, __int64)
		extrn ?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z:dword
					; CODE XREF: sub_10001B3E+A3p
					; sub_10001C6D+BBp
					; DATA XREF: ...
; protected: char * __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::_Pninc(void)
		extrn ?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ:dword
					; CODE XREF: sub_10002507+5Fp
					; sub_10002507+181p
					; DATA XREF: ...
; public: void __thiscall std::basic_ios<char, struct std::char_traits<char>>::setstate(int, bool)
		extrn ?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z:dword
					; CODE XREF: sub_10001B3E+102p
					; sub_10001C6D+11Fp
					; DATA XREF: ...
; public: __thiscall std::basic_ostream<char, struct std::char_traits<char>>::basic_ostream<char, struct std::char_traits<char>>(class std::basic_streambuf<char, struct std::char_traits<char>> *, bool)
		extrn ??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_streambuf@DU?$char_traits@D@std@@@1@_N@Z:dword
					; CODE XREF: sub_10001DE3+30p
					; DATA XREF: sub_10001DE3+30r
; public: virtual __thiscall std::basic_ostream<char, struct std::char_traits<char>>::~basic_ostream<char, struct std::char_traits<char>>(void)
		extrn ??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_10001FDA+2Ar
; public: void __thiscall std::basic_ostream<char, struct std::char_traits<char>>::_Osfx(void)
		extrn ?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ:dword
					; CODE XREF: sub_10001B3E+10Ep
					; sub_10001C6D+12Bp
					; DATA XREF: ...
; public: class	std::basic_ostream<char, struct	std::char_traits<char>>	& __thiscall std::basic_ostream<char, struct std::char_traits<char>>::operator<<(int)
		extrn ??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z:dword
					; CODE XREF: sub_10016434+8Ep
					; sub_10016434+9Ep ...
; public: class	std::basic_ostream<char, struct	std::char_traits<char>>	& __thiscall std::basic_ostream<char, struct std::char_traits<char>>::operator<<(unsigned int)
		extrn ??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z:dword
					; CODE XREF: sub_100035CB+4Dp
					; sub_100035CB+5Dp
					; DATA XREF: ...
; public: class	std::basic_ostream<char, struct	std::char_traits<char>>	& __thiscall std::basic_ostream<char, struct std::char_traits<char>>::flush(void)
		extrn ?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ:dword
					; CODE XREF: sub_10001F97+26p
					; DATA XREF: sub_10001F97+26r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::_Lock(void)
		extrn __imp_?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::_Lock(void)r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::_Unlock(void)
		extrn __imp_?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::_Unlock(void)r
; __declspec(dllimport)	protected: virtual void	__thiscall std::basic_streambuf<char, struct std::char_traits<char>>::imbue(class std::locale const &)
		extrn __imp_?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEXABVlocale@2@@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::imbue(std::locale const	&)r
; __declspec(dllimport)	protected: virtual class std::basic_streambuf<char, struct std::char_traits<char>> * __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::setbuf(char *, __int64)
		extrn __imp_?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEPAV12@PAD_J@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::setbuf(char *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<char, struct	std::char_traits<char>>::showmanyc(void)
		extrn __imp_?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::showmanyc(void)r
; __declspec(dllimport)	protected: virtual int __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::sync(void)
		extrn __imp_?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::sync(void)r
; __declspec(dllimport)	protected: virtual int __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::uflow(void)
		extrn __imp_?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::uflow(void)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<char, struct	std::char_traits<char>>::xsgetn(char *,	__int64)
		extrn __imp_?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPAD_J@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::xsgetn(char *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<char, struct	std::char_traits<char>>::xsputn(char const *, __int64)
		extrn __imp_?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPBD_J@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::xsputn(char const *,__int64)r
; __int64 const	std::_BADOFF
		extrn ?_BADOFF@std@@3_JB:dword ; DATA XREF: sub_100026EA+38r
					; sub_100026EA+107r ...
; const	std::ios_base::`vftable'
		extrn ??_7ios_base@std@@6B@:dword ; DATA XREF: sub_10001DE3+18r
					; sub_10002098+12r ...
; const	std::basic_ios<char, struct std::char_traits<char>>::`vftable'
		extrn ??_7?$basic_ios@DU?$char_traits@D@std@@@std@@6B@:dword
					; DATA XREF: sub_10001DE3+20r
					; sub_10002098+Br
; public: __thiscall std::_Lockit::_Lockit(int)
		extrn ??0_Lockit@std@@QAE@H@Z:dword ; CODE XREF: sub_100073A6+Bp
					; DATA XREF: sub_100073A6+Br
; public: __thiscall std::_Lockit::~_Lockit(void)
		extrn ??1_Lockit@std@@QAE@XZ:dword ; CODE XREF:	sub_100073A6+6Fp
					; DATA XREF: sub_100073A6+6Fr
; public: __thiscall std::locale::id::operator unsigned	int(void)
		extrn ??Bid@locale@std@@QAEIXZ:dword ; CODE XREF: sub_100073A6+1Fp
					; DATA XREF: sub_100073A6+1Fr
; private: static class	std::locale::_Locimp * __cdecl std::locale::_Getgloballocale(void)
		extrn ?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ:dword
					; CODE XREF: sub_10007A55+22p
					; DATA XREF: sub_10007A55+22r
; public: wchar_t __thiscall std::ctype<wchar_t>::widen(char)const
		extrn ?widen@?$ctype@_W@std@@QBE_WD@Z:dword ; CODE XREF: sub_10006F3F+118p
					; DATA XREF: sub_10006F3F+118r
; public: static unsigned int __cdecl std::ctype<wchar_t>::_Getcat(class std::locale::facet const * *, class std::locale const *)
		extrn ?_Getcat@?$ctype@_W@std@@SAIPAPBVfacet@locale@2@PBV42@@Z:dword
					; CODE XREF: sub_100073A6+42p
					; DATA XREF: sub_100073A6+42r
; public: class	std::locale __thiscall std::ios_base::getloc(void)const
		extrn ?getloc@ios_base@std@@QBE?AVlocale@2@XZ:dword
					; CODE XREF: sub_10006F3F+81p
					; DATA XREF: sub_10006F3F+81r
; protected: __thiscall	std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??0?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10007422+3p
					; DATA XREF: sub_10007422+3r
; public: virtual __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::~basic_streambuf<wchar_t,	struct std::char_traits<wchar_t>>(void)
		extrn ??1?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_100074F3+11r
; public: unsigned short __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::sputc(wchar_t)
		extrn ?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z:dword
					; CODE XREF: sub_10006F3F+C3p
					; sub_10006F3F+124p ...
; public: __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::sputn(wchar_t const *, __int64)
		extrn ?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W_J@Z:dword
					; CODE XREF: sub_1000712E+BAp
					; sub_10007279+A2p
					; DATA XREF: ...
; protected: void __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::gbump(int)
		extrn ?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z:dword
					; CODE XREF: sub_10007CF3+34p
					; sub_10007D4C+BCp ...
; protected: void __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::pbump(int)
		extrn ?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z:dword
					; CODE XREF: sub_10007D4C+17Dp
					; sub_10007F0D+F6p
					; DATA XREF: ...
; protected: wchar_t * __thiscall std::basic_streambuf<wchar_t,	struct std::char_traits<wchar_t>>::_Pninc(void)
		extrn ?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WXZ:dword
					; CODE XREF: sub_10007B14+71p
					; sub_10007B14+1CBp
					; DATA XREF: ...
; public: void __thiscall std::basic_ios<wchar_t, struct std::char_traits<wchar_t>>::setstate(int, bool)
		extrn ?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z:dword
					; CODE XREF: sub_10006F3F+1C1p
					; sub_1000712E+11Dp ...
; public: void __thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::_Osfx(void)
		extrn ?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ:dword
					; CODE XREF: sub_10006F3F+1CDp
					; sub_1000712E+129p ...
; public: class	std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>> &	__thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::operator<<(class std::ios_base & (__cdecl *)(class std::ios_base &))
		extrn ??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAVios_base@1@AAV21@@Z@Z:dword
					; CODE XREF: sub_1000774A+BEp
					; sub_1000774A+C6p
					; DATA XREF: ...
; public: class	std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>> &	__thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::operator<<(unsigned long)
		extrn ??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z:dword
					; CODE XREF: sub_1000774A+E6p
					; sub_1000774A+F6p
					; DATA XREF: ...
; public: virtual __thiscall std::basic_iostream<wchar_t, struct std::char_traits<wchar_t>>::~basic_iostream<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??1?$basic_iostream@_WU?$char_traits@_W@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_1000750A+2Ar
; public: __thiscall std::basic_iostream<wchar_t, struct std::char_traits<wchar_t>>::basic_iostream<wchar_t, struct std::char_traits<wchar_t>>(class std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>> *)
		extrn ??0?$basic_iostream@_WU?$char_traits@_W@std@@@std@@QAE@PAV?$basic_streambuf@_WU?$char_traits@_W@std@@@1@@Z:dword
					; CODE XREF: sub_10007449+35p
					; DATA XREF: sub_10007449+35r

;
; Imports from MSVCR120.dll
;
; int __cdecl vscwprintf_p(const wchar_t *Format, va_list ArgList)
		extrn _vscwprintf_p:dword ; CODE XREF: sub_10004A15+34p
					; DATA XREF: sub_10004A15+34r ...
		extrn __imp__crt_debugger_hook:dword ; DATA XREF: _crt_debugger_hookr
		extrn __imp__initterm_e:dword ;	DATA XREF: _initterm_er
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _malloc_crt:dword	; CODE XREF: _pre_c_init+6p
					; DATA XREF: _pre_c_init+6r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp___CppXcptFilter:dword ; DATA XREF: __CppXcptFilterr
		extrn __imp__except_handler4_common:dword
					; DATA XREF: _except_handler4_commonr
; _onexit_t __cdecl onexit(_onexit_t)
		extrn _onexit:dword	; CODE XREF: sub_1001ABD6+29p
					; DATA XREF: sub_1001ABD6+29r
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___clean_type_info_names_internal:dword
					; DATA XREF: __clean_type_info_names_internalr
		extrn __imp___crtTerminateProcess:dword	; DATA XREF: __crtTerminateProcessr
		extrn __imp__purecall:dword ; DATA XREF: _purecallr
; __declspec(dllimport)	void * __cdecl operator	new(unsigned int)
		extrn __imp_??2@YAPAXI@Z:dword ; DATA XREF: operator new(uint)r
; __declspec(dllimport)	void __cdecl operator delete(void *)
		extrn __imp_??3@YAXPAX@Z:dword ; DATA XREF: operator delete(void *)r
; void *__cdecl	memmove(void *,	const void *, size_t)
		extrn memmove:dword	; CODE XREF: sub_10001959+5Dp
					; sub_10002104+17p ...
; void *__cdecl	memcpy(void *, const void *, size_t)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *, int, size_t)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int __cdecl memcmp(const void	*, const void *, size_t)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; int __cdecl strnicmp(const char *, const char	*, size_t)
		extrn _strnicmp:dword	; CODE XREF: sub_10005D35+3Ap
					; DATA XREF: sub_10005D35+3Ar
; int __cdecl vswprintf_p(wchar_t *DstBuf, size_t MaxCount, const wchar_t *Format, va_list ArgList)
		extrn _vswprintf_p:dword ; CODE	XREF: sub_10004A15+16p
					; DATA XREF: sub_10004A15+16r
		extrn _calloc_crt:dword	; CODE XREF: ___atonexitinit+11p
					; DATA XREF: ___atonexitinit+11r
; void __cdecl free(void *)
		extrn free:dword	; CODE XREF: sub_1000774A+1C2p
					; sub_10008262+73p ...
; void *__cdecl	malloc(size_t)
		extrn malloc:dword	; CODE XREF: sub_100082E5+1Dp
					; sub_1000835D+30p ...
; __declspec(dllimport)	void __cdecl operator delete[](void *)
		extrn __imp_??_V@YAXPAX@Z:dword	; DATA XREF: operator delete[](void *)r
; wchar_t *__cdecl wcsdup(const	wchar_t	*)
		extrn _wcsdup:dword	; CODE XREF: sub_1000774A+121p
					; sub_100132F9+3Dp ...
; void __cdecl __noreturn abort()
		extrn abort:dword	; CODE XREF: sub_100073A6+4Fp
					; DATA XREF: sub_100073A6+4Fr
; char *__cdecl	getenv(const char *)
		extrn getenv:dword	; CODE XREF: sub_100095AD+312p
					; DATA XREF: sub_100095AD+312r
; int __cdecl wcsnicmp(const wchar_t *,	const wchar_t *, size_t)
		extrn _wcsnicmp:dword	; CODE XREF: sub_1000BFCD+56p
					; sub_1001A3B3+1DDp
					; DATA XREF: ...
		extrn __imp_wmemcpy_s:dword ; DATA XREF: wmemcpy_sr
; errno_t __cdecl memcpy_s(void	*Dst, rsize_t DstSize, const void *Src,	rsize_t	MaxCount)
		extrn memcpy_s:dword	; CODE XREF: sub_1000F7B6+15p
					; DATA XREF: sub_1000F7B6+15r
		extrn rand_s:dword	; CODE XREF: sub_1000EE9A+53p
					; sub_10011D32+1Cp
					; DATA XREF: ...
; int __cdecl wcsicmp(const wchar_t *, const wchar_t *)
		extrn _wcsicmp:dword	; CODE XREF: sub_1001A3B3+F7p
					; sub_1001A3B3+211p
					; DATA XREF: ...
; int __cdecl vsnwprintf_s(wchar_t *DstBuf, size_t SizeInWords,	size_t MaxCount, const wchar_t *Format,	va_list	ArgList)
		extrn _vsnwprintf_s:dword ; CODE XREF: sub_1001A73C+13p
					; DATA XREF: sub_1001A73C+13r
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn __imp___crtUnhandledException:dword
					; DATA XREF: __crtUnhandledExceptionr

;
; Imports from USER32.dll
;
; BOOL __stdcall GetUserObjectInformationW(HANDLE hObj,	int nIndex, PVOID pvInfo, DWORD	nLength, LPDWORD lpnLengthNeeded)
		extrn GetUserObjectInformationW:dword ;	CODE XREF: sub_1001A9FC+23p
					; sub_1001A9FC+64p
					; DATA XREF: ...
; HWINSTA __stdcall GetProcessWindowStation()
		extrn GetProcessWindowStation:dword ; CODE XREF: sub_1001A759+96p
					; sub_1001A8A9+16p
					; DATA XREF: ...
; BOOL __stdcall SetProcessWindowStation(HWINSTA hWinSta)
		extrn SetProcessWindowStation:dword ; CODE XREF: sub_1001A759+A3p
					; sub_1001A759+117p
					; DATA XREF: ...
; HWINSTA __stdcall CreateWindowStationW(LPWSTR	lpwinsta, DWORD	dwReserved, ACCESS_MASK	dwDesiredAccess, LPSECURITY_ATTRIBUTES lpsa)
		extrn CreateWindowStationW:dword ; CODE	XREF: sub_1001A8A9+38p
					; DATA XREF: sub_1001A8A9+38r
; HDESK	__stdcall GetThreadDesktop(DWORD dwThreadId)
		extrn GetThreadDesktop:dword ; CODE XREF: sub_1001A759+84p
					; DATA XREF: sub_1001A759+84r
; HDESK	__stdcall CreateDesktopW(LPWSTR	lpszDesktop, LPWSTR lpszDevice,	LPDEVMODEW pDevmode, DWORD dwFlags, ACCESS_MASK	dwDesiredAccess, LPSECURITY_ATTRIBUTES lpsa)
		extrn CreateDesktopW:dword ; CODE XREF:	sub_1001A759+100p
					; DATA XREF: sub_1001A759+100r
; BOOL __stdcall CloseWindowStation(HWINSTA hWinSta)
		extrn CloseWindowStation:dword ; CODE XREF: sub_100168B2+21p
					; DATA XREF: sub_100168B2+21r
; BOOL __stdcall CloseDesktop(HDESK hDesktop)
		extrn CloseDesktop:dword ; CODE	XREF: sub_100168B2+Ap
					; DATA XREF: sub_100168B2+Ar

;
; Imports from WINMM.dll
;
; DWORD	__stdcall timeGetTime()
		extrn __imp_timeGetTime:dword ;	DATA XREF: timeGetTimer
					; .rdata:10030CBCo


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 1001C36Ch
dword_1001C36C	dd 0			; DATA XREF: sub_1001B02A+1A6o
		dd offset sub_1000103A
		dd offset sub_10001000
		dd offset sub_1000100C
		dd offset sub_10001018
		dd offset sub_10001024
dword_1001C384	dd 0			; DATA XREF: sub_1001B02A+1A1o
dword_1001C388	dd 0			; DATA XREF: sub_1001B02A+187o
		dd offset _pre_c_init
		dd offset ___atonexitinit
		dd offset sub_1001B4C2
dword_1001C398	dd 2 dup(0)		; DATA XREF: sub_1001B02A:loc_1001B1ACo
; Debug	Directory entries
		dd 0			; Characteristics
		dd 56F29A5Fh		; TimeDateStamp: Wed Mar 23 13:30:07 2016
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd 2			; Type:	IMAGE_DEBUG_TYPE_CODEVIEW
		dd 95h			; SizeOfData
		dd rva asc_1002FFC0	; AddressOfRawData
		dd 2EDC0h		; PointerToRawData
		dd 0			; Characteristics
		dd 56F29A5Fh		; TimeDateStamp: Wed Mar 23 13:30:07 2016
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd 0Ch			; Type
		dd 14h			; SizeOfData
		dd rva dword_10030058	; AddressOfRawData
		dd 2EE58h		; PointerToRawData
; Exported entry   5. ??_7SandboxBroker@mozilla@@6B@
		public ??_7SandboxBroker@mozilla@@6B@
; const	mozilla::SandboxBroker::`vftable'
??_7SandboxBroker@mozilla@@6B@ dd offset sub_10001145
					; DATA XREF: mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker const	&)+4o
					; mozilla::SandboxBroker::SandboxBroker(void)+3o ...
off_1001C3DC	dd offset unknown_libname_1 ; DATA XREF: unknown_libname_1+8o
					; sub_1001B8C6o ...
					; Microsoft VisualC 2-11/net runtime
		dd offset _purecall
		dd offset _purecall
		dd offset sub_100018E1
		dd offset sub_100018F1
		dd offset sub_1000190C
off_1001C3F4	dd offset unknown_libname_1 ; DATA XREF: .data:off_10033000o
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_10001A67
		dd offset sub_100019F3
		dd offset sub_100018E1
		dd offset sub_100018F1
		dd offset sub_1000190C
aGeneric	db 'generic',0          ; DATA XREF: sub_10001A67o
aUnknownError	db 'unknown error',0    ; DATA XREF: sub_100019F3+Fo
					; sub_10001A42+Fo
		align 4
off_1001C424	dd offset unknown_libname_1 ; DATA XREF: .data:off_10033004o
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_10001A6D
		dd offset sub_10001A18
		dd offset sub_100018E1
		dd offset sub_100018F1
		dd offset sub_1000190C
aIostream	db 'iostream',0         ; DATA XREF: sub_10001A6Do
		align 4
aIostreamStream	db 'iostream stream error',0 ; DATA XREF: sub_10001A18+Co
		align 10h
off_1001C460	dd offset unknown_libname_1 ; DATA XREF: .data:off_10033008o
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_10001A73
		dd offset sub_10001A42
		dd offset sub_100018B6
		dd offset sub_100018F1
		dd offset sub_1000190C
aSystem		db 'system',0           ; DATA XREF: sub_10001A73o
		align 10h
a??PipeJpi2_pid:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+9Co
		unicode	0, <\??\pipe\jpi2_pid*_pipe*>,0
		align 4
a??PipeChrome_:				; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+E5o
					; mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+105o
		unicode	0, <\??\pipe\chrome.*>,0
a??PipeGeckoCra:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+10Ao
		unicode	0, <\??\pipe\gecko-crash-server-pipe.*>,0
		align 10h
aHkey_current_u:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+131o
					; .rdata:1002FDB0o
		unicode	0, <HKEY_CURRENT_USER>,0
		align 8
aHkey_current_0:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+15Ao
		unicode	0, <HKEY_CURRENT_USER\Control Panel\Desktop>,0
aHkey_current_1:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+17Do
		unicode	0, <HKEY_CURRENT_USER\Control Panel\Desktop\LanguageConfigura>
		unicode	0, <tion>,0
		align 8
aHkey_local_mac:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1A0o
		unicode	0, <HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVers>
		unicode	0, <ion\SideBySide>,0
aHkey_local_m_0:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1C3o
		unicode	0, <HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MUI\Settin>
		unicode	0, <gs>,0
aHkey_current_2:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1E6o
		unicode	0, <HKEY_CURRENT_USER\Software\Policies\Microsoft\Control Pan>
		unicode	0, <el\Desktop>,0
aHkey_current_3:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+209o
		unicode	0, <HKEY_CURRENT_USER\Control Panel\Desktop\PreferredUILangua>
		unicode	0, <ges>,0
		align 8
aHkey_local_m_1:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+22Co
		unicode	0, <HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVers>
		unicode	0, <ion\SideBySide\PreferExternalManifest>,0
		align 4
aStringTooLong	db 'string too long',0  ; DATA XREF: sub_100016CF+Ao
					; sub_10002221+Do ...
aInvalidStringP	db 'invalid string position',0 ; DATA XREF: sub_100017AB+15o
					; sub_1000192D+9o ...
off_1001C910	dd offset sub_100020E2	; DATA XREF: sub_10001EBC+13o
					; sub_1000200A+3o
		dd offset ?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Lock(void)
		dd offset ?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Unlock(void)
		dd offset sub_10002507
		dd offset sub_1000269E
		dd offset ?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JXZ ; std::basic_streambuf<char,std::char_traits<char>>::showmanyc(void)
		dd offset sub_10002A8E
		dd offset ?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ ; std::basic_streambuf<char,std::char_traits<char>>::uflow(void)
		dd offset ?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPAD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::xsgetn(char *,__int64)
		dd offset ?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPBD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::xsputn(char const *,__int64)
		dd offset sub_100026EA
		dd offset sub_1000289D
		dd offset ?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEPAV12@PAD_J@Z ; std::basic_streambuf<char,std::char_traits<char>>::setbuf(char *,__int64)
		dd offset ?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ ;	std::basic_streambuf<char,std::char_traits<char>>::sync(void)
		dd offset ?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEXABVlocale@2@@Z ; std::basic_streambuf<char,std::char_traits<char>>::imbue(std::locale const	&)
off_1001C94C	dd offset sub_100020BB	; DATA XREF: sub_10001DE3+3Do
					; sub_10001FDA+Co
dword_1001C950	dd 0			; DATA XREF: sub_10001DE3+12o
		dd 50h
dword_1001C958	dd 29h			; DATA XREF: sub_100035CB+1Co
aVs_		db ' vs. ',0            ; DATA XREF: sub_100035CB+26o
		align 4
asc_1001C964	db ' (',0               ; DATA XREF: sub_100035CB+33o
		align 4
aDummy:					; DATA XREF: sub_10002B24+8o
		unicode	0, <dummy>,0
aHkey_current_4:			; DATA XREF: sub_10002B24+27o
		unicode	0, <HKEY_CURRENT_USER\dummy>,0
aBlocked	db 'BLOCKED',0          ; DATA XREF: sub_10002C76+17o
aBrokerAllowed	db 'Broker ALLOWED',0   ; DATA XREF: sub_10002B72+15o
		align 4
off_1001C9BC	dd offset sub_10002E5C	; DATA XREF: sub_10002E0F+Fo
					; sub_10002E5C+6o
aDequeTTooLong	db 'deque<T> too long',0 ; DATA XREF: sub_10002F2F:loc_1000305Co
		align 4
aDisableBreakpa	db 'disable-breakpad',0
		align 4
aEnableCrashRep	db 'enable-crash-reporter',0
		align 10h
aFullMemoryCras	db 'full-memory-crash-report',0
		align 4
aLowEndDeviceMo	db 'low-end-device-mode',0
aNoerrdialogs	db 'noerrdialogs',0
		align 10h
aProfilerTiming	db 'profiler-timing',0
a0		db '0',0
		align 4
aTestChildProce	db 'test-child-process',0
		align 4
aTraceToConsole	db 'trace-to-console',0
		align 4
aTraceToFile	db 'trace-to-file',0
		align 4
aTraceToFileNam	db 'trace-to-file-name',0
		align 10h
aV		db 'v',0
		align 4
aVmodule	db 'vmodule',0
aWaitForDebugge	db 'wait-for-debugger',0
		align 10h
aUnknown	db 'unknown',0          ; DATA XREF: sub_1000311A+6o
off_1001CAC8	dd offset unknown_libname_2 ; DATA XREF: unknown_libname_2+8o
					; sub_100033A2+1Bo ...
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_10005EE3
; char a_thunks[]
a_thunks	db '.thunks',0          ; DATA XREF: sub_100033A2+13o
; char a_syzygy[]
a_syzygy	db '.syzygy',0          ; DATA XREF: sub_100033A2+32o
aVectorTTooLong	db 'vector<T> too long',0 ; DATA XREF: sub_1000373B+1Co
					; sub_10003C85+2Do ...
		align 4
		dd offset dword_1001CB0C
		dd offset dword_1001CB10
		dd offset dword_1001CB14
		dd offset dword_1001CB18
		dd offset dword_1001CB1C
		dd offset dword_1001CB20
dword_1001CB0C	dd 4220h		; DATA XREF: .rdata:1001CAF4o
dword_1001CB10	dd 426B20h		; DATA XREF: .rdata:1001CAF8o
dword_1001CB14	dd 424D20h		; DATA XREF: .rdata:1001CAFCo
dword_1001CB18	dd 424720h		; DATA XREF: .rdata:1001CB00o
dword_1001CB1C	dd 425420h		; DATA XREF: .rdata:1001CB04o
dword_1001CB20	dd 425020h, 0A0009h, 0C000Bh, 20000Dh, 0A00085h, 20001680h
					; DATA XREF: .rdata:1001CB08o
		dd 20022001h, 20042003h, 20062005h, 20082007h, 200A2009h
		dd 20292028h, 205F202Fh, 3000h
asc_1001CB58:				; DATA XREF: sub_100040AC+1Eo
		dw 9, 0Ah, 0Bh
		dw 0Ch
		dw 0Dh
		unicode	0, < >
		dw 85h
aA		db '',0
		dd 20001680h, 20022001h, 20042003h, 20062005h, 20082007h
		dd 200A2009h, 20292028h, 205F202Fh, 3000h, 0C0B0A09h, 200Dh
		dd 0BFBBEFh, 0
		dd 3FF00000h, 0
		dd 40240000h, 0
		dd 40590000h, 0
		dd 408F4000h, 0
		dd 40C38800h, 0
		dd 40F86A00h, 0
aAd_a		db '.A',0
		align 4
		dd 416312D0h, 0
aDCa		db 'A',0
		align 4
aEA		db 'eA',0
		db 2 dup(0), 20h
		dd 4202A05Fh, 0E8000000h, 42374876h, 0A2000000h, 426D1A94h
		dd 0E5400000h, 42A2309Ch, 1E900000h, 42D6BCC4h,	26340000h
		dd 430C6BF5h, 37E08000h, 4341C379h, 85D8A000h, 43763457h
		dd 674EC800h, 43ABC16Dh, 60913D00h, 43E158E4h, 78B58C40h
		dd 4415AF1Dh, 0D6E2EF50h, 444B1AE4h, 64DD592h, 4480F0CFh
		dd 37E08000h, 4341C379h, 0B5056E17h, 4693B8B5h,	0E93FF9F5h
		dd 4D384F03h, 0F9301D32h, 5A827748h, 7F73BF3Ch,	75154FDDh
		dd 97D889BCh, 3C9CD2B2h, 0D5A8A733h, 3949F623h,	44F4A73Dh
		dd 32A50FFDh, 0CF8C979Dh, 255BBA08h, 64AC6F43h,	11680628h
		dd 30h dup(0)
		dd 8 dup(1010101h), 4 dup(2020202h), 2 dup(3030303h), 4040404h
		dd 505h, 0
		dd 80h,	800h, 10000h, 15h, 9Fh,	0FFFFh,	10FFFFh, 3FFFFFFh
		dd 7FFFFFFFh
aBrokerevent	db 'BrokerEvent',0      ; DATA XREF: sub_10004E1F+2Ao
					; StartAddress+23o
aCheckFailedFal	db 'Check failed: false. ',0 ; DATA XREF: sub_100061EE+31o
					; sub_100062C9+AAo ...
word_1001CDEA	dw 0			; DATA XREF: sub_10005405+5Bo
aMapSetTTooLong	db 'map/set<T> too long',0 ; DATA XREF: sub_10004FA8+1Ao
					; sub_1000886C+1Ao ...
		dd 48864000h, 295E96h
aAuthenticamd	db 'AuthenticAMD',0     ; DATA XREF: sub_10005AB2+5o
		align 4
aCBuildsMoz2_sl	db 'c:/builds/moz2_slave/tb-rel-c-esr38-w32_bld-0000000/build/mozilla'
					; DATA XREF: sub_100061EE+1Eo
					; sub_100062C9+97o ...
		db '/security/sandbox/chromium/base/win/scoped_handle.cc',0
		align 10h
aListTTooLong	db 'list<T> too long',0 ; DATA XREF: sub_100065CC+13o
					; sub_1000F7D9+13o ...
		align 4
flt_1001CEA4	dd 4.2949673e9		; DATA XREF: sub_100068FB+Er
					; sub_100068FB+24r
; const	WCHAR ModuleName
ModuleName:				; DATA XREF: sub_10006B5D+43o
					; sub_10006C8E+138o ...
		unicode	0, <kernel32.dll>,0
		align 4
; CHAR aInitializeproc[]
aInitializeproc	db 'InitializeProcThreadAttributeList',0 ; DATA XREF: sub_10006B5D+56o
		align 4
; CHAR aUpdateprocthre[]
aUpdateprocthre	db 'UpdateProcThreadAttribute',0 ; DATA XREF: sub_10006B5D+5Eo
		align 4
; CHAR aDeleteprocthre[]
aDeleteprocthre	db 'DeleteProcThreadAttributeList',0 ; DATA XREF: sub_10006B5D+6Bo
		align 4
; CHAR ProcName[]
ProcName	db 'GetProductInfo',0   ; DATA XREF: sub_10006C8E+133o
		align 4
; CHAR aIswow64process[]
aIswow64process	db 'IsWow64Process',0   ; DATA XREF: sub_10006EFE+4o
		align 4
asc_1001CF44	db '\',0                ; DATA XREF: sub_1000774A+4Co
					; sub_10013687+1Do
		align 4
off_1001CF48	dd offset sub_100075A0	; DATA XREF: sub_10007422+13o
					; sub_100074F3+3o
		dd offset ?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Lock(void)
		dd offset ?_Unlock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Unlock(void)
		dd offset sub_10007B14
		dd offset sub_10007CF3
		dd offset ?showmanyc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JXZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::showmanyc(void)
		dd offset sub_100080F8
		dd offset ?uflow@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEGXZ ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::uflow(void)
		dd offset ?xsgetn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPA_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsgetn(wchar_t *,__int64)
		dd offset ?xsputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPB_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsputn(wchar_t const *,__int64)
		dd offset sub_10007D4C
		dd offset sub_10007F0D
		dd offset ?setbuf@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEPAV12@PA_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::setbuf(wchar_t *,__int64)
		dd offset ?sync@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEHXZ	; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sync(void)
		dd offset ?imbue@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEXABVlocale@2@@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::imbue(std::locale const	&)
off_1001CF84	dd offset sub_10007598	; DATA XREF: sub_10007449+45o
					; sub_1000750A+Co
dword_1001CF88	dd 0			; DATA XREF: sub_10007449+12o
		dd 68h
dword_1001CF90	dd 0			; DATA XREF: sub_10007449+18o
		dd 58h
dword_1001CF98	dd 20h			; DATA XREF: sub_1000774A+9Bo
aWow_helper_exe:			; DATA XREF: sub_1000774A+A9o
		unicode	0, <wow_helper.exe" >,0
		align 10h
asc_1001CFC0:				; DATA XREF: sub_1000774A+AFo
		unicode	0, <">,0
; const	WCHAR aKernel32_dll_1
aKernel32_dll_1:			; DATA XREF: sub_100083DBo
		unicode	0, <kernel32.dll>,0
		align 10h
; const	WCHAR aKernelbase_dll
aKernelbase_dll:			; DATA XREF: sub_100083DB+1Ao
		unicode	0, <kernelbase.dll>,0
		align 10h
; CHAR aAppcontainerre[]
aAppcontainerre	db 'AppContainerRegisterSid',0 ; DATA XREF: sub_100084A7+2Fo
; CHAR aAppcontainerun[]
aAppcontainerun	db 'AppContainerUnregisterSid',0 ; DATA XREF: sub_10008522+2Fo
		align 4
; CHAR aAppcontainerlo[]
aAppcontainerlo	db 'AppContainerLookupMoniker',0 ; DATA XREF: sub_1000858C:loc_100085D6o
		align 10h
; CHAR aAppcontainerfr[]
aAppcontainerfr	db 'AppContainerFreeMemory',0 ; DATA XREF: sub_1000858C+59o
		align 4
off_1001D068	dd offset _purecall	; DATA XREF: unknown_libname_7+8o
					; sub_10019B9C+25o
		dd offset _purecall
		dd offset unknown_libname_7 ; Microsoft	VisualC	2-11/net runtime
off_1001D074	dd offset sub_10019BCA	; DATA XREF: sub_10008F65+Bo
					; sub_10019B9C+7o
		dd offset sub_10019C2F
		dd offset sub_1000919B
off_1001D080	dd offset sub_100093CC	; DATA XREF: sub_10008F00+Co
					; sub_10008FB1+Do
		dd offset sub_100092F9
		dd offset sub_100095AD
		dd offset sub_10009D31
		dd offset sub_100091B7
		dd offset sub_1000942D
		dd offset sub_10009C9F
; char aMoz_win_inheri[]
aMoz_win_inheri	db 'MOZ_WIN_INHERIT_STD_HANDLES_PRE_VISTA',0
					; DATA XREF: sub_100095AD:loc_100098BAo
		align 4
; const	WCHAR SubKey
SubKey		dw 0			; DATA XREF: sub_1000A469+29o
					; sub_10016AB5+54o ...
		align 4
aNtdll_dll:				; DATA XREF: sub_1000AC66+9Do
		unicode	0, <ntdll.dll>,0
off_1001D0DC	dd offset sub_1000A590	; DATA XREF: sub_10011F8B+6o
					; sub_1001627A+10Do
		dd offset _purecall
		dd offset sub_10011F8B
off_1001D0E8	dd offset sub_1000A590	; DATA XREF: sub_1000A75B+1Co
		dd offset sub_1000AC66
		dd offset sub_10011F8B
dword_1001D0F4	dd 3, 1, 6 dup(2), 2 dup(0) ; DATA XREF: sub_1000A75B+6o
		dd offset sub_1000A7BC
dword_1001D120	dd 4, 1, 4 dup(2), 4 dup(0) ; DATA XREF: sub_1000A75B+2Ao
		dd offset sub_1000A8A5
dword_1001D14C	dd 5, 1, 2, 6, 6 dup(0)	; DATA XREF: sub_1000A75B+36o
		dd offset sub_1000A988
dword_1001D178	dd 6, 1, 2, 6, 6 dup(0)	; DATA XREF: sub_1000A75B+42o
		dd offset sub_1000AA55
dword_1001D1A4	dd 7, 4, 2 dup(6), 2 dup(2), 4 dup(0) ;	DATA XREF: sub_1000A75B+4Eo
		dd offset sub_1000AB22
a_targetntcre_2	db '_TargetNtCreateFile@48',0 ; DATA XREF: sub_1000AC66+8Eo
		align 4
; CHAR aNtcreatefile[]
aNtcreatefile	db 'NtCreateFile',0     ; DATA XREF: sub_1000AC66+95o
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+5Eo ...
		align 4
a_targetntope_5	db '_TargetNtOpenFile@28',0 ; DATA XREF: sub_1000AC66+75o
		align 10h
aNtopenfile	db 'NtOpenFile',0       ; DATA XREF: sub_1000AC66+7Co
					; TargetNtOpenFile(x,x,x,x,x,x,x)+50o ...
		align 4
a_targetntque_2	db '_TargetNtQueryAttributesFile@12',0 ; DATA XREF: sub_1000AC66+5Co
; CHAR aNtqueryattribu[]
aNtqueryattribu	db 'NtQueryAttributesFile',0 ; DATA XREF: sub_1000AC66+63o
					; TargetNtQueryAttributesFile(x,x,x)+38o ...
		align 4
a_targetntque_1	db '_TargetNtQueryFullAttributesFile@12',0 ; DATA XREF: sub_1000AC66+43o
; CHAR aNtqueryfullatt[]
aNtqueryfullatt	db 'NtQueryFullAttributesFile',0 ; DATA XREF: sub_1000AC66+4Ao
					; TargetNtQueryFullAttributesFile(x,x,x)+38o ...
		align 4
a_targetntset_1	db '_TargetNtSetInformationFile@24',0 ; DATA XREF: sub_1000AC66+2Ao
		align 4
; CHAR aNtsetinformati[]
aNtsetinformati	db 'NtSetInformationFile',0 ; DATA XREF: sub_1000AC66+31o
					; TargetNtSetInformationFile(x,x,x,x,x,x)+42o ...
		align 4
a??_0:					; DATA XREF: sub_1000BF23+2Eo
		unicode	0, <\??\>,0
		align 4
; wchar_t aDevice
aDevice:				; DATA XREF: sub_1000BFCD+50o
		unicode	0, <\Device\>,0
		align 4
a??_1:					; DATA XREF: sub_1000C531+35o
		unicode	0, <\/?/?\*>,0
asc_1001D2FC:				; DATA XREF: sub_1000C531+5Eo
		unicode	0, <*~*>,0
a??:					; DATA XREF: sub_1000BF23+21o
		unicode	0, <\/?/?\>,0
		align 4
aKey:					; DATA XREF: sub_1000CE06+53o
					; .data:1003302Co
		unicode	0, <Key>,0
; CHAR aG_handles_to_0[]
aG_handles_to_0	db 'g_handles_to_close',0 ; DATA XREF: sub_1000D0F8+83o
		align 10h
; CHAR aNtqueryobject[]
aNtqueryobject	db 'NtQueryObject',0    ; DATA XREF: sub_1000D022+1Do
					; sub_1000E42B+1Bo ...
		align 10h
aCheckFailedG_h	db 'Check failed: g_handles_to_close != NULL. ',0
					; DATA XREF: sub_1000E258+43o
		align 10h
aCBuildsMoz2__3	db 'c:/builds/moz2_slave/tb-rel-c-esr38-w32_bld-0000000/build/mozilla'
					; DATA XREF: sub_1000E258+31o
					; sub_1000E258+110o
		db '/security/sandbox/chromium/sandbox/win/src/handle_closer_agent.cc'
		db 0
		align 4
aCheckFailedNam	db 'Check failed: name.second. ',0 ; DATA XREF: sub_1000E258+124o
off_1001D410	dd offset sub_1000A590	; DATA XREF: sub_1000E5E8+19o
		dd offset sub_1000E766
		dd offset sub_10011F8B
dword_1001D41C	dd 12h,	4, 3 dup(2), 5 dup(0) ;	DATA XREF: sub_1000E5E8+5o
		dd offset sub_1000E615
aDuplicatehandl	db 'DuplicateHandle',0  ; DATA XREF: sub_1000E8D1+7Co
					; sub_1000E8D1+92o
aProcess:				; DATA XREF: .data:1003301Co
		unicode	0, <Process>,0
aThread:				; DATA XREF: .data:10033020o
		unicode	0, <Thread>,0
		align 4
aFile:					; DATA XREF: .data:10033024o
		unicode	0, <File>,0
		align 4
aDirectory:				; DATA XREF: .data:10033028o
		unicode	0, <Directory>,0
aWindowstation:				; DATA XREF: .data:10033030o
		unicode	0, <WindowStation>,0
aDesktop:				; DATA XREF: .data:10033034o
		unicode	0, <Desktop>,0
aService:				; DATA XREF: .data:10033038o
		unicode	0, <Service>,0
aMutex:					; DATA XREF: .data:1003303Co
		unicode	0, <Mutex>,0
aSemaphore:				; DATA XREF: .data:10033040o
		unicode	0, <Semaphore>,0
aEvent:					; DATA XREF: .data:10033044o
		unicode	0, <Event>,0
aTimer:					; DATA XREF: .data:10033048o
		unicode	0, <Timer>,0
aNamedpipe:				; DATA XREF: .data:1003304Co
		unicode	0, <NamedPipe>,0
aJobobject:				; DATA XREF: .data:10033050o
		unicode	0, <JobObject>,0
aFilemap:				; DATA XREF: .data:10033054o
		unicode	0, <FileMap>,0
aAlpcPort:				; DATA XREF: .data:10033058o
		unicode	0, <ALPC Port>,0
dword_1001D558	dd 10000h		; DATA XREF: sub_1000EE9A+1Co
dword_1001D55C	dd 40h			; DATA XREF: sub_1000ED04+37o
					; sub_1000F691+17o
; const	WCHAR aNtdll_dll_0
aNtdll_dll_0:				; DATA XREF: sub_1000EFB8+28o
					; sub_1000F01E+2Co ...
		unicode	0, <ntdll.dll>,0
off_1001D574	dd offset unknown_libname_8 ; DATA XREF: unknown_libname_8+8o
					; Microsoft VisualC 2-11/net runtime
		dd offset _purecall
		dd offset sub_100143EE
		dd offset sub_1001447B
		dd offset _purecall
		dd offset sub_10014377
off_1001D58C	dd offset unknown_libname_8 ; DATA XREF: sub_1000F01E+171o
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_1001751B
		dd offset sub_10017082
		dd offset sub_10017087
		dd offset sub_10017128
		dd offset sub_10014377
		dd offset sub_1001706F
		dd offset sub_100170C0
		dd offset sub_10017131
		dd offset sub_100173B6
off_1001D5B4	dd offset unknown_libname_8 ; DATA XREF: sub_1000F01E+134o
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_1001751B
		dd offset sub_10017082
		dd offset sub_10017087
		dd offset sub_10017128
		dd offset sub_10014377
		dd offset sub_1001706F
		dd offset sub_100170C0
		dd offset sub_1001729F
		dd offset sub_100173B6
off_1001D5DC	dd offset unknown_libname_8 ; DATA XREF: sub_1000F01E+118o
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_1001751B
		dd offset sub_10017082
		dd offset sub_10017087
		dd offset sub_10017128
		dd offset sub_10014377
		dd offset sub_1001706F
		dd offset sub_100170C0
		dd offset sub_10017340
		dd offset sub_100173B6
off_1001D604	dd offset unknown_libname_8 ; DATA XREF: sub_1000F01E+155o
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_1001751B
		dd offset sub_10017082
		dd offset sub_10017087
		dd offset sub_10017128
		dd offset sub_10014377
		dd offset sub_1001706F
		dd offset sub_100170C0
		dd offset sub_10017216
		dd offset sub_100173B6
aSizeKallocgran	db 'size <= kAllocGranularity',0 ; DATA XREF: sub_1000EE9A+14o
		align 4
aCBuildsMoz2__0	db 'c:/builds/moz2_slave/tb-rel-c-esr38-w32_bld-0000000/build/mozilla'
					; DATA XREF: sub_1000EE9A+31o
					; sub_1000F322+CBo
		db '/security/sandbox/chromium/sandbox/win/src/interception.cc',0
; CHAR aG_intercepti_0[]
aG_intercepti_0	db 'g_interceptions',0  ; DATA XREF: sub_1000EF28+66o
a_targetntmap_0	db '_TargetNtMapViewOfSection@44',0 ; DATA XREF: sub_1000F322+3Ao
		align 4
aNtmapviewofsec	db 'NtMapViewOfSection',0 ; DATA XREF: sub_1000F322+40o
					; sub_100103AB+A4o
		align 4
a_targetntunm_0	db '_TargetNtUnmapViewOfSection@12',0 ; DATA XREF: sub_1000F322+51o
		align 4
aNtunmapviewofs	db 'NtUnmapViewOfSection',0 ; DATA XREF: sub_1000F322+57o
					; sub_100103AB+140o
		align 10h
aCheckFailedThu	db 'Check failed: thunk_base. ',0 ; DATA XREF: sub_1000F322+E4o
		align 4
; CHAR aG_originals_0[]
aG_originals_0	db 'g_originals',0      ; DATA XREF: sub_1000F322+182o
aLdrgetdllhandl	db 'LdrGetDllHandle',0  ; DATA XREF: sub_1000F01E:loc_1000F070o
					; sub_100103AB+11o
off_1001D778	dd offset unknown_libname_8 ; DATA XREF: sub_1000F949+1Bo
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_1000A64F
		dd offset sub_100143EE
		dd offset sub_1000A5EB
		dd offset sub_1000A5E6
		dd offset sub_10014377
off_1001D790	dd offset unknown_libname_8 ; DATA XREF: sub_1000F949+49o
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_1001855A
		dd offset sub_100143EE
		dd offset sub_1001447B
		dd offset sub_10018522
		dd offset sub_10014377
off_1001D7A8	dd offset unknown_libname_8 ; DATA XREF: sub_1000F949+75o
					; Microsoft VisualC 2-11/net runtime
		dd offset sub_10018622
		dd offset sub_100143EE
		dd offset sub_1001447B
		dd offset sub_1001852B
		dd offset sub_10014377
aKernel32_dll_0:			; DATA XREF: sub_1000FEA2+22o
		unicode	0, <kernel32.dll>,0
		align 4
off_1001D7DC	dd offset sub_1000A590	; DATA XREF: sub_1000FD0A+19o
		dd offset sub_1000FEA2
		dd offset sub_10011F8B
dword_1001D7E8	dd 8, 1, 6 dup(2), 2 dup(0) ; DATA XREF: sub_1000FD0A+5o
		dd offset sub_1000FD37
a_targetcreat_3	db '_TargetCreateNamedPipeW@36',0 ; DATA XREF: sub_1000FEA2+16o
		align 10h
aCreatenamedpip	db 'CreateNamedPipeW',0 ; DATA XREF: sub_1000FEA2+1Do
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+95o
		align 4
a__:					; DATA XREF: sub_1000FD37:loc_1000FDACo
		unicode	0, <..>,0
		align 4
a_:					; DATA XREF: sub_1000FD37+D6o
		unicode	0, <\\.\>,0
		align 4
a?:					; DATA XREF: sub_1000FD37+F5o
		unicode	0, <\\?\>,0
		align 4
; const	WCHAR aNtdll_dll_1
aNtdll_dll_1:				; DATA XREF: sub_1001026A+12o
					; sub_100103AB+6o
		unicode	0, <ntdll.dll>,0
aNtallocatevirt	db 'NtAllocateVirtualMemory',0 ; DATA XREF: sub_100103AB:loc_100103E7o
; CHAR aNtclose[]
aNtclose	db 'NtClose',0          ; DATA XREF: sub_100103AB+56o
					; sub_100142CB+33o ...
aNtduplicateobj	db 'NtDuplicateObject',0 ; DATA XREF: sub_100103AB+70o
		align 4
aNtfreevirtualm	db 'NtFreeVirtualMemory',0 ; DATA XREF: sub_100103AB+8Ao
aNtprotectvirtu	db 'NtProtectVirtualMemory',0 ; DATA XREF: sub_100103AB+BEo
		align 4
aNtqueryinforma	db 'NtQueryInformationProcess',0 ; DATA XREF: sub_100103AB+D8o
		align 4
aNtquerysection	db 'NtQuerySection',0   ; DATA XREF: sub_100103AB+10Co
		align 4
aNtqueryvirtual	db 'NtQueryVirtualMemory',0 ; DATA XREF: sub_100103AB+126o
		align 4
aRtlallocatehea	db 'RtlAllocateHeap',0  ; DATA XREF: sub_100103AB+15Ao
aRtlansistringt	db 'RtlAnsiStringToUnicodeString',0 ; DATA XREF: sub_100103AB+174o
		align 4
aRtlcompareunic	db 'RtlCompareUnicodeString',0 ; DATA XREF: sub_100103AB+18Eo
aRtlcreateheap	db 'RtlCreateHeap',0    ; DATA XREF: sub_100103AB+1A8o
		align 4
aRtlcreateusert	db 'RtlCreateUserThread',0 ; DATA XREF: sub_100103AB+1C2o
aRtldestroyheap	db 'RtlDestroyHeap',0   ; DATA XREF: sub_100103AB+1DCo
		align 4
aRtlfreeheap	db 'RtlFreeHeap',0      ; DATA XREF: sub_100103AB+1F6o
a_strnicmp	db '_strnicmp',0        ; DATA XREF: sub_100103AB+20Co
		align 10h
aStrlen		db 'strlen',0           ; DATA XREF: sub_100103AB+222o
		align 4
aWcslen		db 'wcslen',0           ; DATA XREF: sub_100103AB+238o
		align 10h
aMemcpy		db 'memcpy',0           ; DATA XREF: sub_100103AB+24Eo
		align 4
; CHAR aG_nt_0[]
aG_nt_0		db 'g_nt',0             ; DATA XREF: sub_100103AB+26Eo
		align 10h
a_targetntope_8	db '_TargetNtOpenThread@20',0 ; DATA XREF: sub_1001026A+1Do
		align 4
; CHAR aNtopenthread[]
aNtopenthread	db 'NtOpenThread',0     ; DATA XREF: sub_1001026A+23o
					; TargetNtOpenThread(x,x,x,x,x)+34o ...
		align 4
a_targetntope_9	db '_TargetNtOpenProcess@20',0 ; DATA XREF: sub_1001026A+47o
; CHAR aNtopenprocess[]
aNtopenprocess	db 'NtOpenProcess',0    ; DATA XREF: sub_1001026A+4Do
					; sub_10013415+11o
		align 10h
a_targetntop_10	db '_TargetNtOpenProcessToken@16',0 ; DATA XREF: sub_1001026A+71o
		align 10h
; CHAR aNtopenprocesst[]
aNtopenprocesst	db 'NtOpenProcessToken',0 ; DATA XREF: sub_1001026A+77o
					; TargetNtOpenProcessToken(x,x,x,x)+30o ...
		align 4
a_targetntset_2	db '_TargetNtSetInformationThread@20',0 ; DATA XREF: sub_1001026A+9Bo
		align 4
aNtsetinforma_0	db 'NtSetInformationThread',0 ; DATA XREF: sub_1001026A+A1o
		align 10h
a_targetntop_11	db '_TargetNtOpenThreadToken@20',0 ; DATA XREF: sub_1001026A+C5o
aNtopenthreadto	db 'NtOpenThreadToken',0 ; DATA XREF: sub_1001026A+CBo
		align 10h
a_targetntop_12	db '_TargetNtOpenProcessTokenEx@20',0 ; DATA XREF: sub_1001026A+F5o
		align 10h
; CHAR aNtopenproces_0[]
aNtopenproces_0	db 'NtOpenProcessTokenEx',0 ; DATA XREF: sub_1001026A+FCo
					; TargetNtOpenProcessTokenEx(x,x,x,x,x)+33o ...
		align 4
a_targetntop_13	db '_TargetNtOpenThreadTokenEx@24',0 ; DATA XREF: sub_1001026A+11Co
		align 4
aNtopenthread_0	db 'NtOpenThreadTokenEx',0 ; DATA XREF: sub_1001026A+123o
aCheckFailedIsv	db 'Check failed: IsValueInRangeForNumericType<Dst>(value). ',0
					; DATA XREF: sub_100107D8+36o
		align 4
aCBuildsMoz2__1	db 'c:\builds\moz2_slave\tb-rel-c-esr38-w32_bld-0000000\build\mozilla'
					; DATA XREF: sub_100107D8+22o
		db '\security\sandbox\chromium\base/numerics/safe_conversions.h',0
		align 4
; CHAR aKernel32_dll_3[]
aKernel32_dll_3	db 'kernel32.dll',0     ; DATA XREF: sub_10011B14+27o
		align 4
; CHAR aSetdefaultdlld[]
aSetdefaultdlld	db 'SetDefaultDllDirectories',0 ; DATA XREF: sub_10011B14+4Co
		align 4
; CHAR aSetprocessdepp[]
aSetprocessdepp	db 'SetProcessDEPPolicy',0 ; DATA XREF: sub_10011B14:loc_10011BD5o
; CHAR aNtsetinforma_1[]
aNtsetinforma_1	db 'NtSetInformationProcess',0 ; DATA XREF: sub_10011B14+F5o
; CHAR aSetprocessmiti[]
aSetprocessmiti	db 'SetProcessMitigationPolicy',0 ; DATA XREF: sub_10011B14+144o
		align 4
off_1001DC5C	dd offset sub_1000A590	; DATA XREF: sub_10011F6E+14o
		dd offset sub_10011FB0
		dd offset sub_10011F8B
a_targetgdidl_0	db '_TargetGdiDllInitialize@12',0 ; DATA XREF: sub_10011FB0+6Do
		align 4
aGdidllinitiali	db 'GdiDllInitialize',0 ; DATA XREF: sub_10011FB0+74o
		align 4
aGdi32_dll:				; DATA XREF: sub_10011FB0:loc_10012029o
		unicode	0, <gdi32.dll>,0
a_targetgetst_0	db '_TargetGetStockObject@8',0 ; DATA XREF: sub_10011FB0+54o
aGetstockobject	db 'GetStockObject',0   ; DATA XREF: sub_10011FB0+5Bo
		align 4
a_targetregis_0	db '_TargetRegisterClassW@8',0 ; DATA XREF: sub_10011FB0+36o
aRegisterclassw	db 'RegisterClassW',0   ; DATA XREF: sub_10011FB0+3Do
		align 4
aUser32_dll_0:				; DATA XREF: sub_10011FB0+42o
		unicode	0, <user32.dll>,0
		align 4
aKernel32_dll_2:			; DATA XREF: sub_10012515+36o
		unicode	0, <kernel32.dll>,0
		align 10h
off_1001DD30	dd offset sub_1000A590	; DATA XREF: sub_100120AE+1Co
		dd offset sub_10012515
		dd offset sub_10011F8B
asc_1001DD3C:				; DATA XREF: sub_10012412+1o
		unicode	0, <\\>,0
		align 4
asc_1001DD44:				; DATA XREF: sub_10012412+1Eo
		unicode	0, <:\>,0
		align 4
asc_1001DD4C:				; DATA XREF: sub_100120AE+6o
		dw 9, 0
		dd 2 dup(2), 7 dup(0)
		dd offset sub_100124E6
dword_1001DD78	dd 0Ah,	2 dup(2), 7 dup(0) ; DATA XREF:	sub_100120AE+2Ao
		dd offset sub_10012456
dword_1001DDA4	dd 0Bh,	4, 2, 7	dup(0)	; DATA XREF: sub_100120AE+36o
		dd offset sub_10012485
dword_1001DDD0	dd 0Ch,	4, 2 dup(2), 6 dup(0) ;	DATA XREF: sub_100120AE+42o
		dd offset sub_100124B4
dword_1001DDFC	dd 0Dh,	3 dup(1), 6, 5 dup(0) ;	DATA XREF: sub_100120AE+4Eo
		dd offset sub_100121D9
a_targetcreat_1	db '_TargetCreateProcessW@44',0 ; DATA XREF: sub_10012515+2Ao
		align 4
aCreateprocessw	db 'CreateProcessW',0   ; DATA XREF: sub_10012515+31o
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+98o ...
		align 4
a_targetcreat_2	db '_TargetCreateProcessA@44',0 ; DATA XREF: sub_10012515+56o
		align 10h
aCreateprocessa	db 'CreateProcessA',0   ; DATA XREF: sub_10012515+5Do
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+92o ...
		align 10h
aNtdll_dll_2:				; DATA XREF: sub_1001392C+27o
					; sub_1001392C+43o
		unicode	0, <ntdll.dll>,0
off_1001DE94	dd offset sub_1000A590	; DATA XREF: sub_1001364A+1Co
		dd offset sub_1001392C
		dd offset sub_10011F8B
dword_1001DEA0	dd 10h,	1, 2, 4, 3 dup(2), 3 dup(0) ; DATA XREF: sub_1001364A+6o
		dd offset sub_100136DB
dword_1001DECC	dd 11h,	1, 2, 4, 2, 5 dup(0) ; DATA XREF: sub_1001364A+2Ao
		dd offset sub_1001380F
a_targetntcre_3	db '_TargetNtCreateKey@32',0 ; DATA XREF: sub_1001392C+1Bo
		align 10h
; CHAR aNtcreatekey[]
aNtcreatekey	db 'NtCreateKey',0      ; DATA XREF: sub_1001392C+22o
					; TargetNtCreateKey(x,x,x,x,x,x,x,x)+55o ...
a_targetntope_6	db '_TargetNtOpenKey@16',0 ; DATA XREF: sub_1001392C+51o
; CHAR aNtopenkey[]
aNtopenkey	db 'NtOpenKey',0        ; DATA XREF: sub_1001392C+58o
					; TargetNtOpenKey(x,x,x,x)+2Ao	...
		align 4
a_targetntope_7	db '_TargetNtOpenKeyEx@20',0 ; DATA XREF: sub_1001392C+96o
		align 4
aNtopenkeyex	db 'NtOpenKeyEx',0      ; DATA XREF: sub_1001392C+9Do
					; TargetNtOpenKeyEx(x,x,x,x,x)+33o
aNtopenkeyEx	db 'NtOpenKey[Ex]',0    ; DATA XREF: sub_10013BAD+E7o
		align 10h
aSechangenotify:			; DATA XREF: sub_1001514D+14Bo
					; sub_1001514D+1EDo ...
		unicode	0, <SeChangeNotifyPrivilege>,0
aS:					; DATA XREF: sub_10015629+22o
		unicode	0, <S:(>,0
aMl:					; DATA XREF: sub_10015629+2Co
		unicode	0, <ML>,0
		align 10h
asc_1001DFB0:				; DATA XREF: sub_10015629+43o
		unicode	0, <;;>,0
		align 4
asc_1001DFB8:				; DATA XREF: sub_10015629+6Co
		unicode	0, <;;;>,0
asc_1001DFC0:				; DATA XREF: sub_10015629+95o
		unicode	0, <)>,0
aS11616384:				; DATA XREF: sub_100155B9:loc_100155D0o
		unicode	0, <S-1-16-16384>,0
		align 10h
aS11612288:				; DATA XREF: sub_100155B9:loc_100155D7o
		unicode	0, <S-1-16-12288>,0
		align 4
aS1168192:				; DATA XREF: sub_100155B9:loc_100155DEo
		unicode	0, <S-1-16-8192>,0
aS1166144:				; DATA XREF: sub_100155B9:loc_100155E5o
		unicode	0, <S-1-16-6144>,0
aS1164096:				; DATA XREF: sub_100155B9:loc_100155ECo
		unicode	0, <S-1-16-4096>,0
aS1162048:				; DATA XREF: sub_100155B9:loc_100155F3o
		unicode	0, <S-1-16-2048>,0
aS1160:					; DATA XREF: sub_100155B9:loc_100155FAo
		unicode	0, <S-1-16-0>,0
		align 10h
off_1001E070	dd offset _purecall	; DATA XREF: sub_10016099+17o
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
off_1001E0D8	dd offset sub_10016BEB	; DATA XREF: sub_10016099+1Eo
					; sub_1001627A+8o
		dd offset sub_10016F84
		dd offset sub_100163B5
off_1001E0E4	dd offset sub_10016429	; DATA XREF: sub_10016099+24o
					; sub_1001627A+11o
		dd offset sub_10016C87
		dd offset sub_10016E99
		dd offset sub_100169EE
		dd offset sub_100169F6
		dd offset sub_10016DE5
		dd offset sub_10016E08
		dd offset sub_10016CA0
		dd offset sub_10016955
		dd offset sub_10016761
		dd offset sub_100168B2
		dd offset sub_10016DD9
		dd offset sub_100169F2
		dd offset sub_10016DA0
		dd offset sub_10016CB4
		dd offset sub_10016D53
		dd offset sub_10016E23
		dd offset sub_100169FA
		dd offset sub_10016DAC
		dd offset sub_100169D0
		dd offset sub_10016E94
		dd offset sub_10016E72
		dd offset sub_10016E50
		dd offset sub_10016434
		dd offset sub_100163D1
		dd offset sub_1001641E
		align 10h
aCBuildsMoz2__2	db 'c:/builds/moz2_slave/tb-rel-c-esr38-w32_bld-0000000/build/mozilla'
					; DATA XREF: sub_10016434+40o
		db '/security/sandbox/chromium/sandbox/win/src/sandbox_policy_base.cc'
		db 0
		align 4
asc_1001E1D4	db 27h,0		; DATA XREF: sub_10016434+51o
		align 4
aPattern	db ', pattern = ',27h,0 ; DATA XREF: sub_10016434+5Co
		align 4
aSemantics	db ', semantics = ',0   ; DATA XREF: sub_10016434+64o
		align 4
aSubsystem	db ', subsystem = ',0   ; DATA XREF: sub_10016434+6Co
		align 4
aError		db ' error = ',0        ; DATA XREF: sub_10016434+72o
		align 4
aFailedToAddSan	db 'Failed to add sandbox rule.',0 ; DATA XREF: sub_10016434+77o
dword_1001E230	dd 1, 2, 8 dup(0)	; DATA XREF: sub_10016BEB+Fo
dword_1001E258	dd 2, 6, 8 dup(0)	; DATA XREF: sub_10016BEB+1Fo
; CHAR aG_shared_del_1[]
aG_shared_del_1	db 'g_shared_delayed_integrity_level',0 ; DATA XREF: sub_1001664B+7Bo
		align 4
; CHAR aG_shared_del_2[]
aG_shared_del_2	db 'g_shared_delayed_mitigations',0 ; DATA XREF: sub_1001664B+CDo
		align 4
; const	WCHAR aNtdll_dll_3
aNtdll_dll_3:				; DATA XREF: sub_1001700A+11o
		unicode	0, <ntdll.dll>,0
; CHAR aRtlinitunicode[]
aRtlinitunicode	db 'RtlInitUnicodeString',0 ; DATA XREF: sub_1001700A+1Co
		align 10h
; const	WCHAR aNtdll_dll_5
aNtdll_dll_5:				; DATA XREF: sub_1001706F+1o
		unicode	0, <ntdll.dll>,0
		align 8
dword_1001E308	dd 0Ch dup(0)		; DATA XREF: sub_10018063+3Ao
		dd 1, 2, 2 dup(0)
		dd 11h dup(1), 2, 1, 2,	1, 2, 1, 2, 1, 2, 1, 2,	1, 2, 1
		dd 2, 10h dup(0)
dword_1001E408	dd 8 dup(0)		; DATA XREF: sub_10018063+31o
		dd 100h, 0
		dd 1, 4, 4 dup(0)
		dd 8 dup(1), 101h, 8 dup(1), 4,	1, 4, 1, 4, 1, 4, 101h
		dd 4, 1, 4, 1, 4, 1, 4,	10h dup(0)
off_1001E508	dd offset dword_1001E5D0 ; DATA	XREF: sub_100180D2+41r
					; sub_10018353+11r
byte_1001E50C	db 0			; DATA XREF: sub_100180D2+Er
byte_1001E50D	db 0FFh			; DATA XREF: sub_100180D2+1Ar
					; sub_100180D2+CFr
byte_1001E50E	db 0			; DATA XREF: sub_100180D2+21r
byte_1001E50F	db 0FFh			; DATA XREF: sub_100180D2+2Er
		dd offset dword_100249D0
		dd 0FF00FF00h
		dd offset dword_1002C798
		dd 7000703h
		dd offset dword_1002CAB8
		dd 7000703h
		dd offset dword_1002CDD8
		dd 7000703h
		dd offset dword_1002D0F8
		dd 7000703h
		dd offset dword_1002D418
		dd 7000703h
		dd offset dword_1002D738
		dd 7000703h
		dd offset dword_1002DA58
		dd 7000703h
		dd offset dword_1002DD78
		dd 7000703h
		dd offset dword_1002E098
		dd 7000703h
		dd offset dword_1002E3B8
		dd 7000703h
		dd offset dword_1002E6D8
		dd 7000703h
		dd offset dword_1002E9F8
		dd 7000703h
		dd offset dword_1002ED18
		dd 1000703h
		dd offset dword_1002EDE0
		dd 7000703h
		dd offset dword_1002ADD0
		dd 7000703h
		dd offset dword_1002B0F0
		dd 7000703h
		dd offset dword_1002B410
		dd 7000703h
		dd offset dword_1002B730
		dd 7000703h
		dd offset dword_1002BA50
		dd 7000703h
		dd offset dword_1002BD70
		dd 7000703h
		dd offset dword_1002C090
		dd 7000703h
		dd offset dword_1002C3B0
		dd 7000703h
		dd offset dword_1002C6D0
		dd 1000703h
dword_1001E5D0	dd 0			; DATA XREF: .rdata:off_1001E508o
		dd 8, 2040000h,	2060000h, 0
		dd offset dword_1002F100
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset dword_1002F100
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset dword_1002F100
		align 80h
		dd 8, 0D060000h, 0D040000h, 0
		dd offset dword_1002F100
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset dword_1002F100
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset dword_1002F100
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 13h dup(0)
		dd 1, 2, 18h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aAnd		; "and"
		align 80h
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aDaa		; "daa"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aDas		; "das"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aAaa		; "aaa"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aAas		; "aas"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		align 80h
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPushad	; "pushad"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPopad	; "popad"
		dd 14h dup(0)
		dd 8, 0D060000h, 1090000h, 0
		dd offset aBound	; "bound"
		align 80h
		dd 8, 0E040000h, 0E060000h, 0
		dd offset aArpl		; "arpl"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 3, 18h dup(0)
		dd 5, 18h dup(0)
		dd 4, 18h dup(0)
		dd 8, 0D070000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0D070000h
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 2070000h
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2130000h,	2140000h, 0
		dd offset aInsb		; "insb"
		dd 14h dup(0)
		dd 8, 0D130000h, 0D140000h, 0
		dd offset aInsd		; "insd"
		dd 14h dup(0)
		dd 8, 2140000h,	2120000h, 0
		dd offset aOutsb	; "outsb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D120000h, 0
		dd offset aOutsb	; "outsb"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJo		; "jo"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJno		; "jno"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJc		; "jc"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJnc		; "jnc"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJz		; "jz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJnz		; "jnz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJbe		; "jbe"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJa		; "ja"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJs		; "js"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJns		; "jns"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJpe		; "jpe"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJpo		; "jpo"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJl		; "jl"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJge		; "jge"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJle		; "jle"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJg		; "jg"
		dd 13h dup(0)
		dd 2 dup(2), 2040000h, 2070000h, 15h dup(0)
		dd 3, 2, 0D040000h, 0D070000h, 15h dup(0)
		dd 4, 2, 0D040000h, 2070000h, 15h dup(0)
		dd 5, 2, 0D040000h, 2070000h, 16h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0E040000h, 0E0E0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D060000h, 80090000h, 0
		dd offset aLea		; "lea"
		dd 14h dup(0)
		dd 8, 0E0E0000h, 0E040000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aNop		; "nop"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCwde		; "cwde"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCdq		; "cdq"
		dd 14h dup(0)
		dd 6, 6010000h,	2 dup(0)
		dd offset aCallf	; "callf"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aWait		; "wait"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPushfd	; "pushfd"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPopfd	; "popfd"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSahf		; "sahf"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aLahf		; "lahf"
		dd 14h dup(0)
		dd 8, 2140000h,	20A0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D0A0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 20A0000h,	2140000h, 0
		dd offset aMov		; "mov"
		align 80h
		dd 8, 0D0A0000h, 0D140000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2120000h,	2130000h, 0
		dd offset aMovsb	; "movsb"
		dd 14h dup(0)
		dd 8, 0D120000h, 0D130000h, 0
		dd offset aMovsd	; "movsd"
		dd 14h dup(0)
		dd 8, 2120000h,	2130000h, 0
		dd offset aCmpsb	; "cmpsb"
		dd 14h dup(0)
		dd 8, 0D120000h, 0D130000h, 0
		dd offset aCmpsd	; "cmpsd"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2130000h,	2140000h, 0
		dd offset aStosb	; "stosb"
		dd 14h dup(0)
		dd 8, 0D130000h, 0D140000h, 0
		dd offset aStosd	; "stosd"
		dd 14h dup(0)
		dd 8, 2140000h,	2120000h, 0
		dd offset aLodsb	; "lodsb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D120000h, 0
		dd offset aLodsd	; "lodsd"
		dd 14h dup(0)
		dd 8, 2140000h,	2130000h, 0
		dd offset aScasb	; "scasb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D130000h, 0
		dd offset aScasd	; "scasd"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 13h dup(0)
		dd 6, 2, 2040000h, 2070000h, 15h dup(0)
		dd 7, 2, 0D040000h, 2070000h, 16h dup(0)
		dd 7, 0E070000h, 2 dup(0)
		dd offset aRet		; "ret"
		align 80h
		dd 7, 3	dup(0)
		dd offset aRet		; "ret"
		dd 14h dup(0)
		dd 8, 0D060000h, 6090000h, 0
		dd offset aLes		; "les"
		dd 14h dup(0)
		dd 8, 0D060000h, 6090000h, 0
		dd offset aLds		; "lds"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0E070000h, 2070000h, 0
		dd offset aEnter	; "enter"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aLeave	; "leave"
		dd 14h dup(0)
		dd 7, 0E070000h, 2 dup(0)
		dd offset aRetf		; "retf"
		dd 14h dup(0)
		dd 7, 3	dup(0)
		dd offset aRetf		; "retf"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aInt3		; "int3"
		dd 14h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aInt		; "int"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aInto		; "into"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aIret		; "iret"
		dd 13h dup(0)
		dd 8, 2, 2040000h, 16h dup(0)
		dd 9, 2, 0D040000h, 16h	dup(0)
		dd 0Ah,	2, 2040000h, 16h dup(0)
		dd 0Bh,	2, 0D040000h, 17h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aAam		; "aam"
		dd 14h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aAad		; "aad"
		dd 2Dh dup(0)
		dd 8, 3	dup(0)
		dd offset aXlat		; "xlat"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aLoopnz	; "loopnz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aLoopz	; "loopz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aLoop		; "loop"
		align 80h
		dd 6, 2080000h,	2 dup(0)
		dd offset aJcxz		; "jcxz"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 2070000h,	2140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 8, 2070000h,	2140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aCall		; "call"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 6, 6010000h,	2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 8, 2140000h,	0E140000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 0D140000h, 0E140000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 0E140000h, 2140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 8, 0E140000h, 0D140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 3, 3	dup(0)
		dd offset aLock		; "lock:"
		dd 2Dh dup(0)
		dd 3, 3	dup(0)
		dd offset aRepne	; "repne:"
		dd 14h dup(0)
		dd 3, 3	dup(0)
		dd offset aRep		; "rep:"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aHlt		; "hlt"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCmc		; "cmc"
		dd 13h dup(0)
		dd 0Ch,	2, 2040000h, 16h dup(0)
		dd 0Dh,	2, 0D040000h, 17h dup(0)
		dd 8, 3	dup(0)
		dd offset aClc		; "clc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aStc		; "stc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCli		; "cli"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSti		; "sti"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCld		; "cld"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aStd		; "std"
		dd 13h dup(0)
		dd 0Eh,	2, 17h dup(0)
		dd 0Fh,	2, 17h dup(0)
dword_100249D0	dd 10h,	2, 17h dup(0)	; DATA XREF: .rdata:1001E510o
		dd 11h,	2, 18h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aLar		; "lar"
		align 80h
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aLsl		; "lsl"
		dd 46h dup(0)
		dd 8, 3	dup(0)
		dd offset aClts		; "clts"
		dd 2Dh dup(0)
		dd 8, 3	dup(0)
		dd offset aInvd		; "invd"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aWbinvd	; "wbinvd"
		dd 31h dup(0)
		dd offset aUd2		; "ud2"
		dd 78h dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aMovups	; "movups"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMovsd	; "movsd"
		align 8
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMovss	; "movss"
		align 10h
		dd 8, 10100000h, 10110000h, 0
		dd offset aMovupd	; "movupd"
		align 8
		dd 8, 8110000h,	8100000h, 0
		dd offset aMovups	; "movups"
		dd 1, 0
		dd 8, 0F110000h, 0F100000h, 0
		dd offset aMovsd	; "movsd"
		dd 0
		dd 8, 0B110000h, 0B100000h, 0
		dd offset aMovss	; "movss"
		dd 0
		dd 8, 10110000h, 10100000h, 0
		dd offset aMovupd	; "movupd"
		dd 0
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovlps	; "movlps"
		dd 1, 0
		dd 8, 2	dup(9100000h), 0
		dd offset aMovhlps	; "movhlps"
		align 10h
		dd 8, 2	dup(9100000h), 0
		dd offset aMovhlps	; "movhlps"
		align 8
		dd 8, 9100000h,	0A110000h, 0
		dd offset aMovlpd	; "movlpd"
		align 10h
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovlps	; "movlps"
		dd 1, 0Dh dup(0)
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovlpd	; "movlpd"
		dd 0
		dd 8, 8100000h,	9110000h, 0
		dd offset aUnpcklps	; "unpcklps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 9110000h, 0
		dd offset aUnpcklpd	; "unpcklpd"
		align 8
		dd 8, 8100000h,	9110000h, 0
		dd offset aUnpckhps	; "unpckhps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 9110000h, 0
		dd offset aUnpckhpd	; "unpckhpd"
		dd 0
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovhps	; "movhps"
		dd 1, 0
		dd 8, 2	dup(9100000h), 0
		dd offset aMovlhps	; "movlhps"
		align 10h
		dd 8, 2	dup(9100000h), 0
		dd offset aMovlhps	; "movlhps"
		align 8
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovhpd	; "movhpd"
		align 10h
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovhps	; "movhps"
		dd 1, 0Dh dup(0)
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovhpd	; "movhpd"
		dd 12h,	2, 0C7h	dup(0)
		dd 8, 40D0000h,	4020000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 40D0000h,	4030000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 4020000h,	40D0000h, 0
		dd offset aMov		; "mov"
		align 80h
		dd 8, 4030000h,	40D0000h, 0
		dd offset aMov		; "mov"
		dd 78h dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aMovaps	; "movaps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aMovapd	; "movapd"
		align 8
		dd 8, 8110000h,	8100000h, 0
		dd offset aMovaps	; "movaps"
		dd 1, 0Dh dup(0)
		dd 8, 10110000h, 10100000h, 0
		dd offset aMovapd	; "movapd"
		dd 0
		dd 8, 8100000h,	90C0000h, 0
		dd offset aCvtpi2ps	; "cvtpi2ps"
		dd 1, 0
		dd 8, 0F100000h, 4040000h, 0
		dd offset aCvtsi2sd	; "cvtsi2sd"
		align 10h
		dd 8, 0B100000h, 4040000h, 0
		dd offset aCvtsi2ss	; "cvtsi2ss"
		align 8
		dd 8, 10100000h, 50C0000h, 0
		dd offset aCvtpi2pd	; "cvtpi2pd"
		align 10h
		dd 8, 8110000h,	8100000h, 0
		dd offset aMovntps	; "movntps"
		dd 1, 0Dh dup(0)
		dd 8, 10110000h, 10100000h, 0
		dd offset aMovntpd	; "movntpd"
		dd 0
		dd 8, 90C0000h,	8110000h, 0
		dd offset aCvttps2pi	; "cvttps2pi"
		dd 1, 0
		dd 8, 4060000h,	0F110000h, 0
		dd offset aCvttsd2si	; "cvttsd2si"
		align 8
		dd 8, 4060000h,	0B110000h, 0
		dd offset aCvttss2si	; "cvttss2si"
		align 10h
		dd 8, 50C0000h,	10110000h, 0
		dd offset aCvttpd2pi	; "cvttpd2pi"
		align 8
		dd 8, 90C0000h,	8110000h, 0
		dd offset aCvtps2pi	; "cvtps2pi"
		dd 1, 0
		dd 8, 4060000h,	0F110000h, 0
		dd offset aCvtsd2si	; "cvtsd2si"
		dd 0
		dd 8, 4060000h,	0B110000h, 0
		dd offset aCvtss2si	; "cvtss2si"
		dd 0
		dd 8, 50C0000h,	10110000h, 0
		dd offset aCvtpd2pi	; "cvtpd2pi"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aUcomiss	; "ucomiss"
		dd 1, 0Dh dup(0)
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aUcomisd	; "ucomisd"
		align 10h
		dd 8, 8100000h,	0B110000h, 0
		dd offset aComiss	; "comiss"
		dd 1, 0Dh dup(0)
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aComisd	; "comisd"
		dd 0
		dd 8, 3	dup(0)
		dd offset aWrmsr	; "wrmsr"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRdtsc	; "rdtsc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRdmsr	; "rdmsr"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRdpmc	; "rdpmc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSysenter	; "sysenter"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSysexit	; "sysexit"
		dd 0AAh	dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aMovnti	; "movnti"
		dd 5Fh dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovo	; "cmovo"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovno	; "cmovno"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovc	; "cmovc"
		align 80h
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovnc	; "cmovnc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovz	; "cmovz"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovnz	; "cmovnz"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovbe	; "cmovbe"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmova	; "cmova"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovs	; "cmovs"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovns	; "cmovns"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovpe	; "cmovpe"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovpo	; "cmovpo"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovl	; "cmovl"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovge	; "cmovge"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovle	; "cmovle"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovg	; "cmovg"
		dd 14h dup(0)
		dd 8, 4040000h,	8100000h, 0
		dd offset aMovmskps	; "movmskps"
		dd 1, 0Dh dup(0)
		dd 8, 4040000h,	10100000h, 0
		dd offset aMovmskpd	; "movmskpd"
		align 8
		dd 8, 8100000h,	8110000h, 0
		dd offset aSqrtps	; "sqrtps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aSqrtsd	; "sqrtsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aSqrtss	; "sqrtss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aSqrtpd	; "sqrtpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aRsqrtps	; "rsqrtps"
		dd 1, 7	dup(0)
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aRsqrtss	; "rsqrtss"
		align 20h
		dd 8, 8100000h,	8110000h, 0
		dd offset aRcpps	; "rcpps"
		dd 1, 7	dup(0)
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aRcpss	; "rcpss"
		dd 7 dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aAndps	; "andps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aAndpd	; "andpd"
		align 8
		dd 8, 8100000h,	8110000h, 0
		dd offset aAndnps	; "andnps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aAndnpd	; "andnpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aOrps		; "orps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aOrpd		; "orpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aXorps	; "xorps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aXorpd	; "xorpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aAddps	; "addps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aAddsd	; "addsd"
		align 8
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aAddss	; "addss"
		align 10h
		dd 8, 10100000h, 10110000h, 0
		dd offset aAddpd	; "addpd"
		align 8
		dd 8, 8100000h,	8110000h, 0
		dd offset aMulps	; "mulps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMulsd	; "mulsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMulss	; "mulss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aMulpd	; "mulpd"
		dd 0
		dd 8, 10100000h, 8110000h, 0
		dd offset aCvtps2pd	; "cvtps2pd"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aCvtsd2ss	; "cvtsd2ss"
		align 10h
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aCvtss2sd	; "cvtss2sd"
		align 8
		dd 8, 8100000h,	10110000h, 0
		dd offset aCvtpd2ps	; "cvtpd2ps"
		align 10h
		dd 8, 8100000h,	5110000h, 0
		dd offset aCvtdq2ps	; "cvtdq2ps"
		dd 1, 7	dup(0)
		dd 8, 5100000h,	8110000h, 0
		dd offset aCvttps2dq	; "cvttps2dq"
		dd 0
		dd 8, 5100000h,	8110000h, 0
		dd offset aCvtps2dq	; "cvtps2dq"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aSubps	; "subps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aSubsd	; "subsd"
		align 8
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aSubss	; "subss"
		align 10h
		dd 8, 10100000h, 10110000h, 0
		dd offset aSubpd	; "subpd"
		align 8
		dd 8, 8100000h,	8110000h, 0
		dd offset aMinps	; "minps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMinsd	; "minsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMinss	; "minss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aMinpd	; "minpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aDivps	; "divps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aDivsd	; "divsd"
		align 10h
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aDivss	; "divss"
		align 8
		dd 8, 10100000h, 10110000h, 0
		dd offset aDivpd	; "divpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aMaxps	; "maxps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMaxsd	; "maxsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMaxss	; "maxss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aMaxpd	; "maxpd"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpcklbw	; "punpcklbw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklbw	; "punpcklbw"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpcklwd	; "punpcklwd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklwd	; "punpcklwd"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckldq	; "punpckldq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpckldq	; "punpckldq"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPacksswb	; "packsswb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPacksswb	; "packsswb"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPcmpgtb	; "pcmpgtb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpgtb	; "pcmpgtb"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPcmpgtw	; "pcmpgtw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpgtw	; "pcmpgtw"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPcmpgtd	; "pcmpgtd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpgtd	; "pcmpgtd"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPackuswb	; "packuswb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPackuswb	; "packuswb"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckhbw	; "punpckhbw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPunpckhbw	; "punpckhbw"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckhwd	; "punpckhwd"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPunpckhwd	; "punpckhwd"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckhdq	; "punpckhdq"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPunpckhdq	; "punpckhdq"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPackssdw	; "packssdw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPackssdw	; "packssdw"
		dd 0
		dd 8, 3	dup(0)
		dd offset aNotUsedWithout ; "not used without prefix"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklqdq	; "punpcklqdq"
		align 8
		dd 8, 3	dup(0)
		dd offset aNotUsedWithout ; "not used without prefix"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklqdq	; "punpcklqdq"
		dd 0
		dd 8, 40B0000h,	4040000h, 0
		dd offset aMovd		; "movd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	4040000h, 0
		dd offset aMovd		; "movd"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aMovq		; "movq"
		dd 1, 7	dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aMovdqu	; "movdqu"
		dd 0
		dd 8, 5100000h,	5110000h, 0
		dd offset aMovdqa	; "movdqa"
		dd 0
		dd 8, 90B0000h,	90C0000h, 2070000h
		dd offset aPshuf	; "pshuf"
		dd 1, 0
		dd 8, 5100000h,	5110000h, 2070000h
		dd offset aPshuflw	; "pshuflw"
		align 8
		dd 8, 5100000h,	5110000h, 2070000h
		dd offset aPshufhw	; "pshufhw"
		align 10h
		dd 8, 5100000h,	5110000h, 2070000h
		dd offset aPshufd	; "pshufd"
		dd 13h,	2, 17h dup(0)
		dd 14h,	2, 17h dup(0)
		dd 15h,	2, 18h dup(0)
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPcmpeqb	; "pcmpeqb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpeqb	; "pcmpeqb"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPcmpeqw	; "pcmpeqw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpeqw	; "pcmpeqw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPcmpeqd	; "pcmpeqd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpeqd	; "pcmpeqd"
		align 10h
		dd 8, 3	dup(0)
		dd offset aEmms		; "emms"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 8, 4040000h,	40B0000h, 0
		dd offset aMovd		; "movd"
		dd 1, 7	dup(0)
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovq		; "movq"
		align 8
		dd 8, 4040000h,	5100000h, 0
		dd offset aMovd		; "movd"
		align 10h
		dd 8, 90C0000h,	90B0000h, 0
		dd offset aMovq		; "movq"
		dd 1, 7	dup(0)
		dd 8, 5110000h,	5100000h, 0
		dd offset aMovdqu	; "movdqu"
		dd 0
		dd 8, 5110000h,	5100000h, 0
		dd offset aMovdqa	; "movdqa"
		dd 0
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJo		; "jo"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJno		; "jno"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJc		; "jc"
		align 80h
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJnc		; "jnc"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJz		; "jz"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJnz		; "jnz"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJbe		; "jbe"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJa		; "ja"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJs		; "js"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJns		; "jns"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJpe		; "jpe"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJpo		; "jpo"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJl		; "jl"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJge		; "jge"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJle		; "jle"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJg		; "jg"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSeto		; "seto"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetno	; "setno"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetc		; "setc"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetnc	; "setnc"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetz		; "setz"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetnz	; "setnz"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetbe	; "setbe"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSeta		; "seta"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSets		; "sets"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetns	; "setns"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetpe	; "setpe"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetpo	; "setpo"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetl		; "setl"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetge	; "setge"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetle	; "setle"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetg		; "setg"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCpuid	; "cpuid"
		align 80h
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBt		; "bt"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2070000h
		dd offset aShld		; "shld"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2170000h
		dd offset aShld		; "shld"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRsm		; "rsm"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBts		; "bts"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2070000h
		dd offset aShrd		; "shrd"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2170000h
		dd offset aShrd		; "shrd"
		dd 13h dup(0)
		dd 16h,	2, 18h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aCmpxchg	; "cmpxchg"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aCmpxchg	; "cmpxchg"
		dd 14h dup(0)
		dd 8, 6090000h,	2 dup(0)
		dd offset aLss		; "lss"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBtr		; "btr"
		dd 14h dup(0)
		dd 8, 6090000h,	2 dup(0)
		dd offset aLfs		; "lfs"
		dd 14h dup(0)
		dd 8, 6090000h,	2 dup(0)
		dd offset aLgs		; "lgs"
		dd 14h dup(0)
		dd 8, 0D060000h, 2040000h, 0
		dd offset aMovzx	; "movzx"
		dd 14h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aMovzx	; "movzx"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 3	dup(0)
		dd offset aUd1		; "ud1"
		dd 13h dup(0)
		dd 17h,	2, 18h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBtc		; "btc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aBsf		; "bsf"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aBsr		; "bsr"
		dd 14h dup(0)
		dd 8, 0D060000h, 2040000h, 0
		dd offset aMovsx	; "movsx"
		dd 14h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aMovsx	; "movsx"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aXadd		; "xadd"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aXadd		; "xadd"
		dd 14h dup(0)
		dd 8, 8100000h,	8110000h, 2070000h
		dd offset aCmpps	; "cmpps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 2070000h
		dd offset aCmpsd	; "cmpsd"
		align 10h
		dd 8, 0B100000h, 0B110000h, 2070000h
		dd offset aCmpss	; "cmpss"
		align 8
		dd 8, 10100000h, 10110000h, 2070000h
		dd offset aCmppd	; "cmppd"
		align 10h
		dd 8, 4040000h,	4060000h, 0
		dd offset aMovnti	; "movnti"
		dd 14h dup(0)
		dd 8, 90B0000h,	4040000h, 2070000h
		dd offset aPinsrw	; "pinsrw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	4040000h, 2070000h
		dd offset aPinsrw	; "pinsrw"
		align 8
		dd 8, 4060000h,	90B0000h, 2070000h
		dd offset aPextrw	; "pextrw"
		dd 1, 0Dh dup(0)
		dd 8, 4060000h,	5100000h, 2070000h
		dd offset aPextrw	; "pextrw"
		dd 0
		dd 8, 8100000h,	8110000h, 2070000h
		dd offset aShufps	; "shufps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 2070000h
		dd offset aShufpd	; "shufpd"
		dd 18h,	2, 18h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 2Dh dup(0)
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrld	; "psrld"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrld	; "psrld"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddq	; "paddq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddq	; "paddq"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmullw	; "pmullw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmullw	; "pmullw"
		dd 0
		dd 8, 3	dup(0)
		dd offset aUnusedWithoutP ; "unused without prefix"
		dd 1, 0
		dd 8, 90B0000h,	9110000h, 0
		dd offset aMovdq2q	; "movdq2q"
		align 10h
		dd 8, 5100000h,	90C0000h, 0
		dd offset aMovq2dq	; "movq2dq"
		align 8
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovq		; "movq"
		align 10h
		dd 8, 4060000h,	90B0000h, 0
		dd offset aPmovmskb	; "pmovmskb"
		dd 1, 0Dh dup(0)
		dd 8, 4060000h,	5100000h, 0
		dd offset aPmovmskb	; "pmovmskb"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubusb	; "psubusb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubusb	; "psubusb"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubusw	; "psubusw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubusw	; "psubusw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPminub	; "pminub"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPminub	; "pminub"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPand		; "pand"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPand		; "pand"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddusb	; "paddusb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddusb	; "paddusb"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddusw	; "paddusw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddusw	; "paddusw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmaxub	; "pmaxub"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmaxub	; "pmaxub"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPandn	; "pandn"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPandn	; "pandn"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPavgb	; "pavgb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPavgb	; "pavgb"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsraw	; "psraw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrqw	; "psrqw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrad	; "psrad"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrad	; "psrad"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPavgw	; "pavgw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPavgw	; "pavgw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmulhuw	; "pmulhuw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmulhuw	; "pmulhuw"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmulhuw	; "pmulhuw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmulhw	; "pmulhw"
		dd 0
		dd 8, 3	dup(0)
		dd offset aNotUsedWithout ; "not used without prefix"
		dd 1, 0
		dd 8, 5100000h,	10110000h, 0
		dd offset aCvtpd2dq	; "cvtpd2dq"
		align 10h
		dd 8, 10100000h, 5110000h, 0
		dd offset aCvtdq2pd	; "cvtdq2pd"
		align 8
		dd 8, 5100000h,	10110000h, 0
		dd offset aCvttpd2dq	; "cvttpd2dq"
		align 10h
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovntq	; "movntq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	5100000h, 0
		dd offset aMovntdq	; "movntdq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubsb	; "psubsb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubsb	; "psubsb"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubsw	; "psubsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubsw	; "psubsw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPminsw	; "pminsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPminsw	; "pminsw"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPor		; "por"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPor		; "por"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddsb	; "paddsb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddsb	; "paddsb"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddsw	; "paddsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddsw	; "paddsw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmaxsw	; "pmaxsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmaxsw	; "pmaxsw"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPxor		; "pxor"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPxor		; "pxor"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsllw	; "psllw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsllw	; "psllw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPslld	; "pslld"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPslld	; "pslld"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsllq	; "psllq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsllq	; "psllq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmuludq	; "pmuludq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmuludq	; "pmuludq"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmaddwd	; "pmaddwd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmaddwd	; "pmaddwd"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsadbw	; "psadbw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsadbw	; "psadbw"
		align 10h
		dd 8, 70B0000h,	70C0000h, 0
		dd offset aMaskmovq	; "maskmovq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aMaskmovdqu	; "maskmovdqu"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubb	; "psubb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubb	; "psubb"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubw	; "psubw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubw	; "psubw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubd	; "psubd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubd	; "psubd"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubq	; "psubq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubq	; "psubq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddb	; "paddb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddb	; "paddb"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddw	; "paddw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddw	; "paddw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddd	; "paddd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddd	; "paddd"
		dd 19h dup(0)
dword_1002ADD0	dd 0			; DATA XREF: .rdata:1001E588o
		dd 8, 0E040000h, 2 dup(0)
		dd offset aSldt		; "sldt"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aStr		; "str"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aLldt		; "lldt"
		align 80h
		dd 8, 0E040000h, 2 dup(0)
		dd offset aLtr		; "ltr"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aVerr		; "verr"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aVerw		; "verw"
		dd 45h dup(0)
dword_1002B0F0	dd 0			; DATA XREF: .rdata:1001E590o
		dd 8, 0A090000h, 2 dup(0)
		dd offset aSgdt		; "sgdt"
		dd 14h dup(0)
		dd 8, 0A090000h, 2 dup(0)
		dd offset aSidt		; "sidt"
		dd 14h dup(0)
		dd 8, 0A090000h, 2 dup(0)
		dd offset aLgdt		; "lgdt"
		dd 14h dup(0)
		dd 8, 0A090000h, 2 dup(0)
		dd offset aLidt		; "lidt"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aSmsw		; "smsw"
		dd 2Dh dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aLmsw		; "lmsw"
		dd 14h dup(0)
		dd 8, 2090000h,	2 dup(0)
		dd offset aInvlpg	; "invlpg"
		dd 13h dup(0)
dword_1002B410	dd 0			; DATA XREF: .rdata:1001E598o
		dd 8, 80090000h, 2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 77h dup(0)
dword_1002B730	dd 33h dup(0)		; DATA XREF: .rdata:1001E5A0o
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	2070000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsraw	; "psraw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	2070000h, 0
		dd offset aPsraw	; "psraw"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsllw	; "psllw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	2070000h, 0
		dd offset aPsllw	; "psllw"
		dd 19h dup(0)
dword_1002BA50	dd 33h dup(0)		; DATA XREF: .rdata:1001E5A8o
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrld	; "psrld"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsrld	; "psrld"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrad	; "psrad"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsrad	; "psrad"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPslld	; "pslld"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPslld	; "pslld"
		dd 19h dup(0)
dword_1002BD70	dd 33h dup(0)		; DATA XREF: .rdata:1001E5B0o
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 4Ch dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsllq	; "psllq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsllq	; "psllq"
		align 10h
		dd 8, 5110000h,	2070000h, 0
		dd offset aPslldq	; "pslldq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPslldq	; "pslldq"
dword_1002C090	dd 0			; DATA XREF: .rdata:1001E5B8o
		dd 8, 3	dup(0)
		dd offset aFxsave	; "fxsave"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aFxrstor	; "fxrstor"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aLdmxcsr	; "ldmxcsr"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aStmxcsr	; "stmxcsr"
		dd 2Dh dup(0)
		dd 8, 3	dup(0)
		dd offset aLfence	; "lfence"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aMfence	; "mfence"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aClflushSfence ; "clflush/sfence"
		dd 13h dup(0)
dword_1002C3B0	dd 65h dup(0)		; DATA XREF: .rdata:1001E5C0o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBt		; "bt"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBts		; "bts"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBtr		; "btr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBtc		; "btc"
		dd 13h dup(0)
dword_1002C6D0	dd 1Ah dup(0)		; DATA XREF: .rdata:1001E5C8o
		dd 8, 9090000h,	2 dup(0)
		dd offset aCmpxch8b	; "cmpxch8b"
		dd 13h dup(0)
dword_1002C798	dd 0			; DATA XREF: .rdata:1001E518o
		dd 8, 2040000h,	2070000h, 0
		dd offset dword_1002F100
		align 80h
		dd 8, 2040000h,	2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
dword_1002CAB8	dd 0			; DATA XREF: .rdata:1001E520o
		dd 8, 0D040000h, 0D070000h, 0
		dd offset dword_1002F100
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
dword_1002CDD8	dd 0			; DATA XREF: .rdata:1001E528o
		dd 8, 0D040000h, 2070000h, 0
		dd offset dword_1002F100
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
dword_1002D0F8	dd 0			; DATA XREF: .rdata:1001E530o
		dd 8, 0D040000h, 2070000h, 0
		dd offset dword_1002F100
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
dword_1002D418	dd 0			; DATA XREF: .rdata:1001E538o
		dd 8, 2040000h,	2070000h, 0
		dd offset aRol		; "rol"
		align 80h
		dd 8, 2040000h,	2070000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_1002D738	dd 0			; DATA XREF: .rdata:1001E540o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_1002DA58	dd 0			; DATA XREF: .rdata:1001E548o
		dd 8, 2040000h,	150000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_1002DD78	dd 0			; DATA XREF: .rdata:1001E550o
		dd 8, 0D040000h, 150000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_1002E098	dd 0			; DATA XREF: .rdata:1001E558o
		dd 8, 2040000h,	2140000h, 0
		dd offset aRol		; "rol"
		align 80h
		dd 8, 2040000h,	2140000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_1002E3B8	dd 0			; DATA XREF: .rdata:1001E560o
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_1002E6D8	dd 0			; DATA XREF: .rdata:1001E568o
		dd 8, 2040000h,	2070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aNot		; "not"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aNeg		; "neg"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aMul		; "mul"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aDiv		; "div"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aIdiv		; "idiv"
		dd 13h dup(0)
dword_1002E9F8	dd 0			; DATA XREF: .rdata:1001E570o
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aNot		; "not"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aNeg		; "neg"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aMul		; "mul"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aDiv		; "div"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aIdiv		; "idiv"
		dd 13h dup(0)
dword_1002ED18	dd 0			; DATA XREF: .rdata:1001E578o
		dd 8, 2040000h,	2 dup(0)
		dd offset aInc		; "inc"
		align 80h
		dd 8, 2040000h,	2 dup(0)
		dd offset aDec		; "dec"
		dd 13h dup(0)
dword_1002EDE0	dd 0			; DATA XREF: .rdata:1001E580o
		dd 8, 0D040000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 6, 0D040000h, 2 dup(0)
		dd offset aCall		; "call"
		dd 14h dup(0)
		dd 6, 6040000h,	2 dup(0)
		dd offset aCall		; "call"
		dd 14h dup(0)
		dd 6, 0D040000h, 2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 6, 6040000h,	2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aPush		; "push"
		align 100h
dword_1002F100	dd 646461h		; DATA XREF: .rdata:1001E5E4o
					; .rdata:1001E648o ...
aPush		db 'push',0             ; DATA XREF: .rdata:1001E83Co
					; .rdata:1001EB5Co ...
		align 4
aPop		db 'pop',0              ; DATA XREF: .rdata:1001E8A0o
					; .rdata:1001EEE0o ...
aOr		db 'or',0               ; DATA XREF: .rdata:1001E904o
					; .rdata:1001E968o ...
		align 4
aAdc		db 'adc',0              ; DATA XREF: .rdata:1001EC24o
					; .rdata:1001EC88o ...
aSbb		db 'sbb',0              ; DATA XREF: .rdata:1001EF44o
					; .rdata:1001EFA8o ...
aAnd		db 'and',0              ; DATA XREF: .rdata:1001F264o
					; .rdata:1001F2C8o ...
aDaa		db 'daa',0              ; DATA XREF: .rdata:1001F520o
aSub		db 'sub',0              ; DATA XREF: .rdata:1001F584o
					; .rdata:1001F5E8o ...
aDas		db 'das',0              ; DATA XREF: .rdata:1001F840o
aXor		db 'xor',0              ; DATA XREF: .rdata:1001F8A4o
					; .rdata:1001F908o ...
aAaa		db 'aaa',0              ; DATA XREF: .rdata:1001FB60o
aCmp		db 'cmp',0              ; DATA XREF: .rdata:1001FBC4o
					; .rdata:1001FC28o ...
aAas		db 'aas',0              ; DATA XREF: .rdata:1001FE80o
aInc		db 'inc',0              ; DATA XREF: .rdata:1001FEE4o
					; .rdata:1001FF48o ...
aDec		db 'dec',0              ; DATA XREF: .rdata:10020204o
					; .rdata:10020268o ...
aPushad		db 'pushad',0           ; DATA XREF: .rdata:10020B64o
		align 4
aPopad		db 'popad',0            ; DATA XREF: .rdata:10020BC8o
		align 4
aBound		db 'bound',0            ; DATA XREF: .rdata:10020C2Co
		align 4
aArpl		db 'arpl',0             ; DATA XREF: .rdata:10020C90o
		align 4
aImul		db 'imul',0             ; DATA XREF: .rdata:10020EE8o
					; .rdata:10020FB0o ...
		align 4
aInsb		db 'insb',0             ; DATA XREF: .rdata:10021014o
		align 4
aInsd		db 'insd',0             ; DATA XREF: .rdata:10021078o
		align 4
aOutsb		db 'outsb',0            ; DATA XREF: .rdata:100210DCo
					; .rdata:10021140o
		align 4
aJo		db 'jo',0               ; DATA XREF: .rdata:100211A4o
					; .rdata:10027BE4o
		align 4
aJno		db 'jno',0              ; DATA XREF: .rdata:10021208o
					; .rdata:10027C48o
aJc		db 'jc',0               ; DATA XREF: .rdata:1002126Co
					; .rdata:10027CACo
		align 10h
aJnc		db 'jnc',0              ; DATA XREF: .rdata:100212D0o
					; .rdata:10027D10o
aJz		db 'jz',0               ; DATA XREF: .rdata:10021334o
					; .rdata:10027D74o
		align 4
aJnz		db 'jnz',0              ; DATA XREF: .rdata:10021398o
					; .rdata:10027DD8o
aJbe		db 'jbe',0              ; DATA XREF: .rdata:100213FCo
					; .rdata:10027E3Co
aJa		db 'ja',0               ; DATA XREF: .rdata:10021460o
					; .rdata:10027EA0o
		align 4
aJs		db 'js',0               ; DATA XREF: .rdata:100214C4o
					; .rdata:10027F04o
		align 4
aJns		db 'jns',0              ; DATA XREF: .rdata:10021528o
					; .rdata:10027F68o
aJpe		db 'jpe',0              ; DATA XREF: .rdata:1002158Co
					; .rdata:10027FCCo
aJpo		db 'jpo',0              ; DATA XREF: .rdata:100215F0o
					; .rdata:10028030o
aJl		db 'jl',0               ; DATA XREF: .rdata:10021654o
					; .rdata:10028094o
		align 4
aJge		db 'jge',0              ; DATA XREF: .rdata:100216B8o
					; .rdata:100280F8o
aJle		db 'jle',0              ; DATA XREF: .rdata:1002171Co
					; .rdata:1002815Co
aJg		db 'jg',0               ; DATA XREF: .rdata:10021780o
					; .rdata:100281C0o
		align 4
aTest		db 'test',0             ; DATA XREF: .rdata:10021974o
					; .rdata:100219D8o ...
		align 4
aXchg		db 'xchg',0             ; DATA XREF: .rdata:10021A3Co
					; .rdata:10021AA0o ...
		align 4
aMov		db 'mov',0              ; DATA XREF: .rdata:10021B04o
					; .rdata:10021B68o ...
aLea		db 'lea',0              ; DATA XREF: .rdata:10021CF8o
aNop		db 'nop',0              ; DATA XREF: .rdata:10021E24o
aCwde		db 'cwde',0             ; DATA XREF: .rdata:10022144o
		align 4
aCdq		db 'cdq',0              ; DATA XREF: .rdata:100221A8o
aCallf		db 'callf',0            ; DATA XREF: .rdata:1002220Co
		align 4
aWait		db 'wait',0             ; DATA XREF: .rdata:10022270o
		align 4
aPushfd		db 'pushfd',0           ; DATA XREF: .rdata:100222D4o
		align 4
aPopfd		db 'popfd',0            ; DATA XREF: .rdata:10022338o
		align 4
aSahf		db 'sahf',0             ; DATA XREF: .rdata:1002239Co
		align 4
aLahf		db 'lahf',0             ; DATA XREF: .rdata:10022400o
		align 4
aMovsb		db 'movsb',0            ; DATA XREF: .rdata:100225F4o
		align 4
aMovsd		db 'movsd',0            ; DATA XREF: .rdata:10022658o
					; .rdata:10025040o ...
		align 4
aCmpsb		db 'cmpsb',0            ; DATA XREF: .rdata:100226BCo
		align 4
aCmpsd		db 'cmpsd',0            ; DATA XREF: .rdata:10022720o
					; .rdata:100295C8o
		align 4
aStosb		db 'stosb',0            ; DATA XREF: .rdata:1002284Co
		align 4
aStosd		db 'stosd',0            ; DATA XREF: .rdata:100228B0o
		align 4
aLodsb		db 'lodsb',0            ; DATA XREF: .rdata:10022914o
		align 4
aLodsd		db 'lodsd',0            ; DATA XREF: .rdata:10022978o
		align 4
aScasb		db 'scasb',0            ; DATA XREF: .rdata:100229DCo
		align 4
aScasd		db 'scasd',0            ; DATA XREF: .rdata:10022A40o
		align 4
aRet		db 'ret',0              ; DATA XREF: .rdata:100231ACo
					; .rdata:10023210o
aLes		db 'les',0              ; DATA XREF: .rdata:10023274o
aLds		db 'lds',0              ; DATA XREF: .rdata:100232D8o
aEnter		db 'enter',0            ; DATA XREF: .rdata:10023404o
		align 10h
aLeave		db 'leave',0            ; DATA XREF: .rdata:10023468o
		align 4
aRetf		db 'retf',0             ; DATA XREF: .rdata:100234CCo
					; .rdata:10023530o
		align 10h
aInt3		db 'int3',0             ; DATA XREF: .rdata:10023594o
		align 4
aInt		db 'int',0              ; DATA XREF: .rdata:100235F8o
aInto		db 'into',0             ; DATA XREF: .rdata:1002365Co
		align 4
aIret		db 'iret',0             ; DATA XREF: .rdata:100236C0o
		align 4
aAam		db 'aam',0              ; DATA XREF: .rdata:100238B4o
aAad		db 'aad',0              ; DATA XREF: .rdata:10023918o
aXlat		db 'xlat',0             ; DATA XREF: .rdata:100239E0o
		align 4
aLoopnz		db 'loopnz',0           ; DATA XREF: .rdata:10023D64o
		align 4
aLoopz		db 'loopz',0            ; DATA XREF: .rdata:10023DC8o
		align 4
aLoop		db 'loop',0             ; DATA XREF: .rdata:10023E2Co
		align 4
aJcxz		db 'jcxz',0             ; DATA XREF: .rdata:10023E90o
		align 4
aIn		db 'in',0               ; DATA XREF: .rdata:10023EF4o
					; .rdata:10023F58o ...
		align 10h
aOut		db 'out',0              ; DATA XREF: .rdata:10023FBCo
					; .rdata:10024020o ...
aCall		db 'call',0             ; DATA XREF: .rdata:10024084o
					; .rdata:1002EEBCo ...
		align 4
aJmp		db 'jmp',0              ; DATA XREF: .rdata:100240E8o
					; .rdata:1002414Co ...
aLock		db 'lock:',0            ; DATA XREF: .rdata:100243A4o
		align 4
aRepne		db 'repne:',0           ; DATA XREF: .rdata:1002446Co
		align 10h
aRep		db 'rep:',0             ; DATA XREF: .rdata:100244D0o
		align 4
aHlt		db 'hlt',0              ; DATA XREF: .rdata:10024534o
aCmc		db 'cmc',0              ; DATA XREF: .rdata:10024598o
aClc		db 'clc',0              ; DATA XREF: .rdata:100246C4o
aStc		db 'stc',0              ; DATA XREF: .rdata:10024728o
aCli		db 'cli',0              ; DATA XREF: .rdata:1002478Co
aSti		db 'sti',0              ; DATA XREF: .rdata:100247F0o
aCld		db 'cld',0              ; DATA XREF: .rdata:10024854o
aStd		db 'std',0              ; DATA XREF: .rdata:100248B8o
aLar		db 'lar',0              ; DATA XREF: .rdata:10024AACo
aLsl		db 'lsl',0              ; DATA XREF: .rdata:10024B10o
aClts		db 'clts',0             ; DATA XREF: .rdata:10024C3Co
		align 4
aInvd		db 'invd',0             ; DATA XREF: .rdata:10024D04o
		align 10h
aWbinvd		db 'wbinvd',0           ; DATA XREF: .rdata:10024D68o
		align 4
aUd2		db 'ud2',0              ; DATA XREF: .rdata:10024E30o
aMovups		db 'movups',0           ; DATA XREF: .rdata:10025024o
					; .rdata:10025088o
		align 4
aMovss		db 'movss',0            ; DATA XREF: .rdata:10025058o
					; .rdata:100250BCo
		align 4
aMovupd		db 'movupd',0           ; DATA XREF: .rdata:10025070o
					; .rdata:100250D4o
		align 4
aMovlps		db 'movlps',0           ; DATA XREF: .rdata:100250ECo
					; .rdata:10025150o
		align 4
aMovhlps	db 'movhlps',0          ; DATA XREF: .rdata:10025108o
					; .rdata:10025120o
aMovlpd		db 'movlpd',0           ; DATA XREF: .rdata:10025138o
					; .rdata:1002519Co
		align 4
aUnpcklps	db 'unpcklps',0         ; DATA XREF: .rdata:100251B4o
		align 4
aUnpcklpd	db 'unpcklpd',0         ; DATA XREF: .rdata:10025200o
		align 4
aUnpckhps	db 'unpckhps',0         ; DATA XREF: .rdata:10025218o
		align 10h
aUnpckhpd	db 'unpckhpd',0         ; DATA XREF: .rdata:10025264o
		align 4
aMovhps		db 'movhps',0           ; DATA XREF: .rdata:1002527Co
					; .rdata:100252E0o
		align 4
aMovlhps	db 'movlhps',0          ; DATA XREF: .rdata:10025298o
					; .rdata:100252B0o
aMovhpd		db 'movhpd',0           ; DATA XREF: .rdata:100252C8o
					; .rdata:1002532Co
		align 4
aMovaps		db 'movaps',0           ; DATA XREF: .rdata:10025984o
					; .rdata:100259E8o
		align 4
aMovapd		db 'movapd',0           ; DATA XREF: .rdata:100259D0o
					; .rdata:10025A34o
		align 4
aCvtpi2ps	db 'cvtpi2ps',0         ; DATA XREF: .rdata:10025A4Co
		align 10h
aCvtsi2sd	db 'cvtsi2sd',0         ; DATA XREF: .rdata:10025A68o
		align 4
aCvtsi2ss	db 'cvtsi2ss',0         ; DATA XREF: .rdata:10025A80o
		align 4
aCvtpi2pd	db 'cvtpi2pd',0         ; DATA XREF: .rdata:10025A98o
		align 4
aMovntps	db 'movntps',0          ; DATA XREF: .rdata:10025AB0o
aMovntpd	db 'movntpd',0          ; DATA XREF: .rdata:10025AFCo
aCvttps2pi	db 'cvttps2pi',0        ; DATA XREF: .rdata:10025B14o
		align 10h
aCvttsd2si	db 'cvttsd2si',0        ; DATA XREF: .rdata:10025B30o
		align 4
aCvttss2si	db 'cvttss2si',0        ; DATA XREF: .rdata:10025B48o
		align 4
aCvttpd2pi	db 'cvttpd2pi',0        ; DATA XREF: .rdata:10025B60o
		align 4
aCvtps2pi	db 'cvtps2pi',0         ; DATA XREF: .rdata:10025B78o
		align 10h
aCvtsd2si	db 'cvtsd2si',0         ; DATA XREF: .rdata:10025B94o
		align 4
aCvtss2si	db 'cvtss2si',0         ; DATA XREF: .rdata:10025BACo
		align 4
aCvtpd2pi	db 'cvtpd2pi',0         ; DATA XREF: .rdata:10025BC4o
		align 4
aUcomiss	db 'ucomiss',0          ; DATA XREF: .rdata:10025BDCo
aUcomisd	db 'ucomisd',0          ; DATA XREF: .rdata:10025C28o
aComiss		db 'comiss',0           ; DATA XREF: .rdata:10025C40o
		align 4
aComisd		db 'comisd',0           ; DATA XREF: .rdata:10025C8Co
		align 4
aWrmsr		db 'wrmsr',0            ; DATA XREF: .rdata:10025CA4o
		align 4
aRdtsc		db 'rdtsc',0            ; DATA XREF: .rdata:10025D08o
		align 4
aRdmsr		db 'rdmsr',0            ; DATA XREF: .rdata:10025D6Co
		align 4
aRdpmc		db 'rdpmc',0            ; DATA XREF: .rdata:10025DD0o
		align 4
aSysenter	db 'sysenter',0         ; DATA XREF: .rdata:10025E34o
		align 10h
aSysexit	db 'sysexit',0          ; DATA XREF: .rdata:10025E98o
aMovnti		db 'movnti',0           ; DATA XREF: .rdata:10026154o
					; .rdata:10029610o
		align 10h
aCmovo		db 'cmovo',0            ; DATA XREF: .rdata:100262E4o
		align 4
aCmovno		db 'cmovno',0           ; DATA XREF: .rdata:10026348o
		align 10h
aCmovc		db 'cmovc',0            ; DATA XREF: .rdata:100263ACo
		align 4
aCmovnc		db 'cmovnc',0           ; DATA XREF: .rdata:10026410o
		align 10h
aCmovz		db 'cmovz',0            ; DATA XREF: .rdata:10026474o
		align 4
aCmovnz		db 'cmovnz',0           ; DATA XREF: .rdata:100264D8o
		align 10h
aCmovbe		db 'cmovbe',0           ; DATA XREF: .rdata:1002653Co
		align 4
aCmova		db 'cmova',0            ; DATA XREF: .rdata:100265A0o
		align 10h
aCmovs		db 'cmovs',0            ; DATA XREF: .rdata:10026604o
		align 4
aCmovns		db 'cmovns',0           ; DATA XREF: .rdata:10026668o
		align 10h
aCmovpe		db 'cmovpe',0           ; DATA XREF: .rdata:100266CCo
		align 4
aCmovpo		db 'cmovpo',0           ; DATA XREF: .rdata:10026730o
		align 10h
aCmovl		db 'cmovl',0            ; DATA XREF: .rdata:10026794o
		align 4
aCmovge		db 'cmovge',0           ; DATA XREF: .rdata:100267F8o
		align 10h
aCmovle		db 'cmovle',0           ; DATA XREF: .rdata:1002685Co
		align 4
aCmovg		db 'cmovg',0            ; DATA XREF: .rdata:100268C0o
		align 10h
aMovmskps	db 'movmskps',0         ; DATA XREF: .rdata:10026924o
		align 4
aMovmskpd	db 'movmskpd',0         ; DATA XREF: .rdata:10026970o
		align 4
aSqrtps		db 'sqrtps',0           ; DATA XREF: .rdata:10026988o
		align 10h
aSqrtsd		db 'sqrtsd',0           ; DATA XREF: .rdata:100269A4o
		align 4
aSqrtss		db 'sqrtss',0           ; DATA XREF: .rdata:100269BCo
		align 10h
aSqrtpd		db 'sqrtpd',0           ; DATA XREF: .rdata:100269D4o
		align 4
aRsqrtps	db 'rsqrtps',0          ; DATA XREF: .rdata:100269ECo
aRsqrtss	db 'rsqrtss',0          ; DATA XREF: .rdata:10026A20o
aRcpps		db 'rcpps',0            ; DATA XREF: .rdata:10026A50o
		align 10h
aRcpss		db 'rcpss',0            ; DATA XREF: .rdata:10026A84o
		align 4
aAndps		db 'andps',0            ; DATA XREF: .rdata:10026AB4o
		align 10h
aAndpd		db 'andpd',0            ; DATA XREF: .rdata:10026B00o
		align 4
aAndnps		db 'andnps',0           ; DATA XREF: .rdata:10026B18o
		align 10h
aAndnpd		db 'andnpd',0           ; DATA XREF: .rdata:10026B64o
		align 4
aOrps		db 'orps',0             ; DATA XREF: .rdata:10026B7Co
		align 10h
aOrpd		db 'orpd',0             ; DATA XREF: .rdata:10026BC8o
		align 4
aXorps		db 'xorps',0            ; DATA XREF: .rdata:10026BE0o
		align 10h
aXorpd		db 'xorpd',0            ; DATA XREF: .rdata:10026C2Co
		align 4
aAddps		db 'addps',0            ; DATA XREF: .rdata:10026C44o
		align 10h
aAddsd		db 'addsd',0            ; DATA XREF: .rdata:10026C60o
		align 4
aAddss		db 'addss',0            ; DATA XREF: .rdata:10026C78o
		align 10h
aAddpd		db 'addpd',0            ; DATA XREF: .rdata:10026C90o
		align 4
aMulps		db 'mulps',0            ; DATA XREF: .rdata:10026CA8o
		align 10h
aMulsd		db 'mulsd',0            ; DATA XREF: .rdata:10026CC4o
		align 4
aMulss		db 'mulss',0            ; DATA XREF: .rdata:10026CDCo
		align 10h
aMulpd		db 'mulpd',0            ; DATA XREF: .rdata:10026CF4o
		align 4
aCvtps2pd	db 'cvtps2pd',0         ; DATA XREF: .rdata:10026D0Co
		align 4
aCvtsd2ss	db 'cvtsd2ss',0         ; DATA XREF: .rdata:10026D28o
		align 10h
aCvtss2sd	db 'cvtss2sd',0         ; DATA XREF: .rdata:10026D40o
		align 4
aCvtpd2ps	db 'cvtpd2ps',0         ; DATA XREF: .rdata:10026D58o
		align 4
aCvtdq2ps	db 'cvtdq2ps',0         ; DATA XREF: .rdata:10026D70o
		align 4
aCvttps2dq	db 'cvttps2dq',0        ; DATA XREF: .rdata:10026DA4o
		align 10h
aCvtps2dq	db 'cvtps2dq',0         ; DATA XREF: .rdata:10026DBCo
		align 4
aSubps		db 'subps',0            ; DATA XREF: .rdata:10026DD4o
		align 4
aSubsd		db 'subsd',0            ; DATA XREF: .rdata:10026DF0o
		align 4
aSubss		db 'subss',0            ; DATA XREF: .rdata:10026E08o
		align 4
aSubpd		db 'subpd',0            ; DATA XREF: .rdata:10026E20o
		align 4
aMinps		db 'minps',0            ; DATA XREF: .rdata:10026E38o
		align 4
aMinsd		db 'minsd',0            ; DATA XREF: .rdata:10026E54o
		align 4
aMinss		db 'minss',0            ; DATA XREF: .rdata:10026E6Co
		align 4
aMinpd		db 'minpd',0            ; DATA XREF: .rdata:10026E84o
		align 4
aDivps		db 'divps',0            ; DATA XREF: .rdata:10026E9Co
		align 4
aDivsd		db 'divsd',0            ; DATA XREF: .rdata:10026EB8o
		align 4
aDivss		db 'divss',0            ; DATA XREF: .rdata:10026ED0o
		align 4
aDivpd		db 'divpd',0            ; DATA XREF: .rdata:10026EE8o
		align 4
aMaxps		db 'maxps',0            ; DATA XREF: .rdata:10026F00o
		align 4
aMaxsd		db 'maxsd',0            ; DATA XREF: .rdata:10026F1Co
		align 4
aMaxss		db 'maxss',0            ; DATA XREF: .rdata:10026F34o
		align 4
aMaxpd		db 'maxpd',0            ; DATA XREF: .rdata:10026F4Co
		align 4
aPunpcklbw	db 'punpcklbw',0        ; DATA XREF: .rdata:10026F64o
					; .rdata:10026FB0o
		align 4
aPunpcklwd	db 'punpcklwd',0        ; DATA XREF: .rdata:10026FC8o
					; .rdata:10027014o
		align 4
aPunpckldq	db 'punpckldq',0        ; DATA XREF: .rdata:1002702Co
					; .rdata:10027078o
		align 10h
aPacksswb	db 'packsswb',0         ; DATA XREF: .rdata:10027090o
					; .rdata:100270DCo
		align 4
aPcmpgtb	db 'pcmpgtb',0          ; DATA XREF: .rdata:100270F4o
					; .rdata:10027140o
aPcmpgtw	db 'pcmpgtw',0          ; DATA XREF: .rdata:10027158o
					; .rdata:100271A4o
aPcmpgtd	db 'pcmpgtd',0          ; DATA XREF: .rdata:100271BCo
					; .rdata:10027208o
aPackuswb	db 'packuswb',0         ; DATA XREF: .rdata:10027220o
					; .rdata:1002726Co
		align 10h
aPunpckhbw	db 'punpckhbw',0        ; DATA XREF: .rdata:10027284o
					; .rdata:100272D0o
		align 4
aPunpckhwd	db 'punpckhwd',0        ; DATA XREF: .rdata:100272E8o
					; .rdata:10027334o
		align 4
aPunpckhdq	db 'punpckhdq',0        ; DATA XREF: .rdata:1002734Co
					; .rdata:10027398o
		align 4
aPackssdw	db 'packssdw',0         ; DATA XREF: .rdata:100273B0o
					; .rdata:100273FCo
		align 10h
aNotUsedWithout	db 'not used without prefix',0 ; DATA XREF: .rdata:10027414o
					; .rdata:10027478o ...
aPunpcklqdq	db 'punpcklqdq',0       ; DATA XREF: .rdata:10027460o
					; .rdata:100274C4o
		align 4
aMovd		db 'movd',0             ; DATA XREF: .rdata:100274DCo
					; .rdata:10027528o ...
		align 4
aMovq		db 'movq',0             ; DATA XREF: .rdata:10027540o
					; .rdata:10027B50o ...
		align 4
aMovdqu		db 'movdqu',0           ; DATA XREF: .rdata:10027574o
					; .rdata:10027BB4o
		align 4
aMovdqa		db 'movdqa',0           ; DATA XREF: .rdata:1002758Co
					; .rdata:10027BCCo
		align 4
aPshuf		db 'pshuf',0            ; DATA XREF: .rdata:100275A4o
		align 4
aPshuflw	db 'pshuflw',0          ; DATA XREF: .rdata:100275C0o
aPshufhw	db 'pshufhw',0          ; DATA XREF: .rdata:100275D8o
aPshufd		db 'pshufd',0           ; DATA XREF: .rdata:100275F0o
		align 4
aPcmpeqb	db 'pcmpeqb',0          ; DATA XREF: .rdata:10027734o
					; .rdata:10027780o
aPcmpeqw	db 'pcmpeqw',0          ; DATA XREF: .rdata:10027798o
					; .rdata:100277E4o
aPcmpeqd	db 'pcmpeqd',0          ; DATA XREF: .rdata:100277FCo
					; .rdata:10027848o
aEmms		db 'emms',0             ; DATA XREF: .rdata:10027860o
		align 4
aSeto		db 'seto',0             ; DATA XREF: .rdata:10028224o
		align 4
aSetno		db 'setno',0            ; DATA XREF: .rdata:10028288o
		align 4
aSetc		db 'setc',0             ; DATA XREF: .rdata:100282ECo
		align 4
aSetnc		db 'setnc',0            ; DATA XREF: .rdata:10028350o
		align 4
aSetz		db 'setz',0             ; DATA XREF: .rdata:100283B4o
		align 4
aSetnz		db 'setnz',0            ; DATA XREF: .rdata:10028418o
		align 4
aSetbe		db 'setbe',0            ; DATA XREF: .rdata:1002847Co
		align 4
aSeta		db 'seta',0             ; DATA XREF: .rdata:100284E0o
		align 4
aSets		db 'sets',0             ; DATA XREF: .rdata:10028544o
		align 4
aSetns		db 'setns',0            ; DATA XREF: .rdata:100285A8o
		align 4
aSetpe		db 'setpe',0            ; DATA XREF: .rdata:1002860Co
		align 4
aSetpo		db 'setpo',0            ; DATA XREF: .rdata:10028670o
		align 4
aSetl		db 'setl',0             ; DATA XREF: .rdata:100286D4o
		align 4
aSetge		db 'setge',0            ; DATA XREF: .rdata:10028738o
		align 4
aSetle		db 'setle',0            ; DATA XREF: .rdata:1002879Co
		align 4
aSetg		db 'setg',0             ; DATA XREF: .rdata:10028800o
		align 4
aCpuid		db 'cpuid',0            ; DATA XREF: .rdata:1002892Co
		align 4
aBt		db 'bt',0               ; DATA XREF: .rdata:10028990o
					; .rdata:1002C554o
		align 10h
aShld		db 'shld',0             ; DATA XREF: .rdata:100289F4o
					; .rdata:10028A58o
		align 4
aRsm		db 'rsm',0              ; DATA XREF: .rdata:10028C4Co
aBts		db 'bts',0              ; DATA XREF: .rdata:10028CB0o
					; .rdata:1002C5B8o
aShrd		db 'shrd',0             ; DATA XREF: .rdata:10028D14o
					; .rdata:10028D78o
		align 4
aCmpxchg	db 'cmpxchg',0          ; DATA XREF: .rdata:10028EA4o
					; .rdata:10028F08o
aLss		db 'lss',0              ; DATA XREF: .rdata:10028F6Co
aBtr		db 'btr',0              ; DATA XREF: .rdata:10028FD0o
					; .rdata:1002C61Co
aLfs		db 'lfs',0              ; DATA XREF: .rdata:10029034o
aLgs		db 'lgs',0              ; DATA XREF: .rdata:10029098o
aMovzx		db 'movzx',0            ; DATA XREF: .rdata:100290FCo
					; .rdata:10029160o
		align 4
aUd1		db 'ud1',0              ; DATA XREF: .rdata:10029228o
aBtc		db 'btc',0              ; DATA XREF: .rdata:100292F0o
					; .rdata:1002C680o
aBsf		db 'bsf',0              ; DATA XREF: .rdata:10029354o
aBsr		db 'bsr',0              ; DATA XREF: .rdata:100293B8o
aMovsx		db 'movsx',0            ; DATA XREF: .rdata:1002941Co
					; .rdata:10029480o
		align 10h
aXadd		db 'xadd',0             ; DATA XREF: .rdata:100294E4o
					; .rdata:10029548o
		align 4
aCmpps		db 'cmpps',0            ; DATA XREF: .rdata:100295ACo
		align 10h
aCmpss		db 'cmpss',0            ; DATA XREF: .rdata:100295E0o
		align 4
aCmppd		db 'cmppd',0            ; DATA XREF: .rdata:100295F8o
		align 10h
aPinsrw		db 'pinsrw',0           ; DATA XREF: .rdata:10029674o
					; .rdata:100296C0o
		align 4
aPextrw		db 'pextrw',0           ; DATA XREF: .rdata:100296D8o
					; .rdata:10029724o
		align 10h
aShufps		db 'shufps',0           ; DATA XREF: .rdata:1002973Co
		align 4
aShufpd		db 'shufpd',0           ; DATA XREF: .rdata:10029788o
		align 10h
aBswap		db 'bswap',0            ; DATA XREF: .rdata:10029804o
					; .rdata:10029868o ...
		align 4
aPsrlw		db 'psrlw',0            ; DATA XREF: .rdata:10029B88o
					; .rdata:10029BD4o ...
		align 10h
aPsrld		db 'psrld',0            ; DATA XREF: .rdata:10029BECo
					; .rdata:10029C38o ...
		align 4
aPsrlq		db 'psrlq',0            ; DATA XREF: .rdata:10029C50o
					; .rdata:10029C9Co ...
		align 10h
aPaddq		db 'paddq',0            ; DATA XREF: .rdata:10029CB4o
					; .rdata:10029D00o
		align 4
aPmullw		db 'pmullw',0           ; DATA XREF: .rdata:10029D18o
					; .rdata:10029D64o
		align 10h
aUnusedWithoutP	db 'unused without prefix',0 ; DATA XREF: .rdata:10029D7Co
		align 4
aMovdq2q	db 'movdq2q',0          ; DATA XREF: .rdata:10029D98o
aMovq2dq	db 'movq2dq',0          ; DATA XREF: .rdata:10029DB0o
aPmovmskb	db 'pmovmskb',0         ; DATA XREF: .rdata:10029DE0o
					; .rdata:10029E2Co
		align 4
aPsubusb	db 'psubusb',0          ; DATA XREF: .rdata:10029E44o
					; .rdata:10029E90o
aPsubusw	db 'psubusw',0          ; DATA XREF: .rdata:10029EA8o
					; .rdata:10029EF4o
aPminub		db 'pminub',0           ; DATA XREF: .rdata:10029F0Co
					; .rdata:10029F58o
		align 4
aPand		db 'pand',0             ; DATA XREF: .rdata:10029F70o
					; .rdata:10029FBCo
		align 4
aPaddusb	db 'paddusb',0          ; DATA XREF: .rdata:10029FD4o
					; .rdata:1002A020o
aPaddusw	db 'paddusw',0          ; DATA XREF: .rdata:1002A038o
					; .rdata:1002A084o
aPmaxub		db 'pmaxub',0           ; DATA XREF: .rdata:1002A09Co
					; .rdata:1002A0E8o
		align 4
aPandn		db 'pandn',0            ; DATA XREF: .rdata:1002A100o
					; .rdata:1002A14Co
		align 4
aPavgb		db 'pavgb',0            ; DATA XREF: .rdata:1002A164o
					; .rdata:1002A1B0o
		align 4
aPsraw		db 'psraw',0            ; DATA XREF: .rdata:1002A1C8o
					; .rdata:1002B8D4o ...
		align 4
aPsrqw		db 'psrqw',0            ; DATA XREF: .rdata:1002A214o
		align 4
aPsrad		db 'psrad',0            ; DATA XREF: .rdata:1002A22Co
					; .rdata:1002A278o ...
		align 4
aPavgw		db 'pavgw',0            ; DATA XREF: .rdata:1002A290o
					; .rdata:1002A2DCo
		align 4
aPmulhuw	db 'pmulhuw',0          ; DATA XREF: .rdata:1002A2F4o
					; .rdata:1002A340o ...
aPmulhw		db 'pmulhw',0           ; DATA XREF: .rdata:1002A3A4o
		align 4
aCvtpd2dq	db 'cvtpd2dq',0         ; DATA XREF: .rdata:1002A3D8o
		align 4
aCvtdq2pd	db 'cvtdq2pd',0         ; DATA XREF: .rdata:1002A3F0o
		align 4
aCvttpd2dq	db 'cvttpd2dq',0        ; DATA XREF: .rdata:1002A408o
		align 10h
aMovntq		db 'movntq',0           ; DATA XREF: .rdata:1002A420o
		align 4
aMovntdq	db 'movntdq',0          ; DATA XREF: .rdata:1002A46Co
aPsubsb		db 'psubsb',0           ; DATA XREF: .rdata:1002A484o
					; .rdata:1002A4D0o
		align 4
aPsubsw		db 'psubsw',0           ; DATA XREF: .rdata:1002A4E8o
					; .rdata:1002A534o
		align 10h
aPminsw		db 'pminsw',0           ; DATA XREF: .rdata:1002A54Co
					; .rdata:1002A598o
		align 4
aPor		db 'por',0              ; DATA XREF: .rdata:1002A5B0o
					; .rdata:1002A5FCo
aPaddsb		db 'paddsb',0           ; DATA XREF: .rdata:1002A614o
					; .rdata:1002A660o
		align 4
aPaddsw		db 'paddsw',0           ; DATA XREF: .rdata:1002A678o
					; .rdata:1002A6C4o
		align 4
aPmaxsw		db 'pmaxsw',0           ; DATA XREF: .rdata:1002A6DCo
					; .rdata:1002A728o
		align 4
aPxor		db 'pxor',0             ; DATA XREF: .rdata:1002A740o
					; .rdata:1002A78Co
		align 4
aPsllw		db 'psllw',0            ; DATA XREF: .rdata:1002A808o
					; .rdata:1002A854o ...
		align 4
aPslld		db 'pslld',0            ; DATA XREF: .rdata:1002A86Co
					; .rdata:1002A8B8o ...
		align 4
aPsllq		db 'psllq',0            ; DATA XREF: .rdata:1002A8D0o
					; .rdata:1002A91Co ...
		align 4
aPmuludq	db 'pmuludq',0          ; DATA XREF: .rdata:1002A934o
					; .rdata:1002A980o
aPmaddwd	db 'pmaddwd',0          ; DATA XREF: .rdata:1002A998o
					; .rdata:1002A9E4o
aPsadbw		db 'psadbw',0           ; DATA XREF: .rdata:1002A9FCo
					; .rdata:1002AA48o
		align 4
aMaskmovq	db 'maskmovq',0         ; DATA XREF: .rdata:1002AA60o
		align 4
aMaskmovdqu	db 'maskmovdqu',0       ; DATA XREF: .rdata:1002AAACo
		align 4
aPsubb		db 'psubb',0            ; DATA XREF: .rdata:1002AAC4o
					; .rdata:1002AB10o
		align 4
aPsubw		db 'psubw',0            ; DATA XREF: .rdata:1002AB28o
					; .rdata:1002AB74o
		align 4
aPsubd		db 'psubd',0            ; DATA XREF: .rdata:1002AB8Co
					; .rdata:1002ABD8o
		align 4
aPsubq		db 'psubq',0            ; DATA XREF: .rdata:1002ABF0o
					; .rdata:1002AC3Co
		align 4
aPaddb		db 'paddb',0            ; DATA XREF: .rdata:1002AC54o
					; .rdata:1002ACA0o
		align 4
aPaddw		db 'paddw',0            ; DATA XREF: .rdata:1002ACB8o
					; .rdata:1002AD04o
		align 4
aPaddd		db 'paddd',0            ; DATA XREF: .rdata:1002AD1Co
					; .rdata:1002AD68o
		align 4
aSldt		db 'sldt',0             ; DATA XREF: .rdata:1002ADE4o
		align 4
aStr		db 'str',0              ; DATA XREF: .rdata:1002AE48o
aLldt		db 'lldt',0             ; DATA XREF: .rdata:1002AEACo
		align 10h
aLtr		db 'ltr',0              ; DATA XREF: .rdata:1002AF10o
aVerr		db 'verr',0             ; DATA XREF: .rdata:1002AF74o
		align 4
aVerw		db 'verw',0             ; DATA XREF: .rdata:1002AFD8o
		align 4
aSgdt		db 'sgdt',0             ; DATA XREF: .rdata:1002B104o
		align 4
aSidt		db 'sidt',0             ; DATA XREF: .rdata:1002B168o
		align 4
aLgdt		db 'lgdt',0             ; DATA XREF: .rdata:1002B1CCo
		align 4
aLidt		db 'lidt',0             ; DATA XREF: .rdata:1002B230o
		align 4
aSmsw		db 'smsw',0             ; DATA XREF: .rdata:1002B294o
		align 4
aLmsw		db 'lmsw',0             ; DATA XREF: .rdata:1002B35Co
		align 4
aInvlpg		db 'invlpg',0           ; DATA XREF: .rdata:1002B3C0o
		align 4
aPrefetch	db 'prefetch',0         ; DATA XREF: .rdata:1002B424o
					; .rdata:1002B488o ...
		align 4
aPslldq		db 'pslldq',0           ; DATA XREF: .rdata:1002C040o
					; .rdata:1002C08Co
		align 10h
aFxsave		db 'fxsave',0           ; DATA XREF: .rdata:1002C0A4o
		align 4
aFxrstor	db 'fxrstor',0          ; DATA XREF: .rdata:1002C108o
aLdmxcsr	db 'ldmxcsr',0          ; DATA XREF: .rdata:1002C16Co
aStmxcsr	db 'stmxcsr',0          ; DATA XREF: .rdata:1002C1D0o
aLfence		db 'lfence',0           ; DATA XREF: .rdata:1002C298o
		align 4
aMfence		db 'mfence',0           ; DATA XREF: .rdata:1002C2FCo
		align 10h
aClflushSfence	db 'clflush/sfence',0   ; DATA XREF: .rdata:1002C360o
		align 10h
aCmpxch8b	db 'cmpxch8b',0         ; DATA XREF: .rdata:1002C748o
		align 4
aRol		db 'rol',0              ; DATA XREF: .rdata:1002D42Co
					; .rdata:1002D74Co ...
aRor		db 'ror',0              ; DATA XREF: .rdata:1002D490o
					; .rdata:1002D7B0o ...
aRcl		db 'rcl',0              ; DATA XREF: .rdata:1002D4F4o
					; .rdata:1002D814o ...
aRcr		db 'rcr',0              ; DATA XREF: .rdata:1002D558o
					; .rdata:1002D878o ...
aShl		db 'shl',0              ; DATA XREF: .rdata:1002D5BCo
					; .rdata:1002D8DCo ...
aShr		db 'shr',0              ; DATA XREF: .rdata:1002D620o
					; .rdata:1002D940o ...
aSal		db 'sal',0              ; DATA XREF: .rdata:1002D684o
					; .rdata:1002D9A4o ...
aSar		db 'sar',0              ; DATA XREF: .rdata:1002D6E8o
					; .rdata:1002DA08o ...
aNot		db 'not',0              ; DATA XREF: .rdata:1002E7B4o
					; .rdata:1002EAD4o
aNeg		db 'neg',0              ; DATA XREF: .rdata:1002E818o
					; .rdata:1002EB38o
aMul		db 'mul',0              ; DATA XREF: .rdata:1002E87Co
					; .rdata:1002EB9Co
aDiv		db 'div',0              ; DATA XREF: .rdata:1002E944o
					; .rdata:1002EC64o
aIdiv		db 'idiv',0             ; DATA XREF: .rdata:1002E9A8o
					; .rdata:1002ECC8o
		align 4
aNtdll_dll_6:				; DATA XREF: sub_1001886E+22o
					; sub_1001886E+57o
		unicode	0, <ntdll.dll>,0
off_1002FBF8	dd offset sub_1000A590	; DATA XREF: sub_10018723+1Co
		dd offset sub_1001886E
		dd offset sub_10011F8B
dword_1002FC04	dd 0Eh,	1, 2 dup(2), 6 dup(0) ;	DATA XREF: sub_10018723+6o
		dd offset sub_10018760
dword_1002FC30	dd 0Fh,	1, 2, 7	dup(0)	; DATA XREF: sub_10018723+2Ao
		dd offset sub_100187DE
a_targetntcre_4	db '_TargetNtCreateEvent@24',0 ; DATA XREF: sub_1001886E+16o
; CHAR aNtcreateevent[]
aNtcreateevent	db 'NtCreateEvent',0    ; DATA XREF: sub_1001886E+1Do
					; TargetNtCreateEvent(x,x,x,x,x,x)+13Eo ...
		align 4
a_targetntop_14	db '_TargetNtOpenEvent@16',0 ; DATA XREF: sub_1001886E+4Co
		align 4
; CHAR aNtopenevent[]
aNtopenevent	db 'NtOpenEvent',0      ; DATA XREF: sub_1001886E+52o
					; TargetNtOpenEvent(x,x,x,x)+45o ...
aNtcreatevent	db 'NtCreatEvent',0     ; DATA XREF: TargetNtCreateEvent(x,x,x,x,x,x)+4Bo
		align 4
; wchar_t aD
aD:					; DATA XREF: sub_10018F87+7Bo
		unicode	0, <%d>,0
		align 10h
; CHAR aNtopendirector[]
aNtopendirector	db 'NtOpenDirectoryObject',0 ; DATA XREF: sub_10018F87+34o
					; sub_1001913E+11o
		align 4
; CHAR aNtquerysymboli[]
aNtquerysymboli	db 'NtQuerySymbolicLinkObject',0 ; DATA XREF: sub_1001913E+25o
		align 4
; CHAR aNtopensymbolic[]
aNtopensymbolic	db 'NtOpenSymbolicLinkObject',0 ; DATA XREF: sub_1001913E+36o
		align 10h
aSessionsBnolin:			; DATA XREF: sub_10018F87+5Do
		unicode	0, <\Sessions\BNOLINKS>,0
		align 4
; CHAR aG_shared_sec_0[]
aG_shared_sec_0	db 'g_shared_section',0 ; DATA XREF: sub_10019774+9Fo
		align 4
; CHAR aG_shared_ipc_0[]
aG_shared_ipc_0	db 'g_shared_IPC_size',0 ; DATA XREF: sub_10019774+CCo
		align 10h
; CHAR aG_shared_pol_0[]
aG_shared_pol_0	db 'g_shared_policy_size',0 ; DATA XREF: sub_10019774+F1o
		align 4
off_1002FD78	dd offset sub_10019A90	; DATA XREF: sub_10015880+41F0o
		dd offset sub_10019AA7
		dd offset sub_10019A8C
		dd offset sub_100199DD
; const	WCHAR aNtdll_dll_4
aNtdll_dll_4:				; DATA XREF: sub_1001A242+Fo
		unicode	0, <ntdll.dll>,0
a??_2:					; DATA XREF: sub_10019D54+30o
					; sub_10019D54+23Ao ...
		unicode	0, <\??\>,0
		align 4
off_1002FDA8	dd offset aHkey_classes_r ; DATA XREF: sub_1001A2A8:loc_1001A2C2r
					; sub_1001A2A8+88r
					; "HKEY_CLASSES_ROOT"
; HKEY hKey
hKey		dd 80000000h		; DATA XREF: sub_1001A2A8+5Br
		dd offset aHkey_current_u ; "HKEY_CURRENT_USER"
		dd 80000001h
		dd offset aHkey_local_m_2 ; "HKEY_LOCAL_MACHINE"
		dd 80000002h
		dd offset aHkey_users	; "HKEY_USERS"
		dd 80000003h
		dd offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		dd 80000004h
		dd offset aHkey_perform_0 ; "HKEY_PERFORMANCE_TEXT"
		dd 80000050h
		dd offset aHkey_perform_1 ; "HKEY_PERFORMANCE_NLSTEXT"
		dd 80000060h
		dd offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		dd 80000005h
		dd offset aHkey_dyn_data ; "HKEY_DYN_DATA"
		dd 80000006h
aHkey_classes_r:			; DATA XREF: .rdata:off_1002FDA8o
		unicode	0, <HKEY_CLASSES_ROOT>,0
aHkey_local_m_2:			; DATA XREF: .rdata:1002FDB8o
		unicode	0, <HKEY_LOCAL_MACHINE>,0
		align 4
aHkey_users:				; DATA XREF: .rdata:1002FDC0o
		unicode	0, <HKEY_USERS>,0
		align 4
aHkey_performan:			; DATA XREF: .rdata:1002FDC8o
		unicode	0, <HKEY_PERFORMANCE_DATA>,0
aHkey_perform_0:			; DATA XREF: .rdata:1002FDD0o
		unicode	0, <HKEY_PERFORMANCE_TEXT>,0
aHkey_perform_1:			; DATA XREF: .rdata:1002FDD8o
		unicode	0, <HKEY_PERFORMANCE_NLSTEXT>,0
		align 10h
aHkey_current_c:			; DATA XREF: .rdata:1002FDE0o
		unicode	0, <HKEY_CURRENT_CONFIG>,0
aHkey_dyn_data:				; DATA XREF: .rdata:1002FDE8o
		unicode	0, <HKEY_DYN_DATA>,0
aPipe:					; DATA XREF: sub_1001A089:loc_1001A0C0o
		unicode	0, <pipe\>,0
aSbox_alternate:			; DATA XREF: sub_1001A759+29o
		unicode	0, <sbox_alternate_desktop_>,0
; wchar_t Format
Format:					; DATA XREF: sub_1001A759+3Ao
		unicode	0, <0x%X>,0
		align 4
dword_1002FF6C	dd 0			; DATA XREF: ___DllMainCRTStartup:loc_1001B282r
					; ___DllMainCRTStartup+A8r ...
off_1002FF70	dd offset dword_10033E20 ; DATA	XREF: ___report_gsfailure+EDo
		dd offset dword_10033E70
__load_config_used dd 48h		; Size
		dd 0			; Time stamp
		dw 2 dup(0)		; Version: 0.0
		dd 0			; GlobalFlagsClear
		dd 0			; GlobalFlagsSet
		dd 0			; CriticalSectionDefaultTimeout
		dd 0			; DeCommitFreeBlockThreshold
		dd 0			; DeCommitTotalFreeThreshold
		dd 0			; LockPrefixTable
		dd 0			; MaximumAllocationSize
		dd 0			; VirtualMemoryThreshold
		dd 0			; ProcessAffinityMask
		dd 0			; ProcessHeapFlags
		dw 0			; CSDVersion
		dw 0			; Reserved1
		dd 0			; EditList
		dd offset ___security_cookie ; SecurityCookie
		dd offset ___safe_se_handler_table ; SEHandlerTable
		dd 1			; SEHandlerCount
; Debug	information (IMAGE_DEBUG_TYPE_CODEVIEW)
asc_1002FFC0	db 'RSDS'               ; DATA XREF: .rdata:1001C3B4o
					; CV signature
		dd 0E1E28396h		; Data1	; GUID
		dw 0B764h		; Data2
		dw 448Ch		; Data3
		db 0BFh, 0B5h, 8Ch, 74h, 0BAh, 44h, 28h, 0DBh; Data4
		dd 1			; Age
		db 'c:\builds\moz2_slave\tb-rel-c-esr38-w32_bld-0000000\build\objdir-' ; PdbFileName
		db 'tb\security\sandbox\win\src\sandboxbroker\sandboxbroker.pdb',0
		align 4
; Debug	information (type 12)
dword_10030058	dd 0			; DATA XREF: .rdata:1001C3D0o
		dd 2 dup(7Bh), 3 dup(0)
___safe_se_handler_table dd rva	__except_handler4 ; DATA XREF: .rdata:1002FFB8o
		align 8
dword_10030078	dd 2 dup(0)		; DATA XREF: sub_1001B84F+2o
					; sub_1001B84F+7o
dword_10030080	dd 2 dup(0)		; DATA XREF: sub_1001B86F+2o
					; sub_1001B86F+7o
stru_10030088	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10004EA1+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10004EA1
		dd 0FFFFFFC8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10004EDC	; ScopeRecord.FilterFunc
		dd offset loc_10004EE0	; ScopeRecord.HandlerFunc
		align 8
stru_100300A8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000A247+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000A247
		dd 0FFFFFFB8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000A376	; ScopeRecord.FilterFunc
		dd offset loc_1000A37A	; ScopeRecord.HandlerFunc
		align 8
stru_100300C8	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+5o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B4E4
		dd 0FFFFFF50h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B6EC	; ScopeRecord.FilterFunc
		dd offset loc_1000B6F0	; ScopeRecord.HandlerFunc
		align 8
stru_100300E8	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+5o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B71A
		dd 0FFFFFF50h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B903	; ScopeRecord.FilterFunc
		dd offset loc_1000B907	; ScopeRecord.HandlerFunc
		align 8
stru_10030108	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+5o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000BC65
		dd 0FFFFFF40h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000BE68	; ScopeRecord.FilterFunc
		dd offset loc_1000BE6C	; ScopeRecord.HandlerFunc
		align 8
stru_10030128	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B23B+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B23B
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B2D3	; ScopeRecord.FilterFunc
		dd offset loc_1000B2D7	; ScopeRecord.HandlerFunc
		align 8
stru_10030148	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B44B+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B44B
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B473	; ScopeRecord.FilterFunc
		dd offset loc_1000B477	; ScopeRecord.HandlerFunc
		align 8
stru_10030168	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B4A1+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B4A1
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B4CC	; ScopeRecord.FilterFunc
		dd offset loc_1000B4D0	; ScopeRecord.HandlerFunc
		align 8
stru_10030188	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B39B+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B39B
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B433	; ScopeRecord.FilterFunc
		dd offset loc_1000B437	; ScopeRecord.HandlerFunc
		align 8
stru_100301A8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B2EB+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B2EB
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B383	; ScopeRecord.FilterFunc
		dd offset loc_1000B387	; ScopeRecord.HandlerFunc
		align 8
stru_100301C8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000E42B+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000E42B
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000E46E	; ScopeRecord.FilterFunc
		dd offset loc_1000E481	; ScopeRecord.HandlerFunc
		align 8
stru_100301E8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000E821+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000E821
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000E8B9	; ScopeRecord.FilterFunc
		dd offset loc_1000E8BD	; ScopeRecord.HandlerFunc
		align 8
stru_10030208	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtOpenThread(x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100130F3
		dd 0FFFFFF88h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1001322B	; ScopeRecord.FilterFunc
		dd offset loc_1001322F	; ScopeRecord.HandlerFunc
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013225	; ScopeRecord.FilterFunc
		dd offset loc_10013229	; ScopeRecord.HandlerFunc
stru_10030230	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtOpenProcess(x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10012DDF
		dd 0FFFFFF88h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10012EE5	; ScopeRecord.FilterFunc
		dd offset loc_10012EE9	; ScopeRecord.HandlerFunc
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10012EDF	; ScopeRecord.FilterFunc
		dd offset loc_10012EE3	; ScopeRecord.HandlerFunc
stru_10030258	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtOpenProcessToken(x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10012F00
		dd 0FFFFFF90h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10012FDB	; ScopeRecord.FilterFunc
		dd offset loc_10012FDF	; ScopeRecord.HandlerFunc
		align 8
stru_10030278	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10012FF6
		dd 0FFFFFF90h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100130D8	; ScopeRecord.FilterFunc
		dd offset loc_100130DC	; ScopeRecord.HandlerFunc
		align 8
stru_10030298	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10012964+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10012964
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100129FC	; ScopeRecord.FilterFunc
		dd offset loc_10012A00	; ScopeRecord.HandlerFunc
		align 8
stru_100302B8	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013D6C
		dd 0FFFFFF7Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013F0B	; ScopeRecord.FilterFunc
		dd offset loc_10013F0F	; ScopeRecord.HandlerFunc
		align 8
stru_100302D8	dd 0FFFFFFE4h		; GSCookieOffset ; DATA	XREF: sub_10013BAD+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013BAD
		dd 0FFFFFF8Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013CA3	; ScopeRecord.FilterFunc
		dd offset loc_10013CA7	; ScopeRecord.HandlerFunc
		align 8
stru_100302F8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10013CBC+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013CBC
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013D54	; ScopeRecord.FilterFunc
		dd offset loc_10013D58	; ScopeRecord.HandlerFunc
		align 8
stru_10030318	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10015FEE+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10015FEE
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1001601A	; ScopeRecord.FilterFunc
		dd offset loc_1001601E	; ScopeRecord.HandlerFunc
		align 8
stru_10030338	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10015B5F+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10015B5F
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10015B84	; ScopeRecord.FilterFunc
		dd offset loc_10015B92	; ScopeRecord.HandlerFunc
		align 8
stru_10030358	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1001592A+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001592A
		dd 0FFFFFFC8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100159FE	; ScopeRecord.FilterFunc
		dd offset loc_10015A0C	; ScopeRecord.HandlerFunc
		align 8
stru_10030378	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10015CD9+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10015CD9
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10015D52	; ScopeRecord.FilterFunc
		dd offset loc_10015D56	; ScopeRecord.HandlerFunc
		align 8
stru_10030398	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtCreateEvent(x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10018B1A
		dd 0FFFFFF70h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10018C67	; ScopeRecord.FilterFunc
		dd offset loc_10018C6B	; ScopeRecord.HandlerFunc
		align 8
stru_100303B8	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtOpenEvent(x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10018C82
		dd 0FFFFFF70h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10018DC2	; ScopeRecord.FilterFunc
		dd offset loc_10018DC6	; ScopeRecord.HandlerFunc
		align 8
stru_100303D8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1001ABD6+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001ABD6
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1001AC73	; ScopeRecord.HandlerFunc
		align 8
stru_100303F8	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: ___DllMainCRTStartup+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001B244
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset $LN18		; ScopeRecord.HandlerFunc
		dd 0			; ScopeRecord.EnclosingLevel
		dd offset $LN22		; ScopeRecord.FilterFunc
		dd offset $LN23		; ScopeRecord.HandlerFunc
stru_10030420	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: __IsNonwritableInCurrentImage+5o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001B6A0
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1001B729	; ScopeRecord.FilterFunc
		dd offset loc_1001B73C	; ScopeRecord.HandlerFunc
		align 10h
;
; Export directory for sandboxbroker.dll
;
		dd 0			; Characteristics
		dd 56F29A5Fh		; TimeDateStamp: Wed Mar 23 13:30:07 2016
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd rva aSandboxbroker_	; Name
		dd 1			; Base
		dd 31h			; NumberOfFunctions
		dd 31h			; NumberOfNames
		dd rva off_10030468	; AddressOfFunctions
		dd rva off_1003052C	; AddressOfNames
		dd rva word_100305F0	; AddressOfNameOrdinals
;
; Export Address Table for sandboxbroker.dll
;
off_10030468	dd rva ??0SandboxBroker@mozilla@@QAE@ABV01@@Z, rva ??0SandboxBroker@mozilla@@QAE@XZ
					; DATA XREF: .rdata:1003045Co
		dd rva ??1SandboxBroker@mozilla@@UAE@XZ, rva ??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z ; mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker	const &)
		dd rva ??_7SandboxBroker@mozilla@@6B@, rva ?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z
		dd rva ?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
		dd rva ?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
		dd rva ?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z
		dd rva ?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z
		dd rva ?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ
		dd rva ?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ
		dd rva ?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z
		dd rva ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A
		dd rva IsSandboxedProcess, rva _TargetCreateNamedPipeW@36
		dd rva _TargetCreateProcessA@44, rva _TargetCreateProcessW@44
		dd rva _TargetGdiDllInitialize@12, rva _TargetGetStockObject@8
		dd rva _TargetNtCreateEvent@24,	rva _TargetNtCreateFile@48
		dd rva _TargetNtCreateKey@32, rva _TargetNtMapViewOfSection@44
		dd rva _TargetNtOpenEvent@16, rva _TargetNtOpenFile@28
		dd rva _TargetNtOpenKey@16, rva	_TargetNtOpenKeyEx@20
		dd rva _TargetNtOpenProcess@20,	rva _TargetNtOpenProcessToken@16
		dd rva _TargetNtOpenProcessTokenEx@20, rva _TargetNtOpenThread@20
		dd rva _TargetNtOpenThreadToken@20, rva	_TargetNtOpenThreadTokenEx@24
		dd rva _TargetNtQueryAttributesFile@12,	rva _TargetNtQueryFullAttributesFile@12
		dd rva _TargetNtSetInformationFile@24, rva _TargetNtSetInformationThread@20
		dd rva _TargetNtUnmapViewOfSection@12, rva _TargetRegisterClassW@8
		dd rva g_handles_to_close, rva g_interceptions,	rva g_nt
		dd rva g_originals, rva	g_shared_IPC_size, rva g_shared_delayed_integrity_level
		dd rva g_shared_delayed_mitigations, rva g_shared_policy_size
		dd rva g_shared_section
;
; Export Names Table for sandboxbroker.dll
;
off_1003052C	dd rva a??0sandboxbrok,	rva a??0sandboxbr_0, rva a??1sandboxbrok
					; DATA XREF: .rdata:10030460o
		dd rva a??4sandboxbrok,	rva a??_7sandboxbro, rva a?allowdirector ; "??0SandboxBroker@mozilla@@QAE@ABV01@@Z"
		dd rva a?allowreadfile,	rva a?allowreadwrit, rva a?launchapp@san
		dd rva a?providelogfun,	rva a?setsecurityle, rva a?setsecurity_0
		dd rva a?setsecurity_1,	rva a?sbrokerservic, rva aIssandboxedpro
		dd rva a_targetcreaten,	rva a_targetcreatep, rva a_targetcreat_0
		dd rva a_targetgdidlli,	rva a_targetgetstoc, rva a_targetntcreat
		dd rva a_targetntcre_0,	rva a_targetntcre_1, rva a_targetntmapvi
		dd rva a_targetntopene,	rva a_targetntopenf, rva a_targetntopenk
		dd rva a_targetntope_0,	rva a_targetntopenp, rva a_targetntope_1
		dd rva a_targetntope_2,	rva a_targetntopent, rva a_targetntope_3
		dd rva a_targetntope_4,	rva a_targetntquery, rva a_targetntque_0
		dd rva a_targetntsetin,	rva a_targetntset_0, rva a_targetntunmap
		dd rva a_targetregiste,	rva aG_handles_to_c, rva aG_interception
		dd rva aG_nt, rva aG_originals,	rva aG_shared_ipc_s, rva aG_shared_delay
		dd rva aG_shared_del_0,	rva aG_shared_polic, rva aG_shared_secti
;
; Export Ordinals Table	for sandboxbroker.dll
;
word_100305F0	dw 0, 1, 2, 3, 4, 5, 6,	7, 8, 9, 0Ah, 0Bh, 0Ch,	0Dh, 0Eh
					; DATA XREF: .rdata:10030464o
		dw 0Fh,	10h, 11h, 12h, 13h, 14h, 15h, 16h, 17h,	18h, 19h
		dw 1Ah,	1Bh, 1Ch, 1Dh, 1Eh, 1Fh, 20h, 21h, 22h,	23h, 24h
		dw 25h,	26h, 27h, 28h, 29h, 2Ah, 2Bh, 2Ch, 2Dh,	2Eh, 2Fh
		dw 30h
aSandboxbroker_	db 'sandboxbroker.dll',0 ; DATA XREF: .rdata:1003044Co
a??0sandboxbrok	db '??0SandboxBroker@mozilla@@QAE@ABV01@@Z',0
					; DATA XREF: .rdata:off_1003052Co
a??0sandboxbr_0	db '??0SandboxBroker@mozilla@@QAE@XZ',0 ; DATA XREF: .rdata:off_1003052Co
a??1sandboxbrok	db '??1SandboxBroker@mozilla@@UAE@XZ',0 ; DATA XREF: .rdata:off_1003052Co
a??4sandboxbrok	db '??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z',0
					; DATA XREF: .rdata:off_1003052Co
a??_7sandboxbro	db '??_7SandboxBroker@mozilla@@6B@',0 ; DATA XREF: .rdata:off_1003052Co
a?allowdirector	db '?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z',0
					; DATA XREF: .rdata:off_1003052Co
a?allowreadfile	db '?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z',0
					; DATA XREF: .rdata:off_1003052Co
a?allowreadwrit	db '?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z',0
					; DATA XREF: .rdata:off_1003052Co
a?launchapp@san	db '?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z',0
					; DATA XREF: .rdata:off_1003052Co
a?providelogfun	db '?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z',0
					; DATA XREF: .rdata:off_1003052Co
a?setsecurityle	db '?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ',0
					; DATA XREF: .rdata:off_1003052Co
a?setsecurity_0	db '?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QA'
					; DATA XREF: .rdata:off_1003052Co
		db 'E_NXZ',0
a?setsecurity_1	db '?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z'
					; DATA XREF: .rdata:off_1003052Co
		db 0
a?sbrokerservic	db '?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox'
					; DATA XREF: .rdata:off_1003052Co
		db '@@A',0
aIssandboxedpro	db 'IsSandboxedProcess',0 ; DATA XREF: .rdata:off_1003052Co
a_targetcreaten	db '_TargetCreateNamedPipeW@36',0 ; DATA XREF: .rdata:off_1003052Co
a_targetcreatep	db '_TargetCreateProcessA@44',0 ; DATA XREF: .rdata:off_1003052Co
a_targetcreat_0	db '_TargetCreateProcessW@44',0 ; DATA XREF: .rdata:off_1003052Co
a_targetgdidlli	db '_TargetGdiDllInitialize@12',0 ; DATA XREF: .rdata:off_1003052Co
a_targetgetstoc	db '_TargetGetStockObject@8',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntcreat	db '_TargetNtCreateEvent@24',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntcre_0	db '_TargetNtCreateFile@48',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntcre_1	db '_TargetNtCreateKey@32',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntmapvi	db '_TargetNtMapViewOfSection@44',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntopene	db '_TargetNtOpenEvent@16',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntopenf	db '_TargetNtOpenFile@28',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntopenk	db '_TargetNtOpenKey@16',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntope_0	db '_TargetNtOpenKeyEx@20',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntopenp	db '_TargetNtOpenProcess@20',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntope_1	db '_TargetNtOpenProcessToken@16',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntope_2	db '_TargetNtOpenProcessTokenEx@20',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntopent	db '_TargetNtOpenThread@20',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntope_3	db '_TargetNtOpenThreadToken@20',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntope_4	db '_TargetNtOpenThreadTokenEx@24',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntquery	db '_TargetNtQueryAttributesFile@12',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntque_0	db '_TargetNtQueryFullAttributesFile@12',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntsetin	db '_TargetNtSetInformationFile@24',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntset_0	db '_TargetNtSetInformationThread@20',0 ; DATA XREF: .rdata:off_1003052Co
a_targetntunmap	db '_TargetNtUnmapViewOfSection@12',0 ; DATA XREF: .rdata:off_1003052Co
a_targetregiste	db '_TargetRegisterClassW@8',0 ; DATA XREF: .rdata:off_1003052Co
aG_handles_to_c	db 'g_handles_to_close',0 ; DATA XREF: .rdata:off_1003052Co
aG_interception	db 'g_interceptions',0  ; DATA XREF: .rdata:off_1003052Co
aG_nt		db 'g_nt',0             ; DATA XREF: .rdata:off_1003052Co
aG_originals	db 'g_originals',0      ; DATA XREF: .rdata:off_1003052Co
aG_shared_ipc_s	db 'g_shared_IPC_size',0 ; DATA XREF: .rdata:off_1003052Co
aG_shared_delay	db 'g_shared_delayed_integrity_level',0 ; DATA XREF: .rdata:off_1003052Co
aG_shared_del_0	db 'g_shared_delayed_mitigations',0 ; DATA XREF: .rdata:off_1003052Co
aG_shared_polic	db 'g_shared_policy_size',0 ; DATA XREF: .rdata:off_1003052Co
aG_shared_secti	db 'g_shared_section',0 ; DATA XREF: .rdata:off_1003052Co
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_10030D74 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva QueryPerformanceCounter ; Import	Address	Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_10031050 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva GetUserObjectInformationW ; Import Address Table
__IMPORT_DESCRIPTOR_WINMM dd rva off_10031074 ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aWinmm_dll	; DLL Name
		dd rva __imp_timeGetTime ; Import Address Table
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_10030D10 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva RevertToSelf	; Import Address Table
__IMPORT_DESCRIPTOR_MSVCP120 dd	rva off_10030EBC ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcp120_dll	; DLL Name
		dd rva ?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ ; Import Address Table
__IMPORT_DESCRIPTOR_MSVCR120 dd	rva off_10030FB8 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcr120_dll	; DLL Name
		dd rva _vscwprintf_p	; Import Address Table
		dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_10030D10	dd rva word_10031902	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_10031830
		dd rva word_10031818
		dd rva word_10031804
		dd rva word_100317F0
		dd rva word_100317DE
		dd rva word_100317C4
		dd rva word_100317B2
		dd rva word_100317A0
		dd rva word_1003178C
		dd rva word_10031776
		dd rva word_10031760
		dd rva word_10031854
		dd rva word_1003186C
		dd rva word_1003187E
		dd rva word_1003188E
		dd rva word_100318AA
		dd rva word_100318E2
		dd rva word_100318EC
		dd rva word_10031912
		dd rva word_10031920
		dd rva word_1003193C
		dd rva word_1003194C
		dd rva word_1003183C
		dd 0
;
; Import names for KERNEL32.dll
;
off_10030D74	dd rva word_100311F2	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_1003120C
		dd rva word_10031228
		dd rva word_10031242
		dd rva word_10031256
		dd rva word_10031266
		dd rva word_1003127C
		dd rva word_10031288
		dd rva word_10031296
		dd rva word_100312A6
		dd rva word_100312BC
		dd rva word_100312CC
		dd rva word_100312DE
		dd rva word_100312F0
		dd rva word_10031304
		dd rva word_1003131A
		dd rva word_10031330
		dd rva word_1003133C
		dd rva word_10031356
		dd rva word_10031372
		dd rva word_10031390
		dd rva word_100313AC
		dd rva word_100313BC
		dd rva word_100313D0
		dd rva word_100313EE
		dd rva word_10031404
		dd rva word_1003141E
		dd rva word_10031446
		dd rva word_1003145E
		dd rva word_1003146C
		dd rva word_10031482
		dd rva word_10031490
		dd rva word_100314A4
		dd rva word_100314B2
		dd rva word_100314C2
		dd rva word_100314D6
		dd rva word_100314F2
		dd rva word_10031506
		dd rva word_10031514
		dd rva word_10031520
		dd rva word_10031536
		dd rva word_10031548
		dd rva word_1003155C
		dd rva word_1003156A
		dd rva word_10031582
		dd rva word_10031596
		dd rva word_100315A4
		dd rva word_100315B4
		dd rva word_100315CA
		dd rva word_100315DA
		dd rva word_100315EC
		dd rva word_10031604
		dd rva word_10031618
		dd rva word_1003162E
		dd rva word_1003163E
		dd rva word_10031654
		dd rva word_10031668
		dd rva word_10032A1A
		dd rva word_10032A0A
		dd rva word_100311DC
		dd rva word_100311CC
		dd rva word_100311B8
		dd rva word_10032A46
		dd rva word_100311B0
		dd rva word_1003119A
		dd rva word_10031188
		dd rva word_10031176
		dd rva word_10031162
		dd rva word_1003114A
		dd rva word_10031122
		dd rva word_1003110A
		dd rva word_100310F2
		dd rva word_100310E0
		dd rva word_100310CA
		dd rva word_100310BA
		dd rva word_100310AA
		dd rva word_1003109A
		dd rva word_1003108C
		dd rva word_1003107C
		dd rva word_10032A2A
		dd rva word_1003142E
		dd 0
;
; Import names for MSVCP120.dll
;
off_10030EBC	dd rva word_1003241A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCP120o
		dd rva word_100327AA
		dd rva word_10032786
		dd rva word_1003273C
		dd rva word_100326F2
		dd rva word_100326B0
		dd rva word_10032670
		dd rva word_1003262A
		dd rva word_100325DC
		dd rva word_1003258E
		dd rva word_1003254A
		dd rva word_10032508
		dd rva word_1003196C
		dd rva word_10031986
		dd rva word_100319A6
		dd rva word_100319C6
		dd rva word_100319E6
		dd rva word_10031A06
		dd rva word_10031A32
		dd rva word_10031A6E
		dd rva word_10031AAA
		dd rva word_10031AEA
		dd rva word_10031B30
		dd rva word_10031B72
		dd rva word_10031BB2
		dd rva word_10031C1C
		dd rva word_10031C56
		dd rva word_10031C94
		dd rva word_10031CD4
		dd rva word_10031D14
		dd rva word_10031D56
		dd rva word_10031D96
		dd rva word_10031DD8
		dd rva word_10031E24
		dd rva word_10031E6E
		dd rva word_10031EB2
		dd rva word_10031EF0
		dd rva word_10031F30
		dd rva word_10031F76
		dd rva word_10031FBC
		dd rva word_10031FD2
		dd rva word_10031FEA
		dd rva word_1003201E
		dd rva word_10032038
		dd rva word_10032052
		dd rva word_1003206E
		dd rva word_100320A2
		dd rva word_100320C4
		dd rva word_10032100
		dd rva word_1003212A
		dd rva word_10032168
		dd rva word_100321A6
		dd rva word_100321EA
		dd rva word_10032232
		dd rva word_10032274
		dd rva word_100322B6
		dd rva word_100322FC
		dd rva word_1003233E
		dd rva word_1003237E
		dd rva word_100323D8
		dd rva word_100324CC
		dd rva word_1003245E
		dd 0
;
; Import names for MSVCR120.dll
;
off_10030FB8	dd rva word_1003285E	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCR120o
		dd rva word_1003299E
		dd rva word_10032990
		dd rva word_10032984
		dd rva word_10032976
		dd rva word_10032968
		dd rva word_10032956
		dd rva word_1003293C
		dd rva word_10032932
		dd rva word_10032924
		dd rva word_100329E6
		dd rva word_100329CE
		dd rva word_100327EE
		dd rva word_100327FA
		dd rva word_1003280A
		dd rva word_1003281A
		dd rva word_10032824
		dd rva word_1003282E
		dd rva word_10032838
		dd rva word_10032842
		dd rva word_1003284E
		dd rva word_10032916
		dd rva word_1003286E
		dd rva word_10032876
		dd rva word_10032880
		dd rva word_10032890
		dd rva word_1003289A
		dd rva word_100328A2
		dd rva word_100328AC
		dd rva word_100328B8
		dd rva word_100328C4
		dd rva word_100328D0
		dd rva word_100328DA
		dd rva word_100328E6
		dd rva word_10032904
		dd rva word_1003290C
		dd rva word_100329B4
		dd 0
;
; Import names for USER32.dll
;
off_10031050	dd rva word_10031720	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_10031706
		dd rva word_100316EC
		dd rva word_100316D4
		dd rva word_100316C0
		dd rva word_100316AE
		dd rva word_10031698
		dd rva word_10031688
		dd 0
;
; Import names for WINMM.dll
;
off_10031074	dd rva word_10031748	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WINMMo
		dd 0
word_1003107C	dw 2C0h			; DATA XREF: .rdata:10030EACo
		db 'GetStdHandle',0
		align 4
word_1003108C	dw 7Fh			; DATA XREF: .rdata:10030EA8o
		db 'CloseHandle',0
word_1003109A	dw 4A7h			; DATA XREF: .rdata:10030EA4o
		db 'ResumeThread',0
		align 2
word_100310AA	dw 250h			; DATA XREF: .rdata:10030EA0o
		db 'GetLastError',0
		align 2
word_100310BA	dw 50Ah			; DATA XREF: .rdata:10030E9Co
		db 'SetLastError',0
		align 2
word_100310CA	dw 266h			; DATA XREF: .rdata:10030E98o
		db 'GetModuleHandleExW',0
		align 10h
word_100310E0	dw 29Dh			; DATA XREF: .rdata:10030E94o
		db 'GetProcAddress',0
		align 2
word_100310F2	dw 125h			; DATA XREF: .rdata:10030E90o
		db 'EnterCriticalSection',0
		align 2
word_1003110A	dw 3A2h			; DATA XREF: .rdata:10030E8Co
		db 'LeaveCriticalSection',0
		align 2
word_10031122	dw 348h			; DATA XREF: .rdata:10030E88o
		db 'InitializeCriticalSectionAndSpinCount',0
word_1003114A	dw 105h			; DATA XREF: .rdata:10030E84o
		db 'DeleteCriticalSection',0
word_10031162	dw 367h			; DATA XREF: .rdata:10030E80o
		db 'IsDebuggerPresent',0
word_10031176	dw 11Fh			; DATA XREF: .rdata:10030E7Co
		db 'DuplicateHandle',0
word_10031188	dw 43Fh			; DATA XREF: .rdata:10030E78o
		db 'RaiseException',0
		align 2
word_1003119A	dw 5A9h			; DATA XREF: .rdata:10030E74o
		db 'WaitForSingleObject',0
word_100311B0	dw 550h			; DATA XREF: .rdata:10030E70o
		db 'Sleep',0
word_100311B8	dw 209h			; DATA XREF: .rdata:10030E68o
		db 'GetCurrentProcess',0
word_100311CC	dw 0E8h			; DATA XREF: .rdata:10030E64o
		db 'CreateThread',0
		align 4
word_100311DC	dw 20Eh			; DATA XREF: .rdata:10030E60o
		db 'GetCurrentThreadId',0
		align 2
word_100311F2	dw 42Dh			; DATA XREF: .rdata:off_10030D74o
		db 'QueryPerformanceCounter',0
word_1003120C	dw 42Eh			; DATA XREF: .rdata:10030D78o
		db 'QueryPerformanceFrequency',0
word_10031228	dw 2D6h			; DATA XREF: .rdata:10030D7Co
		db 'GetSystemTimeAsFileTime',0
word_10031242	dw 267h			; DATA XREF: .rdata:10030D80o
		db 'GetModuleHandleW',0
		align 2
word_10031256	dw 305h			; DATA XREF: .rdata:10030D84o
		db 'GetVersionExW',0
word_10031266	dw 274h			; DATA XREF: .rdata:10030D88o
		db 'GetNativeSystemInfo',0
word_1003127C	dw 4EFh			; DATA XREF: .rdata:10030D8Co
		db 'SetEvent',0
		align 4
word_10031288	dw 4A1h			; DATA XREF: .rdata:10030D90o
		db 'ResetEvent',0
		align 2
word_10031296	dw 0B6h			; DATA XREF: .rdata:10030D94o
		db 'CreateEventW',0
		align 2
word_100312A6	dw 22Ch			; DATA XREF: .rdata:10030D98o
		db 'GetExitCodeProcess',0
		align 4
word_100312BC	dw 558h			; DATA XREF: .rdata:10030D9Co
		db 'SuspendThread',0
word_100312CC	dw 0DBh			; DATA XREF: .rdata:10030DA0o
		db 'CreateProcessW',0
		align 2
word_100312DE	dw 59Ah			; DATA XREF: .rdata:10030DA4o
		db 'VirtualAllocEx',0
		align 10h
word_100312F0	dw 452h			; DATA XREF: .rdata:10030DA8o
		db 'ReadProcessMemory',0
word_10031304	dw 5E8h			; DATA XREF: .rdata:10030DACo
		db 'WriteProcessMemory',0
		align 2
word_1003131A	dw 263h			; DATA XREF: .rdata:10030DB0o
		db 'GetModuleFileNameW',0
		align 10h
word_10031330	dw 3B2h			; DATA XREF: .rdata:10030DB4o
		db 'LocalFree',0
word_1003133C	dw 0C7h			; DATA XREF: .rdata:10030DB8o
		db 'CreateIoCompletionPort',0
		align 2
word_10031356	dw 2B8h			; DATA XREF: .rdata:10030DBCo
		db 'GetQueuedCompletionStatus',0
word_10031372	dw 404h			; DATA XREF: .rdata:10030DC0o
		db 'PostQueuedCompletionStatus',0
		align 10h
word_10031390	dw 347h			; DATA XREF: .rdata:10030DC4o
		db 'InitializeCriticalSection',0
word_100313AC	dw 2A4h			; DATA XREF: .rdata:10030DC8o
		db 'GetProcessId',0
		align 4
word_100313BC	dw 58Ah			; DATA XREF: .rdata:10030DCCo
		db 'UnregisterWaitEx',0
		align 10h
word_100313D0	dw 484h			; DATA XREF: .rdata:10030DD0o
		db 'RegisterWaitForSingleObject',0
word_100313EE	dw 55Eh			; DATA XREF: .rdata:10030DD4o
		db 'TerminateJobObject',0
		align 4
word_10031404	dw 508h			; DATA XREF: .rdata:10030DD8o
		db 'SetInformationJobObject',0
word_1003141E	dw 59Dh			; DATA XREF: .rdata:10030DDCo
		db 'VirtualFreeEx',0
word_1003142E	dw 507h			; DATA XREF: .rdata:10030EB4o
		db 'SetHandleInformation',0
		align 2
word_10031446	dw 2A1h			; DATA XREF: .rdata:10030DE0o
		db 'GetProcessHandleCount',0
word_1003145E	dw 59Ch			; DATA XREF: .rdata:10030DE4o
		db 'VirtualFree',0
word_1003146C	dw 20Ah			; DATA XREF: .rdata:10030DE8o
		db 'GetCurrentProcessId',0
word_10031482	dw 3EEh			; DATA XREF: .rdata:10030DECo
		db 'OpenProcess',0
word_10031490	dw 5A0h			; DATA XREF: .rdata:10030DF0o
		db 'VirtualProtectEx',0
		align 4
word_100314A4	dw 19Eh			; DATA XREF: .rdata:10030DF4o
		db 'FreeLibrary',0
word_100314B2	dw 3A8h			; DATA XREF: .rdata:10030DF8o
		db 'LoadLibraryW',0
		align 2
word_100314C2	dw 0C9h			; DATA XREF: .rdata:10030DFCo
		db 'CreateJobObjectW',0
		align 2
word_100314D6	dw 1Ch			; DATA XREF: .rdata:10030E00o
		db 'AssignProcessToJobObject',0
		align 2
word_100314F2	dw 0D3h			; DATA XREF: .rdata:10030E04o
		db 'CreateNamedPipeW',0
		align 2
word_10031506	dw 0FBh			; DATA XREF: .rdata:10030E08o
		db 'DebugBreak',0
		align 4
word_10031514	dw 609h			; DATA XREF: .rdata:10030E0Co
		db 'lstrlenW',0
		align 10h
word_10031520	dw 337h			; DATA XREF: .rdata:10030E10o
		db 'HeapSetInformation',0
		align 2
word_10031536	dw 5A2h			; DATA XREF: .rdata:10030E14o
		db 'VirtualQueryEx',0
		align 4
word_10031548	dw 264h			; DATA XREF: .rdata:10030E18o
		db 'GetModuleHandleA',0
		align 4
word_1003155C	dw 4B1h			; DATA XREF: .rdata:10030E1Co
		db 'SearchPathW',0
word_1003156A	dw 203h			; DATA XREF: .rdata:10030E20o
		db 'GetCurrentDirectoryW',0
		align 2
word_10031582	dw 55Fh			; DATA XREF: .rdata:10030E24o
		db 'TerminateProcess',0
		align 2
word_10031596	dw 23Eh			; DATA XREF: .rdata:10030E28o
		db 'GetFileType',0
word_100315A4	dw 2F2h			; DATA XREF: .rdata:10030E2Co
		db 'GetTickCount',0
		align 4
word_100315B4	dw 54Eh			; DATA XREF: .rdata:10030E30o
		db 'SignalObjectAndWait',0
word_100315CA	dw 0D1h			; DATA XREF: .rdata:10030E34o
		db 'CreateMutexW',0
		align 2
word_100315DA	dw 583h			; DATA XREF: .rdata:10030E38o
		db 'UnmapViewOfFile',0
word_100315EC	dw 410h			; DATA XREF: .rdata:10030E3Co
		db 'ProcessIdToSessionId',0
		align 4
word_10031604	dw 2E4h			; DATA XREF: .rdata:10030E40o
		db 'GetThreadContext',0
		align 4
word_10031618	dw 0BFh			; DATA XREF: .rdata:10030E44o
		db 'CreateFileMappingW',0
		align 2
word_1003162E	dw 3C0h			; DATA XREF: .rdata:10030E48o
		db 'MapViewOfFile',0
word_1003163E	dw 235h			; DATA XREF: .rdata:10030E4Co
		db 'GetFileAttributesW',0
		align 4
word_10031654	dw 25Dh			; DATA XREF: .rdata:10030E50o
		db 'GetLongPathNameW',0
		align 4
word_10031668	dw 426h			; DATA XREF: .rdata:10030E54o
		db 'QueryDosDeviceW',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:10030C90o
		align 4
word_10031688	dw 4Ch			; DATA XREF: .rdata:1003106Co
		db 'CloseDesktop',0
		align 4
word_10031698	dw 50h			; DATA XREF: .rdata:10031068o
		db 'CloseWindowStation',0
		align 2
word_100316AE	dw 61h			; DATA XREF: .rdata:10031064o
		db 'CreateDesktopW',0
		align 10h
word_100316C0	dw 1AEh			; DATA XREF: .rdata:10031060o
		db 'GetThreadDesktop',0
		align 4
word_100316D4	dw 75h			; DATA XREF: .rdata:1003105Co
		db 'CreateWindowStationW',0
		align 4
word_100316EC	dw 2EFh			; DATA XREF: .rdata:10031058o
		db 'SetProcessWindowStation',0
word_10031706	dw 193h			; DATA XREF: .rdata:10031054o
		db 'GetProcessWindowStation',0
word_10031720	dw 1B8h			; DATA XREF: .rdata:off_10031050o
		db 'GetUserObjectInformationW',0
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:10030CA4o
		align 4
word_10031748	dw 94h			; DATA XREF: .rdata:off_10031074o
		db 'timeGetTime',0
aWinmm_dll	db 'WINMM.dll',0        ; DATA XREF: .rdata:10030CB8o
word_10031760	dw 16Fh			; DATA XREF: .rdata:10030D3Co
		db 'GetTokenInformation',0
word_10031776	dw 2EBh			; DATA XREF: .rdata:10030D38o
		db 'SetTokenInformation',0
word_1003178C	dw 2CFh			; DATA XREF: .rdata:10030D34o
		db 'SetEntriesInAclW',0
		align 10h
word_100317A0	dw 162h			; DATA XREF: .rdata:10030D30o
		db 'GetSecurityInfo',0
word_100317B2	dw 2E4h			; DATA XREF: .rdata:10030D2Co
		db 'SetSecurityInfo',0
word_100317C4	dw 83h			; DATA XREF: .rdata:10030D28o
		db 'ConvertStringSidToSidW',0
		align 2
word_100317DE	dw 0EEh			; DATA XREF: .rdata:10030D24o
		db 'DuplicateToken',0
		align 10h
word_100317F0	dw 0EFh			; DATA XREF: .rdata:10030D20o
		db 'DuplicateTokenEx',0
		align 4
word_10031804	dw 212h			; DATA XREF: .rdata:10030D1Co
		db 'OpenProcessToken',0
		align 4
word_10031818	dw 8Eh			; DATA XREF: .rdata:10030D18o
		db 'CreateRestrictedToken',0
word_10031830	dw 118h			; DATA XREF: .rdata:10030D14o
		db 'EqualSid',0
		align 4
word_1003183C	dw 1ADh			; DATA XREF: .rdata:10030D6Co
		db 'LookupPrivilegeValueW',0
word_10031854	dw 8Bh			; DATA XREF: .rdata:10030D40o
		db 'CreateProcessAsUserW',0
		align 4
word_1003186C	dw 2EAh			; DATA XREF: .rdata:10030D44o
		db 'SetThreadToken',0
		align 2
word_1003187E	dw 14Ah			; DATA XREF: .rdata:10030D48o
		db 'GetLengthSid',0
		align 2
word_1003188E	dw 161h			; DATA XREF: .rdata:10030D4Co
		db 'GetSecurityDescriptorSacl',0
word_100318AA	dw 81h			; DATA XREF: .rdata:10030D50o
		db 'ConvertStringSecurityDescriptorToSecurityDescriptorW',0
		align 2
word_100318E2	dw 85h			; DATA XREF: .rdata:10030D54o
		db 'CopySid',0
word_100318EC	dw 92h			; DATA XREF: .rdata:10030D58o
		db 'CreateWellKnownSid',0
		align 2
word_10031902	dw 2B8h			; DATA XREF: .rdata:off_10030D10o
		db 'RevertToSelf',0
		align 2
word_10031912	dw 254h			; DATA XREF: .rdata:10030D5Co
		db 'RegCloseKey',0
word_10031920	dw 26Dh			; DATA XREF: .rdata:10030D60o
		db 'RegDisablePredefinedCache',0
word_1003193C	dw 285h			; DATA XREF: .rdata:10030D64o
		db 'RegOpenKeyExW',0
word_1003194C	dw 25Dh			; DATA XREF: .rdata:10030D68o
		db 'RegCreateKeyExW',0
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:10030CCCo
		align 4
word_1003196C	dw 2C9h			; DATA XREF: .rdata:10030EECo
		db '?_Xbad_alloc@std@@YAXXZ',0
word_10031986	dw 2CCh			; DATA XREF: .rdata:10030EF0o
		db '?_Xlength_error@std@@YAXPBD@Z',0
word_100319A6	dw 2CDh			; DATA XREF: .rdata:10030EF4o
		db '?_Xout_of_range@std@@YAXPBD@Z',0
word_100319C6	dw 2B0h			; DATA XREF: .rdata:10030EF8o
		db '?_Syserror_map@std@@YAPBDH@Z',0
		align 2
word_100319E6	dw 2C5h			; DATA XREF: .rdata:10030EFCo
		db '?_Winerror_map@std@@YAPBDH@Z',0
		align 2
word_10031A06	dw 243h			; DATA XREF: .rdata:10030F00o
		db '?_Ios_base_dtor@ios_base@std@@CAXPAV12@@Z',0
word_10031A32	dw 2Ah			; DATA XREF: .rdata:10030F04o
		db '??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAE@XZ',0
		align 2
word_10031A6E	dw 87h			; DATA XREF: .rdata:10030F08o
		db '??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAE@XZ',0
		align 2
word_10031AAA	dw 4FFh			; DATA XREF: .rdata:10030F0Co
		db '?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z',0
word_10031AEA	dw 502h			; DATA XREF: .rdata:10030F10o
		db '?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@'
		db 'Z',0
		align 10h
word_10031B30	dw 27Ch			; DATA XREF: .rdata:10030F14o
		db '?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ',0
word_10031B72	dw 4E6h			; DATA XREF: .rdata:10030F18o
		db '?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z',0
		align 2
word_10031BB2	dw 20h			; DATA XREF: .rdata:10030F1Co
		db '??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_st'
		db 'reambuf@DU?$char_traits@D@std@@@1@_N@Z',0
word_10031C1C	dw 84h			; DATA XREF: .rdata:10030F20o
		db '??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UAE@XZ',0
		align 2
word_10031C56	dw 276h			; DATA XREF: .rdata:10030F24o
		db '?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ',0
		align 4
word_10031C94	dw 0FEh			; DATA XREF: .rdata:10030F28o
		db '??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z',0
		align 4
word_10031CD4	dw 0FFh			; DATA XREF: .rdata:10030F2Co
		db '??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z',0
		align 4
word_10031D14	dw 38Eh			; DATA XREF: .rdata:10030F30o
		db '?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ',0
word_10031D56	dw 258h			; DATA XREF: .rdata:10030F34o
		db '?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ',0
		align 2
word_10031D96	dw 2BFh			; DATA XREF: .rdata:10030F38o
		db '?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ',0
		align 4
word_10031DD8	dw 41Ch			; DATA XREF: .rdata:10030F3Co
		db '?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEXABVloca'
		db 'le@2@@Z',0
		align 4
word_10031E24	dw 4D6h			; DATA XREF: .rdata:10030F40o
		db '?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEPAV12@P'
		db 'AD_J@Z',0
word_10031E6E	dw 4F6h			; DATA XREF: .rdata:10030F44o
		db '?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JXZ'
		db 0
word_10031EB2	dw 521h			; DATA XREF: .rdata:10030F48o
		db '?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ',0
word_10031EF0	dw 540h			; DATA XREF: .rdata:10030F4Co
		db '?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ',0
		align 10h
word_10031F30	dw 56Bh			; DATA XREF: .rdata:10030F50o
		db '?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPAD_J'
		db '@Z',0
word_10031F76	dw 56Eh			; DATA XREF: .rdata:10030F54o
		db '?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPBD_J'
		db '@Z',0
word_10031FBC	dw 1A7h			; DATA XREF: .rdata:10030F58o
		db '?_BADOFF@std@@3_JB',0
		align 2
word_10031FD2	dw 159h			; DATA XREF: .rdata:10030F5Co
		db '??_7ios_base@std@@6B@',0
word_10031FEA	dw 132h			; DATA XREF: .rdata:10030F60o
		db '??_7?$basic_ios@DU?$char_traits@D@std@@@std@@6B@',0
		align 2
word_1003201E	dw 66h			; DATA XREF: .rdata:10030F64o
		db '??0_Lockit@std@@QAE@H@Z',0
word_10032038	dw 0A5h			; DATA XREF: .rdata:10030F68o
		db '??1_Lockit@std@@QAE@XZ',0
		align 2
word_10032052	dw 130h			; DATA XREF: .rdata:10030F6Co
		db '??Bid@locale@std@@QAEIXZ',0
		align 2
word_1003206E	dw 1EDh			; DATA XREF: .rdata:10030F70o
		db '?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ',0
		align 2
word_100320A2	dw 561h			; DATA XREF: .rdata:10030F74o
		db '?widen@?$ctype@_W@std@@QBE_WD@Z',0
word_100320C4	dw 1D0h			; DATA XREF: .rdata:10030F78o
		db '?_Getcat@?$ctype@_W@std@@SAIPAPBVfacet@locale@2@PBV42@@Z',0
		align 10h
word_10032100	dw 3E9h			; DATA XREF: .rdata:10030F7Co
		db '?getloc@ios_base@std@@QBE?AVlocale@2@XZ',0
word_1003212A	dw 30h			; DATA XREF: .rdata:10030F80o
		db '??0?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAE@XZ',0
		align 4
word_10032168	dw 89h			; DATA XREF: .rdata:10030F84o
		db '??1?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAE@XZ',0
		align 2
word_100321A6	dw 501h			; DATA XREF: .rdata:10030F88o
		db '?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z',0
		align 2
word_100321EA	dw 504h			; DATA XREF: .rdata:10030F8Co
		db '?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W'
		db '_J@Z',0
word_10032232	dw 393h			; DATA XREF: .rdata:10030F90o
		db '?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z',0
word_10032274	dw 464h			; DATA XREF: .rdata:10030F94o
		db '?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z',0
word_100322B6	dw 27Eh			; DATA XREF: .rdata:10030F98o
		db '?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WX'
		db 'Z',0
		align 4
word_100322FC	dw 4EAh			; DATA XREF: .rdata:10030F9Co
		db '?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z',0
		align 2
word_1003233E	dw 278h			; DATA XREF: .rdata:10030FA0o
		db '?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ',0
		align 2
word_1003237E	dw 129h			; DATA XREF: .rdata:10030FA4o
		db '??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAV'
		db 'ios_base@1@AAV21@@Z@Z',0
		align 4
word_100323D8	dw 123h			; DATA XREF: .rdata:10030FA8o
		db '??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z',0
		align 2
word_1003241A	dw 390h			; DATA XREF: .rdata:off_10030EBCo
		db '?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ'
		db 0
word_1003245E	dw 12h			; DATA XREF: .rdata:10030FB0o
		db '??0?$basic_iostream@_WU?$char_traits@_W@std@@@std@@QAE@PAV?$basic'
		db '_streambuf@_WU?$char_traits@_W@std@@@1@@Z',0
		align 4
word_100324CC	dw 80h			; DATA XREF: .rdata:10030FACo
		db '??1?$basic_iostream@_WU?$char_traits@_W@std@@@std@@UAE@XZ',0
word_10032508	dw 25Ah			; DATA XREF: .rdata:10030EE8o
		db '?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ',0
		align 2
word_1003254A	dw 2C1h			; DATA XREF: .rdata:10030EE4o
		db '?_Unlock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ',0
		align 2
word_1003258E	dw 41Eh			; DATA XREF: .rdata:10030EE0o
		db '?imbue@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEXABVlo'
		db 'cale@2@@Z',0
		align 4
word_100325DC	dw 4D8h			; DATA XREF: .rdata:10030EDCo
		db '?setbuf@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEPAV12'
		db '@PA_W_J@Z',0
		align 2
word_1003262A	dw 4F8h			; DATA XREF: .rdata:10030ED8o
		db '?showmanyc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_J'
		db 'XZ',0
word_10032670	dw 523h			; DATA XREF: .rdata:10030ED4o
		db '?sync@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEHXZ',0
word_100326B0	dw 542h			; DATA XREF: .rdata:10030ED0o
		db '?uflow@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEGXZ',0
		align 2
word_100326F2	dw 56Dh			; DATA XREF: .rdata:10030ECCo
		db '?xsgetn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPA_'
		db 'W_J@Z',0
		align 4
word_1003273C	dw 570h			; DATA XREF: .rdata:10030EC8o
		db '?xsputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPB_'
		db 'W_J@Z',0
		align 2
word_10032786	dw 3F7h			; DATA XREF: .rdata:10030EC4o
		db '?id@?$ctype@_W@std@@2V0locale@2@A',0
word_100327AA	dw 134h			; DATA XREF: .rdata:10030EC0o
		db '??_7?$basic_ios@_WU?$char_traits@_W@std@@@std@@6B@',0
		align 10h
aMsvcp120_dll	db 'MSVCP120.dll',0     ; DATA XREF: .rdata:10030CE0o
		align 2
word_100327EE	dw 449h			; DATA XREF: .rdata:10030FE8o
		db '_purecall',0
word_100327FA	dw 70h			; DATA XREF: .rdata:10030FECo
		db '??2@YAPAXI@Z',0
		align 2
word_1003280A	dw 72h			; DATA XREF: .rdata:10030FF0o
		db '??3@YAXPAX@Z',0
		align 2
word_1003281A	dw 6E8h			; DATA XREF: .rdata:10030FF4o
		db 'memmove',0
word_10032824	dw 6E6h			; DATA XREF: .rdata:10030FF8o
		db 'memcpy',0
		align 2
word_1003282E	dw 6EAh			; DATA XREF: .rdata:10030FFCo
		db 'memset',0
		align 4
word_10032838	dw 6E5h			; DATA XREF: .rdata:10031000o
		db 'memcmp',0
		align 2
word_10032842	dw 4BCh			; DATA XREF: .rdata:10031004o
		db '_strnicmp',0
word_1003284E	dw 53Bh			; DATA XREF: .rdata:10031008o
		db '_vswprintf_p',0
		align 2
word_1003285E	dw 527h			; DATA XREF: .rdata:off_10030FB8o
		db '_vscwprintf_p',0
word_1003286E	dw 683h			; DATA XREF: .rdata:10031010o
		db 'free',0
		align 2
word_10032876	dw 6DBh			; DATA XREF: .rdata:10031014o
		db 'malloc',0
		align 10h
word_10032880	dw 89h			; DATA XREF: .rdata:10031018o
		db '??_V@YAXPAX@Z',0
word_10032890	dw 54Dh			; DATA XREF: .rdata:1003101Co
		db '_wcsdup',0
word_1003289A	dw 5DCh			; DATA XREF: .rdata:10031020o
		db 'abort',0
word_100328A2	dw 693h			; DATA XREF: .rdata:10031024o
		db 'getenv',0
		align 4
word_100328AC	dw 55Bh			; DATA XREF: .rdata:10031028o
		db '_wcsnicmp',0
word_100328B8	dw 7A8h			; DATA XREF: .rdata:1003102Co
		db 'wmemcpy_s',0
word_100328C4	dw 6E7h			; DATA XREF: .rdata:10031030o
		db 'memcpy_s',0
		align 10h
word_100328D0	dw 708h			; DATA XREF: .rdata:10031034o
		db 'rand_s',0
		align 2
word_100328DA	dw 551h			; DATA XREF: .rdata:10031038o
		db '_wcsicmp',0
		align 2
word_100328E6	dw 531h			; DATA XREF: .rdata:1003103Co
		db '_vsnwprintf_s',0
aMsvcr120_dll	db 'MSVCR120.dll',0     ; DATA XREF: .rdata:10030CF4o
		align 4
word_10032904	dw 394h			; DATA XREF: .rdata:10031040o
		db '_lock',0
word_1003290C	dw 504h			; DATA XREF: .rdata:10031044o
		db '_unlock',0
word_10032916	dw 22Eh			; DATA XREF: .rdata:1003100Co
		db '_calloc_crt',0
word_10032924	dw 1AEh			; DATA XREF: .rdata:10030FDCo
		db '__dllonexit',0
word_10032932	dw 43Ah			; DATA XREF: .rdata:10030FD8o
		db '_onexit',0
word_1003293C	dw 27Ah			; DATA XREF: .rdata:10030FD4o
		db '_except_handler4_common',0
word_10032956	dw 16Fh			; DATA XREF: .rdata:10030FD0o
		db '__CppXcptFilter',0
word_10032968	dw 217h			; DATA XREF: .rdata:10030FCCo
		db '_amsg_exit',0
		align 2
word_10032976	dw 3A5h			; DATA XREF: .rdata:10030FC8o
		db '_malloc_crt',0
word_10032984	dw 30Ch			; DATA XREF: .rdata:10030FC4o
		db '_initterm',0
word_10032990	dw 30Dh			; DATA XREF: .rdata:10030FC0o
		db '_initterm_e',0
word_1003299E	dw 250h			; DATA XREF: .rdata:10030FBCo
		db '_crt_debugger_hook',0
		align 4
word_100329B4	dw 1ACh			; DATA XREF: .rdata:10031048o
		db '__crtUnhandledException',0
word_100329CE	dw 1ABh			; DATA XREF: .rdata:10030FE4o
		db '__crtTerminateProcess',0
word_100329E6	dw 18Ch			; DATA XREF: .rdata:10030FE0o
		db '__clean_type_info_names_internal',0
		align 2
word_10032A0A	dw 121h			; DATA XREF: .rdata:10030E5Co
		db 'EncodePointer',0
word_10032A1A	dw 0FEh			; DATA XREF: .rdata:10030E58o
		db 'DecodePointer',0
word_10032A2A	dw 36Dh			; DATA XREF: .rdata:10030EB0o
		db 'IsProcessorFeaturePresent',0
word_10032A46	dw 113h			; DATA XREF: .rdata:10030E6Co
		db 'DisableThreadLibraryCalls',0
		align 800h
_rdata		ends

; Section 3. (virtual address 00033000)
; Virtual size			: 00001164 (   4452.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00031A00
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 10033000h
off_10033000	dd offset off_1001C3F4	; DATA XREF: sub_100018B6+17o
					; sub_1001B8C6w
off_10033004	dd offset off_1001C424	; DATA XREF: sub_1001B8D1w
off_10033008	dd offset off_1001C460	; DATA XREF: sub_100018B6:loc_100018D6o
					; sub_1001B8DCw
		dd offset dword_100330E0
off_10033010	dd offset timeGetTime	; DATA XREF: sub_10005BE9+Er
off_10033014	dd offset sub_100058DA	; DATA XREF: sub_100058DA+5o
byte_10033018	db 1			; DATA XREF: sub_100061AAr
					; sub_100062C9+Dr ...
		align 4
		dd offset aProcess	; "Process"
		dd offset aThread	; "Thread"
		dd offset aFile		; "File"
		dd offset aDirectory	; "Directory"
		dd offset aKey		; "Key"
		dd offset aWindowstation ; "WindowStation"
		dd offset aDesktop	; "Desktop"
		dd offset aService	; "Service"
		dd offset aMutex	; "Mutex"
		dd offset aSemaphore	; "Semaphore"
		dd offset aEvent	; "Event"
		dd offset aTimer	; "Timer"
		dd offset aNamedpipe	; "NamedPipe"
		dd offset aJobobject	; "JobObject"
		dd offset aFilemap	; "FileMap"
		dd offset aAlpcPort	; "ALPC	Port"
; Exported entry  46. g_shared_delayed_integrity_level
		public g_shared_delayed_integrity_level
g_shared_delayed_integrity_level dd 7	; DATA XREF: sub_1001664B+76o
					; sub_1001664B+80w ...
___security_cookie dd 0BB40E64Eh	; DATA XREF: sub_10002039+6r
					; sub_100029B6+6r ...
dword_10033064	dd 44BF19B1h		; DATA XREF: ___report_gsfailure+E3r
					; sub_1001B791+29w ...
		align 10h
dword_10033070	dd 1			; DATA XREF: sub_1001B4C2+11w
					; sub_1001B4C2+33r ...
dword_10033074	dd 0FFFFFFFFh		; DATA XREF: ___DllMainCRTStartup+1Cw
					; ___DllMainCRTStartup:$LN20w
; Exported entry  14. ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A
		public ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A
; private: static class	sandbox::BrokerServices	* mozilla::SandboxBroker::sBrokerService
?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A dd	0
					; DATA XREF: mozilla::SandboxBroker::SandboxBroker(void)+9r
					; mozilla::SandboxBroker::SandboxBroker(void)+1Aw ...
		dd 3 dup(0)
dword_10033088	dd 0			; DATA XREF: sub_100020FEr
		align 10h
dword_10033090	dd 0			; DATA XREF: sub_10002B72r
					; sub_10002B92+10r ...
		align 8
; LPCRITICAL_SECTION lpCriticalSection
lpCriticalSection dd 0			; DATA XREF: sub_10002EB4+9r
					; sub_10002EB4+1Ar
		dd 3 dup(0)
dword_100330A8	dd 0			; DATA XREF: sub_100033A2+9r
					; sub_100033A2:loc_100033EDw
		dd 0Dh dup(0)
dword_100330E0	dd 48h dup(0)		; DATA XREF: .data:1003300Co
		dd 244h	dup(?)
		db 3 dup(?)
byte_10033B13	db ?			; DATA XREF: sub_100054CC+2Co
					; sub_10005522+34o ...
dword_10033B14	dd ?			; DATA XREF: sub_10005405+6Dw
					; sub_10005405:loc_10005479w ...
dword_10033B18	dd ?			; DATA XREF: sub_10005861r
					; sub_10005861:loc_10005871o ...
		dd 12h dup(?)
dword_10033B64	dd ?			; DATA XREF: sub_10005BE9+22r
					; sub_10005BE9+3Ew
dword_10033B68	dd ?			; DATA XREF: sub_10005BE9+14r
					; sub_10005BE9+2Dw
dword_10033B6C	dd ?			; DATA XREF: sub_10005BE9+1Cr
					; sub_10005BE9+36w
dword_10033B70	dd 7 dup(?)		; DATA XREF: sub_10005A93o
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_10001024o
					; sub_10005BE9+2o ...
		align 10h
dword_10033BB0	dd 7 dup(?)		; DATA XREF: sub_100061AA+Eo
					; sub_100062C9+22o ...
dword_10033BCC	dd 9 dup(?)		; DATA XREF: sub_100062C9+5Co
					; sub_10006399+30o ...
byte_10033BF0	db ?			; DATA XREF: sub_100061AA+21w
					; sub_100061AA+32w
		align 4
		dd 2 dup(?)
dword_10033BFC	dd ?			; DATA XREF: sub_10006B5D:loc_10006B82r
					; sub_10006B5D+64w ...
dword_10033C00	dd ?			; DATA XREF: sub_10006B5D+30r
					; sub_10006B5D+71w ...
dword_10033C04	dd ?			; DATA XREF: sub_10006B5D+39r
					; sub_10006B5D+78w ...
		dd ?
dword_10033C0C	dd ?			; DATA XREF: sub_10006EA9r
					; sub_10006EA9+25o ...
		dd ?
dword_10033C14	dd ?			; DATA XREF: sub_100073A6+11r
					; sub_100073A6+5Aw
		dd ?
dword_10033C1C	dd ?			; DATA XREF: sub_100084A7:loc_100084CDr
					; sub_100084A7+3Aw
dword_10033C20	dd ?			; DATA XREF: sub_10008522:loc_10008548r
					; sub_10008522+3Aw
dword_10033C24	dd ?			; DATA XREF: sub_1000858C+37r
					; sub_1000858C+54w ...
dword_10033C28	dd ?			; DATA XREF: sub_1000858C+40r
					; sub_1000858C+6Dw ...
		db 3 dup(?)
byte_10033C2F	db ?			; DATA XREF: sub_100090C8+2Co
byte_10033C30	db ?			; DATA XREF: sub_100095AD+46Fr
		align 4
dword_10033C34	dd ?			; DATA XREF: sub_100095AD+70w
dword_10033C38	dd ?			; DATA XREF: sub_100095AD+59r
					; sub_100095AD+65w
		dd 3 dup(?)
		db 2 dup(?)
byte_10033C4A	db ?			; DATA XREF: sub_1000CE06+109r
					; sub_1000CE06+145r ...
		align 4
dword_10033C4C	dd ?			; DATA XREF: sub_1000D022+10r
					; sub_1000D022+18o ...
; Exported entry  41. g_handles_to_close
		public g_handles_to_close
; LPVOID g_handles_to_close
g_handles_to_close dd ?			; DATA XREF: sub_1000D0F8+7Eo
					; sub_1000D0F8+88w ...
		db 3 dup(?)
byte_10033C57	db ?			; DATA XREF: sub_1000E03C+34o
byte_10033C58	db ?			; DATA XREF: sub_1000E258+D5r
		align 4
dword_10033C5C	dd ?			; DATA XREF: sub_1000E42B+Cr
					; sub_1000E42B+16o ...
		dd ?
dword_10033C64	dd ?			; DATA XREF: sub_1000E615+14r
					; sub_1000E615+33o ...
		align 10h
dword_10033C70	dd ?			; DATA XREF: sub_1000EAA8r
					; sub_1000EAA8+1Cw ...
		align 8
; Exported entry  44. g_originals
		public g_originals
g_originals	dd ?			; DATA XREF: sub_1000F01E+28Fw
					; sub_1000F322+114o ...
		dd 18h dup(?)
		db 2 dup(?)
byte_10033CDE	db ?			; DATA XREF: sub_1000EDF7+5Er
		align 10h
; Exported entry  42. g_interceptions
		public g_interceptions
g_interceptions	dd ?			; DATA XREF: sub_1000EF28+5Ao
					; sub_1000EF28+5Fw ...
dword_10033CE4	dd ?			; DATA XREF: sub_1000F8EF+1r
					; sub_1000F8EF+2Fw ...
dword_10033CE8	dd ?			; DATA XREF: sub_1000F949+3r
					; sub_1000F949+24w ...
dword_10033CEC	dd ?			; DATA XREF: sub_1000F949:loc_1000F97Ar
					; sub_1000F949+4Fw ...
dword_10033CF0	dd ?			; DATA XREF: sub_1000F949:loc_1000F9A5r
					; sub_1000F949:loc_1000F9C8w
		dd 5 dup(?)
		db ?
byte_10033D09	db 3 dup(?)		; DATA XREF: sub_1001111E+2Co
		dd 7 dup(?)
byte_10033D28	db ?			; DATA XREF: sub_10015868:loc_10015874w
					; sub_10015880:loc_1001588Cw
		align 10h
; Exported entry  49. g_shared_section
		public g_shared_section
g_shared_section dd ?			; DATA XREF: sub_10015868r
					; sub_10015880r ...
		align 8
; Exported entry  43. g_nt
		public g_nt
g_nt		dd ?			; DATA XREF: sub_100103AB+49w
					; sub_100103AB+269o ...
dword_10033D3C	dd ?			; DATA XREF: sub_100103AB+63w
					; sub_10015E89+53r
dword_10033D40	dd ?			; DATA XREF: sub_100103AB+7Dw
					; sub_10015E89+30r
dword_10033D44	dd ?			; DATA XREF: sub_100103AB+97w
					; sub_100158E4+3Cr
dword_10033D48	dd ?			; DATA XREF: sub_100103AB+B1w
					; sub_10015EFD+2Dr
dword_10033D4C	dd ?			; DATA XREF: sub_1000FA0E+B7r
					; sub_100103AB+CBw ...
dword_10033D50	dd ?			; DATA XREF: sub_100103AB+E5w
					; sub_10015D69+15r
dword_10033D54	dd ?			; DATA XREF: sub_100103AB+FFw
dword_10033D58	dd ?			; DATA XREF: sub_100103AB+119w
					; sub_10015E89+48r
dword_10033D5C	dd ?			; DATA XREF: sub_100103AB+133w
					; sub_10015C5B+36r
dword_10033D60	dd ?			; DATA XREF: sub_100103AB+14Dw
					; sub_10015EFD+52r ...
dword_10033D64	dd ?			; DATA XREF: sub_100103AB+167w
					; sub_100158A4+1Er ...
dword_10033D68	dd ?			; DATA XREF: sub_100103AB+181w
					; sub_10015AA2+63r
dword_10033D6C	dd ?			; DATA XREF: sub_1000F88F+31r
					; sub_1000F88F+4Er ...
dword_10033D70	dd ?			; DATA XREF: sub_100103AB+1B5w
					; sub_10015D9C+12r
dword_10033D74	dd ?			; DATA XREF: sub_100103AB+1CFw
dword_10033D78	dd ?			; DATA XREF: sub_100103AB+1E9w
					; sub_10015D9C+35r
dword_10033D7C	dd ?			; DATA XREF: sub_100103AB+203w
					; sub_100158E4+15r
dword_10033D80	dd ?			; DATA XREF: sub_100103AB+219w
dword_10033D84	dd ?			; DATA XREF: sub_1000FB1A+54r
					; sub_100103AB+22Fw ...
dword_10033D88	dd ?			; DATA XREF: sub_1000F88F+Dr
					; sub_100103AB+245w ...
dword_10033D8C	dd ?			; DATA XREF: sub_100103AB+25Bw
					; sub_10015B5F+1Ar
dword_10033D90	dd ?			; DATA XREF: sub_100158A4+18r
					; sub_100158E4+Fr ...
; Exported entry  45. g_shared_IPC_size
		public g_shared_IPC_size
g_shared_IPC_size dd ?			; DATA XREF: sub_10015EFD+5Dr
					; sub_10019774+C7o ...
; Exported entry  48. g_shared_policy_size
		public g_shared_policy_size
g_shared_policy_size dd	?		; DATA XREF: sub_100119BE+30r
					; sub_10019774+ECo ...
dword_10033D9C	dd ?			; DATA XREF: sub_100119BE+Fr
					; sub_100119BE+1Er ...
dword_10033DA0	dd ?			; DATA XREF: sub_10015CC7:loc_10015CD3r
					; sub_10015EFD+7r ...
		align 8
dword_10033DA8	dd ?			; DATA XREF: sub_10015DE3:loc_10015DF1r
					; sub_10015DE3+17o ...
; HDESK	handle
handle		dd ?			; DATA XREF: sub_10016761+27r
					; sub_10016761:loc_10016798r ...
; HWINSTA hWinSta
hWinSta		dd ?			; DATA XREF: sub_10016761+1Fr
					; sub_10016761:loc_100167A4o ...
dword_10033DB4	dd ?			; DATA XREF: sub_10016AB5+39r
					; sub_10016AB5+70w
		align 10h
dword_10033DC0	dd ?			; DATA XREF: sub_1001700A+8r
					; sub_1001700A+28w
		align 8
; HANDLE hSourceHandle
hSourceHandle	dd ?			; DATA XREF: sub_10017726+3Dr
					; sub_10017726+51o ...
		dd 3 dup(?)
dword_10033DD8	dd ?			; DATA XREF: sub_10018F87+16r
					; sub_10018F87+DFo ...
		align 10h
dword_10033DE0	dd ?			; DATA XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+2Fr
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+4Dw ...
		align 8
; Exported entry  47. g_shared_delayed_mitigations
		public g_shared_delayed_mitigations
g_shared_delayed_mitigations dd	?	; DATA XREF: sub_1001664B+ABw
					; sub_1001664B+C8o ...
dword_10033DEC	dd ?			; DATA XREF: sub_1001664B+B0w
					; sub_1001664B+E0w ...
		dd ?
dword_10033DF4	dd ?			; DATA XREF: sub_10015880+41F0w
					; sub_10015880:loc_10019A86o
dword_10033DF8	dd ?			; DATA XREF: sub_10015880+41FAw
dword_10033DFC	dd ?			; DATA XREF: sub_10015880:loc_10019A64r
					; sub_10015880+4201w
		dd 2 dup(?)
; HMODULE hModule
hModule		dd ?			; DATA XREF: sub_1001A242+5r
					; sub_1001A242:loc_1001A275o ...
		align 10h
; void *dword_10033E10
dword_10033E10	dd ?			; DATA XREF: std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)+7w
					; std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void):loc_1001AB1Er ...
; std::_Fac_tidy_reg_t dword_10033E14
dword_10033E14	dd ?			; DATA XREF: sub_1001B8F1o
dword_10033E18	dd ?			; DATA XREF: sub_1001B02A+12r
					; sub_1001B02A+25w ...
		align 10h
dword_10033E20	dd ?			; DATA XREF: ___report_gsfailure+9Fw
					; .rdata:off_1002FF70o
dword_10033E24	dd ?			; DATA XREF: ___report_gsfailure+A9w
		dd ?
dword_10033E2C	dd ?			; DATA XREF: ___report_gsfailure+9Aw
dword_10033E30	dd ?			; DATA XREF: ___report_gsfailure+B3w
dword_10033E34	dd ?			; DATA XREF: ___report_gsfailure+C3w
		dd 0Eh dup(?)
dword_10033E70	dd ?			; DATA XREF: ___report_gsfailure+8Bw
					; .rdata:1002FF74o
		dd 22h dup(?)
word_10033EFC	dw ?			; DATA XREF: ___report_gsfailure+5Fw
		align 10h
word_10033F00	dw ?			; DATA XREF: ___report_gsfailure+58w
		align 4
word_10033F04	dw ?			; DATA XREF: ___report_gsfailure+51w
		align 4
word_10033F08	dw ?			; DATA XREF: ___report_gsfailure+4Aw
		align 4
dword_10033F0C	dd ?			; DATA XREF: ___report_gsfailure+36w
dword_10033F10	dd ?			; DATA XREF: ___report_gsfailure+30w
dword_10033F14	dd ?			; DATA XREF: ___report_gsfailure+2Aw
dword_10033F18	dd ?			; DATA XREF: ___report_gsfailure+24w
dword_10033F1C	dd ?			; DATA XREF: ___report_gsfailure+1Ew
dword_10033F20	dd ?			; DATA XREF: ___report_gsfailure:loc_1001B3E0w
dword_10033F24	dd ?			; DATA XREF: ___report_gsfailure+70w
dword_10033F28	dd ?			; DATA XREF: ___report_gsfailure+78w
					; ___report_gsfailure+95r
word_10033F2C	dw ?			; DATA XREF: ___report_gsfailure+43w
		align 10h
dword_10033F30	dd ?			; DATA XREF: ___report_gsfailure+67w
dword_10033F34	dd ?			; DATA XREF: ___report_gsfailure+80w
word_10033F38	dw ?			; DATA XREF: ___report_gsfailure+3Cw
		align 4
		dd 80h dup(?)
dword_1003413C	dd ?			; DATA XREF: ___raise_securityfailure+Bw
					; ___raise_securityfailure+1Dr
dword_10034140	dd ?			; DATA XREF: .text:__ftol2_sser
					; .text:__ftol2_sse_excptr ...
dword_10034144	dd ?			; DATA XREF: sub_1001B4C2:loc_1001B589r
					; sub_1001B4C2+D0w ...
dword_10034148	dd 2 dup(?)		; DATA XREF: sub_1001B89Co
dword_10034150	dd ?			; DATA XREF: sub_1001B02A+20o
					; sub_1001B02A+112o ...
dword_10034154	dd ?			; DATA XREF: sub_1001B02A:loc_1001B07Dr
					; sub_1001B02A:loc_1001B146w ...
dword_10034158	dd ?			; DATA XREF: sub_1001B02A:loc_1001B1EAr
					; sub_1001B02A+1C9o ...
; PVOID	dword_1003415C
dword_1003415C	dd ?			; DATA XREF: ___atonexitinit+27w
					; sub_1001ABD6+49r ...
; PVOID	Ptr
Ptr		dd ?			; DATA XREF: ___atonexitinitr
					; ___atonexitinit+22w ...
		align 1000h
_data		ends


		end DllEntryPoint
