;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	9B52C889068E934B6A0F9159DFD2C6FB
; Input	CRC32 :	21B7041D

; File Name   :	C:\compspace\compare\pidgin\dlls\original\libsilcclient-1-1-3.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	62B80000
; Section 1. (virtual address 00001000)
; Virtual size			: 00025C00 ( 154624.)
; Section size in file		: 00025C00 ( 154624.)
; Offset to raw	data for section: 00000600
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		.686p
		.mmx
		.model flat
.intel_syntax noprefix

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 62B81000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; _onexit_t __cdecl _onexit(_onexit_t)
		public __onexit
__onexit	proc near

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+8], offset _next_atexit
		mov	dword ptr [esp+4], offset __bss_start__
		mov	[esp], eax
		call	___dllonexit
		leave
		retn
__onexit	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl atexit(void (__cdecl *)())
		public _atexit
_atexit		proc near		; CODE XREF: ___do_global_ctors+31p
					; _register_frame_ctor+12p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+8], offset _next_atexit
		mov	dword ptr [esp+4], offset __bss_start__
		mov	[esp], eax
		call	___dllonexit
		leave
		cmp	eax, 1
		sbb	eax, eax
		retn
_atexit		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

___dll_exit	proc near		; CODE XREF: _DllMainCRTStartup@12+41p
					; _DllMainCRTStartup@12+9Dp
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	edx, ds:__bss_start__
		test	edx, edx
		jz	short loc_62B810A5
		mov	ebx, ds:_next_atexit

loc_62B81077:				; CODE XREF: ___dll_exit+22j
		sub	ebx, 4
		cmp	edx, ebx
		ja	short loc_62B81093

loc_62B8107E:				; CODE XREF: ___dll_exit+31j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_62B81077
		call	eax
		mov	edx, ds:__bss_start__
		sub	ebx, 4
		cmp	edx, ebx
		jbe	short loc_62B8107E

loc_62B81093:				; CODE XREF: ___dll_exit+1Cj
		mov	[esp], edx	; void *
		call	_free
		mov	ds:__bss_start__, 0

loc_62B810A5:				; CODE XREF: ___dll_exit+Fj
		mov	dword ptr [esp], 0 ; FILE *
		call	_fflush
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
___dll_exit	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DllMainCRTStartup(HINSTANCE hinstDLL, DWORD fdwReason,	LPVOID lpReserved)
		public _DllMainCRTStartup@12
_DllMainCRTStartup@12 proc near

var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
hinstDLL	= dword	ptr  8
fdwReason	= dword	ptr  0Ch
lpReserved	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], ebx
		mov	ebx, [ebp+fdwReason]
		mov	[ebp+var_8], esi
		mov	esi, [ebp+hinstDLL]
		mov	[ebp+var_4], edi
		mov	edi, [ebp+lpReserved]
		cmp	ebx, 1
		jz	short loc_62B81118
		mov	[esp+8], edi	; lpvReserved
		mov	[esp+4], ebx	; fdwReason
		mov	[esp], esi	; hinstDLL
		call	_DllMain@12
		sub	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_62B81109
		mov	edx, ds:__bss_start__
		test	edx, edx
		jz	short loc_62B81166
		mov	[ebp+var_1C], eax
		call	___dll_exit
		mov	eax, [ebp+var_1C]

loc_62B81109:				; CODE XREF: _DllMainCRTStartup@12+32j
					; _DllMainCRTStartup@12+9Bj ...
		mov	ebx, [ebp+var_C]
		mov	esi, [ebp+var_8]
		mov	edi, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn	0Ch
; ---------------------------------------------------------------------------

loc_62B81118:				; CODE XREF: _DllMainCRTStartup@12+1Bj
		mov	dword ptr [esp], 80h ; size_t
		call	_malloc
		test	eax, eax
		mov	ds:__bss_start__, eax
		jz	short loc_62B81170
		mov	dword ptr [eax], 0
		mov	ds:_next_atexit, eax
		call	__pei386_runtime_relocator
		call	___main
		mov	[esp+8], edi	; lpvReserved
		mov	dword ptr [esp+4], 1 ; fdwReason
		mov	[esp], esi	; hinstDLL
		call	_DllMain@12
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_62B81109
		call	___dll_exit
		xor	eax, eax
		jmp	short loc_62B81109
; ---------------------------------------------------------------------------

loc_62B81166:				; CODE XREF: _DllMainCRTStartup@12+3Cj
		xor	eax, eax
		jmp	short loc_62B81109
; ---------------------------------------------------------------------------
		align 10h

loc_62B81170:				; CODE XREF: _DllMainCRTStartup@12+6Bj
		call	__errno
		mov	dword ptr [eax], 0Ch
		xor	eax, eax
		jmp	short loc_62B81109
_DllMainCRTStartup@12 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public ___gcc_register_frame
___gcc_register_frame proc near		; CODE XREF: _register_frame_ctor+6p
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], offset	ModuleName ; "libgcc_s_dw2-1.dll"
		call	_GetModuleHandleA@4
		push	edx
		test	eax, eax
		jz	short loc_62B811FC
		mov	dword ptr [esp+4], offset ProcName ; "__register_frame_info"
		mov	[esp], eax	; hModule
		call	_GetProcAddress@8
		sub	esp, 8

loc_62B811AA:				; CODE XREF: ___gcc_register_frame+81j
		test	eax, eax
		jz	short loc_62B811BF
		mov	dword ptr [esp+4], offset _obj
		mov	dword ptr [esp], offset	___FRAME_END__
		call	eax

loc_62B811BF:				; CODE XREF: ___gcc_register_frame+2Cj
		mov	ecx, ___JCR_END__
		test	ecx, ecx
		jz	short locret_62B811FA
		mov	dword ptr [esp], offset	aLibgcj_s_dll ;	"libgcj_s.dll"
		call	_GetModuleHandleA@4
		push	edx
		test	eax, eax
		jz	short loc_62B81204
		mov	dword ptr [esp+4], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp], eax	; hModule
		call	_GetProcAddress@8
		sub	esp, 8

loc_62B811ED:				; CODE XREF: ___gcc_register_frame+89j
		test	eax, eax
		jz	short locret_62B811FA
		mov	dword ptr [esp], offset	___JCR_END__
		call	eax

locret_62B811FA:			; CODE XREF: ___gcc_register_frame+47j
					; ___gcc_register_frame+6Fj
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B811FC:				; CODE XREF: ___gcc_register_frame+15j
		mov	eax, 0
		jmp	short loc_62B811AA
; ---------------------------------------------------------------------------
		align 4

loc_62B81204:				; CODE XREF: ___gcc_register_frame+58j
		mov	eax, 0
		jmp	short loc_62B811ED
___gcc_register_frame endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl __gcc_deregister_frame()
		public ___gcc_deregister_frame
___gcc_deregister_frame	proc near	; DATA XREF: _register_frame_ctor+Bo
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], offset	ModuleName ; "libgcc_s_dw2-1.dll"
		call	_GetModuleHandleA@4
		push	ecx
		test	eax, eax
		jz	short loc_62B81248
		mov	dword ptr [esp+4], offset a__deregister_f ; "__deregister_frame_info"
		mov	[esp], eax	; hModule
		call	_GetProcAddress@8
		sub	esp, 8

loc_62B81236:				; CODE XREF: ___gcc_deregister_frame+41j
		test	eax, eax
		jz	short locret_62B81243
		mov	dword ptr [esp], offset	___FRAME_END__
		call	eax

locret_62B81243:			; CODE XREF: ___gcc_deregister_frame+2Cj
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_62B81248:				; CODE XREF: ___gcc_deregister_frame+15j
		mov	eax, 0
		jmp	short loc_62B81236
___gcc_deregister_frame	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_packet_destructor(SilcFSMThread thread, void	*thread_context, void *destructor_context)
_silc_client_packet_destructor proc near ; DATA	XREF: _silc_client_packet_receive+9Fo
					; _silc_client_packet_receive+10Co

thread		= dword	ptr  8
thread_context	= dword	ptr  0Ch
destructor_context= dword ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		mov	edx, [ebp+thread]
		mov	ecx, [ebp+thread_context]
		mov	eax, [ecx+54h]
		mov	ebx, [eax+0C4h]
		test	ebx, ebx
		jz	short loc_62B812D4
thread_0 = edx				; SilcFSMThread
thread_context_0 = ecx			; void *
		movzx	ebx, word ptr [eax+0D0h]
		mov	esi, [eax+0C8h]
		mov	[esi+ebx], thread_0

loc_62B81278:				; CODE XREF: _silc_client_packet_destructor+8Aj
		test	byte ptr [eax+0D4h], 1
		jz	short loc_62B81291
		movzx	ebx, word ptr [eax+0D2h]
		mov	esi, [eax+0C8h]
		mov	[thread_0+ebx],	esi

loc_62B81291:				; CODE XREF: _silc_client_packet_destructor+2Fj
		mov	[eax+0C8h], thread_0
		movzx	ebx, word ptr [eax+0D0h]
		mov	dword ptr [thread_0+ebx], 0
		add	dword ptr [eax+0D4h], 4
		mov	thread_0, [thread_context_0+54h]
		mov	eax, [edx+0D4h]
		and	eax, 0FFFFFFFCh
		cmp	eax, 4
		jnz	short loc_62B812D0
		mov	eax, [edx+0C4h]
		mov	[edx+0CCh], eax
		and	byte ptr [edx+0D4h], 0FDh

loc_62B812D0:				; CODE XREF: _silc_client_packet_destructor+6Bj
		pop	ebx
		pop	esi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B812D4:				; CODE XREF: _silc_client_packet_destructor+16j
thread_0 = edx				; SilcFSMThread
		mov	[eax+0C4h], thread_0
		jmp	short loc_62B81278
_silc_client_packet_destructor endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_packet_error(SilcPacketEngine engine, SilcPacketStream stream, SilcPacketError error, void *callback_context, void *stream_context)
_silc_client_packet_error proc near	; DATA XREF: .data:__data_start__o

engine		= dword	ptr  8
stream		= dword	ptr  0Ch
error		= dword	ptr  10h
callback_context= dword	ptr  14h
stream_context	= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		leave
		retn
_silc_client_packet_error endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 223. silc_client_stop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_stop(SilcClient client, SilcClientStopped stopped, void *context)
		public _silc_client_stop
_silc_client_stop proc near

client		= dword	ptr  8
stopped		= dword	ptr  0Ch
context		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	ebx, [ebp+client]
		mov	edi, [ebp+stopped]
		mov	esi, [ebp+context]
		mov	eax, [ebx+18h]
		mov	[esp], eax
		call	_silc_fsm_is_started
		test	al, al
		jz	short loc_62B8132C
client_0 = ebx				; SilcClient
stopped_0 = edi				; SilcClientStopped
context_0 = esi				; void *
		mov	eax, [client_0+18h]
		mov	[eax+74h], stopped_0
		mov	[eax+78h], context_0
		or	byte ptr [eax+82h], 1
		mov	eax, [client_0+18h]
		add	eax, 2Ch
		mov	[ebp+client], eax
		add	esp, 1Ch
		pop	client_0
		pop	context_0
		pop	stopped_0
		leave
		jmp	_silc_fsm_event_signal
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
stopped_0 = edi				; SilcClientStopped
context_0 = esi				; void *
		align 4

loc_62B8132C:				; CODE XREF: _silc_client_stop+1Fj
		mov	dword ptr [esp], offset	aAttemptingToSt	; "Attempting to stop client library befor"...
		call	_silc_format
		mov	[ebp+stopped], eax
		mov	[ebp+client], 2
		add	esp, 1Ch
		pop	client_0
		pop	context_0
		pop	stopped_0
		leave
		jmp	_silc_log_output
_silc_client_stop endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_packet_eos(SilcPacketEngine engine, SilcPacketStream	stream,	void *callback_context,	void *stream_context)
_silc_client_packet_eos	proc near	; DATA XREF: .data:__data_start__o

engine		= dword	ptr  8
stream		= dword	ptr  0Ch
callback_context= dword	ptr  10h
stream_context	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+stream_context]
		mov	eax, [eax+54h]
		mov	dword ptr [eax+128h], 2
		mov	dl, [eax+12Dh]
		test	dl, 2
		jz	short loc_62B81374
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_62B81374:				; CODE XREF: _silc_client_packet_eos+1Fj
		or	edx, 2
		mov	[eax+12Dh], dl
		add	eax, 98h
		mov	[ebp+engine], eax
		leave
		jmp	_silc_fsm_event_signal
_silc_client_packet_eos	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  21. silc_client_close_connection

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_close_connection(SilcClient client, SilcClientConnection conn)
		public _silc_client_close_connection
_silc_client_close_connection proc near	; CODE XREF: _silc_client_ftp_connect_completion+2DFp
					; _silc_client_file_close_final+1Ap ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+conn]
		mov	eax, [eax+54h]
		mov	dword ptr [eax+128h], 2
		mov	dl, [eax+12Dh]
		test	dl, 2
		jz	short loc_62B813B0
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_62B813B0:				; CODE XREF: _silc_client_close_connection+1Fj
		or	edx, 2
		mov	[eax+12Dh], dl
		add	eax, 98h
		mov	[ebp+client], eax
		leave
		jmp	_silc_fsm_event_signal
_silc_client_close_connection endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_connect_abort(SilcAsyncOperation op,	void *context)
_silc_client_connect_abort proc	near	; DATA XREF: _silc_client_add_connection+282o

op		= dword	ptr  8
context		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		mov	dword ptr [ebx+44h], 0
		mov	eax, [ebx+54h]
		mov	dword ptr [eax+100h], 0
		mov	dl, [eax+12Dh]
		test	dl, 2
		jz	short loc_62B813F8

loc_62B813F1:				; CODE XREF: _silc_client_connect_abort+46j
context_0 = ebx				; void *
		add	esp, 14h
		pop	context_0
		leave
		retn
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 4

loc_62B813F8:				; CODE XREF: _silc_client_connect_abort+27j
		or	edx, 2
		mov	[eax+12Dh], dl
		add	eax, 40h
		mov	[esp], eax
		call	_silc_fsm_is_started
		test	al, al
		jz	short loc_62B813F1
		mov	eax, [context_0+54h]
		add	eax, 98h
		mov	[ebp+op], eax
		add	esp, 14h
		pop	context_0
		leave
		jmp	_silc_fsm_event_signal
_silc_client_connect_abort endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 196. silc_client_run_one

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_run_one(SilcClient client)
		public _silc_client_run_one
_silc_client_run_one proc near

client		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+client]
		mov	eax, [ebx+18h]
		mov	[esp], eax
		call	_silc_fsm_is_started
		test	al, al
		jz	short loc_62B81454
client_0 = ebx				; SilcClient
		mov	dword ptr [esp+4], 0
		mov	eax, [client_0+0Ch]
		mov	[esp], eax
		call	_silc_schedule_one

loc_62B81454:				; CODE XREF: _silc_client_run_one+17j
		add	esp, 14h
		pop	client_0
		leave
		retn
_silc_client_run_one endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 195. silc_client_run

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_run(SilcClient client)
		public _silc_client_run
_silc_client_run proc near

client		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+client]
		mov	eax, [eax+0Ch]
		mov	[ebp+client], eax
		leave
		jmp	_silc_schedule
_silc_client_run endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_packet_receive(SilcPacketEngine engine, SilcPacketStream	stream,	SilcPacket packet, void	*callback_context, void	*stream_context)
_silc_client_packet_receive proc near	; DATA XREF: .data:__data_start__o

var_3C		= dword	ptr -3Ch
thread		= dword	ptr -1Ch
engine		= dword	ptr  8
stream		= dword	ptr  0Ch
packet		= dword	ptr  10h
callback_context= dword	ptr  14h
stream_context	= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	eax, [ebp+packet]
		cmp	byte ptr [eax+22h], 18h	; switch 25 cases
		ja	short loc_62B81494 ; jumptable 62B8148A	default	case
		movzx	eax, byte ptr [eax+22h]
		jmp	ds:off_62BA80C0[eax*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 4

loc_62B81494:				; CODE XREF: _silc_client_packet_receive+10j
					; _silc_client_packet_receive+16j
					; DATA XREF: ...
		mov	edx, [ebp+stream_context] ; jumptable 62B8148A default case
		mov	edi, [edx+54h]
		mov	ebx, [edi+0CCh]
		test	ebx, ebx
		jz	loc_62B81570
		test	byte ptr [edi+0D4h], 2
		jnz	loc_62B81560
		movzx	eax, word ptr [edi+0D0h]
		mov	eax, [ebx+eax]

loc_62B814BF:				; CODE XREF: _silc_client_packet_receive+F6j
		mov	[edi+0CCh], eax
		mov	[ebp+thread], ebx
		mov	edx, [edi+0C4h]
prev = edx				; void *
		test	prev, prev
		jz	short loc_62B814F7
		cmp	ebx, prev
		jz	loc_62B8160C
		movzx	esi, word ptr [edi+0D0h]
		jmp	short loc_62B814EE
; ---------------------------------------------------------------------------
p = ecx					; void **
prev = eax				; void *
		align 4

loc_62B814E4:				; CODE XREF: _silc_client_packet_receive+81j
		cmp	ebx, prev
		jz	loc_62B815B0
		mov	edx, prev

loc_62B814EE:				; CODE XREF: _silc_client_packet_receive+6Dj
prev = edx				; void *
		lea	p, [prev+esi]
		mov	eax, [p]
prev = eax				; void *
		test	prev, prev
		jnz	short loc_62B814E4

loc_62B814F7:				; CODE XREF: _silc_client_packet_receive+5Cj
					; _silc_client_packet_receive+169j
prev = edx				; void *
		cmp	[edi+0C8h], ebx
		jz	loc_62B815F4

loc_62B81503:				; CODE XREF: _silc_client_packet_receive+186j
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], offset _silc_client_packet_destructor
		mov	prev, [ebp+stream_context]
prev = eax				; void *
		mov	[esp+8], edx
		add	edi, 40h
		mov	[esp+4], edi
		mov	[esp], ebx
		call	_silc_fsm_thread_init

loc_62B81531:				; CODE XREF: _silc_client_packet_receive+12Bj
		mov	ecx, [ebp+packet]
		mov	[esp+4], ecx
		mov	esi, [ebp+thread]
		mov	[esp], esi
		call	_silc_fsm_set_state_context
		mov	dword ptr [esp+4], offset _silc_client_connection_st_packet
		mov	[esp], esi
		call	_silc_fsm_start_sync
		mov	al, 1
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_62B81560:				; CODE XREF: _silc_client_packet_receive+3Bj
		movzx	eax, word ptr [edi+0D2h]
		mov	eax, [ebx+eax]
		jmp	loc_62B814BF
; ---------------------------------------------------------------------------
		align 10h

loc_62B81570:				; CODE XREF: _silc_client_packet_receive+2Ej
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], offset _silc_client_packet_destructor
		mov	ecx, [ebp+stream_context]
		mov	[esp+4], ecx
		add	edi, 40h
		mov	[esp], edi
		call	_silc_fsm_thread_alloc
		mov	[ebp+thread], eax
		test	eax, eax
		jnz	short loc_62B81531
		lea	esi, [esi+0]

loc_62B815A4:				; CODE XREF: _silc_client_packet_receive+16j
					; DATA XREF: .rdata:off_62BA80C0o
		xor	eax, eax	; jumptable 62B8148A cases 2-4,13-15,17,23,24
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
p = ecx					; void **
prev = eax				; void *
		align 10h

loc_62B815B0:				; CODE XREF: _silc_client_packet_receive+72j
		mov	[ebp+var_3C], p

loc_62B815B3:				; CODE XREF: _silc_client_packet_receive+1AAj
		mov	prev, [ebx+esi]
prev = edx				; void *
		mov	p, [ebp+var_3C]
		mov	[ecx], eax
		test	eax, eax
		jz	short loc_62B815C8
		test	byte ptr [edi+0D4h], 1
		jnz	short loc_62B815E4

loc_62B815C8:				; CODE XREF: _silc_client_packet_receive+149j
					; _silc_client_packet_receive+17Dj
		cmp	[edi+0CCh], ebx
		jz	short loc_62B815FF

loc_62B815D0:				; CODE XREF: _silc_client_packet_receive+196j
		sub	dword ptr [edi+0D4h], 4
		mov	eax, [ebp+stream_context]
		mov	edi, [eax+54h]
		jmp	loc_62B814F7
; ---------------------------------------------------------------------------
		align 4

loc_62B815E4:				; CODE XREF: _silc_client_packet_receive+152j
		movzx	esi, word ptr [edi+0D2h]
		mov	ecx, [ebx+esi]
		mov	[eax+esi], ecx
		jmp	short loc_62B815C8
; ---------------------------------------------------------------------------
p = ecx					; void **
		align 4

loc_62B815F4:				; CODE XREF: _silc_client_packet_receive+89j
		mov	[edi+0C8h], prev
		jmp	loc_62B81503
; ---------------------------------------------------------------------------

loc_62B815FF:				; CODE XREF: _silc_client_packet_receive+15Aj
		mov	esi, [ebp+var_3C]
		mov	eax, [esi]
		mov	[edi+0CCh], eax
		jmp	short loc_62B815D0
; ---------------------------------------------------------------------------

loc_62B8160C:				; CODE XREF: _silc_client_packet_receive+60j
		lea	esi, [edi+0C4h]
		mov	[ebp+var_3C], esi
		movzx	esi, word ptr [edi+0D0h]
		xor	prev, prev
		jmp	short loc_62B815B3
_silc_client_packet_receive endp

; Exported entry 141. silc_client_init

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_init(SilcClient client, const char *username, const char	*hostname, const char *realname, SilcClientRunning running, void *context)
		public _silc_client_init
_silc_client_init proc near

client		= dword	ptr  8
username	= dword	ptr  0Ch
hostname	= dword	ptr  10h
realname	= dword	ptr  14h
running		= dword	ptr  18h
context		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [ebp+client]
		mov	esi, [ebp+username]
		test	ebx, ebx
		jz	loc_62B81898
client_0 = ebx				; SilcClient
username_0 = esi			; const	char *
		test	username_0, username_0
		jz	loc_62B818C4
		mov	edx, [ebp+hostname]
		test	edx, edx
		jz	loc_62B818C4
		mov	eax, [ebp+realname]
		test	eax, eax
		jz	loc_62B818EC

loc_62B81655:				; CODE XREF: _silc_client_init+2CFj
		mov	ecx, 0FFFFFFFFh
		mov	edi, username_0
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+0Ch], 80h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	[esp], esi
username_0 = esi			; const	char *
		call	_silc_identifier_verify
		test	al, al
		jz	loc_62B8186C
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+hostname]
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+0Ch], 100h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	eax, [ebp+hostname]
		mov	[esp], eax
		call	_silc_identifier_verify
		test	al, al
		jz	loc_62B818B4
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+realname]
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+4], ecx
		mov	eax, [ebp+realname]
		mov	[esp], eax
		call	_silc_utf8_valid
		test	al, al
		jz	loc_62B818A4
		mov	[esp], username_0 ; char *
		call	_strdup
		mov	[client_0], eax
		mov	eax, [ebp+hostname]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[client_0+4], eax
		mov	eax, [ebp+realname]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[client_0+8], eax
		mov	username_0, [client_0+18h]
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
		test	eax, eax
		jz	short loc_62B81757
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	edx, [eax+10h]
		and	edx, 3
		mov	[eax+10h], edx
		mov	word ptr [eax+0Ch], 4
		mov	word ptr [eax+0Eh], 8
		mov	byte ptr [eax+10h], 1
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax], 0

loc_62B81757:				; CODE XREF: _silc_client_init+FAj
		mov	[esi+6Ch], eax
		mov	eax, [client_0+18h]
		mov	edi, [eax+6Ch]
		test	edi, edi
		jz	loc_62B81898
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+24h], 0
		jz	loc_62B818F4

loc_62B81775:				; CODE XREF: _silc_client_init+2E8j
		call	_silc_rng_alloc
		mov	[client_0+10h],	eax
		test	eax, eax
		jz	loc_62B81898
		mov	[esp], eax
		call	_silc_rng_init
		mov	eax, [client_0+10h]
		mov	[esp], eax
		call	_silc_rng_global_init
		mov	[esp+4], client_0
		mov	dword ptr [esp], 0
		call	_silc_schedule_init
		mov	[client_0+0Ch],	eax
		test	eax, eax
		jz	loc_62B81898
		mov	eax, [client_0+18h]
		add	eax, 54h
		mov	[esp], eax
		call	_silc_mutex_alloc
		mov	[esp], client_0	; client
		call	_silc_client_commands_register
		mov	esi, [client_0+18h]
		mov	[esp+0Ch], client_0
		mov	dword ptr [esp+8], offset __data_start__
		mov	dword ptr [esp+4], 0
		mov	eax, [client_0+10h]
		mov	[esp], eax
		call	_silc_packet_engine_start
		mov	[esi+50h], eax
		mov	eax, [client_0+18h]
		mov	esi, [eax+50h]
		test	esi, esi
		jz	loc_62B81898
		mov	edx, [ebp+running]
		mov	[eax+74h], edx
		mov	edx, [ebp+context]
		mov	[eax+78h], edx
		mov	edx, [client_0+0Ch]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], client_0
		mov	[esp], eax
		call	_silc_fsm_init
		mov	eax, [client_0+18h]
		mov	[esp+4], eax
		add	eax, 2Ch
		mov	[esp], eax
		call	_silc_fsm_event_init
		mov	dword ptr [esp+4], offset _silc_client_st_run
		mov	eax, [client_0+18h]
		mov	[esp], eax
		call	_silc_fsm_start_sync
		mov	eax, [client_0+18h]
		or	byte ptr [eax+82h], 2
		mov	eax, [client_0+18h]
		add	eax, 2Ch
		mov	[esp], eax
		call	_silc_fsm_event_signal
		mov	al, 1
		jmp	short loc_62B81890
; ---------------------------------------------------------------------------

loc_62B8186C:				; CODE XREF: _silc_client_init+61j
username_0 = esi			; const	char *
		mov	eax, [client_0]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aMalformedUsern	; "Malformed username '%s'. Username must "...

loc_62B81879:				; CODE XREF: _silc_client_init+292j
					; _silc_client_init+2A2j
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		xor	eax, eax

loc_62B81890:				; CODE XREF: _silc_client_init+24Aj
		add	esp, 2Ch
		pop	client_0
		pop	username_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B81898:				; CODE XREF: _silc_client_init+11j
					; _silc_client_init+142j ...
client_0 = ebx				; SilcClient
username_0 = esi			; const	char *
		xor	eax, eax
		add	esp, 2Ch
		pop	client_0
		pop	username_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
username_0 = esi			; const	char *
		align 4

loc_62B818A4:				; CODE XREF: _silc_client_init+BDj
		mov	eax, [client_0+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aMalformedRealn	; "Malformed realname '%s'. Realname must "...
		jmp	short loc_62B81879
; ---------------------------------------------------------------------------

loc_62B818B4:				; CODE XREF: _silc_client_init+97j
		mov	eax, [client_0+4]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aMalformedHostn	; "Malformed hostname '%s'. Hostname must "...
		jmp	short loc_62B81879
; ---------------------------------------------------------------------------

loc_62B818C4:				; CODE XREF: _silc_client_init+19j
					; _silc_client_init+24j
		mov	dword ptr [esp], offset	aUsernameAndHos	; "Username and	hostname must be given to "...
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		xor	eax, eax
		add	esp, 2Ch
		pop	client_0
		pop	username_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
username_0 = esi			; const	char *
		align 4

loc_62B818EC:				; CODE XREF: _silc_client_init+2Fj
		mov	[ebp+realname],	username_0
		jmp	loc_62B81655
; ---------------------------------------------------------------------------

loc_62B818F4:				; CODE XREF: _silc_client_init+14Fj
		call	_silc_cipher_register_default
		call	_silc_pkcs_register_default
		call	_silc_hash_register_default
		call	_silc_hmac_register_default
		jmp	loc_62B81775
_silc_client_init endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 118. silc_client_free

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_free(SilcClient client)
		public _silc_client_free
_silc_client_free proc near

var_3C		= dword	ptr -3Ch
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+client]
		mov	[ebp+var_1C], eax
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_62B8192E
		mov	[esp], eax
		call	_silc_schedule_uninit

loc_62B8192E:				; CODE XREF: _silc_client_free+14j
		mov	ecx, [ebp+var_1C]
		mov	eax, [ecx+10h]
		test	eax, eax
		jz	short loc_62B81940
		mov	[esp], eax
		call	_silc_rng_free

loc_62B81940:				; CODE XREF: _silc_client_free+26j
		mov	esi, [ebp+var_1C]
		mov	eax, [esi+18h]
		mov	edx, [eax+4Ch]
		cmp	byte ptr [edx+24h], 0
		jz	loc_62B81AB2

loc_62B81953:				; CODE XREF: _silc_client_free+1B9j
		mov	edx, [eax+50h]
		test	edx, edx
		jz	short loc_62B81968
		mov	[esp], edx
		call	_silc_packet_engine_stop
		mov	edx, [ebp+var_1C]
		mov	eax, [edx+18h]

loc_62B81968:				; CODE XREF: _silc_client_free+48j
		mov	edi, [eax+6Ch]
		test	edi, edi
		jz	short loc_62B819DD
		mov	ebx, [edi]
		mov	[edi+8], ebx
		and	byte ptr [edi+10h], 0FDh
		test	ebx, ebx
		jz	short loc_62B819CF

loc_62B8197C:				; CODE XREF: _silc_client_free+BDj
		test	byte ptr [edi+10h], 2
		jz	loc_62B81A58
		movzx	eax, word ptr [edi+0Eh]
		mov	eax, [ebx+eax]

loc_62B8198D:				; CODE XREF: _silc_client_free+14Fj
		mov	[edi+8], eax
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_62B819B7
		cmp	ebx, eax
		jz	loc_62B81AA7
		movzx	esi, word ptr [edi+0Ch]
		jmp	short loc_62B819AE
; ---------------------------------------------------------------------------

loc_62B819A4:				; CODE XREF: _silc_client_free+A5j
		cmp	ebx, ecx
		jz	loc_62B81A64
		mov	eax, ecx

loc_62B819AE:				; CODE XREF: _silc_client_free+92j
		lea	edx, [eax+esi]
		mov	ecx, [edx]
		test	ecx, ecx
		jnz	short loc_62B819A4

loc_62B819B7:				; CODE XREF: _silc_client_free+84j
		cmp	ebx, [edi+4]
		jz	loc_62B81A95

loc_62B819C0:				; CODE XREF: _silc_client_free+17Fj
					; _silc_client_free+188j
		mov	[esp], ebx
		call	_silc_free
		mov	ebx, [edi+8]
		test	ebx, ebx
		jnz	short loc_62B8197C

loc_62B819CF:				; CODE XREF: _silc_client_free+6Aj
		mov	[esp], edi
		call	_silc_free
		mov	esi, [ebp+var_1C]
		mov	eax, [esi+18h]

loc_62B819DD:				; CODE XREF: _silc_client_free+5Dj
		mov	edx, [eax+54h]
		test	edx, edx
		jz	short loc_62B819F2
		mov	[esp], edx
		call	_silc_mutex_free
		mov	edx, [ebp+var_1C]
		mov	eax, [edx+18h]

loc_62B819F2:				; CODE XREF: _silc_client_free+D2j
		mov	dword ptr [eax+7Ch], 0
		mov	ecx, [ebp+var_1C]
		mov	eax, [ecx]
		mov	[esp], eax
		call	_silc_free
		mov	esi, [ebp+var_1C]
		mov	eax, [esi+4]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [esi+8]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [esi+18h]
		mov	eax, [eax+4Ch]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [esi+18h]
		mov	eax, [eax+70h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [esi+18h]
		mov	[esp], eax
		call	_silc_free
		mov	[ebp+client], esi
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		jmp	_silc_free
; ---------------------------------------------------------------------------
		align 4

loc_62B81A58:				; CODE XREF: _silc_client_free+70j
		movzx	eax, word ptr [edi+0Ch]
		mov	eax, [ebx+eax]
		jmp	loc_62B8198D
; ---------------------------------------------------------------------------

loc_62B81A64:				; CODE XREF: _silc_client_free+96j
		mov	[ebp+var_3C], edx

loc_62B81A67:				; CODE XREF: _silc_client_free+1A0j
		mov	ecx, [ebx+esi]
		mov	esi, [ebp+var_3C]
		mov	[esi], ecx
		test	ecx, ecx
		jz	short loc_62B81A83
		test	byte ptr [edi+10h], 1
		jz	short loc_62B81A83
		movzx	edx, word ptr [edi+0Eh]
		mov	esi, [ebx+edx]
		mov	[ecx+edx], esi

loc_62B81A83:				; CODE XREF: _silc_client_free+161j
					; _silc_client_free+167j
		cmp	ebx, [edi+8]
		jz	short loc_62B81A9D

loc_62B81A88:				; CODE XREF: _silc_client_free+195j
		sub	dword ptr [edi+10h], 4
		cmp	ebx, [edi+4]
		jnz	loc_62B819C0

loc_62B81A95:				; CODE XREF: _silc_client_free+AAj
		mov	[edi+4], eax
		jmp	loc_62B819C0
; ---------------------------------------------------------------------------

loc_62B81A9D:				; CODE XREF: _silc_client_free+176j
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx]
		mov	[edi+8], edx
		jmp	short loc_62B81A88
; ---------------------------------------------------------------------------

loc_62B81AA7:				; CODE XREF: _silc_client_free+88j
		movzx	esi, word ptr [edi+0Ch]
		mov	[ebp+var_3C], edi
		xor	eax, eax
		jmp	short loc_62B81A67
; ---------------------------------------------------------------------------

loc_62B81AB2:				; CODE XREF: _silc_client_free+3Dj
		call	_silc_cipher_unregister_all
		call	_silc_pkcs_unregister_all
		call	_silc_hash_unregister_all
		call	_silc_hmac_unregister_all
		mov	eax, [esi+18h]
		jmp	loc_62B81953
_silc_client_free endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  10. silc_client_alloc

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClient __cdecl silc_client_alloc(SilcClientOperations *ops, SilcClientParams *params, void *application, const char *version_string)
		public _silc_client_alloc
_silc_client_alloc proc	near

ops		= dword	ptr  8
params		= dword	ptr  0Ch
application	= dword	ptr  10h
version_string	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	esi, [ebp+params]
		mov	dword ptr [esp+4], 1Ch
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
new_client = ebx			; SilcClient
		test	eax, eax
		jz	short loc_62B81B75
params_0 = esi				; SilcClientParams *
new_client = eax			; SilcClient
		mov	new_client, [ebp+application]
new_client = ebx			; SilcClient
		mov	[new_client+14h], eax
		mov	dword ptr [esp+4], 84h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	edi, eax
		mov	[new_client+18h], eax
		test	eax, eax
		jz	short loc_62B81B8C
		mov	eax, [ebp+ops]
		mov	[edi+48h], eax
		mov	dword ptr [esp+4], 25h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	[edi+4Ch], eax
		mov	ecx, [ebp+version_string]
		test	ecx, ecx
		jz	short loc_62B81B80

loc_62B81B3D:				; CODE XREF: _silc_client_alloc+B7j
		mov	edi, [new_client+18h]
		mov	eax, [ebp+version_string]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[edi+70h], eax
		test	params_0, params_0
		jz	short loc_62B81B61
		mov	eax, [new_client+18h]
		mov	eax, [eax+4Ch]
		mov	ecx, 25h
		mov	edi, eax
		rep movsb

loc_62B81B61:				; CODE XREF: _silc_client_alloc+80j
		mov	eax, [new_client+18h]
		mov	eax, [eax+4Ch]
		mov	byte ptr [eax+20h], 0
		mov	eax, [new_client+18h]
		mov	dword ptr [eax+7Ch], 0

loc_62B81B75:				; CODE XREF: _silc_client_alloc+24j
					; _silc_client_alloc+C6j
		mov	eax, new_client
		add	esp, 1Ch
		pop	new_client
		pop	params_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
params_0 = esi				; SilcClientParams *
new_client = ebx			; SilcClient
		align 10h

loc_62B81B80:				; CODE XREF: _silc_client_alloc+6Bj
		mov	[ebp+version_string], offset aSilc1_21_1_10S ; "SILC-1.2-1.1.10	silc-toolkit"
		jmp	short loc_62B81B3D
; ---------------------------------------------------------------------------
		align 4

loc_62B81B8C:				; CODE XREF: _silc_client_alloc+47j
		mov	[esp], new_client
		call	_silc_free
		xor	new_client, new_client
		jmp	short loc_62B81B75
_silc_client_alloc endp

; Exported entry 120. silc_client_fsm_destructor

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_fsm_destructor(SilcFSM fsm, void *fsm_context, void *destructor_context)
		public _silc_client_fsm_destructor
_silc_client_fsm_destructor proc near

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
destructor_context= dword ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		leave
		jmp	_silc_fsm_free
_silc_client_fsm_destructor endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_connection_finished(SilcFSMThread fsm, void *fsm_context, void *destructor_context)
_silc_client_connection_finished proc near ; DATA XREF:	_silc_client_add_connection+2BDo

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
destructor_context= dword ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+fsm]
		mov	[esp], ebx
		call	_silc_fsm_get_state_context
		mov	eax, [eax+18h]
		mov	edx, [eax+7Ch]
		mov	edx, [eax+7Ch]
		dec	edx
		mov	[eax+7Ch], edx
		or	byte ptr [eax+82h], 4
		add	eax, 2Ch
		mov	[esp], eax
		call	_silc_fsm_event_signal
		mov	[ebp+fsm], ebx
		add	esp, 14h
		pop	ebx
		leave
		jmp	_silc_fsm_free
_silc_client_connection_finished endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 222. silc_client_st_stop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_stop(SilcFSMObject	*fsm, void *fsm_context, void *state_context)
		public _silc_client_st_stop
_silc_client_st_stop proc near		; DATA XREF: _silc_client_st_run+9Fo

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+0Ch]
		mov	[esp], eax
		call	_silc_schedule_stop
		mov	[esp], ebx	; client
		call	_silc_client_commands_unregister
		mov	edx, [ebx+18h]
		mov	eax, [edx+74h]
		test	eax, eax
		jz	short loc_62B81C17
fsm_context_0 =	ebx			; void *
		mov	edx, [edx+78h]
		mov	[esp+4], edx
		mov	[esp], fsm_context_0
		call	eax

loc_62B81C17:				; CODE XREF: _silc_client_st_stop+25j
		mov	eax, 3
		add	esp, 14h
		pop	fsm_context_0
		leave
		retn
_silc_client_st_stop endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 221. silc_client_st_run

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_run(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_st_run
_silc_client_st_run proc near		; DATA XREF: _silc_client_init+21Do

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	[esp+4], esi
		mov	eax, [ebx+18h]
		add	eax, 2Ch
		mov	[esp], eax
		call	_silc_fsm_event_wait
		test	eax, eax
		jz	short loc_62B81CAC
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	edx, [fsm_context_0+18h]
		mov	al, [edx+82h]
		test	al, 2
		jz	short loc_62B81C80
		and	eax, 0FFFFFFFDh
		mov	[edx+82h], al
		mov	edx, [fsm_context_0+18h]
		mov	eax, [edx+74h]
		test	eax, eax
		jz	short loc_62B81CA0
		mov	edx, [edx+78h]
		mov	[esp+4], edx
		mov	[esp], fsm_context_0
		call	eax
		xor	eax, eax

loc_62B81C76:				; CODE XREF: _silc_client_st_run+B1j
					; _silc_client_st_run+C1j
		add	esp, 10h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 10h

loc_62B81C80:				; CODE XREF: _silc_client_st_run+2Fj
		test	al, 4
		jz	short loc_62B81CB8
		and	eax, 0FFFFFFFBh
		mov	[edx+82h], al
		mov	eax, [fsm_context_0+18h]
		mov	edx, [eax+7Ch]
		test	edx, edx
		jnz	short loc_62B81CA0
		test	byte ptr [eax+82h], 1
		jnz	short loc_62B81CD8

loc_62B81CA0:				; CODE XREF: _silc_client_st_run+42j
					; _silc_client_st_run+71j ...
		xor	eax, eax
		add	esp, 10h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B81CAC:				; CODE XREF: _silc_client_st_run+22j
		mov	al, 2
		add	esp, 10h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B81CB8:				; CODE XREF: _silc_client_st_run+5Ej
		test	al, 1
		jz	short loc_62B81CA0
		mov	eax, [edx+7Ch]
		test	eax, eax
		jnz	short loc_62B81CA0
		mov	dword ptr [esp+4], offset _silc_client_st_stop
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B81C76
; ---------------------------------------------------------------------------
		align 4

loc_62B81CD8:				; CODE XREF: _silc_client_st_run+7Aj
		add	eax, 2Ch
		mov	[esp], eax
		call	_silc_fsm_event_signal
		xor	eax, eax
		jmp	short loc_62B81C76
_silc_client_st_run endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 100. silc_client_connection_st_run

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_connection_st_run(SilcFSMObject *fsm,	void *fsm_context, void	*state_context)
		public _silc_client_connection_st_run
_silc_client_connection_st_run proc near ; DATA	XREF: _silc_client_connection_st_start+5Co

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	[esp+4], esi
		mov	eax, [ebx+54h]
		add	eax, 98h
		mov	[esp], eax
		call	_silc_fsm_event_wait
		test	eax, eax
		jz	short loc_62B81D3C
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	edx, [fsm_context_0+54h]
		mov	al, [edx+12Dh]
		test	al, 2
		jnz	short loc_62B81D48
		lea	fsm_0, [edx+6Ch]
thread = esi				; SilcFSMThread
		test	al, 1
		jnz	loc_62B81DAC
		test	al, 4
		jnz	loc_62B81DFC
		test	al, 8
		jnz	short loc_62B81D64

loc_62B81D32:				; CODE XREF: _silc_client_connection_st_run+C0j
		xor	eax, eax

loc_62B81D34:				; CODE XREF: _silc_client_connection_st_run+15Aj
		add	esp, 20h
		pop	fsm_context_0
		pop	thread
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B81D3C:				; CODE XREF: _silc_client_connection_st_run+24j
		mov	al, 2
		add	esp, 20h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B81D48:				; CODE XREF: _silc_client_connection_st_run+31j
		mov	dword ptr [esp+4], offset _silc_client_connection_st_close
		mov	[esp], fsm_0
		call	_silc_fsm_next
		mov	eax, 1
		add	esp, 20h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B81D64:				; CODE XREF: _silc_client_connection_st_run+48j
fsm_context_0 =	ebx			; void *
thread = esi				; SilcFSMThread
		and	eax, 0FFFFFFF7h
		mov	[edx+12Dh], al
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], fsm_context_0
		add	edx, 40h
		mov	[esp+4], edx
		mov	[esp], thread
		call	_silc_fsm_thread_init
		mov	dword ptr [esp+4], offset _silc_client_st_rekey
		mov	[esp], thread
		call	_silc_fsm_start_sync
		jmp	short loc_62B81D32
; ---------------------------------------------------------------------------
		align 4

loc_62B81DAC:				; CODE XREF: _silc_client_connection_st_run+38j
		and	eax, 0FFFFFFFEh
		mov	[edx+12Dh], al
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], fsm_context_0
		add	edx, 40h
		mov	[esp+4], edx
		mov	[esp], thread
		call	_silc_fsm_thread_init
		mov	dword ptr [esp+4], offset _silc_client_st_connect
		mov	[esp], thread
		call	_silc_fsm_start_sync
		xor	eax, eax
		add	esp, 20h
		pop	fsm_context_0
		pop	thread
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
thread = esi				; SilcFSMThread
		align 4

loc_62B81DFC:				; CODE XREF: _silc_client_connection_st_run+40j
		and	eax, 0FFFFFFFBh
		mov	[edx+12Dh], al
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], fsm_context_0
		add	edx, 40h
		mov	[esp+4], edx
		mov	[esp], thread
		call	_silc_fsm_thread_init
		mov	dword ptr [esp+4], offset _silc_client_st_connect_set_stream
		mov	[esp], thread
		call	_silc_fsm_start_sync
		xor	eax, eax
		jmp	loc_62B81D34
_silc_client_connection_st_run endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  99. silc_client_connection_st_packet

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_connection_st_packet(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_connection_st_packet
_silc_client_connection_st_packet proc near ; DATA XREF: _silc_client_packet_receive+CFo

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+fsm]
		mov	ebx, [ebp+state_context]
		cmp	byte ptr [ebx+22h], 1Bh	; switch 28 cases
		jbe	short loc_62B81E70

loc_62B81E5B:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
fsm_0 =	eax				; SilcFSMObject	* ; jumptable 62B81E74 default case
state_context_0	= ebx			; void *
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3

loc_62B81E68:				; CODE XREF: _silc_client_connection_st_packet+46j
					; _silc_client_connection_st_packet+5Aj ...
		add	esp, 14h
		pop	state_context_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	eax				; SilcFSMObject	*
state_context_0	= ebx			; void *
		align 10h

loc_62B81E70:				; CODE XREF: _silc_client_connection_st_packet+11j
		movzx	edx, byte ptr [state_context_0+22h]
		jmp	ds:off_62BA8220[edx*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 4

loc_62B81E7C:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
		mov	dword ptr [esp+4], offset _silc_client_ftp ; jumptable 62B81E74	case 27
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B81E68
; ---------------------------------------------------------------------------

loc_62B81E90:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
fsm_0 =	eax				; SilcFSMObject	* ; jumptable 62B81E74 case 1
		mov	dword ptr [esp+4], offset _silc_client_disconnect
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B81E68
; ---------------------------------------------------------------------------

loc_62B81EA4:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
fsm_0 =	eax				; SilcFSMObject	* ; jumptable 62B81E74 case 5
		mov	dword ptr [esp+4], offset _silc_client_notify
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B81E68
; ---------------------------------------------------------------------------

loc_62B81EB8:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
fsm_0 =	eax				; SilcFSMObject	* ; jumptable 62B81E74 case 6
		mov	dword ptr [esp+4], offset _silc_client_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B81E68
; ---------------------------------------------------------------------------

loc_62B81ECC:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
fsm_0 =	eax				; SilcFSMObject	* ; jumptable 62B81E74 case 7
		mov	dword ptr [esp+4], offset _silc_client_channel_message
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B81E68
; ---------------------------------------------------------------------------

loc_62B81EE0:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
fsm_0 =	eax				; SilcFSMObject	* ; jumptable 62B81E74 case 8
		mov	dword ptr [esp+4], offset _silc_client_channel_key
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B81E68
; ---------------------------------------------------------------------------
fsm_0 =	eax				; SilcFSMObject	*
		align 4

loc_62B81EF8:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
		mov	dword ptr [esp+4], offset _silc_client_private_message ; jumptable 62B81E74 case 9
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B81E68
; ---------------------------------------------------------------------------
fsm_0 =	eax				; SilcFSMObject	*
		align 10h

loc_62B81F10:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
		mov	dword ptr [esp+4], offset _silc_client_private_message_key ; jumptable 62B81E74	case 10
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B81E68
; ---------------------------------------------------------------------------
fsm_0 =	eax				; SilcFSMObject	*
		align 4

loc_62B81F28:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
		mov	dword ptr [esp+4], offset _silc_client_command ; jumptable 62B81E74 case 11
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B81E68
; ---------------------------------------------------------------------------
fsm_0 =	eax				; SilcFSMObject	*
		align 10h

loc_62B81F40:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
		mov	dword ptr [esp+4], offset _silc_client_command_reply ; jumptable 62B81E74 case 12
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B81E68
; ---------------------------------------------------------------------------
fsm_0 =	eax				; SilcFSMObject	*
		align 4

loc_62B81F58:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
		mov	dword ptr [esp+4], offset _silc_client_connect_auth_request ; jumptable	62B81E74 case 16
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B81E68
; ---------------------------------------------------------------------------
fsm_0 =	eax				; SilcFSMObject	*
		align 10h

loc_62B81F70:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
		mov	dword ptr [esp+4], offset _silc_client_new_id ;	jumptable 62B81E74 case	18
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B81E68
; ---------------------------------------------------------------------------
fsm_0 =	eax				; SilcFSMObject	*
		align 4

loc_62B81F88:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
		mov	fsm_0, [ebp+fsm_context] ; jumptable 62B81E74 case 22
		mov	eax, [eax+54h]
		or	byte ptr [eax+12Dh], 48h
		add	eax, 98h
		mov	[esp], eax
		call	_silc_fsm_event_signal
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3
		jmp	loc_62B81E68
; ---------------------------------------------------------------------------

loc_62B81FB4:				; CODE XREF: _silc_client_connection_st_packet+2Cj
					; DATA XREF: .rdata:off_62BA8220o
fsm_0 =	eax				; SilcFSMObject	* ; jumptable 62B81E74 case 25
		mov	dword ptr [esp+4], offset _silc_client_key_agreement
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B81E68
_silc_client_connection_st_packet endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 113. silc_client_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_error(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_error
_silc_client_error proc	near		; DATA XREF: _silc_client_connection_st_packet:loc_62B81EB8o

var_1C		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+fsm_context]
		mov	ebx, [ebp+state_context]
		mov	edi, [esi+4Ch]
client = edi				; SilcClient
		mov	edx, [ebx+0Ch]
		mov	eax, [ebx+10h]
		sub	eax, edx
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_memdup
		test	eax, eax
msg = eax				; char *
		jz	short loc_62B82017
fsm_context_0 =	esi			; void *
state_context_0	= ebx			; void *
		mov	edx, [client+18h]
		mov	edx, [edx+48h]
		mov	[esp+0Ch], msg
		mov	dword ptr [esp+8], 4
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		mov	[ebp+var_1C], msg
		call	dword ptr [edx]
		mov	eax, [ebp+var_1C]

loc_62B82017:				; CODE XREF: _silc_client_error+28j
msg = eax				; char *
		mov	[esp], msg
		call	_silc_free
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3
		add	esp, 2Ch
		pop	state_context_0
		pop	fsm_context_0
		pop	client
		leave
		retn
_silc_client_error endp

; Exported entry 111. silc_client_disconnect

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_disconnect(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_disconnect
_silc_client_disconnect	proc near	; DATA XREF: _silc_client_connection_st_packet:loc_62B81E90o

var_C		= byte ptr -0Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	esi, [ebp+fsm_context]
		mov	ebx, [ebp+state_context]
		mov	eax, [ebx+0Ch]
		cmp	[ebx+10h], eax
		jz	short loc_62B8209A
fsm_context_0 =	esi			; void *
state_context_0	= ebx			; void *
		mov	dl, [eax]
status = edx				; SilcStatus
		lea	ecx, [eax+1]
		mov	[state_context_0+0Ch], ecx
		mov	eax, [state_context_0+10h]
		sub	eax, ecx
		cmp	eax, 1
		jbe	short loc_62B82072
		mov	[esp+4], eax
		mov	[esp], ecx
		mov	[ebp+var_C], dl
		call	_silc_utf8_valid
		test	al, al
		mov	dl, [ebp+var_C]
		jnz	short loc_62B820CC

loc_62B82072:				; CODE XREF: _silc_client_disconnect+26j
status = edx				; SilcStatus
		xor	eax, eax

loc_62B82074:				; CODE XREF: _silc_client_disconnect+AFj
message	= eax				; char *
		mov	ecx, [fsm_context_0+54h]
		mov	dword ptr [ecx+128h], 2
		mov	[ecx+12Ch], dl
		mov	status,	[fsm_context_0+54h]
		mov	[edx+10Ch], message
		mov	al, [edx+12Dh]
		test	al, 2
		jz	short loc_62B820B0

loc_62B8209A:				; CODE XREF: _silc_client_disconnect+14j
					; _silc_client_disconnect+95j
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3
		add	esp, 20h
		pop	state_context_0
		pop	fsm_context_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
state_context_0	= ebx			; void *
		align 10h

loc_62B820B0:				; CODE XREF: _silc_client_disconnect+64j
		or	eax, 2
		mov	[edx+12Dh], al
		mov	eax, [fsm_context_0+54h]
		add	eax, 98h
		mov	[esp], eax
		call	_silc_fsm_event_signal
		jmp	short loc_62B8209A
; ---------------------------------------------------------------------------
		align 4

loc_62B820CC:				; CODE XREF: _silc_client_disconnect+3Cj
		mov	ecx, [state_context_0+0Ch]
		mov	eax, [state_context_0+10h]
		sub	eax, ecx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	_silc_memdup
		mov	dl, [ebp+var_C]
		jmp	short loc_62B82074
_silc_client_disconnect	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  98. silc_client_connection_st_close

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_connection_st_close(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_connection_st_close
_silc_client_connection_st_close proc near
					; DATA XREF: _silc_client_connection_st_run:loc_62B81D48o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [ebp+fsm_context]
		mov	eax, [edi+54h]
		test	dword ptr [eax+0E8h], 0FFFFFFFCh
		jz	loc_62B82188
fsm_context_0 =	edi			; void *
		mov	edx, [eax+0D8h]
		mov	[eax+0E0h], edx
		and	byte ptr [eax+0E8h], 0FDh
		xchg	ax, ax

loc_62B8211C:				; CODE XREF: _silc_client_connection_st_close+67j
		mov	eax, [fsm_context_0+54h]
		mov	ebx, [eax+0E0h]
		test	ebx, ebx
		jz	short loc_62B8216C

loc_62B82129:				; CODE XREF: _silc_client_connection_st_close+80j
		test	byte ptr [eax+0E8h], 2
		jz	short loc_62B8217C
		movzx	edx, word ptr [eax+0E6h]
		mov	edx, [ebx+edx]

loc_62B8213C:				; CODE XREF: _silc_client_connection_st_close+9Ej
		mov	[eax+0E0h], edx
		lea	esi, [ebx+8]
		mov	[esp], esi
		call	_silc_fsm_is_started
		test	al, al
		jz	short loc_62B8211C
		and	byte ptr [ebx+64h], 0FDh
		mov	[esp], esi
		call	_silc_fsm_continue_sync
		mov	eax, [fsm_context_0+54h]
		mov	ebx, [eax+0E0h]
		test	ebx, ebx
		jnz	short loc_62B82129
		xchg	ax, ax

loc_62B8216C:				; CODE XREF: _silc_client_connection_st_close+3Fj
					; _silc_client_connection_st_close+155j
		mov	eax, 1

loc_62B82171:				; CODE XREF: _silc_client_connection_st_close+15Cj
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	fsm_context_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	edi			; void *
		align 4

loc_62B8217C:				; CODE XREF: _silc_client_connection_st_close+48j
		movzx	edx, word ptr [eax+0E4h]
		mov	edx, [ebx+edx]
		jmp	short loc_62B8213C
; ---------------------------------------------------------------------------

loc_62B82188:				; CODE XREF: _silc_client_connection_st_close+19j
		mov	edx, [eax+0FCh]
		test	edx, edx
		jz	short loc_62B821B7
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], edx
		call	_silc_async_abort
		mov	eax, [fsm_context_0+54h]
		mov	dword ptr [eax+0FCh], 0

loc_62B821B7:				; CODE XREF: _silc_client_connection_st_close+A8j
		add	eax, 6Ch
		mov	[esp], eax
		call	_silc_fsm_is_started
		test	al, al
		jnz	short loc_62B8222F
		mov	edx, [fsm_context_0+44h]
		test	edx, edx
		jz	short loc_62B82202
		mov	eax, [fsm_context_0+54h]
		mov	ecx, [fsm_context_0+48h]
		mov	[esp+14h], ecx
		mov	ecx, [eax+10Ch]
		mov	[esp+10h], ecx
		movzx	ecx, byte ptr [eax+12Ch]
		mov	[esp+0Ch], ecx
		mov	eax, [eax+128h]
		mov	[esp+8], eax
		mov	[esp+4], fsm_context_0
		mov	eax, [fsm_context_0+4Ch]
		mov	[esp], eax
		call	edx

loc_62B82202:				; CODE XREF: _silc_client_connection_st_close+E3j
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+10Ch]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [fsm_context_0+3Ch]
		test	eax, eax
		jz	short loc_62B82242
		mov	[esp], eax
		call	_silc_packet_stream_destroy
		mov	eax, 3
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	fsm_context_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8222F:				; CODE XREF: _silc_client_connection_st_close+DCj
fsm_context_0 =	edi			; void *
		mov	eax, [fsm_context_0+54h]
		add	eax, 6Ch
		mov	[esp], eax
		call	_silc_fsm_continue_sync
		jmp	loc_62B8216C
; ---------------------------------------------------------------------------

loc_62B82242:				; CODE XREF: _silc_client_connection_st_close+130j
		mov	al, 3
		jmp	loc_62B82171
_silc_client_connection_st_close endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 101. silc_client_connection_st_start

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_connection_st_start(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_connection_st_start
_silc_client_connection_st_start proc near ; DATA XREF:	_silc_client_add_connection+2E6o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+54h]
		mov	[esp], edi
		call	_silc_fsm_get_schedule
		mov	[esi+0B4h], eax
		mov	eax, [ebx+54h]
		lea	esi, [eax+40h]
connfsm	= esi				; SilcFSM
		mov	eax, [eax+0B4h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], offset _silc_client_connection_destructor
		mov	[esp+4], ebx
		mov	[esp], connfsm
		call	_silc_fsm_init
		mov	[esp+4], connfsm
		mov	eax, [ebx+54h]
		add	eax, 98h
		mov	[esp], eax
		call	_silc_fsm_event_init
		mov	dword ptr [esp+4], offset _silc_client_connection_st_run
		mov	[esp], connfsm
		call	_silc_fsm_start_sync
		mov	edx, [ebx+54h]
		mov	al, [edx+12Dh]
		test	al, 2
		jnz	short loc_62B82304

loc_62B822C5:				; CODE XREF: _silc_client_connection_st_start+CFj
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		test	al, 1
		jnz	short loc_62B822E8

loc_62B822C9:				; CODE XREF: _silc_client_connection_st_start+B3j
		test	al, 4
		jz	short loc_62B822DB
		add	edx, 98h
		mov	[esp], edx
		call	_silc_fsm_event_signal

loc_62B822DB:				; CODE XREF: _silc_client_connection_st_start+7Fj
		mov	eax, 2
		add	esp, 2Ch
		pop	fsm_context_0
		pop	connfsm
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B822E8:				; CODE XREF: _silc_client_connection_st_start+7Bj
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
connfsm	= esi				; SilcFSM
		add	edx, 98h
		mov	[esp], edx
		call	_silc_fsm_event_signal
		mov	edx, [fsm_context_0+54h]
		mov	al, [edx+12Dh]
		jmp	short loc_62B822C9
; ---------------------------------------------------------------------------
		align 4

loc_62B82304:				; CODE XREF: _silc_client_connection_st_start+77j
		add	edx, 98h
		mov	[esp], edx
		call	_silc_fsm_event_signal
		mov	edx, [fsm_context_0+54h]
		mov	al, [edx+12Dh]
		jmp	short loc_62B822C5
_silc_client_connection_st_start endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 108. silc_client_del_connection

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_del_connection(SilcClient client, SilcClientConnection conn)
		public _silc_client_del_connection
_silc_client_del_connection proc near	; CODE XREF: _silc_client_add_connection+34Bp
					; _silc_client_add_connection+36Ep ...

list		= SilcList ptr -2Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+client]
		mov	ebx, [ebp+conn]
		mov	[esp+4], ebx
		mov	eax, [ebx+54h]
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_context
		mov	eax, [ebx+54h]
		mov	edx, [eax+11Ch]
		test	edx, edx
		jz	short loc_62B823A7
client_0 = esi				; SilcClient
conn_0 = ebx				; SilcClientConnection
		lea	eax, [ebp+list]
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_idcache_get_all
		test	al, al
		jz	short loc_62B823A4
		mov	eax, [ebp+list.head]
		mov	[ebp+list.current], eax
		and	[ebp+list._bf10], 0FDh
		jmp	short loc_62B82390
; ---------------------------------------------------------------------------

loc_62B82370:				; CODE XREF: _silc_client_del_connection+78j
		movzx	edx, [ebp+list.prev_offset]
		mov	edx, [eax+edx]

loc_62B82377:				; CODE XREF: _silc_client_del_connection+81j
		mov	[ebp+list.current], edx
		mov	eax, [eax+0Ch]
		mov	[esp+8], eax	; server
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_del_server
		mov	eax, [ebp+list.current]

loc_62B82390:				; CODE XREF: _silc_client_del_connection+4Ej
		test	eax, eax
		jz	short loc_62B823A4
		test	[ebp+list._bf10], 2
		jnz	short loc_62B82370
		movzx	edx, [ebp+list.next_offset]
		mov	edx, [eax+edx]
		jmp	short loc_62B82377
; ---------------------------------------------------------------------------
		align 4

loc_62B823A4:				; CODE XREF: _silc_client_del_connection+42j
					; _silc_client_del_connection+72j
		mov	eax, [conn_0+54h]

loc_62B823A7:				; CODE XREF: _silc_client_del_connection+2Fj
		mov	edx, [eax+118h]
		test	edx, edx
		jz	short loc_62B8241B
		lea	eax, [ebp+list]
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_idcache_get_all
		test	al, al
		jz	short loc_62B82418
		mov	edi, [ebp+list.head]
		mov	[ebp+list.current], edi
		and	[ebp+list._bf10], 0FDh
		jmp	short loc_62B82403
; ---------------------------------------------------------------------------

loc_62B823D0:				; CODE XREF: _silc_client_del_connection+EBj
		movzx	eax, [ebp+list.prev_offset]
		mov	eax, [edi+eax]

loc_62B823D7:				; CODE XREF: _silc_client_del_connection+F4j
		mov	[ebp+list.current], eax
		mov	eax, [edi+0Ch]
		mov	[esp+8], eax	; channel
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_empty_channel
		mov	eax, [edi+0Ch]
		mov	[esp+8], eax	; channel
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_del_channel
		mov	edi, [ebp+list.current]

loc_62B82403:				; CODE XREF: _silc_client_del_connection+AEj
		test	edi, edi
		jz	short loc_62B82418
		test	[ebp+list._bf10], 2
		jnz	short loc_62B823D0
		movzx	eax, [ebp+list.next_offset]
		mov	eax, [edi+eax]
		jmp	short loc_62B823D7
; ---------------------------------------------------------------------------
		align 4

loc_62B82418:				; CODE XREF: _silc_client_del_connection+A2j
					; _silc_client_del_connection+E5j
		mov	eax, [conn_0+54h]

loc_62B8241B:				; CODE XREF: _silc_client_del_connection+8Fj
		mov	edx, [eax+114h]
		test	edx, edx
		jz	short loc_62B82454
		lea	eax, [ebp+list]
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_idcache_get_all
		test	al, al
		jnz	loc_62B825C4

loc_62B8243C:				; CODE XREF: _silc_client_del_connection+2D2j
		mov	eax, [conn_0+54h]
		mov	edx, [eax+114h]
		test	edx, edx
		jz	short loc_62B82454
		mov	[esp], edx
		call	_silc_idcache_free
		mov	eax, [conn_0+54h]

loc_62B82454:				; CODE XREF: _silc_client_del_connection+103j
					; _silc_client_del_connection+127j
		mov	edx, [eax+118h]
		test	edx, edx
		jz	short loc_62B82469
		mov	[esp], edx
		call	_silc_idcache_free
		mov	eax, [conn_0+54h]

loc_62B82469:				; CODE XREF: _silc_client_del_connection+13Cj
		mov	edx, [eax+11Ch]
		test	edx, edx
		jz	short loc_62B8247E
		mov	[esp], edx
		call	_silc_idcache_free
		mov	eax, [conn_0+54h]

loc_62B8247E:				; CODE XREF: _silc_client_del_connection+151j
		mov	edx, [eax+0C4h]
		mov	[eax+0CCh], edx
		and	byte ptr [eax+0D4h], 0FDh
		jmp	short loc_62B824AC
; ---------------------------------------------------------------------------
		align 4

loc_62B82494:				; CODE XREF: _silc_client_del_connection+1A0j
		movzx	ecx, word ptr [eax+0D2h]
		mov	ecx, [edx+ecx]

loc_62B8249E:				; CODE XREF: _silc_client_del_connection+1ACj
		mov	[eax+0CCh], ecx
		mov	[esp], edx
		call	_silc_fsm_free

loc_62B824AC:				; CODE XREF: _silc_client_del_connection+171j
		mov	eax, [conn_0+54h]
		mov	edx, [eax+0CCh]
		test	edx, edx
		jz	short loc_62B824D0
		test	byte ptr [eax+0D4h], 2
		jnz	short loc_62B82494
		movzx	ecx, word ptr [eax+0D0h]
		mov	ecx, [edx+ecx]
		jmp	short loc_62B8249E
; ---------------------------------------------------------------------------
		align 10h

loc_62B824D0:				; CODE XREF: _silc_client_del_connection+197j
		mov	eax, [conn_0+8]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [conn_0+54h]
		mov	client_0, [eax+0F4h]
		test	esi, esi
		jz	short loc_62B824FD
		mov	eax, [esi]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], esi
		call	_silc_free
		mov	eax, [conn_0+54h]

loc_62B824FD:				; CODE XREF: _silc_client_del_connection+1C6j
		mov	esi, [eax+0F8h]
		test	esi, esi
		jz	short loc_62B8251C
		mov	eax, [esi]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], esi
		call	_silc_free
		mov	eax, [conn_0+54h]

loc_62B8251C:				; CODE XREF: _silc_client_del_connection+1E5j
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_free
		mov	eax, [conn_0+54h]
		mov	edx, [eax+0ECh]
		test	edx, edx
		jz	short loc_62B82542
		mov	[esp], edx
		call	_silc_hash_free
		mov	eax, [conn_0+54h]

loc_62B82542:				; CODE XREF: _silc_client_del_connection+215j
		mov	edx, [eax+0F0h]
		test	edx, edx
		jz	short loc_62B82557
		mov	[esp], edx
		call	_silc_hash_free
		mov	eax, [conn_0+54h]

loc_62B82557:				; CODE XREF: _silc_client_del_connection+22Aj
		mov	word ptr [eax+124h], 0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+110h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [conn_0+54h]
		mov	edx, [eax+0C0h]
		test	edx, edx
		jz	short loc_62B82589
		mov	[esp], edx
		call	_silc_ske_free_rekey_material
		mov	eax, [conn_0+54h]

loc_62B82589:				; CODE XREF: _silc_client_del_connection+25Cj
		mov	edx, [eax+100h]
		test	edx, edx
		jz	short loc_62B8259E
		mov	[esp], edx
		call	_silc_async_free
		mov	eax, [conn_0+54h]

loc_62B8259E:				; CODE XREF: _silc_client_del_connection+271j
		mov	[esp], eax
		call	_silc_free
		mov	ecx, 58h
		mov	al, 46h
		mov	edi, conn_0
		rep stosb
conn_0 = edi				; SilcClientConnection
		mov	[esp], ebx
		call	_silc_free
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = esi				; SilcClient
conn_0 = ebx				; SilcClientConnection
		align 4

loc_62B825C4:				; CODE XREF: _silc_client_del_connection+116j
		mov	eax, [ebp+list.head]
		mov	[ebp+list.current], eax
		and	[ebp+list._bf10], 0FDh
		jmp	short loc_62B825F0
; ---------------------------------------------------------------------------

loc_62B825D0:				; CODE XREF: _silc_client_del_connection+2DCj
		movzx	edx, [ebp+list.prev_offset]
		mov	edx, [eax+edx]

loc_62B825D7:				; CODE XREF: _silc_client_del_connection+2E5j
		mov	[ebp+list.current], edx
		mov	eax, [eax+0Ch]
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_del_client
		mov	eax, [ebp+list.current]

loc_62B825F0:				; CODE XREF: _silc_client_del_connection+2AEj
		test	eax, eax
		jz	loc_62B8243C
		test	[ebp+list._bf10], 2
		jnz	short loc_62B825D0
		movzx	edx, [ebp+list.next_offset]
		mov	edx, [eax+edx]
		jmp	short loc_62B825D7
_silc_client_del_connection endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry   5. silc_client_add_connection

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientConnection __cdecl silc_client_add_connection(SilcClient client, SilcConnectionType	conn_type, SilcBool connect, SilcClientConnectionParams	*params, SilcPublicKey public_key, SilcPrivateKey private_key, char *remote_host, int port, SilcClientConnectCallback callback,	void *context)
		public _silc_client_add_connection
_silc_client_add_connection proc near	; CODE XREF: _silc_client_key_exchange+A3p
					; _silc_client_connect_to_client+78p ...

var_19		= byte ptr -19h
client		= dword	ptr  8
conn_type	= dword	ptr  0Ch
connect		= byte ptr  10h
params		= dword	ptr  14h
public_key	= dword	ptr  18h
private_key	= dword	ptr  1Ch
remote_host	= dword	ptr  20h
port		= dword	ptr  24h
callback	= dword	ptr  28h
context		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	edi, [ebp+port]
		mov	esi, [ebp+callback]
		mov	al, [ebp+connect]
		mov	[ebp+var_19], al
		test	esi, esi
		jnz	short loc_62B82630

loc_62B82621:				; CODE XREF: _silc_client_add_connection+35Fj
port_0 = edi				; int
callback_0 = esi			; SilcClientConnectCallback
conn = ebx				; SilcClientConnection
		xor	conn, conn

loc_62B82623:				; CODE XREF: _silc_client_add_connection+40j
					; _silc_client_add_connection+33Cj ...
thread = esi				; SilcFSMThread
		mov	eax, conn
		add	esp, 3Ch
		pop	conn
		pop	thread
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
port_0 = edi				; int
callback_0 = esi			; SilcClientConnectCallback
		align 10h

loc_62B82630:				; CODE XREF: _silc_client_add_connection+17j
		mov	dword ptr [esp+4], 58h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
conn = ebx				; SilcClientConnection
		test	eax, eax
		jz	short loc_62B82623
conn = eax				; SilcClientConnection
		mov	edx, [ebp+client]
		mov	[conn+4Ch], edx
		mov	conn, [ebp+public_key]
conn = ebx				; SilcClientConnection
		mov	[conn+34h], eax
		mov	eax, [ebp+private_key]
		mov	[conn+38h], eax
		mov	eax, [ebp+remote_host]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[conn+8], eax
		test	port_0,	port_0
		jnz	short loc_62B82672
		mov	di, 2C2h

loc_62B82672:				; CODE XREF: _silc_client_add_connection+64j
		mov	[conn+0Ch], edi
		mov	eax, [ebp+conn_type]
		mov	[conn+40h], eax
		mov	[conn+44h], callback_0
		mov	eax, [ebp+context]
		mov	[conn+48h], eax
		mov	dword ptr [esp+4], 130h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	[conn+54h], eax
		test	eax, eax
		jz	loc_62B8295F
port_0 = edi				; int
		mov	byte ptr [eax+127h], 1
		mov	eax, [conn+54h]
		add	eax, 0B8h
		mov	[esp], eax
		call	_silc_mutex_alloc
		mov	eax, [conn+54h]
		mov	word ptr [eax+124h], 0
		add	eax, 0F0h
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aSha1 ;	"sha1"
		call	_silc_hash_alloc
		test	al, al
		jz	loc_62B8292F
		mov	ecx, [ebp+params]
		test	ecx, ecx
		jz	short loc_62B82702
		mov	eax, [conn+54h]
		mov	ecx, 10h
		mov	port_0,	eax
		mov	callback_0, [ebp+params]
		rep movsd
params_0 = esi				; SilcClientConnectionParams *
		mov	edx, [ebp+params]
		mov	eax, [edx+3Ch]
		mov	[conn+50h], eax

loc_62B82702:				; CODE XREF: _silc_client_add_connection+E0j
		mov	esi, [conn+54h]
		mov	eax, [esi+34h]
		test	eax, eax
		jnz	loc_62B82918
		mov	dword ptr [esi+34h], 0E10h

loc_62B82717:				; CODE XREF: _silc_client_add_connection+315j
					; _silc_client_add_connection+322j
		or	byte ptr [esi+12Dh], 10h
		mov	eax, [conn+54h]
		and	dword ptr [eax+0E8h], 3
		mov	eax, [conn+54h]
		mov	word ptr [eax+0E4h], 0
		and	byte ptr [eax+0E8h], 0FEh
		mov	eax, [conn+54h]
		mov	word ptr [eax+0E6h], 0
		and	byte ptr [eax+0E8h], 0FDh
		mov	eax, [conn+54h]
		mov	dword ptr [eax+0E0h], 0
		mov	dword ptr [eax+0DCh], 0
		mov	dword ptr [eax+0D8h], 0
		and	dword ptr [eax+0D4h], 3
		mov	eax, [conn+54h]
		mov	word ptr [eax+0D0h], 0
		and	byte ptr [eax+0D4h], 0FEh
		mov	eax, [conn+54h]
		mov	word ptr [eax+0D2h], 0
		and	byte ptr [eax+0D4h], 0FDh
		mov	esi, [conn+54h]
		mov	dword ptr [esi+0CCh], 0
		mov	dword ptr [esi+0C8h], 0
		mov	dword ptr [esi+0C4h], 0
		cmp	[ebp+conn_type], 1
		jz	loc_62B82878
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	dword ptr [esp], 0
		call	_silc_idcache_alloc
		mov	[esi+114h], eax
		mov	esi, [conn+54h]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	dword ptr [esp], 0
		call	_silc_idcache_alloc
		mov	[esi+118h], eax
		mov	esi, [conn+54h]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	dword ptr [esp], 0
		call	_silc_idcache_alloc
		mov	[esi+11Ch], eax
		mov	esi, [conn+54h]
		mov	edx, [esi+114h]
		test	edx, edx
		jz	loc_62B82949
		mov	eax, [esi+118h]
		test	eax, eax
		jz	loc_62B82949
		mov	edi, [esi+11Ch]
		test	edi, edi
		jz	loc_62B82949

loc_62B82878:				; CODE XREF: _silc_client_add_connection+1B9j
		cmp	[ebp+var_19], 0
		jz	short loc_62B828AD
		mov	[esp+8], conn
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], offset	_silc_client_connect_abort
		call	_silc_async_alloc
		mov	[esi+100h], eax
		mov	eax, [conn+54h]
		mov	esi, [eax+100h]
		test	esi, esi
		jz	loc_62B8296C

loc_62B828AD:				; CODE XREF: _silc_client_add_connection+274j
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	edx, [eax+4Ch]
		movzx	edx, byte ptr [edx]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], offset _silc_client_connection_finished
		mov	[esp+4], conn
		mov	[esp], eax
		call	_silc_fsm_thread_alloc
		mov	esi, eax
thread = esi				; SilcFSMThread
		test	eax, eax
		jz	short loc_62B82949
thread = eax				; SilcFSMThread
		mov	edx, [ebp+client]
		mov	[esp+4], edx
		mov	[esp], thread
		call	_silc_fsm_set_state_context
thread = esi				; SilcFSMThread
		mov	dword ptr [esp+4], offset _silc_client_connection_st_start
		mov	[esp], thread
		call	_silc_fsm_start
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	edx, [eax+7Ch]
		mov	edx, [eax+7Ch]
		inc	edx
		mov	[eax+7Ch], edx
		mov	eax, conn
		add	esp, 3Ch
		pop	conn
		pop	thread
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B82918:				; CODE XREF: _silc_client_add_connection+102j
conn = ebx				; SilcClientConnection
		cmp	eax, 12Bh
		ja	loc_62B82717
		mov	dword ptr [esi+34h], 12Ch
		jmp	loc_62B82717
; ---------------------------------------------------------------------------

loc_62B8292F:				; CODE XREF: _silc_client_add_connection+D5j
port_0 = edi				; int
callback_0 = esi			; SilcClientConnectCallback
		mov	[esp], conn
		call	_silc_free
		mov	eax, [conn+54h]
		mov	[esp], eax
		call	_silc_free
		xor	conn, conn
		jmp	loc_62B82623
; ---------------------------------------------------------------------------

loc_62B82949:				; CODE XREF: _silc_client_add_connection+24Ej
					; _silc_client_add_connection+25Cj ...
thread = eax				; SilcFSMThread	; conn
		mov	[esp+4], conn
		mov	thread,	[ebp+client]
thread = esi				; SilcFSMThread
		mov	[esp], eax	; client
		call	_silc_client_del_connection
		xor	conn, conn
		jmp	loc_62B82623
; ---------------------------------------------------------------------------

loc_62B8295F:				; CODE XREF: _silc_client_add_connection+95j
port_0 = edi				; int
callback_0 = esi			; SilcClientConnectCallback
		mov	[esp], conn
		call	_silc_free
		jmp	loc_62B82621
; ---------------------------------------------------------------------------

loc_62B8296C:				; CODE XREF: _silc_client_add_connection+29Fj
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_del_connection
		xor	conn, conn
		jmp	loc_62B82623
_silc_client_add_connection endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 144. silc_client_key_exchange

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcAsyncOperation __cdecl silc_client_key_exchange(SilcClient client, SilcClientConnectionParams *params, SilcPublicKey public_key, SilcPrivateKey private_key, SilcStream stream, SilcConnectionType conn_type, SilcClientConnectCallback callback,	void *context)
		public _silc_client_key_exchange
_silc_client_key_exchange proc near	; CODE XREF: _silc_client_perform_key_agreement_stream+E5p

host		= dword	ptr -20h
port		= word ptr -1Ah
client		= dword	ptr  8
params		= dword	ptr  0Ch
public_key	= dword	ptr  10h
private_key	= dword	ptr  14h
stream		= dword	ptr  18h
conn_type	= dword	ptr  1Ch
callback	= dword	ptr  20h
context		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+client]
		mov	esi, [ebp+stream]
		mov	edi, [ebp+callback]
		test	ebx, ebx
		jnz	short loc_62B829A4

loc_62B8299A:				; CODE XREF: _silc_client_key_exchange+22j
client_0 = ebx				; SilcClient
stream_0 = esi				; SilcStream
callback_0 = edi			; SilcClientConnectCallback
		xor	eax, eax

loc_62B8299C:				; CODE XREF: _silc_client_key_exchange+EEj
					; _silc_client_key_exchange+13Ej
		add	esp, 4Ch
		pop	client_0
		pop	stream_0
		pop	callback_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B829A4:				; CODE XREF: _silc_client_key_exchange+14j
client_0 = ebx				; SilcClient
stream_0 = esi				; SilcStream
callback_0 = edi			; SilcClientConnectCallback
		test	stream_0, stream_0
		jz	short loc_62B8299A
		mov	eax, [client_0+18h]
		test	byte ptr [eax+82h], 2
		jnz	loc_62B82A54
		lea	eax, [ebp+port]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		lea	eax, [ebp+host]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	[esp], stream_0
		call	_silc_socket_stream_get_info
		test	al, al
		jz	loc_62B82A78
		mov	eax, [ebp+context]
		mov	[esp+24h], eax	; context
		mov	[esp+20h], callback_0 ;	callback
		movzx	eax, [ebp+port]
		mov	[esp+1Ch], eax	; port
		mov	eax, [ebp+host]
		mov	[esp+18h], eax	; remote_host
		mov	eax, [ebp+private_key]
		mov	[esp+14h], eax	; private_key
		mov	eax, [ebp+public_key]
		mov	[esp+10h], eax	; public_key
		mov	eax, [ebp+params]
		mov	[esp+0Ch], eax	; params
		mov	dword ptr [esp+8], 1 ; connect
		mov	eax, [ebp+conn_type]
		mov	[esp+4], eax	; conn_type
		mov	[esp], client_0	; client
		call	_silc_client_add_connection
		test	eax, eax
conn = eax				; SilcClientConnection
		jz	short loc_62B82A94
		mov	edx, [conn+54h]
		mov	[edx+108h], stream_0
		or	byte ptr [edx+12Dh], 4
		mov	conn, [conn+54h]
		mov	eax, [eax+100h]
		add	esp, 4Ch
		pop	client_0
		pop	stream_0
		pop	callback_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
stream_0 = esi				; SilcStream
callback_0 = edi			; SilcClientConnectCallback
		align 4

loc_62B82A54:				; CODE XREF: _silc_client_key_exchange+2Ej
		mov	dword ptr [esp], offset	aClientLibraryI	; "Client library is not started yet. Silc"...
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		xor	eax, eax
		jmp	loc_62B8299C
; ---------------------------------------------------------------------------
		align 4

loc_62B82A78:				; CODE XREF: _silc_client_key_exchange+5Cj
		mov	dword ptr [esp], offset	aSocketStreamDo	; "Socket stream does not have remote host"...
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output

loc_62B82A94:				; CODE XREF: _silc_client_key_exchange+AAj
conn = eax				; SilcClientConnection
		mov	conn, [ebp+context]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], 0
		mov	[esp], client_0
		call	callback_0
		xor	eax, eax
		jmp	loc_62B8299C
_silc_client_key_exchange endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  96. silc_client_connect_to_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcAsyncOperation __cdecl silc_client_connect_to_client(SilcClient client, SilcClientConnectionParams *params, SilcPublicKey	public_key, SilcPrivateKey private_key,	char *remote_host, int port, SilcClientConnectCallback callback, void *context)
		public _silc_client_connect_to_client
_silc_client_connect_to_client proc near ; CODE	XREF: _silc_client_ftp+32Dp
					; _silc_client_file_receive+2B5p ...

client		= dword	ptr  8
params		= dword	ptr  0Ch
public_key	= dword	ptr  10h
private_key	= dword	ptr  14h
remote_host	= dword	ptr  18h
port		= dword	ptr  1Ch
callback	= dword	ptr  20h
context		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+client]
		mov	eax, [ebp+params]
		mov	edx, [ebp+remote_host]
		mov	esi, [ebp+callback]
		mov	edi, [ebp+context]
		test	ebx, ebx
		jnz	short loc_62B82AF0

loc_62B82AE4:				; CODE XREF: _silc_client_connect_to_client+2Aj
client_0 = ebx				; SilcClient
params_0 = eax				; SilcClientConnectionParams *
remote_host_0 =	edx			; char *
callback_0 = esi			; SilcClientConnectCallback
context_0 = edi				; void *
		xor	params_0, params_0

loc_62B82AE6:				; CODE XREF: _silc_client_connect_to_client+BAj
					; _silc_client_connect_to_client+EAj
		add	esp, 3Ch
		pop	client_0
		pop	callback_0
		pop	context_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
params_0 = eax				; SilcClientConnectionParams *
remote_host_0 =	edx			; char *
callback_0 = esi			; SilcClientConnectCallback
context_0 = edi				; void *
		align 10h

loc_62B82AF0:				; CODE XREF: _silc_client_connect_to_client+1Aj
		test	remote_host_0, remote_host_0
		jz	short loc_62B82AE4
		mov	ecx, [client_0+18h]
		test	byte ptr [ecx+82h], 2
		jnz	short loc_62B82B64
		test	params_0, params_0
		jz	short loc_62B82B08
		mov	byte ptr [params_0+25h], 1

loc_62B82B08:				; CODE XREF: _silc_client_connect_to_client+3Aj
		mov	[esp+24h], context_0 ; context
		mov	[esp+20h], callback_0 ;	callback
		mov	ecx, [ebp+port]
		mov	[esp+1Ch], ecx	; port
		mov	[esp+18h], remote_host_0 ; remote_host
		mov	remote_host_0, [ebp+private_key]
		mov	[esp+14h], edx	; private_key
		mov	edx, [ebp+public_key]
		mov	[esp+10h], edx	; public_key
		mov	[esp+0Ch], params_0 ; params
		mov	dword ptr [esp+8], 1 ; connect
		mov	dword ptr [esp+4], 1 ; conn_type
		mov	[esp], client_0	; client
		call	_silc_client_add_connection
		test	eax, eax
conn = eax				; SilcClientConnection
		jz	short loc_62B82B87
		mov	edx, [conn+54h]
		or	byte ptr [edx+12Dh], 1
		mov	conn, [conn+54h]
		mov	eax, [eax+100h]
		add	esp, 3Ch
		pop	client_0
		pop	callback_0
		pop	context_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B82B64:				; CODE XREF: _silc_client_connect_to_client+36j
client_0 = ebx				; SilcClient ; "Client library is not started yet. Silc"...
params_0 = eax				; SilcClientConnectionParams *
remote_host_0 =	edx			; char *
callback_0 = esi			; SilcClientConnectCallback
context_0 = edi				; void *
		mov	dword ptr [esp], offset	aClientLibraryI
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		xor	eax, eax
		jmp	loc_62B82AE6
; ---------------------------------------------------------------------------

loc_62B82B87:				; CODE XREF: _silc_client_connect_to_client+7Fj
conn = eax				; SilcClientConnection
		mov	[esp+14h], context_0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], 0
		mov	[esp], client_0
		call	callback_0
		xor	eax, eax
		jmp	loc_62B82AE6
_silc_client_connect_to_client endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  97. silc_client_connect_to_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcAsyncOperation __cdecl silc_client_connect_to_server(SilcClient client, SilcClientConnectionParams *params, SilcPublicKey	public_key, SilcPrivateKey private_key,	char *remote_host, int port, SilcClientConnectCallback callback, void *context)
		public _silc_client_connect_to_server
_silc_client_connect_to_server proc near

var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
params		= dword	ptr  0Ch
public_key	= dword	ptr  10h
private_key	= dword	ptr  14h
remote_host	= dword	ptr  18h
port		= dword	ptr  1Ch
callback	= dword	ptr  20h
context		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+client]
		mov	esi, [ebp+remote_host]
		mov	edi, [ebp+port]
		test	ebx, ebx
		jnz	short loc_62B82BD8

loc_62B82BCE:				; CODE XREF: _silc_client_connect_to_server+22j
client_0 = ebx				; SilcClient
remote_host_0 =	esi			; char *
port_0 = edi				; int
		xor	eax, eax

loc_62B82BD0:				; CODE XREF: _silc_client_connect_to_server+E2j
					; _silc_client_connect_to_server+116j
		add	esp, 4Ch
		pop	client_0
		pop	remote_host_0
		pop	port_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B82BD8:				; CODE XREF: _silc_client_connect_to_server+14j
client_0 = ebx				; SilcClient
remote_host_0 =	esi			; char *
port_0 = edi				; int
		test	remote_host_0, remote_host_0
		jz	short loc_62B82BCE
		mov	eax, [client_0+18h]
		test	byte ptr [eax+82h], 2
		jnz	loc_62B82C7C
		mov	eax, [ebp+context]
		mov	[esp+24h], eax	; context
		mov	eax, [ebp+callback]
		mov	[esp+20h], eax	; callback
		mov	[esp+1Ch], port_0 ; port
		mov	[esp+18h], remote_host_0 ; remote_host
		mov	eax, [ebp+private_key]
		mov	[esp+14h], eax	; private_key
		mov	eax, [ebp+public_key]
		mov	[esp+10h], eax	; public_key
		mov	eax, [ebp+params]
		mov	[esp+0Ch], eax	; params
		mov	dword ptr [esp+8], 1 ; connect
		mov	dword ptr [esp+4], 2 ; conn_type
		mov	[esp], client_0	; client
		call	_silc_client_add_connection
		test	eax, eax
conn = eax				; SilcClientConnection
		jz	short loc_62B82C9F
		mov	edx, [client_0+18h]
		mov	edx, [edx+48h]
		mov	[esp+14h], remote_host_0
		mov	[esp+10h], port_0
		mov	dword ptr [esp+0Ch], offset aConnectingToPo ; "Connecting to port %d of	server %s"
		mov	dword ptr [esp+8], 4
		mov	[esp+4], conn
		mov	[esp], client_0
		mov	[ebp+var_1C], conn
		call	dword ptr [edx]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+54h]
conn = eax				; SilcClientConnection
		or	byte ptr [edx+12Dh], 1
		mov	conn, [conn+54h]
		mov	eax, [eax+100h]
		add	esp, 4Ch
		pop	client_0
		pop	remote_host_0
		pop	port_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
remote_host_0 =	esi			; char *
port_0 = edi				; int
		align 4

loc_62B82C7C:				; CODE XREF: _silc_client_connect_to_server+2Ej
		mov	dword ptr [esp], offset	aClientLibraryI	; "Client library is not started yet. Silc"...
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		xor	eax, eax
		jmp	loc_62B82BD0
; ---------------------------------------------------------------------------

loc_62B82C9F:				; CODE XREF: _silc_client_connect_to_server+79j
conn = eax				; SilcClientConnection
		mov	conn, [ebp+context]
		mov	[esp+14h], eax	; void *
		mov	dword ptr [esp+10h], 0 ; char *
		mov	dword ptr [esp+0Ch], 0 ; SilcStatus
		mov	dword ptr [esp+8], 3 ; SilcClientConnectionStatus
		mov	dword ptr [esp+4], 0 ; SilcClientConnection
		mov	[esp], client_0	; SilcClient
		call	[ebp+callback]
		xor	eax, eax
		jmp	loc_62B82BD0
_silc_client_connect_to_server endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_connection_destructor(SilcFSM fsm, void *fsm_context, void *destructor_context)
_silc_client_connection_destructor proc	near
					; DATA XREF: _silc_client_connection_st_start+34o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
destructor_context= dword ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+fsm_context]
		mov	ebx, [ebp+destructor_context]
		mov	[esp+4], eax	; conn
		mov	eax, [eax+4Ch]
		mov	[esp], eax	; client
		call	_silc_client_del_connection
		mov	[ebp+fsm], ebx
		add	esp, 14h
		pop	ebx
		leave
		jmp	_silc_fsm_finish
_silc_client_connection_destructor endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  13. silc_client_attributes_get

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcHashTable	__cdecl	silc_client_attributes_get(SilcClient client, SilcClientConnection conn)
		public _silc_client_attributes_get
_silc_client_attributes_get proc near

client		= dword	ptr  8
conn		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+conn]
		mov	eax, [eax+54h]
		mov	eax, [eax+104h]
		leave
		retn
_silc_client_attributes_get endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  15. silc_client_attributes_request

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBuffer silc_client_attributes_request(SilcAttribute attribute, ...)
		public _silc_client_attributes_request
_silc_client_attributes_request	proc near ; CODE XREF: _silc_client_attributes_request+B3p
					; _silc_client_command_whois+144p ...

attribute	= byte ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	dl, [ebp+attribute]
		test	dl, dl
		jz	short loc_62B82D60
attribute_0 = edx			; SilcAttribute
		lea	ebx, [ebp+arg_4]
va = ebx				; va_list
		xor	eax, eax
buffer = eax				; SilcBuffer
		nop

loc_62B82D28:				; CODE XREF: _silc_client_attributes_request+43j
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		movzx	attribute_0, dl
		mov	[esp+4], attribute_0
		mov	[esp], buffer
		call	_silc_attribute_payload_encode
		add	va, 4
		mov	dl, [va-4]
attribute_0 = edx			; SilcAttribute
		test	dl, dl
		jnz	short loc_62B82D28
		add	esp, 44h
		pop	va
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_62B82D60:				; CODE XREF: _silc_client_attributes_request+Cj
		mov	dword ptr [esp+30h], 0
		mov	dword ptr [esp+2Ch], 0Ch
		mov	dword ptr [esp+28h], 0Ah
		mov	dword ptr [esp+24h], 9
		mov	dword ptr [esp+20h], 8
		mov	dword ptr [esp+1Ch], 7
		mov	dword ptr [esp+18h], 6
		mov	dword ptr [esp+14h], 5
		mov	dword ptr [esp+10h], 4
		mov	dword ptr [esp+0Ch], 3
		mov	dword ptr [esp+8], 2
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1 ; attribute
		call	_silc_client_attributes_request
		add	esp, 44h
		pop	ebx
		leave
		retn
_silc_client_attributes_request	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_attribute_del_foreach(void *key, void *context, void	*user_context)
_silc_client_attribute_del_foreach proc	near ; DATA XREF: _silc_client_attribute_del+64o

key		= dword	ptr  8
context		= dword	ptr  0Ch
user_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, [ebp+context]
		mov	esi, [ebp+user_context]
		test	ebx, ebx
		jz	short loc_62B82E10
context_0 = ebx				; void *
user_context_0 = esi			; void *
		mov	[esp], context_0
		call	_silc_attribute_get_attribute
		mov	[ebp+user_context], context_0
		movzx	eax, al
attribute = eax				; SilcAttribute
		mov	[ebp+context], attribute
		mov	attribute, [user_context_0+54h]
		mov	eax, [eax+104h]
		mov	[ebp+key], eax
		add	esp, 10h
		pop	context_0
		pop	user_context_0
		leave
		jmp	_silc_hash_table_del_by_context
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
user_context_0 = esi			; void *
		align 10h

loc_62B82E10:				; CODE XREF: _silc_client_attribute_del_foreach+10j
		add	esp, 10h
		pop	context_0
		pop	user_context_0
		leave
		retn
_silc_client_attribute_del_foreach endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  12. silc_client_attribute_del

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_attribute_del(SilcClient	client,	SilcClientConnection conn, SilcAttribute attribute, SilcAttributePayload attr)
		public _silc_client_attribute_del
_silc_client_attribute_del proc	near

client		= dword	ptr  8
conn		= dword	ptr  0Ch
attribute	= byte ptr  10h
attr		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, [ebp+conn]
		mov	esi, [ebp+attr]
		mov	dl, [ebp+attribute]
		mov	eax, [ebx+54h]
		mov	eax, [eax+104h]
		test	eax, eax
		jz	loc_62B82ED4
conn_0 = ebx				; SilcClientConnection
attribute_0 = edx			; SilcAttribute
attr_0 = esi				; SilcAttributePayload
		test	attr_0,	attr_0
		jz	short loc_62B82E74
		mov	[esp], attr_0
		call	_silc_attribute_get_attribute
		mov	[esp+8], attr_0
		movzx	eax, al
attribute_0 = eax			; SilcAttribute
		mov	[esp+4], attribute_0
		mov	attribute_0, [conn_0+54h]
		mov	eax, [eax+104h]
		mov	[esp], eax
		call	_silc_hash_table_del_by_context
		mov	attr_0,	eax
ret = esi				; SilcBool
		test	al, al
		jnz	short loc_62B82E98

loc_62B82E68:				; CODE XREF: _silc_client_attribute_del+93j
		mov	eax, ret
		add	esp, 10h
		pop	conn_0
		pop	ret
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
attribute_0 = edx			; SilcAttribute
attr_0 = esi				; SilcAttributePayload
		align 4

loc_62B82E74:				; CODE XREF: _silc_client_attribute_del+24j
		test	dl, dl
		jz	short loc_62B82ED4
		mov	[esp+0Ch], conn_0
		mov	dword ptr [esp+8], offset _silc_client_attribute_del_foreach
		movzx	attribute_0, dl
		mov	[esp+4], attribute_0
		mov	[esp], eax
		call	_silc_hash_table_find_foreach
		mov	attr_0,	1

loc_62B82E98:				; CODE XREF: _silc_client_attribute_del+4Ej
ret = esi				; SilcBool
		mov	eax, [conn_0+54h]
		mov	eax, [eax+104h]
		mov	[esp], eax
		call	_silc_hash_table_count
		test	eax, eax
		jnz	short loc_62B82E68
		mov	eax, [conn_0+54h]
		mov	eax, [eax+104h]
		mov	[esp], eax
		call	_silc_hash_table_free
		mov	eax, [conn_0+54h]
		mov	dword ptr [eax+104h], 0
		mov	eax, ret
		add	esp, 10h
		pop	conn_0
		pop	ret
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B82ED4:				; CODE XREF: _silc_client_attribute_del+1Cj
					; _silc_client_attribute_del+5Ej
conn_0 = ebx				; SilcClientConnection
attribute_0 = edx			; SilcAttribute
attr_0 = esi				; SilcAttributePayload
		xor	attr_0,	attr_0
ret = esi				; SilcBool
		mov	eax, ret
		add	esp, 10h
		pop	conn_0
		pop	ret
		leave
		retn
_silc_client_attribute_del endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  11. silc_client_attribute_add

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcAttributePayload __cdecl silc_client_attribute_add(SilcClient client, SilcClientConnection conn, SilcAttribute attribute,	void *object, SilcUInt32 object_size)
		public _silc_client_attribute_add
_silc_client_attribute_add proc	near

var_19		= byte ptr -19h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
attribute	= byte ptr  10h
object		= dword	ptr  14h
object_size	= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+conn]
		mov	al, [ebp+attribute]
		mov	[ebp+var_19], al
		mov	eax, [ebp+object_size]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+object]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		movzx	eax, [ebp+var_19]
attribute_0 = eax			; SilcAttribute
		mov	[esp], attribute_0
		call	_silc_attribute_payload_alloc
		mov	ebx, eax
attr = ebx				; SilcAttributePayload
		test	eax, eax
		jz	short loc_62B82F3B
conn_0 = esi				; SilcClientConnection
attr = eax				; SilcAttributePayload
		mov	edi, [conn_0+54h]
		mov	attr, [edi+104h]
attr = ebx				; SilcAttributePayload
		test	eax, eax
		jz	short loc_62B82F48

loc_62B82F27:				; CODE XREF: _silc_client_attribute_add+BBj
		mov	[esp+8], attr
		movzx	edx, [ebp+var_19]
attribute_0 = edx			; SilcAttribute
		mov	[esp+4], attribute_0
		mov	[esp], eax
		call	_silc_hash_table_add

loc_62B82F3B:				; CODE XREF: _silc_client_attribute_add+38j
		mov	eax, attr
		add	esp, 3Ch
		pop	attr
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = esi				; SilcClientConnection
attr = ebx				; SilcAttributePayload
		align 4

loc_62B82F48:				; CODE XREF: _silc_client_attribute_add+45j
		mov	dword ptr [esp+1Ch], 1
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], offset _silc_client_attribute_destruct
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset _silc_hash_ptr
		mov	dword ptr [esp], 0
		call	_silc_hash_table_alloc
		mov	[edi+104h], eax
		mov	eax, [conn_0+54h]
		mov	eax, [eax+104h]
		jmp	short loc_62B82F27
_silc_client_attribute_add endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_attribute_destruct(void *key, void *context,	void *user_context)
_silc_client_attribute_destruct	proc near ; DATA XREF: _silc_client_attribute_add+78o

key		= dword	ptr  8
context		= dword	ptr  0Ch
user_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+context]
		mov	[ebp+key], eax
		leave
		jmp	_silc_attribute_payload_free
_silc_client_attribute_destruct	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  14. silc_client_attributes_process

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBuffer __cdecl silc_client_attributes_process(SilcClient client, SilcClientConnection conn, SilcDList attrs)
		public _silc_client_attributes_process
_silc_client_attributes_process	proc near ; CODE XREF: _silc_client_command+A0p

sign		= byte ptr -82Dh
pk		= SilcAttributeObjPk ptr -2Ch
sign_len	= dword	ptr -20h
f		= SilcAttrForeach ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
attrs		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 84Ch
		mov	esi, [ebp+conn]
		mov	ebx, [ebp+attrs]
		mov	eax, [esi+54h]
		mov	eax, [eax+104h]
		test	eax, eax
		jz	loc_62B8315C
conn_0 = esi				; SilcClientConnection
attrs_0	= ebx				; SilcDList
		mov	[ebp+pk.type], offset aSilcRsa ; "silc-rsa"
		lea	eax, [ebp+pk.data_len]
		mov	[esp+4], eax
		mov	eax, [conn_0+34h]
		mov	[esp], eax
		call	_silc_pkcs_public_key_encode
		cmp	eax, 1
		sbb	edx, edx
		add	edx, 2
		mov	[ebp+pk.data], eax
		mov	dword ptr [esp+10h], 0Ch
		lea	eax, [ebp+pk]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 0
		call	_silc_attribute_payload_encode
		mov	edi, eax
buffer = edi				; SilcBuffer
		mov	eax, [ebp+pk.data]
		mov	[esp], eax
		call	_silc_free
		mov	[ebp+f.buffer],	buffer
		mov	eax, [attrs_0]
		mov	[attrs_0+8], eax
		and	byte ptr [attrs_0+10h],	0FDh
		mov	dword ptr [attrs_0+18h], 0
		mov	dword ptr [attrs_0+14h], 0
		xor	eax, eax
		lea	buffer,	[ebp+f]
		jmp	short loc_62B83096
; ---------------------------------------------------------------------------

loc_62B83050:				; CODE XREF: _silc_client_attributes_process+F0j
		movzx	edx, word ptr [attrs_0+0Eh]
		mov	edx, [eax+edx]

loc_62B83057:				; CODE XREF: _silc_client_attributes_process+F9j
		mov	[attrs_0+8], edx
		mov	[attrs_0+14h], eax
		mov	eax, [eax]
attr = eax				; SilcAttributePayload
		test	attr, attr
		jz	short loc_62B830B7
		mov	[esp], attr
		call	_silc_attribute_get_attribute
		cmp	al, 0Eh
attribute = eax				; SilcAttribute
		jz	short loc_62B83093
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], offset _silc_client_attributes_process_foreach
		movzx	attribute, al
		mov	[esp+4], attribute
		mov	attribute, [conn_0+54h]
		mov	eax, [eax+104h]
		mov	[esp], eax
		call	_silc_hash_table_find_foreach

loc_62B83093:				; CODE XREF: _silc_client_attributes_process+B9j
attribute = eax				; SilcAttribute
		mov	attribute, [attrs_0+14h]

loc_62B83096:				; CODE XREF: _silc_client_attributes_process+9Aj
		mov	[attrs_0+18h], eax
		mov	eax, [attrs_0+8]
		test	eax, eax
		jz	short loc_62B830B0
		test	byte ptr [attrs_0+10h],	2
		jnz	short loc_62B83050
		movzx	edx, word ptr [attrs_0+0Ch]
		mov	edx, [eax+edx]
		jmp	short loc_62B83057
; ---------------------------------------------------------------------------
		align 10h

loc_62B830B0:				; CODE XREF: _silc_client_attributes_process+EAj
		mov	dword ptr [attrs_0+14h], 0

loc_62B830B7:				; CODE XREF: _silc_client_attributes_process+ADj
attr = eax				; SilcAttributePayload
		mov	attrs_0, [ebp+f.buffer]
buffer = ebx				; SilcBuffer
		mov	edx, [buffer+4]
		mov	attr, [conn_0+54h]
		mov	eax, [eax+0F0h]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		lea	eax, [ebp+sign_len]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 801h
		lea	edi, [ebp+sign]
		mov	[esp+0Ch], edi
		mov	eax, [buffer+8]
		sub	eax, edx
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	eax, [conn_0+38h]
		mov	[esp], eax
		call	_silc_pkcs_sign
		test	al, al
		jnz	short loc_62B83114
		mov	eax, buffer
		add	esp, 84Ch
		pop	buffer
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B83114:				; CODE XREF: _silc_client_attributes_process+151j
conn_0 = esi				; SilcClientConnection
buffer = ebx				; SilcBuffer
		mov	[ebp+pk.type], 0
		mov	[ebp+pk.data], edi
		mov	eax, [ebp+sign_len]
		mov	[ebp+pk.data_len], eax
		mov	dword ptr [esp+10h], 0Ch
		lea	eax, [ebp+pk]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 2
		mov	dword ptr [esp+4], 0Eh
		mov	[esp], buffer
		call	_silc_attribute_payload_encode
		mov	buffer,	eax
		mov	eax, buffer
		add	esp, 84Ch
		pop	buffer
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = esi				; SilcClientConnection
attrs_0	= ebx				; SilcDList
		align 4

loc_62B8315C:				; CODE XREF: _silc_client_attributes_process+1Dj
		xor	attrs_0, attrs_0
buffer = ebx				; SilcBuffer
		mov	eax, buffer
		add	esp, 84Ch
		pop	buffer
		pop	conn_0
		pop	edi
		leave
		retn
_silc_client_attributes_process	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_attributes_process_foreach(void *key, void *context,	void *user_context)
_silc_client_attributes_process_foreach	proc near
					; DATA XREF: _silc_client_attributes_process+BFo

var_4C		= byte ptr -4Ch
tmp		= byte ptr -3Ch
data_len	= dword	ptr -1Ch
key		= dword	ptr  8
context		= dword	ptr  0Ch
user_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+context]
		mov	ebx, [ebp+user_context]
		mov	dl, byte ptr [ebp+key]
attribute = edx				; SilcAttribute
		test	eax, eax
		jz	short loc_62B831CC
context_0 = eax				; void *
user_context_0 = ebx			; void *
		lea	ecx, [ebp+data_len]
		mov	[esp+4], ecx
		mov	[esp], context_0
		mov	[ebp+var_4C], dl
		call	_silc_attribute_get_data
		mov	dl, [ebp+var_4C]
		cmp	dl, 8
attribute = edx				; SilcAttribute
		jz	short loc_62B83204
		mov	ecx, [ebp+data_len]
		mov	[esp+10h], ecx
		mov	[esp+0Ch], eax
data = eax				; const	unsigned __int8	*
		mov	dword ptr [esp+8], 2
		movzx	attribute, dl
		mov	[esp+4], attribute
		mov	data, [user_context_0]
		mov	[esp], eax
		call	_silc_attribute_payload_encode_data
		mov	[user_context_0], eax

loc_62B831C2:				; CODE XREF: _silc_client_attributes_process_foreach+63j
					; _silc_client_attributes_process_foreach+ADj ...
attribute = edx				; SilcAttribute
		add	esp, 6Ch
		pop	user_context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
context_0 = eax				; void *
user_context_0 = ebx			; void *
		align 4

loc_62B831CC:				; CODE XREF: _silc_client_attributes_process_foreach+14j
		cmp	dl, 0Ch
		jz	short loc_62B831C2
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		movzx	attribute, dl
		mov	[esp+4], attribute
		mov	context_0, [user_context_0]
		mov	[esp], eax
		call	_silc_attribute_payload_encode
		mov	[user_context_0], eax
		add	esp, 6Ch
		pop	user_context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B83204:				; CODE XREF: _silc_client_attributes_process_foreach+2Ej
user_context_0 = ebx			; void *
attribute = edx				; SilcAttribute
		lea	esi, [ebp+tmp]
		mov	dword ptr [esp+4], 20h
		mov	[esp], esi
		call	_silc_timezone
		test	al, al
		jz	short loc_62B831C2
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, esi
		repne scasb
		not	ecx
		dec	ecx
data_len_0 = ecx			; SilcUInt32
		mov	[ebp+data_len],	data_len_0
		mov	[esp+10h], data_len_0
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 2
		mov	dword ptr [esp+4], 8
		mov	eax, [user_context_0]
		mov	[esp], eax
		call	_silc_attribute_payload_encode
		mov	[user_context_0], eax
		jmp	loc_62B831C2
_silc_client_attributes_process_foreach	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcDList silc_dlist_init()
_silc_dlist_init proc near		; CODE XREF: _silc_client_add_channel_private_key:loc_62B83850p
					; _silc_client_save_channel_key:loc_62B84AD0p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
		test	eax, eax
list = eax				; SilcDList
		jz	short locret_62B832A9
		mov	dword ptr [list+18h], 0
		mov	dword ptr [list+14h], 0
		mov	edx, [list+10h]
		and	edx, 3
		mov	[list+10h], edx
		mov	word ptr [list+0Ch], 4
		mov	word ptr [list+0Eh], 8
		mov	byte ptr [list+10h], 1
		mov	dword ptr [list+8], 0
		mov	dword ptr [list+4], 0
		mov	dword ptr [list], 0

locret_62B832A9:			; CODE XREF: _silc_dlist_init+14j
		leave
		retn
_silc_dlist_init endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 112. silc_client_empty_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_empty_channel(SilcClient client, SilcClientConnection conn, SilcChannelEntry	channel)
		public _silc_client_empty_channel
_silc_client_empty_channel proc	near	; CODE XREF: _silc_client_del_connection+C8p
					; _silc_client_unref_channel+85p ...

htl		= SilcHashTableList ptr	-28h
chu		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+client]
		mov	ebx, [ebp+conn]
		mov	edx, [ebp+channel]
		mov	eax, [edx+144h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		lea	edi, [ebp+htl]
		mov	[esp+4], edi
		mov	edx, [ebp+channel]
		mov	eax, [edx+134h]
		mov	[esp], eax
		call	_silc_hash_table_list
		jmp	short loc_62B83352
; ---------------------------------------------------------------------------
client_0 = esi				; SilcClient
conn_0 = ebx				; SilcClientConnection
		align 4

loc_62B832E8:				; CODE XREF: _silc_client_empty_channel+BFj
		mov	eax, [ebp+chu]
		mov	edx, [eax+8]
		mov	[esp+4], edx
		mov	eax, [eax]
		mov	eax, [eax+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_del
		mov	eax, [ebp+chu]
		mov	edx, [eax]
		mov	[esp+4], edx
		mov	eax, [eax+8]
		mov	eax, [eax+134h]
		mov	[esp], eax
		call	_silc_hash_table_del
		mov	eax, [ebp+chu]
		mov	eax, [eax]
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_client
		mov	eax, [ebp+chu]
		mov	eax, [eax+8]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_channel
		mov	eax, [ebp+chu]
		mov	[esp], eax
		call	_silc_free

loc_62B83352:				; CODE XREF: _silc_client_empty_channel+38j
		lea	eax, [ebp+chu]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	[esp], edi
		call	_silc_hash_table_get
		test	al, al
		jnz	loc_62B832E8
		mov	edx, [ebp+channel]
		mov	eax, [edx+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	[esp], edi
		call	_silc_hash_table_list_reset
		add	esp, 2Ch
		pop	conn_0
		pop	client_0
		pop	edi
		leave
		retn
_silc_client_empty_channel endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 193. silc_client_remove_from_channels

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_remove_from_channels(SilcClient client, SilcClientConnection	conn, SilcClientEntry client_entry)
		public _silc_client_remove_from_channels
_silc_client_remove_from_channels proc near ; CODE XREF: _silc_client_unref_client+88p
					; _silc_client_notify_watch+320p ...

htl		= SilcHashTableList ptr	-28h
chu		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [ebp+client]
		mov	esi, [ebp+conn]
		mov	edx, [ebp+client_entry]
		mov	eax, [edx+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_count
		test	eax, eax
		jnz	short loc_62B833C0
client_0 = ebx				; SilcClient
conn_0 = esi				; SilcClientConnection
		add	esp, 2Ch
		pop	client_0
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B833C0:				; CODE XREF: _silc_client_remove_from_channels+22j
client_0 = ebx				; SilcClient
conn_0 = esi				; SilcClientConnection
		mov	edx, [ebp+client_entry]
		mov	eax, [edx+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		lea	edi, [ebp+htl]
		mov	[esp+4], edi
		mov	edx, [ebp+client_entry]
		mov	eax, [edx+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_list
		jmp	short loc_62B83436
; ---------------------------------------------------------------------------
		align 4

loc_62B833EC:				; CODE XREF: _silc_client_remove_from_channels+11Bj
					; _silc_client_remove_from_channels+137j
		mov	eax, [ebp+chu]
		mov	eax, [eax+8]
		mov	eax, [eax+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	eax, [ebp+chu]
		mov	eax, [eax]
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_client
		mov	eax, [ebp+chu]
		mov	eax, [eax+8]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_channel
		mov	eax, [ebp+chu]
		mov	[esp], eax
		call	_silc_free

loc_62B83436:				; CODE XREF: _silc_client_remove_from_channels+55j
		lea	eax, [ebp+chu]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	[esp], edi
		call	_silc_hash_table_get
		test	al, al
		jz	short loc_62B834D0
		mov	eax, [ebp+chu]
		mov	eax, [eax+8]
		mov	eax, [eax+144h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	eax, [ebp+chu]
		mov	edx, [eax+8]
		mov	[esp+4], edx
		mov	eax, [eax]
		mov	eax, [eax+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_del
		mov	eax, [ebp+chu]
		mov	edx, [eax]
		mov	[esp+4], edx
		mov	eax, [eax+8]
		mov	eax, [eax+134h]
		mov	[esp], eax
		call	_silc_hash_table_del
		mov	eax, [ebp+chu]
		mov	eax, [eax+8]
		mov	eax, [eax+134h]
		mov	[esp], eax
		call	_silc_hash_table_count
		test	eax, eax
		jnz	loc_62B833EC
		mov	eax, [ebp+chu]
		mov	eax, [eax+8]
		mov	[esp+8], eax	; channel
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_del_channel
		jmp	loc_62B833EC
; ---------------------------------------------------------------------------

loc_62B834D0:				; CODE XREF: _silc_client_remove_from_channels+BBj
		mov	edx, [ebp+client_entry]
		mov	eax, [edx+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	[esp], edi
		call	_silc_hash_table_list_reset
		add	esp, 2Ch
		pop	client_0
		pop	conn_0
		pop	edi
		leave
		retn
_silc_client_remove_from_channels endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 178. silc_client_on_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcChannelUser __cdecl silc_client_on_channel(SilcChannelEntry channel, SilcClientEntry client_entry)
		public _silc_client_on_channel
_silc_client_on_channel	proc near	; CODE XREF: _silc_client_notify_cumode_change+269p
					; _silc_client_notify_cumode_change+395p ...

chu		= dword	ptr -0Ch
channel		= dword	ptr  8
client_entry	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+chu]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+client_entry]
		mov	[esp+4], eax
		mov	eax, [ebp+channel]
		mov	eax, [eax+134h]
		mov	[esp], eax
		call	_silc_hash_table_find
		test	al, al
		jz	short loc_62B8352C
		mov	eax, [ebp+chu]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_62B8352C:				; CODE XREF: _silc_client_on_channel+2Fj
		xor	eax, eax
		leave
		retn
_silc_client_on_channel	endp

; Exported entry 102. silc_client_current_channel_private_key

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_current_channel_private_key(SilcClient client, SilcClientConnection conn, SilcChannelEntry channel, SilcChannelPrivateKey key)
		public _silc_client_current_channel_private_key
_silc_client_current_channel_private_key proc near

client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h
key		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, [ebp+channel]
		mov	esi, [ebp+key]
		test	ebx, ebx
		jz	short loc_62B8356A
channel_0 = ebx				; SilcChannelEntry
key_0 =	esi				; SilcChannelPrivateKey
		mov	[channel_0+154h], key_0
		mov	eax, [key_0+4]
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	[channel_0+138h], eax
		mov	eax, [key_0+0Ch]
		mov	[esp], eax
		call	_silc_hmac_get_name
		mov	[channel_0+13Ch], eax

loc_62B8356A:				; CODE XREF: _silc_client_current_channel_private_key+10j
		add	esp, 10h
		pop	channel_0
		pop	key_0
		leave
		retn
_silc_client_current_channel_private_key endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry   3. silc_client_add_channel_private_key

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_add_channel_private_key(SilcClient client, SilcClientConnection conn, SilcChannelEntry channel, const char *name, char *cipher, char *hmac, unsigned __int8 *key, SilcUInt32 key_len, SilcChannelPrivateKey *ret_key)
		public _silc_client_add_channel_private_key
_silc_client_add_channel_private_key proc near

var_7C		= dword	ptr -7Ch
var_6C		= dword	ptr -6Ch
var_60		= dword	ptr -60h
keymat		= dword	ptr -5Ch
hash		= byte ptr -58h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h
name		= dword	ptr  14h
cipher		= dword	ptr  18h
hmac		= dword	ptr  1Ch
key		= dword	ptr  20h
key_len		= dword	ptr  24h
ret_key		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 9Ch
		mov	ebx, [ebp+conn]
		mov	esi, [ebp+channel]
		mov	edi, [ebp+cipher]
		mov	eax, [ebp+client]
		test	eax, eax
		jz	short loc_62B835B7
conn_0 = ebx				; SilcClientConnection
channel_0 = esi				; SilcChannelEntry
cipher_0 = edi				; char *
		test	conn_0,	conn_0
		jz	short loc_62B835B7
		test	channel_0, channel_0
		jz	short loc_62B835B7
		test	cipher_0, cipher_0
		jz	loc_62B837D8
		mov	ecx, [ebp+hmac]
		test	ecx, ecx
		jz	loc_62B837E8

loc_62B835AB:				; CODE XREF: _silc_client_add_channel_private_key+26Ej
					; _silc_client_add_channel_private_key+27Bj
		mov	[esp], cipher_0
		call	_silc_cipher_is_supported
		test	al, al
		jnz	short loc_62B835C4

loc_62B835B7:				; CODE XREF: _silc_client_add_channel_private_key+1Aj
					; _silc_client_add_channel_private_key+1Ej ...
		xor	eax, eax

loc_62B835B9:				; CODE XREF: _silc_client_add_channel_private_key+25Cj
					; _silc_client_add_channel_private_key+2AAj ...
entry =	ebx				; SilcChannelPrivateKey
		add	esp, 9Ch
		pop	entry
		pop	channel_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B835C4:				; CODE XREF: _silc_client_add_channel_private_key+41j
conn_0 = ebx				; SilcClientConnection
channel_0 = esi				; SilcChannelEntry
cipher_0 = edi				; char *
		mov	eax, [ebp+hmac]
		mov	[esp], eax
		call	_silc_hmac_is_supported
		test	al, al
		jz	short loc_62B835B7
		mov	edx, [channel_0+150h]
		test	edx, edx
		jz	loc_62B83850

loc_62B835E1:				; CODE XREF: _silc_client_add_channel_private_key+2E9j
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0F0h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 10h
		mov	dword ptr [esp+0Ch], 100h
		mov	dword ptr [esp+8], 10h
		mov	eax, [ebp+key_len]
		mov	[esp+4], eax
		mov	eax, [ebp+key]
		mov	[esp], eax
		call	_silc_ske_process_key_material_data
		mov	[ebp+keymat], eax
		test	eax, eax
		jz	short loc_62B835B7
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	conn_0,	eax
entry =	ebx				; SilcChannelPrivateKey
		test	eax, eax
		jz	loc_62B83811
entry =	eax				; SilcChannelPrivateKey
		mov	entry, [ebp+name]
entry =	ebx				; SilcChannelPrivateKey
		test	eax, eax
		jz	loc_62B83848
		mov	ecx, [ebp+name]
		mov	[esp], ecx	; char *
		call	_strdup

loc_62B83653:				; CODE XREF: _silc_client_add_channel_private_key+2D6j
		mov	[entry], eax
		lea	eax, [entry+4]
		mov	[esp+4], eax
		mov	[esp], cipher_0
		call	_silc_cipher_alloc
		test	al, al
		jz	loc_62B83824
		lea	eax, [entry+8]
		mov	[esp+4], eax
		mov	[esp], cipher_0
		call	_silc_cipher_alloc
		test	al, al
		jz	loc_62B837F4
		mov	dword ptr [esp+0Ch], 1
		mov	ecx, [ebp+keymat]
		mov	eax, [ecx+14h]
		mov	[esp+8], eax
		mov	eax, [ecx+0Ch]
		mov	[esp+4], eax
		mov	eax, [entry+4]
		mov	[esp], eax
		call	_silc_cipher_set_key
		mov	dword ptr [esp+0Ch], 0
		mov	edx, [ebp+keymat]
		mov	eax, [edx+14h]
		mov	[esp+8], eax
		mov	eax, [edx+0Ch]
		mov	[esp+4], eax
		mov	eax, [entry+8]
		mov	[esp], eax
		call	_silc_cipher_set_key
		lea	eax, [entry+0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	ecx, [ebp+hmac]
		mov	[esp], ecx
		call	_silc_hmac_alloc
		test	al, al
		jz	loc_62B83868
		mov	edx, [ebp+keymat]
		mov	cipher_0, [edx+14h]
		shr	edi, 3
		mov	edx, [edx+0Ch]
		mov	eax, [entry+0Ch]
		mov	[esp], eax
		mov	[ebp+var_60], edx
		call	_silc_hmac_get_hash
		lea	ecx, [ebp+hash]
		mov	[ebp+var_6C], ecx
		mov	[esp+0Ch], ecx
		mov	[esp+8], edi
		mov	edx, [ebp+var_60]
		mov	[esp+4], edx
		mov	[esp], eax
		call	_silc_hash_make
		mov	eax, [entry+0Ch]
		mov	[esp], eax
		call	_silc_hmac_get_hash
		mov	[esp], eax
		call	_silc_hash_len
		mov	[esp+8], eax
		lea	eax, [ebp+hash]
		mov	[esp+4], eax
		mov	eax, [entry+0Ch]
		mov	[esp], eax
		call	_silc_hmac_set_key
		mov	ecx, 40h
		xor	eax, eax
		mov	edi, [ebp+var_6C]
		rep stosb
		mov	edi, [channel_0+150h]
		mov	dword ptr [esp], 0Ch
		call	_silc_malloc
		test	eax, eax
		jz	short loc_62B837A9
		mov	[eax], entry
		mov	ecx, [edi]
		test	ecx, ecx
		jz	loc_62B838A2
		movzx	ecx, word ptr [edi+0Ch]
		mov	[ebp+var_7C], ecx
		mov	edx, [edi+4]
		mov	[edx+ecx], eax

loc_62B83788:				; CODE XREF: _silc_client_add_channel_private_key+337j
		test	byte ptr [edi+10h], 1
		jz	short loc_62B83798
		movzx	edx, word ptr [edi+0Eh]
		mov	ecx, [edi+4]
		mov	[eax+edx], ecx

loc_62B83798:				; CODE XREF: _silc_client_add_channel_private_key+218j
		mov	[edi+4], eax
		mov	edx, [ebp+var_7C]
		mov	dword ptr [eax+edx], 0
		add	dword ptr [edi+10h], 4

loc_62B837A9:				; CODE XREF: _silc_client_add_channel_private_key+1F9j
		mov	edx, [channel_0+154h]
		test	edx, edx
		jz	loc_62B838B0

loc_62B837B7:				; CODE XREF: _silc_client_add_channel_private_key+364j
		mov	ecx, [ebp+keymat]
		mov	[esp], ecx
		call	_silc_ske_free_key_material
		mov	eax, [ebp+ret_key]
		test	eax, eax
		jz	short loc_62B837CE
		mov	eax, [ebp+ret_key]
		mov	[eax], entry

loc_62B837CE:				; CODE XREF: _silc_client_add_channel_private_key+253j
		mov	al, 1
		jmp	loc_62B835B9
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
cipher_0 = edi				; char *
		align 4

loc_62B837D8:				; CODE XREF: _silc_client_add_channel_private_key+26j
		mov	cipher_0, offset aAes256Cbc ; "aes-256-cbc"
		mov	ecx, [ebp+hmac]
		test	ecx, ecx
		jnz	loc_62B835AB

loc_62B837E8:				; CODE XREF: _silc_client_add_channel_private_key+31j
		mov	[ebp+hmac], offset aHmacSha196 ; "hmac-sha1-96"
		jmp	loc_62B835AB
; ---------------------------------------------------------------------------

loc_62B837F4:				; CODE XREF: _silc_client_add_channel_private_key+109j
entry =	ebx				; SilcChannelPrivateKey
		mov	[esp], entry
		call	_silc_free
		mov	eax, [entry]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [entry+4]
		mov	[esp], eax
		call	_silc_cipher_free

loc_62B83811:				; CODE XREF: _silc_client_add_channel_private_key+C3j
		mov	edx, [ebp+keymat]
		mov	[esp], edx
		call	_silc_ske_free_key_material
		xor	eax, eax
		jmp	loc_62B835B9
; ---------------------------------------------------------------------------
		align 4

loc_62B83824:				; CODE XREF: _silc_client_add_channel_private_key+F2j
		mov	[esp], entry
		call	_silc_free
		mov	eax, [entry]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [ebp+keymat]
		mov	[esp], eax
		call	_silc_ske_free_key_material
		xor	eax, eax
		jmp	loc_62B835B9
; ---------------------------------------------------------------------------

loc_62B83848:				; CODE XREF: _silc_client_add_channel_private_key+CEj
		xor	eax, eax
		jmp	loc_62B83653
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
		align 10h

loc_62B83850:				; CODE XREF: _silc_client_add_channel_private_key+67j
		call	_silc_dlist_init
		mov	[channel_0+150h], eax
		test	eax, eax
		jnz	loc_62B835E1
		jmp	loc_62B835B7
; ---------------------------------------------------------------------------

loc_62B83868:				; CODE XREF: _silc_client_add_channel_private_key+173j
entry =	ebx				; SilcChannelPrivateKey
		mov	[esp], entry
		call	_silc_free
		mov	eax, [entry]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [entry+4]
		mov	[esp], eax
		call	_silc_cipher_free
		mov	eax, [entry+8]
		mov	[esp], eax
		call	_silc_cipher_free
		mov	eax, [ebp+keymat]
		mov	[esp], eax
		call	_silc_ske_free_key_material
		xor	eax, eax
		jmp	loc_62B835B9
; ---------------------------------------------------------------------------

loc_62B838A2:				; CODE XREF: _silc_client_add_channel_private_key+201j
		mov	[edi], eax
		movzx	edx, word ptr [edi+0Ch]
		mov	[ebp+var_7C], edx
		jmp	loc_62B83788
; ---------------------------------------------------------------------------

loc_62B838B0:				; CODE XREF: _silc_client_add_channel_private_key+23Dj
		mov	[channel_0+154h], entry
		mov	eax, [entry+4]
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	[channel_0+138h], eax
		mov	eax, [entry+4]
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	[channel_0+13Ch], eax
		jmp	loc_62B837B7
_silc_client_add_channel_private_key endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  19. silc_client_channel_message_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_channel_message_error(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_channel_message_error
_silc_client_channel_message_error proc	near
					; DATA XREF: _silc_client_channel_message_resolved:loc_62B83930o
					; _silc_client_channel_message+43Co ...

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+state_context]
		mov	[esp], eax
		call	_silc_packet_free
		mov	eax, 3
		leave
		retn
_silc_client_channel_message_error endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_channel_message_resolved(SilcClient client, SilcClientConnection conn, SilcStatus status, SilcDList clients,	void *context)
_silc_client_channel_message_resolved proc near
					; DATA XREF: _silc_client_channel_message+A9o

client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
clients		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		mov	edx, [ebp+clients]
		test	edx, edx
		jz	short loc_62B83930

loc_62B83909:				; CODE XREF: _silc_client_channel_message_resolved+48j
context_0 = ebx				; void *
		mov	al, [context_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+28h], dl
		test	al, 4
		jz	short loc_62B83920
		add	esp, 14h
		pop	context_0
		leave
		retn
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 10h

loc_62B83920:				; CODE XREF: _silc_client_channel_message_resolved+1Ej
		mov	[ebp+client], context_0
		add	esp, 14h
		pop	context_0
		leave
		jmp	_silc_fsm_continue
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 10h

loc_62B83930:				; CODE XREF: _silc_client_channel_message_resolved+Fj
		mov	dword ptr [esp+4], offset _silc_client_channel_message_error
		mov	[esp], context_0
		call	_silc_fsm_next
		jmp	short loc_62B83909
_silc_client_channel_message_resolved endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry   9. silc_client_add_to_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_add_to_channel(SilcClient client, SilcClientConnection conn, SilcChannelEntry channel, SilcClientEntry client_entry, SilcUInt32 cumode)
		public _silc_client_add_to_channel
_silc_client_add_to_channel proc near	; CODE XREF: _silc_client_notify_join+1E4p
					; _silc_client_command_reply_users+672p ...

var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h
client_entry	= dword	ptr  14h
cumode		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	edi, [ebp+conn]
		mov	esi, [ebp+channel]
		mov	ebx, [ebp+client_entry]
		lea	eax, [ebp+var_1C]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ebx
		mov	eax, [esi+134h]
		mov	[esp], eax
		call	_silc_hash_table_find
		test	al, al
		jz	short loc_62B8398C
conn_0 = edi				; SilcClientConnection
channel_0 = esi				; SilcChannelEntry
client_entry_0 = ebx			; SilcClientEntry
		mov	ecx, [ebp+var_1C]
		test	ecx, ecx
		jz	short loc_62B8398C

loc_62B83982:				; CODE XREF: _silc_client_add_to_channel+C8j
		mov	al, 1

loc_62B83984:				; CODE XREF: _silc_client_add_to_channel+D2j
		add	esp, 3Ch
		pop	client_entry_0
		pop	channel_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8398C:				; CODE XREF: _silc_client_add_to_channel+35j
					; _silc_client_add_to_channel+3Cj
conn_0 = edi				; SilcClientConnection
channel_0 = esi				; SilcChannelEntry
client_entry_0 = ebx			; SilcClientEntry
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	edx, eax
		test	eax, eax
		jz	short loc_62B83A14
		mov	[eax], client_entry_0
		mov	[eax+8], channel_0
		mov	eax, [ebp+cumode]
		mov	[edx+4], eax
		mov	[esp+8], client_entry_0	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_2C], edx
		call	_silc_client_ref_client
		mov	[esp+8], channel_0 ; channel_entry
		mov	[esp+4], conn_0	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_ref_channel
		mov	edx, [ebp+var_2C]
		mov	[esp+8], edx
		mov	[esp+4], client_entry_0
		mov	eax, [channel_0+134h]
		mov	[esp], eax
		call	_silc_hash_table_add
		mov	edx, [ebp+var_2C]
		mov	[esp+8], edx
		mov	[esp+4], channel_0
		mov	eax, [client_entry_0+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_add
		jmp	loc_62B83982
; ---------------------------------------------------------------------------
		align 4

loc_62B83A14:				; CODE XREF: _silc_client_add_to_channel+60j
		xor	eax, eax
		jmp	loc_62B83984
_silc_client_add_to_channel endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 192. silc_client_remove_from_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_remove_from_channel(SilcClient client, SilcClientConnection conn, SilcChannelEntry channel, SilcClientEntry client_entry)
		public _silc_client_remove_from_channel
_silc_client_remove_from_channel proc near ; CODE XREF:	_silc_client_notify_signoff+F7p
					; _silc_client_notify_leave+18Ap ...

var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h
client_entry	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [ebp+channel]
		mov	edi, [ebp+client_entry]
		lea	eax, [ebp+var_1C]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edi
		mov	eax, [ebx+134h]
		mov	[esp], eax
		call	_silc_hash_table_find
		test	al, al
		jz	loc_62B83B30
channel_0 = ebx				; SilcChannelEntry
client_entry_0 = edi			; SilcClientEntry
		mov	esi, [ebp+var_1C]
chu = esi				; SilcChannelUser
		test	chu, chu
		jz	loc_62B83B30
		mov	eax, [client_entry_0+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	eax, [channel_0+144h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	eax, [chu+8]
		mov	[esp+4], eax
		mov	eax, [chu]
		mov	eax, [eax+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_del
		mov	eax, [chu]
		mov	[esp+4], eax
		mov	eax, [chu+8]
		mov	eax, [eax+134h]
		mov	[esp], eax
		call	_silc_hash_table_del
		mov	[esp], chu
		call	_silc_free
		mov	eax, [channel_0+134h]
		mov	[esp], eax
		call	_silc_hash_table_count
		test	eax, eax
		jz	short loc_62B83B18

loc_62B83AC3:				; CODE XREF: _silc_client_remove_from_channel+112j
		mov	eax, [client_entry_0+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	eax, [channel_0+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	[esp+8], client_entry_0	; client_entry
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		mov	[esp+8], channel_0 ; channel_entry
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	al, 1
		add	esp, 2Ch
		pop	channel_0
		pop	chu
		pop	client_entry_0
		leave
		retn
; ---------------------------------------------------------------------------
channel_0 = ebx				; SilcChannelEntry
client_entry_0 = edi			; SilcClientEntry
chu = esi				; SilcChannelUser
		align 4

loc_62B83B18:				; CODE XREF: _silc_client_remove_from_channel+A5j
		mov	[esp+8], channel_0 ; channel
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_del_channel
		jmp	short loc_62B83AC3
; ---------------------------------------------------------------------------

loc_62B83B30:				; CODE XREF: _silc_client_remove_from_channel+32j
					; _silc_client_remove_from_channel+3Dj
		xor	eax, eax
		add	esp, 2Ch
		pop	channel_0
		pop	chu
		pop	client_entry_0
		leave
		retn
_silc_client_remove_from_channel endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 199. silc_client_send_channel_message

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_send_channel_message(SilcClient client, SilcClientConnection conn, SilcChannelEntry channel, SilcChannelPrivateKey key, SilcMessageFlags	flags, SilcHash	hash, unsigned __int8 *data, SilcUInt32	data_len)
		public _silc_client_send_channel_message
_silc_client_send_channel_message proc near

var_78		= dword	ptr -78h
hmac		= dword	ptr -74h
cipher		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
rid		= SilcID ptr -5Ch
sid		= SilcID ptr -3Ch
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h
key		= dword	ptr  14h
flags		= dword	ptr  18h
hash		= dword	ptr  1Ch
data		= dword	ptr  20h
data_len	= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ACh
		mov	ebx, [ebp+conn]
		mov	edx, [ebp+channel]
		mov	esi, [ebp+key]
		mov	eax, [ebp+flags]
		mov	ecx, [ebp+client]
		test	ecx, ecx
		jz	loc_62B83D58
conn_0 = ebx				; SilcClientConnection
channel_0 = edx				; SilcChannelEntry
key_0 =	esi				; SilcChannelPrivateKey
flags_0	= eax				; SilcMessageFlags
		test	conn_0,	conn_0
		jz	loc_62B83D58
		test	channel_0, channel_0
		jz	loc_62B83D58
		movzx	flags_0, ax
		mov	[ebp+var_6C], eax
		test	al, 20h
		jnz	loc_62B83D4E

loc_62B83B7D:				; CODE XREF: _silc_client_send_channel_message+216j
		mov	eax, [conn_0+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B83D58
		lea	eax, [ebp+var_1C]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	eax, [conn_0]
		mov	[esp+4], eax
		mov	eax, [channel_0+134h]
		mov	[esp], eax
		mov	[ebp+var_78], channel_0
		call	_silc_hash_table_find
		test	al, al
		mov	edx, [ebp+var_78]
		jz	loc_62B83D84
		mov	eax, [ebp+var_1C]
chu = eax				; SilcChannelUser
		test	chu, chu
		jz	loc_62B83D84
		mov	ecx, [edx+12Ch]
		test	ch, 4
		jnz	loc_62B83E58

loc_62B83BD8:				; CODE XREF: _silc_client_send_channel_message+320j
channel_0 = edx				; SilcChannelEntry
		test	ch, 8
		jnz	loc_62B83E69

loc_62B83BE1:				; CODE XREF: _silc_client_send_channel_message+336j
		test	byte ptr [chu+4], 20h
		jnz	loc_62B83D58
		mov	edi, [channel_0+150h]
		test	edi, edi
		jz	loc_62B83D6D
		test	key_0, key_0
		jz	loc_62B83D68
		mov	ecx, [key_0+4]
		mov	[ebp+cipher], ecx
		mov	key_0, [key_0+0Ch]
		mov	[ebp+hmac], esi

loc_62B83C0D:				; CODE XREF: _silc_client_send_channel_message+243j
					; _silc_client_send_channel_message+28Aj ...
		mov	edi, [ebp+cipher]
		test	edi, edi
		jz	loc_62B83E2A
		mov	esi, [ebp+hmac]
		test	esi, esi
		jz	loc_62B83E2A
		mov	[ebp+sid.type],	2
		mov	esi, [chu]
		lea	edi, [ebp+sid]
		add	esi, 38Ch
		mov	ecx, 1Dh
		rep movsb
		mov	[ebp+rid.type],	3
		mov	esi, [chu+8]
		lea	edi, [ebp+rid]
		add	esi, 114h
		mov	cl, 16h
		rep movsb
		mov	dword ptr [esp+34h], 0
		lea	chu, [ebp+rid]
		mov	[esp+30h], eax
		lea	eax, [ebp+sid]
		mov	[esp+2Ch], eax
		mov	eax, [ebp+hash]
		mov	[esp+28h], eax
		mov	eax, [conn_0+38h]
		mov	[esp+24h], eax
		mov	dword ptr [esp+20h], 0
		mov	ecx, [ebp+client]
		mov	eax, [ecx+10h]
		mov	[esp+1Ch], eax
		mov	esi, [ebp+hmac]
		mov	[esp+18h], esi
		mov	eax, [ebp+cipher]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	eax, [ebp+data_len]
		mov	[esp+8], eax
		mov	eax, [ebp+data]
		mov	[esp+4], eax
		mov	ecx, [ebp+var_6C]
		mov	[esp], ecx
		mov	[ebp+var_78], channel_0
		call	_silc_message_payload_encode
		mov	esi, eax
buffer = esi				; SilcBuffer
		test	eax, eax
		mov	edx, [ebp+var_78]
		jz	loc_62B83E7F
buffer = eax				; SilcBuffer
		mov	ecx, [buffer+4]
		mov	dword ptr [esp+28h], 0
		mov	dword ptr [esp+24h], 0
		mov	buffer,	[buffer+8]
buffer = esi				; SilcBuffer
		sub	eax, ecx
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		add	edx, 114h
		mov	[esp+18h], edx
		mov	dword ptr [esp+14h], 3
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 7
		mov	eax, [conn_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_send_ext
		mov	edx, [buffer]
		mov	[esp], edx
		mov	byte ptr [ebp+var_78], al
		call	_silc_free
		mov	[esp], buffer
		call	_silc_free
		mov	al, byte ptr [ebp+var_78]

loc_62B83D43:				; CODE XREF: _silc_client_send_channel_message+26Fj
					; _silc_client_send_channel_message+30Cj
		add	esp, 0ACh
		pop	conn_0
		pop	buffer
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B83D4E:				; CODE XREF: _silc_client_send_channel_message+3Bj
conn_0 = ebx				; SilcClientConnection
channel_0 = edx				; SilcChannelEntry
key_0 =	esi				; SilcChannelPrivateKey
		cmp	[ebp+hash], 0
		jnz	loc_62B83B7D

loc_62B83D58:				; CODE XREF: _silc_client_send_channel_message+1Dj
					; _silc_client_send_channel_message+25j ...
chu = eax				; SilcChannelUser
		xor	chu, chu

loc_62B83D5A:				; CODE XREF: _silc_client_send_channel_message+328j
					; _silc_client_send_channel_message+33Ej
		add	esp, 0ACh
		pop	conn_0
		pop	key_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
key_0 =	esi				; SilcChannelPrivateKey
chu = eax				; SilcChannelUser
		align 4

loc_62B83D68:				; CODE XREF: _silc_client_send_channel_message+BFj
		and	ecx, 4
		jnz	short loc_62B83DB0

loc_62B83D6D:				; CODE XREF: _silc_client_send_channel_message+B7j
		mov	ecx, [channel_0+158h]
		mov	[ebp+cipher], ecx
		mov	key_0, [channel_0+160h]
		mov	[ebp+hmac], esi
		jmp	loc_62B83C0D
; ---------------------------------------------------------------------------

loc_62B83D84:				; CODE XREF: _silc_client_send_channel_message+7Cj
					; _silc_client_send_channel_message+87j
key_0 =	esi				; SilcChannelPrivateKey
		mov	edx, [ebp+client]
		mov	chu, [edx+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aCannotTalkToCh ; "Cannot talk to channel: not joined"
		mov	dword ptr [esp+8], 4
		mov	[esp+4], conn_0
		mov	edx, [conn_0+4Ch]
		mov	[esp], edx
		call	dword ptr [eax]
		xor	eax, eax
ret = eax				; SilcBool
		jmp	short loc_62B83D43
; ---------------------------------------------------------------------------
channel_0 = edx				; SilcChannelEntry
chu = eax				; SilcChannelUser
		align 10h

loc_62B83DB0:				; CODE XREF: _silc_client_send_channel_message+22Fj
		mov	ecx, [channel_0+154h]
		test	ecx, ecx
		jz	short loc_62B83DCB
		mov	key_0, [ecx+4]
		mov	[ebp+cipher], esi
		mov	ecx, [ecx+0Ch]
		mov	[ebp+hmac], ecx
		jmp	loc_62B83C0D
; ---------------------------------------------------------------------------

loc_62B83DCB:				; CODE XREF: _silc_client_send_channel_message+27Cj
key_0 =	esi				; SilcChannelPrivateKey
		mov	ecx, [edi]
		mov	[edi+8], ecx
		and	byte ptr [edi+10h], 0FDh
		mov	dword ptr [edi+18h], 0
		mov	dword ptr [edi+14h], 0
		mov	key_0, [channel_0+150h]
		mov	ecx, [esi+14h]
		mov	[esi+18h], ecx
		mov	edi, [esi+8]
		test	edi, edi
		jz	short loc_62B83E4D
		test	byte ptr [esi+10h], 2
		jz	short loc_62B83E21
		movzx	ecx, word ptr [esi+0Eh]
		mov	ecx, [edi+ecx]

loc_62B83E02:				; CODE XREF: _silc_client_send_channel_message+2ECj
		mov	[esi+8], ecx
		mov	[esi+14h], edi
		mov	ecx, [edi]

loc_62B83E0A:				; CODE XREF: _silc_client_send_channel_message+31Aj
		mov	esi, [ecx+4]
		mov	[ebp+cipher], esi
		mov	esi, [ecx+0Ch]
		mov	[ebp+hmac], esi
		mov	[channel_0+154h], ecx
		jmp	loc_62B83C0D
; ---------------------------------------------------------------------------

loc_62B83E21:				; CODE XREF: _silc_client_send_channel_message+2BDj
		movzx	ecx, word ptr [esi+0Ch]
		mov	ecx, [edi+ecx]
		jmp	short loc_62B83E02
; ---------------------------------------------------------------------------

loc_62B83E2A:				; CODE XREF: _silc_client_send_channel_message+D6j
					; _silc_client_send_channel_message+E1j
		mov	dword ptr [esp], offset	aNoCipherAndHma	; "No cipher and HMAC for channel"

loc_62B83E31:				; CODE XREF: _silc_client_send_channel_message+34Aj
buffer = eax				; SilcBuffer
		call	_silc_format
buffer = esi				; SilcBuffer
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		xor	eax, eax
ret = eax				; SilcBool
		jmp	loc_62B83D43
; ---------------------------------------------------------------------------

loc_62B83E4D:				; CODE XREF: _silc_client_send_channel_message+2B7j
channel_0 = edx				; SilcChannelEntry
chu = eax				; SilcChannelUser
		mov	dword ptr [esi+14h], 0
		xor	ecx, ecx
		jmp	short loc_62B83E0A
; ---------------------------------------------------------------------------

loc_62B83E58:				; CODE XREF: _silc_client_send_channel_message+96j
key_0 =	esi				; SilcChannelPrivateKey
		cmp	dword ptr [chu+4], 0
		jnz	loc_62B83BD8
		xor	chu, chu
ret = eax				; SilcBool
		jmp	loc_62B83D5A
; ---------------------------------------------------------------------------

loc_62B83E69:				; CODE XREF: _silc_client_send_channel_message+9Fj
chu = eax				; SilcChannelUser
		mov	edi, [chu+4]
		and	edi, 3
		cmp	edi, 2
		jnz	loc_62B83BE1
		xor	chu, chu
ret = eax				; SilcBool
		jmp	loc_62B83D5A
; ---------------------------------------------------------------------------

loc_62B83E7F:				; CODE XREF: _silc_client_send_channel_message+18Cj
buffer = eax				; SilcBuffer ; "Error encoding channel message"
		mov	dword ptr [esp], offset	aErrorEncodingC
		jmp	short loc_62B83E31
_silc_client_send_channel_message endp

; Exported entry  18. silc_client_channel_message

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_channel_message(SilcFSMObject	*fsm, void *fsm_context, void *state_context)
		public _silc_client_channel_message
_silc_client_channel_message proc near	; DATA XREF: _silc_client_connection_st_packet:loc_62B81ECCo

channel_entry	= dword	ptr -8Ch
var_70		= dword	ptr -70h
client_entry	= dword	ptr -6Ch
var_68		= dword	ptr -68h
conn		= dword	ptr -64h
cipher		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
remote_id	= SilcClientID ptr -53h
channel_id	= SilcChannelID	ptr -36h
var_20		= dword	ptr -20h
message_len	= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0DCh
		mov	esi, [ebp+fsm_context]
		mov	ebx, [ebp+state_context]
		mov	edi, [esi+4Ch]
client = edi				; SilcClient
		mov	al, [ebx+21h]
		and	eax, 0FFFFFFC0h
		cmp	al, 0C0h
		jnz	loc_62B8455B
fsm_context_0 =	esi			; void *
state_context_0	= ebx			; void *
		mov	dword ptr [esp+10h], 1Dh
		lea	edx, [ebp+remote_id]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 2
		mov	al, [state_context_0+20h]
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [state_context_0+18h]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jz	loc_62B84541
		lea	eax, [ebp+remote_id]
		mov	[esp+8], eax	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id
		mov	edx, eax
client_entry = edx			; SilcClientEntry
		test	eax, eax
		jz	short loc_62B83F01
client_entry = eax			; SilcClientEntry
		test	byte ptr [client_entry+402h], 1
		jnz	short loc_62B83F74

loc_62B83F01:				; CODE XREF: _silc_client_channel_message+6Ej
		mov	[esp+8], edx	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B84074

loc_62B83F2A:				; CODE XREF: _silc_client_channel_message+218j
		mov	state_context_0, [ebp+fsm]
		mov	[esp+14h], ebx	; context
		mov	dword ptr [esp+10h], offset _silc_client_channel_message_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		lea	eax, [ebp+remote_id]
		mov	[esp+8], eax	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id_resolve
		mov	dl, [ebx+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[ebx+28h], dl
		shl	eax, 1
		and	eax, 2

loc_62B83F67:				; CODE XREF: _silc_client_channel_message+451j
					; _silc_client_channel_message+499j ...
		add	esp, 0DCh
		pop	ebx
		pop	fsm_context_0
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
state_context_0	= ebx			; void *
client_entry = eax			; SilcClientEntry
client = edi				; SilcClient
		align 4

loc_62B83F74:				; CODE XREF: _silc_client_channel_message+77j
		mov	dword ptr [esp+10h], 16h
		lea	ecx, [ebp+channel_id]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 3
		mov	al, [state_context_0+21h]
client_entry = edx			; SilcClientEntry
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [state_context_0+1Ch]
		mov	[esp], eax
		mov	[ebp+client_entry], client_entry
		mov	[ebp+var_70], ecx
		call	_silc_id_str2id
		test	al, al
		mov	edx, [ebp+client_entry]
		mov	ecx, [ebp+var_70]
		jz	loc_62B84575
		mov	[esp+8], ecx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+client_entry], edx
		call	_silc_client_get_channel_by_id
		mov	[ebp+channel_entry], eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	loc_62B84541
		lea	eax, [ebp+var_20]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
client_entry = edx			; SilcClientEntry
		mov	ecx, [ebp+channel_entry]
		mov	eax, [ecx+134h]
		mov	[esp], eax
		mov	[ebp+client_entry], client_entry
		call	_silc_hash_table_find
		test	al, al
		mov	edx, [ebp+client_entry]
		jz	loc_62B842A8
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	loc_62B842A8
		mov	eax, [ebp+channel_entry]
		mov	eax, [eax+150h]
		mov	[ebp+var_5C], eax
		test	eax, eax
		jz	loc_62B84344
		mov	eax, [ebp+channel_entry]
		test	byte ptr [eax+12Ch], 4
		jz	loc_62B84160

loc_62B84042:				; CODE XREF: _silc_client_channel_message+72Aj
		mov	eax, [ebp+var_5C]
		mov	eax, [eax]
		mov	ecx, [ebp+var_5C]
		mov	[ecx+8], eax
		and	byte ptr [ecx+10h], 0FDh
		mov	dword ptr [ecx+18h], 0
		mov	dword ptr [ecx+14h], 0
		mov	[ebp+var_5C], edx
client_entry = edx			; SilcClientEntry
		mov	[ebp+cipher], client
		mov	[ebp+conn], fsm_context_0
		mov	fsm_context_0, [ebp+channel_entry]
channel	= esi				; SilcChannelEntry
		jmp	loc_62B84133
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
		align 4

loc_62B84074:				; CODE XREF: _silc_client_channel_message+9Cj
		mov	dword ptr [esp+8], 0C5h
		mov	dword ptr [esp+4], offset aClient_channel ; "client_channel.c"
		mov	dword ptr [esp], offset	aSilc_verifySD ; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B83F2A
; ---------------------------------------------------------------------------
channel	= esi				; SilcChannelEntry
key = edi				; SilcChannelPrivateKey
		align 4

loc_62B840A8:				; CODE XREF: _silc_client_channel_message+2C6j
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B840AF:				; CODE XREF: _silc_client_channel_message+2D3j
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	key, [edx]
		test	key, key
		jz	loc_62B8458F
		mov	edx, [state_context_0+0Ch]
		mov	dword ptr [esp+30h], 0
		mov	dword ptr [esp+2Ch], 0
		mov	dword ptr [esp+28h], 0
		mov	al, [state_context_0+21h]
		and	eax, 3Fh
		mov	[esp+24h], eax
		mov	eax, [state_context_0+1Ch]
		mov	[esp+20h], eax
		mov	al, [state_context_0+20h]
		and	eax, 3Fh
		mov	[esp+1Ch], eax
		mov	eax, [state_context_0+18h]
		mov	[esp+18h], eax
		mov	eax, [key+0Ch]
		mov	[esp+14h], eax
		mov	eax, [key+8]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [state_context_0+10h]
		sub	eax, edx
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_message_payload_parse
		test	eax, eax
payload	= eax				; SilcMessagePayload
		jnz	loc_62B84328

loc_62B84133:				; CODE XREF: _silc_client_channel_message+1E6j
client_entry = edx			; SilcClientEntry
		mov	payload, [channel+150h]
		mov	client_entry, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	loc_62B842E0
		test	byte ptr [eax+10h], 2
		jnz	loc_62B840A8
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	loc_62B840AF
; ---------------------------------------------------------------------------

loc_62B84160:				; CODE XREF: _silc_client_channel_message+1B4j
fsm_context_0 =	esi			; void *
client = edi				; SilcClient
		mov	ecx, [state_context_0+0Ch]
		mov	dword ptr [esp+30h], 0
		mov	dword ptr [esp+2Ch], 0
		mov	dword ptr [esp+28h], 0
		mov	al, [state_context_0+21h]
		and	eax, 3Fh
		mov	[esp+24h], eax
		mov	eax, [state_context_0+1Ch]
		mov	[esp+20h], eax
		mov	al, [state_context_0+20h]
		and	eax, 3Fh
		mov	[esp+1Ch], eax
		mov	eax, [state_context_0+18h]
		mov	[esp+18h], eax
		mov	eax, [ebp+channel_entry]
		mov	eax, [eax+160h]
		mov	[esp+14h], eax
		mov	eax, [ebp+channel_entry]
		mov	eax, [eax+15Ch]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [state_context_0+10h]
		sub	eax, ecx
		mov	[esp+4], eax
		mov	[esp], ecx
		mov	[ebp+client_entry], edx
		call	_silc_message_payload_parse
		mov	[ebp+var_5C], eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	loc_62B845A3

loc_62B841EF:				; CODE XREF: _silc_client_channel_message+545j
					; _silc_client_channel_message+6B4j
payload	= eax				; SilcMessagePayload
client_entry = edx			; SilcClientEntry
		mov	[ebp+var_68], 0

loc_62B841F6:				; CODE XREF: _silc_client_channel_message+4B5j
		lea	payload, [ebp+message_len]
		mov	[esp+4], eax
		mov	eax, [ebp+var_5C]
		mov	[esp], eax
		mov	[ebp+client_entry], client_entry
		call	_silc_message_get_data
		mov	[ebp+cipher], eax
		mov	eax, [client+18h]
		mov	eax, [eax+48h]
		mov	eax, [eax+4]
		mov	[ebp+conn], eax
		mov	ebx, [ebp+message_len]
		mov	ecx, [ebp+var_5C]
		mov	[esp], ecx
		call	_silc_message_get_flags
		mov	[esp+20h], ebx
		mov	ebx, [ebp+cipher]
		mov	[esp+1Ch], ebx
		movzx	eax, ax
		mov	[esp+18h], eax
		mov	eax, [ebp+var_68]
		mov	[esp+14h], eax
		mov	ecx, [ebp+var_5C]
		mov	[esp+10h], ecx
		mov	ebx, [ebp+channel_entry]
		mov	[esp+0Ch], ebx
		mov	edx, [ebp+client_entry]
		mov	[esp+8], edx
client_entry = edx			; SilcClientEntry
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		call	[ebp+conn]

out:
		mov	edx, [ebp+client_entry]
		mov	[esp+8], edx	; client_entry
client_entry = edx			; SilcClientEntry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	[esp+8], ebx	; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		mov	ebx, [ebp+var_5C]
		test	ebx, ebx
		jz	short loc_62B84298
		mov	eax, [ebp+var_5C]
		mov	[esp], eax
		call	_silc_message_payload_free

loc_62B84298:				; CODE XREF: _silc_client_channel_message+403j
		mov	eax, 3
		add	esp, 0DCh
		pop	ebx
		pop	fsm_context_0
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B842A8:				; CODE XREF: _silc_client_channel_message+17Fj
					; _silc_client_channel_message+18Aj
fsm_context_0 =	esi			; void * ; "Message from user not on channel, clien"...
state_context_0	= ebx			; void *
client = edi				; SilcClient
		mov	dword ptr [esp], offset	aMessageFromUse
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 2
		call	_silc_log_output
		mov	dword ptr [esp+4], offset _silc_client_channel_message_error
		mov	state_context_0, [ebp+fsm]
		mov	[esp], ebx
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B83F67
; ---------------------------------------------------------------------------
state_context_0	= ebx			; void *
channel	= esi				; SilcChannelEntry
key = edi				; SilcChannelPrivateKey
		align 10h

loc_62B842E0:				; CODE XREF: _silc_client_channel_message+2BCj
		mov	edx, [ebp+var_5C]
client_entry = edx			; SilcClientEntry
		mov	[ebp+channel_entry], channel
		mov	key, [ebp+cipher]
client = edi				; SilcClient
		mov	channel, [ebp+conn]
fsm_context_0 =	esi			; void *
		mov	dword ptr [eax+14h], 0

loc_62B842F6:				; CODE XREF: _silc_client_channel_message+716j
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	eax, [ebp+channel_entry]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		mov	eax, 3
		jmp	loc_62B83F67
; ---------------------------------------------------------------------------
payload	= eax				; SilcMessagePayload
channel	= esi				; SilcChannelEntry
key = edi				; SilcChannelPrivateKey
		align 4

loc_62B84328:				; CODE XREF: _silc_client_channel_message+2A5j
		mov	[ebp+var_68], key
		mov	edx, [ebp+var_5C]
client_entry = edx			; SilcClientEntry
		mov	[ebp+channel_entry], channel
		mov	[ebp+var_5C], payload
		mov	key, [ebp+cipher]
client = edi				; SilcClient
		mov	channel, [ebp+conn]
fsm_context_0 =	esi			; void *
		jmp	loc_62B841F6
; ---------------------------------------------------------------------------
		align 4

loc_62B84344:				; CODE XREF: _silc_client_channel_message+1A1j
		mov	ecx, [state_context_0+0Ch]
		mov	dword ptr [esp+30h], 0
		mov	dword ptr [esp+2Ch], 0
		mov	dword ptr [esp+28h], 0
		mov	al, [state_context_0+21h]
		and	eax, 3Fh
		mov	[esp+24h], eax
		mov	eax, [state_context_0+1Ch]
		mov	[esp+20h], eax
		mov	al, [state_context_0+20h]
		and	eax, 3Fh
		mov	[esp+1Ch], eax
		mov	eax, [state_context_0+18h]
		mov	[esp+18h], eax
		mov	eax, [ebp+channel_entry]
		mov	eax, [eax+160h]
		mov	[esp+14h], eax
		mov	eax, [ebp+channel_entry]
		mov	eax, [eax+15Ch]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [state_context_0+10h]
		sub	eax, ecx
		mov	[esp+4], eax
		mov	[esp], ecx
		mov	[ebp+client_entry], edx
		call	_silc_message_payload_parse
		mov	[ebp+var_5C], eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jnz	loc_62B841EF
		mov	ecx, [ebp+channel_entry]
		mov	ecx, [ecx+148h]
		mov	[ebp+var_5C], ecx
		test	ecx, ecx
		jz	loc_62B845D6
		mov	eax, ecx
		mov	ecx, [ecx+10h]
		shr	ecx, 2
		jz	loc_62B845D6
		mov	ecx, [eax+4]
		mov	[eax+8], ecx
		or	byte ptr [eax+10h], 2
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+channel_entry]
		mov	eax, [eax+14Ch]
		mov	[ebp+var_5C], eax
		mov	ecx, [eax+4]
		mov	[eax+8], ecx
		or	byte ptr [eax+10h], 2
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	[ebp+var_68], edx
client_entry = edx			; SilcClientEntry
		mov	eax, [ebp+channel_entry]
		mov	[ebp+var_5C], eax

loc_62B84443:				; CODE XREF: _silc_client_channel_message+69Fj
payload	= eax				; SilcMessagePayload
		mov	client_entry, [ebp+var_5C]
		mov	payload, [edx+148h]
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	loc_62B84614
		test	byte ptr [eax+10h], 2
		jz	loc_62B84629
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B8446E:				; CODE XREF: _silc_client_channel_message+7A8j
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	edx, [edx]
		mov	[ebp+cipher], edx
		test	edx, edx
		jz	loc_62B84606
		mov	edx, [ebp+var_5C]
		mov	eax, [edx+14Ch]
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	loc_62B845C3
		test	byte ptr [eax+10h], 2
		jz	loc_62B845B7
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B844AC:				; CODE XREF: _silc_client_channel_message+736j
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	eax, [edx]
hmac = eax				; SilcHmac
		test	hmac, hmac
		jz	loc_62B84606
		mov	ecx, [state_context_0+0Ch]
		mov	dword ptr [esp+30h], 0
		mov	dword ptr [esp+2Ch], 0
		mov	dword ptr [esp+28h], 0
		mov	dl, [state_context_0+21h]
		and	edx, 3Fh
		mov	[esp+24h], edx
		mov	edx, [state_context_0+1Ch]
		mov	[esp+20h], edx
		mov	dl, [state_context_0+20h]
		and	edx, 3Fh
		mov	[esp+1Ch], edx
		mov	edx, [state_context_0+18h]
		mov	[esp+18h], edx
		mov	[esp+14h], hmac
		mov	hmac, [ebp+cipher]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [state_context_0+10h]
		sub	eax, ecx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	_silc_message_payload_parse
		test	eax, eax
payload	= eax				; SilcMessagePayload
		jz	loc_62B84443
		mov	edx, [ebp+var_68]
client_entry = edx			; SilcClientEntry
		mov	state_context_0, [ebp+var_5C]
		mov	[ebp+channel_entry], ebx
		mov	[ebp+var_5C], payload
		jmp	loc_62B841EF
; ---------------------------------------------------------------------------

loc_62B84541:				; CODE XREF: _silc_client_channel_message+51j
					; _silc_client_channel_message+14Aj
state_context_0	= ebx			; void *
		mov	dword ptr [esp+4], offset _silc_client_channel_message_error
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B83F67
; ---------------------------------------------------------------------------

loc_62B8455B:				; CODE XREF: _silc_client_channel_message+1Dj
		mov	dword ptr [esp+4], offset _silc_client_channel_message_error
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B83F67
; ---------------------------------------------------------------------------

loc_62B84575:				; CODE XREF: _silc_client_channel_message+126j
		mov	dword ptr [esp+4], offset _silc_client_channel_message_error
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B83F67
; ---------------------------------------------------------------------------

loc_62B8458F:				; CODE XREF: _silc_client_channel_message+231j
channel	= esi				; SilcChannelEntry
key = edi				; SilcChannelPrivateKey
		mov	edx, [ebp+var_5C]
client_entry = edx			; SilcClientEntry
		mov	[ebp+channel_entry], channel
		mov	key, [ebp+cipher]
client = edi				; SilcClient
		mov	channel, [ebp+conn]
fsm_context_0 =	esi			; void *
		jmp	loc_62B842F6
; ---------------------------------------------------------------------------

loc_62B845A3:				; CODE XREF: _silc_client_channel_message+361j
		mov	ecx, [ebp+channel_entry]
		mov	ecx, [ecx+150h]
		mov	[ebp+var_5C], ecx
		jmp	loc_62B84042
; ---------------------------------------------------------------------------

loc_62B845B7:				; CODE XREF: _silc_client_channel_message+617j
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	loc_62B844AC
; ---------------------------------------------------------------------------

loc_62B845C3:				; CODE XREF: _silc_client_channel_message+60Dj
		mov	edx, [ebp+var_68]
client_entry = edx			; SilcClientEntry
		mov	ecx, [ebp+var_5C]
		mov	[ebp+channel_entry], ecx
		mov	dword ptr [eax+14h], 0

loc_62B845D6:				; CODE XREF: _silc_client_channel_message+55Cj
					; _silc_client_channel_message+56Aj ...
hmac = eax				; SilcHmac ; client_entry
		mov	[esp+8], client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	ebx, [ebp+channel_entry]
		mov	[esp+8], ebx	; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		mov	eax, 3
		jmp	loc_62B83F67
; ---------------------------------------------------------------------------

loc_62B84606:				; CODE XREF: _silc_client_channel_message+5F3j
					; _silc_client_channel_message+62Ej
state_context_0	= ebx			; void *
hmac = eax				; SilcHmac
		mov	edx, [ebp+var_68]
client_entry = edx			; SilcClientEntry
		mov	ecx, [ebp+var_5C]
		mov	[ebp+channel_entry], ecx
		jmp	short loc_62B845D6
; ---------------------------------------------------------------------------

loc_62B84614:				; CODE XREF: _silc_client_channel_message+5CFj
		mov	edx, [ebp+var_68]
client_entry = edx			; SilcClientEntry
		mov	state_context_0, [ebp+var_5C]
		mov	[ebp+channel_entry], ebx
		mov	dword ptr [eax+14h], 0
		jmp	short loc_62B845D6
; ---------------------------------------------------------------------------

loc_62B84629:				; CODE XREF: _silc_client_channel_message+5D9j
state_context_0	= ebx			; void *
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	loc_62B8446E
_silc_client_channel_message endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 197. silc_client_save_channel_key

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_save_channel_key(SilcClient client, SilcClientConnection	conn, SilcBuffer key_payload, SilcChannelEntry channel)
		public _silc_client_save_channel_key
_silc_client_save_channel_key proc near	; CODE XREF: _silc_client_channel_key+26p
					; _silc_client_command_reply_join+BFDp

var_9C		= dword	ptr -9Ch
var_8C		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
hash		= byte ptr -72h
id		= SilcChannelID	ptr -32h
tmp_len		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
key_payload	= dword	ptr  10h
channel		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0BCh
		mov	eax, [ebp+key_payload]
		mov	ebx, [ebp+channel]
		mov	edx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, edx
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_channel_key_payload_parse
		mov	esi, eax
payload	= esi				; SilcChannelKeyPayload
		test	eax, eax
		jz	loc_62B849EA
channel_0 = ebx				; SilcChannelEntry
payload	= eax				; SilcChannelKeyPayload
		lea	payload, [ebp+tmp_len]
payload	= esi				; SilcChannelKeyPayload
		mov	[esp+4], eax
		mov	[esp], payload
		call	_silc_channel_key_get_id
		test	eax, eax
id_string = eax				; unsigned __int8 *
		jz	loc_62B849E2
		mov	dword ptr [esp+10h], 16h
		lea	edi, [ebp+id]
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 3
		mov	edx, [ebp+tmp_len]
		mov	[esp+4], edx
		mov	[esp], id_string
		call	_silc_id_str2id
		test	al, al
		jz	loc_62B849E2
		test	channel_0, channel_0
		jz	loc_62B84A18
		mov	[esp+8], channel_0 ; channel_entry
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_ref_channel

loc_62B846CB:				; CODE XREF: _silc_client_save_channel_key+3FAj
		mov	ecx, [channel_0+148h]
		test	ecx, ecx
		jz	loc_62B84AD0

loc_62B846D9:				; CODE XREF: _silc_client_save_channel_key+4A3j
		mov	edx, [channel_0+14Ch]
		test	edx, edx
		jz	loc_62B84AE0

loc_62B846E7:				; CODE XREF: _silc_client_save_channel_key+4B3j
		mov	edi, [channel_0+148h]
		test	edi, edi
		jz	loc_62B847FB
		mov	eax, [channel_0+14Ch]
		test	eax, eax
		jz	loc_62B847FB
		mov	edx, [channel_0+15Ch]
		mov	dword ptr [esp], 0Ch
		mov	[ebp+var_7C], edx
		call	_silc_malloc
		test	eax, eax
		mov	edx, [ebp+var_7C]
		jz	short loc_62B8475F
		mov	[eax], edx
		mov	ecx, [edi]
		test	ecx, ecx
		jz	loc_62B84AA8
		movzx	edx, word ptr [edi+0Ch]
		mov	[ebp+var_9C], edx
		mov	edx, [edi+4]
		mov	ecx, [ebp+var_9C]
		mov	[edx+ecx], eax

loc_62B84741:				; CODE XREF: _silc_client_save_channel_key+47Cj
		test	byte ptr [edi+10h], 1
		jnz	loc_62B84A08

loc_62B8474B:				; CODE XREF: _silc_client_save_channel_key+3DAj
		mov	[edi+4], eax
		mov	edx, [ebp+var_9C]
		mov	dword ptr [eax+edx], 0
		add	dword ptr [edi+10h], 4

loc_62B8475F:				; CODE XREF: _silc_client_save_channel_key+E5j
		mov	edx, [channel_0+160h]
		mov	edi, [channel_0+14Ch]
		mov	dword ptr [esp], 0Ch
		mov	[ebp+var_7C], edx
		call	_silc_malloc
		test	eax, eax
		mov	edx, [ebp+var_7C]
		jz	short loc_62B847C1
		mov	[eax], edx
		mov	edx, [edi]
		test	edx, edx
		jz	loc_62B84ABC
		movzx	edx, word ptr [edi+0Ch]
		mov	[ebp+var_9C], edx
		mov	edx, [edi+4]
		mov	ecx, [ebp+var_9C]
		mov	[edx+ecx], eax

loc_62B847A3:				; CODE XREF: _silc_client_save_channel_key+490j
		test	byte ptr [edi+10h], 1
		jnz	loc_62B849F8

loc_62B847AD:				; CODE XREF: _silc_client_save_channel_key+3CAj
		mov	[edi+4], eax
		mov	edx, [ebp+var_9C]
		mov	dword ptr [eax+edx], 0
		add	dword ptr [edi+10h], 4

loc_62B847C1:				; CODE XREF: _silc_client_save_channel_key+147j
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0Fh
		mov	[esp+0Ch], channel_0
		mov	dword ptr [esp+8], offset _silc_client_save_channel_key_rekey
		mov	dword ptr [esp+4], 0
		mov	ecx, [ebp+client]
		mov	eax, [ecx+0Ch]
		mov	[esp], eax
		call	_silc_schedule_task_add

loc_62B847FB:				; CODE XREF: _silc_client_save_channel_key+B7j
					; _silc_client_save_channel_key+C5j
		mov	dword ptr [esp+4], 0
		mov	[esp], payload
		call	_silc_channel_key_get_cipher
		mov	edi, eax
cipher = edi				; unsigned __int8 *
		lea	eax, [channel_0+158h]
		mov	[esp+4], eax
		mov	[esp], cipher
		call	_silc_cipher_alloc
		test	al, al
		jz	loc_62B849A0
		lea	eax, [channel_0+15Ch]
		mov	[esp+4], eax
		mov	[esp], cipher
		call	_silc_cipher_alloc
		test	al, al
		jz	loc_62B84A50
		lea	ecx, [ebp+tmp_len]
		mov	[esp+4], ecx
		mov	[esp], payload
		call	_silc_channel_key_get_key
		mov	cipher,	eax
key = edi				; unsigned __int8 *
		mov	dword ptr [esp+0Ch], 1
		mov	eax, [ebp+tmp_len]
		shl	eax, 3
		mov	[esp+8], eax
		mov	[esp+4], key
		mov	eax, [channel_0+158h]
		mov	[esp], eax
		call	_silc_cipher_set_key
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+tmp_len]
		shl	eax, 3
		mov	[esp+8], eax
		mov	[esp+4], key
		mov	eax, [channel_0+15Ch]
		mov	[esp], eax
		call	_silc_cipher_set_key
		mov	eax, [channel_0+160h]
		test	eax, eax
		jz	loc_62B84A44
		mov	[esp], eax
		call	_silc_hmac_get_name
		mov	edx, eax

loc_62B848B2:				; CODE XREF: _silc_client_save_channel_key+411j
hmac = edx				; unsigned __int8 *
		lea	eax, [channel_0+160h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	[esp], hmac
		mov	[ebp+var_7C], hmac
		call	_silc_hmac_alloc
		test	al, al
		mov	edx, [ebp+var_7C]
		jz	loc_62B84A7C
		mov	eax, [channel_0+158h]
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	[channel_0+138h], eax
		mov	eax, [channel_0+160h]
		mov	[esp], eax
		call	_silc_hmac_get_name
		mov	[channel_0+13Ch], eax
		mov	edx, [ebp+tmp_len]
		mov	eax, [channel_0+160h]
		mov	[esp], eax
		mov	[ebp+var_7C], edx
		call	_silc_hmac_get_hash
		lea	ecx, [ebp+hash]
		mov	[ebp+var_8C], ecx
		mov	[esp+0Ch], ecx
		mov	edx, [ebp+var_7C]
		mov	[esp+8], edx
		mov	[esp+4], key
		mov	[esp], eax
		call	_silc_hash_make
		mov	eax, [channel_0+160h]
		mov	[esp], eax
		call	_silc_hmac_get_hash
		mov	[esp], eax
		call	_silc_hash_len
		mov	[esp+8], eax
		lea	eax, [ebp+hash]
		mov	[esp+4], eax
		mov	eax, [channel_0+160h]
		mov	[esp], eax
		call	_silc_hmac_set_key
		mov	ecx, 40h
		xor	eax, eax
		mov	key, [ebp+var_8C]
		rep stosb
		mov	[esp], payload
		call	_silc_channel_key_payload_free
		mov	[esp+8], channel_0 ; channel_entry
		mov	edx, [ebp+conn]
		mov	[esp+4], edx	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_channel
		mov	al, 1
		add	esp, 0BCh
		pop	channel_0
		pop	payload
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
channel_0 = ebx				; SilcChannelEntry
cipher = edi				; unsigned __int8 *
payload	= esi				; SilcChannelKeyPayload
		align 10h

loc_62B849A0:				; CODE XREF: _silc_client_save_channel_key+1E9j
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	[esp+10h], cipher
		mov	dword ptr [esp+0Ch], offset aCannotTalkTo_0 ; "Cannot talk to channel: unsupported cip"...
		mov	dword ptr [esp+8], 4
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx

loc_62B849C4:				; CODE XREF: _silc_client_save_channel_key+43Ej
					; _silc_client_save_channel_key+46Aj
		mov	edx, [ecx+4Ch]
		mov	[esp], edx
		call	dword ptr [eax]
		mov	[esp+8], channel_0 ; channel_entry
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_channel

loc_62B849E2:				; CODE XREF: _silc_client_save_channel_key+41j
					; _silc_client_save_channel_key+6Fj
id_string = eax				; unsigned __int8 *
		mov	[esp], payload
		call	_silc_channel_key_payload_free

loc_62B849EA:				; CODE XREF: _silc_client_save_channel_key+2Aj
		xor	eax, eax

loc_62B849EC:				; CODE XREF: _silc_client_save_channel_key+40Aj
		add	esp, 0BCh
		pop	channel_0
		pop	payload
		pop	cipher
		leave
		retn
; ---------------------------------------------------------------------------
channel_0 = ebx				; SilcChannelEntry
payload	= esi				; SilcChannelKeyPayload
		align 4

loc_62B849F8:				; CODE XREF: _silc_client_save_channel_key+16Fj
		movzx	edx, word ptr [edi+0Eh]
		mov	ecx, [edi+4]
		mov	[eax+edx], ecx
		jmp	loc_62B847AD
; ---------------------------------------------------------------------------
		align 4

loc_62B84A08:				; CODE XREF: _silc_client_save_channel_key+10Dj
		movzx	edx, word ptr [edi+0Eh]
		mov	ecx, [edi+4]
		mov	[eax+edx], ecx
		jmp	loc_62B8474B
; ---------------------------------------------------------------------------
		align 4

loc_62B84A18:				; CODE XREF: _silc_client_save_channel_key+77j
		mov	[esp+8], edi	; channel_id
		mov	edx, [ebp+conn]
		mov	[esp+4], edx	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel_by_id
		mov	channel_0, eax
		test	eax, eax
		jnz	loc_62B846CB
channel_0 = eax				; SilcChannelEntry
		mov	[esp], payload
		call	_silc_channel_key_payload_free
channel_0 = ebx				; SilcChannelEntry
		xor	eax, eax
		jmp	short loc_62B849EC
; ---------------------------------------------------------------------------

loc_62B84A44:				; CODE XREF: _silc_client_save_channel_key+26Aj
key = edi				; unsigned __int8 * ; "hmac-sha1-96"
		mov	edx, offset aHmacSha196
hmac = edx				; unsigned __int8 *
		jmp	loc_62B848B2
; ---------------------------------------------------------------------------
cipher = edi				; unsigned __int8 *
		align 10h

loc_62B84A50:				; CODE XREF: _silc_client_save_channel_key+203j
		mov	ecx, [ebp+client]
		mov	eax, [ecx+18h]
		mov	eax, [eax+48h]
		mov	[esp+10h], cipher
		mov	dword ptr [esp+0Ch], offset aCannotTalkTo_0 ; "Cannot talk to channel: unsupported cip"...
		mov	dword ptr [esp+8], 4
		mov	edx, [ebp+conn]
		mov	[esp+4], edx
		mov	ecx, edx
		jmp	loc_62B849C4
; ---------------------------------------------------------------------------
key = edi				; unsigned __int8 *
		align 4

loc_62B84A7C:				; CODE XREF: _silc_client_save_channel_key+29Cj
		mov	ecx, [ebp+client]
		mov	eax, [ecx+18h]
		mov	eax, [eax+48h]
		mov	[esp+10h], edx
hmac = edx				; unsigned __int8 *
		mov	dword ptr [esp+0Ch], offset aCannotTalkTo_1 ; "Cannot talk to channel: unsupported HMA"...
		mov	dword ptr [esp+8], 4
		mov	hmac, [ebp+conn]
		mov	[esp+4], edx
		mov	ecx, edx
		jmp	loc_62B849C4
; ---------------------------------------------------------------------------
		align 4

loc_62B84AA8:				; CODE XREF: _silc_client_save_channel_key+EDj
		mov	[edi], eax
		movzx	ecx, word ptr [edi+0Ch]
		mov	[ebp+var_9C], ecx
		jmp	loc_62B84741
; ---------------------------------------------------------------------------
		align 4

loc_62B84ABC:				; CODE XREF: _silc_client_save_channel_key+14Fj
		mov	[edi], eax
		movzx	ecx, word ptr [edi+0Ch]
		mov	[ebp+var_9C], ecx
		jmp	loc_62B847A3
; ---------------------------------------------------------------------------
		align 10h

loc_62B84AD0:				; CODE XREF: _silc_client_save_channel_key+9Bj
		call	_silc_dlist_init
		mov	[channel_0+148h], eax
		jmp	loc_62B846D9
; ---------------------------------------------------------------------------

loc_62B84AE0:				; CODE XREF: _silc_client_save_channel_key+A9j
		call	_silc_dlist_init
		mov	[channel_0+14Ch], eax
		jmp	loc_62B846E7
_silc_client_save_channel_key endp

; Exported entry  17. silc_client_channel_key

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_channel_key(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_channel_key
_silc_client_channel_key proc near	; DATA XREF: _silc_client_connection_st_packet:loc_62B81EE0o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+fsm_context]
		mov	ebx, [ebp+state_context]
		mov	dword ptr [esp+0Ch], 0 ; channel
		lea	edx, [ebx+8]
		mov	[esp+8], edx	; key_payload
		mov	[esp+4], eax	; conn
		mov	eax, [eax+4Ch]
		mov	[esp], eax	; client
		call	_silc_client_save_channel_key
		mov	[esp], ebx
		call	_silc_packet_free
		mov	eax, 3
		add	esp, 14h
		pop	ebx
		leave
		retn
_silc_client_channel_key endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 105. silc_client_del_channel_private_keys

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_del_channel_private_keys(SilcClient client, SilcClientConnection	conn, SilcChannelEntry channel)
		public _silc_client_del_channel_private_keys
_silc_client_del_channel_private_keys proc near	; CODE XREF: _silc_client_unref_channel+95p

var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	edi, [ebp+client]
		test	edi, edi
		jz	loc_62B84E60
		mov	esi, [ebp+conn]
		test	esi, esi
		jz	loc_62B84E60
		mov	ebx, [ebp+channel]
		test	ebx, ebx
		jz	loc_62B84E60
		mov	edx, [ebp+channel]
		mov	eax, [edx+150h]
		test	eax, eax
		jz	loc_62B84E60
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
entry =	edi				; SilcChannelPrivateKey
		xchg	ax, ax

loc_62B84B84:				; CODE XREF: _silc_client_del_channel_private_keys+EBj
		mov	ebx, [ebp+channel]
		mov	ecx, [ebx+150h]
		mov	eax, [ecx+14h]
		mov	[ecx+18h], eax
		mov	eax, [ecx+8]
		test	eax, eax
		jz	loc_62B84CF4
		test	byte ptr [ecx+10h], 2
		jz	loc_62B84C84
		movzx	edx, word ptr [ecx+0Eh]
		mov	edx, [eax+edx]

loc_62B84BAF:				; CODE XREF: _silc_client_del_channel_private_keys+15Bj
		mov	[ecx+8], edx
		mov	[ecx+14h], eax
		mov	entry, [eax]
		test	entry, entry
		jz	loc_62B84CFB
		mov	esi, [ecx]
		mov	eax, esi
		mov	[ecx+8], esi
		and	byte ptr [ecx+10h], 0FDh
		xor	ebx, ebx
		test	eax, eax
		jz	short loc_62B84BE8

loc_62B84BD0:				; CODE XREF: _silc_client_del_channel_private_keys+B6j
		test	bl, bl
		jz	short loc_62B84C20
		movzx	edx, word ptr [ecx+0Eh]
		mov	edx, [eax+edx]
		mov	[ecx+8], edx
		cmp	entry, [eax]
		jz	short loc_62B84C2E

loc_62B84BE2:				; CODE XREF: _silc_client_del_channel_private_keys+FCj
		mov	eax, edx
		test	eax, eax
		jnz	short loc_62B84BD0

loc_62B84BE8:				; CODE XREF: _silc_client_del_channel_private_keys+9Ej
					; _silc_client_del_channel_private_keys+14Cj
		mov	eax, [entry]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [entry+4]
		mov	[esp], eax
		call	_silc_cipher_free
		mov	eax, [entry+8]
		mov	[esp], eax
		call	_silc_cipher_free
		mov	eax, [entry+0Ch]
		mov	[esp], eax
		call	_silc_hmac_free
		mov	[esp], entry
		call	_silc_free
		jmp	loc_62B84B84
; ---------------------------------------------------------------------------

loc_62B84C20:				; CODE XREF: _silc_client_del_channel_private_keys+A2j
		movzx	edx, word ptr [ecx+0Ch]
		mov	edx, [eax+edx]
		mov	[ecx+8], edx
		cmp	entry, [eax]
		jnz	short loc_62B84BE2

loc_62B84C2E:				; CODE XREF: _silc_client_del_channel_private_keys+B0j
		mov	[ebp+var_3C], esi
		test	esi, esi
		jz	short loc_62B84C65
		cmp	eax, esi
		jz	loc_62B84E75
		movzx	esi, word ptr [ecx+0Ch]
		mov	[ebp+var_1C], esi
		mov	ebx, [ebp+var_3C]
		mov	[ebp+var_20], entry
		mov	entry, esi
		jmp	short loc_62B84C56
; ---------------------------------------------------------------------------
		align 10h

loc_62B84C50:				; CODE XREF: _silc_client_del_channel_private_keys+12Dj
		cmp	eax, edx
		jz	short loc_62B84C90
		mov	ebx, edx

loc_62B84C56:				; CODE XREF: _silc_client_del_channel_private_keys+11Cj
		lea	esi, [ebx+edi]
		mov	edx, [esi]
		test	edx, edx
		jnz	short loc_62B84C50
		mov	[ebp+var_3C], ebx
		mov	edi, [ebp+var_20]

loc_62B84C65:				; CODE XREF: _silc_client_del_channel_private_keys+103j
entry =	edi				; SilcChannelPrivateKey
		cmp	eax, [ecx+4]
		jz	short loc_62B84CD0

loc_62B84C6A:				; CODE XREF: _silc_client_del_channel_private_keys+19Ej
		cmp	eax, [ecx+14h]
		jz	short loc_62B84CDC

loc_62B84C6F:				; CODE XREF: _silc_client_del_channel_private_keys+1A9j
		cmp	eax, [ecx+18h]
		jz	short loc_62B84CE8

loc_62B84C74:				; CODE XREF: _silc_client_del_channel_private_keys+1B6j
					; _silc_client_del_channel_private_keys+1BFj
		mov	[esp], eax
		call	_silc_free
		jmp	loc_62B84BE8
; ---------------------------------------------------------------------------
		align 4

loc_62B84C84:				; CODE XREF: _silc_client_del_channel_private_keys+72j
		movzx	edx, word ptr [ecx+0Ch]
		mov	edx, [eax+edx]
		jmp	loc_62B84BAF
; ---------------------------------------------------------------------------

loc_62B84C90:				; CODE XREF: _silc_client_del_channel_private_keys+122j
		mov	[ebp+var_3C], ebx
		mov	[ebp+var_2C], esi
		mov	edi, [ebp+var_20]

loc_62B84C99:				; CODE XREF: _silc_client_del_channel_private_keys+356j
entry =	edi				; SilcChannelPrivateKey
		mov	esi, [ebp+var_1C]
		mov	esi, [eax+esi]
		mov	[ebp+var_20], esi
		mov	edx, [ebp+var_2C]
		mov	[edx], esi
		test	esi, esi
		jz	short loc_62B84CBE
		test	byte ptr [ecx+10h], 1
		jz	short loc_62B84CBE
		movzx	ebx, word ptr [ecx+0Eh]
		mov	esi, [eax+ebx]
		mov	edx, [ebp+var_20]
		mov	[edx+ebx], esi

loc_62B84CBE:				; CODE XREF: _silc_client_del_channel_private_keys+179j
					; _silc_client_del_channel_private_keys+17Fj
		cmp	eax, [ecx+8]
		jz	loc_62B84E53

loc_62B84CC7:				; CODE XREF: _silc_client_del_channel_private_keys+32Bj
		sub	dword ptr [ecx+10h], 4
		cmp	eax, [ecx+4]
		jnz	short loc_62B84C6A

loc_62B84CD0:				; CODE XREF: _silc_client_del_channel_private_keys+138j
		mov	edx, [ebp+var_3C]
		mov	[ecx+4], edx
		cmp	eax, [ecx+14h]
		jnz	short loc_62B84C6F
		nop

loc_62B84CDC:				; CODE XREF: _silc_client_del_channel_private_keys+13Dj
		mov	dword ptr [ecx+14h], 0
		cmp	eax, [ecx+18h]
		jnz	short loc_62B84C74

loc_62B84CE8:				; CODE XREF: _silc_client_del_channel_private_keys+142j
		mov	dword ptr [ecx+18h], 0
		jmp	short loc_62B84C74
; ---------------------------------------------------------------------------
		align 4

loc_62B84CF4:				; CODE XREF: _silc_client_del_channel_private_keys+68j
		mov	dword ptr [ecx+14h], 0

loc_62B84CFB:				; CODE XREF: _silc_client_del_channel_private_keys+89j
		mov	esi, [ebp+channel]
		mov	dword ptr [esi+154h], 0
		mov	eax, [esi+158h]
		test	eax, eax
		jz	loc_62B84DD2
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	[esi+138h], eax
		mov	edx, [ebp+channel]
		mov	eax, [edx+160h]
		test	eax, eax
		jz	loc_62B84DF0

loc_62B84D35:				; CODE XREF: _silc_client_del_channel_private_keys+2BAj
		mov	[esp], eax
		call	_silc_hmac_get_name
		mov	ecx, [ebp+channel]
		mov	[ecx+13Ch], eax

loc_62B84D46:				; CODE XREF: _silc_client_del_channel_private_keys+2CDj
		mov	esi, [ebp+channel]
		mov	entry, [esi+150h]
		test	edi, edi
		jz	short loc_62B84DBB
		mov	ebx, [edi]
		mov	[edi+8], ebx
		and	byte ptr [edi+10h], 0FDh
		test	ebx, ebx
		jz	short loc_62B84DB3

loc_62B84D60:				; CODE XREF: _silc_client_del_channel_private_keys+281j
		test	byte ptr [edi+10h], 2
		jz	loc_62B84E04
		movzx	eax, word ptr [edi+0Eh]
		mov	eax, [ebx+eax]

loc_62B84D71:				; CODE XREF: _silc_client_del_channel_private_keys+2DBj
		mov	[edi+8], eax
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_62B84D9B
		cmp	ebx, eax
		jz	loc_62B84E6A
		movzx	esi, word ptr [edi+0Ch]
		jmp	short loc_62B84D92
; ---------------------------------------------------------------------------

loc_62B84D88:				; CODE XREF: _silc_client_del_channel_private_keys+269j
		cmp	ebx, ecx
		jz	loc_62B84E10
		mov	eax, ecx

loc_62B84D92:				; CODE XREF: _silc_client_del_channel_private_keys+256j
		lea	edx, [eax+esi]
		mov	ecx, [edx]
		test	ecx, ecx
		jnz	short loc_62B84D88

loc_62B84D9B:				; CODE XREF: _silc_client_del_channel_private_keys+248j
		cmp	ebx, [edi+4]
		jz	loc_62B84E41

loc_62B84DA4:				; CODE XREF: _silc_client_del_channel_private_keys+30Bj
					; _silc_client_del_channel_private_keys+314j
		mov	[esp], ebx
		call	_silc_free
		mov	ebx, [edi+8]
		test	ebx, ebx
		jnz	short loc_62B84D60

loc_62B84DB3:				; CODE XREF: _silc_client_del_channel_private_keys+22Ej
		mov	[esp], edi
		call	_silc_free

loc_62B84DBB:				; CODE XREF: _silc_client_del_channel_private_keys+221j
		mov	ebx, [ebp+channel]
		mov	dword ptr [ebx+150h], 0
		mov	al, 1
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B84DD2:				; CODE XREF: _silc_client_del_channel_private_keys+1E0j
entry =	edi				; SilcChannelPrivateKey
		mov	eax, [ebp+channel]
		mov	dword ptr [eax+138h], 0
		mov	edx, [ebp+channel]
		mov	eax, [edx+160h]
		test	eax, eax
		jnz	loc_62B84D35

loc_62B84DF0:				; CODE XREF: _silc_client_del_channel_private_keys+1FFj
		mov	ebx, [ebp+channel]
		mov	dword ptr [ebx+13Ch], 0
		jmp	loc_62B84D46
; ---------------------------------------------------------------------------
		align 4

loc_62B84E04:				; CODE XREF: _silc_client_del_channel_private_keys+234j
		movzx	eax, word ptr [edi+0Ch]
		mov	eax, [ebx+eax]
		jmp	loc_62B84D71
; ---------------------------------------------------------------------------

loc_62B84E10:				; CODE XREF: _silc_client_del_channel_private_keys+25Aj
		mov	[ebp+var_20], edx

loc_62B84E13:				; CODE XREF: _silc_client_del_channel_private_keys+343j
		mov	ecx, [ebx+esi]
		mov	edx, [ebp+var_20]
		mov	[edx], ecx
		test	ecx, ecx
		jz	short loc_62B84E2F
		test	byte ptr [edi+10h], 1
		jz	short loc_62B84E2F
		movzx	esi, word ptr [edi+0Eh]
		mov	edx, [ebx+esi]
		mov	[ecx+esi], edx

loc_62B84E2F:				; CODE XREF: _silc_client_del_channel_private_keys+2EDj
					; _silc_client_del_channel_private_keys+2F3j
		cmp	ebx, [edi+8]
		jz	short loc_62B84E49

loc_62B84E34:				; CODE XREF: _silc_client_del_channel_private_keys+321j
		sub	dword ptr [edi+10h], 4
		cmp	ebx, [edi+4]
		jnz	loc_62B84DA4

loc_62B84E41:				; CODE XREF: _silc_client_del_channel_private_keys+26Ej
		mov	[edi+4], eax
		jmp	loc_62B84DA4
; ---------------------------------------------------------------------------

loc_62B84E49:				; CODE XREF: _silc_client_del_channel_private_keys+302j
		mov	ecx, [ebp+var_20]
		mov	edx, [ecx]
		mov	[edi+8], edx
		jmp	short loc_62B84E34
; ---------------------------------------------------------------------------

loc_62B84E53:				; CODE XREF: _silc_client_del_channel_private_keys+191j
entry =	edi				; SilcChannelPrivateKey
		mov	ebx, [ebp+var_2C]
		mov	edx, [ebx]
		mov	[ecx+8], edx
		jmp	loc_62B84CC7
; ---------------------------------------------------------------------------

loc_62B84E60:				; CODE XREF: _silc_client_del_channel_private_keys+Ej
					; _silc_client_del_channel_private_keys+19j ...
		xor	eax, eax
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B84E6A:				; CODE XREF: _silc_client_del_channel_private_keys+24Cj
		movzx	esi, word ptr [edi+0Ch]
		mov	[ebp+var_20], edi
		xor	eax, eax
		jmp	short loc_62B84E13
; ---------------------------------------------------------------------------

loc_62B84E75:				; CODE XREF: _silc_client_del_channel_private_keys+107j
entry =	edi				; SilcChannelPrivateKey
		mov	[ebp+var_2C], ecx
		movzx	ebx, word ptr [ecx+0Ch]
		mov	[ebp+var_1C], ebx
		mov	[ebp+var_3C], 0
		jmp	loc_62B84C99
_silc_client_del_channel_private_keys endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 198. silc_client_save_channel_key_rekey

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_save_channel_key_rekey(SilcSchedule schedule, void *app_context, SilcTaskEvent type,	SilcUInt32 fd, void *context)
		public _silc_client_save_channel_key_rekey
_silc_client_save_channel_key_rekey proc near
					; DATA XREF: _silc_client_save_channel_key+1A5o

var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
channel		= dword	ptr -1Ch
schedule	= dword	ptr  8
app_context	= dword	ptr  0Ch
type		= dword	ptr  10h
fd		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+context]
		mov	[ebp+channel], eax
		mov	eax, [eax+148h]
		test	eax, eax
		jz	loc_62B84F3C
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	esi, [ebp+channel]
		mov	ecx, [esi+148h]
		mov	eax, [ecx+14h]
		mov	[ecx+18h], eax
		mov	eax, [ecx+8]
		test	eax, eax
		jz	loc_62B85130
		test	byte ptr [ecx+10h], 2
		jnz	loc_62B84FF4
		movzx	edx, word ptr [ecx+0Ch]
		mov	edx, [eax+edx]

loc_62B84EEB:				; CODE XREF: _silc_client_save_channel_key_rekey+16Fj
		mov	[ecx+8], edx
		mov	[ecx+14h], eax
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		test	eax, eax
		jz	short loc_62B84F3C
		mov	esi, [ecx]
		mov	eax, esi
		mov	[ecx+8], esi
		and	byte ptr [ecx+10h], 0FDh
		xor	ebx, ebx
		mov	edi, [ebp+var_20]
key = edi				; SilcCipher
		test	eax, eax
		jz	short loc_62B84F30
		xchg	ax, ax

loc_62B84F10:				; CODE XREF: _silc_client_save_channel_key_rekey+A2j
		test	bl, bl
		jz	loc_62B85060
		movzx	edx, word ptr [ecx+0Eh]
		mov	edx, [eax+edx]
		mov	[ecx+8], edx
		cmp	key, [eax]
		jz	loc_62B85072

loc_62B84F2A:				; CODE XREF: _silc_client_save_channel_key_rekey+1E0j
		mov	eax, edx
		test	eax, eax
		jnz	short loc_62B84F10

loc_62B84F30:				; CODE XREF: _silc_client_save_channel_key_rekey+80j
		mov	key, [ebp+var_20]
		mov	[esp], edi
		call	_silc_cipher_free
		nop

loc_62B84F3C:				; CODE XREF: _silc_client_save_channel_key_rekey+17j
					; _silc_client_save_channel_key_rekey+6Cj ...
		mov	edx, [ebp+channel]
		mov	eax, [edx+14Ch]
		test	eax, eax
		jz	loc_62B84FDF
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	esi, [ebp+channel]
		mov	ecx, [esi+14Ch]
		mov	eax, [ecx+14h]
		mov	[ecx+18h], eax
		mov	eax, [ecx+8]
		test	eax, eax
		jz	short loc_62B84FD8
		test	byte ptr [ecx+10h], 2
		jnz	short loc_62B84FE8
		movzx	edx, word ptr [ecx+0Ch]
		mov	edx, [eax+edx]

loc_62B84F87:				; CODE XREF: _silc_client_save_channel_key_rekey+163j
		mov	[ecx+8], edx
		mov	[ecx+14h], eax
		mov	eax, [eax]
		mov	[ebp+channel], eax
		test	eax, eax
		jz	short loc_62B84FDF
		mov	esi, [ecx]
		mov	eax, esi
		mov	[ecx+8], esi
		and	byte ptr [ecx+10h], 0FDh
		xor	ebx, ebx
		mov	edi, [ebp+channel]
hmac = edi				; SilcHmac
		test	eax, eax
		jz	short loc_62B84FC4
		xchg	ax, ax

loc_62B84FAC:				; CODE XREF: _silc_client_save_channel_key_rekey+136j
		test	bl, bl
		jz	short loc_62B85000
		movzx	edx, word ptr [ecx+0Eh]
		mov	edx, [eax+edx]
		mov	[ecx+8], edx
		cmp	hmac, [eax]
		jz	short loc_62B8500E

loc_62B84FBE:				; CODE XREF: _silc_client_save_channel_key_rekey+180j
		mov	eax, edx
		test	eax, eax
		jnz	short loc_62B84FAC

loc_62B84FC4:				; CODE XREF: _silc_client_save_channel_key_rekey+11Cj
					; _silc_client_save_channel_key_rekey+1CEj
		mov	hmac, [ebp+channel]
		mov	[ebp+schedule],	edi
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		jmp	_silc_hmac_free
; ---------------------------------------------------------------------------
		align 4

loc_62B84FD8:				; CODE XREF: _silc_client_save_channel_key_rekey+ECj
		mov	dword ptr [ecx+14h], 0

loc_62B84FDF:				; CODE XREF: _silc_client_save_channel_key_rekey+BBj
					; _silc_client_save_channel_key_rekey+108j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_62B84FE8:				; CODE XREF: _silc_client_save_channel_key_rekey+F2j
		movzx	edx, word ptr [ecx+0Eh]
		mov	edx, [eax+edx]
		jmp	short loc_62B84F87
; ---------------------------------------------------------------------------
		align 4

loc_62B84FF4:				; CODE XREF: _silc_client_save_channel_key_rekey+52j
		movzx	edx, word ptr [ecx+0Eh]
		mov	edx, [eax+edx]
		jmp	loc_62B84EEB
; ---------------------------------------------------------------------------

loc_62B85000:				; CODE XREF: _silc_client_save_channel_key_rekey+122j
hmac = edi				; SilcHmac
		movzx	edx, word ptr [ecx+0Ch]
		mov	edx, [eax+edx]
		mov	[ecx+8], edx
		cmp	hmac, [eax]
		jnz	short loc_62B84FBE

loc_62B8500E:				; CODE XREF: _silc_client_save_channel_key_rekey+130j
		mov	ebx, esi
		test	esi, esi
		jz	short loc_62B85037
		cmp	eax, esi
		jz	loc_62B85193
		movzx	hmac, word ptr [ecx+0Ch]
		jmp	short loc_62B8502E
; ---------------------------------------------------------------------------
		align 4

loc_62B85024:				; CODE XREF: _silc_client_save_channel_key_rekey+1A9j
		cmp	eax, edx
		jz	loc_62B850CC
		mov	ebx, edx

loc_62B8502E:				; CODE XREF: _silc_client_save_channel_key_rekey+194j
		lea	esi, [ebx+edi]
		mov	edx, [esi]
		test	edx, edx
		jnz	short loc_62B85024

loc_62B85037:				; CODE XREF: _silc_client_save_channel_key_rekey+186j
					; _silc_client_save_channel_key_rekey+262j
hmac = edi				; SilcHmac
		cmp	eax, [ecx+4]
		jz	loc_62B85160

loc_62B85040:				; CODE XREF: _silc_client_save_channel_key_rekey+2D7j
		cmp	eax, [ecx+14h]
		jz	loc_62B85154

loc_62B85049:				; CODE XREF: _silc_client_save_channel_key_rekey+2CFj
		cmp	eax, [ecx+18h]
		jz	loc_62B8513C

loc_62B85052:				; CODE XREF: _silc_client_save_channel_key_rekey+2B7j
		mov	[esp], eax
		call	_silc_free
		jmp	loc_62B84FC4
; ---------------------------------------------------------------------------
key = edi				; SilcCipher
		align 10h

loc_62B85060:				; CODE XREF: _silc_client_save_channel_key_rekey+86j
		movzx	edx, word ptr [ecx+0Ch]
		mov	edx, [eax+edx]
		mov	[ecx+8], edx
		cmp	key, [eax]
		jnz	loc_62B84F2A

loc_62B85072:				; CODE XREF: _silc_client_save_channel_key_rekey+98j
		mov	ebx, esi
		test	esi, esi
		jz	short loc_62B85097
		cmp	eax, esi
		jz	loc_62B851A1
		movzx	key, word ptr [ecx+0Ch]
		jmp	short loc_62B8508E
; ---------------------------------------------------------------------------
		align 4

loc_62B85088:				; CODE XREF: _silc_client_save_channel_key_rekey+209j
		cmp	eax, edx
		jz	short loc_62B85100
		mov	ebx, edx

loc_62B8508E:				; CODE XREF: _silc_client_save_channel_key_rekey+1F8j
		lea	esi, [ebx+edi]
		mov	edx, [esi]
		test	edx, edx
		jnz	short loc_62B85088

loc_62B85097:				; CODE XREF: _silc_client_save_channel_key_rekey+1EAj
					; _silc_client_save_channel_key_rekey+29Cj
key = edi				; SilcCipher
		cmp	eax, [ecx+4]
		jz	loc_62B85174

loc_62B850A0:				; CODE XREF: _silc_client_save_channel_key_rekey+2EBj
		cmp	eax, [ecx+14h]
		jz	loc_62B85168

loc_62B850A9:				; CODE XREF: _silc_client_save_channel_key_rekey+2E3j
		cmp	eax, [ecx+18h]
		jz	loc_62B85148

loc_62B850B2:				; CODE XREF: _silc_client_save_channel_key_rekey+2C3j
		mov	[esp], eax
		call	_silc_free
		mov	key, [ebp+var_20]
		mov	[esp], edi
		call	_silc_cipher_free
		jmp	loc_62B84F3C
; ---------------------------------------------------------------------------
		align 4

loc_62B850CC:				; CODE XREF: _silc_client_save_channel_key_rekey+19Aj
		mov	[ebp+var_2C], esi

loc_62B850CF:				; CODE XREF: _silc_client_save_channel_key_rekey+310j
		mov	edx, [eax+edi]
		mov	edi, [ebp+var_2C]
		mov	[edi], edx
		test	edx, edx
		jz	short loc_62B850E1
		test	byte ptr [ecx+10h], 1
		jnz	short loc_62B850F4

loc_62B850E1:				; CODE XREF: _silc_client_save_channel_key_rekey+24Dj
					; _silc_client_save_channel_key_rekey+272j
		cmp	eax, [ecx+8]
		jz	loc_62B8517C

loc_62B850EA:				; CODE XREF: _silc_client_save_channel_key_rekey+2F8j
		sub	dword ptr [ecx+10h], 4
		jmp	loc_62B85037
; ---------------------------------------------------------------------------
		align 4

loc_62B850F4:				; CODE XREF: _silc_client_save_channel_key_rekey+253j
		movzx	esi, word ptr [ecx+0Eh]
		mov	edi, [eax+esi]
		mov	[edx+esi], edi
		jmp	short loc_62B850E1
; ---------------------------------------------------------------------------

loc_62B85100:				; CODE XREF: _silc_client_save_channel_key_rekey+1FEj
		mov	[ebp+var_3C], esi

loc_62B85103:				; CODE XREF: _silc_client_save_channel_key_rekey+31Ej
		mov	edx, [eax+edi]
		mov	edi, [ebp+var_3C]
		mov	[edi], edx
		test	edx, edx
		jz	short loc_62B8511F
		test	byte ptr [ecx+10h], 1
		jz	short loc_62B8511F
		movzx	esi, word ptr [ecx+0Eh]
		mov	edi, [eax+esi]
		mov	[edx+esi], edi

loc_62B8511F:				; CODE XREF: _silc_client_save_channel_key_rekey+281j
					; _silc_client_save_channel_key_rekey+287j
		cmp	eax, [ecx+8]
		jz	short loc_62B85189

loc_62B85124:				; CODE XREF: _silc_client_save_channel_key_rekey+305j
		sub	dword ptr [ecx+10h], 4
		jmp	loc_62B85097
; ---------------------------------------------------------------------------
		align 10h

loc_62B85130:				; CODE XREF: _silc_client_save_channel_key_rekey+48j
		mov	dword ptr [ecx+14h], 0
		jmp	loc_62B84F3C
; ---------------------------------------------------------------------------

loc_62B8513C:				; CODE XREF: _silc_client_save_channel_key_rekey+1C0j
hmac = edi				; SilcHmac
		mov	dword ptr [ecx+18h], 0
		jmp	loc_62B85052
; ---------------------------------------------------------------------------

loc_62B85148:				; CODE XREF: _silc_client_save_channel_key_rekey+220j
key = edi				; SilcCipher
		mov	dword ptr [ecx+18h], 0
		jmp	loc_62B850B2
; ---------------------------------------------------------------------------

loc_62B85154:				; CODE XREF: _silc_client_save_channel_key_rekey+1B7j
hmac = edi				; SilcHmac
		mov	dword ptr [ecx+14h], 0
		jmp	loc_62B85049
; ---------------------------------------------------------------------------

loc_62B85160:				; CODE XREF: _silc_client_save_channel_key_rekey+1AEj
		mov	[ecx+4], ebx
		jmp	loc_62B85040
; ---------------------------------------------------------------------------

loc_62B85168:				; CODE XREF: _silc_client_save_channel_key_rekey+217j
key = edi				; SilcCipher
		mov	dword ptr [ecx+14h], 0
		jmp	loc_62B850A9
; ---------------------------------------------------------------------------

loc_62B85174:				; CODE XREF: _silc_client_save_channel_key_rekey+20Ej
		mov	[ecx+4], ebx
		jmp	loc_62B850A0
; ---------------------------------------------------------------------------

loc_62B8517C:				; CODE XREF: _silc_client_save_channel_key_rekey+258j
		mov	esi, [ebp+var_2C]
		mov	edx, [esi]
		mov	[ecx+8], edx
		jmp	loc_62B850EA
; ---------------------------------------------------------------------------

loc_62B85189:				; CODE XREF: _silc_client_save_channel_key_rekey+296j
		mov	esi, [ebp+var_3C]
		mov	edx, [esi]
		mov	[ecx+8], edx
		jmp	short loc_62B85124
; ---------------------------------------------------------------------------

loc_62B85193:				; CODE XREF: _silc_client_save_channel_key_rekey+18Aj
hmac = edi				; SilcHmac
		mov	[ebp+var_2C], ecx
		movzx	hmac, word ptr [ecx+0Ch]
		xor	ebx, ebx
		jmp	loc_62B850CF
; ---------------------------------------------------------------------------

loc_62B851A1:				; CODE XREF: _silc_client_save_channel_key_rekey+1EEj
key = edi				; SilcCipher
		mov	[ebp+var_3C], ecx
		movzx	key, word ptr [ecx+0Ch]
		xor	ebx, ebx
		jmp	loc_62B85103
_silc_client_save_channel_key_rekey endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 104. silc_client_del_channel_private_key

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_del_channel_private_key(SilcClient client, SilcClientConnection conn, SilcChannelEntry channel, SilcChannelPrivateKey key)
		public _silc_client_del_channel_private_key
_silc_client_del_channel_private_key proc near

var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h
key		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+key]
		mov	ecx, [ebp+client]
		test	ecx, ecx
		jz	loc_62B854E7
key_0 =	ebx				; SilcChannelPrivateKey
		mov	edx, [ebp+conn]
		test	edx, edx
		jz	loc_62B854E7
		mov	eax, [ebp+channel]
		test	eax, eax
		jz	loc_62B854E7
		mov	edx, [ebp+channel]
		mov	eax, [edx+150h]
		test	eax, eax
		jz	loc_62B854E7
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+150h]
		jmp	short loc_62B8522B
; ---------------------------------------------------------------------------

loc_62B85210:				; CODE XREF: _silc_client_del_channel_private_key+8Cj
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B85217:				; CODE XREF: _silc_client_del_channel_private_key+95j
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	edx, [edx]
entry =	edx				; SilcChannelPrivateKey
		test	entry, entry
		jz	loc_62B854E7
		cmp	entry, key_0
		jz	short loc_62B8525C

loc_62B8522B:				; CODE XREF: _silc_client_del_channel_private_key+5Ej
		mov	entry, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B85248
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B85210
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	short loc_62B85217
; ---------------------------------------------------------------------------
		align 4

loc_62B85248:				; CODE XREF: _silc_client_del_channel_private_key+86j
		mov	dword ptr [eax+14h], 0
		xor	eax, eax

loc_62B85251:				; CODE XREF: _silc_client_del_channel_private_key+339j
entry =	edx				; SilcChannelPrivateKey
		add	esp, 4Ch
		pop	key_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
key_0 =	ebx				; SilcChannelPrivateKey
		align 4

loc_62B8525C:				; CODE XREF: _silc_client_del_channel_private_key+79j
		mov	esi, [ebp+channel]
		cmp	key_0, [esi+154h]
		jz	loc_62B85487

loc_62B8526B:				; CODE XREF: _silc_client_del_channel_private_key+30Fj
		mov	edi, [eax]
		mov	entry, edi
		mov	[eax+8], edi
		and	byte ptr [eax+10h], 0FDh
		xor	esi, esi
		test	edx, edx
		jz	short loc_62B85296

loc_62B8527C:				; CODE XREF: _silc_client_del_channel_private_key+E4j
		mov	ecx, esi
		test	cl, cl
		jz	short loc_62B852E4
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]
		mov	[eax+8], ecx
		cmp	key_0, [edx]
		jz	short loc_62B852F2

loc_62B85290:				; CODE XREF: _silc_client_del_channel_private_key+140j
		mov	edx, ecx
		test	edx, edx
		jnz	short loc_62B8527C

loc_62B85296:				; CODE XREF: _silc_client_del_channel_private_key+CAj
					; _silc_client_del_channel_private_key+1A0j
		mov	eax, [key_0]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [key_0+4]
		mov	[esp], eax
		call	_silc_cipher_free
		mov	eax, [key_0+8]
		mov	[esp], eax
		call	_silc_cipher_free
		mov	eax, [key_0+0Ch]
		mov	[esp], eax
		call	_silc_hmac_free
		mov	[esp], key_0
		call	_silc_free
		mov	esi, [ebp+channel]
		mov	edi, [esi+150h]
		mov	eax, [edi+10h]
		shr	eax, 2
		jz	short loc_62B85358
		mov	al, 1

loc_62B852DC:				; CODE XREF: _silc_client_del_channel_private_key+216j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B852E4:				; CODE XREF: _silc_client_del_channel_private_key+D0j
key_0 =	ebx				; SilcChannelPrivateKey
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		mov	[eax+8], ecx
		cmp	key_0, [edx]
		jnz	short loc_62B85290

loc_62B852F2:				; CODE XREF: _silc_client_del_channel_private_key+DEj
		mov	[ebp+var_3C], edi
		test	edi, edi
		jz	short loc_62B8532D
		cmp	edx, edi
		jz	loc_62B854D1
		movzx	ecx, word ptr [eax+0Ch]
		mov	[ebp+var_1C], ecx
		mov	esi, [ebp+var_3C]
		mov	[ebp+var_20], key_0
		mov	key_0, ecx
		jmp	short loc_62B8531E
; ---------------------------------------------------------------------------
		align 4

loc_62B85314:				; CODE XREF: _silc_client_del_channel_private_key+175j
		cmp	edx, ecx
		jz	loc_62B8540C
		mov	esi, ecx

loc_62B8531E:				; CODE XREF: _silc_client_del_channel_private_key+160j
		lea	edi, [esi+ebx]
		mov	ecx, [edi]
		test	ecx, ecx
		jnz	short loc_62B85314
		mov	[ebp+var_3C], esi
		mov	ebx, [ebp+var_20]

loc_62B8532D:				; CODE XREF: _silc_client_del_channel_private_key+147j
					; _silc_client_del_channel_private_key+297j
key_0 =	ebx				; SilcChannelPrivateKey
		cmp	edx, [eax+4]
		jz	loc_62B8547C

loc_62B85336:				; CODE XREF: _silc_client_del_channel_private_key+2D2j
		cmp	edx, [eax+14h]
		jz	loc_62B85470

loc_62B8533F:				; CODE XREF: _silc_client_del_channel_private_key+2C7j
		cmp	edx, [eax+18h]
		jz	loc_62B85456

loc_62B85348:				; CODE XREF: _silc_client_del_channel_private_key+2ADj
		mov	[esp], edx
		call	_silc_free
		jmp	loc_62B85296
; ---------------------------------------------------------------------------
		align 4

loc_62B85358:				; CODE XREF: _silc_client_del_channel_private_key+128j
		mov	key_0, [edi]
		mov	[edi+8], ebx
		and	byte ptr [edi+10h], 0FDh
		test	ebx, ebx
		jz	short loc_62B853AF
		lea	esi, [esi+0]

loc_62B85368:				; CODE XREF: _silc_client_del_channel_private_key+1FDj
		test	byte ptr [edi+10h], 2
		jz	short loc_62B853CC
		movzx	eax, word ptr [edi+0Eh]
		mov	eax, [ebx+eax]

loc_62B85375:				; CODE XREF: _silc_client_del_channel_private_key+223j
		mov	[edi+8], eax
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_62B8539B
		cmp	ebx, eax
		jz	loc_62B85462
		movzx	esi, word ptr [edi+0Ch]
		jmp	short loc_62B85392
; ---------------------------------------------------------------------------

loc_62B8538C:				; CODE XREF: _silc_client_del_channel_private_key+1E9j
		cmp	ebx, ecx
		jz	short loc_62B853D8
		mov	eax, ecx

loc_62B85392:				; CODE XREF: _silc_client_del_channel_private_key+1DAj
		lea	edx, [eax+esi]
		mov	ecx, [edx]
		test	ecx, ecx
		jnz	short loc_62B8538C

loc_62B8539B:				; CODE XREF: _silc_client_del_channel_private_key+1CCj
		cmp	ebx, [edi+4]
		jz	short loc_62B85405

loc_62B853A0:				; CODE XREF: _silc_client_del_channel_private_key+253j
					; _silc_client_del_channel_private_key+258j
		mov	[esp], ebx
		call	_silc_free
		mov	ebx, [edi+8]
		test	ebx, ebx
		jnz	short loc_62B85368

loc_62B853AF:				; CODE XREF: _silc_client_del_channel_private_key+1B3j
		mov	[esp], edi
		call	_silc_free
		mov	esi, [ebp+channel]
		mov	dword ptr [esi+150h], 0
		mov	al, 1
		jmp	loc_62B852DC
; ---------------------------------------------------------------------------
		align 4

loc_62B853CC:				; CODE XREF: _silc_client_del_channel_private_key+1BCj
		movzx	eax, word ptr [edi+0Ch]
		mov	eax, [ebx+eax]
		jmp	short loc_62B85375
; ---------------------------------------------------------------------------
		align 4

loc_62B853D8:				; CODE XREF: _silc_client_del_channel_private_key+1DEj
		mov	[ebp+var_20], edx

loc_62B853DB:				; CODE XREF: _silc_client_del_channel_private_key+2BBj
		mov	ecx, [ebx+esi]
		mov	edx, [ebp+var_20]
		mov	[edx], ecx
		test	ecx, ecx
		jz	short loc_62B853F7
		test	byte ptr [edi+10h], 1
		jz	short loc_62B853F7
		movzx	esi, word ptr [edi+0Eh]
		mov	edx, [ebx+esi]
		mov	[ecx+esi], edx

loc_62B853F7:				; CODE XREF: _silc_client_del_channel_private_key+235j
					; _silc_client_del_channel_private_key+23Bj
		cmp	ebx, [edi+8]
		jz	short loc_62B8544C

loc_62B853FC:				; CODE XREF: _silc_client_del_channel_private_key+2A4j
		sub	dword ptr [edi+10h], 4
		cmp	ebx, [edi+4]
		jnz	short loc_62B853A0

loc_62B85405:				; CODE XREF: _silc_client_del_channel_private_key+1EEj
		mov	[edi+4], eax
		jmp	short loc_62B853A0
; ---------------------------------------------------------------------------
		align 4

loc_62B8540C:				; CODE XREF: _silc_client_del_channel_private_key+166j
		mov	[ebp+var_2C], edi
		mov	[ebp+var_3C], esi
		mov	ebx, [ebp+var_20]

loc_62B85415:				; CODE XREF: _silc_client_del_channel_private_key+332j
key_0 =	ebx				; SilcChannelPrivateKey
		mov	ecx, [ebp+var_1C]
		mov	ecx, [edx+ecx]
		mov	[ebp+var_20], ecx
		mov	esi, [ebp+var_2C]
		mov	[esi], ecx
		test	ecx, ecx
		jz	short loc_62B8543A
		test	byte ptr [eax+10h], 1
		jz	short loc_62B8543A
		movzx	edi, word ptr [eax+0Eh]
		mov	ecx, [edx+edi]
		mov	esi, [ebp+var_20]
		mov	[esi+edi], ecx

loc_62B8543A:				; CODE XREF: _silc_client_del_channel_private_key+275j
					; _silc_client_del_channel_private_key+27Bj
		cmp	edx, [eax+8]
		jz	loc_62B854C4

loc_62B85443:				; CODE XREF: _silc_client_del_channel_private_key+31Cj
		sub	dword ptr [eax+10h], 4
		jmp	loc_62B8532D
; ---------------------------------------------------------------------------

loc_62B8544C:				; CODE XREF: _silc_client_del_channel_private_key+24Aj
		mov	ecx, [ebp+var_20]
		mov	edx, [ecx]
		mov	[edi+8], edx
		jmp	short loc_62B853FC
; ---------------------------------------------------------------------------

loc_62B85456:				; CODE XREF: _silc_client_del_channel_private_key+192j
key_0 =	ebx				; SilcChannelPrivateKey
		mov	dword ptr [eax+18h], 0
		jmp	loc_62B85348
; ---------------------------------------------------------------------------

loc_62B85462:				; CODE XREF: _silc_client_del_channel_private_key+1D0j
		movzx	esi, word ptr [edi+0Ch]
		mov	[ebp+var_20], edi
		xor	eax, eax
		jmp	loc_62B853DB
; ---------------------------------------------------------------------------

loc_62B85470:				; CODE XREF: _silc_client_del_channel_private_key+189j
key_0 =	ebx				; SilcChannelPrivateKey
		mov	dword ptr [eax+14h], 0
		jmp	loc_62B8533F
; ---------------------------------------------------------------------------

loc_62B8547C:				; CODE XREF: _silc_client_del_channel_private_key+180j
		mov	esi, [ebp+var_3C]
		mov	[eax+4], esi
		jmp	loc_62B85336
; ---------------------------------------------------------------------------

loc_62B85487:				; CODE XREF: _silc_client_del_channel_private_key+B5j
entry =	edx				; SilcChannelPrivateKey
		mov	dword ptr [esi+154h], 0
		mov	eax, [esi+158h]
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	[esi+138h], eax
		mov	eax, [esi+160h]
		mov	[esp], eax
		call	_silc_hmac_get_name
		mov	[esi+13Ch], eax
		mov	eax, [esi+150h]
		jmp	loc_62B8526B
; ---------------------------------------------------------------------------

loc_62B854C4:				; CODE XREF: _silc_client_del_channel_private_key+28Dj
		mov	edi, [ebp+var_2C]
		mov	ecx, [edi]
		mov	[eax+8], ecx
		jmp	loc_62B85443
; ---------------------------------------------------------------------------

loc_62B854D1:				; CODE XREF: _silc_client_del_channel_private_key+14Bj
		mov	[ebp+var_2C], eax
		movzx	edi, word ptr [eax+0Ch]
		mov	[ebp+var_1C], edi
		mov	[ebp+var_3C], 0
		jmp	loc_62B85415
; ---------------------------------------------------------------------------

loc_62B854E7:				; CODE XREF: _silc_client_del_channel_private_key+11j
					; _silc_client_del_channel_private_key+1Cj ...
entry =	edx				; SilcChannelPrivateKey
		xor	eax, eax
		jmp	loc_62B85251
_silc_client_del_channel_private_key endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  20. silc_client_channel_save_public_keys

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_channel_save_public_keys(SilcChannelEntry channel, unsigned __int8 *chpk_list, SilcUInt32 chpk_list_len,	SilcBool remove_all)
		public _silc_client_channel_save_public_keys
_silc_client_channel_save_public_keys proc near
					; CODE XREF: _silc_client_notify_cmode_change+4FDp
					; _silc_client_notify_cmode_change+706p ...

var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
channel		= dword	ptr  8
chpk_list	= dword	ptr  0Ch
chpk_list_len	= dword	ptr  10h
remove_all	= byte ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		cmp	[ebp+remove_all], 0
		jz	loc_62B85748
		mov	edx, [ebp+channel]
		mov	eax, [edx+110h]
		test	eax, eax
		jz	loc_62B85B07
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
b = esi					; SilcArgumentDecodedList
		nop

loc_62B8552C:				; CODE XREF: _silc_client_channel_save_public_keys+19Aj
		mov	ecx, [ebp+channel]
		mov	ebx, [ecx+110h]
		mov	ecx, ebx
		mov	eax, [ecx+14h]
		mov	[ecx+18h], eax
		mov	eax, [ecx+8]
		test	eax, eax
		jz	short loc_62B855B0

loc_62B85544:				; CODE XREF: _silc_client_channel_save_public_keys+BEj
		test	byte ptr [ecx+10h], 2
		jz	loc_62B85690
		movzx	edx, word ptr [ecx+0Eh]
		mov	edx, [eax+edx]

loc_62B85555:				; CODE XREF: _silc_client_channel_save_public_keys+1A7j
		mov	[ecx+8], edx
		mov	[ecx+14h], eax
		mov	b, [eax]
		test	b, b
		jz	short loc_62B855B7
		mov	edi, [ebx]
		mov	[ebp+var_1C], edi
		mov	eax, edi
		mov	[ebx+8], edi
		and	byte ptr [ebx+10h], 0FDh
		xor	edi, edi
		test	eax, eax
		jz	short loc_62B8559A
		lea	b, [b+0]

loc_62B85578:				; CODE XREF: _silc_client_channel_save_public_keys+A8j
		mov	edx, edi
		test	dl, dl
		jz	loc_62B8563C
		movzx	edx, word ptr [ebx+0Eh]
		mov	edx, [eax+edx]
		mov	[ebx+8], edx
		cmp	b, [eax]
		jz	loc_62B8564E

loc_62B85594:				; CODE XREF: _silc_client_channel_save_public_keys+158j
		mov	eax, edx
		test	eax, eax
		jnz	short loc_62B85578

loc_62B8559A:				; CODE XREF: _silc_client_channel_save_public_keys+83j
		mov	eax, [ebp+channel]
		mov	ebx, [eax+110h]
		mov	eax, [ecx+14h]
		mov	[ecx+18h], eax
		mov	eax, [ecx+8]
		test	eax, eax
		jnz	short loc_62B85544

loc_62B855B0:				; CODE XREF: _silc_client_channel_save_public_keys+52j
		mov	dword ptr [ecx+14h], 0

loc_62B855B7:				; CODE XREF: _silc_client_channel_save_public_keys+6Fj
		test	ebx, ebx
		jz	short loc_62B85623
		mov	b, [ebx]
		mov	[ebx+8], esi
		and	byte ptr [ebx+10h], 0FDh
		test	esi, esi
		jz	short loc_62B8561B

loc_62B855C8:				; CODE XREF: _silc_client_channel_save_public_keys+129j
		test	byte ptr [ebx+10h], 2
		jz	loc_62B856EC
		movzx	eax, word ptr [ebx+0Eh]
		mov	eax, [esi+eax]

loc_62B855D9:				; CODE XREF: _silc_client_channel_save_public_keys+203j
		mov	[ebx+8], eax
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_62B85603
		cmp	esi, eax
		jz	loc_62B85A16
		movzx	edi, word ptr [ebx+0Ch]
		jmp	short loc_62B855FA
; ---------------------------------------------------------------------------

loc_62B855F0:				; CODE XREF: _silc_client_channel_save_public_keys+111j
		cmp	esi, ecx
		jz	loc_62B856F8
		mov	eax, ecx

loc_62B855FA:				; CODE XREF: _silc_client_channel_save_public_keys+FEj
		lea	edx, [eax+edi]
		mov	ecx, [edx]
		test	ecx, ecx
		jnz	short loc_62B855F0

loc_62B85603:				; CODE XREF: _silc_client_channel_save_public_keys+F0j
		cmp	esi, [ebx+4]
		jz	loc_62B85729

loc_62B8560C:				; CODE XREF: _silc_client_channel_save_public_keys+233j
					; _silc_client_channel_save_public_keys+23Cj
		mov	[esp], esi
		call	_silc_free
		mov	esi, [ebx+8]
		test	esi, esi
		jnz	short loc_62B855C8

loc_62B8561B:				; CODE XREF: _silc_client_channel_save_public_keys+D6j
		mov	[esp], ebx
		call	_silc_free

loc_62B85623:				; CODE XREF: _silc_client_channel_save_public_keys+C9j
b = esi					; SilcArgumentDecodedList
		mov	ebx, [ebp+channel]
		mov	dword ptr [ebx+110h], 0
		mov	al, 1

loc_62B85632:				; CODE XREF: _silc_client_channel_save_public_keys+6F8j
chpks =	ebx				; SilcDList
		add	esp, 6Ch
		pop	chpks
		pop	b
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
b = esi					; SilcArgumentDecodedList
		align 4

loc_62B8563C:				; CODE XREF: _silc_client_channel_save_public_keys+8Cj
		movzx	edx, word ptr [ebx+0Ch]
		mov	edx, [eax+edx]
		mov	[ebx+8], edx
		cmp	b, [eax]
		jnz	loc_62B85594

loc_62B8564E:				; CODE XREF: _silc_client_channel_save_public_keys+9Ej
		mov	ecx, [ebp+var_1C]
		test	ecx, ecx
		jz	short loc_62B85673
		cmp	eax, ecx
		jz	loc_62B85A24
		movzx	edi, word ptr [ebx+0Ch]
		jmp	short loc_62B8566A
; ---------------------------------------------------------------------------
		align 4

loc_62B85664:				; CODE XREF: _silc_client_channel_save_public_keys+181j
		cmp	eax, edx
		jz	short loc_62B8569C
		mov	ecx, edx

loc_62B8566A:				; CODE XREF: _silc_client_channel_save_public_keys+171j
b = esi					; SilcArgumentDecodedList
		lea	b, [ecx+edi]
		mov	edx, [esi]
		test	edx, edx
		jnz	short loc_62B85664

loc_62B85673:				; CODE XREF: _silc_client_channel_save_public_keys+163j
b = esi					; SilcArgumentDecodedList
		cmp	eax, [ebx+4]
		jz	short loc_62B856C9

loc_62B85678:				; CODE XREF: _silc_client_channel_save_public_keys+1D7j
		cmp	eax, [ebx+14h]
		jz	short loc_62B856D4

loc_62B8567D:				; CODE XREF: _silc_client_channel_save_public_keys+1DFj
		cmp	eax, [ebx+18h]
		jz	short loc_62B856E0

loc_62B85682:				; CODE XREF: _silc_client_channel_save_public_keys+1EEj
					; _silc_client_channel_save_public_keys+1F7j
		mov	[esp], eax
		call	_silc_free
		jmp	loc_62B8552C
; ---------------------------------------------------------------------------
		align 10h

loc_62B85690:				; CODE XREF: _silc_client_channel_save_public_keys+58j
		movzx	edx, word ptr [ecx+0Ch]
		mov	edx, [eax+edx]
		jmp	loc_62B85555
; ---------------------------------------------------------------------------

loc_62B8569C:				; CODE XREF: _silc_client_channel_save_public_keys+176j
		mov	[ebp+var_20], esi

loc_62B8569F:				; CODE XREF: _silc_client_channel_save_public_keys+53Dj
b = esi					; SilcArgumentDecodedList
		mov	edx, [eax+edi]
		mov	b, [ebp+var_20]
		mov	[esi], edx
		test	edx, edx
		jz	short loc_62B856BB
		test	byte ptr [ebx+10h], 1
		jz	short loc_62B856BB
		movzx	edi, word ptr [ebx+0Eh]
		mov	esi, [eax+edi]
		mov	[edx+edi], esi

loc_62B856BB:				; CODE XREF: _silc_client_channel_save_public_keys+1B9j
					; _silc_client_channel_save_public_keys+1BFj
		cmp	eax, [ebx+8]
		jz	short loc_62B8573B

loc_62B856C0:				; CODE XREF: _silc_client_channel_save_public_keys+253j
		sub	dword ptr [ebx+10h], 4
		cmp	eax, [ebx+4]
		jnz	short loc_62B85678

loc_62B856C9:				; CODE XREF: _silc_client_channel_save_public_keys+186j
b = esi					; SilcArgumentDecodedList
		mov	[ebx+4], ecx
		cmp	eax, [ebx+14h]
		jnz	short loc_62B8567D
		lea	b, [b+0]

loc_62B856D4:				; CODE XREF: _silc_client_channel_save_public_keys+18Bj
		mov	dword ptr [ebx+14h], 0
		cmp	eax, [ebx+18h]
		jnz	short loc_62B85682

loc_62B856E0:				; CODE XREF: _silc_client_channel_save_public_keys+190j
		mov	dword ptr [ebx+18h], 0
		jmp	short loc_62B85682
; ---------------------------------------------------------------------------
		align 4

loc_62B856EC:				; CODE XREF: _silc_client_channel_save_public_keys+DCj
		movzx	eax, word ptr [ebx+0Ch]
		mov	eax, [esi+eax]
		jmp	loc_62B855D9
; ---------------------------------------------------------------------------

loc_62B856F8:				; CODE XREF: _silc_client_channel_save_public_keys+102j
		mov	[ebp+var_20], edx

loc_62B856FB:				; CODE XREF: _silc_client_channel_save_public_keys+52Fj
		mov	ecx, [esi+edi]
		mov	edi, [ebp+var_20]
		mov	[edi], ecx
		test	ecx, ecx
		jz	short loc_62B85717
		test	byte ptr [ebx+10h], 1
		jz	short loc_62B85717
		movzx	edx, word ptr [ebx+0Eh]
		mov	edi, [esi+edx]
		mov	[ecx+edx], edi

loc_62B85717:				; CODE XREF: _silc_client_channel_save_public_keys+215j
					; _silc_client_channel_save_public_keys+21Bj
		cmp	esi, [ebx+8]
		jz	short loc_62B85731

loc_62B8571C:				; CODE XREF: _silc_client_channel_save_public_keys+249j
		sub	dword ptr [ebx+10h], 4
		cmp	esi, [ebx+4]
		jnz	loc_62B8560C

loc_62B85729:				; CODE XREF: _silc_client_channel_save_public_keys+116j
		mov	[ebx+4], eax
		jmp	loc_62B8560C
; ---------------------------------------------------------------------------

loc_62B85731:				; CODE XREF: _silc_client_channel_save_public_keys+22Aj
		mov	ecx, [ebp+var_20]
		mov	edx, [ecx]
		mov	[ebx+8], edx
		jmp	short loc_62B8571C
; ---------------------------------------------------------------------------

loc_62B8573B:				; CODE XREF: _silc_client_channel_save_public_keys+1CEj
		mov	edi, [ebp+var_20]
		mov	edx, [edi]
		mov	[ebx+8], edx
		jmp	loc_62B856C0
; ---------------------------------------------------------------------------

loc_62B85748:				; CODE XREF: _silc_client_channel_save_public_keys+Dj
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+chpk_list_len]
		mov	[esp+4], eax
		mov	eax, [ebp+chpk_list]
		mov	[esp], eax
		call	_silc_argument_list_parse_decoded
		mov	ebx, eax
chpks =	ebx				; SilcDList
		test	eax, eax
		jz	loc_62B85B07
chpks =	eax				; SilcDList
		mov	esi, [ebp+channel]
		mov	edi, [esi+110h]
		test	edi, edi
		jz	loc_62B85BC3

loc_62B8577D:				; CODE XREF: _silc_client_channel_save_public_keys+6E0j
chpks =	ebx				; SilcDList
		mov	eax, [chpks]
		mov	[chpks+8], eax
		and	byte ptr [chpks+10h], 0FDh
		mov	dword ptr [chpks+18h], 0
		mov	dword ptr [chpks+14h], 0
		xor	eax, eax
		mov	esi, [ebp+channel]
		mov	[chpks+18h], eax
		mov	eax, [chpks+8]
		test	eax, eax
		jz	loc_62B8586E
channel_0 = esi				; SilcChannelEntry
a = edi					; SilcArgumentDecodedList
b = edx					; SilcArgumentDecodedList
found =	ecx				; SilcBool
		nop

loc_62B857A8:				; CODE XREF: _silc_client_channel_save_public_keys+378j
		test	byte ptr [chpks+10h], 2
		jz	loc_62B859C0
		movzx	b, word	ptr [chpks+0Eh]
		mov	edx, [eax+edx]

loc_62B857B9:				; CODE XREF: _silc_client_channel_save_public_keys+4D7j
		mov	[chpks+8], edx
		mov	[chpks+14h], eax
		mov	a, [eax]
		test	a, a
		jz	loc_62B85875
		mov	eax, [channel_0+110h]
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	[ebp+var_1C], chpks
		jmp	short loc_62B85817
; ---------------------------------------------------------------------------
		align 4

loc_62B857EC:				; CODE XREF: _silc_client_channel_save_public_keys+33Ej
		movzx	found, word ptr	[eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B857F3:				; CODE XREF: _silc_client_channel_save_public_keys+347j
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	chpks, [edx]
b = ebx					; SilcArgumentDecodedList
		test	b, b
		jz	loc_62B85C26
		mov	eax, [b]
		mov	[esp+4], eax
		mov	eax, [a]
		mov	[esp], eax
		call	_silc_pkcs_public_key_compare
		test	al, al
		jnz	short loc_62B85890

loc_62B85817:				; CODE XREF: _silc_client_channel_save_public_keys+2F9j
chpks =	ebx				; SilcDList
found =	ecx				; SilcBool
		mov	eax, [channel_0+110h]
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B8583C
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B857EC
		movzx	found, word ptr	[eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	short loc_62B857F3
; ---------------------------------------------------------------------------
found =	ecx				; SilcBool
		align 4

loc_62B8583C:				; CODE XREF: _silc_client_channel_save_public_keys+338j
		mov	chpks, [ebp+var_1C]
		mov	dword ptr [eax+14h], 0
		xor	edx, edx
b = edx					; SilcArgumentDecodedList
		xor	found, found

loc_62B8584A:				; CODE XREF: _silc_client_channel_save_public_keys+73Dj
		mov	eax, [a+4]
		test	eax, eax
		jz	short loc_62B8589E

loc_62B85851:				; CODE XREF: _silc_client_channel_save_public_keys+3ACj
		cmp	eax, 3
		jz	short loc_62B8589E

loc_62B85856:				; CODE XREF: _silc_client_channel_save_public_keys+3B0j
		dec	eax
		jz	loc_62B859CC

loc_62B8585D:				; CODE XREF: _silc_client_channel_save_public_keys+432j
					; _silc_client_channel_save_public_keys+44Ej ...
		mov	eax, [chpks+14h]
		mov	[chpks+18h], eax
		mov	eax, [chpks+8]
		test	eax, eax
		jnz	loc_62B857A8

loc_62B8586E:				; CODE XREF: _silc_client_channel_save_public_keys+2B1j
		mov	dword ptr [chpks+14h], 0

loc_62B85875:				; CODE XREF: _silc_client_channel_save_public_keys+2D3j
		mov	dword ptr [esp+4], 1
		mov	[esp], chpks
		call	_silc_argument_list_free
		mov	al, 1
		add	esp, 6Ch
		pop	chpks
		pop	channel_0
		pop	a
		leave
		retn
; ---------------------------------------------------------------------------
channel_0 = esi				; SilcChannelEntry
a = edi					; SilcArgumentDecodedList
b = ebx					; SilcArgumentDecodedList
		align 10h

loc_62B85890:				; CODE XREF: _silc_client_channel_save_public_keys+325j
		mov	edx, b
		mov	b, [ebp+var_1C]
b = edx					; SilcArgumentDecodedList
chpks =	ebx				; SilcDList
		mov	cl, 1
found =	ecx				; SilcBool
		mov	eax, [a+4]
		test	eax, eax
		jnz	short loc_62B85851

loc_62B8589E:				; CODE XREF: _silc_client_channel_save_public_keys+35Fj
					; _silc_client_channel_save_public_keys+364j
		test	cl, cl
		jnz	short loc_62B85856
		mov	eax, [channel_0+110h]
		mov	[ebp+var_28], eax
		mov	dword ptr [esp], 0Ch
		call	_silc_malloc
		mov	[ebp+var_24], eax
		test	eax, eax
		jz	short loc_62B85910
		mov	[eax], a
		mov	edx, [ebp+var_28]
		mov	ecx, [edx]
		test	ecx, ecx
		jz	loc_62B85B1D
		mov	eax, [ebp+var_28]
		movzx	eax, word ptr [eax+0Ch]
		mov	[ebp+var_1C], eax
		mov	edx, [ebp+var_28]
		mov	edx, [edx+4]
		mov	ecx, [ebp+var_24]
		mov	[edx+eax], ecx

loc_62B858E3:				; CODE XREF: _silc_client_channel_save_public_keys+636j
		mov	eax, [ebp+var_28]
		test	byte ptr [eax+10h], 1
		jz	short loc_62B858F9
		movzx	edx, word ptr [eax+0Eh]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_24]
		mov	[eax+edx], ecx

loc_62B858F9:				; CODE XREF: _silc_client_channel_save_public_keys+3FAj
		mov	ecx, [ebp+var_24]
		mov	edx, [ebp+var_28]
		mov	[edx+4], ecx
		mov	eax, [ebp+var_1C]
		mov	dword ptr [ecx+eax], 0
		add	dword ptr [edx+10h], 4

loc_62B85910:				; CODE XREF: _silc_client_channel_save_public_keys+3CCj
		mov	edx, [chpks]
		mov	[ebp+var_1C], edx
		mov	eax, edx
		mov	[chpks+8], edx
		and	byte ptr [chpks+10h], 0FDh
		xor	ecx, ecx
		test	eax, eax
		jz	loc_62B8585D
		test	cl, cl
		jz	short loc_62B85948

loc_62B8592C:				; CODE XREF: _silc_client_channel_save_public_keys+456j
		movzx	edx, word ptr [chpks+0Eh]
		mov	edx, [eax+edx]
		mov	[chpks+8], edx
		cmp	a, [eax]
		jz	short loc_62B85956

loc_62B8593A:				; CODE XREF: _silc_client_channel_save_public_keys+464j
		mov	eax, edx
		test	eax, eax
		jz	loc_62B8585D
		test	cl, cl
		jnz	short loc_62B8592C

loc_62B85948:				; CODE XREF: _silc_client_channel_save_public_keys+43Aj
		movzx	edx, word ptr [chpks+0Ch]
		mov	edx, [eax+edx]
		mov	[chpks+8], edx
		cmp	a, [eax]
		jnz	short loc_62B8593A

loc_62B85956:				; CODE XREF: _silc_client_channel_save_public_keys+448j
		mov	ecx, [ebp+var_1C]
		mov	[ebp+var_28], ecx
		test	ecx, ecx
		jz	short loc_62B85995
		cmp	eax, ecx
		jz	loc_62B85BED
		movzx	edx, word ptr [chpks+0Ch]
		mov	[ebp+var_1C], edx
		mov	ecx, [ebp+var_28]
		mov	[ebp+var_20], chpks
		mov	chpks, edx
		jmp	short loc_62B85986
; ---------------------------------------------------------------------------
		align 4

loc_62B8597C:				; CODE XREF: _silc_client_channel_save_public_keys+49Dj
		cmp	eax, edx
		jz	loc_62B85AC7
		mov	ecx, edx

loc_62B85986:				; CODE XREF: _silc_client_channel_save_public_keys+487j
a = edi					; SilcArgumentDecodedList
		lea	a, [ecx+ebx]
		mov	edx, [edi]
		test	edx, edx
		jnz	short loc_62B8597C
		mov	[ebp+var_28], ecx
		mov	ebx, [ebp+var_20]

loc_62B85995:				; CODE XREF: _silc_client_channel_save_public_keys+46Ej
					; _silc_client_channel_save_public_keys+612j
a = edi					; SilcArgumentDecodedList
chpks =	ebx				; SilcDList
		cmp	eax, [chpks+4]
		jz	loc_62B85B6A

loc_62B8599E:				; CODE XREF: _silc_client_channel_save_public_keys+680j
		cmp	eax, [chpks+14h]
		jz	loc_62B85B75

loc_62B859A7:				; CODE XREF: _silc_client_channel_save_public_keys+68Cj
		cmp	eax, [chpks+18h]
		jz	loc_62B85B11

loc_62B859B0:				; CODE XREF: _silc_client_channel_save_public_keys+628j
		mov	[esp], eax
		call	_silc_free
		jmp	loc_62B8585D
; ---------------------------------------------------------------------------
b = edx					; SilcArgumentDecodedList
found =	ecx				; SilcBool
		align 10h

loc_62B859C0:				; CODE XREF: _silc_client_channel_save_public_keys+2BCj
		movzx	b, word	ptr [chpks+0Ch]
		mov	edx, [eax+edx]
		jmp	loc_62B857B9
; ---------------------------------------------------------------------------

loc_62B859CC:				; CODE XREF: _silc_client_channel_save_public_keys+367j
b = edx					; SilcArgumentDecodedList
		test	cl, cl
		jz	loc_62B8585D
		mov	found, [channel_0+110h]
		mov	a, [ecx]
		mov	[ebp+var_1C], edi
		mov	[ebp+var_4C], edi
		mov	[ecx+8], edi
		and	byte ptr [ecx+10h], 0FDh
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_20], chpks
		test	eax, eax
		jz	short loc_62B85A0E
		nop

loc_62B859F4:				; CODE XREF: _silc_client_channel_save_public_keys+51Cj
		xor	chpks, chpks
		test	bl, bl
		jz	short loc_62B85A32
		movzx	edi, word ptr [ecx+0Eh]
		mov	edi, [eax+edi]
		mov	[ecx+8], edi
		cmp	b, [eax]
		jz	short loc_62B85A40

loc_62B85A08:				; CODE XREF: _silc_client_channel_save_public_keys+54Ej
		mov	eax, edi
		test	eax, eax
		jnz	short loc_62B859F4

loc_62B85A0E:				; CODE XREF: _silc_client_channel_save_public_keys+501j
chpks =	ebx				; SilcDList
		mov	chpks, [ebp+var_20]
		jmp	loc_62B8585D
; ---------------------------------------------------------------------------

loc_62B85A16:				; CODE XREF: _silc_client_channel_save_public_keys+F4j
		movzx	edi, word ptr [ebx+0Ch]
		mov	[ebp+var_20], ebx
		xor	eax, eax
		jmp	loc_62B856FB
; ---------------------------------------------------------------------------

loc_62B85A24:				; CODE XREF: _silc_client_channel_save_public_keys+167j
b = esi					; SilcArgumentDecodedList
		mov	[ebp+var_20], ebx
		movzx	edi, word ptr [ebx+0Ch]
		xor	ecx, ecx
		jmp	loc_62B8569F
; ---------------------------------------------------------------------------

loc_62B85A32:				; CODE XREF: _silc_client_channel_save_public_keys+508j
channel_0 = esi				; SilcChannelEntry
b = edx					; SilcArgumentDecodedList
		movzx	edi, word ptr [ecx+0Ch]
		mov	edi, [eax+edi]
		mov	[ecx+8], edi
		cmp	b, [eax]
		jnz	short loc_62B85A08

loc_62B85A40:				; CODE XREF: _silc_client_channel_save_public_keys+516j
		mov	[ebp+var_4C], eax
		mov	ebx, [ebp+var_20]
chpks =	ebx				; SilcDList
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_3C], eax
		test	eax, eax
		jz	short loc_62B85A93
		cmp	[ebp+var_4C], eax
		jz	loc_62B85C03
		movzx	eax, word ptr [ecx+0Ch]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_24], ecx
		mov	edi, [ebp+var_3C]
		mov	[ebp+var_28], chpks
		mov	chpks, [ebp+var_1C]
		jmp	short loc_62B85A7E
; ---------------------------------------------------------------------------
		align 4

loc_62B85A74:				; CODE XREF: _silc_client_channel_save_public_keys+595j
		cmp	eax, edx
		jz	loc_62B85B2B
		mov	edi, edx

loc_62B85A7E:				; CODE XREF: _silc_client_channel_save_public_keys+57Fj
b = edx					; SilcArgumentDecodedList
		lea	ecx, [edi+ebx]
		mov	b, [ecx]
		test	edx, edx
		jnz	short loc_62B85A74
		mov	[ebp+var_4C], eax
		mov	ecx, [ebp+var_24]
		mov	[ebp+var_3C], edi
		mov	ebx, [ebp+var_28]

loc_62B85A93:				; CODE XREF: _silc_client_channel_save_public_keys+55Ej
					; _silc_client_channel_save_public_keys+675j
b = edx					; SilcArgumentDecodedList
chpks =	ebx				; SilcDList
		mov	b, [ebp+var_4C]
		cmp	edx, [ecx+4]
		jz	loc_62B85BB8

loc_62B85A9F:				; CODE XREF: _silc_client_channel_save_public_keys+6CEj
		mov	eax, [ebp+var_4C]
		cmp	eax, [ecx+14h]
		jz	loc_62B85BAC

loc_62B85AAB:				; CODE XREF: _silc_client_channel_save_public_keys+6C3j
		mov	edx, [ebp+var_4C]
		cmp	edx, [ecx+18h]
		jz	loc_62B85B93

loc_62B85AB7:				; CODE XREF: _silc_client_channel_save_public_keys+6AAj
		mov	ecx, [ebp+var_4C]
		mov	[esp], ecx
		call	_silc_free
		jmp	loc_62B8585D
; ---------------------------------------------------------------------------

loc_62B85AC7:				; CODE XREF: _silc_client_channel_save_public_keys+48Ej
		mov	[ebp+var_24], edi
		mov	[ebp+var_28], ecx
		mov	ebx, [ebp+var_20]

loc_62B85AD0:				; CODE XREF: _silc_client_channel_save_public_keys+70Ej
chpks =	ebx				; SilcDList
		mov	edx, [ebp+var_1C]
		mov	edx, [eax+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_24]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B85AF5
		test	byte ptr [chpks+10h], 1
		jz	short loc_62B85AF5
		movzx	edi, word ptr [chpks+0Eh]
		mov	edx, [eax+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B85AF5:				; CODE XREF: _silc_client_channel_save_public_keys+5F0j
					; _silc_client_channel_save_public_keys+5F6j
		cmp	eax, [chpks+8]
		jz	loc_62B85B9F

loc_62B85AFE:				; CODE XREF: _silc_client_channel_save_public_keys+6B7j
		sub	dword ptr [chpks+10h], 4
		jmp	loc_62B85995
; ---------------------------------------------------------------------------

loc_62B85B07:				; CODE XREF: _silc_client_channel_save_public_keys+1Ej
					; _silc_client_channel_save_public_keys+276j
chpks =	eax				; SilcDList
		xor	chpks, chpks
chpks =	ebx				; SilcDList
		add	esp, 6Ch
		pop	chpks
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B85B11:				; CODE XREF: _silc_client_channel_save_public_keys+4BAj
channel_0 = esi				; SilcChannelEntry
a = edi					; SilcArgumentDecodedList
chpks =	ebx				; SilcDList
		mov	dword ptr [chpks+18h], 0
		jmp	loc_62B859B0
; ---------------------------------------------------------------------------

loc_62B85B1D:				; CODE XREF: _silc_client_channel_save_public_keys+3D7j
		mov	[edx], eax
		movzx	ecx, word ptr [edx+0Ch]
		mov	[ebp+var_1C], ecx
		jmp	loc_62B858E3
; ---------------------------------------------------------------------------

loc_62B85B2B:				; CODE XREF: _silc_client_channel_save_public_keys+586j
		mov	[ebp+var_4C], eax
		mov	[ebp+var_20], ecx
		mov	ecx, [ebp+var_24]
		mov	[ebp+var_3C], edi
		mov	ebx, [ebp+var_28]

loc_62B85B3A:				; CODE XREF: _silc_client_channel_save_public_keys+724j
chpks =	ebx				; SilcDList
		mov	eax, [ebp+var_4C]
		mov	edi, [ebp+var_1C]
		mov	edi, [eax+edi]
		mov	[ebp+var_24], edi
		mov	eax, [ebp+var_20]
		mov	[eax], edi
		test	edi, edi
		jz	short loc_62B85B55
		test	byte ptr [ecx+10h], 1
		jnz	short loc_62B85B81

loc_62B85B55:				; CODE XREF: _silc_client_channel_save_public_keys+65Dj
					; _silc_client_channel_save_public_keys+6A1j
		mov	edx, [ebp+var_4C]
		cmp	edx, [ecx+8]
		jz	loc_62B85C19

loc_62B85B61:				; CODE XREF: _silc_client_channel_save_public_keys+731j
		sub	dword ptr [ecx+10h], 4
		jmp	loc_62B85A93
; ---------------------------------------------------------------------------

loc_62B85B6A:				; CODE XREF: _silc_client_channel_save_public_keys+4A8j
a = edi					; SilcArgumentDecodedList
		mov	ecx, [ebp+var_28]
		mov	[chpks+4], ecx
		jmp	loc_62B8599E
; ---------------------------------------------------------------------------

loc_62B85B75:				; CODE XREF: _silc_client_channel_save_public_keys+4B1j
		mov	dword ptr [chpks+14h], 0
		jmp	loc_62B859A7
; ---------------------------------------------------------------------------

loc_62B85B81:				; CODE XREF: _silc_client_channel_save_public_keys+663j
		movzx	edx, word ptr [ecx+0Eh]
		mov	edi, [ebp+var_4C]
		mov	edi, [edi+edx]
		mov	eax, [ebp+var_24]
		mov	[eax+edx], edi
		jmp	short loc_62B85B55
; ---------------------------------------------------------------------------

loc_62B85B93:				; CODE XREF: _silc_client_channel_save_public_keys+5C1j
		mov	dword ptr [ecx+18h], 0
		jmp	loc_62B85AB7
; ---------------------------------------------------------------------------

loc_62B85B9F:				; CODE XREF: _silc_client_channel_save_public_keys+608j
		mov	edi, [ebp+var_24]
		mov	edx, [edi]
		mov	[chpks+8], edx
		jmp	loc_62B85AFE
; ---------------------------------------------------------------------------

loc_62B85BAC:				; CODE XREF: _silc_client_channel_save_public_keys+5B5j
		mov	dword ptr [ecx+14h], 0
		jmp	loc_62B85AAB
; ---------------------------------------------------------------------------

loc_62B85BB8:				; CODE XREF: _silc_client_channel_save_public_keys+5A9j
		mov	edi, [ebp+var_3C]
		mov	[ecx+4], edi
		jmp	loc_62B85A9F
; ---------------------------------------------------------------------------

loc_62B85BC3:				; CODE XREF: _silc_client_channel_save_public_keys+287j
chpks =	eax				; SilcDList
		call	_silc_dlist_init
chpks =	ebx				; SilcDList
		mov	[esi+110h], eax
		test	eax, eax
		jnz	loc_62B8577D
		mov	dword ptr [esp+4], 1
		mov	[esp], chpks
		call	_silc_argument_list_free
		xor	eax, eax
		jmp	loc_62B85632
; ---------------------------------------------------------------------------

loc_62B85BED:				; CODE XREF: _silc_client_channel_save_public_keys+472j
channel_0 = esi				; SilcChannelEntry
a = edi					; SilcArgumentDecodedList
		movzx	a, word	ptr [chpks+0Ch]
		mov	[ebp+var_1C], edi
		mov	[ebp+var_24], chpks
		mov	[ebp+var_28], 0
		jmp	loc_62B85AD0
; ---------------------------------------------------------------------------

loc_62B85C03:				; CODE XREF: _silc_client_channel_save_public_keys+563j
b = edx					; SilcArgumentDecodedList
		mov	[ebp+var_20], ecx
		movzx	b, word	ptr [ecx+0Ch]
		mov	[ebp+var_1C], edx
		mov	[ebp+var_3C], 0
		jmp	loc_62B85B3A
; ---------------------------------------------------------------------------

loc_62B85C19:				; CODE XREF: _silc_client_channel_save_public_keys+66Bj
		mov	edi, [ebp+var_20]
		mov	edx, [edi]
		mov	[ecx+8], edx
		jmp	loc_62B85B61
; ---------------------------------------------------------------------------

loc_62B85C26:				; CODE XREF: _silc_client_channel_save_public_keys+30Dj
a = edi					; SilcArgumentDecodedList
b = ebx					; SilcArgumentDecodedList
		mov	edx, b
		mov	b, [ebp+var_1C]
b = edx					; SilcArgumentDecodedList
chpks =	ebx				; SilcDList
		xor	ecx, ecx
found =	ecx				; SilcBool
		jmp	loc_62B8584A
_silc_client_channel_save_public_keys endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 146. silc_client_list_channel_private_keys

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcDList __cdecl silc_client_list_channel_private_keys(SilcClient client, SilcClientConnection conn,	SilcChannelEntry channel)
		public _silc_client_list_channel_private_keys
_silc_client_list_channel_private_keys proc near

client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	esi, [ebp+channel]
		mov	edi, [ebp+client]
		test	edi, edi
		jnz	short loc_62B85C54

loc_62B85C47:				; CODE XREF: _silc_client_list_channel_private_keys+25j
					; _silc_client_list_channel_private_keys+29j ...
channel_0 = esi				; SilcChannelEntry
		xor	ebx, ebx

loc_62B85C49:				; CODE XREF: _silc_client_list_channel_private_keys+3Ej
					; _silc_client_list_channel_private_keys+71j ...
entry =	edi				; SilcChannelPrivateKey
list = ebx				; SilcDList
		mov	eax, list
		add	esp, 1Ch
		pop	list
		pop	channel_0
		pop	entry
		leave
		retn
; ---------------------------------------------------------------------------
channel_0 = esi				; SilcChannelEntry
		align 4

loc_62B85C54:				; CODE XREF: _silc_client_list_channel_private_keys+11j
		mov	ebx, [ebp+conn]
		test	ebx, ebx
		jz	short loc_62B85C47
		test	channel_0, channel_0
		jz	short loc_62B85C47
		mov	ecx, [channel_0+150h]
		test	ecx, ecx
		jz	short loc_62B85C47
		call	_silc_dlist_init
		mov	ebx, eax
list = ebx				; SilcDList
		test	eax, eax
		jz	short loc_62B85C49
list = eax				; SilcDList
		mov	list, [channel_0+150h]
list = ebx				; SilcDList
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		jmp	short loc_62B85CE7
; ---------------------------------------------------------------------------
entry =	edi				; SilcChannelPrivateKey
		align 4

loc_62B85C94:				; CODE XREF: _silc_client_list_channel_private_keys+CAj
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B85C9B:				; CODE XREF: _silc_client_list_channel_private_keys+D3j
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	entry, [edx]
		test	entry, entry
		jz	short loc_62B85C49
		mov	dword ptr [esp], 0Ch
		call	_silc_malloc
		test	eax, eax
		jz	short loc_62B85CE7
		mov	[eax], entry
		mov	edx, [list]
		test	edx, edx
		jz	short loc_62B85D18
		movzx	edx, word ptr [list+0Ch]
		mov	ecx, [list+4]
		mov	[ecx+edx], eax

loc_62B85CC9:				; CODE XREF: _silc_client_list_channel_private_keys+EAj
		test	byte ptr [list+10h], 1
		jz	short loc_62B85CD9
		movzx	ecx, word ptr [list+0Eh]
		mov	entry, [list+4]
		mov	[eax+ecx], edi

loc_62B85CD9:				; CODE XREF: _silc_client_list_channel_private_keys+99j
entry =	edi				; SilcChannelPrivateKey
		mov	[list+4], eax
		mov	dword ptr [eax+edx], 0
		add	dword ptr [list+10h], 4

loc_62B85CE7:				; CODE XREF: _silc_client_list_channel_private_keys+5Dj
					; _silc_client_list_channel_private_keys+81j
		mov	eax, [channel_0+150h]
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B85D0C
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B85C94
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	short loc_62B85C9B
; ---------------------------------------------------------------------------
		align 4

loc_62B85D0C:				; CODE XREF: _silc_client_list_channel_private_keys+C4j
		mov	dword ptr [eax+14h], 0
		jmp	loc_62B85C49
; ---------------------------------------------------------------------------

loc_62B85D18:				; CODE XREF: _silc_client_list_channel_private_keys+89j
		mov	[list],	eax
		movzx	edx, word ptr [list+0Ch]
		jmp	short loc_62B85CC9
_silc_client_list_channel_private_keys endp

; Exported entry 215. silc_client_st_rekey

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_rekey(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_st_rekey
_silc_client_st_rekey proc near		; DATA XREF: _silc_client_connection_st_run+B0o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4Ch]
client = eax				; SilcClient
		mov	edi, [ebx+54h]
		test	byte ptr [edi+12Dh], 2
		jz	short loc_62B85D4C

loc_62B85D3E:				; CODE XREF: _silc_client_st_rekey+6Dj
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	client,	3
		add	esp, 2Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
client = eax				; SilcClient
		align 4

loc_62B85D4C:				; CODE XREF: _silc_client_st_rekey+1Cj
		mov	[esp+14h], fsm_0
		mov	dword ptr [esp+10h], 0
		mov	edx, [fsm_context_0+34h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	edx, [edi+0B4h]
		mov	[esp+4], edx
		mov	client,	[client+10h]
		mov	[esp], eax
		call	_silc_ske_alloc
		mov	[edi+0BCh], eax
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+0BCh]
		test	eax, eax
		jz	short loc_62B85D3E
		mov	[esp+0Ch], fsm_0
		mov	dword ptr [esp+8], offset _silc_client_rekey_completion
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	_silc_ske_set_callbacks
		mov	eax, [fsm_context_0+54h]
		test	byte ptr [eax+12Dh], 40h
		jz	short loc_62B85E18
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	loc_62B85E58

loc_62B85DCA:				; CODE XREF: _silc_client_st_rekey+164j
		mov	edi, [fsm_context_0+54h]
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [edi+0C0h]
		mov	[esp+8], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp+4], eax
		mov	eax, [edi+0BCh]
		mov	[esp], eax
		call	_silc_ske_rekey_responder

loc_62B85DF4:				; CODE XREF: _silc_client_st_rekey+129j
		mov	[edi+0FCh], eax
		mov	al, [fsm_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		test	al, 4
		jz	short loc_62B85E4C
		mov	eax, 2
		add	esp, 2Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B85E18:				; CODE XREF: _silc_client_st_rekey+95j
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	short loc_62B85E8C

loc_62B85E27:				; CODE XREF: _silc_client_st_rekey+198j
		mov	edi, [fsm_context_0+54h]
		mov	eax, [edi+0C0h]
		mov	[esp+8], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp+4], eax
		mov	eax, [edi+0BCh]
		mov	[esp], eax
		call	_silc_ske_rekey_initiator
		jmp	short loc_62B85DF4
; ---------------------------------------------------------------------------
		align 4

loc_62B85E4C:				; CODE XREF: _silc_client_st_rekey+E7j
		xor	eax, eax
		add	esp, 2Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B85E58:				; CODE XREF: _silc_client_st_rekey+A4j
		mov	dword ptr [esp+8], 32Ch
		mov	dword ptr [esp+4], offset aClient_connect ; "client_connect.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_0	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B85DCA
; ---------------------------------------------------------------------------
		align 4

loc_62B85E8C:				; CODE XREF: _silc_client_st_rekey+105j
		mov	dword ptr [esp+8], 326h
		mov	dword ptr [esp+4], offset aClient_connect ; "client_connect.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_0	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B85E27
_silc_client_st_rekey endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_rekey_completion(SilcSKE ske, SilcSKEStatus status, SilcSKESecurityProperties prop, SilcSKEKeyMaterial keymat, SilcSKERekeyMaterial rekey, void *context)
_silc_client_rekey_completion proc near	; DATA XREF: _silc_client_st_rekey+73o

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ske		= dword	ptr  8
status		= dword	ptr  0Ch
prop		= dword	ptr  10h
keymat		= dword	ptr  14h
rekey		= dword	ptr  18h
context		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	edi, [ebp+status]
		mov	eax, [ebp+rekey]
		mov	[ebp+var_1C], eax
		mov	esi, [ebp+context]
fsm = esi				; SilcFSMThread
		mov	[esp], fsm
		call	_silc_fsm_get_context
		mov	ebx, eax
conn = ebx				; SilcClientConnection
		mov	edx, [eax+4Ch]
client = edx				; SilcClient
		mov	eax, [eax+54h]
		mov	dword ptr [eax+0FCh], 0
		test	edi, edi
		jz	short loc_62B85F6C
status_0 = edi				; SilcSKEStatus
		test	byte ptr [eax+12Dh], 10h
		jnz	short loc_62B85F28

loc_62B85EFC:				; CODE XREF: _silc_client_rekey_completion+A9j
					; _silc_client_rekey_completion+C6j
		mov	eax, [eax+0BCh]
		mov	[esp], eax
		call	_silc_ske_free
		mov	eax, [conn+54h]
		mov	dword ptr [eax+0BCh], 0
		mov	[ebp+ske], fsm
		add	esp, 3Ch
		pop	conn
		pop	fsm
		pop	status_0
		leave
		jmp	_silc_fsm_finish
; ---------------------------------------------------------------------------
status_0 = edi				; SilcSKEStatus
fsm = esi				; SilcFSMThread
conn = ebx				; SilcClientConnection
client = edx				; SilcClient
		align 4

loc_62B85F28:				; CODE XREF: _silc_client_rekey_completion+3Aj
		mov	eax, [client+18h]
		mov	eax, [eax+48h]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	[esp], status_0
		mov	[ebp+var_20], client
		call	_silc_ske_map_status
		mov	[esp+14h], eax
		mov	eax, [conn+8]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aErrorDuringRek ; "Error during rekey with %s: %s"
		mov	dword ptr [esp+8], 2
		mov	[esp+4], conn
		mov	edx, [ebp+var_20]
		mov	[esp], edx
client = edx				; SilcClient
		call	[ebp+var_1C]
		mov	eax, [conn+54h]
		jmp	short loc_62B85EFC
; ---------------------------------------------------------------------------
client = edx				; SilcClient
		align 4

loc_62B85F6C:				; CODE XREF: _silc_client_rekey_completion+31j
		mov	eax, [eax+0C0h]
		mov	[esp], eax
		call	_silc_ske_free_rekey_material
		mov	eax, [conn+54h]
		mov	edx, [ebp+var_1C]
		mov	[eax+0C0h], edx
		jmp	loc_62B85EFC
_silc_client_rekey_completion endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 191. silc_client_rekey_timer

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_rekey_timer(SilcSchedule schedule, void *app_context, SilcTaskEvent type, SilcUInt32	fd, void *context)
		public _silc_client_rekey_timer
_silc_client_rekey_timer proc near	; DATA XREF: _silc_client_rekey_timer+5Do
					; _silc_client_st_connected+AAo

schedule	= dword	ptr  8
app_context	= dword	ptr  0Ch
type		= dword	ptr  10h
fd		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	ebx, [ebp+context]
		mov	eax, [ebx+54h]
		add	eax, 6Ch
		mov	[esp], eax
		call	_silc_fsm_is_started
		test	al, al
		jnz	short loc_62B85FCB
context_0 = ebx				; void *
		mov	edx, [context_0+54h]
		mov	al, [edx+12Dh]
		and	eax, 0FFFFFFBFh
		or	eax, 8
		mov	[edx+12Dh], al
		add	edx, 98h
		mov	[esp], edx
		call	_silc_fsm_event_signal

loc_62B85FCB:				; CODE XREF: _silc_client_rekey_timer+1Aj
		mov	eax, [context_0+54h]
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 0
		mov	edx, [eax+34h]
		mov	[esp+10h], edx
		mov	[esp+0Ch], context_0
		mov	dword ptr [esp+8], offset _silc_client_rekey_timer
		mov	dword ptr [esp+4], 0
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_add
		add	esp, 24h
		pop	context_0
		leave
		retn
_silc_client_rekey_timer endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 207. silc_client_st_connect_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_connect_error(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_st_connect_error
_silc_client_st_connect_error proc near	; DATA XREF: _silc_client_st_connect_auth_data:loc_62B86164o
					; _silc_client_st_connected:loc_62B86338o ...

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+54h]
		mov	edx, [eax+0BCh]
		test	edx, edx
		jz	short loc_62B8603C
fsm_context_0 =	ebx			; void *
		mov	[esp], edx
		call	_silc_ske_free
		mov	eax, [fsm_context_0+54h]
		mov	dword ptr [eax+0BCh], 0

loc_62B8603C:				; CODE XREF: _silc_client_st_connect_error+15j
		mov	dl, [eax+12Dh]
		test	dl, 2
		jnz	short loc_62B86060
		or	edx, 2
		mov	[eax+12Dh], dl
		add	eax, 98h
		mov	[esp], eax
		call	_silc_fsm_event_signal
		mov	eax, [fsm_context_0+54h]

loc_62B86060:				; CODE XREF: _silc_client_st_connect_error+35j
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_connect_timeout
		mov	dword ptr [esp+4], 0
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_all
		mov	eax, 3
		add	esp, 14h
		pop	fsm_context_0
		leave
		retn
_silc_client_st_connect_error endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ke_verify_key_cb(SilcBool success, void *context)
_silc_client_ke_verify_key_cb proc near	; DATA XREF: _silc_client_ke_verify_key+6Eo

success		= dword	ptr  8
context		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		mov	edx, [ebx+4]
		mov	ecx, [ebx+8]
		cmp	byte ptr [ebp+success],	1
		sbb	eax, eax
		and	eax, 8
		mov	[esp+8], ecx
		mov	[esp+4], eax
		mov	eax, [ebx]
		mov	[esp], eax
		call	edx
		mov	[ebp+success], ebx
		add	esp, 14h
		pop	ebx
		leave
		jmp	_silc_free
_silc_client_ke_verify_key_cb endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 204. silc_client_st_connect_auth_data

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_connect_auth_data(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_st_connect_auth_data
_silc_client_st_connect_auth_data proc near
					; DATA XREF: _silc_client_st_connect_auth_resolve+8Eo

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebx+4Ch]
client = edi				; SilcClient
		mov	eax, [ebx+54h]
		mov	dl, [eax+12Dh]
		test	dl, 2
		jnz	short loc_62B86164
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		and	edx, 7Fh
		mov	[eax+12Dh], dl
		mov	dword ptr [esp+4], offset _silc_client_st_connect_auth_start
		mov	[esp], fsm_0
		call	_silc_fsm_next
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	short loc_62B86180

loc_62B86110:				; CODE XREF: _silc_client_st_connect_auth_data+E4j
		mov	eax, [client+18h]
		mov	eax, [eax+48h]
		mov	[esp+18h], fsm_0
		mov	dword ptr [esp+14h], offset _silc_client_connect_auth_method
		mov	edx, [fsm_context_0+54h]
		movzx	edx, word ptr [edx+0Ah]
		mov	[esp+10h], edx
		movzx	edx, word ptr [fsm_context_0+0Ch]
		mov	[esp+0Ch], edx
		mov	edx, [fsm_context_0+8]
		mov	[esp+8], edx
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		call	dword ptr [eax+18h]
		mov	dl, [fsm_0+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		shl	eax, 1
		and	eax, 2
		add	esp, 2Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
client = edi				; SilcClient
		align 4

loc_62B86164:				; CODE XREF: _silc_client_st_connect_auth_data+1Ej
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 2Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
client = edi				; SilcClient
		align 10h

loc_62B86180:				; CODE XREF: _silc_client_st_connect_auth_data+46j
		mov	dword ptr [esp+8], 270h
		mov	dword ptr [esp+4], offset aClient_connect ; "client_connect.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_0	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B86110
_silc_client_st_connect_auth_data endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 211. silc_client_st_connected

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_connected(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_st_connected
_silc_client_st_connected proc near	; DATA XREF: _silc_client_st_connect_auth_start+4Fo
					; _silc_client_st_connect_key_exchange:loc_62B86B11o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4Ch]
client = esi				; SilcClient
		mov	eax, [ebx+54h]
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		lea	edx, [eax+120h]
		mov	[esp+4], edx
		mov	eax, [eax+0BCh]
		mov	[esp], eax
		call	_silc_ske_parse_version
		mov	eax, [ebx+54h]
		mov	eax, [eax+0BCh]
		mov	[esp], eax
		call	_silc_ske_free
		mov	eax, [ebx+54h]
		mov	dword ptr [eax+0BCh], 0
		mov	edx, [eax+8]
		xor	dl, dl
		cmp	edx, 10000h
		jz	loc_62B8630C

loc_62B86230:				; CODE XREF: _silc_client_st_connected+15Dj
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B86338

loc_62B8623D:				; CODE XREF: _silc_client_st_connected+17Cj
		cmp	dword ptr [fsm_context_0+40h], 1
		jz	short loc_62B86293
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 0
		mov	edx, [eax+34h]
		mov	[esp+10h], edx
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_rekey_timer
		mov	dword ptr [esp+4], 0
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_add
		cmp	dword ptr [fsm_context_0+40h], 2
		jnz	loc_62B86378
		mov	eax, [fsm_context_0+54h]
		cmp	byte ptr [eax+25h], 0
		jz	loc_62B86354

loc_62B86293:				; CODE XREF: _silc_client_st_connected+8Dj
					; _silc_client_st_connected+1C7j
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_connect_timeout
		mov	dword ptr [esp+4], 0
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_all
		mov	eax, [fsm_context_0+48h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		call	dword ptr [fsm_context_0+44h]
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+100h]
		mov	[esp], eax
		call	_silc_async_free
		mov	eax, [fsm_context_0+54h]
		mov	dword ptr [eax+100h], 0
		mov	eax, 3

loc_62B86301:				; CODE XREF: _silc_client_st_connected+1C0j
					; _silc_client_st_connected+1DEj
		add	esp, 2Ch
		pop	fsm_context_0
		pop	client
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
client = esi				; SilcClient
		align 4

loc_62B8630C:				; CODE XREF: _silc_client_st_connected+76j
		mov	edx, [eax+0Ch]
		test	edx, edx
		jz	loc_62B86230
		mov	[esp], edx
		call	_silc_free
		mov	eax, [fsm_context_0+54h]
		mov	dword ptr [eax+0Ch], 0
		test	byte ptr [eax+12Dh], 2
		jz	loc_62B8623D
		xchg	ax, ax

loc_62B86338:				; CODE XREF: _silc_client_st_connected+83j
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 2Ch
		pop	fsm_context_0
		pop	client
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
client = esi				; SilcClient
		align 4

loc_62B86354:				; CODE XREF: _silc_client_st_connected+D9j
		mov	edx, [eax+28h]
		test	edx, edx
		jz	short loc_62B86362
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	short loc_62B86380

loc_62B86362:				; CODE XREF: _silc_client_st_connected+1A5j
		mov	dword ptr [esp+4], offset _silc_client_st_register
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B86301
; ---------------------------------------------------------------------------
		align 4

loc_62B86378:				; CODE XREF: _silc_client_st_connected+CCj
		mov	eax, [fsm_context_0+54h]
		jmp	loc_62B86293
; ---------------------------------------------------------------------------

loc_62B86380:				; CODE XREF: _silc_client_st_connected+1ACj
		mov	dword ptr [esp+4], offset _silc_client_st_resume
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B86301
_silc_client_st_connected endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 206. silc_client_st_connect_auth_start

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_connect_auth_start(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_st_connect_auth_start
_silc_client_st_connect_auth_start proc	near
					; DATA XREF: _silc_client_st_connect_auth_data+29o
					; _silc_client_st_connect_auth_resolve:loc_62B86868o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [ebp+fsm]
		mov	esi, [ebp+fsm_context]
		mov	eax, [esi+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B86474
fsm_0 =	ebx				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
		cmp	word ptr [eax+0Ah], 2
		jz	loc_62B86490

loc_62B863C2:				; CODE XREF: _silc_client_st_connect_auth_start+FEj
		mov	edx, [eax+34h]
		mov	[esp+8], edx
		mov	edx, [eax+0BCh]
		mov	[esp+4], edx
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_connauth_alloc
		mov	edi, eax
connauth = edi				; SilcConnAuth
		test	eax, eax
		jz	short loc_62B86460
connauth = eax				; SilcConnAuth
		mov	dword ptr [esp+4], offset _silc_client_st_connected
		mov	[esp], fsm_0
		call	_silc_fsm_next
connauth = edi				; SilcConnAuth
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	loc_62B8649C

loc_62B8640A:				; CODE XREF: _silc_client_st_connect_auth_start+130j
		mov	fsm_context_0, [fsm_context_0+54h]
		mov	[esp+18h], fsm_0
		mov	dword ptr [esp+14h], offset _silc_client_connect_auth_completion
		mov	eax, [esi+10h]
		mov	[esp+10h], eax
		mov	eax, [esi+0Ch]
		mov	[esp+0Ch], eax
		movzx	eax, word ptr [esi+0Ah]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 1
		mov	[esp], connauth
		call	_silc_connauth_initiator
		mov	[esi+0FCh], eax
		mov	dl, [fsm_0+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		shl	eax, 1
		and	eax, 2
		add	esp, 2Ch
		pop	fsm_0
		pop	esi
		pop	connauth
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B86460:				; CODE XREF: _silc_client_st_connect_auth_start+4Dj
fsm_0 =	ebx				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
connauth = eax				; SilcConnAuth
		mov	connauth, [fsm_context_0+54h]
connauth = edi				; SilcConnAuth
		mov	dword ptr [eax+128h], 5
		mov	byte ptr [eax+12Ch], 2Dh

loc_62B86474:				; CODE XREF: _silc_client_st_connect_auth_start+19j
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 2Ch
		pop	fsm_0
		pop	fsm_context_0
		pop	connauth
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	ebx				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
		align 10h

loc_62B86490:				; CODE XREF: _silc_client_st_connect_auth_start+24j
		mov	edx, [fsm_context_0+38h]
		mov	[eax+0Ch], edx
		jmp	loc_62B863C2
; ---------------------------------------------------------------------------
connauth = edi				; SilcConnAuth
		align 4

loc_62B8649C:				; CODE XREF: _silc_client_st_connect_auth_start+6Cj
		mov	dword ptr [esp+8], 29Ah
		mov	dword ptr [esp+4], offset aClient_connect ; "client_connect.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_0	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B8640A
_silc_client_st_connect_auth_start endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_connect_auth_completion(SilcConnAuth	connauth, SilcBool success, void *context)
_silc_client_connect_auth_completion proc near
					; DATA XREF: _silc_client_st_connect_auth_start+79o

var_20		= byte ptr -20h
client		= dword	ptr -1Ch
connauth	= dword	ptr  8
success		= byte ptr  0Ch
context		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+connauth]
		mov	ebx, [ebp+context]
		mov	dl, [ebp+success]
		mov	[esp], ebx
		mov	[ebp+var_20], dl
		call	_silc_fsm_get_context
		mov	edi, eax
conn = edi				; SilcClientConnection
		mov	eax, [eax+4Ch]
		mov	[ebp+client], eax
		mov	eax, [conn+54h]
		mov	dword ptr [eax+0FCh], 0
		mov	[esp], esi
		call	_silc_connauth_free
		mov	dl, [ebp+var_20]
		test	dl, dl
		jnz	short loc_62B8653E
connauth_0 = esi			; SilcConnAuth
success_0 = edx				; SilcBool
context_0 = ebx				; void *
		mov	eax, [conn+54h]
		test	byte ptr [eax+12Dh], 10h
		jnz	short loc_62B86568

loc_62B8651D:				; CODE XREF: _silc_client_connect_auth_completion+BDj
		mov	dword ptr [eax+128h], 5
		mov	byte ptr [eax+12Ch], 2Dh
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], context_0
		call	_silc_fsm_next

loc_62B8653E:				; CODE XREF: _silc_client_connect_auth_completion+3Fj
		mov	al, [context_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+28h], dl
		test	al, 4
		jz	short loc_62B86558
		add	esp, 2Ch
		pop	context_0
		pop	connauth_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
connauth_0 = esi			; SilcConnAuth
context_0 = ebx				; void *
conn = edi				; SilcClientConnection
		align 4

loc_62B86558:				; CODE XREF: _silc_client_connect_auth_completion+7Bj
		mov	[ebp+connauth],	context_0
		add	esp, 2Ch
		pop	context_0
		pop	connauth_0
		pop	conn
		leave
		jmp	_silc_fsm_continue_sync
; ---------------------------------------------------------------------------
connauth_0 = esi			; SilcConnAuth
success_0 = edx				; SilcBool
context_0 = ebx				; void *
conn = edi				; SilcClientConnection
		align 4

loc_62B86568:				; CODE XREF: _silc_client_connect_auth_completion+4Bj
		mov	success_0, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aAuthentication ; "Authentication failed"
		mov	dword ptr [esp+8], 2
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [eax]
		mov	eax, [conn+54h]
		jmp	short loc_62B8651D
_silc_client_connect_auth_completion endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  95. silc_client_connect_timeout

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_connect_timeout(SilcSchedule	schedule, void *app_context, SilcTaskEvent type, SilcUInt32 fd,	void *context)
		public _silc_client_connect_timeout
_silc_client_connect_timeout proc near	; DATA XREF: _silc_client_st_connect_error+54o
					; _silc_client_st_connected+E3o ...

schedule	= dword	ptr  8
app_context	= dword	ptr  0Ch
type		= dword	ptr  10h
fd		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		mov	eax, [ebx+54h]
		mov	dword ptr [eax+128h], 7
		mov	byte ptr [eax+12Ch], 36h
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		add	eax, 6Ch
		mov	[esp], eax
		call	_silc_fsm_next
		mov	eax, [ebx+54h]
		add	eax, 6Ch
		mov	[ebp+schedule],	eax
		add	esp, 14h
		pop	ebx
		leave
		jmp	_silc_fsm_continue_sync
_silc_client_connect_timeout endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_connect_auth_method(SilcAuthMethod auth_meth, const void *auth, SilcUInt32 auth_len,	void *context)
_silc_client_connect_auth_method proc near
					; DATA XREF: _silc_client_st_connect_auth_data+52o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1E		= word ptr -1Eh
var_1C		= dword	ptr -1Ch
auth_meth	= dword	ptr  8
auth		= dword	ptr  0Ch
auth_len	= dword	ptr  10h
context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [ebp+auth_meth]
		mov	eax, [ebp+auth]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+auth_len]
		mov	[ebp+var_1C], eax
		mov	ebx, [ebp+context]
		mov	[ebp+var_1E], di
		mov	[esp], ebx
		call	_silc_fsm_get_context
		mov	edx, eax
conn = edx				; SilcClientConnection
		mov	esi, [eax+54h]
		mov	[esi+0Ah], di
		cmp	[ebp+var_1E], 1
		jz	short loc_62B86640
auth_meth_0 = edi			; SilcAuthMethod
context_0 = ebx				; void *
conn = eax				; SilcClientConnection
		mov	conn, [ebp+var_24]
conn = edx				; SilcClientConnection
		mov	[esi+0Ch], eax

loc_62B86611:				; CODE XREF: _silc_client_connect_auth_method+8Aj
		mov	eax, [ebp+var_1C]
		mov	[esi+10h], eax
		mov	al, [context_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+28h], dl
		test	al, 4
		jz	short loc_62B86630
		add	esp, 2Ch
		pop	context_0
		pop	esi
		pop	auth_meth_0
		leave
		retn
; ---------------------------------------------------------------------------
auth_meth_0 = edi			; SilcAuthMethod
context_0 = ebx				; void *
		align 10h

loc_62B86630:				; CODE XREF: _silc_client_connect_auth_method+50j
		mov	[ebp+auth_meth], context_0
		add	esp, 2Ch
		pop	context_0
		pop	esi
		pop	auth_meth_0
		leave
		jmp	_silc_fsm_continue
; ---------------------------------------------------------------------------
auth_meth_0 = edi			; SilcAuthMethod
context_0 = ebx				; void *
conn = eax				; SilcClientConnection
		align 10h

loc_62B86640:				; CODE XREF: _silc_client_connect_auth_method+35j
		mov	conn, [ebp+var_1C]
conn = edx				; SilcClientConnection
		mov	[esp+4], eax
		mov	eax, [ebp+var_24]
		mov	[esp], eax
		mov	[ebp+var_28], conn
		call	_silc_memdup
		mov	[esi+0Ch], eax
		mov	edx, [ebp+var_28]
		mov	esi, [edx+54h]
conn = edx				; SilcClientConnection
		jmp	short loc_62B86611
_silc_client_connect_auth_method endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_connect_callback(SilcNetStatus status, SilcStream stream, void *context)
_silc_client_connect_callback proc near	; CODE XREF: _silc_client_st_connect+A0p
					; DATA XREF: _silc_client_st_connect+DAo

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
status		= dword	ptr  8
stream		= dword	ptr  0Ch
context		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+status]
		mov	eax, [ebp+stream]
		mov	[ebp+var_1C], eax
		mov	ebx, [ebp+context]
fsm = ebx				; SilcFSMThread
		mov	[esp], fsm
		call	_silc_fsm_get_context
		mov	ecx, [eax+4Ch]
conn = eax				; SilcClientConnection
client = ecx				; SilcClient
		mov	edx, [conn+54h]
		mov	dword ptr [edx+0FCh], 0
		mov	edi, edx
		test	byte ptr [edx+12Dh], 10h
		jz	short loc_62B866D0
status_0 = esi				; SilcNetStatus
		cmp	status_0, 5	; switch 6 cases
		jbe	short loc_62B866F4
		mov	edx, [client+18h] ; jumptable 62B866F4 default case
		mov	edx, [edx+48h]
		mov	edi, [conn+8]
		mov	[esp+10h], edi
		mov	dword ptr [esp+0Ch], offset aCouldNotConnec ; "Could not connect to host %s"
		mov	dword ptr [esp+8], 2
		mov	[esp+4], conn
		mov	[esp], client
		mov	[ebp+var_20], conn
		call	dword ptr [edx]
		mov	eax, [ebp+var_20]
		mov	edx, [eax+54h]
conn = eax				; SilcClientConnection
		mov	edi, edx
client = ecx				; SilcClient
		xchg	ax, ax

loc_62B866D0:				; CODE XREF: _silc_client_connect_callback+36j
		test	status_0, status_0
		jnz	short loc_62B8673B

loc_62B866D4:				; CODE XREF: _silc_client_connect_callback:loc_62B866F4j
					; DATA XREF: .rdata:off_62BA8604o
		mov	conn, [ebp+var_1C] ; jumptable 62B866F4	case 0
		mov	[edx+108h], eax

loc_62B866DD:				; CODE XREF: _silc_client_connect_callback+F5j
		mov	al, [fsm+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[fsm+28h], dl
		test	al, 4
		jz	short loc_62B866FC
		add	esp, 3Ch
		pop	fsm
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B866F4:				; CODE XREF: _silc_client_connect_callback+3Bj
status_0 = esi				; SilcNetStatus	; switch jump
fsm = ebx				; SilcFSMThread
conn = eax				; SilcClientConnection
		jmp	ds:off_62BA8604[status_0*4]
; ---------------------------------------------------------------------------
		align 4

loc_62B866FC:				; CODE XREF: _silc_client_connect_callback+8Aj
		mov	[ebp+status], fsm
		add	esp, 3Ch
		pop	fsm
		pop	esi
		pop	edi
		leave
		jmp	_silc_fsm_continue
; ---------------------------------------------------------------------------
status_0 = esi				; SilcNetStatus
fsm = ebx				; SilcFSMThread
conn = eax				; SilcClientConnection
client = ecx				; SilcClient
		align 4

loc_62B8670C:				; CODE XREF: _silc_client_connect_callback:loc_62B866F4j
					; DATA XREF: .rdata:off_62BA8604o
		mov	edx, [client+18h] ; jumptable 62B866F4 case 4
		mov	edx, [edx+48h]
		mov	status_0, [conn+8]
		mov	[esp+10h], esi
		mov	dword ptr [esp+0Ch], offset aCouldNotConn_0 ; "Could not connect to host %s: connectio"...

loc_62B86721:				; CODE XREF: _silc_client_connect_callback+10Dj
					; _silc_client_connect_callback+125j ...
		mov	dword ptr [esp+8], 2
		mov	[esp+4], conn
		mov	[esp], client
		mov	[ebp+var_20], conn
		call	dword ptr [edx]
		mov	eax, [ebp+var_20]
		mov	edi, [eax+54h]

loc_62B8673B:				; CODE XREF: _silc_client_connect_callback+72j
conn = eax				; SilcClientConnection
client = ecx				; SilcClient
		mov	dword ptr [edi+128h], 3
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], fsm
		call	_silc_fsm_next
		jmp	short loc_62B866DD
; ---------------------------------------------------------------------------
status_0 = esi				; SilcNetStatus
conn = eax				; SilcClientConnection
client = ecx				; SilcClient
		align 4

loc_62B86758:				; CODE XREF: _silc_client_connect_callback:loc_62B866F4j
					; DATA XREF: .rdata:off_62BA8604o
		mov	edx, [client+18h] ; jumptable 62B866F4 case 3
		mov	edx, [edx+48h]
		mov	status_0, [conn+8]
		mov	[esp+10h], esi
		mov	dword ptr [esp+0Ch], offset aCouldNotConn_1 ; "Could not connect to host %s: network u"...
		jmp	short loc_62B86721
; ---------------------------------------------------------------------------
status_0 = esi				; SilcNetStatus
		align 10h

loc_62B86770:				; CODE XREF: _silc_client_connect_callback:loc_62B866F4j
					; DATA XREF: .rdata:off_62BA8604o
		mov	edx, [client+18h] ; jumptable 62B866F4 case 2
		mov	edx, [edx+48h]
		mov	status_0, [conn+8]
		mov	[esp+10h], esi
		mov	dword ptr [esp+0Ch], offset aCouldNotConn_2 ; "Could not connect to host %s: unknown h"...
		jmp	short loc_62B86721
; ---------------------------------------------------------------------------
status_0 = esi				; SilcNetStatus
		align 4

loc_62B86788:				; CODE XREF: _silc_client_connect_callback:loc_62B866F4j
					; DATA XREF: .rdata:off_62BA8604o
		mov	edx, [client+18h] ; jumptable 62B866F4 case 1
		mov	edx, [edx+48h]
		mov	status_0, [conn+8]
		mov	[esp+10h], esi
		mov	dword ptr [esp+0Ch], offset aCouldNotConn_3 ; "Could not connect to host %s: unknown I"...
		jmp	short loc_62B86721
; ---------------------------------------------------------------------------
status_0 = esi				; SilcNetStatus
		align 10h

loc_62B867A0:				; CODE XREF: _silc_client_connect_callback:loc_62B866F4j
					; DATA XREF: .rdata:off_62BA8604o
		mov	edx, [client+18h] ; jumptable 62B866F4 case 5
		mov	edx, [edx+48h]
		mov	status_0, [conn+8]
		mov	[esp+10h], esi
		mov	dword ptr [esp+0Ch], offset aCouldNotConn_4 ; "Could not connect to host %s: connectio"...
		jmp	loc_62B86721
_silc_client_connect_callback endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 205. silc_client_st_connect_auth_resolve

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_connect_auth_resolve(SilcFSMObject	*fsm, void *fsm_context, void *state_context)
		public _silc_client_st_connect_auth_resolve
_silc_client_st_connect_auth_resolve proc near
					; DATA XREF: _silc_client_st_connect_setup_udp+A9o
					; _silc_client_st_connect_key_exchange+C6o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B86884
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		cmp	byte ptr [eax+9], 0
		jnz	loc_62B86868
		mov	dword ptr [esp+1Ch], 1Dh
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 3
		mov	dword ptr [esp+10h], 1
		mov	dword ptr [esp+0Ch], 3
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 10h
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_send_va
		mov	eax, [fsm_context_0+54h]
		or	byte ptr [eax+12Dh], 80h
		mov	eax, [fsm_context_0+54h]
		mov	word ptr [eax+0Ah], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 2
		mov	dword ptr [esp+4], offset _silc_client_st_connect_auth_data
		mov	[esp], fsm_0
		call	_silc_fsm_next_later
		mov	eax, 2
		add	esp, 20h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B86868:				; CODE XREF: _silc_client_st_connect_auth_resolve+22j
		mov	dword ptr [esp+4], offset _silc_client_st_connect_auth_start
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 20h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B86884:				; CODE XREF: _silc_client_st_connect_auth_resolve+18j
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 20h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
_silc_client_st_connect_auth_resolve endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 210. silc_client_st_connect_setup_udp

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_connect_setup_udp(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_st_connect_setup_udp
_silc_client_st_connect_setup_udp proc near
					; DATA XREF: _silc_client_st_connect_key_exchange:loc_62B86B28o

var_1C		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

prop = eax				; SilcSKESecurityProperties
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	prop, [ebx+54h]
		test	byte ptr [prop+12Dh], 2
		jnz	loc_62B86974
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	prop, [prop+0BCh]
		mov	[esp], prop
		call	_silc_ske_get_security_properties
		mov	edx, [fsm_context_0+54h]
		mov	ecx, [edx+0B4h]
		mov	[esp+10h], ecx
		movzx	prop, word ptr [prop+18h]
		mov	[esp+0Ch], prop
		mov	prop, [fsm_context_0+8]
		mov	[esp+8], prop
		mov	prop, [edx+20h]
		mov	[esp+4], prop
		mov	prop, [edx+18h]
		mov	[esp], prop
		call	_silc_net_udp_connect
		mov	edi, prop
stream = edi				; SilcStream
		test	prop, prop
		jz	short loc_62B86964
		mov	prop, [fsm_context_0+3Ch]
stream = edi				; SilcStream
		mov	[esp], prop
		call	_silc_packet_stream_get_stream
		mov	edx, prop
old = edx				; SilcStream
		mov	[esp+4], stream
		mov	prop, [fsm_context_0+3Ch]
		mov	[esp], prop
		mov	[ebp+var_1C], old
		call	_silc_packet_stream_set_stream
		mov	prop, [fsm_context_0+3Ch]
		mov	[esp], prop
		call	_silc_packet_stream_set_iv_included
		mov	dword ptr [esp+4], 0
		mov	prop, [fsm_context_0+3Ch]
		mov	[esp], prop
		call	_silc_packet_set_sid
		mov	edx, [ebp+var_1C]
		mov	[esp], edx
old = edx				; SilcStream
		call	_silc_stream_destroy
		mov	dword ptr [esp+4], offset _silc_client_st_connect_auth_resolve
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	prop, prop
		add	esp, 3Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	stream
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B86964:				; CODE XREF: _silc_client_st_connect_setup_udp+5Fj
		mov	prop, [fsm_context_0+54h]
stream = edi				; SilcStream
		mov	dword ptr [prop+128h], 3
		lea	fsm_0, [fsm_0+0]

loc_62B86974:				; CODE XREF: _silc_client_st_connect_setup_udp+19j
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	prop, prop
		add	esp, 3Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	stream
		leave
		retn
_silc_client_st_connect_setup_udp endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 208. silc_client_st_connect_key_exchange

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_connect_key_exchange(SilcFSMObject	*fsm, void *fsm_context, void *state_context)
		public _silc_client_st_connect_key_exchange
_silc_client_st_connect_key_exchange proc near
					; DATA XREF: _silc_client_st_connect_set_stream+52o

var_4C		= dword	ptr -4Ch
cid		= SilcClientID ptr -41h
params		= SilcSKEParamsStruct ptr -24h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	edx, [ebx+4Ch]
client = edx				; SilcClient
		mov	edi, [ebx+54h]
		mov	[esp+14h], esi
		mov	eax, [ebx+38h]
		mov	[esp+10h], eax
		mov	eax, [ebx+34h]
		mov	[esp+0Ch], eax
		mov	eax, [edi+4]
		mov	[esp+8], eax
		mov	eax, [edi+0B4h]
		mov	[esp+4], eax
		mov	eax, [client+10h]
		mov	[esp], eax
		mov	[ebp+var_4C], client
		call	_silc_ske_alloc
		mov	[edi+0BCh], eax
		mov	ecx, [ebx+54h]
		mov	eax, [ecx+0BCh]
		test	eax, eax
		mov	edx, [ebp+var_4C]
		jz	loc_62B86B74
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	[esp+0Ch], fsm_0
		mov	dword ptr [esp+8], offset _silc_client_ke_completion
		mov	dword ptr [esp+4], offset _silc_client_ke_verify_key
		mov	[esp], eax
		mov	[ebp+var_4C], edx
		call	_silc_ske_set_callbacks
		mov	edx, [ebp+var_4C]
		mov	eax, [edx+18h]
client = edx				; SilcClient
		mov	eax, [eax+70h]
		mov	[ebp+params.version], eax
		mov	eax, [fsm_context_0+54h]
		mov	client,	[eax+30h]
		mov	[ebp+params.timeout_secs], dx
		mov	[ebp+params.flags], 4
		cmp	byte ptr [eax+24h], 0
		jz	short loc_62B86A39
		mov	[ebp+params.flags], 6

loc_62B86A39:				; CODE XREF: _silc_client_st_connect_key_exchange+A0j
		mov	dl, [eax+14h]
		test	dl, dl
		jnz	loc_62B86AFC
		cmp	byte ptr [eax+25h], 0
		jnz	loc_62B86B11

loc_62B86A4E:				; CODE XREF: _silc_client_st_connect_key_exchange+17Bj
		test	dl, dl
		jnz	loc_62B86B28
		mov	dword ptr [esp+4], offset _silc_client_st_connect_auth_resolve
		mov	[esp], fsm_0
		call	_silc_fsm_next

loc_62B86A66:				; CODE XREF: _silc_client_st_connect_key_exchange+191j
					; _silc_client_st_connect_key_exchange+1A8j
		lea	edx, [ebp+cid]
		mov	ecx, 1Dh
		xor	eax, eax
		mov	edi, edx
		rep stosb
		mov	[ebp+cid._ip.data_len],	4
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 2
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_set_ids
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	loc_62B86B40

loc_62B86AB2:				; CODE XREF: _silc_client_st_connect_key_exchange+1DCj
		mov	edi, [fsm_context_0+54h]
		mov	dword ptr [esp+0Ch], 0
		lea	eax, [ebp+params]
		mov	[esp+8], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp+4], eax
		mov	eax, [edi+0BCh]
		mov	[esp], eax
		call	_silc_ske_initiator
		mov	[edi+0FCh], eax
		mov	dl, [fsm_0+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		shl	eax, 1
		and	eax, 2
		add	esp, 6Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B86AFC:				; CODE XREF: _silc_client_st_connect_key_exchange+AEj
		or	[ebp+params.flags], 1
		mov	ecx, [eax+20h]
		mov	[ebp+params.session_port], cx
		cmp	byte ptr [eax+25h], 0
		jz	loc_62B86A4E

loc_62B86B11:				; CODE XREF: _silc_client_st_connect_key_exchange+B8j
		mov	dword ptr [esp+4], offset _silc_client_st_connected
		mov	[esp], fsm_0
		call	_silc_fsm_next
		jmp	loc_62B86A66
; ---------------------------------------------------------------------------
		align 4

loc_62B86B28:				; CODE XREF: _silc_client_st_connect_key_exchange+C0j
		mov	dword ptr [esp+4], offset _silc_client_st_connect_setup_udp
		mov	[esp], fsm_0
		call	_silc_fsm_next
		jmp	loc_62B86A66
; ---------------------------------------------------------------------------
		align 10h

loc_62B86B40:				; CODE XREF: _silc_client_st_connect_key_exchange+11Cj
		mov	dword ptr [esp+8], 206h
		mov	dword ptr [esp+4], offset aClient_connect ; "client_connect.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_0	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B86AB2
; ---------------------------------------------------------------------------
		align 4

loc_62B86B74:				; CODE XREF: _silc_client_st_connect_key_exchange+5Aj
		mov	dword ptr [ecx+128h], 4
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	edi
		leave
		retn
_silc_client_st_connect_key_exchange endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ke_verify_key(SilcSKE ske, SilcPublicKey public_key,	void *context, SilcSKEVerifyCbCompletion completion, void *completion_context)
_silc_client_ke_verify_key proc	near	; DATA XREF: _silc_client_st_connect_key_exchange+6Co

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ske		= dword	ptr  8
public_key	= dword	ptr  0Ch
context		= dword	ptr  10h
completion	= dword	ptr  14h
completion_context= dword ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, [ebp+ske]
		mov	[ebp+var_1C], eax
		mov	edx, [ebp+public_key]
		mov	[ebp+var_24], edx
		mov	ecx, [ebp+completion]
		mov	[ebp+var_20], ecx
		mov	edi, [ebp+completion_context]
		mov	eax, [ebp+context]
		mov	[esp], eax
		call	_silc_fsm_get_context
		mov	ebx, eax
		mov	esi, [eax+4Ch]
client = esi				; SilcClient
		mov	eax, [eax+54h]
		mov	ecx, [eax+4]
		test	ecx, ecx
		jz	short loc_62B86BD6
completion_context_0 = edi		; void *
		cmp	byte ptr [eax+8], 0
		jz	short loc_62B86C30

loc_62B86BD6:				; CODE XREF: _silc_client_ke_verify_key+36j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	_silc_calloc
		test	eax, eax
		jz	short loc_62B86C30
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	ecx, [ebp+var_20]
		mov	[eax+4], ecx
		mov	[eax+8], completion_context_0
		mov	edx, [client+18h]
		mov	edx, [edx+48h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], offset _silc_client_ke_verify_key_cb
		mov	eax, [ebp+var_24]
		mov	[esp+0Ch], eax
		mov	eax, [ebx+40h]
		mov	[esp+8], eax
		mov	[esp+4], ebx
		mov	[esp], client
		call	dword ptr [edx+1Ch]
		add	esp, 3Ch
		pop	ebx
		pop	client
		pop	completion_context_0
		leave
		retn
; ---------------------------------------------------------------------------
completion_context_0 = edi		; void *
client = esi				; SilcClient
		align 10h

loc_62B86C30:				; CODE XREF: _silc_client_ke_verify_key+3Cj
					; _silc_client_ke_verify_key+54j
		mov	[ebp+context], completion_context_0
		mov	[ebp+public_key], 8
		mov	eax, [ebp+var_1C]
		mov	[ebp+ske], eax
		mov	ecx, [ebp+var_20]
		add	esp, 3Ch
		pop	ebx
		pop	client
		pop	completion_context_0
		leave
		jmp	ecx
_silc_client_ke_verify_key endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ke_completion(SilcSKE ske, SilcSKEStatus status, SilcSKESecurityProperties prop, SilcSKEKeyMaterial keymat, SilcSKERekeyMaterial rekey, void	*context)
_silc_client_ke_completion proc	near	; DATA XREF: _silc_client_st_connect_key_exchange+64o

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
hmac_receive	= dword	ptr -28h
hmac_send	= dword	ptr -24h
receive_key	= dword	ptr -20h
send_key	= dword	ptr -1Ch
ske		= dword	ptr  8
status		= dword	ptr  0Ch
prop		= dword	ptr  10h
keymat		= dword	ptr  14h
rekey		= dword	ptr  18h
context		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	edi, [ebp+status]
		mov	ebx, [ebp+context]
		mov	[esp], ebx
		call	_silc_fsm_get_context
		mov	esi, eax
		mov	edx, [eax+4Ch]
client = edx				; SilcClient
		mov	eax, [eax+54h]
		mov	dword ptr [eax+0FCh], 0
		test	edi, edi
		jz	short loc_62B86CD4
status_0 = edi				; SilcSKEStatus
context_0 = ebx				; void *
		test	byte ptr [eax+12Dh], 10h
		jnz	loc_62B86D58

loc_62B86C86:				; CODE XREF: _silc_client_ke_completion+14Dj
					; _silc_client_ke_completion+1C7j ...
		mov	dword ptr [eax+128h], 4
		mov	eax, [ebp+rekey]
		mov	[esp], eax
		call	_silc_ske_free_rekey_material
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], context_0
		call	_silc_fsm_next

loc_62B86CAB:				; CODE XREF: _silc_client_ke_completion+105j
					; _silc_client_ke_completion+208j
		mov	al, [context_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+28h], dl
		test	al, 4
		jz	short loc_62B86CC4
		add	esp, 4Ch
		pop	context_0
		pop	esi
		pop	status_0
		leave
		retn
; ---------------------------------------------------------------------------
status_0 = edi				; SilcSKEStatus
context_0 = ebx				; void *
		align 4

loc_62B86CC4:				; CODE XREF: _silc_client_ke_completion+6Cj
		mov	[esp], context_0
		call	_silc_fsm_continue_sync
		add	esp, 4Ch
		pop	context_0
		pop	esi
		pop	status_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B86CD4:				; CODE XREF: _silc_client_ke_completion+2Bj
status_0 = edi				; SilcSKEStatus
context_0 = ebx				; void *
client = edx				; SilcClient
		add	eax, 0ECh
		mov	[esp+1Ch], eax
		lea	eax, [ebp+hmac_receive]
		mov	[esp+18h], eax
		lea	eax, [ebp+hmac_send]
		mov	[esp+14h], eax
		lea	eax, [ebp+receive_key]
		mov	[esp+10h], eax
		lea	eax, [ebp+send_key]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+prop]
		mov	[esp+8], eax
		mov	eax, [ebp+keymat]
		mov	[esp+4], eax
		mov	eax, [ebp+ske]
		mov	[esp], eax
		mov	[ebp+var_30], client
		call	_silc_ske_set_keys
		test	al, al
		mov	edx, [ebp+var_30]
		jnz	loc_62B86DD0
		mov	eax, [esi+54h]
		test	byte ptr [eax+12Dh], 10h
		jnz	short loc_62B86DA0

loc_62B86D2C:				; CODE XREF: _silc_client_ke_completion+17Dj
		mov	dword ptr [eax+128h], 4
		mov	edx, [ebp+rekey]
		mov	[esp], edx
		call	_silc_ske_free_rekey_material
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], context_0
		call	_silc_fsm_next
		jmp	loc_62B86CAB
; ---------------------------------------------------------------------------
client = edx				; SilcClient
		align 4

loc_62B86D58:				; CODE XREF: _silc_client_ke_completion+34j
		mov	eax, [client+18h]
		mov	eax, [eax+48h]
		mov	eax, [eax]
		mov	[ebp+var_2C], eax
		mov	[esp], status_0
		mov	[ebp+var_30], client
		call	_silc_ske_map_status
		mov	[esp+14h], eax
		mov	eax, [esi+8]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aErrorDuringKey ; "Error during key	exchange with %s: %s"
		mov	dword ptr [esp+8], 2
		mov	[esp+4], esi
		mov	edx, [ebp+var_30]
		mov	[esp], edx
client = edx				; SilcClient
		call	[ebp+var_2C]
		mov	eax, [esi+54h]
		jmp	loc_62B86C86
; ---------------------------------------------------------------------------
		align 10h

loc_62B86DA0:				; CODE XREF: _silc_client_ke_completion+DEj
		mov	eax, [edx+18h]
client = edx				; SilcClient
		mov	eax, [eax+48h]
		mov	ecx, [esi+8]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], offset aErrorDuringK_0 ; "Error during key	exchange with %s: cann"...
		mov	dword ptr [esp+8], 2
		mov	[esp+4], esi
		mov	[esp], client
		call	dword ptr [eax]
		mov	eax, [esi+54h]
		jmp	loc_62B86D2C
; ---------------------------------------------------------------------------
		align 10h

loc_62B86DD0:				; CODE XREF: _silc_client_ke_completion+CEj
		mov	dword ptr [esp+14h], 0
		mov	eax, [ebp+hmac_receive]
		mov	[esp+10h], eax
		mov	eax, [ebp+hmac_send]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+receive_key]
		mov	[esp+8], eax
		mov	eax, [ebp+send_key]
		mov	[esp+4], eax
		mov	eax, [esi+3Ch]
		mov	[esp], eax
		mov	[ebp+var_30], edx
		call	_silc_packet_set_keys
		test	al, al
		mov	edx, [ebp+var_30]
		jnz	short loc_62B86E48
		mov	eax, [esi+54h]
		test	byte ptr [eax+12Dh], 10h
		jz	loc_62B86C86
		mov	eax, [edx+18h]
client = edx				; SilcClient
		mov	eax, [eax+48h]
		mov	ecx, [esi+8]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], offset aErrorDuringK_0 ; "Error during key	exchange with %s: cann"...
		mov	dword ptr [esp+8], 2
		mov	[esp+4], esi
		mov	[esp], client
		call	dword ptr [eax]
		mov	eax, [esi+54h]
		jmp	loc_62B86C86
; ---------------------------------------------------------------------------
		align 4

loc_62B86E48:				; CODE XREF: _silc_client_ke_completion+1BBj
		mov	eax, [esi+54h]
		mov	edx, [ebp+rekey]
		mov	[eax+0C0h], edx
		jmp	loc_62B86CAB
_silc_client_ke_completion endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 209. silc_client_st_connect_set_stream

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_connect_set_stream(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_st_connect_set_stream
_silc_client_st_connect_set_stream proc	near
					; DATA XREF: _silc_client_connection_st_run+148o
					; _silc_client_st_connect+Fo

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	edx, [ebx+4Ch]
client = edx				; SilcClient
		mov	eax, [ebx+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	short loc_62B86ED8
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	ecx, [eax+108h]
		mov	[esp+8], ecx
		mov	eax, [eax+0B4h]
		mov	[esp+4], eax
		mov	eax, [client+18h]
		mov	eax, [eax+50h]
		mov	[esp], eax
		call	_silc_packet_stream_create
		mov	[fsm_context_0+3Ch], eax
		test	eax, eax
		jz	short loc_62B86EC8
		mov	[esp+4], fsm_context_0
		mov	[esp], eax
		call	_silc_packet_set_context
		mov	dword ptr [esp+4], offset _silc_client_st_connect_key_exchange
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 10h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62B86EC8:				; CODE XREF: _silc_client_st_connect_set_stream+44j
		mov	eax, [fsm_context_0+54h]
		mov	dword ptr [eax+128h], 3
client = edx				; SilcClient
		lea	fsm_0, [fsm_0+0]

loc_62B86ED8:				; CODE XREF: _silc_client_st_connect_set_stream+1Bj
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 10h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
_silc_client_st_connect_set_stream endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 203. silc_client_st_connect

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_connect(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_st_connect
_silc_client_st_connect	proc near	; DATA XREF: _silc_client_connection_st_run+F8o

var_1C		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+fsm]
		mov	esi, [ebp+fsm_context]
		mov	dword ptr [esp+4], offset _silc_client_st_connect_set_stream
		mov	[esp], ebx
		call	_silc_fsm_next
		mov	eax, [esi+54h]
		mov	edx, [eax+30h]
		test	edx, edx
		jnz	loc_62B8701C

loc_62B86F21:				; CODE XREF: _silc_client_st_connect+161j
fsm_0 =	ebx				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
		cmp	byte ptr [eax+14h], 0
		jz	loc_62B86FB4
		mov	edx, [eax+18h]
		test	edx, edx
		jz	loc_62B870C4
		mov	edi, [eax+0B4h]
		mov	ecx, [fsm_context_0+0Ch]
		mov	[ebp+var_1C], ecx
		mov	fsm_context_0, [fsm_context_0+8]
		mov	ecx, [eax+20h]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_62B86F51
		mov	edx, eax

loc_62B86F51:				; CODE XREF: _silc_client_st_connect+59j
		mov	[esp+10h], edi
		mov	eax, [ebp+var_1C]
		mov	[esp+0Ch], eax
		mov	[esp+8], esi
		mov	[esp+4], ecx
		mov	[esp], edx
		call	_silc_net_udp_connect
		mov	esi, eax
stream = esi				; SilcStream
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	loc_62B87090

loc_62B86F81:				; CODE XREF: _silc_client_st_connect+1C8j
		cmp	stream,	1
		sbb	eax, eax
		and	eax, 3
		mov	[esp+8], fsm_0	; context
		mov	[esp+4], stream	; stream
		mov	[esp], eax	; status
		call	_silc_client_connect_callback
		mov	al, [fsm_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	short loc_62B8700F

loc_62B86FA8:				; CODE XREF: _silc_client_st_connect+119j
		xor	eax, eax
		add	esp, 3Ch
		pop	fsm_0
		pop	stream
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	ebx				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
		align 4

loc_62B86FB4:				; CODE XREF: _silc_client_st_connect+31j
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	loc_62B8705C

loc_62B86FC7:				; CODE XREF: _silc_client_st_connect+194j
		mov	edi, [fsm_context_0+54h]
		mov	[esp+14h], fsm_0
		mov	dword ptr [esp+10h], offset _silc_client_connect_callback
		mov	eax, [edi+0B4h]
		mov	[esp+0Ch], eax
		mov	eax, [fsm_context_0+0Ch]
		mov	[esp+8], eax
		mov	eax, [fsm_context_0+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	_silc_net_tcp_connect
		mov	[edi+0FCh], eax
		mov	al, [fsm_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		test	al, 4
		jz	short loc_62B86FA8

loc_62B8700F:				; CODE XREF: _silc_client_st_connect+B2j
stream = esi				; SilcStream
		mov	eax, 2

loc_62B87014:				; CODE XREF: _silc_client_st_connect+20Bj
		add	esp, 3Ch
		pop	fsm_0
		pop	stream
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8701C:				; CODE XREF: _silc_client_st_connect+27j
fsm_0 =	ebx				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 0
		mov	[esp+10h], edx
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_connect_timeout
		mov	dword ptr [esp+4], 0
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_add
		mov	eax, [fsm_context_0+54h]
		jmp	loc_62B86F21
; ---------------------------------------------------------------------------
		align 4

loc_62B8705C:				; CODE XREF: _silc_client_st_connect+CDj
		mov	dword ptr [esp+8], 1AAh
		mov	dword ptr [esp+4], offset aClient_connect ; "client_connect.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_0	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B86FC7
; ---------------------------------------------------------------------------
stream = esi				; SilcStream
		align 10h

loc_62B87090:				; CODE XREF: _silc_client_st_connect+87j
		mov	dword ptr [esp+8], 1A3h
		mov	dword ptr [esp+4], offset aClient_connect ; "client_connect.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_0	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B86F81
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
		align 4

loc_62B870C4:				; CODE XREF: _silc_client_st_connect+3Cj
		mov	dword ptr [esp], offset	aLocalUdpIpAddr	; "Local UDP IP	address	not specified"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		mov	eax, [fsm_context_0+54h]
		mov	dword ptr [eax+128h], 3
		mov	dword ptr [esp+4], offset _silc_client_st_connect_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B87014
_silc_client_st_connect	endp

; Exported entry  94. silc_client_connect_auth_request

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_connect_auth_request(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_connect_auth_request
_silc_client_connect_auth_request proc near
					; DATA XREF: _silc_client_connection_st_packet:loc_62B81F58o

auth_meth	= dword	ptr -0Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	eax, [ebx+54h]
		cmp	byte ptr [eax+12Dh], 0
		jns	short loc_62B8717C
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		mov	dword ptr [esp+14h], 1Dh
		lea	eax, [ebp+auth_meth]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 3
		lea	eax, [ebp+auth_meth+2]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		lea	eax, [state_context_0+8]
		mov	[esp], eax
		call	_silc_buffer_unformat
		test	eax, eax
		js	short loc_62B87190

loc_62B87153:				; CODE XREF: _silc_client_connect_auth_request+92j
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, [fsm_context_0+54h]
		mov	edx, [ebp+auth_meth]
		mov	[eax+0Ah], dx
		add	eax, 6Ch
		mov	[esp], eax
		call	_silc_fsm_continue_sync
		mov	eax, 3
		add	esp, 30h
		pop	fsm_context_0
		pop	state_context_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8717C:				; CODE XREF: _silc_client_connect_auth_request+18j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3
		add	esp, 30h
		pop	fsm_context_0
		pop	state_context_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B87190:				; CODE XREF: _silc_client_connect_auth_request+4Dj
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		mov	word ptr [ebp+auth_meth], 0
		jmp	short loc_62B87153
_silc_client_connect_auth_request endp

; Exported entry 189. silc_client_ref_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientEntry __cdecl silc_client_ref_client(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry)
		public _silc_client_ref_client
_silc_client_ref_client	proc near	; CODE XREF: _silc_client_add_to_channel+7Ep
					; _silc_client_ftp+1B7p ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+client_entry]
		mov	edx, [eax+3F8h]
		mov	edx, [eax+3F8h]
		inc	edx
		mov	[eax+3F8h], edx
		leave
		retn
_silc_client_ref_client	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 188. silc_client_ref_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcChannelEntry __cdecl silc_client_ref_channel(SilcClient client, SilcClientConnection conn, SilcChannelEntry channel_entry)
		public _silc_client_ref_channel
_silc_client_ref_channel proc near	; CODE XREF: _silc_client_add_to_channel+91p
					; _silc_client_save_channel_key+8Ep ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+channel_entry]
		mov	edx, [eax+174h]
		mov	edx, [eax+174h]
		inc	edx
		mov	[eax+174h], edx
		leave
		retn
_silc_client_ref_channel endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 190. silc_client_ref_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcServerEntry __cdecl silc_client_ref_server(SilcClient client, SilcClientConnection conn, SilcServerEntry server_entry)
		public _silc_client_ref_server
_silc_client_ref_server	proc near	; CODE XREF: _silc_client_command_reply_info+377p
					; _silc_client_command_reply_identify+48Ep

client		= dword	ptr  8
conn		= dword	ptr  0Ch
server_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+server_entry]
		mov	edx, [eax+30h]
		mov	edx, [eax+30h]
		inc	edx
		mov	[eax+30h], edx
		leave
		retn
_silc_client_ref_server	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __usercall silc_dlist_uninit(SilcDList list@<eax>)
_silc_dlist_uninit proc	near		; CODE XREF: _silc_client_unref_channel:loc_62B87AE7p
					; _silc_client_unref_channel:loc_62B87B57p ...

var_2C		= dword	ptr -2Ch

list = eax				; SilcDList
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, list
		test	list, list
		jz	short loc_62B8724F
		mov	ebx, [list]
		mov	[list+8], ebx
		and	byte ptr [list+10h], 0FDh
		test	ebx, ebx
		jz	short loc_62B87247

loc_62B87200:				; CODE XREF: _silc_dlist_uninit+61j
list = esi				; SilcDList
		test	byte ptr [list+10h], 2
		jz	short loc_62B87258
		movzx	eax, word ptr [list+0Eh]
		mov	eax, [ebx+eax]

loc_62B8720D:				; CODE XREF: _silc_dlist_uninit+7Bj
		mov	[list+8], eax
		mov	eax, [list]
prev = eax				; void *
		test	prev, prev
		jz	short loc_62B87233
		cmp	ebx, prev
		jz	loc_62B872A0
		movzx	edi, word ptr [list+0Ch]
		jmp	short loc_62B8722A
; ---------------------------------------------------------------------------

loc_62B87224:				; CODE XREF: _silc_dlist_uninit+4Dj
p = edx					; void **
prev = ecx				; void *
		cmp	ebx, prev
		jz	short loc_62B87264
		mov	eax, prev

loc_62B8722A:				; CODE XREF: _silc_dlist_uninit+3Ej
prev = eax				; void *
		lea	p, [prev+edi]
		mov	ecx, [p]
prev = ecx				; void *
		test	prev, prev
		jnz	short loc_62B87224

loc_62B87233:				; CODE XREF: _silc_dlist_uninit+30j
prev = eax				; void *
		cmp	[list+4], ebx
		jz	short loc_62B87291

loc_62B87238:				; CODE XREF: _silc_dlist_uninit+ABj
					; _silc_dlist_uninit+B0j
		mov	[esp], ebx
		call	_silc_free
		mov	ebx, [list+8]
		test	ebx, ebx
		jnz	short loc_62B87200

loc_62B87247:				; CODE XREF: _silc_dlist_uninit+1Aj
		mov	[esp], list
		call	_silc_free

loc_62B8724F:				; CODE XREF: _silc_dlist_uninit+Dj
		add	esp, 3Ch
		pop	ebx
		pop	list
list = eax				; SilcDList
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
list = esi				; SilcDList
		align 4

loc_62B87258:				; CODE XREF: _silc_dlist_uninit+20j
		movzx	eax, word ptr [list+0Ch]
		mov	eax, [ebx+eax]
		jmp	short loc_62B8720D
; ---------------------------------------------------------------------------
p = edx					; void **
prev = ecx				; void *
		align 4

loc_62B87264:				; CODE XREF: _silc_dlist_uninit+42j
		mov	[ebp+var_2C], p

loc_62B87267:				; CODE XREF: _silc_dlist_uninit+C5j
		mov	prev, [ebx+edi]
prev = eax				; void *
		mov	p, [ebp+var_2C]
		mov	[edx], ecx
		test	ecx, ecx
		jz	short loc_62B87283
		test	byte ptr [list+10h], 1
		jz	short loc_62B87283
		movzx	edi, word ptr [list+0Eh]
		mov	edx, [ebx+edi]
		mov	[ecx+edi], edx

loc_62B87283:				; CODE XREF: _silc_dlist_uninit+8Dj
					; _silc_dlist_uninit+93j
		cmp	[list+8], ebx
		jz	short loc_62B87296

loc_62B87288:				; CODE XREF: _silc_dlist_uninit+BAj
		sub	dword ptr [list+10h], 4
		cmp	[list+4], ebx
		jnz	short loc_62B87238

loc_62B87291:				; CODE XREF: _silc_dlist_uninit+52j
p = edx					; void **
		mov	[list+4], prev
		jmp	short loc_62B87238
; ---------------------------------------------------------------------------

loc_62B87296:				; CODE XREF: _silc_dlist_uninit+A2j
		mov	ecx, [ebp+var_2C]
		mov	edx, [ecx]
		mov	[list+8], edx
		jmp	short loc_62B87288
; ---------------------------------------------------------------------------

loc_62B872A0:				; CODE XREF: _silc_dlist_uninit+34j
		movzx	edi, word ptr [list+0Ch]
		mov	[ebp+var_2C], list
		xor	prev, prev
		jmp	short loc_62B87267
_silc_dlist_uninit endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __usercall silc_atomic_uninit32(SilcAtomic32 *atomic@<eax>)
_silc_atomic_uninit32 proc near		; CODE XREF: _silc_client_add_server+15Cp
					; _silc_client_add_server+164p	...
atomic = eax				; SilcAtomic32 *
		push	ebp
		mov	ebp, esp
		mov	dword ptr [atomic], 0
		leave
		retn
_silc_atomic_uninit32 endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 226. silc_client_unlock_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_unlock_server(SilcServerEntry server_entry)
		public _silc_client_unlock_server
_silc_client_unlock_server proc	near

server_entry	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+server_entry]
		mov	eax, [eax+28h]
		mov	[ebp+server_entry], eax
		leave
		jmp	_silc_rwlock_unlock
_silc_client_unlock_server endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 224. silc_client_unlock_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_unlock_channel(SilcChannelEntry channel_entry)
		public _silc_client_unlock_channel
_silc_client_unlock_channel proc near

channel_entry	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+channel_entry]
		mov	eax, [eax+144h]
		mov	[ebp+channel_entry], eax
		leave
		jmp	_silc_rwlock_unlock
_silc_client_unlock_channel endp

; Exported entry 225. silc_client_unlock_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_unlock_client(SilcClientEntry client_entry)
		public _silc_client_unlock_client
_silc_client_unlock_client proc	near

client_entry	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+client_entry]
		mov	eax, [eax+3D8h]
		mov	[ebp+client_entry], eax
		leave
		jmp	_silc_rwlock_unlock
_silc_client_unlock_client endp

; Exported entry 156. silc_client_lock_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_lock_server(SilcServerEntry server_entry)
		public _silc_client_lock_server
_silc_client_lock_server proc near

server_entry	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+server_entry]
		mov	eax, [eax+28h]
		mov	[ebp+server_entry], eax
		leave
		jmp	_silc_rwlock_rdlock
_silc_client_lock_server endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 154. silc_client_lock_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_lock_channel(SilcChannelEntry channel_entry)
		public _silc_client_lock_channel
_silc_client_lock_channel proc near

channel_entry	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+channel_entry]
		mov	eax, [eax+144h]
		mov	[ebp+channel_entry], eax
		leave
		jmp	_silc_rwlock_rdlock
_silc_client_lock_channel endp

; Exported entry 155. silc_client_lock_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_lock_client(SilcClientEntry client_entry)
		public _silc_client_lock_client
_silc_client_lock_client proc near

client_entry	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+client_entry]
		mov	eax, [eax+3D8h]
		mov	[ebp+client_entry], eax
		leave
		jmp	_silc_rwlock_rdlock
_silc_client_lock_client endp

; Exported entry 231. silc_client_update_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_update_server(SilcClient client, SilcClientConnection conn, SilcServerEntry server_entry, const char	*server_name, const char *server_info)
		public _silc_client_update_server
_silc_client_update_server proc	near	; CODE XREF: _silc_client_command_reply_identify+2B9p

client		= dword	ptr  8
conn		= dword	ptr  0Ch
server_entry	= dword	ptr  10h
server_name	= dword	ptr  14h
server_info	= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [ebp+server_entry]
		mov	esi, [ebp+server_name]
		test	esi, esi
		jz	loc_62B87425
server_entry_0 = ebx			; SilcServerEntry
server_name_0 =	esi			; const	char *
		mov	eax, [server_entry_0]
		test	eax, eax
		jz	short loc_62B87379
		mov	[esp+4], server_name_0
		mov	[esp], eax
		call	_silc_utf8_strcasecmp
		test	al, al
		jnz	loc_62B87425

loc_62B87379:				; CODE XREF: _silc_client_update_server+1Bj
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, server_name_0
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 100h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	[esp], esi
server_name_0 =	esi			; const	char *
		call	_silc_identifier_check
		mov	edi, eax
		test	eax, eax
		jz	loc_62B8745F
		mov	eax, [server_entry_0]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], server_name_0 ; char *
		call	_strdup
		mov	[server_entry_0], eax
		test	eax, eax
		jz	loc_62B8745F
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	dword ptr [esp+10h], 1
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	[esp+4], server_entry_0
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+11Ch]
		mov	[esp], eax
		call	_silc_idcache_update_by_context
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock

loc_62B87425:				; CODE XREF: _silc_client_update_server+11j
					; _silc_client_update_server+2Bj
		mov	eax, [ebp+server_info]
		test	eax, eax
		jz	short loc_62B8745F
		mov	eax, [server_entry_0+4]
		test	eax, eax
		jz	short loc_62B87449
		mov	edx, [ebp+server_info]
		mov	[esp+4], edx
		mov	[esp], eax
		call	_silc_utf8_strcasecmp
		test	al, al
		jnz	short loc_62B8745F
		mov	eax, [server_entry_0+4]

loc_62B87449:				; CODE XREF: _silc_client_update_server+E9j
		mov	[esp], eax
		call	_silc_free
		mov	eax, [ebp+server_info]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[server_entry_0+4], eax

loc_62B8745F:				; CODE XREF: _silc_client_update_server+67j
					; _silc_client_update_server+83j ...
		add	esp, 2Ch
		pop	server_entry_0
		pop	server_name_0
		pop	edi
		leave
		retn
_silc_client_update_server endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry   8. silc_client_add_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcServerEntry __cdecl silc_client_add_server(SilcClient client, SilcClientConnection conn, const char *server_name,	const char *server_info, SilcServerID *server_id)
		public _silc_client_add_server
_silc_client_add_server	proc near	; CODE XREF: _silc_client_command_reply_info+357p
					; _silc_client_command_reply_identify+472p

var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
server_name	= dword	ptr  10h
server_info	= dword	ptr  14h
server_id	= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+server_id]
		test	esi, esi
		jnz	short loc_62B87484

loc_62B87478:				; CODE XREF: _silc_client_add_server+1CFj
server_entry = ebx			; SilcServerEntry
server_namec = esi			; char *
		xor	server_entry, server_entry

loc_62B8747A:				; CODE XREF: _silc_client_add_server+34j
					; _silc_client_add_server+192j
		mov	eax, server_entry
		add	esp, 3Ch
		pop	server_entry
		pop	server_namec
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B87484:				; CODE XREF: _silc_client_add_server+Ej
server_id_0 = esi			; SilcServerID *
		mov	dword ptr [esp+4], 38h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
server_entry = ebx			; SilcServerEntry
		test	eax, eax
		jz	short loc_62B8747A
server_entry = eax			; SilcServerEntry
		lea	server_entry, [server_entry+28h]
server_entry = ebx			; SilcServerEntry
		mov	[esp], eax
		call	_silc_rwlock_alloc
		mov	dword ptr [server_entry+30h], 0
		mov	dword ptr [server_entry+34h], 1
		lea	eax, [server_entry+8]
		mov	[ebp+var_1C], eax
		mov	ecx, 16h
		mov	edi, eax
		rep movsb
		mov	server_id_0, [ebp+server_name]
		test	esi, esi
		jz	short loc_62B874DA
		mov	edx, [ebp+server_name]
		mov	[esp], edx	; char *
		call	_strdup
		mov	[server_entry],	eax

loc_62B874DA:				; CODE XREF: _silc_client_add_server+63j
		mov	ecx, [ebp+server_info]
		test	ecx, ecx
		jz	short loc_62B874EF
		mov	eax, [ebp+server_info]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[server_entry+4], eax

loc_62B874EF:				; CODE XREF: _silc_client_add_server+77j
		mov	edx, [ebp+server_name]
		test	edx, edx
		jz	loc_62B875A0
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+server_name]
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 100h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	edx, [ebp+server_name]
		mov	[esp], edx
		call	_silc_identifier_check
		mov	esi, eax
server_namec = esi			; char *
		test	eax, eax
		jz	loc_62B875FF

loc_62B8753A:				; CODE XREF: _silc_client_add_server+13Aj
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	[esp+0Ch], server_entry
		mov	eax, [ebp+var_1C]
		mov	[esp+8], eax
		mov	[esp+4], server_namec
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+11Ch]
		mov	[esp], eax
		call	_silc_idcache_add
		test	eax, eax
		jz	short loc_62B875A4
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	eax, [server_entry+30h]
		mov	eax, [server_entry+30h]
		inc	eax
		mov	[server_entry+30h], eax
		mov	eax, server_entry
		add	esp, 3Ch
		pop	server_entry
		pop	server_namec
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
server_entry = ebx			; SilcServerEntry
		align 10h

loc_62B875A0:				; CODE XREF: _silc_client_add_server+8Cj
		xor	esi, esi
server_namec = esi			; char *
		jmp	short loc_62B8753A
; ---------------------------------------------------------------------------

loc_62B875A4:				; CODE XREF: _silc_client_add_server+10Bj
		mov	[esp], server_namec
		call	_silc_free
		mov	eax, [server_entry]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [server_entry+4]
		mov	[esp], eax
		call	_silc_free
		lea	eax, [server_entry+34h]	; atomic
		call	_silc_atomic_uninit32
		lea	eax, [server_entry+30h]	; atomic
		call	_silc_atomic_uninit32
		mov	eax, [server_entry+28h]
		mov	[esp], eax
		call	_silc_rwlock_free
		mov	[esp], server_entry
		call	_silc_free
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		xor	server_entry, server_entry
		jmp	loc_62B8747A
; ---------------------------------------------------------------------------

loc_62B875FF:				; CODE XREF: _silc_client_add_server+CCj
server_namec = eax			; char *
		mov	server_namec, [server_entry]
server_namec = esi			; char *
		mov	[esp], eax
		call	_silc_free
		mov	eax, [server_entry+4]
		mov	[esp], eax
		call	_silc_free
		lea	eax, [server_entry+34h]	; atomic
		call	_silc_atomic_uninit32
		lea	eax, [server_entry+30h]	; atomic
		call	_silc_atomic_uninit32
		mov	eax, [server_entry+28h]
		mov	[esp], eax
		call	_silc_rwlock_free
		mov	[esp], server_entry
		call	_silc_free
		jmp	loc_62B87478
_silc_client_add_server	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __usercall silc_dlist_add@<al>(SilcDList list@<eax>,	void *context@<edx>)
_silc_dlist_add	proc near		; CODE XREF: _silc_client_get_clients_local_ext+237p
					; _silc_client_get_clients_local_ext+33Bp
list = eax				; SilcDList
context	= edx				; void *
		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, list
		mov	esi, context
		mov	dword ptr [esp], 0Ch
		call	_silc_malloc
list = ebx				; SilcDList
context	= esi				; void *
		test	eax, eax
e = eax					; SilcDListEntry
		jz	short loc_62B87680
		mov	[e], context
		mov	edx, [list]
		test	edx, edx
		jz	short loc_62B87694
		movzx	edx, word ptr [list+0Ch]
		mov	ecx, [list+4]
		mov	[ecx+edx], e

loc_62B8766A:				; CODE XREF: _silc_dlist_add+5Ej
		test	byte ptr [list+10h], 1
		jnz	short loc_62B87688

loc_62B87670:				; CODE XREF: _silc_dlist_add+56j
		mov	[list+4], e
		mov	dword ptr [e+edx], 0
		add	dword ptr [list+10h], 4
		mov	al, 1

loc_62B87680:				; CODE XREF: _silc_dlist_add+1Aj
		add	esp, 10h
		pop	list
		pop	context
		leave
		retn
; ---------------------------------------------------------------------------
list = ebx				; SilcDList
context	= esi				; void *
e = eax					; SilcDListEntry
		align 4

loc_62B87688:				; CODE XREF: _silc_dlist_add+32j
		movzx	ecx, word ptr [list+0Eh]
		mov	context, [list+4]
		mov	[e+ecx], esi
		jmp	short loc_62B87670
; ---------------------------------------------------------------------------

loc_62B87694:				; CODE XREF: _silc_dlist_add+22j
context	= esi				; void *
		mov	[list],	e
		movzx	edx, word ptr [list+0Ch]
		jmp	short loc_62B8766A
_silc_dlist_add	endp

; Exported entry 139. silc_client_get_server_by_id

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcServerEntry __cdecl silc_client_get_server_by_id(SilcClient client, SilcClientConnection conn, SilcServerID *server_id)
		public _silc_client_get_server_by_id
_silc_client_get_server_by_id proc near	; CODE XREF: _silc_client_notify_server_signoff+111p
					; _silc_client_notify_killed+212p ...

var_1C		= dword	ptr -1Ch
id_cache	= dword	ptr -0Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
server_id	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	ebx, [ebp+conn]
		mov	esi, [ebp+server_id]
		mov	ecx, [ebp+client]
		test	ecx, ecx
		jnz	short loc_62B876BC

loc_62B876B1:				; CODE XREF: _silc_client_get_server_by_id+22j
					; _silc_client_get_server_by_id+26j
conn_0 = ebx				; SilcClientConnection
server_id_0 = esi			; SilcServerID *
		xor	eax, eax

loc_62B876B3:				; CODE XREF: _silc_client_get_server_by_id+9Bj
		add	esp, 30h
		pop	conn_0
		pop	server_id_0
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
server_id_0 = esi			; SilcServerID *
		align 4

loc_62B876BC:				; CODE XREF: _silc_client_get_server_by_id+13j
		test	conn_0,	conn_0
		jz	short loc_62B876B1
		test	server_id_0, server_id_0
		jz	short loc_62B876B1
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+id_cache]
		mov	[esp+8], eax
		mov	[esp+4], server_id_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+11Ch]
		mov	[esp], eax
		call	_silc_idcache_find_by_id_one
		test	al, al
		jz	short loc_62B87724
		mov	eax, [ebp+id_cache]
		mov	eax, [eax+0Ch]
entry =	eax				; SilcServerEntry
		mov	edx, [entry+30h]
		mov	edx, [entry+30h]
		inc	edx
		mov	[entry+30h], edx
		mov	edx, [conn_0+54h]
		mov	edx, [edx+0B8h]
		mov	[esp], edx
		mov	[ebp+var_1C], entry
		call	_silc_mutex_unlock
		mov	eax, [ebp+var_1C]
		add	esp, 30h
		pop	conn_0
		pop	server_id_0
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
server_id_0 = esi			; SilcServerID *
		align 4

loc_62B87724:				; CODE XREF: _silc_client_get_server_by_id+57j
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		xor	eax, eax
entry =	eax				; SilcServerEntry
		jmp	loc_62B876B3
_silc_client_get_server_by_id endp

; Exported entry 126. silc_client_get_channel_by_id

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcChannelEntry __cdecl silc_client_get_channel_by_id(SilcClient client, SilcClientConnection conn, SilcChannelID *channel_id)
		public _silc_client_get_channel_by_id
_silc_client_get_channel_by_id proc near ; CODE	XREF: _silc_client_channel_message+13Ap
					; _silc_client_save_channel_key+3F1p ...

var_1C		= dword	ptr -1Ch
id_cache	= dword	ptr -0Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel_id	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	ebx, [ebp+conn]
		mov	esi, [ebp+channel_id]
		mov	eax, [ebp+client]
		test	eax, eax
		jnz	short loc_62B8775C

loc_62B87751:				; CODE XREF: _silc_client_get_channel_by_id+22j
					; _silc_client_get_channel_by_id+26j
conn_0 = ebx				; SilcClientConnection
channel_id_0 = esi			; SilcChannelID	*
		xor	eax, eax

loc_62B87753:				; CODE XREF: _silc_client_get_channel_by_id+A3j
		add	esp, 30h
		pop	conn_0
		pop	channel_id_0
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
channel_id_0 = esi			; SilcChannelID	*
		align 4

loc_62B8775C:				; CODE XREF: _silc_client_get_channel_by_id+13j
		test	conn_0,	conn_0
		jz	short loc_62B87751
		test	channel_id_0, channel_id_0
		jz	short loc_62B87751
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+id_cache]
		mov	[esp+8], eax
		mov	[esp+4], channel_id_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+118h]
		mov	[esp], eax
		call	_silc_idcache_find_by_id_one
		test	al, al
		jz	short loc_62B877CC
		mov	eax, [ebp+id_cache]
		mov	eax, [eax+0Ch]
entry =	eax				; SilcChannelEntry
		mov	edx, [entry+174h]
		mov	edx, [entry+174h]
		inc	edx
		mov	[entry+174h], edx
		mov	edx, [conn_0+54h]
		mov	edx, [edx+0B8h]
		mov	[esp], edx
		mov	[ebp+var_1C], entry
		call	_silc_mutex_unlock
		mov	eax, [ebp+var_1C]
		add	esp, 30h
		pop	conn_0
		pop	channel_id_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B877CC:				; CODE XREF: _silc_client_get_channel_by_id+57j
conn_0 = ebx				; SilcClientConnection
channel_id_0 = esi			; SilcChannelID	*
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		xor	eax, eax
entry =	eax				; SilcChannelEntry
		jmp	loc_62B87753
_silc_client_get_channel_by_id endp

; Exported entry 130. silc_client_get_client_by_id

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientEntry __cdecl silc_client_get_client_by_id(SilcClient client, SilcClientConnection conn, SilcClientID *client_id)
		public _silc_client_get_client_by_id
_silc_client_get_client_by_id proc near	; CODE XREF: _silc_client_channel_message+65p
					; _silc_client_ftp+72p	...

var_1C		= dword	ptr -1Ch
id_cache	= dword	ptr -0Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_id	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	ebx, [ebp+conn]
		mov	esi, [ebp+client_id]
		mov	edx, [ebp+client]
		test	edx, edx
		jnz	short loc_62B87804

loc_62B877F9:				; CODE XREF: _silc_client_get_client_by_id+22j
					; _silc_client_get_client_by_id+26j
conn_0 = ebx				; SilcClientConnection
client_id_0 = esi			; SilcClientID *
		xor	eax, eax

loc_62B877FB:				; CODE XREF: _silc_client_get_client_by_id+A3j
		add	esp, 30h
		pop	conn_0
		pop	client_id_0
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
client_id_0 = esi			; SilcClientID *
		align 4

loc_62B87804:				; CODE XREF: _silc_client_get_client_by_id+13j
		test	conn_0,	conn_0
		jz	short loc_62B877F9
		test	client_id_0, client_id_0
		jz	short loc_62B877F9
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+id_cache]
		mov	[esp+8], eax
		mov	[esp+4], client_id_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_find_by_id_one
		test	al, al
		jz	short loc_62B87874
		mov	eax, [ebp+id_cache]
		mov	eax, [eax+0Ch]
client_entry = eax			; SilcClientEntry
		mov	edx, [client_entry+3F8h]
		mov	edx, [client_entry+3F8h]
		inc	edx
		mov	[client_entry+3F8h], edx
		mov	edx, [conn_0+54h]
		mov	edx, [edx+0B8h]
		mov	[esp], edx
		mov	[ebp+var_1C], client_entry
		call	_silc_mutex_unlock
		mov	eax, [ebp+var_1C]
		add	esp, 30h
		pop	conn_0
		pop	client_id_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B87874:				; CODE XREF: _silc_client_get_client_by_id+57j
conn_0 = ebx				; SilcClientConnection
client_id_0 = esi			; SilcClientID *
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		xor	eax, eax
client_entry = eax			; SilcClientEntry
		jmp	loc_62B877FB
_silc_client_get_client_by_id endp

; Exported entry 138. silc_client_get_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcServerEntry __cdecl silc_client_get_server(SilcClient client, SilcClientConnection conn, char *server_name)
		public _silc_client_get_server
_silc_client_get_server	proc near	; CODE XREF: _silc_client_command_getkey+24Cp

var_2C		= dword	ptr -2Ch
id_cache	= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
server_name	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+conn]
		mov	edx, [ebp+server_name]
		mov	ecx, [ebp+client]
		test	ecx, ecx
		jnz	short loc_62B878AC

loc_62B878A2:				; CODE XREF: _silc_client_get_server+22j
					; _silc_client_get_server+26j ...
conn_0 = ebx				; SilcClientConnection
server_name_0 =	edx			; char *
		xor	eax, eax

loc_62B878A4:				; CODE XREF: _silc_client_get_server+C0j
					; _silc_client_get_server+E0j
		add	esp, 4Ch
		pop	conn_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B878AC:				; CODE XREF: _silc_client_get_server+14j
conn_0 = ebx				; SilcClientConnection
		test	conn_0,	conn_0
		jz	short loc_62B878A2
		test	server_name_0, server_name_0
		jz	short loc_62B878A2
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, server_name_0
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 100h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	[esp], edx
server_name_0 =	edx			; char *
		call	_silc_identifier_check
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B878A2
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+id_cache]
		mov	[esp+8], eax
		mov	[esp+4], esi
		mov	eax, [conn_0+54h]
		mov	eax, [eax+11Ch]
		mov	[esp], eax
		call	_silc_idcache_find_by_name_one
		test	al, al
		jz	short loc_62B87951
		mov	eax, [ebp+id_cache]
		mov	eax, [eax+0Ch]
entry =	eax				; SilcServerEntry
		mov	edx, [entry+30h]
		mov	edx, [entry+30h]
		inc	edx
		mov	[entry+30h], edx
		mov	edx, [conn_0+54h]
		mov	edx, [edx+0B8h]
		mov	[esp], edx
		mov	[ebp+var_2C], entry
		call	_silc_mutex_unlock
		mov	[esp], esi
		call	_silc_free
		mov	eax, [ebp+var_2C]
		jmp	loc_62B878A4
; ---------------------------------------------------------------------------

loc_62B87951:				; CODE XREF: _silc_client_get_server+8Fj
		mov	[esp], esi
		call	_silc_free
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		xor	eax, eax
entry =	eax				; SilcServerEntry
		jmp	loc_62B878A4
_silc_client_get_server	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 227. silc_client_unref_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_unref_channel(SilcClient client, SilcClientConnection conn, SilcChannelEntry	channel_entry)
		public _silc_client_unref_channel
_silc_client_unref_channel proc	near	; CODE XREF: _silc_client_empty_channel+96p
					; _silc_client_remove_from_channels+92p ...

var_2C		= dword	ptr -2Ch
id_cache	= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	edi, [ebp+client]
		mov	esi, [ebp+conn]
		mov	ebx, [ebp+channel_entry]
		test	ebx, ebx
		jz	short loc_62B879A0
client_0 = edi				; SilcClient
conn_0 = esi				; SilcClientConnection
channel_entry_0	= ebx			; SilcChannelEntry
		mov	eax, [channel_entry_0+174h]
		mov	edx, [channel_entry_0+174h]
		dec	edx
		mov	[channel_entry_0+174h],	edx
		dec	eax
		jz	short loc_62B879A8

loc_62B879A0:				; CODE XREF: _silc_client_unref_channel+14j
					; _silc_client_unref_channel+240j ...
ret = eax				; SilcBool
		add	esp, 3Ch
		pop	channel_entry_0
		pop	conn_0
		pop	client_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B879A8:				; CODE XREF: _silc_client_unref_channel+2Aj
client_0 = edi				; SilcClient
conn_0 = esi				; SilcClientConnection
channel_entry_0	= ebx			; SilcChannelEntry
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+id_cache]
		mov	[esp+8], eax
		mov	[esp+4], channel_entry_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+118h]
		mov	[esp], eax
		call	_silc_idcache_find_by_context
		test	al, al
		jnz	loc_62B87BBC
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock

loc_62B879EE:				; CODE XREF: _silc_client_unref_channel+298j
ret = eax				; SilcBool ; channel
		mov	[esp+8], channel_entry_0
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_empty_channel
		mov	[esp+8], channel_entry_0 ; channel
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_del_channel_private_keys
		mov	eax, [channel_entry_0+134h]
		mov	[esp], eax
		call	_silc_hash_table_free
		mov	eax, [channel_entry_0]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [channel_entry_0+108h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [channel_entry_0+10Ch]
		test	eax, eax
		jz	short loc_62B87A46
		mov	[esp], eax
		call	_silc_pkcs_public_key_free

loc_62B87A46:				; CODE XREF: _silc_client_unref_channel+C8j
		mov	eax, [channel_entry_0+158h]
		test	eax, eax
		jz	short loc_62B87A58
		mov	[esp], eax
		call	_silc_cipher_free

loc_62B87A58:				; CODE XREF: _silc_client_unref_channel+DAj
		mov	eax, [channel_entry_0+15Ch]
		test	eax, eax
		jz	short loc_62B87A6A
		mov	[esp], eax
		call	_silc_cipher_free

loc_62B87A6A:				; CODE XREF: _silc_client_unref_channel+ECj
		mov	eax, [channel_entry_0+160h]
		test	eax, eax
		jz	short loc_62B87A7C
		mov	[esp], eax
		call	_silc_hmac_free

loc_62B87A7C:				; CODE XREF: _silc_client_unref_channel+FEj
		mov	eax, [channel_entry_0+148h]
		test	eax, eax
		jz	short loc_62B87AEC
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		jmp	short loc_62B87ABB
; ---------------------------------------------------------------------------
		align 10h

loc_62B87AA0:				; CODE XREF: _silc_client_unref_channel+15Ej
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B87AA7:				; CODE XREF: _silc_client_unref_channel+167j
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	edx, [edx]
key = edx				; SilcCipher
		test	key, key
		jz	short loc_62B87AE7
		mov	[esp], key
		call	_silc_cipher_free

loc_62B87ABB:				; CODE XREF: _silc_client_unref_channel+129j
		mov	eax, [channel_entry_0+148h] ; list
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B87AE0
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B87AA0
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	short loc_62B87AA7
; ---------------------------------------------------------------------------
		align 10h

loc_62B87AE0:				; CODE XREF: _silc_client_unref_channel+158j
		mov	dword ptr [eax+14h], 0

loc_62B87AE7:				; CODE XREF: _silc_client_unref_channel+13Dj
key = edx				; SilcCipher
		call	_silc_dlist_uninit

loc_62B87AEC:				; CODE XREF: _silc_client_unref_channel+110j
		mov	eax, [channel_entry_0+14Ch]
		test	eax, eax
		jz	short loc_62B87B5C
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		jmp	short loc_62B87B2B
; ---------------------------------------------------------------------------
		align 10h

loc_62B87B10:				; CODE XREF: _silc_client_unref_channel+1CEj
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B87B17:				; CODE XREF: _silc_client_unref_channel+1D7j
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	edx, [edx]
hmac = edx				; SilcHmac
		test	hmac, hmac
		jz	short loc_62B87B57
		mov	[esp], hmac
		call	_silc_hmac_free

loc_62B87B2B:				; CODE XREF: _silc_client_unref_channel+199j
		mov	eax, [channel_entry_0+14Ch] ; list
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B87B50
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B87B10
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	short loc_62B87B17
; ---------------------------------------------------------------------------
		align 10h

loc_62B87B50:				; CODE XREF: _silc_client_unref_channel+1C8j
		mov	dword ptr [eax+14h], 0

loc_62B87B57:				; CODE XREF: _silc_client_unref_channel+1ADj
hmac = edx				; SilcHmac
		call	_silc_dlist_uninit

loc_62B87B5C:				; CODE XREF: _silc_client_unref_channel+180j
		mov	eax, [channel_entry_0+110h]
		test	eax, eax
		jz	short loc_62B87B76
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	_silc_argument_list_free

loc_62B87B76:				; CODE XREF: _silc_client_unref_channel+1F0j
		lea	eax, [channel_entry_0+178h] ; atomic
		call	_silc_atomic_uninit32
		lea	eax, [channel_entry_0+174h] ; atomic
		call	_silc_atomic_uninit32
		mov	eax, [channel_entry_0+144h]
		mov	[esp], eax
		call	_silc_rwlock_free
		mov	[esp+4], channel_entry_0
		mov	eax, [conn_0+4Ch]
		mov	eax, [eax+0Ch]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_context
		mov	[esp], channel_entry_0
		call	_silc_free
		jmp	loc_62B879A0
; ---------------------------------------------------------------------------
		align 4

loc_62B87BBC:				; CODE XREF: _silc_client_unref_channel+63j
		mov	eax, [ebp+id_cache]
		mov	edx, [eax+8]
namec =	edx				; char *
		mov	dword ptr [esp+8], 0
		mov	[esp+4], channel_entry_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+118h]
		mov	[esp], eax
		mov	[ebp+var_2C], namec
		call	_silc_idcache_del_by_context
		mov	edx, [ebp+var_2C]
		mov	[esp], edx
namec =	edx				; char *
		mov	byte ptr [ebp+var_2C], al
		call	_silc_free
		mov	edx, [conn_0+54h]
		mov	edx, [edx+0B8h]
		mov	[esp], edx
		call	_silc_mutex_unlock
		mov	al, byte ptr [ebp+var_2C]
		test	al, al
ret = eax				; SilcBool
		jz	loc_62B879A0
		jmp	loc_62B879EE
_silc_client_unref_channel endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 103. silc_client_del_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_del_channel(SilcClient client, SilcClientConnection conn, SilcChannelEntry channel)
		public _silc_client_del_channel
_silc_client_del_channel proc near	; CODE XREF: _silc_client_del_connection+DBp
					; _silc_client_remove_from_channels+132p ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+channel]
		test	eax, eax
		jz	short loc_62B87C37
channel_0 = eax				; SilcChannelEntry
		mov	edx, [channel_0+178h]
		mov	ecx, [channel_0+178h]
		dec	ecx
		mov	[channel_0+178h], ecx
		dec	edx
		jz	short loc_62B87C3C

loc_62B87C37:				; CODE XREF: _silc_client_del_channel+Bj
		xor	channel_0, channel_0
		leave
		retn
; ---------------------------------------------------------------------------
channel_0 = eax				; SilcChannelEntry
		align 4

loc_62B87C3C:				; CODE XREF: _silc_client_del_channel+21j
		mov	[esp+8], channel_0 ; channel_entry
		mov	channel_0, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	al, 1
		leave
		retn
_silc_client_del_channel endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 194. silc_client_replace_channel_id

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_replace_channel_id(SilcClient client, SilcClientConnection conn,	SilcChannelEntry channel, SilcChannelID	*new_id)
		public _silc_client_replace_channel_id
_silc_client_replace_channel_id	proc near
					; CODE XREF: _silc_client_notify_channel_change+165p
					; _silc_client_command_reply_join+53Ep

client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h
new_id		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+conn]
		mov	ebx, [ebp+channel]
		mov	edi, [ebp+new_id]
		test	edi, edi
		jz	short loc_62B87CD5
conn_0 = esi				; SilcClientConnection
channel_0 = ebx				; SilcChannelEntry
new_id_0 = edi				; SilcChannelID	*
		mov	eax, [channel_0+144h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], new_id_0
		mov	[esp+4], channel_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+118h]
		mov	[esp], eax
		call	_silc_idcache_update_by_context
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	eax, [channel_0+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock

loc_62B87CD5:				; CODE XREF: _silc_client_replace_channel_id+14j
		xor	eax, eax
		add	esp, 2Ch
		pop	channel_0
		pop	conn_0
		pop	new_id_0
		leave
		retn
_silc_client_replace_channel_id	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   2. silc_client_add_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcChannelEntry __cdecl silc_client_add_channel(SilcClient client, SilcClientConnection conn, const char *channel_name, SilcUInt32 mode, SilcChannelID *channel_id)
		public _silc_client_add_channel
_silc_client_add_channel proc near	; CODE XREF: _silc_client_st_resume_resolve_channels+3C7p
					; _silc_client_command_reply_list+37Dp	...

var_12C		= dword	ptr -12Ch
name		= byte ptr -119h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel_name	= dword	ptr  10h
mode		= dword	ptr  14h
channel_id	= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 14Ch
		mov	esi, [ebp+channel_id]
		mov	dword ptr [esp+4], 180h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
channel	= ebx				; SilcChannelEntry
		test	eax, eax
		jz	loc_62B87E95
channel_id_0 = esi			; SilcChannelID	*
channel	= eax				; SilcChannelEntry
		lea	channel, [channel+144h]
channel	= ebx				; SilcChannelEntry
		mov	[esp], eax
		call	_silc_rwlock_alloc
		mov	dword ptr [channel+174h], 0
		mov	dword ptr [channel+178h], 1
		lea	eax, [channel+114h]
		mov	[ebp+var_12C], eax
		mov	ecx, 16h
		mov	edi, eax
		rep movsb
		mov	eax, [ebp+mode]
		mov	[channel+12Ch],	eax
		mov	dword ptr [esp+10h], 101h
		lea	eax, [channel+4]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 101h
		lea	channel_id_0, [ebp+name]
		mov	[esp+4], esi
		mov	edx, [ebp+channel_name]
		mov	[esp], edx
		call	_silc_parse_userfqdn
		mov	eax, [ebp+client]
		mov	eax, [eax+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+23h], 0
		jnz	loc_62B87EA4
		mov	[esp], esi	; char *
		call	_strdup
		mov	[channel], eax

loc_62B87D96:				; CODE XREF: _silc_client_add_channel+1D1j
		test	eax, eax
		jz	loc_62B87EB8
		mov	dword ptr [esp+1Ch], 1
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset _silc_hash_ptr
		mov	dword ptr [esp], 1
		call	_silc_hash_table_alloc
		mov	[channel+134h],	eax
		test	eax, eax
		jz	loc_62B87EE8
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, esi
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 100h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	[esp], esi
		call	_silc_channel_name_check
		mov	esi, eax
		test	eax, eax
		jz	loc_62B87F28
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	[esp+0Ch], channel
		mov	eax, [ebp+var_12C]
		mov	[esp+8], eax
		mov	[esp+4], esi
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+118h]
		mov	[esp], eax
		call	_silc_idcache_add
		test	eax, eax
		jz	loc_62B87F74
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	eax, [channel+174h]
		mov	eax, [channel+174h]
		inc	eax
		mov	[channel+174h],	eax

loc_62B87E95:				; CODE XREF: _silc_client_add_channel+27j
					; _silc_client_add_channel+206j ...
channel_id_0 = esi			; SilcChannelID	*
		mov	eax, channel
		add	esp, 14Ch
		pop	channel
		pop	channel_id_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
channel	= ebx				; SilcChannelEntry
		align 4

loc_62B87EA4:				; CODE XREF: _silc_client_add_channel+A6j
		mov	eax, [ebp+channel_name]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[channel], eax
		jmp	loc_62B87D96
; ---------------------------------------------------------------------------
		align 4

loc_62B87EB8:				; CODE XREF: _silc_client_add_channel+B8j
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_free
		lea	eax, [channel+174h] ; atomic
		call	_silc_atomic_uninit32
		lea	eax, [channel+178h] ; atomic
		call	_silc_atomic_uninit32
		mov	[esp], channel
		call	_silc_free
		xor	channel, channel
		jmp	short loc_62B87E95
; ---------------------------------------------------------------------------

loc_62B87EE8:				; CODE XREF: _silc_client_add_channel+10Aj
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_free
		lea	eax, [channel+174h] ; atomic
		call	_silc_atomic_uninit32
		lea	eax, [channel+178h] ; atomic
		call	_silc_atomic_uninit32
		mov	eax, [channel]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], channel
		call	_silc_free
		xor	channel, channel
		jmp	loc_62B87E95
; ---------------------------------------------------------------------------
		align 4

loc_62B87F28:				; CODE XREF: _silc_client_add_channel+146j
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_free
		lea	eax, [channel+174h] ; atomic
		call	_silc_atomic_uninit32
		lea	eax, [channel+178h] ; atomic
		call	_silc_atomic_uninit32
		mov	eax, [channel]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [channel+134h]
		mov	[esp], eax
		call	_silc_hash_table_free
		mov	[esp], channel
		call	_silc_free
		xor	channel, channel
		jmp	loc_62B87E95
; ---------------------------------------------------------------------------
		align 4

loc_62B87F74:				; CODE XREF: _silc_client_add_channel+188j
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_free
		lea	eax, [channel+174h] ; atomic
		call	_silc_atomic_uninit32
		lea	eax, [channel+178h] ; atomic
		call	_silc_atomic_uninit32
		mov	[esp], esi
		call	_silc_free
		mov	eax, [channel]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [channel+134h]
		mov	[esp], eax
		call	_silc_hash_table_free
		mov	[esp], channel
		call	_silc_free
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		xor	channel, channel
		jmp	loc_62B87E95
_silc_client_add_channel endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 125. silc_client_get_channel

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcChannelEntry __cdecl silc_client_get_channel(SilcClient client, SilcClientConnection conn, char *channel)
		public _silc_client_get_channel
_silc_client_get_channel proc near	; CODE XREF: _silc_client_command_leave+A4p
					; _silc_client_command_kick+4Fp ...

server		= byte ptr -22Eh
chname		= byte ptr -12Dh
list		= SilcList ptr -2Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 24Ch
		mov	ebx, [ebp+conn]
		mov	eax, [ebp+channel]
		mov	esi, [ebp+client]
		test	esi, esi
		jnz	short loc_62B88004

loc_62B87FF5:				; CODE XREF: _silc_client_get_channel+2Aj
					; _silc_client_get_channel+2Ej	...
conn_0 = ebx				; SilcClientConnection
channel_0 = eax				; char *
		xor	esi, esi

loc_62B87FF7:				; CODE XREF: _silc_client_get_channel+195j
					; _silc_client_get_channel+1B7j
channel_0 = edi				; char *
entry =	esi				; SilcChannelEntry
		mov	eax, entry
		add	esp, 24Ch
		pop	conn_0
		pop	entry
		pop	channel_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B88004:				; CODE XREF: _silc_client_get_channel+17j
conn_0 = ebx				; SilcClientConnection
channel_0 = eax				; char *
		test	conn_0,	conn_0
		jz	short loc_62B87FF5
		test	channel_0, channel_0
		jz	short loc_62B87FF5
		mov	dword ptr [esp+10h], 101h
		lea	edx, [ebp+server]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 101h
		lea	esi, [ebp+chname]
		mov	[esp+4], esi
		mov	[esp], channel_0
		call	_silc_parse_userfqdn
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, esi
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 100h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	[esp], esi
		call	_silc_channel_name_check
		mov	edi, eax
channel_0 = edi				; char *
		test	eax, eax
		jz	short loc_62B87FF5
channel_0 = eax				; char *
		mov	channel_0, [conn_0+54h]
channel_0 = edi				; char *
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+list]
		mov	[esp+8], eax
		mov	[esp+4], channel_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+118h]
		mov	[esp], eax
		call	_silc_idcache_find_by_name
		test	al, al
		jz	loc_62B88178
		mov	eax, [ebp+list.head]
		mov	[ebp+list.current], eax
		and	[ebp+list._bf10], 0FDh
		cmp	[ebp+server], 0
		jnz	short loc_62B88116
		jmp	short loc_62B880E8
; ---------------------------------------------------------------------------
entry =	esi				; SilcChannelEntry
		align 4

loc_62B880BC:				; CODE XREF: _silc_client_get_channel+118j
		movzx	edx, [ebp+list.prev_offset]
		mov	edx, [eax+edx]

loc_62B880C3:				; CODE XREF: _silc_client_get_channel+121j
		mov	[ebp+list.current], edx
		mov	entry, [eax+0Ch]
		cmp	byte ptr [entry+4], 0
		jz	short loc_62B88145
		mov	eax, [conn_0+8]
		mov	[esp+4], eax
		lea	eax, [entry+4]
		mov	[esp], eax
		call	_silc_utf8_strcasecmp
		test	al, al
		jnz	short loc_62B88145
		mov	eax, [ebp+list.current]

loc_62B880E8:				; CODE XREF: _silc_client_get_channel+DCj
		test	eax, eax
		jz	loc_62B88178
		test	[ebp+list._bf10], 2
		jnz	short loc_62B880BC
		movzx	edx, [ebp+list.next_offset]
		mov	edx, [eax+edx]
		jmp	short loc_62B880C3
; ---------------------------------------------------------------------------
		align 10h

loc_62B88100:				; CODE XREF: _silc_client_get_channel+142j
		movzx	edx, [ebp+list.prev_offset]
		mov	edx, [eax+edx]

loc_62B88107:				; CODE XREF: _silc_client_get_channel+14Bj
		mov	[ebp+list.current], edx
		mov	entry, [eax+0Ch]
		cmp	byte ptr [entry+4], 0
		jnz	short loc_62B8812C

loc_62B88113:				; CODE XREF: _silc_client_get_channel+167j
		mov	eax, [ebp+list.current]

loc_62B88116:				; CODE XREF: _silc_client_get_channel+DAj
		test	eax, eax
		jz	short loc_62B88178
		test	[ebp+list._bf10], 2
		jnz	short loc_62B88100
		movzx	edx, [ebp+list.next_offset]
		mov	edx, [eax+edx]
		jmp	short loc_62B88107
; ---------------------------------------------------------------------------
		align 4

loc_62B8812C:				; CODE XREF: _silc_client_get_channel+135j
		lea	eax, [ebp+server]
		mov	[esp+4], eax
		lea	eax, [entry+4]
		mov	[esp], eax
		call	_silc_utf8_strcasecmp
		test	al, al
		jz	short loc_62B88113

loc_62B88145:				; CODE XREF: _silc_client_get_channel+F1j
					; _silc_client_get_channel+107j
		mov	eax, [entry+174h]
		mov	eax, [entry+174h]
		inc	eax
		mov	[entry+174h], eax
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[esp], channel_0
		call	_silc_free
		jmp	loc_62B87FF7
; ---------------------------------------------------------------------------
		align 4

loc_62B88178:				; CODE XREF: _silc_client_get_channel+C3j
					; _silc_client_get_channel+10Ej ...
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[esp], channel_0
		call	_silc_free
		xor	entry, entry
		jmp	loc_62B87FF7
_silc_client_get_channel endp

; Exported entry 159. silc_client_nickname_parse

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_nickname_parse(SilcClient client, SilcClientConnection conn, char *nickname, char **ret_nick)
		public _silc_client_nickname_parse
_silc_client_nickname_parse proc near	; CODE XREF: _silc_client_get_clients_local_ext+93p
					; _silc_client_get_clients_i+99p ...

var_19		= byte ptr -19h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
nickname	= dword	ptr  10h
ret_nick	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [ebp+nickname]
		mov	eax, [ebp+client]
		mov	eax, [eax+18h]
		mov	eax, [eax+4Ch]
		mov	dl, [eax+1]
s = edx					; char
		test	dl, dl
		jz	loc_62B88280
nickname_0 = ebx			; char *
		test	nickname_0, nickname_0
		jz	loc_62B8825A
		cmp	byte ptr [nickname_0], 0
		jz	loc_62B8825A
		add	eax, 2
		xor	esi, esi
n = esi					; SilcBool
		mov	[ebp+var_19], 0
		xor	edi, edi

loc_62B881D4:				; CODE XREF: _silc_client_nickname_parse+6Dj
s = edi					; char
		cmp	dl, 25h
		jz	short loc_62B881F4
s = edx					; char
		cmp	dl, 61h
		jz	short loc_62B881F4
		jg	loc_62B88264
		cmp	dl, 48h
		jz	short loc_62B881F4

loc_62B881E9:				; CODE XREF: _silc_client_nickname_parse+D4j
		mov	ecx, n
		test	cl, cl
		jz	short loc_62B881F6
		mov	[ebp+var_19], dl
		xchg	ax, ax

loc_62B881F4:				; CODE XREF: _silc_client_nickname_parse+3Fj
					; _silc_client_nickname_parse+44j ...
		mov	s, edi

loc_62B881F6:				; CODE XREF: _silc_client_nickname_parse+55j
					; _silc_client_nickname_parse+E1j
		test	eax, eax
		jz	short loc_62B88208
		mov	cl, [eax]
s = ecx					; char
		inc	eax
		test	cl, cl
		jz	short loc_62B88208
		mov	edi, edx
		mov	dl, cl
		jmp	short loc_62B881D4
; ---------------------------------------------------------------------------
		align 4

loc_62B88208:				; CODE XREF: _silc_client_nickname_parse+60j
					; _silc_client_nickname_parse+67j
		mov	eax, n
		test	al, al
		jz	short loc_62B8825A
s = edx					; char
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, nickname_0
		repne scasb
		not	ecx
		lea	n, [ecx-1]
len = esi				; int
		test	dl, dl
		jz	short loc_62B88238
		movsx	s, dl
		mov	[esp+4], s	; int
		mov	[esp], ebx	; char *
nickname_0 = ebx			; char *
		call	_strchr
		test	eax, eax
		jz	short loc_62B88238
		lea	nickname_0, [eax+1]

loc_62B88238:				; CODE XREF: _silc_client_nickname_parse+88j
					; _silc_client_nickname_parse+9Bj
s = edx					; char
nick = ebx				; char *
		cmp	[ebp+var_19], 0
		jz	short loc_62B88256
		movsx	eax, [ebp+var_19]
e = eax					; char
		mov	[esp+4], e	; int
		mov	[esp], nick	; char *
		call	_strchr
		test	eax, eax
		jz	short loc_62B88256
		mov	len, eax
		sub	len, nick

loc_62B88256:				; CODE XREF: _silc_client_nickname_parse+A4j
					; _silc_client_nickname_parse+B8j
s = edx					; char
		test	len, len
		jnz	short loc_62B88294

loc_62B8825A:				; CODE XREF: _silc_client_nickname_parse+22j
					; _silc_client_nickname_parse+2Bj ...
		xor	eax, eax

loc_62B8825C:				; CODE XREF: _silc_client_nickname_parse+112j
		add	esp, 2Ch
		pop	nick
		pop	len
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B88264:				; CODE XREF: _silc_client_nickname_parse+46j
nickname_0 = ebx			; char *
n = esi					; SilcBool
		cmp	dl, 68h
		jz	short loc_62B881F4
		cmp	dl, 6Eh
		jnz	loc_62B881E9
		mov	s, edi
		mov	n, 1
		jmp	loc_62B881F6
; ---------------------------------------------------------------------------
		align 10h

loc_62B88280:				; CODE XREF: _silc_client_nickname_parse+1Aj
		mov	eax, [ebp+ret_nick]
		mov	dword ptr [eax], 0
		mov	al, 1
		add	esp, 2Ch
		pop	nickname_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
nick = ebx				; char *
len = esi				; int
		align 4

loc_62B88294:				; CODE XREF: _silc_client_nickname_parse+C0j
		mov	[esp+4], len
		mov	[esp], nick
		call	_silc_memdup
		mov	edx, [ebp+ret_nick]
		mov	[edx], eax
		test	eax, eax
		setnz	al
		jmp	short loc_62B8825C
_silc_client_nickname_parse endp

; Exported entry 135. silc_client_get_clients_local_ext

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcDList __cdecl silc_client_get_clients_local_ext(SilcClient client, SilcClientConnection conn, const char *nickname, SilcBool get_all, SilcBool get_valid)
		public _silc_client_get_clients_local_ext
_silc_client_get_clients_local_ext proc	near ; CODE XREF: _silc_client_get_clients_local+2Ap
					; _silc_client_nickname_format+63p

var_1CC		= dword	ptr -1CCh
context		= dword	ptr -1C4h
var_1C0		= dword	ptr -1C0h
var_1B9		= byte ptr -1B9h
server		= byte ptr -1B2h
nick		= byte ptr -0B1h
list		= SilcList ptr -30h
parsed		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
nickname	= dword	ptr  10h
get_all		= byte ptr  14h
get_valid	= byte ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1ECh
		mov	esi, [ebp+client]
		mov	eax, [ebp+nickname]
		mov	bl, [ebp+get_all]
		mov	dl, [ebp+get_valid]
		mov	[ebp+var_1B9], dl
		test	esi, esi
		jnz	short loc_62B882E0

loc_62B882CE:				; CODE XREF: _silc_client_get_clients_local_ext+39j
					; _silc_client_get_clients_local_ext+3Dj ...
client_0 = esi				; SilcClient
get_all_0 = ebx				; SilcBool
		xor	client_0, client_0

loc_62B882D0:				; CODE XREF: _silc_client_get_clients_local_ext+2DAj
					; _silc_client_get_clients_local_ext+36Dj ...
clients	= esi				; SilcDList
nicknamec = edi				; char *
format = ebx				; char *
		mov	eax, clients
		add	esp, 1ECh
		pop	format
		pop	clients
		pop	nicknamec
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = esi				; SilcClient
nickname_0 = eax			; const	char *
get_all_0 = ebx				; SilcBool
		align 10h

loc_62B882E0:				; CODE XREF: _silc_client_get_clients_local_ext+20j
		mov	ecx, [ebp+conn]
		test	ecx, ecx
		jz	short loc_62B882CE
		test	nickname_0, nickname_0
		jz	short loc_62B882CE
		mov	[ebp+parsed], 0
		mov	dword ptr [esp+10h], 101h
		lea	edx, [ebp+server]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 81h
		lea	edx, [ebp+nick]
		mov	[ebp+var_1CC], edx
		mov	[esp+4], edx
		mov	[esp], nickname_0
		call	_silc_parse_userfqdn
		lea	eax, [ebp+parsed]
		mov	[esp+0Ch], eax	; ret_nick
		lea	eax, [ebp+nick]
		mov	[esp+8], eax	; nickname
		mov	edx, [ebp+conn]
		mov	[esp+4], edx	; conn
		mov	[esp], client_0	; client
		call	_silc_client_nickname_parse
		test	al, al
		jz	short loc_62B882CE
		test	bl, bl
		jnz	loc_62B8858B
		mov	edx, [ebp+parsed]
		test	edx, edx
		jz	loc_62B88673
		lea	eax, [ebp+nick]
		mov	[ebp+var_1C0], eax

loc_62B88367:				; CODE XREF: _silc_client_get_clients_local_ext+2F4j
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, edx
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 80h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	[esp], edx
		call	_silc_identifier_check
		mov	edi, eax
nicknamec = edi				; char *
		test	eax, eax
		jz	loc_62B88661
nicknamec = eax				; char *
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
nicknamec = edi				; char *
		mov	client_0, eax
clients	= esi				; SilcDList
		test	eax, eax
		jz	loc_62B88606
clients	= eax				; SilcDList
		mov	dword ptr [clients+18h], 0
		mov	dword ptr [clients+14h], 0
		mov	clients, [clients+10h]
clients	= esi				; SilcDList
		and	eax, 3
		mov	[clients+10h], eax
		mov	word ptr [clients+0Ch],	4
		mov	word ptr [clients+0Eh],	8
		mov	byte ptr [clients+10h],	1
		mov	dword ptr [clients+8], 0
		mov	dword ptr [clients+4], 0
		mov	dword ptr [clients], 0
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	eax, dword ptr [ebp+list._bf10]
		and	eax, 3
		mov	dword ptr [ebp+list._bf10], eax
		mov	[ebp+list.next_offset],	0
		mov	[ebp+list.prev_offset],	0
		mov	[ebp+list._bf10], 0
		mov	[ebp+list.current], 0
		mov	[ebp+list.tail], 0
		mov	[ebp+list.head], 0
		lea	eax, [ebp+list]
		mov	[esp+8], eax
		mov	[esp+4], nicknamec
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_find_by_name
		test	al, al
		jz	loc_62B8861E
		mov	eax, [ebp+list.head]
		mov	[ebp+list.current], eax
		and	[ebp+list._bf10], 0FDh
		mov	edx, [ebp+var_1C0]
		test	edx, edx
		jz	loc_62B885A5

loc_62B88475:				; CODE XREF: _silc_client_get_clients_local_ext+2FBj
		mov	get_all_0, [ebp+var_1C0]
format = ebx				; char *
		jmp	short loc_62B884EF
; ---------------------------------------------------------------------------
entry =	edx				; SilcClientEntry
		align 10h

loc_62B88480:				; CODE XREF: _silc_client_get_clients_local_ext+24Bj
		movzx	entry, [ebp+list.prev_offset]
		mov	edx, [eax+edx]

loc_62B88487:				; CODE XREF: _silc_client_get_clients_local_ext+254j
		mov	[ebp+list.current], edx
		mov	edx, [eax+0Ch]
entry =	edx				; SilcClientEntry
		cmp	[ebp+server], 0
		jnz	short loc_62B88504

loc_62B88496:				; CODE XREF: _silc_client_get_clients_local_ext+280j
		test	format,	format
		jz	loc_62B88534
		mov	eax, format

loc_62B884A0:				; CODE XREF: _silc_client_get_clients_local_ext+28Bj
format = eax				; char *
		mov	[esp+4], format
		mov	[esp], entry
		mov	[ebp+context], entry
		call	_silc_utf8_strcasecmp
format = ebx				; char *
		test	al, al
		mov	edx, [ebp+context] ; context
		jz	short loc_62B884EC
		cmp	[ebp+var_1B9], 0
		jz	short loc_62B884CE
		test	byte ptr [edx+402h], 1
entry =	edx				; SilcClientEntry
		jz	short loc_62B884EC

loc_62B884CE:				; CODE XREF: _silc_client_get_clients_local_ext+217j
		mov	eax, [entry+3F8h]
		mov	eax, [entry+3F8h]
		inc	eax
		mov	[entry+3F8h], eax
		mov	eax, clients	; list
		call	_silc_dlist_add
		test	format,	format
		jz	short loc_62B8853C

loc_62B884EC:				; CODE XREF: _silc_client_get_clients_local_ext+20Ej
					; _silc_client_get_clients_local_ext+220j ...
entry =	edx				; SilcClientEntry
		mov	eax, [ebp+list.current]

loc_62B884EF:				; CODE XREF: _silc_client_get_clients_local_ext+1CFj
		test	eax, eax
		jz	short loc_62B8853C
		test	[ebp+list._bf10], 2
		jnz	short loc_62B88480
		movzx	entry, [ebp+list.next_offset]
		mov	edx, [eax+edx]
		jmp	short loc_62B88487
; ---------------------------------------------------------------------------
entry =	edx				; SilcClientEntry
		align 4

loc_62B88504:				; CODE XREF: _silc_client_get_clients_local_ext+1E8j
		lea	eax, [ebp+server]
		mov	[esp+4], eax
		lea	eax, [entry+283h]
		mov	[esp], eax
		mov	[ebp+context], entry
		call	_silc_utf8_strcasecmp
		test	al, al
		mov	edx, [ebp+context]
		jz	short loc_62B884EC
		jmp	loc_62B88496
; ---------------------------------------------------------------------------
entry =	edx				; SilcClientEntry
		align 4

loc_62B88534:				; CODE XREF: _silc_client_get_clients_local_ext+1ECj
		mov	eax, [ebp+parsed]
format = eax				; char *
		jmp	loc_62B884A0
; ---------------------------------------------------------------------------

loc_62B8853C:				; CODE XREF: _silc_client_get_clients_local_ext+23Ej
					; _silc_client_get_clients_local_ext+245j ...
format = ebx				; char *
		mov	entry, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[esp], nicknamec
		call	_silc_free
		mov	eax, [ebp+parsed]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [clients+10h]
		shr	eax, 2
		jz	loc_62B88653
		mov	eax, [clients]
		mov	[clients+8], eax
		and	byte ptr [clients+10h],	0FDh
		mov	dword ptr [clients+18h], 0
		mov	dword ptr [clients+14h], 0
		jmp	loc_62B882D0
; ---------------------------------------------------------------------------

loc_62B8858B:				; CODE XREF: _silc_client_get_clients_local_ext+9Ej
client_0 = esi				; SilcClient
get_all_0 = ebx				; SilcBool
		mov	edx, [ebp+parsed]
		test	edx, edx
		jz	loc_62B88673

loc_62B88596:				; CODE XREF: _silc_client_get_clients_local_ext+3F6j
		mov	[ebp+var_1C0], 0
		jmp	loc_62B88367
; ---------------------------------------------------------------------------

loc_62B885A5:				; CODE XREF: _silc_client_get_clients_local_ext+1C3j
clients	= esi				; SilcDList
nicknamec = edi				; char *
		test	bl, bl
		jz	loc_62B88475
		mov	bl, [ebp+var_1B9]
get_valid_0 = ebx			; SilcBool
		jmp	short loc_62B885EF
; ---------------------------------------------------------------------------

loc_62B885B5:				; CODE XREF: _silc_client_get_clients_local_ext+34Fj
entry =	edx				; SilcClientEntry
		movzx	entry, [ebp+list.prev_offset]
		mov	edx, [eax+edx]

loc_62B885BC:				; CODE XREF: _silc_client_get_clients_local_ext+358j
		mov	[ebp+list.current], edx
		mov	edx, [eax+0Ch]
entry =	edx				; SilcClientEntry
		test	bl, bl
		jz	short loc_62B885CF
		test	byte ptr [entry+402h], 1
		jz	short loc_62B885EC

loc_62B885CF:				; CODE XREF: _silc_client_get_clients_local_ext+318j
		mov	ecx, [entry+3F8h]
		mov	ecx, [entry+3F8h]
		inc	ecx
		mov	[entry+3F8h], ecx
		mov	entry, [eax+0Ch] ; context
		mov	eax, clients	; list
		call	_silc_dlist_add

loc_62B885EC:				; CODE XREF: _silc_client_get_clients_local_ext+321j
entry =	edx				; SilcClientEntry
		mov	eax, [ebp+list.current]

loc_62B885EF:				; CODE XREF: _silc_client_get_clients_local_ext+307j
		test	eax, eax
		jz	loc_62B8853C
		test	[ebp+list._bf10], 2
		jnz	short loc_62B885B5
		movzx	entry, [ebp+list.next_offset]
		mov	edx, [eax+edx]
		jmp	short loc_62B885BC
; ---------------------------------------------------------------------------

loc_62B88606:				; CODE XREF: _silc_client_get_clients_local_ext+107j
get_all_0 = ebx				; SilcBool
clients	= eax				; SilcDList
		mov	[esp], nicknamec
		call	_silc_free
clients	= esi				; SilcDList
		mov	eax, [ebp+parsed]
		mov	[esp], eax
		call	_silc_free
		jmp	loc_62B882D0
; ---------------------------------------------------------------------------

loc_62B8861E:				; CODE XREF: _silc_client_get_clients_local_ext+1ABj
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[esp], nicknamec
		call	_silc_free
		mov	eax, [ebp+parsed]
		mov	[esp], eax
		call	_silc_free
		mov	eax, clients	; list
		call	_silc_dlist_uninit
		xor	clients, clients
		jmp	loc_62B882D0
; ---------------------------------------------------------------------------

loc_62B88653:				; CODE XREF: _silc_client_get_clients_local_ext+2BDj
format = ebx				; char * ; list
		mov	eax, clients
		call	_silc_dlist_uninit
		xor	clients, clients
		jmp	loc_62B882D0
; ---------------------------------------------------------------------------

loc_62B88661:				; CODE XREF: _silc_client_get_clients_local_ext+F1j
client_0 = esi				; SilcClient
get_all_0 = ebx				; SilcBool
nicknamec = eax				; char *
		mov	nicknamec, [ebp+parsed]
nicknamec = edi				; char *
		mov	[esp], eax
		call	_silc_free
		xor	client_0, client_0
clients	= esi				; SilcDList
		jmp	loc_62B882D0
; ---------------------------------------------------------------------------

loc_62B88673:				; CODE XREF: _silc_client_get_clients_local_ext+A9j
					; _silc_client_get_clients_local_ext+2E4j
client_0 = esi				; SilcClient
		xor	eax, eax
		or	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_1CC]
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+4], ecx
		lea	edx, [ebp+nick]
		mov	[esp], edx
		call	_silc_memdup
		mov	edx, eax
		test	eax, eax
		jz	loc_62B882CE
		mov	[ebp+parsed], eax
		jmp	loc_62B88596
_silc_client_get_clients_local_ext endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 134. silc_client_get_clients_local

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcDList __cdecl silc_client_get_clients_local(SilcClient client, SilcClientConnection conn,	const char *nickname, SilcBool return_all)
		public _silc_client_get_clients_local
_silc_client_get_clients_local proc near ; CODE	XREF: _silc_client_command_kick+81p
					; _silc_client_command_kill+74p ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
nickname	= dword	ptr  10h
return_all	= byte ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+10h], 1 ; get_valid
		movzx	eax, [ebp+return_all]
return_all_0 = eax			; SilcBool
		mov	[esp+0Ch], return_all_0	; get_all
		mov	return_all_0, [ebp+nickname]
		mov	[esp+8], eax	; nickname
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_clients_local_ext
		leave
		retn
_silc_client_get_clients_local endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 107. silc_client_del_client_entry

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_del_client_entry(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry)
		public _silc_client_del_client_entry
_silc_client_del_client_entry proc near	; CODE XREF: _silc_client_unref_client+9Dj

client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	esi, [ebp+client]
		mov	edi, [ebp+conn]
		mov	ebx, [ebp+client_entry]
		mov	eax, [ebx+384h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [ebx+388h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [ebx+3ECh]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [ebx+3B0h]
		test	eax, eax
		jz	short loc_62B8872A
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
client_entry_0 = ebx			; SilcClientEntry
		mov	[esp], eax
		call	_silc_pkcs_public_key_free

loc_62B8872A:				; CODE XREF: _silc_client_del_client_entry+44j
		mov	eax, [client_entry_0+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_free
		mov	eax, [client_entry_0+3DCh]
		test	eax, eax
		jz	short loc_62B8874A
		mov	[esp], eax
		call	_silc_cipher_free

loc_62B8874A:				; CODE XREF: _silc_client_del_client_entry+64j
		mov	eax, [client_entry_0+3E0h]
		test	eax, eax
		jz	short loc_62B8875C
		mov	[esp], eax
		call	_silc_cipher_free

loc_62B8875C:				; CODE XREF: _silc_client_del_client_entry+76j
		mov	eax, [client_entry_0+3E4h]
		test	eax, eax
		jz	short loc_62B8876E
		mov	[esp], eax
		call	_silc_hmac_free

loc_62B8876E:				; CODE XREF: _silc_client_del_client_entry+88j
		mov	eax, [client_entry_0+3E8h]
		test	eax, eax
		jz	short loc_62B88780
		mov	[esp], eax
		call	_silc_hmac_free

loc_62B88780:				; CODE XREF: _silc_client_del_client_entry+9Aj
		mov	[esp+4], client_entry_0	; client_entry
		mov	[esp], client_0	; client
		call	_silc_client_ftp_session_free_client
		mov	eax, [client_entry_0+3F4h]
		test	eax, eax
		jz	short loc_62B887A6
		mov	[esp+8], client_entry_0	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_abort_key_agreement

loc_62B887A6:				; CODE XREF: _silc_client_del_client_entry+B8j
		mov	dword ptr [client_entry_0+3FCh], 0
		mov	dword ptr [client_entry_0+3F8h], 0
		mov	eax, [client_entry_0+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_free
		mov	[ebp+client], client_entry_0
		add	esp, 1Ch
		pop	client_entry_0
		pop	client_0
		pop	conn_0
		leave
		jmp	_silc_free
_silc_client_del_client_entry endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 228. silc_client_unref_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_unref_client(SilcClient client, SilcClientConnection	conn, SilcClientEntry client_entry)
		public _silc_client_unref_client
_silc_client_unref_client proc near	; CODE XREF: _silc_client_empty_channel+80p
					; _silc_client_remove_from_channels+7Cp ...

var_1C		= byte ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [ebp+client]
		mov	esi, [ebp+conn]
		mov	ebx, [ebp+client_entry]
		test	ebx, ebx
		jz	short loc_62B88804
client_0 = edi				; SilcClient
conn_0 = esi				; SilcClientConnection
client_entry_0 = ebx			; SilcClientEntry
		mov	eax, [client_entry_0+3F8h]
		mov	edx, [client_entry_0+3F8h]
		dec	edx
		mov	[client_entry_0+3F8h], edx
		dec	eax
		jz	short loc_62B8880C

loc_62B88804:				; CODE XREF: _silc_client_unref_client+14j
					; _silc_client_unref_client+7Bj
ret = eax				; SilcBool
		add	esp, 2Ch
		pop	client_entry_0
		pop	conn_0
		pop	client_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8880C:				; CODE XREF: _silc_client_unref_client+2Aj
client_0 = edi				; SilcClient
conn_0 = esi				; SilcClientConnection
client_entry_0 = ebx			; SilcClientEntry
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	dword ptr [esp+8], 0
		mov	[esp+4], client_entry_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_del_by_context
		mov	edx, [conn_0+54h]
		mov	edx, [edx+0B8h]
		mov	[esp], edx
		mov	[ebp+var_1C], al
		call	_silc_mutex_unlock
		mov	al, [ebp+var_1C]
		test	al, al
ret = eax				; SilcBool
		jz	short loc_62B88804
		mov	[esp+8], client_entry_0	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_remove_from_channels
		mov	[ebp+client_entry], client_entry_0
		mov	[ebp+conn], conn_0
		mov	[ebp+client], client_0
		add	esp, 2Ch
		pop	client_entry_0
		pop	conn_0
		pop	client_0
		leave
		jmp	_silc_client_del_client_entry
_silc_client_unref_client endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 106. silc_client_del_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_del_client(SilcClient client, SilcClientConnection conn,	SilcClientEntry	client_entry)
		public _silc_client_del_client
_silc_client_del_client	proc near	; CODE XREF: _silc_client_del_connection+2C8p
					; _silc_client_notify_watch+337p ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+client_entry]
		test	eax, eax
		jz	short loc_62B8889F
client_entry_0 = eax			; SilcClientEntry
		mov	edx, [client_entry_0+3FCh]
		mov	ecx, [client_entry_0+3FCh]
		dec	ecx
		mov	[client_entry_0+3FCh], ecx
		dec	edx
		jz	short loc_62B888A4

loc_62B8889F:				; CODE XREF: _silc_client_del_client+Bj
		xor	client_entry_0,	client_entry_0
		leave
		retn
; ---------------------------------------------------------------------------
client_entry_0 = eax			; SilcClientEntry
		align 4

loc_62B888A4:				; CODE XREF: _silc_client_del_client+21j
		mov	[esp+8], client_entry_0	; client_entry
		mov	client_entry_0,	[ebp+conn]
		mov	[esp+4], eax	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		mov	al, 1
		leave
		retn
_silc_client_del_client	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcUInt16 __usercall	silc_client_get_clients_i@<ax>(SilcClient client@<eax>,	SilcClientConnection conn@<edx>, SilcCommand command@<cl>, const char *nickname, const char *server, SilcBuffer	attributes, SilcGetClientCallback completion, void *context)
_silc_client_get_clients_i proc	near	; CODE XREF: _silc_client_get_clients_whois+39j
					; _silc_client_get_clients+3Aj

var_4C0		= dword	ptr -4C0h
var_4B9		= byte ptr -4B9h
var_4B8		= dword	ptr -4B8h
conn		= dword	ptr -4B4h
client		= dword	ptr -4B0h
var_4AC		= dword	ptr -4ACh
userhost	= byte ptr -49Fh
serv		= byte ptr -19Eh
nick		= byte ptr -9Dh
parsed		= dword	ptr -1Ch
nickname	= dword	ptr  8
server		= dword	ptr  0Ch
attributes	= dword	ptr  10h
completion	= dword	ptr  14h
context		= dword	ptr  18h

client = eax				; SilcClient
conn = edx				; SilcClientConnection
command	= ecx				; SilcCommand
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4ECh
		mov	[ebp+client], client
		mov	[ebp+conn], conn
		mov	client,	[ebp+nickname]
		mov	[ebp+var_4B9], cl
		mov	[ebp+parsed], 0
		mov	command, [ebp+client]
		test	ecx, ecx
		jz	loc_62B88B6C
nickname_0 = eax			; const	char *
		test	conn, conn
		jz	loc_62B88B6C
		test	nickname_0, nickname_0
		jz	loc_62B88B60

loc_62B88906:				; CODE XREF: _silc_client_get_clients_i+2A5j
		mov	dword ptr [esp+10h], 101h
		lea	esi, [ebp+serv]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 81h
		lea	ebx, [ebp+nick]
		mov	[esp+4], ebx
		mov	[esp], nickname_0
		call	_silc_parse_userfqdn
		cmp	eax, 2
		jz	loc_62B88B98

loc_62B8893B:				; CODE XREF: _silc_client_get_clients_i+2DBj
		lea	eax, [ebp+parsed]
		mov	[esp+0Ch], eax	; ret_nick
		mov	[esp+8], ebx	; nickname
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_nickname_parse
		test	al, al
		jnz	loc_62B88B50
		mov	[ebp+var_4B8], ebx

loc_62B8896C:				; CODE XREF: _silc_client_get_clients_i+299j
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
i = ebx					; SilcClientGetClientInternal
		test	eax, eax
		jz	loc_62B88BEC
i = eax					; SilcClientGetClientInternal
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
i = ebx					; SilcClientGetClientInternal
		test	eax, eax
		jz	loc_62B88C00
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	edx, [eax+10h]
		and	edx, 3
		mov	[eax+10h], edx
		mov	word ptr [eax+0Ch], 4
		mov	word ptr [eax+0Eh], 8
		mov	byte ptr [eax+10h], 1
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax], 0
		mov	[i], eax
		mov	eax, [ebp+completion]
		mov	[i+4], eax
		mov	eax, [ebp+context]
		mov	[i+8], eax
		lea	esi, [ebp+userhost]
		mov	ecx, 301h
		mov	edi, esi
		xor	eax, eax
		rep stosb
		mov	edi, [ebp+var_4B8]
		test	edi, edi
		jz	loc_62B88AA1
		mov	ecx, [ebp+server]
		test	ecx, ecx
		jz	loc_62B88BA0
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_4B8]
nickname_0 = edi			; const	char *
		xor	eax, eax
		repne scasb
		mov	edx, ecx
		not	edx
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+server]
		repne scasb
		lea	eax, [edx-1]
		sub	edx, ecx
		mov	[esp+0Ch], eax
		mov	eax, [ebp+var_4B8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], esi
		mov	[ebp+var_4C0], edx
		call	_silc_strncat
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], offset a@_0 ; "@"
		mov	edx, [ebp+var_4C0]
		mov	[esp+4], edx
		mov	[esp], esi
		call	_silc_strncat
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+server]
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+0Ch], ecx
		mov	ecx, [ebp+server]
		mov	[esp+8], ecx
		mov	edx, [ebp+var_4C0]
		mov	[esp+4], edx
		mov	[esp], esi
		call	_silc_strncat

loc_62B88AA1:				; CODE XREF: _silc_client_get_clients_i+140j
					; _silc_client_get_clients_i+310j
		mov	eax, [ebp+parsed]
		mov	[esp], eax
		call	_silc_free
		cmp	[ebp+var_4B9], 3
		jz	loc_62B88C20
		mov	edx, [ebp+attributes]
		test	edx, edx
		jz	loc_62B88BD8
		mov	edx, [ebp+attributes]
		mov	edx, [edx+4]
		mov	[ebp+var_4AC], edx
		mov	ecx, [ebp+attributes]
		mov	edx, [ecx+8]
		sub	edx, [ebp+var_4AC]

loc_62B88ADC:				; CODE XREF: _silc_client_get_clients_i+324j
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, esi
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+2Ch], edx
		mov	eax, [ebp+var_4AC]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 3
		mov	[esp+20h], ecx
		mov	[esp+1Ch], esi
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	[esp+10h], i	; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_clients_cb	; reply
		mov	dword ptr [esp+8], 1 ; command
		mov	edx, [ebp+conn]
		mov	[esp+4], edx	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_command_send

loc_62B88B44:				; CODE XREF: _silc_client_get_clients_i+339j
					; _silc_client_get_clients_i+35Bj ...
		add	esp, 4ECh
		pop	i
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_62B88B50:				; CODE XREF: _silc_client_get_clients_i+A0j
		mov	ecx, [ebp+parsed]
		mov	[ebp+var_4B8], ecx
		jmp	loc_62B8896C
; ---------------------------------------------------------------------------
conn = edx				; SilcClientConnection
nickname_0 = eax			; const	char *
		align 10h

loc_62B88B60:				; CODE XREF: _silc_client_get_clients_i+40j
		mov	conn, [ebp+attributes]
		test	edx, edx
		jnz	loc_62B88906
conn = edx				; SilcClientConnection
		nop

loc_62B88B6C:				; CODE XREF: _silc_client_get_clients_i+30j
					; _silc_client_get_clients_i+38j
		mov	dword ptr [esp], offset	aMissingArgumen	; "Missing arguments to	silc_client_get_cl"...
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		xor	eax, eax
		add	esp, 4ECh
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_62B88B98:				; CODE XREF: _silc_client_get_clients_i+75j
		mov	[ebp+server], esi
		jmp	loc_62B8893B
; ---------------------------------------------------------------------------

loc_62B88BA0:				; CODE XREF: _silc_client_get_clients_i+14Bj
i = ebx					; SilcClientGetClientInternal
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_4B8]
nickname_0 = edi			; const	char *
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+0Ch], ecx
		mov	edx, [ebp+var_4B8]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 300h
		mov	[esp], esi
		call	_silc_strncat
		jmp	loc_62B88AA1
; ---------------------------------------------------------------------------
		align 4

loc_62B88BD8:				; CODE XREF: _silc_client_get_clients_i+1FEj
		xor	edx, edx
		mov	[ebp+var_4AC], 0
		jmp	loc_62B88ADC
; ---------------------------------------------------------------------------
i = eax					; SilcClientGetClientInternal
		align 4

loc_62B88BEC:				; CODE XREF: _silc_client_get_clients_i+C4j
		mov	i, [ebp+parsed]
i = ebx					; SilcClientGetClientInternal
		mov	[esp], eax
		call	_silc_free
		xor	eax, eax
		jmp	loc_62B88B44
; ---------------------------------------------------------------------------
		align 10h

loc_62B88C00:				; CODE XREF: _silc_client_get_clients_i+D8j
		mov	dword ptr [i], 0
		mov	eax, [ebp+parsed]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], i
		call	_silc_free
		xor	eax, eax
		jmp	loc_62B88B44
; ---------------------------------------------------------------------------

loc_62B88C20:				; CODE XREF: _silc_client_get_clients_i+1F3j
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, esi
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+20h], ecx
		mov	[esp+1Ch], esi
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	[esp+10h], i	; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_clients_cb	; reply
		mov	dword ptr [esp+8], 3 ; command
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_command_send
		jmp	loc_62B88B44
_silc_client_get_clients_i endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 136. silc_client_get_clients_whois

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 __cdecl silc_client_get_clients_whois(SilcClient client, SilcClientConnection conn, const char *nickname, const char *server, SilcBuffer attributes, SilcGetClientCallback	completion, void *context)
		public _silc_client_get_clients_whois
_silc_client_get_clients_whois proc near

client		= dword	ptr  8
conn		= dword	ptr  0Ch
nickname	= dword	ptr  10h
server		= dword	ptr  14h
attributes	= dword	ptr  18h
completion	= dword	ptr  1Ch
context		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0Ch
		mov	eax, [ebp+client]
		mov	edx, [ebp+conn]
		mov	ecx, [ebp+nickname]
		mov	ebx, [ebp+server]
		mov	esi, [ebp+attributes]
		mov	edi, [ebp+context]
		mov	[ebp+attributes], edi
		mov	edi, [ebp+completion]
		mov	[ebp+server], edi
		mov	[ebp+nickname],	esi
		mov	[ebp+conn], ebx
		mov	[ebp+client], ecx
		mov	ecx, 1
		add	esp, 0Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		jmp	_silc_client_get_clients_i
_silc_client_get_clients_whois endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 132. silc_client_get_clients

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 __cdecl silc_client_get_clients(SilcClient	client,	SilcClientConnection conn, const char *nickname, const char *server, SilcGetClientCallback completion, void *context)
		public _silc_client_get_clients
_silc_client_get_clients proc near	; CODE XREF: _silc_client_command_kill+402p
					; _silc_client_command_invite+6A9p ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
nickname	= dword	ptr  10h
server		= dword	ptr  14h
completion	= dword	ptr  18h
context		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0Ch
		mov	eax, [ebp+client]
		mov	edx, [ebp+conn]
		mov	ecx, [ebp+nickname]
		mov	ebx, [ebp+server]
		mov	esi, [ebp+completion]
		mov	edi, [ebp+context]
		mov	[ebp+completion], edi
		mov	[ebp+server], esi
		mov	[ebp+nickname],	0
		mov	[ebp+conn], ebx
		mov	[ebp+client], ecx
		mov	ecx, 3
		add	esp, 0Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		jmp	_silc_client_get_clients_i
_silc_client_get_clients endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 128. silc_client_get_channel_resolve

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_get_channel_resolve(SilcClient client, SilcClientConnection conn, char *channel_name, SilcGetChannelCallback	completion, void *context)
		public _silc_client_get_channel_resolve
_silc_client_get_channel_resolve proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel_name	= dword	ptr  10h
completion	= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+client]
		mov	[ebp+var_1C], eax
		mov	ecx, [ebp+conn]
		mov	[ebp+var_20], ecx
		mov	esi, [ebp+channel_name]
		mov	eax, [ebp+completion]
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+context]
		mov	[ebp+var_28], ecx
		mov	edi, [ebp+var_1C]
		test	edi, edi
		jz	loc_62B88E3C
channel_name_0 = esi			; char *
		mov	ebx, [ebp+var_20]
		test	ebx, ebx
		jz	loc_62B88E3C
		test	channel_name_0,	channel_name_0
		jz	loc_62B88E3C
		test	eax, eax
		jz	loc_62B88E3C
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
		test	eax, eax
		jz	loc_62B88E3C
		mov	eax, [ebp+var_24]
		mov	[ebx+4], eax
		mov	ecx, [ebp+var_28]
		mov	[ebx+8], ecx
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
		test	eax, eax
		jz	loc_62B88E44
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	edx, [eax+10h]
		and	edx, 3
		mov	[eax+10h], edx
		mov	word ptr [eax+0Ch], 4
		mov	word ptr [eax+0Eh], 8
		mov	byte ptr [eax+10h], 1
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax], 0
		mov	[ebx], eax
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, channel_name_0
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+20h], ecx
		mov	[esp+1Ch], esi
channel_name_0 = esi			; char *
		mov	dword ptr [esp+18h], 3
		mov	dword ptr [esp+14h], 1 ; argc
		mov	[esp+10h], ebx	; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_channel_cb	; reply
		mov	dword ptr [esp+8], 3 ; command
		mov	eax, [ebp+var_20]
		mov	[esp+4], eax	; conn
		mov	ecx, [ebp+var_1C]
		mov	[esp], ecx	; client
		call	_silc_client_command_send
		test	ax, ax
		jnz	short loc_62B88E3C
		mov	eax, [ebp+var_28]
		mov	[ebp+context], eax
		mov	[ebp+completion], 0
		mov	[ebp+channel_name], 30h
		mov	ecx, [ebp+var_20]
		mov	[ebp+conn], ecx
		mov	eax, [ebp+var_1C]
		mov	[ebp+client], eax
		mov	ecx, [ebp+var_24]
		add	esp, 4Ch
		pop	ebx
		pop	channel_name_0
		pop	edi
		leave
		jmp	ecx
; ---------------------------------------------------------------------------
channel_name_0 = esi			; char *
		align 4

loc_62B88E3C:				; CODE XREF: _silc_client_get_channel_resolve+29j
					; _silc_client_get_channel_resolve+34j	...
		add	esp, 4Ch
		pop	ebx
		pop	channel_name_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B88E44:				; CODE XREF: _silc_client_get_channel_resolve+82j
channel_name_0 = esi			; char *
		mov	dword ptr [ebx], 0
		mov	[ebp+client], ebx
		add	esp, 4Ch
		pop	ebx
		pop	channel_name_0
		pop	edi
		leave
		jmp	_silc_free
_silc_client_get_channel_resolve endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 229. silc_client_unref_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_unref_server(SilcClient client, SilcClientConnection	conn, SilcServerEntry server_entry)
		public _silc_client_unref_server
_silc_client_unref_server proc near	; CODE XREF: _silc_client_del_server+31p
					; _silc_client_get_server_by_id_resolve+1BCp ...

id_cache	= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
server_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+conn]
		mov	ebx, [ebp+server_entry]
		test	ebx, ebx
		jz	short loc_62B88E7C
conn_0 = esi				; SilcClientConnection
server_entry_0 = ebx			; SilcServerEntry
		mov	eax, [server_entry_0+30h]
		mov	edx, [server_entry_0+30h]
		dec	edx
		mov	[server_entry_0+30h], edx
		dec	eax
		jz	short loc_62B88E84

loc_62B88E7C:				; CODE XREF: _silc_client_unref_server+11j
		add	esp, 2Ch
		pop	server_entry_0
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B88E84:				; CODE XREF: _silc_client_unref_server+1Ej
conn_0 = esi				; SilcClientConnection
server_entry_0 = ebx			; SilcServerEntry
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+id_cache]
		mov	[esp+8], eax
		mov	[esp+4], server_entry_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+11Ch]
		mov	[esp], eax
		call	_silc_idcache_find_by_context
		test	al, al
		jnz	short loc_62B88F14

loc_62B88EB5:				; CODE XREF: _silc_client_unref_server+E3j
namec =	edi				; char *
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	eax, [server_entry_0]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [server_entry_0+4]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [server_entry_0+20h]
		test	eax, eax
		jz	short loc_62B88EEA
		mov	[esp], eax
		call	_silc_pkcs_public_key_free

loc_62B88EEA:				; CODE XREF: _silc_client_unref_server+84j
		mov	dword ptr [server_entry_0+34h],	0
		mov	dword ptr [server_entry_0+30h],	0
		mov	eax, [server_entry_0+28h]
		mov	[esp], eax
		call	_silc_rwlock_free
		mov	[esp], server_entry_0
		call	_silc_free
		add	esp, 2Ch
		pop	server_entry_0
		pop	conn_0
		pop	namec
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = esi				; SilcClientConnection
server_entry_0 = ebx			; SilcServerEntry
		align 4

loc_62B88F14:				; CODE XREF: _silc_client_unref_server+57j
		mov	eax, [ebp+id_cache]
		mov	edi, [eax+8]
namec =	edi				; char *
		mov	dword ptr [esp+8], 0
		mov	[esp+4], server_entry_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+11Ch]
		mov	[esp], eax
		call	_silc_idcache_del_by_context
		mov	[esp], namec
		call	_silc_free
		jmp	loc_62B88EB5
_silc_client_unref_server endp

; Exported entry 110. silc_client_del_server

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_del_server(SilcClient client, SilcClientConnection conn,	SilcServerEntry	server)
		public _silc_client_del_server
_silc_client_del_server	proc near	; CODE XREF: _silc_client_del_connection+68p
					; _silc_client_command_process_error+84p

client		= dword	ptr  8
conn		= dword	ptr  0Ch
server		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+server]
		test	eax, eax
		jz	short loc_62B88F5E
server_0 = eax				; SilcServerEntry
		mov	edx, [server_0+34h]
		mov	ecx, [server_0+34h]
		dec	ecx
		mov	[server_0+34h],	ecx
		dec	edx
		jz	short loc_62B88F64

loc_62B88F5E:				; CODE XREF: _silc_client_del_server+Bj
		xor	server_0, server_0
		leave
		retn
; ---------------------------------------------------------------------------
server_0 = eax				; SilcServerEntry
		align 4

loc_62B88F64:				; CODE XREF: _silc_client_del_server+18j
		mov	[esp+8], server_0 ; server_entry
		mov	server_0, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_server
		mov	al, 1
		leave
		retn
_silc_client_del_server	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 127. silc_client_get_channel_by_id_resolve

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 __cdecl silc_client_get_channel_by_id_resolve(SilcClient client, SilcClientConnection conn, SilcChannelID *channel_id, SilcGetChannelCallback completion, void *context)
		public _silc_client_get_channel_by_id_resolve
_silc_client_get_channel_by_id_resolve proc near
					; CODE XREF: _silc_client_notify_killed+2A3p
					; _silc_client_notify_invite+256p ...

var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel_id	= dword	ptr  10h
completion	= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	esi, [ebp+client]
		mov	edi, [ebp+conn]
		test	esi, esi
		jz	loc_62B890DC
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
		test	conn_0,	conn_0
		jz	loc_62B890DC
		mov	edx, [ebp+channel_id]
		test	edx, edx
		jz	loc_62B890DC
		mov	eax, [ebp+completion]
		test	eax, eax
		jz	loc_62B890DC
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
		test	eax, eax
		jz	loc_62B890DC
		mov	eax, [ebp+completion]
		mov	[ebx+4], eax
		mov	eax, [ebp+context]
		mov	[ebx+8], eax
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
		test	eax, eax
		jz	loc_62B89130
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	edx, [eax+10h]
		and	edx, 3
		mov	[eax+10h], edx
		mov	word ptr [eax+0Ch], 4
		mov	word ptr [eax+0Eh], 8
		mov	byte ptr [eax+10h], 1
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax], 0
		mov	[ebx], eax
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel_id]
		mov	[esp], eax
		call	_silc_id_payload_encode
		mov	edx, eax
idp = edx				; SilcBuffer
		test	eax, eax
		jz	loc_62B890E8
idp = eax				; SilcBuffer
		mov	ecx, [idp+4]
		mov	idp, [idp+8]
idp = edx				; SilcBuffer
		sub	eax, ecx
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 5
		mov	dword ptr [esp+14h], 1 ; argc
		mov	[esp+10h], ebx	; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_channel_cb	; reply
		mov	dword ptr [esp+8], 3 ; command
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		mov	[ebp+var_1C], idp
		call	_silc_client_command_send
		mov	ebx, eax
cmd_ident = ebx				; SilcUInt16
		mov	edx, [ebp+var_1C]
		mov	eax, [edx]
idp = edx				; SilcBuffer
		mov	[esp], eax
		call	_silc_free
		mov	edx, [ebp+var_1C]
		mov	[esp], edx
idp = edx				; SilcBuffer
		call	_silc_free

loc_62B890AA:				; CODE XREF: _silc_client_get_channel_by_id_resolve+1AAj
		test	bx, bx
		jnz	short loc_62B890DE
		mov	eax, [ebp+context]
		mov	[esp+10h], eax	; void *
		mov	dword ptr [esp+0Ch], 0 ; SilcDList
		mov	dword ptr [esp+8], 30h ; SilcStatus
		mov	[esp+4], conn_0	; SilcClientConnection
		mov	[esp], client_0	; SilcClient
		call	[ebp+completion]
		mov	eax, cmd_ident
		add	esp, 4Ch
		pop	cmd_ident
		pop	client_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
		align 4

loc_62B890DC:				; CODE XREF: _silc_client_get_channel_by_id_resolve+11j
					; _silc_client_get_channel_by_id_resolve+19j ...
		xor	ebx, ebx

loc_62B890DE:				; CODE XREF: _silc_client_get_channel_by_id_resolve+12Dj
					; _silc_client_get_channel_by_id_resolve+1C0j
cmd_ident = ebx				; SilcUInt16
		mov	eax, cmd_ident
		add	esp, 4Ch
		pop	cmd_ident
		pop	client_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B890E8:				; CODE XREF: _silc_client_get_channel_by_id_resolve+C7j
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
idp = eax				; SilcBuffer
		mov	dword ptr [esp+20h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 5
		mov	dword ptr [esp+14h], 1 ; argc
		mov	[esp+10h], ebx	; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_channel_cb	; reply
		mov	dword ptr [esp+8], 3 ; command
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_command_send
		mov	ebx, eax
cmd_ident = ebx				; SilcUInt16
		jmp	loc_62B890AA
; ---------------------------------------------------------------------------
		align 10h

loc_62B89130:				; CODE XREF: _silc_client_get_channel_by_id_resolve+6Dj
		mov	dword ptr [ebx], 0
		mov	[esp], ebx
		call	_silc_free
		xor	ebx, ebx
cmd_ident = ebx				; SilcUInt16
		jmp	short loc_62B890DE
_silc_client_get_channel_by_id_resolve endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 140. silc_client_get_server_by_id_resolve

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 __cdecl silc_client_get_server_by_id_resolve(SilcClient client, SilcClientConnection conn,	SilcServerID *server_id, SilcGetServerCallback completion, void	*context)
		public _silc_client_get_server_by_id_resolve
_silc_client_get_server_by_id_resolve proc near	; CODE XREF: _silc_client_notify_killed+371p
					; _silc_client_notify_cumode_change+68Fp ...

var_30		= dword	ptr -30h
server		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
server_id	= dword	ptr  10h
completion	= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	edi, [ebp+client]
		mov	ebx, [ebp+conn]
		test	edi, edi
		jz	loc_62B89310
client_0 = edi				; SilcClient
conn_0 = ebx				; SilcClientConnection
		test	conn_0,	conn_0
		jz	loc_62B89310
		mov	eax, [ebp+server_id]
		test	eax, eax
		jz	loc_62B89310
		mov	esi, [ebp+completion]
		test	esi, esi
		jz	loc_62B89310
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
i = esi					; SilcClientGetServerInternal
		test	eax, eax
		jz	loc_62B89310
i = eax					; SilcClientGetServerInternal
		mov	i, [ebp+completion]
i = esi					; SilcClientGetServerInternal
		mov	[i+4], eax
		mov	edx, [ebp+context]
		mov	[i+8], edx
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
		test	eax, eax
		jz	loc_62B893C8
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	edx, [eax+10h]
		and	edx, 3
		mov	[eax+10h], edx
		mov	word ptr [eax+0Ch], 4
		mov	word ptr [eax+0Eh], 8
		mov	byte ptr [eax+10h], 1
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax], 0
		mov	[i], eax
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+var_1C]
		mov	[esp+8], eax
		mov	eax, [ebp+server_id]
		mov	[esp+4], eax
		mov	eax, [conn_0+54h]
		mov	eax, [eax+11Ch]
		mov	[esp], eax
		call	_silc_idcache_find_by_id_one
		test	al, al
		jz	loc_62B893E0
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0Ch]
		mov	[ebp+server], eax
		mov	edx, eax
		mov	eax, [eax+30h]
		mov	eax, [edx+30h]
		inc	eax
		mov	[edx+30h], eax
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	eax, [ebp+server]
		cmp	word ptr [eax+2Ch], 0
		jnz	loc_62B8933F

loc_62B89260:				; CODE XREF: _silc_client_get_server_by_id_resolve+2B4j
		mov	dword ptr [esp+4], 1
		mov	edx, [ebp+server_id]
		mov	[esp], edx
		call	_silc_id_payload_encode
		mov	edx, eax
idp = edx				; SilcBuffer
		test	eax, eax
		jz	loc_62B89380
idp = eax				; SilcBuffer
		mov	ecx, [idp+4]
		mov	idp, [idp+8]
idp = edx				; SilcBuffer
		sub	eax, ecx
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 5
		mov	dword ptr [esp+14h], 1 ; argc
		mov	[esp+10h], i	; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_server_cb ; reply
		mov	dword ptr [esp+8], 3 ; command
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		mov	[ebp+var_30], idp
		call	_silc_client_command_send
		mov	i, eax
cmd_ident = esi				; SilcUInt16
		mov	edx, [ebp+var_30]
		mov	eax, [edx]
idp = edx				; SilcBuffer
		mov	[esp], eax
		call	_silc_free
		mov	edx, [ebp+var_30]
		mov	[esp], edx
idp = edx				; SilcBuffer
		call	_silc_free

loc_62B892DA:				; CODE XREF: _silc_client_get_server_by_id_resolve+27Ej
		test	si, si
		jz	short loc_62B8931C

loc_62B892DF:				; CODE XREF: _silc_client_get_server_by_id_resolve+1F9j
		mov	ecx, [ebp+server]
		test	ecx, ecx
		jz	short loc_62B892F2
		test	si, si
		jz	short loc_62B892F2
		mov	edx, [ebp+server]
		mov	[edx+2Ch], si

loc_62B892F2:				; CODE XREF: _silc_client_get_server_by_id_resolve+1A0j
					; _silc_client_get_server_by_id_resolve+1A5j
		mov	eax, [ebp+server]
		mov	[esp+8], eax	; server_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_server
		mov	eax, cmd_ident
		add	esp, 5Ch
		pop	conn_0
		pop	cmd_ident
		pop	client_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = edi				; SilcClient
conn_0 = ebx				; SilcClientConnection
i = eax					; SilcClientGetServerInternal
		align 10h

loc_62B89310:				; CODE XREF: _silc_client_get_server_by_id_resolve+11j
					; _silc_client_get_server_by_id_resolve+19j ...
		xor	esi, esi

loc_62B89312:				; CODE XREF: _silc_client_get_server_by_id_resolve+238j
					; _silc_client_get_server_by_id_resolve+294j
cmd_ident = esi				; SilcUInt16
		mov	i, cmd_ident
		add	esp, 5Ch
		pop	conn_0
		pop	cmd_ident
		pop	client_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8931C:				; CODE XREF: _silc_client_get_server_by_id_resolve+199j
client_0 = edi				; SilcClient
conn_0 = ebx				; SilcClientConnection
cmd_ident = esi				; SilcUInt16
		mov	eax, [ebp+context]
		mov	[esp+10h], eax	; void *
		mov	dword ptr [esp+0Ch], 0 ; SilcDList
		mov	dword ptr [esp+8], 30h ; SilcStatus
		mov	[esp+4], conn_0	; SilcClientConnection
		mov	[esp], client_0	; SilcClient
		call	[ebp+completion]
		jmp	short loc_62B892DF
; ---------------------------------------------------------------------------

loc_62B8933F:				; CODE XREF: _silc_client_get_server_by_id_resolve+116j
i = esi					; SilcClientGetServerInternal ;	server_entry
		mov	[esp+8], eax
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_server
		mov	[esp+10h], i	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_server_cb ; reply
		mov	edx, [ebp+server]
		movzx	eax, word ptr [edx+2Ch]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], conn_0	; conn
		call	_silc_client_command_pending
		mov	eax, [ebp+server]
		mov	i, [eax+2Ch]
cmd_ident = esi				; SilcUInt16
		jmp	short loc_62B89312
; ---------------------------------------------------------------------------
i = esi					; SilcClientGetServerInternal
idp = eax				; SilcBuffer
		align 10h

loc_62B89380:				; CODE XREF: _silc_client_get_server_by_id_resolve+133j
		mov	dword ptr [esp+20h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 5
		mov	dword ptr [esp+14h], 1 ; argc
		mov	[esp+10h], i	; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_server_cb ; reply
		mov	dword ptr [esp+8], 3 ; command
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_command_send
		mov	i, eax
cmd_ident = esi				; SilcUInt16
		jmp	loc_62B892DA
; ---------------------------------------------------------------------------
i = esi					; SilcClientGetServerInternal
		align 4

loc_62B893C8:				; CODE XREF: _silc_client_get_server_by_id_resolve+6Dj
		mov	dword ptr [i], 0
		mov	[esp], i
		call	_silc_free
		xor	i, i
cmd_ident = esi				; SilcUInt16
		jmp	loc_62B89312
; ---------------------------------------------------------------------------
i = esi					; SilcClientGetServerInternal
		align 10h

loc_62B893E0:				; CODE XREF: _silc_client_get_server_by_id_resolve+E2j
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[ebp+server], 0
		jmp	loc_62B89260
_silc_client_get_server_by_id_resolve endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 149. silc_client_list_free_servers

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_list_free_servers(SilcClient	client,	SilcClientConnection conn, SilcDList server_list)
		public _silc_client_list_free_servers
_silc_client_list_free_servers proc near

var_2C		= dword	ptr -2Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
server_list	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+client]
		mov	edi, [ebp+conn]
		mov	ebx, [ebp+server_list]
		test	ebx, ebx
		jz	loc_62B89538
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
server_list_0 =	ebx			; SilcDList
		mov	eax, [server_list_0]
		mov	[server_list_0+8], eax
		mov	dl, [server_list_0+10h]
		and	edx, 0FFFFFFFDh
		mov	[server_list_0+10h], dl
		mov	dword ptr [server_list_0+18h], 0
		mov	dword ptr [server_list_0+14h], 0
		xor	eax, eax
		jmp	short loc_62B89465
; ---------------------------------------------------------------------------
		align 4

loc_62B8943C:				; CODE XREF: _silc_client_list_free_servers+72j
		movzx	ecx, word ptr [server_list_0+0Eh]
		mov	ecx, [eax+ecx]

loc_62B89443:				; CODE XREF: _silc_client_list_free_servers+7Bj
		mov	[server_list_0+8], ecx
		mov	[server_list_0+14h], eax
		mov	eax, [eax]
server_entry = eax			; SilcServerEntry
		test	server_entry, server_entry
		jz	short loc_62B89487
		mov	[esp+8], server_entry ;	server_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_server
		mov	eax, [server_list_0+14h]
		mov	dl, [server_list_0+10h]

loc_62B89465:				; CODE XREF: _silc_client_list_free_servers+38j
		mov	[server_list_0+18h], eax
		mov	eax, [server_list_0+8]
		test	eax, eax
		jz	short loc_62B89480
		test	dl, 2
		jnz	short loc_62B8943C
		movzx	ecx, word ptr [server_list_0+0Ch]
		mov	ecx, [eax+ecx]
		jmp	short loc_62B89443
; ---------------------------------------------------------------------------
		align 10h

loc_62B89480:				; CODE XREF: _silc_client_list_free_servers+6Dj
		mov	dword ptr [server_list_0+14h], 0

loc_62B89487:				; CODE XREF: _silc_client_list_free_servers+4Dj
server_entry = eax			; SilcServerEntry
		mov	ecx, [server_list_0]
		mov	[server_list_0+8], ecx
		and	edx, 0FFFFFFFDh
		mov	[server_list_0+10h], dl
		test	ecx, ecx
		jz	short loc_62B894DF
		xchg	ax, ax

loc_62B89498:				; CODE XREF: _silc_client_list_free_servers+DDj
		test	byte ptr [server_list_0+10h], 2
		jz	short loc_62B894F0
		movzx	server_entry, word ptr [server_list_0+0Eh]
		mov	eax, [ecx+eax]

loc_62B894A5:				; CODE XREF: _silc_client_list_free_servers+F7j
		mov	[server_list_0+8], eax
		mov	eax, [server_list_0]
		test	eax, eax
		jz	short loc_62B894CB
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
		cmp	ecx, eax
		jz	loc_62B89540
		movzx	conn_0,	word ptr [server_list_0+0Ch]
		jmp	short loc_62B894C2
; ---------------------------------------------------------------------------

loc_62B894BC:				; CODE XREF: _silc_client_list_free_servers+C9j
		cmp	ecx, esi
		jz	short loc_62B894FC
		mov	eax, esi

loc_62B894C2:				; CODE XREF: _silc_client_list_free_servers+BAj
		lea	edx, [eax+edi]
		mov	esi, [edx]
		test	esi, esi
		jnz	short loc_62B894BC

loc_62B894CB:				; CODE XREF: _silc_client_list_free_servers+ACj
		cmp	ecx, [server_list_0+4]
		jz	short loc_62B89529

loc_62B894D0:				; CODE XREF: _silc_client_list_free_servers+127j
					; _silc_client_list_free_servers+12Cj
		mov	[esp], ecx
		call	_silc_free
		mov	ecx, [server_list_0+8]
		test	ecx, ecx
		jnz	short loc_62B89498

loc_62B894DF:				; CODE XREF: _silc_client_list_free_servers+94j
server_entry = eax			; SilcServerEntry
		mov	[ebp+client], server_list_0
		add	esp, 3Ch
		pop	server_list_0
		pop	esi
		pop	edi
		leave
		jmp	_silc_free
; ---------------------------------------------------------------------------
server_list_0 =	ebx			; SilcDList
server_entry = eax			; SilcServerEntry
		align 10h

loc_62B894F0:				; CODE XREF: _silc_client_list_free_servers+9Cj
		movzx	server_entry, word ptr [server_list_0+0Ch]
		mov	eax, [ecx+eax]
		jmp	short loc_62B894A5
; ---------------------------------------------------------------------------
		align 4

loc_62B894FC:				; CODE XREF: _silc_client_list_free_servers+BEj
		mov	[ebp+var_2C], edx

loc_62B894FF:				; CODE XREF: _silc_client_list_free_servers+149j
		mov	esi, [ecx+edi]
		mov	edx, [ebp+var_2C]
		mov	[edx], esi
		test	esi, esi
		jz	short loc_62B8951B
		test	byte ptr [server_list_0+10h], 1
		jz	short loc_62B8951B
		movzx	edi, word ptr [server_list_0+0Eh]
		mov	edx, [ecx+edi]
		mov	[esi+edi], edx

loc_62B8951B:				; CODE XREF: _silc_client_list_free_servers+109j
					; _silc_client_list_free_servers+10Fj
		cmp	ecx, [server_list_0+8]
		jz	short loc_62B8952E

loc_62B89520:				; CODE XREF: _silc_client_list_free_servers+136j
		sub	dword ptr [server_list_0+10h], 4
		cmp	ecx, [server_list_0+4]
		jnz	short loc_62B894D0

loc_62B89529:				; CODE XREF: _silc_client_list_free_servers+CEj
		mov	[server_list_0+4], eax
		jmp	short loc_62B894D0
; ---------------------------------------------------------------------------

loc_62B8952E:				; CODE XREF: _silc_client_list_free_servers+11Ej
		mov	esi, [ebp+var_2C]
		mov	edx, [esi]
		mov	[server_list_0+8], edx
		jmp	short loc_62B89520
; ---------------------------------------------------------------------------

loc_62B89538:				; CODE XREF: _silc_client_list_free_servers+14j
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
		add	esp, 3Ch
		pop	server_list_0
		pop	client_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B89540:				; CODE XREF: _silc_client_list_free_servers+B0j
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
server_list_0 =	ebx			; SilcDList
		movzx	conn_0,	word ptr [server_list_0+0Ch]
		mov	[ebp+var_2C], server_list_0
		xor	eax, eax
		jmp	short loc_62B894FF
_silc_client_list_free_servers endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 147. silc_client_list_free

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_list_free(SilcClient	client,	SilcClientConnection conn, SilcDList client_list)
		public _silc_client_list_free
_silc_client_list_free proc near	; CODE XREF: _silc_client_nickname_format+4E4p
					; _silc_client_nickname_format+50Cp ...

var_2C		= dword	ptr -2Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_list	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+client]
		mov	edi, [ebp+conn]
		mov	ebx, [ebp+client_list]
		test	ebx, ebx
		jz	loc_62B89684
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
client_list_0 =	ebx			; SilcDList
		mov	eax, [client_list_0]
		mov	[client_list_0+8], eax
		mov	dl, [client_list_0+10h]
		and	edx, 0FFFFFFFDh
		mov	[client_list_0+10h], dl
		mov	dword ptr [client_list_0+18h], 0
		mov	dword ptr [client_list_0+14h], 0
		xor	eax, eax
		jmp	short loc_62B895B1
; ---------------------------------------------------------------------------
		align 4

loc_62B89588:				; CODE XREF: _silc_client_list_free+72j
		movzx	ecx, word ptr [client_list_0+0Eh]
		mov	ecx, [eax+ecx]

loc_62B8958F:				; CODE XREF: _silc_client_list_free+7Bj
		mov	[client_list_0+8], ecx
		mov	[client_list_0+14h], eax
		mov	eax, [eax]
client_entry = eax			; SilcClientEntry
		test	client_entry, client_entry
		jz	short loc_62B895D3
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_client
		mov	eax, [client_list_0+14h]
		mov	dl, [client_list_0+10h]

loc_62B895B1:				; CODE XREF: _silc_client_list_free+38j
		mov	[client_list_0+18h], eax
		mov	eax, [client_list_0+8]
		test	eax, eax
		jz	short loc_62B895CC
		test	dl, 2
		jnz	short loc_62B89588
		movzx	ecx, word ptr [client_list_0+0Ch]
		mov	ecx, [eax+ecx]
		jmp	short loc_62B8958F
; ---------------------------------------------------------------------------
		align 4

loc_62B895CC:				; CODE XREF: _silc_client_list_free+6Dj
		mov	dword ptr [client_list_0+14h], 0

loc_62B895D3:				; CODE XREF: _silc_client_list_free+4Dj
client_entry = eax			; SilcClientEntry
		mov	ecx, [client_list_0]
		mov	[client_list_0+8], ecx
		and	edx, 0FFFFFFFDh
		mov	[client_list_0+10h], dl
		test	ecx, ecx
		jz	short loc_62B8962B
		xchg	ax, ax

loc_62B895E4:				; CODE XREF: _silc_client_list_free+DDj
		test	byte ptr [client_list_0+10h], 2
		jz	short loc_62B8963C
		movzx	client_entry, word ptr [client_list_0+0Eh]
		mov	eax, [ecx+eax]

loc_62B895F1:				; CODE XREF: _silc_client_list_free+F7j
		mov	[client_list_0+8], eax
		mov	eax, [client_list_0]
		test	eax, eax
		jz	short loc_62B89617
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
		cmp	ecx, eax
		jz	loc_62B8968C
		movzx	conn_0,	word ptr [client_list_0+0Ch]
		jmp	short loc_62B8960E
; ---------------------------------------------------------------------------

loc_62B89608:				; CODE XREF: _silc_client_list_free+C9j
		cmp	ecx, esi
		jz	short loc_62B89648
		mov	eax, esi

loc_62B8960E:				; CODE XREF: _silc_client_list_free+BAj
		lea	edx, [eax+edi]
		mov	esi, [edx]
		test	esi, esi
		jnz	short loc_62B89608

loc_62B89617:				; CODE XREF: _silc_client_list_free+ACj
		cmp	ecx, [client_list_0+4]
		jz	short loc_62B89675

loc_62B8961C:				; CODE XREF: _silc_client_list_free+127j
					; _silc_client_list_free+12Cj
		mov	[esp], ecx
		call	_silc_free
		mov	ecx, [client_list_0+8]
		test	ecx, ecx
		jnz	short loc_62B895E4

loc_62B8962B:				; CODE XREF: _silc_client_list_free+94j
client_entry = eax			; SilcClientEntry
		mov	[ebp+client], client_list_0
		add	esp, 3Ch
		pop	client_list_0
		pop	esi
		pop	edi
		leave
		jmp	_silc_free
; ---------------------------------------------------------------------------
client_list_0 =	ebx			; SilcDList
client_entry = eax			; SilcClientEntry
		align 4

loc_62B8963C:				; CODE XREF: _silc_client_list_free+9Cj
		movzx	client_entry, word ptr [client_list_0+0Ch]
		mov	eax, [ecx+eax]
		jmp	short loc_62B895F1
; ---------------------------------------------------------------------------
		align 4

loc_62B89648:				; CODE XREF: _silc_client_list_free+BEj
		mov	[ebp+var_2C], edx

loc_62B8964B:				; CODE XREF: _silc_client_list_free+149j
		mov	esi, [ecx+edi]
		mov	edx, [ebp+var_2C]
		mov	[edx], esi
		test	esi, esi
		jz	short loc_62B89667
		test	byte ptr [client_list_0+10h], 1
		jz	short loc_62B89667
		movzx	edi, word ptr [client_list_0+0Eh]
		mov	edx, [ecx+edi]
		mov	[esi+edi], edx

loc_62B89667:				; CODE XREF: _silc_client_list_free+109j
					; _silc_client_list_free+10Fj
		cmp	ecx, [client_list_0+8]
		jz	short loc_62B8967A

loc_62B8966C:				; CODE XREF: _silc_client_list_free+136j
		sub	dword ptr [client_list_0+10h], 4
		cmp	ecx, [client_list_0+4]
		jnz	short loc_62B8961C

loc_62B89675:				; CODE XREF: _silc_client_list_free+CEj
		mov	[client_list_0+4], eax
		jmp	short loc_62B8961C
; ---------------------------------------------------------------------------

loc_62B8967A:				; CODE XREF: _silc_client_list_free+11Ej
		mov	esi, [ebp+var_2C]
		mov	edx, [esi]
		mov	[client_list_0+8], edx
		jmp	short loc_62B8966C
; ---------------------------------------------------------------------------

loc_62B89684:				; CODE XREF: _silc_client_list_free+14j
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
		add	esp, 3Ch
		pop	client_list_0
		pop	client_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8968C:				; CODE XREF: _silc_client_list_free+B0j
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
client_list_0 =	ebx			; SilcDList
		movzx	conn_0,	word ptr [client_list_0+0Ch]
		mov	[ebp+var_2C], client_list_0
		xor	eax, eax
		jmp	short loc_62B8964B
_silc_client_list_free endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 158. silc_client_nickname_format

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientEntry __cdecl silc_client_nickname_format(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry, SilcBool priority)
		public _silc_client_nickname_format
_silc_client_nickname_format proc near	; CODE XREF: _silc_client_update_client+146p
					; _silc_client_add_client+202p	...

var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= byte ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
client_list	= dword	ptr -0B0h
off		= dword	ptr -0ACh
newnick		= byte ptr -0A3h
tmp		= byte ptr -22h
cp		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
priority	= byte ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ECh
		mov	edx, [ebp+client]
		mov	ebx, [ebp+client_entry]
		mov	cl, [ebp+priority]
		mov	eax, [edx+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+1], 0
		jnz	short loc_62B896C8

loc_62B896B9:				; CODE XREF: _silc_client_nickname_format+37j
					; _silc_client_nickname_format+4E9j ...
client_entry_0 = ebx			; SilcClientEntry
unformatted = esi			; SilcClientEntry
formatted = edi				; SilcBool
		mov	eax, client_entry_0
		add	esp, 0ECh
		pop	client_entry_0
		pop	unformatted
		pop	formatted
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = edx				; SilcClient
client_entry_0 = ebx			; SilcClientEntry
priority_0 = ecx			; SilcBool
		align 4

loc_62B896C8:				; CODE XREF: _silc_client_nickname_format+1Fj
		cmp	byte ptr [client_entry_0], 0
		jnz	short loc_62B896D1

loc_62B896CD:				; CODE XREF: _silc_client_nickname_format+7Cj
					; _silc_client_nickname_format+581j
unformatted = esi			; SilcClientEntry
formatted = edi				; SilcBool
		xor	client_entry_0,	client_entry_0
		jmp	short loc_62B896B9
; ---------------------------------------------------------------------------

loc_62B896D1:				; CODE XREF: _silc_client_nickname_format+33j
client_0 = edx				; SilcClient ; get_valid
priority_0 = ecx			; SilcBool
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 1 ; get_all
		mov	[esp+8], client_entry_0	; nickname
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	[esp], client_0	; client
		mov	[ebp+var_C8], client_0
		mov	[ebp+var_C4], cl
		call	_silc_client_get_clients_local_ext
		mov	[ebp+client_list], eax
		test	eax, eax
		mov	edx, [ebp+var_C8]
		mov	cl, [ebp+var_C4]
		jz	short loc_62B896CD
		mov	esi, eax
		mov	eax, [eax+10h]
		shr	eax, 2
		dec	eax
		jz	loc_62B89BAE

loc_62B89725:				; CODE XREF: _silc_client_nickname_format+518j
					; _silc_client_nickname_format+528j
		mov	eax, [client_entry_0+388h]
		test	eax, eax
		jz	loc_62B89B22
		mov	[esp+4], eax
		mov	[esp], client_entry_0
		mov	[ebp+var_C8], edx
		mov	[ebp+var_C4], cl
		call	_silc_utf8_strcasecmp
		test	al, al
		mov	edx, [ebp+var_C8]
		mov	cl, [ebp+var_C4]
		jnz	loc_62B89B22
		mov	edi, 1

loc_62B89764:				; CODE XREF: _silc_client_nickname_format+48Cj
formatted = edi				; SilcBool
		mov	eax, [edx+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+21h], 0
		jz	short loc_62B89772
client_0 = edx				; SilcClient
		xor	formatted, formatted

loc_62B89772:				; CODE XREF: _silc_client_nickname_format+D6j
		mov	esi, [ebp+client_list]
		mov	eax, [esi+14h]
		mov	[ebp+var_B4], client_0
		mov	[ebp+off], client_entry_0
		mov	client_entry_0,	esi
clients	= ebx				; SilcDList
entry =	esi				; SilcClientEntry
		lea	entry, [entry+0]

loc_62B8978C:				; CODE XREF: _silc_client_nickname_format+126j
					; _silc_client_nickname_format+12Ej
		mov	[clients+18h], eax
		mov	eax, [clients+8]
		test	eax, eax
		jz	short loc_62B897FB

loc_62B89796:				; CODE XREF: _silc_client_nickname_format+161j
		test	byte ptr [clients+10h],	2
		jz	loc_62B89928
		movzx	entry, word ptr	[clients+0Eh]
		mov	esi, [eax+esi]

loc_62B897A7:				; CODE XREF: _silc_client_nickname_format+297j
client_0 = edx				; SilcClient
		mov	[clients+8], esi
		mov	[clients+14h], eax
		mov	esi, [eax]
entry =	esi				; SilcClientEntry
		test	entry, entry
		jz	loc_62B89C54
		test	byte ptr [entry+402h], 1
		jz	short loc_62B8978C
		cmp	entry, [ebp+off]
		jz	short loc_62B8978C
		mov	eax, [entry+388h]
		mov	[esp+4], eax
		mov	[esp], entry
		mov	[ebp+var_C4], cl
		call	_silc_utf8_strcasecmp
		test	al, al
		mov	cl, [ebp+var_C4]
		jnz	loc_62B89BC8
		mov	eax, [clients+14h]
		mov	[clients+18h], eax
		mov	eax, [clients+8]
		test	eax, eax
		jnz	short loc_62B89796

loc_62B897FB:				; CODE XREF: _silc_client_nickname_format+FCj
		mov	edx, [ebp+var_B4]
client_0 = edx				; SilcClient
		mov	clients, [ebp+off]
client_entry_0 = ebx			; SilcClientEntry
		mov	eax, [ebp+client_list]
		mov	dword ptr [eax+14h], 0

loc_62B89814:				; CODE XREF: _silc_client_nickname_format+5C8j
		mov	eax, formatted
		test	al, al
		jz	loc_62B89BD9
		xor	entry, entry

loc_62B89820:				; CODE XREF: _silc_client_nickname_format+53Cj
unformatted = esi			; SilcClientEntry
		test	cl, cl
		jz	loc_62B89B86
priority_0 = ecx			; SilcBool
		mov	eax, formatted
		test	al, al
		jnz	loc_62B89BF7

loc_62B89832:				; CODE XREF: _silc_client_nickname_format+5B7j
		test	unformatted, unformatted
		jz	loc_62B89B90
		mov	client_entry_0,	unformatted

loc_62B8983C:				; CODE XREF: _silc_client_nickname_format+4F2j
		lea	ecx, [ebp+newnick]
		mov	[ebp+var_CC], ecx
		mov	ecx, 81h
		xor	eax, eax
		mov	formatted, [ebp+var_CC]
		rep stosb
		mov	eax, [client_0+18h]
		mov	eax, [eax+4Ch]
		inc	eax
		mov	[ebp+cp], eax
		lea	unformatted, [client_entry_0+182h]
		mov	[ebp+var_BC], esi
		mov	[ebp+off], 0
		lea	esi, [ebp+tmp]
		mov	[ebp+var_D0], esi
		mov	[ebp+var_C0], client_0
		mov	client_0, [ebp+client_list]
clients	= edx				; SilcDList
		mov	[ebp+var_B4], client_entry_0
		jmp	short loc_62B898BB
; ---------------------------------------------------------------------------

loc_62B89894:				; CODE XREF: _silc_client_nickname_format+243j
		cmp	cl, 48h
		jz	loc_62B89AF8

loc_62B8989D:				; CODE XREF: _silc_client_nickname_format+24Dj
		mov	esi, [ebp+off]
		mov	[ebp+esi+newnick], cl
		inc	esi
		mov	[ebp+off], esi
		mov	eax, [ebp+cp]

loc_62B898B4:				; CODE XREF: _silc_client_nickname_format+238j
					; _silc_client_nickname_format+258j ...
		inc	eax
		mov	[ebp+cp], eax
		mov	eax, [ebp+cp]

loc_62B898BB:				; CODE XREF: _silc_client_nickname_format+1FAj
		test	eax, eax
		jz	loc_62B89B29
		mov	cl, [eax]
		test	cl, cl
		jz	loc_62B89B29
		cmp	cl, 25h
		jz	short loc_62B898B4
		cmp	cl, 61h
		jz	loc_62B899AF
		jle	short loc_62B89894
		cmp	cl, 68h
		jz	short loc_62B89934
		cmp	cl, 6Eh
		jnz	short loc_62B8989D
		mov	ecx, [ebp+var_B4]
		cmp	byte ptr [ecx],	0
		jz	short loc_62B898B4
		xor	eax, eax
		or	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_B4]
		repne scasb
		not	ecx
		lea	client_entry_0,	[ecx-1]
		lea	eax, [ebp+newnick]
		add	eax, [ebp+off]
		mov	edi, eax
		mov	esi, [ebp+var_B4]
		mov	ecx, ebx
		rep movsb
		add	[ebp+off], ebx
		mov	eax, [ebp+cp]
		jmp	short loc_62B898B4
; ---------------------------------------------------------------------------
clients	= ebx				; SilcDList
entry =	esi				; SilcClientEntry
formatted = edi				; SilcBool
		align 4

loc_62B89928:				; CODE XREF: _silc_client_nickname_format+102j
		movzx	entry, word ptr	[clients+0Ch]
		mov	esi, [eax+esi]
		jmp	loc_62B897A7
; ---------------------------------------------------------------------------

loc_62B89934:				; CODE XREF: _silc_client_nickname_format+248j
client_entry_0 = ebx			; SilcClientEntry
clients	= edx				; SilcDList
		mov	esi, [ebp+var_B4]
		cmp	byte ptr [esi+182h], 0
		jz	loc_62B898B4
		mov	dword ptr [esp+4], offset a_ ; "."
		mov	eax, [ebp+var_BC]
		mov	[esp], eax	; char *
		mov	[ebp+var_C8], clients
		call	_strcspn
		mov	esi, eax
		mov	dword ptr [esp+4], offset asc_62BA86D5 ; "-"
		mov	ecx, [ebp+var_BC]
		mov	[esp], ecx	; char *
		call	_strcspn
		mov	client_entry_0,	eax
len = ebx				; int
		cmp	eax, esi
		mov	edx, [ebp+var_C8]
		jle	short loc_62B89989
len = eax				; int
		mov	ebx, esi

loc_62B89989:				; CODE XREF: _silc_client_nickname_format+2EDj
					; _silc_client_nickname_format+485j
len = ebx				; int
clients	= edx				; SilcDList
		lea	eax, [ebp+newnick]
		add	eax, [ebp+off]
		mov	edi, eax
		mov	esi, [ebp+var_BC]
		mov	ecx, len
		rep movsb
		add	[ebp+off], ebx
		mov	eax, [ebp+cp]
		jmp	loc_62B898B4
; ---------------------------------------------------------------------------

loc_62B899AF:				; CODE XREF: _silc_client_nickname_format+23Dj
client_entry_0 = ebx			; SilcClientEntry
		mov	ecx, [clients+10h]
		shr	ecx, 2
		dec	ecx
		jz	loc_62B898B4
		mov	eax, [clients]
		mov	[clients+8], eax
		and	byte ptr [clients+10h],	0FDh
		mov	dword ptr [clients+18h], 0
		mov	dword ptr [clients+14h], 0
		xor	eax, eax
		mov	esi, 1
max = esi				; int
		mov	[ebp+var_B8], max
		mov	client_entry_0,	clients
		jmp	short loc_62B89A38
; ---------------------------------------------------------------------------

loc_62B899E4:				; CODE XREF: _silc_client_nickname_format+3AEj
clients	= ebx				; SilcDList
		movzx	edx, word ptr [clients+0Eh]
		mov	edx, [eax+edx]

loc_62B899EB:				; CODE XREF: _silc_client_nickname_format+3B7j
		mov	[clients+8], edx
		mov	[clients+14h], eax
		mov	max, [eax]
entry =	esi				; SilcClientEntry
		test	entry, entry
		jz	loc_62B89C65
		mov	eax, [ebp+off]
		mov	[esp+8], eax
		lea	ecx, [ebp+newnick]
		mov	[esp+4], ecx
		mov	[esp], entry
		call	_silc_utf8_strncasecmp
		test	al, al
		jz	short loc_62B89A35
		mov	ecx, 0FFFFFFFFh
		mov	edi, entry
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		cmp	ecx, [ebp+off]
		ja	loc_62B89AD3

loc_62B89A35:				; CODE XREF: _silc_client_nickname_format+381j
					; _silc_client_nickname_format+44Fj ...
num = eax				; int
		mov	num, [clients+14h]

loc_62B89A38:				; CODE XREF: _silc_client_nickname_format+34Aj
max = esi				; int
		mov	[clients+18h], eax
		mov	eax, [clients+8]
		test	eax, eax
		jz	short loc_62B89A51
		test	byte ptr [clients+10h],	2
		jnz	short loc_62B899E4
		movzx	edx, word ptr [clients+0Ch]
		mov	edx, [eax+edx]
		jmp	short loc_62B899EB
; ---------------------------------------------------------------------------

loc_62B89A51:				; CODE XREF: _silc_client_nickname_format+3A8j
		mov	max, [ebp+var_B8]
		mov	edx, clients
		mov	dword ptr [clients+14h], 0

loc_62B89A60:				; CODE XREF: _silc_client_nickname_format+5D5j
		mov	dword ptr [ebp+tmp], 0
		mov	word ptr [ebp+tmp+4], 0
		inc	max
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], offset aD ; "%d"
		mov	dword ptr [esp+4], 5
		lea	ecx, [ebp+tmp]
		mov	[esp], ecx
		mov	[ebp+var_C8], edx
		call	_silc_snprintf
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_D0]
		repne scasb
		not	ecx
		lea	clients, [ecx-1]
		lea	eax, [ebp+newnick]
		add	eax, [ebp+off]
		mov	edi, eax
		mov	esi, [ebp+var_D0]
		mov	ecx, ebx
		rep movsb
		add	[ebp+off], ebx
		mov	eax, [ebp+cp]
		mov	edx, [ebp+var_C8]
		jmp	loc_62B898B4
; ---------------------------------------------------------------------------

loc_62B89AD3:				; CODE XREF: _silc_client_nickname_format+397j
clients	= ebx				; SilcDList
entry =	esi				; SilcClientEntry
		add	entry, [ebp+off]
		mov	[esp], esi	; char *
		call	_atoi
		cmp	[ebp+var_B8], eax
num = eax				; int
		jge	loc_62B89A35
		mov	[ebp+var_B8], num
		jmp	loc_62B89A35
; ---------------------------------------------------------------------------

loc_62B89AF8:				; CODE XREF: _silc_client_nickname_format+1FFj
client_entry_0 = ebx			; SilcClientEntry
clients	= edx				; SilcDList
		mov	esi, [ebp+var_B4]
		cmp	byte ptr [esi+182h], 0
		jz	loc_62B898B4
		xor	eax, eax
		or	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_BC]
		repne scasb
		not	ecx
		lea	client_entry_0,	[ecx-1]
		jmp	loc_62B89989
; ---------------------------------------------------------------------------

loc_62B89B22:				; CODE XREF: _silc_client_nickname_format+95j
					; _silc_client_nickname_format+C1j
client_entry_0 = ebx			; SilcClientEntry
		xor	edi, edi
formatted = edi				; SilcBool
		jmp	loc_62B89764
; ---------------------------------------------------------------------------

loc_62B89B29:				; CODE XREF: _silc_client_nickname_format+225j
					; _silc_client_nickname_format+22Fj
clients	= edx				; SilcDList
		mov	clients, [ebp+var_C0]
client_0 = edx				; SilcClient
		mov	client_entry_0,	[ebp+var_B4]
		mov	eax, [ebp+off]
		mov	[ebp+eax+newnick], 0
		xor	eax, eax
		mov	ecx, 101h
		mov	edi, client_entry_0
		rep stosb
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_CC]
		repne scasb
		not	ecx
		dec	ecx
		mov	edi, client_entry_0
		mov	esi, [ebp+var_CC]
		rep movsb
		mov	ecx, [ebp+client_list]
		mov	[esp+8], ecx	; client_list
		mov	esi, [ebp+conn]
		mov	[esp+4], esi	; conn
		mov	[esp], client_0	; client
		call	_silc_client_list_free
		jmp	loc_62B896B9
; ---------------------------------------------------------------------------

loc_62B89B86:				; CODE XREF: _silc_client_nickname_format+18Aj
client_0 = edx				; SilcClient
priority_0 = ecx			; SilcBool
unformatted = esi			; SilcClientEntry
formatted = edi				; SilcBool
		mov	priority_0, formatted
		test	cl, cl
		jz	loc_62B8983C

loc_62B89B90:				; CODE XREF: _silc_client_nickname_format+19Cj
		mov	unformatted, [ebp+client_list]

loc_62B89B96:				; CODE XREF: _silc_client_nickname_format+52Ej
		mov	[esp+8], esi	; client_list
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	[esp], client_0	; client
		call	_silc_client_list_free
		jmp	loc_62B896B9
; ---------------------------------------------------------------------------

loc_62B89BAE:				; CODE XREF: _silc_client_nickname_format+87j
		test	cl, cl
		jnz	loc_62B89725
priority_0 = ecx			; SilcBool
		mov	eax, [edx+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+21h], 0
		jnz	loc_62B89725
client_0 = edx				; SilcClient
		jmp	short loc_62B89B96
; ---------------------------------------------------------------------------

loc_62B89BC8:				; CODE XREF: _silc_client_nickname_format+150j
clients	= ebx				; SilcDList
entry =	esi				; SilcClientEntry
formatted = edi				; SilcBool
		mov	edx, [ebp+var_B4]
client_0 = edx				; SilcClient
		mov	clients, [ebp+off]
client_entry_0 = ebx			; SilcClientEntry
		jmp	loc_62B89820
; ---------------------------------------------------------------------------

loc_62B89BD9:				; CODE XREF: _silc_client_nickname_format+180j
		mov	eax, [ebp+client_list]
		mov	[esp+8], eax	; client_list
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx	; conn
		mov	[esp], client_0	; client
		call	_silc_client_list_free
		jmp	loc_62B896B9
; ---------------------------------------------------------------------------

loc_62B89BF7:				; CODE XREF: _silc_client_nickname_format+194j
client_0 = edx				; SilcClient
priority_0 = ecx			; SilcBool
unformatted = esi			; SilcClientEntry
		lea	eax, [ebp+cp]
		mov	[esp+0Ch], eax	; ret_nick
		mov	[esp+8], client_entry_0	; nickname
		mov	priority_0, [ebp+conn]
		mov	[esp+4], ecx	; conn
		mov	[esp], client_0	; client
		mov	[ebp+var_C8], client_0
		call	_silc_client_nickname_parse
		test	al, al
		jz	loc_62B896CD
		mov	eax, [ebp+cp]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aS_2 ; "%s"
		mov	dword ptr [esp+4], 101h
		mov	[esp], client_entry_0
		call	_silc_snprintf
		mov	eax, [ebp+cp]
		mov	[esp], eax
		call	_silc_free
		mov	edx, [ebp+var_C8]
		jmp	loc_62B89832
; ---------------------------------------------------------------------------

loc_62B89C54:				; CODE XREF: _silc_client_nickname_format+119j
client_0 = edx				; SilcClient
clients	= ebx				; SilcDList
entry =	esi				; SilcClientEntry
		mov	client_0, [ebp+var_B4]
		mov	clients, [ebp+off]
client_entry_0 = ebx			; SilcClientEntry
		jmp	loc_62B89814
; ---------------------------------------------------------------------------

loc_62B89C65:				; CODE XREF: _silc_client_nickname_format+35Dj
clients	= ebx				; SilcDList
		mov	entry, [ebp+var_B8]
max = esi				; int
		mov	edx, clients
		jmp	loc_62B89A60
_silc_client_nickname_format endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 230. silc_client_update_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_update_client(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry, const char	*nickname, const char *username, const char *userinfo, SilcUInt32 mode)
		public _silc_client_update_client
_silc_client_update_client proc	near	; CODE XREF: _silc_client_command_reply_identify+3C4p
					; _silc_client_command_reply_whois+489p

var_AC		= dword	ptr -0ACh
parsed		= byte ptr -99h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
nickname	= dword	ptr  14h
username	= dword	ptr  18h
userinfo	= dword	ptr  1Ch
mode		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0CCh
		mov	esi, [ebp+conn]
		mov	ebx, [ebp+client_entry]
		mov	edi, [ebp+nickname]
		mov	eax, [ebx+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	eax, [ebx+384h]
		test	eax, eax
		jz	loc_62B89E64

loc_62B89CA5:				; CODE XREF: _silc_client_update_client+1F5j
					; _silc_client_update_client+20Cj
conn_0 = esi				; SilcClientConnection
client_entry_0 = ebx			; SilcClientEntry
nickname_0 = edi			; const	char *
		cmp	byte ptr [client_entry_0+101h],	0
		jz	short loc_62B89CB7
		cmp	byte ptr [client_entry_0+182h],	0
		jnz	short loc_62B89CED

loc_62B89CB7:				; CODE XREF: _silc_client_update_client+38j
		mov	edx, [ebp+username]
		test	edx, edx
		jz	short loc_62B89CED
		mov	dword ptr [esp+10h], 81h
		lea	eax, [client_entry_0+182h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 81h
		lea	eax, [client_entry_0+101h]
		mov	[esp+4], eax
		mov	edx, [ebp+username]
		mov	[esp], edx
		call	_silc_parse_userfqdn

loc_62B89CED:				; CODE XREF: _silc_client_update_client+41j
					; _silc_client_update_client+48j
		cmp	byte ptr [client_entry_0], 0
		jnz	loc_62B89E17
		test	nickname_0, nickname_0
		jz	loc_62B89E17
		mov	dword ptr [esp+10h], 101h
		lea	eax, [client_entry_0+283h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 81h
		lea	eax, [ebp+parsed]
		mov	[ebp+var_AC], eax
		mov	[esp+4], eax
		mov	[esp], nickname_0
		call	_silc_parse_userfqdn
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+22h], 0
		jz	loc_62B89E3C
		mov	[esp+0Ch], nickname_0
		mov	dword ptr [esp+8], offset aS_2 ; "%s"
		mov	dword ptr [esp+4], 101h
		mov	[esp], client_entry_0
		call	_silc_snprintf

loc_62B89D5F:				; CODE XREF: _silc_client_update_client+1EAj
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	nickname_0, [ebp+var_AC]
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 80h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		lea	edx, [ebp+parsed]
		mov	[esp], edx
		call	_silc_identifier_check
		mov	edi, eax
		test	eax, eax
		jz	short loc_62B89E20
		xor	eax, eax
		cmp	[conn_0], client_entry_0
		setz	al
		mov	[esp+0Ch], eax	; priority
		mov	[esp+8], client_entry_0	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_nickname_format
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	dword ptr [esp+10h], 1
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	[esp+4], client_entry_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_update_by_context
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[client_entry_0+388h], edi
		or	byte ptr [client_entry_0+402h],	1

loc_62B89E17:				; CODE XREF: _silc_client_update_client+7Cj
					; _silc_client_update_client+84j
		mov	eax, [ebp+mode]
		mov	[client_entry_0+3ACh], eax

loc_62B89E20:				; CODE XREF: _silc_client_update_client+12Bj
		mov	eax, [client_entry_0+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		add	esp, 0CCh
		pop	client_entry_0
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = esi				; SilcClientConnection
client_entry_0 = ebx			; SilcClientEntry
nickname_0 = edi			; const	char *
		align 4

loc_62B89E3C:				; CODE XREF: _silc_client_update_client+C9j
		lea	eax, [ebp+parsed]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aS_2 ; "%s"
		mov	dword ptr [esp+4], 101h
		mov	[esp], client_entry_0
		call	_silc_snprintf
		jmp	loc_62B89D5F
; ---------------------------------------------------------------------------
		align 4

loc_62B89E64:				; CODE XREF: _silc_client_update_client+2Bj
		mov	ecx, [ebp+userinfo]
		test	ecx, ecx
		jz	loc_62B89CA5
		mov	eax, [ebp+userinfo]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[client_entry_0+384h], eax
		jmp	loc_62B89CA5
_silc_client_update_client endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry   4. silc_client_add_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientEntry __cdecl silc_client_add_client(SilcClient client, SilcClientConnection conn, char *nickname, char *username, char *userinfo, SilcClientID *id, SilcUInt32 mode)
		public _silc_client_add_client
_silc_client_add_client	proc near	; CODE XREF: _silc_client_get_client+41p
					; _silc_client_new_id+8Ep ...

var_AC		= dword	ptr -0ACh
parsed		= byte ptr -99h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
nickname	= dword	ptr  10h
username	= dword	ptr  14h
userinfo	= dword	ptr  18h
id		= dword	ptr  1Ch
mode		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0CCh
		mov	esi, [ebp+id]
		mov	dword ptr [esp+4], 404h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
client_entry = ebx			; SilcClientEntry
		test	eax, eax
		jz	loc_62B8A09B
id_0 = esi				; SilcClientID *
client_entry = eax			; SilcClientEntry
		lea	client_entry, [client_entry+3D8h]
client_entry = ebx			; SilcClientEntry
		mov	[esp], eax
		call	_silc_rwlock_alloc
		mov	dword ptr [client_entry+3F8h], 0
		mov	dword ptr [client_entry+3FCh], 1
		lea	eax, [client_entry+38Ch]
		mov	[ebp+var_AC], eax
		mov	ecx, 1Dh
		mov	edi, eax
		rep movsb
		mov	eax, [ebp+mode]
		mov	[client_entry+3ACh], eax
		mov	ecx, [ebp+userinfo]
		test	ecx, ecx
		jz	loc_62B8A134
mode_0 = eax				; SilcUInt32
		mov	edx, [ebp+userinfo]
		mov	[esp], edx	; char *
		call	_strdup

loc_62B89F0B:				; CODE XREF: _silc_client_add_client+2AEj
		mov	[client_entry+384h], eax
		mov	dword ptr [esp+10h], 101h
		lea	eax, [client_entry+283h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 81h
		lea	id_0, [ebp+parsed]
		mov	[esp+4], esi
		mov	eax, [ebp+nickname]
		mov	[esp], eax
		call	_silc_parse_userfqdn
		mov	edx, [ebp+nickname]
		test	edx, edx
		jz	short loc_62B89F76
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+22h], 0
		jnz	loc_62B8A13C
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], offset aS_2 ; "%s"
		mov	dword ptr [esp+4], 101h
		mov	[esp], client_entry
		call	_silc_snprintf

loc_62B89F76:				; CODE XREF: _silc_client_add_client+BDj
					; _silc_client_add_client+2D3j
		mov	dword ptr [esp+10h], 101h
		lea	eax, [client_entry+182h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 81h
		lea	eax, [client_entry+101h]
		mov	[esp+4], eax
		mov	eax, [ebp+username]
		mov	[esp], eax
		call	_silc_parse_userfqdn
		mov	dword ptr [esp+1Ch], 1
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset _silc_hash_ptr
		mov	dword ptr [esp], 1
		call	_silc_hash_table_alloc
		mov	[client_entry+3B4h], eax
		test	eax, eax
		jz	loc_62B8A0F2
		cmp	byte ptr [client_entry], 0
		jnz	loc_62B8A0A8
		xor	esi, esi

loc_62B8A002:				; CODE XREF: _silc_client_add_client+256j
nick = esi				; char *
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	[esp+0Ch], client_entry
		mov	eax, [ebp+var_AC]
		mov	[esp+8], eax
		mov	[esp+4], nick
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_add
		test	eax, eax
		jz	loc_62B8A160
		mov	[client_entry+388h], nick
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	eax, [client_entry+3F8h]
		mov	eax, [client_entry+3F8h]
		inc	eax
		mov	[client_entry+3F8h], eax
		mov	dword ptr [esp+0Ch], 0 ; priority
		mov	[esp+8], client_entry ;	client_entry
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_nickname_format
		cmp	byte ptr [client_entry], 0
		jz	short loc_62B8A09B
		or	byte ptr [client_entry+402h], 1

loc_62B8A09B:				; CODE XREF: _silc_client_add_client+27j
					; _silc_client_add_client+20Aj	...
		mov	eax, client_entry
		add	esp, 0CCh
		pop	client_entry
		pop	nick
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8A0A8:				; CODE XREF: _silc_client_add_client+172j
client_entry = ebx			; SilcClientEntry
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, esi
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 80h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	[esp], esi
		call	_silc_identifier_check
		mov	esi, eax
nick = esi				; char *
		test	eax, eax
		jnz	loc_62B8A002
nick = eax				; char *
		mov	nick, [client_entry+3B4h]
nick = esi				; char *
		mov	[esp], eax
		call	_silc_hash_table_free

loc_62B8A0F2:				; CODE XREF: _silc_client_add_client+169j
		mov	eax, [client_entry+384h]
		mov	[esp], eax
		call	_silc_free
		lea	eax, [client_entry+3FCh] ; atomic
		call	_silc_atomic_uninit32
		lea	eax, [client_entry+3F8h] ; atomic
		call	_silc_atomic_uninit32
		mov	eax, [client_entry+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_free
		mov	[esp], client_entry
		call	_silc_free
		xor	client_entry, client_entry
		jmp	loc_62B8A09B
; ---------------------------------------------------------------------------
id_0 = esi				; SilcClientID *
mode_0 = eax				; SilcUInt32
		align 4

loc_62B8A134:				; CODE XREF: _silc_client_add_client+72j
		xor	mode_0,	mode_0
		jmp	loc_62B89F0B
; ---------------------------------------------------------------------------
		align 4

loc_62B8A13C:				; CODE XREF: _silc_client_add_client+CCj
		mov	eax, [ebp+nickname]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aS_2 ; "%s"
		mov	dword ptr [esp+4], 101h
		mov	[esp], client_entry
		call	_silc_snprintf
		jmp	loc_62B89F76
; ---------------------------------------------------------------------------

loc_62B8A160:				; CODE XREF: _silc_client_add_client+1B6j
nick = esi				; char *
		mov	[esp], nick
		call	_silc_free
		mov	eax, [client_entry+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_free
		mov	eax, [client_entry+384h]
		mov	[esp], eax
		call	_silc_free
		lea	eax, [client_entry+3FCh] ; atomic
		call	_silc_atomic_uninit32
		lea	eax, [client_entry+3F8h] ; atomic
		call	_silc_atomic_uninit32
		mov	eax, [client_entry+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_free
		mov	[esp], client_entry
		call	_silc_free
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		xor	client_entry, client_entry
		jmp	loc_62B8A09B
_silc_client_add_client	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 129. silc_client_get_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientEntry __cdecl silc_client_get_client(SilcClient client, SilcClientConnection conn, SilcClientID *client_id)
		public _silc_client_get_client
_silc_client_get_client	proc near	; CODE XREF: _silc_client_notify_cumode_change+5E1p
					; _silc_client_notify_cmode_change+7C1p ...

var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_id	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+client]
		mov	esi, [ebp+conn]
		mov	edi, [ebp+client_id]
		test	ebx, ebx
		jnz	short loc_62B8A234

loc_62B8A1E2:				; CODE XREF: _silc_client_get_client+6Aj
					; _silc_client_get_client+6Ej ...
client_0 = ebx				; SilcClient ; mode
conn_0 = esi				; SilcClientConnection
client_id_0 = edi			; SilcClientID *
		mov	dword ptr [esp+18h], 0
		mov	[esp+14h], client_id_0 ; id
		mov	dword ptr [esp+10h], 0 ; userinfo
		mov	dword ptr [esp+0Ch], 0 ; username
		mov	dword ptr [esp+8], 0 ; nickname
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_add_client
		test	eax, eax
client_entry = eax			; SilcClientEntry
		jz	short loc_62B8A22C
		mov	edx, [client_entry+3F8h]
		mov	edx, [client_entry+3F8h]
		inc	edx
		mov	[client_entry+3F8h], edx
		lea	conn_0,	[conn_0+0]

loc_62B8A22C:				; CODE XREF: _silc_client_get_client+48j
		add	esp, 4Ch
		pop	client_0
		pop	conn_0
		pop	client_id_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8A234:				; CODE XREF: _silc_client_get_client+14j
client_0 = ebx				; SilcClient
conn_0 = esi				; SilcClientConnection
client_id_0 = edi			; SilcClientID *
		test	conn_0,	conn_0
		jz	short loc_62B8A1E2
		test	client_id_0, client_id_0
		jz	short loc_62B8A1E2
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+var_1C]
		mov	[esp+8], eax
		mov	[esp+4], client_id_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_find_by_id_one
		test	al, al
		jz	short loc_62B8A2A8
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0Ch]
client_entry = eax			; SilcClientEntry
		mov	edx, [client_entry+3F8h]
		mov	edx, [client_entry+3F8h]
		inc	edx
		mov	[client_entry+3F8h], edx
		mov	edx, [conn_0+54h]
		mov	edx, [edx+0B8h]
		mov	[esp], edx
		mov	[ebp+var_2C], client_entry
		call	_silc_mutex_unlock
		mov	eax, [ebp+var_2C]
		add	esp, 4Ch
		pop	client_0
		pop	conn_0
		pop	client_id_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
conn_0 = esi				; SilcClientConnection
client_id_0 = edi			; SilcClientID *
		align 4

loc_62B8A2A8:				; CODE XREF: _silc_client_get_client+9Fj
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		jmp	loc_62B8A1E2
_silc_client_get_client	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  16. silc_client_change_nickname

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_change_nickname(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry, const char *new_nick, SilcClientID *new_id, const unsigned __int8 *idp, SilcUInt32 idp_len)
		public _silc_client_change_nickname
_silc_client_change_nickname proc near	; CODE XREF: _silc_client_notify_nick_change+26Ap
					; _silc_client_st_resume_resolve_channels+77p ...

var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
new_nick	= dword	ptr  14h
new_id		= dword	ptr  18h
idp		= dword	ptr  1Ch
idp_len		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	ebx, [ebp+conn]
		mov	esi, [ebp+new_nick]
		mov	ecx, 0FFFFFFFFh
		mov	edi, esi
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 80h
		mov	dword ptr [esp+8], 7
		mov	[esp+4], ecx
		mov	[esp], esi
new_nick_0 = esi			; const	char *
		call	_silc_identifier_check
		mov	[ebp+var_1C], eax
		test	eax, eax
		jz	loc_62B8A3BA
conn_0 = ebx				; SilcClientConnection
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	dword ptr [esp+10h], 1
		mov	edx, [ebp+var_1C]
		mov	[esp+0Ch], edx
		mov	ecx, [ebp+new_id]
		mov	[esp+8], ecx
		mov	edi, [ebp+client_entry]
		mov	[esp+4], edi
		mov	eax, [conn_0+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_update_by_context
		test	al, al
		jz	short loc_62B8A3C4
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	ecx, 101h
		mov	edi, [ebp+client_entry]
		xor	eax, eax
		rep stosb
		mov	ecx, 0FFFFFFFFh
		mov	edi, new_nick_0
		repne scasb
		not	ecx
		dec	ecx
		mov	edi, [ebp+client_entry]
		rep movsb
new_nick_0 = esi			; const	char *
		mov	ecx, [ebp+var_1C]
		mov	edx, [ebp+client_entry]
		mov	[edx+388h], ecx
		xor	eax, eax
		cmp	[conn_0], edx
		setz	al
		mov	[esp+0Ch], eax	; priority
		mov	[esp+8], edx	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_nickname_format
		mov	edi, [ebp+client_entry]
		cmp	[conn_0], edi
		jz	short loc_62B8A3EC

loc_62B8A3AE:				; CODE XREF: _silc_client_change_nickname+21Dj
					; _silc_client_change_nickname+24Dj
		mov	ecx, [ebp+client_entry]
		or	byte ptr [ecx+402h], 1
		mov	al, 1

loc_62B8A3BA:				; CODE XREF: _silc_client_change_nickname+46j
		add	esp, 5Ch
		pop	conn_0
		pop	new_nick_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
new_nick_0 = esi			; const	char *
		align 4

loc_62B8A3C4:				; CODE XREF: _silc_client_change_nickname+8Dj
		mov	eax, [ebp+var_1C]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		xor	eax, eax
		add	esp, 5Ch
		pop	conn_0
		pop	new_nick_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
new_nick_0 = esi			; const	char *
		align 4

loc_62B8A3EC:				; CODE XREF: _silc_client_change_nickname+ECj
		mov	eax, [ebp+idp]
		test	eax, eax
		jz	loc_62B8A4D8
		mov	edi, [ebp+idp_len]
		test	edi, edi
		jz	loc_62B8A4D8
		mov	edx, [conn_0+54h]
		mov	new_nick_0, [edx+0F4h]
		mov	eax, [esi+8]
		mov	edi, [esi+4]
		mov	[ebp+var_1C], edi
		mov	ecx, eax
		sub	ecx, edi
		mov	[ebp+var_3C], ecx
		cmp	[ebp+idp_len], ecx
		jbe	loc_62B8A4CD
		mov	ecx, [esi+0Ch]
		mov	[ebp+var_1C], ecx
		sub	ecx, eax
		mov	[ebp+var_20], ecx
		add	ecx, [ebp+var_3C]
		cmp	[ebp+idp_len], ecx
		jbe	short loc_62B8A4A7
		mov	ecx, [esi]
		mov	[ebp+var_24], ecx
		mov	ecx, [ebp+var_1C]
		sub	ecx, [ebp+var_24]
		mov	[ebp+var_2C], ecx
		sub	ecx, [ebp+var_3C]
		mov	[ebp+var_28], ecx
		mov	ecx, [ebp+var_20]
		sub	[ebp+var_28], ecx
		mov	ecx, [ebp+var_28]
		add	ecx, [ebp+idp_len]
		mov	[ebp+var_20], ecx
		cmp	[ebp+var_2C], ecx
		jnb	short loc_62B8A498
		mov	[esp+4], ecx
		mov	eax, [ebp+var_24]
		mov	[esp], eax
		call	_silc_realloc
		test	eax, eax
		jz	loc_62B8A512
		mov	[esi], eax
		sub	edi, [ebp+var_24]
		lea	edi, [eax+edi]
		mov	[esi+4], edi
		mov	edx, [ebp+var_3C]
		lea	ecx, [edi+edx]
		mov	[esi+8], ecx
		add	eax, [ebp+var_20]
		mov	[ebp+var_1C], eax
		mov	[esi+0Ch], eax
		mov	edx, [conn_0+54h]
		mov	eax, ecx

loc_62B8A498:				; CODE XREF: _silc_client_change_nickname+19Dj
		mov	ecx, eax
		sub	ecx, edi
		mov	[ebp+var_3C], ecx
		mov	edi, [ebp+var_1C]
		sub	edi, eax
		mov	[ebp+var_20], edi

loc_62B8A4A7:				; CODE XREF: _silc_client_change_nickname+175j
		mov	ecx, [ebp+idp_len]
		sub	ecx, [ebp+var_3C]
		cmp	[ebp+var_20], ecx
		jb	short loc_62B8A4B7
		add	eax, ecx
		mov	[esi+8], eax

loc_62B8A4B7:				; CODE XREF: _silc_client_change_nickname+1F0j
					; _silc_client_change_nickname+255j
		mov	eax, [edx+0F4h]
		mov	edx, [eax+4]
		mov	[ebp+var_1C], edx
		mov	eax, [eax+8]
		sub	eax, edx
		cmp	[ebp+idp_len], eax
		ja	short loc_62B8A4D8

loc_62B8A4CD:				; CODE XREF: _silc_client_change_nickname+15Ej
		mov	edi, [ebp+var_1C]
		mov	esi, [ebp+idp]
		mov	ecx, [ebp+idp_len]
		rep movsb

loc_62B8A4D8:				; CODE XREF: _silc_client_change_nickname+131j
					; _silc_client_change_nickname+13Cj ...
new_nick_0 = esi			; const	char *
		mov	new_nick_0, [ebp+new_id]
		test	esi, esi
		jz	loc_62B8A3AE
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [conn_0+4]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	eax, [conn_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_set_ids
		jmp	loc_62B8A3AE
; ---------------------------------------------------------------------------

loc_62B8A512:				; CODE XREF: _silc_client_change_nickname+1B0j
		mov	edx, [conn_0+54h]
		jmp	short loc_62B8A4B7
_silc_client_change_nickname endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 148. silc_client_list_free_channels

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_list_free_channels(SilcClient client, SilcClientConnection conn, SilcDList channel_list)
		public _silc_client_list_free_channels
_silc_client_list_free_channels	proc near

var_2C		= dword	ptr -2Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
channel_list	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+client]
		mov	edi, [ebp+conn]
		mov	ebx, [ebp+channel_list]
		test	ebx, ebx
		jz	loc_62B8A650
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
channel_list_0 = ebx			; SilcDList
		mov	eax, [channel_list_0]
		mov	[channel_list_0+8], eax
		mov	dl, [channel_list_0+10h]
		and	edx, 0FFFFFFFDh
		mov	[channel_list_0+10h], dl
		mov	dword ptr [channel_list_0+18h],	0
		mov	dword ptr [channel_list_0+14h],	0
		xor	eax, eax
		jmp	short loc_62B8A57D
; ---------------------------------------------------------------------------
		align 4

loc_62B8A554:				; CODE XREF: _silc_client_list_free_channels+72j
		movzx	ecx, word ptr [channel_list_0+0Eh]
		mov	ecx, [eax+ecx]

loc_62B8A55B:				; CODE XREF: _silc_client_list_free_channels+7Bj
		mov	[channel_list_0+8], ecx
		mov	[channel_list_0+14h], eax
		mov	eax, [eax]
channel_entry =	eax			; SilcChannelEntry
		test	channel_entry, channel_entry
		jz	short loc_62B8A59F
		mov	[esp+8], channel_entry ; channel_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_channel
		mov	eax, [channel_list_0+14h]
		mov	dl, [channel_list_0+10h]

loc_62B8A57D:				; CODE XREF: _silc_client_list_free_channels+38j
		mov	[channel_list_0+18h], eax
		mov	eax, [channel_list_0+8]
		test	eax, eax
		jz	short loc_62B8A598
		test	dl, 2
		jnz	short loc_62B8A554
		movzx	ecx, word ptr [channel_list_0+0Ch]
		mov	ecx, [eax+ecx]
		jmp	short loc_62B8A55B
; ---------------------------------------------------------------------------
		align 4

loc_62B8A598:				; CODE XREF: _silc_client_list_free_channels+6Dj
		mov	dword ptr [channel_list_0+14h],	0

loc_62B8A59F:				; CODE XREF: _silc_client_list_free_channels+4Dj
channel_entry =	eax			; SilcChannelEntry
		mov	ecx, [channel_list_0]
		mov	[channel_list_0+8], ecx
		and	edx, 0FFFFFFFDh
		mov	[channel_list_0+10h], dl
		test	ecx, ecx
		jz	short loc_62B8A5F7
		xchg	ax, ax

loc_62B8A5B0:				; CODE XREF: _silc_client_list_free_channels+DDj
		test	byte ptr [channel_list_0+10h], 2
		jz	short loc_62B8A608
		movzx	channel_entry, word ptr	[channel_list_0+0Eh]
		mov	eax, [ecx+eax]

loc_62B8A5BD:				; CODE XREF: _silc_client_list_free_channels+F7j
		mov	[channel_list_0+8], eax
		mov	eax, [channel_list_0]
		test	eax, eax
		jz	short loc_62B8A5E3
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
		cmp	ecx, eax
		jz	loc_62B8A658
		movzx	conn_0,	word ptr [channel_list_0+0Ch]
		jmp	short loc_62B8A5DA
; ---------------------------------------------------------------------------

loc_62B8A5D4:				; CODE XREF: _silc_client_list_free_channels+C9j
		cmp	ecx, esi
		jz	short loc_62B8A614
		mov	eax, esi

loc_62B8A5DA:				; CODE XREF: _silc_client_list_free_channels+BAj
		lea	edx, [eax+edi]
		mov	esi, [edx]
		test	esi, esi
		jnz	short loc_62B8A5D4

loc_62B8A5E3:				; CODE XREF: _silc_client_list_free_channels+ACj
		cmp	ecx, [channel_list_0+4]
		jz	short loc_62B8A641

loc_62B8A5E8:				; CODE XREF: _silc_client_list_free_channels+127j
					; _silc_client_list_free_channels+12Cj
		mov	[esp], ecx
		call	_silc_free
		mov	ecx, [channel_list_0+8]
		test	ecx, ecx
		jnz	short loc_62B8A5B0

loc_62B8A5F7:				; CODE XREF: _silc_client_list_free_channels+94j
channel_entry =	eax			; SilcChannelEntry
		mov	[ebp+client], channel_list_0
		add	esp, 3Ch
		pop	channel_list_0
		pop	esi
		pop	edi
		leave
		jmp	_silc_free
; ---------------------------------------------------------------------------
channel_list_0 = ebx			; SilcDList
channel_entry =	eax			; SilcChannelEntry
		align 4

loc_62B8A608:				; CODE XREF: _silc_client_list_free_channels+9Cj
		movzx	channel_entry, word ptr	[channel_list_0+0Ch]
		mov	eax, [ecx+eax]
		jmp	short loc_62B8A5BD
; ---------------------------------------------------------------------------
		align 4

loc_62B8A614:				; CODE XREF: _silc_client_list_free_channels+BEj
		mov	[ebp+var_2C], edx

loc_62B8A617:				; CODE XREF: _silc_client_list_free_channels+149j
		mov	esi, [ecx+edi]
		mov	edx, [ebp+var_2C]
		mov	[edx], esi
		test	esi, esi
		jz	short loc_62B8A633
		test	byte ptr [channel_list_0+10h], 1
		jz	short loc_62B8A633
		movzx	edi, word ptr [channel_list_0+0Eh]
		mov	edx, [ecx+edi]
		mov	[esi+edi], edx

loc_62B8A633:				; CODE XREF: _silc_client_list_free_channels+109j
					; _silc_client_list_free_channels+10Fj
		cmp	ecx, [channel_list_0+8]
		jz	short loc_62B8A646

loc_62B8A638:				; CODE XREF: _silc_client_list_free_channels+136j
		sub	dword ptr [channel_list_0+10h],	4
		cmp	ecx, [channel_list_0+4]
		jnz	short loc_62B8A5E8

loc_62B8A641:				; CODE XREF: _silc_client_list_free_channels+CEj
		mov	[channel_list_0+4], eax
		jmp	short loc_62B8A5E8
; ---------------------------------------------------------------------------

loc_62B8A646:				; CODE XREF: _silc_client_list_free_channels+11Ej
		mov	esi, [ebp+var_2C]
		mov	edx, [esi]
		mov	[channel_list_0+8], edx
		jmp	short loc_62B8A638
; ---------------------------------------------------------------------------

loc_62B8A650:				; CODE XREF: _silc_client_list_free_channels+14j
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
		add	esp, 3Ch
		pop	channel_list_0
		pop	client_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8A658:				; CODE XREF: _silc_client_list_free_channels+B0j
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
channel_list_0 = ebx			; SilcDList
		movzx	conn_0,	word ptr [channel_list_0+0Ch]
		mov	[ebp+var_2C], channel_list_0
		xor	eax, eax
		jmp	short loc_62B8A617
_silc_client_list_free_channels	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_get_server_cb(SilcClient	client,	SilcClientConnection conn, SilcCommand command,	SilcStatus status, SilcStatus error, void *context, va_list ap)
_silc_client_get_server_cb proc	near	; DATA XREF: _silc_client_get_server_by_id_resolve+15Do
					; _silc_client_get_server_by_id_resolve+20Fo ...

var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_19		= byte ptr -19h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= byte ptr  10h
status		= byte ptr  14h
error		= byte ptr  18h
context		= dword	ptr  1Ch
ap		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	esi, [ebp+conn]
		mov	al, [ebp+status]
		mov	[ebp+var_19], al
		mov	al, [ebp+error]
		test	al, al
		jz	loc_62B8A7E2
conn_0 = esi				; SilcClientConnection
error_0	= eax				; SilcStatus
		mov	ecx, [ebp+context]
		mov	edx, [ecx+4]
		test	edx, edx
		jz	short out
		mov	ecx, [ecx+8]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], 0
		movzx	error_0, al
		mov	[esp+8], error_0
		mov	[esp+4], conn_0
		mov	edi, [ebp+client]
		mov	[esp], edi
		call	edx

out:					; CODE XREF: _silc_client_get_server_cb+25j
					; _silc_client_get_server_cb+1FAj ...
		mov	eax, [ebp+context]
		mov	edi, [eax]
		test	edi, edi
		jz	loc_62B8A78B
		mov	eax, [edi]
		mov	[edi+8], eax
		mov	dl, [edi+10h]
		and	edx, 0FFFFFFFDh
		mov	[edi+10h], dl
		mov	dword ptr [edi+18h], 0
		mov	dword ptr [edi+14h], 0
		xor	eax, eax
		mov	ebx, [ebp+client]
		jmp	short loc_62B8A709
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
		align 10h

loc_62B8A6E0:				; CODE XREF: _silc_client_get_server_cb+B2j
		movzx	ecx, word ptr [edi+0Eh]
		mov	ecx, [eax+ecx]

loc_62B8A6E7:				; CODE XREF: _silc_client_get_server_cb+BBj
		mov	[edi+8], ecx
		mov	[edi+14h], eax
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_62B8A72B
		mov	[esp+8], eax	; server_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_server
		mov	eax, [edi+14h]
		mov	dl, [edi+10h]

loc_62B8A709:				; CODE XREF: _silc_client_get_server_cb+77j
		mov	[edi+18h], eax
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_62B8A724
		test	dl, 2
		jnz	short loc_62B8A6E0
		movzx	ecx, word ptr [edi+0Ch]
		mov	ecx, [eax+ecx]
		jmp	short loc_62B8A6E7
; ---------------------------------------------------------------------------
		align 4

loc_62B8A724:				; CODE XREF: _silc_client_get_server_cb+ADj
		mov	dword ptr [edi+14h], 0

loc_62B8A72B:				; CODE XREF: _silc_client_get_server_cb+8Dj
		mov	client_0, [edi]
		mov	[edi+8], ebx
		and	edx, 0FFFFFFFDh
		mov	[edi+10h], dl
		test	ebx, ebx
		jz	short loc_62B8A783
		xchg	ax, ax

loc_62B8A73C:				; CODE XREF: _silc_client_get_server_cb+11Dj
		test	byte ptr [edi+10h], 2
		jz	short loc_62B8A7A0
conn_0 = esi				; SilcClientConnection
		movzx	eax, word ptr [edi+0Eh]
		mov	eax, [ebx+eax]

loc_62B8A749:				; CODE XREF: _silc_client_get_server_cb+143j
		mov	[edi+8], eax
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_62B8A76F
		cmp	ebx, eax
		jz	loc_62B8A8C1
		movzx	conn_0,	word ptr [edi+0Ch]
		jmp	short loc_62B8A766
; ---------------------------------------------------------------------------

loc_62B8A760:				; CODE XREF: _silc_client_get_server_cb+109j
		cmp	ebx, ecx
		jz	short loc_62B8A7AC
		mov	eax, ecx

loc_62B8A766:				; CODE XREF: _silc_client_get_server_cb+FAj
		lea	edx, [eax+esi]
		mov	ecx, [edx]
		test	ecx, ecx
		jnz	short loc_62B8A760

loc_62B8A76F:				; CODE XREF: _silc_client_get_server_cb+ECj
		cmp	ebx, [edi+4]
		jz	short loc_62B8A7DD

loc_62B8A774:				; CODE XREF: _silc_client_get_server_cb+177j
					; _silc_client_get_server_cb+17Cj
		mov	[esp], ebx
		call	_silc_free
		mov	ebx, [edi+8]
		test	ebx, ebx
		jnz	short loc_62B8A73C

loc_62B8A783:				; CODE XREF: _silc_client_get_server_cb+D4j
		mov	[esp], edi
		call	_silc_free

loc_62B8A78B:				; CODE XREF: _silc_client_get_server_cb+50j
		mov	ebx, [ebp+context]
		mov	[esp], ebx
		call	_silc_free
		xor	eax, eax
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8A7A0:				; CODE XREF: _silc_client_get_server_cb+DCj
conn_0 = esi				; SilcClientConnection
		movzx	eax, word ptr [edi+0Ch]
		mov	eax, [ebx+eax]
		jmp	short loc_62B8A749
; ---------------------------------------------------------------------------
		align 4

loc_62B8A7AC:				; CODE XREF: _silc_client_get_server_cb+FEj
		mov	[ebp+var_2C], edx

loc_62B8A7AF:				; CODE XREF: _silc_client_get_server_cb+266j
		mov	ecx, [ebx+esi]
		mov	edx, [ebp+var_2C]
		mov	[edx], ecx
		test	ecx, ecx
		jz	short loc_62B8A7CB
		test	byte ptr [edi+10h], 1
		jz	short loc_62B8A7CB
		movzx	esi, word ptr [edi+0Eh]
		mov	edx, [ebx+esi]
		mov	[ecx+esi], edx

loc_62B8A7CB:				; CODE XREF: _silc_client_get_server_cb+155j
					; _silc_client_get_server_cb+15Bj
		cmp	ebx, [edi+8]
		jz	loc_62B8A8A4

loc_62B8A7D4:				; CODE XREF: _silc_client_get_server_cb+248j
		sub	dword ptr [edi+10h], 4
		cmp	ebx, [edi+4]
		jnz	short loc_62B8A774

loc_62B8A7DD:				; CODE XREF: _silc_client_get_server_cb+10Ej
		mov	[edi+4], eax
		jmp	short loc_62B8A774
; ---------------------------------------------------------------------------

loc_62B8A7E2:				; CODE XREF: _silc_client_get_server_cb+17j
conn_0 = esi				; SilcClientConnection
error_0	= eax				; SilcStatus
		mov	error_0, [ebp+context]
		mov	edi, [eax+4]
		test	edi, edi
		jz	short loc_62B8A850
		mov	eax, [ebp+ap]
		mov	ecx, [eax]
server = ecx				; SilcServerEntry
		mov	eax, [server+30h]
		mov	eax, [server+30h]
		inc	eax
		mov	[server+30h], eax
		mov	edx, [ebp+context]
		mov	edi, [edx]
		mov	dword ptr [esp], 0Ch
		mov	[ebp+var_24], server
		call	_silc_malloc
		test	eax, eax
		mov	ecx, [ebp+var_24]
		jz	short loc_62B8A84A
		mov	[eax], ecx
server = ecx				; SilcServerEntry
		mov	ebx, [edi]
		test	ebx, ebx
		jz	loc_62B8A8DE
		movzx	edx, word ptr [edi+0Ch]
		mov	[ebp+var_20], edx
		mov	ebx, [edi+4]
		mov	[ebx+edx], eax

loc_62B8A82F:				; CODE XREF: _silc_client_get_server_cb+283j
		test	byte ptr [edi+10h], 1
		jnz	loc_62B8A8CF

loc_62B8A839:				; CODE XREF: _silc_client_get_server_cb+275j
		mov	[edi+4], eax
		mov	edx, [ebp+var_20]
		mov	dword ptr [eax+edx], 0
		add	dword ptr [edi+10h], 4

loc_62B8A84A:				; CODE XREF: _silc_client_get_server_cb+1B0j
		mov	word ptr [server+2Ch], 0

loc_62B8A850:				; CODE XREF: _silc_client_get_server_cb+186j
		cmp	[ebp+var_19], 0
		jnz	short loc_62B8A8B1

loc_62B8A856:				; CODE XREF: _silc_client_get_server_cb+251j
		mov	server,	[ebp+context]
		mov	edx, [ecx+4]
		test	edx, edx
		jz	out
		mov	eax, [ecx]
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ecx+8]
		mov	[esp+10h], eax
		mov	eax, [ecx]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn_0
		mov	ebx, [ebp+client]
		mov	[esp], ebx
		call	dword ptr [ecx+4]
		jmp	out
; ---------------------------------------------------------------------------

loc_62B8A8A4:				; CODE XREF: _silc_client_get_server_cb+16Aj
		mov	ecx, [ebp+var_2C]
		mov	edx, [ecx]
		mov	[edi+8], edx
		jmp	loc_62B8A7D4
; ---------------------------------------------------------------------------

loc_62B8A8B1:				; CODE XREF: _silc_client_get_server_cb+1F0j
conn_0 = esi				; SilcClientConnection
server = ecx				; SilcServerEntry
		cmp	[ebp+var_19], 3
		jz	short loc_62B8A856
		mov	al, 1
		add	esp, 4Ch
		pop	ebx
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8A8C1:				; CODE XREF: _silc_client_get_server_cb+F0j
conn_0 = esi				; SilcClientConnection
		movzx	conn_0,	word ptr [edi+0Ch]
		mov	[ebp+var_2C], edi
		xor	eax, eax
		jmp	loc_62B8A7AF
; ---------------------------------------------------------------------------

loc_62B8A8CF:				; CODE XREF: _silc_client_get_server_cb+1CFj
conn_0 = esi				; SilcClientConnection
server = ecx				; SilcServerEntry
		movzx	edx, word ptr [edi+0Eh]
		mov	ebx, [edi+4]
		mov	[eax+edx], ebx
		jmp	loc_62B8A839
; ---------------------------------------------------------------------------

loc_62B8A8DE:				; CODE XREF: _silc_client_get_server_cb+1B8j
		mov	[edi], eax
		movzx	ebx, word ptr [edi+0Ch]
		mov	[ebp+var_20], ebx
		jmp	loc_62B8A82F
_silc_client_get_server_cb endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_get_channel_cb(SilcClient client, SilcClientConnection conn, SilcCommand	command, SilcStatus status, SilcStatus error, void *context, va_list ap)
_silc_client_get_channel_cb proc near	; DATA XREF: _silc_client_get_channel_resolve+EFo
					; _silc_client_get_channel_by_id_resolve+F1o ...

var_2C		= dword	ptr -2Ch
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= byte ptr  10h
status		= byte ptr  14h
error		= byte ptr  18h
context		= dword	ptr  1Ch
ap		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	esi, [ebp+conn]
		mov	cl, [ebp+status]
		mov	al, [ebp+error]
		test	al, al
		jz	loc_62B8AA66
conn_0 = esi				; SilcClientConnection
status_0 = ecx				; SilcStatus
error_0	= eax				; SilcStatus
		mov	status_0, [ebp+context]
		mov	edx, [ecx+4]
		test	edx, edx
		jz	short out
		mov	ecx, [ecx+8]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], 0
		movzx	error_0, al
		mov	[esp+8], error_0
		mov	[esp+4], conn_0
		mov	edi, [ebp+client]
		mov	[esp], edi
		call	edx

out:					; CODE XREF: _silc_client_get_channel_cb+22j
					; _silc_client_get_channel_cb+203j ...
		mov	edx, [ebp+context]
		mov	edi, [edx]
		test	edi, edi
		jz	loc_62B8AA0F
		mov	eax, [edi]
		mov	[edi+8], eax
		mov	dl, [edi+10h]
		and	edx, 0FFFFFFFDh
		mov	[edi+10h], dl
		mov	dword ptr [edi+18h], 0
		mov	dword ptr [edi+14h], 0
		xor	eax, eax
		mov	ebx, [ebp+client]
		jmp	short loc_62B8A98D
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
		align 4

loc_62B8A964:				; CODE XREF: _silc_client_get_channel_cb+AEj
		movzx	ecx, word ptr [edi+0Eh]
		mov	ecx, [eax+ecx]

loc_62B8A96B:				; CODE XREF: _silc_client_get_channel_cb+B7j
		mov	[edi+8], ecx
		mov	[edi+14h], eax
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_62B8A9AF
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_channel
		mov	eax, [edi+14h]
		mov	dl, [edi+10h]

loc_62B8A98D:				; CODE XREF: _silc_client_get_channel_cb+74j
		mov	[edi+18h], eax
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_62B8A9A8
		test	dl, 2
		jnz	short loc_62B8A964
		movzx	ecx, word ptr [edi+0Ch]
		mov	ecx, [eax+ecx]
		jmp	short loc_62B8A96B
; ---------------------------------------------------------------------------
		align 4

loc_62B8A9A8:				; CODE XREF: _silc_client_get_channel_cb+A9j
		mov	dword ptr [edi+14h], 0

loc_62B8A9AF:				; CODE XREF: _silc_client_get_channel_cb+89j
		mov	client_0, [edi]
		mov	[edi+8], ebx
		and	edx, 0FFFFFFFDh
		mov	[edi+10h], dl
		test	ebx, ebx
		jz	short loc_62B8AA07
		xchg	ax, ax

loc_62B8A9C0:				; CODE XREF: _silc_client_get_channel_cb+119j
		test	byte ptr [edi+10h], 2
		jz	short loc_62B8AA24
conn_0 = esi				; SilcClientConnection
		movzx	eax, word ptr [edi+0Eh]
		mov	eax, [ebx+eax]

loc_62B8A9CD:				; CODE XREF: _silc_client_get_channel_cb+13Fj
		mov	[edi+8], eax
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_62B8A9F3
		cmp	ebx, eax
		jz	loc_62B8AB51
		movzx	conn_0,	word ptr [edi+0Ch]
		jmp	short loc_62B8A9EA
; ---------------------------------------------------------------------------

loc_62B8A9E4:				; CODE XREF: _silc_client_get_channel_cb+105j
		cmp	ebx, ecx
		jz	short loc_62B8AA30
		mov	eax, ecx

loc_62B8A9EA:				; CODE XREF: _silc_client_get_channel_cb+F6j
		lea	edx, [eax+esi]
		mov	ecx, [edx]
		test	ecx, ecx
		jnz	short loc_62B8A9E4

loc_62B8A9F3:				; CODE XREF: _silc_client_get_channel_cb+E8j
		cmp	ebx, [edi+4]
		jz	short loc_62B8AA61

loc_62B8A9F8:				; CODE XREF: _silc_client_get_channel_cb+173j
					; _silc_client_get_channel_cb+178j
		mov	[esp], ebx
		call	_silc_free
		mov	ebx, [edi+8]
		test	ebx, ebx
		jnz	short loc_62B8A9C0

loc_62B8AA07:				; CODE XREF: _silc_client_get_channel_cb+D0j
		mov	[esp], edi
		call	_silc_free

loc_62B8AA0F:				; CODE XREF: _silc_client_get_channel_cb+4Dj
		mov	ebx, [ebp+context]
		mov	[esp], ebx
		call	_silc_free
		xor	eax, eax
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8AA24:				; CODE XREF: _silc_client_get_channel_cb+D8j
conn_0 = esi				; SilcClientConnection
		movzx	eax, word ptr [edi+0Ch]
		mov	eax, [ebx+eax]
		jmp	short loc_62B8A9CD
; ---------------------------------------------------------------------------
		align 10h

loc_62B8AA30:				; CODE XREF: _silc_client_get_channel_cb+FAj
		mov	[ebp+var_2C], edx

loc_62B8AA33:				; CODE XREF: _silc_client_get_channel_cb+26Ej
		mov	ecx, [ebx+esi]
		mov	esi, [ebp+var_2C]
		mov	[esi], ecx
		test	ecx, ecx
		jz	short loc_62B8AA4F
		test	byte ptr [edi+10h], 1
		jz	short loc_62B8AA4F
		movzx	edx, word ptr [edi+0Eh]
		mov	esi, [ebx+edx]
		mov	[ecx+edx], esi

loc_62B8AA4F:				; CODE XREF: _silc_client_get_channel_cb+151j
					; _silc_client_get_channel_cb+157j
		cmp	ebx, [edi+8]
		jz	loc_62B8AB35

loc_62B8AA58:				; CODE XREF: _silc_client_get_channel_cb+251j
		sub	dword ptr [edi+10h], 4
		cmp	ebx, [edi+4]
		jnz	short loc_62B8A9F8

loc_62B8AA61:				; CODE XREF: _silc_client_get_channel_cb+10Aj
		mov	[edi+4], eax
		jmp	short loc_62B8A9F8
; ---------------------------------------------------------------------------

loc_62B8AA66:				; CODE XREF: _silc_client_get_channel_cb+14j
conn_0 = esi				; SilcClientConnection
status_0 = ecx				; SilcStatus
error_0	= eax				; SilcStatus
		mov	error_0, [ebp+context]
		mov	ebx, [eax+4]
		test	ebx, ebx
		jz	short loc_62B8AAE3
		mov	eax, [ebp+ap]
		mov	edx, [eax]
entry =	edx				; SilcChannelEntry
		mov	eax, [entry+174h]
		mov	eax, [entry+174h]
		inc	eax
		mov	[entry+174h], eax
		mov	ebx, [ebp+context]
		mov	edi, [ebx]
		mov	dword ptr [esp], 0Ch
		mov	[ebp+var_20], entry
		mov	[ebp+var_24], cl
		call	_silc_malloc
		test	eax, eax
		mov	edx, [ebp+var_20]
		mov	cl, [ebp+var_24]
		jz	short loc_62B8AAE3
		mov	[eax], edx
entry =	edx				; SilcChannelEntry
		mov	entry, [edi]
		test	edx, edx
		jz	loc_62B8AB5F
		movzx	ebx, word ptr [edi+0Ch]
		mov	[ebp+var_1C], ebx
		mov	edx, [edi+4]
		mov	[edx+ebx], eax

loc_62B8AAC2:				; CODE XREF: _silc_client_get_channel_cb+27Cj
		test	byte ptr [edi+10h], 1
		jz	short loc_62B8AAD2
		movzx	ebx, word ptr [edi+0Eh]
		mov	edx, [edi+4]
		mov	[eax+ebx], edx

loc_62B8AAD2:				; CODE XREF: _silc_client_get_channel_cb+1DAj
		mov	[edi+4], eax
		mov	ebx, [ebp+var_1C]
		mov	dword ptr [eax+ebx], 0
		add	dword ptr [edi+10h], 4

loc_62B8AAE3:				; CODE XREF: _silc_client_get_channel_cb+182j
					; _silc_client_get_channel_cb+1BBj
		test	cl, cl
		jnz	short loc_62B8AB42

loc_62B8AAE7:				; CODE XREF: _silc_client_get_channel_cb+259j
status_0 = ecx				; SilcStatus
		mov	edi, [ebp+context]
		mov	eax, [edi+4]
		test	eax, eax
		jz	out
		mov	eax, [edi]
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [edi+8]
		mov	[esp+10h], eax
		mov	eax, [edi]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn_0
		mov	eax, [ebp+client]
		mov	[esp], eax
		call	dword ptr [edi+4]
		jmp	out
; ---------------------------------------------------------------------------

loc_62B8AB35:				; CODE XREF: _silc_client_get_channel_cb+166j
		mov	ecx, [ebp+var_2C]
		mov	edx, [ecx]
		mov	[edi+8], edx
		jmp	loc_62B8AA58
; ---------------------------------------------------------------------------

loc_62B8AB42:				; CODE XREF: _silc_client_get_channel_cb+1F9j
conn_0 = esi				; SilcClientConnection
status_0 = ecx				; SilcStatus
		cmp	cl, 3
		jz	short loc_62B8AAE7
		mov	al, 1
		add	esp, 4Ch
		pop	ebx
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8AB51:				; CODE XREF: _silc_client_get_channel_cb+ECj
conn_0 = esi				; SilcClientConnection
		movzx	conn_0,	word ptr [edi+0Ch]
		mov	[ebp+var_2C], edi
		xor	eax, eax
		jmp	loc_62B8AA33
; ---------------------------------------------------------------------------

loc_62B8AB5F:				; CODE XREF: _silc_client_get_channel_cb+1C3j
conn_0 = esi				; SilcClientConnection
		mov	[edi], eax
		movzx	edx, word ptr [edi+0Ch]
		mov	[ebp+var_1C], edx
		jmp	loc_62B8AAC2
_silc_client_get_channel_cb endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_get_clients_cb(SilcClient client, SilcClientConnection conn, SilcCommand	command, SilcStatus status, SilcStatus error, void *context, va_list ap)
_silc_client_get_clients_cb proc near	; DATA XREF: _silc_client_get_clients_i+25Co
					; _silc_client_get_clients_i+38Ao ...

var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_19		= byte ptr -19h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= byte ptr  10h
status		= byte ptr  14h
error		= byte ptr  18h
context		= dword	ptr  1Ch
ap		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	esi, [ebp+conn]
		mov	al, [ebp+status]
		mov	[ebp+var_19], al
		mov	al, [ebp+error]
		test	al, al
		jz	loc_62B8AD1A
conn_0 = esi				; SilcClientConnection
error_0	= eax				; SilcStatus
		mov	ecx, [ebp+context]
		mov	edx, [ecx+0Ch]
		test	edx, edx
		jz	short loc_62B8ABB9
		mov	word ptr [edx+400h], 0
		mov	[esp+8], edx	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	ebx, [ebp+client]
		mov	[esp], ebx	; client
		mov	byte ptr [ebp+var_24], al
		call	_silc_client_unref_client
		mov	al, byte ptr [ebp+var_24]

loc_62B8ABB9:				; CODE XREF: _silc_client_get_clients_cb+25j
		mov	edi, [ebp+context]
		mov	edx, [edi+4]
		test	edx, edx
		jz	short out
		mov	ecx, [edi+8]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], 0
		movzx	eax, al
error_0	= eax				; SilcStatus
		mov	[esp+8], error_0
		mov	[esp+4], conn_0
		mov	error_0, [ebp+client]
		mov	[esp], eax
		call	edx

out:					; CODE XREF: _silc_client_get_clients_cb+51j
					; _silc_client_get_clients_cb+233j ...
		mov	edx, [ebp+context]
		mov	edi, [edx]
		test	edi, edi
		jz	loc_62B8ACC3
		mov	eax, [edi]
		mov	[edi+8], eax
		mov	dl, [edi+10h]
		and	edx, 0FFFFFFFDh
		mov	[edi+10h], dl
		mov	dword ptr [edi+18h], 0
		mov	dword ptr [edi+14h], 0
		xor	eax, eax
		mov	ebx, [ebp+client]
		jmp	short loc_62B8AC41
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
		align 4

loc_62B8AC18:				; CODE XREF: _silc_client_get_clients_cb+DEj
		movzx	ecx, word ptr [edi+0Eh]
		mov	ecx, [eax+ecx]

loc_62B8AC1F:				; CODE XREF: _silc_client_get_clients_cb+E7j
		mov	[edi+8], ecx
		mov	[edi+14h], eax
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_62B8AC63
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_client
		mov	eax, [edi+14h]
		mov	dl, [edi+10h]

loc_62B8AC41:				; CODE XREF: _silc_client_get_clients_cb+A3j
		mov	[edi+18h], eax
		mov	eax, [edi+8]
		test	eax, eax
		jz	short loc_62B8AC5C
		test	dl, 2
		jnz	short loc_62B8AC18
		movzx	ecx, word ptr [edi+0Ch]
		mov	ecx, [eax+ecx]
		jmp	short loc_62B8AC1F
; ---------------------------------------------------------------------------
		align 4

loc_62B8AC5C:				; CODE XREF: _silc_client_get_clients_cb+D9j
		mov	dword ptr [edi+14h], 0

loc_62B8AC63:				; CODE XREF: _silc_client_get_clients_cb+B9j
		mov	client_0, [edi]
		mov	[edi+8], ebx
		and	edx, 0FFFFFFFDh
		mov	[edi+10h], dl
		test	ebx, ebx
		jz	short loc_62B8ACBB
		xchg	ax, ax

loc_62B8AC74:				; CODE XREF: _silc_client_get_clients_cb+149j
		test	byte ptr [edi+10h], 2
		jz	short loc_62B8ACD8
conn_0 = esi				; SilcClientConnection
		movzx	eax, word ptr [edi+0Eh]
		mov	eax, [ebx+eax]

loc_62B8AC81:				; CODE XREF: _silc_client_get_clients_cb+16Fj
		mov	[edi+8], eax
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_62B8ACA7
		cmp	ebx, eax
		jz	loc_62B8AE30
		movzx	conn_0,	word ptr [edi+0Ch]
		jmp	short loc_62B8AC9E
; ---------------------------------------------------------------------------

loc_62B8AC98:				; CODE XREF: _silc_client_get_clients_cb+135j
		cmp	ebx, ecx
		jz	short loc_62B8ACE4
		mov	eax, ecx

loc_62B8AC9E:				; CODE XREF: _silc_client_get_clients_cb+126j
		lea	edx, [eax+esi]
		mov	ecx, [edx]
		test	ecx, ecx
		jnz	short loc_62B8AC98

loc_62B8ACA7:				; CODE XREF: _silc_client_get_clients_cb+118j
		cmp	ebx, [edi+4]
		jz	short loc_62B8AD15

loc_62B8ACAC:				; CODE XREF: _silc_client_get_clients_cb+1A3j
					; _silc_client_get_clients_cb+1A8j
		mov	[esp], ebx
		call	_silc_free
		mov	ebx, [edi+8]
		test	ebx, ebx
		jnz	short loc_62B8AC74

loc_62B8ACBB:				; CODE XREF: _silc_client_get_clients_cb+100j
		mov	[esp], edi
		call	_silc_free

loc_62B8ACC3:				; CODE XREF: _silc_client_get_clients_cb+7Cj
		mov	ebx, [ebp+context]
		mov	[esp], ebx
		call	_silc_free
		xor	eax, eax
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8ACD8:				; CODE XREF: _silc_client_get_clients_cb+108j
conn_0 = esi				; SilcClientConnection
		movzx	eax, word ptr [edi+0Ch]
		mov	eax, [ebx+eax]
		jmp	short loc_62B8AC81
; ---------------------------------------------------------------------------
		align 4

loc_62B8ACE4:				; CODE XREF: _silc_client_get_clients_cb+12Aj
		mov	[ebp+var_2C], edx

loc_62B8ACE7:				; CODE XREF: _silc_client_get_clients_cb+2C9j
		mov	ecx, [ebx+esi]
		mov	esi, [ebp+var_2C]
		mov	[esi], ecx
		test	ecx, ecx
		jz	short loc_62B8AD03
		test	byte ptr [edi+10h], 1
		jz	short loc_62B8AD03
		movzx	edx, word ptr [edi+0Eh]
		mov	esi, [ebx+edx]
		mov	[ecx+edx], esi

loc_62B8AD03:				; CODE XREF: _silc_client_get_clients_cb+181j
					; _silc_client_get_clients_cb+187j
		cmp	ebx, [edi+8]
		jz	loc_62B8AE0F

loc_62B8AD0C:				; CODE XREF: _silc_client_get_clients_cb+2A7j
		sub	dword ptr [edi+10h], 4
		cmp	ebx, [edi+4]
		jnz	short loc_62B8ACAC

loc_62B8AD15:				; CODE XREF: _silc_client_get_clients_cb+13Aj
		mov	[edi+4], eax
		jmp	short loc_62B8ACAC
; ---------------------------------------------------------------------------

loc_62B8AD1A:				; CODE XREF: _silc_client_get_clients_cb+17j
conn_0 = esi				; SilcClientConnection
error_0	= eax				; SilcStatus
		mov	edx, [ebp+context]
		mov	ecx, [edx+4]
		test	ecx, ecx
		jz	short loc_62B8AD91
		mov	error_0, [ebp+ap]
		mov	ecx, [eax]
client_entry = ecx			; SilcClientEntry
		mov	eax, [client_entry+3F8h]
		mov	eax, [client_entry+3F8h]
		inc	eax
		mov	[client_entry+3F8h], eax
		mov	edi, [edx]
		mov	dword ptr [esp], 0Ch
		mov	[ebp+var_24], client_entry
		call	_silc_malloc
		test	eax, eax
		mov	ecx, [ebp+var_24]
		jz	short loc_62B8AD88
		mov	[eax], ecx
client_entry = ecx			; SilcClientEntry
		mov	edx, [edi]
		test	edx, edx
		jz	loc_62B8AE4D
		movzx	edx, word ptr [edi+0Ch]
		mov	[ebp+var_20], edx
		mov	ebx, [edi+4]
		mov	[ebx+edx], eax

loc_62B8AD6D:				; CODE XREF: _silc_client_get_clients_cb+2E6j
		test	byte ptr [edi+10h], 1
		jnz	loc_62B8AE3E

loc_62B8AD77:				; CODE XREF: _silc_client_get_clients_cb+2D8j
		mov	[edi+4], eax
		mov	edx, [ebp+var_20]
		mov	dword ptr [eax+edx], 0
		add	dword ptr [edi+10h], 4

loc_62B8AD88:				; CODE XREF: _silc_client_get_clients_cb+1E2j
		mov	word ptr [client_entry+400h], 0

loc_62B8AD91:				; CODE XREF: _silc_client_get_clients_cb+1B2j
		cmp	[ebp+var_19], 0
		jnz	loc_62B8AE1C

loc_62B8AD9B:				; CODE XREF: _silc_client_get_clients_cb+2B0j
		mov	client_entry, [ebp+context]
		mov	edi, [ecx+4]
		test	edi, edi
		jz	out
		mov	eax, [ecx+0Ch]
		test	eax, eax
		jz	short loc_62B8ADCC
		mov	word ptr [eax+400h], 0
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	ebx, [ebp+client]
		mov	[esp], ebx	; client
		call	_silc_client_unref_client

loc_62B8ADCC:				; CODE XREF: _silc_client_get_clients_cb+23Ej
		mov	edi, [ebp+context]
		mov	eax, [edi]
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [edi+8]
		mov	[esp+10h], eax
		mov	eax, [edi]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn_0
		mov	eax, [ebp+client]
		mov	[esp], eax
		call	dword ptr [edi+4]
		jmp	out
; ---------------------------------------------------------------------------

loc_62B8AE0F:				; CODE XREF: _silc_client_get_clients_cb+196j
		mov	ecx, [ebp+var_2C]
		mov	edx, [ecx]
		mov	[edi+8], edx
		jmp	loc_62B8AD0C
; ---------------------------------------------------------------------------

loc_62B8AE1C:				; CODE XREF: _silc_client_get_clients_cb+225j
conn_0 = esi				; SilcClientConnection
client_entry = ecx			; SilcClientEntry
		cmp	[ebp+var_19], 3
		jz	loc_62B8AD9B
		mov	al, 1
		add	esp, 4Ch
		pop	ebx
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8AE30:				; CODE XREF: _silc_client_get_clients_cb+11Cj
conn_0 = esi				; SilcClientConnection
		movzx	conn_0,	word ptr [edi+0Ch]
		mov	[ebp+var_2C], edi
		xor	eax, eax
		jmp	loc_62B8ACE7
; ---------------------------------------------------------------------------

loc_62B8AE3E:				; CODE XREF: _silc_client_get_clients_cb+201j
conn_0 = esi				; SilcClientConnection
client_entry = ecx			; SilcClientEntry
		movzx	edx, word ptr [edi+0Eh]
		mov	ebx, [edi+4]
		mov	[eax+edx], ebx
		jmp	loc_62B8AD77
; ---------------------------------------------------------------------------

loc_62B8AE4D:				; CODE XREF: _silc_client_get_clients_cb+1EAj
		mov	[edi], eax
		movzx	ebx, word ptr [edi+0Ch]
		mov	[ebp+var_20], ebx
		jmp	loc_62B8AD6D
_silc_client_get_clients_cb endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_get_clients_list_cb(SilcClient client, SilcClientConnection conn, SilcCommand command, SilcStatus status, SilcStatus error, void	*context, va_list ap)
_silc_client_get_clients_list_cb proc near
					; CODE XREF: _silc_client_get_clients_by_list+400p
					; DATA XREF: _silc_client_get_clients_by_list+355o

var_6C		= dword	ptr -6Ch
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
id		= SilcID ptr -3Ch
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= byte ptr  10h
status		= byte ptr  14h
error		= byte ptr  18h
context		= dword	ptr  1Ch
ap		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 8Ch
		mov	edi, [ebp+conn]
		mov	al, [ebp+status]
		lea	edx, [eax-1]
		cmp	dl, 8
		ja	short loc_62B8AE88
conn_0 = edi				; SilcClientConnection
status_0 = eax				; SilcStatus
		cmp	al, 3
		jz	short loc_62B8AE88
		mov	al, 1
		add	esp, 8Ch
		pop	ebx
		pop	esi
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = edi				; SilcClientConnection
status_0 = eax				; SilcStatus
		align 4

loc_62B8AE88:				; CODE XREF: _silc_client_get_clients_list_cb+18j
					; _silc_client_get_clients_list_cb+1Cj
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
		mov	ebx, eax
clients	= ebx				; SilcDList
		test	eax, eax
		jz	loc_62B8B1FF
clients	= eax				; SilcDList
		mov	dword ptr [clients+18h], 0
		mov	dword ptr [clients+14h], 0
		mov	clients, [clients+10h]
clients	= ebx				; SilcDList
		and	eax, 3
		mov	[clients+10h], eax
		mov	word ptr [clients+0Ch],	4
		mov	word ptr [clients+0Eh],	8
		mov	dl, 1
		mov	[clients+10h], dl
		mov	dword ptr [clients+8], 0
		mov	dword ptr [clients+4], 0
		mov	dword ptr [clients], 0
		mov	eax, [ebp+context]
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jz	loc_62B8B23C
		xor	edx, edx
c = edx					; int
		mov	ecx, [ebp+context]
		mov	eax, [ecx+8]
		mov	[ebp+var_4C], conn_0
		mov	conn_0,	c
		jmp	short loc_62B8AF29
; ---------------------------------------------------------------------------
c = edi					; int
		align 4

loc_62B8AEF8:				; CODE XREF: _silc_client_get_clients_list_cb+103j
					; _silc_client_get_clients_list_cb+10Aj ...
		mov	edx, [ebp+context]
		mov	eax, [edx+8]
		mov	edx, [eax+4]
		mov	ecx, [eax+8]
		sub	ecx, edx
		cmp	esi, ecx
		ja	out
		lea	esi, [edx+esi]
		mov	[eax+4], esi
		test	edx, edx
		jz	out
		inc	c
		mov	ecx, [ebp+context]
		cmp	[ecx+0Ch], c
		jbe	loc_62B8B037

loc_62B8AF29:				; CODE XREF: _silc_client_get_clients_list_cb+99j
		mov	eax, [eax+4]
		movzx	esi, byte ptr [eax+2]
idp_len	= esi				; SilcUInt16
		shl	idp_len, 8
		movzx	edx, byte ptr [eax+3]
		or	idp_len, edx
		add	idp_len, 4
		movzx	esi, si
		lea	edx, [ebp+id]
		mov	[esp+8], edx
		mov	[esp+4], esi
		mov	[esp], eax
		call	_silc_id_payload_parse_id
		test	al, al
		jz	out
		mov	eax, [ebp+client]
		test	eax, eax
		jz	short loc_62B8AEF8
		mov	ecx, [ebp+var_4C]
		test	ecx, ecx
		jz	short loc_62B8AEF8
		mov	ecx, [ebp+var_4C]
		mov	eax, [ecx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+var_1C]
		mov	[esp+8], eax
		lea	edx, [ebp+id]
		mov	[esp+4], edx
		mov	ecx, [ebp+var_4C]
		mov	eax, [ecx+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_find_by_id_one
		test	al, al
		jz	loc_62B8B1E6
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+0Ch]
client_entry = edx			; SilcClientEntry
		mov	eax, [client_entry+3F8h]
		mov	eax, [client_entry+3F8h]
		inc	eax
		mov	[client_entry+3F8h], eax
		mov	ecx, [ebp+var_4C]
		mov	eax, [ecx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		mov	[ebp+var_50], client_entry
		call	_silc_mutex_unlock
		mov	dword ptr [esp], 0Ch
		call	_silc_malloc
		test	eax, eax
		mov	edx, [ebp+var_50]
		jz	loc_62B8AEF8
		mov	[eax], edx
client_entry = edx			; SilcClientEntry
		mov	client_entry, [clients]
		test	edx, edx
		jz	short loc_62B8B02C
		movzx	ecx, word ptr [clients+0Ch]
		mov	[ebp+var_6C], ecx
		mov	ecx, [clients+4]
		mov	edx, [ebp+var_6C]
		mov	[ecx+edx], eax

loc_62B8B005:				; CODE XREF: _silc_client_get_clients_list_cb+1D9j
		test	byte ptr [clients+10h],	1
		jz	short loc_62B8B015
		movzx	ecx, word ptr [clients+0Eh]
		mov	edx, [clients+4]
		mov	[eax+ecx], edx

loc_62B8B015:				; CODE XREF: _silc_client_get_clients_list_cb+1ADj
		mov	[clients+4], eax
		mov	ecx, [ebp+var_6C]
		mov	dword ptr [eax+ecx], 0
		add	dword ptr [clients+10h], 4
		jmp	loc_62B8AEF8
; ---------------------------------------------------------------------------
		align 4

loc_62B8B02C:				; CODE XREF: _silc_client_get_clients_list_cb+197j
		mov	[clients], eax
		movzx	edx, word ptr [clients+0Ch]
		mov	[ebp+var_6C], edx
		jmp	short loc_62B8B005
; ---------------------------------------------------------------------------

loc_62B8B037:				; CODE XREF: _silc_client_get_clients_list_cb+C7j
		mov	c, [ebp+var_4C]
conn_0 = edi				; SilcClientConnection
		mov	eax, [clients]
		mov	dl, [clients+10h]

loc_62B8B03F:				; CODE XREF: _silc_client_get_clients_list_cb+3E2j
		mov	[clients+8], eax
		and	edx, 0FFFFFFFDh
		mov	[clients+10h], dl
		mov	dword ptr [clients+18h], 0
		mov	dword ptr [clients+14h], 0
		mov	esi, [ebp+context]
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_62B8B081
		mov	edx, [esi+4]
		mov	[esp+10h], edx
		mov	[esp+0Ch], clients
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn_0
		mov	edx, [ebp+client]
		mov	[esp], edx
		call	eax
		mov	dl, [clients+10h]

loc_62B8B081:				; CODE XREF: _silc_client_get_clients_list_cb+201j
					; _silc_client_get_clients_list_cb+3DBj
		mov	eax, [clients]
		mov	[clients+8], eax
		and	edx, 0FFFFFFFDh
		mov	[clients+10h], dl
		mov	dword ptr [clients+18h], 0
		mov	dword ptr [clients+14h], 0
		xor	eax, eax
		mov	esi, [ebp+client]
		jmp	short loc_62B8B0CD
; ---------------------------------------------------------------------------
client_0 = esi				; SilcClient
		align 4

loc_62B8B0A4:				; CODE XREF: _silc_client_get_clients_list_cb+27Ej
		movzx	ecx, word ptr [clients+0Eh]
		mov	ecx, [eax+ecx]

loc_62B8B0AB:				; CODE XREF: _silc_client_get_clients_list_cb+287j
		mov	[clients+8], ecx
		mov	[clients+14h], eax
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_62B8B0EF
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_client
		mov	eax, [clients+14h]
		mov	dl, [clients+10h]

loc_62B8B0CD:				; CODE XREF: _silc_client_get_clients_list_cb+243j
		mov	[clients+18h], eax
		mov	eax, [clients+8]
		test	eax, eax
		jz	short loc_62B8B0E8
		test	dl, 2
		jnz	short loc_62B8B0A4
		movzx	ecx, word ptr [clients+0Ch]
		mov	ecx, [eax+ecx]
		jmp	short loc_62B8B0AB
; ---------------------------------------------------------------------------
		align 4

loc_62B8B0E8:				; CODE XREF: _silc_client_get_clients_list_cb+279j
		mov	dword ptr [clients+14h], 0

loc_62B8B0EF:				; CODE XREF: _silc_client_get_clients_list_cb+259j
		mov	client_0, [clients]
		mov	[clients+8], esi
		and	edx, 0FFFFFFFDh
		mov	[clients+10h], dl
		test	esi, esi
		jz	short loc_62B8B14F
		xchg	ax, ax

loc_62B8B100:				; CODE XREF: _silc_client_get_clients_list_cb+2F1j
		test	byte ptr [clients+10h],	2
		jz	loc_62B8B18C
conn_0 = edi				; SilcClientConnection
		movzx	eax, word ptr [clients+0Eh]
		mov	eax, [esi+eax]

loc_62B8B111:				; CODE XREF: _silc_client_get_clients_list_cb+337j
		mov	[clients+8], eax
		mov	eax, [clients]
		test	eax, eax
		jz	short loc_62B8B137
		cmp	esi, eax
		jz	loc_62B8B1DB
		movzx	conn_0,	word ptr [clients+0Ch]
		jmp	short loc_62B8B12E
; ---------------------------------------------------------------------------

loc_62B8B128:				; CODE XREF: _silc_client_get_clients_list_cb+2D9j
		cmp	esi, ecx
		jz	short loc_62B8B198
		mov	eax, ecx

loc_62B8B12E:				; CODE XREF: _silc_client_get_clients_list_cb+2CAj
		lea	edx, [eax+edi]
		mov	ecx, [edx]
		test	ecx, ecx
		jnz	short loc_62B8B128

loc_62B8B137:				; CODE XREF: _silc_client_get_clients_list_cb+2BCj
		cmp	esi, [clients+4]
		jz	loc_62B8B1C9

loc_62B8B140:				; CODE XREF: _silc_client_get_clients_list_cb+367j
					; _silc_client_get_clients_list_cb+370j
		mov	[esp], esi
		call	_silc_free
		mov	esi, [clients+8]
		test	esi, esi
		jnz	short loc_62B8B100

loc_62B8B14F:				; CODE XREF: _silc_client_get_clients_list_cb+2A0j
		mov	[esp], clients
		call	_silc_free

loc_62B8B157:				; CODE XREF: _silc_client_get_clients_list_cb+3D2j
		mov	esi, [ebp+context]
		mov	clients, [esi+8]
		test	ebx, ebx
		jz	short loc_62B8B173
		mov	eax, [ebx]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free

loc_62B8B173:				; CODE XREF: _silc_client_get_clients_list_cb+303j
		mov	edi, [ebp+context]
		mov	[esp], edi
		call	_silc_free
		xor	eax, eax
		add	esp, 8Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = edi				; SilcClientConnection
clients	= ebx				; SilcDList
		align 4

loc_62B8B18C:				; CODE XREF: _silc_client_get_clients_list_cb+2A8j
		movzx	eax, word ptr [clients+0Ch]
		mov	eax, [esi+eax]
		jmp	loc_62B8B111
; ---------------------------------------------------------------------------

loc_62B8B198:				; CODE XREF: _silc_client_get_clients_list_cb+2CEj
		mov	[ebp+var_5C], edx

loc_62B8B19B:				; CODE XREF: _silc_client_get_clients_list_cb+388j
		mov	ecx, [esi+edi]
		mov	edi, [ebp+var_5C]
		mov	[edi], ecx
		test	ecx, ecx
		jz	short loc_62B8B1B7
		test	byte ptr [clients+10h],	1
		jz	short loc_62B8B1B7
		movzx	edx, word ptr [clients+0Eh]
		mov	edi, [esi+edx]
		mov	[ecx+edx], edi

loc_62B8B1B7:				; CODE XREF: _silc_client_get_clients_list_cb+349j
					; _silc_client_get_clients_list_cb+34Fj
		cmp	esi, [clients+8]
		jz	short loc_62B8B1D1

loc_62B8B1BC:				; CODE XREF: _silc_client_get_clients_list_cb+37Dj
		sub	dword ptr [clients+10h], 4
		cmp	esi, [clients+4]
		jnz	loc_62B8B140

loc_62B8B1C9:				; CODE XREF: _silc_client_get_clients_list_cb+2DEj
		mov	[clients+4], eax
		jmp	loc_62B8B140
; ---------------------------------------------------------------------------

loc_62B8B1D1:				; CODE XREF: _silc_client_get_clients_list_cb+35Ej
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx]
		mov	[clients+8], edx
		jmp	short loc_62B8B1BC
; ---------------------------------------------------------------------------

loc_62B8B1DB:				; CODE XREF: _silc_client_get_clients_list_cb+2C0j
conn_0 = edi				; SilcClientConnection
		movzx	conn_0,	word ptr [clients+0Ch]
		mov	[ebp+var_5C], clients
		xor	eax, eax
		jmp	short loc_62B8B19B
; ---------------------------------------------------------------------------

loc_62B8B1E6:				; CODE XREF: _silc_client_get_clients_list_cb+144j
c = edi					; int
		mov	edx, [ebp+var_4C]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		jmp	loc_62B8AEF8
; ---------------------------------------------------------------------------

loc_62B8B1FF:				; CODE XREF: _silc_client_get_clients_list_cb+3Cj
conn_0 = edi				; SilcClientConnection
clients	= eax				; SilcDList
		mov	dl, 30h

loc_62B8B201:				; CODE XREF: _silc_client_get_clients_list_cb+3ECj
status_0 = edx				; SilcStatus
clients	= ebx				; SilcDList
		mov	ecx, [ebp+context]
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_62B8B22C
		mov	ecx, [ecx+4]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], 0
		movzx	status_0, dl
		mov	[esp+8], status_0
		mov	[esp+4], conn_0
		mov	status_0, [ebp+client]
		mov	[esp], edx
		call	eax

loc_62B8B22C:				; CODE XREF: _silc_client_get_clients_list_cb+3ACj
status_0 = edx				; SilcStatus
		test	clients, clients
		jz	loc_62B8B157
		mov	dl, [clients+10h]
		jmp	loc_62B8B081
; ---------------------------------------------------------------------------

loc_62B8B23C:				; CODE XREF: _silc_client_get_clients_list_cb+86j
		xor	eax, eax
		jmp	loc_62B8B03F
; ---------------------------------------------------------------------------

out:					; CODE XREF: _silc_client_get_clients_list_cb+ACj
					; _silc_client_get_clients_list_cb+BAj	...
c = edi					; int
		mov	c, [ebp+var_4C]
conn_0 = edi				; SilcClientConnection
		mov	dl, 14h
status_0 = edx				; SilcStatus
		jmp	short loc_62B8B201
_silc_client_get_clients_list_cb endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 133. silc_client_get_clients_by_list

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 __cdecl silc_client_get_clients_by_list(SilcClient	client,	SilcClientConnection conn, SilcUInt32 list_count, SilcBuffer client_id_list, SilcGetClientCallback completion, void *context)
		public _silc_client_get_clients_by_list
_silc_client_get_clients_by_list proc near
					; CODE XREF: _silc_client_command_reply_users+484p
					; _silc_client_command_reply_join+4CBp

client_entry	= dword	ptr -7Ch
var_60		= dword	ptr -60h
in		= dword	ptr -5Ch
res_argv_types	= dword	ptr -58h
res_argv_lens	= dword	ptr -54h
res_argv	= dword	ptr -50h
i		= dword	ptr -4Ch
id		= SilcID ptr -3Ch
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
list_count	= dword	ptr  10h
client_id_list	= dword	ptr  14h
completion	= dword	ptr  18h
context		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ACh
		mov	ebx, [ebp+client_id_list]
		mov	esi, [ebp+client]
		test	esi, esi
		jz	loc_62B8B498
client_id_list_0 = ebx			; SilcBuffer
		mov	ecx, [ebp+conn]
		test	ecx, ecx
		jz	loc_62B8B498
		test	client_id_list_0, client_id_list_0
		jz	loc_62B8B498
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	[ebp+in], eax
		test	eax, eax
		jz	loc_62B8B498
		mov	eax, [ebp+completion]
		mov	edx, [ebp+in]
		mov	[edx], eax
		mov	eax, [ebp+context]
		mov	[edx+4], eax
		mov	ecx, [ebp+list_count]
		mov	[edx+0Ch], ecx
		mov	esi, [client_id_list_0+8]
		mov	edi, [client_id_list_0+4]
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	edx, eax
		test	eax, eax
		jz	loc_62B8B658
		sub	esi, edi
		jz	loc_62B8B67C
		mov	dword ptr [esp+4], 1
		mov	[esp], esi
		mov	[ebp+var_60], eax
		call	_silc_calloc
		mov	edx, [ebp+var_60]
		mov	[edx], eax
		test	eax, eax
		jz	loc_62B8B658
		mov	[edx+4], eax
		mov	[edx+8], eax
		lea	ecx, [eax+esi]
		mov	[edx+0Ch], ecx
		mov	edi, ecx
		sub	edi, eax
		cmp	esi, edi
		ja	short loc_62B8B311

loc_62B8B30C:				; CODE XREF: _silc_client_get_clients_by_list+433j
		mov	[edx+8], ecx
		mov	eax, ecx

loc_62B8B311:				; CODE XREF: _silc_client_get_clients_by_list+BEj
		mov	esi, [client_id_list_0+4]
		mov	ecx, [client_id_list_0+8]
		sub	ecx, esi
		mov	edi, [edx+4]
		mov	[ebp+i], edi
		sub	eax, edi
		cmp	ecx, eax
		ja	short loc_62B8B32A
		mov	edi, [ebp+i]
		rep movsb

loc_62B8B32A:				; CODE XREF: _silc_client_get_clients_by_list+D7j
		mov	eax, [ebp+in]
		mov	[eax+8], edx
		mov	esi, [ebp+list_count]
		test	esi, esi
		jz	loc_62B8B610
		mov	eax, [client_id_list_0+4]
		mov	[ebp+i], 0
		xor	edi, edi
res_argc = edi				; SilcUInt32
		mov	[ebp+res_argv_types], 0
		mov	[ebp+res_argv_lens], 0
		mov	[ebp+res_argv],	0
		jmp	short loc_62B8B3B6
; ---------------------------------------------------------------------------
		align 10h

loc_62B8B360:				; CODE XREF: _silc_client_get_clients_by_list+217j
		mov	edx, [ecx+384h]
		test	edx, edx
		jz	loc_62B8B469
		xchg	ax, ax

loc_62B8B370:				; CODE XREF: _silc_client_get_clients_by_list+244j
		mov	ecx, [ebp+client_entry]
		mov	[esp+8], ecx	; client_entry
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_client
		mov	edx, [client_id_list_0+4]
		mov	eax, [client_id_list_0+8]
		sub	eax, edx
		cmp	esi, eax
		ja	err
		lea	eax, [edx+esi]
		mov	[client_id_list_0+4], eax
		test	edx, edx
		jz	err
		inc	[ebp+i]
		mov	ecx, [ebp+i]
		cmp	[ebp+list_count], ecx
		jbe	loc_62B8B574

loc_62B8B3B6:				; CODE XREF: _silc_client_get_clients_by_list+110j
		movzx	esi, byte ptr [eax+2]
idp_len	= esi				; SilcUInt16
		shl	idp_len, 8
		movzx	edx, byte ptr [eax+3]
		or	idp_len, edx
		add	idp_len, 4
		movzx	esi, si
		lea	edx, [ebp+id]
		mov	[esp+8], edx
		mov	[esp+4], esi
		mov	[esp], eax
		call	_silc_id_payload_parse_id
		test	al, al
		jz	err
		mov	ecx, [ebp+conn]
		mov	eax, [ecx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+var_1C]
		mov	[esp+8], eax
		lea	edx, [ebp+id]
		mov	[esp+4], edx
		mov	ecx, [ebp+conn]
		mov	eax, [ecx+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_find_by_id_one
		test	al, al
		jz	loc_62B8B5F0
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0Ch]
		mov	[ebp+client_entry], eax
		mov	ecx, eax
		mov	eax, [eax+3F8h]
		mov	eax, [ecx+3F8h]
		inc	eax
		mov	[ecx+3F8h], eax
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	ecx, [ebp+client_entry]
		cmp	byte ptr [ecx],	0
		jz	short loc_62B8B469
		cmp	byte ptr [ecx+101h], 0
		jnz	loc_62B8B360

loc_62B8B469:				; CODE XREF: _silc_client_get_clients_by_list+11Cj
					; _silc_client_get_clients_by_list+20Ej ...
		mov	eax, [ebp+res_argv]
		test	eax, eax
		jz	short loc_62B8B4A8

loc_62B8B470:				; CODE XREF: _silc_client_get_clients_by_list+2AEj
		lea	eax, ds:0[res_argc*4]
		mov	ecx, [client_id_list_0+4]
		mov	edx, [ebp+res_argv]
		mov	[edx+eax], ecx
		mov	edx, [ebp+res_argv_lens]
		mov	[edx+eax], esi
		lea	ecx, [res_argc+4]
		mov	edx, [ebp+res_argv_types]
		mov	[edx+eax], ecx
		inc	res_argc
		jmp	loc_62B8B370
; ---------------------------------------------------------------------------
		align 4

loc_62B8B498:				; CODE XREF: _silc_client_get_clients_by_list+14j
					; _silc_client_get_clients_by_list+1Fj	...
		xor	eax, eax

loc_62B8B49A:				; CODE XREF: _silc_client_get_clients_by_list+39Ej
					; _silc_client_get_clients_by_list+407j
		add	esp, 0ACh
		pop	client_id_list_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
client_id_list_0 = ebx			; SilcBuffer
res_argc = edi				; SilcUInt32
		align 4

loc_62B8B4A8:				; CODE XREF: _silc_client_get_clients_by_list+222j
		mov	dword ptr [esp+4], 4
		mov	eax, [ebp+list_count]
		mov	[esp], eax
		call	_silc_calloc
		mov	[ebp+res_argv],	eax
		mov	dword ptr [esp+4], 4
		mov	edx, [ebp+list_count]
		mov	[esp], edx
		call	_silc_calloc
		mov	[ebp+res_argv_lens], eax
		mov	dword ptr [esp+4], 4
		mov	ecx, [ebp+list_count]
		mov	[esp], ecx
		call	_silc_calloc
		mov	[ebp+res_argv_types], eax
		mov	ecx, [ebp+res_argv]
		test	ecx, ecx
		jz	short loc_62B8B500
		mov	edx, [ebp+res_argv_lens]
		test	edx, edx
		jz	short loc_62B8B500
		test	eax, eax
		jnz	loc_62B8B470

loc_62B8B500:				; CODE XREF: _silc_client_get_clients_by_list+2A3j
					; _silc_client_get_clients_by_list+2AAj
		mov	edx, [ebp+client_entry]
entry =	edx				; SilcClientEntry
		mov	[esp+8], entry	; client_entry
		mov	res_argc, [ebp+conn]
		mov	[esp+4], edi	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
res_argc = edi				; SilcUInt32
		lea	esi, [esi+0]

err:					; CODE XREF: _silc_client_get_clients_by_list+147j
					; _silc_client_get_clients_by_list+155j ...
		mov	edx, [ebp+in]
		mov	client_id_list_0, [edx+8]
		test	ebx, ebx
		jz	short loc_62B8B538
		mov	eax, [ebx]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free

loc_62B8B538:				; CODE XREF: _silc_client_get_clients_by_list+2D8j
					; _silc_client_get_clients_by_list+42Bj
		mov	ecx, [ebp+in]
		mov	[esp], ecx
		call	_silc_free
		mov	res_argc, [ebp+res_argv]
		mov	[esp], edi
		call	_silc_free
		mov	eax, [ebp+res_argv_lens]
		mov	[esp], eax
		call	_silc_free
		mov	edx, [ebp+res_argv_types]
		mov	[esp], edx
		call	_silc_free
		xor	eax, eax
		add	esp, 0ACh
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
client_id_list_0 = ebx			; SilcBuffer
res_argc = edi				; SilcUInt32
		align 4

loc_62B8B574:				; CODE XREF: _silc_client_get_clients_by_list+164j
		mov	eax, [client_id_list_0]
		mov	[client_id_list_0+4], eax
		test	res_argc, res_argc
		jz	loc_62B8B618
		mov	eax, [ebp+res_argv_types]
		mov	[esp+20h], eax	; argv_types
		mov	edx, [ebp+res_argv_lens]
		mov	[esp+1Ch], edx	; argv_lens
		mov	ecx, [ebp+res_argv]
		mov	[esp+18h], ecx	; argv
		mov	[esp+14h], res_argc ; argc
		mov	res_argc, [ebp+in]
		mov	[esp+10h], edi	; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_clients_list_cb ; reply
		mov	dword ptr [esp+8], 1 ; command
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_command_send_argv
		mov	ecx, [ebp+res_argv]
		mov	[esp], ecx
		mov	[ebp+var_60], eax
		call	_silc_free
		mov	edi, [ebp+res_argv_lens]
		mov	[esp], edi
		call	_silc_free
		mov	edx, [ebp+res_argv_types]
		mov	[esp], edx
		call	_silc_free
		mov	eax, [ebp+var_60]
		jmp	loc_62B8B49A
; ---------------------------------------------------------------------------
res_argc = edi				; SilcUInt32
		align 10h

loc_62B8B5F0:				; CODE XREF: _silc_client_get_clients_by_list+1D0j
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[ebp+client_entry], 0
		jmp	loc_62B8B469
; ---------------------------------------------------------------------------

loc_62B8B610:				; CODE XREF: _silc_client_get_clients_by_list+E9j
		mov	eax, [client_id_list_0]
		mov	[client_id_list_0+4], eax
res_argc = edi				; SilcUInt32
		lea	esi, [esi+0]

loc_62B8B618:				; CODE XREF: _silc_client_get_clients_by_list+32Fj
		mov	dword ptr [esp+18h], 0 ; ap
		mov	ecx, [ebp+in]
		mov	[esp+14h], ecx	; context
		mov	dword ptr [esp+10h], 0 ; error
		mov	dword ptr [esp+0Ch], 0 ; status
		mov	dword ptr [esp+8], 1 ; command
		mov	res_argc, [ebp+conn]
		mov	[esp+4], edi	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_clients_list_cb
		xor	eax, eax
cmd_ident = eax				; SilcUInt16
		jmp	loc_62B8B49A
; ---------------------------------------------------------------------------

loc_62B8B658:				; CODE XREF: _silc_client_get_clients_by_list+7Ej
					; _silc_client_get_clients_by_list+A6j
		mov	edi, [ebp+in]
		mov	dword ptr [edi+8], 0
		mov	[ebp+res_argv_types], 0
		mov	[ebp+res_argv_lens], 0
		mov	[ebp+res_argv],	0
		jmp	loc_62B8B538
; ---------------------------------------------------------------------------

loc_62B8B67C:				; CODE XREF: _silc_client_get_clients_by_list+86j
		mov	ecx, [eax+8]
		jmp	loc_62B8B30C
_silc_client_get_clients_by_list endp

; Exported entry 131. silc_client_get_client_by_id_resolve

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 __cdecl silc_client_get_client_by_id_resolve(SilcClient client, SilcClientConnection conn,	SilcClientID *client_id, SilcBuffer attributes,	SilcGetClientCallback completion, void *context)
		public _silc_client_get_client_by_id_resolve
_silc_client_get_client_by_id_resolve proc near
					; CODE XREF: _silc_client_channel_message+C7p
					; _silc_client_ftp+28Ep ...

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
client_entry	= dword	ptr -30h
i		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_id	= dword	ptr  10h
attributes	= dword	ptr  14h
completion	= dword	ptr  18h
context		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	esi, [ebp+client]
		mov	ebx, [ebp+conn]
		mov	edi, [ebp+client_id]
		test	esi, esi
		jz	loc_62B8B8B4
client_0 = esi				; SilcClient
conn_0 = ebx				; SilcClientConnection
client_id_0 = edi			; SilcClientID *
		test	client_id_0, client_id_0
		jz	loc_62B8B8B4
		test	conn_0,	conn_0
		jz	loc_62B8B8B4
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	[ebp+i], eax
		test	eax, eax
		jz	loc_62B8B8AC
		mov	edx, [ebp+completion]
		mov	eax, [ebp+i]
		mov	[eax+4], edx
		mov	ecx, [ebp+context]
		mov	[eax+8], ecx
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
		test	eax, eax
		jz	loc_62B8B964
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	edx, [eax+10h]
		and	edx, 3
		mov	[eax+10h], edx
		mov	word ptr [eax+0Ch], 4
		mov	word ptr [eax+0Eh], 8
		mov	byte ptr [eax+10h], 1
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax], 0
		mov	edx, [ebp+i]
		mov	[edx], eax
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+var_1C]
		mov	[esp+8], eax
		mov	[esp+4], client_id_0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_find_by_id_one
		test	al, al
		jz	loc_62B8B97C
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0Ch]
		mov	[ebp+client_entry], eax
		mov	edx, eax
		mov	eax, [eax+3F8h]
		mov	eax, [edx+3F8h]
		inc	eax
		mov	[edx+3F8h], eax
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	ecx, [ebp+client_entry]
		cmp	word ptr [ecx+400h], 0
		jnz	loc_62B8B8DA

loc_62B8B7A5:				; CODE XREF: _silc_client_get_client_by_id_resolve+310j
		mov	dword ptr [esp+4], 2
		mov	[esp], client_id_0
		call	_silc_id_payload_encode
		mov	client_id_0, eax
idp = edi				; SilcBuffer
		test	eax, eax
		jz	loc_62B8B944
idp = eax				; SilcBuffer
		mov	idp, [idp+4]
idp = edi				; SilcBuffer
		mov	[ebp+var_3C], eax
		mov	eax, [idp+8]
		sub	eax, [ebp+var_3C]

loc_62B8B7CB:				; CODE XREF: _silc_client_get_client_by_id_resolve+2C9j
		mov	edx, [ebp+attributes]
		test	edx, edx
		jz	loc_62B8B954
		mov	edx, [ebp+attributes]
		mov	edx, [edx+4]
		mov	[ebp+var_34], edx
		mov	ecx, [ebp+attributes]
		mov	edx, [ecx+8]
		sub	edx, [ebp+var_34]

loc_62B8B7E8:				; CODE XREF: _silc_client_get_client_by_id_resolve+2D9j
		mov	[esp+2Ch], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 4
		mov	[esp+20h], edx
		mov	edx, [ebp+var_34]
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 3
		mov	dword ptr [esp+14h], 2 ; argc
		mov	ecx, [ebp+i]
		mov	[esp+10h], ecx	; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_clients_cb	; reply
		mov	dword ptr [esp+8], 1 ; command
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_command_send
		test	ax, ax
cmd_ident = eax				; SilcUInt16
		jnz	short loc_62B8B86C
		mov	ecx, [ebp+completion]
		test	ecx, ecx
		jz	short loc_62B8B86C
		mov	edx, [ebp+context]
		mov	[esp+10h], edx	; void *
		mov	dword ptr [esp+0Ch], 0 ; SilcDList
		mov	dword ptr [esp+8], 30h ; SilcStatus
		mov	[esp+4], conn_0	; SilcClientConnection
		mov	[esp], client_0	; SilcClient
		mov	[ebp+var_38], cmd_ident
		call	[ebp+completion]
		mov	eax, [ebp+var_38]

loc_62B8B86C:				; CODE XREF: _silc_client_get_client_by_id_resolve+1B8j
					; _silc_client_get_client_by_id_resolve+1BFj
cmd_ident = eax				; SilcUInt16
		mov	edx, [ebp+client_entry]
		test	edx, edx
		jz	loc_62B8B924
		test	ax, ax
		jz	loc_62B8B924
		mov	ecx, [ebp+client_entry]
		mov	[ecx+400h], ax
		mov	edx, [ebp+i]
		mov	[edx+0Ch], ecx

loc_62B8B890:				; CODE XREF: _silc_client_get_client_by_id_resolve+2B9j
		test	idp, idp
		jz	short loc_62B8B8AC
		mov	edx, [idp]
		mov	[esp], edx
		mov	[ebp+var_38], cmd_ident
		call	_silc_free
		mov	[esp], idp
		call	_silc_free
		mov	eax, [ebp+var_38]

loc_62B8B8AC:				; CODE XREF: _silc_client_get_client_by_id_resolve+43j
					; _silc_client_get_client_by_id_resolve+20Ej ...
		add	esp, 6Ch
		pop	conn_0
		pop	client_0
		pop	idp
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8B8B4:				; CODE XREF: _silc_client_get_client_by_id_resolve+14j
					; _silc_client_get_client_by_id_resolve+1Cj ...
client_0 = esi				; SilcClient ; "Missing	arguments to silc_client_get_cl"...
conn_0 = ebx				; SilcClientConnection
client_id_0 = edi			; SilcClientID *
		mov	dword ptr [esp], offset	aMissingArgum_0
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		xor	eax, eax
		add	esp, 6Ch
		pop	conn_0
		pop	client_0
		pop	client_id_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8B8DA:				; CODE XREF: _silc_client_get_client_by_id_resolve+11Bj
client_0 = esi				; SilcClient ; client_entry
conn_0 = ebx				; SilcClientConnection
client_id_0 = edi			; SilcClientID *
		mov	[esp+8], ecx
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_client
		mov	eax, [ebp+i]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_get_clients_cb	; reply
		mov	edx, [ebp+client_entry]
		movzx	eax, word ptr [edx+400h]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], conn_0	; conn
		call	_silc_client_command_pending
		mov	ecx, [ebp+client_entry]
		mov	eax, [ecx+400h]
cmd_ident = eax				; SilcUInt16
		jmp	short loc_62B8B8AC
; ---------------------------------------------------------------------------
idp = edi				; SilcBuffer
		align 4

loc_62B8B924:				; CODE XREF: _silc_client_get_client_by_id_resolve+1EDj
					; _silc_client_get_client_by_id_resolve+1F6j
		mov	ecx, [ebp+client_entry]
		mov	[esp+8], ecx	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		mov	[ebp+var_38], cmd_ident
		call	_silc_client_unref_client
		mov	eax, [ebp+var_38]
		jmp	loc_62B8B890
; ---------------------------------------------------------------------------
idp = eax				; SilcBuffer
		align 4

loc_62B8B944:				; CODE XREF: _silc_client_get_client_by_id_resolve+135j
		xor	idp, idp
idp = edi				; SilcBuffer
		mov	[ebp+var_3C], 0
		jmp	loc_62B8B7CB
; ---------------------------------------------------------------------------
		align 4

loc_62B8B954:				; CODE XREF: _silc_client_get_client_by_id_resolve+14Cj
		xor	edx, edx
		mov	[ebp+var_34], 0
		jmp	loc_62B8B7E8
; ---------------------------------------------------------------------------
client_id_0 = edi			; SilcClientID *
		align 4

loc_62B8B964:				; CODE XREF: _silc_client_get_client_by_id_resolve+66j
		mov	ecx, [ebp+i]
		mov	dword ptr [ecx], 0
		mov	[esp], ecx
		call	_silc_free
		xor	eax, eax
cmd_ident = eax				; SilcUInt16
		jmp	loc_62B8B8AC
; ---------------------------------------------------------------------------

loc_62B8B97C:				; CODE XREF: _silc_client_get_client_by_id_resolve+DBj
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[ebp+client_entry], 0
		jmp	loc_62B8B7A5
_silc_client_get_client_by_id_resolve endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_monitor(SilcSFTP	sftp, SilcSFTPMonitors type, const SilcSFTPMonitorData data, void *context)
_silc_client_ftp_monitor proc near	; DATA XREF: _silc_client_ftp_connect_completion+254o

sftp		= dword	ptr  8
type		= dword	ptr  0Ch
data		= dword	ptr  10h
context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+context]
		cmp	[ebp+type], 8
		jz	short loc_62B8B9B4

loc_62B8B9AC:				; CODE XREF: _silc_client_ftp_monitor+1Dj
context_0 = eax				; void *
		add	esp, 34h
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_62B8B9B4:				; CODE XREF: _silc_client_ftp_monitor+Ej
		mov	edx, [context_0+64h]
		test	edx, edx
		jz	short loc_62B8B9AC
		mov	ecx, [context_0+68h]
		mov	[esp+2Ch], ecx
		mov	ecx, [context_0+74h]
		mov	[esp+28h], ecx
		mov	ecx, [context_0+60h]
		mov	[esp+24h], ecx
		mov	ecx, [context_0+0Ch]
		mov	[esp+20h], ecx
		mov	ecx, [context_0+98h]
		mov	ebx, [context_0+9Ch]
		mov	[esp+18h], ecx
		mov	[esp+1Ch], ebx
		mov	ecx, [ebp+data]
		mov	ebx, [ecx+14h]
		mov	ecx, [ecx+10h]
		mov	[esp+10h], ecx
		mov	[esp+14h], ebx
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	ecx, [context_0+8]
		mov	[esp+4], ecx
		mov	context_0, [context_0]
		mov	[esp], eax
		call	edx
		add	esp, 34h
		pop	ebx
		leave
		retn
_silc_client_ftp_monitor endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_error(SilcSFTP sftp, SilcSFTPStatus status, void	*context)
_silc_client_ftp_error proc near	; DATA XREF: _silc_client_ftp_connect_completion+112o
					; _silc_client_ftp_connect_completion+22Eo

sftp		= dword	ptr  8
status		= dword	ptr  0Ch
context		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		leave
		retn
_silc_client_ftp_error endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __usercall silc_dlist_add_0@<al>(SilcDList list@<eax>, void *context@<edx>)
_silc_dlist_add_0 proc near		; CODE XREF: _silc_client_ftp+1DFp
					; _silc_client_file_send+345p
list = eax				; SilcDList
context	= edx				; void *
		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, list
		mov	esi, context
		mov	dword ptr [esp], 0Ch
		call	_silc_malloc
list = ebx				; SilcDList
context	= esi				; void *
		test	eax, eax
e = eax					; SilcDListEntry
		jz	short loc_62B8BA6C
		mov	[e], context
		mov	edx, [list]
		test	edx, edx
		jz	short loc_62B8BA80
		movzx	edx, word ptr [list+0Ch]
		mov	ecx, [list+4]
		mov	[ecx+edx], e

loc_62B8BA56:				; CODE XREF: _silc_dlist_add_0+5Ej
		test	byte ptr [list+10h], 1
		jnz	short loc_62B8BA74

loc_62B8BA5C:				; CODE XREF: _silc_dlist_add_0+56j
		mov	[list+4], e
		mov	dword ptr [e+edx], 0
		add	dword ptr [list+10h], 4
		mov	al, 1

loc_62B8BA6C:				; CODE XREF: _silc_dlist_add_0+1Aj
		add	esp, 10h
		pop	list
		pop	context
		leave
		retn
; ---------------------------------------------------------------------------
list = ebx				; SilcDList
context	= esi				; void *
e = eax					; SilcDListEntry
		align 4

loc_62B8BA74:				; CODE XREF: _silc_dlist_add_0+32j
		movzx	ecx, word ptr [list+0Eh]
		mov	context, [list+4]
		mov	[e+ecx], esi
		jmp	short loc_62B8BA5C
; ---------------------------------------------------------------------------

loc_62B8BA80:				; CODE XREF: _silc_dlist_add_0+22j
context	= esi				; void *
		mov	[list],	e
		movzx	edx, word ptr [list+0Ch]
		jmp	short loc_62B8BA56
_silc_dlist_add_0 endp

; Exported entry 121. silc_client_ftp

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_ftp(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_ftp
_silc_client_ftp proc near		; DATA XREF: _silc_client_connection_st_packet:loc_62B81E7Co

context		= dword	ptr -4Ch
var_46		= word ptr -46h
hostname	= dword	ptr -44h
remote_client	= dword	ptr -40h
payload		= dword	ptr -3Ch
remote_id	= SilcClientID ptr -35h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	edi, [ebp+fsm_context]
		mov	ebx, [ebp+state_context]
		mov	esi, [edi+4Ch]
client = esi				; SilcClient
		mov	eax, [ebx+0Ch]
		cmp	[ebx+10h], eax
		jz	short loc_62B8BAA7
fsm_context_0 =	edi			; void *
state_context_0	= ebx			; void *
		cmp	byte ptr [eax],	1
		jz	short loc_62B8BABC

loc_62B8BAA7:				; CODE XREF: _silc_client_ftp+18j
					; _silc_client_ftp+62j	...
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3

loc_62B8BAB4:				; CODE XREF: _silc_client_ftp+2A9j
		add	esp, 7Ch
		pop	state_context_0
		pop	client
		pop	fsm_context_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8BABC:				; CODE XREF: _silc_client_ftp+1Dj
fsm_context_0 =	edi			; void *
state_context_0	= ebx			; void *
client = esi				; SilcClient
		mov	dword ptr [esp+10h], 1Dh
		lea	eax, [ebp+remote_id]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 2
		mov	al, [state_context_0+20h]
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [state_context_0+18h]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jz	short loc_62B8BAA7
		lea	edx, [ebp+remote_id]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id
		mov	[ebp+remote_client], eax
		test	eax, eax
		jz	loc_62B8BCC9
		test	byte ptr [eax+402h], 1
		jz	loc_62B8BCC9
		mov	eax, [client+18h]
		mov	eax, [eax+6Ch]
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [client+18h]
		mov	eax, [eax+6Ch]
		jmp	short loc_62B8BB5B
; ---------------------------------------------------------------------------

loc_62B8BB3C:				; CODE XREF: _silc_client_ftp+E4j
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B8BB43:				; CODE XREF: _silc_client_ftp+EDj
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	edx, [edx]
session	= edx				; SilcClientFtpSession
		test	session, session
		jz	short loc_62B8BB81
		mov	ecx, [ebp+remote_client]
		cmp	ecx, [session+0Ch]
		jz	loc_62B8BCAC

loc_62B8BB5B:				; CODE XREF: _silc_client_ftp+B2j
					; _silc_client_ftp+236j
		mov	session, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B8BB78
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B8BB3C
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	short loc_62B8BB43
; ---------------------------------------------------------------------------
		align 4

loc_62B8BB78:				; CODE XREF: _silc_client_ftp+DEj
		mov	dword ptr [eax+14h], 0
		xor	edx, edx

loc_62B8BB81:				; CODE XREF: _silc_client_ftp+C5j
					; _silc_client_ftp+22Bj ...
session	= edx				; SilcClientFtpSession
		mov	ecx, [state_context_0+0Ch]
		mov	eax, ecx
		not	eax
		add	eax, [state_context_0+10h]
		mov	[esp+4], eax
		inc	ecx
		mov	[esp], ecx
		mov	[ebp+context], session
		call	_silc_key_agreement_payload_parse
		mov	[ebp+payload], eax
		test	eax, eax
		jz	loc_62B8BAA7
		mov	[esp], eax
		call	_silc_key_agreement_get_hostname
		mov	[ebp+hostname],	eax
		mov	eax, [ebp+payload]
		mov	[esp], eax
		call	_silc_key_agreement_get_port
		mov	[ebp+var_46], ax
		mov	eax, [ebp+hostname]
		test	eax, eax
		mov	edx, [ebp+context]
		jz	loc_62B8BE32
		cmp	[ebp+var_46], 0
		jnz	short loc_62B8BBDC
		mov	[ebp+hostname],	0

loc_62B8BBDC:				; CODE XREF: _silc_client_ftp+14Bj
					; _silc_client_ftp+3B0j
		test	edx, edx
session	= edx				; SilcClientFtpSession
		jz	short loc_62B8BBF4
		mov	ecx, [ebp+hostname]
		test	ecx, ecx
		jz	short loc_62B8BBF4
		test	byte ptr [session+0ACh], 1
		jnz	loc_62B8BD64

loc_62B8BBF4:				; CODE XREF: _silc_client_ftp+156j
					; _silc_client_ftp+15Dj
		mov	dword ptr [esp+4], 0B0h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ecx, eax
session	= ecx				; SilcClientFtpSession
		test	eax, eax
		jz	loc_62B8BC9C
session	= eax				; SilcClientFtpSession
		mov	edx, [client+18h]
		mov	session, [edx+80h]
session	= ecx				; SilcClientFtpSession
		inc	eax
		mov	[edx+80h], ax
		movzx	eax, ax
		mov	[session+60h], eax
		mov	[session], client
		mov	[session+4], fsm_context_0
		mov	edx, [ebp+remote_client]
		mov	[esp+8], edx	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+context], session
		call	_silc_client_ref_client
		mov	ecx, [ebp+context]
		mov	[ecx+0Ch], eax
session	= ecx				; SilcClientFtpSession
		mov	eax, [ebp+hostname]
		test	eax, eax
		jz	short loc_62B8BC5C
		cmp	[ebp+var_46], 0
		jnz	loc_62B8BE3D

loc_62B8BC5C:				; CODE XREF: _silc_client_ftp+1C7j
					; _silc_client_ftp+3D4j
		mov	eax, [client+18h]
		mov	eax, [eax+6Ch]	; list
		mov	edx, session	; context
		mov	[ebp+context], session
		call	_silc_dlist_add_0
		mov	eax, [client+18h]
		mov	edx, [eax+48h]
		movzx	eax, [ebp+var_46]
port = eax				; SilcUInt16
		mov	[esp+14h], port
		mov	port, [ebp+hostname]
		mov	[esp+10h], eax
		mov	ecx, [ebp+context]
		mov	eax, [ecx+60h]
session	= ecx				; SilcClientFtpSession
		mov	[esp+0Ch], eax
		mov	session, [ebp+remote_client]
		mov	[esp+8], ecx
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		call	dword ptr [edx+28h]

loc_62B8BC9C:				; CODE XREF: _silc_client_ftp+184j
					; _silc_client_ftp+33Aj ...
session	= edx				; SilcClientFtpSession
		mov	eax, [ebp+payload]
		mov	[esp], eax
		call	_silc_key_agreement_payload_free
		jmp	loc_62B8BAA7
; ---------------------------------------------------------------------------

loc_62B8BCAC:				; CODE XREF: _silc_client_ftp+CDj
session	= edx				; SilcClientFtpSession
		test	byte ptr [session+0ACh], 1
		jz	loc_62B8BB81
		mov	ecx, [session+10h]
		test	ecx, ecx
		jnz	loc_62B8BB5B
		jmp	loc_62B8BB81
; ---------------------------------------------------------------------------

loc_62B8BCC9:				; CODE XREF: _silc_client_ftp+7Cj
					; _silc_client_ftp+89j
		mov	ecx, [ebp+remote_client]
		mov	[esp+8], ecx	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	short loc_62B8BD36

loc_62B8BCF1:				; CODE XREF: _silc_client_ftp+2DAj
		mov	eax, [ebp+fsm]
		mov	[esp+14h], eax	; context
		mov	dword ptr [esp+10h], offset _silc_client_ftp_client_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		lea	edx, [ebp+remote_id]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id_resolve
		mov	ecx, [ebp+fsm]
		mov	dl, [ecx+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		shl	eax, 1
		and	eax, 2
		jmp	loc_62B8BAB4
; ---------------------------------------------------------------------------

loc_62B8BD36:				; CODE XREF: _silc_client_ftp+267j
		mov	dword ptr [esp+8], 3EFh
		mov	dword ptr [esp+4], offset aClient_ftp_c	; "client_ftp.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_1	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	short loc_62B8BCF1
; ---------------------------------------------------------------------------

loc_62B8BD64:				; CODE XREF: _silc_client_ftp+166j
session	= edx				; SilcClientFtpSession
		mov	eax, [ebp+hostname]
		mov	[esp], eax	; char *
		mov	[ebp+context], session
		call	_strdup
		mov	edx, [ebp+context]
		mov	[edx+90h], eax
session	= edx				; SilcClientFtpSession
		mov	cx, [ebp+var_46]
		mov	[session+94h], cx
		mov	[esp+1Ch], session ; context
		mov	dword ptr [esp+18h], offset _silc_client_ftp_connect_completion	; callback
		movzx	ecx, cx
port = ecx				; SilcUInt16
		mov	[esp+14h], port	; port
		mov	[esp+10h], eax	; remote_host
		mov	eax, [session+5Ch]
		mov	[esp+0Ch], eax	; private_key
		mov	eax, [session+58h]
		mov	[esp+8], eax	; public_key
		lea	eax, [session+18h]
		mov	[esp+4], eax	; params
		mov	[esp], client	; client
		call	_silc_client_connect_to_client
		mov	edx, [ebp+context]
		mov	[edx+14h], eax
session	= edx				; SilcClientFtpSession
		test	eax, eax
		jnz	loc_62B8BC9C
		mov	eax, [session+64h]
		test	eax, eax
		jz	loc_62B8BC9C
		mov	ecx, [session+68h]
		mov	[esp+2Ch], ecx
		mov	ecx, [session+74h]
		mov	[esp+28h], ecx
		mov	ecx, [session+60h]
		mov	[esp+24h], ecx
		mov	ecx, [session+0Ch]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 7
		mov	ecx, [session+8]
		mov	[esp+4], ecx
		mov	session, [session]
		mov	[esp], edx
		call	eax
		jmp	loc_62B8BC9C
; ---------------------------------------------------------------------------

loc_62B8BE32:				; CODE XREF: _silc_client_ftp+140j
		mov	[ebp+var_46], 0
		jmp	loc_62B8BBDC
; ---------------------------------------------------------------------------

loc_62B8BE3D:				; CODE XREF: _silc_client_ftp+1CEj
session	= ecx				; SilcClientFtpSession
		mov	eax, [ebp+hostname]
		mov	[esp], eax	; char *
		call	_strdup
		mov	ecx, [ebp+context]
		mov	[ecx+90h], eax
session	= ecx				; SilcClientFtpSession
		mov	dx, [ebp+var_46]
		mov	[session+94h], dx
		jmp	loc_62B8BC5C
_silc_client_ftp endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __usercall silc_buffer_free(SilcBuffer sb@<eax>)
_silc_buffer_free proc near		; CODE XREF: _silc_client_file_receive+22Fp
					; _silc_client_file_send+32Ap
sb = eax				; SilcBuffer
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, sb
		test	sb, sb
		jz	short loc_62B8BE83
		mov	sb, [sb]
sb = ebx				; SilcBuffer
		mov	[esp], eax
		call	_silc_free
		mov	[esp], sb
		call	_silc_free

loc_62B8BE83:				; CODE XREF: _silc_buffer_free+Bj
		add	esp, 14h
		pop	sb
sb = eax				; SilcBuffer
		leave
		retn
_silc_buffer_free endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_version(SilcSFTP	sftp, SilcSFTPStatus status, SilcSFTPVersion version, void *context)
_silc_client_ftp_version proc near	; DATA XREF: _silc_client_ftp_connect_completion+11Ao

var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
sftp		= dword	ptr  8
status		= dword	ptr  0Ch
version		= dword	ptr  10h
context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	ecx, [ebp+sftp]
		mov	edx, [ebp+status]
		mov	eax, [ebp+context]
session	= eax				; SilcClientFtpSession
		test	edx, edx
		jz	loc_62B8BF30
sftp_0 = ecx				; SilcSFTP
status_0 = edx				; SilcSFTPStatus
		mov	sftp_0,	[session+64h]
		test	ecx, ecx
		jz	short loc_62B8BF28
		mov	edi, [session+68h]
		mov	esi, [session+74h]
		mov	ebx, [session+60h]
		mov	[ebp+var_2C], ebx
		mov	ebx, [session+0Ch]
		mov	[ebp+var_1C], ebx
		cmp	status_0, 2
		jz	loc_62B8BF50
		cmp	status_0, 3
		setz	dl
		movzx	edx, dl
		lea	edx, ds:1[edx*4]

loc_62B8BED8:				; CODE XREF: _silc_client_ftp_version+C6j
		mov	[esp+2Ch], edi
		mov	[esp+28h], esi
		mov	ebx, [ebp+var_2C]
		mov	[esp+24h], ebx
		mov	ebx, [ebp+var_1C]
		mov	[esp+20h], ebx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 7
		mov	edx, [session+8]
		mov	[esp+4], edx
		mov	session, [session]
		mov	[esp], eax
		call	ecx

loc_62B8BF28:				; CODE XREF: _silc_client_ftp_version+1Fj
session	= eax				; SilcClientFtpSession
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8BF30:				; CODE XREF: _silc_client_ftp_version+14j
sftp_0 = ecx				; SilcSFTP
status_0 = edx				; SilcSFTPStatus
		mov	[ebp+context], session
		mov	[ebp+version], offset _silc_client_ftp_opendir_handle
		mov	[ebp+status], offset byte_62BA873B
		mov	[ebp+sftp], sftp_0
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		jmp	_silc_sftp_opendir
; ---------------------------------------------------------------------------

loc_62B8BF50:				; CODE XREF: _silc_client_ftp_version+36j
status_0 = edx				; SilcSFTPStatus
session	= eax				; SilcClientFtpSession
		mov	dl, 4
		jmp	short loc_62B8BED8
_silc_client_ftp_version endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_opendir_handle(SilcSFTP sftp, SilcSFTPStatus status, SilcSFTPHandle handle, void	*context)
_silc_client_ftp_opendir_handle	proc near ; DATA XREF: _silc_client_ftp_version+A7o

var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
sftp		= dword	ptr  8
status		= dword	ptr  0Ch
handle		= dword	ptr  10h
context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	eax, [ebp+status]
		mov	esi, [ebp+handle]
		mov	ebx, [ebp+context]
		test	eax, eax
		jz	loc_62B8BFF8
status_0 = eax				; SilcSFTPStatus
handle_0 = esi				; SilcSFTPHandle
context_0 = ebx				; void *
		mov	edx, [context_0+64h]
		test	edx, edx
		jz	short loc_62B8BFF0
		mov	edi, [context_0+68h]
		mov	handle_0, [context_0+74h]
		mov	ecx, [context_0+60h]
		mov	[ebp+var_2C], ecx
		mov	ecx, [context_0+0Ch]
		mov	[ebp+var_1C], ecx
		cmp	status_0, 2
		jz	loc_62B8C024
		cmp	status_0, 3
		setz	al
		movzx	eax, al
		lea	eax, ds:1[eax*4]

loc_62B8BFA0:				; CODE XREF: _silc_client_ftp_opendir_handle+D2j
		mov	[esp+2Ch], edi
		mov	[esp+28h], esi
		mov	ecx, [ebp+var_2C]
		mov	[esp+24h], ecx
		mov	ecx, [ebp+var_1C]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 7
		mov	eax, [context_0+8]
		mov	[esp+4], eax
		mov	eax, [context_0]
		mov	[esp], eax
		call	edx

loc_62B8BFF0:				; CODE XREF: _silc_client_ftp_opendir_handle+1Fj
		add	esp, 5Ch
		pop	context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8BFF8:				; CODE XREF: _silc_client_ftp_opendir_handle+14j
status_0 = eax				; SilcSFTPStatus
handle_0 = esi				; SilcSFTPHandle
context_0 = ebx				; void *
		mov	[esp+0Ch], context_0
		mov	dword ptr [esp+8], offset _silc_client_ftp_readdir_name
		mov	[esp+4], handle_0
		mov	status_0, [ebp+sftp]
		mov	[esp], eax
		call	_silc_sftp_readdir
		mov	[context_0+88h], handle_0
		add	esp, 5Ch
		pop	context_0
		pop	handle_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
status_0 = eax				; SilcSFTPStatus
context_0 = ebx				; void *
		align 4

loc_62B8C024:				; CODE XREF: _silc_client_ftp_opendir_handle+36j
		mov	al, 4
		jmp	loc_62B8BFA0
_silc_client_ftp_opendir_handle	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_ask_name(const char *filepath, void *context)
_silc_client_ftp_ask_name proc near	; CODE XREF: _silc_client_ftp_readdir_name+E2j
					; DATA XREF: _silc_client_ftp_readdir_name+102o

attr		= SilcSFTPAttributesStruct ptr -48h
filepath	= dword	ptr  8
context		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	edi, [ebp+filepath]
		mov	ebx, [ebp+context]
		test	edi, edi
		jz	loc_62B8C0E4
filepath_0 = edi			; const	char *
context_0 = ebx				; void *
		mov	esi, [context_0+74h]
remote_file = esi			; char *
		mov	dword ptr [context_0+74h], 0
		mov	eax, [context_0+78h]
		mov	[esp], eax
		call	_silc_free
		mov	dword ptr [context_0+78h], 0
		mov	[esp], filepath_0 ; char *
		call	_strdup
		mov	[context_0+74h], eax

loc_62B8C06A:				; CODE XREF: _silc_client_ftp_ask_name+C5j
		lea	edx, [ebp+attr]
		mov	ecx, 30h
		xor	eax, eax
		mov	filepath_0, edx
		rep stosb
		mov	[esp+14h], context_0
		mov	dword ptr [esp+10h], offset _silc_client_ftp_open_handle
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], remote_file
		mov	eax, [context_0+80h]
		mov	[esp], eax
		call	_silc_sftp_open
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [context_0+88h]
		mov	[esp+4], eax
		mov	eax, [context_0+80h]
		mov	[esp], eax
		call	_silc_sftp_close
		mov	dword ptr [context_0+88h], 0
		mov	[esp], remote_file
		call	_silc_free
		add	esp, 5Ch
		pop	context_0
		pop	remote_file
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8C0E4:				; CODE XREF: _silc_client_ftp_ask_name+11j
filepath_0 = edi			; const	char *
context_0 = ebx				; void *
		mov	eax, [context_0+74h]
		mov	[esp], eax	; char *
		call	_strdup
		mov	esi, eax
remote_file = esi			; char *
		jmp	loc_62B8C06A
_silc_client_ftp_ask_name endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_readdir_name(SilcSFTP sftp, SilcSFTPStatus status, const	SilcSFTPName name, void	*context)
_silc_client_ftp_readdir_name proc near	; DATA XREF: _silc_client_ftp_opendir_handle+A8o

var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
sftp		= dword	ptr  8
status		= dword	ptr  0Ch
name		= dword	ptr  10h
context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	eax, [ebp+status]
		mov	esi, [ebp+name]
		mov	ebx, [ebp+context]
session	= ebx				; SilcClientFtpSession
		test	eax, eax
		jz	loc_62B8C19C
status_0 = eax				; SilcSFTPStatus
name_0 = esi				; const	SilcSFTPName
		mov	edx, [session+64h]
		test	edx, edx
		jz	short loc_62B8C194
		mov	edi, [session+68h]
		mov	name_0,	[session+74h]
		mov	ecx, [session+60h]
		mov	[ebp+var_2C], ecx
		mov	ecx, [session+0Ch]
		mov	[ebp+var_1C], ecx
		cmp	status_0, 2
		jz	loc_62B8C1E0
		cmp	status_0, 3
		setz	al
		movzx	eax, al
		lea	eax, ds:1[eax*4]

loc_62B8C144:				; CODE XREF: _silc_client_ftp_readdir_name+EAj
		mov	[esp+2Ch], edi
		mov	[esp+28h], esi
		mov	ecx, [ebp+var_2C]
		mov	[esp+24h], ecx
		mov	ecx, [ebp+var_1C]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 7
		mov	eax, [session+8]
		mov	[esp+4], eax
		mov	eax, [session]
		mov	[esp], eax
		call	edx

loc_62B8C194:				; CODE XREF: _silc_client_ftp_readdir_name+1Fj
					; _silc_client_ftp_readdir_name+127j
		add	esp, 5Ch
		pop	session
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8C19C:				; CODE XREF: _silc_client_ftp_readdir_name+14j
status_0 = eax				; SilcSFTPStatus
name_0 = esi				; const	SilcSFTPName
session	= ebx				; SilcClientFtpSession
		mov	status_0, [name_0]
		mov	eax, [eax]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[session+74h], eax
		mov	eax, [name_0+8]
		mov	eax, [eax]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		mov	[session+98h], eax
		mov	[session+9Ch], edx
		mov	edi, [session+78h]
		test	edi, edi
		jz	short loc_62B8C1E8

loc_62B8C1C9:				; CODE XREF: _silc_client_ftp_readdir_name+F5j
		mov	[ebp+status], session
		mov	[ebp+sftp], 0
		add	esp, 5Ch
		pop	session
		pop	name_0
		pop	edi
		leave
		jmp	_silc_client_ftp_ask_name
; ---------------------------------------------------------------------------
status_0 = eax				; SilcSFTPStatus
session	= ebx				; SilcClientFtpSession
		align 10h

loc_62B8C1E0:				; CODE XREF: _silc_client_ftp_readdir_name+36j
		mov	al, 4
		jmp	loc_62B8C144
; ---------------------------------------------------------------------------
name_0 = esi				; const	SilcSFTPName
		align 4

loc_62B8C1E8:				; CODE XREF: _silc_client_ftp_readdir_name+CFj
		mov	eax, [session+6Ch]
		test	eax, eax
		jz	short loc_62B8C1C9
		mov	edx, [session+70h]
		mov	[esp+18h], edx
		mov	[esp+14h], session
		mov	dword ptr [esp+10h], offset _silc_client_ftp_ask_name
		mov	edx, [name_0]
		mov	edx, [edx]
		mov	[esp+0Ch], edx
		mov	edx, [session+60h]
		mov	[esp+8], edx
		mov	edx, [session+8]
		mov	[esp+4], edx
		mov	edx, [session]
		mov	[esp], edx
		call	eax
		jmp	loc_62B8C194
_silc_client_ftp_readdir_name endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_open_handle(SilcSFTP sftp, SilcSFTPStatus status, SilcSFTPHandle	handle,	void *context)
_silc_client_ftp_open_handle proc near	; DATA XREF: _silc_client_ftp_ask_name+50o

var_22C		= dword	ptr -22Ch
var_21C		= dword	ptr -21Ch
path		= byte ptr -218h
sftp		= dword	ptr  8
status		= dword	ptr  0Ch
handle		= dword	ptr  10h
context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 25Ch
		mov	eax, [ebp+status]
		mov	ebx, [ebp+context]
		test	eax, eax
		jz	loc_62B8C2DC
status_0 = eax				; SilcSFTPStatus
context_0 = ebx				; void *
		mov	edx, [context_0+64h]
		test	edx, edx
		jz	loc_62B8C2D0
		mov	edi, [context_0+68h]
		mov	esi, [context_0+74h]
		mov	ecx, [context_0+60h]
		mov	[ebp+var_22C], ecx
		mov	ecx, [context_0+0Ch]
		mov	[ebp+var_21C], ecx
		cmp	status_0, 2
		jz	loc_62B8C3F4
		cmp	status_0, 3
		setz	al
		movzx	eax, al
		lea	eax, ds:1[eax*4]

loc_62B8C27A:				; CODE XREF: _silc_client_ftp_open_handle+1D2j
		mov	[esp+2Ch], edi
		mov	[esp+28h], esi
		mov	ecx, [ebp+var_22C]
		mov	[esp+24h], ecx
		mov	ecx, [ebp+var_21C]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 7
		mov	eax, [context_0+8]
		mov	[esp+4], eax
		mov	eax, [context_0]
		mov	[esp], eax
		call	edx

loc_62B8C2D0:				; CODE XREF: _silc_client_ftp_open_handle+1Fj
					; _silc_client_ftp_open_handle+15Dj ...
		add	esp, 25Ch
		pop	context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
status_0 = eax				; SilcSFTPStatus
context_0 = ebx				; void *
		align 4

loc_62B8C2DC:				; CODE XREF: _silc_client_ftp_open_handle+14j
		lea	esi, [ebp+path]
		mov	ecx, 200h
		xor	status_0, status_0
		mov	edi, esi
		rep stosb
		mov	edx, [context_0+74h]
		mov	eax, [context_0+78h]
		test	eax, eax
		jz	loc_62B8C49C

loc_62B8C2FB:				; CODE XREF: _silc_client_ftp_open_handle+27Dj
		mov	[esp+10h], edx
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aSS ;	"%s%s"
		mov	dword ptr [esp+4], 1FFh
		mov	[esp], esi
		call	_silc_snprintf
		mov	dword ptr [esp+4], 502h
		mov	[esp], esi
		call	_silc_file_open
		mov	[context_0+0A8h], eax
		test	eax, eax
		js	loc_62B8C3FC
		mov	eax, [ebp+handle]
		mov	[context_0+8Ch], eax
		mov	[esp+18h], context_0
		mov	dword ptr [esp+14h], offset _silc_client_ftp_data
		mov	dword ptr [esp+10h], 0FBFFh
		mov	eax, [context_0+0A0h]
		mov	edx, [context_0+0A4h]
		mov	[esp+8], eax
		mov	[esp+0Ch], edx
		mov	edx, [ebp+handle]
		mov	[esp+4], edx
		mov	eax, [ebp+sftp]
		mov	[esp], eax
		call	_silc_sftp_read
		mov	eax, [context_0+64h]
		test	eax, eax
		jz	loc_62B8C2D0
		mov	edx, [context_0+68h]
		mov	[esp+2Ch], edx
		mov	edx, [context_0+74h]
		mov	[esp+28h], edx
		mov	edx, [context_0+60h]
		mov	[esp+24h], edx
		mov	edx, [context_0+0Ch]
		mov	[esp+20h], edx
		mov	edx, [context_0+98h]
		mov	ecx, [context_0+9Ch]
		mov	[esp+18h], edx
		mov	[esp+1Ch], ecx
		mov	edx, [context_0+0A0h]
		mov	ecx, [context_0+0A4h]
		mov	[esp+10h], edx
		mov	[esp+14h], ecx
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 2

loc_62B8C3DB:				; CODE XREF: _silc_client_ftp_open_handle+271j
		mov	edx, [context_0+8]
		mov	[esp+4], edx
		mov	edx, [context_0]
		mov	[esp], edx
		call	eax
		add	esp, 25Ch
		pop	context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8C3F4:				; CODE XREF: _silc_client_ftp_open_handle+40j
status_0 = eax				; SilcSFTPStatus
context_0 = ebx				; void *
		mov	al, 4
		jmp	loc_62B8C27A
; ---------------------------------------------------------------------------
		align 4

loc_62B8C3FC:				; CODE XREF: _silc_client_ftp_open_handle+10Fj
		mov	eax, [context_0]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	esi, [eax]
		call	__errno
		mov	eax, [eax]
		mov	[esp], eax	; int
		call	_strerror
		mov	[esp+14h], eax
		mov	eax, [context_0+74h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aFileSOpenFaile ; "File `%s' open failed: %s"
		mov	dword ptr [esp+8], 2
		mov	eax, [context_0+8]
		mov	[esp+4], eax
		mov	eax, [context_0]
		mov	[esp], eax
		call	esi
		mov	eax, [context_0+64h]
		test	eax, eax
		jz	loc_62B8C2D0
		mov	edx, [context_0+68h]
		mov	[esp+2Ch], edx
		mov	edx, [context_0+74h]
		mov	[esp+28h], edx
		mov	edx, [context_0+60h]
		mov	[esp+24h], edx
		mov	edx, [context_0+0Ch]
		mov	[esp+20h], edx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+0Ch], 5
		mov	dword ptr [esp+8], 7
		jmp	loc_62B8C3DB
; ---------------------------------------------------------------------------
		align 4

loc_62B8C49C:				; CODE XREF: _silc_client_ftp_open_handle+D1j
		mov	eax, offset byte_62BA873B
		jmp	loc_62B8C2FB
_silc_client_ftp_open_handle endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_data(SilcSFTP sftp, SilcSFTPStatus status, const	unsigned __int8	*data, SilcUInt32 data_len, void *context)
_silc_client_ftp_data proc near		; DATA XREF: _silc_client_ftp_open_handle+122o
					; _silc_client_ftp_data+12Ao

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
sftp		= dword	ptr  8
status		= dword	ptr  0Ch
data		= dword	ptr  10h
data_len	= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	esi, [ebp+sftp]
		mov	eax, [ebp+status]
		mov	ecx, [ebp+data]
		mov	edi, [ebp+data_len]
		mov	ebx, [ebp+context]
session	= ebx				; SilcClientFtpSession
		cmp	eax, 1
		jz	loc_62B8C55D
sftp_0 = esi				; SilcSFTP
status_0 = eax				; SilcSFTPStatus
data_0 = ecx				; const	unsigned __int8	*
data_len_0 = edi			; SilcUInt32
		test	status_0, status_0
		jz	loc_62B8C5A0
		mov	edx, [session+64h]
		test	edx, edx
		jz	loc_62B8C55D
		mov	data_len_0, [session+68h]
		mov	data_0,	[session+74h]
		mov	[ebp+var_2C], ecx
		mov	ecx, [session+60h]
		mov	[ebp+var_24], ecx
		mov	ecx, [session+0Ch]
		mov	[ebp+var_20], ecx
		cmp	status_0, 2
		jz	loc_62B8C68C
		cmp	status_0, 3
		setz	al
		movzx	eax, al
		lea	eax, ds:1[eax*4]

loc_62B8C50A:				; CODE XREF: _silc_client_ftp_data+1E6j
		mov	[esp+2Ch], edi
		mov	ecx, [ebp+var_2C]
		mov	[esp+28h], ecx
		mov	ecx, [ebp+var_24]
		mov	[esp+24h], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 7
		mov	eax, [session+8]
		mov	[esp+4], eax
		mov	eax, [session]
		mov	[esp], eax
		call	edx

loc_62B8C55D:				; CODE XREF: _silc_client_ftp_data+1Bj
					; _silc_client_ftp_data+2Ej
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [session+8Ch]
		mov	[esp+4], eax
		mov	[esp], sftp_0
		call	_silc_sftp_close
		mov	dword ptr [session+8Ch], 0
		mov	eax, [session+0A8h]
		mov	[ebp+sftp], eax
		add	esp, 5Ch
		pop	session
		pop	sftp_0
		pop	edi
		leave
		jmp	_silc_file_close
; ---------------------------------------------------------------------------
sftp_0 = esi				; SilcSFTP
status_0 = eax				; SilcSFTPStatus
data_0 = ecx				; const	unsigned __int8	*
data_len_0 = edi			; SilcUInt32
session	= ebx				; SilcClientFtpSession
		align 10h

loc_62B8C5A0:				; CODE XREF: _silc_client_ftp_data+23j
		mov	[ebp+var_20], data_len_0
		mov	[ebp+var_1C], 0
		mov	status_0, [session+0A0h]
		mov	edx, [session+0A4h]
		add	[ebp+var_20], eax
		adc	[ebp+var_1C], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_1C]
		mov	[session+0A0h],	eax
		mov	[session+0A4h],	edx
		mov	[esp+18h], session
		mov	dword ptr [esp+14h], offset _silc_client_ftp_data
		mov	dword ptr [esp+10h], 0FBFFh
		mov	[esp+8], eax
		mov	[esp+0Ch], edx
		mov	eax, [session+8Ch]
		mov	[esp+4], eax
		mov	[esp], sftp_0
		mov	[ebp+var_28], data_0
		call	_silc_sftp_read
		mov	[esp+8], data_len_0
		mov	ecx, [ebp+var_28]
		mov	[esp+4], ecx
		mov	eax, [session+0A8h]
		mov	[esp], eax
		call	_silc_file_write
		mov	eax, [session+64h]
		test	eax, eax
		jz	short loc_62B8C681
		mov	edx, [session+68h]
		mov	[esp+2Ch], edx
		mov	edx, [session+74h]
		mov	[esp+28h], edx
		mov	edx, [session+60h]
		mov	[esp+24h], edx
		mov	edx, [session+0Ch]
		mov	[esp+20h], edx
		mov	edx, [session+98h]
		mov	ecx, [session+9Ch]
		mov	[esp+18h], edx
		mov	[esp+1Ch], ecx
		mov	edx, [session+0A0h]
		mov	ecx, [session+0A4h]
		mov	[esp+10h], edx
		mov	[esp+14h], ecx
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 2
		mov	edx, [session+8]
		mov	[esp+4], edx
		mov	edx, [session]
		mov	[esp], edx
		call	eax

loc_62B8C681:				; CODE XREF: _silc_client_ftp_data+175j
		add	esp, 5Ch
		pop	session
		pop	sftp_0
		pop	data_len_0
		leave
		retn
; ---------------------------------------------------------------------------
sftp_0 = esi				; SilcSFTP
status_0 = eax				; SilcSFTPStatus
session	= ebx				; SilcClientFtpSession
		align 4

loc_62B8C68C:				; CODE XREF: _silc_client_ftp_data+4Cj
		mov	al, 4
		jmp	loc_62B8C50A
_silc_client_ftp_data endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_ftp_coder(SilcStream stream, SilcStreamStatus status, SilcBuffer	buffer,	void *context)
_silc_client_ftp_coder proc near	; DATA XREF: _silc_client_ftp_connect_completion+C8o

stream		= dword	ptr  8
status		= dword	ptr  0Ch
buffer		= dword	ptr  10h
context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	edx, [ebp+status]
		mov	eax, [ebp+buffer]
		test	edx, edx
		jnz	short loc_62B8C6B4
status_0 = edx				; SilcStreamStatus
buffer_0 = eax				; SilcBuffer
		mov	status_0, [buffer_0+4]
		cmp	[buffer_0+8], edx
		jz	short loc_62B8C6B0
		inc	edx
		mov	[buffer_0+4], edx

loc_62B8C6B0:				; CODE XREF: _silc_client_ftp_coder+16j
		mov	al, 1
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8C6B4:				; CODE XREF: _silc_client_ftp_coder+Ej
status_0 = edx				; SilcStreamStatus
buffer_0 = eax				; SilcBuffer
		dec	status_0
		jz	short loc_62B8C6BC
		xor	buffer_0, buffer_0
		leave
		retn
; ---------------------------------------------------------------------------
buffer_0 = eax				; SilcBuffer
		align 4

loc_62B8C6BC:				; CODE XREF: _silc_client_ftp_coder+21j
		mov	dword ptr [esp+0Ch], 1Dh
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], 1
		mov	[esp], buffer_0
		call	_silc_buffer_format
		not	eax
		shr	eax, 1Fh
		leave
		retn
_silc_client_ftp_coder endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_client_resolved(SilcClient client, SilcClientConnection conn, SilcStatus	status,	SilcDList clients, void	*context)
_silc_client_ftp_client_resolved proc near ; DATA XREF:	_silc_client_ftp+270o

client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
clients		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	esi, [ebp+clients]
		mov	ebx, [ebp+context]
		mov	[esp], ebx
		call	_silc_fsm_get_state_context
		test	esi, esi
		jz	short loc_62B8C724
clients_0 = esi				; SilcDList
context_0 = ebx				; void *
		mov	al, [context_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+28h], dl
		test	al, 4
		jz	short loc_62B8C714
		add	esp, 10h
		pop	context_0
		pop	clients_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8C714:				; CODE XREF: _silc_client_ftp_client_resolved+27j
clients_0 = esi				; SilcDList
context_0 = ebx				; void *
		mov	[ebp+client], context_0
		add	esp, 10h
		pop	context_0
		pop	clients_0
		leave
		jmp	_silc_fsm_continue
; ---------------------------------------------------------------------------
clients_0 = esi				; SilcDList
context_0 = ebx				; void *
		align 4

loc_62B8C724:				; CODE XREF: _silc_client_ftp_client_resolved+18j
		mov	[esp], eax
		call	_silc_packet_free
		mov	[ebp+client], context_0
		add	esp, 10h
		pop	context_0
		pop	clients_0
		leave
		jmp	_silc_fsm_finish
_silc_client_ftp_client_resolved endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 114. silc_client_file_close

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientFileError __cdecl silc_client_file_close(SilcClient	client,	SilcClientConnection conn, SilcUInt32 session_id)
		public _silc_client_file_close
_silc_client_file_close	proc near

client		= dword	ptr  8
conn		= dword	ptr  0Ch
session_id	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	edi, [ebp+client]
		mov	esi, [ebp+conn]
		mov	ecx, [ebp+session_id]
		test	edi, edi
		jz	loc_62B8C88E
client_0 = edi				; SilcClient
conn_0 = esi				; SilcClientConnection
session_id_0 = ecx			; SilcUInt32
		test	conn_0,	conn_0
		jz	loc_62B8C88E
		mov	eax, [client_0+18h]
		mov	eax, [eax+6Ch]
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [client_0+18h]
		mov	eax, [eax+6Ch]
		jmp	short loc_62B8C79C
; ---------------------------------------------------------------------------
session	= ebx				; SilcClientFtpSession
		align 4

loc_62B8C784:				; CODE XREF: _silc_client_file_close+71j
		movzx	session, word ptr [eax+0Eh]
		mov	ebx, [edx+ebx]

loc_62B8C78B:				; CODE XREF: _silc_client_file_close+7Aj
		mov	[eax+8], ebx
		mov	[eax+14h], edx
		mov	ebx, [edx]
session	= ebx				; SilcClientFtpSession
		test	session, session
		jz	short loc_62B8C7BF
		cmp	[session+60h], session_id_0
		jz	short loc_62B8C7CC

loc_62B8C79C:				; CODE XREF: _silc_client_file_close+45j
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B8C7B8
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B8C784
		movzx	session, word ptr [eax+0Ch]
		mov	ebx, [edx+ebx]
		jmp	short loc_62B8C78B
; ---------------------------------------------------------------------------

loc_62B8C7B8:				; CODE XREF: _silc_client_file_close+6Bj
session	= ebx				; SilcClientFtpSession
		mov	dword ptr [eax+14h], 0

loc_62B8C7BF:				; CODE XREF: _silc_client_file_close+59j
		mov	eax, 2

loc_62B8C7C4:				; CODE XREF: _silc_client_file_close+157j
		add	esp, 3Ch
		pop	session
		pop	conn_0
		pop	client_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8C7CC:				; CODE XREF: _silc_client_file_close+5Ej
client_0 = edi				; SilcClient
conn_0 = esi				; SilcClientConnection
session	= ebx				; SilcClientFtpSession
		mov	eax, [session+64h]
		test	eax, eax
		jz	short loc_62B8C831
		mov	edx, [session+68h]
		mov	[esp+2Ch], edx
		mov	edx, [session+74h]
		mov	[esp+28h], edx
		mov	[esp+24h], session_id_0
		mov	edx, [session+0Ch]
		mov	[esp+20h], edx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 5
		mov	edx, [session+8]
		mov	[esp+4], edx
		mov	edx, [session]
		mov	[esp], edx
		call	eax
		mov	dword ptr [session+64h], 0

loc_62B8C831:				; CODE XREF: _silc_client_file_close+95j
		mov	[esp+4], session
		mov	eax, [client_0+0Ch]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_context
		or	byte ptr [session+0ACh], 2
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1
		mov	dword ptr [esp+10h], 0
		mov	[esp+0Ch], session
		mov	dword ptr [esp+8], offset _silc_client_file_close_final
		mov	dword ptr [esp+4], 0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_add
		xor	eax, eax
		add	esp, 3Ch
		pop	session
		pop	conn_0
		pop	client_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8C88E:				; CODE XREF: _silc_client_file_close+14j
					; _silc_client_file_close+1Cj
client_0 = edi				; SilcClient
conn_0 = esi				; SilcClientConnection
session_id_0 = ecx			; SilcUInt32
		mov	eax, 1
		jmp	loc_62B8C7C4
_silc_client_file_close	endp

; Exported entry 116. silc_client_file_receive

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientFileError __cdecl silc_client_file_receive(SilcClient client, SilcClientConnection conn, SilcClientConnectionParams	*params, SilcPublicKey public_key, SilcPrivateKey private_key, SilcClientFileMonitor monitor, void *monitor_context, const char	*path, SilcUInt32 session_id, SilcClientFileAskName ask_name, void *ask_name_context)
		public _silc_client_file_receive
_silc_client_file_receive proc near

sb		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
params		= dword	ptr  10h
public_key	= dword	ptr  14h
private_key	= dword	ptr  18h
monitor		= dword	ptr  1Ch
monitor_context	= dword	ptr  20h
path		= dword	ptr  24h
session_id	= dword	ptr  28h
ask_name	= dword	ptr  2Ch
ask_name_context= dword	ptr  30h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	esi, [ebp+client]
		mov	edi, [ebp+conn]
		mov	ecx, [ebp+session_id]
		test	esi, esi
		jz	loc_62B8CB65
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
session_id_0 = ecx			; SilcUInt32
		test	conn_0,	conn_0
		jz	loc_62B8CB65
		mov	eax, [client_0+18h]
		mov	eax, [eax+6Ch]
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [client_0+18h]
		mov	eax, [eax+6Ch]
		jmp	short loc_62B8C8F8
; ---------------------------------------------------------------------------
session	= ebx				; SilcClientFtpSession
		align 10h

loc_62B8C8E0:				; CODE XREF: _silc_client_file_receive+71j
		movzx	session, word ptr [eax+0Eh]
		mov	ebx, [edx+ebx]

loc_62B8C8E7:				; CODE XREF: _silc_client_file_receive+7Aj
		mov	[eax+8], ebx
		mov	[eax+14h], edx
		mov	ebx, [edx]
session	= ebx				; SilcClientFtpSession
		test	session, session
		jz	short loc_62B8C91B
		cmp	[session+60h], session_id_0
		jz	short loc_62B8C928

loc_62B8C8F8:				; CODE XREF: _silc_client_file_receive+45j
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B8C914
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B8C8E0
		movzx	session, word ptr [eax+0Ch]
		mov	ebx, [edx+ebx]
		jmp	short loc_62B8C8E7
; ---------------------------------------------------------------------------

loc_62B8C914:				; CODE XREF: _silc_client_file_receive+6Bj
session	= ebx				; SilcClientFtpSession
		mov	dword ptr [eax+14h], 0

loc_62B8C91B:				; CODE XREF: _silc_client_file_receive+59j
		mov	eax, 2

loc_62B8C920:				; CODE XREF: _silc_client_file_receive+240j
					; _silc_client_file_receive+27Aj ...
		add	esp, 5Ch
		pop	session
		pop	client_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8C928:				; CODE XREF: _silc_client_file_receive+5Ej
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
session_id_0 = ecx			; SilcUInt32
session	= ebx				; SilcClientFtpSession
		mov	session_id_0, [session+80h]
		test	ecx, ecx
		jz	short loc_62B8C940

loc_62B8C932:				; CODE XREF: _silc_client_file_receive+ADj
		mov	eax, 3
		add	esp, 5Ch
		pop	session
		pop	client_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
session	= ebx				; SilcClientFtpSession
		align 10h

loc_62B8C940:				; CODE XREF: _silc_client_file_receive+98j
		mov	edx, [session+10h]
		test	edx, edx
		jnz	short loc_62B8C932
		mov	eax, [ebp+monitor]
		mov	[session+64h], eax
		mov	eax, [ebp+monitor_context]
		mov	[session+68h], eax
		mov	eax, [ebp+ask_name]
		mov	[session+6Ch], eax
		mov	eax, [ebp+ask_name_context]
		mov	[session+70h], eax
		mov	eax, [ebp+path]
		test	eax, eax
		jz	loc_62B8CB17
		mov	eax, [ebp+path]
		mov	[esp], eax	; char *
		call	_strdup

loc_62B8C975:				; CODE XREF: _silc_client_file_receive+281j
		mov	[session+78h], eax
		mov	eax, [session+90h]
		test	eax, eax
		jz	short loc_62B8C991
		mov	edx, [session+94h]
		test	dx, dx
		jnz	loc_62B8CB1E

loc_62B8C991:				; CODE XREF: _silc_client_file_receive+E8j
		mov	ecx, [ebp+params]
		test	ecx, ecx
		jz	loc_62B8CB7A
		mov	eax, [ebp+params]
		mov	edx, [eax+18h]
		test	edx, edx
		jz	loc_62B8CB6F

loc_62B8C9AA:				; CODE XREF: _silc_client_file_receive+2DCj
		mov	[esp+18h], session ; context
		mov	dword ptr [esp+14h], offset _silc_client_ftp_connect_completion	; callback
		mov	edx, [ebp+private_key]
		mov	[esp+10h], edx	; private_key
		mov	eax, [ebp+public_key]
		mov	[esp+0Ch], eax	; public_key
		mov	edx, [ebp+params]
		mov	[esp+8], edx	; params
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B4h]
		mov	[esp+4], eax	; schedule
		mov	[esp], client_0	; client
		call	_silc_client_listener_add
		mov	[session+10h], eax
		test	eax, eax
		jz	loc_62B8CBC8
		mov	edx, [ebp+params]
		mov	eax, [edx+1Ch]
		test	eax, eax
		jz	loc_62B8CBBD

loc_62B8C9F9:				; CODE XREF: _silc_client_file_receive+32Bj
		mov	[esp], eax	; char *
		call	_strdup
		mov	[session+90h], eax
		mov	eax, [session+10h]
		mov	[esp], eax	; listener
		call	_silc_client_listener_get_local_port
		mov	[session+94h], ax
		movzx	eax, ax
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [session+90h]
		mov	[esp], eax
		call	_silc_key_agreement_payload_encode
		mov	edx, eax
keyagr = edx				; SilcBuffer
		test	eax, eax
		jz	loc_62B8CBA0
keyagr = eax				; SilcBuffer
		mov	ecx, [keyagr+4]
		mov	dword ptr [esp+38h], 1Dh
		mov	keyagr,	[keyagr+8]
keyagr = edx				; SilcBuffer
		sub	eax, ecx
		mov	[esp+34h], eax
		mov	[esp+30h], ecx
		mov	dword ptr [esp+2Ch], 0Ch
		mov	dword ptr [esp+28h], 1
		mov	dword ptr [esp+24h], 1
		mov	dword ptr [esp+20h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	eax, [session+0Ch]
		add	eax, 38Ch
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 2
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1Bh
		mov	eax, [conn_0+3Ch]
		mov	[esp], eax
		mov	[ebp+sb], keyagr
		call	_silc_packet_send_va_ext
		mov	edx, [ebp+sb]
		mov	eax, edx	; sb
keyagr = edx				; SilcBuffer
		call	_silc_buffer_free
		mov	edx, [ebp+params]
		mov	eax, [edx+30h]
		test	eax, eax
		jnz	short loc_62B8CADD

loc_62B8CAD6:				; CODE XREF: _silc_client_file_receive+2BFj
		xor	eax, eax
		jmp	loc_62B8C920
; ---------------------------------------------------------------------------

loc_62B8CADD:				; CODE XREF: _silc_client_file_receive+23Cj
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 0
		mov	[esp+10h], eax
		mov	[esp+0Ch], session
		mov	dword ptr [esp+8], offset _silc_client_ftp_timeout
		mov	dword ptr [esp+4], 0
		mov	eax, [client_0+0Ch]
		mov	[esp], eax
		call	_silc_schedule_task_add
		xor	eax, eax
		jmp	loc_62B8C920
; ---------------------------------------------------------------------------

loc_62B8CB17:				; CODE XREF: _silc_client_file_receive+CCj
		xor	eax, eax
		jmp	loc_62B8C975
; ---------------------------------------------------------------------------

loc_62B8CB1E:				; CODE XREF: _silc_client_file_receive+F3j
		mov	[esp+1Ch], session ; context
		mov	dword ptr [esp+18h], offset _silc_client_ftp_connect_completion	; callback
		movzx	edx, dx
		mov	[esp+14h], edx	; port
		mov	[esp+10h], eax	; remote_host
		mov	edx, [ebp+private_key]
		mov	[esp+0Ch], edx	; private_key
		mov	eax, [ebp+public_key]
		mov	[esp+8], eax	; public_key
		mov	edx, [ebp+params]
		mov	[esp+4], edx	; params
		mov	[esp], client_0	; client
		call	_silc_client_connect_to_client
		mov	[session+14h], eax
		test	eax, eax
		jnz	loc_62B8CAD6

loc_62B8CB5D:				; CODE XREF: _silc_client_file_receive+306j
		mov	[esp], session
		call	_silc_free

loc_62B8CB65:				; CODE XREF: _silc_client_file_receive+14j
					; _silc_client_file_receive+1Cj
		mov	eax, 1
		jmp	loc_62B8C920
; ---------------------------------------------------------------------------

loc_62B8CB6F:				; CODE XREF: _silc_client_file_receive+10Cj
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	loc_62B8C9AA

loc_62B8CB7A:				; CODE XREF: _silc_client_file_receive+FEj
		mov	eax, [session]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	dword ptr [esp+0Ch], offset aCannotCreateLi ; "Cannot create listener for file transfe"...
		mov	dword ptr [esp+8], 2
		mov	ecx, [session+8]
		mov	[esp+4], ecx
		mov	[esp], eax
		call	dword ptr [edx]
		jmp	short loc_62B8CB5D
; ---------------------------------------------------------------------------

loc_62B8CBA0:				; CODE XREF: _silc_client_file_receive+1A2j
keyagr = eax				; SilcBuffer
		mov	keyagr,	[session+10h]
keyagr = edx				; SilcBuffer
		mov	[esp], eax	; listener
		call	_silc_client_listener_free
		mov	[esp], session
		call	_silc_free
		mov	eax, 9
		jmp	loc_62B8C920
; ---------------------------------------------------------------------------

loc_62B8CBBD:				; CODE XREF: _silc_client_file_receive+15Bj
		mov	edx, [ebp+params]
		mov	eax, [edx+18h]
		jmp	loc_62B8C9F9
; ---------------------------------------------------------------------------

loc_62B8CBC8:				; CODE XREF: _silc_client_file_receive+14Dj
		mov	eax, [client_0+18h]
		mov	eax, [eax+48h]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		call	__errno
		mov	eax, [eax]
		mov	[esp], eax	; int
		call	_strerror
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotCreate_0 ; "Cannot create listener for file transfe"...
		mov	dword ptr [esp+8], 2
		mov	[esp+4], conn_0
		mov	[esp], client_0
		call	[ebp+var_1C]
		mov	[esp], session
		call	_silc_free
		mov	eax, 9
		jmp	loc_62B8C920
_silc_client_file_receive endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 117. silc_client_file_send

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientFileError __cdecl silc_client_file_send(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry,	SilcClientConnectionParams *params, SilcPublicKey public_key, SilcPrivateKey private_key, SilcClientFileMonitor	monitor, void *monitor_context,	const char *filepath, SilcUInt32 *session_id)
		public _silc_client_file_send
_silc_client_file_send proc near

path		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
params		= dword	ptr  14h
public_key	= dword	ptr  18h
private_key	= dword	ptr  1Ch
monitor		= dword	ptr  20h
monitor_context	= dword	ptr  24h
filepath	= dword	ptr  28h
session_id	= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	edx, [ebp+client]
		test	edx, edx
		jz	loc_62B8CFE0
		mov	eax, [ebp+client_entry]
		test	eax, eax
		jz	loc_62B8CFE0
		mov	edi, [ebp+filepath]
		test	edi, edi
		jz	loc_62B8CFE0
		mov	esi, [ebp+params]
		test	esi, esi
		jz	loc_62B8CFE0
		mov	ebx, [ebp+public_key]
		test	ebx, ebx
		jz	loc_62B8CFE0
		mov	ecx, [ebp+private_key]
		test	ecx, ecx
		jz	loc_62B8CFE0
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+6Ch]
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+client]
		mov	esi, [eax+18h]
		jmp	short loc_62B8CCA6
; ---------------------------------------------------------------------------
session	= ebx				; SilcClientFtpSession
		align 4

loc_62B8CC88:				; CODE XREF: _silc_client_file_send+A6j
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62B8CC8F:				; CODE XREF: _silc_client_file_send+AFj
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	session, [edx]
		test	session, session
		jz	short loc_62B8CCCF
		mov	eax, [session+74h]
		test	eax, eax
		jnz	loc_62B8CFB4

loc_62B8CCA6:				; CODE XREF: _silc_client_file_send+71j
					; _silc_client_file_send+3B1j ...
		mov	eax, [esi+6Ch]
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B8CCC8
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B8CC88
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	short loc_62B8CC8F
; ---------------------------------------------------------------------------
		align 4

loc_62B8CCC8:				; CODE XREF: _silc_client_file_send+A0j
		mov	dword ptr [eax+14h], 0

loc_62B8CCCF:				; CODE XREF: _silc_client_file_send+85j
		mov	dword ptr [esp+4], 0
		mov	edx, [ebp+filepath]
		mov	[esp], edx
		call	_silc_file_open
		test	eax, eax
fd = eax				; int
		js	loc_62B8CFF0
		mov	[esp], fd
		call	_silc_file_close
		mov	dword ptr [esp+4], 0B0h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	session, eax
		test	eax, eax
		jz	loc_62B8CFE0
session	= eax				; SilcClientFtpSession
		mov	session, [ebp+client]
session	= ebx				; SilcClientFtpSession
		mov	edx, [eax+18h]
		mov	eax, [edx+80h]
		inc	eax
		mov	[edx+80h], ax
		movzx	eax, ax
		mov	[session+60h], eax
		mov	edx, [ebp+client]
		mov	[session], edx
		mov	eax, [ebp+conn]
		mov	[session+4], eax
		or	byte ptr [session+0ACh], 1
		mov	edx, [ebp+client_entry]
		mov	[esp+8], edx	; client_entry
		mov	[esp+4], eax	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_ref_client
		mov	[session+0Ch], eax
		mov	eax, [ebp+monitor]
		mov	[session+64h], eax
		mov	eax, [ebp+monitor_context]
		mov	[session+68h], eax
		mov	edx, [ebp+filepath]
		mov	[esp], edx	; char *
		call	_strdup
		mov	[session+74h], eax
		lea	edi, [session+18h]
		mov	ecx, 10h
		mov	esi, [ebp+params]
		rep movsd
params_0 = esi				; SilcClientConnectionParams *
		mov	eax, [ebp+public_key]
		mov	[session+58h], eax
		mov	edx, [ebp+private_key]
		mov	[session+5Ch], edx
		mov	eax, [ebp+filepath]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset aFileS ; "file://%s"
		lea	eax, [ebp+path]
		mov	[esp], eax
		call	_silc_asprintf
		test	eax, eax
		js	loc_62B8D00C
		mov	params_0, [ebp+path]
filename = esi				; char *
		mov	dword ptr [esp+4], 2Fh ; int
		mov	[esp], filename	; char *
		call	_strrchr
		test	eax, eax
		jz	short loc_62B8CDC4
		lea	filename, [eax+1]

loc_62B8CDC4:				; CODE XREF: _silc_client_file_send+1ABj
		mov	dword ptr [esp], 5
		call	_silc_sftp_fs_memory_alloc
		mov	[session+84h], eax
		mov	edx, [ebp+path]
		mov	[esp+10h], edx
		mov	[esp+0Ch], filename
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	_silc_sftp_fs_memory_add_file
		mov	edx, [ebp+filepath]
		mov	[esp], edx
		call	_silc_file_size
		mov	[session+98h], eax
		mov	[session+9Ch], edx
		mov	eax, [ebp+params]
		mov	edx, [eax+18h]
		test	edx, edx
		jz	loc_62B8D021

loc_62B8CE1E:				; CODE XREF: _silc_client_file_send+412j
		mov	[esp+18h], session ; context
		mov	dword ptr [esp+14h], offset _silc_client_ftp_connect_completion	; callback
		mov	edx, [ebp+private_key]
		mov	[esp+10h], edx	; private_key
		mov	eax, [ebp+public_key]
		mov	[esp+0Ch], eax	; public_key
		mov	edx, [ebp+params]
		mov	[esp+8], edx	; params
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B4h]
		mov	[esp+4], eax	; schedule
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_listener_add
		mov	[session+10h], eax
		test	eax, eax
		jz	loc_62B8D042
		mov	edx, [ebp+params]
		mov	eax, [edx+1Ch]
		test	eax, eax
		jz	loc_62B8D037

loc_62B8CE73:				; CODE XREF: _silc_client_file_send+429j
		mov	[esp], eax	; char *
		call	_strdup
		mov	[session+90h], eax
		mov	eax, [session+10h]
		mov	[esp], eax	; listener
		call	_silc_client_listener_get_local_port
		mov	[session+94h], ax

loc_62B8CE93:				; CODE XREF: _silc_client_file_send+41Ej
		movzx	eax, ax
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [session+90h]
		mov	[esp], eax
		call	_silc_key_agreement_payload_encode
		mov	filename, eax
keyagr = esi				; SilcBuffer
		test	eax, eax
		jz	loc_62B8CFFD
keyagr = eax				; SilcBuffer
		mov	edx, [keyagr+4]
		mov	dword ptr [esp+38h], 1Dh
		mov	keyagr,	[keyagr+8]
keyagr = esi				; SilcBuffer
		sub	eax, edx
		mov	[esp+34h], eax
		mov	[esp+30h], edx
		mov	dword ptr [esp+2Ch], 0Ch
		mov	dword ptr [esp+28h], 1
		mov	dword ptr [esp+24h], 1
		mov	dword ptr [esp+20h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	eax, [ebp+client_entry]
		add	eax, 38Ch
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 2
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1Bh
		mov	edx, [ebp+conn]
		mov	eax, [edx+3Ch]
		mov	[esp], eax
		call	_silc_packet_send_va_ext
		mov	eax, keyagr	; sb
		call	_silc_buffer_free
		mov	eax, [ebp+path]
		mov	[esp], eax
		call	_silc_free
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+6Ch]	; list
		mov	edx, session	; context
		call	_silc_dlist_add_0
		mov	keyagr,	[ebp+session_id]
		test	esi, esi
		jz	short loc_62B8CF6D
		mov	eax, [session+60h]
		mov	edx, [ebp+session_id]
		mov	[edx], eax

loc_62B8CF6D:				; CODE XREF: _silc_client_file_send+34Fj
		mov	edx, [ebp+params]
		mov	eax, [edx+30h]
		test	eax, eax
		jz	short loc_62B8CFE5
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 0
		mov	[esp+10h], eax
		mov	[esp+0Ch], session
		mov	dword ptr [esp+8], offset _silc_client_ftp_timeout
		mov	dword ptr [esp+4], 0
		mov	edx, [ebp+client]
		mov	eax, [edx+0Ch]
		mov	[esp], eax
		call	_silc_schedule_task_add
		xor	eax, eax
		jmp	short loc_62B8CFE5
; ---------------------------------------------------------------------------
		align 4

loc_62B8CFB4:				; CODE XREF: _silc_client_file_send+8Cj
		mov	edx, [ebp+filepath]
		mov	[esp+4], edx	; char *
		mov	[esp], eax	; char *
		call	_strcmp
		test	eax, eax
		jnz	loc_62B8CCA6
		mov	eax, [ebp+client_entry]
		cmp	[session+0Ch], eax
		jnz	loc_62B8CCA6
		mov	eax, 3
		jmp	short loc_62B8CFE5
; ---------------------------------------------------------------------------
session	= eax				; SilcClientFtpSession
		align 10h

loc_62B8CFE0:				; CODE XREF: _silc_client_file_send+Ej
					; _silc_client_file_send+19j ...
		mov	session, 1

loc_62B8CFE5:				; CODE XREF: _silc_client_file_send+361j
					; _silc_client_file_send+39Bj ...
session	= ebx				; SilcClientFtpSession
		add	esp, 5Ch
		pop	session
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
session	= ebx				; SilcClientFtpSession
fd = eax				; int
		align 10h

loc_62B8CFF0:				; CODE XREF: _silc_client_file_send+D0j
		mov	fd, 4
		add	esp, 5Ch
		pop	session
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8CFFD:				; CODE XREF: _silc_client_file_send+2A0j
session	= ebx				; SilcClientFtpSession
keyagr = eax				; SilcBuffer
		mov	keyagr,	[session+10h]
keyagr = esi				; SilcBuffer
		test	eax, eax
		jz	short loc_62B8D00C
		mov	[esp], eax	; listener
		call	_silc_client_listener_free

loc_62B8D00C:				; CODE XREF: _silc_client_file_send+190j
					; _silc_client_file_send+3EEj
		mov	[esp], session
		call	_silc_free
		mov	eax, 9
		add	esp, 5Ch
		pop	session
		pop	keyagr
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8D021:				; CODE XREF: _silc_client_file_send+204j
session	= ebx				; SilcClientFtpSession
filename = esi				; char *
		mov	edi, [eax+1Ch]
		test	edi, edi
		jnz	loc_62B8CE1E
		mov	eax, [session+94h]
		jmp	loc_62B8CE93
; ---------------------------------------------------------------------------

loc_62B8D037:				; CODE XREF: _silc_client_file_send+259j
		mov	edx, [ebp+params]
		mov	eax, [edx+18h]
		jmp	loc_62B8CE73
; ---------------------------------------------------------------------------

loc_62B8D042:				; CODE XREF: _silc_client_file_send+24Bj
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	filename, [eax]
		call	__errno
		mov	eax, [eax]
		mov	[esp], eax	; int
		call	_strerror
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotCreate_0 ; "Cannot create listener for file transfe"...
		mov	dword ptr [esp+8], 2
		mov	eax, [ebp+conn]
		mov	[esp+4], eax
		mov	edx, [ebp+client]
		mov	[esp], edx
		call	esi
		mov	[esp], session
		call	_silc_free
		mov	eax, 9
		jmp	loc_62B8CFE5
_silc_client_file_send endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __usercall silc_client_ftp_session_free(SilcClientFtpSession session@<eax>)
_silc_client_ftp_session_free proc near	; CODE XREF: _silc_client_ftp_connect_completion+21Aj
					; _silc_client_ftp_session_free_client:loc_62B8D604p ...

var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

session	= eax				; SilcClientFtpSession
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, session
		mov	[esp+4], session
		mov	session, [session]
session	= ebx				; SilcClientFtpSession
		mov	eax, [eax+0Ch]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_context
		mov	eax, [session]
		mov	eax, [eax+18h]
		mov	ecx, [eax+6Ch]
		mov	esi, [ecx]
		mov	eax, esi
		mov	[ecx+8], esi
		and	byte ptr [ecx+10h], 0FDh
		xor	edi, edi
		test	eax, eax
		jz	short loc_62B8D0EE
		lea	esi, [esi+0]

loc_62B8D0CC:				; CODE XREF: _silc_client_ftp_session_free+58j
		mov	edx, edi
		test	dl, dl
		jz	loc_62B8D1A8
		movzx	edx, word ptr [ecx+0Eh]
		mov	edx, [eax+edx]
		mov	[ecx+8], edx
		cmp	session, [eax]
		jz	loc_62B8D1BA

loc_62B8D0E8:				; CODE XREF: _silc_client_ftp_session_free+120j
		mov	eax, edx
		test	eax, eax
		jnz	short loc_62B8D0CC

loc_62B8D0EE:				; CODE XREF: _silc_client_ftp_session_free+33j
					; _silc_client_ftp_session_free+174j
		mov	eax, [session+14h]
		test	eax, eax
		jz	short loc_62B8D10D
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	_silc_async_abort

loc_62B8D10D:				; CODE XREF: _silc_client_ftp_session_free+5Fj
		mov	eax, [session+80h]
		test	eax, eax
		jz	short loc_62B8D12C
		test	byte ptr [session+0ACh], 1
		jz	loc_62B8D210
		mov	[esp], eax
		call	_silc_sftp_server_shutdown

loc_62B8D12C:				; CODE XREF: _silc_client_ftp_session_free+81j
					; _silc_client_ftp_session_free+184j
		mov	eax, [session+84h]
		test	eax, eax
		jz	short loc_62B8D13E
		mov	[esp], eax
		call	_silc_sftp_fs_memory_free

loc_62B8D13E:				; CODE XREF: _silc_client_ftp_session_free+A0j
		mov	eax, [session+10h]
		test	eax, eax
		jz	short loc_62B8D14D
		mov	[esp], eax	; listener
		call	_silc_client_listener_free

loc_62B8D14D:				; CODE XREF: _silc_client_ftp_session_free+AFj
		mov	eax, [session+7Ch]
		test	eax, eax
		jz	short loc_62B8D15C
		mov	[esp], eax
		call	_silc_stream_destroy

loc_62B8D15C:				; CODE XREF: _silc_client_ftp_session_free+BEj
		mov	eax, [session+0Ch]
		mov	[esp+8], eax	; client_entry
		mov	eax, [session+4]
		mov	[esp+4], eax	; conn
		mov	eax, [session]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		mov	eax, [session+90h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [session+74h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [session+78h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], session
		call	_silc_free
		add	esp, 4Ch
		pop	session
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8D1A8:				; CODE XREF: _silc_client_ftp_session_free+3Cj
session	= ebx				; SilcClientFtpSession
		movzx	edx, word ptr [ecx+0Ch]
		mov	edx, [eax+edx]
		mov	[ecx+8], edx
		cmp	session, [eax]
		jnz	loc_62B8D0E8

loc_62B8D1BA:				; CODE XREF: _silc_client_ftp_session_free+4Ej
		mov	[ebp+var_3C], esi
		test	esi, esi
		jz	short loc_62B8D1F1
		cmp	eax, esi
		jz	loc_62B8D28D
		movzx	edi, word ptr [ecx+0Ch]
		mov	[ebp+var_1C], edi
		mov	esi, [ebp+var_3C]
		mov	[ebp+var_20], ecx
		mov	ecx, edi
		jmp	short loc_62B8D1E2
; ---------------------------------------------------------------------------
		align 4

loc_62B8D1DC:				; CODE XREF: _silc_client_ftp_session_free+155j
		cmp	eax, edx
		jz	short loc_62B8D220
		mov	esi, edx

loc_62B8D1E2:				; CODE XREF: _silc_client_ftp_session_free+144j
		lea	edi, [esi+ecx]
		mov	edx, [edi]
		test	edx, edx
		jnz	short loc_62B8D1DC
		mov	[ebp+var_3C], esi
		mov	ecx, [ebp+var_20]

loc_62B8D1F1:				; CODE XREF: _silc_client_ftp_session_free+12Bj
		cmp	eax, [ecx+4]
		jz	short loc_62B8D24F

loc_62B8D1F6:				; CODE XREF: _silc_client_ftp_session_free+1B9j
		cmp	eax, [ecx+14h]
		jz	short loc_62B8D25C

loc_62B8D1FB:				; CODE XREF: _silc_client_ftp_session_free+1C4j
		cmp	eax, [ecx+18h]
		jz	short loc_62B8D268

loc_62B8D200:				; CODE XREF: _silc_client_ftp_session_free+1D2j
					; _silc_client_ftp_session_free+1DBj
		mov	[esp], eax
		call	_silc_free
		jmp	loc_62B8D0EE
; ---------------------------------------------------------------------------
		align 10h

loc_62B8D210:				; CODE XREF: _silc_client_ftp_session_free+8Aj
		mov	[esp], eax
		call	_silc_sftp_client_shutdown
		jmp	loc_62B8D12C
; ---------------------------------------------------------------------------
		align 10h

loc_62B8D220:				; CODE XREF: _silc_client_ftp_session_free+14Aj
		mov	[ebp+var_2C], edi
		mov	[ebp+var_3C], esi
		mov	ecx, [ebp+var_20]

loc_62B8D229:				; CODE XREF: _silc_client_ftp_session_free+20Aj
		mov	esi, [ebp+var_1C]
		mov	esi, [eax+esi]
		mov	[ebp+var_20], esi
		mov	edi, [ebp+var_2C]
		mov	[edi], esi
		test	esi, esi
		jz	short loc_62B8D241
		test	byte ptr [ecx+10h], 1
		jnz	short loc_62B8D274

loc_62B8D241:				; CODE XREF: _silc_client_ftp_session_free+1A5j
					; _silc_client_ftp_session_free+1EDj
		cmp	eax, [ecx+8]
		jz	short loc_62B8D283

loc_62B8D246:				; CODE XREF: _silc_client_ftp_session_free+1F7j
		sub	dword ptr [ecx+10h], 4
		cmp	eax, [ecx+4]
		jnz	short loc_62B8D1F6

loc_62B8D24F:				; CODE XREF: _silc_client_ftp_session_free+160j
		mov	edx, [ebp+var_3C]
		mov	[ecx+4], edx
		cmp	eax, [ecx+14h]
		jnz	short loc_62B8D1FB
		xchg	ax, ax

loc_62B8D25C:				; CODE XREF: _silc_client_ftp_session_free+165j
		mov	dword ptr [ecx+14h], 0
		cmp	eax, [ecx+18h]
		jnz	short loc_62B8D200

loc_62B8D268:				; CODE XREF: _silc_client_ftp_session_free+16Aj
		mov	dword ptr [ecx+18h], 0
		jmp	short loc_62B8D200
; ---------------------------------------------------------------------------
		align 4

loc_62B8D274:				; CODE XREF: _silc_client_ftp_session_free+1ABj
		movzx	edx, word ptr [ecx+0Eh]
		mov	esi, [eax+edx]
		mov	edi, [ebp+var_20]
		mov	[edi+edx], esi
		jmp	short loc_62B8D241
; ---------------------------------------------------------------------------

loc_62B8D283:				; CODE XREF: _silc_client_ftp_session_free+1B0j
		mov	esi, [ebp+var_2C]
		mov	edx, [esi]
		mov	[ecx+8], edx
		jmp	short loc_62B8D246
; ---------------------------------------------------------------------------

loc_62B8D28D:				; CODE XREF: _silc_client_ftp_session_free+12Fj
		mov	[ebp+var_2C], ecx
		movzx	edx, word ptr [ecx+0Ch]
		mov	[ebp+var_1C], edx
		mov	[ebp+var_3C], 0
		jmp	short loc_62B8D229
_silc_client_ftp_session_free endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_ftp_connect_completion(SilcClient client, SilcClientConnection conn,	SilcClientConnectionStatus status, SilcStatus error, const char	*message, void *context)
_silc_client_ftp_connect_completion proc near ;	DATA XREF: _silc_client_ftp+302o
					; _silc_client_file_receive+116o ...

var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= dword	ptr  10h
error		= dword	ptr  14h
message		= dword	ptr  18h
context		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	edx, [ebp+client]
		mov	edi, [ebp+conn]
		mov	esi, [ebp+status]
		mov	ebx, [ebp+context]
session	= ebx				; SilcClientFtpSession
		mov	[session+8], edi
		mov	dword ptr [session+14h], 0
		mov	[esp+4], session
		mov	eax, [edx+0Ch]
		mov	[esp], eax
		mov	[ebp+var_1C], edx
		call	_silc_schedule_task_del_by_context
		cmp	esi, 2
		jz	loc_62B8D43C
conn_0 = edi				; SilcClientConnection
status_0 = esi				; SilcClientConnectionStatus
		cmp	status_0, 7
		jz	loc_62B8D3E8
		test	status_0, status_0
		jz	short loc_62B8D364
		mov	eax, [session+64h]
		test	eax, eax
		jz	short loc_62B8D355
		mov	conn_0,	[session+68h]
		mov	ecx, [session+74h]
		cmp	status_0, 3
		setz	dl
		mov	status_0, edx
		and	esi, 0FFh
		add	esi, 6
		mov	[esp+2Ch], edi
		mov	[esp+28h], ecx
		mov	edx, [session+60h]
		mov	[esp+24h], edx
		mov	edx, [session+0Ch]
		mov	[esp+20h], edx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	[esp+0Ch], esi

loc_62B8D33F:				; CODE XREF: _silc_client_ftp_connect_completion+197j
		mov	dword ptr [esp+8], 7
		mov	edx, [session+8]
		mov	[esp+4], edx
		mov	edx, [session]
		mov	[esp], edx
		call	eax

loc_62B8D355:				; CODE XREF: _silc_client_ftp_connect_completion+4Cj
					; _silc_client_ftp_connect_completion+14Dj
		mov	dword ptr [session+8], 0

loc_62B8D35C:				; CODE XREF: _silc_client_ftp_connect_completion+20Bj
					; _silc_client_ftp_connect_completion+2EBj
		add	esp, 4Ch
		pop	session
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8D364:				; CODE XREF: _silc_client_ftp_connect_completion+45j
conn_0 = edi				; SilcClientConnection
status_0 = esi				; SilcClientConnectionStatus
session	= ebx				; SilcClientFtpSession
		mov	[esp+14h], session
		mov	dword ptr [esp+10h], offset _silc_client_ftp_coder
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1Bh
		mov	eax, [conn_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_stream_wrap
		mov	[session+7Ch], eax
		test	eax, eax
		mov	edx, [ebp+var_1C]
		jz	loc_62B8D514
		test	byte ptr [session+0ACh], 1
		jnz	loc_62B8D4C0
		mov	[esp+10h], session
		mov	dword ptr [esp+0Ch], offset _silc_client_ftp_error
		mov	dword ptr [esp+8], offset _silc_client_ftp_version
		mov	edx, [conn_0+54h]
		mov	edx, [edx+0B4h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	_silc_sftp_client_start
		mov	[session+80h], eax
		add	esp, 4Ch
		pop	session
		pop	status_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = edi				; SilcClientConnection
status_0 = esi				; SilcClientConnectionStatus
session	= ebx				; SilcClientFtpSession
		align 4

loc_62B8D3E8:				; CODE XREF: _silc_client_ftp_connect_completion+3Dj
		mov	eax, [session+64h]
		test	eax, eax
		jz	loc_62B8D355
		mov	edx, [session+68h]
		mov	[esp+2Ch], edx
		mov	edx, [session+74h]
		mov	[esp+28h], edx
		mov	edx, [session+60h]
		mov	[esp+24h], edx
		mov	edx, [session+0Ch]
		mov	[esp+20h], edx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+0Ch], 8
		jmp	loc_62B8D33F
; ---------------------------------------------------------------------------

loc_62B8D43C:				; CODE XREF: _silc_client_ftp_connect_completion+34j
		mov	eax, [session+64h]
		test	eax, eax
		jz	short loc_62B8D49D
		mov	edx, [session+68h]
		mov	[esp+2Ch], edx
		mov	edx, [session+74h]
		mov	[esp+28h], edx
		mov	edx, [session+60h]
		mov	[esp+24h], edx
		mov	edx, [session+0Ch]
		mov	[esp+20h], edx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 6
		mov	edx, [session+8]
		mov	[esp+4], edx
		mov	edx, [session]
		mov	[esp], edx
		call	eax

loc_62B8D49D:				; CODE XREF: _silc_client_ftp_connect_completion+1A1j
		mov	dword ptr [session+8], 0
		test	byte ptr [session+0ACh], 2
		jz	loc_62B8D35C
		mov	eax, session
		add	esp, 4Ch
		pop	session
		pop	status_0
		pop	conn_0
		leave
		jmp	_silc_client_ftp_session_free
; ---------------------------------------------------------------------------
conn_0 = edi				; SilcClientConnection
status_0 = esi				; SilcClientConnectionStatus
session	= ebx				; SilcClientFtpSession
		align 10h

loc_62B8D4C0:				; CODE XREF: _silc_client_ftp_connect_completion+108j
		mov	edx, [session+84h]
		mov	[esp+10h], edx
		mov	[esp+0Ch], session
		mov	dword ptr [esp+8], offset _silc_client_ftp_error
		mov	edx, [conn_0+54h]
		mov	edx, [edx+0B4h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	_silc_sftp_server_start
		mov	[session+80h], eax
		mov	[ebp+error], session
		mov	[ebp+status], offset _silc_client_ftp_monitor
		mov	[ebp+conn], 8
		mov	[ebp+client], eax
		add	esp, 4Ch
		pop	session
		pop	status_0
		pop	conn_0
		leave
		jmp	_silc_sftp_server_set_monitor
; ---------------------------------------------------------------------------
conn_0 = edi				; SilcClientConnection
status_0 = esi				; SilcClientConnectionStatus
session	= ebx				; SilcClientFtpSession
		align 4

loc_62B8D514:				; CODE XREF: _silc_client_ftp_connect_completion+FBj
		mov	eax, [session+64h]
		test	eax, eax
		jz	short loc_62B8D578
		mov	ecx, [session+68h]
		mov	[esp+2Ch], ecx
		mov	ecx, [session+74h]
		mov	[esp+28h], ecx
		mov	ecx, [session+60h]
		mov	[esp+24h], ecx
		mov	ecx, [session+0Ch]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 7
		mov	ecx, [session+8]
		mov	[esp+4], ecx
		mov	ecx, [session]
		mov	[esp], ecx
		call	eax
		mov	edx, [ebp+var_1C]

loc_62B8D578:				; CODE XREF: _silc_client_ftp_connect_completion+279j
		mov	[esp+4], conn_0	; conn
		mov	[esp], edx	; client
		call	_silc_client_close_connection
		mov	dword ptr [session+8], 0
		jmp	loc_62B8D35C
_silc_client_ftp_connect_completion endp

; Exported entry 123. silc_client_ftp_session_free_client

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_ftp_session_free_client(SilcClient client, SilcClientEntry client_entry)
		public _silc_client_ftp_session_free_client
_silc_client_ftp_session_free_client proc near
					; CODE XREF: _silc_client_del_client_entry+ABp

client		= dword	ptr  8
client_entry	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		mov	esi, [ebp+client]
		mov	ebx, [ebp+client_entry]
		mov	eax, [esi+18h]
		mov	eax, [eax+6Ch]
		test	eax, eax
		jz	short loc_62B8D5FF
client_0 = esi				; SilcClient
client_entry_0 = ebx			; SilcClientEntry
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0

loc_62B8D5BC:				; CODE XREF: _silc_client_ftp_session_free_client+79j
		mov	eax, [client_0+18h]
		mov	edx, [eax+6Ch]
		jmp	short loc_62B8D5DC
; ---------------------------------------------------------------------------

loc_62B8D5C4:				; CODE XREF: _silc_client_ftp_session_free_client+5Dj
		movzx	ecx, word ptr [edx+0Eh]
		mov	ecx, [eax+ecx]

loc_62B8D5CB:				; CODE XREF: _silc_client_ftp_session_free_client+66j
		mov	[edx+8], ecx
		mov	[edx+14h], eax
		mov	eax, [eax]	; session
session	= eax				; SilcClientFtpSession
		test	session, session
		jz	short loc_62B8D5FF
		cmp	[session+0Ch], client_entry_0
		jz	short loc_62B8D604

loc_62B8D5DC:				; CODE XREF: _silc_client_ftp_session_free_client+32j
		mov	session, [edx+14h]
		mov	[edx+18h], eax
		mov	eax, [edx+8]
		test	eax, eax
		jz	short loc_62B8D5F8
		test	byte ptr [edx+10h], 2
		jnz	short loc_62B8D5C4
		movzx	ecx, word ptr [edx+0Ch]
		mov	ecx, [eax+ecx]
		jmp	short loc_62B8D5CB
; ---------------------------------------------------------------------------

loc_62B8D5F8:				; CODE XREF: _silc_client_ftp_session_free_client+57j
		mov	dword ptr [edx+14h], 0

loc_62B8D5FF:				; CODE XREF: _silc_client_ftp_session_free_client+13j
					; _silc_client_ftp_session_free_client+45j
session	= eax				; SilcClientFtpSession
		pop	client_entry_0
		pop	client_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = esi				; SilcClient
client_entry_0 = ebx			; SilcClientEntry
		align 4

loc_62B8D604:				; CODE XREF: _silc_client_ftp_session_free_client+4Aj
		call	_silc_client_ftp_session_free
		jmp	short loc_62B8D5BC
_silc_client_ftp_session_free_client endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 115. silc_client_file_close_final

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_file_close_final(SilcSchedule schedule, void	*app_context, SilcTaskEvent type, SilcUInt32 fd, void *context)
		public _silc_client_file_close_final
_silc_client_file_close_final proc near	; DATA XREF: _silc_client_file_close+127o

schedule	= dword	ptr  8
app_context	= dword	ptr  0Ch
type		= dword	ptr  10h
fd		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		mov	eax, [ebx+8]
		test	eax, eax
		jz	short loc_62B8D638
context_0 = ebx				; void *
		mov	[esp+4], eax	; conn
		mov	eax, [context_0]
		mov	[esp], eax	; client
		call	_silc_client_close_connection
		mov	dword ptr [context_0+8], 0
		add	esp, 14h
		pop	context_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8D638:				; CODE XREF: _silc_client_file_close_final+Fj
context_0 = ebx				; void *
		mov	eax, context_0
		add	esp, 14h
		pop	context_0
		leave
		jmp	_silc_client_ftp_session_free
_silc_client_file_close_final endp

; Exported entry 124. silc_client_ftp_timeout

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_ftp_timeout(SilcSchedule schedule, void *app_context, SilcTaskEvent type, SilcUInt32	fd, void *context)
		public _silc_client_ftp_timeout
_silc_client_ftp_timeout proc near	; DATA XREF: _silc_client_file_receive+25Do
					; _silc_client_file_send+37Bo

schedule	= dword	ptr  8
app_context	= dword	ptr  0Ch
type		= dword	ptr  10h
fd		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	ebx, [ebp+context]
session	= ebx				; SilcClientFtpSession
		mov	eax, [session+8]
		test	eax, eax
		jz	short loc_62B8D670
		mov	[esp+4], eax	; conn
		mov	eax, [session]
		mov	[esp], eax	; client
		call	_silc_client_close_connection
		mov	dword ptr [session+8], 0
		add	esp, 34h
		pop	session
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8D670:				; CODE XREF: _silc_client_ftp_timeout+Fj
session	= ebx				; SilcClientFtpSession
		mov	eax, [session+64h]
		test	eax, eax
		jz	short loc_62B8D6D2
		mov	edx, [session+68h]
		mov	[esp+2Ch], edx
		mov	edx, [session+74h]
		mov	[esp+28h], edx
		mov	edx, [session+60h]
		mov	[esp+24h], edx
		mov	edx, [session+0Ch]
		mov	[esp+20h], edx
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+0Ch], 8
		mov	dword ptr [esp+8], 7
		mov	dword ptr [esp+4], 0
		mov	edx, [session]
		mov	[esp], edx
		call	eax

loc_62B8D6D2:				; CODE XREF: _silc_client_ftp_timeout+31j
		mov	eax, session
		add	esp, 34h
		pop	session
		leave
		jmp	_silc_client_ftp_session_free
_silc_client_ftp_timeout endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 122. silc_client_ftp_free_sessions

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_ftp_free_sessions(SilcClient	client)
		public _silc_client_ftp_free_sessions
_silc_client_ftp_free_sessions proc near

var_2C		= dword	ptr -2Ch
client		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [ebp+client]
		mov	eax, [ebx+18h]
		mov	eax, [eax+6Ch]
		test	eax, eax
		jz	loc_62B8D786
client_0 = ebx				; SilcClient
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		jmp	short loc_62B8D72C
; ---------------------------------------------------------------------------
		align 4

loc_62B8D714:				; CODE XREF: _silc_client_ftp_free_sessions+63j
		movzx	esi, word ptr [eax+0Eh]
		mov	esi, [edx+esi]

loc_62B8D71B:				; CODE XREF: _silc_client_ftp_free_sessions+6Cj
		mov	[eax+8], esi
		mov	[eax+14h], edx
		mov	eax, [edx]	; session
session	= eax				; SilcClientFtpSession
		test	session, session
		jz	short loc_62B8D757
		call	_silc_client_ftp_session_free

loc_62B8D72C:				; CODE XREF: _silc_client_ftp_free_sessions+31j
		mov	ecx, [client_0+18h]
		mov	eax, [ecx+6Ch]
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62B8D750
		test	byte ptr [eax+10h], 2
		jnz	short loc_62B8D714
		movzx	esi, word ptr [eax+0Ch]
		mov	esi, [edx+esi]
		jmp	short loc_62B8D71B
; ---------------------------------------------------------------------------
		align 10h

loc_62B8D750:				; CODE XREF: _silc_client_ftp_free_sessions+5Dj
		mov	dword ptr [eax+14h], 0

loc_62B8D757:				; CODE XREF: _silc_client_ftp_free_sessions+45j
session	= eax				; SilcClientFtpSession
		mov	edx, [ecx+6Ch]
		mov	esi, [edx]
		mov	session, esi
		mov	[edx+8], esi
		and	byte ptr [edx+10h], 0FDh
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_62B8D786
		nop

loc_62B8D76C:				; CODE XREF: _silc_client_ftp_free_sessions+A4j
		test	cl, cl
		jz	short loc_62B8D790
client_0 = ebx				; SilcClient
		movzx	client_0, word ptr [edx+0Eh]
		mov	ebx, [eax+ebx]
		mov	[edx+8], ebx
		mov	edi, [eax]
		test	edi, edi
		jz	short loc_62B8D7A0

loc_62B8D780:				; CODE XREF: _silc_client_ftp_free_sessions+BEj
		mov	eax, ebx
		test	eax, eax
		jnz	short loc_62B8D76C

loc_62B8D786:				; CODE XREF: _silc_client_ftp_free_sessions+14j
					; _silc_client_ftp_free_sessions+89j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
		align 10h

loc_62B8D790:				; CODE XREF: _silc_client_ftp_free_sessions+8Ej
		movzx	client_0, word ptr [edx+0Ch]
		mov	ebx, [eax+ebx]
		mov	[edx+8], ebx
		mov	edi, [eax]
		test	edi, edi
		jnz	short loc_62B8D780

loc_62B8D7A0:				; CODE XREF: _silc_client_ftp_free_sessions+9Ej
		mov	ecx, esi
		test	esi, esi
		jz	short loc_62B8D7C3
		cmp	eax, esi
		jz	loc_62B8D84A
		movzx	edi, word ptr [edx+0Ch]
		jmp	short loc_62B8D7BA
; ---------------------------------------------------------------------------

loc_62B8D7B4:				; CODE XREF: _silc_client_ftp_free_sessions+E1j
		cmp	eax, esi
		jz	short loc_62B8D7E4
		mov	ecx, esi

loc_62B8D7BA:				; CODE XREF: _silc_client_ftp_free_sessions+D2j
		lea	ebx, [ecx+edi]
		mov	esi, [ebx]
		test	esi, esi
		jnz	short loc_62B8D7B4

loc_62B8D7C3:				; CODE XREF: _silc_client_ftp_free_sessions+C4j
		cmp	eax, [edx+4]
		jz	short loc_62B8D807

loc_62B8D7C8:				; CODE XREF: _silc_client_ftp_free_sessions+125j
		cmp	eax, [edx+14h]
		jz	short loc_62B8D810

loc_62B8D7CD:				; CODE XREF: _silc_client_ftp_free_sessions+12Dj
		cmp	eax, [edx+18h]
		jz	short loc_62B8D81C

loc_62B8D7D2:				; CODE XREF: _silc_client_ftp_free_sessions+13Aj
		mov	[ebp+client], eax
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		jmp	_silc_free
; ---------------------------------------------------------------------------
		align 4

loc_62B8D7E4:				; CODE XREF: _silc_client_ftp_free_sessions+D6j
		mov	[ebp+var_2C], ebx

loc_62B8D7E7:				; CODE XREF: _silc_client_ftp_free_sessions+173j
		mov	esi, [eax+edi]
		mov	ebx, [ebp+var_2C]
		mov	[ebx], esi
		test	esi, esi
		jz	short loc_62B8D7F9
		test	byte ptr [edx+10h], 1
		jnz	short loc_62B8D834

loc_62B8D7F9:				; CODE XREF: _silc_client_ftp_free_sessions+111j
					; _silc_client_ftp_free_sessions+15Ej
		cmp	eax, [edx+8]
		jz	short loc_62B8D840

loc_62B8D7FE:				; CODE XREF: _silc_client_ftp_free_sessions+168j
		sub	dword ptr [edx+10h], 4
		cmp	eax, [edx+4]
		jnz	short loc_62B8D7C8

loc_62B8D807:				; CODE XREF: _silc_client_ftp_free_sessions+E6j
		mov	[edx+4], ecx
		cmp	eax, [edx+14h]
		jnz	short loc_62B8D7CD
		nop

loc_62B8D810:				; CODE XREF: _silc_client_ftp_free_sessions+EBj
		mov	dword ptr [edx+14h], 0
		cmp	eax, [edx+18h]
		jnz	short loc_62B8D7D2

loc_62B8D81C:				; CODE XREF: _silc_client_ftp_free_sessions+F0j
		mov	dword ptr [edx+18h], 0
		mov	[ebp+client], eax
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		jmp	_silc_free
; ---------------------------------------------------------------------------
		align 4

loc_62B8D834:				; CODE XREF: _silc_client_ftp_free_sessions+117j
		movzx	edi, word ptr [edx+0Eh]
		mov	ebx, [eax+edi]
		mov	[esi+edi], ebx
		jmp	short loc_62B8D7F9
; ---------------------------------------------------------------------------

loc_62B8D840:				; CODE XREF: _silc_client_ftp_free_sessions+11Cj
		mov	esi, [ebp+var_2C]
		mov	ebx, [esi]
		mov	[edx+8], ebx
		jmp	short loc_62B8D7FE
; ---------------------------------------------------------------------------

loc_62B8D84A:				; CODE XREF: _silc_client_ftp_free_sessions+C8j
		mov	[ebp+var_2C], edx
		movzx	edi, word ptr [edx+0Ch]
		xor	ecx, ecx
		jmp	short loc_62B8D7E7
_silc_client_ftp_free_sessions endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 143. silc_client_key_agreement_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_key_agreement_error(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_key_agreement_error
_silc_client_key_agreement_error proc near
					; DATA XREF: _silc_client_key_agreement:loc_62B8D895o
					; _silc_client_keyagr_resolved:loc_62B8DAACo

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+state_context]
		mov	[esp], eax
		call	_silc_packet_free
		mov	eax, 3
		leave
		retn
_silc_client_key_agreement_error endp

; Exported entry 142. silc_client_key_agreement

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_key_agreement(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_key_agreement
_silc_client_key_agreement proc	near	; DATA XREF: _silc_client_connection_st_packet:loc_62B81FB4o

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_42		= word ptr -42h
payload		= dword	ptr -40h
client		= dword	ptr -3Ch
remote_id	= SilcClientID ptr -35h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebp+state_context]
		mov	eax, [ebx+4Ch]
		mov	[ebp+client], eax
		mov	al, [edi+20h]
		mov	dl, al
		and	edx, 0FFFFFFC0h
		cmp	dl, 80h
		jz	short loc_62B8D8B0

loc_62B8D895:				; CODE XREF: _silc_client_key_agreement+6Bj
					; _silc_client_key_agreement+11Fj
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
		mov	dword ptr [esp+4], offset _silc_client_key_agreement_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax

loc_62B8D8A7:				; CODE XREF: _silc_client_key_agreement+1BFj
		add	esp, 6Ch
		pop	fsm_context_0
		pop	esi
		pop	state_context_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
		align 10h

loc_62B8D8B0:				; CODE XREF: _silc_client_key_agreement+23j
		mov	dword ptr [esp+10h], 1Dh
		lea	edx, [ebp+remote_id]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 2
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [state_context_0+18h]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jz	short loc_62B8D895
		lea	ecx, [ebp+remote_id]
		mov	[esp+8], ecx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_client_by_id
		mov	edx, eax
remote_client =	edx			; SilcClientEntry
		test	eax, eax
		jz	short loc_62B8D902
remote_client =	eax			; SilcClientEntry
		test	byte ptr [remote_client+402h], 1
		jnz	short loc_62B8D970

loc_62B8D902:				; CODE XREF: _silc_client_key_agreement+87j
		mov	[esp+8], edx	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_client
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	loc_62B8DA40

loc_62B8D928:				; CODE XREF: _silc_client_key_agreement+1FCj
		mov	[esp+14h], fsm_0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_keyagr_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		lea	ecx, [ebp+remote_id]
		mov	[esp+8], ecx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_client_by_id_resolve
		mov	dl, [fsm_0+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		shl	eax, 1
		and	eax, 2
		add	esp, 6Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	state_context_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
remote_client =	eax			; SilcClientEntry
		align 10h

loc_62B8D970:				; CODE XREF: _silc_client_key_agreement+90j
		mov	ecx, [state_context_0+0Ch]
		mov	remote_client, [state_context_0+10h]
remote_client =	edx			; SilcClientEntry
		sub	eax, ecx
		mov	[esp+4], eax
		mov	[esp], ecx
		mov	[ebp+var_4C], remote_client
		call	_silc_key_agreement_payload_parse
		mov	[ebp+payload], eax
		test	eax, eax
		mov	edx, [ebp+var_4C]
		jz	loc_62B8D895
		mov	ecx, [ebp+payload]
		mov	[esp], ecx
		mov	[ebp+var_4C], edx
		call	_silc_key_agreement_get_hostname
		test	eax, eax
		mov	edx, [ebp+var_4C]
		jz	loc_62B8DA34
		and	byte ptr [edx+402h], 0FBh

loc_62B8D9B5:				; CODE XREF: _silc_client_key_agreement+1CBj
remote_client =	edx			; SilcClientEntry
		mov	ecx, [ebp+client]
		mov	eax, [ecx+18h]
		mov	eax, [eax+48h]
		mov	eax, [eax+24h]
		mov	[ebp+var_48], eax
		mov	eax, [ebp+payload]
		mov	[esp], eax
		mov	[ebp+var_4C], remote_client
		call	_silc_key_agreement_get_port
		mov	fsm_0, eax
		mov	ecx, [ebp+payload]
		mov	[esp], ecx
		call	_silc_key_agreement_get_protocol
		mov	[ebp+var_42], ax
		mov	eax, [ebp+payload]
		mov	[esp], eax
		call	_silc_key_agreement_get_hostname
		mov	ecx, eax
		movzx	esi, si
		mov	[esp+14h], esi
		movzx	eax, [ebp+var_42]
		mov	[esp+10h], eax
		mov	[esp+0Ch], ecx
		mov	edx, [ebp+var_4C]
		mov	[esp+8], edx
remote_client =	edx			; SilcClientEntry
		mov	[esp+4], fsm_context_0
		mov	remote_client, [ebp+client]
		mov	[esp], edx
		call	[ebp+var_48]
		mov	ecx, [ebp+payload]
		mov	[esp], ecx
		call	_silc_key_agreement_payload_free
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3
		jmp	loc_62B8D8A7
; ---------------------------------------------------------------------------

loc_62B8DA34:				; CODE XREF: _silc_client_key_agreement+138j
fsm_0 =	esi				; SilcFSMObject	*
		or	byte ptr [edx+402h], 4
remote_client =	edx			; SilcClientEntry
		jmp	loc_62B8D9B5
; ---------------------------------------------------------------------------

loc_62B8DA40:				; CODE XREF: _silc_client_key_agreement+B2j
		mov	dword ptr [esp+8], 19Bh
		mov	dword ptr [esp+4], offset aClient_keyagr_ ; "client_keyagr.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_2	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B8D928
_silc_client_key_agreement endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_keyagr_resolved(SilcClient client, SilcClientConnection conn, SilcStatus status, SilcDList clients, void *context)
_silc_client_keyagr_resolved proc near	; DATA XREF: _silc_client_key_agreement+BCo

client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
clients		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		mov	eax, [ebp+clients]
		test	eax, eax
		jz	short loc_62B8DAAC

loc_62B8DA85:				; CODE XREF: _silc_client_keyagr_resolved+48j
context_0 = ebx				; void *
		mov	al, [context_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+28h], dl
		test	al, 4
		jz	short loc_62B8DA9C
		add	esp, 14h
		pop	context_0
		leave
		retn
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 4

loc_62B8DA9C:				; CODE XREF: _silc_client_keyagr_resolved+1Ej
		mov	[ebp+client], context_0
		add	esp, 14h
		pop	context_0
		leave
		jmp	_silc_fsm_continue
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 4

loc_62B8DAAC:				; CODE XREF: _silc_client_keyagr_resolved+Fj
		mov	dword ptr [esp+4], offset _silc_client_key_agreement_error
		mov	[esp], context_0
		call	_silc_fsm_next
		jmp	short loc_62B8DA85
_silc_client_keyagr_resolved endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __usercall silc_client_keyagr_free(SilcClient client@<eax>, SilcClientConnection	conn@<edx>, SilcClientEntry client_entry@<ecx>)
_silc_client_keyagr_free proc near	; CODE XREF: _silc_client_abort_key_agreement+52j
					; _silc_client_keyagr_timeout+4Cj ...

ke		= dword	ptr -1Ch

client = eax				; SilcClient
conn = edx				; SilcClientConnection
client_entry = ecx			; SilcClientEntry
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, client
		mov	esi, conn
		mov	edi, client_entry
		mov	client,	[client_entry+3F4h]
client = ebx				; SilcClient
		mov	[ebp+ke], eax
		mov	eax, [eax+8]
		mov	[esp], eax	; listener
		call	_silc_client_listener_free
conn = esi				; SilcClientConnection
client_entry = edi			; SilcClientEntry
		mov	[esp+4], client_entry
		mov	eax, [conn+54h]
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_context
		mov	edx, [ebp+ke]
		mov	eax, [edx+14h]
		test	eax, eax
		jz	short loc_62B8DB1A
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	_silc_async_abort

loc_62B8DB1A:				; CODE XREF: _silc_client_keyagr_free+40j
		mov	dword ptr [client_entry+3F4h], 0
		and	byte ptr [client_entry+402h], 0FBh
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], conn	; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	eax, [ebp+ke]
		mov	[esp], eax
		call	_silc_free
		add	esp, 2Ch
		pop	client
		pop	conn
		pop	client_entry
		leave
		retn
_silc_client_keyagr_free endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. silc_client_abort_key_agreement

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_abort_key_agreement(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry)
		public _silc_client_abort_key_agreement
_silc_client_abort_key_agreement proc near ; CODE XREF:	_silc_client_del_client_entry+C5p

client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [ebp+client]
		mov	esi, [ebp+conn]
		mov	edi, [ebp+client_entry]
		test	edi, edi
		jz	short loc_62B8DBA8
client_0 = ebx				; SilcClient
conn_0 = esi				; SilcClientConnection
client_entry_0 = edi			; SilcClientEntry
		mov	eax, [client_entry_0+3F4h]
		test	eax, eax
		jz	short loc_62B8DBA8
		mov	edx, [eax+10h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 4
		mov	[esp+8], client_entry_0
		mov	[esp+4], conn_0
		mov	[esp], client_0
		call	dword ptr [eax+0Ch]
		mov	ecx, client_entry_0
		mov	edx, conn_0
		mov	eax, client_0
		add	esp, 2Ch
		pop	client_0
		pop	conn_0
		pop	client_entry_0
		leave
		jmp	_silc_client_keyagr_free
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
conn_0 = esi				; SilcClientConnection
client_entry_0 = edi			; SilcClientEntry
		align 4

loc_62B8DBA8:				; CODE XREF: _silc_client_abort_key_agreement+14j
					; _silc_client_abort_key_agreement+1Ej
		add	esp, 2Ch
		pop	client_0
		pop	conn_0
		pop	client_entry_0
		leave
		retn
_silc_client_abort_key_agreement endp

; Exported entry 145. silc_client_keyagr_timeout

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_keyagr_timeout(SilcSchedule schedule, void *app_context, SilcTaskEvent type,	SilcUInt32 fd, void *context)
		public _silc_client_keyagr_timeout
_silc_client_keyagr_timeout proc near	; DATA XREF: _silc_client_send_key_agreement+274o

schedule	= dword	ptr  8
app_context	= dword	ptr  0Ch
type		= dword	ptr  10h
fd		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	esi, [ebp+context]
		mov	ebx, [esi+3F4h]
ke = ebx				; SilcClientKeyAgreement
		test	ke, ke
		jz	short loc_62B8DC04
context_0 = esi				; void *
		mov	eax, [ke+10h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 3
		mov	[esp+8], context_0
		mov	eax, [ke+4]
		mov	[esp+4], eax
		mov	eax, [ke]
		mov	[esp], eax
		call	dword ptr [ke+0Ch]
		mov	edx, [ke+4]
		mov	ecx, context_0
		mov	eax, [ke]
		add	esp, 20h
		pop	ke
		pop	context_0
		leave
		jmp	_silc_client_keyagr_free
; ---------------------------------------------------------------------------
context_0 = esi				; void *
ke = ebx				; SilcClientKeyAgreement
		align 4

loc_62B8DC04:				; CODE XREF: _silc_client_keyagr_timeout+13j
		add	esp, 20h
		pop	ke
		pop	context_0
		leave
		retn
_silc_client_keyagr_timeout endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 180. silc_client_perform_key_agreement_stream

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_perform_key_agreement_stream(SilcClient client, SilcClientConnection	conn, SilcClientEntry client_entry, SilcClientConnectionParams *params,	SilcPublicKey public_key, SilcPrivateKey private_key, SilcStream stream, SilcKeyAgreementCallback completion, void *context)
		public _silc_client_perform_key_agreement_stream
_silc_client_perform_key_agreement_stream proc near

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
params		= dword	ptr  14h
public_key	= dword	ptr  18h
private_key	= dword	ptr  1Ch
stream		= dword	ptr  20h
completion	= dword	ptr  24h
context		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+client]
		mov	[ebp+var_1C], eax
		mov	ebx, [ebp+conn]
		mov	edi, [ebp+client_entry]
		mov	edx, [ebp+params]
		mov	ecx, [ebp+public_key]
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+private_key]
		mov	[ebp+var_30], eax
		mov	ecx, [ebp+stream]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+completion]
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+context]
		mov	[ebp+var_28], ecx
		test	edi, edi
		jz	loc_62B8DD08
conn_0 = ebx				; SilcClientConnection
client_entry_0 = edi			; SilcClientEntry
params_0 = edx				; SilcClientConnectionParams *
		mov	ecx, [ebp+var_20]
		test	ecx, ecx
		jz	loc_62B8DD08
		mov	eax, [conn_0]
		cmp	eax, client_entry_0
		jz	loc_62B8DD34
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		mov	[ebp+var_34], params_0
		call	_silc_calloc
		mov	esi, eax
ke = esi				; SilcClientKeyAgreement
		test	eax, eax
		mov	edx, [ebp+var_34]
		jz	loc_62B8DD58
ke = eax				; SilcClientKeyAgreement
		mov	ke, [ebp+var_1C]
ke = esi				; SilcClientKeyAgreement
		mov	[ke], eax
		mov	[ke+4],	conn_0
		mov	ecx, [ebp+var_24]
		mov	[ke+0Ch], ecx
		mov	eax, [ebp+var_28]
		mov	[ke+10h], eax
		mov	[esp+8], client_entry_0	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	ecx, [ebp+var_1C]
		mov	[esp], ecx	; client
		mov	[ebp+var_34], edx
		call	_silc_client_ref_client
		mov	[client_entry_0+3F4h], ke
		mov	edx, [ebp+var_34]
		test	edx, edx
		jz	short loc_62B8DCBE
params_0 = edx				; SilcClientConnectionParams *
		mov	byte ptr [params_0+25h], 1

loc_62B8DCBE:				; CODE XREF: _silc_client_perform_key_agreement_stream+ACj
		mov	[esp+1Ch], client_entry_0 ; context
		mov	dword ptr [esp+18h], offset _silc_client_keyagr_completion ; callback
		mov	dword ptr [esp+14h], 1 ; conn_type
		mov	eax, [ebp+var_20]
		mov	[esp+10h], eax	; stream
		mov	ecx, [ebp+var_30]
		mov	[esp+0Ch], ecx	; private_key
		mov	eax, [ebp+var_2C]
		mov	[esp+8], eax	; public_key
		mov	[esp+4], params_0 ; params
		mov	params_0, [ebp+var_1C]
		mov	[esp], edx	; client
		call	_silc_client_key_exchange
		mov	[ke+14h], eax
		test	eax, eax
		jz	short loc_62B8DD7C
		add	esp, 4Ch
		pop	conn_0
		pop	ke
		pop	client_entry_0
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
client_entry_0 = edi			; SilcClientEntry
params_0 = edx				; SilcClientConnectionParams *
		align 4

loc_62B8DD08:				; CODE XREF: _silc_client_perform_key_agreement_stream+38j
					; _silc_client_perform_key_agreement_stream+43j
		mov	eax, [ebp+var_28]
		mov	[ebp+private_key], eax
		mov	[ebp+public_key], 0
		mov	[ebp+params], 1
		mov	[ebp+client_entry], client_entry_0
		mov	[ebp+conn], conn_0
		mov	params_0, [ebp+var_1C]
		mov	[ebp+client], edx

loc_62B8DD28:				; CODE XREF: _silc_client_perform_key_agreement_stream+148j
					; _silc_client_perform_key_agreement_stream+16Cj
ke = esi				; SilcClientKeyAgreement
		mov	ecx, [ebp+var_24]
		add	esp, 4Ch
		pop	conn_0
		pop	ke
		pop	client_entry_0
		leave
		jmp	ecx
; ---------------------------------------------------------------------------

loc_62B8DD34:				; CODE XREF: _silc_client_perform_key_agreement_stream+4Dj
conn_0 = ebx				; SilcClientConnection
client_entry_0 = edi			; SilcClientEntry
params_0 = edx				; SilcClientConnectionParams *
		mov	params_0, [ebp+var_28]
		mov	[ebp+private_key], edx
		mov	[ebp+public_key], 0
		mov	[ebp+params], 6
		mov	[ebp+client_entry], eax
		mov	[ebp+conn], conn_0
		mov	ecx, [ebp+var_1C]
		mov	[ebp+client], ecx
		jmp	short loc_62B8DD28
; ---------------------------------------------------------------------------
ke = eax				; SilcClientKeyAgreement
		align 4

loc_62B8DD58:				; CODE XREF: _silc_client_perform_key_agreement_stream+71j
		mov	ke, [ebp+var_28]
ke = esi				; SilcClientKeyAgreement
		mov	[ebp+private_key], eax
		mov	[ebp+public_key], 0
		mov	[ebp+params], 7
		mov	[ebp+client_entry], client_entry_0
		mov	[ebp+conn], conn_0
		mov	edx, [ebp+var_1C]
		mov	[ebp+client], edx
		jmp	short loc_62B8DD28
; ---------------------------------------------------------------------------
		align 4

loc_62B8DD7C:				; CODE XREF: _silc_client_perform_key_agreement_stream+EFj
		mov	ecx, [ebp+var_28]
		mov	[esp+14h], ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	[esp+8], client_entry_0
		mov	[esp+4], conn_0
		mov	eax, [ebp+var_1C]
		mov	[esp], eax
		call	[ebp+var_24]
		mov	ecx, client_entry_0
		mov	edx, conn_0
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	conn_0
		pop	ke
		pop	client_entry_0
		leave
		jmp	_silc_client_keyagr_free
_silc_client_perform_key_agreement_stream endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_keyagr_completion(SilcClient	client,	SilcClientConnection conn, SilcClientConnectionStatus status, SilcStatus error,	const char *message, void *context)
_silc_client_keyagr_completion proc near
					; DATA XREF: _silc_client_perform_key_agreement_stream+B6o
					; _silc_client_perform_key_agreement+D0o ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= dword	ptr  10h
error		= byte ptr  14h
message		= dword	ptr  18h
context		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [ebp+conn]
		mov	eax, [ebp+status]
		mov	esi, [ebp+context]
client_entry = esi			; SilcClientEntry
		mov	ebx, [client_entry+3F4h]
ke = ebx				; SilcClientKeyAgreement
		mov	dword ptr [ke+14h], 0
		test	eax, eax
		jnz	short loc_62B8DE38
conn_0 = edi				; SilcClientConnection
status_0 = eax				; SilcClientConnectionStatus
		mov	status_0, [conn_0+54h]
		mov	eax, [eax+0BCh]
		mov	[esp], eax
		call	_silc_ske_get_key_material
		mov	edx, [ke+10h]
		mov	[esp+14h], edx
		mov	[esp+10h], eax
keymat = eax				; SilcSKEKeyMaterial
		mov	dword ptr [esp+0Ch], 0

loc_62B8DDFF:				; CODE XREF: _silc_client_keyagr_completion+9Cj
					; _silc_client_keyagr_completion+B7j
		mov	[esp+8], client_entry
		mov	keymat,	[ke+4]
		mov	[esp+4], eax
		mov	eax, [ke]
		mov	[esp], eax
		call	dword ptr [ke+0Ch]
		test	conn_0,	conn_0
		jz	short loc_62B8DE24
		mov	[esp+4], conn_0	; conn
		mov	eax, [ke]
		mov	[esp], eax	; client
		call	_silc_client_close_connection

loc_62B8DE24:				; CODE XREF: _silc_client_keyagr_completion+5Cj
		mov	edx, [ke+4]
		mov	ecx, client_entry
		mov	eax, [ke]
		add	esp, 2Ch
		pop	ke
		pop	client_entry
		pop	conn_0
		leave
		jmp	_silc_client_keyagr_free
; ---------------------------------------------------------------------------
conn_0 = edi				; SilcClientConnection
status_0 = eax				; SilcClientConnectionStatus
client_entry = esi			; SilcClientEntry
ke = ebx				; SilcClientKeyAgreement
		align 4

loc_62B8DE38:				; CODE XREF: _silc_client_keyagr_completion+21j
		cmp	status_0, 7
		jz	short loc_62B8DE58
		mov	status_0, [ke+10h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 2
		jmp	short loc_62B8DDFF
; ---------------------------------------------------------------------------
status_0 = eax				; SilcClientConnectionStatus
		align 4

loc_62B8DE58:				; CODE XREF: _silc_client_keyagr_completion+83j
		mov	status_0, [ke+10h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 3
		jmp	short loc_62B8DDFF
_silc_client_keyagr_completion endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 179. silc_client_perform_key_agreement

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_perform_key_agreement(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry, SilcClientConnectionParams	*params, SilcPublicKey public_key, SilcPrivateKey private_key, char *hostname, int port, SilcKeyAgreementCallback completion, void *context)
		public _silc_client_perform_key_agreement
_silc_client_perform_key_agreement proc	near

var_38		= dword	ptr -38h
remote_host	= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
params		= dword	ptr  14h
public_key	= dword	ptr  18h
private_key	= dword	ptr  1Ch
hostname	= dword	ptr  20h
port		= dword	ptr  24h
completion	= dword	ptr  28h
context		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+client]
		mov	[ebp+var_1C], eax
		mov	ebx, [ebp+conn]
		mov	esi, [ebp+client_entry]
		mov	edx, [ebp+params]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+public_key]
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+private_key]
		mov	[ebp+var_30], eax
		mov	edx, [ebp+hostname]
		mov	ecx, [ebp+port]
		mov	eax, [ebp+completion]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+context]
		mov	[ebp+var_28], eax
		test	esi, esi
		jz	loc_62B8DF84
conn_0 = ebx				; SilcClientConnection
client_entry_0 = esi			; SilcClientEntry
hostname_0 = edx			; char *
port_0 = ecx				; int
		test	hostname_0, hostname_0
		jz	loc_62B8DF84
		test	port_0,	port_0
		jz	loc_62B8DF84
		mov	eax, [conn_0]
		cmp	eax, client_entry_0
		jz	loc_62B8DFB0
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		mov	[ebp+remote_host], hostname_0
		mov	[ebp+var_38], port_0
		call	_silc_calloc
		mov	edi, eax
ke = edi				; SilcClientKeyAgreement
		test	eax, eax
		mov	edx, [ebp+remote_host]
		mov	ecx, [ebp+var_38]
		jz	loc_62B8DFCC
ke = eax				; SilcClientKeyAgreement
		mov	ke, [ebp+var_1C]
ke = edi				; SilcClientKeyAgreement
		mov	[ke], eax
		mov	[ke+4],	conn_0
		mov	eax, [ebp+var_24]
		mov	[ke+0Ch], eax
		mov	eax, [ebp+var_28]
		mov	[ke+10h], eax
		mov	[esp+8], client_entry_0	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	eax, [ebp+var_1C]
		mov	[esp], eax	; client
		mov	[ebp+remote_host], edx
		mov	[ebp+var_38], ecx
		call	_silc_client_ref_client
		mov	[client_entry_0+3F4h], ke
		mov	eax, [ebp+var_20]
		test	eax, eax
		mov	edx, [ebp+remote_host]
		mov	ecx, [ebp+var_38]
		jz	short loc_62B8DF40
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax+25h], 1

loc_62B8DF40:				; CODE XREF: _silc_client_perform_key_agreement+C3j
		mov	[esp+1Ch], client_entry_0 ; context
		mov	dword ptr [esp+18h], offset _silc_client_keyagr_completion ; callback
		mov	[esp+14h], ecx	; port
		mov	[esp+10h], edx	; remote_host
		mov	edx, [ebp+var_30]
		mov	[esp+0Ch], edx	; private_key
		mov	ecx, [ebp+var_2C]
		mov	[esp+8], ecx	; public_key
		mov	eax, [ebp+var_20]
		mov	[esp+4], eax	; params
		mov	edx, [ebp+var_1C]
		mov	[esp], edx	; client
		call	_silc_client_connect_to_client
		mov	[ke+14h], eax
		test	eax, eax
		jz	short loc_62B8DFF0
		add	esp, 4Ch
		pop	conn_0
		pop	client_entry_0
		pop	ke
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
client_entry_0 = esi			; SilcClientEntry
hostname_0 = edx			; char *
port_0 = ecx				; int
		align 4

loc_62B8DF84:				; CODE XREF: _silc_client_perform_key_agreement+3Bj
					; _silc_client_perform_key_agreement+43j ...
		mov	hostname_0, [ebp+var_28]
		mov	[ebp+private_key], edx
		mov	[ebp+public_key], 0
		mov	[ebp+params], 1
		mov	[ebp+client_entry], client_entry_0

loc_62B8DF9B:				; CODE XREF: _silc_client_perform_key_agreement+153j
		mov	[ebp+conn], conn_0
		mov	port_0,	[ebp+var_1C]
		mov	[ebp+client], ecx

loc_62B8DFA4:				; CODE XREF: _silc_client_perform_key_agreement+178j
ke = edi				; SilcClientKeyAgreement
		mov	ecx, [ebp+var_24]
		add	esp, 4Ch
		pop	conn_0
		pop	client_entry_0
		pop	ke
		leave
		jmp	ecx
; ---------------------------------------------------------------------------

loc_62B8DFB0:				; CODE XREF: _silc_client_perform_key_agreement+55j
conn_0 = ebx				; SilcClientConnection
client_entry_0 = esi			; SilcClientEntry
hostname_0 = edx			; char *
port_0 = ecx				; int
		mov	hostname_0, [ebp+var_28]
		mov	[ebp+private_key], edx
		mov	[ebp+public_key], 0
		mov	[ebp+params], 6
		mov	[ebp+client_entry], eax
		jmp	short loc_62B8DF9B
; ---------------------------------------------------------------------------
ke = eax				; SilcClientKeyAgreement
		align 4

loc_62B8DFCC:				; CODE XREF: _silc_client_perform_key_agreement+7Fj
		mov	ke, [ebp+var_28]
ke = edi				; SilcClientKeyAgreement
		mov	[ebp+private_key], eax
		mov	[ebp+public_key], 0
		mov	[ebp+params], 7
		mov	[ebp+client_entry], client_entry_0
		mov	[ebp+conn], conn_0
		mov	edx, [ebp+var_1C]
		mov	[ebp+client], edx
		jmp	short loc_62B8DFA4
; ---------------------------------------------------------------------------
		align 10h

loc_62B8DFF0:				; CODE XREF: _silc_client_perform_key_agreement+105j
		mov	ecx, [ebp+var_28]
		mov	[esp+14h], ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	[esp+8], client_entry_0
		mov	[esp+4], conn_0
		mov	eax, [ebp+var_1C]
		mov	[esp], eax
		call	[ebp+var_24]
		mov	ecx, client_entry_0
		mov	edx, conn_0
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	conn_0
		pop	client_entry_0
		pop	ke
		leave
		jmp	_silc_client_keyagr_free
_silc_client_perform_key_agreement endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 200. silc_client_send_key_agreement

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_send_key_agreement(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry, SilcClientConnectionParams *params, SilcPublicKey public_key,	SilcPrivateKey private_key, SilcKeyAgreementCallback completion, void *context)
		public _silc_client_send_key_agreement
_silc_client_send_key_agreement	proc near

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
protocol	= word ptr -2Ah
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
buffer		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
params		= dword	ptr  14h
public_key	= dword	ptr  18h
private_key	= dword	ptr  1Ch
completion	= dword	ptr  20h
context		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	eax, [ebp+client]
		mov	[ebp+var_20], eax
		mov	ebx, [ebp+conn]
		mov	esi, [ebp+client_entry]
		mov	edi, [ebp+params]
		mov	ecx, [ebp+public_key]
		mov	edx, [ebp+private_key]
		mov	eax, [ebp+completion]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+context]
		mov	[ebp+var_28], eax
		test	esi, esi
		jz	loc_62B8E220
conn_0 = ebx				; SilcClientConnection
client_entry_0 = esi			; SilcClientEntry
params_0 = edi				; SilcClientConnectionParams *
public_key_0 = ecx			; SilcPublicKey
private_key_0 =	edx			; SilcPrivateKey
		mov	eax, [conn_0+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B8E220
		mov	eax, [client_entry_0+3F4h]
		test	eax, eax
		jz	short loc_62B8E098
		mov	private_key_0, [ebp+var_28]
		mov	[ebp+private_key], edx
		mov	[ebp+public_key], 0
		mov	[ebp+params], 5

loc_62B8E08C:				; CODE XREF: _silc_client_send_key_agreement+2BCj
					; _silc_client_send_key_agreement+2E4j	...
		mov	ecx, [ebp+var_24]
		add	esp, 5Ch
		pop	conn_0
		pop	client_entry_0
		pop	params_0
		leave
		jmp	ecx
; ---------------------------------------------------------------------------

loc_62B8E098:				; CODE XREF: _silc_client_send_key_agreement+4Aj
conn_0 = ebx				; SilcClientConnection
client_entry_0 = esi			; SilcClientEntry
params_0 = edi				; SilcClientConnectionParams *
public_key_0 = ecx			; SilcPublicKey
private_key_0 =	edx			; SilcPrivateKey
		mov	eax, [conn_0]
		cmp	eax, client_entry_0
		jz	loc_62B8E315
		test	params_0, params_0
		jz	loc_62B8E233
		mov	eax, [params_0+18h]
		test	eax, eax
		jz	loc_62B8E228

loc_62B8E0B5:				; CODE XREF: _silc_client_send_key_agreement+201j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		mov	[ebp+var_30], private_key_0
		mov	[ebp+var_34], public_key_0
		call	_silc_calloc
		mov	[ebp+buffer], eax
		test	eax, eax
		mov	edx, [ebp+var_30]
		mov	ecx, [ebp+var_34]
		jz	loc_62B8E2C8
		mov	[esp+18h], client_entry_0 ; context
		mov	dword ptr [esp+14h], offset _silc_client_keyagr_completion ; callback
		mov	[esp+10h], edx	; private_key
		mov	[esp+0Ch], ecx	; public_key
		mov	[esp+8], params_0 ; params
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B4h]
		mov	[esp+4], eax	; schedule
		mov	eax, [ebp+var_20]
		mov	[esp], eax	; client
		call	_silc_client_listener_add
		mov	edx, [ebp+buffer]
		mov	[edx+8], eax
		test	eax, eax
		jz	loc_62B8E2F0
		mov	edx, [params_0+18h]
local_ip = edx				; char *
		movzx	eax, byte ptr [params_0+14h]
		mov	[ebp+protocol],	ax
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+buffer]
		mov	[ecx], eax
		mov	[ecx+4], conn_0
		mov	eax, [ebp+var_24]
		mov	[ecx+0Ch], eax
		mov	eax, [ebp+var_28]
		mov	[ecx+10h], eax
		mov	[esp+8], client_entry_0	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	ecx, [ebp+var_20]
		mov	[esp], ecx	; client
		mov	[ebp+var_30], local_ip
		call	_silc_client_ref_client
		mov	eax, [ebp+buffer]
		mov	[client_entry_0+3F4h], eax
		or	byte ptr [client_entry_0+402h],	4
		movzx	eax, [ebp+protocol]
		mov	edx, [ebp+var_30]

loc_62B8E16D:				; CODE XREF: _silc_client_send_key_agreement+20Bj
local_ip = edx				; char *
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	[esp], local_ip
		call	_silc_key_agreement_payload_encode
		mov	[ebp+buffer], eax
		test	eax, eax
		jz	loc_62B8E33A
		mov	eax, [ebp+buffer]
		mov	edx, [eax+4]
		mov	dword ptr [esp+28h], 0
		mov	dword ptr [esp+24h], 0
		mov	eax, [eax+8]
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		lea	eax, [client_entry_0+38Ch]
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 2
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 19h
		mov	eax, [conn_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_send_ext
		test	al, al
		jz	short loc_62B8E23C
		test	params_0, params_0
		jz	short loc_62B8E1FF
		mov	eax, [params_0+30h]
		test	eax, eax
		jnz	loc_62B8E288

loc_62B8E1FF:				; CODE XREF: _silc_client_send_key_agreement+1C6j
					; _silc_client_send_key_agreement+295j
		mov	edx, [ebp+buffer]
		mov	eax, [edx]
		mov	[esp], eax
		call	_silc_free
		mov	ecx, [ebp+buffer]
		mov	[ebp+client], ecx

loc_62B8E212:				; CODE XREF: _silc_client_send_key_agreement+257j
		add	esp, 5Ch
		pop	conn_0
		pop	client_entry_0
		pop	params_0
		leave
		jmp	_silc_free
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
client_entry_0 = esi			; SilcClientEntry
params_0 = edi				; SilcClientConnectionParams *
public_key_0 = ecx			; SilcPublicKey
private_key_0 =	edx			; SilcPrivateKey
		align 10h

loc_62B8E220:				; CODE XREF: _silc_client_send_key_agreement+2Cj
					; _silc_client_send_key_agreement+3Cj
		add	esp, 5Ch
		pop	conn_0
		pop	client_entry_0
		pop	params_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8E228:				; CODE XREF: _silc_client_send_key_agreement+83j
conn_0 = ebx				; SilcClientConnection
client_entry_0 = esi			; SilcClientEntry
params_0 = edi				; SilcClientConnectionParams *
		mov	eax, [params_0+1Ch]
		test	eax, eax
		jnz	loc_62B8E0B5

loc_62B8E233:				; CODE XREF: _silc_client_send_key_agreement+78j
		xor	eax, eax
		xor	private_key_0, private_key_0
local_ip = edx				; char *
		jmp	loc_62B8E16D
; ---------------------------------------------------------------------------

loc_62B8E23C:				; CODE XREF: _silc_client_send_key_agreement+1C2j
		mov	eax, [ebp+var_28]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	[esp+8], client_entry_0
		mov	[esp+4], conn_0
		mov	edx, [ebp+var_20]
		mov	[esp], edx
		call	[ebp+var_24]
		mov	ecx, client_entry_0 ; client_entry
		mov	edx, conn_0	; conn
		mov	eax, [ebp+var_20] ; client
		call	_silc_client_keyagr_free
		mov	ecx, [ebp+buffer]
		mov	eax, [ecx]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [ebp+buffer]
		mov	[ebp+client], eax
		jmp	short loc_62B8E212
; ---------------------------------------------------------------------------
		align 4

loc_62B8E288:				; CODE XREF: _silc_client_send_key_agreement+1CDj
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 0
		mov	[esp+10h], eax
		mov	[esp+0Ch], client_entry_0
		mov	dword ptr [esp+8], offset _silc_client_keyagr_timeout
		mov	dword ptr [esp+4], 0
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_add
		jmp	loc_62B8E1FF
; ---------------------------------------------------------------------------
		align 4

loc_62B8E2C8:				; CODE XREF: _silc_client_send_key_agreement+AEj
		mov	eax, [ebp+var_28]
		mov	[ebp+private_key], eax
		mov	[ebp+public_key], 0
		mov	[ebp+params], 7
		mov	[ebp+client_entry], client_entry_0
		mov	[ebp+conn], conn_0
		mov	edx, [ebp+var_20]
		mov	[ebp+client], edx
		jmp	loc_62B8E08C
; ---------------------------------------------------------------------------
		align 10h

loc_62B8E2F0:				; CODE XREF: _silc_client_send_key_agreement+ECj
		mov	ecx, [ebp+var_28]
		mov	[ebp+private_key], ecx
		mov	[ebp+public_key], 0
		mov	[ebp+params], 7
		mov	[ebp+client_entry], client_entry_0
		mov	[ebp+conn], conn_0
		mov	eax, [ebp+var_20]
		mov	[ebp+client], eax
		jmp	loc_62B8E08C
; ---------------------------------------------------------------------------

loc_62B8E315:				; CODE XREF: _silc_client_send_key_agreement+70j
public_key_0 = ecx			; SilcPublicKey
private_key_0 =	edx			; SilcPrivateKey
		mov	private_key_0, [ebp+var_28]
		mov	[ebp+private_key], edx
		mov	[ebp+public_key], 0
		mov	[ebp+params], 6
		mov	[ebp+client_entry], eax
		mov	[ebp+conn], conn_0
		mov	public_key_0, [ebp+var_20]
		mov	[ebp+client], ecx
		jmp	loc_62B8E08C
; ---------------------------------------------------------------------------

loc_62B8E33A:				; CODE XREF: _silc_client_send_key_agreement+15Aj
		mov	edx, [ebp+var_28]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 7
		mov	[esp+8], client_entry_0
		mov	[esp+4], conn_0
		mov	ecx, [ebp+var_20]
		mov	[esp], ecx
		call	[ebp+var_24]
		mov	ecx, client_entry_0
		mov	edx, conn_0
		mov	eax, [ebp+var_20]
		add	esp, 5Ch
		pop	conn_0
		pop	client_entry_0
		pop	params_0
		leave
		jmp	_silc_client_keyagr_free
_silc_client_send_key_agreement	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 153. silc_client_listener_get_local_port

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 __cdecl silc_client_listener_get_local_port(SilcClientListener listener)
		public _silc_client_listener_get_local_port
_silc_client_listener_get_local_port proc near ; CODE XREF: _silc_client_file_receive+175p
					; _silc_client_file_send+273p

listener	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+listener]
		mov	eax, [eax+30h]
		leave
		retn
_silc_client_listener_get_local_port endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 152. silc_client_listener_free

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_listener_free(SilcClientListener listener)
		public _silc_client_listener_free
_silc_client_listener_free proc	near	; CODE XREF: _silc_client_file_receive+30Ep
					; _silc_client_file_send+3F3p ...

listener	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+listener]
		mov	eax, [ebx+58h]
		test	eax, eax
		jz	short loc_62B8E39D
listener_0 = ebx			; SilcClientListener
		mov	[esp], eax
		call	_silc_net_close_listener

loc_62B8E39D:				; CODE XREF: _silc_client_listener_free+Fj
		mov	eax, [listener_0+5Ch]
		mov	[esp], eax
		call	_silc_packet_stream_destroy
		mov	[ebp+listener],	listener_0
		add	esp, 14h
		pop	listener_0
		leave
		jmp	_silc_free
_silc_client_listener_free endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_listener_verify_key_cb(SilcBool success, void *context)
_silc_client_listener_verify_key_cb proc near
					; DATA XREF: _silc_client_listener_verify_key+63o

success		= dword	ptr  8
context		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		mov	edx, [ebx+4]
		mov	ecx, [ebx+8]
		cmp	byte ptr [ebp+success],	1
		sbb	eax, eax
		and	eax, 8
		mov	[esp+8], ecx
		mov	[esp+4], eax
		mov	eax, [ebx]
		mov	[esp], eax
		call	edx
		mov	[ebp+success], ebx
		add	esp, 14h
		pop	ebx
		leave
		jmp	_silc_free
_silc_client_listener_verify_key_cb endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_listener_verify_key(SilcSKE ske, SilcPublicKey public_key, void *context, SilcSKEVerifyCbCompletion completion, void	*completion_context)
_silc_client_listener_verify_key proc near
					; DATA XREF: _silc_client_listener_new_connection+163o

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ske		= dword	ptr  8
public_key	= dword	ptr  0Ch
context		= dword	ptr  10h
completion	= dword	ptr  14h
completion_context= dword ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	edx, [ebp+ske]
		mov	eax, [ebp+public_key]
		mov	[ebp+var_1C], eax
		mov	ebx, [ebp+context]
		mov	ecx, [ebp+completion]
		mov	edi, [ebp+completion_context]
		mov	esi, [ebx+4Ch]
client = esi				; SilcClient
		mov	eax, [ebx+54h]
		cmp	dword ptr [eax+4], 0
		jz	short loc_62B8E41D
ske_0 =	edx				; SilcSKE
context_0 = ebx				; void *
completion_0 = ecx			; SilcSKEVerifyCbCompletion
completion_context_0 = edi		; void *
		cmp	byte ptr [eax+8], 0
		jz	short loc_62B8E47C

loc_62B8E41D:				; CODE XREF: _silc_client_listener_verify_key+25j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		mov	[ebp+var_20], ske_0
		mov	[ebp+var_24], completion_0
		call	_silc_calloc
		test	eax, eax
		mov	edx, [ebp+var_20]
		mov	ecx, [ebp+var_24]
		jz	short loc_62B8E490
		mov	[eax], edx
		mov	[eax+4], ecx
		mov	[eax+8], completion_context_0
		mov	edx, [client+18h]
		mov	edx, [edx+48h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], offset _silc_client_listener_verify_key_cb
		mov	eax, [ebp+var_1C]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 1
		mov	[esp+4], context_0
		mov	[esp], client
		call	dword ptr [edx+1Ch]
		add	esp, 3Ch
		pop	context_0
		pop	client
		pop	completion_context_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8E47C:				; CODE XREF: _silc_client_listener_verify_key+2Bj
ske_0 =	edx				; SilcSKE
context_0 = ebx				; void *
completion_0 = ecx			; SilcSKEVerifyCbCompletion
completion_context_0 = edi		; void *
client = esi				; SilcClient
		mov	[ebp+context], completion_context_0
		mov	[ebp+public_key], 8

loc_62B8E486:				; CODE XREF: _silc_client_listener_verify_key+ADj
		add	esp, 3Ch
		pop	context_0
		pop	client
		pop	completion_context_0
		leave
		jmp	ecx
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
completion_context_0 = edi		; void *
client = esi				; SilcClient
		align 10h

loc_62B8E490:				; CODE XREF: _silc_client_listener_verify_key+4Fj
		mov	[ebp+context], completion_context_0
		mov	[ebp+public_key], 8
		mov	[ebp+ske], edx
		jmp	short loc_62B8E486
_silc_client_listener_verify_key endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 151. silc_client_listener_add

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcClientListener __cdecl silc_client_listener_add(SilcClient client, SilcSchedule schedule,	SilcClientConnectionParams *params, SilcPublicKey public_key, SilcPrivateKey private_key, SilcClientConnectCallback callback, void *context)
		public _silc_client_listener_add
_silc_client_listener_add proc near	; CODE XREF: _silc_client_file_receive+143p
					; _silc_client_file_send+241p ...

var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
sock		= dword	ptr -1Ch
client		= dword	ptr  8
schedule	= dword	ptr  0Ch
params		= dword	ptr  10h
public_key	= dword	ptr  14h
private_key	= dword	ptr  18h
callback	= dword	ptr  1Ch
context		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	edx, [ebp+client]
		test	edx, edx
		jnz	short loc_62B8E4BC

loc_62B8E4B0:				; CODE XREF: _silc_client_listener_add+21j
					; _silc_client_listener_add+28j ...
listener = ebx				; SilcClientListener
stream = esi				; SilcStream
		xor	listener, listener

loc_62B8E4B2:				; CODE XREF: _silc_client_listener_add+56j
					; _silc_client_listener_add+F6j ...
		mov	eax, listener
		add	esp, 5Ch
		pop	listener
		pop	stream
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8E4BC:				; CODE XREF: _silc_client_listener_add+Ej
client_0 = edx				; SilcClient
		mov	esi, [ebp+schedule]
		test	esi, esi
		jz	short loc_62B8E4B0
		mov	ebx, [ebp+params]
		test	ebx, ebx
		jz	short loc_62B8E4B0
		mov	eax, [ebp+params]
		mov	ecx, [eax+18h]
		test	ecx, ecx
		jz	loc_62B8E694

loc_62B8E4D8:				; CODE XREF: _silc_client_listener_add+1FFj
		mov	dword ptr [esp+4], 60h
		mov	dword ptr [esp], 1
		mov	[ebp+var_30], client_0
		call	_silc_calloc
		mov	ebx, eax
listener = ebx				; SilcClientListener
		test	eax, eax
		mov	edx, [ebp+var_30]
		jz	short loc_62B8E4B2
listener = eax				; SilcClientListener
		mov	[listener], edx
		mov	ecx, [ebp+schedule]
		mov	[listener+4], ecx
		mov	listener, [ebp+callback]
listener = ebx				; SilcClientListener
		mov	[listener+8], eax
		mov	eax, [ebp+context]
		mov	[listener+0Ch],	eax
		lea	edi, [listener+10h]
		mov	ecx, 10h
		mov	esi, [ebp+params]
		rep movsd
params_0 = esi				; SilcClientConnectionParams *
		mov	eax, [ebp+public_key]
		mov	[listener+50h],	eax
		mov	eax, [ebp+private_key]
		mov	[listener+54h],	eax
		mov	params_0, [ebp+params]
		cmp	byte ptr [esi+14h], 0
		jnz	loc_62B8E5C0
client_0 = edx				; SilcClient
private_key_0 =	eax			; SilcPrivateKey
		mov	ecx, [ebp+params]
		mov	private_key_0, [ecx+20h]
		mov	esi, [ecx+1Ch]
		test	esi, esi
		jz	loc_62B8E6AC
		add	ecx, 1Ch

loc_62B8E546:				; CODE XREF: _silc_client_listener_add+212j
		mov	[esp+1Ch], listener
		mov	dword ptr [esp+18h], offset _silc_client_listener_tcp_accept
		mov	esi, [ebp+schedule]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 1
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 1
		mov	[esp], ecx
		mov	[ebp+var_30], client_0
		call	_silc_net_tcp_create_listener
		mov	[listener+58h],	eax
		test	eax, eax
		mov	edx, [ebp+var_30]
		jz	loc_62B8E737
		mov	edx, [ebp+params]
		mov	edx, [edx+20h]
		test	edx, edx
		jnz	loc_62B8E4B2
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	_silc_net_listener_get_port
		movzx	edx, word ptr [eax]
ports =	eax				; SilcUInt16 *
		mov	[listener+30h],	edx
		mov	[esp], ports
		call	_silc_free
		jmp	loc_62B8E4B2
; ---------------------------------------------------------------------------
client_0 = edx				; SilcClient
private_key_0 =	eax			; SilcPrivateKey
		align 10h

loc_62B8E5C0:				; CODE XREF: _silc_client_listener_add+8Cj
		mov	ecx, [esi+20h]
		mov	private_key_0, [esi+1Ch]
		test	eax, eax
		jz	loc_62B8E6A4

loc_62B8E5CE:				; CODE XREF: _silc_client_listener_add+207j
		mov	edi, [ebp+schedule]
		mov	[esp+10h], edi
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ecx
		mov	[esp], eax
		mov	[ebp+var_30], client_0
		call	_silc_net_udp_connect
		mov	esi, eax
stream = esi				; SilcStream
		mov	[esp+8], eax
		mov	[esp+4], edi
		mov	edx, [ebp+var_30]
		mov	eax, [edx+18h]
		mov	eax, [eax+50h]
		mov	[esp], eax
		call	_silc_packet_stream_create
		mov	[listener+5Ch],	eax
		test	eax, eax
		mov	edx, [ebp+var_30]
		jz	loc_62B8E6B7
		mov	dword ptr [esp+14h], 0FFFFFFFFh
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0F4240h
		mov	[esp+8], listener
		mov	dword ptr [esp+4], offset _silc_client_listener_stream_cb
		mov	[esp], eax
		call	_silc_packet_stream_link
		mov	edx, [ebp+params]
		mov	edi, [edx+20h]
		test	edi, edi
		jnz	loc_62B8E4B2
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		lea	eax, [ebp+sock]
		mov	[esp+4], eax
		mov	[esp], stream
		call	_silc_socket_stream_get_info
		mov	eax, [ebp+sock]
		mov	[esp], eax
		call	_silc_net_get_local_port
		movzx	eax, ax
		mov	[listener+30h],	eax
		jmp	loc_62B8E4B2
; ---------------------------------------------------------------------------

loc_62B8E694:				; CODE XREF: _silc_client_listener_add+32j
client_0 = edx				; SilcClient
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_62B8E4B0
		jmp	loc_62B8E4D8
; ---------------------------------------------------------------------------

loc_62B8E6A4:				; CODE XREF: _silc_client_listener_add+128j
listener = ebx				; SilcClientListener
		mov	eax, [esi+18h]
		jmp	loc_62B8E5CE
; ---------------------------------------------------------------------------

loc_62B8E6AC:				; CODE XREF: _silc_client_listener_add+9Dj
		mov	ecx, [ebp+params]
		add	ecx, 18h
		jmp	loc_62B8E546
; ---------------------------------------------------------------------------

loc_62B8E6B7:				; CODE XREF: _silc_client_listener_add+177j
stream = esi				; SilcStream
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	eax, [eax]
		mov	[ebp+var_2C], eax
		call	__errno
		mov	eax, [eax]
		mov	[esp], eax	; int
		call	_strerror
		mov	ecx, [ebp+params]
		mov	ecx, [ecx+20h]
		mov	[ebp+var_3C], ecx
		mov	edi, [ebp+params]
		mov	ecx, [edi+1Ch]
		test	ecx, ecx
		mov	edx, [ebp+var_30]
		jz	loc_62B8E79A

loc_62B8E6EB:				; CODE XREF: _silc_client_listener_add+2FDj
		mov	[esp+18h], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+14h], eax
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], offset aCannotCreateUd ; "Cannot create UDP listener on %s	on por"...
		mov	dword ptr [esp+8], 2
		mov	dword ptr [esp+4], 0
		mov	[esp], edx
		call	[ebp+var_2C]
		mov	[esp], listener	; listener
		call	_silc_client_listener_free
		test	stream,	stream
		jz	loc_62B8E4B0
		mov	[esp], stream
		call	_silc_stream_destroy
		xor	listener, listener
		jmp	loc_62B8E4B2
; ---------------------------------------------------------------------------

loc_62B8E737:				; CODE XREF: _silc_client_listener_add+E8j
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	eax, [eax]
		mov	[ebp+var_2C], eax
		call	__errno
		mov	eax, [eax]
		mov	[esp], eax	; int
		call	_strerror
		mov	edi, [ebp+params]
		mov	esi, [edi+20h]
		mov	ecx, [edi+1Ch]
		test	ecx, ecx
		mov	edx, [ebp+var_30]
		jz	short loc_62B8E7A2

loc_62B8E761:				; CODE XREF: _silc_client_listener_add+305j
		mov	[esp+18h], eax
		mov	[esp+14h], esi
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], offset aCannotCreate_1 ; "Cannot create listener on %s on port %d"...
		mov	dword ptr [esp+8], 2
		mov	dword ptr [esp+4], 0
		mov	[esp], edx
		call	[ebp+var_2C]
		mov	[esp], listener	; listener
		call	_silc_client_listener_free
		xor	listener, listener
		jmp	loc_62B8E4B2
; ---------------------------------------------------------------------------

loc_62B8E79A:				; CODE XREF: _silc_client_listener_add+245j
stream = esi				; SilcStream
		mov	ecx, [edi+18h]
		jmp	loc_62B8E6EB
; ---------------------------------------------------------------------------

loc_62B8E7A2:				; CODE XREF: _silc_client_listener_add+2BFj
		mov	ecx, [edi+18h]
		jmp	short loc_62B8E761
_silc_client_listener_add endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __usercall silc_client_listener_new_connection(SilcClientListener listener@<eax>, SilcPacketStream stream@<edx>)
_silc_client_listener_new_connection proc near ; CODE XREF: _silc_client_udp_accept+61p
					; _silc_client_listener_tcp_accept+37j

var_3C		= dword	ptr -3Ch
params		= SilcSKEParamsStruct ptr -30h
ip_0		= dword	ptr -24h
hostname	= dword	ptr -20h
port		= word ptr -1Ah

listener = eax				; SilcClientListener
stream = edx				; SilcPacketStream
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, listener
		mov	edi, [listener]
client = edi				; SilcClient
		mov	[ebp+hostname],	0
		mov	[ebp+ip_0], 0
		mov	[esp], stream
		mov	[ebp+var_3C], stream
		call	_silc_packet_stream_get_stream
listener = ebx				; SilcClientListener
		lea	ecx, [ebp+port]
		mov	[esp+10h], ecx
		lea	ecx, [ebp+ip_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+hostname]
		mov	[esp+8], ecx
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	_silc_socket_stream_get_info
		mov	ecx, [ebp+ip_0]
		test	ecx, ecx
		mov	edx, [ebp+var_3C]
		jz	loc_62B8E958
		mov	ax, [ebp+port]
		test	ax, ax
		jz	loc_62B8E958
		mov	esi, [ebp+hostname]
		test	esi, esi
		jz	loc_62B8E99C

loc_62B8E819:				; CODE XREF: _silc_client_listener_new_connection+1F9j
		mov	ecx, [listener+0Ch]
		mov	[esp+24h], ecx	; context
		mov	ecx, [listener+8]
		mov	[esp+20h], ecx	; callback
		movzx	eax, ax
		mov	[esp+1Ch], eax	; port
		mov	[esp+18h], esi	; remote_host
		mov	eax, [listener+54h]
		mov	[esp+14h], eax	; private_key
		mov	eax, [listener+50h]
		mov	[esp+10h], eax	; public_key
		lea	eax, [listener+10h]
		mov	[esp+0Ch], eax	; params
		mov	dword ptr [esp+8], 0 ; connect
		mov	dword ptr [esp+4], 1 ; conn_type
		mov	[esp], client	; client
		mov	[ebp+var_3C], edx
		call	_silc_client_add_connection
		mov	esi, eax
conn = esi				; SilcClientConnection
		test	eax, eax
		mov	edx, [ebp+var_3C]
		jz	loc_62B8E9DC
conn = eax				; SilcClientConnection
		mov	[conn+3Ch], edx
stream = edx				; SilcPacketStream
		mov	conn, [conn+54h]
conn = esi				; SilcClientConnection
		mov	stream,	[listener+4]
		mov	[eax+0B4h], edx
		mov	[esp+4], conn
		mov	eax, [conn+3Ch]
		mov	[esp], eax
		call	_silc_packet_set_context
		mov	edx, [conn+54h]
		mov	[esp+14h], listener
		mov	eax, [listener+54h]
		mov	[esp+10h], eax
		mov	eax, [listener+50h]
		mov	[esp+0Ch], eax
		mov	eax, [listener+14h]
		mov	[esp+8], eax
		mov	eax, [edx+0B4h]
		mov	[esp+4], eax
		mov	eax, [client+10h]
		mov	[esp], eax
		mov	[ebp+var_3C], edx
		call	_silc_ske_alloc
		mov	edx, [ebp+var_3C]
		mov	[edx+0BCh], eax
		mov	eax, [conn+54h]
		mov	eax, [eax+0BCh]
		test	eax, eax
		jz	loc_62B8E9A8
		mov	edx, [client+18h]
		mov	edx, [edx+70h]
		mov	[ebp+params.version], edx
		mov	[ebp+params.flags], 4
		cmp	byte ptr [listener+24h], 0
		jz	short loc_62B8E8FF
		mov	[ebp+params.flags], 5
		mov	edx, [listener+30h]
		mov	[ebp+params.session_port], dx

loc_62B8E8FF:				; CODE XREF: _silc_client_listener_new_connection+147j
		mov	[esp+0Ch], conn
		mov	dword ptr [esp+8], offset _silc_client_listener_completion
		mov	dword ptr [esp+4], offset _silc_client_listener_verify_key
		mov	[esp], eax
		call	_silc_ske_set_callbacks
		mov	listener, [conn+54h]
		lea	eax, [ebp+params]
		mov	[esp+8], eax
		mov	eax, [conn+3Ch]
		mov	[esp+4], eax
		mov	eax, [ebx+0BCh]
		mov	[esp], eax
		call	_silc_ske_responder
		mov	[ebx+0FCh], eax
		mov	eax, [conn+54h]
		mov	client,	[eax+0FCh]
		test	edi, edi
		jz	short loc_62B8E9A8

loc_62B8E94D:				; CODE XREF: _silc_client_listener_new_connection+22Cj
					; _silc_client_listener_new_connection+26Cj
listener = ebx				; SilcClientListener
client = edi				; SilcClient
		add	esp, 6Ch
		pop	listener
		pop	conn
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
listener = ebx				; SilcClientListener
client = edi				; SilcClient
		align 4

loc_62B8E958:				; CODE XREF: _silc_client_listener_new_connection+53j
					; _silc_client_listener_new_connection+60j
		mov	eax, [listener+0Ch]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], 0
		mov	[esp], client
		mov	[ebp+var_3C], edx
		call	dword ptr [listener+8]
		mov	edx, [ebp+var_3C]
		mov	[esp], edx
stream = edx				; SilcPacketStream
		call	_silc_packet_stream_destroy
		add	esp, 6Ch
		pop	listener
		pop	esi
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
listener = ebx				; SilcClientListener
client = edi				; SilcClient
		align 4

loc_62B8E99C:				; CODE XREF: _silc_client_listener_new_connection+6Bj
		mov	[ebp+hostname],	ecx
		mov	esi, ecx
		jmp	loc_62B8E819
; ---------------------------------------------------------------------------
conn = esi				; SilcClientConnection
		align 4

loc_62B8E9A8:				; CODE XREF: _silc_client_listener_new_connection+12Dj
					; _silc_client_listener_new_connection+1A3j
		mov	eax, [conn+48h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 3
		mov	[esp+4], conn
		mov	eax, [conn+4Ch]
		mov	[esp], eax
		call	dword ptr [conn+44h]
		jmp	loc_62B8E94D
; ---------------------------------------------------------------------------
conn = eax				; SilcClientConnection
		align 4

loc_62B8E9DC:				; CODE XREF: _silc_client_listener_new_connection+C1j
		mov	conn, [listener+0Ch]
conn = esi				; SilcClientConnection
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], 0
		mov	[esp], client
		call	dword ptr [listener+8]
		mov	edx, [ebp+var_3C]
		mov	[esp], edx
stream = edx				; SilcPacketStream
		call	_silc_packet_stream_destroy
		jmp	loc_62B8E94D
_silc_client_listener_new_connection endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_udp_accept(SilcPacketEngine engine, SilcPacketStream stream, SilcPacket packet, void *callback_context, void *stream_context)
_silc_client_udp_accept	proc near	; DATA XREF: .data:_silc_client_listener_stream_cbo

ip_0		= dword	ptr -10h
port		= word ptr -0Ah
engine		= dword	ptr  8
stream		= dword	ptr  0Ch
packet		= dword	ptr  10h
callback_context= dword	ptr  14h
stream_context	= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	ebx, [ebp+packet]
		cmp	byte ptr [ebx+22h], 0Dh
		jz	short loc_62B8EA3C

loc_62B8EA2C:				; CODE XREF: _silc_client_udp_accept+38j
					; _silc_client_udp_accept+5Aj
packet_0 = ebx				; SilcPacket
packet_stream =	eax			; SilcPacketStream
		mov	[esp], packet_0
		call	_silc_packet_free
		mov	al, 1
		add	esp, 24h
		pop	packet_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8EA3C:				; CODE XREF: _silc_client_udp_accept+Ej
packet_0 = ebx				; SilcPacket
		lea	eax, [ebp+port]
		mov	[esp+8], eax
		lea	eax, [ebp+ip_0]
		mov	[esp+4], eax
		mov	[esp], packet_0
		call	_silc_packet_get_sender
		test	al, al
		jz	short loc_62B8EA2C
		mov	[esp+0Ch], packet_0
		movzx	eax, [ebp+port]
		mov	[esp+8], eax
		mov	eax, [ebp+ip_0]
		mov	[esp+4], eax
		mov	eax, [ebp+stream]
		mov	[esp], eax
		call	_silc_packet_stream_add_remote
		test	eax, eax
packet_stream =	eax			; SilcPacketStream
		jz	short loc_62B8EA2C
		mov	edx, packet_stream ; stream
		mov	packet_stream, [ebp+callback_context] ;	listener
		call	_silc_client_listener_new_connection
		mov	al, 1
		add	esp, 24h
		pop	packet_0
		leave
		retn
_silc_client_udp_accept	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_listener_tcp_accept(SilcNetStatus status, SilcStream	stream,	void *context)
_silc_client_listener_tcp_accept proc near ; DATA XREF:	_silc_client_listener_add+AAo

status		= dword	ptr  8
stream		= dword	ptr  0Ch
context		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	esi, [ebp+stream]
		mov	ebx, [ebp+context]
		mov	[esp+8], esi
		mov	eax, [ebx+4]
		mov	[esp+4], eax
		mov	eax, [ebx]
		mov	eax, [eax+18h]
		mov	eax, [eax+50h]
		mov	[esp], eax
		call	_silc_packet_stream_create
		test	eax, eax
packet_stream =	eax			; SilcPacketStream
		jz	short loc_62B8EAC8
stream_0 = esi				; SilcStream
context_0 = ebx				; void *
		mov	edx, packet_stream
		mov	packet_stream, context_0
		add	esp, 10h
		pop	context_0
		pop	stream_0
		leave
		jmp	_silc_client_listener_new_connection
; ---------------------------------------------------------------------------

loc_62B8EAC8:				; CODE XREF: _silc_client_listener_tcp_accept+2Bj
stream_0 = esi				; SilcStream
context_0 = ebx				; void *
packet_stream =	eax			; SilcPacketStream
		mov	[ebp+status], stream_0
		add	esp, 10h
		pop	context_0
		pop	stream_0
		leave
		jmp	_silc_stream_destroy
_silc_client_listener_tcp_accept endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_listener_completion(SilcSKE ske, SilcSKEStatus status, SilcSKESecurityProperties prop, SilcSKEKeyMaterial keymat, SilcSKERekeyMaterial rekey, void *context)
_silc_client_listener_completion proc near
					; DATA XREF: _silc_client_listener_new_connection+15Bo

hmac_receive	= dword	ptr -28h
hmac_send	= dword	ptr -24h
receive_key	= dword	ptr -20h
send_key	= dword	ptr -1Ch
ske		= dword	ptr  8
status		= dword	ptr  0Ch
prop		= dword	ptr  10h
keymat		= dword	ptr  14h
rekey		= dword	ptr  18h
context		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, [ebp+status]
		mov	ebx, [ebp+context]
		test	eax, eax
		jz	short loc_62B8EB34
status_0 = eax				; SilcSKEStatus
context_0 = ebx				; void *
		mov	edx, [context_0+44h]
		mov	edi, [context_0+48h]
		mov	ecx, [context_0+54h]
		mov	esi, [ecx+10Ch]
		mov	cl, [ecx+12Ch]
		cmp	status_0, 11h
		setz	al
		movzx	eax, al
		lea	eax, [eax+eax*2+4]
		mov	[esp+14h], edi
		mov	[esp+10h], esi
		movzx	ecx, cl
		mov	[esp+0Ch], ecx
		mov	[esp+8], eax
		mov	[esp+4], context_0
		mov	eax, [context_0+4Ch]
		mov	[esp], eax
		call	edx
		add	esp, 3Ch
		pop	context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8EB34:				; CODE XREF: _silc_client_listener_completion+11j
status_0 = eax				; SilcSKEStatus
context_0 = ebx				; void *
		mov	status_0, [context_0+54h]
		add	eax, 0ECh
		mov	[esp+1Ch], eax
		lea	eax, [ebp+hmac_receive]
		mov	[esp+18h], eax
		lea	eax, [ebp+hmac_send]
		mov	[esp+14h], eax
		lea	eax, [ebp+receive_key]
		mov	[esp+10h], eax
		lea	eax, [ebp+send_key]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+prop]
		mov	[esp+8], eax
		mov	eax, [ebp+keymat]
		mov	[esp+4], eax
		mov	eax, [ebp+ske]
		mov	[esp], eax
		call	_silc_ske_set_keys
		test	al, al
		jz	short loc_62B8EBE0
		mov	dword ptr [esp+14h], 0
		mov	eax, [ebp+hmac_receive]
		mov	[esp+10h], eax
		mov	eax, [ebp+hmac_send]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+receive_key]
		mov	[esp+8], eax
		mov	eax, [ebp+send_key]
		mov	[esp+4], eax
		mov	eax, [context_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_set_keys
		test	al, al
		jz	short loc_62B8EBE0
		mov	eax, [context_0+48h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], context_0
		mov	eax, [context_0+4Ch]
		mov	[esp], eax
		call	dword ptr [context_0+44h]
		add	esp, 3Ch
		pop	context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8EBE0:				; CODE XREF: _silc_client_listener_completion+9Fj
					; _silc_client_listener_completion+D2j
context_0 = ebx				; void *
		mov	eax, [context_0+48h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 4
		mov	[esp+4], context_0
		mov	eax, [context_0+4Ch]
		mov	[esp], eax
		call	dword ptr [context_0+44h]
		add	esp, 3Ch
		pop	context_0
		pop	esi
		pop	edi
		leave
		retn
_silc_client_listener_completion endp

; Exported entry 177. silc_client_notify_watch

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_watch(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_notify_watch
_silc_client_notify_watch proc near	; DATA XREF: _silc_client_notify:loc_62B92350o

var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= byte ptr -78h
var_5B		= byte ptr -5Bh
var_5A		= byte ptr -5Ah
var_59		= byte ptr -59h
var_58		= dword	ptr -58h
var_52		= word ptr -52h
args		= dword	ptr -50h
ntype		= word ptr -4Ah
id		= SilcID ptr -48h
tmp_nick	= dword	ptr -28h
public_key	= dword	ptr -24h
tmp_len		= dword	ptr -20h
pk_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 9Ch
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebx+4Ch]
client = edi				; SilcClient
		mov	eax, [ebp+state_context]
		mov	esi, [eax+4]
payload	= esi				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_52], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	[ebp+public_key], 0
		mov	dword ptr [esp+10h], 0
		lea	edx, [ebp+id]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jnz	short loc_62B8ECA8
fsm_context_0 =	ebx			; void *
		xor	payload, payload

out:					; CODE XREF: _silc_client_notify_watch+14Ej
					; _silc_client_notify_watch+158j ...
client_entry = esi			; SilcClientEntry ; client_entry
tmp = eax				; unsigned __int8 *
mode = edx				; SilcUInt32
		mov	[esp+8], client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 9Ch
		pop	fsm_context_0
		pop	client_entry
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
client = edi				; SilcClient
payload	= esi				; SilcNotifyPayload
		align 4

loc_62B8ECA8:				; CODE XREF: _silc_client_notify_watch+5Fj
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id
		mov	payload, eax
client_entry = esi			; SilcClientEntry
		test	eax, eax
		jz	short loc_62B8ECCA
client_entry = eax			; SilcClientEntry
		test	byte ptr [client_entry+402h], 1
		jnz	short loc_62B8ED40

loc_62B8ECCA:				; CODE XREF: _silc_client_notify_watch+ABj
		mov	[esp+8], esi	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
client_entry = esi			; SilcClientEntry
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B8EEF8

loc_62B8ECF3:				; CODE XREF: _silc_client_notify_watch+310j
		mov	eax, [ebp+state_context]
		mov	[esp+14h], eax	; context
		mov	dword ptr [esp+10h], offset _silc_client_notify_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id_resolve
		mov	ecx, [ebp+fsm]
		mov	dl, [ecx+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		shl	eax, 1
		and	eax, 2
		add	esp, 9Ch
		pop	fsm_context_0
		pop	client_entry
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
client = edi				; SilcClient
client_entry = eax			; SilcClientEntry
		align 10h

loc_62B8ED40:				; CODE XREF: _silc_client_notify_watch+B4j
		lea	edx, [ebp+tmp_len]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 3
		mov	client_entry, [ebp+args]
client_entry = esi			; SilcClientEntry
		mov	[esp], eax
		mov	[ebp+var_80], edx
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_80]
		jz	out
		cmp	[ebp+tmp_len], 4
		jnz	out
		mov	cl, [tmp]
		mov	[ebp+var_78], cl
		mov	cl, [tmp+1]
		mov	[ebp+var_5B], cl
		mov	cl, [tmp+2]
		mov	[ebp+var_5A], cl
		mov	al, [tmp+3]
		mov	[ebp+var_59], al
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 4
		mov	eax, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	loc_62B8EF52
		cmp	[ebp+tmp_len], 2
		jnz	out
		movzx	edx, byte ptr [tmp+1]
		mov	[ebp+ntype], dx
		movzx	tmp, byte ptr [tmp]
		shl	eax, 8
		or	[ebp+ntype], ax
		movzx	ecx, [ebp+ntype]
		mov	[ebp+var_7C], ecx

loc_62B8EDCB:				; CODE XREF: _silc_client_notify_watch+34Bj
tmp = eax				; unsigned __int8 *
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	tmp, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_arg_type
		mov	[ebp+var_58], eax
		test	eax, eax
		jz	short loc_62B8EE34
		mov	[ebp+tmp_nick],	0
		lea	eax, [ebp+tmp_nick]
		mov	[esp+0Ch], eax	; ret_nick
		mov	[esp+8], client_entry ;	nickname
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_nickname_parse
		mov	eax, [ebp+tmp_nick]
		test	eax, eax
		jz	short loc_62B8EE2C
		mov	[esp+4], eax
		mov	edx, [ebp+var_58]
		mov	[esp], edx
		call	_silc_utf8_strcasecmp
		test	al, al
		jnz	loc_62B8EF64
		mov	eax, [ebp+tmp_nick]

loc_62B8EE2C:				; CODE XREF: _silc_client_notify_watch+1FCj
					; _silc_client_notify_watch+35Aj
		mov	[esp], eax
		call	_silc_free

loc_62B8EE34:				; CODE XREF: _silc_client_notify_watch+1D7j
		lea	eax, [ebp+pk_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 5
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		call	_silc_argument_get_arg_type
		test	eax, eax
pk = eax				; unsigned __int8 *
		jz	loc_62B8EF73
		mov	ecx, [client_entry+3B0h]
		test	ecx, ecx
		jz	loc_62B8EF7E

loc_62B8EE64:				; CODE XREF: _silc_client_notify_watch+365j
					; _silc_client_notify_watch+394j
		movzx	edx, [ebp+var_59]
mode = edx				; SilcUInt32
		mov	al, [ebp+var_78]
		shl	eax, 18h
		or	mode, eax
		movzx	eax, [ebp+var_5B]
		shl	eax, 10h
		or	mode, eax
		movzx	eax, [ebp+var_5A]
		shl	eax, 8
		or	mode, eax
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	[ebp+args], eax
		mov	[esp+1Ch], ecx
		mov	eax, [ebp+var_7C]
		mov	[esp+18h], eax
		mov	[esp+14h], mode
		mov	ecx, [ebp+var_58]
		mov	[esp+10h], ecx
		mov	[esp+0Ch], client_entry
		movzx	eax, [ebp+var_52]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		mov	[ebp+var_80], mode
		mov	type, [ebp+args]
		call	dword ptr [eax+0Ch]
		mov	edx, [ebp+var_80]
		mov	[client_entry+3ACh], edx
mode = edx				; SilcUInt32
		cmp	[ebp+ntype], 4
		jz	short loc_62B8EF29
		cmp	[ebp+ntype], 0Bh
		jz	short loc_62B8EF29
		cmp	[ebp+ntype], 0Dh
		jz	short loc_62B8EF29

loc_62B8EEDE:				; CODE XREF: _silc_client_notify_watch+33Cj
		mov	eax, [ebp+public_key]
		test	eax, eax
		jz	out
		mov	[esp], eax
		call	_silc_pkcs_public_key_free
		jmp	out
; ---------------------------------------------------------------------------
		align 4

loc_62B8EEF8:				; CODE XREF: _silc_client_notify_watch+D9j
		mov	dword ptr [esp+8], 612h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B8ECF3
; ---------------------------------------------------------------------------

loc_62B8EF29:				; CODE XREF: _silc_client_notify_watch+2BAj
					; _silc_client_notify_watch+2C1j ...
mode = edx				; SilcUInt32 ; client_entry
		mov	[esp+8], client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_remove_from_channels
		and	byte ptr [client_entry+402h], 0FEh
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_del_client
		jmp	short loc_62B8EEDE
; ---------------------------------------------------------------------------

loc_62B8EF52:				; CODE XREF: _silc_client_notify_watch+18Ej
tmp = eax				; unsigned __int8 *
		mov	[ebp+var_7C], 0
		mov	[ebp+ntype], 0
		jmp	loc_62B8EDCB
; ---------------------------------------------------------------------------

loc_62B8EF64:				; CODE XREF: _silc_client_notify_watch+20Fj
		mov	eax, [ebp+tmp_nick]
		mov	[ebp+var_58], 0
		jmp	loc_62B8EE2C
; ---------------------------------------------------------------------------

loc_62B8EF73:				; CODE XREF: _silc_client_notify_watch+23Cj
					; _silc_client_notify_watch+382j
pk = eax				; unsigned __int8 *
		mov	ecx, [client_entry+3B0h]
		jmp	loc_62B8EE64
; ---------------------------------------------------------------------------

loc_62B8EF7E:				; CODE XREF: _silc_client_notify_watch+24Aj
		lea	edx, [ebp+public_key]
		mov	[esp+8], edx
		mov	edx, [ebp+pk_len]
		mov	[esp+4], edx
		mov	[esp], pk
		call	_silc_public_key_payload_decode
		test	al, al
		jz	short loc_62B8EF73
		mov	ecx, [ebp+public_key]
		mov	[client_entry+3B0h], ecx
		mov	[ebp+public_key], 0
		jmp	loc_62B8EE64
_silc_client_notify_watch endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 164. silc_client_notify_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_error(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_notify_error
_silc_client_notify_error proc near	; DATA XREF: _silc_client_notify:loc_62B92368o

client_id	= dword	ptr -54h
var_50		= byte ptr -50h
var_4A		= word ptr -4Ah
id		= SilcID ptr -3Ch
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebx+4Ch]
client = edi				; SilcClient
		mov	eax, [ebp+state_context]
		mov	esi, [eax+4]
payload	= esi				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_4A], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	payload, eax
args = esi				; SilcArgumentPayload
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 1
		mov	[esp], args
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	loc_62B8F0D4

loc_62B8EFFA:				; CODE XREF: _silc_client_notify_error+12Ej
fsm_context_0 =	ebx			; void *
		mov	dl, [tmp]
error =	edx				; SilcStatus
		cmp	dl, 16h
		jz	short loc_62B8F040

loc_62B8F001:				; CODE XREF: _silc_client_notify_error+DBj
					; _silc_client_notify_error+E3j ...
client_entry = esi			; SilcClientEntry
		mov	tmp, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		movzx	error, dl
		mov	[esp+0Ch], error
		movzx	error, [ebp+var_4A]
type = edx				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		call	dword ptr [eax+0Ch]

out:					; CODE XREF: _silc_client_notify_error+C2j
					; _silc_client_notify_error+128j
tmp = eax				; unsigned __int8 *
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	tmp, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	client_entry
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8F040:				; CODE XREF: _silc_client_notify_error+4Fj
fsm_context_0 =	ebx			; void *
client = edi				; SilcClient
args = esi				; SilcArgumentPayload
tmp = eax				; unsigned __int8 *
error =	edx				; SilcStatus
		mov	dword ptr [esp+10h], 0
		lea	ecx, [ebp+id]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], args
		mov	[ebp+var_50], dl
		mov	[ebp+client_id], ecx
		call	_silc_argument_get_decoded
		test	al, al
		mov	ecx, [ebp+client_id]
		jz	short out
		mov	[esp+8], ecx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id
		mov	args, eax
client_entry = esi			; SilcClientEntry
		test	eax, eax
		mov	dl, [ebp+var_50]
		jz	loc_62B8F001
client_entry = eax			; SilcClientEntry
		cmp	client_entry, [fsm_context_0]
		jz	loc_62B8F001
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_remove_from_channels
client_entry = esi			; SilcClientEntry
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_del_client
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	dl, [ebp+var_50]
		jmp	loc_62B8F001
; ---------------------------------------------------------------------------
args = esi				; SilcArgumentPayload
tmp = eax				; unsigned __int8 *
		align 4

loc_62B8F0D4:				; CODE XREF: _silc_client_notify_error+44j
		cmp	[ebp+tmp_len], 1
		jnz	out
		jmp	loc_62B8EFFA
_silc_client_notify_error endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 170. silc_client_notify_motd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_motd(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_motd
_silc_client_notify_motd proc near	; DATA XREF: _silc_client_notify:loc_62B923ECo

var_2A		= word ptr -2Ah
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebx+4Ch]
client = edi				; SilcClient
		mov	eax, [ebp+state_context]
		mov	esi, [eax+4]
payload	= esi				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_2A], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		lea	edx, [ebp+tmp_len]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
args = eax				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	short out
fsm_context_0 =	ebx			; void *
		mov	edx, [fsm_context_0+4Ch]
		mov	edx, [edx+18h]
		mov	edx, [edx+48h]
		mov	[esp+0Ch], tmp
		movzx	tmp, [ebp+var_2A]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		call	dword ptr [edx+0Ch]

out:					; CODE XREF: _silc_client_notify_motd+42j
tmp = eax				; unsigned __int8 *
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	tmp, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 3Ch
		pop	fsm_context_0
		pop	payload
		pop	client
		leave
		retn
_silc_client_notify_motd endp

; Exported entry 172. silc_client_notify_none

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_none(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_none
_silc_client_notify_none proc near	; DATA XREF: _silc_client_notify:loc_62B924E8o

var_1A		= word ptr -1Ah
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebx+4Ch]
client = edi				; SilcClient
		mov	eax, [ebp+state_context]
		mov	esi, [eax+4]
payload	= esi				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_1A], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	edx, [ebx+4Ch]
		mov	edx, [edx+18h]
		mov	edx, [edx+48h]
		mov	payload, [edx+0Ch]
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
args = eax				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		mov	[esp+0Ch], eax
		movzx	eax, [ebp+var_1A]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], ebx
		mov	[esp], client
		call	esi
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	client
		leave
		retn
_silc_client_notify_none endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_notify_resolved(SilcClient client, SilcClientConnection conn, SilcStatus status, SilcDList entries, void *context)
_silc_client_notify_resolved proc near	; DATA XREF: _silc_client_notify_watch+E6o
					; _silc_client_notify_killed+28Do ...

var_1C		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
entries		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+client]
		mov	edi, [ebp+conn]
		mov	edx, [ebp+entries]
		mov	ebx, [ebp+context]
		mov	cl, [ebp+status]
		mov	eax, [ebx+10h]
		test	eax, eax
		jz	short loc_62B8F20C
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
status_0 = ecx				; SilcStatus
entries_0 = edx				; SilcDList
context_0 = ebx				; void *
		test	byte ptr [eax+402h], 1
		jz	short loc_62B8F24C

loc_62B8F20C:				; CODE XREF: _silc_client_notify_resolved+1Dj
					; _silc_client_notify_resolved+79j
		test	entries_0, entries_0
		jz	short loc_62B8F28F

loc_62B8F210:				; CODE XREF: _silc_client_notify_resolved+A9j
					; _silc_client_notify_resolved+B0j ...
		mov	eax, [context_0+0Ch]
		test	eax, eax
		jz	short loc_62B8F230
		mov	word ptr [eax+17Ch], 0
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_channel

loc_62B8F230:				; CODE XREF: _silc_client_notify_resolved+31j
		mov	eax, [context_0+8]
		mov	dl, [eax+28h]
		mov	cl, dl
		and	ecx, 0FFFFFFFBh
		mov	[eax+28h], cl
		and	edx, 4
		jz	short loc_62B8F2B4
		add	esp, 2Ch
		pop	context_0
		pop	client_0
		pop	conn_0
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = esi				; SilcClient
conn_0 = edi				; SilcClientConnection
status_0 = ecx				; SilcStatus
entries_0 = edx				; SilcDList
context_0 = ebx				; void *
		align 4

loc_62B8F24C:				; CODE XREF: _silc_client_notify_resolved+26j
		cmp	cl, 36h
		jnz	short loc_62B8F25F
		mov	eax, [context_0+14h]
		inc	eax
		mov	[context_0+14h], eax
		cmp	eax, 3E8h
		jbe	short loc_62B8F20C

loc_62B8F25F:				; CODE XREF: _silc_client_notify_resolved+6Bj
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	eax, [context_0+8]
		mov	[esp], eax
		mov	[ebp+var_1C], entries_0
		call	_silc_fsm_next
		mov	eax, [context_0+10h]
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], conn_0	; conn
		mov	[esp], client_0	; client
		call	_silc_client_unref_client
		mov	edx, [ebp+var_1C]
		test	edx, edx
		jnz	short loc_62B8F210

loc_62B8F28F:				; CODE XREF: _silc_client_notify_resolved+2Aj
entries_0 = edx				; SilcDList
		mov	eax, [context_0+10h]
		test	eax, eax
		jnz	loc_62B8F210
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	eax, [context_0+8]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62B8F210
; ---------------------------------------------------------------------------
		align 4

loc_62B8F2B4:				; CODE XREF: _silc_client_notify_resolved+5Dj
		mov	[ebp+client], eax
		add	esp, 2Ch
		pop	context_0
		pop	client_0
		pop	conn_0
		leave
		jmp	_silc_fsm_continue_sync
_silc_client_notify_resolved endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_notify_wait_continue(SilcClient client, SilcClientConnection conn, SilcCommand command, SilcStatus status, SilcStatus error, void *context, va_list ap)
_silc_client_notify_wait_continue proc near ; DATA XREF: _silc_client_notify_invite+E0o
					; _silc_client_notify_leave+EAo ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= byte ptr  10h
status		= byte ptr  14h
error		= byte ptr  18h
context		= dword	ptr  1Ch
ap		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	al, [ebp+status]
		lea	edx, [eax-1]
		cmp	dl, 8
		ja	short loc_62B8F2E0
status_0 = eax				; SilcStatus
		cmp	al, 3
		jz	short loc_62B8F2E0

loc_62B8F2D9:				; CODE XREF: _silc_client_notify_wait_continue+30j
		mov	al, 1
		leave
		retn
; ---------------------------------------------------------------------------
status_0 = eax				; SilcStatus
		align 10h

loc_62B8F2E0:				; CODE XREF: _silc_client_notify_wait_continue+Fj
					; _silc_client_notify_wait_continue+13j
		mov	status_0, [ebp+context]
		mov	eax, [eax+8]
		mov	dl, [eax+28h]
		mov	cl, dl
		and	ecx, 0FFFFFFFBh
		mov	[eax+28h], cl
		and	edx, 4
		jnz	short loc_62B8F2D9
		mov	[esp], eax
		call	_silc_fsm_continue_sync
		mov	al, 1
		leave
		retn
_silc_client_notify_wait_continue endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 174. silc_client_notify_server_signoff

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_server_signoff(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_server_signoff
_silc_client_notify_server_signoff proc	near ; DATA XREF: _silc_client_notify:loc_62B923B4o

var_6C		= dword	ptr -6Ch
client_entry	= dword	ptr -4Ch
var_46		= word ptr -46h
server_entry	= dword	ptr -44h
client		= dword	ptr -40h
args		= dword	ptr -3Ch
id		= SilcID ptr -38h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 8Ch
		mov	esi, [ebp+fsm_context]
		mov	eax, [esi+4Ch]
		mov	[ebp+client], eax
		mov	eax, [ebp+state_context]
		mov	ebx, [eax+4]
payload	= ebx				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_46], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	dword ptr [esp], 1Ch
		call	_silc_malloc
		mov	payload, eax
clients	= ebx				; SilcDList
		test	eax, eax
		jz	short out
fsm_context_0 =	esi			; void *
clients	= eax				; SilcDList
		mov	dword ptr [clients+18h], 0
		mov	dword ptr [clients+14h], 0
		mov	clients, [clients+10h]
clients	= ebx				; SilcDList
		and	eax, 3
		mov	[clients+10h], eax
		mov	word ptr [clients+0Ch],	4
		mov	word ptr [clients+0Eh],	8
		mov	byte ptr [clients+10h],	1
		mov	dword ptr [clients+8], 0
		mov	dword ptr [clients+4], 0
		mov	dword ptr [clients], 0
		mov	dword ptr [esp+10h], 0
		lea	edx, [ebp+id]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		call	_silc_argument_get_decoded
		test	al, al
		jnz	short loc_62B8F404

out:					; CODE XREF: _silc_client_notify_server_signoff+42j
		mov	[ebp+server_entry], 0

loc_62B8F3B8:				; CODE XREF: _silc_client_notify_server_signoff+15Cj
					; _silc_client_notify_server_signoff+245j ...
client_entry = eax			; SilcClientEntry
i = edi					; int
		mov	client_entry, [ebp+server_entry]
		mov	[esp+8], eax	; server_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_server
		mov	[esp+8], clients ; client_list
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_list_free
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 8Ch
		pop	clients
		pop	fsm_context_0
		pop	i
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
clients	= ebx				; SilcDList
		align 4

loc_62B8F404:				; CODE XREF: _silc_client_notify_server_signoff+ABj
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; server_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_server_by_id
		mov	[ebp+server_entry], eax
		mov	edi, 1
client_entry = eax			; SilcClientEntry
i = edi					; int
		xchg	ax, ax

loc_62B8F424:				; CODE XREF: _silc_client_notify_server_signoff+17Aj
					; _silc_client_notify_server_signoff+183j ...
		mov	client_entry, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_arg_num
		cmp	eax, i
		jbe	loc_62B8F4EF

loc_62B8F437:				; CODE XREF: _silc_client_notify_server_signoff+1E5j
		inc	i
		mov	dword ptr [esp+10h], 0
		lea	ecx, [ebp+id]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], i
		mov	eax, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	loc_62B8F3B8
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_client_by_id
		test	eax, eax
client_entry = eax			; SilcClientEntry
		jz	short loc_62B8F424
		test	byte ptr [client_entry+402h], 1
		jz	short loc_62B8F424
		mov	dword ptr [esp], 0Ch
		mov	[ebp+client_entry], client_entry
		call	_silc_malloc
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	short loc_62B8F424
		mov	[eax], edx
client_entry = edx			; SilcClientEntry
		mov	client_entry, [clients]
		test	edx, edx
		jz	loc_62B8F5A4
		movzx	ecx, word ptr [clients+0Ch]
		mov	[ebp+var_6C], ecx
		mov	ecx, [clients+4]
		mov	edx, [ebp+var_6C]
		mov	[ecx+edx], eax

loc_62B8F4BB:				; CODE XREF: _silc_client_notify_server_signoff+2A9j
		test	byte ptr [clients+10h],	1
		jz	short loc_62B8F4CB
		movzx	ecx, word ptr [clients+0Eh]
		mov	edx, [clients+4]
		mov	[eax+ecx], edx

loc_62B8F4CB:				; CODE XREF: _silc_client_notify_server_signoff+1BBj
		mov	[clients+4], eax
		mov	ecx, [ebp+var_6C]
		mov	dword ptr [eax+ecx], 0
		add	dword ptr [clients+10h], 4
		mov	eax, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_arg_num
		cmp	eax, i
		ja	loc_62B8F437

loc_62B8F4EF:				; CODE XREF: _silc_client_notify_server_signoff+12Dj
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	[esp+10h], clients
		mov	edx, [ebp+server_entry]
		mov	[esp+0Ch], edx
		movzx	edx, [ebp+var_46]
type = edx				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	ecx, [ebp+client]
		mov	[esp], ecx
		call	dword ptr [eax+0Ch]
		mov	eax, [clients]
		mov	[clients+8], eax
		and	byte ptr [clients+10h],	0FDh
		mov	dword ptr [clients+18h], 0
		mov	dword ptr [clients+14h], 0
		xor	eax, eax
		mov	i, [ebp+client]
client = edi				; SilcClient
		jmp	short loc_62B8F57F
; ---------------------------------------------------------------------------
		align 4

loc_62B8F538:				; CODE XREF: _silc_client_notify_server_signoff+289j
		movzx	edx, word ptr [clients+0Eh]
		mov	edx, [eax+edx]

loc_62B8F53F:				; CODE XREF: _silc_client_notify_server_signoff+292j
		mov	[clients+8], edx
		mov	[clients+14h], eax
		mov	eax, [eax]
client_entry = eax			; SilcClientEntry
		test	client_entry, client_entry
		jz	loc_62B8F3B8
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+client_entry], client_entry
		call	_silc_client_remove_from_channels
		mov	eax, [ebp+client_entry]
		and	byte ptr [eax+402h], 0FEh
client_entry = eax			; SilcClientEntry
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_del_client
		mov	eax, [clients+14h]

loc_62B8F57F:				; CODE XREF: _silc_client_notify_server_signoff+230j
		mov	[clients+18h], eax
		mov	eax, [clients+8]
		test	eax, eax
		jz	short loc_62B8F598
		test	byte ptr [clients+10h],	2
		jnz	short loc_62B8F538
		movzx	edx, word ptr [clients+0Ch]
		mov	edx, [eax+edx]
		jmp	short loc_62B8F53F
; ---------------------------------------------------------------------------

loc_62B8F598:				; CODE XREF: _silc_client_notify_server_signoff+283j
		mov	dword ptr [clients+14h], 0
		jmp	loc_62B8F3B8
; ---------------------------------------------------------------------------

loc_62B8F5A4:				; CODE XREF: _silc_client_notify_server_signoff+1A1j
i = edi					; int
		mov	[clients], eax
		movzx	edx, word ptr [clients+0Ch]
		mov	[ebp+var_6C], edx
		jmp	loc_62B8F4BB
_silc_client_notify_server_signoff endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 168. silc_client_notify_killed

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_killed(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_killed
_silc_client_notify_killed proc	near	; DATA XREF: _silc_client_notify:loc_62B92380o

var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
server		= dword	ptr -58h
var_52		= word ptr -52h
entry		= dword	ptr -50h
channel_entry	= dword	ptr -4Ch
id		= SilcID ptr -3Ch
comment_len	= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4Ch]
client = esi				; SilcClient
		mov	eax, [ebp+state_context]
		mov	edi, [eax+4]
payload	= edi				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_52], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+channel_entry], eax
		mov	dword ptr [esp+10h], 0
		lea	edx, [ebp+id]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	loc_62B8F788
fsm_context_0 =	ebx			; void *
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id
		mov	payload, eax
client_entry = edi			; SilcClientEntry
		test	eax, eax
		jz	loc_62B8F78A
client_entry = eax			; SilcClientEntry
		lea	client_entry, [ebp+comment_len]
client_entry = edi			; SilcClientEntry
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	eax, [ebp+channel_entry]
		mov	[esp], eax
		call	_silc_argument_get_arg_type
		mov	[ebp+var_5C], eax
		mov	dword ptr [esp+10h], 0
		lea	edx, [ebp+id]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	ecx, [ebp+channel_entry]
		mov	[esp], ecx
		call	_silc_argument_get_decoded
		test	al, al
		jz	loc_62B8F78A
		mov	ax, [ebp+id.type]
		cmp	ax, 2
		jz	loc_62B8F7EC
		dec	ax
		jz	loc_62B8F7B8
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel_by_id
		mov	[ebp+channel_entry], eax
		test	eax, eax
		jz	loc_62B8F824
		mov	eax, [ebp+channel_entry]
		mov	[ebp+entry], eax
		mov	[ebp+server], 0
		xor	edx, edx

loc_62B8F6BE:				; CODE XREF: _silc_client_notify_killed+231j
					; _silc_client_notify_killed+26Bj
client_entry2 =	edx			; SilcClientEntry
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	ecx, [eax+48h]
		mov	eax, [ebp+entry]
		mov	[esp+18h], eax
		movzx	eax, [ebp+id.type]
		mov	[esp+14h], eax
		mov	eax, [ebp+var_5C]
		mov	[esp+10h], eax
		mov	[esp+0Ch], client_entry
		movzx	eax, [ebp+var_52]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		mov	[ebp+var_60], client_entry2
		call	dword ptr [ecx+0Ch]
		cmp	client_entry, [fsm_context_0]
		mov	edx, [ebp+var_60]
		jz	short out
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_remove_from_channels
		and	byte ptr [client_entry+402h], 0FEh
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_del_client
		mov	edx, [ebp+var_60]

out:					; CODE XREF: _silc_client_notify_killed+147j
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+var_60], edx
		call	_silc_client_unref_client
		mov	edx, [ebp+var_60]
		test	edx, edx
client_entry2 =	edx			; SilcClientEntry
		jz	short loc_62B8F751
		mov	[esp+8], client_entry2 ; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client

loc_62B8F751:				; CODE XREF: _silc_client_notify_killed+18Bj
client_entry2 =	edx			; SilcClientEntry
		mov	client_entry, [ebp+server]
		test	edi, edi
		jz	short loc_62B8F76B
		mov	client_entry2, [ebp+server]
		mov	[esp+8], edx	; server_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_server

loc_62B8F76B:				; CODE XREF: _silc_client_notify_killed+1A2j
client_entry2 =	edx			; SilcClientEntry
		mov	ecx, [ebp+channel_entry]
		test	ecx, ecx
		jz	short loc_62B8F79A
		mov	ecx, [ebp+channel_entry]
		mov	[esp+8], ecx	; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		jmp	short loc_62B8F79A
; ---------------------------------------------------------------------------
payload	= edi				; SilcNotifyPayload
		align 4

loc_62B8F788:				; CODE XREF: _silc_client_notify_killed+55j
		xor	payload, payload

loc_62B8F78A:				; CODE XREF: _silc_client_notify_killed+72j
					; _silc_client_notify_killed+C1j
client_entry = edi			; SilcClientEntry ; client_entry
		mov	[esp+8], client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client

loc_62B8F79A:				; CODE XREF: _silc_client_notify_killed+1BCj
					; _silc_client_notify_killed+1D1j
client_entry2 =	edx			; SilcClientEntry
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax

loc_62B8F7AF:				; CODE XREF: _silc_client_notify_killed+2BFj
					; _silc_client_notify_killed+336j
		add	esp, 7Ch
		pop	fsm_context_0
		pop	client
		pop	client_entry
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
client = esi				; SilcClient
client_entry = edi			; SilcClientEntry
		align 4

loc_62B8F7B8:				; CODE XREF: _silc_client_notify_killed+D7j
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; server_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_server_by_id
		mov	[ebp+server], eax
		test	eax, eax
		jz	loc_62B8F8EF
		mov	eax, [ebp+server]
		mov	[ebp+entry], eax
		mov	[ebp+channel_entry], 0
		xor	edx, edx
client_entry2 =	edx			; SilcClientEntry
		jmp	loc_62B8F6BE
; ---------------------------------------------------------------------------
		align 4

loc_62B8F7EC:				; CODE XREF: _silc_client_notify_killed+CFj
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id
		mov	edx, eax
client_entry2 =	edx			; SilcClientEntry
		test	eax, eax
		jz	short loc_62B8F878
client_entry2 =	eax			; SilcClientEntry
		test	byte ptr [client_entry2+402h], 1
		jz	short loc_62B8F878
		mov	[ebp+entry], client_entry2
		mov	[ebp+server], 0
		mov	[ebp+channel_entry], 0
		jmp	loc_62B8F6BE
; ---------------------------------------------------------------------------

loc_62B8F824:				; CODE XREF: _silc_client_notify_killed+F5j
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		or	edx, 4
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B8F92F

loc_62B8F83A:				; CODE XREF: _silc_client_notify_killed+3A7j
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_resolved ; completion
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel_by_id_resolve

loc_62B8F85C:				; CODE XREF: _silc_client_notify_killed+32Dj
					; _silc_client_notify_killed+376j
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		test	al, 4
		jz	short loc_62B8F8E8
		mov	eax, 2
		jmp	loc_62B8F7AF
; ---------------------------------------------------------------------------

loc_62B8F878:				; CODE XREF: _silc_client_notify_killed+24Fj
					; _silc_client_notify_killed+258j
client_entry2 =	eax			; SilcClientEntry ; client_entry
		mov	[esp+8], client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+var_60], edx
		call	_silc_client_unref_client
		mov	edx, [ebp+var_60]
		mov	[esp+8], edx	; client_entry
client_entry2 =	edx			; SilcClientEntry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B8F960

loc_62B8F8B7:				; CODE XREF: _silc_client_notify_killed+3D8j
		mov	eax, [ebp+state_context]
		mov	[esp+14h], eax	; context
		mov	dword ptr [esp+10h], offset _silc_client_notify_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id_resolve
		jmp	loc_62B8F85C
; ---------------------------------------------------------------------------
		align 4

loc_62B8F8E8:				; CODE XREF: _silc_client_notify_killed+2B8j
		xor	eax, eax
		jmp	loc_62B8F7AF
; ---------------------------------------------------------------------------

loc_62B8F8EF:				; CODE XREF: _silc_client_notify_killed+21Cj
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B8F991

loc_62B8F908:				; CODE XREF: _silc_client_notify_killed+409j
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_resolved ; completion
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; server_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_server_by_id_resolve
		jmp	loc_62B8F85C
; ---------------------------------------------------------------------------

loc_62B8F92F:				; CODE XREF: _silc_client_notify_killed+280j
		mov	dword ptr [esp+8], 567h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B8F83A
; ---------------------------------------------------------------------------

loc_62B8F960:				; CODE XREF: _silc_client_notify_killed+2FDj
		mov	dword ptr [esp+8], 54Eh
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B8F8B7
; ---------------------------------------------------------------------------

loc_62B8F991:				; CODE XREF: _silc_client_notify_killed+34Ej
		mov	dword ptr [esp+8], 55Ah
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B8F908
_silc_client_notify_killed endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 165. silc_client_notify_invite

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_invite(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_invite
_silc_client_notify_invite proc	near	; DATA XREF: _silc_client_notify:loc_62B924CCo

var_52		= word ptr -52h
tmp		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -3Ch
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4Ch]
		mov	[ebp+client], eax
		mov	edx, [ebp+state_context]
		mov	esi, [edx+4]
payload	= esi				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_52], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	edi, eax
args = edi				; SilcArgumentPayload
		mov	dword ptr [esp+10h], 0
		lea	ecx, [ebp+id]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
fsm_context_0 =	ebx			; void *
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	[esp], args
		call	_silc_argument_get_arg_type
		mov	[ebp+tmp], eax
		test	eax, eax
		jz	out
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_channel_by_id
		mov	payload, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		jz	loc_62B8FBE8
channel	= eax				; SilcChannelEntry
		cmp	word ptr [channel+17Ch], 0
		jz	loc_62B8FB24
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	channel, [ebp+client]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B8FC54

loc_62B8FA9D:				; CODE XREF: _silc_client_notify_invite+2BCj
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_wait_continue ;	reply
		movzx	eax, word ptr [channel+17Ch]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], fsm_context_0 ; conn
		call	_silc_client_command_pending

loc_62B8FAC7:				; CODE XREF: _silc_client_notify_invite+217j
					; _silc_client_notify_invite+25Bj
client_entry = edi			; SilcClientEntry
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jz	loc_62B8FBE0
		mov	eax, 2
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	client_entry
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
payload	= esi				; SilcNotifyPayload
args = edi				; SilcArgumentPayload
		align 10h

out:					; CODE XREF: _silc_client_notify_invite+57j
					; _silc_client_notify_invite+79j
		xor	payload, payload

loc_62B8FAF2:				; CODE XREF: _silc_client_notify_invite+189j
					; _silc_client_notify_invite+304j
client_entry = edi			; SilcClientEntry ; channel_entry
channel	= esi				; SilcChannelEntry
		mov	[esp+8], channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next
		xor	eax, eax

loc_62B8FB1A:				; CODE XREF: _silc_client_notify_invite+21Ej
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	client_entry
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
args = edi				; SilcArgumentPayload
channel	= eax				; SilcChannelEntry
		align 4

loc_62B8FB24:				; CODE XREF: _silc_client_notify_invite+A7j
		mov	dword ptr [esp+10h], 0
		lea	channel, [ebp+id]
channel	= esi				; SilcChannelEntry
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	[esp], args
		call	_silc_argument_get_decoded
		test	al, al
		jz	short loc_62B8FAF2
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_client_by_id
		mov	args, eax
client_entry = edi			; SilcClientEntry
		test	eax, eax
		jz	short loc_62B8FB78
client_entry = eax			; SilcClientEntry
		test	byte ptr [client_entry+402h], 1
		jnz	loc_62B8FC88

loc_62B8FB78:				; CODE XREF: _silc_client_notify_invite+1A5j
		mov	[esp+8], edi	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	client_entry, [ebp+client]
client_entry = edi			; SilcClientEntry
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		mov	edx, [ebp+state_context]
		mov	[edx+0Ch], channel
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		or	edx, 4
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B8FCCD

loc_62B8FBA7:				; CODE XREF: _silc_client_notify_invite+335j
		mov	eax, [ebp+state_context]
		mov	[esp+14h], eax	; context
		mov	dword ptr [esp+10h], offset _silc_client_notify_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_client_by_id_resolve
		mov	[channel+17Ch],	ax
		jmp	loc_62B8FAC7
; ---------------------------------------------------------------------------

loc_62B8FBE0:				; CODE XREF: _silc_client_notify_invite+116j
		xor	eax, eax
		jmp	loc_62B8FB1A
; ---------------------------------------------------------------------------
args = edi				; SilcArgumentPayload
channel	= eax				; SilcChannelEntry
		align 4

loc_62B8FBE8:				; CODE XREF: _silc_client_notify_invite+99j
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
channel	= esi				; SilcChannelEntry
		mov	dl, al
		or	edx, 4
		mov	[ecx+28h], dl
		test	al, 4
		jnz	short loc_62B8FC24

loc_62B8FBFA:				; CODE XREF: _silc_client_notify_invite+28Cj
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_resolved ; completion
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel_by_id_resolve
		jmp	loc_62B8FAC7
; ---------------------------------------------------------------------------

loc_62B8FC24:				; CODE XREF: _silc_client_notify_invite+234j
		mov	dword ptr [esp+8], 132h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	short loc_62B8FBFA
; ---------------------------------------------------------------------------
		align 4

loc_62B8FC54:				; CODE XREF: _silc_client_notify_invite+D3j
		mov	dword ptr [esp+8], 13Dh
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B8FA9D
; ---------------------------------------------------------------------------
client_entry = eax			; SilcClientEntry
		align 4

loc_62B8FC88:				; CODE XREF: _silc_client_notify_invite+1AEj
		mov	client_entry, [fsm_context_0+4Ch]
client_entry = edi			; SilcClientEntry
		mov	eax, [eax+18h]
		mov	edx, [eax+48h]
		mov	[esp+14h], client_entry
		mov	eax, [ebp+tmp]
		mov	[esp+10h], eax
		mov	[esp+0Ch], channel
		movzx	eax, [ebp+var_52]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	ecx, [ebp+client]
		mov	[esp], ecx
		call	dword ptr [edx+0Ch]
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		jmp	loc_62B8FAF2
; ---------------------------------------------------------------------------

loc_62B8FCCD:				; CODE XREF: _silc_client_notify_invite+1DDj
		mov	dword ptr [esp+8], 14Fh
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B8FBA7
_silc_client_notify_invite endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 175. silc_client_notify_signoff

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_signoff(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_notify_signoff
_silc_client_notify_signoff proc near	; DATA XREF: _silc_client_notify:loc_62B92478o

channel_entry	= dword	ptr -58h
var_52		= word ptr -52h
packet		= dword	ptr -50h
args		= dword	ptr -4Ch
id		= SilcID ptr -3Ch
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebp+state_context]
		mov	edi, [ebx+4Ch]
client = edi				; SilcClient
		mov	esi, [eax+4]
payload	= esi				; SilcNotifyPayload
		mov	eax, [eax]
		mov	[ebp+packet], eax
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_52], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	dword ptr [esp+10h], 0
		lea	eax, [ebp+id]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	edx, [ebp+args]
		mov	[esp], edx
		call	_silc_argument_get_decoded
		test	al, al
		jnz	short loc_62B8FD7C

out:					; CODE XREF: _silc_client_notify_signoff+93j
					; _silc_client_notify_signoff+136j
fsm_context_0 =	ebx			; void *
client_entry = esi			; SilcClientEntry
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	client_entry
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B8FD7C:				; CODE XREF: _silc_client_notify_signoff+5Dj
fsm_context_0 =	ebx			; void *
client = edi				; SilcClient
payload	= esi				; SilcNotifyPayload
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id
		mov	payload, eax
client_entry = esi			; SilcClientEntry
		test	eax, eax
		jz	short out
client_entry = eax			; SilcClientEntry
		lea	client_entry, [ebp+tmp_len]
client_entry = esi			; SilcClientEntry
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	edx, [ebp+args]
		mov	[esp], edx
		call	_silc_argument_get_arg_type
		mov	ecx, eax
tmp = ecx				; unsigned __int8 *
		test	eax, eax
		jz	short loc_62B8FDC5
tmp = eax				; unsigned __int8 *
		cmp	[ebp+tmp_len], 80h
		jbe	short loc_62B8FDC5
		mov	byte ptr [tmp+80h], 0

loc_62B8FDC5:				; CODE XREF: _silc_client_notify_signoff+B3j
					; _silc_client_notify_signoff+BCj
		mov	edx, [ebp+packet]
		mov	al, [edx+21h]
tmp = ecx				; unsigned __int8 *
		and	eax, 0FFFFFFC0h
		cmp	al, 0C0h
		jz	loc_62B8FE70

loc_62B8FDD6:				; CODE XREF: _silc_client_notify_signoff+1A4j
		xor	edx, edx

loc_62B8FDD8:				; CODE XREF: _silc_client_notify_signoff+1C2j
channel	= edx				; SilcChannelEntry
		test	byte ptr [client_entry+402h], 1
		jnz	short loc_62B8FE3C

loc_62B8FDE1:				; CODE XREF: _silc_client_notify_signoff+169j
		test	channel, channel
		jz	short loc_62B8FE0F
		mov	[esp+0Ch], client_entry	; client_entry
		mov	[esp+8], channel ; channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+channel_entry], channel
		call	_silc_client_remove_from_channel
		mov	edx, [ebp+channel_entry]
		mov	[esp+8], edx	; channel_entry
channel	= edx				; SilcChannelEntry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel

loc_62B8FE0F:				; CODE XREF: _silc_client_notify_signoff+E3j
channel	= edx				; SilcChannelEntry
tmp = ecx				; unsigned __int8 *
		and	byte ptr [client_entry+402h], 0FEh
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_del_client
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		jmp	out
; ---------------------------------------------------------------------------
channel	= edx				; SilcChannelEntry
tmp = ecx				; unsigned __int8 *
		align 4

loc_62B8FE3C:				; CODE XREF: _silc_client_notify_signoff+DFj
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	[esp+14h], channel
		mov	[esp+10h], tmp
		mov	[esp+0Ch], client_entry
		movzx	tmp, [ebp+var_52]
type = ecx				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		mov	[ebp+channel_entry], channel
		call	dword ptr [eax+0Ch]
		mov	edx, [ebp+channel_entry]
		jmp	loc_62B8FDE1
; ---------------------------------------------------------------------------
tmp = ecx				; unsigned __int8 *
		align 10h

loc_62B8FE70:				; CODE XREF: _silc_client_notify_signoff+D0j
		mov	dword ptr [esp+10h], 16h
		lea	eax, [ebp+id]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 3
		mov	al, [edx+21h]
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [edx+1Ch]
		mov	[esp], eax
		mov	[ebp+channel_entry], tmp
		call	_silc_id_str2id
		test	al, al
		mov	ecx, [ebp+channel_entry]
		jz	loc_62B8FDD6
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel_by_id
		mov	edx, eax
channel	= edx				; SilcChannelEntry
		mov	ecx, [ebp+channel_entry]
		jmp	loc_62B8FDD8
_silc_client_notify_signoff endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 169. silc_client_notify_leave

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_leave(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_notify_leave
_silc_client_notify_leave proc near	; DATA XREF: _silc_client_notify:loc_62B92494o

var_42		= word ptr -42h
args		= dword	ptr -40h
client		= dword	ptr -3Ch
id		= SilcID ptr -38h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4Ch]
		mov	[ebp+client], eax
		mov	edx, [ebp+state_context]
		mov	edi, [edx+4]
payload	= edi				; SilcNotifyPayload
		mov	esi, [edx]
packet = esi				; SilcPacket
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_42], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	dword ptr [esp+10h], 16h
		lea	payload, [ebp+id]
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 3
		mov	al, [packet+21h]
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [packet+1Ch]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jnz	short loc_62B8FF5C
fsm_context_0 =	ebx			; void *
		xor	packet,	packet

out:					; CODE XREF: _silc_client_notify_leave+ABj
					; _silc_client_notify_leave+155j ...
client_entry = edi			; SilcClientEntry ; channel_entry
channel	= esi				; SilcChannelEntry
		mov	[esp+8], channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 5Ch
		pop	fsm_context_0
		pop	channel
		pop	client_entry
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
packet = esi				; SilcPacket
		align 4

loc_62B8FF5C:				; CODE XREF: _silc_client_notify_leave+5Fj
		mov	[esp+8], edi	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel_by_id
		mov	packet,	eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		jz	short out
channel	= eax				; SilcChannelEntry
		cmp	word ptr [channel+17Ch], 0
		jz	short loc_62B8FFF4
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	channel, [ebp+client]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B900A0

loc_62B8FFAB:				; CODE XREF: _silc_client_notify_leave+204j
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_wait_continue ;	reply
		movzx	eax, word ptr [channel+17Ch]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], fsm_context_0 ; conn
		call	_silc_client_command_pending
		mov	ecx, [ebp+fsm]
		mov	dl, [ecx+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		shl	eax, 1
		and	eax, 2
		add	esp, 5Ch
		pop	fsm_context_0
		pop	channel
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
channel	= eax				; SilcChannelEntry
		align 4

loc_62B8FFF4:				; CODE XREF: _silc_client_notify_leave+B5j
		mov	dword ptr [esp+10h], 0
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	channel, [ebp+args]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
		mov	[esp+8], edi	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_client_by_id
		mov	edi, eax
client_entry = edi			; SilcClientEntry
		test	eax, eax
		jz	out
client_entry = eax			; SilcClientEntry
		mov	[esp+0Ch], client_entry	; client_entry
		mov	[esp+8], channel ; channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_remove_from_channel
client_entry = edi			; SilcClientEntry
		test	al, al
		jz	out
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	edx, [eax+48h]
		mov	[esp+10h], channel
		mov	[esp+0Ch], client_entry
		movzx	eax, [ebp+var_42]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	type, [ebp+client]
		mov	[esp], eax
		call	dword ptr [edx+0Ch]
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_client
		jmp	out
; ---------------------------------------------------------------------------
		align 10h

loc_62B900A0:				; CODE XREF: _silc_client_notify_leave+DDj
		mov	dword ptr [esp+8], 1DAh
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B8FFAB
_silc_client_notify_leave endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 167. silc_client_notify_kicked

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_kicked(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_kicked
_silc_client_notify_kicked proc	near	; DATA XREF: _silc_client_notify:loc_62B92398o

var_60		= dword	ptr -60h
client_entry	= dword	ptr -5Ch
var_56		= word ptr -56h
args		= dword	ptr -54h
client		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
id		= SilcID ptr -3Ch
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4Ch]
		mov	[ebp+client], eax
		mov	edx, [ebp+state_context]
		mov	edi, [edx+4]
payload	= edi				; SilcNotifyPayload
		mov	esi, [edx]
packet = esi				; SilcPacket
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_56], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	dword ptr [esp+10h], 16h
		lea	payload, [ebp+id]
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 3
		mov	al, [packet+21h]
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [packet+1Ch]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jnz	short loc_62B90168
fsm_context_0 =	ebx			; void *
		xor	packet,	packet

out:					; CODE XREF: _silc_client_notify_kicked+ABj
					; _silc_client_notify_kicked+15Dj ...
client_entry = eax			; SilcClientEntry ; channel_entry
channel	= esi				; SilcChannelEntry
tmp = edi				; unsigned __int8 *
		mov	[esp+8], channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	client_entry, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		xor	eax, eax

loc_62B9015F:				; CODE XREF: _silc_client_notify_kicked+26Ej
		add	esp, 7Ch
		pop	fsm_context_0
		pop	channel
		pop	tmp
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
packet = esi				; SilcPacket
		align 4

loc_62B90168:				; CODE XREF: _silc_client_notify_kicked+5Fj
		mov	[esp+8], edi	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel_by_id
		mov	packet,	eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		jz	short out
channel	= eax				; SilcChannelEntry
		cmp	word ptr [channel+17Ch], 0
		jz	short loc_62B90208
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	channel, [ebp+client]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B90348

loc_62B901B7:				; CODE XREF: _silc_client_notify_kicked+2A0j
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_wait_continue ;	reply
		movzx	eax, word ptr [channel+17Ch]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], fsm_context_0 ; conn
		call	_silc_client_command_pending
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jz	loc_62B90340

loc_62B901FA:				; CODE XREF: _silc_client_notify_kicked+265j
		mov	eax, 2
		add	esp, 7Ch
		pop	fsm_context_0
		pop	channel
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
channel	= eax				; SilcChannelEntry
		align 4

loc_62B90208:				; CODE XREF: _silc_client_notify_kicked+B5j
		mov	dword ptr [esp+10h], 0
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	channel, [ebp+args]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
		mov	[esp+8], edi	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_client_by_id
		test	eax, eax
client_entry = eax			; SilcClientEntry
		jz	out
		mov	dword ptr [esp+10h], 0
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		mov	[ebp+client_entry], client_entry
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
		mov	[esp+8], edi	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_client_by_id
		mov	ecx, eax
client_entry2 =	ecx			; SilcClientEntry
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	short loc_62B902AD
client_entry2 =	eax			; SilcClientEntry
		test	byte ptr [client_entry2+402h], 1
		jnz	loc_62B90379

loc_62B902AD:				; CODE XREF: _silc_client_notify_kicked+1CAj
		mov	[esp+8], edx	; client_entry
client_entry = edx			; SilcClientEntry
		mov	[esp+4], fsm_context_0 ; conn
		mov	client_entry, [ebp+client]
		mov	[esp], edx	; client
		mov	[ebp+var_60], ecx
		call	_silc_client_unref_client
		mov	ecx, [ebp+var_60]
		mov	[esp+8], ecx	; client_entry
client_entry2 =	ecx			; SilcClientEntry
		mov	[esp+4], fsm_context_0 ; conn
		mov	client_entry2, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_client
		mov	eax, [ebp+state_context]
		mov	[eax+0Ch], channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B9043F

loc_62B902F8:				; CODE XREF: _silc_client_notify_kicked+397j
		mov	eax, [ebp+state_context]
		mov	[esp+14h], eax	; context
		mov	dword ptr [esp+10h], offset _silc_client_notify_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		mov	[esp+8], edi	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_client_by_id_resolve
		mov	[channel+17Ch],	ax
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B901FA
		nop

loc_62B90340:				; CODE XREF: _silc_client_notify_kicked+120j
		xor	eax, eax
		jmp	loc_62B9015F
; ---------------------------------------------------------------------------
		align 4

loc_62B90348:				; CODE XREF: _silc_client_notify_kicked+DDj
		mov	dword ptr [esp+8], 4DFh
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B901B7
; ---------------------------------------------------------------------------

loc_62B90379:				; CODE XREF: _silc_client_notify_kicked+1D3j
client_entry2 =	eax			; SilcClientEntry
		lea	client_entry2, [ebp+tmp_len]
client_entry2 =	ecx			; SilcClientEntry
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	eax, [ebp+args]
		mov	[esp], eax
		mov	[ebp+client_entry], edx
		mov	[ebp+var_60], client_entry2
		call	_silc_argument_get_arg_type
		mov	edi, eax
tmp = edi				; unsigned __int8 *
		mov	edx, [ebp+client_entry]
		cmp	edx, [fsm_context_0]
client_entry = edx			; SilcClientEntry
		mov	ecx, [ebp+var_60]
		jz	short loc_62B903CA
		mov	[esp+0Ch], client_entry	; client_entry
		mov	[esp+8], channel ; channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_remove_from_channel
		test	al, al
		mov	edx, [ebp+client_entry]
		mov	ecx, [ebp+var_60]
		jz	out

loc_62B903CA:				; CODE XREF: _silc_client_notify_kicked+2CFj
client_entry = edx			; SilcClientEntry
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	[ebp+var_4C], eax
		mov	[esp+18h], channel
		mov	[esp+14h], ecx
client_entry2 =	ecx			; SilcClientEntry
		mov	[esp+10h], tmp
		mov	[esp+0Ch], client_entry
		movzx	eax, [ebp+var_56]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	type, [ebp+client]
		mov	[esp], eax
		mov	[ebp+client_entry], client_entry
		mov	[ebp+var_60], client_entry2
		mov	eax, [ebp+var_4C]
		call	dword ptr [eax+0Ch]
		mov	edx, [ebp+client_entry]
		cmp	edx, [fsm_context_0]
client_entry = edx			; SilcClientEntry
		mov	ecx, [ebp+var_60]
		jz	short loc_62B90470

loc_62B9040E:				; CODE XREF: _silc_client_notify_kicked+3D3j
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	client_entry, [ebp+client]
		mov	[esp], edx	; client
		mov	[ebp+var_60], ecx
		call	_silc_client_unref_client
		mov	ecx, [ebp+var_60]
		mov	[esp+8], ecx	; client_entry
client_entry2 =	ecx			; SilcClientEntry
		mov	[esp+4], fsm_context_0 ; conn
		mov	client_entry2, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_client
		jmp	out
; ---------------------------------------------------------------------------

loc_62B9043F:				; CODE XREF: _silc_client_notify_kicked+21Ej
		mov	dword ptr [esp+8], 4FBh
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B902F8
; ---------------------------------------------------------------------------

loc_62B90470:				; CODE XREF: _silc_client_notify_kicked+338j
client_entry = edx			; SilcClientEntry
tmp = edi				; unsigned __int8 *
		cmp	channel, [fsm_context_0+30h]
		jz	short loc_62B904AC

loc_62B90475:				; CODE XREF: _silc_client_notify_kicked+3DFj
		mov	[esp+8], channel ; channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+client_entry], client_entry
		mov	[ebp+var_60], ecx
		call	_silc_client_empty_channel
		mov	[esp+8], channel ; channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_del_channel
		mov	ecx, [ebp+var_60]
		mov	edx, [ebp+client_entry]
		jmp	loc_62B9040E
; ---------------------------------------------------------------------------

loc_62B904AC:				; CODE XREF: _silc_client_notify_kicked+39Fj
client_entry = edx			; SilcClientEntry
		mov	dword ptr [fsm_context_0+30h], 0
		jmp	short loc_62B90475
_silc_client_notify_kicked endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 161. silc_client_notify_channel_change

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_channel_change(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_channel_change
_silc_client_notify_channel_change proc	near ; DATA XREF: _silc_client_notify:loc_62B923D0o

var_42		= word ptr -42h
args		= dword	ptr -40h
client		= dword	ptr -3Ch
id		= SilcID ptr -38h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4Ch]
		mov	[ebp+client], eax
		mov	edx, [ebp+state_context]
		mov	esi, [edx+4]
payload	= esi				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_42], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	dword ptr [esp+10h], 0
		lea	edi, [ebp+id]
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jnz	short loc_62B90544
fsm_context_0 =	ebx			; void *
		xor	payload, payload

out:					; CODE XREF: _silc_client_notify_channel_change+A3j
					; _silc_client_notify_channel_change+14Dj ...
channel	= esi				; SilcChannelEntry ; channel_entry
		mov	[esp+8], channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 5Ch
		pop	fsm_context_0
		pop	channel
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B90544:				; CODE XREF: _silc_client_notify_channel_change+58j
fsm_context_0 =	ebx			; void * ; channel_id
payload	= esi				; SilcNotifyPayload
		mov	[esp+8], edi
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel_by_id
		mov	payload, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		jz	short out
channel	= eax				; SilcChannelEntry
		cmp	word ptr [channel+17Ch], 0
		jz	short loc_62B905DC
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	channel, [ebp+client]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B90658

loc_62B90593:				; CODE XREF: _silc_client_notify_channel_change+1CCj
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_wait_continue ;	reply
		movzx	eax, word ptr [channel+17Ch]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], fsm_context_0 ; conn
		call	_silc_client_command_pending
		mov	ecx, [ebp+fsm]
		mov	dl, [ecx+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		shl	eax, 1
		and	eax, 2
		add	esp, 5Ch
		pop	fsm_context_0
		pop	channel
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
channel	= eax				; SilcChannelEntry
		align 4

loc_62B905DC:				; CODE XREF: _silc_client_notify_channel_change+ADj
		mov	dword ptr [esp+10h], 0
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	channel, [ebp+args]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
		mov	[esp+0Ch], edi	; new_id
		mov	[esp+8], channel ; channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_replace_channel_id
		test	al, al
		jz	out
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	[esp+10h], channel
		mov	[esp+0Ch], channel
		movzx	edx, [ebp+var_42]
type = edx				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	ecx, [ebp+client]
		mov	[esp], ecx
		call	dword ptr [eax+0Ch]
		jmp	out
; ---------------------------------------------------------------------------
		align 4

loc_62B90658:				; CODE XREF: _silc_client_notify_channel_change+D5j
		mov	dword ptr [esp+8], 4A5h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B90593
_silc_client_notify_channel_change endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 163. silc_client_notify_cumode_change

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_cumode_change(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_notify_cumode_change
_silc_client_notify_cumode_change proc near ; DATA XREF: _silc_client_notify:loc_62B92408o

client_entry	= dword	ptr -0ACh
var_A0		= dword	ptr -0A0h
entry		= dword	ptr -9Ch
var_98		= byte ptr -98h
var_7E		= byte ptr -7Eh
var_7D		= byte ptr -7Dh
chu		= dword	ptr -7Ch
server		= dword	ptr -78h
var_72		= word ptr -72h
channel_entry	= dword	ptr -70h
mode		= dword	ptr -6Ch
id2		= SilcID ptr -5Ch
id		= SilcID ptr -3Ch
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0CCh
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4Ch]
client = esi				; SilcClient
		mov	eax, [ebp+state_context]
		mov	edx, [eax+4]
payload	= edx				; SilcNotifyPayload
		mov	edi, [eax]
packet = edi				; SilcPacket
		mov	[esp], payload
		mov	[ebp+var_A0], payload
		call	_silc_notify_get_type
		mov	[ebp+var_72], ax
		mov	edx, [ebp+var_A0]
		mov	[esp], edx
payload	= edx				; SilcNotifyPayload
		call	_silc_notify_get_args
		mov	[ebp+channel_entry], eax
		mov	dword ptr [esp+10h], 16h
		lea	edx, [ebp+id]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 3
		mov	al, [packet+21h]
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [packet+1Ch]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jnz	short loc_62B90740
fsm_context_0 =	ebx			; void *
		xor	packet,	packet
channel	= edi				; SilcChannelEntry
		xor	edx, edx

loc_62B906FD:				; CODE XREF: _silc_client_notify_cumode_change+188j
					; _silc_client_notify_cumode_change+276j ...
client_entry2 =	edx			; SilcClientEntry ; client_entry
tmp = eax				; unsigned __int8 *
		mov	[esp+8], client_entry2
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client

loc_62B9070D:				; CODE XREF: _silc_client_notify_cumode_change+458j
					; _silc_client_notify_cumode_change+471j
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		xor	eax, eax

loc_62B90732:				; CODE XREF: _silc_client_notify_cumode_change+222j
		add	esp, 0CCh
		pop	fsm_context_0
		pop	client
		pop	channel
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
client = esi				; SilcClient
packet = edi				; SilcPacket
		align 10h

loc_62B90740:				; CODE XREF: _silc_client_notify_cumode_change+6Bj
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel_by_id
		mov	packet,	eax
channel	= edi				; SilcChannelEntry
		test	eax, eax
		jz	loc_62B90812
channel	= eax				; SilcChannelEntry
		cmp	word ptr [channel+17Ch], 0
		jz	short loc_62B907E4
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
channel	= edi				; SilcChannelEntry
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B908B4

loc_62B90790:				; CODE XREF: _silc_client_notify_cumode_change+254j
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_wait_continue ;	reply
		movzx	eax, word ptr [channel+17Ch]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], fsm_context_0 ; conn
		call	_silc_client_command_pending
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jz	loc_62B908AC

loc_62B907D3:				; CODE XREF: _silc_client_notify_cumode_change+219j
		mov	eax, 2
		add	esp, 0CCh
		pop	fsm_context_0
		pop	client
		pop	channel
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
client = esi				; SilcClient
channel	= eax				; SilcChannelEntry
		align 4

loc_62B907E4:				; CODE XREF: _silc_client_notify_cumode_change+D9j
		mov	dword ptr [esp+10h], 0
		lea	channel, [ebp+id2]
channel	= edi				; SilcChannelEntry
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	edx, [ebp+channel_entry]
		mov	[esp], edx
		call	_silc_argument_get_decoded
		test	al, al
		jnz	short loc_62B9081C

loc_62B90812:				; CODE XREF: _silc_client_notify_cumode_change+CBj
		xor	edx, edx
client_entry2 =	edx			; SilcClientEntry
		jmp	loc_62B906FD
; ---------------------------------------------------------------------------
		align 4

loc_62B9081C:				; CODE XREF: _silc_client_notify_cumode_change+184j
		lea	ecx, [ebp+id2]
		mov	[esp+8], ecx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id
		mov	edx, eax
client_entry2 =	edx			; SilcClientEntry
		test	eax, eax
		jz	short loc_62B90842
client_entry2 =	eax			; SilcClientEntry
		test	byte ptr [client_entry2+402h], 1
		jnz	loc_62B908E8

loc_62B90842:				; CODE XREF: _silc_client_notify_cumode_change+1A7j
		mov	[esp+8], edx	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B90B04

loc_62B9086B:				; CODE XREF: _silc_client_notify_cumode_change+4A4j
		mov	eax, [ebp+state_context]
		mov	[esp+14h], eax	; context
		mov	dword ptr [esp+10h], offset _silc_client_notify_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		lea	edx, [ebp+id2]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id_resolve

loc_62B90895:				; CODE XREF: _silc_client_notify_cumode_change+5BBj
					; _silc_client_notify_cumode_change+655j ...
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B907D3
		nop

loc_62B908AC:				; CODE XREF: _silc_client_notify_cumode_change+141j
		xor	eax, eax
		jmp	loc_62B90732
; ---------------------------------------------------------------------------
		align 4

loc_62B908B4:				; CODE XREF: _silc_client_notify_cumode_change+FEj
		mov	dword ptr [esp+8], 3F4h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B90790
; ---------------------------------------------------------------------------
client_entry2 =	eax			; SilcClientEntry
		align 4

loc_62B908E8:				; CODE XREF: _silc_client_notify_cumode_change+1B0j
		mov	[esp+4], client_entry2 ; client_entry
		mov	[esp], channel	; channel
		mov	[ebp+var_A0], client_entry2
client_entry2 =	edx			; SilcClientEntry
		call	_silc_client_on_channel
		test	eax, eax
		mov	edx, [ebp+var_A0]
		jz	loc_62B906FD
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	eax, [ebp+channel_entry]
		mov	[esp], eax
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_A0]
		jz	loc_62B906FD
		mov	cl, [tmp]
		mov	[ebp+var_98], cl
		mov	cl, [tmp+1]
		mov	[ebp+var_7E], cl
		mov	cl, [tmp+2]
		mov	[ebp+var_7D], cl
		mov	al, [tmp+3]
		mov	byte ptr [ebp+chu], al
		mov	dword ptr [esp+10h], 0
		lea	eax, [ebp+id]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	ecx, [ebp+channel_entry]
		mov	[esp], ecx
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_A0]
		jz	loc_62B906FD
		mov	ax, [ebp+id.type]
		cmp	ax, 2
		jz	loc_62B90B35
		dec	ax
		jz	loc_62B90B8E
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+var_A0], edx
		call	_silc_client_get_channel_by_id
		mov	[ebp+channel_entry], eax
		test	eax, eax
		mov	edx, [ebp+var_A0]
		jz	loc_62B90BD7
		mov	eax, [ebp+channel_entry]
		mov	[ebp+entry], eax
		mov	[ebp+server], 0
		mov	[ebp+client_entry], 0

loc_62B909DC:				; CODE XREF: _silc_client_notify_cumode_change+4FDj
					; _silc_client_notify_cumode_change+546j
		movzx	ecx, byte ptr [ebp+chu]
		mov	al, [ebp+var_98]
		shl	eax, 18h
		or	ecx, eax
		movzx	eax, [ebp+var_7E]
		shl	eax, 10h
		or	ecx, eax
		movzx	eax, [ebp+var_7D]
		shl	eax, 8
		or	ecx, eax
		mov	[ebp+mode], ecx
		mov	eax, [channel+144h]
		mov	[esp], eax
		mov	[ebp+var_A0], edx
		call	_silc_rwlock_wrlock
		mov	edx, [ebp+var_A0]
		mov	[esp+4], edx	; client_entry
client_entry2 =	edx			; SilcClientEntry
		mov	[esp], channel	; channel
		call	_silc_client_on_channel
		mov	[ebp+chu], eax
		test	eax, eax
		mov	edx, [ebp+var_A0]
		jz	short loc_62B90A39
		mov	ecx, [ebp+mode]
		mov	[eax+4], ecx

loc_62B90A39:				; CODE XREF: _silc_client_notify_cumode_change+3A5j
		mov	eax, [channel+144h]
		mov	[esp], eax
		mov	[ebp+var_A0], edx
		call	_silc_rwlock_unlock
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	ecx, [eax+48h]
		mov	[esp+1Ch], channel
		mov	edx, [ebp+var_A0]
		mov	[esp+18h], edx
client_entry2 =	edx			; SilcClientEntry
		mov	eax, [ebp+mode]
		mov	[esp+14h], eax
		mov	eax, [ebp+entry]
		mov	[esp+10h], eax
		movzx	eax, [ebp+id.type]
		mov	[esp+0Ch], eax
		movzx	eax, [ebp+var_72]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		call	dword ptr [ecx+0Ch]
		mov	edx, [ebp+var_A0]

out:					; CODE XREF: _silc_client_notify_cumode_change+5CEj
		mov	[esp+8], edx	; client_entry
client_entry2 =	edx			; SilcClientEntry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		mov	ecx, [ebp+client_entry]
		test	ecx, ecx
		jz	short loc_62B90AC5
		mov	edx, [ebp+client_entry]
		mov	[esp+8], edx	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client

loc_62B90AC5:				; CODE XREF: _silc_client_notify_cumode_change+421j
		mov	edx, [ebp+server]
		test	edx, edx
		jz	short loc_62B90ADF
		mov	ecx, [ebp+server]
		mov	[esp+8], ecx	; server_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_server

loc_62B90ADF:				; CODE XREF: _silc_client_notify_cumode_change+43Ej
		mov	eax, [ebp+channel_entry]
		test	eax, eax
		jz	loc_62B9070D
		mov	eax, [ebp+channel_entry]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		jmp	loc_62B9070D
; ---------------------------------------------------------------------------
		align 4

loc_62B90B04:				; CODE XREF: _silc_client_notify_cumode_change+1D9j
		mov	dword ptr [esp+8], 404h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B9086B
; ---------------------------------------------------------------------------

loc_62B90B35:				; CODE XREF: _silc_client_notify_cumode_change+2FEj
		mov	eax, [ebp+state_context]
		mov	eax, [eax+10h]
		mov	[ebp+client_entry], eax
		test	eax, eax
		jz	loc_62B90C5F

loc_62B90B49:				; CODE XREF: _silc_client_notify_cumode_change+5FDj
		mov	eax, [ebp+client_entry]
		mov	[esp+4], eax	; client_entry
		mov	[esp], channel	; channel
		mov	[ebp+var_A0], edx
		call	_silc_client_on_channel
		test	eax, eax
		mov	edx, [ebp+var_A0]
		jz	loc_62B90C4C
		mov	ecx, [ebp+client_entry]
		mov	[ebp+entry], ecx
		mov	[ebp+server], 0
		mov	[ebp+channel_entry], 0
		jmp	loc_62B909DC
; ---------------------------------------------------------------------------

loc_62B90B8E:				; CODE XREF: _silc_client_notify_cumode_change+306j
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; server_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+var_A0], edx
		call	_silc_client_get_server_by_id
		mov	[ebp+server], eax
		test	eax, eax
		mov	edx, [ebp+var_A0]
		jz	loc_62B90CE6
		mov	eax, [ebp+server]
		mov	[ebp+entry], eax
		mov	[ebp+channel_entry], 0
		mov	[ebp+client_entry], 0
		jmp	loc_62B909DC
; ---------------------------------------------------------------------------

loc_62B90BD7:				; CODE XREF: _silc_client_notify_cumode_change+330j
		mov	eax, [ebp+state_context]
		mov	[eax+0Ch], channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jz	short loc_62B90C1E
		mov	dword ptr [esp+8], 446h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output

loc_62B90C1E:				; CODE XREF: _silc_client_notify_cumode_change+564j
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_resolved ; completion
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel_by_id_resolve
		mov	[channel+17Ch],	ax
		jmp	loc_62B90895
; ---------------------------------------------------------------------------

loc_62B90C4C:				; CODE XREF: _silc_client_notify_cumode_change+4DDj
		mov	[ebp+server], 0
		mov	[ebp+channel_entry], 0
		jmp	out
; ---------------------------------------------------------------------------

loc_62B90C5F:				; CODE XREF: _silc_client_notify_cumode_change+4B7j
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client
		mov	[ebp+client_entry], eax
		test	eax, eax
		mov	edx, [ebp+var_A0]
		jz	short loc_62B90C8F
		test	byte ptr [eax+402h], 1
		jnz	loc_62B90B49

loc_62B90C8F:				; CODE XREF: _silc_client_notify_cumode_change+5F4j
		mov	eax, [ebp+state_context]
		mov	[eax+0Ch], channel
		mov	edx, [ebp+client_entry]
		mov	[eax+10h], edx
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		or	edx, 4
		mov	[ecx+28h], dl
		test	al, 4
		jnz	short loc_62B90D2C

loc_62B90CB0:				; CODE XREF: _silc_client_notify_cumode_change+6CCj
		mov	eax, [ebp+state_context]
		mov	[esp+14h], eax	; context
		mov	dword ptr [esp+10h], offset _silc_client_notify_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id_resolve
		mov	[channel+17Ch],	ax
		jmp	loc_62B90895
; ---------------------------------------------------------------------------

loc_62B90CE6:				; CODE XREF: _silc_client_notify_cumode_change+526j
		mov	edx, [ebp+state_context]
		mov	[edx+0Ch], channel
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		or	edx, 4
		mov	[ecx+28h], dl
		test	al, 4
		jnz	short loc_62B90D5D

loc_62B90CFE:				; CODE XREF: _silc_client_notify_cumode_change+6FDj
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_resolved ; completion
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; server_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_server_by_id_resolve
		mov	[channel+17Ch],	ax
		jmp	loc_62B90895
; ---------------------------------------------------------------------------

loc_62B90D2C:				; CODE XREF: _silc_client_notify_cumode_change+622j
		mov	dword ptr [esp+8], 423h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B90CB0
; ---------------------------------------------------------------------------

loc_62B90D5D:				; CODE XREF: _silc_client_notify_cumode_change+670j
		mov	dword ptr [esp+8], 437h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B90CFE
_silc_client_notify_cumode_change endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 162. silc_client_notify_cmode_change

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_cmode_change(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_cmode_change
_silc_client_notify_cmode_change proc near ; DATA XREF:	_silc_client_notify:loc_62B92424o

var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
entry		= dword	ptr -0BCh
var_B8		= byte ptr -0B8h
var_A1		= byte ptr -0A1h
var_A0		= byte ptr -0A0h
var_9F		= byte ptr -9Fh
var_9E		= word ptr -9Eh
args		= dword	ptr -9Ch
server		= dword	ptr -98h
channel_entry	= dword	ptr -94h
channel		= dword	ptr -90h
hmac		= dword	ptr -8Ch
hash		= byte ptr -84h
id		= SilcID ptr -44h
newhmac		= dword	ptr -24h
founder_key	= dword	ptr -20h
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0FCh
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4Ch]
client = esi				; SilcClient
		mov	eax, [ebp+state_context]
		mov	edi, [eax+4]
payload	= edi				; SilcNotifyPayload
		mov	edx, [eax]
packet = edx				; SilcPacket
		mov	[esp], payload
		mov	[ebp+var_C8], packet
		call	_silc_notify_get_type
		mov	[ebp+var_9E], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	[ebp+founder_key], 0
		mov	dword ptr [esp+10h], 16h
		lea	payload, [ebp+id]
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 3
		mov	edx, [ebp+var_C8]
		mov	al, [edx+21h]
packet = edx				; SilcPacket
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [packet+1Ch]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jnz	loc_62B90ED4
fsm_context_0 =	ebx			; void *
		mov	[ebp+server], 0
		mov	[ebp+channel_entry], 0
		mov	[ebp+channel], 0
		xor	edx, edx

loc_62B90E2E:				; CODE XREF: _silc_client_notify_cmode_change+5C6j
					; _silc_client_notify_cmode_change+5E2j ...
client_entry = edx			; SilcClientEntry
tmp = eax				; unsigned __int8 *
mode = edi				; SilcUInt32
		mov	tmp, [ebp+founder_key]
		test	eax, eax
		jz	short loc_62B90E49
		mov	[esp], eax
		mov	[ebp+var_C8], client_entry
		call	_silc_pkcs_public_key_free
		mov	edx, [ebp+var_C8]

loc_62B90E49:				; CODE XREF: _silc_client_notify_cmode_change+A3j
client_entry = edx			; SilcClientEntry
		test	client_entry, client_entry
		jz	short loc_62B90E5D
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client

loc_62B90E5D:				; CODE XREF: _silc_client_notify_cmode_change+BBj
client_entry = edx			; SilcClientEntry
		mov	eax, [ebp+server]
		test	eax, eax
		jz	short loc_62B90E7D
		mov	client_entry, [ebp+server]
		mov	[esp+8], edx	; server_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_server

loc_62B90E7D:				; CODE XREF: _silc_client_notify_cmode_change+D5j
client_entry = edx			; SilcClientEntry
		mov	mode, [ebp+channel_entry]
		test	edi, edi
		jz	short loc_62B90E9D
		mov	ecx, [ebp+channel_entry]
		mov	[esp+8], ecx	; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel

loc_62B90E9D:				; CODE XREF: _silc_client_notify_cmode_change+F5j
client_entry = edx			; SilcClientEntry
		mov	eax, [ebp+channel]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		xor	eax, eax

loc_62B90EC8:				; CODE XREF: _silc_client_notify_cmode_change+1E0j
					; _silc_client_notify_cmode_change+5EAj
		add	esp, 0FCh
		pop	fsm_context_0
		pop	client
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
client = esi				; SilcClient
		align 4

loc_62B90ED4:				; CODE XREF: _silc_client_notify_cmode_change+78j
		mov	[esp+8], edi	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel_by_id
		mov	[ebp+channel], eax
		test	eax, eax
		jz	out
		cmp	word ptr [eax+17Ch], 0
		jz	short loc_62B90F78
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B91380

loc_62B90F25:				; CODE XREF: _silc_client_notify_cmode_change+61Cj
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_wait_continue ;	reply
		mov	edx, [ebp+channel]
		movzx	eax, word ptr [edx+17Ch]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], fsm_context_0 ; conn
		call	_silc_client_command_pending

loc_62B90F55:				; CODE XREF: _silc_client_notify_cmode_change+796j
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		test	al, 4
		jz	loc_62B91378
		mov	eax, 2
		jmp	loc_62B90EC8
; ---------------------------------------------------------------------------
		align 4

loc_62B90F78:				; CODE XREF: _silc_client_notify_cmode_change+16Aj
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	edx, [ebp+args]
		mov	[esp], edx
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	out
		mov	cl, [tmp]
		mov	[ebp+var_B8], cl
		mov	dl, [tmp+1]
		mov	[ebp+var_A1], dl
		mov	cl, [tmp+2]
		mov	[ebp+var_A0], cl
		mov	al, [tmp+3]
		mov	[ebp+var_9F], al
		mov	dword ptr [esp+10h], 0
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
		mov	ax, [ebp+id.type]
		cmp	ax, 2
		jz	loc_62B913D4
		dec	ax
		jz	loc_62B91427
		mov	[esp+8], edi	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel_by_id
		mov	[ebp+channel_entry], eax
		test	eax, eax
		jz	loc_62B914D5
		mov	eax, [ebp+channel_entry]
		mov	[ebp+entry], eax
		mov	[ebp+server], 0
		xor	edx, edx

loc_62B9103E:				; CODE XREF: _silc_client_notify_cmode_change+692j
					; _silc_client_notify_cmode_change+6CDj
client_entry = edx			; SilcClientEntry
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+144h]
		mov	[esp], eax
		mov	[ebp+var_C8], client_entry
		call	_silc_rwlock_wrlock
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 6
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_C8]
		jz	short loc_62B910B7
		lea	ecx, [ebp+founder_key]
		mov	[esp+8], ecx
		mov	ecx, [ebp+tmp_len]
		mov	[esp+4], ecx
		mov	[esp], tmp
		call	_silc_public_key_payload_decode
		test	al, al
		mov	edx, [ebp+var_C8]
		jz	loc_62B913B4
		mov	eax, [ebp+channel]
		mov	ecx, [eax+10Ch]
		test	ecx, ecx
		jz	loc_62B9152B

loc_62B910B7:				; CODE XREF: _silc_client_notify_cmode_change+2EDj
					; _silc_client_notify_cmode_change+7B1j
tmp = eax				; unsigned __int8 *
		lea	tmp, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		mov	[ebp+var_C8], edx
		call	_silc_argument_get_arg_type
		mov	[ebp+var_C0], eax
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 4
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		call	_silc_argument_get_arg_type
		mov	[ebp+hmac], eax
		test	eax, eax
		mov	edx, [ebp+var_C8]
		jz	loc_62B911CB
		lea	eax, [ebp+newhmac]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+hmac]
		mov	[esp], eax
		call	_silc_hmac_alloc
		test	al, al
		mov	edx, [ebp+var_C8]
		jz	loc_62B913B4
		lea	eax, [ebp+tmp_len]
		mov	[esp+4], eax
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+160h]
		mov	[esp], eax
		mov	[ebp+var_C8], edx
		call	_silc_hmac_get_key
		test	eax, eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_C8]
		jz	short loc_62B911CB
		mov	ecx, [ebp+tmp_len]
		mov	[esp+8], ecx
		mov	[esp+4], tmp
		mov	tmp, [ebp+newhmac]
		mov	[esp], eax
		call	_silc_hmac_set_key
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+160h]
		test	eax, eax
		mov	edx, [ebp+var_C8]
		jz	short loc_62B911A1
		mov	[esp], eax
		call	_silc_hmac_free
		mov	edx, [ebp+var_C8]

loc_62B911A1:				; CODE XREF: _silc_client_notify_cmode_change+401j
		mov	eax, [ebp+newhmac]
		mov	ecx, [ebp+channel]
		mov	[ecx+160h], eax
		lea	eax, [ebp+hash]
		mov	[ebp+var_CC], eax
		mov	ecx, 40h
		xor	eax, eax
		mov	edi, [ebp+var_CC]
		rep stosb

loc_62B911CB:				; CODE XREF: _silc_client_notify_cmode_change+37Bj
					; _silc_client_notify_cmode_change+3D5j
tmp = eax				; unsigned __int8 *
		lea	ecx, [ebp+tmp_len]
		mov	[esp+8], ecx
		mov	dword ptr [esp+4], 5
		mov	tmp, [ebp+args]
		mov	[esp], eax
		mov	[ebp+var_C8], edx
		call	_silc_argument_get_arg_type
		mov	[ebp+var_C4], eax
		lea	ecx, [ebp+tmp_len]
		mov	[esp+8], ecx
		mov	dword ptr [esp+4], 8
		mov	eax, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_arg_type
		mov	ecx, eax
tmp = ecx				; unsigned __int8 *
		test	eax, eax
		mov	edx, [ebp+var_C8]
		jz	short loc_62B91227
tmp = eax				; unsigned __int8 *
		cmp	[ebp+tmp_len], 4
		jz	loc_62B914A6

loc_62B91227:				; CODE XREF: _silc_client_notify_cmode_change+48Bj
					; _silc_client_notify_cmode_change+740j
		mov	tmp, [ebp+channel]
tmp = ecx				; unsigned __int8 *
		test	byte ptr [eax+12Ch], 20h
		jnz	short loc_62B91240
		mov	dword ptr [eax+130h], 0

loc_62B91240:				; CODE XREF: _silc_client_notify_cmode_change+4A4j
		lea	tmp, [ebp+tmp_len]
		mov	[esp+8], ecx
		mov	dword ptr [esp+4], 7
		mov	eax, [ebp+args]
		mov	[esp], eax
		mov	[ebp+var_C8], edx
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_C8]
		jz	loc_62B91462
		mov	dword ptr [esp+0Ch], 0 ; remove_all
		mov	ecx, [ebp+tmp_len]
		mov	[esp+8], ecx	; chpk_list_len
		mov	[esp+4], tmp	; chpk_list
		mov	ecx, [ebp+channel]
		mov	[esp], ecx	; channel
		call	_silc_client_channel_save_public_keys
		mov	edx, [ebp+var_C8]

loc_62B91298:				; CODE XREF: _silc_client_notify_cmode_change+6DFj
					; _silc_client_notify_cmode_change+711j
		movzx	edi, [ebp+var_9F]
mode = edi				; SilcUInt32
		mov	al, [ebp+var_B8]
		shl	eax, 18h
		or	mode, eax
		movzx	eax, [ebp+var_A1]
		shl	eax, 10h
		or	mode, eax
		movzx	eax, [ebp+var_A0]
		shl	eax, 8
		or	mode, eax
		mov	ecx, [ebp+channel]
		mov	[ecx+12Ch], mode
		mov	eax, [ecx+144h]
		mov	[esp], eax
		mov	[ebp+var_C8], edx
		call	_silc_rwlock_unlock
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	ecx, [eax+48h]
		mov	eax, [ebp+channel]
		mov	[esp+2Ch], eax
		mov	dword ptr [esp+28h], 0
		mov	eax, [eax+10Ch]
		mov	[esp+24h], eax
		mov	eax, [ebp+var_C4]
		mov	[esp+20h], eax
		mov	eax, [ebp+hmac]
		mov	[esp+1Ch], eax
		mov	eax, [ebp+var_C0]
		mov	[esp+18h], eax
		mov	[esp+14h], mode
		mov	eax, [ebp+entry]
		mov	[esp+10h], eax
		movzx	eax, [ebp+id.type]
		mov	[esp+0Ch], eax
		movzx	eax, [ebp+var_9E]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		call	dword ptr [ecx+0Ch]
		mov	edx, [ebp+var_C8]
		jmp	loc_62B90E2E
; ---------------------------------------------------------------------------
tmp = eax				; unsigned __int8 *
		align 4

out:					; CODE XREF: _silc_client_notify_cmode_change+15Cj
					; _silc_client_notify_cmode_change+207j ...
		mov	[ebp+server], 0
		mov	[ebp+channel_entry], 0
		xor	edx, edx
client_entry = edx			; SilcClientEntry
		jmp	loc_62B90E2E
; ---------------------------------------------------------------------------
		align 4

loc_62B91378:				; CODE XREF: _silc_client_notify_cmode_change+1D5j
		xor	eax, eax
		jmp	loc_62B90EC8
; ---------------------------------------------------------------------------
		align 10h

loc_62B91380:				; CODE XREF: _silc_client_notify_cmode_change+18Fj
		mov	dword ptr [esp+8], 335h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B90F25
; ---------------------------------------------------------------------------
		align 4

loc_62B913B4:				; CODE XREF: _silc_client_notify_cmode_change+30Dj
					; _silc_client_notify_cmode_change+3A6j
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	edx, [ebp+var_C8]
		jmp	loc_62B90E2E
; ---------------------------------------------------------------------------
		align 4

loc_62B913D4:				; CODE XREF: _silc_client_notify_cmode_change+26Aj
		mov	ecx, [ebp+state_context]
		mov	edx, [ecx+10h]
client_entry = edx			; SilcClientEntry
		test	client_entry, client_entry
		jz	loc_62B91546

loc_62B913E2:				; CODE XREF: _silc_client_notify_cmode_change+7D3j
		mov	[esp+4], client_entry ;	client_entry
		mov	eax, [ebp+channel]
		mov	[esp], eax	; channel
		mov	[ebp+var_C8], client_entry
		call	_silc_client_on_channel
		test	eax, eax
		mov	edx, [ebp+var_C8]
		jz	loc_62B915BD
		mov	[ebp+entry], edx
client_entry = edx			; SilcClientEntry
		mov	[ebp+server], 0
		mov	[ebp+channel_entry], 0
		jmp	loc_62B9103E
; ---------------------------------------------------------------------------

loc_62B91427:				; CODE XREF: _silc_client_notify_cmode_change+272j
		mov	[esp+8], edi	; server_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_server_by_id
		mov	[ebp+server], eax
		test	eax, eax
		jz	loc_62B915D6
		mov	eax, [ebp+server]
		mov	[ebp+entry], eax
		mov	[ebp+channel_entry], 0
		xor	edx, edx
client_entry = edx			; SilcClientEntry
		jmp	loc_62B9103E
; ---------------------------------------------------------------------------

loc_62B91462:				; CODE XREF: _silc_client_notify_cmode_change+4DBj
tmp = eax				; unsigned __int8 *
		mov	tmp, [ebp+channel]
		test	byte ptr [eax+12Dh], 10h
		jz	loc_62B91298
		mov	dword ptr [esp+0Ch], 1 ; remove_all
		mov	dword ptr [esp+8], 0 ; chpk_list_len
		mov	dword ptr [esp+4], 0 ; chpk_list
		mov	[esp], eax	; channel
		mov	[ebp+var_C8], edx
		call	_silc_client_channel_save_public_keys
		mov	edx, [ebp+var_C8]
		jmp	loc_62B91298
; ---------------------------------------------------------------------------

loc_62B914A6:				; CODE XREF: _silc_client_notify_cmode_change+491j
tmp = eax				; unsigned __int8 *
		movzx	edi, byte ptr [tmp+3]
		movzx	tmp, byte ptr [tmp]
tmp = ecx				; unsigned __int8 *
		shl	eax, 18h
		or	edi, eax
		movzx	eax, byte ptr [tmp+1]
		shl	eax, 10h
		or	edi, eax
		movzx	eax, byte ptr [tmp+2]
		shl	eax, 8
		or	edi, eax
		mov	tmp, [ebp+channel]
		mov	[ecx+130h], edi
		jmp	loc_62B91227
; ---------------------------------------------------------------------------

loc_62B914D5:				; CODE XREF: _silc_client_notify_cmode_change+290j
		mov	ecx, [ebp+channel]
		mov	edx, [ebp+state_context]
		mov	[edx+0Ch], ecx
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B9161B

loc_62B914FA:				; CODE XREF: _silc_client_notify_cmode_change+8B7j
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_resolved ; completion
		mov	[esp+8], edi	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel_by_id_resolve

loc_62B91519:				; CODE XREF: _silc_client_notify_cmode_change+828j
					; _silc_client_notify_cmode_change+886j
		mov	edx, [ebp+channel]
		mov	[edx+17Ch], ax
		jmp	loc_62B90F55
; ---------------------------------------------------------------------------

loc_62B9152B:				; CODE XREF: _silc_client_notify_cmode_change+321j
		mov	eax, [ebp+founder_key]
		mov	ecx, [ebp+channel]
		mov	[ecx+10Ch], eax
		mov	[ebp+founder_key], 0
		jmp	loc_62B910B7
; ---------------------------------------------------------------------------

loc_62B91546:				; CODE XREF: _silc_client_notify_cmode_change+64Cj
client_entry = edx			; SilcClientEntry ; client_id
		mov	[esp+8], edi
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client
		mov	edx, eax
client_entry = edx			; SilcClientEntry
		test	eax, eax
		jz	short loc_62B91569
client_entry = eax			; SilcClientEntry
		test	byte ptr [client_entry+402h], 1
		jnz	loc_62B913E2

loc_62B91569:				; CODE XREF: _silc_client_notify_cmode_change+7CAj
		mov	ecx, [ebp+channel]
		mov	client_entry, [ebp+state_context]
client_entry = edx			; SilcClientEntry
		mov	[eax+0Ch], ecx
		mov	[eax+10h], client_entry
		mov	client_entry, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B9167D

loc_62B91591:				; CODE XREF: _silc_client_notify_cmode_change+919j
		mov	eax, [ebp+state_context]
		mov	[esp+14h], eax	; context
		mov	dword ptr [esp+10h], offset _silc_client_notify_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		mov	[esp+8], edi	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id_resolve
		jmp	loc_62B91519
; ---------------------------------------------------------------------------

loc_62B915BD:				; CODE XREF: _silc_client_notify_cmode_change+672j
		mov	[ebp+server], 0
		mov	[ebp+channel_entry], 0
		jmp	loc_62B90E2E
; ---------------------------------------------------------------------------

loc_62B915D6:				; CODE XREF: _silc_client_notify_cmode_change+6AFj
		mov	ecx, [ebp+channel]
		mov	edx, [ebp+state_context]
		mov	[edx+0Ch], ecx
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	short loc_62B9164C

loc_62B915F7:				; CODE XREF: _silc_client_notify_cmode_change+8E8j
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_resolved ; completion
		mov	[esp+8], edi	; server_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_get_server_by_id_resolve
		jmp	loc_62B91519
; ---------------------------------------------------------------------------

loc_62B9161B:				; CODE XREF: _silc_client_notify_cmode_change+764j
		mov	dword ptr [esp+8], 373h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B914FA
; ---------------------------------------------------------------------------

loc_62B9164C:				; CODE XREF: _silc_client_notify_cmode_change+865j
		mov	dword ptr [esp+8], 364h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B915F7
; ---------------------------------------------------------------------------

loc_62B9167D:				; CODE XREF: _silc_client_notify_cmode_change+7FBj
		mov	dword ptr [esp+8], 350h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B91591
_silc_client_notify_cmode_change endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 171. silc_client_notify_nick_change

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_nick_change(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_nick_change
_silc_client_notify_nick_change	proc near ; DATA XREF: _silc_client_notify:loc_62B92440o

var_180		= dword	ptr -180h
var_17C		= dword	ptr -17Ch
new_nick	= dword	ptr -178h
var_173		= byte ptr -173h
var_172		= word ptr -172h
client		= dword	ptr -170h
args		= dword	ptr -16Ch
oldnick		= byte ptr -15Dh
id2		= SilcID ptr -5Ch
id		= SilcID ptr -3Ch
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 19Ch
		mov	eax, [ebp+fsm_context]
		mov	eax, [eax+4Ch]
		mov	[ebp+client], eax
		mov	eax, [ebp+state_context]
		mov	ebx, [eax+4]
payload	= ebx				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_172], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	dword ptr [esp+10h], 0
		lea	payload, [ebp+id]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
		mov	edx, [ebp+fsm_context]
		mov	edi, [edx+4]
		test	edi, edi
		jz	short loc_62B91733
		mov	ecx, 1Dh
		mov	esi, ebx
		repe cmpsb
		jz	out

loc_62B91733:				; CODE XREF: _silc_client_notify_nick_change+72j
		mov	dword ptr [esp+10h], 0
		lea	eax, [ebp+id2]
		mov	[ebp+var_17C], eax
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	eax, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
		mov	edx, [ebp+fsm_context]
		mov	edi, [edx+4]
		test	edi, edi
		jz	short loc_62B9178B
		mov	ecx, 1Dh
		mov	esi, [ebp+var_17C]
		repe cmpsb
		jz	out

loc_62B9178B:				; CODE XREF: _silc_client_notify_nick_change+C6j
		mov	[esp+8], ebx	; client_id
		mov	eax, [ebp+fsm_context]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_client_by_id
		mov	ebx, eax
client_entry = ebx			; SilcClientEntry
		test	eax, eax
		jz	loc_62B9189A
client_entry = eax			; SilcClientEntry
		mov	al, [client_entry+402h]
client_entry = ebx			; SilcClientEntry
		and	eax, 1
		mov	[ebp+var_173], al
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	edx, [ebp+args]
		mov	[esp], edx
		call	_silc_argument_get_arg_type
		mov	edx, eax
tmp = edx				; unsigned __int8 *
		test	eax, eax
		jz	loc_62B9189A
tmp = eax				; unsigned __int8 *
		mov	tmp, [client_entry+3D8h]
tmp = edx				; unsigned __int8 *
		mov	[esp], eax
		mov	[ebp+new_nick],	tmp
		call	_silc_rwlock_wrlock
		lea	esi, [client_entry+39Eh]
		lea	edi, [ebp+id2.u+12h]
		mov	ecx, 0Bh
		repe cmpsb
		mov	edx, [ebp+new_nick]
		jnz	loc_62B918D4
		mov	[esp+4], client_entry
		mov	[esp], edx
tmp = edx				; unsigned __int8 *
		call	_silc_utf8_strcasecmp
		test	al, al
		mov	edx, [ebp+new_nick]
		jz	loc_62B918D4
		mov	edx, [ebp+fsm_context]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		lea	eax, [ebp+id2]
		mov	[esp+8], eax
		mov	[esp+4], client_entry
		mov	edx, [ebp+fsm_context]
		mov	eax, [edx+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_update_by_context
		mov	edx, [ebp+fsm_context]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	eax, [client_entry+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		jmp	short loc_62B9189A
; ---------------------------------------------------------------------------
		align 4

out:					; CODE XREF: _silc_client_notify_nick_change+64j
					; _silc_client_notify_nick_change+7Dj ...
		xor	ebx, ebx

loc_62B9189A:				; CODE XREF: _silc_client_notify_nick_change+F8j
					; _silc_client_notify_nick_change+12Ej	...
client_entry = ebx			; SilcClientEntry ; client_entry
tmp = eax				; unsigned __int8 *
		mov	[esp+8], client_entry
		mov	tmp, [ebp+fsm_context]
tmp = edx				; unsigned __int8 *
		mov	[esp+4], eax	; conn
		mov	tmp, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_client
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 19Ch
		pop	client_entry
client_entry = esi			; SilcClientEntry
		pop	client_entry
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
client_entry = ebx			; SilcClientEntry
		align 4

loc_62B918D4:				; CODE XREF: _silc_client_notify_nick_change+15Ej
					; _silc_client_notify_nick_change+178j
		lea	eax, [ebp+oldnick]
		mov	[ebp+var_180], eax
		mov	ecx, 101h
		mov	edi, eax
		mov	esi, client_entry
		rep movsb
client_entry = esi			; SilcClientEntry
		mov	dword ptr [esp+18h], 0 ; idp_len
		mov	dword ptr [esp+14h], 0 ; idp
		lea	eax, [ebp+id2]
		mov	[esp+10h], eax	; new_id
		mov	[esp+0Ch], edx	; new_nick
tmp = edx				; unsigned __int8 *
		mov	[esp+8], ebx	; client_entry
		mov	tmp, [ebp+fsm_context]
		mov	[esp+4], edx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_change_nickname
		test	al, al
		jz	short loc_62B91980
client_entry = ebx			; SilcClientEntry
		mov	eax, [client_entry+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		cmp	[ebp+var_173], 0
		jz	loc_62B9189A
		mov	edx, [ebp+fsm_context]
		mov	eax, [edx+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	[esp+14h], client_entry
		lea	edx, [ebp+oldnick]
		mov	[esp+10h], edx
		mov	[esp+0Ch], client_entry
		movzx	edx, [ebp+var_172]
type = edx				; SilcNotifyType
		mov	[esp+8], type
		mov	type, [ebp+fsm_context]
		mov	[esp+4], edx
		mov	edx, [ebp+client]
		mov	[esp], edx
		call	dword ptr [eax+0Ch]
		jmp	loc_62B9189A
; ---------------------------------------------------------------------------
		align 10h

loc_62B91980:				; CODE XREF: _silc_client_notify_nick_change+271j
		mov	eax, [client_entry+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		jmp	loc_62B9189A
_silc_client_notify_nick_change	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 176. silc_client_notify_topic_set

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_topic_set(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_topic_set
_silc_client_notify_topic_set proc near	; DATA XREF: _silc_client_notify:loc_62B9245Co

var_68		= dword	ptr -68h
entry		= dword	ptr -64h
server		= dword	ptr -60h
client_entry	= dword	ptr -5Ch
channel_entry	= dword	ptr -58h
var_52		= word ptr -52h
args		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -3Ch
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	esi, [ebp+fsm_context]
		mov	edi, [ebp+state_context]
		mov	eax, [esi+4Ch]
		mov	[ebp+client], eax
		mov	edx, [edi+4]
payload	= edx				; SilcNotifyPayload
		mov	ebx, [edi]
packet = ebx				; SilcPacket
		mov	[esp], payload
		mov	[ebp+var_68], payload
		call	_silc_notify_get_type
		mov	[ebp+var_52], ax
		mov	edx, [ebp+var_68]
		mov	[esp], edx
payload	= edx				; SilcNotifyPayload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	dword ptr [esp+10h], 16h
		lea	edx, [ebp+id]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 3
		mov	al, [packet+21h]
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [packet+1Ch]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jnz	short loc_62B91A30
fsm_context_0 =	esi			; void *
state_context_0	= edi			; void *
		xor	packet,	packet

out:					; CODE XREF: _silc_client_notify_topic_set+B6j
					; _silc_client_notify_topic_set+164j ...
channel	= ebx				; SilcChannelEntry ; channel_entry
		mov	[esp+8], channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next
		xor	eax, eax

loc_62B91A25:				; CODE XREF: _silc_client_notify_topic_set+322j
		add	esp, 7Ch
		pop	channel
		pop	fsm_context_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
state_context_0	= edi			; void *
packet = ebx				; SilcPacket
		align 10h

loc_62B91A30:				; CODE XREF: _silc_client_notify_topic_set+65j
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_channel_by_id
		mov	packet,	eax
channel	= ebx				; SilcChannelEntry
		test	eax, eax
		jz	short out
channel	= eax				; SilcChannelEntry
		cmp	word ptr [channel+17Ch], 0
		jz	short loc_62B91ACC
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_channel
channel	= ebx				; SilcChannelEntry
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		or	edx, 4
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B91CBC

loc_62B91A7F:				; CODE XREF: _silc_client_notify_topic_set+354j
		mov	[esp+10h], state_context_0 ; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_wait_continue ;	reply
		movzx	eax, word ptr [channel+17Ch]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], fsm_context_0 ; conn
		call	_silc_client_command_pending
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jz	loc_62B91CB4

loc_62B91ABF:				; CODE XREF: _silc_client_notify_topic_set+318j
		mov	eax, 2
		add	esp, 7Ch
		pop	channel
		pop	fsm_context_0
		pop	state_context_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B91ACC:				; CODE XREF: _silc_client_notify_topic_set+C0j
fsm_context_0 =	esi			; void *
state_context_0	= edi			; void *
channel	= eax				; SilcChannelEntry
		mov	dword ptr [esp+10h], 0
		lea	channel, [ebp+id]
channel	= ebx				; SilcChannelEntry
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	edx, [ebp+args]
		mov	[esp], edx
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		call	_silc_argument_get_arg_type
		mov	[ebp+args], eax
		test	eax, eax
		jz	out
		mov	ax, [ebp+id.type]
		cmp	ax, 2
		jz	loc_62B91CF0
		dec	ax
		jz	loc_62B91D2C
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel_by_id
		mov	[ebp+channel_entry], eax
		test	eax, eax
		jz	loc_62B91C57
		mov	eax, [ebp+channel_entry]
		mov	[ebp+entry], eax
		mov	[ebp+server], 0
		mov	[ebp+client_entry], 0

loc_62B91B6E:				; CODE XREF: _silc_client_notify_topic_set+391j
					; _silc_client_notify_topic_set+3CDj
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	eax, [channel+108h]
		mov	[esp], eax
		call	_silc_free
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	state_context_0, [ebp+args]
tmp = edi				; unsigned __int8 *
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+4], ecx
		mov	edx, [ebp+args]
		mov	[esp], edx
		call	_silc_memdup
		mov	[channel+108h],	eax
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	edx, [eax+48h]
		mov	[esp+18h], channel
		mov	eax, [channel+108h]
		mov	[esp+14h], eax
		mov	ecx, [ebp+entry]
		mov	[esp+10h], ecx
		movzx	eax, [ebp+id.type]
		mov	[esp+0Ch], eax
		movzx	eax, [ebp+var_52]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	type, [ebp+client]
		mov	[esp], eax
		call	dword ptr [edx+0Ch]
		mov	edx, [ebp+client_entry]
		test	edx, edx
		jz	short loc_62B91C14
		mov	edx, [ebp+client_entry]
		mov	[esp+8], edx	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_client

loc_62B91C14:				; CODE XREF: _silc_client_notify_topic_set+268j
		mov	eax, [ebp+server]
		test	eax, eax
		jz	short loc_62B91C31
		mov	eax, [ebp+server]
		mov	[esp+8], eax	; server_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_server

loc_62B91C31:				; CODE XREF: _silc_client_notify_topic_set+285j
		mov	edi, [ebp+channel_entry]
		test	edi, edi
		jz	out
		mov	ecx, [ebp+channel_entry]
		mov	[esp+8], ecx	; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		jmp	out
; ---------------------------------------------------------------------------

loc_62B91C57:				; CODE XREF: _silc_client_notify_topic_set+1C0j
state_context_0	= edi			; void *
		mov	[state_context_0+0Ch], channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B91E20

loc_62B91C73:				; CODE XREF: _silc_client_notify_topic_set+4B8j
		mov	[esp+10h], state_context_0 ; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_resolved ; completion
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; channel_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_channel_by_id_resolve

loc_62B91C95:				; CODE XREF: _silc_client_notify_topic_set+448j
					; _silc_client_notify_topic_set+487j
		mov	[channel+17Ch],	ax
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B91ABF
		xchg	ax, ax

loc_62B91CB4:				; CODE XREF: _silc_client_notify_topic_set+125j
		xor	eax, eax
		jmp	loc_62B91A25
; ---------------------------------------------------------------------------
		align 4

loc_62B91CBC:				; CODE XREF: _silc_client_notify_topic_set+E5j
		mov	dword ptr [esp+8], 25Ah
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B91A7F
; ---------------------------------------------------------------------------
		align 10h

loc_62B91CF0:				; CODE XREF: _silc_client_notify_topic_set+197j
		mov	eax, [state_context_0+10h]
		mov	[ebp+client_entry], eax
		test	eax, eax
		jz	short loc_62B91D66

loc_62B91CFA:				; CODE XREF: _silc_client_notify_topic_set+3F6j
		mov	eax, [ebp+client_entry]
		mov	[esp+4], eax	; client_entry
		mov	[esp], channel	; channel
		call	_silc_client_on_channel
		test	eax, eax
		jz	out
		mov	edx, [ebp+client_entry]
		mov	[ebp+entry], edx
		mov	[ebp+server], 0
		mov	[ebp+channel_entry], 0
		jmp	loc_62B91B6E
; ---------------------------------------------------------------------------
		align 4

loc_62B91D2C:				; CODE XREF: _silc_client_notify_topic_set+19Fj
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx	; server_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_server_by_id
		mov	[ebp+server], eax
		test	eax, eax
		jz	loc_62B91DE1
		mov	eax, [ebp+server]
		mov	[ebp+entry], eax
		mov	[ebp+channel_entry], 0
		mov	[ebp+client_entry], 0
		jmp	loc_62B91B6E
; ---------------------------------------------------------------------------

loc_62B91D66:				; CODE XREF: _silc_client_notify_topic_set+364j
		lea	edx, [ebp+id]
		mov	[esp+8], edx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_client
		mov	[ebp+client_entry], eax
		test	eax, eax
		jz	short loc_62B91D90
		test	byte ptr [eax+402h], 1
		jnz	loc_62B91CFA

loc_62B91D90:				; CODE XREF: _silc_client_notify_topic_set+3EDj
		mov	[state_context_0+0Ch], channel
		mov	eax, [ebp+client_entry]
		mov	[state_context_0+10h], eax
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B91E82

loc_62B91DB2:				; CODE XREF: _silc_client_notify_topic_set+51Aj
		mov	[esp+14h], state_context_0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_notify_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_client_by_id_resolve
		jmp	loc_62B91C95
; ---------------------------------------------------------------------------

loc_62B91DE1:				; CODE XREF: _silc_client_notify_topic_set+3B3j
		mov	[state_context_0+0Ch], channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	short loc_62B91E51

loc_62B91DF9:				; CODE XREF: _silc_client_notify_topic_set+4E9j
		mov	[esp+10h], state_context_0 ; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_resolved ; completion
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; server_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_server_by_id_resolve
		jmp	loc_62B91C95
; ---------------------------------------------------------------------------

loc_62B91E20:				; CODE XREF: _silc_client_notify_topic_set+2D9j
		mov	dword ptr [esp+8], 297h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B91C73
; ---------------------------------------------------------------------------

loc_62B91E51:				; CODE XREF: _silc_client_notify_topic_set+463j
		mov	dword ptr [esp+8], 288h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B91DF9
; ---------------------------------------------------------------------------

loc_62B91E82:				; CODE XREF: _silc_client_notify_topic_set+418j
		mov	dword ptr [esp+8], 274h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B91DB2
_silc_client_notify_topic_set endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 166. silc_client_notify_join

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_join(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_join
_silc_client_notify_join proc near	; DATA XREF: _silc_client_notify:loc_62B924B0o

client_entry	= dword	ptr -48h
var_42		= word ptr -42h
args		= dword	ptr -40h
client		= dword	ptr -3Ch
id		= SilcID ptr -38h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4Ch]
		mov	[ebp+client], eax
		mov	edx, [ebp+state_context]
		mov	esi, [edx+4]
payload	= esi				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_type
		mov	[ebp+var_42], ax
		mov	[esp], payload
		call	_silc_notify_get_args
		mov	[ebp+args], eax
		mov	dword ptr [esp+10h], 0
		lea	edi, [ebp+id]
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jnz	short loc_62B91F40
fsm_context_0 =	ebx			; void *
		xor	payload, payload

out:					; CODE XREF: _silc_client_notify_join+A3j
					; _silc_client_notify_join+155j ...
channel	= esi				; SilcChannelEntry ; channel_entry
		mov	[esp+8], channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_notify_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B91F40:				; CODE XREF: _silc_client_notify_join+58j
fsm_context_0 =	ebx			; void * ; channel_id
payload	= esi				; SilcNotifyPayload
		mov	[esp+8], edi
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel_by_id
		mov	payload, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		jz	short out
channel	= eax				; SilcChannelEntry
		cmp	word ptr [channel+17Ch], 0
		jz	short loc_62B91FE0
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	channel, [ebp+client]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B9216C

loc_62B91F8F:				; CODE XREF: _silc_client_notify_join+2E4j
		mov	eax, [ebp+state_context]
		mov	[esp+10h], eax	; context
		mov	dword ptr [esp+0Ch], offset _silc_client_notify_wait_continue ;	reply
		movzx	eax, word ptr [channel+17Ch]
		mov	[esp+8], eax	; ident
		mov	dword ptr [esp+4], 0 ; command
		mov	[esp], fsm_context_0 ; conn
		call	_silc_client_command_pending
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jz	loc_62B92162

loc_62B91FD2:				; CODE XREF: _silc_client_notify_join+2A8j
		mov	eax, 2
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
channel	= eax				; SilcChannelEntry
		align 10h

loc_62B91FE0:				; CODE XREF: _silc_client_notify_join+ADj
		mov	dword ptr [esp+10h], 0
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	channel, [ebp+args]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax
		call	_silc_argument_get_decoded
		test	al, al
		jz	out
		mov	ecx, [ebp+state_context]
		mov	edx, [ecx+10h]
client_entry = edx			; SilcClientEntry
		test	client_entry, client_entry
		jz	loc_62B920CC

loc_62B9201D:				; CODE XREF: _silc_client_notify_join+22Fj
		test	byte ptr [client_entry+402h], 1
		jz	loc_62B920EC
		cmp	byte ptr [client_entry+101h], 0
		jz	loc_62B920EC
		mov	eax, [client_entry+3D8h]
		mov	[esp], eax
		mov	[ebp+client_entry], client_entry
		call	_silc_rwlock_wrlock
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	edx, [ebp+client_entry]
		cmp	[fsm_context_0], edx
client_entry = edx			; SilcClientEntry
		jz	short loc_62B9207B
		mov	dword ptr [esp+0Ch], 0 ; priority
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_nickname_format
		mov	edx, [ebp+client_entry]

loc_62B9207B:				; CODE XREF: _silc_client_notify_join+1A7j
client_entry = edx			; SilcClientEntry ; cumode
		mov	dword ptr [esp+10h], 0
		mov	[esp+0Ch], client_entry	; client_entry
		mov	[esp+8], channel ; channel
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		mov	[ebp+client_entry], client_entry
		call	_silc_client_add_to_channel
		test	al, al
		mov	edx, [ebp+client_entry]
		jnz	loc_62B921D7
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	edx, [ebp+client_entry]
		mov	eax, [edx+3D8h]
client_entry = edx			; SilcClientEntry
		mov	[esp], eax
		call	_silc_rwlock_unlock
		jmp	out
; ---------------------------------------------------------------------------

loc_62B920CC:				; CODE XREF: _silc_client_notify_join+163j
client_entry = edx			; SilcClientEntry ; client_id
		mov	[esp+8], edi
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_client
		mov	edx, eax
client_entry = edx			; SilcClientEntry
		test	eax, eax
		jnz	loc_62B9201D
client_entry = eax			; SilcClientEntry
		lea	channel, [channel+0]

loc_62B920EC:				; CODE XREF: _silc_client_notify_join+170j
					; _silc_client_notify_join+17Dj
		mov	ecx, [ebp+state_context]
		mov	[ecx+0Ch], channel
		mov	[ecx+10h], edx
		mov	client_entry, [ebp+fsm]
client_entry = edx			; SilcClientEntry
		mov	al, [eax+28h]
		mov	byte ptr [ebp+args], al
		or	eax, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], al
		test	byte ptr [ebp+args], 4
		jnz	loc_62B921A0

loc_62B92111:				; CODE XREF: _silc_client_notify_join+31Ej
		test	client_entry, client_entry
		jz	short loc_62B9211B
		lea	edi, [client_entry+38Ch]

loc_62B9211B:				; CODE XREF: _silc_client_notify_join+25Fj
		mov	eax, [ebp+state_context]
		mov	[esp+14h], eax	; context
		mov	dword ptr [esp+10h], offset _silc_client_notify_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		mov	[esp+8], edi	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	client_entry, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_client_by_id_resolve
		mov	[channel+17Ch],	ax
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B91FD2

loc_62B92162:				; CODE XREF: _silc_client_notify_join+118j
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9216C:				; CODE XREF: _silc_client_notify_join+D5j
fsm_context_0 =	ebx			; void *
channel	= esi				; SilcChannelEntry
		mov	dword ptr [esp+8], 181h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B91F8F
; ---------------------------------------------------------------------------
client_entry = edx			; SilcClientEntry
		align 10h

loc_62B921A0:				; CODE XREF: _silc_client_notify_join+257j
		mov	dword ptr [esp+8], 198h
		mov	dword ptr [esp+4], offset aClient_notify_ ; "client_notify.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_3	; "SILC_VERIFY %s:%d"
		mov	[ebp+client_entry], client_entry
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		mov	edx, [ebp+client_entry]
		jmp	loc_62B92111
; ---------------------------------------------------------------------------

loc_62B921D7:				; CODE XREF: _silc_client_notify_join+1EEj
		mov	eax, [channel+144h]
		mov	[esp], eax
		mov	[ebp+client_entry], edx
		call	_silc_rwlock_unlock
		mov	edx, [ebp+client_entry]
		mov	eax, [edx+3D8h]
client_entry = edx			; SilcClientEntry
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	eax, [fsm_context_0+4Ch]
		mov	eax, [eax+18h]
		mov	ecx, [eax+48h]
		mov	[esp+10h], channel
		mov	edx, [ebp+client_entry]
		mov	[esp+0Ch], edx
client_entry = edx			; SilcClientEntry
		movzx	eax, [ebp+var_42]
type = eax				; SilcNotifyType
		mov	[esp+8], type
		mov	[esp+4], fsm_context_0
		mov	type, [ebp+client]
		mov	[esp], eax
		call	dword ptr [ecx+0Ch]
		mov	edx, [ebp+client_entry]
		mov	[esp+8], edx	; client_entry
client_entry = edx			; SilcClientEntry
		mov	[esp+4], fsm_context_0 ; conn
		mov	client_entry, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_client
		jmp	out
_silc_client_notify_join endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 173. silc_client_notify_processed

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify_processed(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_notify_processed
_silc_client_notify_processed proc near	; DATA XREF: _silc_client_notify_watch+73o
					; _silc_client_notify_error:outo ...

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, [ebp+state_context]
		mov	esi, [ebx]
packet = esi				; SilcPacket
		mov	eax, [ebx+4]
		mov	[esp], eax
		call	_silc_notify_payload_free
		mov	[esp], packet
		call	_silc_packet_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, 3
		add	esp, 10h
		pop	ebx
		pop	packet
		leave
		retn
_silc_client_notify_processed endp

; Exported entry 160. silc_client_notify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_notify(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_notify
_silc_client_notify proc near		; DATA XREF: _silc_client_connection_st_packet:loc_62B81EA4o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	ebx, [ebp+state_context]
		mov	edx, [ebx+0Ch]
		mov	eax, [ebx+10h]
		sub	eax, edx
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_notify_payload_parse
		mov	esi, eax
payload	= esi				; SilcNotifyPayload
		test	eax, eax
		jz	short loc_62B9230C
state_context_0	= ebx			; void *
payload	= eax				; SilcNotifyPayload
		mov	[esp], payload
		call	_silc_notify_get_args
payload	= esi				; SilcNotifyPayload
		test	eax, eax
		jz	short loc_62B92304
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	edi, eax
notify = edi				; SilcClientNotify
		test	eax, eax
		jz	short loc_62B92330
notify = eax				; SilcClientNotify
		mov	[notify], state_context_0
		mov	[notify+4], payload
		mov	notify,	[ebp+fsm]
notify = edi				; SilcClientNotify
		mov	[notify+8], eax
		mov	[esp+4], notify
		mov	[esp], eax
		call	_silc_fsm_set_state_context
		mov	[esp], payload
		call	_silc_notify_get_type
		cmp	ax, 11h		; switch 18 cases
		jbe	short loc_62B92324

loc_62B922E5:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	[esp], payload	; jumptable 62B92327 default case
		call	_silc_notify_payload_free
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	[esp], notify
		call	_silc_free
		mov	eax, 3
		jmp	short loc_62B92319
; ---------------------------------------------------------------------------

loc_62B92304:				; CODE XREF: _silc_client_notify+30j
		mov	[esp], payload
		call	_silc_notify_payload_free

loc_62B9230C:				; CODE XREF: _silc_client_notify+24j
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3

loc_62B92319:				; CODE XREF: _silc_client_notify+8Ej
					; _silc_client_notify+F1j ...
notify = edi				; SilcClientNotify
		add	esp, 1Ch
		pop	state_context_0
		pop	payload
		pop	notify
		leave
		retn
; ---------------------------------------------------------------------------
state_context_0	= ebx			; void *
notify = edi				; SilcClientNotify
payload	= esi				; SilcNotifyPayload
		align 4

loc_62B92324:				; CODE XREF: _silc_client_notify+6Fj
		movzx	eax, ax
		jmp	ds:off_62BA8888[eax*4] ; switch	jump
; ---------------------------------------------------------------------------
notify = eax				; SilcClientNotify
		align 10h

loc_62B92330:				; CODE XREF: _silc_client_notify+4Aj
		mov	[esp], payload
		call	_silc_notify_payload_free
notify = edi				; SilcClientNotify
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3
		add	esp, 1Ch
		pop	state_context_0
		pop	payload
		pop	notify
		leave
		retn
; ---------------------------------------------------------------------------
state_context_0	= ebx			; void *
notify = edi				; SilcClientNotify
payload	= esi				; SilcNotifyPayload
		align 10h

loc_62B92350:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_watch ; jumptable	62B92327 case 17
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B92368:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_error ; jumptable	62B92327 case 16
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B92319
; ---------------------------------------------------------------------------
		align 10h

loc_62B92380:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_killed ; jumptable 62B92327 case 13
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B92398:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_kicked ; jumptable 62B92327 case 12
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B923B4:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_server_signoff ; jumptable 62B92327 case 11
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 10h

loc_62B923D0:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_channel_change ; jumptable 62B92327 case 10
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B923EC:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_motd ; jumptable 62B92327	case 9
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B92408:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_cumode_change ; jumptable	62B92327 case 8
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B92424:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_cmode_change ; jumptable 62B92327	case 7
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 10h

loc_62B92440:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_nick_change ; jumptable 62B92327 case 6
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B9245C:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_topic_set	; jumptable 62B92327 case 5
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B92478:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_signoff ;	jumptable 62B92327 case	4
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B92494:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_leave ; jumptable	62B92327 case 3
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 10h

loc_62B924B0:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_join ; jumptable 62B92327	case 2
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B924CC:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_invite ; jumptable 62B92327 case 1
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
; ---------------------------------------------------------------------------
		align 4

loc_62B924E8:				; CODE XREF: _silc_client_notify+B3j
					; DATA XREF: .rdata:off_62BA8888o
		mov	dword ptr [esp+4], offset _silc_client_notify_none ; jumptable 62B92327	case 0
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B92319
_silc_client_notify endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 184. silc_client_private_message_key_is_set

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_private_message_key_is_set(SilcClient client, SilcClientConnection conn,	SilcClientEntry	client_entry)
		public _silc_client_private_message_key_is_set
_silc_client_private_message_key_is_set	proc near

client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+client_entry]
		mov	eax, [eax+3DCh]
		test	eax, eax
		setnz	al
		leave
		retn
_silc_client_private_message_key_is_set	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 119. silc_client_free_private_message_keys

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_free_private_message_keys(SilcPrivateMessageKeys keys, SilcUInt32 key_count)
		public _silc_client_free_private_message_keys
_silc_client_free_private_message_keys proc near

keys		= dword	ptr  8
key_count	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		leave
		jmp	_silc_free
_silc_client_free_private_message_keys endp

; Exported entry 202. silc_client_set_away_message

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_set_away_message(SilcClient client, SilcClientConnection	conn, char *message)
		public _silc_client_set_away_message
_silc_client_set_away_message proc near

client		= dword	ptr  8
conn		= dword	ptr  0Ch
message		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	ebx, [ebp+conn]
		mov	edi, [ebp+message]
		mov	ecx, [ebp+client]
		test	ecx, ecx
		jz	short loc_62B92580
conn_0 = ebx				; SilcClientConnection
message_0 = edi				; char *
		test	conn_0,	conn_0
		jz	short loc_62B92580
		test	message_0, message_0
		jz	short loc_62B9258C
		mov	esi, [conn_0+54h]
		mov	eax, [esi+110h]
		test	eax, eax
		jz	short loc_62B9255A
		mov	[esp], eax
		call	_silc_free
		mov	esi, [conn_0+54h]

loc_62B9255A:				; CODE XREF: _silc_client_set_away_message+29j
		mov	[esp], message_0 ; char	*
		call	_strdup
		mov	[esi+110h], eax
		mov	eax, [conn_0+54h]
		mov	edx, [eax+110h]
		test	edx, edx
		setnz	al

loc_62B92576:				; CODE XREF: _silc_client_set_away_message+88j
		add	esp, 1Ch
		pop	conn_0
		pop	esi
		pop	message_0
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
message_0 = edi				; char *
		align 10h

loc_62B92580:				; CODE XREF: _silc_client_set_away_message+14j
					; _silc_client_set_away_message+18j
		xor	eax, eax
		add	esp, 1Ch
		pop	conn_0
		pop	esi
		pop	message_0
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = ebx				; SilcClientConnection
message_0 = edi				; char *
		align 4

loc_62B9258C:				; CODE XREF: _silc_client_set_away_message+1Cj
		mov	eax, [conn_0+54h]
		mov	eax, [eax+110h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [conn_0+54h]
		mov	dword ptr [eax+110h], 0
		mov	al, 1
		jmp	short loc_62B92576
_silc_client_set_away_message endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 150. silc_client_list_private_message_keys

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcPrivateMessageKeys __cdecl silc_client_list_private_message_keys(SilcClient client, SilcClientConnection conn, SilcUInt32	*key_count)
		public _silc_client_list_private_message_keys
_silc_client_list_private_message_keys proc near

count		= dword	ptr -40h
keys		= dword	ptr -3Ch
list		= SilcList ptr -2Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
key_count	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ecx, [ebp+client]
		test	ecx, ecx
		jnz	short loc_62B925D4

loc_62B925C0:				; CODE XREF: _silc_client_list_private_message_keys+29j
		mov	[ebp+keys], 0

loc_62B925C7:				; CODE XREF: _silc_client_list_private_message_keys+E1j
					; _silc_client_list_private_message_keys+185j ...
		mov	eax, [ebp+keys]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_62B925D4:				; CODE XREF: _silc_client_list_private_message_keys+Ej
		mov	edx, [ebp+conn]
		test	edx, edx
		jz	short loc_62B925C0
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		lea	eax, [ebp+list]
		mov	[esp+4], eax
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+114h]
		mov	[esp], eax
		call	_silc_idcache_get_all
		test	al, al
		jz	loc_62B9271A
		mov	dword ptr [esp+4], 10h
		mov	eax, dword ptr [ebp+list._bf10]
		shr	eax, 2
		mov	[esp], eax
		call	_silc_calloc
		mov	[ebp+keys], eax
		test	eax, eax
		jz	loc_62B9273A
		mov	ebx, [ebp+list.head]
		mov	[ebp+list.current], ebx
		mov	dl, [ebp+list._bf10]
		and	edx, 0FFFFFFFDh
		mov	[ebp+list._bf10], dl
		mov	esi, [ebp+keys]
		mov	[ebp+count], 0

loc_62B9264C:				; CODE XREF: _silc_client_list_private_message_keys+149j
		and	edx, 2
		movzx	edi, [ebp+list.prev_offset]
		movzx	ecx, [ebp+list.next_offset]
		test	ebx, ebx
		jz	short loc_62B92678
		nop

loc_62B9265C:				; CODE XREF: _silc_client_list_private_message_keys+C6j
		test	dl, dl
		jz	short loc_62B926AC
		mov	eax, [ebx+edi]
		mov	[ebp+list.current], eax
		mov	ebx, [ebx+0Ch]
entry =	ebx				; SilcClientEntry
		cmp	dword ptr [entry+3DCh],	0
		jnz	short loc_62B926BE

loc_62B92672:				; CODE XREF: _silc_client_list_private_message_keys+10Cj
		mov	entry, eax
		test	ebx, ebx
		jnz	short loc_62B9265C

loc_62B92678:				; CODE XREF: _silc_client_list_private_message_keys+A9j
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	eax, [ebp+key_count]
		test	eax, eax
		jz	loc_62B925C7
		mov	edx, [ebp+count]
		mov	eax, [ebp+key_count]
		mov	[eax], edx
		mov	eax, [ebp+keys]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_62B926AC:				; CODE XREF: _silc_client_list_private_message_keys+AEj
		mov	eax, [ebx+ecx]
		mov	[ebp+list.current], eax
		mov	ebx, [ebx+0Ch]
entry =	ebx				; SilcClientEntry
		cmp	dword ptr [entry+3DCh],	0
		jz	short loc_62B92672

loc_62B926BE:				; CODE XREF: _silc_client_list_private_message_keys+C0j
		mov	[esi], entry
		mov	eax, [entry+3DCh]
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	[esi+4], eax
		test	byte ptr [entry+402h], 2
		jz	short loc_62B92700
		xor	eax, eax
		mov	[esi+8], eax
		test	byte ptr [entry+402h], 2
		jz	short loc_62B92712

loc_62B926E8:				; CODE XREF: _silc_client_list_private_message_keys+160j
		xor	eax, eax

loc_62B926EA:				; CODE XREF: _silc_client_list_private_message_keys+168j
		mov	[esi+0Ch], eax
		inc	[ebp+count]
		mov	entry, [ebp+list.current]
		add	esi, 10h
		mov	dl, [ebp+list._bf10]
		jmp	loc_62B9264C
; ---------------------------------------------------------------------------
entry =	ebx				; SilcClientEntry
		align 10h

loc_62B92700:				; CODE XREF: _silc_client_list_private_message_keys+128j
		mov	eax, [entry+3ECh]
		mov	[esi+8], eax
		test	byte ptr [entry+402h], 2
		jnz	short loc_62B926E8

loc_62B92712:				; CODE XREF: _silc_client_list_private_message_keys+136j
		mov	eax, [entry+3F0h]
		jmp	short loc_62B926EA
; ---------------------------------------------------------------------------

loc_62B9271A:				; CODE XREF: _silc_client_list_private_message_keys+5Cj
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[ebp+keys], 0
		jmp	loc_62B925C7
; ---------------------------------------------------------------------------

loc_62B9273A:				; CODE XREF: _silc_client_list_private_message_keys+7Dj
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		jmp	loc_62B925C7
_silc_client_list_private_message_keys endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 109. silc_client_del_private_message_key

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_del_private_message_key(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry)
		public _silc_client_del_private_message_key
_silc_client_del_private_message_key proc near

client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 10h
		mov	ebx, [ebp+client_entry]
		mov	eax, [ebp+client]
		test	eax, eax
		jz	loc_62B927EC
client_entry_0 = ebx			; SilcClientEntry
		test	client_entry_0,	client_entry_0
		jz	short loc_62B927EC
		mov	eax, [client_entry_0+3DCh]
		test	eax, eax
		jz	short loc_62B927E0

loc_62B92778:				; CODE XREF: _silc_client_del_private_message_key+94j
		mov	[esp], eax
		call	_silc_cipher_free
		mov	eax, [client_entry_0+3E0h]
		mov	[esp], eax
		call	_silc_cipher_free
		mov	edx, [client_entry_0+3ECh]
		test	edx, edx
		jz	short loc_62B927B2
		mov	ecx, [client_entry_0+3F0h]
		xor	eax, eax
		mov	edi, edx
		rep stosb
		mov	eax, [client_entry_0+3ECh]
		mov	[esp], eax
		call	_silc_free

loc_62B927B2:				; CODE XREF: _silc_client_del_private_message_key+42j
		mov	dword ptr [client_entry_0+3DCh], 0
		mov	dword ptr [client_entry_0+3E0h], 0
		mov	dword ptr [client_entry_0+3ECh], 0
		and	byte ptr [client_entry_0+402h],	0FBh
		mov	al, 1
		add	esp, 10h
		pop	client_entry_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B927E0:				; CODE XREF: _silc_client_del_private_message_key+22j
client_entry_0 = ebx			; SilcClientEntry
		mov	edi, [client_entry_0+3E0h]
		test	edi, edi
		jnz	short loc_62B92778
		xchg	ax, ax

loc_62B927EC:				; CODE XREF: _silc_client_del_private_message_key+10j
					; _silc_client_del_private_message_key+18j
		xor	eax, eax
		add	esp, 10h
		pop	client_entry_0
		pop	edi
		leave
		retn
_silc_client_del_private_message_key endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry   7. silc_client_add_private_message_key_ske

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_add_private_message_key_ske(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry, const char *cipher, const char *hmac, SilcSKEKeyMaterial	keymat)
		public _silc_client_add_private_message_key_ske
_silc_client_add_private_message_key_ske proc near
					; CODE XREF: _silc_client_add_private_message_key+EFp

client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
cipher		= dword	ptr  14h
hmac		= dword	ptr  18h
keymat		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	ebx, [ebp+client_entry]
		mov	esi, [ebp+cipher]
		mov	edi, [ebp+hmac]
		mov	eax, [ebp+client]
		test	eax, eax
		jz	short loc_62B92829
client_entry_0 = ebx			; SilcClientEntry
cipher_0 = esi				; const	char *
hmac_0 = edi				; const	char *
		test	client_entry_0,	client_entry_0
		jz	short loc_62B92829
		mov	ecx, [client_entry_0+3DCh]
		test	ecx, ecx
		jz	short loc_62B92834
		mov	edx, [client_entry_0+3E0h]
		test	edx, edx
		jz	short loc_62B92834

loc_62B92829:				; CODE XREF: _silc_client_add_private_message_key_ske+17j
					; _silc_client_add_private_message_key_ske+1Bj	...
		xor	eax, eax

loc_62B9282B:				; CODE XREF: _silc_client_add_private_message_key_ske+1A5j
		add	esp, 1Ch
		pop	client_entry_0
		pop	cipher_0
		pop	hmac_0
		leave
		retn
; ---------------------------------------------------------------------------
client_entry_0 = ebx			; SilcClientEntry
cipher_0 = esi				; const	char *
hmac_0 = edi				; const	char *
		align 4

loc_62B92834:				; CODE XREF: _silc_client_add_private_message_key_ske+25j
					; _silc_client_add_private_message_key_ske+2Fj
		test	cipher_0, cipher_0
		jz	loc_62B929A4

loc_62B9283C:				; CODE XREF: _silc_client_add_private_message_key_ske+1B1j
		test	hmac_0,	hmac_0
		jz	loc_62B929B0

loc_62B92844:				; CODE XREF: _silc_client_add_private_message_key_ske+1BDj
		mov	[esp], cipher_0
		call	_silc_cipher_is_supported
		test	al, al
		jz	short loc_62B92829
		mov	[esp], hmac_0
		call	_silc_hmac_is_supported
		test	al, al
		jz	short loc_62B92829
		or	byte ptr [client_entry_0+402h],	2
		lea	eax, [client_entry_0+3DCh]
		mov	[esp+4], eax
		mov	[esp], cipher_0
		call	_silc_cipher_alloc
		test	al, al
		jz	short loc_62B92829
		lea	eax, [client_entry_0+3E0h]
		mov	[esp+4], eax
		mov	[esp], cipher_0
		call	_silc_cipher_alloc
		test	al, al
		jz	short loc_62B92829
		lea	eax, [client_entry_0+3E4h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	[esp], hmac_0
		call	_silc_hmac_alloc
		test	al, al
		jz	loc_62B92829
		lea	eax, [client_entry_0+3E8h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	[esp], hmac_0
		call	_silc_hmac_alloc
		test	al, al
		jz	loc_62B92829
		test	byte ptr [client_entry_0+402h],	4
		jnz	loc_62B929BA
		mov	dword ptr [esp+0Ch], 1
		mov	edx, [ebp+keymat]
		mov	eax, [edx+14h]
		mov	[esp+8], eax
		mov	eax, [edx+0Ch]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3DCh]
		mov	[esp], eax
		call	_silc_cipher_set_key
		mov	edx, [ebp+keymat]
		mov	eax, [edx]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3DCh]
		mov	[esp], eax
		call	_silc_cipher_set_iv
		mov	dword ptr [esp+0Ch], 0
		mov	edx, [ebp+keymat]
		mov	eax, [edx+14h]
		mov	[esp+8], eax
		mov	eax, [edx+10h]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3E0h]
		mov	[esp], eax
		call	_silc_cipher_set_key
		mov	edx, [ebp+keymat]
		mov	eax, [edx+4]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3E0h]
		mov	[esp], eax
		call	_silc_cipher_set_iv
		mov	edx, [ebp+keymat]
		mov	eax, [edx+20h]
		mov	[esp+8], eax
		mov	eax, [edx+18h]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3E4h]
		mov	[esp], eax
		call	_silc_hmac_set_key
		mov	edx, [ebp+keymat]
		mov	eax, [edx+20h]
		mov	[esp+8], eax
		mov	eax, [edx+1Ch]

loc_62B92989:				; CODE XREF: _silc_client_add_private_message_key_ske+26Bj
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3E8h]
		mov	[esp], eax
		call	_silc_hmac_set_key
		mov	al, 1
		jmp	loc_62B9282B
; ---------------------------------------------------------------------------
		align 4

loc_62B929A4:				; CODE XREF: _silc_client_add_private_message_key_ske+3Ej
		mov	cipher_0, offset aAes256Cbc_0 ;	"aes-256-cbc"
		jmp	loc_62B9283C
; ---------------------------------------------------------------------------
		align 10h

loc_62B929B0:				; CODE XREF: _silc_client_add_private_message_key_ske+46j
		mov	hmac_0,	offset aHmacSha196_0 ; "hmac-sha1-96"
		jmp	loc_62B92844
; ---------------------------------------------------------------------------

loc_62B929BA:				; CODE XREF: _silc_client_add_private_message_key_ske+E2j
		mov	dword ptr [esp+0Ch], 1
		mov	edx, [ebp+keymat]
		mov	eax, [edx+14h]
		mov	[esp+8], eax
		mov	eax, [edx+10h]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3DCh]
		mov	[esp], eax
		call	_silc_cipher_set_key
		mov	edx, [ebp+keymat]
		mov	eax, [edx+4]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3DCh]
		mov	[esp], eax
		call	_silc_cipher_set_iv
		mov	dword ptr [esp+0Ch], 0
		mov	edx, [ebp+keymat]
		mov	eax, [edx+14h]
		mov	[esp+8], eax
		mov	eax, [edx+0Ch]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3E0h]
		mov	[esp], eax
		call	_silc_cipher_set_key
		mov	edx, [ebp+keymat]
		mov	eax, [edx]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3E0h]
		mov	[esp], eax
		call	_silc_cipher_set_iv
		mov	edx, [ebp+keymat]
		mov	eax, [edx+20h]
		mov	[esp+8], eax
		mov	eax, [edx+1Ch]
		mov	[esp+4], eax
		mov	eax, [client_entry_0+3E4h]
		mov	[esp], eax
		call	_silc_hmac_set_key
		mov	edx, [ebp+keymat]
		mov	eax, [edx+20h]
		mov	[esp+8], eax
		mov	eax, [edx+18h]
		jmp	loc_62B92989
_silc_client_add_private_message_key_ske endp

; Exported entry   6. silc_client_add_private_message_key

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_add_private_message_key(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry, const char *cipher, const char *hmac, unsigned __int8 *key, SilcUInt32 key_len)
		public _silc_client_add_private_message_key
_silc_client_add_private_message_key proc near

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_19		= byte ptr -19h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
cipher		= dword	ptr  14h
hmac		= dword	ptr  18h
key		= dword	ptr  1Ch
key_len		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+client]
		mov	esi, [ebp+client_entry]
		mov	edi, [ebp+cipher]
		test	ebx, ebx
		jz	short loc_62B92A96
client_0 = ebx				; SilcClient
client_entry_0 = esi			; SilcClientEntry
cipher_0 = edi				; const	char *
		test	client_entry_0,	client_entry_0
		jz	short loc_62B92A96
		mov	eax, [client_entry_0+3DCh]
		test	eax, eax
		jz	short loc_62B92AA4
		mov	ecx, [client_entry_0+3E0h]
		test	ecx, ecx
		jz	short loc_62B92AA4

loc_62B92A96:				; CODE XREF: _silc_client_add_private_message_key+14j
					; _silc_client_add_private_message_key+18j ...
keymat = eax				; SilcSKEKeyMaterial
		xor	client_0, client_0

loc_62B92A98:				; CODE XREF: _silc_client_add_private_message_key+114j
					; _silc_client_add_private_message_key+1F0j
ret = ebx				; SilcBool
		mov	al, bl
keymat = edx				; SilcSKEKeyMaterial
		add	esp, 6Ch
		pop	ret
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
client_entry_0 = esi			; SilcClientEntry
cipher_0 = edi				; const	char *
		align 4

loc_62B92AA4:				; CODE XREF: _silc_client_add_private_message_key+22j
					; _silc_client_add_private_message_key+2Cj
		test	cipher_0, cipher_0
		jz	loc_62B92C60

loc_62B92AAC:				; CODE XREF: _silc_client_add_private_message_key+1FDj
		mov	edx, [ebp+hmac]
		test	edx, edx
		jz	loc_62B92C6C

loc_62B92AB7:				; CODE XREF: _silc_client_add_private_message_key+20Bj
		mov	[esp], cipher_0
		call	_silc_cipher_is_supported
		test	al, al
		jz	short loc_62B92A96
		mov	eax, [ebp+hmac]
		mov	[esp], eax
		call	_silc_hmac_is_supported
		test	al, al
		jz	short loc_62B92A96
		mov	edx, [ebp+key_len]
		mov	[esp+4], edx
		mov	eax, [ebp+key]
		mov	[esp], eax
		call	_silc_memdup
		mov	[client_entry_0+3ECh], eax
		mov	edx, [ebp+key_len]
		mov	[client_entry_0+3F0h], edx
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0F0h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 10h
		mov	dword ptr [esp+0Ch], 100h
		mov	dword ptr [esp+8], 10h
		mov	eax, [ebp+key_len]
		mov	[esp+4], eax
		mov	edx, [ebp+key]
		mov	[esp], edx
		call	_silc_ske_process_key_material_data
		mov	edx, eax
keymat = edx				; SilcSKEKeyMaterial
		test	eax, eax
		jz	loc_62B92A96
keymat = eax				; SilcSKEKeyMaterial
		mov	[esp+14h], keymat ; keymat
		mov	keymat,	[ebp+hmac]
keymat = edx				; SilcSKEKeyMaterial
		mov	[esp+10h], eax	; hmac
		mov	[esp+0Ch], cipher_0 ; cipher
		mov	[esp+8], client_entry_0	; client_entry
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	[esp], client_0	; client
		mov	[ebp+var_28], keymat
		call	_silc_client_add_private_message_key_ske
		mov	bl, al
ret = ebx				; SilcBool
		and	byte ptr [client_entry_0+402h],	0FDh
		mov	edx, [ebp+var_28]
		mov	[esp], edx
keymat = edx				; SilcSKEKeyMaterial
		call	_silc_ske_free_key_material
		mov	cl, [client_entry_0+402h]
		and	ecx, 4
		mov	[ebp+var_19], cl
		jnz	loc_62B92A98
		mov	eax, [client_entry_0+3DCh]
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	[ebp+var_24], eax
		mov	eax, [client_entry_0+3E4h]
		mov	[esp], eax
		call	_silc_hmac_get_name
		mov	edx, eax
		mov	ecx, 0FFFFFFFFh
		mov	cipher_0, eax
		mov	al, [ebp+var_19]
		repne scasb
		not	ecx
		dec	ecx
		mov	[ebp+var_20], ecx
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_24]
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+4Ch], 1Dh
		mov	eax, [ebp+var_20]
		mov	[esp+48h], eax
		mov	[esp+44h], edx
		mov	dword ptr [esp+40h], 0Ch
		mov	[esp+3Ch], eax
		mov	dword ptr [esp+38h], 3
		mov	[esp+34h], ecx
		mov	edx, [ebp+var_24]
		mov	[esp+30h], edx
		mov	dword ptr [esp+2Ch], 0Ch
		mov	[esp+28h], ecx
		mov	dword ptr [esp+24h], 3
		mov	dword ptr [esp+20h], 0
		mov	dword ptr [esp+1Ch], 0
		add	client_entry_0,	38Ch
		mov	[esp+18h], esi
		mov	dword ptr [esp+14h], 2
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0Ah
		mov	edx, [ebp+conn]
		mov	eax, [edx+3Ch]
		mov	[esp], eax
		call	_silc_packet_send_va_ext
		jmp	loc_62B92A98
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
client_entry_0 = esi			; SilcClientEntry
cipher_0 = edi				; const	char *
		align 10h

loc_62B92C60:				; CODE XREF: _silc_client_add_private_message_key+3Ej
		mov	cipher_0, offset aAes256Cbc_0 ;	"aes-256-cbc"
		jmp	loc_62B92AAC
; ---------------------------------------------------------------------------
		align 4

loc_62B92C6C:				; CODE XREF: _silc_client_add_private_message_key+49j
		mov	[ebp+hmac], offset aHmacSha196_0 ; "hmac-sha1-96"
		jmp	loc_62B92AB7
_silc_client_add_private_message_key endp

; Exported entry 182. silc_client_private_message_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_private_message_error(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_private_message_error
_silc_client_private_message_error proc	near
					; DATA XREF: _silc_client_private_message_resolved:loc_62B93038o
					; _silc_client_private_message:loc_62B93516o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+state_context]
		mov	[esp], eax
		call	_silc_packet_free
		mov	eax, 3
		leave
		retn
_silc_client_private_message_error endp

; Exported entry 183. silc_client_private_message_key

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_private_message_key(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_private_message_key
_silc_client_private_message_key proc near
					; DATA XREF: _silc_client_connection_st_packet:loc_62B81F10o

client_id	= dword	ptr -40h
client		= dword	ptr -3Ch
remote_id	= SilcClientID ptr -35h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	edi, [ebp+fsm]
		mov	esi, [ebp+fsm_context]
		mov	ebx, [ebp+state_context]
		mov	edx, [esi+4Ch]
client = edx				; SilcClient
		mov	al, [ebx+20h]
		mov	cl, al
		and	ecx, 0FFFFFFC0h
		cmp	cl, 80h
		jz	short loc_62B92CC8

loc_62B92CB2:				; CODE XREF: _silc_client_private_message_key+6Fj
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
state_context_0	= ebx			; void *
		mov	[esp], state_context_0
		call	_silc_packet_free
		mov	eax, 3

loc_62B92CBF:				; CODE XREF: _silc_client_private_message_key+B7j
		add	esp, 5Ch
		pop	ebx
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
state_context_0	= ebx			; void *
client = edx				; SilcClient
		align 4

loc_62B92CC8:				; CODE XREF: _silc_client_private_message_key+20j
		mov	dword ptr [esp+10h], 1Dh
		lea	ecx, [ebp+remote_id]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 2
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [state_context_0+18h]
		mov	[esp], eax
		mov	[ebp+client], client
		mov	[ebp+client_id], ecx
		call	_silc_id_str2id
		test	al, al
		mov	edx, [ebp+client]
		mov	ecx, [ebp+client_id]
		jz	short loc_62B92CB2
		mov	al, [fsm_0+28h]
		mov	bl, al
		or	ebx, 4
		mov	[fsm_0+28h], bl
		test	al, 4
		jnz	short loc_62B92D4C

loc_62B92D10:				; CODE XREF: _silc_client_private_message_key+F4j
		mov	[esp+14h], fsm_0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_private_message_key_cb	; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		mov	[esp+8], ecx	; client_id
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], edx	; client
client = edx				; SilcClient
		call	_silc_client_get_client_by_id_resolve
		mov	dl, [fsm_0+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		shl	eax, 1
		and	eax, 2
		jmp	loc_62B92CBF
; ---------------------------------------------------------------------------

loc_62B92D4C:				; CODE XREF: _silc_client_private_message_key+7Ej
		mov	dword ptr [esp+8], 174h
		mov	dword ptr [esp+4], offset aClient_prvmsg_ ; "client_prvmsg.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_4	; "SILC_VERIFY %s:%d"
		mov	[ebp+client], edx
		mov	[ebp+client_id], ecx
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		mov	ecx, [ebp+client_id]
		mov	edx, [ebp+client]
		jmp	short loc_62B92D10
_silc_client_private_message_key endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_private_message_key_cb(SilcClient client, SilcClientConnection conn,	SilcStatus status, SilcDList clients, void *context)
_silc_client_private_message_key_cb proc near
					; DATA XREF: _silc_client_private_message_key+84o

hmac		= dword	ptr -20h
cipher		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
clients		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+clients]
		mov	esi, [ebp+context]
		mov	[esp], esi
		call	_silc_fsm_get_state_context
		mov	edi, eax
packet = edi				; SilcPacket
		mov	[ebp+cipher], 0
		mov	[ebp+hmac], 0
		test	ebx, ebx
		jz	short loc_62B92DFE
clients_0 = ebx				; SilcDList
context_0 = esi				; void *
		mov	dword ptr [esp+14h], 1Dh
		lea	eax, [ebp+hmac]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 11h
		lea	eax, [ebp+cipher]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 11h
		lea	eax, [packet+8]
		mov	[esp], eax
		call	_silc_buffer_unformat
		test	eax, eax
ret = eax				; int
		jnz	short loc_62B92E18

out:					; CODE XREF: _silc_client_private_message_key_cb+B9j
		mov	ret, [ebp+cipher]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [ebp+hmac]
		mov	[esp], eax
		call	_silc_free

loc_62B92DFE:				; CODE XREF: _silc_client_private_message_key_cb+29j
		mov	[esp], packet
		call	_silc_packet_free
		mov	[esp], context_0
		call	_silc_fsm_finish
		add	esp, 3Ch
		pop	clients_0
		pop	context_0
		pop	packet
		leave
		retn
; ---------------------------------------------------------------------------
clients_0 = ebx				; SilcDList
context_0 = esi				; void *
packet = edi				; SilcPacket
ret = eax				; int
		align 4

loc_62B92E18:				; CODE XREF: _silc_client_private_message_key_cb+5Ej
		mov	ret, [clients_0+14h]
		mov	[clients_0+18h], eax
		mov	eax, [clients_0+8]
		test	eax, eax
		jz	short loc_62B92E50
		test	byte ptr [clients_0+10h], 2
		jnz	short loc_62B92E44
		movzx	edx, word ptr [clients_0+0Ch]
		mov	edx, [eax+edx]

loc_62B92E32:				; CODE XREF: _silc_client_private_message_key_cb+C3j
		mov	[clients_0+8], edx
		mov	[clients_0+14h], eax
		mov	eax, [eax]

loc_62B92E3A:				; CODE XREF: _silc_client_private_message_key_cb+D1j
		or	byte ptr [eax+402h], 4
		jmp	short out
; ---------------------------------------------------------------------------
		align 4

loc_62B92E44:				; CODE XREF: _silc_client_private_message_key_cb+A1j
		movzx	edx, word ptr [clients_0+0Eh]
		mov	edx, [eax+edx]
		jmp	short loc_62B92E32
; ---------------------------------------------------------------------------
		align 10h

loc_62B92E50:				; CODE XREF: _silc_client_private_message_key_cb+9Bj
		mov	dword ptr [clients_0+14h], 0
		xor	eax, eax
		jmp	short loc_62B92E3A
_silc_client_private_message_key_cb endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 185. silc_client_private_message_wait

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_private_message_wait(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry,	SilcMessagePayload *payload)
		public _silc_client_private_message_wait
_silc_client_private_message_wait proc near

packet		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
payload		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	ebx, [ebp+client_entry]
		mov	esi, [ebp+payload]
		mov	eax, [ebx+3D4h]
		test	eax, eax
		jz	loc_62B92F4C
client_entry_0 = ebx			; SilcClientEntry
payload_0 = esi				; SilcMessagePayload *
		lea	edi, [ebp+packet]

loc_62B92E7C:				; CODE XREF: _silc_client_private_message_wait+E9j
		mov	[esp+8], edi
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	_silc_packet_wait
		test	eax, eax
		js	loc_62B92F4C
		mov	eax, [ebp+packet]
		mov	ecx, [eax+0Ch]
		mov	dword ptr [esp+30h], 0
		mov	dword ptr [esp+2Ch], 0
		mov	dword ptr [esp+28h], 0
		mov	dl, [eax+21h]
		and	edx, 3Fh
		mov	[esp+24h], edx
		mov	edx, [eax+1Ch]
		mov	[esp+20h], edx
		mov	dl, [eax+20h]
		and	edx, 3Fh
		mov	[esp+1Ch], edx
		mov	edx, [eax+18h]
		mov	[esp+18h], edx
		mov	edx, [client_entry_0+3E8h]
		mov	[esp+14h], edx
		mov	edx, [client_entry_0+3E0h]
		mov	[esp+10h], edx
		mov	dl, [client_entry_0+402h]
		shr	dl, 1
		xor	edx, 1
		and	edx, 1
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 1
		mov	eax, [eax+10h]
		sub	eax, ecx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	_silc_message_payload_parse
		mov	[payload_0], eax
		test	eax, eax
		jz	short loc_62B92F34
		mov	eax, [ebp+packet]
		mov	[esp], eax
		call	_silc_packet_free
		mov	al, 1
		add	esp, 5Ch
		pop	client_entry_0
		pop	payload_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
client_entry_0 = ebx			; SilcClientEntry
payload_0 = esi				; SilcMessagePayload *
		align 4

loc_62B92F34:				; CODE XREF: _silc_client_private_message_wait+BFj
		mov	eax, [ebp+packet]
		mov	[esp], eax
		call	_silc_packet_free
		mov	eax, [client_entry_0+3D4h]
		jmp	loc_62B92E7C
; ---------------------------------------------------------------------------
		align 4

loc_62B92F4C:				; CODE XREF: _silc_client_private_message_wait+17j
					; _silc_client_private_message_wait+36j
		xor	eax, eax
		add	esp, 5Ch
		pop	client_entry_0
		pop	payload_0
		pop	edi
		leave
		retn
_silc_client_private_message_wait endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 187. silc_client_private_message_wait_uninit

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_private_message_wait_uninit(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry)
		public _silc_client_private_message_wait_uninit
_silc_client_private_message_wait_uninit proc near

client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+client_entry]
		mov	eax, [ebx+3D4h]
		test	eax, eax
		jz	short loc_62B92F88
client_entry_0 = ebx			; SilcClientEntry
		mov	edx, [ebp+conn]
		mov	edx, [edx+3Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	_silc_packet_wait_uninit
		mov	dword ptr [client_entry_0+3D4h], 0

loc_62B92F88:				; CODE XREF: _silc_client_private_message_wait_uninit+12j
		add	esp, 14h
		pop	client_entry_0
		leave
		retn
_silc_client_private_message_wait_uninit endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 186. silc_client_private_message_wait_init

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_private_message_wait_init(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry)
		public _silc_client_private_message_wait_init
_silc_client_private_message_wait_init proc near

id		= SilcID ptr -38h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+client_entry]
		mov	edx, [ebx+3D4h]
		test	edx, edx
		jz	short loc_62B92FB0
client_entry_0 = ebx			; SilcClientEntry
		mov	al, 1
		add	esp, 3Ch
		pop	client_entry_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B92FB0:				; CODE XREF: _silc_client_private_message_wait_init+14j
client_entry_0 = ebx			; SilcClientEntry
		mov	[ebp+id.type], 2
		lea	edi, [ebp+id]
		lea	esi, [client_entry_0+38Ch]
		mov	ecx, 1Dh
		rep movsb
		mov	dword ptr [esp+0Ch], 0FFFFFFFFh
		mov	dword ptr [esp+8], 9
		lea	eax, [ebp+id]
		mov	[esp+4], eax
		mov	eax, [ebp+conn]
		mov	eax, [eax+3Ch]
		mov	[esp], eax
		call	_silc_packet_wait_init
		mov	[client_entry_0+3D4h], eax
		test	eax, eax
		setnz	al
		add	esp, 3Ch
		pop	client_entry_0
		pop	esi
		pop	edi
		leave
		retn
_silc_client_private_message_wait_init endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_private_message_resolved(SilcClient client, SilcClientConnection conn, SilcStatus status, SilcDList clients,	void *context)
_silc_client_private_message_resolved proc near
					; DATA XREF: _silc_client_private_message+259o

client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
clients		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		mov	ecx, [ebp+clients]
		test	ecx, ecx
		jz	short loc_62B93038

loc_62B93011:				; CODE XREF: _silc_client_private_message_resolved+48j
context_0 = ebx				; void *
		mov	al, [context_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+28h], dl
		test	al, 4
		jz	short loc_62B93028
		add	esp, 14h
		pop	context_0
		leave
		retn
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 4

loc_62B93028:				; CODE XREF: _silc_client_private_message_resolved+1Ej
		mov	[ebp+client], context_0
		add	esp, 14h
		pop	context_0
		leave
		jmp	_silc_fsm_continue
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 4

loc_62B93038:				; CODE XREF: _silc_client_private_message_resolved+Fj
		mov	dword ptr [esp+4], offset _silc_client_private_message_error
		mov	[esp], context_0
		call	_silc_fsm_next
		jmp	short loc_62B93011
_silc_client_private_message_resolved endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 201. silc_client_send_private_message

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_send_private_message(SilcClient client, SilcClientConnection conn, SilcClientEntry client_entry,	SilcMessageFlags flags,	SilcHash hash, unsigned	__int8 *data, SilcUInt32 data_len)
		public _silc_client_send_private_message
_silc_client_send_private_message proc near ; CODE XREF: _silc_client_private_message+223p

var_7C		= dword	ptr -7Ch
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
rid		= SilcID ptr -58h
sid		= SilcID ptr -38h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
client_entry	= dword	ptr  10h
flags		= dword	ptr  14h
hash		= dword	ptr  18h
data		= dword	ptr  1Ch
data_len	= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0BCh
		mov	eax, [ebp+client]
		mov	ebx, [ebp+conn]
		mov	edx, [ebp+client_entry]
		mov	ecx, [ebp+flags]
		test	eax, eax
		jz	loc_62B9320F
client_0 = eax				; SilcClient
conn_0 = ebx				; SilcClientConnection
client_entry_0 = edx			; SilcClientEntry
flags_0	= ecx				; SilcMessageFlags
		test	conn_0,	conn_0
		jz	loc_62B9320F
		test	client_entry_0,	client_entry_0
		jz	loc_62B9320F
		movzx	flags_0, cx
		mov	[ebp+var_60], ecx
		and	ecx, 20h
		jnz	loc_62B93205

loc_62B9308B:				; CODE XREF: _silc_client_send_private_message+1BDj
		mov	ecx, [conn_0+54h]
		test	byte ptr [ecx+12Dh], 2
		jnz	loc_62B9320F
		mov	[ebp+sid.type],	2
		mov	esi, [conn_0]
		lea	ecx, [ebp+sid]
		mov	[ebp+var_6C], ecx
		add	esi, 38Ch
		mov	ecx, 1Dh
		mov	edi, [ebp+var_6C]
		rep movsb
		mov	[ebp+rid.type],	2
		lea	esi, [ebp+rid]
		mov	[ebp+var_70], esi
		lea	ecx, [client_entry_0+38Ch]
		mov	[ebp+var_5C], ecx
		mov	ecx, 1Dh
		mov	edi, esi
		mov	esi, [ebp+var_5C]
		rep movsb
		mov	edi, [conn_0+38h]
		mov	client_0, [client_0+10h]
		mov	[ebp+var_7C], eax
		mov	esi, [client_entry_0+3E4h]
		mov	[ebp+var_64], esi
		mov	ecx, [client_entry_0+3DCh]
		test	ecx, ecx
		jz	loc_62B9321C
		mov	al, [client_entry_0+402h]
		shr	al, 1
		xor	eax, 1
		mov	esi, eax
		and	esi, 1
		mov	[ebp+var_74], esi

loc_62B9310D:				; CODE XREF: _silc_client_send_private_message+1D7j
		mov	dword ptr [esp+34h], 0
		lea	eax, [ebp+rid]
		mov	[esp+30h], eax
		lea	esi, [ebp+sid]
		mov	[esp+2Ch], esi
		mov	eax, [ebp+hash]
		mov	[esp+28h], eax
		mov	[esp+24h], edi
		mov	dword ptr [esp+20h], 0
		mov	esi, [ebp+var_7C]
		mov	[esp+1Ch], esi
		mov	eax, [ebp+var_64]
		mov	[esp+18h], eax
		mov	[esp+14h], ecx
		mov	dword ptr [esp+10h], 1
		mov	ecx, [ebp+var_74]
		mov	[esp+0Ch], ecx
		mov	eax, [ebp+data_len]
		mov	[esp+8], eax
		mov	eax, [ebp+data]
		mov	[esp+4], eax
		mov	esi, [ebp+var_60]
		mov	[esp], esi
		mov	[ebp+var_68], client_entry_0
		call	_silc_message_payload_encode
		mov	esi, eax
buffer = esi				; SilcBuffer
		test	eax, eax
		mov	edx, [ebp+var_68]
		jz	loc_62B93228
buffer = eax				; SilcBuffer
		mov	ecx, [buffer+4]
		mov	dword ptr [esp+28h], 0
		mov	dword ptr [esp+24h], 0
		mov	buffer,	[buffer+8]
buffer = esi				; SilcBuffer
		sub	eax, ecx
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	eax, [ebp+var_5C]
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 2
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		xor	eax, eax
		cmp	dword ptr [edx+3DCh], 0
		setnz	al
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 9
		mov	eax, [conn_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_send_ext
		mov	edx, [buffer]
		mov	[esp], edx
		mov	byte ptr [ebp+var_68], al
		call	_silc_free
		mov	[esp], buffer
		call	_silc_free
		mov	al, byte ptr [ebp+var_68]

loc_62B931FA:				; CODE XREF: _silc_client_send_private_message+1FAj
		add	esp, 0BCh
		pop	conn_0
		pop	buffer
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B93205:				; CODE XREF: _silc_client_send_private_message+39j
client_0 = eax				; SilcClient
conn_0 = ebx				; SilcClientConnection
client_entry_0 = edx			; SilcClientEntry
		cmp	[ebp+hash], 0
		jnz	loc_62B9308B

loc_62B9320F:				; CODE XREF: _silc_client_send_private_message+1Aj
					; _silc_client_send_private_message+22j ...
		xor	client_0, client_0
		add	esp, 0BCh
		pop	conn_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9321C:				; CODE XREF: _silc_client_send_private_message+A8j
conn_0 = ebx				; SilcClientConnection
		mov	[ebp+var_74], 0
		jmp	loc_62B9310D
; ---------------------------------------------------------------------------

loc_62B93228:				; CODE XREF: _silc_client_send_private_message+12Ej
buffer = eax				; SilcBuffer ; "Error encoding private message"
		mov	dword ptr [esp], offset	aErrorEncodingP
		call	_silc_format
buffer = esi				; SilcBuffer
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		xor	eax, eax
ret = eax				; SilcBool
		jmp	short loc_62B931FA
_silc_client_send_private_message endp

; Exported entry 181. silc_client_private_message

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_private_message(SilcFSMObject	*fsm, void *fsm_context, void *state_context)
		public _silc_client_private_message
_silc_client_private_message proc near	; DATA XREF: _silc_client_connection_st_packet:loc_62B81EF8o

client_entry	= dword	ptr -58h
client		= dword	ptr -54h
data		= dword	ptr -50h
payload		= dword	ptr -4Ch
remote_id	= SilcClientID ptr -39h
message_len	= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 9Ch
		mov	edi, [ebp+fsm]
		mov	ebx, [ebp+state_context]
		mov	eax, [ebp+fsm_context]
		mov	eax, [eax+4Ch]
		mov	[ebp+client], eax
		mov	al, [ebx+20h]
		mov	dl, al
		and	edx, 0FFFFFFC0h
		cmp	dl, 80h
		jnz	loc_62B93516
fsm_0 =	edi				; SilcFSMObject	*
state_context_0	= ebx			; void *
		mov	dword ptr [esp+10h], 1Dh
		lea	esi, [ebp+remote_id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 2
		and	eax, 3Fh
		mov	[esp+4], eax
		mov	eax, [state_context_0+18h]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jz	loc_62B93516
		mov	[esp+8], esi	; client_id
		mov	ecx, [ebp+fsm_context]
		mov	[esp+4], ecx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_client_by_id
		mov	edx, eax
remote_client =	edx			; SilcClientEntry
		test	eax, eax
		jz	loc_62B93478
remote_client =	eax			; SilcClientEntry
		cmp	byte ptr [remote_client], 0
		jz	loc_62B93478
		test	byte ptr [state_context_0+23h],	1
		jnz	loc_62B9352D
		mov	remote_client, [remote_client+3E8h]
remote_client =	edx			; SilcClientEntry
		mov	ecx, [remote_client+3E0h]
		mov	[ebp+payload], ecx

loc_62B932E7:				; CODE XREF: _silc_client_private_message+2F8j
					; _silc_client_private_message+305j
		mov	dword ptr [esp+30h], 0
		mov	dword ptr [esp+2Ch], 0
		mov	dword ptr [esp+28h], 0
		mov	cl, [state_context_0+21h]
		and	ecx, 3Fh
		mov	[esp+24h], ecx
		mov	edi, [state_context_0+1Ch]
		mov	[esp+20h], edi
		mov	cl, [state_context_0+20h]
		and	ecx, 3Fh
		mov	[esp+1Ch], ecx
		mov	edi, [state_context_0+18h]
		mov	[esp+18h], edi
		mov	[esp+14h], eax
		mov	edi, [ebp+payload]
		mov	[esp+10h], edi
		mov	al, [remote_client+402h]
		shr	al, 1
		xor	eax, 1
		and	eax, 1
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 1
		mov	eax, [state_context_0+10h]
		sub	eax, [state_context_0+0Ch]
		mov	[esp+4], eax
		mov	eax, [state_context_0+0Ch]
		mov	[esp], eax
		mov	[ebp+client_entry], remote_client
		call	_silc_message_payload_parse
		mov	[ebp+payload], eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	out
		mov	[esp], eax
		call	_silc_message_get_flags
		mov	edi, eax
flags =	edi				; SilcMessageFlags
		lea	eax, [ebp+message_len]
		mov	[esp+4], eax
		mov	ecx, [ebp+payload]
		mov	[esp], ecx
		call	_silc_message_get_data
		mov	ecx, eax
message	= ecx				; unsigned __int8 *
		movzx	flags, di
		mov	eax, [ebp+client]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	[ebp+data], eax
		mov	eax, [ebp+message_len]
		mov	[esp+18h], eax
		mov	[esp+14h], message
		mov	[esp+10h], edi
		mov	message, [ebp+payload]
		mov	[esp+0Ch], ecx
		mov	edx, [ebp+client_entry]
		mov	[esp+8], edx
remote_client =	edx			; SilcClientEntry
		mov	eax, [ebp+fsm_context]
		mov	[esp+4], eax
		mov	ecx, [ebp+client]
		mov	[esp], ecx
		mov	eax, [ebp+data]
		call	dword ptr [eax+8]
		mov	ecx, [ebp+fsm_context]
		mov	eax, [ecx+54h]
		mov	eax, [eax+110h]
		mov	[ebp+data], eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	short loc_62B933E4
		and	edi, 2
		jz	short loc_62B93424

loc_62B933E4:				; CODE XREF: _silc_client_private_message+195j
					; _silc_client_private_message+1E6j ...
		mov	[esp], state_context_0
		mov	[ebp+client_entry], edx
		call	_silc_packet_free
		mov	edx, [ebp+client_entry]
		mov	[esp+8], edx	; client_entry
remote_client =	edx			; SilcClientEntry
		mov	ecx, [ebp+fsm_context]
		mov	[esp+4], ecx	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_unref_client
		mov	eax, [ebp+payload]
		mov	[esp], eax
		call	_silc_message_payload_free
		mov	eax, 3

loc_62B93418:				; CODE XREF: _silc_client_private_message+2E0j
					; _silc_client_private_message+334j
		add	esp, 9Ch
		pop	state_context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
state_context_0	= ebx			; void *
		align 4

loc_62B93424:				; CODE XREF: _silc_client_private_message+19Aj
		mov	edi, [ecx+4]
		mov	ecx, 1Dh
		repe cmpsb
		jz	short loc_62B933E4
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+data]
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+18h], ecx	; data_len
		mov	edi, [ebp+data]
		mov	[esp+14h], edi	; data
		mov	dword ptr [esp+10h], 0 ; hash
		mov	dword ptr [esp+0Ch], 3 ; flags
		mov	[esp+8], edx	; client_entry
remote_client =	edx			; SilcClientEntry
		mov	eax, [ebp+fsm_context]
		mov	[esp+4], eax	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_send_private_message
		mov	edx, [ebp+client_entry]
		jmp	loc_62B933E4
; ---------------------------------------------------------------------------

loc_62B93478:				; CODE XREF: _silc_client_private_message+77j
					; _silc_client_private_message+80j
fsm_0 =	edi				; SilcFSMObject	* ; client_entry
remote_client =	eax			; SilcClientEntry
		mov	[esp+8], edx
		mov	ecx, [ebp+fsm_context]
		mov	[esp+4], ecx	; conn
		mov	remote_client, [ebp+client]
remote_client =	edx			; SilcClientEntry
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	short loc_62B934E8

loc_62B9349D:				; CODE XREF: _silc_client_private_message+2CCj
		mov	[esp+14h], fsm_0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_private_message_resolved ; completion
		mov	dword ptr [esp+0Ch], 0 ; attributes
		mov	[esp+8], esi	; client_id
		mov	ecx, [ebp+fsm_context]
		mov	[esp+4], ecx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_client_by_id_resolve
		mov	dl, [fsm_0+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		shl	eax, 1
		and	eax, 2
		add	esp, 9Ch
		pop	state_context_0
		pop	esi
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
state_context_0	= ebx			; void *
		align 4

loc_62B934E8:				; CODE XREF: _silc_client_private_message+253j
		mov	dword ptr [esp+8], 88h
		mov	dword ptr [esp+4], offset aClient_prvmsg_ ; "client_prvmsg.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_4	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	short loc_62B9349D
; ---------------------------------------------------------------------------

loc_62B93516:				; CODE XREF: _silc_client_private_message+26j
					; _silc_client_private_message+57j
		mov	dword ptr [esp+4], offset _silc_client_private_message_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B93418
; ---------------------------------------------------------------------------

loc_62B9352D:				; CODE XREF: _silc_client_private_message+8Aj
remote_client =	eax			; SilcClientEntry
		mov	fsm_0, [remote_client+3E0h]
		mov	[ebp+payload], edi
		test	edi, edi
		jz	short loc_62B93545
		mov	remote_client, [remote_client+3E8h]
remote_client =	edx			; SilcClientEntry
		jmp	loc_62B932E7
; ---------------------------------------------------------------------------

loc_62B93545:				; CODE XREF: _silc_client_private_message+2F0j
remote_client =	eax			; SilcClientEntry
		mov	remote_client, [remote_client+3E8h]
remote_client =	edx			; SilcClientEntry
		test	eax, eax
		jnz	loc_62B932E7

out:					; CODE XREF: _silc_client_private_message+11Ej
		mov	[esp], state_context_0
		mov	[ebp+client_entry], remote_client
		call	_silc_packet_free
		mov	edx, [ebp+client_entry]
		mov	[esp+8], edx	; client_entry
remote_client =	edx			; SilcClientEntry
		mov	edi, [ebp+fsm_context]
		mov	[esp+4], edi	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		mov	eax, 3
		jmp	loc_62B93418
_silc_client_private_message endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 218. silc_client_st_resume_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_resume_error(SilcFSMObject	*fsm, void *fsm_context, void *state_context)
		public _silc_client_st_resume_error
_silc_client_st_resume_error proc near	; DATA XREF: _silc_client_st_resume_completed:loc_62B93988o
					; _silc_client_st_resume:loc_62B93BE0o	...

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	esi, [ebp+fsm_context]
		mov	ebx, [ebp+state_context]
		mov	eax, [esi+54h]
		mov	dl, [eax+12Dh]
		test	dl, 2
		jnz	short loc_62B935E8
fsm_context_0 =	esi			; void *
state_context_0	= ebx			; void *
		mov	dword ptr [eax+128h], 3
		or	edx, 2
		mov	[eax+12Dh], dl
		mov	eax, [fsm_context_0+54h]
		add	eax, 98h
		mov	[esp], eax
		call	_silc_fsm_event_signal
		mov	eax, [fsm_context_0+54h]
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_connect_timeout
		mov	dword ptr [esp+4], 0
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_all

loc_62B935E8:				; CODE XREF: _silc_client_st_resume_error+1Aj
		test	state_context_0, state_context_0
		jz	short loc_62B935FF
		mov	eax, [state_context_0+18h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], state_context_0
		call	_silc_free

loc_62B935FF:				; CODE XREF: _silc_client_st_resume_error+66j
		mov	eax, 3
		add	esp, 10h
		pop	state_context_0
		pop	fsm_context_0
		leave
		retn
_silc_client_st_resume_error endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 214. silc_client_st_register_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_register_error(SilcFSMObject *fsm,	void *fsm_context, void	*state_context)
		public _silc_client_st_register_error
_silc_client_st_register_error proc near ; DATA	XREF: _silc_client_st_register:loc_62B93D4Co
					; _silc_client_st_register_complete:loc_62B93F0Co

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+54h]
		mov	dword ptr [eax+128h], 3
		mov	dl, [eax+12Dh]
		test	dl, 2
		jnz	short loc_62B93647
fsm_context_0 =	ebx			; void *
		or	edx, 2
		mov	[eax+12Dh], dl
		add	eax, 98h
		mov	[esp], eax
		call	_silc_fsm_event_signal
		mov	eax, [fsm_context_0+54h]

loc_62B93647:				; CODE XREF: _silc_client_st_register_error+20j
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_connect_timeout
		mov	dword ptr [esp+4], 0
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_all
		mov	eax, 3
		add	esp, 14h
		pop	fsm_context_0
		leave
		retn
_silc_client_st_register_error endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void silc_client_resume_command_callback(SilcClient client, SilcClientConnection conn, SilcCommand command, ...)
_silc_client_resume_command_callback proc near
					; CODE XREF: _silc_client_st_resume_completed+135p
					; _silc_client_st_resume_completed+21Cp ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= byte ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+client]
		lea	ecx, [ebp+arg_C]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	[esp+14h], ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		movzx	ecx, [ebp+command]
command_0 = ecx				; SilcCommand
		mov	[esp+8], command_0
		mov	command_0, [ebp+conn]
		mov	[esp+4], ecx
		mov	[esp], eax
		call	dword ptr [edx+14h]
		leave
		retn
_silc_client_resume_command_callback endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 217. silc_client_st_resume_completed

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_resume_completed(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_st_resume_completed
_silc_client_st_resume_completed proc near
					; DATA XREF: _silc_client_st_resume_resolve_cmodes+22o

var_44		= dword	ptr -44h
conn		= dword	ptr -40h
client		= dword	ptr -3Ch
channels	= SilcList ptr -38h
htl		= SilcHashTableList ptr	-24h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	esi, [ebp+fsm_context]
		mov	eax, [esi+4Ch]
		mov	[ebp+client], eax
		mov	eax, [esi+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B93988
fsm_context_0 =	esi			; void *
		mov	ecx, [ebp+state_context]
		mov	edx, [ecx+1Ch]
		test	edx, edx
		jz	short loc_62B936EC
		dec	edx
		mov	[ecx+1Ch], edx
		test	edx, edx
		jnz	loc_62B939A8

loc_62B936EC:				; CODE XREF: _silc_client_st_resume_completed+2Aj
		mov	eax, [eax+0F4h]
		mov	edx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 5
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_command_called_dummy ;	reply
		mov	dword ptr [esp+8], 3 ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_command_send
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+0F8h]
		mov	edx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 2
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_command_called_dummy ;	reply
		mov	dword ptr [esp+8], 0Ah ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_command_send
		mov	eax, [fsm_context_0+48h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	[esp+4], fsm_context_0
		mov	ecx, [ebp+client]
		mov	[esp], ecx
		call	dword ptr [fsm_context_0+44h]
		mov	eax, [fsm_context_0]
		mov	edx, [eax+3ACh]
		test	edx, edx
		jnz	loc_62B939B8

loc_62B937C5:				; CODE XREF: _silc_client_st_resume_completed+321j
		lea	edx, [eax+38Ch]
		mov	[esp+14h], edx
		mov	[esp+10h], eax
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 4 ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_resume_command_callback
		lea	eax, [ebp+channels]
		mov	[esp+4], eax
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+118h]
		mov	[esp], eax
		call	_silc_idcache_get_all
		test	al, al
		jz	loc_62B93913
		mov	eax, [ebp+channels.head]
		mov	[ebp+channels.current],	eax
		and	[ebp+channels._bf10], 0FDh
		lea	edi, [ebp+htl]
		mov	[ebp+conn], fsm_context_0
		jmp	loc_62B938E0
; ---------------------------------------------------------------------------
channel	= ebx				; SilcChannelEntry
cipher = esi				; const	char *
		align 4

loc_62B93824:				; CODE XREF: _silc_client_st_resume_completed+234j
		movzx	edx, [ebp+channels.prev_offset]
		mov	edx, [eax+edx]
		mov	[ebp+channels.current],	edx
		mov	channel, [eax+0Ch]
		mov	eax, [channel+158h]
		test	eax, eax
		jz	loc_62B93909

loc_62B9383F:				; CODE XREF: _silc_client_st_resume_completed+24Fj
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	cipher,	eax

loc_62B93849:				; CODE XREF: _silc_client_st_resume_completed+257j
		mov	eax, [channel+160h]
		test	eax, eax
		jz	short loc_62B9385B
		mov	[esp], eax
		call	_silc_hmac_get_name

loc_62B9385B:				; CODE XREF: _silc_client_st_resume_completed+19Dj
		mov	[esp+4], edi
		mov	edx, [channel+134h]
		mov	[esp], edx
		mov	[ebp+var_44], eax
		call	_silc_hash_table_list
		mov	edx, [channel+130h]
		mov	[esp+30h], edx
		mov	edx, [channel+110h]
		mov	[esp+2Ch], edx
		mov	edx, [channel+10Ch]
		mov	[esp+28h], edx
		mov	eax, [ebp+var_44]
		mov	[esp+24h], eax
hmac = eax				; const	char *
		mov	[esp+20h], cipher
		mov	hmac, [channel+108h]
		mov	[esp+1Ch], eax
		mov	[esp+18h], edi
		mov	eax, [channel+12Ch]
		mov	[esp+14h], eax
		mov	[esp+10h], channel
		mov	eax, [channel]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0Eh ; command
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_resume_command_callback
		mov	[esp], edi
		call	_silc_hash_table_list_reset
		mov	eax, [ebp+channels.current]

loc_62B938E0:				; CODE XREF: _silc_client_st_resume_completed+16Aj
		test	eax, eax
		jz	short loc_62B93910
		test	[ebp+channels._bf10], 2
		jnz	loc_62B93824
		movzx	edx, [ebp+channels.next_offset]
		mov	edx, [eax+edx]
		mov	[ebp+channels.current],	edx
		mov	channel, [eax+0Ch]
		mov	eax, [channel+158h]
		test	eax, eax
		jnz	loc_62B9383F

loc_62B93909:				; CODE XREF: _silc_client_st_resume_completed+185j
		xor	cipher,	cipher
		jmp	loc_62B93849
; ---------------------------------------------------------------------------

loc_62B93910:				; CODE XREF: _silc_client_st_resume_completed+22Ej
		mov	cipher,	[ebp+conn]

loc_62B93913:				; CODE XREF: _silc_client_st_resume_completed+154j
fsm_context_0 =	esi			; void *
		mov	eax, [fsm_context_0+54h]
		and	byte ptr [eax+12Dh], 0DFh
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_connect_timeout
		mov	dword ptr [esp+4], 0
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_all
		mov	edx, [ebp+state_context]
		mov	eax, [edx+18h]
		mov	[esp], eax
		call	_silc_free
		mov	ecx, [ebp+state_context]
		mov	[esp], ecx
		call	_silc_free
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+100h]
		mov	[esp], eax
		call	_silc_async_free
		mov	eax, [fsm_context_0+54h]
		mov	dword ptr [eax+100h], 0
		mov	eax, 3
		add	esp, 7Ch
		pop	channel
		pop	fsm_context_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
		align 4

loc_62B93988:				; CODE XREF: _silc_client_st_resume_completed+1Cj
		mov	dword ptr [esp+4], offset _silc_client_st_resume_error
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 7Ch
		pop	ebx
		pop	fsm_context_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
		align 4

loc_62B939A8:				; CODE XREF: _silc_client_st_resume_completed+32j
		mov	eax, 2
		add	esp, 7Ch
		pop	ebx
		pop	fsm_context_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
		align 4

loc_62B939B8:				; CODE XREF: _silc_client_st_resume_completed+10Bj
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 10h ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_resume_command_callback
		mov	eax, [fsm_context_0]
		jmp	loc_62B937C5
_silc_client_st_resume_completed endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_resume_continue(SilcClient client, SilcClientConnection conn, SilcCommand command, SilcStatus status, SilcStatus	error, void *context, va_list ap)
_silc_client_resume_continue proc near	; DATA XREF: _silc_client_st_resume_resolve_cmodes+C0o
					; _silc_client_st_resume_resolve_cmodes+100o ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= byte ptr  10h
status		= byte ptr  14h
error		= byte ptr  18h
context		= dword	ptr  1Ch
ap		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	al, [ebp+status]
		test	al, al
		jz	short loc_62B939F1
status_0 = eax				; SilcStatus
		cmp	al, 3
		jz	short loc_62B939F1
		cmp	al, 9
		jbe	short loc_62B93A08

loc_62B939F1:				; CODE XREF: _silc_client_resume_continue+Bj
					; _silc_client_resume_continue+Fj
		mov	status_0, [ebp+conn]
		mov	eax, [eax+54h]
		add	eax, 6Ch
		mov	[esp], eax
		call	_silc_fsm_continue
		xor	eax, eax
		leave
		retn
; ---------------------------------------------------------------------------
status_0 = eax				; SilcStatus
		align 4

loc_62B93A08:				; CODE XREF: _silc_client_resume_continue+13j
		mov	al, 1
		leave
		retn
_silc_client_resume_continue endp

; Exported entry 216. silc_client_st_resume

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_resume(SilcFSMObject *fsm,	void *fsm_context, void	*state_context)
		public _silc_client_st_resume
_silc_client_st_resume proc near	; DATA XREF: _silc_client_st_connected:loc_62B86380o

client		= dword	ptr -4Ch
client_id	= SilcClientID ptr -3Dh
id		= dword	ptr -20h
id_len		= word ptr -1Ah
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 8Ch
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4Ch]
		mov	[ebp+client], eax
		mov	dword ptr [esp+4], 20h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	edi, eax
		test	eax, eax
		jz	loc_62B93BE0
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	[esp+4], eax
		mov	[esp], fsm_0
		call	_silc_fsm_set_state_context
		mov	eax, [fsm_context_0+54h]
		mov	edx, [eax+2Ch]
		mov	eax, [eax+28h]
		mov	[edi+8], eax
		mov	[edi+0Ch], eax
		add	eax, edx
		mov	[edi+14h], eax
		mov	[edi+10h], eax
		mov	dword ptr [esp+30h], 1Dh
		lea	eax, [edi+1Ch]
		mov	[esp+2Ch], eax
		mov	dword ptr [esp+28h], 5
		mov	dword ptr [esp+24h], 0
		mov	dword ptr [esp+20h], 5
		lea	eax, [ebp+id_len]
		mov	[esp+1Ch], eax
		lea	eax, [ebp+id]
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 0Eh
		mov	dword ptr [esp+10h], 0
		lea	eax, [edi+18h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 14h
		mov	dword ptr [esp+4], 19h
		add	edi, 8
		mov	[esp], edi
		call	_silc_buffer_unformat
		test	eax, eax
ret = eax				; int
		js	loc_62B93BE0
		mov	dword ptr [esp+10h], 1Dh
		lea	edi, [ebp+client_id]
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 2
		movzx	ret, [ebp+id_len]
		mov	[esp+4], eax
		mov	eax, [ebp+id]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jz	loc_62B93BE0
		mov	dword ptr [esp+14h], 2
		mov	[esp+10h], edi
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+0ECh]
		mov	[esp+0Ch], eax
		mov	edx, [ebp+client]
		mov	eax, [edx+10h]
		mov	[esp+8], eax
		mov	eax, [fsm_context_0+38h]
		mov	[esp+4], eax
		mov	eax, [fsm_context_0+34h]
		mov	[esp], eax
		call	_silc_auth_public_key_auth_generate
		test	eax, eax
auth = eax				; SilcBuffer
		jz	loc_62B93BE0
		mov	ecx, [auth+4]
		movzx	edx, [ebp+id_len]
		mov	dword ptr [esp+2Ch], 1Dh
		mov	auth, [auth+8]
		sub	eax, ecx
		mov	[esp+28h], eax
		mov	[esp+24h], ecx
		mov	dword ptr [esp+20h], 0Ch
		mov	[esp+1Ch], edx
		mov	eax, [ebp+id]
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 0Ch
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], 3
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1Ch
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_send_va
		test	al, al
		jz	short loc_62B93BE0
		mov	eax, [fsm_context_0+54h]
		or	byte ptr [eax+12Dh], 20h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0Fh
		mov	dword ptr [esp+4], offset _silc_client_st_resume_resolve_channels
		mov	[esp], fsm_0
		call	_silc_fsm_next_later
		mov	eax, 2
		add	esp, 8Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
ret = eax				; int
		align 10h

loc_62B93BE0:				; CODE XREF: _silc_client_st_resume+30j
					; _silc_client_st_resume+C2j ...
		mov	dword ptr [esp+4], offset _silc_client_st_resume_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 8Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	edi
		leave
		retn
_silc_client_st_resume endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 212. silc_client_st_register

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_register(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_st_register
_silc_client_st_register proc near	; DATA XREF: _silc_client_st_connected:loc_62B86362o
					; _silc_client_st_register_complete:loc_62B93F48o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	ebx, [ebp+fsm_context]
		mov	edx, [ebx+4Ch]
client = edx				; SilcClient
		mov	eax, [ebx+54h]
		cmp	dword ptr [eax+120h], 0Ch
		jbe	short loc_62B93C44
fsm_context_0 =	ebx			; void *
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		test	eax, eax
		jz	loc_62B93D6C
		mov	esi, [client]

loc_62B93C2A:				; CODE XREF: _silc_client_st_register+173j
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_1C]
nick = edi				; char *
		repne scasb
		not	ecx
		dec	ecx
		mov	[ebp+var_20], ecx
		mov	[ebp+var_2C], ecx
		jmp	short loc_62B93C5B
; ---------------------------------------------------------------------------
		align 4

loc_62B93C44:				; CODE XREF: _silc_client_st_register+19j
		mov	esi, [client]

loc_62B93C46:				; CODE XREF: _silc_client_st_register+179j
		mov	[ebp+var_2C], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0

loc_62B93C5B:				; CODE XREF: _silc_client_st_register+3Fj
		mov	client,	[client+8]
		mov	[ebp+var_28], edx
		mov	edx, 0FFFFFFFFh
		xor	eax, eax
		mov	ecx, edx
		mov	edi, [ebp+var_28]
		repne scasb
		not	ecx
		dec	ecx
		mov	[ebp+var_24], ecx
		mov	ecx, edx
		mov	edi, esi
		repne scasb
		mov	edx, ecx
		not	edx
		dec	edx
		mov	dword ptr [esp+48h], 1Dh
		mov	eax, [ebp+var_2C]
		mov	[esp+44h], eax
		mov	ecx, [ebp+var_1C]
		mov	[esp+40h], ecx
		mov	dword ptr [esp+3Ch], 0Ch
		mov	eax, [ebp+var_20]
		mov	[esp+38h], eax
		mov	dword ptr [esp+34h], 3
		mov	ecx, [ebp+var_24]
		mov	[esp+30h], ecx
		mov	eax, [ebp+var_28]
		mov	[esp+2Ch], eax
		mov	dword ptr [esp+28h], 0Ch
		mov	[esp+24h], ecx
		mov	dword ptr [esp+20h], 3
		mov	[esp+1Ch], edx
		mov	[esp+18h], esi
		mov	dword ptr [esp+14h], 0Ch
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], 3
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 13h
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_send_va
		test	al, al
		jz	short loc_62B93D4C
		mov	eax, [fsm_context_0+54h]
		or	byte ptr [eax+12Dh], 20h
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [fsm_context_0+54h]
		movzx	eax, byte ptr [eax+127h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset _silc_client_st_register_complete
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next_later
		mov	eax, 2
		add	esp, 7Ch
		pop	fsm_context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
		align 4

loc_62B93D4C:				; CODE XREF: _silc_client_st_register+108j
		mov	dword ptr [esp+4], offset _silc_client_st_register_error
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 7Ch
		pop	fsm_context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
client = edx				; SilcClient
		align 4

loc_62B93D6C:				; CODE XREF: _silc_client_st_register+22j
		mov	esi, [client]
		mov	[ebp+var_1C], esi
		test	esi, esi
		jnz	loc_62B93C2A
		jmp	loc_62B93C46
_silc_client_st_register endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 213. silc_client_st_register_complete

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_register_complete(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_st_register_complete
_silc_client_st_register_complete proc near ; DATA XREF: _silc_client_st_register+12Ao

var_19		= byte ptr -19h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4Ch]
client = esi				; SilcClient
		mov	eax, [ebx+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B93F0C
fsm_context_0 =	ebx			; void *
		mov	edx, [fsm_context_0+4]
		test	edx, edx
		jz	loc_62B93ED8
		mov	eax, [eax+0F4h]
		mov	edx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 5
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_command_called_dummy ;	reply
		mov	dword ptr [esp+8], 3 ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_command_send
		mov	eax, [fsm_context_0+54h]
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_62B93E0A
		cmp	dword ptr [eax+120h], 0Ch
		jbe	loc_62B93F2C

loc_62B93E0A:				; CODE XREF: _silc_client_st_register_complete+7Bj
					; _silc_client_st_register_complete+1C1j
		mov	eax, [eax+0F8h]
		mov	edx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 2
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_command_called_dummy ;	reply
		mov	dword ptr [esp+8], 0Ah ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_command_send
		mov	eax, [fsm_context_0+48h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], fsm_context_0
		mov	[esp], client
		call	dword ptr [fsm_context_0+44h]
		mov	eax, [fsm_context_0+54h]
		and	byte ptr [eax+12Dh], 0DFh
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_connect_timeout
		mov	dword ptr [esp+4], 0
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+0B4h]
		mov	[esp], eax
		call	_silc_schedule_task_del_by_all
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+100h]
		mov	[esp], eax
		call	_silc_async_free
		mov	eax, [fsm_context_0+54h]
		mov	dword ptr [eax+100h], 0
		mov	eax, 3

loc_62B93ECF:				; CODE XREF: _silc_client_st_register_complete+202j
		add	esp, 4Ch
		pop	ebx
		pop	client
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
client = esi				; SilcClient
		align 4

loc_62B93ED8:				; CODE XREF: _silc_client_st_register_complete+24j
		mov	cl, [eax+126h]
		lea	edi, [ecx+1]
		mov	edx, edi
		mov	[eax+126h], dl
		cmp	cl, 3
		jbe	short loc_62B93F48
		mov	eax, [fsm_context_0+54h]
		and	byte ptr [eax+12Dh], 0DFh
		mov	eax, [fsm_context_0+54h]
		mov	byte ptr [eax+126h], 0
		mov	eax, [fsm_context_0+54h]
		mov	byte ptr [eax+127h], 1

loc_62B93F0C:				; CODE XREF: _silc_client_st_register_complete+19j
		mov	dword ptr [esp+4], offset _silc_client_st_register_error
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	client
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
client = esi				; SilcClient
		align 4

loc_62B93F2C:				; CODE XREF: _silc_client_st_register_complete+84j
		mov	eax, [client]
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_utf8_strcasecmp
		test	al, al
		jz	short loc_62B93F88

loc_62B93F3E:				; CODE XREF: _silc_client_st_register_complete+235j
		mov	eax, [fsm_context_0+54h]
		jmp	loc_62B93E0A
; ---------------------------------------------------------------------------
		align 4

loc_62B93F48:				; CODE XREF: _silc_client_st_register_complete+16Cj
		mov	dword ptr [esp+4], offset _silc_client_st_register
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		mov	fsm_context_0, [fsm_context_0+54h]
		mov	al, [ebx+127h]
		shl	eax, 1
		mov	[ebp+var_19], al
		mov	eax, [client+10h]
		mov	[esp], eax
		call	_silc_rng_get_rn16
		and	eax, 1
		add	al, [ebp+var_19]
		mov	[ebx+127h], al
		xor	eax, eax
		jmp	loc_62B93ECF
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
		align 4

loc_62B93F88:				; CODE XREF: _silc_client_st_register_complete+1BCj
		mov	dword ptr [esp+14h], 0
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aNick ; "NICK"
		mov	dword ptr [esp+8], 0 ; command_line
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_command_call
		jmp	short loc_62B93F3E
_silc_client_st_register_complete endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 157. silc_client_new_id

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_new_id(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_new_id
_silc_client_new_id proc near		; DATA XREF: _silc_client_connection_st_packet:loc_62B81F70o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
id		= SilcID ptr -38h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	ebx, [ebp+fsm_context]
		mov	edx, [ebp+state_context]
		mov	esi, [ebx+4Ch]
client = esi				; SilcClient
		mov	ecx, [ebx+4]
		test	ecx, ecx
		jz	short loc_62B93FE8

out:					; CODE XREF: _silc_client_new_id+53j
					; _silc_client_new_id+9Aj ...
fsm_context_0 =	ebx			; void *
		mov	[esp], edx
		call	_silc_packet_free
		mov	eax, 3
		add	esp, 5Ch
		pop	fsm_context_0
		pop	client
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= edx			; void *
client = esi				; SilcClient
		align 4

loc_62B93FE8:				; CODE XREF: _silc_client_new_id+17j
		mov	ecx, [state_context_0+0Ch]
		lea	edi, [ebp+id]
		mov	[esp+8], edi
		mov	eax, [state_context_0+10h]
		sub	eax, ecx
		mov	[esp+4], eax
		mov	[esp], ecx
		mov	[ebp+var_48], state_context_0
		call	_silc_id_payload_parse_id
		test	al, al
		mov	edx, [ebp+var_48]
		jz	short out
		mov	eax, [fsm_context_0+54h]
		cmp	dword ptr [eax+120h], 0Ch
		ja	loc_62B9415C

loc_62B9401D:				; CODE XREF: _silc_client_new_id+1A8j
nick = eax				; char *
		mov	nick, [client]
		mov	ecx, nick

loc_62B94021:				; CODE XREF: _silc_client_new_id+1B0j
nick = ecx				; char * ; mode
		mov	dword ptr [esp+18h], 0
		mov	[esp+14h], edi	; id
		mov	edi, [client+8]
		mov	[esp+10h], edi	; userinfo
		mov	[esp+0Ch], nick	; username
		mov	[esp+8], eax	; nickname
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+var_48], edx
		call	_silc_client_add_client
		mov	[fsm_context_0], eax
		test	eax, eax
		mov	edx, [ebp+var_48]
		jz	out
		add	eax, 38Ch
		mov	[fsm_context_0+4], eax
		mov	eax, [fsm_context_0+54h]
		mov	[ebp+var_44], eax
		mov	client,	[edx+10h]
		mov	edi, [edx+0Ch]
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	[ebp+var_3C], eax
		test	eax, eax
		mov	edx, [ebp+var_48]
		jz	loc_62B941DA
		sub	esi, edi
		jz	loc_62B941CF
		mov	dword ptr [esp+4], 1
		mov	[esp], esi
		call	_silc_calloc
		mov	ecx, [ebp+var_3C]
		mov	[ecx], eax
		test	eax, eax
		mov	edx, [ebp+var_48]
		jz	loc_62B941DA
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		lea	ecx, [eax+esi]
		mov	edi, [ebp+var_3C]
		mov	[edi+0Ch], ecx
		mov	edi, ecx
		sub	edi, eax
		cmp	esi, edi
		ja	short loc_62B940D5

loc_62B940CD:				; CODE XREF: _silc_client_new_id+21Dj
		mov	eax, [ebp+var_3C]
		mov	[eax+8], ecx
		mov	eax, ecx

loc_62B940D5:				; CODE XREF: _silc_client_new_id+113j
		mov	esi, [edx+0Ch]
		mov	ecx, [edx+10h]
		sub	ecx, esi
		mov	edi, [ebp+var_3C]
		mov	edi, [edi+4]
		mov	[ebp+var_40], edi
		sub	eax, edi
		cmp	ecx, eax
		ja	short loc_62B940F1
state_context_0	= edx			; void *
		mov	edi, [ebp+var_40]
		rep movsb

loc_62B940F1:				; CODE XREF: _silc_client_new_id+132j
					; _silc_client_new_id+229j
		mov	edi, [ebp+var_3C]
		mov	ecx, [ebp+var_44]
		mov	[ecx+0F4h], edi
		mov	al, [edx+20h]
		mov	cl, al
		and	ecx, 3Fh
		jnz	short loc_62B94170
state_context_0	= edx			; void *
		lea	esi, [fsm_context_0+10h]

loc_62B9410A:				; CODE XREF: _silc_client_new_id+212j
		movzx	eax, word ptr [fsm_context_0+2Eh]
		mov	[esp+10h], esi
		mov	[esp+0Ch], eax
		mov	eax, [fsm_context_0+4]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp], eax
		mov	[ebp+var_48], edx
		call	_silc_packet_set_ids
		mov	eax, [fsm_context_0+54h]
		test	byte ptr [eax+12Dh], 20h
		mov	edx, [ebp+var_48]
		jz	out
		add	eax, 6Ch
		mov	[esp], eax
		call	_silc_fsm_continue_sync
		mov	edx, [ebp+var_48]
		jmp	out
; ---------------------------------------------------------------------------
client = esi				; SilcClient
		align 4

loc_62B9415C:				; CODE XREF: _silc_client_new_id+5Fj
		mov	eax, [eax]
nick = eax				; char *
		test	nick, nick
		jz	loc_62B9401D
		mov	ecx, [client]
nick = ecx				; char *
		jmp	loc_62B94021
; ---------------------------------------------------------------------------
state_context_0	= edx			; void *
		align 10h

loc_62B94170:				; CODE XREF: _silc_client_new_id+14Dj
		mov	esi, [fsm_context_0+54h]
		shr	al, 6
		movzx	eax, al
		mov	[esp+8], eax
		movzx	ecx, cl
		mov	[esp+4], ecx
		mov	eax, [state_context_0+18h]
		mov	[esp], eax
		mov	[ebp+var_48], state_context_0
		call	_silc_id_payload_encode_data
		mov	[esi+0F8h], eax
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+0F8h]
		test	eax, eax
		mov	edx, [ebp+var_48]
		jz	out
		mov	ecx, [eax+4]
		lea	esi, [fsm_context_0+10h]
		mov	[esp+8], esi
		mov	eax, [eax+8]
		sub	eax, ecx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	_silc_id_payload_parse_id
		mov	edx, [ebp+var_48]
		jmp	loc_62B9410A
; ---------------------------------------------------------------------------

loc_62B941CF:				; CODE XREF: _silc_client_new_id+D8j
		mov	eax, [ebp+var_3C]
		mov	ecx, [eax+8]
		jmp	loc_62B940CD
; ---------------------------------------------------------------------------

loc_62B941DA:				; CODE XREF: _silc_client_new_id+D0j
					; _silc_client_new_id+F8j
		mov	[ebp+var_3C], 0
		jmp	loc_62B940F1
_silc_client_new_id endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 220. silc_client_st_resume_resolve_cmodes

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_resume_resolve_cmodes(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_st_resume_resolve_cmodes
_silc_client_st_resume_resolve_cmodes proc near
					; DATA XREF: _silc_client_st_resume_resolve_channels+38o

channels	= SilcList ptr -2Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	edx, [ebp+fsm]
		mov	esi, [ebp+fsm_context]
		mov	edi, [esi+4Ch]
client = edi				; SilcClient
		mov	eax, [esi+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B94390
fsm_0 =	edx				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
		mov	dword ptr [esp+4], offset _silc_client_st_resume_completed
		mov	[esp], fsm_0
		call	_silc_fsm_next
		lea	eax, [ebp+channels]
		mov	[esp+4], eax
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+118h]
		mov	[esp], eax
		call	_silc_idcache_get_all
		test	al, al
		jz	loc_62B94374
		mov	eax, dword ptr [ebp+channels._bf10]
		shr	eax, 2
		lea	edx, [eax+eax*2]
		mov	eax, [ebp+state_context]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+channels.head]
		mov	[ebp+channels.current],	eax
		and	[ebp+channels._bf10], 0FDh
		jmp	loc_62B94359
; ---------------------------------------------------------------------------

loc_62B94258:				; CODE XREF: _silc_client_st_resume_resolve_cmodes+179j
idp = ebx				; SilcBuffer
		movzx	edx, [ebp+channels.prev_offset]
		mov	edx, [eax+edx]

loc_62B9425F:				; CODE XREF: _silc_client_st_resume_resolve_cmodes+186j
		mov	eax, [eax+0Ch]
		add	eax, 114h
		mov	[ebp+channels.current],	edx
		mov	dword ptr [esp+4], 3
		mov	[esp], eax
		call	_silc_id_payload_encode
		mov	idp, eax
		test	eax, eax
		jz	loc_62B94356
idp = eax				; SilcBuffer
		mov	edx, [ebx+4]
		mov	idp, [ebx+8]
idp = ebx				; SilcBuffer
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	[esp+10h], fsm_context_0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_resume_continue ; reply
		mov	dword ptr [esp+8], 11h ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_command_send
		mov	edx, [idp+4]
		mov	eax, [idp+8]
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	[esp+10h], fsm_context_0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_resume_continue ; reply
		mov	dword ptr [esp+8], 19h ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_command_send
		mov	edx, [idp+4]
		mov	eax, [idp+8]
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	[esp+10h], fsm_context_0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_resume_continue ; reply
		mov	dword ptr [esp+8], 6 ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		call	_silc_client_command_send
		mov	eax, [idp]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], idp
		call	_silc_free

loc_62B94356:				; CODE XREF: _silc_client_st_resume_resolve_cmodes+96j
		mov	eax, [ebp+channels.current]

loc_62B94359:				; CODE XREF: _silc_client_st_resume_resolve_cmodes+6Bj
		test	eax, eax
		jz	short loc_62B94384
		test	[ebp+channels._bf10], 2
		jnz	loc_62B94258
		movzx	edx, [ebp+channels.next_offset]
		mov	edx, [eax+edx]
		jmp	loc_62B9425F
; ---------------------------------------------------------------------------
		align 4

loc_62B94374:				; CODE XREF: _silc_client_st_resume_resolve_cmodes+4Cj
		mov	eax, 1
		add	esp, 5Ch
		pop	ebx
		pop	fsm_context_0
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
client = edi				; SilcClient
idp = ebx				; SilcBuffer
		align 4

loc_62B94384:				; CODE XREF: _silc_client_st_resume_resolve_cmodes+173j
		mov	al, 2
		add	esp, 5Ch
		pop	idp
		pop	fsm_context_0
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edx				; SilcFSMObject	*
fsm_context_0 =	esi			; void *
client = edi				; SilcClient
		align 10h

loc_62B94390:				; CODE XREF: _silc_client_st_resume_resolve_cmodes+1Cj
		mov	dword ptr [esp+4], offset _silc_client_st_resume_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 5Ch
		pop	ebx
		pop	fsm_context_0
		pop	client
		leave
		retn
_silc_client_st_resume_resolve_cmodes endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry 219. silc_client_st_resume_resolve_channels

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_st_resume_resolve_channels(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_st_resume_resolve_channels
_silc_client_st_resume_resolve_channels	proc near ; DATA XREF: _silc_client_st_resume+1B3o

idp		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
conn		= dword	ptr -64h
res_argv_types	= dword	ptr -60h
argv		= dword	ptr -5Ch
res_argv_lens	= dword	ptr -58h
client		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
channel_id	= SilcChannelID	ptr -3Ah
name		= dword	ptr -24h
chid		= dword	ptr -20h
chid_len	= word ptr -1Ah
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0BCh
		mov	ecx, [ebp+fsm]
		mov	edi, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	eax, [edi+4Ch]
		mov	[ebp+client], eax
		mov	eax, [edi+54h]
		mov	dl, [eax+12Dh]
		test	dl, 2
		jnz	loc_62B94731
fsm_0 =	ecx				; SilcFSMObject	*
fsm_context_0 =	edi			; void *
state_context_0	= esi			; void *
		mov	ebx, [fsm_context_0+4]
		test	ebx, ebx
		jz	loc_62B94728
		mov	dword ptr [esp+4], offset _silc_client_st_resume_resolve_cmodes
		mov	[esp], fsm_0
		call	_silc_fsm_next
		mov	dword ptr [esp+18h], 0 ; idp_len
		mov	dword ptr [esp+14h], 0 ; idp
		mov	dword ptr [esp+10h], 0 ; new_id
		mov	eax, [state_context_0+18h]
		mov	[esp+0Ch], eax	; new_nick
		mov	eax, [fsm_context_0]
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], fsm_context_0 ; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_change_nickname
		mov	eax, [fsm_context_0+54h]
		mov	eax, [eax+0F4h]
		mov	edx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_command_called_dummy ;	reply
		mov	dword ptr [esp+8], 10h ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_command_send
		mov	eax, [state_context_0+1Ch]
		test	eax, eax
		jz	loc_62B94718
		lea	eax, [state_context_0+8]
		mov	[ebp+var_50], eax
		xor	ebx, ebx
i = ebx					; int
		mov	[ebp+argv], 0
		xor	eax, eax
res_argc = eax				; SilcUInt32
		mov	[ebp+res_argv_types], 0
		mov	[ebp+res_argv_lens], 0
		mov	[ebp+conn], fsm_context_0
		mov	fsm_context_0, res_argc
		mov	[ebp+var_4C], state_context_0
res_argc = edi				; SilcUInt32
		xchg	ax, ax

loc_62B944AC:				; CODE XREF: _silc_client_st_resume_resolve_channels+19Bj
		mov	dword ptr [esp+28h], 1Dh
		mov	dword ptr [esp+24h], 0
		mov	dword ptr [esp+20h], 5
		lea	edx, [ebp+chid_len]
		mov	[esp+1Ch], edx
		lea	ecx, [ebp+chid]
		mov	[esp+18h], ecx
		mov	dword ptr [esp+14h], 0Eh
		mov	dword ptr [esp+10h], 0
		lea	eax, [ebp+name]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0Eh
		mov	dword ptr [esp+4], 19h
		mov	edx, [ebp+var_50]
		mov	[esp], edx
		call	_silc_buffer_unformat
		test	eax, eax
		js	short loc_62B94536
		mov	dword ptr [esp+10h], 16h
		lea	ecx, [ebp+channel_id]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 3
		movzx	eax, [ebp+chid_len]
		mov	[esp+4], eax
		mov	eax, [ebp+chid]
		mov	[esp], eax
		call	_silc_id_str2id
		test	al, al
		jnz	short loc_62B9454C

loc_62B94536:				; CODE XREF: _silc_client_st_resume_resolve_channels+15Aj
					; _silc_client_st_resume_resolve_channels+1C3j
		mov	esi, res_argc
		inc	i
		mov	edx, [ebp+var_4C]
		cmp	i, [edx+1Ch]
		jnb	loc_62B94680

loc_62B94545:				; CODE XREF: _silc_client_st_resume_resolve_channels+2CDj
res_argc = esi				; SilcUInt32
		mov	edi, res_argc
		jmp	loc_62B944AC
; ---------------------------------------------------------------------------

loc_62B9454C:				; CODE XREF: _silc_client_st_resume_resolve_channels+188j
res_argc = edi				; SilcUInt32
		mov	dword ptr [esp+8], 3
		movzx	eax, [ebp+chid_len]
		mov	[esp+4], eax
		mov	eax, [ebp+chid]
		mov	[esp], eax
		call	_silc_id_payload_encode_data
		mov	[ebp+idp], eax
		test	eax, eax
		jz	short loc_62B94536
		lea	eax, [ebp+channel_id]
		mov	[esp+8], eax	; channel_id
		mov	edx, [ebp+conn]
		mov	[esp+4], edx	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel_by_id
		test	eax, eax
channel	= eax				; SilcChannelEntry
		jz	loc_62B94750
		mov	[esp+8], channel ; channel_entry
		mov	channel, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_channel

loc_62B945A8:				; CODE XREF: _silc_client_st_resume_resolve_channels+3CCj
		lea	esi, [res_argc+1]
res_argc = esi				; SilcUInt32
		lea	ecx, ds:0[res_argc*4]
		mov	[esp+4], ecx
		mov	eax, [ebp+argv]
		mov	[esp], eax
		mov	[ebp+var_70], ecx
		call	_silc_realloc
		mov	[ebp+argv], eax
		mov	ecx, [ebp+var_70]
		mov	[esp+4], ecx
		mov	edx, [ebp+res_argv_lens]
		mov	[esp], edx
		call	_silc_realloc
		mov	[ebp+res_argv_lens], eax
		mov	ecx, [ebp+var_70]
		mov	[esp+4], ecx
		mov	ecx, [ebp+res_argv_types]
		mov	[esp], ecx
		call	_silc_realloc
		mov	[ebp+res_argv_types], eax
		lea	eax, ds:0[edi*4]
		mov	[ebp+var_7C], eax
		mov	edx, [ebp+idp]
		mov	edx, [edx]
		mov	[ebp+var_68], edx
		mov	ecx, [ebp+res_argv_lens]
		add	ecx, eax
		mov	[ebp+var_6C], ecx
		jz	short loc_62B9461E
res_argc = edi				; SilcUInt32
		mov	edx, [ebp+idp]
		mov	eax, [edx+0Ch]
		sub	eax, [ebp+var_68]
		mov	[ecx], eax

loc_62B9461E:				; CODE XREF: _silc_client_st_resume_resolve_channels+262j
		mov	ecx, [ebp+idp]
		mov	dword ptr [ecx+0Ch], 0
		mov	dword ptr [ecx+8], 0
		mov	dword ptr [ecx+4], 0
		mov	dword ptr [ecx], 0
		mov	ecx, [ebp+var_68]
		mov	edx, [ebp+argv]
		mov	eax, [ebp+var_7C]
		mov	[edx+eax], ecx
		add	res_argc, 5
res_argc = esi				; SilcUInt32
		mov	edx, [ebp+res_argv_types]
		mov	[edx+eax], edi
		mov	ecx, [ebp+idp]
		mov	eax, [ecx]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [ebp+idp]
		mov	[esp], eax
		call	_silc_free
		inc	i
		mov	edx, [ebp+var_4C]
		cmp	i, [edx+1Ch]
		jb	loc_62B94545
		nop

loc_62B94680:				; CODE XREF: _silc_client_st_resume_resolve_channels+193j
		mov	edx, res_argc
		mov	edi, [ebp+conn]
fsm_context_0 =	edi			; void *
		mov	res_argc, [ebp+var_4C]
state_context_0	= esi			; void *
res_argc = edx				; SilcUInt32
		mov	ecx, [ebp+res_argv_types]
		mov	[esp+20h], ecx	; argv_types
		mov	eax, [ebp+res_argv_lens]
		mov	[esp+1Ch], eax	; argv_lens
		mov	ecx, [ebp+argv]
		mov	[esp+18h], ecx	; argv
		mov	[esp+14h], res_argc ; argc
		mov	[esp+10h], fsm_context_0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_resume_continue ; reply
		mov	dword ptr [esp+8], 3 ; command
		mov	[esp+4], fsm_context_0 ; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_command_send_argv
		mov	i, [state_context_0+1Ch]
		test	ebx, ebx
		jz	short loc_62B946E7
		xor	eax, eax
		xor	ebx, ebx
i = ebx					; int
		mov	fsm_context_0, [ebp+argv]
res_argv = edi				; unsigned __int8 **
		xchg	ax, ax

loc_62B946D4:				; CODE XREF: _silc_client_st_resume_resolve_channels+339j
		mov	eax, [res_argv+eax*4]
		mov	[esp], eax
		call	_silc_free
		inc	i
		mov	eax, i
		cmp	i, [state_context_0+1Ch]
		jb	short loc_62B946D4

loc_62B946E7:				; CODE XREF: _silc_client_st_resume_resolve_channels+31Dj
		mov	edx, [ebp+argv]
		mov	[esp], edx
		call	_silc_free
		mov	ecx, [ebp+res_argv_lens]
		mov	[esp], ecx
		call	_silc_free
		mov	eax, [ebp+res_argv_types]
		mov	[esp], eax
		call	_silc_free
		mov	eax, 2
		add	esp, 0BCh
		pop	i
		pop	state_context_0
		pop	res_argv
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B94718:				; CODE XREF: _silc_client_st_resume_resolve_channels+D1j
fsm_context_0 =	edi			; void *
state_context_0	= esi			; void *
		mov	eax, 1
		add	esp, 0BCh
		pop	ebx
		pop	state_context_0
		pop	fsm_context_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B94728:				; CODE XREF: _silc_client_st_resume_resolve_channels+32j
fsm_0 =	ecx				; SilcFSMObject	*
fsm_context_0 =	edi			; void *
state_context_0	= esi			; void *
		and	edx, 0FFFFFFDFh
		mov	[eax+12Dh], dl

loc_62B94731:				; CODE XREF: _silc_client_st_resume_resolve_channels+27j
		mov	dword ptr [esp+4], offset _silc_client_st_resume_error
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 0BCh
		pop	ebx
		pop	state_context_0
		pop	fsm_context_0
		leave
		retn
; ---------------------------------------------------------------------------
res_argc = edi				; SilcUInt32
i = ebx					; int
channel	= eax				; SilcChannelEntry
		align 10h

loc_62B94750:				; CODE XREF: _silc_client_st_resume_resolve_channels+1E0j
		lea	channel, [ebp+channel_id]
		mov	[esp+10h], eax	; channel_id
		mov	dword ptr [esp+0Ch], 0 ; mode
		mov	eax, [ebp+name]
		mov	[esp+8], eax	; channel_name
		mov	edx, [ebp+conn]
		mov	[esp+4], edx	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_add_channel
		jmp	loc_62B945A8
_silc_client_st_resume_resolve_channels	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 137. silc_client_get_detach_data

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBuffer __cdecl silc_client_get_detach_data(SilcClient client, SilcClientConnection conn)
		public _silc_client_get_detach_data
_silc_client_get_detach_data proc near	; CODE XREF: _silc_client_command_reply_detach+1B1p

var_A0		= dword	ptr -0A0h
detach		= dword	ptr -9Ch
id		= byte ptr -90h
chid		= byte ptr -50h
htl		= SilcHashTableList ptr	-30h
chid_len	= dword	ptr -24h
id_len		= dword	ptr -20h
chu		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ECh
		mov	ebx, [ebp+conn]
		mov	eax, [ebx]
		mov	eax, [eax+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_count
		mov	[ebp+var_A0], eax
		lea	eax, [ebp+id_len]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 40h
		lea	esi, [ebp+id]
		mov	[esp+8], esi
		mov	dword ptr [esp+4], 2
		mov	eax, [ebx+4]
		mov	[esp], eax
		call	_silc_id_id2str
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	[ebp+detach], eax
		test	eax, eax
		jz	loc_62B9498F
conn_0 = ebx				; SilcClientConnection
		mov	edx, [conn_0]
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, edx
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+40h], 1Dh
		mov	eax, [ebp+var_A0]
		mov	[esp+3Ch], eax
		mov	dword ptr [esp+38h], 5
		mov	eax, [edx+3ACh]
		mov	[esp+34h], eax
		mov	dword ptr [esp+30h], 5
		mov	eax, [ebp+id_len]
		mov	[esp+2Ch], eax
		mov	[esp+28h], esi
		mov	dword ptr [esp+24h], 0Ch
		mov	[esp+20h], eax
		mov	dword ptr [esp+1Ch], 3
		mov	[esp+18h], ecx
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 0Ch
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], 19h
		mov	edx, [ebp+detach]
		mov	[esp], edx
		call	_silc_buffer_format
		test	eax, eax
ret = eax				; int
		js	loc_62B949A0
		lea	edx, [ebp+htl]
		mov	[esp+4], edx
		mov	ret, [conn_0]
		mov	eax, [eax+3B4h]
		mov	[esp], eax
		call	_silc_hash_table_list
		lea	esi, [ebp+chid]
		jmp	loc_62B94957
; ---------------------------------------------------------------------------
		align 4

loc_62B948A8:				; CODE XREF: _silc_client_get_detach_data+1F3j
		lea	eax, [ebp+chid_len]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 20h
		mov	[esp+8], esi
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+chu]
		mov	eax, [eax+8]
		add	eax, 114h
		mov	[esp], eax
		call	_silc_id_id2str
		mov	eax, [ebp+chu]
		mov	edx, [eax+8]
		mov	ebx, [edx]
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, ebx
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+38h], 1Dh
		mov	eax, [edx+12Ch]
		mov	[esp+34h], eax
		mov	dword ptr [esp+30h], 5
		mov	edx, [ebp+chid_len]
		mov	[esp+2Ch], edx
		mov	[esp+28h], esi
		mov	dword ptr [esp+24h], 0Ch
		mov	[esp+20h], edx
		mov	dword ptr [esp+1Ch], 3
		mov	[esp+18h], ecx
		mov	[esp+14h], ebx
		mov	dword ptr [esp+10h], 0Ch
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], 19h
		mov	eax, [ebp+detach]
		mov	[esp], eax
		call	_silc_buffer_format

loc_62B94957:				; CODE XREF: _silc_client_get_detach_data+122j
		lea	edx, [ebp+chu]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 0
		lea	eax, [ebp+htl]
		mov	[esp], eax
		call	_silc_hash_table_get
		test	al, al
		jnz	loc_62B948A8
		lea	edx, [ebp+htl]
		mov	[esp], edx
		call	_silc_hash_table_list_reset
		mov	edx, [ebp+detach]
		mov	eax, [edx]
		mov	[edx+4], eax

loc_62B9498F:				; CODE XREF: _silc_client_get_detach_data+6Dj
					; _silc_client_get_detach_data+248j
		mov	eax, [ebp+detach]
		add	esp, 0ECh
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B949A0:				; CODE XREF: _silc_client_get_detach_data+102j
conn_0 = ebx				; SilcClientConnection
ret = eax				; int
		mov	edx, [ebp+detach]
		mov	ret, [edx]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [ebp+detach]
		mov	[esp], eax
		call	_silc_free
		mov	[ebp+detach], 0
		jmp	short loc_62B9498F
_silc_client_get_detach_data endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  27. silc_client_command_continue_error

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_continue_error(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_command_continue_error
_silc_client_command_continue_error proc near ;	DATA XREF: _silc_client_command_continue+9Fo
					; _silc_client_command_resolve_continue:loc_62B952D4o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, 3
		leave
		retn
_silc_client_command_continue_error endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  25. silc_client_command_called_dummy

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_command_called_dummy(SilcClient client, SilcClientConnection conn, SilcCommand command, SilcStatus status, SilcStatus error, void *context, va_list ap)
		public _silc_client_command_called_dummy
_silc_client_command_called_dummy proc near
					; DATA XREF: _silc_client_st_resume_completed+66o
					; _silc_client_st_resume_completed+B6o	...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= byte ptr  10h
status		= byte ptr  14h
error		= byte ptr  18h
context		= dword	ptr  1Ch
ap		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		xor	eax, eax
		leave
		retn
_silc_client_command_called_dummy endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  80. silc_client_command_resolve_dummy

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_command_resolve_dummy(SilcClient client, SilcClientConnection conn, SilcStatus status, SilcDList clients, void *context)
		public _silc_client_command_resolve_dummy
_silc_client_command_resolve_dummy proc	near ; DATA XREF: _silc_client_command_watch+87o

client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
clients		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		leave
		retn
_silc_client_command_resolve_dummy endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __usercall silc_buffer_free_0(SilcBuffer	sb@<eax>)
_silc_buffer_free_0 proc near		; CODE XREF: _silc_client_command+17Bp
					; _silc_client_command_cumode+42Bp ...
sb = eax				; SilcBuffer
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, sb
		test	sb, sb
		jz	short loc_62B94A07
		mov	sb, [sb]
sb = ebx				; SilcBuffer
		mov	[esp], eax
		call	_silc_free
		mov	[esp], sb
		call	_silc_free

loc_62B94A07:				; CODE XREF: _silc_buffer_free_0+Bj
		add	esp, 14h
		pop	sb
sb = eax				; SilcBuffer
		leave
		retn
_silc_buffer_free_0 endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  30. silc_client_command_free

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_command_free(SilcClientCommandContext cmd)
		public _silc_client_command_free
_silc_client_command_free proc near	; CODE XREF: _silc_client_command_destructor+58j
					; _silc_client_command_destructor+B8j ...

cmd		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, [ebp+cmd]
		mov	eax, [ebx+38h]
		test	eax, eax
		jz	short loc_62B94A3E
cmd_0 =	ebx				; SilcClientCommandContext
		xor	eax, eax
		xor	esi, esi
i = esi					; int
		xchg	ax, ax

loc_62B94A28:				; CODE XREF: _silc_client_command_free+2Cj
		mov	edx, [cmd_0+3Ch]
		mov	eax, [edx+eax*4]
		mov	[esp], eax
		call	_silc_free
		inc	i
		mov	eax, i
		cmp	[cmd_0+38h], i
		ja	short loc_62B94A28

loc_62B94A3E:				; CODE XREF: _silc_client_command_free+10j
		mov	eax, [cmd_0+3Ch]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [cmd_0+40h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [cmd_0+44h]
		mov	[esp], eax
		call	_silc_free
		mov	eax, [cmd_0+48h]
		mov	[cmd_0+50h], eax
		and	byte ptr [cmd_0+58h], 0FDh
		jmp	short loc_62B94A81
; ---------------------------------------------------------------------------
		align 4

loc_62B94A6C:				; CODE XREF: _silc_client_command_free+79j
		movzx	edx, word ptr [cmd_0+56h]
		mov	edx, [eax+edx]

loc_62B94A73:				; CODE XREF: _silc_client_command_free+82j
		mov	[cmd_0+50h], edx
		mov	[esp], eax
		call	_silc_free
		mov	eax, [cmd_0+50h]

loc_62B94A81:				; CODE XREF: _silc_client_command_free+59j
		test	eax, eax
		jz	short loc_62B94A94
		test	byte ptr [cmd_0+58h], 2
		jnz	short loc_62B94A6C
		movzx	edx, word ptr [cmd_0+54h]
		mov	edx, [eax+edx]
		jmp	short loc_62B94A73
; ---------------------------------------------------------------------------

loc_62B94A94:				; CODE XREF: _silc_client_command_free+73j
		mov	[ebp+cmd], cmd_0
		add	esp, 10h
		pop	cmd_0
		pop	i
		leave
		jmp	_silc_free
_silc_client_command_free endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_command_destructor(SilcFSMThread thread, void *fsm_context, void *destructor_context)
_silc_client_command_destructor	proc near ; DATA XREF: _silc_client_command_call+1A8o
					; _silc_client_command_send_argv+143o ...

var_3C		= dword	ptr -3Ch
conn		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
thread		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
destructor_context= dword ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+fsm_context]
cmd = ebx				; SilcClientCommandContext
		mov	eax, [cmd+4]
		mov	[ebp+conn], eax
		mov	edi, [eax+54h]
		mov	[ebp+var_1C], edi
		mov	edx, [edi+0D8h]
prev = edx				; void *
		test	prev, prev
		jz	short loc_62B94AE7
		cmp	cmd, prev
		jz	loc_62B94B6E
		movzx	esi, word ptr [edi+0E4h]
		jmp	short loc_62B94ADE
; ---------------------------------------------------------------------------
p = ecx					; void **
prev = eax				; void *
		align 4

loc_62B94AD8:				; CODE XREF: _silc_client_command_destructor+41j
		cmp	cmd, prev
		jz	short loc_62B94B04
		mov	edx, prev

loc_62B94ADE:				; CODE XREF: _silc_client_command_destructor+31j
prev = edx				; void *
		lea	p, [prev+esi]
		mov	eax, [p]
prev = eax				; void *
		test	prev, prev
		jnz	short loc_62B94AD8

loc_62B94AE7:				; CODE XREF: _silc_client_command_destructor+20j
prev = edx				; void *
		mov	eax, [ebp+var_1C]
		cmp	[eax+0DCh], cmd
		jz	short loc_62B94B4C

loc_62B94AF2:				; CODE XREF: _silc_client_command_destructor+A6j
		mov	[ebp+thread], cmd
		add	esp, 3Ch
		pop	cmd
		pop	esi
		pop	edi
		leave
		jmp	_silc_client_command_free
; ---------------------------------------------------------------------------
cmd = ebx				; SilcClientCommandContext
p = ecx					; void **
prev = eax				; void *
		align 4

loc_62B94B04:				; CODE XREF: _silc_client_command_destructor+36j
		mov	[ebp+var_3C], p

loc_62B94B07:				; CODE XREF: _silc_client_command_destructor+DCj
		mov	prev, [cmd+esi]
prev = edx				; void *
		mov	esi, [ebp+var_3C]
		mov	[esi], eax
		test	eax, eax
		jz	short loc_62B94B29
		test	byte ptr [edi+0E8h], 1
		jz	short loc_62B94B29
		movzx	p, word	ptr [edi+0E6h]
		mov	esi, [cmd+ecx]
		mov	[eax+ecx], esi

loc_62B94B29:				; CODE XREF: _silc_client_command_destructor+6Dj
					; _silc_client_command_destructor+76j
p = ecx					; void **
		cmp	[edi+0E0h], cmd
		jz	short loc_62B94B61

loc_62B94B31:				; CODE XREF: _silc_client_command_destructor+C8j
		sub	dword ptr [edi+0E8h], 4
		mov	esi, [ebp+conn]
		mov	esi, [esi+54h]
		mov	[ebp+var_1C], esi
		mov	eax, [ebp+var_1C]
		cmp	[eax+0DCh], cmd
		jnz	short loc_62B94AF2

loc_62B94B4C:				; CODE XREF: _silc_client_command_destructor+4Cj
		mov	[eax+0DCh], prev
		mov	[ebp+thread], cmd
		add	esp, 3Ch
		pop	cmd
		pop	esi
		pop	edi
		leave
		jmp	_silc_client_command_free
; ---------------------------------------------------------------------------

loc_62B94B61:				; CODE XREF: _silc_client_command_destructor+8Bj
cmd = ebx				; SilcClientCommandContext
p = ecx					; void **
prev = edx				; void *
		mov	p, [ebp+var_3C]
		mov	eax, [ecx]
		mov	[edi+0E0h], eax
		jmp	short loc_62B94B31
; ---------------------------------------------------------------------------

loc_62B94B6E:				; CODE XREF: _silc_client_command_destructor+24j
		lea	ecx, [edi+0D8h]
		mov	[ebp+var_3C], ecx
		movzx	esi, word ptr [edi+0E4h]
		xor	prev, prev
		jmp	short loc_62B94B07
_silc_client_command_destructor	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __usercall silc_client_command_register@<al>(SilcClient client@<eax>, SilcCommand command@<dl>, const char *name@<ecx>, SilcFSMStateCallback	command_func, SilcFSMStateCallback command_reply_func, SilcUInt8 max_args)
_silc_client_command_register proc near	; CODE XREF: _silc_client_commands_register+2CEp
					; _silc_client_commands_register+AA6p ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
command_func	= dword	ptr  8
command_reply_func= dword ptr  0Ch
max_args	= dword	ptr  10h

client = eax				; SilcClient
command	= edx				; SilcCommand
name = ecx				; const	char *
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	[ebp+var_20], client
		mov	ebx, command
		mov	edi, name
		mov	client,	[ebp+max_args]
		mov	[ebp+var_1C], eax
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
command	= ebx				; SilcCommand
name = edi				; const	char *
		mov	esi, eax
cmd = esi				; SilcClientCommand
		test	eax, eax
		jz	short loc_62B94C33
cmd = eax				; SilcClientCommand
		mov	[cmd+4], bl
		mov	cmd, [ebp+command_func]
cmd = esi				; SilcClientCommand
		mov	[cmd+8], eax
		mov	eax, [ebp+command_reply_func]
		mov	[cmd+0Ch], eax
		mov	dl, byte ptr [ebp+var_1C]
		mov	[cmd+14h], dl
		test	name, name
		jz	short loc_62B94C24
command_reply_func_0 = eax		; SilcFSMStateCallback
		mov	[esp], name	; char *
		call	_strdup
		mov	[cmd+10h], eax
		test	eax, eax
		jz	short loc_62B94C2B
		mov	edx, [ebp+var_20]
		mov	eax, [edx+18h]
		mov	edx, [eax+58h]
		test	edx, edx
		jz	short loc_62B94C40
		movzx	edx, word ptr [eax+64h]
		mov	ecx, [eax+5Ch]
		mov	[ecx+edx], cmd

loc_62B94BF3:				; CODE XREF: _silc_client_command_register+BFj
		test	byte ptr [eax+68h], 1
		jnz	short loc_62B94C18

loc_62B94BF9:				; CODE XREF: _silc_client_command_register+9Ej
		mov	[eax+5Ch], cmd
		movzx	edx, word ptr [eax+64h]
		mov	dword ptr [cmd+edx], 0
		add	dword ptr [eax+68h], 4
		mov	al, 1
		add	esp, 2Ch
		pop	command
		pop	cmd
		pop	name
		leave
		retn
; ---------------------------------------------------------------------------
command	= ebx				; SilcCommand
name = edi				; const	char *
cmd = esi				; SilcClientCommand
		align 4

loc_62B94C18:				; CODE XREF: _silc_client_command_register+73j
		movzx	edx, word ptr [eax+66h]
		mov	ecx, [eax+5Ch]
		mov	[cmd+edx], ecx
		jmp	short loc_62B94BF9
; ---------------------------------------------------------------------------

loc_62B94C24:				; CODE XREF: _silc_client_command_register+47j
command_reply_func_0 = eax		; SilcFSMStateCallback
		mov	dword ptr [cmd+10h], 0

loc_62B94C2B:				; CODE XREF: _silc_client_command_register+56j
		mov	[esp], cmd
		call	_silc_free

loc_62B94C33:				; CODE XREF: _silc_client_command_register+2Ej
		xor	eax, eax
		add	esp, 2Ch
		pop	command
		pop	cmd
		pop	name
		leave
		retn
; ---------------------------------------------------------------------------
command	= ebx				; SilcCommand
name = edi				; const	char *
cmd = esi				; SilcClientCommand
		align 10h

loc_62B94C40:				; CODE XREF: _silc_client_command_register+63j
		mov	[eax+58h], cmd
		jmp	short loc_62B94BF3
_silc_client_command_register endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  83. silc_client_command_service

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_service(SilcFSMObject	*fsm, void *fsm_context, void *state_context)
		public _silc_client_command_service
_silc_client_command_service proc near	; DATA XREF: _silc_client_commands_unregister+1225o
					; _silc_client_commands_register+B41o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+fsm_context]
		mov	ecx, [eax+4]
		mov	edx, [ecx+4Ch]
		mov	ebx, [edx+18h]
		mov	ebx, [ebx+48h]
		mov	esi, [eax+3Ch]
		mov	[esp+18h], esi
		mov	esi, [eax+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	eax, byte ptr [eax+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 1
		mov	[esp+4], ecx
		mov	[esp], edx
		call	dword ptr [ebx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 20h
		pop	ebx
		pop	esi
		leave
		retn
_silc_client_command_service endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  84. silc_client_command_silcoper

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_silcoper(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_silcoper
_silc_client_command_silcoper proc near	; DATA XREF: _silc_client_commands_unregister+F65o
					; _silc_client_commands_register+A93o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		cmp	dword ptr [ebx+38h], 1
		jbe	loc_62B94D58
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	dword ptr [esp+4], offset _silc_client_command_oper_send
		mov	[esp], fsm_0
		call	_silc_fsm_next
		cmp	dword ptr [fsm_context_0+38h], 2
		jbe	short loc_62B94CE8

loc_62B94CDE:				; CODE XREF: _silc_client_command_silcoper+9Aj
		xor	eax, eax

loc_62B94CE0:				; CODE XREF: _silc_client_command_silcoper+14Ej
		add	esp, 2Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B94CE8:				; CODE XREF: _silc_client_command_silcoper+30j
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
conn = edi				; SilcClientConnection
		mov	dword ptr [esp+4], 8
		mov	dword ptr [esp], 1
		call	_silc_calloc
		test	eax, eax
		jz	loc_62B94DF8
		mov	[fsm_context_0+60h], eax
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	loc_62B94DC4

loc_62B94D1A:				; CODE XREF: _silc_client_command_silcoper+144j
		mov	eax, [conn+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_command_oper_cb
		mov	[esp+4], conn
		mov	[esp], eax
		call	dword ptr [edx+20h]
		mov	al, [fsm_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		test	al, 4
		jz	short loc_62B94CDE
		mov	eax, 2
		add	esp, 2Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
conn = edi				; SilcClientConnection
		align 4

loc_62B94D58:				; CODE XREF: _silc_client_command_silcoper+16j
		mov	eax, [conn+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	dword ptr [esp+0Ch], offset aUsageSilcoperU ; "Usage: /SILCOPER	<username> [-pubkey]"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], eax
		call	dword ptr [edx]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	fsm_0, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
conn = edi				; SilcClientConnection
		align 4

loc_62B94DC4:				; CODE XREF: _silc_client_command_silcoper+68j
		mov	dword ptr [esp+8], 91Bh
		mov	dword ptr [esp+4], offset aCommand_c ; "command.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_5	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B94D1A
; ---------------------------------------------------------------------------
		align 4

loc_62B94DF8:				; CODE XREF: _silc_client_command_silcoper+52j
		mov	al, 3
		jmp	loc_62B94CE0
_silc_client_command_silcoper endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  42. silc_client_command_oper

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_oper(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_oper
_silc_client_command_oper proc near	; DATA XREF: _silc_client_commands_unregister+885o
					; _silc_client_commands_register+5D3o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		cmp	dword ptr [ebx+38h], 1
		jbe	loc_62B94EAC
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	dword ptr [esp+4], offset _silc_client_command_oper_send
		mov	[esp], fsm_0
		call	_silc_fsm_next
		cmp	dword ptr [fsm_context_0+38h], 2
		jbe	short loc_62B94E3C

loc_62B94E32:				; CODE XREF: _silc_client_command_oper+9Aj
		xor	eax, eax

loc_62B94E34:				; CODE XREF: _silc_client_command_oper+14Ej
		add	esp, 2Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B94E3C:				; CODE XREF: _silc_client_command_oper+30j
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
conn = edi				; SilcClientConnection
		mov	dword ptr [esp+4], 8
		mov	dword ptr [esp], 1
		call	_silc_calloc
		test	eax, eax
		jz	loc_62B94F4C
		mov	[fsm_context_0+60h], eax
		mov	al, [fsm_0+28h]
		mov	dl, al
		or	edx, 4
		mov	[fsm_0+28h], dl
		test	al, 4
		jnz	loc_62B94F18

loc_62B94E6E:				; CODE XREF: _silc_client_command_oper+144j
		mov	eax, [conn+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	[esp+0Ch], fsm_context_0
		mov	dword ptr [esp+8], offset _silc_client_command_oper_cb
		mov	[esp+4], conn
		mov	[esp], eax
		call	dword ptr [edx+20h]
		mov	al, [fsm_0+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[fsm_0+28h], dl
		test	al, 4
		jz	short loc_62B94E32
		mov	eax, 2
		add	esp, 2Ch
		pop	fsm_context_0
		pop	fsm_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
conn = edi				; SilcClientConnection
		align 4

loc_62B94EAC:				; CODE XREF: _silc_client_command_oper+16j
		mov	eax, [conn+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	dword ptr [esp+0Ch], offset aUsageOperUsern ; "Usage: /OPER <username> [-pubkey]"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], eax
		call	dword ptr [edx]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	fsm_0, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
conn = edi				; SilcClientConnection
		align 4

loc_62B94F18:				; CODE XREF: _silc_client_command_oper+68j
		mov	dword ptr [esp+8], 8FCh
		mov	dword ptr [esp+4], offset aCommand_c ; "command.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_5	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B94E6E
; ---------------------------------------------------------------------------
		align 4

loc_62B94F4C:				; CODE XREF: _silc_client_command_oper+52j
		mov	al, 3
		jmp	loc_62B94E34
_silc_client_command_oper endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __usercall silc_client_command_add_pending@<al>(SilcClientConnection	conn@<eax>, SilcClientCommandContext cmd@<edx>,	SilcClientCommandReply reply@<ecx>, void *context)
_silc_client_command_add_pending proc near ; CODE XREF:	_silc_client_command_send_argv+110p
					; _silc_client_command_send_vap+93p

context		= dword	ptr  8

conn = eax				; SilcClientConnection
cmd = edx				; SilcClientCommandContext
reply =	ecx				; SilcClientCommandReply
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	ebx, conn
		mov	esi, cmd
		mov	edi, reply
		mov	conn, [conn+54h]
conn = ebx				; SilcClientConnection
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
cmd = esi				; SilcClientCommandContext
reply =	edi				; SilcClientCommandReply
		test	reply, reply
		jz	short loc_62B94FCA
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		test	eax, eax
cb = eax				; SilcClientCommandReplyCallback
		jz	loc_62B95060
		mov	[cb+4],	reply
		mov	edx, [ebp+context]
		mov	[cb+8],	edx
		mov	reply, [cmd+48h]
		test	edi, edi
		jz	loc_62B95054
context_0 = edx				; void *
		movzx	context_0, word	ptr [cmd+54h]
		mov	ecx, [cmd+4Ch]
		mov	[ecx+edx], cb

loc_62B94FB2:				; CODE XREF: _silc_client_command_add_pending+107j
		test	byte ptr [cmd+58h], 1
		jnz	loc_62B9503C

loc_62B94FBC:				; CODE XREF: _silc_client_command_add_pending+F2j
		mov	[cmd+4Ch], cb
		mov	dword ptr [cb+edx], 0
		add	dword ptr [cmd+58h], 4

loc_62B94FCA:				; CODE XREF: _silc_client_command_add_pending+22j
reply =	edi				; SilcClientCommandReply
		mov	cb, [conn+54h]
		mov	ecx, [eax+0D8h]
		test	ecx, ecx
		jz	short loc_62B9504C
		movzx	edx, word ptr [eax+0E4h]
		mov	ecx, [eax+0DCh]
		mov	[ecx+edx], cmd

loc_62B94FE7:				; CODE XREF: _silc_client_command_add_pending+FEj
		test	byte ptr [eax+0E8h], 1
		jnz	short loc_62B95028

loc_62B94FF0:				; CODE XREF: _silc_client_command_add_pending+E4j
		mov	[eax+0DCh], cmd
		movzx	edx, word ptr [eax+0E4h]
		mov	dword ptr [cmd+edx], 0
		add	dword ptr [eax+0E8h], 4
		mov	eax, [conn+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	al, 1

loc_62B9501E:				; CODE XREF: _silc_client_command_add_pending+11Fj
		add	esp, 1Ch
		pop	conn
		pop	cmd
		pop	reply
		leave
		retn
; ---------------------------------------------------------------------------
conn = ebx				; SilcClientConnection
cmd = esi				; SilcClientCommandContext
reply =	edi				; SilcClientCommandReply
		align 4

loc_62B95028:				; CODE XREF: _silc_client_command_add_pending+9Aj
		movzx	edx, word ptr [eax+0E6h]
		mov	ecx, [eax+0DCh]
		mov	[cmd+edx], ecx
		jmp	short loc_62B94FF0
; ---------------------------------------------------------------------------
cb = eax				; SilcClientCommandReplyCallback
		align 4

loc_62B9503C:				; CODE XREF: _silc_client_command_add_pending+62j
		movzx	ecx, word ptr [cmd+56h]
		mov	edi, [cmd+4Ch]
		mov	[cb+ecx], edi
		jmp	loc_62B94FBC
; ---------------------------------------------------------------------------
reply =	edi				; SilcClientCommandReply
		align 4

loc_62B9504C:				; CODE XREF: _silc_client_command_add_pending+81j
		mov	[eax+0D8h], cmd
		jmp	short loc_62B94FE7
; ---------------------------------------------------------------------------

loc_62B95054:				; CODE XREF: _silc_client_command_add_pending+4Ej
context_0 = edx				; void *
cb = eax				; SilcClientCommandReplyCallback
		mov	[cmd+48h], cb
		movzx	context_0, word	ptr [cmd+54h]
		jmp	loc_62B94FB2
; ---------------------------------------------------------------------------

loc_62B95060:				; CODE XREF: _silc_client_command_add_pending+3Aj
reply =	edi				; SilcClientCommandReply
		mov	cb, [conn+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		xor	eax, eax
		jmp	short loc_62B9501E
_silc_client_command_add_pending endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  44. silc_client_command_pending

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcBool __cdecl silc_client_command_pending(SilcClientConnection conn, SilcCommand command, SilcUInt16 ident, SilcClientCommandReply	reply, void *context)
		public _silc_client_command_pending
_silc_client_command_pending proc near	; CODE XREF: _silc_client_get_server_by_id_resolve+22Dp
					; _silc_client_get_client_by_id_resolve+28Ep ...

var_3C		= dword	ptr -3Ch
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
conn		= dword	ptr  8
command		= byte ptr  0Ch
ident		= dword	ptr  10h
reply		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	edi, [ebp+conn]
		mov	dl, [ebp+command]
		mov	esi, [ebp+ident]
		test	edi, edi
		jz	loc_62B951C3
conn_0 = edi				; SilcClientConnection
command_0 = edx				; SilcCommand
ident_0	= esi				; SilcUInt16
		mov	ebx, [ebp+reply]
		test	ebx, ebx
		jz	loc_62B951C3
		mov	eax, [conn_0+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		mov	[ebp+var_20], dl
		call	_silc_mutex_lock
		mov	eax, [conn_0+54h]
		mov	ecx, [eax+0D8h]
		mov	[eax+0E0h], ecx
		and	byte ptr [eax+0E8h], 0FDh
		mov	eax, [conn_0+54h]
		mov	[ebp+var_3C], conn_0
		mov	dl, [ebp+var_20]

loc_62B950D0:				; CODE XREF: _silc_client_command_pending+8Aj
					; _silc_client_command_pending+90j ...
		mov	ebx, [eax+0E0h]
		test	ebx, ebx
		jz	loc_62B95184

loc_62B950DE:				; CODE XREF: _silc_client_command_pending+103j
		test	byte ptr [eax+0E8h], 2
		jz	loc_62B9519C
		movzx	ecx, word ptr [eax+0E6h]
		mov	ecx, [ebx+ecx]

loc_62B950F5:				; CODE XREF: _silc_client_command_pending+12Ej
		mov	[eax+0E0h], ecx
		cmp	[ebx+34h], dl
		jz	short loc_62B95104
command_0 = edx				; SilcCommand
		test	dl, dl
		jnz	short loc_62B950D0

loc_62B95104:				; CODE XREF: _silc_client_command_pending+86j
		cmp	[ebx+36h], si
		jnz	short loc_62B950D0
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		mov	[ebp+var_20], dl
		call	_silc_calloc
		test	eax, eax
cb = eax				; SilcClientCommandReplyCallback
		mov	dl, [ebp+var_20]
		jz	loc_62B951B8
		mov	edi, [ebp+reply]
		mov	[cb+4],	edi
		mov	ecx, [ebp+context]
		mov	[cb+8],	ecx
		mov	ecx, [ebx+48h]
		test	ecx, ecx
		jz	short loc_62B951AC
		movzx	ecx, word ptr [ebx+54h]
		mov	[ebp+var_1C], ecx
		mov	edi, [ebx+4Ch]
		mov	[edi+ecx], cb

loc_62B9514C:				; CODE XREF: _silc_client_command_pending+13Ej
		test	byte ptr [ebx+58h], 1
		jz	short loc_62B9515C
		movzx	ecx, word ptr [ebx+56h]
		mov	edi, [ebx+4Ch]
		mov	[cb+ecx], edi

loc_62B9515C:				; CODE XREF: _silc_client_command_pending+D8j
		mov	[ebx+4Ch], cb
		mov	ecx, [ebp+var_1C]
		mov	dword ptr [cb+ecx], 0
		add	dword ptr [ebx+58h], 4
		mov	edi, [ebp+var_3C]
		mov	cb, [edi+54h]
		mov	ebx, [eax+0E0h]
		test	ebx, ebx
		jnz	loc_62B950DE
		lea	ident_0, [ident_0+0]

loc_62B95184:				; CODE XREF: _silc_client_command_pending+60j
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	al, 1

loc_62B95194:				; CODE XREF: _silc_client_command_pending+14Dj
		add	esp, 4Ch
		pop	ebx
		pop	ident_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9519C:				; CODE XREF: _silc_client_command_pending+6Dj
ident_0	= esi				; SilcUInt16
		movzx	ecx, word ptr [eax+0E4h]
		mov	ecx, [ebx+ecx]
		jmp	loc_62B950F5
; ---------------------------------------------------------------------------
cb = eax				; SilcClientCommandReplyCallback
		align 4

loc_62B951AC:				; CODE XREF: _silc_client_command_pending+C5j
		mov	[ebx+48h], cb
		movzx	edi, word ptr [ebx+54h]
		mov	[ebp+var_1C], edi
		jmp	short loc_62B9514C
; ---------------------------------------------------------------------------

loc_62B951B8:				; CODE XREF: _silc_client_command_pending+AEj
		mov	ecx, [ebp+var_3C]
		mov	cb, [ecx+54h]
		jmp	loc_62B950D0
; ---------------------------------------------------------------------------

loc_62B951C3:				; CODE XREF: _silc_client_command_pending+14j
					; _silc_client_command_pending+1Fj
conn_0 = edi				; SilcClientConnection
command_0 = edx				; SilcCommand
		xor	eax, eax
		jmp	short loc_62B95194
_silc_client_command_pending endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBool __cdecl silc_client_command_continue(SilcClient client, SilcClientConnection	conn, SilcCommand command, SilcStatus status, SilcStatus error,	void *context, va_list ap)
_silc_client_command_continue proc near	; DATA XREF: _silc_client_command_getkey+2F6o

var_1C		= byte ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= byte ptr  10h
status		= byte ptr  14h
error		= byte ptr  18h
context		= dword	ptr  1Ch
ap		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+context]
		mov	al, [ebp+status]
		mov	dl, [ebp+error]
		test	al, al
		jz	short loc_62B951E3
status_0 = eax				; SilcStatus
error_0	= edx				; SilcStatus
context_0 = ebx				; void *
		cmp	dl, 9
		ja	short loc_62B95214

loc_62B951E3:				; CODE XREF: _silc_client_command_continue+14j
		mov	al, [context_0+30h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+30h], dl
		test	al, 4
		jz	short loc_62B951FC

loc_62B951F2:				; CODE XREF: _silc_client_command_continue+BCj
		xor	eax, eax

loc_62B951F4:				; CODE XREF: _silc_client_command_continue+9Aj
					; _silc_client_command_continue+CCj
		add	esp, 3Ch
		pop	context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B951FC:				; CODE XREF: _silc_client_command_continue+28j
context_0 = ebx				; void *
		add	context_0, 8
		mov	[esp], ebx
		call	_silc_fsm_continue
		xor	eax, eax
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
status_0 = eax				; SilcStatus
error_0	= edx				; SilcStatus
context_0 = ebx				; void *
		align 4

loc_62B95214:				; CODE XREF: _silc_client_command_continue+19j
		mov	esi, [context_0+4]
		mov	ecx, [esi+4Ch]
		mov	edi, [ecx+18h]
		mov	edi, [edi+48h]
		mov	esi, [context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [context_0+38h]
		mov	[esp+14h], esi
		movzx	error_0, dl
		mov	[esp+10h], error_0
		movzx	error_0, byte ptr [context_0+34h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	edx, [context_0+4]
		mov	[esp+4], edx
		mov	[esp], ecx
		mov	[ebp+var_1C], al
		call	dword ptr [edi+10h]
		mov	al, [ebp+var_1C]
		cmp	al, 9
		ja	short loc_62B95264
status_0 = eax				; SilcStatus
		cmp	al, 3
		jz	short loc_62B95264
		mov	al, 1
		jmp	short loc_62B951F4
; ---------------------------------------------------------------------------

loc_62B95264:				; CODE XREF: _silc_client_command_continue+92j
					; _silc_client_command_continue+96j
status_0 = eax				; SilcStatus
		lea	esi, [context_0+8]
		mov	dword ptr [esp+4], offset _silc_client_command_continue_error
		mov	[esp], esi
		call	_silc_fsm_next
		mov	al, [context_0+30h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+30h], dl
		test	al, 4
		jnz	loc_62B951F2
		mov	[esp], esi
		call	_silc_fsm_continue
		xor	eax, eax
		jmp	loc_62B951F4
_silc_client_command_continue endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_command_resolve_continue(SilcClient client, SilcClientConnection conn, SilcStatus status, SilcDList clients,	void *context)
_silc_client_command_resolve_continue proc near	; DATA XREF: _silc_client_command_kill+3E1o
					; _silc_client_command_invite+688o ...

client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
clients		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		cmp	[ebp+status], 0
		jnz	short loc_62B952D4

loc_62B952AC:				; CODE XREF: _silc_client_command_resolve_continue+4Bj
context_0 = ebx				; void *
		mov	al, [context_0+30h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+30h], dl
		test	al, 4
		jz	short loc_62B952C4
		add	esp, 14h
		pop	context_0
		leave
		retn
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 4

loc_62B952C4:				; CODE XREF: _silc_client_command_resolve_continue+1Dj
		add	context_0, 8
		mov	[ebp+client], ebx
		add	esp, 14h
		pop	ebx
		leave
		jmp	_silc_fsm_continue
; ---------------------------------------------------------------------------

loc_62B952D4:				; CODE XREF: _silc_client_command_resolve_continue+Ej
context_0 = ebx				; void *
		mov	dword ptr [esp+4], offset _silc_client_command_continue_error
		lea	eax, [context_0+8]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	short loc_62B952AC
_silc_client_command_resolve_continue endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_command_oper_cb(const unsigned __int8 *data,	SilcUInt32 data_len, void *context)
_silc_client_command_oper_cb proc near	; DATA XREF: _silc_client_command_silcoper+7Bo
					; _silc_client_command_oper+7Bo

data		= dword	ptr  8
data_len	= dword	ptr  0Ch
context		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	eax, [ebp+data]
		mov	esi, [ebp+data_len]
		mov	ebx, [ebp+context]
cmd = ebx				; SilcClientCommandContext
		mov	edi, [cmd+60h]
oper = edi				; SilcClientCommandOper
		test	eax, eax
		jz	short loc_62B95309
data_0 = eax				; const	unsigned __int8	*
data_len_0 = esi			; SilcUInt32
		test	data_len_0, data_len_0
		jnz	short loc_62B95338

loc_62B95309:				; CODE XREF: _silc_client_command_oper_cb+17j
					; _silc_client_command_oper_cb+5Aj
		mov	[oper+4], data_len_0
		mov	al, [cmd+30h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[cmd+30h], dl
		test	al, 4
		jz	short loc_62B95324
		add	esp, 1Ch
		pop	cmd
		pop	data_len_0
		pop	oper
		leave
		retn
; ---------------------------------------------------------------------------
data_len_0 = esi			; SilcUInt32
cmd = ebx				; SilcClientCommandContext
oper = edi				; SilcClientCommandOper
		align 4

loc_62B95324:				; CODE XREF: _silc_client_command_oper_cb+2Dj
		add	cmd, 8
		mov	[ebp+data], ebx
		add	esp, 1Ch
		pop	ebx
		pop	data_len_0
		pop	oper
		leave
		jmp	_silc_fsm_continue
; ---------------------------------------------------------------------------
data_0 = eax				; const	unsigned __int8	*
data_len_0 = esi			; SilcUInt32
cmd = ebx				; SilcClientCommandContext
oper = edi				; SilcClientCommandOper
		align 4

loc_62B95338:				; CODE XREF: _silc_client_command_oper_cb+1Bj
		mov	[esp+4], data_len_0
		mov	[esp], data_0
		call	_silc_memdup
		mov	[oper],	eax
		jmp	short loc_62B95309
_silc_client_command_oper_cb endp

; Exported entry  47. silc_client_command_quit_final

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_quit_final(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_quit_final
_silc_client_command_quit_final	proc near ; DATA XREF: _silc_client_command_quit+7Bo

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+fsm_context]
		mov	ebx, [eax+4]
conn = ebx				; SilcClientConnection
		mov	edx, [conn+4Ch]
		mov	ecx, [edx+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [eax+3Ch]
		mov	[esp+18h], esi
		mov	esi, [eax+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	eax, byte ptr [eax+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 1
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [ecx+10h]
		mov	eax, [conn+54h]
		mov	dword ptr [eax+128h], 2
		mov	dl, [eax+12Dh]
		test	dl, 2
		jnz	short loc_62B953C0
		or	edx, 2
		mov	[eax+12Dh], dl
		mov	eax, [conn+54h]
		add	eax, 98h
		mov	[esp], eax
		call	_silc_fsm_event_signal

loc_62B953C0:				; CODE XREF: _silc_client_command_quit_final+5Dj
		mov	eax, 3
		add	esp, 20h
		pop	conn
		pop	esi
		leave
		retn
_silc_client_command_quit_final	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcBuffer T_337(SilcUInt32 len)
_T_337		proc near		; CODE XREF: _silc_client_command_cmode:loc_62B99354p
					; _silc_client_command_watch:loc_62B9B8C8p

len		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
sb = ebx				; SilcBuffer
		test	eax, eax
		jz	short loc_62B95413
sb = eax				; SilcBuffer
		mov	dword ptr [esp+4], 1
		mov	dword ptr [esp], 2
		call	_silc_calloc
sb = ebx				; SilcBuffer
		mov	[sb], eax
		test	eax, eax
		jz	short loc_62B9541B
		mov	[sb+4],	eax
		add	eax, 2
		mov	[sb+0Ch], eax
		mov	[sb+8],	eax

loc_62B95413:				; CODE XREF: _T_337+1Fj _T_337+51j
		mov	eax, sb
		add	esp, 14h
		pop	sb
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9541B:				; CODE XREF: _T_337+39j
sb = ebx				; SilcBuffer
		xor	sb, sb
		jmp	short loc_62B95413
_T_337		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  24. silc_client_command_call

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 silc_client_command_call(SilcClient client, SilcClientConnection conn, const char *command_line, ...)
		public _silc_client_command_call
_silc_client_command_call proc near	; CODE XREF: _silc_client_st_register_complete+230p

var_30		= dword	ptr -30h
va		= dword	ptr -2Ch
argv_types	= dword	ptr -28h
argv_lens	= dword	ptr -24h
argv		= dword	ptr -20h
argc		= dword	ptr -1Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
command_line	= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= byte ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	edi, [ebp+client]
		mov	[ebp+argc], 0
		mov	[ebp+argv], 0
		mov	[ebp+argv_lens], 0
		mov	[ebp+argv_types], 0
		mov	esi, [ebp+conn]
		test	esi, esi
		jz	loc_62B95778
client_0 = edi				; SilcClient
		mov	ebx, [ebp+command_line]
		test	ebx, ebx
		jz	loc_62B95624
		mov	dword ptr [esp+4], offset asc_62BA89D8 ; " "
		mov	eax, [ebp+command_line]
		mov	[esp], eax	; char *
		call	_strcspn
		mov	[esp+4], eax
		mov	edx, [ebp+command_line]
		mov	[esp], edx
		call	_silc_memdup
		mov	esi, eax
command_name = esi			; char *
		test	eax, eax
		jz	loc_62B95764
command_name = eax			; char *
		mov	command_name, [client_0+18h]
command_name = esi			; char *
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh

loc_62B95497:				; CODE XREF: _silc_client_command_call+B0j
command	= ebx				; SilcClientCommand
		mov	eax, [client_0+18h]
		xchg	ax, ax

loc_62B9549C:				; CODE XREF: _silc_client_command_call+A0j
		mov	command, [eax+60h]
		test	ebx, ebx
		jz	loc_62B95610
		test	byte ptr [eax+68h], 2
		jz	loc_62B95604
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B954B8:				; CODE XREF: _silc_client_command_call+1EBj
		mov	[eax+60h], edx
		mov	edx, [ebx+10h]
command	= ebx				; SilcClientCommand
		test	edx, edx
		jz	short loc_62B9549C
		mov	[esp+4], command_name ;	char *
		mov	[esp], edx	; char *
		call	_stricmp
		test	eax, eax
		jnz	short loc_62B95497
		movzx	eax, byte ptr [command+14h]
		mov	[esp+14h], eax
		lea	eax, [ebp+argc]
		mov	[esp+10h], eax
		lea	eax, [ebp+argv_types]
		mov	[esp+0Ch], eax
		lea	eax, [ebp+argv_lens]
		mov	[esp+8], eax
		lea	eax, [ebp+argv]
		mov	[esp+4], eax
		mov	ecx, [ebp+command_line]
		mov	[esp], ecx
		call	_silc_parse_command_line
		mov	[esp], command_name
		call	_silc_free

loc_62B95509:				; CODE XREF: _silc_client_command_call+38Aj
		mov	dword ptr [esp+4], 68h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	edx, eax
cmd = edx				; SilcClientCommandContext
		test	eax, eax
		jz	loc_62B95764
cmd = eax				; SilcClientCommandContext
		mov	edi, [ebp+conn]
		mov	[cmd+4], edi
		mov	al, [command+4]
cmd = edx				; SilcClientCommandContext
		mov	[cmd+34h], al
		mov	eax, [ebp+argc]
		mov	[cmd+38h], eax
		mov	eax, [ebp+argv]
		mov	[cmd+3Ch], eax
		mov	eax, [ebp+argv_lens]
		mov	[cmd+40h], eax
		mov	eax, [ebp+argv_types]
		mov	[cmd+44h], eax
		mov	eax, [edi+54h]
		mov	si, [eax+124h]
		mov	cx, [eax+124h]
		inc	ecx
		mov	[eax+124h], cx
		inc	si
cmd_ident = esi				; SilcUInt16
		jnz	short loc_62B9557F
		mov	si, [eax+124h]
		mov	cx, [eax+124h]
		inc	ecx
		mov	[eax+124h], cx
		inc	esi

loc_62B9557F:				; CODE XREF: _silc_client_command_call+146j
cmd_ident = esi				; SilcUInt16
		mov	[cmd+36h], si
		or	byte ptr [cmd+64h], 3
		mov	eax, [cmd+58h]
		and	eax, 3
		mov	[cmd+58h], eax
		mov	word ptr [cmd+54h], 0
		mov	word ptr [cmd+56h], 0
		mov	byte ptr [cmd+58h], 0
		mov	dword ptr [cmd+50h], 0
		mov	dword ptr [cmd+4Ch], 0
		mov	dword ptr [cmd+48h], 0
		lea	edi, [cmd+8]
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], offset _silc_client_command_destructor
		mov	[esp+8], cmd
		mov	cmd, [ebp+conn]
		mov	eax, [edx+54h]
		add	eax, 40h
		mov	[esp+4], eax
		mov	[esp], edi
		call	_silc_fsm_thread_init
		mov	eax, [command+8]
		mov	[esp+4], eax
		mov	[esp], edi
		call	_silc_fsm_start_sync
		mov	eax, cmd_ident
		add	esp, 4Ch
		pop	command
		pop	cmd_ident
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = edi				; SilcClient
command_name = esi			; char *
		align 4

loc_62B95604:				; CODE XREF: _silc_client_command_call+8Bj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B954B8
; ---------------------------------------------------------------------------

loc_62B95610:				; CODE XREF: _silc_client_command_call+81j
		mov	[esp], command_name
		call	_silc_free
		xor	command_name, command_name

loc_62B9561A:				; CODE XREF: _silc_client_command_call+346j
cmd_ident = esi				; SilcUInt16
command	= ebx				; SilcClientCommand
command_name = eax			; char *
		mov	command_name, cmd_ident
cmd = edx				; SilcClientCommandContext
		add	esp, 4Ch
		pop	command
		pop	cmd_ident
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B95624:				; CODE XREF: _silc_client_command_call+38j
client_0 = edi				; SilcClient
		mov	esi, [ebp+arg_C]
arg = esi				; char *
		test	arg, arg
		jz	loc_62B95764
		lea	eax, [ebp+arg_10]
		mov	[ebp+va], eax
		mov	eax, [client_0+18h]
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh

loc_62B95642:				; CODE XREF: _silc_client_command_call+25Cj
command	= ebx				; SilcClientCommand
		mov	eax, [client_0+18h]
		lea	arg, [arg+0]

loc_62B95648:				; CODE XREF: _silc_client_command_call+24Cj
		mov	command, [eax+60h]
		test	ebx, ebx
		jz	loc_62B95764
		test	byte ptr [eax+68h], 2
		jz	loc_62B9576C
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B95664:				; CODE XREF: _silc_client_command_call+353j
		mov	[eax+60h], edx
		mov	edx, [ebx+10h]
command	= ebx				; SilcClientCommand
		test	edx, edx
		jz	short loc_62B95648
		mov	[esp+4], arg	; char *
		mov	[esp], edx	; char *
		call	_stricmp
		test	eax, eax
		jnz	short loc_62B95642
		mov	eax, [ebp+argc]
		mov	edx, [ebp+argv]
		mov	[ebp+var_30], command
		jmp	loc_62B9570E
; ---------------------------------------------------------------------------

loc_62B9568C:				; CODE XREF: _silc_client_command_call+33Ej
		mov	ecx, [ebp+argv_lens]
		test	ecx, ecx
		jz	loc_62B95764
		test	eax, eax
		jz	loc_62B95764
		mov	[ebp+argv_types], eax
		mov	eax, [ebp+argc]
		lea	command, [edx+eax*4]
		mov	ecx, 0FFFFFFFFh
		mov	client_0, arg
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+4], ecx
		mov	[esp], esi
arg = esi				; char *
		call	_silc_memdup
		mov	[ebx], eax
		mov	edx, [ebp+argv]
		mov	ebx, [ebp+argc]
		shl	ebx, 2
		mov	edi, [edx+ebx]
		test	edi, edi
		jz	loc_62B95764
		mov	ecx, 0FFFFFFFFh
		mov	edi, arg
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	eax, [ebp+argv_lens]
		mov	[eax+ebx], ecx
		mov	eax, [ebp+argc]
		mov	ecx, [ebp+argv_types]
		mov	[ecx+eax*4], eax
		mov	eax, [ebp+argc]
		inc	eax
		mov	[ebp+argc], eax
		add	[ebp+va], 4
		mov	ecx, [ebp+va]
		mov	arg, [ecx-4]
		test	arg, arg
		jz	loc_62B957A7

loc_62B9570E:				; CODE XREF: _silc_client_command_call+267j
command	= ebx				; SilcClientCommand
		lea	eax, ds:4[eax*4]
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_realloc
		mov	[ebp+argv], eax
		mov	eax, [ebp+argc]
		lea	eax, ds:4[eax*4]
		mov	[esp+4], eax
		mov	eax, [ebp+argv_lens]
		mov	[esp], eax
		call	_silc_realloc
		mov	[ebp+argv_lens], eax
		mov	eax, [ebp+argc]
		lea	eax, ds:4[eax*4]
		mov	[esp+4], eax
		mov	eax, [ebp+argv_types]
		mov	[esp], eax
		call	_silc_realloc
		mov	edx, [ebp+argv]
		test	edx, edx
		jnz	loc_62B9568C

loc_62B95764:				; CODE XREF: _silc_client_command_call+64j
					; _silc_client_command_call+101j ...
command_name = esi			; char *
cmd = eax				; SilcClientCommandContext
		xor	command_name, command_name
cmd_ident = esi				; SilcUInt16
command_name = eax			; char *
		jmp	loc_62B9561A
; ---------------------------------------------------------------------------
client_0 = edi				; SilcClient
arg = esi				; char *
		align 4

loc_62B9576C:				; CODE XREF: _silc_client_command_call+237j
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B95664
; ---------------------------------------------------------------------------

loc_62B95778:				; CODE XREF: _silc_client_command_call+2Dj
		mov	eax, [client_0+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aYouAreNotConne ; "You are not connected to	a server, plea"...
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], 0
		mov	[esp], client_0
		call	dword ptr [eax]
		xor	esi, esi
cmd_ident = esi				; SilcUInt16
		mov	eax, cmd_ident
		add	esp, 4Ch
		pop	ebx
		pop	cmd_ident
		pop	client_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B957A7:				; CODE XREF: _silc_client_command_call+2E8j
arg = esi				; char *
		mov	ebx, [ebp+var_30]
command	= ebx				; SilcClientCommand
		jmp	loc_62B95509
_silc_client_command_call endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  22. silc_client_command

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command(SilcFSMObject	*fsm, void *fsm_context, void *state_context)
		public _silc_client_command
_silc_client_command proc near		; DATA XREF: _silc_client_connection_st_packet:loc_62B81F28o

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
args		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

command	= eax				; SilcCommand
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	esi, [ebp+fsm_context]
		mov	command, [ebp+state_context]
		mov	edi, [esi+4Ch]
client = edi				; SilcClient
		mov	edx, [command+0Ch]
		mov	command, [command+10h]
		sub	command, edx
		mov	[esp+4], command
		mov	[esp], edx
		call	_silc_command_payload_parse
		mov	ebx, command
payload	= ebx				; SilcCommandPayload
		test	command, command
		jz	short loc_62B957FB
fsm_context_0 =	esi			; void *
		mov	[esp], command
		call	_silc_command_get_args
payload	= ebx				; SilcCommandPayload
		mov	[ebp+args], command
		mov	[esp], payload
		call	_silc_command_get
		dec	al
		jz	short loc_62B95808

loc_62B957F3:				; CODE XREF: _silc_client_command+5Fj
					; _silc_client_command+7Dj ...
		mov	[esp], payload
		call	_silc_command_payload_free

loc_62B957FB:				; CODE XREF: _silc_client_command+2Aj
		mov	command, 3
		add	esp, 4Ch
		pop	payload
		pop	fsm_context_0
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B95808:				; CODE XREF: _silc_client_command+41j
fsm_context_0 =	esi			; void *
client = edi				; SilcClient
payload	= ebx				; SilcCommandPayload
		mov	command, [fsm_context_0+54h]
		cmp	byte ptr [command+38h],	0
		jnz	short loc_62B957F3
		lea	command, [ebp+var_1C]
		mov	[esp+8], command
		mov	dword ptr [esp+4], 3
		mov	command, [ebp+args]
		mov	[esp], command
		call	_silc_argument_get_arg_type
		test	command, command
		jz	short loc_62B957F3
		mov	edx, [ebp+var_1C]
		mov	[esp+4], edx
		mov	[esp], command
		call	_silc_attribute_payload_parse
		test	command, command
		jz	short loc_62B957F3
		mov	[esp+8], command ; attrs
		mov	[esp+4], fsm_context_0 ; conn
		mov	[esp], client	; client
		mov	[ebp+var_30], command
		call	_silc_client_attributes_process
		mov	client,	command
		test	command, command
		mov	edx, [ebp+var_30]
		jz	loc_62B9591C
		mov	ecx, [command+4]
		mov	edx, [command+8]
		sub	edx, ecx
		mov	[esp], payload
		mov	[ebp+var_30], edx
		mov	[ebp+var_34], ecx
		call	_silc_command_get_ident
		mov	edx, [ebp+var_30]
		mov	[esp+1Ch], edx
		mov	ecx, [ebp+var_34]
		mov	[esp+18h], ecx
		mov	dword ptr [esp+14h], 0Bh
		mov	dword ptr [esp+10h], 1
		movzx	command, ax
		mov	[esp+0Ch], command
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 1
		call	_silc_command_reply_payload_encode_va
		mov	edx, command
		test	command, command
		jz	short loc_62B95929
		mov	ecx, [command+4]
		mov	command, [command+8]
		sub	command, ecx
		mov	[esp+10h], command
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0Ch
		mov	command, [fsm_context_0+3Ch]
		mov	[esp], command
		mov	[ebp+var_30], edx
		call	_silc_packet_send
		mov	edx, [ebp+var_30]
		mov	command, [edx]
		mov	[esp], command
		call	_silc_free
		mov	edx, [ebp+var_30]
		mov	[esp], edx
		call	_silc_free
		mov	command, [edi]
		mov	[esp], command
		call	_silc_free
		mov	[esp], edi
		call	_silc_free
		jmp	loc_62B957F3
; ---------------------------------------------------------------------------

loc_62B9591C:				; CODE XREF: _silc_client_command+ACj
		mov	[esp], edx
		call	_silc_attribute_payload_list_free
		jmp	loc_62B957F3
; ---------------------------------------------------------------------------

loc_62B95929:				; CODE XREF: _silc_client_command+10Dj
		mov	command, edi	; sb
		call	_silc_buffer_free_0
		jmp	loc_62B957F3
_silc_client_command endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  82. silc_client_command_send_argv

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 __cdecl silc_client_command_send_argv(SilcClient client, SilcClientConnection conn, SilcCommand command, SilcClientCommandReply reply, void *reply_context, SilcUInt32 argc, unsigned __int8 **argv, SilcUInt32 *argv_lens, SilcUInt32 *argv_types)
		public _silc_client_command_send_argv
_silc_client_command_send_argv proc near ; CODE	XREF: _silc_client_get_clients_by_list+372p
					; _silc_client_st_resume_resolve_channels+313p

var_19		= byte ptr -19h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= dword	ptr  10h
reply		= dword	ptr  14h
reply_context	= dword	ptr  18h
argc		= dword	ptr  1Ch
argv		= dword	ptr  20h
argv_lens	= dword	ptr  24h
argv_types	= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+conn]
		mov	edi, [ebp+command]
		mov	edx, edi
		mov	[ebp+var_19], dl
		test	esi, esi
		jz	loc_62B95AE4
conn_0 = esi				; SilcClientConnection
command_0 = edi				; SilcCommand
		mov	eax, [ebp+reply]
		test	eax, eax
		jz	loc_62B95AE4
		mov	dword ptr [esp+4], 68h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	ebx, eax
cmd = ebx				; SilcClientCommandContext
		test	eax, eax
		jz	loc_62B95AE4
cmd = eax				; SilcClientCommandContext
		mov	[cmd+4], conn_0
		mov	cmd, command_0
cmd = ebx				; SilcClientCommandContext
		mov	[cmd+34h], al
		mov	eax, [conn_0+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B95ACA
		mov	cx, [cmd+36h]
		test	cx, cx
		jnz	short loc_62B959D3
		mov	cx, [eax+124h]
		mov	dx, [eax+124h]
		inc	edx
		mov	[eax+124h], dx
		inc	cx
		jnz	short loc_62B959CF
		mov	cx, [eax+124h]
		mov	dx, [eax+124h]
		inc	edx
		mov	[eax+124h], dx
		inc	ecx

loc_62B959CF:				; CODE XREF: _silc_client_command_send_argv+7Ej
		mov	[cmd+36h], cx

loc_62B959D3:				; CODE XREF: _silc_client_command_send_argv+64j
		movzx	ecx, cx
		mov	[esp+14h], ecx
		mov	eax, [ebp+argv_types]
		mov	[esp+10h], eax
		mov	eax, [ebp+argv_lens]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+argv]
		mov	[esp+8], eax
		mov	eax, [ebp+argc]
		mov	[esp+4], eax
		movzx	eax, [ebp+var_19]
command_0 = eax				; SilcCommand
		mov	[esp], command_0
		call	_silc_command_payload_encode
		mov	edi, eax
		test	eax, eax
		jz	loc_62B95ACA
		mov	edx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, edx
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0Bh
		mov	eax, [conn_0+3Ch]
		mov	[esp], eax
		call	_silc_packet_send
		test	al, al
		jz	short loc_62B95AB8
		mov	eax, [ebp+reply_context]
		mov	[esp], eax	; context
		mov	ecx, [ebp+reply] ; reply
		mov	edx, cmd	; cmd
		mov	eax, conn_0	; conn
		call	_silc_client_command_add_pending
		mov	eax, [edi]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], edi
		call	_silc_free
		mov	ax, [cmd+36h]
		test	ax, ax
		jz	short loc_62B95AD0
		lea	edi, [cmd+8]
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], offset _silc_client_command_destructor
		mov	[esp+8], cmd
		mov	eax, [conn_0+54h]
		add	eax, 40h
		mov	[esp+4], eax
		mov	[esp], edi
		call	_silc_fsm_thread_init
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	[esp], edi
		call	_silc_fsm_start_sync
		mov	ax, [cmd+36h]
		add	esp, 3Ch
		pop	cmd
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = esi				; SilcClientConnection
cmd = ebx				; SilcClientCommandContext
		align 4

loc_62B95AB8:				; CODE XREF: _silc_client_command_send_argv+101j
		mov	eax, [edi]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], edi
		call	_silc_free

loc_62B95ACA:				; CODE XREF: _silc_client_command_send_argv+57j
					; _silc_client_command_send_argv+CEj
		mov	word ptr [cmd+36h], 0

loc_62B95AD0:				; CODE XREF: _silc_client_command_send_argv+12Ej
		mov	[esp], cmd	; cmd
		call	_silc_client_command_free
		xor	eax, eax
		add	esp, 3Ch
		pop	cmd
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = esi				; SilcClientConnection
command_0 = edi				; SilcCommand
cmd = eax				; SilcClientCommandContext
		align 4

loc_62B95AE4:				; CODE XREF: _silc_client_command_send_argv+16j
					; _silc_client_command_send_argv+21j ...
		xor	cmd, cmd
cmd = ebx				; SilcClientCommandContext
		add	esp, 3Ch
		pop	cmd
		pop	conn_0
		pop	command_0
		leave
		retn
_silc_client_command_send_argv endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcUInt16 __usercall	silc_client_command_send_vap@<ax>(SilcClient client@<eax>, SilcClientConnection	conn@<edx>, SilcClientCommandContext cmd@<ecx>,	SilcCommand command, SilcClientCommandReply reply, void	*reply_context,	SilcUInt32 argc, va_list ap)
_silc_client_command_send_vap proc near	; CODE XREF: _silc_client_command_send_va+32p
					; _silc_client_command_send+A8p

command		= byte ptr  8
reply		= dword	ptr  0Ch
reply_context	= dword	ptr  10h
argc		= dword	ptr  14h
ap		= dword	ptr  18h

client = eax				; SilcClient
conn = edx				; SilcClientConnection
cmd = ecx				; SilcClientCommandContext
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	esi, conn
		mov	edi, cmd
		mov	cl, [ebp+command]
cmd = edi				; SilcClientCommandContext
		mov	client,	[conn+54h]
		test	byte ptr [eax+12Dh], 2
		jnz	loc_62B95BE4
command_0 = ecx				; SilcCommand
		mov	dx, [cmd+36h]
conn = esi				; SilcClientConnection
		test	dx, dx
		jz	loc_62B95BA8

loc_62B95B1D:				; CODE XREF: _silc_client_command_send_vap+EDj
		mov	eax, [ebp+ap]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+argc]
		mov	[esp+8], eax
		movzx	edx, dx
		mov	[esp+4], edx
		movzx	command_0, cl
		mov	[esp], command_0
		call	_silc_command_payload_encode_vap
		mov	ebx, eax
packet = ebx				; SilcBuffer
		test	eax, eax
		jz	loc_62B95BE4
packet = eax				; SilcBuffer
		mov	edx, [packet+4]
		mov	packet,	[packet+8]
packet = ebx				; SilcBuffer
		sub	eax, edx
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0Bh
		mov	eax, [conn+3Ch]
		mov	[esp], eax
		call	_silc_packet_send
		test	al, al
		jz	short loc_62B95BF0
		mov	eax, [ebp+reply_context]
		mov	[esp], eax	; context
		mov	ecx, [ebp+reply] ; reply
		mov	edx, cmd	; cmd
		mov	eax, conn	; conn
		call	_silc_client_command_add_pending
		mov	eax, [packet]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], packet
		call	_silc_free
		mov	ax, [cmd+36h]
		add	esp, 2Ch
		pop	packet
		pop	conn
		pop	cmd
		leave
		retn
; ---------------------------------------------------------------------------
conn = esi				; SilcClientConnection
cmd = edi				; SilcClientCommandContext
command_0 = ecx				; SilcCommand
		align 4

loc_62B95BA8:				; CODE XREF: _silc_client_command_send_vap+27j
		mov	dx, [eax+124h]
		mov	bx, [eax+124h]
		inc	ebx
		mov	[eax+124h], bx
		inc	dx
		jnz	short loc_62B95BD9
		mov	dx, [eax+124h]
		mov	bx, [eax+124h]
		inc	ebx
		mov	[eax+124h], bx
		inc	edx

loc_62B95BD9:				; CODE XREF: _silc_client_command_send_vap+D0j
		mov	[cmd+36h], dx
		jmp	loc_62B95B1D
; ---------------------------------------------------------------------------
packet = eax				; SilcBuffer
		align 4

loc_62B95BE4:				; CODE XREF: _silc_client_command_send_vap+1Aj
					; _silc_client_command_send_vap+51j
		xor	packet,	packet
packet = ebx				; SilcBuffer
		add	esp, 2Ch
		pop	packet
		pop	conn
conn = edx				; SilcClientConnection
		pop	cmd
		leave
		retn
; ---------------------------------------------------------------------------
conn = esi				; SilcClientConnection
cmd = edi				; SilcClientCommandContext
packet = ebx				; SilcBuffer
		align 10h

loc_62B95BF0:				; CODE XREF: _silc_client_command_send_vap+84j
		mov	eax, [packet]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], packet
		call	_silc_free
		xor	eax, eax
		add	esp, 2Ch
		pop	packet
		pop	conn
		pop	cmd
		leave
		retn
_silc_client_command_send_vap endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; SilcUInt16 silc_client_command_send_va(SilcClientConnection conn, SilcClientCommandContext cmd, SilcCommand command, SilcClientCommandReply reply, void *reply_context, SilcUInt32 argc, ...)
_silc_client_command_send_va proc near	; CODE XREF: _silc_client_command_detach+35p
					; _silc_client_command_umode+15Fp ...

conn		= dword	ptr  8
cmd		= dword	ptr  0Ch
command		= byte ptr  10h
reply		= dword	ptr  14h
reply_context	= dword	ptr  18h
argc		= dword	ptr  1Ch
ap		= byte ptr  20h

cmd_ident = eax				; SilcUInt16
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	edx, [ebp+conn]	; conn
		lea	ecx, [ebp+ap]
		mov	cmd_ident, [edx+4Ch] ; client
		mov	[esp+10h], ecx	; ap
		mov	ecx, [ebp+argc]
		mov	[esp+0Ch], ecx	; argc
		mov	ecx, [ebp+reply_context]
		mov	[esp+8], ecx	; reply_context
		mov	ecx, [ebp+reply]
		mov	[esp+4], ecx	; reply
		movzx	ecx, [ebp+command]
command_0 = ecx				; SilcCommand
		mov	[esp], command_0 ; command
		mov	command_0, [ebp+cmd] ; cmd
		call	_silc_client_command_send_vap
		leave
		retn
_silc_client_command_send_va endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  29. silc_client_command_detach

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_detach(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_command_detach
_silc_client_command_detach proc near	; DATA XREF: _silc_client_commands_unregister+E05o
					; _silc_client_commands_register+9ABo

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	ebx, [ebp+fsm_context]
		mov	dword ptr [esp+14h], 0 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [ebx+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], ebx	; cmd
		mov	eax, [ebx+4]
		mov	[esp], eax	; conn
		call	_silc_client_command_send_va
		mov	edx, [ebx+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [ebx+3Ch]
		mov	[esp+18h], esi
		mov	esi, [ebx+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	ebx, byte ptr [ebx+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 20h
		pop	ebx
		pop	esi
		leave
		retn
_silc_client_command_detach endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  87. silc_client_command_umode

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_umode(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_umode
_silc_client_command_umode proc	near	; DATA XREF: _silc_client_commands_unregister+A95o
					; _silc_client_commands_register+744o

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
conn		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
modebuf		= byte ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	esi, [ebp+fsm_context]
		mov	eax, [esi+4]
		mov	[ebp+conn], eax
		mov	edx, [esi+38h]
		mov	[ebp+var_34], edx
		cmp	edx, 1
		jbe	loc_62B95FC0
fsm_context_0 =	esi			; void *
		mov	edx, [ebp+conn]
		mov	eax, [edx]
		mov	ebx, [eax+3ACh]
mode = ebx				; SilcUInt32
		mov	ecx, [fsm_context_0+3Ch]
		mov	[ebp+var_38], ecx
		mov	edx, [ecx+4]
		xor	eax, eax
		cmp	byte ptr [edx],	2Dh
		setnz	al
		mov	[ebp+var_2C], eax
		inc	edx
cp = edx				; unsigned __int8 *
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, cp
		repne scasb
		not	ecx
		mov	edi, ecx
len = edi				; SilcUInt32
		dec	len
		jz	loc_62B95DB3
		xor	ecx, ecx
		xor	eax, eax
cp = edx				; unsigned __int8 *
i = eax					; int
		nop

loc_62B95D38:				; CODE XREF: _silc_client_command_umode+D5j
		mov	cl, [cp+ecx]
		sub	ecx, 49h
		cmp	cl, 2Eh		; switch 47 cases
		jbe	short loc_62B95D90

loc_62B95D43:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	cp, [ebp+conn]	; jumptable 62B95D93 default case
		mov	i, [edx+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	ecx, [ebp+var_38]
		mov	[esp+18h], ecx
		mov	ecx, [ebp+var_34]
		mov	[esp+14h], ecx
		mov	dword ptr [esp+10h], 25h
		movzx	ecx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx
		mov	[esp], eax
		call	dword ptr [edx+10h]
		mov	eax, 3
		add	esp, 5Ch
		pop	mode
		pop	fsm_context_0
		pop	len
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
cp = edx				; unsigned __int8 *
mode = ebx				; SilcUInt32
len = edi				; SilcUInt32
i = eax					; int
		align 10h

loc_62B95D90:				; CODE XREF: _silc_client_command_umode+65j
		movzx	ecx, cl
		jmp	ds:off_62BA89F4[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 4

loc_62B95D9C:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 46
		test	ecx, ecx
		jz	loc_62B95F88
		or	bh, 8
		xchg	ax, ax

loc_62B95DAC:				; CODE XREF: _silc_client_command_umode+1CEj
					; _silc_client_command_umode+1E2j ...
		inc	i
		mov	ecx, i
		cmp	len, i
		ja	short loc_62B95D38

loc_62B95DB3:				; CODE XREF: _silc_client_command_umode+51j
		mov	i, mode
		shr	eax, 18h
		mov	[ebp+modebuf], al
		mov	eax, mode
		shr	eax, 10h
		mov	[ebp+modebuf+1], al
		mov	eax, mode
		shr	eax, 8
		mov	[ebp+modebuf+2], al
		mov	[ebp+modebuf+3], bl
		mov	cp, [ebp+conn]
		mov	eax, [edx+54h]
		mov	eax, [eax+0F4h]
		test	eax, eax
		jz	loc_62B9602D
		mov	edx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, edx

loc_62B95DEA:				; CODE XREF: _silc_client_command_umode+353j
		mov	dword ptr [esp+2Ch], 4
		lea	ecx, [ebp+modebuf]
		mov	[esp+28h], ecx
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	ecx, [ebp+conn]
		mov	[esp], ecx	; conn
		call	_silc_client_command_send_va
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	mode, [fsm_context_0+3Ch]
		mov	[esp+18h], ebx
		mov	ebx, [fsm_context_0+38h]
		mov	[esp+14h], ebx
		mov	dword ptr [esp+10h], 0
		movzx	ebx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 5Ch
		pop	ebx
		pop	fsm_context_0
		pop	len
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
cp = edx				; unsigned __int8 *
mode = ebx				; SilcUInt32
len = edi				; SilcUInt32
i = eax					; int
		align 4

loc_62B95E9C:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 43
		test	ecx, ecx
		jz	loc_62B95F68
		or	bl, 80h
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 10h

loc_62B95EB0:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 42
		test	ecx, ecx
		jz	loc_62B95F78
		or	mode, 1
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 4

loc_62B95EC4:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 39
		test	ecx, ecx
		jz	loc_62B95F70
		or	mode, 20h
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 4

loc_62B95ED8:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 41
		test	ecx, ecx
		jz	loc_62B95F80
		or	mode, 2
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 4

loc_62B95EEC:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 32
		test	ecx, ecx
		jz	loc_62B95FA0
		or	mode, 8
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 10h

loc_62B95F00:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 31
		test	ecx, ecx
		jz	loc_62B95F90
		or	mode, 40h
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 4

loc_62B95F14:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 7
		test	ecx, ecx
		jz	loc_62B95FB0
		or	bh, 2
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 4

loc_62B95F28:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 25
		test	ecx, ecx
		jz	short loc_62B95F98
		or	mode, 10h
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 4

loc_62B95F38:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 0
		test	ecx, ecx
		jz	short loc_62B95FA8
		or	bh, 10h
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 4

loc_62B95F48:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	ecx, [ebp+var_2C] ; jumptable 62B95D93 case 30
		test	ecx, ecx
		jz	short loc_62B95FB8
		or	mode, 4
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------
		align 4

loc_62B95F58:				; CODE XREF: _silc_client_command_umode+B7j
					; DATA XREF: .rdata:off_62BA89F4o
		mov	mode, [ebp+var_2C] ; jumptable 62B95D93	case 24
		neg	mode
		and	mode, 0AFFh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95F68:				; CODE XREF: _silc_client_command_umode+1C5j
		and	bl, 7Fh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95F70:				; CODE XREF: _silc_client_command_umode+1EDj
		and	mode, 0FFFFFFDFh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95F78:				; CODE XREF: _silc_client_command_umode+1D9j
		and	mode, 0FFFFFFFEh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95F80:				; CODE XREF: _silc_client_command_umode+201j
		and	mode, 0FFFFFFFDh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95F88:				; CODE XREF: _silc_client_command_umode+C5j
		and	bh, 0F7h
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95F90:				; CODE XREF: _silc_client_command_umode+229j
		and	mode, 0FFFFFFBFh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95F98:				; CODE XREF: _silc_client_command_umode+251j
		and	mode, 0FFFFFFEFh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95FA0:				; CODE XREF: _silc_client_command_umode+215j
		and	mode, 0FFFFFFF7h
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95FA8:				; CODE XREF: _silc_client_command_umode+261j
		and	bh, 0EFh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95FB0:				; CODE XREF: _silc_client_command_umode+23Dj
		and	bh, 0FDh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95FB8:				; CODE XREF: _silc_client_command_umode+271j
		and	mode, 0FFFFFFFBh
		jmp	loc_62B95DAC
; ---------------------------------------------------------------------------

loc_62B95FC0:				; CODE XREF: _silc_client_command_umode+1Bj
		mov	ecx, eax
		mov	eax, [eax+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	dword ptr [esp+0Ch], offset aUsageUmodeMode ; "Usage: /UMODE +|-<modes>"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ecx
		mov	[esp], eax
		call	dword ptr [edx]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	ebx, [fsm_context_0+3Ch]
		mov	[esp+18h], ebx
		mov	ebx, [fsm_context_0+38h]
		mov	[esp+14h], ebx
		mov	dword ptr [esp+10h], 1Dh
		movzx	ebx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3
		add	esp, 5Ch
		pop	ebx
		pop	fsm_context_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9602D:				; CODE XREF: _silc_client_command_umode+100j
fsm_context_0 =	esi			; void *
mode = ebx				; SilcUInt32
len = edi				; SilcUInt32
		xor	edx, edx
		jmp	loc_62B95DEA
_silc_client_command_umode endp

; Exported entry  40. silc_client_command_motd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_motd(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_motd
_silc_client_command_motd proc near	; DATA XREF: _silc_client_commands_unregister+9E5o
					; _silc_client_commands_register+6C9o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+fsm_context]
		mov	edx, [ebx+4]
conn = edx				; SilcClientConnection
		mov	eax, [ebx+38h]
		lea	ecx, [eax-1]
		cmp	ecx, 1
		jbe	short loc_62B960C0
fsm_context_0 =	ebx			; void *
		mov	eax, [conn+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	dword ptr [esp+0Ch], offset aUsageMotdServe ; "Usage: /MOTD [<server>]"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], eax
		call	dword ptr [ecx]
		mov	ecx, [fsm_context_0+4]
		mov	edx, [ecx+4Ch]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	edi, [eax+10h]
		cmp	dword ptr [fsm_context_0+38h], 1
		sbb	eax, eax
		add	eax, 1Eh
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	[esp+10h], eax
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ecx
		mov	[esp], edx
		call	edi
		mov	eax, 3
		add	esp, 3Ch
		pop	fsm_context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B960C0:				; CODE XREF: _silc_client_command_motd+18j
fsm_context_0 =	ebx			; void *
conn = edx				; SilcClientConnection
		dec	eax
		jz	loc_62B96168
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+4]
		mov	[esp+20h], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+1Ch], eax

loc_62B960DB:				; CODE XREF: _silc_client_command_motd+14Dj
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B96168:				; CODE XREF: _silc_client_command_motd+8Dj
fsm_context_0 =	ebx			; void *
conn = edx				; SilcClientConnection
		mov	esi, [conn+8]
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, esi
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+20h], ecx
		mov	[esp+1Ch], esi
		jmp	loc_62B960DB
_silc_client_command_motd endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  85. silc_client_command_stats

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_stats(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_stats
_silc_client_command_stats proc	near	; DATA XREF: _silc_client_commands_unregister+725o
					; _silc_client_commands_register+4DDo

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	ebx, [ebp+fsm_context]
		mov	edx, [ebx+4]
conn = edx				; SilcClientConnection
		mov	eax, [conn+54h]
		mov	eax, [eax+0F8h]
		test	eax, eax
		jz	loc_62B96244
fsm_context_0 =	ebx			; void *
		mov	ecx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, ecx

loc_62B961AF:				; CODE XREF: _silc_client_command_stats+BEj
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 30h
		pop	ebx
		pop	esi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = edx				; SilcClientConnection
		align 4

loc_62B96244:				; CODE XREF: _silc_client_command_stats+19j
		xor	ecx, ecx
		jmp	loc_62B961AF
_silc_client_command_stats endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  33. silc_client_command_info

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_info(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_info
_silc_client_command_info proc near	; DATA XREF: _silc_client_commands_unregister+675o
					; _silc_client_commands_register+462o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4]
conn = eax				; SilcClientConnection
		cmp	dword ptr [ebx+38h], 2
		jz	loc_62B962E8
fsm_context_0 =	ebx			; void *
		mov	dword ptr [esp+14h], 0 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	edx, byte ptr [fsm_context_0+34h]
		mov	[esp+8], edx	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va

loc_62B96290:				; CODE XREF: _silc_client_command_info+E4j
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 30h
		pop	ebx
		pop	esi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B962E8:				; CODE XREF: _silc_client_command_info+12j
fsm_context_0 =	ebx			; void *
conn = eax				; SilcClientConnection
		mov	edx, [fsm_context_0+40h]
		mov	edx, [edx+4]
		mov	[esp+20h], edx
		mov	edx, [fsm_context_0+3Ch]
		mov	edx, [edx+4]
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	edx, byte ptr [fsm_context_0+34h]
		mov	[esp+8], edx	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		jmp	loc_62B96290
_silc_client_command_info endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  88. silc_client_command_users

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_users(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_users
_silc_client_command_users proc	near	; DATA XREF: _silc_client_commands_unregister+10C5o
					; _silc_client_commands_register+AE3o

tmp		= byte ptr -218h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 23Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		cmp	dword ptr [ebx+38h], 2
		jz	short loc_62B963C0
fsm_context_0 =	ebx			; void *
		mov	eax, [conn+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	dword ptr [esp+0Ch], offset aUsageUsersChan ; "Usage: /USERS <channel>"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], eax
		call	dword ptr [edx]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3

loc_62B963B3:				; CODE XREF: _silc_client_command_users+20Cj
conn = esi				; SilcClientConnection
		add	esp, 23Ch
		pop	ebx
		pop	conn
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 10h

loc_62B963C0:				; CODE XREF: _silc_client_command_users+16j
		mov	eax, [fsm_context_0+3Ch]
		mov	edx, [eax+4]
		cmp	byte ptr [edx],	2Ah
		jz	loc_62B96478

loc_62B963CF:				; CODE XREF: _silc_client_command_users+196j
					; _silc_client_command_users+1CAj
name = edx				; char *
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, name
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+20h], ecx
		mov	[esp+1Ch], edx
name = edx				; char *
		mov	dword ptr [esp+18h], 2
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 23Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B96478:				; CODE XREF: _silc_client_command_users+91j
		mov	edx, [conn+30h]
		test	edx, edx
		jz	loc_62B96508
		mov	eax, [conn+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+23h], 0
		jnz	short loc_62B964DC
		cmp	byte ptr [edx+4], 0
		jnz	short loc_62B964D4
		mov	ecx, offset byte_62BA8AE3

loc_62B9649D:				; CODE XREF: _silc_client_command_users+1A1j
		lea	eax, [edx+4]
		mov	[esp+14h], eax
		mov	[esp+10h], ecx
		mov	eax, [edx]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aSSS ; "%s%s%s"
		mov	dword ptr [esp+4], 200h
		lea	edi, [ebp+tmp]
		mov	[esp], edi
		call	_silc_snprintf
		mov	edx, edi
name = edx				; char *
		jmp	loc_62B963CF
; ---------------------------------------------------------------------------
		align 4

loc_62B964D4:				; CODE XREF: _silc_client_command_users+15Ej
		mov	ecx, offset a@	; "@"
		jmp	short loc_62B9649D
; ---------------------------------------------------------------------------
		align 4

loc_62B964DC:				; CODE XREF: _silc_client_command_users+158j
		mov	eax, [edx]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aS ; "%s"
		mov	dword ptr [esp+4], 200h
		lea	edi, [ebp+tmp]
		mov	[esp], edi
		call	_silc_snprintf
		mov	edx, edi
name = edx				; char *
		jmp	loc_62B963CF
; ---------------------------------------------------------------------------
		align 4

loc_62B96508:				; CODE XREF: _silc_client_command_users+145j
		mov	edx, [conn+4Ch]
		mov	ecx, [edx+18h]
		mov	ecx, [ecx+48h]
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 2
		mov	dword ptr [esp+10h], 19h
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [ecx+10h]
		mov	eax, 3
		jmp	loc_62B963B3
_silc_client_command_users endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  38. silc_client_command_leave

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_leave(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_leave
_silc_client_command_leave proc	near	; DATA XREF: _silc_client_commands_unregister+1015o
					; _silc_client_commands_register+ABBo

var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
channel		= dword	ptr -21Ch
tmp		= byte ptr -218h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 24Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	edi, [conn+4Ch]
client = edi				; SilcClient
		cmp	dword ptr [ebx+38h], 2
		jz	short loc_62B965D4
fsm_context_0 =	ebx			; void *
		mov	eax, [client+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageLeaveChan ; "Usage: /LEAVE <channel>"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], client
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh

loc_62B965A8:				; CODE XREF: _silc_client_command_leave+266j
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3

loc_62B965C7:				; CODE XREF: _silc_client_command_leave+341j
conn = esi				; SilcClientConnection
		add	esp, 24Ch
		pop	ebx
		pop	conn
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
client = edi				; SilcClient
		align 4

loc_62B965D4:				; CODE XREF: _silc_client_command_leave+19j
		mov	eax, [fsm_context_0+3Ch]
		mov	edx, [eax+4]
		cmp	byte ptr [edx],	2Ah
		jz	loc_62B96720
		mov	eax, client

loc_62B965E5:				; CODE XREF: _silc_client_command_leave+23Cj
					; _silc_client_command_leave+303j
client = eax				; SilcClient ; channel
		mov	[esp+8], edx
name = edx				; char *
		mov	[esp+4], conn	; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel
client = edi				; SilcClient
		mov	[ebp+channel], eax
		test	eax, eax
		jz	loc_62B96790
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		call	_silc_id_payload_encode
		mov	edx, eax
idp = edx				; SilcBuffer
		test	eax, eax
		jz	loc_62B967B8
idp = eax				; SilcBuffer
		mov	ecx, [idp+4]
		mov	idp, [idp+8]
idp = edx				; SilcBuffer
		sub	eax, ecx
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+var_224], idp
		call	_silc_client_command_send_va
		mov	edx, [ebp+var_224]
		mov	eax, [edx]
idp = edx				; SilcBuffer
		mov	[esp], eax
		call	_silc_free
		mov	edx, [ebp+var_224]
		mov	[esp], edx
idp = edx				; SilcBuffer
		call	_silc_free

loc_62B96690:				; CODE XREF: _silc_client_command_leave+2B0j
		mov	ecx, [fsm_context_0+4]
		mov	eax, [ecx+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	[ebp+var_220], edx
		mov	edx, [fsm_context_0+3Ch]
		mov	[esp+18h], edx
		mov	edx, [fsm_context_0+38h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 0
		movzx	edx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], ecx
		mov	[esp], eax
		mov	eax, [ebp+var_220]
		call	dword ptr [eax+10h]
		mov	eax, [ebp+channel]
		cmp	eax, [conn+30h]
		jz	loc_62B96810

loc_62B966E7:				; CODE XREF: _silc_client_command_leave+2CBj
		mov	eax, [ebp+channel]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn	; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 24Ch
		pop	fsm_context_0
		pop	conn
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
client = edi				; SilcClient
		align 10h

loc_62B96720:				; CODE XREF: _silc_client_command_leave+91j
		mov	edx, [conn+30h]
		test	edx, edx
		jz	loc_62B96854
		mov	eax, [client+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+23h], 0
		jnz	loc_62B9681C
		cmp	byte ptr [edx+4], 0
		jnz	loc_62B96804
		mov	ecx, offset byte_62BA8AE3

loc_62B9674A:				; CODE XREF: _silc_client_command_leave+2BDj
		lea	eax, [edx+4]
		mov	[esp+14h], eax
		mov	[esp+10h], ecx
		mov	eax, [edx]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aSSS ; "%s%s%s"
		mov	dword ptr [esp+4], 200h
		lea	edx, [ebp+tmp]
		mov	[esp], edx
		mov	[ebp+var_224], edx
		call	_silc_snprintf
		mov	eax, [conn+4Ch]
client = eax				; SilcClient
		mov	edx, [ebp+var_224]
		jmp	loc_62B965E5
; ---------------------------------------------------------------------------
client = edi				; SilcClient
		align 10h

loc_62B96790:				; CODE XREF: _silc_client_command_leave+B1j
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 19h
		jmp	loc_62B965A8
; ---------------------------------------------------------------------------
conn = esi				; SilcClientConnection
idp = eax				; SilcBuffer
		align 4

loc_62B967B8:				; CODE XREF: _silc_client_command_leave+D6j
		mov	dword ptr [esp+20h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	idp, byte ptr [fsm_context_0+34h]
idp = edx				; SilcBuffer
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		jmp	loc_62B96690
; ---------------------------------------------------------------------------
		align 4

loc_62B96804:				; CODE XREF: _silc_client_command_leave+1F3j
		mov	ecx, offset a@	; "@"
		jmp	loc_62B9674A
; ---------------------------------------------------------------------------
		align 10h

loc_62B96810:				; CODE XREF: _silc_client_command_leave+195j
		mov	dword ptr [conn+30h], 0
		jmp	loc_62B966E7
; ---------------------------------------------------------------------------

loc_62B9681C:				; CODE XREF: _silc_client_command_leave+1E9j
		mov	eax, [edx]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aS ; "%s"
		mov	dword ptr [esp+4], 200h
		lea	edx, [ebp+tmp]
		mov	[esp], edx
		mov	[ebp+var_224], edx
		call	_silc_snprintf
		mov	eax, [conn+4Ch]
client = eax				; SilcClient
		mov	edx, [ebp+var_224]
		jmp	loc_62B965E5
; ---------------------------------------------------------------------------

loc_62B96854:				; CODE XREF: _silc_client_command_leave+1D9j
client = edi				; SilcClient
		mov	edx, [client+18h]
		mov	edx, [edx+48h]
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 2
		mov	dword ptr [esp+10h], 19h
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], client
		call	dword ptr [edx+10h]
		mov	eax, 3
		jmp	loc_62B965C7
_silc_client_command_leave endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  36. silc_client_command_kick

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_kick(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_kick
_silc_client_command_kick proc near	; DATA XREF: _silc_client_commands_unregister+CA5o
					; _silc_client_commands_register+8B5o

var_23C		= dword	ptr -23Ch
client_list	= dword	ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
idp		= dword	ptr -228h
idp2		= dword	ptr -224h
channel		= dword	ptr -220h
client		= dword	ptr -21Ch
tmp		= byte ptr -218h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 27Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	eax, [ebx+38h]
		cmp	eax, 2
		jbe	loc_62B96B8C
fsm_context_0 =	ebx			; void *
		mov	edx, [fsm_context_0+3Ch]
		mov	edi, [edx+4]
		cmp	byte ptr [edi],	2Ah
		jz	loc_62B96C24

loc_62B968CA:				; CODE XREF: _silc_client_command_kick+3EFj
					; _silc_client_command_kick+554j
		mov	eax, [conn+30h]
		test	eax, eax
		jz	loc_62B96C88
		mov	[esp+8], edi	; channel
name = edi				; char *
		mov	[esp+4], conn	; conn
		mov	eax, [conn+4Ch]
		mov	[esp], eax	; client
		call	_silc_client_get_channel
		mov	[ebp+channel], eax
		test	eax, eax
		jz	loc_62B96CBC
		mov	dword ptr [esp+0Ch], 0 ; return_all
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_clients_local
		mov	edx, eax
clients	= edx				; SilcDList
		test	eax, eax
		jz	loc_62B96E00
clients	= eax				; SilcDList
		mov	clients, [clients+14h]
clients	= edx				; SilcDList
		mov	[clients+18h], eax
		mov	ecx, [clients+8]
		test	ecx, ecx
		jz	loc_62B96DF0
		test	byte ptr [clients+10h],	2
		jnz	loc_62B96CB0
		movzx	eax, word ptr [clients+0Ch]
		mov	eax, [ecx+eax]

loc_62B96946:				; CODE XREF: _silc_client_command_kick+423j
		mov	[clients+8], eax
		mov	[clients+14h], ecx
		mov	name, [ecx]

loc_62B9694E:				; CODE XREF: _silc_client_command_kick+565j
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		mov	[ebp+client_list], clients
		call	_silc_id_payload_encode
		mov	[ebp+idp], eax
		mov	dword ptr [esp+4], 2
		lea	eax, [edi+38Ch]
		mov	[esp], eax
		call	_silc_id_payload_encode
		mov	[ebp+idp2], eax
		cmp	dword ptr [fsm_context_0+38h], 3
		mov	edx, [ebp+client_list]
		jz	loc_62B96D00
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_22C], eax
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_22C]
		repne scasb
		not	ecx
		dec	ecx
		mov	[ebp+var_234], ecx
		mov	edi, [ebp+idp2]
		test	edi, edi
		jz	loc_62B96E70
		mov	edi, [ebp+idp2]
		mov	edi, [edi+4]
		mov	[ebp+var_23C], edi
		mov	ecx, [ebp+idp2]
		mov	eax, [ecx+8]
		sub	eax, edi

loc_62B969ED:				; CODE XREF: _silc_client_command_kick+5E8j
		mov	ecx, [ebp+idp]
		test	ecx, ecx
		jz	loc_62B96E5C
		mov	edi, [ebp+idp]
		mov	edi, [edi+4]
		mov	[ebp+var_230], edi
		mov	edi, [ebp+idp]
		mov	ecx, [edi+8]
		sub	ecx, [ebp+var_230]

loc_62B96A19:				; CODE XREF: _silc_client_command_kick+5D4j
		mov	edi, [ebp+var_234]
		mov	[esp+38h], edi
		mov	edi, [ebp+var_22C]
		mov	[esp+34h], edi
		mov	dword ptr [esp+30h], 3
		mov	[esp+2Ch], eax
		mov	eax, [ebp+var_23C]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], ecx
		mov	ecx, [ebp+var_230]
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 3 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+client_list], edx
		call	_silc_client_command_send_va
		mov	edx, [ebp+client_list]

loc_62B96A99:				; CODE XREF: _silc_client_command_kick+51Ej
		mov	eax, [ebp+idp]
		test	eax, eax
		jz	short loc_62B96AC7
		mov	edi, [ebp+idp]
		mov	eax, [edi]
		mov	[esp], eax
		mov	[ebp+client_list], edx
		call	_silc_free
		mov	[esp], edi
		call	_silc_free
		mov	edx, [ebp+client_list]

loc_62B96AC7:				; CODE XREF: _silc_client_command_kick+20Dj
		mov	edi, [ebp+idp2]
		test	edi, edi
		jz	short loc_62B96AFB
		mov	ecx, [ebp+idp2]
		mov	eax, [ecx]
		mov	[esp], eax
		mov	[ebp+client_list], edx
		call	_silc_free
		mov	edi, [ebp+idp2]
		mov	[esp], edi
		call	_silc_free
		mov	edx, [ebp+client_list]

loc_62B96AFB:				; CODE XREF: _silc_client_command_kick+23Bj
		mov	[esp+8], edx	; client_list
clients	= edx				; SilcDList
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_list_free
		mov	edx, [ebp+channel]
		mov	[esp+8], edx	; channel_entry
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_channel
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 27Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B96B8C:				; CODE XREF: _silc_client_command_kick+21j
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageKickChann ; "Usage: /KICK <channel> <nickname> [<com"...
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	edi, [fsm_context_0+3Ch]
		mov	[esp+18h], edi
		mov	edi, [fsm_context_0+38h]
		mov	[esp+14h], edi
		mov	dword ptr [esp+10h], 1Dh

loc_62B96BD3:				; CODE XREF: _silc_client_command_kick+416j
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	[ebp+channel], 0

out:					; CODE XREF: _silc_client_command_kick+464j
					; _silc_client_command_kick+630j
		mov	edi, [ebp+channel]
		mov	[esp+8], edi	; channel_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	eax, 3
		add	esp, 27Ch
		pop	ebx
		pop	conn
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B96C24:				; CODE XREF: _silc_client_command_kick+30j
		mov	ecx, [conn+30h]
		test	ecx, ecx
		jz	loc_62B96E84
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+23h], 0
		jnz	loc_62B96DC4
		cmp	byte ptr [ecx+4], 0
		jnz	loc_62B96DB8
		mov	eax, offset byte_62BA8AE3

loc_62B96C54:				; CODE XREF: _silc_client_command_kick+529j
		lea	edx, [ecx+4]
		mov	[esp+14h], edx
		mov	[esp+10h], eax
		mov	eax, [ecx]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aSSS ; "%s%s%s"
		mov	dword ptr [esp+4], 200h
		lea	edi, [ebp+tmp]
		mov	[esp], edi
		call	_silc_snprintf
		jmp	loc_62B968CA
; ---------------------------------------------------------------------------

loc_62B96C88:				; CODE XREF: _silc_client_command_kick+3Bj
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	edi, [fsm_context_0+3Ch]
		mov	[esp+18h], edi
		mov	edi, [fsm_context_0+38h]
		mov	[esp+14h], edi
		mov	dword ptr [esp+10h], 19h
		jmp	loc_62B96BD3
; ---------------------------------------------------------------------------
clients	= edx				; SilcDList
name = edi				; char *
		align 10h

loc_62B96CB0:				; CODE XREF: _silc_client_command_kick+A5j
		movzx	eax, word ptr [clients+0Eh]
		mov	eax, [ecx+eax]
		jmp	loc_62B96946
; ---------------------------------------------------------------------------

loc_62B96CBC:				; CODE XREF: _silc_client_command_kick+5Cj
		mov	ecx, [fsm_context_0+4]
		mov	eax, [ecx+4Ch]
		mov	edx, [eax+18h]
		mov	name, [edx+48h]
		mov	edx, [fsm_context_0+3Ch]
		mov	[esp+18h], edx
		mov	edx, [fsm_context_0+38h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 19h

loc_62B96CDE:				; CODE XREF: _silc_client_command_kick+5C0j
		movzx	edx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ecx
		mov	[esp], eax
		call	dword ptr [edi+10h]
		jmp	out
; ---------------------------------------------------------------------------
		align 10h

loc_62B96D00:				; CODE XREF: _silc_client_command_kick+107j
		test	eax, eax
		jz	loc_62B96EE0
		mov	edi, [ebp+idp2]
		mov	edi, [edi+4]
		mov	[ebp+var_230], edi
		mov	ecx, [ebp+idp2]
		mov	eax, [ecx+8]
		sub	eax, edi

loc_62B96D22:				; CODE XREF: _silc_client_command_kick+656j
		mov	ecx, [ebp+idp]
		test	ecx, ecx
		jz	loc_62B96ECC
		mov	edi, [ebp+idp]
		mov	edi, [edi+4]
		mov	[ebp+var_22C], edi
		mov	edi, [ebp+idp]
		mov	ecx, [edi+8]
		sub	ecx, [ebp+var_22C]

loc_62B96D4E:				; CODE XREF: _silc_client_command_kick+644j
		mov	[esp+2Ch], eax
		mov	eax, [ebp+var_230]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], ecx
		mov	ecx, [ebp+var_22C]
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+client_list], edx
		call	_silc_client_command_send_va
		mov	edx, [ebp+client_list]
		jmp	loc_62B96A99
; ---------------------------------------------------------------------------
		align 4

loc_62B96DB8:				; CODE XREF: _silc_client_command_kick+3B5j
		mov	eax, offset a@	; "@"
		jmp	loc_62B96C54
; ---------------------------------------------------------------------------
		align 4

loc_62B96DC4:				; CODE XREF: _silc_client_command_kick+3ABj
		mov	eax, [ecx]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aS ; "%s"
		mov	dword ptr [esp+4], 200h
		lea	edi, [ebp+tmp]
		mov	[esp], edi
		call	_silc_snprintf
		jmp	loc_62B968CA
; ---------------------------------------------------------------------------
clients	= edx				; SilcDList
name = edi				; char *
		align 10h

loc_62B96DF0:				; CODE XREF: _silc_client_command_kick+9Bj
		mov	dword ptr [clients+14h], 0
		xor	name, name
		jmp	loc_62B9694E
; ---------------------------------------------------------------------------
clients	= eax				; SilcDList
name = edi				; char *
		align 10h

loc_62B96E00:				; CODE XREF: _silc_client_command_kick+8Aj
		mov	clients, [fsm_context_0+4]
clients	= edx				; SilcDList
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	clients, [fsm_context_0+3Ch]
		mov	edx, [edx+8]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], offset aNoSuchClientS ; "No such client: %s"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	edx, [conn+4Ch]
		mov	[esp], edx
		call	dword ptr [eax]
		mov	ecx, [fsm_context_0+4]
		mov	eax, [ecx+4Ch]
		mov	edx, [eax+18h]
		mov	name, [edx+48h]
		mov	edx, [fsm_context_0+3Ch]
		mov	[esp+18h], edx
		mov	edx, [fsm_context_0+38h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 0Ah
		jmp	loc_62B96CDE
; ---------------------------------------------------------------------------
		align 4

loc_62B96E5C:				; CODE XREF: _silc_client_command_kick+161j
		xor	ecx, ecx
		mov	[ebp+var_230], 0
		jmp	loc_62B96A19
; ---------------------------------------------------------------------------
		align 10h

loc_62B96E70:				; CODE XREF: _silc_client_command_kick+139j
		xor	eax, eax
		mov	[ebp+var_23C], 0
		jmp	loc_62B969ED
; ---------------------------------------------------------------------------
		align 4

loc_62B96E84:				; CODE XREF: _silc_client_command_kick+395j
		mov	edi, [ebp+client]
		mov	ecx, [edi+18h]
		mov	ecx, [ecx+48h]
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 19h
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edi
		call	dword ptr [ecx+10h]
		mov	[ebp+channel], 0
		jmp	out
; ---------------------------------------------------------------------------
		align 4

loc_62B96ECC:				; CODE XREF: _silc_client_command_kick+496j
		xor	ecx, ecx
		mov	[ebp+var_22C], 0
		jmp	loc_62B96D4E
; ---------------------------------------------------------------------------
		align 10h

loc_62B96EE0:				; CODE XREF: _silc_client_command_kick+46Ej
		mov	[ebp+var_230], 0
		jmp	loc_62B96D22
_silc_client_command_kick endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  39. silc_client_command_list

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_list(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_list
_silc_client_command_list proc near	; DATA XREF: _silc_client_commands_unregister+305o
					; _silc_client_commands_register+24Eo

channel_entry	= dword	ptr -20h
client		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		cmp	dword ptr [ebx+38h], 2
		jz	loc_62B96FB0

loc_62B96F0F:				; CODE XREF: _silc_client_command_list+DDj
fsm_context_0 =	ebx			; void *
channel	= eax				; SilcChannelEntry
		xor	edx, edx

loc_62B96F11:				; CODE XREF: _silc_client_command_list+103j
channel	= edx				; SilcChannelEntry ; argc
idp = eax				; SilcBuffer
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	idp, byte ptr [fsm_context_0+34h]
idp = edi				; SilcBuffer
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+channel_entry], channel
		call	_silc_client_command_send_va
		mov	edx, [ebp+channel_entry]
		nop

loc_62B96F44:				; CODE XREF: _silc_client_command_list+165j
		mov	[esp+8], edx	; channel_entry
channel	= edx				; SilcChannelEntry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	idp
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B96FB0:				; CODE XREF: _silc_client_command_list+19j
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+8], eax	; channel
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_channel
		mov	edx, eax
channel	= edx				; SilcChannelEntry
		test	eax, eax
		jz	loc_62B96F0F
channel	= eax				; SilcChannelEntry
		mov	dword ptr [esp+4], 3
		lea	channel, [channel+114h]
channel	= edx				; SilcChannelEntry
		mov	[esp], eax
		mov	[ebp+channel_entry], channel
		call	_silc_id_payload_encode
		mov	edi, eax
idp = edi				; SilcBuffer
		test	eax, eax
		mov	edx, [ebp+channel_entry]
		jz	loc_62B96F11
idp = eax				; SilcBuffer
		mov	ecx, [idp+4]
		mov	idp, [idp+8]
idp = edi				; SilcBuffer
		sub	eax, ecx
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+channel_entry], edx
		call	_silc_client_command_send_va
		mov	eax, [idp]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], idp
		call	_silc_free
		mov	edx, [ebp+channel_entry]
		jmp	loc_62B96F44
_silc_client_command_list endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  23. silc_client_command_ban

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_ban(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_ban
_silc_client_command_ban proc near	; DATA XREF: _silc_client_commands_unregister+D55o
					; _silc_client_commands_register+930o

var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
client		= dword	ptr -30h
channel		= dword	ptr -2Ch
pubkey		= dword	ptr -20h
action		= byte ptr -19h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 8Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[ebp+pubkey], 0
		mov	eax, [ebx+38h]
		cmp	eax, 1
		jbe	loc_62B973A0
fsm_context_0 =	ebx			; void *
		mov	edx, [fsm_context_0+3Ch]
		mov	ecx, [edx+4]
		cmp	byte ptr [ecx],	2Ah
		jz	loc_62B97214
		mov	[esp+8], ecx	; channel
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel
		mov	[ebp+channel], eax
		test	eax, eax
		jz	loc_62B97524
		cmp	dword ptr [fsm_context_0+38h], 3
		jz	loc_62B97242

loc_62B970BE:				; CODE XREF: _silc_client_command_ban+1E0j
					; _silc_client_command_ban+218j
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		call	_silc_id_payload_encode
		mov	edi, eax

loc_62B970D8:				; CODE XREF: _silc_client_command_ban+31Dj
chidp =	edi				; SilcBuffer
args = edx				; SilcBuffer
		mov	[ebp+var_38], 0
		xor	args, args
		mov	[ebp+var_4C], 0
		xor	eax, eax
		mov	[ebp+var_34], 0

loc_62B970F1:				; CODE XREF: _silc_client_command_ban+33Cj
		test	chidp, chidp
		jz	loc_62B97450
		mov	ecx, [chidp+4]
		mov	[ebp+var_3C], ecx
		mov	[esp+38h], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+34h], eax
		mov	dword ptr [esp+30h], 3
		mov	ecx, [ebp+var_38]
		mov	[esp+2Ch], ecx
		mov	eax, [ebp+var_34]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	eax, [chidp+8]
		sub	eax, [ebp+var_3C]
		mov	[esp+20h], eax
		mov	ecx, [ebp+var_3C]
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 3 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+var_40], args
		call	_silc_client_command_send_va
		mov	eax, [chidp]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], chidp
		call	_silc_free
		mov	edx, [ebp+var_40]

loc_62B97185:				; CODE XREF: _silc_client_command_ban+467j
		test	edx, edx
args = edx				; SilcBuffer
		jz	short loc_62B971A1
		mov	eax, [args]
		mov	[esp], eax
		mov	[ebp+var_40], args
		call	_silc_free
		mov	edx, [ebp+var_40]
		mov	[esp], edx
args = edx				; SilcBuffer
		call	_silc_free

loc_62B971A1:				; CODE XREF: _silc_client_command_ban+12Bj
args = edx				; SilcBuffer
		mov	chidp, [ebp+channel]
		mov	[esp+8], edi	; channel_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax

loc_62B97208:				; CODE XREF: _silc_client_command_ban+3ECj
conn = esi				; SilcClientConnection
		add	esp, 8Ch
		pop	ebx
		pop	conn
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B97214:				; CODE XREF: _silc_client_command_ban+34j
		mov	ecx, [conn+30h]
		mov	[ebp+channel], ecx
		test	ecx, ecx
		jz	loc_62B97410
		mov	eax, [ebp+channel]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_ref_channel
		cmp	dword ptr [fsm_context_0+38h], 3
		jnz	loc_62B970BE

loc_62B97242:				; CODE XREF: _silc_client_command_ban+5Cj
		mov	eax, [fsm_context_0+3Ch]
		mov	edx, [eax+8]
		cmp	byte ptr [edx],	2Bh
		setnz	[ebp+action]
		lea	edx, [ebp+pubkey]
		mov	[esp+4], edx
		mov	eax, [eax+8]
		inc	eax
		mov	[esp], eax
		call	_silc_pkcs_load_public_key
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		cmp	[ebp+pubkey], 1
		adc	eax, 0
		mov	[ebp+var_34], eax
		test	eax, eax
		jz	loc_62B970BE
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		test	eax, eax
args = eax				; SilcBuffer
		jz	loc_62B9754B
		mov	dword ptr [esp+4], 1
		mov	dword ptr [esp], 2
		mov	[ebp+var_40], args
		call	_silc_calloc
		mov	edx, [ebp+var_40]
		mov	[edx], eax
args = edx				; SilcBuffer
		test	eax, eax
		jz	loc_62B9754B
		mov	[args+4], eax
		add	eax, 2
		mov	[args+0Ch], eax
		mov	[args+8], eax

loc_62B972C6:				; CODE XREF: _silc_client_command_ban+4F1j
		mov	dword ptr [esp+0Ch], 1Dh
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], 3
		mov	[esp], args
		mov	[ebp+var_40], args
		call	_silc_buffer_format
		mov	eax, [ebp+pubkey]
		test	eax, eax
		mov	edx, [ebp+var_40]
		jz	loc_62B974C8
		mov	[esp], eax
		call	_silc_public_key_payload_encode
		mov	edi, eax
chidp =	edi				; SilcBuffer
		test	eax, eax
		mov	edx, [ebp+var_40]
		jz	loc_62B974FC
chidp =	eax				; SilcBuffer
		mov	ecx, [chidp+4]
		mov	dword ptr [esp+0Ch], 2
		mov	chidp, [chidp+8]
chidp =	edi				; SilcBuffer
		sub	eax, ecx
		mov	[esp+8], eax
		mov	[esp+4], ecx
		mov	[esp], edx
args = edx				; SilcBuffer
		call	_silc_argument_payload_encode_one
		mov	edx, eax
args = edx				; SilcBuffer
		mov	eax, [chidp]
		mov	[esp], eax
		mov	[ebp+var_40], args
		call	_silc_free
		mov	[esp], chidp
		call	_silc_free
		mov	edx, [ebp+var_40]

loc_62B97346:				; CODE XREF: _silc_client_command_ban+4C2j
args = edx				; SilcBuffer
		mov	eax, [ebp+pubkey]
		mov	[esp], eax
		mov	[ebp+var_40], args
		call	_silc_pkcs_public_key_free
		mov	edx, [ebp+var_40]

loc_62B97357:				; CODE XREF: _silc_client_command_ban+498j
args = edx				; SilcBuffer
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		mov	[ebp+var_40], args
		call	_silc_id_payload_encode
		mov	chidp, eax
		mov	edx, [ebp+var_40]
		test	edx, edx
args = edx				; SilcBuffer
		jz	loc_62B970D8
		mov	eax, [args+4]
		mov	[ebp+var_4C], eax
		mov	eax, [args+8]
		sub	eax, [ebp+var_4C]
		mov	[ebp+var_38], 1
		lea	ecx, [ebp+action]
		mov	[ebp+var_34], ecx
		jmp	loc_62B970F1
; ---------------------------------------------------------------------------
		align 10h

loc_62B973A0:				; CODE XREF: _silc_client_command_ban+25j
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageBanChanne ; "Usage: /BAN <channel> [+|-[<nickname>[@"...
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh

loc_62B973E4:				; CODE XREF: _silc_client_command_ban+4EAj
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3
		add	esp, 8Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 10h

loc_62B97410:				; CODE XREF: _silc_client_command_ban+1C0j
		mov	edi, [ebp+client]
		mov	ecx, [edi+18h]
		mov	ecx, [ecx+48h]
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 19h
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edi
		call	dword ptr [ecx+10h]
		mov	eax, 3
		jmp	loc_62B97208
; ---------------------------------------------------------------------------
chidp =	edi				; SilcBuffer
args = edx				; SilcBuffer
		align 10h

loc_62B97450:				; CODE XREF: _silc_client_command_ban+97j
		mov	[esp+38h], eax
		mov	ecx, [ebp+var_4C]
		mov	[esp+34h], ecx
		mov	dword ptr [esp+30h], 3
		mov	chidp, [ebp+var_38]
		mov	[esp+2Ch], edi
		mov	eax, [ebp+var_34]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	dword ptr [esp+20h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 3 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+var_40], args
		call	_silc_client_command_send_va
		mov	edx, [ebp+var_40]
		jmp	loc_62B97185
; ---------------------------------------------------------------------------

loc_62B974C8:				; CODE XREF: _silc_client_command_ban+295j
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_34]
ban = edi				; char *
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+0Ch], 1
		mov	[esp+8], ecx
		mov	edi, [ebp+var_34]
		mov	[esp+4], edi
		mov	[esp], edx
args = edx				; SilcBuffer
		call	_silc_argument_payload_encode_one
		mov	edx, eax
args = edx				; SilcBuffer
		jmp	loc_62B97357
; ---------------------------------------------------------------------------
chidp =	eax				; SilcBuffer
		align 4

loc_62B974FC:				; CODE XREF: _silc_client_command_ban+2AAj
		mov	dword ptr [esp+0Ch], 2
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], edx
args = edx				; SilcBuffer
		call	_silc_argument_payload_encode_one
chidp =	edi				; SilcBuffer
		mov	edx, eax
args = edx				; SilcBuffer
		jmp	loc_62B97346
; ---------------------------------------------------------------------------
		align 4

loc_62B97524:				; CODE XREF: _silc_client_command_ban+52j
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 19h
		jmp	loc_62B973E4
; ---------------------------------------------------------------------------

loc_62B9754B:				; CODE XREF: _silc_client_command_ban+234j
					; _silc_client_command_ban+258j
conn = esi				; SilcClientConnection
args = eax				; SilcBuffer
		xor	edx, edx
args = edx				; SilcBuffer
		jmp	loc_62B972C6
_silc_client_command_ban endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  43. silc_client_command_oper_send

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_oper_send(SilcFSMObject *fsm,	void *fsm_context, void	*state_context)
		public _silc_client_command_oper_send
_silc_client_command_oper_send proc near ; DATA	XREF: _silc_client_command_silcoper+1Co
					; _silc_client_command_oper+1Co

conn		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
oper		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	ebx, [ebp+fsm_context]
		mov	edx, [ebx+4]
conn = edx				; SilcClientConnection
		mov	eax, [ebx+60h]
		mov	[ebp+oper], eax
		test	eax, eax
		jz	loc_62B976D0
fsm_context_0 =	ebx			; void *
		mov	eax, [eax]
		test	eax, eax
		jz	loc_62B976D0
		mov	esi, [ebp+oper]
		movzx	ecx, word ptr [esi+4]
		mov	[esp+10h], ecx
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 1
		mov	[ebp+conn], conn
		call	_silc_auth_payload_encode
		mov	esi, eax
auth = esi				; SilcBuffer
		mov	edx, [ebp+conn]
		test	auth, auth
		jz	loc_62B97718

loc_62B975B6:				; CODE XREF: _silc_client_command_oper_send+1BEj
		mov	eax, [auth+4]
		mov	[ebp+var_28], eax
		mov	ecx, [auth+8]
		sub	ecx, eax
		mov	[ebp+var_20], ecx

loc_62B975C4:				; CODE XREF: _silc_client_command_oper_send+1D2j
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[ebp+var_24], eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, eax
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	eax, [ebp+var_20]
		mov	[esp+2Ch], eax
		mov	eax, [ebp+var_28]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], ecx
		mov	ecx, [ebp+var_24]
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], edx	; conn
conn = edx				; SilcClientConnection
		call	_silc_client_command_send_va
		mov	edx, [auth]
		mov	ecx, [auth+0Ch]
		sub	ecx, edx
		mov	edi, edx
		xor	eax, eax
		rep stosb
		mov	eax, [auth]
		mov	[auth+8], eax
		mov	[auth+4], eax
		mov	[esp], eax
		call	_silc_free
		mov	[esp], auth
		call	_silc_free
		mov	edx, [ebp+oper]
		test	edx, edx
		jz	short loc_62B97674
		mov	edx, [ebp+oper]
		mov	eax, [edx]
		mov	[esp], eax
		call	_silc_free
		mov	ecx, [ebp+oper]
		mov	[esp], ecx
		call	_silc_free

loc_62B97674:				; CODE XREF: _silc_client_command_oper_send+106j
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	auth, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = edx				; SilcClientConnection
		align 10h

loc_62B976D0:				; CODE XREF: _silc_client_command_oper_send+17j
					; _silc_client_command_oper_send+21j
		mov	dword ptr [esp+14h], 2
		mov	eax, [conn+4]
		mov	[esp+10h], eax
		mov	eax, [conn+54h]
		mov	eax, [eax+0ECh]
		mov	[esp+0Ch], eax
		mov	eax, [conn+4Ch]
		mov	eax, [eax+10h]
		mov	[esp+8], eax
		mov	eax, [conn+38h]
		mov	[esp+4], eax
		mov	eax, [conn+34h]
		mov	[esp], eax
		mov	[ebp+conn], conn
		call	_silc_auth_public_key_auth_generate
		mov	esi, eax
auth = esi				; SilcBuffer
		mov	edx, [ebp+conn]
		test	auth, auth
		jnz	loc_62B975B6

loc_62B97718:				; CODE XREF: _silc_client_command_oper_send+5Cj
		mov	[ebp+var_20], 0
		mov	[ebp+var_28], 0
		jmp	loc_62B975C4
_silc_client_command_oper_send endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  37. silc_client_command_kill

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_kill(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_kill
_silc_client_command_kill proc near	; DATA XREF: _silc_client_commands_unregister+5C5o
					; _silc_client_commands_register+3E7o

client_list	= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
auth		= dword	ptr -34h
idp		= dword	ptr -30h
client		= dword	ptr -2Ch
nickname	= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[ebp+nickname],	0
		cmp	dword ptr [ebx+38h], 1
		jbe	loc_62B97974
fsm_context_0 =	ebx			; void *
		lea	eax, [ebp+nickname]
		mov	[esp+0Ch], eax	; ret_nick
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_nickname_parse
		test	al, al
		jnz	short loc_62B97784
		mov	eax, 3

loc_62B9777B:				; CODE XREF: _silc_client_command_kill+420j
		add	esp, 7Ch
		pop	fsm_context_0
		pop	conn
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B97784:				; CODE XREF: _silc_client_command_kill+48j
		mov	dword ptr [esp+0Ch], 0 ; return_all
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_get_clients_local
		mov	edx, eax
clients	= edx				; SilcDList
		test	eax, eax
		jz	loc_62B97AF0
clients	= eax				; SilcDList
		mov	clients, [clients+14h]
clients	= edx				; SilcDList
		mov	[clients+18h], eax
		mov	eax, [clients+8]
		test	eax, eax
		jz	loc_62B97B54
		test	byte ptr [clients+10h],	2
		jnz	loc_62B979E0
		movzx	ecx, word ptr [clients+0Ch]
		mov	ecx, [eax+ecx]

loc_62B977D1:				; CODE XREF: _silc_client_command_kill+2BBj
		mov	[clients+8], ecx
		mov	[clients+14h], eax
		mov	edi, [eax]

loc_62B977D9:				; CODE XREF: _silc_client_command_kill+431j
		cmp	dword ptr [fsm_context_0+38h], 2
		ja	loc_62B979EC
		mov	[ebp+var_3C], 0

loc_62B977EA:				; CODE XREF: _silc_client_command_kill+30Fj
					; _silc_client_command_kill+330j
		mov	dword ptr [esp+4], 2
		add	edi, 38Ch
		mov	[esp], edi
		mov	[ebp+client_list], clients
		call	_silc_id_payload_encode
		mov	[ebp+idp], eax
		mov	edx, [ebp+client_list]

loc_62B97809:				; CODE XREF: _silc_client_command_kill+392j
		mov	[ebp+var_38], 0
		mov	[ebp+auth], 0
		mov	[ebp+var_40], 0

loc_62B9781E:				; CODE XREF: _silc_client_command_kill+3ACj
		mov	eax, [ebp+var_3C]
		test	eax, eax
		jz	loc_62B97BDC
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_3C]
comment	= edi				; char *
		repne scasb
		not	ecx
		lea	eax, [ecx-1]

loc_62B9783A:				; CODE XREF: _silc_client_command_kill+4B2j
		mov	edi, [ebp+idp]
		test	edi, edi
		jz	loc_62B97B64
		mov	edi, [ebp+idp]
		mov	ecx, [edi+4]
		mov	edi, [ebp+var_38]
		mov	[esp+38h], edi
		mov	edi, [ebp+var_40]
		mov	[esp+34h], edi
		mov	dword ptr [esp+30h], 3
		mov	[esp+2Ch], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	edi, [ebp+idp]
		mov	eax, [edi+8]
		sub	eax, ecx
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 3 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+client_list], edx
		call	_silc_client_command_send_va
		mov	eax, [edi]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], edi
		call	_silc_free
		mov	edx, [ebp+client_list]

loc_62B978D0:				; CODE XREF: _silc_client_command_kill+4ABj
		mov	ecx, [ebp+auth]
		test	ecx, ecx
		jz	short loc_62B978F5
		mov	ecx, [ebp+auth]
		mov	eax, [ecx]
		mov	[esp], eax
		mov	[ebp+client_list], edx
		call	_silc_free
		mov	edi, [ebp+auth]
		mov	[esp], edi
		call	_silc_free
		mov	edx, [ebp+client_list]

loc_62B978F5:				; CODE XREF: _silc_client_command_kill+1A9j
		mov	eax, [ebp+nickname]
		mov	[esp], eax
		mov	[ebp+client_list], edx
		call	_silc_free
		mov	edx, [ebp+client_list]
		mov	[esp+8], edx	; client_list
clients	= edx				; SilcDList
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_list_free
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 7Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B97974:				; CODE XREF: _silc_client_command_kill+20j
		mov	edx, eax
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageKillNickn ; "Usage: /KILL <nickname> [<comment>] [-p"...
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3
		add	esp, 7Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
clients	= edx				; SilcDList
		align 10h

loc_62B979E0:				; CODE XREF: _silc_client_command_kill+98j
		movzx	ecx, word ptr [clients+0Eh]
		mov	ecx, [eax+ecx]
		jmp	loc_62B977D1
; ---------------------------------------------------------------------------

loc_62B979EC:				; CODE XREF: _silc_client_command_kill+B1j
		mov	dword ptr [esp+4], offset aPubkey ; "-pubkey"
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	[esp], eax	; char *
		mov	[ebp+client_list], clients
		call	_stricmp
		test	eax, eax
		mov	edx, [ebp+client_list]
		jnz	loc_62B97AE0
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
comment	= eax				; char *
		mov	[ebp+var_3C], 0

loc_62B97A1D:				; CODE XREF: _silc_client_command_kill+3BDj
		mov	dword ptr [esp+4], offset aPubkey ; "-pubkey"
		mov	[esp], comment	; char *
		mov	[ebp+client_list], edx
		call	_stricmp
		test	eax, eax
		mov	edx, [ebp+client_list]
		jz	short loc_62B97A62
		cmp	dword ptr [fsm_context_0+38h], 3
		jbe	loc_62B977EA
		mov	dword ptr [esp+4], offset aPubkey ; "-pubkey"
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+0Ch]
		mov	[esp], eax	; char *
		call	_stricmp
		test	eax, eax
		mov	edx, [ebp+client_list]
		jnz	loc_62B977EA

loc_62B97A62:				; CODE XREF: _silc_client_command_kill+309j
		add	edi, 38Ch
		mov	dword ptr [esp+14h], 2
		mov	[esp+10h], edi
		mov	eax, [conn+54h]
		mov	eax, [eax+0F0h]
		mov	[esp+0Ch], eax
		mov	eax, [conn+4Ch]
		mov	eax, [eax+10h]
		mov	[esp+8], eax
		mov	eax, [conn+38h]
		mov	[esp+4], eax
		mov	eax, [conn+34h]
		mov	[esp], eax
		mov	[ebp+client_list], edx
		call	_silc_auth_public_key_auth_generate
		mov	[ebp+auth], eax
		mov	dword ptr [esp+4], 2
		mov	[esp], edi
		call	_silc_id_payload_encode
		mov	[ebp+idp], eax
		mov	edx, [ebp+auth]
		test	edx, edx
		mov	edx, [ebp+client_list]
		jz	loc_62B97809
		mov	edi, [ebp+auth]
		mov	edi, [edi+4]
		mov	[ebp+var_40], edi
		mov	eax, [ebp+auth]
		mov	eax, [eax+8]
		sub	eax, edi
		mov	[ebp+var_38], eax
		jmp	loc_62B9781E
; ---------------------------------------------------------------------------
		align 10h

loc_62B97AE0:				; CODE XREF: _silc_client_command_kill+2DEj
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	[ebp+var_3C], eax
		jmp	loc_62B97A1D
; ---------------------------------------------------------------------------
clients	= eax				; SilcDList
		align 10h

loc_62B97AF0:				; CODE XREF: _silc_client_command_kill+7Dj
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B97BE4

loc_62B97B09:				; CODE XREF: _silc_client_command_kill+4E4j
		mov	[esp+14h], fsm_context_0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_command_resolve_continue ; completion
		mov	dword ptr [esp+0Ch], 0 ; server
		mov	eax, [ebp+nickname]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_get_clients
		mov	eax, [ebp+fsm]
		mov	dl, [eax+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		shl	eax, 1
		and	eax, 2
		jmp	loc_62B9777B
; ---------------------------------------------------------------------------
clients	= edx				; SilcDList
		align 4

loc_62B97B54:				; CODE XREF: _silc_client_command_kill+8Ej
		mov	dword ptr [clients+14h], 0
		xor	edi, edi
		jmp	loc_62B977D9
; ---------------------------------------------------------------------------
		align 4

loc_62B97B64:				; CODE XREF: _silc_client_command_kill+113j
		mov	ecx, [ebp+var_38]
		mov	[esp+38h], ecx
		mov	edi, [ebp+var_40]
		mov	[esp+34h], edi
		mov	dword ptr [esp+30h], 3
		mov	[esp+2Ch], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	dword ptr [esp+20h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 3 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+client_list], edx
		call	_silc_client_command_send_va
		mov	edx, [ebp+client_list]
		jmp	loc_62B978D0
; ---------------------------------------------------------------------------

loc_62B97BDC:				; CODE XREF: _silc_client_command_kill+F7j
		xor	eax, eax
		jmp	loc_62B9783A
; ---------------------------------------------------------------------------
		align 4

loc_62B97BE4:				; CODE XREF: _silc_client_command_kill+3D7j
		mov	dword ptr [esp+8], 4BAh
		mov	dword ptr [esp+4], offset aCommand_c ; "command.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_5	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B97B09
_silc_client_command_kill endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  34. silc_client_command_invite

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_invite(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_command_invite
_silc_client_command_invite proc near	; DATA XREF: _silc_client_commands_unregister+465o
					; _silc_client_commands_register+2F1o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
clients		= dword	ptr -34h
channel		= dword	ptr -30h
client		= dword	ptr -2Ch
nickname	= dword	ptr -24h
pubkey		= dword	ptr -20h
action		= byte ptr -19h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 8Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[ebp+pubkey], 0
		mov	[ebp+nickname],	0
		mov	eax, [ebx+38h]
		cmp	eax, 1
		jbe	loc_62B97F24
fsm_context_0 =	ebx			; void *
		mov	edx, [fsm_context_0+3Ch]
		mov	ecx, [edx+4]
		cmp	byte ptr [ecx],	2Ah
		jz	loc_62B97E64
		mov	[esp+8], ecx	; channel
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel
		mov	[ebp+channel], eax
		test	eax, eax
		jz	loc_62B98204
		cmp	dword ptr [fsm_context_0+38h], 3
		jz	loc_62B97E92

loc_62B97C81:				; CODE XREF: _silc_client_command_invite+274j
		mov	[ebp+clients], 0
		xor	edx, edx

loc_62B97C8A:				; CODE XREF: _silc_client_command_invite+307j
					; _silc_client_command_invite+61Fj
client_entry = edx			; SilcClientEntry
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		mov	[ebp+var_48], client_entry
		call	_silc_id_payload_encode
		mov	edi, eax
chidp =	edi				; SilcBuffer
		mov	edx, [ebp+var_48]
		test	edx, edx
client_entry = edx			; SilcClientEntry
		jz	loc_62B98245
		mov	dword ptr [esp+4], 2
		add	client_entry, 38Ch
		mov	[esp], edx
		call	_silc_id_payload_encode
		mov	edx, eax
clidp =	edx				; SilcBuffer
		test	eax, eax
		jz	loc_62B981B8
clidp =	eax				; SilcBuffer
		mov	ecx, [clidp+4]
		mov	[ebp+var_3C], ecx
		mov	clidp, [clidp+8]
clidp =	edx				; SilcBuffer
		sub	eax, ecx

loc_62B97CDD:				; CODE XREF: _silc_client_command_invite+5A9j
		test	chidp, chidp
		jz	loc_62B981A8
		mov	ecx, [chidp+4]
		mov	[ebp+var_38], ecx
		mov	ecx, [chidp+8]
		sub	ecx, [ebp+var_38]

loc_62B97CF1:				; CODE XREF: _silc_client_command_invite+599j
		mov	dword ptr [esp+44h], 0
		mov	dword ptr [esp+40h], 0
		mov	dword ptr [esp+3Ch], 4
		mov	dword ptr [esp+38h], 0
		mov	dword ptr [esp+34h], 0
		mov	dword ptr [esp+30h], 3
		mov	[esp+2Ch], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], ecx
		mov	ecx, [ebp+var_38]
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 4 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+var_48], clidp
		call	_silc_client_command_send_va
		mov	edx, [ebp+var_48]
		test	edx, edx
clidp =	edx				; SilcBuffer
		jz	short loc_62B97D97
		mov	eax, [clidp]
		mov	[esp], eax
		mov	[ebp+var_48], clidp
		call	_silc_free
		mov	edx, [ebp+var_48]
		mov	[esp], edx
clidp =	edx				; SilcBuffer
		call	_silc_free
		xor	edx, edx

loc_62B97D97:				; CODE XREF: _silc_client_command_invite+163j
					; _silc_client_command_invite+58Bj
args = edx				; SilcBuffer
		test	chidp, chidp
		jz	short loc_62B97DB3
		mov	eax, [chidp]
		mov	[esp], eax
		mov	[ebp+var_48], args
		call	_silc_free
		mov	[esp], chidp
		call	_silc_free
		mov	edx, [ebp+var_48]

loc_62B97DB3:				; CODE XREF: _silc_client_command_invite+181j
args = edx				; SilcBuffer
		test	args, args
		jz	short loc_62B97DCF
		mov	eax, [args]
		mov	[esp], eax
		mov	[ebp+var_48], args
		call	_silc_free
		mov	edx, [ebp+var_48]
		mov	[esp], edx
args = edx				; SilcBuffer
		call	_silc_free

loc_62B97DCF:				; CODE XREF: _silc_client_command_invite+19Dj
args = edx				; SilcBuffer
		mov	eax, [ebp+nickname]
		mov	[esp], eax
		call	_silc_free
		mov	chidp, [ebp+clients]
		mov	[esp+8], edi	; client_list
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_list_free
		mov	edx, [ebp+channel]
		mov	[esp+8], edx	; channel_entry
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_channel
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	edi, [ebp+fsm]
		mov	[esp], edi
		call	_silc_fsm_next
		xor	eax, eax

loc_62B97E57:				; CODE XREF: _silc_client_command_invite+6C7j
conn = esi				; SilcClientConnection
		add	esp, 8Ch
		pop	ebx
		pop	conn
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B97E64:				; CODE XREF: _silc_client_command_invite+3Bj
		mov	ecx, [conn+30h]
		mov	[ebp+channel], ecx
		test	ecx, ecx
		jz	loc_62B97FA0
		mov	eax, [ebp+channel]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_ref_channel
		cmp	dword ptr [fsm_context_0+38h], 3
		jnz	loc_62B97C81

loc_62B97E92:				; CODE XREF: _silc_client_command_invite+63j
		mov	eax, [fsm_context_0+3Ch]
		mov	edx, [eax+8]
		mov	cl, [edx]
		cmp	cl, 2Bh
		jz	loc_62B9823C
		cmp	cl, 2Dh
		jz	loc_62B97FD8
		lea	eax, [ebp+nickname]
		mov	[esp+0Ch], eax	; ret_nick
		mov	[esp+8], edx	; nickname
		mov	[esp+4], conn	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_nickname_parse
		mov	dword ptr [esp+0Ch], 0 ; return_all
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	[esp], edi	; client
		call	_silc_client_get_clients_local
		mov	[ebp+clients], eax
		test	eax, eax
		jz	loc_62B98287
		mov	edi, [ebp+clients]
		mov	eax, [edi+14h]
		mov	[edi+18h], eax
		mov	edx, [edi+8]
		test	edx, edx
		jz	loc_62B9822B
		test	byte ptr [edi+10h], 2
		jz	loc_62B98278
		movzx	eax, word ptr [edi+0Eh]
		mov	eax, [edx+eax]

loc_62B97F14:				; CODE XREF: _silc_client_command_invite+66Aj
		mov	edi, [ebp+clients]
		mov	[edi+8], eax
		mov	[edi+14h], edx
		mov	edx, [edx]
client_entry = edx			; SilcClientEntry
		jmp	loc_62B97C8A
; ---------------------------------------------------------------------------

loc_62B97F24:				; CODE XREF: _silc_client_command_invite+2Cj
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageInviteCha ; "Usage: /INVITE <channel>	[<nickname>[@s"...
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh

loc_62B97F68:				; CODE XREF: _silc_client_command_invite+60Ej
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]

out:					; CODE XREF: _silc_client_command_invite+3BBj
conn = esi				; SilcClientConnection
		mov	eax, [ebp+nickname]
		mov	[esp], eax
		call	_silc_free
		mov	eax, 3
		add	esp, 8Ch
		pop	ebx
		pop	conn
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 10h

loc_62B97FA0:				; CODE XREF: _silc_client_command_invite+254j
		mov	edi, [ebp+client]
		mov	ecx, [edi+18h]
		mov	ecx, [ecx+48h]
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 19h
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edi
		call	dword ptr [ecx+10h]
		jmp	short out
; ---------------------------------------------------------------------------
		align 4

loc_62B97FD8:				; CODE XREF: _silc_client_command_invite+28Ej
		mov	[ebp+action], 1

loc_62B97FDC:				; CODE XREF: _silc_client_command_invite+628j
		lea	edx, [ebp+pubkey]
		mov	[esp+4], edx
		mov	eax, [eax+8]
		inc	eax
		mov	[esp], eax
		call	_silc_pkcs_load_public_key
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		cmp	[ebp+pubkey], 1
		adc	eax, 0
		mov	[ebp+clients], eax
		test	eax, eax
		jz	loc_62B98319
		mov	dword ptr [esp+4], 10h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		test	eax, eax
args = eax				; SilcBuffer
		jz	loc_62B98312
		mov	dword ptr [esp+4], 1
		mov	dword ptr [esp], 2
		mov	[ebp+var_48], args
		call	_silc_calloc
		mov	edx, [ebp+var_48]
		mov	[edx], eax
args = edx				; SilcBuffer
		test	eax, eax
		jz	loc_62B98312
		mov	[args+4], eax
		add	eax, 2
		mov	[args+0Ch], eax
		mov	[args+8], eax

loc_62B98053:				; CODE XREF: _silc_client_command_invite+6FCj
		mov	dword ptr [esp+0Ch], 1Dh
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], 3
		mov	[esp], args
		mov	[ebp+var_48], args
		call	_silc_buffer_format
		mov	eax, [ebp+pubkey]
		test	eax, eax
		mov	edx, [ebp+var_48]
		jz	loc_62B981C8
		mov	[esp], eax
		call	_silc_public_key_payload_encode
		mov	edi, eax
chidp =	edi				; SilcBuffer
		mov	ecx, [eax+4]
		mov	dword ptr [esp+0Ch], 2
		mov	eax, [eax+8]
		sub	eax, ecx
		mov	[esp+8], eax
		mov	[esp+4], ecx
		mov	edx, [ebp+var_48]
		mov	[esp], edx
args = edx				; SilcBuffer
		call	_silc_argument_payload_encode_one
		mov	edx, eax
args = edx				; SilcBuffer
		mov	eax, [chidp]
		mov	[esp], eax
		mov	[ebp+var_48], args
		call	_silc_free
		mov	[esp], chidp
		call	_silc_free
		mov	eax, [ebp+pubkey]
		mov	[esp], eax
		call	_silc_pkcs_public_key_free
		mov	edx, [ebp+var_48]
		xor	eax, eax
		test	edx, edx
args = edx				; SilcBuffer
		setnz	al
		mov	[ebp+var_38], eax

loc_62B980E0:				; CODE XREF: _silc_client_command_invite+5E6j
					; _silc_client_command_invite+70Aj
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		mov	[ebp+var_48], args
		call	_silc_id_payload_encode
		mov	chidp, eax
		mov	[ebp+clients], 0
		mov	edx, [ebp+var_48]
		test	edx, edx
args = edx				; SilcBuffer
		jz	loc_62B98250
		mov	eax, [args+4]
		mov	[ebp+var_40], eax
		mov	eax, [args+8]
		sub	eax, [ebp+var_40]
		lea	ecx, [ebp+action]
		mov	[ebp+var_44], ecx

loc_62B98121:				; CODE XREF: _silc_client_command_invite+648j
		test	chidp, chidp
		jz	loc_62B98268
		mov	ecx, [chidp+4]
		mov	[ebp+var_3C], ecx
		mov	ecx, [chidp+8]
		sub	ecx, [ebp+var_3C]

loc_62B98135:				; CODE XREF: _silc_client_command_invite+659j
		mov	[esp+38h], eax
		mov	eax, [ebp+var_40]
		mov	[esp+34h], eax
		mov	dword ptr [esp+30h], 4
		mov	eax, [ebp+var_38]
		mov	[esp+2Ch], eax
		mov	eax, [ebp+var_44]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 3
		mov	[esp+20h], ecx
		mov	ecx, [ebp+var_3C]
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 3 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+var_48], args
		call	_silc_client_command_send_va
		mov	edx, [ebp+var_48]
		jmp	loc_62B97D97
; ---------------------------------------------------------------------------

loc_62B981A8:				; CODE XREF: _silc_client_command_invite+C7j
clidp =	edx				; SilcBuffer
		xor	ecx, ecx
		mov	[ebp+var_38], 0
		jmp	loc_62B97CF1
; ---------------------------------------------------------------------------
clidp =	eax				; SilcBuffer
		align 4

loc_62B981B8:				; CODE XREF: _silc_client_command_invite+B4j
		xor	clidp, clidp
clidp =	edx				; SilcBuffer
		mov	[ebp+var_3C], 0
		jmp	loc_62B97CDD
; ---------------------------------------------------------------------------
		align 4

loc_62B981C8:				; CODE XREF: _silc_client_command_invite+466j
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+clients]
invite = edi				; char *
		repne scasb
		not	ecx
		dec	ecx
		mov	dword ptr [esp+0Ch], 1
		mov	[esp+8], ecx
		mov	eax, [ebp+clients]
		mov	[esp+4], eax
		mov	[esp], edx
args = edx				; SilcBuffer
		call	_silc_argument_payload_encode_one
		mov	edx, eax
args = edx				; SilcBuffer
		xor	eax, eax
		test	args, args
		setnz	al
		mov	[ebp+var_38], eax
		jmp	loc_62B980E0
; ---------------------------------------------------------------------------
		align 4

loc_62B98204:				; CODE XREF: _silc_client_command_invite+59j
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 19h
		jmp	loc_62B97F68
; ---------------------------------------------------------------------------

loc_62B9822B:				; CODE XREF: _silc_client_command_invite+2E5j
conn = esi				; SilcClientConnection
		mov	eax, [ebp+clients]
		mov	dword ptr [eax+14h], 0
		xor	edx, edx
client_entry = edx			; SilcClientEntry
		jmp	loc_62B97C8A
; ---------------------------------------------------------------------------

loc_62B9823C:				; CODE XREF: _silc_client_command_invite+285j
		mov	[ebp+action], 0
		jmp	loc_62B97FDC
; ---------------------------------------------------------------------------

loc_62B98245:				; CODE XREF: _silc_client_command_invite+94j
client_entry = edx			; SilcClientEntry
chidp =	edi				; SilcBuffer
		mov	[ebp+var_38], 0
		xor	client_entry, client_entry
args = edx				; SilcBuffer
		xchg	ax, ax

loc_62B98250:				; CODE XREF: _silc_client_command_invite+4F1j
		xor	eax, eax
		mov	[ebp+var_40], 0
		mov	[ebp+var_44], 0
		jmp	loc_62B98121
; ---------------------------------------------------------------------------
		align 4

loc_62B98268:				; CODE XREF: _silc_client_command_invite+50Bj
		xor	ecx, ecx
		mov	[ebp+var_3C], 0
		jmp	loc_62B98135
; ---------------------------------------------------------------------------
		align 4

loc_62B98278:				; CODE XREF: _silc_client_command_invite+2EFj
		mov	ecx, [ebp+clients]
		movzx	eax, word ptr [ecx+0Ch]
		mov	eax, [edx+eax]
		jmp	loc_62B97F14
; ---------------------------------------------------------------------------

loc_62B98287:				; CODE XREF: _silc_client_command_invite+2D1j
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	short loc_62B982E4

loc_62B9829C:				; CODE XREF: _silc_client_command_invite+6F8j
		mov	[esp+14h], fsm_context_0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_command_resolve_continue ; completion
		mov	dword ptr [esp+0Ch], 0 ; server
		mov	eax, [ebp+nickname]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_get_clients
		mov	eax, [ebp+fsm]
		mov	dl, [eax+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		shl	eax, 1
		and	eax, 2
		jmp	loc_62B97E57
; ---------------------------------------------------------------------------

loc_62B982E4:				; CODE XREF: _silc_client_command_invite+682j
		mov	dword ptr [esp+8], 429h
		mov	dword ptr [esp+4], offset aCommand_c ; "command.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_5	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	short loc_62B9829C
; ---------------------------------------------------------------------------

loc_62B98312:				; CODE XREF: _silc_client_command_invite+405j
					; _silc_client_command_invite+429j
args = eax				; SilcBuffer
		xor	edx, edx
args = edx				; SilcBuffer
		jmp	loc_62B98053
; ---------------------------------------------------------------------------

loc_62B98319:				; CODE XREF: _silc_client_command_invite+3E9j
		mov	[ebp+var_38], 0
		xor	edx, edx
args = edx				; SilcBuffer
		jmp	loc_62B980E0
_silc_client_command_invite endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  28. silc_client_command_cumode

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_cumode(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_command_cumode
_silc_client_command_cumode proc near	; DATA XREF: _silc_client_commands_unregister+BF5o
					; _silc_client_commands_register+83Ao

var_5C		= dword	ptr -5Ch
sb		= dword	ptr -50h
client_list	= dword	ptr -4Ch
client_entry	= dword	ptr -48h
auth		= dword	ptr -44h
pass		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
channel		= dword	ptr -34h
client		= dword	ptr -30h
mode		= dword	ptr -2Ch
privkey		= dword	ptr -28h
pubkey		= dword	ptr -24h
nickname	= dword	ptr -20h
modebuf		= byte ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ACh
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[ebp+nickname],	0
		mov	eax, [ebx+38h]
		cmp	eax, 3
		jbe	loc_62B984E0
fsm_context_0 =	ebx			; void *
		mov	edx, [fsm_context_0+3Ch]
		mov	ecx, [edx+4]
		cmp	byte ptr [ecx],	2Ah
		jz	loc_62B984B4
		mov	[esp+8], ecx	; channel
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_channel
		mov	[ebp+channel], eax
		test	eax, eax
		jz	loc_62B98A4C

loc_62B98380:				; CODE XREF: _silc_client_command_cumode+1B0j
		lea	eax, [ebp+nickname]
		mov	[esp+0Ch], eax	; ret_nick
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+0Ch]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_nickname_parse
		mov	dword ptr [esp+0Ch], 0 ; return_all
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+0Ch]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	[esp], edi	; client
		call	_silc_client_get_clients_local
		mov	edx, eax
clients	= edx				; SilcDList
		test	eax, eax
		jz	loc_62B98988
clients	= eax				; SilcDList
		mov	clients, [clients+14h]
clients	= edx				; SilcDList
		mov	[clients+18h], eax
		mov	eax, [clients+8]
		test	eax, eax
		jz	loc_62B989E8
		test	byte ptr [clients+10h],	2
		jnz	loc_62B98590
		movzx	ecx, word ptr [clients+0Ch]
		mov	ecx, [eax+ecx]

loc_62B983EA:				; CODE XREF: _silc_client_command_cumode+26Fj
		mov	[clients+8], ecx
		mov	[clients+14h], eax
		mov	eax, [eax]
		mov	[ebp+client_entry], eax

loc_62B983F5:				; CODE XREF: _silc_client_command_cumode+6CEj
		mov	edi, [ebp+client_entry]
		mov	[esp+4], edi	; client_entry
		mov	eax, [ebp+channel]
		mov	[esp], eax	; channel
		mov	[ebp+client_list], clients
		call	_silc_client_on_channel
		test	eax, eax
chu = eax				; SilcChannelUser
		mov	edx, [ebp+client_list]
		jz	loc_62B989FC
		mov	chu, [chu+4]
		mov	[ebp+mode], eax

loc_62B9841B:				; CODE XREF: _silc_client_command_cumode+6DBj
chu = eax				; SilcChannelUser
		mov	chu, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		xor	ecx, ecx
		cmp	byte ptr [eax],	2Dh
		setnz	cl
		mov	[ebp+var_38], ecx
		inc	eax
		mov	[ebp+pass], eax
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+pass]
cp = edi				; unsigned __int8 *
		repne scasb
		not	ecx
		dec	ecx
len = ecx				; SilcUInt32
		jz	loc_62B98A8F
		xor	eax, eax
		xor	edi, edi
i = edi					; int
		mov	[ebp+auth], 0
		mov	[ebp+var_3C], len
		mov	len, [ebp+pass]
cp = ecx				; unsigned __int8 *
		xchg	ax, ax

loc_62B98458:				; CODE XREF: _silc_client_command_cumode+2D2j
		mov	al, [cp+eax]
		sub	eax, 61h
		cmp	al, 14h		; switch 21 cases
		jbe	loc_62B985D8

loc_62B98466:				; CODE XREF: _silc_client_command_cumode+2B3j
					; DATA XREF: .rdata:off_62BA8CA0o
		mov	i, [fsm_context_0+4] ; jumptable 62B985DB default case
		mov	eax, [edi+4Ch]
		mov	cp, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	[ebp+mode], ecx
		mov	ecx, [fsm_context_0+3Ch]
		mov	[esp+18h], ecx
		mov	ecx, [fsm_context_0+38h]
		mov	[esp+14h], ecx
		mov	dword ptr [esp+10h], 25h
		movzx	ecx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edi
		mov	[esp], eax
		mov	[ebp+client_list], edx
		mov	ecx, [ebp+mode]
		call	dword ptr [ecx+10h]
		mov	edx, [ebp+client_list]
		jmp	out
; ---------------------------------------------------------------------------
		align 4

loc_62B984B4:				; CODE XREF: _silc_client_command_cumode+34j
		mov	ecx, [conn+30h]
		mov	[ebp+channel], ecx
		test	ecx, ecx
		jz	loc_62B9859C
		mov	eax, [ebp+channel]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_ref_channel
		jmp	loc_62B98380
; ---------------------------------------------------------------------------
		align 10h

loc_62B984E0:				; CODE XREF: _silc_client_command_cumode+25j
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageCumodeCha ; "Usage: /CUMODE <channel>	+|-<modes> <ni"...
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	edi, [fsm_context_0+3Ch]
		mov	[esp+18h], edi
		mov	edi, [fsm_context_0+38h]
		mov	[esp+14h], edi
		mov	dword ptr [esp+10h], 1Dh
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		xor	edx, edx
clients	= edx				; SilcDList
		mov	[ebp+channel], 0

out:					; CODE XREF: _silc_client_command_cumode+186j
					; _silc_client_command_cumode+2A9j ...
		mov	ecx, [ebp+channel]
		mov	[esp+8], ecx	; channel_entry
		mov	[esp+4], conn	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		mov	[ebp+client_list], clients
		call	_silc_client_unref_channel
		mov	edx, [ebp+client_list]
		mov	[esp+8], edx	; client_list
clients	= edx				; SilcDList
		mov	[esp+4], conn	; conn
		mov	[esp], edi	; client
		call	_silc_client_list_free
		mov	eax, [ebp+nickname]
		mov	[esp], eax
		call	_silc_free
		mov	eax, 3

loc_62B98583:				; CODE XREF: _silc_client_command_cumode+4CDj
					; _silc_client_command_cumode+6B8j
		add	esp, 0ACh
		pop	ebx
		pop	conn
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
clients	= edx				; SilcDList
		align 10h

loc_62B98590:				; CODE XREF: _silc_client_command_cumode+B5j
		movzx	ecx, word ptr [clients+0Eh]
		mov	ecx, [eax+ecx]
		jmp	loc_62B983EA
; ---------------------------------------------------------------------------

loc_62B9859C:				; CODE XREF: _silc_client_command_cumode+194j
		mov	edi, [ebp+client]
		mov	ecx, [edi+18h]
		mov	ecx, [ecx+48h]
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 19h
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edi
		call	dword ptr [ecx+10h]
		xor	edx, edx
clients	= edx				; SilcDList
		jmp	out
; ---------------------------------------------------------------------------
cp = ecx				; unsigned __int8 *
i = edi					; int
		align 4

loc_62B985D8:				; CODE XREF: _silc_client_command_cumode+138j
		movzx	eax, al
		jmp	ds:off_62BA8CA0[eax*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 4

loc_62B985E4:				; CODE XREF: _silc_client_command_cumode+2B3j
					; DATA XREF: .rdata:off_62BA8CA0o
		mov	eax, [ebp+var_38] ; jumptable 62B985DB case 20
		test	eax, eax
		jz	loc_62B98940
		or	[ebp+mode], 8
		nop

loc_62B985F4:				; CODE XREF: _silc_client_command_cumode+4E3j
					; _silc_client_command_cumode+4F7j ...
		inc	i
		mov	eax, i
		cmp	[ebp+var_3C], i
		ja	loc_62B98458

loc_62B98600:				; CODE XREF: _silc_client_command_cumode+76Ej
len = ecx				; SilcUInt32
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		mov	[ebp+client_list], edx
		call	_silc_id_payload_encode
		mov	ecx, eax
chidp =	ecx				; SilcBuffer
		mov	eax, [ebp+mode]
		shr	eax, 18h
		mov	[ebp+modebuf], al
		mov	eax, [ebp+mode]
		shr	eax, 10h
		mov	[ebp+modebuf+1], al
		mov	eax, [ebp+mode]
		shr	eax, 8
		mov	[ebp+modebuf+2], al
		mov	al, byte ptr [ebp+mode]
		mov	[ebp+modebuf+3], al
		mov	dword ptr [esp+4], 2
		mov	eax, [ebp+client_entry]
		add	eax, 38Ch
		mov	[esp], eax
		mov	[ebp+sb], chidp
		call	_silc_id_payload_encode
		mov	i, eax
clidp =	edi				; SilcBuffer
		mov	edx, [ebp+auth]
		test	edx, edx
		mov	edx, [ebp+client_list]
		mov	ecx, [ebp+sb]
		jz	loc_62B98B65
		mov	eax, [ebp+auth]
		mov	eax, [eax+4]
		mov	[ebp+client_entry], eax
		mov	eax, [ebp+auth]
		mov	eax, [eax+8]
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+client_entry]
		sub	[ebp+var_5C], eax

loc_62B98684:				; CODE XREF: _silc_client_command_cumode+84Bj
		test	clidp, clidp
		jz	loc_62B98B52
		mov	eax, [clidp+4]
		mov	[ebp+pass], eax
		mov	eax, [clidp+8]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+pass]
		sub	[ebp+var_38], eax

loc_62B9869E:				; CODE XREF: _silc_client_command_cumode+838j
		test	ecx, ecx
chidp =	ecx				; SilcBuffer
		jz	loc_62B98B3F
		mov	eax, [chidp+4]
		mov	[ebp+var_3C], eax
		mov	eax, [chidp+8]
		mov	[ebp+mode], eax
		mov	eax, [ebp+var_3C]
		sub	[ebp+mode], eax

loc_62B986B8:				; CODE XREF: _silc_client_command_cumode+825j
		mov	eax, [ebp+auth]
		test	eax, eax
		jz	loc_62B98A9B
		mov	eax, [ebp+var_5C]
		mov	[esp+44h], eax
		mov	eax, [ebp+client_entry]
		mov	[esp+40h], eax
		mov	dword ptr [esp+3Ch], 4
		mov	eax, [ebp+var_38]
		mov	[esp+38h], eax
		mov	eax, [ebp+pass]
		mov	[esp+34h], eax
		mov	dword ptr [esp+30h], 3
		mov	dword ptr [esp+2Ch], 4
		lea	eax, [ebp+modebuf]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	eax, [ebp+mode]
		mov	[esp+20h], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 4 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+client_list], edx
		mov	[ebp+sb], chidp
		call	_silc_client_command_send_va
		mov	ecx, [ebp+sb]
		mov	eax, ecx	; sb
chidp =	ecx				; SilcBuffer
		call	_silc_buffer_free_0
		mov	eax, clidp	; sb
		call	_silc_buffer_free_0
		mov	eax, [ebp+auth]	; sb
		call	_silc_buffer_free_0
		mov	edx, [ebp+client_list]

loc_62B9876A:				; CODE XREF: _silc_client_command_cumode+812j
		mov	eax, [ebp+nickname]
		mov	[esp], eax
		mov	[ebp+client_list], edx
		call	_silc_free
		mov	edx, [ebp+client_list]
		mov	[esp+8], edx	; client_list
clients	= edx				; SilcDList
		mov	[esp+4], conn	; conn
		mov	clients, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_list_free
		mov	ecx, [ebp+channel]
		mov	[esp+8], ecx	; channel_entry
		mov	[esp+4], conn	; conn
		mov	clidp, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_unref_channel
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B98583
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
cp = ecx				; unsigned __int8 *
i = edi					; int
		align 4

loc_62B987FC:				; CODE XREF: _silc_client_command_cumode+2B3j
					; DATA XREF: .rdata:off_62BA8CA0o
		mov	eax, [ebp+var_38] ; jumptable 62B985DB case 17
		test	eax, eax
		jz	loc_62B98934
		or	[ebp+mode], 10h
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------

loc_62B98810:				; CODE XREF: _silc_client_command_cumode+2B3j
					; DATA XREF: .rdata:off_62BA8CA0o
		mov	eax, [ebp+var_38] ; jumptable 62B985DB case 16
		test	eax, eax
		jz	loc_62B98970
		or	[ebp+mode], 20h
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------

loc_62B98824:				; CODE XREF: _silc_client_command_cumode+2B3j
					; DATA XREF: .rdata:off_62BA8CA0o
		mov	eax, [ebp+var_38] ; jumptable 62B985DB case 14
		test	eax, eax
		jz	loc_62B98964
		or	[ebp+mode], 2
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------

loc_62B98838:				; CODE XREF: _silc_client_command_cumode+2B3j
					; DATA XREF: .rdata:off_62BA8CA0o
		mov	eax, [ebp+var_38] ; jumptable 62B985DB case 1
		test	eax, eax
		jz	loc_62B9897C
		or	[ebp+mode], 4
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------

loc_62B9884C:				; CODE XREF: _silc_client_command_cumode+2B3j
					; DATA XREF: .rdata:off_62BA8CA0o
		mov	eax, [ebp+var_38] ; jumptable 62B985DB case 5
		test	eax, eax
		jz	loc_62B98958
		mov	eax, [conn+34h]
		mov	[ebp+pass], eax
		mov	[ebp+pubkey], eax
		mov	eax, [conn+38h]
		mov	[ebp+auth], eax
		mov	[ebp+privkey], eax
		mov	eax, [fsm_context_0+38h]
		cmp	eax, 5
		jbe	short loc_62B988D4
		cmp	eax, 6
		jnz	loc_62B98A08
		mov	eax, [fsm_context_0+3Ch]
		mov	[ebp+auth], eax
		mov	[ebp+pass], offset byte_62BA8AE3

loc_62B98887:				; CODE XREF: _silc_client_command_cumode+6ECj
		lea	eax, [ebp+privkey]
		mov	[esp+10h], eax
		lea	eax, [ebp+pubkey]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+pass]
		mov	[esp+8], eax
		mov	eax, [ebp+auth]
		mov	eax, [eax+14h]
		mov	[esp+4], eax
		mov	eax, [ebp+auth]
		mov	eax, [eax+10h]
		mov	[esp], eax
		mov	[ebp+client_list], edx
		mov	[ebp+sb], cp
		call	_silc_load_key_pair
		test	al, al
		mov	edx, [ebp+client_list]
		mov	ecx, [ebp+sb]
		jz	loc_62B98B78
		mov	eax, [ebp+privkey]
		mov	[ebp+auth], eax
		mov	eax, [ebp+pubkey]
		mov	[ebp+pass], eax

loc_62B988D4:				; CODE XREF: _silc_client_command_cumode+547j
cp = ecx				; unsigned __int8 *
		mov	dword ptr [esp+14h], 2
		mov	eax, [conn+4]
		mov	[esp+10h], eax
		mov	eax, [conn+54h]
		mov	eax, [eax+0F0h]
		mov	[esp+0Ch], eax
		mov	eax, [conn+4Ch]
		mov	eax, [eax+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+auth]
		mov	[esp+4], eax
		mov	eax, [ebp+pass]
		mov	[esp], eax
		mov	[ebp+client_list], edx
		mov	[ebp+sb], cp
		call	_silc_auth_public_key_auth_generate
		mov	[ebp+auth], eax
		or	[ebp+mode], 1
		mov	edx, [ebp+client_list]
		mov	ecx, [ebp+sb]
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------

loc_62B98924:				; CODE XREF: _silc_client_command_cumode+2B3j
					; DATA XREF: .rdata:off_62BA8CA0o
cp = ecx				; unsigned __int8 * ; jumptable	62B985DB case 0
		mov	eax, [ebp+var_38]
		test	eax, eax
		jz	short loc_62B9894C
		or	[ebp+mode], 1Fh
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------

loc_62B98934:				; CODE XREF: _silc_client_command_cumode+4D9j
		and	[ebp+mode], 0FFFFFFEFh
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------
		align 10h

loc_62B98940:				; CODE XREF: _silc_client_command_cumode+2C1j
		and	[ebp+mode], 0FFFFFFF7h
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------
		align 4

loc_62B9894C:				; CODE XREF: _silc_client_command_cumode+601j
		mov	[ebp+mode], 0
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------

loc_62B98958:				; CODE XREF: _silc_client_command_cumode+529j
		and	[ebp+mode], 0FFFFFFFEh
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------
		align 4

loc_62B98964:				; CODE XREF: _silc_client_command_cumode+501j
		and	[ebp+mode], 0FFFFFFFDh
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------
		align 10h

loc_62B98970:				; CODE XREF: _silc_client_command_cumode+4EDj
		and	[ebp+mode], 0FFFFFFDFh
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------
		align 4

loc_62B9897C:				; CODE XREF: _silc_client_command_cumode+515j
		and	[ebp+mode], 0FFFFFFFBh
		jmp	loc_62B985F4
; ---------------------------------------------------------------------------
clients	= eax				; SilcDList
		align 4

loc_62B98988:				; CODE XREF: _silc_client_command_cumode+9Aj
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	short loc_62B98A19

loc_62B9899D:				; CODE XREF: _silc_client_command_cumode+71Dj
		mov	[esp+14h], fsm_context_0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_command_resolve_continue ; completion
		mov	dword ptr [esp+0Ch], 0 ; server
		mov	eax, [ebp+nickname]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_get_clients
		mov	eax, [ebp+fsm]
		mov	dl, [eax+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		shl	eax, 1
		and	eax, 2
		jmp	loc_62B98583
; ---------------------------------------------------------------------------
clients	= edx				; SilcDList
		align 4

loc_62B989E8:				; CODE XREF: _silc_client_command_cumode+ABj
		mov	dword ptr [clients+14h], 0
		mov	[ebp+client_entry], 0
		jmp	loc_62B983F5
; ---------------------------------------------------------------------------
chu = eax				; SilcChannelUser
		align 4

loc_62B989FC:				; CODE XREF: _silc_client_command_cumode+E7j
		mov	[ebp+mode], 0
		jmp	loc_62B9841B
; ---------------------------------------------------------------------------

loc_62B98A08:				; CODE XREF: _silc_client_command_cumode+54Cj
cp = ecx				; unsigned __int8 *
i = edi					; int
		mov	eax, [fsm_context_0+3Ch]
		mov	[ebp+auth], eax
		mov	eax, [eax+18h]
		mov	[ebp+pass], eax
		jmp	loc_62B98887
; ---------------------------------------------------------------------------

loc_62B98A19:				; CODE XREF: _silc_client_command_cumode+673j
		mov	dword ptr [esp+8], 7C4h
		mov	dword ptr [esp+4], offset aCommand_c ; "command.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_5	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B9899D
; ---------------------------------------------------------------------------
		align 4

loc_62B98A4C:				; CODE XREF: _silc_client_command_cumode+52j
		mov	ecx, [fsm_context_0+4]
		mov	eax, [ecx+4Ch]
		mov	edx, [eax+18h]
		mov	edi, [edx+48h]
		mov	edx, [fsm_context_0+3Ch]
		mov	[esp+18h], edx
		mov	edx, [fsm_context_0+38h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 19h
		movzx	edx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ecx
		mov	[esp], eax
		call	dword ptr [edi+10h]
		xor	edx, edx
clients	= edx				; SilcDList
		jmp	out
; ---------------------------------------------------------------------------

loc_62B98A8F:				; CODE XREF: _silc_client_command_cumode+117j
len = ecx				; SilcUInt32
		mov	[ebp+auth], 0
		jmp	loc_62B98600
; ---------------------------------------------------------------------------

loc_62B98A9B:				; CODE XREF: _silc_client_command_cumode+395j
clidp =	edi				; SilcBuffer
chidp =	ecx				; SilcBuffer
		mov	eax, [ebp+var_5C]
		mov	[esp+44h], eax
		mov	eax, [ebp+client_entry]
		mov	[esp+40h], eax
		mov	dword ptr [esp+3Ch], 4
		mov	eax, [ebp+var_38]
		mov	[esp+38h], eax
		mov	eax, [ebp+pass]
		mov	[esp+34h], eax
		mov	dword ptr [esp+30h], 3
		mov	dword ptr [esp+2Ch], 4
		lea	eax, [ebp+modebuf]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	eax, [ebp+mode]
		mov	[esp+20h], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 3 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+client_list], edx
		mov	[ebp+sb], chidp
		call	_silc_client_command_send_va
		mov	ecx, [ebp+sb]
		mov	eax, ecx	; sb
chidp =	ecx				; SilcBuffer
		call	_silc_buffer_free_0
		mov	eax, clidp	; sb
		call	_silc_buffer_free_0
		mov	edx, [ebp+client_list]
		jmp	loc_62B9876A
; ---------------------------------------------------------------------------

loc_62B98B3F:				; CODE XREF: _silc_client_command_cumode+378j
chidp =	ecx				; SilcBuffer
		mov	[ebp+mode], 0
		mov	[ebp+var_3C], 0
		jmp	loc_62B986B8
; ---------------------------------------------------------------------------

loc_62B98B52:				; CODE XREF: _silc_client_command_cumode+35Ej
		mov	[ebp+var_38], 0
		mov	[ebp+pass], 0
		jmp	loc_62B9869E
; ---------------------------------------------------------------------------

loc_62B98B65:				; CODE XREF: _silc_client_command_cumode+33Ej
		mov	[ebp+var_5C], 0
		mov	[ebp+client_entry], 0
		jmp	loc_62B98684
; ---------------------------------------------------------------------------

loc_62B98B78:				; CODE XREF: _silc_client_command_cumode+59Aj
i = edi					; int
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aCouldNotLoadKe ; "Could not load key pair,	check your arg"...
		mov	dword ptr [esp+8], 3
		mov	[esp+4], conn
		mov	ecx, [conn+4Ch]
		mov	[esp], ecx
		mov	[ebp+client_list], edx
		call	dword ptr [eax]
		mov	i, [fsm_context_0+4]
		mov	ecx, [edi+4Ch]
		mov	eax, [ecx+18h]
		mov	eax, [eax+48h]
		mov	[ebp+mode], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp+18h], eax
		mov	eax, [fsm_context_0+38h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 1Dh
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edi
		mov	[esp], ecx
		mov	ecx, [ebp+mode]
		call	dword ptr [ecx+10h]
		mov	edx, [ebp+client_list]
		jmp	out
_silc_client_command_cumode endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  26. silc_client_command_cmode

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_cmode(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_cmode
_silc_client_command_cmode proc	near	; DATA XREF: _silc_client_commands_unregister+B45o
					; _silc_client_commands_register+7BFo

var_6C		= dword	ptr -6Ch
var_5C		= dword	ptr -5Ch
sb		= dword	ptr -58h
var_54		= dword	ptr -54h
conn		= dword	ptr -50h
chadd		= dword	ptr -4Ch
auth		= dword	ptr -48h
channel		= dword	ptr -44h
client		= dword	ptr -40h
len		= dword	ptr -3Ch
var_38		= dword	ptr -38h
type		= dword	ptr -34h
var_30		= dword	ptr -30h
mode		= dword	ptr -2Ch
chpk		= dword	ptr -28h
privkey		= dword	ptr -24h
tmp		= byte ptr -20h
modebuf		= byte ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0BCh
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	eax, [ebx+38h]
		cmp	eax, 2
		jbe	loc_62B98FE0
fsm_context_0 =	ebx			; void *
		mov	edx, [fsm_context_0+3Ch]
		mov	ecx, [edx+4]
		cmp	byte ptr [ecx],	2Ah
		jz	loc_62B98D18
		mov	[esp+8], ecx	; channel
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; len
		call	_silc_client_get_channel
		mov	[ebp+channel], eax
		test	eax, eax
		jz	loc_62B99511

loc_62B98C41:				; CODE XREF: _silc_client_command_cmode+14Cj
		mov	eax, [ebp+channel]
		mov	eax, [eax+12Ch]
		mov	[ebp+mode], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		xor	edx, edx
		cmp	byte ptr [eax],	2Dh
		setnz	dl
		mov	[ebp+var_38], edx
		inc	eax
		mov	[ebp+var_30], eax
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_30]
cp = edi				; unsigned __int8 *
		repne scasb
		not	ecx
		dec	ecx
		mov	[ebp+len], ecx
		jz	loc_62B995A3
		xor	eax, eax
		xor	edi, edi
i = edi					; int
		xor	ecx, ecx
arg_len	= ecx				; SilcUInt32
		mov	[ebp+type], 0
		mov	[ebp+chadd], 0
		xor	edx, edx
pk = edx				; SilcBuffer
		mov	[ebp+auth], 0
		mov	[ebp+conn], conn
		mov	conn, fsm_context_0
		mov	[ebp+var_6C], pk
fsm_context_0 =	esi			; void *
arg = edx				; unsigned __int8 *
		nop

loc_62B98CA0:				; CODE XREF: _silc_client_command_cmode+46Aj
		mov	ebx, [ebp+var_30]
		mov	al, [ebx+eax]
		sub	eax, 43h
		cmp	al, 31h		; switch 50 cases
		jbe	loc_62B98D44

loc_62B98CB1:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	ebx, fsm_context_0 ; jumptable 62B98D47	default	case
		mov	fsm_context_0, [ebp+conn]
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	arg, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	arg_len, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	i, [fsm_context_0+3Ch]
		mov	[esp+18h], edi
		mov	edi, [fsm_context_0+38h]
		mov	[esp+14h], edi
		mov	dword ptr [esp+10h], 25h
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]

out:					; CODE XREF: _silc_client_command_cmode+455j
					; _silc_client_command_cmode+65Bj ...
		mov	edi, [ebp+channel]
		mov	[esp+8], edi	; channel_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	eax, 3

loc_62B98D0D:				; CODE XREF: _silc_client_command_cmode+75Ej
					; _silc_client_command_cmode+ADEj
chidp =	edi				; SilcBuffer
		add	esp, 0BCh
		pop	ebx
		pop	conn
		pop	chidp
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B98D18:				; CODE XREF: _silc_client_command_cmode+2Dj
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	ecx, [conn+30h]
		mov	[ebp+channel], ecx
		test	ecx, ecx
		jz	loc_62B99218
		mov	eax, [ebp+channel]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_ref_channel
		jmp	loc_62B98C41
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
arg = edx				; unsigned __int8 *
arg_len	= ecx				; SilcUInt32
i = edi					; int
		align 4

loc_62B98D44:				; CODE XREF: _silc_client_command_cmode+BBj
		movzx	eax, al
		jmp	ds:off_62BA8D5C[eax*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 10h

loc_62B98D50:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	ebx, [ebp+var_38] ; jumptable 62B98D47 case 49
		test	ebx, ebx
		jz	loc_62B991E8
		or	[ebp+mode], 10h
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B98D64:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	eax, [ebp+var_38] ; jumptable 62B98D47 case 48
		test	eax, eax
		jz	loc_62B991DC
		or	[ebp+mode], 2
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B98D78:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	ebx, [ebp+var_38] ; jumptable 62B98D47 case 45
		test	ebx, ebx
		jz	loc_62B991D0
		or	[ebp+mode], 1
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B98D8C:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	eax, [ebp+var_38] ; jumptable 62B98D47 case 42
		test	eax, eax
		jz	loc_62B991C4
		or	[ebp+mode], 400h
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 4

loc_62B98DA4:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	eax, [ebp+var_38] ; jumptable 62B98D47 case 41
		test	eax, eax
		jz	loc_62B99200
		cmp	dword ptr [fsm_context_0+38h], 3
		jbe	loc_62B99552
		or	[ebp+mode], 20h
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+0Ch]
		mov	[esp], eax	; char *
		call	_atoi
		mov	edx, eax
ll = eax				; int
		sar	edx, 18h
		mov	[ebp+tmp], dl
		mov	edx, ll
		sar	edx, 10h
		mov	[ebp+tmp+1], dl
		mov	edx, ll
		sar	edx, 8
		mov	[ebp+tmp+2], dl
		mov	[ebp+tmp+3], al
		mov	ecx, 4
arg_len	= ecx				; SilcUInt32
		mov	[ebp+type], 3
		lea	edx, [ebp+tmp]
arg = edx				; unsigned __int8 *
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 4

loc_62B98DFC:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	ebx, [ebp+var_38] ; jumptable 62B98D47 case 40
		test	ebx, ebx
		jz	loc_62B991F4
		or	[ebp+mode], 4
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B98E10:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	eax, [ebp+var_38] ; jumptable 62B98D47 case 38
		test	eax, eax
		jz	loc_62B9920C
		or	[ebp+mode], 8
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B98E24:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	ebx, [ebp+var_38] ; jumptable 62B98D47 case 37
		test	ebx, ebx
		jz	loc_62B991B8
		cmp	dword ptr [fsm_context_0+38h], 3
		jbe	loc_62B99552
		or	[ebp+mode], 100h
		mov	eax, [fsm_context_0+3Ch]
		mov	arg, [eax+0Ch]
		mov	eax, [fsm_context_0+40h]
		mov	arg_len, [eax+0Ch]
		mov	[ebp+type], 6
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B98E58:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	eax, [ebp+var_38] ; jumptable 62B98D47 case 35
		test	eax, eax
		jz	loc_62B991AC
		mov	arg, [ebp+conn]
		mov	eax, [edx+34h]
		mov	[ebp+chpk], eax
		mov	edx, [edx+38h]
		mov	[ebp+privkey], edx
		mov	edx, [fsm_context_0+38h]
		cmp	edx, 4
		jbe	short loc_62B98EBA
		cmp	edx, 5
		jnz	loc_62B99250
		mov	eax, [fsm_context_0+3Ch]
		mov	edx, offset byte_62BA8AE3

loc_62B98E8B:				; CODE XREF: _silc_client_command_cmode+666j
pass = edx				; char *
		lea	ebx, [ebp+privkey]
		mov	[esp+10h], ebx
		lea	arg_len, [ebp+chpk]
		mov	[esp+0Ch], ecx
		mov	[esp+8], pass
		mov	pass, [eax+10h]
		mov	[esp+4], edx
		mov	eax, [eax+0Ch]
		mov	[esp], eax
		call	_silc_load_key_pair
		test	al, al
		jz	loc_62B996D3
		mov	eax, [ebp+chpk]

loc_62B98EBA:				; CODE XREF: _silc_client_command_cmode+288j
arg_len	= ecx				; SilcUInt32
		or	[ebp+mode], 200h
		mov	[esp], eax
		call	_silc_public_key_payload_encode
		mov	[ebp+var_6C], eax
		mov	dword ptr [esp+14h], 2
		mov	edx, [ebp+conn]
		mov	eax, [edx+4]
		mov	[esp+10h], eax
		mov	eax, [edx+54h]
		mov	eax, [eax+0F0h]
		mov	[esp+0Ch], eax
		mov	eax, [edx+4Ch]
		mov	eax, [eax+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+privkey]
		mov	[esp+4], eax
		mov	eax, [ebp+chpk]
		mov	[esp], eax
		call	_silc_auth_public_key_auth_generate
		mov	[ebp+auth], eax
		mov	edx, [eax+4]
arg = edx				; unsigned __int8 *
		mov	ecx, [eax+8]
arg_len	= ecx				; SilcUInt32
		sub	arg_len, arg
		mov	[ebp+type], 7
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 10h

loc_62B98F20:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	eax, [ebp+var_38] ; jumptable 62B98D47 case 32
		test	eax, eax
		jz	loc_62B991A0
		cmp	dword ptr [fsm_context_0+38h], 3
		jbe	loc_62B99552
		or	[ebp+mode], 80h
		mov	eax, [fsm_context_0+3Ch]
		mov	arg, [eax+0Ch]
		mov	eax, [fsm_context_0+40h]
		mov	arg_len, [eax+0Ch]
		mov	[ebp+type], 5
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B98F54:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	ebx, [ebp+var_38] ; jumptable 62B98D47 case 30
		test	ebx, ebx
		jz	loc_62B99194
		cmp	dword ptr [fsm_context_0+38h], 3
		jbe	loc_62B99552
		or	[ebp+mode], 40h
		mov	eax, [fsm_context_0+3Ch]
		mov	arg, [eax+0Ch]
		mov	eax, [fsm_context_0+40h]
		mov	arg_len, [eax+0Ch]
		mov	[ebp+type], 4
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 4

loc_62B98F88:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	ebx, [ebp+var_38] ; jumptable 62B98D47 case 10
		test	ebx, ebx
		jz	loc_62B99188
		or	[ebp+mode], 800h
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 10h

loc_62B98FA0:				; CODE XREF: _silc_client_command_cmode+157j
					; DATA XREF: .rdata:off_62BA8D5Co
		mov	ebx, [ebp+var_38] ; jumptable 62B98D47 case 0
		test	ebx, ebx
		jz	loc_62B9904C
		mov	[ebp+chpk], 0
		cmp	dword ptr [fsm_context_0+38h], 3
		jz	loc_62B995F5
		ja	loc_62B99354

loc_62B98FC2:				; CODE XREF: _silc_client_command_cmode+795j
					; _silc_client_command_cmode+91Cj
		or	[ebp+mode], 1000h
		mov	arg_len, [ebp+auth]
		mov	arg, [ecx+4]
pk = ebx				; SilcBuffer
		mov	ecx, [ecx+8]
arg_len	= ecx				; SilcUInt32
		sub	arg_len, arg
		mov	[ebp+type], 9
		jmp	short loc_62B99054
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 10h

loc_62B98FE0:				; CODE XREF: _silc_client_command_cmode+1Ej
		mov	edx, [ebp+client]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageCmodeChan ; "Usage: /CMODE <channel> +|-<modes> [{ <"...
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	edi, [fsm_context_0+3Ch]
		mov	[esp+18h], edi
		mov	edi, [fsm_context_0+38h]
		mov	[esp+14h], edi
		mov	dword ptr [esp+10h], 1Dh
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	[ebp+channel], 0
		jmp	out
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
arg = edx				; unsigned __int8 *
arg_len	= ecx				; SilcUInt32
i = edi					; int
		align 4

loc_62B9904C:				; CODE XREF: _silc_client_command_cmode+3B5j
		and	[ebp+mode], 0FFFFEFFFh
ll = eax				; int
		nop

loc_62B99054:				; CODE XREF: _silc_client_command_cmode+16Fj
					; _silc_client_command_cmode+183j ...
		inc	i
		mov	ll, i
		cmp	[ebp+len], i
		ja	loc_62B98CA0
		mov	[ebp+chadd], arg
		mov	arg, [ebp+var_6C]
pk = edx				; SilcBuffer
		mov	ebx, fsm_context_0
		mov	fsm_context_0, [ebp+conn]

loc_62B9906B:				; CODE XREF: _silc_client_command_cmode+9CCj
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		mov	[ebp+sb], pk
		mov	[ebp+var_5C], arg_len
		call	_silc_id_payload_encode
		mov	i, eax
chidp =	edi				; SilcBuffer
		mov	eax, [ebp+mode]
		shr	eax, 18h
		mov	[ebp+modebuf], al
		mov	eax, [ebp+mode]
		shr	eax, 10h
		mov	[ebp+modebuf+1], al
		mov	eax, [ebp+mode]
		shr	eax, 8
		mov	[ebp+modebuf+2], al
		mov	al, byte ptr [ebp+mode]
		mov	[ebp+modebuf+3], al
		mov	edx, [ebp+type]
		test	edx, edx
		mov	edx, [ebp+sb]
		mov	ecx, [ebp+var_5C]
		jz	loc_62B9925C
		mov	eax, [ebp+chadd]
		test	eax, eax
		jz	loc_62B9925C
		test	edx, edx
pk = edx				; SilcBuffer
		jz	loc_62B995E2
		mov	eax, [pk+4]
		mov	[ebp+var_38], eax
		mov	eax, [pk+8]
		mov	[ebp+len], eax
		mov	eax, [ebp+var_38]
		sub	[ebp+len], eax

loc_62B990E2:				; CODE XREF: _silc_client_command_cmode+A00j
		test	chidp, chidp
		jz	loc_62B995CF
		mov	eax, [chidp+4]
		mov	[ebp+var_30], eax
		mov	eax, [chidp+8]
		mov	[ebp+mode], eax
		mov	eax, [ebp+var_30]
		sub	[ebp+mode], eax

loc_62B990FC:				; CODE XREF: _silc_client_command_cmode+9EDj
		mov	eax, [ebp+len]
		mov	[esp+44h], eax
		mov	eax, [ebp+var_38]
		mov	[esp+40h], eax
		mov	dword ptr [esp+3Ch], 8
		mov	[esp+38h], ecx
arg_len	= ecx				; SilcUInt32
		mov	arg_len, [ebp+chadd]
		mov	[esp+34h], ecx
		mov	eax, [ebp+type]
		mov	[esp+30h], eax
		mov	dword ptr [esp+2Ch], 4
		lea	eax, [ebp+modebuf]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	ecx, [ebp+mode]
		mov	[esp+20h], ecx
		mov	eax, [ebp+var_30]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 4 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+sb], pk
		call	_silc_client_command_send_va
		mov	edx, [ebp+sb]
		jmp	loc_62B992CB
; ---------------------------------------------------------------------------

loc_62B99188:				; CODE XREF: _silc_client_command_cmode+39Dj
fsm_context_0 =	esi			; void *
arg = edx				; unsigned __int8 *
arg_len	= ecx				; SilcUInt32
i = edi					; int
		and	[ebp+mode], 0FFFFF7FFh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B99194:				; CODE XREF: _silc_client_command_cmode+369j
		and	[ebp+mode], 0FFFFFFBFh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 10h

loc_62B991A0:				; CODE XREF: _silc_client_command_cmode+335j
		and	[ebp+mode], 0FFFFFF7Fh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B991AC:				; CODE XREF: _silc_client_command_cmode+26Dj
		and	[ebp+mode], 0FFFFFDFFh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B991B8:				; CODE XREF: _silc_client_command_cmode+239j
		and	[ebp+mode], 0FFFFFEFFh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B991C4:				; CODE XREF: _silc_client_command_cmode+1A1j
		and	[ebp+mode], 0FFFFFBFFh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------

loc_62B991D0:				; CODE XREF: _silc_client_command_cmode+18Dj
		and	[ebp+mode], 0FFFFFFFEh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 4

loc_62B991DC:				; CODE XREF: _silc_client_command_cmode+179j
		and	[ebp+mode], 0FFFFFFFDh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 4

loc_62B991E8:				; CODE XREF: _silc_client_command_cmode+165j
		and	[ebp+mode], 0FFFFFFEFh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 4

loc_62B991F4:				; CODE XREF: _silc_client_command_cmode+211j
		and	[ebp+mode], 0FFFFFFFBh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 10h

loc_62B99200:				; CODE XREF: _silc_client_command_cmode+1B9j
		and	[ebp+mode], 0FFFFFFDFh
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
		align 4

loc_62B9920C:				; CODE XREF: _silc_client_command_cmode+225j
		and	[ebp+mode], 0FFFFFFF7h
		jmp	loc_62B99054
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B99218:				; CODE XREF: _silc_client_command_cmode+130j
		mov	edi, [ebp+client]
		mov	ecx, [edi+18h]
		mov	ecx, [ecx+48h]
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 19h
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edi
		call	dword ptr [ecx+10h]
		jmp	out
; ---------------------------------------------------------------------------

loc_62B99250:				; CODE XREF: _silc_client_command_cmode+28Dj
fsm_context_0 =	esi			; void *
arg_len	= ecx				; SilcUInt32
i = edi					; int
		mov	eax, [fsm_context_0+3Ch]
		mov	edx, [eax+14h]
pass = edx				; char *
		jmp	loc_62B98E8B
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
chidp =	edi				; SilcBuffer
		align 4

loc_62B9925C:				; CODE XREF: _silc_client_command_cmode+4C7j
					; _silc_client_command_cmode+4D2j
		test	chidp, chidp
		jz	loc_62B995C1
		mov	ecx, [chidp+4]
		mov	[ebp+mode], ecx
		mov	eax, [chidp+8]
		sub	eax, ecx

loc_62B9926F:				; CODE XREF: _silc_client_command_cmode+9DAj
		mov	dword ptr [esp+2Ch], 4
		lea	ecx, [ebp+modebuf]
		mov	[esp+28h], ecx
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], eax
		mov	eax, [ebp+mode]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+sb], edx
		call	_silc_client_command_send_va
		mov	edx, [ebp+sb]

loc_62B992CB:				; CODE XREF: _silc_client_command_cmode+593j
		mov	eax, chidp	; sb
		mov	[ebp+sb], edx
		call	_silc_buffer_free_0
		mov	eax, [ebp+auth]	; sb
		call	_silc_buffer_free_0
		mov	edx, [ebp+sb]
		mov	eax, edx	; sb
pk = edx				; SilcBuffer
		call	_silc_buffer_free_0
		mov	edx, [ebp+channel]
		mov	[esp+8], edx	; channel_entry
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_channel
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	ebx, [ebp+fsm]
		mov	[esp], ebx
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B98D0D
; ---------------------------------------------------------------------------
fsm_context_0 =	esi			; void *
arg = edx				; unsigned __int8 *
arg_len	= ecx				; SilcUInt32
i = edi					; int
		align 4

loc_62B99354:				; CODE XREF: _silc_client_command_cmode+3CCj
		call	_T_337
		mov	[ebp+auth], eax
		mov	dword ptr [esp+0Ch], 1Dh
		mov	eax, [fsm_context_0+38h]
		sub	eax, 3
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	edx, [ebp+auth]
		mov	[esp], edx
		call	_silc_buffer_format
		cmp	dword ptr [fsm_context_0+38h], 3
		jbe	loc_62B98FC2
		mov	eax, 3
		mov	byte ptr [ebp+chadd], 0
		mov	edx, 3
k = edx					; int
		mov	[ebp+var_54], i
		mov	i, k
		mov	ebx, [ebp+var_6C]
pk = ebx				; SilcBuffer
		mov	[ebp+type], fsm_context_0
		mov	fsm_context_0, eax
		jmp	loc_62B99432
; ---------------------------------------------------------------------------
k = edi					; int
		align 4

loc_62B993AC:				; CODE XREF: _silc_client_command_cmode+851j
					; _silc_client_command_cmode+85Bj
		lea	edx, [ebp+chpk]
		mov	[esp+4], edx
		inc	eax
		mov	[esp], eax
		call	_silc_pkcs_load_public_key
		test	al, al
		jz	loc_62B99480
		mov	eax, [ebp+chpk]
		test	eax, eax
		jz	short loc_62B99423
		mov	[esp], eax
		call	_silc_public_key_payload_encode
		mov	pk, eax
		mov	al, byte ptr [ebp+chadd]
		xor	eax, 1
		movzx	eax, al
		test	pk, pk
		jz	short loc_62B99450
		mov	edx, [pk+4]
		mov	[esp+0Ch], eax
		mov	eax, [pk+8]
		sub	eax, edx
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	ecx, [ebp+auth]
		mov	[esp], ecx
		call	_silc_argument_payload_encode_one
		mov	[ebp+auth], eax
		mov	eax, [ebp+chpk]
		mov	[esp], eax
		call	_silc_pkcs_public_key_free
		mov	eax, [pk]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], pk
		call	_silc_free
		xor	pk, pk

loc_62B99423:				; CODE XREF: _silc_client_command_cmode+7D9j
					; _silc_client_command_cmode+88Dj
		inc	k
		mov	esi, k
		mov	eax, [ebp+type]
		cmp	[eax+38h], k
		jbe	loc_62B99504

loc_62B99432:				; CODE XREF: _silc_client_command_cmode+7B6j
		shl	esi, 2
		mov	ecx, [ebp+type]
		mov	eax, [ecx+3Ch]
		mov	eax, [eax+esi]
		cmp	byte ptr [eax],	2Bh
		jnz	loc_62B993AC
		mov	byte ptr [ebp+chadd], 1
		jmp	loc_62B993AC
; ---------------------------------------------------------------------------

loc_62B99450:				; CODE XREF: _silc_client_command_cmode+7F0j
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	edx, [ebp+auth]
		mov	[esp], edx
		call	_silc_argument_payload_encode_one
		mov	[ebp+auth], eax
		mov	eax, [ebp+chpk]
		mov	[esp], eax
		call	_silc_pkcs_public_key_free
		jmp	short loc_62B99423
; ---------------------------------------------------------------------------
		align 10h

loc_62B99480:				; CODE XREF: _silc_client_command_cmode+7CEj
		mov	ecx, esi
		mov	esi, [ebp+conn]
conn = esi				; SilcClientConnection
		mov	pk, [ebp+type]
fsm_context_0 =	ebx			; void *
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	edx, [eax+48h]
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+ecx]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCouldNotLoadPu ; "Could not load public key %s, check the"...
		mov	dword ptr [esp+8], 3
		mov	[esp+4], conn
		mov	eax, [conn+4Ch]
		mov	[esp], eax
		call	dword ptr [edx]
		mov	ecx, [fsm_context_0+4]
		mov	edx, [ecx+4Ch]
		mov	eax, [edx+18h]
		mov	k, [eax+48h]
		mov	eax, [fsm_context_0+3Ch]
		mov	[esp+18h], eax
		mov	eax, [fsm_context_0+38h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 1Dh
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ecx
		mov	[esp], edx
		call	dword ptr [edi+10h]
		mov	eax, [ebp+auth]	; sb
		call	_silc_buffer_free_0
		jmp	out
; ---------------------------------------------------------------------------
pk = ebx				; SilcBuffer
k = edi					; int
		align 4

loc_62B99504:				; CODE XREF: _silc_client_command_cmode+83Cj
		mov	k, [ebp+var_54]
i = edi					; int
		mov	[ebp+var_6C], pk
		mov	esi, eax
fsm_context_0 =	esi			; void *
		jmp	loc_62B98FC2
; ---------------------------------------------------------------------------

loc_62B99511:				; CODE XREF: _silc_client_command_cmode+4Bj
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	ecx, [fsm_context_0+4]
		mov	eax, [ecx+4Ch]
		mov	edx, [eax+18h]
		mov	edi, [edx+48h]
		mov	edx, [fsm_context_0+3Ch]
		mov	[esp+18h], edx
		mov	edx, [fsm_context_0+38h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 19h

loc_62B99533:				; CODE XREF: _silc_client_command_cmode+9B1j
		movzx	edx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ecx
		mov	[esp], eax
		call	dword ptr [edi+10h]
		jmp	out
; ---------------------------------------------------------------------------

loc_62B99552:				; CODE XREF: _silc_client_command_cmode+1C3j
					; _silc_client_command_cmode+243j ...
fsm_context_0 =	esi			; void *
arg = edx				; unsigned __int8 *
arg_len	= ecx				; SilcUInt32
i = edi					; int
		mov	ebx, fsm_context_0
		mov	fsm_context_0, [ebp+conn]
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageCmodeChan ; "Usage: /CMODE <channel> +|-<modes> [{ <"...
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	arg, [conn+4Ch]
		mov	[esp], edx

loc_62B9957D:				; CODE XREF: _silc_client_command_cmode+B0Ej
		call	dword ptr [eax]
		mov	ecx, [fsm_context_0+4]
		mov	eax, [ecx+4Ch]
		mov	edx, [eax+18h]
		mov	i, [edx+48h]
		mov	edx, [fsm_context_0+3Ch]
		mov	[esp+18h], edx
		mov	edx, [fsm_context_0+38h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 1Dh
		jmp	short loc_62B99533
; ---------------------------------------------------------------------------

loc_62B995A3:				; CODE XREF: _silc_client_command_cmode+84j
		xor	ecx, ecx
arg_len	= ecx				; SilcUInt32
		mov	[ebp+type], 0
		mov	[ebp+chadd], 0
		xor	edx, edx
pk = edx				; SilcBuffer
		mov	[ebp+auth], 0
		jmp	loc_62B9906B
; ---------------------------------------------------------------------------

loc_62B995C1:				; CODE XREF: _silc_client_command_cmode+66Ej
chidp =	edi				; SilcBuffer
		xor	eax, eax
		mov	[ebp+mode], 0
		jmp	loc_62B9926F
; ---------------------------------------------------------------------------

loc_62B995CF:				; CODE XREF: _silc_client_command_cmode+4F4j
pk = edx				; SilcBuffer
		mov	[ebp+mode], 0
		mov	[ebp+var_30], 0
		jmp	loc_62B990FC
; ---------------------------------------------------------------------------

loc_62B995E2:				; CODE XREF: _silc_client_command_cmode+4DAj
		mov	[ebp+len], 0
		mov	[ebp+var_38], 0
		jmp	loc_62B990E2
; ---------------------------------------------------------------------------

loc_62B995F5:				; CODE XREF: _silc_client_command_cmode+3C6j
fsm_context_0 =	esi			; void *
arg = edx				; unsigned __int8 *
arg_len	= ecx				; SilcUInt32
i = edi					; int
		mov	ebx, fsm_context_0
		mov	fsm_context_0, [ebp+conn]
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		call	_silc_id_payload_encode
		mov	i, eax
chidp =	edi				; SilcBuffer
		test	eax, eax
		jz	loc_62B99703
chidp =	eax				; SilcBuffer
		mov	edx, [chidp+4]
		mov	chidp, [chidp+8]
chidp =	edi				; SilcBuffer
		sub	eax, edx

loc_62B99624:				; CODE XREF: _silc_client_command_cmode+B17j
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		mov	dword ptr [esp+8], 11h ; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		mov	eax, chidp	; sb
		call	_silc_buffer_free_0
		mov	ecx, [ebp+channel]
		mov	[esp+8], ecx	; channel_entry
		mov	[esp+4], conn	; conn
		mov	chidp, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_unref_channel
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B98D0D
; ---------------------------------------------------------------------------

loc_62B996D3:				; CODE XREF: _silc_client_command_cmode+2C1j
fsm_context_0 =	esi			; void *
i = edi					; int
		mov	ebx, fsm_context_0
		mov	fsm_context_0, [ebp+conn]
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aCouldNotLoadKe ; "Could not load key pair,	check your arg"...
		mov	dword ptr [esp+8], 3
		mov	[esp+4], conn
		mov	i, [ebp+client]
		mov	[esp], edi
		jmp	loc_62B9957D
; ---------------------------------------------------------------------------

loc_62B99703:				; CODE XREF: _silc_client_command_cmode+A26j
chidp =	eax				; SilcBuffer
		xor	chidp, chidp
chidp =	edi				; SilcBuffer
		xor	edx, edx
		jmp	loc_62B99624
_silc_client_command_cmode endp

; Exported entry  32. silc_client_command_identify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_identify(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_identify
_silc_client_command_identify proc near	; DATA XREF: _silc_client_commands_unregister+1A5o
					; _silc_client_commands_register+158o

count		= byte ptr -0Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 40h
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [ebx+38h]
		lea	edx, [eax-2]
		cmp	edx, 1
		jbe	short loc_62B99734
fsm_context_0 =	ebx			; void *
		mov	eax, 3
		add	esp, 40h
		pop	fsm_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B99734:				; CODE XREF: _silc_client_command_identify+17j
		cmp	eax, 2
		jz	loc_62B997E4
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	[esp], eax	; char *
		call	_atoi
		mov	edx, eax
c = eax					; int
		sar	edx, 18h
		mov	[ebp+count], dl
		mov	edx, c
		sar	edx, 10h
		mov	[ebp+count+1], dl
		mov	edx, c
		sar	edx, 8
		mov	[ebp+count+2], dl
		mov	[ebp+count+3], al
		mov	dword ptr [esp+2Ch], 4
		lea	c, [ebp+count]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 4
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+4]
		mov	[esp+20h], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va

loc_62B997C5:				; CODE XREF: _silc_client_command_identify+120j
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 40h
		pop	fsm_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B997E4:				; CODE XREF: _silc_client_command_identify+2Bj
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+4]
		mov	[esp+20h], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		jmp	short loc_62B997C5
_silc_client_command_identify endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  91. silc_client_command_whowas

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_whowas(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_command_whowas
_silc_client_command_whowas proc near	; DATA XREF: _silc_client_commands_unregister+F5o
					; _silc_client_commands_register+DDo

count		= byte ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [ebx+38h]
		lea	edx, [eax-2]
		cmp	edx, 1
		jbe	short loc_62B998BC
fsm_context_0 =	ebx			; void *
		mov	eax, [conn+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	dword ptr [esp+0Ch], offset aUsageWhowasNic ; "Usage: /WHOWAS <nickname>[@<server>] [<"...
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], eax
		call	dword ptr [edx]
		mov	ecx, [fsm_context_0+4]
		mov	edx, [ecx+4Ch]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	edi, [eax+10h]
		cmp	dword ptr [fsm_context_0+38h], 2
		sbb	eax, eax
		add	eax, 1Eh
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	[esp+10h], eax
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ecx
		mov	[esp], edx
		call	edi
		mov	eax, 3
		add	esp, 4Ch
		pop	fsm_context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B998BC:				; CODE XREF: _silc_client_command_whowas+18j
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		cmp	eax, 2
		jz	loc_62B999A8
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	[esp], eax	; char *
		call	_atoi
		mov	edx, eax
c = eax					; int
		sar	edx, 18h
		mov	[ebp+count], dl
		mov	edx, c
		sar	edx, 10h
		mov	[ebp+count+1], dl
		mov	edx, c
		sar	edx, 8
		mov	[ebp+count+2], dl
		mov	[ebp+count+3], al
		mov	dword ptr [esp+2Ch], 4
		lea	c, [ebp+count]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 2
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+4]
		mov	[esp+20h], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va

loc_62B9994D:				; CODE XREF: _silc_client_command_whowas+1C0j
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B999A8:				; CODE XREF: _silc_client_command_whowas+8Fj
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+4]
		mov	[esp+20h], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		jmp	loc_62B9994D
_silc_client_command_whowas endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  35. silc_client_command_join

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_join(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_join
_silc_client_command_join proc near	; DATA XREF: _silc_client_command_join+163o
					; _silc_client_commands_unregister+935o ...

var_BC		= dword	ptr -0BCh
var_B0		= dword	ptr -0B0h
conn		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
passphrase_len	= dword	ptr -90h
var_8C		= dword	ptr -8Ch
cauth		= dword	ptr -88h
var_84		= dword	ptr -84h
auth		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
channel		= dword	ptr -70h
client		= dword	ptr -6Ch
pkhash		= byte ptr -64h
pk_len		= dword	ptr -24h
privkey		= dword	ptr -20h
pubkey		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 12Ch
		mov	ebx, [ebp+fsm_context]
		mov	edx, [ebx+4]
conn = edx				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	eax, [ebx+38h]
		cmp	eax, 1
		jbe	short loc_62B99A8C
fsm_context_0 =	ebx			; void *
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+8], eax	; channel
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+conn], conn
		call	_silc_client_get_channel
		mov	[ebp+channel], eax
		test	eax, eax
		mov	edx, [ebp+conn]
		jz	loc_62B99ADC
		mov	eax, [edx]
conn = edx				; SilcClientConnection
		mov	[esp+4], eax	; client_entry
		mov	ecx, [ebp+channel]
		mov	[esp], ecx	; channel
		call	_silc_client_on_channel
		test	eax, eax
		mov	edx, [ebp+conn]
		jz	short loc_62B99ADC

out:					; CODE XREF: _silc_client_command_join+E0j
					; _silc_client_command_join+8F0j
		mov	ecx, [ebp+channel]
		mov	[esp+8], ecx	; channel_entry
		mov	[esp+4], edx	; conn
conn = edx				; SilcClientConnection
		mov	esi, [ebp+client]
		mov	[esp], esi	; client
		call	_silc_client_unref_channel
		mov	eax, 3

loc_62B99A7E:				; CODE XREF: _silc_client_command_join+17Bj
					; _silc_client_command_join+7B2j
		add	esp, 12Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = edx				; SilcClientConnection
		align 4

loc_62B99A8C:				; CODE XREF: _silc_client_command_join+1Ej
		mov	esi, [ebp+client]
		mov	ecx, [esi+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 1Dh
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	edi, [ebp+client]
		mov	[esp], edi
		mov	[ebp+conn], conn
		call	dword ptr [ecx+10h]
		mov	[ebp+channel], 0
		mov	edx, [ebp+conn]
		jmp	short out
; ---------------------------------------------------------------------------
		align 4

loc_62B99ADC:				; CODE XREF: _silc_client_command_join+4Aj
					; _silc_client_command_join+69j
		mov	eax, [edx+54h]
conn = edx				; SilcClientConnection
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		mov	[ebp+conn], conn
		call	_silc_mutex_lock
		mov	edx, [ebp+conn]
		mov	eax, [edx+54h]
conn = edx				; SilcClientConnection
		mov	ecx, [eax+0D8h]
		mov	[eax+0E0h], ecx
		and	byte ptr [eax+0E8h], 0FDh
		mov	eax, [conn+54h]
		xchg	ax, ax

loc_62B99B14:				; CODE XREF: _silc_client_command_join+143j
		mov	ecx, [eax+0E0h]
		test	ecx, ecx
		jz	short loc_62B99B84
		test	byte ptr [eax+0E8h], 2
		jz	short loc_62B99B78
		movzx	esi, word ptr [eax+0E6h]
		mov	esi, [ecx+esi]

loc_62B99B31:				; CODE XREF: _silc_client_command_join+18Aj
		mov	[eax+0E0h], esi
		cmp	byte ptr [ecx+34h], 4
		jnz	short loc_62B99B14
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	dword ptr [esp+0Ch], 493E0h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset _silc_client_command_join
		mov	esi, [ebp+fsm]
		mov	[esp], esi
		call	_silc_fsm_next_later
		mov	eax, 2
		jmp	loc_62B99A7E
; ---------------------------------------------------------------------------

loc_62B99B78:				; CODE XREF: _silc_client_command_join+12Dj
conn = edx				; SilcClientConnection
		movzx	esi, word ptr [eax+0E4h]
		mov	esi, [ecx+esi]
		jmp	short loc_62B99B31
; ---------------------------------------------------------------------------

loc_62B99B84:				; CODE XREF: _silc_client_command_join+124j
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		mov	[ebp+conn], conn
		call	_silc_mutex_unlock
		mov	eax, [fsm_context_0+40h]
		cmp	dword ptr [eax+4], 100h
		mov	edx, [ebp+conn]
		jbe	short loc_62B99BB1
		mov	dword ptr [eax+4], 100h

loc_62B99BB1:				; CODE XREF: _silc_client_command_join+1B0j
		mov	eax, [fsm_context_0+3Ch]
		mov	edi, [eax+4]
		mov	[ebp+var_94], edi
		cmp	dword ptr [fsm_context_0+38h], 2
		jbe	loc_62B9A1E4
		mov	[ebp+var_74], 2
		mov	[ebp+passphrase_len], 0
		mov	esi, 2
i = esi					; int
		mov	[ebp+var_84], 0
		mov	[ebp+var_7C], 0
		mov	[ebp+var_8C], 0
		mov	[ebp+cauth], 0
		mov	[ebp+auth], 0
		lea	ecx, [ebp+pkhash]
		mov	[ebp+var_BC], ecx
		mov	[ebp+var_78], edx
conn = edx				; SilcClientConnection
		jmp	short loc_62B99C34
; ---------------------------------------------------------------------------
i = edx					; int
		align 4

loc_62B99C18:				; CODE XREF: _silc_client_command_join+265j
		mov	ecx, [fsm_context_0+3Ch]
		mov	i, [ecx+i*4]
		mov	[ebp+var_7C], edx
		lea	edx, [esi+2]

loc_62B99C24:				; CODE XREF: _silc_client_command_join+2A1j
					; _silc_client_command_join+311j ...
i = esi					; int
pubdata	= edi				; unsigned __int8 *
		mov	i, edx
		mov	[ebp+var_74], edx
		cmp	edx, eax
		jnb	loc_62B99F40
		mov	eax, [fsm_context_0+3Ch]

loc_62B99C34:				; CODE XREF: _silc_client_command_join+21Dj
conn = edx				; SilcClientConnection
		mov	pubdata, [ebp+var_74]
		shl	edi, 2
		mov	dword ptr [esp+4], offset aCipher ; "-cipher"
		mov	eax, [eax+edi]
		mov	[esp], eax	; char *
		call	_stricmp
		test	eax, eax
		jnz	loc_62B99D10
		mov	eax, [fsm_context_0+38h]
		lea	edx, [i+1]
i = edx					; int
		cmp	eax, i
		ja	short loc_62B99C18

loc_62B99C5F:				; CODE XREF: _silc_client_command_join+31Bj
		mov	dword ptr [esp+4], offset aHmac	; "-hmac"
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edi]
		mov	[esp], eax	; char *
		mov	[ebp+conn], i
		call	_stricmp
		test	eax, eax
		mov	edx, [ebp+conn]
		jnz	short loc_62B99C9C
		mov	eax, [fsm_context_0+38h]
		cmp	eax, edx
i = edx					; int
		jbe	short loc_62B99C9C
		mov	ecx, [fsm_context_0+3Ch]
		mov	ecx, [ecx+i*4]
		mov	[ebp+var_84], ecx
		inc	i
		jmp	short loc_62B99C24
; ---------------------------------------------------------------------------
		align 4

loc_62B99C9C:				; CODE XREF: _silc_client_command_join+28Bj
					; _silc_client_command_join+292j
		mov	dword ptr [esp+4], offset aFounder ; "-founder"
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edi]
		mov	[esp], eax	; char *
		mov	[ebp+conn], i
		call	_stricmp
		test	eax, eax
		mov	edx, [ebp+conn]
		jnz	short loc_62B99D18
		mov	dword ptr [esp+14h], 2
		mov	esi, [ebp+var_78]
		mov	eax, [esi+4]
		mov	[esp+10h], eax
		mov	eax, [esi+54h]
		mov	eax, [eax+0F0h]
		mov	[esp+0Ch], eax
		mov	eax, [esi+4Ch]
		mov	eax, [eax+10h]
		mov	[esp+8], eax
		mov	eax, [esi+38h]
		mov	[esp+4], eax
		mov	eax, [esi+34h]
		mov	[esp], eax
		call	_silc_auth_public_key_auth_generate
		mov	[ebp+auth], eax
		mov	eax, [fsm_context_0+38h]
		mov	edx, [ebp+conn]
		jmp	loc_62B99C24
; ---------------------------------------------------------------------------
i = esi					; int
		align 10h

loc_62B99D10:				; CODE XREF: _silc_client_command_join+257j
		lea	edx, [i+1]
i = edx					; int
		jmp	loc_62B99C5F
; ---------------------------------------------------------------------------

loc_62B99D18:				; CODE XREF: _silc_client_command_join+2C8j
		mov	dword ptr [esp+4], offset aAuth	; "-auth"
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edi]
		mov	[esp], eax	; char *
		mov	[ebp+conn], edx
		call	_stricmp
		test	eax, eax
		mov	edx, [ebp+conn]
		jnz	loc_62B99E7C
		mov	edi, [ebp+var_78]
		mov	eax, [edi+34h]
		mov	[ebp+pubkey], eax
		mov	ecx, [edi+38h]
		mov	[ebp+privkey], ecx
		mov	ecx, [fsm_context_0+38h]
		lea	edi, [esi+3]
i = esi					; int
		cmp	ecx, edi
		jb	short loc_62B99DA1
		lea	eax, [i+4]
		cmp	ecx, eax
		jnb	loc_62B99F2C
		mov	eax, [fsm_context_0+3Ch]
		mov	ecx, offset byte_62BA8AE3

loc_62B99D6E:				; CODE XREF: _silc_client_command_join+541j
pass = ecx				; char *
		lea	edi, [ebp+privkey]
		mov	[esp+10h], edi
		lea	edi, [ebp+pubkey]
		mov	[esp+0Ch], edi
		mov	[esp+8], pass
		mov	pass, [eax+i*4+8]
		mov	[esp+4], ecx
		mov	eax, [eax+edx*4]
		mov	[esp], eax
		call	_silc_load_key_pair
		test	al, al
		jz	loc_62B9A275
		mov	eax, [ebp+pubkey]
		lea	edx, [i+3]

loc_62B99DA1:				; CODE XREF: _silc_client_command_join+361j
i = esi					; int
		lea	ecx, [ebp+pk_len]
		mov	[esp+4], ecx
		mov	[esp], eax
		mov	[ebp+conn], edx
		call	_silc_pkcs_public_key_encode
		mov	i, eax
pk = esi				; unsigned __int8 *
		lea	edi, [ebp+pkhash]
		mov	[esp+0Ch], edi
		mov	eax, [ebp+pk_len]
		mov	[esp+8], eax
		mov	[esp+4], pk
		mov	ecx, [ebp+var_78]
		mov	eax, [ecx+54h]
		mov	eax, [eax+0F0h]
		mov	[esp], eax
		call	_silc_hash_make
		mov	[esp], pk
		call	_silc_free
		mov	dword ptr [esp+4], 80h
		mov	pk, [ebp+var_78]
		mov	eax, [esi+4Ch]
		mov	eax, [eax+10h]
		mov	[esp], eax
		call	_silc_rng_get_rn_data
		mov	[ebp+var_74], eax
		mov	edi, eax
pubdata	= edi				; unsigned __int8 *
		mov	esi, [ebp+var_BC]
		mov	ecx, 5
		rep movsd
		mov	dword ptr [esp+18h], 2
		mov	pubdata, [ebp+var_78]
		mov	eax, [edi+4]
		mov	[esp+14h], eax
		mov	eax, [edi+54h]
		mov	eax, [eax+0F0h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 80h
		mov	eax, [ebp+var_74]
		mov	[esp+8], eax
		mov	eax, [ebp+privkey]
		mov	[esp+4], eax
		mov	eax, [ebp+pubkey]
		mov	[esp], eax
		call	_silc_auth_public_key_auth_generate_wpub
		mov	[ebp+cauth], eax
		mov	ecx, 80h
		xor	eax, eax
		mov	edi, [ebp+var_74]
pubdata	= edi				; unsigned __int8 *
		rep stosb
		mov	ecx, [ebp+var_74]
		mov	[esp], ecx
		call	_silc_free
		mov	eax, [fsm_context_0+38h]
		mov	edx, [ebp+conn]
		jmp	loc_62B99C24
; ---------------------------------------------------------------------------

loc_62B99E7C:				; CODE XREF: _silc_client_command_join+344j
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+edi]
		mov	[esp+4], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edi]
		mov	[esp], eax
		mov	[ebp+conn], edx
		call	_silc_utf8_valid
		test	al, al
		mov	edx, [ebp+conn]
		jnz	loc_62B9A1B0
		mov	dword ptr [esp+8], 0
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+edi]
		mov	[esp+4], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edi]
		mov	[esp], eax
		call	_silc_utf8_encoded_len
		mov	esi, eax
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	_silc_calloc
		mov	ecx, eax
		mov	[esp+10h], esi
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+edi]
		mov	[esp+4], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edi]
		mov	[esp], eax
		mov	[ebp+var_B0], ecx
		call	_silc_utf8_encode
		mov	[ebp+passphrase_len], eax
		mov	eax, [fsm_context_0+38h]
		mov	ecx, [ebp+var_B0]
		mov	[ebp+var_8C], ecx
		mov	edx, [ebp+conn]
		jmp	loc_62B99C24
; ---------------------------------------------------------------------------
i = esi					; int
		align 4

loc_62B99F2C:				; CODE XREF: _silc_client_command_join+368j
		mov	eax, [fsm_context_0+3Ch]
		mov	i, [ebp+var_74]
		mov	ecx, [eax+esi*4+0Ch]
pass = ecx				; char *
		mov	esi, edx
i = edx					; int
		inc	i
		jmp	loc_62B99D6E
; ---------------------------------------------------------------------------
pubdata	= edi				; unsigned __int8 *
		align 10h

loc_62B99F40:				; CODE XREF: _silc_client_command_join+233j
		mov	i, [ebp+var_78]
conn = edx				; SilcClientConnection
i = esi					; int
		mov	i, [ebp+cauth]
		test	esi, esi
		jz	loc_62B9A210
		mov	esi, [ebp+cauth]
		mov	esi, [esi+4]
		mov	[ebp+var_A0], esi
		mov	pubdata, [ebp+cauth]
		mov	edi, [edi+8]
		sub	edi, esi
		mov	[ebp+var_78], edi

loc_62B99F6E:				; CODE XREF: _silc_client_command_join+833j
pubdata	= edi				; unsigned __int8 *
		mov	ecx, [ebp+auth]
		test	ecx, ecx
		jz	loc_62B9A25F
		mov	eax, [ebp+auth]
		mov	eax, [eax+4]
		mov	[ebp+var_9C], eax
		mov	ecx, [ebp+auth]
		mov	ecx, [ecx+8]
		sub	ecx, eax
		mov	[ebp+var_74], ecx

loc_62B99F90:				; CODE XREF: _silc_client_command_join+878j
		mov	eax, [ebp+var_84]
		test	eax, eax
		jz	loc_62B9A250
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	pubdata, [ebp+var_84]
hmac = edi				; char *
		repne scasb
		not	ecx
		dec	ecx
		mov	[ebp+var_A8], ecx

loc_62B99FB6:				; CODE XREF: _silc_client_command_join+862j
pubdata	= edi				; unsigned __int8 *
		mov	pubdata, [ebp+var_7C]
		test	edi, edi
		jz	loc_62B9A241
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_7C]
cipher = edi				; char *
		repne scasb
		not	ecx
		dec	ecx
		mov	[ebp+var_A4], ecx

loc_62B99FD6:				; CODE XREF: _silc_client_command_join+853j
		mov	eax, [conn+54h]
		mov	eax, [eax+0F4h]
		test	eax, eax
		jz	loc_62B9A230
		mov	esi, [eax+4]
		mov	[ebp+var_98], esi
		mov	esi, [eax+8]
		sub	esi, [ebp+var_98]

loc_62B99FF9:				; CODE XREF: _silc_client_command_join+844j
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_94]
name = edi				; char *
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	edi, [ebp+var_78]
		mov	[esp+68h], edi
		mov	eax, [ebp+var_A0]
		mov	[esp+64h], eax
		mov	dword ptr [esp+60h], 7
		mov	edi, [ebp+var_74]
		mov	[esp+5Ch], edi
		mov	eax, [ebp+var_9C]
		mov	[esp+58h], eax
		mov	dword ptr [esp+54h], 6
		mov	edi, [ebp+var_A8]
		mov	[esp+50h], edi
		mov	eax, [ebp+var_84]
		mov	[esp+4Ch], eax
		mov	dword ptr [esp+48h], 5
		mov	edi, [ebp+var_A4]
		mov	[esp+44h], edi
		mov	eax, [ebp+var_7C]
		mov	[esp+40h], eax
		mov	dword ptr [esp+3Ch], 4
		mov	edi, [ebp+passphrase_len]
		mov	[esp+38h], edi
		mov	eax, [ebp+var_8C]
		mov	[esp+34h], eax
		mov	dword ptr [esp+30h], 3
		mov	[esp+2Ch], esi
		mov	esi, [ebp+var_98]
		mov	[esp+28h], esi
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], ecx
		mov	edi, [ebp+var_94]
		mov	[esp+1Ch], edi
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 7 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+conn], conn
		call	_silc_client_command_send_va
		mov	eax, [ebp+auth]	; sb
		call	_silc_buffer_free_0
		mov	eax, [ebp+cauth] ; sb
		call	_silc_buffer_free_0
		mov	esi, [ebp+var_8C]
		test	esi, esi
		mov	edx, [ebp+conn]
		jz	short loc_62B9A129
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+var_8C]
passphrase = edi			; char *
		xor	eax, eax
		repne scasb
		not	ecx
		dec	ecx
		mov	edi, [ebp+var_8C]
passphrase = edi			; char *
		rep stosb

loc_62B9A129:				; CODE XREF: _silc_client_command_join+715j
		mov	ecx, [ebp+var_8C]
		mov	[esp], ecx
		mov	[ebp+conn], edx
		call	_silc_free
		mov	esi, [ebp+channel]
		mov	[esp+8], esi	; channel_entry
		mov	edx, [ebp+conn]
		mov	[esp+4], edx	; conn
conn = edx				; SilcClientConnection
		mov	passphrase, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_unref_channel
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B99A7E
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
		align 10h

loc_62B9A1B0:				; CODE XREF: _silc_client_command_join+4AAj
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edi]
		mov	[esp], eax	; char *
		mov	[ebp+conn], edx
		call	_strdup
		mov	[ebp+var_8C], eax
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+edi]
		mov	[ebp+passphrase_len], eax
		mov	eax, [fsm_context_0+38h]
		mov	edx, [ebp+conn]
		jmp	loc_62B99C24
; ---------------------------------------------------------------------------

loc_62B9A1E4:				; CODE XREF: _silc_client_command_join+1C9j
		mov	[ebp+auth], 0
		mov	[ebp+var_7C], 0
		mov	[ebp+var_8C], 0
		mov	[ebp+passphrase_len], 0
		mov	[ebp+var_84], 0

loc_62B9A210:				; CODE XREF: _silc_client_command_join+553j
conn = edx				; SilcClientConnection
pubdata	= edi				; unsigned __int8 *
		mov	[ebp+cauth], 0
		mov	[ebp+var_78], 0
		mov	[ebp+var_A0], 0
		jmp	loc_62B99F6E
; ---------------------------------------------------------------------------

loc_62B9A230:				; CODE XREF: _silc_client_command_join+5E9j
		xor	esi, esi
		mov	[ebp+var_98], 0
		jmp	loc_62B99FF9
; ---------------------------------------------------------------------------

loc_62B9A241:				; CODE XREF: _silc_client_command_join+5C3j
		mov	[ebp+var_A4], 0
		jmp	loc_62B99FD6
; ---------------------------------------------------------------------------

loc_62B9A250:				; CODE XREF: _silc_client_command_join+5A0j
pubdata	= edi				; unsigned __int8 *
		mov	[ebp+var_A8], 0
		jmp	loc_62B99FB6
; ---------------------------------------------------------------------------

loc_62B9A25F:				; CODE XREF: _silc_client_command_join+57Bj
		mov	[ebp+var_74], 0
		mov	[ebp+var_9C], 0
		jmp	loc_62B99F90
; ---------------------------------------------------------------------------

loc_62B9A275:				; CODE XREF: _silc_client_command_join+39Dj
i = esi					; int
		mov	edx, [ebp+var_78]
conn = edx				; SilcClientConnection
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aCouldNotLoadKe ; "Could not load key pair,	check your arg"...
		mov	dword ptr [esp+8], 3
		mov	[esp+4], conn
		mov	ecx, [conn+4Ch]
		mov	[esp], ecx
		mov	[ebp+conn], conn
		call	dword ptr [eax]
		mov	i, [fsm_context_0+4]
		mov	eax, [esi+4Ch]
		mov	ecx, [eax+18h]
		mov	edi, [ecx+48h]
		mov	ecx, [fsm_context_0+3Ch]
		mov	[esp+18h], ecx
		mov	ecx, [fsm_context_0+38h]
		mov	[esp+14h], ecx
		mov	dword ptr [esp+10h], 1Dh
		movzx	ecx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], esi
		mov	[esp], eax
		call	dword ptr [edi+10h]
		mov	edx, [ebp+conn]
		jmp	out
_silc_client_command_join endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  45. silc_client_command_ping

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_ping(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_ping
_silc_client_command_ping proc near	; DATA XREF: _silc_client_commands_unregister+7D5o
					; _silc_client_commands_register+558o

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4]
conn = eax				; SilcClientConnection
		mov	edx, [ebx+38h]
		cmp	edx, 1
		jbe	loc_62B9A3C4
fsm_context_0 =	ebx			; void *
		mov	edx, [conn+54h]
		mov	edx, [edx+0F8h]
		test	edx, edx
		jz	loc_62B9A408
		mov	ecx, [edx+4]
		mov	edx, [edx+8]
		sub	edx, ecx

loc_62B9A324:				; CODE XREF: _silc_client_command_ping+11Aj
		mov	[esp+20h], edx
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	edx, byte ptr [fsm_context_0+34h]
		mov	[esp+8], edx	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		call	_silc_time
		mov	[fsm_context_0+60h], eax
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = eax				; SilcClientConnection
		align 4

loc_62B9A3C4:				; CODE XREF: _silc_client_command_ping+15j
		mov	ecx, [conn+4Ch]
		mov	esi, [ecx+18h]
		mov	esi, [esi+48h]
		mov	edi, [fsm_context_0+3Ch]
		mov	[esp+18h], edi
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 1Dh
		movzx	edx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], ecx
		call	dword ptr [esi+10h]
		mov	eax, 3
		add	esp, 3Ch
		pop	fsm_context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = eax				; SilcClientConnection
		align 4

loc_62B9A408:				; CODE XREF: _silc_client_command_ping+26j
		xor	ecx, ecx
		jmp	loc_62B9A324
_silc_client_command_ping endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  46. silc_client_command_quit

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_quit(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_quit
_silc_client_command_quit proc near	; DATA XREF: _silc_client_commands_unregister+515o
					; _silc_client_commands_register+36Co

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+fsm_context]
		mov	edx, [eax+4]
conn = edx				; SilcClientConnection
		cmp	dword ptr [eax+38h], 1
		jbe	loc_62B9A4A8
fsm_context_0 =	eax			; void *
		mov	ecx, [fsm_context_0+40h]
		mov	ecx, [ecx+4]
		mov	[esp+20h], ecx
		mov	ecx, [fsm_context_0+3Ch]
		mov	ecx, [ecx+4]
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	ecx, byte ptr [fsm_context_0+34h]
		mov	[esp+8], ecx	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va

loc_62B9A46E:				; CODE XREF: _silc_client_command_quit+C4j
		mov	dword ptr [esp], 3E8h ;	dwMilliseconds
		call	_Sleep@4
		push	eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 2
		mov	dword ptr [esp+4], offset _silc_client_command_quit_final
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next_later
		mov	eax, 2
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	eax			; void *
conn = edx				; SilcClientConnection
		align 4

loc_62B9A4A8:				; CODE XREF: _silc_client_command_quit+10j
		mov	dword ptr [esp+14h], 0 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	ecx, byte ptr [fsm_context_0+34h]
		mov	[esp+8], ecx	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		jmp	short loc_62B9A46E
_silc_client_command_quit endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  41. silc_client_command_nick

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_nick(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_nick
_silc_client_command_nick proc near	; DATA XREF: _silc_client_command_nick+1A7o
					; _silc_client_commands_unregister+255o ...

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	edi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		cmp	dword ptr [ebx+38h], 1
		jbe	loc_62B9A5A0
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+4], eax
		mov	eax, [conn]
		mov	[esp], eax
		call	_silc_utf8_strcasecmp
		test	al, al
		jnz	loc_62B9A593
		cmp	dword ptr [fsm_context_0+38h], 1
		ja	loc_62B9A60C
		mov	eax, [fsm_context_0+4]
		test	eax, eax
		jz	loc_62B9A764
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	edx, [conn+8]
		mov	[esp+14h], edx
		mov	edx, [conn]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], offset aYourNicknameIs ; "Your nickname is	%s on server %s"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	edx, [conn+4Ch]
		mov	[esp], edx
		call	dword ptr [eax]

loc_62B9A557:				; CODE XREF: _silc_client_command_nick+2B7j
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]

loc_62B9A593:				; CODE XREF: _silc_client_command_nick+32j
conn = esi				; SilcClientConnection
		mov	eax, 3

loc_62B9A598:				; CODE XREF: _silc_client_command_nick+287j
		add	esp, 3Ch
		pop	ebx
		pop	conn
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9A5A0:				; CODE XREF: _silc_client_command_nick+16j
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	edx, [eax+18h]
		mov	edx, [edx+48h]
		mov	dword ptr [esp+0Ch], offset aUsageNickNickn ; "Usage: /NICK <nickname>"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], eax
		call	dword ptr [edx]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B9A60C:				; CODE XREF: _silc_client_command_nick+3Cj
		mov	eax, [conn+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		mov	eax, [conn+54h]
		mov	edx, [eax+0D8h]
		mov	[eax+0E0h], edx
		and	byte ptr [eax+0E8h], 0FDh
		mov	eax, [conn+54h]
		xchg	ax, ax

loc_62B9A638:				; CODE XREF: _silc_client_command_nick+187j
		mov	edx, [eax+0E0h]
		test	edx, edx
		jz	short loc_62B9A6A8
		test	byte ptr [eax+0E8h], 2
		jz	short loc_62B9A69C
		movzx	ecx, word ptr [eax+0E6h]
		mov	ecx, [edx+ecx]

loc_62B9A655:				; CODE XREF: _silc_client_command_nick+1CEj
		mov	[eax+0E0h], ecx
		cmp	byte ptr [edx+34h], 0Eh
		jnz	short loc_62B9A638
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	dword ptr [esp+0Ch], 493E0h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset _silc_client_command_nick
		mov	[esp], fsm_0
		call	_silc_fsm_next_later
		mov	eax, 2
		add	esp, 3Ch
		pop	fsm_context_0
		pop	conn
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9A69C:				; CODE XREF: _silc_client_command_nick+171j
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		movzx	ecx, word ptr [eax+0E4h]
		mov	ecx, [edx+ecx]
		jmp	short loc_62B9A655
; ---------------------------------------------------------------------------

loc_62B9A6A8:				; CODE XREF: _silc_client_command_nick+168j
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	edx, [fsm_context_0+40h]
		mov	eax, [edx+4]
		cmp	eax, 80h
		jbe	short loc_62B9A6CF
		mov	dword ptr [edx+4], 80h
		mov	eax, 80h

loc_62B9A6CF:				; CODE XREF: _silc_client_command_nick+1E9j
		mov	[esp+20h], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B9A598
; ---------------------------------------------------------------------------

loc_62B9A764:				; CODE XREF: _silc_client_command_nick+47j
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	edx, [conn]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], offset aYourNickname_0 ; "Your nickname is	%s"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	edx, [conn+4Ch]
		mov	[esp], edx
		call	dword ptr [eax]
		jmp	loc_62B9A557
_silc_client_command_nick endp

; Exported entry  90. silc_client_command_whois

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_whois(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_whois
_silc_client_command_whois proc	near	; DATA XREF: _silc_client_commands_unregister+45o
					; _silc_client_commands_register+62o

var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
client		= dword	ptr -54h
tmp		= dword	ptr -50h
nick		= byte ptr -49h
conn		= dword	ptr -44h
pubkey		= dword	ptr -40h
details		= dword	ptr -3Ch
obj		= SilcAttributeObjPk ptr -30h
pk		= dword	ptr -24h
nickname	= dword	ptr -20h
count		= byte ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 9Ch
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4]
		mov	[ebp+conn], eax
		mov	edx, [eax+4Ch]
		mov	[ebp+client], edx
		mov	[ebp+nickname],	0
		cmp	dword ptr [ebx+38h], 1
		jbe	loc_62B9ABF6
fsm_context_0 =	ebx			; void *
		mov	edi, 1
		mov	esi, 1
i = esi					; int
		mov	[ebp+pubkey], 0
		mov	[ebp+nick], 0
		mov	byte ptr [ebp+details],	0
		mov	[ebp+tmp], 0
		jmp	short loc_62B9A7F2
; ---------------------------------------------------------------------------
		align 4

loc_62B9A7E4:				; CODE XREF: _silc_client_command_whois+83j
		inc	i
		mov	edi, i
		mov	eax, [fsm_context_0+38h]
		mov	byte ptr [ebp+details],	1

loc_62B9A7EE:				; CODE XREF: _silc_client_command_whois+1FEj
					; _silc_client_command_whois+214j ...
		cmp	eax, edi
		jbe	short loc_62B9A864

loc_62B9A7F2:				; CODE XREF: _silc_client_command_whois+4Cj
					; _silc_client_command_whois+CBj
		lea	edx, ds:0[edi*4]
		mov	dword ptr [esp+4], offset aDetails ; "-details"
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edx]
		mov	[esp], eax	; char *
		mov	[ebp+var_58], edx
		call	_stricmp
		test	eax, eax
		mov	edx, [ebp+var_58]
		jz	short loc_62B9A7E4
		mov	dword ptr [esp+4], offset aPubkey ; "-pubkey"
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edx]
		mov	[esp], eax	; char *
		mov	[ebp+var_58], edx
		call	_stricmp
		test	eax, eax
		mov	edx, [ebp+var_58]
		jnz	loc_62B9A978
		mov	eax, [fsm_context_0+38h]
		mov	[ebp+var_5C], eax
		lea	ecx, [i+1]
		cmp	eax, ecx
		jbe	loc_62B9A97E
		mov	edx, [fsm_context_0+3Ch]
		mov	edi, [edx+edi*4+4]
		mov	[ebp+pubkey], edi
		add	i, 2
		mov	edi, i
		cmp	eax, edi
		ja	short loc_62B9A7F2
		lea	i, [i+0]

loc_62B9A864:				; CODE XREF: _silc_client_command_whois+5Cj
		cmp	byte ptr [ebp+details],	0
		jz	loc_62B9A9B0
		mov	i, [ebp+pubkey]
		test	esi, esi
		jz	loc_62B9ACA7
		mov	dword ptr [esp+2Ch], 0
		mov	dword ptr [esp+28h], 10h
		mov	dword ptr [esp+24h], 0Ah
		mov	dword ptr [esp+20h], 9
		mov	dword ptr [esp+1Ch], 8
		mov	dword ptr [esp+18h], 7
		mov	dword ptr [esp+14h], 6
		mov	dword ptr [esp+10h], 5
		mov	dword ptr [esp+0Ch], 4
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], 2
		mov	dword ptr [esp], 1 ; attribute
		call	_silc_client_attributes_request
		mov	esi, eax

loc_62B9A8DF:				; CODE XREF: _silc_client_command_whois+229j
attrs =	esi				; SilcBuffer
		lea	eax, [ebp+pk]
		mov	[esp+4], eax
		mov	ecx, [ebp+pubkey]
		mov	[esp], ecx
		call	_silc_pkcs_load_public_key
		test	al, al
		jnz	loc_62B9A9C4
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	edx, [ebp+pubkey]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], offset aCouldNotLoadPu ; "Could not load public key %s, check the"...
		mov	dword ptr [esp+8], 3
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx
		mov	edx, [ebp+client]
		mov	[esp], edx
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	attrs, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3

loc_62B9A96C:				; CODE XREF: _silc_client_command_whois+420j
					; _silc_client_command_whois+502j
attrs =	esi				; SilcBuffer
		add	esp, 9Ch
		pop	ebx
		pop	attrs
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
i = esi					; int
		align 4

loc_62B9A978:				; CODE XREF: _silc_client_command_whois+A3j
		mov	eax, [fsm_context_0+38h]
		mov	[ebp+var_5C], eax

loc_62B9A97E:				; CODE XREF: _silc_client_command_whois+B4j
		cmp	i, 1
		jz	short loc_62B9A998
		mov	ecx, [ebp+var_5C]
		dec	ecx
		cmp	edi, ecx
		jz	loc_62B9ABBC
		inc	i
		mov	edi, i
		jmp	loc_62B9A7EE
; ---------------------------------------------------------------------------
		align 4

loc_62B9A998:				; CODE XREF: _silc_client_command_whois+1EDj
		mov	eax, [ebp+var_5C]
		mov	si, 2
		mov	edi, 2
		mov	[ebp+nick], 1
		jmp	loc_62B9A7EE
; ---------------------------------------------------------------------------
i = esi					; int
		align 10h

loc_62B9A9B0:				; CODE XREF: _silc_client_command_whois+D4j
		mov	ecx, [ebp+pubkey]
		test	ecx, ecx
		jz	loc_62B9AA84
		xor	i, i
attrs =	esi				; SilcBuffer
		jmp	loc_62B9A8DF
; ---------------------------------------------------------------------------
		align 4

loc_62B9A9C4:				; CODE XREF: _silc_client_command_whois+15Fj
		mov	eax, [ebp+pk]
		mov	[esp], eax
		call	_silc_pkcs_get_type
		cmp	eax, 2
		jz	loc_62B9ACBA
		jbe	loc_62B9ABA8
		cmp	eax, 3
		jz	loc_62B9ACC6
		cmp	eax, 4
		jnz	loc_62B9ABAF
		mov	[ebp+obj.type],	offset aPgpSignRsa ; "pgp-sign-rsa"

loc_62B9A9F7:				; CODE XREF: _silc_client_command_whois+52Dj
					; _silc_client_command_whois+539j ...
		lea	edi, [ebp+obj]
		lea	eax, [ebp+obj.data_len]
		mov	[esp+4], eax
		mov	eax, [ebp+pk]
		mov	[esp], eax
		call	_silc_pkcs_public_key_encode
		mov	[ebp+obj.data],	eax
		mov	dword ptr [esp+10h], 0Ch
		mov	[esp+0Ch], edi
		mov	dword ptr [esp+8], 2
		mov	dword ptr [esp+4], 0Ch
		mov	[esp], attrs
		call	_silc_attribute_payload_encode
		mov	attrs, eax
		mov	eax, [ebp+obj.data]
		mov	[esp], eax
		call	_silc_free
		cmp	[ebp+nick], 0
		jz	short loc_62B9AA8C

loc_62B9AA46:				; CODE XREF: _silc_client_command_whois+2F6j
		lea	eax, [ebp+nickname]
		mov	[esp+0Ch], eax	; ret_nick
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+8], eax	; nickname
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_nickname_parse
		mov	edx, [ebp+nickname]
		test	edx, edx
		jnz	short loc_62B9AA8C
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp], eax	; char *
		call	_strdup
		mov	[ebp+nickname],	eax
		jmp	short loc_62B9AA8C
; ---------------------------------------------------------------------------
i = esi					; int
		align 4

loc_62B9AA84:				; CODE XREF: _silc_client_command_whois+221j
		xor	i, i

loc_62B9AA86:				; CODE XREF: _silc_client_command_whois+521j
attrs =	esi				; SilcBuffer
		cmp	[ebp+nick], 0
		jnz	short loc_62B9AA46

loc_62B9AA8C:				; CODE XREF: _silc_client_command_whois+2B0j
					; _silc_client_command_whois+2DAj ...
		test	attrs, attrs
		jz	loc_62B9AC9B
		mov	edx, [attrs+4]
		mov	[ebp+details], edx
		mov	attrs, [attrs+8]
		sub	esi, edx

loc_62B9AA9F:				; CODE XREF: _silc_client_command_whois+50Ej
attrs =	esi				; SilcBuffer
		cmp	[ebp+tmp], 1
		sbb	edx, edx
		not	edx
		and	edx, 4
		cmp	[ebp+nick], 0
		jnz	loc_62B9AB8C
		xor	ecx, ecx
		mov	[ebp+pubkey], 0

loc_62B9AABD:				; CODE XREF: _silc_client_command_whois+40Dj
		mov	[esp+38h], attrs
		mov	eax, [ebp+details]
		mov	[esp+34h], eax
		mov	dword ptr [esp+30h], 3
		mov	[esp+2Ch], edx
		mov	edx, [ebp+tmp]
		mov	[esp+28h], edx
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], ecx
		mov	ecx, [ebp+pubkey]
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 3 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	eax, [ebp+conn]
		mov	[esp], eax	; conn
		call	_silc_client_command_send_va
		mov	eax, [ebp+nickname]
		mov	[esp], eax
		call	_silc_free
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 9Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9AB8C:				; CODE XREF: _silc_client_command_whois+31Aj
fsm_context_0 =	ebx			; void *
attrs =	esi				; SilcBuffer
		mov	ecx, [ebp+nickname]
		mov	[ebp+pubkey], ecx
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	edi, [ebp+pubkey]
		repne scasb
		not	ecx
		dec	ecx
		jmp	loc_62B9AABD
; ---------------------------------------------------------------------------
		align 4

loc_62B9ABA8:				; CODE XREF: _silc_client_command_whois+244j
		dec	eax
		jz	loc_62B9ACD2

loc_62B9ABAF:				; CODE XREF: _silc_client_command_whois+256j
		mov	eax, 3
		jmp	loc_62B9A96C
; ---------------------------------------------------------------------------
i = esi					; int
		align 4

loc_62B9ABBC:				; CODE XREF: _silc_client_command_whois+1F5j
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+edx]
		mov	[esp], eax	; char *
		call	_atoi
		mov	edx, eax
c = eax					; int
		sar	edx, 18h
		mov	[ebp+count], dl
		mov	edx, c
		sar	edx, 10h
		mov	[ebp+count+1], dl
		mov	edx, c
		sar	edx, 8
		mov	[ebp+count+2], dl
		mov	[ebp+count+3], al
		inc	i
		mov	edi, i
		mov	c, [fsm_context_0+38h]
		lea	edx, [ebp+count]
		mov	[ebp+tmp], edx
		jmp	loc_62B9A7EE
; ---------------------------------------------------------------------------

loc_62B9ABF6:				; CODE XREF: _silc_client_command_whois+26j
		mov	ecx, eax
		mov	eax, [eax+54h]
		mov	eax, [eax+0F4h]
		mov	edx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, edx
		mov	[esp+20h], eax
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 4
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], ecx	; conn
		call	_silc_client_command_send_va
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62B9A96C
; ---------------------------------------------------------------------------

loc_62B9AC9B:				; CODE XREF: _silc_client_command_whois+2FAj
fsm_context_0 =	ebx			; void *
attrs =	esi				; SilcBuffer
		mov	[ebp+details], 0
		jmp	loc_62B9AA9F
; ---------------------------------------------------------------------------

loc_62B9ACA7:				; CODE XREF: _silc_client_command_whois+DFj
		mov	dword ptr [esp], 0 ; attribute
		call	_silc_client_attributes_request
		mov	esi, eax
attrs =	esi				; SilcBuffer
		jmp	loc_62B9AA86
; ---------------------------------------------------------------------------

loc_62B9ACBA:				; CODE XREF: _silc_client_command_whois+23Ej
		mov	[ebp+obj.type],	offset aSshRsa ; "ssh-rsa"
		jmp	loc_62B9A9F7
; ---------------------------------------------------------------------------

loc_62B9ACC6:				; CODE XREF: _silc_client_command_whois+24Dj
		mov	[ebp+obj.type],	offset aX509v3SignRsa ;	"x509v3-sign-rsa"
		jmp	loc_62B9A9F7
; ---------------------------------------------------------------------------

loc_62B9ACD2:				; CODE XREF: _silc_client_command_whois+415j
		mov	[ebp+obj.type],	offset aSilcRsa_0 ; "silc-rsa"
		jmp	loc_62B9A9F7
_silc_client_command_whois endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  81. silc_client_command_send

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; SilcUInt16 silc_client_command_send(SilcClient client, SilcClientConnection conn, SilcCommand	command, SilcClientCommandReply	reply, void *reply_context, SilcUInt32 argc, ...)
		public _silc_client_command_send
_silc_client_command_send proc near	; CODE XREF: _silc_client_get_clients_i+27Fp
					; _silc_client_get_clients_i+3ADp ...

var_20		= dword	ptr -20h
var_19		= byte ptr -19h
client		= dword	ptr  8
conn		= dword	ptr  0Ch
command		= dword	ptr  10h
reply		= dword	ptr  14h
reply_context	= dword	ptr  18h
argc		= dword	ptr  1Ch
ap		= byte ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, [ebp+conn]
		mov	edi, [ebp+command]
		mov	edx, [ebp+reply]
		mov	ecx, edi
		mov	[ebp+var_19], cl
		test	esi, esi
		jz	loc_62B9ADF8
conn_0 = esi				; SilcClientConnection
command_0 = edi				; SilcCommand
reply_0	= edx				; SilcClientCommandReply
		test	reply_0, reply_0
		jz	loc_62B9ADF8
		mov	dword ptr [esp+4], 68h
		mov	dword ptr [esp], 1
		mov	[ebp+var_20], reply_0
		call	_silc_calloc
		mov	ebx, eax
		test	eax, eax
		mov	edx, [ebp+var_20]
		jz	loc_62B9ADF8
		mov	[eax+4], conn_0
		mov	eax, command_0
		mov	[ebx+34h], al
		mov	eax, [ebx+58h]
		and	eax, 3
		mov	[ebx+58h], eax
		mov	word ptr [ebx+54h], 0
		mov	word ptr [ebx+56h], 0
		mov	byte ptr [ebx+58h], 0
		mov	dword ptr [ebx+50h], 0
		mov	dword ptr [ebx+4Ch], 0
		mov	dword ptr [ebx+48h], 0
		lea	eax, [ebp+ap]
		mov	[esp+10h], eax	; ap
		mov	eax, [ebp+argc]
		mov	[esp+0Ch], eax	; argc
		mov	eax, [ebp+reply_context]
		mov	[esp+8], eax	; reply_context
		mov	[esp+4], edx	; reply
		movzx	eax, [ebp+var_19]
command_0 = eax				; SilcCommand
		mov	[esp], command_0 ; command
		mov	ecx, ebx	; cmd
		mov	edx, conn_0	; conn
		mov	command_0, [ebp+client]	; client
		call	_silc_client_command_send_vap
		mov	[ebx+36h], ax
		test	ax, ax
		jz	short loc_62B9ADE4
		lea	edi, [ebx+8]
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], offset _silc_client_command_destructor
		mov	[esp+8], ebx
		mov	eax, [conn_0+54h]
		add	eax, 40h
		mov	[esp+4], eax
		mov	[esp], edi
		call	_silc_fsm_thread_init
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	[esp], edi
		call	_silc_fsm_start_sync
		mov	ax, [ebx+36h]
		add	esp, 3Ch
		pop	ebx
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = esi				; SilcClientConnection
		align 4

loc_62B9ADE4:				; CODE XREF: _silc_client_command_send+B4j
		mov	[esp], ebx	; cmd
		call	_silc_client_command_free
		xor	eax, eax
		add	esp, 3Ch
		pop	ebx
		pop	conn_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
conn_0 = esi				; SilcClientConnection
command_0 = edi				; SilcCommand
		align 4

loc_62B9ADF8:				; CODE XREF: _silc_client_command_send+19j
					; _silc_client_command_send+21j ...
		xor	eax, eax
		add	esp, 3Ch
		pop	ebx
		pop	conn_0
		pop	command_0
		leave
		retn
_silc_client_command_send endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  31. silc_client_command_getkey

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_getkey(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_command_getkey
_silc_client_command_getkey proc near	; DATA XREF: _silc_client_commands_unregister+1175o
					; _silc_client_commands_register+B0Bo

var_20		= dword	ptr -20h
client		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		cmp	dword ptr [ebx+38h], 1
		jbe	loc_62B9AF68
fsm_context_0 =	ebx			; void *
		mov	dword ptr [esp+0Ch], 0 ; return_all
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_clients_local
		mov	edi, eax
clients	= edi				; SilcDList
		test	eax, eax
		jz	loc_62B9B03C
clients	= eax				; SilcDList
		mov	clients, [clients+14h]
clients	= edi				; SilcDList
		mov	[clients+18h], eax
		mov	eax, [clients+8]
		test	eax, eax
		jz	loc_62B9AFE0
		test	byte ptr [clients+10h],	2
		jz	loc_62B9AFD4
		movzx	edx, word ptr [clients+0Eh]
		mov	edx, [eax+edx]

loc_62B9AE70:				; CODE XREF: _silc_client_command_getkey+1D7j
		mov	[clients+8], edx
		mov	[clients+14h], eax
		mov	eax, [eax]

loc_62B9AE78:				; CODE XREF: _silc_client_command_getkey+1E5j
		mov	dword ptr [esp+4], 2
		add	eax, 38Ch
		mov	[esp], eax
		call	_silc_id_payload_encode
		mov	[esp+8], clients ; client_list
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		mov	[ebp+var_20], eax
		call	_silc_client_list_free
		mov	edx, [ebp+var_20]

loc_62B9AEA6:				; CODE XREF: _silc_client_command_getkey+285j
		test	edx, edx
idp = edx				; SilcBuffer
		jz	loc_62B9AFF0
		mov	ecx, [idp+4]
		mov	eax, [idp+8]
		sub	eax, ecx
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+var_20], idp
		call	_silc_client_command_send_va
		mov	edx, [ebp+var_20]
		mov	eax, [edx]
idp = edx				; SilcBuffer
		mov	[esp], eax
		call	_silc_free
		mov	edx, [ebp+var_20]
		mov	[esp], edx
idp = edx				; SilcBuffer
		call	_silc_free

loc_62B9AF0D:				; CODE XREF: _silc_client_command_getkey+230j
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax

loc_62B9AF5E:				; CODE XREF: _silc_client_command_getkey+32Bj
conn = esi				; SilcClientConnection
		add	esp, 4Ch
		pop	ebx
		pop	conn
		pop	clients
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B9AF68:				; CODE XREF: _silc_client_command_getkey+19j
		mov	edx, eax
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageGetkeyNic ; "Usage: /GETKEY <nickname	or server name"...
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh

loc_62B9AFAB:				; CODE XREF: _silc_client_command_getkey+38Ej
server_entry = edi			; SilcServerEntry
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	server_entry
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
clients	= edi				; SilcDList
		align 4

loc_62B9AFD4:				; CODE XREF: _silc_client_command_getkey+5Fj
		movzx	edx, word ptr [clients+0Ch]
		mov	edx, [eax+edx]
		jmp	loc_62B9AE70
; ---------------------------------------------------------------------------

loc_62B9AFE0:				; CODE XREF: _silc_client_command_getkey+55j
		mov	dword ptr [clients+14h], 0
		xor	eax, eax
		jmp	loc_62B9AE78
; ---------------------------------------------------------------------------
idp = edx				; SilcBuffer
		align 10h

loc_62B9AFF0:				; CODE XREF: _silc_client_command_getkey+A4j
		mov	dword ptr [esp+20h], 0
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		jmp	loc_62B9AF0D
; ---------------------------------------------------------------------------
clients	= eax				; SilcDList
		align 4

loc_62B9B03C:				; CODE XREF: _silc_client_command_getkey+44j
		mov	clients, [fsm_context_0+3Ch]
clients	= edi				; SilcDList
		mov	eax, [eax+4]
		mov	[esp+8], eax	; server_name
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_server
		mov	clients, eax
server_entry = edi			; SilcServerEntry
		test	eax, eax
		jz	short loc_62B9B090
server_entry = eax			; SilcServerEntry
		mov	dword ptr [esp+4], 1
		lea	server_entry, [server_entry+8]
server_entry = edi			; SilcServerEntry
		mov	[esp], eax
		call	_silc_id_payload_encode
		mov	edx, eax
idp = edx				; SilcBuffer
		mov	[esp+8], server_entry ;	server_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_20], idp
		call	_silc_client_unref_server
		mov	edx, [ebp+var_20]
		jmp	loc_62B9AEA6
; ---------------------------------------------------------------------------
server_entry = eax			; SilcServerEntry
		align 10h

loc_62B9B090:				; CODE XREF: _silc_client_command_getkey+255j
		mov	al, [fsm_context_0+64h]
server_entry = edi			; SilcServerEntry
		test	al, 4
		jnz	loc_62B9B134
		or	eax, 4
		mov	[fsm_context_0+64h], al
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62B9B197

loc_62B9B0BA:				; CODE XREF: _silc_client_command_getkey+3BFj
		mov	eax, [fsm_context_0+3Ch]
		mov	edx, [eax+4]
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	server_entry, edx
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+2Ch], ecx
		mov	[esp+28h], edx
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], ecx
		mov	[esp+1Ch], edx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	[esp+10h], fsm_context_0 ; reply_context
		mov	dword ptr [esp+0Ch], offset _silc_client_command_continue ; reply
		mov	dword ptr [esp+8], 3 ; command
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_command_send
		mov	ecx, [ebp+fsm]
		mov	dl, [ecx+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		shl	eax, 1
		and	eax, 2
		jmp	loc_62B9AF5E
; ---------------------------------------------------------------------------

loc_62B9B134:				; CODE XREF: _silc_client_command_getkey+291j
server_entry = edi			; SilcServerEntry
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0Ah
		movzx	esi, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	esi, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0Ch
		jmp	loc_62B9AFAB
; ---------------------------------------------------------------------------

loc_62B9B197:				; CODE XREF: _silc_client_command_getkey+2B0j
conn = esi				; SilcClientConnection
		mov	dword ptr [esp+8], 0A86h
		mov	dword ptr [esp+4], offset aCommand_c ; "command.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_5	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62B9B0BA
_silc_client_command_getkey endp

; Exported entry  86. silc_client_command_topic

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_topic(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_topic
_silc_client_command_topic proc	near	; DATA XREF: _silc_client_commands_unregister+3B5o
					; _silc_client_commands_register+2BBo

var_22C		= dword	ptr -22Ch
client		= dword	ptr -228h
var_224		= dword	ptr -224h
channel		= dword	ptr -220h
idp		= dword	ptr -21Ch
tmp		= byte ptr -218h
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 25Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	edx, [conn+4Ch]
client = edx				; SilcClient
		mov	eax, [ebx+38h]
		lea	ecx, [eax-2]
		cmp	ecx, 1
		jbe	short loc_62B9B25C
fsm_context_0 =	ebx			; void *
		mov	eax, [client+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aUsageTopicChan ; "Usage: /TOPIC <channel> [<topic>]"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], client
		call	dword ptr [eax]
		mov	ecx, [fsm_context_0+4]
		mov	edx, [ecx+4Ch]
		mov	eax, [edx+18h]
		mov	eax, [eax+48h]
		mov	edi, [eax+10h]
		cmp	dword ptr [fsm_context_0+38h], 2
		sbb	eax, eax
		add	eax, 1Eh
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	[esp+10h], eax
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], ecx
		mov	[esp], edx
		call	edi
		mov	eax, 3

loc_62B9B24F:				; CODE XREF: _silc_client_command_topic+411j
conn = esi				; SilcClientConnection
		add	esp, 25Ch
		pop	fsm_context_0
		pop	conn
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
client = edx				; SilcClient
		align 4

loc_62B9B25C:				; CODE XREF: _silc_client_command_topic+1Ej
		mov	ecx, [fsm_context_0+3Ch]
		mov	edi, [ecx+4]
		cmp	byte ptr [edi],	2Ah
		jz	loc_62B9B470

loc_62B9B26B:				; CODE XREF: _silc_client_command_topic+30Dj
					; _silc_client_command_topic+3BCj
		mov	eax, [conn+30h]
		test	eax, eax
		jz	loc_62B9B424
		mov	[esp+8], edi	; channel
name = edi				; char *
		mov	[esp+4], conn	; conn
		mov	eax, [conn+4Ch]
		mov	[esp], eax	; client
		mov	[ebp+client], client
		call	_silc_client_get_channel
		mov	[ebp+channel], eax
		test	eax, eax
		mov	edx, [ebp+client]
		jz	loc_62B9B424
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+channel]
		add	eax, 114h
		mov	[esp], eax
		mov	[ebp+client], edx
		call	_silc_id_payload_encode
		mov	[ebp+idp], eax
		cmp	dword ptr [fsm_context_0+38h], 2
		mov	edx, [ebp+client]
		jbe	loc_62B9B4DC
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	[ebp+var_224], eax
		xor	eax, eax
		mov	ecx, 0FFFFFFFFh
		mov	name, [ebp+var_224]
		repne scasb
		not	ecx
		dec	ecx
		mov	[ebp+var_22C], ecx
		mov	ecx, [ebp+idp]
		test	ecx, ecx
		jz	loc_62B9B58C
		mov	edi, [ebp+idp]
		mov	ecx, [edi+4]
		mov	eax, [edi+8]
		sub	eax, ecx

loc_62B9B31A:				; CODE XREF: _silc_client_command_topic+3C8j
		mov	edi, [ebp+var_22C]
		mov	[esp+2Ch], edi
		mov	edi, [ebp+var_224]
		mov	[esp+28h], edi
		mov	dword ptr [esp+24h], 2
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+client], edx
		call	_silc_client_command_send_va
		mov	edx, [ebp+client]

loc_62B9B37E:				; CODE XREF: _silc_client_command_topic+378j
name = edi				; char *
		mov	name, [ebp+idp]
		test	edi, edi
		jz	short loc_62B9B3B2
		mov	ecx, [ebp+idp]
		mov	eax, [ecx]
		mov	[esp], eax
		mov	[ebp+client], edx
		call	_silc_free
		mov	edi, [ebp+idp]
		mov	[esp], edi
		call	_silc_free
		mov	edx, [ebp+client]

loc_62B9B3B2:				; CODE XREF: _silc_client_command_topic+1BEj
		mov	eax, [ebp+channel]
		mov	[esp+8], eax	; channel_entry
		mov	[esp+4], conn	; conn
		mov	[esp], edx	; client
client = edx				; SilcClient
		call	_silc_client_unref_channel
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 25Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9B424:				; CODE XREF: _silc_client_command_topic+A8j
					; _silc_client_command_topic+D5j
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
client = edx				; SilcClient
name = edi				; char *
		mov	client,	[fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 19h
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3
		add	esp, 25Ch
		pop	ebx
		pop	esi
		pop	name
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9B470:				; CODE XREF: _silc_client_command_topic+9Dj
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
client = edx				; SilcClient
		mov	edi, [conn+30h]
		test	edi, edi
		jz	loc_62B9B5A4
		mov	eax, [client+18h]
		mov	eax, [eax+4Ch]
		cmp	byte ptr [eax+23h], 0
		jnz	loc_62B9B554
		cmp	byte ptr [edi+4], 0
		jnz	loc_62B9B548
		mov	ecx, offset byte_62BA8AE3

loc_62B9B49A:				; CODE XREF: _silc_client_command_topic+385j
		lea	eax, [edi+4]
		mov	[esp+14h], eax
		mov	[esp+10h], ecx
		mov	eax, [edi]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aSSS ; "%s%s%s"
		mov	dword ptr [esp+4], 200h
		lea	edi, [ebp+tmp]
		mov	[esp], edi
		mov	[ebp+client], client
		call	_silc_snprintf
		mov	edx, [ebp+client]
		jmp	loc_62B9B26B
; ---------------------------------------------------------------------------
name = edi				; char *
		align 4

loc_62B9B4DC:				; CODE XREF: _silc_client_command_topic+10Cj
		mov	eax, [ebp+idp]
		test	eax, eax
		jz	loc_62B9B598
		mov	eax, [ebp+idp]
		mov	ecx, [eax+4]
		mov	eax, [eax+8]
		sub	eax, ecx

loc_62B9B4F8:				; CODE XREF: _silc_client_command_topic+3D4j
		mov	[esp+20h], eax
		mov	[esp+1Ch], ecx
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 1 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		mov	[ebp+client], edx
		call	_silc_client_command_send_va
		mov	edx, [ebp+client]
		jmp	loc_62B9B37E
; ---------------------------------------------------------------------------
client = edx				; SilcClient
		align 4

loc_62B9B548:				; CODE XREF: _silc_client_command_topic+2C7j
		mov	ecx, offset a@	; "@"
		jmp	loc_62B9B49A
; ---------------------------------------------------------------------------
		align 4

loc_62B9B554:				; CODE XREF: _silc_client_command_topic+2BDj
		mov	eax, [edi]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aS ; "%s"
		mov	dword ptr [esp+4], 200h
		lea	edi, [ebp+tmp]
		mov	[esp], edi
		mov	[ebp+client], client
		call	_silc_snprintf
		mov	edx, [ebp+client]
		jmp	loc_62B9B26B
; ---------------------------------------------------------------------------
		align 4

loc_62B9B58C:				; CODE XREF: _silc_client_command_topic+13Ej
		xor	eax, eax
		xor	ecx, ecx
		jmp	loc_62B9B31A
; ---------------------------------------------------------------------------
name = edi				; char *
		align 4

loc_62B9B598:				; CODE XREF: _silc_client_command_topic+31Cj
		xor	eax, eax
		xor	ecx, ecx
		jmp	loc_62B9B4F8
; ---------------------------------------------------------------------------
client = edx				; SilcClient
		align 4

loc_62B9B5A4:				; CODE XREF: _silc_client_command_topic+2ADj
		mov	edi, [client+18h]
		mov	edi, [edi+48h]
		mov	[esp+18h], ecx
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 19h
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], client
		call	dword ptr [edi+10h]
		mov	eax, 3
		jmp	loc_62B9B24F
_silc_client_command_topic endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  89. silc_client_command_watch

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_watch(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_watch
_silc_client_command_watch proc	near	; DATA XREF: _silc_client_commands_unregister+EB5o
					; _silc_client_commands_register+A26o

var_3C		= dword	ptr -3Ch
sb		= dword	ptr -38h
var_31		= byte ptr -31h
var_30		= dword	ptr -30h
pubkey		= dword	ptr -2Ch
pk		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [ebx+38h]
		cmp	eax, 2
		ja	short loc_62B9B63C
fsm_context_0 =	ebx			; void *
		mov	edx, [conn+4Ch]
		mov	ecx, [edx+18h]
		mov	ecx, [ecx+48h]
		mov	edi, [fsm_context_0+3Ch]
		mov	[esp+18h], edi
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 1Dh
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], edx
		call	dword ptr [ecx+10h]
		mov	eax, 3

loc_62B9B632:				; CODE XREF: _silc_client_command_watch+22Cj
		add	esp, 6Ch
		pop	fsm_context_0
		pop	conn
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62B9B63C:				; CODE XREF: _silc_client_command_watch+15j
		mov	dword ptr [esp+4], offset aAdd ; "-add"
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp], eax	; char *
		call	_stricmp
		test	eax, eax
		jnz	loc_62B9B788
		mov	edx, 2
type = edx				; int
		mov	dword ptr [esp+14h], 0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_command_resolve_dummy ; completion
		mov	dword ptr [esp+0Ch], 0 ; server
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	eax, [conn+4Ch]
		mov	[esp], eax	; client
		mov	[ebp+sb], type
		call	_silc_client_get_clients
		mov	edx, [ebp+sb]

loc_62B9B696:				; CODE XREF: _silc_client_command_watch+1C7j
type = edx				; int
		xor	edi, edi

loc_62B9B698:				; CODE XREF: _silc_client_command_watch+396j
args = edi				; SilcBuffer
		mov	eax, [fsm_context_0+40h]
		mov	eax, [eax+8]
		mov	[ebp+var_3C], eax
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	[ebp+var_30], eax
		xchg	ax, ax

loc_62B9B6AC:				; CODE XREF: _silc_client_command_watch+37Fj
		mov	eax, [conn+54h]
		mov	eax, [eax+0F4h]
		test	eax, eax
		jz	loc_62B9B814
		mov	ecx, [eax+4]
		mov	[ebp+pubkey], ecx
		mov	eax, [eax+8]
		sub	eax, ecx

loc_62B9B6C8:				; CODE XREF: _silc_client_command_watch+23Bj
		mov	ecx, [ebp+var_3C]
		mov	[esp+2Ch], ecx
		mov	ecx, [ebp+var_30]
		mov	[esp+28h], ecx
		mov	[esp+24h], type
		mov	[esp+20h], eax
		mov	eax, [ebp+pubkey]
		mov	[esp+1Ch], eax
		mov	dword ptr [esp+18h], 1
		mov	dword ptr [esp+14h], 2 ; argc
		mov	dword ptr [esp+10h], 0 ; reply_context
		mov	dword ptr [esp+0Ch], 0 ; reply
		movzx	eax, byte ptr [fsm_context_0+34h]
		mov	[esp+8], eax	; command
		mov	[esp+4], fsm_context_0 ; cmd
		mov	[esp], conn	; conn
		call	_silc_client_command_send_va
		test	args, args
		jz	short loc_62B9B72F
		mov	eax, [args]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], args
		call	_silc_free

loc_62B9B72F:				; CODE XREF: _silc_client_command_watch+13Bj
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 0
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	args
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9B788:				; CODE XREF: _silc_client_command_watch+74j
fsm_context_0 =	ebx			; void * ; "-del"
conn = esi				; SilcClientConnection
		mov	dword ptr [esp+4], offset aDel
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp], eax	; char *
		call	_stricmp
		test	eax, eax
		jnz	short loc_62B9B7AC
		mov	edx, 3
type = edx				; int
		jmp	loc_62B9B696
; ---------------------------------------------------------------------------

loc_62B9B7AC:				; CODE XREF: _silc_client_command_watch+1C0j
		mov	dword ptr [esp+4], offset aPubkey ; "-pubkey"
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+4]
		mov	[esp], eax	; char *
		call	_stricmp
		test	eax, eax
		jnz	short loc_62B9B820
		mov	ecx, [fsm_context_0+38h]
		cmp	ecx, 2
		ja	short loc_62B9B825

loc_62B9B7CE:				; CODE XREF: _silc_client_command_watch+243j
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	conn, [eax+18h]
		mov	esi, [esi+48h]
		mov	edi, [fsm_context_0+3Ch]
		mov	[esp+18h], edi
		mov	[esp+14h], ecx
		mov	dword ptr [esp+10h], 1Dh
		movzx	ecx, byte ptr [fsm_context_0+34h]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [esi+10h]
		mov	eax, 3
		jmp	loc_62B9B632
; ---------------------------------------------------------------------------
conn = esi				; SilcClientConnection
args = edi				; SilcBuffer
type = edx				; int
		align 4

loc_62B9B814:				; CODE XREF: _silc_client_command_watch+D7j
		mov	[ebp+pubkey], 0
		jmp	loc_62B9B6C8
; ---------------------------------------------------------------------------

loc_62B9B820:				; CODE XREF: _silc_client_command_watch+1E4j
		mov	ecx, [fsm_context_0+38h]
		jmp	short loc_62B9B7CE
; ---------------------------------------------------------------------------

loc_62B9B825:				; CODE XREF: _silc_client_command_watch+1ECj
		mov	eax, [fsm_context_0+3Ch]
		mov	eax, [eax+8]
		mov	dl, [eax]
		mov	[ebp+var_31], dl
		inc	eax
		mov	[ebp+pubkey], eax
		jz	loc_62B9B96F
		lea	eax, [ebp+pk]
		mov	[esp+4], eax
		mov	ecx, [ebp+pubkey]
		mov	[esp], ecx	; len
		call	_silc_pkcs_load_public_key
		test	al, al
		jnz	short loc_62B9B8C8
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	edx, [ebp+pubkey]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], offset aCouldNotLoadPu ; "Could not load public key %s, check the"...
		mov	dword ptr [esp+8], 3
		mov	[esp+4], conn
		mov	edx, [conn+4Ch]
		mov	[esp], edx
		call	dword ptr [eax]
		mov	edx, [fsm_context_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [fsm_context_0+3Ch]
		mov	[esp+18h], esi
		mov	esi, [fsm_context_0+38h]
		mov	[esp+14h], esi
		mov	dword ptr [esp+10h], 1Dh
		movzx	fsm_context_0, byte ptr	[fsm_context_0+34h]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+10h]
		mov	eax, 3
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9B8C8:				; CODE XREF: _silc_client_command_watch+26Ej
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		call	_T_337
		mov	edi, eax
args = edi				; SilcBuffer
		mov	dword ptr [esp+0Ch], 1Dh
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], 3
		mov	[esp], eax
		call	_silc_buffer_format
		mov	eax, [ebp+pk]
		mov	[esp], eax
		call	_silc_public_key_payload_encode
		mov	edx, eax
buffer = edx				; SilcBuffer
		test	eax, eax
		jz	short loc_62B9B964
buffer = eax				; SilcBuffer
		mov	ecx, [buffer+4]
		mov	[ebp+var_30], ecx
		mov	buffer,	[buffer+8]
buffer = edx				; SilcBuffer
		sub	eax, ecx

loc_62B9B90B:				; CODE XREF: _silc_client_command_watch+38Dj
		xor	ecx, ecx
		cmp	[ebp+var_31], 2Dh
		setz	cl
		mov	[esp+0Ch], ecx
		mov	[esp+8], eax
		mov	eax, [ebp+var_30]
		mov	[esp+4], eax
		mov	[esp], args
		mov	[ebp+sb], buffer
		call	_silc_argument_payload_encode_one
		mov	args, eax
		mov	edx, [ebp+sb]
		mov	eax, edx	; sb
buffer = edx				; SilcBuffer
		call	_silc_buffer_free_0
		mov	eax, [ebp+pk]
		mov	[esp], eax
		call	_silc_pkcs_public_key_free
		mov	edx, [ebp+pubkey]
		test	edx, edx
		jz	short loc_62B9B971
		mov	edx, [args+4]
		mov	[ebp+var_30], edx
		mov	ecx, [args+8]
		sub	ecx, edx
		mov	[ebp+var_3C], ecx
		mov	edx, 4
type = edx				; int
		jmp	loc_62B9B6AC
; ---------------------------------------------------------------------------

loc_62B9B964:				; CODE XREF: _silc_client_command_watch+31Ej
buffer = eax				; SilcBuffer
		xor	buffer,	buffer
buffer = edx				; SilcBuffer
		mov	[ebp+var_30], 0
		jmp	short loc_62B9B90B
; ---------------------------------------------------------------------------

loc_62B9B96F:				; CODE XREF: _silc_client_command_watch+254j
		xor	edi, edi

loc_62B9B971:				; CODE XREF: _silc_client_command_watch+36Aj
args = edi				; SilcBuffer
		mov	edx, 4
type = edx				; int
		jmp	loc_62B9B698
_silc_client_command_watch endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  93. silc_client_commands_unregister

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_commands_unregister(SilcClient client)
		public _silc_client_commands_unregister
_silc_client_commands_unregister proc near ; CODE XREF:	_silc_client_st_stop+18p

var_AC		= dword	ptr -0ACh
var_9C		= dword	ptr -9Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
client		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0BCh
		mov	esi, [ebp+client]
		mov	eax, [esi+18h]
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [esi+18h]
client_0 = esi				; SilcClient
		nop

loc_62B9B99C:				; CODE XREF: _silc_client_commands_unregister+43j
					; _silc_client_commands_unregister+4Cj	...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9BA3C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC24
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9B9B8:				; CODE XREF: _silc_client_commands_unregister+12AFj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 1
		jnz	short loc_62B9B99C
		cmp	dword ptr [ebx+8], offset _silc_client_command_whois
		jnz	short loc_62B9B99C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_whois
		jnz	short loc_62B9B99C
		mov	[ebp+var_20], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9BA19
		cmp	ebx, edx
		jz	loc_62B9DB38
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_1C], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9BA0A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9BA00:				; CODE XREF: _silc_client_commands_unregister+95j
		cmp	ebx, eax
		jz	loc_62B9CF8B
		mov	ecx, eax

loc_62B9BA0A:				; CODE XREF: _silc_client_commands_unregister+7Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9BA00
		mov	[ebp+var_AC], ecx

loc_62B9BA19:				; CODE XREF: _silc_client_commands_unregister+65j
					; _silc_client_commands_unregister+1659j
		mov	ecx, [ebp+var_20]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CEDF

loc_62B9BA25:				; CODE XREF: _silc_client_commands_unregister+156Cj
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9BA3C:				; CODE XREF: _silc_client_commands_unregister+25j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9BA4C:				; CODE XREF: _silc_client_commands_unregister+F3j
					; _silc_client_commands_unregister+FCj	...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9BAEC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC30
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9BA68:				; CODE XREF: _silc_client_commands_unregister+12BBj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 2
		jnz	short loc_62B9BA4C
		cmp	dword ptr [ebx+8], offset _silc_client_command_whowas
		jnz	short loc_62B9BA4C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_whowas
		jnz	short loc_62B9BA4C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9BAC9
		cmp	ebx, edx
		jz	loc_62B9DB57
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9BABA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9BAB0:				; CODE XREF: _silc_client_commands_unregister+145j
		cmp	ebx, eax
		jz	loc_62B9CF3C
		mov	ecx, eax

loc_62B9BABA:				; CODE XREF: _silc_client_commands_unregister+12Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9BAB0
		mov	[ebp+var_AC], ecx

loc_62B9BAC9:				; CODE XREF: _silc_client_commands_unregister+115j
					; _silc_client_commands_unregister+160Aj
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CED1

loc_62B9BAD5:				; CODE XREF: _silc_client_commands_unregister+155Ej
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9BAEC:				; CODE XREF: _silc_client_commands_unregister+D5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9BAFC:				; CODE XREF: _silc_client_commands_unregister+1A3j
					; _silc_client_commands_unregister+1ACj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9BB9C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC3C
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9BB18:				; CODE XREF: _silc_client_commands_unregister+12C7j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 3
		jnz	short loc_62B9BAFC
		cmp	dword ptr [ebx+8], offset _silc_client_command_identify
		jnz	short loc_62B9BAFC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_identify
		jnz	short loc_62B9BAFC
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9BB79
		cmp	ebx, edx
		jz	loc_62B9DB76
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9BB6A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9BB60:				; CODE XREF: _silc_client_commands_unregister+1F5j
		cmp	ebx, eax
		jz	loc_62B9D606
		mov	ecx, eax

loc_62B9BB6A:				; CODE XREF: _silc_client_commands_unregister+1DFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9BB60
		mov	[ebp+var_AC], ecx

loc_62B9BB79:				; CODE XREF: _silc_client_commands_unregister+1C5j
					; _silc_client_commands_unregister+1CD4j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CEB5

loc_62B9BB85:				; CODE XREF: _silc_client_commands_unregister+1542j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9BB9C:				; CODE XREF: _silc_client_commands_unregister+185j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9BBAC:				; CODE XREF: _silc_client_commands_unregister+253j
					; _silc_client_commands_unregister+25Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9BC4C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC48
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9BBC8:				; CODE XREF: _silc_client_commands_unregister+12D3j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 4
		jnz	short loc_62B9BBAC
		cmp	dword ptr [ebx+8], offset _silc_client_command_nick
		jnz	short loc_62B9BBAC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_nick
		jnz	short loc_62B9BBAC
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9BC29
		cmp	ebx, edx
		jz	loc_62B9DAFA
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9BC1A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9BC10:				; CODE XREF: _silc_client_commands_unregister+2A5j
		cmp	ebx, eax
		jz	loc_62B9D38E
		mov	ecx, eax

loc_62B9BC1A:				; CODE XREF: _silc_client_commands_unregister+28Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9BC10
		mov	[ebp+var_AC], ecx

loc_62B9BC29:				; CODE XREF: _silc_client_commands_unregister+275j
					; _silc_client_commands_unregister+1A5Cj
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE7D

loc_62B9BC35:				; CODE XREF: _silc_client_commands_unregister+150Aj
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9BC4C:				; CODE XREF: _silc_client_commands_unregister+235j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9BC5C:				; CODE XREF: _silc_client_commands_unregister+303j
					; _silc_client_commands_unregister+30Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9BCFC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC54
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9BC78:				; CODE XREF: _silc_client_commands_unregister+12DFj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 5
		jnz	short loc_62B9BC5C
		cmp	dword ptr [ebx+8], offset _silc_client_command_list
		jnz	short loc_62B9BC5C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_list
		jnz	short loc_62B9BC5C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9BCD9
		cmp	ebx, edx
		jz	loc_62B9D9C4
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9BCCA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9BCC0:				; CODE XREF: _silc_client_commands_unregister+355j
		cmp	ebx, eax
		jz	loc_62B9D2A1
		mov	ecx, eax

loc_62B9BCCA:				; CODE XREF: _silc_client_commands_unregister+33Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9BCC0
		mov	[ebp+var_AC], ecx

loc_62B9BCD9:				; CODE XREF: _silc_client_commands_unregister+325j
					; _silc_client_commands_unregister+196Fj
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE6F

loc_62B9BCE5:				; CODE XREF: _silc_client_commands_unregister+14FCj
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9BCFC:				; CODE XREF: _silc_client_commands_unregister+2E5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9BD0C:				; CODE XREF: _silc_client_commands_unregister+3B3j
					; _silc_client_commands_unregister+3BCj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9BDAC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC60
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9BD28:				; CODE XREF: _silc_client_commands_unregister+12EBj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 6
		jnz	short loc_62B9BD0C
		cmp	dword ptr [ebx+8], offset _silc_client_command_topic
		jnz	short loc_62B9BD0C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_topic
		jnz	short loc_62B9BD0C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9BD89
		cmp	ebx, edx
		jz	loc_62B9DABC
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9BD7A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9BD70:				; CODE XREF: _silc_client_commands_unregister+405j
		cmp	ebx, eax
		jz	loc_62B9D252
		mov	ecx, eax

loc_62B9BD7A:				; CODE XREF: _silc_client_commands_unregister+3EFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9BD70
		mov	[ebp+var_AC], ecx

loc_62B9BD89:				; CODE XREF: _silc_client_commands_unregister+3D5j
					; _silc_client_commands_unregister+1920j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE61

loc_62B9BD95:				; CODE XREF: _silc_client_commands_unregister+14EEj
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9BDAC:				; CODE XREF: _silc_client_commands_unregister+395j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9BDBC:				; CODE XREF: _silc_client_commands_unregister+463j
					; _silc_client_commands_unregister+46Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9BE5C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC6C
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9BDD8:				; CODE XREF: _silc_client_commands_unregister+12F7j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 7
		jnz	short loc_62B9BDBC
		cmp	dword ptr [ebx+8], offset _silc_client_command_invite
		jnz	short loc_62B9BDBC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_invite
		jnz	short loc_62B9BDBC
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9BE39
		cmp	ebx, edx
		jz	loc_62B9DA02
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9BE2A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9BE20:				; CODE XREF: _silc_client_commands_unregister+4B5j
		cmp	ebx, eax
		jz	loc_62B9D3DD
		mov	ecx, eax

loc_62B9BE2A:				; CODE XREF: _silc_client_commands_unregister+49Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9BE20
		mov	[ebp+var_AC], ecx

loc_62B9BE39:				; CODE XREF: _silc_client_commands_unregister+485j
					; _silc_client_commands_unregister+1AABj
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE53

loc_62B9BE45:				; CODE XREF: _silc_client_commands_unregister+14E0j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9BE5C:				; CODE XREF: _silc_client_commands_unregister+445j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9BE6C:				; CODE XREF: _silc_client_commands_unregister+513j
					; _silc_client_commands_unregister+51Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9BF0C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC78
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9BE88:				; CODE XREF: _silc_client_commands_unregister+1303j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 8
		jnz	short loc_62B9BE6C
		cmp	dword ptr [ebx+8], offset _silc_client_command_quit
		jnz	short loc_62B9BE6C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_quit
		jnz	short loc_62B9BE6C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9BEE9
		cmp	ebx, edx
		jz	loc_62B9DADB
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9BEDA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9BED0:				; CODE XREF: _silc_client_commands_unregister+565j
		cmp	ebx, eax
		jz	loc_62B9D4CA
		mov	ecx, eax

loc_62B9BEDA:				; CODE XREF: _silc_client_commands_unregister+54Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9BED0
		mov	[ebp+var_AC], ecx

loc_62B9BEE9:				; CODE XREF: _silc_client_commands_unregister+535j
					; _silc_client_commands_unregister+1B98j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE99

loc_62B9BEF5:				; CODE XREF: _silc_client_commands_unregister+1526j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9BF0C:				; CODE XREF: _silc_client_commands_unregister+4F5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9BF1C:				; CODE XREF: _silc_client_commands_unregister+5C3j
					; _silc_client_commands_unregister+5CCj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9BFBC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC84
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9BF38:				; CODE XREF: _silc_client_commands_unregister+130Fj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 9
		jnz	short loc_62B9BF1C
		cmp	dword ptr [ebx+8], offset _silc_client_command_kill
		jnz	short loc_62B9BF1C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_kill
		jnz	short loc_62B9BF1C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9BF99
		cmp	ebx, edx
		jz	loc_62B9D9A5
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9BF8A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9BF80:				; CODE XREF: _silc_client_commands_unregister+615j
		cmp	ebx, eax
		jz	loc_62B9D655
		mov	ecx, eax

loc_62B9BF8A:				; CODE XREF: _silc_client_commands_unregister+5FFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9BF80
		mov	[ebp+var_AC], ecx

loc_62B9BF99:				; CODE XREF: _silc_client_commands_unregister+5E5j
					; _silc_client_commands_unregister+1D23j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE8B

loc_62B9BFA5:				; CODE XREF: _silc_client_commands_unregister+1518j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9BFBC:				; CODE XREF: _silc_client_commands_unregister+5A5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9BFCC:				; CODE XREF: _silc_client_commands_unregister+673j
					; _silc_client_commands_unregister+67Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C06C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC90
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9BFE8:				; CODE XREF: _silc_client_commands_unregister+131Bj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 0Ah
		jnz	short loc_62B9BFCC
		cmp	dword ptr [ebx+8], offset _silc_client_command_info
		jnz	short loc_62B9BFCC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_info
		jnz	short loc_62B9BFCC
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C049
		cmp	ebx, edx
		jz	loc_62B9DA9D
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C03A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C030:				; CODE XREF: _silc_client_commands_unregister+6C5j
		cmp	ebx, eax
		jz	loc_62B9D519
		mov	ecx, eax

loc_62B9C03A:				; CODE XREF: _silc_client_commands_unregister+6AFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C030
		mov	[ebp+var_AC], ecx

loc_62B9C049:				; CODE XREF: _silc_client_commands_unregister+695j
					; _silc_client_commands_unregister+1BE7j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CEA7

loc_62B9C055:				; CODE XREF: _silc_client_commands_unregister+1534j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C06C:				; CODE XREF: _silc_client_commands_unregister+655j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C07C:				; CODE XREF: _silc_client_commands_unregister+723j
					; _silc_client_commands_unregister+72Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C11C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CC9C
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C098:				; CODE XREF: _silc_client_commands_unregister+1327j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 0Bh
		jnz	short loc_62B9C07C
		cmp	dword ptr [ebx+8], offset _silc_client_command_stats
		jnz	short loc_62B9C07C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_stats
		jnz	short loc_62B9C07C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C0F9
		cmp	ebx, edx
		jz	loc_62B9D9E3
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C0EA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C0E0:				; CODE XREF: _silc_client_commands_unregister+775j
		cmp	ebx, eax
		jz	loc_62B9D6F3
		mov	ecx, eax

loc_62B9C0EA:				; CODE XREF: _silc_client_commands_unregister+75Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C0E0
		mov	[ebp+var_AC], ecx

loc_62B9C0F9:				; CODE XREF: _silc_client_commands_unregister+745j
					; _silc_client_commands_unregister+1DBDj
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE45

loc_62B9C105:				; CODE XREF: _silc_client_commands_unregister+14D2j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C11C:				; CODE XREF: _silc_client_commands_unregister+705j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C12C:				; CODE XREF: _silc_client_commands_unregister+7D3j
					; _silc_client_commands_unregister+7DCj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C1CC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CCA8
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C148:				; CODE XREF: _silc_client_commands_unregister+1333j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 0Ch
		jnz	short loc_62B9C12C
		cmp	dword ptr [ebx+8], offset _silc_client_command_ping
		jnz	short loc_62B9C12C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_ping
		jnz	short loc_62B9C12C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C1A9
		cmp	ebx, edx
		jz	loc_62B9D8EB
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C19A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C190:				; CODE XREF: _silc_client_commands_unregister+825j
		cmp	ebx, eax
		jz	loc_62B9D47B
		mov	ecx, eax

loc_62B9C19A:				; CODE XREF: _silc_client_commands_unregister+80Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C190
		mov	[ebp+var_AC], ecx

loc_62B9C1A9:				; CODE XREF: _silc_client_commands_unregister+7F5j
					; _silc_client_commands_unregister+1B49j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CDD5

loc_62B9C1B5:				; CODE XREF: _silc_client_commands_unregister+1462j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C1CC:				; CODE XREF: _silc_client_commands_unregister+7B5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C1DC:				; CODE XREF: _silc_client_commands_unregister+883j
					; _silc_client_commands_unregister+88Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C27C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CCB4
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C1F8:				; CODE XREF: _silc_client_commands_unregister+133Fj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 0Dh
		jnz	short loc_62B9C1DC
		cmp	dword ptr [ebx+8], offset _silc_client_command_oper
		jnz	short loc_62B9C1DC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_oper
		jnz	short loc_62B9C1DC
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C259
		cmp	ebx, edx
		jz	loc_62B9DBF2
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C24A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C240:				; CODE XREF: _silc_client_commands_unregister+8D5j
		cmp	ebx, eax
		jz	loc_62B9D078
		mov	ecx, eax

loc_62B9C24A:				; CODE XREF: _silc_client_commands_unregister+8BFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C240
		mov	[ebp+var_AC], ecx

loc_62B9C259:				; CODE XREF: _silc_client_commands_unregister+8A5j
					; _silc_client_commands_unregister+1746j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CDC7

loc_62B9C265:				; CODE XREF: _silc_client_commands_unregister+1454j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C27C:				; CODE XREF: _silc_client_commands_unregister+865j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C28C:				; CODE XREF: _silc_client_commands_unregister+933j
					; _silc_client_commands_unregister+93Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C32C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CCC0
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C2A8:				; CODE XREF: _silc_client_commands_unregister+134Bj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 0Eh
		jnz	short loc_62B9C28C
		cmp	dword ptr [ebx+8], offset _silc_client_command_join
		jnz	short loc_62B9C28C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_join
		jnz	short loc_62B9C28C
		mov	[ebp+var_20], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C309
		cmp	ebx, edx
		jz	loc_62B9D948
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_1C], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C2FA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C2F0:				; CODE XREF: _silc_client_commands_unregister+985j
		cmp	ebx, eax
		jz	loc_62B9D2F0
		mov	ecx, eax

loc_62B9C2FA:				; CODE XREF: _silc_client_commands_unregister+96Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C2F0
		mov	[ebp+var_AC], ecx

loc_62B9C309:				; CODE XREF: _silc_client_commands_unregister+955j
					; _silc_client_commands_unregister+19BEj
		mov	ecx, [ebp+var_20]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CDB9

loc_62B9C315:				; CODE XREF: _silc_client_commands_unregister+1446j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C32C:				; CODE XREF: _silc_client_commands_unregister+915j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C33C:				; CODE XREF: _silc_client_commands_unregister+9E3j
					; _silc_client_commands_unregister+9ECj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C3DC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CCCC
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C358:				; CODE XREF: _silc_client_commands_unregister+1357j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 0Fh
		jnz	short loc_62B9C33C
		cmp	dword ptr [ebx+8], offset _silc_client_command_motd
		jnz	short loc_62B9C33C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_motd
		jnz	short loc_62B9C33C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C3B9
		cmp	ebx, edx
		jz	loc_62B9DA40
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C3AA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C3A0:				; CODE XREF: _silc_client_commands_unregister+A35j
		cmp	ebx, eax
		jz	loc_62B9D029
		mov	ecx, eax

loc_62B9C3AA:				; CODE XREF: _silc_client_commands_unregister+A1Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C3A0
		mov	[ebp+var_AC], ecx

loc_62B9C3B9:				; CODE XREF: _silc_client_commands_unregister+A05j
					; _silc_client_commands_unregister+16F7j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CDAB

loc_62B9C3C5:				; CODE XREF: _silc_client_commands_unregister+1438j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C3DC:				; CODE XREF: _silc_client_commands_unregister+9C5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C3EC:				; CODE XREF: _silc_client_commands_unregister+A93j
					; _silc_client_commands_unregister+A9Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C48C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CCD8
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C408:				; CODE XREF: _silc_client_commands_unregister+1363j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 10h
		jnz	short loc_62B9C3EC
		cmp	dword ptr [ebx+8], offset _silc_client_command_umode
		jnz	short loc_62B9C3EC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_umode
		jnz	short loc_62B9C3EC
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C469
		cmp	ebx, edx
		jz	loc_62B9D90A
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C45A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C450:				; CODE XREF: _silc_client_commands_unregister+AE5j
		cmp	ebx, eax
		jz	loc_62B9D33F
		mov	ecx, eax

loc_62B9C45A:				; CODE XREF: _silc_client_commands_unregister+ACFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C450
		mov	[ebp+var_AC], ecx

loc_62B9C469:				; CODE XREF: _silc_client_commands_unregister+AB5j
					; _silc_client_commands_unregister+1A0Dj
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CD9D

loc_62B9C475:				; CODE XREF: _silc_client_commands_unregister+142Aj
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C48C:				; CODE XREF: _silc_client_commands_unregister+A75j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C49C:				; CODE XREF: _silc_client_commands_unregister+B43j
					; _silc_client_commands_unregister+B4Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C53C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CCE4
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C4B8:				; CODE XREF: _silc_client_commands_unregister+136Fj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 11h
		jnz	short loc_62B9C49C
		cmp	dword ptr [ebx+8], offset _silc_client_command_cmode
		jnz	short loc_62B9C49C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_cmode
		jnz	short loc_62B9C49C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C519
		cmp	ebx, edx
		jz	loc_62B9DBB4
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C50A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C500:				; CODE XREF: _silc_client_commands_unregister+B95j
		cmp	ebx, eax
		jz	loc_62B9CFDA
		mov	ecx, eax

loc_62B9C50A:				; CODE XREF: _silc_client_commands_unregister+B7Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C500
		mov	[ebp+var_AC], ecx

loc_62B9C519:				; CODE XREF: _silc_client_commands_unregister+B65j
					; _silc_client_commands_unregister+16A8j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CD8F

loc_62B9C525:				; CODE XREF: _silc_client_commands_unregister+141Cj
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C53C:				; CODE XREF: _silc_client_commands_unregister+B25j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C54C:				; CODE XREF: _silc_client_commands_unregister+BF3j
					; _silc_client_commands_unregister+BFCj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C5EC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CCF0
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C568:				; CODE XREF: _silc_client_commands_unregister+137Bj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 12h
		jnz	short loc_62B9C54C
		cmp	dword ptr [ebx+8], offset _silc_client_command_cumode
		jnz	short loc_62B9C54C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_cumode
		jnz	short loc_62B9C54C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C5C9
		cmp	ebx, edx
		jz	loc_62B9D986
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C5BA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C5B0:				; CODE XREF: _silc_client_commands_unregister+C45j
		cmp	ebx, eax
		jz	loc_62B9D42C
		mov	ecx, eax

loc_62B9C5BA:				; CODE XREF: _silc_client_commands_unregister+C2Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C5B0
		mov	[ebp+var_AC], ecx

loc_62B9C5C9:				; CODE XREF: _silc_client_commands_unregister+C15j
					; _silc_client_commands_unregister+1AFAj
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CD81

loc_62B9C5D5:				; CODE XREF: _silc_client_commands_unregister+140Ej
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C5EC:				; CODE XREF: _silc_client_commands_unregister+BD5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C5FC:				; CODE XREF: _silc_client_commands_unregister+CA3j
					; _silc_client_commands_unregister+CACj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C69C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CCFC
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C618:				; CODE XREF: _silc_client_commands_unregister+1387j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 13h
		jnz	short loc_62B9C5FC
		cmp	dword ptr [ebx+8], offset _silc_client_command_kick
		jnz	short loc_62B9C5FC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_kick
		jnz	short loc_62B9C5FC
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C679
		cmp	ebx, edx
		jz	loc_62B9DA7E
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C66A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C660:				; CODE XREF: _silc_client_commands_unregister+CF5j
		cmp	ebx, eax
		jz	loc_62B9D0C7
		mov	ecx, eax

loc_62B9C66A:				; CODE XREF: _silc_client_commands_unregister+CDFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C660
		mov	[ebp+var_AC], ecx

loc_62B9C679:				; CODE XREF: _silc_client_commands_unregister+CC5j
					; _silc_client_commands_unregister+1795j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CD73

loc_62B9C685:				; CODE XREF: _silc_client_commands_unregister+1400j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C69C:				; CODE XREF: _silc_client_commands_unregister+C85j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C6AC:				; CODE XREF: _silc_client_commands_unregister+D53j
					; _silc_client_commands_unregister+D5Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C74C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CD08
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C6C8:				; CODE XREF: _silc_client_commands_unregister+1393j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 14h
		jnz	short loc_62B9C6AC
		cmp	dword ptr [ebx+8], offset _silc_client_command_ban
		jnz	short loc_62B9C6AC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_ban
		jnz	short loc_62B9C6AC
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C729
		cmp	ebx, edx
		jz	loc_62B9D929
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C71A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C710:				; CODE XREF: _silc_client_commands_unregister+DA5j
		cmp	ebx, eax
		jz	loc_62B9D5B7
		mov	ecx, eax

loc_62B9C71A:				; CODE XREF: _silc_client_commands_unregister+D8Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C710
		mov	[ebp+var_AC], ecx

loc_62B9C729:				; CODE XREF: _silc_client_commands_unregister+D75j
					; _silc_client_commands_unregister+1C85j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE0D

loc_62B9C735:				; CODE XREF: _silc_client_commands_unregister+149Aj
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C74C:				; CODE XREF: _silc_client_commands_unregister+D35j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C75C:				; CODE XREF: _silc_client_commands_unregister+E03j
					; _silc_client_commands_unregister+E0Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C7FC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CD14
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C778:				; CODE XREF: _silc_client_commands_unregister+139Fj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 15h
		jnz	short loc_62B9C75C
		cmp	dword ptr [ebx+8], offset _silc_client_command_detach
		jnz	short loc_62B9C75C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_detach
		jnz	short loc_62B9C75C
		mov	[ebp+var_20], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C7D9
		cmp	ebx, edx
		jz	loc_62B9DBD3
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_1C], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C7CA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C7C0:				; CODE XREF: _silc_client_commands_unregister+E55j
		cmp	ebx, eax
		jz	loc_62B9D116
		mov	ecx, eax

loc_62B9C7CA:				; CODE XREF: _silc_client_commands_unregister+E3Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C7C0
		mov	[ebp+var_AC], ecx

loc_62B9C7D9:				; CODE XREF: _silc_client_commands_unregister+E25j
					; _silc_client_commands_unregister+17E4j
		mov	ecx, [ebp+var_20]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CDFF

loc_62B9C7E5:				; CODE XREF: _silc_client_commands_unregister+148Cj
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C7FC:				; CODE XREF: _silc_client_commands_unregister+DE5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C80C:				; CODE XREF: _silc_client_commands_unregister+EB3j
					; _silc_client_commands_unregister+EBCj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C8AC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CD20
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C828:				; CODE XREF: _silc_client_commands_unregister+13ABj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 16h
		jnz	short loc_62B9C80C
		cmp	dword ptr [ebx+8], offset _silc_client_command_watch
		jnz	short loc_62B9C80C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_watch
		jnz	short loc_62B9C80C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C889
		cmp	ebx, edx
		jz	loc_62B9DB19
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C87A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C870:				; CODE XREF: _silc_client_commands_unregister+F05j
		cmp	ebx, eax
		jz	loc_62B9D6A4
		mov	ecx, eax

loc_62B9C87A:				; CODE XREF: _silc_client_commands_unregister+EEFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C870
		mov	[ebp+var_AC], ecx

loc_62B9C889:				; CODE XREF: _silc_client_commands_unregister+ED5j
					; _silc_client_commands_unregister+1D72j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CDF1

loc_62B9C895:				; CODE XREF: _silc_client_commands_unregister+147Ej
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C8AC:				; CODE XREF: _silc_client_commands_unregister+E95j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C8BC:				; CODE XREF: _silc_client_commands_unregister+F63j
					; _silc_client_commands_unregister+F6Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9C95C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CD2C
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C8D8:				; CODE XREF: _silc_client_commands_unregister+13B7j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 17h
		jnz	short loc_62B9C8BC
		cmp	dword ptr [ebx+8], offset _silc_client_command_silcoper
		jnz	short loc_62B9C8BC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_silcoper
		jnz	short loc_62B9C8BC
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C939
		cmp	ebx, edx
		jz	loc_62B9DC11
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C92A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C920:				; CODE XREF: _silc_client_commands_unregister+FB5j
		cmp	ebx, eax
		jz	loc_62B9D203
		mov	ecx, eax

loc_62B9C92A:				; CODE XREF: _silc_client_commands_unregister+F9Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C920
		mov	[ebp+var_AC], ecx

loc_62B9C939:				; CODE XREF: _silc_client_commands_unregister+F85j
					; _silc_client_commands_unregister+18D1j
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CDE3

loc_62B9C945:				; CODE XREF: _silc_client_commands_unregister+1470j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9C95C:				; CODE XREF: _silc_client_commands_unregister+F45j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9C96C:				; CODE XREF: _silc_client_commands_unregister+1013j
					; _silc_client_commands_unregister+101Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9CA0C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CD38
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9C988:				; CODE XREF: _silc_client_commands_unregister+13C3j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 18h
		jnz	short loc_62B9C96C
		cmp	dword ptr [ebx+8], offset _silc_client_command_leave
		jnz	short loc_62B9C96C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_leave
		jnz	short loc_62B9C96C
		mov	[ebp+var_20], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9C9E9
		cmp	ebx, edx
		jz	loc_62B9DA21
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_1C], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9C9DA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9C9D0:				; CODE XREF: _silc_client_commands_unregister+1065j
		cmp	ebx, eax
		jz	loc_62B9D568
		mov	ecx, eax

loc_62B9C9DA:				; CODE XREF: _silc_client_commands_unregister+104Fj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9C9D0
		mov	[ebp+var_AC], ecx

loc_62B9C9E9:				; CODE XREF: _silc_client_commands_unregister+1035j
					; _silc_client_commands_unregister+1C36j
		mov	ecx, [ebp+var_20]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE29

loc_62B9C9F5:				; CODE XREF: _silc_client_commands_unregister+14B6j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9CA0C:				; CODE XREF: _silc_client_commands_unregister+FF5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9CA1C:				; CODE XREF: _silc_client_commands_unregister+10C3j
					; _silc_client_commands_unregister+10CCj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9CABC
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CD44
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9CA38:				; CODE XREF: _silc_client_commands_unregister+13CFj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 19h
		jnz	short loc_62B9CA1C
		cmp	dword ptr [ebx+8], offset _silc_client_command_users
		jnz	short loc_62B9CA1C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_users
		jnz	short loc_62B9CA1C
		mov	[ebp+var_20], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9CA99
		cmp	ebx, edx
		jz	loc_62B9DB95
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_1C], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9CA8A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9CA80:				; CODE XREF: _silc_client_commands_unregister+1115j
		cmp	ebx, eax
		jz	loc_62B9D165
		mov	ecx, eax

loc_62B9CA8A:				; CODE XREF: _silc_client_commands_unregister+10FFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9CA80
		mov	[ebp+var_AC], ecx

loc_62B9CA99:				; CODE XREF: _silc_client_commands_unregister+10E5j
					; _silc_client_commands_unregister+1833j
		mov	ecx, [ebp+var_20]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE1B

loc_62B9CAA5:				; CODE XREF: _silc_client_commands_unregister+14A8j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9CABC:				; CODE XREF: _silc_client_commands_unregister+10A5j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9CACC:				; CODE XREF: _silc_client_commands_unregister+1173j
					; _silc_client_commands_unregister+117Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9CB6C
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CD50
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9CAE8:				; CODE XREF: _silc_client_commands_unregister+13DBj
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 1Ah
		jnz	short loc_62B9CACC
		cmp	dword ptr [ebx+8], offset _silc_client_command_getkey
		jnz	short loc_62B9CACC
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_getkey
		jnz	short loc_62B9CACC
		mov	[ebp+var_20], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9CB49
		cmp	ebx, edx
		jz	loc_62B9D967
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_1C], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], eax
		jmp	short loc_62B9CB3A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9CB30:				; CODE XREF: _silc_client_commands_unregister+11C5j
		cmp	ebx, eax
		jz	loc_62B9D1B4
		mov	ecx, eax

loc_62B9CB3A:				; CODE XREF: _silc_client_commands_unregister+11AFj
		lea	edi, [ecx+edx]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_62B9CB30
		mov	[ebp+var_AC], ecx

loc_62B9CB49:				; CODE XREF: _silc_client_commands_unregister+1195j
					; _silc_client_commands_unregister+1882j
		mov	ecx, [ebp+var_20]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CE37

loc_62B9CB55:				; CODE XREF: _silc_client_commands_unregister+14C4j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], ebx
		call	_silc_free
		mov	eax, [client_0+18h]
		nop

loc_62B9CB6C:				; CODE XREF: _silc_client_commands_unregister+1155j
		mov	edx, [eax+58h]
		mov	[eax+60h], edx
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [client_0+18h]
		lea	client_0, [client_0+0]

loc_62B9CB7C:				; CODE XREF: _silc_client_commands_unregister+1223j
					; _silc_client_commands_unregister+122Cj ...
		mov	ebx, [eax+60h]
		test	ebx, ebx
		jz	loc_62B9CD68
		test	byte ptr [eax+68h], 2
		jz	loc_62B9CD5C
		movzx	edx, word ptr [eax+66h]
		mov	edx, [ebx+edx]

loc_62B9CB98:				; CODE XREF: _silc_client_commands_unregister+13E7j
		mov	[eax+60h], edx
		cmp	byte ptr [ebx+4], 1Bh
		jnz	short loc_62B9CB7C
		cmp	dword ptr [ebx+8], offset _silc_client_command_service
		jnz	short loc_62B9CB7C
		cmp	dword ptr [ebx+0Ch], offset _silc_client_command_reply_service
		jnz	short loc_62B9CB7C
		mov	[ebp+var_1C], eax
		mov	edx, [eax+58h]
		mov	[ebp+var_AC], edx
		test	edx, edx
		jz	short loc_62B9CBF9
		cmp	ebx, edx
		jz	loc_62B9DA5F
		movzx	edx, word ptr [eax+64h]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_AC]
		mov	[ebp+var_24], client_0
		mov	client_0, edx
		jmp	short loc_62B9CBEA
; ---------------------------------------------------------------------------
		align 10h

loc_62B9CBE0:				; CODE XREF: _silc_client_commands_unregister+1275j
		cmp	ebx, edx
		jz	loc_62B9CEED
		mov	ecx, edx

loc_62B9CBEA:				; CODE XREF: _silc_client_commands_unregister+1261j
		lea	edi, [ecx+esi]
		mov	edx, [edi]
		test	edx, edx
		jnz	short loc_62B9CBE0
		mov	[ebp+var_AC], ecx

loc_62B9CBF9:				; CODE XREF: _silc_client_commands_unregister+1245j
					; _silc_client_commands_unregister+15BBj
		mov	ecx, [ebp+var_1C]
		cmp	ebx, [ecx+5Ch]
		jz	loc_62B9CEC3

loc_62B9CC05:				; CODE XREF: _silc_client_commands_unregister+1550j
		mov	eax, [ebx+10h]
		mov	[esp], eax
		call	_silc_free
		mov	[ebp+client], ebx
		add	esp, 0BCh
		pop	ebx
		pop	esi
		pop	edi
		leave
		jmp	_silc_free
; ---------------------------------------------------------------------------
client_0 = esi				; SilcClient
		align 4

loc_62B9CC24:				; CODE XREF: _silc_client_commands_unregister+2Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9B9B8
; ---------------------------------------------------------------------------

loc_62B9CC30:				; CODE XREF: _silc_client_commands_unregister+DFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9BA68
; ---------------------------------------------------------------------------

loc_62B9CC3C:				; CODE XREF: _silc_client_commands_unregister+18Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9BB18
; ---------------------------------------------------------------------------

loc_62B9CC48:				; CODE XREF: _silc_client_commands_unregister+23Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9BBC8
; ---------------------------------------------------------------------------

loc_62B9CC54:				; CODE XREF: _silc_client_commands_unregister+2EFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9BC78
; ---------------------------------------------------------------------------

loc_62B9CC60:				; CODE XREF: _silc_client_commands_unregister+39Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9BD28
; ---------------------------------------------------------------------------

loc_62B9CC6C:				; CODE XREF: _silc_client_commands_unregister+44Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9BDD8
; ---------------------------------------------------------------------------

loc_62B9CC78:				; CODE XREF: _silc_client_commands_unregister+4FFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9BE88
; ---------------------------------------------------------------------------

loc_62B9CC84:				; CODE XREF: _silc_client_commands_unregister+5AFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9BF38
; ---------------------------------------------------------------------------

loc_62B9CC90:				; CODE XREF: _silc_client_commands_unregister+65Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9BFE8
; ---------------------------------------------------------------------------

loc_62B9CC9C:				; CODE XREF: _silc_client_commands_unregister+70Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C098
; ---------------------------------------------------------------------------

loc_62B9CCA8:				; CODE XREF: _silc_client_commands_unregister+7BFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C148
; ---------------------------------------------------------------------------

loc_62B9CCB4:				; CODE XREF: _silc_client_commands_unregister+86Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C1F8
; ---------------------------------------------------------------------------

loc_62B9CCC0:				; CODE XREF: _silc_client_commands_unregister+91Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C2A8
; ---------------------------------------------------------------------------

loc_62B9CCCC:				; CODE XREF: _silc_client_commands_unregister+9CFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C358
; ---------------------------------------------------------------------------

loc_62B9CCD8:				; CODE XREF: _silc_client_commands_unregister+A7Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C408
; ---------------------------------------------------------------------------

loc_62B9CCE4:				; CODE XREF: _silc_client_commands_unregister+B2Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C4B8
; ---------------------------------------------------------------------------

loc_62B9CCF0:				; CODE XREF: _silc_client_commands_unregister+BDFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C568
; ---------------------------------------------------------------------------

loc_62B9CCFC:				; CODE XREF: _silc_client_commands_unregister+C8Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C618
; ---------------------------------------------------------------------------

loc_62B9CD08:				; CODE XREF: _silc_client_commands_unregister+D3Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C6C8
; ---------------------------------------------------------------------------

loc_62B9CD14:				; CODE XREF: _silc_client_commands_unregister+DEFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C778
; ---------------------------------------------------------------------------

loc_62B9CD20:				; CODE XREF: _silc_client_commands_unregister+E9Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C828
; ---------------------------------------------------------------------------

loc_62B9CD2C:				; CODE XREF: _silc_client_commands_unregister+F4Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C8D8
; ---------------------------------------------------------------------------

loc_62B9CD38:				; CODE XREF: _silc_client_commands_unregister+FFFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9C988
; ---------------------------------------------------------------------------

loc_62B9CD44:				; CODE XREF: _silc_client_commands_unregister+10AFj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9CA38
; ---------------------------------------------------------------------------

loc_62B9CD50:				; CODE XREF: _silc_client_commands_unregister+115Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9CAE8
; ---------------------------------------------------------------------------

loc_62B9CD5C:				; CODE XREF: _silc_client_commands_unregister+120Fj
		movzx	edx, word ptr [eax+64h]
		mov	edx, [ebx+edx]
		jmp	loc_62B9CB98
; ---------------------------------------------------------------------------

loc_62B9CD68:				; CODE XREF: _silc_client_commands_unregister+1205j
		add	esp, 0BCh
		pop	ebx
		pop	client_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9CD73:				; CODE XREF: _silc_client_commands_unregister+D03j
client_0 = esi				; SilcClient
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C685
; ---------------------------------------------------------------------------

loc_62B9CD81:				; CODE XREF: _silc_client_commands_unregister+C53j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C5D5
; ---------------------------------------------------------------------------

loc_62B9CD8F:				; CODE XREF: _silc_client_commands_unregister+BA3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C525
; ---------------------------------------------------------------------------

loc_62B9CD9D:				; CODE XREF: _silc_client_commands_unregister+AF3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C475
; ---------------------------------------------------------------------------

loc_62B9CDAB:				; CODE XREF: _silc_client_commands_unregister+A43j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C3C5
; ---------------------------------------------------------------------------

loc_62B9CDB9:				; CODE XREF: _silc_client_commands_unregister+993j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C315
; ---------------------------------------------------------------------------

loc_62B9CDC7:				; CODE XREF: _silc_client_commands_unregister+8E3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C265
; ---------------------------------------------------------------------------

loc_62B9CDD5:				; CODE XREF: _silc_client_commands_unregister+833j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C1B5
; ---------------------------------------------------------------------------

loc_62B9CDE3:				; CODE XREF: _silc_client_commands_unregister+FC3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C945
; ---------------------------------------------------------------------------

loc_62B9CDF1:				; CODE XREF: _silc_client_commands_unregister+F13j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C895
; ---------------------------------------------------------------------------

loc_62B9CDFF:				; CODE XREF: _silc_client_commands_unregister+E63j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C7E5
; ---------------------------------------------------------------------------

loc_62B9CE0D:				; CODE XREF: _silc_client_commands_unregister+DB3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C735
; ---------------------------------------------------------------------------

loc_62B9CE1B:				; CODE XREF: _silc_client_commands_unregister+1123j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9CAA5
; ---------------------------------------------------------------------------

loc_62B9CE29:				; CODE XREF: _silc_client_commands_unregister+1073j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C9F5
; ---------------------------------------------------------------------------

loc_62B9CE37:				; CODE XREF: _silc_client_commands_unregister+11D3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9CB55
; ---------------------------------------------------------------------------

loc_62B9CE45:				; CODE XREF: _silc_client_commands_unregister+783j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C105
; ---------------------------------------------------------------------------

loc_62B9CE53:				; CODE XREF: _silc_client_commands_unregister+4C3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9BE45
; ---------------------------------------------------------------------------

loc_62B9CE61:				; CODE XREF: _silc_client_commands_unregister+413j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9BD95
; ---------------------------------------------------------------------------

loc_62B9CE6F:				; CODE XREF: _silc_client_commands_unregister+363j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9BCE5
; ---------------------------------------------------------------------------

loc_62B9CE7D:				; CODE XREF: _silc_client_commands_unregister+2B3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9BC35
; ---------------------------------------------------------------------------

loc_62B9CE8B:				; CODE XREF: _silc_client_commands_unregister+623j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9BFA5
; ---------------------------------------------------------------------------

loc_62B9CE99:				; CODE XREF: _silc_client_commands_unregister+573j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9BEF5
; ---------------------------------------------------------------------------

loc_62B9CEA7:				; CODE XREF: _silc_client_commands_unregister+6D3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9C055
; ---------------------------------------------------------------------------

loc_62B9CEB5:				; CODE XREF: _silc_client_commands_unregister+203j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9BB85
; ---------------------------------------------------------------------------

loc_62B9CEC3:				; CODE XREF: _silc_client_commands_unregister+1283j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9CC05
; ---------------------------------------------------------------------------

loc_62B9CED1:				; CODE XREF: _silc_client_commands_unregister+153j
client_0 = esi				; SilcClient
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9BAD5
; ---------------------------------------------------------------------------

loc_62B9CEDF:				; CODE XREF: _silc_client_commands_unregister+A3j
		mov	edi, [ebp+var_AC]
		mov	[ecx+5Ch], edi
		jmp	loc_62B9BA25
; ---------------------------------------------------------------------------

loc_62B9CEED:				; CODE XREF: _silc_client_commands_unregister+1266j
		mov	[ebp+var_9C], edi
		mov	[ebp+var_AC], ecx
		mov	esi, [ebp+var_24]

loc_62B9CEFC:				; CODE XREF: _silc_client_commands_unregister+20FDj
client_0 = esi				; SilcClient
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9CF24
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9CF24
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9CF24:				; CODE XREF: _silc_client_commands_unregister+1593j
					; _silc_client_commands_unregister+1599j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D73E

loc_62B9CF2D:				; CODE XREF: _silc_client_commands_unregister+1DCDj
		sub	dword ptr [eax+68h], 4
		mov	client_0, [client_0+18h]
		mov	[ebp+var_1C], esi
		jmp	loc_62B9CBF9
; ---------------------------------------------------------------------------

loc_62B9CF3C:				; CODE XREF: _silc_client_commands_unregister+136j
client_0 = esi				; SilcClient
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9CF4B:				; CODE XREF: _silc_client_commands_unregister+21F5j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9CF73
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9CF73
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9CF73:				; CODE XREF: _silc_client_commands_unregister+15E2j
					; _silc_client_commands_unregister+15E8j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D74E

loc_62B9CF7C:				; CODE XREF: _silc_client_commands_unregister+1DDDj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9BAC9
; ---------------------------------------------------------------------------

loc_62B9CF8B:				; CODE XREF: _silc_client_commands_unregister+86j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9CF9A:				; CODE XREF: _silc_client_commands_unregister+21D6j
		mov	edx, [ebp+var_1C]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9CFC2
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9CFC2
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9CFC2:				; CODE XREF: _silc_client_commands_unregister+1631j
					; _silc_client_commands_unregister+1637j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D76B

loc_62B9CFCB:				; CODE XREF: _silc_client_commands_unregister+1DFAj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_20], eax
		jmp	loc_62B9BA19
; ---------------------------------------------------------------------------

loc_62B9CFDA:				; CODE XREF: _silc_client_commands_unregister+B86j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9CFE9:				; CODE XREF: _silc_client_commands_unregister+2252j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D011
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D011
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D011:				; CODE XREF: _silc_client_commands_unregister+1680j
					; _silc_client_commands_unregister+1686j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D7AB

loc_62B9D01A:				; CODE XREF: _silc_client_commands_unregister+1E3Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C519
; ---------------------------------------------------------------------------

loc_62B9D029:				; CODE XREF: _silc_client_commands_unregister+A26j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D038:				; CODE XREF: _silc_client_commands_unregister+20DEj
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D060
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D060
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D060:				; CODE XREF: _silc_client_commands_unregister+16CFj
					; _silc_client_commands_unregister+16D5j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D78B

loc_62B9D069:				; CODE XREF: _silc_client_commands_unregister+1E1Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C3B9
; ---------------------------------------------------------------------------

loc_62B9D078:				; CODE XREF: _silc_client_commands_unregister+8C6j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D087:				; CODE XREF: _silc_client_commands_unregister+2290j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D0AF
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D0AF
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D0AF:				; CODE XREF: _silc_client_commands_unregister+171Ej
					; _silc_client_commands_unregister+1724j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D7CB

loc_62B9D0B8:				; CODE XREF: _silc_client_commands_unregister+1E5Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C259
; ---------------------------------------------------------------------------

loc_62B9D0C7:				; CODE XREF: _silc_client_commands_unregister+CE6j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D0D6:				; CODE XREF: _silc_client_commands_unregister+211Cj
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D0FE
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D0FE
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D0FE:				; CODE XREF: _silc_client_commands_unregister+176Dj
					; _silc_client_commands_unregister+1773j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D77B

loc_62B9D107:				; CODE XREF: _silc_client_commands_unregister+1E0Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C679
; ---------------------------------------------------------------------------

loc_62B9D116:				; CODE XREF: _silc_client_commands_unregister+E46j
		mov	[ebp+var_9C], edi
		mov	[ebp+var_AC], ecx
		mov	eax, [ebp+var_24]

loc_62B9D125:				; CODE XREF: _silc_client_commands_unregister+2271j
		mov	edx, [ebp+var_1C]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D14D
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D14D
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D14D:				; CODE XREF: _silc_client_commands_unregister+17BCj
					; _silc_client_commands_unregister+17C2j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D7BB

loc_62B9D156:				; CODE XREF: _silc_client_commands_unregister+1E4Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_20], eax
		jmp	loc_62B9C7D9
; ---------------------------------------------------------------------------

loc_62B9D165:				; CODE XREF: _silc_client_commands_unregister+1106j
		mov	[ebp+var_9C], edi
		mov	[ebp+var_AC], ecx
		mov	eax, [ebp+var_24]

loc_62B9D174:				; CODE XREF: _silc_client_commands_unregister+2233j
		mov	edx, [ebp+var_1C]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D19C
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D19C
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D19C:				; CODE XREF: _silc_client_commands_unregister+180Bj
					; _silc_client_commands_unregister+1811j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D79B

loc_62B9D1A5:				; CODE XREF: _silc_client_commands_unregister+1E2Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_20], eax
		jmp	loc_62B9CA99
; ---------------------------------------------------------------------------

loc_62B9D1B4:				; CODE XREF: _silc_client_commands_unregister+11B6j
		mov	[ebp+var_9C], edi
		mov	[ebp+var_AC], ecx
		mov	eax, [ebp+var_24]

loc_62B9D1C3:				; CODE XREF: _silc_client_commands_unregister+2005j
		mov	edx, [ebp+var_1C]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D1EB
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D1EB
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D1EB:				; CODE XREF: _silc_client_commands_unregister+185Aj
					; _silc_client_commands_unregister+1860j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D7DB

loc_62B9D1F4:				; CODE XREF: _silc_client_commands_unregister+1E6Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_20], eax
		jmp	loc_62B9CB49
; ---------------------------------------------------------------------------

loc_62B9D203:				; CODE XREF: _silc_client_commands_unregister+FA6j
		mov	[ebp+var_9C], edi
		mov	[ebp+var_AC], ecx
		mov	eax, [ebp+var_24]

loc_62B9D212:				; CODE XREF: _silc_client_commands_unregister+22AFj
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D23A
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D23A
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D23A:				; CODE XREF: _silc_client_commands_unregister+18A9j
					; _silc_client_commands_unregister+18AFj
		cmp	ebx, [eax+60h]
		jz	loc_62B9D7EB

loc_62B9D243:				; CODE XREF: _silc_client_commands_unregister+1E7Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C939
; ---------------------------------------------------------------------------

loc_62B9D252:				; CODE XREF: _silc_client_commands_unregister+3F6j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D261:				; CODE XREF: _silc_client_commands_unregister+215Aj
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D289
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D289
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D289:				; CODE XREF: _silc_client_commands_unregister+18F8j
					; _silc_client_commands_unregister+18FEj
		cmp	ebx, [eax+60h]
		jz	loc_62B9D86B

loc_62B9D292:				; CODE XREF: _silc_client_commands_unregister+1EFAj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9BD89
; ---------------------------------------------------------------------------

loc_62B9D2A1:				; CODE XREF: _silc_client_commands_unregister+346j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D2B0:				; CODE XREF: _silc_client_commands_unregister+2062j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D2D8
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D2D8
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D2D8:				; CODE XREF: _silc_client_commands_unregister+1947j
					; _silc_client_commands_unregister+194Dj
		cmp	ebx, [eax+60h]
		jz	loc_62B9D82B

loc_62B9D2E1:				; CODE XREF: _silc_client_commands_unregister+1EBAj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9BCD9
; ---------------------------------------------------------------------------

loc_62B9D2F0:				; CODE XREF: _silc_client_commands_unregister+976j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D2FF:				; CODE XREF: _silc_client_commands_unregister+1FE6j
		mov	edx, [ebp+var_1C]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D327
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D327
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D327:				; CODE XREF: _silc_client_commands_unregister+1996j
					; _silc_client_commands_unregister+199Cj
		cmp	ebx, [eax+60h]
		jz	loc_62B9D8AB

loc_62B9D330:				; CODE XREF: _silc_client_commands_unregister+1F3Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_20], eax
		jmp	loc_62B9C309
; ---------------------------------------------------------------------------

loc_62B9D33F:				; CODE XREF: _silc_client_commands_unregister+AD6j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D34E:				; CODE XREF: _silc_client_commands_unregister+1FA8j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D376
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D376
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D376:				; CODE XREF: _silc_client_commands_unregister+19E5j
					; _silc_client_commands_unregister+19EBj
		cmp	ebx, [eax+60h]
		jz	loc_62B9D80B

loc_62B9D37F:				; CODE XREF: _silc_client_commands_unregister+1E9Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C469
; ---------------------------------------------------------------------------

loc_62B9D38E:				; CODE XREF: _silc_client_commands_unregister+296j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D39D:				; CODE XREF: _silc_client_commands_unregister+2198j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D3C5
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D3C5
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D3C5:				; CODE XREF: _silc_client_commands_unregister+1A34j
					; _silc_client_commands_unregister+1A3Aj
		cmp	ebx, [eax+60h]
		jz	loc_62B9D88B

loc_62B9D3CE:				; CODE XREF: _silc_client_commands_unregister+1F1Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9BC29
; ---------------------------------------------------------------------------

loc_62B9D3DD:				; CODE XREF: _silc_client_commands_unregister+4A6j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D3EC:				; CODE XREF: _silc_client_commands_unregister+20A0j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D414
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D414
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D414:				; CODE XREF: _silc_client_commands_unregister+1A83j
					; _silc_client_commands_unregister+1A89j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D84B

loc_62B9D41D:				; CODE XREF: _silc_client_commands_unregister+1EDAj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9BE39
; ---------------------------------------------------------------------------

loc_62B9D42C:				; CODE XREF: _silc_client_commands_unregister+C36j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D43B:				; CODE XREF: _silc_client_commands_unregister+2024j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D463
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D463
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D463:				; CODE XREF: _silc_client_commands_unregister+1AD2j
					; _silc_client_commands_unregister+1AD8j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D8CB

loc_62B9D46C:				; CODE XREF: _silc_client_commands_unregister+1F5Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C5C9
; ---------------------------------------------------------------------------

loc_62B9D47B:				; CODE XREF: _silc_client_commands_unregister+816j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D48A:				; CODE XREF: _silc_client_commands_unregister+1F89j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D4B2
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D4B2
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D4B2:				; CODE XREF: _silc_client_commands_unregister+1B21j
					; _silc_client_commands_unregister+1B27j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D7FB

loc_62B9D4BB:				; CODE XREF: _silc_client_commands_unregister+1E8Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C1A9
; ---------------------------------------------------------------------------

loc_62B9D4CA:				; CODE XREF: _silc_client_commands_unregister+556j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D4D9:				; CODE XREF: _silc_client_commands_unregister+2179j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D501
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D501
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D501:				; CODE XREF: _silc_client_commands_unregister+1B70j
					; _silc_client_commands_unregister+1B76j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D87B

loc_62B9D50A:				; CODE XREF: _silc_client_commands_unregister+1F0Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9BEE9
; ---------------------------------------------------------------------------

loc_62B9D519:				; CODE XREF: _silc_client_commands_unregister+6B6j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D528:				; CODE XREF: _silc_client_commands_unregister+213Bj
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D550
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D550
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D550:				; CODE XREF: _silc_client_commands_unregister+1BBFj
					; _silc_client_commands_unregister+1BC5j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D83B

loc_62B9D559:				; CODE XREF: _silc_client_commands_unregister+1ECAj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C049
; ---------------------------------------------------------------------------

loc_62B9D568:				; CODE XREF: _silc_client_commands_unregister+1056j
		mov	[ebp+var_9C], edi
		mov	[ebp+var_AC], ecx
		mov	eax, [ebp+var_24]

loc_62B9D577:				; CODE XREF: _silc_client_commands_unregister+20BFj
		mov	edx, [ebp+var_1C]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D59F
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D59F
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D59F:				; CODE XREF: _silc_client_commands_unregister+1C0Ej
					; _silc_client_commands_unregister+1C14j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D8BB

loc_62B9D5A8:				; CODE XREF: _silc_client_commands_unregister+1F4Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_20], eax
		jmp	loc_62B9C9E9
; ---------------------------------------------------------------------------

loc_62B9D5B7:				; CODE XREF: _silc_client_commands_unregister+D96j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D5C6:				; CODE XREF: _silc_client_commands_unregister+1FC7j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D5EE
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D5EE
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D5EE:				; CODE XREF: _silc_client_commands_unregister+1C5Dj
					; _silc_client_commands_unregister+1C63j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D81B

loc_62B9D5F7:				; CODE XREF: _silc_client_commands_unregister+1EAAj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C729
; ---------------------------------------------------------------------------

loc_62B9D606:				; CODE XREF: _silc_client_commands_unregister+1E6j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D615:				; CODE XREF: _silc_client_commands_unregister+2214j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D63D
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D63D
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D63D:				; CODE XREF: _silc_client_commands_unregister+1CACj
					; _silc_client_commands_unregister+1CB2j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D89B

loc_62B9D646:				; CODE XREF: _silc_client_commands_unregister+1F2Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9BB79
; ---------------------------------------------------------------------------

loc_62B9D655:				; CODE XREF: _silc_client_commands_unregister+606j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D664:				; CODE XREF: _silc_client_commands_unregister+2043j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D68C
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D68C
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D68C:				; CODE XREF: _silc_client_commands_unregister+1CFBj
					; _silc_client_commands_unregister+1D01j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D85B

loc_62B9D695:				; CODE XREF: _silc_client_commands_unregister+1EEAj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9BF99
; ---------------------------------------------------------------------------

loc_62B9D6A4:				; CODE XREF: _silc_client_commands_unregister+EF6j
		mov	[ebp+var_9C], edi
		mov	[ebp+var_AC], ecx
		mov	eax, [ebp+var_24]

loc_62B9D6B3:				; CODE XREF: _silc_client_commands_unregister+21B7j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D6DB
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D6DB
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D6DB:				; CODE XREF: _silc_client_commands_unregister+1D4Aj
					; _silc_client_commands_unregister+1D50j
		cmp	ebx, [eax+60h]
		jz	loc_62B9D8DB

loc_62B9D6E4:				; CODE XREF: _silc_client_commands_unregister+1F6Aj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C889
; ---------------------------------------------------------------------------

loc_62B9D6F3:				; CODE XREF: _silc_client_commands_unregister+766j
		mov	[ebp+var_AC], ecx
		mov	[ebp+var_9C], edi
		mov	eax, [ebp+var_24]

loc_62B9D702:				; CODE XREF: _silc_client_commands_unregister+2081j
		mov	edx, [ebp+var_20]
		mov	edx, [ebx+edx]
		mov	[ebp+var_20], edx
		mov	ecx, [ebp+var_9C]
		mov	[ecx], edx
		test	edx, edx
		jz	short loc_62B9D72A
		test	byte ptr [eax+68h], 1
		jz	short loc_62B9D72A
		movzx	edi, word ptr [eax+66h]
		mov	edx, [ebx+edi]
		mov	ecx, [ebp+var_20]
		mov	[ecx+edi], edx

loc_62B9D72A:				; CODE XREF: _silc_client_commands_unregister+1D99j
					; _silc_client_commands_unregister+1D9Fj
		cmp	ebx, [eax+60h]
		jz	short loc_62B9D75E

loc_62B9D72F:				; CODE XREF: _silc_client_commands_unregister+1DEDj
		sub	dword ptr [eax+68h], 4
		mov	eax, [client_0+18h]
		mov	[ebp+var_1C], eax
		jmp	loc_62B9C0F9
; ---------------------------------------------------------------------------

loc_62B9D73E:				; CODE XREF: _silc_client_commands_unregister+15ABj
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9CF2D
; ---------------------------------------------------------------------------

loc_62B9D74E:				; CODE XREF: _silc_client_commands_unregister+15FAj
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9CF7C
; ---------------------------------------------------------------------------

loc_62B9D75E:				; CODE XREF: _silc_client_commands_unregister+1DB1j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	short loc_62B9D72F
; ---------------------------------------------------------------------------

loc_62B9D76B:				; CODE XREF: _silc_client_commands_unregister+1649j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9CFCB
; ---------------------------------------------------------------------------

loc_62B9D77B:				; CODE XREF: _silc_client_commands_unregister+1785j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D107
; ---------------------------------------------------------------------------

loc_62B9D78B:				; CODE XREF: _silc_client_commands_unregister+16E7j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D069
; ---------------------------------------------------------------------------

loc_62B9D79B:				; CODE XREF: _silc_client_commands_unregister+1823j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D1A5
; ---------------------------------------------------------------------------

loc_62B9D7AB:				; CODE XREF: _silc_client_commands_unregister+1698j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D01A
; ---------------------------------------------------------------------------

loc_62B9D7BB:				; CODE XREF: _silc_client_commands_unregister+17D4j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D156
; ---------------------------------------------------------------------------

loc_62B9D7CB:				; CODE XREF: _silc_client_commands_unregister+1736j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D0B8
; ---------------------------------------------------------------------------

loc_62B9D7DB:				; CODE XREF: _silc_client_commands_unregister+1872j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D1F4
; ---------------------------------------------------------------------------

loc_62B9D7EB:				; CODE XREF: _silc_client_commands_unregister+18C1j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D243
; ---------------------------------------------------------------------------

loc_62B9D7FB:				; CODE XREF: _silc_client_commands_unregister+1B39j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D4BB
; ---------------------------------------------------------------------------

loc_62B9D80B:				; CODE XREF: _silc_client_commands_unregister+19FDj
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D37F
; ---------------------------------------------------------------------------

loc_62B9D81B:				; CODE XREF: _silc_client_commands_unregister+1C75j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D5F7
; ---------------------------------------------------------------------------

loc_62B9D82B:				; CODE XREF: _silc_client_commands_unregister+195Fj
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D2E1
; ---------------------------------------------------------------------------

loc_62B9D83B:				; CODE XREF: _silc_client_commands_unregister+1BD7j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D559
; ---------------------------------------------------------------------------

loc_62B9D84B:				; CODE XREF: _silc_client_commands_unregister+1A9Bj
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D41D
; ---------------------------------------------------------------------------

loc_62B9D85B:				; CODE XREF: _silc_client_commands_unregister+1D13j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D695
; ---------------------------------------------------------------------------

loc_62B9D86B:				; CODE XREF: _silc_client_commands_unregister+1910j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D292
; ---------------------------------------------------------------------------

loc_62B9D87B:				; CODE XREF: _silc_client_commands_unregister+1B88j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D50A
; ---------------------------------------------------------------------------

loc_62B9D88B:				; CODE XREF: _silc_client_commands_unregister+1A4Cj
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D3CE
; ---------------------------------------------------------------------------

loc_62B9D89B:				; CODE XREF: _silc_client_commands_unregister+1CC4j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D646
; ---------------------------------------------------------------------------

loc_62B9D8AB:				; CODE XREF: _silc_client_commands_unregister+19AEj
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D330
; ---------------------------------------------------------------------------

loc_62B9D8BB:				; CODE XREF: _silc_client_commands_unregister+1C26j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D5A8
; ---------------------------------------------------------------------------

loc_62B9D8CB:				; CODE XREF: _silc_client_commands_unregister+1AEAj
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D46C
; ---------------------------------------------------------------------------

loc_62B9D8DB:				; CODE XREF: _silc_client_commands_unregister+1D62j
		mov	edi, [ebp+var_9C]
		mov	edx, [edi]
		mov	[eax+60h], edx
		jmp	loc_62B9D6E4
; ---------------------------------------------------------------------------

loc_62B9D8EB:				; CODE XREF: _silc_client_commands_unregister+7F9j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D48A
; ---------------------------------------------------------------------------

loc_62B9D90A:				; CODE XREF: _silc_client_commands_unregister+AB9j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D34E
; ---------------------------------------------------------------------------

loc_62B9D929:				; CODE XREF: _silc_client_commands_unregister+D79j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D5C6
; ---------------------------------------------------------------------------

loc_62B9D948:				; CODE XREF: _silc_client_commands_unregister+959j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_1C], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D2FF
; ---------------------------------------------------------------------------

loc_62B9D967:				; CODE XREF: _silc_client_commands_unregister+1199j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_1C], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D1C3
; ---------------------------------------------------------------------------

loc_62B9D986:				; CODE XREF: _silc_client_commands_unregister+C19j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D43B
; ---------------------------------------------------------------------------

loc_62B9D9A5:				; CODE XREF: _silc_client_commands_unregister+5E9j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D664
; ---------------------------------------------------------------------------

loc_62B9D9C4:				; CODE XREF: _silc_client_commands_unregister+329j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D2B0
; ---------------------------------------------------------------------------

loc_62B9D9E3:				; CODE XREF: _silc_client_commands_unregister+749j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D702
; ---------------------------------------------------------------------------

loc_62B9DA02:				; CODE XREF: _silc_client_commands_unregister+489j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D3EC
; ---------------------------------------------------------------------------

loc_62B9DA21:				; CODE XREF: _silc_client_commands_unregister+1039j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_1C], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D577
; ---------------------------------------------------------------------------

loc_62B9DA40:				; CODE XREF: _silc_client_commands_unregister+A09j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D038
; ---------------------------------------------------------------------------

loc_62B9DA5F:				; CODE XREF: _silc_client_commands_unregister+1249j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9CEFC
; ---------------------------------------------------------------------------

loc_62B9DA7E:				; CODE XREF: _silc_client_commands_unregister+CC9j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D0D6
; ---------------------------------------------------------------------------

loc_62B9DA9D:				; CODE XREF: _silc_client_commands_unregister+699j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D528
; ---------------------------------------------------------------------------

loc_62B9DABC:				; CODE XREF: _silc_client_commands_unregister+3D9j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D261
; ---------------------------------------------------------------------------

loc_62B9DADB:				; CODE XREF: _silc_client_commands_unregister+539j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D4D9
; ---------------------------------------------------------------------------

loc_62B9DAFA:				; CODE XREF: _silc_client_commands_unregister+279j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D39D
; ---------------------------------------------------------------------------

loc_62B9DB19:				; CODE XREF: _silc_client_commands_unregister+ED9j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D6B3
; ---------------------------------------------------------------------------

loc_62B9DB38:				; CODE XREF: _silc_client_commands_unregister+69j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_1C], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9CF9A
; ---------------------------------------------------------------------------

loc_62B9DB57:				; CODE XREF: _silc_client_commands_unregister+119j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9CF4B
; ---------------------------------------------------------------------------

loc_62B9DB76:				; CODE XREF: _silc_client_commands_unregister+1C9j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D615
; ---------------------------------------------------------------------------

loc_62B9DB95:				; CODE XREF: _silc_client_commands_unregister+10E9j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_1C], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D174
; ---------------------------------------------------------------------------

loc_62B9DBB4:				; CODE XREF: _silc_client_commands_unregister+B69j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9CFE9
; ---------------------------------------------------------------------------

loc_62B9DBD3:				; CODE XREF: _silc_client_commands_unregister+E29j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_1C], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D125
; ---------------------------------------------------------------------------

loc_62B9DBF2:				; CODE XREF: _silc_client_commands_unregister+8A9j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D087
; ---------------------------------------------------------------------------

loc_62B9DC11:				; CODE XREF: _silc_client_commands_unregister+F89j
		lea	ecx, [eax+58h]
		mov	[ebp+var_9C], ecx
		movzx	edi, word ptr [eax+64h]
		mov	[ebp+var_20], edi
		mov	[ebp+var_AC], 0
		jmp	loc_62B9D212
_silc_client_commands_unregister endp

; Exported entry  92. silc_client_commands_register

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl silc_client_commands_register(SilcClient	client)
		public _silc_client_commands_register
_silc_client_commands_register proc near ; CODE	XREF: _silc_client_init+1A4p

client		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, [ebp+client]
		mov	eax, [ebx+18h]
		and	dword ptr [eax+68h], 3
		mov	eax, [ebx+18h]
		mov	word ptr [eax+64h], 0
		and	byte ptr [eax+68h], 0FEh
		mov	eax, [ebx+18h]
		mov	word ptr [eax+66h], 0
		and	byte ptr [eax+68h], 0FDh
		mov	eax, [ebx+18h]
		mov	dword ptr [eax+60h], 0
		mov	dword ptr [eax+5Ch], 0
		mov	dword ptr [eax+58h], 0
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9DCEF
client_0 = ebx				; SilcClient
		mov	byte ptr [eax+4], 1
		mov	dword ptr [eax+8], offset _silc_client_command_whois
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_whois
		mov	byte ptr [eax+14h], 5
		mov	dword ptr [esp], offset	aWhois ; "WHOIS"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA30
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E9C8
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9DCD3:				; CODE XREF: _silc_client_commands_register+D9Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E920

loc_62B9DCDD:				; CODE XREF: _silc_client_commands_register+CFAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9DCEF:				; CODE XREF: _silc_client_commands_register+5Cj
					; _silc_client_commands_register+E08j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9DD6A
		mov	byte ptr [eax+4], 2
		mov	dword ptr [eax+8], offset _silc_client_command_whowas
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_whowas
		mov	byte ptr [eax+14h], 3
		mov	dword ptr [esp], offset	aWhowas	; "WHOWAS"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA20
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E9D0
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9DD4E:				; CODE XREF: _silc_client_commands_register+DA3j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E910

loc_62B9DD58:				; CODE XREF: _silc_client_commands_register+CEAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9DD6A:				; CODE XREF: _silc_client_commands_register+D7j
					; _silc_client_commands_register+DF8j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9DDE5
		mov	byte ptr [eax+4], 3
		mov	dword ptr [eax+8], offset _silc_client_command_identify
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_identify
		mov	byte ptr [eax+14h], 3
		mov	dword ptr [esp], offset	aIdentify ; "IDENTIFY"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA90
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E9B8
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9DDC9:				; CODE XREF: _silc_client_commands_register+D8Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E900

loc_62B9DDD3:				; CODE XREF: _silc_client_commands_register+CDAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9DDE5:				; CODE XREF: _silc_client_commands_register+152j
					; _silc_client_commands_register+E68j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9DE60
		mov	byte ptr [eax+4], 4
		mov	dword ptr [eax+8], offset _silc_client_command_nick
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_nick
		mov	byte ptr [eax+14h], 2
		mov	dword ptr [esp], offset	aNick_0	; "NICK"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA80
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E9C0
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9DE44:				; CODE XREF: _silc_client_commands_register+D93j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E8F0

loc_62B9DE4E:				; CODE XREF: _silc_client_commands_register+CCAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9DE60:				; CODE XREF: _silc_client_commands_register+1CDj
					; _silc_client_commands_register+E58j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9DEDB
		mov	byte ptr [eax+4], 5
		mov	dword ptr [eax+8], offset _silc_client_command_list
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_list
		mov	byte ptr [eax+14h], 2
		mov	dword ptr [esp], offset	aList ;	"LIST"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA50
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E9D8
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9DEBF:				; CODE XREF: _silc_client_commands_register+DABj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E8E0

loc_62B9DEC9:				; CODE XREF: _silc_client_commands_register+CBAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9DEDB:				; CODE XREF: _silc_client_commands_register+248j
					; _silc_client_commands_register+E28j
		mov	dword ptr [esp+8], 3 ; max_args
		mov	dword ptr [esp+4], offset _silc_client_command_reply_topic ; command_reply_func
		mov	dword ptr [esp], offset	_silc_client_command_topic ; command_func
		mov	ecx, offset name ; "TOPIC"
		mov	edx, 6		; command
		mov	eax, client_0	; client
		call	_silc_client_command_register
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9DF7E
		mov	byte ptr [eax+4], 7
		mov	dword ptr [eax+8], offset _silc_client_command_invite
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_invite
		mov	byte ptr [eax+14h], 3
		mov	dword ptr [esp], offset	aInvite	; "INVITE"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA40
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E930
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9DF62:				; CODE XREF: _silc_client_commands_register+D03j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E8D0

loc_62B9DF6C:				; CODE XREF: _silc_client_commands_register+CAAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9DF7E:				; CODE XREF: _silc_client_commands_register+2EBj
					; _silc_client_commands_register+E18j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9DFF9
		mov	byte ptr [eax+4], 8
		mov	dword ptr [eax+8], offset _silc_client_command_quit
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_quit
		mov	byte ptr [eax+14h], 2
		mov	dword ptr [esp], offset	aQuit ;	"QUIT"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EB30
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E968
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9DFDD:				; CODE XREF: _silc_client_commands_register+D3Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E8C0

loc_62B9DFE7:				; CODE XREF: _silc_client_commands_register+C9Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9DFF9:				; CODE XREF: _silc_client_commands_register+366j
					; _silc_client_commands_register+F08j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E074
		mov	byte ptr [eax+4], 9
		mov	dword ptr [eax+8], offset _silc_client_command_kill
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_kill
		mov	byte ptr [eax+14h], 4
		mov	dword ptr [esp], offset	aKill ;	"KILL"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EAE0
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E970
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E058:				; CODE XREF: _silc_client_commands_register+D43j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E8B0

loc_62B9E062:				; CODE XREF: _silc_client_commands_register+C8Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E074:				; CODE XREF: _silc_client_commands_register+3E1j
					; _silc_client_commands_register+EB8j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E0EF
		mov	byte ptr [eax+4], 0Ah
		mov	dword ptr [eax+8], offset _silc_client_command_info
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_info
		mov	byte ptr [eax+14h], 2
		mov	dword ptr [esp], offset	aInfo ;	"INFO"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9E9F0
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E948
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E0D3:				; CODE XREF: _silc_client_commands_register+D1Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E8A0

loc_62B9E0DD:				; CODE XREF: _silc_client_commands_register+C7Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E0EF:				; CODE XREF: _silc_client_commands_register+45Cj
					; _silc_client_commands_register+DC8j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E16A
		mov	byte ptr [eax+4], 0Bh
		mov	dword ptr [eax+8], offset _silc_client_command_stats
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_stats
		mov	byte ptr [eax+14h], 0
		mov	dword ptr [esp], offset	aStats ; "STATS"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EB00
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E950
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E14E:				; CODE XREF: _silc_client_commands_register+D23j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E890

loc_62B9E158:				; CODE XREF: _silc_client_commands_register+C6Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E16A:				; CODE XREF: _silc_client_commands_register+4D7j
					; _silc_client_commands_register+ED8j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E1E5
		mov	byte ptr [eax+4], 0Ch
		mov	dword ptr [eax+8], offset _silc_client_command_ping
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_ping
		mov	byte ptr [eax+14h], 2
		mov	dword ptr [esp], offset	aPing ;	"PING"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EAF0
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E938
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E1C9:				; CODE XREF: _silc_client_commands_register+D0Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E880

loc_62B9E1D3:				; CODE XREF: _silc_client_commands_register+C5Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E1E5:				; CODE XREF: _silc_client_commands_register+552j
					; _silc_client_commands_register+EC8j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E260
		mov	byte ptr [eax+4], 0Dh
		mov	dword ptr [eax+8], offset _silc_client_command_oper
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_oper
		mov	byte ptr [eax+14h], 3
		mov	dword ptr [esp], offset	aOper ;	"OPER"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EB10
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E940
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E244:				; CODE XREF: _silc_client_commands_register+D13j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E870

loc_62B9E24E:				; CODE XREF: _silc_client_commands_register+C4Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E260:				; CODE XREF: _silc_client_commands_register+5CDj
					; _silc_client_commands_register+EE8j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E2DB
		mov	byte ptr [eax+4], 0Eh
		mov	dword ptr [eax+8], offset _silc_client_command_join
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_join
		mov	byte ptr [eax+14h], 9
		mov	dword ptr [esp], offset	aJoin ;	"JOIN"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA10
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E958
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E2BF:				; CODE XREF: _silc_client_commands_register+D2Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E860

loc_62B9E2C9:				; CODE XREF: _silc_client_commands_register+C3Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E2DB:				; CODE XREF: _silc_client_commands_register+648j
					; _silc_client_commands_register+DE8j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E356
		mov	byte ptr [eax+4], 0Fh
		mov	dword ptr [eax+8], offset _silc_client_command_motd
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_motd
		mov	byte ptr [eax+14h], 2
		mov	dword ptr [esp], offset	aMotd ;	"MOTD"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA00
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E960
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E33A:				; CODE XREF: _silc_client_commands_register+D33j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E850

loc_62B9E344:				; CODE XREF: _silc_client_commands_register+C2Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E356:				; CODE XREF: _silc_client_commands_register+6C3j
					; _silc_client_commands_register+DD8j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E3D1
		mov	byte ptr [eax+4], 10h
		mov	dword ptr [eax+8], offset _silc_client_command_umode
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_umode
		mov	byte ptr [eax+14h], 2
		mov	dword ptr [esp], offset	aUmode ; "UMODE"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EAB0
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E988
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E3B5:				; CODE XREF: _silc_client_commands_register+D5Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E840

loc_62B9E3BF:				; CODE XREF: _silc_client_commands_register+C1Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E3D1:				; CODE XREF: _silc_client_commands_register+73Ej
					; _silc_client_commands_register+E88j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E44C
		mov	byte ptr [eax+4], 11h
		mov	dword ptr [eax+8], offset _silc_client_command_cmode
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_cmode
		mov	byte ptr [eax+14h], 6
		mov	dword ptr [esp], offset	aCmode ; "CMODE"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EAA0
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E990
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E430:				; CODE XREF: _silc_client_commands_register+D63j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E830

loc_62B9E43A:				; CODE XREF: _silc_client_commands_register+C0Aj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E44C:				; CODE XREF: _silc_client_commands_register+7B9j
					; _silc_client_commands_register+E78j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E4C7
		mov	byte ptr [eax+4], 12h
		mov	dword ptr [eax+8], offset _silc_client_command_cumode
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_cumode
		mov	byte ptr [eax+14h], 9
		mov	dword ptr [esp], offset	aCumode	; "CUMODE"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA70
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E9A8
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E4AB:				; CODE XREF: _silc_client_commands_register+D7Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E820

loc_62B9E4B5:				; CODE XREF: _silc_client_commands_register+BFAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E4C7:				; CODE XREF: _silc_client_commands_register+834j
					; _silc_client_commands_register+E48j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E542
		mov	byte ptr [eax+4], 13h
		mov	dword ptr [eax+8], offset _silc_client_command_kick
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_kick
		mov	byte ptr [eax+14h], 4
		mov	dword ptr [esp], offset	aKick ;	"KICK"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EA60
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E9B0
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E526:				; CODE XREF: _silc_client_commands_register+D83j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E810

loc_62B9E530:				; CODE XREF: _silc_client_commands_register+BEAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E542:				; CODE XREF: _silc_client_commands_register+8AFj
					; _silc_client_commands_register+E38j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E5BD
		mov	byte ptr [eax+4], 14h
		mov	dword ptr [eax+8], offset _silc_client_command_ban
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_ban
		mov	byte ptr [eax+14h], 3
		mov	dword ptr [esp], offset	aBan ; "BAN"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EAD0
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E998
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E5A1:				; CODE XREF: _silc_client_commands_register+D6Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E800

loc_62B9E5AB:				; CODE XREF: _silc_client_commands_register+BDAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E5BD:				; CODE XREF: _silc_client_commands_register+92Aj
					; _silc_client_commands_register+EA8j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E638
		mov	byte ptr [eax+4], 15h
		mov	dword ptr [eax+8], offset _silc_client_command_detach
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_detach
		mov	byte ptr [eax+14h], 0
		mov	dword ptr [esp], offset	aDetach	; "DETACH"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EAC0
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E9A0
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E61C:				; CODE XREF: _silc_client_commands_register+D73j
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E7F0

loc_62B9E626:				; CODE XREF: _silc_client_commands_register+BCAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E638:				; CODE XREF: _silc_client_commands_register+9A5j
					; _silc_client_commands_register+E98j
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E6B3
		mov	byte ptr [eax+4], 16h
		mov	dword ptr [eax+8], offset _silc_client_command_watch
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_watch
		mov	byte ptr [eax+14h], 3
		mov	dword ptr [esp], offset	aWatch ; "WATCH"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9EB20
		mov	edx, [client_0+18h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	loc_62B9E978
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E697:				; CODE XREF: _silc_client_commands_register+D4Bj
		test	byte ptr [edx+68h], 1
		jnz	loc_62B9E7E0

loc_62B9E6A1:				; CODE XREF: _silc_client_commands_register+BBAj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E6B3:				; CODE XREF: _silc_client_commands_register+A20j
					; _silc_client_commands_register+EF8j
		mov	dword ptr [esp+8], 3 ; max_args
		mov	dword ptr [esp+4], offset _silc_client_command_reply_silcoper ;	command_reply_func
		mov	dword ptr [esp], offset	_silc_client_command_silcoper ;	command_func
		mov	ecx, offset aSilcoper ;	"SILCOPER"
		mov	edx, 17h	; command
		mov	eax, client_0	; client
		call	_silc_client_command_register
		mov	dword ptr [esp+8], 2 ; max_args
		mov	dword ptr [esp+4], offset _silc_client_command_reply_leave ; command_reply_func
		mov	dword ptr [esp], offset	_silc_client_command_leave ; command_func
		mov	ecx, offset aLeave ; "LEAVE"
		mov	edx, 18h	; command
		mov	eax, client_0	; client
		call	_silc_client_command_register
		mov	dword ptr [esp+8], 2 ; max_args
		mov	dword ptr [esp+4], offset _silc_client_command_reply_users ; command_reply_func
		mov	dword ptr [esp], offset	_silc_client_command_users ; command_func
		mov	ecx, offset aUsers ; "USERS"
		mov	edx, 19h	; command
		mov	eax, client_0	; client
		call	_silc_client_command_register
		mov	dword ptr [esp+8], 2 ; max_args
		mov	dword ptr [esp+4], offset _silc_client_command_reply_getkey ; command_reply_func
		mov	dword ptr [esp], offset	_silc_client_command_getkey ; command_func
		mov	ecx, offset aGetkey ; "GETKEY"
		mov	edx, 1Ah	; command
		mov	eax, client_0	; client
		call	_silc_client_command_register
		mov	dword ptr [esp+4], 18h
		mov	dword ptr [esp], 1
		call	_silc_calloc
		mov	esi, eax
		test	eax, eax
		jz	short loc_62B9E7CA
		mov	byte ptr [eax+4], 1Bh
		mov	dword ptr [eax+8], offset _silc_client_command_service
		mov	dword ptr [eax+0Ch], offset _silc_client_command_reply_service
		mov	byte ptr [eax+14h], 0Ah
		mov	dword ptr [esp], offset	aService ; "SERVICE"
		call	_strdup
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_62B9E9E0
		mov	edx, [client_0+18h]
		mov	ecx, [edx+58h]
		test	ecx, ecx
		jz	loc_62B9E980
		movzx	eax, word ptr [edx+64h]
		mov	ecx, [edx+5Ch]
		mov	[ecx+eax], esi

loc_62B9E7B2:				; CODE XREF: _silc_client_commands_register+D53j
		test	byte ptr [edx+68h], 1
		jnz	short loc_62B9E7D4

loc_62B9E7B8:				; CODE XREF: _silc_client_commands_register+BAEj
		mov	[edx+5Ch], esi
		movzx	eax, word ptr [edx+64h]
		mov	dword ptr [esi+eax], 0
		add	dword ptr [edx+68h], 4

loc_62B9E7CA:				; CODE XREF: _silc_client_commands_register+B3Bj
		add	esp, 10h
		pop	client_0
		pop	esi
		leave
		retn
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
		align 4

loc_62B9E7D4:				; CODE XREF: _silc_client_commands_register+B86j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	short loc_62B9E7B8
; ---------------------------------------------------------------------------

loc_62B9E7E0:				; CODE XREF: _silc_client_commands_register+A6Bj
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E6A1
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E7F0:				; CODE XREF: _silc_client_commands_register+9F0j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E626
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E800:				; CODE XREF: _silc_client_commands_register+975j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E5AB
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E810:				; CODE XREF: _silc_client_commands_register+8FAj
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E530
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E820:				; CODE XREF: _silc_client_commands_register+87Fj
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E4B5
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E830:				; CODE XREF: _silc_client_commands_register+804j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E43A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E840:				; CODE XREF: _silc_client_commands_register+789j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E3BF
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E850:				; CODE XREF: _silc_client_commands_register+70Ej
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E344
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E860:				; CODE XREF: _silc_client_commands_register+693j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E2C9
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E870:				; CODE XREF: _silc_client_commands_register+618j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E24E
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E880:				; CODE XREF: _silc_client_commands_register+59Dj
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E1D3
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E890:				; CODE XREF: _silc_client_commands_register+522j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E158
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E8A0:				; CODE XREF: _silc_client_commands_register+4A7j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E0DD
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E8B0:				; CODE XREF: _silc_client_commands_register+42Cj
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9E062
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E8C0:				; CODE XREF: _silc_client_commands_register+3B1j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9DFE7
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E8D0:				; CODE XREF: _silc_client_commands_register+336j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9DF6C
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E8E0:				; CODE XREF: _silc_client_commands_register+293j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9DEC9
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E8F0:				; CODE XREF: _silc_client_commands_register+218j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9DE4E
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E900:				; CODE XREF: _silc_client_commands_register+19Dj
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9DDD3
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E910:				; CODE XREF: _silc_client_commands_register+122j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9DD58
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E920:				; CODE XREF: _silc_client_commands_register+A7j
		movzx	eax, word ptr [edx+66h]
		mov	ecx, [edx+5Ch]
		mov	[esi+eax], ecx
		jmp	loc_62B9DCDD
; ---------------------------------------------------------------------------
		align 10h

loc_62B9E930:				; CODE XREF: _silc_client_commands_register+322j
		mov	[edx+58h], esi
		jmp	loc_62B9DF62
; ---------------------------------------------------------------------------

loc_62B9E938:				; CODE XREF: _silc_client_commands_register+589j
		mov	[edx+58h], esi
		jmp	loc_62B9E1C9
; ---------------------------------------------------------------------------

loc_62B9E940:				; CODE XREF: _silc_client_commands_register+604j
		mov	[edx+58h], esi
		jmp	loc_62B9E244
; ---------------------------------------------------------------------------

loc_62B9E948:				; CODE XREF: _silc_client_commands_register+493j
		mov	[edx+58h], esi
		jmp	loc_62B9E0D3
; ---------------------------------------------------------------------------

loc_62B9E950:				; CODE XREF: _silc_client_commands_register+50Ej
		mov	[edx+58h], esi
		jmp	loc_62B9E14E
; ---------------------------------------------------------------------------

loc_62B9E958:				; CODE XREF: _silc_client_commands_register+67Fj
		mov	[edx+58h], esi
		jmp	loc_62B9E2BF
; ---------------------------------------------------------------------------

loc_62B9E960:				; CODE XREF: _silc_client_commands_register+6FAj
		mov	[edx+58h], esi
		jmp	loc_62B9E33A
; ---------------------------------------------------------------------------

loc_62B9E968:				; CODE XREF: _silc_client_commands_register+39Dj
		mov	[edx+58h], esi
		jmp	loc_62B9DFDD
; ---------------------------------------------------------------------------

loc_62B9E970:				; CODE XREF: _silc_client_commands_register+418j
		mov	[edx+58h], esi
		jmp	loc_62B9E058
; ---------------------------------------------------------------------------

loc_62B9E978:				; CODE XREF: _silc_client_commands_register+A57j
		mov	[edx+58h], esi
		jmp	loc_62B9E697
; ---------------------------------------------------------------------------

loc_62B9E980:				; CODE XREF: _silc_client_commands_register+B72j
		mov	[edx+58h], esi
		jmp	loc_62B9E7B2
; ---------------------------------------------------------------------------

loc_62B9E988:				; CODE XREF: _silc_client_commands_register+775j
		mov	[edx+58h], esi
		jmp	loc_62B9E3B5
; ---------------------------------------------------------------------------

loc_62B9E990:				; CODE XREF: _silc_client_commands_register+7F0j
		mov	[edx+58h], esi
		jmp	loc_62B9E430
; ---------------------------------------------------------------------------

loc_62B9E998:				; CODE XREF: _silc_client_commands_register+961j
		mov	[edx+58h], esi
		jmp	loc_62B9E5A1
; ---------------------------------------------------------------------------

loc_62B9E9A0:				; CODE XREF: _silc_client_commands_register+9DCj
		mov	[edx+58h], esi
		jmp	loc_62B9E61C
; ---------------------------------------------------------------------------

loc_62B9E9A8:				; CODE XREF: _silc_client_commands_register+86Bj
		mov	[edx+58h], esi
		jmp	loc_62B9E4AB
; ---------------------------------------------------------------------------

loc_62B9E9B0:				; CODE XREF: _silc_client_commands_register+8E6j
		mov	[edx+58h], esi
		jmp	loc_62B9E526
; ---------------------------------------------------------------------------

loc_62B9E9B8:				; CODE XREF: _silc_client_commands_register+189j
		mov	[edx+58h], esi
		jmp	loc_62B9DDC9
; ---------------------------------------------------------------------------

loc_62B9E9C0:				; CODE XREF: _silc_client_commands_register+204j
		mov	[edx+58h], esi
		jmp	loc_62B9DE44
; ---------------------------------------------------------------------------

loc_62B9E9C8:				; CODE XREF: _silc_client_commands_register+93j
		mov	[edx+58h], esi
		jmp	loc_62B9DCD3
; ---------------------------------------------------------------------------

loc_62B9E9D0:				; CODE XREF: _silc_client_commands_register+10Ej
		mov	[edx+58h], esi
		jmp	loc_62B9DD4E
; ---------------------------------------------------------------------------

loc_62B9E9D8:				; CODE XREF: _silc_client_commands_register+27Fj
		mov	[edx+58h], esi
		jmp	loc_62B9DEBF
; ---------------------------------------------------------------------------

loc_62B9E9E0:				; CODE XREF: _silc_client_commands_register+B64j
		mov	[ebp+client], esi
		add	esp, 10h
		pop	client_0
		pop	esi
		leave
		jmp	_silc_free
; ---------------------------------------------------------------------------
client_0 = ebx				; SilcClient
		align 10h

loc_62B9E9F0:				; CODE XREF: _silc_client_commands_register+485j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E0EF
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA00:				; CODE XREF: _silc_client_commands_register+6ECj
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E356
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA10:				; CODE XREF: _silc_client_commands_register+671j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E2DB
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA20:				; CODE XREF: _silc_client_commands_register+100j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9DD6A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA30:				; CODE XREF: _silc_client_commands_register+85j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9DCEF
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA40:				; CODE XREF: _silc_client_commands_register+314j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9DF7E
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA50:				; CODE XREF: _silc_client_commands_register+271j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9DEDB
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA60:				; CODE XREF: _silc_client_commands_register+8D8j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E542
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA70:				; CODE XREF: _silc_client_commands_register+85Dj
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E4C7
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA80:				; CODE XREF: _silc_client_commands_register+1F6j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9DE60
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EA90:				; CODE XREF: _silc_client_commands_register+17Bj
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9DDE5
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EAA0:				; CODE XREF: _silc_client_commands_register+7E2j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E44C
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EAB0:				; CODE XREF: _silc_client_commands_register+767j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E3D1
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EAC0:				; CODE XREF: _silc_client_commands_register+9CEj
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E638
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EAD0:				; CODE XREF: _silc_client_commands_register+953j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E5BD
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EAE0:				; CODE XREF: _silc_client_commands_register+40Aj
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E074
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EAF0:				; CODE XREF: _silc_client_commands_register+57Bj
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E1E5
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EB00:				; CODE XREF: _silc_client_commands_register+500j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E16A
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EB10:				; CODE XREF: _silc_client_commands_register+5F6j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E260
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EB20:				; CODE XREF: _silc_client_commands_register+A49j
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9E6B3
; ---------------------------------------------------------------------------
		align 10h

loc_62B9EB30:				; CODE XREF: _silc_client_commands_register+38Fj
		mov	[esp], esi
		call	_silc_free
		jmp	loc_62B9DFF9
_silc_client_commands_register endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  68. silc_client_command_reply_quit

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_quit(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_quit
_silc_client_command_reply_quit	proc near ; DATA XREF: _silc_client_commands_unregister+51Eo
					; _silc_client_commands_register+373o ...

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		leave
		retn
_silc_client_command_reply_quit	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __usercall silc_client_command_process_error(SilcClientCommandContext cmd@<eax>,	SilcCommandPayload payload@<edx>, SilcStatus error@<cl>)
_silc_client_command_process_error proc	near
					; CODE XREF: _silc_client_command_reply_service+68p
					; _silc_client_command_reply_watch+68p	...

id		= SilcID ptr -38h

cmd = eax				; SilcClientCommandContext
payload	= edx				; SilcCommandPayload
error =	ecx				; SilcStatus
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, cmd
		mov	esi, [cmd+4]
		mov	edi, [esi+4Ch]
client = edi				; SilcClient
		mov	[esp], payload
		call	_silc_command_get_args
cmd = ebx				; SilcClientCommandContext
		mov	dl, [cmd+5Dh]
		cmp	dl, 16h
		jz	short loc_62B9EBFC
		cmp	dl, 17h
		jz	loc_62B9EC84
		cmp	dl, 2Fh
		jz	short loc_62B9EB98

loc_62B9EB8F:				; CODE XREF: _silc_client_command_process_error+61j
					; _silc_client_command_process_error+77j ...
channel	= ebx				; SilcChannelEntry
		add	esp, 4Ch
		pop	channel
channel	= eax				; SilcChannelEntry
		pop	esi
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
cmd = ebx				; SilcClientCommandContext
client = edi				; SilcClient
		align 4

loc_62B9EB98:				; CODE XREF: _silc_client_command_process_error+2Dj
		mov	dword ptr [esp+10h], 0
		lea	cmd, [ebp+id]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], eax
args = eax				; SilcArgumentPayload
		call	_silc_argument_get_decoded
		test	al, al
		jz	short loc_62B9EB8F
		mov	[esp+8], ebx	; server_id
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_get_server_by_id
		mov	ebx, eax
server_entry = ebx			; SilcServerEntry
		test	eax, eax
		jz	short loc_62B9EB8F
server_entry = eax			; SilcServerEntry
		mov	[esp+8], server_entry ;	server
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_del_server
server_entry = ebx			; SilcServerEntry
		mov	[esp+8], server_entry ;	server_entry
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_unref_server
		jmp	short loc_62B9EB8F
; ---------------------------------------------------------------------------
cmd = ebx				; SilcClientCommandContext
		align 4

loc_62B9EBFC:				; CODE XREF: _silc_client_command_process_error+1Fj
		mov	dword ptr [esp+10h], 0
		lea	cmd, [ebp+id]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], eax
args = eax				; SilcArgumentPayload
		call	_silc_argument_get_decoded
		test	al, al
		jz	loc_62B9EB8F
		mov	[esp+8], ebx	; client_id
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_get_client_by_id
		mov	ebx, eax
client_entry = ebx			; SilcClientEntry
		test	eax, eax
		jz	loc_62B9EB8F
client_entry = eax			; SilcClientEntry
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_remove_from_channels
client_entry = ebx			; SilcClientEntry
		and	byte ptr [client_entry+402h], 0FEh
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_del_client
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_unref_client
		jmp	loc_62B9EB8F
; ---------------------------------------------------------------------------
cmd = ebx				; SilcClientCommandContext
		align 4

loc_62B9EC84:				; CODE XREF: _silc_client_command_process_error+24j
		mov	dword ptr [esp+10h], 0
		lea	cmd, [ebp+id]
		mov	[esp+0Ch], ebx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], eax
args = eax				; SilcArgumentPayload
		call	_silc_argument_get_decoded
		test	al, al
		jz	loc_62B9EB8F
		mov	[esp+8], ebx	; channel_id
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_get_channel_by_id
		mov	ebx, eax
channel	= ebx				; SilcChannelEntry
		test	eax, eax
		jz	loc_62B9EB8F
channel	= eax				; SilcChannelEntry
		mov	[esp+8], channel ; channel
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_empty_channel
channel	= ebx				; SilcChannelEntry
		mov	[esp+8], channel ; channel
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_del_channel
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], esi	; conn
		mov	[esp], client	; client
		call	_silc_client_unref_channel
		jmp	loc_62B9EB8F
_silc_client_command_process_error endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void silc_client_command_callback(SilcClientCommandContext cmd, ...)
_silc_client_command_callback proc near	; CODE XREF: _silc_client_command_reply_service+5Bp
					; _silc_client_command_reply_service+CAp ...

var_3C		= dword	ptr -3Ch
list		= SilcList ptr -2Ch
cmd		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	ebx, [ebp+cmd]
		test	byte ptr [ebx+64h], 1
		jnz	loc_62B9EDA0

loc_62B9ED1A:				; CODE XREF: _silc_client_command_callback+D1j
cmd_0 =	ebx				; SilcClientCommandContext
		lea	edi, [ebp+list]
		lea	esi, [cmd_0+48h]
		mov	ecx, 5
		rep movsd
		mov	esi, [ebp+list.head]
		movzx	edx, [ebp+list.next_offset]
		test	esi, esi
		jz	short loc_62B9ED47
		xchg	ax, ax

loc_62B9ED34:				; CODE XREF: _silc_client_command_callback+41j
		and	[ebp+list._bf10], 0FDh
		mov	edi, [esi+edx]
		test	byte ptr [esi+0Ch], 1
		jz	short loc_62B9ED50
		mov	esi, edi

loc_62B9ED43:				; CODE XREF: _silc_client_command_callback+9Aj
		test	esi, esi
		jnz	short loc_62B9ED34

loc_62B9ED47:				; CODE XREF: _silc_client_command_callback+2Cj
		add	esp, 5Ch
		pop	cmd_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
cmd_0 =	ebx				; SilcClientCommandContext
		align 10h

loc_62B9ED50:				; CODE XREF: _silc_client_command_callback+3Bj
		mov	eax, [cmd_0+4]
		lea	ecx, [ebp+arg_4]
		mov	[esp+18h], ecx
		mov	ecx, [esi+8]
		mov	[esp+14h], ecx
		movzx	ecx, byte ptr [cmd_0+5Dh]
		mov	[esp+10h], ecx
		movzx	ecx, byte ptr [cmd_0+5Ch]
		mov	[esp+0Ch], ecx
		movzx	ecx, byte ptr [cmd_0+34h]
		mov	[esp+8], ecx
		mov	[esp+4], eax
		mov	eax, [eax+4Ch]
		mov	[esp], eax
		mov	[ebp+var_3C], edx
		call	dword ptr [esi+4]
		test	al, al
		setz	cl
		mov	al, [esi+0Ch]
		and	eax, 0FFFFFFFEh
		or	eax, ecx
		mov	[esi+0Ch], al
		mov	edx, [ebp+var_3C]
		mov	esi, edi
		jmp	short loc_62B9ED43
; ---------------------------------------------------------------------------

loc_62B9EDA0:				; CODE XREF: _silc_client_command_callback+10j
		mov	edx, [cmd_0+4]
		mov	eax, [edx+4Ch]
		mov	ecx, [eax+18h]
		mov	ecx, [ecx+48h]
		lea	esi, [ebp+arg_4]
		mov	[esp+14h], esi
		movzx	esi, byte ptr [cmd_0+5Dh]
		mov	[esp+10h], esi
		movzx	esi, byte ptr [cmd_0+5Ch]
		mov	[esp+0Ch], esi
		movzx	esi, byte ptr [cmd_0+34h]
		mov	[esp+8], esi
		mov	[esp+4], edx
		mov	[esp], eax
		call	dword ptr [ecx+14h]
		jmp	loc_62B9ED1A
_silc_client_command_callback endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  69. silc_client_command_reply_service

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_service(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_service
_silc_client_command_reply_service proc	near
					; DATA XREF: _silc_client_commands_unregister+122Eo
					; _silc_client_commands_register+B48o ...

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
arg2		= dword	ptr -24h
arg1		= dword	ptr -20h
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	edi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62B9EE64
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62B9EEF0

loc_62B9EE09:				; CODE XREF: _silc_client_command_reply_service+15Aj
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9EEC8
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62B9EE2C:				; CODE XREF: _silc_client_command_reply_service+10Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		align 4

loc_62B9EE64:				; CODE XREF: _silc_client_command_reply_service+21j
		lea	state_context_0, [ebp+tmp_len]
		mov	[esp+8], esi
		mov	dword ptr [esp+4], 2
		mov	[esp], args
		mov	[ebp+var_30], args
		call	_silc_argument_get_arg_type
		mov	[esp+8], esi
		mov	dword ptr [esp+4], 3
		mov	edx, [ebp+var_30]
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_30], eax
		call	_silc_argument_get_arg_type
		mov	[esp+8], eax
name = eax				; unsigned __int8 *
		mov	ecx, [ebp+var_30]
		mov	[esp+4], ecx
service_list = ecx			; unsigned __int8 *
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	esi
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		align 4

loc_62B9EEC8:				; CODE XREF: _silc_client_command_reply_service+40j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62B9EE2C
; ---------------------------------------------------------------------------

loc_62B9EEF0:				; CODE XREF: _silc_client_command_reply_service+27j
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	ecx, [ecx]
		mov	[ebp+var_2C], ecx
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_30], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotGetServi ; "Cannot get service: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	[ebp+var_2C]
		mov	edx, [ebp+var_30]
		jmp	loc_62B9EE09
_silc_client_command_reply_service endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  72. silc_client_command_reply_timeout

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_timeout(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_timeout
_silc_client_command_reply_timeout proc	near
					; DATA XREF: _silc_client_command_reply_wait+34o

var_4C		= dword	ptr -4Ch
conn		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
arg2		= dword	ptr -20h
arg1_0		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	ebx, [ebp+fsm_context]
		mov	eax, [ebx+4]
		mov	[ebp+conn], eax
		mov	ecx, [eax+54h]
		mov	[ebp+var_2C], ecx
		test	byte ptr [ecx+12Dh], 2
		jz	loc_62B9EFE8
fsm_context_0 =	ebx			; void *
		mov	edx, [ecx+0D8h]
prev = edx				; void *
		test	prev, prev
		jz	short loc_62B9EF8F
		cmp	fsm_context_0, prev
		jz	loc_62B9F19A
		movzx	edi, word ptr [ecx+0E4h]
		jmp	short loc_62B9EF86
; ---------------------------------------------------------------------------

loc_62B9EF7C:				; CODE XREF: _silc_client_command_reply_timeout+51j
p = esi					; void **
prev = eax				; void *
		cmp	fsm_context_0, prev
		jz	loc_62B9F068
		mov	edx, prev

loc_62B9EF86:				; CODE XREF: _silc_client_command_reply_timeout+3Ej
prev = edx				; void *
		lea	p, [prev+edi]
		mov	eax, [p]
prev = eax				; void *
		test	prev, prev
		jnz	short loc_62B9EF7C

loc_62B9EF8F:				; CODE XREF: _silc_client_command_reply_timeout+2Dj
prev = edx				; void *
		mov	eax, [ebp+var_2C]
		cmp	[eax+0DCh], fsm_context_0
		jz	loc_62B9F14C

loc_62B9EF9E:				; CODE XREF: _silc_client_command_reply_timeout+16Dj
					; _silc_client_command_reply_timeout+216j
		test	byte ptr [fsm_context_0+64h], 1
		jnz	short loc_62B9EFD9
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F120

loc_62B9EFBD:				; CODE XREF: _silc_client_command_reply_timeout+FDj
		mov	byte ptr [fsm_context_0+5Dh], 36h
		mov	byte ptr [fsm_context_0+5Ch], 36h
		xor	eax, eax
		xor	prev, prev

loc_62B9EFC9:				; CODE XREF: _silc_client_command_reply_timeout+126j
					; _silc_client_command_reply_timeout+20Bj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

loc_62B9EFD9:				; CODE XREF: _silc_client_command_reply_timeout+66j
prev = edx				; void *
		mov	eax, 3
		add	esp, 5Ch
		pop	fsm_context_0
		pop	p
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
		align 4

loc_62B9EFE8:				; CODE XREF: _silc_client_command_reply_timeout+1Fj
		mov	edx, [ecx+0D8h]
prev = edx				; void *
		test	prev, prev
		jz	short loc_62B9F017
		cmp	fsm_context_0, prev
		jz	loc_62B9F183
		movzx	edi, word ptr [ecx+0E4h]
		jmp	short loc_62B9F00E
; ---------------------------------------------------------------------------
p = esi					; void **
prev = eax				; void *
		align 4

loc_62B9F004:				; CODE XREF: _silc_client_command_reply_timeout+D9j
		cmp	fsm_context_0, prev
		jz	loc_62B9F0B4
		mov	edx, prev

loc_62B9F00E:				; CODE XREF: _silc_client_command_reply_timeout+C5j
prev = edx				; void *
		lea	p, [prev+edi]
		mov	eax, [p]
prev = eax				; void *
		test	prev, prev
		jnz	short loc_62B9F004

loc_62B9F017:				; CODE XREF: _silc_client_command_reply_timeout+B4j
prev = edx				; void *
		mov	eax, [ebp+var_2C]
		cmp	[eax+0DCh], fsm_context_0
		jz	loc_62B9F158

loc_62B9F026:				; CODE XREF: _silc_client_command_reply_timeout+1B5j
					; _silc_client_command_reply_timeout+222j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jz	short loc_62B9EFBD
		lea	prev, [ebp+arg2]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg1_0]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 0
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62B9EFC9
; ---------------------------------------------------------------------------
p = esi					; void **
prev = eax				; void *
		align 4

loc_62B9F068:				; CODE XREF: _silc_client_command_reply_timeout+42j
		mov	[ebp+var_4C], p

loc_62B9F06B:				; CODE XREF: _silc_client_command_reply_timeout+270j
		mov	prev, [fsm_context_0+edi]
prev = edx				; void *
		mov	edi, [ebp+var_4C]
		mov	[edi], eax
		test	eax, eax
		jz	short loc_62B9F084
		test	byte ptr [ecx+0E8h], 1
		jnz	loc_62B9F10C

loc_62B9F084:				; CODE XREF: _silc_client_command_reply_timeout+139j
					; _silc_client_command_reply_timeout+1DDj
		cmp	[ecx+0E0h], fsm_context_0
		jz	loc_62B9F163

loc_62B9F090:				; CODE XREF: _silc_client_command_reply_timeout+232j
		sub	dword ptr [ecx+0E8h], 4
		mov	edi, [ebp+conn]
		mov	edi, [edi+54h]
		mov	[ebp+var_2C], edi
		mov	eax, [ebp+var_2C]
		cmp	[eax+0DCh], fsm_context_0
		jnz	loc_62B9EF9E
		jmp	loc_62B9F14C
; ---------------------------------------------------------------------------

loc_62B9F0B4:				; CODE XREF: _silc_client_command_reply_timeout+CAj
p = esi					; void **
prev = eax				; void *
		mov	[ebp+var_4C], p

loc_62B9F0B7:				; CODE XREF: _silc_client_command_reply_timeout+259j
		mov	prev, [fsm_context_0+edi]
prev = edx				; void *
		mov	edi, [ebp+var_4C]
		mov	[edi], eax
		test	eax, eax
		jz	short loc_62B9F0CC
		test	byte ptr [ecx+0E8h], 1
		jnz	short loc_62B9F0FC

loc_62B9F0CC:				; CODE XREF: _silc_client_command_reply_timeout+185j
					; _silc_client_command_reply_timeout+1CDj
		cmp	[ecx+0E0h], fsm_context_0
		jz	loc_62B9F173

loc_62B9F0D8:				; CODE XREF: _silc_client_command_reply_timeout+242j
		sub	dword ptr [ecx+0E8h], 4
		mov	edi, [ebp+conn]
		mov	edi, [edi+54h]
		mov	[ebp+var_2C], edi
		mov	eax, [ebp+var_2C]
		cmp	[eax+0DCh], fsm_context_0
		jnz	loc_62B9F026
		jmp	short loc_62B9F158
; ---------------------------------------------------------------------------
		align 4

loc_62B9F0FC:				; CODE XREF: _silc_client_command_reply_timeout+18Ej
		movzx	p, word	ptr [ecx+0E6h]
		mov	edi, [fsm_context_0+esi]
		mov	[eax+esi], edi
		jmp	short loc_62B9F0CC
; ---------------------------------------------------------------------------
p = esi					; void **
prev = edx				; void *
		align 4

loc_62B9F10C:				; CODE XREF: _silc_client_command_reply_timeout+142j
		movzx	p, word	ptr [ecx+0E6h]
		mov	edi, [fsm_context_0+esi]
		mov	[eax+esi], edi
		jmp	loc_62B9F084
; ---------------------------------------------------------------------------
p = esi					; void **
		align 10h

loc_62B9F120:				; CODE XREF: _silc_client_command_reply_timeout+7Bj
		lea	prev, [ebp+arg1_0]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg2]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 0
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62B9EFC9
; ---------------------------------------------------------------------------

loc_62B9F14C:				; CODE XREF: _silc_client_command_reply_timeout+5Cj
					; _silc_client_command_reply_timeout+173j
prev = edx				; void *
		mov	[eax+0DCh], prev
		jmp	loc_62B9EF9E
; ---------------------------------------------------------------------------
p = esi					; void **
prev = edx				; void *
		align 4

loc_62B9F158:				; CODE XREF: _silc_client_command_reply_timeout+E4j
					; _silc_client_command_reply_timeout+1BBj
		mov	[eax+0DCh], prev
		jmp	loc_62B9F026
; ---------------------------------------------------------------------------

loc_62B9F163:				; CODE XREF: _silc_client_command_reply_timeout+14Ej
p = esi					; void **
prev = edx				; void *
		mov	p, [ebp+var_4C]
		mov	eax, [esi]
		mov	[ecx+0E0h], eax
		jmp	loc_62B9F090
; ---------------------------------------------------------------------------

loc_62B9F173:				; CODE XREF: _silc_client_command_reply_timeout+196j
p = esi					; void **
prev = edx				; void *
		mov	p, [ebp+var_4C]
		mov	eax, [esi]
		mov	[ecx+0E0h], eax
		jmp	loc_62B9F0D8
; ---------------------------------------------------------------------------

loc_62B9F183:				; CODE XREF: _silc_client_command_reply_timeout+B8j
		lea	esi, [ecx+0D8h]
		mov	[ebp+var_4C], esi
		movzx	edi, word ptr [ecx+0E4h]
		xor	prev, prev
		jmp	loc_62B9F0B7
; ---------------------------------------------------------------------------

loc_62B9F19A:				; CODE XREF: _silc_client_command_reply_timeout+31j
prev = edx				; void *
		lea	esi, [ecx+0D8h]
		mov	[ebp+var_4C], esi
		movzx	edi, word ptr [ecx+0E4h]
		xor	prev, prev
		jmp	loc_62B9F06B
_silc_client_command_reply_timeout endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  77. silc_client_command_reply_watch

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_watch(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_watch
_silc_client_command_reply_watch proc near
					; DATA XREF: _silc_client_commands_unregister+EBEo
					; _silc_client_commands_register+A2Do ...

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
arg2		= dword	ptr -20h
arg1_0		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	edi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62B9F23C
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62B9F2CC

loc_62B9F1E1:				; CODE XREF: _silc_client_command_reply_watch+15Ej
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F2A4
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62B9F204:				; CODE XREF: _silc_client_command_reply_watch+113j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next

loc_62B9F231:				; CODE XREF: _silc_client_command_reply_watch+1B8j
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		align 4

loc_62B9F23C:				; CODE XREF: _silc_client_command_reply_watch+21j
		mov	[esp], args
		mov	[ebp+var_30], args
		call	_silc_argument_get_arg_num
		test	eax, eax
		mov	edx, [ebp+var_30]
		jnz	loc_62B9F340

loc_62B9F252:				; CODE XREF: _silc_client_command_reply_watch+19Aj
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F318
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62B9F277:				; CODE XREF: _silc_client_command_reply_watch+187j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		align 4

loc_62B9F2A4:				; CODE XREF: _silc_client_command_reply_watch+40j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62B9F204
; ---------------------------------------------------------------------------

loc_62B9F2CC:				; CODE XREF: _silc_client_command_reply_watch+27j
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	ecx, [ecx]
		mov	[ebp+var_2C], ecx
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_30], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotSetWatch ; "Cannot set watch: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	[ebp+var_2C]
		mov	edx, [ebp+var_30]
		jmp	loc_62B9F1E1
; ---------------------------------------------------------------------------
		align 4

loc_62B9F318:				; CODE XREF: _silc_client_command_reply_watch+B1j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62B9F277
; ---------------------------------------------------------------------------

loc_62B9F340:				; CODE XREF: _silc_client_command_reply_watch+98j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_30]
		ja	loc_62B9F252
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next
		jmp	loc_62B9F231
_silc_client_command_reply_watch endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  64. silc_client_command_reply_oper

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_oper(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_oper
_silc_client_command_reply_oper	proc near ; DATA XREF: _silc_client_commands_unregister+88Eo
					; _silc_client_commands_register+5DAo ...

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
arg2		= dword	ptr -20h
arg1_0		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	edi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62B9F3FC
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62B9F48C

loc_62B9F3A1:				; CODE XREF: _silc_client_command_reply_oper+15Ej
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F464
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62B9F3C4:				; CODE XREF: _silc_client_command_reply_oper+113j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next

loc_62B9F3F1:				; CODE XREF: _silc_client_command_reply_oper+1C4j
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		align 4

loc_62B9F3FC:				; CODE XREF: _silc_client_command_reply_oper+21j
		mov	[esp], args
		mov	[ebp+var_30], args
		call	_silc_argument_get_arg_num
		test	eax, eax
		mov	edx, [ebp+var_30]
		jnz	loc_62B9F500

loc_62B9F412:				; CODE XREF: _silc_client_command_reply_oper+19Aj
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F4D8
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62B9F437:				; CODE XREF: _silc_client_command_reply_oper+187j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		align 4

loc_62B9F464:				; CODE XREF: _silc_client_command_reply_oper+40j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62B9F3C4
; ---------------------------------------------------------------------------

loc_62B9F48C:				; CODE XREF: _silc_client_command_reply_oper+27j
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	ecx, [ecx]
		mov	[ebp+var_2C], ecx
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_30], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotChangeMo ; "Cannot change mode: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	[ebp+var_2C]
		mov	edx, [ebp+var_30]
		jmp	loc_62B9F3A1
; ---------------------------------------------------------------------------
		align 4

loc_62B9F4D8:				; CODE XREF: _silc_client_command_reply_oper+B1j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62B9F437
; ---------------------------------------------------------------------------

loc_62B9F500:				; CODE XREF: _silc_client_command_reply_oper+98j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_30]
		ja	loc_62B9F412
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax]
		or	dword ptr [eax+3ACh], 1
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next
		jmp	loc_62B9F3F1
_silc_client_command_reply_oper	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  70. silc_client_command_reply_silcoper

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_silcoper(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_command_reply_silcoper
_silc_client_command_reply_silcoper proc near
					; DATA XREF: _silc_client_commands_unregister+F6Eo
					; _silc_client_commands_register+A8Bo ...

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
arg2		= dword	ptr -20h
arg1_0		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	edi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62B9F5C8
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62B9F658

loc_62B9F56D:				; CODE XREF: _silc_client_command_reply_silcoper+15Ej
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F630
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62B9F590:				; CODE XREF: _silc_client_command_reply_silcoper+113j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next

loc_62B9F5BD:				; CODE XREF: _silc_client_command_reply_silcoper+1C4j
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		align 4

loc_62B9F5C8:				; CODE XREF: _silc_client_command_reply_silcoper+21j
		mov	[esp], args
		mov	[ebp+var_30], args
		call	_silc_argument_get_arg_num
		test	eax, eax
		mov	edx, [ebp+var_30]
		jnz	loc_62B9F6CC

loc_62B9F5DE:				; CODE XREF: _silc_client_command_reply_silcoper+19Aj
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F6A4
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62B9F603:				; CODE XREF: _silc_client_command_reply_silcoper+187j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	edi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		align 10h

loc_62B9F630:				; CODE XREF: _silc_client_command_reply_silcoper+40j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62B9F590
; ---------------------------------------------------------------------------

loc_62B9F658:				; CODE XREF: _silc_client_command_reply_silcoper+27j
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	ecx, [ecx]
		mov	[ebp+var_2C], ecx
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_30], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotChangeMo ; "Cannot change mode: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	[ebp+var_2C]
		mov	edx, [ebp+var_30]
		jmp	loc_62B9F56D
; ---------------------------------------------------------------------------
		align 4

loc_62B9F6A4:				; CODE XREF: _silc_client_command_reply_silcoper+B1j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62B9F603
; ---------------------------------------------------------------------------

loc_62B9F6CC:				; CODE XREF: _silc_client_command_reply_silcoper+98j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_30]
		ja	loc_62B9F5DE
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax]
		or	dword ptr [eax+3ACh], 2
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], fsm_0
		call	_silc_fsm_next
		jmp	loc_62B9F5BD
_silc_client_command_reply_silcoper endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  58. silc_client_command_reply_kick

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_kick(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_kick
_silc_client_command_reply_kick	proc near ; DATA XREF: _silc_client_commands_unregister+CAEo
					; _silc_client_commands_register+8BCo ...

client_entry	= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -40h
arg2		= dword	ptr -20h
arg1_0		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62B9F79C
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62B9F830

loc_62B9F73F:				; CODE XREF: _silc_client_command_reply_kick+166j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F808
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62B9F762:				; CODE XREF: _silc_client_command_reply_kick+11Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62B9F792:				; CODE XREF: _silc_client_command_reply_kick+236j
channel	= esi				; SilcChannelEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9F79C:				; CODE XREF: _silc_client_command_reply_kick+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_num
		cmp	eax, 2
		mov	edx, [ebp+client_entry]
		ja	loc_62B9F8A0

loc_62B9F7B3:				; CODE XREF: _silc_client_command_reply_kick+1A2j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F878
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62B9F7D8:				; CODE XREF: _silc_client_command_reply_kick+18Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62B9F808:				; CODE XREF: _silc_client_command_reply_kick+46j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62B9F762
; ---------------------------------------------------------------------------

loc_62B9F830:				; CODE XREF: _silc_client_command_reply_kick+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+client_entry], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotKickS ; "Cannot kick: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+client_entry]
		jmp	loc_62B9F73F
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62B9F878:				; CODE XREF: _silc_client_command_reply_kick+BAj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62B9F7D8
; ---------------------------------------------------------------------------

loc_62B9F8A0:				; CODE XREF: _silc_client_command_reply_kick+A1j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+client_entry]
		ja	loc_62B9F7B3
		mov	dword ptr [esp+10h], 0
		lea	eax, [ebp+id]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+client_entry]
		jnz	short loc_62B9F947
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9F9DC
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62B9F90A:				; CODE XREF: _silc_client_command_reply_kick+2F3j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		xor	state_context_0, state_context_0

out:					; CODE XREF: _silc_client_command_reply_kick+2CBj
					; _silc_client_command_reply_kick+37Bj
channel	= esi				; SilcChannelEntry ; channel_entry
		mov	[esp+8], channel
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62B9F792
; ---------------------------------------------------------------------------

loc_62B9F947:				; CODE XREF: _silc_client_command_reply_kick+1D7j
state_context_0	= esi			; void *
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+client_entry], edx
		call	_silc_client_get_channel_by_id
		mov	state_context_0, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	loc_62B9FA04
channel	= eax				; SilcChannelEntry
		mov	dword ptr [esp+10h], 0
		lea	channel, [ebp+id]
channel	= esi				; SilcChannelEntry
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+client_entry]
		jnz	loc_62B9FA3E
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9FA8C

loc_62B9F9BB:				; CODE XREF: _silc_client_command_reply_kick+30Bj
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	edx, edx
		xor	eax, eax

loc_62B9F9C7:				; CODE XREF: _silc_client_command_reply_kick+330j
					; _silc_client_command_reply_kick+3A3j
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62B9F9DC:				; CODE XREF: _silc_client_command_reply_kick+1ECj
state_context_0	= esi			; void *
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62B9F90A
; ---------------------------------------------------------------------------

loc_62B9FA04:				; CODE XREF: _silc_client_command_reply_kick+25Bj
					; _silc_client_command_reply_kick+350j
client_entry = eax			; SilcClientEntry
channel	= esi				; SilcChannelEntry
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jz	short loc_62B9F9BB
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg2]
		mov	edx, [ebp+arg1_0]
		jmp	short loc_62B9F9C7
; ---------------------------------------------------------------------------

loc_62B9FA3E:				; CODE XREF: _silc_client_command_reply_kick+290j
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; client_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+client_entry], edx
		call	_silc_client_get_client_by_id
		test	eax, eax
client_entry = eax			; SilcClientEntry
		mov	edx, [ebp+client_entry]
		jz	short loc_62B9FA04
		mov	[esp+8], client_entry
		mov	[esp+4], channel
		mov	[esp], fsm_context_0 ; cmd
		mov	[ebp+client_entry], client_entry
		call	_silc_client_command_callback
		mov	eax, [ebp+client_entry]
		mov	[esp+8], eax	; client_entry
client_entry = eax			; SilcClientEntry
		mov	[esp+4], conn	; conn
		mov	client_entry, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		jmp	out
; ---------------------------------------------------------------------------

loc_62B9FA8C:				; CODE XREF: _silc_client_command_reply_kick+2A9j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg1_0]
		mov	edx, [ebp+arg2]
		jmp	loc_62B9F9C7
_silc_client_command_reply_kick	endp

; Exported entry  59. silc_client_command_reply_kill

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_kill(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_kill
_silc_client_command_reply_kill	proc near ; DATA XREF: _silc_client_commands_unregister+5CEo
					; _silc_client_commands_register+3EEo ...

var_50		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -40h
arg2		= dword	ptr -20h
arg1		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62B9FB44
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62B9FBE8

loc_62B9FAE7:				; CODE XREF: _silc_client_command_reply_kill+176j
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9FBC0
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62B9FB0A:				; CODE XREF: _silc_client_command_reply_kill+12Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62B9FB3A:				; CODE XREF: _silc_client_command_reply_kill+21Dj
client_entry = esi			; SilcClientEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	client_entry
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9FB44:				; CODE XREF: _silc_client_command_reply_kill+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+var_50], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_50]
		jbe	short loc_62B9FB6B
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 2
		mov	edx, [ebp+var_50]
		jbe	loc_62B9FC58

loc_62B9FB6B:				; CODE XREF: _silc_client_command_reply_kill+A1j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9FC30
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62B9FB90:				; CODE XREF: _silc_client_command_reply_kill+19Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 10h

loc_62B9FBC0:				; CODE XREF: _silc_client_command_reply_kill+46j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62B9FB0A
; ---------------------------------------------------------------------------

loc_62B9FBE8:				; CODE XREF: _silc_client_command_reply_kill+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_50], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotKillS ; "Cannot kill: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_50]
		jmp	loc_62B9FAE7
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 10h

loc_62B9FC30:				; CODE XREF: _silc_client_command_reply_kill+CAj
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62B9FB90
; ---------------------------------------------------------------------------

loc_62B9FC58:				; CODE XREF: _silc_client_command_reply_kill+B1j
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_50], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_50]
		jnz	short loc_62B9FCD8
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9FD42
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62B9FCAE:				; CODE XREF: _silc_client_command_reply_kill+2B1j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_kill+247j
					; _silc_client_command_reply_kill+289j
client_entry = esi			; SilcClientEntry
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62B9FB3A
; ---------------------------------------------------------------------------
		align 4

loc_62B9FCD8:				; CODE XREF: _silc_client_command_reply_kill+1D3j
		mov	[esp+8], esi	; client_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_get_client_by_id
		mov	esi, eax
client_entry = esi			; SilcClientEntry
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		test	client_entry, client_entry
		jz	short out
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_remove_from_channels
		and	byte ptr [client_entry+402h], 0FEh
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_del_client
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		jmp	out
; ---------------------------------------------------------------------------

loc_62B9FD42:				; CODE XREF: _silc_client_command_reply_kill+1E8j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62B9FCAE
_silc_client_command_reply_kill	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  79. silc_client_command_reply_whowas

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_whowas(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_reply_whowas
_silc_client_command_reply_whowas proc near
					; DATA XREF: _silc_client_commands_unregister+FEo
					; _silc_client_commands_register+E4o ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -40h
arg2		= dword	ptr -20h
arg1_0		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62B9FDFC
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62B9FE90

loc_62B9FD9F:				; CODE XREF: _silc_client_command_reply_whowas+166j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9FE68
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62B9FDC2:				; CODE XREF: _silc_client_command_reply_whowas+11Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62B9FDF2:				; CODE XREF: _silc_client_command_reply_whowas+236j
client_entry = esi			; SilcClientEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	client_entry
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62B9FDFC:				; CODE XREF: _silc_client_command_reply_whowas+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+var_54], args
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+var_54]
		ja	loc_62B9FF00

loc_62B9FE13:				; CODE XREF: _silc_client_command_reply_whowas+1A2j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62B9FED8
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62B9FE38:				; CODE XREF: _silc_client_command_reply_whowas+18Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62B9FE68:				; CODE XREF: _silc_client_command_reply_whowas+46j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62B9FDC2
; ---------------------------------------------------------------------------

loc_62B9FE90:				; CODE XREF: _silc_client_command_reply_whowas+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_54], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aWhowasS ; "WHOWAS:	%s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_54]
		jmp	loc_62B9FD9F
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62B9FED8:				; CODE XREF: _silc_client_command_reply_whowas+BAj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62B9FE38
; ---------------------------------------------------------------------------

loc_62B9FF00:				; CODE XREF: _silc_client_command_reply_whowas+A1j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 5
		mov	edx, [ebp+var_54]
		ja	loc_62B9FE13
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_54], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_54]
		jnz	short loc_62B9FFA7
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA0046
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62B9FF6A:				; CODE XREF: _silc_client_command_reply_whowas+2FDj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		xor	esi, esi

out:					; CODE XREF: _silc_client_command_reply_whowas+2D5j
					; _silc_client_command_reply_whowas+333j
client_entry = esi			; SilcClientEntry ; client_entry
		mov	[esp+8], client_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62B9FDF2
; ---------------------------------------------------------------------------

loc_62B9FFA7:				; CODE XREF: _silc_client_command_reply_whowas+1D7j
		mov	[esp+8], esi	; client_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_54], edx
		call	_silc_client_get_client_by_id
		mov	esi, eax
client_entry = esi			; SilcClientEntry
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	edx, [ebp+var_54]
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 4
		mov	edx, [ebp+var_54]
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_58], eax
		call	_silc_argument_get_arg_type
		mov	[ebp+var_50], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	edx, [ebp+var_54]
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		mov	ecx, [ebp+var_58]
		test	ecx, ecx
		mov	edx, [ebp+var_54]
		jz	short loc_62BA006E
		cmp	[ebp+var_50], 0
		jz	short loc_62BA006E
		mov	[esp+10h], eax
		mov	eax, [ebp+var_50]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], client_entry
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA0046:				; CODE XREF: _silc_client_command_reply_whowas+1ECj
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62B9FF6A
; ---------------------------------------------------------------------------

loc_62BA006E:				; CODE XREF: _silc_client_command_reply_whowas+2B2j
					; _silc_client_command_reply_whowas+2B8j
client_entry = esi			; SilcClientEntry
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	short loc_62BA00A4
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	edx, edx
		xor	eax, eax

loc_62BA008F:				; CODE XREF: _silc_client_command_reply_whowas+35Bj
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA00A4:				; CODE XREF: _silc_client_command_reply_whowas+315j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg2]
		mov	edx, [ebp+arg1_0]
		jmp	short loc_62BA008F
_silc_client_command_reply_whowas endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  74. silc_client_command_reply_umode

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_umode(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_umode
_silc_client_command_reply_umode proc near
					; DATA XREF: _silc_client_commands_unregister+A9Eo
					; _silc_client_commands_register+74Bo ...

conn		= dword	ptr -2Ch
arg2		= dword	ptr -24h
arg1		= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	eax, [ebx+4]
		mov	[ebp+conn], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edi, eax
args = edi				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA015C
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA01F4

loc_62BA00FC:				; CODE XREF: _silc_client_command_reply_umode+168j
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA01CC
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	edx, edx

loc_62BA011F:				; CODE XREF: _silc_client_command_reply_umode+123j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next

loc_62BA014F:				; CODE XREF: _silc_client_command_reply_umode+1FDj
mode = esi				; SilcUInt32
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	mode
		pop	args
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edi				; SilcArgumentPayload
		align 4

loc_62BA015C:				; CODE XREF: _silc_client_command_reply_umode+24j
		mov	[esp], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		jbe	short loc_62BA017A
		mov	[esp], args
		call	_silc_argument_get_arg_num
		cmp	eax, 2
		jbe	loc_62BA0264

loc_62BA017A:				; CODE XREF: _silc_client_command_reply_umode+9Bj
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA023C
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA019F:				; CODE XREF: _silc_client_command_reply_umode+193j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	args
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA01CC:				; CODE XREF: _silc_client_command_reply_umode+43j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edi				; SilcArgumentPayload
		lea	edx, [ebp+arg2]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg1]
		mov	[esp+8], edx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA011F
; ---------------------------------------------------------------------------

loc_62BA01F4:				; CODE XREF: _silc_client_command_reply_umode+2Aj
		mov	edx, [fsm_context_0+4]
		mov	edx, [edx+4Ch]
		mov	edx, [edx+18h]
		mov	edx, [edx+48h]
		mov	edx, [edx]
		mov	[ebp+conn], edx
		movzx	eax, al
		mov	[esp], eax
		call	_silc_get_status_message
		mov	edx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotChangeMo ; "Cannot change mode: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], edx
		mov	eax, [edx+4Ch]
		mov	[esp], eax
		call	[ebp+conn]
		jmp	loc_62BA00FC
; ---------------------------------------------------------------------------
		align 4

loc_62BA023C:				; CODE XREF: _silc_client_command_reply_umode+C1j
		lea	edx, [ebp+arg1]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg2]
		mov	[esp+8], edx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA019F
; ---------------------------------------------------------------------------

loc_62BA0264:				; CODE XREF: _silc_client_command_reply_umode+A8j
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	[esp], args
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	short loc_62BA0285
		cmp	[ebp+len], 4
		jz	short loc_62BA02F5

loc_62BA0285:				; CODE XREF: _silc_client_command_reply_umode+1B1j
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	short loc_62BA02D0
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA02A6:				; CODE XREF: _silc_client_command_reply_umode+227j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_umode+27Fj
mode = esi				; SilcUInt32
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA014F
; ---------------------------------------------------------------------------
state_context_0	= esi			; void *
		align 10h

loc_62BA02D0:				; CODE XREF: _silc_client_command_reply_umode+1CCj
		lea	edx, [ebp+arg2]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg1]
		mov	[esp+8], edx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	short loc_62BA02A6
; ---------------------------------------------------------------------------

loc_62BA02F5:				; CODE XREF: _silc_client_command_reply_umode+1B7j
tmp = eax				; unsigned __int8 *
		movzx	state_context_0, byte ptr [tmp+3]
mode = esi				; SilcUInt32
		movzx	edx, byte ptr [tmp]
		shl	edx, 18h
		or	mode, edx
		movzx	edx, byte ptr [tmp+1]
		shl	edx, 10h
		or	mode, edx
		movzx	tmp, byte ptr [tmp+2]
		shl	eax, 8
		or	mode, eax
		mov	edx, [ebp+conn]
		mov	eax, [edx]
		mov	eax, [eax+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	edx, [ebp+conn]
		mov	eax, [edx]
		mov	[eax+3ACh], mode
		mov	eax, [eax+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	[esp+4], mode
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
_silc_client_command_reply_umode endp

; Exported entry  53. silc_client_command_reply_getkey

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_getkey(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_reply_getkey
_silc_client_command_reply_getkey proc near
					; DATA XREF: _silc_client_commands_unregister+117Eo
					; _silc_client_commands_register+B03o ...

var_50		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -48h
arg2		= dword	ptr -28h
arg1		= dword	ptr -24h
public_key	= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA03E0
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA0484

loc_62BA0383:				; CODE XREF: _silc_client_command_reply_getkey+176j
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA045C
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA03A6:				; CODE XREF: _silc_client_command_reply_getkey+12Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next

loc_62BA03D6:				; CODE XREF: _silc_client_command_reply_getkey+22Cj
server_entry = esi			; SilcServerEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	server_entry
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA03E0:				; CODE XREF: _silc_client_command_reply_getkey+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+var_50], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_50]
		jbe	short loc_62BA0407
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+var_50]
		jbe	loc_62BA04F4

loc_62BA0407:				; CODE XREF: _silc_client_command_reply_getkey+A1j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA04CC
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA042C:				; CODE XREF: _silc_client_command_reply_getkey+19Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA045C:				; CODE XREF: _silc_client_command_reply_getkey+46j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA03A6
; ---------------------------------------------------------------------------

loc_62BA0484:				; CODE XREF: _silc_client_command_reply_getkey+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_50], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotGetKeyS ; "Cannot get key: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_50]
		jmp	loc_62BA0383
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA04CC:				; CODE XREF: _silc_client_command_reply_getkey+CAj
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA042C
; ---------------------------------------------------------------------------

loc_62BA04F4:				; CODE XREF: _silc_client_command_reply_getkey+B1j
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_50], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_50]
		jnz	short loc_62BA0584
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA065C
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA054A:				; CODE XREF: _silc_client_command_reply_getkey+32Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_getkey+28Dj
					; _silc_client_command_reply_getkey+304j ...
server_entry = esi			; SilcServerEntry
		mov	eax, [ebp+public_key]
		test	eax, eax
		jz	short loc_62BA0569
		mov	[esp], eax
		call	_silc_pkcs_public_key_free

loc_62BA0569:				; CODE XREF: _silc_client_command_reply_getkey+20Fj
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA03D6
; ---------------------------------------------------------------------------
		align 4

loc_62BA0584:				; CODE XREF: _silc_client_command_reply_getkey+1D3j
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_50], args
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_50]
		jz	loc_62BA0684
		lea	ecx, [ebp+public_key]
		mov	[esp+8], ecx
		mov	ecx, [ebp+len]
		mov	[esp+4], ecx
		mov	[esp], tmp
		mov	[ebp+var_50], edx
		call	_silc_public_key_payload_decode
		test	al, al
		mov	edx, [ebp+var_50]
		jz	loc_62BA06C0
		mov	ax, [ebp+id.type]
		cmp	ax, 2
		jz	loc_62BA0749
		dec	ax
		jnz	out
		mov	[esp+8], esi	; server_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_50], edx
		call	_silc_client_get_server_by_id
		mov	esi, eax
server_entry = esi			; SilcServerEntry
		test	eax, eax
		mov	edx, [ebp+var_50]
		jz	loc_62BA07CB
server_entry = eax			; SilcServerEntry
		mov	server_entry, [server_entry+28h]
server_entry = esi			; SilcServerEntry
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		cmp	dword ptr [server_entry+20h], 0
		jz	loc_62BA0806

loc_62BA061B:				; CODE XREF: _silc_client_command_reply_getkey+4C3j
		mov	eax, [server_entry+28h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	eax, [server_entry+20h]
		mov	[esp+0Ch], eax
		mov	[esp+8], server_entry
		mov	dword ptr [esp+4], 1
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	[esp+8], server_entry ;	server_entry
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_server
		jmp	out
; ---------------------------------------------------------------------------
		align 4

loc_62BA065C:				; CODE XREF: _silc_client_command_reply_getkey+1E8j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA054A
; ---------------------------------------------------------------------------

loc_62BA0684:				; CODE XREF: _silc_client_command_reply_getkey+253j
					; _silc_client_command_reply_getkey+416j
tmp = eax				; unsigned __int8 *
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
client_entry = esi			; SilcClientEntry
		test	al, al
		jnz	loc_62BA0727
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA06A5:				; CODE XREF: _silc_client_command_reply_getkey+3F4j
		mov	eax, [ebp+arg1]
		mov	[esp+8], eax
		mov	eax, [ebp+arg2]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA06C0:				; CODE XREF: _silc_client_command_reply_getkey+277j
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	dword ptr [esp+0Ch], offset aCannotDecodePu ; "Cannot decode public key: malformed/uns"...
		mov	dword ptr [esp+8], 3
		mov	[esp+4], conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx
		call	dword ptr [eax]
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		mov	edx, [ebp+var_50]
		jnz	loc_62BA07E4

loc_62BA0704:				; CODE XREF: _silc_client_command_reply_getkey+48Ej
server_entry = esi			; SilcServerEntry
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA070C:				; CODE XREF: _silc_client_command_reply_getkey+4B1j
		mov	eax, [ebp+arg2]
arg2_0 = eax				; void *
		mov	[esp+8], arg2_0
		mov	arg2_0,	[ebp+arg1]
arg1_0 = eax				; void *
		mov	[esp+4], arg1_0
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA0727:				; CODE XREF: _silc_client_command_reply_getkey+347j
client_entry = esi			; SilcClientEntry
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA06A5
; ---------------------------------------------------------------------------

loc_62BA0749:				; CODE XREF: _silc_client_command_reply_getkey+285j
		mov	[esp+8], esi	; client_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_50], edx
		call	_silc_client_get_client_by_id
		mov	esi, eax
client_entry = esi			; SilcClientEntry
		test	eax, eax
		mov	edx, [ebp+var_50]
		jz	loc_62BA0684
client_entry = eax			; SilcClientEntry
		mov	client_entry, [client_entry+3D8h]
client_entry = esi			; SilcClientEntry
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		cmp	dword ptr [client_entry+3B0h], 0
		jz	loc_62BA0818

loc_62BA0787:				; CODE XREF: _silc_client_command_reply_getkey+4D8j
		mov	eax, [client_entry+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	eax, [client_entry+3B0h]
		mov	[esp+0Ch], eax
		mov	[esp+8], client_entry
		mov	dword ptr [esp+4], 2
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_client
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA07CB:				; CODE XREF: _silc_client_command_reply_getkey+2B0j
server_entry = eax			; SilcServerEntry
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
server_entry = esi			; SilcServerEntry
		test	al, al
		jz	loc_62BA0704

loc_62BA07E4:				; CODE XREF: _silc_client_command_reply_getkey+3AEj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA070C
; ---------------------------------------------------------------------------

loc_62BA0806:				; CODE XREF: _silc_client_command_reply_getkey+2C5j
		mov	eax, [ebp+public_key]
		mov	[server_entry+20h], eax
		mov	[ebp+public_key], 0
		jmp	loc_62BA061B
; ---------------------------------------------------------------------------

loc_62BA0818:				; CODE XREF: _silc_client_command_reply_getkey+431j
client_entry = esi			; SilcClientEntry
		mov	eax, [ebp+public_key]
		mov	[client_entry+3B0h], eax
		mov	[ebp+public_key], 0
		jmp	loc_62BA0787
_silc_client_command_reply_getkey endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  75. silc_client_command_reply_users

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_users(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_users
_silc_client_command_reply_users proc near
					; DATA XREF: _silc_client_commands_unregister+10CEo
					; _silc_client_commands_register+ADBo ...

var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= byte ptr -98h
var_83		= byte ptr -83h
var_82		= byte ptr -82h
var_81		= byte ptr -81h
var_80		= dword	ptr -80h
i		= dword	ptr -7Ch
var_78		= dword	ptr -78h
list_count	= dword	ptr -74h
var_70		= dword	ptr -70h
client		= dword	ptr -6Ch
id		= SilcID ptr -60h
client_id_list	= SilcBufferStruct ptr -40h
htl		= SilcHashTableList ptr	-30h
arg1		= dword	ptr -24h
arg2		= dword	ptr -20h
tmp_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0BCh
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA08C8
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA0964

loc_62BA0866:				; CODE XREF: _silc_client_command_reply_users+17Cj
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA093C
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA0889:				; CODE XREF: _silc_client_command_reply_users+12Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		xor	eax, eax

loc_62BA08BB:				; CODE XREF: _silc_client_command_reply_users+35Ej
channel	= esi				; SilcChannelEntry
		add	esp, 0BCh
		pop	fsm_context_0
		pop	channel
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA08C8:				; CODE XREF: _silc_client_command_reply_users+2Aj
		mov	[esp], args
		mov	[ebp+var_A0], args
		call	_silc_argument_get_arg_num
		cmp	eax, 4
		mov	edx, [ebp+var_A0]
		ja	loc_62BA09DC

loc_62BA08E5:				; CODE XREF: _silc_client_command_reply_users+1BDj
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA09B4
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA090A:				; CODE XREF: _silc_client_command_reply_users+1A7j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

loc_62BA091A:				; CODE XREF: _silc_client_command_reply_users+245j
channel	= esi				; SilcChannelEntry
client_entry = ebx			; SilcClientEntry
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next

loc_62BA092D:				; CODE XREF: _silc_client_command_reply_users+353j
		xor	eax, eax
		add	esp, 0BCh
		pop	client_entry
		pop	channel
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA093C:				; CODE XREF: _silc_client_command_reply_users+49j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA0889
; ---------------------------------------------------------------------------

loc_62BA0964:				; CODE XREF: _silc_client_command_reply_users+30j
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_A0], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotGetUsers ; "Cannot get users: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_A0]
		jmp	loc_62BA0866
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA09B4:				; CODE XREF: _silc_client_command_reply_users+C8j
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA090A
; ---------------------------------------------------------------------------

loc_62BA09DC:				; CODE XREF: _silc_client_command_reply_users+AFj
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 5
		mov	edx, [ebp+var_A0]
		ja	loc_62BA08E5
		mov	dword ptr [esp+10h], 0
		lea	eax, [ebp+id]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_A0], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_A0]
		jnz	short loc_62BA0A7A
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA0B13
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax

loc_62BA0A4D:				; CODE XREF: _silc_client_command_reply_users+303j
		mov	[esp+8], eax
		mov	eax, [ebp+arg1]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		xor	state_context_0, state_context_0

out:					; CODE XREF: _silc_client_command_reply_users+2DEj
					; _silc_client_command_reply_users+5C2j ...
channel	= esi				; SilcChannelEntry ; channel_entry
client_entry = ebx			; SilcClientEntry
		mov	[esp+8], channel
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_channel
		jmp	loc_62BA091A
; ---------------------------------------------------------------------------

loc_62BA0A7A:				; CODE XREF: _silc_client_command_reply_users+1F8j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_A0], edx
		call	_silc_client_get_channel_by_id
		mov	state_context_0, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+var_A0]
		jz	loc_62BA0B38
channel	= eax				; SilcChannelEntry
		lea	channel, [ebp+tmp_len]
channel	= esi				; SilcChannelEntry
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_A0], args
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_A0]
		jz	short loc_62BA0AD7
		cmp	[ebp+tmp_len], 4
		jz	loc_62BA0BB5

loc_62BA0AD7:				; CODE XREF: _silc_client_command_reply_users+29Bj
					; _silc_client_command_reply_users+4E4j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA0B93
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA0AF8:				; CODE XREF: _silc_client_command_reply_users+380j
		mov	eax, [ebp+arg1]
		mov	[esp+8], eax
		mov	eax, [ebp+arg2]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA0B13:				; CODE XREF: _silc_client_command_reply_users+20Dj
state_context_0	= esi			; void *
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg2]
		jmp	loc_62BA0A4D
; ---------------------------------------------------------------------------

loc_62BA0B38:				; CODE XREF: _silc_client_command_reply_users+270j
channel	= eax				; SilcChannelEntry
		mov	edx, [ebp+fsm]
		mov	al, [edx+28h]
channel	= esi				; SilcChannelEntry
		mov	dl, al
		or	edx, 4
		mov	ecx, [ebp+fsm]
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62BA0CBE

loc_62BA0B51:				; CODE XREF: _silc_client_command_reply_users+4BAj
		mov	[esp+10h], fsm_context_0 ; context
		mov	dword ptr [esp+0Ch], offset _silc_client_command_reply_users_continue ;	completion
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; channel_id
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_channel_by_id_resolve

loc_62BA0B73:				; CODE XREF: _silc_client_command_reply_users+489j
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		test	al, 4
		jz	loc_62BA092D
		mov	eax, 2
		jmp	loc_62BA08BB
; ---------------------------------------------------------------------------

loc_62BA0B93:				; CODE XREF: _silc_client_command_reply_users+2BAj
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA0AF8
; ---------------------------------------------------------------------------

loc_62BA0BB5:				; CODE XREF: _silc_client_command_reply_users+2A1j
tmp = eax				; unsigned __int8 *
		mov	cl, [tmp]
		mov	byte ptr [ebp+var_80], cl
		mov	cl, [tmp+1]
		mov	byte ptr [ebp+i], cl
		mov	cl, [tmp+2]
		mov	byte ptr [ebp+var_78], cl
		mov	al, [tmp+3]
		mov	byte ptr [ebp+list_count], al
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 4
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_A0], args
		call	_silc_argument_get_arg_type
		mov	ecx, eax
tmp = ecx				; unsigned __int8 *
		test	eax, eax
		mov	edx, [ebp+var_A0]
		jz	loc_62BA0EBA
tmp = eax				; unsigned __int8 *
		movzx	tmp, byte ptr [ebp+list_count]
tmp = ecx				; unsigned __int8 *
		mov	[ebp+list_count], eax
		mov	al, byte ptr [ebp+var_80]
		shl	eax, 18h
		or	[ebp+list_count], eax
		movzx	eax, byte ptr [ebp+i]
		shl	eax, 10h
		or	[ebp+list_count], eax
		movzx	eax, byte ptr [ebp+var_78]
		shl	eax, 8
		or	[ebp+list_count], eax
		mov	[ebp+client_id_list.head], tmp
		mov	[ebp+client_id_list.data], tmp
		mov	eax, [ebp+tmp_len]
		add	eax, tmp
		mov	[ebp+client_id_list.end], eax
		mov	[ebp+client_id_list.tail], eax
		mov	al, [fsm_context_0+64h]
		test	al, 4
		jnz	loc_62BA0CEF
		or	eax, 4
		mov	[fsm_context_0+64h], al
		mov	[esp+8], channel ; channel_entry
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_channel
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		or	edx, 4
		mov	[ecx+28h], dl
		test	al, 4
		jz	short loc_62BA0C90
		mov	dword ptr [esp+8], 798h
		mov	dword ptr [esp+4], offset aCommand_reply_ ; "command_reply.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_6	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output

loc_62BA0C90:				; CODE XREF: _silc_client_command_reply_users+432j
		mov	[esp+14h], fsm_context_0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_command_reply_users_resolved ;	completion
		lea	eax, [ebp+client_id_list]
		mov	[esp+0Ch], eax	; client_id_list
		mov	eax, [ebp+list_count]
		mov	[esp+8], eax	; list_count
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_clients_by_list
		jmp	loc_62BA0B73
; ---------------------------------------------------------------------------

loc_62BA0CBE:				; CODE XREF: _silc_client_command_reply_users+31Bj
		mov	dword ptr [esp+8], 77Eh
		mov	dword ptr [esp+4], offset aCommand_reply_ ; "command_reply.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_6	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62BA0B51
; ---------------------------------------------------------------------------

loc_62BA0CEF:				; CODE XREF: _silc_client_command_reply_users+403j
tmp = ecx				; unsigned __int8 *
		lea	eax, [ebp+tmp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 5
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_A0], args
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_A0]
		jz	loc_62BA0AD7
		mov	edx, [ebp+tmp_len]
		add	edx, tmp
		mov	[ebp+var_78], edx
		mov	edx, [channel+144h]
		mov	[esp], edx
		mov	[ebp+var_A0], tmp
		call	_silc_rwlock_wrlock
		cmp	[ebp+list_count], 0
		mov	eax, [ebp+var_A0]
		jz	loc_62BA0EF8
		mov	ecx, [ebp+client_id_list.data]
		mov	[ebp+var_70], eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_78]
		sub	edx, tmp
		mov	[ebp+var_78], edx
		mov	[ebp+i], 0
		mov	[ebp+var_9C], fsm_context_0
		jmp	short loc_62BA0DC4
; ---------------------------------------------------------------------------

loc_62BA0D63:				; CODE XREF: _silc_client_command_reply_users+611j
					; _silc_client_command_reply_users+61Ej ...
client_entry = ebx			; SilcClientEntry ; client_entry
		mov	[esp+8], client_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		mov	eax, [ebp+client_id_list.data]
		mov	edx, [ebp+client_id_list.tail]
		sub	edx, eax
		cmp	[ebp+var_80], edx
		ja	loc_62BA0F6C
		mov	edx, [ebp+var_80]
		lea	ecx, [eax+edx]
		mov	[ebp+client_id_list.data], ecx
		test	eax, eax
		jz	loc_62BA0F6C
		cmp	[ebp+var_78], 3
		jbe	loc_62BA0F6C
		mov	eax, [ebp+var_70]
		test	eax, eax
		jz	loc_62BA0F6C
		inc	[ebp+i]
		add	[ebp+var_70], 4
		sub	[ebp+var_78], 4
		mov	eax, [ebp+i]
		cmp	[ebp+list_count], eax
		jbe	loc_62BA0EF2

loc_62BA0DC4:				; CODE XREF: _silc_client_command_reply_users+531j
tmp = eax				; unsigned __int8 *
		movzx	tmp, byte ptr [ecx+2]
idp_len	= eax				; SilcUInt16
		shl	idp_len, 8
		movzx	edx, byte ptr [ecx+3]
		or	idp_len, edx
		add	idp_len, 4
		movzx	eax, ax
		mov	[ebp+var_80], eax
		lea	eax, [ebp+id]
		mov	[esp+8], eax
		mov	edx, [ebp+var_80]
		mov	[esp+4], edx
		mov	[esp], ecx
		call	_silc_id_payload_parse_id
		test	al, al
		jz	out
		mov	ecx, [ebp+var_70]
		mov	cl, [ecx]
		mov	[ebp+var_98], cl
		mov	eax, [ebp+var_70]
		mov	al, [eax+1]
		mov	[ebp+var_83], al
		mov	edx, [ebp+var_70]
		mov	dl, [edx+2]
		mov	[ebp+var_82], dl
		mov	ecx, [ebp+var_70]
		mov	cl, [ecx+3]
		mov	[ebp+var_81], cl
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; client_id
		mov	[esp+4], conn	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_client_by_id
		mov	client_entry, eax
		test	eax, eax
		jz	loc_62BA0D63
client_entry = eax			; SilcClientEntry
		test	byte ptr [client_entry+402h], 1
		jz	loc_62BA0D63
		mov	client_entry, [client_entry+3D8h]
client_entry = ebx			; SilcClientEntry
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	al, [ebp+var_98]
		shl	eax, 18h
		movzx	edx, [ebp+var_83]
		shl	edx, 10h
		or	eax, edx
		movzx	edx, [ebp+var_81]
		or	eax, edx
		movzx	edx, [ebp+var_82]
		shl	edx, 8
		or	eax, edx
		mov	[esp+10h], eax	; cumode
		mov	[esp+0Ch], client_entry	; client_entry
		mov	[esp+8], channel ; channel
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_add_to_channel
		mov	eax, [client_entry+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		jmp	loc_62BA0D63
; ---------------------------------------------------------------------------

loc_62BA0EBA:				; CODE XREF: _silc_client_command_reply_users+3C3j
fsm_context_0 =	ebx			; void *
tmp = eax				; unsigned __int8 *
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
tmp = ecx				; unsigned __int8 *
		test	al, al
		jnz	short loc_62BA0F4A
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA0ED7:				; CODE XREF: _silc_client_command_reply_users+737j
		mov	eax, [ebp+arg2]
		mov	[esp+8], eax
		mov	eax, [ebp+arg1]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA0EF2:				; CODE XREF: _silc_client_command_reply_users+58Ej
client_entry = ebx			; SilcClientEntry
		mov	client_entry, [ebp+var_9C]

loc_62BA0EF8:				; CODE XREF: _silc_client_command_reply_users+510j
fsm_context_0 =	ebx			; void *
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		lea	eax, [ebp+htl]
		mov	[esp+4], eax
		mov	edx, [channel+134h]
		mov	[esp], edx
		mov	[ebp+var_A0], eax
		call	_silc_hash_table_list
		mov	eax, [ebp+var_A0]
		mov	[esp+8], eax
		mov	[esp+4], channel
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	eax, [ebp+var_A0]
		mov	[esp], eax
		call	_silc_hash_table_list_reset
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA0F4A:				; CODE XREF: _silc_client_command_reply_users+69Dj
tmp = ecx				; unsigned __int8 *
		lea	tmp, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA0ED7
; ---------------------------------------------------------------------------

loc_62BA0F6C:				; CODE XREF: _silc_client_command_reply_users+551j
					; _silc_client_command_reply_users+562j ...
client_entry = ebx			; SilcClientEntry
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		jmp	out
_silc_client_command_reply_users endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_command_reply_users_resolved(SilcClient client, SilcClientConnection	conn, SilcStatus status, SilcDList clients, void *context)
_silc_client_command_reply_users_resolved proc near
					; DATA XREF: _silc_client_command_reply_users+464o

client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
clients		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+context]
		mov	dl, [eax+30h]
		mov	cl, dl
		and	ecx, 0FFFFFFFBh
		mov	[eax+30h], cl
		and	edx, 4
		jz	short loc_62BA0F9C
context_0 = eax				; void *
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_62BA0F9C:				; CODE XREF: _silc_client_command_reply_users_resolved+17j
		add	context_0, 8
		mov	[ebp+client], eax
		leave
		jmp	_silc_fsm_continue
_silc_client_command_reply_users_resolved endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_command_reply_users_continue(SilcClient client, SilcClientConnection	conn, SilcStatus status, SilcDList channels, void *context)
_silc_client_command_reply_users_continue proc near
					; DATA XREF: _silc_client_command_reply_users+325o

arg2		= dword	ptr -10h
arg1		= dword	ptr -0Ch
client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
channels	= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	ebx, [ebp+context]
		mov	edx, [ebp+channels]
		test	edx, edx
		jz	short loc_62BA0FDC

loc_62BA0FBA:				; CODE XREF: _silc_client_command_reply_users_continue+9Dj
context_0 = ebx				; void *
		mov	al, [context_0+30h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[context_0+30h], dl
		test	al, 4
		jnz	short loc_62BA0FD4
		add	context_0, 8
		mov	[esp], ebx
		call	_silc_fsm_continue

loc_62BA0FD4:				; CODE XREF: _silc_client_command_reply_users_continue+1Fj
		add	esp, 20h
		pop	ebx
		pop	esi
		leave
		retn
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 4

loc_62BA0FDC:				; CODE XREF: _silc_client_command_reply_users_continue+10j
		lea	esi, [context_0+8]
		mov	[esp], esi
		call	_silc_fsm_get_state_context
		mov	[esp], eax
		call	_silc_command_get_args
		mov	byte ptr [context_0+5Ch], 17h
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		lea	edx, [ebp+arg2]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg1]
		mov	[esp+8], edx
		mov	[esp+4], eax
args = eax				; SilcArgumentPayload
		mov	dword ptr [esp], 17h
		call	_silc_status_get_args
		mov	eax, [ebp+arg2]
		mov	[esp+8], eax
		mov	eax, [ebp+arg1]
		mov	[esp+4], eax
		mov	[esp], context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	[esp], esi
		call	_silc_fsm_next
		jmp	loc_62BA0FBA
_silc_client_command_reply_users_continue endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __usercall silc_dlist_uninit_0(SilcDList	list@<eax>)
_silc_dlist_uninit_0 proc near		; CODE XREF: _silc_client_command_reply_leave:loc_62BA143Fp
					; _silc_client_command_reply_leave:loc_62BA14BBp

var_2C		= dword	ptr -2Ch

list = eax				; SilcDList
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	esi, list
		test	list, list
		jz	short loc_62BA10B7
		mov	ebx, [list]
		mov	[list+8], ebx
		and	byte ptr [list+10h], 0FDh
		test	ebx, ebx
		jz	short loc_62BA10AF

loc_62BA1068:				; CODE XREF: _silc_dlist_uninit_0+61j
list = esi				; SilcDList
		test	byte ptr [list+10h], 2
		jz	short loc_62BA10C0
		movzx	eax, word ptr [list+0Eh]
		mov	eax, [ebx+eax]

loc_62BA1075:				; CODE XREF: _silc_dlist_uninit_0+7Bj
		mov	[list+8], eax
		mov	eax, [list]
prev = eax				; void *
		test	prev, prev
		jz	short loc_62BA109B
		cmp	ebx, prev
		jz	loc_62BA1108
		movzx	edi, word ptr [list+0Ch]
		jmp	short loc_62BA1092
; ---------------------------------------------------------------------------

loc_62BA108C:				; CODE XREF: _silc_dlist_uninit_0+4Dj
p = edx					; void **
prev = ecx				; void *
		cmp	ebx, prev
		jz	short loc_62BA10CC
		mov	eax, prev

loc_62BA1092:				; CODE XREF: _silc_dlist_uninit_0+3Ej
prev = eax				; void *
		lea	p, [prev+edi]
		mov	ecx, [p]
prev = ecx				; void *
		test	prev, prev
		jnz	short loc_62BA108C

loc_62BA109B:				; CODE XREF: _silc_dlist_uninit_0+30j
prev = eax				; void *
		cmp	[list+4], ebx
		jz	short loc_62BA10F9

loc_62BA10A0:				; CODE XREF: _silc_dlist_uninit_0+ABj
					; _silc_dlist_uninit_0+B0j
		mov	[esp], ebx
		call	_silc_free
		mov	ebx, [list+8]
		test	ebx, ebx
		jnz	short loc_62BA1068

loc_62BA10AF:				; CODE XREF: _silc_dlist_uninit_0+1Aj
		mov	[esp], list
		call	_silc_free

loc_62BA10B7:				; CODE XREF: _silc_dlist_uninit_0+Dj
		add	esp, 3Ch
		pop	ebx
		pop	list
list = eax				; SilcDList
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
list = esi				; SilcDList
		align 10h

loc_62BA10C0:				; CODE XREF: _silc_dlist_uninit_0+20j
		movzx	eax, word ptr [list+0Ch]
		mov	eax, [ebx+eax]
		jmp	short loc_62BA1075
; ---------------------------------------------------------------------------
p = edx					; void **
prev = ecx				; void *
		align 4

loc_62BA10CC:				; CODE XREF: _silc_dlist_uninit_0+42j
		mov	[ebp+var_2C], p

loc_62BA10CF:				; CODE XREF: _silc_dlist_uninit_0+C5j
		mov	prev, [ebx+edi]
prev = eax				; void *
		mov	p, [ebp+var_2C]
		mov	[edx], ecx
		test	ecx, ecx
		jz	short loc_62BA10EB
		test	byte ptr [list+10h], 1
		jz	short loc_62BA10EB
		movzx	edi, word ptr [list+0Eh]
		mov	edx, [ebx+edi]
		mov	[ecx+edi], edx

loc_62BA10EB:				; CODE XREF: _silc_dlist_uninit_0+8Dj
					; _silc_dlist_uninit_0+93j
		cmp	[list+8], ebx
		jz	short loc_62BA10FE

loc_62BA10F0:				; CODE XREF: _silc_dlist_uninit_0+BAj
		sub	dword ptr [list+10h], 4
		cmp	[list+4], ebx
		jnz	short loc_62BA10A0

loc_62BA10F9:				; CODE XREF: _silc_dlist_uninit_0+52j
p = edx					; void **
		mov	[list+4], prev
		jmp	short loc_62BA10A0
; ---------------------------------------------------------------------------

loc_62BA10FE:				; CODE XREF: _silc_dlist_uninit_0+A2j
		mov	ecx, [ebp+var_2C]
		mov	edx, [ecx]
		mov	[list+8], edx
		jmp	short loc_62BA10F0
; ---------------------------------------------------------------------------

loc_62BA1108:				; CODE XREF: _silc_dlist_uninit_0+34j
		movzx	edi, word ptr [list+0Ch]
		mov	[ebp+var_2C], list
		xor	prev, prev
		jmp	short loc_62BA10CF
_silc_dlist_uninit_0 endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  60. silc_client_command_reply_leave

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_leave(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_leave
_silc_client_command_reply_leave proc near
					; DATA XREF: _silc_client_commands_unregister+101Eo
					; _silc_client_commands_register+AB3o ...

var_50		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -40h
arg2		= dword	ptr -20h
arg1_0		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA11A4
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA1248

loc_62BA1147:				; CODE XREF: _silc_client_command_reply_leave+176j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA1220
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA116A:				; CODE XREF: _silc_client_command_reply_leave+12Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA119A:				; CODE XREF: _silc_client_command_reply_leave+21Dj
channel	= esi				; SilcChannelEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA11A4:				; CODE XREF: _silc_client_command_reply_leave+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+var_50], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_50]
		jbe	short loc_62BA11CB
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 2
		mov	edx, [ebp+var_50]
		jbe	loc_62BA12B8

loc_62BA11CB:				; CODE XREF: _silc_client_command_reply_leave+A1j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA1290
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA11F0:				; CODE XREF: _silc_client_command_reply_leave+19Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 10h

loc_62BA1220:				; CODE XREF: _silc_client_command_reply_leave+46j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA116A
; ---------------------------------------------------------------------------

loc_62BA1248:				; CODE XREF: _silc_client_command_reply_leave+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_50], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotSetLeave ; "Cannot set leave: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_50]
		jmp	loc_62BA1147
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 10h

loc_62BA1290:				; CODE XREF: _silc_client_command_reply_leave+CAj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA11F0
; ---------------------------------------------------------------------------

loc_62BA12B8:				; CODE XREF: _silc_client_command_reply_leave+B1j
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_50], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_50]
		jnz	short loc_62BA1338
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA14F5

loc_62BA1302:				; CODE XREF: _silc_client_command_reply_leave+41Cj
channel	= esi				; SilcChannelEntry
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA130E:				; CODE XREF: _silc_client_command_reply_leave+404j
					; _silc_client_command_reply_leave+445j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_leave+3DCj
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA119A
; ---------------------------------------------------------------------------
		align 4

loc_62BA1338:				; CODE XREF: _silc_client_command_reply_leave+1D3j
		mov	[esp+8], esi	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_50], edx
		call	_silc_client_get_channel_by_id
		mov	esi, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+var_50]
		jz	loc_62BA151D
channel	= eax				; SilcChannelEntry
		mov	channel, [conn]
channel	= esi				; SilcChannelEntry
		mov	[esp+0Ch], eax	; client_entry
		mov	[esp+8], channel ; channel
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_remove_from_channel
		mov	[esp+4], channel
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	eax, [channel+158h]
		test	eax, eax
		jz	short loc_62BA1392
		mov	[esp], eax
		call	_silc_cipher_free

loc_62BA1392:				; CODE XREF: _silc_client_command_reply_leave+274j
		mov	dword ptr [channel+158h], 0
		mov	eax, [channel+15Ch]
		test	eax, eax
		jz	short loc_62BA13AE
		mov	[esp], eax
		call	_silc_cipher_free

loc_62BA13AE:				; CODE XREF: _silc_client_command_reply_leave+290j
		mov	dword ptr [channel+15Ch], 0
		mov	eax, [channel+160h]
		test	eax, eax
		jz	short loc_62BA13CA
		mov	[esp], eax
		call	_silc_hmac_free

loc_62BA13CA:				; CODE XREF: _silc_client_command_reply_leave+2ACj
		mov	dword ptr [channel+160h], 0
		mov	eax, [channel+148h]
		test	eax, eax
		jz	short loc_62BA1444
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		jmp	short loc_62BA1413
; ---------------------------------------------------------------------------
		align 4

loc_62BA13F8:				; CODE XREF: _silc_client_command_reply_leave+316j
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62BA13FF:				; CODE XREF: _silc_client_command_reply_leave+31Fj
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	edx, [edx]
key = edx				; SilcCipher
		test	key, key
		jz	short loc_62BA143F
		mov	[esp], key
		call	_silc_cipher_free

loc_62BA1413:				; CODE XREF: _silc_client_command_reply_leave+2E1j
		mov	eax, [channel+148h] ; list
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62BA1438
		test	byte ptr [eax+10h], 2
		jnz	short loc_62BA13F8
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	short loc_62BA13FF
; ---------------------------------------------------------------------------
		align 4

loc_62BA1438:				; CODE XREF: _silc_client_command_reply_leave+310j
		mov	dword ptr [eax+14h], 0

loc_62BA143F:				; CODE XREF: _silc_client_command_reply_leave+2F5j
key = edx				; SilcCipher
		call	_silc_dlist_uninit_0

loc_62BA1444:				; CODE XREF: _silc_client_command_reply_leave+2C8j
		mov	dword ptr [channel+148h], 0
		mov	eax, [channel+14Ch]
		test	eax, eax
		jz	short loc_62BA14C0
		mov	edx, [eax]
		mov	[eax+8], edx
		and	byte ptr [eax+10h], 0FDh
		mov	dword ptr [eax+18h], 0
		mov	dword ptr [eax+14h], 0
		jmp	short loc_62BA148F
; ---------------------------------------------------------------------------
		align 4

loc_62BA1474:				; CODE XREF: _silc_client_command_reply_leave+392j
		movzx	ecx, word ptr [eax+0Eh]
		mov	ecx, [edx+ecx]

loc_62BA147B:				; CODE XREF: _silc_client_command_reply_leave+39Bj
		mov	[eax+8], ecx
		mov	[eax+14h], edx
		mov	edx, [edx]
hmac = edx				; SilcHmac
		test	hmac, hmac
		jz	short loc_62BA14BB
		mov	[esp], hmac
		call	_silc_hmac_free

loc_62BA148F:				; CODE XREF: _silc_client_command_reply_leave+35Bj
		mov	eax, [channel+14Ch] ; list
		mov	edx, [eax+14h]
		mov	[eax+18h], edx
		mov	edx, [eax+8]
		test	edx, edx
		jz	short loc_62BA14B4
		test	byte ptr [eax+10h], 2
		jnz	short loc_62BA1474
		movzx	ecx, word ptr [eax+0Ch]
		mov	ecx, [edx+ecx]
		jmp	short loc_62BA147B
; ---------------------------------------------------------------------------
		align 4

loc_62BA14B4:				; CODE XREF: _silc_client_command_reply_leave+38Cj
		mov	dword ptr [eax+14h], 0

loc_62BA14BB:				; CODE XREF: _silc_client_command_reply_leave+371j
hmac = edx				; SilcHmac
		call	_silc_dlist_uninit_0

loc_62BA14C0:				; CODE XREF: _silc_client_command_reply_leave+342j
		mov	dword ptr [channel+14Ch], 0
		mov	[esp+8], channel ; channel
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_empty_channel
		mov	[esp+8], channel ; channel
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_del_channel
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA14F5:				; CODE XREF: _silc_client_command_reply_leave+1E8j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA130E
; ---------------------------------------------------------------------------

loc_62BA151D:				; CODE XREF: _silc_client_command_reply_leave+241j
channel	= eax				; SilcChannelEntry
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
channel	= esi				; SilcChannelEntry
		test	al, al
		jz	loc_62BA1302
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA130E
_silc_client_command_reply_leave endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  49. silc_client_command_reply_ban

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_ban(SilcFSMObject *fsm,	void *fsm_context, void	*state_context)
		public _silc_client_command_reply_ban
_silc_client_command_reply_ban proc near ; DATA	XREF: _silc_client_commands_unregister+D5Eo
					; _silc_client_commands_register+937o ...

var_50		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -44h
arg2		= dword	ptr -24h
arg1_0		= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA15F0
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA1694

loc_62BA1593:				; CODE XREF: _silc_client_command_reply_ban+176j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA166C
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA15B6:				; CODE XREF: _silc_client_command_reply_ban+12Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA15E6:				; CODE XREF: _silc_client_command_reply_ban+232j
channel	= esi				; SilcChannelEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA15F0:				; CODE XREF: _silc_client_command_reply_ban+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+var_50], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_50]
		jbe	short loc_62BA1617
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+var_50]
		jbe	loc_62BA1704

loc_62BA1617:				; CODE XREF: _silc_client_command_reply_ban+A1j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA16DC
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA163C:				; CODE XREF: _silc_client_command_reply_ban+19Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA166C:				; CODE XREF: _silc_client_command_reply_ban+46j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA15B6
; ---------------------------------------------------------------------------

loc_62BA1694:				; CODE XREF: _silc_client_command_reply_ban+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_50], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotSetBanS ; "Cannot set ban: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_50]
		jmp	loc_62BA1593
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA16DC:				; CODE XREF: _silc_client_command_reply_ban+CAj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA163C
; ---------------------------------------------------------------------------

loc_62BA1704:				; CODE XREF: _silc_client_command_reply_ban+B1j
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_50], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_50]
		jnz	short loc_62BA1798
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA1814
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA175A:				; CODE XREF: _silc_client_command_reply_ban+2D7j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		xor	esi, esi

out:					; CODE XREF: _silc_client_command_reply_ban+2A1j
					; _silc_client_command_reply_ban+2AFj ...
channel	= esi				; SilcChannelEntry ; channel_entry
invite_args = eax			; SilcArgumentPayload
		mov	[esp+8], channel
		mov	[esp+4], conn	; conn
		mov	invite_args, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA15E6
; ---------------------------------------------------------------------------
		align 4

loc_62BA1798:				; CODE XREF: _silc_client_command_reply_ban+1D3j
		mov	[esp+8], esi	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_50], edx
		call	_silc_client_get_channel_by_id
		mov	esi, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+var_50]
		jz	loc_62BA183C
channel	= eax				; SilcChannelEntry
		lea	channel, [ebp+len]
channel	= esi				; SilcChannelEntry
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	loc_62BA1872
		mov	edx, [ebp+len]
		mov	[esp+4], edx
		mov	[esp], tmp
		call	_silc_argument_list_parse
		mov	[esp+8], eax
invite_args = eax			; SilcArgumentPayload
		mov	[esp+4], channel
		mov	[esp], fsm_context_0 ; cmd
		mov	[ebp+var_50], invite_args
		call	_silc_client_command_callback
		mov	eax, [ebp+var_50]
		test	eax, eax
invite_args = eax			; SilcArgumentPayload
		jz	out
		mov	[esp], invite_args
		call	_silc_argument_payload_free
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA1814:				; CODE XREF: _silc_client_command_reply_ban+1E8j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA175A
; ---------------------------------------------------------------------------

loc_62BA183C:				; CODE XREF: _silc_client_command_reply_ban+255j
channel	= eax				; SilcChannelEntry
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
channel	= esi				; SilcChannelEntry
		test	al, al
		jnz	short loc_62BA188B
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	edx, edx
		xor	eax, eax

loc_62BA185D:				; CODE XREF: _silc_client_command_reply_ban+34Ej
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA1872:				; CODE XREF: _silc_client_command_reply_ban+274j
tmp = eax				; unsigned __int8 *
		mov	dword ptr [esp+8], 0
		mov	[esp+4], channel
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA188B:				; CODE XREF: _silc_client_command_reply_ban+2EFj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg2]
		mov	edx, [ebp+arg1_0]
		jmp	short loc_62BA185D
_silc_client_command_reply_ban endp

; Exported entry  56. silc_client_command_reply_invite

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_invite(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_reply_invite
_silc_client_command_reply_invite proc near
					; DATA XREF: _silc_client_commands_unregister+46Eo
					; _silc_client_commands_register+2F8o ...

var_50		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -44h
arg2		= dword	ptr -24h
arg1_0		= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA1940
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA19E4

loc_62BA18E3:				; CODE XREF: _silc_client_command_reply_invite+176j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA19BC
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA1906:				; CODE XREF: _silc_client_command_reply_invite+12Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA1936:				; CODE XREF: _silc_client_command_reply_invite+232j
channel	= esi				; SilcChannelEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA1940:				; CODE XREF: _silc_client_command_reply_invite+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+var_50], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_50]
		jbe	short loc_62BA1967
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+var_50]
		jbe	loc_62BA1A54

loc_62BA1967:				; CODE XREF: _silc_client_command_reply_invite+A1j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA1A2C
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA198C:				; CODE XREF: _silc_client_command_reply_invite+19Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA19BC:				; CODE XREF: _silc_client_command_reply_invite+46j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA1906
; ---------------------------------------------------------------------------

loc_62BA19E4:				; CODE XREF: _silc_client_command_reply_invite+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_50], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotInviteS ; "Cannot invite: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_50]
		jmp	loc_62BA18E3
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA1A2C:				; CODE XREF: _silc_client_command_reply_invite+CAj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA198C
; ---------------------------------------------------------------------------

loc_62BA1A54:				; CODE XREF: _silc_client_command_reply_invite+B1j
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_50], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_50]
		jnz	short loc_62BA1AE8
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA1B64
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA1AAA:				; CODE XREF: _silc_client_command_reply_invite+2D7j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		xor	esi, esi

out:					; CODE XREF: _silc_client_command_reply_invite+2A1j
					; _silc_client_command_reply_invite+2AFj ...
channel	= esi				; SilcChannelEntry ; channel_entry
invite_args = eax			; SilcArgumentPayload
		mov	[esp+8], channel
		mov	[esp+4], conn	; conn
		mov	invite_args, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA1936
; ---------------------------------------------------------------------------
		align 4

loc_62BA1AE8:				; CODE XREF: _silc_client_command_reply_invite+1D3j
		mov	[esp+8], esi	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_50], edx
		call	_silc_client_get_channel_by_id
		mov	esi, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+var_50]
		jz	loc_62BA1B8C
channel	= eax				; SilcChannelEntry
		lea	channel, [ebp+len]
channel	= esi				; SilcChannelEntry
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	loc_62BA1BC2
		mov	edx, [ebp+len]
		mov	[esp+4], edx
		mov	[esp], tmp
		call	_silc_argument_list_parse
		mov	[esp+8], eax
invite_args = eax			; SilcArgumentPayload
		mov	[esp+4], channel
		mov	[esp], fsm_context_0 ; cmd
		mov	[ebp+var_50], invite_args
		call	_silc_client_command_callback
		mov	eax, [ebp+var_50]
		test	eax, eax
invite_args = eax			; SilcArgumentPayload
		jz	out
		mov	[esp], invite_args
		call	_silc_argument_payload_free
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA1B64:				; CODE XREF: _silc_client_command_reply_invite+1E8j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA1AAA
; ---------------------------------------------------------------------------

loc_62BA1B8C:				; CODE XREF: _silc_client_command_reply_invite+255j
channel	= eax				; SilcChannelEntry
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
channel	= esi				; SilcChannelEntry
		test	al, al
		jnz	short loc_62BA1BDB
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	edx, edx
		xor	eax, eax

loc_62BA1BAD:				; CODE XREF: _silc_client_command_reply_invite+34Ej
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA1BC2:				; CODE XREF: _silc_client_command_reply_invite+274j
tmp = eax				; unsigned __int8 *
		mov	dword ptr [esp+8], 0
		mov	[esp+4], channel
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA1BDB:				; CODE XREF: _silc_client_command_reply_invite+2EFj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg2]
		mov	edx, [ebp+arg1_0]
		jmp	short loc_62BA1BAD
_silc_client_command_reply_invite endp

; Exported entry  52. silc_client_command_reply_detach

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_detach(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_reply_detach
_silc_client_command_reply_detach proc near
					; DATA XREF: _silc_client_commands_unregister+E0Eo
					; _silc_client_commands_register+9B2o ...

var_30		= dword	ptr -30h
client		= dword	ptr -2Ch
arg2		= dword	ptr -20h
arg1		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA1C90
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA1D20

loc_62BA1C33:				; CODE XREF: _silc_client_command_reply_detach+162j
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA1CF8
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA1C56:				; CODE XREF: _silc_client_command_reply_detach+11Bj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA1C86:				; CODE XREF: _silc_client_command_reply_detach+1F0j
detach = esi				; SilcBuffer
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	detach
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA1C90:				; CODE XREF: _silc_client_command_reply_detach+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+var_30], args
		call	_silc_argument_get_arg_num
		test	eax, eax
		mov	edx, [ebp+var_30]
		jnz	loc_62BA1D90

loc_62BA1CA6:				; CODE XREF: _silc_client_command_reply_detach+19Ej
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA1D68
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA1CCB:				; CODE XREF: _silc_client_command_reply_detach+18Bj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 4Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA1CF8:				; CODE XREF: _silc_client_command_reply_detach+46j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA1C56
; ---------------------------------------------------------------------------

loc_62BA1D20:				; CODE XREF: _silc_client_command_reply_detach+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_30], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotDetachS ; "Cannot detach: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_30]
		jmp	loc_62BA1C33
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA1D68:				; CODE XREF: _silc_client_command_reply_detach+B9j
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA1CCB
; ---------------------------------------------------------------------------

loc_62BA1D90:				; CODE XREF: _silc_client_command_reply_detach+A0j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_30]
		ja	loc_62BA1CA6
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_30], edx
		call	_silc_client_get_detach_data
		mov	state_context_0, eax
detach = esi				; SilcBuffer
		test	eax, eax
		mov	edx, [ebp+var_30]
		jz	short loc_62BA1DF5
detach = eax				; SilcBuffer
		mov	[esp+4], detach
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
detach = esi				; SilcBuffer
		mov	eax, [detach]
		mov	[esp], eax
		call	_silc_free
		mov	[esp], detach
		call	_silc_free

out:					; CODE XREF: _silc_client_command_reply_detach+226j
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA1C86
; ---------------------------------------------------------------------------

loc_62BA1DF5:				; CODE XREF: _silc_client_command_reply_detach+1BDj
detach = eax				; SilcBuffer
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
detach = esi				; SilcBuffer
		test	al, al
		jnz	short loc_62BA1E28
		mov	byte ptr [fsm_context_0+5Dh], 30h
		mov	byte ptr [fsm_context_0+5Ch], 30h
		xor	eax, eax
		xor	edx, edx

loc_62BA1E16:				; CODE XREF: _silc_client_command_reply_detach+24Bj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	short out
; ---------------------------------------------------------------------------

loc_62BA1E28:				; CODE XREF: _silc_client_command_reply_detach+208j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	short loc_62BA1E16
_silc_client_command_reply_detach endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  51. silc_client_command_reply_cumode

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_cumode(SilcFSMObject *fsm, void	*fsm_context, void *state_context)
		public _silc_client_command_reply_cumode
_silc_client_command_reply_cumode proc near
					; DATA XREF: _silc_client_commands_unregister+BFEo
					; _silc_client_commands_register+841o ...

var_6C		= dword	ptr -6Ch
var_68		= byte ptr -68h
var_53		= byte ptr -53h
var_52		= byte ptr -52h
var_51		= byte ptr -51h
client_entry	= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -44h
arg1		= dword	ptr -24h
arg2		= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 8Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA1EE8
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA1F7C

loc_62BA1E86:				; CODE XREF: _silc_client_command_reply_cumode+16Ej
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA1F54
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA1EA9:				; CODE XREF: _silc_client_command_reply_cumode+127j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next

loc_62BA1ED9:				; CODE XREF: _silc_client_command_reply_cumode+234j
channel	= esi				; SilcChannelEntry
		xor	eax, eax
		add	esp, 8Ch
		pop	fsm_context_0
		pop	channel
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA1EE8:				; CODE XREF: _silc_client_command_reply_cumode+2Aj
		mov	[esp], args
		mov	[ebp+var_6C], args
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+var_6C]
		ja	loc_62BA1FEC

loc_62BA1EFF:				; CODE XREF: _silc_client_command_reply_cumode+1AAj
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA1FC4
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA1F24:				; CODE XREF: _silc_client_command_reply_cumode+197j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 8Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA1F54:				; CODE XREF: _silc_client_command_reply_cumode+49j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA1EA9
; ---------------------------------------------------------------------------

loc_62BA1F7C:				; CODE XREF: _silc_client_command_reply_cumode+30j
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_6C], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotChangeMo ; "Cannot change mode: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_6C]
		jmp	loc_62BA1E86
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA1FC4:				; CODE XREF: _silc_client_command_reply_cumode+C2j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA1F24
; ---------------------------------------------------------------------------

loc_62BA1FEC:				; CODE XREF: _silc_client_command_reply_cumode+A9j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 4
		mov	edx, [ebp+var_6C]
		ja	loc_62BA1EFF
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_6C], args
		call	_silc_argument_get_arg_type
		test	eax, eax
modev =	eax				; unsigned __int8 *
		mov	edx, [ebp+var_6C]
		jz	short loc_62BA202B
		cmp	[ebp+len], 4
		jz	loc_62BA20AE

loc_62BA202B:				; CODE XREF: _silc_client_command_reply_cumode+1CFj
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	short loc_62BA2089

loc_62BA2040:				; CODE XREF: _silc_client_command_reply_cumode+2B9j
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA204C:				; CODE XREF: _silc_client_command_reply_cumode+25Cj
					; _silc_client_command_reply_cumode+2E2j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		xor	state_context_0, state_context_0

out:					; CODE XREF: _silc_client_command_reply_cumode+371j
					; _silc_client_command_reply_cumode+3ADj ...
channel	= esi				; SilcChannelEntry ; channel_entry
		mov	[esp+8], channel
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next
		jmp	loc_62BA1ED9
; ---------------------------------------------------------------------------

loc_62BA2089:				; CODE XREF: _silc_client_command_reply_cumode+1EEj
state_context_0	= esi			; void *
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	short loc_62BA204C
; ---------------------------------------------------------------------------

loc_62BA20AE:				; CODE XREF: _silc_client_command_reply_cumode+1D5j
modev =	eax				; unsigned __int8 *
		mov	cl, [modev]
		mov	[ebp+var_68], cl
		mov	cl, [modev+1]
		mov	[ebp+var_53], cl
		mov	cl, [modev+2]
		mov	[ebp+var_52], cl
		mov	al, [modev+3]
		mov	[ebp+var_51], al
		mov	dword ptr [esp+10h], 0
		lea	eax, [ebp+id]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_6C], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_6C]
		jnz	short loc_62BA2137
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jz	loc_62BA2040
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA204C
; ---------------------------------------------------------------------------

loc_62BA2137:				; CODE XREF: _silc_client_command_reply_cumode+2A4j
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_6C], edx
		call	_silc_client_get_channel_by_id
		mov	state_context_0, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+var_6C]
		jz	short loc_62BA21C6
channel	= eax				; SilcChannelEntry
		mov	dword ptr [esp+10h], 0
		lea	ecx, [ebp+id]
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 4
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_6C], args
		call	_silc_argument_get_decoded
channel	= esi				; SilcChannelEntry
		test	al, al
		mov	edx, [ebp+var_6C]
		jnz	short loc_62BA2202
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA22B3
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA21AB:				; CODE XREF: _silc_client_command_reply_cumode+480j
		mov	eax, [ebp+arg2]
		mov	[esp+8], eax
		mov	eax, [ebp+arg1]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA21C6:				; CODE XREF: _silc_client_command_reply_cumode+307j
					; _silc_client_command_reply_cumode+3D3j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA22D5
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA21E7:				; CODE XREF: _silc_client_command_reply_cumode+4A2j
		mov	eax, [ebp+arg1]
		mov	[esp+8], eax
		mov	eax, [ebp+arg2]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA2202:				; CODE XREF: _silc_client_command_reply_cumode+338j
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; client_id
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		mov	[ebp+var_6C], edx
		call	_silc_client_get_client_by_id
		mov	[ebp+client_entry], eax
		test	eax, eax
		mov	edx, [ebp+var_6C]
		jz	short loc_62BA21C6
		movzx	edx, [ebp+var_51]
mode = edx				; SilcUInt32
		mov	al, [ebp+var_68]
		shl	eax, 18h
		or	mode, eax
		movzx	eax, [ebp+var_53]
		shl	eax, 10h
		or	mode, eax
		movzx	eax, [ebp+var_52]
		shl	eax, 8
		or	mode, eax
		mov	eax, [channel+144h]
		mov	[esp], eax
		mov	[ebp+var_6C], mode
		call	_silc_rwlock_wrlock
		mov	eax, [ebp+client_entry]
		mov	[esp+4], eax	; client_entry
		mov	[esp], channel	; channel
		call	_silc_client_on_channel
		test	eax, eax
chu = eax				; SilcChannelUser
		mov	edx, [ebp+var_6C]
		jz	short loc_62BA226D
		mov	[chu+4], edx

loc_62BA226D:				; CODE XREF: _silc_client_command_reply_cumode+418j
mode = edx				; SilcUInt32
		mov	chu, [channel+144h]
		mov	[esp], eax
		mov	[ebp+var_6C], mode
		call	_silc_rwlock_unlock
		mov	ecx, [ebp+client_entry]
		mov	[esp+0Ch], ecx
		mov	[esp+8], channel
		mov	edx, [ebp+var_6C]
		mov	[esp+4], edx
mode = edx				; SilcUInt32
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	eax, [ebp+client_entry]
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], conn	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_unref_client
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA22B3:				; CODE XREF: _silc_client_command_reply_cumode+34Dj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA21AB
; ---------------------------------------------------------------------------

loc_62BA22D5:				; CODE XREF: _silc_client_command_reply_cumode+389j
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA21E7
_silc_client_command_reply_cumode endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  50. silc_client_command_reply_cmode

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_cmode(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_cmode
_silc_client_command_reply_cmode proc near
					; DATA XREF: _silc_client_commands_unregister+B4Eo
					; _silc_client_commands_register+7C6o ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
mode		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -48h
arg1_0		= dword	ptr -28h
arg2		= dword	ptr -24h
public_key	= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	[ebp+public_key], 0
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA2390
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA2424

loc_62BA2332:				; CODE XREF: _silc_client_command_reply_cmode+16Ej
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA23FC
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA2355:				; CODE XREF: _silc_client_command_reply_cmode+127j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA2385:				; CODE XREF: _silc_client_command_reply_cmode+24Dj
channel	= esi				; SilcChannelEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 10h

loc_62BA2390:				; CODE XREF: _silc_client_command_reply_cmode+2Ej
		mov	[esp], args
		mov	[ebp+var_58], args
		call	_silc_argument_get_arg_num
		cmp	eax, 2
		mov	edx, [ebp+var_58]
		ja	loc_62BA2494

loc_62BA23A7:				; CODE XREF: _silc_client_command_reply_cmode+1AAj
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA246C
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA23CC:				; CODE XREF: _silc_client_command_reply_cmode+197j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA23FC:				; CODE XREF: _silc_client_command_reply_cmode+4Dj
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA2355
; ---------------------------------------------------------------------------

loc_62BA2424:				; CODE XREF: _silc_client_command_reply_cmode+34j
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_58], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotChangeMo ; "Cannot change mode: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_58]
		jmp	loc_62BA2332
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA246C:				; CODE XREF: _silc_client_command_reply_cmode+C2j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA23CC
; ---------------------------------------------------------------------------

loc_62BA2494:				; CODE XREF: _silc_client_command_reply_cmode+A9j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 6
		mov	edx, [ebp+var_58]
		ja	loc_62BA23A7
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_58], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_58]
		jnz	short loc_62BA254A
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA260F
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA24FE:				; CODE XREF: _silc_client_command_reply_cmode+33Aj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		xor	esi, esi

out:					; CODE XREF: _silc_client_command_reply_cmode+312j
					; _silc_client_command_reply_cmode+376j ...
channel	= esi				; SilcChannelEntry ; channel_entry
		mov	[esp+8], channel
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	eax, [ebp+public_key]
		test	eax, eax
		jz	short loc_62BA2532
		mov	[esp], eax
		call	_silc_pkcs_public_key_free

loc_62BA2532:				; CODE XREF: _silc_client_command_reply_cmode+230j
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA2385
; ---------------------------------------------------------------------------

loc_62BA254A:				; CODE XREF: _silc_client_command_reply_cmode+1DFj
		mov	[esp+8], esi	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_58], edx
		call	_silc_client_get_channel_by_id
		mov	esi, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+var_58]
		jz	loc_62BA2637
channel	= eax				; SilcChannelEntry
		lea	channel, [ebp+len]
channel	= esi				; SilcChannelEntry
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 4
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_58], args
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+var_58]
		jz	short loc_62BA25A7
		lea	ecx, [ebp+public_key]
		mov	[esp+8], ecx
		mov	ecx, [ebp+len]
		mov	[esp+4], ecx
		mov	[esp], tmp
		call	_silc_public_key_payload_decode
		mov	edx, [ebp+var_58]

loc_62BA25A7:				; CODE XREF: _silc_client_command_reply_cmode+294j
tmp = eax				; unsigned __int8 *
		lea	tmp, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_58], args
		call	_silc_argument_get_arg_type
		mov	ecx, eax
tmp = ecx				; unsigned __int8 *
		test	eax, eax
		mov	edx, [ebp+var_58]
		jz	short loc_62BA25D4
tmp = eax				; unsigned __int8 *
		cmp	[ebp+len], 4
		jz	loc_62BA2698

loc_62BA25D4:				; CODE XREF: _silc_client_command_reply_cmode+2D0j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
tmp = ecx				; unsigned __int8 *
		test	al, al
		jnz	loc_62BA2673
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax

loc_62BA25F7:				; CODE XREF: _silc_client_command_reply_cmode+39Bj
		mov	[esp+8], eax
		mov	eax, [ebp+arg2]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA260F:				; CODE XREF: _silc_client_command_reply_cmode+1F4j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA24FE
; ---------------------------------------------------------------------------

loc_62BA2637:				; CODE XREF: _silc_client_command_reply_cmode+26Fj
channel	= eax				; SilcChannelEntry
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
channel	= esi				; SilcChannelEntry
		test	al, al
		jnz	loc_62BA2791
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA2658:				; CODE XREF: _silc_client_command_reply_cmode+4B6j
		mov	eax, [ebp+arg2]
		mov	[esp+8], eax
		mov	eax, [ebp+arg1_0]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA2673:				; CODE XREF: _silc_client_command_reply_cmode+2EFj
tmp = ecx				; unsigned __int8 *
		lea	tmp, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA25F7
; ---------------------------------------------------------------------------

loc_62BA2698:				; CODE XREF: _silc_client_command_reply_cmode+2D6j
tmp = eax				; unsigned __int8 *
		movzx	tmp, byte ptr [tmp+3]
tmp = ecx				; unsigned __int8 *
		mov	[ebp+mode], eax
		movzx	eax, byte ptr [tmp]
		shl	eax, 18h
		or	[ebp+mode], eax
		movzx	eax, byte ptr [tmp+1]
		shl	eax, 10h
		or	[ebp+mode], eax
		movzx	eax, byte ptr [tmp+2]
		shl	eax, 8
		or	[ebp+mode], eax
		mov	eax, [channel+144h]
		mov	[esp], eax
		mov	[ebp+var_58], edx
		call	_silc_rwlock_wrlock
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 6
		mov	edx, [ebp+var_58]
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		mov	ecx, eax
tmp = ecx				; unsigned __int8 *
		test	eax, eax
		mov	edx, [ebp+var_58]
		jz	short loc_62BA26FA
tmp = eax				; unsigned __int8 *
		cmp	[ebp+len], 4
		jz	loc_62BA27E1

loc_62BA26FA:				; CODE XREF: _silc_client_command_reply_cmode+3F6j
					; _silc_client_command_reply_cmode+516j
tmp = ecx				; unsigned __int8 *
		test	byte ptr [channel+12Ch], 20h
		jnz	short loc_62BA270D
		mov	dword ptr [channel+130h], 0

loc_62BA270D:				; CODE XREF: _silc_client_command_reply_cmode+409j
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 5
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	loc_62BA27B3
		mov	dword ptr [esp+0Ch], 0 ; remove_all
		mov	edx, [ebp+len]
		mov	[esp+8], edx	; chpk_list_len
		mov	[esp+4], tmp	; chpk_list
		mov	[esp], channel	; channel
		call	_silc_client_channel_save_public_keys

loc_62BA2747:				; CODE XREF: _silc_client_command_reply_cmode+4C2j
					; _silc_client_command_reply_cmode+4E4j
tmp = eax				; unsigned __int8 *
		mov	tmp, [ebp+mode]
		mov	[channel+12Ch],	eax
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	eax, [channel+130h]
		mov	[esp+14h], eax
		mov	eax, [channel+110h]
		mov	[esp+10h], eax
		mov	eax, [ebp+public_key]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+mode]
		mov	[esp+8], eax
		mov	[esp+4], channel
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA2791:				; CODE XREF: _silc_client_command_reply_cmode+352j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA2658
; ---------------------------------------------------------------------------

loc_62BA27B3:				; CODE XREF: _silc_client_command_reply_cmode+42Ej
tmp = eax				; unsigned __int8 *
		test	byte ptr [channel+12Dh], 10h
		jz	short loc_62BA2747
		mov	dword ptr [esp+0Ch], 1 ; remove_all
		mov	dword ptr [esp+8], 0 ; chpk_list_len
		mov	dword ptr [esp+4], 0 ; chpk_list
		mov	[esp], channel	; channel
		call	_silc_client_channel_save_public_keys
		jmp	loc_62BA2747
; ---------------------------------------------------------------------------

loc_62BA27E1:				; CODE XREF: _silc_client_command_reply_cmode+3FCj
tmp = eax				; unsigned __int8 *
		movzx	tmp, byte ptr [tmp+3]
tmp = ecx				; unsigned __int8 *
		mov	[ebp+var_54], eax
		movzx	eax, byte ptr [tmp]
		shl	eax, 18h
		or	[ebp+var_54], eax
		movzx	eax, byte ptr [tmp+1]
		shl	eax, 10h
		or	[ebp+var_54], eax
		movzx	eax, byte ptr [tmp+2]
		shl	eax, 8
		or	[ebp+var_54], eax
		mov	eax, [ebp+var_54]
		mov	[channel+130h],	eax
		jmp	loc_62BA26FA
_silc_client_command_reply_cmode endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  62. silc_client_command_reply_motd

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_motd(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_motd
_silc_client_command_reply_motd	proc near ; DATA XREF: _silc_client_commands_unregister+9EEo
					; _silc_client_commands_register+6D0o ...

var_14C		= dword	ptr -14Ch
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_134		= dword	ptr -134h
motd		= dword	ptr -130h
client		= dword	ptr -12Ch
line		= byte ptr -120h
arg2		= dword	ptr -20h
arg1		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 16Ch
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebp+state_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], edi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA28B0
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA2960

loc_62BA284D:				; CODE XREF: _silc_client_command_reply_motd+194j
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA2938
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA2870:				; CODE XREF: _silc_client_command_reply_motd+147j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next

loc_62BA28A0:				; CODE XREF: _silc_client_command_reply_motd+20Cj
cp = esi				; char *
		xor	eax, eax
		add	esp, 16Ch
		pop	fsm_context_0
		pop	cp
		pop	state_context_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
conn = esi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 10h

loc_62BA28B0:				; CODE XREF: _silc_client_command_reply_motd+2Dj
		mov	[esp], args
		mov	[ebp+var_13C], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_13C]
		jbe	short loc_62BA28E0
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+var_13C]
		jbe	loc_62BA29D8

loc_62BA28E0:				; CODE XREF: _silc_client_command_reply_motd+B3j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA29B0
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA2905:				; CODE XREF: _silc_client_command_reply_motd+1BFj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 16Ch
		pop	fsm_context_0
		pop	conn
		pop	state_context_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
conn = esi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA2938:				; CODE XREF: _silc_client_command_reply_motd+4Cj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA2870
; ---------------------------------------------------------------------------

loc_62BA2960:				; CODE XREF: _silc_client_command_reply_motd+33j
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_13C], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotGetMotdS ; "Cannot get motd:	%s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	esi
		mov	edx, [ebp+var_13C]
		jmp	loc_62BA284D
; ---------------------------------------------------------------------------
conn = esi				; SilcClientConnection
		align 10h

loc_62BA29B0:				; CODE XREF: _silc_client_command_reply_motd+DFj
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA2905
; ---------------------------------------------------------------------------

loc_62BA29D8:				; CODE XREF: _silc_client_command_reply_motd+C6j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_13C], args
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+var_13C]
		jz	short loc_62BA2A28
		mov	[ebp+motd], 0

loc_62BA29FB:				; CODE XREF: _silc_client_command_reply_motd+2BFj
i = edx					; SilcUInt32
cp = esi				; char *
		mov	eax, [ebp+motd]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_motd+33Bj
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		jmp	loc_62BA28A0
; ---------------------------------------------------------------------------
state_context_0	= edi			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62BA2A28:				; CODE XREF: _silc_client_command_reply_motd+1DBj
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_13C], args
		call	_silc_argument_get_arg_type
		mov	[ebp+motd], eax
		test	eax, eax
		mov	edx, [ebp+var_13C]
		jz	loc_62BA2B1E
		lea	edx, [ebp+line]
		mov	[ebp+var_14C], edx
		mov	[ebp+var_138], conn
		mov	conn, eax
cp = eax				; char *
		mov	[ebp+var_134], fsm_context_0

loc_62BA2A74:				; CODE XREF: _silc_client_command_reply_motd+2B7j
i = ebx					; SilcUInt32
cp = esi				; char *
		xor	edx, edx
i = edx					; SilcUInt32
		jmp	short loc_62BA2A7A
; ---------------------------------------------------------------------------

loc_62BA2A78:				; CODE XREF: _silc_client_command_reply_motd+272j
state_context_0	= edi			; void *
i = ebx					; SilcUInt32
		mov	edx, i

loc_62BA2A7A:				; CODE XREF: _silc_client_command_reply_motd+262j
i = edx					; SilcUInt32
		mov	al, [cp+i]
		test	al, al
		jz	short loc_62BA2ACD
		lea	ebx, [i+1]
i = ebx					; SilcUInt32
		cmp	al, 0Ah
		jnz	short loc_62BA2A78
state_context_0	= edi			; void *
		mov	ecx, 100h
		xor	eax, eax
		mov	state_context_0, [ebp+var_14C]
		rep stosb
		mov	[esp+0Ch], edx
		mov	[esp+8], cp
		mov	dword ptr [esp+4], 100h
		lea	eax, [ebp+line]
		mov	[esp], eax
		call	_silc_strncat
		add	cp, i
		cmp	i, 2
		jz	short loc_62BA2B15

loc_62BA2ABC:				; CODE XREF: _silc_client_command_reply_motd+308j
		mov	edx, [ebp+var_134]
		test	byte ptr [edx+64h], 2
		jnz	short loc_62BA2AD8

loc_62BA2AC8:				; CODE XREF: _silc_client_command_reply_motd+2FFj
		cmp	byte ptr [cp], 0
		jnz	short loc_62BA2A74

loc_62BA2ACD:				; CODE XREF: _silc_client_command_reply_motd+26Bj
		mov	i, [ebp+var_134]
fsm_context_0 =	ebx			; void *
i = edx					; SilcUInt32
		jmp	loc_62BA29FB
; ---------------------------------------------------------------------------

loc_62BA2AD8:				; CODE XREF: _silc_client_command_reply_motd+2B2j
i = ebx					; SilcUInt32
		mov	eax, [edx+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		lea	edx, [ebp+line]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], offset aS_0 ; "%s"
		mov	dword ptr [esp+8], 0
		mov	edx, [ebp+var_138]
		mov	[esp+4], edx
		mov	edx, [ebp+client]
		mov	[esp], edx
		call	dword ptr [eax]
		jmp	short loc_62BA2AC8
; ---------------------------------------------------------------------------

loc_62BA2B15:				; CODE XREF: _silc_client_command_reply_motd+2A6j
		mov	[ebp+line], 20h
		jmp	short loc_62BA2ABC
; ---------------------------------------------------------------------------

loc_62BA2B1E:				; CODE XREF: _silc_client_command_reply_motd+240j
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
conn = esi				; SilcClientConnection
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	short loc_62BA2B54
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA2B3F:				; CODE XREF: _silc_client_command_reply_motd+363j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA2B54:				; CODE XREF: _silc_client_command_reply_motd+31Dj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	short loc_62BA2B3F
_silc_client_command_reply_motd	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  61. silc_client_command_reply_list

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_list(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_list
_silc_client_command_reply_list	proc near ; DATA XREF: _silc_client_commands_unregister+30Eo
					; _silc_client_commands_register+255o ...

channel_entry	= dword	ptr -5Ch
topic		= dword	ptr -58h
name		= dword	ptr -54h
usercount	= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -40h
arg2		= dword	ptr -20h
arg1_0		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA2C0C
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA2CD4

loc_62BA2BAF:				; CODE XREF: _silc_client_command_reply_list+19Aj
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA2CAC
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA2BD2:				; CODE XREF: _silc_client_command_reply_list+153j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA2C02:				; CODE XREF: _silc_client_command_reply_list+2FBj
		xor	eax, eax
		add	esp, 7Ch
		pop	fsm_context_0
		pop	esi
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA2C0C:				; CODE XREF: _silc_client_command_reply_list+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], args
		mov	[ebp+channel_entry], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+channel_entry]
		jz	loc_62BA2D1C
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+channel_entry], args
		call	_silc_argument_get_arg_num
		cmp	eax, 2
		mov	edx, [ebp+channel_entry]
		ja	loc_62BA2D64

loc_62BA2C58:				; CODE XREF: _silc_client_command_reply_list+1F6j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA2E7C
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA2C7D:				; CODE XREF: _silc_client_command_reply_list+323j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 7Ch
		pop	fsm_context_0
		pop	esi
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA2CAC:				; CODE XREF: _silc_client_command_reply_list+46j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA2BD2
; ---------------------------------------------------------------------------

loc_62BA2CD4:				; CODE XREF: _silc_client_command_reply_list+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+channel_entry], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotListChan ; "Cannot list channels: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+channel_entry]
		jmp	loc_62BA2BAF
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA2D1C:				; CODE XREF: _silc_client_command_reply_list+BFj
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 7Ch
		pop	fsm_context_0
		pop	esi
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = edi				; SilcClientConnection
		align 4

loc_62BA2D64:				; CODE XREF: _silc_client_command_reply_list+D6j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 5
		mov	edx, [ebp+channel_entry]
		ja	loc_62BA2C58
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+channel_entry], args
		call	_silc_argument_get_arg_type
		mov	[ebp+name], eax
		test	eax, eax
		mov	edx, [ebp+channel_entry]
		jz	loc_62BA2EA4
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 4
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+channel_entry], args
		call	_silc_argument_get_arg_type
		mov	[ebp+topic], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	edx, [ebp+channel_entry]
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		mov	ecx, eax
tmp = ecx				; unsigned __int8 *
		test	eax, eax
		mov	edx, [ebp+channel_entry]
		jz	loc_62BA2F25
tmp = eax				; unsigned __int8 *
		movzx	tmp, byte ptr [tmp+3]
tmp = ecx				; unsigned __int8 *
		mov	[ebp+usercount], eax
		movzx	eax, byte ptr [tmp]
		shl	eax, 18h
		or	[ebp+usercount], eax
		movzx	eax, byte ptr [tmp+1]
		shl	eax, 10h
		or	[ebp+usercount], eax
		movzx	eax, byte ptr [tmp+2]
		shl	eax, 8
		or	[ebp+usercount], eax

loc_62BA2E0B:				; CODE XREF: _silc_client_command_reply_list+3B0j
		mov	[esp+8], esi	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+channel_entry], edx
		call	_silc_client_get_channel_by_id
		mov	ecx, eax
channel_entry =	ecx			; SilcChannelEntry
		test	eax, eax
		jz	loc_62BA2EDC

loc_62BA2E2B:				; CODE XREF: _silc_client_command_reply_list+3A4j
channel_entry =	eax			; SilcChannelEntry
		mov	channel_entry, [ebp+usercount]
channel_entry =	ecx			; SilcChannelEntry
		mov	[esp+10h], eax
		mov	eax, [ebp+topic]
		mov	[esp+0Ch], eax
		mov	eax, [channel_entry]
		mov	[esp+8], eax
		mov	[esp+4], channel_entry
		mov	[esp], fsm_context_0 ; cmd
		mov	[ebp+channel_entry], channel_entry
		call	_silc_client_command_callback
		mov	ecx, [ebp+channel_entry]

out:					; CODE XREF: _silc_client_command_reply_list+35Bj
					; _silc_client_command_reply_list+414j
channel_entry =	ecx			; SilcChannelEntry ; channel_entry
		mov	[esp+8], channel_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA2C02
; ---------------------------------------------------------------------------

loc_62BA2E7C:				; CODE XREF: _silc_client_command_reply_list+EFj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA2C7D
; ---------------------------------------------------------------------------

loc_62BA2EA4:				; CODE XREF: _silc_client_command_reply_list+21Fj
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	short loc_62BA2F31
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA2EC5:				; CODE XREF: _silc_client_command_reply_list+3D8j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		xor	ecx, ecx
channel_entry =	ecx			; SilcChannelEntry
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA2EDC:				; CODE XREF: _silc_client_command_reply_list+2A9j
channel_entry =	eax			; SilcChannelEntry ; channel_id
		mov	[esp+10h], esi
		mov	dword ptr [esp+0Ch], 0 ; mode
		mov	channel_entry, [ebp+name]
channel_entry =	ecx			; SilcChannelEntry
		mov	[esp+8], eax	; channel_name
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_add_channel
		mov	ecx, eax
channel_entry =	ecx			; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+channel_entry]
		jz	short loc_62BA2F59
channel_entry =	eax			; SilcChannelEntry
		mov	[esp+8], channel_entry ; channel_entry
		mov	[esp+4], conn	; conn
		mov	channel_entry, [ebp+client]
channel_entry =	ecx			; SilcChannelEntry
		mov	[esp], eax	; client
		mov	[ebp+channel_entry], channel_entry
		call	_silc_client_ref_channel
		mov	ecx, [ebp+channel_entry]
		jmp	loc_62BA2E2B
; ---------------------------------------------------------------------------

loc_62BA2F25:				; CODE XREF: _silc_client_command_reply_list+265j
tmp = eax				; unsigned __int8 *
		mov	[ebp+usercount], 0
		jmp	loc_62BA2E0B
; ---------------------------------------------------------------------------

loc_62BA2F31:				; CODE XREF: _silc_client_command_reply_list+33Bj
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA2EC5
; ---------------------------------------------------------------------------

loc_62BA2F59:				; CODE XREF: _silc_client_command_reply_list+389j
channel_entry =	eax			; SilcChannelEntry
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
channel_entry =	ecx			; SilcChannelEntry
		test	al, al
		jnz	short loc_62BA2F95
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	edx, edx
		xor	eax, eax

loc_62BA2F7A:				; CODE XREF: _silc_client_command_reply_list+442j
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], fsm_context_0 ; cmd
		mov	[ebp+channel_entry], channel_entry
		call	_silc_client_command_callback
		mov	ecx, [ebp+channel_entry]
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA2F95:				; CODE XREF: _silc_client_command_reply_list+3F0j
channel_entry =	ecx			; SilcChannelEntry
		lea	esi, [ebp+arg2]
		mov	[esp+0Ch], esi
		lea	esi, [ebp+arg1_0]
		mov	[esp+8], esi
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+channel_entry], channel_entry
		call	_silc_status_get_args
		mov	eax, [ebp+arg2]
		mov	edx, [ebp+arg1_0]
		mov	ecx, [ebp+channel_entry]
		jmp	short loc_62BA2F7A
_silc_client_command_reply_list	endp

; Exported entry  73. silc_client_command_reply_topic

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_topic(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_topic
_silc_client_command_reply_topic proc near
					; DATA XREF: _silc_client_commands_unregister+3BEo
					; _silc_client_commands_register+2B3o ...

var_50		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -44h
arg2		= dword	ptr -24h
arg1_0		= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA3050
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA30F4

loc_62BA2FF3:				; CODE XREF: _silc_client_command_reply_topic+176j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA30CC
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA3016:				; CODE XREF: _silc_client_command_reply_topic+12Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA3046:				; CODE XREF: _silc_client_command_reply_topic+232j
channel	= esi				; SilcChannelEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA3050:				; CODE XREF: _silc_client_command_reply_topic+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+var_50], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_50]
		jbe	short loc_62BA3077
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+var_50]
		jbe	loc_62BA3164

loc_62BA3077:				; CODE XREF: _silc_client_command_reply_topic+A1j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA313C
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA309C:				; CODE XREF: _silc_client_command_reply_topic+19Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA30CC:				; CODE XREF: _silc_client_command_reply_topic+46j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA3016
; ---------------------------------------------------------------------------

loc_62BA30F4:				; CODE XREF: _silc_client_command_reply_topic+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_50], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotSetTopic ; "Cannot set topic: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_50]
		jmp	loc_62BA2FF3
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA313C:				; CODE XREF: _silc_client_command_reply_topic+CAj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA309C
; ---------------------------------------------------------------------------

loc_62BA3164:				; CODE XREF: _silc_client_command_reply_topic+B1j
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_50], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_50]
		jnz	short loc_62BA31F8
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA329C
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA31BA:				; CODE XREF: _silc_client_command_reply_topic+2FFj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		xor	esi, esi

out:					; CODE XREF: _silc_client_command_reply_topic+2D7j
					; _silc_client_command_reply_topic+335j
channel	= esi				; SilcChannelEntry ; channel_entry
		mov	[esp+8], channel
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA3046
; ---------------------------------------------------------------------------
		align 4

loc_62BA31F8:				; CODE XREF: _silc_client_command_reply_topic+1D3j
		mov	[esp+8], esi	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_50], edx
		call	_silc_client_get_channel_by_id
		mov	esi, eax
channel	= esi				; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+var_50]
		jz	loc_62BA32C4
channel	= eax				; SilcChannelEntry
		mov	channel, [channel+144h]
channel	= esi				; SilcChannelEntry
		mov	[esp], eax
		mov	[ebp+var_50], edx
		call	_silc_rwlock_wrlock
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	edx, [ebp+var_50]
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		test	eax, eax
		jz	short loc_62BA3273
		mov	edx, [channel+108h]
		mov	[esp], edx
		mov	[ebp+var_50], eax
		call	_silc_free
		mov	edx, [ebp+len]
		mov	[esp+4], edx
		mov	eax, [ebp+var_50]
		mov	[esp], eax
		call	_silc_memdup
		mov	[channel+108h],	eax

loc_62BA3273:				; CODE XREF: _silc_client_command_reply_topic+288j
		mov	eax, [channel+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	eax, [channel+108h]
		mov	[esp+8], eax
		mov	[esp+4], channel
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA329C:				; CODE XREF: _silc_client_command_reply_topic+1E8j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA31BA
; ---------------------------------------------------------------------------

loc_62BA32C4:				; CODE XREF: _silc_client_command_reply_topic+255j
channel	= eax				; SilcChannelEntry
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
channel	= esi				; SilcChannelEntry
		test	al, al
		jnz	short loc_62BA32FA
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	edx, edx
		xor	eax, eax

loc_62BA32E5:				; CODE XREF: _silc_client_command_reply_topic+35Dj
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA32FA:				; CODE XREF: _silc_client_command_reply_topic+317j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg2]
		mov	edx, [ebp+arg1_0]
		jmp	short loc_62BA32E5
_silc_client_command_reply_topic endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  57. silc_client_command_reply_join

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_join(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_join
_silc_client_command_reply_join	proc near ; DATA XREF: _silc_client_commands_unregister+93Eo
					; _silc_client_commands_register+655o ...

var_DC		= dword	ptr -0DCh
client_entry	= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= byte ptr -0C8h
var_B3		= byte ptr -0B3h
var_B2		= byte ptr -0B2h
var_B1		= byte ptr -0B1h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
list_count	= dword	ptr -0A8h
channel		= dword	ptr -0A4h
client		= dword	ptr -0A0h
conn		= dword	ptr -9Ch
id_0		= SilcID ptr -90h
id		= SilcID ptr -70h
keyp		= SilcBufferStruct ptr -50h
client_id_list	= SilcBufferStruct ptr -40h
htl		= SilcHashTableList ptr	-30h
arg2_0		= dword	ptr -24h
arg2		= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 10Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	eax, [ebx+4]
		mov	[ebp+conn], eax
		mov	edx, [eax+4Ch]
		mov	[ebp+client], edx
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA33C0
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA345C

loc_62BA335F:				; CODE XREF: _silc_client_command_reply_join+184j
		mov	[ebp+arg2], 0
		mov	[ebp+arg2_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA3434
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax

loc_62BA3380:				; CODE XREF: _silc_client_command_reply_join+134j
		mov	[esp+8], eax
		mov	eax, [ebp+arg2]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error

out:					; CODE XREF: _silc_client_command_reply_join+265j
					; _silc_client_command_reply_join+2A1j	...
mode = esi				; SilcUInt32
i = ebx					; int
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next
		xor	eax, eax

loc_62BA33B5:				; CODE XREF: _silc_client_command_reply_join+4F3j
		add	esp, 10Ch
		pop	i
		pop	mode
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA33C0:				; CODE XREF: _silc_client_command_reply_join+33j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_num
		cmp	eax, 8
		mov	edx, [ebp+client_entry]
		ja	loc_62BA34D0

loc_62BA33DD:				; CODE XREF: _silc_client_command_reply_join+1C1j
		mov	[ebp+arg2_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA34AC
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA33FE:				; CODE XREF: _silc_client_command_reply_join+1A9j
		mov	eax, [ebp+arg2]
		mov	[esp+8], eax
		mov	eax, [ebp+arg2_0]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 10Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA3434:				; CODE XREF: _silc_client_command_reply_join+52j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		lea	ecx, [ebp+arg2_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg2_0]
		jmp	loc_62BA3380
; ---------------------------------------------------------------------------
args = edx				; SilcArgumentPayload
		align 4

loc_62BA345C:				; CODE XREF: _silc_client_command_reply_join+39j
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	edi, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+client_entry], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotJoinChan ; "Cannot join channel: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+client_entry]
		jmp	loc_62BA335F
; ---------------------------------------------------------------------------
		align 4

loc_62BA34AC:				; CODE XREF: _silc_client_command_reply_join+D0j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA33FE
; ---------------------------------------------------------------------------
		align 10h

loc_62BA34D0:				; CODE XREF: _silc_client_command_reply_join+B7j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 11h
		mov	edx, [ebp+client_entry]
		ja	loc_62BA33DD
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		mov	state_context_0, eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	short loc_62BA358A
		mov	dword ptr [esp+10h], 0
		lea	ecx, [ebp+id]
		mov	[ebp+var_DC], ecx
		mov	[esp+0Ch], ecx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+client_entry]
		jnz	short loc_62BA35C6

loc_62BA354E:				; CODE XREF: _silc_client_command_reply_join+422j
		mov	[ebp+arg2_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA36B5
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA356F:				; CODE XREF: _silc_client_command_reply_join+3B2j
		mov	eax, [ebp+arg2]
		mov	[esp+8], eax
		mov	eax, [ebp+arg2_0]
arg1 = eax				; void *
		mov	[esp+4], arg1
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA358A:				; CODE XREF: _silc_client_command_reply_join+1EFj
					; _silc_client_command_reply_join+3DCj	...
		mov	[ebp+arg2], 0
		mov	[ebp+arg2_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA3818
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA35AB:				; CODE XREF: _silc_client_command_reply_join+515j
					; _silc_client_command_reply_join+B99j
		mov	eax, [ebp+arg2_0]
		mov	[esp+8], eax
		mov	eax, [ebp+arg2]
arg1 = eax				; void *
		mov	[esp+4], arg1
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA35C6:				; CODE XREF: _silc_client_command_reply_join+22Cj
		mov	[esp+8], esi	; channel
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+client_entry], edx
		call	_silc_client_get_channel
		mov	[ebp+channel], eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	loc_62BA3AC1
		mov	esi, eax
		add	esi, 114h
		mov	ecx, 16h
		mov	edi, [ebp+var_DC]
		repe cmpsb
		jnz	loc_62BA383A

loc_62BA3617:				; CODE XREF: _silc_client_command_reply_join+549j
					; _silc_client_command_reply_join+814j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0Bh
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		mov	[ebp+var_AC], eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	loc_62BA36D7
		mov	[esp], eax
		call	_silc_hmac_is_supported
		test	al, al
		mov	edx, [ebp+client_entry]
		jnz	short loc_62BA36D7
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA386E

loc_62BA3665:				; CODE XREF: _silc_client_command_reply_join+58Fj
		mov	[ebp+arg2_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA38B4
		mov	byte ptr [fsm_context_0+5Dh], 2Eh
		mov	byte ptr [fsm_context_0+5Ch], 2Eh

loc_62BA3686:				; CODE XREF: _silc_client_command_reply_join+5B1j
		mov	eax, [ebp+arg2]
		mov	[esp+8], eax
		mov	eax, [ebp+arg2_0]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	edx, [ebp+channel]
		mov	eax, [edx+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA36B5:				; CODE XREF: _silc_client_command_reply_join+241j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA356F
; ---------------------------------------------------------------------------

loc_62BA36D7:				; CODE XREF: _silc_client_command_reply_join+323j
					; _silc_client_command_reply_join+339j
		lea	ecx, [ebp+len]
		mov	[esp+8], ecx
		mov	dword ptr [esp+4], 0Ch
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	loc_62BA358A
		movzx	edi, byte ptr [eax]
		mov	cl, [eax+1]
		mov	[ebp+var_B1], cl
		mov	cl, [eax+2]
		mov	byte ptr [ebp+var_B0], cl
		movzx	esi, byte ptr [eax+3]
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0Dh
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		mov	ecx, eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	loc_62BA354E
		mov	eax, esi
		movzx	esi, al
		mov	[ebp+list_count], esi
		shl	edi, 18h
		or	[ebp+list_count], edi
		movzx	eax, [ebp+var_B1]
		shl	eax, 10h
		or	[ebp+list_count], eax
		movzx	eax, byte ptr [ebp+var_B0]
		shl	eax, 8
		or	[ebp+list_count], eax
		mov	[ebp+client_id_list.head], ecx
		mov	[ebp+client_id_list.data], ecx
		add	ecx, [ebp+len]
		mov	[ebp+client_id_list.end], ecx
		mov	[ebp+client_id_list.tail], ecx
		mov	al, [fsm_context_0+64h]
		test	al, 4
		jnz	loc_62BA38D6
		or	eax, 4
		mov	[fsm_context_0+64h], al
		mov	edx, [ebp+channel]
		mov	[fsm_context_0+60h], edx
		mov	ecx, [ebp+fsm]
		mov	al, [ecx+28h]
		mov	dl, al
		or	edx, 4
		mov	[ecx+28h], dl
		test	al, 4
		jnz	loc_62BA3B39

loc_62BA37BB:				; CODE XREF: _silc_client_command_reply_join+845j
		mov	[esp+14h], fsm_context_0 ; context
		mov	dword ptr [esp+10h], offset _silc_client_command_reply_join_resolved ; completion
		lea	eax, [ebp+client_id_list]
		mov	[esp+0Ch], eax	; client_id_list
		mov	eax, [ebp+list_count]
		mov	[esp+8], eax	; list_count
		mov	edx, [ebp+conn]
		mov	[esp+4], edx	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_clients_by_list
		mov	edx, [ebp+channel]
		mov	[edx+17Ch], ax
		mov	ecx, [ebp+fsm]
		mov	dl, [ecx+28h]
		mov	al, dl
		shr	al, 2
		and	edx, 0FFFFFFFBh
		mov	[ecx+28h], dl
		shl	eax, 1
		and	eax, 2
		jmp	loc_62BA33B5
; ---------------------------------------------------------------------------

loc_62BA3818:				; CODE XREF: _silc_client_command_reply_join+27Dj
					; _silc_client_command_reply_join+B8Bj
		lea	ecx, [ebp+arg2_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA35AB
; ---------------------------------------------------------------------------

loc_62BA383A:				; CODE XREF: _silc_client_command_reply_join+2F1j
		lea	ecx, [ebp+id]
		mov	[esp+0Ch], ecx	; new_id
		mov	eax, [ebp+channel]
		mov	[esp+8], eax	; channel
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_replace_channel_id
		mov	edx, [ebp+client_entry]
		jmp	loc_62BA3617
; ---------------------------------------------------------------------------

loc_62BA386E:				; CODE XREF: _silc_client_command_reply_join+33Fj
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	ecx, [ebp+var_AC]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], offset aCannotJoinCh_0 ; "Cannot join channel: Unsupported	HMAC `"...
		mov	dword ptr [esp+8], 3
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx
		mov	ecx, [ebp+client]
		mov	[esp], ecx
		call	dword ptr [eax]
		mov	edx, [ebp+client_entry]
		jmp	loc_62BA3665
; ---------------------------------------------------------------------------

loc_62BA38B4:				; CODE XREF: _silc_client_command_reply_join+358j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA3686
; ---------------------------------------------------------------------------

loc_62BA38D6:				; CODE XREF: _silc_client_command_reply_join+470j
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0Eh
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		mov	edi, eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	loc_62BA358A
		mov	ecx, [ebp+len]
		add	ecx, eax
		mov	[ebp+var_B0], ecx
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+144h]
		mov	[esp], eax
		mov	[ebp+client_entry], edx
		call	_silc_rwlock_wrlock
		cmp	[ebp+list_count], 0
		mov	edx, [ebp+client_entry]
		jz	loc_62BA3B76
		xor	eax, eax
i = eax					; int
		mov	[ebp+var_CC], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_D0], fsm_context_0
		mov	fsm_context_0, i
		jmp	short loc_62BA395D
; ---------------------------------------------------------------------------
i = ebx					; int
		align 10h

loc_62BA3950:				; CODE XREF: _silc_client_command_reply_join+66Bj
					; _silc_client_command_reply_join+70Fj
		inc	i
		cmp	i, [ebp+list_count]
		jnb	loc_62BA3B6A

loc_62BA395D:				; CODE XREF: _silc_client_command_reply_join+62Bj
args = edx				; SilcArgumentPayload
		mov	args, [ebp+client_id_list.data]
		movzx	eax, byte ptr [edx+2]
idp_len	= eax				; SilcUInt16
		shl	idp_len, 8
		movzx	ecx, byte ptr [edx+3]
		or	idp_len, ecx
		add	idp_len, 4
		movzx	esi, ax
		lea	eax, [ebp+id_0]
		mov	[esp+8], eax
		mov	[esp+4], esi
		mov	[esp], edx
		call	_silc_id_payload_parse_id
		test	al, al
		jz	short loc_62BA3950
		mov	dl, [edi]
		mov	[ebp+var_C8], dl
		mov	cl, [edi+1]
		mov	[ebp+var_B3], cl
		mov	al, [edi+2]
		mov	[ebp+var_B2], al
		mov	dl, [edi+3]
		mov	[ebp+var_B1], dl
		lea	ecx, [ebp+id_0]
		mov	[esp+8], ecx	; client_id
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_get_client_by_id
		mov	edx, eax
client_entry = edx			; SilcClientEntry
		test	eax, eax
		jz	short loc_62BA39E1
client_entry = eax			; SilcClientEntry
		test	byte ptr [client_entry+402h], 1
		jnz	short loc_62BA3A34

loc_62BA39E1:				; CODE XREF: _silc_client_command_reply_join+6B6j
					; _silc_client_command_reply_join+79Cj
		mov	[esp+8], edx	; client_entry
		mov	client_entry, [ebp+conn]
client_entry = edx			; SilcClientEntry
		mov	[esp+4], eax	; conn
		mov	client_entry, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_client
		mov	eax, [ebp+client_id_list.data]
		mov	edx, [ebp+client_id_list.tail]
		sub	edx, eax
		cmp	esi, edx
		ja	loc_62BA3ED7
		lea	esi, [eax+esi]
		mov	[ebp+client_id_list.data], esi
		test	eax, eax
		jz	loc_62BA3ED7
		mov	eax, [ebp+var_B0]
		sub	eax, edi
		cmp	eax, 3
		jbe	loc_62BA3EBE
		add	edi, 4
		jmp	loc_62BA3950
; ---------------------------------------------------------------------------

loc_62BA3A34:				; CODE XREF: _silc_client_command_reply_join+6BFj
client_entry = eax			; SilcClientEntry
		mov	client_entry, [client_entry+3D8h]
client_entry = edx			; SilcClientEntry
		mov	[esp], eax
		mov	[ebp+client_entry], client_entry
		call	_silc_rwlock_wrlock
		movzx	eax, [ebp+var_B1]
		mov	cl, [ebp+var_C8]
		shl	ecx, 18h
		or	eax, ecx
		movzx	ecx, [ebp+var_B3]
		shl	ecx, 10h
		or	eax, ecx
		movzx	ecx, [ebp+var_B2]
		shl	ecx, 8
		or	eax, ecx
		mov	[esp+10h], eax	; cumode
		mov	edx, [ebp+client_entry]
		mov	[esp+0Ch], edx	; client_entry
client_entry = edx			; SilcClientEntry
		mov	ecx, [ebp+channel]
		mov	[esp+8], ecx	; channel
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_add_to_channel
		mov	edx, [ebp+client_entry]
		mov	eax, [edx+3D8h]
client_entry = edx			; SilcClientEntry
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	edx, [ebp+client_entry]
		jmp	loc_62BA39E1
; ---------------------------------------------------------------------------

loc_62BA3AC1:				; CODE XREF: _silc_client_command_reply_join+2D6j
fsm_context_0 =	ebx			; void *
		lea	ecx, [ebp+id]
		mov	[esp+10h], ecx	; channel_id
		mov	dword ptr [esp+0Ch], 0 ; mode
		mov	[esp+8], esi	; channel_name
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		mov	[ebp+client_entry], edx
		call	_silc_client_add_channel
		mov	[ebp+channel], eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	loc_62BA3E98
		mov	eax, [ebp+channel]
		mov	[esp+8], eax	; channel_entry
		mov	ecx, [ebp+conn]
		mov	[esp+4], ecx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+client_entry], edx
		call	_silc_client_ref_channel
		mov	edx, [ebp+client_entry]
		jmp	loc_62BA3617
; ---------------------------------------------------------------------------

loc_62BA3B39:				; CODE XREF: _silc_client_command_reply_join+495j
		mov	dword ptr [esp+8], 4B9h
		mov	dword ptr [esp+4], offset aCommand_reply_ ; "command_reply.c"
		mov	dword ptr [esp], offset	aSilc_verifyS_6	; "SILC_VERIFY %s:%d"
		call	_silc_format
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	_silc_log_output
		jmp	loc_62BA37BB
; ---------------------------------------------------------------------------

loc_62BA3B6A:				; CODE XREF: _silc_client_command_reply_join+637j
i = ebx					; int
		mov	edx, [ebp+var_CC]
args = edx				; SilcArgumentPayload
		mov	i, [ebp+var_D0]

loc_62BA3B76:				; CODE XREF: _silc_client_command_reply_join+615j
fsm_context_0 =	ebx			; void *
		lea	ecx, [ebp+len]
		mov	[esp+8], ecx
		mov	dword ptr [esp+4], 5
		mov	[esp], args
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		mov	ecx, eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	short loc_62BA3BA9
		cmp	[ebp+len], 4
		jz	loc_62BA3E75

loc_62BA3BA9:				; CODE XREF: _silc_client_command_reply_join+87Dj
		xor	esi, esi

loc_62BA3BAB:				; CODE XREF: _silc_client_command_reply_join+B73j
mode = esi				; SilcUInt32
		mov	eax, [ebp+channel]
		mov	[eax+12Ch], mode
		lea	ecx, [ebp+len]
		mov	[esp+8], ecx
		mov	dword ptr [esp+4], 7
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	short loc_62BA3BF1
		mov	ecx, [ebp+channel]
		cmp	dword ptr [ecx+158h], 0
		jz	loc_62BA3EF0

loc_62BA3BF1:				; CODE XREF: _silc_client_command_reply_join+8BCj
					; _silc_client_command_reply_join+C08j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0Ah
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		mov	[ebp+list_count], eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	short loc_62BA3C67
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+108h]
		mov	[esp], eax
		call	_silc_free
		xor	eax, eax
		or	ecx, 0FFFFFFFFh
		mov	edi, [ebp+list_count]
topic =	edi				; char *
		repne scasb
		not	ecx
		dec	ecx
		mov	[esp+4], ecx
		mov	eax, [ebp+list_count]
		mov	[esp], eax
		call	_silc_memdup
		mov	ecx, [ebp+channel]
		mov	[ecx+108h], eax
		mov	edx, [ebp+client_entry]

loc_62BA3C67:				; CODE XREF: _silc_client_command_reply_join+8FDj
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0Fh
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		mov	edi, eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	short loc_62BA3CE2
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+10Ch]
		test	eax, eax
		jz	short loc_62BA3CAE
		mov	[esp], eax
		call	_silc_pkcs_public_key_free
		mov	edx, [ebp+client_entry]

loc_62BA3CAE:				; CODE XREF: _silc_client_command_reply_join+97Ej
		mov	eax, [ebp+channel]
		mov	dword ptr [eax+10Ch], 0
		add	eax, 10Ch
		mov	[esp+8], eax
		mov	eax, [ebp+len]
		mov	[esp+4], eax
		mov	[esp], edi
		mov	[ebp+client_entry], edx
		call	_silc_public_key_payload_decode
		mov	edx, [ebp+client_entry]

loc_62BA3CE2:				; CODE XREF: _silc_client_command_reply_join+96Ej
		lea	ecx, [ebp+len]
		mov	[esp+8], ecx
		mov	dword ptr [esp+4], 11h
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+client_entry], args
		call	_silc_argument_get_arg_type
		mov	ecx, eax
		test	eax, eax
		mov	edx, [ebp+client_entry]
		jz	short loc_62BA3D3B
		cmp	[ebp+len], 4
		jnz	short loc_62BA3D3B
		movzx	edi, byte ptr [eax+3]
		movzx	eax, byte ptr [eax]
		shl	eax, 18h
		or	edi, eax
		movzx	eax, byte ptr [ecx+1]
		shl	eax, 10h
		or	edi, eax
		movzx	eax, byte ptr [ecx+2]
		shl	eax, 8
		or	edi, eax
		mov	eax, [ebp+channel]
		mov	[eax+130h], edi

loc_62BA3D3B:				; CODE XREF: _silc_client_command_reply_join+9E9j
					; _silc_client_command_reply_join+9EFj
		mov	ecx, [ebp+channel]
		test	byte ptr [ecx+12Ch], 20h
		jnz	short loc_62BA3D54
		mov	dword ptr [ecx+130h], 0

loc_62BA3D54:				; CODE XREF: _silc_client_command_reply_join+A28j
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 10h
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		test	eax, eax
		jz	short loc_62BA3D90
		mov	dword ptr [esp+0Ch], 0 ; remove_all
		mov	edx, [ebp+len]
		mov	[esp+8], edx	; chpk_list_len
		mov	[esp+4], eax	; chpk_list
		mov	edx, [ebp+channel]
		mov	[esp], edx	; channel
		call	_silc_client_channel_save_public_keys

loc_62BA3D90:				; CODE XREF: _silc_client_command_reply_join+A4Dj
		mov	eax, [ebp+channel]
		mov	ecx, [ebp+conn]
		mov	[ecx+30h], eax
		mov	eax, [eax+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+158h]
		xor	edx, edx
cipher = edx				; const	char *
		test	eax, eax
		jz	short loc_62BA3DC9
		mov	[esp], eax
		call	_silc_cipher_get_name
		mov	edx, eax

loc_62BA3DC9:				; CODE XREF: _silc_client_command_reply_join+A9Dj
cipher = edx				; const	char *
		lea	edi, [ebp+htl]
		mov	[esp+4], edi
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+134h]
		mov	[esp], eax
		mov	[ebp+client_entry], cipher
		call	_silc_hash_table_list
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+130h]
		mov	[esp+28h], eax
		mov	eax, [ecx+110h]
		mov	[esp+24h], eax
		mov	eax, [ecx+10Ch]
		mov	[esp+20h], eax
		mov	eax, [ebp+var_AC]
		mov	[esp+1Ch], eax
		mov	edx, [ebp+client_entry]
		mov	[esp+18h], edx
cipher = edx				; const	char *
		mov	cipher,	[ebp+list_count]
		mov	[esp+14h], edx
		mov	[esp+10h], edi
		mov	[esp+0Ch], mode
		mov	[esp+8], ecx
		mov	eax, [ecx]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	[esp], edi
		call	_silc_hash_table_list_reset
		mov	ecx, [ebp+channel]
		mov	[esp+8], ecx	; channel_entry
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_unref_channel
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA3E75:				; CODE XREF: _silc_client_command_reply_join+883j
		movzx	esi, byte ptr [eax+3]
mode = esi				; SilcUInt32
		movzx	eax, byte ptr [eax]
		shl	eax, 18h
		or	mode, eax
		movzx	eax, byte ptr [ecx+1]
		shl	eax, 10h
		or	mode, eax
		movzx	eax, byte ptr [ecx+2]
		shl	eax, 8
		or	mode, eax
		jmp	loc_62BA3BAB
; ---------------------------------------------------------------------------

loc_62BA3E98:				; CODE XREF: _silc_client_command_reply_join+7E0j
		mov	[ebp+arg2], 0
		mov	[ebp+arg2_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA3818
		mov	byte ptr [fsm_context_0+5Dh], 2Ch
		mov	byte ptr [fsm_context_0+5Ch], 2Ch
		jmp	loc_62BA35AB
; ---------------------------------------------------------------------------

loc_62BA3EBE:				; CODE XREF: _silc_client_command_reply_join+706j
i = ebx					; int
		mov	edx, [ebp+channel]
		mov	eax, [edx+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA3ED7:				; CODE XREF: _silc_client_command_reply_join+6E7j
					; _silc_client_command_reply_join+6F5j
		mov	ecx, [ebp+channel]
		mov	eax, [ecx+144h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA3EF0:				; CODE XREF: _silc_client_command_reply_join+8CBj
fsm_context_0 =	ebx			; void *
mode = esi				; SilcUInt32
		mov	[ebp+keyp.head], eax
		mov	[ebp+keyp.data], eax
		add	eax, [ebp+len]
		mov	[ebp+keyp.end],	eax
		mov	[ebp+keyp.tail], eax
		mov	[esp+0Ch], ecx	; channel
		lea	eax, [ebp+keyp]
		mov	[esp+8], eax	; key_payload
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_save_channel_key
		mov	edx, [ebp+client_entry]
		jmp	loc_62BA3BF1
_silc_client_command_reply_join	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: static bp-based frame

; void __cdecl silc_client_command_reply_join_resolved(SilcClient client, SilcClientConnection conn, SilcStatus	status,	SilcDList clients, void	*context)
_silc_client_command_reply_join_resolved proc near
					; DATA XREF: _silc_client_command_reply_join+49Fo

client		= dword	ptr  8
conn		= dword	ptr  0Ch
status		= byte ptr  10h
clients		= dword	ptr  14h
context		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+context]
		mov	eax, [ebx+60h]
channel	= eax				; SilcChannelEntry
		mov	word ptr [channel+17Ch], 0
		mov	[esp+8], channel ; channel_entry
		mov	channel, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		mov	al, [ebx+30h]
		mov	dl, al
		and	edx, 0FFFFFFFBh
		mov	[ebx+30h], dl
		test	al, 4
		jz	short loc_62BA3F74
context_0 = ebx				; void *
		add	esp, 14h
		pop	context_0
		leave
		retn
; ---------------------------------------------------------------------------
context_0 = ebx				; void *
		align 4

loc_62BA3F74:				; CODE XREF: _silc_client_command_reply_join_resolved+39j
		add	context_0, 8
		mov	[ebp+client], ebx
		add	esp, 14h
		pop	ebx
		leave
		jmp	_silc_fsm_continue_sync
_silc_client_command_reply_join_resolved endp

; Exported entry  65. silc_client_command_reply_ping

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_ping(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_ping
_silc_client_command_reply_ping	proc near ; DATA XREF: _silc_client_commands_unregister+7DEo
					; _silc_client_commands_register+55Fo ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	edi, [conn+4Ch]
client = edi				; SilcClient
		call	_silc_time
		mov	ecx, [ebx+60h]
		test	byte ptr [ebx+64h], 2
		jz	short loc_62BA3FFC
fsm_context_0 =	ebx			; void *
		mov	[ebp+var_20], ecx
		mov	[ebp+var_1C], 0
		sub	eax, [ebp+var_20]
		sbb	edx, [ebp+var_1C]
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	ecx, [ecx]
		mov	[ebp+var_20], ecx
		mov	ecx, eax
		xor	ecx, 1
		or	ecx, edx
		jz	short loc_62BA4024
		mov	ecx, offset aS_1 ; "s"

loc_62BA3FD3:				; CODE XREF: _silc_client_command_reply_ping+A5j
		mov	[esp+18h], ecx
		mov	[esp+14h], eax
		mov	eax, [conn+8]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aPingReplyFromS ; "Ping reply from %s: %d second%s"
		mov	dword ptr [esp+8], 0
		mov	[esp+4], conn
		mov	[esp], client
		call	[ebp+var_20]

loc_62BA3FFC:				; CODE XREF: _silc_client_command_reply_ping+1Ej
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 3Ch
		pop	fsm_context_0
		pop	conn
		pop	client
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
client = edi				; SilcClient
		align 4

loc_62BA4024:				; CODE XREF: _silc_client_command_reply_ping+48j
		mov	ecx, offset byte_62BA91BD
		jmp	short loc_62BA3FD3
_silc_client_command_reply_ping	endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  71. silc_client_command_reply_stats

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_stats(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_stats
_silc_client_command_reply_stats proc near
					; DATA XREF: _silc_client_commands_unregister+72Eo
					; _silc_client_commands_register+4E4o ...

var_AC		= dword	ptr -0ACh
var_A0		= byte ptr -0A0h
var_9C		= dword	ptr -9Ch
stats		= SilcClientStats ptr -90h
id		= SilcID ptr -54h
b		= SilcBufferStruct ptr -34h
arg2		= dword	ptr -24h
arg1		= dword	ptr -20h
buf_len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 12Ch
		mov	ebx, [ebp+fsm_context]
		mov	edi, [ebp+state_context]
		mov	[esp], edi
		call	_silc_command_get_args
		mov	esi, eax
args = esi				; SilcArgumentPayload
		mov	[ebp+buf_len], 0
		mov	dl, [ebx+5Dh]
		test	dl, dl
		jz	short loc_62BA40C0
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA4168

loc_62BA4060:				; CODE XREF: _silc_client_command_reply_stats+182j
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA4140
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	edx, edx

loc_62BA4083:				; CODE XREF: _silc_client_command_reply_stats+137j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA40B3:				; CODE XREF: _silc_client_command_reply_stats+22Fj
		xor	eax, eax
		add	esp, 12Ch
		pop	fsm_context_0
		pop	args
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA40C0:				; CODE XREF: _silc_client_command_reply_stats+28j
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
args = esi				; SilcArgumentPayload
		mov	[esp], eax
		mov	[ebp+var_A0], dl
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		jbe	short loc_62BA40EA
		mov	[esp], args
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	dl, [ebp+var_A0]
		jbe	loc_62BA41DC

loc_62BA40EA:				; CODE XREF: _silc_client_command_reply_stats+A5j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA41B4
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA410F:				; CODE XREF: _silc_client_command_reply_stats+1ABj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 12Ch
		pop	fsm_context_0
		pop	args
		pop	state_context_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= edi			; void *
args = esi				; SilcArgumentPayload
		align 10h

loc_62BA4140:				; CODE XREF: _silc_client_command_reply_stats+47j
		lea	edx, [ebp+arg2]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg1]
		mov	[esp+8], edx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA4083
; ---------------------------------------------------------------------------

loc_62BA4168:				; CODE XREF: _silc_client_command_reply_stats+2Ej
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	eax, [eax]
		mov	[ebp+var_9C], eax
		movzx	edx, dl
		mov	[esp], edx
		call	_silc_get_status_message
		mov	edx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotGetStats ; "Cannot get stats: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], edx
		mov	eax, [edx+4Ch]
		mov	[esp], eax
		call	[ebp+var_9C]
		jmp	loc_62BA4060
; ---------------------------------------------------------------------------
		align 4

loc_62BA41B4:				; CODE XREF: _silc_client_command_reply_stats+D1j
		lea	edx, [ebp+arg1]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg2]
		mov	[esp+8], edx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA410F
; ---------------------------------------------------------------------------

loc_62BA41DC:				; CODE XREF: _silc_client_command_reply_stats+B8j
		mov	dword ptr [esp+10h], 0
		lea	eax, [ebp+id]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], args
		mov	[ebp+var_A0], dl
		call	_silc_argument_get_decoded
		test	al, al
		mov	dl, [ebp+var_A0]
		jnz	short loc_62BA4260
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA43BC
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA4238:				; CODE XREF: _silc_client_command_reply_stats+3B3j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_stats+38Bj
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA40B3
; ---------------------------------------------------------------------------

loc_62BA4260:				; CODE XREF: _silc_client_command_reply_stats+1E5j
state_context_0	= edi			; void *
		lea	eax, [ebp+stats]
		mov	[ebp+var_AC], eax
		mov	ecx, 3Ch
		mov	state_context_0, eax
		mov	al, dl
		rep stosb
		lea	eax, [ebp+buf_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	[esp], args
		call	_silc_argument_get_arg_type
		test	eax, eax
buf = eax				; unsigned __int8 *
		jz	loc_62BA43A5
		mov	[ebp+b.head], buf
		mov	[ebp+b.data], buf
		add	buf, [ebp+buf_len]
		mov	[ebp+b.end], eax
		mov	[ebp+b.tail], eax
		mov	dword ptr [esp+7Ch], 1Dh
		lea	eax, [ebp+stats.router_ops]
		mov	[esp+78h], eax
		mov	dword ptr [esp+74h], 5
		lea	eax, [ebp+stats.server_ops]
		mov	[esp+70h], eax
		mov	dword ptr [esp+6Ch], 5
		lea	eax, [ebp+stats.routers]
		mov	[esp+68h], eax
		mov	dword ptr [esp+64h], 5
		lea	eax, [ebp+stats.servers]
		mov	[esp+60h], eax
		mov	dword ptr [esp+5Ch], 5
		lea	eax, [ebp+stats.channels]
		mov	[esp+58h], eax
		mov	dword ptr [esp+54h], 5
		lea	eax, [ebp+stats.clients]
		mov	[esp+50h], eax
		mov	dword ptr [esp+4Ch], 5
		lea	eax, [ebp+stats.cell_servers]
		mov	[esp+48h], eax
		mov	dword ptr [esp+44h], 5
		lea	eax, [ebp+stats.cell_channels]
		mov	[esp+40h], eax
		mov	dword ptr [esp+3Ch], 5
		lea	eax, [ebp+stats.cell_clients]
		mov	[esp+38h], eax
		mov	dword ptr [esp+34h], 5
		lea	eax, [ebp+stats.my_router_ops]
		mov	[esp+30h], eax
		mov	dword ptr [esp+2Ch], 5
		lea	eax, [ebp+stats.my_server_ops]
		mov	[esp+28h], eax
		mov	dword ptr [esp+24h], 5
		lea	eax, [ebp+stats.my_channels]
		mov	[esp+20h], eax
		mov	dword ptr [esp+1Ch], 5
		lea	eax, [ebp+stats.my_clients]
		mov	[esp+18h], eax
		mov	dword ptr [esp+14h], 5
		lea	eax, [ebp+stats.uptime]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 5
		lea	eax, [ebp+stats]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 5
		lea	eax, [ebp+b]
		mov	[esp], eax
		call	_silc_buffer_unformat

loc_62BA43A5:				; CODE XREF: _silc_client_command_reply_stats+264j
buf = eax				; unsigned __int8 *
		lea	buf, [ebp+stats]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA43BC:				; CODE XREF: _silc_client_command_reply_stats+1FAj
state_context_0	= edi			; void *
		lea	edx, [ebp+arg2]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg1]
		mov	[esp+8], edx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA4238
_silc_client_command_reply_stats endp

; Exported entry  55. silc_client_command_reply_info

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_info(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_info
_silc_client_command_reply_info	proc near ; DATA XREF: _silc_client_commands_unregister+67Eo
					; _silc_client_commands_register+469o ...

server_name	= dword	ptr -58h
server_entry	= dword	ptr -54h
server_info	= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -40h
arg1_0		= dword	ptr -20h
arg2		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA4474
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA4508

loc_62BA4417:				; CODE XREF: _silc_client_command_reply_info+166j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA44E0
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA443A:				; CODE XREF: _silc_client_command_reply_info+11Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA446A:				; CODE XREF: _silc_client_command_reply_info+221j
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	esi
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA4474:				; CODE XREF: _silc_client_command_reply_info+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+server_entry], args
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+server_entry]
		ja	loc_62BA4578

loc_62BA448B:				; CODE XREF: _silc_client_command_reply_info+1A2j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA4550
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA44B0:				; CODE XREF: _silc_client_command_reply_info+18Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 10h

loc_62BA44E0:				; CODE XREF: _silc_client_command_reply_info+46j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA443A
; ---------------------------------------------------------------------------

loc_62BA4508:				; CODE XREF: _silc_client_command_reply_info+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+server_entry], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotGetInfoS ; "Cannot get info:	%s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+server_entry]
		jmp	loc_62BA4417
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 10h

loc_62BA4550:				; CODE XREF: _silc_client_command_reply_info+BAj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA44B0
; ---------------------------------------------------------------------------

loc_62BA4578:				; CODE XREF: _silc_client_command_reply_info+A1j
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 4
		mov	edx, [ebp+server_entry]
		ja	loc_62BA448B
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+server_entry], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+server_entry]
		jnz	short loc_62BA460A

loc_62BA45BD:				; CODE XREF: _silc_client_command_reply_info+275j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA46B9

loc_62BA45D6:				; CODE XREF: _silc_client_command_reply_info+310j
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA45E2:				; CODE XREF: _silc_client_command_reply_info+2F8j
					; _silc_client_command_reply_info+339j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_info+2D0j
					; _silc_client_command_reply_info+360j
server = eax				; SilcServerEntry
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	server,	[ebp+fsm]
server = edx				; SilcServerEntry
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA446A
; ---------------------------------------------------------------------------

loc_62BA460A:				; CODE XREF: _silc_client_command_reply_info+1D7j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+server_entry], args
		call	_silc_argument_get_arg_type
		test	eax, eax
		mov	edx, [ebp+server_entry]
		jz	loc_62BA46E1
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 4
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+server_entry], args
		mov	[ebp+server_name], eax
		call	_silc_argument_get_arg_type
		mov	[ebp+server_info], eax
		test	eax, eax
		mov	edx, [ebp+server_entry]
		mov	ecx, [ebp+server_name]
		jz	loc_62BA45BD
		mov	[esp+8], esi	; server_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+server_name], ecx
		call	_silc_client_get_server_by_id
		mov	edx, eax
server = edx				; SilcServerEntry
		test	eax, eax
		mov	ecx, [ebp+server_name]
		jz	loc_62BA4722

loc_62BA4682:				; CODE XREF: _silc_client_command_reply_info+37Fj
server = eax				; SilcServerEntry
		mov	server,	[edx+4]
server = edx				; SilcServerEntry
		mov	[esp+0Ch], eax
		mov	eax, [server]
		mov	[esp+8], eax
		mov	[esp+4], server
		mov	[esp], fsm_context_0 ; cmd
		mov	[ebp+server_entry], server
		call	_silc_client_command_callback
		mov	edx, [ebp+server_entry]
		mov	[esp+8], edx	; server_entry
server = edx				; SilcServerEntry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_server
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA46B9:				; CODE XREF: _silc_client_command_reply_info+1ECj
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA45E2
; ---------------------------------------------------------------------------

loc_62BA46E1:				; CODE XREF: _silc_client_command_reply_info+246j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jz	loc_62BA45D6
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA45E2
; ---------------------------------------------------------------------------

loc_62BA4722:				; CODE XREF: _silc_client_command_reply_info+298j
server = eax				; SilcServerEntry ; server_id
		mov	[esp+10h], esi
		mov	server,	[ebp+server_info]
server = edx				; SilcServerEntry
		mov	[esp+0Ch], eax	; server_info
		mov	[esp+8], ecx	; server_name
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_add_server
		mov	edx, eax
server = edx				; SilcServerEntry
		test	eax, eax
		jz	out
server = eax				; SilcServerEntry
		mov	[esp+8], server	; server_entry
		mov	[esp+4], conn	; conn
		mov	server,	[ebp+client]
server = edx				; SilcServerEntry
		mov	[esp], eax	; client
		mov	[ebp+server_entry], server
		call	_silc_client_ref_server
		mov	edx, [ebp+server_entry]
		jmp	loc_62BA4682
_silc_client_command_reply_info	endp

; Exported entry  63. silc_client_command_reply_nick

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_nick(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_nick
_silc_client_command_reply_nick	proc near ; DATA XREF: _silc_client_commands_unregister+25Eo
					; _silc_client_commands_register+1DAo ...

var_8C		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
nick		= dword	ptr -78h
idp		= dword	ptr -74h
client		= dword	ptr -70h
conn		= dword	ptr -6Ch
id		= SilcID ptr -66h
old_client_id	= SilcClientID ptr -45h
arg1_0		= dword	ptr -28h
arg2		= dword	ptr -24h
idp_len		= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ACh
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	eax, [ebx+4]
		mov	[ebp+conn], eax
		mov	edx, [eax+4Ch]
		mov	[ebp+client], edx
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA4804
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA48A8

loc_62BA47A1:				; CODE XREF: _silc_client_command_reply_nick+182j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA4880
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA47C4:				; CODE XREF: _silc_client_command_reply_nick+13Bj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next

loc_62BA47F4:				; CODE XREF: _silc_client_command_reply_nick+243j
		xor	eax, eax
		add	esp, 0ACh
		pop	fsm_context_0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		align 4

loc_62BA4804:				; CODE XREF: _silc_client_command_reply_nick+2Dj
		mov	[esp], args
		mov	[ebp+var_7C], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_7C]
		jbe	short loc_62BA482B
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 3
		mov	edx, [ebp+var_7C]
		jbe	loc_62BA4918

loc_62BA482B:				; CODE XREF: _silc_client_command_reply_nick+ADj
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA48F0
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA4850:				; CODE XREF: _silc_client_command_reply_nick+1ABj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 0ACh
		pop	fsm_context_0
		pop	state_context_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA4880:				; CODE XREF: _silc_client_command_reply_nick+4Cj
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
args = edx				; SilcArgumentPayload
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	loc_62BA47C4
; ---------------------------------------------------------------------------

loc_62BA48A8:				; CODE XREF: _silc_client_command_reply_nick+33j
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	edi, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_7C], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aCannotSetNickn ; "Cannot set nickname: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_7C]
		jmp	loc_62BA47A1
; ---------------------------------------------------------------------------
		align 10h

loc_62BA48F0:				; CODE XREF: _silc_client_command_reply_nick+D6j
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA4850
; ---------------------------------------------------------------------------

loc_62BA4918:				; CODE XREF: _silc_client_command_reply_nick+BDj
		lea	eax, [ebp+idp_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_7C], args
		call	_silc_argument_get_arg_type
		mov	[ebp+idp], eax
		test	eax, eax
		mov	edx, [ebp+var_7C]
		jz	short loc_62BA49B0
		lea	ecx, [ebp+id]
		mov	[esp+8], ecx
		mov	eax, [ebp+idp_len]
		mov	[esp+4], eax
		mov	eax, [ebp+idp]
		mov	[esp], eax
		mov	[ebp+var_7C], edx
		call	_silc_id_payload_parse_id
		test	al, al
		mov	edx, [ebp+var_7C]
		jnz	loc_62BA49EA
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA4AD0

loc_62BA497C:				; CODE XREF: _silc_client_command_reply_nick+25Bj
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA4988:				; CODE XREF: _silc_client_command_reply_nick+280j
					; _silc_client_command_reply_nick+38Bj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_nick+363j
					; _silc_client_command_reply_nick+3C2j	...
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA47F4
; ---------------------------------------------------------------------------

loc_62BA49B0:				; CODE XREF: _silc_client_command_reply_nick+1D2j
state_context_0	= esi			; void *
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jz	short loc_62BA497C
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1_0]
		jmp	short loc_62BA4988
; ---------------------------------------------------------------------------

loc_62BA49EA:				; CODE XREF: _silc_client_command_reply_nick+1F5j
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_7C], args
		call	_silc_argument_get_arg_type
		mov	[ebp+nick], eax
		test	eax, eax
		mov	edx, [ebp+var_7C]
		jz	loc_62BA4AF8
		mov	ecx, [ebp+conn]
		mov	eax, [ecx]
		mov	eax, [eax+3D8h]
		mov	[esp], eax
		mov	[ebp+var_7C], edx
		call	_silc_rwlock_wrlock
		mov	eax, [ebp+conn]
		mov	state_context_0, [eax+4]
		lea	ecx, [ebp+old_client_id]
		mov	[ebp+var_8C], ecx
		mov	ecx, 1Dh
		mov	edi, [ebp+var_8C]
		rep movsb
		mov	eax, [ebp+idp_len]
		mov	[esp+18h], eax	; idp_len
		mov	eax, [ebp+idp]
		mov	[esp+14h], eax	; idp
		lea	ecx, [ebp+id]
		mov	[esp+10h], ecx	; new_id
		mov	eax, [ebp+nick]
		mov	[esp+0Ch], eax	; new_nick
		mov	ecx, [ebp+conn]
		mov	eax, [ecx]
		mov	[esp+8], eax	; client_entry
		mov	[esp+4], ecx	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_change_nickname
		test	al, al
		mov	edx, [ebp+var_7C]
		jnz	loc_62BA4B2F
		mov	[ebp+arg2], 0
		mov	[ebp+arg1_0], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA4B63
		mov	byte ptr [fsm_context_0+5Dh], 2Bh
		mov	byte ptr [fsm_context_0+5Ch], 2Bh
		xor	eax, eax
		xor	edx, edx

loc_62BA4AA8:				; CODE XREF: _silc_client_command_reply_nick+41Ej
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	edx, [ebp+conn]
		mov	eax, [edx]
		mov	eax, [eax+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA4AD0:				; CODE XREF: _silc_client_command_reply_nick+20Ej
state_context_0	= esi			; void *
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA4988
; ---------------------------------------------------------------------------

loc_62BA4AF8:				; CODE XREF: _silc_client_command_reply_nick+2A4j
		mov	[ebp+arg1_0], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	short loc_62BA4B8B
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax

loc_62BA4B17:				; CODE XREF: _silc_client_command_reply_nick+443j
		mov	[esp+8], eax
		mov	eax, [ebp+arg1_0]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA4B2F:				; CODE XREF: _silc_client_command_reply_nick+315j
		mov	ecx, [ebp+conn]
		mov	eax, [ecx]
		mov	eax, [eax+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		mov	edx, [ebp+conn]
		mov	eax, [edx]
		lea	ecx, [ebp+old_client_id]
		mov	[esp+0Ch], ecx
		mov	[esp+8], eax
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA4B63:				; CODE XREF: _silc_client_command_reply_nick+32Ej
		lea	ecx, [ebp+arg1_0]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1_0]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA4AA8
; ---------------------------------------------------------------------------

loc_62BA4B8B:				; CODE XREF: _silc_client_command_reply_nick+3A3j
state_context_0	= esi			; void *
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1_0]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	eax, [ebp+arg2]
		jmp	loc_62BA4B17
_silc_client_command_reply_nick	endp

; Exported entry  54. silc_client_command_reply_identify

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_identify(SilcFSMObject *fsm, void *fsm_context,	void *state_context)
		public _silc_client_command_reply_identify
_silc_client_command_reply_identify proc near
					; DATA XREF: _silc_client_commands_unregister+1AEo
					; _silc_client_commands_register+15Fo ...

var_58		= dword	ptr -58h
name		= dword	ptr -54h
info		= dword	ptr -50h
client		= dword	ptr -4Ch
id		= SilcID ptr -44h
arg1		= dword	ptr -24h
arg2		= dword	ptr -20h
len		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	edi, [ebx+4]
conn = edi				; SilcClientConnection
		mov	eax, [conn+4Ch]
		mov	[ebp+client], eax
		mov	[esp], esi
		call	_silc_command_get_args
		mov	edx, eax
args = edx				; SilcArgumentPayload
		mov	al, [ebx+5Dh]
		test	al, al
		jz	short loc_62BA4C40
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA4CE4

loc_62BA4BE3:				; CODE XREF: _silc_client_command_reply_identify+176j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA4CBC
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	args, args

loc_62BA4C06:				; CODE XREF: _silc_client_command_reply_identify+12Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next

loc_62BA4C36:				; CODE XREF: _silc_client_command_reply_identify+21Dj
channel_entry =	esi			; SilcChannelEntry
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	channel_entry
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA4C40:				; CODE XREF: _silc_client_command_reply_identify+27j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		mov	[esp], args
		mov	[ebp+var_58], args
		call	_silc_argument_get_arg_num
		cmp	eax, 1
		mov	edx, [ebp+var_58]
		jbe	short loc_62BA4C67
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_num
		cmp	eax, 4
		mov	edx, [ebp+var_58]
		jbe	loc_62BA4D54

loc_62BA4C67:				; CODE XREF: _silc_client_command_reply_identify+A1j
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA4D2C
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA4C8C:				; CODE XREF: _silc_client_command_reply_identify+19Fj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 6Ch
		pop	fsm_context_0
		pop	state_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
conn = edi				; SilcClientConnection
args = edx				; SilcArgumentPayload
		align 4

loc_62BA4CBC:				; CODE XREF: _silc_client_command_reply_identify+46j
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], args
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA4C06
; ---------------------------------------------------------------------------

loc_62BA4CE4:				; CODE XREF: _silc_client_command_reply_identify+2Dj
args = edx				; SilcArgumentPayload
		mov	ecx, [fsm_context_0+4]
		mov	ecx, [ecx+4Ch]
		mov	ecx, [ecx+18h]
		mov	ecx, [ecx+48h]
		mov	conn, [ecx]
		movzx	eax, al
		mov	[esp], eax
		mov	[ebp+var_58], args
		call	_silc_get_status_message
		mov	ecx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aIdentifyS ; "IDENTIFY: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], ecx
		mov	eax, [ecx+4Ch]
		mov	[esp], eax
		call	edi
		mov	edx, [ebp+var_58]
		jmp	loc_62BA4BE3
; ---------------------------------------------------------------------------
conn = edi				; SilcClientConnection
		align 4

loc_62BA4D2C:				; CODE XREF: _silc_client_command_reply_identify+CAj
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA4C8C
; ---------------------------------------------------------------------------

loc_62BA4D54:				; CODE XREF: _silc_client_command_reply_identify+B1j
		mov	dword ptr [esp+10h], 0
		lea	eax, [ebp+id]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_58], args
		call	_silc_argument_get_decoded
		test	al, al
		mov	edx, [ebp+var_58]
		jnz	short loc_62BA4DD4
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA4EA6
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA4DAA:				; CODE XREF: _silc_client_command_reply_identify+319j
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_identify+278j
					; _silc_client_command_reply_identify+2F1j ...
channel_entry =	esi			; SilcChannelEntry
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		jmp	loc_62BA4C36
; ---------------------------------------------------------------------------
state_context_0	= esi			; void *
		align 4

loc_62BA4DD4:				; CODE XREF: _silc_client_command_reply_identify+1D3j
		lea	state_context_0, [ebp+len]
		mov	[esp+8], esi
		mov	dword ptr [esp+4], 3
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		mov	[ebp+var_58], args
		call	_silc_argument_get_arg_type
		mov	[ebp+name], eax
		mov	[esp+8], esi
		mov	dword ptr [esp+4], 4
		mov	edx, [ebp+var_58]
		mov	[esp], edx
args = edx				; SilcArgumentPayload
		call	_silc_argument_get_arg_type
		mov	[ebp+info], eax
		mov	ax, [ebp+id.type]
		cmp	ax, 2
		mov	edx, [ebp+var_58]
		jz	loc_62BA4F25
		cmp	ax, 3
		jz	loc_62BA4ECE
		dec	ax
		jnz	short out
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; server_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_58], edx
		call	_silc_client_get_server_by_id
		mov	esi, eax
server_entry = esi			; SilcServerEntry
		test	eax, eax
		jz	loc_62BA5003
server_entry = eax			; SilcServerEntry
		mov	server_entry, [ebp+info]
server_entry = esi			; SilcServerEntry
		mov	[esp+10h], eax	; server_info
		mov	eax, [ebp+name]
		mov	[esp+0Ch], eax	; server_name
		mov	[esp+8], server_entry ;	server_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_update_server

loc_62BA4E6E:				; CODE XREF: _silc_client_command_reply_identify+493j
		mov	word ptr [server_entry+2Ch], 0
		mov	eax, [ebp+info]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+name]
		mov	[esp+8], eax
		mov	[esp+4], server_entry
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	[esp+8], server_entry ;	server_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_server
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA4EA6:				; CODE XREF: _silc_client_command_reply_identify+1E8j
state_context_0	= esi			; void *
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA4DAA
; ---------------------------------------------------------------------------

loc_62BA4ECE:				; CODE XREF: _silc_client_command_reply_identify+270j
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; channel_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_58], edx
		call	_silc_client_get_channel_by_id
		mov	esi, eax
channel_entry =	esi			; SilcChannelEntry
		test	eax, eax
		mov	edx, [ebp+var_58]
		jz	loc_62BA4FAB

loc_62BA4EF4:				; CODE XREF: _silc_client_command_reply_identify+44Ej
		mov	eax, [ebp+info]
		mov	[esp+0Ch], eax
		mov	eax, [channel_entry]
		mov	[esp+8], eax
		mov	[esp+4], channel_entry
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	[esp+8], channel_entry ; channel_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_channel
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA4F25:				; CODE XREF: _silc_client_command_reply_identify+266j
		lea	eax, [ebp+id]
		mov	[esp+8], eax	; client_id
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_58], edx
		call	_silc_client_get_client_by_id
		mov	esi, eax
client_entry = esi			; SilcClientEntry
		test	eax, eax
		jz	loc_62BA5048
client_entry = eax			; SilcClientEntry
		mov	dword ptr [esp+18h], 0 ; mode
		mov	dword ptr [esp+14h], 0 ; userinfo
		mov	client_entry, [ebp+info]
client_entry = esi			; SilcClientEntry
		mov	[esp+10h], eax	; username
		mov	eax, [ebp+name]
		mov	[esp+0Ch], eax	; nickname
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_update_client

loc_62BA4F79:				; CODE XREF: _silc_client_command_reply_identify+4ECj
		mov	eax, [ebp+info]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+name]
		mov	[esp+8], eax
		mov	[esp+4], client_entry
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA4FAB:				; CODE XREF: _silc_client_command_reply_identify+33Ej
channel_entry =	eax			; SilcChannelEntry
		mov	ecx, [ebp+name]
		test	ecx, ecx
		jz	loc_62BA50D9
		lea	channel_entry, [ebp+id]
channel_entry =	esi			; SilcChannelEntry
		mov	[esp+10h], eax	; channel_id
		mov	dword ptr [esp+0Ch], 0 ; mode
		mov	eax, [ebp+name]
		mov	[esp+8], eax	; channel_name
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		mov	[ebp+var_58], edx
		call	_silc_client_add_channel
		mov	channel_entry, eax
		test	eax, eax
		mov	edx, [ebp+var_58]
		jz	loc_62BA50A1
channel_entry =	eax			; SilcChannelEntry
		mov	[esp+8], channel_entry ; channel_entry
		mov	[esp+4], conn	; conn
		mov	channel_entry, [ebp+client]
channel_entry =	esi			; SilcChannelEntry
		mov	[esp], eax	; client
		call	_silc_client_ref_channel
		jmp	loc_62BA4EF4
; ---------------------------------------------------------------------------

loc_62BA5003:				; CODE XREF: _silc_client_command_reply_identify+297j
server_entry = eax			; SilcServerEntry
		lea	server_entry, [ebp+id]
server_entry = esi			; SilcServerEntry
		mov	[esp+10h], eax	; server_id
		mov	eax, [ebp+info]
		mov	[esp+0Ch], eax	; server_info
		mov	eax, [ebp+name]
		mov	[esp+8], eax	; server_name
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_add_server
		mov	server_entry, eax
		test	eax, eax
		mov	edx, [ebp+var_58]
		jz	short loc_62BA50A1
server_entry = eax			; SilcServerEntry
		mov	[esp+8], server_entry ;	server_entry
		mov	[esp+4], conn	; conn
		mov	server_entry, [ebp+client]
server_entry = esi			; SilcServerEntry
		mov	[esp], eax	; client
		call	_silc_client_ref_server
		jmp	loc_62BA4E6E
; ---------------------------------------------------------------------------

loc_62BA5048:				; CODE XREF: _silc_client_command_reply_identify+392j
client_entry = eax			; SilcClientEntry ; mode
		mov	dword ptr [esp+18h], 0
		lea	client_entry, [ebp+id]
client_entry = esi			; SilcClientEntry
		mov	[esp+14h], eax	; id
		mov	dword ptr [esp+10h], 0 ; userinfo
		mov	eax, [ebp+info]
		mov	[esp+0Ch], eax	; username
		mov	eax, [ebp+name]
		mov	[esp+8], eax	; nickname
		mov	[esp+4], conn	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_add_client
		mov	client_entry, eax
		test	eax, eax
		mov	edx, [ebp+var_58]
		jz	loc_62BA5111
client_entry = eax			; SilcClientEntry
		mov	[esp+8], client_entry ;	client_entry
		mov	[esp+4], conn	; conn
		mov	client_entry, [ebp+client]
client_entry = esi			; SilcClientEntry
		mov	[esp], eax	; client
		call	_silc_client_ref_client
		jmp	loc_62BA4F79
; ---------------------------------------------------------------------------

loc_62BA50A1:				; CODE XREF: _silc_client_command_reply_identify+435j
					; _silc_client_command_reply_identify+47Ej
channel_entry =	eax			; SilcChannelEntry
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
channel_entry =	esi			; SilcChannelEntry
		test	al, al
		jnz	short loc_62BA5130
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA50BE:				; CODE XREF: _silc_client_command_reply_identify+59Dj
		mov	eax, [ebp+arg1]
		mov	[esp+8], eax
		mov	eax, [ebp+arg2]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA50D9:				; CODE XREF: _silc_client_command_reply_identify+400j
channel_entry =	eax			; SilcChannelEntry
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
channel_entry =	esi			; SilcChannelEntry
		test	al, al
		jnz	short loc_62BA5152
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA50F6:				; CODE XREF: _silc_client_command_reply_identify+57Ej
					; _silc_client_command_reply_identify+5BFj
		mov	eax, [ebp+arg2]
arg2_0 = eax				; void *
		mov	[esp+8], arg2_0
		mov	arg2_0,	[ebp+arg1]
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA5111:				; CODE XREF: _silc_client_command_reply_identify+4D3j
client_entry = eax			; SilcClientEntry
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
client_entry = esi			; SilcClientEntry
		test	al, al
		jnz	short loc_62BA5152
		mov	byte ptr [fsm_context_0+5Dh], 30h
		mov	byte ptr [fsm_context_0+5Ch], 30h
		jmp	short loc_62BA50F6
; ---------------------------------------------------------------------------

loc_62BA5130:				; CODE XREF: _silc_client_command_reply_identify+504j
channel_entry =	esi			; SilcChannelEntry
		lea	ecx, [ebp+arg1]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg2]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA50BE
; ---------------------------------------------------------------------------

loc_62BA5152:				; CODE XREF: _silc_client_command_reply_identify+53Cj
					; _silc_client_command_reply_identify+574j
		lea	ecx, [ebp+arg2]
		mov	[esp+0Ch], ecx
		lea	ecx, [ebp+arg1]
		mov	[esp+8], ecx
		mov	[esp+4], edx
args = edx				; SilcArgumentPayload
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	short loc_62BA50F6
_silc_client_command_reply_identify endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  78. silc_client_command_reply_whois

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_whois(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_whois
_silc_client_command_reply_whois proc near ; DATA XREF:	_silc_client_commands_unregister+4Eo
					; _silc_client_commands_register+69o ...

var_BC		= dword	ptr -0BCh
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
has_channels	= byte ptr -0A1h
fingerprint	= dword	ptr -0A0h
userinfo	= dword	ptr -9Ch
idle		= dword	ptr -98h
username	= dword	ptr -94h
nickname	= dword	ptr -90h
mode		= dword	ptr -8Ch
client_entry	= dword	ptr -88h
client		= dword	ptr -84h
args		= dword	ptr -80h
conn		= dword	ptr -7Ch
id		= SilcID ptr -6Ch
ch_user_modes	= SilcBufferStruct ptr -4Ch
channels	= SilcBufferStruct ptr -3Ch
arg1		= dword	ptr -2Ch
arg2		= dword	ptr -28h
umodes		= dword	ptr -24h
len		= dword	ptr -20h
fingerprint_len	= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ECh
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebp+state_context]
		mov	eax, [ebx+4]
		mov	[ebp+conn], eax
		mov	edx, [eax+4Ch]
		mov	[ebp+client], edx
		mov	[esp], esi
		call	_silc_command_get_args
		mov	[ebp+args], eax
		mov	[ebp+umodes], 0
		mov	dl, [ebx+5Dh]
		test	dl, dl
		jz	short loc_62BA5218
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		test	byte ptr [fsm_context_0+64h], 2
		jnz	loc_62BA52B4

loc_62BA51B8:				; CODE XREF: _silc_client_command_reply_whois+17Cj
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA5288
		mov	al, [fsm_context_0+5Dh]
		mov	[fsm_context_0+5Ch], al
		xor	eax, eax
		xor	edx, edx

loc_62BA51DB:				; CODE XREF: _silc_client_command_reply_whois+13Aj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		movzx	ecx, byte ptr [fsm_context_0+5Dh] ; error
		mov	edx, state_context_0 ; payload
		mov	eax, fsm_context_0 ; cmd
		call	_silc_client_command_process_error
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	state_context_0, [ebp+fsm]
		mov	[esp], esi
		call	_silc_fsm_next

loc_62BA520B:				; CODE XREF: _silc_client_command_reply_whois+24Bj
channel_list = esi			; SilcDList
		xor	eax, eax
		add	esp, 0ECh
		pop	fsm_context_0
		pop	channel_list
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA5218:				; CODE XREF: _silc_client_command_reply_whois+38j
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		mov	edi, [ebp+args]
		mov	[esp], edi
		mov	byte ptr [ebp+var_AC], dl
		call	_silc_argument_get_arg_num
		cmp	eax, 4
		ja	loc_62BA5324

loc_62BA5232:				; CODE XREF: _silc_client_command_reply_whois+1C1j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA52F8
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh
		xor	eax, eax
		xor	edx, edx

loc_62BA5257:				; CODE XREF: _silc_client_command_reply_whois+1AAj
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	ecx, [ebp+fsm]
		mov	[esp], ecx
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 0ECh
		pop	fsm_context_0
		pop	state_context_0
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
state_context_0	= esi			; void *
		align 4

loc_62BA5288:				; CODE XREF: _silc_client_command_reply_whois+57j
		lea	edx, [ebp+arg2]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg1]
		mov	[esp+8], edx
		mov	ecx, [ebp+args]
		mov	[esp+4], ecx
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg2]
		mov	eax, [ebp+arg1]
		jmp	loc_62BA51DB
; ---------------------------------------------------------------------------
		align 4

loc_62BA52B4:				; CODE XREF: _silc_client_command_reply_whois+3Ej
		mov	eax, [fsm_context_0+4]
		mov	eax, [eax+4Ch]
		mov	eax, [eax+18h]
		mov	eax, [eax+48h]
		mov	edi, [eax]
		movzx	edx, dl
		mov	[esp], edx
		call	_silc_get_status_message
		mov	edx, [fsm_context_0+4]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], offset aWhoisS ; "WHOIS: %s"
		mov	dword ptr [esp+8], 3
		mov	[esp+4], edx
		mov	eax, [edx+4Ch]
		mov	[esp], eax
		call	edi
		jmp	loc_62BA51B8
; ---------------------------------------------------------------------------
		align 4

loc_62BA52F8:				; CODE XREF: _silc_client_command_reply_whois+D1j
		lea	edx, [ebp+arg1]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg2]
		mov	[esp+8], edx
		mov	edx, [ebp+args]
		mov	[esp+4], edx
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		mov	edx, [ebp+arg1]
		mov	eax, [ebp+arg2]
		jmp	loc_62BA5257
; ---------------------------------------------------------------------------
		align 4

loc_62BA5324:				; CODE XREF: _silc_client_command_reply_whois+B8j
		mov	[esp], edi
		call	_silc_argument_get_arg_num
		cmp	eax, 0Bh
		mov	dl, byte ptr [ebp+var_AC]
		ja	loc_62BA5232
		mov	dword ptr [esp+10h], 0
		lea	state_context_0, [ebp+id]
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 2
		mov	edi, [ebp+args]
		mov	[esp], edi
		mov	byte ptr [ebp+var_AC], dl
		call	_silc_argument_get_decoded
		test	al, al
		mov	dl, byte ptr [ebp+var_AC]
		jnz	short loc_62BA53C4
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA5733

loc_62BA538E:				; CODE XREF: _silc_client_command_reply_whois+7C1j
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA5396:				; CODE XREF: _silc_client_command_reply_whois+5DCj
					; _silc_client_command_reply_whois+7E7j
		mov	eax, [ebp+arg2]
arg2_0 = eax				; void *
		mov	[esp+8], arg2_0
		mov	arg2_0,	[ebp+arg1]
arg1_0 = eax				; void *
		mov	[esp+4], arg1_0
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback

out:					; CODE XREF: _silc_client_command_reply_whois+5BAj
					; _silc_client_command_reply_whois+614j ...
channel_list = esi			; SilcDList
		mov	dword ptr [esp+4], offset _silc_client_command_reply_processed
		mov	edx, [ebp+fsm]
		mov	[esp], edx
		call	_silc_fsm_next
		jmp	loc_62BA520B
; ---------------------------------------------------------------------------

loc_62BA53C4:				; CODE XREF: _silc_client_command_reply_whois+1FFj
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp+args]
		mov	[esp], eax
		mov	byte ptr [ebp+var_AC], dl
		call	_silc_argument_get_arg_type
		mov	[ebp+nickname],	eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 4
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		call	_silc_argument_get_arg_type
		mov	[ebp+username],	eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	edi, [ebp+args]
		mov	[esp], edi
		call	_silc_argument_get_arg_type
		mov	[ebp+userinfo],	eax
		mov	edx, [ebp+nickname]
		test	edx, edx
		mov	dl, byte ptr [ebp+var_AC]
		jz	loc_62BA5755
		mov	edi, [ebp+username]
		test	edi, edi
		jz	loc_62BA5755
		test	eax, eax
		jz	loc_62BA5755
		lea	ecx, [ebp+channels]
		mov	[ebp+var_BC], ecx
		mov	ecx, 10h
		mov	edi, [ebp+var_BC]
		mov	al, dl
		rep stosb
		lea	edx, [ebp+len]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 6
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	loc_62BA5885
		mov	[ebp+channels.head], tmp
		mov	[ebp+channels.data], tmp
		add	tmp, [ebp+len]
		mov	[ebp+channels.end], eax
		mov	[ebp+channels.tail], eax
		lea	edi, [ebp+len]
		mov	[esp+8], edi
		mov	dword ptr [esp+4], 0Ah
		mov	eax, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	loc_62BA5922
		mov	[ebp+ch_user_modes.head], tmp
		mov	[ebp+ch_user_modes.data], tmp
		add	tmp, [ebp+len]
		mov	[ebp+ch_user_modes.end], eax
		mov	[ebp+ch_user_modes.tail], eax
		mov	[ebp+has_channels], 1

loc_62BA54D8:				; CODE XREF: _silc_client_command_reply_whois+718j
tmp = eax				; unsigned __int8 *
		lea	ecx, [ebp+len]
		mov	[esp+8], ecx
		mov	dword ptr [esp+4], 7
		mov	edi, [ebp+args]
		mov	[esp], edi
		call	_silc_argument_get_arg_type
		mov	edx, eax
tmp = edx				; unsigned __int8 *
		test	eax, eax
		jz	loc_62BA5913
tmp = eax				; unsigned __int8 *
		movzx	tmp, byte ptr [tmp+3]
tmp = edx				; unsigned __int8 *
		mov	[ebp+mode], eax
		movzx	eax, byte ptr [tmp]
		shl	eax, 18h
		or	[ebp+mode], eax
		movzx	eax, byte ptr [tmp+1]
		shl	eax, 10h
		or	[ebp+mode], eax
		movzx	eax, byte ptr [tmp+2]
		shl	eax, 8
		or	[ebp+mode], eax

loc_62BA552C:				; CODE XREF: _silc_client_command_reply_whois+7A9j
		lea	tmp, [ebp+len]
tmp = eax				; unsigned __int8 *
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 8
		mov	ecx, [ebp+args]
		mov	[esp], ecx
		call	_silc_argument_get_arg_type
		mov	edx, eax
tmp = edx				; unsigned __int8 *
		test	eax, eax
		jz	loc_62BA5904
tmp = eax				; unsigned __int8 *
		movzx	edi, byte ptr [tmp+3]
		movzx	tmp, byte ptr [tmp]
tmp = edx				; unsigned __int8 *
		shl	eax, 18h
		or	edi, eax
		movzx	eax, byte ptr [tmp+1]
		shl	eax, 10h
		or	edi, eax
		movzx	eax, byte ptr [tmp+2]
		shl	eax, 8
		or	edi, eax
		mov	[ebp+idle], edi

loc_62BA5574:				; CODE XREF: _silc_client_command_reply_whois+79Aj
		lea	eax, [ebp+fingerprint_len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 9
		mov	eax, [ebp+args]
		mov	[esp], eax
		call	_silc_argument_get_arg_type
		mov	[ebp+fingerprint], eax
		mov	[esp+8], esi	; client_id
		mov	edx, [ebp+conn]
		mov	[esp+4], edx	; conn
		mov	ecx, [ebp+client]
		mov	[esp], ecx	; client
		call	_silc_client_get_client_by_id
		mov	[ebp+client_entry], eax
		test	eax, eax
		jz	loc_62BA5891
		mov	eax, [ebp+mode]
		mov	[esp+18h], eax	; mode
		mov	edx, [ebp+userinfo]
		mov	[esp+14h], edx	; userinfo
		mov	ecx, [ebp+username]
		mov	[esp+10h], ecx	; username
		mov	esi, [ebp+nickname]
		mov	[esp+0Ch], esi	; nickname
		mov	edi, [ebp+client_entry]
		mov	[esp+8], edi	; client_entry
		mov	eax, [ebp+conn]
		mov	[esp+4], eax	; conn
		mov	edx, [ebp+client]
		mov	[esp], edx	; client
		call	_silc_client_update_client

loc_62BA5602:				; CODE XREF: _silc_client_command_reply_whois+78Bj
		mov	ecx, [ebp+client_entry]
		mov	eax, [ecx+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_wrlock
		mov	esi, [ebp+fingerprint]
		test	esi, esi
		jz	short loc_62BA562A
		cmp	[ebp+fingerprint_len], 14h
		jz	loc_62BA5960

loc_62BA562A:				; CODE XREF: _silc_client_command_reply_whois+4AAj
					; _silc_client_command_reply_whois+80Dj
		lea	eax, [ebp+len]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0Bh
		mov	edx, [ebp+args]
		mov	[esp], edx
		call	_silc_argument_get_arg_type
		test	eax, eax
tmp = eax				; unsigned __int8 *
		jz	short loc_62BA5687
		mov	ecx, [ebp+client_entry]
		mov	edx, [ecx+3B8h]
		test	edx, edx
		jz	short loc_62BA566C
		mov	[esp], edx
		mov	[ebp+var_AC], tmp
		call	_silc_attribute_payload_list_free
		mov	eax, [ebp+var_AC]

loc_62BA566C:				; CODE XREF: _silc_client_command_reply_whois+4E2j
tmp = eax				; unsigned __int8 *
		mov	edx, [ebp+len]
		mov	[esp+4], edx
		mov	[esp], tmp
		call	_silc_attribute_payload_parse
		mov	esi, [ebp+client_entry]
		mov	[esi+3B8h], eax

loc_62BA5687:				; CODE XREF: _silc_client_command_reply_whois+4D2j
tmp = eax				; unsigned __int8 *
		mov	edi, [ebp+client_entry]
		mov	tmp, [edi+3D8h]
		mov	[esp], eax
		call	_silc_rwlock_unlock
		cmp	[ebp+has_channels], 0
		jnz	loc_62BA57AF
		mov	edx, [ebp+client_entry]
		mov	eax, [edx+3B8h]
		mov	[esp+28h], eax
		mov	eax, [ebp+umodes]
		mov	[esp+24h], eax
		mov	ecx, [ebp+fingerprint]
		mov	[esp+20h], ecx
		mov	esi, [ebp+idle]
		mov	[esp+1Ch], esi
		mov	edi, [ebp+mode]
		mov	[esp+18h], edi
		mov	dword ptr [esp+14h], 0
		mov	eax, [ebp+userinfo]
		mov	[esp+10h], eax
		mov	edx, [ebp+username]
		mov	[esp+0Ch], edx
		mov	ecx, [ebp+nickname]
		mov	[esp+8], ecx
		mov	esi, [ebp+client_entry]
		mov	[esp+4], esi
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	[esp+8], esi	; client_entry
		mov	edi, [ebp+conn]
		mov	[esp+4], edi	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA5733:				; CODE XREF: _silc_client_command_reply_whois+214j
		lea	edx, [ebp+arg2]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg1]
		mov	[esp+8], edx
		mov	[esp+4], edi
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA5396
; ---------------------------------------------------------------------------

loc_62BA5755:				; CODE XREF: _silc_client_command_reply_whois+2C7j
					; _silc_client_command_reply_whois+2D5j ...
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	short loc_62BA578D
		mov	byte ptr [fsm_context_0+5Dh], 1Dh
		mov	byte ptr [fsm_context_0+5Ch], 1Dh

loc_62BA5772:				; CODE XREF: _silc_client_command_reply_whois+639j
					; _silc_client_command_reply_whois+833j
		mov	eax, [ebp+arg1]
arg2_1 = eax				; void *
		mov	[esp+8], arg2_1
		mov	arg2_1,	[ebp+arg2]
arg1_1 = eax				; void *
		mov	[esp+4], arg1_1
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA578D:				; CODE XREF: _silc_client_command_reply_whois+5F4j
					; _silc_client_command_reply_whois+825j
		lea	edx, [ebp+arg1]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg2]
		mov	[esp+8], edx
		mov	edx, [ebp+args]
		mov	[esp+4], edx
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	short loc_62BA5772
; ---------------------------------------------------------------------------

loc_62BA57AF:				; CODE XREF: _silc_client_command_reply_whois+52Ej
		mov	edx, [ebp+channels.data]
		mov	eax, [ebp+channels.tail]
		sub	eax, edx
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_channel_payload_parse_list
		mov	esi, eax
channel_list = esi			; SilcDList
		test	eax, eax
		jz	short loc_62BA57E5
channel_list = eax			; SilcDList
		lea	channel_list, [ebp+umodes]
channel_list = esi			; SilcDList
		mov	[esp+8], eax
		mov	eax, [channel_list+10h]
		shr	eax, 2
		mov	[esp+4], eax
		lea	eax, [ebp+ch_user_modes]
		mov	[esp], eax
		call	_silc_get_mode_list

loc_62BA57E5:				; CODE XREF: _silc_client_command_reply_whois+653j
		mov	ecx, [ebp+client_entry]
		mov	eax, [ecx+3B8h]
		mov	[esp+28h], eax
		mov	eax, [ebp+umodes]
		mov	[esp+24h], eax
		mov	edi, [ebp+fingerprint]
		mov	[esp+20h], edi
		mov	eax, [ebp+idle]
		mov	[esp+1Ch], eax
		mov	edx, [ebp+mode]
		mov	[esp+18h], edx
		mov	[esp+14h], channel_list
		mov	ecx, [ebp+userinfo]
		mov	[esp+10h], ecx
		mov	edi, [ebp+username]
		mov	[esp+0Ch], edi
		mov	eax, [ebp+nickname]
		mov	[esp+8], eax
		mov	edx, [ebp+client_entry]
		mov	[esp+4], edx
		mov	[esp], fsm_context_0 ; cmd
		call	_silc_client_command_callback
		mov	ecx, [ebp+client_entry]
		mov	[esp+8], ecx	; client_entry
		mov	edi, [ebp+conn]
		mov	[esp+4], edi	; conn
		mov	eax, [ebp+client]
		mov	[esp], eax	; client
		call	_silc_client_unref_client
		mov	[esp], channel_list
		call	_silc_channel_payload_list_free
		mov	eax, [ebp+umodes]
		mov	[esp], eax
		call	_silc_free
		jmp	out
; ---------------------------------------------------------------------------

loc_62BA5885:				; CODE XREF: _silc_client_command_reply_whois+317j
tmp = eax				; unsigned __int8 *
		mov	[ebp+has_channels], 0
		jmp	loc_62BA54D8
; ---------------------------------------------------------------------------

loc_62BA5891:				; CODE XREF: _silc_client_command_reply_whois+441j
		mov	edi, [ebp+mode]
		mov	[esp+18h], edi	; mode
		mov	[esp+14h], esi	; id
		mov	eax, [ebp+userinfo]
		mov	[esp+10h], eax	; userinfo
		mov	edx, [ebp+username]
		mov	[esp+0Ch], edx	; username
		mov	ecx, [ebp+nickname]
		mov	[esp+8], ecx	; nickname
		mov	esi, [ebp+conn]
		mov	[esp+4], esi	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_add_client
		mov	[ebp+client_entry], eax
		test	eax, eax
		jz	loc_62BA5986
		mov	ecx, [ebp+client_entry]
		mov	[esp+8], ecx	; client_entry
		mov	esi, [ebp+conn]
		mov	[esp+4], esi	; conn
		mov	edi, [ebp+client]
		mov	[esp], edi	; client
		call	_silc_client_ref_client
		jmp	loc_62BA5602
; ---------------------------------------------------------------------------

loc_62BA5904:				; CODE XREF: _silc_client_command_reply_whois+3D6j
tmp = eax				; unsigned __int8 *
		mov	[ebp+idle], 0
		jmp	loc_62BA5574
; ---------------------------------------------------------------------------

loc_62BA5913:				; CODE XREF: _silc_client_command_reply_whois+382j
		mov	[ebp+mode], 0
		jmp	loc_62BA552C
; ---------------------------------------------------------------------------

loc_62BA5922:				; CODE XREF: _silc_client_command_reply_whois+348j
		mov	[ebp+arg1], 0
		mov	[ebp+arg2], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jz	loc_62BA538E
		lea	edx, [ebp+arg2]
		mov	[esp+0Ch], edx
		lea	edx, [ebp+arg1]
		mov	[esp+8], edx
		mov	edx, [ebp+args]
		mov	[esp+4], edx
		movzx	eax, al
		mov	[esp], eax
		call	_silc_status_get_args
		jmp	loc_62BA5396
; ---------------------------------------------------------------------------

loc_62BA5960:				; CODE XREF: _silc_client_command_reply_whois+4B0j
		mov	esi, [ebp+client_entry]
		add	esi, 3BCh
		mov	[ebp+var_A8], esi
		mov	ecx, 5
		mov	edi, esi
		mov	esi, [ebp+fingerprint]
		rep movsd
		jmp	loc_62BA562A
; ---------------------------------------------------------------------------

loc_62BA5986:				; CODE XREF: _silc_client_command_reply_whois+766j
		mov	[ebp+arg2], 0
		mov	[ebp+arg1], 0
		mov	al, [fsm_context_0+5Ch]
		test	al, al
		jnz	loc_62BA578D
		mov	byte ptr [fsm_context_0+5Dh], 30h
		mov	byte ptr [fsm_context_0+5Ch], 30h
		jmp	loc_62BA5772
_silc_client_command_reply_whois endp

; Exported entry  67. silc_client_command_reply_processed

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_processed(SilcFSMObject	*fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_processed
_silc_client_command_reply_processed proc near
					; DATA XREF: _silc_client_command_reply_quit+6o
					; _silc_client_command_reply_service+6Do ...

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, [ebp+fsm_context]
		mov	esi, [ebx+4]
conn = esi				; SilcClientConnection
		mov	eax, [ebp+state_context]
		mov	[esp], eax
		call	_silc_command_payload_free
		mov	al, [ebx+5Ch]
		test	al, al
		jz	short loc_62BA59D4
fsm_context_0 =	ebx			; void *
		cmp	al, 3
		jz	short loc_62BA59D4
		cmp	al, 9
		jbe	short loc_62BA59E0

loc_62BA59D4:				; CODE XREF: _silc_client_command_reply_processed+1Ej
					; _silc_client_command_reply_processed+22j
		mov	eax, 3
		add	esp, 10h
		pop	fsm_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA59E0:				; CODE XREF: _silc_client_command_reply_processed+26j
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		mov	eax, [conn+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_lock
		and	byte ptr [fsm_context_0+64h], 0FBh
		mov	eax, [conn+54h]
		mov	ecx, [eax+0D8h]
		test	ecx, ecx
		jz	short loc_62BA5A74
		movzx	edx, word ptr [eax+0E4h]
		mov	ecx, [eax+0DCh]
		mov	[ecx+edx], fsm_context_0

loc_62BA5A12:				; CODE XREF: _silc_client_command_reply_processed+CEj
		test	byte ptr [eax+0E8h], 1
		jz	short loc_62BA5A2B
		movzx	edx, word ptr [eax+0E6h]
		mov	ecx, [eax+0DCh]
		mov	[fsm_context_0+edx], ecx

loc_62BA5A2B:				; CODE XREF: _silc_client_command_reply_processed+6Dj
		mov	[eax+0DCh], fsm_context_0
		movzx	edx, word ptr [eax+0E4h]
		mov	dword ptr [fsm_context_0+edx], 0
		add	dword ptr [eax+0E8h], 4
		mov	eax, [conn+54h]
		mov	eax, [eax+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	dword ptr [esp+4], offset _silc_client_command_reply_wait
		mov	eax, [ebp+fsm]
		mov	[esp], eax
		call	_silc_fsm_next
		xor	eax, eax
		add	esp, 10h
		pop	fsm_context_0
		pop	conn
		leave
		retn
; ---------------------------------------------------------------------------
fsm_context_0 =	ebx			; void *
conn = esi				; SilcClientConnection
		align 4

loc_62BA5A74:				; CODE XREF: _silc_client_command_reply_processed+54j
		mov	[eax+0D8h], fsm_context_0
		jmp	short loc_62BA5A12
_silc_client_command_reply_processed endp

; Exported entry  66. silc_client_command_reply_process

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_process(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_process
_silc_client_command_reply_process proc	near ; DATA XREF: _silc_client_command_reply+12Ao

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	esi, [ebp+fsm]
		mov	ebx, [ebp+fsm_context]
		lea	eax, [ebx+5Dh]
		mov	[esp+8], eax
		lea	eax, [ebx+5Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+state_context]
		mov	[esp], eax
		call	_silc_command_get_status
		cmp	byte ptr [ebx+34h], 1Bh	; switch 28 cases
		jbe	short loc_62BA5AB8

loc_62BA5AA9:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
fsm_0 =	esi				; SilcFSMObject	* ; jumptable 62BA5ABC default case
fsm_context_0 =	ebx			; void *
		mov	eax, 3
		xchg	ax, ax

loc_62BA5AB0:				; CODE XREF: _silc_client_command_reply_process+5Aj
					; _silc_client_command_reply_process+6Ej ...
		add	esp, 10h
		pop	fsm_context_0
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	esi				; SilcFSMObject	*
fsm_context_0 =	ebx			; void *
		align 4

loc_62BA5AB8:				; CODE XREF: _silc_client_command_reply_process+2Bj
		movzx	eax, byte ptr [fsm_context_0+34h]
		jmp	ds:off_62BA9238[eax*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 4

loc_62BA5AC4:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_service ; jumptable 62BA5ABC case 27
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62BA5AB0
; ---------------------------------------------------------------------------

loc_62BA5AD8:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_getkey ; jumptable	62BA5ABC case 26
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62BA5AB0
; ---------------------------------------------------------------------------

loc_62BA5AEC:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_users ; jumptable 62BA5ABC	case 25
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62BA5AB0
; ---------------------------------------------------------------------------

loc_62BA5B00:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_leave ; jumptable 62BA5ABC	case 24
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62BA5AB0
; ---------------------------------------------------------------------------

loc_62BA5B14:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_silcoper ;	jumptable 62BA5ABC case	23
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	short loc_62BA5AB0
; ---------------------------------------------------------------------------

loc_62BA5B28:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_watch ; jumptable 62BA5ABC	case 22
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5B40:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_detach ; jumptable	62BA5ABC case 21
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5B58:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_ban ; jumptable 62BA5ABC case 20
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5B70:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_kick ; jumptable 62BA5ABC case 19
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5B88:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_cumode ; jumptable	62BA5ABC case 18
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5BA0:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_cmode ; jumptable 62BA5ABC	case 17
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5BB8:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_umode ; jumptable 62BA5ABC	case 16
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5BD0:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_motd ; jumptable 62BA5ABC case 15
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5BE8:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_join ; jumptable 62BA5ABC case 14
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5C00:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_oper ; jumptable 62BA5ABC case 13
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5C18:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_ping ; jumptable 62BA5ABC case 12
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5C30:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_stats ; jumptable 62BA5ABC	case 11
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5C48:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_info ; jumptable 62BA5ABC case 10
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5C60:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_kill ; jumptable 62BA5ABC case 9
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5C78:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_quit ; jumptable 62BA5ABC case 8
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5C90:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_invite ; jumptable	62BA5ABC case 7
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5CA8:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_topic ; jumptable 62BA5ABC	case 6
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5CC0:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_list ; jumptable 62BA5ABC case 5
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5CD8:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_nick ; jumptable 62BA5ABC case 4
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5CF0:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_identify ;	jumptable 62BA5ABC case	3
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 4

loc_62BA5D08:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_whowas ; jumptable	62BA5ABC case 2
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5D20:				; CODE XREF: _silc_client_command_reply_process+40j
					; DATA XREF: .rdata:off_62BA9238o
		mov	dword ptr [esp+4], offset _silc_client_command_reply_whois ; jumptable 62BA5ABC	case 1
		mov	[esp], fsm_0
		call	_silc_fsm_next
		xor	eax, eax
		jmp	loc_62BA5AB0
_silc_client_command_reply_process endp

; ---------------------------------------------------------------------------
		align 4
; Exported entry  76. silc_client_command_reply_wait

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply_wait(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply_wait
_silc_client_command_reply_wait	proc near ; DATA XREF: _silc_client_command_service+47o
					; _silc_client_command_send_argv+161o ...

fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	ebx, [ebp+fsm]
		mov	dword ptr [esp+4], 0
		mov	[esp], ebx
		call	_silc_fsm_set_state_context
		mov	eax, [ebp+fsm_context]
		cmp	byte ptr [eax+34h], 0Ch
		jz	short loc_62BA5D88
fsm_0 =	ebx				; SilcFSMObject	*
fsm_context_0 =	eax			; void *
		mov	fsm_context_0, 28h

loc_62BA5D60:				; CODE XREF: _silc_client_command_reply_wait+55j
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset _silc_client_command_reply_timeout
		mov	[esp], fsm_0
		call	_silc_fsm_next_later
		mov	eax, 2
		add	esp, 14h
		pop	fsm_0
		leave
		retn
; ---------------------------------------------------------------------------
fsm_0 =	ebx				; SilcFSMObject	*
fsm_context_0 =	eax			; void *
		align 4

loc_62BA5D88:				; CODE XREF: _silc_client_command_reply_wait+21j
		mov	fsm_context_0, 3Ch
		jmp	short loc_62BA5D60
_silc_client_command_reply_wait	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  48. silc_client_command_reply

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl silc_client_command_reply(SilcFSMObject *fsm, void *fsm_context, void *state_context)
		public _silc_client_command_reply
_silc_client_command_reply proc	near	; DATA XREF: _silc_client_connection_st_packet:loc_62B81F40o

var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
fsm		= dword	ptr  8
fsm_context	= dword	ptr  0Ch
state_context	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	esi, [ebp+state_context]
		mov	edx, [esi+0Ch]
		mov	eax, [esi+10h]
		sub	eax, edx
		mov	[esp+4], eax
		mov	[esp], edx
		call	_silc_command_payload_parse
		mov	ebx, eax
payload	= ebx				; SilcCommandPayload
		mov	[esp], esi
		call	_silc_packet_free
		test	payload, payload
		jz	loc_62BA5F06
state_context_0	= esi			; void *
		mov	[esp], payload
		call	_silc_command_get_ident
		mov	edi, eax
cmd_ident = edi				; SilcUInt16
		mov	[esp], payload
		call	_silc_command_get
		mov	ecx, [ebp+fsm_context]
		mov	edx, [ecx+54h]
		mov	edx, [edx+0B8h]
		mov	[esp], edx
		mov	[ebp+var_28], al
		call	_silc_mutex_lock
		mov	ecx, [ebp+fsm_context]
		mov	edx, [ecx+54h]
		mov	ecx, [edx+0D8h]
		mov	[edx+0E0h], ecx
		and	byte ptr [edx+0E8h], 0FDh
		mov	ecx, [ebp+fsm_context]
		mov	edx, [ecx+54h]
		mov	al, [ebp+var_28]
command	= eax				; SilcCommand
		lea	esi, [esi+0]

loc_62BA5E10:				; CODE XREF: _silc_client_command_reply+B4j
					; _silc_client_command_reply+BAj
		mov	esi, [edx+0E0h]
		test	esi, esi
		jz	loc_62BA5EF0
		test	byte ptr [edx+0E8h], 2
		jz	loc_62BA5EE0
		movzx	ecx, word ptr [edx+0E6h]
		mov	ecx, [esi+ecx]

loc_62BA5E35:				; CODE XREF: _silc_client_command_reply+15Aj
		mov	[edx+0E0h], ecx
		mov	cl, [esi+34h]
		cmp	al, cl
		jz	short loc_62BA5E46
		test	cl, cl
		jnz	short loc_62BA5E10

loc_62BA5E46:				; CODE XREF: _silc_client_command_reply+B0j
		cmp	di, [esi+36h]
		jnz	short loc_62BA5E10
		mov	cmd_ident, [edx+0D8h]
		mov	[ebp+var_3C], edi
		test	edi, edi
		jz	short loc_62BA5E91
		cmp	esi, edi
		jz	loc_62BA5F8B
		movzx	command, word ptr [edx+0E4h]
		mov	[ebp+var_1C], eax
		mov	ecx, [ebp+var_3C]
prev = ecx				; void *
		mov	[ebp+var_20], payload
		mov	payload, eax
		jmp	short loc_62BA5E82
; ---------------------------------------------------------------------------
p = edi					; void **
prev = eax				; void *
		align 4

loc_62BA5E78:				; CODE XREF: _silc_client_command_reply+F9j
		cmp	esi, prev
		jz	loc_62BA5F14
		mov	ecx, prev

loc_62BA5E82:				; CODE XREF: _silc_client_command_reply+E3j
prev = ecx				; void *
		lea	p, [prev+ebx]
		mov	eax, [p]
prev = eax				; void *
		test	prev, prev
		jnz	short loc_62BA5E78
		mov	[ebp+var_3C], ecx
		mov	ebx, [ebp+var_20]

loc_62BA5E91:				; CODE XREF: _silc_client_command_reply+C7j
					; _silc_client_command_reply+1CDj
payload	= ebx				; SilcCommandPayload
command	= eax				; SilcCommand
prev = ecx				; void *
		cmp	[edx+0DCh], esi
		jz	loc_62BA5F62
		mov	command, [edx+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock

loc_62BA5EAB:				; CODE XREF: _silc_client_command_reply+1E9j
		add	esi, 8
		mov	[esp+4], payload
		mov	[esp], esi
		call	_silc_fsm_set_state_context
		mov	dword ptr [esp+4], offset _silc_client_command_reply_process
		mov	[esp], esi
		call	_silc_fsm_next
		mov	[esp], esi
		call	_silc_fsm_continue_sync
		mov	eax, 3
		add	esp, 4Ch
		pop	payload
		pop	esi
		pop	p
		leave
		retn
; ---------------------------------------------------------------------------
payload	= ebx				; SilcCommandPayload
command	= eax				; SilcCommand
cmd_ident = edi				; SilcUInt16
		align 10h

loc_62BA5EE0:				; CODE XREF: _silc_client_command_reply+95j
		movzx	ecx, word ptr [edx+0E4h]
		mov	ecx, [esi+ecx]
		jmp	loc_62BA5E35
; ---------------------------------------------------------------------------
		align 10h

loc_62BA5EF0:				; CODE XREF: _silc_client_command_reply+88j
		mov	command, [edx+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		mov	[esp], payload
		call	_silc_command_payload_free

loc_62BA5F06:				; CODE XREF: _silc_client_command_reply+2Cj
		mov	eax, 3
		add	esp, 4Ch
		pop	payload
		pop	esi
		pop	cmd_ident
		leave
		retn
; ---------------------------------------------------------------------------
p = edi					; void **
prev = eax				; void *
		align 4

loc_62BA5F14:				; CODE XREF: _silc_client_command_reply+EAj
		mov	[ebp+var_3C], ecx
		mov	[ebp+var_2C], p
		mov	ebx, [ebp+var_20]

loc_62BA5F1D:				; CODE XREF: _silc_client_command_reply+215j
payload	= ebx				; SilcCommandPayload
prev = ecx				; void *
		mov	p, [ebp+var_1C]
		mov	edi, [esi+edi]
		mov	[ebp+var_20], edi
		mov	eax, [ebp+var_2C]
		mov	[eax], edi
		test	edi, edi
		jz	short loc_62BA5F48
		test	byte ptr [edx+0E8h], 1
		jz	short loc_62BA5F48
		movzx	prev, word ptr [edx+0E6h]
		mov	edi, [esi+ecx]
		mov	eax, [ebp+var_20]
		mov	[eax+ecx], edi

loc_62BA5F48:				; CODE XREF: _silc_client_command_reply+19Dj
					; _silc_client_command_reply+1A6j
prev = ecx				; void *
		cmp	[edx+0E0h], esi
		jz	short loc_62BA5F7E

loc_62BA5F50:				; CODE XREF: _silc_client_command_reply+1F9j
		sub	dword ptr [edx+0E8h], 4
		mov	edi, [ebp+fsm_context]
		mov	edx, [edi+54h]
		jmp	loc_62BA5E91
; ---------------------------------------------------------------------------

loc_62BA5F62:				; CODE XREF: _silc_client_command_reply+107j
p = edi					; void **
command	= eax				; SilcCommand
		mov	prev, [ebp+var_3C]
prev = eax				; void *
		mov	[edx+0DCh], ecx
		mov	prev, [edx+0B8h]
		mov	[esp], eax
		call	_silc_mutex_unlock
		jmp	loc_62BA5EAB
; ---------------------------------------------------------------------------

loc_62BA5F7E:				; CODE XREF: _silc_client_command_reply+1BEj
prev = ecx				; void *
		mov	prev, [ebp+var_2C]
		mov	eax, [ecx]
		mov	[edx+0E0h], eax
		jmp	short loc_62BA5F50
; ---------------------------------------------------------------------------

loc_62BA5F8B:				; CODE XREF: _silc_client_command_reply+CBj
command	= eax				; SilcCommand
		lea	command, [edx+0D8h]
		mov	[ebp+var_2C], eax
		movzx	ecx, word ptr [edx+0E4h]
		mov	[ebp+var_1C], ecx
		mov	[ebp+var_3C], 0
		jmp	loc_62BA5F1D
_silc_client_command_reply endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_schedule_one]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_schedule]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_identifier_verify]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_malloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rng_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rng_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rng_global_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_schedule_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_engine_start]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_cipher_register_default]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_pkcs_register_default]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_register_default]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hmac_register_default]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_schedule_uninit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rng_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_engine_stop]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_cipher_unregister_all]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_pkcs_unregister_all]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_unregister_all]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hmac_unregister_all]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_get_state_context]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_schedule_stop]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_event_wait]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_thread_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_next]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_utf8_valid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_memdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_async_abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_is_started]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_stream_destroy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_continue_sync]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_get_schedule]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_event_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_start_sync]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_event_signal]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_schedule_task_del_by_context]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_get_all]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_mutex_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_free_rekey_material]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_async_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_mutex_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_async_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_thread_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_set_state_context]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_start]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_socket_stream_get_info]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_format]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_log_output]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_finish]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_del_by_context]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_count]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_attribute_payload_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_add]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_ptr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_attribute_payload_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_pkcs_public_key_encode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_attribute_get_attribute]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_find_foreach]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_pkcs_sign]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_attribute_get_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_attribute_payload_encode_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_timezone]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_attribute_payload_encode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_list]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_get]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_list_reset]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_cipher_is_supported]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hmac_is_supported]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_process_key_material_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_free_key_material]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_continue]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rwlock_wrlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_del]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rwlock_unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_message_payload_encode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_send_ext]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_table_find]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_message_get_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_message_get_flags]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_message_payload_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_message_payload_parse]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_channel_key_payload_parse]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_channel_key_get_id]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_id_str2id]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_schedule_task_add]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_channel_key_get_cipher]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_cipher_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_channel_key_get_key]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_cipher_set_key]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hmac_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_make]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hmac_get_hash]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hash_len]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hmac_set_key]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_channel_key_payload_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_cipher_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hmac_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_cipher_get_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hmac_get_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_argument_list_parse_decoded]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_pkcs_public_key_compare]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_argument_list_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_rekey_responder]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_rekey_initiator]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_parse_version]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_schedule_task_del_by_all]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_connauth_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_connauth_initiator]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_connauth_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_send_va]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_next_later]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_get_security_properties]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_stream_get_stream]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_stream_set_stream]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_stream_set_iv_included]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_set_sid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_stream_destroy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_set_callbacks]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_set_ids]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_initiator]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_fsm_get_context]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_set_keys]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_map_status]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_set_keys]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_stream_create]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_set_context]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_net_udp_connect]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_net_tcp_connect]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_buffer_unformat]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rwlock_rdlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_find_by_name_one]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_channel_name_check]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_find_by_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_strncat]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_find_by_context]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_pkcs_public_key_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_del_by_context]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_utf8_strcasecmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_utf8_strncasecmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rwlock_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_parse_userfqdn]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_add]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_snprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rwlock_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_identifier_check]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_update_by_context]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_id_payload_parse_id]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_mutex_lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_idcache_find_by_id_one]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_id_payload_encode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_mutex_unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_key_agreement_payload_parse]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_key_agreement_get_hostname]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_key_agreement_get_port]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_key_agreement_payload_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_opendir]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_readdir]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_file_write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_buffer_format]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_file_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_file_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_asprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_fs_memory_alloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_fs_memory_add_file]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_file_size]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_key_agreement_payload_encode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_send_va_ext]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_server_shutdown]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_fs_memory_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_client_shutdown]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_stream_wrap]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_client_start]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_server_start]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_sftp_server_set_monitor]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_key_agreement_get_protocol]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_get_key_material]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_net_close_listener]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_net_tcp_create_listener]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_net_listener_get_port]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_stream_link]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_net_get_local_port]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_ske_responder]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_get_sender]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_stream_add_remote]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_argument_get_arg_num]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_public_key_payload_decode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_hmac_get_key]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_argument_get_arg_type]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_argument_get_decoded]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_notify_payload_parse]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_notify_get_args]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_notify_get_type]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_notify_payload_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_cipher_set_iv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_wait]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_wait_uninit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_wait_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_auth_public_key_auth_generate]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rng_get_rn16]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_id_payload_encode_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_id_id2str]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_parse_command_line]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_command_payload_parse]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_command_get_args]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_command_get]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_command_payload_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_attribute_payload_parse]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_command_get_ident]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_command_reply_payload_encode_va]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_attribute_payload_list_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_command_payload_encode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_command_payload_encode_vap]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_packet_send]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_auth_payload_encode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_load_key_pair]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_rng_get_rn_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_auth_public_key_auth_generate_wpub]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_utf8_encoded_len]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_utf8_encode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_time]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_pkcs_get_type]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_pkcs_load_public_key]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_public_key_payload_encode]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_argument_payload_encode_one]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_argument_list_parse]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_argument_payload_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_get_status_message]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_channel_payload_parse_list]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_get_mode_list]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_channel_payload_list_free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_status_get_args]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _silc_command_get_status]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl __report_error(char *, char)
___report_error	proc near		; CODE XREF: ___write_memory+CDp
					; __pei386_runtime_relocator+CDp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[ebp+var_8], ebx
		mov	ebx, ds:__imp___iob
		mov	[ebp+var_4], esi
		lea	esi, [ebp+arg_4]
		mov	dword ptr [esp+8], 17h ; size_t
		mov	dword ptr [esp+4], 1 ; size_t
		add	ebx, 40h
		mov	[esp+0Ch], ebx	; FILE *
		mov	dword ptr [esp], offset	aMingwRuntimeFa	; "Mingw runtime failure:\n"
		call	_fwrite
		mov	eax, [ebp+arg_0]
		mov	[esp+8], esi	; va_list
		mov	[esp], ebx	; FILE *
		mov	[esp+4], eax	; char *
		call	_vfprintf
		call	_abort
___report_error	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __fastcall __write_memory(size_t,	void *)
___write_memory	proc near		; CODE XREF: __pei386_runtime_relocator+FCp
					; __pei386_runtime_relocator+128p ...

Buffer		= _MEMORY_BASIC_INFORMATION ptr	-38h
flOldProtect	= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		test	ecx, ecx
		mov	[ebp+var_C], ebx
		mov	ebx, eax
		mov	[ebp+var_8], esi
		mov	esi, edx
		mov	[ebp+var_4], edi
		mov	edi, ecx
		jnz	short loc_62BA67F6

loc_62BA67E9:				; CODE XREF: ___write_memory+8Bj
					; ___write_memory+90j ...
		mov	ebx, [ebp+var_C]
		mov	esi, [ebp+var_8]
		mov	edi, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_62BA67F6:				; CODE XREF: ___write_memory+17j
		lea	eax, [ebp+Buffer]
		mov	dword ptr [esp+8], 1Ch ; dwLength
		mov	[esp+4], eax	; lpBuffer
		mov	[esp], ebx	; lpAddress
		call	_VirtualQuery@12
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_62BA688A
		mov	eax, [ebp+Buffer.Protect]
		cmp	eax, 4
		jz	short loc_62BA6845
		cmp	eax, 40h
		jz	short loc_62BA6845
		lea	eax, [ebp+flOldProtect]
		mov	[esp+0Ch], eax	; lpflOldProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	dword ptr [esp+8], 40h ; flNewProtect
		mov	[esp+4], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp], eax	; lpAddress
		call	_VirtualProtect@16
		sub	esp, 10h

loc_62BA6845:				; CODE XREF: ___write_memory+4Aj
					; ___write_memory+4Fj
		mov	[esp+8], edi	; size_t
		mov	[esp+4], esi	; void *
		mov	[esp], ebx	; void *
		call	_memcpy
		mov	eax, [ebp+Buffer.Protect]
		cmp	eax, 4
		jz	short loc_62BA67E9
		cmp	eax, 40h
		jz	short loc_62BA67E9
		lea	eax, [ebp+flOldProtect]
		mov	[esp+0Ch], eax	; lpflOldProtect
		mov	eax, [ebp+flOldProtect]
		mov	[esp+8], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+4], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp], eax	; lpAddress
		call	_VirtualProtect@16
		sub	esp, 10h
		jmp	loc_62BA67E9
; ---------------------------------------------------------------------------

loc_62BA688A:				; CODE XREF: ___write_memory+42j
		mov	[esp+8], ebx
		mov	dword ptr [esp+4], 1Ch ; char
		mov	dword ptr [esp], offset	aVirtualqueryFa	; "  VirtualQuery failed for %d	bytes at a"...
		call	___report_error
___write_memory	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public __pei386_runtime_relocator
__pei386_runtime_relocator proc	near	; CODE XREF: _DllMainCRTStartup@12+78p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:_was_init_31080
		mov	[ebp+var_C], ebx
		mov	[ebp+var_8], esi
		mov	[ebp+var_4], edi
		test	eax, eax
		jz	short loc_62BA68D5

loc_62BA68C8:				; CODE XREF: __pei386_runtime_relocator+3Cj
					; __pei386_runtime_relocator+92j ...
		mov	ebx, [ebp+var_C]
		mov	esi, [ebp+var_8]
		mov	edi, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_62BA68D5:				; CODE XREF: __pei386_runtime_relocator+16j
		mov	eax, offset __RUNTIME_PSEUDO_RELOC_LIST_END__
		sub	eax, offset __RUNTIME_PSEUDO_RELOC_LIST_END__
		cmp	eax, 7
		mov	ds:_was_init_31080, 1
		jle	short loc_62BA68C8
		cmp	eax, 0Bh
		mov	ebx, offset __RUNTIME_PSEUDO_RELOC_LIST_END__
		jle	short loc_62BA6920
		mov	edi, ds:__RUNTIME_PSEUDO_RELOC_LIST_END__
		test	edi, edi
		jnz	short loc_62BA6920
		mov	esi, ds:dword_62BA9358
		test	esi, esi
		jnz	short loc_62BA6920
		mov	ecx, ds:dword_62BA935C
		test	ecx, ecx
		jnz	short loc_62BA6920
		mov	ebx, offset dword_62BA9360
		nop
		lea	esi, [esi+0]

loc_62BA6920:				; CODE XREF: __pei386_runtime_relocator+46j
					; __pei386_runtime_relocator+50j ...
		mov	edx, [ebx]
		test	edx, edx
		jnz	short loc_62BA6982
		mov	eax, [ebx+4]
		test	eax, eax
		jnz	short loc_62BA6982
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_62BA6A46
		add	ebx, 0Ch
		cmp	ebx, offset __RUNTIME_PSEUDO_RELOC_LIST_END__
		jnb	short loc_62BA68C8
		mov	esi, 62B80000h

loc_62BA6949:				; CODE XREF: __pei386_runtime_relocator+16Dj
		mov	eax, [ebx+4]
		mov	ecx, [ebx]
		movzx	edx, byte ptr [ebx+8]
		add	eax, esi
		add	ecx, esi
		cmp	edx, 10h
		mov	edi, [ecx]
		jz	short loc_62BA69C0
		cmp	edx, 20h
		jz	loc_62BA6A00
		cmp	edx, 8
		jz	short loc_62BA69E0
		mov	[ebp+var_1C], 0
		mov	[esp+4], edx	; char
		mov	dword ptr [esp], offset	aUnknownPseudoR	; "  Unknown pseudo relocation bit size	%d"...
		call	___report_error
; ---------------------------------------------------------------------------

loc_62BA6982:				; CODE XREF: __pei386_runtime_relocator+74j
					; __pei386_runtime_relocator+7Bj
		cmp	ebx, offset __RUNTIME_PSEUDO_RELOC_LIST_END__
		jnb	loc_62BA68C8
		mov	esi, 62B80000h
		lea	edi, [ebp+var_20]

loc_62BA6996:				; CODE XREF: __pei386_runtime_relocator+107j
		mov	eax, [ebx+4]
		mov	ecx, 4		; size_t
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+var_20], edx
		mov	edx, edi	; void *
		call	___write_memory
		cmp	ebx, offset __RUNTIME_PSEUDO_RELOC_LIST_END__
		jb	short loc_62BA6996
		jmp	loc_62BA68C8
; ---------------------------------------------------------------------------
		align 10h

loc_62BA69C0:				; CODE XREF: __pei386_runtime_relocator+ABj
		movzx	edx, word ptr [eax]
		test	dx, dx
		js	short loc_62BA6A37
		sub	edx, ecx
		lea	edi, [edx+edi]
		mov	[ebp+var_1C], edi

loc_62BA69D0:				; CODE XREF: __pei386_runtime_relocator+194j
		mov	ecx, 2		; size_t
		lea	edx, [ebp+var_1C] ; void *
		call	___write_memory
		jmp	short loc_62BA6A14
; ---------------------------------------------------------------------------
		align 10h

loc_62BA69E0:				; CODE XREF: __pei386_runtime_relocator+B9j
		movzx	edx, byte ptr [eax]
		test	dl, dl
		js	short loc_62BA6A28
		sub	edx, ecx
		lea	edi, [edx+edi]
		mov	[ebp+var_1C], edi

loc_62BA69EF:				; CODE XREF: __pei386_runtime_relocator+185j
		mov	ecx, 1		; size_t
		lea	edx, [ebp+var_1C] ; void *
		call	___write_memory
		jmp	short loc_62BA6A14
; ---------------------------------------------------------------------------
		align 10h

loc_62BA6A00:				; CODE XREF: __pei386_runtime_relocator+B0j
		add	edi, [eax]
		lea	edx, [ebp+var_1C] ; void *
		sub	edi, ecx
		mov	ecx, 4		; size_t
		mov	[ebp+var_1C], edi
		call	___write_memory

loc_62BA6A14:				; CODE XREF: __pei386_runtime_relocator+12Dj
					; __pei386_runtime_relocator+14Cj
		add	ebx, 0Ch
		cmp	ebx, offset __RUNTIME_PSEUDO_RELOC_LIST_END__
		jb	loc_62BA6949
		jmp	loc_62BA68C8
; ---------------------------------------------------------------------------

loc_62BA6A28:				; CODE XREF: __pei386_runtime_relocator+135j
		or	edx, 0FFFFFF00h
		sub	edx, ecx
		add	edx, edi
		mov	[ebp+var_1C], edx
		jmp	short loc_62BA69EF
; ---------------------------------------------------------------------------

loc_62BA6A37:				; CODE XREF: __pei386_runtime_relocator+116j
		or	edx, 0FFFF0000h
		sub	edx, ecx
		add	edx, edi
		mov	[ebp+var_1C], edx
		jmp	short loc_62BA69D0
; ---------------------------------------------------------------------------

loc_62BA6A46:				; CODE XREF: __pei386_runtime_relocator+83j
		mov	[esp+4], eax	; char
		mov	dword ptr [esp], offset	aUnknownPseud_0	; "  Unknown pseudo relocation protocol	ve"...
		call	___report_error
__pei386_runtime_relocator endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; void __cdecl __do_global_dtors()
		public ___do_global_dtors
___do_global_dtors proc	near		; DATA XREF: ___do_global_ctors:loc_62BA6ABAo
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, _p_1653
		mov	eax, [eax]
		test	eax, eax
		jz	short locret_62BA6A88

loc_62BA6A71:				; CODE XREF: ___do_global_dtors+26j
		call	eax
		mov	eax, _p_1653
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	_p_1653, edx
		test	eax, eax
		jnz	short loc_62BA6A71

locret_62BA6A88:			; CODE XREF: ___do_global_dtors+Fj
		leave
		retn
___do_global_dtors endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public ___do_global_ctors
___do_global_ctors proc	near		; CODE XREF: ___main+1Dj
		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 10h
		mov	ebx, ds:___CTOR_LIST__
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_62BA6AD0

loc_62BA6AA3:				; CODE XREF: ___do_global_ctors+54j
		test	ebx, ebx
		jz	short loc_62BA6ABA
		lea	esi, ___CTOR_LIST__[ebx*4]
		xchg	ax, ax

loc_62BA6AB0:				; CODE XREF: ___do_global_ctors+28j
		call	dword ptr [esi]
		sub	esi, 4
		sub	ebx, 1
		jnz	short loc_62BA6AB0

loc_62BA6ABA:				; CODE XREF: ___do_global_ctors+15j
		mov	dword ptr [esp], offset	___do_global_dtors ; void (__cdecl *)()
		call	_atexit
		add	esp, 10h
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_62BA6AD0:				; CODE XREF: ___do_global_ctors+11j
		xor	ebx, ebx
		jmp	short loc_62BA6AD6
; ---------------------------------------------------------------------------

loc_62BA6AD4:				; CODE XREF: ___do_global_ctors+52j
		mov	ebx, eax

loc_62BA6AD6:				; CODE XREF: ___do_global_ctors+42j
		lea	eax, [ebx+1]
		mov	edx, ds:___CTOR_LIST__[eax*4]
		test	edx, edx
		jnz	short loc_62BA6AD4
		jmp	short loc_62BA6AA3
___do_global_ctors endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public ___main
___main		proc near		; CODE XREF: _DllMainCRTStartup@12+7Dp
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	ecx, ds:_initialized
		test	ecx, ecx
		jz	short loc_62BA6B02
		leave
		retn
; ---------------------------------------------------------------------------

loc_62BA6B02:				; CODE XREF: ___main+Ej
		mov	ds:_initialized, 1
		leave
		jmp	short ___do_global_ctors
___main		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
		public _DllMain@12
_DllMain@12	proc near		; CODE XREF: _DllMainCRTStartup@12+28p
					; _DllMainCRTStartup@12+91p

hinstDLL	= dword	ptr  8
fdwReason	= dword	ptr  0Ch
lpvReserved	= dword	ptr  10h

		push	ebp
		mov	eax, 1
		mov	ebp, esp
		pop	ebp
		retn	0Ch
_DllMain@12	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _stricmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ___dllonexit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _strcspn]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _atoi]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _strrchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _GetModuleHandleA@4]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _GetProcAddress@8]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _Sleep@4]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _VirtualQuery@12]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _VirtualProtect@16]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_register_frame_ctor proc near		; DATA XREF: .text:___CTOR_LIST__o
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	___gcc_register_frame
		mov	dword ptr [esp], offset	___gcc_deregister_frame	; void (__cdecl	*)()
		call	_atexit
		leave
		retn
_register_frame_ctor endp

; ---------------------------------------------------------------------------
		align 4
		public ___CTOR_LIST__
; func_ptr __CTOR_LIST__[2]
___CTOR_LIST__	dd 0FFFFFFFFh, offset _register_frame_ctor
					; DATA XREF: ___do_global_ctors+8r
					; ___do_global_ctors+17o ...
		align 8
		public __DTOR_LIST__
; func_ptr _DTOR_LIST__[2]
__DTOR_LIST__	dd 0FFFFFFFFh, 0	; DATA XREF: .data:_p_1653o
		dd 100h	dup(?)
_text		ends

; Section 2. (virtual address 00027000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00026200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 62BA7000h
		public __data_start__
; SilcPacketCallbacks _data_start__
__data_start__	SilcPacketCallbacks <offset _silc_client_packet_receive, \
					; DATA XREF: _silc_client_init+1B0o
				     offset _silc_client_packet_eos, \
				     offset _silc_client_packet_error>
; SilcPacketCallbacks silc_client_listener_stream_cb
_silc_client_listener_stream_cb	SilcPacketCallbacks <offset _silc_client_udp_accept, 0,	0>
					; DATA XREF: _silc_client_listener_add+199o
_p_1653		dd offset __DTOR_LIST__+4 ; DATA XREF: ___do_global_dtors+6r
					; ___do_global_dtors+13r ...
___JCR_END__	dd 0			; DATA XREF: ___gcc_register_frame:loc_62B811BFr
					; ___gcc_register_frame+71o
		public __data_end__
__data_end__	dd 78h dup(0)
		align 1000h
_data		ends

; Section 3. (virtual address 00028000)
; Virtual size			: 00001354 (   4948.)
; Section size in file		: 00001400 (   5120.)
; Offset to raw	data for section: 00026400
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 62BA8000h
; CHAR ModuleName[]
ModuleName	db 'libgcc_s_dw2-1.dll',0 ; DATA XREF: ___gcc_register_frame+6o
					; ___gcc_deregister_frame+6o
; CHAR ProcName[]
ProcName	db '__register_frame_info',0 ; DATA XREF: ___gcc_register_frame+17o
; CHAR aLibgcj_s_dll[]
aLibgcj_s_dll	db 'libgcj_s.dll',0     ; DATA XREF: ___gcc_register_frame+49o
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: ___gcc_register_frame+5Ao
; CHAR a__deregister_f[]
a__deregister_f	db '__deregister_frame_info',0 ; DATA XREF: ___gcc_deregister_frame+17o
		align 4
aAttemptingToSt	db 'Attempting to stop client library before it has been started (sil'
					; DATA XREF: _silc_client_stop:loc_62B8132Co
		db 'c_client_init not called)',0
		align 10h
off_62BA80C0	dd offset loc_62B81494	; DATA XREF: _silc_client_packet_receive+16r
		dd offset loc_62B81494	; jump table for switch	statement
		dd offset loc_62B815A4
		dd offset loc_62B815A4
		dd offset loc_62B815A4
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B815A4
		dd offset loc_62B815A4
		dd offset loc_62B815A4
		dd offset loc_62B81494
		dd offset loc_62B815A4
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B81494
		dd offset loc_62B815A4
		dd offset loc_62B815A4
aUsernameAndHos	db 'Username and hostname must be given to silc_client_init',0
					; DATA XREF: _silc_client_init:loc_62B818C4o
aMalformedUsern	db 'Malformed username ',27h,'%s',27h,'. Username must be UTF-8 string',0
					; DATA XREF: _silc_client_init+252o
		align 4
aMalformedHostn	db 'Malformed hostname ',27h,'%s',27h,'. Hostname must be UTF-8 string',0
					; DATA XREF: _silc_client_init+29Bo
		align 4
aMalformedRealn	db 'Malformed realname ',27h,'%s',27h,'. Realname must be UTF-8 string',0
					; DATA XREF: _silc_client_init+28Bo
aSilc1_21_1_10S	db 'SILC-1.2-1.1.10 silc-toolkit',0
					; DATA XREF: _silc_client_alloc:loc_62B81B80o
off_62BA8220	dd offset loc_62B81E5B	; DATA XREF: _silc_client_connection_st_packet+2Cr
		dd offset loc_62B81E90	; jump table for switch	statement
		dd offset loc_62B81E5B
		dd offset loc_62B81E5B
		dd offset loc_62B81E5B
		dd offset loc_62B81EA4
		dd offset loc_62B81EB8
		dd offset loc_62B81ECC
		dd offset loc_62B81EE0
		dd offset loc_62B81EF8
		dd offset loc_62B81F10
		dd offset loc_62B81F28
		dd offset loc_62B81F40
		dd offset loc_62B81E5B
		dd offset loc_62B81E5B
		dd offset loc_62B81E5B
		dd offset loc_62B81F58
		dd offset loc_62B81E5B
		dd offset loc_62B81F70
		dd offset loc_62B81E5B
		dd offset loc_62B81E5B
		dd offset loc_62B81E5B
		dd offset loc_62B81F88
		dd offset loc_62B81E5B
		dd offset loc_62B81E5B
		dd offset loc_62B81FB4
		dd offset loc_62B81E5B
		dd offset loc_62B81E7C
aSha1		db 'sha1',0             ; DATA XREF: _silc_client_add_connection+C7o
		align 4
aClientLibraryI	db 'Client library is not started yet. SilcClientRunning callback has'
					; DATA XREF: _silc_client_key_exchange:loc_62B82A54o
					; _silc_client_connect_to_client:loc_62B82B64o	...
		db ' not been called yet.',0
		align 10h
aSocketStreamDo	db 'Socket stream does not have remote host name set',0
					; DATA XREF: _silc_client_key_exchange:loc_62B82A78o
		align 4
aConnectingToPo	db 'Connecting to port %d of server %s',0
					; DATA XREF: _silc_client_connect_to_server+89o
		align 4
aSilcRsa	db 'silc-rsa',0         ; DATA XREF: _silc_client_attributes_process+23o
		align 4
aAes256Cbc	db 'aes-256-cbc',0      ; DATA XREF: _silc_client_add_channel_private_key:loc_62B837D8o
aHmacSha196	db 'hmac-sha1-96',0     ; DATA XREF: _silc_client_add_channel_private_key:loc_62B837E8o
					; _silc_client_save_channel_key:loc_62B84A44o
		align 10h
aCannotTalkToCh	db 'Cannot talk to channel: not joined',0
					; DATA XREF: _silc_client_send_channel_message+251o
		align 4
aNoCipherAndHma	db 'No cipher and HMAC for channel',0
					; DATA XREF: _silc_client_send_channel_message:loc_62B83E2Ao
		align 4
aErrorEncodingC	db 'Error encoding channel message',0
					; DATA XREF: _silc_client_send_channel_message:loc_62B83E7Fo
aClient_channel	db 'client_channel.c',0 ; DATA XREF: _silc_client_channel_message+1F4o
aSilc_verifySD	db 'SILC_VERIFY %s:%d',0 ; DATA XREF: _silc_client_channel_message+1FCo
		align 4
aMessageFromUse	db 'Message from user not on channel, client or server bug',0
					; DATA XREF: _silc_client_channel_message:loc_62B842A8o
		align 10h
aCannotTalkTo_0	db 'Cannot talk to channel: unsupported cipher %s',0
					; DATA XREF: _silc_client_save_channel_key+375o
					; _silc_client_save_channel_key+425o
		align 10h
aCannotTalkTo_1	db 'Cannot talk to channel: unsupported HMAC %s',0
					; DATA XREF: _silc_client_save_channel_key+451o
aClient_connect	db 'client_connect.c',0 ; DATA XREF: _silc_client_st_rekey+140o
					; _silc_client_st_rekey+174o ...
aSilc_verifyS_0	db 'SILC_VERIFY %s:%d',0 ; DATA XREF: _silc_client_st_rekey+148o
					; _silc_client_st_rekey+17Co ...
		align 10h
aErrorDuringRek	db 'Error during rekey with %s: %s',0
					; DATA XREF: _silc_client_rekey_completion+89o
aAuthentication	db 'Authentication failed',0
					; DATA XREF: _silc_client_connect_auth_completion+A1o
		align 4
aCouldNotConn_3	db 'Could not connect to host %s: unknown IP address',0
					; DATA XREF: _silc_client_connect_callback+135o
		align 4
aCouldNotConn_2	db 'Could not connect to host %s: unknown host name',0
					; DATA XREF: _silc_client_connect_callback+11Do
aCouldNotConn_1	db 'Could not connect to host %s: network unreachable',0
					; DATA XREF: _silc_client_connect_callback+105o
		align 10h
aCouldNotConn_0	db 'Could not connect to host %s: connection refused',0
					; DATA XREF: _silc_client_connect_callback+B9o
		align 4
aCouldNotConn_4	db 'Could not connect to host %s: connection timeout',0
					; DATA XREF: _silc_client_connect_callback+14Do
aCouldNotConnec	db 'Could not connect to host %s',0
					; DATA XREF: _silc_client_connect_callback+4Ao
		align 4
off_62BA8604	dd offset loc_62B866D4	; DATA XREF: _silc_client_connect_callback:loc_62B866F4r
		dd offset loc_62B86788	; jump table for switch	statement
		dd offset loc_62B86770
		dd offset loc_62B86758
		dd offset loc_62B8670C
		dd offset loc_62B867A0
aErrorDuringKey	db 'Error during key exchange with %s: %s',0
					; DATA XREF: _silc_client_ke_completion+12Do
		align 4
aErrorDuringK_0	db 'Error during key exchange with %s: cannot use keys',0
					; DATA XREF: _silc_client_ke_completion+161o
					; _silc_client_ke_completion+1DAo
		align 4
aLocalUdpIpAddr	db 'Local UDP IP address not specified',0
					; DATA XREF: _silc_client_st_connect:loc_62B870C4o
		align 4
aMissingArgumen	db 'Missing arguments to silc_client_get_clients call',0
					; DATA XREF: _silc_client_get_clients_i:loc_62B88B6Co
a@_0		db '@',0                ; DATA XREF: _silc_client_get_clients_i+19Bo
aS_2		db '%s',0               ; DATA XREF: _silc_client_nickname_format+58Eo
					; _silc_client_update_client+D3o ...
; char a_[]
a_		db '.',0                ; DATA XREF: _silc_client_nickname_format+2AFo
; char asc_62BA86D5[]
asc_62BA86D5	db '-',0                ; DATA XREF: _silc_client_nickname_format+2CDo
aD		db '%d',0               ; DATA XREF: _silc_client_nickname_format+3DAo
		align 4
aMissingArgum_0	db 'Missing arguments to silc_client_get_clients_by_id_resolve call',0
					; DATA XREF: _silc_client_get_client_by_id_resolve:loc_62B8B8B4o
aClient_ftp_c	db 'client_ftp.c',0     ; DATA XREF: _silc_client_ftp+2B6o
aSilc_verifyS_1	db 'SILC_VERIFY %s:%d',0 ; DATA XREF: _silc_client_ftp+2BEo
byte_62BA873B	db 0			; DATA XREF: _silc_client_ftp_version+AEo
					; _silc_client_ftp_open_handle:loc_62B8C49Co
aSS		db '%s%s',0             ; DATA XREF: _silc_client_ftp_open_handle+DFo
aFileSOpenFaile	db 'File `%s',27h,' open failed: %s',0
					; DATA XREF: _silc_client_ftp_open_handle+1FCo
		align 4
aCannotCreateLi	db 'Cannot create listener for file transfer; IP address and/or port '
					; DATA XREF: _silc_client_file_receive+2EAo
		db 'not provided',0
		align 4
aCannotCreate_0	db 'Cannot create listener for file transfer: %s',0
					; DATA XREF: _silc_client_file_receive+34Eo
					; _silc_client_file_send+44Co
aFileS		db 'file://%s',0        ; DATA XREF: _silc_client_file_send+17Bo
		align 4
aClient_keyagr_	db 'client_keyagr.c',0  ; DATA XREF: _silc_client_key_agreement+1D8o
aSilc_verifyS_2	db 'SILC_VERIFY %s:%d',0 ; DATA XREF: _silc_client_key_agreement+1E0o
		align 4
aCannotCreateUd	db 'Cannot create UDP listener on %s on port %d: %s',0
					; DATA XREF: _silc_client_listener_add+25Ao
aCannotCreate_1	db 'Cannot create listener on %s on port %d: %s',0
					; DATA XREF: _silc_client_listener_add+2CDo
aClient_notify_	db 'client_notify.c',0  ; DATA XREF: _silc_client_notify_watch+2ECo
					; _silc_client_notify_killed+383o ...
aSilc_verifyS_3	db 'SILC_VERIFY %s:%d',0 ; DATA XREF: _silc_client_notify_watch+2F4o
					; _silc_client_notify_killed+38Bo ...
		align 4
off_62BA8888	dd offset loc_62B924E8	; DATA XREF: _silc_client_notify+B3r
		dd offset loc_62B924CC	; jump table for switch	statement
		dd offset loc_62B924B0
		dd offset loc_62B92494
		dd offset loc_62B92478
		dd offset loc_62B9245C
		dd offset loc_62B92440
		dd offset loc_62B92424
		dd offset loc_62B92408
		dd offset loc_62B923EC
		dd offset loc_62B923D0
		dd offset loc_62B923B4
		dd offset loc_62B92398
		dd offset loc_62B92380
		dd offset loc_62B922E5
		dd offset loc_62B922E5
		dd offset loc_62B92368
		dd offset loc_62B92350
aAes256Cbc_0	db 'aes-256-cbc',0      ; DATA XREF: _silc_client_add_private_message_key_ske:loc_62B929A4o
					; _silc_client_add_private_message_key:loc_62B92C60o
aHmacSha196_0	db 'hmac-sha1-96',0     ; DATA XREF: _silc_client_add_private_message_key_ske:loc_62B929B0o
					; _silc_client_add_private_message_key:loc_62B92C6Co
aClient_prvmsg_	db 'client_prvmsg.c',0  ; DATA XREF: _silc_client_private_message_key+C4o
					; _silc_client_private_message+2A8o
aSilc_verifyS_4	db 'SILC_VERIFY %s:%d',0 ; DATA XREF: _silc_client_private_message_key+CCo
					; _silc_client_private_message+2B0o
		align 4
aErrorEncodingP	db 'Error encoding private message',0
					; DATA XREF: _silc_client_send_private_message:loc_62B93228o
		align 4
aNick		db 'NICK',0             ; DATA XREF: _silc_client_st_register_complete+219o
		align 4
aUsageSilcoperU	db 'Usage: /SILCOPER <username> [-pubkey]',0
					; DATA XREF: _silc_client_command_silcoper+B5o
aCommand_c	db 'command.c',0        ; DATA XREF: _silc_client_command_silcoper+120o
					; _silc_client_command_oper+120o ...
aSilc_verifyS_5	db 'SILC_VERIFY %s:%d',0 ; DATA XREF: _silc_client_command_silcoper+128o
					; _silc_client_command_oper+128o ...
		align 4
aUsageOperUsern	db 'Usage: /OPER <username> [-pubkey]',0
					; DATA XREF: _silc_client_command_oper+B5o
		align 4
aYouAreNotConne	db 'You are not connected to a server, please connect to server',0
					; DATA XREF: _silc_client_command_call+35Eo
; char asc_62BA89D8[]
asc_62BA89D8	db ' ',0                ; DATA XREF: _silc_client_command_call+3Eo
aUsageUmodeMode	db 'Usage: /UMODE +|-<modes>',0 ; DATA XREF: _silc_client_command_umode+2EFo
		align 4
off_62BA89F4	dd offset loc_62B95F38	; DATA XREF: _silc_client_command_umode+B7r
		dd offset loc_62B95D43	; jump table for switch	statement
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95F14
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95F58
		dd offset loc_62B95F28
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95F48
		dd offset loc_62B95F00
		dd offset loc_62B95EEC
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95EC4
		dd offset loc_62B95D43
		dd offset loc_62B95ED8
		dd offset loc_62B95EB0
		dd offset loc_62B95E9C
		dd offset loc_62B95D43
		dd offset loc_62B95D43
		dd offset loc_62B95D9C
aUsageMotdServe	db 'Usage: /MOTD [<server>]',0 ; DATA XREF: _silc_client_command_motd+23o
aUsageUsersChan	db 'Usage: /USERS <channel>',0 ; DATA XREF: _silc_client_command_users+21o
aS		db '%s',0               ; DATA XREF: _silc_client_command_users+1AAo
					; _silc_client_command_leave+2D6o ...
byte_62BA8AE3	db 0			; DATA XREF: _silc_client_command_users+160o
					; _silc_client_command_leave+1F9o ...
a@		db '@',0                ; DATA XREF: _silc_client_command_users:loc_62B964D4o
					; _silc_client_command_leave:loc_62B96804o ...
aSSS		db '%s%s%s',0           ; DATA XREF: _silc_client_command_users+176o
					; _silc_client_command_leave+20Fo ...
aUsageLeaveChan	db 'Usage: /LEAVE <channel>',0 ; DATA XREF: _silc_client_command_leave+21o
		align 4
aUsageKickChann	db 'Usage: /KICK <channel> <nickname> [<comment>]',0
					; DATA XREF: _silc_client_command_kick+304o
aNoSuchClientS	db 'No such client: %s',0 ; DATA XREF: _silc_client_command_kick+582o
		align 4
aUsageBanChanne	db 'Usage: /BAN <channel> [+|-[<nickname>[@<server>[!<username>[@host'
					; DATA XREF: _silc_client_command_ban+34Do
		db 'name>]]]]]',0
aUsageKillNickn	db 'Usage: /KILL <nickname> [<comment>] [-pubkey]',0
					; DATA XREF: _silc_client_command_kill+250o
; char aPubkey[]
aPubkey		db '-pubkey',0          ; DATA XREF: _silc_client_command_kill:loc_62B979ECo
					; _silc_client_command_kill:loc_62B97A1Do ...
		align 10h
aUsageInviteCha	db 'Usage: /INVITE <channel> [<nickname>[@server>][+|-[<nickname>[@<s'
					; DATA XREF: _silc_client_command_invite+315o
		db 'erver>[!<username>[@hostname>]]]]]',0
aUsageCumodeCha	db 'Usage: /CUMODE <channel> +|-<modes> <nickname>[@<server>]',0
					; DATA XREF: _silc_client_command_cumode+1C1o
		align 10h
aCouldNotLoadKe	db 'Could not load key pair, check your arguments',0
					; DATA XREF: _silc_client_command_cumode+85Co
					; _silc_client_command_cmode+AF4o ...
		align 10h
off_62BA8CA0	dd offset loc_62B98924	; DATA XREF: _silc_client_command_cumode+2B3r
		dd offset loc_62B98838	; jump table for switch	statement
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B9884C
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B98824
		dd offset loc_62B98466
		dd offset loc_62B98810
		dd offset loc_62B987FC
		dd offset loc_62B98466
		dd offset loc_62B98466
		dd offset loc_62B985E4
aUsageCmodeChan	db 'Usage: /CMODE <channel> +|-<modes> [{ <arguments>}]',0
					; DATA XREF: _silc_client_command_cmode+3F9o
					; _silc_client_command_cmode+973o
aCouldNotLoadPu	db 'Could not load public key %s, check the filename',0
					; DATA XREF: _silc_client_command_cmode+8AEo
					; _silc_client_command_whois+178o ...
		align 4
off_62BA8D5C	dd offset loc_62B98FA0	; DATA XREF: _silc_client_command_cmode+157r
		dd offset loc_62B98CB1	; jump table for switch	statement
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98F88
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98F54
		dd offset loc_62B98CB1
		dd offset loc_62B98F20
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98E58
		dd offset loc_62B98CB1
		dd offset loc_62B98E24
		dd offset loc_62B98E10
		dd offset loc_62B98CB1
		dd offset loc_62B98DFC
		dd offset loc_62B98DA4
		dd offset loc_62B98D8C
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98D78
		dd offset loc_62B98CB1
		dd offset loc_62B98CB1
		dd offset loc_62B98D64
		dd offset loc_62B98D50
aUsageWhowasNic	db 'Usage: /WHOWAS <nickname>[@<server>] [<count>]',0
					; DATA XREF: _silc_client_command_whowas+23o
; char aCipher[]
aCipher		db '-cipher',0          ; DATA XREF: _silc_client_command_join+242o
; char aHmac[]
aHmac		db '-hmac',0            ; DATA XREF: _silc_client_command_join:loc_62B99C5Fo
; char aFounder[]
aFounder	db '-founder',0         ; DATA XREF: _silc_client_command_join:loc_62B99C9Co
; char aAuth[]
aAuth		db '-auth',0            ; DATA XREF: _silc_client_command_join:loc_62B99D18o
aUsageNickNickn	db 'Usage: /NICK <nickname>',0 ; DATA XREF: _silc_client_command_nick+D1o
aYourNicknameIs	db 'Your nickname is %s on server %s',0
					; DATA XREF: _silc_client_command_nick+63o
aYourNickname_0	db 'Your nickname is %s',0 ; DATA XREF: _silc_client_command_nick+29Bo
; char aDetails[]
aDetails	db '-details',0         ; DATA XREF: _silc_client_command_whois+65o
aSilcRsa_0	db 'silc-rsa',0         ; DATA XREF: _silc_client_command_whois:loc_62B9ACD2o
aSshRsa		db 'ssh-rsa',0          ; DATA XREF: _silc_client_command_whois:loc_62B9ACBAo
aX509v3SignRsa	db 'x509v3-sign-rsa',0  ; DATA XREF: _silc_client_command_whois:loc_62B9ACC6o
aPgpSignRsa	db 'pgp-sign-rsa',0     ; DATA XREF: _silc_client_command_whois+25Co
aUsageGetkeyNic	db 'Usage: /GETKEY <nickname or server name>',0
					; DATA XREF: _silc_client_command_getkey+16Co
		align 10h
aUsageTopicChan	db 'Usage: /TOPIC <channel> [<topic>]',0
					; DATA XREF: _silc_client_command_topic+26o
; char aAdd[]
aAdd		db '-add',0             ; DATA XREF: _silc_client_command_watch:loc_62B9B63Co
; char aDel[]
aDel		db '-del',0             ; DATA XREF: _silc_client_command_watch:loc_62B9B788o
; char aWhois[]
aWhois		db 'WHOIS',0            ; DATA XREF: _silc_client_commands_register+74o
; char aWhowas[]
aWhowas		db 'WHOWAS',0           ; DATA XREF: _silc_client_commands_register+EFo
; char aIdentify[]
aIdentify	db 'IDENTIFY',0         ; DATA XREF: _silc_client_commands_register+16Ao
; char aNick_0[]
aNick_0		db 'NICK',0             ; DATA XREF: _silc_client_commands_register+1E5o
; char aList[]
aList		db 'LIST',0             ; DATA XREF: _silc_client_commands_register+260o
; char name[]
name		db 'TOPIC',0            ; DATA XREF: _silc_client_commands_register+2C2o
; char aInvite[]
aInvite		db 'INVITE',0           ; DATA XREF: _silc_client_commands_register+303o
; char aQuit[]
aQuit		db 'QUIT',0             ; DATA XREF: _silc_client_commands_register+37Eo
; char aKill[]
aKill		db 'KILL',0             ; DATA XREF: _silc_client_commands_register+3F9o
; char aInfo[]
aInfo		db 'INFO',0             ; DATA XREF: _silc_client_commands_register+474o
; char aStats[]
aStats		db 'STATS',0            ; DATA XREF: _silc_client_commands_register+4EFo
; char aPing[]
aPing		db 'PING',0             ; DATA XREF: _silc_client_commands_register+56Ao
; char aOper[]
aOper		db 'OPER',0             ; DATA XREF: _silc_client_commands_register+5E5o
; char aJoin[]
aJoin		db 'JOIN',0             ; DATA XREF: _silc_client_commands_register+660o
; char aMotd[]
aMotd		db 'MOTD',0             ; DATA XREF: _silc_client_commands_register+6DBo
; char aUmode[]
aUmode		db 'UMODE',0            ; DATA XREF: _silc_client_commands_register+756o
; char aCmode[]
aCmode		db 'CMODE',0            ; DATA XREF: _silc_client_commands_register+7D1o
; char aCumode[]
aCumode		db 'CUMODE',0           ; DATA XREF: _silc_client_commands_register+84Co
; char aKick[]
aKick		db 'KICK',0             ; DATA XREF: _silc_client_commands_register+8C7o
; char aBan[]
aBan		db 'BAN',0              ; DATA XREF: _silc_client_commands_register+942o
; char aDetach[]
aDetach		db 'DETACH',0           ; DATA XREF: _silc_client_commands_register+9BDo
; char aWatch[]
aWatch		db 'WATCH',0            ; DATA XREF: _silc_client_commands_register+A38o
; char aSilcoper[]
aSilcoper	db 'SILCOPER',0         ; DATA XREF: _silc_client_commands_register+A9Ao
; char aLeave[]
aLeave		db 'LEAVE',0            ; DATA XREF: _silc_client_commands_register+AC2o
; char aUsers[]
aUsers		db 'USERS',0            ; DATA XREF: _silc_client_commands_register+AEAo
; char aGetkey[]
aGetkey		db 'GETKEY',0           ; DATA XREF: _silc_client_commands_register+B12o
; char aService[]
aService	db 'SERVICE',0          ; DATA XREF: _silc_client_commands_register+B53o
		align 10h
aCannotGetServi	db 'Cannot get service: %s',0
					; DATA XREF: _silc_client_command_reply_service+13Ao
aCannotSetWatch	db 'Cannot set watch: %s',0
					; DATA XREF: _silc_client_command_reply_watch+13Eo
aCannotChangeMo	db 'Cannot change mode: %s',0
					; DATA XREF: _silc_client_command_reply_oper+13Eo
					; _silc_client_command_reply_silcoper+13Eo ...
aCannotKickS	db 'Cannot kick: %s',0  ; DATA XREF: _silc_client_command_reply_kick+147o
aCannotKillS	db 'Cannot kill: %s',0  ; DATA XREF: _silc_client_command_reply_kill+157o
aWhowasS	db 'WHOWAS: %s',0       ; DATA XREF: _silc_client_command_reply_whowas+147o
aCannotGetKeyS	db 'Cannot get key: %s',0
					; DATA XREF: _silc_client_command_reply_getkey+157o
		align 4
aCannotDecodePu	db 'Cannot decode public key: malformed/unsupported public key',0
					; DATA XREF: _silc_client_command_reply_getkey+37Co
aCannotGetUsers	db 'Cannot get users: %s',0
					; DATA XREF: _silc_client_command_reply_users+15Ao
aCommand_reply_	db 'command_reply.c',0  ; DATA XREF: _silc_client_command_reply_users+43Co
					; _silc_client_command_reply_users+496o ...
aSilc_verifyS_6	db 'SILC_VERIFY %s:%d',0 ; DATA XREF: _silc_client_command_reply_users+444o
					; _silc_client_command_reply_users+49Eo ...
aCannotSetLeave	db 'Cannot set leave: %s',0
					; DATA XREF: _silc_client_command_reply_leave+157o
aCannotSetBanS	db 'Cannot set ban: %s',0 ; DATA XREF: _silc_client_command_reply_ban+157o
aCannotInviteS	db 'Cannot invite: %s',0 ; DATA XREF: _silc_client_command_reply_invite+157o
aCannotDetachS	db 'Cannot detach: %s',0 ; DATA XREF: _silc_client_command_reply_detach+143o
aCannotGetMotdS	db 'Cannot get motd: %s',0 ; DATA XREF: _silc_client_command_reply_motd+172o
aS_0		db '%s',0               ; DATA XREF: _silc_client_command_reply_motd+2DAo
aCannotListChan	db 'Cannot list channels: %s',0
					; DATA XREF: _silc_client_command_reply_list+17Bo
aCannotSetTopic	db 'Cannot set topic: %s',0
					; DATA XREF: _silc_client_command_reply_topic+157o
aCannotJoinChan	db 'Cannot join channel: %s',0
					; DATA XREF: _silc_client_command_reply_join+162o
		align 10h
aCannotJoinCh_0	db 'Cannot join channel: Unsupported HMAC `%s',27h,0
					; DATA XREF: _silc_client_command_reply_join+564o
aS_1		db 's',0                ; DATA XREF: _silc_client_command_reply_ping+4Ao
byte_62BA91BD	db 3 dup(0)		; DATA XREF: _silc_client_command_reply_ping:loc_62BA4024o
aPingReplyFromS	db 'Ping reply from %s: %d second%s',0
					; DATA XREF: _silc_client_command_reply_ping+5Eo
aCannotGetStats	db 'Cannot get stats: %s',0
					; DATA XREF: _silc_client_command_reply_stats+162o
aCannotGetInfoS	db 'Cannot get info: %s',0 ; DATA XREF: _silc_client_command_reply_info+147o
aCannotSetNickn	db 'Cannot set nickname: %s',0
					; DATA XREF: _silc_client_command_reply_nick+163o
aIdentifyS	db 'IDENTIFY: %s',0     ; DATA XREF: _silc_client_command_reply_identify+157o
aWhoisS		db 'WHOIS: %s',0        ; DATA XREF: _silc_client_command_reply_whois+160o
off_62BA9238	dd offset loc_62BA5AA9	; DATA XREF: _silc_client_command_reply_process+40r
		dd offset loc_62BA5D20	; jump table for switch	statement
		dd offset loc_62BA5D08
		dd offset loc_62BA5CF0
		dd offset loc_62BA5CD8
		dd offset loc_62BA5CC0
		dd offset loc_62BA5CA8
		dd offset loc_62BA5C90
		dd offset loc_62BA5C78
		dd offset loc_62BA5C60
		dd offset loc_62BA5C48
		dd offset loc_62BA5C30
		dd offset loc_62BA5C18
		dd offset loc_62BA5C00
		dd offset loc_62BA5BE8
		dd offset loc_62BA5BD0
		dd offset loc_62BA5BB8
		dd offset loc_62BA5BA0
		dd offset loc_62BA5B88
		dd offset loc_62BA5B70
		dd offset loc_62BA5B58
		dd offset loc_62BA5B40
		dd offset loc_62BA5B28
		dd offset loc_62BA5B14
		dd offset loc_62BA5B00
		dd offset loc_62BA5AEC
		dd offset loc_62BA5AD8
		dd offset loc_62BA5AC4
aMingwRuntimeFa	db 'Mingw runtime failure:',0Ah,0 ; DATA XREF: ___report_error+2Co
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: ___write_memory+C6o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: __pei386_runtime_relocator+19Ao
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: __pei386_runtime_relocator+C6o
		align 4
		public __RUNTIME_PSEUDO_RELOC_LIST_END__
__RUNTIME_PSEUDO_RELOC_LIST_END__ dd 0	; DATA XREF: __pei386_runtime_relocator:loc_62BA68D5o
					; __pei386_runtime_relocator+2Ao ...
dword_62BA9358	dd 0			; DATA XREF: __pei386_runtime_relocator+52r
dword_62BA935C	dd 0			; DATA XREF: __pei386_runtime_relocator+5Cr
dword_62BA9360	dd 28h dup(0)		; DATA XREF: __pei386_runtime_relocator+66o
		align 1000h
_rdata		ends

; Section 4. (virtual address 0002A000)
; Virtual size			: 00000004 (	  4.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00027800
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_eh_frame	segment	dword public 'DATA' use32
		assume cs:_eh_frame
		;org 62BAA000h
___FRAME_END__	dd 80h dup(0)		; DATA XREF: ___gcc_register_frame+36o
					; ___gcc_deregister_frame+2Eo
		align 1000h
_eh_frame	ends

; Section 5. (virtual address 0002B000)
; Virtual size			: 00000084 (	132.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0400080: Bss Readable Writable
; Alignment	: 8 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment 'qword' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 62BAB000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
		public __bss_start__
; void *_bss_start__
__bss_start__	dd ?			; DATA XREF: __onexit+11o _atexit+11o	...
		align 10h
_next_atexit	dd ?			; DATA XREF: __onexit+9o _atexit+9o ...
		align 10h
_obj		dd 8 dup(?)		; DATA XREF: ___gcc_register_frame+2Eo
_was_init_31080	dd ?			; DATA XREF: __pei386_runtime_relocator+6r
					; __pei386_runtime_relocator+32w
		align 10h
_initialized	dd ?			; DATA XREF: ___main+6r
					; ___main:loc_62BA6B02w
		dd 4 dup(?)
_bss		dd 8 dup(?)
		public __bss_end__
__bss_end__	dd 3DFh	dup(?)
_bss		ends

; Section 7. (virtual address 0002F000)
; Virtual size			: 000027E0 (  10208.)
; Section size in file		: 00002800 (  10240.)
; Offset to raw	data for section: 00029E00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __head_libsilc_1_1_2_dll

;
; Imports from libsilc-1-1-2.dll
;
		extrn __imp__silc_argument_get_arg_num:dword
					; DATA XREF: _silc_argument_get_arg_numr
		extrn __imp__silc_argument_get_arg_type:dword
					; DATA XREF: _silc_argument_get_arg_typer
		extrn __imp__silc_argument_get_decoded:dword
					; DATA XREF: _silc_argument_get_decodedr
		extrn __imp__silc_argument_list_free:dword
					; DATA XREF: _silc_argument_list_freer
		extrn __imp__silc_argument_list_parse:dword
					; DATA XREF: _silc_argument_list_parser
		extrn __imp__silc_argument_list_parse_decoded:dword
					; DATA XREF: _silc_argument_list_parse_decodedr
		extrn __imp__silc_argument_payload_encode_one:dword
					; DATA XREF: _silc_argument_payload_encode_oner
		extrn __imp__silc_argument_payload_free:dword
					; DATA XREF: _silc_argument_payload_freer
		extrn __imp__silc_asprintf:dword ; DATA	XREF: _silc_asprintfr
		extrn __imp__silc_async_abort:dword ; DATA XREF: _silc_async_abortr
		extrn __imp__silc_async_alloc:dword ; DATA XREF: _silc_async_allocr
		extrn __imp__silc_async_free:dword ; DATA XREF:	_silc_async_freer
		extrn __imp__silc_attribute_get_attribute:dword
					; DATA XREF: _silc_attribute_get_attributer
		extrn __imp__silc_attribute_get_data:dword
					; DATA XREF: _silc_attribute_get_datar
		extrn __imp__silc_attribute_payload_alloc:dword
					; DATA XREF: _silc_attribute_payload_allocr
		extrn __imp__silc_attribute_payload_encode:dword
					; DATA XREF: _silc_attribute_payload_encoder
		extrn __imp__silc_attribute_payload_encode_data:dword
					; DATA XREF: _silc_attribute_payload_encode_datar
		extrn __imp__silc_attribute_payload_free:dword
					; DATA XREF: _silc_attribute_payload_freer
		extrn __imp__silc_attribute_payload_list_free:dword
					; DATA XREF: _silc_attribute_payload_list_freer
		extrn __imp__silc_attribute_payload_parse:dword
					; DATA XREF: _silc_attribute_payload_parser
		extrn __imp__silc_auth_payload_encode:dword
					; DATA XREF: _silc_auth_payload_encoder
		extrn __imp__silc_auth_public_key_auth_generate:dword
					; DATA XREF: _silc_auth_public_key_auth_generater
		extrn __imp__silc_auth_public_key_auth_generate_wpub:dword
					; DATA XREF: _silc_auth_public_key_auth_generate_wpubr
		extrn __imp__silc_buffer_format:dword ;	DATA XREF: _silc_buffer_formatr
		extrn __imp__silc_buffer_unformat:dword	; DATA XREF: _silc_buffer_unformatr
		extrn __imp__silc_calloc:dword ; DATA XREF: _silc_callocr
		extrn __imp__silc_channel_key_get_cipher:dword
					; DATA XREF: _silc_channel_key_get_cipherr
		extrn __imp__silc_channel_key_get_id:dword
					; DATA XREF: _silc_channel_key_get_idr
		extrn __imp__silc_channel_key_get_key:dword
					; DATA XREF: _silc_channel_key_get_keyr
		extrn __imp__silc_channel_key_payload_free:dword
					; DATA XREF: _silc_channel_key_payload_freer
		extrn __imp__silc_channel_key_payload_parse:dword
					; DATA XREF: _silc_channel_key_payload_parser
		extrn __imp__silc_channel_name_check:dword
					; DATA XREF: _silc_channel_name_checkr
		extrn __imp__silc_channel_payload_list_free:dword
					; DATA XREF: _silc_channel_payload_list_freer
		extrn __imp__silc_channel_payload_parse_list:dword
					; DATA XREF: _silc_channel_payload_parse_listr
		extrn __imp__silc_cipher_alloc:dword ; DATA XREF: _silc_cipher_allocr
		extrn __imp__silc_cipher_free:dword ; DATA XREF: _silc_cipher_freer
		extrn __imp__silc_cipher_get_name:dword	; DATA XREF: _silc_cipher_get_namer
		extrn __imp__silc_cipher_is_supported:dword
					; DATA XREF: _silc_cipher_is_supportedr
		extrn __imp__silc_cipher_register_default:dword
					; DATA XREF: _silc_cipher_register_defaultr
		extrn __imp__silc_cipher_set_iv:dword ;	DATA XREF: _silc_cipher_set_ivr
		extrn __imp__silc_cipher_set_key:dword ; DATA XREF: _silc_cipher_set_keyr
		extrn __imp__silc_cipher_unregister_all:dword
					; DATA XREF: _silc_cipher_unregister_allr
		extrn __imp__silc_command_get:dword ; DATA XREF: _silc_command_getr
		extrn __imp__silc_command_get_args:dword
					; DATA XREF: _silc_command_get_argsr
		extrn __imp__silc_command_get_ident:dword
					; DATA XREF: _silc_command_get_identr
		extrn __imp__silc_command_get_status:dword
					; DATA XREF: _silc_command_get_statusr
		extrn __imp__silc_command_payload_encode:dword
					; DATA XREF: _silc_command_payload_encoder
		extrn __imp__silc_command_payload_encode_vap:dword
					; DATA XREF: _silc_command_payload_encode_vapr
		extrn __imp__silc_command_payload_free:dword
					; DATA XREF: _silc_command_payload_freer
		extrn __imp__silc_command_payload_parse:dword
					; DATA XREF: _silc_command_payload_parser
		extrn __imp__silc_command_reply_payload_encode_va:dword
					; DATA XREF: _silc_command_reply_payload_encode_var
		extrn __imp__silc_connauth_alloc:dword ; DATA XREF: _silc_connauth_allocr
		extrn __imp__silc_connauth_free:dword ;	DATA XREF: _silc_connauth_freer
		extrn __imp__silc_connauth_initiator:dword
					; DATA XREF: _silc_connauth_initiatorr
		extrn __imp__silc_file_close:dword ; DATA XREF:	_silc_file_closer
		extrn __imp__silc_file_open:dword ; DATA XREF: _silc_file_openr
		extrn __imp__silc_file_size:dword ; DATA XREF: _silc_file_sizer
		extrn __imp__silc_file_write:dword ; DATA XREF:	_silc_file_writer
		extrn __imp__silc_format:dword ; DATA XREF: _silc_formatr
		extrn __imp__silc_free:dword ; DATA XREF: _silc_freer
		extrn __imp__silc_fsm_continue:dword ; DATA XREF: _silc_fsm_continuer
		extrn __imp__silc_fsm_continue_sync:dword
					; DATA XREF: _silc_fsm_continue_syncr
		extrn __imp__silc_fsm_event_init:dword ; DATA XREF: _silc_fsm_event_initr
		extrn __imp__silc_fsm_event_signal:dword
					; DATA XREF: _silc_fsm_event_signalr
		extrn __imp__silc_fsm_event_wait:dword ; DATA XREF: _silc_fsm_event_waitr
		extrn __imp__silc_fsm_finish:dword ; DATA XREF:	_silc_fsm_finishr
		extrn __imp__silc_fsm_free:dword ; DATA	XREF: _silc_fsm_freer
		extrn __imp__silc_fsm_get_context:dword	; DATA XREF: _silc_fsm_get_contextr
		extrn __imp__silc_fsm_get_schedule:dword
					; DATA XREF: _silc_fsm_get_scheduler
		extrn __imp__silc_fsm_get_state_context:dword
					; DATA XREF: _silc_fsm_get_state_contextr
		extrn __imp__silc_fsm_init:dword ; DATA	XREF: _silc_fsm_initr
		extrn __imp__silc_fsm_is_started:dword ; DATA XREF: _silc_fsm_is_startedr
		extrn __imp__silc_fsm_next:dword ; DATA	XREF: _silc_fsm_nextr
		extrn __imp__silc_fsm_next_later:dword ; DATA XREF: _silc_fsm_next_laterr
		extrn __imp__silc_fsm_set_state_context:dword
					; DATA XREF: _silc_fsm_set_state_contextr
		extrn __imp__silc_fsm_start:dword ; DATA XREF: _silc_fsm_startr
		extrn __imp__silc_fsm_start_sync:dword ; DATA XREF: _silc_fsm_start_syncr
		extrn __imp__silc_fsm_thread_alloc:dword
					; DATA XREF: _silc_fsm_thread_allocr
		extrn __imp__silc_fsm_thread_init:dword	; DATA XREF: _silc_fsm_thread_initr
		extrn __imp__silc_get_mode_list:dword ;	DATA XREF: _silc_get_mode_listr
		extrn __imp__silc_get_status_message:dword
					; DATA XREF: _silc_get_status_messager
		extrn __imp__silc_hash_alloc:dword ; DATA XREF:	_silc_hash_allocr
		extrn __imp__silc_hash_free:dword ; DATA XREF: _silc_hash_freer
		extrn __imp__silc_hash_len:dword ; DATA	XREF: _silc_hash_lenr
		extrn __imp__silc_hash_make:dword ; DATA XREF: _silc_hash_maker
		extrn __imp__silc_hash_ptr:dword ; DATA	XREF: _silc_hash_ptrr
		extrn __imp__silc_hash_register_default:dword
					; DATA XREF: _silc_hash_register_defaultr
		extrn __imp__silc_hash_table_add:dword ; DATA XREF: _silc_hash_table_addr
		extrn __imp__silc_hash_table_alloc:dword
					; DATA XREF: _silc_hash_table_allocr
		extrn __imp__silc_hash_table_count:dword
					; DATA XREF: _silc_hash_table_countr
		extrn __imp__silc_hash_table_del:dword ; DATA XREF: _silc_hash_table_delr
		extrn __imp__silc_hash_table_del_by_context:dword
					; DATA XREF: _silc_hash_table_del_by_contextr
		extrn __imp__silc_hash_table_find:dword	; DATA XREF: _silc_hash_table_findr
		extrn __imp__silc_hash_table_find_foreach:dword
					; DATA XREF: _silc_hash_table_find_foreachr
		extrn __imp__silc_hash_table_free:dword	; DATA XREF: _silc_hash_table_freer
		extrn __imp__silc_hash_table_get:dword ; DATA XREF: _silc_hash_table_getr
		extrn __imp__silc_hash_table_list:dword	; DATA XREF: _silc_hash_table_listr
		extrn __imp__silc_hash_table_list_reset:dword
					; DATA XREF: _silc_hash_table_list_resetr
		extrn __imp__silc_hash_unregister_all:dword
					; DATA XREF: _silc_hash_unregister_allr
		extrn __imp__silc_hmac_alloc:dword ; DATA XREF:	_silc_hmac_allocr
		extrn __imp__silc_hmac_free:dword ; DATA XREF: _silc_hmac_freer
		extrn __imp__silc_hmac_get_hash:dword ;	DATA XREF: _silc_hmac_get_hashr
		extrn __imp__silc_hmac_get_key:dword ; DATA XREF: _silc_hmac_get_keyr
		extrn __imp__silc_hmac_get_name:dword ;	DATA XREF: _silc_hmac_get_namer
		extrn __imp__silc_hmac_is_supported:dword
					; DATA XREF: _silc_hmac_is_supportedr
		extrn __imp__silc_hmac_register_default:dword
					; DATA XREF: _silc_hmac_register_defaultr
		extrn __imp__silc_hmac_set_key:dword ; DATA XREF: _silc_hmac_set_keyr
		extrn __imp__silc_hmac_unregister_all:dword
					; DATA XREF: _silc_hmac_unregister_allr
		extrn __imp__silc_id_id2str:dword ; DATA XREF: _silc_id_id2strr
		extrn __imp__silc_id_payload_encode:dword
					; DATA XREF: _silc_id_payload_encoder
		extrn __imp__silc_id_payload_encode_data:dword
					; DATA XREF: _silc_id_payload_encode_datar
		extrn __imp__silc_id_payload_parse_id:dword
					; DATA XREF: _silc_id_payload_parse_idr
		extrn __imp__silc_id_str2id:dword ; DATA XREF: _silc_id_str2idr
		extrn __imp__silc_idcache_add:dword ; DATA XREF: _silc_idcache_addr
		extrn __imp__silc_idcache_alloc:dword ;	DATA XREF: _silc_idcache_allocr
		extrn __imp__silc_idcache_del_by_context:dword
					; DATA XREF: _silc_idcache_del_by_contextr
		extrn __imp__silc_idcache_find_by_context:dword
					; DATA XREF: _silc_idcache_find_by_contextr
		extrn __imp__silc_idcache_find_by_id_one:dword
					; DATA XREF: _silc_idcache_find_by_id_oner
		extrn __imp__silc_idcache_find_by_name:dword
					; DATA XREF: _silc_idcache_find_by_namer
		extrn __imp__silc_idcache_find_by_name_one:dword
					; DATA XREF: _silc_idcache_find_by_name_oner
		extrn __imp__silc_idcache_free:dword ; DATA XREF: _silc_idcache_freer
		extrn __imp__silc_idcache_get_all:dword	; DATA XREF: _silc_idcache_get_allr
		extrn __imp__silc_idcache_update_by_context:dword
					; DATA XREF: _silc_idcache_update_by_contextr
		extrn __imp__silc_identifier_check:dword
					; DATA XREF: _silc_identifier_checkr
		extrn __imp__silc_identifier_verify:dword
					; DATA XREF: _silc_identifier_verifyr
		extrn __imp__silc_key_agreement_get_hostname:dword
					; DATA XREF: _silc_key_agreement_get_hostnamer
		extrn __imp__silc_key_agreement_get_port:dword
					; DATA XREF: _silc_key_agreement_get_portr
		extrn __imp__silc_key_agreement_get_protocol:dword
					; DATA XREF: _silc_key_agreement_get_protocolr
		extrn __imp__silc_key_agreement_payload_encode:dword
					; DATA XREF: _silc_key_agreement_payload_encoder
		extrn __imp__silc_key_agreement_payload_free:dword
					; DATA XREF: _silc_key_agreement_payload_freer
		extrn __imp__silc_key_agreement_payload_parse:dword
					; DATA XREF: _silc_key_agreement_payload_parser
		extrn __imp__silc_load_key_pair:dword ;	DATA XREF: _silc_load_key_pairr
		extrn __imp__silc_log_output:dword ; DATA XREF:	_silc_log_outputr
		extrn __imp__silc_malloc:dword ; DATA XREF: _silc_mallocr
		extrn __imp__silc_memdup:dword ; DATA XREF: _silc_memdupr
		extrn __imp__silc_message_get_data:dword
					; DATA XREF: _silc_message_get_datar
		extrn __imp__silc_message_get_flags:dword
					; DATA XREF: _silc_message_get_flagsr
		extrn __imp__silc_message_payload_encode:dword
					; DATA XREF: _silc_message_payload_encoder
		extrn __imp__silc_message_payload_free:dword
					; DATA XREF: _silc_message_payload_freer
		extrn __imp__silc_message_payload_parse:dword
					; DATA XREF: _silc_message_payload_parser
		extrn __imp__silc_mutex_alloc:dword ; DATA XREF: _silc_mutex_allocr
		extrn __imp__silc_mutex_free:dword ; DATA XREF:	_silc_mutex_freer
		extrn __imp__silc_mutex_lock:dword ; DATA XREF:	_silc_mutex_lockr
		extrn __imp__silc_mutex_unlock:dword ; DATA XREF: _silc_mutex_unlockr
		extrn __imp__silc_net_close_listener:dword
					; DATA XREF: _silc_net_close_listenerr
		extrn __imp__silc_net_get_local_port:dword
					; DATA XREF: _silc_net_get_local_portr
		extrn __imp__silc_net_listener_get_port:dword
					; DATA XREF: _silc_net_listener_get_portr
		extrn __imp__silc_net_tcp_connect:dword	; DATA XREF: _silc_net_tcp_connectr
		extrn __imp__silc_net_tcp_create_listener:dword
					; DATA XREF: _silc_net_tcp_create_listenerr
		extrn __imp__silc_net_udp_connect:dword	; DATA XREF: _silc_net_udp_connectr
		extrn __imp__silc_notify_get_args:dword	; DATA XREF: _silc_notify_get_argsr
		extrn __imp__silc_notify_get_type:dword	; DATA XREF: _silc_notify_get_typer
		extrn __imp__silc_notify_payload_free:dword
					; DATA XREF: _silc_notify_payload_freer
		extrn __imp__silc_notify_payload_parse:dword
					; DATA XREF: _silc_notify_payload_parser
		extrn __imp__silc_packet_engine_start:dword
					; DATA XREF: _silc_packet_engine_startr
		extrn __imp__silc_packet_engine_stop:dword
					; DATA XREF: _silc_packet_engine_stopr
		extrn __imp__silc_packet_free:dword ; DATA XREF: _silc_packet_freer
		extrn __imp__silc_packet_get_sender:dword
					; DATA XREF: _silc_packet_get_senderr
		extrn __imp__silc_packet_send:dword ; DATA XREF: _silc_packet_sendr
		extrn __imp__silc_packet_send_ext:dword	; DATA XREF: _silc_packet_send_extr
		extrn __imp__silc_packet_send_va:dword ; DATA XREF: _silc_packet_send_var
		extrn __imp__silc_packet_send_va_ext:dword
					; DATA XREF: _silc_packet_send_va_extr
		extrn __imp__silc_packet_set_context:dword
					; DATA XREF: _silc_packet_set_contextr
		extrn __imp__silc_packet_set_ids:dword ; DATA XREF: _silc_packet_set_idsr
		extrn __imp__silc_packet_set_keys:dword	; DATA XREF: _silc_packet_set_keysr
		extrn __imp__silc_packet_set_sid:dword ; DATA XREF: _silc_packet_set_sidr
		extrn __imp__silc_packet_stream_add_remote:dword
					; DATA XREF: _silc_packet_stream_add_remoter
		extrn __imp__silc_packet_stream_create:dword
					; DATA XREF: _silc_packet_stream_creater
		extrn __imp__silc_packet_stream_destroy:dword
					; DATA XREF: _silc_packet_stream_destroyr
		extrn __imp__silc_packet_stream_get_stream:dword
					; DATA XREF: _silc_packet_stream_get_streamr
		extrn __imp__silc_packet_stream_link:dword
					; DATA XREF: _silc_packet_stream_linkr
		extrn __imp__silc_packet_stream_set_iv_included:dword
					; DATA XREF: _silc_packet_stream_set_iv_includedr
		extrn __imp__silc_packet_stream_set_stream:dword
					; DATA XREF: _silc_packet_stream_set_streamr
		extrn __imp__silc_packet_stream_wrap:dword
					; DATA XREF: _silc_packet_stream_wrapr
		extrn __imp__silc_packet_wait:dword ; DATA XREF: _silc_packet_waitr
		extrn __imp__silc_packet_wait_init:dword
					; DATA XREF: _silc_packet_wait_initr
		extrn __imp__silc_packet_wait_uninit:dword
					; DATA XREF: _silc_packet_wait_uninitr
		extrn __imp__silc_parse_command_line:dword
					; DATA XREF: _silc_parse_command_liner
		extrn __imp__silc_parse_userfqdn:dword ; DATA XREF: _silc_parse_userfqdnr
		extrn __imp__silc_pkcs_get_type:dword ;	DATA XREF: _silc_pkcs_get_typer
		extrn __imp__silc_pkcs_load_public_key:dword
					; DATA XREF: _silc_pkcs_load_public_keyr
		extrn __imp__silc_pkcs_public_key_compare:dword
					; DATA XREF: _silc_pkcs_public_key_comparer
		extrn __imp__silc_pkcs_public_key_encode:dword
					; DATA XREF: _silc_pkcs_public_key_encoder
		extrn __imp__silc_pkcs_public_key_free:dword
					; DATA XREF: _silc_pkcs_public_key_freer
		extrn __imp__silc_pkcs_register_default:dword
					; DATA XREF: _silc_pkcs_register_defaultr
		extrn __imp__silc_pkcs_sign:dword ; DATA XREF: _silc_pkcs_signr
		extrn __imp__silc_pkcs_unregister_all:dword
					; DATA XREF: _silc_pkcs_unregister_allr
		extrn __imp__silc_public_key_payload_decode:dword
					; DATA XREF: _silc_public_key_payload_decoder
		extrn __imp__silc_public_key_payload_encode:dword
					; DATA XREF: _silc_public_key_payload_encoder
		extrn __imp__silc_realloc:dword	; DATA XREF: _silc_reallocr
		extrn __imp__silc_rng_alloc:dword ; DATA XREF: _silc_rng_allocr
		extrn __imp__silc_rng_free:dword ; DATA	XREF: _silc_rng_freer
		extrn __imp__silc_rng_get_rn16:dword ; DATA XREF: _silc_rng_get_rn16r
		extrn __imp__silc_rng_get_rn_data:dword	; DATA XREF: _silc_rng_get_rn_datar
		extrn __imp__silc_rng_global_init:dword	; DATA XREF: _silc_rng_global_initr
		extrn __imp__silc_rng_init:dword ; DATA	XREF: _silc_rng_initr
		extrn __imp__silc_rwlock_alloc:dword ; DATA XREF: _silc_rwlock_allocr
		extrn __imp__silc_rwlock_free:dword ; DATA XREF: _silc_rwlock_freer
		extrn __imp__silc_rwlock_rdlock:dword ;	DATA XREF: _silc_rwlock_rdlockr
		extrn __imp__silc_rwlock_unlock:dword ;	DATA XREF: _silc_rwlock_unlockr
		extrn __imp__silc_rwlock_wrlock:dword ;	DATA XREF: _silc_rwlock_wrlockr
		extrn __imp__silc_schedule:dword ; DATA	XREF: _silc_scheduler
		extrn __imp__silc_schedule_init:dword ;	DATA XREF: _silc_schedule_initr
		extrn __imp__silc_schedule_one:dword ; DATA XREF: _silc_schedule_oner
		extrn __imp__silc_schedule_stop:dword ;	DATA XREF: _silc_schedule_stopr
		extrn __imp__silc_schedule_task_add:dword
					; DATA XREF: _silc_schedule_task_addr
		extrn __imp__silc_schedule_task_del_by_all:dword
					; DATA XREF: _silc_schedule_task_del_by_allr
		extrn __imp__silc_schedule_task_del_by_context:dword
					; DATA XREF: _silc_schedule_task_del_by_contextr
		extrn __imp__silc_schedule_uninit:dword	; DATA XREF: _silc_schedule_uninitr
		extrn __imp__silc_sftp_client_shutdown:dword
					; DATA XREF: _silc_sftp_client_shutdownr
		extrn __imp__silc_sftp_client_start:dword
					; DATA XREF: _silc_sftp_client_startr
		extrn __imp__silc_sftp_close:dword ; DATA XREF:	_silc_sftp_closer
		extrn __imp__silc_sftp_fs_memory_add_file:dword
					; DATA XREF: _silc_sftp_fs_memory_add_filer
		extrn __imp__silc_sftp_fs_memory_alloc:dword
					; DATA XREF: _silc_sftp_fs_memory_allocr
		extrn __imp__silc_sftp_fs_memory_free:dword
					; DATA XREF: _silc_sftp_fs_memory_freer
		extrn __imp__silc_sftp_open:dword ; DATA XREF: _silc_sftp_openr
		extrn __imp__silc_sftp_opendir:dword ; DATA XREF: _silc_sftp_opendirr
		extrn __imp__silc_sftp_read:dword ; DATA XREF: _silc_sftp_readr
		extrn __imp__silc_sftp_readdir:dword ; DATA XREF: _silc_sftp_readdirr
		extrn __imp__silc_sftp_server_set_monitor:dword
					; DATA XREF: _silc_sftp_server_set_monitorr
		extrn __imp__silc_sftp_server_shutdown:dword
					; DATA XREF: _silc_sftp_server_shutdownr
		extrn __imp__silc_sftp_server_start:dword
					; DATA XREF: _silc_sftp_server_startr
		extrn __imp__silc_ske_alloc:dword ; DATA XREF: _silc_ske_allocr
		extrn __imp__silc_ske_free:dword ; DATA	XREF: _silc_ske_freer
		extrn __imp__silc_ske_free_key_material:dword
					; DATA XREF: _silc_ske_free_key_materialr
		extrn __imp__silc_ske_free_rekey_material:dword
					; DATA XREF: _silc_ske_free_rekey_materialr
		extrn __imp__silc_ske_get_key_material:dword
					; DATA XREF: _silc_ske_get_key_materialr
		extrn __imp__silc_ske_get_security_properties:dword
					; DATA XREF: _silc_ske_get_security_propertiesr
		extrn __imp__silc_ske_initiator:dword ;	DATA XREF: _silc_ske_initiatorr
		extrn __imp__silc_ske_map_status:dword ; DATA XREF: _silc_ske_map_statusr
		extrn __imp__silc_ske_parse_version:dword
					; DATA XREF: _silc_ske_parse_versionr
		extrn __imp__silc_ske_process_key_material_data:dword
					; DATA XREF: _silc_ske_process_key_material_datar
		extrn __imp__silc_ske_rekey_initiator:dword
					; DATA XREF: _silc_ske_rekey_initiatorr
		extrn __imp__silc_ske_rekey_responder:dword
					; DATA XREF: _silc_ske_rekey_responderr
		extrn __imp__silc_ske_responder:dword ;	DATA XREF: _silc_ske_responderr
		extrn __imp__silc_ske_set_callbacks:dword
					; DATA XREF: _silc_ske_set_callbacksr
		extrn __imp__silc_ske_set_keys:dword ; DATA XREF: _silc_ske_set_keysr
		extrn __imp__silc_snprintf:dword ; DATA	XREF: _silc_snprintfr
		extrn __imp__silc_socket_stream_get_info:dword
					; DATA XREF: _silc_socket_stream_get_infor
		extrn __imp__silc_status_get_args:dword	; DATA XREF: _silc_status_get_argsr
		extrn __imp__silc_stream_destroy:dword ; DATA XREF: _silc_stream_destroyr
		extrn __imp__silc_strncat:dword	; DATA XREF: _silc_strncatr
		extrn __imp__silc_time:dword ; DATA XREF: _silc_timer
		extrn __imp__silc_timezone:dword ; DATA	XREF: _silc_timezoner
		extrn __imp__silc_utf8_encode:dword ; DATA XREF: _silc_utf8_encoder
		extrn __imp__silc_utf8_encoded_len:dword
					; DATA XREF: _silc_utf8_encoded_lenr
		extrn __imp__silc_utf8_strcasecmp:dword	; DATA XREF: _silc_utf8_strcasecmpr
		extrn __imp__silc_utf8_strncasecmp:dword
					; DATA XREF: _silc_utf8_strncasecmpr
		extrn __imp__silc_utf8_valid:dword ; DATA XREF:	_silc_utf8_validr

;
; Imports from KERNEL32.dll
;
; HMODULE __stdcall _GetModuleHandleA_4(LPCSTR lpModuleName)
		extrn __imp__GetModuleHandleA@4:dword ;	DATA XREF: _GetModuleHandleA@4r
; FARPROC __stdcall _GetProcAddress_8(HMODULE hModule, LPCSTR lpProcName)
		extrn __imp__GetProcAddress@8:dword ; DATA XREF: _GetProcAddress@8r
; void __stdcall _Sleep_4(DWORD	dwMilliseconds)
		extrn __imp__Sleep@4:dword ; DATA XREF:	_Sleep@4r
; BOOL __stdcall _VirtualProtect_16(LPVOID lpAddress, DWORD dwSize, DWORD flNewProtect,	PDWORD lpflOldProtect)
		extrn __imp__VirtualProtect@16:dword ; DATA XREF: _VirtualProtect@16r
; DWORD	__stdcall _VirtualQuery_12(LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION	lpBuffer, DWORD	dwLength)
		extrn __imp__VirtualQuery@12:dword ; DATA XREF:	_VirtualQuery@12r

;
; Imports from msvcrt.dll
;
; char *__cdecl	_strdup(const char *)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr
; int __cdecl _stricmp(const char *, const char	*)
		extrn __imp__stricmp:dword ; DATA XREF:	_stricmpr

;
; Imports from msvcrt.dll
;
		extrn __imp____dllonexit:dword ; DATA XREF: ___dllonexitr
		extrn __imp___errno:dword ; DATA XREF: __errnor
; FILE __iob[]
		extrn __imp___iob:dword	; DATA XREF: ___report_error+9r
; void __cdecl __noreturn _abort()
		extrn __imp__abort:dword ; DATA	XREF: _abortr
; int __cdecl _atoi(const char *)
		extrn __imp__atoi:dword	; DATA XREF: _atoir
; int __cdecl _fflush(FILE *)
		extrn __imp__fflush:dword ; DATA XREF: _fflushr
; void __cdecl _free(void *)
		extrn __imp__free:dword	; DATA XREF: _freer
; size_t __cdecl _fwrite(const void *, size_t, size_t, FILE *)
		extrn __imp__fwrite:dword ; DATA XREF: _fwriter
; void *__cdecl	_malloc(size_t)
		extrn __imp__malloc:dword ; DATA XREF: _mallocr
; void *__cdecl	_memcpy(void *,	const void *, size_t)
		extrn __imp__memcpy:dword ; DATA XREF: _memcpyr
; char *__cdecl	_strchr(const char *, int)
		extrn __imp__strchr:dword ; DATA XREF: _strchrr
; int __cdecl _strcmp(const char *, const char *)
		extrn __imp__strcmp:dword ; DATA XREF: _strcmpr
; size_t __cdecl _strcspn(const	char *,	const char *)
		extrn __imp__strcspn:dword ; DATA XREF:	_strcspnr
; char *__cdecl	_strerror(int)
		extrn __imp__strerror:dword ; DATA XREF: _strerrorr
; char *__cdecl	_strrchr(const char *, int)
		extrn __imp__strrchr:dword ; DATA XREF:	_strrchrr
; int __cdecl _vfprintf(FILE *,	const char *, va_list)
		extrn __imp__vfprintf:dword ; DATA XREF: _vfprintfr



		end _DllMainCRTStartup@12
