;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	D7DC3C8976D465A72BEFAA20D652D0A2
; Input	CRC32 :	DF8D6247

; File Name   :	C:\compspace\compare\pidgin\dlls\original\libsasl.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	10000000
; Section 1. (virtual address 00001000)
; Virtual size			: 00025052 ( 151634.)
; Section size in file		: 00025200 ( 152064.)
; Offset to raw	data for section: 00000400
; Flags	60000020: Text Executable Readable
; Alignment	: default
; PDB File Name	: c:\devel\cyrus\cyrus-sasl-2.1.25\lib\libsasl.pdb

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 10001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_10001000	proc near		; CODE XREF: prop_set:loc_1000179Ep
		push	ebx
		push	esi
		lea	ebx, [edi+0Fh]
		push	ebx
		call	off_1002D044
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10001018
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10001018:				; CODE XREF: sub_10001000+13j
		push	ebx
		push	0
		push	esi
		call	sub_1000E0F0
		add	esp, 0Ch
		mov	[esi+8], edi
		mov	[esi+4], edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_10001000	endp

; ---------------------------------------------------------------------------
		align 10h
		cmp	[eax+4], esi
		jnb	short locret_1000104B
		lea	ecx, [esi+10h]
		push	ecx
		push	eax
		call	off_1002D04C
		add	esp, 8
		test	eax, eax
		jnz	short loc_10001048
		retn
; ---------------------------------------------------------------------------

loc_10001048:				; CODE XREF: .text:10001045j
		mov	[eax+4], esi

locret_1000104B:			; CODE XREF: .text:10001033j
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001050	proc near		; CODE XREF: prop_new+29p
		push	ebx
		push	ebp
		lea	ebx, [eax+40h]
		push	esi
		lea	ebp, [ebx+0Fh]
		push	ebp
		call	off_1002D044
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_1000107B
		push	ebp
		push	0
		push	esi
		call	sub_1000E0F0
		add	esp, 0Ch
		mov	[esi+8], ebx
		mov	[esi+4], ebx

loc_1000107B:				; CODE XREF: sub_10001050+17j
		xor	ecx, ecx
		mov	[edi+18h], esi
		cmp	esi, ecx
		jnz	short loc_1000108B
		pop	esi
		pop	ebp
		lea	eax, [ecx-2]
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000108B:				; CODE XREF: sub_10001050+32j
		lea	eax, [esi+0Ch]
		mov	[edi], eax
		mov	[edi+1Ch], esi
		mov	edx, [esi+4]
		sub	edx, 40h
		mov	[esi+8], edx
		mov	eax, [edi+18h]
		mov	dword ptr [edi+0Ch], 4
		mov	[edi+8], ecx
		mov	edx, [eax+4]
		lea	edx, [edx+eax+0Ch]
		pop	esi
		add	eax, 4Ch
		pop	ebp
		mov	[edi+14h], eax
		mov	[edi+10h], edx
		mov	[edi+4], ecx
		xor	eax, eax
		pop	ebx
		retn
sub_10001050	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   9. prop_dispose

; =============== S U B	R O U T	I N E =======================================


		public prop_dispose
prop_dispose	proc near		; CODE XREF: prop_new+37p prop_dup+BFp ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_10001113
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10001113
		cmp	dword ptr [eax+18h], 0
		jz	short loc_10001101

loc_100010E5:				; CODE XREF: prop_dispose+2Fj
		mov	eax, [esi]
		mov	ecx, [eax+18h]
		mov	edx, [ecx]
		push	ecx		; lpMem
		mov	[eax+18h], edx
		call	off_1002D050
		mov	eax, [esi]
		add	esp, 4
		cmp	dword ptr [eax+18h], 0
		jnz	short loc_100010E5

loc_10001101:				; CODE XREF: prop_dispose+13j
		mov	ecx, [esi]
		push	ecx		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	dword ptr [esi], 0

loc_10001113:				; CODE XREF: prop_dispose+7j
					; prop_dispose+Dj
		pop	esi
		retn
prop_dispose	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  13. prop_get

; =============== S U B	R O U T	I N E =======================================


		public prop_get
prop_get	proc near		; DATA XREF: sub_10007350+15Ao
					; .rdata:off_1002C568o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_10001129
		retn
; ---------------------------------------------------------------------------

loc_10001129:				; CODE XREF: prop_get+6j
		mov	eax, [eax]
		retn
prop_get	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  14. prop_getnames

; =============== S U B	R O U T	I N E =======================================


		public prop_getnames
prop_getnames	proc near		; CODE XREF: sub_10002C80+A9p
					; sub_10002F00+AEp
					; DATA XREF: ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		cmp	[esp+4+arg_0], 0
		mov	edx, [esp+4+arg_8]
		push	edi
		mov	[esp+8+var_4], 0
		mov	edi, edx
		jz	loc_100011F0
		mov	ecx, [esp+8+arg_4]
		test	ecx, ecx
		jz	loc_100011F0
		test	edx, edx
		jz	loc_100011F0
		cmp	dword ptr [ecx], 0
		mov	eax, ecx
		jz	short loc_100011D0
		push	ebx
		push	ebp
		push	esi
		lea	esp, [esp+0]

loc_10001170:				; CODE XREF: prop_getnames+9Bj
		mov	ecx, [esp+14h+arg_0]
		mov	esi, [ecx]
		mov	edx, [esi]
		test	edx, edx
		jz	short loc_100011B5
		mov	ebp, [eax]
		mov	edi, edi

loc_10001180:				; CODE XREF: prop_getnames+83j
		mov	ecx, ebp

loc_10001182:				; CODE XREF: prop_getnames+6Cj
		mov	bl, [ecx]
		cmp	bl, [edx]
		jnz	short loc_100011A2
		test	bl, bl
		jz	short loc_1000119E
		mov	bl, [ecx+1]
		cmp	bl, [edx+1]
		jnz	short loc_100011A2
		add	ecx, 2
		add	edx, 2
		test	bl, bl
		jnz	short loc_10001182

loc_1000119E:				; CODE XREF: prop_getnames+5Aj
		xor	ecx, ecx
		jmp	short loc_100011A7
; ---------------------------------------------------------------------------

loc_100011A2:				; CODE XREF: prop_getnames+56j
					; prop_getnames+62j
		sbb	ecx, ecx
		sbb	ecx, 0FFFFFFFFh

loc_100011A7:				; CODE XREF: prop_getnames+70j
		test	ecx, ecx
		jz	short loc_100011D7
		mov	edx, [esi+10h]
		add	esi, 10h
		test	edx, edx
		jnz	short loc_10001180

loc_100011B5:				; CODE XREF: prop_getnames+4Aj
		xor	ecx, ecx
		mov	[edi], ecx
		mov	[edi+4], ecx
		mov	[edi+8], ecx

loc_100011BF:				; CODE XREF: prop_getnames+BEj
		mov	[edi+0Ch], ecx
		add	eax, 4
		add	edi, 10h
		cmp	dword ptr [eax], 0
		jnz	short loc_10001170
		pop	esi
		pop	ebp
		pop	ebx

loc_100011D0:				; CODE XREF: prop_getnames+34j
		mov	eax, [esp+8+var_4]
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100011D7:				; CODE XREF: prop_getnames+79j
		mov	edx, [esi]
		inc	[esp+14h+var_4]
		mov	[edi], edx
		mov	ecx, [esi+4]
		mov	[edi+4], ecx
		mov	edx, [esi+8]
		mov	[edi+8], edx
		mov	ecx, [esi+0Ch]
		jmp	short loc_100011BF
; ---------------------------------------------------------------------------

loc_100011F0:				; CODE XREF: prop_getnames+15j
					; prop_getnames+21j ...
		mov	eax, 0FFFFFFF9h
		pop	edi
		pop	ecx
		retn
prop_getnames	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   8. prop_clear

; =============== S U B	R O U T	I N E =======================================


		public prop_clear
prop_clear	proc near		; CODE XREF: prop_request+17Cp
					; sasl_auxprop_request+49p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	ebx, [esi+8]
		mov	eax, [esi+18h]
		inc	ebx
		shl	ebx, 4
		add	ebx, [eax+4]
		push	edi
		lea	ebp, [ebx+0Fh]
		push	ebp
		call	off_1002D044
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_1000123A
		push	ebp
		push	0
		push	edi
		call	sub_1000E0F0
		add	esp, 0Ch
		mov	[edi+8], ebx
		mov	[edi+4], ebx

loc_1000123A:				; CODE XREF: prop_clear+26j
		cmp	[esp+10h+arg_4], 0
		jz	short loc_1000124A
		mov	dword ptr [esi+8], 0
		jmp	short loc_10001265
; ---------------------------------------------------------------------------

loc_1000124A:				; CODE XREF: prop_clear+3Fj
		xor	ecx, ecx
		cmp	[esi+8], ecx
		jbe	short loc_10001265
		xor	eax, eax

loc_10001253:				; CODE XREF: prop_clear+63j
		mov	edx, [esi]
		mov	edx, [eax+edx]
		mov	[eax+edi+0Ch], edx
		inc	ecx
		add	eax, 10h
		cmp	ecx, [esi+8]
		jb	short loc_10001253

loc_10001265:				; CODE XREF: prop_clear+48j
					; prop_clear+4Fj
		cmp	dword ptr [esi+18h], 0
		jz	short loc_10001288
		jmp	short loc_10001270
; ---------------------------------------------------------------------------
		align 10h

loc_10001270:				; CODE XREF: prop_clear+6Bj
					; prop_clear+86j
		mov	eax, [esi+18h]
		mov	ecx, [eax]
		push	eax		; lpMem
		mov	[esi+18h], ecx
		call	off_1002D050
		add	esp, 4
		cmp	dword ptr [esi+18h], 0
		jnz	short loc_10001270

loc_10001288:				; CODE XREF: prop_clear+69j
		mov	eax, [esi+8]
		inc	eax
		mov	[esi+0Ch], eax
		mov	edx, [edi+4]
		shl	eax, 4
		sub	edx, eax
		mov	[edi+8], edx
		mov	ecx, [esi+0Ch]
		add	ecx, ecx
		lea	eax, [edi+0Ch]
		lea	edx, [edi+ecx*8+0Ch]
		mov	[esi+1Ch], edi
		mov	[esi+18h], edi
		mov	[esi], eax
		mov	dword ptr [esi+4], 0
		mov	[esi+14h], edx
		mov	eax, [edi+4]
		lea	ecx, [edi+eax+0Ch]
		pop	edi
		mov	[esi+10h], ecx
		pop	esi
		pop	ebp
		pop	ebx
		retn
prop_clear	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  11. prop_erase

; =============== S U B	R O U T	I N E =======================================


		public prop_erase
prop_erase	proc near		; DATA XREF: sub_10007350+1A0o
					; .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jz	loc_1000138E
		push	ebx
		mov	ebx, [esp+8+arg_4]
		cmp	ebx, esi
		jz	loc_1000138D
		push	edi
		mov	edi, [eax]
		cmp	[edi], esi
		jz	loc_1000138C

loc_100012F7:				; CODE XREF: prop_erase+5Ej
		mov	ecx, [edi]
		mov	eax, ebx
		jmp	short loc_10001300
; ---------------------------------------------------------------------------
		align 10h

loc_10001300:				; CODE XREF: prop_erase+2Bj
					; prop_erase+4Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10001320
		test	dl, dl
		jz	short loc_1000131C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10001320
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10001300

loc_1000131C:				; CODE XREF: prop_erase+38j
		xor	eax, eax
		jmp	short loc_10001325
; ---------------------------------------------------------------------------

loc_10001320:				; CODE XREF: prop_erase+34j
					; prop_erase+40j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10001325:				; CODE XREF: prop_erase+4Ej
		cmp	eax, esi
		jz	short loc_10001334
		add	edi, 10h
		cmp	[edi], esi
		jnz	short loc_100012F7
		pop	edi
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001334:				; CODE XREF: prop_erase+57j
		mov	eax, [edi+4]
		cmp	eax, esi
		jz	short loc_1000138C
		push	ebp
		xor	ebp, ebp
		cmp	[eax], esi
		jz	short loc_10001382

loc_10001342:				; CODE XREF: prop_erase+AEj
		mov	eax, [edi+4]
		mov	ecx, [esi+eax]
		mov	eax, ecx
		lea	ebx, [eax+1]
		lea	ecx, [ecx+0]

loc_10001350:				; CODE XREF: prop_erase+85j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10001350
		sub	eax, ebx
		push	eax
		push	0
		push	ecx
		call	sub_1000E0F0
		mov	ecx, [edi+4]
		mov	dword ptr [esi+ecx], 0
		mov	edx, [edi+4]
		inc	ebp
		lea	esi, ds:0[ebp*4]
		add	esp, 0Ch
		cmp	dword ptr [esi+edx], 0
		jnz	short loc_10001342
		xor	esi, esi

loc_10001382:				; CODE XREF: prop_erase+70j
		mov	[edi+4], esi
		mov	[edi+8], esi
		mov	[edi+0Ch], esi
		pop	ebp

loc_1000138C:				; CODE XREF: prop_erase+21j
					; prop_erase+69j
		pop	edi

loc_1000138D:				; CODE XREF: prop_erase+16j
		pop	ebx

loc_1000138E:				; CODE XREF: prop_erase+9j
		pop	esi
		retn
prop_erase	endp

; Exported entry  12. prop_format

; =============== S U B	R O U T	I N E =======================================


		public prop_format
prop_format	proc near		; DATA XREF: sub_10007350+182o
					; .rdata:off_1002C568o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	edi
		mov	[esp+0Ch+var_4], 0
		test	ebx, ebx
		jz	loc_100014A6
		mov	edi, [esp+0Ch+arg_C]
		test	edi, edi
		jz	loc_100014A6
		mov	eax, [esp+0Ch+arg_4]
		push	ebp
		test	eax, eax
		jnz	short loc_10001403
		xor	ebp, ebp

loc_100013BE:				; CODE XREF: prop_format+79j
					; prop_format+8Bj
		mov	eax, [ebx+8]
		push	esi
		mov	esi, [ebx]
		mov	ecx, [esi]
		dec	eax
		imul	eax, ebp
		test	ecx, ecx
		jz	short loc_100013EB
		mov	edi, edi

loc_100013D0:				; CODE XREF: prop_format+55j
		lea	edi, [ecx+1]

loc_100013D3:				; CODE XREF: prop_format+48j
		mov	dl, [ecx]
		inc	ecx
		test	dl, dl
		jnz	short loc_100013D3
		sub	ecx, edi
		add	esi, 10h
		add	eax, ecx
		mov	ecx, [esi]
		test	ecx, ecx
		jnz	short loc_100013D0
		mov	edi, [esp+14h+arg_C]

loc_100013EB:				; CODE XREF: prop_format+3Cj
		mov	ecx, [esp+14h+arg_10]
		test	ecx, ecx
		jz	short loc_100013FC
		lea	edx, [ecx-1]
		cmp	eax, edx
		jbe	short loc_10001427
		sub	eax, ecx

loc_100013FC:				; CODE XREF: prop_format+61j
		pop	esi
		pop	ebp
		pop	edi
		inc	eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10001403:				; CODE XREF: prop_format+2Aj
		mov	ebp, [esp+10h+arg_8]
		test	ebp, ebp
		jns	short loc_100013BE
		lea	edx, [eax+1]
		mov	edi, edi

loc_10001410:				; CODE XREF: prop_format+85j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10001410
		sub	eax, edx
		mov	ebp, eax
		jns	short loc_100013BE
		pop	ebp
		pop	edi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10001427:				; CODE XREF: prop_format+68j
		mov	ecx, [esp+14h+arg_14]
		mov	byte ptr [edi],	0
		test	ecx, ecx
		jz	short loc_10001434
		mov	[ecx], eax

loc_10001434:				; CODE XREF: prop_format+A0j
		test	eax, eax
		jz	short loc_1000149E
		mov	ebx, [ebx]
		cmp	dword ptr [ebx], 0
		jz	short loc_1000149E
		jmp	short loc_10001445
; ---------------------------------------------------------------------------

loc_10001441:				; CODE XREF: prop_format+10Cj
		mov	edi, [esp+14h+arg_C]

loc_10001445:				; CODE XREF: prop_format+AFj
		test	ebp, ebp
		jz	short loc_10001461
		cmp	[esp+14h+var_4], 0
		jz	short loc_10001461
		mov	eax, [esp+14h+arg_4]
		push	ebp
		push	eax
		push	edi
		call	sub_1000E170
		add	esp, 0Ch
		jmp	short loc_10001469
; ---------------------------------------------------------------------------

loc_10001461:				; CODE XREF: prop_format+B7j
					; prop_format+BEj
		mov	[esp+14h+var_4], 1

loc_10001469:				; CODE XREF: prop_format+CFj
		mov	eax, [ebx]
		mov	ecx, eax
		lea	ecx, [ecx+0]

loc_10001470:				; CODE XREF: prop_format+E5j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10001470
		sub	eax, ecx
		mov	esi, ecx
		dec	edi
		lea	esp, [esp+0]

loc_10001480:				; CODE XREF: prop_format+F6j
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_10001480
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		add	ebx, 10h
		rep movsb
		cmp	dword ptr [ebx], 0
		jnz	short loc_10001441

loc_1000149E:				; CODE XREF: prop_format+A6j
					; prop_format+ADj
		pop	esi
		pop	ebp
		pop	edi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100014A6:				; CODE XREF: prop_format+11j
					; prop_format+1Dj
		pop	edi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		pop	ecx
		retn
prop_format	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  17. prop_set

; =============== S U B	R O U T	I N E =======================================


		public prop_set
prop_set	proc near		; CODE XREF: prop_setvals+2Ep
					; prop_setvals+48p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		test	esi, esi
		jz	loc_10001564
		push	ebp
		mov	ebp, [esp+0Ch+arg_4]
		push	ebx
		push	edi

loc_100014C5:				; CODE XREF: prop_set+AFj
		test	ebp, ebp
		jz	short loc_10001518
		mov	edi, [esi]
		mov	dword ptr [esi+4], 0
		mov	ecx, [edi]
		test	ecx, ecx
		jz	short loc_10001518

loc_100014D8:				; CODE XREF: prop_set+61j
		mov	eax, ebp
		lea	ebx, [ebx+0]

loc_100014E0:				; CODE XREF: prop_set+4Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10001500
		test	dl, dl
		jz	short loc_100014FC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10001500
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_100014E0

loc_100014FC:				; CODE XREF: prop_set+38j
		xor	eax, eax
		jmp	short loc_10001505
; ---------------------------------------------------------------------------

loc_10001500:				; CODE XREF: prop_set+34j prop_set+40j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10001505:				; CODE XREF: prop_set+4Ej
		test	eax, eax
		jz	short loc_10001515
		mov	ecx, [edi+10h]
		add	edi, 10h
		test	ecx, ecx
		jnz	short loc_100014D8
		jmp	short loc_10001518
; ---------------------------------------------------------------------------

loc_10001515:				; CODE XREF: prop_set+57j
		mov	[esi+4], edi

loc_10001518:				; CODE XREF: prop_set+17j prop_set+26j ...
		mov	ebx, [esi+4]
		test	ebx, ebx
		jz	short loc_1000156C
		test	ebp, ebp
		jnz	short loc_10001577
		mov	edx, [esp+14h+arg_8]
		test	edx, edx
		jz	loc_10001806
		mov	eax, [esi+1Ch]
		mov	ebp, 4
		cmp	[eax+8], ebp
		jnb	loc_1000174D
		mov	ecx, [ebx+4]
		lea	edi, [eax+0Ch]
		cmp	ecx, edi
		jbe	loc_1000174D
		mov	edi, [eax+4]
		lea	eax, [edi+eax+0Ch]
		cmp	ecx, eax
		jnb	loc_1000174D
		mov	ebp, [ebx]
		jmp	loc_100014C5
; ---------------------------------------------------------------------------

loc_10001564:				; CODE XREF: prop_set+8j
		mov	eax, 0FFFFFFF9h
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000156C:				; CODE XREF: prop_set+6Dj
		pop	edi
		pop	ebx
		pop	ebp
		mov	eax, 0FFFFFFF9h
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10001577:				; CODE XREF: prop_set+71j
		mov	eax, [ebx+4]
		mov	edi, [esp+14h+arg_8]
		mov	ebp, 1
		mov	[esp+14h+arg_0], ebp
		mov	[esp+14h+var_4], 0
		test	eax, eax
		jz	short loc_100015B1
		test	edi, edi
		jz	loc_10001806
		cmp	dword ptr [eax], 0
		mov	[esp+14h+var_4], eax
		jz	short loc_100015B1

loc_100015A4:				; CODE XREF: prop_set+FBj
		add	eax, 4
		inc	ebp
		cmp	dword ptr [eax], 0
		jnz	short loc_100015A4
		mov	[esp+14h+arg_0], ebp

loc_100015B1:				; CODE XREF: prop_set+E1j prop_set+F2j
		test	edi, edi
		jz	short loc_100015BA
		inc	ebp
		mov	[esp+14h+arg_0], ebp

loc_100015BA:				; CODE XREF: prop_set+103j
		mov	ecx, [esi+1Ch]
		lea	eax, ds:0[ebp*4]
		cmp	eax, [ecx+8]
		jbe	short loc_1000162E
		mov	edi, [ecx+4]
		add	edi, edi
		cmp	edi, eax
		jnb	short loc_100015D8

loc_100015D2:				; CODE XREF: prop_set+126j
		add	edi, edi
		cmp	edi, eax
		jb	short loc_100015D2

loc_100015D8:				; CODE XREF: prop_set+120j
		lea	eax, [edi+0Fh]
		push	eax
		call	off_1002D044
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	short loc_10001600
		lea	eax, [edi+0Fh]
		push	eax
		push	0
		push	ebp
		call	sub_1000E0F0
		add	esp, 0Ch
		mov	[ebp+8], edi
		mov	[ebp+4], edi

loc_10001600:				; CODE XREF: prop_set+139j
		mov	ecx, [esi+1Ch]
		mov	[ecx], ebp
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax], 0
		jz	loc_100017B0
		mov	eax, [eax]
		mov	ebp, [esp+14h+arg_0]
		mov	[esi+1Ch], eax
		mov	edx, [esi+1Ch]
		add	eax, 0Ch
		mov	[esi+14h], eax
		lea	eax, [edi+edx+0Ch]
		mov	edi, [esp+14h+arg_8]
		mov	[esi+10h], eax

loc_1000162E:				; CODE XREF: prop_set+117j
		mov	ecx, [esi+1Ch]
		lea	eax, ds:0[ebp*4]
		sub	[ecx+8], eax
		mov	ecx, [esi+14h]
		mov	[ebx+4], ecx
		mov	dword ptr [ecx+eax-4], 0
		mov	ecx, [ebx+4]
		add	ecx, eax
		mov	[esi+14h], ecx
		test	edi, edi
		jz	loc_10001806
		mov	ecx, [esp+14h+var_4]
		mov	edx, [ebx+4]
		test	ecx, ecx
		jz	short loc_1000167E
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_1000167E
		lea	ebx, [ebx+0]

loc_10001670:				; CODE XREF: prop_set+1CCj
		add	ecx, 4
		mov	[edx], eax
		mov	eax, [ecx]
		add	edx, 4
		test	eax, eax
		jnz	short loc_10001670

loc_1000167E:				; CODE XREF: prop_set+1B2j
					; prop_set+1B8j
		mov	eax, [esp+14h+arg_C]
		test	eax, eax
		jg	short loc_10001699
		mov	eax, edi
		lea	edx, [eax+1]
		jmp	short loc_10001690
; ---------------------------------------------------------------------------
		align 10h

loc_10001690:				; CODE XREF: prop_set+1DBj
					; prop_set+1E5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10001690
		sub	eax, edx

loc_10001699:				; CODE XREF: prop_set+1D4j
		lea	edi, [eax+1]
		mov	eax, [esi+1Ch]
		cmp	edi, [eax+8]
		jbe	short loc_1000170E
		mov	ebp, [eax+4]
		add	ebp, ebp
		cmp	ebp, edi
		jnb	short loc_100016B6
		lea	ecx, [ecx+0]

loc_100016B0:				; CODE XREF: prop_set+204j
		add	ebp, ebp
		cmp	ebp, edi
		jb	short loc_100016B0

loc_100016B6:				; CODE XREF: prop_set+1FBj
		lea	eax, [ebp+0Fh]
		push	eax
		call	off_1002D044
		add	esp, 4
		mov	[esp+14h+var_4], eax
		test	eax, eax
		jz	short loc_100016E4
		lea	ecx, [ebp+0Fh]
		push	ecx
		push	0
		push	eax
		call	sub_1000E0F0
		mov	eax, [esp+20h+var_4]
		add	esp, 0Ch
		mov	[eax+8], ebp
		mov	[eax+4], ebp

loc_100016E4:				; CODE XREF: prop_set+219j
		mov	edx, [esi+1Ch]
		mov	[edx], eax
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax], 0
		jz	loc_100017B0
		mov	eax, [eax]
		mov	[esi+1Ch], eax
		add	eax, 0Ch
		mov	[esi+14h], eax
		mov	eax, [esi+1Ch]
		lea	ecx, [eax+ebp+0Ch]
		mov	ebp, [esp+14h+arg_0]
		mov	[esi+10h], ecx

loc_1000170E:				; CODE XREF: prop_set+1F2j
		mov	eax, [esi+1Ch]
		sub	[esi+10h], edi
		sub	[eax+8], edi
		mov	eax, [esp+14h+arg_8]
		mov	ecx, [esi+10h]
		lea	edx, [edi-1]
		push	edx
		push	eax
		push	ecx
		call	sub_1000E2B0
		mov	edx, [esi+10h]
		mov	byte ptr [edx+edi-1], 0
		mov	ecx, [esi+10h]
		mov	eax, [ebx+4]
		add	esp, 0Ch
		mov	[eax+ebp*4-8], ecx
		inc	dword ptr [ebx+8]
		dec	edi
		add	[ebx+0Ch], edi
		pop	edi
		pop	ebx
		pop	ebp
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000174D:				; CODE XREF: prop_set+8Aj prop_set+98j ...
		mov	eax, [esi+1Ch]
		add	dword ptr [eax+8], 0FFFFFFFCh
		add	[esi+14h], ebp
		mov	eax, [esi+14h]
		mov	ebp, [esp+14h+arg_C]
		mov	dword ptr [eax-4], 0
		mov	edi, [esi+14h]
		sub	edi, 8
		mov	[esp+14h+arg_0], edi
		test	ebp, ebp
		jg	short loc_10001786
		mov	eax, edx
		lea	ebp, [eax+1]

loc_10001778:				; CODE XREF: prop_set+2CDj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10001778
		sub	eax, ebp
		lea	ebp, [eax+1]
		jmp	short loc_10001787
; ---------------------------------------------------------------------------

loc_10001786:				; CODE XREF: prop_set+2C1j
		inc	ebp

loc_10001787:				; CODE XREF: prop_set+2D4j
		mov	eax, [esi+1Ch]
		cmp	ebp, [eax+8]
		jbe	short loc_100017D8
		mov	edi, [eax+4]
		add	edi, edi
		cmp	edi, ebp
		jnb	short loc_1000179E

loc_10001798:				; CODE XREF: prop_set+2ECj
		add	edi, edi
		cmp	edi, ebp
		jb	short loc_10001798

loc_1000179E:				; CODE XREF: prop_set+2E6j
		call	sub_10001000
		mov	edx, [esi+1Ch]
		mov	[edx], eax
		mov	eax, [esi+1Ch]
		cmp	dword ptr [eax], 0
		jnz	short loc_100017BB

loc_100017B0:				; CODE XREF: prop_set+15Bj
					; prop_set+23Fj
		pop	edi
		pop	ebx
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100017BB:				; CODE XREF: prop_set+2FEj
		mov	eax, [eax]
		mov	edx, [esp+14h+arg_8]
		mov	[esi+1Ch], eax
		add	eax, 0Ch
		mov	[esi+14h], eax
		mov	eax, [esi+1Ch]
		lea	ecx, [edi+eax+0Ch]
		mov	edi, [esp+14h+arg_0]
		mov	[esi+10h], ecx

loc_100017D8:				; CODE XREF: prop_set+2DDj
		mov	eax, [esi+1Ch]
		sub	[esi+10h], ebp
		sub	[eax+8], ebp
		mov	ecx, [esi+10h]
		lea	eax, [ebp-1]
		push	eax
		push	edx
		push	ecx
		call	sub_1000E2B0
		mov	edx, [esi+10h]
		mov	byte ptr [edx+ebp-1], 0
		mov	eax, [esi+10h]
		mov	[edi], eax
		inc	dword ptr [ebx+8]
		dec	ebp
		add	esp, 0Ch
		add	[ebx+0Ch], ebp

loc_10001806:				; CODE XREF: prop_set+79j prop_set+E5j ...
		pop	edi
		pop	ebx
		pop	ebp
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
prop_set	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  18. prop_setvals

; =============== S U B	R O U T	I N E =======================================


		public prop_setvals
prop_setvals	proc near		; CODE XREF: prop_dup+8Dp
					; DATA XREF: sub_10007350+196o	...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_8]
		push	edi
		mov	edi, [esp+8+arg_0]
		xor	eax, eax
		test	edi, edi
		jnz	short loc_10001826
		lea	eax, [edi-7]
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001826:				; CODE XREF: prop_setvals+Ej
		test	esi, esi
		jnz	short loc_1000182F
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000182F:				; CODE XREF: prop_setvals+18j
		mov	ecx, [esp+8+arg_4]
		test	ecx, ecx
		jz	short loc_10001849
		mov	eax, [esi]
		push	0
		push	eax
		push	ecx
		push	edi
		call	prop_set
		add	esp, 10h
		add	esi, 4

loc_10001849:				; CODE XREF: prop_setvals+25j
		mov	ecx, [esi]
		test	ecx, ecx
		jz	short loc_1000186A
		nop

loc_10001850:				; CODE XREF: prop_setvals+58j
		test	eax, eax
		jnz	short loc_1000186A
		push	eax
		push	ecx
		push	eax
		push	edi
		call	prop_set
		mov	ecx, [esi+4]
		add	esi, 4
		add	esp, 10h
		test	ecx, ecx
		jnz	short loc_10001850

loc_1000186A:				; CODE XREF: prop_setvals+3Dj
					; prop_setvals+42j
		pop	edi
		pop	esi
		retn
prop_setvals	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  20. sasl_auxprop_getctx

; =============== S U B	R O U T	I N E =======================================


		public sasl_auxprop_getctx
sasl_auxprop_getctx proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_10001887
		cmp	dword ptr [eax], 1
		jnz	short loc_10001887
		mov	eax, [eax+1134h]
		mov	eax, [eax+60h]
		retn
; ---------------------------------------------------------------------------

loc_10001887:				; CODE XREF: sasl_auxprop_getctx+6j
					; sasl_auxprop_getctx+Bj
		xor	eax, eax
		retn
sasl_auxprop_getctx endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  19. sasl_auxprop_add_plugin

; =============== S U B	R O U T	I N E =======================================


		public sasl_auxprop_add_plugin
sasl_auxprop_add_plugin	proc near	; DATA XREF: sasl_server_init+36o
					; .rdata:off_1002C568o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		sub	esp, 8
		push	esi
		push	eax
		mov	eax, sasl_global_utils
		lea	ecx, [esp+10h+var_8]
		push	ecx
		lea	edx, [esp+14h+var_4]
		push	edx
		push	8
		push	eax
		call	[esp+20h+arg_4]
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_100018C4
		cmp	[esp+0Ch+var_4], 8
		jge	short loc_100018E7
		mov	esi, 0FFFFFFE9h

loc_100018C4:				; CODE XREF: sasl_auxprop_add_plugin+26j
		push	0
		push	0
		push	esi
		call	sasl_errstring
		push	eax
		push	offset aAuxpropfuncErr ; "auxpropfunc error %s\n"
		push	1
		push	0
		call	sub_10006F30
		add	esp, 1Ch
		mov	eax, esi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100018E7:				; CODE XREF: sasl_auxprop_add_plugin+2Dj
		mov	ecx, [esp+0Ch+var_8]
		cmp	dword ptr [ecx+10h], 0
		jnz	short loc_100018FB
		mov	eax, 0FFFFFFFBh
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100018FB:				; CODE XREF: sasl_auxprop_add_plugin+5Fj
		push	8
		call	off_1002D044
		add	esp, 4
		test	eax, eax
		jnz	short loc_10001914
		mov	eax, 0FFFFFFFEh
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10001914:				; CODE XREF: sasl_auxprop_add_plugin+78j
		mov	edx, [esp+0Ch+var_8]
		mov	ecx, dword_1002E400
		mov	[eax+4], edx
		mov	[eax], ecx
		mov	dword_1002E400,	eax
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
sasl_auxprop_add_plugin	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001930	proc near		; CODE XREF: sub_10009FE0:loc_1000A070p
		push	esi
		mov	esi, dword_1002E400
		test	esi, esi
		jz	short loc_1000196F
		push	edi
		lea	esp, [esp+0]

loc_10001940:				; CODE XREF: sub_10001930+3Cj
		mov	eax, [esi+4]
		cmp	dword ptr [eax+0Ch], 0
		mov	edi, [esi]
		jz	short loc_1000195E
		mov	ecx, sasl_global_utils
		mov	edx, [eax+8]
		mov	eax, [eax+0Ch]
		push	ecx
		push	edx
		call	eax
		add	esp, 8

loc_1000195E:				; CODE XREF: sub_10001930+19j
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	esi, edi
		test	edi, edi
		jnz	short loc_10001940
		pop	edi

loc_1000196F:				; CODE XREF: sub_10001930+9j
		mov	dword_1002E400,	0
		pop	esi
		retn
sub_10001930	endp

; ---------------------------------------------------------------------------
		align 10h
		lea	edx, [ecx+1Ah]	; switch 27 cases
		cmp	edx, 1Ah
		ja	short loc_100019B5 ; jumptable 1000198F	default	case
		movzx	edx, ds:byte_100019D4[edx]
		jmp	ds:off_100019B8[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10001996:				; CODE XREF: .text:1000198Fj
					; DATA XREF: .text:off_100019B8o
		xor	ecx, ecx	; jumptable 1000198F case -26

loc_10001998:				; CODE XREF: .text:1000198Fj
					; DATA XREF: .text:off_100019B8o
		cmp	eax, 0FFFFFFFCh	; jumptable 1000198F case 0
		jz	short loc_100019B5 ; jumptable 1000198F	default	case
		cmp	eax, 0FFFFFFECh
		jmp	short loc_100019B3
; ---------------------------------------------------------------------------

loc_100019A2:				; CODE XREF: .text:1000198Fj
					; DATA XREF: .text:off_100019B8o
		cmp	eax, 0FFFFFFFCh	; jumptable 1000198F case -20
		jmp	short loc_100019B3
; ---------------------------------------------------------------------------

loc_100019A7:				; CODE XREF: .text:1000198Fj
					; DATA XREF: .text:off_100019B8o
		cmp	eax, 0FFFFFFFCh	; jumptable 1000198F case -19
		jz	short loc_100019B5 ; jumptable 1000198F	default	case
		cmp	eax, 0FFFFFFECh
		jz	short loc_100019B5 ; jumptable 1000198F	default	case
		test	eax, eax

loc_100019B3:				; CODE XREF: .text:100019A0j
					; .text:100019A5j
		jnz	short locret_100019B7 ;	jumptable 1000198F case	-4

loc_100019B5:				; CODE XREF: .text:10001986j
					; .text:1000198Fj ...
		mov	eax, ecx	; jumptable 1000198F default case

locret_100019B7:			; CODE XREF: .text:1000198Fj
					; .text:loc_100019B3j
					; DATA XREF: ...
		retn			; jumptable 1000198F case -4
; ---------------------------------------------------------------------------
off_100019B8	dd offset loc_10001996	; DATA XREF: .text:1000198Fr
		dd offset loc_100019B5	; jump table for switch	statement
		dd offset loc_100019A2
		dd offset loc_100019A7
		dd offset locret_100019B7
		dd offset loc_10001998
		dd offset loc_100019B5
byte_100019D4	db	0,     6,     1,     6 ; DATA XREF: .text:10001988r
		db	6,     6,     2,     3 ; indirect table	for switch statement
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     4,     6
		db	6,     6,     5
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100019F0	proc near		; CODE XREF: sub_10002710+49p
					; sub_10002710+74p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpMem		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 1Ch
		push	ebx
		push	ebp
		mov	ebp, [esp+24h+arg_0]
		mov	edx, [ebp+34h]
		push	esi
		push	edi
		lea	eax, [esp+2Ch+var_C]
		push	eax
		xor	ebx, ebx
		lea	ecx, [esp+30h+var_8]
		push	ecx
		mov	[esp+34h+var_1C], ebx
		mov	eax, [edx+4]
		push	1
		push	eax
		mov	[esp+3Ch+var_10], ebx
		lea	esi, [ebx-4]
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10001A49
		mov	edx, [esp+2Ch+var_C]
		push	ebx
		lea	ecx, [esp+30h+var_1C]
		push	ecx
		push	offset aAuxprop_plug_0 ; "auxprop_plugin"
		push	ebx
		push	edx
		call	[esp+40h+var_8]
		add	esp, 14h
		test	eax, eax
		jz	short loc_10001A49
		mov	[esp+2Ch+var_1C], ebx
		jmp	short loc_10001A55
; ---------------------------------------------------------------------------

loc_10001A49:				; CODE XREF: sub_100019F0+35j
					; sub_100019F0+51j
		mov	eax, [esp+2Ch+var_1C]
		cmp	eax, ebx
		jnz	loc_10001AD2

loc_10001A55:				; CODE XREF: sub_100019F0+57j
		mov	edi, dword_1002E400
		cmp	edi, ebx
		jz	loc_10001C3E
		mov	ebp, [esp+2Ch+arg_C]
		mov	ebx, [esp+2Ch+arg_8]
		jmp	short loc_10001A70
; ---------------------------------------------------------------------------
		align 10h

loc_10001A70:				; CODE XREF: sub_100019F0+7Bj
					; sub_100019F0+D6j
		mov	ecx, [esp+2Ch+arg_4]
		mov	eax, [edi+4]
		mov	edx, [esp+2Ch+arg_0]
		push	ebp
		push	ebx
		push	ecx
		mov	ecx, [eax+8]
		push	edx
		mov	edx, [eax+10h]
		push	ecx
		call	edx
		lea	ecx, [eax+1Ah]
		add	esp, 14h
		cmp	ecx, 1Ah	; switch 27 cases
		ja	short loc_10001AC0 ; jumptable 10001A9A	default	case
		movzx	ecx, ds:byte_10001C80[ecx]
		jmp	ds:off_10001C64[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10001AA1:				; CODE XREF: sub_100019F0+AAj
					; DATA XREF: .text:off_10001C64o
		xor	eax, eax	; jumptable 10001A9A case 0

loc_10001AA3:				; CODE XREF: sub_100019F0+AAj
					; DATA XREF: .text:off_10001C64o
		cmp	esi, 0FFFFFFFCh	; jumptable 10001A9A case 26
		jz	short loc_10001AC0 ; jumptable 10001A9A	default	case
		cmp	esi, 0FFFFFFECh
		jmp	short loc_10001ABE
; ---------------------------------------------------------------------------

loc_10001AAD:				; CODE XREF: sub_100019F0+AAj
					; DATA XREF: .text:off_10001C64o
		cmp	esi, 0FFFFFFFCh	; jumptable 10001A9A case 6
		jmp	short loc_10001ABE
; ---------------------------------------------------------------------------

loc_10001AB2:				; CODE XREF: sub_100019F0+AAj
					; DATA XREF: .text:off_10001C64o
		cmp	esi, 0FFFFFFFCh	; jumptable 10001A9A case 7
		jz	short loc_10001AC0 ; jumptable 10001A9A	default	case
		cmp	esi, 0FFFFFFECh
		jz	short loc_10001AC0 ; jumptable 10001A9A	default	case
		test	esi, esi

loc_10001ABE:				; CODE XREF: sub_100019F0+BBj
					; sub_100019F0+C0j
		jnz	short loc_10001AC2 ; jumptable 10001A9A	case 22

loc_10001AC0:				; CODE XREF: sub_100019F0+A1j
					; sub_100019F0+AAj ...
		mov	esi, eax	; jumptable 10001A9A default case

loc_10001AC2:				; CODE XREF: sub_100019F0+AAj
					; sub_100019F0:loc_10001ABEj
					; DATA XREF: ...
		mov	edi, [edi]	; jumptable 10001A9A case 22
		test	edi, edi
		jnz	short loc_10001A70
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10001AD2:				; CODE XREF: sub_100019F0+5Fj
		push	ebx
		lea	edx, [esp+30h+var_18]
		push	edx
		push	eax
		mov	[esp+38h+var_18], ebx
		call	sub_10004910
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10001AF6
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10001AF6:				; CODE XREF: sub_100019F0+F7j
		mov	eax, [esp+2Ch+var_18]
		cmp	byte ptr [eax],	0
		mov	[esp+2Ch+lpMem], eax
		mov	ebx, eax
		jz	loc_10001C21
		lea	esp, [esp+0]

loc_10001B10:				; CODE XREF: sub_100019F0+22Bj
		mov	al, [ebx]
		mov	[esp+2Ch+var_14], 0
		test	al, al
		jz	loc_10001C21

loc_10001B22:				; CODE XREF: sub_100019F0+148j
		movsx	eax, al
		push	eax
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jz	short loc_10001B3F
		mov	al, [ebx+1]
		inc	ebx
		test	al, al
		jnz	short loc_10001B22
		jmp	loc_10001C21
; ---------------------------------------------------------------------------

loc_10001B3F:				; CODE XREF: sub_100019F0+140j
		cmp	byte ptr [ebx],	0
		jz	loc_10001C21
		mov	edi, ebx
		mov	[esp+2Ch+arg_0], edi
		mov	edi, edi

loc_10001B50:				; CODE XREF: sub_100019F0+173j
		movsx	ecx, byte ptr [edi]
		push	ecx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jnz	short loc_10001B65
		inc	edi
		cmp	[edi], al
		jnz	short loc_10001B50

loc_10001B65:				; CODE XREF: sub_100019F0+16Ej
		cmp	byte ptr [edi],	0
		mov	[esp+2Ch+arg_0], edi
		jnz	short loc_10001B78
		mov	[esp+2Ch+var_14], 1
		jmp	short loc_10001B7B
; ---------------------------------------------------------------------------

loc_10001B78:				; CODE XREF: sub_100019F0+17Cj
		mov	byte ptr [edi],	0

loc_10001B7B:				; CODE XREF: sub_100019F0+186j
		mov	edi, dword_1002E400
		test	edi, edi
		jz	loc_10001C0C
		lea	esp, [esp+0]

loc_10001B90:				; CODE XREF: sub_100019F0+21Aj
		mov	edx, [edi+4]
		mov	eax, [edx+14h]
		test	eax, eax
		jz	short loc_10001C06 ; jumptable 10001BDE	case 22
		push	ebx
		push	eax
		call	sub_10023E83
		add	esp, 8
		test	eax, eax
		jnz	short loc_10001C06 ; jumptable 10001BDE	case 22
		mov	ecx, [esp+2Ch+arg_C]
		mov	edx, [esp+2Ch+arg_8]
		mov	eax, [edi+4]
		push	ecx
		mov	ecx, [esp+30h+arg_4]
		push	edx
		mov	edx, [eax+8]
		mov	eax, [eax+10h]
		push	ecx
		push	ebp
		push	edx
		mov	[esp+40h+var_10], 1
		call	eax
		lea	ecx, [eax+1Ah]
		add	esp, 14h
		cmp	ecx, 1Ah	; switch 27 cases
		ja	short loc_10001C04 ; jumptable 10001BDE	default	case
		movzx	ecx, ds:byte_10001CB8[ecx]
		jmp	ds:off_10001C9C[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10001BE5:				; CODE XREF: sub_100019F0+1EEj
					; DATA XREF: .text:off_10001C9Co
		xor	eax, eax	; jumptable 10001BDE case 0

loc_10001BE7:				; CODE XREF: sub_100019F0+1EEj
					; DATA XREF: .text:off_10001C9Co
		cmp	esi, 0FFFFFFFCh	; jumptable 10001BDE case 26
		jz	short loc_10001C04 ; jumptable 10001BDE	default	case
		cmp	esi, 0FFFFFFECh
		jmp	short loc_10001C02
; ---------------------------------------------------------------------------

loc_10001BF1:				; CODE XREF: sub_100019F0+1EEj
					; DATA XREF: .text:off_10001C9Co
		cmp	esi, 0FFFFFFFCh	; jumptable 10001BDE case 6
		jmp	short loc_10001C02
; ---------------------------------------------------------------------------

loc_10001BF6:				; CODE XREF: sub_100019F0+1EEj
					; DATA XREF: .text:off_10001C9Co
		cmp	esi, 0FFFFFFFCh	; jumptable 10001BDE case 7
		jz	short loc_10001C04 ; jumptable 10001BDE	default	case
		cmp	esi, 0FFFFFFECh
		jz	short loc_10001C04 ; jumptable 10001BDE	default	case
		test	esi, esi

loc_10001C02:				; CODE XREF: sub_100019F0+1FFj
					; sub_100019F0+204j
		jnz	short loc_10001C06 ; jumptable 10001BDE	case 22

loc_10001C04:				; CODE XREF: sub_100019F0+1E5j
					; sub_100019F0+1EEj ...
		mov	esi, eax	; jumptable 10001BDE default case

loc_10001C06:				; CODE XREF: sub_100019F0+1A8j
					; sub_100019F0+1B6j ...
		mov	edi, [edi]	; jumptable 10001BDE case 22
		test	edi, edi
		jnz	short loc_10001B90

loc_10001C0C:				; CODE XREF: sub_100019F0+193j
		cmp	[esp+2Ch+var_14], 0
		jnz	short loc_10001C21
		mov	ebx, [esp+2Ch+arg_0]
		inc	ebx
		cmp	byte ptr [ebx],	0
		jnz	loc_10001B10

loc_10001C21:				; CODE XREF: sub_100019F0+113j
					; sub_100019F0+12Cj ...
		mov	edx, [esp+2Ch+lpMem]
		push	edx		; lpMem
		call	off_1002D050
		add	esp, 4
		cmp	[esp+2Ch+var_10], 0
		jnz	short loc_10001C5A
		mov	eax, [esp+2Ch+var_1C]
		test	eax, eax
		jnz	short loc_10001C43

loc_10001C3E:				; CODE XREF: sub_100019F0+6Dj
		mov	eax, offset aAll ; "[all]"

loc_10001C43:				; CODE XREF: sub_100019F0+24Cj
		push	eax
		mov	eax, [ebp+34h]
		mov	ecx, [eax+4]
		push	offset aCouldNotFind_0 ; "could	not find auxprop plugin, was sear"...
		push	5
		push	ecx
		call	sub_10006F30
		add	esp, 10h

loc_10001C5A:				; CODE XREF: sub_100019F0+244j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
sub_100019F0	endp

; ---------------------------------------------------------------------------
off_10001C64	dd offset loc_10001AA1	; DATA XREF: sub_100019F0+AAr
		dd offset loc_10001AC0	; jump table for switch	statement
		dd offset loc_10001AAD
		dd offset loc_10001AB2
		dd offset loc_10001AC2
		dd offset loc_10001AA3
		dd offset loc_10001AC0
byte_10001C80	db	0,     6,     1,     6 ; DATA XREF: sub_100019F0+A3r
		db	6,     6,     2,     3 ; indirect table	for switch statement
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     4,     6
		db	6,     6,     5
		align 4
off_10001C9C	dd offset loc_10001BE5	; DATA XREF: sub_100019F0+1EEr
		dd offset loc_10001C04	; jump table for switch	statement
		dd offset loc_10001BF1
		dd offset loc_10001BF6
		dd offset loc_10001C06
		dd offset loc_10001BE7
		dd offset loc_10001C04
byte_10001CB8	db	0,     6,     1,     6 ; DATA XREF: sub_100019F0+1E7r
		db	6,     6,     2,     3 ; indirect table	for switch statement
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     4,     6
		db	6,     6,     5
		align 10h
; Exported entry  22. sasl_auxprop_store

; =============== S U B	R O U T	I N E =======================================


		public sasl_auxprop_store
sasl_auxprop_store proc	near		; CODE XREF: sasl_setpass+131p
					; sasl_setpass+1D4p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpMem		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 28h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+34h+arg_0]
		push	edi
		xor	edi, edi
		xor	ebx, ebx
		xor	ebp, ebp
		mov	[esp+38h+var_20], edi
		mov	[esp+38h+var_18], ebx
		mov	[esp+38h+var_1C], ebp
		mov	[esp+38h+var_24], edi
		mov	[esp+38h+var_28], edi
		cmp	[esp+38h+arg_4], edi
		jz	short loc_10001D37
		cmp	esi, edi
		jz	short loc_10001D74
		mov	eax, [esp+38h+arg_8]
		cmp	eax, edi
		jz	short loc_10001D74
		mov	ecx, [esi+1134h]
		mov	[esp+38h+var_18], ecx
		lea	edx, [eax+1]

loc_10001D24:				; CODE XREF: sasl_auxprop_store+49j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10001D24
		mov	ebx, [esp+38h+var_18]
		sub	eax, edx
		mov	[esp+38h+var_1C], eax
		mov	ebp, eax

loc_10001D37:				; CODE XREF: sasl_auxprop_store+29j
		lea	edx, [esp+38h+var_C]
		push	edx
		lea	eax, [esp+3Ch+var_8]
		push	eax
		push	1
		push	esi
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10001D81
		mov	edx, [esp+38h+var_C]
		push	edi
		lea	ecx, [esp+3Ch+var_20]
		push	ecx
		push	offset aAuxprop_plug_0 ; "auxprop_plugin"
		push	edi
		push	edx
		call	[esp+4Ch+var_8]
		add	esp, 14h
		test	eax, eax
		jz	short loc_10001D81
		xor	eax, eax
		mov	[esp+38h+var_20], eax
		jmp	short loc_10001D85
; ---------------------------------------------------------------------------

loc_10001D74:				; CODE XREF: sasl_auxprop_store+2Dj
					; sasl_auxprop_store+35j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFF9h
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10001D81:				; CODE XREF: sasl_auxprop_store+6Ej
					; sasl_auxprop_store+8Aj
		mov	eax, [esp+38h+var_20]

loc_10001D85:				; CODE XREF: sasl_auxprop_store+92j
		test	eax, eax
		jnz	short loc_10001DDB
		mov	esi, dword_1002E400
		test	esi, esi
		jz	loc_10001F10

loc_10001D97:				; CODE XREF: sasl_auxprop_store+F4j
		test	edi, edi
		jnz	loc_10001F00
		mov	eax, [esi+4]
		inc	[esp+38h+var_28]
		cmp	[eax+18h], edi
		jz	short loc_10001DD0
		mov	ecx, [esp+38h+arg_8]
		mov	edx, [esp+38h+arg_4]
		push	ebp
		push	ecx
		mov	ecx, [eax+8]
		push	edx
		mov	edx, [eax+18h]
		push	ebx
		push	ecx
		call	edx
		mov	edi, eax
		add	esp, 14h
		cmp	edi, 0FFFFFFE2h
		jnz	short loc_10001DD0
		xor	edi, edi
		inc	[esp+38h+var_24]

loc_10001DD0:				; CODE XREF: sasl_auxprop_store+C9j
					; sasl_auxprop_store+E8j
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_10001D97
		jmp	loc_10001F00
; ---------------------------------------------------------------------------

loc_10001DDB:				; CODE XREF: sasl_auxprop_store+A7j
		push	0
		lea	ecx, [esp+3Ch+var_14]
		push	ecx
		push	eax
		mov	[esp+44h+var_14], edi
		call	sub_10004910
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10001F27
		mov	ebp, [esp+38h+var_14]
		mov	[esp+38h+lpMem], ebp
		cmp	[ebp+0], al
		jz	loc_10001EF2
		jmp	short loc_10001E10
; ---------------------------------------------------------------------------
		align 10h

loc_10001E10:				; CODE XREF: sasl_auxprop_store+128j
					; sasl_auxprop_store+20Cj
		mov	al, [ebp+0]
		mov	[esp+38h+var_10], 0
		test	al, al
		jz	loc_10001EF2

loc_10001E23:				; CODE XREF: sasl_auxprop_store+159j
		movsx	edx, al
		push	edx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jz	short loc_10001E40
		mov	al, [ebp+1]
		inc	ebp
		test	al, al
		jnz	short loc_10001E23
		jmp	loc_10001EF2
; ---------------------------------------------------------------------------

loc_10001E40:				; CODE XREF: sasl_auxprop_store+151j
		cmp	byte ptr [ebp+0], 0
		jz	loc_10001EF2
		mov	ebx, ebp
		lea	esp, [esp+0]

loc_10001E50:				; CODE XREF: sasl_auxprop_store+183j
		movsx	eax, byte ptr [ebx]
		push	eax
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jnz	short loc_10001E65
		inc	ebx
		cmp	[ebx], al
		jnz	short loc_10001E50

loc_10001E65:				; CODE XREF: sasl_auxprop_store+17Ej
		cmp	byte ptr [ebx],	0
		jnz	short loc_10001E74
		mov	[esp+38h+var_10], 1
		jmp	short loc_10001E77
; ---------------------------------------------------------------------------

loc_10001E74:				; CODE XREF: sasl_auxprop_store+188j
		mov	byte ptr [ebx],	0

loc_10001E77:				; CODE XREF: sasl_auxprop_store+192j
		mov	esi, dword_1002E400
		test	esi, esi
		jz	short loc_10001EDE

loc_10001E81:				; CODE XREF: sasl_auxprop_store+1FCj
		test	edi, edi
		jnz	short loc_10001EDE
		mov	ecx, [esi+4]
		mov	eax, [ecx+14h]
		test	eax, eax
		jz	short loc_10001ED8
		push	ebp
		push	eax
		call	sub_10023E83
		add	esp, 8
		test	eax, eax
		jnz	short loc_10001ED8
		mov	edx, [esi+4]
		inc	[esp+38h+var_28]
		cmp	[edx+18h], eax
		jz	short loc_10001ED8
		mov	ecx, [esp+38h+var_1C]
		push	ecx
		mov	ecx, [esp+3Ch+arg_4]
		mov	eax, edx
		mov	edx, [esp+3Ch+arg_8]
		push	edx
		mov	edx, [esp+40h+var_18]
		push	ecx
		mov	ecx, [eax+8]
		push	edx
		mov	edx, [eax+18h]
		push	ecx
		call	edx
		mov	edi, eax
		add	esp, 14h
		cmp	edi, 0FFFFFFE2h
		jnz	short loc_10001ED8
		xor	edi, edi
		inc	[esp+38h+var_24]

loc_10001ED8:				; CODE XREF: sasl_auxprop_store+1ADj
					; sasl_auxprop_store+1BBj ...
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_10001E81

loc_10001EDE:				; CODE XREF: sasl_auxprop_store+19Fj
					; sasl_auxprop_store+1A3j
		cmp	[esp+38h+var_10], 0
		jnz	short loc_10001EF2
		cmp	byte ptr [ebx+1], 0
		lea	ebp, [ebx+1]
		jnz	loc_10001E10

loc_10001EF2:				; CODE XREF: sasl_auxprop_store+122j
					; sasl_auxprop_store+13Dj ...
		mov	eax, [esp+38h+lpMem]
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10001F00:				; CODE XREF: sasl_auxprop_store+B9j
					; sasl_auxprop_store+F6j
		mov	eax, [esp+38h+var_28]
		test	eax, eax
		jnz	short loc_10001F32
		mov	eax, [esp+38h+var_20]
		test	eax, eax
		jnz	short loc_10001F15

loc_10001F10:				; CODE XREF: sasl_auxprop_store+B1j
		mov	eax, offset aAll ; "[all]"

loc_10001F15:				; CODE XREF: sasl_auxprop_store+22Ej
		push	eax
		push	offset aCouldNotFindAu ; "could	not find auxprop plugin, was sear"...
		push	1
		push	0
		call	sub_10006F30
		add	esp, 10h

loc_10001F27:				; CODE XREF: sasl_auxprop_store+111j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10001F32:				; CODE XREF: sasl_auxprop_store+226j
		cmp	eax, [esp+38h+var_24]
		jnz	short loc_10001F3D
		mov	edi, 0FFFFFFE2h

loc_10001F3D:				; CODE XREF: sasl_auxprop_store+256j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 28h
		retn
sasl_auxprop_store endp

; ---------------------------------------------------------------------------
		align 10h

loc_10001F50:				; DATA XREF: auxprop_plugin_info+Co
		mov	eax, [esp+8]
		test	eax, eax
		jnz	short loc_10001F66
		push	offset aListOfAuxpropP ; "List of auxprop plugins follows\n"
		call	sub_1000ED67
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_10001F66:				; CODE XREF: .text:10001F56j
		cmp	eax, 2
		jz	short locret_10001FB6
		push	esi
		mov	esi, [esp+8]
		mov	eax, [esi+14h]
		push	eax
		push	offset aPluginS	; "Plugin \"%s\" "
		call	sub_1000ED67
		push	8
		push	offset aApiVersionD ; ", \tAPI version:	%d\n"
		call	sub_1000ED67
		add	esp, 10h
		cmp	dword ptr [esi+18h], 0
		pop	esi
		mov	eax, offset aYes ; "yes"
		jnz	short loc_10001F9E
		mov	eax, offset aNo	; "no"

loc_10001F9E:				; CODE XREF: .text:10001F97j
		push	eax
		push	offset aSupportsStoreS ; "\tsupports store: %s\n"
		call	sub_1000ED67
		push	offset asc_100272D8 ; "\n"
		call	sub_1000ED67
		add	esp, 0Ch

locret_10001FB6:			; CODE XREF: .text:10001F69j
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. auxprop_plugin_info

; =============== S U B	R O U T	I N E =======================================


		public auxprop_plugin_info
auxprop_plugin_info proc near		; DATA XREF: .rdata:off_1002C568o

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 24h
		push	ebp
		mov	ebp, [esp+28h+arg_4]
		test	ebp, ebp
		jnz	short loc_10001FD8
		mov	[esp+28h+arg_4], offset	loc_10001F50
		mov	ebp, [esp+28h+arg_4]

loc_10001FD8:				; CODE XREF: auxprop_plugin_info+Aj
		cmp	dword_1002E400,	0
		jz	loc_100020E5
		mov	eax, [esp+28h+arg_8]
		push	ebx
		push	esi
		push	edi
		push	eax
		push	0
		push	0
		call	ebp
		mov	eax, [esp+40h+arg_0]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000203A
		mov	ebx, dword_1002E400
		test	ebx, ebx
		jz	loc_100020CD
		lea	esp, [esp+0]

loc_10002010:				; CODE XREF: auxprop_plugin_info+73j
		mov	esi, [ebx+4]
		mov	ecx, 7
		lea	edi, [esp+34h+var_1C]
		rep movsd
		mov	ecx, [esp+34h+arg_8]
		push	ecx
		lea	edx, [esp+38h+var_1C]
		push	1
		push	edx
		call	ebp
		mov	ebx, [ebx]
		add	esp, 0Ch
		test	ebx, ebx
		jnz	short loc_10002010
		jmp	loc_100020CD
; ---------------------------------------------------------------------------

loc_1000203A:				; CODE XREF: auxprop_plugin_info+3Cj
		push	eax
		call	sub_1002449A
		mov	esi, eax
		add	esp, 4
		mov	[esp+34h+var_20], esi
		mov	[esp+34h+var_24], esi
		test	esi, esi
		jz	short loc_100020C4

loc_10002051:				; CODE XREF: auxprop_plugin_info+FEj
		mov	eax, [esp+34h+var_24]
		push	20h
		push	eax
		call	sub_1000EF20
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	short loc_1000206B
		mov	byte ptr [ebp+0], 0
		inc	ebp

loc_1000206B:				; CODE XREF: auxprop_plugin_info+A4j
		mov	ebx, dword_1002E400
		test	ebx, ebx
		jz	short loc_100020B8

loc_10002075:				; CODE XREF: auxprop_plugin_info+F2j
		mov	ecx, [ebx+4]
		mov	edx, [ecx+14h]
		mov	eax, [esp+34h+var_24]
		push	edx
		push	eax
		call	sub_10023E83
		add	esp, 8
		test	eax, eax
		jnz	short loc_100020AE
		mov	esi, [ebx+4]
		mov	ecx, 7
		lea	edi, [esp+34h+var_1C]
		rep movsd
		mov	ecx, [esp+34h+arg_8]
		push	ecx
		lea	edx, [esp+38h+var_1C]
		push	1
		push	edx
		call	[esp+40h+arg_4]
		add	esp, 0Ch

loc_100020AE:				; CODE XREF: auxprop_plugin_info+CBj
		mov	ebx, [ebx]
		test	ebx, ebx
		jnz	short loc_10002075
		mov	esi, [esp+34h+var_20]

loc_100020B8:				; CODE XREF: auxprop_plugin_info+B3j
		mov	[esp+34h+var_24], ebp
		test	ebp, ebp
		jnz	short loc_10002051
		mov	ebp, [esp+34h+arg_4]

loc_100020C4:				; CODE XREF: auxprop_plugin_info+8Fj
		push	esi		; lpMem
		call	sub_1000EE73
		add	esp, 4

loc_100020CD:				; CODE XREF: auxprop_plugin_info+46j
					; auxprop_plugin_info+75j
		mov	eax, [esp+34h+arg_8]
		push	eax
		push	2
		push	0
		call	ebp
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebx
		xor	eax, eax
		pop	ebp
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_100020E5:				; CODE XREF: auxprop_plugin_info+1Fj
		mov	eax, 0FFFFFFF4h
		pop	ebp
		add	esp, 24h
		retn
auxprop_plugin_info endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  15. prop_new

; =============== S U B	R O U T	I N E =======================================


		public prop_new
prop_new	proc near		; CODE XREF: prop_dup+2Cp
					; sasl_server_new+167p
					; DATA XREF: ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		test	esi, esi
		jnz	short loc_100020FF
		mov	esi, 3FCh

loc_100020FF:				; CODE XREF: prop_new+8j
		push	20h
		call	off_1002D044
		mov	edi, eax
		add	esp, 4
		mov	[esp+8+arg_0], edi
		test	edi, edi
		jnz	short loc_10002117
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10002117:				; CODE XREF: prop_new+22j
		mov	eax, esi
		call	sub_10001050
		test	eax, eax
		jz	short loc_10002133
		lea	eax, [esp+8+arg_0]
		push	eax
		call	prop_dispose
		mov	edi, [esp+0Ch+arg_0]
		add	esp, 4

loc_10002133:				; CODE XREF: prop_new+30j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
prop_new	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  10. prop_dup

; =============== S U B	R O U T	I N E =======================================


		public prop_dup
prop_dup	proc near		; DATA XREF: sub_10007350+146o
					; .rdata:off_1002C568o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		xor	ecx, ecx
		test	edi, edi
		jz	loc_10002211
		cmp	[esp+8+arg_4], ecx
		jz	loc_10002211
		mov	eax, [edi+18h]
		test	eax, eax
		jz	short loc_1000216A

loc_10002161:				; CODE XREF: prop_dup+28j
		add	ecx, [eax+4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_10002161

loc_1000216A:				; CODE XREF: prop_dup+1Fj
		push	esi
		push	ecx
		call	prop_new
		mov	esi, eax
		add	esp, 4
		mov	[esp+0Ch+arg_0], esi
		test	esi, esi
		jnz	short loc_10002185
		lea	eax, [esi-2]
		pop	esi
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10002185:				; CODE XREF: prop_dup+3Cj
		mov	eax, [edi+8]
		mov	[esi+8], eax
		mov	eax, [edi+8]
		inc	eax
		mov	[esi+0Ch], eax
		mov	ecx, [esi+18h]
		mov	edx, [ecx+4]
		shl	eax, 4
		sub	edx, eax
		mov	[ecx+8], edx
		mov	ecx, [esi+18h]
		push	ebx
		push	ebp
		lea	edx, [eax+ecx+0Ch]
		xor	ebp, ebp
		mov	[esi+14h], edx
		cmp	[edi+8], ebp
		jbe	short loc_100021E6
		xor	ebx, ebx

loc_100021B5:				; CODE XREF: prop_dup+A4j
		mov	eax, [edi]
		mov	edx, [ebx+eax]
		mov	ecx, [esi]
		mov	[ebx+ecx], edx
		mov	eax, [edi]
		mov	ecx, [ebx+eax+4]
		mov	edx, [esi]
		mov	eax, [edx+ebx]
		push	ecx
		push	eax
		push	esi
		call	prop_setvals
		add	esp, 0Ch
		mov	[esp+14h+var_4], eax
		test	eax, eax
		jnz	short loc_100021FA
		inc	ebp
		add	ebx, 10h
		cmp	ebp, [edi+8]
		jb	short loc_100021B5

loc_100021E6:				; CODE XREF: prop_dup+71j
		mov	edx, [edi+4]
		mov	eax, [esp+14h+arg_4]
		pop	ebp
		mov	[esi+4], edx
		pop	ebx
		mov	[eax], esi
		pop	esi
		xor	eax, eax
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100021FA:				; CODE XREF: prop_dup+9Bj
		lea	ecx, [esp+14h+arg_0]
		push	ecx
		call	prop_dispose
		mov	eax, [esp+18h+var_4]
		add	esp, 4
		pop	ebp
		pop	ebx
		pop	esi
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10002211:				; CODE XREF: prop_dup+Aj prop_dup+14j
		mov	eax, 0FFFFFFF9h
		pop	edi
		pop	ecx
		retn
prop_dup	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  16. prop_request

; =============== S U B	R O U T	I N E =======================================


		public prop_request
prop_request	proc near		; CODE XREF: sasl_auxprop_request+60p
					; sub_10002C80+69p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		test	edi, edi
		jz	loc_100023AE
		mov	ecx, [esp+0Ch+arg_4]
		test	ecx, ecx
		jz	loc_100023AE
		xor	eax, eax
		cmp	[ecx], eax
		jz	short loc_10002251

loc_10002242:				; CODE XREF: prop_request+27j
		inc	eax
		cmp	dword ptr [ecx+eax*4], 0
		jnz	short loc_10002242
		mov	[esp+0Ch+arg_0], eax
		test	eax, eax
		jnz	short loc_10002258

loc_10002251:				; CODE XREF: prop_request+20j
		xor	eax, eax
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10002258:				; CODE XREF: prop_request+2Fj
		mov	edx, [edi+8]
		push	ebx
		push	ebp
		push	esi
		lea	esi, [edx+eax+1]
		mov	edx, [edi+0Ch]
		cmp	esi, edx
		jbe	loc_10002310
		mov	eax, [edi+18h]
		mov	ecx, [eax+4]
		shr	ecx, 4
		cmp	esi, ecx
		ja	short loc_1000228C
		mov	[edi+0Ch], esi
		mov	ecx, [eax+4]
		mov	edx, esi
		shl	edx, 4
		sub	ecx, edx
		mov	[eax+8], ecx
		jmp	short loc_100022E4
; ---------------------------------------------------------------------------

loc_1000228C:				; CODE XREF: prop_request+58j
		lea	ebx, [edx+edx]
		cmp	esi, ebx
		jbe	short loc_10002299

loc_10002293:				; CODE XREF: prop_request+77j
		add	ebx, ebx
		cmp	esi, ebx
		ja	short loc_10002293

loc_10002299:				; CODE XREF: prop_request+71j
		mov	ebp, ebx
		shl	ebp, 4
		cmp	[eax+4], ebp
		jnb	short loc_100022B8
		lea	edx, [ebp+10h]
		push	edx		; dwBytes
		push	eax		; lpMem
		call	off_1002D04C
		add	esp, 8
		test	eax, eax
		jz	short loc_100022B8
		mov	[eax+4], ebp

loc_100022B8:				; CODE XREF: prop_request+81j
					; prop_request+93j
		xor	ecx, ecx
		mov	[edi+18h], eax
		cmp	eax, ecx
		jnz	short loc_100022D4
		pop	esi
		pop	ebp
		pop	ebx
		mov	[edi], ecx
		mov	[edi+8], ecx
		mov	[edi+0Ch], ecx
		lea	eax, [ecx-2]
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100022D4:				; CODE XREF: prop_request+9Fj
		lea	ecx, [eax+0Ch]
		mov	[edi], ecx
		mov	[edi+0Ch], ebx
		mov	edx, [eax+4]
		sub	edx, ebp
		mov	[eax+8], edx

loc_100022E4:				; CODE XREF: prop_request+6Aj
		mov	eax, [edi+8]
		mov	ecx, [edi+0Ch]
		sub	ecx, eax
		shl	ecx, 4
		push	ecx
		shl	eax, 4
		add	eax, [edi]
		push	0
		push	eax
		call	sub_1000E0F0
		mov	eax, [esp+24h+arg_0]
		mov	ecx, [esp+24h+arg_4]
		shl	esi, 4
		add	esp, 0Ch
		add	esi, [edi]
		mov	[edi+14h], esi

loc_10002310:				; CODE XREF: prop_request+47j
		xor	edx, edx
		mov	[esp+18h+var_8], edx
		test	eax, eax
		jz	loc_10002399
		mov	edi, edi

loc_10002320:				; CODE XREF: prop_request+177j
		mov	ebp, [edi+8]
		xor	ebx, ebx
		test	ebp, ebp
		jz	short loc_10002375
		mov	edx, [ecx+edx*4]
		mov	esi, [edi]
		mov	[esp+18h+var_4], edx

loc_10002332:				; CODE XREF: prop_request+147j
		mov	ecx, [esp+18h+var_4]
		mov	eax, [esi]

loc_10002338:				; CODE XREF: prop_request+132j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10002358
		test	dl, dl
		jz	short loc_10002354
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10002358
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10002338

loc_10002354:				; CODE XREF: prop_request+120j
		xor	eax, eax
		jmp	short loc_1000235D
; ---------------------------------------------------------------------------

loc_10002358:				; CODE XREF: prop_request+11Cj
					; prop_request+128j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_1000235D:				; CODE XREF: prop_request+136j
		test	eax, eax
		jz	short loc_10002384
		inc	ebx
		add	esi, 10h
		cmp	ebx, ebp
		jb	short loc_10002332
		mov	eax, [esp+18h+arg_0]
		mov	ecx, [esp+18h+arg_4]
		mov	edx, [esp+18h+var_8]

loc_10002375:				; CODE XREF: prop_request+107j
		mov	ebx, [ecx+edx*4]
		mov	esi, [edi]
		add	ebp, ebp
		mov	[esi+ebp*8], ebx
		inc	dword ptr [edi+8]
		jmp	short loc_10002390
; ---------------------------------------------------------------------------

loc_10002384:				; CODE XREF: prop_request+13Fj
		mov	eax, [esp+18h+arg_0]
		mov	ecx, [esp+18h+arg_4]
		mov	edx, [esp+18h+var_8]

loc_10002390:				; CODE XREF: prop_request+162j
		inc	edx
		mov	[esp+18h+var_8], edx
		cmp	edx, eax
		jb	short loc_10002320

loc_10002399:				; CODE XREF: prop_request+F8j
		push	0
		push	edi
		call	prop_clear
		add	esp, 8
		pop	esi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	edi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100023AE:				; CODE XREF: prop_request+Aj
					; prop_request+16j
		mov	eax, 0FFFFFFF9h
		pop	edi
		add	esp, 8
		retn
prop_request	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  21. sasl_auxprop_request

; =============== S U B	R O U T	I N E =======================================


		public sasl_auxprop_request
sasl_auxprop_request proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_100023CE
		lea	eax, [esi-7]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100023CE:				; CODE XREF: sasl_auxprop_request+7j
		cmp	dword ptr [esi], 1
		jz	short loc_100023F5
		push	301h
		push	offset aParameterError ; "Parameter error in auxprop.c near line "...
		push	1
		push	esi
		call	sasl_seterror
		mov	eax, 0FFFFFFF9h
		add	esp, 10h
		mov	[esi+8F0h], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100023F5:				; CODE XREF: sasl_auxprop_request+11j
		mov	eax, [esp+4+arg_4]
		test	eax, eax
		jnz	short loc_10002415
		mov	eax, [esi+1134h]
		mov	ecx, [eax+60h]
		push	1
		push	ecx
		call	prop_clear
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10002415:				; CODE XREF: sasl_auxprop_request+3Bj
		mov	edx, [esi+1134h]
		push	eax
		mov	eax, [edx+60h]
		push	eax
		call	prop_request
		add	esp, 8
		test	eax, eax
		jns	short loc_10002432
		mov	[esi+8F0h], eax

loc_10002432:				; CODE XREF: sasl_auxprop_request+6Aj
		pop	esi
		retn
sasl_auxprop_request endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002440	proc near		; CODE XREF: sub_100027C0+1Cp
					; sasl_checkpass+63p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 20h
		xor	ecx, ecx
		push	edi
		mov	edi, [esp+24h+arg_0]
		mov	[esp+24h+var_14], ecx
		mov	[esp+24h+var_10], ecx
		mov	[esp+24h+var_18], ecx
		cmp	edi, ecx
		jnz	short loc_10002464

loc_1000245A:				; CODE XREF: sub_10002440+28j
					; sub_10002440+30j
		mov	eax, 0FFFFFFF9h
		pop	edi
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10002464:				; CODE XREF: sub_10002440+18j
		cmp	[esp+24h+arg_4], ecx
		jz	short loc_1000245A
		mov	eax, [esp+24h+arg_10]
		cmp	eax, ecx
		jz	short loc_1000245A
		mov	edx, [esp+24h+arg_C]
		mov	ecx, edx
		push	ebx
		and	ecx, 1
		push	esi
		mov	[esp+2Ch+var_4], ecx
		jz	short loc_10002492
		lea	esi, [eax+10h]
		lea	ebx, [edi+0D11h]
		mov	[esp+2Ch+var_20], esi
		jmp	short loc_100024AA
; ---------------------------------------------------------------------------

loc_10002492:				; CODE XREF: sub_10002440+41j
		test	dl, 2
		jz	loc_10002703
		add	eax, 0Ch
		lea	ebx, [edi+910h]
		mov	[esp+2Ch+var_20], eax
		mov	esi, eax

loc_100024AA:				; CODE XREF: sub_10002440+50j
		mov	eax, [edi]
		cmp	eax, 1
		jnz	short loc_100024B7
		mov	[esp+2Ch+var_14], edi
		jmp	short loc_100024C4
; ---------------------------------------------------------------------------

loc_100024B7:				; CODE XREF: sub_10002440+6Fj
		cmp	eax, 2
		jnz	loc_100026F9
		mov	[esp+2Ch+var_10], edi

loc_100024C4:				; CODE XREF: sub_10002440+75j
		push	ebp
		mov	ebp, [esp+30h+arg_8]
		test	ebp, ebp
		jnz	short loc_100024DF
		mov	eax, [esp+30h+arg_4]
		lea	edx, [eax+1]

loc_100024D4:				; CODE XREF: sub_10002440+99j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100024D4
		sub	eax, edx
		mov	ebp, eax

loc_100024DF:				; CODE XREF: sub_10002440+8Bj
		lea	eax, [esp+30h+var_1C]
		push	eax
		lea	ecx, [esp+34h+var_C]
		push	ecx
		push	8007h
		push	edi
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10002542
		mov	ecx, [esp+30h+var_C]
		test	ecx, ecx
		jz	short loc_10002542
		cmp	dword ptr [edi], 1
		jnz	short loc_10002514
		mov	edx, [esp+30h+var_14]
		mov	eax, [edx+1124h]
		jmp	short loc_10002516
; ---------------------------------------------------------------------------

loc_10002514:				; CODE XREF: sub_10002440+C6j
		xor	eax, eax

loc_10002516:				; CODE XREF: sub_10002440+D2j
		mov	edx, [esp+30h+arg_4]
		push	esi
		push	400h
		push	ebx
		push	eax
		mov	eax, [esp+40h+arg_C]
		push	eax
		mov	eax, [esp+44h+var_1C]
		push	ebp
		push	edx
		push	eax
		push	edi
		call	ecx
		add	esp, 24h
		test	eax, eax
		jnz	loc_10002629
		mov	ebp, [esi]
		mov	[esp+30h+arg_4], ebx

loc_10002542:				; CODE XREF: sub_10002440+B9j
					; sub_10002440+C1j
		lea	ecx, [esp+30h+var_1C]
		push	ecx
		lea	edx, [esp+34h+var_8]
		push	edx
		push	1
		push	edi
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000257B
		mov	eax, [esp+30h+var_8]
		test	eax, eax
		jz	short loc_1000257B
		mov	edx, [esp+30h+var_1C]
		push	0
		lea	ecx, [esp+34h+var_18]
		push	ecx
		push	offset aCanon_user_plu ; "canon_user_plugin"
		push	0
		push	edx
		call	eax
		add	esp, 14h

loc_1000257B:				; CODE XREF: sub_10002440+119j
					; sub_10002440+121j
		mov	edi, [esp+30h+var_18]
		test	edi, edi
		jnz	short loc_1000258C
		mov	edi, offset aInternal ;	"INTERNAL"
		mov	[esp+30h+var_18], edi

loc_1000258C:				; CODE XREF: sub_10002440+141j
		mov	eax, dword_1002E404
		mov	esi, eax
		test	eax, eax
		jz	short loc_1000260F
		jmp	short loc_100025A0
; ---------------------------------------------------------------------------
		align 10h

loc_100025A0:				; CODE XREF: sub_10002440+157j
					; sub_10002440+1CDj
		mov	eax, [esi+108h]
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jz	short loc_100025D9
		mov	eax, edi
		nop

loc_100025B0:				; CODE XREF: sub_10002440+18Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_100025D0
		test	dl, dl
		jz	short loc_100025CC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_100025D0
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_100025B0

loc_100025CC:				; CODE XREF: sub_10002440+178j
		xor	eax, eax
		jmp	short loc_100025D5
; ---------------------------------------------------------------------------

loc_100025D0:				; CODE XREF: sub_10002440+174j
					; sub_10002440+180j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_100025D5:				; CODE XREF: sub_10002440+18Ej
		test	eax, eax
		jz	short loc_10002631

loc_100025D9:				; CODE XREF: sub_10002440+16Bj
		lea	ecx, [esi+4]
		mov	eax, edi
		mov	edi, edi

loc_100025E0:				; CODE XREF: sub_10002440+1BAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10002600
		test	dl, dl
		jz	short loc_100025FC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10002600
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_100025E0

loc_100025FC:				; CODE XREF: sub_10002440+1A8j
		xor	eax, eax
		jmp	short loc_10002605
; ---------------------------------------------------------------------------

loc_10002600:				; CODE XREF: sub_10002440+1A4j
					; sub_10002440+1B0j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10002605:				; CODE XREF: sub_10002440+1BEj
		test	eax, eax
		jz	short loc_10002631
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_100025A0

loc_1000260F:				; CODE XREF: sub_10002440+155j
		mov	ecx, [esp+30h+arg_0]
		push	edi
		push	offset aDesiredCanon_u ; "desired canon_user plugin %s not found"
		push	0
		push	ecx
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFFCh

loc_10002629:				; CODE XREF: sub_10002440+F6j
					; sub_10002440+25Aj
		pop	ebp
		pop	esi
		pop	ebx
		pop	edi
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10002631:				; CODE XREF: sub_10002440+197j
					; sub_10002440+1C7j
		mov	ecx, [esp+30h+var_14]
		mov	eax, [esi+108h]
		test	ecx, ecx
		jz	short loc_10002667
		mov	edx, [esp+30h+var_20]
		mov	ecx, [ecx+1134h]
		push	edx
		mov	edx, [esp+34h+arg_4]
		push	400h
		push	ebx
		mov	ebx, [esp+3Ch+arg_C]
		push	ebx
		push	ebp
		push	edx
		mov	edx, [eax+8]
		mov	eax, [eax+14h]
		push	ecx
		push	edx
		call	eax
		jmp	short loc_10002695
; ---------------------------------------------------------------------------

loc_10002667:				; CODE XREF: sub_10002440+1FDj
		mov	ecx, [esp+30h+var_20]
		mov	edx, [esp+30h+arg_C]
		push	ecx
		mov	ecx, [esp+34h+arg_4]
		push	400h
		push	ebx
		push	edx
		mov	edx, [esp+40h+var_10]
		push	ebp
		push	ecx
		mov	ecx, [edx+1124h]
		mov	edx, [eax+8]
		mov	eax, [eax+18h]
		push	ecx
		push	edx
		call	eax
		mov	ebx, [esp+50h+arg_C]

loc_10002695:				; CODE XREF: sub_10002440+225j
		add	esp, 20h
		test	eax, eax
		jnz	short loc_10002629
		mov	ebp, [esp+30h+var_4]
		test	ebp, ebp
		jz	short loc_100026CC
		test	bl, 2
		jz	short loc_100026CC
		mov	edx, [esp+30h+arg_0]
		mov	eax, [esp+30h+arg_10]
		lea	esi, [edx+0D11h]
		lea	edi, [edx+910h]
		mov	ecx, 100h
		rep movsd
		mov	ecx, [eax+10h]
		mov	[eax+0Ch], ecx
		jmp	short loc_100026D4
; ---------------------------------------------------------------------------

loc_100026CC:				; CODE XREF: sub_10002440+262j
					; sub_10002440+267j
		mov	edx, [esp+30h+arg_0]
		mov	eax, [esp+30h+arg_10]

loc_100026D4:				; CODE XREF: sub_10002440+28Aj
		test	ebp, ebp
		jz	short loc_100026E1
		lea	ecx, [edx+0D11h]
		mov	[eax+8], ecx

loc_100026E1:				; CODE XREF: sub_10002440+296j
		test	bl, 2
		jz	short loc_100026EF
		add	edx, 910h
		mov	[eax+4], edx

loc_100026EF:				; CODE XREF: sub_10002440+2A4j
		pop	ebp
		pop	esi
		pop	ebx
		xor	eax, eax
		pop	edi
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100026F9:				; CODE XREF: sub_10002440+7Aj
		pop	esi
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	edi
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_10002703:				; CODE XREF: sub_10002440+55j
		pop	esi
		pop	ebx
		mov	eax, 0FFFFFFF9h
		pop	edi
		add	esp, 20h
		retn
sub_10002440	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002710	proc near		; CODE XREF: sub_100027C0+2Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+arg_4]
		push	edi
		xor	edi, edi
		test	ebx, ebx
		jnz	short loc_10002724

loc_1000271C:				; CODE XREF: sub_10002710+16j
		pop	edi
		mov	eax, 0FFFFFFF9h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10002724:				; CODE XREF: sub_10002710+Aj
		test	ebp, ebp
		jz	short loc_1000271C
		cmp	dword ptr [ebx], 1
		jnz	loc_100027BB
		mov	eax, [esp+8+arg_0]
		push	esi
		mov	esi, eax
		and	esi, 0FFF0h
		test	al, 8
		jz	short loc_10002745
		or	esi, 1

loc_10002745:				; CODE XREF: sub_10002710+30j
		test	al, 1
		jz	short loc_10002765
		mov	eax, [ebp+10h]
		mov	ecx, [ebp+8]
		mov	edx, [ebx+1134h]
		push	eax
		push	ecx
		push	esi
		push	edx
		call	sub_100019F0
		add	esp, 10h
		mov	edi, eax
		jmp	short loc_1000276A
; ---------------------------------------------------------------------------

loc_10002765:				; CODE XREF: sub_10002710+37j
		mov	edi, 1

loc_1000276A:				; CODE XREF: sub_10002710+53j
		test	byte ptr [esp+0Ch+arg_0], 2
		jz	short loc_1000279C
		mov	eax, [ebp+0Ch]
		mov	ecx, [ebp+4]
		mov	edx, [ebx+1134h]
		push	eax
		push	ecx
		or	esi, 2
		push	esi
		push	edx
		call	sub_100019F0
		add	esp, 10h
		cmp	edi, 1
		jz	short loc_1000279A
		test	edi, edi
		jnz	short loc_1000279C
		cmp	eax, 0FFFFFFECh
		jz	short loc_100027BA

loc_1000279A:				; CODE XREF: sub_10002710+7Fj
		mov	edi, eax

loc_1000279C:				; CODE XREF: sub_10002710+5Fj
					; sub_10002710+83j
		cmp	edi, 0FFFFFFECh
		jnz	short loc_100027B0
		test	byte ptr [esp+0Ch+arg_0], 4
		jz	short loc_100027B4
		xor	edi, edi
		pop	esi
		mov	eax, edi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100027B0:				; CODE XREF: sub_10002710+8Fj
		test	edi, edi
		jns	short loc_100027BA

loc_100027B4:				; CODE XREF: sub_10002710+96j
		mov	[ebx+8F0h], edi

loc_100027BA:				; CODE XREF: sub_10002710+88j
					; sub_10002710+A2j
		pop	esi

loc_100027BB:				; CODE XREF: sub_10002710+1Bj
		mov	eax, edi
		pop	edi
		pop	ebp
		retn
sub_10002710	endp


; =============== S U B	R O U T	I N E =======================================


sub_100027C0	proc near		; CODE XREF: sub_10002C80+85p
					; sub_10002F00+8Ep
					; DATA XREF: ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	esi, [esp+8+arg_10]
		push	edi
		mov	edi, [esp+0Ch+arg_C]
		push	esi
		push	edi
		push	eax
		push	ecx
		push	ebx
		call	sub_10002440
		add	esp, 14h
		test	eax, eax
		jnz	short loc_100027F2
		push	esi
		push	edi
		call	sub_10002710
		add	esp, 8

loc_100027F2:				; CODE XREF: sub_100027C0+26j
		test	ebx, ebx
		jz	short loc_10002800
		test	eax, eax
		jns	short loc_10002800
		mov	[ebx+8F0h], eax

loc_10002800:				; CODE XREF: sub_100027C0+34j
					; sub_100027C0+38j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_100027C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002810	proc near		; CODE XREF: sub_10006260+36p
		push	esi
		mov	esi, dword_1002E404
		test	esi, esi
		jz	short loc_10002852
		push	edi
		lea	esp, [esp+0]

loc_10002820:				; CODE XREF: sub_10002810+3Fj
		mov	eax, [esi+108h]
		cmp	dword ptr [eax+10h], 0
		mov	edi, [esi]
		jz	short loc_10002841
		mov	ecx, sasl_global_utils
		mov	edx, [eax+8]
		mov	eax, [eax+10h]
		push	ecx
		push	edx
		call	eax
		add	esp, 8

loc_10002841:				; CODE XREF: sub_10002810+1Cj
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	esi, edi
		test	edi, edi
		jnz	short loc_10002820
		pop	edi

loc_10002852:				; CODE XREF: sub_10002810+9j
		mov	dword_1002E404,	0
		pop	esi
		retn
sub_10002810	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  23. sasl_canonuser_add_plugin

; =============== S U B	R O U T	I N E =======================================


		public sasl_canonuser_add_plugin
sasl_canonuser_add_plugin proc near	; CODE XREF: sub_10007860+4Cp
					; DATA XREF: sasl_client_init+3Ao ...

var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jz	loc_10002936
		mov	eax, edi
		lea	edx, [eax+1]

loc_10002873:				; CODE XREF: sasl_canonuser_add_plugin+18j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10002873
		sub	eax, edx
		cmp	eax, 103h
		ja	loc_10002936
		mov	edx, sasl_global_utils
		push	esi
		push	edi
		lea	eax, [esp+10h+arg_0]
		push	eax
		lea	ecx, [esp+14h+var_4]
		push	ecx
		push	5
		push	edx
		call	[esp+20h+arg_4]
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	short loc_100028C1
		push	esi
		push	offset aCanonuserfuncE ; "canonuserfunc	error %i\n"
		push	1
		push	0
		call	sub_10006F30
		add	esp, 10h
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100028C1:				; CODE XREF: sasl_canonuser_add_plugin+47j
		mov	eax, [esp+0Ch+arg_0]
		cmp	dword ptr [eax+14h], 0
		jnz	short loc_100028EB
		cmp	dword ptr [eax+18h], 0
		jnz	short loc_100028EB
		push	offset aCanonuserPlugi ; "canonuser plugin without either client "...
		push	1
		push	0
		call	sub_10006F30
		add	esp, 0Ch
		pop	esi
		mov	eax, 0FFFFFFFBh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100028EB:				; CODE XREF: sasl_canonuser_add_plugin+69j
					; sasl_canonuser_add_plugin+6Fj
		push	10Ch
		call	off_1002D044
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10002906
		lea	eax, [esi-2]
		pop	esi
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10002906:				; CODE XREF: sasl_canonuser_add_plugin+9Dj
		push	104h
		lea	eax, [esi+4]
		push	edi
		push	eax
		call	sub_1000EFE0
		mov	ecx, [esp+18h+arg_0]
		mov	edx, dword_1002E404
		add	esp, 0Ch
		mov	[esi+108h], ecx
		mov	[esi], edx
		mov	dword_1002E404,	esi
		pop	esi
		xor	eax, eax
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10002936:				; CODE XREF: sasl_canonuser_add_plugin+8j
					; sasl_canonuser_add_plugin+21j
		push	offset aBadPlugnamePas ; "bad plugname passed to sasl_canonuser_a"...
		push	0
		push	0
		call	sasl_seterror
		add	esp, 0Ch
		mov	eax, 0FFFFFFF9h
		pop	edi
		pop	ecx
		retn
sasl_canonuser_add_plugin endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002950	proc near		; CODE XREF: sub_10002B20+1Fp
					; sub_10002B50+1Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpMem		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	ebx
		push	esi
		mov	esi, eax
		xor	eax, eax
		mov	ebx, ecx
		push	edi
		mov	[esp+18h+var_C], eax
		mov	[esp+18h+var_8], eax
		cmp	ebx, eax
		jz	loc_10002B0E
		mov	edi, [esp+18h+arg_0]
		cmp	edi, eax
		jz	loc_10002B0E
		lea	eax, [esi+2]
		push	ebp
		push	eax
		call	off_1002D044
		mov	ebp, eax
		add	esp, 4
		mov	[esp+1Ch+lpMem], ebp
		test	ebp, ebp
		jnz	short loc_1000299B
		lea	eax, [ebp-2]
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000299B:				; CODE XREF: sub_10002950+3Ej
		push	esi
		push	edi
		push	ebp
		call	sub_1000E2B0
		mov	byte ptr [esi+ebp], 0
		movsx	ecx, byte ptr [ebp+0]
		push	ecx
		xor	edi, edi
		call	sub_1000E9CE
		add	esp, 10h
		test	eax, eax
		jz	short loc_100029D7
		lea	ebx, [ebx+0]

loc_100029C0:				; CODE XREF: sub_10002950+85j
		cmp	edi, esi
		jnb	short loc_100029D7
		movsx	edx, byte ptr [edi+ebp+1]
		inc	edi
		push	edx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jnz	short loc_100029C0

loc_100029D7:				; CODE XREF: sub_10002950+68j
					; sub_10002950+72j
		add	ebp, edi
		test	edi, edi
		jz	short loc_100029DF
		sub	esi, edi

loc_100029DF:				; CODE XREF: sub_10002950+8Bj
		test	esi, esi
		jz	short loc_100029F8

loc_100029E3:				; CODE XREF: sub_10002950+A6j
		movsx	eax, byte ptr [esi+ebp-1]
		push	eax
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jz	short loc_100029F8
		dec	esi
		jnz	short loc_100029E3

loc_100029F8:				; CODE XREF: sub_10002950+91j
					; sub_10002950+A3j
		mov	eax, [esp+1Ch+lpMem]
		lea	ecx, [eax+esi]
		cmp	ebp, ecx
		jnz	short loc_10002A2B
		push	eax		; lpMem
		call	off_1002D050
		mov	edx, [ebx+4]
		mov	eax, [ebx+84h]
		push	offset aAllWhitespaceU ; "All-whitespace username."
		push	0
		push	edx
		call	eax
		add	esp, 10h
		pop	ebp
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002A2B:				; CODE XREF: sub_10002950+B1j
		mov	eax, [ebx+4]
		test	eax, eax
		jz	short loc_10002A70
		cmp	dword ptr [eax], 1
		jnz	short loc_10002A70
		mov	edi, eax
		cmp	dword ptr [edi+1124h], 0
		mov	[esp+1Ch+var_8], edi
		jz	short loc_10002A70
		mov	ecx, [esp+1Ch+arg_0]
		push	40h
		push	ecx
		call	sub_1000EF20
		add	esp, 8
		test	eax, eax
		jnz	short loc_10002A70
		mov	eax, [edi+1124h]
		lea	edx, [eax+1]

loc_10002A62:				; CODE XREF: sub_10002950+117j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10002A62
		sub	eax, edx
		lea	edi, [eax+1]
		jmp	short loc_10002A74
; ---------------------------------------------------------------------------

loc_10002A70:				; CODE XREF: sub_10002950+E0j
					; sub_10002950+E5j ...
		mov	edi, [esp+1Ch+var_C]

loc_10002A74:				; CODE XREF: sub_10002950+11Ej
		mov	ebx, [esp+1Ch+arg_8]
		mov	eax, esi
		cmp	esi, ebx
		jb	short loc_10002A80
		mov	eax, ebx

loc_10002A80:				; CODE XREF: sub_10002950+12Cj
		push	eax
		push	ebp
		mov	ebp, [esp+24h+arg_4]
		push	ebp
		call	sub_1000E2B0
		mov	edx, [esp+28h+var_8]
		add	esp, 0Ch
		test	edx, edx
		jz	short loc_10002AC6
		test	edi, edi
		jz	short loc_10002AC6
		cmp	esi, ebx
		jnb	short loc_10002AD9
		mov	eax, ebx
		sub	eax, esi
		dec	eax
		lea	ecx, [edi-1]
		mov	byte ptr [esi+ebp], 40h
		cmp	ecx, eax
		jnb	short loc_10002AB1
		mov	eax, ecx

loc_10002AB1:				; CODE XREF: sub_10002950+15Dj
		mov	ecx, [edx+1124h]
		push	eax
		push	ecx
		lea	edx, [esi+ebp+1]
		push	edx
		call	sub_1000E2B0
		add	esp, 0Ch

loc_10002AC6:				; CODE XREF: sub_10002950+145j
					; sub_10002950+149j
		lea	eax, [edi+esi]
		mov	ecx, eax
		cmp	eax, ebx
		jb	short loc_10002AD1
		mov	ecx, ebx

loc_10002AD1:				; CODE XREF: sub_10002950+17Dj
		mov	byte ptr [ecx+ebp], 0
		cmp	eax, ebx
		jbe	short loc_10002AE6

loc_10002AD9:				; CODE XREF: sub_10002950+14Dj
		pop	ebp
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFDh
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002AE6:				; CODE XREF: sub_10002950+187j
		mov	ecx, [esp+1Ch+arg_C]
		test	ecx, ecx
		jz	short loc_10002AF6
		cmp	eax, ebx
		jb	short loc_10002AF4
		mov	eax, ebx

loc_10002AF4:				; CODE XREF: sub_10002950+1A0j
		mov	[ecx], eax

loc_10002AF6:				; CODE XREF: sub_10002950+19Cj
		mov	eax, [esp+1Ch+lpMem]
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4
		pop	ebp
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002B0E:				; CODE XREF: sub_10002950+16j
					; sub_10002950+22j
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		add	esp, 0Ch
		retn
sub_10002950	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002B20	proc near		; DATA XREF: .data:1002D014o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, [esp+arg_1C]
		mov	ecx, [esp+arg_18]
		mov	edx, [esp+arg_14]
		push	eax
		mov	eax, [esp+4+arg_8]
		push	ecx
		mov	ecx, [esp+8+arg_4]
		mov	ecx, [ecx+34h]
		push	edx
		push	eax
		mov	eax, [esp+10h+arg_C]
		call	sub_10002950
		add	esp, 10h
		retn
sub_10002B20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002B50	proc near		; DATA XREF: .data:1002D018o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, [esp+arg_1C]
		mov	ecx, [esp+arg_18]
		mov	edx, [esp+arg_14]
		push	eax
		mov	eax, [esp+4+arg_8]
		push	ecx
		mov	ecx, [esp+8+arg_4]
		mov	ecx, [ecx+0Ch]
		push	edx
		push	eax
		mov	eax, [esp+10h+arg_C]
		call	sub_10002950
		add	esp, 10h
		retn
sub_10002B50	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10002B80:				; DATA XREF: sub_10007860:loc_100078A2o
		mov	ecx, [esp+0Ch]
		test	ecx, ecx
		jz	short loc_10002BAC
		mov	eax, [esp+10h]
		test	eax, eax
		jz	short loc_10002BAC
		cmp	dword ptr [esp+8], 5
		jge	short loc_10002B9D
		mov	eax, 0FFFFFFE9h
		retn
; ---------------------------------------------------------------------------

loc_10002B9D:				; CODE XREF: .text:10002B95j
		mov	dword ptr [ecx], 5
		mov	dword ptr [eax], offset	dword_1002D000
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10002BAC:				; CODE XREF: .text:10002B86j
					; .text:10002B8Ej
		mov	eax, 0FFFFFFF9h
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002BC0	proc near		; CODE XREF: sub_10002C80+18Ep

var_5C		= byte ptr -5Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 5Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+5Ch+var_4], eax
		push	29h
		call	off_1002D044
		add	esp, 4
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_10002BF3
		mov	eax, 0FFFFFFFEh
		mov	ecx, [esp+5Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_10002BF3:				; CODE XREF: sub_10002BC0+1Dj
		lea	eax, [esp+5Ch+var_5C]
		push	eax
		call	sub_100080C0
		push	10h
		lea	ecx, [esp+64h+var_5C]
		push	edi
		push	ecx
		call	sub_10008900
		push	6
		lea	edx, [esp+70h+var_5C]
		push	offset aSasldb	; "sasldb"
		push	edx
		call	sub_10008900
		mov	eax, [esp+78h+arg_0]
		push	eax
		lea	ecx, [esp+7Ch+var_5C]
		push	ebx
		push	ecx
		call	sub_10008900
		mov	eax, [esi]
		mov	edx, [edi]
		mov	[eax+4], edx
		mov	ecx, [edi+4]
		mov	[eax+8], ecx
		mov	edx, [edi+8]
		mov	[eax+0Ch], edx
		mov	ecx, [edi+0Ch]
		mov	[eax+10h], ecx
		mov	edx, [esi]
		mov	byte ptr [edx+14h], 0
		mov	ecx, [esi]
		lea	eax, [esp+84h+var_5C]
		push	eax
		add	ecx, 15h
		push	ecx
		call	sub_100089C0
		mov	ecx, [esp+8Ch+var_4]
		mov	edx, [esi]
		add	esp, 30h
		xor	ecx, esp
		mov	dword ptr [edx], 21h
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
sub_10002BC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002C80	proc near		; DATA XREF: .data:1002D02Co

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
lpMem		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		push	ebx
		mov	ebx, [esp+4Ch+arg_8]
		push	esi
		mov	esi, [esp+50h+arg_4]
		push	edi
		mov	edi, [esp+54h+arg_0]
		mov	[esp+54h+var_48], edi
		mov	[esp+54h+var_44], offset aUserpassword_0 ; "*userPassword"
		mov	[esp+54h+var_40], offset aCmusaslsecretp ; "*cmusaslsecretPLAIN"
		mov	[esp+54h+var_3C], 0
		test	edi, edi
		jz	loc_10002EDF
		test	esi, esi
		jz	loc_10002EDF
		mov	eax, [edi+1134h]
		mov	ecx, [eax+60h]
		push	0
		push	ecx
		call	prop_clear
		mov	eax, [edi+1134h]
		mov	ecx, [eax+60h]
		lea	edx, [esp+5Ch+var_44]
		push	edx
		push	ecx
		call	prop_request
		add	esp, 10h
		test	eax, eax
		jnz	loc_10002DCA
		lea	edx, [edi+860h]
		push	edx
		push	3
		push	eax
		push	esi
		push	edi
		call	sub_100027C0
		add	esp, 14h
		test	eax, eax
		jnz	loc_10002DCA
		mov	edx, [edi+1134h]
		lea	eax, [esp+54h+var_34]
		push	eax
		mov	eax, [edx+60h]
		lea	ecx, [esp+58h+var_44]
		push	ecx
		push	eax
		call	prop_getnames
		add	esp, 0Ch
		test	eax, eax
		js	loc_10002DCA
		mov	ecx, [esp+54h+var_34]
		push	ebp
		mov	ebp, [esp+58h+var_24]
		test	ecx, ecx
		jnz	short loc_10002D4E
		test	ebp, ebp
		jz	loc_10002EC7

loc_10002D4E:				; CODE XREF: sub_10002C80+C4j
		test	ebx, ebx
		jnz	short loc_10002D6C
		pop	ebp
		mov	esi, 0FFFFFFF9h
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_10002D6C:				; CODE XREF: sub_10002C80+D0j
		mov	eax, [esp+58h+var_30]
		mov	esi, [esp+58h+var_20]
		test	eax, eax
		jz	short loc_10002D7D
		cmp	dword ptr [eax], 0
		jnz	short loc_10002D8E

loc_10002D7D:				; CODE XREF: sub_10002C80+F6j
		test	esi, esi
		jz	loc_10002EC7
		cmp	dword ptr [esi], 0
		jz	loc_10002EC7

loc_10002D8E:				; CODE XREF: sub_10002C80+FBj
		test	ecx, ecx
		jz	short loc_10002DDC
		test	eax, eax
		jz	short loc_10002DDC
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_10002DDC
		mov	ecx, ebx
		mov	edi, edi

loc_10002DA0:				; CODE XREF: sub_10002C80+13Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10002DC0
		test	dl, dl
		jz	short loc_10002DBC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10002DC0
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10002DA0

loc_10002DBC:				; CODE XREF: sub_10002C80+128j
		xor	eax, eax
		jmp	short loc_10002DC5
; ---------------------------------------------------------------------------

loc_10002DC0:				; CODE XREF: sub_10002C80+124j
					; sub_10002C80+130j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10002DC5:				; CODE XREF: sub_10002C80+13Ej
		test	eax, eax
		jnz	short loc_10002DDC
		pop	ebp

loc_10002DCA:				; CODE XREF: sub_10002C80+73j
					; sub_10002C80+8Fj ...
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_10002DDC:				; CODE XREF: sub_10002C80+110j
					; sub_10002C80+114j ...
		test	ebp, ebp
		jz	loc_10002E90
		test	esi, esi
		jz	loc_10002E90
		cmp	dword ptr [esi], 0
		jz	loc_10002E90
		mov	edi, [esi]
		mov	eax, ebx
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_10002E00:				; CODE XREF: sub_10002C80+185j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10002E00
		sub	eax, edx
		push	eax
		lea	esi, [esp+5Ch+lpMem]
		call	sub_10002BC0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	loc_10002EB2
		mov	ebp, [esp+58h+lpMem]
		mov	eax, [ebp+0]
		lea	ecx, [ebp+4]
		mov	esi, edi
		cmp	eax, 4
		jb	short loc_10002E45

loc_10002E31:				; CODE XREF: sub_10002C80+1C3j
		mov	edx, [esi]
		cmp	edx, [ecx]
		jnz	short loc_10002E69
		sub	eax, 4
		add	ecx, 4
		add	esi, 4
		cmp	eax, 4
		jnb	short loc_10002E31

loc_10002E45:				; CODE XREF: sub_10002C80+1AFj
		test	eax, eax
		jz	short loc_10002E7E
		mov	dl, [ecx]
		cmp	dl, [esi]
		jnz	short loc_10002E69
		cmp	eax, 1
		jbe	short loc_10002E7E
		mov	dl, [ecx+1]
		cmp	dl, [esi+1]
		jnz	short loc_10002E69
		cmp	eax, 2
		jbe	short loc_10002E7E
		mov	al, [ecx+2]
		cmp	al, [esi+2]
		jz	short loc_10002E7E

loc_10002E69:				; CODE XREF: sub_10002C80+1B5j
					; sub_10002C80+1CDj ...
		push	ebp		; lpMem
		mov	esi, 0FFFFFFF3h
		call	off_1002D050
		mov	edi, [esp+5Ch+var_48]
		add	esp, 4
		jmp	short loc_10002E95
; ---------------------------------------------------------------------------

loc_10002E7E:				; CODE XREF: sub_10002C80+1C7j
					; sub_10002C80+1D2j ...
		push	ebp		; lpMem
		xor	esi, esi
		call	off_1002D050
		mov	edi, [esp+5Ch+var_48]
		add	esp, 4
		jmp	short loc_10002E95
; ---------------------------------------------------------------------------

loc_10002E90:				; CODE XREF: sub_10002C80+15Ej
					; sub_10002C80+166j ...
		mov	esi, 0FFFFFFF3h

loc_10002E95:				; CODE XREF: sub_10002C80+1FCj
					; sub_10002C80+20Ej
		mov	eax, [edi+1134h]
		mov	ecx, [eax+34h]
		mov	edx, [esp+58h+var_44]
		mov	eax, [eax+60h]
		mov	ecx, [ecx+0B4h]
		push	edx
		push	eax
		call	ecx
		add	esp, 8

loc_10002EB2:				; CODE XREF: sub_10002C80+19Aj
		pop	ebp
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_10002EC7:				; CODE XREF: sub_10002C80+C8j
					; sub_10002C80+FFj ...
		pop	ebp
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFECh
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_10002EDF:				; CODE XREF: sub_10002C80+3Bj
					; sub_10002C80+43j
		mov	ecx, [esp+54h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		mov	eax, 0FFFFFFF9h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
sub_10002C80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002F00	proc near		; DATA XREF: .data:1002D034o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 28h
		push	ebp
		push	esi
		mov	esi, [esp+30h+arg_0]
		push	edi
		xor	edi, edi
		mov	[esp+34h+var_28], offset aUserpassword_0 ; "*userPassword"
		mov	[esp+34h+var_24], edi
		cmp	esi, edi
		jz	loc_1000303B
		mov	ebp, [esp+34h+arg_4]
		cmp	ebp, edi
		jz	loc_1000303B
		mov	eax, [esi+1134h]
		mov	ecx, [eax+60h]
		push	edi
		push	ecx
		call	prop_clear
		mov	eax, [esi+1134h]
		mov	ecx, [eax+60h]
		lea	edx, [esp+3Ch+var_28]
		push	edx
		push	ecx
		call	prop_request
		add	esp, 10h
		cmp	eax, edi
		jnz	short loc_10002FD0
		push	ebx
		mov	ebx, [esp+38h+arg_8]
		test	ebx, ebx
		jz	short loc_10002F7F
		mov	edx, [esi+1134h]
		mov	eax, [edx+60h]
		push	0FFFFFFFFh
		push	ebx
		push	offset aUserpassword_0 ; "*userPassword"
		push	eax
		call	prop_set
		add	esp, 10h
		mov	edi, 10h

loc_10002F7F:				; CODE XREF: sub_10002F00+5Ej
		lea	ecx, [esi+860h]
		push	ecx
		or	edi, 3
		push	edi
		push	0
		push	ebp
		push	esi
		call	sub_100027C0
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10002FCF
		mov	ecx, [esi+1134h]
		lea	edx, [esp+38h+var_20]
		push	edx
		mov	edx, [ecx+60h]
		lea	eax, [esp+3Ch+var_28]
		push	eax
		push	edx
		call	prop_getnames
		add	esp, 0Ch
		test	eax, eax
		js	short loc_10002FCF
		mov	ecx, [esp+38h+var_20]
		test	ecx, ecx
		jnz	short loc_10002FC8
		cmp	[esp+38h+var_10], ecx
		jz	short loc_1000302E

loc_10002FC8:				; CODE XREF: sub_10002F00+C0j
		test	ebx, ebx
		jnz	short loc_10002FD7
		lea	eax, [ebx-7]

loc_10002FCF:				; CODE XREF: sub_10002F00+98j
					; sub_10002F00+B8j
		pop	ebx

loc_10002FD0:				; CODE XREF: sub_10002F00+55j
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10002FD7:				; CODE XREF: sub_10002F00+CAj
		mov	eax, [esp+38h+var_1C]
		test	eax, eax
		jz	short loc_1000302E
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_1000302E
		test	ecx, ecx
		jz	short loc_10003021
		mov	ecx, ebx
		jmp	short loc_10002FF0
; ---------------------------------------------------------------------------
		align 10h

loc_10002FF0:				; CODE XREF: sub_10002F00+EBj
					; sub_10002F00+10Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10003010
		test	dl, dl
		jz	short loc_1000300C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10003010
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10002FF0

loc_1000300C:				; CODE XREF: sub_10002F00+F8j
		xor	eax, eax
		jmp	short loc_10003015
; ---------------------------------------------------------------------------

loc_10003010:				; CODE XREF: sub_10002F00+F4j
					; sub_10002F00+100j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10003015:				; CODE XREF: sub_10002F00+10Ej
		test	eax, eax
		jnz	short loc_10003021
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10003021:				; CODE XREF: sub_10002F00+E7j
					; sub_10002F00+117j
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF3h
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1000302E:				; CODE XREF: sub_10002F00+C6j
					; sub_10002F00+DDj ...
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFECh
		pop	ebp
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1000303B:				; CODE XREF: sub_10002F00+1Aj
					; sub_10002F00+26j
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebp
		add	esp, 28h
		retn
sub_10002F00	endp

; ---------------------------------------------------------------------------
		align 10h
		push	offset dword_1002F070
		push	0
		call	sub_10007350
		mov	ecx, dword_1002E408
		add	esp, 8
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_10003071
		mov	eax, 0FFFFFFFEh
		retn
; ---------------------------------------------------------------------------

loc_10003071:				; CODE XREF: .text:10003069j
		mov	dword ptr [ecx+8], 0
		mov	dword ptr [ecx+0Ch], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  28. sasl_client_done

; =============== S U B	R O U T	I N E =======================================


		public sasl_client_done
sasl_client_done proc near		; DATA XREF: .rdata:off_1002C568o
		cmp	dword_1002E4A0,	0
		mov	ecx, dword_1002E49C
		mov	eax, 1
		jnz	short loc_100030AC
		test	ecx, ecx
		jnz	short loc_100030B0
		lea	eax, [ecx-0Ch]
		retn
; ---------------------------------------------------------------------------

loc_100030AC:				; CODE XREF: sasl_client_done+12j
		test	ecx, ecx
		jz	short loc_100030C3

loc_100030B0:				; CODE XREF: sasl_client_done+16j
		call	ecx ; dword_1002E49C
		test	eax, eax
		jnz	short locret_100030D7
		xor	ecx, ecx
		mov	dword_1002E4A4,	eax
		mov	dword_1002E49C,	ecx

loc_100030C3:				; CODE XREF: sasl_client_done+1Ej
		cmp	dword_1002E4A0,	0
		jnz	short locret_100030D7
		test	ecx, ecx
		jnz	short locret_100030D7
		call	sub_10006260
		xor	eax, eax

locret_100030D7:			; CODE XREF: sasl_client_done+24j
					; sasl_client_done+3Aj	...
		retn
sasl_client_done endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100030E0	proc near		; CODE XREF: sasl_client_init:loc_1000352Cp
					; sasl_client_init:loc_10003548p
					; DATA XREF: ...
		cmp	dword_1002E40C,	0
		jnz	short loc_100030EF
		mov	eax, 0FFFFFFF4h
		retn
; ---------------------------------------------------------------------------

loc_100030EF:				; CODE XREF: sub_100030E0+7j
		mov	eax, 1
		sub	dword_1002E40C,	eax
		jnz	short locret_10003176
		mov	eax, dword_1002E408
		push	edi
		mov	edi, [eax+8]
		test	edi, edi
		jz	short loc_1000314E
		push	esi
		lea	ebx, [ebx+0]

loc_10003110:				; CODE XREF: sub_100030E0+6Bj
		mov	esi, edi
		mov	ecx, [esi+8]
		cmp	dword ptr [ecx+24h], 0
		mov	edi, [edi+0Ch]
		jz	short loc_10003135
		mov	edx, dword_1002E408
		mov	eax, ecx
		mov	ecx, [edx]
		mov	edx, [eax+14h]
		mov	eax, [eax+24h]
		push	ecx
		push	edx
		call	eax
		add	esp, 8

loc_10003135:				; CODE XREF: sub_100030E0+3Cj
		mov	ecx, [esi+4]
		push	ecx		; lpMem
		call	off_1002D050
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 8
		test	edi, edi
		jnz	short loc_10003110
		pop	esi

loc_1000314E:				; CODE XREF: sub_100030E0+27j
		mov	edx, dword_1002E408
		push	edx
		call	sub_100054F0
		mov	eax, dword_1002E408
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 8
		mov	dword_1002E408,	0
		xor	eax, eax
		pop	edi

locret_10003176:			; CODE XREF: sub_100030E0+1Aj
		retn
sub_100030E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003180	proc near		; CODE XREF: sasl_client_add_plugin+F5p
					; sasl_client_add_plugin+10Ap
		mov	edx, [edi+8]
		mov	ecx, [esi+8]
		mov	eax, edx
		xor	eax, ecx
		and	ecx, eax
		test	cl, 10h
		jz	short loc_10003197

loc_10003191:				; CODE XREF: sub_10003180+2Aj
					; sub_10003180+34j ...
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_10003197:				; CODE XREF: sub_10003180+Fj
		and	edx, eax
		test	dl, 10h
		jz	short loc_100031A2

loc_1000319E:				; CODE XREF: sub_10003180+2Fj
					; sub_10003180+39j ...
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100031A2:				; CODE XREF: sub_10003180+1Cj
		mov	ecx, [esi+8]
		and	ecx, eax
		test	cl, 1
		jnz	short loc_10003191
		test	dl, 1
		jnz	short loc_1000319E
		test	cl, 40h
		jnz	short loc_10003191
		test	dl, 40h
		jnz	short loc_1000319E
		test	cl, 2
		jnz	short loc_10003191
		test	dl, 2
		jnz	short loc_1000319E
		test	cl, 4
		jnz	short loc_10003191
		test	dl, 4
		jnz	short loc_1000319E
		test	cl, 8
		jnz	short loc_10003191
		test	dl, 8
		jnz	short loc_1000319E
		mov	edx, [edi+0Ch]
		mov	eax, [esi+0Ch]
		mov	ecx, edx
		xor	ecx, eax
		and	eax, ecx
		test	eax, 800h
		jnz	short loc_10003191
		and	edx, ecx
		test	edx, 800h
		jnz	short loc_1000319E
		mov	eax, [esi+4]
		mov	ecx, [edi+4]
		cmp	eax, ecx
		ja	short loc_10003191
		sbb	eax, eax
		retn
sub_10003180	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  27. sasl_client_add_plugin

; =============== S U B	R O U T	I N E =======================================


		public sasl_client_add_plugin
sasl_client_add_plugin proc near	; CODE XREF: sasl_client_init+C0p
					; DATA XREF: sasl_client_init+2Ao ...

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 14h
		push	edi
		mov	edi, [esp+18h+arg_0]
		test	edi, edi
		jz	loc_10003389
		mov	eax, [esp+18h+arg_4]
		test	eax, eax
		jz	loc_10003389
		push	esi
		lea	ecx, [esp+1Ch+var_8]
		push	ecx
		lea	edx, [esp+20h+var_14]
		push	edx
		mov	edx, dword_1002E408
		lea	ecx, [esp+24h+var_10]
		push	ecx
		mov	ecx, [edx]
		push	4
		push	ecx
		call	eax
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	short loc_1000326C
		push	edi
		push	offset aEntry_pointFai ; "entry_point failed in	sasl_client_add_p"...
		push	3
		push	0
		call	sub_10006F30
		add	esp, 10h
		mov	eax, esi
		pop	esi
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000326C:				; CODE XREF: sasl_client_add_plugin+40j
		cmp	[esp+1Ch+var_10], 4
		jz	short loc_10003290
		push	edi
		push	offset aVersionConflic ; "version conflict in sasl_client_add_plu"...
		push	3
		push	0
		call	sub_10006F30
		add	esp, 10h
		pop	esi
		mov	eax, 0FFFFFFE9h
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10003290:				; CODE XREF: sasl_client_add_plugin+61j
		cmp	[esp+1Ch+var_8], 0
		push	ebx
		push	ebp
		mov	[esp+24h+var_C], 0
		jg	short loc_100032B4
		pop	ebp
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------
		jmp	short loc_100032B0
; ---------------------------------------------------------------------------
		align 10h

loc_100032B0:				; CODE XREF: sasl_client_add_plugin+9Bj
					; sasl_client_add_plugin+152j
		mov	edi, [esp+24h+arg_0]

loc_100032B4:				; CODE XREF: sasl_client_add_plugin+8Fj
		push	10h
		call	off_1002D044
		mov	ebp, eax
		add	esp, 4
		mov	[esp+24h+var_4], ebp
		test	ebp, ebp
		jz	loc_1000337C
		mov	edx, [esp+24h+var_14]
		push	0
		lea	eax, [ebp+4]
		push	eax
		push	edi
		mov	[ebp+8], edx
		call	sub_10004910
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10003372
		mov	ecx, [esp+24h+var_10]
		mov	eax, dword_1002E408
		mov	[ebp+0], ecx
		mov	ebx, [eax+8]
		test	ebx, ebx
		jz	short loc_10003344
		mov	edi, [ebx+8]
		mov	esi, [esp+24h+var_14]
		call	sub_10003180
		test	eax, eax
		jns	short loc_1000333F
		cmp	dword ptr [ebx+0Ch], 0
		jz	short loc_1000332F

loc_10003314:				; CODE XREF: sasl_client_add_plugin+119j
		mov	ebp, [ebx+0Ch]
		mov	edi, [ebp+8]
		call	sub_10003180
		test	eax, eax
		jg	short loc_1000332B
		mov	ebx, ebp
		cmp	dword ptr [ebx+0Ch], 0
		jnz	short loc_10003314

loc_1000332B:				; CODE XREF: sasl_client_add_plugin+111j
		mov	ebp, [esp+24h+var_4]

loc_1000332F:				; CODE XREF: sasl_client_add_plugin+102j
		mov	edx, [ebx+0Ch]
		mov	eax, dword_1002E408
		mov	[ebp+0Ch], edx
		mov	[ebx+0Ch], ebp
		jmp	short loc_1000334D
; ---------------------------------------------------------------------------

loc_1000333F:				; CODE XREF: sasl_client_add_plugin+FCj
		mov	eax, dword_1002E408

loc_10003344:				; CODE XREF: sasl_client_add_plugin+ECj
		mov	ecx, [eax+8]
		mov	[ebp+0Ch], ecx
		mov	[eax+8], ebp

loc_1000334D:				; CODE XREF: sasl_client_add_plugin+12Dj
		inc	dword ptr [eax+0Ch]
		mov	eax, [esp+24h+var_C]
		add	[esp+24h+var_14], 34h
		inc	eax
		mov	[esp+24h+var_C], eax
		cmp	eax, [esp+24h+var_8]
		jl	loc_100032B0
		pop	ebp
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10003372:				; CODE XREF: sasl_client_add_plugin+D5j
		push	ebp		; lpMem
		call	off_1002D050
		add	esp, 4

loc_1000337C:				; CODE XREF: sasl_client_add_plugin+B7j
		pop	ebp
		pop	ebx
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10003389:				; CODE XREF: sasl_client_add_plugin+Aj
					; sasl_client_add_plugin+16j
		mov	eax, 0FFFFFFF9h
		pop	edi
		add	esp, 14h
		retn
sasl_client_add_plugin endp

; ---------------------------------------------------------------------------
		align 10h

loc_100033A0:				; DATA XREF: sasl_client_init+109o
					; sasl_client_new+13Fo
		mov	eax, dword_1002E408
		test	eax, eax
		jnz	short loc_100033AA
		retn
; ---------------------------------------------------------------------------

loc_100033AA:				; CODE XREF: .text:100033A7j
		push	esi
		mov	esi, [eax+8]
		push	edi
		test	esi, esi
		jz	short loc_100033E7
		mov	edi, [esp+0Ch]

loc_100033B7:				; CODE XREF: .text:100033E5j
		mov	eax, [esi+8]
		cmp	dword ptr [eax+28h], 0
		jz	short loc_100033E0
		test	edi, edi
		jz	short loc_100033CC
		mov	ecx, [edi+1124h]
		jmp	short loc_100033CE
; ---------------------------------------------------------------------------

loc_100033CC:				; CODE XREF: .text:100033C2j
		xor	ecx, ecx

loc_100033CE:				; CODE XREF: .text:100033CAj
		mov	edx, [eax+28h]
		push	ecx
		mov	ecx, [eax+14h]
		push	edi
		push	ecx
		call	edx
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100033EC

loc_100033E0:				; CODE XREF: .text:100033BEj
		mov	esi, [esi+0Ch]
		test	esi, esi
		jnz	short loc_100033B7

loc_100033E7:				; CODE XREF: .text:100033B1j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100033EC:				; CODE XREF: .text:100033DEj
		pop	edi
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  29. sasl_client_init

; =============== S U B	R O U T	I N E =======================================


		public sasl_client_init
sasl_client_init proc near		; DATA XREF: .rdata:off_1002C568o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	ebx
		push	esi
		xor	ebx, ebx
		mov	esi, 1
		add	dword_1002E4AC,	esi
		push	edi
		mov	edi, [esp+28h+arg_0]
		mov	[esp+28h+var_1C], offset aSasl_client__1 ; "sasl_client_plug_init"
		mov	[esp+28h+var_18], offset sasl_client_add_plugin
		mov	[esp+28h+var_14], offset aSasl_canonus_0 ; "sasl_canonuser_init"
		mov	[esp+28h+var_10], offset sasl_canonuser_add_plugin
		mov	[esp+28h+var_C], ebx
		mov	[esp+28h+var_8], ebx
		cmp	dword_1002E40C,	ebx
		jz	short loc_1000346C
		add	dword_1002E40C,	esi
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000346C:				; CODE XREF: sasl_client_init+50j
		push	10h
		mov	dword_1002F070,	edi
		mov	dword_1002F074,	ebx
		call	off_1002D044
		add	esp, 4
		mov	dword_1002E408,	eax
		cmp	eax, ebx
		jz	loc_10003531
		push	offset dword_1002F070
		push	ebx
		mov	dword_1002E40C,	esi
		call	sub_10007350
		mov	ecx, dword_1002E408
		add	esp, 8
		mov	[ecx], eax
		cmp	eax, ebx
		jz	short loc_1000352C
		push	offset loc_10008050
		push	offset aExternal ; "EXTERNAL"
		mov	[ecx+8], ebx
		mov	[ecx+0Ch], ebx
		call	sasl_client_add_plugin
		push	offset dword_1002F070
		call	sub_10007860
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, ebx
		jnz	short loc_10003548
		push	edi
		call	sub_10005610
		add	esp, 4
		push	eax
		push	edi
		call	sub_100055B0
		add	esp, 4
		push	eax
		lea	eax, [esp+30h+var_1C]
		push	eax
		call	sub_1000C9A0
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, ebx
		jnz	short loc_10003548
		mov	dword_1002E49C,	offset sub_100030E0
		mov	dword_1002E4A4,	offset loc_100033A0
		call	sub_10005930
		pop	edi
		mov	esi, eax
		pop	esi
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000352C:				; CODE XREF: sasl_client_init+AEj
		call	sub_100030E0

loc_10003531:				; CODE XREF: sasl_client_init+8Aj
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10003548:				; CODE XREF: sasl_client_init+D6j
					; sasl_client_init+FDj
		call	sub_100030E0
		mov	ecx, [esp+28h+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sasl_client_init endp

; ---------------------------------------------------------------------------
		align 10h

loc_10003570:				; DATA XREF: sasl_client_new+B6o
		push	esi
		push	edi
		mov	edi, [esp+0Ch]
		mov	eax, [edi+1120h]
		test	eax, eax
		jz	short loc_100035A0
		mov	eax, [eax+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_100035A0
		mov	ecx, [edi+1124h]
		mov	edx, [ecx+0Ch]
		mov	ecx, [edi+85Ch]
		push	edx
		push	ecx
		call	eax
		add	esp, 8

loc_100035A0:				; CODE XREF: .text:1000357Ej
					; .text:10003588j
		mov	eax, [edi+1128h]
		mov	dword ptr [edi+85Ch], 0
		test	eax, eax
		jz	short loc_100035BE
		push	eax
		call	off_1002D050
		add	esp, 4

loc_100035BE:				; CODE XREF: .text:100035B2j
		mov	eax, [edi+1124h]
		test	eax, eax
		jz	short loc_100035E1
		add	eax, 0Ch
		push	eax
		call	sub_100054F0
		mov	edx, [edi+1124h]
		push	edx
		call	off_1002D050
		add	esp, 8

loc_100035E1:				; CODE XREF: .text:100035C6j
		mov	esi, [edi+112Ch]
		mov	eax, dword_1002E408
		cmp	esi, [eax+8]
		jz	short loc_10003606
		test	esi, esi
		jz	short loc_10003606

loc_100035F5:				; CODE XREF: .text:10003604j
		push	esi
		mov	esi, [esi+0Ch]
		call	off_1002D050
		add	esp, 4
		test	esi, esi
		jnz	short loc_100035F5

loc_10003606:				; CODE XREF: .text:100035EFj
					; .text:100035F3j
		push	edi
		call	sub_10004D80
		add	esp, 4
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  30. sasl_client_new

; =============== S U B	R O U T	I N E =======================================


		public sasl_client_new
sasl_client_new	proc near		; DATA XREF: .rdata:off_1002C568o

var_420		= dword	ptr -420h
var_41C		= dword	ptr -41Ch
var_418		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
name		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		sub	esp, 420h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+420h+var_4], eax
		mov	eax, [esp+420h+arg_8]
		mov	ecx, [esp+420h+arg_C]
		mov	edx, [esp+420h+arg_10]
		push	ebx
		push	ebp
		mov	ebp, [esp+428h+arg_18]
		xor	ebx, ebx
		push	esi
		mov	esi, [esp+42Ch+arg_0]
		push	edi
		mov	edi, [esp+430h+arg_4]
		mov	[esp+430h+var_418], eax
		mov	[esp+430h+var_410], ecx
		mov	[esp+430h+var_41C], edx
		mov	[esp+430h+var_420], ebx
		mov	[esp+430h+var_40C], ebx
		cmp	dword_1002E40C,	ebx
		jnz	short loc_10003688
		lea	eax, [ebx-0Ch]
		jmp	loc_100039E0
; ---------------------------------------------------------------------------

loc_10003688:				; CODE XREF: sasl_client_new+5Ej
		cmp	ebp, ebx
		jz	loc_100039DB
		cmp	esi, ebx
		jz	loc_100039DB
		push	1134h
		call	off_1002D044
		add	esp, 4
		mov	[ebp+0], eax
		cmp	eax, ebx
		jnz	short loc_100036C7
		push	offset aOutOfMemoryAll ; "Out of memory	allocating connection con"...
		push	1
		push	ebx
		call	sub_10006F30
		add	esp, 0Ch
		mov	eax, 0FFFFFFFEh
		jmp	loc_100039E0
; ---------------------------------------------------------------------------

loc_100036C7:				; CODE XREF: sasl_client_new+8Bj
		push	1134h
		push	ebx
		push	eax
		call	sub_1000E0F0
		mov	eax, [ebp+0]
		mov	dword ptr [eax+4], offset loc_10003570
		mov	ebx, [ebp+0]
		push	78h
		mov	dword ptr [ebx+1120h], 0
		call	off_1002D044
		add	esp, 10h
		mov	[ebx+1124h], eax
		test	eax, eax
		jnz	short loc_10003736
		mov	eax, [ebp+0]
		test	eax, eax
		jz	short loc_1000372C
		push	1A7h

loc_1000370B:				; CODE XREF: sasl_client_new+198j
		push	offset aOutOfMemoryInC ; "Out of Memory	in client.c near line %d"
		push	0
		push	eax
		call	sasl_seterror
		mov	ebp, [ebp+0]
		add	esp, 10h
		test	ebp, ebp
		jz	short loc_1000372C
		mov	dword ptr [ebp+8F0h], 0FFFFFFFEh

loc_1000372C:				; CODE XREF: sasl_client_new+E4j
					; sasl_client_new+100j	...
		mov	eax, 0FFFFFFFEh
		jmp	loc_100039E0
; ---------------------------------------------------------------------------

loc_10003736:				; CODE XREF: sasl_client_new+DDj
		push	78h
		push	0
		push	eax
		call	sub_1000E0F0
		mov	ecx, [esp+43Ch+var_41C]
		mov	edx, [esp+43Ch+var_410]
		mov	eax, [esp+43Ch+var_418]
		push	offset dword_1002F070
		push	ecx
		mov	ecx, [esp+444h+arg_14]
		push	edx
		mov	edx, [ebp+0]
		push	eax
		push	edi
		push	offset loc_100033A0
		push	2
		push	ecx
		push	esi
		push	edx
		call	sub_100075A0
		add	esp, 34h
		test	eax, eax
		jz	short loc_10003793
		mov	ebp, [ebp+0]
		test	ebp, ebp
		jz	loc_100039E0
		test	eax, eax
		jns	loc_100039E0
		mov	[ebp+8F0h], eax
		jmp	loc_100039E0
; ---------------------------------------------------------------------------

loc_10003793:				; CODE XREF: sasl_client_new+153j
		mov	eax, [ebp+0]
		push	offset dword_1002F070
		push	eax
		call	sub_10007350
		add	esp, 8
		test	eax, eax
		jnz	short loc_100037BD
		mov	eax, [ebp+0]
		test	eax, eax
		jz	loc_1000372C
		push	1B2h
		jmp	loc_1000370B
; ---------------------------------------------------------------------------

loc_100037BD:				; CODE XREF: sasl_client_new+186j
		mov	ecx, [ebp+0]
		mov	[eax+4], ecx
		mov	edx, [ebx+1124h]
		mov	[edx+0Ch], eax
		mov	edx, [ebp+0]
		lea	eax, [esp+430h+var_408]
		push	eax
		lea	ecx, [esp+434h+var_414]
		push	ecx
		push	1
		push	edx
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10003801
		mov	ecx, [esp+430h+var_408]
		push	eax
		lea	eax, [esp+434h+var_420]
		push	eax
		push	offset aClient_mech_li ; "client_mech_list"
		push	0
		push	ecx
		call	[esp+444h+var_414]
		add	esp, 14h

loc_10003801:				; CODE XREF: sasl_client_new+1C6j
		mov	eax, [esp+430h+var_420]
		test	eax, eax
		jz	loc_10003922
		cmp	byte ptr [eax],	0
		mov	[esp+430h+var_41C], 0
		jz	loc_10003939
		mov	edi, edi

loc_10003820:				; CODE XREF: sasl_client_new+2C3j
		mov	edi, eax

loc_10003822:				; CODE XREF: sasl_client_new+215j
		movsx	edx, byte ptr [edi]
		push	edx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jnz	short loc_10003837
		inc	edi
		cmp	[edi], al
		jnz	short loc_10003822

loc_10003837:				; CODE XREF: sasl_client_new+210j
		mov	eax, dword_1002E408
		mov	esi, [eax+8]
		test	esi, esi
		jz	short loc_100038B5

loc_10003843:				; CODE XREF: sasl_client_new+249j
		mov	eax, [esi+8]
		mov	eax, [eax]
		lea	ecx, [esp+430h+var_40C]
		push	ecx
		mov	ecx, [esp+434h+var_420]
		mov	edx, edi
		sub	edx, ecx
		push	edx
		push	eax
		push	ecx
		call	sub_10005BC0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000386D
		mov	esi, [esi+0Ch]
		test	esi, esi
		jnz	short loc_10003843
		jmp	short loc_100038B5
; ---------------------------------------------------------------------------

loc_1000386D:				; CODE XREF: sasl_client_new+242j
		push	10h
		call	off_1002D044
		add	esp, 4
		test	eax, eax
		jz	short loc_100038EB
		mov	ecx, [esi]
		mov	[eax], ecx
		mov	edx, [esi+4]
		mov	[eax+4], edx
		mov	ecx, [esi+8]
		mov	[eax+8], ecx
		mov	dword ptr [eax+0Ch], 0
		cmp	dword ptr [ebx+112Ch], 0
		jnz	short loc_100038A4
		mov	[ebx+112Ch], eax
		jmp	short loc_100038AB
; ---------------------------------------------------------------------------

loc_100038A4:				; CODE XREF: sasl_client_new+27Aj
		mov	edx, [esp+430h+var_41C]
		mov	[edx+0Ch], eax

loc_100038AB:				; CODE XREF: sasl_client_new+282j
		inc	dword ptr [ebx+1130h]
		mov	[esp+430h+var_41C], eax

loc_100038B5:				; CODE XREF: sasl_client_new+221j
					; sasl_client_new+24Bj
		mov	eax, edi
		mov	[esp+430h+var_420], eax
		cmp	byte ptr [edi],	0
		jz	short loc_100038E0

loc_100038C0:				; CODE XREF: sasl_client_new+2BCj
		movsx	eax, byte ptr [eax]
		push	eax
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		mov	eax, [esp+430h+var_420]
		jz	short loc_100038E0
		inc	eax
		mov	[esp+430h+var_420], eax
		cmp	byte ptr [eax],	0
		jnz	short loc_100038C0
		jmp	short loc_10003939
; ---------------------------------------------------------------------------

loc_100038E0:				; CODE XREF: sasl_client_new+29Ej
					; sasl_client_new+2B2j
		cmp	byte ptr [eax],	0
		jnz	loc_10003820
		jmp	short loc_10003939
; ---------------------------------------------------------------------------

loc_100038EB:				; CODE XREF: sasl_client_new+25Aj
		mov	esi, 0FFFFFFFEh

loc_100038F0:				; CODE XREF: sasl_client_new+33Aj
					; sasl_client_new+3B3j
		mov	ecx, [ebp+0]
		push	ecx
		call	sub_10004D80
		mov	edx, [ebp+0]
		push	edx		; lpMem
		call	off_1002D050
		push	offset aOutOfMemoryInS ; "Out of memory	in sasl_client_new"
		push	1
		push	0
		mov	dword ptr [ebp+0], 0
		call	sub_10006F30
		add	esp, 14h
		mov	eax, esi
		jmp	loc_100039E0
; ---------------------------------------------------------------------------

loc_10003922:				; CODE XREF: sasl_client_new+1E7j
		mov	eax, dword_1002E408
		mov	ecx, [eax+8]
		mov	[ebx+112Ch], ecx
		mov	edx, [eax+0Ch]
		mov	[ebx+1130h], edx

loc_10003939:				; CODE XREF: sasl_client_new+1F8j
					; sasl_client_new+2BEj	...
		cmp	dword ptr [ebx+112Ch], 0
		jnz	short loc_1000395C
		mov	eax, [ebp+0]
		push	offset aNoWorthyMechsF ; "No worthy mechs found"
		push	0
		push	eax
		call	sasl_seterror
		add	esp, 0Ch
		mov	esi, 0FFFFFFFCh
		jmp	short loc_100038F0
; ---------------------------------------------------------------------------

loc_1000395C:				; CODE XREF: sasl_client_new+320j
		mov	ecx, [ebx+1124h]
		mov	eax, [esp+430h+arg_14]
		mov	dword ptr [ecx+5Ch], offset sub_100027C0
		mov	edx, [ebx+1124h]
		mov	[edx+70h], eax
		mov	ecx, [ebp+0]
		mov	eax, [ecx+8E0h]
		mov	edx, [ebx+1124h]
		push	400h
		lea	ecx, [esp+434h+name]
		push	0
		push	ecx
		mov	[edx+10h], eax
		call	sub_1000E0F0
		push	0		; int
		lea	edx, [esp+440h+name]
		push	400h		; namelen
		push	edx		; name
		call	sub_10009420
		add	esp, 18h
		test	eax, eax
		jz	short loc_100039B9
		or	eax, 0FFFFFFFFh
		jmp	short loc_100039E0
; ---------------------------------------------------------------------------

loc_100039B9:				; CODE XREF: sasl_client_new+392j
		push	0
		add	ebx, 1128h
		lea	eax, [esp+434h+name]
		push	ebx
		push	eax
		call	sub_10004910
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	loc_100038F0
		jmp	short loc_100039E0
; ---------------------------------------------------------------------------

loc_100039DB:				; CODE XREF: sasl_client_new+6Aj
					; sasl_client_new+72j
		mov	eax, 0FFFFFFF9h

loc_100039E0:				; CODE XREF: sasl_client_new+63j
					; sasl_client_new+A2j ...
		mov	ecx, [esp+430h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 420h
		retn
sasl_client_new	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003A00	proc near		; CODE XREF: sub_10003D90+1C3p
					; sasl_client_start+168p

var_8		= byte ptr -8
var_4		= byte ptr -4

		sub	esp, 8
		push	esi
		mov	esi, [eax+10h]
		test	esi, esi
		jnz	short loc_10003A12
		mov	esi, offset dword_1002749C
		jmp	short loc_10003A17
; ---------------------------------------------------------------------------

loc_10003A12:				; CODE XREF: sub_10003A00+9j
		cmp	dword ptr [esi], 0
		jz	short loc_10003A3E

loc_10003A17:				; CODE XREF: sub_10003A00+10j
					; sub_10003A00+3Cj
		mov	eax, [esi]
		lea	ecx, [esp+0Ch+var_8]
		push	ecx
		lea	edx, [esp+10h+var_4]
		push	edx
		push	eax
		push	edi
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jz	short loc_10003A36
		cmp	eax, 2
		jnz	short loc_10003A48

loc_10003A36:				; CODE XREF: sub_10003A00+2Fj
		add	esi, 4
		cmp	dword ptr [esi], 0
		jnz	short loc_10003A17

loc_10003A3E:				; CODE XREF: sub_10003A00+15j
		mov	eax, 1
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10003A48:				; CODE XREF: sub_10003A00+34j
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
sub_10003A00	endp

; ---------------------------------------------------------------------------
		align 10h
		cmp	eax, 5
		jbe	short loc_10003A73
		push	5
		lea	edx, [ecx+eax-5]
		push	offset aPlus	; "-PLUS"
		push	edx
		call	sub_10023FC7
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10003A73
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_10003A73:				; CODE XREF: .text:10003A53j
					; .text:10003A6Bj
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003A80	proc near		; CODE XREF: sasl_client_start+BDp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	eax, [esp+arg_10]
		mov	ecx, [esp+arg_14]
		sub	esp, 0Ch
		push	esi
		mov	esi, [esp+10h+arg_4]
		mov	dword ptr [eax], 0
		mov	dword ptr [ecx], 0
		test	esi, esi
		jz	loc_10003BE3
		cmp	byte ptr [esi],	0
		jz	loc_10003BE3
		mov	eax, esi
		lea	edx, [eax+1]

loc_10003AB2:				; CODE XREF: sub_10003A80+37j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10003AB2
		sub	eax, edx
		push	ebx
		mov	ebx, eax
		mov	eax, [esp+14h+arg_0]
		mov	ecx, [eax+14h]
		lea	edx, [ebx+1]
		push	ebp
		push	edx
		mov	[esp+1Ch+var_4], ebx
		call	ecx
		add	esp, 4
		mov	[esp+18h+var_8], eax
		mov	ebp, eax
		test	eax, eax
		jnz	short loc_10003AE7
		lea	eax, [ebp-2]
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10003AE7:				; CODE XREF: sub_10003A80+5Bj
		push	edi
		jmp	short loc_10003AF0
; ---------------------------------------------------------------------------
		align 10h

loc_10003AF0:				; CODE XREF: sub_10003A80+68j
					; sub_10003A80+124j
		xor	edi, edi
		mov	[esp+1Ch+var_C], edi

loc_10003AF6:				; CODE XREF: sub_10003A80+10Fj
		movsx	edx, byte ptr [edi+esi]
		push	edx
		call	sub_1000EAE3
		add	esp, 4
		test	eax, eax
		jnz	loc_10003B8C
		mov	al, [edi+esi]
		cmp	al, 5Fh
		jz	short loc_10003B8C
		cmp	al, 2Dh
		jz	short loc_10003B8C
		mov	ebx, [esp+1Ch+var_C]
		add	ebx, esi
		mov	esi, edi
		sub	esi, [esp+1Ch+var_C]
		jz	short loc_10003B7F
		cmp	esi, 5
		jbe	short loc_10003B48
		push	5
		lea	ecx, [esi+ebx-5]
		push	offset aPlus	; "-PLUS"
		push	ecx
		call	sub_10023FC7
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10003B48
		mov	eax, 1
		jmp	short loc_10003B4A
; ---------------------------------------------------------------------------

loc_10003B48:				; CODE XREF: sub_10003A80+A7j
					; sub_10003A80+BFj
		xor	eax, eax

loc_10003B4A:				; CODE XREF: sub_10003A80+C6j
		cmp	eax, [esp+1Ch+arg_8]
		jnz	short loc_10003B7F
		push	esi
		push	ebx
		push	ebp
		call	sub_1000E2B0
		mov	eax, [esp+28h+arg_10]
		mov	byte ptr [esi+ebp], 0
		inc	dword ptr [eax]
		mov	eax, [esp+28h+arg_14]
		add	esp, 0Ch
		cmp	dword ptr [eax], 0
		lea	ebp, [esi+ebp+1]
		jnz	short loc_10003B7F
		cmp	[esp+1Ch+arg_8], 0
		jz	short loc_10003B7F
		mov	dword ptr [eax], 1

loc_10003B7F:				; CODE XREF: sub_10003A80+A2j
					; sub_10003A80+CEj ...
		mov	esi, [esp+1Ch+arg_4]
		mov	ebx, [esp+1Ch+var_4]
		inc	edi
		mov	[esp+1Ch+var_C], edi

loc_10003B8C:				; CODE XREF: sub_10003A80+85j
					; sub_10003A80+90j ...
		inc	edi
		cmp	edi, ebx
		jbe	loc_10003AF6
		cmp	[esp+1Ch+arg_8], 0
		jz	short loc_10003BA9
		mov	[esp+1Ch+arg_8], 0
		jmp	loc_10003AF0
; ---------------------------------------------------------------------------

loc_10003BA9:				; CODE XREF: sub_10003A80+11Aj
		mov	edx, [esp+1Ch+arg_10]
		cmp	dword ptr [edx], 0
		pop	edi
		jnz	short loc_10003BD0
		mov	eax, [esp+18h+var_8]
		mov	ecx, [esp+18h+arg_0]
		mov	edx, [ecx+20h]
		push	eax
		call	edx
		add	esp, 4
		pop	ebp
		pop	ebx
		mov	eax, 0FFFFFFFCh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10003BD0:				; CODE XREF: sub_10003A80+131j
		mov	eax, [esp+18h+arg_C]
		mov	ecx, [esp+18h+var_8]
		pop	ebp
		pop	ebx
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10003BE3:				; CODE XREF: sub_10003A80+1Ej
					; sub_10003A80+27j
		mov	eax, 0FFFFFFFCh
		pop	esi
		add	esp, 0Ch
		retn
sub_10003A80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003BF0	proc near		; CODE XREF: sasl_client_start+EEp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	dword ptr [ecx], 0
		mov	eax, [eax+50h]
		test	eax, eax
		jz	short loc_10003C2C
		cmp	[esp+arg_0], 0
		jz	short loc_10003C20
		cmp	[esp+arg_4], 0
		jnz	short loc_10003C17
		cmp	dword ptr [eax+4], 0
		jz	short loc_10003C17
		mov	eax, 0FFFFFFFCh
		retn
; ---------------------------------------------------------------------------

loc_10003C17:				; CODE XREF: sub_10003BF0+19j
					; sub_10003BF0+1Fj
		mov	dword ptr [ecx], 1
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10003C20:				; CODE XREF: sub_10003BF0+12j
		cmp	dword ptr [eax+4], 0
		jz	short loc_10003C2C
		mov	dword ptr [ecx], 2

loc_10003C2C:				; CODE XREF: sub_10003BF0+Bj
					; sub_10003BF0+34j
		xor	eax, eax
		retn
sub_10003BF0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  33. sasl_client_step

; =============== S U B	R O U T	I N E =======================================


		public sasl_client_step
sasl_client_step proc near		; CODE XREF: sasl_client_start+405p
					; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		cmp	dword_1002E40C,	0
		jnz	short loc_10003C3F
		mov	eax, 0FFFFFFF4h
		retn
; ---------------------------------------------------------------------------

loc_10003C3F:				; CODE XREF: sasl_client_step+7j
		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_10003C4D
		lea	eax, [esi-7]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003C4D:				; CODE XREF: sasl_client_step+16j
		mov	ecx, [esp+4+arg_4]
		mov	edx, [esp+4+arg_8]
		test	ecx, ecx
		jnz	short loc_10003C7F
		test	edx, edx
		jz	short loc_10003C7F
		push	3AFh
		push	offset aParameterErr_0 ; "Parameter error in client.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		mov	eax, 0FFFFFFF9h
		add	esp, 10h
		mov	[esi+8F0h], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003C7F:				; CODE XREF: sasl_client_step+27j
					; sasl_client_step+2Bj
		cmp	dword ptr [esi+860h], 0
		lea	eax, [esi+860h]
		jz	short loc_10003CA3
		push	offset aAttemptingClie ; "attempting client step after doneflag"
		push	1
		push	esi
		call	sub_10006F30
		add	esp, 0Ch
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003CA3:				; CODE XREF: sasl_client_step+5Cj
		push	ebx
		push	edi
		mov	edi, [esp+0Ch+arg_10]
		test	edi, edi
		jz	short loc_10003CB3
		mov	dword ptr [edi], 0

loc_10003CB3:				; CODE XREF: sasl_client_step+7Bj
		mov	ebx, [esp+0Ch+arg_14]
		test	ebx, ebx
		jz	short loc_10003CC1
		mov	dword ptr [ebx], 0

loc_10003CC1:				; CODE XREF: sasl_client_step+89j
		push	ebp
		mov	ebp, [esi+1120h]
		mov	ebp, [ebp+8]
		push	eax
		mov	eax, [esp+14h+arg_C]
		push	ebx
		push	edi
		push	eax
		mov	eax, [ebp+1Ch]
		push	edx
		mov	edx, [esi+85Ch]
		push	ecx
		mov	ecx, [esi+1124h]
		push	ecx
		push	edx
		call	eax
		add	esp, 20h
		pop	ebp
		test	eax, eax
		jnz	short loc_10003D48
		cmp	[edi], eax
		jnz	short loc_10003D02
		test	byte ptr [esi+0Ch], 4
		jnz	short loc_10003D02
		mov	dword ptr [edi], offset	byte_1002762D
		mov	[ebx], eax

loc_10003D02:				; CODE XREF: sasl_client_step+C2j
					; sasl_client_step+C8j
		cmp	dword ptr [esi+874h], 0
		jnz	short loc_10003D17
		mov	ecx, [esi+8C0h]
		mov	[esi+874h], ecx

loc_10003D17:				; CODE XREF: sasl_client_step+D9j
		cmp	dword ptr [esi+864h], 0
		jz	short loc_10003D29
		cmp	dword ptr [esi+868h], 0
		jnz	short loc_10003D50

loc_10003D29:				; CODE XREF: sasl_client_step+EEj
		push	offset aMechDidNotCall ; "mech did not call canon_user for both	a"...
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		pop	edi
		mov	eax, 0FFFFFFFBh
		pop	ebx
		mov	[esi+8F0h], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003D48:				; CODE XREF: sasl_client_step+BEj
		jns	short loc_10003D50
		mov	[esi+8F0h], eax

loc_10003D50:				; CODE XREF: sasl_client_step+F7j
					; sasl_client_step:loc_10003D48j
		pop	edi
		pop	ebx
		pop	esi
		retn
sasl_client_step endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		test	edx, edx
		jz	short locret_10003D84
		push	ebx
		push	esi

loc_10003D68:				; CODE XREF: .text:10003D80j
		mov	ecx, [edx+8]
		mov	ecx, [ecx]
		lea	esi, [ecx+1]

loc_10003D70:				; CODE XREF: .text:10003D75j
		mov	bl, [ecx]
		inc	ecx
		test	bl, bl
		jnz	short loc_10003D70
		mov	edx, [edx+0Ch]
		sub	ecx, esi
		add	eax, ecx
		test	edx, edx
		jnz	short loc_10003D68
		pop	esi
		pop	ebx

locret_10003D84:			; CODE XREF: .text:10003D64j
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003D90	proc near		; CODE XREF: sasl_listmech+B7p
					; sasl_listmech+D6p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		sub	esp, 0Ch
		push	edi
		xor	edi, edi
		cmp	dword_1002E40C,	edi
		jnz	short loc_10003DA6
		lea	eax, [edi-0Ch]
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10003DA6:				; CODE XREF: sub_10003D90+Cj
		push	esi
		mov	esi, [esp+14h+arg_0]
		cmp	esi, edi
		jnz	short loc_10003DBA
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10003DBA:				; CODE XREF: sub_10003D90+1Dj
		cmp	dword ptr [esi], 2
		jz	short loc_10003DC6
		push	3FFh
		jmp	short loc_10003DD1
; ---------------------------------------------------------------------------

loc_10003DC6:				; CODE XREF: sub_10003D90+2Dj
		cmp	[esp+14h+arg_10], edi
		jnz	short loc_10003DF2
		push	402h

loc_10003DD1:				; CODE XREF: sub_10003D90+34j
		push	offset aParameterErr_0 ; "Parameter error in client.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		mov	[esi+8F0h], eax
		pop	esi
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10003DF2:				; CODE XREF: sub_10003D90+3Aj
		mov	eax, [esp+14h+arg_14]
		cmp	eax, edi
		jz	short loc_10003DFC
		mov	[eax], edi

loc_10003DFC:				; CODE XREF: sub_10003D90+68j
		mov	eax, [esp+14h+arg_18]
		cmp	eax, edi
		jz	short loc_10003E06
		mov	[eax], edi

loc_10003E06:				; CODE XREF: sub_10003D90+72j
		mov	eax, [esp+14h+arg_8]
		push	ebx
		cmp	eax, edi
		jz	short loc_10003E17
		mov	ebx, eax
		mov	[esp+18h+var_4], eax
		jmp	short loc_10003E20
; ---------------------------------------------------------------------------

loc_10003E17:				; CODE XREF: sub_10003D90+7Dj
		mov	ebx, offset asc_100276B0 ; " "
		mov	[esp+18h+var_4], ebx

loc_10003E20:				; CODE XREF: sub_10003D90+85j
		mov	eax, [esi+8B8h]
		mov	ecx, [esi+8D0h]
		cmp	eax, ecx
		jnb	short loc_10003E36
		mov	[esp+18h+var_8], edi
		jmp	short loc_10003E3C
; ---------------------------------------------------------------------------

loc_10003E36:				; CODE XREF: sub_10003D90+9Ej
		sub	eax, ecx
		mov	[esp+18h+var_8], eax

loc_10003E3C:				; CODE XREF: sub_10003D90+A4j
		mov	ecx, [esi+112Ch]
		cmp	ecx, edi
		jz	loc_10004081
		cmp	[esi+1130h], edi
		jle	loc_10004081
		mov	eax, [esp+18h+arg_4]
		cmp	eax, edi
		jz	short loc_10003E70
		lea	esi, [eax+1]

loc_10003E61:				; CODE XREF: sub_10003D90+D6j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10003E61
		sub	eax, esi
		mov	[esp+18h+var_C], eax
		jmp	short loc_10003E74
; ---------------------------------------------------------------------------

loc_10003E70:				; CODE XREF: sub_10003D90+CCj
		mov	[esp+18h+var_C], edi

loc_10003E74:				; CODE XREF: sub_10003D90+DEj
		mov	eax, ebx
		lea	esi, [eax+1]
		lea	esp, [esp+0]

loc_10003E80:				; CODE XREF: sub_10003D90+F5j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10003E80
		sub	eax, esi
		push	ebp
		mov	ebp, eax
		mov	eax, [esp+1Ch+arg_C]
		cmp	eax, edi
		jz	short loc_10003EA4
		lea	esi, [eax+1]

loc_10003E97:				; CODE XREF: sub_10003D90+10Cj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10003E97
		sub	eax, esi
		mov	ebx, eax
		jmp	short loc_10003EA6
; ---------------------------------------------------------------------------

loc_10003EA4:				; CODE XREF: sub_10003D90+102j
		xor	ebx, ebx

loc_10003EA6:				; CODE XREF: sub_10003D90+112j
		xor	esi, esi

loc_10003EA8:				; CODE XREF: sub_10003D90+130j
		mov	eax, [ecx+8]
		mov	eax, [eax]
		lea	edi, [eax+1]

loc_10003EB0:				; CODE XREF: sub_10003D90+125j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10003EB0
		mov	ecx, [ecx+0Ch]
		sub	eax, edi
		add	esi, eax
		test	ecx, ecx
		jnz	short loc_10003EA8
		mov	edi, [esp+1Ch+arg_0]
		mov	eax, [edi+1130h]
		dec	eax
		imul	eax, ebp
		add	eax, ebx
		add	eax, [esp+1Ch+var_C]
		lea	ecx, [edi+908h]
		lea	eax, [eax+esi+1]
		push	eax
		push	ecx
		lea	ebx, [edi+904h]
		push	ebx
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10003F1D
		push	421h
		push	offset aOutOfMemoryInC ; "Out of Memory	in client.c near line %d"
		push	0
		push	edi
		call	sasl_seterror
		add	esp, 10h
		pop	ebp
		pop	ebx
		mov	eax, 0FFFFFFFEh
		pop	esi
		mov	[edi+8F0h], eax
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10003F1D:				; CODE XREF: sub_10003D90+163j
		mov	ecx, [esp+1Ch+arg_4]
		mov	edx, [ebx]
		test	ecx, ecx
		jz	short loc_10003F33

loc_10003F27:				; CODE XREF: sub_10003D90+19Fj
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_10003F27
		jmp	short loc_10003F36
; ---------------------------------------------------------------------------

loc_10003F33:				; CODE XREF: sub_10003D90+195j
		mov	byte ptr [edx],	0

loc_10003F36:				; CODE XREF: sub_10003D90+1A1j
		mov	ebp, [edi+112Ch]
		mov	[esp+1Ch+var_C], 0
		test	ebp, ebp
		jz	loc_10004029
		mov	esi, [esp+1Ch+arg_18]

loc_10003F50:				; CODE XREF: sub_10003D90+293j
		mov	eax, [ebp+8]
		call	sub_10003A00
		test	eax, eax
		jz	loc_1000401E
		mov	eax, [ebp+8]
		mov	ecx, [esp+1Ch+var_8]
		cmp	ecx, [eax+4]
		ja	loc_1000401E
		mov	ecx, [edi+8C4h]
		mov	edx, [eax+8]
		xor	edx, ecx
		test	ecx, edx
		jnz	loc_1000401E
		mov	eax, [eax+0Ch]
		test	al, 1
		jz	short loc_10003F97
		cmp	dword ptr [edi+8E8h], 0
		jz	loc_1000401E

loc_10003F97:				; CODE XREF: sub_10003D90+1F8j
		test	byte ptr [edi+0Ch], 8
		jz	short loc_10003FA5
		test	al, 20h
		jz	loc_1000401E

loc_10003FA5:				; CODE XREF: sub_10003D90+20Bj
		test	esi, esi
		jz	short loc_10003FAB
		inc	dword ptr [esi]

loc_10003FAB:				; CODE XREF: sub_10003D90+217j
		cmp	[esp+1Ch+var_C], 0
		jz	short loc_10003FDE
		mov	eax, [esp+1Ch+var_4]
		mov	ecx, eax

loc_10003FB8:				; CODE XREF: sub_10003D90+22Dj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10003FB8
		mov	edi, [ebx]
		sub	eax, ecx
		mov	esi, ecx
		dec	edi

loc_10003FC6:				; CODE XREF: sub_10003D90+23Cj
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_10003FC6
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		jmp	short loc_10003FE6
; ---------------------------------------------------------------------------

loc_10003FDE:				; CODE XREF: sub_10003D90+220j
		mov	[esp+1Ch+var_C], 1

loc_10003FE6:				; CODE XREF: sub_10003D90+24Cj
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	ecx, eax
		lea	ecx, [ecx+0]

loc_10003FF0:				; CODE XREF: sub_10003D90+265j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10003FF0
		mov	edi, [ebx]
		sub	eax, ecx
		mov	esi, ecx
		dec	edi
		mov	edi, edi

loc_10004000:				; CODE XREF: sub_10003D90+276j
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_10004000
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		mov	edi, [esp+1Ch+arg_0]
		mov	esi, [esp+1Ch+arg_18]

loc_1000401E:				; CODE XREF: sub_10003D90+1CAj
					; sub_10003D90+1DAj ...
		mov	ebp, [ebp+0Ch]
		test	ebp, ebp
		jnz	loc_10003F50

loc_10004029:				; CODE XREF: sub_10003D90+1B6j
		mov	eax, [esp+1Ch+arg_C]
		test	eax, eax
		jz	short loc_10004057
		mov	ecx, eax

loc_10004033:				; CODE XREF: sub_10003D90+2A8j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10004033
		mov	edi, [ebx]
		sub	eax, ecx
		mov	esi, ecx
		dec	edi

loc_10004041:				; CODE XREF: sub_10003D90+2B7j
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_10004041
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb

loc_10004057:				; CODE XREF: sub_10003D90+29Fj
		mov	esi, [esp+1Ch+arg_14]
		test	esi, esi
		jz	short loc_1000406F
		mov	eax, [ebx]
		lea	edx, [eax+1]

loc_10004064:				; CODE XREF: sub_10003D90+2D9j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10004064
		sub	eax, edx
		mov	[esi], eax

loc_1000406F:				; CODE XREF: sub_10003D90+2CDj
		mov	ecx, [ebx]
		mov	edx, [esp+1Ch+arg_10]
		pop	ebp
		pop	ebx
		pop	esi
		mov	[edx], ecx
		xor	eax, eax
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10004081:				; CODE XREF: sub_10003D90+B4j
					; sub_10003D90+C0j
		push	416h
		push	0FFFFFFFCh
		push	offset aInternalErro_0 ; "Internal Error %d in client.c	near line"...
		push	edi
		push	esi
		call	sasl_seterror
		add	esp, 14h
		pop	ebx
		mov	dword ptr [esi+8F0h], 0FFFFFFFCh
		pop	esi
		mov	eax, 0FFFFFFFCh
		pop	edi
		add	esp, 0Ch
		retn
sub_10003D90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100040B0	proc near		; CODE XREF: sub_10005930+Cp
		push	esi
		xor	esi, esi
		cmp	dword_1002E40C,	esi
		jnz	short loc_100040BF
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100040BF:				; CODE XREF: sub_100040B0+9j
		mov	eax, dword_1002E408
		push	edi
		mov	edi, [eax+8]
		test	edi, edi
		jz	short loc_100040FB
		lea	esp, [esp+0]

loc_100040D0:				; CODE XREF: sub_100040B0+49j
		push	8
		call	off_1002D044
		add	esp, 4
		test	eax, eax
		jz	short loc_10004100
		mov	ecx, [edi+8]
		mov	edx, [ecx]
		mov	[eax], edx
		test	esi, esi
		jnz	short loc_100040EF
		mov	[eax+4], esi
		jmp	short loc_100040F2
; ---------------------------------------------------------------------------

loc_100040EF:				; CODE XREF: sub_100040B0+38j
		mov	[eax+4], esi

loc_100040F2:				; CODE XREF: sub_100040B0+3Dj
		mov	edi, [edi+0Ch]
		mov	esi, eax
		test	edi, edi
		jnz	short loc_100040D0

loc_100040FB:				; CODE XREF: sub_100040B0+1Aj
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004100:				; CODE XREF: sub_100040B0+2Dj
		test	esi, esi
		jz	short loc_1000411A
		mov	edi, [esi+4]

loc_10004107:				; CODE XREF: sub_100040B0+68j
		push	esi		; lpMem
		call	off_1002D050
		mov	esi, edi
		mov	edi, [edi+4]
		add	esp, 4
		test	edi, edi
		jnz	short loc_10004107

loc_1000411A:				; CODE XREF: sub_100040B0+52j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_100040B0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10004120:				; DATA XREF: sasl_client_plugin_info+Co
		mov	eax, [esp+8]
		test	eax, eax
		jnz	short loc_10004136
		push	offset aListOfClientPl ; "List of client plugins follows\n"
		call	sub_1000ED67
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_10004136:				; CODE XREF: .text:10004126j
		cmp	eax, 2
		jz	locret_1000433F
		push	esi
		mov	esi, [esp+8]
		mov	eax, [esi+4]
		push	eax
		push	offset aPluginS	; "Plugin \"%s\" "
		call	sub_1000ED67
		push	offset aLoaded	; "[loaded]"
		call	sub_1000ED67
		mov	ecx, [esi]
		push	ecx
		push	offset aApiVersionD ; ", \tAPI version:	%d\n"
		call	sub_1000ED67
		add	esp, 14h
		cmp	dword ptr [esi+8], 0
		jz	loc_10004331
		mov	eax, [esi+8]
		mov	edx, [eax+4]
		mov	eax, [eax]
		push	edx
		push	eax
		push	offset aSaslMechanismS ; "\tSASL mechanism: %s,	best SSF: %d\n"
		call	sub_1000ED67
		push	offset aSecurityFlags ;	"\tsecurity flags:"
		call	sub_1000ED67
		mov	ecx, [esi+8]
		add	esp, 10h
		test	byte ptr [ecx+8], 10h
		mov	al, 20h
		jz	short loc_100041B3
		push	20h
		push	offset aCno_anonymous ;	"%cNO_ANONYMOUS"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_100041B3:				; CODE XREF: .text:100041A0j
		mov	edx, [esi+8]
		test	byte ptr [edx+8], 1
		jz	short loc_100041CF
		movsx	eax, al
		push	eax
		push	offset aCno_plaintext ;	"%cNO_PLAINTEXT"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_100041CF:				; CODE XREF: .text:100041BAj
		mov	ecx, [esi+8]
		test	byte ptr [ecx+8], 2
		jz	short loc_100041EB
		movsx	edx, al
		push	edx
		push	offset aCno_active ; "%cNO_ACTIVE"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_100041EB:				; CODE XREF: .text:100041D6j
		mov	ecx, [esi+8]
		test	byte ptr [ecx+8], 4
		jz	short loc_10004207
		movsx	edx, al
		push	edx
		push	offset aCno_dictionary ; "%cNO_DICTIONARY"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_10004207:				; CODE XREF: .text:100041F2j
		mov	ecx, [esi+8]
		test	byte ptr [ecx+8], 8
		jz	short loc_10004223
		movsx	edx, al
		push	edx
		push	offset aCforward_secre ; "%cFORWARD_SECRECY"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_10004223:				; CODE XREF: .text:1000420Ej
		mov	ecx, [esi+8]
		test	byte ptr [ecx+8], 20h
		jz	short loc_1000423F
		movsx	edx, al
		push	edx
		push	offset aCpass_credenti ; "%cPASS_CREDENTIALS"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000423F:				; CODE XREF: .text:1000422Aj
		mov	ecx, [esi+8]
		test	byte ptr [ecx+8], 40h
		jz	short loc_10004259
		movsx	edx, al
		push	edx
		push	offset aCmutual_auth ; "%cMUTUAL_AUTH"
		call	sub_1000ED67
		add	esp, 8

loc_10004259:				; CODE XREF: .text:10004246j
		push	offset aFeatures ; "\n\tfeatures:"
		call	sub_1000ED67
		mov	ecx, [esi+8]
		add	esp, 4
		test	byte ptr [ecx+0Ch], 2
		mov	al, 20h
		jz	short loc_10004282
		push	20h
		push	offset aCwant_client_f ; "%cWANT_CLIENT_FIRST"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_10004282:				; CODE XREF: .text:1000426Fj
		mov	edx, [esi+8]
		test	byte ptr [edx+0Ch], 10h
		jz	short loc_1000429E
		movsx	eax, al
		push	eax
		push	offset aCserver_first ;	"%cSERVER_FIRST"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000429E:				; CODE XREF: .text:10004289j
		mov	ecx, [esi+8]
		test	byte ptr [ecx+0Ch], 20h
		jz	short loc_100042BA
		movsx	edx, al
		push	edx
		push	offset aCproxy_authent ; "%cPROXY_AUTHENTICATION"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_100042BA:				; CODE XREF: .text:100042A5j
		mov	ecx, [esi+8]
		test	byte ptr [ecx+0Ch], 1
		jz	short loc_100042D6
		movsx	edx, al
		push	edx
		push	offset aCneed_server_f ; "%cNEED_SERVER_FQDN"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_100042D6:				; CODE XREF: .text:100042C1j
		mov	ecx, [esi+8]
		test	dword ptr [ecx+0Ch], 100h
		jz	short loc_100042F5
		movsx	edx, al
		push	edx
		push	offset aCgss_framing ; "%cGSS_FRAMING"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_100042F5:				; CODE XREF: .text:100042E0j
		mov	ecx, [esi+8]
		test	dword ptr [ecx+0Ch], 800h
		jz	short loc_10004314
		movsx	edx, al
		push	edx
		push	offset aCchannel_bindi ; "%cCHANNEL_BINDING"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_10004314:				; CODE XREF: .text:100042FFj
		mov	ecx, [esi+8]
		test	dword ptr [ecx+0Ch], 1000h
		jz	short loc_10004331
		movsx	edx, al
		push	edx
		push	offset aCsupports_http ; "%cSUPPORTS_HTTP"
		call	sub_1000ED67
		add	esp, 8

loc_10004331:				; CODE XREF: .text:10004170j
					; .text:1000431Ej
		push	offset asc_100272D8 ; "\n"
		call	sub_1000ED67
		add	esp, 4
		pop	esi

locret_1000433F:			; CODE XREF: .text:10004139j
		retn
; Exported entry  31. sasl_client_plugin_info

; =============== S U B	R O U T	I N E =======================================


		public sasl_client_plugin_info
sasl_client_plugin_info	proc near	; DATA XREF: .rdata:off_1002C568o

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0Ch
		push	ebx
		mov	ebx, [esp+10h+arg_4]
		test	ebx, ebx
		jnz	short loc_10004351
		mov	ebx, offset loc_10004120

loc_10004351:				; CODE XREF: sasl_client_plugin_info+Aj
		cmp	dword_1002E408,	0
		jz	loc_10004460
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_8]
		push	edi
		push	0
		push	0
		call	ebx
		mov	eax, [esp+24h+arg_0]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100043C0
		mov	eax, dword_1002E408
		mov	esi, [eax+8]
		test	esi, esi
		jz	loc_1000444D

loc_10004386:				; CODE XREF: sasl_client_plugin_info+6Cj
		mov	ecx, [esi]
		mov	[esp+18h+var_C], ecx
		mov	edx, [esi+4]
		push	edi
		mov	[esp+1Ch+var_8], edx
		mov	eax, [esi+8]
		lea	ecx, [esp+1Ch+var_C]
		push	1
		push	ecx
		mov	[esp+24h+var_4], eax
		call	ebx
		mov	esi, [esi+0Ch]
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10004386
		push	edi
		push	2
		push	esi
		call	ebx
		add	esp, 0Ch
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100043C0:				; CODE XREF: sasl_client_plugin_info+34j
		push	ebp
		push	eax
		call	sub_1002449A
		add	esp, 4
		mov	[esp+1Ch+arg_4], eax
		mov	ebp, eax
		test	eax, eax
		jz	short loc_10004443

loc_100043D4:				; CODE XREF: sasl_client_plugin_info+F9j
		push	20h
		push	ebp
		call	sub_1000EF20
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_100043E9
		mov	byte ptr [edi],	0
		inc	edi

loc_100043E9:				; CODE XREF: sasl_client_plugin_info+A3j
		mov	edx, dword_1002E408
		mov	esi, [edx+8]
		test	esi, esi
		jz	short loc_10004435

loc_100043F6:				; CODE XREF: sasl_client_plugin_info+F3j
		mov	eax, [esi+8]
		mov	ecx, [eax]
		push	ecx
		push	ebp
		call	sub_10023E83
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000442E
		mov	edx, [esi]
		mov	[esp+1Ch+var_C], edx
		mov	eax, [esi+4]
		mov	edx, [esp+1Ch+arg_8]
		push	edx
		mov	[esp+20h+var_8], eax
		mov	ecx, [esi+8]
		lea	eax, [esp+20h+var_C]
		push	1
		push	eax
		mov	[esp+28h+var_4], ecx
		call	ebx
		add	esp, 0Ch

loc_1000442E:				; CODE XREF: sasl_client_plugin_info+C7j
		mov	esi, [esi+0Ch]
		test	esi, esi
		jnz	short loc_100043F6

loc_10004435:				; CODE XREF: sasl_client_plugin_info+B4j
		mov	ebp, edi
		test	edi, edi
		jnz	short loc_100043D4
		mov	edi, [esp+1Ch+arg_8]
		mov	eax, [esp+1Ch+arg_4]

loc_10004443:				; CODE XREF: sasl_client_plugin_info+92j
		push	eax		; lpMem
		call	sub_1000EE73
		add	esp, 4
		pop	ebp

loc_1000444D:				; CODE XREF: sasl_client_plugin_info+40j
		push	edi
		push	2
		push	0
		call	ebx
		add	esp, 0Ch
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10004460:				; CODE XREF: sasl_client_plugin_info+18j
		mov	eax, 0FFFFFFF4h
		pop	ebx
		add	esp, 0Ch
		retn
sasl_client_plugin_info	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  32. sasl_client_start

; =============== S U B	R O U T	I N E =======================================


		public sasl_client_start
sasl_client_start proc near		; DATA XREF: .rdata:off_1002C568o

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 20h
		push	ebx
		xor	ebx, ebx
		mov	[esp+24h+var_18], ebx
		mov	[esp+24h+var_20], ebx
		mov	[esp+24h+var_C], ebx
		mov	[esp+24h+var_14], ebx
		mov	[esp+24h+var_1C], ebx
		cmp	dword_1002E40C,	ebx
		jnz	short loc_1000449A
		lea	eax, [ebx-0Ch]
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1000449A:				; CODE XREF: sasl_client_start+20j
		push	edi
		mov	edi, [esp+28h+arg_0]
		cmp	edi, ebx
		jnz	short loc_100044AE
		pop	edi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100044AE:				; CODE XREF: sasl_client_start+31j
		mov	edx, [esp+28h+arg_4]
		cmp	edx, ebx
		jnz	short loc_100044DC
		push	2C5h
		push	offset aParameterErr_0 ; "Parameter error in client.c near line	%"...
		push	1
		push	edi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		mov	[edi+8F0h], eax
		pop	edi
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100044DC:				; CODE XREF: sasl_client_start+44j
		mov	ecx, [esp+28h+arg_8]
		push	ebp
		push	esi
		cmp	ecx, ebx
		jz	short loc_100044EE
		cmp	[ecx], ebx
		jnz	loc_10004819

loc_100044EE:				; CODE XREF: sasl_client_start+74j
		mov	eax, [edi+8B8h]
		mov	ecx, [edi+8D0h]
		cmp	eax, ecx
		jnb	short loc_10004504
		mov	[esp+30h+var_10], ebx
		jmp	short loc_1000450A
; ---------------------------------------------------------------------------

loc_10004504:				; CODE XREF: sasl_client_start+8Cj
		sub	eax, ecx
		mov	[esp+30h+var_10], eax

loc_1000450A:				; CODE XREF: sasl_client_start+92j
		mov	eax, [edi+1124h]
		lea	ecx, [esp+30h+var_14]
		push	ecx
		lea	ecx, [esp+34h+arg_0]
		push	ecx
		lea	ecx, [esp+38h+var_18]
		push	ecx
		xor	ecx, ecx
		cmp	[eax+50h], ebx
		setnz	cl
		push	ecx
		push	edx
		mov	edx, [eax+0Ch]
		push	edx
		call	sub_10003A80
		mov	esi, eax
		add	esp, 18h
		cmp	esi, ebx
		jnz	loc_1000483D
		mov	eax, [esp+30h+var_14]
		mov	edx, [esp+30h+arg_0]
		push	eax
		mov	ecx, 1
		cmp	ecx, edx
		sbb	eax, eax
		neg	eax
		push	eax
		mov	eax, [edi+1124h]
		lea	ecx, [esp+38h+var_14]
		call	sub_10003BF0
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebx
		jnz	loc_1000483D
		mov	ebp, [esp+30h+var_18]
		mov	[esp+30h+arg_0], ebp
		cmp	edx, ebx
		jbe	loc_100046F5
		mov	[esp+30h+var_8], edx
		jmp	short loc_1000458A
; ---------------------------------------------------------------------------

loc_10004586:				; CODE XREF: sasl_client_start+275j
		mov	ebp, [esp+30h+arg_0]

loc_1000458A:				; CODE XREF: sasl_client_start+114j
		mov	eax, ebp
		lea	edx, [eax+1]
		nop

loc_10004590:				; CODE XREF: sasl_client_start+125j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10004590
		mov	esi, [edi+112Ch]
		sub	eax, edx
		mov	ebx, eax
		test	esi, esi
		jz	loc_100046C5
		lea	esp, [esp+0]

loc_100045B0:				; CODE XREF: sasl_client_start+15Ej
		mov	edx, [esi+8]
		mov	eax, [edx]
		lea	ecx, [esp+30h+var_4]
		push	ecx
		push	ebx
		push	eax
		push	ebp
		call	sub_10005BC0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_100045D5
		mov	esi, [esi+0Ch]
		test	esi, esi
		jnz	short loc_100045B0
		jmp	loc_100046C5
; ---------------------------------------------------------------------------

loc_100045D5:				; CODE XREF: sasl_client_start+157j
		mov	eax, [esi+8]
		call	sub_10003A00
		test	eax, eax
		jz	loc_100046C5
		mov	ebx, [esi+8]
		mov	ebp, [ebx+4]
		cmp	[esp+30h+var_10], ebp
		ja	loc_100046C1
		mov	ecx, [edi+8D0h]
		mov	eax, [edi+8C4h]
		cmp	[edi+8B8h], ecx
		ja	short loc_10004611
		cmp	ecx, 1
		jbe	short loc_10004611
		and	eax, 0FFFFFFFEh

loc_10004611:				; CODE XREF: sasl_client_start+197j
					; sasl_client_start+19Cj
		mov	edx, [ebx+8]
		mov	ecx, edx
		xor	ecx, eax
		test	eax, ecx
		jnz	loc_100046C1
		cmp	[esp+30h+var_14], 2
		jnz	short loc_10004634
		test	dword ptr [ebx+0Ch], 800h
		jz	loc_100046C1

loc_10004634:				; CODE XREF: sasl_client_start+1B5j
		mov	ecx, [ebx+0Ch]
		test	cl, 1
		jz	short loc_10004645
		cmp	dword ptr [edi+8E8h], 0
		jz	short loc_100046C1

loc_10004645:				; CODE XREF: sasl_client_start+1CAj
		mov	eax, [edi+0Ch]
		test	al, 8
		jz	short loc_10004651
		test	cl, 20h
		jz	short loc_100046C1

loc_10004651:				; CODE XREF: sasl_client_start+1DAj
		test	al, 10h
		jz	short loc_1000465D
		test	ecx, 1000h
		jz	short loc_100046C1

loc_1000465D:				; CODE XREF: sasl_client_start+1E3j
		mov	ecx, [esp+30h+var_20]
		test	ecx, ecx
		jz	short loc_10004677
		mov	eax, [ecx+8]
		mov	eax, [eax+8]
		mov	ecx, eax
		xor	ecx, edx
		test	eax, ecx
		jnz	short loc_100046C1
		mov	ecx, [esp+30h+var_20]

loc_10004677:				; CODE XREF: sasl_client_start+1F3j
		mov	edx, [edi+1124h]
		cmp	dword ptr [edx+50h], 0
		jz	short loc_1000468F
		cmp	[esp+30h+var_4], 0
		mov	eax, 2
		jnz	short loc_10004693

loc_1000468F:				; CODE XREF: sasl_client_start+211j
		mov	eax, [esp+30h+var_14]

loc_10004693:				; CODE XREF: sasl_client_start+21Dj
		test	ecx, ecx
		jz	short loc_100046A3
		cmp	[esp+30h+var_1C], eax
		jg	short loc_100046C1
		cmp	ebp, [esp+30h+var_C]
		jbe	short loc_100046C1

loc_100046A3:				; CODE XREF: sasl_client_start+225j
		mov	ecx, [esp+30h+arg_14]
		test	ecx, ecx
		jz	short loc_100046AF
		mov	edx, [ebx]
		mov	[ecx], edx

loc_100046AF:				; CODE XREF: sasl_client_start+239j
		mov	[esp+30h+var_1C], eax
		mov	eax, [esi+8]
		mov	ecx, [eax+4]
		mov	[esp+30h+var_C], ecx
		mov	[esp+30h+var_20], esi

loc_100046C1:				; CODE XREF: sasl_client_start+17Fj
					; sasl_client_start+1AAj ...
		mov	ebp, [esp+30h+arg_0]

loc_100046C5:				; CODE XREF: sasl_client_start+133j
					; sasl_client_start+160j ...
		mov	eax, ebp
		lea	edx, [eax+1]
		lea	ebx, [ebx+0]

loc_100046D0:				; CODE XREF: sasl_client_start+265j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100046D0
		sub	eax, edx
		dec	[esp+30h+var_8]
		lea	edx, [eax+ebp+1]
		mov	[esp+30h+arg_0], edx
		jnz	loc_10004586
		mov	esi, [esp+30h+var_20]
		test	esi, esi
		jnz	short loc_1000470E
		xor	ebx, ebx

loc_100046F5:				; CODE XREF: sasl_client_start+10Aj
		push	offset aNoWorthyMechsF ; "No worthy mechs found"
		push	ebx
		push	edi
		call	sasl_seterror
		add	esp, 0Ch
		mov	esi, 0FFFFFFFCh
		jmp	loc_1000483D
; ---------------------------------------------------------------------------

loc_1000470E:				; CODE XREF: sasl_client_start+281j
		mov	eax, [edi+1124h]
		mov	ecx, [edi+8]
		mov	[eax], ecx
		mov	eax, [edi+8]
		lea	edx, [eax+1]
		nop

loc_10004720:				; CODE XREF: sasl_client_start+2B5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10004720
		sub	eax, edx
		mov	edx, [edi+1124h]
		mov	[edx+1Ch], eax
		mov	eax, [edi+8E8h]
		test	eax, eax
		jz	short loc_10004762
		mov	ecx, [edi+1124h]
		mov	[ecx+4], eax
		mov	eax, [edi+8E8h]
		lea	edx, [eax+1]
		mov	edi, edi

loc_10004750:				; CODE XREF: sasl_client_start+2E5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10004750
		sub	eax, edx
		mov	edx, [edi+1124h]
		mov	[edx+20h], eax

loc_10004762:				; CODE XREF: sasl_client_start+2CAj
		mov	eax, [edi+1124h]
		mov	ecx, [edi+1128h]
		mov	[eax+8], ecx
		mov	eax, [edi+1128h]
		lea	edx, [eax+1]
		lea	ebx, [ebx+0]

loc_10004780:				; CODE XREF: sasl_client_start+315j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10004780
		sub	eax, edx
		mov	edx, [edi+1124h]
		mov	[edx+24h], eax
		mov	eax, [edi+1124h]
		mov	ecx, [edi+8D0h]
		mov	[eax+48h], ecx
		mov	eax, [edi+1124h]
		mov	edx, [edi+8B8h]
		mov	[eax+30h], edx
		mov	ecx, [edi+8BCh]
		mov	[eax+34h], ecx
		mov	edx, [edi+8C0h]
		mov	[eax+38h], edx
		mov	ecx, [edi+8C4h]
		mov	[eax+3Ch], ecx
		mov	edx, [edi+8C8h]
		mov	[eax+40h], edx
		mov	ecx, [edi+8CCh]
		mov	[eax+44h], ecx
		mov	edx, [edi+1124h]
		mov	eax, [esp+30h+var_1C]
		mov	[edx+64h], eax
		mov	edx, [edi+1124h]
		mov	[edi+1120h], esi
		mov	eax, [esi+8]
		lea	ecx, [edi+85Ch]
		push	ecx
		mov	ecx, [eax+14h]
		push	edx
		mov	edx, [eax+18h]
		push	ecx
		call	edx
		mov	esi, eax
		add	esp, 0Ch
		xor	ebx, ebx
		test	esi, esi
		jnz	short loc_1000483D
		mov	ecx, [esp+30h+arg_8]

loc_10004819:				; CODE XREF: sasl_client_start+78j
		mov	eax, [esp+30h+arg_C]
		cmp	eax, ebx
		jz	short loc_10004838
		mov	edx, [edi+1120h]
		mov	edx, [edx+8]
		test	byte ptr [edx+0Ch], 10h
		jz	short loc_1000486B
		mov	[eax], ebx
		mov	eax, [esp+30h+arg_10]
		mov	[eax], ebx

loc_10004838:				; CODE XREF: sasl_client_start+3AFj
		mov	esi, 1

loc_1000483D:				; CODE XREF: sasl_client_start+C9j
					; sasl_client_start+FAj ...
		mov	eax, [esp+30h+var_18]
		cmp	eax, ebx
		jz	short loc_10004857
		mov	ecx, [edi+1124h]
		mov	edx, [ecx+0Ch]
		push	eax
		mov	eax, [edx+20h]
		call	eax
		add	esp, 4

loc_10004857:				; CODE XREF: sasl_client_start+3D3j
		cmp	esi, ebx
		jge	short loc_10004861
		mov	[edi+8F0h], esi

loc_10004861:				; CODE XREF: sasl_client_start+3E9j
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1000486B:				; CODE XREF: sasl_client_start+3BEj
		mov	edx, [esp+30h+arg_10]
		push	edx
		push	eax
		push	ecx
		push	ebx
		push	ebx
		push	edi
		call	sasl_client_step
		add	esp, 18h
		mov	esi, eax
		jmp	short loc_1000483D
sasl_client_start endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004890	proc near		; CODE XREF: sub_10007860+60p
					; DATA XREF: .data:off_1002D06Co
		mov	eax, 1
		retn
sub_10004890	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100048A0	proc near		; CODE XREF: sasl_dispose+14p
					; DATA XREF: .data:off_1002D070o
		xor	eax, eax
		retn
sub_100048A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100048B0	proc near		; CODE XREF: sasl_dispose+49j
					; DATA XREF: .data:off_1002D074o
		xor	eax, eax
		retn
sub_100048B0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000001 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h
; Exported entry  63. sasl_set_mutex

; =============== S U B	R O U T	I N E =======================================


		public sasl_set_mutex
sasl_set_mutex	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	dword_1002E4A0,	0
		jnz	short locret_10004908
		cmp	dword_1002E49C,	0
		jnz	short locret_10004908
		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_8]
		mov	off_1002D06C, eax
		mov	eax, [esp+arg_C]
		mov	off_1002D070, ecx
		mov	off_1002D074, edx
		mov	off_1002D078, eax

locret_10004908:			; CODE XREF: sasl_set_mutex+7j
					; sasl_set_mutex+10j
		retn
sasl_set_mutex	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004910	proc near		; CODE XREF: sub_100019F0+EDp
					; sasl_auxprop_store+107p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, esi
		lea	edx, [eax+1]
		lea	ebx, [ebx+0]

loc_10004920:				; CODE XREF: sub_10004910+15j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10004920
		mov	ecx, [esp+4+arg_8]
		sub	eax, edx
		test	ecx, ecx
		jz	short loc_10004933
		mov	[ecx], eax

loc_10004933:				; CODE XREF: sub_10004910+1Fj
		inc	eax
		push	eax
		call	off_1002D044
		mov	ecx, [esp+8+arg_4]
		add	esp, 4
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_1000494F
		mov	eax, 0FFFFFFFEh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000494F:				; CODE XREF: sub_10004910+36j
		mov	ecx, esi
		mov	edx, eax

loc_10004953:				; CODE XREF: sub_10004910+4Bj
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_10004953
		xor	eax, eax
		pop	esi
		retn
sub_10004910	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  71. sasl_version

; =============== S U B	R O U T	I N E =======================================


		public sasl_version
sasl_version	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_10004980
		mov	ecx, off_1002D040
		mov	[eax], ecx

loc_10004980:				; CODE XREF: sasl_version+6j
		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short locret_1000498E
		mov	dword ptr [eax], 2010019h

locret_1000498E:			; CODE XREF: sasl_version+16j
		retn
sasl_version	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  72. sasl_version_info

; =============== S U B	R O U T	I N E =======================================


		public sasl_version_info
sasl_version_info proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_100049A0
		mov	ecx, off_1002D040
		mov	[eax], ecx

loc_100049A0:				; CODE XREF: sasl_version_info+6j
		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_100049AE
		mov	dword ptr [eax], offset	a2_1_25	; "2.1.25"

loc_100049AE:				; CODE XREF: sasl_version_info+16j
		mov	eax, [esp+arg_8]
		test	eax, eax
		jz	short loc_100049BC
		mov	dword ptr [eax], 2

loc_100049BC:				; CODE XREF: sasl_version_info+24j
		mov	eax, [esp+arg_C]
		test	eax, eax
		jz	short loc_100049CA
		mov	dword ptr [eax], 1

loc_100049CA:				; CODE XREF: sasl_version_info+32j
		mov	eax, [esp+arg_10]
		test	eax, eax
		jz	short loc_100049D8
		mov	dword ptr [eax], 19h

loc_100049D8:				; CODE XREF: sasl_version_info+40j
		mov	eax, [esp+arg_14]
		test	eax, eax
		jz	short locret_100049E6
		mov	dword ptr [eax], 0

locret_100049E6:			; CODE XREF: sasl_version_info+4Ej
		retn
sasl_version_info endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100049F0	proc near		; CODE XREF: sasl_encodev+1BCp
					; sasl_encodev+23Fp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebp
		mov	ebp, [esp+4+arg_8]
		cmp	dword ptr [ebp+0], 1
		jnz	loc_10004A9C
		mov	ecx, [esi+1114h]
		mov	eax, [edi]
		mov	[esi+1118h], eax
		test	ecx, ecx
		jnz	short loc_10004A53
		add	eax, 1000h
		mov	[esi+111Ch], eax
		inc	eax
		push	eax
		call	off_1002D044
		add	esp, 4
		mov	[esi+1114h], eax
		test	eax, eax
		jnz	short loc_10004A83
		push	151h

loc_10004A36:				; CODE XREF: sub_100049F0+8Bj
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFFEh
		mov	[esi+8F0h], eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10004A53:				; CODE XREF: sub_100049F0+1Fj
		cmp	eax, [esi+111Ch]
		jbe	short loc_10004A83
		add	eax, 1000h
		mov	[esi+111Ch], eax
		inc	eax
		push	eax		; dwBytes
		push	ecx		; lpMem
		call	off_1002D04C
		add	esp, 8
		test	eax, eax
		jnz	short loc_10004A7D
		push	15Eh
		jmp	short loc_10004A36
; ---------------------------------------------------------------------------

loc_10004A7D:				; CODE XREF: sub_100049F0+84j
		mov	[esi+1114h], eax

loc_10004A83:				; CODE XREF: sub_100049F0+3Fj
					; sub_100049F0+69j
		mov	eax, [edi]
		mov	ecx, [esp+4+arg_C]
		mov	edx, [ecx]
		push	eax
		mov	eax, [esi+1114h]
		push	edx
		push	eax
		call	sub_1000E2B0
		add	esp, 0Ch

loc_10004A9C:				; CODE XREF: sub_100049F0+9j
		mov	ecx, [esp+4+arg_C]
		mov	edx, [esp+4+arg_4]
		mov	eax, [esp+4+arg_0]
		push	ebx
		push	edi
		push	ecx
		mov	ecx, [esi+85Ch]
		push	edx
		mov	edx, [esi+880h]
		push	eax
		push	ecx
		call	edx
		add	esp, 14h
		cmp	dword ptr [ebp+0], 0
		mov	ebx, eax
		jle	loc_10004B62
		test	ebx, ebx
		jnz	loc_10004B62
		mov	eax, [esi+1118h]
		add	eax, [edi]
		cmp	eax, [esi+111Ch]
		jbe	short loc_10004B27
		mov	edx, [esi+1114h]
		mov	[esi+111Ch], eax
		inc	eax
		push	eax		; dwBytes
		push	edx		; lpMem
		call	off_1002D04C
		add	esp, 8
		test	eax, eax
		jnz	short loc_10004B21
		push	178h
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	eax
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFFEh
		pop	ebx
		mov	[esi+8F0h], eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10004B21:				; CODE XREF: sub_100049F0+10Dj
		mov	[esi+1114h], eax

loc_10004B27:				; CODE XREF: sub_100049F0+F1j
		mov	eax, [edi]
		mov	ecx, [esp+8+arg_C]
		mov	edx, [ecx]
		push	eax
		mov	eax, [esi+1118h]
		add	eax, [esi+1114h]
		push	edx
		push	eax
		call	sub_1000E2B0
		mov	ecx, [edi]
		mov	edx, [esi+1114h]
		mov	eax, [esp+14h+arg_C]
		add	esp, 0Ch
		add	[esi+1118h], ecx
		mov	[eax], edx
		mov	ecx, [esi+1118h]
		mov	[edi], ecx

loc_10004B62:				; CODE XREF: sub_100049F0+D5j
					; sub_100049F0+DDj
		inc	dword ptr [ebp+0]
		test	ebx, ebx
		jns	short loc_10004B6F
		mov	[esi+8F0h], ebx

loc_10004B6F:				; CODE XREF: sub_100049F0+177j
		mov	eax, ebx
		pop	ebx
		pop	ebp
		retn
sub_100049F0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  35. sasl_decode

; =============== S U B	R O U T	I N E =======================================


		public sasl_decode
sasl_decode	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_10004B8E
		lea	eax, [esi-7]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004B8E:				; CODE XREF: sasl_decode+7j
		mov	edx, [esp+4+arg_4]
		push	ebx
		push	ebp
		test	edx, edx
		jz	loc_10004CB7
		mov	ebp, [esp+0Ch+arg_C]
		test	ebp, ebp
		jz	loc_10004CB7
		mov	ebx, [esp+0Ch+arg_10]
		test	ebx, ebx
		jz	loc_10004CB7
		mov	ecx, [esi+8C0h]
		test	ecx, ecx
		jnz	short loc_10004BDC
		push	offset aCalledSasl_dec ; "called sasl_decode with application tha"...
		push	ecx
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		pop	ebp
		mov	eax, 0FFFFFFF1h
		pop	ebx
		mov	[esi+8F0h], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004BDC:				; CODE XREF: sasl_decode+3Cj
		mov	eax, [esi+888h]
		test	eax, eax
		jnz	loc_10004C85
		push	edi
		mov	edi, [esp+10h+arg_8]
		cmp	edi, ecx
		jbe	short loc_10004C12
		push	offset aInputTooLargeF ; "input	too large for default sasl_decode"
		push	eax
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	eax, 0FFFFFFFDh
		mov	[esi+8F0h], eax
		pop	edi

loc_10004C0E:				; CODE XREF: sasl_decode+127j
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004C12:				; CODE XREF: sasl_decode+71j
		cmp	dword ptr [esi+90Ch], 0
		jnz	short loc_10004C30
		inc	ecx
		push	ecx
		call	off_1002D044
		mov	edx, [esp+14h+arg_4]
		add	esp, 4
		mov	[esi+90Ch], eax

loc_10004C30:				; CODE XREF: sasl_decode+99j
		mov	eax, [esi+90Ch]
		test	eax, eax
		jnz	short loc_10004C5E
		push	27Ah
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	eax
		push	esi
		call	sasl_seterror
		add	esp, 10h
		pop	edi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		mov	[esi+8F0h], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004C5E:				; CODE XREF: sasl_decode+B8j
		push	edi
		push	edx
		push	eax
		call	sub_1000E2B0
		mov	eax, [esi+90Ch]
		mov	byte ptr [edi+eax], 0
		mov	ecx, [esi+90Ch]
		add	esp, 0Ch
		mov	[ebp+0], ecx
		mov	[ebx], edi
		pop	edi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004C85:				; CODE XREF: sasl_decode+64j
		mov	ecx, [esp+0Ch+arg_8]
		push	ebx
		push	ebp
		push	ecx
		push	edx
		mov	edx, [esi+85Ch]
		push	edx
		call	eax
		add	esp, 14h
		cmp	dword ptr [ebx], 0
		jnz	short loc_10004CA5
		mov	dword ptr [ebp+0], 0

loc_10004CA5:				; CODE XREF: sasl_decode+11Cj
		test	eax, eax
		jns	loc_10004C0E
		pop	ebp
		pop	ebx
		mov	[esi+8F0h], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10004CB7:				; CODE XREF: sasl_decode+16j
					; sasl_decode+22j ...
		push	261h
		push	offset aParameterErr_1 ; "Parameter error in common.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		pop	ebp
		mov	eax, 0FFFFFFF9h
		pop	ebx
		mov	[esi+8F0h], eax
		pop	esi
		retn
sasl_decode	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  62. sasl_set_alloc

; =============== S U B	R O U T	I N E =======================================


		public sasl_set_alloc
sasl_set_alloc	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, dword_1002E4AC
		mov	ecx, eax
		inc	eax
		mov	dword_1002E4AC,	eax
		test	ecx, ecx
		jnz	short locret_10004D18
		mov	edx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_8]
		mov	off_1002D044, edx
		mov	edx, [esp+arg_C]
		mov	off_1002D048, eax
		mov	off_1002D04C, ecx
		mov	off_1002D050, edx

locret_10004D18:			; CODE XREF: sasl_set_alloc+Fj
		retn
sasl_set_alloc	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  37. sasl_dispose

; =============== S U B	R O U T	I N E =======================================


		public sasl_dispose
sasl_dispose	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_10004D6F
		cmp	dword ptr [esi], 0
		jz	short loc_10004D6F
		mov	eax, dword_1002E498
		push	eax
		call	off_1002D070
		add	esp, 4
		test	eax, eax
		jnz	short loc_10004D6F
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10004D6F
		mov	ecx, [eax+4]
		push	eax
		call	ecx
		mov	edx, [esi]
		push	edx		; lpMem
		call	off_1002D050
		add	esp, 8
		mov	dword ptr [esi], 0
		mov	eax, dword_1002E498
		pop	esi
		mov	[esp+arg_0], eax
		jmp	off_1002D074
; ---------------------------------------------------------------------------

loc_10004D6F:				; CODE XREF: sasl_dispose+7j
					; sasl_dispose+Cj ...
		pop	esi
		retn
sasl_dispose	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004D80	proc near		; CODE XREF: .text:10003607p
					; sasl_client_new+2D4p	...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+8E8h]
		test	eax, eax
		jz	short loc_10004D99
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004D99:				; CODE XREF: sub_10004D80+Dj
		mov	eax, [esi+8D4h]
		test	eax, eax
		jz	short loc_10004DAD
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004DAD:				; CODE XREF: sub_10004D80+21j
		mov	eax, [esi+8ECh]
		test	eax, eax
		jz	short loc_10004DD8
		cmp	dword ptr [eax], 0
		jz	short loc_10004DC8
		mov	eax, [eax]
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004DC8:				; CODE XREF: sub_10004D80+3Aj
		mov	ecx, [esi+8ECh]
		push	ecx		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004DD8:				; CODE XREF: sub_10004D80+35j
		mov	eax, [esi+8F4h]
		test	eax, eax
		jz	short loc_10004DEC
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004DEC:				; CODE XREF: sub_10004D80+60j
		mov	eax, [esi+8F8h]
		test	eax, eax
		jz	short loc_10004E00
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004E00:				; CODE XREF: sub_10004D80+74j
		mov	eax, [esi+90Ch]
		test	eax, eax
		jz	short loc_10004E14
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004E14:				; CODE XREF: sub_10004D80+88j
		mov	eax, [esi+904h]
		test	eax, eax
		jz	short loc_10004E28
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004E28:				; CODE XREF: sub_10004D80+9Cj
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_10004E39
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004E39:				; CODE XREF: sub_10004D80+ADj
		mov	esi, [esi+1114h]
		test	esi, esi
		jz	short loc_10004E4D
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10004E4D:				; CODE XREF: sub_10004D80+C1j
		pop	esi
		retn
sub_10004D80	endp

; ---------------------------------------------------------------------------
		align 10h
		cmp	eax, 0FFFFFFECh
		jnz	short locret_10004E5A
		mov	eax, 0FFFFFFF3h

locret_10004E5A:			; CODE XREF: .text:10004E53j
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  44. sasl_errstring

; =============== S U B	R O U T	I N E =======================================


		public sasl_errstring
sasl_errstring	proc near		; CODE XREF: sasl_auxprop_add_plugin+39p
					; sasl_errdetail+43p ...

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		test	eax, eax
		jz	short loc_10004E6E
		mov	dword ptr [eax], offset	aEnUs ;	"en-us"

loc_10004E6E:				; CODE XREF: sasl_errstring+6j
		mov	eax, [esp+arg_0]
		add	eax, 20h	; switch 35 cases
		cmp	eax, 22h
		ja	loc_10004F4B	; jumptable 10004E7E default case
		jmp	ds:off_10004F54[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10004E85:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aAnotherStepIsN ; jumptable	10004E7E case 1
		retn
; ---------------------------------------------------------------------------

loc_10004E8B:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aSuccessfulResu ; jumptable	10004E7E case 0
		retn
; ---------------------------------------------------------------------------

loc_10004E91:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aGenericFailure ; jumptable	10004E7E case -1
		retn
; ---------------------------------------------------------------------------

loc_10004E97:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aNoMemoryAvaila ; jumptable	10004E7E case -2
		retn
; ---------------------------------------------------------------------------

loc_10004E9D:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aOverflowedBuff ; jumptable	10004E7E case -3
		retn
; ---------------------------------------------------------------------------

loc_10004EA3:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aNoMechanismAva ; jumptable	10004E7E case -4
		retn
; ---------------------------------------------------------------------------

loc_10004EA9:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aBadProtocolCan ; jumptable	10004E7E case -5
		retn
; ---------------------------------------------------------------------------

loc_10004EAF:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aCanTRequestInf ; jumptable	10004E7E case -6
		retn
; ---------------------------------------------------------------------------

loc_10004EB5:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aInvalidParamet ; jumptable	10004E7E case -7
		retn
; ---------------------------------------------------------------------------

loc_10004EBB:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aTransientFailu ; jumptable	10004E7E case -8
		retn
; ---------------------------------------------------------------------------

loc_10004EC1:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aIntegrityCheck ; jumptable	10004E7E case -9
		retn
; ---------------------------------------------------------------------------

loc_10004EC7:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aSaslLibraryIsN ; jumptable	10004E7E case -12
		retn
; ---------------------------------------------------------------------------

loc_10004ECD:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aNeedsUserInter ; jumptable	10004E7E case 2
		retn
; ---------------------------------------------------------------------------

loc_10004ED3:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aServerFailedMu ; jumptable	10004E7E case -10
		retn
; ---------------------------------------------------------------------------

loc_10004ED9:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aMechanismDoesn ; jumptable	10004E7E case -11
		retn
; ---------------------------------------------------------------------------

loc_10004EDF:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aAuthentication ; jumptable	10004E7E case -13
		retn
; ---------------------------------------------------------------------------

loc_10004EE5:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aAuthorizationF ; jumptable	10004E7E case -14
		retn
; ---------------------------------------------------------------------------

loc_10004EEB:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aMechanismTooWe ; jumptable	10004E7E case -15
		retn
; ---------------------------------------------------------------------------

loc_10004EF1:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aEncryptionNeed ; jumptable	10004E7E case -16
		retn
; ---------------------------------------------------------------------------

loc_10004EF7:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aOneTimeUseOfAP ; jumptable	10004E7E case -17
		retn
; ---------------------------------------------------------------------------

loc_10004EFD:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aPassphraseExpi ; jumptable	10004E7E case -18
		retn
; ---------------------------------------------------------------------------

loc_10004F03:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aAccountDisable ; jumptable	10004E7E case -19
		retn
; ---------------------------------------------------------------------------

loc_10004F09:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aUserNotFound ; jumptable 10004E7E case -20
		retn
; ---------------------------------------------------------------------------

loc_10004F0F:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aVersionMismatc ; jumptable	10004E7E case -23
		retn
; ---------------------------------------------------------------------------

loc_10004F15:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aRemoteAuthenti ; jumptable	10004E7E case -24
		retn
; ---------------------------------------------------------------------------

loc_10004F1B:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aUserExistsButN ; jumptable	10004E7E case -26
		retn
; ---------------------------------------------------------------------------

loc_10004F21:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aPassphraseLock ; jumptable	10004E7E case -21
		retn
; ---------------------------------------------------------------------------

loc_10004F27:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aRequestedChang ; jumptable	10004E7E case -22
		retn
; ---------------------------------------------------------------------------

loc_10004F2D:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aPassphraseIsTo ; jumptable	10004E7E case -27
		retn
; ---------------------------------------------------------------------------

loc_10004F33:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aUserSuppliedPa ; jumptable	10004E7E case -28
		retn
; ---------------------------------------------------------------------------

loc_10004F39:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aSasl_setpassNe ; jumptable	10004E7E case -29
		retn
; ---------------------------------------------------------------------------

loc_10004F3F:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aSasl_setpassCa ; jumptable	10004E7E case -30
		retn
; ---------------------------------------------------------------------------

loc_10004F45:				; CODE XREF: sasl_errstring+1Ej
					; DATA XREF: .text:off_10004F54o
		mov	eax, offset aChannelBinding ; jumptable	10004E7E case -32
		retn
; ---------------------------------------------------------------------------

loc_10004F4B:				; CODE XREF: sasl_errstring+18j
					; sasl_errstring+1Ej
					; DATA XREF: ...
		mov	eax, offset aUndefinedError ; jumptable	10004E7E default case
		retn
sasl_errstring	endp

; ---------------------------------------------------------------------------
		align 4
off_10004F54	dd offset loc_10004F45	; DATA XREF: sasl_errstring+1Er
		dd offset loc_10004F4B	; jump table for switch	statement
		dd offset loc_10004F3F
		dd offset loc_10004F39
		dd offset loc_10004F33
		dd offset loc_10004F2D
		dd offset loc_10004F1B
		dd offset loc_10004F4B
		dd offset loc_10004F15
		dd offset loc_10004F0F
		dd offset loc_10004F27
		dd offset loc_10004F21
		dd offset loc_10004F09
		dd offset loc_10004F03
		dd offset loc_10004EFD
		dd offset loc_10004EF7
		dd offset loc_10004EF1
		dd offset loc_10004EEB
		dd offset loc_10004EE5
		dd offset loc_10004EDF
		dd offset loc_10004EC7
		dd offset loc_10004ED9
		dd offset loc_10004ED3
		dd offset loc_10004EC1
		dd offset loc_10004EBB
		dd offset loc_10004EB5
		dd offset loc_10004EAF
		dd offset loc_10004EA9
		dd offset loc_10004EA3
		dd offset loc_10004E9D
		dd offset loc_10004E97
		dd offset loc_10004E91
		dd offset loc_10004E8B
		dd offset loc_10004E85
		dd offset loc_10004ECD
; ---------------------------------------------------------------------------

loc_10004FE0:				; DATA XREF: sub_10005310:loc_10005471o
					; sub_10007350+45o ...
		mov	eax, [esp+4]
		push	ebx
		mov	ebx, [esp+14h]
		push	ebp
		mov	ebp, [esp+14h]
		push	esi
		push	edi
		test	eax, eax
		jz	short loc_1000502F
		mov	esi, [eax]
		test	esi, esi
		jz	short loc_1000502F
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1000502F
		mov	edi, [esp+18h]

loc_10005004:				; CODE XREF: .text:1000502Dj
		cmp	eax, 1
		jnz	short loc_10005025
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_10005062
		mov	ecx, [esp+24h]
		mov	edx, [esi+8]
		push	ecx
		push	ebx
		push	ebp
		push	edi
		push	edx
		call	eax
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000505B

loc_10005025:				; CODE XREF: .text:10005007j
		mov	eax, [esi+0Ch]
		add	esi, 0Ch
		test	eax, eax
		jnz	short loc_10005004

loc_1000502F:				; CODE XREF: .text:10004FF2j
					; .text:10004FF8j ...
		push	0
		push	ebp
		call	sub_10007B30
		add	esp, 8
		mov	[ebx], eax
		test	eax, eax
		jz	short loc_10005062
		mov	esi, [esp+24h]
		test	esi, esi
		jz	short loc_1000505B
		lea	edx, [eax+1]
		jmp	short loc_10005050
; ---------------------------------------------------------------------------
		align 10h

loc_10005050:				; CODE XREF: .text:1000504Bj
					; .text:10005055j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10005050
		sub	eax, edx
		mov	[esi], eax

loc_1000505B:				; CODE XREF: .text:10005023j
					; .text:10005046j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10005062:				; CODE XREF: .text:1000500Ej
					; .text:1000503Ej
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005070	proc near		; DATA XREF: sub_10005310+153o
					; sub_10007350+35o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebp
		mov	ebp, [esp+4+arg_0]
		test	ebp, ebp
		jnz	short loc_1000507E
		lea	eax, [ebp-7]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000507E:				; CODE XREF: sub_10005070+7j
		push	ebx
		mov	ebx, [esp+8+arg_8]
		push	esi
		mov	esi, [ebp+8E0h]
		push	edi
		mov	edi, [esp+10h+arg_C]
		test	esi, esi
		jz	short loc_100050CB
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_100050CB
		lea	esp, [esp+0]

loc_100050A0:				; CODE XREF: sub_10005070+59j
		cmp	eax, 1
		jnz	short loc_100050C1
		mov	eax, [esp+10h+arg_10]
		mov	ecx, [esp+10h+arg_4]
		mov	edx, [esi+8]
		push	eax
		mov	eax, [esi+4]
		push	edi
		push	ebx
		push	ecx
		push	edx
		call	eax
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000513B

loc_100050C1:				; CODE XREF: sub_10005070+33j
		mov	eax, [esi+0Ch]
		add	esi, 0Ch
		test	eax, eax
		jnz	short loc_100050A0

loc_100050CB:				; CODE XREF: sub_10005070+21j
					; sub_10005070+27j
		mov	eax, [ebp+8E4h]
		test	eax, eax
		jz	short loc_10005110
		mov	esi, [eax]
		test	esi, esi
		jz	short loc_10005110
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10005110

loc_100050E1:				; CODE XREF: sub_10005070+9Ej
		cmp	eax, 1
		jnz	short loc_10005106
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_10005142
		mov	ecx, [esp+10h+arg_10]
		mov	edx, [esp+10h+arg_4]
		push	ecx
		mov	ecx, [esi+8]
		push	edi
		push	ebx
		push	edx
		push	ecx
		call	eax
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000513B

loc_10005106:				; CODE XREF: sub_10005070+74j
		mov	eax, [esi+0Ch]
		add	esi, 0Ch
		test	eax, eax
		jnz	short loc_100050E1

loc_10005110:				; CODE XREF: sub_10005070+63j
					; sub_10005070+69j ...
		push	0
		push	ebx
		call	sub_10007B30
		add	esp, 8
		mov	[edi], eax
		test	eax, eax
		jz	short loc_10005142
		mov	esi, [esp+10h+arg_10]
		test	esi, esi
		jz	short loc_1000513B
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_10005130:				; CODE XREF: sub_10005070+C5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10005130
		sub	eax, edx
		mov	[esi], eax

loc_1000513B:				; CODE XREF: sub_10005070+4Fj
					; sub_10005070+94j ...
		pop	edi
		pop	esi
		pop	ebx
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10005142:				; CODE XREF: sub_10005070+7Bj
					; sub_10005070+AFj
		pop	edi
		pop	esi
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
sub_10005070	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10005150:				; DATA XREF: sub_10005310:loc_1000544Do
		cmp	dword ptr [esp+4], 0
		push	esi
		jz	loc_10005216
		mov	esi, [esp+10h]
		test	esi, esi
		jz	loc_10005216
		cmp	dword ptr [esp+0Ch], 4002h
		jnz	loc_10005216
		push	offset aUser	; "USER"
		call	sub_1000F863
		add	esp, 4
		test	eax, eax
		jz	short loc_100051A3
		mov	[esi], eax
		mov	esi, [esp+14h]
		test	esi, esi
		jz	short loc_1000519F
		lea	edx, [eax+1]

loc_10005194:				; CODE XREF: .text:10005199j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10005194
		sub	eax, edx
		mov	[esi], eax

loc_1000519F:				; CODE XREF: .text:1000518Fj
					; .text:100051BCj ...
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100051A3:				; CODE XREF: .text:10005185j
		push	offset aUsername ; "USERNAME"
		call	sub_1000F863
		add	esp, 4
		test	eax, eax
		jz	short loc_100051D0
		mov	[esi], eax
		mov	esi, [esp+14h]
		test	esi, esi
		jz	short loc_1000519F
		lea	edx, [eax+1]

loc_100051C1:				; CODE XREF: .text:100051C6j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100051C1
		sub	eax, edx
		mov	[esi], eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100051D0:				; CODE XREF: .text:100051B2j
		lea	eax, [esp+8]
		push	eax
		push	offset dword_1002E410
		mov	dword ptr [esp+10h], 80h
		call	ds:GetUserNameA
		test	eax, eax
		jz	short loc_10005211
		mov	dword ptr [esi], offset	dword_1002E410
		mov	esi, [esp+14h]
		test	esi, esi
		jz	short loc_1000519F
		mov	eax, offset dword_1002E410
		lea	edx, [eax+1]

loc_10005202:				; CODE XREF: .text:10005207j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10005202
		sub	eax, edx
		mov	[esi], eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005211:				; CODE XREF: .text:100051EAj
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005216:				; CODE XREF: .text:10005156j
					; .text:10005162j ...
		mov	eax, 0FFFFFFF9h
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10005220:				; DATA XREF: sasl_set_path+88o
		mov	ecx, [esp+8]
		test	ecx, ecx
		jnz	short loc_1000522E
		mov	eax, 0FFFFFFF9h
		retn
; ---------------------------------------------------------------------------

loc_1000522E:				; CODE XREF: .text:10005226j
		mov	eax, dword_1002E4B0
		test	eax, eax
		jnz	short loc_1000523B
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000523B:				; CODE XREF: .text:10005235j
		mov	[ecx], eax
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10005240:				; DATA XREF: sasl_set_path+4Bo
		mov	ecx, [esp+8]
		test	ecx, ecx
		jnz	short loc_1000524E
		mov	eax, 0FFFFFFF9h
		retn
; ---------------------------------------------------------------------------

loc_1000524E:				; CODE XREF: .text:10005246j
		mov	eax, dword_1002E4B4
		test	eax, eax
		jnz	short loc_1000525B
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000525B:				; CODE XREF: .text:10005255j
		mov	[ecx], eax
		xor	eax, eax
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10005260	proc near		; DATA XREF: sub_10005310+94o
					; .rdata:10027850o
		xor	eax, eax
		retn
sub_10005260	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10005270:				; DATA XREF: sub_10005310:loc_1000543Bo
		push	edi
		mov	edi, [esp+8]
		test	edi, edi
		jnz	short loc_1000527E
		lea	eax, [edi-7]
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000527E:				; CODE XREF: .text:10005277j
		mov	ecx, [esp+10h]
		test	ecx, ecx
		jz	short loc_100052FE
		cmp	byte ptr [ecx],	0
		jz	short loc_100052FE
		push	esi
		mov	esi, [esp+1Ch]
		test	esi, esi
		jz	short loc_100052E0
		mov	eax, [esp+18h]
		cmp	eax, [esp+20h]
		jnz	short loc_100052E0
		cmp	eax, 4
		jb	short loc_100052B7

loc_100052A3:				; CODE XREF: .text:100052B5j
		mov	edx, [esi]
		cmp	edx, [ecx]
		jnz	short loc_100052E0
		sub	eax, 4
		add	ecx, 4
		add	esi, 4
		cmp	eax, 4
		jnb	short loc_100052A3

loc_100052B7:				; CODE XREF: .text:100052A1j
		test	eax, eax
		jz	short loc_100052DB
		mov	dl, [ecx]
		cmp	dl, [esi]
		jnz	short loc_100052E0
		cmp	eax, 1
		jbe	short loc_100052DB
		mov	dl, [ecx+1]
		cmp	dl, [esi+1]
		jnz	short loc_100052E0
		cmp	eax, 2
		jbe	short loc_100052DB
		mov	al, [ecx+2]
		cmp	al, [esi+2]
		jnz	short loc_100052E0

loc_100052DB:				; CODE XREF: .text:100052B9j
					; .text:100052C4j ...
		pop	esi
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100052E0:				; CODE XREF: .text:10005292j
					; .text:1000529Cj ...
		push	offset aRequestedIdent ; "Requested identity not authenticated id"...
		push	0
		push	edi
		call	sasl_seterror
		add	esp, 0Ch
		mov	eax, 0FFFFFFF3h
		pop	esi
		mov	[edi+8F0h], eax
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100052FE:				; CODE XREF: .text:10005284j
					; .text:10005289j
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005310	proc near		; CODE XREF: sub_100019F0+2Bp
					; sasl_auxprop_store+64p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	esi
		push	edi
		test	ebx, ebx
		jz	loc_100054B3
		mov	edi, [esp+0Ch+arg_C]
		test	edi, edi
		jz	loc_100054B3
		mov	edx, [esp+0Ch+arg_4]
		mov	eax, edx
		sub	eax, 0
		jz	loc_10005483
		dec	eax
		jz	loc_1000545B
		mov	esi, [esp+0Ch+arg_0]
		test	esi, esi
		jz	short loc_10005393
		mov	eax, [esi+8E0h]
		test	eax, eax
		jz	short loc_1000536E
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000536E
		lea	esp, [esp+0]

loc_10005360:				; CODE XREF: sub_10005310+5Cj
		cmp	ecx, edx
		jz	short loc_100053B0
		mov	ecx, [eax+0Ch]
		add	eax, 0Ch
		test	ecx, ecx
		jnz	short loc_10005360

loc_1000536E:				; CODE XREF: sub_10005310+41j
					; sub_10005310+47j
		mov	eax, [esi+8E4h]
		test	eax, eax
		jz	short loc_10005393
		cmp	dword ptr [eax], 0
		jz	short loc_10005393
		mov	eax, [eax]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_10005393

loc_10005385:				; CODE XREF: sub_10005310+81j
		cmp	ecx, edx
		jz	short loc_100053B0
		mov	ecx, [eax+0Ch]
		add	eax, 0Ch
		test	ecx, ecx
		jnz	short loc_10005385

loc_10005393:				; CODE XREF: sub_10005310+37j
					; sub_10005310+66j ...
		cmp	edx, 5
		ja	short loc_100053F5
		jz	short loc_100053E0
		mov	eax, edx
		sub	eax, 3
		jz	short loc_100053CB
		dec	eax
		jnz	short loc_10005405
		mov	dword ptr [ebx], offset	sub_10005260
		mov	[edi], eax
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100053B0:				; CODE XREF: sub_10005310+52j
					; sub_10005310+77j
		mov	ecx, [eax+4]
		mov	[ebx], ecx
		mov	edx, [eax+8]
		mov	[edi], edx
		mov	eax, [eax+4]
		neg	eax
		sbb	eax, eax
		pop	edi
		and	eax, 0FFFFFFFEh
		pop	esi
		add	eax, 2
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100053CB:				; CODE XREF: sub_10005310+8Fj
		mov	eax, off_1002D058
		mov	[ebx], eax
		mov	ecx, dword_1002D05C
		mov	[edi], ecx
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100053E0:				; CODE XREF: sub_10005310+88j
		mov	edx, off_1002D064
		mov	[ebx], edx
		mov	eax, dword_1002D068
		mov	[edi], eax
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100053F5:				; CODE XREF: sub_10005310+86j
		cmp	edx, 4002h
		jz	short loc_1000544D
		cmp	edx, 8001h
		jz	short loc_1000543B

loc_10005405:				; CODE XREF: sub_10005310+92j
		push	edx
		push	offset aUnableToFindAC ; "Unable to find a callback: %d"
		push	1
		mov	dword ptr [ebx], 0
		push	esi
		mov	dword ptr [edi], 0
		call	sasl_seterror
		add	esp, 10h
		test	esi, esi
		jz	loc_100054AC
		pop	edi
		mov	dword ptr [esi+8F0h], 0FFFFFFFFh
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000543B:				; CODE XREF: sub_10005310+F3j
		mov	dword ptr [ebx], offset	loc_10005270
		mov	dword ptr [edi], 0
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000544D:				; CODE XREF: sub_10005310+EBj
		mov	dword ptr [ebx], offset	loc_10005150
		mov	[edi], esi
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000545B:				; CODE XREF: sub_10005310+2Bj
		mov	eax, [esp+0Ch+arg_0]
		test	eax, eax
		jz	short loc_10005471
		mov	dword ptr [ebx], offset	sub_10005070
		mov	[edi], eax
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10005471:				; CODE XREF: sub_10005310+151j
		mov	dword ptr [ebx], offset	loc_10004FE0
		mov	dword ptr [edi], 0
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10005483:				; CODE XREF: sub_10005310+24j
		mov	esi, [esp+0Ch+arg_0]
		test	esi, esi
		jz	short loc_100054AC
		push	6BDh
		push	0FFFFFFFFh
		push	offset aInternalErrorD ; "Internal Error %d in common.c	near line"...
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 14h
		mov	dword ptr [esi+8F0h], 0FFFFFFFFh

loc_100054AC:				; CODE XREF: sub_10005310+114j
					; sub_10005310+179j
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100054B3:				; CODE XREF: sub_10005310+9j
					; sub_10005310+15j
		mov	esi, [esp+0Ch+arg_0]
		test	esi, esi
		jz	short loc_100054DA
		push	6B7h
		push	offset aParameterErr_1 ; "Parameter error in common.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	dword ptr [esi+8F0h], 0FFFFFFF9h

loc_100054DA:				; CODE XREF: sub_10005310+1A9j
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		retn
sub_10005310	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100054F0	proc near		; CODE XREF: sub_100030E0+75p
					; .text:100035CCp ...

arg_0		= dword	ptr  4

		push	edi
		mov	edi, [esp+4+arg_0]
		test	edi, edi
		jnz	short loc_100054FE
		lea	eax, [edi-7]
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_100054FE:				; CODE XREF: sub_100054F0+7j
		push	esi
		mov	esi, [edi]
		test	esi, esi
		jz	short loc_1000551E
		lea	eax, [esi+8]
		push	eax
		call	sasl_randfree
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 8
		mov	dword ptr [edi], 0

loc_1000551E:				; CODE XREF: sub_100054F0+13j
		pop	esi
		xor	eax, eax
		pop	edi
		retn
sub_100054F0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  48. sasl_idle

; =============== S U B	R O U T	I N E =======================================


		public sasl_idle
sasl_idle	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_10005565
		mov	eax, dword_1002E4A8
		test	eax, eax
		jz	short loc_1000554B
		push	ecx
		call	eax ; dword_1002E4A8
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000555F

loc_1000554B:				; CODE XREF: sasl_idle+Fj
		mov	eax, dword_1002E4A4
		test	eax, eax
		jz	short loc_10005575
		push	0
		call	eax ; dword_1002E4A4
		add	esp, 4
		test	eax, eax
		jz	short loc_10005575

loc_1000555F:				; CODE XREF: sasl_idle+19j
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_10005565:				; CODE XREF: sasl_idle+6j
		mov	eax, [ecx+8DCh]
		test	eax, eax
		jz	short loc_10005575
		mov	[esp+arg_0], ecx
		jmp	eax
; ---------------------------------------------------------------------------

loc_10005575:				; CODE XREF: sasl_idle+22j
					; sasl_idle+2Dj ...
		xor	eax, eax
		retn
sasl_idle	endp

; ---------------------------------------------------------------------------
		align 10h
		test	eax, eax
		jz	short loc_1000559E
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000559E
		lea	ebx, [ebx+0]

loc_10005590:				; CODE XREF: .text:1000559Cj
		cmp	ecx, edx
		jz	short locret_100055A0
		mov	ecx, [eax+0Ch]
		add	eax, 0Ch
		test	ecx, ecx
		jnz	short loc_10005590

loc_1000559E:				; CODE XREF: .text:10005582j
					; .text:10005588j
		xor	eax, eax

locret_100055A0:			; CODE XREF: .text:10005592j
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100055B0	proc near		; CODE XREF: sasl_client_init+E3p
					; sasl_server_init+17Ep

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_100055CF
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_100055CF
		mov	edi, edi

loc_100055C0:				; CODE XREF: sub_100055B0+1Dj
		cmp	ecx, 3
		jz	short locret_100055D4
		mov	ecx, [eax+0Ch]
		add	eax, 0Ch
		test	ecx, ecx
		jnz	short loc_100055C0

loc_100055CF:				; CODE XREF: sub_100055B0+6j
					; sub_100055B0+Cj
		mov	eax, offset dword_1002D054

locret_100055D4:			; CODE XREF: sub_100055B0+13j
		retn
sub_100055B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100055E0	proc near		; CODE XREF: sub_1000A0F0+1Ep

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_100055FF
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_100055FF
		mov	edi, edi

loc_100055F0:				; CODE XREF: sub_100055E0+1Dj
		cmp	ecx, 5
		jz	short locret_10005604
		mov	ecx, [eax+0Ch]
		add	eax, 0Ch
		test	ecx, ecx
		jnz	short loc_100055F0

loc_100055FF:				; CODE XREF: sub_100055E0+6j
					; sub_100055E0+Cj
		mov	eax, offset dword_1002D060

locret_10005604:			; CODE XREF: sub_100055E0+13j
		retn
sub_100055E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005610	proc near		; CODE XREF: sasl_client_init+D9p
					; sasl_server_init+14Bp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_1000562F
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000562F
		mov	edi, edi

loc_10005620:				; CODE XREF: sub_10005610+1Dj
		cmp	ecx, 4
		jz	short locret_10005634
		mov	ecx, [eax+0Ch]
		add	eax, 0Ch
		test	ecx, ecx
		jnz	short loc_10005620

loc_1000562F:				; CODE XREF: sub_10005610+6j
					; sub_10005610+Cj
		mov	eax, offset dword_1002784C

locret_10005634:			; CODE XREF: sub_10005610+13j
		retn
sub_10005610	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005640	proc near		; CODE XREF: sub_10003D90+159p
					; sub_100056E0+6Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	edx, [edi]
		test	edx, edx
		jnz	short loc_10005680
		mov	esi, [esp+0Ch+arg_8]
		push	esi
		call	off_1002D044
		add	esp, 4
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_10005674
		mov	eax, [esp+0Ch+arg_4]
		pop	edi
		pop	esi
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFEh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10005674:				; CODE XREF: sub_10005640+1Fj
		mov	ecx, [esp+0Ch+arg_4]
		pop	edi
		mov	[ecx], esi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10005680:				; CODE XREF: sub_10005640+Bj
		mov	ebx, [esp+0Ch+arg_4]
		mov	ecx, [ebx]
		mov	eax, [esp+0Ch+arg_8]
		cmp	ecx, eax
		jnb	short loc_100056B9
		lea	esi, [ecx+ecx]
		cmp	esi, eax
		jnb	short loc_1000569B

loc_10005695:				; CODE XREF: sub_10005640+59j
		add	esi, esi
		cmp	esi, eax
		jb	short loc_10005695

loc_1000569B:				; CODE XREF: sub_10005640+53j
		push	esi		; dwBytes
		push	edx		; lpMem
		call	off_1002D04C
		add	esp, 8
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_100056B7
		pop	edi
		mov	[ebx], eax
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100056B7:				; CODE XREF: sub_10005640+6Aj
		mov	[ebx], esi

loc_100056B9:				; CODE XREF: sub_10005640+4Cj
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
sub_10005640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100056C0	proc near		; CODE XREF: sasl_seterror+96p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		lea	ecx, [eax+8F4h]
		mov	[edx], ecx
		mov	ecx, [esp+arg_8]
		add	eax, 8FCh
		mov	[ecx], eax
		retn
sub_100056C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100056E0	proc near		; CODE XREF: sasl_encodev+90p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	esi
		test	ebp, ebp
		jz	loc_100057A3
		mov	esi, [esp+8+arg_8]
		test	esi, esi
		jz	loc_100057A3
		cmp	dword ptr [esi], 0
		jnz	short loc_10005722
		push	0Ch
		call	off_1002D044
		add	esp, 4
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_10005718
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10005718:				; CODE XREF: sub_100056E0+2Ej
		xor	ecx, ecx
		mov	[eax], ecx
		mov	[eax+4], ecx
		mov	[eax+8], ecx

loc_10005722:				; CODE XREF: sub_100056E0+1Dj
		mov	esi, [esi]
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		xor	eax, eax
		mov	dword ptr [esi+4], 0
		test	ebx, ebx
		jz	short loc_10005744
		xor	ecx, ecx

loc_10005738:				; CODE XREF: sub_100056E0+62j
		add	ecx, [ebp+eax*8+0]
		inc	eax
		mov	[esi+4], ecx
		cmp	eax, ebx
		jb	short loc_10005738

loc_10005744:				; CODE XREF: sub_100056E0+54j
		mov	eax, [esi+4]
		push	edi
		push	eax
		lea	edi, [esi+8]
		push	edi
		push	esi
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10005764
		pop	edi
		pop	ebx
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10005764:				; CODE XREF: sub_100056E0+78j
		mov	ecx, [edi]
		mov	edx, [esi]
		push	ecx
		push	0
		push	edx
		call	sub_1000E0F0
		mov	edi, [esi]
		add	esp, 0Ch
		xor	esi, esi
		test	ebx, ebx
		jz	short loc_1000579C
		lea	esp, [esp+0]

loc_10005780:				; CODE XREF: sub_100056E0+BAj
		mov	eax, [ebp+esi*8+0]
		mov	ecx, [ebp+esi*8+4]
		push	eax
		push	ecx
		push	edi
		call	sub_1000E2B0
		add	edi, [ebp+esi*8+0]
		inc	esi
		add	esp, 0Ch
		cmp	esi, ebx
		jb	short loc_10005780

loc_1000579C:				; CODE XREF: sub_100056E0+9Aj
		pop	edi
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100057A3:				; CODE XREF: sub_100056E0+8j
					; sub_100056E0+14j
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebp
		retn
sub_100056E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100057B0	proc near		; CODE XREF: sasl_setprop+2A3p
					; sasl_setprop+39Fp

ppResult	= dword	ptr -42Ch
pHints		= ADDRINFOA ptr	-428h
pNodeName	= byte ptr -408h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 42Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+42Ch+var_4], eax
		push	ebp
		mov	ebp, [esp+430h+arg_4]
		push	esi
		mov	esi, [esp+434h+arg_0]
		mov	[esp+434h+ppResult], 0
		test	esi, esi
		jnz	short loc_100057FA
		lea	eax, [esi-7]
		pop	esi
		pop	ebp
		mov	ecx, [esp+42Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 42Ch
		retn
; ---------------------------------------------------------------------------

loc_100057FA:				; CODE XREF: sub_100057B0+2Ej
		mov	al, [esi]
		xor	edx, edx
		push	edi
		test	al, al
		jz	short loc_1000582C
		lea	edi, [esp+438h+pNodeName]
		mov	ecx, esi
		sub	edi, esi
		jmp	short loc_10005810
; ---------------------------------------------------------------------------
		align 10h

loc_10005810:				; CODE XREF: sub_100057B0+5Bj
					; sub_100057B0+7Aj
		cmp	al, 3Bh
		jz	short loc_1000582C
		cmp	edx, 401h
		jge	loc_100058A9
		mov	[edi+ecx], al
		mov	al, [ecx+1]
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_10005810

loc_1000582C:				; CODE XREF: sub_100057B0+51j
					; sub_100057B0+62j
		cmp	byte ptr [esi+edx], 3Bh
		mov	[esp+edx+438h+pNodeName], 0
		jnz	short loc_10005838
		inc	edx

loc_10005838:				; CODE XREF: sub_100057B0+85j
		cmp	byte ptr [esi+edx], 0
		lea	edi, [esi+edx]
		jz	short loc_10005859
		mov	esi, edi

loc_10005843:				; CODE XREF: sub_100057B0+A7j
		movsx	eax, byte ptr [esi]
		push	eax
		call	sub_1000E8B7
		add	esp, 4
		test	eax, eax
		jz	short loc_100058A9
		inc	esi
		cmp	byte ptr [esi],	0
		jnz	short loc_10005843

loc_10005859:				; CODE XREF: sub_100057B0+8Fj
		xor	eax, eax
		lea	ecx, [esp+438h+ppResult]
		push	ecx		; ppResult
		lea	edx, [esp+43Ch+pHints]
		mov	[esp+43Ch+pHints.ai_family], eax
		push	edx		; pHints
		mov	[esp+440h+pHints.ai_flags], eax
		mov	[esp+440h+pHints.ai_socktype], eax
		mov	[esp+440h+pHints.ai_protocol], eax
		mov	[esp+440h+pHints.ai_addrlen], eax
		mov	[esp+440h+pHints.ai_canonname],	eax
		mov	[esp+440h+pHints.ai_addr], eax
		mov	[esp+440h+pHints.ai_next], eax
		mov	[esp+440h+pHints.ai_family], eax
		push	edi		; pServiceName
		lea	eax, [esp+444h+pNodeName]
		push	eax		; pNodeName
		mov	[esp+448h+pHints.ai_socktype], 1
		mov	[esp+448h+pHints.ai_flags], 5
		call	ds:getaddrinfo
		test	eax, eax
		jz	short loc_100058C6

loc_100058A9:				; CODE XREF: sub_100057B0+6Aj
					; sub_100057B0+A1j
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebp
		mov	ecx, [esp+42Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 42Ch
		retn
; ---------------------------------------------------------------------------

loc_100058C6:				; CODE XREF: sub_100057B0+F7j
		mov	esi, [esp+438h+ppResult]
		test	ebp, ebp
		jz	short loc_1000590C
		mov	eax, [esi+10h]
		cmp	[esp+438h+arg_8], eax
		jge	short loc_100058FE
		push	esi		; pAddrInfo
		call	ds:freeaddrinfo
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFDh
		pop	ebp
		mov	ecx, [esp+42Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 42Ch
		retn
; ---------------------------------------------------------------------------

loc_100058FE:				; CODE XREF: sub_100057B0+128j
		mov	ecx, [esi+18h]
		push	eax
		push	ecx
		push	ebp
		call	sub_1000E2B0
		add	esp, 0Ch

loc_1000590C:				; CODE XREF: sub_100057B0+11Cj
		push	esi		; pAddrInfo
		call	ds:freeaddrinfo
		mov	ecx, [esp+438h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 42Ch
		retn
sub_100057B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005930	proc near		; CODE XREF: sasl_client_init+113p
					; sasl_server_init+1AEp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 0Ch
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		mov	[esp+18h+var_4], esi
		call	sub_100040B0
		mov	edi, eax
		mov	[esp+18h+var_C], edi
		call	sub_1000AFD0
		test	edi, edi
		jnz	short loc_10005954
		mov	edi, eax
		jmp	short loc_100059CD
; ---------------------------------------------------------------------------

loc_10005954:				; CODE XREF: sub_10005930+1Ej
		mov	ebp, eax
		test	eax, eax
		jz	short loc_100059CD
		lea	ebx, [ebx+0]

loc_10005960:				; CODE XREF: sub_10005930+97j
		mov	eax, [ebp+4]
		mov	[esp+18h+var_8], eax
		lea	eax, [esp+18h+var_C]
		mov	esi, edi
		test	edi, edi
		jz	short loc_100059A8

loc_10005971:				; CODE XREF: sub_10005930+76j
		mov	ecx, [ebp+0]
		mov	eax, [esi]

loc_10005976:				; CODE XREF: sub_10005930+60j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10005996
		test	dl, dl
		jz	short loc_10005992
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10005996
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10005976

loc_10005992:				; CODE XREF: sub_10005930+4Ej
		xor	eax, eax
		jmp	short loc_1000599B
; ---------------------------------------------------------------------------

loc_10005996:				; CODE XREF: sub_10005930+4Aj
					; sub_10005930+56j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_1000599B:				; CODE XREF: sub_10005930+64j
		test	eax, eax
		jz	short loc_100059B7
		lea	eax, [esi+4]
		mov	esi, [eax]
		test	esi, esi
		jnz	short loc_10005971

loc_100059A8:				; CODE XREF: sub_10005930+3Fj
		mov	[eax], ebp
		mov	edi, [esp+18h+var_C]
		mov	dword ptr [ebp+4], 0
		jmp	short loc_100059C1
; ---------------------------------------------------------------------------

loc_100059B7:				; CODE XREF: sub_10005930+6Dj
		push	ebp		; lpMem
		call	off_1002D050
		add	esp, 4

loc_100059C1:				; CODE XREF: sub_10005930+85j
		mov	ebp, [esp+18h+var_8]
		test	ebp, ebp
		jnz	short loc_10005960
		mov	esi, [esp+18h+var_4]

loc_100059CD:				; CODE XREF: sub_10005930+22j
					; sub_10005930+28j
		test	edi, edi
		jnz	short loc_100059E8
		push	offset aNoOlist	; "no olist"
		call	sub_1000ED67
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100059E8:				; CODE XREF: sub_10005930+9Fj
		mov	eax, edi
		lea	ebx, [ebx+0]

loc_100059F0:				; CODE XREF: sub_10005930+C6j
		mov	eax, [eax+4]
		inc	esi
		test	eax, eax
		jnz	short loc_100059F0
		mov	eax, dword_1002E494
		test	eax, eax
		jz	short loc_10005A15
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	dword_1002E494,	0

loc_10005A15:				; CODE XREF: sub_10005930+CFj
		lea	esi, ds:4[esi*4]
		push	esi
		call	off_1002D044
		mov	ebp, eax
		add	esp, 4
		mov	dword_1002E494,	ebp
		test	ebp, ebp
		jnz	short loc_10005A3C
		pop	edi
		pop	esi
		lea	eax, [ebp-2]
		pop	ebp
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10005A3C:				; CODE XREF: sub_10005930+100j
		push	esi
		push	0
		push	ebp
		call	sub_1000E0F0
		add	esp, 0Ch
		mov	eax, edi
		xor	edi, edi
		jmp	short loc_10005A56
; ---------------------------------------------------------------------------
		align 10h

loc_10005A50:				; CODE XREF: sub_10005930+13Fj
		mov	ebp, dword_1002E494

loc_10005A56:				; CODE XREF: sub_10005930+11Cj
		mov	ecx, [eax]
		mov	esi, [eax+4]
		mov	[edi+ebp], ecx
		push	eax		; lpMem
		add	edi, 4
		call	off_1002D050
		add	esp, 4
		mov	eax, esi
		test	esi, esi
		jnz	short loc_10005A50
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn
sub_10005930	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  46. sasl_global_listmech

; =============== S U B	R O U T	I N E =======================================


		public sasl_global_listmech
sasl_global_listmech proc near		; DATA XREF: .rdata:off_1002C568o
		mov	eax, dword_1002E494
		retn
sasl_global_listmech endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  49. sasl_listmech

; =============== S U B	R O U T	I N E =======================================


		public sasl_listmech
sasl_listmech	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_10005A9E
		lea	eax, [esi-7]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005A9E:				; CODE XREF: sasl_listmech+7j
		mov	eax, [esi]
		push	ebx
		push	ebp
		push	edi
		cmp	eax, 1
		jnz	short loc_10005B23
		mov	edi, [esp+10h+arg_1C]
		mov	ebx, [esp+10h+arg_18]
		mov	ebp, [esp+10h+arg_14]
		mov	eax, [esp+10h+arg_10]
		mov	ecx, [esp+10h+arg_C]
		mov	edx, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		push	eax
		mov	eax, [esp+20h+arg_4]
		push	ecx
		push	edx
		push	eax
		push	esi
		call	sub_1000AC20
		add	esp, 20h
		test	eax, eax
		jns	short loc_10005AFE
		mov	ecx, [esp+10h+arg_10]
		mov	edx, [esp+10h+arg_C]
		mov	eax, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		push	ecx
		mov	ecx, [esp+20h+arg_4]
		push	edx
		push	eax
		push	ecx
		push	esi
		call	sub_1000AC20
		add	esp, 20h
		mov	[esi+8F0h], eax

loc_10005AFE:				; CODE XREF: sasl_listmech+46j
		mov	edx, [esp+10h+arg_10]
		mov	eax, [esp+10h+arg_C]
		mov	ecx, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		push	edx
		mov	edx, [esp+20h+arg_4]
		push	eax
		push	ecx
		push	edx
		push	esi
		call	sub_1000AC20
		add	esp, 20h
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005B23:				; CODE XREF: sasl_listmech+16j
		cmp	eax, 2
		jnz	short loc_10005B94
		mov	edi, [esp+10h+arg_1C]
		mov	ebx, [esp+10h+arg_18]
		mov	ebp, [esp+10h+arg_14]
		mov	eax, [esp+10h+arg_10]
		mov	ecx, [esp+10h+arg_C]
		mov	edx, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		push	eax
		push	ecx
		push	edx
		push	esi
		call	sub_10003D90
		add	esp, 1Ch
		test	eax, eax
		jns	short loc_10005B74
		mov	eax, [esp+10h+arg_10]
		mov	ecx, [esp+10h+arg_C]
		mov	edx, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		push	eax
		push	ecx
		push	edx
		push	esi
		call	sub_10003D90
		add	esp, 1Ch
		mov	[esi+8F0h], eax

loc_10005B74:				; CODE XREF: sasl_listmech+C1j
		mov	eax, [esp+10h+arg_10]
		mov	ecx, [esp+10h+arg_C]
		mov	edx, [esp+10h+arg_8]
		push	edi
		push	ebx
		push	ebp
		push	eax
		push	ecx
		push	edx
		push	esi
		call	sub_10003D90
		add	esp, 1Ch
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005B94:				; CODE XREF: sasl_listmech+96j
		push	968h
		push	offset aParameterErr_1 ; "Parameter error in common.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		pop	edi
		pop	ebp
		mov	eax, 0FFFFFFF9h
		pop	ebx
		mov	[esi+8F0h], eax
		pop	esi
		retn
sasl_listmech	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005BC0	proc near		; CODE XREF: sasl_client_new+238p
					; sasl_client_start+14Dp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	esi, [esp+4+arg_8]
		push	edi
		mov	edi, [esp+8+arg_0]
		cmp	esi, 5
		jbe	short loc_10005BF4
		lea	eax, [edi+esi-5]
		push	offset aPlus	; "-PLUS"
		push	eax
		call	sub_10023E83
		add	esp, 8
		test	eax, eax
		jnz	short loc_10005BF4
		mov	ecx, [esp+8+arg_C]
		add	esi, 0FFFFFFFBh
		mov	dword ptr [ecx], 1
		jmp	short loc_10005BFE
; ---------------------------------------------------------------------------

loc_10005BF4:				; CODE XREF: sub_10005BC0+Dj
					; sub_10005BC0+23j
		mov	edx, [esp+8+arg_C]
		mov	dword ptr [edx], 0

loc_10005BFE:				; CODE XREF: sub_10005BC0+32j
		mov	eax, [esp+8+arg_4]
		push	esi
		push	eax
		push	edi
		call	sub_10023FC7
		add	esp, 0Ch
		neg	eax
		sbb	eax, eax
		pop	edi
		inc	eax
		pop	esi
		retn
sub_10005BC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10005C20(LPCSTR lpValueName)
sub_10005C20	proc near		; CODE XREF: sub_10006EB0+23p
					; sub_10006EF0+23p

cbData		= dword	ptr -10h
Type		= dword	ptr -0Ch
var_8		= dword	ptr -8
phkResult	= dword	ptr -4

		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebx, eax
		lea	eax, [esp+20h+phkResult]
		push	eax		; phkResult
		push	20019h		; samDesired
		xor	ebp, ebp
		push	ebp		; ulOptions
		push	offset SubKey	; "SOFTWARE\\Carnegie Mellon\\Project Cyru"...
		push	80000002h	; hKey
		mov	edi, ecx
		call	ds:RegOpenKeyExA
		test	eax, eax
		jz	short loc_10005C85
		mov	eax, ebx
		lea	edx, [eax+1]

loc_10005C51:				; CODE XREF: sub_10005C20+36j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10005C51
		sub	eax, edx
		inc	eax
		push	eax
		call	off_1002D044
		add	esp, 4
		cmp	eax, ebp
		jz	loc_10005DCF
		mov	esi, eax
		mov	ecx, ebx
		sub	esi, ebx

loc_10005C73:				; CODE XREF: sub_10005C20+5Bj
		mov	dl, [ecx]
		mov	[esi+ecx], dl
		inc	ecx
		test	dl, dl
		jnz	short loc_10005C73
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10005C85:				; CODE XREF: sub_10005C20+2Aj
		mov	eax, [esp+20h+phkResult]
		mov	esi, ds:RegQueryValueExA
		lea	ecx, [esp+20h+cbData]
		push	ecx		; lpcbData
		push	ebp		; lpData
		lea	edx, [esp+28h+Type]
		push	edx		; lpType
		push	ebp		; lpReserved
		push	edi		; lpValueName
		push	eax		; hKey
		call	esi ; RegQueryValueExA
		mov	eax, [esp+20h+Type]
		cmp	eax, 2
		jz	short loc_10005CBB
		cmp	eax, 7
		jz	short loc_10005CBB
		cmp	eax, 1
		jz	short loc_10005CBB
		xor	esi, esi
		mov	ebx, esi
		jmp	loc_10005DA2
; ---------------------------------------------------------------------------

loc_10005CBB:				; CODE XREF: sub_10005C20+86j
					; sub_10005C20+8Bj ...
		mov	ecx, [esp+20h+cbData]
		push	ecx
		call	off_1002D044
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_10005CD6
		xor	esi, esi
		jmp	loc_10005DA2
; ---------------------------------------------------------------------------

loc_10005CD6:				; CODE XREF: sub_10005C20+ADj
		mov	ecx, [esp+20h+phkResult]
		lea	edx, [esp+20h+cbData]
		push	edx		; lpcbData
		push	ebx		; lpData
		lea	eax, [esp+28h+Type]
		push	eax		; lpType
		push	0		; lpReserved
		push	edi		; lpValueName
		push	ecx		; hKey
		call	esi ; RegQueryValueExA
		mov	eax, [esp+20h+Type]
		dec	eax
		jz	loc_10005DA0
		dec	eax
		jz	short loc_10005D2D
		sub	eax, 5
		jz	short loc_10005D05
		xor	esi, esi
		jmp	loc_10005DA2
; ---------------------------------------------------------------------------

loc_10005D05:				; CODE XREF: sub_10005C20+DCj
		mov	edx, ebx

loc_10005D07:				; CODE XREF: sub_10005C20+10Bj
		cmp	byte ptr [edx],	0
		jnz	short loc_10005D19
		cmp	byte ptr [edx+1], 0
		jz	loc_10005DA0
		mov	byte ptr [edx],	3Bh

loc_10005D19:				; CODE XREF: sub_10005C20+EAj
		mov	eax, edx
		lea	esi, [eax+1]
		mov	edi, edi

loc_10005D20:				; CODE XREF: sub_10005C20+105j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10005D20
		sub	eax, esi
		add	edx, eax
		jmp	short loc_10005D07
; ---------------------------------------------------------------------------

loc_10005D2D:				; CODE XREF: sub_10005C20+D7j
		mov	esi, [esp+20h+cbData]
		add	esi, 400h
		push	esi
		call	off_1002D044
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jnz	short loc_10005D4B
		xor	esi, esi
		jmp	short loc_10005DA2
; ---------------------------------------------------------------------------

loc_10005D4B:				; CODE XREF: sub_10005C20+125j
		mov	edi, ds:ExpandEnvironmentStringsA
		push	esi		; nSize
		push	ebp		; lpDst
		push	ebx		; lpSrc
		call	edi ; ExpandEnvironmentStringsA
		mov	esi, eax
		test	esi, esi
		jz	short loc_10005DA2
		mov	edx, [esp+20h+cbData]
		add	edx, 400h
		cmp	esi, edx
		jbe	short loc_10005D8C
		push	esi		; dwBytes
		push	ebp		; lpMem
		call	off_1002D04C
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jnz	short loc_10005D7F
		xor	esi, esi
		jmp	short loc_10005DA2
; ---------------------------------------------------------------------------

loc_10005D7F:				; CODE XREF: sub_10005C20+159j
		push	esi		; nSize
		push	ebp		; lpDst
		push	ebx		; lpSrc
		call	edi ; ExpandEnvironmentStringsA
		test	eax, eax
		jnz	short loc_10005D8C
		xor	esi, esi
		jmp	short loc_10005DA2
; ---------------------------------------------------------------------------

loc_10005D8C:				; CODE XREF: sub_10005C20+148j
					; sub_10005C20+166j
		push	ebx		; lpMem
		call	off_1002D050
		mov	[esp+24h+var_8], ebp
		mov	ebx, [esp+24h+var_8]
		add	esp, 4
		xor	ebp, ebp

loc_10005DA0:				; CODE XREF: sub_10005C20+D0j
					; sub_10005C20+F0j
		mov	esi, ebx

loc_10005DA2:				; CODE XREF: sub_10005C20+96j
					; sub_10005C20+B1j ...
		mov	eax, [esp+20h+phkResult]
		push	eax		; hKey
		call	ds:RegCloseKey
		test	ebp, ebp
		jz	short loc_10005DBB
		push	ebp		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10005DBB:				; CODE XREF: sub_10005C20+18Fj
		test	esi, esi
		jnz	short loc_10005DCD
		test	ebx, ebx
		jz	short loc_10005DCD
		push	ebx		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10005DCD:				; CODE XREF: sub_10005C20+19Dj
					; sub_10005C20+1A1j
		mov	eax, esi

loc_10005DCF:				; CODE XREF: sub_10005C20+47j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_10005C20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005DE0	proc near		; CODE XREF: sub_10006F30:loc_1000705Bp
					; sub_10006F30+195p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_C]
		push	esi
		push	edi
		test	ebp, ebp
		jnz	short loc_10005DF1
		mov	ebp, offset aNull ; "(null)"

loc_10005DF1:				; CODE XREF: sub_10005DE0+Aj
		mov	eax, ebp
		lea	edx, [eax+1]

loc_10005DF6:				; CODE XREF: sub_10005DE0+1Bj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10005DF6
		mov	edi, [esp+10h+arg_8]
		mov	ecx, [esp+10h+arg_4]
		mov	ebx, [esp+10h+arg_0]
		sub	eax, edx
		mov	esi, eax
		mov	eax, [edi]
		add	eax, esi
		push	eax
		push	ecx
		push	ebx
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10005E2A
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10005E2A:				; CODE XREF: sub_10005DE0+3Ej
		mov	edx, [ebx]
		add	edx, [edi]
		push	esi
		push	ebp
		push	edx
		call	sub_1000EFE0
		add	[edi], esi
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_10005DE0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  64. sasl_set_path

; =============== S U B	R O U T	I N E =======================================


		public sasl_set_path
sasl_set_path	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		test	esi, esi
		jnz	short loc_10005E5E

loc_10005E59:				; CODE XREF: sasl_set_path+18j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005E5E:				; CODE XREF: sasl_set_path+7j
		mov	eax, [esp+4+arg_0]
		sub	eax, 0
		jz	short loc_10005EA7
		dec	eax
		jnz	short loc_10005E59
		mov	eax, dword_1002E4B4
		test	eax, eax
		jz	short loc_10005E87
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	dword_1002E4B4,	0

loc_10005E87:				; CODE XREF: sasl_set_path+21j
		push	0
		push	offset dword_1002E4B4
		push	esi
		call	sub_10004910
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10005EE2
		mov	off_1002D064, offset loc_10005240
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005EA7:				; CODE XREF: sasl_set_path+15j
		mov	eax, dword_1002E4B0
		test	eax, eax
		jz	short loc_10005EC4
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	dword_1002E4B0,	0

loc_10005EC4:				; CODE XREF: sasl_set_path+5Ej
		push	0
		push	offset dword_1002E4B0
		push	esi
		call	sub_10004910
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10005EE2
		mov	off_1002D058, offset loc_10005220

loc_10005EE2:				; CODE XREF: sasl_set_path+49j
					; sasl_set_path+86j
		pop	esi
		retn
sasl_set_path	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  41. sasl_encodev

; =============== S U B	R O U T	I N E =======================================


		public sasl_encodev
sasl_encodev	proc near		; CODE XREF: sasl_encode+47p
					; DATA XREF: .rdata:off_1002C568o

lpMem		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 1Ch
		push	ebp
		push	esi
		mov	esi, [esp+24h+arg_0]
		xor	ebp, ebp
		push	edi
		xor	edx, edx
		xor	edi, edi
		mov	[esp+28h+var_18], ebp
		mov	[esp+28h+lpMem], edx
		mov	[esp+28h+var_10], ebp
		mov	[esp+28h+var_14], ebp
		cmp	esi, ebp
		jnz	short loc_10005F1E
		pop	edi
		pop	esi
		lea	eax, [ebp-7]
		pop	ebp
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10005F1E:				; CODE XREF: sasl_encodev+22j
		mov	ecx, [esp+28h+arg_4]
		cmp	ecx, ebp
		jz	loc_1000622B
		cmp	[esp+28h+arg_C], ebp
		jz	loc_1000622B
		cmp	[esp+28h+arg_10], ebp
		jz	loc_1000622B
		mov	eax, [esp+28h+arg_8]
		cmp	eax, 1
		jb	loc_1000622B
		cmp	[esi+8C0h], ebp
		jnz	short loc_10005F6E
		push	offset aCalledSasl_enc ; "called sasl_encode[v]	with application "...
		push	ebp
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF1h
		pop	ebp
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10005F6E:				; CODE XREF: sasl_encodev+61j
		push	ebx
		cmp	[esi+880h], ebp
		jnz	short loc_10005FD6
		lea	ebx, [esi+8ECh]
		push	ebx
		push	eax
		push	ecx
		call	sub_100056E0
		mov	edi, eax
		add	esp, 0Ch
		cmp	edi, ebp
		jz	short loc_10005FB7
		push	1B2h
		push	edi
		push	offset aInternalErrorD ; "Internal Error %d in common.c	near line"...
		push	ebp
		push	esi
		call	sasl_seterror
		add	esp, 14h
		cmp	edi, ebp
		jge	short loc_10005FAD
		mov	[esi+8F0h], edi

loc_10005FAD:				; CODE XREF: sasl_encodev+B5j
					; sasl_encodev+F2j ...
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10005FB7:				; CODE XREF: sasl_encodev+9Cj
		mov	eax, [ebx]
		mov	ecx, [eax]
		mov	edx, [esp+2Ch+arg_C]
		mov	[edx], ecx
		mov	eax, [ebx]
		mov	ecx, [eax+4]
		mov	edx, [esp+2Ch+arg_10]
		pop	ebx
		pop	edi
		pop	esi
		mov	[edx], ecx
		xor	eax, eax
		pop	ebp
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10005FD6:				; CODE XREF: sasl_encodev+85j
		xor	ebx, ebx
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+arg_0], ebp
		test	eax, eax
		jz	short loc_10005FAD

loc_10005FE4:				; CODE XREF: sasl_encodev+274j
		mov	eax, [esp+2Ch+arg_4]
		mov	ecx, [eax+ebp*8]
		mov	eax, [esp+2Ch+var_18]
		add	eax, ecx
		mov	ecx, [esi+874h]
		cmp	eax, ecx
		jbe	loc_1000615B
		sub	ecx, [esp+2Ch+var_18]
		lea	edi, [ebp+1]
		mov	[esp+2Ch+var_8], ecx
		mov	ecx, [esp+2Ch+arg_4]
		mov	eax, [ecx+ebp*8+4]
		mov	[esp+2Ch+var_C], edi
		inc	edi
		mov	[esp+2Ch+var_4], eax
		cmp	edi, [esp+2Ch+var_10]
		jbe	short loc_10006045
		lea	ecx, ds:0[edi*8]
		push	ecx		; dwBytes
		push	edx		; lpMem
		mov	[esp+34h+var_10], edi
		call	off_1002D04C
		add	esp, 8
		test	eax, eax
		jz	loc_100061F1
		mov	[esp+2Ch+lpMem], eax
		mov	edx, eax

loc_10006045:				; CODE XREF: sasl_encodev+12Fj
		mov	eax, [esp+2Ch+arg_0]
		test	eax, eax
		jz	short loc_1000605D
		mov	[esp+2Ch+var_C], edi
		mov	[edx+4], eax
		mov	[edx], ebx
		mov	edi, 1
		jmp	short loc_1000605F
; ---------------------------------------------------------------------------

loc_1000605D:				; CODE XREF: sasl_encodev+15Bj
		xor	edi, edi

loc_1000605F:				; CODE XREF: sasl_encodev+16Bj
		test	ebp, ebp
		jz	short loc_10006086
		mov	eax, [esp+2Ch+arg_4]
		lea	ecx, [edx+edi*8]
		mov	[esp+2Ch+arg_0], ebp
		mov	edi, edi

loc_10006070:				; CODE XREF: sasl_encodev+194j
		mov	ebx, [eax]
		mov	[ecx], ebx
		mov	ebx, [eax+4]
		mov	[ecx+4], ebx
		add	eax, 8
		add	ecx, 8
		dec	[esp+2Ch+arg_0]
		jnz	short loc_10006070

loc_10006086:				; CODE XREF: sasl_encodev+171j
		mov	ecx, [esp+2Ch+var_8]
		lea	eax, [edi+ebp]
		mov	edi, [esp+2Ch+arg_10]
		mov	[edx+eax*8], ecx
		mov	ecx, [esp+2Ch+var_4]
		mov	[edx+eax*8+4], ecx
		mov	eax, [esp+2Ch+arg_C]
		push	eax
		mov	eax, [esp+30h+var_C]
		lea	ecx, [esp+30h+var_14]
		push	ecx
		push	eax
		push	edx
		call	sub_100049F0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_100061C7
		mov	edx, [esp+2Ch+var_8]
		add	edx, [esp+2Ch+var_4]
		mov	ecx, [esp+2Ch+arg_4]
		mov	ebx, [ecx+ebp*8]
		mov	eax, [esi+874h]
		mov	[esp+2Ch+arg_0], edx
		sub	ebx, eax
		add	ebx, [esp+2Ch+var_18]
		or	edx, 0FFFFFFFFh
		sub	edx, ebp
		add	[esp+2Ch+arg_8], edx
		lea	ecx, [ecx+ebp*8+8]
		xor	ebp, ebp
		mov	[esp+2Ch+arg_4], ecx
		cmp	ebx, eax
		jbe	short loc_10006149
		jmp	short loc_10006100
; ---------------------------------------------------------------------------
		align 10h

loc_10006100:				; CODE XREF: sasl_encodev+204j
					; sasl_encodev+257j
		mov	eax, [esi+874h]
		mov	ecx, [esp+2Ch+arg_0]
		mov	edi, [esp+2Ch+arg_10]
		mov	[esp+2Ch+var_4], ecx
		add	ecx, eax
		mov	[esp+2Ch+var_8], eax
		sub	ebx, eax
		mov	eax, [esp+2Ch+arg_C]
		push	eax
		mov	[esp+30h+arg_0], ecx
		lea	ecx, [esp+30h+var_14]
		push	ecx
		lea	edx, [esp+34h+var_8]
		push	1
		push	edx
		call	sub_100049F0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_100061C7
		cmp	ebx, [esi+874h]
		ja	short loc_10006100

loc_10006149:				; CODE XREF: sasl_encodev+202j
		mov	edx, [esp+2Ch+lpMem]
		mov	[esp+2Ch+var_18], ebx
		test	ebx, ebx
		jnz	short loc_10006160
		mov	[esp+2Ch+arg_0], ebp
		jmp	short loc_10006160
; ---------------------------------------------------------------------------

loc_1000615B:				; CODE XREF: sasl_encodev+109j
		mov	[esp+2Ch+var_18], eax
		inc	ebp

loc_10006160:				; CODE XREF: sasl_encodev+263j
					; sasl_encodev+269j
		cmp	ebp, [esp+2Ch+arg_8]
		jb	loc_10005FE4
		mov	eax, [esp+2Ch+arg_0]
		test	eax, eax
		jz	short loc_100061A1
		mov	edi, [esp+2Ch+arg_10]
		mov	[esp+2Ch+var_4], eax
		mov	eax, [esp+2Ch+arg_C]
		push	eax
		lea	ecx, [esp+30h+var_14]
		push	ecx
		lea	edx, [esp+34h+var_8]
		push	1
		push	edx
		mov	[esp+3Ch+var_8], ebx
		call	sub_100049F0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	short loc_100061C7
		mov	edx, [esp+2Ch+lpMem]

loc_100061A1:				; CODE XREF: sasl_encodev+280j
		mov	eax, [esp+2Ch+arg_8]
		test	eax, eax
		jz	short loc_100061CB
		mov	ecx, [esp+2Ch+arg_C]
		mov	edi, [esp+2Ch+arg_10]
		push	ecx
		lea	edx, [esp+30h+var_14]
		push	edx
		push	eax
		mov	eax, [esp+38h+arg_4]
		push	eax
		call	sub_100049F0
		add	esp, 10h
		mov	edi, eax

loc_100061C7:				; CODE XREF: sasl_encodev+1C8j
					; sasl_encodev+24Bj ...
		mov	edx, [esp+2Ch+lpMem]

loc_100061CB:				; CODE XREF: sasl_encodev+2B7j
		test	edx, edx
		jz	short loc_100061D9
		push	edx		; lpMem
		call	off_1002D050
		add	esp, 4

loc_100061D9:				; CODE XREF: sasl_encodev+2DDj
		test	edi, edi
		jns	loc_10005FAD
		pop	ebx
		mov	[esi+8F0h], edi
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_100061F1:				; CODE XREF: sasl_encodev+149j
		mov	eax, [esp+2Ch+lpMem]
		test	eax, eax
		jz	short loc_10006203
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10006203:				; CODE XREF: sasl_encodev+307j
		push	1DEh
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 10h
		pop	ebx
		mov	eax, 0FFFFFFFEh
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebp
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000622B:				; CODE XREF: sasl_encodev+34j
					; sasl_encodev+3Ej ...
		push	1A5h
		push	offset aParameterErr_1 ; "Parameter error in common.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebp
		add	esp, 1Ch
		retn
sasl_encodev	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006260	proc near		; CODE XREF: sasl_client_done+40p
					; sasl_done+46j ...
		mov	eax, dword_1002E4B0
		push	edi
		xor	edi, edi
		cmp	eax, edi
		jz	short loc_1000627C
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	dword_1002E4B0,	edi

loc_1000627C:				; CODE XREF: sub_10006260+Aj
		mov	eax, dword_1002E4B4
		cmp	eax, edi
		jz	short loc_10006295
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	dword_1002E4B4,	edi

loc_10006295:				; CODE XREF: sub_10006260+23j
		push	esi
		call	sub_10002810
		call	sub_1000CD60
		mov	eax, dword_1002E498
		push	eax
		call	off_1002D078
		mov	esi, sasl_global_utils
		add	esp, 4
		mov	dword_1002E498,	edi
		cmp	esi, edi
		jz	short loc_100062D8
		lea	ecx, [esi+8]
		push	ecx
		call	sasl_randfree
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 8
		mov	sasl_global_utils, edi

loc_100062D8:				; CODE XREF: sub_10006260+5Dj
		mov	eax, dword_1002E494
		pop	esi
		cmp	eax, edi
		jz	short loc_100062F2
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	dword_1002E494,	edi

loc_100062F2:				; CODE XREF: sub_10006260+80j
		pop	edi
		retn
sub_10006260	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  38. sasl_done

; =============== S U B	R O U T	I N E =======================================


		public sasl_done
sasl_done	proc near		; DATA XREF: .rdata:off_1002C568o
		mov	eax, dword_1002E4A0
		test	eax, eax
		jz	short loc_10006319
		call	eax ; dword_1002E4A0
		test	eax, eax
		jnz	short loc_10006319
		mov	dword_1002E4A8,	eax
		mov	dword_1002E4A0,	eax

loc_10006319:				; CODE XREF: sasl_done+7j sasl_done+Dj
		mov	eax, dword_1002E49C
		test	eax, eax
		jz	short loc_10006339
		call	eax ; dword_1002E49C
		test	eax, eax
		jnz	short loc_10006334
		mov	dword_1002E4A4,	eax
		mov	dword_1002E49C,	eax
		jmp	short loc_10006339
; ---------------------------------------------------------------------------

loc_10006334:				; CODE XREF: sasl_done+26j
		mov	eax, dword_1002E49C

loc_10006339:				; CODE XREF: sasl_done+20j
					; sasl_done+32j
		cmp	dword_1002E4A0,	0
		jnz	short locret_1000634B
		test	eax, eax
		jnz	short locret_1000634B
		jmp	sub_10006260
; ---------------------------------------------------------------------------

locret_1000634B:			; CODE XREF: sasl_done+40j
					; sasl_done+44j
		retn
sasl_done	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  45. sasl_getprop

; =============== S U B	R O U T	I N E =======================================


		public sasl_getprop
sasl_getprop	proc near		; CODE XREF: sasl_setpass+D5p
					; DATA XREF: sub_10007350+113o	...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		test	esi, esi
		jz	short loc_10006383
		mov	eax, [esp+8+arg_8]
		test	eax, eax
		jnz	short loc_1000638B
		push	389h

loc_10006369:				; CODE XREF: sasl_getprop+1B7j
		push	offset aParameterErr_1 ; "Parameter error in common.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	dword ptr [esi+8F0h], 0FFFFFFF9h

loc_10006383:				; CODE XREF: sasl_getprop+Aj
		pop	edi
		mov	eax, 0FFFFFFF9h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000638B:				; CODE XREF: sasl_getprop+12j
		mov	ecx, [esp+8+arg_4]
		cmp	ecx, 66h	; switch 103 cases
		ja	loc_10006502	; jumptable 1000639F default case
		movzx	ecx, ds:byte_10006684[ecx]
		jmp	ds:off_10006624[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100063A6:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		add	esi, 878h	; jumptable 1000639F case 1

loc_100063AC:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	[eax], esi	; jumptable 1000639F case 4

loc_100063AE:				; CODE XREF: sasl_getprop+2A6j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100063B3:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		add	esi, 874h	; jumptable 1000639F case 2
		mov	[eax], esi
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100063C0:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	edx, [esi+8E0h]	; jumptable 1000639F case 7
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100063CD:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		cmp	[esi+10h], edi	; jumptable 1000639F case 8
		jz	short loc_100063DC
		add	esi, 18h
		mov	[eax], esi
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100063DC:				; CODE XREF: sasl_getprop+80j
					; sasl_getprop+96j
		mov	[eax], edi
		jmp	loc_100065D2
; ---------------------------------------------------------------------------

loc_100063E3:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		cmp	[esi+14h], edi	; jumptable 1000639F case 9
		jz	short loc_100063DC
		add	esi, 439h
		mov	[eax], esi
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100063F5:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	ecx, [esi+864h]	; jumptable 1000639F case 0
		test	ecx, ecx
		jz	loc_100065D2
		pop	edi
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000640A:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	ecx, [esi+868h]	; jumptable 1000639F case 16
		test	ecx, ecx
		jz	loc_100065D2
		pop	edi
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000641F:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		cmp	dword ptr [esi], 1 ; jumptable 1000639F	case 17
		jz	short loc_1000642E
		mov	edi, 0FFFFFFFBh
		jmp	loc_100065FC
; ---------------------------------------------------------------------------

loc_1000642E:				; CODE XREF: sasl_getprop+D2j
		mov	ecx, [esi+1134h]
		mov	edx, [ecx+4]
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000643E:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	ecx, [esi+8E8h]	; jumptable 1000639F case 13
		pop	edi
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000644B:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		cmp	dword ptr [esi], 1 ; jumptable 1000639F	case 3
		jz	short loc_1000645A
		mov	edi, 0FFFFFFFBh
		jmp	loc_100065FC
; ---------------------------------------------------------------------------

loc_1000645A:				; CODE XREF: sasl_getprop+FEj
		mov	edx, [esi+1124h]
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006467:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	ecx, [esi+8]	; jumptable 1000639F case 12
		pop	edi
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006471:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	ecx, [esi]	; jumptable 1000639F case 14
		cmp	ecx, 2
		jnz	short loc_10006490
		mov	ecx, [esi+1120h]
		test	ecx, ecx
		jz	loc_100065D2
		mov	edx, [ecx+4]
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006490:				; CODE XREF: sasl_getprop+126j
		cmp	ecx, 1
		jnz	short loc_10006502 ; jumptable 1000639F	default	case
		mov	ecx, [esi+1130h]
		test	ecx, ecx
		jz	loc_100065D2
		mov	ecx, [ecx+8]
		pop	edi
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100064AD:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	ecx, [esi]	; jumptable 1000639F case 15
		cmp	ecx, 2
		jnz	short loc_100064CB
		mov	ecx, [esi+1120h]
		test	ecx, ecx
		jz	loc_100065D2
		mov	edx, [ecx+8]
		mov	ecx, [edx]
		mov	[eax], ecx
		jmp	short loc_100064EC
; ---------------------------------------------------------------------------

loc_100064CB:				; CODE XREF: sasl_getprop+162j
		cmp	ecx, 1
		jnz	short loc_100064E7
		mov	ecx, [esi+1130h]
		test	ecx, ecx
		jz	loc_100065D2
		mov	edx, [ecx+0Ch]
		mov	ecx, [edx]
		mov	[eax], ecx
		jmp	short loc_100064EC
; ---------------------------------------------------------------------------

loc_100064E7:				; CODE XREF: sasl_getprop+17Ej
		mov	edi, 0FFFFFFF9h

loc_100064EC:				; CODE XREF: sasl_getprop+179j
					; sasl_getprop+195j
		cmp	dword ptr [eax], 0
		jnz	short loc_100064F9
		test	edi, edi
		jz	loc_100065D2

loc_100064F9:				; CODE XREF: sasl_getprop+19Fj
		cmp	edi, 0FFFFFFF9h
		jnz	loc_100065CD

loc_10006502:				; CODE XREF: sasl_getprop+42j
					; sasl_getprop+4Fj ...
		push	428h		; jumptable 1000639F default case
		jmp	loc_10006369
; ---------------------------------------------------------------------------

loc_1000650C:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	edx, [esi+8F4h]	; jumptable 1000639F case 10
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006519:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	ecx, [esi+88Ch]	; jumptable 1000639F case 11
		test	ecx, ecx
		jz	loc_100065D2
		pop	edi
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000652E:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	ecx, [esi+890h]	; jumptable 1000639F case 19
		test	ecx, ecx
		jz	loc_100065D2
		pop	edi
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006543:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		cmp	[esi+890h], edi	; jumptable 1000639F case 20
		jz	loc_100065D2
		mov	ecx, [esi+894h]
		pop	edi
		mov	[eax], ecx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000655C:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		add	esi, 8D0h	; jumptable 1000639F case 100
		mov	[eax], esi
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006569:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		mov	edx, [esi+8D4h]	; jumptable 1000639F case 102
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006576:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		add	esi, 8B8h	; jumptable 1000639F case 101
		mov	[eax], esi
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006583:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		cmp	dword ptr [esi], 2 ; jumptable 1000639F	case 18
		jnz	short loc_10006598
		mov	ecx, [esi+1124h]
		mov	edx, [ecx+4Ch]
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006598:				; CODE XREF: sasl_getprop+236j
		mov	ecx, [esi+1134h]
		mov	edx, [ecx+64h]
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100065A8:				; CODE XREF: sasl_getprop+4Fj
					; DATA XREF: .text:off_10006624o
		cmp	dword ptr [esi], 1 ; jumptable 1000639F	case 22
		jnz	short loc_100065BD
		mov	ecx, [esi+1134h]
		mov	edx, [ecx+6Ch]
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100065BD:				; CODE XREF: sasl_getprop+25Bj
		mov	ecx, [esi+1124h]
		mov	edx, [ecx+54h]
		pop	edi
		mov	[eax], edx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100065CD:				; CODE XREF: sasl_getprop+1ACj
		cmp	edi, 0FFFFFFFAh
		jnz	short loc_100065F4

loc_100065D2:				; CODE XREF: sasl_getprop+8Ej
					; sasl_getprop+ADj ...
		push	offset aInformationTha ; "Information that was requested is not	y"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		pop	edi
		mov	dword ptr [esi+8F0h], 0FFFFFFFAh
		mov	eax, 0FFFFFFFAh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100065F4:				; CODE XREF: sasl_getprop+280j
		test	edi, edi
		jz	loc_100063AE

loc_100065FC:				; CODE XREF: sasl_getprop+D9j
					; sasl_getprop+105j
		push	42Eh
		push	edi
		push	offset aInternalErrorD ; "Internal Error %d in common.c	near line"...
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 14h
		test	edi, edi
		jns	short loc_1000661C
		mov	[esi+8F0h], edi

loc_1000661C:				; CODE XREF: sasl_getprop+2C4j
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sasl_getprop	endp

; ---------------------------------------------------------------------------
		align 4
off_10006624	dd offset loc_100063F5,	offset loc_100063A6, offset loc_100063B3
					; DATA XREF: sasl_getprop+4Fr
		dd offset loc_1000644B,	offset loc_100063AC, offset loc_100063C0 ; jump	table for switch statement
		dd offset loc_100063CD,	offset loc_100063E3, offset loc_1000650C
		dd offset loc_10006519,	offset loc_10006467, offset loc_1000643E
		dd offset loc_10006471,	offset loc_100064AD, offset loc_1000640A
		dd offset loc_1000641F,	offset loc_10006583, offset loc_1000652E
		dd offset loc_10006543,	offset loc_100065A8, offset loc_1000655C
		dd offset loc_10006576,	offset loc_10006569, offset loc_10006502
byte_10006684	db	0,     1,     2,     3 ; DATA XREF: sasl_getprop+48r
		db	4,   17h,   17h,     5 ; indirect table	for switch statement
		db	6,     7,     8,     9
		db    0Ah,   0Bh,   0Ch,   0Dh
		db    0Eh,   0Fh,   10h,   11h
		db    12h,   17h,   13h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    14h,   15h,   16h
		align 10h
; Exported entry  67. sasl_setprop

; =============== S U B	R O U T	I N E =======================================


		public sasl_setprop
sasl_setprop	proc near		; CODE XREF: sub_100075A0+A7p
					; sub_100075A0+F0p
					; DATA XREF: ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ebx
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		xor	ebx, ebx
		mov	[esp+0Ch+var_4], ebx
		cmp	esi, ebx
		jnz	short loc_10006708
		pop	esi
		lea	eax, [ebx-7]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006708:				; CODE XREF: sasl_setprop+Fj
		mov	eax, [esp+0Ch+arg_4]
		add	eax, 0FFFFFFFDh	; switch 100 cases
		push	edi
		cmp	eax, 63h
		ja	loc_10006CFC	; jumptable 10006720 default case
		movzx	eax, ds:byte_10006D54[eax]
		jmp	ds:off_10006D28[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10006727:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		cmp	dword ptr [esi], 1 ; jumptable 10006720	case 100
		mov	ecx, [esp+10h+arg_8]
		mov	eax, [ecx]
		mov	[esi+8D0h], eax
		jnz	short loc_1000674A
		mov	edx, [esi+1134h]
		pop	edi
		pop	esi
		mov	[edx+54h], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000674A:				; CODE XREF: sasl_setprop+46j
		mov	ecx, [esi+1124h]
		pop	edi
		pop	esi
		mov	[ecx+48h], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000675C:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		mov	edx, [esp+10h+arg_8] ; jumptable 10006720 case 102
		cmp	edx, ebx
		jz	short loc_100067B6
		mov	eax, edx
		lea	edi, [eax+1]
		lea	esp, [esp+0]

loc_10006770:				; CODE XREF: sasl_setprop+85j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10006770
		sub	eax, edi
		jz	short loc_100067B6
		push	ebx
		lea	eax, [esp+14h+arg_0]
		push	eax
		push	edx
		call	sub_10004910
		add	esp, 0Ch
		mov	[esp+10h+var_4], eax
		cmp	eax, ebx
		jz	short loc_100067BA
		push	451h
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFFEh
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100067B6:				; CODE XREF: sasl_setprop+72j
					; sasl_setprop+89j
		xor	edi, edi
		jmp	short loc_100067BE
; ---------------------------------------------------------------------------

loc_100067BA:				; CODE XREF: sasl_setprop+A0j
		mov	edi, [esp+10h+arg_0]

loc_100067BE:				; CODE XREF: sasl_setprop+C8j
		mov	eax, [esi+8D4h]
		cmp	eax, ebx
		jz	short loc_100067D2
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_100067D2:				; CODE XREF: sasl_setprop+D6j
		mov	eax, [esp+10h+var_4]
		mov	[esi+8D4h], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100067E1:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		cmp	dword ptr [esi], 1 ; jumptable 10006720	case 3
		jz	short loc_1000680E
		push	offset aTriedToSetReal ; "Tried	to set realm on	non-server connec"...
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	[esp+10h+var_4], 0FFFFFFFBh
		mov	edx, [esp+10h+var_4]
		pop	edi
		mov	[esi+8F0h], edx
		pop	esi
		mov	eax, edx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000680E:				; CODE XREF: sasl_setprop+F4j
		mov	edx, [esp+10h+arg_8]
		cmp	edx, ebx
		jz	loc_10006896
		mov	eax, edx
		lea	edi, [eax+1]
		nop

loc_10006820:				; CODE XREF: sasl_setprop+135j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10006820
		sub	eax, edi
		jz	short loc_10006896
		push	ebx
		lea	ecx, [esp+14h+arg_0]
		push	ecx
		push	edx
		call	sub_10004910
		add	esp, 0Ch
		mov	[esp+10h+var_4], eax
		cmp	eax, ebx
		jz	short loc_10006866
		push	466h
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFFEh
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006866:				; CODE XREF: sasl_setprop+150j
		mov	eax, [esi+1124h]
		cmp	eax, ebx
		jz	short loc_1000687A
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_1000687A:				; CODE XREF: sasl_setprop+17Ej
		mov	eax, [esp+10h+arg_0]
		mov	edx, [esi+1134h]
		mov	[esi+1124h], eax
		pop	edi
		pop	esi
		mov	[edx+0Ch], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006896:				; CODE XREF: sasl_setprop+124j
					; sasl_setprop+139j
		push	468h
		push	offset aParameterErr_1 ; "Parameter error in common.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100068BB:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		mov	eax, [esp+10h+arg_8] ; jumptable 10006720 case 101
		cmp	[eax+8], ebx
		jnz	short loc_100068E7
		cmp	[eax], ebx
		jz	short loc_100068E7
		push	offset aAttemptToDisab ; "Attempt to disable security layers (max"...
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	eax, 0FFFFFFF1h
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100068E7:				; CODE XREF: sasl_setprop+1D2j
					; sasl_setprop+1D6j
		cmp	dword ptr [esi], 1
		mov	ecx, [eax]
		mov	[esi+8B8h], ecx
		mov	edx, [eax+4]
		mov	[esi+8BCh], edx
		mov	ecx, [eax+8]
		mov	[esi+8C0h], ecx
		mov	edx, [eax+0Ch]
		mov	[esi+8C4h], edx
		mov	ecx, [eax+10h]
		mov	[esi+8C8h], ecx
		mov	edx, [eax+14h]
		mov	[esi+8CCh], edx
		mov	ecx, [eax]
		jnz	short loc_10006953
		mov	esi, [esi+1134h]
		mov	[esi+3Ch], ecx
		mov	edx, [eax+4]
		mov	[esi+40h], edx
		mov	ecx, [eax+8]
		mov	[esi+44h], ecx
		mov	edx, [eax+0Ch]
		mov	[esi+48h], edx
		mov	ecx, [eax+10h]
		mov	[esi+4Ch], ecx
		mov	edx, [eax+14h]
		mov	eax, [esp+10h+var_4]
		pop	edi
		mov	[esi+50h], edx
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006953:				; CODE XREF: sasl_setprop+231j
		mov	esi, [esi+1124h]
		mov	[esi+30h], ecx
		mov	edx, [eax+4]
		mov	[esi+34h], edx
		mov	ecx, [eax+8]
		mov	[esi+38h], ecx
		mov	edx, [eax+0Ch]
		mov	[esi+3Ch], edx
		mov	ecx, [eax+10h]
		mov	[esi+40h], ecx
		mov	edx, [eax+14h]
		mov	eax, [esp+10h+var_4]
		pop	edi
		mov	[esi+44h], edx
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006983:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		mov	edi, [esp+10h+arg_8] ; jumptable 10006720 case 9
		cmp	edi, ebx
		jnz	short loc_10006990
		mov	[esi+14h], ebx
		jmp	short loc_100069C5
; ---------------------------------------------------------------------------

loc_10006990:				; CODE XREF: sasl_setprop+299j
		push	ebx
		push	ebx
		push	edi
		call	sub_100057B0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100069A9
		push	offset aBadIpremotepor ; "Bad IPREMOTEPORT value"
		jmp	loc_10006AA0
; ---------------------------------------------------------------------------

loc_100069A9:				; CODE XREF: sasl_setprop+2ADj
		mov	edx, esi
		mov	eax, edi
		sub	edx, edi
		nop

loc_100069B0:				; CODE XREF: sasl_setprop+2CCj
		mov	cl, [eax]
		mov	[edx+eax+439h],	cl
		inc	eax
		cmp	cl, bl
		jnz	short loc_100069B0
		mov	dword ptr [esi+14h], 1

loc_100069C5:				; CODE XREF: sasl_setprop+29Ej
		mov	eax, [esi]
		cmp	[esi+14h], ebx
		jz	short loc_10006A3B
		cmp	eax, 2
		jnz	short loc_100069FE
		mov	edx, [esi+1124h]
		lea	eax, [esi+439h]
		mov	[edx+18h], eax
		lea	edx, [eax+1]

loc_100069E3:				; CODE XREF: sasl_setprop+2F8j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_100069E3
		mov	ecx, [esi+1124h]
		pop	edi
		sub	eax, edx
		pop	esi
		mov	[ecx+2Ch], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100069FE:				; CODE XREF: sasl_setprop+2DFj
		cmp	eax, 1
		jnz	loc_10006D1D
		mov	edx, [esi+1134h]
		lea	eax, [esi+439h]
		mov	[edx+14h], eax
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_10006A20:				; CODE XREF: sasl_setprop+335j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10006A20
		mov	ecx, [esi+1134h]
		pop	edi
		sub	eax, edx
		pop	esi
		mov	[ecx+2Ch], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006A3B:				; CODE XREF: sasl_setprop+2DAj
		cmp	eax, 2
		jnz	short loc_10006A5B
		mov	edx, [esi+1124h]
		mov	[edx+18h], ebx
		mov	eax, [esi+1124h]
		pop	edi
		mov	[eax+2Ch], ebx
		mov	eax, [esp+0Ch+var_4]
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006A5B:				; CODE XREF: sasl_setprop+34Ej
		cmp	eax, 1
		jnz	loc_10006D1D
		mov	ecx, [esi+1134h]
		mov	eax, [esp+10h+var_4]
		mov	[ecx+14h], ebx
		mov	edx, [esi+1134h]
		pop	edi
		pop	esi
		mov	[edx+2Ch], ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006A7F:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		mov	edi, [esp+10h+arg_8] ; jumptable 10006720 case 8
		cmp	edi, ebx
		jnz	short loc_10006A8C
		mov	[esi+10h], ebx
		jmp	short loc_10006AD2
; ---------------------------------------------------------------------------

loc_10006A8C:				; CODE XREF: sasl_setprop+395j
		push	ebx
		push	ebx
		push	edi
		call	sub_100057B0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10006ABA
		push	offset aBadIplocalport ; "Bad IPLOCALPORT value"

loc_10006AA0:				; CODE XREF: sasl_setprop+2B4j
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	eax, 0FFFFFFF9h
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006ABA:				; CODE XREF: sasl_setprop+3A9j
		mov	edx, esi
		mov	eax, edi
		sub	edx, edi

loc_10006AC0:				; CODE XREF: sasl_setprop+3D9j
		mov	cl, [eax]
		mov	[edx+eax+18h], cl
		inc	eax
		cmp	cl, bl
		jnz	short loc_10006AC0
		mov	dword ptr [esi+10h], 1

loc_10006AD2:				; CODE XREF: sasl_setprop+39Aj
		mov	eax, [esi]
		cmp	[esi+10h], ebx
		jz	short loc_10006B3E
		cmp	eax, 2
		jnz	short loc_10006B0B
		mov	edx, [esi+1124h]
		lea	eax, [esi+18h]
		mov	[edx+14h], eax
		lea	edx, [eax+1]
		lea	ecx, [ecx+0]

loc_10006AF0:				; CODE XREF: sasl_setprop+405j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10006AF0
		mov	ecx, [esi+1124h]
		pop	edi
		sub	eax, edx
		pop	esi
		mov	[ecx+28h], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006B0B:				; CODE XREF: sasl_setprop+3ECj
		cmp	eax, 1
		jnz	loc_10006D1D
		mov	edx, [esi+1134h]
		lea	eax, [esi+18h]
		mov	[edx+10h], eax
		lea	edx, [eax+1]

loc_10006B23:				; CODE XREF: sasl_setprop+438j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10006B23
		mov	ecx, [esi+1134h]
		pop	edi
		sub	eax, edx
		pop	esi
		mov	[ecx+28h], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006B3E:				; CODE XREF: sasl_setprop+3E7j
		cmp	eax, 2
		jnz	short loc_10006B5E
		mov	edx, [esi+1124h]
		mov	[edx+14h], ebx
		mov	eax, [esi+1124h]
		pop	edi
		mov	[eax+28h], ebx
		mov	eax, [esp+0Ch+var_4]
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006B5E:				; CODE XREF: sasl_setprop+451j
		cmp	eax, 1
		jnz	loc_10006D1D
		mov	ecx, [esi+1134h]
		mov	eax, [esp+10h+var_4]
		mov	[ecx+10h], ebx
		mov	edx, [esi+1134h]
		pop	edi
		pop	esi
		mov	[edx+28h], ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006B82:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		cmp	dword ptr [esi], 1 ; jumptable 10006720	case 17
		jz	short loc_10006BAF
		push	offset aTriedToSetAppl ; "Tried	to set application name	on non-se"...
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	[esp+10h+var_4], 0FFFFFFFBh
		mov	edx, [esp+10h+var_4]
		pop	edi
		mov	[esi+8F0h], edx
		pop	esi
		mov	eax, edx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006BAF:				; CODE XREF: sasl_setprop+495j
		mov	eax, [esi+1120h]
		lea	edi, [esi+1120h]
		cmp	eax, ebx
		jz	short loc_10006BCB
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	[edi], ebx

loc_10006BCB:				; CODE XREF: sasl_setprop+4CDj
		mov	edx, [esp+10h+arg_8]
		cmp	edx, ebx
		jz	short loc_10006C4E
		mov	eax, edx
		push	ebp
		lea	ebp, [eax+1]
		lea	esp, [esp+0]

loc_10006BE0:				; CODE XREF: sasl_setprop+4F5j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10006BE0
		sub	eax, ebp
		pop	ebp
		jz	short loc_10006C4E
		push	ebx
		push	edi
		push	edx
		call	sub_10004910
		add	esp, 0Ch
		mov	[esp+10h+var_4], eax
		cmp	eax, ebx
		jz	short loc_10006C23
		push	4EBh
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFFEh
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006C23:				; CODE XREF: sasl_setprop+50Dj
		mov	eax, [esi+1134h]
		mov	ecx, [edi]
		mov	[eax+4], ecx
		mov	eax, [edi]
		lea	edx, [eax+1]

loc_10006C33:				; CODE XREF: sasl_setprop+548j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10006C33
		sub	eax, edx
		mov	edx, [esi+1134h]
		pop	edi
		pop	esi
		mov	[edx+1Ch], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006C4E:				; CODE XREF: sasl_setprop+4E1j
					; sasl_setprop+4FAj
		mov	eax, [esi+1134h]
		mov	[eax+4], ebx
		mov	ecx, [esi+1134h]
		mov	eax, [esp+10h+var_4]
		pop	edi
		pop	esi
		mov	[ecx+1Ch], ebx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006C69:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		cmp	dword ptr [esi], 2 ; jumptable 10006720	case 18
		jnz	short loc_10006C84
		mov	edx, [esi+1124h]
		mov	eax, [esp+10h+arg_8]
		pop	edi
		pop	esi
		mov	[edx+4Ch], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006C84:				; CODE XREF: sasl_setprop+57Cj
		mov	ecx, [esi+1134h]
		mov	edx, [esp+10h+arg_8]
		mov	eax, [esp+10h+var_4]
		pop	edi
		pop	esi
		mov	[ecx+64h], edx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006C9A:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		cmp	dword ptr [esi], 1 ; jumptable 10006720	case 21
		jnz	short loc_10006CB5
		mov	eax, [esi+1134h]
		mov	ecx, [esp+10h+arg_8]
		pop	edi
		pop	esi
		mov	[eax+68h], ecx
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006CB5:				; CODE XREF: sasl_setprop+5ADj
		mov	edx, [esi+1124h]
		mov	eax, [esp+10h+arg_8]
		pop	edi
		pop	esi
		mov	[edx+50h], eax
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006CCB:				; CODE XREF: sasl_setprop+30j
					; DATA XREF: .text:off_10006D28o
		cmp	dword ptr [esi], 1 ; jumptable 10006720	case 22
		jnz	short loc_10006CE6
		mov	ecx, [esi+1134h]
		mov	edx, [esp+10h+arg_8]
		mov	eax, [esp+10h+var_4]
		pop	edi
		pop	esi
		mov	[ecx+6Ch], edx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006CE6:				; CODE XREF: sasl_setprop+5DEj
		mov	eax, [esi+1124h]
		mov	ecx, [esp+10h+arg_8]
		pop	edi
		pop	esi
		mov	[eax+54h], ecx
		mov	eax, [esp+8+var_4]
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10006CFC:				; CODE XREF: sasl_setprop+23j
					; sasl_setprop+30j
					; DATA XREF: ...
		push	offset aUnknownParamet ; jumptable 10006720 default case
		push	ebx
		push	esi
		call	sasl_seterror
		mov	[esp+1Ch+var_4], 0FFFFFFF9h
		mov	edx, [esp+1Ch+var_4]
		add	esp, 0Ch
		mov	[esi+8F0h], edx

loc_10006D1D:				; CODE XREF: sasl_setprop+311j
					; sasl_setprop+36Ej ...
		mov	eax, [esp+10h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		retn
sasl_setprop	endp

; ---------------------------------------------------------------------------
		align 4
off_10006D28	dd offset loc_100067E1,	offset loc_10006A7F, offset loc_10006983
					; DATA XREF: sasl_setprop+30r
		dd offset loc_10006B82,	offset loc_10006C69, offset loc_10006C9A ; jump	table for switch statement
		dd offset loc_10006CCB,	offset loc_10006727, offset loc_100068BB
		dd offset loc_1000675C,	offset loc_10006CFC
byte_10006D54	db	0,   0Ah,   0Ah,   0Ah ; DATA XREF: sasl_setprop+29r
		db    0Ah,     1,     2,   0Ah ; indirect table	for switch statement
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,     3,     4
		db    0Ah,   0Ah,     5,     6
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,   0Ah,   0Ah,   0Ah
		db    0Ah,     7,     8,     9
		align 10h
; Exported entry  43. sasl_errdetail

; =============== S U B	R O U T	I N E =======================================


		public sasl_errdetail
sasl_errdetail	proc near		; DATA XREF: .rdata:off_1002C568o

var_84		= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 84h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+84h+var_4], eax
		push	esi
		mov	esi, [esp+88h+arg_0]
		test	esi, esi
		jnz	short loc_10006DF8
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+84h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
; ---------------------------------------------------------------------------

loc_10006DF8:				; CODE XREF: sasl_errdetail+1Ej
		mov	eax, [esi+8F0h]
		push	0
		push	0
		push	eax
		call	sasl_errstring
		mov	ecx, [esi+8F0h]
		add	esp, 0Ch
		cmp	ecx, 0FFFFFFECh
		jnz	short loc_10006E1B
		mov	ecx, 0FFFFFFF3h

loc_10006E1B:				; CODE XREF: sasl_errdetail+54j
		push	eax
		push	ecx
		push	offset aSaslDS	; "SASL(%d): %s: "
		lea	ecx, [esp+94h+var_84]
		push	80h
		push	ecx
		call	sub_1000FA78
		lea	eax, [esp+9Ch+var_84]
		add	esp, 14h
		lea	edx, [eax+1]
		jmp	short loc_10006E40
; ---------------------------------------------------------------------------
		align 10h

loc_10006E40:				; CODE XREF: sasl_errdetail+7Bj
					; sasl_errdetail+85j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10006E40
		sub	eax, edx
		push	ebx
		mov	edx, eax
		mov	eax, [esi+8F4h]
		push	edi
		lea	edi, [eax+1]

loc_10006E56:				; CODE XREF: sasl_errdetail+9Bj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10006E56
		sub	eax, edi
		lea	ebx, [eax+edx+0Ch]
		push	ebx
		lea	edx, [esi+900h]
		push	edx
		lea	edi, [esi+8F8h]
		push	edi
		call	sub_10005640
		mov	eax, [esi+8F4h]
		mov	edx, [edi]
		push	eax
		lea	ecx, [esp+0A0h+var_84]
		push	ecx
		push	offset aSS	; "%s%s"
		push	ebx
		push	edx
		call	sub_1000FA78
		mov	eax, [edi]
		mov	ecx, [esp+0B0h+var_4]
		add	esp, 20h
		pop	edi
		pop	ebx
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 84h
		retn
sasl_errdetail	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006EB0	proc near		; DATA XREF: .data:off_1002D058o

arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		test	esi, esi
		jnz	short loc_10006EC0
		mov	eax, 0FFFFFFF9h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006EC0:				; CODE XREF: sub_10006EB0+7j
		mov	eax, dword_1002E4B0
		test	eax, eax
		jnz	short loc_10006EDD
		mov	eax, offset aCCmuBinSasl2 ; "C:\\CMU\\bin\\sasl2"
		mov	ecx, offset ValueName ;	"SearchPath"
		call	sub_10005C20
		mov	dword_1002E4B0,	eax

loc_10006EDD:				; CODE XREF: sub_10006EB0+17j
		mov	[esi], eax
		xor	eax, eax
		pop	esi
		retn
sub_10006EB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006EF0	proc near		; DATA XREF: .data:off_1002D064o

arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		test	esi, esi
		jnz	short loc_10006F00
		mov	eax, 0FFFFFFF9h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10006F00:				; CODE XREF: sub_10006EF0+7j
		mov	eax, dword_1002E4B4
		test	eax, eax
		jnz	short loc_10006F1D
		mov	eax, offset aCCmuBinSasl2 ; "C:\\CMU\\bin\\sasl2"
		mov	ecx, offset aConffile ;	"ConfFile"
		call	sub_10005C20
		mov	dword_1002E4B4,	eax

loc_10006F1D:				; CODE XREF: sub_10006EF0+17j
		mov	[esi], eax
		xor	eax, eax
		pop	esi
		retn
sub_10006EF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006F30	proc near		; CODE XREF: sasl_auxprop_add_plugin+48p
					; sub_100019F0+262p ...

var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [esp+44h+arg_0]
		push	ebx
		push	ebp
		push	edi
		push	0FAh
		mov	[esp+54h+var_34], eax
		call	off_1002D044
		mov	ebp, eax
		mov	eax, [esp+54h+arg_8]
		xor	edi, edi
		add	esp, 4
		xor	ebx, ebx
		mov	[esp+50h+var_40], ebp
		mov	[esp+50h+var_3C], 64h
		mov	[esp+50h+var_44], edi
		test	eax, eax
		jz	loc_100072AD
		test	ebp, ebp
		jz	loc_100072BB
		lea	edx, [eax+1]

loc_10006F84:				; CODE XREF: sub_10006F30+59j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10006F84
		push	esi
		sub	eax, edx
		lea	ecx, [esp+54h+var_2C]
		push	ecx
		lea	edx, [esp+58h+var_34]
		push	edx
		mov	esi, eax
		mov	eax, [esp+5Ch+var_34]
		push	2
		push	eax
		mov	[esp+64h+var_30], esi
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	loc_100072AC
		cmp	[esp+54h+var_34], ebx
		jz	loc_100072AC
		lea	ebp, [esp+54h+arg_C]
		test	esi, esi
		jz	loc_10007273
		jmp	short loc_10006FD0
; ---------------------------------------------------------------------------
		align 10h

loc_10006FD0:				; CODE XREF: sub_10006F30+9Bj
					; sub_10006F30+33Dj
		mov	ecx, [esp+54h+arg_8]
		cmp	byte ptr [ebx+ecx], 25h
		jz	short loc_10007012
		lea	esi, [edi+1]
		push	esi
		lea	edx, [esp+58h+var_3C]
		push	edx
		lea	eax, [esp+5Ch+var_40]
		push	eax
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_100072A8
		mov	ecx, [esp+54h+arg_8]
		mov	dl, [ebx+ecx]
		mov	eax, [esp+54h+var_40]
		mov	[edi+eax], dl
		mov	edi, esi
		mov	[esp+54h+var_44], edi
		inc	ebx
		jmp	loc_10007269
; ---------------------------------------------------------------------------

loc_10007012:				; CODE XREF: sub_10006F30+A8j
		xor	ecx, ecx
		inc	ebx
		lea	esi, [ecx+1]
		mov	[esp+54h+var_28], 25h
		mov	[esp+54h+var_38], ebx

loc_10007021:				; CODE XREF: sub_10006F30+333j
		mov	edx, [esp+54h+arg_8]
		mov	al, [ebx+edx]
		movsx	edx, al
		add	edx, 0FFFFFFDBh	; switch 86 cases
		cmp	edx, 55h
		ja	loc_10007242	; jumptable 1000703E default case
		movzx	edx, ds:byte_100072F0[edx]
		jmp	ds:off_100072D0[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10007045:				; CODE XREF: sub_10006F30+10Ej
					; DATA XREF: .text:off_100072D0o
		mov	eax, [ebp+0]	; jumptable 1000703E case 115
		add	ebp, 4
		push	eax
		lea	ecx, [esp+58h+var_44]
		push	ecx
		lea	edx, [esp+5Ch+var_3C]
		push	edx
		lea	eax, [esp+60h+var_40]
		push	eax

loc_1000705B:				; CODE XREF: sub_10006F30+214j
		call	sub_10005DE0
		add	esp, 10h
		test	eax, eax
		jnz	loc_100072A8
		mov	edi, [esp+54h+var_44]
		jmp	loc_10007251
; ---------------------------------------------------------------------------

loc_10007074:				; CODE XREF: sub_10006F30+10Ej
					; DATA XREF: .text:off_100072D0o
		lea	ebx, [edi+1]	; jumptable 1000703E case 37
		push	ebx
		lea	ecx, [esp+58h+var_3C]
		push	ecx
		lea	edx, [esp+5Ch+var_40]
		push	edx
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_100072A8
		mov	eax, [esp+54h+var_40]
		mov	byte ptr [edi+eax], 25h
		mov	edi, ebx
		mov	ebx, [esp+54h+var_38]
		mov	[esp+54h+var_44], edi
		jmp	loc_10007251
; ---------------------------------------------------------------------------

loc_100070A9:				; CODE XREF: sub_10006F30+10Ej
					; DATA XREF: .text:off_100072D0o
		mov	ecx, [ebp+0]	; jumptable 1000703E case 109
		add	ebp, 4
		push	ecx
		call	sub_1000FB67
		push	eax
		lea	edx, [esp+5Ch+var_44]
		push	edx
		lea	eax, [esp+60h+var_3C]
		push	eax
		lea	ecx, [esp+64h+var_40]
		push	ecx
		call	sub_10005DE0
		add	esp, 14h
		test	eax, eax
		jnz	loc_100072A8
		mov	edi, [esp+54h+var_44]
		jmp	loc_10007251
; ---------------------------------------------------------------------------

loc_100070DE:				; CODE XREF: sub_10006F30+10Ej
					; DATA XREF: .text:off_100072D0o
		mov	edx, [ebp+0]	; jumptable 1000703E case 122
		push	0
		add	ebp, 4
		push	0
		push	edx
		call	sasl_errstring
		push	eax
		lea	eax, [esp+64h+var_44]
		push	eax
		lea	ecx, [esp+68h+var_3C]
		push	ecx
		lea	edx, [esp+6Ch+var_40]
		push	edx
		call	sub_10005DE0
		add	esp, 1Ch
		test	eax, eax
		jnz	loc_100072A8
		mov	edi, [esp+54h+var_44]
		jmp	loc_10007251
; ---------------------------------------------------------------------------

loc_10007117:				; CODE XREF: sub_10006F30+10Ej
					; DATA XREF: .text:off_100072D0o
		mov	[esp+esi+54h+var_28], al ; jumptable 1000703E case 99
		mov	al, [ebp+0]
		inc	esi
		add	ebp, 4
		lea	ecx, [esp+54h+var_1C]
		push	ecx
		lea	edx, [esp+58h+var_44]
		mov	[esp+58h+var_1C], al
		push	edx
		lea	eax, [esp+5Ch+var_3C]
		push	eax
		lea	ecx, [esp+60h+var_40]
		mov	[esp+esi+60h+var_28], 0
		mov	[esp+60h+var_1B], 0
		push	ecx
		jmp	loc_1000705B
; ---------------------------------------------------------------------------

loc_10007149:				; CODE XREF: sub_10006F30+10Ej
					; DATA XREF: .text:off_100072D0o
		mov	edx, [ebp+0]	; jumptable 1000703E cases 100,105
		mov	[esp+esi+54h+var_28], al
		add	ebp, 4
		push	edx
		lea	eax, [esp+58h+var_28]
		push	eax
		lea	ecx, [esp+5Ch+var_1C]
		push	14h
		inc	esi
		push	ecx
		mov	[esp+esi+64h+var_28], 0
		call	sub_1000FA78
		lea	eax, [esp+64h+var_1C]
		add	esp, 10h
		lea	edx, [eax+1]

loc_10007175:				; CODE XREF: sub_10006F30+24Aj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10007175
		sub	eax, edx
		mov	ebx, eax
		lea	eax, [ebx+edi]
		push	eax
		lea	edx, [esp+58h+var_3C]
		mov	[esp+58h+var_44], eax
		push	edx
		lea	eax, [esp+5Ch+var_40]
		push	eax
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_100072A8
		add	edi, [esp+54h+var_40]
		push	ebx
		lea	ecx, [esp+58h+var_1C]
		push	ecx
		push	edi
		call	sub_1000EFE0
		mov	edi, [esp+60h+var_44]
		mov	ebx, [esp+60h+var_38]
		add	esp, 0Ch
		mov	[esp+54h+var_44], edi
		jmp	loc_10007251
; ---------------------------------------------------------------------------

loc_100071C6:				; CODE XREF: sub_10006F30+10Ej
					; DATA XREF: .text:off_100072D0o
		mov	[esp+esi+54h+var_28], al ; jumptable 1000703E cases 88,111,117,120
		mov	eax, [ebp+0]
		add	ebp, 4
		push	eax
		lea	ecx, [esp+58h+var_28]
		push	ecx
		lea	edx, [esp+5Ch+var_1C]
		push	14h
		inc	esi
		push	edx
		mov	[esp+esi+64h+var_28], 0
		call	sub_1000FA78
		lea	eax, [esp+64h+var_1C]
		add	esp, 10h
		lea	edx, [eax+1]

loc_100071F2:				; CODE XREF: sub_10006F30+2C7j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100071F2
		sub	eax, edx
		mov	ebx, eax
		lea	eax, [ebx+edi]
		push	eax
		mov	[esp+58h+var_44], eax
		lea	eax, [esp+58h+var_3C]
		push	eax
		lea	ecx, [esp+5Ch+var_40]
		push	ecx
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_100072A8
		mov	eax, [esp+54h+var_40]
		push	ebx
		lea	edx, [esp+58h+var_1C]
		push	edx
		add	edi, eax
		push	edi
		call	sub_1000EFE0
		mov	edi, [esp+60h+var_44]
		mov	ebx, [esp+60h+var_38]
		add	esp, 0Ch
		mov	[esp+54h+var_44], edi
		jmp	short loc_10007251
; ---------------------------------------------------------------------------

loc_10007242:				; CODE XREF: sub_10006F30+101j
					; sub_10006F30+10Ej
					; DATA XREF: ...
		mov	[esp+esi+54h+var_28], al ; jumptable 1000703E default case
		inc	esi
		mov	[esp+esi+54h+var_28], 0
		cmp	esi, 9
		jle	short loc_10007256

loc_10007251:				; CODE XREF: sub_10006F30+13Fj
					; sub_10006F30+174j ...
		mov	ecx, 1

loc_10007256:				; CODE XREF: sub_10006F30+31Fj
		inc	ebx
		mov	[esp+54h+var_38], ebx
		cmp	ebx, [esp+54h+var_30]
		ja	short loc_10007273
		test	ecx, ecx
		jz	loc_10007021

loc_10007269:				; CODE XREF: sub_10006F30+DDj
		cmp	ebx, [esp+54h+var_30]
		jb	loc_10006FD0

loc_10007273:				; CODE XREF: sub_10006F30+95j
					; sub_10006F30+32Fj
		lea	ecx, [edi+1]
		push	ecx
		lea	edx, [esp+58h+var_3C]
		push	edx
		lea	eax, [esp+5Ch+var_40]
		push	eax
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100072A8
		mov	ebp, [esp+54h+var_40]
		mov	ecx, [esp+54h+arg_4]
		mov	edx, [esp+54h+var_2C]
		push	ebp
		push	ecx
		push	edx
		mov	[edi+ebp], al
		call	[esp+60h+var_34]
		add	esp, 0Ch
		jmp	short loc_100072AC
; ---------------------------------------------------------------------------

loc_100072A8:				; CODE XREF: sub_10006F30+C2j
					; sub_10006F30+135j ...
		mov	ebp, [esp+54h+var_40]

loc_100072AC:				; CODE XREF: sub_10006F30+7Fj
					; sub_10006F30+89j ...
		pop	esi

loc_100072AD:				; CODE XREF: sub_10006F30+43j
		test	ebp, ebp
		jz	short loc_100072BB
		push	ebp		; lpMem
		call	off_1002D050
		add	esp, 4

loc_100072BB:				; CODE XREF: sub_10006F30+4Bj
					; sub_10006F30+37Fj
		mov	ecx, [esp+50h+var_4]
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
sub_10006F30	endp

; ---------------------------------------------------------------------------
		align 10h
off_100072D0	dd offset loc_10007074,	offset loc_100071C6, offset loc_10007117
					; DATA XREF: sub_10006F30+10Er
		dd offset loc_10007149,	offset loc_100070A9, offset loc_10007045 ; jump	table for switch statement
		dd offset loc_100070DE,	offset loc_10007242
byte_100072F0	db	0,     7,     7,     7 ; DATA XREF: sub_10006F30+107r
		db	7,     7,     7,     7 ; indirect table	for switch statement
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     1
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     2,     3
		db	7,     7,     7,     7
		db	3,     7,     7,     7
		db	4,     7,     1,     7
		db	7,     7,     5,     7
		db	1,     7,     7,     1
		db	7,     6
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007350	proc near		; CODE XREF: .text:10003057p
					; sasl_client_init+9Cp	...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		push	0C4h
		call	off_1002D044
		mov	esi, eax
		xor	ebx, ebx
		add	esp, 4
		cmp	esi, ebx
		jnz	short loc_1000736D
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000736D:				; CODE XREF: sub_10007350+16j
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		lea	eax, [esi+8]
		push	eax
		mov	[esi+4], edi
		call	sasl_randcreate
		add	esp, 4
		cmp	edi, ebx
		jz	short loc_10007391
		mov	dword ptr [esi+10h], offset sub_10005070
		mov	[esi+0Ch], edi
		jmp	short loc_1000739F
; ---------------------------------------------------------------------------

loc_10007391:				; CODE XREF: sub_10007350+33j
		mov	ecx, [esp+0Ch+arg_4]
		mov	dword ptr [esi+10h], offset loc_10004FE0
		mov	[esi+0Ch], ecx

loc_1000739F:				; CODE XREF: sub_10007350+3Fj
		mov	edx, off_1002D044
		mov	[esi+14h], edx
		mov	eax, off_1002D048
		mov	[esi+18h], eax
		mov	ecx, off_1002D04C
		mov	[esi+1Ch], ecx
		mov	edx, off_1002D050
		mov	[esi+20h], edx
		mov	eax, off_1002D06C
		mov	[esi+24h], eax
		mov	ecx, off_1002D070
		mov	[esi+28h], ecx
		mov	edx, off_1002D074
		mov	[esi+2Ch], edx
		mov	eax, off_1002D078
		mov	[esi+30h], eax
		pop	edi
		mov	[esi+64h], ebx
		mov	[esi+88h], ebx
		mov	[esi+0C0h], ebx
		mov	[esi+0BCh], ebx
		mov	dword ptr [esi+34h], offset sub_100080C0
		mov	dword ptr [esi+38h], offset sub_10008900
		mov	dword ptr [esi+3Ch], offset sub_100089C0
		mov	dword ptr [esi+40h], offset sub_10008CC0
		mov	dword ptr [esi+44h], offset sub_10008AA0
		mov	dword ptr [esi+48h], offset loc_10008C90
		mov	dword ptr [esi+4Ch], offset sub_10008C00
		mov	dword ptr [esi+50h], offset sub_100081B0
		mov	dword ptr [esi+54h], offset sasl_mkchal
		mov	dword ptr [esi+58h], offset sasl_utf8verify
		mov	dword ptr [esi+5Ch], offset sasl_rand
		mov	dword ptr [esi+60h], offset sasl_churn
		mov	dword ptr [esi+6Ch], offset sasl_encode64
		mov	dword ptr [esi+68h], offset sasl_decode64
		mov	dword ptr [esi+70h], offset sasl_erasebuffer
		mov	dword ptr [esi+74h], offset sasl_getprop
		mov	dword ptr [esi+78h], offset sasl_setprop
		mov	dword ptr [esi+7Ch], offset sub_10005310
		mov	dword ptr [esi+80h], offset sub_10006F30
		mov	dword ptr [esi+84h], offset sasl_seterror
		mov	dword ptr [esi+8Ch], offset prop_new
		mov	dword ptr [esi+90h], offset prop_dup
		mov	dword ptr [esi+94h], offset prop_request
		mov	dword ptr [esi+98h], offset prop_get
		mov	dword ptr [esi+9Ch], offset prop_getnames
		mov	dword ptr [esi+0A0h], offset prop_clear
		mov	dword ptr [esi+0A4h], offset prop_dispose
		mov	dword ptr [esi+0A8h], offset prop_format
		mov	dword ptr [esi+0ACh], offset prop_set
		mov	dword ptr [esi+0B0h], offset prop_setvals
		mov	dword ptr [esi+0B4h], offset prop_erase
		mov	dword ptr [esi+0B8h], offset sasl_auxprop_store
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_10007350	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  39. sasl_encode

; =============== S U B	R O U T	I N E =======================================


		public sasl_encode
sasl_encode	proc near		; DATA XREF: .rdata:off_1002C568o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 8
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		test	esi, esi
		jnz	short loc_10007524
		lea	eax, [esi-7]
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10007524:				; CODE XREF: sasl_encode+Aj
		push	edi
		mov	edi, [esp+10h+arg_4]
		test	edi, edi
		jz	short loc_1000756F
		mov	edx, [esp+10h+arg_8]
		test	edx, edx
		jz	short loc_1000756F
		mov	ecx, [esp+10h+arg_C]
		test	ecx, ecx
		jz	short loc_1000756F
		mov	eax, [esp+10h+arg_10]
		test	eax, eax
		jz	short loc_1000756F
		push	eax
		push	ecx
		push	1
		lea	eax, [esp+1Ch+var_8]
		push	eax
		push	esi
		mov	[esp+24h+var_4], edi
		mov	[esp+24h+var_8], edx
		call	sasl_encodev
		add	esp, 14h
		test	eax, eax
		jns	short loc_1000758F
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000756F:				; CODE XREF: sasl_encode+1Bj
					; sasl_encode+23j ...
		push	128h
		push	offset aParameterErr_1 ; "Parameter error in common.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		mov	eax, 0FFFFFFF9h
		add	esp, 10h
		mov	[esi+8F0h], eax

loc_1000758F:				; CODE XREF: sasl_encode+51j
		pop	edi
		pop	esi
		add	esp, 8
		retn
sasl_encode	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100075A0	proc near		; CODE XREF: sasl_client_new+149p
					; sasl_server_new+105p

var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
name		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h

		sub	esp, 40Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+40Ch+var_4], eax
		mov	eax, [esp+40Ch+arg_14]
		mov	edx, [esp+40Ch+arg_C]
		mov	ecx, [esp+40Ch+arg_1C]
		push	ebx
		push	ebp
		mov	ebp, [esp+414h+arg_18]
		push	esi
		mov	esi, [esp+418h+arg_0]
		push	edi
		mov	edi, [esp+41Ch+arg_4]
		mov	[esp+41Ch+var_40C], eax
		mov	eax, edi
		mov	[esi], edx
		mov	[esp+41Ch+var_408], ecx
		lea	edx, [eax+1]

loc_100075F1:				; CODE XREF: sub_100075A0+56j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100075F1
		sub	eax, edx
		inc	eax
		push	eax
		call	off_1002D044
		xor	ebx, ebx
		add	esp, 4
		mov	[esi+8], eax
		cmp	eax, ebx
		jz	short loc_10007664
		mov	ecx, edi
		mov	edx, eax

loc_10007612:				; CODE XREF: sub_100075A0+7Aj
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_10007612
		push	58h
		lea	eax, [esi+860h]
		push	ebx
		push	eax
		call	sub_1000E0F0
		mov	ecx, [esp+428h+arg_8]
		xor	eax, eax
		push	ebp
		mov	[esi+8D0h], eax
		push	8
		mov	[esi+8D4h], eax
		push	esi
		mov	[esi+0Ch], ecx
		call	sasl_setprop
		add	esp, 18h
		cmp	eax, ebx
		jz	short loc_10007688

loc_10007653:				; CODE XREF: sub_100075A0+FAj
		jge	loc_10007844
		mov	[esi+8F0h], eax
		jmp	loc_10007844
; ---------------------------------------------------------------------------

loc_10007664:				; CODE XREF: sub_100075A0+6Cj
		push	2DEh
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	ebx
		push	esi
		call	sasl_seterror
		mov	eax, 0FFFFFFFEh
		add	esp, 10h
		mov	[esi+8F0h], eax
		jmp	loc_10007844
; ---------------------------------------------------------------------------

loc_10007688:				; CODE XREF: sub_100075A0+B1j
		mov	edx, [esp+41Ch+var_408]
		push	edx
		push	9
		push	esi
		call	sasl_setprop
		add	esp, 0Ch
		cmp	eax, ebx
		jnz	short loc_10007653
		mov	eax, [esp+41Ch+arg_10]
		mov	ecx, [esp+41Ch+arg_20]
		mov	edx, [esp+41Ch+arg_24]
		mov	[esi+8DCh], eax
		xor	eax, eax
		mov	[esi+8ECh], ebx
		mov	[esi+85Ch], ebx
		mov	[esi+8D8h], ebx
		mov	[esi+8E0h], ecx
		mov	[esi+8E4h], edx
		mov	[esi+8B8h], eax
		mov	[esi+8BCh], eax
		mov	[esi+8C0h], eax
		mov	[esi+8C4h], eax
		mov	[esi+8C8h], eax
		mov	[esi+8CCh], eax
		lea	eax, [esi+8FCh]
		lea	edi, [esi+8F4h]
		push	96h
		lea	ebp, [esi+8F8h]
		mov	[esi+8F0h], ebx
		mov	[edi], ebx
		mov	[ebp+0], ebx
		push	eax
		lea	ebx, [esi+900h]
		push	edi
		mov	dword ptr [eax], 96h
		mov	dword ptr [ebx], 96h
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10007762
		push	2FCh
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	0
		push	esi
		call	sasl_seterror
		mov	eax, 0FFFFFFFEh
		add	esp, 10h
		mov	[esi+8F0h], eax
		jmp	loc_10007844
; ---------------------------------------------------------------------------

loc_10007762:				; CODE XREF: sub_100075A0+19Bj
		push	96h
		push	ebx
		push	ebp
		call	sub_10005640
		xor	ebx, ebx
		add	esp, 0Ch
		cmp	eax, ebx
		jz	short loc_1000779B
		push	2FEh
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	ebx
		push	esi
		call	sasl_seterror
		mov	eax, 0FFFFFFFEh
		add	esp, 10h
		mov	[esi+8F0h], eax
		jmp	loc_10007844
; ---------------------------------------------------------------------------

loc_1000779B:				; CODE XREF: sub_100075A0+1D5j
		mov	eax, [edi]
		mov	[eax], bl
		mov	ecx, [ebp+0]
		mov	eax, [esp+41Ch+var_40C]
		mov	[ecx], bl
		mov	[esi+90Ch], ebx
		cmp	eax, ebx
		jz	short loc_100077F2
		push	ebx
		lea	edi, [esi+8E8h]
		push	edi
		push	eax
		call	sub_10004910
		mov	edx, [edi]
		push	edx
		mov	ebp, eax
		call	sasl_strlower
		add	esp, 10h

loc_100077CD:				; CODE XREF: sub_100075A0+29Aj
		cmp	ebp, ebx
		jz	short loc_10007842
		push	316h
		push	offset aOutOfMemoryI_0 ; "Out of Memory	in common.c near line %d"
		push	ebx
		push	esi
		call	sasl_seterror
		mov	eax, 0FFFFFFFEh
		add	esp, 10h
		mov	[esi+8F0h], eax
		jmp	short loc_10007844
; ---------------------------------------------------------------------------

loc_100077F2:				; CODE XREF: sub_100075A0+210j
		cmp	dword ptr [esi], 1
		jnz	short loc_1000783C
		push	400h
		lea	eax, [esp+420h+name]
		push	ebx
		push	eax
		call	sub_1000E0F0
		push	ebx		; int
		lea	ecx, [esp+42Ch+name]
		push	400h		; namelen
		push	ecx		; name
		call	sub_10009420
		add	esp, 18h
		test	eax, eax
		jz	short loc_10007823
		or	eax, 0FFFFFFFFh
		jmp	short loc_10007844
; ---------------------------------------------------------------------------

loc_10007823:				; CODE XREF: sub_100075A0+27Cj
		push	ebx
		lea	edx, [esi+8E8h]
		push	edx
		lea	eax, [esp+424h+name]
		push	eax
		call	sub_10004910
		add	esp, 0Ch
		mov	ebp, eax
		jmp	short loc_100077CD
; ---------------------------------------------------------------------------

loc_1000783C:				; CODE XREF: sub_100075A0+255j
		mov	[esi+8E8h], ebx

loc_10007842:				; CODE XREF: sub_100075A0+22Fj
		xor	eax, eax

loc_10007844:				; CODE XREF: sub_100075A0:loc_10007653j
					; sub_100075A0+BFj ...
		mov	ecx, [esp+41Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 40Ch
		retn
sub_100075A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007860	proc near		; CODE XREF: sasl_client_init+CAp
					; sasl_server_init+B4p

arg_0		= dword	ptr  4

		mov	eax, sasl_global_utils
		mov	ecx, [esp+arg_0]
		test	eax, eax
		jz	short loc_1000787C
		mov	dword ptr [eax+10h], offset loc_10004FE0
		mov	[eax+0Ch], ecx
		mov	eax, sasl_global_utils

loc_1000787C:				; CODE XREF: sub_10007860+Bj
		cmp	dword_1002E498,	0
		jnz	short loc_100078D3
		test	eax, eax
		jnz	short loc_100078A2
		push	ecx
		push	eax
		call	sub_10007350
		add	esp, 8
		mov	sasl_global_utils, eax
		test	eax, eax
		jnz	short loc_100078A2
		mov	eax, 0FFFFFFFEh
		retn
; ---------------------------------------------------------------------------

loc_100078A2:				; CODE XREF: sub_10007860+27j
					; sub_10007860+3Aj
		push	offset loc_10002B80
		push	offset aInternal ; "INTERNAL"
		call	sasl_canonuser_add_plugin
		add	esp, 8
		test	eax, eax
		jnz	short locret_100078D5
		cmp	dword_1002E498,	eax
		jnz	short loc_100078D3
		call	off_1002D06C
		mov	dword_1002E498,	eax
		test	eax, eax
		jnz	short loc_100078D3
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100078D3:				; CODE XREF: sub_10007860+23j
					; sub_10007860+5Ej ...
		xor	eax, eax

locret_100078D5:			; CODE XREF: sub_10007860+56j
		retn
sub_10007860	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  34. sasl_config_init

; =============== S U B	R O U T	I N E =======================================


		public sasl_config_init
sasl_config_init proc near		; CODE XREF: sub_1000A0F0+EFp
					; DATA XREF: .rdata:off_1002C568o

var_100C	= dword	ptr -100Ch
var_1008	= dword	ptr -1008h
var_1004	= byte ptr -1004h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	eax, 100Ch
		call	__alloca_probe
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+100Ch+var_4], eax
		mov	eax, [esp+100Ch+arg_0]
		push	ebx
		push	ebp
		push	offset aR	; "r"
		xor	ebp, ebp
		push	eax
		mov	dword_1002E4B8,	ebp
		call	sub_100100D1
		mov	ebx, eax
		add	esp, 8
		mov	[esp+1014h+var_100C], ebx
		cmp	ebx, ebp
		jnz	short loc_1000793B
		lea	eax, [ebp+1]
		pop	ebp
		pop	ebx
		mov	ecx, [esp+100Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 100Ch
		retn
; ---------------------------------------------------------------------------

loc_1000793B:				; CODE XREF: sasl_config_init+3Fj
		push	esi
		push	edi
		push	ebx
		lea	eax, [esp+1020h+var_1004]
		push	1000h
		push	eax
		call	sub_1000FE75
		add	esp, 0Ch
		test	eax, eax
		jz	loc_10007B01
		lea	edi, [esp+101Ch+var_1004]
		dec	edi
		mov	[esp+101Ch+var_1008], edi

loc_10007961:				; CODE XREF: sasl_config_init+21Bj
		lea	eax, [esp+101Ch+var_1004]
		lea	edx, [eax+1]

loc_10007968:				; CODE XREF: sasl_config_init+8Dj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10007968
		sub	eax, edx
		cmp	byte ptr [edi+eax], 0Ah
		jnz	short loc_1000797A
		mov	[edi+eax], cl

loc_1000797A:				; CODE XREF: sasl_config_init+95j
		cmp	[esp+101Ch+var_1004], 0
		lea	esi, [esp+101Ch+var_1004]
		jz	loc_10007AE6
		lea	esp, [esp+0]

loc_10007990:				; CODE XREF: sasl_config_init+C4j
		movsx	ecx, byte ptr [esi]
		push	ecx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jz	short loc_100079AB
		inc	esi
		cmp	byte ptr [esi],	0
		jnz	short loc_10007990
		jmp	loc_10007AE6
; ---------------------------------------------------------------------------

loc_100079AB:				; CODE XREF: sasl_config_init+BEj
		mov	al, [esi]
		test	al, al
		jz	loc_10007AE6
		cmp	al, 23h
		jz	loc_10007AE6
		mov	ebx, esi
		test	al, al
		jz	short loc_10007A01

loc_100079C3:				; CODE XREF: sasl_config_init+11Fj
		movsx	edx, byte ptr [esi]
		push	edx
		call	sub_1000EAE3
		add	esp, 4
		test	eax, eax
		jnz	short loc_100079DD
		mov	al, [esi]
		cmp	al, 2Dh
		jz	short loc_100079DD
		cmp	al, 5Fh
		jnz	short loc_10007A01

loc_100079DD:				; CODE XREF: sasl_config_init+F1j
					; sasl_config_init+F7j
		movsx	eax, byte ptr [esi]
		push	eax
		call	sub_1000E7A7
		add	esp, 4
		test	eax, eax
		jz	short loc_100079FB
		movsx	ecx, byte ptr [esi]
		push	ecx
		call	sub_1000FE49
		add	esp, 4
		mov	[esi], al

loc_100079FB:				; CODE XREF: sasl_config_init+10Bj
		inc	esi
		cmp	byte ptr [esi],	0
		jnz	short loc_100079C3

loc_10007A01:				; CODE XREF: sasl_config_init+E1j
					; sasl_config_init+FBj
		cmp	byte ptr [esi],	3Ah
		jnz	short loc_10007A29
		mov	byte ptr [esi],	0
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jz	short loc_10007A29

loc_10007A11:				; CODE XREF: sasl_config_init+147j
		movsx	edx, al
		push	edx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jz	short loc_10007A31
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_10007A11

loc_10007A29:				; CODE XREF: sasl_config_init+124j
					; sasl_config_init+12Fj ...
		or	eax, 0FFFFFFFFh
		jmp	loc_10007B0C
; ---------------------------------------------------------------------------

loc_10007A31:				; CODE XREF: sasl_config_init+13Fj
		cmp	byte ptr [esi],	0
		jz	short loc_10007A29
		mov	eax, esi
		lea	edx, [eax+1]
		jmp	short loc_10007A40
; ---------------------------------------------------------------------------
		align 10h

loc_10007A40:				; CODE XREF: sasl_config_init+15Bj
					; sasl_config_init+165j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10007A40
		sub	eax, edx
		lea	edi, [eax+esi-1]
		cmp	edi, esi
		jbe	short loc_10007A69

loc_10007A51:				; CODE XREF: sasl_config_init+187j
		movsx	eax, byte ptr [edi]
		push	eax
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jz	short loc_10007A69
		mov	byte ptr [edi],	0
		dec	edi
		cmp	edi, esi
		ja	short loc_10007A51

loc_10007A69:				; CODE XREF: sasl_config_init+16Fj
					; sasl_config_init+17Fj
		cmp	dword_1002E4B8,	ebp
		jnz	short loc_10007A9C
		mov	edx, dword_1002E4BC
		add	ebp, 64h
		lea	ecx, ds:0[ebp*8]
		push	ecx		; dwBytes
		push	edx		; lpMem
		call	off_1002D04C
		add	esp, 8
		mov	dword_1002E4BC,	eax
		test	eax, eax
		jnz	short loc_10007AA1
		mov	eax, 0FFFFFFFEh
		jmp	short loc_10007B0C
; ---------------------------------------------------------------------------

loc_10007A9C:				; CODE XREF: sasl_config_init+18Fj
		mov	eax, dword_1002E4BC

loc_10007AA1:				; CODE XREF: sasl_config_init+1B3j
		mov	ecx, dword_1002E4B8
		push	0
		lea	edx, [eax+ecx*8]
		push	edx
		push	ebx
		call	sub_10004910
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10007B0C
		mov	ecx, dword_1002E4BC
		push	eax
		mov	eax, dword_1002E4B8
		lea	edx, [ecx+eax*8+4]
		push	edx
		push	esi
		call	sub_10004910
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10007B0C
		inc	dword_1002E4B8
		mov	edi, [esp+101Ch+var_1008]
		mov	ebx, [esp+101Ch+var_100C]

loc_10007AE6:				; CODE XREF: sasl_config_init+A3j
					; sasl_config_init+C6j	...
		push	ebx
		lea	eax, [esp+1020h+var_1004]
		push	1000h
		push	eax
		call	sub_1000FE75
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10007961

loc_10007B01:				; CODE XREF: sasl_config_init+72j
		push	ebx
		call	sub_1000FCAB
		add	esp, 4
		xor	eax, eax

loc_10007B0C:				; CODE XREF: sasl_config_init+14Cj
					; sasl_config_init+1BAj ...
		mov	ecx, [esp+101Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 100Ch
		retn
sasl_config_init endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007B30	proc near		; CODE XREF: .text:10005032p
					; sub_10005070+A3p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		cmp	dword_1002E4B8,	esi
		jle	short loc_10007B92
		mov	ebp, [esp+10h+arg_0]
		mov	bl, [ebp+0]
		mov	edi, dword_1002E4BC
		jmp	short loc_10007B50
; ---------------------------------------------------------------------------
		align 10h

loc_10007B50:				; CODE XREF: sub_10007B30+1Bj
					; sub_10007B30+60j
		mov	ecx, [edi+esi*8]
		cmp	bl, [ecx]
		jnz	short loc_10007B89
		mov	eax, ebp
		lea	esp, [esp+0]

loc_10007B60:				; CODE XREF: sub_10007B30+4Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10007B80
		test	dl, dl
		jz	short loc_10007B7C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10007B80
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10007B60

loc_10007B7C:				; CODE XREF: sub_10007B30+38j
		xor	eax, eax
		jmp	short loc_10007B85
; ---------------------------------------------------------------------------

loc_10007B80:				; CODE XREF: sub_10007B30+34j
					; sub_10007B30+40j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10007B85:				; CODE XREF: sub_10007B30+4Ej
		test	eax, eax
		jz	short loc_10007B9B

loc_10007B89:				; CODE XREF: sub_10007B30+25j
		inc	esi
		cmp	esi, dword_1002E4B8
		jl	short loc_10007B50

loc_10007B92:				; CODE XREF: sub_10007B30+Cj
		mov	eax, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10007B9B:				; CODE XREF: sub_10007B30+57j
		mov	eax, [edi+esi*8+4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10007B30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007BB0	proc near		; DATA XREF: .data:1002D090o

arg_4		= dword	ptr  8
arg_10		= dword	ptr  14h

		mov	ecx, [esp+arg_10]
		test	ecx, ecx
		jz	short loc_10007BE6
		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short loc_10007BE6
		mov	eax, [eax+34h]
		test	eax, eax
		jz	short loc_10007BE6
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_10007BE6
		cmp	dword ptr [eax+8D4h], 0
		jnz	short loc_10007BDD
		mov	eax, 0FFFFFFFCh
		retn
; ---------------------------------------------------------------------------

loc_10007BDD:				; CODE XREF: sub_10007BB0+25j
		mov	dword ptr [ecx], 0
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10007BE6:				; CODE XREF: sub_10007BB0+6j
					; sub_10007BB0+Ej ...
		mov	eax, 0FFFFFFF9h
		retn
sub_10007BB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007BF0	proc near		; DATA XREF: .data:1002D094o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		xor	ebx, ebx
		push	edi
		cmp	esi, ebx
		jz	loc_10007D38
		mov	eax, [esi+34h]
		cmp	eax, ebx
		jz	loc_10007D38
		mov	ebp, [eax+4]
		cmp	ebp, ebx
		jz	loc_10007D38
		cmp	[eax+7Ch], ebx
		jz	loc_10007D38
		cmp	[esp+10h+arg_10], ebx
		jz	loc_10007D38
		cmp	[esp+10h+arg_14], ebx
		jz	loc_10007D38
		mov	edi, [esp+10h+arg_18]
		cmp	edi, ebx
		jz	loc_10007D38
		mov	eax, [ebp+8D4h]
		cmp	eax, ebx
		jnz	short loc_10007C55

loc_10007C4B:				; CODE XREF: sub_10007BF0+6Dj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFFBh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10007C55:				; CODE XREF: sub_10007BF0+59j
		cmp	[esp+10h+arg_C], 4000h
		ja	short loc_10007C4B
		test	byte ptr [esi+48h], 10h
		jz	short loc_10007CB2
		mov	ecx, offset aAnonymous ; "anonymous"
		lea	ebx, [ebx+0]

loc_10007C70:				; CODE XREF: sub_10007BF0+9Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10007C90
		cmp	dl, bl
		jz	short loc_10007C8C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10007C90
		add	eax, 2
		add	ecx, 2
		cmp	dl, bl
		jnz	short loc_10007C70

loc_10007C8C:				; CODE XREF: sub_10007BF0+88j
		xor	eax, eax
		jmp	short loc_10007C95
; ---------------------------------------------------------------------------

loc_10007C90:				; CODE XREF: sub_10007BF0+84j
					; sub_10007BF0+90j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10007C95:				; CODE XREF: sub_10007BF0+9Ej
		cmp	eax, ebx
		jnz	short loc_10007CB2
		push	offset aAnonymousLogin ; "anonymous login not allowed"
		push	ebx
		push	ebp
		call	sasl_seterror
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFF2h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10007CB2:				; CODE XREF: sub_10007BF0+73j
					; sub_10007BF0+A7j
		mov	eax, [esp+10h+arg_10]
		mov	ecx, [esp+10h+arg_14]
		mov	[eax], ebx
		mov	eax, [esp+10h+arg_8]
		mov	[ecx], ebx
		cmp	eax, ebx
		jnz	short loc_10007CD0
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10007CD0:				; CODE XREF: sub_10007BF0+D4j
		push	edi
		cmp	[esp+14h+arg_C], ebx
		jz	short loc_10007CF9
		mov	edx, [esi+34h]
		mov	ecx, [esi+5Ch]
		push	2
		push	ebx
		push	eax
		mov	eax, [edx+4]
		push	eax
		call	ecx
		add	esp, 14h
		cmp	eax, ebx
		jnz	short loc_10007D3D
		mov	edx, [esi+34h]
		mov	eax, [edx+4]
		push	edi
		push	5
		jmp	short loc_10007D01
; ---------------------------------------------------------------------------

loc_10007CF9:				; CODE XREF: sub_10007BF0+E5j
		mov	eax, [esi+34h]
		mov	eax, [eax+4]
		push	7

loc_10007D01:				; CODE XREF: sub_10007BF0+107j
		mov	ecx, [eax+8D4h]
		mov	edx, [esi+5Ch]
		push	ebx
		push	ecx
		push	eax
		call	edx
		add	esp, 14h
		cmp	eax, ebx
		jnz	short loc_10007D3D
		mov	[edi+18h], ebx
		mov	[edi+14h], ebx
		mov	[edi+1Ch], ebx
		mov	[edi+20h], ebx
		mov	[edi+24h], ebx
		mov	[edi+28h], ebx
		mov	[edi+54h], ebx
		mov	dword ptr [edi], 1
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10007D38:				; CODE XREF: sub_10007BF0+Cj
					; sub_10007BF0+17j ...
		mov	eax, 0FFFFFFF9h

loc_10007D3D:				; CODE XREF: sub_10007BF0+FCj
					; sub_10007BF0+124j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10007BF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007D50	proc near		; DATA XREF: .data:1002D0ACo

arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [eax+34h]
		mov	edx, [ecx+4]
		mov	eax, [edx+8D4h]
		neg	eax
		sbb	eax, eax
		and	eax, 6
		add	eax, 0FFFFFFFAh
		retn
sub_10007D50	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10007D70:				; DATA XREF: sasl_server_init:loc_1000BB34o
		mov	edx, [esp+0Ch]
		test	edx, edx
		jz	short loc_10007DC4
		mov	ecx, [esp+10h]
		test	ecx, ecx
		jz	short loc_10007DC4
		mov	eax, [esp+14h]
		test	eax, eax
		jz	short loc_10007DC4
		cmp	dword ptr [esp+8], 4
		jz	short loc_10007DAF
		mov	eax, [esp+4]
		mov	ecx, [eax+4]
		mov	edx, [eax+84h]
		push	offset aExternalVersio ; "EXTERNAL version mismatch"
		push	0
		push	ecx
		call	edx
		add	esp, 0Ch
		mov	eax, 0FFFFFFE9h
		retn
; ---------------------------------------------------------------------------

loc_10007DAF:				; CODE XREF: .text:10007D8Dj
		mov	dword ptr [edx], 4
		mov	dword ptr [ecx], offset	off_1002D07C
		mov	dword ptr [eax], 1
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10007DC4:				; CODE XREF: .text:10007D76j
					; .text:10007D7Ej ...
		mov	eax, 0FFFFFFF9h
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007DD0	proc near		; DATA XREF: .data:1002D0CCo

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		push	esi
		test	eax, eax
		jz	short loc_10007E22
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_10007E22
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_10007E22
		mov	esi, [esp+4+arg_8]
		test	esi, esi
		jz	short loc_10007E22
		cmp	dword ptr [eax+8D4h], 0
		jnz	short loc_10007DFF
		mov	eax, 0FFFFFFFCh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007DFF:				; CODE XREF: sub_10007DD0+26j
		push	8
		call	off_1002D044
		add	esp, 4
		test	eax, eax
		jnz	short loc_10007E15
		mov	eax, 0FFFFFFFEh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007E15:				; CODE XREF: sub_10007DD0+3Cj
		xor	ecx, ecx
		mov	[eax], ecx
		mov	[eax+4], ecx
		mov	[esi], eax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007E22:				; CODE XREF: sub_10007DD0+7j
					; sub_10007DD0+Ej ...
		mov	eax, 0FFFFFFF9h
		pop	esi
		retn
sub_10007DD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007E30	proc near		; DATA XREF: .data:1002D0D0o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_4]
		xor	ebx, ebx
		mov	[esp+10h+var_4], ebx
		cmp	edi, ebx
		jz	loc_10008010
		mov	eax, [edi+0Ch]
		cmp	eax, ebx
		jz	loc_10008010
		mov	edx, [eax+4]
		cmp	edx, ebx
		jz	loc_10008010
		cmp	[eax+7Ch], ebx
		jz	loc_10008010
		mov	ecx, [esp+10h+arg_14]
		cmp	ecx, ebx
		jz	loc_10008010
		mov	eax, [esp+10h+arg_18]
		cmp	eax, ebx
		jz	loc_10008010
		mov	esi, [esp+10h+arg_1C]
		cmp	esi, ebx
		jz	loc_10008010
		cmp	[edx+8D4h], ebx
		jnz	short loc_10007E9B

loc_10007E91:				; CODE XREF: sub_10007E30+6Fj
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFBh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10007E9B:				; CODE XREF: sub_10007E30+5Fj
		cmp	[esp+10h+arg_C], ebx
		jnz	short loc_10007E91
		push	ebp
		mov	ebp, [esp+14h+arg_10]
		mov	[ecx], ebx
		mov	[eax], ebx
		mov	ecx, [edi+0Ch]
		push	ebp
		lea	eax, [esp+18h+var_4]
		push	eax
		push	ebx
		push	4001h
		push	ecx
		call	sub_1000D330
		add	esp, 14h
		mov	[esp+14h+arg_4], eax
		cmp	eax, ebx
		jz	short loc_10007ECF
		cmp	eax, 2
		jnz	short loc_10007F1C

loc_10007ECF:				; CODE XREF: sub_10007E30+98j
		cmp	ebp, ebx
		jz	short loc_10007EED
		mov	ecx, [ebp+0]
		cmp	ecx, ebx
		jz	short loc_10007EED
		mov	edx, [edi+0Ch]
		mov	eax, [edx+20h]
		push	ecx
		call	eax
		mov	eax, [esp+18h+arg_4]
		add	esp, 4
		mov	[ebp+0], ebx

loc_10007EED:				; CODE XREF: sub_10007E30+A1j
					; sub_10007E30+A8j
		cmp	eax, 2
		jnz	short loc_10007F22
		push	ebx
		push	ebx
		mov	ecx, [edi+0Ch]
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	offset byte_1002762D
		push	offset aPleaseEnterYou ; "Please enter your authorization name"
		push	ebp
		push	ecx
		call	sub_1000D720
		add	esp, 38h
		cmp	eax, ebx
		jnz	short loc_10007F1C
		mov	eax, 2

loc_10007F1C:				; CODE XREF: sub_10007E30+9Dj
					; sub_10007E30+E5j ...
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10007F22:				; CODE XREF: sub_10007E30+C0j
		mov	eax, [esp+14h+var_4]
		cmp	eax, ebx
		jz	short loc_10007F3B
		lea	edx, [eax+1]
		lea	ecx, [ecx+0]

loc_10007F30:				; CODE XREF: sub_10007E30+105j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10007F30
		sub	eax, edx
		jmp	short loc_10007F3D
; ---------------------------------------------------------------------------

loc_10007F3B:				; CODE XREF: sub_10007E30+F8j
		xor	eax, eax

loc_10007F3D:				; CODE XREF: sub_10007E30+109j
		mov	edx, [esp+14h+arg_18]
		mov	ebp, [esp+14h+arg_0]
		mov	[edx], eax
		inc	eax
		push	eax
		lea	eax, [ebp+4]
		push	eax
		push	ebp
		call	sub_10005640
		add	esp, 0Ch
		cmp	eax, ebx
		jnz	short loc_10007F1C
		mov	eax, [esp+14h+var_4]
		cmp	eax, ebx
		jz	short loc_10007FB6
		cmp	[eax], bl
		jz	short loc_10007FB6
		mov	ecx, [edi+0Ch]
		mov	edx, [ecx+4]
		push	esi
		push	2
		push	ebx
		push	eax
		mov	eax, [edi+5Ch]
		push	edx
		call	eax
		add	esp, 14h
		cmp	eax, ebx
		jnz	short loc_10007F1C
		mov	ecx, [edi+0Ch]
		mov	eax, [ecx+4]
		mov	edx, [eax+8D4h]
		push	esi
		push	1
		push	ebx
		push	edx
		push	eax
		mov	eax, [edi+5Ch]
		call	eax
		add	esp, 14h
		cmp	eax, ebx
		jnz	short loc_10007F1C
		mov	ecx, [esp+14h+arg_18]
		mov	edx, [ecx]
		mov	eax, [esp+14h+var_4]
		mov	ecx, [ebp+0]
		push	edx
		push	eax
		push	ecx
		call	sub_1000E2B0
		add	esp, 0Ch
		jmp	short loc_10007FD8
; ---------------------------------------------------------------------------

loc_10007FB6:				; CODE XREF: sub_10007E30+130j
					; sub_10007E30+134j
		mov	edx, [edi+0Ch]
		mov	eax, [edx+4]
		mov	ecx, [eax+8D4h]
		mov	edx, [edi+5Ch]
		push	esi
		push	3
		push	ebx
		push	ecx
		push	eax
		call	edx
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_10007F1C

loc_10007FD8:				; CODE XREF: sub_10007E30+184j
		mov	edx, [ebp+0]
		mov	eax, [esp+14h+arg_18]
		mov	ecx, [eax]
		mov	[ecx+edx], bl
		mov	eax, [ebp+0]
		mov	ecx, [esp+14h+arg_14]
		mov	[ecx], eax
		pop	ebp
		pop	edi
		mov	[esi+18h], ebx
		mov	[esi+14h], ebx
		mov	[esi+1Ch], ebx
		mov	[esi+20h], ebx
		mov	[esi+24h], ebx
		mov	[esi+28h], ebx
		mov	[esi+54h], ebx
		mov	dword ptr [esi], 1
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10008010:				; CODE XREF: sub_10007E30+10j
					; sub_10007E30+1Bj ...
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		pop	ecx
		retn
sub_10007E30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008020	proc near		; DATA XREF: .data:1002D0D4o

lpMem		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+lpMem]
		test	esi, esi
		jz	short loc_10008043
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10008039
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10008039:				; CODE XREF: sub_10008020+Dj
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10008043:				; CODE XREF: sub_10008020+7j
		pop	esi
		retn
sub_10008020	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10008050:				; DATA XREF: sasl_client_init+B0o
		push	esi
		mov	esi, [esp+8]
		test	esi, esi
		jz	short loc_100080AB
		mov	edx, [esp+10h]
		test	edx, edx
		jz	short loc_100080AB
		mov	ecx, [esp+14h]
		test	ecx, ecx
		jz	short loc_100080AB
		mov	eax, [esp+18h]
		test	eax, eax
		jz	short loc_100080AB
		cmp	dword ptr [esp+0Ch], 4
		jz	short loc_10008095
		mov	eax, [esi+4]
		mov	ecx, [esi+84h]
		push	offset aExternalVersio ; "EXTERNAL version mismatch"
		push	0
		push	eax
		call	ecx
		add	esp, 0Ch
		mov	eax, 0FFFFFFE9h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008095:				; CODE XREF: .text:10008076j
		mov	dword ptr [edx], 4
		mov	dword ptr [ecx], offset	off_1002D0B4
		mov	dword ptr [eax], 1
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100080AB:				; CODE XREF: .text:10008057j
					; .text:1000805Fj ...
		mov	eax, 0FFFFFFF9h
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100080C0	proc near		; CODE XREF: sub_10002BC0+37p
					; DATA XREF: sub_10007350+AAo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		mov	[eax+14h], ecx
		mov	[eax+10h], ecx
		mov	dword ptr [eax], 67452301h
		mov	dword ptr [eax+4], 0EFCDAB89h
		mov	dword ptr [eax+8], 98BADCFEh
		mov	dword ptr [eax+0Ch], 10325476h
		retn
sub_100080C0	endp

; ---------------------------------------------------------------------------
		align 10h
		test	edx, edx
		jz	short locret_10008124
		push	esi
		lea	esi, [edx-1]
		shr	esi, 2
		inc	ecx
		add	eax, 2
		inc	esi

loc_10008100:				; CODE XREF: .text:10008121j
		movzx	edx, byte ptr [eax-2]
		mov	[ecx-1], dl
		movzx	edx, byte ptr [eax-1]
		mov	[ecx], dl
		movzx	edx, byte ptr [eax]
		mov	[ecx+1], dl
		movzx	edx, byte ptr [eax+1]
		mov	[ecx+2], dl
		add	eax, 4
		add	ecx, 4
		dec	esi
		jnz	short loc_10008100
		pop	esi

locret_10008124:			; CODE XREF: .text:100080F2j
		retn
; ---------------------------------------------------------------------------
		align 10h
		test	ecx, ecx
		jz	short locret_1000816B
		dec	ecx
		shr	ecx, 2
		push	esi
		add	eax, 2
		inc	ecx
		push	edi
		mov	edi, edi

loc_10008140:				; CODE XREF: .text:10008167j
		movzx	esi, byte ptr [eax+1]
		movzx	edi, byte ptr [eax]
		shl	esi, 8
		or	esi, edi
		movzx	edi, byte ptr [eax-1]
		shl	esi, 8
		or	esi, edi
		movzx	edi, byte ptr [eax-2]
		shl	esi, 8
		or	esi, edi
		mov	[edx], esi
		add	edx, 4
		add	eax, 4
		dec	ecx
		jnz	short loc_10008140
		pop	edi
		pop	esi

locret_1000816B:			; CODE XREF: .text:10008132j
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		mov	esi, edx
		test	esi, esi
		jz	short loc_10008189
		sub	ecx, eax
		lea	esp, [esp+0]

loc_10008180:				; CODE XREF: .text:10008187j
		mov	dl, [ecx+eax]
		mov	[eax], dl
		inc	eax
		dec	esi
		jnz	short loc_10008180

loc_10008189:				; CODE XREF: .text:10008175j
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h
		test	eax, eax
		jz	short locret_100081A3
		push	eax
		mov	eax, [esp+8]
		push	eax
		push	ecx
		call	sub_1000E0F0
		add	esp, 0Ch

locret_100081A3:			; CODE XREF: .text:10008192j
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100081B0	proc near		; DATA XREF: sub_10007350+DBo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		push	0B0h
		push	0
		push	esi
		call	sub_1000E0F0
		mov	edi, [esp+1Ch+arg_4]
		mov	ebx, ds:ntohl
		add	esp, 0Ch
		sub	edi, esi
		mov	ebp, 4
		lea	esp, [esp+0]

loc_100081E0:				; CODE XREF: sub_100081B0+46j
		mov	eax, [edi+esi]
		push	eax		; netlong
		call	ebx ; ntohl
		mov	[esi], eax
		mov	ecx, [edi+esi+10h]
		push	ecx		; netlong
		call	ebx ; ntohl
		mov	[esi+58h], eax
		add	esi, 4
		dec	ebp
		jnz	short loc_100081E0
		mov	eax, [esp+10h+arg_0]
		pop	edi
		pop	esi
		mov	ecx, 200h
		pop	ebp
		mov	[eax+68h], ecx
		mov	[eax+10h], ecx
		pop	ebx
		retn
sub_100081B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008210	proc near		; CODE XREF: sub_10008900+63p
					; sub_10008900+7Dp

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		mov	eax, [esp+4Ch+arg_0]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	[esp+5Ch+var_4C], eax
		add	ecx, 2
		lea	edx, [esp+5Ch+var_44]
		mov	esi, 10h

loc_10008236:				; CODE XREF: sub_10008210+4Dj
		movzx	edi, byte ptr [ecx+1]
		movzx	ebx, byte ptr [ecx]
		shl	edi, 8
		or	edi, ebx
		movzx	ebx, byte ptr [ecx-1]
		shl	edi, 8
		or	edi, ebx
		movzx	ebx, byte ptr [ecx-2]
		shl	edi, 8
		or	edi, ebx
		mov	[edx], edi
		add	edx, 4
		add	ecx, 4
		dec	esi
		jnz	short loc_10008236
		mov	esi, [eax+4]
		mov	edx, [eax+8]
		mov	ecx, [eax+0Ch]
		mov	eax, [eax]
		mov	ebx, edx
		and	ebx, esi
		mov	edi, esi
		not	edi
		and	edi, ecx
		or	edi, ebx
		add	edi, [esp+5Ch+var_44]
		mov	ebx, esi
		lea	eax, [edi+eax-28955B88h]
		rol	eax, 7
		add	eax, esi
		and	ebx, eax
		mov	edi, eax
		not	edi
		and	edi, edx
		or	edi, ebx
		add	edi, [esp+5Ch+var_40]
		lea	ecx, [edi+ecx-173848AAh]
		rol	ecx, 0Ch
		add	ecx, eax
		mov	edi, ecx
		not	edi
		and	edi, esi
		mov	ebx, ecx
		and	ebx, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_3C]
		mov	ebx, ecx
		lea	edx, [edi+edx+242070DBh]
		ror	edx, 0Fh
		add	edx, ecx
		and	ebx, edx
		mov	edi, edx
		not	edi
		and	edi, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_38]
		mov	ebx, edx
		lea	esi, [edi+esi-3E423112h]
		ror	esi, 0Ah
		add	esi, edx
		and	ebx, esi
		mov	edi, esi
		not	edi
		and	edi, ecx
		or	edi, ebx
		add	edi, [esp+5Ch+var_34]
		mov	ebx, esi
		lea	eax, [edi+eax-0A83F051h]
		rol	eax, 7
		add	eax, esi
		and	ebx, eax
		mov	edi, eax
		not	edi
		and	edi, edx
		or	edi, ebx
		add	edi, [esp+5Ch+var_30]
		lea	ecx, [edi+ecx+4787C62Ah]
		rol	ecx, 0Ch
		add	ecx, eax
		mov	edi, ecx
		not	edi
		and	edi, esi
		mov	ebx, ecx
		and	ebx, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_2C]
		mov	ebx, ecx
		lea	edx, [edi+edx-57CFB9EDh]
		ror	edx, 0Fh
		add	edx, ecx
		mov	edi, edx
		not	edi
		and	edi, eax
		and	ebx, edx
		or	edi, ebx
		add	edi, [esp+5Ch+var_28]
		lea	esi, [edi+esi-2B96AFFh]
		ror	esi, 0Ah
		add	esi, edx
		mov	ebx, edx
		and	ebx, esi
		mov	edi, esi
		not	edi
		and	edi, ecx
		or	edi, ebx
		add	edi, [esp+5Ch+var_24]
		mov	ebx, esi
		lea	eax, [edi+eax+698098D8h]
		rol	eax, 7
		add	eax, esi
		and	ebx, eax
		mov	edi, eax
		not	edi
		and	edi, edx
		or	edi, ebx
		add	edi, [esp+5Ch+var_20]
		lea	ecx, [edi+ecx-74BB0851h]
		rol	ecx, 0Ch
		add	ecx, eax
		mov	edi, ecx
		not	edi
		and	edi, esi
		mov	ebx, ecx
		and	ebx, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_1C]
		mov	ebx, ecx
		lea	edx, [edi+edx-0A44Fh]
		ror	edx, 0Fh
		add	edx, ecx
		and	ebx, edx
		mov	edi, edx
		not	edi
		and	edi, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_18]
		mov	ebx, edx
		lea	esi, [edi+esi-76A32842h]
		ror	esi, 0Ah
		add	esi, edx
		and	ebx, esi
		mov	edi, esi
		not	edi
		and	edi, ecx
		or	edi, ebx
		add	edi, [esp+5Ch+var_14]
		mov	ebx, esi
		lea	eax, [edi+eax+6B901122h]
		rol	eax, 7
		add	eax, esi
		and	ebx, eax
		mov	edi, eax
		not	edi
		and	edi, edx
		or	edi, ebx
		add	edi, [esp+5Ch+var_10]
		lea	ecx, [edi+ecx-2678E6Dh]
		rol	ecx, 0Ch
		add	ecx, eax
		mov	edi, ecx
		not	edi
		mov	ebx, edi
		and	ebx, esi
		mov	ebp, ecx
		and	ebp, eax
		or	ebx, ebp
		add	ebx, [esp+5Ch+var_C]
		mov	ebp, ecx
		lea	edx, [ebx+edx-5986BC72h]
		ror	edx, 0Fh
		add	edx, ecx
		mov	ebx, edx
		not	ebx
		mov	[esp+5Ch+var_48], ebx
		and	ebx, eax
		and	ebp, edx
		or	ebx, ebp
		and	edi, edx
		mov	ebp, [esp+5Ch+var_8]
		add	ebx, ebp
		lea	esi, [ebx+esi+49B40821h]
		ror	esi, 0Ah
		add	esi, edx
		mov	ebx, ecx
		and	ebx, esi
		or	edi, ebx
		add	edi, [esp+5Ch+var_40]
		mov	ebx, edx
		lea	eax, [edi+eax-9E1DA9Eh]
		mov	edi, [esp+5Ch+var_48]
		and	edi, esi
		rol	eax, 5
		add	eax, esi
		and	ebx, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_2C]
		lea	ecx, [edi+ecx-3FBF4CC0h]
		rol	ecx, 9
		add	ecx, eax
		mov	edi, esi
		not	edi
		and	edi, eax
		mov	ebx, ecx
		and	ebx, esi
		or	edi, ebx
		add	edi, [esp+5Ch+var_18]
		lea	edx, [edi+edx+265E5A51h]
		rol	edx, 0Eh
		add	edx, ecx
		mov	edi, eax
		not	edi
		and	edi, ecx
		mov	ebx, edx
		and	ebx, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_44]
		mov	ebx, ecx
		lea	esi, [edi+esi-16493856h]
		ror	esi, 0Ch
		add	esi, edx
		and	ebx, esi
		mov	edi, ecx
		not	edi
		and	edi, edx
		or	edi, ebx
		add	edi, [esp+5Ch+var_30]
		mov	ebx, edx
		lea	eax, [edi+eax-29D0EFA3h]
		rol	eax, 5
		add	eax, esi
		mov	edi, edx
		not	edi
		and	edi, esi
		and	ebx, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_1C]
		lea	ecx, [edi+ecx+2441453h]
		rol	ecx, 9
		add	ecx, eax
		mov	edi, esi
		not	edi
		and	edi, eax
		mov	ebx, ecx
		and	ebx, esi
		or	edi, ebx
		add	edi, ebp
		lea	edx, [edi+edx-275E197Fh]
		rol	edx, 0Eh
		add	edx, ecx
		mov	edi, eax
		not	edi
		and	edi, ecx
		mov	ebx, edx
		and	ebx, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_34]
		lea	esi, [edi+esi-182C0438h]
		ror	esi, 0Ch
		add	esi, edx
		mov	edi, ecx
		not	edi
		and	edi, edx
		mov	ebx, ecx
		and	ebx, esi
		or	edi, ebx
		add	edi, [esp+5Ch+var_20]
		mov	ebx, edx
		lea	eax, [edi+eax+21E1CDE6h]
		rol	eax, 5
		add	eax, esi
		and	ebx, eax
		mov	edi, edx
		not	edi
		and	edi, esi
		or	edi, ebx
		add	edi, [esp+5Ch+var_C]
		lea	ecx, [edi+ecx-3CC8F82Ah]
		rol	ecx, 9
		add	ecx, eax
		mov	edi, esi
		not	edi
		and	edi, eax
		mov	ebx, ecx
		and	ebx, esi
		or	edi, ebx
		add	edi, [esp+5Ch+var_38]
		lea	edx, [edi+edx-0B2AF279h]
		rol	edx, 0Eh
		add	edx, ecx
		mov	edi, eax
		not	edi
		and	edi, ecx
		mov	ebx, edx
		and	ebx, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_24]
		mov	ebx, ecx
		lea	esi, [edi+esi+455A14EDh]
		ror	esi, 0Ch
		add	esi, edx
		and	ebx, esi
		mov	edi, ecx
		not	edi
		and	edi, edx
		or	edi, ebx
		add	edi, [esp+5Ch+var_10]
		mov	ebx, edx
		lea	eax, [edi+eax-561C16FBh]
		rol	eax, 5
		add	eax, esi
		and	ebx, eax
		mov	edi, edx
		not	edi
		and	edi, esi
		or	edi, ebx
		add	edi, [esp+5Ch+var_3C]
		lea	ecx, [edi+ecx-3105C08h]
		rol	ecx, 9
		add	ecx, eax
		mov	edi, esi
		not	edi
		and	edi, eax
		mov	ebx, ecx
		and	ebx, esi
		or	edi, ebx
		add	edi, [esp+5Ch+var_28]
		lea	edx, [edi+edx+676F02D9h]
		rol	edx, 0Eh
		add	edx, ecx
		mov	edi, eax
		not	edi
		and	edi, ecx
		mov	ebx, edx
		and	ebx, eax
		or	edi, ebx
		add	edi, [esp+5Ch+var_14]
		lea	esi, [edi+esi-72D5B376h]
		ror	esi, 0Ch
		add	esi, edx
		mov	edi, ecx
		xor	edi, edx
		xor	edi, esi
		add	edi, [esp+5Ch+var_30]
		lea	eax, [edi+eax-5C6BEh]
		rol	eax, 4
		add	eax, esi
		mov	edi, edx
		xor	edi, esi
		xor	edi, eax
		add	edi, [esp+5Ch+var_24]
		lea	edi, [edi+ecx-788E097Fh]
		rol	edi, 0Bh
		add	edi, eax
		mov	ecx, edi
		xor	ecx, esi
		xor	ecx, eax
		add	ecx, [esp+5Ch+var_18]
		mov	ebx, edi
		lea	edx, [ecx+edx+6D9D6122h]
		rol	edx, 10h
		add	edx, edi
		xor	ebx, edx
		mov	ecx, ebx
		xor	ecx, eax
		add	ecx, [esp+5Ch+var_C]
		lea	ecx, [ecx+esi-21AC7F4h]
		ror	ecx, 9
		add	ecx, edx
		xor	ebx, ecx
		add	ebx, [esp+5Ch+var_40]
		mov	esi, edx
		xor	esi, ecx
		lea	eax, [ebx+eax-5B4115BCh]
		rol	eax, 4
		add	eax, ecx
		xor	esi, eax
		add	esi, [esp+5Ch+var_34]
		lea	esi, [esi+edi+4BDECFA9h]
		rol	esi, 0Bh
		add	esi, eax
		mov	edi, esi
		xor	edi, ecx
		xor	edi, eax
		add	edi, [esp+5Ch+var_28]
		lea	edx, [edi+edx-944B4A0h]
		rol	edx, 10h
		add	edx, esi
		mov	edi, esi
		xor	edi, edx
		mov	ebx, edi
		xor	ebx, eax
		add	ebx, [esp+5Ch+var_1C]
		lea	ecx, [ebx+ecx-41404390h]
		ror	ecx, 9
		add	ecx, edx
		xor	edi, ecx
		add	edi, [esp+5Ch+var_10]
		lea	eax, [edi+eax+289B7EC6h]
		rol	eax, 4
		add	eax, ecx
		mov	edi, edx
		xor	edi, ecx
		xor	edi, eax
		add	edi, [esp+5Ch+var_44]
		lea	esi, [edi+esi-155ED806h]
		rol	esi, 0Bh
		add	esi, eax
		mov	edi, esi
		xor	edi, ecx
		xor	edi, eax
		add	edi, [esp+5Ch+var_38]
		lea	edi, [edi+edx-2B10CF7Bh]
		rol	edi, 10h
		add	edi, esi
		mov	edx, esi
		xor	edx, edi
		mov	ebx, edx
		xor	ebx, eax
		add	ebx, [esp+5Ch+var_2C]
		lea	ecx, [ebx+ecx+4881D05h]
		ror	ecx, 9
		add	ecx, edi
		xor	edx, ecx
		add	edx, [esp+5Ch+var_20]
		lea	eax, [edx+eax-262B2FC7h]
		mov	edx, edi
		xor	edx, ecx
		rol	eax, 4
		add	eax, ecx
		xor	edx, eax
		add	edx, [esp+5Ch+var_14]
		lea	edx, [edx+esi-1924661Bh]
		rol	edx, 0Bh
		add	edx, eax
		mov	esi, edx
		xor	esi, ecx
		xor	esi, eax
		add	esi, ebp
		lea	esi, [esi+edi+1FA27CF8h]
		rol	esi, 10h
		add	esi, edx
		mov	edi, edx
		xor	edi, esi
		xor	edi, eax
		add	edi, [esp+5Ch+var_3C]
		lea	ecx, [edi+ecx-3B53A99Bh]
		ror	ecx, 9
		add	ecx, esi
		mov	edi, edx
		not	edi
		or	edi, ecx
		xor	edi, esi
		add	edi, [esp+5Ch+var_44]
		lea	eax, [edi+eax-0BD6DDBCh]
		rol	eax, 6
		add	eax, ecx
		mov	edi, esi
		not	edi
		or	edi, eax
		xor	edi, ecx
		add	edi, [esp+5Ch+var_28]
		lea	edx, [edi+edx+432AFF97h]
		rol	edx, 0Ah
		add	edx, eax
		mov	edi, ecx
		not	edi
		or	edi, edx
		xor	edi, eax
		add	edi, [esp+5Ch+var_C]
		lea	esi, [edi+esi-546BDC59h]
		rol	esi, 0Fh
		add	esi, edx
		mov	edi, eax
		not	edi
		or	edi, esi
		xor	edi, edx
		add	edi, [esp+5Ch+var_30]
		lea	ecx, [edi+ecx-36C5FC7h]
		ror	ecx, 0Bh
		add	ecx, esi
		mov	edi, edx
		not	edi
		or	edi, ecx
		xor	edi, esi
		add	edi, [esp+5Ch+var_14]
		lea	eax, [edi+eax+655B59C3h]
		rol	eax, 6
		add	eax, ecx
		mov	edi, esi
		not	edi
		or	edi, eax
		xor	edi, ecx
		add	edi, [esp+5Ch+var_38]
		lea	edx, [edi+edx-70F3336Eh]
		rol	edx, 0Ah
		mov	edi, ecx
		not	edi
		add	edx, eax
		or	edi, edx
		xor	edi, eax
		add	edi, [esp+5Ch+var_1C]
		lea	esi, [edi+esi-100B83h]
		mov	edi, eax
		not	edi
		rol	esi, 0Fh
		add	esi, edx
		or	edi, esi
		xor	edi, edx
		add	edi, [esp+5Ch+var_40]
		lea	ecx, [edi+ecx-7A7BA22Fh]
		ror	ecx, 0Bh
		add	ecx, esi
		mov	edi, edx
		not	edi
		or	edi, ecx
		xor	edi, esi
		add	edi, [esp+5Ch+var_24]
		lea	eax, [edi+eax+6FA87E4Fh]
		rol	eax, 6
		add	eax, ecx
		mov	edi, esi
		not	edi
		or	edi, eax
		xor	edi, ecx
		add	edi, ebp
		lea	edx, [edi+edx-1D31920h]
		rol	edx, 0Ah
		add	edx, eax
		mov	edi, ecx
		not	edi
		or	edi, edx
		xor	edi, eax
		add	edi, [esp+5Ch+var_2C]
		lea	esi, [edi+esi-5CFEBCECh]
		mov	edi, eax
		not	edi
		rol	esi, 0Fh
		add	esi, edx
		or	edi, esi
		xor	edi, edx
		add	edi, [esp+5Ch+var_10]
		lea	ecx, [edi+ecx+4E0811A1h]
		ror	ecx, 0Bh
		add	ecx, esi
		mov	edi, edx
		not	edi
		or	edi, ecx
		xor	edi, esi
		add	edi, [esp+5Ch+var_34]
		lea	eax, [edi+eax-8AC817Eh]
		rol	eax, 6
		add	eax, ecx
		mov	edi, esi
		not	edi
		or	edi, eax
		xor	edi, ecx
		add	edi, [esp+5Ch+var_18]
		lea	edx, [edi+edx-42C50DCBh]
		rol	edx, 0Ah
		add	edx, eax
		mov	edi, ecx
		not	edi
		or	edi, edx
		xor	edi, eax
		add	edi, [esp+5Ch+var_3C]
		lea	esi, [edi+esi+2AD7D2BBh]
		mov	edi, [esp+5Ch+var_4C]
		mov	ebx, [edi]
		add	ebx, eax
		not	eax
		rol	esi, 0Fh
		add	esi, edx
		or	eax, esi
		xor	eax, edx
		add	eax, [esp+5Ch+var_20]
		mov	[edi], ebx
		lea	eax, [eax+ecx-14792C6Fh]
		ror	eax, 0Bh
		add	eax, [edi+4]
		add	eax, esi
		mov	[edi+4], eax
		mov	eax, [edi+8]
		mov	ecx, [esp+5Ch+var_4]
		add	eax, esi
		mov	[edi+8], eax
		mov	eax, [edi+0Ch]
		add	eax, edx
		mov	[edi+0Ch], eax
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
sub_10008210	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008900	proc near		; CODE XREF: sub_10002BC0+44p
					; sub_10002BC0+55p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi+10h]
		mov	ecx, eax
		shr	ecx, 3
		lea	eax, [eax+ebx*8]
		lea	edx, ds:0[ebx*8]
		and	ecx, 3Fh
		push	edi
		mov	[esi+10h], eax
		cmp	eax, edx
		jnb	short loc_1000892B
		inc	dword ptr [esi+14h]

loc_1000892B:				; CODE XREF: sub_10008900+26j
		mov	eax, ebx
		shr	eax, 1Dh
		add	[esi+14h], eax
		mov	edi, 40h
		sub	edi, ecx
		cmp	ebx, edi
		jb	short loc_10008993
		xor	eax, eax
		test	edi, edi
		jz	short loc_1000895F
		lea	ebp, [ecx+esi+18h]
		jmp	short loc_10008950
; ---------------------------------------------------------------------------
		align 10h

loc_10008950:				; CODE XREF: sub_10008900+48j
					; sub_10008900+5Dj
		mov	ecx, [esp+10h+arg_4]
		mov	dl, [eax+ecx]
		mov	[eax+ebp], dl
		inc	eax
		cmp	eax, edi
		jb	short loc_10008950

loc_1000895F:				; CODE XREF: sub_10008900+42j
		lea	ecx, [esi+18h]
		push	esi
		call	sub_10008210
		mov	ebp, edi
		add	edi, 3Fh
		add	esp, 4
		cmp	edi, ebx
		jnb	short loc_1000898F

loc_10008974:				; CODE XREF: sub_10008900+8Dj
		mov	eax, [esp+10h+arg_4]
		lea	ecx, [eax+edi-3Fh]
		push	esi
		call	sub_10008210
		add	edi, 40h
		add	esp, 4
		add	ebp, 40h
		cmp	edi, ebx
		jb	short loc_10008974

loc_1000898F:				; CODE XREF: sub_10008900+72j
		xor	ecx, ecx
		jmp	short loc_10008995
; ---------------------------------------------------------------------------

loc_10008993:				; CODE XREF: sub_10008900+3Cj
		xor	ebp, ebp

loc_10008995:				; CODE XREF: sub_10008900+91j
		xor	eax, eax
		sub	ebx, ebp
		mov	edi, ebx
		jz	short loc_100089B0
		add	ebp, [esp+10h+arg_4]
		lea	ecx, [ecx+esi+18h]

loc_100089A5:				; CODE XREF: sub_10008900+AEj
		mov	dl, [eax+ebp]
		mov	[ecx+eax], dl
		inc	eax
		cmp	eax, edi
		jb	short loc_100089A5

loc_100089B0:				; CODE XREF: sub_10008900+9Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10008900	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100089C0	proc near		; CODE XREF: sub_10002BC0+94p
					; sub_10008AA0+72p ...

var_C		= byte ptr -0Ch
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0Ch+var_4], eax
		push	ebp
		mov	ebp, [esp+10h+arg_0]
		push	esi
		mov	esi, [esp+14h+arg_4]
		push	edi
		xor	ecx, ecx
		lea	eax, [esi+10h]
		mov	edi, edi

loc_100089E0:				; CODE XREF: sub_100089C0+48j
		movzx	edx, byte ptr [eax]
		mov	[esp+ecx+18h+var_C], dl
		movzx	edx, byte ptr [eax+1]
		mov	[esp+ecx+18h+var_B], dl
		movzx	edx, byte ptr [eax+2]
		mov	[esp+ecx+18h+var_A], dl
		movzx	edx, byte ptr [eax+3]
		mov	[esp+ecx+18h+var_9], dl
		add	ecx, 4
		add	eax, 4
		cmp	ecx, 8
		jb	short loc_100089E0
		mov	ecx, [esi+10h]
		shr	ecx, 3
		and	ecx, 3Fh
		mov	eax, 38h
		cmp	ecx, 38h
		jb	short loc_10008A22
		mov	eax, 78h

loc_10008A22:				; CODE XREF: sub_100089C0+5Bj
		sub	eax, ecx
		push	eax
		push	offset dword_1002D0E8
		push	esi
		call	sub_10008900
		push	8
		lea	eax, [esp+28h+var_C]
		push	eax
		push	esi
		call	sub_10008900
		add	esp, 18h
		lea	ecx, [ebp+1]
		lea	eax, [esi+2]
		mov	edi, 4
		jmp	short loc_10008A50
; ---------------------------------------------------------------------------
		align 10h

loc_10008A50:				; CODE XREF: sub_100089C0+8Bj
					; sub_100089C0+B1j
		movzx	edx, byte ptr [eax-2]
		mov	[ecx-1], dl
		movzx	edx, byte ptr [eax-1]
		mov	[ecx], dl
		movzx	edx, byte ptr [eax]
		mov	[ecx+1], dl
		movzx	edx, byte ptr [eax+1]
		mov	[ecx+2], dl
		add	eax, 4
		add	ecx, 4
		dec	edi
		jnz	short loc_10008A50
		push	58h
		push	edi
		push	esi
		call	sub_1000E0F0
		mov	ecx, [esp+24h+var_4]
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0Ch
		retn
sub_100089C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008AA0	proc near		; CODE XREF: sub_10008C00+34p
					; DATA XREF: sub_10007350+C6o

var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_58		= byte ptr -58h
var_48		= byte ptr -48h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0B0h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0B0h+var_4], eax
		push	ebx
		mov	ebx, [esp+0B4h+arg_4]
		push	ebp
		push	esi
		mov	esi, [esp+0BCh+arg_0]
		push	edi
		mov	edi, [esp+0C0h+arg_8]
		xor	ebp, ebp
		cmp	edi, 40h
		jle	short loc_10008B21
		push	edi
		lea	eax, [esp+0C4h+var_B0]
		push	ebx
		push	eax
		mov	[esp+0CCh+var_9C], ebp
		mov	[esp+0CCh+var_A0], ebp
		mov	[esp+0CCh+var_B0], 67452301h
		mov	[esp+0CCh+var_AC], 0EFCDAB89h
		mov	[esp+0CCh+var_A8], 98BADCFEh
		mov	[esp+0CCh+var_A4], 10325476h
		call	sub_10008900
		lea	ecx, [esp+0CCh+var_B0]
		push	ecx
		lea	edx, [esp+0D0h+var_58]
		push	edx
		call	sub_100089C0
		add	esp, 14h
		lea	ebx, [esp+0C0h+var_58]
		lea	edi, [ebp+10h]

loc_10008B21:				; CODE XREF: sub_10008AA0+32j
		push	41h
		lea	eax, [esp+0C4h+var_48]
		push	ebp
		push	eax
		call	sub_1000E0F0
		push	41h
		lea	ecx, [esp+0D0h+var_B0]
		push	ebp
		push	ecx
		call	sub_1000E0F0
		add	esp, 18h
		cmp	edi, ebp
		jbe	short loc_10008B64
		push	edi
		lea	edx, [esp+0C4h+var_48]
		push	ebx
		push	edx
		call	sub_1000E2B0
		add	esp, 0Ch
		cmp	edi, ebp
		jbe	short loc_10008B64
		push	edi
		lea	eax, [esp+0C4h+var_B0]
		push	ebx
		push	eax
		call	sub_1000E2B0
		add	esp, 0Ch

loc_10008B64:				; CODE XREF: sub_10008AA0+A0j
					; sub_10008AA0+B3j
		xor	eax, eax
		jmp	short loc_10008B70
; ---------------------------------------------------------------------------
		align 10h

loc_10008B70:				; CODE XREF: sub_10008AA0+C6j
					; sub_10008AA0+DEj
		xor	[esp+eax+0C0h+var_48], 36h
		xor	byte ptr [esp+eax+0C0h+var_B0],	5Ch
		inc	eax
		cmp	eax, 40h
		jl	short loc_10008B70
		push	40h
		lea	ecx, [esp+0C4h+var_48]
		push	ecx
		mov	edi, 0EFCDAB89h
		mov	ebx, 98BADCFEh
		push	esi
		mov	[esi+14h], ebp
		mov	[esi+10h], ebp
		mov	dword ptr [esi], 67452301h
		mov	[esi+4], edi
		mov	[esi+8], ebx
		mov	dword ptr [esi+0Ch], 10325476h
		call	sub_10008900
		lea	eax, [esi+58h]
		push	40h
		lea	edx, [esp+0D0h+var_B0]
		push	edx
		push	eax
		mov	[eax+14h], ebp
		mov	[eax+10h], ebp
		mov	dword ptr [eax], 67452301h
		mov	[eax+4], edi
		mov	[eax+8], ebx
		mov	dword ptr [eax+0Ch], 10325476h
		call	sub_10008900
		mov	ecx, [esp+0D8h+var_4]
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0B0h
		retn
sub_10008AA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008C00	proc near		; DATA XREF: sub_10007350+D4o

var_B8		= dword	ptr -0B8h
var_B4		= byte ptr -0B4h
var_5C		= byte ptr -5Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 0B8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0B8h+var_4], eax
		mov	ecx, [esp+0B8h+arg_8]
		mov	eax, [esp+0B8h+arg_4]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0C4h+arg_0]
		push	edi
		push	ecx
		push	eax
		lea	edx, [esp+0D0h+var_B4]
		push	edx
		call	sub_10008AA0
		mov	edi, ds:htonl
		lea	ebx, [esp+0D4h+var_B4]
		lea	ebp, [esp+0D4h+var_5C]
		add	esp, 0Ch
		sub	ebx, esi
		sub	ebp, esi
		mov	[esp+0C8h+var_B8], 4

loc_10008C56:				; CODE XREF: sub_10008C00+6Ej
		mov	eax, [ebx+esi]
		push	eax		; hostlong
		call	edi ; htonl
		mov	ecx, [esi+ebp]
		push	ecx		; hostlong
		mov	[esi], eax
		call	edi ; htonl
		mov	[esi+10h], eax
		add	esi, 4
		dec	[esp+0C8h+var_B8]
		jnz	short loc_10008C56
		mov	ecx, [esp+0C8h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0B8h
		retn
sub_10008C00	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10008C90:				; DATA XREF: sub_10007350+CDo
		push	esi
		mov	esi, [esp+8]
		push	edi
		mov	edi, [esp+10h]
		push	edi
		push	esi
		call	sub_100089C0
		push	10h
		add	edi, 58h
		push	esi
		push	edi
		call	sub_10008900
		push	edi
		push	esi
		call	sub_100089C0
		add	esp, 1Ch
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008CC0	proc near		; DATA XREF: sub_10007350+BFo

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_9C		= byte ptr -9Ch
var_8C		= byte ptr -8Ch
var_48		= byte ptr -48h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 0F8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0F8h+var_4], eax
		mov	eax, [esp+0F8h+arg_0]
		push	ebx
		mov	ebx, [esp+0FCh+arg_10]
		push	ebp
		push	esi
		mov	esi, [esp+104h+arg_C]
		xor	ebp, ebp
		push	edi
		mov	edi, [esp+108h+arg_8]
		mov	[esp+108h+var_F8], eax
		cmp	esi, 40h
		jle	short loc_10008D4C
		push	esi
		lea	ecx, [esp+10Ch+var_F4]
		push	edi
		push	ecx
		mov	[esp+114h+var_E0], ebp
		mov	[esp+114h+var_E4], ebp
		mov	[esp+114h+var_F4], 67452301h
		mov	[esp+114h+var_F0], 0EFCDAB89h
		mov	[esp+114h+var_EC], 98BADCFEh
		mov	[esp+114h+var_E8], 10325476h
		call	sub_10008900
		lea	edx, [esp+114h+var_F4]
		push	edx
		lea	eax, [esp+118h+var_9C]
		push	eax
		call	sub_100089C0
		add	esp, 14h
		lea	edi, [esp+108h+var_9C]
		lea	esi, [ebp+10h]

loc_10008D4C:				; CODE XREF: sub_10008CC0+3Dj
		push	41h
		lea	ecx, [esp+10Ch+var_8C]
		push	ebp
		push	ecx
		call	sub_1000E0F0
		push	41h
		lea	edx, [esp+118h+var_48]
		push	ebp
		push	edx
		call	sub_1000E0F0
		add	esp, 18h
		cmp	esi, ebp
		jbe	short loc_10008D9B
		push	esi
		lea	eax, [esp+10Ch+var_8C]
		push	edi
		push	eax
		call	sub_1000E2B0
		add	esp, 0Ch
		cmp	esi, ebp
		jbe	short loc_10008D9B
		push	esi
		lea	ecx, [esp+10Ch+var_48]
		push	edi
		push	ecx
		call	sub_1000E2B0
		add	esp, 0Ch

loc_10008D9B:				; CODE XREF: sub_10008CC0+B1j
					; sub_10008CC0+C7j
		xor	eax, eax
		lea	ecx, [ecx+0]

loc_10008DA0:				; CODE XREF: sub_10008CC0+F1j
		xor	[esp+eax+108h+var_8C], 36h
		xor	[esp+eax+108h+var_48], 5Ch
		inc	eax
		cmp	eax, 40h
		jl	short loc_10008DA0
		push	40h
		lea	edx, [esp+10Ch+var_8C]
		push	edx
		lea	eax, [esp+110h+var_F4]
		mov	esi, 67452301h
		mov	edi, 0EFCDAB89h
		push	eax
		mov	[esp+114h+var_E0], ebp
		mov	[esp+114h+var_E4], ebp
		mov	[esp+114h+var_F4], esi
		mov	[esp+114h+var_F0], edi
		mov	[esp+114h+var_EC], 98BADCFEh
		mov	[esp+114h+var_E8], 10325476h
		call	sub_10008900
		mov	ecx, [esp+114h+arg_4]
		mov	edx, [esp+114h+var_F8]
		push	ecx
		push	edx
		lea	eax, [esp+11Ch+var_F4]
		push	eax
		call	sub_10008900
		lea	ecx, [esp+120h+var_F4]
		push	ecx
		push	ebx
		call	sub_100089C0
		push	40h
		lea	edx, [esp+12Ch+var_48]
		push	edx
		lea	eax, [esp+130h+var_F4]
		push	eax
		mov	[esp+134h+var_E0], ebp
		mov	[esp+134h+var_E4], ebp
		mov	[esp+134h+var_F4], esi
		mov	[esp+134h+var_F0], edi
		mov	[esp+134h+var_EC], 98BADCFEh
		mov	[esp+134h+var_E8], 10325476h
		call	sub_10008900
		push	10h
		lea	ecx, [esp+138h+var_F4]
		push	ebx
		push	ecx
		call	sub_10008900
		lea	edx, [esp+140h+var_F4]
		push	edx
		push	ebx
		call	sub_100089C0
		mov	ecx, [esp+148h+var_4]
		add	esp, 40h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0F8h
		retn
sub_10008CC0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  40. sasl_encode64

; =============== S U B	R O U T	I N E =======================================


		public sasl_encode64
sasl_encode64	proc near		; DATA XREF: sub_10007350+FEo
					; .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	ecx, [esp+arg_8]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, [esp+8+arg_4]
		test	edi, edi
		jz	short loc_10008E9C
		test	esi, esi
		jnz	short loc_10008E9C
		pop	edi
		lea	eax, [esi-7]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008E9C:				; CODE XREF: sasl_encode64+10j
					; sasl_encode64+14j
		lea	edx, [edi+2]
		mov	eax, 0AAAAAAABh
		mul	edx
		mov	eax, [esp+8+arg_10]
		shr	edx, 1
		add	edx, edx
		add	edx, edx
		test	eax, eax
		jz	short loc_10008EB6
		mov	[eax], edx

loc_10008EB6:				; CODE XREF: sasl_encode64+32j
		cmp	[esp+8+arg_C], edx
		ja	short loc_10008EC4
		pop	edi
		mov	eax, 0FFFFFFFDh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008EC4:				; CODE XREF: sasl_encode64+3Aj
		cmp	edi, 3
		jb	short loc_10008F3A
		mov	eax, 0AAAAAAABh
		mul	edi
		shr	edx, 1
		push	ebx

loc_10008ED3:				; CODE XREF: sasl_encode64+B7j
		movzx	eax, byte ptr [esi]
		shr	eax, 2
		movzx	eax, byte_1002D128[eax]
		mov	[ecx], al
		movzx	eax, byte ptr [esi]
		movzx	ebx, byte ptr [esi+1]
		and	eax, 3
		shl	eax, 4
		shr	ebx, 4
		or	eax, ebx
		movzx	eax, byte_1002D128[eax]
		mov	[ecx+1], al
		movzx	eax, byte ptr [esi+1]
		movzx	ebx, byte ptr [esi+2]
		and	eax, 0Fh
		add	eax, eax
		add	eax, eax
		shr	ebx, 6
		or	eax, ebx
		movzx	eax, byte_1002D128[eax]
		mov	[ecx+2], al
		movzx	eax, byte ptr [esi+2]
		and	eax, 3Fh
		movzx	eax, byte_1002D128[eax]
		mov	[ecx+3], al
		add	ecx, 4
		add	esi, 3
		sub	edi, 3
		dec	edx
		jnz	short loc_10008ED3
		pop	ebx

loc_10008F3A:				; CODE XREF: sasl_encode64+47j
		test	edi, edi
		jz	short loc_10008FA1
		movzx	edx, byte ptr [esi]
		shr	edx, 2
		movzx	eax, byte_1002D128[edx]
		mov	[ecx], al
		mov	al, [esi]
		and	al, 3
		shl	al, 4
		cmp	edi, 1
		jbe	short loc_10008F61
		mov	dl, [esi+1]
		shr	dl, 4
		or	al, dl

loc_10008F61:				; CODE XREF: sasl_encode64+D7j
		movzx	eax, al
		mov	dl, byte_1002D128[eax]
		mov	[ecx+1], dl
		cmp	edi, 2
		jnb	short loc_10008F88
		mov	eax, 3Dh
		mov	[ecx+2], al
		mov	[ecx+3], al
		add	ecx, 4
		pop	edi
		mov	byte ptr [ecx],	0
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008F88:				; CODE XREF: sasl_encode64+F0j
		movzx	eax, byte ptr [esi+1]
		and	eax, 0Fh
		movsx	eax, byte_1002D128[eax*4]
		mov	[ecx+2], al
		mov	byte ptr [ecx+3], 3Dh
		add	ecx, 4

loc_10008FA1:				; CODE XREF: sasl_encode64+BCj
		pop	edi
		mov	byte ptr [ecx],	0
		xor	eax, eax
		pop	esi
		retn
sasl_encode64	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  36. sasl_decode64

; =============== S U B	R O U T	I N E =======================================


		public sasl_decode64
sasl_decode64	proc near		; DATA XREF: sub_10007350+105o
					; .rdata:off_1002C568o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		mov	eax, [esp+1Ch+arg_10]
		push	ebx
		push	edi
		mov	edi, [esp+24h+arg_8]
		xor	ebx, ebx
		mov	[esp+24h+var_18], eax
		mov	[esp+24h+var_1C], ebx
		cmp	edi, ebx
		jnz	short loc_10008FEA
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10008FEA:				; CODE XREF: sasl_decode64+24j
		mov	ecx, [esp+24h+arg_4]
		push	ebp
		mov	ebp, [esp+28h+arg_0]
		cmp	ecx, ebx
		jbe	short loc_10009012
		cmp	byte ptr [ebp+0], 0Dh
		jnz	short loc_10009012
		pop	ebp
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10009012:				; CODE XREF: sasl_decode64+45j
					; sasl_decode64+4Bj
		push	esi
		cmp	ecx, 3
		jbe	loc_10009154
		add	ebp, 2
		nop

loc_10009020:				; CODE XREF: sasl_decode64+19Aj
		cmp	[esp+2Ch+var_1C], 0
		jnz	short loc_1000909C
		movsx	ecx, byte ptr [ebp-2]
		movsx	edx, byte ptr [ebp-1]
		movsx	eax, byte ptr [ebp+1]
		movsx	esi, byte ptr [ebp+0]
		sub	[esp+2Ch+arg_4], 4
		add	ebp, 4
		mov	[esp+2Ch+var_10], edx
		mov	[esp+2Ch+var_8], eax
		cmp	ecx, 7Fh
		ja	short loc_1000909C
		movsx	ecx, byte_1002D1F8[ecx]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_1000909C
		cmp	edx, 7Fh
		ja	short loc_1000909C
		movsx	edx, byte_1002D1F8[edx]
		cmp	edx, 0FFFFFFFFh
		jz	short loc_1000909C
		cmp	esi, 3Dh
		jz	short loc_1000907C
		cmp	esi, 7Fh
		ja	short loc_1000909C
		cmp	byte_1002D1F8[esi], 0FFh
		jz	short loc_1000909C

loc_1000907C:				; CODE XREF: sasl_decode64+BCj
		mov	eax, [esp+2Ch+var_8]
		cmp	eax, 3Dh
		jz	short loc_10009093
		cmp	eax, 7Fh
		ja	short loc_1000909C
		cmp	byte_1002D1F8[eax], 0FFh
		jz	short loc_1000909C

loc_10009093:				; CODE XREF: sasl_decode64+D3j
		cmp	esi, 3Dh
		jnz	short loc_100090B4
		cmp	eax, esi
		jz	short loc_100090B9

loc_1000909C:				; CODE XREF: sasl_decode64+75j
					; sasl_decode64+9Aj ...
		pop	esi
		pop	ebp
		pop	edi
		mov	eax, 0FFFFFFFBh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_100090B4:				; CODE XREF: sasl_decode64+E6j
		cmp	eax, 3Dh
		jnz	short loc_100090C1

loc_100090B9:				; CODE XREF: sasl_decode64+EAj
		mov	[esp+2Ch+var_1C], 1

loc_100090C1:				; CODE XREF: sasl_decode64+107j
		mov	eax, [esp+2Ch+arg_C]
		add	cl, cl
		sar	edx, 4
		add	cl, cl
		or	dl, cl
		mov	[edi], dl
		inc	ebx
		inc	edi
		cmp	ebx, eax
		jnb	loc_10009180
		cmp	esi, 3Dh
		jz	short loc_10009143
		mov	ecx, [esp+2Ch+var_10]
		movsx	ecx, byte_1002D1F8[ecx]
		cmp	esi, 7Fh
		ja	short loc_100090F8
		movsx	edx, byte_1002D1F8[esi]
		jmp	short loc_100090FB
; ---------------------------------------------------------------------------

loc_100090F8:				; CODE XREF: sasl_decode64+13Dj
		or	edx, 0FFFFFFFFh

loc_100090FB:				; CODE XREF: sasl_decode64+146j
		sar	edx, 2
		shl	cl, 4
		or	dl, cl
		mov	[edi], dl
		inc	ebx
		inc	edi
		cmp	ebx, eax
		jnb	short loc_10009180
		mov	edx, [esp+2Ch+var_8]
		cmp	edx, 3Dh
		jz	short loc_10009143
		cmp	esi, 7Fh
		ja	short loc_10009122
		movsx	ecx, byte_1002D1F8[esi]
		jmp	short loc_10009125
; ---------------------------------------------------------------------------

loc_10009122:				; CODE XREF: sasl_decode64+167j
		or	ecx, 0FFFFFFFFh

loc_10009125:				; CODE XREF: sasl_decode64+170j
		cmp	edx, 7Fh
		ja	short loc_10009133
		movsx	edx, byte_1002D1F8[edx]
		jmp	short loc_10009136
; ---------------------------------------------------------------------------

loc_10009133:				; CODE XREF: sasl_decode64+178j
		or	edx, 0FFFFFFFFh

loc_10009136:				; CODE XREF: sasl_decode64+181j
		shl	cl, 6
		or	cl, dl
		mov	[edi], cl
		inc	ebx
		inc	edi
		cmp	ebx, eax
		jnb	short loc_10009180

loc_10009143:				; CODE XREF: sasl_decode64+12Dj
					; sasl_decode64+162j
		mov	ecx, [esp+2Ch+arg_4]
		cmp	ecx, 3
		ja	loc_10009020
		mov	eax, [esp+2Ch+var_18]

loc_10009154:				; CODE XREF: sasl_decode64+66j
		mov	byte ptr [edi],	0
		test	eax, eax
		jz	short loc_1000915D
		mov	[eax], ebx

loc_1000915D:				; CODE XREF: sasl_decode64+1A9j
		test	ecx, ecx
		jz	short loc_10009198
		mov	eax, [esp+2Ch+var_1C]
		neg	eax
		pop	esi
		sbb	eax, eax
		pop	ebp
		and	eax, 0FFFFFFFAh
		pop	edi
		inc	eax
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10009180:				; CODE XREF: sasl_decode64+124j
					; sasl_decode64+159j ...
		pop	esi
		pop	ebp
		pop	edi
		mov	eax, 0FFFFFFFDh
		pop	ebx
		mov	ecx, [esp+1Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10009198:				; CODE XREF: sasl_decode64+1AFj
		mov	ecx, [esp+2Ch+var_4]
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sasl_decode64	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  70. sasl_utf8verify

; =============== S U B	R O U T	I N E =======================================


		public sasl_utf8verify
sasl_utf8verify	proc near		; DATA XREF: sub_10007350+E9o
					; .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		xor	eax, eax
		test	edi, edi
		jz	short loc_10009205
		mov	esi, [esp+0Ch+arg_0]

loc_100091C1:				; CODE XREF: sasl_utf8verify+53j
		movsx	edx, byte ptr [eax+esi]
		xor	ecx, ecx
		test	dl, dl
		jns	short loc_10009200
		jmp	short loc_100091D0
; ---------------------------------------------------------------------------
		align 10h

loc_100091D0:				; CODE XREF: sasl_utf8verify+1Bj
					; sasl_utf8verify+2Aj
		inc	ecx
		mov	ebx, 80h
		sar	ebx, cl
		test	edx, ebx
		jnz	short loc_100091D0
		test	ecx, ecx
		jz	short loc_10009200
		cmp	ecx, 1
		jz	short loc_1000920B
		cmp	ecx, 6
		jg	short loc_1000920B
		dec	ecx
		jz	short loc_10009200
		lea	ecx, [ecx+0]

loc_100091F0:				; CODE XREF: sasl_utf8verify+4Ej
		mov	dl, [eax+esi+1]
		inc	eax
		and	dl, 0C0h
		cmp	dl, 0F0h
		jnz	short loc_1000920B
		dec	ecx
		jnz	short loc_100091F0

loc_10009200:				; CODE XREF: sasl_utf8verify+19j
					; sasl_utf8verify+2Ej ...
		inc	eax
		cmp	eax, edi
		jb	short loc_100091C1

loc_10009205:				; CODE XREF: sasl_utf8verify+Bj
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000920B:				; CODE XREF: sasl_utf8verify+33j
					; sasl_utf8verify+38j ...
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFBh
		pop	ebx
		retn
sasl_utf8verify	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		push	esi
		mov	esi, [esp+8]
		mov	[esi], eax
		push	eax
		mov	[esi+4], ax
		call	sub_10010224
		xor	[esi+2], ax
		mov	ecx, eax
		sar	ecx, 10h
		xor	[esi], cx
		add	esp, 4
		call	sub_1001016B
		xor	[esi+4], ax
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  52. sasl_randcreate

; =============== S U B	R O U T	I N E =======================================


		public sasl_randcreate
sasl_randcreate	proc near		; CODE XREF: sub_10007350+29p
					; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4

		push	0Ch
		call	off_1002D044
		mov	ecx, [esp+4+arg_0]
		add	esp, 4
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_1000926B
		mov	eax, 0FFFFFFFEh
		retn
; ---------------------------------------------------------------------------

loc_1000926B:				; CODE XREF: sasl_randcreate+13j
		mov	dword ptr [eax+8], 0
		xor	eax, eax
		retn
sasl_randcreate	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  53. sasl_randfree

; =============== S U B	R O U T	I N E =======================================


		public sasl_randfree
sasl_randfree	proc near		; CODE XREF: sub_100054F0+19p
					; sub_10006260+63p
					; DATA XREF: ...

lpMem		= dword	ptr  4

		mov	eax, [esp+lpMem]
		mov	ecx, [eax]
		mov	[esp+lpMem], ecx ; lpMem
		jmp	off_1002D050
sasl_randfree	endp

; Exported entry  54. sasl_randseed

; =============== S U B	R O U T	I N E =======================================


		public sasl_randseed
sasl_randseed	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_4]
		test	ecx, ecx
		jz	short locret_100092E9
		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_100092E8
		mov	edx, [esp+4+arg_8]
		mov	dword ptr [esi+8], 1
		cmp	edx, 6
		jbe	short loc_100092B6
		mov	edx, 6

loc_100092B6:				; CODE XREF: sasl_randseed+1Fj
		xor	eax, eax
		test	edx, edx
		jz	short loc_100092E8
		push	ebx
		push	edi
		mov	edi, edi

loc_100092C0:				; CODE XREF: sasl_randseed+54j
		movsx	di, byte ptr [ecx+eax]
		mov	ebx, 100h
		imul	di, bx
		movsx	bx, byte ptr [ecx+eax+1]
		add	di, bx
		mov	ebx, eax
		shr	ebx, 1
		add	eax, 2
		mov	[esi+ebx*2], di
		cmp	eax, edx
		jb	short loc_100092C0
		pop	edi
		pop	ebx

loc_100092E8:				; CODE XREF: sasl_randseed+Fj
					; sasl_randseed+2Aj
		pop	esi

locret_100092E9:			; CODE XREF: sasl_randseed+6j
		retn
sasl_randseed	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100092F0	proc near		; CODE XREF: sasl_rand+13p
					; sasl_churn+13p
		test	esi, esi
		jz	short locret_1000932F
		cmp	dword ptr [esi+8], 0
		jnz	short locret_1000932F
		xor	eax, eax
		mov	[esi], eax
		push	eax
		mov	[esi+4], ax
		call	sub_10010224
		xor	[esi+2], ax
		mov	ecx, eax
		sar	ecx, 10h
		xor	[esi], cx
		call	sub_1001016B
		mov	edx, [esi]
		xor	[esi+4], ax
		push	edx
		mov	dword ptr [esi+8], 1
		call	sub_1001022F
		add	esp, 8

locret_1000932F:			; CODE XREF: sub_100092F0+2j
					; sub_100092F0+8j
		retn
sub_100092F0	endp

; Exported entry  51. sasl_rand

; =============== S U B	R O U T	I N E =======================================


		public sasl_rand
sasl_rand	proc near		; CODE XREF: sasl_mkchal+5Cp
					; DATA XREF: sub_10007350+F0o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_1000937D
		push	ebx
		mov	ebx, [esp+8+arg_4]
		test	ebx, ebx
		jz	short loc_1000937C
		push	edi
		call	sub_100092F0
		mov	edi, [esp+0Ch+arg_8]
		xor	esi, esi
		test	edi, edi
		jz	short loc_1000937B

loc_10009352:				; CODE XREF: sasl_rand+49j
		lea	eax, [esp+0Ch+arg_0]
		push	eax
		call	sub_10010272
		add	esp, 4
		test	eax, eax
		jz	short loc_1000936C
		call	sub_10010241
		mov	[esp+0Ch+arg_0], eax

loc_1000936C:				; CODE XREF: sasl_rand+31j
		mov	ecx, [esp+0Ch+arg_0]
		shr	ecx, 8
		mov	[esi+ebx], cl
		inc	esi
		cmp	esi, edi
		jb	short loc_10009352

loc_1000937B:				; CODE XREF: sasl_rand+20j
		pop	edi

loc_1000937C:				; CODE XREF: sasl_rand+10j
		pop	ebx

loc_1000937D:				; CODE XREF: sasl_rand+7j
		pop	esi
		retn
sasl_rand	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  26. sasl_churn

; =============== S U B	R O U T	I N E =======================================


		public sasl_churn
sasl_churn	proc near		; DATA XREF: sub_10007350+F7o
					; .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jz	short loc_100093C4
		push	ebx
		mov	ebx, [esp+8+arg_4]
		test	ebx, ebx
		jz	short loc_100093C3
		push	edi
		call	sub_100092F0
		mov	edi, [esp+0Ch+arg_8]
		xor	ecx, ecx
		test	edi, edi
		jz	short loc_100093C2

loc_100093A2:				; CODE XREF: sasl_churn+40j
		mov	eax, 0AAAAAAABh
		mul	ecx
		shr	edx, 1
		lea	eax, [edx+edx*2]
		mov	edx, ecx
		sub	edx, eax
		lea	eax, [esi+edx*2]
		movsx	dx, byte ptr [ecx+ebx]
		xor	[eax], dx
		inc	ecx
		cmp	ecx, edi
		jb	short loc_100093A2

loc_100093C2:				; CODE XREF: sasl_churn+20j
		pop	edi

loc_100093C3:				; CODE XREF: sasl_churn+10j
		pop	ebx

loc_100093C4:				; CODE XREF: sasl_churn+7j
		pop	esi
		retn
sasl_churn	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  42. sasl_erasebuffer

; =============== S U B	R O U T	I N E =======================================


		public sasl_erasebuffer
sasl_erasebuffer proc near		; DATA XREF: sub_10007350+10Co
					; .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	eax
		push	0
		push	ecx
		call	sub_1000E0F0
		add	esp, 0Ch
		retn
sasl_erasebuffer endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  68. sasl_strlower

; =============== S U B	R O U T	I N E =======================================


		public sasl_strlower
sasl_strlower	proc near		; CODE XREF: sub_100075A0+225p
					; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_100093F9
		retn
; ---------------------------------------------------------------------------

loc_100093F9:				; CODE XREF: sasl_strlower+6j
		cmp	byte ptr [eax],	0
		jz	short locret_10009417
		mov	edx, eax

loc_10009400:				; CODE XREF: sasl_strlower+25j
		mov	cl, [edx]
		cmp	cl, 41h
		jl	short loc_10009411
		cmp	cl, 5Ah
		jg	short loc_10009411
		add	cl, 20h
		mov	[edx], cl

loc_10009411:				; CODE XREF: sasl_strlower+15j
					; sasl_strlower+1Aj
		inc	edx
		cmp	byte ptr [edx],	0
		jnz	short loc_10009400

locret_10009417:			; CODE XREF: sasl_strlower+Cj
		retn
sasl_strlower	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10009420(char	*name, int namelen, int)
sub_10009420	proc near		; CODE XREF: sasl_client_new+388p
					; sub_100075A0+272p

ppResult	= dword	ptr -24h
pHints		= ADDRINFOA ptr	-20h
name		= dword	ptr  4
namelen		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 24h
		push	ebx
		push	esi
		mov	esi, [esp+2Ch+name]
		push	edi
		mov	edi, [esp+30h+namelen]
		push	edi		; namelen
		push	esi		; name
		call	ds:gethostname
		xor	ebx, ebx
		cmp	eax, ebx
		jnz	loc_10009515
		push	2Eh
		push	esi
		call	sub_1000EF20
		add	esp, 8
		test	eax, eax
		jnz	loc_100094F3
		lea	eax, [esp+30h+ppResult]
		push	eax		; ppResult
		lea	ecx, [esp+34h+pHints]
		push	ecx		; pHints
		push	ebx		; pServiceName
		push	esi		; pNodeName
		mov	[esp+40h+pHints.ai_family], ebx
		mov	[esp+40h+pHints.ai_flags], 2
		mov	[esp+40h+pHints.ai_socktype], 1
		mov	[esp+40h+pHints.ai_protocol], ebx
		mov	[esp+40h+pHints.ai_addrlen], ebx
		mov	[esp+40h+pHints.ai_canonname], ebx
		mov	[esp+40h+pHints.ai_addr], ebx
		mov	[esp+40h+pHints.ai_next], ebx
		call	ds:getaddrinfo
		test	eax, eax
		jnz	short loc_100094CC
		cmp	[esp+30h+arg_8], ebx
		jz	short loc_100094D6
		mov	eax, [esp+30h+ppResult]
		cmp	eax, ebx
		jz	short loc_100094BA
		cmp	[eax+14h], ebx
		jz	short loc_100094BA
		mov	edx, [eax+14h]
		push	2Eh
		push	edx
		call	sub_1000EF20
		add	esp, 8
		test	eax, eax
		jnz	short loc_100094D6
		mov	eax, [esp+30h+ppResult]

loc_100094BA:				; CODE XREF: sub_10009420+7Dj
					; sub_10009420+82j
		push	eax		; pAddrInfo
		call	ds:freeaddrinfo
		push	2AFCh		; iError
		call	ds:WSASetLastError

loc_100094CC:				; CODE XREF: sub_10009420+6Fj
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_100094D6:				; CODE XREF: sub_10009420+75j
					; sub_10009420+94j
		mov	ecx, [esp+30h+ppResult]
		mov	edx, [ecx+14h]
		push	edi
		push	edx
		push	esi
		call	sub_1000EFE0
		mov	eax, [esp+3Ch+ppResult]
		add	esp, 0Ch
		push	eax		; pAddrInfo
		call	ds:freeaddrinfo

loc_100094F3:				; CODE XREF: sub_10009420+2Dj
		cmp	esi, ebx
		jz	short loc_10009513
		cmp	[esi], bl
		jz	short loc_10009513
		mov	ecx, esi
		lea	ecx, [ecx+0]

loc_10009500:				; CODE XREF: sub_10009420+F1j
		mov	al, [ecx]
		cmp	al, 41h
		jl	short loc_1000950E
		cmp	al, 5Ah
		jg	short loc_1000950E
		add	al, 20h
		mov	[ecx], al

loc_1000950E:				; CODE XREF: sub_10009420+E4j
					; sub_10009420+E8j
		inc	ecx
		cmp	[ecx], bl
		jnz	short loc_10009500

loc_10009513:				; CODE XREF: sub_10009420+D5j
					; sub_10009420+D9j
		xor	eax, eax

loc_10009515:				; CODE XREF: sub_10009420+1Aj
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 24h
		retn
sub_10009420	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   2. getopt

; =============== S U B	R O U T	I N E =======================================


		public getopt
getopt		proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, dword_1002E5C4
		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		xor	ebx, ebx
		push	edi
		mov	edi, [esp+10h+arg_4]
		cmp	eax, ebx
		jz	short loc_10009548
		inc	eax
		mov	dword_1002E5C4,	eax
		cmp	[eax], bl
		jz	short loc_10009548
		mov	esi, eax
		jmp	loc_100095E1
; ---------------------------------------------------------------------------

loc_10009548:				; CODE XREF: getopt+15j getopt+1Fj
		mov	eax, optind
		cmp	eax, ebp
		jge	short loc_10009572
		mov	esi, [edi+eax*4]
		inc	eax
		mov	optind,	eax
		mov	cl, [esi]
		cmp	cl, 2Fh
		jz	short loc_10009580
		cmp	cl, 2Dh
		jz	short loc_10009580
		dec	eax
		mov	optind,	eax

loc_1000956C:				; CODE XREF: getopt+8Ej getopt+BEj
		mov	optarg,	ebx

loc_10009572:				; CODE XREF: getopt+2Fj
		pop	edi
		pop	esi
		pop	ebp
		mov	dword_1002E5C4,	ebx
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009580:				; CODE XREF: getopt+3Fj getopt+44j
		mov	ecx, offset asc_10028110 ; "-"
		mov	eax, esi

loc_10009587:				; CODE XREF: getopt+81j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_100095A7
		cmp	dl, bl
		jz	short loc_100095A3
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_100095A7
		add	eax, 2
		add	ecx, 2
		cmp	dl, bl
		jnz	short loc_10009587

loc_100095A3:				; CODE XREF: getopt+6Fj
		xor	eax, eax
		jmp	short loc_100095AC
; ---------------------------------------------------------------------------

loc_100095A7:				; CODE XREF: getopt+6Bj getopt+77j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_100095AC:				; CODE XREF: getopt+85j
		cmp	eax, ebx
		jz	short loc_1000956C
		mov	ecx, offset asc_1002810C ; "--"
		mov	eax, esi

loc_100095B7:				; CODE XREF: getopt+B1j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_100095D7
		cmp	dl, bl
		jz	short loc_100095D3
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_100095D7
		add	eax, 2
		add	ecx, 2
		cmp	dl, bl
		jnz	short loc_100095B7

loc_100095D3:				; CODE XREF: getopt+9Fj
		xor	eax, eax
		jmp	short loc_100095DC
; ---------------------------------------------------------------------------

loc_100095D7:				; CODE XREF: getopt+9Bj getopt+A7j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_100095DC:				; CODE XREF: getopt+B5j
		cmp	eax, ebx
		jz	short loc_1000956C
		inc	esi

loc_100095E1:				; CODE XREF: getopt+23j
		mov	al, [esi]
		cmp	al, 3Ah
		jnz	short loc_100095FB
		mov	eax, opterr
		neg	eax
		pop	edi
		sbb	eax, eax
		pop	esi
		and	eax, 5
		pop	ebp
		add	eax, 3Ah
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100095FB:				; CODE XREF: getopt+C5j
		mov	ecx, [esp+10h+arg_8]
		movsx	eax, al
		push	eax
		push	ecx
		call	sub_1000EF20
		add	esp, 8
		cmp	eax, ebx
		jnz	short loc_10009631
		mov	dword_1002E5C4,	ebx

loc_10009616:				; CODE XREF: getopt+139j
		mov	optarg,	ebx
		mov	eax, 3Fh
		cmp	opterr,	ebx
		jnz	short loc_10009687
		movsx	eax, byte ptr [esi]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009631:				; CODE XREF: getopt+EEj
		cmp	byte ptr [eax+1], 3Ah
		jnz	short loc_10009678
		cmp	[esi+1], bl
		lea	eax, [esi+1]
		jz	short loc_10009652
		pop	edi
		mov	optarg,	eax
		movsx	eax, byte ptr [esi]
		pop	esi
		pop	ebp
		mov	dword_1002E5C4,	ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009652:				; CODE XREF: getopt+11Dj
		mov	eax, optind
		cmp	eax, ebp
		jge	short loc_10009616
		mov	edx, [edi+eax*4]
		inc	eax
		pop	edi
		mov	optarg,	edx
		mov	optind,	eax
		movsx	eax, byte ptr [esi]
		pop	esi
		pop	ebp
		mov	dword_1002E5C4,	ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10009678:				; CODE XREF: getopt+115j
		mov	optarg,	ebx
		movsx	eax, byte ptr [esi]
		mov	dword_1002E5C4,	esi

loc_10009687:				; CODE XREF: getopt+107j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
getopt		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   3. getpass

; =============== S U B	R O U T	I N E =======================================


		public getpass
getpass		proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		push	eax
		push	offset aS	; "%s"
		push	offset dword_1002D318
		call	sub_100109A0
		push	offset dword_1002D318
		call	sub_10010944
		add	esp, 10h
		mov	esi, offset dword_1002E4C0
		call	sub_10010700
		cmp	eax, 0Dh
		jz	short loc_100096DB

loc_100096C1:				; CODE XREF: getpass+49j
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100096DB
		cmp	esi, offset word_1002E5BE
		jnb	short loc_100096D1
		mov	[esi], al
		inc	esi

loc_100096D1:				; CODE XREF: getpass+3Cj
		call	sub_10010700
		cmp	eax, 0Dh
		jnz	short loc_100096C1

loc_100096DB:				; CODE XREF: getpass+2Fj getpass+34j
		push	offset asc_100272D8 ; "\n"
		push	offset dword_1002D318
		mov	byte ptr [esi],	0
		call	sub_100109A0
		push	offset dword_1002D318
		call	sub_10010944
		add	esp, 0Ch
		mov	eax, offset dword_1002E4C0
		pop	esi
		retn
getpass		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  50. sasl_mkchal

; =============== S U B	R O U T	I N E =======================================


		public sasl_mkchal
sasl_mkchal	proc near		; DATA XREF: sub_10007350+E2o
					; .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_C]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	edi
		mov	ecx, 2Ch
		test	ebx, ebx
		jz	short loc_1000973D
		mov	eax, [ebp+8E8h]
		test	eax, eax
		jz	short loc_1000973D
		lea	edx, [eax+1]

loc_10009731:				; CODE XREF: sasl_mkchal+26j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10009731
		sub	eax, edx
		lea	ecx, [eax+2Dh]

loc_1000973D:				; CODE XREF: sasl_mkchal+12j
					; sasl_mkchal+1Cj
		mov	edi, [esp+0Ch+arg_8]
		cmp	edi, ecx
		jnb	short loc_1000974B
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000974B:				; CODE XREF: sasl_mkchal+33j
		push	esi
		push	0Ch
		call	off_1002D044
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100097B3
		push	4
		lea	eax, [esp+14h+arg_8]
		push	eax
		push	esi
		mov	dword ptr [esi+8], 0
		call	sasl_rand
		push	esi		; lpMem
		call	off_1002D050
		lea	ecx, [esp+20h+arg_C]
		push	ecx
		call	sub_10010224
		add	esp, 14h
		test	ebx, ebx
		jz	short loc_100097BA
		mov	eax, [ebp+8E8h]
		test	eax, eax
		jz	short loc_100097BA
		mov	edx, [esp+10h+arg_C]
		mov	esi, [esp+10h+arg_4]
		push	eax
		mov	eax, [esp+14h+arg_8]
		push	edx
		push	eax
		push	offset aLu_Lu@S	; "<%lu.%lu@%s>"
		push	edi
		push	esi
		call	sub_1000FA78
		add	esp, 18h
		jmp	short loc_100097D7
; ---------------------------------------------------------------------------

loc_100097B3:				; CODE XREF: sasl_mkchal+4Bj
		pop	esi
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100097BA:				; CODE XREF: sasl_mkchal+77j
					; sasl_mkchal+81j
		mov	ecx, [esp+10h+arg_C]
		mov	edx, [esp+10h+arg_8]
		mov	esi, [esp+10h+arg_4]
		push	ecx
		push	edx
		push	offset aLu_Lu	; "<%lu.%lu>"
		push	edi
		push	esi
		call	sub_1000FA78
		add	esp, 14h

loc_100097D7:				; CODE XREF: sasl_mkchal+A1j
		mov	eax, esi
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_100097E0:				; CODE XREF: sasl_mkchal+D5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100097E0
		pop	esi
		pop	edi
		pop	ebp
		sub	eax, edx
		pop	ebx
		retn
sasl_mkchal	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, dword_1002E5C8
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  66. sasl_setpass

; =============== S U B	R O U T	I N E =======================================


		public sasl_setpass
sasl_setpass	proc near		; CODE XREF: sub_1000A4C0+118p
					; DATA XREF: .rdata:off_1002C568o

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		sub	esp, 30h
		push	ebx
		xor	ebx, ebx
		mov	eax, offset aUserpassword ; "userPassword"
		mov	[esp+34h+var_30], ebx
		mov	[esp+34h+var_14], eax
		mov	[esp+34h+var_10], ebx
		mov	[esp+34h+var_C], eax
		mov	[esp+34h+var_8], offset	asc_10028354 ; "*"
		mov	[esp+34h+var_4], ebx
		mov	[esp+34h+var_24], ebx
		mov	[esp+34h+var_20], ebx
		mov	[esp+34h+var_28], ebx
		mov	[esp+34h+var_2C], ebx
		cmp	dword_1002E5C8,	ebx
		jz	loc_10009C1C
		cmp	dword_1002E5CC,	ebx
		jz	loc_10009C1C
		push	edi
		mov	edi, [esp+38h+arg_0]
		cmp	edi, ebx
		jnz	short loc_10009861
		pop	edi
		lea	eax, [ebx-7]
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_10009861:				; CODE XREF: sasl_setpass+56j
		cmp	dword ptr [edi], 1
		jz	short loc_1000988C
		push	8Dh
		push	offset aParameterErr_2 ; "Parameter error in server.c near line	%"...
		push	1
		push	edi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		mov	[edi+8F0h], eax
		pop	edi
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000988C:				; CODE XREF: sasl_setpass+64j
		mov	eax, [esp+38h+arg_18]
		push	esi
		mov	esi, eax
		and	esi, 2
		jnz	short loc_1000989E
		cmp	[esp+3Ch+arg_C], ebx
		jz	short loc_100098A6

loc_1000989E:				; CODE XREF: sasl_setpass+96j
		test	al, 1
		jz	short loc_100098CD
		cmp	esi, ebx
		jz	short loc_100098CD

loc_100098A6:				; CODE XREF: sasl_setpass+9Cj
		push	91h
		push	offset aParameterErr_2 ; "Parameter error in server.c near line	%"...
		push	1
		push	edi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		pop	esi
		mov	[edi+8F0h], eax
		pop	edi
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_100098CD:				; CODE XREF: sasl_setpass+A0j
					; sasl_setpass+A4j
		lea	eax, [esp+3Ch+arg_0]
		push	eax
		push	0Fh
		push	edi
		call	sasl_getprop
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100098E5
		mov	[esp+3Ch+arg_0], ebx

loc_100098E5:				; CODE XREF: sasl_setpass+DFj
		mov	ecx, [esp+3Ch+arg_18]
		mov	eax, ecx
		and	eax, 8
		mov	[esp+3Ch+var_1C], eax
		jz	short loc_1000991C
		cmp	[esp+3Ch+arg_0], ebx
		jnz	short loc_1000991C
		push	offset aNoCurrentSaslM ; "No current SASL mechanism available"
		push	1
		push	edi
		call	sasl_seterror
		add	esp, 0Ch
		mov	eax, 0FFFFFFF9h
		pop	esi
		mov	[edi+8F0h], eax
		pop	edi
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_1000991C:				; CODE XREF: sasl_setpass+F2j
					; sasl_setpass+F8j
		push	ebp
		mov	ebp, [esp+40h+arg_4]
		cmp	esi, ebx
		jnz	short loc_1000992E
		test	cl, 4
		jnz	loc_10009A15

loc_1000992E:				; CODE XREF: sasl_setpass+123j
		push	ebx
		push	ebx
		push	ebx
		call	sasl_auxprop_store
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10009A15
		mov	edx, [edi+1134h]
		mov	eax, [edx+60h]
		mov	[esp+40h+var_28], 1
		cmp	esi, ebx
		jz	short loc_10009964
		mov	[esp+40h+arg_8], ebx
		mov	[esp+40h+arg_C], ebx
		lea	ecx, [esp+40h+var_C]
		jmp	short loc_10009968
; ---------------------------------------------------------------------------

loc_10009964:				; CODE XREF: sasl_setpass+154j
		lea	ecx, [esp+40h+var_14]

loc_10009968:				; CODE XREF: sasl_setpass+162j
		push	ecx
		push	eax
		call	prop_request
		add	esp, 8
		mov	[esp+40h+var_30], eax
		cmp	eax, ebx
		jnz	short loc_100099E4
		mov	ecx, [esp+40h+arg_C]
		mov	edx, [esp+40h+arg_8]
		mov	eax, [edi+1134h]
		push	ecx
		mov	ecx, [eax+60h]
		push	edx
		push	offset aUserpassword ; "userPassword"
		push	ecx
		call	prop_set
		add	esp, 10h
		mov	[esp+40h+var_30], eax
		cmp	eax, ebx
		jnz	short loc_100099E4
		cmp	esi, ebx
		jz	short loc_100099C8
		mov	edx, [edi+1134h]
		mov	eax, [edx+60h]
		push	ebx
		push	ebx
		push	offset asc_10028354 ; "*"
		push	eax
		call	prop_set
		add	esp, 10h
		mov	[esp+40h+var_30], eax
		cmp	eax, ebx
		jnz	short loc_100099E4

loc_100099C8:				; CODE XREF: sasl_setpass+1A5j
		mov	ecx, [edi+1134h]
		mov	edx, [ecx+60h]
		push	ebp
		push	edx
		push	edi
		call	sasl_auxprop_store
		add	esp, 0Ch
		mov	[esp+40h+var_30], eax
		cmp	eax, ebx
		jz	short loc_10009A04

loc_100099E4:				; CODE XREF: sasl_setpass+178j
					; sasl_setpass+1A1j ...
		mov	eax, [esp+40h+var_30]
		push	eax
		push	ebp
		push	offset aSetpassFailedF ; "setpass failed for %s: %z"
		push	1
		push	edi
		call	sub_10006F30
		add	esp, 14h
		mov	[esp+40h+var_2C], 1
		jmp	short loc_10009A15
; ---------------------------------------------------------------------------

loc_10009A04:				; CODE XREF: sasl_setpass+1E2j
		push	ebp
		push	offset aSetpassSucceed ; "setpass succeeded for	%s"
		push	4
		push	edi
		call	sub_10006F30
		add	esp, 10h

loc_10009A15:				; CODE XREF: sasl_setpass+128j
					; sasl_setpass+13Bj ...
		lea	ecx, [esp+40h+var_20]
		push	ecx
		lea	edx, [esp+44h+var_24]
		push	edx
		push	8006h
		push	edi
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10009AA8
		mov	eax, [esp+40h+var_24]
		cmp	eax, ebx
		jz	short loc_10009AA8
		mov	ecx, [esp+40h+arg_18]
		mov	edx, [edi+1134h]
		push	ecx
		mov	ecx, [edx+60h]
		mov	edx, [esp+44h+arg_C]
		push	ecx
		mov	ecx, [esp+48h+arg_8]
		push	edx
		mov	edx, [esp+4Ch+var_20]
		push	ecx
		push	ebp
		push	edx
		mov	esi, 1
		add	[esp+58h+var_28], esi
		push	edi
		call	eax
		add	esp, 1Ch
		cmp	eax, ebx
		jz	short loc_10009A97
		cmp	eax, 0FFFFFFE2h
		jnz	short loc_10009A7C
		cmp	[esp+40h+var_30], ebx
		jnz	short loc_10009A80
		mov	[esp+40h+var_30], eax
		jmp	short loc_10009A80
; ---------------------------------------------------------------------------

loc_10009A7C:				; CODE XREF: sasl_setpass+26Ej
		mov	[esp+40h+var_30], eax

loc_10009A80:				; CODE XREF: sasl_setpass+274j
					; sasl_setpass+27Aj
		push	eax
		push	ebp
		push	offset aSetpassCallbac ; "setpass callback failed for %s: %z"
		push	esi
		push	edi
		call	sub_10006F30
		add	esp, 14h
		add	[esp+40h+var_2C], esi
		jmp	short loc_10009AA8
; ---------------------------------------------------------------------------

loc_10009A97:				; CODE XREF: sasl_setpass+269j
		push	ebp
		push	offset aSetpassCallb_0 ; "setpass callback succeeded for %s"
		push	4
		push	edi
		call	sub_10006F30
		add	esp, 10h

loc_10009AA8:				; CODE XREF: sasl_setpass+22Fj
					; sasl_setpass+237j ...
		mov	ebx, [edi+113Ch]
		test	ebx, ebx
		jz	loc_10009BCA

loc_10009AB6:				; CODE XREF: sasl_setpass+3C4j
		mov	esi, [ebx+0Ch]
		mov	eax, [esi+24h]
		test	eax, eax
		jz	loc_10009BBF
		cmp	[esp+40h+var_1C], 0
		jz	short loc_10009B01
		mov	ecx, [esi]
		mov	eax, [esp+40h+arg_0]

loc_10009AD1:				; CODE XREF: sasl_setpass+2EBj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10009AF1
		test	dl, dl
		jz	short loc_10009AED
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10009AF1
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10009AD1

loc_10009AED:				; CODE XREF: sasl_setpass+2D9j
		xor	eax, eax
		jmp	short loc_10009AF6
; ---------------------------------------------------------------------------

loc_10009AF1:				; CODE XREF: sasl_setpass+2D5j
					; sasl_setpass+2E1j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10009AF6:				; CODE XREF: sasl_setpass+2EFj
		test	eax, eax
		jnz	loc_10009BBF
		mov	eax, [esi+24h]

loc_10009B01:				; CODE XREF: sasl_setpass+2C9j
		mov	ecx, [esp+40h+arg_18]
		mov	edx, [esp+40h+arg_14]
		inc	[esp+40h+var_28]
		push	ecx
		mov	ecx, [esp+44h+arg_10]
		push	edx
		mov	edx, [esp+48h+arg_C]
		push	ecx
		mov	ecx, [esp+4Ch+arg_8]
		push	edx
		mov	edx, [edi+1134h]
		push	ecx
		mov	ecx, [esi+10h]
		push	ebp
		push	edx
		push	ecx
		call	eax
		mov	esi, eax
		add	esp, 20h
		test	esi, esi
		jnz	short loc_10009B51
		mov	edx, [ebx+0Ch]
		mov	eax, [edx]
		push	ebp
		push	eax
		push	offset aSSetSecretForS ; "%s: set secret for %s"
		push	4
		push	edi
		call	sub_10006F30
		add	esp, 14h
		mov	[ebx+4], esi
		jmp	short loc_10009BBF
; ---------------------------------------------------------------------------

loc_10009B51:				; CODE XREF: sasl_setpass+333j
		cmp	esi, 0FFFFFFEAh
		jnz	short loc_10009B6F
		mov	ecx, [ebx+0Ch]
		mov	edx, [ecx]
		push	ebp
		push	edx
		push	offset aSSecretNotChan ; "%s: secret not changed for %s"
		push	4
		push	edi
		call	sub_10006F30
		add	esp, 14h
		jmp	short loc_10009BBF
; ---------------------------------------------------------------------------

loc_10009B6F:				; CODE XREF: sasl_setpass+354j
		cmp	esi, 0FFFFFFE2h
		jnz	short loc_10009B98
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		push	ebp
		push	ecx
		push	offset aSFailedToSetSe ; "%s: failed to	set secret for %s: constr"...
		push	1
		push	edi
		call	sub_10006F30
		add	esp, 14h
		cmp	[esp+40h+var_30], 0
		jnz	short loc_10009BBB
		mov	[esp+40h+var_30], esi
		jmp	short loc_10009BBB
; ---------------------------------------------------------------------------

loc_10009B98:				; CODE XREF: sasl_setpass+372j
		mov	[esp+40h+var_30], esi
		call	ds:GetLastError
		mov	edx, [ebx+0Ch]
		push	eax
		mov	eax, [edx]
		push	esi
		push	ebp
		push	eax
		push	offset aSFailedToSet_0 ; "%s: failed to	set secret for %s: %z (%m"...
		push	1
		push	edi
		call	sub_10006F30
		add	esp, 1Ch

loc_10009BBB:				; CODE XREF: sasl_setpass+390j
					; sasl_setpass+396j
		inc	[esp+40h+var_2C]

loc_10009BBF:				; CODE XREF: sasl_setpass+2BEj
					; sasl_setpass+2F8j ...
		mov	ebx, [ebx+14h]
		test	ebx, ebx
		jnz	loc_10009AB6

loc_10009BCA:				; CODE XREF: sasl_setpass+2B0j
		mov	ecx, [esp+40h+var_28]
		test	ecx, ecx
		jnz	short loc_10009BF9
		push	ebp
		push	offset aSecretNotChang ; "secret not changed for %s: no	writable "...
		push	3
		push	edi
		call	sub_10006F30
		mov	eax, [esp+50h+var_30]
		add	esp, 10h

loc_10009BE7:				; CODE XREF: sasl_setpass+400j
		test	eax, eax
		jns	short loc_10009BF1

loc_10009BEB:				; CODE XREF: sasl_setpass+406j
		mov	[edi+8F0h], eax

loc_10009BF1:				; CODE XREF: sasl_setpass+3E9j
		pop	ebp
		pop	esi
		pop	edi
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_10009BF9:				; CODE XREF: sasl_setpass+3D0j
		mov	eax, [esp+40h+var_30]
		cmp	eax, 0FFFFFFE2h
		jnz	short loc_10009BE7
		cmp	[esp+40h+var_2C], ecx
		jge	short loc_10009BEB
		pop	ebp
		pop	esi
		mov	[esp+38h+var_30], 0
		mov	eax, [esp+38h+var_30]
		pop	edi
		pop	ebx
		add	esp, 30h
		retn
; ---------------------------------------------------------------------------

loc_10009C1C:				; CODE XREF: sasl_setpass+3Dj
					; sasl_setpass+49j
		mov	eax, 0FFFFFFF4h
		pop	ebx
		add	esp, 30h
		retn
sasl_setpass	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10009C30:				; DATA XREF: sasl_server_new+EBo
		cmp	dword_1002E5C8,	0
		push	esi
		push	edi
		mov	edi, [esp+0Ch]
		jz	short loc_10009CBD
		mov	eax, [edi+1130h]
		test	eax, eax
		jz	short loc_10009C69
		mov	eax, [eax+0Ch]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_10009C69
		mov	ecx, [edi+1134h]
		mov	edx, [ecx+34h]
		mov	ecx, [edi+85Ch]
		push	edx
		push	ecx
		call	eax
		add	esp, 8

loc_10009C69:				; CODE XREF: .text:10009C47j
					; .text:10009C51j
		mov	esi, [edi+1138h]
		mov	dword ptr [edi+85Ch], 0
		test	esi, esi
		jz	short loc_10009CB3
		push	ebx
		mov	edi, edi

loc_10009C80:				; CODE XREF: .text:10009CB0j
		mov	eax, [esi+4]
		mov	ebx, [esi+8]
		test	eax, eax
		jz	short loc_10009CA2
		mov	edx, [esi]
		mov	ecx, [edx+0Ch]
		mov	edx, [edi+1134h]
		mov	edx, [edx+34h]
		push	edx
		push	eax
		mov	eax, [ecx+1Ch]
		call	eax
		add	esp, 8

loc_10009CA2:				; CODE XREF: .text:10009C88j
		push	esi
		call	off_1002D050
		add	esp, 4
		mov	esi, ebx
		test	ebx, ebx
		jnz	short loc_10009C80
		pop	ebx

loc_10009CB3:				; CODE XREF: .text:10009C7Bj
		mov	dword ptr [edi+1138h], 0

loc_10009CBD:				; CODE XREF: .text:10009C3Dj
		mov	ecx, [edi+1134h]
		add	ecx, 34h
		push	ecx
		call	sub_100054F0
		mov	eax, [edi+1134h]
		add	eax, 60h
		add	esp, 4
		cmp	dword ptr [eax], 0
		jz	short loc_10009CE6
		push	eax
		call	prop_dispose
		add	esp, 4

loc_10009CE6:				; CODE XREF: .text:10009CDBj
		mov	eax, [edi+1120h]
		test	eax, eax
		jz	short loc_10009CFA
		push	eax
		call	off_1002D050
		add	esp, 4

loc_10009CFA:				; CODE XREF: .text:10009CEEj
		mov	eax, [edi+1124h]
		test	eax, eax
		jz	short loc_10009D0E
		push	eax
		call	off_1002D050
		add	esp, 4

loc_10009D0E:				; CODE XREF: .text:10009D02j
		mov	eax, [edi+1134h]
		test	eax, eax
		jz	short loc_10009D22
		push	eax
		call	off_1002D050
		add	esp, 4

loc_10009D22:				; CODE XREF: .text:10009D16j
		mov	esi, [edi+113Ch]
		mov	edx, dword_1002E5CC
		cmp	esi, [edx+8]
		jz	short loc_10009D51
		test	esi, esi
		jz	short loc_10009D51
		jmp	short loc_10009D40
; ---------------------------------------------------------------------------
		align 10h

loc_10009D40:				; CODE XREF: .text:10009D37j
					; .text:10009D4Fj
		push	esi
		mov	esi, [esi+14h]
		call	off_1002D050
		add	esp, 4
		test	esi, esi
		jnz	short loc_10009D40

loc_10009D51:				; CODE XREF: .text:10009D31j
					; .text:10009D35j
		push	edi
		call	sub_10004D80
		add	esp, 4
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009D60	proc near		; CODE XREF: sasl_server_add_plugin+109p
					; sasl_server_add_plugin+12Ap
		mov	edx, [edi+8]
		mov	ecx, [esi+8]
		mov	eax, edx
		xor	eax, ecx
		and	ecx, eax
		test	cl, 10h
		jz	short loc_10009D77

loc_10009D71:				; CODE XREF: sub_10009D60+2Aj
					; sub_10009D60+34j ...
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_10009D77:				; CODE XREF: sub_10009D60+Fj
		and	edx, eax
		test	dl, 10h
		jz	short loc_10009D82

loc_10009D7E:				; CODE XREF: sub_10009D60+2Fj
					; sub_10009D60+39j ...
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10009D82:				; CODE XREF: sub_10009D60+1Cj
		mov	ecx, [esi+8]
		and	ecx, eax
		test	cl, 1
		jnz	short loc_10009D71
		test	dl, 1
		jnz	short loc_10009D7E
		test	cl, 40h
		jnz	short loc_10009D71
		test	dl, 40h
		jnz	short loc_10009D7E
		test	cl, 2
		jnz	short loc_10009D71
		test	dl, 2
		jnz	short loc_10009D7E
		test	cl, 4
		jnz	short loc_10009D71
		test	dl, 4
		jnz	short loc_10009D7E
		test	cl, 8
		jnz	short loc_10009D71
		test	dl, 8
		jnz	short loc_10009D7E
		mov	edx, [edi+0Ch]
		mov	eax, [esi+0Ch]
		mov	ecx, edx
		xor	ecx, eax
		and	eax, ecx
		test	eax, 800h
		jnz	short loc_10009D71
		and	edx, ecx
		test	edx, 800h
		jnz	short loc_10009D7E
		mov	eax, [esi+4]
		mov	ecx, [edi+4]
		cmp	eax, ecx
		ja	short loc_10009D71
		sbb	eax, eax
		retn
sub_10009D60	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  55. sasl_server_add_plugin

; =============== S U B	R O U T	I N E =======================================


		public sasl_server_add_plugin
sasl_server_add_plugin proc near	; CODE XREF: sasl_server_init+16Ep
					; DATA XREF: sasl_server_init+26o ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 18h
		cmp	[esp+18h+arg_0], 0
		jz	loc_10009F8F
		mov	eax, [esp+18h+arg_4]
		test	eax, eax
		jz	loc_10009F8F
		push	esi
		lea	ecx, [esp+1Ch+var_8]
		push	ecx
		lea	edx, [esp+20h+var_18]
		push	edx
		mov	edx, dword_1002E5CC
		lea	ecx, [esp+24h+var_14]
		push	ecx
		mov	ecx, [edx]
		push	4
		push	ecx
		call	eax
		mov	esi, eax
		add	esp, 14h
		mov	[esp+1Ch+var_10], esi
		test	esi, esi
		jz	short loc_10009E57
		cmp	esi, 0FFFFFFECh
		jz	short loc_10009E57
		cmp	esi, 1
		jz	short loc_10009E57
		push	esi
		push	offset aServerAdd_plug ; "server add_plugin entry_point	error %z\"...
		push	5
		push	0
		call	sub_10006F30
		add	esp, 10h
		mov	eax, esi
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10009E57:				; CODE XREF: sasl_server_add_plugin+42j
					; sasl_server_add_plugin+47j ...
		mov	eax, [esp+1Ch+var_14]
		cmp	eax, 4
		jz	short loc_10009E7E
		push	eax
		push	4
		push	offset aVersionMisma_0 ; "version mismatch on plugin: %d expected"...
		push	1
		push	0
		call	sub_10006F30
		add	esp, 14h
		mov	eax, 0FFFFFFE9h
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10009E7E:				; CODE XREF: sasl_server_add_plugin+6Ej
		cmp	[esp+1Ch+var_8], 0
		push	ebx
		push	ebp
		push	edi
		mov	[esp+28h+var_C], 0
		jle	loc_10009F6E

loc_10009E94:				; CODE XREF: sasl_server_add_plugin+178j
		push	18h
		call	off_1002D044
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jz	loc_10009F82
		mov	ecx, [esp+28h+arg_0]
		xor	eax, eax
		mov	[ebx], eax
		mov	[ebx+4], eax
		mov	[ebx+8], eax
		mov	[ebx+0Ch], eax
		mov	[ebx+10h], eax
		mov	[ebx+14h], eax
		mov	edx, [esp+28h+var_18]
		push	eax
		lea	eax, [ebx+8]
		push	eax
		push	ecx
		mov	[ebx+0Ch], edx
		call	sub_10004910
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10009F78
		mov	edx, [esp+28h+var_14]
		mov	eax, dword_1002E5CC
		mov	[ebx], edx
		mov	[ebx+4], esi
		mov	ebp, [eax+8]
		test	ebp, ebp
		jz	short loc_10009F4A
		mov	edi, [ebp+0Ch]
		mov	esi, [esp+28h+var_18]
		call	sub_10009D60
		test	eax, eax
		jns	short loc_10009F41
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_10009F2D
		jmp	short loc_10009F10
; ---------------------------------------------------------------------------
		align 10h

loc_10009F10:				; CODE XREF: sasl_server_add_plugin+118j
					; sasl_server_add_plugin+13Bj
		mov	eax, [ebp+14h]
		mov	edi, [eax+0Ch]
		mov	[esp+28h+var_4], eax
		call	sub_10009D60
		test	eax, eax
		jg	short loc_10009F2D
		mov	ebp, [esp+28h+var_4]
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_10009F10

loc_10009F2D:				; CODE XREF: sasl_server_add_plugin+116j
					; sasl_server_add_plugin+131j
		mov	eax, [ebp+14h]
		mov	esi, [esp+28h+var_10]
		mov	[ebx+14h], eax
		mov	eax, dword_1002E5CC
		mov	[ebp+14h], ebx
		jmp	short loc_10009F53
; ---------------------------------------------------------------------------

loc_10009F41:				; CODE XREF: sasl_server_add_plugin+110j
		mov	esi, [esp+28h+var_10]
		mov	eax, dword_1002E5CC

loc_10009F4A:				; CODE XREF: sasl_server_add_plugin+100j
		mov	ecx, [eax+8]
		mov	[ebx+14h], ecx
		mov	[eax+8], ebx

loc_10009F53:				; CODE XREF: sasl_server_add_plugin+14Fj
		inc	dword ptr [eax+0Ch]
		mov	eax, [esp+28h+var_C]
		add	[esp+28h+var_18], 38h
		inc	eax
		mov	[esp+28h+var_C], eax
		cmp	eax, [esp+28h+var_8]
		jl	loc_10009E94

loc_10009F6E:				; CODE XREF: sasl_server_add_plugin+9Ej
		pop	edi
		pop	ebp
		pop	ebx
		xor	eax, eax
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10009F78:				; CODE XREF: sasl_server_add_plugin+E7j
		push	ebx		; lpMem
		call	off_1002D050
		add	esp, 4

loc_10009F82:				; CODE XREF: sasl_server_add_plugin+B3j
		pop	edi
		pop	ebp
		pop	ebx
		mov	eax, 0FFFFFFFEh
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10009F8F:				; CODE XREF: sasl_server_add_plugin+8j
					; sasl_server_add_plugin+14j
		mov	eax, 0FFFFFFF9h
		add	esp, 18h
		retn
sasl_server_add_plugin endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  56. sasl_server_done

; =============== S U B	R O U T	I N E =======================================


		public sasl_server_done
sasl_server_done proc near		; DATA XREF: .rdata:off_1002C568o
		mov	ecx, dword_1002E4A0
		mov	eax, 1
		test	ecx, ecx
		jnz	short loc_10009FBB
		cmp	dword_1002E49C,	ecx
		jnz	short locret_10009FDA
		lea	eax, [ecx-0Ch]
		retn
; ---------------------------------------------------------------------------

loc_10009FBB:				; CODE XREF: sasl_server_done+Dj
		call	ecx ; dword_1002E4A0
		test	eax, eax
		jnz	short locret_10009FDA
		mov	dword_1002E4A8,	eax
		mov	dword_1002E4A0,	eax
		cmp	dword_1002E49C,	eax
		jnz	short locret_10009FDA
		call	sub_10006260
		xor	eax, eax

locret_10009FDA:			; CODE XREF: sasl_server_done+15j
					; sasl_server_done+1Fj	...
		retn
sasl_server_done endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009FE0	proc near		; CODE XREF: sasl_server_init+10Cp
					; sasl_server_init:loc_1000BB96p
					; DATA XREF: ...
		cmp	dword_1002E5C8,	0
		jnz	short loc_10009FEF
		mov	eax, 0FFFFFFF4h
		retn
; ---------------------------------------------------------------------------

loc_10009FEF:				; CODE XREF: sub_10009FE0+7j
		mov	eax, 1
		sub	dword_1002E5C8,	eax
		jnz	locret_1000A08B
		mov	ecx, dword_1002E5CC
		test	ecx, ecx
		jz	short loc_1000A070
		push	edi
		mov	edi, [ecx+8]
		test	edi, edi
		jz	short loc_1000A04F
		push	esi

loc_1000A013:				; CODE XREF: sub_10009FE0+6Cj
		mov	esi, edi
		mov	eax, [esi+0Ch]
		cmp	dword ptr [eax+20h], 0
		mov	edi, [edi+14h]
		jz	short loc_1000A030
		mov	ecx, [ecx]
		mov	edx, [eax+10h]
		mov	eax, [eax+20h]
		push	ecx
		push	edx
		call	eax
		add	esp, 8

loc_1000A030:				; CODE XREF: sub_10009FE0+3Fj
		mov	ecx, [esi+8]
		push	ecx		; lpMem
		call	off_1002D050
		push	esi		; lpMem
		call	off_1002D050
		mov	ecx, dword_1002E5CC
		add	esp, 8
		test	edi, edi
		jnz	short loc_1000A013
		pop	esi

loc_1000A04F:				; CODE XREF: sub_10009FE0+30j
		push	ecx
		call	sub_100054F0
		mov	edx, dword_1002E5CC
		push	edx		; lpMem
		call	off_1002D050
		add	esp, 8
		mov	dword_1002E5CC,	0
		pop	edi

loc_1000A070:				; CODE XREF: sub_10009FE0+28j
		call	sub_10001930
		mov	dword_1002F060,	0
		mov	dword_1002F064,	0
		xor	eax, eax

locret_1000A08B:			; CODE XREF: sub_10009FE0+1Aj
		retn
sub_10009FE0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1000A090:				; DATA XREF: sasl_server_init+1A4o
					; sasl_server_new+FBo
		cmp	dword_1002E5CC,	0
		jnz	short loc_1000A09C
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1000A09C:				; CODE XREF: .text:1000A097j
		push	esi
		push	edi
		mov	edi, [esp+0Ch]
		mov	esi, [edi+113Ch]
		test	esi, esi
		jz	short loc_1000A0D8
		lea	esp, [esp+0]

loc_1000A0B0:				; CODE XREF: .text:1000A0D6j
		mov	eax, [esi+0Ch]
		cmp	dword ptr [eax+2Ch], 0
		jz	short loc_1000A0D1
		mov	ecx, [edi+1134h]
		mov	edx, [eax+10h]
		mov	eax, [eax+2Ch]
		push	ecx
		push	edi
		push	edx
		call	eax
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000A0DD

loc_1000A0D1:				; CODE XREF: .text:1000A0B7j
		mov	esi, [esi+14h]
		test	esi, esi
		jnz	short loc_1000A0B0

loc_1000A0D8:				; CODE XREF: .text:1000A0AAj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000A0DD:				; CODE XREF: .text:1000A0CFj
		pop	edi
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A0F0	proc near		; CODE XREF: sasl_server_init+151p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		cmp	dword_1002F064,	0
		mov	[esp+4+var_4], 0
		jnz	short loc_1000A108
		mov	eax, 1
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A108:				; CODE XREF: sub_1000A0F0+Fj
		mov	eax, dword_1002F060
		push	eax
		call	sub_100055E0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000A121
		mov	eax, 0FFFFFFF9h
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A121:				; CODE XREF: sub_1000A0F0+28j
		mov	edx, [eax+8]
		mov	eax, [eax+4]
		push	edi
		lea	ecx, [esp+8+var_4]
		push	ecx
		push	edx
		call	eax
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	loc_1000A237
		mov	eax, [esp+8+var_4]
		test	eax, eax
		jnz	short loc_1000A14E
		mov	eax, offset byte_1002762D
		mov	[esp+8+var_4], eax

loc_1000A14E:				; CODE XREF: sub_1000A0F0+53j
		push	ebx
		push	ebp
		push	esi

loc_1000A151:				; CODE XREF: sub_1000A0F0+110j
		push	3Bh
		push	eax
		call	sub_1000EF20
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	short loc_1000A16B
		mov	ebx, ebp
		sub	ebx, [esp+14h+var_4]
		inc	ebp
		jmp	short loc_1000A17D
; ---------------------------------------------------------------------------

loc_1000A16B:				; CODE XREF: sub_1000A0F0+70j
		mov	eax, [esp+14h+var_4]
		lea	edx, [eax+1]

loc_1000A172:				; CODE XREF: sub_1000A0F0+87j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000A172
		sub	eax, edx
		mov	ebx, eax

loc_1000A17D:				; CODE XREF: sub_1000A0F0+79j
		mov	eax, dword_1002F064
		lea	edx, [eax+1]

loc_1000A185:				; CODE XREF: sub_1000A0F0+9Aj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000A185
		sub	eax, edx
		lea	edi, [eax+ebx+8]
		cmp	edi, 104h
		ja	short loc_1000A20E
		push	edi
		call	off_1002D044
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_1000A219
		mov	ecx, dword_1002F064
		mov	edx, [esp+14h+var_4]
		push	ecx
		push	5Ch
		push	edx
		push	ebx
		push	offset a_SCS_conf ; "%.*s%c%s.conf"
		push	edi
		push	esi
		call	sub_1000FA78
		mov	eax, [esp+30h+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		push	1
		push	esi
		push	ecx
		call	edx
		mov	edi, eax
		add	esp, 28h
		test	edi, edi
		jnz	short loc_1000A1EE
		push	esi
		call	sasl_config_init
		mov	edi, eax
		add	esp, 4
		cmp	edi, 1
		jnz	short loc_1000A226

loc_1000A1EE:				; CODE XREF: sub_1000A0F0+ECj
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	eax, ebp
		mov	[esp+14h+var_4], eax
		test	ebp, ebp
		jnz	loc_1000A151
		pop	esi
		pop	ebp
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A20E:				; CODE XREF: sub_1000A0F0+A8j
		pop	esi
		pop	ebp
		or	edi, 0FFFFFFFFh
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A219:				; CODE XREF: sub_1000A0F0+B8j
		pop	esi
		pop	ebp
		mov	edi, 0FFFFFFFEh
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A226:				; CODE XREF: sub_1000A0F0+FCj
		test	esi, esi
		jz	short loc_1000A234
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 4

loc_1000A234:				; CODE XREF: sub_1000A0F0+138j
		pop	esi
		pop	ebp
		pop	ebx

loc_1000A237:				; CODE XREF: sub_1000A0F0+47j
		mov	eax, edi
		pop	edi
		pop	ecx
		retn
sub_1000A0F0	endp

; ---------------------------------------------------------------------------
		align 10h
		test	eax, eax
		jz	short loc_1000A25E
		cmp	dword ptr [eax], 0
		jz	short loc_1000A25E
		lea	esp, [esp+0]

loc_1000A250:				; CODE XREF: .text:1000A25Cj
		cmp	dword ptr [eax+4], 0
		jz	short loc_1000A261
		add	eax, 0Ch
		cmp	dword ptr [eax], 0
		jnz	short loc_1000A250

loc_1000A25E:				; CODE XREF: .text:1000A242j
					; .text:1000A247j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1000A261:				; CODE XREF: .text:1000A254j
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A270	proc near		; CODE XREF: .text:1000A3AEp
					; .text:1000A3BFp ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, eax
		movsx	eax, byte ptr [edi]
		push	eax
		xor	esi, esi
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jz	short loc_1000A299

loc_1000A287:				; CODE XREF: sub_1000A270+27j
		movsx	ecx, byte ptr [edi+1]
		inc	edi
		push	ecx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000A287

loc_1000A299:				; CODE XREF: sub_1000A270+15j
		cmp	byte ptr [edi],	0
		jz	short loc_1000A2B7
		mov	edi, edi

loc_1000A2A0:				; CODE XREF: sub_1000A270+45j
		movsx	edx, byte ptr [esi+edi]
		push	edx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000A2B7
		inc	esi
		cmp	[esi+edi], al
		jnz	short loc_1000A2A0

loc_1000A2B7:				; CODE XREF: sub_1000A270+2Cj
					; sub_1000A270+3Fj
		lea	eax, [esi+1]
		push	eax
		call	off_1002D044
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000A2CE
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000A2CE:				; CODE XREF: sub_1000A270+58j
		push	esi
		push	edi
		push	ebx
		call	sub_1000E2B0
		mov	ecx, [esp+18h+arg_0]
		mov	byte ptr [ebx+esi], 0
		add	esp, 0Ch
		add	esi, edi
		pop	edi
		mov	[ecx], esi
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
sub_1000A270	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 410h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+40Ch], eax
		mov	eax, [esp+414h]
		push	esi
		push	offset aR	; "r"
		push	eax
		call	sub_100100D1
		mov	esi, eax
		add	esp, 8
		mov	[esp+0Ch], esi
		test	esi, esi
		jnz	short loc_1000A33D
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+40Ch]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 410h
		retn
; ---------------------------------------------------------------------------

loc_1000A33D:				; CODE XREF: .text:1000A322j
		push	esi
		lea	eax, [esp+14h]
		push	400h
		push	eax
		mov	dword ptr [esp+14h], 0
		call	sub_1000FE75
		add	esp, 0Ch
		test	eax, eax
		jz	loc_1000A48F
		push	ebx
		push	ebp
		push	edi

loc_1000A363:				; CODE XREF: .text:1000A47Cj
		push	18h
		call	off_1002D044
		mov	ebp, eax
		add	esp, 4
		test	ebp, ebp
		jz	loc_1000A484
		push	38h
		mov	dword ptr [ebp+0], 4
		mov	dword ptr [ebp+4], 1
		call	off_1002D044
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	loc_1000A484
		push	38h
		push	0
		push	edi
		call	sub_1000E0F0
		lea	ecx, [esp+1Ch]
		push	ecx
		lea	eax, [esp+2Ch]
		call	sub_1000A270
		lea	edx, [esp+20h]
		mov	[ebp+10h], eax
		mov	eax, [esp+20h]
		push	edx
		call	sub_1000A270
		mov	[edi], eax
		mov	ecx, [esp+24h]
		push	0Ah
		lea	eax, [esp+28h]
		push	eax
		push	ecx
		call	sub_10010F93
		mov	[edi+4], eax
		mov	eax, [esp+30h]
		add	esp, 20h
		cmp	byte ptr [eax],	0Ah
		jz	short loc_1000A453

loc_1000A3E6:				; CODE XREF: .text:1000A44Dj
		lea	edx, [esp+10h]
		push	edx
		call	sub_1000A270
		add	esp, 4
		cmp	off_1002D280, 0
		mov	ebx, eax
		mov	esi, offset off_1002D280
		jz	short loc_1000A428

loc_1000A403:				; CODE XREF: .text:1000A419j
		mov	eax, [esi]
		push	eax
		push	ebx
		call	sub_10023E83
		add	esp, 8
		test	eax, eax
		jz	short loc_1000A41D
		add	esi, 8
		cmp	dword ptr [esi], 0
		jnz	short loc_1000A403
		jmp	short loc_1000A428
; ---------------------------------------------------------------------------

loc_1000A41D:				; CODE XREF: .text:1000A411j
		mov	ecx, [esi+4]
		or	[edi+8], ecx
		cmp	dword ptr [esi], 0
		jnz	short loc_1000A43D

loc_1000A428:				; CODE XREF: .text:1000A401j
					; .text:1000A41Bj
		mov	edx, [edi]
		push	ebx
		push	edx
		push	offset aSCouldnTIdenti ; "%s: couldn't identify flag '%s'"
		push	1
		push	0
		call	sub_10006F30
		add	esp, 14h

loc_1000A43D:				; CODE XREF: .text:1000A426j
		push	ebx
		call	sub_1000EE73
		mov	eax, [esp+14h]
		add	esp, 4
		cmp	byte ptr [eax],	0Ah
		jnz	short loc_1000A3E6
		mov	esi, [esp+18h]

loc_1000A453:				; CODE XREF: .text:1000A3E4j
		mov	eax, dword_1002E5CC
		mov	[ebp+0Ch], edi
		mov	ecx, [eax+8]
		push	esi
		lea	edx, [esp+20h]
		mov	[ebp+14h], ecx
		inc	dword ptr [eax+0Ch]
		push	400h
		push	edx
		mov	[eax+8], ebp
		call	sub_1000FE75
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000A363
		jmp	short loc_1000A48C
; ---------------------------------------------------------------------------

loc_1000A484:				; CODE XREF: .text:1000A372j
					; .text:1000A395j
		mov	dword ptr [esp+14h], 0FFFFFFFEh

loc_1000A48C:				; CODE XREF: .text:1000A482j
		pop	edi
		pop	ebp
		pop	ebx

loc_1000A48F:				; CODE XREF: .text:1000A35Aj
		push	esi
		call	sub_1000FCAB
		mov	ecx, [esp+414h]
		mov	eax, [esp+0Ch]
		add	esp, 4
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 410h
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A4C0	proc near		; DATA XREF: sasl_server_new+3A7o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	edi
		xor	ebx, ebx
		xor	edi, edi
		mov	[esp+14h+var_8], offset	aN ; "n"
		test	esi, esi
		jnz	short loc_1000A4E4
		pop	edi
		pop	esi
		lea	eax, [ebx-7]
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000A4E4:				; CODE XREF: sub_1000A4C0+18j
		cmp	[esi+868h], ebx
		jnz	short loc_1000A513
		push	3BEh
		push	offset aParameterErr_2 ; "Parameter error in server.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000A513:				; CODE XREF: sub_1000A4C0+2Aj
		push	ebp
		lea	eax, [esp+18h+arg_0]
		push	eax
		lea	ecx, [esp+1Ch+var_4]
		push	ecx
		push	1
		push	esi
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000A558
		push	eax
		lea	edx, [esp+1Ch+var_8]
		push	edx
		push	offset aAuto_transitio ; "auto_transition"
		push	eax
		mov	eax, [esp+28h+arg_0]
		push	eax
		call	[esp+2Ch+var_4]
		mov	ebp, [esp+2Ch+var_8]
		add	esp, 14h
		test	ebp, ebp
		jnz	short loc_1000A55C
		mov	ebp, offset aN	; "n"
		mov	[esp+18h+var_8], ebp
		jmp	short loc_1000A55C
; ---------------------------------------------------------------------------

loc_1000A558:				; CODE XREF: sub_1000A4C0+6Bj
		mov	ebp, [esp+18h+var_8]

loc_1000A55C:				; CODE XREF: sub_1000A4C0+8Bj
					; sub_1000A4C0+96j
		mov	ecx, offset aNoplain ; "noplain"
		mov	eax, ebp

loc_1000A563:				; CODE XREF: sub_1000A4C0+BDj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_1000A583
		test	dl, dl
		jz	short loc_1000A57F
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1000A583
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_1000A563

loc_1000A57F:				; CODE XREF: sub_1000A4C0+ABj
		xor	eax, eax
		jmp	short loc_1000A588
; ---------------------------------------------------------------------------

loc_1000A583:				; CODE XREF: sub_1000A4C0+A7j
					; sub_1000A4C0+B3j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_1000A588:				; CODE XREF: sub_1000A4C0+C1j
		test	eax, eax
		jnz	short loc_1000A591
		lea	edi, [eax+4]
		jmp	short loc_1000A5AA
; ---------------------------------------------------------------------------

loc_1000A591:				; CODE XREF: sub_1000A4C0+CAj
		mov	al, [ebp+0]
		cmp	al, 31h
		jz	short loc_1000A5AA
		cmp	al, 79h
		jz	short loc_1000A5AA
		cmp	al, 6Fh
		jnz	short loc_1000A5A6
		cmp	byte ptr [ebp+1], 6Eh
		jz	short loc_1000A5AA

loc_1000A5A6:				; CODE XREF: sub_1000A4C0+DEj
		cmp	al, 74h
		jnz	short loc_1000A5EC

loc_1000A5AA:				; CODE XREF: sub_1000A4C0+CFj
					; sub_1000A4C0+D6j ...
		mov	ecx, [esi+868h]
		push	ecx
		push	offset aTransitioningU ; "transitioning	user %s	to auxprop databa"...
		push	4
		push	esi
		call	sub_10006F30
		mov	edx, [esp+28h+arg_8]
		mov	eax, [esp+28h+arg_4]
		mov	ecx, [esi+868h]
		or	edi, 1
		push	edi
		push	0
		push	0
		push	edx
		push	eax
		push	ecx
		push	esi
		call	sasl_setpass
		mov	ebx, eax
		add	esp, 2Ch
		test	ebx, ebx
		jns	short loc_1000A5EC
		mov	[esi+8F0h], ebx

loc_1000A5EC:				; CODE XREF: sub_1000A4C0+E8j
					; sub_1000A4C0+124j
		pop	ebp
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		add	esp, 8
		retn
sub_1000A4C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A600	proc near		; CODE XREF: sub_1000AC20+1B1p
					; sasl_server_start+C1p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebp
		push	edi
		xor	edi, edi
		xor	ebp, ebp
		mov	[esp+0Ch+var_4], edi
		cmp	esi, edi
		jnz	short loc_1000A616
		lea	eax, [edi-4]
		pop	edi
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A616:				; CODE XREF: sub_1000A600+Dj
		mov	edx, [esp+0Ch+arg_0]
		push	ebx
		cmp	edx, edi
		jz	loc_1000A89E
		mov	ebx, [edx+0Ch]
		cmp	ebx, edi
		jz	loc_1000A89E
		mov	eax, [esi+1134h]
		mov	ecx, [esi+8E8h]
		mov	[eax+8], ecx
		mov	eax, [esi+1134h]
		mov	ecx, [esi+8]
		mov	[eax], ecx
		mov	eax, [esi+1134h]
		mov	ecx, [esi+1124h]
		mov	[eax+0Ch], ecx
		mov	eax, [esi+1134h]
		mov	ecx, [esi+8B8h]
		mov	[eax+3Ch], ecx
		mov	ecx, [esi+8BCh]
		mov	[eax+40h], ecx
		mov	ecx, [esi+8C0h]
		mov	[eax+44h], ecx
		mov	ecx, [esi+8C4h]
		mov	[eax+48h], ecx
		mov	ecx, [esi+8C8h]
		mov	[eax+4Ch], ecx
		mov	ecx, [esi+8CCh]
		mov	[eax+50h], ecx
		mov	eax, [esi+1134h]
		mov	ecx, [esi+8D0h]
		mov	[eax+54h], ecx
		mov	eax, [esi+1138h]
		cmp	eax, edi
		jz	short loc_1000A6CE
		lea	esp, [esp+0]

loc_1000A6B0:				; CODE XREF: sub_1000A600+B9j
		cmp	[eax], edx
		jz	short loc_1000A6BD
		mov	eax, [eax+8]
		cmp	eax, edi
		jnz	short loc_1000A6B0
		jmp	short loc_1000A6CE
; ---------------------------------------------------------------------------

loc_1000A6BD:				; CODE XREF: sub_1000A600+B2j
		mov	ecx, [eax+4]
		cmp	ecx, edi
		jz	loc_1000A801
		mov	[esp+10h+var_4], ecx
		mov	ebp, eax

loc_1000A6CE:				; CODE XREF: sub_1000A600+AAj
					; sub_1000A600+BBj
		mov	eax, [esi+8B8h]
		mov	ecx, [esi+8D0h]
		cmp	eax, ecx
		jb	short loc_1000A6E2
		sub	eax, ecx
		mov	edi, eax

loc_1000A6E2:				; CODE XREF: sub_1000A600+DCj
		cmp	[ebx+4], edi
		jnb	short loc_1000A704
		mov	edx, [ebx]
		push	edx
		push	offset aMechSIsTooWeak ; "mech %s is too weak"
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFF1h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A704:				; CODE XREF: sub_1000A600+E5j
		mov	eax, [ebx+30h]
		test	eax, eax
		jz	short loc_1000A787
		mov	edx, [esi+1134h]
		lea	ecx, [esp+10h+var_4]
		push	ecx
		mov	ecx, [ebx+10h]
		push	edx
		push	ecx
		call	eax
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000A783
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_1000A779
		push	0Ch
		call	off_1002D044
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000A75D
		push	4DFh

loc_1000A73D:				; CODE XREF: sub_1000A600+1ACj
		push	offset aOutOfMemoryI_1 ; "Out of Memory	in server.c near line %d"
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 10h
		pop	ebx
		mov	eax, 0FFFFFFFEh
		pop	edi
		mov	[esi+8F0h], eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A75D:				; CODE XREF: sub_1000A600+136j
		mov	edx, [esp+10h+arg_0]
		mov	dword ptr [eax+4], 0
		mov	[eax], edx
		mov	ecx, [esi+1138h]
		mov	[eax+8], ecx
		mov	[esi+1138h], eax

loc_1000A779:				; CODE XREF: sub_1000A600+127j
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFFCh
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A783:				; CODE XREF: sub_1000A600+122j
		mov	edx, [esp+10h+arg_0]

loc_1000A787:				; CODE XREF: sub_1000A600+109j
		mov	eax, [esp+10h+var_4]
		test	eax, eax
		jz	short loc_1000A7CC
		test	ebp, ebp
		jz	short loc_1000A798
		mov	[ebp+4], eax
		jmp	short loc_1000A7CC
; ---------------------------------------------------------------------------

loc_1000A798:				; CODE XREF: sub_1000A600+191j
		push	0Ch
		call	off_1002D044
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000A7AE
		push	4F4h
		jmp	short loc_1000A73D
; ---------------------------------------------------------------------------

loc_1000A7AE:				; CODE XREF: sub_1000A600+1A5j
		mov	edx, [esp+10h+var_4]
		mov	ecx, [esp+10h+arg_0]
		mov	[eax+4], edx
		mov	[eax], ecx
		mov	edx, [esi+1138h]
		mov	[eax+8], edx
		mov	[esi+1138h], eax
		mov	edx, ecx

loc_1000A7CC:				; CODE XREF: sub_1000A600+18Dj
					; sub_1000A600+196j
		cmp	[ebx+4], edi
		jnb	short loc_1000A7EB
		push	offset aTooWeak	; "too weak"
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFF1h
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A7EB:				; CODE XREF: sub_1000A600+1CFj
		cmp	dword ptr [edx+4], 0FFFFFFECh
		jnz	short loc_1000A80B
		push	offset aNoUsersInSecre ; "no users in secrets db"
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 0Ch

loc_1000A801:				; CODE XREF: sub_1000A600+C2j
					; sub_1000A600+216j ...
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFFCh
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A80B:				; CODE XREF: sub_1000A600+1EFj
		mov	eax, [esi+0Ch]
		test	al, 8
		jz	short loc_1000A818
		test	byte ptr [ebx+0Ch], 20h
		jz	short loc_1000A801

loc_1000A818:				; CODE XREF: sub_1000A600+210j
		test	al, 10h
		jz	short loc_1000A825
		test	dword ptr [ebx+0Ch], 1000h
		jz	short loc_1000A801

loc_1000A825:				; CODE XREF: sub_1000A600+21Aj
		mov	eax, [esi+8D0h]
		mov	edi, [esi+8C4h]
		cmp	[esi+8B8h], eax
		ja	short loc_1000A841
		cmp	eax, 1
		jbe	short loc_1000A841
		and	edi, 0FFFFFFFEh

loc_1000A841:				; CODE XREF: sub_1000A600+237j
					; sub_1000A600+23Cj
		mov	eax, [ebx+8]
		xor	eax, edi
		and	edi, eax
		jz	short loc_1000A871
		push	offset aSecurityFlagsD ; "security flags do not	match required"
		push	1
		push	esi
		call	sasl_seterror
		mov	ecx, edi
		and	cl, 1
		add	esp, 0Ch
		movsx	eax, cl
		neg	eax
		sbb	eax, eax
		pop	ebx
		and	eax, 0FFFFFFF4h
		pop	edi
		add	eax, 0FFFFFFFCh
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A871:				; CODE XREF: sub_1000A600+248j
		test	dword ptr [ebx+0Ch], 400h
		jz	short loc_1000A897
		mov	edx, [ebx]
		push	edx
		push	offset aMechSRequiresU ; "mech %s requires unprovided secret faci"...
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 10h
		pop	ebx
		pop	edi
		mov	eax, 0FFFFFFFCh
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A897:				; CODE XREF: sub_1000A600+278j
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A89E:				; CODE XREF: sub_1000A600+1Dj
					; sub_1000A600+28j
		push	4AFh
		push	offset aParameterErr_2 ; "Parameter error in server.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		pop	ebx
		mov	eax, 0FFFFFFF9h
		pop	edi
		mov	[esi+8F0h], eax
		pop	ebp
		pop	ecx
		retn
sub_1000A600	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A8D0	proc near		; CODE XREF: sasl_server_step+CEp
					; sasl_checkpass+8Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 8
		lea	eax, [esp+8+var_8]
		push	eax
		lea	ecx, [esp+0Ch+var_4]
		push	ecx
		push	8001h
		push	esi
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jz	short loc_1000A91C
		test	esi, esi
		jz	short loc_1000A913
		push	544h
		push	0FFFFFFF2h
		push	offset aInternalErro_1 ; "Internal Error %d in server.c	near line"...
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 14h
		mov	dword ptr [esi+8F0h], 0FFFFFFF2h

loc_1000A913:				; CODE XREF: sub_1000A8D0+20j
		mov	eax, 0FFFFFFF2h
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000A91C:				; CODE XREF: sub_1000A8D0+1Cj
		mov	edx, [esi+1124h]
		test	edx, edx
		jz	short loc_1000A93C
		mov	eax, edx
		push	edi
		lea	edi, [eax+1]
		lea	esp, [esp+0]

loc_1000A930:				; CODE XREF: sub_1000A8D0+65j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000A930
		sub	eax, edi
		pop	edi
		jmp	short loc_1000A93E
; ---------------------------------------------------------------------------

loc_1000A93C:				; CODE XREF: sub_1000A8D0+54j
		xor	eax, eax

loc_1000A93E:				; CODE XREF: sub_1000A8D0+6Aj
		mov	ecx, [esi+1134h]
		mov	ecx, [ecx+60h]
		push	ecx
		mov	ecx, [esi+86Ch]
		push	eax
		mov	eax, [esi+868h]
		push	edx
		mov	edx, [esi+870h]
		push	edx
		mov	edx, [esi+864h]
		push	eax
		mov	eax, [esp+1Ch+var_8]
		push	ecx
		push	edx
		push	eax
		push	esi
		call	[esp+2Ch+var_4]
		add	esp, 24h
		test	eax, eax
		jns	short loc_1000A97D
		mov	[esi+8F0h], eax

loc_1000A97D:				; CODE XREF: sub_1000A8D0+A5j
		add	esp, 8
		retn
sub_1000A8D0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  61. sasl_server_step

; =============== S U B	R O U T	I N E =======================================


		public sasl_server_step
sasl_server_step proc near		; CODE XREF: sasl_server_start+334p
					; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		cmp	dword_1002E5C8,	0
		jnz	short loc_1000A99F
		mov	eax, 0FFFFFFF4h
		retn
; ---------------------------------------------------------------------------

loc_1000A99F:				; CODE XREF: sasl_server_step+7j
		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_1000A9AD
		lea	eax, [esi-7]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000A9AD:				; CODE XREF: sasl_server_step+16j
		mov	ecx, [esp+4+arg_4]
		mov	edx, [esp+4+arg_8]
		test	ecx, ecx
		jnz	short loc_1000A9DF
		test	edx, edx
		jz	short loc_1000A9DF
		push	63Eh
		push	offset aParameterErr_2 ; "Parameter error in server.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		mov	eax, 0FFFFFFF9h
		add	esp, 10h
		mov	[esi+8F0h], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000A9DF:				; CODE XREF: sasl_server_step+27j
					; sasl_server_step+2Bj
		cmp	dword ptr [esi+1128h], 1
		jnz	short loc_1000A9EC
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000A9EC:				; CODE XREF: sasl_server_step+56j
		cmp	dword ptr [esi+860h], 0
		push	edi
		lea	edi, [esi+860h]
		jz	short loc_1000AA12
		push	offset aAttemptingServ ; "attempting server step after doneflag"
		push	1
		push	esi
		call	sub_10006F30
		add	esp, 0Ch
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000AA12:				; CODE XREF: sasl_server_step+6Aj
		push	ebx
		mov	ebx, [esp+0Ch+arg_C]
		push	ebp
		test	ebx, ebx
		jz	short loc_1000AA22
		mov	dword ptr [ebx], 0

loc_1000AA22:				; CODE XREF: sasl_server_step+8Aj
		mov	eax, [esp+10h+arg_10]
		test	eax, eax
		jz	short loc_1000AA30
		mov	dword ptr [eax], 0

loc_1000AA30:				; CODE XREF: sasl_server_step+98j
		mov	ebp, [esi+1130h]
		mov	ebp, [ebp+0Ch]
		push	edi
		push	eax
		mov	eax, [esi+1134h]
		push	ebx
		push	edx
		mov	edx, [ebp+18h]
		push	ecx
		mov	ecx, [esi+85Ch]
		push	eax
		push	ecx
		call	edx
		mov	edi, eax
		add	esp, 1Ch
		test	edi, edi
		jnz	loc_1000AB90
		call	sub_1000A8D0
		mov	edi, eax
		test	edi, edi
		jnz	loc_1000AB90
		cmp	[ebx], eax
		jz	short loc_1000AA82
		test	byte ptr [esi+0Ch], 4
		jnz	short loc_1000AA82
		mov	edi, 1
		mov	[esi+1128h], edi

loc_1000AA82:				; CODE XREF: sasl_server_step+DFj
					; sasl_server_step+E5j
		cmp	dword ptr [esi+874h], 0
		jnz	short loc_1000AA97
		mov	eax, [esi+8C0h]
		mov	[esi+874h], eax

loc_1000AA97:				; CODE XREF: sasl_server_step+F9j
		mov	eax, [esi+8A4h]
		sub	eax, 0
		jz	loc_1000AB48
		dec	eax
		jz	short loc_1000AB25
		dec	eax
		jnz	loc_1000AB65
		mov	ecx, [esi+1134h]
		mov	eax, [ecx+68h]
		test	eax, eax
		jnz	short loc_1000AAD7
		push	offset aClientProvided ; "client provided channel binding but ser"...

loc_1000AAC2:				; CODE XREF: sasl_server_step+1D0j
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	edi, 0FFFFFFE0h
		jmp	loc_1000AB9A
; ---------------------------------------------------------------------------

loc_1000AAD7:				; CODE XREF: sasl_server_step+12Bj
		mov	ebx, [eax]
		mov	ebp, [esi+898h]
		mov	ecx, ebx
		mov	eax, ebp

loc_1000AAE3:				; CODE XREF: sasl_server_step+16Dj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_1000AB03
		test	dl, dl
		jz	short loc_1000AAFF
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1000AB03
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_1000AAE3

loc_1000AAFF:				; CODE XREF: sasl_server_step+15Bj
		xor	eax, eax
		jmp	short loc_1000AB08
; ---------------------------------------------------------------------------

loc_1000AB03:				; CODE XREF: sasl_server_step+157j
					; sasl_server_step+163j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_1000AB08:				; CODE XREF: sasl_server_step+171j
		test	eax, eax
		jz	short loc_1000AB65
		push	ebx
		push	ebp
		push	offset aClientChannelB ; "client channel binding %s does not matc"...
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 14h
		mov	edi, 0FFFFFFE0h
		jmp	short loc_1000AB9A
; ---------------------------------------------------------------------------

loc_1000AB25:				; CODE XREF: sasl_server_step+117j
		mov	edx, [esi+1134h]
		cmp	dword ptr [edx+68h], 0
		jz	short loc_1000AB65
		push	offset aClientIncorrec ; "client incorrectly assumed server had	n"...
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	edi, 0FFFFFFF3h
		jmp	short loc_1000AB9A
; ---------------------------------------------------------------------------

loc_1000AB48:				; CODE XREF: sasl_server_step+110j
		mov	eax, [esi+1134h]
		mov	eax, [eax+68h]
		test	eax, eax
		jz	short loc_1000AB65
		cmp	dword ptr [eax+4], 0
		jz	short loc_1000AB65
		push	offset aServerRequires ; "server requires channel binding but cli"...
		jmp	loc_1000AAC2
; ---------------------------------------------------------------------------

loc_1000AB65:				; CODE XREF: sasl_server_step+11Aj
					; sasl_server_step+17Aj ...
		test	edi, edi
		jnz	short loc_1000AB90
		cmp	[esi+864h], edi
		jz	short loc_1000AB79
		cmp	[esi+868h], edi
		jnz	short loc_1000ABDE

loc_1000AB79:				; CODE XREF: sasl_server_step+1DFj
		push	offset aMechDidNotCall ; "mech did not call canon_user for both	a"...
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	edi, 0FFFFFFFBh
		jmp	short loc_1000AB9A
; ---------------------------------------------------------------------------

loc_1000AB90:				; CODE XREF: sasl_server_step+C8j
					; sasl_server_step+D7j	...
		cmp	edi, 1
		jz	short loc_1000ABD4
		cmp	edi, 2
		jz	short loc_1000ABD4

loc_1000AB9A:				; CODE XREF: sasl_server_step+142j
					; sasl_server_step+193j ...
		mov	eax, [esi+85Ch]
		test	eax, eax
		jz	short loc_1000ABCA
		mov	ecx, [esi+1130h]
		mov	edx, [ecx+0Ch]
		mov	ecx, [esi+1134h]
		mov	ecx, [ecx+34h]
		mov	edx, [edx+1Ch]
		push	ecx
		push	eax
		call	edx
		add	esp, 8
		mov	dword ptr [esi+85Ch], 0

loc_1000ABCA:				; CODE XREF: sasl_server_step+212j
		mov	dword ptr [esi+860h], 0

loc_1000ABD4:				; CODE XREF: sasl_server_step+203j
					; sasl_server_step+208j
		test	edi, edi
		jns	short loc_1000ABDE
		mov	[esi+8F0h], edi

loc_1000ABDE:				; CODE XREF: sasl_server_step+1E7j
					; sasl_server_step+246j
		pop	ebp
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		retn
sasl_server_step endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		test	edx, edx
		jz	short locret_1000AC14
		push	ebx
		push	esi

loc_1000ABF8:				; CODE XREF: .text:1000AC10j
		mov	ecx, [edx+0Ch]
		mov	ecx, [ecx]
		lea	esi, [ecx+1]

loc_1000AC00:				; CODE XREF: .text:1000AC05j
		mov	bl, [ecx]
		inc	ecx
		test	bl, bl
		jnz	short loc_1000AC00
		mov	edx, [edx+14h]
		sub	ecx, esi
		add	eax, ecx
		test	edx, edx
		jnz	short loc_1000ABF8
		pop	esi
		pop	ebx

locret_1000AC14:			; CODE XREF: .text:1000ABF4j
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000AC20	proc near		; CODE XREF: sasl_listmech+3Cp
					; sasl_listmech+60p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 0Ch
		push	ebx
		xor	ebx, ebx
		cmp	dword_1002E5C8,	ebx
		jnz	short loc_1000AC36
		lea	eax, [ebx-0Ch]
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000AC36:				; CODE XREF: sub_1000AC20+Cj
		push	esi
		mov	esi, [esp+14h+arg_0]
		cmp	esi, ebx
		jnz	short loc_1000AC4A
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000AC4A:				; CODE XREF: sub_1000AC20+1Dj
		cmp	dword ptr [esi], 1
		jz	short loc_1000AC56
		push	6C8h
		jmp	short loc_1000AC61
; ---------------------------------------------------------------------------

loc_1000AC56:				; CODE XREF: sub_1000AC20+2Dj
		cmp	[esp+14h+arg_14], ebx
		jnz	short loc_1000AC82
		push	6CBh

loc_1000AC61:				; CODE XREF: sub_1000AC20+34j
		push	offset aParameterErr_2 ; "Parameter error in server.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000AC82:				; CODE XREF: sub_1000AC20+3Aj
		mov	eax, [esp+14h+arg_18]
		cmp	eax, ebx
		jz	short loc_1000AC8C
		mov	[eax], ebx

loc_1000AC8C:				; CODE XREF: sub_1000AC20+68j
		mov	eax, [esp+14h+arg_1C]
		cmp	eax, ebx
		jz	short loc_1000AC96
		mov	[eax], ebx

loc_1000AC96:				; CODE XREF: sub_1000AC20+72j
		mov	eax, [esp+14h+arg_C]
		push	edi
		cmp	eax, ebx
		jz	short loc_1000ACA7
		mov	edi, eax
		mov	[esp+18h+var_8], eax
		jmp	short loc_1000ACB0
; ---------------------------------------------------------------------------

loc_1000ACA7:				; CODE XREF: sub_1000AC20+7Dj
		mov	edi, offset asc_100276B0 ; " "
		mov	[esp+18h+var_8], edi

loc_1000ACB0:				; CODE XREF: sub_1000AC20+85j
		mov	ecx, [esi+113Ch]
		push	ebp
		cmp	ecx, ebx
		jz	loc_1000AFA0
		mov	ebp, [esi+1140h]
		cmp	ebp, ebx
		jle	loc_1000AFA0
		mov	eax, [esp+1Ch+arg_8]
		cmp	eax, ebx
		jz	short loc_1000ACE7
		lea	esi, [eax+1]

loc_1000ACD8:				; CODE XREF: sub_1000AC20+BDj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000ACD8
		sub	eax, esi
		mov	[esp+1Ch+var_C], eax
		jmp	short loc_1000ACEB
; ---------------------------------------------------------------------------

loc_1000ACE7:				; CODE XREF: sub_1000AC20+B3j
		mov	[esp+1Ch+var_C], ebx

loc_1000ACEB:				; CODE XREF: sub_1000AC20+C5j
		mov	eax, edi
		lea	esi, [eax+1]

loc_1000ACF0:				; CODE XREF: sub_1000AC20+D5j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000ACF0
		sub	eax, esi
		mov	[esp+1Ch+var_4], eax
		mov	eax, [esp+1Ch+arg_10]
		cmp	eax, ebx
		jz	short loc_1000AD13
		lea	esi, [eax+1]

loc_1000AD08:				; CODE XREF: sub_1000AC20+EDj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000AD08
		sub	eax, esi
		mov	ebx, eax

loc_1000AD13:				; CODE XREF: sub_1000AC20+E3j
		xor	esi, esi

loc_1000AD15:				; CODE XREF: sub_1000AC20+110j
		mov	eax, [ecx+0Ch]
		mov	eax, [eax]
		lea	edi, [eax+1]
		lea	ecx, [ecx+0]

loc_1000AD20:				; CODE XREF: sub_1000AC20+105j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000AD20
		mov	ecx, [ecx+14h]
		sub	eax, edi
		add	esi, eax
		test	ecx, ecx
		jnz	short loc_1000AD15
		lea	ecx, [ebp-1]
		imul	ecx, [esp+1Ch+var_4]
		lea	edx, [ebx+ebp]
		lea	eax, [edx+ebp*4]
		mov	edx, [esp+1Ch+var_C]
		add	ecx, esi
		mov	esi, [esp+1Ch+arg_0]
		lea	ecx, [eax+ecx*2]
		lea	eax, [ecx+edx+1]
		push	eax
		lea	eax, [esi+908h]
		push	eax
		lea	ebx, [esi+904h]
		push	ebx
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000AD94
		push	6E4h
		push	offset aOutOfMemoryI_1 ; "Out of Memory	in server.c near line %d"
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 10h
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	edi
		mov	[esi+8F0h], eax
		pop	esi
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000AD94:				; CODE XREF: sub_1000AC20+14Aj
		mov	ecx, [esp+1Ch+arg_8]
		xor	edi, edi
		cmp	ecx, edi
		jz	short loc_1000ADAC
		mov	edx, [ebx]

loc_1000ADA0:				; CODE XREF: sub_1000AC20+188j
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_1000ADA0
		jmp	short loc_1000ADB1
; ---------------------------------------------------------------------------

loc_1000ADAC:				; CODE XREF: sub_1000AC20+17Cj
		mov	ecx, [ebx]
		mov	byte ptr [ecx],	0

loc_1000ADB1:				; CODE XREF: sub_1000AC20+18Aj
		mov	ebp, [esi+113Ch]
		mov	[esp+1Ch+var_C], edi
		mov	[esp+1Ch+var_4], edi
		cmp	[esi+1140h], edi
		jle	loc_1000AF47
		jmp	short loc_1000ADD0
; ---------------------------------------------------------------------------
		align 10h

loc_1000ADD0:				; CODE XREF: sub_1000AC20+1ABj
					; sub_1000AC20+321j
		push	ebp
		call	sub_1000A600
		add	esp, 4
		test	eax, eax
		jnz	loc_1000AF2F
		mov	edx, [ebp+0Ch]
		test	dword ptr [edx+0Ch], 800h
		jz	loc_1000AE9F
		mov	eax, [esi+1134h]
		cmp	dword ptr [eax+68h], 0
		jz	loc_1000AE9F
		mov	eax, [esp+1Ch+arg_1C]
		test	eax, eax
		jz	short loc_1000AE0B
		inc	dword ptr [eax]

loc_1000AE0B:				; CODE XREF: sub_1000AC20+1E7j
		cmp	[esp+1Ch+var_C], 0
		jz	short loc_1000AE3E
		mov	eax, [esp+1Ch+var_8]
		mov	ecx, eax

loc_1000AE18:				; CODE XREF: sub_1000AC20+1FDj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000AE18
		mov	edi, [ebx]
		sub	eax, ecx
		mov	esi, ecx
		dec	edi

loc_1000AE26:				; CODE XREF: sub_1000AC20+20Cj
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1000AE26
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		jmp	short loc_1000AE46
; ---------------------------------------------------------------------------

loc_1000AE3E:				; CODE XREF: sub_1000AC20+1F0j
		mov	[esp+1Ch+var_C], 1

loc_1000AE46:				; CODE XREF: sub_1000AC20+21Cj
		mov	ecx, [ebp+0Ch]
		mov	eax, [ecx]
		mov	ecx, eax
		lea	ecx, [ecx+0]

loc_1000AE50:				; CODE XREF: sub_1000AC20+235j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000AE50
		mov	edi, [ebx]
		sub	eax, ecx
		mov	esi, ecx
		dec	edi
		mov	edi, edi

loc_1000AE60:				; CODE XREF: sub_1000AC20+246j
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1000AE60
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		mov	eax, [ebx]
		dec	eax
		lea	esp, [esp+0]

loc_1000AE80:				; CODE XREF: sub_1000AC20+266j
		mov	cl, [eax+1]
		inc	eax
		test	cl, cl
		jnz	short loc_1000AE80
		mov	edx, dword ptr ds:aPlus	; "-PLUS"
		mov	esi, [esp+1Ch+arg_0]
		mov	[eax], edx
		mov	cx, word ptr ds:aPlus+4	; "S"
		mov	[eax+4], cx

loc_1000AE9F:				; CODE XREF: sub_1000AC20+1CBj
					; sub_1000AC20+1DBj
		mov	edx, [esi+1134h]
		mov	eax, [edx+68h]
		test	eax, eax
		jz	short loc_1000AEB2
		cmp	dword ptr [eax+4], 0
		jnz	short loc_1000AF2F

loc_1000AEB2:				; CODE XREF: sub_1000AC20+28Aj
		mov	eax, [esp+1Ch+arg_1C]
		test	eax, eax
		jz	short loc_1000AEBC
		inc	dword ptr [eax]

loc_1000AEBC:				; CODE XREF: sub_1000AC20+298j
		cmp	[esp+1Ch+var_C], 0
		jz	short loc_1000AEF8
		mov	eax, [esp+1Ch+var_8]
		mov	ecx, eax
		lea	esp, [esp+0]

loc_1000AED0:				; CODE XREF: sub_1000AC20+2B5j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000AED0
		mov	edi, [ebx]
		sub	eax, ecx
		mov	esi, ecx
		dec	edi
		mov	edi, edi

loc_1000AEE0:				; CODE XREF: sub_1000AC20+2C6j
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1000AEE0
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		jmp	short loc_1000AF00
; ---------------------------------------------------------------------------

loc_1000AEF8:				; CODE XREF: sub_1000AC20+2A1j
		mov	[esp+1Ch+var_C], 1

loc_1000AF00:				; CODE XREF: sub_1000AC20+2D6j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	ecx, eax

loc_1000AF07:				; CODE XREF: sub_1000AC20+2ECj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000AF07
		mov	edi, [ebx]
		sub	eax, ecx
		mov	esi, ecx
		dec	edi

loc_1000AF15:				; CODE XREF: sub_1000AC20+2FBj
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1000AF15
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		mov	esi, [esp+1Ch+arg_0]

loc_1000AF2F:				; CODE XREF: sub_1000AC20+1BBj
					; sub_1000AC20+290j
		mov	eax, [esp+1Ch+var_4]
		mov	ebp, [ebp+14h]
		inc	eax
		mov	[esp+1Ch+var_4], eax
		cmp	eax, [esi+1140h]
		jl	loc_1000ADD0

loc_1000AF47:				; CODE XREF: sub_1000AC20+1A5j
		mov	eax, [esp+1Ch+arg_10]
		test	eax, eax
		jz	short loc_1000AF76
		mov	ecx, eax

loc_1000AF51:				; CODE XREF: sub_1000AC20+336j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000AF51
		mov	edi, [ebx]
		sub	eax, ecx
		mov	esi, ecx
		dec	edi
		nop

loc_1000AF60:				; CODE XREF: sub_1000AC20+346j
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1000AF60
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb

loc_1000AF76:				; CODE XREF: sub_1000AC20+32Dj
		mov	esi, [esp+1Ch+arg_18]
		test	esi, esi
		jz	short loc_1000AF8E
		mov	eax, [ebx]
		lea	edx, [eax+1]

loc_1000AF83:				; CODE XREF: sub_1000AC20+368j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000AF83
		sub	eax, edx
		mov	[esi], eax

loc_1000AF8E:				; CODE XREF: sub_1000AC20+35Cj
		mov	ecx, [ebx]
		mov	edx, [esp+1Ch+arg_14]
		pop	ebp
		pop	edi
		pop	esi
		mov	[edx], ecx
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000AFA0:				; CODE XREF: sub_1000AC20+99j
					; sub_1000AC20+A7j
		push	6D9h
		push	0FFFFFFFCh
		push	offset aInternalErro_1 ; "Internal Error %d in server.c	near line"...
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 14h
		pop	ebp
		pop	edi
		mov	dword ptr [esi+8F0h], 0FFFFFFFCh
		pop	esi
		mov	eax, 0FFFFFFFCh
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000AC20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000AFD0	proc near		; CODE XREF: sub_10005930+17p
		push	esi
		xor	esi, esi
		cmp	dword_1002E5C8,	esi
		jnz	short loc_1000AFDF
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000AFDF:				; CODE XREF: sub_1000AFD0+9j
		mov	eax, dword_1002E5CC
		push	edi
		mov	edi, [eax+8]
		test	edi, edi
		jz	short loc_1000B01B
		lea	esp, [esp+0]

loc_1000AFF0:				; CODE XREF: sub_1000AFD0+49j
		push	8
		call	off_1002D044
		add	esp, 4
		test	eax, eax
		jz	short loc_1000B020
		mov	ecx, [edi+0Ch]
		mov	edx, [ecx]
		mov	[eax], edx
		test	esi, esi
		jnz	short loc_1000B00F
		mov	[eax+4], esi
		jmp	short loc_1000B012
; ---------------------------------------------------------------------------

loc_1000B00F:				; CODE XREF: sub_1000AFD0+38j
		mov	[eax+4], esi

loc_1000B012:				; CODE XREF: sub_1000AFD0+3Dj
		mov	edi, [edi+14h]
		mov	esi, eax
		test	edi, edi
		jnz	short loc_1000AFF0

loc_1000B01B:				; CODE XREF: sub_1000AFD0+1Aj
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000B020:				; CODE XREF: sub_1000AFD0+2Dj
		test	esi, esi
		jz	short loc_1000B03A
		mov	edi, [esi+4]

loc_1000B027:				; CODE XREF: sub_1000AFD0+68j
		push	esi		; lpMem
		call	off_1002D050
		mov	esi, edi
		mov	edi, [edi+4]
		add	esp, 4
		test	edi, edi
		jnz	short loc_1000B027

loc_1000B03A:				; CODE XREF: sub_1000AFD0+52j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_1000AFD0	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, edx
		push	esi
		lea	esi, [eax+1]

loc_1000B046:				; CODE XREF: .text:1000B04Bj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000B046
		sub	eax, esi
		mov	esi, eax
		push	esi
		push	edi
		push	edx
		call	sub_10023FC7
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B076
		mov	al, [esi+edi]
		test	al, al
		jz	short loc_1000B06F
		cmp	al, 20h
		jz	short loc_1000B06F
		cmp	al, 9
		jnz	short loc_1000B076

loc_1000B06F:				; CODE XREF: .text:1000B065j
					; .text:1000B069j
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000B076:				; CODE XREF: .text:1000B05Ej
					; .text:1000B06Dj
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B080	proc near		; CODE XREF: sasl_checkpass+7Ep
					; DATA XREF: sub_1000B990+1Fo ...

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 14h
		cmp	[esp+14h+arg_10], 0
		push	ebp
		mov	ebp, [esp+18h+arg_0]
		mov	eax, [ebp+8]
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_4], eax
		jnz	short loc_1000B0B2
		mov	eax, [esp+18h+arg_C]
		lea	edx, [eax+1]

loc_1000B0A5:				; CODE XREF: sub_1000B080+2Aj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000B0A5
		sub	eax, edx
		mov	[esp+18h+arg_10], eax

loc_1000B0B2:				; CODE XREF: sub_1000B080+1Cj
		lea	ecx, [esp+18h+arg_0]
		push	ecx
		lea	edx, [esp+1Ch+var_C]
		push	edx
		push	8005h
		push	ebp
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000B103
		mov	eax, [esp+18h+var_C]
		test	eax, eax
		jz	short loc_1000B103
		mov	ecx, [ebp+1134h]
		mov	edx, [ecx+60h]
		mov	ecx, [esp+18h+arg_10]
		push	edx
		mov	edx, [esp+1Ch+arg_C]
		push	ecx
		mov	ecx, [esp+20h+arg_4]
		push	edx
		mov	edx, [esp+24h+arg_0]
		push	ecx
		push	edx
		push	ebp
		call	eax
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1000B103
		pop	ebp
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000B103:				; CODE XREF: sub_1000B080+4Cj
					; sub_1000B080+54j ...
		lea	eax, [esp+18h+arg_0]
		push	eax
		lea	ecx, [esp+1Ch+var_8]
		push	ecx
		push	1
		push	ebp
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000B134
		push	eax
		lea	edx, [esp+1Ch+var_14]
		push	edx
		push	offset aPwcheck_method ; "pwcheck_method"
		push	eax
		mov	eax, [esp+28h+arg_0]
		push	eax
		call	[esp+2Ch+var_8]
		add	esp, 14h

loc_1000B134:				; CODE XREF: sub_1000B080+9Aj
		push	esi
		mov	esi, [esp+1Ch+var_14]
		push	edi
		test	esi, esi
		jnz	short loc_1000B147
		mov	esi, offset aAuxprop ; "auxprop"
		mov	[esp+20h+var_14], esi

loc_1000B147:				; CODE XREF: sub_1000B080+BCj
		cmp	byte ptr [esi],	0
		mov	edi, 0FFFFFFFCh
		mov	[esp+20h+var_10], edi
		jz	loc_1000B27D
		push	ebx
		lea	ebx, [ebx+0]

loc_1000B160:				; CODE XREF: sub_1000B080+1EDj
		test	edi, edi
		jz	loc_1000B273
		cmp	off_1002D028, 0
		mov	ebx, offset off_1002D028
		jz	short loc_1000B1DA

loc_1000B176:				; CODE XREF: sub_1000B080+12Fj
		mov	edx, [ebx]
		mov	eax, edx
		lea	edi, [eax+1]
		lea	ecx, [ecx+0]

loc_1000B180:				; CODE XREF: sub_1000B080+105j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000B180
		sub	eax, edi
		mov	edi, eax
		push	edi
		push	esi
		push	edx
		call	sub_10023FC7
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B1A9
		mov	al, [edi+esi]
		test	al, al
		jz	short loc_1000B1B3
		cmp	al, 20h
		jz	short loc_1000B1B3
		cmp	al, 9
		jz	short loc_1000B1B3

loc_1000B1A9:				; CODE XREF: sub_1000B080+118j
		add	ebx, 8
		cmp	dword ptr [ebx], 0
		jnz	short loc_1000B176
		jmp	short loc_1000B1D6
; ---------------------------------------------------------------------------

loc_1000B1B3:				; CODE XREF: sub_1000B080+11Fj
					; sub_1000B080+123j ...
		mov	ecx, [ebp+1124h]
		mov	edx, [esp+24h+var_4]
		mov	eax, [esp+24h+arg_C]
		push	ecx
		mov	ecx, [esp+28h+arg_4]
		push	edx
		mov	edx, [ebx+4]
		push	eax
		push	ecx
		push	ebp
		call	edx
		add	esp, 14h
		mov	[esp+24h+var_10], eax

loc_1000B1D6:				; CODE XREF: sub_1000B080+131j
		mov	edi, [esp+24h+var_10]

loc_1000B1DA:				; CODE XREF: sub_1000B080+F4j
		test	edi, edi
		jz	short loc_1000B22A
		mov	al, [esi]
		test	al, al
		jz	loc_1000B273
		jmp	short loc_1000B1F0
; ---------------------------------------------------------------------------
		align 10h

loc_1000B1F0:				; CODE XREF: sub_1000B080+168j
					; sub_1000B080+186j
		movsx	eax, al
		push	eax
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000B20A
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_1000B1F0
		jmp	short loc_1000B273
; ---------------------------------------------------------------------------

loc_1000B20A:				; CODE XREF: sub_1000B080+17Ej
		mov	al, [esi]
		test	al, al
		jz	short loc_1000B273

loc_1000B210:				; CODE XREF: sub_1000B080+1A6j
		movsx	ecx, al
		push	ecx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jz	short loc_1000B26A
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_1000B210
		jmp	short loc_1000B273
; ---------------------------------------------------------------------------

loc_1000B22A:				; CODE XREF: sub_1000B080+15Cj
		push	7
		push	esi
		push	offset aAuxprop	; "auxprop"
		call	sub_10023FC7
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B24D
		mov	al, [esi+7]
		test	al, al
		jz	short loc_1000B26A
		cmp	al, 20h
		jz	short loc_1000B26A
		cmp	al, 9
		jz	short loc_1000B26A

loc_1000B24D:				; CODE XREF: sub_1000B080+1BCj
		mov	edx, [ebp+1134h]
		mov	eax, [edx+58h]
		test	eax, eax
		jz	short loc_1000B26A
		mov	ecx, [esp+24h+arg_10]
		mov	edx, [esp+24h+arg_C]
		push	ecx
		push	edx
		push	ebp
		call	eax
		add	esp, 0Ch

loc_1000B26A:				; CODE XREF: sub_1000B080+19Ej
					; sub_1000B080+1C3j ...
		cmp	byte ptr [esi],	0
		jnz	loc_1000B160

loc_1000B273:				; CODE XREF: sub_1000B080+E2j
					; sub_1000B080+162j ...
		pop	ebx
		cmp	edi, 0FFFFFFFCh
		jnz	short loc_1000B290
		mov	esi, [esp+20h+var_14]

loc_1000B27D:				; CODE XREF: sub_1000B080+D3j
		push	esi
		push	offset aUnknownPasswor ; "unknown password verifier(s) %s"
		push	1
		push	ebp
		call	sub_10006F30
		add	esp, 10h
		jmp	short loc_1000B294
; ---------------------------------------------------------------------------

loc_1000B290:				; CODE XREF: sub_1000B080+1F7j
		test	edi, edi
		jz	short loc_1000B2A6

loc_1000B294:				; CODE XREF: sub_1000B080+20Ej
		push	offset aCheckpassFaile ; "checkpass failed"
		push	1
		push	ebp
		call	sasl_seterror
		add	esp, 0Ch
		test	edi, edi

loc_1000B2A6:				; CODE XREF: sub_1000B080+212j
		jns	short loc_1000B2AE
		mov	[ebp+8F0h], edi

loc_1000B2AE:				; CODE XREF: sub_1000B080:loc_1000B2A6j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 14h
		retn
sub_1000B080	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  25. sasl_checkpass

; =============== S U B	R O U T	I N E =======================================


		public sasl_checkpass
sasl_checkpass	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		cmp	dword_1002E5C8,	0
		jnz	short loc_1000B2CF
		mov	eax, 0FFFFFFF4h
		retn
; ---------------------------------------------------------------------------

loc_1000B2CF:				; CODE XREF: sasl_checkpass+7j
		mov	eax, [esp+arg_4]
		test	eax, eax
		jnz	short loc_1000B2D8
		retn
; ---------------------------------------------------------------------------

loc_1000B2D8:				; CODE XREF: sasl_checkpass+15j
		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jnz	short loc_1000B2E6
		lea	eax, [esi-7]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000B2E6:				; CODE XREF: sasl_checkpass+1Fj
		push	ebx
		mov	ebx, [esp+8+arg_C]
		test	ebx, ebx
		jnz	short loc_1000B312
		push	7B7h
		push	offset aParameterErr_2 ; "Parameter error in server.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		pop	ebx
		mov	[esi+8F0h], eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000B312:				; CODE XREF: sasl_checkpass+2Dj
		push	edi
		mov	edi, [esp+0Ch+arg_8]
		lea	ecx, [esi+860h]
		push	ecx
		push	3
		push	edi
		push	eax
		push	esi
		call	sub_10002440
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1000B351
		mov	edx, [esp+0Ch+arg_10]
		mov	eax, [esi+864h]
		push	edx
		push	ebx
		push	edi
		push	eax
		push	esi
		call	sub_1000B080
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1000B351
		call	sub_1000A8D0
		test	eax, eax

loc_1000B351:				; CODE XREF: sasl_checkpass+6Dj
					; sasl_checkpass+88j
		jns	short loc_1000B359
		mov	[esi+8F0h], eax

loc_1000B359:				; CODE XREF: sasl_checkpass:loc_1000B351j
		pop	edi
		pop	ebx
		pop	esi
		retn
sasl_checkpass	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  69. sasl_user_exists

; =============== S U B	R O U T	I N E =======================================


		public sasl_user_exists
sasl_user_exists proc near		; DATA XREF: .rdata:off_1002C568o

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		cmp	dword_1002E5C8,	0
		mov	[esp+0Ch+var_C], 0
		jnz	short loc_1000B37C
		mov	eax, 0FFFFFFF4h
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000B37C:				; CODE XREF: sasl_user_exists+11j
		push	edi
		mov	edi, [esp+10h+arg_0]
		test	edi, edi
		jnz	short loc_1000B38D
		lea	eax, [edi-7]
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000B38D:				; CODE XREF: sasl_user_exists+23j
		cmp	[esp+10h+arg_C], 0
		jz	loc_1000B519
		cmp	dword ptr [edi], 1
		jnz	loc_1000B519
		cmp	[esp+10h+arg_4], 0
		jnz	short loc_1000B3AF
		mov	eax, [edi+8]
		mov	[esp+10h+arg_4], eax

loc_1000B3AF:				; CODE XREF: sasl_user_exists+46j
		lea	ecx, [esp+10h+var_8]
		push	ecx
		lea	edx, [esp+14h+var_4]
		push	edx
		push	1
		push	edi
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000B3E1
		mov	ecx, [esp+10h+var_8]
		push	eax
		lea	eax, [esp+14h+var_C]
		push	eax
		push	offset aPwcheck_method ; "pwcheck_method"
		push	0
		push	ecx
		call	[esp+24h+var_4]
		add	esp, 14h

loc_1000B3E1:				; CODE XREF: sasl_user_exists+66j
		push	ebp
		push	esi
		mov	esi, [esp+18h+var_C]
		test	esi, esi
		jnz	short loc_1000B3F4
		mov	esi, offset aAuxprop ; "auxprop"
		mov	[esp+18h+var_C], esi

loc_1000B3F4:				; CODE XREF: sasl_user_exists+89j
		cmp	byte ptr [esi],	0
		mov	ebp, 0FFFFFFFCh
		jz	loc_1000B4E9
		push	ebx

loc_1000B403:				; CODE XREF: sasl_user_exists+16Dj
		test	ebp, ebp
		jz	loc_1000B4D3
		cmp	off_1002D028, 0
		mov	ebx, offset off_1002D028
		jz	short loc_1000B47E
		lea	esp, [esp+0]

loc_1000B420:				; CODE XREF: sasl_user_exists+F6j
		mov	edx, [ebx]
		mov	eax, edx
		lea	edi, [eax+1]

loc_1000B427:				; CODE XREF: sasl_user_exists+CCj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000B427
		sub	eax, edi
		mov	edi, eax
		push	edi
		push	esi
		push	edx
		call	sub_10023FC7
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B450
		mov	al, [edi+esi]
		test	al, al
		jz	short loc_1000B45A
		cmp	al, 20h
		jz	short loc_1000B45A
		cmp	al, 9
		jz	short loc_1000B45A

loc_1000B450:				; CODE XREF: sasl_user_exists+DFj
		add	ebx, 8
		cmp	dword ptr [ebx], 0
		jnz	short loc_1000B420
		jmp	short loc_1000B47A
; ---------------------------------------------------------------------------

loc_1000B45A:				; CODE XREF: sasl_user_exists+E6j
					; sasl_user_exists+EAj	...
		mov	edx, [esp+1Ch+arg_8]
		mov	eax, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+arg_C]
		push	edx
		mov	edx, [esp+20h+arg_0]
		push	eax
		mov	eax, [ebx+4]
		push	0
		push	ecx
		push	edx
		call	eax
		add	esp, 14h
		mov	ebp, eax

loc_1000B47A:				; CODE XREF: sasl_user_exists+F8j
		mov	edi, [esp+1Ch+arg_0]

loc_1000B47E:				; CODE XREF: sasl_user_exists+B7j
		test	ebp, ebp
		jz	short loc_1000B4CA
		mov	al, [esi]
		test	al, al
		jz	short loc_1000B4D3
		jmp	short loc_1000B490
; ---------------------------------------------------------------------------
		align 10h

loc_1000B490:				; CODE XREF: sasl_user_exists+128j
					; sasl_user_exists+146j
		movsx	ecx, al
		push	ecx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000B4AA
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_1000B490
		jmp	short loc_1000B4D3
; ---------------------------------------------------------------------------

loc_1000B4AA:				; CODE XREF: sasl_user_exists+13Ej
		mov	al, [esi]
		test	al, al
		jz	short loc_1000B4D3

loc_1000B4B0:				; CODE XREF: sasl_user_exists+166j
		movsx	edx, al
		push	edx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jz	short loc_1000B4CA
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_1000B4B0
		jmp	short loc_1000B4D3
; ---------------------------------------------------------------------------

loc_1000B4CA:				; CODE XREF: sasl_user_exists+120j
					; sasl_user_exists+15Ej
		cmp	byte ptr [esi],	0
		jnz	loc_1000B403

loc_1000B4D3:				; CODE XREF: sasl_user_exists+A5j
					; sasl_user_exists+126j ...
		pop	ebx
		cmp	ebp, 0FFFFFFF9h
		jnz	short loc_1000B4E4
		xor	ebp, ebp
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000B4E4:				; CODE XREF: sasl_user_exists+177j
		cmp	ebp, 0FFFFFFFCh
		jnz	short loc_1000B506

loc_1000B4E9:				; CODE XREF: sasl_user_exists+9Cj
		push	offset aNoPlaintextPas ; "no plaintext password	verifier?"
		push	1
		push	edi
		call	sub_10006F30
		push	offset aNoPlaintextPas ; "no plaintext password	verifier?"
		push	1
		push	edi
		call	sasl_seterror
		add	esp, 18h

loc_1000B506:				; CODE XREF: sasl_user_exists+187j
		test	ebp, ebp
		jns	short loc_1000B510
		mov	[edi+8F0h], ebp

loc_1000B510:				; CODE XREF: sasl_user_exists+1A8j
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000B519:				; CODE XREF: sasl_user_exists+32j
					; sasl_user_exists+3Bj
		push	7E8h
		push	offset aParameterErr_2 ; "Parameter error in server.c near line	%"...
		push	1
		push	edi
		call	sasl_seterror
		mov	eax, 0FFFFFFF9h
		add	esp, 10h
		mov	[edi+8F0h], eax
		pop	edi
		add	esp, 0Ch
		retn
sasl_user_exists endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  24. sasl_checkapop

; =============== S U B	R O U T	I N E =======================================


		public sasl_checkapop
sasl_checkapop	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	offset aSasl_checkap_0 ; "sasl_checkapop called, but was disabled"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	eax, 0FFFFFFFCh
		test	esi, esi
		jz	short loc_1000B564
		mov	[esi+8F0h], eax

loc_1000B564:				; CODE XREF: sasl_checkapop+1Cj
		pop	esi
		retn
sasl_checkapop	endp

; ---------------------------------------------------------------------------
		align 10h

loc_1000B570:				; DATA XREF: sasl_server_plugin_info+Co
		mov	eax, [esp+8]
		test	eax, eax
		jnz	short loc_1000B586
		push	offset aListOfServerPl ; "List of server plugins follows\n"
		call	sub_1000ED67
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_1000B586:				; CODE XREF: .text:1000B576j
		cmp	eax, 2
		jz	locret_1000B839
		push	esi
		mov	esi, [esp+8]
		mov	eax, [esi+8]
		push	eax
		push	offset aPluginS	; "Plugin \"%s\" "
		call	sub_1000ED67
		mov	eax, [esi+4]
		add	esp, 8
		cmp	eax, 0FFFFFFECh
		jz	short loc_1000B5CB
		test	eax, eax
		jz	short loc_1000B5C4
		cmp	eax, 1
		jz	short loc_1000B5BD
		push	offset aUnknown	; "[unknown]"
		jmp	short loc_1000B5D0
; ---------------------------------------------------------------------------

loc_1000B5BD:				; CODE XREF: .text:1000B5B4j
		push	offset aDelayed	; "[delayed]"
		jmp	short loc_1000B5D0
; ---------------------------------------------------------------------------

loc_1000B5C4:				; CODE XREF: .text:1000B5AFj
		push	offset aLoaded	; "[loaded]"
		jmp	short loc_1000B5D0
; ---------------------------------------------------------------------------

loc_1000B5CB:				; CODE XREF: .text:1000B5ABj
		push	offset aNoUsers	; "[no users]"

loc_1000B5D0:				; CODE XREF: .text:1000B5BBj
					; .text:1000B5C2j ...
		call	sub_1000ED67
		mov	ecx, [esi]
		add	esp, 4
		push	ecx
		push	offset aApiVersionD ; ", \tAPI version:	%d\n"
		call	sub_1000ED67
		mov	eax, [esi+0Ch]
		add	esp, 8
		test	eax, eax
		jz	loc_1000B816
		cmp	dword ptr [eax+24h], 0
		mov	ecx, offset aYes ; "yes"
		jnz	short loc_1000B603
		mov	ecx, offset aNo	; "no"

loc_1000B603:				; CODE XREF: .text:1000B5FCj
		mov	edx, [eax+4]
		mov	eax, [eax]
		push	ecx
		push	edx
		push	eax
		push	offset aSaslMechanis_0 ; "\tSASL mechanism: %s,	best SSF: %d, sup"...
		call	sub_1000ED67
		push	offset aSecurityFlags ;	"\tsecurity flags:"
		call	sub_1000ED67
		mov	ecx, [esi+0Ch]
		add	esp, 14h
		test	byte ptr [ecx+8], 10h
		mov	al, 20h
		jz	short loc_1000B63E
		push	20h
		push	offset aCno_anonymous ;	"%cNO_ANONYMOUS"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B63E:				; CODE XREF: .text:1000B62Bj
		mov	edx, [esi+0Ch]
		test	byte ptr [edx+8], 1
		jz	short loc_1000B65A
		movsx	eax, al
		push	eax
		push	offset aCno_plaintext ;	"%cNO_PLAINTEXT"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B65A:				; CODE XREF: .text:1000B645j
		mov	ecx, [esi+0Ch]
		test	byte ptr [ecx+8], 2
		jz	short loc_1000B676
		movsx	edx, al
		push	edx
		push	offset aCno_active ; "%cNO_ACTIVE"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B676:				; CODE XREF: .text:1000B661j
		mov	ecx, [esi+0Ch]
		test	byte ptr [ecx+8], 4
		jz	short loc_1000B692
		movsx	edx, al
		push	edx
		push	offset aCno_dictionary ; "%cNO_DICTIONARY"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B692:				; CODE XREF: .text:1000B67Dj
		mov	ecx, [esi+0Ch]
		test	byte ptr [ecx+8], 8
		jz	short loc_1000B6AE
		movsx	edx, al
		push	edx
		push	offset aCforward_secre ; "%cFORWARD_SECRECY"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B6AE:				; CODE XREF: .text:1000B699j
		mov	ecx, [esi+0Ch]
		test	byte ptr [ecx+8], 20h
		jz	short loc_1000B6CA
		movsx	edx, al
		push	edx
		push	offset aCpass_credenti ; "%cPASS_CREDENTIALS"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B6CA:				; CODE XREF: .text:1000B6B5j
		mov	ecx, [esi+0Ch]
		test	byte ptr [ecx+8], 40h
		jz	short loc_1000B6E4
		movsx	edx, al
		push	edx
		push	offset aCmutual_auth ; "%cMUTUAL_AUTH"
		call	sub_1000ED67
		add	esp, 8

loc_1000B6E4:				; CODE XREF: .text:1000B6D1j
		push	offset aFeatures ; "\n\tfeatures:"
		call	sub_1000ED67
		mov	ecx, [esi+0Ch]
		add	esp, 4
		test	byte ptr [ecx+0Ch], 2
		mov	al, 20h
		jz	short loc_1000B70D
		push	20h
		push	offset aCwant_client_f ; "%cWANT_CLIENT_FIRST"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B70D:				; CODE XREF: .text:1000B6FAj
		mov	edx, [esi+0Ch]
		test	byte ptr [edx+0Ch], 10h
		jz	short loc_1000B729
		movsx	eax, al
		push	eax
		push	offset aCserver_first ;	"%cSERVER_FIRST"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B729:				; CODE XREF: .text:1000B714j
		mov	ecx, [esi+0Ch]
		test	byte ptr [ecx+0Ch], 20h
		jz	short loc_1000B745
		movsx	edx, al
		push	edx
		push	offset aCproxy_authent ; "%cPROXY_AUTHENTICATION"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B745:				; CODE XREF: .text:1000B730j
		mov	ecx, [esi+0Ch]
		test	byte ptr [ecx+0Ch], 80h
		jz	short loc_1000B761
		movsx	edx, al
		push	edx
		push	offset aCdontuse_userp ; "%cDONTUSE_USERPASSWD"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B761:				; CODE XREF: .text:1000B74Cj
		mov	ecx, [esi+0Ch]
		test	byte ptr [ecx+0Ch], 1
		jz	short loc_1000B77D
		movsx	edx, al
		push	edx
		push	offset aCneed_server_f ; "%cNEED_SERVER_FQDN"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B77D:				; CODE XREF: .text:1000B768j
		mov	ecx, [esi+0Ch]
		test	dword ptr [ecx+0Ch], 200h
		jz	short loc_1000B79C
		movsx	edx, al
		push	edx
		push	offset aCservice ; "%cSERVICE"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B79C:				; CODE XREF: .text:1000B787j
		mov	ecx, [esi+0Ch]
		test	dword ptr [ecx+0Ch], 400h
		jz	short loc_1000B7BB
		movsx	edx, al
		push	edx
		push	offset aCneed_getsecre ; "%cNEED_GETSECRET"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B7BB:				; CODE XREF: .text:1000B7A6j
		mov	ecx, [esi+0Ch]
		test	dword ptr [ecx+0Ch], 100h
		jz	short loc_1000B7DA
		movsx	edx, al
		push	edx
		push	offset aCgss_framing ; "%cGSS_FRAMING"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B7DA:				; CODE XREF: .text:1000B7C5j
		mov	ecx, [esi+0Ch]
		test	dword ptr [ecx+0Ch], 800h
		jz	short loc_1000B7F9
		movsx	edx, al
		push	edx
		push	offset aCchannel_bindi ; "%cCHANNEL_BINDING"
		call	sub_1000ED67
		add	esp, 8
		mov	al, 7Ch

loc_1000B7F9:				; CODE XREF: .text:1000B7E4j
		mov	ecx, [esi+0Ch]
		test	dword ptr [ecx+0Ch], 1000h
		jz	short loc_1000B816
		movsx	edx, al
		push	edx
		push	offset aCsupports_http ; "%cSUPPORTS_HTTP"
		call	sub_1000ED67
		add	esp, 8

loc_1000B816:				; CODE XREF: .text:1000B5EDj
					; .text:1000B803j
		mov	esi, [esi+10h]
		test	esi, esi
		jz	short loc_1000B82B
		push	esi
		push	offset aWillBeLoadedFr ; "\n\twill be loaded from \"%s\""
		call	sub_1000ED67
		add	esp, 8

loc_1000B82B:				; CODE XREF: .text:1000B81Bj
		push	offset asc_100272D8 ; "\n"
		call	sub_1000ED67
		add	esp, 4
		pop	esi

locret_1000B839:			; CODE XREF: .text:1000B589j
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  59. sasl_server_plugin_info

; =============== S U B	R O U T	I N E =======================================


		public sasl_server_plugin_info
sasl_server_plugin_info	proc near	; DATA XREF: .rdata:off_1002C568o

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 14h
		push	ebx
		mov	ebx, [esp+18h+arg_4]
		test	ebx, ebx
		jnz	short loc_1000B851
		mov	ebx, offset loc_1000B570

loc_1000B851:				; CODE XREF: sasl_server_plugin_info+Aj
		cmp	dword_1002E5CC,	0
		jz	loc_1000B980
		push	esi
		push	edi
		mov	edi, [esp+20h+arg_8]
		push	edi
		push	0
		push	0
		call	ebx
		mov	eax, [esp+2Ch+arg_0]
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000B8CE
		mov	eax, dword_1002E5CC
		mov	esi, [eax+8]
		test	esi, esi
		jz	loc_1000B96D

loc_1000B886:				; CODE XREF: sasl_server_plugin_info+7Aj
		mov	ecx, [esi]
		mov	[esp+20h+var_14], ecx
		mov	edx, [esi+4]
		mov	[esp+20h+var_10], edx
		mov	eax, [esi+8]
		mov	[esp+20h+var_C], eax
		mov	ecx, [esi+0Ch]
		push	edi
		mov	[esp+24h+var_8], ecx
		mov	edx, [esi+10h]
		lea	eax, [esp+24h+var_14]
		push	1
		push	eax
		mov	[esp+2Ch+var_4], edx
		call	ebx
		mov	esi, [esi+14h]
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1000B886
		push	edi
		push	2
		push	esi
		call	ebx
		add	esp, 0Ch
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000B8CE:				; CODE XREF: sasl_server_plugin_info+34j
		push	ebp
		push	eax
		call	sub_1002449A
		add	esp, 4
		mov	[esp+24h+arg_4], eax
		mov	ebp, eax
		test	eax, eax
		jz	loc_1000B963

loc_1000B8E6:				; CODE XREF: sasl_server_plugin_info+119j
		push	20h
		push	ebp
		call	sub_1000EF20
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_1000B8FB
		mov	byte ptr [edi],	0
		inc	edi

loc_1000B8FB:				; CODE XREF: sasl_server_plugin_info+B5j
		mov	ecx, dword_1002E5CC
		mov	esi, [ecx+8]
		test	esi, esi
		jz	short loc_1000B955

loc_1000B908:				; CODE XREF: sasl_server_plugin_info+113j
		mov	edx, [esi+0Ch]
		mov	eax, [edx]
		push	eax
		push	ebp
		call	sub_10023E83
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000B94E
		mov	ecx, [esi]
		mov	[esp+24h+var_14], ecx
		mov	edx, [esi+4]
		mov	[esp+24h+var_10], edx
		mov	eax, [esi+8]
		mov	[esp+24h+var_C], eax
		mov	ecx, [esi+0Ch]
		mov	eax, [esp+24h+arg_8]
		push	eax
		mov	[esp+28h+var_8], ecx
		mov	edx, [esi+10h]
		lea	ecx, [esp+28h+var_14]
		push	1
		push	ecx
		mov	[esp+30h+var_4], edx
		call	ebx
		add	esp, 0Ch

loc_1000B94E:				; CODE XREF: sasl_server_plugin_info+D9j
		mov	esi, [esi+14h]
		test	esi, esi
		jnz	short loc_1000B908

loc_1000B955:				; CODE XREF: sasl_server_plugin_info+C6j
		mov	ebp, edi
		test	edi, edi
		jnz	short loc_1000B8E6
		mov	edi, [esp+24h+arg_8]
		mov	eax, [esp+24h+arg_4]

loc_1000B963:				; CODE XREF: sasl_server_plugin_info+A0j
		push	eax		; lpMem
		call	sub_1000EE73
		add	esp, 4
		pop	ebp

loc_1000B96D:				; CODE XREF: sasl_server_plugin_info+40j
		push	edi
		push	2
		push	0
		call	ebx
		add	esp, 0Ch
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000B980:				; CODE XREF: sasl_server_plugin_info+18j
		mov	eax, 0FFFFFFF4h
		pop	ebx
		add	esp, 14h
		retn
sasl_server_plugin_info	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B990	proc near		; CODE XREF: sasl_server_init:loc_1000BB0Bp
		push	offset dword_1002F060
		push	0
		call	sub_10007350
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000B9A9
		mov	eax, 0FFFFFFFEh
		retn
; ---------------------------------------------------------------------------

loc_1000B9A9:				; CODE XREF: sub_1000B990+11j
		mov	ecx, dword_1002E5CC
		mov	dword ptr [eax+64h], offset sub_1000B080
		mov	[ecx], eax
		mov	dword ptr [ecx+8], 0
		mov	dword ptr [ecx+0Ch], 0
		xor	eax, eax
		retn
sub_1000B990	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  57. sasl_server_init

; =============== S U B	R O U T	I N E =======================================


		public sasl_server_init
sasl_server_init proc near		; DATA XREF: .rdata:off_1002C568o

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		inc	dword_1002E4AC
		push	esi
		mov	esi, [esp+28h+arg_4]
		push	edi
		mov	edi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_24], offset aSasl_server__1 ; "sasl_server_plug_init"
		mov	[esp+2Ch+var_20], offset sasl_server_add_plugin
		mov	[esp+2Ch+var_1C], offset aSasl_auxprop_p ; "sasl_auxprop_plug_init"
		mov	[esp+2Ch+var_18], offset sasl_auxprop_add_plugin
		mov	[esp+2Ch+var_14], offset aSasl_canonus_0 ; "sasl_canonuser_init"
		mov	[esp+2Ch+var_10], offset sasl_canonuser_add_plugin
		mov	[esp+2Ch+var_C], 0
		mov	[esp+2Ch+var_8], 0
		test	esi, esi
		jz	short loc_1000BA5D
		mov	eax, esi
		lea	edx, [eax+1]

loc_1000BA37:				; CODE XREF: sasl_server_init+6Cj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000BA37
		sub	eax, edx
		cmp	eax, 104h
		jb	short loc_1000BA5D
		pop	edi
		mov	eax, 0FFFFFFF9h
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1000BA5D:				; CODE XREF: sasl_server_init+60j
					; sasl_server_init+75j
		cmp	dword_1002E5C8,	0
		jz	short loc_1000BA7F
		inc	dword_1002E5C8
		pop	edi
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1000BA7F:				; CODE XREF: sasl_server_init+94j
		push	offset dword_1002F060
		call	sub_10007860
		add	esp, 4
		test	eax, eax
		jnz	loc_1000BB9D
		mov	eax, edi
		test	edi, edi
		jz	short loc_1000BAAE
		cmp	dword ptr [edi], 0
		jz	short loc_1000BAAE
		nop

loc_1000BAA0:				; CODE XREF: sasl_server_init+DCj
		cmp	dword ptr [eax+4], 0
		jz	short loc_1000BAF7
		add	eax, 0Ch
		cmp	dword ptr [eax], 0
		jnz	short loc_1000BAA0

loc_1000BAAE:				; CODE XREF: sasl_server_init+C8j
					; sasl_server_init+CDj
		mov	dword_1002F060,	edi
		test	esi, esi
		jz	short loc_1000BABE
		mov	dword_1002F064,	esi

loc_1000BABE:				; CODE XREF: sasl_server_init+E6j
		push	10h
		mov	dword_1002E5C8,	1
		call	off_1002D044
		add	esp, 4
		mov	dword_1002E5CC,	eax
		test	eax, eax
		jnz	short loc_1000BB0B
		call	sub_10009FE0
		pop	edi
		mov	eax, 0FFFFFFFEh
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1000BAF7:				; CODE XREF: sasl_server_init+D4j
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1000BB0B:				; CODE XREF: sasl_server_init+10Aj
		call	sub_1000B990
		mov	esi, eax
		test	esi, esi
		jnz	loc_1000BB96
		push	edi
		call	sub_10005610
		push	eax
		call	sub_1000A0F0
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000BB34
		cmp	esi, 1
		jnz	short loc_1000BB96

loc_1000BB34:				; CODE XREF: sasl_server_init+15Dj
		push	offset loc_10007D70
		push	offset aExternal ; "EXTERNAL"
		call	sasl_server_add_plugin
		push	edi
		call	sub_10005610
		add	esp, 0Ch
		push	eax
		push	edi
		call	sub_100055B0
		add	esp, 4
		push	eax
		lea	eax, [esp+34h+var_24]
		push	eax
		call	sub_1000C9A0
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_1000BB96
		mov	dword_1002E4A0,	offset sub_10009FE0
		mov	dword_1002E4A8,	offset loc_1000A090
		call	sub_10005930
		pop	edi
		mov	esi, eax
		pop	esi
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1000BB96:				; CODE XREF: sasl_server_init+144j
					; sasl_server_init+162j ...
		call	sub_10009FE0
		mov	eax, esi

loc_1000BB9D:				; CODE XREF: sasl_server_init+BEj
		mov	ecx, [esp+2Ch+var_4]
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sasl_server_init endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  58. sasl_server_new

; =============== S U B	R O U T	I N E =======================================


		public sasl_server_new
sasl_server_new	proc near		; DATA XREF: .rdata:off_1002C568o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 1Ch
		push	ebx
		xor	ebx, ebx
		mov	[esp+20h+var_1C], ebx
		mov	[esp+20h+var_4], ebx
		cmp	dword_1002E5C8,	ebx
		jnz	short loc_1000BBCE
		lea	eax, [ebx-0Ch]
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000BBCE:				; CODE XREF: sasl_server_new+14j
		push	ebp
		mov	ebp, [esp+24h+arg_1C]
		cmp	ebp, ebx
		jnz	short loc_1000BBE0
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000BBE0:				; CODE XREF: sasl_server_new+25j
		push	esi
		mov	esi, [esp+28h+arg_0]
		cmp	esi, ebx
		jnz	short loc_1000BBF3
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000BBF3:				; CODE XREF: sasl_server_new+37j
		push	1144h
		call	off_1002D044
		add	esp, 4
		mov	[ebp+0], eax
		cmp	eax, ebx
		jnz	short loc_1000BC14
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000BC14:				; CODE XREF: sasl_server_new+56j
		push	edi
		push	1144h
		push	ebx
		push	eax
		call	sub_1000E0F0
		mov	edi, [ebp+0]
		push	90h
		call	off_1002D044
		add	esp, 10h
		mov	[edi+1134h], eax
		cmp	eax, ebx
		jnz	short loc_1000BC75
		mov	eax, [ebp+0]
		cmp	eax, ebx
		jz	short loc_1000BC68
		push	40Fh
		push	offset aOutOfMemoryI_1 ; "Out of Memory	in server.c near line %d"
		push	ebx
		push	eax
		call	sasl_seterror
		mov	eax, [ebp+0]
		add	esp, 10h
		cmp	eax, ebx
		jz	short loc_1000BC68
		mov	dword ptr [eax+8F0h], 0FFFFFFFEh

loc_1000BC68:				; CODE XREF: sasl_server_new+91j
					; sasl_server_new+ACj ...
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000BC75:				; CODE XREF: sasl_server_new+8Aj
		push	90h
		push	ebx
		push	eax
		call	sub_1000E0F0
		mov	eax, [ebp+0]
		mov	ecx, [esp+38h+arg_14]
		mov	edx, [esp+38h+arg_10]
		push	offset dword_1002F060
		push	ecx
		mov	ecx, [esp+40h+arg_4]
		push	edx
		mov	edx, [esp+44h+arg_18]
		mov	dword ptr [eax+4], offset loc_10009C30
		mov	eax, [esp+44h+arg_C]
		push	eax
		mov	eax, [ebp+0]
		push	ecx
		push	offset loc_1000A090
		push	1
		push	edx
		push	esi
		push	eax
		call	sub_100075A0
		add	esp, 34h
		mov	[esp+2Ch+var_18], eax
		cmp	eax, ebx
		jnz	short loc_1000BCE6
		mov	ecx, [ebp+0]
		push	offset dword_1002F060
		push	ecx
		call	sub_10007350
		mov	ebx, eax
		xor	esi, esi
		add	esp, 8
		cmp	ebx, esi
		jnz	short loc_1000BD0F

loc_1000BCDE:				; CODE XREF: sasl_server_new+181j
					; sasl_server_new+1CCj
		mov	[esp+2Ch+var_18], 0FFFFFFFEh

loc_1000BCE6:				; CODE XREF: sasl_server_new+113j
					; sasl_server_new+504j
		mov	edx, [ebp+0]
		push	edx
		call	sub_10004D80
		mov	eax, [ebp+0]
		push	eax		; lpMem
		call	off_1002D050
		mov	eax, [esp+34h+var_18]
		add	esp, 8
		pop	edi
		pop	esi
		mov	dword ptr [ebp+0], 0
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000BD0F:				; CODE XREF: sasl_server_new+12Cj
		push	esi
		mov	dword ptr [ebx+64h], offset sub_1000B080
		call	prop_new
		mov	edx, [edi+1134h]
		mov	[edx+60h], eax
		mov	eax, [edi+1134h]
		add	esp, 4
		cmp	[eax+60h], esi
		jz	short loc_1000BCDE
		mov	ecx, [ebp+0]
		mov	edx, [ecx+8]
		mov	[eax], edx
		mov	eax, [ebp+0]
		mov	eax, [eax+8]
		lea	edx, [eax+1]

loc_1000BD44:				; CODE XREF: sasl_server_new+199j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000BD44
		mov	ecx, [edi+1134h]
		sub	eax, edx
		mov	[ecx+18h], eax
		mov	eax, dword_1002F064
		cmp	eax, esi
		jz	short loc_1000BDAE
		cmp	byte ptr [eax],	0
		jz	short loc_1000BDAE
		push	0
		lea	esi, [edi+1120h]
		push	esi
		push	eax
		call	sub_10004910
		add	esp, 0Ch
		mov	[esp+2Ch+var_18], eax
		test	eax, eax
		jnz	loc_1000BCDE
		mov	eax, [esi]
		mov	edx, [edi+1134h]
		mov	[edx+4], eax
		mov	edx, [edi+1134h]
		mov	eax, [edx+4]
		lea	esi, [eax+1]
		lea	esp, [esp+0]

loc_1000BDA0:				; CODE XREF: sasl_server_new+1F5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000BDA0
		sub	eax, esi
		mov	[edx+1Ch], eax
		jmp	short loc_1000BDC6
; ---------------------------------------------------------------------------

loc_1000BDAE:				; CODE XREF: sasl_server_new+1ADj
					; sasl_server_new+1B2j
		mov	ecx, [edi+1134h]
		mov	[edi+1120h], esi
		mov	[ecx+4], esi
		mov	edx, [edi+1134h]
		mov	[edx+1Ch], esi

loc_1000BDC6:				; CODE XREF: sasl_server_new+1FCj
		mov	eax, [ebp+0]
		mov	edx, [eax+8E8h]
		mov	ecx, [edi+1134h]
		mov	[ecx+8], edx
		mov	eax, [ebp+0]
		mov	eax, [eax+8E8h]
		lea	edx, [eax+1]

loc_1000BDE4:				; CODE XREF: sasl_server_new+239j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000BDE4
		mov	ecx, [edi+1134h]
		mov	esi, [esp+2Ch+arg_8]
		sub	eax, edx
		mov	[ecx+20h], eax
		xor	eax, eax
		cmp	esi, eax
		jz	short loc_1000BE46
		push	eax
		lea	ebp, [edi+1124h]
		push	ebp
		push	esi
		call	sub_10004910
		mov	[esp+38h+var_18], eax
		mov	eax, esi
		add	esp, 0Ch
		lea	edx, [eax+1]
		lea	ebx, [ebx+0]

loc_1000BE20:				; CODE XREF: sasl_server_new+275j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000BE20
		sub	eax, edx
		mov	edx, [edi+1134h]
		mov	[edx+24h], eax
		mov	eax, [edi+1134h]
		mov	ecx, [ebp+0]
		mov	ebp, [esp+2Ch+arg_1C]
		mov	[eax+0Ch], ecx
		xor	eax, eax
		jmp	short loc_1000BE4C
; ---------------------------------------------------------------------------

loc_1000BE46:				; CODE XREF: sasl_server_new+24Ej
		mov	[edi+1124h], eax

loc_1000BE4C:				; CODE XREF: sasl_server_new+294j
		mov	edx, [edi+1134h]
		mov	ecx, [esp+2Ch+arg_14]
		mov	[edx+38h], ecx
		mov	ecx, [ebp+0]
		lea	edx, [esp+2Ch+var_14]
		push	edx
		mov	[esp+30h+var_8], eax
		mov	[esp+30h+var_C], eax
		lea	eax, [esp+30h+var_10]
		push	eax
		push	1
		push	ecx
		call	sub_10005310
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000BEC3
		push	eax
		lea	edx, [esp+30h+var_C]
		push	edx
		push	offset aLog_level ; "log_level"
		push	eax
		mov	eax, [esp+3Ch+var_14]
		push	eax
		call	[esp+40h+var_10]
		mov	edx, [esp+40h+var_14]
		push	0
		lea	ecx, [esp+44h+var_8]
		push	ecx
		push	offset aAuto_transitio ; "auto_transition"
		push	0
		push	edx
		call	[esp+54h+var_10]
		mov	ecx, [esp+54h+var_14]
		push	0
		lea	eax, [esp+58h+var_1C]
		push	eax
		push	offset aMech_list ; "mech_list"
		push	0
		push	ecx
		call	[esp+68h+var_10]
		add	esp, 3Ch

loc_1000BEC3:				; CODE XREF: sasl_server_new+2CBj
		mov	eax, [esp+2Ch+var_C]
		test	eax, eax
		jz	short loc_1000BED6
		push	eax
		call	sub_1001105F
		add	esp, 4
		jmp	short loc_1000BEDB
; ---------------------------------------------------------------------------

loc_1000BED6:				; CODE XREF: sasl_server_new+319j
		mov	eax, 1

loc_1000BEDB:				; CODE XREF: sasl_server_new+324j
		mov	edx, [edi+1134h]
		mov	[edx+30h], eax
		mov	eax, [edi+1134h]
		mov	[eax+34h], ebx
		mov	eax, [esp+2Ch+var_8]
		test	eax, eax
		jz	short loc_1000BF5E
		mov	cl, [eax]
		cmp	cl, 31h
		jz	short loc_1000BF3F
		cmp	cl, 79h
		jz	short loc_1000BF3F
		cmp	cl, 74h
		jz	short loc_1000BF3F
		cmp	cl, 6Fh
		jnz	short loc_1000BF11
		cmp	byte ptr [eax+1], 6Eh
		jz	short loc_1000BF3F

loc_1000BF11:				; CODE XREF: sasl_server_new+359j
		mov	ecx, offset aNoplain ; "noplain"

loc_1000BF16:				; CODE XREF: sasl_server_new+380j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_1000BF36
		test	dl, dl
		jz	short loc_1000BF32
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1000BF36
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_1000BF16

loc_1000BF32:				; CODE XREF: sasl_server_new+36Ej
		xor	eax, eax
		jmp	short loc_1000BF3B
; ---------------------------------------------------------------------------

loc_1000BF36:				; CODE XREF: sasl_server_new+36Aj
					; sasl_server_new+376j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_1000BF3B:				; CODE XREF: sasl_server_new+384j
		test	eax, eax
		jnz	short loc_1000BF5E

loc_1000BF3F:				; CODE XREF: sasl_server_new+34Aj
					; sasl_server_new+34Fj	...
		push	0
		push	0
		push	0
		call	sasl_auxprop_store
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000BF5E
		mov	ecx, [edi+1134h]
		mov	dword ptr [ecx+58h], offset sub_1000A4C0

loc_1000BF5E:				; CODE XREF: sasl_server_new+343j
					; sasl_server_new+38Dj	...
		mov	eax, [esp+2Ch+var_1C]
		test	eax, eax
		jz	loc_1000C0CF
		xor	ebx, ebx
		cmp	[eax], bl
		jz	loc_1000C056

loc_1000BF74:				; CODE XREF: sasl_server_new+517j
		mov	ebp, eax

loc_1000BF76:				; CODE XREF: sasl_server_new+3DBj
		movsx	edx, byte ptr [ebp+0]
		push	edx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000BF8D
		inc	ebp
		cmp	[ebp+0], al
		jnz	short loc_1000BF76

loc_1000BF8D:				; CODE XREF: sasl_server_new+3D5j
		mov	eax, dword_1002E5CC
		mov	esi, [eax+8]
		test	esi, esi
		jz	loc_1000C01C
		lea	ecx, [ecx+0]

loc_1000BFA0:				; CODE XREF: sasl_server_new+416j
		mov	eax, [esi+0Ch]
		mov	eax, [eax]
		lea	ecx, [esp+2Ch+var_4]
		push	ecx
		mov	ecx, [esp+30h+var_1C]
		mov	edx, ebp
		sub	edx, ecx
		push	edx
		push	eax
		push	ecx
		call	sub_10005BC0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000BFCA
		mov	esi, [esi+14h]
		test	esi, esi
		jnz	short loc_1000BFA0
		jmp	short loc_1000C01C
; ---------------------------------------------------------------------------

loc_1000BFCA:				; CODE XREF: sasl_server_new+40Fj
		push	18h
		call	off_1002D044
		add	esp, 4
		test	eax, eax
		jz	loc_1000BC68
		mov	ecx, [esi]
		mov	[eax], ecx
		mov	edx, [esi+4]
		mov	[eax+4], edx
		mov	ecx, [esi+8]
		mov	[eax+8], ecx
		mov	edx, [esi+0Ch]
		mov	[eax+0Ch], edx
		mov	ecx, [esi+10h]
		mov	[eax+10h], ecx
		mov	dword ptr [eax+14h], 0
		cmp	dword ptr [edi+113Ch], 0
		jnz	short loc_1000C011
		mov	[edi+113Ch], eax
		jmp	short loc_1000C014
; ---------------------------------------------------------------------------

loc_1000C011:				; CODE XREF: sasl_server_new+457j
		mov	[ebx+14h], eax

loc_1000C014:				; CODE XREF: sasl_server_new+45Fj
		inc	dword ptr [edi+1140h]
		mov	ebx, eax

loc_1000C01C:				; CODE XREF: sasl_server_new+3E7j
					; sasl_server_new+418j
		mov	eax, ebp
		mov	[esp+2Ch+var_1C], eax
		cmp	byte ptr [ebp+0], 0
		jz	loc_1000C0C4
		lea	esp, [esp+0]

loc_1000C030:				; CODE XREF: sasl_server_new+4A0j
		movsx	edx, byte ptr [eax]
		push	edx
		call	sub_1000E9CE
		add	esp, 4
		test	eax, eax
		mov	eax, [esp+2Ch+var_1C]
		jz	loc_1000C0C4
		inc	eax
		mov	[esp+2Ch+var_1C], eax
		cmp	byte ptr [eax],	0
		jnz	short loc_1000C030

loc_1000C052:				; CODE XREF: sasl_server_new+51Dj
		mov	ebp, [esp+2Ch+arg_1C]

loc_1000C056:				; CODE XREF: sasl_server_new+3BEj
					; sasl_server_new+536j
		cmp	[esp+2Ch+var_18], 0
		mov	eax, [edi+1134h]
		mov	dword ptr [eax+5Ch], offset sub_100027C0
		mov	eax, [edi+1134h]
		mov	ecx, [edi+8B8h]
		mov	[eax+3Ch], ecx
		mov	edx, [edi+8BCh]
		mov	[eax+40h], edx
		mov	ecx, [edi+8C0h]
		mov	[eax+44h], ecx
		mov	edx, [edi+8C4h]
		mov	[eax+48h], edx
		mov	ecx, [edi+8C8h]
		mov	[eax+4Ch], ecx
		mov	edx, [edi+8CCh]
		mov	ecx, [esp+2Ch+arg_18]
		mov	[eax+50h], edx
		mov	eax, [edi+1134h]
		mov	[eax+88h], ecx
		jnz	loc_1000BCE6
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_1000C0C4:				; CODE XREF: sasl_server_new+476j
					; sasl_server_new+492j
		cmp	byte ptr [eax],	0
		jnz	loc_1000BF74
		jmp	short loc_1000C052
; ---------------------------------------------------------------------------

loc_1000C0CF:				; CODE XREF: sasl_server_new+3B4j
		mov	eax, dword_1002E5CC
		mov	ecx, [eax+8]
		mov	[edi+113Ch], ecx
		mov	edx, [eax+0Ch]
		mov	[edi+1140h], edx
		jmp	loc_1000C056
sasl_server_new	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  60. sasl_server_start

; =============== S U B	R O U T	I N E =======================================


		public sasl_server_start
sasl_server_start proc near		; DATA XREF: .rdata:off_1002C568o

var_14		= dword	ptr -14h
hModule		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 14h
		cmp	dword_1002E5C8,	0
		mov	[esp+14h+var_C], 0
		jnz	short loc_1000C10D
		mov	eax, 0FFFFFFF4h
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000C10D:				; CODE XREF: sasl_server_start+12j
		push	esi
		mov	esi, [esp+18h+arg_0]
		test	esi, esi
		jnz	short loc_1000C11E
		lea	eax, [esi-7]
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000C11E:				; CODE XREF: sasl_server_start+24j
		push	ebx
		mov	ebx, [esp+1Ch+arg_4]
		test	ebx, ebx
		jz	loc_1000C484
		cmp	[esp+1Ch+arg_8], 0
		jnz	short loc_1000C13D
		cmp	[esp+1Ch+arg_C], 0
		ja	loc_1000C484

loc_1000C13D:				; CODE XREF: sasl_server_start+40j
		mov	eax, [esp+1Ch+arg_10]
		test	eax, eax
		jz	short loc_1000C14B
		mov	dword ptr [eax], 0

loc_1000C14B:				; CODE XREF: sasl_server_start+53j
		mov	eax, [esp+1Ch+arg_14]
		test	eax, eax
		jz	short loc_1000C159
		mov	dword ptr [eax], 0

loc_1000C159:				; CODE XREF: sasl_server_start+61j
		mov	eax, ebx
		push	ebp
		mov	ebp, [esi+113Ch]
		lea	edx, [eax+1]

loc_1000C165:				; CODE XREF: sasl_server_start+7Aj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000C165
		sub	eax, edx
		push	edi
		mov	edi, eax
		test	ebp, ebp
		jz	short loc_1000C195

loc_1000C175:				; CODE XREF: sasl_server_start+A3j
		mov	ecx, [ebp+0Ch]
		mov	edx, [ecx]
		lea	eax, [esp+24h+var_C]
		push	eax
		push	edi
		push	edx
		push	ebx
		call	sub_10005BC0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000C1B0
		mov	ebp, [ebp+14h]
		test	ebp, ebp
		jnz	short loc_1000C175

loc_1000C195:				; CODE XREF: sasl_server_start+83j
		push	ebx
		push	offset aCouldnTFindMec ; "Couldn't find mech %s"
		push	0
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	edi, 0FFFFFFFCh
		jmp	loc_1000C43C
; ---------------------------------------------------------------------------

loc_1000C1B0:				; CODE XREF: sasl_server_start+9Cj
		push	ebp
		call	sub_1000A600
		mov	edi, eax
		xor	ebx, ebx
		add	esp, 4
		cmp	edi, ebx
		jnz	loc_1000C432
		cmp	dword ptr [ebp+4], 1
		jnz	loc_1000C2E1
		mov	ecx, dword_1002F060
		lea	eax, [esp+24h+hModule]
		push	eax		; int
		push	ecx
		mov	[esp+2Ch+hModule], ebx
		call	sub_10005610
		mov	edx, [ebp+10h]
		add	esp, 4
		push	eax		; int
		push	edx		; lpLibFileName
		call	sub_1000C8E0
		add	esp, 0Ch
		cmp	eax, ebx
		jnz	loc_1000C330
		mov	ecx, [esp+24h+hModule]
		lea	eax, [esp+24h+var_8]
		push	eax		; int
		push	offset aSasl_server__1 ; "sasl_server_plug_init"
		push	ecx		; hModule
		call	sub_1000C830
		add	esp, 0Ch
		cmp	eax, ebx
		jnz	loc_1000C330
		lea	edx, [esp+24h+arg_0]
		push	edx
		mov	edx, dword_1002E5CC
		lea	eax, [esp+28h+var_14]
		push	eax
		mov	eax, [edx]
		lea	ecx, [esp+2Ch+var_4]
		push	ecx
		push	4
		push	eax
		call	[esp+38h+var_8]
		add	esp, 14h
		cmp	eax, ebx
		jnz	loc_1000C330
		cmp	ebx, [esp+24h+arg_0]
		jge	short loc_1000C278
		xor	edi, edi
		lea	esp, [esp+0]

loc_1000C250:				; CODE XREF: sasl_server_start+182j
		mov	ecx, [ebp+0Ch]
		mov	edx, [ecx]
		mov	eax, [esp+24h+var_14]
		mov	ecx, [edi+eax]
		push	edx
		push	ecx
		call	sub_10023E83
		add	esp, 8
		test	eax, eax
		jz	short loc_1000C274
		inc	ebx
		add	edi, 38h
		cmp	ebx, [esp+24h+arg_0]
		jl	short loc_1000C250

loc_1000C274:				; CODE XREF: sasl_server_start+178j
		cmp	ebx, [esp+24h+arg_0]

loc_1000C278:				; CODE XREF: sasl_server_start+158j
		jz	short loc_1000C2B6
		mov	ecx, [esp+24h+var_14]
		mov	eax, [ebp+0Ch]
		lea	edi, ds:0[ebx*8]
		sub	edi, ebx
		add	edi, edi
		add	edi, edi
		add	edi, edi
		mov	edx, [edi+ecx+4]
		cmp	edx, [eax+4]
		jnz	short loc_1000C2A2
		mov	edx, [edi+ecx+8]
		cmp	edx, [eax+8]
		jz	short loc_1000C2C9

loc_1000C2A2:				; CODE XREF: sasl_server_start+1A7j
		mov	eax, [edi+ecx]
		push	eax
		push	offset aSSecurityParam ; "%s: security parameters don't match mec"...
		push	1
		push	esi
		call	sub_10006F30
		add	esp, 10h

loc_1000C2B6:				; CODE XREF: sasl_server_start:loc_1000C278j
		pop	edi
		pop	ebp
		mov	eax, 0FFFFFFFCh
		pop	ebx
		mov	[esi+8F0h], eax
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000C2C9:				; CODE XREF: sasl_server_start+1B0j
		push	eax		; lpMem
		call	off_1002D050
		add	esp, 4
		add	edi, [esp+24h+var_14]
		mov	dword ptr [ebp+4], 0
		mov	[ebp+0Ch], edi

loc_1000C2E1:				; CODE XREF: sasl_server_start+D9j
		mov	eax, [esi+85Ch]
		lea	edi, [esi+85Ch]
		xor	ebx, ebx
		cmp	eax, ebx
		jz	short loc_1000C311
		mov	edx, [esi+1130h]
		mov	ecx, [edx+0Ch]
		mov	edx, [esi+1134h]
		mov	edx, [edx+34h]
		push	edx
		push	eax
		mov	eax, [ecx+1Ch]
		call	eax
		add	esp, 8
		mov	[edi], ebx

loc_1000C311:				; CODE XREF: sasl_server_start+201j
		mov	eax, [esi+1138h]
		lea	ecx, [esi+1138h]
		cmp	eax, ebx
		jz	short loc_1000C375

loc_1000C321:				; CODE XREF: sasl_server_start+23Cj
		cmp	[eax], ebp
		jz	short loc_1000C340
		lea	ecx, [eax+8]
		mov	eax, [ecx]
		cmp	eax, ebx
		jnz	short loc_1000C321
		jmp	short loc_1000C375
; ---------------------------------------------------------------------------

loc_1000C330:				; CODE XREF: sasl_server_start+106j
					; sasl_server_start+125j ...
		jge	short loc_1000C338
		mov	[esi+8F0h], eax

loc_1000C338:				; CODE XREF: sasl_server_start:loc_1000C330j
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000C340:				; CODE XREF: sasl_server_start+233j
		cmp	[eax+4], ebx
		jnz	short loc_1000C361
		push	offset aGotPastMech_pe ; "Got past mech_permitted with a disallow"...
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		pop	edi
		pop	ebp
		pop	ebx
		mov	eax, 0FFFFFFFCh
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000C361:				; CODE XREF: sasl_server_start+253j
		mov	edx, [eax+8]
		mov	[ecx], edx
		mov	ecx, [eax+4]
		push	eax		; lpMem
		mov	[edi], ecx
		call	off_1002D050
		add	esp, 4

loc_1000C375:				; CODE XREF: sasl_server_start+22Fj
					; sasl_server_start+23Ej
		mov	[esi+1130h], ebp
		cmp	[edi], ebx
		jnz	short loc_1000C3A2
		mov	ebp, [ebp+0Ch]
		mov	edx, [esi+1134h]
		mov	eax, [ebp+10h]
		mov	ecx, [ebp+14h]
		push	edi
		push	ebx
		push	ebx
		push	edx
		push	eax
		call	ecx
		mov	edi, eax
		add	esp, 14h
		cmp	edi, ebx
		jnz	loc_1000C432

loc_1000C3A2:				; CODE XREF: sasl_server_start+28Dj
		mov	eax, [esp+24h+arg_8]
		cmp	eax, ebx
		jz	short loc_1000C3E1
		mov	edx, [esi+1130h]
		mov	ecx, [edx+0Ch]
		test	byte ptr [ecx+0Ch], 10h
		jz	short loc_1000C3CF
		push	offset aRemoteSentFirs ; "Remote sent first but	mech does not all"...
		push	ebx
		push	esi
		call	sasl_seterror
		add	esp, 0Ch
		mov	edi, 0FFFFFFFBh
		jmp	short loc_1000C43C
; ---------------------------------------------------------------------------

loc_1000C3CF:				; CODE XREF: sasl_server_start+2C7j
		mov	edx, [esp+24h+arg_14]
		mov	ecx, [esp+24h+arg_10]
		push	edx
		mov	edx, [esp+28h+arg_C]
		push	ecx
		push	edx
		push	eax
		jmp	short loc_1000C423
; ---------------------------------------------------------------------------

loc_1000C3E1:				; CODE XREF: sasl_server_start+2B8j
		mov	eax, [esi+1130h]
		mov	ecx, [eax+0Ch]
		test	byte ptr [ecx+0Ch], 2
		mov	eax, [esp+24h+arg_10]
		jz	short loc_1000C417
		cmp	eax, ebx
		jz	short loc_1000C3FE
		mov	dword ptr [eax], offset	byte_1002762D

loc_1000C3FE:				; CODE XREF: sasl_server_start+306j
		mov	eax, [esp+24h+arg_14]
		cmp	eax, ebx
		jz	short loc_1000C408
		mov	[eax], ebx

loc_1000C408:				; CODE XREF: sasl_server_start+314j
		mov	edi, 1
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000C417:				; CODE XREF: sasl_server_start+302j
		mov	edx, [esp+24h+arg_14]
		mov	ecx, [esp+24h+arg_C]
		push	edx
		push	eax
		push	ecx
		push	ebx

loc_1000C423:				; CODE XREF: sasl_server_start+2EFj
		push	esi
		call	sasl_server_step
		mov	edi, eax
		add	esp, 14h
		cmp	edi, ebx
		jz	short loc_1000C47A

loc_1000C432:				; CODE XREF: sasl_server_start+CFj
					; sasl_server_start+2ACj
		cmp	edi, 1
		jz	short loc_1000C470
		cmp	edi, 2
		jz	short loc_1000C470

loc_1000C43C:				; CODE XREF: sasl_server_start+BBj
					; sasl_server_start+2DDj
		mov	eax, [esi+85Ch]
		xor	ebx, ebx
		cmp	eax, ebx
		jz	short loc_1000C46A
		mov	edx, [esi+1130h]
		mov	ecx, [edx+0Ch]
		mov	edx, [esi+1134h]
		mov	edx, [edx+34h]
		push	edx
		push	eax
		mov	eax, [ecx+1Ch]
		call	eax
		add	esp, 8
		mov	[esi+85Ch], ebx

loc_1000C46A:				; CODE XREF: sasl_server_start+356j
		mov	[esi+860h], ebx

loc_1000C470:				; CODE XREF: sasl_server_start+345j
					; sasl_server_start+34Aj
		cmp	edi, ebx
		jge	short loc_1000C47A
		mov	[esi+8F0h], edi

loc_1000C47A:				; CODE XREF: sasl_server_start+340j
					; sasl_server_start+382j
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000C484:				; CODE XREF: sasl_server_start+35j
					; sasl_server_start+47j
		push	573h
		push	offset aParameterErr_2 ; "Parameter error in server.c near line	%"...
		push	1
		push	esi
		call	sasl_seterror
		add	esp, 10h
		mov	eax, 0FFFFFFF9h
		pop	ebx
		mov	[esi+8F0h], eax
		pop	esi
		add	esp, 14h
		retn
sasl_server_start endp

; ---------------------------------------------------------------------------
		align 10h
		cmp	eax, 0FFFFFFECh
		jnz	short locret_1000C4BA
		mov	eax, 0FFFFFFF3h

locret_1000C4BA:			; CODE XREF: .text:1000C4B3j
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  65. sasl_seterror

; =============== S U B	R O U T	I N E =======================================


		public sasl_seterror
sasl_seterror	proc near		; CODE XREF: sasl_auxprop_request+20p
					; sub_10002440+1DCp ...

var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [esp+44h+arg_0]
		push	ebx
		xor	ebx, ebx
		push	ebp
		xor	ebp, ebp
		mov	[esp+4Ch+var_2C], eax
		mov	[esp+4Ch+var_44], ebx
		mov	[esp+4Ch+var_38], ebx
		cmp	eax, ebx
		jnz	short loc_1000C53E
		test	[esp+4Ch+arg_4], 1
		jnz	loc_1000C7A1
		lea	eax, [esp+4Ch+var_34]
		push	eax
		lea	ecx, [esp+50h+var_38]
		push	ecx
		push	2
		push	ebx
		call	sub_10005310
		add	esp, 10h
		cmp	eax, ebx
		jnz	loc_1000C7A1
		mov	eax, [esp+4Ch+var_38]
		cmp	eax, ebx
		jz	loc_1000C7A1
		mov	edx, [esp+4Ch+var_34]
		push	offset aNoSasl_conn_tP ; "No sasl_conn_t passed	to sasl_seterror"
		push	2
		push	edx
		call	eax
		add	esp, 0Ch
		pop	ebp
		pop	ebx
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_1000C53E:				; CODE XREF: sasl_seterror+26j
		push	esi
		mov	esi, [esp+50h+arg_8]
		cmp	esi, ebx
		jz	loc_1000C7A0
		lea	ecx, [esp+50h+var_3C]
		push	ecx
		lea	edx, [esp+54h+var_40]
		push	edx
		push	eax
		call	sub_100056C0
		mov	eax, esi
		add	esp, 0Ch
		lea	edx, [eax+1]

loc_1000C563:				; CODE XREF: sasl_seterror+A8j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_1000C563
		sub	eax, edx
		push	edi
		mov	[esp+54h+var_30], eax
		lea	edi, [esp+54h+arg_C]
		jz	loc_1000C753
		jmp	short loc_1000C580
; ---------------------------------------------------------------------------
		align 10h

loc_1000C580:				; CODE XREF: sasl_seterror+BBj
					; sasl_seterror+28Dj
		cmp	byte ptr [esi+ebp], 25h
		jz	short loc_1000C5C0
		mov	eax, [esp+54h+var_44]
		mov	ecx, [esp+54h+var_3C]
		mov	edx, [esp+54h+var_40]
		inc	eax
		push	eax
		push	ecx
		push	edx
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000C79F
		mov	eax, [esp+54h+var_40]
		mov	ecx, [eax]
		mov	dl, [esi+ebp]
		mov	eax, [esp+54h+var_44]
		mov	[eax+ecx], dl
		inc	[esp+54h+var_44]
		inc	ebp
		jmp	loc_1000C749
; ---------------------------------------------------------------------------

loc_1000C5C0:				; CODE XREF: sasl_seterror+C4j
		xor	ecx, ecx
		lea	esi, [ecx+1]
		mov	[esp+54h+var_28], 25h
		inc	ebp
		jmp	short loc_1000C5D0
; ---------------------------------------------------------------------------
		align 10h

loc_1000C5D0:				; CODE XREF: sasl_seterror+10Bj
					; sasl_seterror+27Fj
		mov	edx, [esp+54h+arg_8]
		mov	al, [edx+ebp]
		movsx	edx, al
		add	edx, 0FFFFFFDBh	; switch 86 cases
		cmp	edx, 55h
		ja	loc_1000C723	; jumptable 1000C5ED default case
		movzx	edx, ds:byte_1000C7D0[edx]
		jmp	ds:off_1000C7B4[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000C5F4:				; CODE XREF: sasl_seterror+12Dj
					; DATA XREF: .text:off_1000C7B4o
		mov	eax, [edi]	; jumptable 1000C5ED case 115
		add	edi, 4

loc_1000C5F9:				; CODE XREF: sasl_seterror+21Dj
		mov	edx, [esp+54h+var_3C]
		push	eax
		mov	eax, [esp+58h+var_40]
		lea	ecx, [esp+58h+var_44]
		push	ecx
		push	edx
		push	eax
		call	sub_10005DE0
		add	esp, 10h

loc_1000C611:				; CODE XREF: sasl_seterror+25Ej
		test	eax, eax
		jnz	loc_1000C79F
		jmp	loc_1000C731
; ---------------------------------------------------------------------------

loc_1000C61E:				; CODE XREF: sasl_seterror+12Dj
					; DATA XREF: .text:off_1000C7B4o
		mov	ecx, [esp+54h+var_44] ;	jumptable 1000C5ED case	37
		mov	edx, [esp+54h+var_3C]
		mov	eax, [esp+54h+var_40]
		inc	ecx
		push	ecx
		push	edx
		push	eax
		call	sub_10005640
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_1000C79F
		mov	ecx, [esp+54h+var_40]
		mov	edx, [ecx]
		mov	eax, [esp+54h+var_44]
		mov	ecx, 1
		mov	byte ptr [eax+edx], 25h
		add	[esp+54h+var_44], ecx
		jmp	loc_1000C736
; ---------------------------------------------------------------------------

loc_1000C65A:				; CODE XREF: sasl_seterror+12Dj
					; DATA XREF: .text:off_1000C7B4o
		mov	ecx, [edi]	; jumptable 1000C5ED case 109
		add	edi, 4
		push	ecx
		call	sub_1000FB67
		mov	ecx, [esp+58h+var_40]
		push	eax
		mov	eax, [esp+5Ch+var_3C]
		lea	edx, [esp+5Ch+var_44]
		push	edx
		push	eax
		push	ecx
		call	sub_10005DE0
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000C79F
		jmp	loc_1000C731
; ---------------------------------------------------------------------------

loc_1000C68A:				; CODE XREF: sasl_seterror+12Dj
					; DATA XREF: .text:off_1000C7B4o
		mov	eax, [edi]	; jumptable 1000C5ED case 122
		add	edi, 4
		cmp	eax, 0FFFFFFECh
		jnz	short loc_1000C699
		mov	eax, 0FFFFFFF3h

loc_1000C699:				; CODE XREF: sasl_seterror+1D2j
		push	ebx
		push	ebx
		push	eax
		call	sasl_errstring
		mov	ecx, [esp+60h+var_40]
		push	eax
		mov	eax, [esp+64h+var_3C]
		lea	edx, [esp+64h+var_44]
		push	edx
		push	eax
		push	ecx
		call	sub_10005DE0
		add	esp, 1Ch
		test	eax, eax
		jnz	loc_1000C79F
		jmp	short loc_1000C731
; ---------------------------------------------------------------------------

loc_1000C6C3:				; CODE XREF: sasl_seterror+12Dj
					; DATA XREF: .text:off_1000C7B4o
		mov	dl, [edi]	; jumptable 1000C5ED case 99
		mov	[esp+esi+54h+var_28], al
		inc	esi
		add	edi, 4
		mov	[esp+esi+54h+var_28], bl
		mov	[esp+54h+var_1C], dl
		mov	[esp+54h+var_1B], bl
		lea	eax, [esp+54h+var_1C]
		jmp	loc_1000C5F9
; ---------------------------------------------------------------------------

loc_1000C6E2:				; CODE XREF: sasl_seterror+12Dj
					; DATA XREF: .text:off_1000C7B4o
		mov	ecx, [edi]	; jumptable 1000C5ED cases 100,105
		add	edi, 4
		push	ecx
		lea	edx, [esp+58h+var_28]
		mov	[esp+esi+58h+var_28], al
		push	edx
		lea	eax, [esp+5Ch+var_1C]
		push	14h
		inc	esi
		push	eax
		mov	[esp+esi+64h+var_28], bl
		call	sub_1000FA78
		mov	eax, [esp+64h+var_3C]
		lea	ecx, [esp+64h+var_1C]
		push	ecx
		mov	ecx, [esp+68h+var_40]
		lea	edx, [esp+68h+var_44]
		push	edx
		push	eax
		push	ecx
		call	sub_10005DE0
		add	esp, 20h
		jmp	loc_1000C611
; ---------------------------------------------------------------------------

loc_1000C723:				; CODE XREF: sasl_seterror+120j
					; sasl_seterror+12Dj
					; DATA XREF: ...
		mov	[esp+esi+54h+var_28], al ; jumptable 1000C5ED default case
		inc	esi
		mov	[esp+esi+54h+var_28], bl
		cmp	esi, 9
		jle	short loc_1000C736

loc_1000C731:				; CODE XREF: sasl_seterror+159j
					; sasl_seterror+1C5j ...
		mov	ecx, 1

loc_1000C736:				; CODE XREF: sasl_seterror+195j
					; sasl_seterror+26Fj
		inc	ebp
		cmp	ebp, [esp+54h+var_30]
		ja	short loc_1000C745
		cmp	ecx, ebx
		jz	loc_1000C5D0

loc_1000C745:				; CODE XREF: sasl_seterror+27Bj
		mov	esi, [esp+54h+arg_8]

loc_1000C749:				; CODE XREF: sasl_seterror+FBj
		cmp	ebp, [esp+54h+var_30]
		jb	loc_1000C580

loc_1000C753:				; CODE XREF: sasl_seterror+B5j
		test	[esp+54h+arg_4], 1
		mov	edx, [esp+54h+var_40]
		mov	eax, [edx]
		mov	ecx, [esp+54h+var_44]
		mov	[ecx+eax], bl
		jnz	short loc_1000C79F
		mov	esi, [esp+54h+var_2C]
		lea	edx, [esp+54h+var_34]
		push	edx
		lea	eax, [esp+58h+var_38]
		push	eax
		push	2
		push	esi
		call	sub_10005310
		add	esp, 10h
		cmp	eax, ebx
		jnz	short loc_1000C79F
		mov	eax, [esp+54h+var_38]
		cmp	eax, ebx
		jz	short loc_1000C79F
		mov	ecx, [esi+8F4h]
		mov	edx, [esp+54h+var_34]
		push	ecx
		push	2
		push	edx
		call	eax
		add	esp, 0Ch

loc_1000C79F:				; CODE XREF: sasl_seterror+E0j
					; sasl_seterror+153j ...
		pop	edi

loc_1000C7A0:				; CODE XREF: sasl_seterror+85j
		pop	esi

loc_1000C7A1:				; CODE XREF: sasl_seterror+2Dj
					; sasl_seterror+4Aj ...
		mov	ecx, [esp+4Ch+var_4]
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
sasl_seterror	endp

; ---------------------------------------------------------------------------
		align 4
off_1000C7B4	dd offset loc_1000C61E,	offset loc_1000C6C3, offset loc_1000C6E2
					; DATA XREF: sasl_seterror+12Dr
		dd offset loc_1000C65A,	offset loc_1000C5F4, offset loc_1000C68A ; jump	table for switch statement
		dd offset loc_1000C723
byte_1000C7D0	db	0,     6,     6,     6 ; DATA XREF: sasl_seterror+126r
		db	6,     6,     6,     6 ; indirect table	for switch statement
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     6,     6
		db	6,     6,     1,     2
		db	6,     6,     6,     6
		db	2,     6,     6,     6
		db	3,     6,     6,     6
		db	6,     6,     4,     6
		db	6,     6,     6,     6
		db	6,     5
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000C830(HMODULE hModule, LPCSTR lpProcName, int)
sub_1000C830	proc near		; CODE XREF: sasl_server_start+11Bp
					; sub_1000C8A0+7p

hModule		= dword	ptr  4
lpProcName	= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+lpProcName]
		test	ecx, ecx
		jnz	short loc_1000C84E
		push	offset aNoEntrynameIn_ ; "no entryname in _sasl_locate_entry"
		push	1
		push	ecx
		call	sub_10006F30
		add	esp, 0Ch
		mov	eax, 0FFFFFFF9h
		retn
; ---------------------------------------------------------------------------

loc_1000C84E:				; CODE XREF: sub_1000C830+6j
		mov	eax, [esp+hModule]
		test	eax, eax
		jnz	short loc_1000C86C
		push	offset aNoLibraryIn_sa ; "no library in	_sasl_locate_entry"
		push	1
		push	eax
		call	sub_10006F30
		add	esp, 0Ch
		mov	eax, 0FFFFFFF9h
		retn
; ---------------------------------------------------------------------------

loc_1000C86C:				; CODE XREF: sub_1000C830+24j
		push	esi
		mov	esi, [esp+4+arg_8]
		test	esi, esi
		jnz	short loc_1000C88C
		push	offset aNoEntrypointOu ; "no entrypoint	output pointer in _sasl_l"...
		push	1
		push	esi
		call	sub_10006F30
		add	esp, 0Ch
		mov	eax, 0FFFFFFF9h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000C88C:				; CODE XREF: sub_1000C830+43j
		push	ecx		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	[esi], eax
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		pop	esi
		retn
sub_1000C830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_1000C8A0@<eax>(HMODULE hModule@<ecx>, int)
sub_1000C8A0	proc near		; CODE XREF: sub_1000C9A0+322p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		lea	eax, [esp+4+var_4]
		push	eax		; int
		push	edi		; lpProcName
		push	ecx		; hModule
		call	sub_1000C830
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C8DC
		mov	edx, [esp+4+var_4]
		push	esi
		push	edx
		push	ebx
		call	[esp+10h+arg_0]
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000C8DB
		push	ebx
		push	edi
		push	offset a_sasl_plugin_l ; "_sasl_plugin_load failed on %s for plug"...
		push	5
		push	0
		call	sub_10006F30
		add	esp, 14h
		mov	eax, esi

loc_1000C8DB:				; CODE XREF: sub_1000C8A0+24j
		pop	esi

loc_1000C8DC:				; CODE XREF: sub_1000C8A0+11j
		pop	ecx
		retn
sub_1000C8A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000C8E0(LPCSTR lpLibFileName, int, int)
sub_1000C8E0	proc near		; CODE XREF: sasl_server_start+FCp
					; sub_1000C9A0+2FBp

lpLibFileName	= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		push	edi
		mov	edi, [esp+4+lpLibFileName]
		push	0
		push	edi
		push	ecx
		call	edx
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000C95F
		push	esi
		push	8
		call	off_1002D044
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000C914
		lea	eax, [esi-2]
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000C914:				; CODE XREF: sub_1000C8E0+2Cj
		push	edi		; lpLibFileName
		call	ds:LoadLibraryA
		test	eax, eax
		jnz	short loc_1000C945
		call	ds:GetLastError
		push	eax
		push	edi
		push	offset aUnableToLoadli ; "unable to LoadLibrary	%s: %s"
		push	1
		push	0
		call	sub_10006F30
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 18h
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000C945:				; CODE XREF: sub_1000C8E0+3Dj
		mov	ecx, dword_1002E5D0
		mov	edx, [esp+8+arg_8]
		mov	[esi+4], eax
		mov	[esi], ecx
		mov	dword_1002E5D0,	esi
		mov	[edx], eax
		xor	eax, eax
		pop	esi

loc_1000C95F:				; CODE XREF: sub_1000C8E0+1Aj
		pop	edi
		retn
sub_1000C8E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C970	proc near		; CODE XREF: sub_1000C9A0:loc_1000CCDFp
		push	esi
		mov	esi, dword_1002E5D0
		mov	eax, [esi]
		mov	dword_1002E5D0,	eax
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_1000C98C
		push	eax		; hLibModule
		call	ds:FreeLibrary

loc_1000C98C:				; CODE XREF: sub_1000C970+13j
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 4
		pop	esi
		retn
sub_1000C970	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C9A0	proc near		; CODE XREF: sasl_client_init+F1p
					; sasl_server_init+18Cp

var_579		= byte ptr -579h
var_578		= dword	ptr -578h
var_574		= dword	ptr -574h
var_570		= dword	ptr -570h
hModule		= dword	ptr -56Ch
var_568		= dword	ptr -568h
var_564		= dword	ptr -564h
var_560		= dword	ptr -560h
hFindFile	= dword	ptr -55Ch
var_558		= byte ptr -558h
var_552		= dword	ptr -552h
var_534		= byte ptr -534h
var_524		= byte ptr -524h
var_520		= byte ptr -520h
var_41D		= byte ptr -41Dh
var_41C		= byte ptr -41Ch
var_314		= byte ptr -314h
LibFileName	= byte ptr -210h
var_108		= byte ptr -108h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 57Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+57Ch+var_4], eax
		mov	ecx, [esp+57Ch+arg_0]
		mov	edx, [esp+57Ch+arg_8]
		mov	eax, [esp+57Ch+arg_4]
		push	ebp
		xor	ebp, ebp
		mov	[esp+580h+var_568], ecx
		mov	[esp+580h+var_560], edx
		mov	[esp+580h+var_578], ebp
		cmp	ecx, ebp
		jz	loc_1000CD37
		cmp	eax, ebp
		jz	loc_1000CD37
		cmp	dword ptr [eax], 3
		jnz	loc_1000CD37
		mov	ecx, [eax+4]
		cmp	ecx, ebp
		jz	loc_1000CD37
		cmp	edx, ebp
		jz	loc_1000CD37
		cmp	dword ptr [edx], 4
		jnz	loc_1000CD37
		cmp	[edx+4], ebp
		jz	loc_1000CD37
		mov	eax, [eax+8]
		lea	edx, [esp+580h+var_578]
		push	edx
		push	eax
		call	ecx
		add	esp, 8
		cmp	eax, ebp
		jnz	short loc_1000CA64
		mov	edx, [esp+580h+var_578]
		cmp	edx, ebp
		jnz	short loc_1000CA49
		or	eax, 0FFFFFFFFh
		pop	ebp
		mov	ecx, [esp+57Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 57Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CA49:				; CODE XREF: sub_1000C9A0+8Ej
		mov	eax, edx
		push	esi
		lea	esi, [eax+1]
		nop

loc_1000CA50:				; CODE XREF: sub_1000C9A0+B5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CA50
		sub	eax, esi
		cmp	eax, 104h
		jb	short loc_1000CA7A
		or	eax, 0FFFFFFFFh
		pop	esi

loc_1000CA64:				; CODE XREF: sub_1000C9A0+86j
		pop	ebp
		mov	ecx, [esp+57Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 57Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CA7A:				; CODE XREF: sub_1000C9A0+BEj
		lea	ecx, [esp+584h+var_314]
		push	ebx
		dec	ecx
		push	edi
		mov	[esp+58Ch+var_564], ecx
		jmp	short loc_1000CA98
; ---------------------------------------------------------------------------
		align 10h

loc_1000CA90:				; CODE XREF: sub_1000C9A0+376j
		mov	edx, [esp+58Ch+var_578]
		mov	ecx, [esp+58Ch+var_564]

loc_1000CA98:				; CODE XREF: sub_1000C9A0+E8j
		xor	eax, eax
		lea	ebx, [ebx+0]

loc_1000CAA0:				; CODE XREF: sub_1000C9A0+117j
		mov	bl, [edx+ebp]
		mov	[esp+eax+58Ch+var_314],	bl
		inc	ebp
		inc	eax
		mov	[esp+58Ch+var_579], bl
		cmp	bl, 3Bh
		jz	short loc_1000CAB9
		test	bl, bl
		jnz	short loc_1000CAA0

loc_1000CAB9:				; CODE XREF: sub_1000C9A0+113j
		mov	byte ptr [ecx+eax], 0
		lea	ecx, [esp+58Ch+var_558]
		push	ecx
		lea	edx, [esp+590h+var_314]
		push	edx
		mov	[esp+594h+var_570], ebp
		call	sub_100257E9
		add	esp, 8
		test	eax, eax
		js	loc_1000CD0F
		test	[esp+58Ch+var_552], 4000h
		jz	loc_1000CD0F
		xor	eax, eax
		mov	edi, edi

loc_1000CAF0:				; CODE XREF: sub_1000C9A0+161j
		mov	cl, [esp+eax+58Ch+var_314]
		mov	[esp+eax+58Ch+var_41C],	cl
		inc	eax
		test	cl, cl
		jnz	short loc_1000CAF0
		lea	eax, [esp+58Ch+var_41C]
		lea	edx, [eax+1]
		lea	ecx, [ecx+0]

loc_1000CB10:				; CODE XREF: sub_1000C9A0+175j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CB10
		sub	eax, edx
		mov	ebx, eax
		cmp	[esp+ebx+58Ch+var_41D],	5Ch
		mov	[esp+58Ch+var_574], eax
		jz	short loc_1000CB47
		lea	edi, [esp+58Ch+var_41C]
		dec	edi

loc_1000CB31:				; CODE XREF: sub_1000C9A0+197j
		mov	al, [edi+1]
		inc	edi
		test	al, al
		jnz	short loc_1000CB31
		mov	ax, ds:word_100289B8
		inc	ebx
		mov	[edi], ax
		mov	[esp+58Ch+var_574], ebx

loc_1000CB47:				; CODE XREF: sub_1000C9A0+187j
		lea	ecx, [ebx+5]
		cmp	ecx, 105h
		jbe	short loc_1000CB68
		push	offset aPluginSearchMa ; "plugin search	mask is	too big"
		push	3
		push	0
		call	sub_10006F30
		add	esp, 0Ch
		jmp	loc_1000CD0B
; ---------------------------------------------------------------------------

loc_1000CB68:				; CODE XREF: sub_1000C9A0+1B0j
		lea	esi, [esp+ebx+58Ch+var_41C]
		lea	eax, [esi-1]

loc_1000CB72:				; CODE XREF: sub_1000C9A0+1D8j
		mov	cl, [eax+1]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CB72
		mov	edx, ds:dword_10028990
		mov	cx, ds:word_10028994
		mov	[eax], edx
		lea	edx, [esp+58Ch+var_534]
		mov	[eax+4], cx
		push	edx
		lea	eax, [esp+590h+var_41C]
		push	eax
		call	sub_10011389
		add	esp, 8
		mov	[esp+58Ch+hFindFile], eax
		cmp	eax, 0FFFFFFFFh
		jz	loc_1000CD0B
		mov	byte ptr [esi],	0

loc_1000CBB2:				; CODE XREF: sub_1000C9A0+35Cj
		lea	eax, [esp+58Ch+var_520]
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_1000CBC0:				; CODE XREF: sub_1000C9A0+225j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CBC0
		sub	eax, edx
		cmp	eax, 5
		jb	loc_1000CCE8
		lea	ecx, [eax+ebx]
		cmp	ecx, 104h
		jnb	loc_1000CCE8
		lea	edx, [esp+eax+58Ch+var_524]
		push	offset a_dll	; ".dll"
		push	edx
		call	sub_10023E83
		add	esp, 8
		test	eax, eax
		jnz	loc_1000CCE8
		test	[esp+58Ch+var_534], 10h
		jnz	loc_1000CCE8
		jmp	short loc_1000CC10
; ---------------------------------------------------------------------------
		align 10h

loc_1000CC10:				; CODE XREF: sub_1000C9A0+266j
					; sub_1000C9A0+281j
		mov	cl, [esp+eax+58Ch+var_41C]
		mov	[esp+eax+58Ch+LibFileName], cl
		inc	eax
		test	cl, cl
		jnz	short loc_1000CC10
		lea	eax, [esp+58Ch+var_520]
		mov	edx, eax
		lea	esp, [esp+0]

loc_1000CC30:				; CODE XREF: sub_1000C9A0+295j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CC30
		lea	edi, [esp+58Ch+LibFileName]
		sub	eax, edx
		dec	edi

loc_1000CC41:				; CODE XREF: sub_1000C9A0+2A7j
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1000CC41
		mov	ecx, eax
		shr	ecx, 2
		mov	esi, edx
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		xor	eax, eax
		jmp	short loc_1000CC60
; ---------------------------------------------------------------------------
		align 10h

loc_1000CC60:				; CODE XREF: sub_1000C9A0+2BBj
					; sub_1000C9A0+2CEj
		mov	cl, [esp+eax+58Ch+var_520]
		mov	[esp+eax+58Ch+var_108],	cl
		inc	eax
		test	cl, cl
		jnz	short loc_1000CC60
		lea	eax, [esp+58Ch+var_108]
		push	2Eh
		push	eax
		call	sub_100113A0
		add	esp, 8
		test	eax, eax
		jz	short loc_1000CC89
		mov	byte ptr [eax],	0

loc_1000CC89:				; CODE XREF: sub_1000C9A0+2E4j
		mov	edx, [esp+58Ch+var_560]
		lea	ecx, [esp+58Ch+hModule]
		push	ecx		; int
		push	edx		; int
		lea	eax, [esp+594h+LibFileName]
		push	eax		; lpLibFileName
		call	sub_1000C8E0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000CCE8
		mov	esi, [esp+58Ch+var_568]
		xor	ebp, ebp
		cmp	[esi], ebp
		jz	short loc_1000CCDF

loc_1000CCB1:				; CODE XREF: sub_1000C9A0+335j
		mov	ecx, [esi+4]
		mov	edi, [esi]
		push	ecx		; int
		mov	ecx, [esp+590h+hModule]	; hModule
		lea	ebx, [esp+590h+var_108]
		call	sub_1000C8A0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000CCCF
		inc	ebp

loc_1000CCCF:				; CODE XREF: sub_1000C9A0+32Cj
		add	esi, 8
		cmp	dword ptr [esi], 0
		jnz	short loc_1000CCB1
		mov	ebx, [esp+58Ch+var_574]
		test	ebp, ebp
		jnz	short loc_1000CCE4

loc_1000CCDF:				; CODE XREF: sub_1000C9A0+30Fj
		call	sub_1000C970

loc_1000CCE4:				; CODE XREF: sub_1000C9A0+33Dj
		mov	ebp, [esp+58Ch+var_570]

loc_1000CCE8:				; CODE XREF: sub_1000C9A0+22Cj
					; sub_1000C9A0+23Bj ...
		mov	esi, [esp+58Ch+hFindFile]
		lea	edx, [esp+58Ch+var_534]
		push	edx
		push	esi
		call	sub_10011394
		add	esp, 8
		test	eax, eax
		jz	loc_1000CBB2
		push	esi		; hFindFile
		call	sub_100110B0
		add	esp, 4

loc_1000CD0B:				; CODE XREF: sub_1000C9A0+1C3j
					; sub_1000C9A0+209j
		mov	bl, [esp+58Ch+var_579]

loc_1000CD0F:				; CODE XREF: sub_1000C9A0+138j
					; sub_1000C9A0+146j
		cmp	bl, 3Dh
		jz	short loc_1000CD1C
		test	bl, bl
		jnz	loc_1000CA90

loc_1000CD1C:				; CODE XREF: sub_1000C9A0+372j
		pop	edi
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+57Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 57Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CD37:				; CODE XREF: sub_1000C9A0+3Aj
					; sub_1000C9A0+42j ...
		mov	ecx, [esp+580h+var_4]
		pop	ebp
		xor	ecx, esp
		mov	eax, 0FFFFFFF9h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 57Ch
		retn
sub_1000C9A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000CD60	proc near		; CODE XREF: sub_10006260+3Bp
		push	esi
		mov	esi, dword_1002E5D0
		test	esi, esi
		jz	short loc_1000CD91
		push	ebp
		mov	ebp, ds:FreeLibrary
		push	edi

loc_1000CD73:				; CODE XREF: sub_1000CD60+2Dj
		mov	eax, [esi+4]
		mov	edi, [esi]
		test	eax, eax
		jz	short loc_1000CD7F
		push	eax		; hLibModule
		call	ebp ; FreeLibrary

loc_1000CD7F:				; CODE XREF: sub_1000CD60+1Aj
		push	esi		; lpMem
		call	off_1002D050
		add	esp, 4
		mov	esi, edi
		test	edi, edi
		jnz	short loc_1000CD73
		pop	edi
		pop	ebp

loc_1000CD91:				; CODE XREF: sub_1000CD60+9j
		xor	eax, eax
		mov	dword_1002E5D0,	eax
		pop	esi
		retn
sub_1000CD60	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   4. getsubopt

; =============== S U B	R O U T	I N E =======================================


		public getsubopt
getsubopt	proc near		; DATA XREF: .rdata:off_1002C568o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_8]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	dword ptr [edx], 0
		mov	dword_1002F05C,	0
		test	esi, esi
		jz	short loc_1000CDF5
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1000CDF5
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_1000CDF3
		lea	esp, [esp+0]

loc_1000CDD0:				; CODE XREF: getsubopt+45j
		cmp	cl, 2Ch
		jz	short loc_1000CDDF
		cmp	cl, 20h
		jz	short loc_1000CDDF
		cmp	cl, 9
		jnz	short loc_1000CDEE

loc_1000CDDF:				; CODE XREF: getsubopt+33j
					; getsubopt+38j
		mov	cl, [eax+1]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CDD0
		mov	[esi], eax
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000CDEE:				; CODE XREF: getsubopt+3Dj
		cmp	byte ptr [eax],	0
		jnz	short loc_1000CDFA

loc_1000CDF3:				; CODE XREF: getsubopt+27j
		mov	[esi], eax

loc_1000CDF5:				; CODE XREF: getsubopt+1Bj
					; getsubopt+21j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000CDFA:				; CODE XREF: getsubopt+51j
		mov	dword_1002F05C,	eax
		nop

loc_1000CE00:				; CODE XREF: getsubopt+7Aj
		mov	cl, [eax+1]
		inc	eax
		test	cl, cl
		jz	short loc_1000CE6F
		cmp	cl, 2Ch
		jz	short loc_1000CE1C
		cmp	cl, 3Dh
		jz	short loc_1000CE1C
		cmp	cl, 20h
		jz	short loc_1000CE1C
		cmp	cl, 9
		jnz	short loc_1000CE00

loc_1000CE1C:				; CODE XREF: getsubopt+6Bj
					; getsubopt+70j ...
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_1000CE6F
		mov	byte ptr [eax],	0
		inc	eax
		cmp	cl, 3Dh
		jnz	short loc_1000CE52
		mov	[edx], eax
		cmp	byte ptr [eax],	0
		jz	short loc_1000CE52

loc_1000CE32:				; CODE XREF: getsubopt+A7j
		mov	cl, [eax]
		cmp	cl, 2Ch
		jz	short loc_1000CE49
		cmp	cl, 20h
		jz	short loc_1000CE49
		cmp	cl, 9
		jz	short loc_1000CE49
		inc	eax
		cmp	byte ptr [eax],	0
		jnz	short loc_1000CE32

loc_1000CE49:				; CODE XREF: getsubopt+97j
					; getsubopt+9Cj ...
		cmp	byte ptr [eax],	0
		jz	short loc_1000CE52
		mov	byte ptr [eax],	0
		inc	eax

loc_1000CE52:				; CODE XREF: getsubopt+89j
					; getsubopt+90j ...
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_1000CE6F

loc_1000CE58:				; CODE XREF: getsubopt+CDj
		cmp	cl, 2Ch
		jz	short loc_1000CE67
		cmp	cl, 20h
		jz	short loc_1000CE67
		cmp	cl, 9
		jnz	short loc_1000CE6F

loc_1000CE67:				; CODE XREF: getsubopt+BBj
					; getsubopt+C0j
		mov	cl, [eax+1]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CE58

loc_1000CE6F:				; CODE XREF: getsubopt+66j
					; getsubopt+80j ...
		mov	[esi], eax
		mov	esi, [esp+4+arg_4]
		mov	edx, [esi]
		push	ebx
		xor	eax, eax
		push	edi
		test	edx, edx
		jz	short loc_1000CEBB
		mov	edi, dword_1002F05C

loc_1000CE85:				; CODE XREF: getsubopt+119j
		mov	ecx, edi

loc_1000CE87:				; CODE XREF: getsubopt+101j
		mov	bl, [ecx]
		cmp	bl, [edx]
		jnz	short loc_1000CEA7
		test	bl, bl
		jz	short loc_1000CEA3
		mov	bl, [ecx+1]
		cmp	bl, [edx+1]
		jnz	short loc_1000CEA7
		add	ecx, 2
		add	edx, 2
		test	bl, bl
		jnz	short loc_1000CE87

loc_1000CEA3:				; CODE XREF: getsubopt+EFj
		xor	ecx, ecx
		jmp	short loc_1000CEAC
; ---------------------------------------------------------------------------

loc_1000CEA7:				; CODE XREF: getsubopt+EBj
					; getsubopt+F7j
		sbb	ecx, ecx
		sbb	ecx, 0FFFFFFFFh

loc_1000CEAC:				; CODE XREF: getsubopt+105j
		test	ecx, ecx
		jz	short loc_1000CEBE
		mov	edx, [esi+4]
		add	esi, 4
		inc	eax
		test	edx, edx
		jnz	short loc_1000CE85

loc_1000CEBB:				; CODE XREF: getsubopt+DDj
		or	eax, 0FFFFFFFFh

loc_1000CEBE:				; CODE XREF: getsubopt+10Ej
		pop	edi
		pop	ebx
		pop	esi
		retn
getsubopt	endp

; ---------------------------------------------------------------------------
		align 10h
		retn
; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 4B0h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4ACh], eax
		mov	eax, [esp+4BCh]
		push	ebp
		mov	ebp, [esp+4B8h]
		push	edi
		mov	edi, [esp+4C0h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		test	ebp, ebp
		jz	loc_1000D0CD
		test	edi, edi
		jz	loc_1000D0B5
		test	eax, eax
		jz	loc_1000D0B5
		mov	al, [edi]
		xor	edx, edx
		push	esi
		test	al, al
		jz	short loc_1000CF5F
		lea	esi, [esp+0B4h]
		mov	ecx, edi
		sub	esi, edi

loc_1000CF43:				; CODE XREF: .text:1000CF5Dj
		cmp	al, 3Bh
		jz	short loc_1000CF5F
		cmp	edx, 401h
		jge	loc_1000D01C
		mov	[esi+ecx], al
		mov	al, [ecx+1]
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_1000CF43

loc_1000CF5F:				; CODE XREF: .text:1000CF36j
					; .text:1000CF45j
		cmp	byte ptr [edi+edx], 3Bh
		mov	byte ptr [esp+edx+0B4h], 0
		jnz	short loc_1000CF6E
		inc	edx

loc_1000CF6E:				; CODE XREF: .text:1000CF6Bj
		add	edi, edx
		cmp	byte ptr [edi],	0
		jz	short loc_1000CF91
		mov	esi, edi

loc_1000CF77:				; CODE XREF: .text:1000CF8Fj
		movsx	edx, byte ptr [esi]
		push	edx
		call	sub_1000E8B7
		add	esp, 4
		test	eax, eax
		jz	loc_1000D023
		inc	esi
		cmp	byte ptr [esi],	0
		jnz	short loc_1000CF77

loc_1000CF91:				; CODE XREF: .text:1000CF73j
		xor	eax, eax
		mov	[esp+18h], eax
		mov	[esp+14h], eax
		mov	[esp+1Ch], eax
		lea	edx, [esp+0Ch]
		push	edx
		mov	[esp+24h], eax
		mov	[esp+28h], eax
		mov	[esp+2Ch], eax
		mov	[esp+30h], eax
		mov	[esp+34h], eax
		mov	[esp+1Ch], eax
		lea	eax, [esp+18h]
		push	eax
		push	edi
		lea	ecx, [esp+0C0h]
		push	ecx
		mov	dword ptr [esp+2Ch], 1
		mov	dword ptr [esp+24h], 5
		call	ds:getaddrinfo
		test	eax, eax
		jz	short loc_1000D03D
		mov	edx, [ebp+4]
		mov	eax, [ebp+84h]
		push	97h
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	0
		push	edx
		call	eax

loc_1000CFFC:				; CODE XREF: .text:1000D03Bj
		mov	eax, 0FFFFFFF9h

loc_1000D001:				; CODE XREF: .text:1000D083j
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		mov	ecx, [esp+4ACh]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4B0h
		retn
; ---------------------------------------------------------------------------

loc_1000D01C:				; CODE XREF: .text:1000CF4Dj
		push	81h
		jmp	short loc_1000D028
; ---------------------------------------------------------------------------

loc_1000D023:				; CODE XREF: .text:1000CF85j
		push	8Dh

loc_1000D028:				; CODE XREF: .text:1000D021j
		mov	eax, [ebp+4]
		mov	ecx, [ebp+84h]
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	0
		push	eax
		call	ecx
		jmp	short loc_1000CFFC
; ---------------------------------------------------------------------------

loc_1000D03D:				; CODE XREF: .text:1000CFE2j
		mov	edi, [esp+0Ch]
		mov	esi, [edi+10h]
		mov	ecx, [edi+18h]
		push	esi
		push	ecx
		lea	edx, [esp+3Ch]
		push	edx
		call	sub_1000E2B0
		add	esp, 0Ch
		push	edi
		call	ds:freeaddrinfo
		cmp	[esp+4CCh], esi
		jge	short loc_1000D088
		mov	eax, [ebp+4]
		mov	ecx, [ebp+84h]
		push	0A0h
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	0
		push	eax
		call	ecx
		mov	eax, 0FFFFFFFDh
		jmp	loc_1000D001
; ---------------------------------------------------------------------------

loc_1000D088:				; CODE XREF: .text:1000D064j
		mov	eax, [esp+10h]
		push	esi
		lea	edx, [esp+38h]
		push	edx
		push	eax
		call	sub_1000E2B0
		add	esp, 0Ch
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+4ACh]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4B0h
		retn
; ---------------------------------------------------------------------------

loc_1000D0B5:				; CODE XREF: .text:1000CF21j
					; .text:1000CF29j
		mov	ecx, [ebp+4]
		mov	edx, [ebp+84h]
		push	7Ah
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	0
		push	ecx
		call	edx
		add	esp, 10h

loc_1000D0CD:				; CODE XREF: .text:1000CF19j
		mov	ecx, [esp+4B4h]
		pop	edi
		pop	ebp
		xor	ecx, esp
		mov	eax, 0FFFFFFF9h
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4B0h
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D0F0	proc near		; CODE XREF: .text:1000D9BEp
					; .text:1000DFEAp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		test	edi, edi
		jz	loc_1000D19C
		mov	ebx, [esp+0Ch+arg_4]
		test	ebx, ebx
		jz	loc_1000D19C
		mov	ebp, [esp+0Ch+arg_8]
		test	ebp, ebp
		jz	loc_1000D19C
		mov	edx, [ebx]
		push	esi
		test	edx, edx
		jnz	short loc_1000D138
		mov	esi, [esp+10h+arg_C]
		mov	eax, [edi+14h]
		push	esi
		call	eax
		add	esp, 4
		mov	[ebx], eax
		test	eax, eax
		jnz	short loc_1000D192
		push	0E4h
		jmp	short loc_1000D16B
; ---------------------------------------------------------------------------

loc_1000D138:				; CODE XREF: sub_1000D0F0+2Cj
		mov	ecx, [ebp+0]
		mov	eax, [esp+10h+arg_C]
		cmp	ecx, eax
		jnb	short loc_1000D195
		lea	esi, [ecx+ecx]
		cmp	esi, eax
		jnb	short loc_1000D156
		lea	ebx, [ebx+0]

loc_1000D150:				; CODE XREF: sub_1000D0F0+64j
		add	esi, esi
		cmp	esi, eax
		jb	short loc_1000D150

loc_1000D156:				; CODE XREF: sub_1000D0F0+58j
		mov	eax, [edi+1Ch]
		push	esi
		push	edx
		call	eax
		add	esp, 8
		mov	[ebx], eax
		test	eax, eax
		jnz	short loc_1000D192
		push	0F1h

loc_1000D16B:				; CODE XREF: sub_1000D0F0+46j
		push	offset aOutOfMemoryInP ; "Out of Memory	in plugin_common.c near	l"...
		mov	dword ptr [ebp+0], 0
		mov	ecx, [edi+4]
		mov	edx, [edi+84h]
		push	0
		push	ecx
		call	edx
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D192:				; CODE XREF: sub_1000D0F0+3Fj
					; sub_1000D0F0+74j
		mov	[ebp+0], esi

loc_1000D195:				; CODE XREF: sub_1000D0F0+51j
		pop	esi
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D19C:				; CODE XREF: sub_1000D0F0+9j
					; sub_1000D0F0+15j ...
		mov	eax, [edi+4]
		mov	ecx, [edi+84h]
		push	0DCh
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	0
		push	eax
		call	ecx
		add	esp, 10h
		pop	edi
		pop	ebp
		mov	eax, 0FFFFFFF9h
		pop	ebx
		retn
sub_1000D0F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D1C0	proc near		; CODE XREF: .text:1000DAD4p
					; .text:1000DAEAp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	eax, ebp
		push	edi
		lea	edx, [eax+1]
		lea	ecx, [ecx+0]

loc_1000D1D0:				; CODE XREF: sub_1000D1C0+15j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000D1D0
		mov	esi, [esp+10h+arg_0]
		sub	eax, edx
		mov	ebx, eax
		test	esi, esi
		jz	loc_1000D266
		test	ebp, ebp
		jz	short loc_1000D24B
		mov	edi, [esp+10h+arg_8]
		test	edi, edi
		jz	short loc_1000D24B
		mov	ecx, [esi+14h]
		lea	eax, [ebx+1]
		push	eax
		call	ecx
		add	esp, 4
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_1000D229
		mov	edx, [esi+4]
		push	107h
		push	offset aOutOfMemoryInP ; "Out of Memory	in plugin_common.c near	l"...
		push	eax
		mov	eax, [esi+84h]
		push	edx
		call	eax
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D229:				; CODE XREF: sub_1000D1C0+43j
		mov	ecx, ebp
		mov	edx, eax
		lea	ecx, [ecx+0]

loc_1000D230:				; CODE XREF: sub_1000D1C0+78j
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_1000D230
		mov	eax, [esp+10h+arg_C]
		test	eax, eax
		jz	short loc_1000D244
		mov	[eax], ebx

loc_1000D244:				; CODE XREF: sub_1000D1C0+80j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D24B:				; CODE XREF: sub_1000D1C0+29j
					; sub_1000D1C0+31j
		mov	ecx, [esi+4]
		mov	edx, [esi+84h]
		push	101h
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	0
		push	ecx
		call	edx
		add	esp, 10h

loc_1000D266:				; CODE XREF: sub_1000D1C0+21j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFF9h
		pop	ebx
		retn
sub_1000D1C0	endp

; ---------------------------------------------------------------------------
		push	edi
		mov	edi, [esp+8]
		test	edi, edi
		jz	short loc_1000D2B3
		push	esi
		mov	esi, [esp+10h]
		test	esi, esi
		jz	short loc_1000D2B2
		mov	ecx, [esi]
		test	ecx, ecx
		jz	short loc_1000D2B2
		mov	eax, ecx
		push	ebx
		lea	ebx, [eax+1]
		mov	edi, edi

loc_1000D290:				; CODE XREF: .text:1000D295j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000D290
		sub	eax, ebx
		push	eax
		mov	eax, [edi+70h]
		push	ecx
		call	eax
		mov	ecx, [esi]
		mov	edx, [edi+20h]
		push	ecx
		call	edx
		add	esp, 0Ch
		mov	dword ptr [esi], 0
		pop	ebx

loc_1000D2B2:				; CODE XREF: .text:1000D280j
					; .text:1000D286j
		pop	esi

loc_1000D2B3:				; CODE XREF: .text:1000D277j
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	edi
		mov	edi, [esp+8]
		test	edi, edi
		jz	short loc_1000D2F6
		push	esi
		mov	esi, [esp+10h]
		test	esi, esi
		jz	short loc_1000D2F5
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1000D2F5
		mov	ecx, [eax]
		mov	edx, [edi+70h]
		push	ecx
		add	eax, 4
		push	eax
		call	edx
		mov	eax, [esi]
		mov	ecx, [edi+20h]
		push	eax
		call	ecx
		add	esp, 0Ch
		mov	dword ptr [esi], 0

loc_1000D2F5:				; CODE XREF: .text:1000D2D0j
					; .text:1000D2D6j
		pop	esi

loc_1000D2F6:				; CODE XREF: .text:1000D2C7j
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+4]
		test	eax, eax
		jz	short loc_1000D326
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_1000D326
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000D326
		mov	edx, [esp+8]

loc_1000D318:				; CODE XREF: .text:1000D324j
		cmp	ecx, edx
		jz	short locret_1000D328
		mov	ecx, [eax+18h]
		add	eax, 18h
		test	ecx, ecx
		jnz	short loc_1000D318

loc_1000D326:				; CODE XREF: .text:1000D306j
					; .text:1000D30Cj ...
		xor	eax, eax

locret_1000D328:			; CODE XREF: .text:1000D31Aj
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D330	proc near		; CODE XREF: sub_10007E30+8Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_10]
		push	ebx
		mov	ebx, [esp+4+arg_C]
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	dword ptr [ebx], 0
		test	eax, eax
		jz	short loc_1000D362
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000D362
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_1000D362

loc_1000D354:				; CODE XREF: sub_1000D330+30j
		cmp	eax, edi
		jz	short loc_1000D394
		mov	eax, [ecx+18h]
		add	ecx, 18h
		test	eax, eax
		jnz	short loc_1000D354

loc_1000D362:				; CODE XREF: sub_1000D330+16j
					; sub_1000D330+1Cj ...
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi+4]
		lea	ecx, [esp+0Ch+arg_10]
		push	ecx
		mov	ecx, [esi+7Ch]
		lea	edx, [esp+10h+arg_C]
		push	edx
		push	edi
		push	eax
		call	ecx
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000D3CD
		cmp	[esp+0Ch+arg_8], 0
		jnz	loc_1000D413
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D394:				; CODE XREF: sub_1000D330+26j
		cmp	[esp+8+arg_8], 0
		jz	short loc_1000D3C3
		cmp	dword ptr [ecx+10h], 0
		jnz	short loc_1000D3C3
		mov	eax, [esp+8+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [eax+84h]
		push	offset aUnexpectedlyMi ; "Unexpectedly missing a prompt	result"
		push	0
		push	ecx
		call	edx
		add	esp, 0Ch
		pop	edi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D3C3:				; CODE XREF: sub_1000D330+69j
					; sub_1000D330+6Fj
		mov	eax, [ecx+10h]
		mov	[ebx], eax
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D3CD:				; CODE XREF: sub_1000D330+51j
		test	eax, eax
		jnz	short loc_1000D413
		mov	ecx, [esp+0Ch+arg_C]
		test	ecx, ecx
		jz	short loc_1000D413
		mov	edx, [esp+0Ch+arg_10]
		push	eax
		push	ebx
		push	edi
		push	edx
		call	ecx
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000D413
		cmp	[esp+0Ch+arg_8], eax
		jz	short loc_1000D413
		cmp	[ebx], eax
		jnz	short loc_1000D413
		mov	ecx, [esi+84h]
		push	165h
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	eax
		mov	eax, [esi+4]
		push	eax
		call	ecx
		add	esp, 10h
		mov	eax, 0FFFFFFF9h

loc_1000D413:				; CODE XREF: sub_1000D330+58j
					; sub_1000D330+9Fj ...
		pop	esi
		pop	edi
		pop	ebx
		retn
sub_1000D330	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+10h]
		push	ebp
		mov	ebp, [esp+10h]
		push	esi
		push	edi
		mov	edi, [esp+14h]
		mov	dword ptr [edi], 0
		mov	dword ptr [ebp+0], 0
		test	eax, eax
		jz	short loc_1000D465
		mov	esi, [eax]
		test	esi, esi
		jz	short loc_1000D465
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1000D465
		lea	esp, [esp+0]

loc_1000D450:				; CODE XREF: .text:1000D463j
		cmp	eax, 4004h
		jz	loc_1000D4DF
		mov	eax, [esi+18h]
		add	esi, 18h
		test	eax, eax
		jnz	short loc_1000D450

loc_1000D465:				; CODE XREF: .text:1000D43Ej
					; .text:1000D444j ...
		mov	esi, [esp+10h]
		mov	edx, [esi+4]
		lea	eax, [esp+18h]
		push	eax
		mov	eax, [esi+7Ch]
		lea	ecx, [esp+18h]
		push	ecx
		push	4004h
		push	edx
		call	eax
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000D542
		mov	ecx, [esp+14h]
		test	ecx, ecx
		jz	loc_1000D542
		mov	edx, [esp+18h]
		mov	eax, [esi+4]
		push	edi
		push	4004h
		push	edx
		push	eax
		call	ecx
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000D542
		cmp	[edi], eax
		jnz	loc_1000D542
		mov	ecx, [esi+4]
		mov	edx, [esi+84h]
		push	1A0h
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	eax
		push	ecx
		call	edx
		add	esp, 10h
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000D4DF:				; CODE XREF: .text:1000D455j
		cmp	dword ptr [esi+10h], 0
		jnz	short loc_1000D508
		mov	eax, [esp+10h]
		mov	ecx, [eax+4]
		mov	edx, [eax+84h]
		push	offset aUnexpectedlyMi ; "Unexpectedly missing a prompt	result"
		push	0
		push	ecx
		call	edx
		add	esp, 0Ch
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000D508:				; CODE XREF: .text:1000D4E3j
		mov	eax, [esi+14h]
		push	ebx
		mov	ebx, [esp+14h]
		mov	ecx, [ebx+14h]
		add	eax, 9
		push	eax
		call	ecx
		add	esp, 4
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_1000D546
		mov	edx, [ebx+4]
		push	189h
		push	offset aOutOfMemoryInP ; "Out of Memory	in plugin_common.c near	l"...
		push	eax
		mov	eax, [ebx+84h]
		push	edx
		call	eax
		add	esp, 10h
		mov	eax, 0FFFFFFFEh
		pop	ebx

loc_1000D542:				; CODE XREF: .text:1000D486j
					; .text:1000D492j ...
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000D546:				; CODE XREF: .text:1000D520j
		mov	ecx, [esi+14h]
		mov	[eax], ecx
		mov	edx, [esi+14h]
		mov	eax, [esi+10h]
		mov	ecx, [edi]
		push	edx
		push	eax
		add	ecx, 4
		push	ecx
		call	sub_1000E2B0
		mov	eax, [edi]
		mov	edx, [eax]
		add	esp, 0Ch
		pop	ebx
		pop	edi
		mov	byte ptr [edx+eax+4], 0
		pop	esi
		mov	dword ptr [ebp+0], 1
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+18h]
		push	ebx
		mov	ebx, [esp+18h]
		push	edi
		mov	edi, [esp+10h]
		mov	dword ptr [ebx], 0
		test	eax, eax
		jz	short loc_1000D5B2
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000D5B2
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_1000D5B2

loc_1000D5A4:				; CODE XREF: .text:1000D5B0j
		cmp	eax, edi
		jz	short loc_1000D61D
		mov	eax, [ecx+18h]
		add	ecx, 18h
		test	eax, eax
		jnz	short loc_1000D5A4

loc_1000D5B2:				; CODE XREF: .text:1000D596j
					; .text:1000D59Cj ...
		push	esi
		mov	esi, [esp+10h]
		mov	edx, [esi+4]
		lea	eax, [esp+24h]
		push	eax
		mov	eax, [esi+7Ch]
		lea	ecx, [esp+24h]
		push	ecx
		push	edi
		push	edx
		call	eax
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000D619
		mov	ecx, [esp+20h]
		test	ecx, ecx
		jz	short loc_1000D619
		mov	edx, [esp+1Ch]
		push	eax
		push	ebx
		push	eax
		mov	eax, [esp+24h]
		push	edx
		mov	edx, [esp+34h]
		push	eax
		push	edi
		push	edx
		call	ecx
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_1000D619
		cmp	[ebx], eax
		jnz	short loc_1000D619
		mov	ecx, [esi+84h]
		push	1CFh
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	eax
		mov	eax, [esi+4]
		push	eax
		call	ecx
		add	esp, 10h
		mov	eax, 0FFFFFFF9h

loc_1000D619:				; CODE XREF: .text:1000D5D0j
					; .text:1000D5D8j ...
		pop	esi
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D61D:				; CODE XREF: .text:1000D5A6j
		mov	ecx, [ecx+10h]
		test	ecx, ecx
		jnz	short loc_1000D645
		mov	eax, [esp+0Ch]
		mov	edx, [eax+84h]
		push	offset aUnexpectedlyMi ; "Unexpectedly missing a prompt	result"
		push	ecx
		mov	ecx, [eax+4]
		push	ecx
		call	edx
		add	esp, 0Ch
		pop	edi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D645:				; CODE XREF: .text:1000D622j
		pop	edi
		mov	[ebx], ecx
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+10h]
		push	edi
		mov	edi, [esp+10h]
		mov	dword ptr [edi], 0
		test	eax, eax
		jz	short loc_1000D681
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000D681
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_1000D681
		nop

loc_1000D670:				; CODE XREF: .text:1000D67Fj
		cmp	eax, 4008h
		jz	short loc_1000D6EC
		mov	eax, [ecx+18h]
		add	ecx, 18h
		test	eax, eax
		jnz	short loc_1000D670

loc_1000D681:				; CODE XREF: .text:1000D661j
					; .text:1000D667j ...
		push	esi
		mov	esi, [esp+0Ch]
		mov	edx, [esi+4]
		lea	eax, [esp+18h]
		push	eax
		mov	eax, [esi+7Ch]
		lea	ecx, [esp+18h]
		push	ecx
		push	4008h
		push	edx
		call	eax
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000D6E9
		mov	ecx, [esp+14h]
		test	ecx, ecx
		jz	short loc_1000D6E9
		mov	edx, [esp+10h]
		mov	eax, [esp+18h]
		push	edi
		push	edx
		push	4008h
		push	eax
		call	ecx
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000D6E9
		cmp	[edi], eax
		jnz	short loc_1000D6E9
		mov	ecx, [esi+4]
		mov	edx, [esi+84h]
		push	1FCh
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	eax
		push	ecx
		call	edx
		add	esp, 10h
		mov	eax, 0FFFFFFF9h

loc_1000D6E9:				; CODE XREF: .text:1000D6A3j
					; .text:1000D6ABj ...
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000D6EC:				; CODE XREF: .text:1000D675j
		mov	ecx, [ecx+10h]
		test	ecx, ecx
		jnz	short loc_1000D713
		mov	eax, [esp+8]
		mov	edx, [eax+84h]
		push	offset aUnexpectedlyMi ; "Unexpectedly missing a prompt	result"
		push	ecx
		mov	ecx, [eax+4]
		push	ecx
		call	edx
		add	esp, 0Ch
		mov	eax, 0FFFFFFF9h
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000D713:				; CODE XREF: .text:1000D6F1j
		mov	[edi], ecx
		xor	eax, eax
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D720	proc near		; CODE XREF: sub_10007E30+DBp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch
arg_2C		= dword	ptr  30h
arg_30		= dword	ptr  34h
arg_34		= dword	ptr  38h

		push	ebp
		mov	ebp, [esp+4+arg_8]
		mov	eax, 1
		test	ebp, ebp
		jz	short loc_1000D733
		mov	eax, 2

loc_1000D733:				; CODE XREF: sub_1000D720+Cj
		cmp	[esp+4+arg_10],	0
		jz	short loc_1000D73B
		inc	eax

loc_1000D73B:				; CODE XREF: sub_1000D720+18j
		cmp	[esp+4+arg_18],	0
		jz	short loc_1000D743
		inc	eax

loc_1000D743:				; CODE XREF: sub_1000D720+20j
		cmp	[esp+4+arg_24],	0
		jz	short loc_1000D74B
		inc	eax

loc_1000D74B:				; CODE XREF: sub_1000D720+28j
		cmp	[esp+4+arg_30],	0
		jz	short loc_1000D753
		inc	eax

loc_1000D753:				; CODE XREF: sub_1000D720+30j
		cmp	eax, 1
		jnz	short loc_1000D777
		mov	eax, [esp+4+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [eax+84h]
		push	offset aMake_promptsCa ; "make_prompts() called	with no	actual pr"...
		push	0
		push	ecx
		call	edx
		add	esp, 0Ch
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000D777:				; CODE XREF: sub_1000D720+36j
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	esi
		push	edi
		lea	edi, [eax+eax*2]
		mov	eax, [ebx+14h]
		add	edi, edi
		add	edi, edi
		add	edi, edi
		push	edi
		call	eax
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000D7B8
		mov	ecx, [ebx+4]
		mov	edx, [ebx+84h]
		push	223h
		push	offset aOutOfMemoryInP ; "Out of Memory	in plugin_common.c near	l"...
		push	eax
		push	ecx
		call	edx
		add	esp, 10h
		pop	edi
		lea	eax, [esi-2]
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000D7B8:				; CODE XREF: sub_1000D720+74j
		push	edi
		push	0
		push	esi
		call	sub_1000E0F0
		mov	eax, [esp+1Ch+arg_4]
		xor	ecx, ecx
		add	esp, 0Ch
		mov	[eax], esi
		cmp	ebp, ecx
		jz	short loc_1000D7EA
		mov	edx, [esp+10h+arg_C]
		mov	dword ptr [esi], 4001h
		mov	dword ptr [esi+4], offset aAuthorizationN ; "Authorization Name"
		mov	[esi+8], ebp
		mov	[esi+0Ch], edx
		add	esi, 18h

loc_1000D7EA:				; CODE XREF: sub_1000D720+AEj
		mov	eax, [esp+10h+arg_10]
		cmp	eax, ecx
		jz	short loc_1000D80C
		mov	[esi+8], eax
		mov	eax, [esp+10h+arg_14]
		mov	dword ptr [esi], 4002h
		mov	dword ptr [esi+4], offset aAuthenticati_0 ; "Authentication Name"
		mov	[esi+0Ch], eax
		add	esi, 18h

loc_1000D80C:				; CODE XREF: sub_1000D720+D0j
		mov	eax, [esp+10h+arg_18]
		cmp	eax, ecx
		jz	short loc_1000D82E
		mov	edx, [esp+10h+arg_1C]
		mov	dword ptr [esi], 4004h
		mov	dword ptr [esi+4], offset aPassword ; "Password"
		mov	[esi+8], eax
		mov	[esi+0Ch], edx
		add	esi, 18h

loc_1000D82E:				; CODE XREF: sub_1000D720+F2j
		mov	eax, [esp+10h+arg_24]
		cmp	eax, ecx
		jz	short loc_1000D850
		mov	edx, [esp+10h+arg_20]
		mov	[esi+8], eax
		mov	eax, [esp+10h+arg_28]
		mov	dword ptr [esi], 4005h
		mov	[esi+4], edx
		mov	[esi+0Ch], eax
		add	esi, 18h

loc_1000D850:				; CODE XREF: sub_1000D720+114j
		mov	eax, [esp+10h+arg_30]
		cmp	eax, ecx
		jz	short loc_1000D872
		mov	edx, [esp+10h+arg_2C]
		mov	[esi+8], eax
		mov	eax, [esp+10h+arg_34]
		mov	dword ptr [esi], 4008h
		mov	[esi+4], edx
		mov	[esi+0Ch], eax
		add	esi, 18h

loc_1000D872:				; CODE XREF: sub_1000D720+136j
		pop	edi
		mov	[esi], ecx
		mov	[esi+4], ecx
		mov	[esi+8], ecx
		mov	[esi+0Ch], ecx
		pop	esi
		pop	ebx
		xor	eax, eax
		pop	ebp
		retn
sub_1000D720	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+4]
		mov	edx, [esp+0Ch]
		xor	ecx, ecx
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		mov	[eax+14h], ecx
		mov	ecx, [esp+8]
		mov	[eax], ecx
		mov	dword ptr [eax+4], 4
		mov	[eax+18h], edx
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	ecx
		mov	eax, [esp+1Ch]
		push	ebx
		push	ebp
		mov	ebp, [esp+18h]
		push	esi
		push	edi
		mov	dword ptr [eax], 0
		test	ebp, ebp
		jz	loc_1000DA4F
		mov	esi, [esp+18h]
		mov	ebx, [esp+1Ch]

loc_1000D8E3:				; CODE XREF: .text:1000DA04j
		mov	edi, [esi+4]
		test	edi, edi
		jz	short loc_1000D95B
		cmp	ebp, edi
		ja	short loc_1000D8F0
		mov	edi, ebp

loc_1000D8F0:				; CODE XREF: .text:1000D8ECj
		mov	ecx, esi
		sub	ecx, [esi+4]
		push	edi
		add	ecx, 0Ch
		push	ebx
		push	ecx
		call	sub_1000E2B0
		sub	[esi+4], edi
		mov	eax, [esi+4]
		add	esp, 0Ch
		add	ebx, edi
		sub	ebp, edi
		test	eax, eax
		jnz	loc_1000DA4F
		mov	eax, [esi+8]
		push	eax
		mov	[esi+0Ch], eax
		call	ds:ntohl
		mov	[esi+0Ch], eax
		test	eax, eax
		jz	loc_1000DA2D
		mov	ecx, [esi+18h]
		cmp	eax, ecx
		ja	loc_1000DA12
		cmp	dword ptr [esi+10h], 0
		jnz	short loc_1000D954
		mov	edx, [esi]
		mov	eax, [edx+14h]
		push	ecx
		call	eax
		add	esp, 4
		mov	[esi+10h], eax
		test	eax, eax
		jz	loc_1000DA36

loc_1000D954:				; CODE XREF: .text:1000D93Cj
		mov	dword ptr [esi+14h], 0

loc_1000D95B:				; CODE XREF: .text:1000D8E8j
		mov	eax, [esi+14h]
		mov	edi, [esi+0Ch]
		mov	ecx, [esi+10h]
		sub	edi, eax
		add	ecx, eax
		cmp	ebp, edi
		jb	loc_1000DA41
		push	edi
		push	ebx
		push	ecx
		call	sub_1000E2B0
		mov	ecx, [esi+0Ch]
		lea	edx, [esp+2Ch]
		push	edx
		mov	edx, [esi+10h]
		lea	eax, [esp+20h]
		push	eax
		mov	eax, [esp+48h]
		push	ecx
		push	edx
		push	eax
		add	ebx, edi
		sub	ebp, edi
		call	dword ptr [esp+50h]
		add	esp, 20h
		test	eax, eax
		jnz	loc_1000DA51
		mov	edi, [esp+2Ch]
		mov	ecx, [edi]
		mov	edx, [esp+20h]
		lea	eax, [ecx+edx+1]
		mov	ecx, [esp+28h]
		mov	edx, [esp+24h]
		push	eax
		mov	eax, [esi]
		push	ecx
		push	edx
		push	eax
		call	sub_1000D0F0
		add	esp, 10h
		test	eax, eax
		jnz	loc_1000DA51
		mov	ecx, [esp+20h]
		mov	eax, [esp+24h]
		mov	edx, [esp+10h]
		push	ecx
		mov	ecx, [eax]
		add	ecx, [edi]
		push	edx
		push	ecx
		call	sub_1000E2B0
		mov	edx, [esp+2Ch]
		add	[edi], edx
		mov	ecx, [esp+30h]
		mov	eax, [edi]
		mov	edx, [ecx]
		add	esp, 0Ch
		mov	byte ptr [eax+edx], 0
		mov	dword ptr [esi+4], 4
		test	ebp, ebp
		jnz	loc_1000D8E3
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000DA12:				; CODE XREF: .text:1000D932j
		mov	edx, [esi+18h]
		mov	ecx, [esi]
		push	edx
		push	eax
		mov	eax, [ecx+80h]
		push	offset aEncodedPacketS ; "encoded packet size too big (%d > %d)"
		push	1
		push	0
		call	eax
		add	esp, 14h

loc_1000DA2D:				; CODE XREF: .text:1000D927j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000DA36:				; CODE XREF: .text:1000D94Ej
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000DA41:				; CODE XREF: .text:1000D96Aj
		push	ebp
		push	ebx
		push	ecx
		call	sub_1000E2B0
		add	esp, 0Ch
		add	[esi+14h], ebp

loc_1000DA4F:				; CODE XREF: .text:1000D8D5j
					; .text:1000D90Fj
		xor	eax, eax

loc_1000DA51:				; CODE XREF: .text:1000D99Cj
					; .text:1000D9C8j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 10h
		mov	ecx, [esp+4]
		mov	eax, [ecx+10h]
		test	eax, eax
		jz	short locret_1000DA76
		mov	ecx, [ecx]
		mov	edx, [ecx+20h]
		mov	[esp+4], eax
		jmp	edx
; ---------------------------------------------------------------------------

locret_1000DA76:			; CODE XREF: .text:1000DA69j
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+0Ch]
		push	edi
		test	ebx, ebx
		jz	loc_1000DB72
		mov	edi, [esp+1Ch]
		test	edi, edi
		jz	loc_1000DB72
		push	ebp
		mov	ebp, [esp+24h]
		push	esi
		push	40h
		push	ebp
		call	sub_1000EF20
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1000DAF9
		mov	eax, [esp+20h]
		test	eax, eax
		jz	short loc_1000DAC7
		cmp	byte ptr [eax],	0
		jz	short loc_1000DAC7
		mov	ecx, [esp+1Ch]
		push	esi
		push	ecx
		push	eax
		jmp	short loc_1000DACF
; ---------------------------------------------------------------------------

loc_1000DAC7:				; CODE XREF: .text:1000DAB7j
					; .text:1000DABCj
		mov	edx, [esp+1Ch]
		push	0
		push	edx
		push	edi

loc_1000DACF:				; CODE XREF: .text:1000DAC5j
		mov	esi, [esp+20h]
		push	esi
		call	sub_1000D1C0
		mov	edi, eax
		add	esp, 10h
		test	edi, edi
		jnz	loc_1000DB6B
		push	eax
		push	ebx
		push	ebp
		push	esi
		call	sub_1000D1C0
		add	esp, 10h
		pop	esi
		pop	ebp
		mov	edi, eax
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DAF9:				; CODE XREF: .text:1000DAAFj
		mov	eax, [esp+1Ch]
		mov	ebx, [esp+14h]
		push	0
		push	eax
		inc	esi
		push	esi
		push	ebx
		call	sub_1000D1C0
		lea	ecx, [esi-1]
		sub	ecx, ebp
		lea	ebp, [ecx+1]
		mov	byte ptr [esi-1], 0
		mov	edx, [ebx+14h]
		push	ebp
		mov	edi, eax
		call	edx
		mov	ecx, [esp+2Ch]
		add	esp, 14h
		mov	[ecx], eax
		test	eax, eax
		jz	short loc_1000DB47
		mov	edx, [esp+28h]
		push	ebp
		push	edx
		push	eax
		call	sub_1000EFE0
		add	esp, 0Ch
		mov	byte ptr [esi-1], 40h
		pop	esi
		pop	ebp
		mov	eax, edi
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DB47:				; CODE XREF: .text:1000DB2Bj
		mov	eax, [ebx+4]
		mov	ecx, [ebx+84h]
		push	2EFh
		push	offset aOutOfMemoryInP ; "Out of Memory	in plugin_common.c near	l"...
		push	0
		push	eax
		call	ecx
		add	esp, 10h
		mov	edi, 0FFFFFFFEh
		mov	byte ptr [esi-1], 40h

loc_1000DB6B:				; CODE XREF: .text:1000DAE0j
		pop	esi
		pop	ebp
		mov	eax, edi
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DB72:				; CODE XREF: .text:1000DA88j
					; .text:1000DA94j
		mov	eax, [esp+0Ch]
		mov	edx, [eax+4]
		mov	eax, [eax+84h]
		push	2D6h
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	0
		push	edx
		call	eax
		add	esp, 10h
		pop	edi
		mov	eax, 0FFFFFFF9h
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+0Ch]
		push	ebp
		push	edi
		test	ebx, ebx
		jz	loc_1000DC81
		mov	edi, [esp+18h]
		test	edi, edi
		jz	loc_1000DC81
		mov	ebp, [esp+1Ch]
		test	ebp, ebp
		jz	loc_1000DC81
		mov	eax, edi
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_1000DBD0:				; CODE XREF: .text:1000DBD5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000DBD0
		sub	eax, edx
		mov	edx, eax
		mov	eax, ebp
		push	esi
		lea	esi, [eax+1]

loc_1000DBE1:				; CODE XREF: .text:1000DBE6j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000DBE1
		sub	eax, esi
		mov	esi, [esp+14h]
		mov	ecx, [esi+14h]
		lea	eax, [eax+edx+2]
		push	eax
		call	ecx
		add	esp, 4
		mov	[ebx], eax
		test	eax, eax
		jnz	short loc_1000DC25
		mov	edx, [esi+4]
		push	304h
		push	offset aOutOfMemoryInP ; "Out of Memory	in plugin_common.c near	l"...
		push	eax
		mov	eax, [esi+84h]
		push	edx
		call	eax
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		mov	eax, 0FFFFFFFEh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DC25:				; CODE XREF: .text:1000DBFFj
		mov	ecx, edi
		mov	edx, eax
		lea	esp, [esp+0]

loc_1000DC30:				; CODE XREF: .text:1000DC38j
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_1000DC30
		mov	edi, [ebx]
		dec	edi
		lea	ecx, [ecx+0]

loc_1000DC40:				; CODE XREF: .text:1000DC46j
		mov	al, [edi+1]
		inc	edi
		test	al, al
		jnz	short loc_1000DC40
		mov	cx, ds:word_10028AD0
		mov	eax, ebp
		mov	[edi], cx
		mov	ecx, eax

loc_1000DC56:				; CODE XREF: .text:1000DC5Bj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000DC56
		mov	edi, [ebx]
		sub	eax, ecx
		mov	esi, ecx
		dec	edi

loc_1000DC64:				; CODE XREF: .text:1000DC6Aj
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1000DC64
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		pop	esi
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DC81:				; CODE XREF: .text:1000DBA9j
					; .text:1000DBB5j ...
		mov	eax, [esp+10h]
		mov	edx, [eax+4]
		mov	eax, [eax+84h]
		push	2FEh
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	0
		push	edx
		call	eax
		add	esp, 10h
		pop	edi
		pop	ebp
		mov	eax, 0FFFFFFF9h
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 8
		mov	ecx, [esp+10h]
		push	esi
		push	0
		push	0
		lea	eax, [esp+0Ch]
		push	eax
		push	400h
		push	ecx
		push	0
		push	1300h
		call	ds:FormatMessageA
		mov	eax, [esp+4]
		mov	ecx, [esp+10h]
		push	0
		lea	edx, [esp+0Ch]
		push	edx
		push	eax
		push	ecx
		call	sub_1000D1C0
		add	esp, 10h
		test	eax, eax
		jz	short loc_1000DD05
		mov	edx, [esp+4]
		push	edx
		xor	esi, esi
		call	ds:LocalFree
		mov	eax, esi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000DD05:				; CODE XREF: .text:1000DCEFj
		mov	edx, [esp+4]
		mov	esi, [esp+8]
		push	edx
		call	ds:LocalFree
		mov	eax, esi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0A0h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+9Ch], eax
		push	esi
		push	edi
		mov	edi, [esp+0ACh]
		lea	eax, [esp+8]
		push	eax
		mov	dword ptr [esp+0Ch], 9Ch
		mov	esi, offset aUnknownWindows ; "Unknown Windows"
		call	ds:GetVersionExA
		test	eax, eax
		jnz	short loc_1000DD87
		mov	ecx, [esp+0B0h]
		push	esi
		push	offset aS	; "%s"
		push	ecx
		push	edi
		call	sub_1000FA78
		add	esp, 10h
		pop	edi
		pop	esi
		mov	ecx, [esp+9Ch]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0A0h
		retn
; ---------------------------------------------------------------------------

loc_1000DD87:				; CODE XREF: .text:1000DD57j
		mov	eax, [esp+18h]
		sub	eax, 0
		jz	loc_1000DE3F
		dec	eax
		jz	short loc_1000DDF1
		dec	eax
		jnz	loc_1000DE44
		mov	eax, [esp+10h]
		cmp	eax, 63h
		ja	loc_1000DE44
		mov	edx, [esp+0Ch]
		imul	edx, 64h
		lea	eax, [edx+eax-15Fh]
		cmp	eax, 96h	; switch 151 cases
		ja	short loc_1000DDEA ; jumptable 1000DDC7	default	case
		movzx	eax, ds:byte_1000DE90[eax]
		jmp	ds:off_1000DE7C[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000DDCE:				; CODE XREF: .text:1000DDC7j
					; DATA XREF: .text:off_1000DE7Co
		mov	esi, offset aWindowsNt3_51 ; jumptable 1000DDC7	case 0
		jmp	short loc_1000DE44
; ---------------------------------------------------------------------------

loc_1000DDD5:				; CODE XREF: .text:1000DDC7j
					; DATA XREF: .text:off_1000DE7Co
		mov	esi, offset aWindowsNt4_0 ; jumptable 1000DDC7 case 49
		jmp	short loc_1000DE44
; ---------------------------------------------------------------------------

loc_1000DDDC:				; CODE XREF: .text:1000DDC7j
					; DATA XREF: .text:off_1000DE7Co
		mov	esi, offset aWindows2000 ; jumptable 1000DDC7 case 149
		jmp	short loc_1000DE44
; ---------------------------------------------------------------------------

loc_1000DDE3:				; CODE XREF: .text:1000DDC7j
					; DATA XREF: .text:off_1000DE7Co
		mov	esi, offset aWindowsXp_net ; jumptable 1000DDC7	case 150
		jmp	short loc_1000DE44
; ---------------------------------------------------------------------------

loc_1000DDEA:				; CODE XREF: .text:1000DDBEj
					; .text:1000DDC7j
					; DATA XREF: ...
		mov	esi, offset aUnknownWindo_0 ; jumptable	1000DDC7 default case
		jmp	short loc_1000DE44
; ---------------------------------------------------------------------------

loc_1000DDF1:				; CODE XREF: .text:1000DD95j
		mov	eax, [esp+10h]
		test	eax, eax
		jz	short loc_1000DE30
		cmp	eax, 0Ah
		jz	short loc_1000DE21
		cmp	eax, 5Ah
		jz	short loc_1000DE12
		and	dword ptr [esp+14h], 0FFFFh
		mov	esi, offset aUnknownWindo_1 ; "Unknown Windows 9X/ME series"
		jmp	short loc_1000DE44
; ---------------------------------------------------------------------------

loc_1000DE12:				; CODE XREF: .text:1000DE01j
		and	dword ptr [esp+14h], 0FFFFh
		mov	esi, offset aWindowsMe ; "Windows Me"
		jmp	short loc_1000DE44
; ---------------------------------------------------------------------------

loc_1000DE21:				; CODE XREF: .text:1000DDFCj
		and	dword ptr [esp+14h], 0FFFFh
		mov	esi, offset aWindows98 ; "Windows 98"
		jmp	short loc_1000DE44
; ---------------------------------------------------------------------------

loc_1000DE30:				; CODE XREF: .text:1000DDF7j
		and	dword ptr [esp+14h], 0FFFFh
		mov	esi, offset aWindows95 ; "Windows 95"
		jmp	short loc_1000DE44
; ---------------------------------------------------------------------------

loc_1000DE3F:				; CODE XREF: .text:1000DD8Ej
		mov	esi, offset aWin32sOnWindow ; "Win32s on Windows 3.1"

loc_1000DE44:				; CODE XREF: .text:1000DD98j
					; .text:1000DDA5j ...
		mov	ecx, [esp+14h]
		mov	eax, [esp+0B0h]
		push	ecx
		lea	edx, [esp+20h]
		push	edx
		push	esi
		push	offset aSSBuildU ; "%s %s (Build %u)"
		push	eax
		push	edi
		call	sub_1000FA78
		mov	ecx, [esp+0BCh]
		add	esp, 18h
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0A0h
		retn
; ---------------------------------------------------------------------------
off_1000DE7C	dd offset loc_1000DDCE,	offset loc_1000DDD5, offset loc_1000DDDC
					; DATA XREF: .text:1000DDC7r
		dd offset loc_1000DDE3,	offset loc_1000DDEA ; jump table for switch statement
byte_1000DE90	db	0,     4,     4,     4 ; DATA XREF: .text:1000DDC0r
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     1,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     2,     3
		align 10h
		mov	eax, [esp+4]
		imul	eax, 3E8h
		push	eax
		call	ds:Sleep
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h]
		test	edi, edi
		jz	loc_1000E075
		mov	ebp, [esp+14h]
		test	ebp, ebp
		jz	loc_1000E05A
		mov	esi, [esp+1Ch]
		test	esi, esi
		jz	loc_1000E05A
		cmp	dword ptr [esi], 0
		jnz	short loc_1000DFB9
		mov	eax, [edi+14h]
		push	0Ch
		call	eax
		add	esp, 4
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_1000DFAF
		mov	ecx, [edi+4]
		mov	edx, [edi+84h]
		push	0B9h
		push	offset aOutOfMemoryInP ; "Out of Memory	in plugin_common.c near	l"...
		push	eax
		push	ecx
		call	edx
		add	esp, 10h
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000DFAF:				; CODE XREF: .text:1000DF8Aj
		xor	ecx, ecx
		mov	[eax], ecx
		mov	[eax+4], ecx
		mov	[eax+8], ecx

loc_1000DFB9:				; CODE XREF: .text:1000DF7Aj
		mov	esi, [esi]
		push	ebx
		mov	ebx, [esp+1Ch]
		xor	eax, eax
		mov	dword ptr [esi+4], 0
		test	ebx, ebx
		jz	short loc_1000DFDC
		xor	ecx, ecx
		nop

loc_1000DFD0:				; CODE XREF: .text:1000DFDAj
		add	ecx, [ebp+eax*8+0]
		inc	eax
		mov	[esi+4], ecx
		cmp	eax, ebx
		jb	short loc_1000DFD0

loc_1000DFDC:				; CODE XREF: .text:1000DFCBj
		mov	eax, [esi+4]
		mov	ecx, [esp+14h]
		push	eax
		lea	edi, [esi+8]
		push	edi
		push	esi
		push	ecx
		call	sub_1000D0F0
		add	esp, 10h
		test	eax, eax
		jz	short loc_1000E01F
		mov	eax, [esp+14h]
		mov	edx, [eax+4]
		mov	eax, [eax+84h]
		push	0C8h
		push	offset aOutOfMemoryInP ; "Out of Memory	in plugin_common.c near	l"...
		push	0
		push	edx
		call	eax
		add	esp, 10h
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFFEh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E01F:				; CODE XREF: .text:1000DFF4j
		mov	ecx, [edi]
		mov	edx, [esi]
		push	ecx
		push	0
		push	edx
		call	sub_1000E0F0
		mov	edi, [esi]
		add	esp, 0Ch
		xor	esi, esi
		test	ebx, ebx
		jz	short loc_1000E053

loc_1000E037:				; CODE XREF: .text:1000E051j
		mov	eax, [ebp+esi*8+0]
		mov	ecx, [ebp+esi*8+4]
		push	eax
		push	ecx
		push	edi
		call	sub_1000E2B0
		add	edi, [ebp+esi*8+0]
		inc	esi
		add	esp, 0Ch
		cmp	esi, ebx
		jb	short loc_1000E037

loc_1000E053:				; CODE XREF: .text:1000E035j
		pop	ebx
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E05A:				; CODE XREF: .text:1000DF65j
					; .text:1000DF71j
		mov	edx, [edi+4]
		mov	eax, [edi+84h]
		push	0B2h
		push	offset aParameterErr_3 ; "Parameter Error in plugin_common.c near"...
		push	0
		push	edx
		call	eax
		add	esp, 10h

loc_1000E075:				; CODE XREF: .text:1000DF59j
		pop	edi
		pop	esi
		mov	eax, 0FFFFFFF9h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		jmp	ds:freeaddrinfo
; ---------------------------------------------------------------------------
		jmp	ds:getaddrinfo
; ---------------------------------------------------------------------------
		jmp	ds:ntohl
; ---------------------------------------------------------------------------
		jmp	ds:htonl
; ---------------------------------------------------------------------------
		jmp	ds:WSASetLastError
; ---------------------------------------------------------------------------
		jmp	ds:gethostname
; ---------------------------------------------------------------------------
		jmp	ds:ExpandEnvironmentStringsA
; ---------------------------------------------------------------------------
		jmp	ds:GetLastError
; ---------------------------------------------------------------------------
		jmp	ds:GetProcAddress
; ---------------------------------------------------------------------------
		jmp	ds:LoadLibraryA
; ---------------------------------------------------------------------------
		jmp	ds:FreeLibrary
; ---------------------------------------------------------------------------
		jmp	ds:LocalFree
; ---------------------------------------------------------------------------
		jmp	ds:FormatMessageA
; ---------------------------------------------------------------------------
		jmp	ds:GetVersionExA
; ---------------------------------------------------------------------------
		jmp	ds:Sleep
; ---------------------------------------------------------------------------
		jmp	ds:GetUserNameA
; ---------------------------------------------------------------------------
		jmp	ds:RegCloseKey
; ---------------------------------------------------------------------------
		jmp	ds:RegQueryValueExA
; ---------------------------------------------------------------------------
		jmp	ds:RegOpenKeyExA

; =============== S U B	R O U T	I N E =======================================


sub_1000E0F0	proc near		; CODE XREF: sub_10001000+1Cp
					; sub_10001050+1Dp ...

arg_0		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_8]
		mov	ecx, [esp+arg_0]
		test	edx, edx
		jz	short loc_1000E165
		xor	eax, eax
		mov	al, [esp+arg_4]
		test	al, al
		jnz	short loc_1000E11C
		cmp	edx, 100h
		jb	short loc_1000E11C
		cmp	dword_1002F1CC,	0
		jz	short loc_1000E11C
		jmp	sub_100118B2
; ---------------------------------------------------------------------------

loc_1000E11C:				; CODE XREF: sub_1000E0F0+14j
					; sub_1000E0F0+1Cj ...
		push	edi
		mov	edi, ecx
		cmp	edx, 4
		jb	short loc_1000E155
		neg	ecx
		and	ecx, 3
		jz	short loc_1000E137
		sub	edx, ecx

loc_1000E12D:				; CODE XREF: sub_1000E0F0+45j
		mov	[edi], al
		add	edi, 1
		sub	ecx, 1
		jnz	short loc_1000E12D

loc_1000E137:				; CODE XREF: sub_1000E0F0+39j
		mov	ecx, eax
		shl	eax, 8
		add	eax, ecx
		mov	ecx, eax
		shl	eax, 10h
		add	eax, ecx
		mov	ecx, edx
		and	edx, 3
		shr	ecx, 2
		jz	short loc_1000E155
		rep stosd
		test	edx, edx
		jz	short loc_1000E15F

loc_1000E155:				; CODE XREF: sub_1000E0F0+32j
					; sub_1000E0F0+5Dj ...
		mov	[edi], al
		add	edi, 1
		sub	edx, 1
		jnz	short loc_1000E155

loc_1000E15F:				; CODE XREF: sub_1000E0F0+63j
		mov	eax, [esp+4+arg_0]
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000E165:				; CODE XREF: sub_1000E0F0+Aj
		mov	eax, [esp+arg_0]
		retn
sub_1000E0F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E170	proc near		; CODE XREF: prop_format+C7p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		push	edi
		test	ecx, ecx
		jz	loc_1000E234
		mov	edi, [esp+4+arg_0]
		push	esi
		test	edi, 3
		push	ebx
		jz	short loc_1000E19C

loc_1000E18B:				; CODE XREF: sub_1000E170+2Aj
		mov	al, [edi]
		add	edi, 1
		test	al, al
		jz	short loc_1000E1CD
		test	edi, 3
		jnz	short loc_1000E18B

loc_1000E19C:				; CODE XREF: sub_1000E170+19j
					; sub_1000E170+42j ...
		mov	eax, [edi]
		mov	edx, 7EFEFEFFh
		add	edx, eax
		xor	eax, 0FFFFFFFFh
		xor	eax, edx
		add	edi, 4
		test	eax, 81010100h
		jz	short loc_1000E19C
		mov	eax, [edi-4]
		test	al, al
		jz	short loc_1000E1DC
		test	ah, ah
		jz	short loc_1000E1D7
		test	eax, 0FF0000h
		jz	short loc_1000E1D2
		test	eax, 0FF000000h
		jnz	short loc_1000E19C

loc_1000E1CD:				; CODE XREF: sub_1000E170+22j
		sub	edi, 1
		jmp	short loc_1000E1DF
; ---------------------------------------------------------------------------

loc_1000E1D2:				; CODE XREF: sub_1000E170+54j
		sub	edi, 2
		jmp	short loc_1000E1DF
; ---------------------------------------------------------------------------

loc_1000E1D7:				; CODE XREF: sub_1000E170+4Dj
		sub	edi, 3
		jmp	short loc_1000E1DF
; ---------------------------------------------------------------------------

loc_1000E1DC:				; CODE XREF: sub_1000E170+49j
		sub	edi, 4

loc_1000E1DF:				; CODE XREF: sub_1000E170+60j
					; sub_1000E170+65j ...
		mov	esi, [esp+0Ch+arg_4]
		test	esi, 3
		jnz	short loc_1000E1F4
		mov	ebx, ecx
		shr	ecx, 2
		jnz	short loc_1000E24E
		jmp	short loc_1000E216
; ---------------------------------------------------------------------------

loc_1000E1F4:				; CODE XREF: sub_1000E170+79j
					; sub_1000E170+9Dj
		mov	dl, [esi]
		add	esi, 1
		test	dl, dl
		jz	short loc_1000E23A
		mov	[edi], dl
		add	edi, 1
		sub	ecx, 1
		jz	short loc_1000E230
		test	esi, 3
		jnz	short loc_1000E1F4
		mov	ebx, ecx
		shr	ecx, 2
		jnz	short loc_1000E24E

loc_1000E216:				; CODE XREF: sub_1000E170+82j
					; sub_1000E170+DCj
		mov	ecx, ebx
		and	ecx, 3
		jz	short loc_1000E230

loc_1000E21D:				; CODE XREF: sub_1000E170+BEj
		mov	dl, [esi]
		add	esi, 1
		mov	[edi], dl
		add	edi, 1
		test	dl, dl
		jz	short loc_1000E232
		sub	ecx, 1
		jnz	short loc_1000E21D

loc_1000E230:				; CODE XREF: sub_1000E170+95j
					; sub_1000E170+ABj
		mov	[edi], cl

loc_1000E232:				; CODE XREF: sub_1000E170+B9j
		pop	ebx
		pop	esi

loc_1000E234:				; CODE XREF: sub_1000E170+7j
		mov	eax, [esp+4+arg_0]
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000E23A:				; CODE XREF: sub_1000E170+8Bj
					; sub_1000E170+FAj
		mov	[edi], dl
		mov	eax, [esp+0Ch+arg_0]
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000E244:				; CODE XREF: sub_1000E170+F6j
					; sub_1000E170+10Ej
		mov	[edi], edx
		add	edi, 4
		sub	ecx, 1
		jz	short loc_1000E216

loc_1000E24E:				; CODE XREF: sub_1000E170+80j
					; sub_1000E170+A4j
		mov	edx, 7EFEFEFFh
		mov	eax, [esi]
		add	edx, eax
		xor	eax, 0FFFFFFFFh
		xor	eax, edx
		mov	edx, [esi]
		add	esi, 4
		test	eax, 81010100h
		jz	short loc_1000E244
		test	dl, dl
		jz	short loc_1000E23A
		test	dh, dh
		jz	short loc_1000E29A
		test	edx, 0FF0000h
		jz	short loc_1000E28A
		test	edx, 0FF000000h
		jnz	short loc_1000E244
		mov	[edi], edx
		mov	eax, [esp+0Ch+arg_0]
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000E28A:				; CODE XREF: sub_1000E170+106j
		mov	[edi], dx
		xor	edx, edx
		mov	eax, [esp+0Ch+arg_0]
		mov	[edi+2], dl
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000E29A:				; CODE XREF: sub_1000E170+FEj
		mov	[edi], dx
		mov	eax, [esp+0Ch+arg_0]
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_1000E170	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E2B0	proc near		; CODE XREF: prop_set+274p
					; prop_set+33Ap ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		mov	esi, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	edi, [ebp+arg_0]
		mov	eax, ecx
		mov	edx, ecx
		add	eax, esi
		cmp	edi, esi
		jbe	short loc_1000E2D0
		cmp	edi, eax
		jb	loc_1000E474

loc_1000E2D0:				; CODE XREF: sub_1000E2B0+16j
		cmp	ecx, 100h
		jb	short loc_1000E2F7
		cmp	dword_1002F1CC,	0
		jz	short loc_1000E2F7
		push	edi
		push	esi
		and	edi, 0Fh
		and	esi, 0Fh
		cmp	edi, esi
		pop	esi
		pop	edi
		jnz	short loc_1000E2F7
		pop	esi
		pop	edi
		pop	ebp
		jmp	sub_10011A87
; ---------------------------------------------------------------------------

loc_1000E2F7:				; CODE XREF: sub_1000E2B0+26j
					; sub_1000E2B0+2Fj ...
		test	edi, 3
		jnz	short loc_1000E314
		shr	ecx, 2
		and	edx, 3
		cmp	ecx, 8		; switch 8 cases
		jb	short loc_1000E334
		rep movsd		; jumptable 1000E334 default case
		jmp	ds:off_1000E424[edx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1000E314:				; CODE XREF: sub_1000E2B0+4Dj
		mov	eax, edi
		mov	edx, 3
		sub	ecx, 4
		jb	short loc_1000E32C
		and	eax, 3
		add	ecx, eax
		jmp	dword ptr ds:(loc_1000E334+4)[eax*4]
; ---------------------------------------------------------------------------

loc_1000E32C:				; CODE XREF: sub_1000E2B0+6Ej
		jmp	dword ptr ds:loc_1000E434[ecx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1000E334:				; CODE XREF: sub_1000E2B0+58j
					; sub_1000E2B0+B6j ...
		jmp	ds:off_1000E3B8[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 4
		dd offset loc_1000E348
		dd offset loc_1000E374
		dd offset loc_1000E398
; ---------------------------------------------------------------------------

loc_1000E348:				; DATA XREF: sub_1000E2B0+8Co
		and	edx, ecx
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	al, [esi+2]
		shr	ecx, 2
		mov	[edi+2], al
		add	esi, 3
		add	edi, 3
		cmp	ecx, 8
		jb	short loc_1000E334
		rep movsd
		jmp	ds:off_1000E424[edx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1000E374:				; DATA XREF: sub_1000E2B0+90o
		and	edx, ecx
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		shr	ecx, 2
		mov	[edi+1], al
		add	esi, 2
		add	edi, 2
		cmp	ecx, 8
		jb	short loc_1000E334
		rep movsd
		jmp	ds:off_1000E424[edx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1000E398:				; DATA XREF: sub_1000E2B0+94o
		and	edx, ecx
		mov	al, [esi]
		mov	[edi], al
		add	esi, 1
		shr	ecx, 2
		add	edi, 1
		cmp	ecx, 8
		jb	short loc_1000E334
		rep movsd
		jmp	ds:off_1000E424[edx*4]
; ---------------------------------------------------------------------------
		align 4
off_1000E3B8	dd offset loc_1000E41B	; DATA XREF: sub_1000E2B0:loc_1000E334r
		dd offset loc_1000E408	; jump table for switch	statement
		dd offset loc_1000E400
		dd offset loc_1000E3F8
		dd offset loc_1000E3F0
		dd offset loc_1000E3E8
		dd offset loc_1000E3E0
		dd offset loc_1000E3D8
; ---------------------------------------------------------------------------

loc_1000E3D8:				; CODE XREF: sub_1000E2B0:loc_1000E334j
					; DATA XREF: sub_1000E2B0:off_1000E3B8o
		mov	eax, [esi+ecx*4-1Ch] ; jumptable 1000E334 case 7
		mov	[edi+ecx*4-1Ch], eax

loc_1000E3E0:				; CODE XREF: sub_1000E2B0:loc_1000E334j
					; DATA XREF: sub_1000E2B0:off_1000E3B8o
		mov	eax, [esi+ecx*4-18h] ; jumptable 1000E334 case 6
		mov	[edi+ecx*4-18h], eax

loc_1000E3E8:				; CODE XREF: sub_1000E2B0:loc_1000E334j
					; DATA XREF: sub_1000E2B0:off_1000E3B8o
		mov	eax, [esi+ecx*4-14h] ; jumptable 1000E334 case 5
		mov	[edi+ecx*4-14h], eax

loc_1000E3F0:				; CODE XREF: sub_1000E2B0:loc_1000E334j
					; DATA XREF: sub_1000E2B0:off_1000E3B8o
		mov	eax, [esi+ecx*4-10h] ; jumptable 1000E334 case 4
		mov	[edi+ecx*4-10h], eax

loc_1000E3F8:				; CODE XREF: sub_1000E2B0:loc_1000E334j
					; DATA XREF: sub_1000E2B0:off_1000E3B8o
		mov	eax, [esi+ecx*4-0Ch] ; jumptable 1000E334 case 3
		mov	[edi+ecx*4-0Ch], eax

loc_1000E400:				; CODE XREF: sub_1000E2B0:loc_1000E334j
					; DATA XREF: sub_1000E2B0:off_1000E3B8o
		mov	eax, [esi+ecx*4-8] ; jumptable 1000E334	case 2
		mov	[edi+ecx*4-8], eax

loc_1000E408:				; CODE XREF: sub_1000E2B0:loc_1000E334j
					; DATA XREF: sub_1000E2B0:off_1000E3B8o
		mov	eax, [esi+ecx*4-4] ; jumptable 1000E334	case 1
		mov	[edi+ecx*4-4], eax
		lea	eax, ds:0[ecx*4]
		add	esi, eax
		add	edi, eax

loc_1000E41B:				; CODE XREF: sub_1000E2B0:loc_1000E334j
					; DATA XREF: sub_1000E2B0:off_1000E3B8o
		jmp	ds:off_1000E424[edx*4] ; jumptable 1000E334 case 0
; ---------------------------------------------------------------------------
		align 4
off_1000E424	dd offset loc_1000E434	; DATA XREF: sub_1000E2B0+5Cr
					; sub_1000E2B0+BAr ...
		dd offset loc_1000E43C
		dd offset loc_1000E448
		dd offset loc_1000E45C
; ---------------------------------------------------------------------------

loc_1000E434:				; CODE XREF: sub_1000E2B0+5Cj
					; sub_1000E2B0+BAj ...
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1000E43C:				; CODE XREF: sub_1000E2B0+5Cj
					; sub_1000E2B0+BAj ...
		mov	al, [esi]
		mov	[edi], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1000E448:				; CODE XREF: sub_1000E2B0+5Cj
					; sub_1000E2B0+BAj ...
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1000E45C:				; CODE XREF: sub_1000E2B0+5Cj
					; sub_1000E2B0+BAj ...
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1000E474:				; CODE XREF: sub_1000E2B0+1Aj
		lea	esi, [ecx+esi-4]
		lea	edi, [ecx+edi-4]
		test	edi, 3
		jnz	short loc_1000E4A8
		shr	ecx, 2
		and	edx, 3
		cmp	ecx, 8
		jb	short loc_1000E49C
		std
		rep movsd
		cld
		jmp	ds:off_1000E5C0[edx*4] ; jumptable 1000E4C0 case 0
; ---------------------------------------------------------------------------
		align 4

loc_1000E49C:				; CODE XREF: sub_1000E2B0+1DDj
					; sub_1000E2B0+238j ...
		neg	ecx
		jmp	ds:off_1000E570[ecx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1000E4A8:				; CODE XREF: sub_1000E2B0+1D2j
		mov	eax, edi
		mov	edx, 3
		cmp	ecx, 4		; switch 4 cases
		jb	short loc_1000E4C0
		and	eax, 3		; jumptable 1000E4C0 default case
		sub	ecx, eax
		jmp	dword ptr ds:(loc_1000E4C0+4)[eax*4]
; ---------------------------------------------------------------------------

loc_1000E4C0:				; CODE XREF: sub_1000E2B0+202j
					; DATA XREF: sub_1000E2B0+209r
		jmp	ds:off_1000E5C0[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 4
		dd offset loc_1000E4D4
		dd offset loc_1000E4F8
		dd offset loc_1000E520
; ---------------------------------------------------------------------------

loc_1000E4D4:				; DATA XREF: sub_1000E2B0+218o
		mov	al, [esi+3]
		and	edx, ecx
		mov	[edi+3], al
		sub	esi, 1
		shr	ecx, 2
		sub	edi, 1
		cmp	ecx, 8
		jb	short loc_1000E49C
		std
		rep movsd
		cld
		jmp	ds:off_1000E5C0[edx*4] ; jumptable 1000E4C0 case 0
; ---------------------------------------------------------------------------
		align 4

loc_1000E4F8:				; DATA XREF: sub_1000E2B0+21Co
		mov	al, [esi+3]
		and	edx, ecx
		mov	[edi+3], al
		mov	al, [esi+2]
		shr	ecx, 2
		mov	[edi+2], al
		sub	esi, 2
		sub	edi, 2
		cmp	ecx, 8
		jb	short loc_1000E49C
		std
		rep movsd
		cld
		jmp	ds:off_1000E5C0[edx*4] ; jumptable 1000E4C0 case 0
; ---------------------------------------------------------------------------
		align 10h

loc_1000E520:				; DATA XREF: sub_1000E2B0+220o
		mov	al, [esi+3]
		and	edx, ecx
		mov	[edi+3], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	al, [esi+1]
		shr	ecx, 2
		mov	[edi+1], al
		sub	esi, 3
		sub	edi, 3
		cmp	ecx, 8
		jb	loc_1000E49C
		std
		rep movsd
		cld
		jmp	ds:off_1000E5C0[edx*4] ; jumptable 1000E4C0 case 0
; ---------------------------------------------------------------------------
		align 4
		dd offset loc_1000E574
		dd offset loc_1000E57C
		dd offset loc_1000E584
		dd offset loc_1000E58C
		dd offset loc_1000E594
		dd offset loc_1000E59C
		dd offset loc_1000E5A4
off_1000E570	dd offset loc_1000E5B7	; DATA XREF: sub_1000E2B0+1EEr
; ---------------------------------------------------------------------------

loc_1000E574:				; DATA XREF: sub_1000E2B0+2A4o
		mov	eax, [esi+ecx*4+1Ch]
		mov	[edi+ecx*4+1Ch], eax

loc_1000E57C:				; DATA XREF: sub_1000E2B0+2A8o
		mov	eax, [esi+ecx*4+18h]
		mov	[edi+ecx*4+18h], eax

loc_1000E584:				; DATA XREF: sub_1000E2B0+2ACo
		mov	eax, [esi+ecx*4+14h]
		mov	[edi+ecx*4+14h], eax

loc_1000E58C:				; DATA XREF: sub_1000E2B0+2B0o
		mov	eax, [esi+ecx*4+10h]
		mov	[edi+ecx*4+10h], eax

loc_1000E594:				; DATA XREF: sub_1000E2B0+2B4o
		mov	eax, [esi+ecx*4+0Ch]
		mov	[edi+ecx*4+0Ch], eax

loc_1000E59C:				; DATA XREF: sub_1000E2B0+2B8o
		mov	eax, [esi+ecx*4+8]
		mov	[edi+ecx*4+8], eax

loc_1000E5A4:				; DATA XREF: sub_1000E2B0+2BCo
		mov	eax, [esi+ecx*4+4]
		mov	[edi+ecx*4+4], eax
		lea	eax, ds:0[ecx*4]
		add	esi, eax
		add	edi, eax

loc_1000E5B7:				; CODE XREF: sub_1000E2B0+1EEj
					; DATA XREF: sub_1000E2B0:off_1000E570o
		jmp	ds:off_1000E5C0[edx*4] ; jumptable 1000E4C0 case 0
; ---------------------------------------------------------------------------
		align 10h
off_1000E5C0	dd offset loc_1000E5D0	; DATA XREF: sub_1000E2B0+1E3r
					; sub_1000E2B0:loc_1000E4C0r ...
					; jump table for switch	statement
		dd offset loc_1000E5D8	; jumptable 1000E4C0 case 1
		dd offset loc_1000E5E8	; jumptable 1000E4C0 case 2
		dd offset loc_1000E5FC	; jumptable 1000E4C0 case 3
; ---------------------------------------------------------------------------

loc_1000E5D0:				; CODE XREF: sub_1000E2B0+1E3j
					; sub_1000E2B0:loc_1000E4C0j ...
		mov	eax, [ebp+arg_0] ; jumptable 1000E4C0 case 0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1000E5D8:				; CODE XREF: sub_1000E2B0+1E3j
					; sub_1000E2B0:loc_1000E4C0j ...
		mov	al, [esi+3]	; jumptable 1000E4C0 case 1
		mov	[edi+3], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1000E5E8:				; CODE XREF: sub_1000E2B0+1E3j
					; sub_1000E2B0:loc_1000E4C0j ...
		mov	al, [esi+3]	; jumptable 1000E4C0 case 2
		mov	[edi+3], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1000E5FC:				; CODE XREF: sub_1000E2B0+1E3j
					; sub_1000E2B0:loc_1000E4C0j ...
		mov	al, [esi+3]	; jumptable 1000E4C0 case 3
		mov	[edi+3], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
sub_1000E2B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E615	proc near		; CODE XREF: sub_1000E6C7+Ep
					; sub_1000E756+Ep ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		mov	byte ptr [esi+0Ch], 0
		test	eax, eax
		jnz	short loc_1000E6A5
		call	sub_100137AC
		mov	[esi+8], eax
		test	eax, eax
		jz	short loc_1000E697
		mov	ecx, [eax+6Ch]
		mov	[esi], ecx
		mov	ecx, [eax+68h]
		mov	[esi+4], ecx
		mov	ecx, [esi]
		cmp	ecx, off_1002DB68
		jz	short loc_1000E65F
		test	byte ptr [eax+70h], 2
		jnz	short loc_1000E65F
		test	byte ptr dword_1002DA84, 1
		jz	short loc_1000E65F
		call	sub_10012545
		mov	[esi], eax

loc_1000E65F:				; CODE XREF: sub_1000E615+32j
					; sub_1000E615+38j ...
		mov	eax, [esi+4]
		cmp	eax, lpAddend
		jz	short loc_1000E684
		mov	eax, [esi+8]
		test	byte ptr [eax+70h], 2
		jnz	short loc_1000E684
		test	byte ptr dword_1002DA84, 1
		jz	short loc_1000E684
		call	sub_10011D90
		mov	[esi+4], eax

loc_1000E684:				; CODE XREF: sub_1000E615+53j
					; sub_1000E615+5Cj ...
		mov	eax, [esi+8]
		test	byte ptr [eax+70h], 2
		jnz	short loc_1000E6AF
		or	dword ptr [eax+70h], 2
		mov	byte ptr [esi+0Ch], 1
		jmp	short loc_1000E6AF
; ---------------------------------------------------------------------------

loc_1000E697:				; CODE XREF: sub_1000E615+1Dj
		mov	eax, off_1002DB68
		mov	[esi], eax
		mov	eax, lpAddend
		jmp	short loc_1000E6AC
; ---------------------------------------------------------------------------

loc_1000E6A5:				; CODE XREF: sub_1000E615+11j
		mov	ecx, [eax]
		mov	[esi], ecx
		mov	eax, [eax+4]

loc_1000E6AC:				; CODE XREF: sub_1000E615+8Ej
		mov	[esi+4], eax

loc_1000E6AF:				; CODE XREF: sub_1000E615+76j
					; sub_1000E615+80j
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	4
sub_1000E615	endp

; ---------------------------------------------------------------------------
		cmp	byte ptr [ecx+0Ch], 0
		jz	short locret_1000E6C3
		mov	eax, [ecx+8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

locret_1000E6C3:			; CODE XREF: .text:1000E6BAj
		retn
; ---------------------------------------------------------------------------
		mov	eax, ecx
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E6C7	proc near		; CODE XREF: sub_1000E71D+30p
					; .text:1000ECECp

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000E6FC
		lea	eax, [ebp+var_10]
		push	eax
		push	103h
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000E70E
; ---------------------------------------------------------------------------

loc_1000E6FC:				; CODE XREF: sub_1000E6C7+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 103h

loc_1000E70E:				; CODE XREF: sub_1000E6C7+33j
		cmp	[ebp+var_4], 0
		jz	short locret_1000E71B
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000E71B:			; CODE XREF: sub_1000E6C7+4Bj
		leave
		retn
sub_1000E6C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E71D	proc near		; CODE XREF: .text:1000ED0Cp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000E748
		or	eax, 0FFFFFFFFh
		cmp	[ebp+arg_0], eax
		jz	short loc_1000E737
		movzx	eax, byte ptr [ebp+arg_0]

loc_1000E737:				; CODE XREF: sub_1000E71D+14j
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 103h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E748:				; CODE XREF: sub_1000E71D+Cj
		push	0
		push	[ebp+arg_0]
		call	sub_1000E6C7
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_1000E71D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E756	proc near		; CODE XREF: sub_1000E7A7+2Ep

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000E788
		lea	eax, [ebp+var_10]
		push	eax
		push	1
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000E798
; ---------------------------------------------------------------------------

loc_1000E788:				; CODE XREF: sub_1000E756+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 1

loc_1000E798:				; CODE XREF: sub_1000E756+30j
		cmp	[ebp+var_4], 0
		jz	short locret_1000E7A5
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000E7A5:			; CODE XREF: sub_1000E756+46j
		leave
		retn
sub_1000E756	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E7A7	proc near		; CODE XREF: sasl_config_init+101p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000E7D0
		or	eax, 0FFFFFFFFh
		cmp	[ebp+arg_0], eax
		jz	short loc_1000E7C1
		movzx	eax, byte ptr [ebp+arg_0]

loc_1000E7C1:				; CODE XREF: sub_1000E7A7+14j
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 1
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E7D0:				; CODE XREF: sub_1000E7A7+Cj
		push	0
		push	[ebp+arg_0]
		call	sub_1000E756
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_1000E7A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E7DE	proc near		; CODE XREF: .text:1000E85Dp

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000E810
		lea	eax, [ebp+var_10]
		push	eax
		push	2
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000E820
; ---------------------------------------------------------------------------

loc_1000E810:				; CODE XREF: sub_1000E7DE+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 2

loc_1000E820:				; CODE XREF: sub_1000E7DE+30j
		cmp	[ebp+var_4], 0
		jz	short locret_1000E82D
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000E82D:			; CODE XREF: sub_1000E7DE+46j
		leave
		retn
sub_1000E7DE	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000E858
		or	eax, 0FFFFFFFFh
		cmp	[ebp+8], eax
		jz	short loc_1000E849
		movzx	eax, byte ptr [ebp+8]

loc_1000E849:				; CODE XREF: .text:1000E843j
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 2
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E858:				; CODE XREF: .text:1000E83Bj
		push	0
		push	dword ptr [ebp+8]
		call	sub_1000E7DE
		pop	ecx
		pop	ecx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E866	proc near		; CODE XREF: sub_1000E8B7+2Ep

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000E898
		lea	eax, [ebp+var_10]
		push	eax
		push	4
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000E8A8
; ---------------------------------------------------------------------------

loc_1000E898:				; CODE XREF: sub_1000E866+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 4

loc_1000E8A8:				; CODE XREF: sub_1000E866+30j
		cmp	[ebp+var_4], 0
		jz	short locret_1000E8B5
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000E8B5:			; CODE XREF: sub_1000E866+46j
		leave
		retn
sub_1000E866	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E8B7	proc near		; CODE XREF: sub_100057B0+97p
					; .text:1000CF7Bp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000E8E0
		or	eax, 0FFFFFFFFh
		cmp	[ebp+arg_0], eax
		jz	short loc_1000E8D1
		movzx	eax, byte ptr [ebp+arg_0]

loc_1000E8D1:				; CODE XREF: sub_1000E8B7+14j
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 4
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E8E0:				; CODE XREF: sub_1000E8B7+Cj
		push	0
		push	[ebp+arg_0]
		call	sub_1000E866
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_1000E8B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E8EE	proc near		; CODE XREF: .text:1000E974p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000E923
		lea	eax, [ebp+var_10]
		push	eax
		push	80h
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000E935
; ---------------------------------------------------------------------------

loc_1000E923:				; CODE XREF: sub_1000E8EE+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 80h

loc_1000E935:				; CODE XREF: sub_1000E8EE+33j
		cmp	[ebp+var_4], 0
		jz	short locret_1000E942
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000E942:			; CODE XREF: sub_1000E8EE+4Bj
		leave
		retn
sub_1000E8EE	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000E96F
		or	eax, 0FFFFFFFFh
		cmp	[ebp+8], eax
		jz	short loc_1000E95E
		movzx	eax, byte ptr [ebp+8]

loc_1000E95E:				; CODE XREF: .text:1000E958j
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 80h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E96F:				; CODE XREF: .text:1000E950j
		push	0
		push	dword ptr [ebp+8]
		call	sub_1000E8EE
		pop	ecx
		pop	ecx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E97D	proc near		; CODE XREF: sub_1000E9CE+2Ep

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000E9AF
		lea	eax, [ebp+var_10]
		push	eax
		push	8
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000E9BF
; ---------------------------------------------------------------------------

loc_1000E9AF:				; CODE XREF: sub_1000E97D+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 8

loc_1000E9BF:				; CODE XREF: sub_1000E97D+30j
		cmp	[ebp+var_4], 0
		jz	short locret_1000E9CC
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000E9CC:			; CODE XREF: sub_1000E97D+46j
		leave
		retn
sub_1000E97D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E9CE	proc near		; CODE XREF: sub_100019F0+136p
					; sub_100019F0+164p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000E9F7
		or	eax, 0FFFFFFFFh
		cmp	[ebp+arg_0], eax
		jz	short loc_1000E9E8
		movzx	eax, byte ptr [ebp+arg_0]

loc_1000E9E8:				; CODE XREF: sub_1000E9CE+14j
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 8
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000E9F7:				; CODE XREF: sub_1000E9CE+Cj
		push	0
		push	[ebp+arg_0]
		call	sub_1000E97D
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_1000E9CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EA05	proc near		; CODE XREF: .text:1000EA84p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000EA37
		lea	eax, [ebp+var_10]
		push	eax
		push	10h
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000EA47
; ---------------------------------------------------------------------------

loc_1000EA37:				; CODE XREF: sub_1000EA05+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 10h

loc_1000EA47:				; CODE XREF: sub_1000EA05+30j
		cmp	[ebp+var_4], 0
		jz	short locret_1000EA54
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000EA54:			; CODE XREF: sub_1000EA05+46j
		leave
		retn
sub_1000EA05	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000EA7F
		or	eax, 0FFFFFFFFh
		cmp	[ebp+8], eax
		jz	short loc_1000EA70
		movzx	eax, byte ptr [ebp+8]

loc_1000EA70:				; CODE XREF: .text:1000EA6Aj
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000EA7F:				; CODE XREF: .text:1000EA62j
		push	0
		push	dword ptr [ebp+8]
		call	sub_1000EA05
		pop	ecx
		pop	ecx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EA8D	proc near		; CODE XREF: sub_1000EAE3+30p
					; .text:1000ED2Ep

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000EAC2
		lea	eax, [ebp+var_10]
		push	eax
		push	107h
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000EAD4
; ---------------------------------------------------------------------------

loc_1000EAC2:				; CODE XREF: sub_1000EA8D+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 107h

loc_1000EAD4:				; CODE XREF: sub_1000EA8D+33j
		cmp	[ebp+var_4], 0
		jz	short locret_1000EAE1
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000EAE1:			; CODE XREF: sub_1000EA8D+4Bj
		leave
		retn
sub_1000EA8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EAE3	proc near		; CODE XREF: sub_10003A80+7Bp
					; sasl_config_init+E7p	...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000EB0E
		or	eax, 0FFFFFFFFh
		cmp	[ebp+arg_0], eax
		jz	short loc_1000EAFD
		movzx	eax, byte ptr [ebp+arg_0]

loc_1000EAFD:				; CODE XREF: sub_1000EAE3+14j
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 107h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000EB0E:				; CODE XREF: sub_1000EAE3+Cj
		push	0
		push	[ebp+arg_0]
		call	sub_1000EA8D
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_1000EAE3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EB1C	proc near		; CODE XREF: .text:1000EBA2p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000EB51
		lea	eax, [ebp+var_10]
		push	eax
		push	157h
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000EB63
; ---------------------------------------------------------------------------

loc_1000EB51:				; CODE XREF: sub_1000EB1C+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 157h

loc_1000EB63:				; CODE XREF: sub_1000EB1C+33j
		cmp	[ebp+var_4], 0
		jz	short locret_1000EB70
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000EB70:			; CODE XREF: sub_1000EB1C+4Bj
		leave
		retn
sub_1000EB1C	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000EB9D
		or	eax, 0FFFFFFFFh
		cmp	[ebp+8], eax
		jz	short loc_1000EB8C
		movzx	eax, byte ptr [ebp+8]

loc_1000EB8C:				; CODE XREF: .text:1000EB86j
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 157h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000EB9D:				; CODE XREF: .text:1000EB7Ej
		push	0
		push	dword ptr [ebp+8]
		call	sub_1000EB1C
		pop	ecx
		pop	ecx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EBAB	proc near		; CODE XREF: .text:1000EC31p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000EBE0
		lea	eax, [ebp+var_10]
		push	eax
		push	117h
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000EBF2
; ---------------------------------------------------------------------------

loc_1000EBE0:				; CODE XREF: sub_1000EBAB+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 117h

loc_1000EBF2:				; CODE XREF: sub_1000EBAB+33j
		cmp	[ebp+var_4], 0
		jz	short locret_1000EBFF
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000EBFF:			; CODE XREF: sub_1000EBAB+4Bj
		leave
		retn
sub_1000EBAB	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000EC2C
		or	eax, 0FFFFFFFFh
		cmp	[ebp+8], eax
		jz	short loc_1000EC1B
		movzx	eax, byte ptr [ebp+8]

loc_1000EC1B:				; CODE XREF: .text:1000EC15j
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 117h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000EC2C:				; CODE XREF: .text:1000EC0Dj
		push	0
		push	dword ptr [ebp+8]
		call	sub_1000EBAB
		pop	ecx
		pop	ecx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EC3A	proc near		; CODE XREF: .text:1000ECB9p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000EC6C
		lea	eax, [ebp+var_10]
		push	eax
		push	20h
		push	[ebp+arg_0]
		call	sub_10013BD0
		add	esp, 0Ch
		jmp	short loc_1000EC7C
; ---------------------------------------------------------------------------

loc_1000EC6C:				; CODE XREF: sub_1000EC3A+1Dj
		mov	eax, [eax+0C8h]
		mov	ecx, [ebp+arg_0]
		movzx	eax, word ptr [eax+ecx*2]
		and	eax, 20h

loc_1000EC7C:				; CODE XREF: sub_1000EC3A+30j
		cmp	[ebp+var_4], 0
		jz	short locret_1000EC89
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1000EC89:			; CODE XREF: sub_1000EC3A+46j
		leave
		retn
sub_1000EC3A	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000ECB4
		or	eax, 0FFFFFFFFh
		cmp	[ebp+8], eax
		jz	short loc_1000ECA5
		movzx	eax, byte ptr [ebp+8]

loc_1000ECA5:				; CODE XREF: .text:1000EC9Fj
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 20h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000ECB4:				; CODE XREF: .text:1000EC97j
		push	0
		push	dword ptr [ebp+8]
		call	sub_1000EC3A
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 80h
		sbb	eax, eax
		neg	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		and	eax, 7Fh
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_1000E6C7
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1000ECFF
		cmp	dword ptr [ebp+8], 5Fh
		jz	short loc_1000ECFF
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000ECFF:				; CODE XREF: .text:1000ECF5j
					; .text:1000ECFBj
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+8]
		call	sub_1000E71D
		pop	ecx
		test	eax, eax
		jnz	short loc_1000ED1E
		cmp	dword ptr [ebp+8], 5Fh
		jz	short loc_1000ED1E
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000ED1E:				; CODE XREF: .text:1000ED14j
					; .text:1000ED1Aj
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_1000EA8D
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1000ED41
		cmp	dword ptr [ebp+8], 5Fh
		jz	short loc_1000ED41
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000ED41:				; CODE XREF: .text:1000ED37j
					; .text:1000ED3Dj
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		movzx	eax, byte ptr [ebp+8]
		push	eax
		call	sub_1000EAE3
		pop	ecx
		test	eax, eax
		jnz	short loc_1000ED62
		cmp	byte ptr [ebp+8], 5Fh
		jz	short loc_1000ED62
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000ED62:				; CODE XREF: .text:1000ED58j
					; .text:1000ED5Ej
		xor	eax, eax
		inc	eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000ED67	proc near		; CODE XREF: .text:10001F5Dp
					; .text:10001F79p ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	0Ch
		push	offset stru_1002B1C0
		call	__SEH_prolog4
		xor	eax, eax
		xor	edi, edi
		cmp	[ebp+arg_0], edi
		setnz	al
		cmp	eax, edi
		jnz	short loc_1000ED9E
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_1000EDE2
; ---------------------------------------------------------------------------

loc_1000ED9E:				; CODE XREF: sub_1000ED67+18j
		mov	esi, offset dword_1002D2F8
		push	esi
		push	1
		call	sub_10010C85
		pop	ecx
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		push	esi
		call	sub_10013CD1
		mov	ebx, eax
		lea	eax, [ebp+arg_4]
		push	eax
		push	edi
		push	[ebp+arg_0]
		push	esi
		call	sub_10013E79
		mov	[ebp+var_1C], eax
		push	esi
		push	ebx
		call	sub_10013D65
		add	esp, 1Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1000EDED
; ---------------------------------------------------------------------------

loc_1000EDDF:				; CODE XREF: sub_1000ED67+90j
		mov	eax, [ebp+var_1C]

loc_1000EDE2:				; CODE XREF: sub_1000ED67+35j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1000EDE8:				; DATA XREF: .rdata:stru_1002B1C0o
		mov	esi, offset dword_1002D2F8 ; Finally handler 0 for function 1000ED67

loc_1000EDED:				; CODE XREF: sub_1000ED67+73j
		push	esi
		push	1
		call	sub_10010CE2
		pop	ecx
		pop	ecx
		retn
sub_1000ED67	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+10h]
		push	eax
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10014F46
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+10h]
		push	eax
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10014F63
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+0Ch]
		push	eax
		push	0
		push	dword ptr [ebp+8]
		call	sub_10014F63
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+10h]
		push	eax
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10014F80
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+0Ch]
		push	eax
		push	0
		push	dword ptr [ebp+8]
		call	sub_10014F80
		add	esp, 0Ch
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000EE73(LPVOID lpMem)
sub_1000EE73	proc near		; CODE XREF: prop_dispose+20p
					; prop_dispose+34p ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
lpMem		= dword	ptr  8

; FUNCTION CHUNK AT 1000EED2 SIZE 0000002F BYTES

		push	0Ch
		push	offset stru_1002B1E0
		call	__SEH_prolog4
		mov	esi, [ebp+lpMem]
		test	esi, esi
		jz	short loc_1000EEFB
		cmp	dword_1002F1BC,	3
		jnz	short loc_1000EED2
		push	4
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi
		call	sub_100153F5
		pop	ecx
		mov	[ebp+var_1C], eax
		test	eax, eax
		jz	short loc_1000EEB2
		push	esi
		push	eax
		call	sub_10015425
		pop	ecx
		pop	ecx

loc_1000EEB2:				; CODE XREF: sub_1000EE73+34j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1000EEC9	; Finally handler 0 for	function 1000EE73
; ---------------------------------------------------------------------------

loc_1000EEBE:				; CODE XREF: sub_1000EE73+5Ej
		cmp	[ebp+var_1C], 0
		jnz	short loc_1000EEFB
		push	[ebp+lpMem]
		jmp	short loc_1000EED3
; ---------------------------------------------------------------------------

loc_1000EEC9:				; CODE XREF: sub_1000EE73+46j
					; DATA XREF: .rdata:stru_1002B1E0o
		push	4		; Finally handler 0 for	function 1000EE73
		call	sub_100151D0
		pop	ecx
		retn
sub_1000EE73	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_1000EE73

loc_1000EED2:				; CODE XREF: sub_1000EE73+1Aj
		push	esi		; lpMem

loc_1000EED3:				; CODE XREF: sub_1000EE73+54j
		push	0		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapFree
		test	eax, eax
		jnz	short loc_1000EEFB
		call	sub_10014BF2
		mov	esi, eax
		call	ds:GetLastError
		push	eax
		call	sub_10014B76
		mov	[esi], eax
		pop	ecx

loc_1000EEFB:				; CODE XREF: sub_1000EE73+11j
					; sub_1000EE73+4Fj ...
		call	__SEH_epilog4
		retn
; END OF FUNCTION CHUNK	FOR sub_1000EE73
; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_1000EF20

loc_1000EF10:				; CODE XREF: sub_1000EF20+1Fj
		lea	eax, [edx-1]
		pop	ebx
		retn
; END OF FUNCTION CHUNK	FOR sub_1000EF20
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000EF20	proc near		; CODE XREF: auxprop_plugin_info+98p
					; sub_10002950+FDp ...

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

; FUNCTION CHUNK AT 1000EF10 SIZE 00000005 BYTES

		xor	eax, eax
		mov	al, [esp+arg_4]
		push	ebx
		mov	ebx, eax
		shl	eax, 8
		mov	edx, [esp+4+arg_0]
		test	edx, 3
		jz	short loc_1000EF4D

loc_1000EF38:				; CODE XREF: sub_1000EF20+2Bj
		mov	cl, [edx]
		add	edx, 1
		cmp	cl, bl
		jz	short loc_1000EF10
		test	cl, cl
		jz	short loc_1000EF96
		test	edx, 3
		jnz	short loc_1000EF38

loc_1000EF4D:				; CODE XREF: sub_1000EF20+16j
		or	ebx, eax
		push	edi
		mov	eax, ebx
		shl	ebx, 10h
		push	esi
		or	ebx, eax

loc_1000EF58:				; CODE XREF: sub_1000EF20+63j
					; sub_1000EF20+72j ...
		mov	ecx, [edx]
		mov	edi, 7EFEFEFFh
		mov	eax, ecx
		mov	esi, edi
		xor	ecx, ebx
		add	esi, eax
		add	edi, ecx
		xor	ecx, 0FFFFFFFFh
		xor	eax, 0FFFFFFFFh
		xor	ecx, edi
		xor	eax, esi
		add	edx, 4
		and	ecx, 81010100h
		jnz	short loc_1000EF9A
		and	eax, 81010100h
		jz	short loc_1000EF58
		and	eax, 1010100h
		jnz	short loc_1000EF94
		and	esi, 80000000h
		jnz	short loc_1000EF58

loc_1000EF94:				; CODE XREF: sub_1000EF20+6Aj
					; sub_1000EF20+83j ...
		pop	esi
		pop	edi

loc_1000EF96:				; CODE XREF: sub_1000EF20+23j
		pop	ebx
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1000EF9A:				; CODE XREF: sub_1000EF20+5Cj
		mov	eax, [edx-4]
		cmp	al, bl
		jz	short loc_1000EFD7
		test	al, al
		jz	short loc_1000EF94
		cmp	ah, bl
		jz	short loc_1000EFD0
		test	ah, ah
		jz	short loc_1000EF94
		shr	eax, 10h
		cmp	al, bl
		jz	short loc_1000EFC9
		test	al, al
		jz	short loc_1000EF94
		cmp	ah, bl
		jz	short loc_1000EFC2
		test	ah, ah
		jz	short loc_1000EF94
		jmp	short loc_1000EF58
; ---------------------------------------------------------------------------

loc_1000EFC2:				; CODE XREF: sub_1000EF20+9Aj
		pop	esi
		pop	edi
		lea	eax, [edx-1]
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000EFC9:				; CODE XREF: sub_1000EF20+92j
		lea	eax, [edx-2]
		pop	esi
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000EFD0:				; CODE XREF: sub_1000EF20+87j
		lea	eax, [edx-3]
		pop	esi
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000EFD7:				; CODE XREF: sub_1000EF20+7Fj
		lea	eax, [edx-4]
		pop	esi
		pop	edi
		pop	ebx
		retn
sub_1000EF20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000EFE0	proc near		; CODE XREF: sasl_canonuser_add_plugin+B0p
					; sub_10005DE0+51p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		push	edi
		test	ecx, ecx
		jz	loc_1000F07F
		push	esi
		push	ebx
		mov	ebx, ecx
		mov	esi, [esp+0Ch+arg_4]
		test	esi, 3
		mov	edi, [esp+0Ch+arg_0]
		jnz	short loc_1000F00C
		shr	ecx, 2
		jnz	loc_1000F08F
		jmp	short loc_1000F033
; ---------------------------------------------------------------------------

loc_1000F00C:				; CODE XREF: sub_1000EFE0+1Fj
					; sub_1000EFE0+45j
		mov	al, [esi]
		add	esi, 1
		mov	[edi], al
		add	edi, 1
		sub	ecx, 1
		jz	short loc_1000F046
		test	al, al
		jz	short loc_1000F04E
		test	esi, 3
		jnz	short loc_1000F00C
		mov	ebx, ecx
		shr	ecx, 2
		jnz	short loc_1000F08F

loc_1000F02E:				; CODE XREF: sub_1000EFE0+ADj
		and	ebx, 3
		jz	short loc_1000F046

loc_1000F033:				; CODE XREF: sub_1000EFE0+2Aj
					; sub_1000EFE0+64j
		mov	al, [esi]
		add	esi, 1
		mov	[edi], al
		add	edi, 1
		test	al, al
		jz	short loc_1000F078
		sub	ebx, 1
		jnz	short loc_1000F033

loc_1000F046:				; CODE XREF: sub_1000EFE0+39j
					; sub_1000EFE0+51j
		mov	eax, [esp+0Ch+arg_0]
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000F04E:				; CODE XREF: sub_1000EFE0+3Dj
		test	edi, 3
		jz	short loc_1000F06C

loc_1000F056:				; CODE XREF: sub_1000EFE0+8Aj
		mov	[edi], al
		add	edi, 1
		sub	ecx, 1
		jz	loc_1000F0FC
		test	edi, 3
		jnz	short loc_1000F056

loc_1000F06C:				; CODE XREF: sub_1000EFE0+74j
		mov	ebx, ecx
		shr	ecx, 2
		jnz	short loc_1000F0E7

loc_1000F073:				; CODE XREF: sub_1000EFE0+9Bj
					; sub_1000EFE0+116j
		mov	[edi], al
		add	edi, 1

loc_1000F078:				; CODE XREF: sub_1000EFE0+5Fj
		sub	ebx, 1
		jnz	short loc_1000F073
		pop	ebx
		pop	esi

loc_1000F07F:				; CODE XREF: sub_1000EFE0+7j
		mov	eax, [esp+4+arg_0]
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000F085:				; CODE XREF: sub_1000EFE0+C7j
					; sub_1000EFE0+DFj
		mov	[edi], edx
		add	edi, 4
		sub	ecx, 1
		jz	short loc_1000F02E

loc_1000F08F:				; CODE XREF: sub_1000EFE0+24j
					; sub_1000EFE0+4Cj
		mov	edx, 7EFEFEFFh
		mov	eax, [esi]
		add	edx, eax
		xor	eax, 0FFFFFFFFh
		xor	eax, edx
		mov	edx, [esi]
		add	esi, 4
		test	eax, 81010100h
		jz	short loc_1000F085
		test	dl, dl
		jz	short loc_1000F0D9
		test	dh, dh
		jz	short loc_1000F0CF
		test	edx, 0FF0000h
		jz	short loc_1000F0C5
		test	edx, 0FF000000h
		jnz	short loc_1000F085
		mov	[edi], edx
		jmp	short loc_1000F0DD
; ---------------------------------------------------------------------------

loc_1000F0C5:				; CODE XREF: sub_1000EFE0+D7j
		and	edx, 0FFFFh
		mov	[edi], edx
		jmp	short loc_1000F0DD
; ---------------------------------------------------------------------------

loc_1000F0CF:				; CODE XREF: sub_1000EFE0+CFj
		and	edx, 0FFh
		mov	[edi], edx
		jmp	short loc_1000F0DD
; ---------------------------------------------------------------------------

loc_1000F0D9:				; CODE XREF: sub_1000EFE0+CBj
		xor	edx, edx
		mov	[edi], edx

loc_1000F0DD:				; CODE XREF: sub_1000EFE0+E3j
					; sub_1000EFE0+EDj ...
		add	edi, 4
		xor	eax, eax
		sub	ecx, 1
		jz	short loc_1000F0F3

loc_1000F0E7:				; CODE XREF: sub_1000EFE0+91j
		xor	eax, eax

loc_1000F0E9:				; CODE XREF: sub_1000EFE0+111j
		mov	[edi], eax
		add	edi, 4
		sub	ecx, 1
		jnz	short loc_1000F0E9

loc_1000F0F3:				; CODE XREF: sub_1000EFE0+105j
		and	ebx, 3
		jnz	loc_1000F073

loc_1000F0FC:				; CODE XREF: sub_1000EFE0+7Ej
		mov	eax, [esp+0Ch+arg_0]
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_1000EFE0	endp

; [00000010 BYTES: COLLAPSED FUNCTION __security_check_cookie(x)]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000F114(LPVOID lpMem, SIZE_T	dwBytes)
sub_1000F114	proc near		; CODE XREF: .text:1000103Ap
					; prop_request+88p ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
lpMem		= dword	ptr  8
dwBytes		= dword	ptr  0Ch

; FUNCTION CHUNK AT 1000F261 SIZE 000000CE BYTES

		push	10h
		push	offset stru_1002B200
		call	__SEH_prolog4
		mov	ebx, [ebp+lpMem]
		test	ebx, ebx
		jnz	short loc_1000F135
		push	[ebp+dwBytes]
		call	sub_1000F5A0
		pop	ecx
		jmp	loc_1000F301
; ---------------------------------------------------------------------------

loc_1000F135:				; CODE XREF: sub_1000F114+11j
		mov	esi, [ebp+dwBytes]
		test	esi, esi
		jnz	short loc_1000F148
		push	ebx		; lpMem
		call	sub_1000EE73
		pop	ecx
		jmp	loc_1000F2FF
; ---------------------------------------------------------------------------

loc_1000F148:				; CODE XREF: sub_1000F114+26j
		cmp	dword_1002F1BC,	3
		jnz	loc_1000F2E8

loc_1000F155:				; CODE XREF: sub_1000F114+169j
		xor	edi, edi
		mov	[ebp+var_1C], edi
		cmp	esi, 0FFFFFFE0h
		ja	loc_1000F2ED
		push	4
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		push	ebx
		call	sub_100153F5
		pop	ecx
		mov	[ebp+var_20], eax
		cmp	eax, edi
		jz	loc_1000F21E
		cmp	esi, dword_1002F1AC
		ja	short loc_1000F1D1
		push	esi
		push	ebx
		push	eax
		call	sub_100158F3
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000F19C
		mov	[ebp+var_1C], ebx
		jmp	short loc_1000F1D1
; ---------------------------------------------------------------------------

loc_1000F19C:				; CODE XREF: sub_1000F114+81j
		push	esi
		call	sub_10016034
		pop	ecx
		mov	[ebp+var_1C], eax
		cmp	eax, edi
		jz	short loc_1000F1D1
		mov	eax, [ebx-4]
		dec	eax
		cmp	eax, esi
		jb	short loc_1000F1B4
		mov	eax, esi

loc_1000F1B4:				; CODE XREF: sub_1000F114+9Cj
		push	eax
		push	ebx
		push	[ebp+var_1C]
		call	sub_1000E2B0
		push	ebx
		call	sub_100153F5
		mov	[ebp+var_20], eax
		push	ebx
		push	eax
		call	sub_10015425
		add	esp, 18h

loc_1000F1D1:				; CODE XREF: sub_1000F114+72j
					; sub_1000F114+86j ...
		cmp	[ebp+var_1C], edi
		jnz	short loc_1000F21E
		cmp	esi, edi
		jnz	short loc_1000F1E0
		xor	esi, esi
		inc	esi
		mov	[ebp+dwBytes], esi

loc_1000F1E0:				; CODE XREF: sub_1000F114+C4j
		add	esi, 0Fh
		and	esi, 0FFFFFFF0h
		mov	[ebp+dwBytes], esi
		push	esi		; dwBytes
		push	edi		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapAlloc
		mov	[ebp+var_1C], eax
		cmp	eax, edi
		jz	short loc_1000F21E
		mov	eax, [ebx-4]
		dec	eax
		cmp	eax, esi
		jb	short loc_1000F208
		mov	eax, esi

loc_1000F208:				; CODE XREF: sub_1000F114+F0j
		push	eax
		push	ebx
		push	[ebp+var_1C]
		call	sub_1000E2B0
		push	ebx
		push	[ebp+var_20]
		call	sub_10015425
		add	esp, 14h

loc_1000F21E:				; CODE XREF: sub_1000F114+66j
					; sub_1000F114+C0j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1000F258
; ---------------------------------------------------------------------------

loc_1000F22A:				; CODE XREF: sub_1000F114+14Cj
		cmp	[ebp+var_20], 0
		jnz	short loc_1000F261
		test	esi, esi
		jnz	short loc_1000F235
		inc	esi

loc_1000F235:				; CODE XREF: sub_1000F114+11Ej
		add	esi, 0Fh
		and	esi, 0FFFFFFF0h
		mov	[ebp+dwBytes], esi
		push	esi		; dwBytes
		push	ebx		; lpMem
		push	0		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapReAlloc
		mov	edi, eax
		jmp	short loc_1000F264
; ---------------------------------------------------------------------------

loc_1000F252:				; DATA XREF: .rdata:stru_1002B200o
		mov	esi, [ebp+dwBytes] ; Finally handler 0 for function 1000F114
		mov	ebx, [ebp+lpMem]

loc_1000F258:				; CODE XREF: sub_1000F114+111j
		push	4
		call	sub_100151D0
		pop	ecx
		retn
sub_1000F114	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_1000F114

loc_1000F261:				; CODE XREF: sub_1000F114+11Aj
		mov	edi, [ebp+var_1C]

loc_1000F264:				; CODE XREF: sub_1000F114+13Cj
		test	edi, edi
		jnz	loc_1000F32B
		cmp	dword_1002EAD8,	edi
		jz	short loc_1000F2A0
		push	esi
		call	sub_10016456
		pop	ecx
		test	eax, eax
		jnz	loc_1000F155
		call	sub_10014BF2
		cmp	[ebp+var_20], edi
		jnz	short loc_1000F2F9

loc_1000F28D:				; CODE XREF: sub_1000F114+1F8j
		mov	esi, eax
		call	ds:GetLastError
		push	eax
		call	sub_10014B76
		pop	ecx
		mov	[esi], eax
		jmp	short loc_1000F2FF
; ---------------------------------------------------------------------------

loc_1000F2A0:				; CODE XREF: sub_1000F114+15Ej
		test	edi, edi
		jnz	loc_1000F32B
		call	sub_10014BF2
		cmp	[ebp+var_20], edi
		jz	short loc_1000F31A
		mov	dword ptr [eax], 0Ch
		jmp	short loc_1000F32B
; ---------------------------------------------------------------------------

loc_1000F2BA:				; CODE XREF: sub_1000F114+1D7j
		test	esi, esi
		jnz	short loc_1000F2BF
		inc	esi

loc_1000F2BF:				; CODE XREF: sub_1000F114+1A8j
		push	esi		; dwBytes
		push	ebx		; lpMem
		push	0		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapReAlloc
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000F32B
		cmp	dword_1002EAD8,	eax
		jz	short loc_1000F311
		push	esi
		call	sub_10016456
		pop	ecx
		test	eax, eax
		jz	short loc_1000F307

loc_1000F2E8:				; CODE XREF: sub_1000F114+3Bj
		cmp	esi, 0FFFFFFE0h
		jbe	short loc_1000F2BA

loc_1000F2ED:				; CODE XREF: sub_1000F114+49j
		push	esi
		call	sub_10016456
		pop	ecx
		call	sub_10014BF2

loc_1000F2F9:				; CODE XREF: sub_1000F114+177j
		mov	dword ptr [eax], 0Ch

loc_1000F2FF:				; CODE XREF: sub_1000F114+2Fj
					; sub_1000F114+18Aj
		xor	eax, eax

loc_1000F301:				; CODE XREF: sub_1000F114+1Cj
					; sub_1000F114+219j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1000F307:				; CODE XREF: sub_1000F114+1D2j
		call	sub_10014BF2
		jmp	loc_1000F28D
; ---------------------------------------------------------------------------

loc_1000F311:				; CODE XREF: sub_1000F114+1C7j
		test	edi, edi
		jnz	short loc_1000F32B
		call	sub_10014BF2

loc_1000F31A:				; CODE XREF: sub_1000F114+19Cj
		mov	esi, eax
		call	ds:GetLastError
		push	eax
		call	sub_10014B76
		mov	[esi], eax
		pop	ecx

loc_1000F32B:				; CODE XREF: sub_1000F114+152j
					; sub_1000F114+18Ej ...
		mov	eax, edi
		jmp	short loc_1000F301
; END OF FUNCTION CHUNK	FOR sub_1000F114

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000F32F(LPVOID lpMem, int, int)
sub_1000F32F	proc near		; CODE XREF: .text:1001D1DCp
					; sub_10020AAD+14Ep ...

lpMem		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_4]
		push	esi
		xor	esi, esi
		cmp	ecx, esi
		jbe	short loc_1000F366
		push	0FFFFFFE0h
		xor	edx, edx
		pop	eax
		div	ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_1000F366
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 0Ch
		call	sub_10014B5B
		add	esp, 14h
		xor	eax, eax
		jmp	short loc_1000F375
; ---------------------------------------------------------------------------

loc_1000F366:				; CODE XREF: sub_1000F32F+Dj
					; sub_1000F32F+19j
		imul	ecx, [ebp+arg_8]
		push	ecx		; dwBytes
		push	[ebp+lpMem]	; lpMem
		call	sub_1000F114
		pop	ecx
		pop	ecx

loc_1000F375:				; CODE XREF: sub_1000F32F+35j
		pop	esi
		pop	ebp
		retn
sub_1000F32F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F378	proc near		; CODE XREF: sub_1000F496+15p
					; sub_1001D130+11p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

; FUNCTION CHUNK AT 1000F47D SIZE 00000019 BYTES

		push	0Ch
		push	offset stru_1002B220
		call	__SEH_prolog4
		mov	ecx, [ebp+arg_0]
		xor	edi, edi
		cmp	ecx, edi
		jbe	short loc_1000F3BB
		push	0FFFFFFE0h
		pop	eax
		xor	edx, edx
		div	ecx
		cmp	eax, [ebp+arg_4]
		sbb	eax, eax
		inc	eax
		jnz	short loc_1000F3BB
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h

loc_1000F3B4:				; CODE XREF: sub_1000F378+E6j
					; sub_1000F378+F2j
		xor	eax, eax
		jmp	loc_1000F490
; ---------------------------------------------------------------------------

loc_1000F3BB:				; CODE XREF: sub_1000F378+13j
					; sub_1000F378+22j
		imul	ecx, [ebp+arg_4]
		mov	esi, ecx
		mov	[ebp+arg_0], esi
		cmp	esi, edi
		jnz	short loc_1000F3CB
		xor	esi, esi
		inc	esi

loc_1000F3CB:				; CODE XREF: sub_1000F378+4Ej
					; sub_1000F378+DBj
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		cmp	esi, 0FFFFFFE0h
		ja	short loc_1000F43E
		cmp	dword_1002F1BC,	3
		jnz	short loc_1000F429
		add	esi, 0Fh
		and	esi, 0FFFFFFF0h
		mov	[ebp+arg_4], esi
		mov	eax, [ebp+arg_0]
		cmp	eax, dword_1002F1AC
		ja	short loc_1000F429
		push	4
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		push	[ebp+arg_0]
		call	sub_10016034
		pop	ecx
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1000F474
; ---------------------------------------------------------------------------

loc_1000F415:				; CODE XREF: sub_1000F378+104j
		mov	ebx, [ebp+var_1C]
		cmp	ebx, edi
		jz	short loc_1000F42D
		push	[ebp+arg_0]
		push	edi
		push	ebx
		call	sub_1000E0F0
		add	esp, 0Ch

loc_1000F429:				; CODE XREF: sub_1000F378+64j
					; sub_1000F378+78j
		cmp	ebx, edi
		jnz	short loc_1000F48E

loc_1000F42D:				; CODE XREF: sub_1000F378+A2j
		push	esi		; dwBytes
		push	8		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapAlloc
		mov	ebx, eax

loc_1000F43E:				; CODE XREF: sub_1000F378+5Bj
		cmp	ebx, edi
		jnz	short loc_1000F48E
		cmp	dword_1002EAD8,	edi
		jz	short loc_1000F47D
		push	esi
		call	sub_10016456
		pop	ecx
		test	eax, eax
		jnz	loc_1000F3CB
		mov	eax, [ebp+arg_8]
		cmp	eax, edi
		jz	loc_1000F3B4
		mov	dword ptr [eax], 0Ch
		jmp	loc_1000F3B4
; ---------------------------------------------------------------------------

loc_1000F46F:				; DATA XREF: .rdata:stru_1002B220o
		xor	edi, edi	; Finally handler 0 for	function 1000F378
		mov	esi, [ebp+arg_4]

loc_1000F474:				; CODE XREF: sub_1000F378+98j
		push	4
		call	sub_100151D0
		pop	ecx
		retn
sub_1000F378	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_1000F378

loc_1000F47D:				; CODE XREF: sub_1000F378+D0j
		cmp	ebx, edi
		jnz	short loc_1000F48E
		mov	eax, [ebp+arg_8]
		cmp	eax, edi
		jz	short loc_1000F48E
		mov	dword ptr [eax], 0Ch

loc_1000F48E:				; CODE XREF: sub_1000F378+B3j
					; sub_1000F378+C8j ...
		mov	eax, ebx

loc_1000F490:				; CODE XREF: sub_1000F378+3Ej
		call	__SEH_epilog4
		retn
; END OF FUNCTION CHUNK	FOR sub_1000F378

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F496	proc near		; CODE XREF: .text:1000F815p
					; .text:1000FA0Cp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	edi
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1000F378
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_1000F4D2
		push	esi
		mov	esi, [ebp+var_4]
		test	esi, esi
		jz	short loc_1000F4D1
		call	sub_10014BF2
		test	eax, eax
		jz	short loc_1000F4D1
		call	sub_10014BF2
		mov	[eax], esi

loc_1000F4D1:				; CODE XREF: sub_1000F496+29j
					; sub_1000F496+32j
		pop	esi

loc_1000F4D2:				; CODE XREF: sub_1000F496+21j
		mov	eax, edi
		pop	edi
		leave
		retn
sub_1000F496	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F4D7	proc near		; CODE XREF: .text:1000F579p
					; sub_1000F5A0+59p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002B240
		call	__SEH_prolog4
		and	[ebp+var_1C], 0
		mov	esi, [ebp+arg_0]
		cmp	esi, dword_1002F1AC
		ja	short loc_1000F514
		push	4
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi
		call	sub_10016034
		pop	ecx
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1000F51D	; Finally handler 0 for	function 1000F4D7
; ---------------------------------------------------------------------------

loc_1000F514:				; CODE XREF: sub_1000F4D7+19j
					; sub_1000F4D7+4Ej
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1000F51D:				; CODE XREF: sub_1000F4D7+38j
					; DATA XREF: .rdata:stru_1002B240o
		push	4		; Finally handler 0 for	function 1000F4D7
		call	sub_100151D0
		pop	ecx
		retn
sub_1000F4D7	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	hHeap, 0
		jnz	short loc_1000F54C
		call	sub_10016988
		push	1Eh
		call	sub_100167DD
		push	0FFh
		call	sub_100164F6
; ---------------------------------------------------------------------------
		db  59h	; Y
		db  59h	; Y
; ---------------------------------------------------------------------------

loc_1000F54C:				; CODE XREF: .text:1000F532j
		mov	eax, dword_1002F1BC
		cmp	eax, 1
		jnz	short loc_1000F56F
		mov	eax, [ebp+8]
		test	eax, eax
		jnz	short loc_1000F55E
		inc	eax

loc_1000F55E:				; CODE XREF: .text:1000F55Bj
		push	eax
		push	0
		push	hHeap
		call	ds:HeapAlloc
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000F56F:				; CODE XREF: .text:1000F554j
		push	esi
		mov	esi, [ebp+8]
		cmp	eax, 3
		jnz	short loc_1000F583
		push	esi
		call	sub_1000F4D7
		pop	ecx
		test	eax, eax
		jnz	short loc_1000F59D

loc_1000F583:				; CODE XREF: .text:1000F576j
		test	esi, esi
		jnz	short loc_1000F588
		inc	esi

loc_1000F588:				; CODE XREF: .text:1000F585j
		add	esi, 0Fh
		and	esi, 0FFFFFFF0h
		push	esi
		push	0
		push	hHeap
		call	ds:HeapAlloc

loc_1000F59D:				; CODE XREF: .text:1000F581j
		pop	esi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F5A0	proc near		; CODE XREF: sub_10001000+6p
					; sub_10001050+Ap ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	esi, 0FFFFFFE0h
		ja	loc_1000F653
		push	ebx
		push	edi
		mov	edi, ds:HeapAlloc

loc_1000F5BA:				; CODE XREF: sub_1000F5A0+9Aj
		cmp	hHeap, 0
		jnz	short loc_1000F5DB
		call	sub_10016988
		push	1Eh
		call	sub_100167DD
		push	0FFh		; uExitCode
		call	sub_100164F6
; ---------------------------------------------------------------------------
		db  59h	; Y
		db  59h	; Y
; ---------------------------------------------------------------------------

loc_1000F5DB:				; CODE XREF: sub_1000F5A0+21j
		mov	eax, dword_1002F1BC
		cmp	eax, 1
		jnz	short loc_1000F5F3
		test	esi, esi
		jz	short loc_1000F5ED
		mov	eax, esi
		jmp	short loc_1000F5F0
; ---------------------------------------------------------------------------

loc_1000F5ED:				; CODE XREF: sub_1000F5A0+47j
		xor	eax, eax
		inc	eax

loc_1000F5F0:				; CODE XREF: sub_1000F5A0+4Bj
		push	eax
		jmp	short loc_1000F60F
; ---------------------------------------------------------------------------

loc_1000F5F3:				; CODE XREF: sub_1000F5A0+43j
		cmp	eax, 3
		jnz	short loc_1000F603
		push	esi
		call	sub_1000F4D7
		pop	ecx
		test	eax, eax
		jnz	short loc_1000F619

loc_1000F603:				; CODE XREF: sub_1000F5A0+56j
		test	esi, esi
		jnz	short loc_1000F608
		inc	esi

loc_1000F608:				; CODE XREF: sub_1000F5A0+65j
		add	esi, 0Fh
		and	esi, 0FFFFFFF0h
		push	esi		; dwBytes

loc_1000F60F:				; CODE XREF: sub_1000F5A0+51j
		push	0		; dwFlags
		push	hHeap		; hHeap
		call	edi ; HeapAlloc

loc_1000F619:				; CODE XREF: sub_1000F5A0+61j
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_1000F64D
		push	0Ch
		pop	esi
		cmp	dword_1002EAD8,	eax
		jz	short loc_1000F63F
		push	[ebp+arg_0]
		call	sub_10016456
		pop	ecx
		test	eax, eax
		jz	short loc_1000F646
		mov	esi, [ebp+arg_0]
		jmp	loc_1000F5BA
; ---------------------------------------------------------------------------

loc_1000F63F:				; CODE XREF: sub_1000F5A0+88j
		call	sub_10014BF2
		mov	[eax], esi

loc_1000F646:				; CODE XREF: sub_1000F5A0+95j
		call	sub_10014BF2
		mov	[eax], esi

loc_1000F64D:				; CODE XREF: sub_1000F5A0+7Dj
		pop	edi
		mov	eax, ebx
		pop	ebx
		jmp	short loc_1000F667
; ---------------------------------------------------------------------------

loc_1000F653:				; CODE XREF: sub_1000F5A0+Cj
		push	esi
		call	sub_10016456
		pop	ecx
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		xor	eax, eax

loc_1000F667:				; CODE XREF: sub_1000F5A0+B1j
		pop	esi
		pop	ebp
		retn
sub_1000F5A0	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_1000F68C
		push	dword ptr [ebp+1Ch]
		push	dword ptr [ebp+18h]
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		call	sub_10014AB5
		add	esp, 14h

loc_1000F68C:				; CODE XREF: .text:1000F673j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F68E	proc near		; CODE XREF: .text:1000F768p
					; .text:1000F7F6p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002F180,	0
		push	esi
		mov	esi, dword_1002EB00
		jnz	short loc_1000F6A7
		xor	eax, eax
		jmp	short loc_1000F715
; ---------------------------------------------------------------------------

loc_1000F6A7:				; CODE XREF: sub_1000F68E+13j
		push	ebx
		push	edi
		test	esi, esi
		jnz	short loc_1000F6C8
		cmp	dword_1002EB08,	esi
		jz	short loc_1000F711
		call	sub_10016AC9
		test	eax, eax
		jnz	short loc_1000F711
		mov	esi, dword_1002EB00
		test	esi, esi
		jz	short loc_1000F711

loc_1000F6C8:				; CODE XREF: sub_1000F68E+1Dj
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_1000F711
		lea	edx, [eax+1]

loc_1000F6D2:				; CODE XREF: sub_1000F68E+49j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000F6D2
		sub	eax, edx
		mov	edi, eax
		jmp	short loc_1000F70B
; ---------------------------------------------------------------------------

loc_1000F6DF:				; CODE XREF: sub_1000F68E+81j
		mov	eax, ecx
		lea	ebx, [eax+1]

loc_1000F6E4:				; CODE XREF: sub_1000F68E+5Bj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1000F6E4
		sub	eax, ebx
		cmp	eax, edi
		jbe	short loc_1000F708
		cmp	byte ptr [ecx+edi], 3Dh
		jnz	short loc_1000F708
		push	edi
		push	[ebp+arg_0]
		push	ecx
		call	sub_10016AAF
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000F718

loc_1000F708:				; CODE XREF: sub_1000F68E+61j
					; sub_1000F68E+67j
		add	esi, 4

loc_1000F70B:				; CODE XREF: sub_1000F68E+4Fj
		mov	ecx, [esi]
		test	ecx, ecx
		jnz	short loc_1000F6DF

loc_1000F711:				; CODE XREF: sub_1000F68E+25j
					; sub_1000F68E+2Ej ...
		xor	eax, eax

loc_1000F713:				; CODE XREF: sub_1000F68E+90j
		pop	edi
		pop	ebx

loc_1000F715:				; CODE XREF: sub_1000F68E+17j
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000F718:				; CODE XREF: sub_1000F68E+78j
		mov	eax, [esi]
		lea	eax, [eax+edi+1]
		jmp	short loc_1000F713
sub_1000F68E	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, eax
		xor	ebx, ebx
		cmp	esi, ebx
		jz	short loc_1000F73D
		mov	eax, [ebp+8]
		mov	[esi], ebx
		cmp	eax, ebx
		jz	short loc_1000F75A
		cmp	[ebp+0Ch], ebx
		ja	short loc_1000F75F

loc_1000F73D:				; CODE XREF: .text:1000F72Dj
					; .text:1000F75Dj
		call	sub_10014BF2
		push	16h
		pop	esi
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	[eax], esi
		call	sub_10014B5B
		mov	eax, esi
		add	esp, 14h

loc_1000F756:				; CODE XREF: .text:1000F774j
					; .text:1000F796j
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000F75A:				; CODE XREF: .text:1000F736j
		cmp	[ebp+0Ch], ebx
		jnz	short loc_1000F73D

loc_1000F75F:				; CODE XREF: .text:1000F73Bj
		cmp	eax, ebx
		jz	short loc_1000F765
		mov	[eax], bl

loc_1000F765:				; CODE XREF: .text:1000F761j
		push	dword ptr [ebp+10h]
		call	sub_1000F68E
		pop	ecx
		cmp	eax, ebx
		jnz	short loc_1000F776

loc_1000F772:				; CODE XREF: .text:1000F78Cj
					; .text:1000F7A9j ...
		xor	eax, eax
		jmp	short loc_1000F756
; ---------------------------------------------------------------------------

loc_1000F776:				; CODE XREF: .text:1000F770j
		mov	ecx, eax
		push	edi
		lea	edi, [ecx+1]

loc_1000F77C:				; CODE XREF: .text:1000F781j
		mov	dl, [ecx]
		inc	ecx
		cmp	dl, bl
		jnz	short loc_1000F77C
		sub	ecx, edi
		inc	ecx
		mov	[esi], ecx
		pop	edi
		cmp	[ebp+0Ch], ebx
		jz	short loc_1000F772
		cmp	ecx, [ebp+0Ch]
		jbe	short loc_1000F798
		push	22h
		pop	eax
		jmp	short loc_1000F756
; ---------------------------------------------------------------------------

loc_1000F798:				; CODE XREF: .text:1000F791j
		push	eax
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000F772
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h
		jmp	short loc_1000F772
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		xor	ebx, ebx
		push	esi
		cmp	edi, ebx
		jnz	short loc_1000F7E3

loc_1000F7C8:				; CODE XREF: .text:1000F7F1j
		call	sub_10014BF2
		push	16h
		pop	esi
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	[eax], esi
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, esi
		jmp	short loc_1000F85F
; ---------------------------------------------------------------------------

loc_1000F7E3:				; CODE XREF: .text:1000F7C6j
		mov	eax, [ebp+8]
		mov	[edi], ebx
		cmp	eax, ebx
		jz	short loc_1000F7EE
		mov	[eax], ebx

loc_1000F7EE:				; CODE XREF: .text:1000F7EAj
		cmp	[ebp+0Ch], ebx
		jz	short loc_1000F7C8
		push	dword ptr [ebp+0Ch]
		call	sub_1000F68E
		pop	ecx
		mov	[ebp-4], eax
		cmp	eax, ebx
		jz	short loc_1000F85D
		lea	esi, [eax+1]

loc_1000F806:				; CODE XREF: .text:1000F80Bj
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_1000F806
		sub	eax, esi
		lea	esi, [eax+1]
		push	1
		push	esi
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[edi], eax
		cmp	eax, ebx
		jnz	short loc_1000F836
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		call	sub_10014BF2
		mov	eax, [eax]
		jmp	short loc_1000F85F
; ---------------------------------------------------------------------------

loc_1000F836:				; CODE XREF: .text:1000F820j
		push	dword ptr [ebp-4]
		push	esi
		push	eax
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000F854
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_1000F854:				; CODE XREF: .text:1000F845j
		mov	eax, [ebp+8]
		cmp	eax, ebx
		jz	short loc_1000F85D
		mov	[eax], esi

loc_1000F85D:				; CODE XREF: .text:1000F801j
					; .text:1000F859j
		xor	eax, eax

loc_1000F85F:				; CODE XREF: .text:1000F7E1j
					; .text:1000F834j
		pop	esi
		pop	ebx
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F863	proc near		; CODE XREF: .text:1000517Bp
					; .text:100051A8p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002B260
		call	__SEH_prolog4
		xor	eax, eax
		xor	esi, esi
		cmp	[ebp+arg_0], esi
		setnz	al
		cmp	eax, esi
		jnz	short loc_1000F899
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014B5B
		add	esp, 14h
		xor	eax, eax
		jmp	short loc_1000F8BF
; ---------------------------------------------------------------------------

loc_1000F899:				; CODE XREF: sub_1000F863+18j
		push	7
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], esi
		push	[ebp+arg_0]
		call	sub_1000F68E
		pop	ecx
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1000F8C5	; Finally handler 0 for	function 1000F863
; ---------------------------------------------------------------------------

loc_1000F8BC:				; CODE XREF: sub_1000F863+6Aj
		mov	eax, [ebp+var_1C]

loc_1000F8BF:				; CODE XREF: sub_1000F863+34j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1000F8C5:				; CODE XREF: sub_1000F863+54j
					; DATA XREF: .rdata:stru_1002B260o
		push	7		; Finally handler 0 for	function 1000F863
		call	sub_100151D0
		pop	ecx
		retn
sub_1000F863	endp

; ---------------------------------------------------------------------------
		push	0Ch
		push	offset dword_1002B280
		call	__SEH_prolog4
		push	7
		call	sub_100152C7
		pop	ecx
		xor	ebx, ebx
		mov	[ebp-4], ebx
		mov	edi, [ebp+8]
		cmp	edi, ebx
		jz	short loc_1000F963
		mov	[edi], ebx
		mov	eax, [ebp+0Ch]
		cmp	eax, ebx
		jz	short loc_1000F900
		cmp	[ebp+10h], ebx
		ja	short loc_1000F905
		cmp	eax, ebx
		jnz	short loc_1000F963

loc_1000F900:				; CODE XREF: .text:1000F8F5j
		cmp	[ebp+10h], ebx
		jnz	short loc_1000F963

loc_1000F905:				; CODE XREF: .text:1000F8FAj
		cmp	eax, ebx
		jz	short loc_1000F90B
		mov	[eax], bl

loc_1000F90B:				; CODE XREF: .text:1000F907j
		push	dword ptr [ebp+14h]
		call	sub_1000F68E
		pop	ecx
		cmp	eax, ebx
		jnz	short loc_1000F91D

loc_1000F918:				; CODE XREF: .text:1000F931j
					; .text:1000F952j ...
		mov	[ebp-1Ch], ebx
		jmp	short loc_1000F97D
; ---------------------------------------------------------------------------

loc_1000F91D:				; CODE XREF: .text:1000F916j
		mov	ecx, eax
		lea	esi, [ecx+1]

loc_1000F922:				; CODE XREF: .text:1000F927j
		mov	dl, [ecx]
		inc	ecx
		cmp	dl, bl
		jnz	short loc_1000F922
		sub	ecx, esi
		inc	ecx
		mov	[edi], ecx
		cmp	[ebp+10h], ebx
		jz	short loc_1000F918
		cmp	ecx, [ebp+10h]
		jbe	short loc_1000F941
		mov	dword ptr [ebp-1Ch], 22h
		jmp	short loc_1000F97D
; ---------------------------------------------------------------------------

loc_1000F941:				; CODE XREF: .text:1000F936j
		push	eax
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		call	sub_10016B60
		add	esp, 0Ch
		cmp	eax, ebx
		jz	short loc_1000F918
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h
		jmp	short loc_1000F918
; ---------------------------------------------------------------------------

loc_1000F963:				; CODE XREF: .text:1000F8ECj
					; .text:1000F8FEj ...
		call	sub_10014BF2
		push	16h
		pop	esi
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	[eax], esi
		call	sub_10014B5B
		mov	[ebp-1Ch], esi
		add	esp, 14h

loc_1000F97D:				; CODE XREF: .text:1000F91Bj
					; .text:1000F93Fj
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_1000F992
		mov	eax, [ebp-1Ch]
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1000F992	proc near		; CODE XREF: .text:1000F984p
					; DATA XREF: .rdata:1002B298o
		push	7
		call	sub_100151D0
		pop	ecx
		retn
sub_1000F992	endp

; ---------------------------------------------------------------------------
		push	10h
		push	offset dword_1002B2A0
		call	__SEH_prolog4
		push	7
		call	sub_100152C7
		pop	ecx
		xor	ebx, ebx
		mov	[ebp-4], ebx
		mov	edi, [ebp+8]
		cmp	edi, ebx
		jnz	short loc_1000F9DA

loc_1000F9BB:				; CODE XREF: .text:1000F9E8j
		call	sub_10014BF2
		push	16h
		pop	esi
		mov	[eax], esi
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		mov	[ebp-1Ch], esi
		jmp	loc_1000FA5A
; ---------------------------------------------------------------------------

loc_1000F9DA:				; CODE XREF: .text:1000F9B9j
		mov	[edi], ebx
		mov	eax, [ebp+0Ch]
		cmp	eax, ebx
		jz	short loc_1000F9E5
		mov	[eax], ebx

loc_1000F9E5:				; CODE XREF: .text:1000F9E1j
		cmp	[ebp+10h], ebx
		jz	short loc_1000F9BB
		push	dword ptr [ebp+10h]
		call	sub_1000F68E
		pop	ecx
		mov	[ebp-20h], eax
		cmp	eax, ebx
		jz	short loc_1000FA57
		lea	esi, [eax+1]

loc_1000F9FD:				; CODE XREF: .text:1000FA02j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_1000F9FD
		sub	eax, esi
		lea	esi, [eax+1]
		push	1
		push	esi
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[edi], eax
		cmp	eax, ebx
		jnz	short loc_1000FA30
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		call	sub_10014BF2
		mov	eax, [eax]
		mov	[ebp-1Ch], eax
		jmp	short loc_1000FA5A
; ---------------------------------------------------------------------------

loc_1000FA30:				; CODE XREF: .text:1000FA17j
		push	dword ptr [ebp-20h]
		push	esi
		push	eax
		call	sub_10016B60
		add	esp, 0Ch
		cmp	eax, ebx
		jz	short loc_1000FA4E
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_1000FA4E:				; CODE XREF: .text:1000FA3Fj
		mov	eax, [ebp+0Ch]
		cmp	eax, ebx
		jz	short loc_1000FA57
		mov	[eax], esi

loc_1000FA57:				; CODE XREF: .text:1000F9F8j
					; .text:1000FA53j
		mov	[ebp-1Ch], ebx

loc_1000FA5A:				; CODE XREF: .text:1000F9D5j
					; .text:1000FA2Ej
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_1000FA6F
		mov	eax, [ebp-1Ch]
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1000FA6F	proc near		; CODE XREF: .text:1000FA61p
					; DATA XREF: .rdata:1002B2B8o
		push	7
		call	sub_100151D0
		pop	ecx
		retn
sub_1000FA6F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FA78	proc near		; CODE XREF: sasl_errdetail+6Cp
					; sasl_errdetail+CCp ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		push	ebx
		xor	ebx, ebx
		cmp	[ebp+arg_8], ebx
		jnz	short loc_1000FAA5
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_1000FB24
; ---------------------------------------------------------------------------

loc_1000FAA5:				; CODE XREF: sub_1000FA78+Ej
		mov	ecx, [ebp+arg_4]
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	ecx, ebx
		jz	short loc_1000FAD1
		cmp	esi, ebx
		jnz	short loc_1000FAD1
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_1000FB23
; ---------------------------------------------------------------------------

loc_1000FAD1:				; CODE XREF: sub_1000FA78+36j
					; sub_1000FA78+3Aj
		mov	eax, 7FFFFFFFh
		mov	[ebp+var_1C], eax
		cmp	ecx, eax
		ja	short loc_1000FAE0
		mov	[ebp+var_1C], ecx

loc_1000FAE0:				; CODE XREF: sub_1000FA78+63j
		push	edi
		lea	eax, [ebp+arg_C]
		push	eax
		push	ebx
		push	[ebp+arg_8]
		lea	eax, [ebp+var_20]
		push	eax
		mov	[ebp+var_14], 42h
		mov	[ebp+var_18], esi
		mov	[ebp+var_20], esi
		call	sub_10013E79
		add	esp, 10h
		mov	edi, eax
		cmp	esi, ebx
		jz	short loc_1000FB22
		dec	[ebp+var_1C]
		js	short loc_1000FB14
		mov	eax, [ebp+var_20]
		mov	[eax], bl
		jmp	short loc_1000FB20
; ---------------------------------------------------------------------------

loc_1000FB14:				; CODE XREF: sub_1000FA78+93j
		lea	eax, [ebp+var_20]
		push	eax
		push	ebx
		call	sub_10016BC8
		pop	ecx
		pop	ecx

loc_1000FB20:				; CODE XREF: sub_1000FA78+9Aj
		mov	eax, edi

loc_1000FB22:				; CODE XREF: sub_1000FA78+8Ej
		pop	edi

loc_1000FB23:				; CODE XREF: sub_1000FA78+57j
		pop	esi

loc_1000FB24:				; CODE XREF: sub_1000FA78+2Bj
		pop	ebx
		leave
		retn
sub_1000FA78	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+18h]
		push	eax
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10016D15
		add	esp, 14h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FB46	proc near		; CODE XREF: sub_1000FB67+44p
					; .text:1000FC0Ap

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		mov	eax, ds:dword_10029BB0
		jl	short loc_1000FB5E
		cmp	[ebp+arg_0], eax
		jge	short loc_1000FB5E
		mov	eax, [ebp+arg_0]

loc_1000FB5E:				; CODE XREF: sub_1000FB46+Ej
					; sub_1000FB46+13j
		mov	eax, ds:off_10029B00[eax*4]
		pop	ebp
		retn
sub_1000FB46	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FB67	proc near		; CODE XREF: sub_10006F30+180p
					; sasl_seterror+1A0p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		call	sub_100137AC
		mov	esi, eax
		xor	ebx, ebx
		cmp	esi, ebx
		jnz	short loc_1000FB82
		mov	eax, offset aVisualCCrtNotE ; "Visual C++ CRT: Not enough memory to co"...
		jmp	short loc_1000FBCF
; ---------------------------------------------------------------------------

loc_1000FB82:				; CODE XREF: sub_1000FB67+12j
		push	edi
		mov	edi, 86h
		cmp	[esi+24h], ebx
		jnz	short loc_1000FBA5
		push	1
		push	edi
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[esi+24h], eax
		cmp	eax, ebx
		jnz	short loc_1000FBA5
		mov	eax, offset aVisualCCrtNotE ; "Visual C++ CRT: Not enough memory to co"...
		jmp	short loc_1000FBCE
; ---------------------------------------------------------------------------

loc_1000FBA5:				; CODE XREF: sub_1000FB67+24j
					; sub_1000FB67+35j
		push	[ebp+arg_0]
		mov	esi, [esi+24h]
		call	sub_1000FB46
		push	eax
		push	edi
		push	esi
		call	sub_10016B60
		add	esp, 10h
		test	eax, eax
		jz	short loc_1000FBCC
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_1000FBCC:				; CODE XREF: sub_1000FB67+56j
		mov	eax, esi

loc_1000FBCE:				; CODE XREF: sub_1000FB67+3Cj
		pop	edi

loc_1000FBCF:				; CODE XREF: sub_1000FB67+19j
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1000FB67	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		xor	esi, esi
		push	edi
		cmp	[ebp+8], esi
		jnz	short loc_1000FBFC

loc_1000FBE1:				; CODE XREF: .text:1000FC01j
		call	sub_10014BF2
		push	16h
		pop	edi
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	[eax], edi
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, edi
		jmp	short loc_1000FC30
; ---------------------------------------------------------------------------

loc_1000FBFC:				; CODE XREF: .text:1000FBDFj
		mov	edi, [ebp+0Ch]
		cmp	edi, esi
		jbe	short loc_1000FBE1
		lea	eax, [edi-1]
		push	eax
		push	dword ptr [ebp+10h]
		call	sub_1000FB46
		pop	ecx
		push	eax
		push	edi
		push	dword ptr [ebp+8]
		call	sub_10016DF1
		add	esp, 10h
		test	eax, eax
		jz	short loc_1000FC2E
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014AB5
		add	esp, 14h

loc_1000FC2E:				; CODE XREF: .text:1000FC1Fj
		xor	eax, eax

loc_1000FC30:				; CODE XREF: .text:1000FBFAj
		pop	edi
		pop	esi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FC34	proc near		; CODE XREF: sub_1000FCAB+5Ap

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		xor	edi, edi
		or	ebx, 0FFFFFFFFh
		cmp	esi, edi
		jnz	short loc_1000FC64
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, ebx
		jmp	short loc_1000FCA6
; ---------------------------------------------------------------------------

loc_1000FC64:				; CODE XREF: sub_1000FC34+12j
		test	byte ptr [esi+0Ch], 83h
		jz	short loc_1000FCA1
		push	esi
		call	sub_100107BA
		push	esi
		mov	ebx, eax
		call	sub_1001707D
		push	esi
		call	sub_1001704B
		push	eax
		call	sub_10016F3F
		add	esp, 10h
		test	eax, eax
		jge	short loc_1000FC90
		or	ebx, 0FFFFFFFFh
		jmp	short loc_1000FCA1
; ---------------------------------------------------------------------------

loc_1000FC90:				; CODE XREF: sub_1000FC34+55j
		mov	eax, [esi+1Ch]
		cmp	eax, edi
		jz	short loc_1000FCA1
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx
		mov	[esi+1Ch], edi

loc_1000FCA1:				; CODE XREF: sub_1000FC34+34j
					; sub_1000FC34+5Aj ...
		mov	[esi+0Ch], edi
		mov	eax, ebx

loc_1000FCA6:				; CODE XREF: sub_1000FC34+2Ej
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1000FC34	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FCAB	proc near		; CODE XREF: sasl_config_init+222p
					; .text:1000A490p ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002B2C0
		call	__SEH_prolog4
		or	[ebp+var_1C], 0FFFFFFFFh
		xor	eax, eax
		mov	esi, [ebp+arg_0]
		xor	edi, edi
		cmp	esi, edi
		setnz	al
		cmp	eax, edi
		jnz	short loc_1000FCE8
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_1000FCF4
; ---------------------------------------------------------------------------

loc_1000FCE8:				; CODE XREF: sub_1000FCAB+1Ej
		test	byte ptr [esi+0Ch], 40h
		jz	short loc_1000FCFA
		mov	[esi+0Ch], edi

loc_1000FCF1:				; CODE XREF: sub_1000FCAB:loc_1000FD1Aj
		mov	eax, [ebp+var_1C]

loc_1000FCF4:				; CODE XREF: sub_1000FCAB+3Bj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1000FCFA:				; CODE XREF: sub_1000FCAB+41j
		push	esi
		call	sub_10010C50
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		push	esi
		call	sub_1000FC34
		pop	ecx
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1000FD1F
; ---------------------------------------------------------------------------

loc_1000FD1A:				; CODE XREF: sub_1000FCAB+7Bj
		jmp	short loc_1000FCF1
; ---------------------------------------------------------------------------

loc_1000FD1C:				; DATA XREF: .rdata:stru_1002B2C0o
		mov	esi, [ebp+arg_0] ; Finally handler 0 for function 1000FCAB

loc_1000FD1F:				; CODE XREF: sub_1000FCAB+6Aj
		push	esi
		call	sub_10010CAD
		pop	ecx
		retn
sub_1000FCAB	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		add	eax, 20h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FD34	proc near		; CODE XREF: sub_1000FE49+23p
					; sub_10023DAE+9Dp ...

var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
DestStr		= word ptr -8
MultiByteStr	= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	esi
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_18]
		call	sub_1000E615
		mov	ebx, [ebp+arg_0]
		mov	esi, 100h
		cmp	ebx, esi
		jnb	short loc_1000FDA9
		mov	ecx, [ebp+var_18]
		cmp	dword ptr [ecx+0ACh], 1
		jle	short loc_1000FD75
		lea	eax, [ebp+var_18]
		push	eax
		push	1
		push	ebx
		call	sub_10013BD0
		mov	ecx, [ebp+var_18]
		add	esp, 0Ch
		jmp	short loc_1000FD82
; ---------------------------------------------------------------------------

loc_1000FD75:				; CODE XREF: sub_1000FD34+2Bj
		mov	eax, [ecx+0C8h]
		movzx	eax, word ptr [eax+ebx*2]
		and	eax, 1

loc_1000FD82:				; CODE XREF: sub_1000FD34+3Fj
		test	eax, eax
		jz	short loc_1000FD95
		mov	eax, [ecx+0CCh]
		movzx	eax, byte ptr [eax+ebx]
		jmp	loc_1000FE38
; ---------------------------------------------------------------------------

loc_1000FD95:				; CODE XREF: sub_1000FD34+50j
					; sub_1000FD34+ECj
		cmp	[ebp+var_C], 0
		jz	short loc_1000FDA2
		mov	eax, [ebp+var_10]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1000FDA2:				; CODE XREF: sub_1000FD34+65j
		mov	eax, ebx
		jmp	loc_1000FE45
; ---------------------------------------------------------------------------

loc_1000FDA9:				; CODE XREF: sub_1000FD34+1Fj
		mov	eax, [ebp+var_18]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_1000FDE6
		mov	[ebp+arg_0], ebx
		sar	[ebp+arg_0], 8
		lea	eax, [ebp+var_18]
		push	eax
		mov	eax, [ebp+arg_0]
		and	eax, 0FFh
		push	eax
		call	sub_100175C6
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1000FDE6
		mov	al, byte ptr [ebp+arg_0]
		push	2
		mov	[ebp+MultiByteStr], al
		mov	[ebp+var_3], bl
		mov	[ebp+var_2], 0
		pop	ecx
		jmp	short loc_1000FDFB
; ---------------------------------------------------------------------------

loc_1000FDE6:				; CODE XREF: sub_1000FD34+7Fj
					; sub_1000FD34+9Ej
		call	sub_10014BF2
		mov	dword ptr [eax], 2Ah
		xor	ecx, ecx
		mov	[ebp+MultiByteStr], bl
		mov	[ebp+var_3], 0
		inc	ecx

loc_1000FDFB:				; CODE XREF: sub_1000FD34+B0j
		mov	eax, [ebp+var_18]
		push	1		; int
		push	dword ptr [eax+4] ; CodePage
		lea	edx, [ebp+DestStr]
		push	3		; cchDest
		push	edx		; lpDestStr
		push	ecx		; cbMultiByte
		lea	ecx, [ebp+MultiByteStr]
		push	ecx		; lpMultiByteStr
		push	esi		; dwMapFlags
		push	dword ptr [eax+14h] ; Locale
		lea	eax, [ebp+var_18]
		push	eax		; int
		call	sub_10017580
		add	esp, 24h
		test	eax, eax
		jz	loc_1000FD95
		cmp	eax, 1
		movzx	eax, byte ptr [ebp+DestStr]
		jz	short loc_1000FE38
		movzx	ecx, byte ptr [ebp+DestStr+1]
		shl	eax, 8
		or	eax, ecx

loc_1000FE38:				; CODE XREF: sub_1000FD34+5Cj
					; sub_1000FD34+F9j
		cmp	[ebp+var_C], 0
		jz	short loc_1000FE45
		mov	ecx, [ebp+var_10]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

loc_1000FE45:				; CODE XREF: sub_1000FD34+70j
					; sub_1000FD34+108j
		pop	esi
		pop	ebx
		leave
		retn
sub_1000FD34	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FE49	proc near		; CODE XREF: sasl_config_init+111p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1000FE67
		mov	eax, [ebp+arg_0]
		lea	ecx, [eax-41h]
		cmp	ecx, 19h
		ja	short loc_1000FE73
		add	eax, 20h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000FE67:				; CODE XREF: sub_1000FE49+Cj
		push	0
		push	[ebp+arg_0]
		call	sub_1000FD34
		pop	ecx
		pop	ecx

loc_1000FE73:				; CODE XREF: sub_1000FE49+17j
		pop	ebp
		retn
sub_1000FE49	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FE75	proc near		; CODE XREF: sasl_config_init+68p
					; sasl_config_init+211p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	18h
		push	offset stru_1002B2E0
		call	__SEH_prolog4
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_20], eax
		xor	ebx, ebx
		cmp	eax, ebx
		jnz	short loc_1000FEB4
		cmp	[ebp+arg_4], ebx
		jz	short loc_1000FEB4

loc_1000FE95:				; CODE XREF: sub_1000FE75+49j
					; sub_1000FE75+57j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h

loc_1000FEAD:				; CODE XREF: sub_1000FE75+5Cj
		xor	eax, eax
		jmp	loc_1000FFEB
; ---------------------------------------------------------------------------

loc_1000FEB4:				; CODE XREF: sub_1000FE75+19j
					; sub_1000FE75+1Ej
		xor	eax, eax
		cmp	[ebp+arg_4], ebx
		setnl	al
		cmp	eax, ebx
		jz	short loc_1000FE95
		xor	eax, eax
		mov	esi, [ebp+arg_8]
		cmp	esi, ebx
		setnz	al
		cmp	eax, ebx
		jz	short loc_1000FE95
		cmp	[ebp+arg_4], ebx
		jz	short loc_1000FEAD
		mov	edi, esi
		mov	[ebp+var_24], edi
		push	esi
		call	sub_10010C50
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		test	byte ptr [esi+0Ch], 40h
		jnz	loc_1000FF96
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1000FF28
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1000FF28
		push	esi
		call	sub_1001704B
		sar	eax, 5
		lea	edi, dword_1002F080[eax*4]
		push	esi
		call	sub_1001704B
		pop	ecx
		pop	ecx
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [edi]
		mov	edi, esi
		jmp	short loc_1000FF2D
; ---------------------------------------------------------------------------

loc_1000FF28:				; CODE XREF: sub_1000FE75+81j
					; sub_1000FE75+8Dj
		mov	eax, offset dword_1002DEE0

loc_1000FF2D:				; CODE XREF: sub_1000FE75+B1j
		test	byte ptr [eax+8], 3
		jnz	short loc_1000FF7B
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1000FF70
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1000FF70
		push	esi
		call	sub_1001704B
		sar	eax, 5
		lea	edi, dword_1002F080[eax*4]
		push	esi
		call	sub_1001704B
		pop	ecx
		pop	ecx
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [edi]
		mov	edi, [ebp+var_24]
		jmp	short loc_1000FF75
; ---------------------------------------------------------------------------

loc_1000FF70:				; CODE XREF: sub_1000FE75+C8j
					; sub_1000FE75+D4j
		mov	eax, offset dword_1002DEE0

loc_1000FF75:				; CODE XREF: sub_1000FE75+F9j
		test	byte ptr [eax+8], 8
		jz	short loc_1000FF96

loc_1000FF7B:				; CODE XREF: sub_1000FE75+BCj
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		mov	[ebp+var_20], ebx

loc_1000FF96:				; CODE XREF: sub_1000FE75+71j
					; sub_1000FE75+104j
		cmp	[ebp+var_20], ebx
		jz	short loc_1000FFDC

loc_1000FF9B:				; CODE XREF: sub_1000FE75+160j
		dec	[ebp+arg_4]
		jz	short loc_1000FFD7
		dec	dword ptr [edi+4]
		js	short loc_1000FFAF
		mov	ecx, [edi]
		movzx	eax, byte ptr [ecx]
		inc	ecx
		mov	[edi], ecx
		jmp	short loc_1000FFB6
; ---------------------------------------------------------------------------

loc_1000FFAF:				; CODE XREF: sub_1000FE75+12Ej
		push	edi
		call	sub_100178B1
		pop	ecx

loc_1000FFB6:				; CODE XREF: sub_1000FE75+138j
		mov	[ebp+var_28], eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000FFCB
		mov	eax, [ebp+var_1C]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_1000FFDA
		mov	[ebp+var_20], ebx
		jmp	short loc_1000FFDC
; ---------------------------------------------------------------------------

loc_1000FFCB:				; CODE XREF: sub_1000FE75+147j
		mov	ecx, [ebp+var_1C]
		mov	[ecx], al
		inc	[ebp+var_1C]
		cmp	al, 0Ah
		jnz	short loc_1000FF9B

loc_1000FFD7:				; CODE XREF: sub_1000FE75+129j
		mov	eax, [ebp+var_1C]

loc_1000FFDA:				; CODE XREF: sub_1000FE75+14Fj
		mov	[eax], bl

loc_1000FFDC:				; CODE XREF: sub_1000FE75+124j
					; sub_1000FE75+154j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1000FFF4
; ---------------------------------------------------------------------------

loc_1000FFE8:				; CODE XREF: sub_1000FE75+186j
		mov	eax, [ebp+var_20]

loc_1000FFEB:				; CODE XREF: sub_1000FE75+3Aj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1000FFF1:				; DATA XREF: .rdata:stru_1002B2E0o
		mov	edi, [ebp+var_24] ; Finally handler 0 for function 1000FE75

loc_1000FFF4:				; CODE XREF: sub_1000FE75+16Ej
		push	edi
		call	sub_10010CAD
		pop	ecx
		retn
sub_1000FE75	endp

; ---------------------------------------------------------------------------
		db 0CCh

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FFFD	proc near		; CODE XREF: sub_100100D1+Dp
					; .text:1001011Ep

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	0Ch
		push	offset stru_1002B300
		call	__SEH_prolog4
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		xor	eax, eax
		mov	edi, [ebp+arg_0]
		cmp	edi, ebx
		setnz	al
		cmp	eax, ebx
		jnz	short loc_1001002E
		call	sub_10014BF2
		mov	dword ptr [eax], 16h

loc_10010027:				; CODE XREF: sub_1000FFFD+57j
					; sub_1000FFFD+7Bj ...
		xor	eax, eax
		jmp	loc_100100C1
; ---------------------------------------------------------------------------

loc_1001002E:				; CODE XREF: sub_1000FFFD+1Dj
		xor	eax, eax
		mov	esi, [ebp+arg_4]
		cmp	esi, ebx
		setnz	al
		cmp	eax, ebx
		jnz	short loc_10010056

loc_1001003C:				; CODE XREF: sub_1000FFFD+62j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10010027
; ---------------------------------------------------------------------------

loc_10010056:				; CODE XREF: sub_1000FFFD+3Dj
		xor	eax, eax
		cmp	[esi], bl
		setnz	al
		cmp	eax, ebx
		jz	short loc_1001003C
		call	sub_10017F09
		mov	[ebp+arg_0], eax
		cmp	eax, ebx
		jnz	short loc_1001007A
		call	sub_10014BF2
		mov	dword ptr [eax], 18h
		jmp	short loc_10010027
; ---------------------------------------------------------------------------

loc_1001007A:				; CODE XREF: sub_1000FFFD+6Ej
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		cmp	[edi], bl
		jnz	short loc_100100A1
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	0FFFFFFFEh
		lea	eax, [ebp+ms_exc.registration]
		push	eax
		push	offset ___security_cookie
		call	sub_10018030
		add	esp, 0Ch
		jmp	short loc_10010027
; ---------------------------------------------------------------------------

loc_100100A1:				; CODE XREF: sub_1000FFFD+82j
		push	eax
		push	[ebp+arg_8]
		push	esi
		push	edi
		call	sub_10017C64
		add	esp, 10h
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_100100C7	; Finally handler 0 for	function 1000FFFD
; ---------------------------------------------------------------------------

loc_100100BE:				; CODE XREF: sub_1000FFFD+D3j
		mov	eax, [ebp+var_1C]

loc_100100C1:				; CODE XREF: sub_1000FFFD+2Cj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_100100C7:				; CODE XREF: sub_1000FFFD+BCj
					; DATA XREF: .rdata:stru_1002B300o
		push	[ebp+arg_0]	; Finally handler 0 for	function 1000FFFD
		call	sub_10010CAD
		pop	ecx
		retn
sub_1000FFFD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100100D1	proc near		; CODE XREF: sasl_config_init+2Fp
					; .text:1000A312p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	40h
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1000FFFD
		add	esp, 0Ch
		pop	ebp
		retn
sub_100100D1	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+8]
		xor	esi, esi
		cmp	edi, esi
		jnz	short loc_10010113
		call	sub_10014BF2
		push	16h
		pop	edi
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	[eax], edi
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, edi
		jmp	short loc_10010137
; ---------------------------------------------------------------------------

loc_10010113:				; CODE XREF: .text:100100F6j
		push	80h
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		call	sub_1000FFFD
		add	esp, 0Ch
		mov	[edi], eax
		cmp	eax, esi
		jz	short loc_10010130
		xor	eax, eax
		jmp	short loc_10010137
; ---------------------------------------------------------------------------

loc_10010130:				; CODE XREF: .text:1001012Aj
		call	sub_10014BF2
		mov	eax, [eax]

loc_10010137:				; CODE XREF: .text:10010111j
					; .text:1001012Ej
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h
; [0000002B BYTES: COLLAPSED FUNCTION __alloca_probe]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001016B	proc near		; CODE XREF: .text:10009242p
					; sub_100092F0+24p

SystemTimeAsFileTime= _FILETIME	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	edi
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		push	1
		push	0
		push	0
		push	[ebp+SystemTimeAsFileTime.dwHighDateTime]
		call	sub_10018200
		sub	eax, dword_1002E5D8
		mov	ecx, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		sbb	edx, dword_1002E5DC
		xor	edi, edi
		push	edi
		add	eax, ecx
		push	2710h
		adc	edx, edi
		push	edx
		push	eax
		call	sub_10018190
		pop	edi
		leave
		retn
sub_1001016B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100101B0	proc near		; DATA XREF: .rdata:100271ECo

SystemTimeAsFileTime= _FILETIME	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		push	1
		push	0
		push	0
		push	[ebp+SystemTimeAsFileTime.dwHighDateTime]
		call	sub_10018200
		mov	ecx, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		xor	esi, esi
		add	eax, ecx
		adc	edx, esi
		mov	dword_1002E5D8,	eax
		mov	dword_1002E5DC,	edx
		xor	eax, eax
		pop	esi
		leave
		retn
sub_100101B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100101E9	proc near		; CODE XREF: sub_10010224+6j

SystemTimeAsFileTime= _FILETIME	ptr -8
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		mov	eax, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		mov	ecx, [ebp+SystemTimeAsFileTime.dwHighDateTime]
		push	0
		add	eax, 2AC18000h
		push	989680h
		adc	ecx, 0FE624E21h
		push	ecx
		push	eax
		call	sub_10018190
		mov	ecx, [ebp+arg_0]
		test	ecx, ecx
		jz	short locret_10010222
		mov	[ecx], eax

locret_10010222:			; CODE XREF: sub_100101E9+35j
		leave
		retn
sub_100101E9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010224	proc near		; CODE XREF: .text:1000922Ep
					; sub_100092F0+13p ...
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	sub_100101E9
sub_10010224	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001022F	proc near		; CODE XREF: sub_100092F0+37p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		call	sub_10013828
		mov	ecx, [ebp+arg_0]
		mov	[eax+14h], ecx
		pop	ebp
		retn
sub_1001022F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010241	proc near		; CODE XREF: sasl_rand+33p
		call	sub_10013828
		mov	ecx, [eax+14h]
		imul	ecx, 343FDh
		add	ecx, 269EC3h
		mov	[eax+14h], ecx
		mov	eax, ecx
		shr	eax, 10h
		and	eax, 7FFFh
		retn
sub_10010241	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010263	proc near		; CODE XREF: sub_1001679B+17p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	Target,	eax
		pop	ebp
		retn
sub_10010263	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010272	proc near		; CODE XREF: sasl_rand+27p

hLibModule	= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		push	edi
		push	Target
		call	sub_100135C4
		mov	edi, eax
		mov	eax, [ebp+arg_0]
		xor	esi, esi
		pop	ecx
		cmp	eax, esi
		jnz	short loc_100102AF
		call	sub_10014BF2
		push	16h
		pop	edi
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	[eax], edi
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, edi
		jmp	loc_10010378
; ---------------------------------------------------------------------------

loc_100102AF:				; CODE XREF: sub_10010272+1Dj
		push	ebx
		mov	[eax], esi
		cmp	edi, esi
		jnz	loc_10010356
		push	esi		; dwFlags
		push	esi		; hFile
		push	offset LibFileName ; "ADVAPI32.DLL"
		call	ds:LoadLibraryExA
		mov	[ebp+hLibModule], eax
		cmp	eax, esi
		jnz	short loc_100102EC
		call	sub_10014BF2
		push	16h
		pop	edi
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	[eax], edi
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, edi
		jmp	loc_10010377
; ---------------------------------------------------------------------------

loc_100102EC:				; CODE XREF: sub_10010272+5Aj
		push	offset ProcName	; "SystemFunction036"
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	edi, eax
		cmp	edi, esi
		jnz	short loc_1001032D
		call	sub_10014BF2
		mov	edi, ds:GetLastError
		mov	ebx, eax
		call	edi ; GetLastError
		push	eax
		call	sub_10014B76
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	[ebx], eax
		call	sub_10014B5B
		add	esp, 18h
		call	edi ; GetLastError
		push	eax
		call	sub_10014B76
		pop	ecx
		jmp	short loc_10010377
; ---------------------------------------------------------------------------

loc_1001032D:				; CODE XREF: sub_10010272+8Aj
		push	edi
		call	sub_10013548
		pop	ecx
		mov	esi, eax
		call	sub_100135BB
		push	esi		; Value
		push	offset Target	; Target
		mov	ebx, eax
		call	ds:InterlockedExchange
		cmp	eax, ebx
		jz	short loc_10010356
		push	[ebp+hLibModule] ; hLibModule
		call	ds:FreeLibrary

loc_10010356:				; CODE XREF: sub_10010272+42j
					; sub_10010272+D9j
		push	4
		push	[ebp+arg_0]
		call	edi
		test	eax, eax
		jnz	short loc_10010375
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		call	sub_10014BF2
		mov	eax, [eax]
		jmp	short loc_10010377
; ---------------------------------------------------------------------------

loc_10010375:				; CODE XREF: sub_10010272+EDj
		xor	eax, eax

loc_10010377:				; CODE XREF: sub_10010272+75j
					; sub_10010272+B9j ...
		pop	ebx

loc_10010378:				; CODE XREF: sub_10010272+38j
		pop	edi
		pop	esi
		leave
		retn
sub_10010272	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001037C	proc near		; CODE XREF: sub_100170CC+11Cp
					; sub_100170CC+223p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_10010390
		mov	ecx, [ebp+arg_4]
		mov	[eax], ecx
		add	eax, 8

loc_10010390:				; CODE XREF: sub_1001037C+Aj
		pop	ebp
		retn
sub_1001037C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010392	proc near		; CODE XREF: sub_10010592+10Bp
					; sub_100170CC+2C9p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_100103B0
		sub	eax, 8
		cmp	dword ptr [eax], 0DDDDh
		jnz	short loc_100103B0
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_100103B0:				; CODE XREF: sub_10010392+Aj
					; sub_10010392+15j
		pop	ebp
		retn
sub_10010392	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100103B2	proc near		; CODE XREF: .text:100106D7p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100103D4
		cmp	dword_1002D2D0,	0FFFFFFFFh
		jnz	short loc_100103D4
		and	eax, 0FFh
		mov	dword_1002D2D0,	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100103D4:				; CODE XREF: sub_100103B2+Bj
					; sub_100103B2+14j
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
sub_100103B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100103D9	proc near		; CODE XREF: sub_1001048C+86p
					; sub_10010592+EEp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_0]
		push	ebx
		mov	ebx, [edx+0Ch]
		push	esi
		test	ebx, 100h
		jz	short loc_10010440
		movzx	edx, word ptr [edx+8]
		xor	eax, eax
		xor	ecx, ecx
		xor	esi, esi

loc_100103F8:				; CODE XREF: sub_100103D9+2Fj
		cmp	ds:word_10028C28[esi], dx
		jz	short loc_1001040C
		add	esi, 0Ah
		inc	ecx
		cmp	esi, 78h
		jb	short loc_100103F8
		jmp	short loc_10010488
; ---------------------------------------------------------------------------

loc_1001040C:				; CODE XREF: sub_100103D9+26j
		imul	ecx, 0Ah
		test	bl, 3
		jz	short loc_1001041C
		add	ecx, offset dword_10028C30
		jmp	short loc_1001043C
; ---------------------------------------------------------------------------

loc_1001041C:				; CODE XREF: sub_100103D9+39j
		test	bl, 0Ch
		jz	short loc_10010429
		add	ecx, offset word_10028C2E
		jmp	short loc_1001043C
; ---------------------------------------------------------------------------

loc_10010429:				; CODE XREF: sub_100103D9+46j
		test	bl, 10h
		jz	short loc_10010436
		add	ecx, offset byte_10028C2C
		jmp	short loc_1001043C
; ---------------------------------------------------------------------------

loc_10010436:				; CODE XREF: sub_100103D9+53j
		add	ecx, offset word_10028C2A

loc_1001043C:				; CODE XREF: sub_100103D9+41j
					; sub_100103D9+4Ej ...
		mov	eax, ecx
		jmp	short loc_10010488
; ---------------------------------------------------------------------------

loc_10010440:				; CODE XREF: sub_100103D9+13j
		movzx	eax, word ptr [edx+8]
		test	bl, 3
		jz	short loc_10010452
		lea	eax, word_10028CA6[eax*8]
		jmp	short loc_10010475
; ---------------------------------------------------------------------------

loc_10010452:				; CODE XREF: sub_100103D9+6Ej
		test	bl, 0Ch
		jz	short loc_10010460
		lea	eax, byte_10028CA4[eax*8]
		jmp	short loc_10010475
; ---------------------------------------------------------------------------

loc_10010460:				; CODE XREF: sub_100103D9+7Cj
		test	bl, 10h
		jz	short loc_1001046E
		lea	eax, word_10028CA2[eax*8]
		jmp	short loc_10010475
; ---------------------------------------------------------------------------

loc_1001046E:				; CODE XREF: sub_100103D9+8Aj
		lea	eax, byte_10028CA0[eax*8]

loc_10010475:				; CODE XREF: sub_100103D9+77j
					; sub_100103D9+85j ...
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_10010480
		cmp	cl, 0E0h
		jnz	short loc_10010486

loc_10010480:				; CODE XREF: sub_100103D9+A0j
		cmp	byte ptr [eax+1], 0
		jnz	short loc_10010488

loc_10010486:				; CODE XREF: sub_100103D9+A5j
		xor	eax, eax

loc_10010488:				; CODE XREF: sub_100103D9+31j
					; sub_100103D9+65j ...
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_100103D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001048C	proc near		; CODE XREF: sub_1001055B+16p
					; sub_10010700+18p

Buffer		= _INPUT_RECORD	ptr -1Ch
NumberOfEventsRead= dword ptr -8
Mode		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, dword_1002D2D0
		and	[ebp+Mode], 0
		push	esi
		or	esi, 0FFFFFFFFh
		cmp	eax, esi
		jz	short loc_100104B3
		movzx	eax, al
		mov	dword_1002D2D0,	esi
		jmp	loc_1001054A
; ---------------------------------------------------------------------------

loc_100104B3:				; CODE XREF: sub_1001048C+17j
		cmp	hConsoleInput, 0FFFFFFFEh
		jnz	short loc_100104C1
		call	sub_10018234

loc_100104C1:				; CODE XREF: sub_1001048C+2Ej
		mov	eax, hConsoleInput
		cmp	eax, esi
		jnz	short loc_100104CE
		mov	eax, esi
		jmp	short loc_1001054A
; ---------------------------------------------------------------------------

loc_100104CE:				; CODE XREF: sub_1001048C+3Cj
		push	ebx
		push	edi
		lea	ecx, [ebp+Mode]
		push	ecx		; lpMode
		push	eax		; hConsoleHandle
		call	ds:GetConsoleMode
		mov	ebx, ds:SetConsoleMode
		push	0		; dwMode
		push	hConsoleInput	; hConsoleHandle
		call	ebx ; SetConsoleMode
		mov	esi, ds:ReadConsoleInputA
		jmp	short loc_1001051C
; ---------------------------------------------------------------------------

loc_100104F3:				; CODE XREF: sub_1001048C+A4j
		cmp	[ebp+NumberOfEventsRead], 0
		jz	short loc_10010532
		cmp	[ebp+Buffer.EventType],	1
		jnz	short loc_1001051C
		cmp	dword ptr [ebp+Buffer.Event], 0
		jz	short loc_1001051C
		movzx	edi, byte ptr [ebp+Buffer.Event+0Ah]
		test	edi, edi
		jnz	short loc_10010535
		lea	eax, [ebp+Buffer.Event]
		push	eax
		call	sub_100103D9
		pop	ecx
		test	eax, eax
		jnz	short loc_1001054D

loc_1001051C:				; CODE XREF: sub_1001048C+65j
					; sub_1001048C+72j ...
		lea	eax, [ebp+NumberOfEventsRead]
		push	eax		; lpNumberOfEventsRead
		push	1		; nLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	hConsoleInput	; hConsoleInput
		call	esi ; ReadConsoleInputA
		test	eax, eax
		jnz	short loc_100104F3

loc_10010532:				; CODE XREF: sub_1001048C+6Bj
		or	edi, 0FFFFFFFFh

loc_10010535:				; CODE XREF: sub_1001048C+80j
					; sub_1001048C+CDj
		cmp	[ebp+Mode], 0
		jz	short loc_10010546
		push	[ebp+Mode]	; dwMode
		push	hConsoleInput	; hConsoleHandle
		call	ebx ; SetConsoleMode

loc_10010546:				; CODE XREF: sub_1001048C+ADj
		mov	eax, edi
		pop	edi
		pop	ebx

loc_1001054A:				; CODE XREF: sub_1001048C+22j
					; sub_1001048C+40j
		pop	esi
		leave
		retn
; ---------------------------------------------------------------------------

loc_1001054D:				; CODE XREF: sub_1001048C+8Ej
		movzx	edi, byte ptr [eax]
		movzx	eax, byte ptr [eax+1]
		mov	dword_1002D2D0,	eax
		jmp	short loc_10010535
sub_1001048C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001055B	proc near		; CODE XREF: .text:10010756p
		mov	eax, dword_1002D2D0
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10010570
		movzx	eax, al
		or	dword_1002D2D0,	0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10010570:				; CODE XREF: sub_1001055B+8j
		push	edi
		call	sub_1001048C
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jz	short loc_1001058D
		push	edi
		call	sub_1001829F
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001058D
		mov	eax, edi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1001058D:				; CODE XREF: sub_1001055B+20j
					; sub_1001055B+2Cj
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
sub_1001055B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010592	proc near		; CODE XREF: .text:10010794p

var_10		= dword	ptr -10h
NumberOfEventsRead= dword ptr -0Ch
NumberOfEvents	= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+var_10], 0
		cmp	dword_1002D2D0,	0FFFFFFFFh
		push	ebx
		push	esi
		push	edi
		jz	short loc_100105BC
		xor	eax, eax
		inc	eax
		jmp	loc_100106AA
; ---------------------------------------------------------------------------

loc_100105BC:				; CODE XREF: sub_10010592+20j
		cmp	hConsoleInput, 0FFFFFFFEh
		jnz	short loc_100105CA
		call	sub_10018234

loc_100105CA:				; CODE XREF: sub_10010592+31j
		mov	eax, hConsoleInput
		cmp	eax, 0FFFFFFFFh
		jz	loc_100106A8
		lea	ecx, [ebp+NumberOfEvents]
		push	ecx		; lpNumberOfEvents
		push	eax		; hConsoleInput
		call	ds:GetNumberOfConsoleInputEvents
		test	eax, eax
		jz	loc_100106A8
		mov	ecx, [ebp+NumberOfEvents]
		test	ecx, ecx
		jz	loc_100106A8
		jbe	short loc_1001063C
		push	0FFFFFFE0h
		xor	edx, edx
		pop	eax
		div	ecx
		cmp	eax, 14h
		jb	short loc_1001063C
		imul	ecx, 14h
		lea	eax, [ecx+8]
		cmp	eax, 400h
		ja	short loc_10010624
		call	__alloca_probe_16
		mov	eax, esp
		test	eax, eax
		jz	short loc_10010638
		mov	dword ptr [eax], 0CCCCh
		jmp	short loc_10010635
; ---------------------------------------------------------------------------

loc_10010624:				; CODE XREF: sub_10010592+7Dj
		push	eax
		call	sub_1000F5A0
		pop	ecx
		test	eax, eax
		jz	short loc_10010638
		mov	dword ptr [eax], 0DDDDh

loc_10010635:				; CODE XREF: sub_10010592+90j
		add	eax, 8

loc_10010638:				; CODE XREF: sub_10010592+88j
					; sub_10010592+9Bj
		mov	ebx, eax
		jmp	short loc_1001063E
; ---------------------------------------------------------------------------

loc_1001063C:				; CODE XREF: sub_10010592+64j
					; sub_10010592+70j
		xor	ebx, ebx

loc_1001063E:				; CODE XREF: sub_10010592+A8j
		test	ebx, ebx
		jz	short loc_100106A8
		lea	eax, [ebp+NumberOfEventsRead]
		push	eax		; lpNumberOfEventsRead
		push	[ebp+NumberOfEvents] ; nLength
		push	ebx		; lpBuffer
		push	hConsoleInput	; hConsoleInput
		call	ds:PeekConsoleInputA
		test	eax, eax
		jz	short loc_1001069C
		mov	edi, [ebp+NumberOfEventsRead]
		test	edi, edi
		jz	short loc_1001069C
		cmp	edi, [ebp+NumberOfEvents]
		ja	short loc_1001069C
		test	edi, edi
		jbe	short loc_1001069C
		lea	esi, [ebx+4]

loc_1001066D:				; CODE XREF: sub_10010592+108j
		cmp	word ptr [esi-4], 1
		jnz	short loc_10010691
		cmp	dword ptr [esi], 0
		jz	short loc_10010691
		cmp	byte ptr [esi+0Ah], 0
		jnz	short loc_1001068A
		push	esi
		call	sub_100103D9
		pop	ecx
		test	eax, eax
		jz	short loc_10010691

loc_1001068A:				; CODE XREF: sub_10010592+EBj
		mov	[ebp+var_10], 1

loc_10010691:				; CODE XREF: sub_10010592+E0j
					; sub_10010592+E5j ...
		dec	edi
		add	esi, 14h
		mov	[ebp+NumberOfEventsRead], edi
		test	edi, edi
		ja	short loc_1001066D

loc_1001069C:				; CODE XREF: sub_10010592+C6j
					; sub_10010592+CDj ...
		push	ebx
		call	sub_10010392
		mov	eax, [ebp+var_10]
		pop	ecx
		jmp	short loc_100106AA
; ---------------------------------------------------------------------------

loc_100106A8:				; CODE XREF: sub_10010592+40j
					; sub_10010592+53j ...
		xor	eax, eax

loc_100106AA:				; CODE XREF: sub_10010592+25j
					; sub_10010592+114j
		lea	esp, [ebp-1Ch]
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10010592	endp

; ---------------------------------------------------------------------------
		push	0Ch
		push	offset dword_1002B320
		call	__SEH_prolog4
		push	3
		call	sub_100152C7
		pop	ecx
		and	dword ptr [ebp-4], 0
		push	dword ptr [ebp+8]
		call	sub_100103B2
		add	esp, 4
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_100106F7
		mov	eax, [ebp-1Ch]
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_100106F7	proc near		; CODE XREF: .text:100106E9p
					; DATA XREF: .rdata:1002B338o
		push	3
		call	sub_100151D0
		pop	ecx
		retn
sub_100106F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010700	proc near		; CODE XREF: getpass+27p
					; getpass:loc_100096D1p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	0Ch
		push	offset stru_1002B340
		call	__SEH_prolog4
		push	3
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		call	sub_1001048C
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10010735	; Finally handler 0 for	function 10010700
; ---------------------------------------------------------------------------

loc_1001072C:				; CODE XREF: sub_10010700+3Dj
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10010735:				; CODE XREF: sub_10010700+27j
					; DATA XREF: .rdata:stru_1002B340o
		push	3		; Finally handler 0 for	function 10010700
		call	sub_100151D0
		pop	ecx
		retn
sub_10010700	endp

; ---------------------------------------------------------------------------
		push	0Ch
		push	offset dword_1002B360
		call	__SEH_prolog4
		push	3
		call	sub_100152C7
		pop	ecx
		and	dword ptr [ebp-4], 0
		call	sub_1001055B
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10010773
		mov	eax, [ebp-1Ch]
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10010773	proc near		; CODE XREF: .text:10010765p
					; DATA XREF: .rdata:1002B378o
		push	3
		call	sub_100151D0
		pop	ecx
		retn
sub_10010773	endp

; ---------------------------------------------------------------------------
		push	0Ch
		push	offset dword_1002B380
		call	__SEH_prolog4
		push	3
		call	sub_100152C7
		pop	ecx
		and	dword ptr [ebp-4], 0
		call	sub_10010592
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_100107B1
		mov	eax, [ebp-1Ch]
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_100107B1	proc near		; CODE XREF: .text:100107A3p
					; DATA XREF: .rdata:1002B398o
		push	3
		call	sub_100151D0
		pop	ecx
		retn
sub_100107B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100107BA	proc near		; CODE XREF: sub_1000FC34+37p
					; sub_10010822+17p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	eax, [esi+0Ch]
		mov	ecx, eax
		and	cl, 3
		xor	ebx, ebx
		cmp	cl, 2
		jnz	short loc_10010813
		test	eax, 108h
		jz	short loc_10010813
		mov	eax, [esi+8]
		push	edi
		mov	edi, [esi]
		sub	edi, eax
		test	edi, edi
		jle	short loc_10010812
		push	edi		; nNumberOfBytesToWrite
		push	eax		; int
		push	esi
		call	sub_1001704B
		pop	ecx
		push	eax		; int
		call	sub_10018A68
		add	esp, 0Ch
		cmp	eax, edi
		jnz	short loc_1001080B
		mov	eax, [esi+0Ch]
		test	al, al
		jns	short loc_10010812
		and	eax, 0FFFFFFFDh
		mov	[esi+0Ch], eax
		jmp	short loc_10010812
; ---------------------------------------------------------------------------

loc_1001080B:				; CODE XREF: sub_100107BA+40j
		or	dword ptr [esi+0Ch], 20h
		or	ebx, 0FFFFFFFFh

loc_10010812:				; CODE XREF: sub_100107BA+2Aj
					; sub_100107BA+47j ...
		pop	edi

loc_10010813:				; CODE XREF: sub_100107BA+17j
					; sub_100107BA+1Ej
		mov	eax, [esi+8]
		and	dword ptr [esi+4], 0
		mov	[esi], eax
		pop	esi
		mov	eax, ebx
		pop	ebx
		pop	ebp
		retn
sub_100107BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010822	proc near		; CODE XREF: sub_1001086A+69p
					; sub_1001086A+84p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		test	esi, esi
		jnz	short loc_10010838
		push	esi
		call	sub_1001086A
		pop	ecx
		jmp	short loc_10010867
; ---------------------------------------------------------------------------

loc_10010838:				; CODE XREF: sub_10010822+Bj
		push	esi
		call	sub_100107BA
		pop	ecx
		test	eax, eax
		jz	short loc_10010848
		or	eax, 0FFFFFFFFh
		jmp	short loc_10010867
; ---------------------------------------------------------------------------

loc_10010848:				; CODE XREF: sub_10010822+1Fj
		test	dword ptr [esi+0Ch], 4000h
		jz	short loc_10010865
		push	esi
		call	sub_1001704B
		push	eax
		call	sub_10018B44
		pop	ecx
		neg	eax
		pop	ecx
		sbb	eax, eax
		jmp	short loc_10010867
; ---------------------------------------------------------------------------

loc_10010865:				; CODE XREF: sub_10010822+2Dj
		xor	eax, eax

loc_10010867:				; CODE XREF: sub_10010822+14j
					; sub_10010822+24j ...
		pop	esi
		pop	ebp
		retn
sub_10010822	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001086A	proc near		; CODE XREF: sub_10010822+Ep
					; sub_10010944+14p ...

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

; FUNCTION CHUNK AT 1001091D SIZE 00000027 BYTES

		push	14h
		push	offset stru_1002B3A0
		call	__SEH_prolog4
		xor	edi, edi
		mov	[ebp+var_1C], edi
		mov	[ebp+var_24], edi
		push	1
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		xor	esi, esi

loc_1001088B:				; CODE XREF: sub_1001086A+9Bj
		mov	[ebp+var_20], esi
		cmp	esi, dword_100301E0
		jge	loc_1001091D
		mov	eax, dword_1002F1D8
		lea	eax, [eax+esi*4]
		cmp	[eax], edi
		jz	short loc_10010904
		mov	eax, [eax]
		test	byte ptr [eax+0Ch], 83h
		jz	short loc_10010904
		push	eax
		push	esi
		call	sub_10010C85
		pop	ecx
		pop	ecx
		xor	edx, edx
		inc	edx
		mov	[ebp+ms_exc.registration.TryLevel], edx
		mov	eax, dword_1002F1D8
		mov	eax, [eax+esi*4]
		mov	ecx, [eax+0Ch]
		test	cl, 83h
		jz	short loc_100108FC
		cmp	[ebp+arg_0], edx
		jnz	short loc_100108E3
		push	eax
		call	sub_10010822
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100108FC
		inc	[ebp+var_1C]
		jmp	short loc_100108FC
; ---------------------------------------------------------------------------

loc_100108E3:				; CODE XREF: sub_1001086A+66j
		cmp	[ebp+arg_0], edi
		jnz	short loc_100108FC
		test	cl, 2
		jz	short loc_100108FC
		push	eax
		call	sub_10010822
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100108FC
		or	[ebp+var_24], eax

loc_100108FC:				; CODE XREF: sub_1001086A+61j
					; sub_1001086A+72j ...
		mov	[ebp+ms_exc.registration.TryLevel], edi
		call	loc_1001090C
; ---------------------------------------------------------------------------

loc_10010904:				; CODE XREF: sub_1001086A+3Aj
					; sub_1001086A+42j ...
		inc	esi
		jmp	short loc_1001088B
; ---------------------------------------------------------------------------

loc_10010907:				; DATA XREF: .rdata:stru_1002B3A0o
		xor	edi, edi	; Finally handler 1 for	function 1001086A
		mov	esi, [ebp+var_20]

loc_1001090C:				; CODE XREF: sub_1001086A+95j
		mov	eax, dword_1002F1D8
		push	dword ptr [eax+esi*4]
		push	esi
		call	sub_10010CE2
		pop	ecx
		pop	ecx
		retn
sub_1001086A	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_1001086A

loc_1001091D:				; CODE XREF: sub_1001086A+2Aj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1001093B	; Finally handler 0 for	function 1001086A
; ---------------------------------------------------------------------------

loc_10010929:				; CODE XREF: sub_1001086A+D9j
		cmp	[ebp+arg_0], 1
		mov	eax, [ebp+var_1C]
		jz	short loc_10010935
		mov	eax, [ebp+var_24]

loc_10010935:				; CODE XREF: sub_1001086A+C6j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1001093B:				; CODE XREF: sub_1001086A+BAj
					; DATA XREF: .rdata:stru_1002B3A0o
		push	1		; Finally handler 0 for	function 1001086A
		call	sub_100151D0
		pop	ecx
		retn
; END OF FUNCTION CHUNK	FOR sub_1001086A

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010944	proc near		; CODE XREF: getpass+1Ap getpass+62p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002B3C8
		call	__SEH_prolog4
		xor	esi, esi
		cmp	[ebp+arg_0], esi
		jnz	short loc_10010960
		push	esi
		call	sub_1001086A
		pop	ecx
		jmp	short loc_10010987
; ---------------------------------------------------------------------------

loc_10010960:				; CODE XREF: sub_10010944+11j
		push	[ebp+arg_0]
		call	sub_10010C50
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], esi
		push	[ebp+arg_0]
		call	sub_10010822
		pop	ecx
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1001098D	; Finally handler 0 for	function 10010944
; ---------------------------------------------------------------------------

loc_10010984:				; CODE XREF: sub_10010944+52j
		mov	eax, [ebp+var_1C]

loc_10010987:				; CODE XREF: sub_10010944+1Aj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1001098D:				; CODE XREF: sub_10010944+3Bj
					; DATA XREF: .rdata:stru_1002B3C8o
		push	[ebp+arg_0]	; Finally handler 0 for	function 10010944
		call	sub_10010CAD
		pop	ecx
		retn
sub_10010944	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010997	proc near		; CODE XREF: sub_10010C30p
		push	1
		call	sub_1001086A
		pop	ecx
		retn
sub_10010997	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100109A0	proc near		; CODE XREF: getpass+10p getpass+58p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	0Ch
		push	offset stru_1002B3E8
		call	__SEH_prolog4
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		xor	eax, eax
		mov	esi, [ebp+arg_0]
		cmp	esi, ebx
		setnz	al
		cmp	eax, ebx
		jnz	short loc_100109DF

loc_100109BF:				; CODE XREF: sub_100109A0+49j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	loc_10010ADF
; ---------------------------------------------------------------------------

loc_100109DF:				; CODE XREF: sub_100109A0+1Dj
		xor	eax, eax
		cmp	[ebp+arg_4], ebx
		setnz	al
		cmp	eax, ebx
		jz	short loc_100109BF
		mov	[ebp+arg_0], esi
		push	esi
		call	sub_10010C50
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		test	byte ptr [esi+0Ch], 40h
		jnz	loc_10010AA8
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10010A3C
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10010A3C
		push	esi
		call	sub_1001704B
		sar	eax, 5
		lea	edi, dword_1002F080[eax*4]
		push	esi
		call	sub_1001704B
		pop	ecx
		pop	ecx
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [edi]
		jmp	short loc_10010A41
; ---------------------------------------------------------------------------

loc_10010A3C:				; CODE XREF: sub_100109A0+6Cj
					; sub_100109A0+78j
		mov	eax, offset dword_1002DEE0

loc_10010A41:				; CODE XREF: sub_100109A0+9Aj
		test	byte ptr [eax+8], 3
		jnz	short loc_10010A8C
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10010A81
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10010A81
		push	esi
		call	sub_1001704B
		sar	eax, 5
		lea	edi, dword_1002F080[eax*4]
		push	esi
		call	sub_1001704B
		pop	ecx
		pop	ecx
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [edi]
		jmp	short loc_10010A86
; ---------------------------------------------------------------------------

loc_10010A81:				; CODE XREF: sub_100109A0+B1j
					; sub_100109A0+BDj
		mov	eax, offset dword_1002DEE0

loc_10010A86:				; CODE XREF: sub_100109A0+DFj
		test	byte ptr [eax+8], 8
		jz	short loc_10010AA8

loc_10010A8C:				; CODE XREF: sub_100109A0+A5j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		or	[ebp+var_1C], 0FFFFFFFFh

loc_10010AA8:				; CODE XREF: sub_100109A0+5Cj
					; sub_100109A0+EAj
		cmp	[ebp+var_1C], ebx
		jnz	short loc_10010AD0
		push	esi
		call	sub_10013CD1
		mov	edi, eax
		lea	eax, [ebp+arg_8]
		push	eax
		push	ebx
		push	[ebp+arg_4]
		push	esi
		call	sub_10013E79
		mov	[ebp+var_1C], eax
		push	esi
		push	edi
		call	sub_10013D65
		add	esp, 1Ch

loc_10010AD0:				; CODE XREF: sub_100109A0+10Bj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10010AE5	; Finally handler 0 for	function 100109A0
; ---------------------------------------------------------------------------

loc_10010ADC:				; CODE XREF: sub_100109A0+14Ej
		mov	eax, [ebp+var_1C]

loc_10010ADF:				; CODE XREF: sub_100109A0+3Aj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10010AE5:				; CODE XREF: sub_100109A0+137j
					; DATA XREF: .rdata:stru_1002B3E8o
		push	[ebp+arg_0]	; Finally handler 0 for	function 100109A0
		call	sub_10010CAD
		pop	ecx
		retn
sub_100109A0	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+14h]
		push	eax
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10018D73
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+14h]
		push	eax
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10018D93
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+10h]
		push	eax
		push	0
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10018D93
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+14h]
		push	eax
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10018DB3
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		lea	eax, [ebp+10h]
		push	eax
		push	0
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10018DB3
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	eax, offset off_1002D2D8
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10010B7F	proc near		; DATA XREF: .rdata:100271F0o
		mov	eax, dword_100301E0
		push	esi
		push	14h
		pop	esi
		test	eax, eax
		jnz	short loc_10010B93
		mov	eax, 200h
		jmp	short loc_10010B99
; ---------------------------------------------------------------------------

loc_10010B93:				; CODE XREF: sub_10010B7F+Bj
		cmp	eax, esi
		jge	short loc_10010B9E
		mov	eax, esi

loc_10010B99:				; CODE XREF: sub_10010B7F+12j
		mov	dword_100301E0,	eax

loc_10010B9E:				; CODE XREF: sub_10010B7F+16j
		push	4
		push	eax
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	dword_1002F1D8,	eax
		test	eax, eax
		jnz	short loc_10010BCF
		push	4
		push	esi
		mov	dword_100301E0,	esi
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	dword_1002F1D8,	eax
		test	eax, eax
		jnz	short loc_10010BCF
		push	1Ah
		pop	eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10010BCF:				; CODE XREF: sub_10010B7F+30j
					; sub_10010B7F+49j
		xor	edx, edx
		mov	ecx, offset off_1002D2D8
		jmp	short loc_10010BDD
; ---------------------------------------------------------------------------

loc_10010BD8:				; CODE XREF: sub_10010B7F+6Dj
		mov	eax, dword_1002F1D8

loc_10010BDD:				; CODE XREF: sub_10010B7F+57j
		mov	[edx+eax], ecx
		add	ecx, 20h
		add	edx, 4
		cmp	ecx, offset dword_1002D558
		jl	short loc_10010BD8
		push	0FFFFFFFEh
		pop	esi
		xor	edx, edx
		mov	ecx, offset dword_1002D2E8
		push	edi

loc_10010BF9:				; CODE XREF: sub_10010B7F+AAj
		mov	edi, edx
		and	edi, 1Fh
		imul	edi, 24h
		mov	eax, edx
		sar	eax, 5
		mov	eax, dword_1002F080[eax*4]
		mov	eax, [edi+eax]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10010C1D
		cmp	eax, esi
		jz	short loc_10010C1D
		test	eax, eax
		jnz	short loc_10010C1F

loc_10010C1D:				; CODE XREF: sub_10010B7F+94j
					; sub_10010B7F+98j
		mov	[ecx], esi

loc_10010C1F:				; CODE XREF: sub_10010B7F+9Cj
		add	ecx, 20h
		inc	edx
		cmp	ecx, offset dword_1002D348
		jl	short loc_10010BF9
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10010B7F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010C30	proc near		; DATA XREF: .rdata:10027208o
		call	sub_10010997
		cmp	byte_1002EB18, 0
		jz	short loc_10010C43
		call	sub_10018E30

loc_10010C43:				; CODE XREF: sub_10010C30+Cj
		push	dword_1002F1D8	; lpMem
		call	sub_1000EE73
		pop	ecx
		retn
sub_10010C30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010C50	proc near		; CODE XREF: sub_1000FCAB+50p
					; sub_1000FE75+64p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ecx, offset off_1002D2D8
		cmp	eax, ecx
		jb	short loc_10010C79
		cmp	eax, offset dword_1002D538
		ja	short loc_10010C79
		sub	eax, ecx
		sar	eax, 5
		add	eax, 10h
		push	eax
		call	sub_100152C7
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10010C79:				; CODE XREF: sub_10010C50+Fj
					; sub_10010C50+16j
		add	eax, 20h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		pop	ebp
		retn
sub_10010C50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010C85	proc near		; CODE XREF: sub_1000ED67+3Fp
					; sub_1001086A+46p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 14h
		jge	short loc_10010C9E
		add	eax, 10h
		push	eax
		call	sub_100152C7
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10010C9E:				; CODE XREF: sub_10010C85+Bj
		mov	eax, [ebp+arg_4]
		add	eax, 20h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		pop	ebp
		retn
sub_10010C85	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010CAD	proc near		; CODE XREF: sub_1000FCAB+75p
					; sub_1000FE75+180p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ecx, offset off_1002D2D8
		cmp	eax, ecx
		jb	short loc_10010CD6
		cmp	eax, offset dword_1002D538
		ja	short loc_10010CD6
		sub	eax, ecx
		sar	eax, 5
		add	eax, 10h
		push	eax
		call	sub_100151D0
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10010CD6:				; CODE XREF: sub_10010CAD+Fj
					; sub_10010CAD+16j
		add	eax, 20h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	ebp
		retn
sub_10010CAD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010CE2	proc near		; CODE XREF: sub_1000ED67+89p
					; sub_1001086A+ABp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 14h
		jge	short loc_10010CFB
		add	eax, 10h
		push	eax
		call	sub_100151D0
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10010CFB:				; CODE XREF: sub_10010CE2+Bj
		mov	eax, [ebp+arg_4]
		add	eax, 20h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	ebp
		retn
sub_10010CE2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010D0A	proc near		; CODE XREF: sub_10010F45:loc_10010F69p
					; sub_10010F73+16p

var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	esi
		push	edi
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_14]
		call	sub_1000E615
		mov	eax, [ebp+arg_8]
		mov	esi, [ebp+arg_4]
		xor	edi, edi
		cmp	eax, edi
		jz	short loc_10010D2D
		mov	[eax], esi

loc_10010D2D:				; CODE XREF: sub_10010D0A+1Fj
		cmp	esi, edi
		jnz	short loc_10010D5D

loc_10010D31:				; CODE XREF: sub_10010D0A+5Cj
					; sub_10010D0A+62j
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_8], 0
		jz	short loc_10010D56
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10010D56:				; CODE XREF: sub_10010D0A+43j
		xor	eax, eax
		jmp	loc_10010F41
; ---------------------------------------------------------------------------

loc_10010D5D:				; CODE XREF: sub_10010D0A+25j
		cmp	[ebp+arg_C], edi
		jz	short loc_10010D6E
		cmp	[ebp+arg_C], 2
		jl	short loc_10010D31
		cmp	[ebp+arg_C], 24h
		jg	short loc_10010D31

loc_10010D6E:				; CODE XREF: sub_10010D0A+56j
		mov	ecx, [ebp+var_14]
		push	ebx
		mov	bl, [esi]
		mov	[ebp+var_4], edi
		lea	edi, [esi+1]

loc_10010D7A:				; CODE XREF: sub_10010D0A+A7j
		cmp	dword ptr [ecx+0ACh], 1
		jle	short loc_10010D9A
		lea	eax, [ebp+var_14]
		push	eax
		movzx	eax, bl
		push	8
		push	eax
		call	sub_10013BD0
		mov	ecx, [ebp+var_14]
		add	esp, 0Ch
		jmp	short loc_10010DAA
; ---------------------------------------------------------------------------

loc_10010D9A:				; CODE XREF: sub_10010D0A+77j
		mov	edx, [ecx+0C8h]
		movzx	eax, bl
		movzx	eax, word ptr [edx+eax*2]
		and	eax, 8

loc_10010DAA:				; CODE XREF: sub_10010D0A+8Ej
		test	eax, eax
		jz	short loc_10010DB3
		mov	bl, [edi]
		inc	edi
		jmp	short loc_10010D7A
; ---------------------------------------------------------------------------

loc_10010DB3:				; CODE XREF: sub_10010D0A+A2j
		cmp	bl, 2Dh
		jnz	short loc_10010DBE
		or	[ebp+arg_10], 2
		jmp	short loc_10010DC3
; ---------------------------------------------------------------------------

loc_10010DBE:				; CODE XREF: sub_10010D0A+ACj
		cmp	bl, 2Bh
		jnz	short loc_10010DC6

loc_10010DC3:				; CODE XREF: sub_10010D0A+B2j
		mov	bl, [edi]
		inc	edi

loc_10010DC6:				; CODE XREF: sub_10010D0A+B7j
		mov	eax, [ebp+arg_C]
		test	eax, eax
		jl	loc_10010F28
		cmp	eax, 1
		jz	loc_10010F28
		cmp	eax, 24h
		jg	loc_10010F28
		test	eax, eax
		jnz	short loc_10010E11
		cmp	bl, 30h
		jz	short loc_10010DF5
		mov	[ebp+arg_C], 0Ah
		jmp	short loc_10010E29
; ---------------------------------------------------------------------------

loc_10010DF5:				; CODE XREF: sub_10010D0A+E0j
		mov	al, [edi]
		cmp	al, 78h
		jz	short loc_10010E08
		cmp	al, 58h
		jz	short loc_10010E08
		mov	[ebp+arg_C], 8
		jmp	short loc_10010E29
; ---------------------------------------------------------------------------

loc_10010E08:				; CODE XREF: sub_10010D0A+EFj
					; sub_10010D0A+F3j
		mov	[ebp+arg_C], 10h
		jmp	short loc_10010E1B
; ---------------------------------------------------------------------------

loc_10010E11:				; CODE XREF: sub_10010D0A+DBj
		cmp	eax, 10h
		jnz	short loc_10010E29
		cmp	bl, 30h
		jnz	short loc_10010E29

loc_10010E1B:				; CODE XREF: sub_10010D0A+105j
		mov	al, [edi]
		cmp	al, 78h
		jz	short loc_10010E25
		cmp	al, 58h
		jnz	short loc_10010E29

loc_10010E25:				; CODE XREF: sub_10010D0A+115j
		inc	edi
		mov	bl, [edi]
		inc	edi

loc_10010E29:				; CODE XREF: sub_10010D0A+E9j
					; sub_10010D0A+FCj ...
		mov	esi, [ecx+0C8h]
		mov	eax, 0FFFFFFFFh
		xor	edx, edx
		div	[ebp+arg_C]

loc_10010E39:				; CODE XREF: sub_10010D0A+1A8j
		movzx	ecx, bl
		movzx	ecx, word ptr [esi+ecx*2]
		test	cl, 4
		jz	short loc_10010E4D
		movsx	ecx, bl
		sub	ecx, 30h
		jmp	short loc_10010E68
; ---------------------------------------------------------------------------

loc_10010E4D:				; CODE XREF: sub_10010D0A+139j
		test	ecx, 103h
		jz	short loc_10010E8C
		mov	cl, bl
		sub	cl, 61h
		cmp	cl, 19h
		movsx	ecx, bl
		ja	short loc_10010E65
		sub	ecx, 20h

loc_10010E65:				; CODE XREF: sub_10010D0A+156j
		add	ecx, 0FFFFFFC9h

loc_10010E68:				; CODE XREF: sub_10010D0A+141j
		cmp	ecx, [ebp+arg_C]
		jnb	short loc_10010E8C
		or	[ebp+arg_10], 8
		cmp	[ebp+arg_14], 0
		jnz	short loc_10010EA3
		cmp	[ebp+var_4], eax
		jb	short loc_10010EA3
		jnz	short loc_10010E82
		cmp	ecx, edx
		jbe	short loc_10010EA3

loc_10010E82:				; CODE XREF: sub_10010D0A+172j
		or	[ebp+arg_10], 4
		cmp	[ebp+arg_8], 0
		jnz	short loc_10010EAF

loc_10010E8C:				; CODE XREF: sub_10010D0A+149j
					; sub_10010D0A+161j
		mov	eax, [ebp+arg_10]
		dec	edi
		test	al, 8
		jnz	short loc_10010EB4
		cmp	[ebp+arg_8], 0
		jz	short loc_10010E9D
		mov	edi, [ebp+arg_4]

loc_10010E9D:				; CODE XREF: sub_10010D0A+18Ej
		and	[ebp+var_4], 0
		jmp	short loc_10010F04
; ---------------------------------------------------------------------------

loc_10010EA3:				; CODE XREF: sub_10010D0A+16Bj
					; sub_10010D0A+170j ...
		mov	ebx, [ebp+var_4]
		imul	ebx, [ebp+arg_C]
		add	ebx, ecx
		mov	[ebp+var_4], ebx

loc_10010EAF:				; CODE XREF: sub_10010D0A+180j
		mov	bl, [edi]
		inc	edi
		jmp	short loc_10010E39
; ---------------------------------------------------------------------------

loc_10010EB4:				; CODE XREF: sub_10010D0A+188j
		mov	esi, 7FFFFFFFh
		test	al, 4
		jnz	short loc_10010ED8
		test	al, 1
		jnz	short loc_10010F04
		and	eax, 2
		jz	short loc_10010ECF
		cmp	[ebp+var_4], 80000000h
		ja	short loc_10010ED8

loc_10010ECF:				; CODE XREF: sub_10010D0A+1BAj
		test	eax, eax
		jnz	short loc_10010F04
		cmp	[ebp+var_4], esi
		jbe	short loc_10010F04

loc_10010ED8:				; CODE XREF: sub_10010D0A+1B1j
					; sub_10010D0A+1C3j
		cmp	[ebp+arg_14], 0
		jnz	short loc_10010F04
		call	sub_10014BF2
		test	byte ptr [ebp+arg_10], 1
		mov	dword ptr [eax], 22h
		jz	short loc_10010EF5
		or	[ebp+var_4], 0FFFFFFFFh
		jmp	short loc_10010F04
; ---------------------------------------------------------------------------

loc_10010EF5:				; CODE XREF: sub_10010D0A+1E3j
		test	byte ptr [ebp+arg_10], 2
		push	0
		pop	eax
		setnz	al
		add	eax, esi
		mov	[ebp+var_4], eax

loc_10010F04:				; CODE XREF: sub_10010D0A+197j
					; sub_10010D0A+1B5j ...
		mov	eax, [ebp+arg_8]
		test	eax, eax
		jz	short loc_10010F0D
		mov	[eax], edi

loc_10010F0D:				; CODE XREF: sub_10010D0A+1FFj
		test	byte ptr [ebp+arg_10], 2
		jz	short loc_10010F16
		neg	[ebp+var_4]

loc_10010F16:				; CODE XREF: sub_10010D0A+207j
		cmp	[ebp+var_8], 0
		jz	short loc_10010F23
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10010F23:				; CODE XREF: sub_10010D0A+210j
		mov	eax, [ebp+var_4]
		jmp	short loc_10010F40
; ---------------------------------------------------------------------------

loc_10010F28:				; CODE XREF: sub_10010D0A+C1j
					; sub_10010D0A+CAj ...
		mov	eax, [ebp+arg_8]
		test	eax, eax
		jz	short loc_10010F31
		mov	[eax], esi

loc_10010F31:				; CODE XREF: sub_10010D0A+223j
		cmp	[ebp+var_8], 0
		jz	short loc_10010F3E
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10010F3E:				; CODE XREF: sub_10010D0A+22Bj
		xor	eax, eax

loc_10010F40:				; CODE XREF: sub_10010D0A+21Cj
		pop	ebx

loc_10010F41:				; CODE XREF: sub_10010D0A+4Ej
		pop	edi
		pop	esi
		leave
		retn
sub_10010D0A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010F45	proc near		; CODE XREF: sub_10011024+18p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_C]
		xor	eax, eax
		push	eax
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		cmp	dword_1002E61C,	eax
		jnz	short loc_10010F68
		push	offset off_1002DB70
		jmp	short loc_10010F69
; ---------------------------------------------------------------------------

loc_10010F68:				; CODE XREF: sub_10010F45+1Aj
		push	eax

loc_10010F69:				; CODE XREF: sub_10010F45+21j
		call	sub_10010D0A
		add	esp, 18h
		pop	ebp
		retn
sub_10010F45	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010F73	proc near		; CODE XREF: sub_10010F93:loc_10010FB4p
					; sub_10010FBE+13p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10010D0A
		add	esp, 18h
		pop	ebp
		retn
sub_10010F73	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010F93	proc near		; CODE XREF: .text:1000A3D2p
					; sub_1001E5A0+245p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	eax
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		cmp	dword_1002E61C,	eax
		jnz	short loc_10010FB3
		push	offset off_1002DB70
		jmp	short loc_10010FB4
; ---------------------------------------------------------------------------

loc_10010FB3:				; CODE XREF: sub_10010F93+17j
		push	eax

loc_10010FB4:				; CODE XREF: sub_10010F93+1Ej
		call	sub_10010F73
		add	esp, 14h
		pop	ebp
		retn
sub_10010F93	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010FBE	proc near		; CODE XREF: .text:10011055p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	[ebp+arg_C]
		call	sub_10010F73
		add	esp, 14h
		pop	ebp
		retn
sub_10010FBE	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		push	1
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		jnz	short loc_10010FFB
		push	offset off_1002DB70
		jmp	short loc_10010FFD
; ---------------------------------------------------------------------------

loc_10010FFB:				; CODE XREF: .text:10010FF2j
		push	0

loc_10010FFD:				; CODE XREF: .text:10010FF9j
		call	sub_10010F73
		add	esp, 14h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+14h]
		call	sub_10010F73
		add	esp, 14h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011024	proc near		; CODE XREF: sub_1001105F+6j
					; sub_1001C7FC+67p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jnz	short loc_10011033
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10011033:				; CODE XREF: sub_10011024+9j
		push	1
		push	0Ah
		push	0
		push	[ebp+arg_0]
		call	sub_10010F45
		add	esp, 10h
		pop	ebp
		retn
sub_10011024	endp

; ---------------------------------------------------------------------------

loc_10011046:				; CODE XREF: .text:10011070j
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	0Ah
		push	0
		push	dword ptr [ebp+8]
		call	sub_10010FBE
		add	esp, 10h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001105F	proc near		; CODE XREF: sasl_server_new+31Cp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	sub_10011024
sub_1001105F	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	loc_10011046
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_10011086
		xor	eax, eax
		xor	edx, edx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10011086:				; CODE XREF: .text:1001107Ej
		push	0Ah
		push	0
		push	dword ptr [ebp+8]
		call	sub_10019170
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	0Ah
		push	0
		push	dword ptr [ebp+8]
		call	sub_1001919B
		add	esp, 10h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100110B0(HANDLE hFindFile)
sub_100110B0	proc near		; CODE XREF: sub_1000C9A0+363p

hFindFile	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+hFindFile]	; hFindFile
		call	ds:FindClose
		test	eax, eax
		jnz	short loc_100110D2
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100110D2:				; CODE XREF: sub_100110B0+10j
		xor	eax, eax
		pop	ebp
		retn
sub_100110B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100110D6(FILETIME *lpFileTime)
sub_100110D6	proc near		; CODE XREF: sub_1001113C+BEp
					; sub_1001113C+CDp ...

SystemTime	= _SYSTEMTIME ptr -18h
LocalFileTime	= _FILETIME ptr	-8
lpFileTime	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+lpFileTime]
		sub	esp, 18h
		cmp	dword ptr [eax], 0
		jnz	short loc_100110EC
		cmp	dword ptr [eax+4], 0
		jz	short loc_10011137

loc_100110EC:				; CODE XREF: sub_100110D6+Ej
		lea	ecx, [ebp+LocalFileTime]
		push	ecx		; lpLocalFileTime
		push	eax		; lpFileTime
		call	ds:FileTimeToLocalFileTime
		test	eax, eax
		jz	short loc_10011137
		lea	eax, [ebp+SystemTime]
		push	eax		; lpSystemTime
		lea	eax, [ebp+LocalFileTime]
		push	eax		; lpFileTime
		call	ds:FileTimeToSystemTime
		test	eax, eax
		jz	short loc_10011137
		movzx	eax, [ebp+SystemTime.wSecond]
		push	0FFFFFFFFh
		push	eax
		movzx	eax, [ebp+SystemTime.wMinute]
		push	eax
		movzx	eax, [ebp+SystemTime.wHour]
		push	eax
		movzx	eax, [ebp+SystemTime.wDay]
		push	eax
		movzx	eax, [ebp+SystemTime.wMonth]
		push	eax
		movzx	eax, [ebp+SystemTime.wYear]
		push	eax
		call	sub_10019201
		add	esp, 1Ch
		leave
		retn
; ---------------------------------------------------------------------------

loc_10011137:				; CODE XREF: sub_100110D6+14j
					; sub_100110D6+23j ...
		or	eax, 0FFFFFFFFh
		leave
		retn
sub_100110D6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001113C(LPCSTR lpFileName, int)
sub_1001113C	proc near		; CODE XREF: sub_10011389+6j

FindFileData	= _WIN32_FIND_DATAA ptr	-144h
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 144h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+lpFileName]
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		xor	edi, edi
		cmp	esi, edi
		jnz	short loc_1001117F

loc_1001115F:				; CODE XREF: sub_1001113C+45j
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	loc_10011255
; ---------------------------------------------------------------------------

loc_1001117F:				; CODE XREF: sub_1001113C+21j
		cmp	eax, edi
		jz	short loc_1001115F
		push	ebx
		lea	ecx, [ebp+FindFileData]
		push	ecx		; lpFindFileData
		push	eax		; lpFileName
		call	ds:FindFirstFileA
		mov	ebx, eax
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_100111DE
		call	ds:GetLastError
		push	2
		pop	esi
		cmp	eax, esi
		jb	short loc_100111B5
		cmp	eax, 3
		jbe	short loc_100111D5
		cmp	eax, 8
		jz	short loc_100111C8
		cmp	eax, 12h
		jz	short loc_100111D5

loc_100111B5:				; CODE XREF: sub_1001113C+68j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h

loc_100111C0:				; CODE XREF: sub_1001113C+97j
					; sub_1001113C+A0j
		or	eax, 0FFFFFFFFh
		jmp	loc_10011254
; ---------------------------------------------------------------------------

loc_100111C8:				; CODE XREF: sub_1001113C+72j
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		jmp	short loc_100111C0
; ---------------------------------------------------------------------------

loc_100111D5:				; CODE XREF: sub_1001113C+6Dj
					; sub_1001113C+77j
		call	sub_10014BF2
		mov	[eax], esi
		jmp	short loc_100111C0
; ---------------------------------------------------------------------------

loc_100111DE:				; CODE XREF: sub_1001113C+5Bj
		mov	eax, [ebp+FindFileData.dwFileAttributes]
		add	eax, 0FFFFFF80h
		neg	eax
		sbb	eax, eax
		and	eax, [ebp+FindFileData.dwFileAttributes]
		mov	[esi], eax
		lea	eax, [ebp+FindFileData.ftCreationTime]
		push	eax		; lpFileTime
		call	sub_100110D6
		mov	[esi+4], eax
		lea	eax, [ebp+FindFileData.ftLastAccessTime]
		push	eax		; lpFileTime
		call	sub_100110D6
		mov	[esi+8], eax
		lea	eax, [ebp+FindFileData.ftLastWriteTime]
		push	eax		; lpFileTime
		call	sub_100110D6
		mov	[esi+0Ch], eax
		mov	eax, [ebp+FindFileData.nFileSizeLow]
		mov	[esi+10h], eax
		lea	eax, [ebp+FindFileData.cFileName]
		push	eax
		push	104h
		add	esi, 14h
		push	esi
		call	sub_10016B60
		add	esp, 18h
		test	eax, eax
		jz	short loc_10011252
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014AB5
		add	esp, 14h

loc_10011252:				; CODE XREF: sub_1001113C+107j
		mov	eax, ebx

loc_10011254:				; CODE XREF: sub_1001113C+87j
		pop	ebx

loc_10011255:				; CODE XREF: sub_1001113C+3Ej
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1001113C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10011263(HANDLE hFindFile, int)
sub_10011263	proc near		; CODE XREF: sub_10011394+6j

FindFileData	= _WIN32_FIND_DATAA ptr	-144h
var_4		= dword	ptr -4
hFindFile	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 144h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+hFindFile]
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100112A7
		call	sub_10014BF2
		xor	edi, edi

loc_1001128C:				; CODE XREF: sub_10011263+4Fj
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h

loc_1001129F:				; CODE XREF: sub_10011263+8Aj
					; sub_10011263+97j ...
		or	eax, 0FFFFFFFFh
		jmp	loc_1001137B
; ---------------------------------------------------------------------------

loc_100112A7:				; CODE XREF: sub_10011263+20j
		xor	edi, edi
		cmp	esi, edi
		jnz	short loc_100112B4
		call	sub_10014BF2
		jmp	short loc_1001128C
; ---------------------------------------------------------------------------

loc_100112B4:				; CODE XREF: sub_10011263+48j
		lea	ecx, [ebp+FindFileData]
		push	ecx		; lpFindFileData
		push	eax		; hFindFile
		call	ds:FindNextFileA
		test	eax, eax
		jnz	short loc_10011305
		call	ds:GetLastError
		push	2
		pop	esi
		cmp	eax, esi
		jb	short loc_100112E2
		cmp	eax, 3
		jbe	short loc_100112FC
		cmp	eax, 8
		jz	short loc_100112EF
		cmp	eax, 12h
		jz	short loc_100112FC

loc_100112E2:				; CODE XREF: sub_10011263+6Ej
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		jmp	short loc_1001129F
; ---------------------------------------------------------------------------

loc_100112EF:				; CODE XREF: sub_10011263+78j
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		jmp	short loc_1001129F
; ---------------------------------------------------------------------------

loc_100112FC:				; CODE XREF: sub_10011263+73j
					; sub_10011263+7Dj
		call	sub_10014BF2
		mov	[eax], esi
		jmp	short loc_1001129F
; ---------------------------------------------------------------------------

loc_10011305:				; CODE XREF: sub_10011263+61j
		mov	eax, [ebp+FindFileData.dwFileAttributes]
		add	eax, 0FFFFFF80h
		neg	eax
		sbb	eax, eax
		and	eax, [ebp+FindFileData.dwFileAttributes]
		mov	[esi], eax
		lea	eax, [ebp+FindFileData.ftCreationTime]
		push	eax		; lpFileTime
		call	sub_100110D6
		mov	[esi+4], eax
		lea	eax, [ebp+FindFileData.ftLastAccessTime]
		push	eax		; lpFileTime
		call	sub_100110D6
		mov	[esi+8], eax
		lea	eax, [ebp+FindFileData.ftLastWriteTime]
		push	eax		; lpFileTime
		call	sub_100110D6
		mov	[esi+0Ch], eax
		mov	eax, [ebp+FindFileData.nFileSizeLow]
		mov	[esi+10h], eax
		lea	eax, [ebp+FindFileData.cFileName]
		push	eax
		push	104h
		add	esi, 14h
		push	esi
		call	sub_10016B60
		add	esp, 18h
		test	eax, eax
		jz	short loc_10011379
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014AB5
		add	esp, 14h

loc_10011379:				; CODE XREF: sub_10011263+107j
		xor	eax, eax

loc_1001137B:				; CODE XREF: sub_10011263+3Fj
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10011263	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011389	proc near		; CODE XREF: sub_1000C9A0+1FAp
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	sub_1001113C
sub_10011389	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011394	proc near		; CODE XREF: sub_1000C9A0+352p
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	sub_10011263
sub_10011394	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100113A0	proc near		; CODE XREF: sub_1000C9A0+2DAp
					; sub_100257F4+28p

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		mov	edi, [ebp+arg_0]
		xor	eax, eax
		or	ecx, 0FFFFFFFFh
		repne scasb
		add	ecx, 1
		neg	ecx
		sub	edi, 1
		mov	al, [ebp+arg_4]
		std
		repne scasb
		add	edi, 1
		cmp	[edi], al
		jz	short loc_100113C7
		xor	eax, eax
		jmp	short loc_100113C9
; ---------------------------------------------------------------------------

loc_100113C7:				; CODE XREF: sub_100113A0+21j
		mov	eax, edi

loc_100113C9:				; CODE XREF: sub_100113A0+25j
		cld
		pop	edi
		leave
		retn
sub_100113A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100113CD	proc near		; CODE XREF: sub_10011657+9p
					; sub_10011694+9p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, 0E06D7363h
		cmp	[ebp+arg_0], eax
		jnz	short loc_100113E9
		push	[ebp+arg_4]
		push	eax
		call	sub_1001944B
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100113E9:				; CODE XREF: sub_100113CD+Dj
		xor	eax, eax
		pop	ebp
		retn
sub_100113CD	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	dword_1002EAE0,	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	dword_1002EAE4,	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	dword_1002EAE8,	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	dword_1002EAEC,	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	dword_1002EAF0,	eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011438	proc near		; CODE XREF: sub_100115E4+11j

VersionInformation= _OSVERSIONINFOA ptr	-98h
var_4		= dword	ptr -4
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		push	esi
		push	edi
		cmp	eax, 1
		jnz	loc_10011539
		lea	eax, [ebp+VersionInformation]
		push	eax		; lpVersionInformation
		mov	[ebp+VersionInformation.dwOSVersionInfoSize], 94h
		call	ds:GetVersionExA
		test	eax, eax
		jnz	short loc_1001147D

loc_10011476:				; CODE XREF: sub_10011438+9Aj
					; sub_10011438+AAj ...
		xor	eax, eax
		jmp	loc_100115D4
; ---------------------------------------------------------------------------

loc_1001147D:				; CODE XREF: sub_10011438+3Cj
		mov	eax, [ebp+VersionInformation.dwBuildNumber]
		mov	ecx, [ebp+VersionInformation.dwPlatformId]
		and	eax, 7FFFh
		cmp	ecx, 2
		jz	short loc_10011498
		or	eax, 8000h

loc_10011498:				; CODE XREF: sub_10011438+59j
		mov	edx, [ebp+VersionInformation.dwMinorVersion]
		mov	dword_1002EAE0,	ecx
		mov	ecx, [ebp+VersionInformation.dwMajorVersion]
		mov	esi, ecx
		shl	esi, 8
		add	esi, edx
		push	1
		mov	dword_1002EAE8,	esi
		mov	dword_1002EAEC,	ecx
		mov	dword_1002EAF0,	edx
		mov	dword_1002EAE4,	eax
		call	sub_1001504E
		pop	ecx
		test	eax, eax
		jz	short loc_10011476
		call	sub_10013A07
		test	eax, eax
		jnz	short loc_100114E4

loc_100114DD:				; CODE XREF: sub_10011438+CFj
		call	sub_100150AE
		jmp	short loc_10011476
; ---------------------------------------------------------------------------

loc_100114E4:				; CODE XREF: sub_10011438+A3j
		call	ds:GetCommandLineA
		mov	dword_1002F1D0,	eax
		call	sub_10019A1D
		mov	dword_1002E5F0,	eax
		call	sub_100179DC
		test	eax, eax
		jge	short loc_10011509

loc_10011502:				; CODE XREF: sub_10011438+FFj
		call	sub_100136A7
		jmp	short loc_100114DD
; ---------------------------------------------------------------------------

loc_10011509:				; CODE XREF: sub_10011438+C8j
		call	sub_1001992E
		test	eax, eax
		jl	short loc_10011532
		call	sub_100195CB
		test	eax, eax
		jl	short loc_10011532
		push	0
		call	sub_100165FB
		pop	ecx
		test	eax, eax
		jnz	short loc_10011532
		inc	dword_1002E5E8
		jmp	loc_100115D1
; ---------------------------------------------------------------------------

loc_10011532:				; CODE XREF: sub_10011438+D8j
					; sub_10011438+E1j ...
		call	sub_10017C16
		jmp	short loc_10011502
; ---------------------------------------------------------------------------

loc_10011539:				; CODE XREF: sub_10011438+1Dj
		xor	edi, edi
		cmp	eax, edi
		jnz	short loc_10011574
		cmp	dword_1002E5E8,	edi
		jle	loc_10011476
		dec	dword_1002E5E8
		cmp	dword_1002EB1C,	edi
		jnz	short loc_1001155E
		call	sub_1001677D

loc_1001155E:				; CODE XREF: sub_10011438+11Fj
		cmp	[ebp+arg_8], edi
		jnz	short loc_100115D1
		call	sub_10017C16
		call	sub_100136A7
		call	sub_100150AE
		jmp	short loc_100115D1
; ---------------------------------------------------------------------------

loc_10011574:				; CODE XREF: sub_10011438+105j
		cmp	eax, 2
		jnz	short loc_100115C5
		call	sub_10013660
		push	214h
		push	1
		call	sub_1000F496
		mov	esi, eax
		pop	ecx
		pop	ecx
		cmp	esi, edi
		jz	loc_10011476
		push	esi
		push	dword_1002DB7C
		push	dword_1002E648
		call	sub_100135C4
		pop	ecx
		call	eax
		test	eax, eax
		jz	short loc_100115B9
		push	edi
		push	esi
		call	sub_100136E4
		pop	ecx
		jmp	short loc_100115D0
; ---------------------------------------------------------------------------

loc_100115B9:				; CODE XREF: sub_10011438+175j
		push	esi		; lpMem
		call	sub_1000EE73
		pop	ecx
		jmp	loc_10011476
; ---------------------------------------------------------------------------

loc_100115C5:				; CODE XREF: sub_10011438+13Fj
		cmp	eax, 3
		jnz	short loc_100115D1
		push	edi		; lpMem
		call	sub_1001398D

loc_100115D0:				; CODE XREF: sub_10011438+17Fj
		pop	ecx

loc_100115D1:				; CODE XREF: sub_10011438+F5j
					; sub_10011438+129j ...
		xor	eax, eax
		inc	eax

loc_100115D4:				; CODE XREF: sub_10011438+40j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn	0Ch
sub_10011438	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100115E4	proc near		; CODE XREF: DllEntryPoint-1BBp
					; DllEntryPoint-FBp ...

arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		jnz	short loc_100115F4
		call	sub_10019B54

loc_100115F4:				; CODE XREF: sub_100115E4+9j
		pop	ebp
		jmp	sub_10011438
sub_100115E4	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100115FA:				; CODE XREF: DllEntryPoint+11j
		push	0Ch
		push	offset dword_1002B408
		call	__SEH_prolog4
		mov	ecx, [ebp+arg_4]
		xor	edx, edx
		inc	edx
		mov	[ebp+var_1C], edx
		xor	edi, edi
		cmp	ecx, edi
		jnz	short loc_10011624
		cmp	dword_1002E5E8,	edi
		jnz	short loc_10011624

loc_1001161D:				; CODE XREF: DllEntryPoint-1CDj
					; DllEntryPoint-18Dj
		xor	eax, eax
		jmp	loc_1001183D
; ---------------------------------------------------------------------------

loc_10011624:				; CODE XREF: DllEntryPoint-232j
					; DllEntryPoint-22Aj
		cmp	ecx, edx
		jz	short loc_10011631
		cmp	ecx, 2
		jnz	loc_100116BD

loc_10011631:				; CODE XREF: DllEntryPoint-21Fj
		mov	eax, dword_1002F1D4
		cmp	eax, edi
		jz	short loc_10011672
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	dword_1002E5EC,	edx
		push	[ebp+arg_8]
		push	ecx
		push	[ebp+arg_0]
		call	eax ; dword_1002F1D4
		mov	[ebp+var_1C], eax

loc_1001164F:				; CODE XREF: sub_10011668+8j
		push	0FFFFFFFEh
		pop	esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		jmp	short loc_10011675
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10011657	proc near		; DATA XREF: .rdata:1002B41Co
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		push	eax
		push	ecx
		call	sub_100113CD
		pop	ecx
		pop	ecx
		retn
sub_10011657	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011668	proc near		; DATA XREF: .rdata:1002B420o
		mov	esp, [ebp-18h]
		xor	edi, edi
		mov	[ebp-1Ch], edi
		jmp	short loc_1001164F
sub_10011668	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10011672:				; CODE XREF: DllEntryPoint-20Dj
		push	0FFFFFFFEh
		pop	esi

loc_10011675:				; CODE XREF: DllEntryPoint-1F0j
		cmp	[ebp+var_1C], edi
		jz	short loc_1001161D
		mov	[ebp+ms_exc.registration.TryLevel], 1
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100115E4
		mov	[ebp+var_1C], eax
		jmp	short loc_100116B0
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10011694	proc near		; DATA XREF: .rdata:1002B428o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		push	eax
		push	ecx
		call	sub_100113CD
		pop	ecx
		pop	ecx
		retn
sub_10011694	endp


; =============== S U B	R O U T	I N E =======================================


sub_100116A5	proc near		; DATA XREF: .rdata:1002B42Co
		mov	esp, [ebp-18h]
		xor	edi, edi
		mov	[ebp-1Ch], edi
		push	0FFFFFFFEh
		pop	esi
sub_100116A5	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100116B0:				; CODE XREF: DllEntryPoint-1B3j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		cmp	[ebp+var_1C], edi
		jnz	short loc_100116C0
		jmp	loc_1001161D
; ---------------------------------------------------------------------------

loc_100116BD:				; CODE XREF: DllEntryPoint-21Aj
		push	0FFFFFFFEh
		pop	esi

loc_100116C0:				; CODE XREF: DllEntryPoint-18Fj
		mov	[ebp+ms_exc.registration.TryLevel], 2
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10019BE5
		mov	[ebp+var_1C], eax
		jmp	short loc_100116F6
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100116DA	proc near		; DATA XREF: .rdata:1002B434o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		push	eax
		push	ecx
		call	sub_100113CD
		pop	ecx
		pop	ecx
		retn
sub_100116DA	endp


; =============== S U B	R O U T	I N E =======================================


sub_100116EB	proc near		; DATA XREF: .rdata:1002B438o
		mov	esp, [ebp-18h]
		xor	edi, edi
		mov	[ebp-1Ch], edi
		push	0FFFFFFFEh
		pop	esi
sub_100116EB	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100116F6:				; CODE XREF: DllEntryPoint-16Dj
		mov	[ebp+ms_exc.registration.TryLevel], esi
		cmp	[ebp+arg_4], 1
		jnz	loc_100117A8
		cmp	[ebp+var_1C], edi
		jnz	loc_100117A8
		mov	[ebp+ms_exc.registration.TryLevel], 3
		push	edi
		push	edi
		push	[ebp+arg_0]
		call	sub_10019BE5
		mov	[ebp+ms_exc.registration.TryLevel], esi
		jmp	short loc_1001173E
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10011722	proc near		; DATA XREF: .rdata:1002B440o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		push	eax
		push	ecx
		call	sub_100113CD
		pop	ecx
		pop	ecx
		retn
sub_10011722	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011733	proc near		; DATA XREF: .rdata:1002B444o
		mov	esp, [ebp-18h]
		push	0FFFFFFFEh
		pop	esi
		mov	[ebp-4], esi
		xor	edi, edi
sub_10011733	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1001173E:				; CODE XREF: DllEntryPoint-125j
		mov	[ebp+ms_exc.registration.TryLevel], 4
		push	edi
		push	edi
		push	[ebp+arg_0]
		call	sub_100115E4
		mov	[ebp+ms_exc.registration.TryLevel], esi
		jmp	short loc_10011770
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10011754	proc near		; DATA XREF: .rdata:1002B44Co
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		push	eax
		push	ecx
		call	sub_100113CD
		pop	ecx
		pop	ecx
		retn
sub_10011754	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011765	proc near		; DATA XREF: .rdata:1002B450o
		mov	esp, [ebp-18h]
		push	0FFFFFFFEh
		pop	esi
		mov	[ebp-4], esi
		xor	edi, edi
sub_10011765	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10011770:				; CODE XREF: DllEntryPoint-F3j
		mov	eax, dword_1002F1D4
		cmp	eax, edi
		jz	short loc_100117A8
		mov	[ebp+ms_exc.registration.TryLevel], 5
		push	edi
		push	edi
		push	[ebp+arg_0]
		call	eax ; dword_1002F1D4
		mov	[ebp+ms_exc.registration.TryLevel], esi
		jmp	short loc_100117A8
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_1001178C	proc near		; DATA XREF: .rdata:1002B458o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		push	eax
		push	ecx
		call	sub_100113CD
		pop	ecx
		pop	ecx
		retn
sub_1001178C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001179D	proc near		; DATA XREF: .rdata:1002B45Co
		mov	esp, [ebp-18h]
		push	0FFFFFFFEh
		pop	esi
		mov	[ebp-4], esi
		xor	edi, edi
sub_1001179D	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100117A8:				; CODE XREF: DllEntryPoint-148j
					; DllEntryPoint-13Fj ...
		cmp	[ebp+arg_4], edi
		jz	short loc_100117B7
		cmp	[ebp+arg_4], 3
		jnz	loc_1001183A

loc_100117B7:				; CODE XREF: DllEntryPoint-9Aj
		mov	[ebp+ms_exc.registration.TryLevel], 6
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100115E4
		mov	[ebp+var_1C], eax
		jmp	short loc_100117ED
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100117D1	proc near		; DATA XREF: .rdata:1002B464o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		push	eax
		push	ecx
		call	sub_100113CD
		pop	ecx
		pop	ecx
		retn
sub_100117D1	endp


; =============== S U B	R O U T	I N E =======================================


sub_100117E2	proc near		; DATA XREF: .rdata:1002B468o
		mov	esp, [ebp-18h]
		xor	edi, edi
		mov	[ebp-1Ch], edi
		push	0FFFFFFFEh
		pop	esi
sub_100117E2	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100117ED:				; CODE XREF: DllEntryPoint-76j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, dword_1002F1D4
		cmp	eax, edi
		jz	short loc_1001183A
		cmp	dword_1002E5EC,	edi
		jz	short loc_1001183A
		mov	[ebp+ms_exc.registration.TryLevel], 7
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	eax ; dword_1002F1D4
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], esi
		jmp	short loc_1001183A
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_1001181B	proc near		; DATA XREF: .rdata:1002B470o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		push	eax
		push	ecx
		call	sub_100113CD
		pop	ecx
		pop	ecx
		retn
sub_1001181B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001182C	proc near		; DATA XREF: .rdata:1002B474o
		mov	esp, [ebp-18h]
		and	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-4], 0FFFFFFFEh
sub_1001182C	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1001183A:				; CODE XREF: DllEntryPoint-94j
					; DllEntryPoint-4Ej ...
		mov	eax, [ebp+var_1C]

loc_1001183D:				; CODE XREF: DllEntryPoint-226j
		call	__SEH_epilog4
		retn	0Ch
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
		public DllEntryPoint
DllEntryPoint	proc near

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

; FUNCTION CHUNK AT 100115FA SIZE 0000005D BYTES
; FUNCTION CHUNK AT 10011672 SIZE 00000022 BYTES
; FUNCTION CHUNK AT 100116B0 SIZE 0000002A BYTES
; FUNCTION CHUNK AT 100116F6 SIZE 0000002C BYTES
; FUNCTION CHUNK AT 1001173E SIZE 00000016 BYTES
; FUNCTION CHUNK AT 10011770 SIZE 0000001C BYTES
; FUNCTION CHUNK AT 100117A8 SIZE 00000029 BYTES
; FUNCTION CHUNK AT 100117ED SIZE 0000002E BYTES
; FUNCTION CHUNK AT 1001183A SIZE 0000000B BYTES

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		jnz	short loc_10011855
		call	sub_10019B54

loc_10011855:				; CODE XREF: DllEntryPoint+9j
		pop	ebp
		jmp	loc_100115FA
DllEntryPoint	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001185B	proc near		; CODE XREF: sub_100118B2+31p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	[ebp+var_4], edi
		mov	edi, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		shr	ecx, 7
		pxor	xmm0, xmm0
		jmp	short loc_1001187B
; ---------------------------------------------------------------------------
		db 8Dh,	0A4h, 24h, 4 dup(0)
		db 90h
; ---------------------------------------------------------------------------

loc_1001187B:				; CODE XREF: sub_1001185B+16j
					; sub_1001185B+4Ej
		movdqa	xmmword	ptr [edi], xmm0
		movdqa	xmmword	ptr [edi+10h], xmm0
		movdqa	xmmword	ptr [edi+20h], xmm0
		movdqa	xmmword	ptr [edi+30h], xmm0
		movdqa	xmmword	ptr [edi+40h], xmm0
		movdqa	xmmword	ptr [edi+50h], xmm0
		movdqa	xmmword	ptr [edi+60h], xmm0
		movdqa	xmmword	ptr [edi+70h], xmm0
		lea	edi, [edi+80h]
		dec	ecx
		jnz	short loc_1001187B
		mov	edi, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_1001185B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100118B2	proc near		; CODE XREF: sub_1000E0F0+27j
					; sub_100118B2+7Dp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], edi
		mov	eax, [ebp+arg_0]
		cdq
		mov	edi, eax
		xor	edi, edx
		sub	edi, edx
		and	edi, 0Fh
		xor	edi, edx
		sub	edi, edx
		test	edi, edi
		jnz	short loc_1001190C
		mov	ecx, [ebp+arg_8]
		mov	edx, ecx
		and	edx, 7Fh
		mov	[ebp+var_C], edx
		cmp	ecx, edx
		jz	short loc_100118F1
		sub	ecx, edx
		push	ecx
		push	eax
		call	sub_1001185B
		add	esp, 8
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]

loc_100118F1:				; CODE XREF: sub_100118B2+2Bj
		test	edx, edx
		jz	short loc_1001193A
		add	eax, [ebp+arg_8]
		sub	eax, edx
		mov	[ebp+var_8], eax
		xor	eax, eax
		mov	edi, [ebp+var_8]
		mov	ecx, [ebp+var_C]
		rep stosb
		mov	eax, [ebp+arg_0]
		jmp	short loc_1001193A
; ---------------------------------------------------------------------------

loc_1001190C:				; CODE XREF: sub_100118B2+1Cj
		neg	edi
		add	edi, 10h
		mov	[ebp+var_10], edi
		xor	eax, eax
		mov	edi, [ebp+arg_0]
		mov	ecx, [ebp+var_10]
		rep stosb
		mov	eax, [ebp+var_10]
		mov	ecx, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		add	ecx, eax
		sub	edx, eax
		push	edx
		push	0
		push	ecx
		call	sub_100118B2
		add	esp, 0Ch
		mov	eax, [ebp+arg_0]

loc_1001193A:				; CODE XREF: sub_100118B2+41j
					; sub_100118B2+58j
		mov	edi, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_100118B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011941	proc near		; CODE XREF: sub_10011991+4Fp

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	0Ch
		push	offset stru_1002B478
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		movapd	xmm0, xmm1
		mov	[ebp+var_1C], 1
		jmp	short loc_10011981
; ---------------------------------------------------------------------------

loc_1001195E:				; DATA XREF: .rdata:stru_1002B478o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 10011941
		mov	eax, [eax]
		mov	eax, [eax]
		cmp	eax, 0C0000005h
		jz	short loc_10011976
		cmp	eax, 0C000001Dh
		jz	short loc_10011976
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10011976:				; CODE XREF: sub_10011941+29j
					; sub_10011941+30j
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001197A:				; DATA XREF: .rdata:stru_1002B478o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10011941
		and	[ebp+var_1C], 0

loc_10011981:				; CODE XREF: sub_10011941+1Bj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
sub_10011941	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011991	proc near		; CODE XREF: sub_100119F3p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		xor	eax, eax
		push	ebx
		mov	[ebp+var_4], eax
		mov	[ebp+var_C], eax
		mov	[ebp+var_8], eax
		push	ebx
		pushf
		pop	eax
		mov	ecx, eax
		xor	eax, 200000h
		push	eax
		popf
		pushf
		pop	edx
		sub	edx, ecx
		jz	short loc_100119D6
		push	ecx
		popf
		xor	eax, eax
		cpuid
		mov	[ebp+var_C], eax
		mov	[ebp+var_18], ebx
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	eax, 1
		cpuid
		mov	[ebp+var_4], edx
		mov	[ebp+var_8], eax

loc_100119D6:				; CODE XREF: sub_10011991+24j
		pop	ebx
		test	[ebp+var_4], 4000000h
		jz	short loc_100119EE
		call	sub_10011941
		test	eax, eax
		jz	short loc_100119EE
		xor	eax, eax
		inc	eax
		jmp	short loc_100119F0
; ---------------------------------------------------------------------------

loc_100119EE:				; CODE XREF: sub_10011991+4Dj
					; sub_10011991+56j
		xor	eax, eax

loc_100119F0:				; CODE XREF: sub_10011991+5Bj
		pop	ebx
		leave
		retn
sub_10011991	endp


; =============== S U B	R O U T	I N E =======================================


sub_100119F3	proc near		; DATA XREF: .rdata:100271F4o
		call	sub_10011991
		mov	dword_1002F1CC,	eax
		xor	eax, eax
		retn
sub_100119F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011A00	proc near		; CODE XREF: sub_10011A87+4Dp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+var_4], edi
		mov	[ebp+var_8], esi
		mov	esi, [ebp+arg_4]
		mov	edi, [ebp+arg_0]
		mov	ecx, [ebp+arg_8]
		shr	ecx, 7
		jmp	short loc_10011A20
; ---------------------------------------------------------------------------
		align 10h

loc_10011A20:				; CODE XREF: sub_10011A00+18j
					; sub_10011A00+7Bj
		movdqa	xmm0, xmmword ptr [esi]
		movdqa	xmm1, xmmword ptr [esi+10h]
		movdqa	xmm2, xmmword ptr [esi+20h]
		movdqa	xmm3, xmmword ptr [esi+30h]
		movdqa	xmmword	ptr [edi], xmm0
		movdqa	xmmword	ptr [edi+10h], xmm1
		movdqa	xmmword	ptr [edi+20h], xmm2
		movdqa	xmmword	ptr [edi+30h], xmm3
		movdqa	xmm4, xmmword ptr [esi+40h]
		movdqa	xmm5, xmmword ptr [esi+50h]
		movdqa	xmm6, xmmword ptr [esi+60h]
		movdqa	xmm7, xmmword ptr [esi+70h]
		movdqa	xmmword	ptr [edi+40h], xmm4
		movdqa	xmmword	ptr [edi+50h], xmm5
		movdqa	xmmword	ptr [edi+60h], xmm6
		movdqa	xmmword	ptr [edi+70h], xmm7
		lea	esi, [esi+80h]
		lea	edi, [edi+80h]
		dec	ecx
		jnz	short loc_10011A20
		mov	esi, [ebp+var_8]
		mov	edi, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_10011A00	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011A87	proc near		; CODE XREF: sub_1000E2B0+42j
					; sub_10011A87+AFp ...

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	[ebp+var_C], edi
		mov	[ebp+var_8], esi
		mov	[ebp+var_4], ebx
		mov	ebx, [ebp+arg_4]
		mov	eax, ebx
		cdq
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		xor	ecx, edx
		sub	ecx, edx
		and	ecx, 0Fh
		xor	ecx, edx
		sub	ecx, edx
		cdq
		mov	edi, eax
		xor	edi, edx
		sub	edi, edx
		and	edi, 0Fh
		xor	edi, edx
		sub	edi, edx
		mov	edx, ecx
		or	edx, edi
		jnz	short loc_10011B0A
		mov	esi, [ebp+arg_8]
		mov	ecx, esi
		and	ecx, 7Fh
		mov	[ebp+var_18], ecx
		cmp	esi, ecx
		jz	short loc_10011AE2
		sub	esi, ecx
		push	esi
		push	ebx
		push	eax
		call	sub_10011A00
		add	esp, 0Ch
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_18]

loc_10011AE2:				; CODE XREF: sub_10011A87+46j
		test	ecx, ecx
		jz	short loc_10011B5D
		mov	ebx, [ebp+arg_8]
		mov	edx, [ebp+arg_4]
		add	edx, ebx
		sub	edx, ecx
		mov	[ebp+var_14], edx
		add	ebx, eax
		sub	ebx, ecx
		mov	[ebp+var_10], ebx
		mov	esi, [ebp+var_14]
		mov	edi, [ebp+var_10]
		mov	ecx, [ebp+var_18]
		rep movsb
		mov	eax, [ebp+arg_0]
		jmp	short loc_10011B5D
; ---------------------------------------------------------------------------

loc_10011B0A:				; CODE XREF: sub_10011A87+37j
		cmp	ecx, edi
		jnz	short loc_10011B43
		neg	ecx
		add	ecx, 10h
		mov	[ebp+var_1C], ecx
		mov	esi, [ebp+arg_4]
		mov	edi, [ebp+arg_0]
		mov	ecx, [ebp+var_1C]
		rep movsb
		mov	ecx, [ebp+arg_0]
		add	ecx, [ebp+var_1C]
		mov	edx, [ebp+arg_4]
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		sub	eax, [ebp+var_1C]
		push	eax
		push	edx
		push	ecx
		call	sub_10011A87
		add	esp, 0Ch
		mov	eax, [ebp+arg_0]
		jmp	short loc_10011B5D
; ---------------------------------------------------------------------------

loc_10011B43:				; CODE XREF: sub_10011A87+85j
		mov	esi, [ebp+arg_4]
		mov	edi, [ebp+arg_0]
		mov	ecx, [ebp+arg_8]
		mov	edx, ecx
		shr	ecx, 2
		rep movsd
		mov	ecx, edx
		and	ecx, 3
		rep movsb
		mov	eax, [ebp+arg_0]

loc_10011B5D:				; CODE XREF: sub_10011A87+5Dj
					; sub_10011A87+81j ...
		mov	ebx, [ebp+var_4]
		mov	esi, [ebp+var_8]
		mov	edi, [ebp+var_C]
		mov	esp, ebp
		pop	ebp
		retn
sub_10011A87	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011B6A	proc near		; CODE XREF: sub_10011EB7+120p
					; sub_10011EB7+175p
		sub	eax, 3A4h
		jz	short loc_10011B93
		sub	eax, 4
		jz	short loc_10011B8D
		sub	eax, 0Dh
		jz	short loc_10011B87
		dec	eax
		jz	short loc_10011B81
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10011B81:				; CODE XREF: sub_10011B6A+12j
		mov	eax, 404h
		retn
; ---------------------------------------------------------------------------

loc_10011B87:				; CODE XREF: sub_10011B6A+Fj
		mov	eax, 412h
		retn
; ---------------------------------------------------------------------------

loc_10011B8D:				; CODE XREF: sub_10011B6A+Aj
		mov	eax, 804h
		retn
; ---------------------------------------------------------------------------

loc_10011B93:				; CODE XREF: sub_10011B6A+5j
		mov	eax, 411h
		retn
sub_10011B6A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011B99	proc near		; CODE XREF: sub_10011EB7+2Dp
		mov	edi, edi
		push	esi
		push	edi
		mov	esi, eax
		push	101h
		xor	edi, edi
		lea	eax, [esi+1Ch]
		push	edi
		push	eax
		call	sub_1000E0F0
		xor	eax, eax
		movzx	ecx, ax
		mov	eax, ecx
		mov	[esi+4], edi
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		shl	ecx, 10h
		or	eax, ecx
		lea	edi, [esi+10h]
		stosd
		stosd
		stosd
		mov	ecx, offset Addend
		add	esp, 0Ch
		lea	eax, [esi+1Ch]
		sub	ecx, esi
		mov	edi, 101h

loc_10011BDD:				; CODE XREF: sub_10011B99+4Bj
		mov	dl, [ecx+eax]
		mov	[eax], dl
		inc	eax
		dec	edi
		jnz	short loc_10011BDD
		lea	eax, [esi+11Dh]
		mov	esi, 100h

loc_10011BF1:				; CODE XREF: sub_10011B99+5Fj
		mov	dl, [eax+ecx]
		mov	[eax], dl
		inc	eax
		dec	esi
		jnz	short loc_10011BF1
		pop	edi
		pop	esi
		retn
sub_10011B99	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011BFD	proc near		; CODE XREF: sub_10011EB7+143p

var_51C		= dword	ptr -51Ch
CPInfo		= _cpinfo ptr -518h
CharType	= word ptr -504h
var_304		= word ptr -304h
DestStr		= word ptr -204h
MultiByteStr	= byte ptr -104h
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 51Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	edi
		lea	eax, [ebp+CPInfo]
		push	eax		; lpCPInfo
		push	dword ptr [esi+4] ; CodePage
		call	ds:GetCPInfo
		mov	edi, 100h
		test	eax, eax
		jz	loc_10011D2C
		xor	eax, eax

loc_10011C33:				; CODE XREF: sub_10011BFD+40j
		mov	[ebp+eax+MultiByteStr],	al
		inc	eax
		cmp	eax, edi
		jb	short loc_10011C33
		mov	al, [ebp+CPInfo.LeadByte]
		mov	[ebp+MultiByteStr], 20h
		test	al, al
		jz	short loc_10011C7E
		lea	ebx, [ebp+CPInfo.LeadByte+1]

loc_10011C56:				; CODE XREF: sub_10011BFD+7Fj
		movzx	ecx, al
		movzx	eax, byte ptr [ebx]
		cmp	ecx, eax
		ja	short loc_10011C76
		sub	eax, ecx
		inc	eax
		push	eax
		lea	edx, [ebp+ecx+MultiByteStr]
		push	20h
		push	edx
		call	sub_1000E0F0
		add	esp, 0Ch

loc_10011C76:				; CODE XREF: sub_10011BFD+61j
		inc	ebx
		mov	al, [ebx]
		inc	ebx
		test	al, al
		jnz	short loc_10011C56

loc_10011C7E:				; CODE XREF: sub_10011BFD+51j
		push	0		; int
		push	dword ptr [esi+0Ch] ; Locale
		lea	eax, [ebp+CharType]
		push	dword ptr [esi+4] ; CodePage
		push	eax		; lpCharType
		push	edi		; cbMultiByte
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	1		; dwInfoType
		push	0		; int
		call	sub_10019DA5
		xor	ebx, ebx
		push	ebx		; int
		push	dword ptr [esi+4] ; CodePage
		lea	eax, [ebp+DestStr]
		push	edi		; cchDest
		push	eax		; lpDestStr
		push	edi		; cbMultiByte
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	edi		; dwMapFlags
		push	dword ptr [esi+0Ch] ; Locale
		push	ebx		; int
		call	sub_10017580
		add	esp, 44h
		push	ebx		; int
		push	dword ptr [esi+4] ; CodePage
		lea	eax, [ebp+var_304]
		push	edi		; cchDest
		push	eax		; lpDestStr
		push	edi		; cbMultiByte
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	200h		; dwMapFlags
		push	dword ptr [esi+0Ch] ; Locale
		push	ebx		; int
		call	sub_10017580
		add	esp, 24h
		xor	eax, eax

loc_10011CE8:				; CODE XREF: sub_10011BFD+12Bj
		movzx	ecx, [ebp+eax*2+CharType]
		test	cl, 1
		jz	short loc_10011D03
		or	byte ptr [esi+eax+1Dh],	10h
		mov	cl, byte ptr [ebp+eax+DestStr]
		jmp	short loc_10011D14
; ---------------------------------------------------------------------------

loc_10011D03:				; CODE XREF: sub_10011BFD+F6j
		test	cl, 2
		jz	short loc_10011D1D
		or	byte ptr [esi+eax+1Dh],	20h
		mov	cl, byte ptr [ebp+eax+var_304]

loc_10011D14:				; CODE XREF: sub_10011BFD+104j
		mov	[esi+eax+11Dh],	cl
		jmp	short loc_10011D25
; ---------------------------------------------------------------------------

loc_10011D1D:				; CODE XREF: sub_10011BFD+109j
		mov	byte ptr [esi+eax+11Dh], 0

loc_10011D25:				; CODE XREF: sub_10011BFD+11Ej
		inc	eax
		cmp	eax, edi
		jb	short loc_10011CE8
		jmp	short loc_10011D82
; ---------------------------------------------------------------------------

loc_10011D2C:				; CODE XREF: sub_10011BFD+2Ej
		lea	eax, [esi+11Dh]
		mov	[ebp+var_51C], 0FFFFFF9Fh
		xor	ecx, ecx
		sub	[ebp+var_51C], eax

loc_10011D44:				; CODE XREF: sub_10011BFD+183j
		mov	edx, [ebp+var_51C]
		lea	eax, [esi+ecx+11Dh]
		add	edx, eax
		lea	ebx, [edx+20h]
		cmp	ebx, 19h
		ja	short loc_10011D67
		or	byte ptr [esi+ecx+1Dh],	10h
		mov	dl, cl
		add	dl, 20h
		jmp	short loc_10011D76
; ---------------------------------------------------------------------------

loc_10011D67:				; CODE XREF: sub_10011BFD+15Cj
		cmp	edx, 19h
		ja	short loc_10011D7A
		or	byte ptr [esi+ecx+1Dh],	20h
		mov	dl, cl
		sub	dl, 20h

loc_10011D76:				; CODE XREF: sub_10011BFD+168j
		mov	[eax], dl
		jmp	short loc_10011D7D
; ---------------------------------------------------------------------------

loc_10011D7A:				; CODE XREF: sub_10011BFD+16Dj
		mov	byte ptr [eax],	0

loc_10011D7D:				; CODE XREF: sub_10011BFD+17Bj
		inc	ecx
		cmp	ecx, edi
		jb	short loc_10011D44

loc_10011D82:				; CODE XREF: sub_10011BFD+12Dj
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10011BFD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011D90	proc near		; CODE XREF: sub_1000E615+67p
					; sub_100120AC+1Ap ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

; FUNCTION CHUNK AT 10011E24 SIZE 00000017 BYTES

		push	0Ch
		push	offset stru_1002B498
		call	__SEH_prolog4
		call	sub_10013828
		mov	edi, eax
		test	byte ptr [edi+70h], 2
		jnz	short loc_10011DB2
		test	byte ptr dword_1002DA84, 1
		jnz	short loc_10011DB8

loc_10011DB2:				; CODE XREF: sub_10011D90+17j
		cmp	dword ptr [edi+6Ch], 0
		jnz	short loc_10011E24

loc_10011DB8:				; CODE XREF: sub_10011D90+20j
		push	0Dh
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	esi, [edi+68h]
		mov	[ebp+var_1C], esi
		cmp	esi, lpAddend
		jz	short loc_10011E08
		test	esi, esi
		jz	short loc_10011DF0
		push	esi		; lpAddend
		call	ds:InterlockedDecrement
		test	eax, eax
		jnz	short loc_10011DF0
		cmp	esi, offset Addend
		jz	short loc_10011DF0
		push	esi		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10011DF0:				; CODE XREF: sub_10011D90+44j
					; sub_10011D90+4Fj ...
		mov	eax, lpAddend
		mov	[edi+68h], eax
		mov	esi, lpAddend
		mov	[ebp+var_1C], esi
		push	esi		; lpAddend
		call	ds:InterlockedIncrement

loc_10011E08:				; CODE XREF: sub_10011D90+40j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10011E19
; ---------------------------------------------------------------------------

loc_10011E14:				; CODE XREF: sub_10011D90+91j
		jmp	short loc_10011E27
; ---------------------------------------------------------------------------

loc_10011E16:				; DATA XREF: .rdata:stru_1002B498o
		mov	esi, [ebp+var_1C] ; Finally handler 0 for function 10011D90

loc_10011E19:				; CODE XREF: sub_10011D90+7Fj
		push	0Dh
		call	sub_100151D0
		pop	ecx
		retn
sub_10011D90	endp

; ---------------------------------------------------------------------------
		jmp	short loc_10011E27
; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10011D90

loc_10011E24:				; CODE XREF: sub_10011D90+26j
		mov	esi, [edi+68h]

loc_10011E27:				; CODE XREF: sub_10011D90:loc_10011E14j
					; .text:10011E22j
		test	esi, esi
		jnz	short loc_10011E33
		push	20h
		call	sub_100164A2
		pop	ecx

loc_10011E33:				; CODE XREF: sub_10011D90+99j
		mov	eax, esi
		call	__SEH_epilog4
		retn
; END OF FUNCTION CHUNK	FOR sub_10011D90

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011E3B	proc near		; CODE XREF: sub_10011EB7+1Bp
					; sub_100120AC+25p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		xor	ebx, ebx
		push	ebx
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	dword_1002E600,	ebx
		cmp	esi, 0FFFFFFFEh
		jnz	short loc_10011E78
		mov	dword_1002E600,	1
		call	ds:GetOEMCP

loc_10011E6A:				; CODE XREF: sub_10011E3B+52j
					; sub_10011E3B+69j
		cmp	[ebp+var_4], bl
		jz	short loc_10011EB4
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	short loc_10011EB4
; ---------------------------------------------------------------------------

loc_10011E78:				; CODE XREF: sub_10011E3B+1Dj
		cmp	esi, 0FFFFFFFDh
		jnz	short loc_10011E8F
		mov	dword_1002E600,	1
		call	ds:GetACP
		jmp	short loc_10011E6A
; ---------------------------------------------------------------------------

loc_10011E8F:				; CODE XREF: sub_10011E3B+40j
		cmp	esi, 0FFFFFFFCh
		jnz	short loc_10011EA6
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	dword_1002E600,	1
		jmp	short loc_10011E6A
; ---------------------------------------------------------------------------

loc_10011EA6:				; CODE XREF: sub_10011E3B+57j
		cmp	[ebp+var_4], bl
		jz	short loc_10011EB2
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10011EB2:				; CODE XREF: sub_10011E3B+6Ej
		mov	eax, esi

loc_10011EB4:				; CODE XREF: sub_10011E3B+32j
					; sub_10011E3B+3Bj
		pop	ebx
		leave
		retn
sub_10011E3B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011EB7	proc near		; CODE XREF: sub_100120AC+5Ep
					; .text:10013380p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
CPInfo		= _cpinfo ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_4]
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		call	sub_10011E3B
		mov	edi, eax
		xor	esi, esi
		mov	[ebp+arg_0], edi
		cmp	edi, esi
		jnz	short loc_10011EF0

loc_10011EE2:				; CODE XREF: sub_10011EB7+19Fj
		mov	eax, ebx
		call	sub_10011B99

loc_10011EE9:				; CODE XREF: sub_10011EB7+148j
		xor	eax, eax
		jmp	loc_1001205F
; ---------------------------------------------------------------------------

loc_10011EF0:				; CODE XREF: sub_10011EB7+29j
		mov	[ebp+var_1C], esi
		xor	eax, eax

loc_10011EF5:				; CODE XREF: sub_10011EB7+51j
		cmp	dword_1002D990[eax], edi
		jz	short loc_10011F64
		inc	[ebp+var_1C]
		add	eax, 30h
		cmp	eax, 0F0h
		jb	short loc_10011EF5
		lea	eax, [ebp+CPInfo]
		push	eax		; lpCPInfo
		push	edi		; CodePage
		call	ds:GetCPInfo
		test	eax, eax
		jz	loc_10012050
		push	101h
		lea	eax, [ebx+1Ch]
		push	esi
		push	eax
		call	sub_1000E0F0
		xor	edx, edx
		inc	edx
		add	esp, 0Ch
		mov	[ebx+4], edi
		mov	[ebx+0Ch], esi
		cmp	[ebp+CPInfo.MaxCharSize], edx
		jbe	loc_10012039
		cmp	[ebp+CPInfo.LeadByte], 0
		jz	loc_1001201A
		lea	esi, [ebp+CPInfo.LeadByte+1]

loc_10011F4E:				; CODE XREF: sub_10011EB7+15Dj
		mov	cl, [esi]
		test	cl, cl
		jz	loc_1001201A
		movzx	eax, byte ptr [esi-1]
		movzx	ecx, cl
		jmp	loc_1001200A
; ---------------------------------------------------------------------------

loc_10011F64:				; CODE XREF: sub_10011EB7+44j
		push	101h
		lea	eax, [ebx+1Ch]
		push	esi
		push	eax
		call	sub_1000E0F0
		mov	ecx, [ebp+var_1C]
		add	esp, 0Ch
		imul	ecx, 30h
		mov	[ebp+var_20], esi
		lea	esi, aJ[ecx]	; ""
		mov	[ebp+var_1C], esi
		jmp	short loc_10011FB4
; ---------------------------------------------------------------------------

loc_10011F8A:				; CODE XREF: sub_10011EB7+100j
		mov	al, [esi+1]
		test	al, al
		jz	short loc_10011FB9
		movzx	edi, byte ptr [esi]
		movzx	eax, al
		jmp	short loc_10011FAB
; ---------------------------------------------------------------------------

loc_10011F99:				; CODE XREF: sub_10011EB7+F6j
		mov	eax, [ebp+var_20]
		mov	al, byte_1002D98C[eax]
		or	[ebx+edi+1Dh], al
		movzx	eax, byte ptr [esi+1]
		inc	edi

loc_10011FAB:				; CODE XREF: sub_10011EB7+E0j
		cmp	edi, eax
		jbe	short loc_10011F99
		mov	edi, [ebp+arg_0]
		inc	esi
		inc	esi

loc_10011FB4:				; CODE XREF: sub_10011EB7+D1j
					; sub_10011EB7+112j
		cmp	byte ptr [esi],	0
		jnz	short loc_10011F8A

loc_10011FB9:				; CODE XREF: sub_10011EB7+D8j
		mov	esi, [ebp+var_1C]
		inc	[ebp+var_20]
		add	esi, 8
		cmp	[ebp+var_20], 4
		mov	[ebp+var_1C], esi
		jb	short loc_10011FB4
		mov	eax, edi
		mov	[ebx+4], edi
		mov	dword ptr [ebx+8], 1
		call	sub_10011B6A
		push	6
		mov	[ebx+0Ch], eax
		lea	eax, [ebx+10h]
		lea	ecx, aVyv[ecx]	; "`y!"
		pop	edx

loc_10011FEB:				; CODE XREF: sub_10011EB7+13Fj
		mov	si, [ecx]
		inc	ecx
		mov	[eax], si
		inc	ecx
		inc	eax
		inc	eax
		dec	edx
		jnz	short loc_10011FEB

loc_10011FF8:				; CODE XREF: sub_10011EB7+197j
		mov	esi, ebx
		call	sub_10011BFD
		jmp	loc_10011EE9
; ---------------------------------------------------------------------------

loc_10012004:				; CODE XREF: sub_10011EB7+155j
		or	byte ptr [ebx+eax+1Dh],	4
		inc	eax

loc_1001200A:				; CODE XREF: sub_10011EB7+A8j
		cmp	eax, ecx
		jbe	short loc_10012004
		inc	esi
		inc	esi
		cmp	byte ptr [esi-1], 0
		jnz	loc_10011F4E

loc_1001201A:				; CODE XREF: sub_10011EB7+8Ej
					; sub_10011EB7+9Bj
		lea	eax, [ebx+1Eh]
		mov	ecx, 0FEh

loc_10012022:				; CODE XREF: sub_10011EB7+170j
		or	byte ptr [eax],	8
		inc	eax
		dec	ecx
		jnz	short loc_10012022
		mov	eax, [ebx+4]
		call	sub_10011B6A
		mov	[ebx+0Ch], eax
		mov	[ebx+8], edx
		jmp	short loc_1001203C
; ---------------------------------------------------------------------------

loc_10012039:				; CODE XREF: sub_10011EB7+84j
		mov	[ebx+8], esi

loc_1001203C:				; CODE XREF: sub_10011EB7+180j
		xor	eax, eax
		movzx	ecx, ax
		mov	eax, ecx
		shl	ecx, 10h
		or	eax, ecx
		lea	edi, [ebx+10h]
		stosd
		stosd
		stosd
		jmp	short loc_10011FF8
; ---------------------------------------------------------------------------

loc_10012050:				; CODE XREF: sub_10011EB7+60j
		cmp	dword_1002E600,	esi
		jnz	loc_10011EE2
		or	eax, 0FFFFFFFFh

loc_1001205F:				; CODE XREF: sub_10011EB7+34j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10011EB7	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	0
		lea	ecx, [ebp-10h]
		call	sub_1000E615
		mov	eax, [ebp-0Ch]
		cmp	dword ptr [eax+8], 0
		jz	short loc_1001209B
		cmp	byte ptr [ebp-4], 0
		mov	eax, [eax+4]
		jz	short locret_100120AA
		mov	ecx, [ebp-8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		leave
		retn
; ---------------------------------------------------------------------------

loc_1001209B:				; CODE XREF: .text:10012087j
		cmp	byte ptr [ebp-4], 0
		jz	short loc_100120A8
		mov	eax, [ebp-8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_100120A8:				; CODE XREF: .text:1001209Fj
		xor	eax, eax

locret_100120AA:			; CODE XREF: .text:10012090j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100120AC	proc near		; CODE XREF: sub_10012246+Bp

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

; FUNCTION CHUNK AT 10012218 SIZE 0000002E BYTES

		push	14h
		push	offset stru_1002B4B8
		call	__SEH_prolog4
		or	[ebp+var_20], 0FFFFFFFFh
		call	sub_10013828
		mov	edi, eax
		mov	[ebp+var_24], edi
		call	sub_10011D90
		mov	ebx, [edi+68h]
		mov	esi, [ebp+arg_0]
		call	sub_10011E3B
		mov	[ebp+arg_0], eax
		cmp	eax, [ebx+4]
		jz	loc_10012239
		push	220h
		call	sub_1000F5A0
		pop	ecx
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_1001223D
		mov	ecx, 88h
		mov	esi, [edi+68h]
		mov	edi, ebx
		rep movsd
		and	dword ptr [ebx], 0
		push	ebx
		push	[ebp+arg_0]
		call	sub_10011EB7
		pop	ecx
		pop	ecx
		mov	[ebp+var_20], eax
		test	eax, eax
		jnz	loc_10012218
		mov	esi, [ebp+var_24]
		push	dword ptr [esi+68h] ; lpAddend
		call	ds:InterlockedDecrement
		test	eax, eax
		jnz	short loc_1001213D
		mov	eax, [esi+68h]
		cmp	eax, offset Addend
		jz	short loc_1001213D
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001213D:				; CODE XREF: sub_100120AC+7Ej
					; sub_100120AC+88j
		mov	[esi+68h], ebx
		push	ebx		; lpAddend
		mov	edi, ds:InterlockedIncrement
		call	edi ; InterlockedIncrement
		test	byte ptr [esi+70h], 2
		jnz	loc_1001223D
		test	byte ptr dword_1002DA84, 1
		jz	loc_1001223D
		push	0Dh
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	eax, [ebx+4]
		mov	dword_1002E610,	eax
		mov	eax, [ebx+8]
		mov	dword_1002E614,	eax
		mov	eax, [ebx+0Ch]
		mov	dword_1002E618,	eax
		xor	eax, eax

loc_10012186:				; CODE XREF: sub_100120AC+F0j
		mov	[ebp+var_1C], eax
		cmp	eax, 5
		jge	short loc_1001219E
		mov	cx, [ebx+eax*2+10h]
		mov	word_1002E604[eax*2], cx
		inc	eax
		jmp	short loc_10012186
; ---------------------------------------------------------------------------

loc_1001219E:				; CODE XREF: sub_100120AC+E0j
		xor	eax, eax

loc_100121A0:				; CODE XREF: sub_100120AC+109j
		mov	[ebp+var_1C], eax
		cmp	eax, 101h
		jge	short loc_100121B7
		mov	cl, [eax+ebx+1Ch]
		mov	byte_1002D780[eax], cl
		inc	eax
		jmp	short loc_100121A0
; ---------------------------------------------------------------------------

loc_100121B7:				; CODE XREF: sub_100120AC+FCj
		xor	eax, eax

loc_100121B9:				; CODE XREF: sub_100120AC+125j
		mov	[ebp+var_1C], eax
		cmp	eax, 100h
		jge	short loc_100121D3
		mov	cl, [eax+ebx+11Dh]
		mov	byte_1002D888[eax], cl
		inc	eax
		jmp	short loc_100121B9
; ---------------------------------------------------------------------------

loc_100121D3:				; CODE XREF: sub_100120AC+115j
		push	lpAddend	; lpAddend
		call	ds:InterlockedDecrement
		test	eax, eax
		jnz	short loc_100121F6
		mov	eax, lpAddend
		cmp	eax, offset Addend
		jz	short loc_100121F6
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_100121F6:				; CODE XREF: sub_100120AC+135j
					; sub_100120AC+141j
		mov	lpAddend, ebx
		push	ebx		; lpAddend
		call	edi ; InterlockedIncrement
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1001220D	; Finally handler 0 for	function 100120AC
; ---------------------------------------------------------------------------

loc_1001220B:				; CODE XREF: sub_100120AC+169j
		jmp	short loc_1001223D
; ---------------------------------------------------------------------------

loc_1001220D:				; CODE XREF: sub_100120AC+15Aj
					; DATA XREF: .rdata:stru_1002B4B8o
		push	0Dh		; Finally handler 0 for	function 100120AC
		call	sub_100151D0
		pop	ecx
		retn
sub_100120AC	endp

; ---------------------------------------------------------------------------
		jmp	short loc_1001223D
; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_100120AC

loc_10012218:				; CODE XREF: sub_100120AC+6Aj
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001223D
		cmp	ebx, offset Addend
		jz	short loc_1001222C
		push	ebx		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001222C:				; CODE XREF: sub_100120AC+177j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		jmp	short loc_1001223D
; ---------------------------------------------------------------------------

loc_10012239:				; CODE XREF: sub_100120AC+30j
		and	[ebp+var_20], 0

loc_1001223D:				; CODE XREF: sub_100120AC+45j
					; sub_100120AC+A1j ...
		mov	eax, [ebp+var_20]
		call	__SEH_epilog4
		retn
; END OF FUNCTION CHUNK	FOR sub_100120AC

; =============== S U B	R O U T	I N E =======================================


sub_10012246	proc near		; CODE XREF: sub_100195CB+13p
					; sub_1001992E+1Bp
					; DATA XREF: ...
		cmp	dword_1002F18C,	0
		jnz	short loc_10012261
		push	0FFFFFFFDh
		call	sub_100120AC
		pop	ecx
		mov	dword_1002F18C,	1

loc_10012261:				; CODE XREF: sub_10012246+7j
		xor	eax, eax
		retn
sub_10012246	endp

; ---------------------------------------------------------------------------
		mov	eax, dword_1002F1C4
		retn
; ---------------------------------------------------------------------------
		mov	eax, offset dword_1002F1C8
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10012270(LPVOID lpMem)
sub_10012270	proc near		; CODE XREF: sub_10012507+31p
					; .text:100126DEp ...

lpMem		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+lpMem]
		mov	eax, [esi+0BCh]
		xor	ebx, ebx
		push	edi
		cmp	eax, ebx
		jz	short loc_100122F6
		cmp	eax, offset off_1002E120
		jz	short loc_100122F6
		mov	eax, [esi+0B0h]
		cmp	eax, ebx
		jz	short loc_100122F6
		cmp	[eax], ebx
		jnz	short loc_100122F6
		mov	eax, [esi+0B8h]
		cmp	eax, ebx
		jz	short loc_100122BD
		cmp	[eax], ebx
		jnz	short loc_100122BD
		push	eax		; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0BCh]
		call	sub_1001ACCD
		pop	ecx
		pop	ecx

loc_100122BD:				; CODE XREF: sub_10012270+34j
					; sub_10012270+38j
		mov	eax, [esi+0B4h]
		cmp	eax, ebx
		jz	short loc_100122DE
		cmp	[eax], ebx
		jnz	short loc_100122DE
		push	eax		; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0BCh]
		call	sub_1001AA3E
		pop	ecx
		pop	ecx

loc_100122DE:				; CODE XREF: sub_10012270+55j
					; sub_10012270+59j
		push	dword ptr [esi+0B0h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0BCh] ; lpMem
		call	sub_1000EE73
		pop	ecx
		pop	ecx

loc_100122F6:				; CODE XREF: sub_10012270+15j
					; sub_10012270+1Cj ...
		mov	eax, [esi+0C0h]
		cmp	eax, ebx
		jz	short loc_10012344
		cmp	[eax], ebx
		jnz	short loc_10012344
		mov	eax, [esi+0C4h]
		sub	eax, 0FEh
		push	eax		; lpMem
		call	sub_1000EE73
		mov	eax, [esi+0CCh]
		mov	edi, 80h
		sub	eax, edi
		push	eax		; lpMem
		call	sub_1000EE73
		mov	eax, [esi+0D0h]
		sub	eax, edi
		push	eax		; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0C0h] ; lpMem
		call	sub_1000EE73
		add	esp, 10h

loc_10012344:				; CODE XREF: sub_10012270+8Ej
					; sub_10012270+92j
		lea	edi, [esi+0D4h]
		mov	eax, [edi]
		cmp	eax, offset off_1002DFB0
		jz	short loc_1001236A
		cmp	[eax+0B4h], ebx
		jnz	short loc_1001236A
		push	eax
		call	sub_1001A619
		push	dword ptr [edi]	; lpMem
		call	sub_1000EE73
		pop	ecx
		pop	ecx

loc_1001236A:				; CODE XREF: sub_10012270+E1j
					; sub_10012270+E9j
		lea	edi, [esi+50h]
		mov	[ebp+lpMem], 6

loc_10012374:				; CODE XREF: sub_10012270+13Bj
		cmp	dword ptr [edi-8], offset dword_1002DA88
		jz	short loc_1001238E
		mov	eax, [edi]
		cmp	eax, ebx
		jz	short loc_1001238E
		cmp	[eax], ebx
		jnz	short loc_1001238E
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001238E:				; CODE XREF: sub_10012270+10Bj
					; sub_10012270+111j ...
		cmp	[edi-4], ebx
		jz	short loc_100123A5
		mov	eax, [edi+4]
		cmp	eax, ebx
		jz	short loc_100123A5
		cmp	[eax], ebx
		jnz	short loc_100123A5
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_100123A5:				; CODE XREF: sub_10012270+121j
					; sub_10012270+128j ...
		add	edi, 10h
		dec	[ebp+lpMem]
		jnz	short loc_10012374
		push	esi		; lpMem
		call	sub_1000EE73
		pop	ecx
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10012270	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100123B9(volatile LONG *lpAddend)
sub_100123B9	proc near		; CODE XREF: sub_100124E1+1Dp
					; sub_10012507+12p ...

lpAddend	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, ds:InterlockedIncrement
		push	edi
		mov	edi, [ebp+lpAddend]
		push	edi		; lpAddend
		call	esi ; InterlockedIncrement
		mov	eax, [edi+0B0h]
		test	eax, eax
		jz	short loc_100123DA
		push	eax		; lpAddend
		call	esi ; InterlockedIncrement

loc_100123DA:				; CODE XREF: sub_100123B9+1Cj
		mov	eax, [edi+0B8h]
		test	eax, eax
		jz	short loc_100123E7
		push	eax		; lpAddend
		call	esi ; InterlockedIncrement

loc_100123E7:				; CODE XREF: sub_100123B9+29j
		mov	eax, [edi+0B4h]
		test	eax, eax
		jz	short loc_100123F4
		push	eax		; lpAddend
		call	esi ; InterlockedIncrement

loc_100123F4:				; CODE XREF: sub_100123B9+36j
		mov	eax, [edi+0C0h]
		test	eax, eax
		jz	short loc_10012401
		push	eax		; lpAddend
		call	esi ; InterlockedIncrement

loc_10012401:				; CODE XREF: sub_100123B9+43j
		lea	ebx, [edi+50h]
		mov	[ebp+lpAddend],	6

loc_1001240B:				; CODE XREF: sub_100123B9+7Aj
		cmp	dword ptr [ebx-8], offset dword_1002DA88
		jz	short loc_1001241D
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_1001241D
		push	eax		; lpAddend
		call	esi ; InterlockedIncrement

loc_1001241D:				; CODE XREF: sub_100123B9+59j
					; sub_100123B9+5Fj
		cmp	dword ptr [ebx-4], 0
		jz	short loc_1001242D
		mov	eax, [ebx+4]
		test	eax, eax
		jz	short loc_1001242D
		push	eax		; lpAddend
		call	esi ; InterlockedIncrement

loc_1001242D:				; CODE XREF: sub_100123B9+68j
					; sub_100123B9+6Fj
		add	ebx, 10h
		dec	[ebp+lpAddend]
		jnz	short loc_1001240B
		mov	eax, [edi+0D4h]
		add	eax, 0B4h
		push	eax		; lpAddend
		call	esi ; InterlockedIncrement
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_100123B9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10012448(volatile LONG *lpAddend)
sub_10012448	proc near		; CODE XREF: sub_10012507+1Dp
					; .text:100126C6p ...

lpAddend	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	edi
		mov	edi, [ebp+lpAddend]
		test	edi, edi
		jz	loc_100124DC
		push	ebx
		push	esi
		mov	esi, ds:InterlockedDecrement
		push	edi		; lpAddend
		call	esi ; InterlockedDecrement
		mov	eax, [edi+0B0h]
		test	eax, eax
		jz	short loc_10012471
		push	eax		; lpAddend
		call	esi ; InterlockedDecrement

loc_10012471:				; CODE XREF: sub_10012448+24j
		mov	eax, [edi+0B8h]
		test	eax, eax
		jz	short loc_1001247E
		push	eax		; lpAddend
		call	esi ; InterlockedDecrement

loc_1001247E:				; CODE XREF: sub_10012448+31j
		mov	eax, [edi+0B4h]
		test	eax, eax
		jz	short loc_1001248B
		push	eax		; lpAddend
		call	esi ; InterlockedDecrement

loc_1001248B:				; CODE XREF: sub_10012448+3Ej
		mov	eax, [edi+0C0h]
		test	eax, eax
		jz	short loc_10012498
		push	eax		; lpAddend
		call	esi ; InterlockedDecrement

loc_10012498:				; CODE XREF: sub_10012448+4Bj
		lea	ebx, [edi+50h]
		mov	[ebp+lpAddend],	6

loc_100124A2:				; CODE XREF: sub_10012448+82j
		cmp	dword ptr [ebx-8], offset dword_1002DA88
		jz	short loc_100124B4
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_100124B4
		push	eax		; lpAddend
		call	esi ; InterlockedDecrement

loc_100124B4:				; CODE XREF: sub_10012448+61j
					; sub_10012448+67j
		cmp	dword ptr [ebx-4], 0
		jz	short loc_100124C4
		mov	eax, [ebx+4]
		test	eax, eax
		jz	short loc_100124C4
		push	eax		; lpAddend
		call	esi ; InterlockedDecrement

loc_100124C4:				; CODE XREF: sub_10012448+70j
					; sub_10012448+77j
		add	ebx, 10h
		dec	[ebp+lpAddend]
		jnz	short loc_100124A2
		mov	eax, [edi+0D4h]
		add	eax, 0B4h
		push	eax		; lpAddend
		call	esi ; InterlockedDecrement
		pop	esi
		pop	ebx

loc_100124DC:				; CODE XREF: sub_10012448+Bj
		mov	eax, edi
		pop	edi
		pop	ebp
		retn
sub_10012448	endp


; =============== S U B	R O U T	I N E =======================================


sub_100124E1	proc near		; CODE XREF: .text:1001334Ep
					; .text:1001343Dp
		mov	edi, edi
		push	esi
		mov	esi, ecx
		test	esi, esi
		jz	short loc_10012505
		test	eax, eax
		jz	short loc_10012505
		cmp	eax, esi
		jz	short loc_10012505
		push	edi
		push	36h
		pop	ecx
		mov	edi, eax
		rep movsd
		and	dword ptr [eax], 0
		push	eax		; lpAddend
		call	sub_100123B9
		pop	ecx
		pop	edi

loc_10012505:				; CODE XREF: sub_100124E1+7j
					; sub_100124E1+Bj ...
		pop	esi
		retn
sub_100124E1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012507	proc near		; CODE XREF: sub_10012545+3Dp
					; .text:100134C5p ...
		test	edi, edi
		jz	short loc_10012542
		test	eax, eax
		jz	short loc_10012542
		push	esi
		mov	esi, [eax]
		cmp	esi, edi
		jz	short loc_1001253E
		push	edi		; lpAddend
		mov	[eax], edi
		call	sub_100123B9
		pop	ecx
		test	esi, esi
		jz	short loc_1001253E
		push	esi		; lpAddend
		call	sub_10012448
		cmp	dword ptr [esi], 0
		pop	ecx
		jnz	short loc_1001253E
		cmp	esi, offset dword_1002DA90
		jz	short loc_1001253E
		push	esi		; lpMem
		call	sub_10012270
		pop	ecx

loc_1001253E:				; CODE XREF: sub_10012507+Dj
					; sub_10012507+1Aj ...
		mov	eax, edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10012542:				; CODE XREF: sub_10012507+2j
					; sub_10012507+6j
		xor	eax, eax
		retn
sub_10012507	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012545	proc near		; CODE XREF: sub_1000E615+43p
					; .text:loc_10012754p ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

; FUNCTION CHUNK AT 100125A4 SIZE 0000001C BYTES

		push	0Ch
		push	offset stru_1002B4D8
		call	__SEH_prolog4
		call	sub_10013828
		mov	esi, eax
		test	byte ptr [esi+70h], 2
		jnz	short loc_10012567
		test	byte ptr dword_1002DA84, 1
		jnz	short loc_1001256D

loc_10012567:				; CODE XREF: sub_10012545+17j
		cmp	dword ptr [esi+6Ch], 0
		jnz	short loc_100125A4

loc_1001256D:				; CODE XREF: sub_10012545+20j
		push	0Ch
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		lea	eax, [esi+6Ch]
		mov	edi, off_1002DB68
		call	sub_10012507
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1001259B	; Finally handler 0 for	function 10012545
; ---------------------------------------------------------------------------

loc_10012596:				; CODE XREF: sub_10012545+5Ej
		mov	esi, [ebp+var_1C]
		jmp	short loc_100125AC
; ---------------------------------------------------------------------------

loc_1001259B:				; CODE XREF: sub_10012545+4Cj
					; DATA XREF: .rdata:stru_1002B4D8o
		push	0Ch		; Finally handler 0 for	function 10012545
		call	sub_100151D0
		pop	ecx
		retn
sub_10012545	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10012545

loc_100125A4:				; CODE XREF: sub_10012545+26j
		call	sub_10013828
		mov	esi, [eax+6Ch]

loc_100125AC:				; CODE XREF: sub_10012545+54j
		test	esi, esi
		jnz	short loc_100125B8
		push	20h
		call	sub_100164A2
		pop	ecx

loc_100125B8:				; CODE XREF: sub_10012545+69j
		mov	eax, esi
		call	__SEH_epilog4
		retn
; END OF FUNCTION CHUNK	FOR sub_10012545
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		call	sub_10013828
		mov	ecx, [eax+70h]
		test	cl, 2
		push	0
		pop	edx
		setz	dl
		inc	edx
		mov	edi, edx
		mov	edx, [ebp+8]
		cmp	edx, 0FFFFFFFFh
		jz	short loc_1001261D
		xor	esi, esi
		cmp	edx, esi
		jz	short loc_10012624
		cmp	edx, 1
		jz	short loc_10012615
		cmp	edx, 2
		jz	short loc_10012610
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_10012626
; ---------------------------------------------------------------------------

loc_10012610:				; CODE XREF: .text:100125F1j
		and	ecx, 0FFFFFFFDh
		jmp	short loc_10012618
; ---------------------------------------------------------------------------

loc_10012615:				; CODE XREF: .text:100125ECj
		or	ecx, 2

loc_10012618:				; CODE XREF: .text:10012613j
		mov	[eax+70h], ecx
		jmp	short loc_10012624
; ---------------------------------------------------------------------------

loc_1001261D:				; CODE XREF: .text:100125E1j
		or	dword_1002DA84,	0FFFFFFFFh

loc_10012624:				; CODE XREF: .text:100125E7j
					; .text:1001261Bj
		mov	eax, edi

loc_10012626:				; CODE XREF: .text:1001260Ej
		pop	edi
		pop	esi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1001262A	proc near		; CODE XREF: .text:100134FFp
		mov	eax, off_1002DB68
		mov	ecx, [eax+4]
		mov	dword_1002E638,	ecx
		mov	ecx, [eax+8]
		mov	dword_1002E63C,	ecx
		mov	ecx, [eax+0A8h]
		mov	dword_1002DB6C,	ecx
		mov	ecx, [eax+0D4h]
		mov	off_1002E114, ecx
		mov	ecx, [eax+0BCh]
		mov	off_1002E170, ecx
		mov	ecx, [eax+0C8h]
		mov	off_1002DFA8, ecx
		mov	eax, [eax+0ACh]
		mov	dword_1002E174,	eax
		retn
sub_1001262A	endp

; ---------------------------------------------------------------------------

loc_1001267D:				; CODE XREF: .text:10012719j
		push	8
		push	offset dword_1002B4F8
		call	__SEH_prolog4
		mov	esi, [ebp+8]
		xor	edi, edi
		cmp	esi, edi
		jz	short loc_10012701
		mov	eax, [esi+4]
		cmp	eax, edi
		jz	short loc_100126B5
		push	eax
		call	ds:InterlockedDecrement
		test	eax, eax
		jnz	short loc_100126B5
		mov	eax, [esi+4]
		cmp	eax, offset Addend
		jz	short loc_100126B5
		push	eax
		call	sub_1000EE73
		pop	ecx

loc_100126B5:				; CODE XREF: .text:10012697j
					; .text:100126A2j ...
		cmp	[esi], edi
		jz	short loc_100126F0
		push	0Ch
		call	sub_100152C7
		pop	ecx
		mov	[ebp-4], edi
		push	dword ptr [esi]
		call	sub_10012448
		pop	ecx
		mov	eax, [esi]
		cmp	eax, edi
		jz	short loc_100126E4
		cmp	[eax], edi
		jnz	short loc_100126E4
		cmp	eax, offset dword_1002DA90
		jz	short loc_100126E4
		push	eax
		call	sub_10012270
		pop	ecx

loc_100126E4:				; CODE XREF: .text:100126D0j
					; .text:100126D4j ...
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_1001270A

loc_100126F0:				; CODE XREF: .text:100126B7j
		mov	eax, 0BAADF00Dh
		mov	[esi], eax
		mov	[esi+4], eax
		push	esi
		call	sub_1000EE73
		pop	ecx

loc_10012701:				; CODE XREF: .text:10012690j
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10012707	proc near		; DATA XREF: .rdata:1002B510o
		mov	esi, [ebp+8]
sub_10012707	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001270A	proc near		; CODE XREF: .text:100126EBp
		push	0Ch
		call	sub_100151D0
		pop	ecx
		retn
sub_1001270A	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	loc_1001267D
; ---------------------------------------------------------------------------

loc_1001271E:				; CODE XREF: .text:100127A6j
		push	0Ch
		push	offset dword_1002B518
		call	__SEH_prolog4
		call	sub_10013828
		mov	edi, eax
		push	1
		push	8
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	esi, eax
		mov	[ebp-1Ch], esi
		test	esi, esi
		jnz	short loc_10012754
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		xor	eax, eax
		jmp	short loc_10012794
; ---------------------------------------------------------------------------

loc_10012754:				; CODE XREF: .text:10012743j
		call	sub_10012545
		call	sub_10011D90
		mov	eax, [edi+6Ch]
		mov	[esi], eax
		mov	eax, [edi+68h]
		mov	[esi+4], eax
		push	0Ch
		call	sub_100152C7
		pop	ecx
		and	dword ptr [ebp-4], 0
		push	dword ptr [esi]
		call	sub_100123B9
		pop	ecx
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_1001279D
		push	dword ptr [esi+4]
		call	ds:InterlockedIncrement
		mov	eax, esi

loc_10012794:				; CODE XREF: .text:10012752j
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1001279A	proc near		; DATA XREF: .rdata:1002B530o
		mov	esi, [ebp-1Ch]
sub_1001279A	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1001279D	proc near		; CODE XREF: .text:10012784p
		push	0Ch
		call	sub_100151D0
		pop	ecx
		retn
sub_1001279D	endp

; ---------------------------------------------------------------------------
		jmp	loc_1001271E

; =============== S U B	R O U T	I N E =======================================


sub_100127AB	proc near		; CODE XREF: sub_10012D67+253p
					; DATA XREF: .rdata:off_10028FB8o
		xor	eax, eax
		retn
sub_100127AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100127AE	proc near		; CODE XREF: sub_10012917+41p
					; sub_10012917+63p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	edi
		mov	edi, [ebp+arg_8]
		xor	ebx, ebx
		cmp	edi, ebx
		jle	short loc_100127EA
		push	esi
		lea	esi, [ebp+arg_8]

loc_100127C2:				; CODE XREF: sub_100127AE+39j
		add	esi, 4
		push	dword ptr [esi]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1001C6BE
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100127E6
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_100127E6:				; CODE XREF: sub_100127AE+29j
		dec	edi
		jnz	short loc_100127C2
		pop	esi

loc_100127EA:				; CODE XREF: sub_100127AE+Ej
		pop	edi
		pop	ebx
		pop	ebp
		retn
sub_100127AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100127EE	proc near		; CODE XREF: sub_10012B19+15Ap

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		push	90h
		xor	ebx, ebx
		push	ebx
		push	edi
		call	sub_1000E0F0
		mov	esi, [ebp+arg_4]
		mov	al, [esi]
		add	esp, 0Ch
		test	al, al
		jnz	short loc_1001281A

loc_10012813:				; CODE XREF: sub_100127EE+62j
					; sub_100127EE+F8j ...
		xor	eax, eax
		jmp	loc_10012912
; ---------------------------------------------------------------------------

loc_1001281A:				; CODE XREF: sub_100127EE+23j
		cmp	al, 2Eh
		jnz	short loc_10012852
		lea	eax, [esi+1]
		cmp	[eax], bl
		jz	short loc_10012852
		push	0Fh
		push	eax
		lea	eax, [edi+80h]
		push	10h
		push	eax
		call	sub_10016DF1
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001284A
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_1001284A:				; CODE XREF: sub_100127EE+4Dj
		mov	[edi+8Fh], bl
		jmp	short loc_10012813
; ---------------------------------------------------------------------------

loc_10012852:				; CODE XREF: sub_100127EE+2Ej
					; sub_100127EE+35j
		push	offset dword_10029078
		push	esi
		mov	[ebp+arg_4], ebx
		call	sub_1001C740
		cmp	eax, ebx
		jmp	loc_10012907
; ---------------------------------------------------------------------------

loc_10012867:				; CODE XREF: sub_100127EE+11Bj
		cmp	[ebp+arg_4], 0
		lea	edi, [eax+esi]
		mov	bl, [edi]
		jnz	short loc_1001288D
		cmp	eax, 40h
		jnb	loc_1001290F
		cmp	bl, 2Eh
		jz	loc_1001290F
		push	eax
		push	esi
		push	40h
		push	[ebp+arg_0]
		jmp	short loc_100128C8
; ---------------------------------------------------------------------------

loc_1001288D:				; CODE XREF: sub_100127EE+82j
		cmp	[ebp+arg_4], 1
		jnz	short loc_100128A9
		cmp	eax, 40h
		jnb	short loc_1001290F
		cmp	bl, 5Fh
		jz	short loc_1001290F
		push	eax
		mov	eax, [ebp+arg_0]
		push	esi
		push	40h
		add	eax, 40h
		jmp	short loc_100128C7
; ---------------------------------------------------------------------------

loc_100128A9:				; CODE XREF: sub_100127EE+A3j
		cmp	[ebp+arg_4], 2
		jnz	short loc_1001290F
		cmp	eax, 10h
		jnb	short loc_1001290F
		test	bl, bl
		jz	short loc_100128BD
		cmp	bl, 2Ch
		jnz	short loc_1001290F

loc_100128BD:				; CODE XREF: sub_100127EE+C8j
		push	eax
		mov	eax, [ebp+arg_0]
		push	esi
		push	10h
		sub	eax, 0FFFFFF80h

loc_100128C7:				; CODE XREF: sub_100127EE+B9j
		push	eax

loc_100128C8:				; CODE XREF: sub_100127EE+9Dj
		call	sub_10016DF1
		add	esp, 10h
		test	eax, eax
		jz	short loc_100128E3
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_100128E3:				; CODE XREF: sub_100127EE+E4j
		cmp	bl, 2Ch
		jz	loc_10012813
		test	bl, bl
		jz	loc_10012813
		inc	[ebp+arg_4]
		lea	esi, [edi+1]
		push	offset dword_10029078
		push	esi
		call	sub_1001C740
		test	eax, eax

loc_10012907:				; CODE XREF: sub_100127EE+74j
		pop	ecx
		pop	ecx
		jnz	loc_10012867

loc_1001290F:				; CODE XREF: sub_100127EE+87j
					; sub_100127EE+90j ...
		or	eax, 0FFFFFFFFh

loc_10012912:				; CODE XREF: sub_100127EE+27j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_100127EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012917	proc near		; CODE XREF: sub_10012B19+19Fp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_8]
		push	esi
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10016B60
		add	esp, 0Ch
		xor	ebx, ebx
		test	eax, eax
		jz	short loc_10012943
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10012943:				; CODE XREF: sub_10012917+1Dj
		lea	eax, [esi+40h]
		cmp	[eax], bl
		jz	short loc_10012960
		push	eax
		push	offset dword_10029080
		push	2
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100127AE
		add	esp, 14h

loc_10012960:				; CODE XREF: sub_10012917+31j
		lea	eax, [esi+80h]
		cmp	[eax], bl
		pop	esi
		pop	ebx
		jz	short loc_10012982
		push	eax
		push	offset dword_1002907C
		push	2
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100127AE
		add	esp, 14h

loc_10012982:				; CODE XREF: sub_10012917+53j
		pop	ebp
		retn
sub_10012917	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012984	proc near		; CODE XREF: sub_10013065:loc_100132B7p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpMem		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	edi
		xor	edi, edi
		inc	edi
		push	355h
		mov	[ebp+var_10], edi
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+lpMem], eax
		test	eax, eax
		jz	loc_10012B16
		lea	ecx, [eax+4]
		push	ebx
		mov	byte ptr [ecx],	0
		mov	[eax], edi
		mov	[ebp+var_C], edi
		lea	edi, [esi+10h]
		lea	ebx, [edi+48h]
		push	dword ptr [ebx]
		push	offset dword_10029088
		push	ds:off_10028FBC
		push	3
		push	351h
		push	ecx
		call	sub_100127AE
		add	esp, 18h
		mov	[ebp+var_4], offset off_10028FBC

loc_100129DF:				; CODE XREF: sub_10012984+F6j
		mov	eax, [ebp+lpMem]
		push	offset dword_10029084
		add	eax, 4
		push	351h
		push	eax
		call	sub_1001C6BE
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10012A0B
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_10012A0B:				; CODE XREF: sub_10012984+76j
		mov	edi, [edi+58h]
		mov	ebx, [ebx]

loc_10012A10:				; CODE XREF: sub_10012984+A4j
		mov	al, [ebx]
		cmp	al, [edi]
		jnz	short loc_10012A2E
		test	al, al
		jz	short loc_10012A2A
		mov	al, [ebx+1]
		cmp	al, [edi+1]
		jnz	short loc_10012A2E
		inc	ebx
		inc	ebx
		inc	edi
		inc	edi
		test	al, al
		jnz	short loc_10012A10

loc_10012A2A:				; CODE XREF: sub_10012984+94j
		xor	eax, eax
		jmp	short loc_10012A33
; ---------------------------------------------------------------------------

loc_10012A2E:				; CODE XREF: sub_10012984+90j
					; sub_10012984+9Cj
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10012A33:				; CODE XREF: sub_10012984+A8j
		test	eax, eax
		jz	short loc_10012A3B
		and	[ebp+var_10], 0

loc_10012A3B:				; CODE XREF: sub_10012984+B1j
		inc	[ebp+var_C]
		mov	eax, [ebp+var_C]
		add	[ebp+var_4], 0Ch
		shl	eax, 4
		lea	edi, [eax+esi]
		mov	eax, [ebp+var_4]
		lea	ebx, [edi+48h]
		push	dword ptr [ebx]
		push	offset dword_10029088
		push	dword ptr [eax]
		mov	eax, [ebp+lpMem]
		push	3
		add	eax, 4
		push	351h
		push	eax
		mov	[ebp+var_14], eax
		call	sub_100127AE
		add	esp, 18h
		cmp	[ebp+var_4], offset off_10028FEC
		jl	loc_100129DF
		xor	ebx, ebx
		cmp	[ebp+var_10], ebx
		jnz	short loc_10012AC9
		mov	eax, [esi+50h]
		mov	edi, ds:InterlockedDecrement
		cmp	eax, ebx
		jz	short loc_10012AA4
		push	eax		; lpAddend
		call	edi ; InterlockedDecrement
		test	eax, eax
		jnz	short loc_10012AA4
		push	dword ptr [esi+50h] ; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10012AA4:				; CODE XREF: sub_10012984+10Ej
					; sub_10012984+115j
		mov	eax, [esi+54h]
		cmp	eax, ebx
		jz	short loc_10012ABB
		push	eax		; lpAddend
		call	edi ; InterlockedDecrement
		test	eax, eax
		jnz	short loc_10012ABB
		push	dword ptr [esi+54h] ; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10012ABB:				; CODE XREF: sub_10012984+125j
					; sub_10012984+12Cj
		mov	eax, [ebp+lpMem]
		mov	[esi+50h], eax
		mov	eax, [ebp+var_14]
		mov	[esi+48h], eax
		jmp	short loc_10012B0F
; ---------------------------------------------------------------------------

loc_10012AC9:				; CODE XREF: sub_10012984+101j
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		mov	eax, [esi+50h]
		mov	edi, ds:InterlockedDecrement
		pop	ecx
		cmp	eax, ebx
		jz	short loc_10012AEF
		push	eax		; lpAddend
		call	edi ; InterlockedDecrement
		test	eax, eax
		jnz	short loc_10012AEF
		push	dword ptr [esi+50h] ; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10012AEF:				; CODE XREF: sub_10012984+159j
					; sub_10012984+160j
		mov	eax, [esi+54h]
		cmp	eax, ebx
		jz	short loc_10012B06
		push	eax		; lpAddend
		call	edi ; InterlockedDecrement
		test	eax, eax
		jnz	short loc_10012B06
		push	dword ptr [esi+54h] ; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10012B06:				; CODE XREF: sub_10012984+170j
					; sub_10012984+177j
		mov	eax, [esi+68h]
		mov	[esi+50h], ebx
		mov	[esi+48h], ebx

loc_10012B0F:				; CODE XREF: sub_10012984+143j
		mov	[esi+4Ch], ebx
		mov	[esi+54h], ebx
		pop	ebx

loc_10012B16:				; CODE XREF: sub_10012984+1Fj
		pop	edi
		leave
		retn
sub_10012984	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012B19	proc near		; CODE XREF: sub_10012D67+46p
					; sub_10013065+1B4p

var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
LCData		= byte ptr -94h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0ACh
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_C]
		mov	[ebp+var_9C], eax
		mov	eax, [ebp+arg_10]
		push	edi
		mov	edi, [ebp+arg_0]
		mov	[ebp+var_A4], esi
		mov	[ebp+var_A0], eax
		call	sub_10013828
		mov	ebx, eax
		add	ebx, 9Ch
		lea	eax, [ebx+0AFh]
		mov	[ebp+var_98], eax
		test	edi, edi
		jz	loc_10012D56
		cmp	[ebp+var_9C], 0
		jz	loc_10012D56
		cmp	[ebp+arg_8], 0
		jz	loc_10012D56
		cmp	byte ptr [edi],	43h
		jnz	short loc_10012BE3
		cmp	byte ptr [edi+1], 0
		jnz	short loc_10012BE3
		push	offset dword_1002908C
		push	[ebp+arg_8]
		push	[ebp+var_9C]
		call	sub_10016B60
		add	esp, 0Ch
		xor	edi, edi
		test	eax, eax
		jz	short loc_10012BBB
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014AB5
		add	esp, 14h

loc_10012BBB:				; CODE XREF: sub_10012B19+93j
		cmp	esi, edi
		jz	short loc_10012BCC
		xor	eax, eax
		mov	[esi], ax
		mov	[esi+2], ax
		mov	[esi+4], ax

loc_10012BCC:				; CODE XREF: sub_10012B19+A4j
		mov	eax, [ebp+var_A0]
		cmp	eax, edi
		jz	short loc_10012BD8
		mov	[eax], edi

loc_10012BD8:				; CODE XREF: sub_10012B19+BBj
		mov	eax, [ebp+var_9C]
		jmp	loc_10012D58
; ---------------------------------------------------------------------------

loc_10012BE3:				; CODE XREF: sub_10012B19+71j
					; sub_10012B19+77j
		mov	eax, edi
		lea	edx, [eax+1]

loc_10012BE8:				; CODE XREF: sub_10012B19+D4j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10012BE8
		sub	eax, edx
		mov	[ebp+var_AC], eax
		cmp	eax, 83h
		jnb	short loc_10012C64
		mov	eax, [ebp+var_98]
		push	2
		mov	esi, edi
		pop	edx

loc_10012C09:				; CODE XREF: sub_10012B19+108j
		mov	cl, [eax]
		cmp	cl, [esi]
		jnz	short loc_10012C27
		test	cl, cl
		jz	short loc_10012C23
		mov	cl, [eax+1]
		cmp	cl, [esi+1]
		jnz	short loc_10012C27
		add	eax, edx
		add	esi, edx
		test	cl, cl
		jnz	short loc_10012C09

loc_10012C23:				; CODE XREF: sub_10012B19+F8j
		xor	eax, eax
		jmp	short loc_10012C2C
; ---------------------------------------------------------------------------

loc_10012C27:				; CODE XREF: sub_10012B19+F4j
					; sub_10012B19+100j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10012C2C:				; CODE XREF: sub_10012B19+10Cj
		test	eax, eax
		jz	loc_10012CFF
		mov	esi, edi
		lea	eax, [ebx+2Ch]

loc_10012C39:				; CODE XREF: sub_10012B19+138j
		mov	cl, [eax]
		cmp	cl, [esi]
		jnz	short loc_10012C57
		test	cl, cl
		jz	short loc_10012C53
		mov	cl, [eax+1]
		cmp	cl, [esi+1]
		jnz	short loc_10012C57
		add	eax, edx
		add	esi, edx
		test	cl, cl
		jnz	short loc_10012C39

loc_10012C53:				; CODE XREF: sub_10012B19+128j
		xor	eax, eax
		jmp	short loc_10012C5C
; ---------------------------------------------------------------------------

loc_10012C57:				; CODE XREF: sub_10012B19+124j
					; sub_10012B19+130j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10012C5C:				; CODE XREF: sub_10012B19+13Cj
		test	eax, eax
		jz	loc_10012CFF

loc_10012C64:				; CODE XREF: sub_10012B19+E3j
		and	[ebp+var_A8], 0
		lea	eax, [ebp+LCData]
		push	edi
		push	eax
		call	sub_100127EE
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	loc_10012D56
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		lea	esi, [ebx+20h]
		push	esi		; int
		push	eax		; int
		call	sub_1001CDB0
		add	esp, 0Ch
		test	eax, eax
		jz	loc_10012D56
		movzx	eax, word ptr [esi+4]
		mov	[ebx+28h], eax
		lea	eax, [ebp+LCData]
		push	eax
		mov	esi, 83h
		push	esi
		push	[ebp+var_98]
		call	sub_10012917
		add	esp, 0Ch
		cmp	byte ptr [edi],	0
		jz	short loc_10012CCF
		mov	eax, [ebp+var_AC]
		cmp	eax, esi
		jb	short loc_10012CDA

loc_10012CCF:				; CODE XREF: sub_10012B19+1AAj
		mov	eax, [ebp+var_A8]
		mov	edi, offset byte_1002762D

loc_10012CDA:				; CODE XREF: sub_10012B19+1B4j
		inc	eax
		push	eax
		push	edi
		lea	eax, [ebx+2Ch]
		push	esi
		push	eax
		call	sub_10016DF1
		add	esp, 10h
		xor	esi, esi
		test	eax, eax
		jz	short loc_10012D01
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014AB5
		add	esp, 14h
		jmp	short loc_10012D01
; ---------------------------------------------------------------------------

loc_10012CFF:				; CODE XREF: sub_10012B19+115j
					; sub_10012B19+145j
		xor	esi, esi

loc_10012D01:				; CODE XREF: sub_10012B19+1D5j
					; sub_10012B19+1E4j
		cmp	[ebp+var_A4], esi
		jz	short loc_10012D17
		mov	edi, [ebp+var_A4]
		lea	esi, [ebx+20h]
		movsd
		movsw
		xor	esi, esi

loc_10012D17:				; CODE XREF: sub_10012B19+1EEj
		mov	eax, [ebp+var_A0]
		cmp	eax, esi
		jz	short loc_10012D26
		mov	ecx, [ebx+28h]
		mov	[eax], ecx

loc_10012D26:				; CODE XREF: sub_10012B19+206j
		push	[ebp+var_98]
		push	[ebp+arg_8]
		push	[ebp+var_9C]
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10012D4E
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014AB5
		add	esp, 14h

loc_10012D4E:				; CODE XREF: sub_10012B19+226j
		mov	eax, [ebp+var_98]
		jmp	short loc_10012D58
; ---------------------------------------------------------------------------

loc_10012D56:				; CODE XREF: sub_10012B19+51j
					; sub_10012B19+5Ej ...
		xor	eax, eax

loc_10012D58:				; CODE XREF: sub_10012B19+C5j
					; sub_10012B19+23Bj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10012B19	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012D67	proc near		; CODE XREF: sub_10013065+30p
					; sub_10013065+163p ...

var_1B4		= dword	ptr -1B4h
var_1B0		= dword	ptr -1B0h
var_1AC		= dword	ptr -1ACh
var_1A8		= dword	ptr -1A8h
var_1A0		= dword	ptr -1A0h
var_19C		= dword	ptr -19Ch
lpMem		= dword	ptr -198h
var_194		= dword	ptr -194h
var_190		= dword	ptr -190h
var_18C		= dword	ptr -18Ch
CharType	= word ptr -188h
var_88		= byte ptr -88h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 1B4h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		mov	esi, ecx
		call	sub_10013828
		push	[ebp+arg_0]
		add	eax, 1D0h
		mov	[ebp+var_194], eax
		lea	eax, [ebp+var_1A0]
		push	eax
		lea	eax, [ebp+var_1A8]
		push	eax
		push	83h
		lea	eax, [ebp+var_88]
		push	eax
		push	esi
		call	sub_10012B19
		add	esp, 18h
		test	eax, eax
		jz	loc_10013058
		mov	eax, [ebp+arg_0]
		shl	eax, 4
		lea	esi, [eax+ebx]
		mov	eax, [esi+48h]
		push	edi
		mov	[ebp+var_190], esi
		mov	edi, eax
		lea	ecx, [ebp+var_88]

loc_10012DD8:				; CODE XREF: sub_10012D67+89j
		mov	dl, [ecx]
		cmp	dl, [edi]
		jnz	short loc_10012DF6
		test	dl, dl
		jz	short loc_10012DF2
		mov	dl, [ecx+1]
		cmp	dl, [edi+1]
		jnz	short loc_10012DF6
		inc	ecx
		inc	ecx
		inc	edi
		inc	edi
		test	dl, dl
		jnz	short loc_10012DD8

loc_10012DF2:				; CODE XREF: sub_10012D67+79j
		xor	ecx, ecx
		jmp	short loc_10012DFB
; ---------------------------------------------------------------------------

loc_10012DF6:				; CODE XREF: sub_10012D67+75j
					; sub_10012D67+81j
		sbb	ecx, ecx
		sbb	ecx, 0FFFFFFFFh

loc_10012DFB:				; CODE XREF: sub_10012D67+8Dj
		test	ecx, ecx
		jz	loc_10013057
		lea	eax, [ebp+var_88]
		lea	edx, [eax+1]

loc_10012E0C:				; CODE XREF: sub_10012D67+AAj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10012E0C
		sub	eax, edx
		add	eax, 5
		push	eax
		mov	[ebp+var_18C], eax
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+lpMem], eax
		test	eax, eax
		jz	loc_10012FF7
		mov	ecx, [esi+48h]
		lea	esi, [eax+4]
		mov	[ebp+var_19C], ecx
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_88]
		push	eax
		mov	eax, [ebp+var_18C]
		lea	edi, [ebx+ecx*4+0Ch]
		mov	ecx, [edi]
		add	eax, 0FFFFFFFCh
		mov	[ebp+var_1B0], ecx
		mov	ecx, [ebx+4]
		push	eax
		push	esi
		mov	[ebp+var_1B4], edi
		mov	[ebp+var_1AC], ecx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10012E8A
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_10012E8A:				; CODE XREF: sub_10012D67+112j
		mov	eax, [ebp+var_190]
		mov	[eax+48h], esi
		movzx	eax, word ptr [ebp+var_1A8]
		mov	[edi], eax
		mov	edi, [ebp+arg_0]
		add	edi, 6
		imul	edi, 6
		add	edi, ebx
		lea	esi, [ebp+var_1A8]
		movsd
		movsw
		mov	edi, [ebp+arg_0]
		cmp	edi, 2
		jnz	loc_10012FA6
		mov	eax, [ebp+var_1A0]
		mov	esi, [ebp+var_194]
		and	[ebp+var_18C], 0
		mov	[ebx+4], eax
		mov	ecx, [esi+20h]
		mov	edx, [esi+24h]
		mov	eax, esi

loc_10012EDA:				; CODE XREF: sub_10012D67+1A2j
		mov	edi, [ebx+4]
		cmp	edi, [eax]
		jz	short loc_10012F0D
		mov	edi, [eax]
		inc	[ebp+var_18C]
		mov	[ebp+var_1A8], edi
		mov	edi, [eax+4]
		mov	[eax], ecx
		mov	ecx, [ebp+var_1A8]
		mov	[eax+4], edx
		add	eax, 8
		cmp	[ebp+var_18C], 5
		mov	edx, edi
		jl	short loc_10012EDA
		jmp	short loc_10012F29
; ---------------------------------------------------------------------------

loc_10012F0D:				; CODE XREF: sub_10012D67+178j
		mov	eax, [ebp+var_18C]
		test	eax, eax
		jz	short loc_10012F29
		lea	eax, [esi+eax*8]
		mov	edi, [eax]
		mov	[esi], edi
		mov	edi, [eax+4]
		mov	[esi+4], edi
		mov	[eax], ecx
		mov	[eax+4], edx

loc_10012F29:				; CODE XREF: sub_10012D67+1A4j
					; sub_10012D67+1AEj
		cmp	[ebp+var_18C], 5
		jnz	short loc_10012F9A
		push	1		; int
		push	dword ptr [ebx+14h] ; Locale
		lea	eax, [ebp+CharType]
		push	dword ptr [ebx+4] ; CodePage
		push	eax		; lpCharType
		push	7Fh		; cbMultiByte
		push	offset MultiByteStr ; lpMultiByteStr
		push	1		; dwInfoType
		push	0		; int
		call	sub_10019DA5
		add	esp, 20h
		test	eax, eax
		jz	short loc_10012F91
		xor	eax, eax

loc_10012F5A:				; CODE XREF: sub_10012D67+204j
		mov	ecx, 1FFh
		and	[ebp+eax*2+CharType], cx
		inc	eax
		cmp	eax, 7Fh
		jb	short loc_10012F5A
		mov	edi, off_1002DA80
		push	7Fh
		xor	eax, eax
		pop	ecx
		lea	esi, [ebp+CharType]
		repe cmpsw
		mov	ecx, [ebp+var_194]
		setz	al
		mov	esi, ecx
		mov	[ecx+4], eax
		jmp	short loc_10012F95
; ---------------------------------------------------------------------------

loc_10012F91:				; CODE XREF: sub_10012D67+1EFj
		and	dword ptr [esi+4], 0

loc_10012F95:				; CODE XREF: sub_10012D67+228j
		mov	eax, [ebx+4]
		mov	[esi], eax

loc_10012F9A:				; CODE XREF: sub_10012D67+1C9j
		mov	eax, [esi+4]
		mov	edi, [ebp+arg_0]
		mov	[ebx+0A8h], eax

loc_10012FA6:				; CODE XREF: sub_10012D67+14Fj
		cmp	edi, 1
		jnz	short loc_10012FB4
		mov	eax, [ebp+var_1A0]
		mov	[ebx+8], eax

loc_10012FB4:				; CODE XREF: sub_10012D67+242j
		mov	eax, edi
		imul	eax, 0Ch
		push	ebx
		call	ds:off_10028FB8[eax]
		pop	ecx
		test	eax, eax
		jz	short loc_10012FFB
		mov	eax, [ebp+var_19C]
		mov	ecx, [ebp+var_190]
		push	[ebp+lpMem]	; lpMem
		mov	[ecx+48h], eax
		call	sub_1000EE73
		mov	eax, [ebp+var_1B0]
		pop	ecx
		mov	ecx, [ebp+var_1B4]
		mov	[ecx], eax
		mov	eax, [ebp+var_1AC]
		mov	[ebx+4], eax

loc_10012FF7:				; CODE XREF: sub_10012D67+C6j
		xor	eax, eax
		jmp	short loc_10013057
; ---------------------------------------------------------------------------

loc_10012FFB:				; CODE XREF: sub_10012D67+25Cj
		cmp	[ebp+var_19C], offset dword_1002DA88
		jz	short loc_10013039
		lea	eax, [edi+5]
		shl	eax, 4
		lea	esi, [eax+ebx]
		push	dword ptr [esi]	; lpAddend
		call	ds:InterlockedDecrement
		test	eax, eax
		jnz	short loc_10013039
		push	dword ptr [esi]	; lpMem
		call	sub_1000EE73
		mov	esi, [ebp+var_190]
		push	dword ptr [esi+54h] ; lpMem
		call	sub_1000EE73
		and	dword ptr [esi+4Ch], 0
		pop	ecx
		pop	ecx
		jmp	short loc_1001303F
; ---------------------------------------------------------------------------

loc_10013039:				; CODE XREF: sub_10012D67+29Ej
					; sub_10012D67+2B3j
		mov	esi, [ebp+var_190]

loc_1001303F:				; CODE XREF: sub_10012D67+2D0j
		mov	eax, [ebp+lpMem]
		add	edi, 5
		mov	dword ptr [eax], 1
		shl	edi, 4
		mov	[edi+ebx], eax
		mov	eax, [esi+48h]

loc_10013057:				; CODE XREF: sub_10012D67+96j
					; sub_10012D67+292j
		pop	edi

loc_10013058:				; CODE XREF: sub_10012D67+50j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10012D67	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013065	proc near		; CODE XREF: .text:1001335Bp
					; .text:10013452p

var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= byte ptr -88h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	ebx
		push	esi
		xor	ebx, ebx
		mov	esi, edx
		push	edi
		mov	[ebp+var_98], esi
		cmp	eax, ebx
		jz	short loc_100130AC
		cmp	ecx, ebx
		jz	short loc_100130A0
		push	eax
		mov	ebx, esi
		call	sub_10012D67
		pop	ecx
		jmp	loc_100132BC
; ---------------------------------------------------------------------------

loc_100130A0:				; CODE XREF: sub_10013065+2Bj
		shl	eax, 4
		mov	eax, [eax+esi+48h]
		jmp	loc_100132BC
; ---------------------------------------------------------------------------

loc_100130AC:				; CODE XREF: sub_10013065+27j
		mov	[ebp+var_94], 1
		mov	[ebp+var_90], ebx
		cmp	ecx, ebx
		jz	loc_100132B7
		cmp	byte ptr [ecx],	4Ch
		jnz	loc_10013209
		cmp	byte ptr [ecx+1], 43h
		jnz	loc_10013209
		cmp	byte ptr [ecx+2], 5Fh
		jnz	loc_10013209
		mov	edi, ecx

loc_100130E3:				; CODE XREF: sub_10013065+17Ej
		push	offset dword_10029090
		push	edi
		call	sub_1001D070
		mov	esi, eax
		pop	ecx
		pop	ecx
		test	esi, esi
		jz	loc_10013202
		sub	eax, edi
		mov	[ebp+var_94], eax
		jz	loc_10013202
		cmp	byte ptr [esi],	3Bh
		jz	loc_10013202
		mov	[ebp+var_8C], 1
		mov	ebx, offset off_10028FBC
		jmp	short loc_10013128
; ---------------------------------------------------------------------------

loc_10013122:				; CODE XREF: sub_10013065+F8j
		mov	eax, [ebp+var_94]

loc_10013128:				; CODE XREF: sub_10013065+BBj
		push	eax
		push	edi
		push	dword ptr [ebx]
		call	sub_1001CFAA
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001314E
		mov	eax, [ebx]
		lea	edx, [eax+1]

loc_1001313D:				; CODE XREF: sub_10013065+DDj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001313D
		sub	eax, edx
		cmp	[ebp+var_94], eax
		jz	short loc_1001315F

loc_1001314E:				; CODE XREF: sub_10013065+D1j
		inc	[ebp+var_8C]
		add	ebx, 0Ch
		cmp	ebx, offset off_10028FEC
		jle	short loc_10013122

loc_1001315F:				; CODE XREF: sub_10013065+E7j
		inc	esi
		push	offset dword_10029084
		push	esi
		call	sub_1001C740
		mov	edi, eax
		xor	ebx, ebx
		pop	ecx
		pop	ecx
		cmp	edi, ebx
		jnz	short loc_1001317E
		cmp	byte ptr [esi],	3Bh
		jnz	loc_10013202

loc_1001317E:				; CODE XREF: sub_10013065+10Ej
		cmp	[ebp+var_8C], 5
		jg	short loc_100131D8
		push	edi
		push	esi
		lea	eax, [ebp+var_88]
		push	83h
		push	eax
		call	sub_10016DF1
		add	esp, 10h
		test	eax, eax
		jz	short loc_100131AE
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_100131AE:				; CODE XREF: sub_10013065+13Aj
		push	[ebp+var_8C]
		mov	ebx, [ebp+var_98]
		lea	ecx, [ebp+var_88]
		mov	[ebp+edi+var_88], 0
		call	sub_10012D67
		pop	ecx
		test	eax, eax
		jz	short loc_100131D8
		inc	[ebp+var_90]

loc_100131D8:				; CODE XREF: sub_10013065+120j
					; sub_10013065+16Bj
		add	edi, esi
		cmp	byte ptr [edi],	0
		jz	short loc_100131E9
		inc	edi
		cmp	byte ptr [edi],	0
		jnz	loc_100130E3

loc_100131E9:				; CODE XREF: sub_10013065+178j
		xor	eax, eax
		cmp	[ebp+var_90], eax
		jz	loc_100132BC
		mov	esi, [ebp+var_98]
		jmp	loc_100132B7
; ---------------------------------------------------------------------------

loc_10013202:				; CODE XREF: sub_10013065+8Fj
					; sub_10013065+9Dj ...
		xor	eax, eax
		jmp	loc_100132BC
; ---------------------------------------------------------------------------

loc_10013209:				; CODE XREF: sub_10013065+62j
					; sub_10013065+6Cj ...
		push	ebx
		push	ebx
		push	ebx
		push	83h
		lea	eax, [ebp+var_88]
		push	eax
		push	ecx
		call	sub_10012B19
		add	esp, 18h
		cmp	eax, ebx
		jz	loc_100132BC
		mov	[ebp+var_8C], ebx
		lea	edi, [esi+48h]
		jmp	short loc_10013236
; ---------------------------------------------------------------------------

loc_10013234:				; CODE XREF: sub_10013065+23Ej
		xor	ebx, ebx

loc_10013236:				; CODE XREF: sub_10013065+1CDj
		cmp	[ebp+var_8C], ebx
		jz	short loc_10013293
		mov	ecx, [edi]
		lea	eax, [ebp+var_88]

loc_10013246:				; CODE XREF: sub_10013065+1F9j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10013264
		test	dl, dl
		jz	short loc_10013260
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10013264
		inc	eax
		inc	eax
		inc	ecx
		inc	ecx
		test	dl, dl
		jnz	short loc_10013246

loc_10013260:				; CODE XREF: sub_10013065+1E9j
		xor	eax, eax
		jmp	short loc_10013269
; ---------------------------------------------------------------------------

loc_10013264:				; CODE XREF: sub_10013065+1E5j
					; sub_10013065+1F1j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10013269:				; CODE XREF: sub_10013065+1FDj
		cmp	eax, ebx
		jz	short loc_1001328D
		push	[ebp+var_8C]
		lea	ecx, [ebp+var_88]
		mov	ebx, esi
		call	sub_10012D67
		pop	ecx
		test	eax, eax
		jnz	short loc_1001328D
		and	[ebp+var_94], eax
		jmp	short loc_10013293
; ---------------------------------------------------------------------------

loc_1001328D:				; CODE XREF: sub_10013065+206j
					; sub_10013065+21Ej
		inc	[ebp+var_90]

loc_10013293:				; CODE XREF: sub_10013065+1D7j
					; sub_10013065+226j
		inc	[ebp+var_8C]
		add	edi, 10h
		cmp	[ebp+var_8C], 5
		jle	short loc_10013234
		xor	eax, eax
		cmp	[ebp+var_94], eax
		jnz	short loc_100132B7
		cmp	[ebp+var_90], eax
		jz	short loc_100132BC

loc_100132B7:				; CODE XREF: sub_10013065+59j
					; sub_10013065+198j ...
		call	sub_10012984

loc_100132BC:				; CODE XREF: sub_10013065+36j
					; sub_10013065+42j ...
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10013065	endp

; ---------------------------------------------------------------------------

loc_100132CB:				; CODE XREF: .text:100133BDj
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 5
		push	ebx
		push	esi
		push	edi
		ja	short loc_100132FB
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_100132FB
		push	1
		push	8
		call	sub_1000F496
		mov	edi, eax
		pop	ecx
		pop	ecx
		test	edi, edi
		jnz	short loc_10013302

loc_100132F0:				; CODE XREF: .text:1001331Fj
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch

loc_100132FB:				; CODE XREF: .text:100132D7j
					; .text:100132DDj
		xor	eax, eax

loc_100132FD:				; CODE XREF: .text:100133B2j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10013302:				; CODE XREF: .text:100132EEj
		push	1
		push	0D8h
		call	sub_1000F496
		mov	esi, eax
		pop	ecx
		pop	ecx
		mov	[edi], esi
		test	esi, esi
		jnz	short loc_10013321
		push	edi
		call	sub_1000EE73

loc_1001331E:				; CODE XREF: .text:10013345j
		pop	ecx
		jmp	short loc_100132F0
; ---------------------------------------------------------------------------

loc_10013321:				; CODE XREF: .text:10013316j
		push	1
		push	220h
		call	sub_1000F496
		mov	ebx, eax
		pop	ecx
		pop	ecx
		mov	[edi+4], ebx
		test	ebx, ebx
		jnz	short loc_10013347
		push	esi
		call	sub_1000EE73
		push	edi
		call	sub_1000EE73
		pop	ecx
		jmp	short loc_1001331E
; ---------------------------------------------------------------------------

loc_10013347:				; CODE XREF: .text:10013336j
		mov	ecx, offset dword_1002DA90
		mov	eax, esi
		call	sub_100124E1
		push	dword ptr [ebp+8]
		mov	ecx, [ebp+0Ch]
		mov	edx, esi
		call	sub_10013065
		pop	ecx
		test	eax, eax
		jnz	short loc_1001337C
		push	esi
		call	sub_10012448
		push	esi
		call	sub_10012270
		push	edi
		call	sub_1000EE73
		add	esp, 0Ch
		jmp	short loc_100133A6
; ---------------------------------------------------------------------------

loc_1001337C:				; CODE XREF: .text:10013363j
		push	ebx
		push	dword ptr [esi+4]
		call	sub_10011EB7
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_100133AA
		push	ebx
		call	sub_1000EE73
		push	esi
		call	sub_10012448
		push	esi
		call	sub_10012270
		push	edi
		call	sub_1000EE73
		add	esp, 10h

loc_100133A6:				; CODE XREF: .text:1001337Aj
		xor	edi, edi
		jmp	short loc_100133B0
; ---------------------------------------------------------------------------

loc_100133AA:				; CODE XREF: .text:10013389j
		mov	dword ptr [ebx], 1

loc_100133B0:				; CODE XREF: .text:100133A8j
		mov	eax, edi
		jmp	loc_100132FD
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	loc_100132CB
; ---------------------------------------------------------------------------
		push	14h
		push	offset dword_1002B538
		call	__SEH_prolog4
		xor	esi, esi
		mov	[ebp-20h], esi
		cmp	dword ptr [ebp+8], 5
		jbe	short loc_100133F8
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014B5B
		add	esp, 14h
		xor	eax, eax
		jmp	loc_1001353A
; ---------------------------------------------------------------------------

loc_100133F8:				; CODE XREF: .text:100133D7j
		call	sub_10013828
		mov	ebx, eax
		mov	[ebp-1Ch], ebx
		call	sub_10012545
		or	dword ptr [ebx+70h], 10h
		mov	[ebp-4], esi
		push	1
		push	0D8h
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	edi, eax
		mov	[ebp-24h], edi
		cmp	edi, esi
		jz	loc_1001352B
		push	0Ch
		call	sub_100152C7
		pop	ecx
		mov	dword ptr [ebp-4], 1
		mov	ecx, [ebx+6Ch]
		mov	eax, edi
		call	sub_100124E1
		mov	[ebp-4], esi
		call	sub_10013495
		push	dword ptr [ebp+8]
		mov	ecx, [ebp+0Ch]
		mov	edx, edi
		call	sub_10013065
		pop	ecx
		mov	[ebp-20h], eax
		cmp	eax, esi
		jz	loc_1001351D
		mov	eax, [ebp+0Ch]
		cmp	eax, esi
		jz	short loc_100134B1
		mov	ecx, offset dword_1002DA88

loc_1001346F:				; CODE XREF: .text:10013487j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_1001349E
		test	dl, dl
		jz	short loc_10013489
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_1001349E
		inc	eax
		inc	eax
		inc	ecx
		inc	ecx
		test	dl, dl
		jnz	short loc_1001346F

loc_10013489:				; CODE XREF: .text:10013477j
		xor	eax, eax
		jmp	short loc_100134A3

; =============== S U B	R O U T	I N E =======================================


sub_1001348D	proc near		; DATA XREF: .rdata:1002B55Co
		mov	edi, [ebp-24h]
		mov	ebx, [ebp-1Ch]
		xor	esi, esi
sub_1001348D	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10013495	proc near		; CODE XREF: .text:10013445p
		push	0Ch
		call	sub_100151D0
		pop	ecx
		retn
sub_10013495	endp

; ---------------------------------------------------------------------------

loc_1001349E:				; CODE XREF: .text:10013473j
					; .text:1001347Fj
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_100134A3:				; CODE XREF: .text:1001348Bj
		cmp	eax, esi
		jz	short loc_100134B1
		mov	dword_1002E61C,	1

loc_100134B1:				; CODE XREF: .text:10013468j
					; .text:100134A5j
		push	0Ch
		call	sub_100152C7
		pop	ecx
		mov	dword ptr [ebp-4], 2
		lea	esi, [ebx+6Ch]
		mov	eax, esi
		call	sub_10012507
		push	edi
		call	sub_10012448
		pop	ecx
		test	byte ptr [ebx+70h], 2
		jnz	short loc_10013504
		test	byte ptr dword_1002DA84, 1
		jz	short loc_10013504
		mov	edi, [esi]
		mov	eax, offset off_1002DB68
		call	sub_10012507
		mov	esi, off_1002DB68
		add	esi, 0Ch
		push	6
		pop	ecx
		mov	edi, offset dword_1002E620
		rep movsd
		call	sub_1001262A

loc_10013504:				; CODE XREF: .text:100134D5j
					; .text:100134DEj
		and	dword ptr [ebp-4], 0
		call	sub_10013512
		jmp	short loc_1001352B

; =============== S U B	R O U T	I N E =======================================


sub_1001350F	proc near		; DATA XREF: .rdata:1002B568o
		mov	ebx, [ebp-1Ch]
sub_1001350F	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10013512	proc near		; CODE XREF: .text:10013508p
		push	0Ch
		call	sub_100151D0
		pop	ecx
		retn
sub_10013512	endp

; ---------------------------------------------------------------------------
		jmp	short loc_1001352B
; ---------------------------------------------------------------------------

loc_1001351D:				; CODE XREF: .text:1001345Dj
		push	edi
		call	sub_10012448
		push	edi
		call	sub_10012270
		pop	ecx
		pop	ecx

loc_1001352B:				; CODE XREF: .text:10013423j
					; .text:1001350Dj ...
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10013543
		mov	eax, [ebp-20h]

loc_1001353A:				; CODE XREF: .text:100133F3j
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10013540	proc near		; DATA XREF: .rdata:1002B550o
		mov	ebx, [ebp-1Ch]
sub_10013540	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10013543	proc near		; CODE XREF: .text:10013532p
		and	dword ptr [ebx+70h], 0FFFFFFEFh
		retn
sub_10013543	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013548	proc near		; CODE XREF: sub_10010272+BCp
					; sub_100135BB+2p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	dwTlsIndex	; dwTlsIndex
		mov	esi, ds:TlsGetValue
		call	esi ; TlsGetValue
		test	eax, eax
		jz	short loc_10013581
		mov	eax, dword_1002DB7C
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10013581
		push	eax
		push	dwTlsIndex	; dwTlsIndex
		call	esi ; TlsGetValue
		call	eax
		test	eax, eax
		jz	short loc_10013581
		mov	eax, [eax+1F8h]
		jmp	short loc_100135A9
; ---------------------------------------------------------------------------

loc_10013581:				; CODE XREF: sub_10013548+16j
					; sub_10013548+20j ...
		mov	esi, ds:GetModuleHandleW
		push	offset ModuleName ; "KERNELBASE.DLL"
		call	esi ; GetModuleHandleW
		test	eax, eax
		jnz	short loc_1001359D
		push	offset aKernel32_dll_0 ; "KERNEL32.DLL"
		call	esi ; GetModuleHandleW
		test	eax, eax
		jz	short loc_100135B5

loc_1001359D:				; CODE XREF: sub_10013548+48j
		push	offset aEncodepointer ;	"EncodePointer"
		push	eax		; hModule
		call	ds:GetProcAddress

loc_100135A9:				; CODE XREF: sub_10013548+37j
		test	eax, eax
		jz	short loc_100135B5
		push	[ebp+arg_0]
		call	eax
		mov	[ebp+arg_0], eax

loc_100135B5:				; CODE XREF: sub_10013548+53j
					; sub_10013548+63j
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	ebp
		retn
sub_10013548	endp


; =============== S U B	R O U T	I N E =======================================


sub_100135BB	proc near		; CODE XREF: sub_10010272+C4p
					; sub_100165FB+2Cp ...
		push	0
		call	sub_10013548
		pop	ecx
		retn
sub_100135BB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100135C4	proc near		; CODE XREF: sub_10010272+Ep
					; sub_10011438+16Bp ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	dwTlsIndex	; dwTlsIndex
		mov	esi, ds:TlsGetValue
		call	esi ; TlsGetValue
		test	eax, eax
		jz	short loc_100135FD
		mov	eax, dword_1002DB7C
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100135FD
		push	eax
		push	dwTlsIndex	; dwTlsIndex
		call	esi ; TlsGetValue
		call	eax
		test	eax, eax
		jz	short loc_100135FD
		mov	eax, [eax+1FCh]
		jmp	short loc_10013625
; ---------------------------------------------------------------------------

loc_100135FD:				; CODE XREF: sub_100135C4+16j
					; sub_100135C4+20j ...
		mov	esi, ds:GetModuleHandleW
		push	offset ModuleName ; "KERNELBASE.DLL"
		call	esi ; GetModuleHandleW
		test	eax, eax
		jnz	short loc_10013619
		push	offset aKernel32_dll_0 ; "KERNEL32.DLL"
		call	esi ; GetModuleHandleW
		test	eax, eax
		jz	short loc_10013631

loc_10013619:				; CODE XREF: sub_100135C4+48j
		push	offset aDecodepointer ;	"DecodePointer"
		push	eax		; hModule
		call	ds:GetProcAddress

loc_10013625:				; CODE XREF: sub_100135C4+37j
		test	eax, eax
		jz	short loc_10013631
		push	[ebp+arg_0]
		call	eax
		mov	[ebp+arg_0], eax

loc_10013631:				; CODE XREF: sub_100135C4+53j
					; sub_100135C4+63j
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	ebp
		retn
sub_100135C4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013637	proc near		; DATA XREF: sub_10013A07+87o
		call	ds:TlsAlloc
		retn	4
sub_10013637	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+8]
		push	dwTlsIndex
		call	ds:TlsGetValue
		call	eax
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------
		mov	eax, dword_1002DB7C
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10013660	proc near		; CODE XREF: sub_10011438+141p
					; sub_100137AC+Cp
		push	dwTlsIndex	; dwTlsIndex
		call	ds:TlsGetValue
		test	eax, eax
		jnz	short locret_10013689
		push	lpTlsValue
		call	sub_100135C4
		pop	ecx
		push	eax		; lpTlsValue
		push	dwTlsIndex	; dwTlsIndex
		call	ds:TlsSetValue

locret_10013689:			; CODE XREF: sub_10013660+Ej
		retn
sub_10013660	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		push	dword_1002E648
		call	sub_100135C4
		pop	ecx
		call	eax
		pop	ebp
		retn	8

; =============== S U B	R O U T	I N E =======================================


sub_100136A7	proc near		; CODE XREF: sub_10011438:loc_10011502p
					; sub_10011438+130p ...

; FUNCTION CHUNK AT 10015179 SIZE 00000057 BYTES

		mov	eax, dword_1002DB7C
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100136C7
		push	eax
		push	dword_1002E64C
		call	sub_100135C4
		pop	ecx
		call	eax
		or	dword_1002DB7C,	0FFFFFFFFh

loc_100136C7:				; CODE XREF: sub_100136A7+8j
		mov	eax, dwTlsIndex
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100136DF
		push	eax		; dwTlsIndex
		call	ds:TlsFree
		or	dwTlsIndex, 0FFFFFFFFh

loc_100136DF:				; CODE XREF: sub_100136A7+28j
		jmp	loc_10015179
sub_100136A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100136E4	proc near		; CODE XREF: sub_10011438+179p
					; sub_100137AC+5Bp ...

hModule		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	0Ch
		push	offset stru_1002B570
		call	__SEH_prolog4
		push	offset ModuleName ; "KERNELBASE.DLL"
		mov	esi, ds:GetModuleHandleW
		call	esi ; GetModuleHandleW
		mov	[ebp+hModule], eax
		test	eax, eax
		jnz	short loc_1001370E
		push	offset aKernel32_dll_0 ; "KERNEL32.DLL"
		call	esi ; GetModuleHandleW
		mov	[ebp+hModule], eax

loc_1001370E:				; CODE XREF: sub_100136E4+1Ej
		mov	esi, [ebp+arg_0]
		mov	dword ptr [esi+5Ch], offset dword_1002DF20
		xor	edi, edi
		inc	edi
		mov	[esi+14h], edi
		cmp	[ebp+hModule], 0
		jz	short loc_1001374A
		push	offset aEncodepointer ;	"EncodePointer"
		push	[ebp+hModule]	; hModule
		mov	ebx, ds:GetProcAddress
		call	ebx ; GetProcAddress
		mov	[esi+1F8h], eax
		push	offset aDecodepointer ;	"DecodePointer"
		push	[ebp+hModule]	; hModule
		call	ebx ; GetProcAddress
		mov	[esi+1FCh], eax

loc_1001374A:				; CODE XREF: sub_100136E4+3Ej
		mov	[esi+70h], edi
		mov	byte ptr [esi+0C8h], 43h
		mov	byte ptr [esi+14Bh], 43h
		mov	eax, offset Addend
		mov	[esi+68h], eax
		push	eax		; lpAddend
		call	ds:InterlockedIncrement
		push	0Ch
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	eax, [ebp+arg_4]
		mov	[esi+6Ch], eax
		test	eax, eax
		jnz	short loc_10013788
		mov	eax, off_1002DB68
		mov	[esi+6Ch], eax

loc_10013788:				; CODE XREF: sub_100136E4+9Aj
		push	dword ptr [esi+6Ch] ; lpAddend
		call	sub_100123B9
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_100137A3	; Finally handler 0 for	function 100136E4
; ---------------------------------------------------------------------------

loc_1001379D:				; CODE XREF: sub_100136E4+C7j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_100137A3:				; CODE XREF: sub_100136E4+B4j
					; DATA XREF: .rdata:stru_1002B570o
		push	0Ch		; Finally handler 0 for	function 100136E4
		call	sub_100151D0
		pop	ecx
		retn
sub_100136E4	endp


; =============== S U B	R O U T	I N E =======================================


sub_100137AC	proc near		; CODE XREF: sub_1000E615+13p
					; sub_1000FB67+7p ...
		mov	edi, edi
		push	esi
		push	edi
		call	ds:GetLastError
		mov	edi, eax
		call	sub_10013660
		push	dword_1002DB7C
		push	dwTlsIndex	; dwTlsIndex
		call	ds:TlsGetValue
		call	eax
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1001381C
		push	214h
		push	1
		call	sub_1001D130
		mov	esi, eax
		pop	ecx
		pop	ecx
		test	esi, esi
		jz	short loc_1001381C
		push	esi
		push	dword_1002DB7C
		push	dword_1002E648
		call	sub_100135C4
		pop	ecx
		call	eax
		test	eax, eax
		jz	short loc_10013813
		push	0
		push	esi
		call	sub_100136E4
		or	dword ptr [esi+4], 0FFFFFFFFh
		pop	ecx
		jmp	short loc_1001381B
; ---------------------------------------------------------------------------

loc_10013813:				; CODE XREF: sub_100137AC+56j
		push	esi		; lpMem
		call	sub_1000EE73
		xor	esi, esi

loc_1001381B:				; CODE XREF: sub_100137AC+65j
		pop	ecx

loc_1001381C:				; CODE XREF: sub_100137AC+29j
					; sub_100137AC+3Dj
		push	edi		; dwErrCode
		call	ds:SetLastError
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_100137AC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013828	proc near		; CODE XREF: sub_1001022F+5p
					; sub_10010241p ...
		mov	edi, edi
		push	esi
		call	sub_100137AC
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1001383E
		push	10h
		call	sub_100164A2
		pop	ecx

loc_1001383E:				; CODE XREF: sub_10013828+Cj
		mov	eax, esi
		pop	esi
		retn
sub_10013828	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10013842(LPVOID lpMem)
sub_10013842	proc near		; CODE XREF: sub_1001398D+54p
					; DATA XREF: sub_10013A07:loc_10013B1Co

ms_exc		= CPPEH_RECORD ptr -18h
lpMem		= dword	ptr  8

		push	8
		push	offset stru_1002B590
		call	__SEH_prolog4
		mov	esi, [ebp+lpMem]
		test	esi, esi
		jz	loc_1001396D
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_10013867
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10013867:				; CODE XREF: sub_10013842+1Cj
		mov	eax, [esi+28h]
		test	eax, eax
		jz	short loc_10013875
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10013875:				; CODE XREF: sub_10013842+2Aj
		mov	eax, [esi+2Ch]
		test	eax, eax
		jz	short loc_10013883
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10013883:				; CODE XREF: sub_10013842+38j
		mov	eax, [esi+30h]
		test	eax, eax
		jz	short loc_10013891
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10013891:				; CODE XREF: sub_10013842+46j
		mov	eax, [esi+34h]
		test	eax, eax
		jz	short loc_1001389F
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001389F:				; CODE XREF: sub_10013842+54j
		mov	eax, [esi+3Ch]
		test	eax, eax
		jz	short loc_100138AD
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_100138AD:				; CODE XREF: sub_10013842+62j
		mov	eax, [esi+40h]
		test	eax, eax
		jz	short loc_100138BB
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_100138BB:				; CODE XREF: sub_10013842+70j
		mov	eax, [esi+44h]
		test	eax, eax
		jz	short loc_100138C9
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_100138C9:				; CODE XREF: sub_10013842+7Ej
		mov	eax, [esi+48h]
		test	eax, eax
		jz	short loc_100138D7
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_100138D7:				; CODE XREF: sub_10013842+8Cj
		mov	eax, [esi+5Ch]
		cmp	eax, offset dword_1002DF20
		jz	short loc_100138E8
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_100138E8:				; CODE XREF: sub_10013842+9Dj
		push	0Dh
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	edi, [esi+68h]
		test	edi, edi
		jz	short loc_10013915
		push	edi		; lpAddend
		call	ds:InterlockedDecrement
		test	eax, eax
		jnz	short loc_10013915
		cmp	edi, offset Addend
		jz	short loc_10013915
		push	edi		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10013915:				; CODE XREF: sub_10013842+B7j
					; sub_10013842+C2j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10013978
; ---------------------------------------------------------------------------

loc_10013921:				; CODE XREF: sub_10013842+13Ej
		push	0Ch
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], 1
		mov	edi, [esi+6Ch]
		test	edi, edi
		jz	short loc_1001395A
		push	edi		; lpAddend
		call	sub_10012448
		pop	ecx
		cmp	edi, off_1002DB68
		jz	short loc_1001395A
		cmp	edi, offset dword_1002DA90
		jz	short loc_1001395A
		cmp	dword ptr [edi], 0
		jnz	short loc_1001395A
		push	edi		; lpMem
		call	sub_10012270
		pop	ecx

loc_1001395A:				; CODE XREF: sub_10013842+F3j
					; sub_10013842+102j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10013984
; ---------------------------------------------------------------------------

loc_10013966:				; CODE XREF: sub_10013842+14Aj
		push	esi		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001396D:				; CODE XREF: sub_10013842+11j
		call	__SEH_epilog4
		retn	4
; ---------------------------------------------------------------------------

loc_10013975:				; DATA XREF: .rdata:stru_1002B590o
		mov	esi, [ebp+lpMem] ; Finally handler 0 for function 10013842

loc_10013978:				; CODE XREF: sub_10013842+DAj
		push	0Dh
		call	sub_100151D0
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013981:				; DATA XREF: .rdata:stru_1002B590o
		mov	esi, [ebp+lpMem] ; Finally handler 1 for function 10013842

loc_10013984:				; CODE XREF: sub_10013842+11Fj
		push	0Ch
		call	sub_100151D0
		pop	ecx
		retn
sub_10013842	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001398D(LPVOID lpMem)
sub_1001398D	proc near		; CODE XREF: sub_10011438+193p

lpMem		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002DB7C,	0FFFFFFFFh
		jz	short loc_100139E6
		cmp	[ebp+lpMem], 0
		jnz	short loc_100139C8
		push	esi
		push	dwTlsIndex	; dwTlsIndex
		mov	esi, ds:TlsGetValue
		call	esi ; TlsGetValue
		test	eax, eax
		jz	short loc_100139C7
		push	dword_1002DB7C
		push	dwTlsIndex	; dwTlsIndex
		call	esi ; TlsGetValue
		call	eax
		mov	[ebp+lpMem], eax

loc_100139C7:				; CODE XREF: sub_1001398D+25j
		pop	esi

loc_100139C8:				; CODE XREF: sub_1001398D+12j
		push	0
		push	dword_1002DB7C
		push	dword_1002E648
		call	sub_100135C4
		pop	ecx
		call	eax
		push	[ebp+lpMem]	; lpMem
		call	sub_10013842

loc_100139E6:				; CODE XREF: sub_1001398D+Cj
		mov	eax, dwTlsIndex
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100139F9
		push	0		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_100139F9:				; CODE XREF: sub_1001398D+61j
		pop	ebp
		retn
sub_1001398D	endp

; ---------------------------------------------------------------------------
		jmp	ds:GetCurrentThreadId
; ---------------------------------------------------------------------------
		jmp	ds:GetCurrentThread

; =============== S U B	R O U T	I N E =======================================


sub_10013A07	proc near		; CODE XREF: sub_10011438+9Cp
		mov	edi, edi
		push	ebx
		push	esi
		push	edi
		push	offset aKernel32_dll_0 ; "KERNEL32.DLL"
		call	ds:GetModuleHandleW
		mov	edi, eax
		xor	ebx, ebx
		cmp	edi, ebx
		jz	short loc_10013A59
		mov	esi, ds:GetProcAddress
		push	offset aFlsalloc ; "FlsAlloc"
		push	edi		; hModule
		call	esi ; GetProcAddress
		push	offset aFlsgetvalue ; "FlsGetValue"
		push	edi		; hModule
		mov	dword_1002E640,	eax
		call	esi ; GetProcAddress
		push	offset aFlssetvalue ; "FlsSetValue"
		push	edi		; hModule
		mov	lpTlsValue, eax
		call	esi ; GetProcAddress
		push	offset aFlsfree	; "FlsFree"
		push	edi		; hModule
		mov	dword_1002E648,	eax
		call	esi ; GetProcAddress
		mov	dword_1002E64C,	eax

loc_10013A59:				; CODE XREF: sub_10013A07+16j
		mov	esi, ds:TlsSetValue
		cmp	dword_1002E640,	ebx
		jz	short loc_10013A7F
		cmp	lpTlsValue, ebx
		jz	short loc_10013A7F
		cmp	dword_1002E648,	ebx
		jz	short loc_10013A7F
		cmp	dword_1002E64C,	ebx
		jnz	short loc_10013AA3

loc_10013A7F:				; CODE XREF: sub_10013A07+5Ej
					; sub_10013A07+66j ...
		mov	eax, ds:TlsGetValue
		mov	lpTlsValue, eax
		mov	eax, ds:TlsFree
		mov	dword_1002E640,	offset sub_10013637
		mov	dword_1002E648,	esi
		mov	dword_1002E64C,	eax

loc_10013AA3:				; CODE XREF: sub_10013A07+76j
		call	ds:TlsAlloc
		mov	dwTlsIndex, eax
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10013B16
		push	lpTlsValue	; lpTlsValue
		push	eax		; dwTlsIndex
		call	esi ; TlsSetValue
		test	eax, eax
		jz	short loc_10013B16
		call	sub_1001679B
		push	dword_1002E640
		call	sub_10013548
		push	lpTlsValue
		mov	dword_1002E640,	eax
		call	sub_10013548
		push	dword_1002E648
		mov	lpTlsValue, eax
		call	sub_10013548
		push	dword_1002E64C
		mov	dword_1002E648,	eax
		call	sub_10013548
		add	esp, 10h
		mov	dword_1002E64C,	eax
		call	sub_10015128
		test	eax, eax
		jnz	short loc_10013B1C

loc_10013B11:				; CODE XREF: sub_10013A07+130j
					; sub_10013A07+144j ...
		call	sub_100136A7

loc_10013B16:				; CODE XREF: sub_10013A07+AAj
					; sub_10013A07+B7j
		xor	eax, eax

loc_10013B18:				; CODE XREF: sub_10013A07+178j
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10013B1C:				; CODE XREF: sub_10013A07+108j
		push	offset sub_10013842
		push	dword_1002E640
		call	sub_100135C4
		pop	ecx
		call	eax
		mov	dword_1002DB7C,	eax
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10013B11
		push	214h
		push	1
		call	sub_1001D130
		mov	esi, eax
		pop	ecx
		pop	ecx
		cmp	esi, ebx
		jz	short loc_10013B11
		push	esi
		push	dword_1002DB7C
		push	dword_1002E648
		call	sub_100135C4
		pop	ecx
		call	eax
		test	eax, eax
		jnz	short loc_10013B6F
		push	esi		; lpMem
		call	sub_1000EE73
		pop	ecx
		jmp	short loc_10013B11
; ---------------------------------------------------------------------------

loc_10013B6F:				; CODE XREF: sub_10013A07+15Dj
		push	ebx
		push	esi
		call	sub_100136E4
		or	dword ptr [esi+4], 0FFFFFFFFh
		pop	ecx
		xor	eax, eax
		pop	ecx
		inc	eax
		jmp	short loc_10013B18
sub_10013A07	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013B81	proc near		; CODE XREF: .text:10013CC7p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+arg_4]
		lea	ecx, [eax+1]
		cmp	ecx, 100h
		ja	short loc_10013BB1
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx+0C8h]
		movzx	eax, word ptr [ecx+eax*2]
		jmp	short loc_10013BBE
; ---------------------------------------------------------------------------

loc_10013BB1:				; CODE XREF: sub_10013B81+1Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0C8h]
		movzx	eax, word ptr [eax-2]

loc_10013BBE:				; CODE XREF: sub_10013B81+2Ej
		and	eax, [ebp+arg_8]
		cmp	[ebp+var_4], 0
		jz	short locret_10013BCE
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_10013BCE:			; CODE XREF: sub_10013B81+44j
		leave
		retn
sub_10013B81	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013BD0	proc near		; CODE XREF: sub_1000E6C7+2Bp
					; sub_1000E756+28p ...

var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
MultiByteStr	= byte ptr -8
var_7		= byte ptr -7
var_6		= byte ptr -6
CharType	= word ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	[ebp+arg_8]
		lea	ecx, [ebp+var_18]
		call	sub_1000E615
		mov	ebx, [ebp+arg_0]
		lea	eax, [ebx+1]
		cmp	eax, 100h
		ja	short loc_10013C00
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0C8h]
		movzx	eax, word ptr [eax+ebx*2]
		jmp	short loc_10013C75
; ---------------------------------------------------------------------------

loc_10013C00:				; CODE XREF: sub_10013BD0+1Fj
		mov	[ebp+arg_0], ebx
		sar	[ebp+arg_0], 8
		lea	eax, [ebp+var_18]
		push	eax
		mov	eax, [ebp+arg_0]
		and	eax, 0FFh
		push	eax
		call	sub_100175C6
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10013C31
		mov	al, byte ptr [ebp+arg_0]
		push	2
		mov	[ebp+MultiByteStr], al
		mov	[ebp+var_7], bl
		mov	[ebp+var_6], 0
		pop	ecx
		jmp	short loc_10013C3B
; ---------------------------------------------------------------------------

loc_10013C31:				; CODE XREF: sub_10013BD0+4Dj
		xor	ecx, ecx
		mov	[ebp+MultiByteStr], bl
		mov	[ebp+var_7], 0
		inc	ecx

loc_10013C3B:				; CODE XREF: sub_10013BD0+5Fj
		mov	eax, [ebp+var_18]
		push	1		; int
		push	dword ptr [eax+14h] ; Locale
		push	dword ptr [eax+4] ; CodePage
		lea	eax, [ebp+CharType]
		push	eax		; lpCharType
		push	ecx		; cbMultiByte
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		lea	eax, [ebp+var_18]
		push	1		; dwInfoType
		push	eax		; int
		call	sub_10019DA5
		add	esp, 20h
		test	eax, eax
		jnz	short loc_10013C71
		cmp	[ebp+var_C], al
		jz	short loc_10013C6D
		mov	eax, [ebp+var_10]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10013C6D:				; CODE XREF: sub_10013BD0+94j
		xor	eax, eax
		jmp	short loc_10013C85
; ---------------------------------------------------------------------------

loc_10013C71:				; CODE XREF: sub_10013BD0+8Fj
		movzx	eax, [ebp+CharType]

loc_10013C75:				; CODE XREF: sub_10013BD0+2Ej
		and	eax, [ebp+arg_4]
		cmp	[ebp+var_C], 0
		jz	short loc_10013C85
		mov	ecx, [ebp+var_10]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

loc_10013C85:				; CODE XREF: sub_10013BD0+9Fj
					; sub_10013BD0+ACj
		pop	ebx
		leave
		retn
sub_10013BD0	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_10013CA8
		mov	eax, [ebp+8]
		mov	ecx, off_1002DB58
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, [ebp+0Ch]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10013CA8:				; CODE XREF: .text:10013C94j
		push	0
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10013BD0
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		push	0
		call	sub_10013B81
		add	esp, 0Ch
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013CD1	proc near		; CODE XREF: sub_1000ED67+4Ap
					; sub_100109A0+10Ep ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		push	esi
		call	sub_1001704B
		push	eax
		call	sub_1001D23E
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10013D60
		cmp	esi, offset dword_1002D2F8
		jnz	short loc_10013CF8
		xor	eax, eax
		jmp	short loc_10013D03
; ---------------------------------------------------------------------------

loc_10013CF8:				; CODE XREF: sub_10013CD1+21j
		cmp	esi, offset dword_1002D318
		jnz	short loc_10013D60
		xor	eax, eax
		inc	eax

loc_10013D03:				; CODE XREF: sub_10013CD1+25j
		inc	dword_1002E5E4
		test	dword ptr [esi+0Ch], 10Ch
		jnz	short loc_10013D60
		push	ebx
		push	edi
		lea	edi, dword_1002E650[eax*4]
		cmp	dword ptr [edi], 0
		mov	ebx, 1000h
		jnz	short loc_10013D45
		push	ebx
		call	sub_1000F5A0
		pop	ecx
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_10013D45
		lea	eax, [esi+14h]
		push	2
		mov	[esi+8], eax
		mov	[esi], eax
		pop	eax
		mov	[esi+18h], eax
		mov	[esi+4], eax
		jmp	short loc_10013D52
; ---------------------------------------------------------------------------

loc_10013D45:				; CODE XREF: sub_10013CD1+52j
					; sub_10013CD1+5Fj
		mov	edi, [edi]
		mov	[esi+8], edi
		mov	[esi], edi
		mov	[esi+18h], ebx
		mov	[esi+4], ebx

loc_10013D52:				; CODE XREF: sub_10013CD1+72j
		or	dword ptr [esi+0Ch], 1102h
		xor	eax, eax
		pop	edi
		inc	eax
		pop	ebx
		jmp	short loc_10013D62
; ---------------------------------------------------------------------------

loc_10013D60:				; CODE XREF: sub_10013CD1+19j
					; sub_10013CD1+2Dj ...
		xor	eax, eax

loc_10013D62:				; CODE XREF: sub_10013CD1+8Dj
		pop	esi
		pop	ebp
		retn
sub_10013CD1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013D65	proc near		; CODE XREF: sub_1000ED67+64p
					; sub_100109A0+128p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_10013D97
		push	esi
		mov	esi, [ebp+arg_4]
		test	dword ptr [esi+0Ch], 1000h
		jz	short loc_10013D96
		push	esi
		call	sub_100107BA
		and	dword ptr [esi+0Ch], 0FFFFEEFFh
		and	dword ptr [esi+18h], 0
		and	dword ptr [esi], 0
		and	dword ptr [esi+8], 0
		pop	ecx

loc_10013D96:				; CODE XREF: sub_10013D65+16j
		pop	esi

loc_10013D97:				; CODE XREF: sub_10013D65+9j
		pop	ebp
		retn
sub_10013D65	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013D99	proc near		; CODE XREF: sub_10013DCC+13p
					; sub_10013DF2+25p ...
		test	byte ptr [ecx+0Ch], 40h
		jz	short loc_10013DA5
		cmp	dword ptr [ecx+8], 0
		jz	short loc_10013DC9

loc_10013DA5:				; CODE XREF: sub_10013D99+4j
		dec	dword ptr [ecx+4]
		js	short loc_10013DB5
		mov	edx, [ecx]
		mov	[edx], al
		inc	dword ptr [ecx]
		movzx	eax, al
		jmp	short loc_10013DC1
; ---------------------------------------------------------------------------

loc_10013DB5:				; CODE XREF: sub_10013D99+Fj
		movsx	eax, al
		push	ecx
		push	eax
		call	sub_10016BC8
		pop	ecx
		pop	ecx

loc_10013DC1:				; CODE XREF: sub_10013D99+1Aj
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10013DC9
		or	[esi], eax
		retn
; ---------------------------------------------------------------------------

loc_10013DC9:				; CODE XREF: sub_10013D99+Aj
					; sub_10013D99+2Bj
		inc	dword ptr [esi]
		retn
sub_10013D99	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013DCC	proc near		; CODE XREF: sub_10013E79+AA1p
					; sub_10013E79+AE3p ...

arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, eax
		jmp	short loc_10013DE9
; ---------------------------------------------------------------------------

loc_10013DD6:				; CODE XREF: sub_10013DCC+21j
		mov	ecx, [ebp+arg_8]
		mov	al, [ebp+arg_0]
		dec	[ebp+arg_4]
		call	sub_10013D99
		cmp	dword ptr [esi], 0FFFFFFFFh
		jz	short loc_10013DEF

loc_10013DE9:				; CODE XREF: sub_10013DCC+8j
		cmp	[ebp+arg_4], 0
		jg	short loc_10013DD6

loc_10013DEF:				; CODE XREF: sub_10013DCC+1Bj
		pop	esi
		pop	ebp
		retn
sub_10013DCC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013DF2	proc near		; CODE XREF: sub_10013E79+AC1p
					; sub_10013E79+B46p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		test	byte ptr [edi+0Ch], 40h
		push	ebx
		push	esi
		mov	esi, eax
		mov	ebx, ecx
		jz	short loc_10013E35
		cmp	dword ptr [edi+8], 0
		jnz	short loc_10013E35
		mov	eax, [ebp+arg_0]
		add	[esi], eax
		jmp	short loc_10013E3B
; ---------------------------------------------------------------------------

loc_10013E10:				; CODE XREF: sub_10013DF2+47j
		mov	al, [ebx]
		dec	[ebp+arg_0]
		mov	ecx, edi
		call	sub_10013D99
		inc	ebx
		cmp	dword ptr [esi], 0FFFFFFFFh
		jnz	short loc_10013E35
		call	sub_10014BF2
		cmp	dword ptr [eax], 2Ah
		jnz	short loc_10013E3B
		mov	ecx, edi
		mov	al, 3Fh
		call	sub_10013D99

loc_10013E35:				; CODE XREF: sub_10013DF2+Fj
					; sub_10013DF2+15j ...
		cmp	[ebp+arg_0], 0
		jg	short loc_10013E10

loc_10013E3B:				; CODE XREF: sub_10013DF2+1Cj
					; sub_10013DF2+38j
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10013DF2	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		add	dword ptr [eax], 4
		mov	eax, [eax]
		mov	eax, [eax-4]
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		add	dword ptr [eax], 8
		mov	ecx, [eax]
		mov	eax, [ecx-8]
		mov	edx, [ecx-4]
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		add	dword ptr [eax], 4
		mov	eax, [eax]
		mov	ax, [eax-4]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013E79	proc near		; CODE XREF: sub_1000ED67+5Ap
					; sub_1000FA78+82p ...

var_278		= dword	ptr -278h
var_274		= dword	ptr -274h
var_270		= dword	ptr -270h
var_26C		= dword	ptr -26Ch
var_264		= dword	ptr -264h
var_260		= dword	ptr -260h
var_25C		= dword	ptr -25Ch
var_258		= dword	ptr -258h
lpMem		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= byte ptr -24Ch
var_244		= dword	ptr -244h
var_240		= byte ptr -240h
var_23C		= dword	ptr -23Ch
var_238		= dword	ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= byte ptr -22Ch
var_22B		= byte ptr -22Bh
var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_211		= byte ptr -211h
var_210		= dword	ptr -210h
MultiByteStr	= byte ptr -20Ch
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 278h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_0]
		xor	eax, eax
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+arg_C]
		push	[ebp+arg_8]
		lea	ecx, [ebp+var_24C]
		mov	[ebp+var_25C], ebx
		mov	[ebp+var_230], esi
		mov	[ebp+var_224], edi
		mov	[ebp+var_258], eax
		mov	[ebp+var_210], eax
		mov	[ebp+var_238], eax
		mov	[ebp+var_218], eax
		mov	[ebp+var_234], eax
		mov	[ebp+var_260], eax
		mov	[ebp+var_250], eax
		mov	[ebp+var_23C], eax
		call	sub_1000E615
		test	ebx, ebx
		jnz	short loc_10013F25

loc_10013EF0:				; CODE XREF: sub_10013E79+FFj
					; sub_10013E79+14Ej ...
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax

loc_10013F02:				; CODE XREF: sub_10013E79+BEEj
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_240], 0
		jz	short loc_10013F1D
		mov	eax, [ebp+var_244]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10013F1D:				; CODE XREF: sub_10013E79+98j
		or	eax, 0FFFFFFFFh
		jmp	loc_10014A85
; ---------------------------------------------------------------------------

loc_10013F25:				; CODE XREF: sub_10013E79+75j
		test	byte ptr [ebx+0Ch], 40h
		jnz	loc_10013FCD
		push	ebx
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10013F6F
		push	ebx
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10013F6F
		push	ebx
		call	sub_1001704B
		sar	eax, 5
		push	ebx
		lea	esi, dword_1002F080[eax*4]
		call	sub_1001704B
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [esi]
		mov	esi, [ebp+var_230]
		pop	ecx
		pop	ecx
		jmp	short loc_10013F74
; ---------------------------------------------------------------------------

loc_10013F6F:				; CODE XREF: sub_10013E79+C0j
					; sub_10013E79+CCj
		mov	eax, offset dword_1002DEE0

loc_10013F74:				; CODE XREF: sub_10013E79+F4j
		test	byte ptr [eax+8], 3
		jnz	loc_10013EF0
		push	ebx
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10013FBE
		push	ebx
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10013FBE
		push	ebx
		call	sub_1001704B
		sar	eax, 5
		push	ebx
		lea	esi, dword_1002F080[eax*4]
		call	sub_1001704B
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [esi]
		mov	esi, [ebp+var_230]
		pop	ecx
		pop	ecx
		jmp	short loc_10013FC3
; ---------------------------------------------------------------------------

loc_10013FBE:				; CODE XREF: sub_10013E79+10Fj
					; sub_10013E79+11Bj
		mov	eax, offset dword_1002DEE0

loc_10013FC3:				; CODE XREF: sub_10013E79+143j
		test	byte ptr [eax+8], 8
		jnz	loc_10013EF0

loc_10013FCD:				; CODE XREF: sub_10013E79+B0j
		test	esi, esi
		jz	loc_10013EF0
		mov	cl, [esi]
		xor	edx, edx
		mov	[ebp+var_228], edx
		mov	[ebp+var_220], edx
		mov	[ebp+lpMem], edx
		mov	[ebp+var_211], cl
		test	cl, cl
		jz	loc_10014A6C

loc_10013FF9:				; CODE XREF: sub_10013E79+BD9j
		inc	esi
		cmp	[ebp+var_228], 0
		mov	[ebp+var_230], esi
		jl	loc_10014A6C
		mov	al, cl
		sub	al, 20h
		cmp	al, 58h
		ja	short loc_10014024
		movsx	eax, cl
		movsx	eax, byte ptr ds:aFlsalloc[eax]	; "FlsAlloc"
		and	eax, 0Fh
		jmp	short loc_10014026
; ---------------------------------------------------------------------------

loc_10014024:				; CODE XREF: sub_10013E79+19Aj
		xor	eax, eax

loc_10014026:				; CODE XREF: sub_10013E79+1A9j
		movsx	eax, ds:byte_10029130[edx+eax*8]
		push	7
		sar	eax, 4
		pop	edx
		mov	[ebp+var_270], eax
		cmp	eax, edx	; switch 8 cases
		ja	loc_10014A2C	; jumptable 10014042 default case
		jmp	ds:off_10014A95[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10014049:				; CODE XREF: sub_10013E79+1C9j
					; DATA XREF: .text:off_10014A95o
		xor	eax, eax	; jumptable 10014042 case 1
		or	[ebp+var_218], 0FFFFFFFFh
		mov	[ebp+var_260], eax
		mov	[ebp+var_250], eax
		mov	[ebp+var_238], eax
		mov	[ebp+var_234], eax
		mov	[ebp+var_210], eax
		mov	[ebp+var_23C], eax
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_1001407B:				; CODE XREF: sub_10013E79+1C9j
					; DATA XREF: .text:off_10014A95o
		movsx	eax, cl		; jumptable 10014042 case 2
		sub	eax, 20h
		jz	short loc_100140CD
		sub	eax, 3
		jz	short loc_100140BE
		sub	eax, 8
		jz	short loc_100140B2
		dec	eax
		dec	eax
		jz	short loc_100140A6
		sub	eax, 3
		jnz	loc_10014A2C	; jumptable 10014042 default case
		or	[ebp+var_210], 8
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100140A6:				; CODE XREF: sub_10013E79+216j
		or	[ebp+var_210], 4
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100140B2:				; CODE XREF: sub_10013E79+212j
		or	[ebp+var_210], 1
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100140BE:				; CODE XREF: sub_10013E79+20Dj
		or	[ebp+var_210], 80h
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100140CD:				; CODE XREF: sub_10013E79+208j
		or	[ebp+var_210], 2
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100140D9:				; CODE XREF: sub_10013E79+1C9j
					; DATA XREF: .text:off_10014A95o
		cmp	cl, 2Ah		; jumptable 10014042 case 3
		jnz	short loc_1001410A
		add	edi, 4
		mov	[ebp+var_224], edi
		mov	edi, [edi-4]
		mov	[ebp+var_238], edi
		test	edi, edi
		jge	loc_10014A2C	; jumptable 10014042 default case
		or	[ebp+var_210], 4
		neg	[ebp+var_238]
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_1001410A:				; CODE XREF: sub_10013E79+263j
		mov	eax, [ebp+var_238]
		imul	eax, 0Ah
		movsx	ecx, cl
		lea	eax, [eax+ecx-30h]
		mov	[ebp+var_238], eax
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_10014125:				; CODE XREF: sub_10013E79+1C9j
					; DATA XREF: .text:off_10014A95o
		and	[ebp+var_218], 0 ; jumptable 10014042 case 4
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_10014131:				; CODE XREF: sub_10013E79+1C9j
					; DATA XREF: .text:off_10014A95o
		cmp	cl, 2Ah		; jumptable 10014042 case 5
		jnz	short loc_1001415C
		add	edi, 4
		mov	[ebp+var_224], edi
		mov	edi, [edi-4]
		mov	[ebp+var_218], edi
		test	edi, edi
		jge	loc_10014A2C	; jumptable 10014042 default case
		or	[ebp+var_218], 0FFFFFFFFh
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_1001415C:				; CODE XREF: sub_10013E79+2BBj
		mov	eax, [ebp+var_218]
		imul	eax, 0Ah
		movsx	ecx, cl
		lea	eax, [eax+ecx-30h]
		mov	[ebp+var_218], eax
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_10014177:				; CODE XREF: sub_10013E79+1C9j
					; DATA XREF: .text:off_10014A95o
		cmp	cl, 49h		; jumptable 10014042 case 6
		jz	short loc_100141D1
		cmp	cl, 68h
		jz	short loc_100141C5
		cmp	cl, 6Ch
		jz	short loc_1001419E
		cmp	cl, 77h
		jnz	loc_10014A2C	; jumptable 10014042 default case
		or	[ebp+var_210], 800h
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_1001419E:				; CODE XREF: sub_10013E79+30Bj
		cmp	byte ptr [esi],	6Ch
		jnz	short loc_100141B9
		inc	esi
		or	[ebp+var_210], 1000h
		mov	[ebp+var_230], esi
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100141B9:				; CODE XREF: sub_10013E79+328j
		or	[ebp+var_210], 10h
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100141C5:				; CODE XREF: sub_10013E79+306j
		or	[ebp+var_210], 20h
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100141D1:				; CODE XREF: sub_10013E79+301j
		mov	al, [esi]
		cmp	al, 36h
		jnz	short loc_100141F4
		cmp	byte ptr [esi+1], 34h
		jnz	short loc_100141F4
		inc	esi
		inc	esi
		or	[ebp+var_210], 8000h
		mov	[ebp+var_230], esi
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100141F4:				; CODE XREF: sub_10013E79+35Cj
					; sub_10013E79+362j
		cmp	al, 33h
		jnz	short loc_10014215
		cmp	byte ptr [esi+1], 32h
		jnz	short loc_10014215
		inc	esi
		inc	esi
		and	[ebp+var_210], 0FFFF7FFFh
		mov	[ebp+var_230], esi
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_10014215:				; CODE XREF: sub_10013E79+37Dj
					; sub_10013E79+383j
		cmp	al, 64h
		jz	loc_10014A2C	; jumptable 10014042 default case
		cmp	al, 69h
		jz	loc_10014A2C	; jumptable 10014042 default case
		cmp	al, 6Fh
		jz	loc_10014A2C	; jumptable 10014042 default case
		cmp	al, 75h
		jz	loc_10014A2C	; jumptable 10014042 default case
		cmp	al, 78h
		jz	loc_10014A2C	; jumptable 10014042 default case
		cmp	al, 58h
		jz	loc_10014A2C	; jumptable 10014042 default case
		and	[ebp+var_270], 0

loc_1001424C:				; CODE XREF: sub_10013E79+1C9j
					; DATA XREF: .text:off_10014A95o
		and	[ebp+var_23C], 0 ; jumptable 10014042 case 0
		lea	eax, [ebp+var_24C]
		push	eax
		movzx	eax, cl
		push	eax
		call	sub_100175C6
		pop	ecx
		test	eax, eax
		mov	al, [ebp+var_211]
		pop	ecx
		jz	short loc_10014292
		lea	esi, [ebp+var_228]
		mov	ecx, ebx
		call	sub_10013D99
		mov	eax, [ebp+var_230]
		mov	al, [eax]
		inc	[ebp+var_230]
		test	al, al
		jz	loc_10013EF0

loc_10014292:				; CODE XREF: sub_10013E79+3F4j
		lea	esi, [ebp+var_228]
		mov	ecx, ebx
		call	sub_10013D99
		jmp	loc_10014A2C	; jumptable 10014042 default case
; ---------------------------------------------------------------------------

loc_100142A4:				; CODE XREF: sub_10013E79+1C9j
					; DATA XREF: .text:off_10014A95o
		movsx	eax, cl		; jumptable 10014042 case 7
		cmp	eax, 64h
		jg	loc_100144C7
		jz	loc_1001455E
		cmp	eax, 53h
		jg	loc_100143B2
		jz	loc_10014346
		sub	eax, 41h
		jz	short loc_100142DA
		dec	eax
		dec	eax
		jz	short loc_10014327
		dec	eax
		dec	eax
		jz	short loc_100142DA
		dec	eax
		dec	eax
		jnz	loc_100148A7

loc_100142DA:				; CODE XREF: sub_10013E79+44Fj
					; sub_10013E79+457j
		add	cl, 20h
		mov	[ebp+var_260], 1
		mov	[ebp+var_211], cl

loc_100142ED:				; CODE XREF: sub_10013E79+548j
					; sub_10013E79+669j
		or	[ebp+var_210], 40h
		cmp	[ebp+var_218], 0
		lea	eax, [ebp+MultiByteStr]
		mov	[ebp+var_21C], eax
		mov	eax, 200h
		mov	[ebp+var_264], eax
		jge	loc_1001458E
		mov	[ebp+var_218], 6
		jmp	loc_100145F3
; ---------------------------------------------------------------------------

loc_10014327:				; CODE XREF: sub_10013E79+453j
		test	[ebp+var_210], 830h
		jnz	loc_100143CF
		or	[ebp+var_210], 800h
		jmp	loc_100143CF
; ---------------------------------------------------------------------------

loc_10014346:				; CODE XREF: sub_10013E79+446j
		test	[ebp+var_210], 830h
		jnz	short loc_1001435C
		or	[ebp+var_210], 800h

loc_1001435C:				; CODE XREF: sub_10013E79+4D7j
					; sub_10013E79+860j
		mov	edx, [ebp+var_218]
		cmp	edx, 0FFFFFFFFh
		jnz	short loc_1001436C
		mov	edx, 7FFFFFFFh

loc_1001436C:				; CODE XREF: sub_10013E79+4ECj
		add	edi, 4
		test	[ebp+var_210], 810h
		mov	[ebp+var_224], edi
		mov	edi, [edi-4]
		mov	[ebp+var_21C], edi
		jz	loc_10014879
		test	edi, edi
		jnz	short loc_1001439D
		mov	eax, off_1002DB84
		mov	[ebp+var_21C], eax

loc_1001439D:				; CODE XREF: sub_10013E79+517j
		mov	eax, [ebp+var_21C]
		mov	[ebp+var_23C], 1
		jmp	loc_1001486B
; ---------------------------------------------------------------------------

loc_100143B2:				; CODE XREF: sub_10013E79+440j
		sub	eax, 58h
		jz	loc_100146CE
		dec	eax
		dec	eax
		jz	short loc_10014438
		sub	eax, edx
		jz	loc_100142ED
		dec	eax
		dec	eax
		jnz	loc_100148A7

loc_100143CF:				; CODE XREF: sub_10013E79+4B8j
					; sub_10013E79+4C8j
		add	edi, 4
		test	[ebp+var_210], 810h
		mov	[ebp+var_224], edi
		jz	short loc_10014414
		movzx	eax, word ptr [edi-4]
		push	eax		; WideCharStr
		push	200h		; cbMultiByte
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		lea	eax, [ebp+var_220]
		push	eax		; int
		call	sub_1001D46F
		add	esp, 10h
		test	eax, eax
		jz	short loc_10014427
		mov	[ebp+var_250], 1
		jmp	short loc_10014427
; ---------------------------------------------------------------------------

loc_10014414:				; CODE XREF: sub_10013E79+569j
		mov	al, [edi-4]
		mov	[ebp+MultiByteStr], al
		mov	[ebp+var_220], 1

loc_10014427:				; CODE XREF: sub_10013E79+58Dj
					; sub_10013E79+599j
		lea	eax, [ebp+MultiByteStr]
		mov	[ebp+var_21C], eax
		jmp	loc_100148A7
; ---------------------------------------------------------------------------

loc_10014438:				; CODE XREF: sub_10013E79+544j
		mov	eax, [edi]
		add	edi, 4
		mov	[ebp+var_224], edi
		test	eax, eax
		jz	short loc_100144AB
		mov	esi, [eax+4]
		xor	edi, edi
		cmp	esi, edi
		jz	short loc_100144AB
		movzx	ecx, word ptr [eax]
		cmp	[eax+2], cx
		jb	loc_10014A57
		test	[ebp+var_210], 800h
		movzx	eax, cx
		jz	short loc_1001449A
		xor	ecx, ecx
		mov	edx, eax
		not	edx
		inc	ecx
		test	cl, dl
		jz	loc_10014A57
		mov	edx, esi
		not	edx
		test	cl, dl
		jz	loc_10014A57
		mov	[ebp+var_21C], esi
		shr	eax, 1
		mov	[ebp+var_23C], ecx
		jmp	loc_100148A1
; ---------------------------------------------------------------------------

loc_1001449A:				; CODE XREF: sub_10013E79+5F1j
		mov	[ebp+var_23C], edi
		mov	[ebp+var_21C], esi
		jmp	loc_100148A1
; ---------------------------------------------------------------------------

loc_100144AB:				; CODE XREF: sub_10013E79+5CCj
					; sub_10013E79+5D5j
		mov	eax, off_1002DB80
		mov	[ebp+var_21C], eax
		lea	edx, [eax+1]

loc_100144B9:				; CODE XREF: sub_10013E79+645j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100144B9

loc_100144C0:				; CODE XREF: sub_10013E79+846j
		sub	eax, edx
		jmp	loc_100148A1
; ---------------------------------------------------------------------------

loc_100144C7:				; CODE XREF: sub_10013E79+431j
		cmp	eax, 70h
		jg	loc_100146D6
		jz	loc_100146C4
		cmp	eax, 65h
		jl	loc_100148A7
		cmp	eax, 67h
		jle	loc_100142ED
		cmp	eax, 69h
		jz	short loc_1001455E
		cmp	eax, 6Eh
		jz	short loc_1001451A
		cmp	eax, 6Fh
		jnz	loc_100148A7
		test	byte ptr [ebp+var_210],	80h
		mov	[ebp+var_220], 8
		jz	short loc_1001456F
		or	[ebp+var_210], 200h
		jmp	short loc_1001456F
; ---------------------------------------------------------------------------

loc_1001451A:				; CODE XREF: sub_10013E79+677j
		mov	esi, [edi]
		add	edi, 4
		mov	[ebp+var_224], edi
		call	sub_1001D2ED
		test	eax, eax
		jz	loc_10013EF0
		test	byte ptr [ebp+var_210],	20h
		jz	short loc_10014547
		mov	ax, word ptr [ebp+var_228]
		mov	[esi], ax
		jmp	short loc_1001454F
; ---------------------------------------------------------------------------

loc_10014547:				; CODE XREF: sub_10013E79+6C0j
		mov	eax, [ebp+var_228]
		mov	[esi], eax

loc_1001454F:				; CODE XREF: sub_10013E79+6CCj
		mov	[ebp+var_250], 1
		jmp	loc_10014A10
; ---------------------------------------------------------------------------

loc_1001455E:				; CODE XREF: sub_10013E79+437j
					; sub_10013E79+672j
		or	[ebp+var_210], 40h

loc_10014565:				; CODE XREF: sub_10013E79+868j
		mov	[ebp+var_220], 0Ah

loc_1001456F:				; CODE XREF: sub_10013E79+693j
					; sub_10013E79+69Fj ...
		mov	ecx, [ebp+var_210]
		test	ecx, 8000h
		jz	loc_10014735

loc_10014581:				; CODE XREF: sub_10013E79+8C2j
		mov	eax, [edi]
		mov	edx, [edi+4]
		add	edi, 8
		jmp	loc_1001476E
; ---------------------------------------------------------------------------

loc_1001458E:				; CODE XREF: sub_10013E79+499j
		jnz	short loc_100145A1
		cmp	cl, 67h
		jnz	short loc_100145F3
		mov	[ebp+var_218], 1
		jmp	short loc_100145F3
; ---------------------------------------------------------------------------

loc_100145A1:				; CODE XREF: sub_10013E79:loc_1001458Ej
		cmp	[ebp+var_218], eax
		jle	short loc_100145AF
		mov	[ebp+var_218], eax

loc_100145AF:				; CODE XREF: sub_10013E79+72Ej
		mov	ebx, 0A3h
		cmp	[ebp+var_218], ebx
		jle	short loc_100145F3
		mov	esi, [ebp+var_218]
		add	esi, 15Dh
		push	esi
		call	sub_1000F5A0
		pop	ecx
		mov	cl, [ebp+var_211]
		mov	[ebp+lpMem], eax
		test	eax, eax
		jz	short loc_100145ED
		mov	[ebp+var_21C], eax
		mov	[ebp+var_264], esi
		jmp	short loc_100145F3
; ---------------------------------------------------------------------------

loc_100145ED:				; CODE XREF: sub_10013E79+764j
		mov	[ebp+var_218], ebx

loc_100145F3:				; CODE XREF: sub_10013E79+4A9j
					; sub_10013E79+71Aj ...
		mov	eax, [edi]
		add	edi, 8
		mov	[ebp+var_278], eax
		mov	eax, [edi-4]
		mov	[ebp+var_274], eax
		lea	eax, [ebp+var_24C]
		push	eax
		push	[ebp+var_260]
		movsx	eax, cl
		push	[ebp+var_218]
		mov	[ebp+var_224], edi
		mov	edi, [ebp+var_21C]
		push	eax
		push	[ebp+var_264]
		lea	eax, [ebp+var_278]
		push	edi
		push	eax
		push	off_1002E198
		call	sub_100135C4
		pop	ecx
		call	eax
		mov	esi, [ebp+var_210]
		add	esp, 1Ch
		and	esi, 80h
		jz	short loc_10014678
		cmp	[ebp+var_218], 0
		jnz	short loc_10014678
		lea	eax, [ebp+var_24C]
		push	eax
		push	edi
		push	off_1002E1A4
		call	sub_100135C4
		pop	ecx
		call	eax
		pop	ecx
		pop	ecx

loc_10014678:				; CODE XREF: sub_10013E79+7DCj
					; sub_10013E79+7E5j
		cmp	[ebp+var_211], 67h
		jnz	short loc_1001469D
		test	esi, esi
		jnz	short loc_1001469D
		lea	eax, [ebp+var_24C]
		push	eax
		push	edi
		push	off_1002E1A0
		call	sub_100135C4
		pop	ecx
		call	eax
		pop	ecx
		pop	ecx

loc_1001469D:				; CODE XREF: sub_10013E79+806j
					; sub_10013E79+80Aj
		cmp	byte ptr [edi],	2Dh
		jnz	short loc_100146B3
		or	[ebp+var_210], 100h
		inc	edi
		mov	[ebp+var_21C], edi

loc_100146B3:				; CODE XREF: sub_10013E79+827j
		mov	eax, edi
		lea	edx, [eax+1]

loc_100146B8:				; CODE XREF: sub_10013E79+844j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100146B8
		jmp	loc_100144C0
; ---------------------------------------------------------------------------

loc_100146C4:				; CODE XREF: sub_10013E79+657j
		mov	[ebp+var_218], 8

loc_100146CE:				; CODE XREF: sub_10013E79+53Cj
		mov	[ebp+var_258], edx
		jmp	short loc_100146FA
; ---------------------------------------------------------------------------

loc_100146D6:				; CODE XREF: sub_10013E79+651j
		sub	eax, 73h
		jz	loc_1001435C
		dec	eax
		dec	eax
		jz	loc_10014565
		sub	eax, 3
		jnz	loc_100148A7
		mov	[ebp+var_258], 27h

loc_100146FA:				; CODE XREF: sub_10013E79+85Bj
		test	byte ptr [ebp+var_210],	80h
		mov	[ebp+var_220], 10h
		jz	loc_1001456F
		mov	al, byte ptr [ebp+var_258]
		add	al, 51h
		mov	[ebp+var_22C], 30h
		mov	[ebp+var_22B], al
		mov	[ebp+var_234], 2
		jmp	loc_1001456F
; ---------------------------------------------------------------------------

loc_10014735:				; CODE XREF: sub_10013E79+702j
		test	ecx, 1000h
		jnz	loc_10014581
		add	edi, 4
		test	cl, 20h
		jz	short loc_10014761
		mov	[ebp+var_224], edi
		test	cl, 40h
		jz	short loc_1001475A
		movsx	eax, word ptr [edi-4]
		jmp	short loc_1001475E
; ---------------------------------------------------------------------------

loc_1001475A:				; CODE XREF: sub_10013E79+8D9j
		movzx	eax, word ptr [edi-4]

loc_1001475E:				; CODE XREF: sub_10013E79+8DFj
		cdq
		jmp	short loc_10014774
; ---------------------------------------------------------------------------

loc_10014761:				; CODE XREF: sub_10013E79+8CEj
		mov	eax, [edi-4]
		test	cl, 40h
		jz	short loc_1001476C
		cdq
		jmp	short loc_1001476E
; ---------------------------------------------------------------------------

loc_1001476C:				; CODE XREF: sub_10013E79+8EEj
		xor	edx, edx

loc_1001476E:				; CODE XREF: sub_10013E79+710j
					; sub_10013E79+8F1j
		mov	[ebp+var_224], edi

loc_10014774:				; CODE XREF: sub_10013E79+8E6j
		test	cl, 40h
		jz	short loc_10014794
		test	edx, edx
		jg	short loc_10014794
		jl	short loc_10014783
		test	eax, eax
		jnb	short loc_10014794

loc_10014783:				; CODE XREF: sub_10013E79+904j
		neg	eax
		adc	edx, 0
		neg	edx
		or	[ebp+var_210], 100h

loc_10014794:				; CODE XREF: sub_10013E79+8FEj
					; sub_10013E79+902j ...
		test	[ebp+var_210], 9000h
		mov	ebx, edx
		mov	edi, eax
		jnz	short loc_100147A6
		xor	ebx, ebx

loc_100147A6:				; CODE XREF: sub_10013E79+929j
		cmp	[ebp+var_218], 0
		jge	short loc_100147BB
		mov	[ebp+var_218], 1
		jmp	short loc_100147D5
; ---------------------------------------------------------------------------

loc_100147BB:				; CODE XREF: sub_10013E79+934j
		and	[ebp+var_210], 0FFFFFFF7h
		mov	eax, 200h
		cmp	[ebp+var_218], eax
		jle	short loc_100147D5
		mov	[ebp+var_218], eax

loc_100147D5:				; CODE XREF: sub_10013E79+940j
					; sub_10013E79+954j
		mov	eax, edi
		or	eax, ebx
		jnz	short loc_100147E1
		and	[ebp+var_234], eax

loc_100147E1:				; CODE XREF: sub_10013E79+960j
		lea	esi, [ebp+var_D]

loc_100147E4:				; CODE XREF: sub_10013E79+9ACj
		mov	eax, [ebp+var_218]
		dec	[ebp+var_218]
		test	eax, eax
		jg	short loc_100147FA
		mov	eax, edi
		or	eax, ebx
		jz	short loc_10014827

loc_100147FA:				; CODE XREF: sub_10013E79+979j
		mov	eax, [ebp+var_220]
		cdq
		push	edx
		push	eax
		push	ebx
		push	edi
		call	sub_1001D510
		add	ecx, 30h
		cmp	ecx, 39h
		mov	[ebp+var_264], ebx
		mov	edi, eax
		mov	ebx, edx
		jle	short loc_10014822
		add	ecx, [ebp+var_258]

loc_10014822:				; CODE XREF: sub_10013E79+9A1j
		mov	[esi], cl
		dec	esi
		jmp	short loc_100147E4
; ---------------------------------------------------------------------------

loc_10014827:				; CODE XREF: sub_10013E79+97Fj
		lea	eax, [ebp+var_D]
		sub	eax, esi
		inc	esi
		test	[ebp+var_210], 200h
		mov	[ebp+var_220], eax
		mov	[ebp+var_21C], esi
		jz	short loc_100148A7
		test	eax, eax
		jz	short loc_10014850
		mov	ecx, esi
		cmp	byte ptr [ecx],	30h
		jz	short loc_100148A7

loc_10014850:				; CODE XREF: sub_10013E79+9CEj
		dec	[ebp+var_21C]
		mov	ecx, [ebp+var_21C]
		mov	byte ptr [ecx],	30h
		inc	eax
		jmp	short loc_100148A1
; ---------------------------------------------------------------------------

loc_10014862:				; CODE XREF: sub_10013E79+9F4j
		dec	edx
		cmp	word ptr [eax],	0
		jz	short loc_1001486F
		inc	eax
		inc	eax

loc_1001486B:				; CODE XREF: sub_10013E79+534j
		test	edx, edx
		jnz	short loc_10014862

loc_1001486F:				; CODE XREF: sub_10013E79+9EEj
		sub	eax, [ebp+var_21C]
		sar	eax, 1
		jmp	short loc_100148A1
; ---------------------------------------------------------------------------

loc_10014879:				; CODE XREF: sub_10013E79+50Fj
		test	edi, edi
		jnz	short loc_10014888
		mov	eax, off_1002DB80
		mov	[ebp+var_21C], eax

loc_10014888:				; CODE XREF: sub_10013E79+A02j
		mov	eax, [ebp+var_21C]
		jmp	short loc_10014897
; ---------------------------------------------------------------------------

loc_10014890:				; CODE XREF: sub_10013E79+A20j
		dec	edx
		cmp	byte ptr [eax],	0
		jz	short loc_1001489B
		inc	eax

loc_10014897:				; CODE XREF: sub_10013E79+A15j
		test	edx, edx
		jnz	short loc_10014890

loc_1001489B:				; CODE XREF: sub_10013E79+A1Bj
		sub	eax, [ebp+var_21C]

loc_100148A1:				; CODE XREF: sub_10013E79+61Cj
					; sub_10013E79+62Dj ...
		mov	[ebp+var_220], eax

loc_100148A7:				; CODE XREF: sub_10013E79+45Bj
					; sub_10013E79+550j ...
		cmp	[ebp+var_250], 0
		jnz	loc_10014A10
		mov	eax, [ebp+var_210]
		test	al, 40h
		jz	short loc_100148F0
		test	eax, 100h
		jz	short loc_100148CE
		mov	[ebp+var_22C], 2Dh
		jmp	short loc_100148E6
; ---------------------------------------------------------------------------

loc_100148CE:				; CODE XREF: sub_10013E79+A4Aj
		test	al, 1
		jz	short loc_100148DB
		mov	[ebp+var_22C], 2Bh
		jmp	short loc_100148E6
; ---------------------------------------------------------------------------

loc_100148DB:				; CODE XREF: sub_10013E79+A57j
		test	al, 2
		jz	short loc_100148F0
		mov	[ebp+var_22C], 20h

loc_100148E6:				; CODE XREF: sub_10013E79+A53j
					; sub_10013E79+A60j
		mov	[ebp+var_234], 1

loc_100148F0:				; CODE XREF: sub_10013E79+A43j
					; sub_10013E79+A64j
		mov	ebx, [ebp+var_238]
		sub	ebx, [ebp+var_220]
		sub	ebx, [ebp+var_234]
		test	byte ptr [ebp+var_210],	0Ch
		jnz	short loc_10014922
		push	[ebp+var_25C]
		lea	eax, [ebp+var_228]
		push	ebx
		push	20h
		call	sub_10013DCC
		add	esp, 0Ch

loc_10014922:				; CODE XREF: sub_10013E79+A90j
		push	[ebp+var_234]
		mov	edi, [ebp+var_25C]
		lea	eax, [ebp+var_228]
		lea	ecx, [ebp+var_22C]
		call	sub_10013DF2
		test	byte ptr [ebp+var_210],	8
		pop	ecx
		jz	short loc_10014964
		test	byte ptr [ebp+var_210],	4
		jnz	short loc_10014964
		push	edi
		push	ebx
		push	30h
		lea	eax, [ebp+var_228]
		call	sub_10013DCC
		add	esp, 0Ch

loc_10014964:				; CODE XREF: sub_10013E79+ACEj
					; sub_10013E79+AD7j
		cmp	[ebp+var_23C], 0
		mov	eax, [ebp+var_220]
		jz	short loc_100149D9
		test	eax, eax
		jle	short loc_100149D9
		mov	esi, [ebp+var_21C]
		mov	[ebp+var_264], eax

loc_10014983:				; CODE XREF: sub_10013E79+B53j
		movzx	eax, word ptr [esi]
		dec	[ebp+var_264]
		push	eax		; WideCharStr
		push	6		; cbMultiByte
		lea	eax, [ebp+var_C]
		push	eax		; lpMultiByteStr
		lea	eax, [ebp+var_26C]
		inc	esi
		push	eax		; int
		inc	esi
		call	sub_1001D46F
		add	esp, 10h
		test	eax, eax
		jnz	short loc_100149D0
		cmp	[ebp+var_26C], eax
		jz	short loc_100149D0
		push	[ebp+var_26C]
		lea	eax, [ebp+var_228]
		lea	ecx, [ebp+var_C]
		call	sub_10013DF2
		cmp	[ebp+var_264], 0
		pop	ecx
		jnz	short loc_10014983
		jmp	short loc_100149EC
; ---------------------------------------------------------------------------

loc_100149D0:				; CODE XREF: sub_10013E79+B2Dj
					; sub_10013E79+B35j
		or	[ebp+var_228], 0FFFFFFFFh
		jmp	short loc_100149EC
; ---------------------------------------------------------------------------

loc_100149D9:				; CODE XREF: sub_10013E79+AF8j
					; sub_10013E79+AFCj
		mov	ecx, [ebp+var_21C]
		push	eax
		lea	eax, [ebp+var_228]
		call	sub_10013DF2
		pop	ecx

loc_100149EC:				; CODE XREF: sub_10013E79+B55j
					; sub_10013E79+B5Ej
		cmp	[ebp+var_228], 0
		jl	short loc_10014A10
		test	byte ptr [ebp+var_210],	4
		jz	short loc_10014A10
		push	edi
		push	ebx
		push	20h
		lea	eax, [ebp+var_228]
		call	sub_10013DCC
		add	esp, 0Ch

loc_10014A10:				; CODE XREF: sub_10013E79+6E0j
					; sub_10013E79+A35j ...
		cmp	[ebp+lpMem], 0
		jz	short loc_10014A2C ; jumptable 10014042	default	case
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		and	[ebp+lpMem], 0
		pop	ecx

loc_10014A2C:				; CODE XREF: sub_10013E79+1C3j
					; sub_10013E79+1FDj ...
		mov	esi, [ebp+var_230] ; jumptable 10014042	default	case
		mov	al, [esi]
		mov	[ebp+var_211], al
		test	al, al
		jz	short loc_10014A6C
		mov	edx, [ebp+var_270]
		mov	ebx, [ebp+var_25C]
		mov	edi, [ebp+var_224]
		mov	cl, al
		jmp	loc_10013FF9
; ---------------------------------------------------------------------------

loc_10014A57:				; CODE XREF: sub_10013E79+5DEj
					; sub_10013E79+5FCj ...
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		push	edi
		jmp	loc_10013F02
; ---------------------------------------------------------------------------

loc_10014A6C:				; CODE XREF: sub_10013E79+17Aj
					; sub_10013E79+18Ej ...
		cmp	[ebp+var_240], 0
		jz	short loc_10014A7F
		mov	eax, [ebp+var_244]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10014A7F:				; CODE XREF: sub_10013E79+BFAj
		mov	eax, [ebp+var_228]

loc_10014A85:				; CODE XREF: sub_10013E79+A7j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10013E79	endp

; ---------------------------------------------------------------------------
		db 90h
off_10014A95	dd offset loc_1001424C	; DATA XREF: sub_10013E79+1C9r
		dd offset loc_10014049	; jump table for switch	statement
		dd offset loc_1001407B
		dd offset loc_100140D9
		dd offset loc_10014125
		dd offset loc_10014131
		dd offset loc_10014177
		dd offset loc_100142A4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014AB5	proc near		; CODE XREF: .text:1000F684p
					; .text:1000F7B0p ...

var_2D0		= dword	ptr -2D0h
var_244		= word ptr -244h
var_240		= word ptr -240h
var_23C		= word ptr -23Ch
var_238		= word ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_214		= word ptr -214h
var_210		= dword	ptr -210h
var_20C		= dword	ptr -20Ch
var_208		= word ptr -208h
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2D0h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	[ebp+var_220], eax
		mov	[ebp+var_224], ecx
		mov	[ebp+var_228], edx
		mov	[ebp+var_22C], ebx
		mov	[ebp+var_230], esi
		mov	[ebp+var_234], edi
		mov	[ebp+var_208], ss
		mov	[ebp+var_214], cs
		mov	[ebp+var_238], ds
		mov	[ebp+var_23C], es
		mov	[ebp+var_240], fs
		mov	[ebp+var_244], gs
		pushf
		pop	[ebp+var_210]
		mov	eax, [ebp+4]
		mov	[ebp+var_218], eax
		lea	eax, [ebp+4]
		mov	[ebp+var_2D0], 10001h
		mov	[ebp+var_20C], eax
		mov	eax, [eax-4]
		push	offset OutputString ; "Invalid parameter passed	to C runtime f"...
		mov	[ebp+var_21C], eax
		call	ds:OutputDebugStringA
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10014AB5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014B5B	proc near		; CODE XREF: sub_1000ED67+2Ap
					; sub_1000F32F+2Bp ...
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	sub_10014AB5
sub_10014B5B	endp

; ---------------------------------------------------------------------------
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014B76	proc near		; CODE XREF: sub_1000EE73+80p
					; sub_1000F114+182p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		xor	ecx, ecx

loc_10014B80:				; CODE XREF: sub_10014B76+17j
		cmp	eax, dword_1002DB88[ecx*8]
		jz	short loc_10014B9C
		inc	ecx
		cmp	ecx, 2Dh
		jb	short loc_10014B80
		lea	ecx, [eax-13h]
		cmp	ecx, 11h
		ja	short loc_10014BA5
		push	0Dh
		pop	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10014B9C:				; CODE XREF: sub_10014B76+11j
		mov	eax, dword_1002DB8C[ecx*8]
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10014BA5:				; CODE XREF: sub_10014B76+1Fj
		add	eax, 0FFFFFF44h
		push	0Eh
		pop	ecx
		cmp	ecx, eax
		sbb	eax, eax
		and	eax, ecx
		add	eax, 8
		pop	ebp
		retn
sub_10014B76	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		call	sub_100137AC
		test	eax, eax
		jnz	short loc_10014BCB
		push	0Ch
		pop	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10014BCB:				; CODE XREF: .text:10014BC4j
		mov	ecx, [ebp+8]
		mov	[eax+8], ecx
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		call	sub_100137AC
		test	eax, eax
		jnz	short loc_10014BE8
		push	0Ch
		pop	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10014BE8:				; CODE XREF: .text:10014BE1j
		mov	ecx, [ebp+8]
		mov	[eax+0Ch], ecx
		xor	eax, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10014BF2	proc near		; CODE XREF: sub_1000ED67+1Ap
					; sub_1000EE73+72p ...
		call	sub_100137AC
		test	eax, eax
		jnz	short loc_10014C01
		mov	eax, offset dword_1002DCF0
		retn
; ---------------------------------------------------------------------------

loc_10014C01:				; CODE XREF: sub_10014BF2+7j
		add	eax, 8
		retn
sub_10014BF2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014C05	proc near		; CODE XREF: sub_10014C18+6p
					; .text:loc_10014C8Bp ...
		call	sub_100137AC
		test	eax, eax
		jnz	short loc_10014C14
		mov	eax, offset dword_1002DCF4
		retn
; ---------------------------------------------------------------------------

loc_10014C14:				; CODE XREF: sub_10014C05+7j
		add	eax, 0Ch
		retn
sub_10014C05	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014C18	proc near		; CODE XREF: sub_10016EA6+88p
					; sub_1001838C+689p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		call	sub_10014C05
		mov	ecx, [ebp+arg_0]
		push	ecx
		mov	[eax], ecx
		call	sub_10014B76
		pop	ecx
		mov	esi, eax
		call	sub_10014BF2
		mov	[eax], esi
		pop	esi
		pop	ebp
		retn
sub_10014C18	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+8]
		xor	eax, eax
		cmp	esi, eax
		jnz	short loc_10014C5C
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_10014C67
; ---------------------------------------------------------------------------

loc_10014C5C:				; CODE XREF: .text:10014C48j
		call	sub_10014BF2
		mov	eax, [eax]
		mov	[esi], eax
		xor	eax, eax

loc_10014C67:				; CODE XREF: .text:10014C5Aj
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+8]
		xor	eax, eax
		cmp	esi, eax
		jnz	short loc_10014C8B
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_10014C96
; ---------------------------------------------------------------------------

loc_10014C8B:				; CODE XREF: .text:10014C77j
		call	sub_10014C05
		mov	eax, [eax]
		mov	[esi], eax
		xor	eax, eax

loc_10014C96:				; CODE XREF: .text:10014C89j
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4
; [00000045 BYTES: COLLAPSED FUNCTION __SEH_prolog4]
; [00000014 BYTES: COLLAPSED FUNCTION __SEH_epilog4]
		align 10h
		mov	eax, [edi]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10014D14
		mov	ecx, [edi+4]
		add	ecx, esi
		xor	ecx, [eax+esi]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)

loc_10014D14:				; CODE XREF: .text:10014D05j
		mov	ecx, [edi+0Ch]
		mov	eax, [edi+8]
		add	ecx, esi
		xor	ecx, [eax+esi]
		jmp	@__security_check_cookie@4 ; __security_check_cookie(x)
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10014D30(int,	PVOID TargetFrame, int)
sub_10014D30	proc near		; DATA XREF: __SEH_prolog4o
					; __SEH_prolog4_GSo ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8
TargetFrame	= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		mov	ebx, [ebp+TargetFrame]
		push	esi
		mov	esi, [ebx+8]
		xor	esi, ___security_cookie
		push	edi
		mov	eax, [esi]
		mov	[ebp+var_1], 0
		mov	[ebp+var_C], 1
		lea	edi, [ebx+10h]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10014D69
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)

loc_10014D69:				; CODE XREF: sub_10014D30+2Aj
		mov	ecx, [esi+0Ch]
		mov	eax, [esi+8]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	eax, [ebp+arg_0]
		test	byte ptr [eax+4], 66h
		jnz	loc_10014E9C
		mov	ecx, [ebp+arg_8]
		lea	edx, [ebp+var_18]
		mov	[ebx-4], edx
		mov	ebx, [ebx+0Ch]
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], ecx
		cmp	ebx, 0FFFFFFFEh
		jz	short loc_10014DFC
		lea	ecx, [ecx+0]

loc_10014DA0:				; CODE XREF: sub_10014D30+A0j
		lea	eax, [ebx+ebx*2]
		mov	ecx, [esi+eax*4+14h]
		lea	eax, [esi+eax*4+10h]
		mov	[ebp+var_10], eax
		mov	eax, [eax]
		mov	[ebp+var_8], eax
		test	ecx, ecx
		jz	short loc_10014DCB
		mov	edx, edi
		call	sub_10018122
		mov	[ebp+var_1], 1
		test	eax, eax
		jl	short loc_10014E06
		jg	short loc_10014E0F
		mov	eax, [ebp+var_8]

loc_10014DCB:				; CODE XREF: sub_10014D30+85j
		mov	ebx, eax
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10014DA0
		cmp	[ebp+var_1], 0
		jz	short loc_10014DFC

loc_10014DD8:				; CODE XREF: sub_10014D30+DDj
					; sub_10014D30+187j
		mov	eax, [esi]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10014DEC
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)

loc_10014DEC:				; CODE XREF: sub_10014D30+ADj
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)

loc_10014DFC:				; CODE XREF: sub_10014D30+6Bj
					; sub_10014D30+A6j ...
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10014E06:				; CODE XREF: sub_10014D30+94j
		mov	[ebp+var_C], 0
		jmp	short loc_10014DD8
; ---------------------------------------------------------------------------

loc_10014E0F:				; CODE XREF: sub_10014D30+96j
		mov	ecx, [ebp+arg_0]
		cmp	dword ptr [ecx], 0E06D7363h
		jnz	short loc_10014E43
		cmp	dword_1002F1C0,	0
		jz	short loc_10014E43
		push	offset dword_1002F1C0
		call	sub_1001D634
		add	esp, 4
		test	eax, eax
		jz	short loc_10014E43
		mov	edx, [ebp+arg_0]
		push	1
		push	edx
		call	dword_1002F1C0
		add	esp, 8

loc_10014E43:				; CODE XREF: sub_10014D30+E8j
					; sub_10014D30+F1j ...
		mov	ecx, [ebp+TargetFrame] ; TargetFrame
		call	sub_10018152
		mov	eax, [ebp+TargetFrame]
		cmp	[eax+0Ch], ebx
		jz	short loc_10014E65
		push	offset ___security_cookie
		push	edi
		mov	edx, ebx
		mov	ecx, eax
		call	sub_1001816C
		mov	eax, [ebp+TargetFrame]

loc_10014E65:				; CODE XREF: sub_10014D30+121j
		mov	ecx, [ebp+var_8]
		mov	[eax+0Ch], ecx
		mov	eax, [esi]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10014E7F
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)

loc_10014E7F:				; CODE XREF: sub_10014D30+140j
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+8]
		mov	edx, edi
		call	sub_10018139

loc_10014E9C:				; CODE XREF: sub_10014D30+50j
		mov	edx, 0FFFFFFFEh
		cmp	[ebx+0Ch], edx
		jz	loc_10014DFC
		push	offset ___security_cookie
		push	edi
		mov	ecx, ebx
		call	sub_1001816C
		jmp	loc_10014DD8
sub_10014D30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014EBC	proc near		; CODE XREF: sub_10014F46+13p
					; sub_10014F63+13p ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	10h
		push	offset stru_1002B5B8
		call	__SEH_prolog4
		mov	esi, offset dword_1002D2F8
		mov	[ebp+var_1C], esi
		xor	eax, eax
		xor	edi, edi
		cmp	[ebp+arg_4], edi
		setnz	al
		cmp	eax, edi
		jnz	short loc_10014EFB
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_10014F36
; ---------------------------------------------------------------------------

loc_10014EFB:				; CODE XREF: sub_10014EBC+20j
		push	esi
		call	sub_10010C50
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		push	esi
		call	sub_10013CD1
		mov	edi, eax
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	esi
		call	[ebp+arg_0]
		mov	[ebp+var_20], eax
		push	esi
		push	edi
		call	sub_10013D65
		add	esp, 1Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10014F3C	; Finally handler 0 for	function 10014EBC
; ---------------------------------------------------------------------------

loc_10014F33:				; CODE XREF: sub_10014EBC+89j
		mov	eax, [ebp+var_20]

loc_10014F36:				; CODE XREF: sub_10014EBC+3Dj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10014F3C:				; CODE XREF: sub_10014EBC+72j
					; DATA XREF: .rdata:stru_1002B5B8o
		push	[ebp+var_1C]	; Finally handler 0 for	function 10014EBC
		call	sub_10010CAD
		pop	ecx
		retn
sub_10014EBC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014F46	proc near		; CODE XREF: .text:1000EE07p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	offset sub_10013E79
		call	sub_10014EBC
		add	esp, 10h
		pop	ebp
		retn
sub_10014F46	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014F63	proc near		; CODE XREF: .text:1000EE20p
					; .text:1000EE38p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	offset sub_1001D746
		call	sub_10014EBC
		add	esp, 10h
		pop	ebp
		retn
sub_10014F63	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014F80	proc near		; CODE XREF: .text:1000EE51p
					; .text:1000EE69p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	offset sub_1001E5A0
		call	sub_10014EBC
		add	esp, 10h
		pop	ebp
		retn
sub_10014F80	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	0
		push	dword ptr [ebp+8]
		push	offset sub_10013E79
		call	sub_10014EBC
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	0
		push	dword ptr [ebp+8]
		push	offset sub_1001D746
		call	sub_10014EBC
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	0
		push	dword ptr [ebp+8]
		push	offset sub_1001E5A0
		call	sub_10014EBC
		add	esp, 10h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014FF1	proc near		; CODE XREF: sub_1001504E:loc_10015076p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		lea	eax, [ebp+var_4]
		xor	esi, esi
		push	eax
		mov	[ebp+var_4], esi
		mov	[ebp+var_8], esi
		call	sub_1001653D
		pop	ecx
		test	eax, eax
		jz	short loc_1001501C
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014AB5
		add	esp, 14h

loc_1001501C:				; CODE XREF: sub_10014FF1+1Cj
		lea	eax, [ebp+var_8]
		push	eax
		call	sub_100165BA
		pop	ecx
		test	eax, eax
		jz	short loc_10015037
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014AB5
		add	esp, 14h

loc_10015037:				; CODE XREF: sub_10014FF1+37j
		cmp	[ebp+var_4], 2
		pop	esi
		jnz	short loc_10015049
		cmp	[ebp+var_8], 5
		jb	short loc_10015049
		xor	eax, eax
		inc	eax
		leave
		retn
; ---------------------------------------------------------------------------

loc_10015049:				; CODE XREF: sub_10014FF1+4Bj
					; sub_10014FF1+51j
		push	3
		pop	eax
		leave
		retn
sub_10014FF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001504E	proc near		; CODE XREF: sub_10011438+92p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		cmp	[ebp+arg_0], eax
		push	0		; dwMaximumSize
		setz	al
		push	1000h		; dwInitialSize
		push	eax		; flOptions
		call	ds:HeapCreate
		mov	hHeap, eax
		test	eax, eax
		jnz	short loc_10015076

loc_10015072:				; CODE XREF: sub_1001504E+59j
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10015076:				; CODE XREF: sub_1001504E+22j
		call	sub_10014FF1
		mov	dword_1002F1BC,	eax
		cmp	eax, 3
		jnz	short loc_100150A9
		push	3F8h
		call	sub_100153A7
		pop	ecx
		test	eax, eax
		jnz	short loc_100150A9
		push	hHeap		; hHeap
		call	ds:HeapDestroy
		and	hHeap, 0
		jmp	short loc_10015072
; ---------------------------------------------------------------------------

loc_100150A9:				; CODE XREF: sub_1001504E+35j
					; sub_1001504E+44j
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
sub_1001504E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100150AE	proc near		; CODE XREF: sub_10011438:loc_100114DDp
					; sub_10011438+135p
		cmp	dword_1002F1BC,	3
		jnz	short loc_1001510E
		push	ebx
		xor	ebx, ebx
		cmp	dword_1002F1A4,	ebx
		push	edi
		mov	edi, ds:HeapFree
		jle	short loc_100150FC
		push	esi
		mov	esi, lpMem
		add	esi, 10h

loc_100150D3:				; CODE XREF: sub_100150AE+4Bj
		push	8000h		; dwFreeType
		push	0		; dwSize
		push	dword ptr [esi-4] ; lpAddress
		call	ds:VirtualFree
		push	dword ptr [esi]	; lpMem
		push	0		; dwFlags
		push	hHeap		; hHeap
		call	edi ; HeapFree
		add	esi, 14h
		inc	ebx
		cmp	ebx, dword_1002F1A4
		jl	short loc_100150D3
		pop	esi

loc_100150FC:				; CODE XREF: sub_100150AE+19j
		push	lpMem		; lpMem
		push	0		; dwFlags
		push	hHeap		; hHeap
		call	edi ; HeapFree
		pop	edi
		pop	ebx

loc_1001510E:				; CODE XREF: sub_100150AE+7j
		push	hHeap		; hHeap
		call	ds:HeapDestroy
		and	hHeap, 0
		retn
sub_100150AE	endp

; ---------------------------------------------------------------------------
		mov	eax, hHeap
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10015128	proc near		; CODE XREF: sub_10013A07+101p
		mov	edi, edi
		push	esi
		push	edi
		xor	esi, esi
		mov	edi, offset dword_1002E660

loc_10015133:				; CODE XREF: sub_10015128+3Dj
		cmp	dword_1002DD04[esi*8], 1
		jnz	short loc_10015161
		lea	eax, lpCriticalSection[esi*8]
		push	4000000h
		mov	[eax], edi
		push	0FA0h
		push	dword ptr [eax]
		add	edi, 18h
		call	sub_1001F9FC
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001516D

loc_10015161:				; CODE XREF: sub_10015128+13j
		inc	esi
		cmp	esi, 24h
		jl	short loc_10015133
		xor	eax, eax
		inc	eax

loc_1001516A:				; CODE XREF: sub_10015128+4Fj
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001516D:				; CODE XREF: sub_10015128+37j
		and	lpCriticalSection[esi*8], 0
		xor	eax, eax
		jmp	short loc_1001516A
sub_10015128	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_100136A7

loc_10015179:				; CODE XREF: sub_100136A7:loc_100136DFj
		mov	edi, edi
		push	ebx
		mov	ebx, ds:DeleteCriticalSection
		push	esi
		mov	esi, offset lpCriticalSection
		push	edi

loc_10015189:				; CODE XREF: sub_100136A7+1B04j
		mov	edi, [esi]
		test	edi, edi
		jz	short loc_100151A2
		cmp	dword ptr [esi+4], 1
		jz	short loc_100151A2
		push	edi		; lpCriticalSection
		call	ebx ; DeleteCriticalSection
		push	edi		; lpMem
		call	sub_1000EE73
		and	dword ptr [esi], 0
		pop	ecx

loc_100151A2:				; CODE XREF: sub_100136A7+1AE6j
					; sub_100136A7+1AECj
		add	esi, 8
		cmp	esi, offset off_1002DE20
		jl	short loc_10015189
		mov	esi, offset lpCriticalSection
		pop	edi

loc_100151B3:				; CODE XREF: sub_100136A7+1B24j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_100151C2
		cmp	dword ptr [esi+4], 1
		jnz	short loc_100151C2
		push	eax		; lpCriticalSection
		call	ebx ; DeleteCriticalSection

loc_100151C2:				; CODE XREF: sub_100136A7+1B10j
					; sub_100136A7+1B16j
		add	esi, 8
		cmp	esi, offset off_1002DE20
		jl	short loc_100151B3
		pop	esi
		pop	ebx
		retn
; END OF FUNCTION CHUNK	FOR sub_100136A7

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100151D0	proc near		; CODE XREF: sub_1000EE73+58p
					; sub_1000F114+146p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	lpCriticalSection[eax*8] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	ebp
		retn
sub_100151D0	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+8]
		push	0
		call	ds:FatalAppExitA
; ---------------------------------------------------------------------------
		push	0FFh
		call	sub_100164F6
; ---------------------------------------------------------------------------
		db  59h	; Y
		db  5Dh	; ]
		db 0C3h	; 

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015204	proc near		; CODE XREF: sub_100152C7+16p
					; sub_10017F09+4Fp ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002B5D8
		call	__SEH_prolog4
		xor	edi, edi
		inc	edi
		mov	[ebp+var_1C], edi
		xor	ebx, ebx
		cmp	hHeap, ebx
		jnz	short loc_10015238
		call	sub_10016988
		push	1Eh
		call	sub_100167DD
		push	0FFh		; uExitCode
		call	sub_100164F6
; ---------------------------------------------------------------------------
		db  59h	; Y
		db  59h	; Y
; ---------------------------------------------------------------------------

loc_10015238:				; CODE XREF: sub_10015204+1Aj
		mov	esi, [ebp+arg_0]
		lea	esi, lpCriticalSection[esi*8]
		cmp	[esi], ebx
		jz	short loc_1001524A
		mov	eax, edi
		jmp	short loc_100152B8
; ---------------------------------------------------------------------------

loc_1001524A:				; CODE XREF: sub_10015204+40j
		push	18h
		call	sub_1000F5A0
		pop	ecx
		mov	edi, eax
		cmp	edi, ebx
		jnz	short loc_10015267
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		xor	eax, eax
		jmp	short loc_100152B8
; ---------------------------------------------------------------------------

loc_10015267:				; CODE XREF: sub_10015204+52j
		push	0Ah
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		cmp	[esi], ebx
		jnz	short loc_100152A2
		push	0FA0h
		push	edi
		call	sub_1001F928
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001529E
		push	edi		; lpMem
		call	sub_1000EE73
		pop	ecx
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		mov	[ebp+var_1C], ebx
		jmp	short loc_100152A9
; ---------------------------------------------------------------------------

loc_1001529E:				; CODE XREF: sub_10015204+81j
		mov	[esi], edi
		jmp	short loc_100152A9
; ---------------------------------------------------------------------------

loc_100152A2:				; CODE XREF: sub_10015204+70j
		push	edi		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_100152A9:				; CODE XREF: sub_10015204+98j
					; sub_10015204+9Cj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_100152BE	; Finally handler 0 for	function 10015204
; ---------------------------------------------------------------------------

loc_100152B5:				; CODE XREF: sub_10015204+C2j
		mov	eax, [ebp+var_1C]

loc_100152B8:				; CODE XREF: sub_10015204+44j
					; sub_10015204+61j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_100152BE:				; CODE XREF: sub_10015204+ACj
					; DATA XREF: .rdata:stru_1002B5D8o
		push	0Ah		; Finally handler 0 for	function 10015204
		call	sub_100151D0
		pop	ecx
		retn
sub_10015204	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100152C7	proc near		; CODE XREF: sub_1000EE73+1Ep
					; sub_1000F114+51p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	esi
		lea	esi, lpCriticalSection[eax*8]
		cmp	dword ptr [esi], 0
		jnz	short loc_100152EF
		push	eax
		call	sub_10015204
		pop	ecx
		test	eax, eax
		jnz	short loc_100152EF
		push	11h
		call	sub_100164A2
		pop	ecx

loc_100152EF:				; CODE XREF: sub_100152C7+13j
					; sub_100152C7+1Ej
		push	dword ptr [esi]	; lpCriticalSection
		call	ds:EnterCriticalSection
		pop	esi
		pop	ebp
		retn
sub_100152C7	endp

; ---------------------------------------------------------------------------
		cmp	hHeap, 0
		jnz	short loc_10015306
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10015306:				; CODE XREF: .text:10015301j
		mov	eax, dword_1002F1BC
		sub	eax, 3
		neg	eax
		sbb	eax, eax
		not	eax
		and	eax, dword_1002F1AC
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		lea	ecx, [eax-1]
		push	esi
		cmp	ecx, 0FFFFFFFEh
		ja	short loc_10015346
		xor	esi, esi
		cmp	hHeap, esi
		jnz	short loc_1001533D
		call	sub_10014BF2
		jmp	short loc_1001534D
; ---------------------------------------------------------------------------

loc_1001533D:				; CODE XREF: .text:10015334j
		mov	dword_1002DCF8,	eax
		xor	eax, eax
		jmp	short loc_10015363
; ---------------------------------------------------------------------------

loc_10015346:				; CODE XREF: .text:1001532Aj
		call	sub_10014BF2
		xor	esi, esi

loc_1001534D:				; CODE XREF: .text:1001533Bj
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax

loc_10015363:				; CODE XREF: .text:10015344j
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jnz	short loc_10015392

loc_10015375:				; CODE XREF: .text:10015398j
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_100153A4
; ---------------------------------------------------------------------------

loc_10015392:				; CODE XREF: .text:10015373j
		cmp	hHeap, esi
		jz	short loc_10015375
		mov	ecx, dword_1002DCF8
		mov	[eax], ecx
		xor	eax, eax

loc_100153A4:				; CODE XREF: .text:10015390j
		pop	esi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100153A7	proc near		; CODE XREF: sub_1001504E+3Cp
					; .text:10015FEAp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	140h		; dwBytes
		push	0		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapAlloc
		mov	lpMem, eax
		test	eax, eax
		jnz	short loc_100153CA
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100153CA:				; CODE XREF: sub_100153A7+1Fj
		mov	ecx, [ebp+arg_0]
		and	dword_1002E7B0,	0
		and	dword_1002F1A4,	0
		mov	dword_1002F1B0,	eax
		xor	eax, eax
		mov	dword_1002F1AC,	ecx
		mov	dword_1002F1B4,	10h
		inc	eax
		pop	ebp
		retn
sub_100153A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100153F5	proc near		; CODE XREF: sub_1000EE73+29p
					; sub_1000F114+5Bp ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, dword_1002F1A4
		mov	eax, lpMem
		imul	ecx, 14h
		add	ecx, eax
		jmp	short loc_1001541D
; ---------------------------------------------------------------------------

loc_1001540C:				; CODE XREF: sub_100153F5+2Aj
		mov	edx, [ebp+arg_0]
		sub	edx, [eax+0Ch]
		cmp	edx, 100000h
		jb	short loc_10015423
		add	eax, 14h

loc_1001541D:				; CODE XREF: sub_100153F5+15j
		cmp	eax, ecx
		jb	short loc_1001540C
		xor	eax, eax

loc_10015423:				; CODE XREF: sub_100153F5+23j
		pop	ebp
		retn
sub_100153F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015425	proc near		; CODE XREF: sub_1000EE73+38p
					; sub_1000F114+B5p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	ecx, [ebp+arg_0]
		mov	eax, [ecx+10h]
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, esi
		sub	edi, [ecx+0Ch]
		add	esi, 0FFFFFFFCh
		shr	edi, 0Fh
		mov	ecx, edi
		imul	ecx, 204h
		lea	ecx, [ecx+eax+144h]
		mov	[ebp+var_10], ecx
		mov	ecx, [esi]
		dec	ecx
		mov	[ebp+var_4], ecx
		test	cl, 1
		jnz	loc_10015737
		push	ebx
		lea	ebx, [ecx+esi]
		mov	edx, [ebx]
		mov	[ebp+var_C], edx
		mov	edx, [esi-4]
		mov	[ebp+var_8], edx
		mov	edx, [ebp+var_C]
		mov	[ebp+arg_4], ebx
		test	dl, 1
		jnz	short loc_100154F2
		sar	edx, 4
		dec	edx
		cmp	edx, 3Fh
		jbe	short loc_1001548A
		push	3Fh
		pop	edx

loc_1001548A:				; CODE XREF: sub_10015425+60j
		mov	ecx, [ebx+4]
		cmp	ecx, [ebx+8]
		jnz	short loc_100154D4
		mov	ebx, 80000000h
		cmp	edx, 20h
		jnb	short loc_100154B5
		mov	ecx, edx
		shr	ebx, cl
		lea	ecx, [edx+eax+4]
		not	ebx
		and	[eax+edi*4+44h], ebx
		dec	byte ptr [ecx]
		jnz	short loc_100154D1
		mov	ecx, [ebp+arg_0]
		and	[ecx], ebx
		jmp	short loc_100154D1
; ---------------------------------------------------------------------------

loc_100154B5:				; CODE XREF: sub_10015425+75j
		lea	ecx, [edx-20h]
		shr	ebx, cl
		lea	ecx, [edx+eax+4]
		not	ebx
		and	[eax+edi*4+0C4h], ebx
		dec	byte ptr [ecx]
		jnz	short loc_100154D1
		mov	ecx, [ebp+arg_0]
		and	[ecx+4], ebx

loc_100154D1:				; CODE XREF: sub_10015425+87j
					; sub_10015425+8Ej ...
		mov	ebx, [ebp+arg_4]

loc_100154D4:				; CODE XREF: sub_10015425+6Bj
		mov	edx, [ebx+8]
		mov	ebx, [ebx+4]
		mov	ecx, [ebp+var_4]
		add	ecx, [ebp+var_C]
		mov	[edx+4], ebx
		mov	edx, [ebp+arg_4]
		mov	ebx, [edx+4]
		mov	edx, [edx+8]
		mov	[ebx+8], edx
		mov	[ebp+var_4], ecx

loc_100154F2:				; CODE XREF: sub_10015425+57j
		mov	edx, ecx
		sar	edx, 4
		dec	edx
		cmp	edx, 3Fh
		jbe	short loc_10015500
		push	3Fh
		pop	edx

loc_10015500:				; CODE XREF: sub_10015425+D6j
		mov	ebx, [ebp+var_8]
		and	ebx, 1
		mov	[ebp+var_C], ebx
		jnz	loc_1001559E
		sub	esi, [ebp+var_8]
		mov	ebx, [ebp+var_8]
		sar	ebx, 4
		push	3Fh
		mov	[ebp+arg_4], esi
		dec	ebx
		pop	esi
		cmp	ebx, esi
		jbe	short loc_10015525
		mov	ebx, esi

loc_10015525:				; CODE XREF: sub_10015425+FCj
		add	ecx, [ebp+var_8]
		mov	edx, ecx
		sar	edx, 4
		dec	edx
		mov	[ebp+var_4], ecx
		cmp	edx, esi
		jbe	short loc_10015537
		mov	edx, esi

loc_10015537:				; CODE XREF: sub_10015425+10Ej
		cmp	ebx, edx
		jz	short loc_10015599
		mov	ecx, [ebp+arg_4]
		mov	esi, [ecx+4]
		cmp	esi, [ecx+8]
		jnz	short loc_10015581
		mov	esi, 80000000h
		cmp	ebx, 20h
		jnb	short loc_10015567
		mov	ecx, ebx
		shr	esi, cl
		not	esi
		and	[eax+edi*4+44h], esi
		dec	byte ptr [ebx+eax+4]
		jnz	short loc_10015581
		mov	ecx, [ebp+arg_0]
		and	[ecx], esi
		jmp	short loc_10015581
; ---------------------------------------------------------------------------

loc_10015567:				; CODE XREF: sub_10015425+129j
		lea	ecx, [ebx-20h]
		shr	esi, cl
		not	esi
		and	[eax+edi*4+0C4h], esi
		dec	byte ptr [ebx+eax+4]
		jnz	short loc_10015581
		mov	ecx, [ebp+arg_0]
		and	[ecx+4], esi

loc_10015581:				; CODE XREF: sub_10015425+11Fj
					; sub_10015425+139j ...
		mov	ecx, [ebp+arg_4]
		mov	esi, [ecx+8]
		mov	ecx, [ecx+4]
		mov	[esi+4], ecx
		mov	ecx, [ebp+arg_4]
		mov	esi, [ecx+4]
		mov	ecx, [ecx+8]
		mov	[esi+8], ecx

loc_10015599:				; CODE XREF: sub_10015425+114j
		mov	esi, [ebp+arg_4]
		jmp	short loc_100155A1
; ---------------------------------------------------------------------------

loc_1001559E:				; CODE XREF: sub_10015425+E4j
		mov	ebx, [ebp+arg_0]

loc_100155A1:				; CODE XREF: sub_10015425+177j
		cmp	[ebp+var_C], 0
		jnz	short loc_100155AF
		cmp	ebx, edx
		jz	loc_1001562F

loc_100155AF:				; CODE XREF: sub_10015425+180j
		mov	ecx, [ebp+var_10]
		lea	ecx, [ecx+edx*8]
		mov	ebx, [ecx+4]
		mov	[esi+8], ecx
		mov	[esi+4], ebx
		mov	[ecx+4], esi
		mov	ecx, [esi+4]
		mov	[ecx+8], esi
		mov	ecx, [esi+4]
		cmp	ecx, [esi+8]
		jnz	short loc_1001562F
		mov	cl, [edx+eax+4]
		mov	byte ptr [ebp+arg_4+3],	cl
		inc	cl
		mov	[edx+eax+4], cl
		cmp	edx, 20h
		jnb	short loc_10015606
		cmp	byte ptr [ebp+arg_4+3],	0
		jnz	short loc_100155F5
		mov	ecx, edx
		mov	ebx, 80000000h
		shr	ebx, cl
		mov	ecx, [ebp+arg_0]
		or	[ecx], ebx

loc_100155F5:				; CODE XREF: sub_10015425+1C0j
		mov	ebx, 80000000h
		mov	ecx, edx
		shr	ebx, cl
		lea	eax, [eax+edi*4+44h]
		or	[eax], ebx
		jmp	short loc_1001562F
; ---------------------------------------------------------------------------

loc_10015606:				; CODE XREF: sub_10015425+1BAj
		cmp	byte ptr [ebp+arg_4+3],	0
		jnz	short loc_1001561C
		lea	ecx, [edx-20h]
		mov	ebx, 80000000h
		shr	ebx, cl
		mov	ecx, [ebp+arg_0]
		or	[ecx+4], ebx

loc_1001561C:				; CODE XREF: sub_10015425+1E5j
		lea	ecx, [edx-20h]
		mov	edx, 80000000h
		shr	edx, cl
		lea	eax, [eax+edi*4+0C4h]
		or	[eax], edx

loc_1001562F:				; CODE XREF: sub_10015425+184j
					; sub_10015425+1A8j ...
		mov	eax, [ebp+var_4]
		mov	[esi], eax
		mov	[eax+esi-4], eax
		mov	eax, [ebp+var_10]
		dec	dword ptr [eax]
		jnz	loc_10015736
		mov	eax, dword_1002E7B0
		test	eax, eax
		jz	loc_10015728
		mov	ecx, dword_1002F1B8
		mov	esi, ds:VirtualFree
		push	4000h		; dwFreeType
		shl	ecx, 0Fh
		add	ecx, [eax+0Ch]
		mov	ebx, 8000h
		push	ebx		; dwSize
		push	ecx		; lpAddress
		call	esi ; VirtualFree
		mov	ecx, dword_1002F1B8
		mov	eax, dword_1002E7B0
		mov	edx, 80000000h
		shr	edx, cl
		or	[eax+8], edx
		mov	eax, dword_1002E7B0
		mov	eax, [eax+10h]
		mov	ecx, dword_1002F1B8
		and	dword ptr [eax+ecx*4+0C4h], 0
		mov	eax, dword_1002E7B0
		mov	eax, [eax+10h]
		dec	byte ptr [eax+43h]
		mov	eax, dword_1002E7B0
		mov	ecx, [eax+10h]
		cmp	byte ptr [ecx+43h], 0
		jnz	short loc_100156BD
		and	dword ptr [eax+4], 0FFFFFFFEh
		mov	eax, dword_1002E7B0

loc_100156BD:				; CODE XREF: sub_10015425+28Dj
		cmp	dword ptr [eax+8], 0FFFFFFFFh
		jnz	short loc_10015728
		push	ebx		; dwFreeType
		push	0		; dwSize
		push	dword ptr [eax+0Ch] ; lpAddress
		call	esi ; VirtualFree
		mov	eax, dword_1002E7B0
		push	dword ptr [eax+10h] ; lpMem
		push	0		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapFree
		mov	ecx, dword_1002F1A4
		mov	eax, dword_1002E7B0
		imul	ecx, 14h
		mov	edx, lpMem
		sub	ecx, eax
		lea	ecx, [ecx+edx-14h]
		push	ecx
		lea	ecx, [eax+14h]
		push	ecx
		push	eax
		call	sub_1001FA10
		mov	eax, [ebp+arg_0]
		add	esp, 0Ch
		dec	dword_1002F1A4
		cmp	eax, dword_1002E7B0
		jbe	short loc_1001571E
		sub	[ebp+arg_0], 14h

loc_1001571E:				; CODE XREF: sub_10015425+2F3j
		mov	eax, lpMem
		mov	dword_1002F1B0,	eax

loc_10015728:				; CODE XREF: sub_10015425+225j
					; sub_10015425+29Cj
		mov	eax, [ebp+arg_0]
		mov	dword_1002E7B0,	eax
		mov	dword_1002F1B8,	edi

loc_10015736:				; CODE XREF: sub_10015425+218j
		pop	ebx

loc_10015737:				; CODE XREF: sub_10015425+39j
		pop	edi
		pop	esi
		leave
		retn
sub_10015425	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001573B	proc near		; CODE XREF: sub_10016034+C2p
		mov	eax, dword_1002F1B4
		push	esi
		mov	esi, dword_1002F1A4
		push	edi
		xor	edi, edi
		cmp	esi, eax
		jnz	short loc_10015782
		add	eax, 10h
		imul	eax, 14h
		push	eax		; dwBytes
		push	lpMem		; lpMem
		push	edi		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapReAlloc
		cmp	eax, edi
		jnz	short loc_10015770

loc_1001576C:				; CODE XREF: sub_1001573B+68j
					; sub_1001573B+94j
		xor	eax, eax
		jmp	short loc_100157E8
; ---------------------------------------------------------------------------

loc_10015770:				; CODE XREF: sub_1001573B+2Fj
		add	dword_1002F1B4,	10h
		mov	esi, dword_1002F1A4
		mov	lpMem, eax

loc_10015782:				; CODE XREF: sub_1001573B+11j
		imul	esi, 14h
		add	esi, lpMem
		push	41C4h		; dwBytes
		push	8		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapAlloc
		mov	[esi+10h], eax
		cmp	eax, edi
		jz	short loc_1001576C
		push	4		; flProtect
		push	2000h		; flAllocationType
		push	100000h		; dwSize
		push	edi		; lpAddress
		call	ds:VirtualAlloc
		mov	[esi+0Ch], eax
		cmp	eax, edi
		jnz	short loc_100157D1
		push	dword ptr [esi+10h] ; lpMem
		push	edi		; dwFlags
		push	hHeap		; hHeap
		call	ds:HeapFree
		jmp	short loc_1001576C
; ---------------------------------------------------------------------------

loc_100157D1:				; CODE XREF: sub_1001573B+82j
		or	dword ptr [esi+8], 0FFFFFFFFh
		mov	[esi], edi
		mov	[esi+4], edi
		inc	dword_1002F1A4
		mov	eax, [esi+10h]
		or	dword ptr [eax], 0FFFFFFFFh
		mov	eax, esi

loc_100157E8:				; CODE XREF: sub_1001573B+33j
		pop	edi
		pop	esi
		retn
sub_1001573B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100157EB	proc near		; CODE XREF: sub_10016034+D8p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	ecx, [ebp+arg_0]
		mov	eax, [ecx+8]
		push	ebx
		push	esi
		mov	esi, [ecx+10h]
		push	edi
		xor	ebx, ebx
		jmp	short loc_10015805
; ---------------------------------------------------------------------------

loc_10015802:				; CODE XREF: sub_100157EB+1Cj
		add	eax, eax
		inc	ebx

loc_10015805:				; CODE XREF: sub_100157EB+15j
		test	eax, eax
		jge	short loc_10015802
		mov	eax, ebx
		imul	eax, 204h
		lea	eax, [eax+esi+144h]
		push	3Fh
		mov	[ebp+var_8], eax
		pop	edx

loc_1001581E:				; CODE XREF: sub_100157EB+3Dj
		mov	[eax+8], eax
		mov	[eax+4], eax
		add	eax, 8
		dec	edx
		jnz	short loc_1001581E
		push	4		; flProtect
		mov	edi, ebx
		push	1000h		; flAllocationType
		shl	edi, 0Fh
		add	edi, [ecx+0Ch]
		push	8000h		; dwSize
		push	edi		; lpAddress
		call	ds:VirtualAlloc
		test	eax, eax
		jnz	short loc_10015851
		or	eax, 0FFFFFFFFh
		jmp	loc_100158EE
; ---------------------------------------------------------------------------

loc_10015851:				; CODE XREF: sub_100157EB+5Cj
		lea	edx, [edi+7000h]
		mov	[ebp+var_4], edx
		cmp	edi, edx
		ja	short loc_100158A1
		mov	ecx, edx
		sub	ecx, edi
		shr	ecx, 0Ch
		lea	eax, [edi+10h]
		inc	ecx

loc_10015869:				; CODE XREF: sub_100157EB+B1j
		or	dword ptr [eax-8], 0FFFFFFFFh
		or	dword ptr [eax+0FECh], 0FFFFFFFFh
		lea	edx, [eax+0FFCh]
		mov	[eax], edx
		lea	edx, [eax-1004h]
		mov	dword ptr [eax-4], 0FF0h
		mov	[eax+4], edx
		mov	dword ptr [eax+0FE8h], 0FF0h
		add	eax, 1000h
		dec	ecx
		jnz	short loc_10015869
		mov	edx, [ebp+var_4]

loc_100158A1:				; CODE XREF: sub_100157EB+71j
		mov	eax, [ebp+var_8]
		add	eax, 1F8h
		lea	ecx, [edi+0Ch]
		mov	[eax+4], ecx
		mov	[ecx+8], eax
		lea	ecx, [edx+0Ch]
		mov	[eax+8], ecx
		mov	[ecx+4], eax
		and	dword ptr [esi+ebx*4+44h], 0
		xor	edi, edi
		inc	edi
		mov	[esi+ebx*4+0C4h], edi
		mov	al, [esi+43h]
		mov	cl, al
		inc	cl
		test	al, al
		mov	eax, [ebp+arg_0]
		mov	[esi+43h], cl
		jnz	short loc_100158DE
		or	[eax+4], edi

loc_100158DE:				; CODE XREF: sub_100157EB+EEj
		mov	edx, 80000000h
		mov	ecx, ebx
		shr	edx, cl
		not	edx
		and	[eax+8], edx
		mov	eax, ebx

loc_100158EE:				; CODE XREF: sub_100157EB+61j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_100157EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100158F3	proc near		; CODE XREF: sub_1000F114+77p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	ecx, [ebp+arg_0]
		mov	eax, [ecx+10h]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		mov	edi, [ebp+arg_4]
		mov	edx, edi
		sub	edx, [ecx+0Ch]
		add	esi, 17h
		shr	edx, 0Fh
		mov	ecx, edx
		imul	ecx, 204h
		lea	ecx, [ecx+eax+144h]
		mov	[ebp+var_C], ecx
		mov	ecx, [edi-4]
		and	esi, 0FFFFFFF0h
		dec	ecx
		cmp	esi, ecx
		lea	edi, [ecx+edi-4]
		mov	ebx, [edi]
		mov	[ebp+arg_8], ecx
		mov	[ebp+var_4], ebx
		jle	loc_10015A97
		test	bl, 1
		jnz	loc_10015A90
		add	ebx, ecx
		cmp	esi, ebx
		jg	loc_10015A90
		mov	ecx, [ebp+var_4]
		sar	ecx, 4
		dec	ecx
		mov	[ebp+var_8], ecx
		cmp	ecx, 3Fh
		jbe	short loc_1001596A
		push	3Fh
		pop	ecx
		mov	[ebp+var_8], ecx

loc_1001596A:				; CODE XREF: sub_100158F3+6Fj
		mov	ebx, [edi+4]
		cmp	ebx, [edi+8]
		jnz	short loc_100159B5
		mov	ebx, 80000000h
		cmp	ecx, 20h
		jnb	short loc_10015996
		shr	ebx, cl
		mov	ecx, [ebp+var_8]
		lea	ecx, [ecx+eax+4]
		not	ebx
		and	[eax+edx*4+44h], ebx
		dec	byte ptr [ecx]
		jnz	short loc_100159B5
		mov	ecx, [ebp+arg_0]
		and	[ecx], ebx
		jmp	short loc_100159B5
; ---------------------------------------------------------------------------

loc_10015996:				; CODE XREF: sub_100158F3+87j
		add	ecx, 0FFFFFFE0h
		shr	ebx, cl
		mov	ecx, [ebp+var_8]
		lea	ecx, [ecx+eax+4]
		not	ebx
		and	[eax+edx*4+0C4h], ebx
		dec	byte ptr [ecx]
		jnz	short loc_100159B5
		mov	ecx, [ebp+arg_0]
		and	[ecx+4], ebx

loc_100159B5:				; CODE XREF: sub_100158F3+7Dj
					; sub_100158F3+9Aj ...
		mov	ecx, [edi+8]
		mov	ebx, [edi+4]
		mov	[ecx+4], ebx
		mov	ecx, [edi+4]
		mov	edi, [edi+8]
		mov	[ecx+8], edi
		mov	ecx, [ebp+arg_8]
		sub	ecx, esi
		add	[ebp+var_4], ecx
		cmp	[ebp+var_4], 0
		jle	loc_10015A7E
		mov	edi, [ebp+var_4]
		mov	ecx, [ebp+arg_4]
		sar	edi, 4
		dec	edi
		lea	ecx, [ecx+esi-4]
		cmp	edi, 3Fh
		jbe	short loc_100159EF
		push	3Fh
		pop	edi

loc_100159EF:				; CODE XREF: sub_100158F3+F7j
		mov	ebx, [ebp+var_C]
		lea	ebx, [ebx+edi*8]
		mov	[ebp+arg_8], ebx
		mov	ebx, [ebx+4]
		mov	[ecx+4], ebx
		mov	ebx, [ebp+arg_8]
		mov	[ecx+8], ebx
		mov	[ebx+4], ecx
		mov	ebx, [ecx+4]
		mov	[ebx+8], ecx
		mov	ebx, [ecx+4]
		cmp	ebx, [ecx+8]
		jnz	short loc_10015A6C
		mov	cl, [edi+eax+4]
		mov	byte ptr [ebp+arg_8+3],	cl
		inc	cl
		mov	[edi+eax+4], cl
		cmp	edi, 20h
		jnb	short loc_10015A43
		cmp	byte ptr [ebp+arg_8+3],	0
		jnz	short loc_10015A3B
		mov	ecx, edi
		mov	ebx, 80000000h
		shr	ebx, cl
		mov	ecx, [ebp+arg_0]
		or	[ecx], ebx

loc_10015A3B:				; CODE XREF: sub_100158F3+138j
		lea	eax, [eax+edx*4+44h]
		mov	ecx, edi
		jmp	short loc_10015A63
; ---------------------------------------------------------------------------

loc_10015A43:				; CODE XREF: sub_100158F3+132j
		cmp	byte ptr [ebp+arg_8+3],	0
		jnz	short loc_10015A59
		lea	ecx, [edi-20h]
		mov	ebx, 80000000h
		shr	ebx, cl
		mov	ecx, [ebp+arg_0]
		or	[ecx+4], ebx

loc_10015A59:				; CODE XREF: sub_100158F3+154j
		lea	eax, [eax+edx*4+0C4h]
		lea	ecx, [edi-20h]

loc_10015A63:				; CODE XREF: sub_100158F3+14Ej
		mov	edx, 80000000h
		shr	edx, cl
		or	[eax], edx

loc_10015A6C:				; CODE XREF: sub_100158F3+120j
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+var_4]
		lea	eax, [edx+esi-4]
		mov	[eax], ecx
		mov	[ecx+eax-4], ecx
		jmp	short loc_10015A81
; ---------------------------------------------------------------------------

loc_10015A7E:				; CODE XREF: sub_100158F3+E0j
		mov	edx, [ebp+arg_4]

loc_10015A81:				; CODE XREF: sub_100158F3+189j
		lea	eax, [esi+1]
		mov	[edx-4], eax
		mov	[edx+esi-8], eax
		jmp	loc_10015BCC
; ---------------------------------------------------------------------------

loc_10015A90:				; CODE XREF: sub_100158F3+52j
					; sub_100158F3+5Cj
		xor	eax, eax
		jmp	loc_10015BCF
; ---------------------------------------------------------------------------

loc_10015A97:				; CODE XREF: sub_100158F3+49j
		jge	loc_10015BCC
		mov	ebx, [ebp+arg_4]
		sub	[ebp+arg_8], esi
		lea	ecx, [esi+1]
		mov	[ebx-4], ecx
		lea	ebx, [ebx+esi-4]
		mov	esi, [ebp+arg_8]
		sar	esi, 4
		dec	esi
		mov	[ebp+arg_4], ebx
		mov	[ebx-4], ecx
		cmp	esi, 3Fh
		jbe	short loc_10015AC2
		push	3Fh
		pop	esi

loc_10015AC2:				; CODE XREF: sub_100158F3+1CAj
		test	byte ptr [ebp+var_4], 1
		jnz	loc_10015B4C
		mov	esi, [ebp+var_4]
		sar	esi, 4
		dec	esi
		cmp	esi, 3Fh
		jbe	short loc_10015ADB
		push	3Fh
		pop	esi

loc_10015ADB:				; CODE XREF: sub_100158F3+1E3j
		mov	ecx, [edi+4]
		cmp	ecx, [edi+8]
		jnz	short loc_10015B25
		mov	ebx, 80000000h
		cmp	esi, 20h
		jnb	short loc_10015B06
		mov	ecx, esi
		shr	ebx, cl
		lea	esi, [esi+eax+4]
		not	ebx
		and	[eax+edx*4+44h], ebx
		dec	byte ptr [esi]
		jnz	short loc_10015B22
		mov	ecx, [ebp+arg_0]
		and	[ecx], ebx
		jmp	short loc_10015B22
; ---------------------------------------------------------------------------

loc_10015B06:				; CODE XREF: sub_100158F3+1F8j
		lea	ecx, [esi-20h]
		shr	ebx, cl
		lea	ecx, [esi+eax+4]
		not	ebx
		and	[eax+edx*4+0C4h], ebx
		dec	byte ptr [ecx]
		jnz	short loc_10015B22
		mov	ecx, [ebp+arg_0]
		and	[ecx+4], ebx

loc_10015B22:				; CODE XREF: sub_100158F3+20Aj
					; sub_100158F3+211j ...
		mov	ebx, [ebp+arg_4]

loc_10015B25:				; CODE XREF: sub_100158F3+1EEj
		mov	ecx, [edi+8]
		mov	esi, [edi+4]
		mov	[ecx+4], esi
		mov	esi, [edi+8]
		mov	ecx, [edi+4]
		mov	[ecx+8], esi
		mov	esi, [ebp+arg_8]
		add	esi, [ebp+var_4]
		mov	[ebp+arg_8], esi
		sar	esi, 4
		dec	esi
		cmp	esi, 3Fh
		jbe	short loc_10015B4C
		push	3Fh
		pop	esi

loc_10015B4C:				; CODE XREF: sub_100158F3+1D3j
					; sub_100158F3+254j
		mov	ecx, [ebp+var_C]
		lea	ecx, [ecx+esi*8]
		mov	edi, [ecx+4]
		mov	[ebx+8], ecx
		mov	[ebx+4], edi
		mov	[ecx+4], ebx
		mov	ecx, [ebx+4]
		mov	[ecx+8], ebx
		mov	ecx, [ebx+4]
		cmp	ecx, [ebx+8]
		jnz	short loc_10015BC3
		mov	cl, [esi+eax+4]
		mov	byte ptr [ebp+arg_4+3],	cl
		inc	cl
		mov	[esi+eax+4], cl
		cmp	esi, 20h
		jnb	short loc_10015B9A
		cmp	byte ptr [ebp+arg_4+3],	0
		jnz	short loc_10015B92
		mov	ecx, esi
		mov	edi, 80000000h
		shr	edi, cl
		mov	ecx, [ebp+arg_0]
		or	[ecx], edi

loc_10015B92:				; CODE XREF: sub_100158F3+28Fj
		lea	eax, [eax+edx*4+44h]
		mov	ecx, esi
		jmp	short loc_10015BBA
; ---------------------------------------------------------------------------

loc_10015B9A:				; CODE XREF: sub_100158F3+289j
		cmp	byte ptr [ebp+arg_4+3],	0
		jnz	short loc_10015BB0
		lea	ecx, [esi-20h]
		mov	edi, 80000000h
		shr	edi, cl
		mov	ecx, [ebp+arg_0]
		or	[ecx+4], edi

loc_10015BB0:				; CODE XREF: sub_100158F3+2ABj
		lea	eax, [eax+edx*4+0C4h]
		lea	ecx, [esi-20h]

loc_10015BBA:				; CODE XREF: sub_100158F3+2A5j
		mov	edx, 80000000h
		shr	edx, cl
		or	[eax], edx

loc_10015BC3:				; CODE XREF: sub_100158F3+277j
		mov	eax, [ebp+arg_8]
		mov	[ebx], eax
		mov	[eax+ebx-4], eax

loc_10015BCC:				; CODE XREF: sub_100158F3+198j
					; sub_100158F3:loc_10015A97j
		xor	eax, eax
		inc	eax

loc_10015BCF:				; CODE XREF: sub_100158F3+19Fj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_100158F3	endp

; ---------------------------------------------------------------------------
		mov	eax, dword_1002E7B0
		test	eax, eax
		jz	locret_10015CA0
		mov	ecx, dword_1002F1B8
		push	4000h
		shl	ecx, 0Fh
		add	ecx, [eax+0Ch]
		push	8000h
		push	ecx
		call	ds:VirtualFree
		mov	ecx, dword_1002F1B8
		mov	eax, dword_1002E7B0
		mov	edx, 80000000h
		shr	edx, cl
		or	[eax+8], edx
		mov	eax, dword_1002E7B0
		mov	eax, [eax+10h]
		mov	ecx, dword_1002F1B8
		and	dword ptr [eax+ecx*4+0C4h], 0
		mov	eax, dword_1002E7B0
		mov	eax, [eax+10h]
		dec	byte ptr [eax+43h]
		mov	eax, dword_1002E7B0
		mov	ecx, [eax+10h]
		cmp	byte ptr [ecx+43h], 0
		jnz	short loc_10015C4B
		and	dword ptr [eax+4], 0FFFFFFFEh
		mov	eax, dword_1002E7B0

loc_10015C4B:				; CODE XREF: .text:10015C40j
		cmp	dword ptr [eax+8], 0FFFFFFFFh
		jnz	short loc_10015C99
		cmp	dword_1002F1A4,	1
		jle	short loc_10015C99
		push	dword ptr [eax+10h]
		push	0
		push	hHeap
		call	ds:HeapFree
		mov	ecx, dword_1002F1A4
		mov	eax, dword_1002E7B0
		imul	ecx, 14h
		mov	edx, lpMem
		sub	ecx, eax
		lea	ecx, [ecx+edx-14h]
		push	ecx
		lea	ecx, [eax+14h]
		push	ecx
		push	eax
		call	sub_1001FA10
		add	esp, 0Ch
		dec	dword_1002F1A4

loc_10015C99:				; CODE XREF: .text:10015C4Fj
					; .text:10015C58j
		and	dword_1002E7B0,	0

locret_10015CA0:			; CODE XREF: .text:10015BDBj
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, lpMem
		sub	esp, 138h
		push	ebx
		xor	ebx, ebx
		cmp	eax, ebx
		jnz	short loc_10015CC0
		or	eax, 0FFFFFFFFh
		jmp	loc_10015F45
; ---------------------------------------------------------------------------

loc_10015CC0:				; CODE XREF: .text:10015CB6j
		cmp	dword_1002F1A4,	ebx
		push	esi
		mov	edx, eax
		push	edi
		mov	[ebp-34h], edx
		mov	[ebp-1Ch], ebx
		jle	loc_10015F41

loc_10015CD6:				; CODE XREF: .text:10015F3Bj
		mov	eax, [edx+10h]
		cmp	eax, ebx
		jz	loc_10015F48
		mov	ecx, [edx+0Ch]
		mov	[ebp-8], ecx
		lea	ecx, [eax+144h]
		mov	[ebp-24h], ecx
		mov	ecx, [edx+8]
		lea	esi, [eax+0C4h]
		mov	[ebp-20h], ecx
		mov	[ebp-10h], ebx
		mov	[ebp-14h], ebx
		mov	[ebp-0Ch], ebx
		mov	[ebp-38h], esi

loc_10015D08:				; CODE XREF: .text:10015F14j
		push	40h
		xor	eax, eax
		cmp	[ebp-20h], ebx
		pop	ecx
		lea	edi, [ebp-138h]
		mov	[ebp-28h], ebx
		mov	[ebp-18h], ebx
		mov	[ebp-4], ebx
		rep stosd
		jl	loc_10015EDF
		cmp	[ebp-8], ebx
		jz	loc_10015F4C
		mov	edx, [ebp-8]
		add	edx, 0FFCh

loc_10015D39:				; CODE XREF: .text:10015DC7j
		cmp	dword ptr [edx-0FF4h], 0FFFFFFFFh
		lea	esi, [edx-0FF0h]
		jnz	loc_10015F5C
		cmp	dword ptr [edx], 0FFFFFFFFh
		jnz	loc_10015F5C

loc_10015D55:				; CODE XREF: .text:10015DB5j
		mov	ecx, [esi]
		mov	edi, ecx
		test	cl, 1
		jz	short loc_10015D70
		dec	ecx
		cmp	ecx, 400h
		jg	loc_10015F50
		inc	dword ptr [ebp-4]
		jmp	short loc_10015D87
; ---------------------------------------------------------------------------

loc_10015D70:				; CODE XREF: .text:10015D5Cj
		mov	eax, ecx
		sar	eax, 4
		dec	eax
		cmp	eax, 3Fh
		jle	short loc_10015D7E
		push	3Fh
		pop	eax

loc_10015D7E:				; CODE XREF: .text:10015D79j
		lea	eax, [ebp+eax*4-138h]
		inc	dword ptr [eax]

loc_10015D87:				; CODE XREF: .text:10015D6Ej
		cmp	ecx, 10h
		jl	loc_10015F58
		test	cl, 0Fh
		jnz	loc_10015F58
		cmp	ecx, 0FF0h
		jg	loc_10015F58
		lea	eax, [ecx+esi]
		cmp	[eax-4], edi
		jnz	loc_10015F54
		mov	esi, eax
		cmp	esi, edx
		jb	short loc_10015D55
		jnz	loc_10015F54
		add	edx, 1000h
		inc	ebx
		cmp	ebx, 8
		jl	loc_10015D39
		mov	eax, [ebp-4]
		mov	edi, [ebp-24h]
		cmp	[edi], eax
		jnz	loc_10015F60
		xor	esi, esi

loc_10015DDD:				; CODE XREF: .text:10015ED1j
		and	dword ptr [ebp-4], 0
		lea	ebx, [edi+8]
		mov	eax, [ebx-4]
		mov	[ebp-2Ch], edi
		mov	[ebp-30h], ebx
		cmp	eax, edi
		jz	loc_10015EA7

loc_10015DF5:				; CODE XREF: .text:10015E7Aj
		mov	ecx, [ebp-4]
		cmp	ecx, [ebp+esi*4-138h]
		jz	short loc_10015E80
		mov	ecx, [ebp-8]
		cmp	eax, ecx
		jb	loc_10015F70
		add	ecx, 8000h
		cmp	eax, ecx
		jnb	loc_10015F70
		mov	ecx, eax
		and	ecx, 0FFFFF000h
		add	ecx, 0Ch
		lea	edx, [ecx+0FF0h]
		cmp	ecx, edx
		jz	loc_10015F64

loc_10015E33:				; CODE XREF: .text:10015E43j
		cmp	ecx, eax
		jz	short loc_10015E45
		mov	ebx, [ecx]
		and	ebx, 0FFFFFFFEh
		add	ecx, ebx
		mov	ebx, [ebp-30h]
		cmp	ecx, edx
		jnz	short loc_10015E33

loc_10015E45:				; CODE XREF: .text:10015E35j
		cmp	ecx, edx
		jz	loc_10015F64
		mov	ecx, [eax]
		sar	ecx, 4
		dec	ecx
		cmp	ecx, 3Fh
		jle	short loc_10015E5B
		push	3Fh
		pop	ecx

loc_10015E5B:				; CODE XREF: .text:10015E56j
		cmp	ecx, esi
		jnz	loc_10015F68
		mov	ecx, [ebp-2Ch]
		cmp	[eax+8], ecx
		jnz	loc_10015F6C
		inc	dword ptr [ebp-4]
		mov	[ebp-2Ch], eax
		mov	eax, [eax+4]
		cmp	eax, edi
		jnz	loc_10015DF5

loc_10015E80:				; CODE XREF: .text:10015DFFj
		cmp	dword ptr [ebp-4], 0
		jz	short loc_10015EA7
		cmp	esi, 20h
		mov	eax, 80000000h
		jge	short loc_10015E9C
		mov	ecx, esi
		shr	eax, cl
		or	[ebp-28h], eax
		or	[ebp-10h], eax
		jmp	short loc_10015EA7
; ---------------------------------------------------------------------------

loc_10015E9C:				; CODE XREF: .text:10015E8Ej
		lea	ecx, [esi-20h]
		shr	eax, cl
		or	[ebp-18h], eax
		or	[ebp-14h], eax

loc_10015EA7:				; CODE XREF: .text:10015DEFj
					; .text:10015E84j ...
		mov	eax, [ebp-2Ch]
		cmp	[eax+4], edi
		jnz	loc_10015F78
		mov	ecx, [ebp-4]
		cmp	ecx, [ebp+esi*4-138h]
		jnz	loc_10015F78
		cmp	[ebx], eax
		jnz	loc_10015F74
		inc	esi
		cmp	esi, 40h
		mov	edi, ebx
		jl	loc_10015DDD
		mov	esi, [ebp-38h]
		mov	edx, [ebp-34h]
		xor	ebx, ebx

loc_10015EDF:				; CODE XREF: .text:10015D21j
		mov	eax, [ebp-28h]
		cmp	eax, [esi-80h]
		jnz	loc_10015F7C
		mov	eax, [ebp-18h]
		cmp	eax, [esi]
		jnz	loc_10015F7C
		add	dword ptr [ebp-8], 8000h
		add	dword ptr [ebp-24h], 204h
		shl	dword ptr [ebp-20h], 1
		inc	dword ptr [ebp-0Ch]
		add	esi, 4
		cmp	dword ptr [ebp-0Ch], 20h
		mov	[ebp-38h], esi
		jl	loc_10015D08
		mov	eax, [ebp-10h]
		cmp	eax, [edx]
		jnz	short loc_10015F80
		mov	eax, [ebp-14h]
		cmp	eax, [edx+4]
		jnz	short loc_10015F80
		add	edx, 14h
		inc	dword ptr [ebp-1Ch]
		mov	eax, [ebp-1Ch]
		cmp	eax, dword_1002F1A4
		mov	[ebp-34h], edx
		jl	loc_10015CD6

loc_10015F41:				; CODE XREF: .text:10015CD0j
		xor	eax, eax

loc_10015F43:				; CODE XREF: .text:10015F83j
		pop	edi
		pop	esi

loc_10015F45:				; CODE XREF: .text:10015CBBj
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_10015F48:				; CODE XREF: .text:10015CDBj
		push	0FFFFFFFEh
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F4C:				; CODE XREF: .text:10015D2Aj
		push	0FFFFFFFCh
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F50:				; CODE XREF: .text:10015D65j
		push	0FFFFFFFAh
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F54:				; CODE XREF: .text:10015DABj
					; .text:10015DB7j
		push	0FFFFFFF8h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F58:				; CODE XREF: .text:10015D8Aj
					; .text:10015D93j ...
		push	0FFFFFFF9h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F5C:				; CODE XREF: .text:10015D46j
					; .text:10015D4Fj
		push	0FFFFFFFBh
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F60:				; CODE XREF: .text:10015DD5j
		push	0FFFFFFF7h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F64:				; CODE XREF: .text:10015E2Dj
					; .text:10015E47j
		push	0FFFFFFF5h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F68:				; CODE XREF: .text:10015E5Dj
		push	0FFFFFFF4h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F6C:				; CODE XREF: .text:10015E69j
		push	0FFFFFFF3h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F70:				; CODE XREF: .text:10015E06j
					; .text:10015E14j
		push	0FFFFFFF6h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F74:				; CODE XREF: .text:10015EC5j
		push	0FFFFFFF1h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F78:				; CODE XREF: .text:10015EADj
					; .text:10015EBDj
		push	0FFFFFFF2h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F7C:				; CODE XREF: .text:10015EE5j
					; .text:10015EF0j
		push	0FFFFFFF0h
		jmp	short loc_10015F82
; ---------------------------------------------------------------------------

loc_10015F80:				; CODE XREF: .text:10015F1Fj
					; .text:10015F27j
		push	0FFFFFFEFh

loc_10015F82:				; CODE XREF: .text:10015F4Aj
					; .text:10015F4Ej ...
		pop	eax
		jmp	short loc_10015F43
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		xor	esi, esi
		cmp	hHeap, esi
		jnz	short loc_10015F9C

loc_10015F95:				; CODE XREF: .text:10015FC8j
		xor	eax, eax
		jmp	loc_10016031
; ---------------------------------------------------------------------------

loc_10015F9C:				; CODE XREF: .text:10015F93j
		mov	eax, dword_1002F1BC
		cmp	eax, 3
		jnz	short loc_10015FD4
		mov	eax, [ebp+8]
		cmp	eax, 3F8h
		jbe	short loc_10015FCA
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10015F95
; ---------------------------------------------------------------------------

loc_10015FCA:				; CODE XREF: .text:10015FAEj
		mov	dword_1002F1AC,	eax
		xor	eax, eax
		inc	eax
		jmp	short loc_10016031
; ---------------------------------------------------------------------------

loc_10015FD4:				; CODE XREF: .text:10015FA4j
		push	edi
		mov	edi, [ebp+8]
		cmp	edi, esi
		jz	short loc_1001601E
		cmp	eax, 1
		jnz	short loc_10016023
		cmp	edi, 3F8h
		ja	short loc_10015FF4
		push	edi
		call	sub_100153A7
		pop	ecx
		test	eax, eax
		jnz	short loc_1001600E

loc_10015FF4:				; CODE XREF: .text:10015FE7j
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_1001602E
; ---------------------------------------------------------------------------

loc_1001600E:				; CODE XREF: .text:10015FF2j
		mov	dword_1002F1AC,	edi
		mov	dword_1002F1BC,	3

loc_1001601E:				; CODE XREF: .text:10015FDAj
		xor	eax, eax
		inc	eax
		jmp	short loc_10016030
; ---------------------------------------------------------------------------

loc_10016023:				; CODE XREF: .text:10015FDFj
		call	sub_10014BF2
		mov	dword ptr [eax], 16h

loc_1001602E:				; CODE XREF: .text:1001600Cj
		xor	eax, eax

loc_10016030:				; CODE XREF: .text:10016021j
		pop	edi

loc_10016031:				; CODE XREF: .text:10015F97j
					; .text:10015FD2j
		pop	esi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016034	proc near		; CODE XREF: sub_1000F114+89p
					; sub_1000F378+88p ...

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, dword_1002F1A4
		mov	ecx, [ebp+arg_0]
		imul	eax, 14h
		add	eax, lpMem
		add	ecx, 17h
		and	ecx, 0FFFFFFF0h
		mov	[ebp+var_10], ecx
		sar	ecx, 4
		push	ebx
		dec	ecx
		cmp	ecx, 20h
		push	esi
		push	edi
		jge	short loc_1001606D
		or	esi, 0FFFFFFFFh
		shr	esi, cl
		or	[ebp+var_8], 0FFFFFFFFh
		jmp	short loc_1001607A
; ---------------------------------------------------------------------------

loc_1001606D:				; CODE XREF: sub_10016034+2Cj
		add	ecx, 0FFFFFFE0h
		or	edx, 0FFFFFFFFh
		xor	esi, esi
		shr	edx, cl
		mov	[ebp+var_8], edx

loc_1001607A:				; CODE XREF: sub_10016034+37j
		mov	ecx, dword_1002F1B0
		mov	ebx, ecx
		jmp	short loc_10016095
; ---------------------------------------------------------------------------

loc_10016084:				; CODE XREF: sub_10016034+66j
		mov	edx, [ebx+4]
		mov	edi, [ebx]
		and	edx, [ebp+var_8]
		and	edi, esi
		or	edx, edi
		jnz	short loc_1001609C
		add	ebx, 14h

loc_10016095:				; CODE XREF: sub_10016034+4Ej
		mov	[ebp+arg_0], ebx
		cmp	ebx, eax
		jb	short loc_10016084

loc_1001609C:				; CODE XREF: sub_10016034+5Cj
		cmp	ebx, eax
		jnz	short loc_1001611F
		mov	ebx, lpMem
		jmp	short loc_100160B9
; ---------------------------------------------------------------------------

loc_100160A8:				; CODE XREF: sub_10016034+8Aj
		mov	edx, [ebx+4]
		mov	edi, [ebx]
		and	edx, [ebp+var_8]
		and	edi, esi
		or	edx, edi
		jnz	short loc_100160C0
		add	ebx, 14h

loc_100160B9:				; CODE XREF: sub_10016034+72j
		mov	[ebp+arg_0], ebx
		cmp	ebx, ecx
		jb	short loc_100160A8

loc_100160C0:				; CODE XREF: sub_10016034+80j
		cmp	ebx, ecx
		jnz	short loc_1001611F
		jmp	short loc_100160D2
; ---------------------------------------------------------------------------

loc_100160C6:				; CODE XREF: sub_10016034+A0j
		cmp	dword ptr [ebx+8], 0
		jnz	short loc_100160D6
		add	ebx, 14h
		mov	[ebp+arg_0], ebx

loc_100160D2:				; CODE XREF: sub_10016034+90j
		cmp	ebx, eax
		jb	short loc_100160C6

loc_100160D6:				; CODE XREF: sub_10016034+96j
		cmp	ebx, eax
		jnz	short loc_1001610B
		mov	ebx, lpMem
		jmp	short loc_100160EB
; ---------------------------------------------------------------------------

loc_100160E2:				; CODE XREF: sub_10016034+BCj
		cmp	dword ptr [ebx+8], 0
		jnz	short loc_100160F2
		add	ebx, 14h

loc_100160EB:				; CODE XREF: sub_10016034+ACj
		mov	[ebp+arg_0], ebx
		cmp	ebx, ecx
		jb	short loc_100160E2

loc_100160F2:				; CODE XREF: sub_10016034+B2j
		cmp	ebx, ecx
		jnz	short loc_1001610B
		call	sub_1001573B
		mov	ebx, eax
		mov	[ebp+arg_0], ebx
		test	ebx, ebx
		jnz	short loc_1001610B

loc_10016104:				; CODE XREF: sub_10016034+E9j
		xor	eax, eax
		jmp	loc_10016314
; ---------------------------------------------------------------------------

loc_1001610B:				; CODE XREF: sub_10016034+A4j
					; sub_10016034+C0j ...
		push	ebx
		call	sub_100157EB
		pop	ecx
		mov	ecx, [ebx+10h]
		mov	[ecx], eax
		mov	eax, [ebx+10h]
		cmp	dword ptr [eax], 0FFFFFFFFh
		jz	short loc_10016104

loc_1001611F:				; CODE XREF: sub_10016034+6Aj
					; sub_10016034+8Ej
		mov	dword_1002F1B0,	ebx
		mov	eax, [ebx+10h]
		mov	edx, [eax]
		mov	[ebp+var_4], edx
		cmp	edx, 0FFFFFFFFh
		jz	short loc_10016146
		mov	ecx, [eax+edx*4+0C4h]
		mov	edi, [eax+edx*4+44h]
		and	ecx, [ebp+var_8]
		and	edi, esi
		or	ecx, edi
		jnz	short loc_1001616F

loc_10016146:				; CODE XREF: sub_10016034+FCj
		and	[ebp+var_4], 0
		mov	edx, [eax+0C4h]
		lea	ecx, [eax+44h]

loc_10016153:				; CODE XREF: sub_10016034+136j
		mov	edi, [ecx]
		and	edx, [ebp+var_8]
		and	edi, esi
		or	edx, edi
		jnz	short loc_1001616C
		inc	[ebp+var_4]
		mov	edx, [ecx+84h]
		add	ecx, 4
		jmp	short loc_10016153
; ---------------------------------------------------------------------------

loc_1001616C:				; CODE XREF: sub_10016034+128j
		mov	edx, [ebp+var_4]

loc_1001616F:				; CODE XREF: sub_10016034+110j
		mov	ecx, edx
		imul	ecx, 204h
		lea	ecx, [ecx+eax+144h]
		mov	[ebp+var_C], ecx
		mov	ecx, [eax+edx*4+44h]
		xor	edi, edi
		and	ecx, esi
		jnz	short loc_1001619D
		mov	ecx, [eax+edx*4+0C4h]
		and	ecx, [ebp+var_8]
		push	20h
		pop	edi
		jmp	short loc_1001619D
; ---------------------------------------------------------------------------

loc_1001619A:				; CODE XREF: sub_10016034+16Bj
		add	ecx, ecx
		inc	edi

loc_1001619D:				; CODE XREF: sub_10016034+155j
					; sub_10016034+164j
		test	ecx, ecx
		jge	short loc_1001619A
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+edi*8+4]
		mov	ecx, [edx]
		sub	ecx, [ebp+var_10]
		mov	esi, ecx
		sar	esi, 4
		dec	esi
		cmp	esi, 3Fh
		mov	[ebp+var_8], ecx
		jle	short loc_100161BE
		push	3Fh
		pop	esi

loc_100161BE:				; CODE XREF: sub_10016034+185j
		cmp	esi, edi
		jz	loc_100162C7
		mov	ecx, [edx+4]
		cmp	ecx, [edx+8]
		jnz	short loc_1001622A
		cmp	edi, 20h
		mov	ebx, 80000000h
		jge	short loc_100161FE
		mov	ecx, edi
		shr	ebx, cl
		mov	ecx, [ebp+var_4]
		lea	edi, [eax+edi+4]
		not	ebx
		mov	[ebp+var_14], ebx
		and	ebx, [eax+ecx*4+44h]
		mov	[eax+ecx*4+44h], ebx
		dec	byte ptr [edi]
		jnz	short loc_10016227
		mov	ecx, [ebp+var_14]
		mov	ebx, [ebp+arg_0]
		and	[ebx], ecx
		jmp	short loc_1001622A
; ---------------------------------------------------------------------------

loc_100161FE:				; CODE XREF: sub_10016034+1A2j
		lea	ecx, [edi-20h]
		shr	ebx, cl
		mov	ecx, [ebp+var_4]
		lea	ecx, [eax+ecx*4+0C4h]
		lea	edi, [eax+edi+4]
		not	ebx
		and	[ecx], ebx
		dec	byte ptr [edi]
		mov	[ebp+var_14], ebx
		jnz	short loc_10016227
		mov	ebx, [ebp+arg_0]
		mov	ecx, [ebp+var_14]
		and	[ebx+4], ecx
		jmp	short loc_1001622A
; ---------------------------------------------------------------------------

loc_10016227:				; CODE XREF: sub_10016034+1BEj
					; sub_10016034+1E6j
		mov	ebx, [ebp+arg_0]

loc_1001622A:				; CODE XREF: sub_10016034+198j
					; sub_10016034+1C8j ...
		cmp	[ebp+var_8], 0
		mov	ecx, [edx+8]
		mov	edi, [edx+4]
		mov	[ecx+4], edi
		mov	ecx, [edx+4]
		mov	edi, [edx+8]
		mov	[ecx+8], edi
		jz	loc_100162D3
		mov	ecx, [ebp+var_C]
		lea	ecx, [ecx+esi*8]
		mov	edi, [ecx+4]
		mov	[edx+8], ecx
		mov	[edx+4], edi
		mov	[ecx+4], edx
		mov	ecx, [edx+4]
		mov	[ecx+8], edx
		mov	ecx, [edx+4]
		cmp	ecx, [edx+8]
		jnz	short loc_100162C4
		mov	cl, [esi+eax+4]
		mov	byte ptr [ebp+arg_0+3],	cl
		inc	cl
		cmp	esi, 20h
		mov	[esi+eax+4], cl
		jge	short loc_1001629B
		cmp	byte ptr [ebp+arg_0+3],	0
		jnz	short loc_10016289
		mov	edi, 80000000h
		mov	ecx, esi
		shr	edi, cl
		or	[ebx], edi

loc_10016289:				; CODE XREF: sub_10016034+248j
		mov	ecx, esi
		mov	edi, 80000000h
		shr	edi, cl
		mov	ecx, [ebp+var_4]
		or	[eax+ecx*4+44h], edi
		jmp	short loc_100162C4
; ---------------------------------------------------------------------------

loc_1001629B:				; CODE XREF: sub_10016034+242j
		cmp	byte ptr [ebp+arg_0+3],	0
		jnz	short loc_100162AE
		lea	ecx, [esi-20h]
		mov	edi, 80000000h
		shr	edi, cl
		or	[ebx+4], edi

loc_100162AE:				; CODE XREF: sub_10016034+26Bj
		mov	ecx, [ebp+var_4]
		lea	edi, [eax+ecx*4+0C4h]
		lea	ecx, [esi-20h]
		mov	esi, 80000000h
		shr	esi, cl
		or	[edi], esi

loc_100162C4:				; CODE XREF: sub_10016034+230j
					; sub_10016034+265j
		mov	ecx, [ebp+var_8]

loc_100162C7:				; CODE XREF: sub_10016034+18Cj
		test	ecx, ecx
		jz	short loc_100162D6
		mov	[edx], ecx
		mov	[ecx+edx-4], ecx
		jmp	short loc_100162D6
; ---------------------------------------------------------------------------

loc_100162D3:				; CODE XREF: sub_10016034+20Cj
		mov	ecx, [ebp+var_8]

loc_100162D6:				; CODE XREF: sub_10016034+295j
					; sub_10016034+29Dj
		mov	esi, [ebp+var_10]
		add	edx, ecx
		lea	ecx, [esi+1]
		mov	[edx], ecx
		mov	[edx+esi-4], ecx
		mov	esi, [ebp+var_C]
		mov	ecx, [esi]
		lea	edi, [ecx+1]
		mov	[esi], edi
		test	ecx, ecx
		jnz	short loc_1001630C
		cmp	ebx, dword_1002E7B0
		jnz	short loc_1001630C
		mov	ecx, [ebp+var_4]
		cmp	ecx, dword_1002F1B8
		jnz	short loc_1001630C
		and	dword_1002E7B0,	0

loc_1001630C:				; CODE XREF: sub_10016034+2BCj
					; sub_10016034+2C4j ...
		mov	ecx, [ebp+var_4]
		mov	[eax], ecx
		lea	eax, [edx+4]

loc_10016314:				; CODE XREF: sub_10016034+D2j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_10016034	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016319	proc near		; CODE XREF: __security_check_cookie(x):$failure$3j

var_328		= dword	ptr -328h
var_324		= dword	ptr -324h
var_320		= dword	ptr -320h
var_s0		= dword	ptr  0
arg_0		= byte ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 328h
		mov	dword_1002E8B8,	eax
		mov	dword_1002E8B4,	ecx
		mov	dword_1002E8B0,	edx
		mov	dword_1002E8AC,	ebx
		mov	dword_1002E8A8,	esi
		mov	dword_1002E8A4,	edi
		mov	word_1002E8D0, ss
		mov	word_1002E8C4, cs
		mov	word_1002E8A0, ds
		mov	word_1002E89C, es
		mov	word_1002E898, fs
		mov	word_1002E894, gs
		pushf
		pop	dword_1002E8C8
		mov	eax, [ebp+var_s0]
		mov	dword_1002E8BC,	eax
		mov	eax, [ebp+4]
		mov	dword_1002E8C0,	eax
		lea	eax, [ebp+arg_0]
		mov	dword_1002E8CC,	eax
		mov	eax, [ebp+var_320]
		mov	dword_1002E808,	10001h
		mov	eax, dword_1002E8C0
		mov	dword_1002E7C4,	eax
		mov	dword_1002E7B8,	0C0000409h
		mov	dword_1002E7BC,	1
		mov	eax, ___security_cookie
		mov	[ebp+var_328], eax
		mov	eax, dword_1002D2C4
		mov	[ebp+var_324], eax
		push	0		; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		push	offset ExceptionInfo ; ExceptionInfo
		call	ds:UnhandledExceptionFilter
		push	0C0000409h	; uExitCode
		call	ds:GetCurrentProcess
		push	eax		; hProcess
		call	ds:TerminateProcess
		leave
		retn
sub_10016319	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100163FB	proc near		; CODE XREF: sub_1001679B+Bp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	dword_1002EAD4,	eax
		pop	ebp
		retn
sub_100163FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001640A	proc near		; CODE XREF: .text:10016442p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	4
		call	sub_100152C7
		push	dword_1002EAD4
		call	sub_100135C4
		push	[ebp+arg_0]
		mov	esi, eax
		call	sub_10013548
		push	4
		mov	dword_1002EAD4,	eax
		call	sub_100151D0
		add	esp, 10h
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
sub_1001640A	endp

; ---------------------------------------------------------------------------
		push	0
		call	sub_1001640A
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		push	dword_1002EAD4
		call	sub_100135C4
		pop	ecx
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016456	proc near		; CODE XREF: sub_1000F114+161p
					; sub_1000F114+1CAp ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword_1002EAD4
		call	sub_100135C4
		pop	ecx
		test	eax, eax
		jz	short loc_1001647A
		push	[ebp+arg_0]
		call	eax
		pop	ecx
		test	eax, eax
		jz	short loc_1001647A
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001647A:				; CODE XREF: sub_10016456+13j
					; sub_10016456+1Dj
		xor	eax, eax
		pop	ebp
		retn
sub_10016456	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001647E	proc near		; CODE XREF: sub_100165FB+45p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		xor	eax, eax
		jmp	short loc_1001649A
; ---------------------------------------------------------------------------

loc_1001648B:				; CODE XREF: sub_1001647E+1Fj
		test	eax, eax
		jnz	short loc_1001649F
		mov	ecx, [esi]
		test	ecx, ecx
		jz	short loc_10016497
		call	ecx

loc_10016497:				; CODE XREF: sub_1001647E+15j
		add	esi, 4

loc_1001649A:				; CODE XREF: sub_1001647E+Bj
		cmp	esi, [ebp+arg_4]
		jb	short loc_1001648B

loc_1001649F:				; CODE XREF: sub_1001647E+Fj
		pop	esi
		pop	ebp
		retn
sub_1001647E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100164A2	proc near		; CODE XREF: sub_10011D90+9Dp
					; sub_10012545+6Dp ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		call	sub_10016988
		push	[ebp+arg_0]
		call	sub_100167DD
		push	off_1002DE20
		call	sub_100135C4
		push	0FFh
		call	eax
		add	esp, 0Ch
		pop	ebp
		retn
sub_100164A2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100164CB	proc near		; CODE XREF: sub_100164F6+8p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	offset aMscoree_dll ; "mscoree.dll"
		call	ds:GetModuleHandleA
		test	eax, eax
		jz	short loc_100164F4
		push	offset aCorexitprocess ; "CorExitProcess"
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_100164F4
		push	[ebp+arg_0]
		call	eax

loc_100164F4:				; CODE XREF: sub_100164CB+12j
					; sub_100164CB+22j
		pop	ebp
		retn
sub_100164CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_100164F6(UINT	uExitCode)
sub_100164F6	proc near		; CODE XREF: .text:1000F545p
					; sub_1000F5A0+34p ...

uExitCode	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+uExitCode]
		call	sub_100164CB
		pop	ecx
		push	[ebp+uExitCode]	; uExitCode
		call	ds:ExitProcess
sub_100164F6	endp

; ---------------------------------------------------------------------------
		align 2
		push	8
		call	sub_100152C7
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		push	8
		call	sub_100151D0
		pop	ecx
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016520	proc near		; CODE XREF: sub_100165FB+5Ap
					; sub_10016683+78p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, eax
		jmp	short loc_10016535
; ---------------------------------------------------------------------------

loc_1001652A:				; CODE XREF: sub_10016520+18j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10016532
		call	eax

loc_10016532:				; CODE XREF: sub_10016520+Ej
		add	esi, 4

loc_10016535:				; CODE XREF: sub_10016520+8j
		cmp	esi, [ebp+arg_0]
		jb	short loc_1001652A
		pop	esi
		pop	ebp
		retn
sub_10016520	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001653D	proc near		; CODE XREF: sub_10014FF1+14p
					; sub_1001F928+27p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		push	esi
		xor	esi, esi
		cmp	ecx, esi
		jnz	short loc_10016569

loc_1001654C:				; CODE XREF: sub_1001653D+33j
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_10016576
; ---------------------------------------------------------------------------

loc_10016569:				; CODE XREF: sub_1001653D+Dj
		mov	eax, dword_1002EAE0
		cmp	eax, esi
		jz	short loc_1001654C
		mov	[ecx], eax
		xor	eax, eax

loc_10016576:				; CODE XREF: sub_1001653D+2Aj
		pop	esi
		pop	ebp
		retn
sub_1001653D	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jnz	short loc_100165A5

loc_10016588:				; CODE XREF: .text:100165ABj
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_100165B7
; ---------------------------------------------------------------------------

loc_100165A5:				; CODE XREF: .text:10016586j
		cmp	dword_1002EAE0,	esi
		jz	short loc_10016588
		mov	ecx, dword_1002EAE4
		mov	[eax], ecx
		xor	eax, eax

loc_100165B7:				; CODE XREF: .text:100165A3j
		pop	esi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100165BA	proc near		; CODE XREF: sub_10014FF1+2Fp
					; sub_10020306+123p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jnz	short loc_100165E6

loc_100165C9:				; CODE XREF: sub_100165BA+32j
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_100165F8
; ---------------------------------------------------------------------------

loc_100165E6:				; CODE XREF: sub_100165BA+Dj
		cmp	dword_1002EAE0,	esi
		jz	short loc_100165C9
		mov	ecx, dword_1002EAEC
		mov	[eax], ecx
		xor	eax, eax

loc_100165F8:				; CODE XREF: sub_100165BA+2Aj
		pop	esi
		pop	ebp
		retn
sub_100165BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100165FB	proc near		; CODE XREF: sub_10011438+E5p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002F190,	0
		jz	short loc_10016622
		push	offset dword_1002F190
		call	sub_1001D634
		pop	ecx
		test	eax, eax
		jz	short loc_10016622
		push	[ebp+arg_0]
		call	dword_1002F190
		pop	ecx

loc_10016622:				; CODE XREF: sub_100165FB+Cj
					; sub_100165FB+1Bj
		call	sub_1001D2A2
		call	sub_100135BB
		push	offset dword_100271FC
		push	offset dword_100271E8
		mov	dword_1002F184,	eax
		mov	dword_1002F188,	eax
		call	sub_1001647E
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10016681
		push	offset dword_100271E4
		mov	eax, offset dword_100271E0
		call	sub_10016520
		cmp	dword_1002F19C,	0
		pop	ecx
		jz	short loc_1001667F
		push	offset dword_1002F19C
		call	sub_1001D634
		pop	ecx
		test	eax, eax
		jz	short loc_1001667F
		push	0
		push	2
		push	0
		call	dword_1002F19C

loc_1001667F:				; CODE XREF: sub_100165FB+67j
					; sub_100165FB+76j
		xor	eax, eax

loc_10016681:				; CODE XREF: sub_100165FB+4Ej
		pop	ebp
		retn
sub_100165FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10016683(UINT	uExitCode, int,	int)
sub_10016683	proc near		; CODE XREF: .text:1001675Dp
					; sub_10016767+Cp ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
uExitCode	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

; FUNCTION CHUNK AT 1001674B SIZE 00000006 BYTES

		push	0Ch
		push	offset stru_1002B5F8
		call	__SEH_prolog4
		push	8
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		xor	esi, esi
		inc	esi
		cmp	dword_1002EB20,	esi
		jz	short loc_10016711
		mov	dword_1002EB1C,	esi
		mov	al, byte ptr [ebp+arg_8]
		mov	byte_1002EB18, al
		cmp	[ebp+arg_4], 0
		jnz	short loc_10016701
		push	dword_1002F188
		call	sub_100135C4
		mov	edi, eax
		push	dword_1002F184
		call	sub_100135C4
		pop	ecx
		pop	ecx
		mov	[ebp+var_1C], eax
		test	edi, edi
		jz	short loc_100166F1

loc_100166DB:				; CODE XREF: sub_10016683+68j
					; sub_10016683+6Cj
		sub	[ebp+var_1C], 4
		cmp	[ebp+var_1C], edi
		jb	short loc_100166F1
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_100166DB
		call	eax
		jmp	short loc_100166DB
; ---------------------------------------------------------------------------

loc_100166F1:				; CODE XREF: sub_10016683+56j
					; sub_10016683+5Fj
		push	offset dword_1002720C
		mov	eax, offset dword_10027200
		call	sub_10016520
		pop	ecx

loc_10016701:				; CODE XREF: sub_10016683+35j
		push	offset dword_10027214
		mov	eax, offset dword_10027210
		call	sub_10016520
		pop	ecx

loc_10016711:				; CODE XREF: sub_10016683+21j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1001673C
; ---------------------------------------------------------------------------

loc_1001671D:				; CODE XREF: sub_10016683:loc_1001674Aj
		cmp	[ebp+arg_8], 0
		jnz	short loc_1001674B
		mov	dword_1002EB20,	esi
		push	8
		call	sub_100151D0
		pop	ecx
		push	[ebp+uExitCode]	; uExitCode
		call	sub_100164F6
; ---------------------------------------------------------------------------

loc_10016739:				; DATA XREF: .rdata:stru_1002B5F8o
		xor	esi, esi
		inc	esi

loc_1001673C:				; CODE XREF: sub_10016683+95j
		cmp	[ebp+arg_8], 0
		jz	short loc_1001674A
		push	8
		call	sub_100151D0
		pop	ecx

loc_1001674A:				; CODE XREF: sub_10016683+BDj
		retn
sub_10016683	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10016683

loc_1001674B:				; CODE XREF: sub_10016683+9Ej
		call	__SEH_epilog4
		retn
; END OF FUNCTION CHUNK	FOR sub_10016683
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	dword ptr [ebp+8]
		call	sub_10016683
		add	esp, 0Ch
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10016767(UINT	uExitCode)
sub_10016767	proc near		; CODE XREF: sub_10020156+D9p
					; sub_100242C7+111p
					; DATA XREF: ...

uExitCode	= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0		; int
		push	1		; int
		push	[ebp+uExitCode]	; uExitCode
		call	sub_10016683
		add	esp, 0Ch
		pop	ebp
		retn
sub_10016767	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001677D	proc near		; CODE XREF: sub_10011438+121p
		push	1		; int
		push	0		; int
		push	0		; uExitCode
		call	sub_10016683
		add	esp, 0Ch
		retn
sub_1001677D	endp

; ---------------------------------------------------------------------------
		push	1
		push	1
		push	0
		call	sub_10016683
		add	esp, 0Ch
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1001679B	proc near		; CODE XREF: sub_10013A07+B9p
		mov	edi, edi
		push	esi
		call	sub_100135BB
		mov	esi, eax
		push	esi
		call	sub_100163FB
		push	esi
		call	sub_1001F904
		push	esi
		call	sub_10010263
		push	esi
		call	sub_1001FE0A
		push	esi
		call	nullsub_2
		push	esi
		call	sub_1001FDF9
		push	offset sub_10016767
		call	sub_10013548
		add	esp, 1Ch
		mov	off_1002DE20, eax
		pop	esi
		retn
sub_1001679B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100167DD	proc near		; CODE XREF: .text:1000F53Bp
					; sub_1000F5A0+2Ap ...

NumberOfBytesWritten= dword ptr	-8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		xor	ebx, ebx
		xor	esi, esi
		push	edi
		mov	edi, [ebp+arg_0]
		mov	[ebp+var_4], esi

loc_100167F1:				; CODE XREF: sub_100167DD+24j
		cmp	edi, dword_1002DE28[esi*8]
		jz	short loc_10016803
		inc	esi
		mov	[ebp+var_4], esi
		cmp	esi, 17h
		jb	short loc_100167F1

loc_10016803:				; CODE XREF: sub_100167DD+1Bj
		cmp	esi, 17h
		jnb	loc_1001695D
		push	3
		call	sub_100204A8
		pop	ecx
		cmp	eax, 1
		jz	loc_10016927
		push	3
		call	sub_100204A8
		pop	ecx
		test	eax, eax
		jnz	short loc_10016836
		cmp	dword_1002E5FC,	1
		jz	loc_10016927

loc_10016836:				; CODE XREF: sub_100167DD+4Aj
		cmp	edi, 0FCh
		jz	loc_1001695D
		push	offset aRuntimeErrorPr ; "Runtime Error!\n\nProgram: "
		mov	edi, 314h
		push	edi
		mov	esi, offset dword_1002EB28
		push	esi
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001686C
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_1001686C:				; CODE XREF: sub_100167DD+80j
		mov	byte_1002EC45, bl
		push	104h		; nSize
		mov	ebx, offset Filename
		push	ebx		; lpFilename
		push	0		; hModule
		call	ds:GetModuleFileNameA
		test	eax, eax
		jnz	short loc_100168AF
		push	offset aProgramNameUnk ; "<program name	unknown>"
		push	2FBh
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100168AF
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_100168AF:				; CODE XREF: sub_100167DD+AAj
					; sub_100167DD+C1j
		push	ebx
		push	edi
		push	esi
		call	sub_1001C6BE
		add	esp, 0Ch
		xor	ebx, ebx
		test	eax, eax
		jz	short loc_100168CD
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_100168CD:				; CODE XREF: sub_100167DD+E1j
		push	offset asc_10029790 ; "\n\n"
		push	edi
		push	esi
		call	sub_1001C6BE
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100168ED
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_100168ED:				; CODE XREF: sub_100167DD+101j
		mov	eax, [ebp+var_4]
		push	lpBuffer[eax*8]
		push	edi
		push	esi
		call	sub_1001C6BE
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10016912
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10016912:				; CODE XREF: sub_100167DD+126j
		push	12010h
		push	offset aMicrosoftVisua ; "Microsoft Visual C++ Runtime Library"
		push	esi
		call	sub_10020306
		add	esp, 0Ch
		jmp	short loc_1001695D
; ---------------------------------------------------------------------------

loc_10016927:				; CODE XREF: sub_100167DD+3Aj
					; sub_100167DD+53j
		push	0FFFFFFF4h	; nStdHandle
		call	ds:GetStdHandle
		mov	edi, eax
		cmp	edi, ebx
		jz	short loc_1001695D
		cmp	edi, 0FFFFFFFFh
		jz	short loc_1001695D
		mov	edx, lpBuffer[esi*8]
		mov	ecx, edx
		lea	esi, [ecx+1]

loc_10016946:				; CODE XREF: sub_100167DD+16Ej
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_10016946
		push	ebx		; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		sub	ecx, esi
		push	ecx		; nNumberOfBytesToWrite
		push	edx		; lpBuffer
		push	edi		; hFile
		call	ds:WriteFile

loc_1001695D:				; CODE XREF: sub_100167DD+29j
					; sub_100167DD+5Fj ...
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_100167DD	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		xor	eax, eax

loc_10016969:				; CODE XREF: .text:10016979j
		mov	ecx, [ebp+8]
		cmp	ecx, dword_1002DE28[eax*8]
		jz	short loc_1001697F
		inc	eax
		cmp	eax, 17h
		jb	short loc_10016969
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001697F:				; CODE XREF: .text:10016973j
		mov	eax, lpBuffer[eax*8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10016988	proc near		; CODE XREF: .text:1000F534p
					; sub_1000F5A0+23p ...
		push	3
		call	sub_100204A8
		pop	ecx
		cmp	eax, 1
		jz	short loc_100169AA
		push	3
		call	sub_100204A8
		pop	ecx
		test	eax, eax
		jnz	short locret_100169C0
		cmp	dword_1002E5FC,	1
		jnz	short locret_100169C0

loc_100169AA:				; CODE XREF: sub_10016988+Bj
		push	0FCh
		call	sub_100167DD
		push	0FFh
		call	sub_100167DD
		pop	ecx
		pop	ecx

locret_100169C0:			; CODE XREF: sub_10016988+17j
					; sub_10016988+20j
		retn
sub_10016988	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100169C1	proc near		; CODE XREF: sub_10016AAF+10p

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	[ebp+arg_C]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	ecx, [ebp+arg_8]
		xor	ebx, ebx
		cmp	ecx, ebx
		jnz	short loc_100169F1
		cmp	[ebp+var_4], bl
		jz	short loc_100169EA
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_100169EA:				; CODE XREF: sub_100169C1+20j
		xor	eax, eax
		jmp	loc_10016AAC
; ---------------------------------------------------------------------------

loc_100169F1:				; CODE XREF: sub_100169C1+1Bj
		cmp	[ebp+arg_0], ebx
		jnz	short loc_10016A24

loc_100169F6:				; CODE XREF: sub_100169C1+66j
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10016A1A
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10016A1A:				; CODE XREF: sub_100169C1+50j
		mov	eax, 7FFFFFFFh
		jmp	loc_10016AAC
; ---------------------------------------------------------------------------

loc_10016A24:				; CODE XREF: sub_100169C1+33j
		cmp	[ebp+arg_4], ebx
		jz	short loc_100169F6
		push	esi
		mov	esi, 7FFFFFFFh
		cmp	ecx, esi
		jbe	short loc_10016A4D
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10016A8C
; ---------------------------------------------------------------------------

loc_10016A4D:				; CODE XREF: sub_100169C1+70j
		mov	eax, [ebp+var_C]
		cmp	[eax+8], ebx
		jnz	short loc_10016A69
		push	[ebp+arg_C]
		push	ecx
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100208DE
		add	esp, 10h
		jmp	short loc_10016A9F
; ---------------------------------------------------------------------------

loc_10016A69:				; CODE XREF: sub_100169C1+92j
		push	dword ptr [eax+4]
		push	ecx
		push	[ebp+arg_4]
		push	ecx
		push	[ebp+arg_0]
		push	1001h
		push	dword ptr [eax+0Ch]
		lea	eax, [ebp+var_10]
		push	eax
		call	sub_1002089C
		add	esp, 20h
		cmp	eax, ebx
		jnz	short loc_10016A9C

loc_10016A8C:				; CODE XREF: sub_100169C1+8Aj
		cmp	[ebp+var_4], bl
		jz	short loc_10016A98
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10016A98:				; CODE XREF: sub_100169C1+CEj
		mov	eax, esi
		jmp	short loc_10016AAB
; ---------------------------------------------------------------------------

loc_10016A9C:				; CODE XREF: sub_100169C1+C9j
		add	eax, 0FFFFFFFEh

loc_10016A9F:				; CODE XREF: sub_100169C1+A6j
		cmp	[ebp+var_4], bl
		jz	short loc_10016AAB
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

loc_10016AAB:				; CODE XREF: sub_100169C1+D9j
					; sub_100169C1+E1j
		pop	esi

loc_10016AAC:				; CODE XREF: sub_100169C1+2Bj
					; sub_100169C1+5Ej
		pop	ebx
		leave
		retn
sub_100169C1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016AAF	proc near		; CODE XREF: sub_1000F68E+6Ep
					; sub_10020A01+13p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100169C1
		add	esp, 10h
		pop	ebp
		retn
sub_10016AAF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016AC9	proc near		; CODE XREF: sub_1000F68E+27p
					; sub_10020AAD+87p

cbMultiByte	= dword	ptr -8
lpMem		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		xor	esi, esi
		push	edi
		mov	edi, dword_1002EB08
		mov	[ebp+lpMem], esi
		mov	eax, [edi]
		cmp	eax, esi
		jz	short loc_10016B49
		mov	ebx, ds:WideCharToMultiByte

loc_10016AEA:				; CODE XREF: sub_10016AC9+7Ej
		push	esi		; lpUsedDefaultChar
		push	esi		; lpDefaultChar
		push	esi		; cbMultiByte
		push	esi		; lpMultiByteStr
		push	0FFFFFFFFh	; cchWideChar
		push	eax		; lpWideCharStr
		push	esi		; dwFlags
		push	esi		; CodePage
		call	ebx ; WideCharToMultiByte
		mov	[ebp+cbMultiByte], eax
		cmp	eax, esi
		jz	short loc_10016B50
		push	1
		push	eax
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[ebp+lpMem], eax
		cmp	eax, esi
		jz	short loc_10016B50
		push	esi		; lpUsedDefaultChar
		push	esi		; lpDefaultChar
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	eax		; lpMultiByteStr
		push	0FFFFFFFFh	; cchWideChar
		push	dword ptr [edi]	; lpWideCharStr
		push	esi		; dwFlags
		push	esi		; CodePage
		call	ebx ; WideCharToMultiByte
		test	eax, eax
		jz	short loc_10016B55
		lea	eax, [ebp+lpMem]
		push	esi
		push	eax
		call	sub_10020AAD
		pop	ecx
		pop	ecx
		test	eax, eax
		jge	short loc_10016B40
		cmp	[ebp+lpMem], esi
		jz	short loc_10016B40
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx
		mov	[ebp+lpMem], esi

loc_10016B40:				; CODE XREF: sub_10016AC9+64j
					; sub_10016AC9+69j
		add	edi, 4
		mov	eax, [edi]
		cmp	eax, esi
		jnz	short loc_10016AEA

loc_10016B49:				; CODE XREF: sub_10016AC9+19j
		xor	eax, eax

loc_10016B4B:				; CODE XREF: sub_10016AC9+8Aj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_10016B50:				; CODE XREF: sub_10016AC9+31j
					; sub_10016AC9+42j ...
		or	eax, 0FFFFFFFFh
		jmp	short loc_10016B4B
; ---------------------------------------------------------------------------

loc_10016B55:				; CODE XREF: sub_10016AC9+54j
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx
		jmp	short loc_10016B50
sub_10016AC9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016B60	proc near		; CODE XREF: .text:1000F79Fp
					; .text:1000F83Bp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		push	ebx
		xor	ebx, ebx
		push	esi
		push	edi
		cmp	ecx, ebx
		jz	short loc_10016B78
		mov	edi, [ebp+arg_4]
		cmp	edi, ebx
		ja	short loc_10016B93

loc_10016B78:				; CODE XREF: sub_10016B60+Fj
					; sub_10016B60+3Cj
		call	sub_10014BF2
		push	16h
		pop	esi
		mov	[eax], esi

loc_10016B82:				; CODE XREF: sub_10016B60+5Fj
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, esi
		jmp	short loc_10016BC3
; ---------------------------------------------------------------------------

loc_10016B93:				; CODE XREF: sub_10016B60+16j
		mov	esi, [ebp+arg_8]
		cmp	esi, ebx
		jnz	short loc_10016B9E
		mov	[ecx], bl
		jmp	short loc_10016B78
; ---------------------------------------------------------------------------

loc_10016B9E:				; CODE XREF: sub_10016B60+38j
		mov	edx, ecx

loc_10016BA0:				; CODE XREF: sub_10016B60+4Bj
		mov	al, [esi]
		mov	[edx], al
		inc	edx
		inc	esi
		cmp	al, bl
		jz	short loc_10016BAD
		dec	edi
		jnz	short loc_10016BA0

loc_10016BAD:				; CODE XREF: sub_10016B60+48j
		cmp	edi, ebx
		jnz	short loc_10016BC1
		mov	[ecx], bl
		call	sub_10014BF2
		push	22h
		pop	ecx
		mov	[eax], ecx
		mov	esi, ecx
		jmp	short loc_10016B82
; ---------------------------------------------------------------------------

loc_10016BC1:				; CODE XREF: sub_10016B60+4Fj
		xor	eax, eax

loc_10016BC3:				; CODE XREF: sub_10016B60+31j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10016B60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016BC8	proc near		; CODE XREF: sub_1000FA78+A1p
					; sub_10013D99+21p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_4]
		push	esi
		call	sub_1001704B
		mov	[ebp+arg_4], eax
		mov	eax, [esi+0Ch]
		pop	ecx
		test	al, 82h
		jnz	short loc_10016BF9
		call	sub_10014BF2
		mov	dword ptr [eax], 9

loc_10016BED:				; CODE XREF: sub_10016BC8+40j
		or	dword ptr [esi+0Ch], 20h
		or	eax, 0FFFFFFFFh
		jmp	loc_10016D12
; ---------------------------------------------------------------------------

loc_10016BF9:				; CODE XREF: sub_10016BC8+18j
		test	al, 40h
		jz	short loc_10016C0A
		call	sub_10014BF2
		mov	dword ptr [eax], 22h
		jmp	short loc_10016BED
; ---------------------------------------------------------------------------

loc_10016C0A:				; CODE XREF: sub_10016BC8+33j
		push	ebx
		xor	ebx, ebx
		test	al, 1
		jz	short loc_10016C23
		mov	[esi+4], ebx
		test	al, 10h
		jz	short loc_10016C8F
		mov	ecx, [esi+8]
		and	eax, 0FFFFFFFEh
		mov	[esi], ecx
		mov	[esi+0Ch], eax

loc_10016C23:				; CODE XREF: sub_10016BC8+47j
		mov	eax, [esi+0Ch]
		and	eax, 0FFFFFFEFh
		or	eax, 2
		mov	[esi+0Ch], eax
		mov	[esi+4], ebx
		test	eax, 10Ch
		jnz	short loc_10016C5D
		cmp	esi, offset dword_1002D2F8
		jz	short loc_10016C49
		cmp	esi, offset dword_1002D318
		jnz	short loc_10016C56

loc_10016C49:				; CODE XREF: sub_10016BC8+77j
		push	[ebp+arg_4]
		call	sub_1001D23E
		pop	ecx
		test	eax, eax
		jnz	short loc_10016C5D

loc_10016C56:				; CODE XREF: sub_10016BC8+7Fj
		push	esi
		call	sub_10020EB6
		pop	ecx

loc_10016C5D:				; CODE XREF: sub_10016BC8+6Fj
					; sub_10016BC8+8Cj
		test	dword ptr [esi+0Ch], 108h
		push	edi
		jz	short loc_10016CE6
		mov	eax, [esi+8]
		mov	edi, [esi]
		lea	ecx, [eax+1]
		mov	[esi], ecx
		mov	ecx, [esi+18h]
		sub	edi, eax
		dec	ecx
		cmp	edi, ebx
		mov	[esi+4], ecx
		jle	short loc_10016C9A
		push	edi		; nNumberOfBytesToWrite
		push	eax		; int
		push	[ebp+arg_4]	; int
		call	sub_10018A68
		add	esp, 0Ch
		mov	ebx, eax
		jmp	short loc_10016CDC
; ---------------------------------------------------------------------------

loc_10016C8F:				; CODE XREF: sub_10016BC8+4Ej
		or	eax, 20h
		mov	[esi+0Ch], eax
		or	eax, 0FFFFFFFFh
		jmp	short loc_10016D11
; ---------------------------------------------------------------------------

loc_10016C9A:				; CODE XREF: sub_10016BC8+B4j
		mov	eax, [ebp+arg_4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10016CBB
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10016CBB
		mov	ecx, eax
		and	eax, 1Fh
		imul	eax, 24h
		sar	ecx, 5
		add	eax, dword_1002F080[ecx*4]
		jmp	short loc_10016CC0
; ---------------------------------------------------------------------------

loc_10016CBB:				; CODE XREF: sub_10016BC8+D8j
					; sub_10016BC8+DDj
		mov	eax, offset dword_1002DEE0

loc_10016CC0:				; CODE XREF: sub_10016BC8+F1j
		test	byte ptr [eax+4], 20h
		jz	short loc_10016CDC
		push	2		; dwMoveMethod
		push	ebx		; int
		push	ebx		; int
		push	[ebp+arg_4]	; int
		call	sub_10020D9D
		and	eax, edx
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10016CFF

loc_10016CDC:				; CODE XREF: sub_10016BC8+C5j
					; sub_10016BC8+FCj
		mov	eax, [esi+8]
		mov	cl, byte ptr [ebp+arg_0]
		mov	[eax], cl
		jmp	short loc_10016CFB
; ---------------------------------------------------------------------------

loc_10016CE6:				; CODE XREF: sub_10016BC8+9Dj
		xor	edi, edi
		inc	edi
		push	edi		; nNumberOfBytesToWrite
		lea	eax, [ebp+arg_0]
		push	eax		; int
		push	[ebp+arg_4]	; int
		call	sub_10018A68
		add	esp, 0Ch
		mov	ebx, eax

loc_10016CFB:				; CODE XREF: sub_10016BC8+11Cj
		cmp	ebx, edi
		jz	short loc_10016D08

loc_10016CFF:				; CODE XREF: sub_10016BC8+112j
		or	dword ptr [esi+0Ch], 20h
		or	eax, 0FFFFFFFFh
		jmp	short loc_10016D10
; ---------------------------------------------------------------------------

loc_10016D08:				; CODE XREF: sub_10016BC8+135j
		mov	eax, [ebp+arg_0]
		and	eax, 0FFh

loc_10016D10:				; CODE XREF: sub_10016BC8+13Ej
		pop	edi

loc_10016D11:				; CODE XREF: sub_10016BC8+D0j
		pop	ebx

loc_10016D12:				; CODE XREF: sub_10016BC8+2Cj
		pop	esi
		pop	ebp
		retn
sub_10016BC8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016D15	proc near		; CODE XREF: .text:1000FB3Cp
					; .text:10016DDBp

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		push	ebx
		xor	ebx, ebx
		cmp	[ebp+arg_8], ebx
		jnz	short loc_10016D45
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	loc_10016DC5
; ---------------------------------------------------------------------------

loc_10016D45:				; CODE XREF: sub_10016D15+Ej
		mov	ecx, [ebp+arg_4]
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	ecx, ebx
		jz	short loc_10016D71
		cmp	esi, ebx
		jnz	short loc_10016D71
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_10016DC4
; ---------------------------------------------------------------------------

loc_10016D71:				; CODE XREF: sub_10016D15+39j
					; sub_10016D15+3Dj
		mov	eax, 7FFFFFFFh
		mov	[ebp+var_1C], eax
		cmp	ecx, eax
		ja	short loc_10016D80
		mov	[ebp+var_1C], ecx

loc_10016D80:				; CODE XREF: sub_10016D15+66j
		push	edi
		push	[ebp+arg_10]
		lea	eax, [ebp+var_20]
		push	[ebp+arg_C]
		mov	[ebp+var_14], 42h
		push	[ebp+arg_8]
		mov	[ebp+var_18], esi
		push	eax
		mov	[ebp+var_20], esi
		call	sub_10013E79
		add	esp, 10h
		mov	edi, eax
		cmp	esi, ebx
		jz	short loc_10016DC3
		dec	[ebp+var_1C]
		js	short loc_10016DB5
		mov	eax, [ebp+var_20]
		mov	[eax], bl
		jmp	short loc_10016DC1
; ---------------------------------------------------------------------------

loc_10016DB5:				; CODE XREF: sub_10016D15+97j
		lea	eax, [ebp+var_20]
		push	eax
		push	ebx
		call	sub_10016BC8
		pop	ecx
		pop	ecx

loc_10016DC1:				; CODE XREF: sub_10016D15+9Ej
		mov	eax, edi

loc_10016DC3:				; CODE XREF: sub_10016D15+92j
		pop	edi

loc_10016DC4:				; CODE XREF: sub_10016D15+5Aj
		pop	esi

loc_10016DC5:				; CODE XREF: sub_10016D15+2Bj
		pop	ebx
		leave
		retn
sub_10016D15	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+14h]
		push	0
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10016D15
		add	esp, 14h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	eax, offset dword_10029BB0
		retn
; ---------------------------------------------------------------------------
		mov	eax, offset off_10029B00
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016DF1	proc near		; CODE XREF: .text:1000FC15p
					; sub_100127EE+43p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		xor	ebx, ebx
		push	edi
		cmp	[ebp+arg_C], ebx
		jnz	short loc_10016E13
		cmp	esi, ebx
		jnz	short loc_10016E17
		cmp	[ebp+arg_4], ebx
		jnz	short loc_10016E1E

loc_10016E0C:				; CODE XREF: sub_10016DF1+4Fj
					; sub_10016DF1+8Ej
		xor	eax, eax

loc_10016E0E:				; CODE XREF: sub_10016DF1+46j
					; sub_10016DF1+A0j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10016E13:				; CODE XREF: sub_10016DF1+10j
		cmp	esi, ebx
		jz	short loc_10016E1E

loc_10016E17:				; CODE XREF: sub_10016DF1+14j
		mov	edi, [ebp+arg_4]
		cmp	edi, ebx
		ja	short loc_10016E39

loc_10016E1E:				; CODE XREF: sub_10016DF1+19j
					; sub_10016DF1+24j ...
		call	sub_10014BF2
		push	16h
		pop	esi
		mov	[eax], esi

loc_10016E28:				; CODE XREF: sub_10016DF1+B3j
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, esi
		jmp	short loc_10016E0E
; ---------------------------------------------------------------------------

loc_10016E39:				; CODE XREF: sub_10016DF1+2Bj
		cmp	[ebp+arg_C], ebx
		jnz	short loc_10016E42
		mov	[esi], bl
		jmp	short loc_10016E0C
; ---------------------------------------------------------------------------

loc_10016E42:				; CODE XREF: sub_10016DF1+4Bj
		mov	edx, [ebp+arg_8]
		cmp	edx, ebx
		jnz	short loc_10016E4D
		mov	[esi], bl
		jmp	short loc_10016E1E
; ---------------------------------------------------------------------------

loc_10016E4D:				; CODE XREF: sub_10016DF1+56j
		cmp	[ebp+arg_C], 0FFFFFFFFh
		mov	eax, esi
		jnz	short loc_10016E64

loc_10016E55:				; CODE XREF: sub_10016DF1+6Fj
		mov	cl, [edx]
		mov	[eax], cl
		inc	eax
		inc	edx
		cmp	cl, bl
		jz	short loc_10016E7D
		dec	edi
		jnz	short loc_10016E55
		jmp	short loc_10016E7D
; ---------------------------------------------------------------------------

loc_10016E64:				; CODE XREF: sub_10016DF1+62j
					; sub_10016DF1+83j
		mov	cl, [edx]
		mov	[eax], cl
		inc	eax
		inc	edx
		cmp	cl, bl
		jz	short loc_10016E76
		dec	edi
		jz	short loc_10016E76
		dec	[ebp+arg_C]
		jnz	short loc_10016E64

loc_10016E76:				; CODE XREF: sub_10016DF1+7Bj
					; sub_10016DF1+7Ej
		cmp	[ebp+arg_C], ebx
		jnz	short loc_10016E7D
		mov	[eax], bl

loc_10016E7D:				; CODE XREF: sub_10016DF1+6Cj
					; sub_10016DF1+71j ...
		cmp	edi, ebx
		jnz	short loc_10016E0C
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_10016E96
		mov	eax, [ebp+arg_4]
		push	50h
		mov	[esi+eax-1], bl
		pop	eax
		jmp	loc_10016E0E
; ---------------------------------------------------------------------------

loc_10016E96:				; CODE XREF: sub_10016DF1+94j
		mov	[esi], bl
		call	sub_10014BF2
		push	22h
		pop	ecx
		mov	[eax], ecx
		mov	esi, ecx
		jmp	short loc_10016E28
sub_10016DF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016EA6	proc near		; CODE XREF: sub_10016F3F+D3p
					; sub_10021F64+353p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		push	esi
		call	sub_1002100C
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10016F09
		mov	eax, dword_1002F080
		cmp	esi, 1
		jnz	short loc_10016ECC
		test	byte ptr [eax+4Ch], 1
		jnz	short loc_10016ED7

loc_10016ECC:				; CODE XREF: sub_10016EA6+1Ej
		cmp	esi, 2
		jnz	short loc_10016EED
		test	byte ptr [eax+28h], 1
		jz	short loc_10016EED

loc_10016ED7:				; CODE XREF: sub_10016EA6+24j
		push	2
		call	sub_1002100C
		push	1
		mov	edi, eax
		call	sub_1002100C
		pop	ecx
		pop	ecx
		cmp	eax, edi
		jz	short loc_10016F09

loc_10016EED:				; CODE XREF: sub_10016EA6+29j
					; sub_10016EA6+2Fj
		push	esi
		call	sub_1002100C
		pop	ecx
		push	eax		; hObject
		call	ds:CloseHandle
		test	eax, eax
		jnz	short loc_10016F09
		call	ds:GetLastError
		mov	edi, eax
		jmp	short loc_10016F0B
; ---------------------------------------------------------------------------

loc_10016F09:				; CODE XREF: sub_10016EA6+14j
					; sub_10016EA6+45j ...
		xor	edi, edi

loc_10016F0B:				; CODE XREF: sub_10016EA6+61j
		push	esi
		call	sub_10020F86
		mov	eax, esi
		and	esi, 1Fh
		imul	esi, 24h
		sar	eax, 5
		mov	eax, dword_1002F080[eax*4]
		pop	ecx
		mov	byte ptr [eax+esi+4], 0
		test	edi, edi
		jz	short loc_10016F39
		push	edi
		call	sub_10014C18
		pop	ecx
		or	eax, 0FFFFFFFFh
		jmp	short loc_10016F3B
; ---------------------------------------------------------------------------

loc_10016F39:				; CODE XREF: sub_10016EA6+85j
		xor	eax, eax

loc_10016F3B:				; CODE XREF: sub_10016EA6+91j
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_10016EA6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016F3F	proc near		; CODE XREF: sub_1000FC34+4Bp

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	10h
		push	offset stru_1002B618
		call	__SEH_prolog4
		mov	eax, [ebp+arg_0]
		or	esi, 0FFFFFFFFh
		cmp	eax, esi
		jnz	short loc_10016F6F
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		call	sub_10014C05
		and	dword ptr [eax], 0

loc_10016F68:				; CODE XREF: sub_10016F3F+48j
					; sub_10016F3F+77j
		mov	eax, esi
		jmp	loc_1001703B
; ---------------------------------------------------------------------------

loc_10016F6F:				; CODE XREF: sub_10016F3F+14j
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10016F89
		call	sub_10014C05
		and	dword ptr [eax], 0
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		jmp	short loc_10016F68
; ---------------------------------------------------------------------------

loc_10016F89:				; CODE XREF: sub_10016F3F+33j
		xor	edi, edi
		cmp	eax, edi
		jl	short loc_10016F97
		cmp	eax, uNumber
		jb	short loc_10016FB8

loc_10016F97:				; CODE XREF: sub_10016F3F+4Ej
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10016F68
; ---------------------------------------------------------------------------

loc_10016FB8:				; CODE XREF: sub_10016F3F+56j
		mov	ecx, eax
		sar	ecx, 5
		lea	ebx, dword_1002F080[ecx*4]
		mov	esi, eax
		and	esi, 1Fh
		imul	esi, 24h
		mov	ecx, [ebx]
		movsx	ecx, byte ptr [ecx+esi+4]
		and	ecx, 1
		jnz	short loc_10016FFC
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001703B
; ---------------------------------------------------------------------------

loc_10016FFC:				; CODE XREF: sub_10016F3F+97j
		push	eax
		call	sub_1002109E
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebx]
		test	byte ptr [eax+esi+4], 1
		jz	short loc_1001701D
		push	[ebp+arg_0]
		call	sub_10016EA6
		pop	ecx
		mov	[ebp+var_1C], eax
		jmp	short loc_1001702C
; ---------------------------------------------------------------------------

loc_1001701D:				; CODE XREF: sub_10016F3F+CEj
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		or	[ebp+var_1C], 0FFFFFFFFh

loc_1001702C:				; CODE XREF: sub_10016F3F+DCj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10017041	; Finally handler 0 for	function 10016F3F
; ---------------------------------------------------------------------------

loc_10017038:				; CODE XREF: sub_10016F3F+10Bj
		mov	eax, [ebp+var_1C]

loc_1001703B:				; CODE XREF: sub_10016F3F+2Bj
					; sub_10016F3F+BBj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10017041:				; CODE XREF: sub_10016F3F+F4j
					; DATA XREF: .rdata:stru_1002B618o
		push	[ebp+arg_0]	; Finally handler 0 for	function 10016F3F
		call	sub_1002113F
		pop	ecx
		retn
sub_10016F3F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001704B	proc near		; CODE XREF: sub_1000FC34+45p
					; sub_1000FE75+78p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jnz	short loc_10017077
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001707A
; ---------------------------------------------------------------------------

loc_10017077:				; CODE XREF: sub_1001704B+Dj
		mov	eax, [eax+10h]

loc_1001707A:				; CODE XREF: sub_1001704B+2Aj
		pop	esi
		pop	ebp
		retn
sub_1001704B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001707D	proc near		; CODE XREF: sub_1000FC34+3Fp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		mov	eax, [esi+0Ch]
		test	al, 83h
		jz	short loc_100170AB
		test	al, 8
		jz	short loc_100170AB
		push	dword ptr [esi+8] ; lpMem
		call	sub_1000EE73
		and	dword ptr [esi+0Ch], 0FFFFFBF7h
		xor	eax, eax
		pop	ecx
		mov	[esi], eax
		mov	[esi+8], eax
		mov	[esi+4], eax

loc_100170AB:				; CODE XREF: sub_1001707D+Ej
					; sub_1001707D+12j
		pop	esi
		pop	ebp
		retn
sub_1001707D	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+8]
		jmp	short loc_100170BF
; ---------------------------------------------------------------------------

loc_100170B8:				; CODE XREF: .text:100170C1j
		dec	ecx
		cmp	byte ptr [eax],	0
		jz	short loc_100170C4
		inc	eax

loc_100170BF:				; CODE XREF: .text:100170B6j
		test	ecx, ecx
		jnz	short loc_100170B8
		dec	ecx

loc_100170C4:				; CODE XREF: .text:100170BCj
		mov	eax, [ebp+8]
		sub	eax, ecx
		dec	eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100170CC(int,	LCID Locale, DWORD dwMapFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpDestStr, int cchDest, UINT CodePage, int)
sub_100170CC	proc near		; CODE XREF: sub_10017580+2Fp

var_3C		= dword	ptr -3Ch
lpMem		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
lpSrcStr	= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
lpWideCharStr	= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
Locale		= dword	ptr  0Ch
dwMapFlags	= dword	ptr  10h
lpMultiByteStr	= dword	ptr  14h
cbMultiByte	= dword	ptr  18h
lpDestStr	= dword	ptr  1Ch
cchDest		= dword	ptr  20h
CodePage	= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	2Ch
		push	offset stru_1002B638
		call	__SEH_prolog4_GS
		mov	esi, [ebp+CodePage]
		xor	ebx, ebx
		cmp	dword_1002EE3C,	ebx
		jnz	short loc_1001711D
		push	ebx		; cchDest
		push	ebx		; lpDestStr
		xor	edi, edi
		inc	edi
		push	edi		; cchSrc
		push	offset SrcStr	; lpSrcStr
		push	100h		; dwMapFlags
		push	ebx		; Locale
		call	ds:LCMapStringW
		test	eax, eax
		jz	short loc_10017108
		mov	dword_1002EE3C,	edi
		jmp	short loc_1001711D
; ---------------------------------------------------------------------------

loc_10017108:				; CODE XREF: sub_100170CC+32j
		call	ds:GetLastError
		cmp	eax, 78h
		jnz	short loc_1001711D
		mov	dword_1002EE3C,	2

loc_1001711D:				; CODE XREF: sub_100170CC+17j
					; sub_100170CC+3Aj ...
		cmp	[ebp+cbMultiByte], ebx
		jle	short loc_10017144
		mov	ecx, [ebp+cbMultiByte]
		mov	eax, [ebp+lpMultiByteStr]

loc_10017128:				; CODE XREF: sub_100170CC+64j
		dec	ecx
		cmp	[eax], bl
		jz	short loc_10017135
		inc	eax
		cmp	ecx, ebx
		jnz	short loc_10017128
		or	ecx, 0FFFFFFFFh

loc_10017135:				; CODE XREF: sub_100170CC+5Fj
		mov	eax, [ebp+cbMultiByte]
		sub	eax, ecx
		dec	eax
		cmp	eax, [ebp+cbMultiByte]
		jge	short loc_10017141
		inc	eax

loc_10017141:				; CODE XREF: sub_100170CC+72j
		mov	[ebp+cbMultiByte], eax

loc_10017144:				; CODE XREF: sub_100170CC+54j
		mov	eax, dword_1002EE3C
		cmp	eax, 2
		jz	loc_100173BF
		cmp	eax, ebx
		jz	loc_100173BF
		cmp	eax, 1
		jnz	loc_100173FA
		mov	[ebp+lpSrcStr],	ebx
		mov	[ebp+var_24], ebx
		mov	[ebp+var_34], ebx
		mov	[ebp+var_28], ebx
		cmp	esi, ebx
		jnz	short loc_1001717E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	esi, [eax+4]
		mov	[ebp+CodePage],	esi

loc_1001717E:				; CODE XREF: sub_100170CC+A5j
		push	ebx		; cchWideChar
		push	ebx		; lpWideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		xor	eax, eax
		cmp	[ebp+arg_20], ebx
		setnz	al
		lea	eax, ds:1[eax*8]
		push	eax		; dwFlags
		push	esi		; CodePage
		call	ds:MultiByteToWideChar
		mov	edi, eax
		mov	[ebp+var_30], edi
		cmp	edi, ebx
		jz	loc_100173FA
		mov	[ebp+ms_exc.registration.TryLevel], 1
		jle	short loc_100171F1
		push	0FFFFFFE0h
		pop	eax
		xor	edx, edx
		div	edi
		cmp	eax, 2
		jb	short loc_100171F1
		lea	eax, [edi+edi+8]
		cmp	eax, 400h
		ja	short loc_100171DB
		call	__alloca_probe_16
		mov	[ebp+ms_exc.old_esp], esp
		mov	eax, esp
		push	0CCCCh
		jmp	short loc_100171E7
; ---------------------------------------------------------------------------

loc_100171DB:				; CODE XREF: sub_100170CC+FCj
		push	0DDDDh
		push	eax
		call	sub_1000F5A0
		pop	ecx

loc_100171E7:				; CODE XREF: sub_100170CC+10Dj
		push	eax
		call	sub_1001037C
		pop	ecx
		pop	ecx
		jmp	short loc_100171F3
; ---------------------------------------------------------------------------

loc_100171F1:				; CODE XREF: sub_100170CC+E5j
					; sub_100170CC+F1j
		xor	eax, eax

loc_100171F3:				; CODE XREF: sub_100170CC+123j
		mov	[ebp+lpWideCharStr], eax
		push	0FFFFFFFEh
		pop	esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		jmp	short loc_1001721A
; ---------------------------------------------------------------------------

loc_100171FE:				; DATA XREF: .rdata:stru_1002B638o
		xor	eax, eax	; Exception filter 1 for function 100170CC
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10017202:				; DATA XREF: .rdata:stru_1002B638o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 1	for function 100170CC
		call	sub_10021623
		and	[ebp+lpWideCharStr], 0
		push	0FFFFFFFEh
		pop	esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	ebx, [ebp+lpSrcStr]
		mov	edi, [ebp+var_30]

loc_1001721A:				; CODE XREF: sub_100170CC+130j
		cmp	[ebp+lpWideCharStr], 0
		jnz	short loc_1001723C
		lea	eax, [edi+edi]
		push	eax
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+lpWideCharStr], eax
		test	eax, eax
		jz	loc_100173FA
		mov	[ebp+var_34], 1

loc_1001723C:				; CODE XREF: sub_100170CC+152j
		push	edi		; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:MultiByteToWideChar
		test	eax, eax
		jz	loc_1001737C
		push	0		; cchDest
		push	0		; lpDestStr
		push	edi		; cchSrc
		push	[ebp+lpWideCharStr] ; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:LCMapStringW
		mov	ebx, eax
		mov	[ebp+lpSrcStr],	ebx
		test	ebx, ebx
		jz	loc_1001737C
		mov	ecx, 400h
		test	[ebp+dwMapFlags], ecx
		jz	short loc_100172B2
		cmp	[ebp+cchDest], 0
		jz	loc_1001737C
		cmp	ebx, [ebp+cchDest]
		jg	loc_1001737C
		push	[ebp+cchDest]	; cchDest
		push	[ebp+lpDestStr]	; lpDestStr
		push	edi		; cchSrc
		push	[ebp+lpWideCharStr] ; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:LCMapStringW
		jmp	loc_1001737C
; ---------------------------------------------------------------------------

loc_100172B2:				; CODE XREF: sub_100170CC+1B6j
		mov	[ebp+ms_exc.registration.TryLevel], 2
		test	ebx, ebx
		jle	short loc_100172F8
		push	0FFFFFFE0h
		pop	eax
		xor	edx, edx
		div	ebx
		cmp	eax, 2
		jb	short loc_100172F8
		lea	eax, [ebx+ebx+8]
		cmp	eax, ecx
		ja	short loc_100172E2
		call	__alloca_probe_16
		mov	[ebp+ms_exc.old_esp], esp
		mov	eax, esp
		push	0CCCCh
		jmp	short loc_100172EE
; ---------------------------------------------------------------------------

loc_100172E2:				; CODE XREF: sub_100170CC+203j
		push	0DDDDh
		push	eax
		call	sub_1000F5A0
		pop	ecx

loc_100172EE:				; CODE XREF: sub_100170CC+214j
		push	eax
		call	sub_1001037C
		pop	ecx
		pop	ecx
		jmp	short loc_100172FA
; ---------------------------------------------------------------------------

loc_100172F8:				; CODE XREF: sub_100170CC+1EFj
					; sub_100170CC+1FBj
		xor	eax, eax

loc_100172FA:				; CODE XREF: sub_100170CC+22Aj
		mov	[ebp+var_24], eax
		mov	[ebp+ms_exc.registration.TryLevel], esi
		jmp	short loc_1001731F
; ---------------------------------------------------------------------------

loc_10017302:				; DATA XREF: .rdata:stru_1002B638o
		xor	eax, eax	; Exception filter 2 for function 100170CC
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10017306:				; DATA XREF: .rdata:stru_1002B638o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 2	for function 100170CC
		call	sub_10021623
		and	[ebp+var_24], 0
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ebx, [ebp+lpSrcStr]
		mov	edi, [ebp+var_30]

loc_1001731F:				; CODE XREF: sub_100170CC+234j
		cmp	[ebp+var_24], 0
		jnz	short loc_10017341
		lea	eax, [ebx+ebx]
		push	eax
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+var_24], eax
		xor	esi, esi
		cmp	eax, esi
		jz	short loc_1001737C
		mov	[ebp+var_28], 1
		jmp	short loc_10017343
; ---------------------------------------------------------------------------

loc_10017341:				; CODE XREF: sub_100170CC+257j
		xor	esi, esi

loc_10017343:				; CODE XREF: sub_100170CC+273j
		push	ebx		; cchDest
		push	[ebp+var_24]	; lpDestStr
		push	edi		; cchSrc
		push	[ebp+lpWideCharStr] ; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:LCMapStringW
		test	eax, eax
		jz	short loc_1001737C
		push	esi		; lpUsedDefaultChar
		push	esi		; lpDefaultChar
		cmp	[ebp+cchDest], esi
		jnz	short loc_10017366
		push	esi
		push	esi
		jmp	short loc_1001736C
; ---------------------------------------------------------------------------

loc_10017366:				; CODE XREF: sub_100170CC+294j
		push	[ebp+cchDest]	; cbMultiByte
		push	[ebp+lpDestStr]	; lpMultiByteStr

loc_1001736C:				; CODE XREF: sub_100170CC+298j
		push	ebx		; cchWideChar
		push	[ebp+var_24]	; lpWideCharStr
		push	esi		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:WideCharToMultiByte
		mov	ebx, eax

loc_1001737C:				; CODE XREF: sub_100170CC+187j
					; sub_100170CC+1A8j ...
		xor	esi, esi
		cmp	[ebp+var_28], esi
		jz	short loc_1001738D
		push	[ebp+var_24]	; lpMem
		call	sub_1000EE73
		jmp	short loc_1001739A
; ---------------------------------------------------------------------------

loc_1001738D:				; CODE XREF: sub_100170CC+2B5j
		cmp	[ebp+var_24], esi
		jz	short loc_1001739B
		push	[ebp+var_24]
		call	sub_10010392

loc_1001739A:				; CODE XREF: sub_100170CC+2BFj
		pop	ecx

loc_1001739B:				; CODE XREF: sub_100170CC+2C4j
		cmp	[ebp+var_34], esi
		jz	short loc_100173AA
		push	[ebp+lpWideCharStr] ; lpMem
		call	sub_1000EE73
		jmp	short loc_100173B7
; ---------------------------------------------------------------------------

loc_100173AA:				; CODE XREF: sub_100170CC+2D2j
		cmp	[ebp+lpWideCharStr], esi
		jz	short loc_100173B8
		push	[ebp+lpWideCharStr]
		call	sub_10010392

loc_100173B7:				; CODE XREF: sub_100170CC+2DCj
		pop	ecx

loc_100173B8:				; CODE XREF: sub_100170CC+2E1j
		mov	eax, ebx
		jmp	loc_10017577
; ---------------------------------------------------------------------------

loc_100173BF:				; CODE XREF: sub_100170CC+80j
					; sub_100170CC+88j
		mov	[ebp+lpSrcStr],	ebx
		xor	edi, edi
		mov	[ebp+lpMem], ebx
		mov	[ebp+var_34], ebx
		cmp	[ebp+Locale], ebx
		jnz	short loc_100173DA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax+14h]
		mov	[ebp+Locale], eax

loc_100173DA:				; CODE XREF: sub_100170CC+301j
		cmp	esi, ebx
		jnz	short loc_100173E9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	esi, [eax+4]
		mov	[ebp+CodePage],	esi

loc_100173E9:				; CODE XREF: sub_100170CC+310j
		push	[ebp+Locale]	; Locale
		call	sub_10021420
		pop	ecx
		mov	[ebp+var_30], eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10017401

loc_100173FA:				; CODE XREF: sub_100170CC+91j
					; sub_100170CC+D8j ...
		xor	eax, eax
		jmp	loc_10017577
; ---------------------------------------------------------------------------

loc_10017401:				; CODE XREF: sub_100170CC+32Cj
		cmp	[ebp+var_30], esi
		jz	loc_10017539
		push	ebx		; int
		push	ebx		; int
		lea	eax, [ebp+cbMultiByte]
		push	eax		; int
		push	[ebp+lpMultiByteStr] ; int
		push	[ebp+var_30]	; UINT
		push	esi		; CodePage
		call	sub_10021469
		add	esp, 18h
		mov	[ebp+lpSrcStr],	eax
		cmp	eax, ebx
		jz	short loc_100173FA
		push	ebx		; cchDest
		push	ebx		; lpDestStr
		push	[ebp+cbMultiByte] ; cchSrc
		push	eax		; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:LCMapStringA
		mov	[ebp+var_28], eax
		cmp	eax, ebx
		jnz	short loc_10017446

loc_1001743F:				; CODE XREF: sub_100170CC+3F2j
					; sub_100170CC+427j
		xor	esi, esi
		jmp	loc_1001751E
; ---------------------------------------------------------------------------

loc_10017446:				; CODE XREF: sub_100170CC+371j
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		cmp	eax, ebx
		jle	short loc_10017483
		cmp	eax, 0FFFFFFE0h
		ja	short loc_10017483
		add	eax, 8
		cmp	eax, 400h
		ja	short loc_1001746D
		call	__alloca_probe_16
		mov	[ebp+ms_exc.old_esp], esp
		mov	eax, esp
		push	0CCCCh
		jmp	short loc_10017479
; ---------------------------------------------------------------------------

loc_1001746D:				; CODE XREF: sub_100170CC+38Ej
		push	0DDDDh
		push	eax
		call	sub_1000F5A0
		pop	ecx

loc_10017479:				; CODE XREF: sub_100170CC+39Fj
		push	eax
		call	sub_1001037C
		pop	ecx
		pop	ecx
		jmp	short loc_10017485
; ---------------------------------------------------------------------------

loc_10017483:				; CODE XREF: sub_100170CC+37Fj
					; sub_100170CC+384j
		xor	eax, eax

loc_10017485:				; CODE XREF: sub_100170CC+3B5j
		mov	edi, eax
		mov	[ebp+var_3C], edi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_100174AD
; ---------------------------------------------------------------------------

loc_10017493:				; DATA XREF: .rdata:stru_1002B638o
		xor	eax, eax	; Exception filter 0 for function 100170CC
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10017497:				; DATA XREF: .rdata:stru_1002B638o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100170CC
		call	sub_10021623
		xor	edi, edi
		mov	[ebp+var_3C], edi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	ebx, ebx

loc_100174AD:				; CODE XREF: sub_100170CC+3C5j
		cmp	edi, ebx
		jnz	short loc_100174D8
		push	[ebp+var_28]
		call	sub_1000F5A0
		pop	ecx
		mov	edi, eax
		cmp	edi, ebx
		jz	loc_1001743F
		push	[ebp+var_28]
		push	ebx
		push	edi
		call	sub_1000E0F0
		add	esp, 0Ch
		mov	[ebp+var_34], 1

loc_100174D8:				; CODE XREF: sub_100170CC+3E3j
		push	[ebp+var_28]	; cchDest
		push	edi		; lpDestStr
		push	[ebp+cbMultiByte] ; cchSrc
		push	[ebp+lpSrcStr]	; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:LCMapStringA
		mov	[ebp+var_28], eax
		cmp	eax, ebx
		jz	loc_1001743F
		push	[ebp+cchDest]	; int
		push	[ebp+lpDestStr]	; int
		lea	eax, [ebp+var_28]
		push	eax		; int
		push	edi		; int
		push	[ebp+CodePage]	; UINT
		push	[ebp+var_30]	; CodePage
		call	sub_10021469
		add	esp, 18h
		mov	esi, eax
		mov	[ebp+lpMem], esi
		neg	esi
		sbb	esi, esi
		and	esi, [ebp+var_28]

loc_1001751E:				; CODE XREF: sub_100170CC+375j
		cmp	[ebp+var_34], 0
		jz	short loc_1001752C
		push	edi		; lpMem
		call	sub_1000EE73
		jmp	short loc_10017536
; ---------------------------------------------------------------------------

loc_1001752C:				; CODE XREF: sub_100170CC+456j
		test	edi, edi
		jz	short loc_10017553
		push	edi
		call	sub_10010392

loc_10017536:				; CODE XREF: sub_100170CC+45Ej
		pop	ecx
		jmp	short loc_10017553
; ---------------------------------------------------------------------------

loc_10017539:				; CODE XREF: sub_100170CC+338j
		push	[ebp+cchDest]	; cchDest
		push	[ebp+lpDestStr]	; lpDestStr
		push	[ebp+cbMultiByte] ; cchSrc
		push	[ebp+lpMultiByteStr] ; lpSrcStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		call	ds:LCMapStringA
		mov	esi, eax

loc_10017553:				; CODE XREF: sub_100170CC+462j
					; sub_100170CC+46Bj
		cmp	[ebp+lpSrcStr],	0
		jz	short loc_10017562
		push	[ebp+lpSrcStr]	; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10017562:				; CODE XREF: sub_100170CC+48Bj
		mov	eax, [ebp+lpMem]
		test	eax, eax
		jz	short loc_10017575
		cmp	[ebp+lpDestStr], eax
		jz	short loc_10017575
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10017575:				; CODE XREF: sub_100170CC+49Bj
					; sub_100170CC+4A0j
		mov	eax, esi

loc_10017577:				; CODE XREF: sub_100170CC+2EEj
					; sub_100170CC+330j
		lea	esp, [ebp-4Ch]
		call	__SEH_epilog4_GS
		retn
sub_100170CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10017580(int,	LCID Locale, DWORD dwMapFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpDestStr, int cchDest, UINT CodePage, int)
sub_10017580	proc near		; CODE XREF: sub_1000FD34+E2p
					; sub_10011BFD+BCp ...

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
Locale		= dword	ptr  0Ch
dwMapFlags	= dword	ptr  10h
lpMultiByteStr	= dword	ptr  14h
cbMultiByte	= dword	ptr  18h
lpDestStr	= dword	ptr  1Ch
cchDest		= dword	ptr  20h
CodePage	= dword	ptr  24h
arg_20		= dword	ptr  28h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		push	[ebp+arg_20]	; int
		lea	eax, [ebp+var_10]
		push	[ebp+CodePage]	; CodePage
		push	[ebp+cchDest]	; cchDest
		push	[ebp+lpDestStr]	; lpDestStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	[ebp+dwMapFlags] ; dwMapFlags
		push	[ebp+Locale]	; Locale
		push	eax		; int
		call	sub_100170CC
		add	esp, 24h
		cmp	[ebp+var_4], 0
		jz	short locret_100175C4
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_100175C4:			; CODE XREF: sub_10017580+3Bj
		leave
		retn
sub_10017580	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100175C6	proc near		; CODE XREF: sub_1000FD34+95p
					; sub_10013BD0+44p ...

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		movzx	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx+0C8h]
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 8000h
		cmp	[ebp+var_4], 0
		jz	short locret_100175FC
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_100175FC:			; CODE XREF: sub_100175C6+2Dj
		leave
		retn
sub_100175C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100175FE	proc near		; CODE XREF: sub_1001829F+31p
					; sub_1001838C+19Ap

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_0]
		call	sub_100175C6
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_100175FE	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	103h
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	103h
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	1
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	2
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	2
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	4
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	4
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	80h
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	80h
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	8
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	8
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	10h
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	10h
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	107h
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	107h
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	157h
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	157h
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	117h
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	117h
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	20h
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	20h
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, 80h
		cmp	[ebp+8], ax
		sbb	eax, eax
		neg	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	107h
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10017836
		cmp	word ptr [ebp+8], 5Fh
		jz	short loc_10017836
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10017836:				; CODE XREF: .text:1001782Bj
					; .text:10017832j
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	107h
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001785C
		cmp	word ptr [ebp+8], 5Fh
		jz	short loc_1001785C
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001785C:				; CODE XREF: .text:10017851j
					; .text:10017858j
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+0Ch]
		push	103h
		push	dword ptr [ebp+8]
		call	sub_100217DF
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10017886
		cmp	word ptr [ebp+8], 5Fh
		jz	short loc_10017886
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10017886:				; CODE XREF: .text:1001787Bj
					; .text:10017882j
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	103h
		push	dword ptr [ebp+8]
		call	sub_10021869
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_100178AC
		cmp	word ptr [ebp+8], 5Fh
		jz	short loc_100178AC
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100178AC:				; CODE XREF: .text:100178A1j
					; .text:100178A8j
		xor	eax, eax
		inc	eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100178B1	proc near		; CODE XREF: sub_1000FE75+13Bp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		xor	edi, edi
		cmp	esi, edi
		jnz	short loc_100178DE
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		jmp	loc_100179D5
; ---------------------------------------------------------------------------

loc_100178DE:				; CODE XREF: sub_100178B1+Ej
		mov	eax, [esi+0Ch]
		test	al, 83h
		jz	loc_100179D5
		test	al, 40h
		jnz	loc_100179D5
		test	al, 2
		jz	short loc_10017900
		or	eax, 20h
		mov	[esi+0Ch], eax
		jmp	loc_100179D5
; ---------------------------------------------------------------------------

loc_10017900:				; CODE XREF: sub_100178B1+42j
		or	eax, 1
		mov	[esi+0Ch], eax
		test	eax, 10Ch
		jnz	short loc_10017916
		push	esi
		call	sub_10020EB6
		pop	ecx
		jmp	short loc_1001791B
; ---------------------------------------------------------------------------

loc_10017916:				; CODE XREF: sub_100178B1+5Aj
		mov	eax, [esi+8]
		mov	[esi], eax

loc_1001791B:				; CODE XREF: sub_100178B1+63j
		push	dword ptr [esi+18h] ; nNumberOfBytesToRead
		push	dword ptr [esi+8] ; lpWideCharStr
		push	esi
		call	sub_1001704B
		pop	ecx
		push	eax		; int
		call	sub_10021E88
		add	esp, 0Ch
		mov	[esi+4], eax
		cmp	eax, edi
		jz	loc_100179C5
		cmp	eax, 0FFFFFFFFh
		jz	loc_100179C5
		test	byte ptr [esi+0Ch], 82h
		jnz	short loc_1001799A
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10017985
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10017985
		push	esi
		call	sub_1001704B
		sar	eax, 5
		push	esi
		lea	edi, dword_1002F080[eax*4]
		call	sub_1001704B
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [edi]
		pop	ecx
		pop	ecx
		jmp	short loc_1001798A
; ---------------------------------------------------------------------------

loc_10017985:				; CODE XREF: sub_100178B1+A4j
					; sub_100178B1+B0j
		mov	eax, offset dword_1002DEE0

loc_1001798A:				; CODE XREF: sub_100178B1+D2j
		mov	al, [eax+4]
		and	al, 82h
		cmp	al, 82h
		jnz	short loc_1001799A
		or	dword ptr [esi+0Ch], 2000h

loc_1001799A:				; CODE XREF: sub_100178B1+98j
					; sub_100178B1+E0j
		cmp	dword ptr [esi+18h], 200h
		jnz	short loc_100179B8
		mov	eax, [esi+0Ch]
		test	al, 8
		jz	short loc_100179B8
		test	eax, 400h
		jnz	short loc_100179B8
		mov	dword ptr [esi+18h], 1000h

loc_100179B8:				; CODE XREF: sub_100178B1+F0j
					; sub_100178B1+F7j ...
		mov	ecx, [esi]
		dec	dword ptr [esi+4]
		movzx	eax, byte ptr [ecx]
		inc	ecx
		mov	[esi], ecx
		jmp	short loc_100179D8
; ---------------------------------------------------------------------------

loc_100179C5:				; CODE XREF: sub_100178B1+85j
					; sub_100178B1+8Ej
		neg	eax
		sbb	eax, eax
		and	eax, 10h
		add	eax, 10h
		or	[esi+0Ch], eax
		mov	[esi+4], edi

loc_100179D5:				; CODE XREF: sub_100178B1+28j
					; sub_100178B1+32j ...
		or	eax, 0FFFFFFFFh

loc_100179D8:				; CODE XREF: sub_100178B1+112j
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_100178B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100179DC	proc near		; CODE XREF: sub_10011438+C1p

StartupInfo	= _STARTUPINFOA	ptr -64h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	54h
		push	offset stru_1002B670
		call	__SEH_prolog4
		xor	esi, esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		lea	eax, [ebp+StartupInfo]
		push	eax		; lpStartupInfo
		call	ds:GetStartupInfoA
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		push	24h
		push	20h
		pop	edi
		push	edi
		call	sub_1000F496
		pop	ecx
		pop	ecx
		cmp	eax, esi
		jz	loc_10017C0D
		mov	dword_1002F080,	eax
		mov	uNumber, edi
		lea	ecx, [eax+480h]
		jmp	short loc_10017A4B
; ---------------------------------------------------------------------------

loc_10017A26:				; CODE XREF: sub_100179DC+71j
		mov	byte ptr [eax+4], 0
		or	dword ptr [eax], 0FFFFFFFFh
		mov	byte ptr [eax+5], 0Ah
		mov	[eax+8], esi
		mov	byte ptr [eax+6], 0Ah
		mov	byte ptr [eax+7], 0Ah
		add	eax, 24h
		mov	ecx, dword_1002F080
		add	ecx, 480h

loc_10017A4B:				; CODE XREF: sub_100179DC+48j
		cmp	eax, ecx
		jb	short loc_10017A26
		cmp	[ebp+StartupInfo.cbReserved2], si
		jz	loc_10017B53
		mov	eax, [ebp+StartupInfo.lpReserved2]
		cmp	eax, esi
		jz	loc_10017B53
		mov	edi, [eax]
		lea	ebx, [eax+4]
		lea	eax, [ebx+edi]
		mov	[ebp+var_1C], eax
		mov	eax, 800h
		cmp	edi, eax
		jl	short loc_10017A7A
		mov	edi, eax

loc_10017A7A:				; CODE XREF: sub_100179DC+9Aj
		xor	esi, esi
		inc	esi
		jmp	short loc_10017ACD
; ---------------------------------------------------------------------------

loc_10017A7F:				; CODE XREF: sub_100179DC+F7j
		push	24h
		push	20h
		call	sub_1000F496
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10017AD7
		lea	ecx, dword_1002F080[esi*4]
		mov	[ecx], eax
		add	uNumber, 20h
		lea	edx, [eax+480h]
		jmp	short loc_10017AC8
; ---------------------------------------------------------------------------

loc_10017AA6:				; CODE XREF: sub_100179DC+EEj
		mov	byte ptr [eax+4], 0
		or	dword ptr [eax], 0FFFFFFFFh
		mov	byte ptr [eax+5], 0Ah
		and	dword ptr [eax+8], 0
		mov	byte ptr [eax+6], 0Ah
		mov	byte ptr [eax+7], 0Ah
		add	eax, 24h
		mov	edx, [ecx]
		add	edx, 480h

loc_10017AC8:				; CODE XREF: sub_100179DC+C8j
		cmp	eax, edx
		jb	short loc_10017AA6
		inc	esi

loc_10017ACD:				; CODE XREF: sub_100179DC+A1j
		cmp	uNumber, edi
		jl	short loc_10017A7F
		jmp	short loc_10017ADD
; ---------------------------------------------------------------------------

loc_10017AD7:				; CODE XREF: sub_100179DC+B0j
		mov	edi, uNumber

loc_10017ADD:				; CODE XREF: sub_100179DC+F9j
		and	[ebp+var_20], 0
		test	edi, edi
		jle	short loc_10017B53

loc_10017AE5:				; CODE XREF: sub_100179DC+175j
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10017B46
		cmp	ecx, 0FFFFFFFEh
		jz	short loc_10017B46
		mov	al, [ebx]
		test	al, 1
		jz	short loc_10017B46
		test	al, 8
		jnz	short loc_10017B09
		push	ecx		; hFile
		call	ds:GetFileType
		test	eax, eax
		jz	short loc_10017B46

loc_10017B09:				; CODE XREF: sub_100179DC+120j
		mov	esi, [ebp+var_20]
		mov	eax, esi
		sar	eax, 5
		and	esi, 1Fh
		imul	esi, 24h
		add	esi, dword_1002F080[eax*4]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	[esi], eax
		mov	al, [ebx]
		mov	[esi+4], al
		push	0FA0h
		lea	eax, [esi+0Ch]
		push	eax
		call	sub_1001F928
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	loc_10017C0D
		or	dword ptr [esi+8], 4

loc_10017B46:				; CODE XREF: sub_100179DC+111j
					; sub_100179DC+116j ...
		inc	[ebp+var_20]
		inc	ebx
		add	[ebp+var_1C], 4
		cmp	[ebp+var_20], edi
		jl	short loc_10017AE5

loc_10017B53:				; CODE XREF: sub_100179DC+77j
					; sub_100179DC+82j ...
		xor	ebx, ebx

loc_10017B55:				; CODE XREF: sub_100179DC+20Dj
		mov	esi, ebx
		imul	esi, 24h
		add	esi, dword_1002F080
		mov	eax, [esi]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10017B72
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10017B72
		or	byte ptr [esi+4], 80h
		jmp	short loc_10017BE5
; ---------------------------------------------------------------------------

loc_10017B72:				; CODE XREF: sub_100179DC+189j
					; sub_100179DC+18Ej
		mov	byte ptr [esi+4], 81h
		test	ebx, ebx
		jnz	short loc_10017B7F
		push	0FFFFFFF6h
		pop	eax
		jmp	short loc_10017B89
; ---------------------------------------------------------------------------

loc_10017B7F:				; CODE XREF: sub_100179DC+19Cj
		mov	eax, ebx
		dec	eax
		neg	eax
		sbb	eax, eax
		add	eax, 0FFFFFFF5h

loc_10017B89:				; CODE XREF: sub_100179DC+1A1j
		push	eax		; nStdHandle
		call	ds:GetStdHandle
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jz	short loc_10017BDB
		test	edi, edi
		jz	short loc_10017BDB
		push	edi		; hFile
		call	ds:GetFileType
		test	eax, eax
		jz	short loc_10017BDB
		mov	[esi], edi
		and	eax, 0FFh
		cmp	eax, 2
		jnz	short loc_10017BB8
		or	byte ptr [esi+4], 40h
		jmp	short loc_10017BC1
; ---------------------------------------------------------------------------

loc_10017BB8:				; CODE XREF: sub_100179DC+1D4j
		cmp	eax, 3
		jnz	short loc_10017BC1
		or	byte ptr [esi+4], 8

loc_10017BC1:				; CODE XREF: sub_100179DC+1DAj
					; sub_100179DC+1DFj
		push	0FA0h
		lea	eax, [esi+0Ch]
		push	eax
		call	sub_1001F928
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10017C0D
		or	dword ptr [esi+8], 4
		jmp	short loc_10017BE5
; ---------------------------------------------------------------------------

loc_10017BDB:				; CODE XREF: sub_100179DC+1B9j
					; sub_100179DC+1BDj ...
		or	byte ptr [esi+4], 40h
		mov	dword ptr [esi], 0FFFFFFFEh

loc_10017BE5:				; CODE XREF: sub_100179DC+194j
					; sub_100179DC+1FDj
		inc	ebx
		cmp	ebx, 3
		jl	loc_10017B55
		push	uNumber		; uNumber
		call	ds:SetHandleCount
		xor	eax, eax
		jmp	short loc_10017C10
; ---------------------------------------------------------------------------

loc_10017BFF:				; DATA XREF: .rdata:stru_1002B670o
		xor	eax, eax	; Exception filter 0 for function 100179DC
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10017C03:				; DATA XREF: .rdata:stru_1002B670o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100179DC
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_10017C0D:				; CODE XREF: sub_100179DC+31j
					; sub_100179DC+160j ...
		or	eax, 0FFFFFFFFh

loc_10017C10:				; CODE XREF: sub_100179DC+221j
		call	__SEH_epilog4
		retn
sub_100179DC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017C16	proc near		; CODE XREF: sub_10011438:loc_10011532p
					; sub_10011438+12Bp
		mov	edi, edi
		push	esi
		push	edi
		mov	esi, offset dword_1002F080

loc_10017C1F:				; CODE XREF: sub_10017C16+49j
		mov	edi, [esi]
		test	edi, edi
		jz	short loc_10017C56
		lea	eax, [edi+480h]
		jmp	short loc_10017C47
; ---------------------------------------------------------------------------

loc_10017C2D:				; CODE XREF: sub_10017C16+33j
		test	byte ptr [edi+8], 4
		jz	short loc_10017C3D
		lea	eax, [edi+0Ch]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection

loc_10017C3D:				; CODE XREF: sub_10017C16+1Bj
		mov	eax, [esi]
		add	edi, 24h
		add	eax, 480h

loc_10017C47:				; CODE XREF: sub_10017C16+15j
		cmp	edi, eax
		jb	short loc_10017C2D
		push	dword ptr [esi]	; lpMem
		call	sub_1000EE73
		and	dword ptr [esi], 0
		pop	ecx

loc_10017C56:				; CODE XREF: sub_10017C16+Dj
		add	esi, 4
		cmp	esi, offset dword_1002F180
		jl	short loc_10017C1F
		pop	edi
		pop	esi
		retn
sub_10017C16	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017C64	proc near		; CODE XREF: sub_1000FFFD+AAp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, dword_1002EF94
		push	ebx
		xor	ebx, ebx
		push	esi
		mov	esi, [ebp+arg_4]
		mov	[ebp+var_4], eax
		mov	[ebp+var_C], ebx
		mov	[ebp+var_8], ebx
		mov	[ebp+var_10], ebx
		jmp	short loc_10017C87
; ---------------------------------------------------------------------------

loc_10017C86:				; CODE XREF: sub_10017C64+26j
		inc	esi

loc_10017C87:				; CODE XREF: sub_10017C64+20j
		cmp	byte ptr [esi],	20h
		jz	short loc_10017C86
		mov	al, [esi]
		cmp	al, 61h
		jz	short loc_10017CCB
		cmp	al, 72h
		jz	short loc_10017CC2
		cmp	al, 77h
		jz	short loc_10017CB9
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		xor	eax, eax
		jmp	loc_10017F05
; ---------------------------------------------------------------------------

loc_10017CB9:				; CODE XREF: sub_10017C64+34j
		mov	[ebp+arg_4], 301h
		jmp	short loc_10017CD2
; ---------------------------------------------------------------------------

loc_10017CC2:				; CODE XREF: sub_10017C64+30j
		or	[ebp+var_4], 1
		mov	[ebp+arg_4], ebx
		jmp	short loc_10017CD6
; ---------------------------------------------------------------------------

loc_10017CCB:				; CODE XREF: sub_10017C64+2Cj
		mov	[ebp+arg_4], 109h

loc_10017CD2:				; CODE XREF: sub_10017C64+5Cj
		or	[ebp+var_4], 2

loc_10017CD6:				; CODE XREF: sub_10017C64+65j
		xor	ecx, ecx
		inc	ecx
		inc	esi
		mov	al, [esi]
		push	edi
		cmp	al, bl
		jz	loc_10017E9F
		lea	edx, [ecx+7Fh]
		mov	edi, 4000h

loc_10017CED:				; CODE XREF: sub_10017C64+1B9j
		cmp	ecx, ebx
		jz	loc_10017E23
		movsx	eax, al
		cmp	eax, 53h
		jg	loc_10017DA3
		jz	loc_10017D91
		sub	eax, 20h
		jz	loc_10017E18
		sub	eax, 0Bh
		jz	short loc_10017D6B
		dec	eax
		jz	short loc_10017D5F
		sub	eax, 18h
		jz	short loc_10017D4C
		sub	eax, 0Ah
		jz	short loc_10017D44
		sub	eax, 4
		jnz	loc_10017EA8
		cmp	[ebp+var_8], ebx
		jnz	loc_10017E0D
		or	[ebp+arg_4], 10h
		mov	[ebp+var_8], 1
		jmp	loc_10017E18
; ---------------------------------------------------------------------------

loc_10017D44:				; CODE XREF: sub_10017C64+BCj
		or	[ebp+arg_4], edx
		jmp	loc_10017E18
; ---------------------------------------------------------------------------

loc_10017D4C:				; CODE XREF: sub_10017C64+B7j
		test	byte ptr [ebp+arg_4], 40h
		jnz	loc_10017E0D
		or	[ebp+arg_4], 40h
		jmp	loc_10017E18
; ---------------------------------------------------------------------------

loc_10017D5F:				; CODE XREF: sub_10017C64+B2j
		mov	[ebp+var_10], 1
		jmp	loc_10017E0D
; ---------------------------------------------------------------------------

loc_10017D6B:				; CODE XREF: sub_10017C64+AFj
		test	byte ptr [ebp+arg_4], 2
		jnz	loc_10017E0D
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFFFFEh
		or	eax, 2
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+var_4]
		and	eax, 0FFFFFFFCh
		or	eax, edx
		mov	[ebp+var_4], eax
		jmp	loc_10017E18
; ---------------------------------------------------------------------------

loc_10017D91:				; CODE XREF: sub_10017C64+9Dj
		cmp	[ebp+var_8], ebx
		jnz	short loc_10017E0D
		or	[ebp+arg_4], 20h
		mov	[ebp+var_8], 1
		jmp	short loc_10017E18
; ---------------------------------------------------------------------------

loc_10017DA3:				; CODE XREF: sub_10017C64+97j
		sub	eax, 54h
		jz	short loc_10017E04
		sub	eax, 0Eh
		jz	short loc_10017DF2
		dec	eax
		jz	short loc_10017DE1
		sub	eax, 0Bh
		jz	short loc_10017DCC
		sub	eax, 6
		jnz	loc_10017EA8
		test	[ebp+arg_4], 0C000h
		jnz	short loc_10017E0D
		or	[ebp+arg_4], edi
		jmp	short loc_10017E18
; ---------------------------------------------------------------------------

loc_10017DCC:				; CODE XREF: sub_10017C64+14Fj
		cmp	[ebp+var_C], ebx
		jnz	short loc_10017E0D
		and	[ebp+var_4], 0FFFFBFFFh
		mov	[ebp+var_C], 1
		jmp	short loc_10017E18
; ---------------------------------------------------------------------------

loc_10017DE1:				; CODE XREF: sub_10017C64+14Aj
		cmp	[ebp+var_C], ebx
		jnz	short loc_10017E0D
		or	[ebp+var_4], edi
		mov	[ebp+var_C], 1
		jmp	short loc_10017E18
; ---------------------------------------------------------------------------

loc_10017DF2:				; CODE XREF: sub_10017C64+147j
		test	[ebp+arg_4], 0C000h
		jnz	short loc_10017E0D
		or	[ebp+arg_4], 8000h
		jmp	short loc_10017E18
; ---------------------------------------------------------------------------

loc_10017E04:				; CODE XREF: sub_10017C64+142j
		test	[ebp+arg_4], 1000h
		jz	short loc_10017E11

loc_10017E0D:				; CODE XREF: sub_10017C64+CAj
					; sub_10017C64+ECj ...
		xor	ecx, ecx
		jmp	short loc_10017E18
; ---------------------------------------------------------------------------

loc_10017E11:				; CODE XREF: sub_10017C64+1A7j
		or	[ebp+arg_4], 1000h

loc_10017E18:				; CODE XREF: sub_10017C64+A6j
					; sub_10017C64+DBj ...
		inc	esi
		mov	al, [esi]
		cmp	al, bl
		jnz	loc_10017CED

loc_10017E23:				; CODE XREF: sub_10017C64+8Bj
		cmp	[ebp+var_10], ebx
		jz	short loc_10017E9F
		jmp	short loc_10017E2B
; ---------------------------------------------------------------------------

loc_10017E2A:				; CODE XREF: sub_10017C64+1CAj
		inc	esi

loc_10017E2B:				; CODE XREF: sub_10017C64+1C4j
		cmp	byte ptr [esi],	20h
		jz	short loc_10017E2A
		push	4
		push	esi
		push	offset aCcs	; "ccs="
		call	sub_10022B15
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10017EA8
		add	esi, 4
		push	offset aUtf8	; "UTF-8"
		push	esi
		call	sub_10022994
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10017E64
		add	esi, 5
		or	[ebp+arg_4], 40000h
		jmp	short loc_10017E9F
; ---------------------------------------------------------------------------

loc_10017E64:				; CODE XREF: sub_10017C64+1F2j
		push	offset aUtf16le	; "UTF-16LE"
		push	esi
		call	sub_10022994
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10017E81
		add	esi, 8
		or	[ebp+arg_4], 20000h
		jmp	short loc_10017E9F
; ---------------------------------------------------------------------------

loc_10017E81:				; CODE XREF: sub_10017C64+20Fj
		push	offset aUnicode	; "UNICODE"
		push	esi
		call	sub_10022994
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10017EA8
		add	esi, 7
		or	[ebp+arg_4], 10000h
		jmp	short loc_10017E9F
; ---------------------------------------------------------------------------

loc_10017E9E:				; CODE XREF: sub_10017C64+23Ej
		inc	esi

loc_10017E9F:				; CODE XREF: sub_10017C64+7Bj
					; sub_10017C64+1C2j ...
		cmp	byte ptr [esi],	20h
		jz	short loc_10017E9E
		cmp	[esi], bl
		jz	short loc_10017EC2

loc_10017EA8:				; CODE XREF: sub_10017C64+C1j
					; sub_10017C64+154j ...
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10017EE0
; ---------------------------------------------------------------------------

loc_10017EC2:				; CODE XREF: sub_10017C64+242j
		push	180h		; int
		push	[ebp+arg_8]	; int
		lea	eax, [ebp+var_10]
		push	[ebp+arg_4]	; int
		push	[ebp+lpFileName] ; lpFileName
		push	eax		; int
		call	sub_1002274E
		add	esp, 14h
		test	eax, eax
		jz	short loc_10017EE4

loc_10017EE0:				; CODE XREF: sub_10017C64+25Cj
		xor	eax, eax
		jmp	short loc_10017F04
; ---------------------------------------------------------------------------

loc_10017EE4:				; CODE XREF: sub_10017C64+27Aj
		mov	eax, [ebp+arg_C]
		inc	dword_1002E5E4
		mov	ecx, [ebp+var_4]
		mov	[eax+0Ch], ecx
		mov	ecx, [ebp+var_10]
		mov	[eax+4], ebx
		mov	[eax], ebx
		mov	[eax+8], ebx
		mov	[eax+1Ch], ebx
		mov	[eax+10h], ecx

loc_10017F04:				; CODE XREF: sub_10017C64+27Ej
		pop	edi

loc_10017F05:				; CODE XREF: sub_10017C64+50j
		pop	esi
		pop	ebx
		leave
		retn
sub_10017C64	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017F09	proc near		; CODE XREF: sub_1000FFFD+64p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	10h
		push	offset stru_1002B690
		call	__SEH_prolog4
		xor	ebx, ebx
		xor	edi, edi
		mov	[ebp+var_1C], edi
		push	1
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		xor	esi, esi

loc_10017F29:				; CODE XREF: sub_10017F09+85j
		mov	[ebp+var_20], esi
		cmp	esi, dword_100301E0
		jge	loc_10017FF9
		mov	eax, dword_1002F1D8
		lea	eax, [eax+esi*4]
		cmp	[eax], ebx
		jz	short loc_10017F94
		mov	eax, [eax]
		test	byte ptr [eax+0Ch], 83h
		jnz	short loc_10017F8D
		lea	eax, [esi-3]
		cmp	eax, 10h
		ja	short loc_10017F66
		lea	eax, [esi+10h]
		push	eax
		call	sub_10015204
		pop	ecx
		test	eax, eax
		jz	loc_10017FF9

loc_10017F66:				; CODE XREF: sub_10017F09+49j
		mov	eax, dword_1002F1D8
		push	dword ptr [eax+esi*4]
		push	esi
		call	sub_10010C85
		pop	ecx
		pop	ecx
		mov	eax, dword_1002F1D8
		mov	eax, [eax+esi*4]
		test	byte ptr [eax+0Ch], 83h
		jz	short loc_10017F90
		push	eax
		push	esi
		call	sub_10010CE2
		pop	ecx
		pop	ecx

loc_10017F8D:				; CODE XREF: sub_10017F09+41j
		inc	esi
		jmp	short loc_10017F29
; ---------------------------------------------------------------------------

loc_10017F90:				; CODE XREF: sub_10017F09+79j
		mov	edi, eax
		jmp	short loc_10017FF6
; ---------------------------------------------------------------------------

loc_10017F94:				; CODE XREF: sub_10017F09+39j
		shl	esi, 2
		push	38h
		call	sub_1000F5A0
		pop	ecx
		mov	ecx, dword_1002F1D8
		mov	[esi+ecx], eax
		mov	eax, dword_1002F1D8
		add	eax, esi
		cmp	[eax], ebx
		jz	short loc_10017FF9
		push	0FA0h
		mov	eax, [eax]
		add	eax, 20h
		push	eax
		call	sub_1001F928
		pop	ecx
		pop	ecx
		test	eax, eax
		mov	eax, dword_1002F1D8
		jnz	short loc_10017FE1
		push	dword ptr [esi+eax] ; lpMem
		call	sub_1000EE73
		pop	ecx
		mov	eax, dword_1002F1D8
		mov	[esi+eax], ebx
		jmp	short loc_10017FF9
; ---------------------------------------------------------------------------

loc_10017FE1:				; CODE XREF: sub_10017F09+C3j
		mov	eax, [esi+eax]
		add	eax, 20h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, dword_1002F1D8
		mov	edi, [esi+eax]

loc_10017FF6:				; CODE XREF: sub_10017F09+89j
		mov	[ebp+var_1C], edi

loc_10017FF9:				; CODE XREF: sub_10017F09+29j
					; sub_10017F09+57j ...
		cmp	edi, ebx
		jz	short loc_1001800F
		mov	[edi+4], ebx
		mov	[edi+0Ch], ebx
		mov	[edi+8], ebx
		mov	[edi], ebx
		mov	[edi+1Ch], ebx
		or	dword ptr [edi+10h], 0FFFFFFFFh

loc_1001800F:				; CODE XREF: sub_10017F09+F2j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10018026
; ---------------------------------------------------------------------------

loc_1001801B:				; CODE XREF: sub_10017F09+125j
		mov	eax, edi
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10018023:				; DATA XREF: .rdata:stru_1002B690o
		mov	edi, [ebp+var_1C] ; Finally handler 0 for function 10017F09

loc_10018026:				; CODE XREF: sub_10017F09+10Dj
		push	1
		call	sub_100151D0
		pop	ecx
		retn
sub_10017F09	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018030	proc near		; CODE XREF: sub_1000FFFD+9Ap
					; sub_100180C0+2Dp ...

var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		mov	edx, [esp+0Ch+arg_0]
		mov	eax, [esp+0Ch+arg_4]
		mov	ecx, [esp+0Ch+arg_8]
		push	ebp
		push	edx
		push	eax
		push	ecx
		push	ecx
		push	offset sub_100180C0
		push	large dword ptr	fs:0
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_20], eax
		mov	large fs:0, esp

loc_10018062:				; CODE XREF: sub_10018030+64j
					; sub_10018030+80j
		mov	eax, [esp+28h+arg_4]
		mov	ebx, [eax+8]
		mov	ecx, [esp+28h+arg_0]
		xor	ebx, [ecx]
		mov	esi, [eax+0Ch]
		cmp	esi, 0FFFFFFFEh
		jz	short loc_100180B2
		mov	edx, [esp+28h+arg_8]
		cmp	edx, 0FFFFFFFEh
		jz	short loc_10018084
		cmp	esi, edx
		jbe	short loc_100180B2

loc_10018084:				; CODE XREF: sub_10018030+4Ej
		lea	esi, [esi+esi*2]
		lea	ebx, [ebx+esi*4+10h]
		mov	ecx, [ebx]
		mov	[eax+0Ch], ecx
		cmp	dword ptr [ebx+4], 0
		jnz	short loc_10018062
		push	101h
		mov	eax, [ebx+8]
		call	sub_10022C45
		mov	ecx, 1
		mov	eax, [ebx+8]
		call	sub_10022C64
		jmp	short loc_10018062
; ---------------------------------------------------------------------------

loc_100180B2:				; CODE XREF: sub_10018030+45j
					; sub_10018030+52j
		pop	large dword ptr	fs:0
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10018030	endp


; =============== S U B	R O U T	I N E =======================================


sub_100180C0	proc near		; DATA XREF: sub_10018030+14o
					; .rdata:1002B1B4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_0]
		test	dword ptr [ecx+4], 6
		mov	eax, 1
		jz	short locret_10018105
		mov	eax, [esp+arg_4]
		mov	ecx, [eax+8]
		xor	ecx, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		push	ebp
		mov	ebp, [eax+18h]
		push	dword ptr [eax+0Ch]
		push	dword ptr [eax+10h]
		push	dword ptr [eax+14h]
		call	sub_10018030
		add	esp, 0Ch
		pop	ebp
		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_C]
		mov	[edx], eax
		mov	eax, 3

locret_10018105:			; CODE XREF: sub_100180C0+10j
		retn
sub_100180C0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ecx, [esp+8]
		mov	ebp, [ecx]
		push	dword ptr [ecx+1Ch]
		push	dword ptr [ecx+18h]
		push	dword ptr [ecx+28h]
		call	sub_10018030
		add	esp, 0Ch
		pop	ebp
		retn	4

; =============== S U B	R O U T	I N E =======================================


sub_10018122	proc near		; CODE XREF: sub_10014D30+89p
		push	ebp
		push	esi
		push	edi
		push	ebx
		mov	ebp, edx
		xor	eax, eax
		xor	ebx, ebx
		xor	edx, edx
		xor	esi, esi
		xor	edi, edi
		call	ecx
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_10018122	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018139	proc near		; CODE XREF: sub_10014D30+167p
		mov	ebp, edx
		mov	esi, ecx
		mov	eax, ecx
		push	1
		call	sub_10022C45
		xor	eax, eax
		xor	ebx, ebx
		xor	ecx, ecx
		xor	edx, edx
		xor	edi, edi
		jmp	esi
sub_10018139	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10018152(PVOID TargetFrame)
sub_10018152	proc near		; CODE XREF: sub_10014D30+116p
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		push	0		; ReturnValue
		push	0		; ExceptionRecord
		push	offset loc_10018167 ; TargetIp
		push	ecx		; TargetFrame
		call	RtlUnwind

loc_10018167:				; DATA XREF: sub_10018152+Ao
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10018152	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001816C	proc near		; CODE XREF: sub_10014D30+12Dp
					; sub_10014D30+182p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	edx
		push	ecx
		push	[esp+0Ch+arg_4]
		call	sub_10018030
		add	esp, 0Ch
		pop	ebp
		retn	8
sub_1001816C	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018190	proc near		; CODE XREF: sub_1001016B+3Dp
					; sub_100101E9+2Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	esi
		mov	eax, [esp+8+arg_C]
		or	eax, eax
		jnz	short loc_100181B2
		mov	ecx, [esp+8+arg_8]
		mov	eax, [esp+8+arg_4]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+8+arg_0]
		div	ecx
		mov	edx, ebx
		jmp	short loc_100181F3
; ---------------------------------------------------------------------------

loc_100181B2:				; CODE XREF: sub_10018190+8j
		mov	ecx, eax
		mov	ebx, [esp+8+arg_8]
		mov	edx, [esp+8+arg_4]
		mov	eax, [esp+8+arg_0]

loc_100181C0:				; CODE XREF: sub_10018190+3Aj
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_100181C0
		div	ebx
		mov	esi, eax
		mul	[esp+8+arg_C]
		mov	ecx, eax
		mov	eax, [esp+8+arg_8]
		mul	esi
		add	edx, ecx
		jb	short loc_100181EE
		cmp	edx, [esp+8+arg_4]
		ja	short loc_100181EE
		jb	short loc_100181EF
		cmp	eax, [esp+8+arg_0]
		jbe	short loc_100181EF

loc_100181EE:				; CODE XREF: sub_10018190+4Ej
					; sub_10018190+54j
		dec	esi

loc_100181EF:				; CODE XREF: sub_10018190+56j
					; sub_10018190+5Cj
		xor	edx, edx
		mov	eax, esi

loc_100181F3:				; CODE XREF: sub_10018190+20j
		pop	esi
		pop	ebx
		retn	10h
sub_10018190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018200	proc near		; CODE XREF: sub_1001016B+1Bp
					; sub_100101B0+1Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_C]
		or	ecx, eax
		mov	ecx, [esp+arg_8]
		jnz	short loc_10018219
		mov	eax, [esp+arg_0]
		mul	ecx
		retn	10h
; ---------------------------------------------------------------------------

loc_10018219:				; CODE XREF: sub_10018200+Ej
		push	ebx
		mul	ecx
		mov	ebx, eax
		mov	eax, [esp+4+arg_0]
		mul	[esp+4+arg_C]
		add	ebx, eax
		mov	eax, [esp+4+arg_0]
		mul	ecx
		add	edx, ebx
		pop	ebx
		retn	10h
sub_10018200	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018234	proc near		; CODE XREF: sub_1001048C+30p
					; sub_10010592+33p
		xor	eax, eax
		push	eax		; hTemplateFile
		push	eax		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	eax		; lpSecurityAttributes
		push	3		; dwShareMode
		push	0C0000000h	; dwDesiredAccess
		push	offset FileName	; "CONIN$"
		call	ds:CreateFileA
		mov	hConsoleInput, eax
		retn
sub_10018234	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018253	proc near		; CODE XREF: sub_10022C67+26p
		xor	eax, eax
		push	eax		; hTemplateFile
		push	eax		; dwFlagsAndAttributes
		push	3		; dwCreationDisposition
		push	eax		; lpSecurityAttributes
		push	3		; dwShareMode
		push	40000000h	; dwDesiredAccess
		push	offset aConout	; "CONOUT$"
		call	ds:CreateFileA
		mov	hObject, eax
		retn
sub_10018253	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018272	proc near		; DATA XREF: .rdata:10027204o
		mov	eax, hObject
		push	esi
		mov	esi, ds:CloseHandle
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001828B
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1001828B
		push	eax		; hObject
		call	esi ; CloseHandle

loc_1001828B:				; CODE XREF: sub_10018272+Fj
					; sub_10018272+14j
		mov	eax, hConsoleInput
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001829D
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1001829D
		push	eax		; hObject
		call	esi ; CloseHandle

loc_1001829D:				; CODE XREF: sub_10018272+21j
					; sub_10018272+26j
		pop	esi
		retn
sub_10018272	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001829F	proc near		; CODE XREF: sub_1001055B+23p
					; .text:10018336p

Buffer		= word ptr -4
arg_0		= byte ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		call	sub_10013828
		mov	esi, eax
		cmp	word ptr [esi+52h], 1
		mov	al, [ebp+arg_0]
		lea	edi, [esi+4Ch]
		mov	bl, al
		jnz	short loc_100182C3
		mov	[edi+1], al
		jmp	short loc_100182C5
; ---------------------------------------------------------------------------

loc_100182C3:				; CODE XREF: sub_1001829F+1Dj
		mov	[edi], al

loc_100182C5:				; CODE XREF: sub_1001829F+22j
		cmp	word ptr [esi+52h], 0
		jnz	short loc_100182DF
		movzx	eax, byte ptr [edi]
		push	eax
		call	sub_100175FE
		pop	ecx
		test	eax, eax
		jz	short loc_100182DF
		xor	eax, eax
		inc	eax
		jmp	short loc_1001830F
; ---------------------------------------------------------------------------

loc_100182DF:				; CODE XREF: sub_1001829F+2Bj
					; sub_1001829F+39j
		movzx	eax, word ptr [esi+52h]
		inc	eax
		push	eax		; int
		lea	eax, [ebp+Buffer]
		push	edi		; lpMultiByteStr
		push	eax		; lpWideCharStr
		call	sub_10022F33
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001830A
		push	dword ptr [ebp+Buffer] ; Buffer
		call	sub_10022C67
		pop	ecx
		mov	ecx, 0FFFFh
		cmp	ax, cx
		jnz	short loc_1001830D

loc_1001830A:				; CODE XREF: sub_1001829F+56j
		or	bl, 0FFh

loc_1001830D:				; CODE XREF: sub_1001829F+69j
		xor	eax, eax

loc_1001830F:				; CODE XREF: sub_1001829F+3Ej
		pop	edi
		mov	[esi+52h], ax
		pop	esi
		movzx	eax, bl
		pop	ebx
		leave
		retn
sub_1001829F	endp

; ---------------------------------------------------------------------------
		push	0Ch
		push	offset dword_1002B6B0
		call	__SEH_prolog4
		push	3
		call	sub_100152C7
		pop	ecx
		and	dword ptr [ebp-4], 0
		push	dword ptr [ebp+8]
		call	sub_1001829F
		pop	ecx
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10018354
		mov	eax, [ebp-1Ch]
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10018354	proc near		; CODE XREF: .text:10018346p
					; DATA XREF: .rdata:1002B6C8o
		push	3
		call	sub_100151D0
		pop	ecx
		retn
sub_10018354	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000016 BYTES: COLLAPSED FUNCTION __alloca_probe_16]
; [00000016 BYTES: COLLAPSED FUNCTION __alloca_probe_8]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001838C(int,	int, DWORD nNumberOfBytesToWrite)
sub_1001838C	proc near		; CODE XREF: sub_10018A68+9Ap
					; sub_10024840+BDp

CodePage	= dword	ptr -594h
var_590		= dword	ptr -590h
Mode		= dword	ptr -58Ch
var_588		= dword	ptr -588h
NumberOfBytesWritten= dword ptr	-584h
var_580		= dword	ptr -580h
var_57C		= dword	ptr -57Ch
var_578		= dword	ptr -578h
lpBuffer	= dword	ptr -574h
var_570		= dword	ptr -570h
WideCharStr	= word ptr -56Ch
var_568		= dword	ptr -568h
Buffer		= byte ptr -564h
var_410		= byte ptr -410h
var_160		= word ptr -160h
MultiByteStr	= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
nNumberOfBytesToWrite= dword ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 594h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		push	esi
		xor	esi, esi
		mov	[ebp+lpBuffer],	eax
		mov	[ebp+var_570], esi
		mov	[ebp+var_578], esi
		cmp	[ebp+nNumberOfBytesToWrite], esi
		jnz	short loc_100183C5
		xor	eax, eax
		jmp	loc_10018A5B
; ---------------------------------------------------------------------------

loc_100183C5:				; CODE XREF: sub_1001838C+30j
		cmp	eax, esi
		jnz	short loc_100183F0
		call	sub_10014C05
		mov	[eax], esi
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	loc_10018A5B
; ---------------------------------------------------------------------------

loc_100183F0:				; CODE XREF: sub_1001838C+3Bj
		mov	esi, [ebp+arg_0]
		push	ebx
		mov	ebx, esi
		and	ebx, 1Fh
		imul	ebx, 24h
		mov	eax, esi
		sar	eax, 5
		push	edi
		lea	edi, dword_1002F080[eax*4]
		mov	eax, [edi]
		add	eax, ebx
		mov	ecx, [eax+8]
		and	ecx, 3
		mov	[ebp+var_580], edi
		mov	[ebp+CodePage],	ebx
		mov	[ebp+var_588], ecx
		cmp	ecx, 2
		jz	short loc_1001842F
		cmp	ecx, 1
		jnz	short loc_1001845F

loc_1001842F:				; CODE XREF: sub_1001838C+9Cj
		mov	ecx, [ebp+nNumberOfBytesToWrite]
		not	ecx
		test	cl, 1
		jnz	short loc_1001845F
		call	sub_10014C05
		xor	esi, esi
		mov	[eax], esi
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		jmp	loc_10018A4E
; ---------------------------------------------------------------------------

loc_1001845F:				; CODE XREF: sub_1001838C+A1j
					; sub_1001838C+ABj
		test	byte ptr [eax+4], 20h
		jz	short loc_10018474
		push	2		; dwMoveMethod
		push	0		; int
		push	0		; int
		push	esi		; int
		call	sub_10020D18
		add	esp, 10h

loc_10018474:				; CODE XREF: sub_1001838C+D7j
		push	esi
		call	sub_1001D23E
		pop	ecx
		test	eax, eax
		jz	loc_100186E0
		mov	eax, [edi]
		test	byte ptr [ebx+eax+4], 80h
		jz	loc_100186E0
		call	sub_10013828
		mov	eax, [eax+6Ch]
		xor	ecx, ecx
		cmp	[eax+14h], ecx
		lea	eax, [ebp+Mode]
		setz	cl
		push	eax		; lpMode
		mov	eax, [edi]
		push	dword ptr [ebx+eax] ; hConsoleHandle
		mov	esi, ecx
		call	ds:GetConsoleMode
		test	eax, eax
		jz	loc_100186E0
		test	esi, esi
		jz	short loc_100184CD
		cmp	[ebp+var_588], 0
		jz	loc_100186E0

loc_100184CD:				; CODE XREF: sub_1001838C+132j
		call	ds:GetConsoleCP
		and	[ebp+NumberOfBytesWritten], 0
		cmp	[ebp+nNumberOfBytesToWrite], 0
		mov	esi, [ebp+lpBuffer]
		mov	[ebp+CodePage],	eax
		mov	[ebp+var_590], esi
		jbe	loc_100189E7
		and	[ebp+var_568], 0
		jmp	short loc_10018505
; ---------------------------------------------------------------------------

loc_100184FF:				; CODE XREF: sub_1001838C+349j
		mov	esi, [ebp+var_590]

loc_10018505:				; CODE XREF: sub_1001838C+171j
		mov	eax, [ebp+var_588]
		test	eax, eax
		jnz	loc_10018640
		mov	al, [esi]
		xor	ecx, ecx
		cmp	al, 0Ah
		setz	cl
		movsx	eax, al
		push	eax
		mov	[ebp+Mode], ecx
		call	sub_100175FE
		pop	ecx
		test	eax, eax
		jnz	short loc_1001854D
		push	1		; int
		lea	eax, [ebp+WideCharStr]
		push	esi		; lpMultiByteStr
		push	eax		; lpWideCharStr
		call	sub_10022F33
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	loc_100189DD
		jmp	short loc_10018583
; ---------------------------------------------------------------------------

loc_1001854D:				; CODE XREF: sub_1001838C+1A2j
		mov	eax, [ebp+lpBuffer]
		sub	eax, esi
		add	eax, [ebp+nNumberOfBytesToWrite]
		cmp	eax, 1
		jbe	loc_100189DD
		push	2		; int
		lea	eax, [ebp+WideCharStr]
		push	esi		; lpMultiByteStr
		push	eax		; lpWideCharStr
		call	sub_10022F33
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	loc_100189DD
		inc	esi
		inc	[ebp+var_568]

loc_10018583:				; CODE XREF: sub_1001838C+1BFj
		xor	eax, eax
		push	eax		; lpUsedDefaultChar
		push	eax		; lpDefaultChar
		push	5		; cbMultiByte
		lea	ecx, [ebp+MultiByteStr]
		push	ecx		; lpMultiByteStr
		push	1		; cchWideChar
		lea	ecx, [ebp+WideCharStr]
		push	ecx		; lpWideCharStr
		push	eax		; dwFlags
		push	[ebp+CodePage]	; CodePage
		inc	esi
		inc	[ebp+var_568]
		mov	[ebp+var_590], esi
		call	ds:WideCharToMultiByte
		mov	esi, eax
		test	esi, esi
		jz	loc_100189DD
		push	0		; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nNumberOfBytesToWrite
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpBuffer
		mov	eax, [edi]
		push	dword ptr [ebx+eax] ; hFile
		call	ds:WriteFile
		test	eax, eax
		jz	loc_100189D1
		mov	eax, [ebp+NumberOfBytesWritten]
		add	[ebp+var_570], eax
		cmp	eax, esi
		jl	loc_100189DD
		cmp	[ebp+Mode], 0
		jz	loc_100186CC
		push	0		; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	1		; nNumberOfBytesToWrite
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpBuffer
		mov	eax, [edi]
		mov	[ebp+MultiByteStr], 0Dh
		push	dword ptr [ebx+eax] ; hFile
		call	ds:WriteFile
		test	eax, eax
		jz	loc_100189D1
		cmp	[ebp+NumberOfBytesWritten], 1
		jl	loc_100189DD
		inc	[ebp+var_578]
		inc	[ebp+var_570]
		jmp	loc_100186CC
; ---------------------------------------------------------------------------

loc_10018640:				; CODE XREF: sub_1001838C+181j
		cmp	eax, 1
		jz	short loc_1001864A
		cmp	eax, 2
		jnz	short loc_10018671

loc_1001864A:				; CODE XREF: sub_1001838C+2B7j
		movzx	ecx, word ptr [esi]
		xor	edx, edx
		cmp	cx, 0Ah
		setz	dl
		inc	esi
		inc	esi
		add	[ebp+var_568], 2
		mov	dword ptr [ebp+WideCharStr], ecx
		mov	[ebp+var_590], esi
		mov	[ebp+Mode], edx

loc_10018671:				; CODE XREF: sub_1001838C+2BCj
		cmp	eax, 1
		jz	short loc_1001867B
		cmp	eax, 2
		jnz	short loc_100186CC

loc_1001867B:				; CODE XREF: sub_1001838C+2E8j
		push	dword ptr [ebp+WideCharStr] ; Buffer
		call	sub_10022C67
		pop	ecx
		cmp	ax, [ebp+WideCharStr]
		jnz	loc_100189D1
		inc	[ebp+var_570]
		cmp	[ebp+Mode], 0
		jz	short loc_100186CC
		push	0Dh
		pop	eax
		push	eax		; Buffer
		mov	dword ptr [ebp+WideCharStr], eax
		call	sub_10022C67
		pop	ecx
		cmp	ax, [ebp+WideCharStr]
		jnz	loc_100189D1
		inc	[ebp+var_570]
		inc	[ebp+var_578]

loc_100186CC:				; CODE XREF: sub_1001838C+26Aj
					; sub_1001838C+2AFj ...
		mov	eax, [ebp+nNumberOfBytesToWrite]
		cmp	[ebp+var_568], eax
		jb	loc_100184FF
		jmp	loc_100189DD
; ---------------------------------------------------------------------------

loc_100186E0:				; CODE XREF: sub_1001838C+F1j
					; sub_1001838C+FEj ...
		mov	eax, [edi]
		add	eax, ebx
		test	byte ptr [eax+4], 80h
		jz	loc_1001899E
		xor	eax, eax
		mov	dword ptr [ebp+WideCharStr], eax
		cmp	[ebp+var_588], eax
		jnz	loc_100187BD
		mov	ecx, [ebp+lpBuffer]
		mov	[ebp+var_568], ecx
		cmp	[ebp+nNumberOfBytesToWrite], eax
		jbe	loc_10018A1D

loc_10018717:				; CODE XREF: sub_1001838C+426j
		mov	ecx, [ebp+var_568]
		xor	esi, esi
		sub	ecx, [ebp+lpBuffer]
		lea	eax, [ebp+Buffer]

loc_1001872B:				; CODE XREF: sub_1001838C+3D3j
		cmp	ecx, [ebp+nNumberOfBytesToWrite]
		jnb	short loc_10018761
		mov	edx, [ebp+var_568]
		inc	[ebp+var_568]
		mov	dl, [edx]
		inc	ecx
		cmp	dl, 0Ah
		jnz	short loc_1001874F
		inc	[ebp+var_578]
		mov	byte ptr [eax],	0Dh
		inc	eax
		inc	esi

loc_1001874F:				; CODE XREF: sub_1001838C+3B6j
		mov	edi, [ebp+var_580]
		mov	[eax], dl
		inc	eax
		inc	esi
		cmp	esi, 400h
		jb	short loc_1001872B

loc_10018761:				; CODE XREF: sub_1001838C+3A2j
		mov	esi, eax
		lea	eax, [ebp+Buffer]
		sub	esi, eax
		push	0		; lpOverlapped
		lea	eax, [ebp+var_57C]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nNumberOfBytesToWrite
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	eax, [edi]
		push	dword ptr [ebx+eax] ; hFile
		call	ds:WriteFile
		test	eax, eax
		jz	loc_100189D1
		mov	eax, [ebp+var_57C]
		add	[ebp+var_570], eax
		cmp	eax, esi
		jl	loc_100189DD
		mov	eax, [ebp+var_568]
		sub	eax, [ebp+lpBuffer]
		cmp	eax, [ebp+nNumberOfBytesToWrite]
		jb	loc_10018717
		jmp	loc_100189DD
; ---------------------------------------------------------------------------

loc_100187BD:				; CODE XREF: sub_1001838C+370j
		cmp	[ebp+var_588], 2
		jnz	loc_10018893
		mov	edi, [ebp+lpBuffer]
		cmp	[ebp+nNumberOfBytesToWrite], eax
		jbe	loc_10018A1D

loc_100187D9:				; CODE XREF: sub_1001838C+4FCj
		mov	ecx, edi
		xor	esi, esi
		sub	ecx, [ebp+lpBuffer]
		lea	eax, [ebp+Buffer]

loc_100187E9:				; CODE XREF: sub_1001838C+49Bj
		cmp	ecx, [ebp+nNumberOfBytesToWrite]
		jnb	short loc_1001882D
		movzx	edx, word ptr [edi]
		inc	edi
		inc	edi
		inc	ecx
		inc	ecx
		cmp	dx, 0Ah
		jnz	short loc_1001881A
		cmp	esi, 3FDh
		ja	short loc_1001882B
		add	[ebp+var_578], 2
		push	0Dh
		pop	ebx
		mov	[eax], bx
		mov	ebx, [ebp+CodePage]
		inc	eax
		inc	eax
		inc	esi
		inc	esi

loc_1001881A:				; CODE XREF: sub_1001838C+46Dj
		mov	[eax], dx
		inc	eax
		inc	eax
		inc	esi
		inc	esi
		cmp	esi, 3FFh
		jb	short loc_100187E9
		jmp	short loc_1001882D
; ---------------------------------------------------------------------------

loc_1001882B:				; CODE XREF: sub_1001838C+475j
		dec	edi
		dec	edi

loc_1001882D:				; CODE XREF: sub_1001838C+460j
					; sub_1001838C+49Dj
		mov	esi, eax
		lea	eax, [ebp+Buffer]
		sub	esi, eax
		push	0		; lpOverlapped
		lea	eax, [ebp+var_57C]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nNumberOfBytesToWrite
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	eax, [ebp+var_580]
		mov	eax, [eax]
		push	dword ptr [ebx+eax] ; hFile
		call	ds:WriteFile
		test	eax, eax
		jz	loc_100189D1
		mov	eax, [ebp+var_57C]
		add	[ebp+var_570], eax
		cmp	eax, esi
		jl	loc_100189DD
		test	eax, eax
		jz	loc_100189DD
		mov	eax, edi
		sub	eax, [ebp+lpBuffer]
		cmp	eax, [ebp+nNumberOfBytesToWrite]
		jb	loc_100187D9
		jmp	loc_100189DD
; ---------------------------------------------------------------------------

loc_10018893:				; CODE XREF: sub_1001838C+438j
		mov	ecx, [ebp+lpBuffer]
		mov	[ebp+var_568], ecx
		cmp	[ebp+nNumberOfBytesToWrite], eax
		jbe	loc_10018A1D

loc_100188A8:				; CODE XREF: sub_1001838C+60Aj
		mov	ecx, [ebp+var_568]
		xor	esi, esi
		sub	ecx, [ebp+lpBuffer]
		lea	eax, [ebp+var_160]

loc_100188BC:				; CODE XREF: sub_1001838C+56Cj
		cmp	ecx, [ebp+nNumberOfBytesToWrite]
		jnb	short loc_10018903
		mov	edx, [ebp+var_568]
		add	[ebp+var_568], 2
		movzx	edx, word ptr [edx]
		inc	ecx
		inc	ecx
		cmp	dx, 0Ah
		jnz	short loc_100188EB
		cmp	esi, 150h
		ja	short loc_100188FC
		push	0Dh
		pop	edi
		mov	[eax], di
		inc	eax
		inc	eax
		inc	esi
		inc	esi

loc_100188EB:				; CODE XREF: sub_1001838C+54Bj
		mov	[eax], dx
		inc	eax
		inc	eax
		inc	esi
		inc	esi
		cmp	esi, 152h
		jb	short loc_100188BC
		jmp	short loc_10018903
; ---------------------------------------------------------------------------

loc_100188FC:				; CODE XREF: sub_1001838C+553j
		sub	[ebp+var_568], 2

loc_10018903:				; CODE XREF: sub_1001838C+533j
					; sub_1001838C+56Ej
		xor	esi, esi
		push	esi		; lpUsedDefaultChar
		push	esi		; lpDefaultChar
		push	2ABh		; cbMultiByte
		lea	ecx, [ebp+var_410]
		push	ecx		; lpMultiByteStr
		lea	ecx, [ebp+var_160]
		sub	eax, ecx
		cdq
		sub	eax, edx
		sar	eax, 1
		push	eax		; cchWideChar
		mov	eax, ecx
		push	eax		; lpWideCharStr
		push	esi		; dwFlags
		push	0FDE9h		; CodePage
		call	ds:WideCharToMultiByte
		mov	edi, eax
		cmp	edi, esi
		jz	loc_100189D1

loc_1001893A:				; CODE XREF: sub_1001838C+5E1j
		push	0		; lpOverlapped
		lea	eax, [ebp+var_57C]
		push	eax		; lpNumberOfBytesWritten
		mov	eax, edi
		sub	eax, esi
		push	eax		; nNumberOfBytesToWrite
		lea	eax, [ebp+esi+var_410]
		push	eax		; lpBuffer
		mov	eax, [ebp+var_580]
		mov	eax, [eax]
		push	dword ptr [ebx+eax] ; hFile
		call	ds:WriteFile
		test	eax, eax
		jz	short loc_10018971
		add	esi, [ebp+var_57C]
		cmp	edi, esi
		jg	short loc_1001893A
		jmp	short loc_1001897D
; ---------------------------------------------------------------------------

loc_10018971:				; CODE XREF: sub_1001838C+5D7j
		call	ds:GetLastError
		mov	dword ptr [ebp+WideCharStr], eax

loc_1001897D:				; CODE XREF: sub_1001838C+5E3j
		cmp	edi, esi
		jg	short loc_100189DD
		mov	eax, [ebp+var_568]
		sub	eax, [ebp+lpBuffer]
		mov	[ebp+var_570], eax
		cmp	eax, [ebp+nNumberOfBytesToWrite]
		jb	loc_100188A8
		jmp	short loc_100189DD
; ---------------------------------------------------------------------------

loc_1001899E:				; CODE XREF: sub_1001838C+35Cj
		push	0		; lpOverlapped
		lea	ecx, [ebp+var_57C]
		push	ecx		; lpNumberOfBytesWritten
		push	[ebp+nNumberOfBytesToWrite] ; nNumberOfBytesToWrite
		push	[ebp+lpBuffer]	; lpBuffer
		push	dword ptr [eax]	; hFile
		call	ds:WriteFile
		test	eax, eax
		jz	short loc_100189D1
		mov	eax, [ebp+var_57C]
		and	dword ptr [ebp+WideCharStr], 0
		mov	[ebp+var_570], eax
		jmp	short loc_100189DD
; ---------------------------------------------------------------------------

loc_100189D1:				; CODE XREF: sub_1001838C+249j
					; sub_1001838C+290j ...
		call	ds:GetLastError
		mov	dword ptr [ebp+WideCharStr], eax

loc_100189DD:				; CODE XREF: sub_1001838C+1B9j
					; sub_1001838C+1CFj ...
		mov	eax, [ebp+var_570]
		test	eax, eax
		jnz	short loc_10018A53

loc_100189E7:				; CODE XREF: sub_1001838C+164j
		cmp	dword ptr [ebp+WideCharStr], 0
		jz	short loc_10018A1D
		push	5
		pop	esi
		cmp	dword ptr [ebp+WideCharStr], esi
		jnz	short loc_10018A0F
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		call	sub_10014C05
		mov	[eax], esi
		jmp	short loc_10018A4E
; ---------------------------------------------------------------------------

loc_10018A0F:				; CODE XREF: sub_1001838C+66Dj
		push	dword ptr [ebp+WideCharStr]
		call	sub_10014C18
		pop	ecx
		jmp	short loc_10018A4E
; ---------------------------------------------------------------------------

loc_10018A1D:				; CODE XREF: sub_1001838C+385j
					; sub_1001838C+447j ...
		mov	eax, [ebp+var_580]
		mov	eax, [eax]
		test	byte ptr [ebx+eax+4], 40h
		jz	short loc_10018A3B
		mov	eax, [ebp+lpBuffer]
		cmp	byte ptr [eax],	1Ah
		jnz	short loc_10018A3B
		xor	eax, eax
		jmp	short loc_10018A59
; ---------------------------------------------------------------------------

loc_10018A3B:				; CODE XREF: sub_1001838C+69Ej
					; sub_1001838C+6A9j
		call	sub_10014BF2
		mov	dword ptr [eax], 1Ch
		call	sub_10014C05
		and	dword ptr [eax], 0

loc_10018A4E:				; CODE XREF: sub_1001838C+CEj
					; sub_1001838C+681j ...
		or	eax, 0FFFFFFFFh
		jmp	short loc_10018A59
; ---------------------------------------------------------------------------

loc_10018A53:				; CODE XREF: sub_1001838C+659j
		sub	eax, [ebp+var_578]

loc_10018A59:				; CODE XREF: sub_1001838C+6ADj
					; sub_1001838C+6C5j
		pop	edi
		pop	ebx

loc_10018A5B:				; CODE XREF: sub_1001838C+34j
					; sub_1001838C+5Fj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1001838C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10018A68(int,	int, DWORD nNumberOfBytesToWrite)
sub_10018A68	proc near		; CODE XREF: sub_100107BA+36p
					; sub_10016BC8+BBp ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
nNumberOfBytesToWrite= dword ptr  10h

		push	10h
		push	offset stru_1002B6D0
		call	__SEH_prolog4
		mov	eax, [ebp+arg_0]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10018A97
		call	sub_10014C05
		and	dword ptr [eax], 0
		call	sub_10014BF2
		mov	dword ptr [eax], 9

loc_10018A8F:				; CODE XREF: sub_10018A68+5Cj
		or	eax, 0FFFFFFFFh
		jmp	loc_10018B34
; ---------------------------------------------------------------------------

loc_10018A97:				; CODE XREF: sub_10018A68+12j
		xor	edi, edi
		cmp	eax, edi
		jl	short loc_10018AA5
		cmp	eax, uNumber
		jb	short loc_10018AC6

loc_10018AA5:				; CODE XREF: sub_10018A68+33j
					; sub_10018A68+7Cj
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10018A8F
; ---------------------------------------------------------------------------

loc_10018AC6:				; CODE XREF: sub_10018A68+3Bj
		mov	ecx, eax
		sar	ecx, 5
		lea	ebx, dword_1002F080[ecx*4]
		mov	esi, eax
		and	esi, 1Fh
		imul	esi, 24h
		mov	ecx, [ebx]
		movsx	ecx, byte ptr [ecx+esi+4]
		and	ecx, 1
		jz	short loc_10018AA5
		push	eax
		call	sub_1002109E
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebx]
		test	byte ptr [eax+esi+4], 1
		jz	short loc_10018B0F
		push	[ebp+nNumberOfBytesToWrite] ; nNumberOfBytesToWrite
		push	[ebp+arg_4]	; int
		push	[ebp+arg_0]	; int
		call	sub_1001838C
		add	esp, 0Ch
		mov	[ebp+var_1C], eax
		jmp	short loc_10018B25
; ---------------------------------------------------------------------------

loc_10018B0F:				; CODE XREF: sub_10018A68+8Fj
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		call	sub_10014C05
		mov	[eax], edi
		or	[ebp+var_1C], 0FFFFFFFFh

loc_10018B25:				; CODE XREF: sub_10018A68+A5j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10018B3A	; Finally handler 0 for	function 10018A68
; ---------------------------------------------------------------------------

loc_10018B31:				; CODE XREF: sub_10018A68+DBj
		mov	eax, [ebp+var_1C]

loc_10018B34:				; CODE XREF: sub_10018A68+2Aj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10018B3A:				; CODE XREF: sub_10018A68+C4j
					; DATA XREF: .rdata:stru_1002B6D0o
		push	[ebp+arg_0]	; Finally handler 0 for	function 10018A68
		call	sub_1002113F
		pop	ecx
		retn
sub_10018A68	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018B44	proc near		; CODE XREF: sub_10010822+36p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	10h
		push	offset stru_1002B6F0
		call	__SEH_prolog4
		mov	eax, [ebp+arg_0]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10018B6B
		call	sub_10014BF2
		mov	dword ptr [eax], 9

loc_10018B63:				; CODE XREF: sub_10018B44+4Dj
		or	eax, 0FFFFFFFFh
		jmp	loc_10018C15
; ---------------------------------------------------------------------------

loc_10018B6B:				; CODE XREF: sub_10018B44+12j
		xor	ebx, ebx
		cmp	eax, ebx
		jl	short loc_10018B79
		cmp	eax, uNumber
		jb	short loc_10018B93

loc_10018B79:				; CODE XREF: sub_10018B44+2Bj
					; sub_10018B44+6Dj
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10018B63
; ---------------------------------------------------------------------------

loc_10018B93:				; CODE XREF: sub_10018B44+33j
		mov	ecx, eax
		sar	ecx, 5
		lea	edi, dword_1002F080[ecx*4]
		mov	esi, eax
		and	esi, 1Fh
		imul	esi, 24h
		mov	ecx, [edi]
		movsx	ecx, byte ptr [esi+ecx+4]
		and	ecx, 1
		jz	short loc_10018B79
		push	eax
		call	sub_1002109E
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		mov	eax, [edi]
		test	byte ptr [esi+eax+4], 1
		jz	short loc_10018BF7
		push	[ebp+arg_0]
		call	sub_1002100C
		pop	ecx
		push	eax		; hFile
		call	ds:FlushFileBuffers
		test	eax, eax
		jnz	short loc_10018BE5
		call	ds:GetLastError
		mov	[ebp+var_1C], eax
		jmp	short loc_10018BE8
; ---------------------------------------------------------------------------

loc_10018BE5:				; CODE XREF: sub_10018B44+94j
		mov	[ebp+var_1C], ebx

loc_10018BE8:				; CODE XREF: sub_10018B44+9Fj
		cmp	[ebp+var_1C], ebx
		jz	short loc_10018C06
		call	sub_10014C05
		mov	ecx, [ebp+var_1C]
		mov	[eax], ecx

loc_10018BF7:				; CODE XREF: sub_10018B44+80j
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		or	[ebp+var_1C], 0FFFFFFFFh

loc_10018C06:				; CODE XREF: sub_10018B44+A7j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10018C1B	; Finally handler 0 for	function 10018B44
; ---------------------------------------------------------------------------

loc_10018C12:				; CODE XREF: sub_10018B44+E0j
		mov	eax, [ebp+var_1C]

loc_10018C15:				; CODE XREF: sub_10018B44+22j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10018C1B:				; CODE XREF: sub_10018B44+C9j
					; DATA XREF: .rdata:stru_1002B6F0o
		push	[ebp+arg_0]	; Finally handler 0 for	function 10018B44
		call	sub_1002113F
		pop	ecx
		retn
sub_10018B44	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018C25	proc near		; CODE XREF: sub_10018D73+16p
					; sub_10018D93+16p ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	0Ch
		push	offset stru_1002B710
		call	__SEH_prolog4
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		xor	eax, eax
		mov	esi, [ebp+arg_4]
		cmp	esi, ebx
		setnz	al
		cmp	eax, ebx
		jnz	short loc_10018C64

loc_10018C44:				; CODE XREF: sub_10018C25+49j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	loc_10018D63
; ---------------------------------------------------------------------------

loc_10018C64:				; CODE XREF: sub_10018C25+1Dj
		xor	eax, eax
		cmp	[ebp+arg_8], ebx
		setnz	al
		cmp	eax, ebx
		jz	short loc_10018C44
		mov	[ebp+arg_4], esi
		push	esi
		call	sub_10010C50
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		test	byte ptr [esi+0Ch], 40h
		jnz	loc_10018D2D
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10018CC1
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10018CC1
		push	esi
		call	sub_1001704B
		sar	eax, 5
		lea	edi, dword_1002F080[eax*4]
		push	esi
		call	sub_1001704B
		pop	ecx
		pop	ecx
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [edi]
		jmp	short loc_10018CC6
; ---------------------------------------------------------------------------

loc_10018CC1:				; CODE XREF: sub_10018C25+6Cj
					; sub_10018C25+78j
		mov	eax, offset dword_1002DEE0

loc_10018CC6:				; CODE XREF: sub_10018C25+9Aj
		test	byte ptr [eax+8], 3
		jnz	short loc_10018D11
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10018D06
		push	esi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10018D06
		push	esi
		call	sub_1001704B
		sar	eax, 5
		lea	edi, dword_1002F080[eax*4]
		push	esi
		call	sub_1001704B
		pop	ecx
		pop	ecx
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [edi]
		jmp	short loc_10018D0B
; ---------------------------------------------------------------------------

loc_10018D06:				; CODE XREF: sub_10018C25+B1j
					; sub_10018C25+BDj
		mov	eax, offset dword_1002DEE0

loc_10018D0B:				; CODE XREF: sub_10018C25+DFj
		test	byte ptr [eax+8], 8
		jz	short loc_10018D2D

loc_10018D11:				; CODE XREF: sub_10018C25+A5j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		or	[ebp+var_1C], 0FFFFFFFFh

loc_10018D2D:				; CODE XREF: sub_10018C25+5Cj
					; sub_10018C25+EAj
		cmp	[ebp+var_1C], ebx
		jnz	short loc_10018D54
		push	esi
		call	sub_10013CD1
		mov	edi, eax
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	esi
		call	[ebp+arg_0]
		mov	[ebp+var_1C], eax
		push	esi
		push	edi
		call	sub_10013D65
		add	esp, 1Ch

loc_10018D54:				; CODE XREF: sub_10018C25+10Bj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10018D69	; Finally handler 0 for	function 10018C25
; ---------------------------------------------------------------------------

loc_10018D60:				; CODE XREF: sub_10018C25+14Dj
		mov	eax, [ebp+var_1C]

loc_10018D63:				; CODE XREF: sub_10018C25+3Aj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10018D69:				; CODE XREF: sub_10018C25+136j
					; DATA XREF: .rdata:stru_1002B710o
		push	[ebp+arg_4]	; Finally handler 0 for	function 10018C25
		call	sub_10010CAD
		pop	ecx
		retn
sub_10018C25	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018D73	proc near		; CODE XREF: .text:10010B01p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	offset sub_10013E79
		call	sub_10018C25
		add	esp, 14h
		pop	ebp
		retn
sub_10018D73	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018D93	proc near		; CODE XREF: .text:10010B1Dp
					; .text:10010B38p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	offset sub_1001D746
		call	sub_10018C25
		add	esp, 14h
		pop	ebp
		retn
sub_10018D93	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018DB3	proc near		; CODE XREF: .text:10010B54p
					; .text:10010B6Fp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	offset sub_1001E5A0
		call	sub_10018C25
		add	esp, 14h
		pop	ebp
		retn
sub_10018DB3	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+10h]
		push	0
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		push	offset sub_10013E79
		call	sub_10018C25
		add	esp, 14h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+10h]
		push	0
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		push	offset sub_1001D746
		call	sub_10018C25
		add	esp, 14h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+10h]
		push	0
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		push	offset sub_1001E5A0
		call	sub_10018C25
		add	esp, 14h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018E30	proc near		; CODE XREF: sub_10010C30+Ep

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	10h
		push	offset stru_1002B730
		call	__SEH_prolog4
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		push	1
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		push	3
		pop	edi

loc_10018E4F:				; CODE XREF: sub_10018E30+7Fj
		mov	[ebp+var_20], edi
		cmp	edi, dword_100301E0
		jge	short loc_10018EB1
		mov	esi, edi
		shl	esi, 2
		mov	eax, dword_1002F1D8
		add	eax, esi
		cmp	[eax], ebx
		jz	short loc_10018EAE
		mov	eax, [eax]
		test	byte ptr [eax+0Ch], 83h
		jz	short loc_10018E81
		push	eax
		call	sub_1000FCAB
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10018E81
		inc	[ebp+var_1C]

loc_10018E81:				; CODE XREF: sub_10018E30+40j
					; sub_10018E30+4Cj
		cmp	edi, 14h
		jl	short loc_10018EAE
		mov	eax, dword_1002F1D8
		mov	eax, [esi+eax]
		add	eax, 20h
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		mov	eax, dword_1002F1D8
		push	dword ptr [esi+eax] ; lpMem
		call	sub_1000EE73
		pop	ecx
		mov	eax, dword_1002F1D8
		mov	[esi+eax], ebx

loc_10018EAE:				; CODE XREF: sub_10018E30+38j
					; sub_10018E30+54j
		inc	edi
		jmp	short loc_10018E4F
; ---------------------------------------------------------------------------

loc_10018EB1:				; CODE XREF: sub_10018E30+28j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10018EC6	; Finally handler 0 for	function 10018E30
; ---------------------------------------------------------------------------

loc_10018EBD:				; CODE XREF: sub_10018E30+9Ej
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10018EC6:				; CODE XREF: sub_10018E30+88j
					; DATA XREF: .rdata:stru_1002B730o
		push	1		; Finally handler 0 for	function 10018E30
		call	sub_100151D0
		pop	ecx
		retn
sub_10018E30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018ECF	proc near		; CODE XREF: sub_10019170:loc_10019191p
					; sub_1001919B+13p ...

var_38		= dword	ptr -38h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		push	ebx
		push	edi
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_38]
		call	sub_1000E615
		mov	eax, [ebp+arg_8]
		mov	edi, [ebp+arg_4]
		xor	ebx, ebx
		cmp	eax, ebx
		jz	short loc_10018EF2
		mov	[eax], edi

loc_10018EF2:				; CODE XREF: sub_10018ECF+1Fj
		cmp	edi, ebx
		jnz	short loc_10018F23

loc_10018EF6:				; CODE XREF: sub_10018ECF+5Dj
					; sub_10018ECF+63j
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_2C], bl
		jz	short loc_10018F1A
		mov	eax, [ebp+var_30]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10018F1A:				; CODE XREF: sub_10018ECF+42j
		xor	eax, eax
		xor	edx, edx
		jmp	loc_1001916C
; ---------------------------------------------------------------------------

loc_10018F23:				; CODE XREF: sub_10018ECF+25j
		cmp	[ebp+arg_C], ebx
		jz	short loc_10018F34
		cmp	[ebp+arg_C], 2
		jl	short loc_10018EF6
		cmp	[ebp+arg_C], 24h
		jg	short loc_10018EF6

loc_10018F34:				; CODE XREF: sub_10018ECF+57j
		mov	al, [edi]
		push	esi
		mov	esi, [ebp+var_38]
		mov	[ebp+var_10], ebx
		mov	[ebp+var_C], ebx
		inc	edi

loc_10018F41:				; CODE XREF: sub_10018ECF+B3j
		cmp	dword ptr [esi+0ACh], 1
		mov	[ebp+var_1], al
		jle	short loc_10018F65
		lea	eax, [ebp+var_38]
		push	eax
		movzx	eax, [ebp+var_1]
		push	8
		push	eax
		call	sub_10013BD0
		mov	esi, [ebp+var_38]
		add	esp, 0Ch
		jmp	short loc_10018F76
; ---------------------------------------------------------------------------

loc_10018F65:				; CODE XREF: sub_10018ECF+7Cj
		movzx	eax, [ebp+var_1]
		mov	ecx, [esi+0C8h]
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, 8

loc_10018F76:				; CODE XREF: sub_10018ECF+94j
		cmp	eax, ebx
		jz	short loc_10018F84

loc_10018F7A:				; CODE XREF: sub_10018ECF+B1j
		mov	al, [edi]
		inc	edi
		cmp	al, [ebp+var_1]
		jz	short loc_10018F7A
		jmp	short loc_10018F41
; ---------------------------------------------------------------------------

loc_10018F84:				; CODE XREF: sub_10018ECF+A9j
		cmp	[ebp+var_1], 2Dh
		mov	[ebp+var_8], edi
		jnz	short loc_10018F93
		or	[ebp+arg_10], 2
		jmp	short loc_10018F99
; ---------------------------------------------------------------------------

loc_10018F93:				; CODE XREF: sub_10018ECF+BCj
		cmp	[ebp+var_1], 2Bh
		jnz	short loc_10018FA2

loc_10018F99:				; CODE XREF: sub_10018ECF+C2j
		mov	al, [edi]
		inc	edi
		mov	[ebp+var_8], edi
		mov	[ebp+var_1], al

loc_10018FA2:				; CODE XREF: sub_10018ECF+C8j
		push	10h
		pop	ecx
		cmp	[ebp+arg_C], ebx
		jnz	short loc_10018FCF
		cmp	[ebp+var_1], 30h
		jz	short loc_10018FB9
		mov	[ebp+arg_C], 0Ah
		jmp	short loc_10018FEE
; ---------------------------------------------------------------------------

loc_10018FB9:				; CODE XREF: sub_10018ECF+DFj
		mov	al, [edi]
		cmp	al, 78h
		jz	short loc_10018FCC
		cmp	al, 58h
		jz	short loc_10018FCC
		mov	[ebp+arg_C], 8
		jmp	short loc_10018FEE
; ---------------------------------------------------------------------------

loc_10018FCC:				; CODE XREF: sub_10018ECF+EEj
					; sub_10018ECF+F2j
		mov	[ebp+arg_C], ecx

loc_10018FCF:				; CODE XREF: sub_10018ECF+D9j
		cmp	[ebp+arg_C], ecx
		jnz	short loc_10018FEE
		cmp	[ebp+var_1], 30h
		jnz	short loc_10018FEE
		mov	al, [edi]
		cmp	al, 78h
		jz	short loc_10018FE4
		cmp	al, 58h
		jnz	short loc_10018FEE

loc_10018FE4:				; CODE XREF: sub_10018ECF+10Fj
		inc	edi
		mov	al, [edi]
		inc	edi
		mov	[ebp+var_1], al
		mov	[ebp+var_8], edi

loc_10018FEE:				; CODE XREF: sub_10018ECF+E8j
					; sub_10018ECF+FBj ...
		mov	eax, [ebp+arg_C]
		cdq
		push	edx
		mov	edi, eax
		push	edi
		push	0FFFFFFFFh
		push	0FFFFFFFFh
		mov	[ebp+var_24], edx
		call	sub_1001D510
		mov	[ebp+var_1C], ebx
		mov	ebx, [esi+0C8h]
		mov	[ebp+var_20], ecx
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx

loc_10019014:				; CODE XREF: sub_10018ECF+1F9j
		mov	cl, [ebp+var_1]
		movzx	eax, cl
		movzx	eax, word ptr [ebx+eax*2]
		test	al, 4
		jz	short loc_1001902A
		movsx	esi, cl
		sub	esi, 30h
		jmp	short loc_10019042
; ---------------------------------------------------------------------------

loc_1001902A:				; CODE XREF: sub_10018ECF+151j
		test	eax, 103h
		jz	short loc_10019082
		mov	al, cl
		sub	al, 61h
		cmp	al, 19h
		movsx	eax, cl
		ja	short loc_1001903F
		sub	eax, 20h

loc_1001903F:				; CODE XREF: sub_10018ECF+16Bj
		lea	esi, [eax-37h]

loc_10019042:				; CODE XREF: sub_10018ECF+159j
		cmp	esi, [ebp+arg_C]
		jnb	short loc_10019082
		mov	ecx, [ebp+var_C]
		or	[ebp+arg_10], 8
		cmp	ecx, [ebp+var_14]
		jb	short loc_100190A4
		ja	short loc_1001905D
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_18]
		jb	short loc_100190A4

loc_1001905D:				; CODE XREF: sub_10018ECF+184j
		mov	eax, [ebp+var_18]
		cmp	[ebp+var_10], eax
		jnz	short loc_10019078
		cmp	ecx, [ebp+var_14]
		jnz	short loc_10019078
		xor	eax, eax
		cmp	eax, [ebp+var_1C]
		jb	short loc_100190A4
		ja	short loc_10019078
		cmp	esi, [ebp+var_20]
		jbe	short loc_100190A4

loc_10019078:				; CODE XREF: sub_10018ECF+194j
					; sub_10018ECF+199j ...
		or	[ebp+arg_10], 4
		cmp	[ebp+arg_8], 0
		jnz	short loc_100190BD

loc_10019082:				; CODE XREF: sub_10018ECF+160j
					; sub_10018ECF+176j
		mov	eax, [ebp+arg_10]
		dec	[ebp+var_8]
		test	al, 8
		jnz	short loc_100190CD
		xor	eax, eax
		cmp	[ebp+arg_8], eax
		jz	short loc_10019099
		mov	ecx, [ebp+arg_4]
		mov	[ebp+var_8], ecx

loc_10019099:				; CODE XREF: sub_10018ECF+1C2j
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], eax
		jmp	loc_10019133
; ---------------------------------------------------------------------------

loc_100190A4:				; CODE XREF: sub_10018ECF+182j
					; sub_10018ECF+18Cj ...
		push	ecx
		push	[ebp+var_10]
		push	[ebp+var_24]
		push	edi
		call	sub_10018200
		xor	ecx, ecx
		add	eax, esi
		adc	edx, ecx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx

loc_100190BD:				; CODE XREF: sub_10018ECF+1B1j
		mov	eax, [ebp+var_8]
		mov	al, [eax]
		inc	[ebp+var_8]
		mov	[ebp+var_1], al
		jmp	loc_10019014
; ---------------------------------------------------------------------------

loc_100190CD:				; CODE XREF: sub_10018ECF+1BBj
		mov	esi, 7FFFFFFFh
		mov	ebx, 80000000h
		test	al, 4
		jnz	short loc_10019102
		test	al, 1
		jnz	short loc_10019133
		and	eax, 2
		jz	short loc_100190F1
		cmp	[ebp+var_C], ebx
		ja	short loc_10019102
		jb	short loc_100190F1
		cmp	[ebp+var_10], 0
		ja	short loc_10019102

loc_100190F1:				; CODE XREF: sub_10018ECF+213j
					; sub_10018ECF+21Aj
		test	eax, eax
		jnz	short loc_10019133
		cmp	[ebp+var_C], esi
		jb	short loc_10019133
		ja	short loc_10019102
		cmp	[ebp+var_10], 0FFFFFFFFh
		jbe	short loc_10019133

loc_10019102:				; CODE XREF: sub_10018ECF+20Aj
					; sub_10018ECF+218j ...
		call	sub_10014BF2
		test	byte ptr [ebp+arg_10], 1
		mov	dword ptr [eax], 22h
		jz	short loc_1001911D
		or	[ebp+var_10], 0FFFFFFFFh
		or	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_10019133
; ---------------------------------------------------------------------------

loc_1001911D:				; CODE XREF: sub_10018ECF+242j
		test	byte ptr [ebp+arg_10], 2
		jz	short loc_1001912C
		and	[ebp+var_10], 0
		mov	[ebp+var_C], ebx
		jmp	short loc_10019133
; ---------------------------------------------------------------------------

loc_1001912C:				; CODE XREF: sub_10018ECF+252j
		or	[ebp+var_10], 0FFFFFFFFh
		mov	[ebp+var_C], esi

loc_10019133:				; CODE XREF: sub_10018ECF+1D0j
					; sub_10018ECF+20Ej ...
		mov	eax, [ebp+arg_8]
		pop	esi
		test	eax, eax
		jz	short loc_10019140
		mov	ecx, [ebp+var_8]
		mov	[eax], ecx

loc_10019140:				; CODE XREF: sub_10018ECF+26Aj
		test	byte ptr [ebp+arg_10], 2
		jz	short loc_10019159
		mov	eax, [ebp+var_10]
		mov	ecx, [ebp+var_C]
		neg	eax
		adc	ecx, 0
		neg	ecx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], ecx

loc_10019159:				; CODE XREF: sub_10018ECF+275j
		cmp	[ebp+var_2C], 0
		jz	short loc_10019166
		mov	eax, [ebp+var_30]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10019166:				; CODE XREF: sub_10018ECF+28Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]

loc_1001916C:				; CODE XREF: sub_10018ECF+4Fj
		pop	edi
		pop	ebx
		leave
		retn
sub_10018ECF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019170	proc near		; CODE XREF: .text:1001108Dp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	eax
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		cmp	dword_1002E61C,	eax
		jnz	short loc_10019190
		push	offset off_1002DB70
		jmp	short loc_10019191
; ---------------------------------------------------------------------------

loc_10019190:				; CODE XREF: sub_10019170+17j
		push	eax

loc_10019191:				; CODE XREF: sub_10019170+1Ej
		call	sub_10018ECF
		add	esp, 14h
		pop	ebp
		retn
sub_10019170	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001919B	proc near		; CODE XREF: .text:100110A6p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	[ebp+arg_C]
		call	sub_10018ECF
		add	esp, 14h
		pop	ebp
		retn
sub_1001919B	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		push	1
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		jnz	short loc_100191D8
		push	offset off_1002DB70
		jmp	short loc_100191DA
; ---------------------------------------------------------------------------

loc_100191D8:				; CODE XREF: .text:100191CFj
		push	0

loc_100191DA:				; CODE XREF: .text:100191D6j
		call	sub_10018ECF
		add	esp, 14h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+14h]
		call	sub_10018ECF
		add	esp, 14h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019201	proc near		; CODE XREF: sub_100110D6+57p
					; sub_10025437+164p ...

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 30h
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		xor	edi, edi
		add	esi, 0FFFFF894h
		cmp	esi, 46h
		mov	[ebp+var_8], edi
		mov	[ebp+var_C], edi
		mov	[ebp+var_4], edi
		jl	short loc_1001922C
		cmp	esi, 8Ah
		jle	short loc_1001924C

loc_1001922C:				; CODE XREF: sub_10019201+21j
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	loc_10019411
; ---------------------------------------------------------------------------

loc_1001924C:				; CODE XREF: sub_10019201+29j
		push	ebx
		mov	ebx, [ebp+arg_4]
		lea	eax, [ebx-1]
		cmp	eax, 0Bh
		ja	short loc_100192BF
		cmp	[ebp+arg_C], 17h
		ja	short loc_100192BF
		cmp	[ebp+arg_10], 3Bh
		ja	short loc_100192BF
		cmp	[ebp+arg_14], 3Bh
		ja	short loc_100192BF
		cmp	[ebp+arg_8], 1
		jl	short loc_100192BF
		lea	eax, dword_1002E3AC[ebx*4]
		mov	ecx, [eax-4]
		mov	eax, [eax]
		sub	eax, ecx
		cmp	eax, [ebp+arg_8]
		jge	short loc_100192DF
		mov	eax, esi
		and	eax, 80000003h
		jns	short loc_10019291
		dec	eax
		or	eax, 0FFFFFFFCh
		inc	eax

loc_10019291:				; CODE XREF: sub_10019201+89j
		jnz	short loc_1001929F
		mov	eax, esi
		push	64h
		cdq
		pop	ebx
		idiv	ebx
		test	edx, edx
		jnz	short loc_100192B1

loc_1001929F:				; CODE XREF: sub_10019201:loc_10019291j
		lea	eax, [esi+76Ch]
		cdq
		mov	ebx, 190h
		idiv	ebx
		test	edx, edx
		jnz	short loc_100192BF

loc_100192B1:				; CODE XREF: sub_10019201+9Cj
		mov	ebx, [ebp+arg_4]
		cmp	ebx, 2
		jnz	short loc_100192BF
		cmp	[ebp+arg_8], 1Dh
		jle	short loc_100192DF

loc_100192BF:				; CODE XREF: sub_10019201+55j
					; sub_10019201+5Bj ...
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	loc_10019410
; ---------------------------------------------------------------------------

loc_100192DF:				; CODE XREF: sub_10019201+80j
					; sub_10019201+BCj
		mov	eax, [ebp+arg_8]
		add	ecx, eax
		mov	eax, esi
		and	eax, 80000003h
		mov	[ebp+arg_0], ecx
		jns	short loc_100192F5
		dec	eax
		or	eax, 0FFFFFFFCh
		inc	eax

loc_100192F5:				; CODE XREF: sub_10019201+EDj
		jnz	short loc_10019303
		mov	eax, esi
		push	64h
		cdq
		pop	ecx
		idiv	ecx
		test	edx, edx
		jnz	short loc_10019315

loc_10019303:				; CODE XREF: sub_10019201:loc_100192F5j
		lea	eax, [esi+76Ch]
		cdq
		mov	ecx, 190h
		idiv	ecx
		test	edx, edx
		jnz	short loc_1001931D

loc_10019315:				; CODE XREF: sub_10019201+100j
		cmp	ebx, 2
		jle	short loc_1001931D
		inc	[ebp+arg_0]

loc_1001931D:				; CODE XREF: sub_10019201+112j
					; sub_10019201+117j
		lea	eax, [esi+12Bh]
		cdq
		mov	edi, 190h
		idiv	edi
		lea	ecx, [esi-1]
		push	64h
		pop	ebx
		mov	edi, eax
		mov	eax, ecx
		cdq
		idiv	ebx
		mov	ebx, [ebp+arg_14]
		sub	edi, eax
		mov	eax, ecx
		cdq
		mov	ecx, esi
		imul	ecx, 16Dh
		and	edx, 3
		add	eax, edx
		sar	eax, 2
		add	eax, [ebp+arg_0]
		add	eax, edi
		add	ecx, eax
		imul	ecx, 18h
		add	ecx, [ebp+arg_C]
		imul	ecx, 3Ch
		add	ecx, [ebp+arg_10]
		imul	ecx, 3Ch
		lea	edi, [ecx+ebx+7C558180h]
		call	sub_100236AF
		lea	eax, [ebp+var_8]
		push	eax
		call	sub_10023777
		pop	ecx
		test	eax, eax
		jz	short loc_1001938F
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001938F:				; CODE XREF: sub_10019201+17Dj
		lea	eax, [ebp+var_C]
		push	eax
		call	sub_100237B0
		pop	ecx
		test	eax, eax
		jz	short loc_100193AC
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_100193AC:				; CODE XREF: sub_10019201+19Aj
		lea	eax, [ebp+var_4]
		push	eax
		call	sub_100237E9
		pop	ecx
		test	eax, eax
		jz	short loc_100193C9
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_100193C9:				; CODE XREF: sub_10019201+1B7j
		mov	eax, [ebp+arg_0]
		add	edi, [ebp+var_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_4]
		dec	eax
		cmp	[ebp+arg_18], 1
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_1C], esi
		mov	[ebp+var_2C], eax
		mov	[ebp+var_30], ebx
		jz	short loc_1001940B
		cmp	[ebp+arg_18], 0FFFFFFFFh
		jnz	short loc_1001940E
		cmp	[ebp+var_8], 0
		jz	short loc_1001940E
		lea	eax, [ebp+var_30]
		push	eax
		call	sub_10023736
		pop	ecx
		test	eax, eax
		jz	short loc_1001940E

loc_1001940B:				; CODE XREF: sub_10019201+1EEj
		add	edi, [ebp+var_C]

loc_1001940E:				; CODE XREF: sub_10019201+1F4j
					; sub_10019201+1FAj ...
		mov	eax, edi

loc_10019410:				; CODE XREF: sub_10019201+D9j
		pop	ebx

loc_10019411:				; CODE XREF: sub_10019201+46j
		pop	edi
		pop	esi
		leave
		retn
sub_10019201	endp

; [00000001 BYTES: COLLAPSED FUNCTION nullsub_2]
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ecx, dword_1002DFA4
		push	esi

loc_10019425:				; CODE XREF: .text:10019436j
		cmp	[eax], edx
		jz	short loc_10019438
		mov	esi, ecx
		imul	esi, 0Ch
		add	esi, [ebp+8]
		add	eax, 0Ch
		cmp	eax, esi
		jb	short loc_10019425

loc_10019438:				; CODE XREF: .text:10019427j
		imul	ecx, 0Ch
		add	ecx, [ebp+8]
		pop	esi
		cmp	eax, ecx
		jnb	short loc_10019447
		cmp	[eax], edx
		jz	short loc_10019449

loc_10019447:				; CODE XREF: .text:10019441j
		xor	eax, eax

loc_10019449:				; CODE XREF: .text:10019445j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001944B	proc near		; CODE XREF: sub_100113CD+13p
					; .text:100195BEp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		call	sub_100137AC
		mov	esi, eax
		test	esi, esi
		jz	loc_100195A8
		mov	edx, [esi+5Ch]
		mov	eax, dword_1002DFA4
		push	edi
		mov	edi, [ebp+arg_0]
		mov	ecx, edx
		push	ebx

loc_10019471:				; CODE XREF: sub_1001944B+36j
		cmp	[ecx], edi
		jz	short loc_10019483
		mov	ebx, eax
		imul	ebx, 0Ch
		add	ecx, 0Ch
		add	ebx, edx
		cmp	ecx, ebx
		jb	short loc_10019471

loc_10019483:				; CODE XREF: sub_1001944B+28j
		imul	eax, 0Ch
		add	eax, edx
		cmp	ecx, eax
		jnb	short loc_10019494
		cmp	[ecx], edi
		jnz	short loc_10019494
		mov	eax, ecx
		jmp	short loc_10019496
; ---------------------------------------------------------------------------

loc_10019494:				; CODE XREF: sub_1001944B+3Fj
					; sub_1001944B+43j
		xor	eax, eax

loc_10019496:				; CODE XREF: sub_1001944B+47j
		test	eax, eax
		jz	short loc_100194A4
		mov	ebx, [eax+8]
		mov	[ebp+var_4], ebx
		test	ebx, ebx
		jnz	short loc_100194AB

loc_100194A4:				; CODE XREF: sub_1001944B+4Dj
		xor	eax, eax
		jmp	loc_100195A6
; ---------------------------------------------------------------------------

loc_100194AB:				; CODE XREF: sub_1001944B+57j
		cmp	ebx, 5
		jnz	short loc_100194BC
		and	dword ptr [eax+8], 0
		xor	eax, eax
		inc	eax
		jmp	loc_100195A6
; ---------------------------------------------------------------------------

loc_100194BC:				; CODE XREF: sub_1001944B+63j
		cmp	ebx, 1
		jz	loc_100195A3
		mov	ecx, [esi+60h]
		mov	[ebp+var_8], ecx
		mov	ecx, [ebp+arg_4]
		mov	[esi+60h], ecx
		mov	ecx, [eax+4]
		cmp	ecx, 8
		jnz	loc_10019595
		mov	ecx, dword_1002DF98
		mov	edi, dword_1002DF9C
		mov	edx, ecx
		add	edi, ecx
		cmp	edx, edi
		jge	short loc_10019515
		imul	ecx, 0Ch

loc_100194F4:				; CODE XREF: sub_1001944B+C5j
		mov	edi, [esi+5Ch]
		and	dword ptr [ecx+edi+8], 0
		mov	edi, dword_1002DF98
		mov	ebx, dword_1002DF9C
		inc	edx
		add	ebx, edi
		add	ecx, 0Ch
		cmp	edx, ebx
		jl	short loc_100194F4
		mov	ebx, [ebp+var_4]

loc_10019515:				; CODE XREF: sub_1001944B+A4j
		mov	eax, [eax]
		mov	edi, [esi+64h]
		cmp	eax, 0C000008Eh
		jnz	short loc_1001952A
		mov	dword ptr [esi+64h], 83h
		jmp	short loc_10019588
; ---------------------------------------------------------------------------

loc_1001952A:				; CODE XREF: sub_1001944B+D4j
		cmp	eax, 0C0000090h
		jnz	short loc_1001953A
		mov	dword ptr [esi+64h], 81h
		jmp	short loc_10019588
; ---------------------------------------------------------------------------

loc_1001953A:				; CODE XREF: sub_1001944B+E4j
		cmp	eax, 0C0000091h
		jnz	short loc_1001954A
		mov	dword ptr [esi+64h], 84h
		jmp	short loc_10019588
; ---------------------------------------------------------------------------

loc_1001954A:				; CODE XREF: sub_1001944B+F4j
		cmp	eax, 0C0000093h
		jnz	short loc_1001955A
		mov	dword ptr [esi+64h], 85h
		jmp	short loc_10019588
; ---------------------------------------------------------------------------

loc_1001955A:				; CODE XREF: sub_1001944B+104j
		cmp	eax, 0C000008Dh
		jnz	short loc_1001956A
		mov	dword ptr [esi+64h], 82h
		jmp	short loc_10019588
; ---------------------------------------------------------------------------

loc_1001956A:				; CODE XREF: sub_1001944B+114j
		cmp	eax, 0C000008Fh
		jnz	short loc_1001957A
		mov	dword ptr [esi+64h], 86h
		jmp	short loc_10019588
; ---------------------------------------------------------------------------

loc_1001957A:				; CODE XREF: sub_1001944B+124j
		cmp	eax, 0C0000092h
		jnz	short loc_10019588
		mov	dword ptr [esi+64h], 8Ah

loc_10019588:				; CODE XREF: sub_1001944B+DDj
					; sub_1001944B+EDj ...
		push	dword ptr [esi+64h]
		push	8
		call	ebx
		pop	ecx
		mov	[esi+64h], edi
		jmp	short loc_1001959C
; ---------------------------------------------------------------------------

loc_10019595:				; CODE XREF: sub_1001944B+8Cj
		and	dword ptr [eax+8], 0
		push	ecx
		call	ebx

loc_1001959C:				; CODE XREF: sub_1001944B+148j
		mov	eax, [ebp+var_8]
		pop	ecx
		mov	[esi+60h], eax

loc_100195A3:				; CODE XREF: sub_1001944B+74j
		or	eax, 0FFFFFFFFh

loc_100195A6:				; CODE XREF: sub_1001944B+5Bj
					; sub_1001944B+6Cj
		pop	ebx
		pop	edi

loc_100195A8:				; CODE XREF: sub_1001944B+11j
		pop	esi
		leave
		retn
sub_1001944B	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, 0E06D7363h
		cmp	[ebp+8], eax
		jnz	short loc_100195C7
		push	dword ptr [ebp+0Ch]
		push	eax
		call	sub_1001944B
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100195C7:				; CODE XREF: .text:100195B8j
		xor	eax, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100195CB	proc near		; CODE XREF: sub_10011438+DAp

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	edi
		xor	edi, edi
		cmp	dword_1002F18C,	edi
		jnz	short loc_100195E3
		call	sub_10012246

loc_100195E3:				; CODE XREF: sub_100195CB+11j
		mov	esi, dword_1002E5F0
		cmp	esi, edi
		jnz	short loc_100195F5
		or	eax, 0FFFFFFFFh
		jmp	loc_100196CD
; ---------------------------------------------------------------------------

loc_100195F5:				; CODE XREF: sub_100195CB+20j
		push	ebx
		xor	edx, edx
		jmp	short loc_10019617
; ---------------------------------------------------------------------------

loc_100195FA:				; CODE XREF: sub_100195CB+50j
		mov	eax, esi
		lea	ebx, [eax+1]
		mov	[ebp+var_4], ebx

loc_10019602:				; CODE XREF: sub_100195CB+3Cj
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_10019602
		sub	eax, [ebp+var_4]
		inc	eax
		cmp	cl, 3Dh
		jz	short loc_10019615
		inc	edi
		add	edx, eax

loc_10019615:				; CODE XREF: sub_100195CB+45j
		add	esi, eax

loc_10019617:				; CODE XREF: sub_100195CB+2Dj
		mov	cl, [esi]
		test	cl, cl
		jnz	short loc_100195FA
		shl	edi, 2
		lea	ebx, [edi+edx+4]
		push	1
		push	ebx
		call	sub_1000F496
		mov	esi, eax
		pop	ecx
		pop	ecx
		test	esi, esi
		jnz	short loc_1001963C
		or	eax, 0FFFFFFFFh
		jmp	loc_100196CC
; ---------------------------------------------------------------------------

loc_1001963C:				; CODE XREF: sub_100195CB+67j
		lea	edx, [edi+esi+4]
		mov	edi, dword_1002E5F0
		lea	eax, [esi+ebx]
		mov	dword_1002EB04,	esi
		mov	dword_1002F194,	eax
		mov	dword_1002EB00,	esi
		mov	[ebp+var_4], edx
		jmp	short loc_100196A4
; ---------------------------------------------------------------------------

loc_1001965F:				; CODE XREF: sub_100195CB+DDj
		mov	eax, edi
		lea	ebx, [eax+1]
		mov	[ebp+var_8], ebx

loc_10019667:				; CODE XREF: sub_100195CB+A1j
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_10019667
		sub	eax, [ebp+var_8]
		lea	ebx, [eax+1]
		cmp	cl, 3Dh
		jz	short loc_100196A2
		push	edi
		push	ebx
		push	edx
		mov	[esi], edx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10019699
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_10019699:				; CODE XREF: sub_100195CB+BDj
		add	[ebp+var_4], ebx
		mov	edx, [ebp+var_4]
		add	esi, 4

loc_100196A2:				; CODE XREF: sub_100195CB+ACj
		add	edi, ebx

loc_100196A4:				; CODE XREF: sub_100195CB+92j
		mov	cl, [edi]
		test	cl, cl
		jnz	short loc_1001965F
		push	dword_1002E5F0	; lpMem
		call	sub_1000EE73
		and	dword_1002E5F0,	0
		and	dword ptr [esi], 0
		pop	ecx
		mov	dword_1002F180,	1
		xor	eax, eax

loc_100196CC:				; CODE XREF: sub_100195CB+6Cj
		pop	ebx

loc_100196CD:				; CODE XREF: sub_100195CB+25j
		pop	edi
		pop	esi
		leave
		retn
sub_100195CB	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	dword_1002EB10,	eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100196E0	proc near		; CODE XREF: .text:10019742p
					; sub_1001992E+72p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		ja	short loc_100196FE
		mov	eax, [ebp+arg_0]
		jb	short loc_100196F5
		cmp	eax, 0FFFFFFFFh
		ja	short loc_100196FE

loc_100196F5:				; CODE XREF: sub_100196E0+Ej
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100196FE:				; CODE XREF: sub_100196E0+9j
					; sub_100196E0+13j
		mov	eax, [ebp+arg_8]
		or	dword ptr [eax], 0FFFFFFFFh
		mov	eax, 80070216h
		pop	ebp
		retn
sub_100196E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001970B	proc near		; CODE XREF: sub_1001992E+A2p
					; sub_10021623+D5p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		mov	eax, [ebp+arg_4]
		add	eax, ecx
		cmp	eax, ecx
		jb	short loc_10019725
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10019725:				; CODE XREF: sub_1001970B+Fj
		mov	eax, [ebp+arg_8]
		or	dword ptr [eax], 0FFFFFFFFh
		mov	eax, 80070216h
		pop	ebp
		retn
sub_1001970B	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mul	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+10h]
		push	edx
		push	eax
		call	sub_100196E0
		add	esp, 0Ch
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001974C	proc near		; CODE XREF: sub_1001992E+5Dp
					; sub_1001992E+CCp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [esi]
		mov	ecx, [ebp+arg_C]
		mov	edx, [ecx]
		and	dword ptr [esi], 0
		mov	[ebp+var_4], eax
		xor	eax, eax
		push	ebx
		inc	eax
		cmp	[ebp+arg_4], 0
		push	edi
		mov	edi, [ebp+arg_0]
		mov	[ebp+var_8], edx
		mov	[ecx], eax
		jz	short loc_10019783
		cmp	edx, eax
		jl	short loc_10019783
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_8]
		add	[ebp+arg_4], 4
		mov	[edx], eax

loc_10019783:				; CODE XREF: sub_1001974C+25j
					; sub_1001974C+29j
		and	[ebp+arg_0], 0

loc_10019787:				; CODE XREF: sub_1001974C+9Fj
					; sub_1001974C+A9j
		cmp	byte ptr [edi],	22h
		jnz	short loc_1001979C
		xor	eax, eax
		cmp	[ebp+arg_0], eax
		mov	bl, 22h
		setz	al
		inc	edi
		mov	[ebp+arg_0], eax
		jmp	short loc_100197E7
; ---------------------------------------------------------------------------

loc_1001979C:				; CODE XREF: sub_1001974C+3Ej
		inc	dword ptr [esi]
		cmp	[ebp+arg_8], 0
		mov	eax, [esi]
		jz	short loc_100197B5
		cmp	eax, [ebp+var_4]
		jg	short loc_100197B5
		mov	ecx, [ebp+arg_8]
		mov	al, [edi]
		inc	[ebp+arg_8]
		mov	[ecx], al

loc_100197B5:				; CODE XREF: sub_1001974C+58j
					; sub_1001974C+5Dj
		mov	bl, [edi]
		movzx	eax, bl
		push	eax
		inc	edi
		call	sub_10023AD5
		pop	ecx
		test	eax, eax
		jz	short loc_100197E0
		inc	dword ptr [esi]
		cmp	[ebp+arg_8], 0
		mov	eax, [esi]
		jz	short loc_100197DF
		cmp	eax, [ebp+var_4]
		jg	short loc_100197DF
		mov	ecx, [ebp+arg_8]
		mov	al, [edi]
		inc	[ebp+arg_8]
		mov	[ecx], al

loc_100197DF:				; CODE XREF: sub_1001974C+82j
					; sub_1001974C+87j
		inc	edi

loc_100197E0:				; CODE XREF: sub_1001974C+78j
		mov	ecx, [ebp+arg_C]
		test	bl, bl
		jz	short loc_1001981A

loc_100197E7:				; CODE XREF: sub_1001974C+4Ej
		cmp	[ebp+arg_0], 0
		jnz	short loc_10019787
		cmp	bl, 20h
		jz	short loc_100197F7
		cmp	bl, 9
		jnz	short loc_10019787

loc_100197F7:				; CODE XREF: sub_1001974C+A4j
		mov	eax, [ebp+arg_8]
		test	eax, eax
		jz	short loc_10019802
		mov	byte ptr [eax-1], 0

loc_10019802:				; CODE XREF: sub_1001974C+B0j
					; sub_1001974C+CFj
		xor	ebx, ebx

loc_10019804:				; CODE XREF: sub_1001974C+1AEj
					; sub_1001974C+1B7j ...
		cmp	byte ptr [edi],	0
		jz	loc_10019917

loc_1001980D:				; CODE XREF: sub_1001974C+CCj
		mov	al, [edi]
		cmp	al, 20h
		jz	short loc_10019817
		cmp	al, 9
		jnz	short loc_1001981D

loc_10019817:				; CODE XREF: sub_1001974C+C5j
		inc	edi
		jmp	short loc_1001980D
; ---------------------------------------------------------------------------

loc_1001981A:				; CODE XREF: sub_1001974C+99j
		dec	edi
		jmp	short loc_10019802
; ---------------------------------------------------------------------------

loc_1001981D:				; CODE XREF: sub_1001974C+C9j
		cmp	byte ptr [edi],	0
		jz	loc_10019917
		inc	dword ptr [ecx]
		cmp	[ebp+arg_4], 0
		mov	eax, [ecx]
		jz	short loc_10019841
		cmp	eax, [ebp+var_8]
		jg	short loc_10019841
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_8]
		add	[ebp+arg_4], 4
		mov	[edx], eax

loc_10019841:				; CODE XREF: sub_1001974C+E2j
					; sub_1001974C+E7j ...
		mov	[ebp+arg_0], 1
		xor	edx, edx
		jmp	short loc_1001984E
; ---------------------------------------------------------------------------

loc_1001984C:				; CODE XREF: sub_1001974C+105j
		inc	edi
		inc	edx

loc_1001984E:				; CODE XREF: sub_1001974C+FEj
		cmp	byte ptr [edi],	5Ch
		jz	short loc_1001984C
		cmp	byte ptr [edi],	22h
		jnz	short loc_10019897
		test	dl, 1
		jnz	short loc_1001987A
		test	ebx, ebx
		jz	short loc_1001986D
		lea	eax, [edi+1]
		cmp	byte ptr [eax],	22h
		jnz	short loc_1001986D
		mov	edi, eax
		jmp	short loc_10019871
; ---------------------------------------------------------------------------

loc_1001986D:				; CODE XREF: sub_1001974C+113j
					; sub_1001974C+11Bj
		and	[ebp+arg_0], 0

loc_10019871:				; CODE XREF: sub_1001974C+11Fj
		xor	eax, eax
		test	ebx, ebx
		setz	al
		mov	ebx, eax

loc_1001987A:				; CODE XREF: sub_1001974C+10Fj
		shr	edx, 1
		jmp	short loc_10019897
; ---------------------------------------------------------------------------

loc_1001987E:				; CODE XREF: sub_1001974C+14Dj
		dec	edx
		inc	dword ptr [esi]
		cmp	[ebp+arg_8], 0
		mov	eax, [esi]
		jz	short loc_10019897
		cmp	eax, [ebp+var_4]
		jg	short loc_10019897
		mov	eax, [ebp+arg_8]
		inc	[ebp+arg_8]
		mov	byte ptr [eax],	5Ch

loc_10019897:				; CODE XREF: sub_1001974C+10Aj
					; sub_1001974C+130j ...
		test	edx, edx
		jnz	short loc_1001987E
		mov	al, [edi]
		test	al, al
		jz	short loc_100198F2
		test	ebx, ebx
		jnz	short loc_100198AD
		cmp	al, 20h
		jz	short loc_100198F2
		cmp	al, 9
		jz	short loc_100198F2

loc_100198AD:				; CODE XREF: sub_1001974C+157j
		cmp	[ebp+arg_0], 0
		jz	short loc_100198EC
		inc	dword ptr [esi]
		movsx	eax, byte ptr [edi]
		push	eax
		call	sub_10023AD5
		cmp	[ebp+arg_8], 0
		pop	ecx
		jz	short loc_100198E2
		test	eax, eax
		jz	short loc_100198D6
		mov	al, [edi]
		mov	ecx, [ebp+arg_8]
		inc	[ebp+arg_8]
		mov	[ecx], al
		inc	edi
		inc	dword ptr [esi]

loc_100198D6:				; CODE XREF: sub_1001974C+17Bj
		mov	ecx, [ebp+arg_8]
		mov	al, [edi]
		inc	[ebp+arg_8]
		mov	[ecx], al
		jmp	short loc_100198E9
; ---------------------------------------------------------------------------

loc_100198E2:				; CODE XREF: sub_1001974C+177j
		test	eax, eax
		jz	short loc_100198E9
		inc	edi
		inc	dword ptr [esi]

loc_100198E9:				; CODE XREF: sub_1001974C+194j
					; sub_1001974C+198j
		mov	ecx, [ebp+arg_C]

loc_100198EC:				; CODE XREF: sub_1001974C+165j
		inc	edi
		jmp	loc_10019841
; ---------------------------------------------------------------------------

loc_100198F2:				; CODE XREF: sub_1001974C+153j
					; sub_1001974C+15Bj ...
		inc	dword ptr [esi]
		cmp	[ebp+arg_8], 0
		mov	eax, [esi]
		jz	loc_10019804
		cmp	eax, [ebp+var_4]
		jg	loc_10019804
		mov	eax, [ebp+arg_8]
		inc	[ebp+arg_8]
		mov	byte ptr [eax],	0
		jmp	loc_10019804
; ---------------------------------------------------------------------------

loc_10019917:				; CODE XREF: sub_1001974C+BBj
					; sub_1001974C+D4j
		inc	dword ptr [ecx]
		mov	eax, [ecx]
		mov	ecx, [ebp+arg_4]
		pop	edi
		pop	ebx
		test	ecx, ecx
		jz	short locret_1001992C
		cmp	eax, [ebp+var_8]
		jg	short locret_1001992C
		and	dword ptr [ecx], 0

locret_1001992C:			; CODE XREF: sub_1001974C+1D6j
					; sub_1001974C+1DBj
		leave
		retn
sub_1001974C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001992E	proc near		; CODE XREF: sub_10011438:loc_10011509p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	ebx
		xor	ebx, ebx
		push	esi
		push	edi
		mov	[ebp+var_4], ebx
		mov	[ebp+var_C], ebx
		cmp	dword_1002F18C,	ebx
		jnz	short loc_1001994E
		call	sub_10012246

loc_1001994E:				; CODE XREF: sub_1001992E+19j
		push	104h		; nSize
		mov	esi, offset byte_1002EE40
		push	esi		; lpFilename
		push	ebx		; hModule
		mov	byte_1002EF44, bl
		call	ds:GetModuleFileNameA
		mov	eax, dword_1002F1D0
		mov	dword_1002EB10,	esi
		cmp	eax, ebx
		jz	short loc_1001997C
		mov	[ebp+var_8], eax
		cmp	[eax], bl
		jnz	short loc_1001997F

loc_1001997C:				; CODE XREF: sub_1001992E+45j
		mov	[ebp+var_8], esi

loc_1001997F:				; CODE XREF: sub_1001992E+4Cj
		lea	eax, [ebp+var_4]
		push	eax
		push	ebx
		push	ebx
		push	[ebp+var_8]
		lea	esi, [ebp+var_C]
		call	sub_1001974C
		mov	esi, [ebp+var_4]
		lea	eax, [ebp+var_14]
		push	eax
		push	4
		pop	ecx
		mov	eax, esi
		mul	ecx
		push	edx
		push	eax
		call	sub_100196E0
		add	esp, 1Ch
		test	eax, eax
		jl	short loc_10019A15
		lea	eax, [ebp+var_10]
		push	eax
		mov	eax, [ebp+var_C]
		push	4
		pop	ecx
		mul	ecx
		push	edx
		push	eax
		call	sub_100196E0
		add	esp, 0Ch
		test	eax, eax
		jl	short loc_10019A15
		lea	eax, [ebp+var_14]
		push	eax
		push	[ebp+var_10]
		push	[ebp+var_14]
		call	sub_1001970B
		add	esp, 0Ch
		test	eax, eax
		jl	short loc_10019A15
		push	[ebp+var_14]
		call	sub_1000F5A0
		mov	edi, eax
		pop	ecx
		cmp	edi, ebx
		jz	short loc_10019A15
		lea	eax, [ebp+var_4]
		push	eax
		lea	eax, [edi+esi*4]
		push	eax
		push	edi
		push	[ebp+var_8]
		lea	esi, [ebp+var_C]
		call	sub_1001974C
		mov	eax, [ebp+var_4]
		add	esp, 10h
		dec	eax
		mov	dword_1002EAF4,	eax
		mov	dword_1002EAF8,	edi
		xor	eax, eax
		jmp	short loc_10019A18
; ---------------------------------------------------------------------------

loc_10019A15:				; CODE XREF: sub_1001992E+7Cj
					; sub_1001992E+96j ...
		or	eax, 0FFFFFFFFh

loc_10019A18:				; CODE XREF: sub_1001992E+E5j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_1001992E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019A1D	proc near		; CODE XREF: sub_10011438+B7p

cchWideChar	= dword	ptr -0Ch
cbMultiByte	= dword	ptr -8
lpMem		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, dword_1002EF48
		sub	esp, 0Ch
		push	ebx
		push	esi
		mov	esi, ds:GetEnvironmentStringsW
		push	edi
		xor	ebx, ebx
		xor	edi, edi
		cmp	eax, ebx
		jnz	short loc_10019A69
		call	esi ; GetEnvironmentStringsW
		mov	edi, eax
		cmp	edi, ebx
		jz	short loc_10019A4F
		mov	dword_1002EF48,	1
		jmp	short loc_10019A72
; ---------------------------------------------------------------------------

loc_10019A4F:				; CODE XREF: sub_10019A1D+24j
		call	ds:GetLastError
		cmp	eax, 78h
		jnz	short loc_10019A64
		push	2
		pop	eax
		mov	dword_1002EF48,	eax
		jmp	short loc_10019A69
; ---------------------------------------------------------------------------

loc_10019A64:				; CODE XREF: sub_10019A1D+3Bj
		mov	eax, dword_1002EF48

loc_10019A69:				; CODE XREF: sub_10019A1D+1Cj
					; sub_10019A1D+45j
		cmp	eax, 1
		jnz	loc_10019AF3

loc_10019A72:				; CODE XREF: sub_10019A1D+30j
		cmp	edi, ebx
		jnz	short loc_10019A85
		call	esi ; GetEnvironmentStringsW
		mov	edi, eax
		cmp	edi, ebx
		jnz	short loc_10019A85

loc_10019A7E:				; CODE XREF: sub_10019A1D+DDj
					; sub_10019A1D+E9j ...
		xor	eax, eax
		jmp	loc_10019B4F
; ---------------------------------------------------------------------------

loc_10019A85:				; CODE XREF: sub_10019A1D+57j
					; sub_10019A1D+5Fj
		mov	eax, edi
		cmp	[edi], bx
		jz	short loc_10019A9A

loc_10019A8C:				; CODE XREF: sub_10019A1D+74j
					; sub_10019A1D+7Bj
		inc	eax
		inc	eax
		cmp	[eax], bx
		jnz	short loc_10019A8C
		inc	eax
		inc	eax
		cmp	[eax], bx
		jnz	short loc_10019A8C

loc_10019A9A:				; CODE XREF: sub_10019A1D+6Dj
		mov	esi, ds:WideCharToMultiByte
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	ebx		; cbMultiByte
		sub	eax, edi
		push	ebx		; lpMultiByteStr
		sar	eax, 1
		inc	eax
		push	eax		; cchWideChar
		push	edi		; lpWideCharStr
		push	ebx		; dwFlags
		push	ebx		; CodePage
		mov	[ebp+cchWideChar], eax
		call	esi ; WideCharToMultiByte
		mov	[ebp+cbMultiByte], eax
		cmp	eax, ebx
		jz	short loc_10019AE8
		push	eax
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+lpMem], eax
		cmp	eax, ebx
		jz	short loc_10019AE8
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	eax		; lpMultiByteStr
		push	[ebp+cchWideChar] ; cchWideChar
		push	edi		; lpWideCharStr
		push	ebx		; dwFlags
		push	ebx		; CodePage
		call	esi ; WideCharToMultiByte
		test	eax, eax
		jnz	short loc_10019AE5
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx
		mov	[ebp+lpMem], ebx

loc_10019AE5:				; CODE XREF: sub_10019A1D+BAj
		mov	ebx, [ebp+lpMem]

loc_10019AE8:				; CODE XREF: sub_10019A1D+9Aj
					; sub_10019A1D+A8j
		push	edi		; LPWCH
		call	ds:FreeEnvironmentStringsW
		mov	eax, ebx
		jmp	short loc_10019B4F
; ---------------------------------------------------------------------------

loc_10019AF3:				; CODE XREF: sub_10019A1D+4Fj
		cmp	eax, 2
		jz	short loc_10019AFC
		cmp	eax, ebx
		jnz	short loc_10019A7E

loc_10019AFC:				; CODE XREF: sub_10019A1D+D9j
		call	ds:GetEnvironmentStrings
		mov	esi, eax
		cmp	esi, ebx
		jz	loc_10019A7E
		cmp	[esi], bl
		jz	short loc_10019B1A

loc_10019B10:				; CODE XREF: sub_10019A1D+F6j
					; sub_10019A1D+FBj
		inc	eax
		cmp	[eax], bl
		jnz	short loc_10019B10
		inc	eax
		cmp	[eax], bl
		jnz	short loc_10019B10

loc_10019B1A:				; CODE XREF: sub_10019A1D+F1j
		sub	eax, esi
		inc	eax
		push	eax
		mov	[ebp+cbMultiByte], eax
		call	sub_1000F5A0
		mov	edi, eax
		pop	ecx
		cmp	edi, ebx
		jnz	short loc_10019B39
		push	esi		; LPCH
		call	ds:FreeEnvironmentStringsA
		jmp	loc_10019A7E
; ---------------------------------------------------------------------------

loc_10019B39:				; CODE XREF: sub_10019A1D+10Ej
		push	[ebp+cbMultiByte]
		push	esi
		push	edi
		call	sub_1000E2B0
		add	esp, 0Ch
		push	esi		; LPCH
		call	ds:FreeEnvironmentStringsA
		mov	eax, edi

loc_10019B4F:				; CODE XREF: sub_10019A1D+63j
					; sub_10019A1D+D4j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_10019A1D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019B54	proc near		; CODE XREF: sub_100115E4+Bp
					; DllEntryPoint+Bp

PerformanceCount= LARGE_INTEGER	ptr -10h
SystemTimeAsFileTime= _FILETIME	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ___security_cookie
		and	[ebp+SystemTimeAsFileTime.dwLowDateTime], 0
		and	[ebp+SystemTimeAsFileTime.dwHighDateTime], 0
		push	ebx
		push	edi
		mov	edi, 0BB40E64Eh
		mov	ebx, 0FFFF0000h
		cmp	eax, edi
		jz	short loc_10019B86
		test	ebx, eax
		jz	short loc_10019B86
		not	eax
		mov	dword_1002D2C4,	eax
		jmp	short loc_10019BE1
; ---------------------------------------------------------------------------

loc_10019B86:				; CODE XREF: sub_10019B54+23j
					; sub_10019B54+27j
		push	esi
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		mov	esi, [ebp+SystemTimeAsFileTime.dwHighDateTime]
		xor	esi, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		call	ds:GetCurrentProcessId
		xor	esi, eax
		call	ds:GetCurrentThreadId
		xor	esi, eax
		call	ds:GetTickCount
		xor	esi, eax
		lea	eax, [ebp+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		mov	eax, dword ptr [ebp+PerformanceCount+4]
		xor	eax, dword ptr [ebp+PerformanceCount]
		xor	esi, eax
		cmp	esi, edi
		jz	short loc_10019BCD
		test	___security_cookie, ebx
		jnz	short loc_10019BD2

loc_10019BCD:				; CODE XREF: sub_10019B54+6Fj
		mov	esi, 0BB40E64Fh

loc_10019BD2:				; CODE XREF: sub_10019B54+77j
		mov	___security_cookie, esi
		not	esi
		mov	dword_1002D2C4,	esi
		pop	esi

loc_10019BE1:				; CODE XREF: sub_10019B54+30j
		pop	edi
		pop	ebx
		leave
		retn
sub_10019B54	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019BE5	proc near		; CODE XREF: DllEntryPoint-175p
					; DllEntryPoint-12Dp
		xor	eax, eax
		inc	eax
		retn	0Ch
sub_10019BE5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10019BEB(DWORD dwInfoType, LPCSTR lpMultiByteStr, int	cbMultiByte, LPWORD lpCharType,	UINT CodePage, LCID Locale, int)
sub_10019BEB	proc near		; CODE XREF: sub_10019DA5+2Bp

CharType	= word ptr -8
var_4		= dword	ptr -4
dwInfoType	= dword	ptr  8
lpMultiByteStr	= dword	ptr  0Ch
cbMultiByte	= dword	ptr  10h
lpCharType	= dword	ptr  14h
CodePage	= dword	ptr  18h
Locale		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, dword_1002EF4C
		push	ebx
		push	esi
		xor	ebx, ebx
		push	edi
		mov	edi, ecx
		cmp	eax, ebx
		jnz	short loc_10019C46
		lea	eax, [ebp+CharType]
		push	eax		; lpCharType
		xor	esi, esi
		inc	esi
		push	esi		; cchSrc
		push	offset SrcStr	; lpSrcStr
		push	esi		; dwInfoType
		call	ds:GetStringTypeW
		test	eax, eax
		jz	short loc_10019C2C
		mov	dword_1002EF4C,	esi
		jmp	short loc_10019C60
; ---------------------------------------------------------------------------

loc_10019C2C:				; CODE XREF: sub_10019BEB+37j
		call	ds:GetLastError
		cmp	eax, 78h
		jnz	short loc_10019C41
		push	2
		pop	eax
		mov	dword_1002EF4C,	eax
		jmp	short loc_10019C46
; ---------------------------------------------------------------------------

loc_10019C41:				; CODE XREF: sub_10019BEB+4Aj
		mov	eax, dword_1002EF4C

loc_10019C46:				; CODE XREF: sub_10019BEB+1Fj
					; sub_10019BEB+54j
		cmp	eax, 2
		jz	loc_10019D1E
		cmp	eax, ebx
		jz	loc_10019D1E
		cmp	eax, 1
		jnz	loc_10019D48

loc_10019C60:				; CODE XREF: sub_10019BEB+3Fj
		mov	dword ptr [ebp+CharType], ebx
		cmp	[ebp+CodePage],	ebx
		jnz	short loc_10019C70
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	[ebp+CodePage],	eax

loc_10019C70:				; CODE XREF: sub_10019BEB+7Bj
		mov	esi, ds:MultiByteToWideChar
		xor	eax, eax
		cmp	[ebp+arg_18], ebx
		push	ebx		; cchWideChar
		push	ebx		; lpWideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		setnz	al
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		lea	eax, ds:1[eax*8]
		push	eax		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	esi ; MultiByteToWideChar
		mov	edi, eax
		cmp	edi, ebx
		jz	loc_10019D48
		jle	short loc_10019CDB
		cmp	edi, 7FFFFFF0h
		ja	short loc_10019CDB
		lea	eax, [edi+edi+8]
		cmp	eax, 400h
		ja	short loc_10019CC5
		call	__alloca_probe_16
		mov	eax, esp
		cmp	eax, ebx
		jz	short loc_10019CD9
		mov	dword ptr [eax], 0CCCCh
		jmp	short loc_10019CD6
; ---------------------------------------------------------------------------

loc_10019CC5:				; CODE XREF: sub_10019BEB+C5j
		push	eax
		call	sub_1000F5A0
		pop	ecx
		cmp	eax, ebx
		jz	short loc_10019CD9
		mov	dword ptr [eax], 0DDDDh

loc_10019CD6:				; CODE XREF: sub_10019BEB+D8j
		add	eax, 8

loc_10019CD9:				; CODE XREF: sub_10019BEB+D0j
					; sub_10019BEB+E3j
		mov	ebx, eax

loc_10019CDB:				; CODE XREF: sub_10019BEB+B2j
					; sub_10019BEB+BAj
		test	ebx, ebx
		jz	short loc_10019D48
		lea	eax, [edi+edi]
		push	eax
		push	0
		push	ebx
		call	sub_1000E0F0
		add	esp, 0Ch
		push	edi		; cchWideChar
		push	ebx		; lpWideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	esi ; MultiByteToWideChar
		test	eax, eax
		jz	short loc_10019D12
		push	[ebp+lpCharType] ; lpCharType
		push	eax		; cchSrc
		push	ebx		; lpSrcStr
		push	[ebp+dwInfoType] ; dwInfoType
		call	ds:GetStringTypeW
		mov	dword ptr [ebp+CharType], eax

loc_10019D12:				; CODE XREF: sub_10019BEB+114j
		push	ebx
		call	sub_10010392
		mov	eax, dword ptr [ebp+CharType]
		pop	ecx
		jmp	short loc_10019D93
; ---------------------------------------------------------------------------

loc_10019D1E:				; CODE XREF: sub_10019BEB+5Ej
					; sub_10019BEB+66j
		xor	esi, esi
		cmp	[ebp+Locale], ebx
		jnz	short loc_10019D2D
		mov	eax, [edi]
		mov	eax, [eax+14h]
		mov	[ebp+Locale], eax

loc_10019D2D:				; CODE XREF: sub_10019BEB+138j
		cmp	[ebp+CodePage],	ebx
		jnz	short loc_10019D3A
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	[ebp+CodePage],	eax

loc_10019D3A:				; CODE XREF: sub_10019BEB+145j
		push	[ebp+Locale]	; Locale
		call	sub_10021420
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10019D4C

loc_10019D48:				; CODE XREF: sub_10019BEB+6Fj
					; sub_10019BEB+ACj ...
		xor	eax, eax
		jmp	short loc_10019D93
; ---------------------------------------------------------------------------

loc_10019D4C:				; CODE XREF: sub_10019BEB+15Bj
		cmp	eax, [ebp+CodePage]
		jz	short loc_10019D6F
		push	ebx		; int
		push	ebx		; int
		lea	ecx, [ebp+cbMultiByte]
		push	ecx		; int
		push	[ebp+lpMultiByteStr] ; int
		push	eax		; UINT
		push	[ebp+CodePage]	; CodePage
		call	sub_10021469
		mov	esi, eax
		add	esp, 18h
		cmp	esi, ebx
		jz	short loc_10019D48
		mov	[ebp+lpMultiByteStr], esi

loc_10019D6F:				; CODE XREF: sub_10019BEB+164j
		push	[ebp+lpCharType] ; lpCharType
		push	[ebp+cbMultiByte] ; cchSrc
		push	[ebp+lpMultiByteStr] ; lpSrcStr
		push	[ebp+dwInfoType] ; dwInfoType
		push	[ebp+Locale]	; Locale
		call	ds:GetStringTypeA
		mov	edi, eax
		cmp	esi, ebx
		jz	short loc_10019D91
		push	esi		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10019D91:				; CODE XREF: sub_10019BEB+19Dj
		mov	eax, edi

loc_10019D93:				; CODE XREF: sub_10019BEB+131j
					; sub_10019BEB+15Fj
		lea	esp, [ebp-14h]
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10019BEB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10019DA5(int,	DWORD dwInfoType, LPCSTR lpMultiByteStr, int cbMultiByte, LPWORD lpCharType, UINT CodePage, LCID Locale, int)
sub_10019DA5	proc near		; CODE XREF: sub_10011BFD+9Cp
					; sub_10012D67+1E5p ...

var_10		= byte ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
dwInfoType	= dword	ptr  0Ch
lpMultiByteStr	= dword	ptr  10h
cbMultiByte	= dword	ptr  14h
lpCharType	= dword	ptr  18h
CodePage	= dword	ptr  1Ch
Locale		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		push	[ebp+arg_1C]	; int
		lea	ecx, [ebp+var_10]
		push	[ebp+Locale]	; Locale
		push	[ebp+CodePage]	; CodePage
		push	[ebp+lpCharType] ; lpCharType
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	[ebp+dwInfoType] ; dwInfoType
		call	sub_10019BEB
		add	esp, 1Ch
		cmp	[ebp+var_4], 0
		jz	short locret_10019DE5
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_10019DE5:			; CODE XREF: sub_10019DA5+37j
		leave
		retn
sub_10019DA5	endp

; ---------------------------------------------------------------------------
		mov	eax, off_1002DFAC
		retn
; ---------------------------------------------------------------------------
		call	sub_10013828
		mov	ecx, eax
		mov	eax, [ecx+6Ch]
		cmp	eax, off_1002DB68
		jz	short loc_10019E13
		test	byte ptr [ecx+70h], 2
		jnz	short loc_10019E13
		test	byte ptr dword_1002DA84, 1
		jz	short loc_10019E13
		call	sub_10012545

loc_10019E13:				; CODE XREF: .text:10019DFDj
					; .text:10019E03j ...
		mov	eax, [eax+0C8h]
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019E1A	proc near		; CODE XREF: sub_1001A990+33p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
Locale		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		movzx	ebx, word ptr [eax+42h]
		push	esi
		mov	esi, ecx
		movzx	ecx, word ptr [eax+44h]
		mov	[ebp+Locale], ecx
		test	esi, esi
		jnz	short loc_10019E3D
		or	eax, 0FFFFFFFFh
		jmp	loc_1001A615
; ---------------------------------------------------------------------------

loc_10019E3D:				; CODE XREF: sub_10019E1A+19j
		and	[ebp+var_8], 0
		push	edi
		mov	[ebp+var_C], eax
		lea	eax, [esi+4]
		push	eax		; int
		push	31h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		mov	edi, eax
		lea	eax, [esi+8]
		push	eax		; int
		push	32h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0Ch]
		push	eax		; int
		push	33h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+10h]
		push	eax		; int
		push	34h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+14h]
		push	eax		; int
		push	35h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+18h]
		push	eax		; int
		push	36h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		push	esi		; int
		push	37h		; LCType
		push	ebx		; Locale
		or	edi, eax
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+20h]
		push	eax		; int
		push	2Ah		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+24h]
		push	eax		; int
		push	2Bh		; LCType
		push	ebx		; Locale
		push	1		; int
		lea	eax, [ebp+var_C]
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+28h]
		push	eax		; int
		push	2Ch		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+2Ch]
		push	eax		; int
		push	2Dh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+30h]
		push	eax		; int
		push	2Eh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+34h]
		push	eax		; int
		push	2Fh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+1Ch]
		push	eax		; int
		push	30h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+38h]
		push	eax		; int
		push	44h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+3Ch]
		push	eax		; int
		push	45h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+40h]
		push	eax		; int
		push	46h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+44h]
		push	eax		; int
		push	47h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+48h]
		push	eax		; int
		push	48h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+4Ch]
		push	eax		; int
		push	49h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+50h]
		push	eax		; int
		push	4Ah		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+54h]
		push	eax		; int
		push	4Bh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+58h]
		push	eax		; int
		push	4Ch		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+5Ch]
		push	eax		; int
		push	4Dh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+60h]
		push	eax		; int
		push	4Eh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+64h]
		push	eax		; int
		push	4Fh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+68h]
		push	eax		; int
		push	38h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+6Ch]
		push	eax		; int
		push	39h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+70h]
		push	eax		; int
		push	3Ah		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+74h]
		push	eax		; int
		push	3Bh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+78h]
		push	eax		; int
		push	3Ch		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+7Ch]
		push	eax		; int
		push	3Dh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+80h]
		push	eax		; int
		push	3Eh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+84h]
		push	eax		; int
		push	3Fh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+88h]
		push	eax		; int
		push	40h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+8Ch]
		push	eax		; int
		push	41h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+90h]
		push	eax		; int
		push	42h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+94h]
		push	eax		; int
		push	43h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+98h]
		push	eax		; int
		push	28h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+9Ch]
		push	eax		; int
		push	29h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+0A0h]
		push	eax		; int
		push	1Fh		; LCType
		push	[ebp+Locale]	; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0A4h]
		push	eax		; int
		push	20h		; LCType
		push	[ebp+Locale]	; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0A8h]
		push	eax		; int
		push	1003h		; LCType
		push	[ebp+Locale]	; Locale
		lea	eax, [ebp+var_C]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0B0h]
		push	eax		; int
		push	1009h		; LCType
		push	[ebp+Locale]	; Locale
		lea	eax, [ebp+var_C]
		push	0		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		mov	eax, [ebp+Locale]
		add	esp, 50h
		mov	[esi+0ACh], eax
		lea	eax, [esi+0BCh]
		push	eax		; int
		push	31h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0C0h]
		push	eax		; int
		push	32h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0C4h]
		push	eax		; int
		push	33h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0C8h]
		push	eax		; int
		push	34h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+0CCh]
		push	eax		; int
		push	35h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0D0h]
		push	eax		; int
		push	36h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0B8h]
		push	eax		; int
		push	37h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0D8h]
		push	eax		; int
		push	2Ah		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+0DCh]
		push	eax		; int
		push	2Bh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0E0h]
		push	eax		; int
		push	2Ch		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0E4h]
		push	eax		; int
		push	2Dh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0E8h]
		push	eax		; int
		push	2Eh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+0ECh]
		push	eax		; int
		push	2Fh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0D4h]
		push	eax		; int
		push	30h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0F0h]
		push	eax		; int
		push	44h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0F4h]
		push	eax		; int
		push	45h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+0F8h]
		push	eax		; int
		push	46h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+0FCh]
		push	eax		; int
		push	47h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+100h]
		push	eax		; int
		push	48h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+104h]
		push	eax		; int
		push	49h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+108h]
		push	eax		; int
		push	4Ah		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+10Ch]
		push	eax		; int
		push	4Bh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+110h]
		push	eax		; int
		push	4Ch		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+114h]
		push	eax		; int
		push	4Dh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+118h]
		push	eax		; int
		push	4Eh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+11Ch]
		push	eax		; int
		push	4Fh		; LCType
		push	ebx		; Locale
		push	2		; int
		lea	eax, [ebp+var_C]
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+120h]
		push	eax		; int
		push	38h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+124h]
		push	eax		; int
		push	39h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+128h]
		push	eax		; int
		push	3Ah		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+12Ch]
		push	eax		; int
		push	3Bh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+130h]
		push	eax		; int
		push	3Ch		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+134h]
		push	eax		; int
		push	3Dh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+138h]
		push	eax		; int
		push	3Eh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+13Ch]
		push	eax		; int
		push	3Fh		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+140h]
		push	eax		; int
		push	40h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+144h]
		push	eax		; int
		push	41h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+148h]
		push	eax		; int
		push	42h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+14Ch]
		push	eax		; int
		push	43h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+150h]
		push	eax		; int
		push	28h		; LCType
		push	ebx		; Locale
		lea	eax, [ebp+var_C]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+154h]
		push	eax		; int
		push	29h		; LCType
		push	ebx		; Locale
		push	2
		pop	ebx
		lea	eax, [ebp+var_C]
		push	ebx		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [esi+158h]
		push	eax		; int
		push	1Fh		; LCType
		push	[ebp+Locale]	; Locale
		lea	eax, [ebp+var_C]
		push	ebx		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [esi+15Ch]
		push	eax		; int
		push	20h		; LCType
		push	[ebp+Locale]	; Locale
		lea	eax, [ebp+var_C]
		push	ebx		; int
		push	eax		; int
		call	sub_10023B86
		add	esi, 160h
		push	esi		; int
		push	1003h		; LCType
		push	[ebp+Locale]	; Locale
		or	edi, eax
		lea	eax, [ebp+var_C]
		push	ebx		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 3Ch
		or	eax, edi
		pop	edi

loc_1001A615:				; CODE XREF: sub_10019E1A+1Ej
		pop	esi
		pop	ebx
		leave
		retn
sub_10019E1A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001A619	proc near		; CODE XREF: sub_10012270+ECp
					; sub_1001A990+3Dp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		test	esi, esi
		jz	loc_1001A98D
		push	dword ptr [esi+4] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+8] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+10h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+14h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+18h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi]	; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+20h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+24h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+28h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+2Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+30h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+34h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+1Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+38h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+3Ch] ; lpMem
		call	sub_1000EE73
		add	esp, 40h
		push	dword ptr [esi+40h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+44h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+48h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+4Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+50h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+54h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+58h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+5Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+60h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+64h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+68h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+6Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+70h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+74h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+78h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+7Ch] ; lpMem
		call	sub_1000EE73
		add	esp, 40h
		push	dword ptr [esi+80h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+84h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+88h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+8Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+90h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+94h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+98h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+9Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0A0h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0A4h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0A8h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0BCh] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0C0h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0C4h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0C8h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0CCh] ; lpMem
		call	sub_1000EE73
		add	esp, 40h
		push	dword ptr [esi+0D0h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0B8h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0D8h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0DCh] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0E0h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0E4h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0E8h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0ECh] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0D4h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0F0h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0F4h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0F8h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0FCh] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+100h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+104h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+108h] ; lpMem
		call	sub_1000EE73
		add	esp, 40h
		push	dword ptr [esi+10Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+110h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+114h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+118h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+11Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+120h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+124h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+128h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+12Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+130h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+134h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+138h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+13Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+140h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+144h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+148h] ; lpMem
		call	sub_1000EE73
		add	esp, 40h
		push	dword ptr [esi+14Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+150h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+154h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+158h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+15Ch] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+160h] ; lpMem
		call	sub_1000EE73
		add	esp, 18h

loc_1001A98D:				; CODE XREF: sub_1001A619+Bj
		pop	esi
		pop	ebp
		retn
sub_1001A619	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001A990	proc near		; DATA XREF: .rdata:10028FF4o

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	dword ptr [esi+20h], 0
		push	edi
		mov	ebx, offset off_1002DFB0
		jz	short loc_1001A9E8
		push	164h
		push	1
		call	sub_1000F496
		mov	edi, eax
		pop	ecx
		pop	ecx
		test	edi, edi
		jnz	short loc_1001A9BF

loc_1001A9BA:				; CODE XREF: sub_1001A990+4Aj
		xor	eax, eax
		inc	eax
		jmp	short loc_1001AA06
; ---------------------------------------------------------------------------

loc_1001A9BF:				; CODE XREF: sub_1001A990+28j
		mov	eax, esi
		mov	ecx, edi
		call	sub_10019E1A
		test	eax, eax
		jz	short loc_1001A9DC
		push	edi
		call	sub_1001A619
		push	edi		; lpMem
		call	sub_1000EE73
		pop	ecx
		pop	ecx
		jmp	short loc_1001A9BA
; ---------------------------------------------------------------------------

loc_1001A9DC:				; CODE XREF: sub_1001A990+3Aj
		mov	dword ptr [edi+0B4h], 1
		jmp	short loc_1001A9EA
; ---------------------------------------------------------------------------

loc_1001A9E8:				; CODE XREF: sub_1001A990+14j
		mov	edi, ebx

loc_1001A9EA:				; CODE XREF: sub_1001A990+56j
		add	esi, 0D4h
		mov	eax, [esi]
		cmp	eax, ebx
		jz	short loc_1001AA02
		add	eax, 0B4h
		push	eax		; lpAddend
		call	ds:InterlockedDecrement

loc_1001AA02:				; CODE XREF: sub_1001A990+64j
		mov	[esi], edi
		xor	eax, eax

loc_1001AA06:				; CODE XREF: sub_1001A990+2Dj
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1001A990	endp

; ---------------------------------------------------------------------------
		xor	dl, dl
		cmp	[ecx], dl
		jz	short locret_1001AA28
		push	ebx
		push	esi

loc_1001AA13:				; CODE XREF: .text:1001AA24j
		mov	al, [ecx]
		cmp	al, 30h
		jl	short loc_1001AA29
		cmp	al, 39h
		jg	short loc_1001AA29
		sub	al, 30h
		mov	[ecx], al

loc_1001AA21:				; CODE XREF: .text:1001AA2Bj
		inc	ecx

loc_1001AA22:				; CODE XREF: .text:1001AA3Cj
		cmp	[ecx], dl
		jnz	short loc_1001AA13
		pop	esi
		pop	ebx

locret_1001AA28:			; CODE XREF: .text:1001AA0Fj
		retn
; ---------------------------------------------------------------------------

loc_1001AA29:				; CODE XREF: .text:1001AA17j
					; .text:1001AA1Bj
		cmp	al, 3Bh
		jnz	short loc_1001AA21
		mov	eax, ecx

loc_1001AA2F:				; CODE XREF: .text:1001AA3Aj
		lea	esi, [eax+1]
		mov	bl, [esi]
		mov	[eax], bl
		mov	eax, esi
		cmp	[eax], dl
		jnz	short loc_1001AA2F
		jmp	short loc_1001AA22

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001AA3E	proc near		; CODE XREF: sub_10012270+67p
					; sub_1001AAA7+117p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		test	esi, esi
		jz	short loc_1001AAA4
		mov	eax, [esi]
		cmp	eax, off_1002E120
		jz	short loc_1001AA5C
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AA5C:				; CODE XREF: sub_1001AA3E+15j
		mov	eax, [esi+4]
		cmp	eax, off_1002E124
		jz	short loc_1001AA6E
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AA6E:				; CODE XREF: sub_1001AA3E+27j
		mov	eax, [esi+8]
		cmp	eax, off_1002E128
		jz	short loc_1001AA80
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AA80:				; CODE XREF: sub_1001AA3E+39j
		mov	eax, [esi+30h]
		cmp	eax, off_1002E150
		jz	short loc_1001AA92
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AA92:				; CODE XREF: sub_1001AA3E+4Bj
		mov	esi, [esi+34h]
		cmp	esi, off_1002E154
		jz	short loc_1001AAA4
		push	esi		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AAA4:				; CODE XREF: sub_1001AA3E+Bj
					; sub_1001AA3E+5Dj
		pop	esi
		pop	ebp
		retn
sub_1001AA3E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001AAA7	proc near		; DATA XREF: .rdata:10028FE8o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpMem		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		xor	edi, edi
		mov	[ebp+var_10], esi
		mov	[ebp+var_C], edi
		cmp	[esi+1Ch], edi
		jnz	short loc_1001AAD7
		cmp	[esi+18h], edi
		jnz	short loc_1001AAD7
		mov	[ebp+var_4], edi
		mov	[ebp+lpMem], edi
		mov	ebx, offset off_1002E120
		jmp	loc_1001AC3F
; ---------------------------------------------------------------------------

loc_1001AAD7:				; CODE XREF: sub_1001AAA7+19j
					; sub_1001AAA7+1Ej
		push	50h
		push	1
		call	sub_1000F496
		mov	ebx, eax
		pop	ecx
		pop	ecx
		cmp	ebx, edi
		jnz	short loc_1001AAF0

loc_1001AAE8:				; CODE XREF: sub_1001AAA7+6Ej
		xor	eax, eax
		inc	eax
		jmp	loc_1001AC95
; ---------------------------------------------------------------------------

loc_1001AAF0:				; CODE XREF: sub_1001AAA7+3Fj
		mov	esi, [esi+0BCh]
		push	14h
		pop	ecx
		mov	edi, ebx
		push	4
		rep movsd
		call	sub_1000F5A0
		xor	edi, edi
		pop	ecx
		mov	[ebp+lpMem], eax
		cmp	eax, edi
		jnz	short loc_1001AB17
		push	ebx		; lpMem
		call	sub_1000EE73
		pop	ecx
		jmp	short loc_1001AAE8
; ---------------------------------------------------------------------------

loc_1001AB17:				; CODE XREF: sub_1001AAA7+65j
		mov	esi, [ebp+arg_0]
		mov	[eax], edi
		cmp	[esi+1Ch], edi
		jz	loc_1001AC01
		push	4
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+var_4], eax
		cmp	eax, edi
		jnz	short loc_1001AB4E
		xor	esi, esi
		inc	esi

loc_1001AB37:				; CODE XREF: sub_1001AAA7+120j
		push	ebx		; lpMem
		call	sub_1000EE73
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx
		pop	ecx
		mov	eax, esi
		jmp	loc_1001AC95
; ---------------------------------------------------------------------------

loc_1001AB4E:				; CODE XREF: sub_1001AAA7+8Bj
		mov	[eax], edi
		movzx	esi, word ptr [esi+3Eh]
		push	ebx		; int
		push	0Eh		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		mov	edi, eax
		lea	eax, [ebx+4]
		push	eax		; int
		push	0Fh		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+8]
		push	eax		; int
		push	10h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+30h]
		push	eax		; int
		push	0Eh		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [ebx+34h]
		push	eax		; int
		push	0Fh		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 14h
		or	eax, edi
		jz	short loc_1001ABCC
		push	ebx
		call	sub_1001AA3E
		pop	ecx
		or	esi, 0FFFFFFFFh
		jmp	loc_1001AB37
; ---------------------------------------------------------------------------

loc_1001ABCC:				; CODE XREF: sub_1001AAA7+114j
		mov	eax, [ebx+8]
		jmp	short loc_1001ABE3
; ---------------------------------------------------------------------------

loc_1001ABD1:				; CODE XREF: sub_1001AAA7+13Fj
		mov	cl, [eax]
		cmp	cl, 30h
		jl	short loc_1001ABEA
		cmp	cl, 39h
		jg	short loc_1001ABEA
		sub	cl, 30h
		mov	[eax], cl

loc_1001ABE2:				; CODE XREF: sub_1001AAA7+146j
		inc	eax

loc_1001ABE3:				; CODE XREF: sub_1001AAA7+128j
					; sub_1001AAA7+158j
		cmp	byte ptr [eax],	0
		jnz	short loc_1001ABD1
		jmp	short loc_1001AC2B
; ---------------------------------------------------------------------------

loc_1001ABEA:				; CODE XREF: sub_1001AAA7+12Fj
					; sub_1001AAA7+134j
		cmp	cl, 3Bh
		jnz	short loc_1001ABE2
		mov	esi, eax

loc_1001ABF1:				; CODE XREF: sub_1001AAA7+156j
		lea	edi, [esi+1]
		mov	cl, [edi]
		mov	[esi], cl
		mov	esi, edi
		cmp	byte ptr [esi],	0
		jnz	short loc_1001ABF1
		jmp	short loc_1001ABE3
; ---------------------------------------------------------------------------

loc_1001AC01:				; CODE XREF: sub_1001AAA7+78j
		mov	eax, off_1002E120
		mov	[ebx], eax
		mov	eax, off_1002E124
		mov	[ebx+4], eax
		mov	eax, off_1002E128
		mov	[ebx+8], eax
		mov	eax, off_1002E150
		mov	[ebx+30h], eax
		mov	eax, off_1002E154
		mov	[ebp+var_4], edi
		mov	[ebx+34h], eax

loc_1001AC2B:				; CODE XREF: sub_1001AAA7+141j
		mov	ecx, [ebp+lpMem]
		mov	esi, [ebp+arg_0]
		xor	eax, eax
		inc	eax
		mov	[ecx], eax
		mov	ecx, [ebp+var_4]
		test	ecx, ecx
		jz	short loc_1001AC3F
		mov	[ecx], eax

loc_1001AC3F:				; CODE XREF: sub_1001AAA7+2Bj
					; sub_1001AAA7+194j
		mov	eax, [esi+0B4h]
		mov	edi, ds:InterlockedDecrement
		test	eax, eax
		jz	short loc_1001AC52
		push	eax		; lpAddend
		call	edi ; InterlockedDecrement

loc_1001AC52:				; CODE XREF: sub_1001AAA7+1A6j
		mov	eax, [esi+0B0h]
		test	eax, eax
		jz	short loc_1001AC7B
		push	eax		; lpAddend
		call	edi ; InterlockedDecrement
		test	eax, eax
		jnz	short loc_1001AC7B
		push	dword ptr [esi+0B0h] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0BCh] ; lpMem
		call	sub_1000EE73
		pop	ecx
		pop	ecx

loc_1001AC7B:				; CODE XREF: sub_1001AAA7+1B3j
					; sub_1001AAA7+1BAj
		mov	eax, [ebp+var_4]
		mov	[esi+0B4h], eax
		mov	eax, [ebp+lpMem]
		mov	[esi+0B0h], eax
		mov	[esi+0BCh], ebx
		xor	eax, eax

loc_1001AC95:				; CODE XREF: sub_1001AAA7+44j
					; sub_1001AAA7+A2j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_1001AAA7	endp

; ---------------------------------------------------------------------------
		xor	dl, dl
		cmp	[ecx], dl
		jz	short locret_1001ACB7
		push	ebx
		push	esi

loc_1001ACA2:				; CODE XREF: .text:1001ACB3j
		mov	al, [ecx]
		cmp	al, 30h
		jl	short loc_1001ACB8
		cmp	al, 39h
		jg	short loc_1001ACB8
		sub	al, 30h
		mov	[ecx], al

loc_1001ACB0:				; CODE XREF: .text:1001ACBAj
		inc	ecx

loc_1001ACB1:				; CODE XREF: .text:1001ACCBj
		cmp	[ecx], dl
		jnz	short loc_1001ACA2
		pop	esi
		pop	ebx

locret_1001ACB7:			; CODE XREF: .text:1001AC9Ej
		retn
; ---------------------------------------------------------------------------

loc_1001ACB8:				; CODE XREF: .text:1001ACA6j
					; .text:1001ACAAj
		cmp	al, 3Bh
		jnz	short loc_1001ACB0
		mov	eax, ecx

loc_1001ACBE:				; CODE XREF: .text:1001ACC9j
		lea	esi, [eax+1]
		mov	bl, [esi]
		mov	[eax], bl
		mov	eax, esi
		cmp	[eax], dl
		jnz	short loc_1001ACBE
		jmp	short loc_1001ACB1

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001ACCD	proc near		; CODE XREF: sub_10012270+46p
					; sub_1001ADCB+24Ep

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		test	esi, esi
		jz	loc_1001ADC8
		mov	eax, [esi+0Ch]
		cmp	eax, off_1002E12C
		jz	short loc_1001ACF0
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001ACF0:				; CODE XREF: sub_1001ACCD+1Aj
		mov	eax, [esi+10h]
		cmp	eax, off_1002E130
		jz	short loc_1001AD02
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AD02:				; CODE XREF: sub_1001ACCD+2Cj
		mov	eax, [esi+14h]
		cmp	eax, off_1002E134
		jz	short loc_1001AD14
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AD14:				; CODE XREF: sub_1001ACCD+3Ej
		mov	eax, [esi+18h]
		cmp	eax, off_1002E138
		jz	short loc_1001AD26
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AD26:				; CODE XREF: sub_1001ACCD+50j
		mov	eax, [esi+1Ch]
		cmp	eax, off_1002E13C
		jz	short loc_1001AD38
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AD38:				; CODE XREF: sub_1001ACCD+62j
		mov	eax, [esi+20h]
		cmp	eax, off_1002E140
		jz	short loc_1001AD4A
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AD4A:				; CODE XREF: sub_1001ACCD+74j
		mov	eax, [esi+24h]
		cmp	eax, off_1002E144
		jz	short loc_1001AD5C
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AD5C:				; CODE XREF: sub_1001ACCD+86j
		mov	eax, [esi+38h]
		cmp	eax, off_1002E158
		jz	short loc_1001AD6E
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AD6E:				; CODE XREF: sub_1001ACCD+98j
		mov	eax, [esi+3Ch]
		cmp	eax, off_1002E15C
		jz	short loc_1001AD80
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AD80:				; CODE XREF: sub_1001ACCD+AAj
		mov	eax, [esi+40h]
		cmp	eax, off_1002E160
		jz	short loc_1001AD92
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001AD92:				; CODE XREF: sub_1001ACCD+BCj
		mov	eax, [esi+44h]
		cmp	eax, off_1002E164
		jz	short loc_1001ADA4
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001ADA4:				; CODE XREF: sub_1001ACCD+CEj
		mov	eax, [esi+48h]
		cmp	eax, off_1002E168
		jz	short loc_1001ADB6
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001ADB6:				; CODE XREF: sub_1001ACCD+E0j
		mov	esi, [esi+4Ch]
		cmp	esi, off_1002E16C
		jz	short loc_1001ADC8
		push	esi		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1001ADC8:				; CODE XREF: sub_1001ACCD+Bj
					; sub_1001ACCD+F2j
		pop	esi
		pop	ebp
		retn
sub_1001ACCD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001ADCB	proc near		; DATA XREF: .rdata:10028FDCo

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpMem		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		xor	edi, edi
		mov	[ebp+var_4], edi
		mov	[ebp+var_10], esi
		mov	[ebp+var_C], edi
		cmp	[esi+18h], edi
		jnz	short loc_1001ADFE
		cmp	[esi+1Ch], edi
		jnz	short loc_1001ADFE
		mov	[ebp+var_4], edi
		mov	[ebp+lpMem], edi
		mov	ebx, offset off_1002E120
		jmp	loc_1001B0D1
; ---------------------------------------------------------------------------

loc_1001ADFE:				; CODE XREF: sub_1001ADCB+1Cj
					; sub_1001ADCB+21j
		push	50h
		push	1
		call	sub_1000F496
		mov	ebx, eax
		pop	ecx
		pop	ecx
		cmp	ebx, edi
		jnz	short loc_1001AE17

loc_1001AE0F:				; CODE XREF: sub_1001ADCB+62j
					; sub_1001ADCB+26Cj
		xor	eax, eax
		inc	eax
		jmp	loc_1001B129
; ---------------------------------------------------------------------------

loc_1001AE17:				; CODE XREF: sub_1001ADCB+42j
		push	4
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+lpMem], eax
		cmp	eax, edi
		jnz	short loc_1001AE2F
		push	ebx		; lpMem
		call	sub_1000EE73

loc_1001AE2C:				; CODE XREF: sub_1001ADCB+8Dj
		pop	ecx
		jmp	short loc_1001AE0F
; ---------------------------------------------------------------------------

loc_1001AE2F:				; CODE XREF: sub_1001ADCB+59j
		mov	[eax], edi
		cmp	[esi+18h], edi
		jz	loc_1001B071
		push	4
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+var_4], eax
		cmp	eax, edi
		jnz	short loc_1001AE5A
		push	ebx		; lpMem
		call	sub_1000EE73
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx
		jmp	short loc_1001AE2C
; ---------------------------------------------------------------------------

loc_1001AE5A:				; CODE XREF: sub_1001ADCB+7Cj
		mov	[eax], edi
		movzx	esi, word ptr [esi+38h]
		lea	eax, [ebx+0Ch]
		push	eax		; int
		push	15h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		mov	edi, eax
		lea	eax, [ebx+10h]
		push	eax		; int
		push	14h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+14h]
		push	eax		; int
		push	16h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+18h]
		push	eax		; int
		push	17h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [ebx+1Ch]
		push	eax		; int
		push	18h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+20h]
		push	eax		; int
		push	50h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+24h]
		push	eax		; int
		push	51h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	1		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+28h]
		push	eax		; int
		push	1Ah		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	0		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [ebx+29h]
		push	eax		; int
		push	19h		; LCType
		push	esi		; Locale
		push	0		; int
		lea	eax, [ebp+var_10]
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+2Ah]
		push	eax		; int
		push	54h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	0		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+2Bh]
		push	eax		; int
		push	55h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	0		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+2Ch]
		push	eax		; int
		push	56h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	0		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [ebx+2Dh]
		push	eax		; int
		push	57h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	0		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+2Eh]
		push	eax		; int
		push	52h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	0		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+2Fh]
		push	eax		; int
		push	53h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	0		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+38h]
		push	eax		; int
		push	15h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [ebx+3Ch]
		push	eax		; int
		push	14h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+40h]
		push	eax		; int
		push	16h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+44h]
		push	eax		; int
		push	17h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		or	edi, eax
		lea	eax, [ebx+48h]
		push	eax		; int
		push	50h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 50h
		or	edi, eax
		lea	eax, [ebx+4Ch]
		push	eax		; int
		push	51h		; LCType
		push	esi		; Locale
		lea	eax, [ebp+var_10]
		push	2		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 14h
		or	eax, edi
		jz	short loc_1001B03C
		push	ebx
		call	sub_1001ACCD
		push	ebx		; lpMem
		call	sub_1000EE73
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		push	[ebp+var_4]	; lpMem
		call	sub_1000EE73
		add	esp, 10h
		jmp	loc_1001AE0F
; ---------------------------------------------------------------------------

loc_1001B03C:				; CODE XREF: sub_1001ADCB+24Bj
		mov	eax, [ebx+1Ch]
		jmp	short loc_1001B053
; ---------------------------------------------------------------------------

loc_1001B041:				; CODE XREF: sub_1001ADCB+28Bj
		mov	cl, [eax]
		cmp	cl, 30h
		jl	short loc_1001B05A
		cmp	cl, 39h
		jg	short loc_1001B05A
		sub	cl, 30h
		mov	[eax], cl

loc_1001B052:				; CODE XREF: sub_1001ADCB+292j
		inc	eax

loc_1001B053:				; CODE XREF: sub_1001ADCB+274j
					; sub_1001ADCB+2A4j
		cmp	byte ptr [eax],	0
		jnz	short loc_1001B041
		jmp	short loc_1001B07D
; ---------------------------------------------------------------------------

loc_1001B05A:				; CODE XREF: sub_1001ADCB+27Bj
					; sub_1001ADCB+280j
		cmp	cl, 3Bh
		jnz	short loc_1001B052
		mov	esi, eax

loc_1001B061:				; CODE XREF: sub_1001ADCB+2A2j
		lea	edi, [esi+1]
		mov	cl, [edi]
		mov	[esi], cl
		mov	esi, edi
		cmp	byte ptr [esi],	0
		jnz	short loc_1001B061
		jmp	short loc_1001B053
; ---------------------------------------------------------------------------

loc_1001B071:				; CODE XREF: sub_1001ADCB+69j
		push	14h
		pop	ecx
		mov	esi, offset off_1002E120
		mov	edi, ebx
		rep movsd

loc_1001B07D:				; CODE XREF: sub_1001ADCB+28Dj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0BCh]
		mov	ecx, [ecx]
		mov	[ebx], ecx
		mov	ecx, [eax+0BCh]
		mov	ecx, [ecx+4]
		mov	esi, [ebp+arg_0]
		mov	[ebx+4], ecx
		mov	ecx, [eax+0BCh]
		mov	ecx, [ecx+8]
		mov	[ebx+8], ecx
		mov	ecx, [eax+0BCh]
		mov	ecx, [ecx+30h]
		mov	[ebx+30h], ecx
		mov	eax, [eax+0BCh]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+lpMem]
		mov	[ebx+34h], eax
		xor	eax, eax
		inc	eax
		xor	edi, edi
		mov	[ecx], eax
		cmp	[ebp+var_4], edi
		jz	short loc_1001B0D1
		mov	ecx, [ebp+var_4]
		mov	[ecx], eax

loc_1001B0D1:				; CODE XREF: sub_1001ADCB+2Ej
					; sub_1001ADCB+2FFj
		mov	eax, [esi+0B8h]
		cmp	eax, edi
		jz	short loc_1001B0E2
		push	eax		; lpAddend
		call	ds:InterlockedDecrement

loc_1001B0E2:				; CODE XREF: sub_1001ADCB+30Ej
		mov	eax, [esi+0B0h]
		cmp	eax, edi
		jz	short loc_1001B10F
		push	eax		; lpAddend
		call	ds:InterlockedDecrement
		test	eax, eax
		jnz	short loc_1001B10F
		push	dword ptr [esi+0BCh] ; lpMem
		call	sub_1000EE73
		push	dword ptr [esi+0B0h] ; lpMem
		call	sub_1000EE73
		pop	ecx
		pop	ecx

loc_1001B10F:				; CODE XREF: sub_1001ADCB+31Fj
					; sub_1001ADCB+32Aj
		mov	eax, [ebp+var_4]
		mov	[esi+0B8h], eax
		mov	eax, [ebp+lpMem]
		mov	[esi+0B0h], eax
		mov	[esi+0BCh], ebx
		xor	eax, eax

loc_1001B129:				; CODE XREF: sub_1001ADCB+47j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_1001ADCB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001B12E	proc near		; DATA XREF: .rdata:10028FD0o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
lpMem		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
CPInfo		= _cpinfo ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		xor	edi, edi
		mov	[ebp+var_2C], edi
		mov	[ebp+var_28], edi
		mov	[ebp+var_20], edi
		mov	[ebp+var_1C], edi
		mov	[ebp+lpMem], edi
		mov	[ebp+var_48], ebx
		mov	[ebp+var_44], edi
		cmp	[ebx+14h], edi
		jz	loc_1001B471
		lea	eax, [ebx+4]
		cmp	[eax], edi
		jnz	short loc_1001B18D
		push	eax		; int
		movzx	eax, word ptr [ebx+30h]
		push	1004h		; LCType
		push	eax		; Locale
		lea	eax, [ebp+var_48]
		push	edi		; int
		push	eax		; int
		call	sub_10023B86
		add	esp, 14h
		test	eax, eax
		jnz	loc_1001B449

loc_1001B18D:				; CODE XREF: sub_1001B12E+3Dj
		push	4
		call	sub_1000F5A0
		push	2
		mov	esi, 180h
		push	esi
		mov	[ebp+var_2C], eax
		call	sub_1000F496
		push	1
		push	esi
		mov	[ebp+var_28], eax
		call	sub_1000F496
		push	1
		push	esi
		mov	[ebp+var_20], eax
		call	sub_1000F496
		push	1
		push	101h
		mov	[ebp+var_1C], eax
		call	sub_1000F496
		add	esp, 24h
		mov	[ebp+lpMem], eax
		cmp	[ebp+var_2C], edi
		jz	loc_1001B449
		cmp	[ebp+var_28], edi
		jz	loc_1001B449
		cmp	eax, edi
		jz	loc_1001B449
		cmp	[ebp+var_20], edi
		jz	loc_1001B449
		cmp	[ebp+var_1C], edi
		jz	loc_1001B449
		mov	eax, [ebp+var_2C]
		mov	[eax], edi
		xor	eax, eax
		lea	edi, [esi-80h]

loc_1001B205:				; CODE XREF: sub_1001B12E+E0j
		mov	ecx, [ebp+lpMem]
		mov	[eax+ecx], al
		inc	eax
		cmp	eax, edi
		jl	short loc_1001B205
		lea	eax, [ebp+CPInfo]
		push	eax		; lpCPInfo
		push	dword ptr [ebx+4] ; CodePage
		call	ds:GetCPInfo
		test	eax, eax
		jz	loc_1001B449
		cmp	[ebp+CPInfo.MaxCharSize], 5
		ja	loc_1001B449
		movzx	eax, word ptr [ebp+CPInfo.MaxCharSize]
		cmp	eax, 1
		mov	[ebp+var_34], eax
		jle	short loc_1001B26A
		cmp	[ebp+CPInfo.LeadByte], 0
		jz	short loc_1001B26A
		lea	eax, [ebp+CPInfo.LeadByte+1]

loc_1001B244:				; CODE XREF: sub_1001B12E+13Aj
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_1001B26A
		movzx	esi, byte ptr [eax-1]
		movzx	ecx, cl
		jmp	short loc_1001B25E
; ---------------------------------------------------------------------------

loc_1001B253:				; CODE XREF: sub_1001B12E+132j
		mov	ecx, [ebp+lpMem]
		mov	byte ptr [esi+ecx], 20h
		movzx	ecx, byte ptr [eax]
		inc	esi

loc_1001B25E:				; CODE XREF: sub_1001B12E+123j
		cmp	esi, ecx
		jle	short loc_1001B253
		inc	eax
		inc	eax
		cmp	byte ptr [eax-1], 0
		jnz	short loc_1001B244

loc_1001B26A:				; CODE XREF: sub_1001B12E+10Bj
					; sub_1001B12E+111j ...
		mov	eax, [ebp+var_28]
		xor	esi, esi
		push	esi		; int
		push	esi		; Locale
		push	dword ptr [ebx+4] ; CodePage
		add	eax, 100h
		push	eax		; lpCharType
		push	edi		; cbMultiByte
		push	[ebp+lpMem]	; lpMultiByteStr
		mov	[ebp+var_3C], eax
		push	1		; dwInfoType
		push	esi		; int
		call	sub_10019DA5
		add	esp, 20h
		test	eax, eax
		jz	loc_1001B449
		mov	ecx, [ebp+var_20]
		mov	eax, [ebp+lpMem]
		push	esi		; int
		push	dword ptr [ebx+4] ; CodePage
		mov	esi, 0FFh
		push	esi		; cchDest
		add	ecx, 81h
		push	ecx		; lpDestStr
		push	esi		; cbMultiByte
		inc	eax
		push	eax		; lpMultiByteStr
		push	edi		; dwMapFlags
		push	dword ptr [ebx+14h] ; Locale
		xor	edi, edi
		push	edi		; int
		mov	[ebp+lpMultiByteStr], eax
		call	sub_10017580
		add	esp, 24h
		test	eax, eax
		jz	loc_1001B449
		mov	eax, [ebp+var_1C]
		push	edi		; int
		push	dword ptr [ebx+4] ; CodePage
		add	eax, 81h
		push	esi		; cchDest
		push	eax		; lpDestStr
		push	esi		; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	200h		; dwMapFlags
		push	dword ptr [ebx+14h] ; Locale
		push	edi		; int
		call	sub_10017580
		add	esp, 24h
		test	eax, eax
		jz	loc_1001B449
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_1C]
		xor	ecx, ecx
		add	eax, 0FEh
		cmp	[ebp+var_34], 1
		mov	[eax], cx
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_20]
		mov	[eax+7Fh], cl
		mov	[edx+7Fh], cl
		lea	ecx, [eax+80h]
		mov	byte ptr [ecx],	0
		mov	[ebp+var_20], ecx
		lea	ecx, [edx+80h]
		mov	[ebp+var_38], ecx
		mov	byte ptr [ecx],	0
		jle	short loc_1001B379
		cmp	[ebp+CPInfo.LeadByte], 0
		jz	short loc_1001B379
		lea	esi, [ebp+CPInfo.LeadByte+1]

loc_1001B336:				; CODE XREF: sub_1001B12E+249j
		mov	cl, [esi]
		test	cl, cl
		jz	short loc_1001B379
		movzx	edi, byte ptr [esi-1]
		movzx	ecx, cl
		cmp	edi, ecx
		mov	[ebp+var_1C], edi
		jg	short loc_1001B371
		mov	ecx, [ebp+var_28]
		lea	ecx, [ecx+edi*2+100h]
		jmp	short loc_1001B359
; ---------------------------------------------------------------------------

loc_1001B356:				; CODE XREF: sub_1001B12E+241j
		mov	ecx, [ebp+lpMultiByteStr]

loc_1001B359:				; CODE XREF: sub_1001B12E+226j
		inc	[ebp+var_1C]
		mov	edi, 8000h
		mov	[ecx], di
		inc	ecx
		inc	ecx
		mov	[ebp+lpMultiByteStr], ecx
		movzx	ecx, byte ptr [esi]
		cmp	[ebp+var_1C], ecx
		jle	short loc_1001B356

loc_1001B371:				; CODE XREF: sub_1001B12E+21Aj
		inc	esi
		inc	esi
		cmp	byte ptr [esi-1], 0
		jnz	short loc_1001B336

loc_1001B379:				; CODE XREF: sub_1001B12E+1FDj
					; sub_1001B12E+203j ...
		mov	edi, [ebp+var_28]
		lea	esi, [edi+200h]
		push	3Fh
		pop	ecx
		rep movsd
		movsw
		push	1Fh
		pop	ecx
		lea	esi, [eax+100h]
		mov	edi, eax
		rep movsd
		movsw
		movsb
		push	1Fh
		lea	esi, [edx+100h]
		pop	ecx
		mov	edi, edx
		rep movsd
		movsw
		movsb
		mov	eax, [ebx+0C0h]
		test	eax, eax
		jz	short loc_1001B3FE
		push	eax		; lpAddend
		call	ds:InterlockedDecrement
		test	eax, eax
		jnz	short loc_1001B3FE
		mov	eax, [ebx+0C4h]
		sub	eax, 0FEh
		push	eax		; lpMem
		call	sub_1000EE73
		mov	eax, [ebx+0CCh]
		mov	esi, 80h
		sub	eax, esi
		push	eax		; lpMem
		call	sub_1000EE73
		mov	eax, [ebx+0D0h]
		sub	eax, esi
		push	eax		; lpMem
		call	sub_1000EE73
		push	dword ptr [ebx+0C0h] ; lpMem
		call	sub_1000EE73
		add	esp, 10h

loc_1001B3FE:				; CODE XREF: sub_1001B12E+283j
					; sub_1001B12E+28Ej
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax], 1
		mov	[ebx+0C0h], eax
		mov	eax, [ebp+var_3C]
		mov	[ebx+0C8h], eax
		mov	eax, [ebp+var_40]
		mov	[ebx+0C4h], eax
		mov	eax, [ebp+var_20]
		mov	[ebx+0CCh], eax
		mov	eax, [ebp+var_38]
		mov	[ebx+0D0h], eax
		mov	eax, [ebp+var_34]
		mov	[ebx+0ACh], eax
		xor	esi, esi

loc_1001B43C:				; CODE XREF: sub_1001B12E+341j
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx
		mov	eax, esi
		jmp	short loc_1001B4B6
; ---------------------------------------------------------------------------

loc_1001B449:				; CODE XREF: sub_1001B12E+59j
					; sub_1001B12E+A4j ...
		push	[ebp+var_2C]	; lpMem
		call	sub_1000EE73
		push	[ebp+var_28]	; lpMem
		call	sub_1000EE73
		push	[ebp+var_20]	; lpMem
		call	sub_1000EE73
		push	[ebp+var_1C]	; lpMem
		call	sub_1000EE73
		xor	esi, esi
		add	esp, 10h
		inc	esi
		jmp	short loc_1001B43C
; ---------------------------------------------------------------------------

loc_1001B471:				; CODE XREF: sub_1001B12E+32j
		lea	esi, [ebx+0C0h]
		mov	eax, [esi]
		cmp	eax, edi
		jz	short loc_1001B484
		push	eax		; lpAddend
		call	ds:InterlockedDecrement

loc_1001B484:				; CODE XREF: sub_1001B12E+34Dj
		mov	[esi], edi
		mov	[ebx+0C4h], edi
		mov	dword ptr [ebx+0C8h], offset asc_10029CF0 ; "	      (((((		     H"
		mov	dword ptr [ebx+0CCh], offset dword_1002A178
		mov	dword ptr [ebx+0D0h], offset dword_1002A2F8
		mov	dword ptr [ebx+0ACh], 1
		xor	eax, eax

loc_1001B4B6:				; CODE XREF: sub_1001B12E+319j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1001B12E	endp

; ---------------------------------------------------------------------------

loc_1001B4C5:				; CODE XREF: .text:1001B4FFj
		call	sub_10013828
		mov	ecx, eax
		mov	eax, [ecx+6Ch]
		cmp	eax, off_1002DB68
		jz	short loc_1001B4EB
		test	byte ptr [ecx+70h], 2
		jnz	short loc_1001B4EB
		test	byte ptr dword_1002DA84, 1
		jz	short loc_1001B4EB
		call	sub_10012545

loc_1001B4EB:				; CODE XREF: .text:1001B4D5j
					; .text:1001B4DBj ...
		mov	eax, [eax+0ACh]
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		test	eax, eax
		jnz	short loc_1001B504
		pop	ebp
		jmp	loc_1001B4C5
; ---------------------------------------------------------------------------

loc_1001B504:				; CODE XREF: .text:1001B4FCj
		mov	eax, [eax]
		mov	eax, [eax+0ACh]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1001B50E	proc near		; CODE XREF: sub_10022F7A:loc_10022FFDp
		call	sub_10013828
		mov	ecx, eax
		mov	eax, [ecx+6Ch]
		cmp	eax, off_1002DB68
		jz	short loc_1001B534
		test	byte ptr [ecx+70h], 2
		jnz	short loc_1001B534
		test	byte ptr dword_1002DA84, 1
		jz	short loc_1001B534
		call	sub_10012545

loc_1001B534:				; CODE XREF: sub_1001B50E+10j
					; sub_1001B50E+16j ...
		mov	eax, [eax+4]
		retn
sub_1001B50E	endp

; ---------------------------------------------------------------------------
		call	sub_10013828
		mov	ecx, eax
		mov	eax, [ecx+6Ch]
		cmp	eax, off_1002DB68
		jz	short loc_1001B55E
		test	byte ptr [ecx+70h], 2
		jnz	short loc_1001B55E
		test	byte ptr dword_1002DA84, 1
		jz	short loc_1001B55E
		call	sub_10012545

loc_1001B55E:				; CODE XREF: .text:1001B548j
					; .text:1001B54Ej ...
		mov	eax, [eax+8]
		retn
; ---------------------------------------------------------------------------
		call	sub_10013828
		mov	ecx, eax
		mov	eax, [ecx+6Ch]
		cmp	eax, off_1002DB68
		jz	short loc_1001B588
		test	byte ptr [ecx+70h], 2
		jnz	short loc_1001B588
		test	byte ptr dword_1002DA84, 1
		jz	short loc_1001B588
		call	sub_10012545

loc_1001B588:				; CODE XREF: .text:1001B572j
					; .text:1001B578j ...
		add	eax, 0Ch
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1001B58C	proc near		; DATA XREF: .rdata:10028FC4o
		xor	eax, eax
		retn
sub_1001B58C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001B58F	proc near		; CODE XREF: .text:1001B6ABp

var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	esi
		push	edi
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_18]
		xor	edi, edi
		call	sub_1000E615
		mov	eax, [ebp+var_18]
		mov	ebx, [eax+0D4h]
		mov	[ebp+var_4], edi

loc_1001B5B3:				; CODE XREF: sub_1001B58F+58j
		mov	ecx, [ebp+var_4]
		shl	ecx, 2
		mov	eax, [ecx+ebx]
		lea	esi, [eax+1]

loc_1001B5BF:				; CODE XREF: sub_1001B58F+35j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B5BF
		sub	eax, esi
		mov	esi, eax
		mov	eax, [ecx+ebx+1Ch]
		lea	ecx, [eax+1]

loc_1001B5D1:				; CODE XREF: sub_1001B58F+47j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B5D1
		sub	eax, ecx
		add	eax, esi
		inc	[ebp+var_4]
		cmp	[ebp+var_4], 7
		lea	edi, [edi+eax+2]
		jb	short loc_1001B5B3
		lea	eax, [edi+1]
		push	eax
		call	sub_1000F5A0
		mov	esi, eax
		pop	ecx
		mov	[ebp+var_8], esi
		test	esi, esi
		jz	loc_1001B694
		and	[ebp+var_4], 0

loc_1001B604:				; CODE XREF: sub_1001B58F+FDj
		mov	eax, [ebp+var_4]
		mov	byte ptr [esi],	3Ah
		push	dword ptr [ebx+eax*4]
		mov	eax, [ebp+var_8]
		inc	esi
		sub	eax, esi
		lea	eax, [eax+edi+1]
		push	eax
		push	esi
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001B634
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001B634:				; CODE XREF: sub_1001B58F+94j
		mov	eax, esi
		lea	ecx, [eax+1]

loc_1001B639:				; CODE XREF: sub_1001B58F+AFj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B639
		sub	eax, ecx
		add	esi, eax
		mov	eax, [ebp+var_4]
		mov	byte ptr [esi],	3Ah
		push	dword ptr [ebx+eax*4+1Ch]
		mov	eax, [ebp+var_8]
		inc	esi
		sub	eax, esi
		lea	eax, [eax+edi+1]
		push	eax
		push	esi
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001B675
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001B675:				; CODE XREF: sub_1001B58F+D5j
		mov	eax, esi
		lea	edx, [eax+1]

loc_1001B67A:				; CODE XREF: sub_1001B58F+F0j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001B67A
		sub	eax, edx
		add	esi, eax
		inc	[ebp+var_4]
		cmp	[ebp+var_4], 7
		jb	loc_1001B604
		mov	[esi], cl

loc_1001B694:				; CODE XREF: sub_1001B58F+6Bj
		cmp	[ebp+var_C], 0
		pop	edi
		pop	esi
		pop	ebx
		jz	short loc_1001B6A4
		mov	eax, [ebp+var_10]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001B6A4:				; CODE XREF: sub_1001B58F+10Cj
		mov	eax, [ebp+var_8]
		leave
		retn
sub_1001B58F	endp

; ---------------------------------------------------------------------------
		push	0
		call	sub_1001B58F
		pop	ecx
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001B6B2	proc near		; CODE XREF: .text:1001B7CEp

var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	esi
		push	edi
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_18]
		xor	edi, edi
		call	sub_1000E615
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0D4h]
		add	eax, 68h
		mov	[ebp+var_8], eax
		mov	ecx, eax
		mov	[ebp+var_4], 0Ch

loc_1001B6E2:				; CODE XREF: sub_1001B6B2+5Bj
		mov	eax, [ecx-30h]
		lea	esi, [eax+1]

loc_1001B6E8:				; CODE XREF: sub_1001B6B2+3Bj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B6E8
		sub	eax, esi
		mov	esi, eax
		mov	eax, [ecx]
		lea	edx, [eax+1]

loc_1001B6F8:				; CODE XREF: sub_1001B6B2+4Bj
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_1001B6F8
		sub	eax, edx
		add	eax, esi
		add	ecx, 4
		dec	[ebp+var_4]
		lea	edi, [edi+eax+2]
		jnz	short loc_1001B6E2
		lea	eax, [edi+1]
		push	eax
		call	sub_1000F5A0
		mov	esi, eax
		pop	ecx
		mov	[ebp+var_4], esi
		test	esi, esi
		jz	loc_1001B7B7
		mov	ebx, [ebp+var_8]
		mov	[ebp+var_8], 0Ch

loc_1001B730:				; CODE XREF: sub_1001B6B2+FDj
		mov	eax, [ebp+var_4]
		mov	byte ptr [esi],	3Ah
		push	dword ptr [ebx-30h]
		inc	esi
		sub	eax, esi
		lea	eax, [eax+edi+1]
		push	eax
		push	esi
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001B75D
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001B75D:				; CODE XREF: sub_1001B6B2+9Aj
		mov	eax, esi
		lea	ecx, [eax+1]

loc_1001B762:				; CODE XREF: sub_1001B6B2+B5j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B762
		sub	eax, ecx
		add	esi, eax
		mov	eax, [ebp+var_4]
		mov	byte ptr [esi],	3Ah
		push	dword ptr [ebx]
		inc	esi
		sub	eax, esi
		lea	eax, [eax+edi+1]
		push	eax
		push	esi
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001B799
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001B799:				; CODE XREF: sub_1001B6B2+D6j
		mov	eax, esi
		lea	ecx, [eax+1]

loc_1001B79E:				; CODE XREF: sub_1001B6B2+F1j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B79E
		sub	eax, ecx
		add	esi, eax
		add	ebx, 4
		dec	[ebp+var_8]
		jnz	loc_1001B730
		mov	[esi], dl

loc_1001B7B7:				; CODE XREF: sub_1001B6B2+6Ej
		cmp	[ebp+var_C], 0
		pop	edi
		pop	esi
		pop	ebx
		jz	short loc_1001B7C7
		mov	eax, [ebp+var_10]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001B7C7:				; CODE XREF: sub_1001B6B2+10Cj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_1001B6B2	endp

; ---------------------------------------------------------------------------
		push	0
		call	sub_1001B6B2
		pop	ecx
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001B7D5	proc near		; CODE XREF: .text:1001BB94p

var_28		= dword	ptr -28h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	ebx
		push	esi
		push	edi
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_28]
		xor	esi, esi
		call	sub_1000E615
		mov	eax, [ebp+var_28]
		mov	ecx, [eax+0D4h]
		mov	[ebp+var_10], ecx
		mov	[ebp+var_4], esi

loc_1001B7FC:				; CODE XREF: sub_1001B7D5+5Bj
		mov	edx, [ebp+var_4]
		shl	edx, 2
		mov	eax, [edx+ecx]
		lea	edi, [eax+1]

loc_1001B808:				; CODE XREF: sub_1001B7D5+38j
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_1001B808
		sub	eax, edi
		mov	edi, eax
		mov	eax, [edx+ecx+1Ch]
		lea	edx, [eax+1]

loc_1001B81A:				; CODE XREF: sub_1001B7D5+4Aj
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_1001B81A
		sub	eax, edx
		add	eax, edi
		inc	[ebp+var_4]
		cmp	[ebp+var_4], 7
		lea	esi, [esi+eax+2]
		jb	short loc_1001B7FC
		lea	edi, [ecx+68h]
		mov	[ebp+var_14], 0Ch

loc_1001B83C:				; CODE XREF: sub_1001B7D5+96j
		mov	eax, [edi-30h]
		lea	ebx, [eax+1]

loc_1001B842:				; CODE XREF: sub_1001B7D5+72j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B842
		sub	eax, ebx
		mov	edx, eax
		mov	eax, [edi]
		lea	ebx, [eax+1]
		mov	[ebp+var_18], ebx

loc_1001B855:				; CODE XREF: sub_1001B7D5+85j
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_1001B855
		sub	eax, [ebp+var_18]
		add	edi, 4
		add	eax, edx
		dec	[ebp+var_14]
		lea	esi, [esi+eax+2]
		jnz	short loc_1001B83C
		mov	eax, [ecx+98h]
		lea	edi, [eax+1]

loc_1001B876:				; CODE XREF: sub_1001B7D5+A6j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B876
		sub	eax, edi
		mov	[ebp+var_14], eax
		mov	eax, [ecx+9Ch]
		lea	edi, [eax+1]

loc_1001B88B:				; CODE XREF: sub_1001B7D5+BBj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B88B
		sub	eax, edi
		mov	[ebp+var_18], eax
		mov	eax, [ecx+0A0h]
		lea	edi, [eax+1]

loc_1001B8A0:				; CODE XREF: sub_1001B7D5+D0j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B8A0
		sub	eax, edi
		mov	ebx, eax
		mov	eax, [ecx+0A4h]
		lea	edi, [eax+1]

loc_1001B8B4:				; CODE XREF: sub_1001B7D5+E4j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B8B4
		sub	eax, edi
		mov	edx, eax
		mov	eax, [ecx+0A8h]
		lea	edi, [eax+1]

loc_1001B8C8:				; CODE XREF: sub_1001B7D5+F8j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001B8C8
		sub	eax, edi
		add	eax, edx
		add	eax, ebx
		add	eax, [ebp+var_18]
		add	eax, [ebp+var_14]
		lea	eax, [esi+eax+169h]
		push	eax
		mov	[ebp+var_8], eax
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+var_14], eax
		test	eax, eax
		jz	loc_1001BB7D
		mov	edx, [ebp+var_10]
		and	[ebp+var_4], 0
		push	59h
		pop	ecx
		mov	esi, edx
		mov	edi, eax
		rep movsd
		mov	[ebp+var_C], eax
		sub	[ebp+var_C], edx
		lea	ebx, [eax+164h]
		lea	edi, [edx+1Ch]
		mov	esi, eax

loc_1001B918:				; CODE XREF: sub_1001B7D5+1CAj
		mov	eax, [ebp+var_4]
		mov	[esi+eax*4], ebx
		push	dword ptr [edi-1Ch]
		mov	eax, esi
		sub	eax, ebx
		add	eax, [ebp+var_8]
		push	eax
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001B945
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001B945:				; CODE XREF: sub_1001B7D5+15Fj
		mov	eax, ebx
		lea	ecx, [eax+1]

loc_1001B94A:				; CODE XREF: sub_1001B7D5+17Aj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B94A
		sub	eax, ecx
		lea	ebx, [ebx+eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+edi], ebx
		push	dword ptr [edi]
		mov	eax, esi
		sub	eax, ebx
		add	eax, [ebp+var_8]
		push	eax
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001B983
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001B983:				; CODE XREF: sub_1001B7D5+19Dj
		mov	eax, ebx
		lea	ecx, [eax+1]

loc_1001B988:				; CODE XREF: sub_1001B7D5+1B8j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B988
		sub	eax, ecx
		inc	[ebp+var_4]
		add	edi, 4
		cmp	[ebp+var_4], 7
		lea	ebx, [ebx+eax+1]
		jb	loc_1001B918
		mov	edi, [ebp+var_10]
		lea	eax, [esi+68h]
		mov	[ebp+var_4], eax
		add	edi, 38h
		mov	[ebp+var_18], 0Ch

loc_1001B9B8:				; CODE XREF: sub_1001B7D5+269j
		mov	eax, [ebp+var_C]
		mov	[edi+eax], ebx
		push	dword ptr [edi]
		mov	eax, esi
		sub	eax, ebx
		add	eax, [ebp+var_8]
		push	eax
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001B9E4
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001B9E4:				; CODE XREF: sub_1001B7D5+1FEj
		mov	eax, ebx
		lea	ecx, [eax+1]

loc_1001B9E9:				; CODE XREF: sub_1001B7D5+219j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001B9E9
		sub	eax, ecx
		lea	ebx, [ebx+eax+1]
		mov	eax, [ebp+var_4]
		mov	[eax], ebx
		push	dword ptr [edi+30h]
		mov	eax, esi
		sub	eax, ebx
		add	eax, [ebp+var_8]
		push	eax
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001BA22
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001BA22:				; CODE XREF: sub_1001B7D5+23Cj
		mov	eax, ebx
		lea	ecx, [eax+1]

loc_1001BA27:				; CODE XREF: sub_1001B7D5+257j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001BA27
		add	[ebp+var_4], 4
		sub	eax, ecx
		add	edi, 4
		dec	[ebp+var_18]
		lea	ebx, [ebx+eax+1]
		jnz	loc_1001B9B8
		mov	edi, [ebp+var_10]
		mov	eax, esi
		sub	eax, ebx
		add	eax, [ebp+var_8]
		mov	[esi+98h], ebx
		push	dword ptr [edi+98h]
		push	eax
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001BA77
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001BA77:				; CODE XREF: sub_1001B7D5+291j
		mov	eax, ebx
		lea	ecx, [eax+1]

loc_1001BA7C:				; CODE XREF: sub_1001B7D5+2ACj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001BA7C
		sub	eax, ecx
		lea	ebx, [ebx+eax+1]
		mov	eax, esi
		sub	eax, ebx
		add	eax, [ebp+var_8]
		mov	[esi+9Ch], ebx
		push	dword ptr [edi+9Ch]
		push	eax
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001BAB9
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001BAB9:				; CODE XREF: sub_1001B7D5+2D3j
		mov	eax, ebx
		lea	ecx, [eax+1]

loc_1001BABE:				; CODE XREF: sub_1001B7D5+2EEj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001BABE
		sub	eax, ecx
		lea	ebx, [ebx+eax+1]
		mov	eax, esi
		sub	eax, ebx
		add	eax, [ebp+var_8]
		mov	[esi+0A0h], ebx
		push	dword ptr [edi+0A0h]
		push	eax
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001BAFB
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001BAFB:				; CODE XREF: sub_1001B7D5+315j
		mov	eax, ebx
		lea	ecx, [eax+1]

loc_1001BB00:				; CODE XREF: sub_1001B7D5+330j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001BB00
		sub	eax, ecx
		lea	ebx, [ebx+eax+1]
		mov	eax, esi
		sub	eax, ebx
		add	eax, [ebp+var_8]
		mov	[esi+0A4h], ebx
		push	dword ptr [edi+0A4h]
		push	eax
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001BB3D
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001BB3D:				; CODE XREF: sub_1001B7D5+357j
		mov	eax, ebx
		lea	ecx, [eax+1]

loc_1001BB42:				; CODE XREF: sub_1001B7D5+372j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001BB42
		sub	eax, ecx
		lea	ebx, [ebx+eax+1]
		mov	[esi+0A8h], ebx
		push	dword ptr [edi+0A8h]
		sub	esi, ebx
		add	esi, [ebp+var_8]
		push	esi
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001BB7D
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_1001BB7D:				; CODE XREF: sub_1001B7D5+11Cj
					; sub_1001B7D5+397j
		cmp	[ebp+var_1C], 0
		pop	edi
		pop	esi
		pop	ebx
		jz	short loc_1001BB8D
		mov	eax, [ebp+var_20]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001BB8D:				; CODE XREF: sub_1001B7D5+3AFj
		mov	eax, [ebp+var_14]
		leave
		retn
sub_1001B7D5	endp

; ---------------------------------------------------------------------------
		push	0
		call	sub_1001B7D5
		pop	ecx
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1001BB9B	proc near		; CODE XREF: sub_1001BC6C+3A8p
		cmp	dword ptr [eax], 0
		push	esi
		mov	esi, edx
		jz	short loc_1001BBB9
		push	edi

loc_1001BBA4:				; CODE XREF: sub_1001BB9B+1Bj
		mov	dl, [esi]
		test	dl, dl
		jz	short loc_1001BBB8
		mov	edi, [ecx]
		mov	[edi], dl
		inc	dword ptr [ecx]
		inc	esi
		dec	dword ptr [eax]
		cmp	dword ptr [eax], 0
		jnz	short loc_1001BBA4

loc_1001BBB8:				; CODE XREF: sub_1001BB9B+Dj
		pop	edi

loc_1001BBB9:				; CODE XREF: sub_1001BB9B+6j
		pop	esi
		retn
sub_1001BB9B	endp

; ---------------------------------------------------------------------------
		cmp	dword ptr [esi], 1
		mov	ecx, [edi]
		push	ebx
		jbe	short loc_1001BBDC

loc_1001BBC3:				; CODE XREF: .text:1001BBDAj
		push	0Ah
		cdq
		pop	ebx
		idiv	ebx
		add	dl, 30h
		mov	[ecx], dl
		inc	ecx
		dec	dword ptr [esi]
		mov	edx, [esi]
		test	eax, eax
		jle	short loc_1001BBDC
		cmp	edx, 1
		ja	short loc_1001BBC3

loc_1001BBDC:				; CODE XREF: .text:1001BBC1j
					; .text:1001BBD5j
		mov	eax, [edi]
		mov	[edi], ecx
		dec	ecx

loc_1001BBE1:				; CODE XREF: .text:1001BBEDj
		mov	bl, [eax]
		mov	dl, [ecx]
		mov	[ecx], bl
		dec	ecx
		mov	[eax], dl
		inc	eax
		cmp	eax, ecx
		jb	short loc_1001BBE1
		pop	ebx
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001BBF1	proc near		; CODE XREF: sub_1001BC6C+238p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		mov	esi, edx
		xor	edx, edx
		mov	[ebp+var_4], edx
		cmp	[ebp+arg_0], edx
		jz	short loc_1001BC3A
		cmp	dword ptr [ecx], 1
		mov	esi, [edi]
		jbe	short loc_1001BC25

loc_1001BC0C:				; CODE XREF: sub_1001BBF1+32j
		push	0Ah
		cdq
		pop	ebx
		idiv	ebx
		add	dl, 30h
		mov	[esi], dl
		inc	esi
		dec	dword ptr [ecx]
		mov	edx, [ecx]
		test	eax, eax
		jle	short loc_1001BC25
		cmp	edx, 1
		ja	short loc_1001BC0C

loc_1001BC25:				; CODE XREF: sub_1001BBF1+19j
					; sub_1001BBF1+2Dj
		mov	eax, [edi]
		mov	[edi], esi
		dec	esi

loc_1001BC2A:				; CODE XREF: sub_1001BBF1+45j
		mov	dl, [eax]
		mov	cl, [esi]
		mov	[esi], dl
		dec	esi
		mov	[eax], cl
		inc	eax
		cmp	eax, esi
		jb	short loc_1001BC2A
		jmp	short loc_1001BC68
; ---------------------------------------------------------------------------

loc_1001BC3A:				; CODE XREF: sub_1001BBF1+12j
		cmp	esi, [ecx]
		jnb	short loc_1001BC66
		dec	esi
		lea	edx, [esi+1]
		test	edx, edx
		jz	short loc_1001BC5D

loc_1001BC46:				; CODE XREF: sub_1001BBF1+6Aj
		push	0Ah
		cdq
		pop	ebx
		idiv	ebx
		mov	ebx, [edi]
		add	dl, 30h
		inc	[ebp+var_4]
		mov	[esi+ebx], dl
		dec	esi
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_1001BC46

loc_1001BC5D:				; CODE XREF: sub_1001BBF1+53j
		mov	eax, [ebp+var_4]
		add	[edi], eax
		sub	[ecx], eax
		jmp	short loc_1001BC68
; ---------------------------------------------------------------------------

loc_1001BC66:				; CODE XREF: sub_1001BBF1+4Bj
		mov	[ecx], edx

loc_1001BC68:				; CODE XREF: sub_1001BBF1+47j
					; sub_1001BBF1+73j
		pop	esi
		pop	ebx
		leave
		retn
sub_1001BBF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001BC6C	proc near		; CODE XREF: sub_1001C020+441p
					; sub_1001C47C+11Dp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		movsx	eax, al
		cmp	eax, 59h
		push	esi
		push	edi
		mov	esi, ecx
		jg	loc_1001BE24
		jz	loc_1001BE0C
		cmp	eax, 49h
		jg	loc_1001BD5B
		jz	loc_1001BD2E
		sub	eax, 4
		jz	loc_1001C019
		sub	eax, 9
		jz	loc_1001C019
		sub	eax, 18h
		jz	short loc_1001BD1D
		sub	eax, 1Ch
		jz	short loc_1001BCFB
		dec	eax
		jz	short loc_1001BCD9
		sub	eax, 6
		jnz	loc_1001BF42
		mov	eax, [esi+8]
		xor	edi, edi
		cmp	eax, edi
		jl	loc_1001BF2A
		cmp	eax, 17h

loc_1001BCCE:				; CODE XREF: sub_1001BC6C+196j
		jg	loc_1001BF2A
		jmp	loc_1001BE99
; ---------------------------------------------------------------------------

loc_1001BCD9:				; CODE XREF: sub_1001BC6C+47j
		mov	esi, [esi+10h]
		xor	edi, edi
		cmp	esi, edi
		jl	loc_1001BF2A
		cmp	esi, 0Bh
		jg	loc_1001BF2A
		mov	edx, [ebp+arg_8]
		mov	edx, [edx+esi*4+68h]
		jmp	loc_1001C00F
; ---------------------------------------------------------------------------

loc_1001BCFB:				; CODE XREF: sub_1001BC6C+44j
		mov	esi, [esi+18h]
		xor	edi, edi
		cmp	esi, edi
		jl	loc_1001BF2A
		cmp	esi, 6
		jg	loc_1001BF2A
		mov	edx, [ebp+arg_8]
		mov	edx, [edx+esi*4+1Ch]
		jmp	loc_1001C00F
; ---------------------------------------------------------------------------

loc_1001BD1D:				; CODE XREF: sub_1001BC6C+3Fj
		mov	eax, [ebx]
		mov	byte ptr [eax],	25h
		mov	eax, [ebp+arg_4]
		inc	dword ptr [ebx]
		dec	dword ptr [eax]
		jmp	loc_1001C019
; ---------------------------------------------------------------------------

loc_1001BD2E:				; CODE XREF: sub_1001BC6C+24j
		mov	eax, [esi+8]
		xor	edi, edi
		cmp	eax, edi
		jl	loc_1001BF2A
		cmp	eax, 17h
		jg	loc_1001BF2A
		cdq
		push	0Ch
		pop	ecx
		idiv	ecx
		mov	eax, edx
		cmp	eax, edi
		jnz	loc_1001BE99
		push	ecx
		pop	eax
		jmp	loc_1001BE99
; ---------------------------------------------------------------------------

loc_1001BD5B:				; CODE XREF: sub_1001BC6C+1Ej
		sub	eax, 4Dh
		jz	loc_1001BE07
		push	6
		pop	ecx
		sub	eax, ecx
		jz	loc_1001BDF3
		dec	eax
		dec	eax
		jz	short loc_1001BDA7
		dec	eax
		dec	eax
		jz	short loc_1001BD89
		dec	eax
		jnz	loc_1001BF42
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		jmp	loc_1001BEE6
; ---------------------------------------------------------------------------

loc_1001BD89:				; CODE XREF: sub_1001BC6C+109j
		mov	eax, [esi+18h]
		xor	edi, edi
		cmp	eax, edi
		jl	loc_1001BF2A
		cmp	eax, ecx
		jg	loc_1001BF2A
		cmp	eax, edi
		jz	short loc_1001BDBE
		lea	ecx, [eax-1]
		jmp	short loc_1001BDBE
; ---------------------------------------------------------------------------

loc_1001BDA7:				; CODE XREF: sub_1001BC6C+105j
		mov	eax, [esi+18h]
		xor	edi, edi
		cmp	eax, edi
		jl	loc_1001BF2A
		cmp	eax, ecx
		jg	loc_1001BF2A
		mov	ecx, eax

loc_1001BDBE:				; CODE XREF: sub_1001BC6C+134j
					; sub_1001BC6C+139j
		mov	eax, [esi+1Ch]
		cmp	eax, edi
		jl	loc_1001BF2A
		cmp	eax, 16Dh
		jg	loc_1001BF2A
		cmp	eax, ecx
		jge	short loc_1001BDDF
		xor	eax, eax
		jmp	loc_1001BE99
; ---------------------------------------------------------------------------

loc_1001BDDF:				; CODE XREF: sub_1001BC6C+16Aj
		push	7
		cdq
		pop	esi
		idiv	esi
		cmp	edx, ecx
		jl	loc_1001BE99
		inc	eax
		jmp	loc_1001BE99
; ---------------------------------------------------------------------------

loc_1001BDF3:				; CODE XREF: sub_1001BC6C+FDj
		mov	eax, [esi]

loc_1001BDF5:				; CODE XREF: sub_1001BC6C+19Ej
		xor	edi, edi
		cmp	eax, edi
		jl	loc_1001BF2A
		cmp	eax, 3Bh
		jmp	loc_1001BCCE
; ---------------------------------------------------------------------------

loc_1001BE07:				; CODE XREF: sub_1001BC6C+F2j
		mov	eax, [esi+4]
		jmp	short loc_1001BDF5
; ---------------------------------------------------------------------------

loc_1001BE0C:				; CODE XREF: sub_1001BC6C+15j
		mov	eax, [esi+14h]
		cdq
		push	64h
		pop	ecx
		idiv	ecx
		push	[ebp+arg_C]
		push	4
		add	eax, 13h
		imul	eax, 64h
		add	eax, edx
		jmp	short loc_1001BE9E
; ---------------------------------------------------------------------------

loc_1001BE24:				; CODE XREF: sub_1001BC6C+Fj
		cmp	eax, 6Dh
		jg	loc_1001BF6A
		jz	loc_1001BF54
		sub	eax, 5Ah
		jz	loc_1001BF7D
		sub	eax, 7
		jz	loc_1001BF1C
		dec	eax
		jz	loc_1001BF02
		dec	eax
		jz	short loc_1001BEAF
		dec	eax
		jz	short loc_1001BE7E
		sub	eax, 6
		jnz	loc_1001BF42
		mov	esi, [esi+1Ch]
		xor	edi, edi
		cmp	esi, edi
		jl	loc_1001BF2A
		cmp	esi, 16Dh
		jg	loc_1001BF2A
		push	[ebp+arg_C]
		lea	eax, [esi+1]
		push	3
		jmp	short loc_1001BE9E
; ---------------------------------------------------------------------------

loc_1001BE7E:				; CODE XREF: sub_1001BC6C+1E4j
		mov	esi, [esi+0Ch]
		cmp	esi, 1
		jl	short loc_1001BE8B
		cmp	esi, 1Fh
		jle	short loc_1001BE97

loc_1001BE8B:				; CODE XREF: sub_1001BC6C+218j
		call	sub_10014BF2
		xor	edi, edi
		jmp	loc_1001BF2F
; ---------------------------------------------------------------------------

loc_1001BE97:				; CODE XREF: sub_1001BC6C+21Dj
		mov	eax, esi

loc_1001BE99:				; CODE XREF: sub_1001BC6C+68j
					; sub_1001BC6C+E2j ...
		push	[ebp+arg_C]

loc_1001BE9C:				; CODE XREF: sub_1001BC6C+335j
		push	2

loc_1001BE9E:				; CODE XREF: sub_1001BC6C+1B6j
					; sub_1001BC6C+210j
		pop	edx

loc_1001BE9F:				; CODE XREF: sub_1001BC6C+372j
		mov	ecx, [ebp+arg_4]
		mov	edi, ebx
		call	sub_1001BBF1
		pop	ecx
		jmp	loc_1001C019
; ---------------------------------------------------------------------------

loc_1001BEAF:				; CODE XREF: sub_1001BC6C+1E1j
		push	[ebp+arg_8]
		xor	edi, edi
		push	[ebp+arg_4]
		push	ebx
		push	esi
		cmp	[ebp+arg_C], edi
		jz	short loc_1001BEFF
		push	1

loc_1001BEC0:				; CODE XREF: sub_1001BC6C+294j
		push	[ebp+arg_0]
		call	sub_1001C020
		add	esp, 18h
		test	eax, eax
		jz	short loc_1001BF42
		mov	eax, [ebp+arg_4]
		cmp	[eax], edi
		jz	short loc_1001BF42
		mov	eax, [ebx]
		push	[ebp+arg_8]
		mov	byte ptr [eax],	20h
		mov	eax, [ebp+arg_4]
		inc	dword ptr [ebx]
		dec	dword ptr [eax]
		push	eax

loc_1001BEE6:				; CODE XREF: sub_1001BC6C+118j
		push	ebx
		push	esi
		push	2

loc_1001BEEA:				; CODE XREF: sub_1001BC6C+34Bj
					; sub_1001BC6C+351j
		push	[ebp+arg_0]
		call	sub_1001C020
		add	esp, 18h
		test	eax, eax
		jnz	loc_1001C019
		jmp	short loc_1001BF42
; ---------------------------------------------------------------------------

loc_1001BEFF:				; CODE XREF: sub_1001BC6C+250j
		push	edi
		jmp	short loc_1001BEC0
; ---------------------------------------------------------------------------

loc_1001BF02:				; CODE XREF: sub_1001BC6C+1DAj
		mov	esi, [esi+10h]
		xor	edi, edi
		cmp	esi, edi
		jl	short loc_1001BF2A
		cmp	esi, 0Bh
		jg	short loc_1001BF2A
		mov	edx, [ebp+arg_8]
		mov	edx, [edx+esi*4+38h]
		jmp	loc_1001C00F
; ---------------------------------------------------------------------------

loc_1001BF1C:				; CODE XREF: sub_1001BC6C+1D3j
		mov	esi, [esi+18h]
		xor	edi, edi
		cmp	esi, edi
		jl	short loc_1001BF2A
		cmp	esi, 6
		jle	short loc_1001BF49

loc_1001BF2A:				; CODE XREF: sub_1001BC6C+59j
					; sub_1001BC6C:loc_1001BCCEj ...
		call	sub_10014BF2

loc_1001BF2F:				; CODE XREF: sub_1001BC6C+226j
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h

loc_1001BF42:				; CODE XREF: sub_1001BC6C+4Cj
					; sub_1001BC6C+10Cj ...
		xor	eax, eax
		jmp	loc_1001C01C
; ---------------------------------------------------------------------------

loc_1001BF49:				; CODE XREF: sub_1001BC6C+2BCj
		mov	edx, [ebp+arg_8]
		mov	edx, [edx+esi*4]
		jmp	loc_1001C00F
; ---------------------------------------------------------------------------

loc_1001BF54:				; CODE XREF: sub_1001BC6C+1C1j
		mov	esi, [esi+10h]
		xor	edi, edi
		cmp	esi, edi
		jl	short loc_1001BF2A
		cmp	esi, 0Bh
		jg	short loc_1001BF2A
		lea	eax, [esi+1]
		jmp	loc_1001BE99
; ---------------------------------------------------------------------------

loc_1001BF6A:				; CODE XREF: sub_1001BC6C+1BBj
		sub	eax, 70h
		jz	short loc_1001BFE3
		sub	eax, 7
		jz	short loc_1001BFC2
		dec	eax
		jz	short loc_1001BFA6
		dec	eax
		jz	short loc_1001BF93
		dec	eax
		jnz	short loc_1001BF42

loc_1001BF7D:				; CODE XREF: sub_1001BC6C+1CAj
		call	sub_100236AF
		xor	edx, edx
		cmp	[esi+20h], edx
		setnz	dl
		mov	edx, lpMultiByteStr[edx*4]
		jmp	short loc_1001C00F
; ---------------------------------------------------------------------------

loc_1001BF93:				; CODE XREF: sub_1001BC6C+30Cj
		push	[ebp+arg_C]
		mov	eax, [esi+14h]
		cdq
		push	64h
		pop	ecx
		idiv	ecx
		mov	eax, edx
		jmp	loc_1001BE9C
; ---------------------------------------------------------------------------

loc_1001BFA6:				; CODE XREF: sub_1001BC6C+309j
		push	[ebp+arg_8]
		xor	edi, edi
		push	[ebp+arg_4]
		push	ebx
		push	esi
		cmp	[ebp+arg_C], edi
		jz	short loc_1001BFBC
		push	1
		jmp	loc_1001BEEA
; ---------------------------------------------------------------------------

loc_1001BFBC:				; CODE XREF: sub_1001BC6C+347j
		push	edi
		jmp	loc_1001BEEA
; ---------------------------------------------------------------------------

loc_1001BFC2:				; CODE XREF: sub_1001BC6C+306j
		mov	eax, [esi+18h]
		xor	edi, edi
		cmp	eax, edi
		jl	loc_1001BF2A
		cmp	eax, 6
		jg	loc_1001BF2A
		push	[ebp+arg_C]
		xor	edx, edx
		inc	edx
		jmp	loc_1001BE9F
; ---------------------------------------------------------------------------

loc_1001BFE3:				; CODE XREF: sub_1001BC6C+301j
		mov	esi, [esi+8]
		xor	edi, edi
		cmp	esi, edi
		jl	loc_1001BF2A
		cmp	esi, 17h
		jg	loc_1001BF2A
		cmp	esi, 0Bh
		mov	edx, [ebp+arg_8]
		jg	short loc_1001C009
		mov	edx, [edx+98h]
		jmp	short loc_1001C00F
; ---------------------------------------------------------------------------

loc_1001C009:				; CODE XREF: sub_1001BC6C+393j
		mov	edx, [edx+9Ch]

loc_1001C00F:				; CODE XREF: sub_1001BC6C+8Aj
					; sub_1001BC6C+ACj ...
		mov	eax, [ebp+arg_4]
		mov	ecx, ebx
		call	sub_1001BB9B

loc_1001C019:				; CODE XREF: sub_1001BC6C+2Dj
					; sub_1001BC6C+36j ...
		xor	eax, eax
		inc	eax

loc_1001C01C:				; CODE XREF: sub_1001BC6C+2D8j
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_1001BC6C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001C020	proc near		; CODE XREF: sub_1001BC6C+257p
					; sub_1001BC6C+281p

var_20		= dword	ptr -20h
Date		= SYSTEMTIME ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_14]
		push	edi
		xor	edi, edi
		sub	eax, edi
		jz	short loc_1001C054
		dec	eax
		jz	short loc_1001C04C
		mov	ebx, [esi+0A8h]
		jmp	short loc_1001C05A
; ---------------------------------------------------------------------------

loc_1001C04C:				; CODE XREF: sub_1001C020+22j
		mov	ebx, [esi+0A4h]
		jmp	short loc_1001C05A
; ---------------------------------------------------------------------------

loc_1001C054:				; CODE XREF: sub_1001C020+1Fj
		mov	ebx, [esi+0A0h]

loc_1001C05A:				; CODE XREF: sub_1001C020+2Aj
					; sub_1001C020+32j
		cmp	dword ptr [esi+0B0h], 1
		mov	eax, [ebp+arg_8]
		jz	loc_1001C162
		cmp	[ebp+arg_4], 2
		mov	ecx, ds:GetDateFormatA
		jnz	short loc_1001C07C
		mov	ecx, ds:GetTimeFormatA

loc_1001C07C:				; CODE XREF: sub_1001C020+54j
		mov	edx, 76Ch
		add	dx, [eax+14h]
		push	edi		; cchDate
		mov	[ebp+Date.wYear], dx
		mov	dx, [eax+10h]
		inc	dx
		mov	[ebp+Date.wMonth], dx
		mov	dx, [eax+0Ch]
		mov	[ebp+Date.wDay], dx
		mov	dx, [eax+8]
		mov	[ebp+Date.wHour], dx
		mov	dx, [eax+4]
		mov	ax, [eax]
		mov	[ebp+Date.wSecond], ax
		push	edi		; lpDateStr
		xor	eax, eax
		push	ebx		; lpFormat
		mov	[ebp+Date.wMilliseconds], ax
		lea	eax, [ebp+Date]
		push	eax		; lpDate
		push	edi		; dwFlags
		push	dword ptr [esi+0ACh] ; Locale
		mov	[ebp+var_C], ecx
		mov	[ebp+Date.wMinute], dx
		call	ecx ; GetDateFormatA
		mov	[ebp+var_20], eax
		cmp	eax, edi
		jz	loc_1001C162
		add	eax, 8
		cmp	eax, 400h
		jg	short loc_1001C0F3
		call	__alloca_probe_16
		mov	eax, esp
		cmp	eax, edi
		jz	short loc_1001C107
		mov	dword ptr [eax], 0CCCCh
		jmp	short loc_1001C104
; ---------------------------------------------------------------------------

loc_1001C0F3:				; CODE XREF: sub_1001C020+BEj
		push	eax
		call	sub_1000F5A0
		pop	ecx
		cmp	eax, edi
		jz	short loc_1001C107
		mov	dword ptr [eax], 0DDDDh

loc_1001C104:				; CODE XREF: sub_1001C020+D1j
		add	eax, 8

loc_1001C107:				; CODE XREF: sub_1001C020+C9j
					; sub_1001C020+DCj
		mov	[ebp+var_8], eax
		cmp	eax, edi
		jz	short loc_1001C162
		push	[ebp+var_20]
		mov	edi, eax
		push	edi
		push	ebx
		lea	eax, [ebp+Date]
		push	eax
		push	0
		push	dword ptr [esi+0ACh]
		call	[ebp+var_C]
		dec	eax
		test	eax, eax
		jle	short loc_1001C144
		mov	esi, [ebp+arg_10]
		mov	ecx, [ebp+arg_C]

loc_1001C12F:				; CODE XREF: sub_1001C020+122j
		cmp	dword ptr [esi], 0
		jbe	short loc_1001C144
		mov	bl, [edi]
		mov	edx, [ecx]
		mov	[edx], bl
		inc	dword ptr [ecx]
		inc	edi
		dec	dword ptr [esi]
		dec	eax
		test	eax, eax
		jg	short loc_1001C12F

loc_1001C144:				; CODE XREF: sub_1001C020+107j
					; sub_1001C020+112j
		push	[ebp+var_8]
		call	sub_10010392
		pop	ecx

loc_1001C14D:				; CODE XREF: sub_1001C020+146j
					; sub_1001C020+154j ...
		xor	eax, eax
		inc	eax

loc_1001C150:				; CODE XREF: sub_1001C020+457j
		lea	esp, [ebp-2Ch]
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
; ---------------------------------------------------------------------------

loc_1001C162:				; CODE XREF: sub_1001C020+44j
					; sub_1001C020+B0j ...
		mov	al, [ebx]
		test	al, al
		jz	short loc_1001C14D
		mov	edi, [ebp+arg_10]
		mov	esi, [ebp+arg_C]

loc_1001C16E:				; CODE XREF: sub_1001C020+1D6j
		mov	ecx, [edi]
		xor	edx, edx
		cmp	ecx, edx
		jz	short loc_1001C14D
		mov	[ebp+var_8], edx
		mov	ecx, ebx

loc_1001C17B:				; CODE XREF: sub_1001C020+15Fj
		inc	ecx
		inc	edx
		cmp	[ecx], al
		jz	short loc_1001C17B
		mov	[ebp+var_C], ecx
		movsx	ecx, al
		cmp	ecx, 64h
		jg	loc_1001C312
		jz	loc_1001C2E4
		cmp	ecx, 27h
		jz	loc_1001C277
		cmp	ecx, 41h
		jz	loc_1001C243
		cmp	ecx, 48h
		jz	short loc_1001C22B
		cmp	ecx, 4Dh
		jz	short loc_1001C201
		cmp	ecx, 61h
		jz	loc_1001C243

loc_1001C1BB:				; CODE XREF: sub_1001C020+1EDj
					; sub_1001C020+213j ...
		push	[ebp+arg_0]
		push	ecx
		call	sub_100175C6
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001C1E7
		cmp	dword ptr [edi], 1
		jbe	short loc_1001C1E7
		lea	eax, [ebx+1]
		cmp	byte ptr [eax],	0
		jz	loc_1001C475
		mov	dl, [ebx]
		mov	ecx, [esi]
		mov	[ecx], dl
		inc	dword ptr [esi]
		dec	dword ptr [edi]
		mov	ebx, eax

loc_1001C1E7:				; CODE XREF: sub_1001C020+1A8j
					; sub_1001C020+1ADj
		mov	cl, [ebx]
		mov	eax, [esi]
		mov	[eax], cl
		inc	dword ptr [esi]
		inc	ebx
		dec	dword ptr [edi]

loc_1001C1F2:				; CODE XREF: sub_1001C020+25Cj
					; sub_1001C020+26Fj ...
		mov	al, [ebx]
		test	al, al
		jnz	loc_1001C16E
		jmp	loc_1001C14D
; ---------------------------------------------------------------------------

loc_1001C201:				; CODE XREF: sub_1001C020+190j
		mov	eax, edx
		dec	eax
		jz	short loc_1001C21D
		dec	eax
		jz	short loc_1001C224
		dec	eax
		jz	short loc_1001C216
		dec	eax
		jnz	short loc_1001C1BB
		mov	al, 42h
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C216:				; CODE XREF: sub_1001C020+1EAj
		mov	al, 62h
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C21D:				; CODE XREF: sub_1001C020+1E4j
		mov	[ebp+var_8], 1

loc_1001C224:				; CODE XREF: sub_1001C020+1E7j
		mov	al, 6Dh
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C22B:				; CODE XREF: sub_1001C020+18Bj
		mov	eax, edx
		dec	eax
		jz	short loc_1001C235
		dec	eax
		jz	short loc_1001C23C
		jmp	short loc_1001C1BB
; ---------------------------------------------------------------------------

loc_1001C235:				; CODE XREF: sub_1001C020+20Ej
		mov	[ebp+var_8], 1

loc_1001C23C:				; CODE XREF: sub_1001C020+211j
		mov	al, 48h
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C243:				; CODE XREF: sub_1001C020+182j
					; sub_1001C020+195j
		push	offset aAmPm	; "am/pm"
		push	ebx
		call	sub_10023D60
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001C259
		add	ebx, 5
		jmp	short loc_1001C26D
; ---------------------------------------------------------------------------

loc_1001C259:				; CODE XREF: sub_1001C020+232j
		push	offset aAP	; "a/p"
		push	ebx
		call	sub_10023D60
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001C270
		add	ebx, 3

loc_1001C26D:				; CODE XREF: sub_1001C020+237j
		mov	[ebp+var_C], ebx

loc_1001C270:				; CODE XREF: sub_1001C020+248j
		mov	al, 70h
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C277:				; CODE XREF: sub_1001C020+179j
		add	ebx, edx
		test	dl, 1
		jz	loc_1001C1F2
		mov	al, [ebx]
		test	al, al
		jz	loc_1001C14D

loc_1001C28C:				; CODE XREF: sub_1001C020+2B7j
		cmp	dword ptr [edi], 0
		jz	loc_1001C1F2
		cmp	al, 27h
		jz	short loc_1001C2DE
		push	[ebp+arg_0]
		movsx	eax, al
		push	eax
		call	sub_100175C6
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001C2C8
		cmp	dword ptr [edi], 1
		jbe	short loc_1001C2C8
		lea	eax, [ebx+1]
		cmp	byte ptr [eax],	0
		jz	loc_1001C475
		mov	dl, [ebx]
		mov	ecx, [esi]
		mov	[ecx], dl
		inc	dword ptr [esi]
		dec	dword ptr [edi]
		mov	ebx, eax

loc_1001C2C8:				; CODE XREF: sub_1001C020+289j
					; sub_1001C020+28Ej
		mov	eax, [esi]
		mov	cl, [ebx]
		mov	[eax], cl
		inc	dword ptr [esi]
		inc	ebx
		dec	dword ptr [edi]
		mov	al, [ebx]
		test	al, al
		jnz	short loc_1001C28C
		jmp	loc_1001C1F2
; ---------------------------------------------------------------------------

loc_1001C2DE:				; CODE XREF: sub_1001C020+277j
		inc	ebx
		jmp	loc_1001C1F2
; ---------------------------------------------------------------------------

loc_1001C2E4:				; CODE XREF: sub_1001C020+170j
		mov	eax, edx
		dec	eax
		jz	short loc_1001C304
		dec	eax
		jz	short loc_1001C30B
		dec	eax
		jz	short loc_1001C2FD
		dec	eax
		jnz	loc_1001C1BB
		mov	al, 41h
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C2FD:				; CODE XREF: sub_1001C020+2CDj
		mov	al, 61h
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C304:				; CODE XREF: sub_1001C020+2C7j
		mov	[ebp+var_8], 1

loc_1001C30B:				; CODE XREF: sub_1001C020+2CAj
		mov	al, 64h
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C312:				; CODE XREF: sub_1001C020+16Aj
		mov	eax, ecx
		sub	eax, 68h
		jz	loc_1001C43C
		sub	eax, 5
		jz	loc_1001C424
		sub	eax, 6
		jz	loc_1001C40C
		dec	eax
		jz	short loc_1001C357
		sub	eax, 5
		jnz	loc_1001C1BB
		mov	eax, edx
		dec	eax
		dec	eax
		jz	short loc_1001C350
		dec	eax
		dec	eax
		jnz	loc_1001C1BB
		mov	al, 59h
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C350:				; CODE XREF: sub_1001C020+31Fj
		mov	al, 79h
		jmp	loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C357:				; CODE XREF: sub_1001C020+310j
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax+8], 0Bh
		mov	eax, [ebp+arg_14]
		jg	short loc_1001C36B
		mov	ebx, [eax+98h]
		jmp	short loc_1001C371
; ---------------------------------------------------------------------------

loc_1001C36B:				; CODE XREF: sub_1001C020+341j
		mov	ebx, [eax+9Ch]

loc_1001C371:				; CODE XREF: sub_1001C020+349j
		cmp	edx, 1
		jnz	loc_1001C404
		cmp	dword ptr [edi], 0
		jbe	loc_1001C404
		movsx	eax, byte ptr [ebx]
		push	[ebp+arg_0]
		push	eax
		call	sub_100175C6
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001C3B2
		cmp	dword ptr [edi], 1
		jbe	short loc_1001C3B2
		lea	eax, [ebx+1]
		cmp	byte ptr [eax],	0
		jz	loc_1001C475
		mov	dl, [ebx]
		mov	ecx, [esi]
		mov	[ecx], dl
		inc	dword ptr [esi]
		dec	dword ptr [edi]
		mov	ebx, eax

loc_1001C3B2:				; CODE XREF: sub_1001C020+373j
					; sub_1001C020+378j
		mov	eax, [esi]
		mov	cl, [ebx]
		mov	[eax], cl
		inc	dword ptr [esi]
		dec	dword ptr [edi]
		jmp	loc_1001C46D
; ---------------------------------------------------------------------------

loc_1001C3C1:				; CODE XREF: sub_1001C020+3E8j
		cmp	dword ptr [edi], 0
		jbe	loc_1001C46D
		push	[ebp+arg_0]
		movsx	eax, al
		push	eax
		call	sub_100175C6
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001C3F9
		cmp	dword ptr [edi], 1
		jbe	short loc_1001C3F9
		lea	eax, [ebx+1]
		cmp	byte ptr [eax],	0
		jz	loc_1001C475
		mov	dl, [ebx]
		mov	ecx, [esi]
		mov	[ecx], dl
		inc	dword ptr [esi]
		dec	dword ptr [edi]
		mov	ebx, eax

loc_1001C3F9:				; CODE XREF: sub_1001C020+3BAj
					; sub_1001C020+3BFj
		mov	cl, [ebx]
		mov	eax, [esi]
		mov	[eax], cl
		inc	dword ptr [esi]
		inc	ebx
		dec	dword ptr [edi]

loc_1001C404:				; CODE XREF: sub_1001C020+354j
					; sub_1001C020+35Dj
		mov	al, [ebx]
		test	al, al
		jnz	short loc_1001C3C1
		jmp	short loc_1001C46D
; ---------------------------------------------------------------------------

loc_1001C40C:				; CODE XREF: sub_1001C020+309j
		mov	eax, edx
		dec	eax
		jz	short loc_1001C419
		dec	eax
		jz	short loc_1001C420
		jmp	loc_1001C1BB
; ---------------------------------------------------------------------------

loc_1001C419:				; CODE XREF: sub_1001C020+3EFj
		mov	[ebp+var_8], 1

loc_1001C420:				; CODE XREF: sub_1001C020+3F2j
		mov	al, 53h
		jmp	short loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C424:				; CODE XREF: sub_1001C020+300j
		mov	eax, edx
		dec	eax
		jz	short loc_1001C431
		dec	eax
		jz	short loc_1001C438
		jmp	loc_1001C1BB
; ---------------------------------------------------------------------------

loc_1001C431:				; CODE XREF: sub_1001C020+407j
		mov	[ebp+var_8], 1

loc_1001C438:				; CODE XREF: sub_1001C020+40Aj
		mov	al, 4Dh
		jmp	short loc_1001C452
; ---------------------------------------------------------------------------

loc_1001C43C:				; CODE XREF: sub_1001C020+2F7j
		mov	eax, edx
		dec	eax
		jz	short loc_1001C449
		dec	eax
		jz	short loc_1001C450
		jmp	loc_1001C1BB
; ---------------------------------------------------------------------------

loc_1001C449:				; CODE XREF: sub_1001C020+41Fj
		mov	[ebp+var_8], 1

loc_1001C450:				; CODE XREF: sub_1001C020+422j
		mov	al, 49h

loc_1001C452:				; CODE XREF: sub_1001C020+1F1j
					; sub_1001C020+1F8j ...
		push	[ebp+var_8]
		mov	ecx, [ebp+arg_8]
		push	[ebp+arg_14]
		mov	ebx, esi
		push	edi
		push	[ebp+arg_0]
		call	sub_1001BC6C
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001C475

loc_1001C46D:				; CODE XREF: sub_1001C020+39Cj
					; sub_1001C020+3A4j ...
		mov	ebx, [ebp+var_C]
		jmp	loc_1001C1F2
; ---------------------------------------------------------------------------

loc_1001C475:				; CODE XREF: sub_1001C020+1B5j
					; sub_1001C020+296j ...
		xor	eax, eax
		jmp	loc_1001C150
sub_1001C020	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001C47C	proc near		; CODE XREF: .text:1001C64Bp
					; .text:1001C66Ap ...

var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		push	ebx
		push	[ebp+arg_14]
		xor	ebx, ebx
		lea	ecx, [ebp+var_20]
		mov	[ebp+var_8], ebx
		mov	[ebp+var_10], eax
		call	sub_1000E615
		mov	eax, [ebp+arg_0]
		cmp	eax, ebx
		jnz	short loc_1001C4CD
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_14], bl
		jz	short loc_1001C4C6
		mov	eax, [ebp+var_18]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001C4C6:				; CODE XREF: sub_1001C47C+41j
		xor	eax, eax
		jmp	loc_1001C632
; ---------------------------------------------------------------------------

loc_1001C4CD:				; CODE XREF: sub_1001C47C+24j
		push	edi
		mov	edi, [ebp+arg_4]
		cmp	edi, ebx
		jnz	short loc_1001C500
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_14], bl
		jz	short loc_1001C4F9
		mov	eax, [ebp+var_18]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001C4F9:				; CODE XREF: sub_1001C47C+74j
		xor	eax, eax
		jmp	loc_1001C631
; ---------------------------------------------------------------------------

loc_1001C500:				; CODE XREF: sub_1001C47C+57j
		push	esi
		mov	esi, [ebp+arg_8]
		mov	[eax], bl
		cmp	esi, ebx
		jz	loc_1001C60A
		mov	eax, [ebp+arg_10]
		cmp	eax, ebx
		jnz	short loc_1001C51E
		mov	eax, [ebp+var_20]
		mov	eax, [eax+0D4h]

loc_1001C51E:				; CODE XREF: sub_1001C47C+97j
		mov	[ebp+var_C], eax
		mov	[ebp+var_4], edi
		cmp	edi, ebx
		jbe	loc_1001C5D1

loc_1001C52C:				; CODE XREF: sub_1001C47C+12Fj
		mov	al, [esi]
		cmp	al, bl
		jz	short loc_1001C5B1
		cmp	al, 25h
		jz	short loc_1001C577
		lea	ecx, [ebp+var_20]
		movsx	eax, al
		push	ecx
		push	eax
		call	sub_100175C6
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001C567
		xor	ecx, ecx
		inc	ecx
		cmp	[ebp+var_4], ecx
		jbe	short loc_1001C567
		lea	eax, [esi+1]
		cmp	[eax], bl
		jz	short loc_1001C5CE
		mov	cl, [esi]
		mov	edx, [ebp+arg_0]
		mov	[edx], cl
		inc	[ebp+arg_0]
		dec	[ebp+var_4]
		mov	esi, eax

loc_1001C567:				; CODE XREF: sub_1001C47C+CBj
					; sub_1001C47C+D3j
		mov	al, [esi]
		mov	ecx, [ebp+arg_0]
		mov	[ecx], al
		inc	[ebp+arg_0]
		inc	esi
		dec	[ebp+var_4]
		jmp	short loc_1001C5A8
; ---------------------------------------------------------------------------

loc_1001C577:				; CODE XREF: sub_1001C47C+B8j
		mov	ecx, [ebp+arg_C]
		cmp	ecx, ebx
		jz	short loc_1001C5ED
		inc	esi
		cmp	byte ptr [esi],	23h
		jnz	short loc_1001C588
		xor	ebx, ebx
		inc	ebx
		inc	esi

loc_1001C588:				; CODE XREF: sub_1001C47C+106j
		push	ebx
		push	[ebp+var_C]
		lea	eax, [ebp+var_4]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		mov	al, [esi]
		lea	ebx, [ebp+arg_0]
		call	sub_1001BC6C
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001C5FA
		inc	esi
		xor	ebx, ebx

loc_1001C5A8:				; CODE XREF: sub_1001C47C+F9j
		cmp	[ebp+var_4], ebx
		ja	loc_1001C52C

loc_1001C5B1:				; CODE XREF: sub_1001C47C+B4j
		cmp	[ebp+var_4], ebx
		jbe	short loc_1001C5D1
		mov	eax, [ebp+arg_0]
		mov	[eax], bl
		sub	edi, [ebp+var_4]
		mov	eax, edi
		cmp	[ebp+var_14], bl
		jz	short loc_1001C630
		mov	ecx, [ebp+var_18]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	short loc_1001C630
; ---------------------------------------------------------------------------

loc_1001C5CE:				; CODE XREF: sub_1001C47C+DAj
		mov	[ebp+var_8], ecx

loc_1001C5D1:				; CODE XREF: sub_1001C47C+AAj
					; sub_1001C47C+138j ...
		mov	eax, [ebp+var_10]
		mov	[eax], bl
		cmp	[ebp+var_8], ebx
		jnz	short loc_1001C60A
		cmp	[ebp+var_4], ebx
		ja	short loc_1001C60A
		call	sub_10014BF2
		mov	dword ptr [eax], 22h
		jmp	short loc_1001C622
; ---------------------------------------------------------------------------

loc_1001C5ED:				; CODE XREF: sub_1001C47C+100j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		jmp	short loc_1001C622
; ---------------------------------------------------------------------------

loc_1001C5FA:				; CODE XREF: sub_1001C47C+127j
		xor	ebx, ebx
		cmp	[ebp+var_4], ebx
		jbe	short loc_1001C5D1
		mov	[ebp+var_8], 1
		jmp	short loc_1001C5D1
; ---------------------------------------------------------------------------

loc_1001C60A:				; CODE XREF: sub_1001C47C+8Cj
					; sub_1001C47C+15Dj ...
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h

loc_1001C622:				; CODE XREF: sub_1001C47C+16Fj
					; sub_1001C47C+17Cj
		cmp	[ebp+var_14], bl
		jz	short loc_1001C62E
		mov	eax, [ebp+var_18]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001C62E:				; CODE XREF: sub_1001C47C+1A9j
		xor	eax, eax

loc_1001C630:				; CODE XREF: sub_1001C47C+147j
					; sub_1001C47C+150j
		pop	esi

loc_1001C631:				; CODE XREF: sub_1001C47C+7Fj
		pop	edi

loc_1001C632:				; CODE XREF: sub_1001C47C+4Cj
		pop	ebx
		leave
		retn
sub_1001C47C	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+18h]
		push	0
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_1001C47C
		add	esp, 18h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	0
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_1001C47C
		add	esp, 18h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	dword ptr [ebp+18h]
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_1001C47C
		add	esp, 18h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		call	sub_10013828
		mov	ecx, [eax+6Ch]
		cmp	ecx, off_1002DB68
		jz	short loc_1001C6B8
		test	byte ptr [eax+70h], 2
		jnz	short loc_1001C6B8
		test	byte ptr dword_1002DA84, 1
		jz	short loc_1001C6B8
		call	sub_10012545

loc_1001C6B8:				; CODE XREF: .text:1001C6A2j
					; .text:1001C6A8j ...
		mov	eax, off_1002E170
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001C6BE	proc near		; CODE XREF: sub_100127AE+1Fp
					; sub_10012984+6Cp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	ebx
		xor	ebx, ebx
		push	esi
		push	edi
		cmp	eax, ebx
		jz	short loc_1001C6D6
		mov	edi, [ebp+arg_4]
		cmp	edi, ebx
		ja	short loc_1001C6F1

loc_1001C6D6:				; CODE XREF: sub_1001C6BE+Fj
					; sub_1001C6BE+3Cj
		call	sub_10014BF2
		push	16h
		pop	esi
		mov	[eax], esi

loc_1001C6E0:				; CODE XREF: sub_1001C6BE+6Bj
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, esi
		jmp	short loc_1001C72D
; ---------------------------------------------------------------------------

loc_1001C6F1:				; CODE XREF: sub_1001C6BE+16j
		mov	esi, [ebp+arg_8]
		cmp	esi, ebx
		jnz	short loc_1001C6FC

loc_1001C6F8:				; CODE XREF: sub_1001C6BE+4Aj
		mov	[eax], bl
		jmp	short loc_1001C6D6
; ---------------------------------------------------------------------------

loc_1001C6FC:				; CODE XREF: sub_1001C6BE+38j
		mov	edx, eax

loc_1001C6FE:				; CODE XREF: sub_1001C6BE+46j
		cmp	[edx], bl
		jz	short loc_1001C706
		inc	edx
		dec	edi
		jnz	short loc_1001C6FE

loc_1001C706:				; CODE XREF: sub_1001C6BE+42j
		cmp	edi, ebx
		jz	short loc_1001C6F8

loc_1001C70A:				; CODE XREF: sub_1001C6BE+57j
		mov	cl, [esi]
		mov	[edx], cl
		inc	edx
		inc	esi
		cmp	cl, bl
		jz	short loc_1001C717
		dec	edi
		jnz	short loc_1001C70A

loc_1001C717:				; CODE XREF: sub_1001C6BE+54j
		cmp	edi, ebx
		jnz	short loc_1001C72B
		mov	[eax], bl
		call	sub_10014BF2
		push	22h
		pop	ecx
		mov	[eax], ecx
		mov	esi, ecx
		jmp	short loc_1001C6E0
; ---------------------------------------------------------------------------

loc_1001C72B:				; CODE XREF: sub_1001C6BE+5Bj
		xor	eax, eax

loc_1001C72D:				; CODE XREF: sub_1001C6BE+31j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1001C6BE	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001C740	proc near		; CODE XREF: sub_100127EE+6Dp
					; sub_100127EE+112p ...

var_24		= dword	ptr -24h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		mov	edx, [ebp+arg_4]
		lea	ecx, [ecx+0]

loc_1001C754:				; CODE XREF: sub_1001C740+21j
		mov	al, [edx]
		or	al, al
		jz	short loc_1001C763
		add	edx, 1
		bts	[esp+24h+var_24], eax
		jmp	short loc_1001C754
; ---------------------------------------------------------------------------

loc_1001C763:				; CODE XREF: sub_1001C740+18j
		mov	esi, [ebp+arg_0]
		or	ecx, 0FFFFFFFFh
		lea	ecx, [ecx+0]

loc_1001C76C:				; CODE XREF: sub_1001C740+3Cj
		add	ecx, 1
		mov	al, [esi]
		or	al, al
		jz	short loc_1001C77E
		add	esi, 1
		bt	[esp+24h+var_24], eax
		jnb	short loc_1001C76C

loc_1001C77E:				; CODE XREF: sub_1001C740+33j
		mov	eax, ecx
		add	esp, 20h
		pop	esi
		leave
		retn
sub_1001C740	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001C786	proc near		; CODE XREF: sub_1001CDB0+43p
					; sub_1001CDB0+83p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		push	ebx
		xor	ebx, ebx
		inc	eax
		cmp	[ebp+arg_4], ebx
		jl	short loc_1001C7DC
		push	esi
		push	edi

loc_1001C798:				; CODE XREF: sub_1001C786+52j
		test	eax, eax
		jz	short loc_1001C7DA
		mov	eax, [ebp+arg_4]
		add	eax, ebx
		cdq
		sub	eax, edx
		mov	esi, eax
		mov	eax, [ebp+arg_0]
		sar	esi, 1
		lea	edi, [eax+esi*8]
		push	dword ptr [edi]
		mov	eax, [ebp+arg_8]
		push	dword ptr [eax]
		call	sub_10023E83
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001C7CA
		mov	ecx, [ebp+arg_8]
		add	edi, 4
		mov	[ecx], edi
		jmp	short loc_1001C7D5
; ---------------------------------------------------------------------------

loc_1001C7CA:				; CODE XREF: sub_1001C786+38j
		jge	short loc_1001C7D2
		dec	esi
		mov	[ebp+arg_4], esi
		jmp	short loc_1001C7D5
; ---------------------------------------------------------------------------

loc_1001C7D2:				; CODE XREF: sub_1001C786:loc_1001C7CAj
		lea	ebx, [esi+1]

loc_1001C7D5:				; CODE XREF: sub_1001C786+42j
					; sub_1001C786+4Aj
		cmp	ebx, [ebp+arg_4]
		jle	short loc_1001C798

loc_1001C7DA:				; CODE XREF: sub_1001C786+14j
		pop	edi
		pop	esi

loc_1001C7DC:				; CODE XREF: sub_1001C786+Ej
		xor	ecx, ecx
		test	eax, eax
		setz	cl
		pop	ebx
		mov	eax, ecx
		pop	ebp
		retn
sub_1001C786	endp

; ---------------------------------------------------------------------------
		or	dword ptr [esi+8], 104h
		call	ds:GetUserDefaultLCID
		mov	[esi+1Ch], eax
		mov	[esi+18h], eax
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001C7FC	proc near		; CODE XREF: sub_1001CDB0+110p

LCData		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	ebx
		push	esi
		push	edi
		test	eax, eax
		jz	short loc_1001C847
		cmp	byte ptr [eax],	0
		jz	short loc_1001C847
		push	4
		mov	edi, offset dword_1002AF40
		mov	esi, eax
		pop	ecx
		xor	ebx, ebx
		repe cmpsb
		jz	short loc_1001C847
		push	4
		mov	edi, offset dword_1002AF3C
		mov	esi, eax
		pop	ecx
		xor	ebx, ebx
		repe cmpsb
		jnz	short loc_1001C862
		push	8
		lea	eax, [ebp+LCData]
		push	eax
		push	0Bh
		jmp	short loc_1001C852
; ---------------------------------------------------------------------------

loc_1001C847:				; CODE XREF: sub_1001C7FC+1Aj
					; sub_1001C7FC+1Fj ...
		push	8		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		push	1004h		; LCType

loc_1001C852:				; CODE XREF: sub_1001C7FC+49j
		push	dword ptr [edx+1Ch] ; Locale
		call	ds:GetLocaleInfoA
		test	eax, eax
		jz	short loc_1001C869
		lea	eax, [ebp+LCData]

loc_1001C862:				; CODE XREF: sub_1001C7FC+3Fj
		push	eax
		call	sub_10011024
		pop	ecx

loc_1001C869:				; CODE XREF: sub_1001C7FC+61j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1001C7FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001C878	proc near		; CODE XREF: sub_1001C8EB+69p
					; LocaleEnumProc+F9p

arg_0		= word ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		xor	eax, eax

loc_1001C87F:				; CODE XREF: sub_1001C878+19j
		mov	cx, [ebp+arg_0]
		cmp	cx, ds:word_1002AF28[eax]
		jz	short loc_1001C898
		inc	eax
		inc	eax
		cmp	eax, 14h
		jb	short loc_1001C87F
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001C898:				; CODE XREF: sub_1001C878+12j
		xor	eax, eax
		pop	ebp
		retn
sub_1001C878	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001C89C	proc near		; CODE XREF: sub_1001C8EB+26p
					; sub_1001C983+3Cp ...
		mov	edi, edi
		push	esi
		xor	esi, esi
		jmp	short loc_1001C8C6
; ---------------------------------------------------------------------------

loc_1001C8A3:				; CODE XREF: sub_1001C89C+2Ej
		mov	al, cl
		sub	al, 61h
		inc	edx
		cmp	al, 5
		ja	short loc_1001C8B1
		add	cl, 0D9h
		jmp	short loc_1001C8BC
; ---------------------------------------------------------------------------

loc_1001C8B1:				; CODE XREF: sub_1001C89C+Ej
		mov	al, cl
		sub	al, 41h
		cmp	al, 5
		ja	short loc_1001C8BC
		add	cl, 0F9h

loc_1001C8BC:				; CODE XREF: sub_1001C89C+13j
					; sub_1001C89C+1Bj
		movsx	eax, cl
		shl	esi, 4
		lea	esi, [esi+eax-30h]

loc_1001C8C6:				; CODE XREF: sub_1001C89C+5j
		mov	cl, [edx]
		test	cl, cl
		jnz	short loc_1001C8A3
		mov	eax, esi
		pop	esi
		retn
sub_1001C89C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001C8D0	proc near		; CODE XREF: sub_1001C983+5Ep
					; sub_1001CCF3:loc_1001CD39p ...
		xor	eax, eax

loc_1001C8D2:				; CODE XREF: sub_1001C8D0+18j
		mov	cl, [edx]
		inc	edx
		cmp	cl, 41h
		jl	short loc_1001C8DF
		cmp	cl, 5Ah
		jle	short loc_1001C8E7

loc_1001C8DF:				; CODE XREF: sub_1001C8D0+8j
		sub	cl, 61h
		cmp	cl, 19h
		ja	short locret_1001C8EA

loc_1001C8E7:				; CODE XREF: sub_1001C8D0+Dj
		inc	eax
		jmp	short loc_1001C8D2
; ---------------------------------------------------------------------------

locret_1001C8EA:			; CODE XREF: sub_1001C8D0+15j
		retn
sub_1001C8D0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall sub_1001C8EB(LPSTR)
sub_1001C8EB	proc near		; DATA XREF: .text:1001CCDAo
					; sub_1001CDB0+CBo

LCData		= byte ptr -7Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		call	sub_10013828
		mov	esi, eax
		mov	edx, edi
		add	esi, 9Ch
		call	sub_1001C89C
		mov	edi, eax
		push	78h		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		mov	eax, [esi+14h]
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFF005h
		add	eax, 1002h
		push	eax		; LCType
		push	edi		; Locale
		call	ds:GetLocaleInfoA
		test	eax, eax
		jnz	short loc_1001C941
		and	[esi+8], eax
		inc	eax
		jmp	short loc_1001C973
; ---------------------------------------------------------------------------

loc_1001C941:				; CODE XREF: sub_1001C8EB+4Ej
		lea	eax, [ebp+LCData]
		push	eax
		push	dword ptr [esi+4]
		call	sub_10023E83
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001C968
		push	edi
		call	sub_1001C878
		pop	ecx
		test	eax, eax
		jz	short loc_1001C968
		or	dword ptr [esi+8], 4
		mov	[esi+1Ch], edi
		mov	[esi+18h], edi

loc_1001C968:				; CODE XREF: sub_1001C8EB+66j
					; sub_1001C8EB+71j
		mov	eax, [esi+8]
		shr	eax, 2
		not	eax
		and	eax, 1

loc_1001C973:				; CODE XREF: sub_1001C8EB+54j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn	4
sub_1001C8EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001C983	proc near		; CODE XREF: LocaleEnumProc+18Cp
					; LocaleEnumProc+1D0p ...

LCData		= byte ptr -7Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		push	78h		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		mov	eax, [ebp+arg_0]
		and	eax, 3FFh
		push	1		; LCType
		or	eax, 400h
		push	eax		; Locale
		mov	esi, ecx
		call	ds:GetLocaleInfoA
		test	eax, eax
		jnz	short loc_1001C9BC

loc_1001C9B8:				; CODE XREF: sub_1001C983+65j
		xor	eax, eax
		jmp	short loc_1001C9ED
; ---------------------------------------------------------------------------

loc_1001C9BC:				; CODE XREF: sub_1001C983+33j
		lea	edx, [ebp+LCData]
		call	sub_1001C89C
		cmp	[ebp+arg_0], eax
		jz	short loc_1001C9EA
		cmp	[ebp+arg_4], 0
		jz	short loc_1001C9EA
		mov	edx, [esi]
		mov	eax, edx
		lea	esi, [eax+1]

loc_1001C9D6:				; CODE XREF: sub_1001C983+58j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001C9D6
		sub	eax, esi
		mov	esi, eax
		call	sub_1001C8D0
		cmp	eax, esi
		jz	short loc_1001C9B8

loc_1001C9EA:				; CODE XREF: sub_1001C983+44j
					; sub_1001C983+4Aj
		xor	eax, eax
		inc	eax

loc_1001C9ED:				; CODE XREF: sub_1001C983+37j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1001C983	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall LocaleEnumProc(LPSTR)
LocaleEnumProc	proc near		; DATA XREF: sub_1001CCF3+4Do

LCData		= byte ptr -7Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		call	sub_10013828
		mov	esi, eax
		mov	edx, edi
		add	esi, 9Ch
		call	sub_1001C89C
		mov	ebx, ds:GetLocaleInfoA
		mov	edi, eax
		push	78h		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		mov	eax, [esi+14h]
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFF005h
		add	eax, 1002h
		push	eax		; LCType
		push	edi		; Locale
		call	ebx ; GetLocaleInfoA
		test	eax, eax
		jnz	short loc_1001CA59

loc_1001CA4D:				; CODE XREF: LocaleEnumProc+92j
					; LocaleEnumProc+13Bj
		and	dword ptr [esi+8], 0
		xor	eax, eax
		inc	eax
		jmp	loc_1001CBEF
; ---------------------------------------------------------------------------

loc_1001CA59:				; CODE XREF: LocaleEnumProc+51j
		lea	eax, [ebp+LCData]
		push	eax
		push	dword ptr [esi+4]
		call	sub_10023E83
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	loc_1001CB06
		push	78h		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		mov	eax, [esi+10h]
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFF002h
		add	eax, 1001h
		push	eax		; LCType
		push	edi		; Locale
		call	ebx ; GetLocaleInfoA
		test	eax, eax
		jz	short loc_1001CA4D
		lea	eax, [ebp+LCData]
		push	eax
		push	dword ptr [esi]
		call	sub_10023E83
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001CAAB
		or	dword ptr [esi+8], 304h
		mov	[esi+18h], edi
		jmp	short loc_1001CB03
; ---------------------------------------------------------------------------

loc_1001CAAB:				; CODE XREF: LocaleEnumProc+A3j
		test	byte ptr [esi+8], 2
		jnz	short loc_1001CB06
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_1001CAEA
		push	eax
		lea	eax, [ebp+LCData]
		push	eax
		push	dword ptr [esi]
		call	sub_10023FC7
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001CAEA
		mov	eax, [esi]
		or	dword ptr [esi+8], 2
		mov	[esi+1Ch], edi
		lea	ecx, [eax+1]

loc_1001CAD7:				; CODE XREF: LocaleEnumProc+E2j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001CAD7
		sub	eax, ecx
		cmp	eax, [esi+0Ch]
		jnz	short loc_1001CB06
		mov	[esi+18h], edi
		jmp	short loc_1001CB06
; ---------------------------------------------------------------------------

loc_1001CAEA:				; CODE XREF: LocaleEnumProc+BCj
					; LocaleEnumProc+CFj
		mov	edx, [esi+8]
		test	dl, 1
		jnz	short loc_1001CB06
		push	edi
		call	sub_1001C878
		pop	ecx
		test	eax, eax
		jz	short loc_1001CB06
		or	edx, 1
		mov	[esi+8], edx

loc_1001CB03:				; CODE XREF: LocaleEnumProc+AFj
		mov	[esi+1Ch], edi

loc_1001CB06:				; CODE XREF: LocaleEnumProc+6Fj
					; LocaleEnumProc+B5j ...
		mov	ecx, [esi+8]
		mov	eax, 300h
		and	ecx, eax
		cmp	ecx, eax
		jz	loc_1001CBE4
		push	78h		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		mov	eax, [esi+10h]
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFF002h
		add	eax, 1001h
		push	eax		; LCType
		push	edi		; Locale
		call	ebx ; GetLocaleInfoA
		test	eax, eax
		jz	loc_1001CA4D
		lea	eax, [ebp+LCData]
		push	eax
		push	dword ptr [esi]
		call	sub_10023E83
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001CBA9
		or	dword ptr [esi+8], 200h
		mov	ecx, [esi+8]
		cmp	[esi+10h], eax
		jz	short loc_1001CB69
		or	ecx, 100h
		cmp	[esi+18h], eax
		mov	[esi+8], ecx
		jmp	short loc_1001CBDF
; ---------------------------------------------------------------------------

loc_1001CB69:				; CODE XREF: LocaleEnumProc+15Fj
		cmp	[esi+0Ch], eax
		jz	short loc_1001CB9E
		mov	eax, [esi]
		lea	ebx, [eax+1]

loc_1001CB73:				; CODE XREF: LocaleEnumProc+17Ej
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001CB73
		sub	eax, ebx
		cmp	eax, [esi+0Ch]
		jnz	short loc_1001CB9E
		push	1
		push	edi
		mov	ecx, esi
		call	sub_1001C983
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001CBE4
		or	dword ptr [esi+8], 100h

loc_1001CB98:				; CODE XREF: LocaleEnumProc+1ADj
		cmp	dword ptr [esi+18h], 0
		jmp	short loc_1001CBDF
; ---------------------------------------------------------------------------

loc_1001CB9E:				; CODE XREF: LocaleEnumProc+172j
					; LocaleEnumProc+185j
		or	ecx, 100h
		mov	[esi+8], ecx
		jmp	short loc_1001CB98
; ---------------------------------------------------------------------------

loc_1001CBA9:				; CODE XREF: LocaleEnumProc+150j
		xor	ebx, ebx
		cmp	[esi+10h], ebx
		jnz	short loc_1001CBE4
		cmp	[esi+0Ch], ebx
		jz	short loc_1001CBE4
		lea	eax, [ebp+LCData]
		push	eax
		push	dword ptr [esi]
		call	sub_10023E83
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001CBE4
		push	ebx
		push	edi
		mov	ecx, esi
		call	sub_1001C983
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001CBE4
		or	dword ptr [esi+8], 100h
		cmp	[esi+18h], ebx

loc_1001CBDF:				; CODE XREF: LocaleEnumProc+16Dj
					; LocaleEnumProc+1A2j
		jnz	short loc_1001CBE4
		mov	[esi+18h], edi

loc_1001CBE4:				; CODE XREF: LocaleEnumProc+118j
					; LocaleEnumProc+195j ...
		mov	eax, [esi+8]
		shr	eax, 2
		not	eax
		and	eax, 1

loc_1001CBEF:				; CODE XREF: LocaleEnumProc+5Aj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn	4
LocaleEnumProc	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall sub_1001CC00(LPSTR)
sub_1001CC00	proc near		; DATA XREF: sub_1001CD68+2Fo

LCData		= byte ptr -7Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		call	sub_10013828
		mov	esi, eax
		mov	edx, edi
		add	esi, 9Ch
		call	sub_1001C89C
		mov	edi, eax
		push	78h		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		mov	eax, [esi+10h]
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFF002h
		add	eax, 1001h
		push	eax		; LCType
		push	edi		; Locale
		call	ds:GetLocaleInfoA
		test	eax, eax
		jnz	short loc_1001CC56
		and	[esi+8], eax
		inc	eax
		jmp	short loc_1001CCB1
; ---------------------------------------------------------------------------

loc_1001CC56:				; CODE XREF: sub_1001CC00+4Ej
		lea	eax, [ebp+LCData]
		push	eax
		push	dword ptr [esi]
		call	sub_10023E83
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001CC70
		cmp	[esi+10h], eax
		jnz	short loc_1001CC9C
		push	1
		jmp	short loc_1001CC8E
; ---------------------------------------------------------------------------

loc_1001CC70:				; CODE XREF: sub_1001CC00+65j
		cmp	dword ptr [esi+10h], 0
		jnz	short loc_1001CCA6
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_1001CCA6
		lea	eax, [ebp+LCData]
		push	eax
		push	dword ptr [esi]
		call	sub_10023E83
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001CCA6
		push	eax

loc_1001CC8E:				; CODE XREF: sub_1001CC00+6Ej
		push	edi
		mov	ecx, esi
		call	sub_1001C983
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001CCA6

loc_1001CC9C:				; CODE XREF: sub_1001CC00+6Aj
		or	dword ptr [esi+8], 4
		mov	[esi+18h], edi
		mov	[esi+1Ch], edi

loc_1001CCA6:				; CODE XREF: sub_1001CC00+74j
					; sub_1001CC00+7Aj ...
		mov	eax, [esi+8]
		shr	eax, 2
		not	eax
		and	eax, 1

loc_1001CCB1:				; CODE XREF: sub_1001CC00+54j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn	4
sub_1001CC00	endp

; ---------------------------------------------------------------------------
		mov	eax, [esi+4]
		lea	edx, [eax+1]

loc_1001CCC7:				; CODE XREF: .text:1001CCCCj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001CCC7
		xor	ecx, ecx
		sub	eax, edx
		cmp	eax, 3
		setz	cl
		push	1
		push	offset sub_1001C8EB
		mov	[esi+14h], ecx
		call	ds:EnumSystemLocalesA
		test	byte ptr [esi+8], 4
		jnz	short locret_1001CCF2
		and	dword ptr [esi+8], 0

locret_1001CCF2:			; CODE XREF: .text:1001CCECj
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1001CCF3	proc near		; CODE XREF: sub_1001CDB0+65p
					; sub_1001CDB0+9Ap
		mov	edx, [esi]
		mov	eax, edx
		push	ebx
		lea	ecx, [eax+1]
		push	edi

loc_1001CCFC:				; CODE XREF: sub_1001CCF3+Ej
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_1001CCFC
		sub	eax, ecx
		xor	ecx, ecx
		cmp	eax, 3
		mov	eax, [esi+4]
		setz	cl
		lea	edi, [eax+1]
		mov	[esi+10h], ecx

loc_1001CD16:				; CODE XREF: sub_1001CCF3+28j
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_1001CD16
		xor	ebx, ebx
		sub	eax, edi
		cmp	eax, 3
		setz	bl
		and	dword ptr [esi+18h], 0
		pop	edi
		mov	[esi+14h], ebx
		pop	ebx
		test	ecx, ecx
		jz	short loc_1001CD39
		push	2
		pop	eax
		jmp	short loc_1001CD3E
; ---------------------------------------------------------------------------

loc_1001CD39:				; CODE XREF: sub_1001CCF3+3Fj
		call	sub_1001C8D0

loc_1001CD3E:				; CODE XREF: sub_1001CCF3+44j
		push	1		; dwFlags
		push	offset LocaleEnumProc ;	lpLocaleEnumProc
		mov	[esi+0Ch], eax
		call	ds:EnumSystemLocalesA
		mov	eax, [esi+8]
		test	eax, 100h
		jz	short loc_1001CD63
		test	eax, 200h
		jz	short loc_1001CD63
		test	al, 7
		jnz	short locret_1001CD67

loc_1001CD63:				; CODE XREF: sub_1001CCF3+63j
					; sub_1001CCF3+6Aj
		and	dword ptr [esi+8], 0

locret_1001CD67:			; CODE XREF: sub_1001CCF3+6Ej
		retn
sub_1001CCF3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001CD68	proc near		; CODE XREF: sub_1001CDB0:loc_1001CE1Cp
					; sub_1001CDB0:loc_1001CE51p
		mov	edx, [esi]
		mov	eax, edx
		lea	ecx, [eax+1]
		push	ebx

loc_1001CD70:				; CODE XREF: sub_1001CD68+Dj
		mov	bl, [eax]
		inc	eax
		test	bl, bl
		jnz	short loc_1001CD70
		sub	eax, ecx
		xor	ecx, ecx
		cmp	eax, 3
		setz	cl
		pop	ebx
		mov	eax, ecx
		mov	[esi+10h], eax
		test	eax, eax
		jz	short loc_1001CD90
		push	2
		pop	eax
		jmp	short loc_1001CD95
; ---------------------------------------------------------------------------

loc_1001CD90:				; CODE XREF: sub_1001CD68+21j
		call	sub_1001C8D0

loc_1001CD95:				; CODE XREF: sub_1001CD68+26j
		push	1		; dwFlags
		push	offset sub_1001CC00 ; lpLocaleEnumProc
		mov	[esi+0Ch], eax
		call	ds:EnumSystemLocalesA
		test	byte ptr [esi+8], 4
		jnz	short locret_1001CDAF
		and	dword ptr [esi+8], 0

locret_1001CDAF:			; CODE XREF: sub_1001CD68+41j
		retn
sub_1001CD68	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001CDB0(int,	int, LPSTR lpLCData)
sub_1001CDB0	proc near		; CODE XREF: sub_10012B19+175p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpLCData	= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		call	sub_10013828
		mov	ebx, [ebp+arg_0]
		mov	esi, eax
		add	esi, 9Ch
		test	ebx, ebx
		jnz	short loc_1001CDD8
		or	dword ptr [esi+8], 104h
		jmp	loc_1001CE9C
; ---------------------------------------------------------------------------

loc_1001CDD8:				; CODE XREF: sub_1001CDB0+1Aj
		lea	eax, [ebx+40h]
		lea	edi, [esi+4]
		mov	[esi], ebx
		mov	[edi], eax
		test	eax, eax
		jz	short loc_1001CDFB
		cmp	byte ptr [eax],	0
		jz	short loc_1001CDFB
		push	edi
		push	16h
		push	offset off_1002AE70
		call	sub_1001C786
		add	esp, 0Ch

loc_1001CDFB:				; CODE XREF: sub_1001CDB0+34j
					; sub_1001CDB0+39j
		mov	eax, [esi]
		and	dword ptr [esi+8], 0
		test	eax, eax
		jz	short loc_1001CE58
		cmp	byte ptr [eax],	0
		jz	short loc_1001CE58
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_1001CE1C
		cmp	byte ptr [eax],	0
		jz	short loc_1001CE1C
		call	sub_1001CCF3
		jmp	short loc_1001CE21
; ---------------------------------------------------------------------------

loc_1001CE1C:				; CODE XREF: sub_1001CDB0+5Ej
					; sub_1001CDB0+63j
		call	sub_1001CD68

loc_1001CE21:				; CODE XREF: sub_1001CDB0+6Aj
		cmp	dword ptr [esi+8], 0
		jnz	loc_1001CEB2
		push	esi
		push	41h
		push	offset off_1002AC60
		call	sub_1001C786
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001CEA8
		mov	edi, [edi]
		test	edi, edi
		jz	short loc_1001CE51
		cmp	byte ptr [edi],	0
		jz	short loc_1001CE51
		call	sub_1001CCF3
		jmp	short loc_1001CEA8
; ---------------------------------------------------------------------------

loc_1001CE51:				; CODE XREF: sub_1001CDB0+93j
					; sub_1001CDB0+98j
		call	sub_1001CD68
		jmp	short loc_1001CEA8
; ---------------------------------------------------------------------------

loc_1001CE58:				; CODE XREF: sub_1001CDB0+53j
					; sub_1001CDB0+58j
		mov	edi, [edi]
		test	edi, edi
		jz	short loc_1001CE95
		cmp	byte ptr [edi],	0
		jz	short loc_1001CE95
		mov	eax, edi
		lea	edx, [eax+1]

loc_1001CE68:				; CODE XREF: sub_1001CDB0+BDj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001CE68
		xor	ecx, ecx
		sub	eax, edx
		cmp	eax, 3
		setz	cl
		push	1		; dwFlags
		push	offset sub_1001C8EB ; lpLocaleEnumProc
		mov	[esi+14h], ecx
		call	ds:EnumSystemLocalesA
		test	byte ptr [esi+8], 4
		jnz	short loc_1001CEA8
		and	dword ptr [esi+8], 0
		jmp	short loc_1001CEA8
; ---------------------------------------------------------------------------

loc_1001CE95:				; CODE XREF: sub_1001CDB0+ACj
					; sub_1001CDB0+B1j
		mov	dword ptr [esi+8], 104h

loc_1001CE9C:				; CODE XREF: sub_1001CDB0+23j
		call	ds:GetUserDefaultLCID
		mov	[esi+18h], eax
		mov	[esi+1Ch], eax

loc_1001CEA8:				; CODE XREF: sub_1001CDB0+8Dj
					; sub_1001CDB0+9Fj ...
		cmp	dword ptr [esi+8], 0
		jz	loc_1001CFA3

loc_1001CEB2:				; CODE XREF: sub_1001CDB0+75j
		mov	eax, ebx
		sub	ebx, 0FFFFFF80h
		neg	eax
		sbb	eax, eax
		and	eax, ebx
		push	eax
		mov	edx, esi
		call	sub_1001C7FC
		mov	edi, eax
		pop	ecx
		mov	[ebp+arg_0], edi
		test	edi, edi
		jz	loc_1001CFA3
		cmp	edi, 0FDE8h
		jz	loc_1001CFA3
		cmp	edi, 0FDE9h
		jz	loc_1001CFA3
		movzx	eax, di
		push	eax		; CodePage
		call	ds:IsValidCodePage
		test	eax, eax
		jz	loc_1001CFA3
		push	1		; dwFlags
		push	dword ptr [esi+18h] ; Locale
		call	ds:IsValidLocale
		test	eax, eax
		jz	loc_1001CFA3
		mov	eax, [ebp+arg_4]
		test	eax, eax
		jz	short loc_1001CF2A
		mov	cx, [esi+18h]
		mov	[eax], cx
		mov	cx, [esi+1Ch]
		mov	[eax+2], cx
		mov	[eax+4], di

loc_1001CF2A:				; CODE XREF: sub_1001CDB0+165j
		mov	ebx, [ebp+lpLCData]
		test	ebx, ebx
		jz	short loc_1001CF9E
		mov	edi, ds:GetLocaleInfoA
		mov	ecx, 814h
		cmp	[eax], cx
		jnz	short loc_1001CF66
		push	offset aNorwegianNynor ; "Norwegian-Nynorsk"
		push	40h
		push	ebx
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1001CF77
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h
		jmp	short loc_1001CF77
; ---------------------------------------------------------------------------

loc_1001CF66:				; CODE XREF: sub_1001CDB0+18Fj
		push	40h		; cchData
		push	ebx		; lpLCData
		push	1001h		; LCType
		push	dword ptr [esi+18h] ; Locale
		call	edi ; GetLocaleInfoA
		test	eax, eax
		jz	short loc_1001CFA3

loc_1001CF77:				; CODE XREF: sub_1001CDB0+1A3j
					; sub_1001CDB0+1B4j
		push	40h		; cchData
		lea	eax, [ebx+40h]
		push	eax		; lpLCData
		push	1002h		; LCType
		push	dword ptr [esi+1Ch] ; Locale
		call	edi ; GetLocaleInfoA
		test	eax, eax
		jz	short loc_1001CFA3
		push	0Ah
		push	10h
		sub	ebx, 0FFFFFF80h
		push	ebx
		push	[ebp+arg_0]
		call	sub_100240FC
		add	esp, 10h

loc_1001CF9E:				; CODE XREF: sub_1001CDB0+17Fj
		xor	eax, eax
		inc	eax
		jmp	short loc_1001CFA5
; ---------------------------------------------------------------------------

loc_1001CFA3:				; CODE XREF: sub_1001CDB0+FCj
					; sub_1001CDB0+11Dj ...
		xor	eax, eax

loc_1001CFA5:				; CODE XREF: sub_1001CDB0+1F1j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1001CDB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001CFAA	proc near		; CODE XREF: sub_10013065+C7p
					; sub_100229AB+34p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		push	ebx
		mov	ebx, [ebp+arg_8]
		test	ebx, ebx
		jnz	short loc_1001CFC3
		xor	eax, eax
		jmp	loc_1001D05D
; ---------------------------------------------------------------------------

loc_1001CFC3:				; CODE XREF: sub_1001CFAA+10j
		push	edi
		cmp	ebx, 4
		jb	short loc_1001D03E
		lea	edi, [ebx-4]
		test	edi, edi
		jbe	short loc_1001D03E
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]

loc_1001CFD6:				; CODE XREF: sub_1001CFAA+68j
		mov	dl, [eax]
		add	eax, 4
		add	ecx, 4
		test	dl, dl
		jz	short loc_1001D034
		cmp	dl, [ecx-4]
		jnz	short loc_1001D034
		mov	dl, [eax-3]
		test	dl, dl
		jz	short loc_1001D02A
		cmp	dl, [ecx-3]
		jnz	short loc_1001D02A
		mov	dl, [eax-2]
		test	dl, dl
		jz	short loc_1001D020
		cmp	dl, [ecx-2]
		jnz	short loc_1001D020
		mov	dl, [eax-1]
		test	dl, dl
		jz	short loc_1001D016
		cmp	dl, [ecx-1]
		jnz	short loc_1001D016
		add	[ebp+var_4], 4
		cmp	[ebp+var_4], edi
		jb	short loc_1001CFD6
		jmp	short loc_1001D055
; ---------------------------------------------------------------------------

loc_1001D016:				; CODE XREF: sub_1001CFAA+5Aj
					; sub_1001CFAA+5Fj
		movzx	eax, byte ptr [eax-1]
		movzx	ecx, byte ptr [ecx-1]
		jmp	short loc_1001D066
; ---------------------------------------------------------------------------

loc_1001D020:				; CODE XREF: sub_1001CFAA+4Ej
					; sub_1001CFAA+53j
		movzx	eax, byte ptr [eax-2]
		movzx	ecx, byte ptr [ecx-2]
		jmp	short loc_1001D066
; ---------------------------------------------------------------------------

loc_1001D02A:				; CODE XREF: sub_1001CFAA+42j
					; sub_1001CFAA+47j
		movzx	eax, byte ptr [eax-3]
		movzx	ecx, byte ptr [ecx-3]
		jmp	short loc_1001D066
; ---------------------------------------------------------------------------

loc_1001D034:				; CODE XREF: sub_1001CFAA+36j
					; sub_1001CFAA+3Bj
		movzx	eax, byte ptr [eax-4]
		movzx	ecx, byte ptr [ecx-4]
		jmp	short loc_1001D066
; ---------------------------------------------------------------------------

loc_1001D03E:				; CODE XREF: sub_1001CFAA+1Dj
					; sub_1001CFAA+24j
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		jmp	short loc_1001D055
; ---------------------------------------------------------------------------

loc_1001D046:				; CODE XREF: sub_1001CFAA+AEj
		mov	dl, [eax]
		test	dl, dl
		jz	short loc_1001D060
		cmp	dl, [ecx]
		jnz	short loc_1001D060
		inc	eax
		inc	ecx
		inc	[ebp+var_4]

loc_1001D055:				; CODE XREF: sub_1001CFAA+6Aj
					; sub_1001CFAA+9Aj
		cmp	[ebp+var_4], ebx
		jb	short loc_1001D046
		xor	eax, eax

loc_1001D05C:				; CODE XREF: sub_1001CFAA+BEj
		pop	edi

loc_1001D05D:				; CODE XREF: sub_1001CFAA+14j
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_1001D060:				; CODE XREF: sub_1001CFAA+A0j
					; sub_1001CFAA+A4j
		movzx	eax, byte ptr [eax]
		movzx	ecx, byte ptr [ecx]

loc_1001D066:				; CODE XREF: sub_1001CFAA+74j
					; sub_1001CFAA+7Ej ...
		sub	eax, ecx
		jmp	short loc_1001D05C
sub_1001CFAA	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D070	proc near		; CODE XREF: sub_10013065+84p
					; sub_10025C13+25p

var_24		= dword	ptr -24h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		mov	edx, [ebp+arg_4]
		lea	ecx, [ecx+0]

loc_1001D084:				; CODE XREF: sub_1001D070+21j
		mov	al, [edx]
		or	al, al
		jz	short loc_1001D093
		add	edx, 1
		bts	[esp+24h+var_24], eax
		jmp	short loc_1001D084
; ---------------------------------------------------------------------------

loc_1001D093:				; CODE XREF: sub_1001D070+18j
		mov	esi, [ebp+arg_0]
		mov	edi, edi

loc_1001D098:				; CODE XREF: sub_1001D070+35j
		mov	al, [esi]
		or	al, al
		jz	short loc_1001D0AA
		add	esi, 1
		bt	[esp+24h+var_24], eax
		jnb	short loc_1001D098
		lea	eax, [esi-1]

loc_1001D0AA:				; CODE XREF: sub_1001D070+2Cj
		add	esp, 20h
		pop	esi
		leave
		retn
sub_1001D070	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+8]
		push	esi
		call	ds:Sleep
		add	esi, 3E8h
		cmp	esi, dword_1002EF58
		jbe	short loc_1001D0D1
		or	esi, 0FFFFFFFFh

loc_1001D0D1:				; CODE XREF: .text:1001D0CCj
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+8]
		mov	eax, dword_1002EF58
		mov	dword_1002EF58,	ecx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D0EB	proc near		; CODE XREF: .text:1001D21Fp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		xor	esi, esi

loc_1001D0F4:				; CODE XREF: sub_1001D0EB+3Dj
		push	[ebp+arg_0]
		call	sub_1000F5A0
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jnz	short loc_1001D12A
		cmp	dword_1002EF58,	eax
		jbe	short loc_1001D12A
		push	esi		; dwMilliseconds
		call	ds:Sleep
		lea	eax, [esi+3E8h]
		cmp	eax, dword_1002EF58
		jbe	short loc_1001D123
		or	eax, 0FFFFFFFFh

loc_1001D123:				; CODE XREF: sub_1001D0EB+33j
		mov	esi, eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001D0F4

loc_1001D12A:				; CODE XREF: sub_1001D0EB+16j
					; sub_1001D0EB+1Ej
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_1001D0EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D130	proc near		; CODE XREF: sub_100137AC+32p
					; sub_10013A07+139p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		xor	esi, esi

loc_1001D139:				; CODE XREF: sub_1001D130+44j
		push	0
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1000F378
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_1001D176
		cmp	dword_1002EF58,	eax
		jbe	short loc_1001D176
		push	esi		; dwMilliseconds
		call	ds:Sleep
		lea	eax, [esi+3E8h]
		cmp	eax, dword_1002EF58
		jbe	short loc_1001D16F
		or	eax, 0FFFFFFFFh

loc_1001D16F:				; CODE XREF: sub_1001D130+3Aj
		mov	esi, eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001D139

loc_1001D176:				; CODE XREF: sub_1001D130+1Dj
					; sub_1001D130+25j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_1001D130	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001D17C(LPVOID lpMem, SIZE_T	dwBytes)
sub_1001D17C	proc near		; CODE XREF: .text:1001D236p

lpMem		= dword	ptr  8
dwBytes		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		xor	esi, esi

loc_1001D185:				; CODE XREF: sub_1001D17C+46j
		push	[ebp+dwBytes]	; dwBytes
		push	[ebp+lpMem]	; lpMem
		call	sub_1000F114
		mov	edi, eax
		pop	ecx
		pop	ecx
		test	edi, edi
		jnz	short loc_1001D1C4
		cmp	[ebp+dwBytes], eax
		jz	short loc_1001D1C4
		cmp	dword_1002EF58,	eax
		jbe	short loc_1001D1C4
		push	esi		; dwMilliseconds
		call	ds:Sleep
		lea	eax, [esi+3E8h]
		cmp	eax, dword_1002EF58
		jbe	short loc_1001D1BD
		or	eax, 0FFFFFFFFh

loc_1001D1BD:				; CODE XREF: sub_1001D17C+3Cj
		mov	esi, eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001D185

loc_1001D1C4:				; CODE XREF: sub_1001D17C+1Aj
					; sub_1001D17C+1Fj ...
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_1001D17C	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		xor	esi, esi

loc_1001D1D3:				; CODE XREF: .text:1001D214j
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_1000F32F
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_1001D216
		cmp	[ebp+10h], eax
		jz	short loc_1001D216
		cmp	dword_1002EF58,	eax
		jbe	short loc_1001D216
		push	esi
		call	ds:Sleep
		lea	eax, [esi+3E8h]
		cmp	eax, dword_1002EF58
		jbe	short loc_1001D20F
		or	eax, 0FFFFFFFFh

loc_1001D20F:				; CODE XREF: .text:1001D20Aj
		mov	esi, eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001D1D3

loc_1001D216:				; CODE XREF: .text:1001D1E8j
					; .text:1001D1EDj ...
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		db 8Bh,	0FFh
; ---------------------------------------------------------------------------
		push	ecx
		call	sub_1001D0EB
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 4
		push	edx
		push	ecx
		call	sub_1001D130
		pop	ecx
		pop	ecx
		retn
; ---------------------------------------------------------------------------
		align 4
		push	edx
		push	ecx
		call	sub_1001D17C
		pop	ecx
		pop	ecx
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D23E	proc near		; CODE XREF: sub_10013CD1+10p
					; sub_10016BC8+84p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_1001D25A
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001D25A:				; CODE XREF: sub_1001D23E+Bj
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jl	short loc_1001D269
		cmp	eax, uNumber
		jb	short loc_1001D285

loc_1001D269:				; CODE XREF: sub_1001D23E+21j
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 9
		call	sub_10014B5B
		add	esp, 14h
		xor	eax, eax
		jmp	short loc_1001D29F
; ---------------------------------------------------------------------------

loc_1001D285:				; CODE XREF: sub_1001D23E+29j
		mov	ecx, eax
		and	eax, 1Fh
		imul	eax, 24h
		sar	ecx, 5
		mov	ecx, dword_1002F080[ecx*4]
		movsx	eax, byte ptr [ecx+eax+4]
		and	eax, 40h

loc_1001D29F:				; CODE XREF: sub_1001D23E+45j
		pop	esi
		pop	ebp
		retn
sub_1001D23E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001D2A2	proc near		; CODE XREF: sub_100165FB:loc_10016622p
		mov	edi, edi
		push	esi
		push	edi
		xor	edi, edi

loc_1001D2A8:				; CODE XREF: sub_1001D2A2+1Cj
		lea	esi, off_1002E180[edi]
		push	dword ptr [esi]
		call	sub_10013548
		add	edi, 4
		pop	ecx
		mov	[esi], eax
		cmp	edi, 28h
		jb	short loc_1001D2A8
		pop	edi
		pop	esi
		retn
sub_1001D2A2	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, ___security_cookie
		mov	edx, [ebp+8]
		or	ecx, 1
		xor	eax, eax
		cmp	dword_1002EF5C,	ecx
		setz	al
		neg	edx
		sbb	edx, edx
		and	edx, ecx
		mov	dword_1002EF5C,	edx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1001D2ED	proc near		; CODE XREF: sub_10013E79+6ACp
					; sub_1001D746+6C1p ...
		mov	eax, ___security_cookie
		or	eax, 1
		xor	ecx, ecx
		cmp	dword_1002EF5C,	eax
		setz	cl
		mov	eax, ecx
		retn
sub_1001D2ED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001D303(int,	LPSTR lpMultiByteStr, int cbMultiByte, WCHAR WideCharStr, int)
sub_1001D303	proc near		; CODE XREF: sub_1001D46F+13p
					; .text:1001D4BAp ...

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
lpMultiByteStr	= dword	ptr  0Ch
cbMultiByte	= dword	ptr  10h
WideCharStr	= word ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	esi
		mov	esi, [ebp+lpMultiByteStr]
		xor	ebx, ebx
		push	edi
		mov	edi, [ebp+cbMultiByte]
		cmp	esi, ebx
		jnz	short loc_1001D32E
		cmp	edi, ebx
		jbe	short loc_1001D32E
		mov	eax, [ebp+arg_0]
		cmp	eax, ebx
		jz	short loc_1001D327
		mov	[eax], ebx

loc_1001D327:				; CODE XREF: sub_1001D303+20j
					; sub_1001D303+F9j ...
		xor	eax, eax
		jmp	loc_1001D3B1
; ---------------------------------------------------------------------------

loc_1001D32E:				; CODE XREF: sub_1001D303+15j
					; sub_1001D303+19j
		mov	eax, [ebp+arg_0]
		cmp	eax, ebx
		jz	short loc_1001D338
		or	dword ptr [eax], 0FFFFFFFFh

loc_1001D338:				; CODE XREF: sub_1001D303+30j
		cmp	edi, 7FFFFFFFh
		jbe	short loc_1001D35B
		call	sub_10014BF2
		push	16h
		pop	esi
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	[eax], esi
		call	sub_10014B5B
		add	esp, 14h

loc_1001D357:				; CODE XREF: sub_1001D303+D5j
					; sub_1001D303+E2j
		mov	eax, esi
		jmp	short loc_1001D3B1
; ---------------------------------------------------------------------------

loc_1001D35B:				; CODE XREF: sub_1001D303+3Bj
		push	[ebp+arg_10]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	[eax+14h], ebx
		jnz	loc_1001D40E
		mov	ax, [ebp+WideCharStr]
		mov	ecx, 0FFh
		cmp	ax, cx
		jbe	short loc_1001D3B6
		cmp	esi, ebx
		jz	short loc_1001D393
		cmp	edi, ebx
		jbe	short loc_1001D393
		push	edi
		push	ebx
		push	esi
		call	sub_1000E0F0
		add	esp, 0Ch

loc_1001D393:				; CODE XREF: sub_1001D303+7Fj
					; sub_1001D303+83j ...
		call	sub_10014BF2
		mov	dword ptr [eax], 2Ah
		call	sub_10014BF2
		mov	eax, [eax]
		cmp	[ebp+var_4], bl
		jz	short loc_1001D3B1
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

loc_1001D3B1:				; CODE XREF: sub_1001D303+26j
					; sub_1001D303+56j ...
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_1001D3B6:				; CODE XREF: sub_1001D303+7Bj
		cmp	esi, ebx
		jz	short loc_1001D3EC
		cmp	edi, ebx
		ja	short loc_1001D3EA

loc_1001D3BE:				; CODE XREF: sub_1001D303+14Ej
					; sub_1001D303+156j ...
		call	sub_10014BF2
		push	22h
		pop	esi
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	[eax], esi
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	loc_1001D357
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh
		jmp	loc_1001D357
; ---------------------------------------------------------------------------

loc_1001D3EA:				; CODE XREF: sub_1001D303+B9j
		mov	[esi], al

loc_1001D3EC:				; CODE XREF: sub_1001D303+B5j
		mov	eax, [ebp+arg_0]
		cmp	eax, ebx
		jz	short loc_1001D3F9
		mov	dword ptr [eax], 1

loc_1001D3F9:				; CODE XREF: sub_1001D303+EEj
					; sub_1001D303+137j ...
		cmp	[ebp+var_4], bl
		jz	loc_1001D327
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh
		jmp	loc_1001D327
; ---------------------------------------------------------------------------

loc_1001D40E:				; CODE XREF: sub_1001D303+69j
		lea	ecx, [ebp+lpMultiByteStr]
		push	ecx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	edi		; cbMultiByte
		push	esi		; lpMultiByteStr
		push	1		; cchWideChar
		lea	ecx, [ebp+WideCharStr]
		push	ecx		; lpWideCharStr
		push	ebx		; dwFlags
		mov	[ebp+lpMultiByteStr], ebx
		push	dword ptr [eax+4] ; CodePage
		call	ds:WideCharToMultiByte
		cmp	eax, ebx
		jz	short loc_1001D440
		cmp	[ebp+lpMultiByteStr], ebx
		jnz	loc_1001D393
		mov	ecx, [ebp+arg_0]
		cmp	ecx, ebx
		jz	short loc_1001D3F9
		mov	[ecx], eax
		jmp	short loc_1001D3F9
; ---------------------------------------------------------------------------

loc_1001D440:				; CODE XREF: sub_1001D303+127j
		call	ds:GetLastError
		cmp	eax, 7Ah
		jnz	loc_1001D393
		cmp	esi, ebx
		jz	loc_1001D3BE
		cmp	edi, ebx
		jbe	loc_1001D3BE
		push	edi
		push	ebx
		push	esi
		call	sub_1000E0F0
		add	esp, 0Ch
		jmp	loc_1001D3BE
sub_1001D303	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001D46F(int,	LPSTR lpMultiByteStr, int cbMultiByte, WCHAR WideCharStr)
sub_1001D46F	proc near		; CODE XREF: sub_10013E79+583p
					; sub_10013E79+B23p ...

arg_0		= dword	ptr  8
lpMultiByteStr	= dword	ptr  0Ch
cbMultiByte	= dword	ptr  10h
WideCharStr	= word ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0		; int
		push	dword ptr [ebp+WideCharStr] ; WideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	[ebp+arg_0]	; int
		call	sub_1001D303
		add	esp, 14h
		pop	ebp
		retn
sub_1001D46F	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	dword ptr [ebp+10h]
		or	dword ptr [ebp-4], 0FFFFFFFFh
		lea	ecx, [ebp-14h]
		call	sub_1000E615
		lea	eax, [ebp-14h]
		push	eax
		push	dword ptr [ebp+0Ch]
		mov	eax, [ebp-14h]
		push	dword ptr [eax+0ACh]
		lea	eax, [ebp-4]
		push	dword ptr [ebp+8]
		push	eax
		call	sub_1001D303
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1001D4CB
		mov	eax, [ebp-4]
		jmp	short loc_1001D4CE
; ---------------------------------------------------------------------------

loc_1001D4CB:				; CODE XREF: .text:1001D4C4j
		or	eax, 0FFFFFFFFh

loc_1001D4CE:				; CODE XREF: .text:1001D4C9j
		cmp	byte ptr [ebp-8], 0
		jz	short locret_1001D4DB
		mov	ecx, [ebp-0Ch]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1001D4DB:			; CODE XREF: .text:1001D4D2j
		leave
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		or	dword ptr [ebp-4], 0FFFFFFFFh
		push	0
		push	dword ptr [ebp+0Ch]
		lea	eax, [ebp-4]
		push	dword_1002E174
		push	dword ptr [ebp+8]
		push	eax
		call	sub_1001D303
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1001D50A
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------

loc_1001D50A:				; CODE XREF: .text:1001D503j
		or	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D510	proc near		; CODE XREF: sub_10013E79+98Cp
					; sub_10018ECF+12Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	eax, [esp+4+arg_C]
		or	eax, eax
		jnz	short loc_1001D541
		mov	ecx, [esp+4+arg_8]
		mov	eax, [esp+4+arg_4]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+4+arg_0]
		div	ecx
		mov	esi, eax
		mov	eax, ebx
		mul	[esp+4+arg_8]
		mov	ecx, eax
		mov	eax, esi
		mul	[esp+4+arg_8]
		add	edx, ecx
		jmp	short loc_1001D588
; ---------------------------------------------------------------------------

loc_1001D541:				; CODE XREF: sub_1001D510+7j
		mov	ecx, eax
		mov	ebx, [esp+4+arg_8]
		mov	edx, [esp+4+arg_4]
		mov	eax, [esp+4+arg_0]

loc_1001D54F:				; CODE XREF: sub_1001D510+49j
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_1001D54F
		div	ebx
		mov	esi, eax
		mul	[esp+4+arg_C]
		mov	ecx, eax
		mov	eax, [esp+4+arg_8]
		mul	esi
		add	edx, ecx
		jb	short loc_1001D57D
		cmp	edx, [esp+4+arg_4]
		ja	short loc_1001D57D
		jb	short loc_1001D586
		cmp	eax, [esp+4+arg_0]
		jbe	short loc_1001D586

loc_1001D57D:				; CODE XREF: sub_1001D510+5Dj
					; sub_1001D510+63j
		dec	esi
		sub	eax, [esp+4+arg_8]
		sbb	edx, [esp+4+arg_C]

loc_1001D586:				; CODE XREF: sub_1001D510+65j
					; sub_1001D510+6Bj
		xor	ebx, ebx

loc_1001D588:				; CODE XREF: sub_1001D510+2Fj
		sub	eax, [esp+4+arg_0]
		sbb	edx, [esp+4+arg_4]
		neg	edx
		neg	eax
		sbb	edx, 0
		mov	ecx, edx
		mov	edx, ebx
		mov	ebx, ecx
		mov	ecx, eax
		mov	eax, esi
		pop	esi
		retn	10h
sub_1001D510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D5B0	proc near		; CODE XREF: sub_1001D634+16p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		mov	eax, 5A4Dh
		cmp	[ecx], ax
		jz	short loc_1001D5C6

loc_1001D5C2:				; CODE XREF: sub_1001D5B0+21j
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001D5C6:				; CODE XREF: sub_1001D5B0+10j
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		cmp	dword ptr [eax], 4550h
		jnz	short loc_1001D5C2
		xor	edx, edx
		mov	ecx, 10Bh
		cmp	[eax+18h], cx
		setz	dl
		mov	eax, edx
		pop	ebp
		retn
sub_1001D5B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D5F0	proc near		; CODE XREF: sub_1001D634+27p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		movzx	eax, word ptr [ecx+14h]
		push	ebx
		push	esi
		movzx	esi, word ptr [ecx+6]
		xor	edx, edx
		push	edi
		lea	eax, [eax+ecx+18h]
		test	esi, esi
		jbe	short loc_1001D62D
		mov	edi, [ebp+arg_4]

loc_1001D615:				; CODE XREF: sub_1001D5F0+3Bj
		mov	ecx, [eax+0Ch]
		cmp	edi, ecx
		jb	short loc_1001D625
		mov	ebx, [eax+8]
		add	ebx, ecx
		cmp	edi, ebx
		jb	short loc_1001D62F

loc_1001D625:				; CODE XREF: sub_1001D5F0+2Aj
		inc	edx
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_1001D615

loc_1001D62D:				; CODE XREF: sub_1001D5F0+20j
		xor	eax, eax

loc_1001D62F:				; CODE XREF: sub_1001D5F0+33j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1001D5F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D634	proc near		; CODE XREF: sub_10014D30+F8p
					; sub_100165FB+13p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	8
		push	offset stru_1002B750
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	esi, 10000000h
		push	esi
		call	sub_1001D5B0
		pop	ecx
		test	eax, eax
		jz	short loc_1001D691
		mov	eax, [ebp+arg_0]
		sub	eax, esi
		push	eax
		push	esi
		call	sub_1001D5F0
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1001D691
		mov	eax, [eax+24h]
		shr	eax, 1Fh
		not	eax
		and	eax, 1
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_1001D69A
; ---------------------------------------------------------------------------

loc_1001D67A:				; DATA XREF: .rdata:stru_1002B750o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 1001D634
		mov	eax, [eax]
		mov	eax, [eax]
		xor	ecx, ecx
		cmp	eax, 0C0000005h
		setz	cl
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_1001D68E:				; DATA XREF: .rdata:stru_1002B750o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1001D634

loc_1001D691:				; CODE XREF: sub_1001D634+1Ej
					; sub_1001D634+30j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	eax, eax

loc_1001D69A:				; CODE XREF: sub_1001D634+44j
		call	__SEH_epilog4
		retn
sub_1001D634	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001D6A0	proc near		; CODE XREF: sub_1001D6D3+13p
					; sub_1001D6F9+25p ...
		test	byte ptr [ecx+0Ch], 40h
		jz	short loc_1001D6AC
		cmp	dword ptr [ecx+8], 0
		jz	short loc_1001D6D0

loc_1001D6AC:				; CODE XREF: sub_1001D6A0+4j
		dec	dword ptr [ecx+4]
		js	short loc_1001D6BC
		mov	edx, [ecx]
		mov	[edx], al
		inc	dword ptr [ecx]
		movzx	eax, al
		jmp	short loc_1001D6C8
; ---------------------------------------------------------------------------

loc_1001D6BC:				; CODE XREF: sub_1001D6A0+Fj
		movsx	eax, al
		push	ecx
		push	eax
		call	sub_10016BC8
		pop	ecx
		pop	ecx

loc_1001D6C8:				; CODE XREF: sub_1001D6A0+1Aj
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001D6D0
		or	[esi], eax
		retn
; ---------------------------------------------------------------------------

loc_1001D6D0:				; CODE XREF: sub_1001D6A0+Aj
					; sub_1001D6A0+2Bj
		inc	dword ptr [esi]
		retn
sub_1001D6A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D6D3	proc near		; CODE XREF: sub_1001D746+AB6p
					; sub_1001D746+AF8p ...

arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, eax
		jmp	short loc_1001D6F0
; ---------------------------------------------------------------------------

loc_1001D6DD:				; CODE XREF: sub_1001D6D3+21j
		mov	ecx, [ebp+arg_8]
		mov	al, [ebp+arg_0]
		dec	[ebp+arg_4]
		call	sub_1001D6A0
		cmp	dword ptr [esi], 0FFFFFFFFh
		jz	short loc_1001D6F6

loc_1001D6F0:				; CODE XREF: sub_1001D6D3+8j
		cmp	[ebp+arg_4], 0
		jg	short loc_1001D6DD

loc_1001D6F6:				; CODE XREF: sub_1001D6D3+1Bj
		pop	esi
		pop	ebp
		retn
sub_1001D6D3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D6F9	proc near		; CODE XREF: sub_1001D746+AD6p
					; sub_1001D746+B5Bp ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		test	byte ptr [edi+0Ch], 40h
		push	ebx
		push	esi
		mov	esi, eax
		mov	ebx, ecx
		jz	short loc_1001D73C
		cmp	dword ptr [edi+8], 0
		jnz	short loc_1001D73C
		mov	eax, [ebp+arg_0]
		add	[esi], eax
		jmp	short loc_1001D742
; ---------------------------------------------------------------------------

loc_1001D717:				; CODE XREF: sub_1001D6F9+47j
		mov	al, [ebx]
		dec	[ebp+arg_0]
		mov	ecx, edi
		call	sub_1001D6A0
		inc	ebx
		cmp	dword ptr [esi], 0FFFFFFFFh
		jnz	short loc_1001D73C
		call	sub_10014BF2
		cmp	dword ptr [eax], 2Ah
		jnz	short loc_1001D742
		mov	ecx, edi
		mov	al, 3Fh
		call	sub_1001D6A0

loc_1001D73C:				; CODE XREF: sub_1001D6F9+Fj
					; sub_1001D6F9+15j ...
		cmp	[ebp+arg_0], 0
		jg	short loc_1001D717

loc_1001D742:				; CODE XREF: sub_1001D6F9+1Cj
					; sub_1001D6F9+38j
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1001D6F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D746	proc near		; DATA XREF: sub_10014F63+Eo
					; .text:10014FC6o ...

var_278		= dword	ptr -278h
var_274		= dword	ptr -274h
var_270		= dword	ptr -270h
var_26C		= dword	ptr -26Ch
var_264		= dword	ptr -264h
var_260		= dword	ptr -260h
var_25C		= dword	ptr -25Ch
lpMem		= dword	ptr -258h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= byte ptr -24Ch
var_244		= dword	ptr -244h
var_240		= byte ptr -240h
var_23C		= dword	ptr -23Ch
var_238		= dword	ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= byte ptr -22Ch
var_22B		= byte ptr -22Bh
var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_211		= byte ptr -211h
var_210		= dword	ptr -210h
MultiByteStr	= byte ptr -20Ch
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 278h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_0]
		xor	eax, eax
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+arg_C]
		push	[ebp+arg_8]
		lea	ecx, [ebp+var_24C]
		mov	[ebp+var_260], ebx
		mov	[ebp+var_230], esi
		mov	[ebp+var_224], edi
		mov	[ebp+var_25C], eax
		mov	[ebp+var_210], eax
		mov	[ebp+var_238], eax
		mov	[ebp+var_218], eax
		mov	[ebp+var_234], eax
		mov	[ebp+var_26C], eax
		mov	[ebp+var_254], eax
		mov	[ebp+var_23C], eax
		call	sub_1000E615
		test	ebx, ebx
		jnz	short loc_1001D7F2

loc_1001D7BD:				; CODE XREF: sub_1001D746+FFj
					; sub_1001D746+14Ej ...
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax

loc_1001D7CF:				; CODE XREF: sub_1001D746+BFFj
					; sub_1001D746+C27j
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_240], 0
		jz	short loc_1001D7EA
		mov	eax, [ebp+var_244]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001D7EA:				; CODE XREF: sub_1001D746+98j
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E38B
; ---------------------------------------------------------------------------

loc_1001D7F2:				; CODE XREF: sub_1001D746+75j
		test	byte ptr [ebx+0Ch], 40h
		jnz	loc_1001D89A
		push	ebx
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001D83C
		push	ebx
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1001D83C
		push	ebx
		call	sub_1001704B
		sar	eax, 5
		push	ebx
		lea	esi, dword_1002F080[eax*4]
		call	sub_1001704B
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [esi]
		mov	esi, [ebp+var_230]
		pop	ecx
		pop	ecx
		jmp	short loc_1001D841
; ---------------------------------------------------------------------------

loc_1001D83C:				; CODE XREF: sub_1001D746+C0j
					; sub_1001D746+CCj
		mov	eax, offset dword_1002DEE0

loc_1001D841:				; CODE XREF: sub_1001D746+F4j
		test	byte ptr [eax+8], 3
		jnz	loc_1001D7BD
		push	ebx
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001D88B
		push	ebx
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1001D88B
		push	ebx
		call	sub_1001704B
		sar	eax, 5
		push	ebx
		lea	esi, dword_1002F080[eax*4]
		call	sub_1001704B
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [esi]
		mov	esi, [ebp+var_230]
		pop	ecx
		pop	ecx
		jmp	short loc_1001D890
; ---------------------------------------------------------------------------

loc_1001D88B:				; CODE XREF: sub_1001D746+10Fj
					; sub_1001D746+11Bj
		mov	eax, offset dword_1002DEE0

loc_1001D890:				; CODE XREF: sub_1001D746+143j
		test	byte ptr [eax+8], 8
		jnz	loc_1001D7BD

loc_1001D89A:				; CODE XREF: sub_1001D746+B0j
		xor	eax, eax
		cmp	esi, eax
		jz	loc_1001D7BD
		mov	cl, [esi]
		mov	[ebp+var_228], eax
		mov	[ebp+var_220], eax
		mov	[ebp+var_250], eax
		mov	[ebp+lpMem], eax
		mov	[ebp+var_211], cl
		test	cl, cl
		jz	loc_1001E372

loc_1001D8CC:				; CODE XREF: sub_1001D746+BEAj
		inc	esi
		cmp	[ebp+var_228], eax
		mov	[ebp+var_230], esi
		jl	loc_1001E34A
		mov	dl, cl
		sub	dl, 20h
		cmp	dl, 58h
		ja	short loc_1001D8F6
		movsx	eax, cl
		movzx	eax, ds:byte_1002AF38[eax]
		and	eax, 0Fh

loc_1001D8F6:				; CODE XREF: sub_1001D746+1A1j
		mov	edx, [ebp+var_250]
		imul	eax, 9
		movzx	eax, ds:byte_1002AF58[eax+edx]
		shr	eax, 4
		mov	[ebp+var_250], eax
		cmp	eax, 8
		jz	loc_1001D7BD
		push	7
		pop	edx
		cmp	eax, edx	; switch 8 cases
		ja	loc_1001E30E	; jumptable 1001D924 default case
		jmp	ds:off_1001E39A[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001D92B:				; CODE XREF: sub_1001D746+1DEj
					; DATA XREF: .text:off_1001E39Ao
		xor	eax, eax	; jumptable 1001D924 case 1
		or	[ebp+var_218], 0FFFFFFFFh
		mov	[ebp+var_26C], eax
		mov	[ebp+var_254], eax
		mov	[ebp+var_238], eax
		mov	[ebp+var_234], eax
		mov	[ebp+var_210], eax
		mov	[ebp+var_23C], eax
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001D95D:				; CODE XREF: sub_1001D746+1DEj
					; DATA XREF: .text:off_1001E39Ao
		movsx	eax, cl		; jumptable 1001D924 case 2
		sub	eax, 20h
		jz	short loc_1001D9AF
		sub	eax, 3
		jz	short loc_1001D9A0
		sub	eax, 8
		jz	short loc_1001D994
		dec	eax
		dec	eax
		jz	short loc_1001D988
		sub	eax, 3
		jnz	loc_1001E30E	; jumptable 1001D924 default case
		or	[ebp+var_210], 8
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001D988:				; CODE XREF: sub_1001D746+22Bj
		or	[ebp+var_210], 4
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001D994:				; CODE XREF: sub_1001D746+227j
		or	[ebp+var_210], 1
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001D9A0:				; CODE XREF: sub_1001D746+222j
		or	[ebp+var_210], 80h
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001D9AF:				; CODE XREF: sub_1001D746+21Dj
		or	[ebp+var_210], 2
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001D9BB:				; CODE XREF: sub_1001D746+1DEj
					; DATA XREF: .text:off_1001E39Ao
		cmp	cl, 2Ah		; jumptable 1001D924 case 3
		jnz	short loc_1001D9EC
		add	edi, 4
		mov	[ebp+var_224], edi
		mov	edi, [edi-4]
		mov	[ebp+var_238], edi
		test	edi, edi
		jge	loc_1001E30E	; jumptable 1001D924 default case
		or	[ebp+var_210], 4
		neg	[ebp+var_238]
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001D9EC:				; CODE XREF: sub_1001D746+278j
		mov	eax, [ebp+var_238]
		imul	eax, 0Ah
		movsx	ecx, cl
		lea	eax, [eax+ecx-30h]
		mov	[ebp+var_238], eax
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DA07:				; CODE XREF: sub_1001D746+1DEj
					; DATA XREF: .text:off_1001E39Ao
		and	[ebp+var_218], 0 ; jumptable 1001D924 case 4
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DA13:				; CODE XREF: sub_1001D746+1DEj
					; DATA XREF: .text:off_1001E39Ao
		cmp	cl, 2Ah		; jumptable 1001D924 case 5
		jnz	short loc_1001DA3E
		add	edi, 4
		mov	[ebp+var_224], edi
		mov	edi, [edi-4]
		mov	[ebp+var_218], edi
		test	edi, edi
		jge	loc_1001E30E	; jumptable 1001D924 default case
		or	[ebp+var_218], 0FFFFFFFFh
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DA3E:				; CODE XREF: sub_1001D746+2D0j
		mov	eax, [ebp+var_218]
		imul	eax, 0Ah
		movsx	ecx, cl
		lea	eax, [eax+ecx-30h]
		mov	[ebp+var_218], eax
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DA59:				; CODE XREF: sub_1001D746+1DEj
					; DATA XREF: .text:off_1001E39Ao
		cmp	cl, 49h		; jumptable 1001D924 case 6
		jz	short loc_1001DAB3
		cmp	cl, 68h
		jz	short loc_1001DAA7
		cmp	cl, 6Ch
		jz	short loc_1001DA80
		cmp	cl, 77h
		jnz	loc_1001E30E	; jumptable 1001D924 default case
		or	[ebp+var_210], 800h
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DA80:				; CODE XREF: sub_1001D746+320j
		cmp	byte ptr [esi],	6Ch
		jnz	short loc_1001DA9B
		inc	esi
		or	[ebp+var_210], 1000h
		mov	[ebp+var_230], esi
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DA9B:				; CODE XREF: sub_1001D746+33Dj
		or	[ebp+var_210], 10h
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DAA7:				; CODE XREF: sub_1001D746+31Bj
		or	[ebp+var_210], 20h
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DAB3:				; CODE XREF: sub_1001D746+316j
		mov	al, [esi]
		cmp	al, 36h
		jnz	short loc_1001DAD6
		cmp	byte ptr [esi+1], 34h
		jnz	short loc_1001DAD6
		inc	esi
		inc	esi
		or	[ebp+var_210], 8000h
		mov	[ebp+var_230], esi
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DAD6:				; CODE XREF: sub_1001D746+371j
					; sub_1001D746+377j
		cmp	al, 33h
		jnz	short loc_1001DAF7
		cmp	byte ptr [esi+1], 32h
		jnz	short loc_1001DAF7
		inc	esi
		inc	esi
		and	[ebp+var_210], 0FFFF7FFFh
		mov	[ebp+var_230], esi
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DAF7:				; CODE XREF: sub_1001D746+392j
					; sub_1001D746+398j
		cmp	al, 64h
		jz	loc_1001E30E	; jumptable 1001D924 default case
		cmp	al, 69h
		jz	loc_1001E30E	; jumptable 1001D924 default case
		cmp	al, 6Fh
		jz	loc_1001E30E	; jumptable 1001D924 default case
		cmp	al, 75h
		jz	loc_1001E30E	; jumptable 1001D924 default case
		cmp	al, 78h
		jz	loc_1001E30E	; jumptable 1001D924 default case
		cmp	al, 58h
		jz	loc_1001E30E	; jumptable 1001D924 default case
		and	[ebp+var_250], 0

loc_1001DB2E:				; CODE XREF: sub_1001D746+1DEj
					; DATA XREF: .text:off_1001E39Ao
		and	[ebp+var_23C], 0 ; jumptable 1001D924 case 0
		lea	eax, [ebp+var_24C]
		push	eax
		movzx	eax, cl
		push	eax
		call	sub_100175C6
		pop	ecx
		test	eax, eax
		mov	al, [ebp+var_211]
		pop	ecx
		jz	short loc_1001DB74
		lea	esi, [ebp+var_228]
		mov	ecx, ebx
		call	sub_1001D6A0
		mov	eax, [ebp+var_230]
		mov	al, [eax]
		inc	[ebp+var_230]
		test	al, al
		jz	loc_1001D7BD

loc_1001DB74:				; CODE XREF: sub_1001D746+409j
		lea	esi, [ebp+var_228]
		mov	ecx, ebx
		call	sub_1001D6A0
		jmp	loc_1001E30E	; jumptable 1001D924 default case
; ---------------------------------------------------------------------------

loc_1001DB86:				; CODE XREF: sub_1001D746+1DEj
					; DATA XREF: .text:off_1001E39Ao
		movsx	eax, cl		; jumptable 1001D924 case 7
		cmp	eax, 64h
		jg	loc_1001DDA9
		jz	loc_1001DE40
		cmp	eax, 53h
		jg	loc_1001DC94
		jz	loc_1001DC28
		sub	eax, 41h
		jz	short loc_1001DBBC
		dec	eax
		dec	eax
		jz	short loc_1001DC09
		dec	eax
		dec	eax
		jz	short loc_1001DBBC
		dec	eax
		dec	eax
		jnz	loc_1001E189

loc_1001DBBC:				; CODE XREF: sub_1001D746+464j
					; sub_1001D746+46Cj
		add	cl, 20h
		mov	[ebp+var_26C], 1
		mov	[ebp+var_211], cl

loc_1001DBCF:				; CODE XREF: sub_1001D746+55Dj
					; sub_1001D746+67Ej
		or	[ebp+var_210], 40h
		cmp	[ebp+var_218], 0
		lea	eax, [ebp+MultiByteStr]
		mov	[ebp+var_21C], eax
		mov	eax, 200h
		mov	[ebp+var_264], eax
		jge	loc_1001DE70
		mov	[ebp+var_218], 6
		jmp	loc_1001DED5
; ---------------------------------------------------------------------------

loc_1001DC09:				; CODE XREF: sub_1001D746+468j
		test	[ebp+var_210], 830h
		jnz	loc_1001DCB1
		or	[ebp+var_210], 800h
		jmp	loc_1001DCB1
; ---------------------------------------------------------------------------

loc_1001DC28:				; CODE XREF: sub_1001D746+45Bj
		test	[ebp+var_210], 830h
		jnz	short loc_1001DC3E
		or	[ebp+var_210], 800h

loc_1001DC3E:				; CODE XREF: sub_1001D746+4ECj
					; sub_1001D746+875j
		mov	edx, [ebp+var_218]
		cmp	edx, 0FFFFFFFFh
		jnz	short loc_1001DC4E
		mov	edx, 7FFFFFFFh

loc_1001DC4E:				; CODE XREF: sub_1001D746+501j
		add	edi, 4
		test	[ebp+var_210], 810h
		mov	[ebp+var_224], edi
		mov	edi, [edi-4]
		mov	[ebp+var_21C], edi
		jz	loc_1001E15B
		test	edi, edi
		jnz	short loc_1001DC7F
		mov	eax, off_1002DB84
		mov	[ebp+var_21C], eax

loc_1001DC7F:				; CODE XREF: sub_1001D746+52Cj
		mov	eax, [ebp+var_21C]
		mov	[ebp+var_23C], 1
		jmp	loc_1001E14D
; ---------------------------------------------------------------------------

loc_1001DC94:				; CODE XREF: sub_1001D746+455j
		sub	eax, 58h
		jz	loc_1001DFB0
		dec	eax
		dec	eax
		jz	short loc_1001DD1A
		sub	eax, edx
		jz	loc_1001DBCF
		dec	eax
		dec	eax
		jnz	loc_1001E189

loc_1001DCB1:				; CODE XREF: sub_1001D746+4CDj
					; sub_1001D746+4DDj
		add	edi, 4
		test	[ebp+var_210], 810h
		mov	[ebp+var_224], edi
		jz	short loc_1001DCF6
		movzx	eax, word ptr [edi-4]
		push	eax		; WideCharStr
		push	200h		; cbMultiByte
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		lea	eax, [ebp+var_220]
		push	eax		; int
		call	sub_1001D46F
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001DD09
		mov	[ebp+var_254], 1
		jmp	short loc_1001DD09
; ---------------------------------------------------------------------------

loc_1001DCF6:				; CODE XREF: sub_1001D746+57Ej
		mov	al, [edi-4]
		mov	[ebp+MultiByteStr], al
		mov	[ebp+var_220], 1

loc_1001DD09:				; CODE XREF: sub_1001D746+5A2j
					; sub_1001D746+5AEj
		lea	eax, [ebp+MultiByteStr]
		mov	[ebp+var_21C], eax
		jmp	loc_1001E189
; ---------------------------------------------------------------------------

loc_1001DD1A:				; CODE XREF: sub_1001D746+559j
		mov	eax, [edi]
		add	edi, 4
		mov	[ebp+var_224], edi
		test	eax, eax
		jz	short loc_1001DD8D
		mov	esi, [eax+4]
		xor	edi, edi
		cmp	esi, edi
		jz	short loc_1001DD8D
		movzx	ecx, word ptr [eax]
		cmp	[eax+2], cx
		jb	loc_1001E335
		test	[ebp+var_210], 800h
		movzx	eax, cx
		jz	short loc_1001DD7C
		xor	ecx, ecx
		mov	edx, eax
		not	edx
		inc	ecx
		test	cl, dl
		jz	loc_1001E335
		mov	edx, esi
		not	edx
		test	cl, dl
		jz	loc_1001E335
		mov	[ebp+var_21C], esi
		shr	eax, 1
		mov	[ebp+var_23C], ecx
		jmp	loc_1001E183
; ---------------------------------------------------------------------------

loc_1001DD7C:				; CODE XREF: sub_1001D746+606j
		mov	[ebp+var_23C], edi
		mov	[ebp+var_21C], esi
		jmp	loc_1001E183
; ---------------------------------------------------------------------------

loc_1001DD8D:				; CODE XREF: sub_1001D746+5E1j
					; sub_1001D746+5EAj
		mov	eax, off_1002DB80
		mov	[ebp+var_21C], eax
		lea	edx, [eax+1]

loc_1001DD9B:				; CODE XREF: sub_1001D746+65Aj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001DD9B

loc_1001DDA2:				; CODE XREF: sub_1001D746+85Bj
		sub	eax, edx
		jmp	loc_1001E183
; ---------------------------------------------------------------------------

loc_1001DDA9:				; CODE XREF: sub_1001D746+446j
		cmp	eax, 70h
		jg	loc_1001DFB8
		jz	loc_1001DFA6
		cmp	eax, 65h
		jl	loc_1001E189
		cmp	eax, 67h
		jle	loc_1001DBCF
		cmp	eax, 69h
		jz	short loc_1001DE40
		cmp	eax, 6Eh
		jz	short loc_1001DDFC
		cmp	eax, 6Fh
		jnz	loc_1001E189
		test	byte ptr [ebp+var_210],	80h
		mov	[ebp+var_220], 8
		jz	short loc_1001DE51
		or	[ebp+var_210], 200h
		jmp	short loc_1001DE51
; ---------------------------------------------------------------------------

loc_1001DDFC:				; CODE XREF: sub_1001D746+68Cj
		mov	esi, [edi]
		add	edi, 4
		mov	[ebp+var_224], edi
		call	sub_1001D2ED
		test	eax, eax
		jz	loc_1001D7BD
		test	byte ptr [ebp+var_210],	20h
		jz	short loc_1001DE29
		mov	ax, word ptr [ebp+var_228]
		mov	[esi], ax
		jmp	short loc_1001DE31
; ---------------------------------------------------------------------------

loc_1001DE29:				; CODE XREF: sub_1001D746+6D5j
		mov	eax, [ebp+var_228]
		mov	[esi], eax

loc_1001DE31:				; CODE XREF: sub_1001D746+6E1j
		mov	[ebp+var_254], 1
		jmp	loc_1001E2F2
; ---------------------------------------------------------------------------

loc_1001DE40:				; CODE XREF: sub_1001D746+44Cj
					; sub_1001D746+687j
		or	[ebp+var_210], 40h

loc_1001DE47:				; CODE XREF: sub_1001D746+87Dj
		mov	[ebp+var_220], 0Ah

loc_1001DE51:				; CODE XREF: sub_1001D746+6A8j
					; sub_1001D746+6B4j ...
		mov	ecx, [ebp+var_210]
		test	ecx, 8000h
		jz	loc_1001E017

loc_1001DE63:				; CODE XREF: sub_1001D746+8D7j
		mov	eax, [edi]
		mov	edx, [edi+4]
		add	edi, 8
		jmp	loc_1001E050
; ---------------------------------------------------------------------------

loc_1001DE70:				; CODE XREF: sub_1001D746+4AEj
		jnz	short loc_1001DE83
		cmp	cl, 67h
		jnz	short loc_1001DED5
		mov	[ebp+var_218], 1
		jmp	short loc_1001DED5
; ---------------------------------------------------------------------------

loc_1001DE83:				; CODE XREF: sub_1001D746:loc_1001DE70j
		cmp	[ebp+var_218], eax
		jle	short loc_1001DE91
		mov	[ebp+var_218], eax

loc_1001DE91:				; CODE XREF: sub_1001D746+743j
		mov	ebx, 0A3h
		cmp	[ebp+var_218], ebx
		jle	short loc_1001DED5
		mov	esi, [ebp+var_218]
		add	esi, 15Dh
		push	esi
		call	sub_1000F5A0
		pop	ecx
		mov	cl, [ebp+var_211]
		mov	[ebp+lpMem], eax
		test	eax, eax
		jz	short loc_1001DECF
		mov	[ebp+var_21C], eax
		mov	[ebp+var_264], esi
		jmp	short loc_1001DED5
; ---------------------------------------------------------------------------

loc_1001DECF:				; CODE XREF: sub_1001D746+779j
		mov	[ebp+var_218], ebx

loc_1001DED5:				; CODE XREF: sub_1001D746+4BEj
					; sub_1001D746+72Fj ...
		mov	eax, [edi]
		add	edi, 8
		mov	[ebp+var_278], eax
		mov	eax, [edi-4]
		mov	[ebp+var_274], eax
		lea	eax, [ebp+var_24C]
		push	eax
		push	[ebp+var_26C]
		movsx	eax, cl
		push	[ebp+var_218]
		mov	[ebp+var_224], edi
		mov	edi, [ebp+var_21C]
		push	eax
		push	[ebp+var_264]
		lea	eax, [ebp+var_278]
		push	edi
		push	eax
		push	off_1002E198
		call	sub_100135C4
		pop	ecx
		call	eax
		mov	esi, [ebp+var_210]
		add	esp, 1Ch
		and	esi, 80h
		jz	short loc_1001DF5A
		cmp	[ebp+var_218], 0
		jnz	short loc_1001DF5A
		lea	eax, [ebp+var_24C]
		push	eax
		push	edi
		push	off_1002E1A4
		call	sub_100135C4
		pop	ecx
		call	eax
		pop	ecx
		pop	ecx

loc_1001DF5A:				; CODE XREF: sub_1001D746+7F1j
					; sub_1001D746+7FAj
		cmp	[ebp+var_211], 67h
		jnz	short loc_1001DF7F
		test	esi, esi
		jnz	short loc_1001DF7F
		lea	eax, [ebp+var_24C]
		push	eax
		push	edi
		push	off_1002E1A0
		call	sub_100135C4
		pop	ecx
		call	eax
		pop	ecx
		pop	ecx

loc_1001DF7F:				; CODE XREF: sub_1001D746+81Bj
					; sub_1001D746+81Fj
		cmp	byte ptr [edi],	2Dh
		jnz	short loc_1001DF95
		or	[ebp+var_210], 100h
		inc	edi
		mov	[ebp+var_21C], edi

loc_1001DF95:				; CODE XREF: sub_1001D746+83Cj
		mov	eax, edi
		lea	edx, [eax+1]

loc_1001DF9A:				; CODE XREF: sub_1001D746+859j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001DF9A
		jmp	loc_1001DDA2
; ---------------------------------------------------------------------------

loc_1001DFA6:				; CODE XREF: sub_1001D746+66Cj
		mov	[ebp+var_218], 8

loc_1001DFB0:				; CODE XREF: sub_1001D746+551j
		mov	[ebp+var_25C], edx
		jmp	short loc_1001DFDC
; ---------------------------------------------------------------------------

loc_1001DFB8:				; CODE XREF: sub_1001D746+666j
		sub	eax, 73h
		jz	loc_1001DC3E
		dec	eax
		dec	eax
		jz	loc_1001DE47
		sub	eax, 3
		jnz	loc_1001E189
		mov	[ebp+var_25C], 27h

loc_1001DFDC:				; CODE XREF: sub_1001D746+870j
		test	byte ptr [ebp+var_210],	80h
		mov	[ebp+var_220], 10h
		jz	loc_1001DE51
		mov	al, byte ptr [ebp+var_25C]
		add	al, 51h
		mov	[ebp+var_22C], 30h
		mov	[ebp+var_22B], al
		mov	[ebp+var_234], 2
		jmp	loc_1001DE51
; ---------------------------------------------------------------------------

loc_1001E017:				; CODE XREF: sub_1001D746+717j
		test	ecx, 1000h
		jnz	loc_1001DE63
		add	edi, 4
		test	cl, 20h
		jz	short loc_1001E043
		mov	[ebp+var_224], edi
		test	cl, 40h
		jz	short loc_1001E03C
		movsx	eax, word ptr [edi-4]
		jmp	short loc_1001E040
; ---------------------------------------------------------------------------

loc_1001E03C:				; CODE XREF: sub_1001D746+8EEj
		movzx	eax, word ptr [edi-4]

loc_1001E040:				; CODE XREF: sub_1001D746+8F4j
		cdq
		jmp	short loc_1001E056
; ---------------------------------------------------------------------------

loc_1001E043:				; CODE XREF: sub_1001D746+8E3j
		mov	eax, [edi-4]
		test	cl, 40h
		jz	short loc_1001E04E
		cdq
		jmp	short loc_1001E050
; ---------------------------------------------------------------------------

loc_1001E04E:				; CODE XREF: sub_1001D746+903j
		xor	edx, edx

loc_1001E050:				; CODE XREF: sub_1001D746+725j
					; sub_1001D746+906j
		mov	[ebp+var_224], edi

loc_1001E056:				; CODE XREF: sub_1001D746+8FBj
		test	cl, 40h
		jz	short loc_1001E076
		test	edx, edx
		jg	short loc_1001E076
		jl	short loc_1001E065
		test	eax, eax
		jnb	short loc_1001E076

loc_1001E065:				; CODE XREF: sub_1001D746+919j
		neg	eax
		adc	edx, 0
		neg	edx
		or	[ebp+var_210], 100h

loc_1001E076:				; CODE XREF: sub_1001D746+913j
					; sub_1001D746+917j ...
		test	[ebp+var_210], 9000h
		mov	ebx, edx
		mov	edi, eax
		jnz	short loc_1001E088
		xor	ebx, ebx

loc_1001E088:				; CODE XREF: sub_1001D746+93Ej
		cmp	[ebp+var_218], 0
		jge	short loc_1001E09D
		mov	[ebp+var_218], 1
		jmp	short loc_1001E0B7
; ---------------------------------------------------------------------------

loc_1001E09D:				; CODE XREF: sub_1001D746+949j
		and	[ebp+var_210], 0FFFFFFF7h
		mov	eax, 200h
		cmp	[ebp+var_218], eax
		jle	short loc_1001E0B7
		mov	[ebp+var_218], eax

loc_1001E0B7:				; CODE XREF: sub_1001D746+955j
					; sub_1001D746+969j
		mov	eax, edi
		or	eax, ebx
		jnz	short loc_1001E0C3
		and	[ebp+var_234], eax

loc_1001E0C3:				; CODE XREF: sub_1001D746+975j
		lea	esi, [ebp+var_D]

loc_1001E0C6:				; CODE XREF: sub_1001D746+9C1j
		mov	eax, [ebp+var_218]
		dec	[ebp+var_218]
		test	eax, eax
		jg	short loc_1001E0DC
		mov	eax, edi
		or	eax, ebx
		jz	short loc_1001E109

loc_1001E0DC:				; CODE XREF: sub_1001D746+98Ej
		mov	eax, [ebp+var_220]
		cdq
		push	edx
		push	eax
		push	ebx
		push	edi
		call	sub_1001D510
		add	ecx, 30h
		cmp	ecx, 39h
		mov	[ebp+var_264], ebx
		mov	edi, eax
		mov	ebx, edx
		jle	short loc_1001E104
		add	ecx, [ebp+var_25C]

loc_1001E104:				; CODE XREF: sub_1001D746+9B6j
		mov	[esi], cl
		dec	esi
		jmp	short loc_1001E0C6
; ---------------------------------------------------------------------------

loc_1001E109:				; CODE XREF: sub_1001D746+994j
		lea	eax, [ebp+var_D]
		sub	eax, esi
		inc	esi
		test	[ebp+var_210], 200h
		mov	[ebp+var_220], eax
		mov	[ebp+var_21C], esi
		jz	short loc_1001E189
		test	eax, eax
		jz	short loc_1001E132
		mov	ecx, esi
		cmp	byte ptr [ecx],	30h
		jz	short loc_1001E189

loc_1001E132:				; CODE XREF: sub_1001D746+9E3j
		dec	[ebp+var_21C]
		mov	ecx, [ebp+var_21C]
		mov	byte ptr [ecx],	30h
		inc	eax
		jmp	short loc_1001E183
; ---------------------------------------------------------------------------

loc_1001E144:				; CODE XREF: sub_1001D746+A09j
		dec	edx
		cmp	word ptr [eax],	0
		jz	short loc_1001E151
		inc	eax
		inc	eax

loc_1001E14D:				; CODE XREF: sub_1001D746+549j
		test	edx, edx
		jnz	short loc_1001E144

loc_1001E151:				; CODE XREF: sub_1001D746+A03j
		sub	eax, [ebp+var_21C]
		sar	eax, 1
		jmp	short loc_1001E183
; ---------------------------------------------------------------------------

loc_1001E15B:				; CODE XREF: sub_1001D746+524j
		test	edi, edi
		jnz	short loc_1001E16A
		mov	eax, off_1002DB80
		mov	[ebp+var_21C], eax

loc_1001E16A:				; CODE XREF: sub_1001D746+A17j
		mov	eax, [ebp+var_21C]
		jmp	short loc_1001E179
; ---------------------------------------------------------------------------

loc_1001E172:				; CODE XREF: sub_1001D746+A35j
		dec	edx
		cmp	byte ptr [eax],	0
		jz	short loc_1001E17D
		inc	eax

loc_1001E179:				; CODE XREF: sub_1001D746+A2Aj
		test	edx, edx
		jnz	short loc_1001E172

loc_1001E17D:				; CODE XREF: sub_1001D746+A30j
		sub	eax, [ebp+var_21C]

loc_1001E183:				; CODE XREF: sub_1001D746+631j
					; sub_1001D746+642j ...
		mov	[ebp+var_220], eax

loc_1001E189:				; CODE XREF: sub_1001D746+470j
					; sub_1001D746+565j ...
		cmp	[ebp+var_254], 0
		jnz	loc_1001E2F2
		mov	eax, [ebp+var_210]
		test	al, 40h
		jz	short loc_1001E1D2
		test	eax, 100h
		jz	short loc_1001E1B0
		mov	[ebp+var_22C], 2Dh
		jmp	short loc_1001E1C8
; ---------------------------------------------------------------------------

loc_1001E1B0:				; CODE XREF: sub_1001D746+A5Fj
		test	al, 1
		jz	short loc_1001E1BD
		mov	[ebp+var_22C], 2Bh
		jmp	short loc_1001E1C8
; ---------------------------------------------------------------------------

loc_1001E1BD:				; CODE XREF: sub_1001D746+A6Cj
		test	al, 2
		jz	short loc_1001E1D2
		mov	[ebp+var_22C], 20h

loc_1001E1C8:				; CODE XREF: sub_1001D746+A68j
					; sub_1001D746+A75j
		mov	[ebp+var_234], 1

loc_1001E1D2:				; CODE XREF: sub_1001D746+A58j
					; sub_1001D746+A79j
		mov	ebx, [ebp+var_238]
		sub	ebx, [ebp+var_220]
		sub	ebx, [ebp+var_234]
		test	byte ptr [ebp+var_210],	0Ch
		jnz	short loc_1001E204
		push	[ebp+var_260]
		lea	eax, [ebp+var_228]
		push	ebx
		push	20h
		call	sub_1001D6D3
		add	esp, 0Ch

loc_1001E204:				; CODE XREF: sub_1001D746+AA5j
		push	[ebp+var_234]
		mov	edi, [ebp+var_260]
		lea	eax, [ebp+var_228]
		lea	ecx, [ebp+var_22C]
		call	sub_1001D6F9
		test	byte ptr [ebp+var_210],	8
		pop	ecx
		jz	short loc_1001E246
		test	byte ptr [ebp+var_210],	4
		jnz	short loc_1001E246
		push	edi
		push	ebx
		push	30h
		lea	eax, [ebp+var_228]
		call	sub_1001D6D3
		add	esp, 0Ch

loc_1001E246:				; CODE XREF: sub_1001D746+AE3j
					; sub_1001D746+AECj
		cmp	[ebp+var_23C], 0
		mov	eax, [ebp+var_220]
		jz	short loc_1001E2BB
		test	eax, eax
		jle	short loc_1001E2BB
		mov	esi, [ebp+var_21C]
		mov	[ebp+var_264], eax

loc_1001E265:				; CODE XREF: sub_1001D746+B68j
		movzx	eax, word ptr [esi]
		dec	[ebp+var_264]
		push	eax		; WideCharStr
		push	6		; cbMultiByte
		lea	eax, [ebp+var_C]
		push	eax		; lpMultiByteStr
		lea	eax, [ebp+var_270]
		inc	esi
		push	eax		; int
		inc	esi
		call	sub_1001D46F
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001E2B2
		cmp	[ebp+var_270], eax
		jz	short loc_1001E2B2
		push	[ebp+var_270]
		lea	eax, [ebp+var_228]
		lea	ecx, [ebp+var_C]
		call	sub_1001D6F9
		cmp	[ebp+var_264], 0
		pop	ecx
		jnz	short loc_1001E265
		jmp	short loc_1001E2CE
; ---------------------------------------------------------------------------

loc_1001E2B2:				; CODE XREF: sub_1001D746+B42j
					; sub_1001D746+B4Aj
		or	[ebp+var_228], 0FFFFFFFFh
		jmp	short loc_1001E2CE
; ---------------------------------------------------------------------------

loc_1001E2BB:				; CODE XREF: sub_1001D746+B0Dj
					; sub_1001D746+B11j
		mov	ecx, [ebp+var_21C]
		push	eax
		lea	eax, [ebp+var_228]
		call	sub_1001D6F9
		pop	ecx

loc_1001E2CE:				; CODE XREF: sub_1001D746+B6Aj
					; sub_1001D746+B73j
		cmp	[ebp+var_228], 0
		jl	short loc_1001E2F2
		test	byte ptr [ebp+var_210],	4
		jz	short loc_1001E2F2
		push	edi
		push	ebx
		push	20h
		lea	eax, [ebp+var_228]
		call	sub_1001D6D3
		add	esp, 0Ch

loc_1001E2F2:				; CODE XREF: sub_1001D746+6F5j
					; sub_1001D746+A4Aj ...
		cmp	[ebp+lpMem], 0
		jz	short loc_1001E30E ; jumptable 1001D924	default	case
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		and	[ebp+lpMem], 0
		pop	ecx

loc_1001E30E:				; CODE XREF: sub_1001D746+1D8j
					; sub_1001D746+212j ...
		mov	esi, [ebp+var_230] ; jumptable 1001D924	default	case
		mov	al, [esi]
		mov	[ebp+var_211], al
		test	al, al
		jz	short loc_1001E34A
		mov	ebx, [ebp+var_260]
		mov	edi, [ebp+var_224]
		mov	cl, al
		xor	eax, eax
		jmp	loc_1001D8CC
; ---------------------------------------------------------------------------

loc_1001E335:				; CODE XREF: sub_1001D746+5F3j
					; sub_1001D746+611j ...
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		push	edi
		jmp	loc_1001D7CF
; ---------------------------------------------------------------------------

loc_1001E34A:				; CODE XREF: sub_1001D746+193j
					; sub_1001D746+BD8j
		xor	esi, esi
		cmp	[ebp+var_250], esi
		jz	short loc_1001E372
		cmp	[ebp+var_250], 7
		jz	short loc_1001E372
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		push	esi
		jmp	loc_1001D7CF
; ---------------------------------------------------------------------------

loc_1001E372:				; CODE XREF: sub_1001D746+180j
					; sub_1001D746+C0Cj ...
		cmp	[ebp+var_240], 0
		jz	short loc_1001E385
		mov	eax, [ebp+var_244]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001E385:				; CODE XREF: sub_1001D746+C33j
		mov	eax, [ebp+var_228]

loc_1001E38B:				; CODE XREF: sub_1001D746+A7j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1001D746	endp

; ---------------------------------------------------------------------------
off_1001E39A	dd offset loc_1001DB2E	; DATA XREF: sub_1001D746+1DEr
		dd offset loc_1001D92B	; jump table for switch	statement
		dd offset loc_1001D95D
		dd offset loc_1001D9BB
		dd offset loc_1001DA07
		dd offset loc_1001DA13
		dd offset loc_1001DA59
		dd offset loc_1001DB86

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001E3BA	proc near		; CODE XREF: sub_1001E5A0+AD2p
					; sub_1001E5A0+F07p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		mov	bl, [ebp+arg_8]
		push	esi
		mov	esi, [ebp+arg_0]
		mov	al, [esi+8]
		cmp	al, 70h
		jz	loc_1001E4D8
		cmp	bl, 70h
		jz	loc_1001E4D8
		cmp	al, 73h
		jz	short loc_1001E3E7
		cmp	al, 53h
		jz	short loc_1001E3E7
		xor	edx, edx
		jmp	short loc_1001E3EA
; ---------------------------------------------------------------------------

loc_1001E3E7:				; CODE XREF: sub_1001E3BA+23j
					; sub_1001E3BA+27j
		xor	edx, edx
		inc	edx

loc_1001E3EA:				; CODE XREF: sub_1001E3BA+2Bj
		cmp	bl, 73h
		jz	short loc_1001E3F8
		cmp	bl, 53h
		jz	short loc_1001E3F8
		xor	ecx, ecx
		jmp	short loc_1001E3FB
; ---------------------------------------------------------------------------

loc_1001E3F8:				; CODE XREF: sub_1001E3BA+33j
					; sub_1001E3BA+38j
		xor	ecx, ecx
		inc	ecx

loc_1001E3FB:				; CODE XREF: sub_1001E3BA+3Cj
		test	edx, edx
		jnz	loc_1001E4AC
		test	ecx, ecx
		jnz	loc_1001E4D4
		mov	dl, 64h
		cmp	al, dl
		jz	short loc_1001E45E
		cmp	al, 69h
		jz	short loc_1001E442
		cmp	al, 6Fh
		jz	short loc_1001E442
		cmp	al, 75h
		jz	short loc_1001E442
		cmp	al, 78h
		jz	short loc_1001E442
		cmp	al, 58h
		jz	short loc_1001E442
		cmp	bl, dl
		jz	short loc_1001E442
		cmp	bl, 69h
		jz	short loc_1001E442
		cmp	bl, 6Fh
		jz	short loc_1001E442
		cmp	bl, 75h
		jz	short loc_1001E442
		cmp	bl, 78h
		jz	short loc_1001E442
		cmp	bl, 58h
		jnz	short loc_1001E4A0

loc_1001E442:				; CODE XREF: sub_1001E3BA+59j
					; sub_1001E3BA+5Dj ...
		cmp	al, dl
		jz	short loc_1001E45E
		cmp	al, 69h
		jz	short loc_1001E45E
		cmp	al, 6Fh
		jz	short loc_1001E45E
		cmp	al, 75h
		jz	short loc_1001E45E
		cmp	al, 78h
		jz	short loc_1001E45E
		cmp	al, 58h
		jz	short loc_1001E45E
		xor	ecx, ecx
		jmp	short loc_1001E461
; ---------------------------------------------------------------------------

loc_1001E45E:				; CODE XREF: sub_1001E3BA+55j
					; sub_1001E3BA+8Aj ...
		xor	ecx, ecx
		inc	ecx

loc_1001E461:				; CODE XREF: sub_1001E3BA+A2j
		cmp	bl, dl
		jz	short loc_1001E482
		cmp	bl, 69h
		jz	short loc_1001E482
		cmp	bl, 6Fh
		jz	short loc_1001E482
		cmp	bl, 75h
		jz	short loc_1001E482
		cmp	bl, 78h
		jz	short loc_1001E482
		cmp	bl, 58h
		jz	short loc_1001E482
		xor	eax, eax
		jmp	short loc_1001E485
; ---------------------------------------------------------------------------

loc_1001E482:				; CODE XREF: sub_1001E3BA+A9j
					; sub_1001E3BA+AEj ...
		xor	eax, eax
		inc	eax

loc_1001E485:				; CODE XREF: sub_1001E3BA+C6j
		cmp	ecx, eax
		jnz	short loc_1001E4D4
		mov	eax, [esi+0Ch]
		mov	ecx, eax
		xor	ecx, [ebp+arg_C]
		test	ecx, 10000h
		jnz	short loc_1001E4D4
		xor	eax, [ebp+arg_C]
		test	al, 20h
		jnz	short loc_1001E4D4

loc_1001E4A0:				; CODE XREF: sub_1001E3BA+86j
		mov	ecx, [esi]
		xor	eax, eax
		cmp	ecx, [ebp+arg_4]
		setz	al
		jmp	short loc_1001E4E1
; ---------------------------------------------------------------------------

loc_1001E4AC:				; CODE XREF: sub_1001E3BA+43j
		cmp	edx, ecx
		jnz	short loc_1001E4D4
		mov	ecx, [esi+0Ch]
		mov	edx, [ebp+arg_C]
		mov	eax, 810h
		and	ecx, eax
		neg	ecx
		sbb	ecx, ecx
		and	edx, eax
		neg	ecx
		neg	edx
		sbb	edx, edx
		neg	edx
		cmp	ecx, edx
		jnz	short loc_1001E4D4
		xor	eax, eax
		inc	eax
		jmp	short loc_1001E4E1
; ---------------------------------------------------------------------------

loc_1001E4D4:				; CODE XREF: sub_1001E3BA+4Bj
					; sub_1001E3BA+CDj ...
		xor	eax, eax
		jmp	short loc_1001E4E1
; ---------------------------------------------------------------------------

loc_1001E4D8:				; CODE XREF: sub_1001E3BA+12j
					; sub_1001E3BA+1Bj
		xor	ecx, ecx
		cmp	al, bl
		setz	cl
		mov	eax, ecx

loc_1001E4E1:				; CODE XREF: sub_1001E3BA+F0j
					; sub_1001E3BA+118j ...
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1001E3BA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001E4E5	proc near		; CODE XREF: sub_1001E518+13p
					; sub_1001E53E+25p ...
		test	byte ptr [ecx+0Ch], 40h
		jz	short loc_1001E4F1
		cmp	dword ptr [ecx+8], 0
		jz	short loc_1001E515

loc_1001E4F1:				; CODE XREF: sub_1001E4E5+4j
		dec	dword ptr [ecx+4]
		js	short loc_1001E501
		mov	edx, [ecx]
		mov	[edx], al
		inc	dword ptr [ecx]
		movzx	eax, al
		jmp	short loc_1001E50D
; ---------------------------------------------------------------------------

loc_1001E501:				; CODE XREF: sub_1001E4E5+Fj
		movsx	eax, al
		push	ecx
		push	eax
		call	sub_10016BC8
		pop	ecx
		pop	ecx

loc_1001E50D:				; CODE XREF: sub_1001E4E5+1Aj
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001E515
		or	[esi], eax
		retn
; ---------------------------------------------------------------------------

loc_1001E515:				; CODE XREF: sub_1001E4E5+Aj
					; sub_1001E4E5+2Bj
		inc	dword ptr [esi]
		retn
sub_1001E4E5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001E518	proc near		; CODE XREF: sub_1001E5A0+1162p
					; sub_1001E5A0+11A4p ...

arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, eax
		jmp	short loc_1001E535
; ---------------------------------------------------------------------------

loc_1001E522:				; CODE XREF: sub_1001E518+21j
		mov	ecx, [ebp+arg_8]
		mov	al, [ebp+arg_0]
		dec	[ebp+arg_4]
		call	sub_1001E4E5
		cmp	dword ptr [esi], 0FFFFFFFFh
		jz	short loc_1001E53B

loc_1001E535:				; CODE XREF: sub_1001E518+8j
		cmp	[ebp+arg_4], 0
		jg	short loc_1001E522

loc_1001E53B:				; CODE XREF: sub_1001E518+1Bj
		pop	esi
		pop	ebp
		retn
sub_1001E518	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001E53E	proc near		; CODE XREF: sub_1001E5A0+1182p
					; sub_1001E5A0+1207p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		test	byte ptr [edi+0Ch], 40h
		push	ebx
		push	esi
		mov	esi, eax
		mov	ebx, ecx
		jz	short loc_1001E581
		cmp	dword ptr [edi+8], 0
		jnz	short loc_1001E581
		mov	eax, [ebp+arg_0]
		add	[esi], eax
		jmp	short loc_1001E587
; ---------------------------------------------------------------------------

loc_1001E55C:				; CODE XREF: sub_1001E53E+47j
		mov	al, [ebx]
		dec	[ebp+arg_0]
		mov	ecx, edi
		call	sub_1001E4E5
		inc	ebx
		cmp	dword ptr [esi], 0FFFFFFFFh
		jnz	short loc_1001E581
		call	sub_10014BF2
		cmp	dword ptr [eax], 2Ah
		jnz	short loc_1001E587
		mov	ecx, edi
		mov	al, 3Fh
		call	sub_1001E4E5

loc_1001E581:				; CODE XREF: sub_1001E53E+Fj
					; sub_1001E53E+15j ...
		cmp	[ebp+arg_0], 0
		jg	short loc_1001E55C

loc_1001E587:				; CODE XREF: sub_1001E53E+1Cj
					; sub_1001E53E+38j
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_1001E53E	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		add	dword ptr [eax], 8
		mov	ecx, [eax]
		mov	eax, [ecx-8]
		mov	edx, [ecx-4]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001E5A0	proc near		; DATA XREF: sub_10014F80+Eo
					; .text:10014FE2o ...

var_8D0		= byte ptr -8D0h
var_8CC		= dword	ptr -8CCh
var_8C8		= byte ptr -8C8h
var_8C4		= dword	ptr -8C4h
var_290		= dword	ptr -290h
var_28C		= dword	ptr -28Ch
var_288		= dword	ptr -288h
var_284		= dword	ptr -284h
var_280		= dword	ptr -280h
lpMem		= dword	ptr -27Ch
var_278		= dword	ptr -278h
var_274		= dword	ptr -274h
var_270		= dword	ptr -270h
var_268		= dword	ptr -268h
var_264		= dword	ptr -264h
var_260		= dword	ptr -260h
var_25C		= dword	ptr -25Ch
var_258		= dword	ptr -258h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_248		= byte ptr -248h
var_247		= byte ptr -247h
var_244		= dword	ptr -244h
var_240		= dword	ptr -240h
var_23C		= byte ptr -23Ch
var_234		= dword	ptr -234h
var_230		= byte ptr -230h
var_22C		= dword	ptr -22Ch
var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_214		= dword	ptr -214h
var_210		= dword	ptr -210h
MultiByteStr	= byte ptr -20Ch
var_D		= byte ptr -0Dh
var_C		= byte ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 8D0h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_C]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		xor	ebx, ebx
		push	edi
		mov	edi, [ebp+arg_0]
		push	[ebp+arg_8]
		lea	ecx, [ebp+var_23C]
		mov	[ebp+var_270], edi
		mov	[ebp+var_240], esi
		mov	[ebp+var_214], eax
		mov	[ebp+var_274], ebx
		mov	[ebp+var_210], ebx
		mov	[ebp+var_258], ebx
		mov	[ebp+var_280], ebx
		mov	[ebp+var_278], ebx
		mov	[ebp+var_260], ebx
		call	sub_1000E615
		or	[ebp+var_224], 0FFFFFFFFh
		mov	[ebp+var_25C], ebx
		cmp	edi, ebx
		jnz	short loc_1001E64A

loc_1001E618:				; CODE XREF: sub_1001E5A0+F7j
					; sub_1001E5A0+140j ...
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_230], bl

loc_1001E636:				; CODE XREF: sub_1001E5A0+B01j
		jz	short loc_1001E642
		mov	eax, [ebp+var_234]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001E642:				; CODE XREF: sub_1001E5A0:loc_1001E636j
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F8D2
; ---------------------------------------------------------------------------

loc_1001E64A:				; CODE XREF: sub_1001E5A0+76j
		test	byte ptr [edi+0Ch], 40h
		jnz	loc_1001E6EC
		push	edi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001E68E
		push	edi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1001E68E
		push	edi
		call	sub_1001704B
		sar	eax, 5
		push	edi
		lea	esi, dword_1002F080[eax*4]
		call	sub_1001704B
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [esi]
		pop	ecx
		pop	ecx
		jmp	short loc_1001E693
; ---------------------------------------------------------------------------

loc_1001E68E:				; CODE XREF: sub_1001E5A0+BEj
					; sub_1001E5A0+CAj
		mov	eax, offset dword_1002DEE0

loc_1001E693:				; CODE XREF: sub_1001E5A0+ECj
		test	byte ptr [eax+8], 3
		jnz	loc_1001E618
		push	edi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001E6D7
		push	edi
		call	sub_1001704B
		pop	ecx
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1001E6D7
		push	edi
		call	sub_1001704B
		sar	eax, 5
		push	edi
		lea	esi, dword_1002F080[eax*4]
		call	sub_1001704B
		and	eax, 1Fh
		imul	eax, 24h
		add	eax, [esi]
		pop	ecx
		pop	ecx
		jmp	short loc_1001E6DC
; ---------------------------------------------------------------------------

loc_1001E6D7:				; CODE XREF: sub_1001E5A0+107j
					; sub_1001E5A0+113j
		mov	eax, offset dword_1002DEE0

loc_1001E6DC:				; CODE XREF: sub_1001E5A0+135j
		test	byte ptr [eax+8], 8
		jnz	loc_1001E618
		mov	esi, [ebp+var_240]

loc_1001E6EC:				; CODE XREF: sub_1001E5A0+AEj
		cmp	esi, ebx
		jz	loc_1001E618
		mov	[ebp+var_244], ebx
		mov	[ebp+var_290], esi
		mov	[ebp+var_228], ebx

loc_1001E706:				; CODE XREF: sub_1001E5A0+1314j
		cmp	[ebp+var_228], 1
		jnz	short loc_1001E71D
		cmp	[ebp+var_224], ebx
		jz	loc_1001F8B9
		xor	ebx, ebx

loc_1001E71D:				; CODE XREF: sub_1001E5A0+16Dj
		mov	eax, [ebp+var_290]
		or	[ebp+var_254], 0FFFFFFFFh
		or	[ebp+var_218], 0FFFFFFFFh
		or	[ebp+var_224], 0FFFFFFFFh
		mov	[ebp+var_268], ebx
		mov	dl, [eax]
		mov	[ebp+var_264], ebx
		mov	[ebp+lpMem], ebx
		mov	[ebp+var_250], ebx
		mov	[ebp+var_21C], ebx
		mov	[ebp+var_240], eax
		mov	byte ptr [ebp+var_22C],	dl
		test	dl, dl
		jz	loc_1001F8A3
		mov	esi, eax
		jmp	short loc_1001E776
; ---------------------------------------------------------------------------

loc_1001E770:				; CODE XREF: sub_1001E5A0+1284j
		mov	dl, byte ptr [ebp+var_22C]

loc_1001E776:				; CODE XREF: sub_1001E5A0+1CEj
		inc	esi
		xor	edi, edi
		cmp	[ebp+var_244], edi
		mov	[ebp+var_240], esi
		jl	loc_1001F82C
		mov	al, dl
		sub	al, 20h
		cmp	al, 58h
		ja	short loc_1001E7A2
		movsx	eax, dl
		movzx	eax, ds:byte_1002AF38[eax]
		and	eax, 0Fh
		jmp	short loc_1001E7A4
; ---------------------------------------------------------------------------

loc_1001E7A2:				; CODE XREF: sub_1001E5A0+1F1j
		xor	eax, eax

loc_1001E7A4:				; CODE XREF: sub_1001E5A0+200j
		mov	ecx, [ebp+var_264]
		imul	eax, 9
		movzx	eax, ds:byte_1002AF58[eax+ecx]
		xor	ebx, ebx
		shr	eax, 4
		inc	ebx
		mov	[ebp+var_264], eax
		cmp	eax, ebx
		jnz	loc_1001E8A2
		cmp	byte ptr [esi],	25h
		jz	loc_1001E895
		cmp	[ebp+var_224], 0FFFFFFFFh
		jnz	short loc_1001E82D
		push	0Ah
		lea	eax, [ebp+var_25C]
		push	eax
		push	esi
		call	sub_10010F93
		add	esp, 0Ch
		test	eax, eax
		jle	short loc_1001E821
		mov	eax, [ebp+var_25C]
		cmp	byte ptr [eax],	24h
		jnz	short loc_1001E821
		cmp	[ebp+var_228], edi
		jnz	short loc_1001E819
		push	640h
		lea	eax, [ebp+var_8D0]
		push	edi
		push	eax
		call	sub_1000E0F0
		add	esp, 0Ch

loc_1001E819:				; CODE XREF: sub_1001E5A0+262j
		mov	[ebp+var_224], ebx
		jmp	short loc_1001E835
; ---------------------------------------------------------------------------

loc_1001E821:				; CODE XREF: sub_1001E5A0+24Fj
					; sub_1001E5A0+25Aj
		mov	dl, byte ptr [ebp+var_22C]
		mov	[ebp+var_224], edi

loc_1001E82D:				; CODE XREF: sub_1001E5A0+239j
		cmp	[ebp+var_224], ebx
		jnz	short loc_1001E895

loc_1001E835:				; CODE XREF: sub_1001E5A0+27Fj
		push	0Ah
		lea	eax, [ebp+var_25C]
		push	eax
		push	esi
		call	sub_10010F93
		mov	ecx, [ebp+var_25C]
		add	esp, 0Ch
		dec	eax
		lea	edx, [ecx+1]
		mov	[ebp+var_218], eax
		mov	[ebp+var_240], edx
		cmp	[ebp+var_228], edi
		jnz	short loc_1001E88D
		cmp	eax, edi
		jl	loc_1001F082
		cmp	byte ptr [ecx],	24h
		jnz	loc_1001F082
		cmp	eax, 64h
		jge	loc_1001F082
		cmp	eax, [ebp+var_254]
		jle	short loc_1001E88D
		mov	[ebp+var_254], eax

loc_1001E88D:				; CODE XREF: sub_1001E5A0+2C3j
					; sub_1001E5A0+2E5j
		mov	esi, edx
		mov	dl, byte ptr [ebp+var_22C]

loc_1001E895:				; CODE XREF: sub_1001E5A0+22Cj
					; sub_1001E5A0+293j ...
		mov	eax, [ebp+var_264]
		jmp	ds:off_1001F8E4[eax*4]
; ---------------------------------------------------------------------------

loc_1001E8A2:				; CODE XREF: sub_1001E5A0+223j
		cmp	eax, 8
		jz	loc_1001F082
		cmp	eax, 7
		ja	loc_1001F814
		jmp	short loc_1001E895
; ---------------------------------------------------------------------------

loc_1001E8B6:				; CODE XREF: sub_1001E5A0+2FBj
					; DATA XREF: .text:off_1001F8E4o
		cmp	[ebp+var_228], edi
		jnz	short loc_1001E8CA
		cmp	[ebp+var_224], ebx
		jz	loc_1001F814

loc_1001E8CA:				; CODE XREF: sub_1001E5A0+31Cj
		cmp	[ebp+var_228], ebx
		jnz	loc_1001EBCD
		cmp	[ebp+var_224], 0FFFFFFFFh
		jnz	loc_1001EBCD
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001E8E8:				; CODE XREF: sub_1001E5A0+2FBj
					; DATA XREF: .text:1001F8E8o
		or	[ebp+var_21C], 0FFFFFFFFh
		mov	[ebp+var_280], edi
		mov	[ebp+var_278], edi
		mov	[ebp+var_250], edi
		mov	[ebp+var_258], edi
		mov	[ebp+var_210], edi
		mov	[ebp+var_260], edi
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001E918:				; CODE XREF: sub_1001E5A0+2FBj
					; DATA XREF: .text:1001F8ECo
		movsx	eax, dl
		sub	eax, 20h
		jz	short loc_1001E969
		sub	eax, 3
		jz	short loc_1001E95A
		sub	eax, 8
		jz	short loc_1001E94F
		dec	eax
		dec	eax
		jz	short loc_1001E943
		sub	eax, 3
		jnz	loc_1001F814
		or	[ebp+var_210], 8
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001E943:				; CODE XREF: sub_1001E5A0+38Cj
		or	[ebp+var_210], 4
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001E94F:				; CODE XREF: sub_1001E5A0+388j
		or	[ebp+var_210], ebx
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001E95A:				; CODE XREF: sub_1001E5A0+383j
		or	[ebp+var_210], 80h
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001E969:				; CODE XREF: sub_1001E5A0+37Ej
		or	[ebp+var_210], 2
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001E975:				; CODE XREF: sub_1001E5A0+2FBj
					; DATA XREF: .text:1001F8F0o
		cmp	dl, 2Ah
		jnz	loc_1001EA3D
		cmp	[ebp+var_224], edi
		jnz	short loc_1001E99B
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		mov	eax, [eax-4]
		jmp	loc_1001EA1D
; ---------------------------------------------------------------------------

loc_1001E99B:				; CODE XREF: sub_1001E5A0+3E4j
		push	0Ah
		lea	eax, [ebp+var_25C]
		push	eax
		push	esi
		call	sub_10010F93
		mov	ecx, [ebp+var_25C]
		add	esp, 0Ch
		dec	eax
		lea	edx, [ecx+1]
		mov	[ebp+var_240], edx
		cmp	[ebp+var_228], edi
		jnz	short loc_1001EA11

loc_1001E9C5:				; CODE XREF: sub_1001E5A0+50Ej
		cmp	eax, edi
		jl	loc_1001F082
		cmp	byte ptr [ecx],	24h
		jnz	loc_1001F082
		cmp	[ebp+var_218], 64h
		jge	loc_1001F082
		cmp	eax, [ebp+var_254]
		jle	short loc_1001E9F1
		mov	[ebp+var_254], eax

loc_1001E9F1:				; CODE XREF: sub_1001E5A0+449j
		shl	eax, 4
		lea	ecx, [ebp+eax+var_8D0]
		cmp	[ecx], edi
		jz	loc_1001EADA
		push	[ebp+var_210]
		push	2Ah
		push	ebx
		jmp	loc_1001F071
; ---------------------------------------------------------------------------

loc_1001EA11:				; CODE XREF: sub_1001E5A0+423j
		shl	eax, 4
		mov	eax, [ebp+eax+var_8CC]
		mov	eax, [eax]

loc_1001EA1D:				; CODE XREF: sub_1001E5A0+3F6j
		cmp	eax, edi
		mov	[ebp+var_250], eax
		jge	loc_1001F814
		or	[ebp+var_210], 4
		neg	[ebp+var_250]
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EA3D:				; CODE XREF: sub_1001E5A0+3D8j
		mov	eax, [ebp+var_250]
		imul	eax, 0Ah
		movsx	ecx, dl
		lea	eax, [eax+ecx-30h]
		mov	[ebp+var_250], eax
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EA58:				; CODE XREF: sub_1001E5A0+2FBj
					; DATA XREF: .text:1001F8F4o
		mov	[ebp+var_21C], edi
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EA63:				; CODE XREF: sub_1001E5A0+2FBj
					; DATA XREF: .text:1001F8F8o
		cmp	dl, 2Ah
		jnz	loc_1001EAF6
		cmp	[ebp+var_224], edi
		jnz	short loc_1001EA86
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		mov	eax, [eax-4]
		jmp	short loc_1001EAC0
; ---------------------------------------------------------------------------

loc_1001EA86:				; CODE XREF: sub_1001E5A0+4D2j
		push	0Ah
		lea	eax, [ebp+var_25C]
		push	eax
		push	esi
		call	sub_10010F93
		mov	ecx, [ebp+var_25C]
		add	esp, 0Ch
		dec	eax
		lea	edx, [ecx+1]
		mov	[ebp+var_240], edx
		cmp	[ebp+var_228], edi
		jz	loc_1001E9C5
		shl	eax, 4
		mov	eax, [ebp+eax+var_8CC]
		mov	eax, [eax]

loc_1001EAC0:				; CODE XREF: sub_1001E5A0+4E4j
		cmp	eax, edi
		mov	[ebp+var_21C], eax
		jge	loc_1001F814
		or	[ebp+var_21C], 0FFFFFFFFh
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EADA:				; CODE XREF: sub_1001E5A0+45Dj
		mov	[ecx], ebx
		mov	[ebp+eax+var_8C8], 2Ah

loc_1001EAE4:				; CODE XREF: sub_1001E5A0+734j
		mov	ecx, [ebp+var_210]
		mov	[ebp+eax+var_8C4], ecx
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EAF6:				; CODE XREF: sub_1001E5A0+4C6j
		mov	eax, [ebp+var_21C]
		imul	eax, 0Ah
		movsx	ecx, dl
		lea	eax, [eax+ecx-30h]
		mov	[ebp+var_21C], eax
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EB11:				; CODE XREF: sub_1001E5A0+2FBj
					; DATA XREF: .text:1001F8FCo
		cmp	dl, 49h
		jz	short loc_1001EB6B
		cmp	dl, 68h
		jz	short loc_1001EB5F
		cmp	dl, 6Ch
		jz	short loc_1001EB38
		cmp	dl, 77h
		jnz	loc_1001F814
		or	[ebp+var_210], 800h
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EB38:				; CODE XREF: sub_1001E5A0+57Ej
		cmp	byte ptr [esi],	6Ch
		jnz	short loc_1001EB53
		inc	esi
		or	[ebp+var_210], 1000h
		mov	[ebp+var_240], esi
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EB53:				; CODE XREF: sub_1001E5A0+59Bj
		or	[ebp+var_210], 10h
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EB5F:				; CODE XREF: sub_1001E5A0+579j
		or	[ebp+var_210], 20h
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EB6B:				; CODE XREF: sub_1001E5A0+574j
		mov	al, [esi]
		cmp	al, 36h
		jnz	short loc_1001EB8E
		cmp	byte ptr [esi+1], 34h
		jnz	short loc_1001EB8E
		inc	esi
		inc	esi
		or	[ebp+var_210], 8000h
		mov	[ebp+var_240], esi
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EB8E:				; CODE XREF: sub_1001E5A0+5CFj
					; sub_1001E5A0+5D5j
		cmp	al, 33h
		jnz	short loc_1001EBAF
		cmp	byte ptr [esi+1], 32h
		jnz	short loc_1001EBAF
		inc	esi
		inc	esi
		and	[ebp+var_210], 0FFFF7FFFh
		mov	[ebp+var_240], esi
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EBAF:				; CODE XREF: sub_1001E5A0+5F0j
					; sub_1001E5A0+5F6j
		cmp	al, 64h
		jz	short loc_1001EC2C
		cmp	al, 69h
		jz	short loc_1001EC2C
		cmp	al, 6Fh
		jz	short loc_1001EC2C
		cmp	al, 75h
		jz	short loc_1001EC2C
		cmp	al, 78h
		jz	short loc_1001EC2C
		cmp	al, 58h
		jz	short loc_1001EC2C
		mov	[ebp+var_264], edi

loc_1001EBCD:				; CODE XREF: sub_1001E5A0+330j
					; sub_1001E5A0+33Dj
		lea	eax, [ebp+var_23C]
		push	eax
		movzx	eax, dl
		push	eax
		mov	[ebp+var_260], edi
		call	sub_100175C6
		pop	ecx
		test	eax, eax
		mov	al, byte ptr [ebp+var_22C]
		pop	ecx
		jz	short loc_1001EC16
		mov	ecx, [ebp+var_270]
		lea	esi, [ebp+var_244]
		call	sub_1001E4E5
		mov	eax, [ebp+var_240]
		mov	al, [eax]
		inc	[ebp+var_240]
		test	al, al
		jz	loc_1001F082

loc_1001EC16:				; CODE XREF: sub_1001E5A0+64Dj
		mov	ecx, [ebp+var_270]
		lea	esi, [ebp+var_244]
		call	sub_1001E4E5
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EC2C:				; CODE XREF: sub_1001E5A0+611j
					; sub_1001E5A0+615j ...
		or	[ebp+var_210], 10000h
		jmp	loc_1001F814
; ---------------------------------------------------------------------------

loc_1001EC3B:				; CODE XREF: sub_1001E5A0+2FBj
					; DATA XREF: .text:1001F900o
		movsx	eax, dl
		cmp	eax, 64h
		jg	loc_1001EF26
		jz	loc_1001F01C
		cmp	eax, 53h
		jg	loc_1001ED38
		jz	loc_1001ECF1
		sub	eax, 41h
		jz	short loc_1001EC74
		push	2
		pop	esi
		sub	eax, esi
		jz	short loc_1001ECD9
		sub	eax, esi
		jz	short loc_1001EC74
		sub	eax, esi
		jnz	loc_1001F67E

loc_1001EC74:				; CODE XREF: sub_1001E5A0+6BFj
					; sub_1001E5A0+6CAj
		add	dl, 20h
		mov	[ebp+var_280], ebx
		mov	byte ptr [ebp+var_22C],	dl

loc_1001EC83:				; CODE XREF: sub_1001E5A0+7ACj
					; sub_1001E5A0+9A1j
		or	[ebp+var_210], 40h
		cmp	[ebp+var_224], ebx
		jnz	loc_1001F0A6
		cmp	[ebp+var_228], edi
		jnz	loc_1001F0A6
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		lea	ecx, [ebp+eax+var_8D0]
		cmp	[ecx], edi
		jnz	loc_1001F063
		mov	dword ptr [ecx], 8
		mov	[ebp+eax+var_8C8], dl
		jmp	loc_1001EAE4
; ---------------------------------------------------------------------------

loc_1001ECD9:				; CODE XREF: sub_1001E5A0+6C6j
		test	[ebp+var_210], 830h
		jnz	short loc_1001ED5D
		or	[ebp+var_210], 800h
		jmp	short loc_1001ED5D
; ---------------------------------------------------------------------------

loc_1001ECF1:				; CODE XREF: sub_1001E5A0+6B6j
		test	[ebp+var_210], 830h
		jnz	short loc_1001ED07
		or	[ebp+var_210], 800h

loc_1001ED07:				; CODE XREF: sub_1001E5A0+75Bj
					; sub_1001E5A0+CB1j
		mov	ecx, [ebp+var_21C]
		cmp	ecx, 0FFFFFFFFh
		jnz	short loc_1001ED17
		mov	ecx, 7FFFFFFFh

loc_1001ED17:				; CODE XREF: sub_1001E5A0+770j
		cmp	[ebp+var_224], edi
		jnz	loc_1001F5C4
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		mov	eax, [eax-4]
		jmp	loc_1001F5EB
; ---------------------------------------------------------------------------

loc_1001ED38:				; CODE XREF: sub_1001E5A0+6B0j
		sub	eax, 58h
		jz	loc_1001F242
		dec	eax
		dec	eax
		jz	loc_1001EE60
		sub	eax, 7
		jz	loc_1001EC83
		dec	eax
		dec	eax
		jnz	loc_1001F67E
		push	2
		pop	esi

loc_1001ED5D:				; CODE XREF: sub_1001E5A0+743j
					; sub_1001E5A0+74Fj
		test	[ebp+var_210], 810h
		jz	loc_1001EDFC
		cmp	[ebp+var_224], edi
		jnz	short loc_1001ED88
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		movzx	eax, word ptr [eax-4]
		jmp	short loc_1001EDD4
; ---------------------------------------------------------------------------

loc_1001ED88:				; CODE XREF: sub_1001E5A0+7D3j
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jnz	short loc_1001EDCA
		lea	ecx, [ebp+eax+var_8D0]
		cmp	[ecx], edi
		jnz	short loc_1001EDB8
		mov	[ecx], esi
		jmp	loc_1001F620
; ---------------------------------------------------------------------------

loc_1001EDB8:				; CODE XREF: sub_1001E5A0+80Fj
		push	[ebp+var_210]
		push	[ebp+var_22C]
		push	esi
		jmp	loc_1001F4A6
; ---------------------------------------------------------------------------

loc_1001EDCA:				; CODE XREF: sub_1001E5A0+804j
		mov	eax, [ebp+eax+var_8CC]
		movzx	eax, word ptr [eax]

loc_1001EDD4:				; CODE XREF: sub_1001E5A0+7E6j
		push	eax		; WideCharStr
		push	200h		; cbMultiByte
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		lea	eax, [ebp+var_268]
		push	eax		; int
		call	sub_1001D46F
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001EE4F
		mov	[ebp+var_278], ebx
		jmp	short loc_1001EE4F
; ---------------------------------------------------------------------------

loc_1001EDFC:				; CODE XREF: sub_1001E5A0+7C7j
		cmp	[ebp+var_224], edi
		jnz	short loc_1001EE17
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		movzx	eax, word ptr [eax-4]
		jmp	short loc_1001EE43
; ---------------------------------------------------------------------------

loc_1001EE17:				; CODE XREF: sub_1001E5A0+862j
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jz	loc_1001F487
		mov	eax, [ebp+eax+var_8CC]
		movzx	eax, word ptr [eax]

loc_1001EE43:				; CODE XREF: sub_1001E5A0+875j
		mov	[ebp+MultiByteStr], al
		mov	[ebp+var_268], ebx

loc_1001EE4F:				; CODE XREF: sub_1001E5A0+852j
					; sub_1001E5A0+85Aj
		lea	eax, [ebp+MultiByteStr]
		mov	[ebp+var_220], eax
		jmp	loc_1001F67E
; ---------------------------------------------------------------------------

loc_1001EE60:				; CODE XREF: sub_1001E5A0+7A3j
		cmp	[ebp+var_224], edi
		jnz	short loc_1001EE7A
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		mov	eax, [eax-4]
		jmp	short loc_1001EEA5
; ---------------------------------------------------------------------------

loc_1001EE7A:				; CODE XREF: sub_1001E5A0+8C6j
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jz	loc_1001EFBC
		mov	eax, [ebp+eax+var_8CC]
		mov	eax, [eax]

loc_1001EEA5:				; CODE XREF: sub_1001E5A0+8D8j
		cmp	eax, edi
		jz	short loc_1001EF0A
		mov	edx, [eax+4]
		cmp	edx, edi
		jz	short loc_1001EF0A
		movzx	ecx, word ptr [eax]
		cmp	[eax+2], cx
		jb	loc_1001F082
		test	[ebp+var_210], 800h
		movzx	eax, cx
		jz	short loc_1001EEF9
		mov	ecx, eax
		not	ecx
		test	cl, 1
		jz	loc_1001F082
		mov	ecx, edx
		not	ecx
		test	cl, 1
		jz	loc_1001F082
		mov	[ebp+var_220], edx
		shr	eax, 1
		mov	[ebp+var_260], ebx
		jmp	loc_1001F678
; ---------------------------------------------------------------------------

loc_1001EEF9:				; CODE XREF: sub_1001E5A0+92Aj
		mov	[ebp+var_260], edi
		mov	[ebp+var_220], edx
		jmp	loc_1001F678
; ---------------------------------------------------------------------------

loc_1001EF0A:				; CODE XREF: sub_1001E5A0+907j
					; sub_1001E5A0+90Ej
		mov	eax, off_1002DB80
		mov	[ebp+var_220], eax
		lea	edx, [eax+1]

loc_1001EF18:				; CODE XREF: sub_1001E5A0+97Dj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001EF18

loc_1001EF1F:				; CODE XREF: sub_1001E5A0+C93j
		sub	eax, edx
		jmp	loc_1001F678
; ---------------------------------------------------------------------------

loc_1001EF26:				; CODE XREF: sub_1001E5A0+6A1j
		cmp	eax, 70h
		jg	loc_1001F24E
		jz	loc_1001F238
		cmp	eax, 65h
		jl	loc_1001F67E
		cmp	eax, 67h
		jle	loc_1001EC83
		cmp	eax, 69h
		jz	loc_1001F01C
		cmp	eax, 6Eh
		jz	short loc_1001EF84
		cmp	eax, 6Fh
		jnz	loc_1001F67E
		test	byte ptr [ebp+var_210],	80h
		mov	[ebp+var_24C], 8
		jz	loc_1001F02D
		or	[ebp+var_210], 200h
		jmp	loc_1001F02D
; ---------------------------------------------------------------------------

loc_1001EF84:				; CODE XREF: sub_1001E5A0+9B3j
		cmp	[ebp+var_224], edi
		jnz	short loc_1001EF9E
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		mov	esi, [eax-4]
		jmp	short loc_1001EFE7
; ---------------------------------------------------------------------------

loc_1001EF9E:				; CODE XREF: sub_1001E5A0+9EAj
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jnz	short loc_1001EFDE

loc_1001EFBC:				; CODE XREF: sub_1001E5A0+8F6j
					; sub_1001E5A0+103Cj
		lea	ecx, [ebp+eax+var_8D0]
		cmp	[ecx], edi
		jz	loc_1001F61A
		push	[ebp+var_210]
		push	[ebp+var_22C]
		push	3
		jmp	loc_1001F4A6
; ---------------------------------------------------------------------------

loc_1001EFDE:				; CODE XREF: sub_1001E5A0+A1Aj
		mov	eax, [ebp+eax+var_8CC]
		mov	esi, [eax]

loc_1001EFE7:				; CODE XREF: sub_1001E5A0+9FCj
		call	sub_1001D2ED
		test	eax, eax
		jz	loc_1001F082
		test	byte ptr [ebp+var_210],	20h
		jz	short loc_1001F009
		mov	ax, word ptr [ebp+var_244]
		mov	[esi], ax
		jmp	short loc_1001F011
; ---------------------------------------------------------------------------

loc_1001F009:				; CODE XREF: sub_1001E5A0+A5Bj
		mov	eax, [ebp+var_244]
		mov	[esi], eax

loc_1001F011:				; CODE XREF: sub_1001E5A0+A67j
		mov	[ebp+var_278], ebx
		jmp	loc_1001F67E
; ---------------------------------------------------------------------------

loc_1001F01C:				; CODE XREF: sub_1001E5A0+6A7j
					; sub_1001E5A0+9AAj
		or	[ebp+var_210], 40h

loc_1001F023:				; CODE XREF: sub_1001E5A0+CB9j
		mov	[ebp+var_24C], 0Ah

loc_1001F02D:				; CODE XREF: sub_1001E5A0+9CFj
					; sub_1001E5A0+9DFj ...
		mov	eax, [ebp+var_210]
		test	eax, 8000h
		jz	loc_1001F2F8
		cmp	[ebp+var_224], edi
		jnz	loc_1001F2AD

loc_1001F04A:				; CODE XREF: sub_1001E5A0+D65j
		mov	ecx, [ebp+var_214]
		mov	eax, [ecx]
		mov	edx, [ecx+4]
		add	ecx, 8
		mov	[ebp+var_214], ecx
		jmp	loc_1001F4C7
; ---------------------------------------------------------------------------

loc_1001F063:				; CODE XREF: sub_1001E5A0+721j
		push	[ebp+var_210]
		push	[ebp+var_22C]
		push	8

loc_1001F071:				; CODE XREF: sub_1001E5A0+46Cj
		push	ecx
		call	sub_1001E3BA
		add	esp, 10h
		test	eax, eax
		jnz	loc_1001F814

loc_1001F082:				; CODE XREF: sub_1001E5A0+2C7j
					; sub_1001E5A0+2D0j ...
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_230], 0
		jmp	loc_1001E636
; ---------------------------------------------------------------------------

loc_1001F0A6:				; CODE XREF: sub_1001E5A0+6F0j
					; sub_1001E5A0+6FCj
		cmp	[ebp+var_21C], edi
		lea	eax, [ebp+MultiByteStr]
		mov	[ebp+var_220], eax
		mov	eax, 200h
		mov	[ebp+var_24C], eax
		jge	short loc_1001F0D1
		mov	[ebp+var_21C], 6
		jmp	short loc_1001F0DE
; ---------------------------------------------------------------------------

loc_1001F0D1:				; CODE XREF: sub_1001E5A0+B23j
		jnz	short loc_1001F0F7
		cmp	dl, 67h
		jnz	short loc_1001F0DE

loc_1001F0D8:				; CODE XREF: sub_1001E5A0+B93j
		mov	[ebp+var_21C], ebx

loc_1001F0DE:				; CODE XREF: sub_1001E5A0+B2Fj
					; sub_1001E5A0+B36j ...
		cmp	[ebp+var_224], edi
		jnz	short loc_1001F143
		mov	eax, [ebp+var_214]
		add	eax, 8
		mov	[ebp+var_214], eax
		jmp	short loc_1001F163
; ---------------------------------------------------------------------------

loc_1001F0F7:				; CODE XREF: sub_1001E5A0:loc_1001F0D1j
		cmp	[ebp+var_21C], eax
		jle	short loc_1001F105
		mov	[ebp+var_21C], eax

loc_1001F105:				; CODE XREF: sub_1001E5A0+B5Dj
		mov	ebx, 0A3h
		cmp	[ebp+var_21C], ebx
		jle	short loc_1001F0DE
		mov	esi, [ebp+var_21C]
		add	esi, 15Dh
		push	esi
		call	sub_1000F5A0
		mov	dl, byte ptr [ebp+var_22C]
		pop	ecx
		mov	[ebp+lpMem], eax
		cmp	eax, edi
		jz	short loc_1001F0D8
		mov	[ebp+var_220], eax
		mov	[ebp+var_24C], esi
		jmp	short loc_1001F0DE
; ---------------------------------------------------------------------------

loc_1001F143:				; CODE XREF: sub_1001E5A0+B44j
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		mov	eax, [ebp+eax+var_8CC]
		add	eax, 8

loc_1001F163:				; CODE XREF: sub_1001E5A0+B55j
		mov	ecx, [eax-8]
		mov	[ebp+var_28C], ecx
		mov	eax, [eax-4]
		mov	[ebp+var_288], eax
		lea	eax, [ebp+var_23C]
		push	eax
		push	[ebp+var_280]
		movsx	eax, dl
		push	[ebp+var_21C]
		push	eax
		push	[ebp+var_24C]
		lea	eax, [ebp+var_28C]
		push	[ebp+var_220]
		push	eax
		push	off_1002E198
		call	sub_100135C4
		pop	ecx
		call	eax
		mov	esi, [ebp+var_210]
		add	esp, 1Ch
		and	esi, 80h
		jz	short loc_1001F1E3
		cmp	[ebp+var_21C], edi
		jnz	short loc_1001F1E3
		lea	eax, [ebp+var_23C]
		push	eax
		push	[ebp+var_220]
		push	off_1002E1A4
		call	sub_100135C4
		pop	ecx
		call	eax
		pop	ecx
		pop	ecx

loc_1001F1E3:				; CODE XREF: sub_1001E5A0+C1Cj
					; sub_1001E5A0+C24j
		cmp	byte ptr [ebp+var_22C],	67h
		jnz	short loc_1001F20D
		cmp	esi, edi
		jnz	short loc_1001F20D
		lea	eax, [ebp+var_23C]
		push	eax
		push	[ebp+var_220]
		push	off_1002E1A0
		call	sub_100135C4
		pop	ecx
		call	eax
		pop	ecx
		pop	ecx

loc_1001F20D:				; CODE XREF: sub_1001E5A0+C4Aj
					; sub_1001E5A0+C4Ej
		mov	eax, [ebp+var_220]
		cmp	byte ptr [eax],	2Dh
		jnz	short loc_1001F229
		or	[ebp+var_210], 100h
		inc	eax
		mov	[ebp+var_220], eax

loc_1001F229:				; CODE XREF: sub_1001E5A0+C76j
		lea	edx, [eax+1]

loc_1001F22C:				; CODE XREF: sub_1001E5A0+C91j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001F22C
		jmp	loc_1001EF1F
; ---------------------------------------------------------------------------

loc_1001F238:				; CODE XREF: sub_1001E5A0+98Fj
		mov	[ebp+var_21C], 8

loc_1001F242:				; CODE XREF: sub_1001E5A0+79Bj
		mov	[ebp+var_274], 7
		jmp	short loc_1001F272
; ---------------------------------------------------------------------------

loc_1001F24E:				; CODE XREF: sub_1001E5A0+989j
		sub	eax, 73h
		jz	loc_1001ED07
		dec	eax
		dec	eax
		jz	loc_1001F023
		sub	eax, 3
		jnz	loc_1001F67E
		mov	[ebp+var_274], 27h

loc_1001F272:				; CODE XREF: sub_1001E5A0+CACj
		test	byte ptr [ebp+var_210],	80h
		mov	[ebp+var_24C], 10h
		jz	loc_1001F02D
		mov	al, byte ptr [ebp+var_274]
		add	al, 51h
		mov	[ebp+var_248], 30h
		mov	[ebp+var_247], al
		mov	[ebp+var_258], 2
		jmp	loc_1001F02D
; ---------------------------------------------------------------------------

loc_1001F2AD:				; CODE XREF: sub_1001E5A0+AA4j
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jnz	loc_1001F352
		lea	ecx, [ebp+eax+var_8D0]
		cmp	[ecx], edi
		jnz	short loc_1001F2E5
		mov	dword ptr [ecx], 4
		jmp	loc_1001F620
; ---------------------------------------------------------------------------

loc_1001F2E5:				; CODE XREF: sub_1001E5A0+D38j
		push	[ebp+var_210]
		push	[ebp+var_22C]
		push	4
		jmp	loc_1001F4A6
; ---------------------------------------------------------------------------

loc_1001F2F8:				; CODE XREF: sub_1001E5A0+A98j
		test	eax, 1000h
		jz	short loc_1001F363
		cmp	[ebp+var_224], edi
		jz	loc_1001F04A
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jnz	short loc_1001F352
		lea	ecx, [ebp+eax+var_8D0]
		cmp	[ecx], edi
		jnz	short loc_1001F33F
		mov	dword ptr [ecx], 5
		jmp	loc_1001F620
; ---------------------------------------------------------------------------

loc_1001F33F:				; CODE XREF: sub_1001E5A0+D92j
		push	[ebp+var_210]
		push	[ebp+var_22C]
		push	5
		jmp	loc_1001F4A6
; ---------------------------------------------------------------------------

loc_1001F352:				; CODE XREF: sub_1001E5A0+D29j
					; sub_1001E5A0+D87j
		mov	ecx, [ebp+eax+var_8CC]
		mov	eax, [ecx]
		mov	edx, [ecx+4]
		jmp	loc_1001F4C7
; ---------------------------------------------------------------------------

loc_1001F363:				; CODE XREF: sub_1001E5A0+D5Dj
		test	al, 20h
		jz	loc_1001F407
		test	al, 40h
		jz	short loc_1001F3BE
		cmp	[ebp+var_224], edi
		jnz	short loc_1001F38D
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		movsx	eax, word ptr [eax-4]
		jmp	loc_1001F44C
; ---------------------------------------------------------------------------

loc_1001F38D:				; CODE XREF: sub_1001E5A0+DD5j
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jz	loc_1001F487
		mov	eax, [ebp+eax+var_8CC]
		movsx	eax, word ptr [eax]
		jmp	loc_1001F44C
; ---------------------------------------------------------------------------

loc_1001F3BE:				; CODE XREF: sub_1001E5A0+DCDj
		cmp	[ebp+var_224], edi
		jnz	short loc_1001F3D9
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		movzx	eax, word ptr [eax-4]
		jmp	short loc_1001F44C
; ---------------------------------------------------------------------------

loc_1001F3D9:				; CODE XREF: sub_1001E5A0+E24j
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jz	loc_1001F487
		mov	eax, [ebp+eax+var_8CC]
		movzx	eax, word ptr [eax]
		jmp	short loc_1001F44C
; ---------------------------------------------------------------------------

loc_1001F407:				; CODE XREF: sub_1001E5A0+DC5j
		test	al, 40h
		jz	short loc_1001F44F
		cmp	[ebp+var_224], edi
		jnz	short loc_1001F425
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		mov	eax, [eax-4]
		jmp	short loc_1001F44C
; ---------------------------------------------------------------------------

loc_1001F425:				; CODE XREF: sub_1001E5A0+E71j
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jz	short loc_1001F487
		mov	eax, [ebp+eax+var_8CC]
		mov	eax, [eax]

loc_1001F44C:				; CODE XREF: sub_1001E5A0+DE8j
					; sub_1001E5A0+E19j ...
		cdq
		jmp	short loc_1001F4C7
; ---------------------------------------------------------------------------

loc_1001F44F:				; CODE XREF: sub_1001E5A0+E69j
		cmp	[ebp+var_224], edi
		jnz	short loc_1001F469
		add	[ebp+var_214], 4
		mov	eax, [ebp+var_214]
		mov	eax, [eax-4]
		jmp	short loc_1001F4C5
; ---------------------------------------------------------------------------

loc_1001F469:				; CODE XREF: sub_1001E5A0+EB5j
		cmp	[ebp+var_218], 63h
		ja	loc_1001F082
		mov	eax, [ebp+var_218]
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jnz	short loc_1001F4BC

loc_1001F487:				; CODE XREF: sub_1001E5A0+893j
					; sub_1001E5A0+E09j ...
		lea	ecx, [ebp+eax+var_8D0]
		cmp	[ecx], edi
		jnz	short loc_1001F499
		mov	[ecx], ebx
		jmp	loc_1001F620
; ---------------------------------------------------------------------------

loc_1001F499:				; CODE XREF: sub_1001E5A0+EF0j
		push	[ebp+var_210]
		push	[ebp+var_22C]
		push	ebx

loc_1001F4A6:				; CODE XREF: sub_1001E5A0+825j
					; sub_1001E5A0+A39j ...
		push	ecx
		call	sub_1001E3BA
		add	esp, 10h
		test	eax, eax
		jz	loc_1001F082
		jmp	loc_1001F67E
; ---------------------------------------------------------------------------

loc_1001F4BC:				; CODE XREF: sub_1001E5A0+EE5j
		mov	eax, [ebp+eax+var_8CC]
		mov	eax, [eax]

loc_1001F4C5:				; CODE XREF: sub_1001E5A0+EC7j
		xor	edx, edx

loc_1001F4C7:				; CODE XREF: sub_1001E5A0+ABEj
					; sub_1001E5A0+DBEj ...
		test	byte ptr [ebp+var_210],	40h
		jz	short loc_1001F4EB
		cmp	edx, edi
		jg	short loc_1001F4EB
		jl	short loc_1001F4DA
		cmp	eax, edi
		jnb	short loc_1001F4EB

loc_1001F4DA:				; CODE XREF: sub_1001E5A0+F34j
		neg	eax
		adc	edx, 0
		neg	edx
		or	[ebp+var_210], 100h

loc_1001F4EB:				; CODE XREF: sub_1001E5A0+F2Ej
					; sub_1001E5A0+F32j ...
		test	[ebp+var_210], 9000h
		mov	ebx, edx
		mov	edi, eax
		jnz	short loc_1001F4FD
		xor	ebx, ebx

loc_1001F4FD:				; CODE XREF: sub_1001E5A0+F59j
		cmp	[ebp+var_21C], 0
		jge	short loc_1001F512
		mov	[ebp+var_21C], 1
		jmp	short loc_1001F52C
; ---------------------------------------------------------------------------

loc_1001F512:				; CODE XREF: sub_1001E5A0+F64j
		and	[ebp+var_210], 0FFFFFFF7h
		mov	eax, 200h
		cmp	[ebp+var_21C], eax
		jle	short loc_1001F52C
		mov	[ebp+var_21C], eax

loc_1001F52C:				; CODE XREF: sub_1001E5A0+F70j
					; sub_1001E5A0+F84j
		mov	eax, edi
		or	eax, ebx
		jnz	short loc_1001F538
		and	[ebp+var_258], eax

loc_1001F538:				; CODE XREF: sub_1001E5A0+F90j
		lea	esi, [ebp+var_D]

loc_1001F53B:				; CODE XREF: sub_1001E5A0+FDCj
		mov	eax, [ebp+var_21C]
		dec	[ebp+var_21C]
		test	eax, eax
		jg	short loc_1001F551
		mov	eax, edi
		or	eax, ebx
		jz	short loc_1001F57E

loc_1001F551:				; CODE XREF: sub_1001E5A0+FA9j
		mov	eax, [ebp+var_24C]
		cdq
		push	edx
		push	eax
		push	ebx
		push	edi
		call	sub_1001D510
		add	ecx, 30h
		cmp	ecx, 39h
		mov	[ebp+var_268], ebx
		mov	edi, eax
		mov	ebx, edx
		jle	short loc_1001F579
		add	ecx, [ebp+var_274]

loc_1001F579:				; CODE XREF: sub_1001E5A0+FD1j
		mov	[esi], cl
		dec	esi
		jmp	short loc_1001F53B
; ---------------------------------------------------------------------------

loc_1001F57E:				; CODE XREF: sub_1001E5A0+FAFj
		lea	eax, [ebp+var_D]
		sub	eax, esi
		inc	esi
		test	[ebp+var_210], 200h
		mov	[ebp+var_268], eax
		mov	[ebp+var_220], esi
		jz	loc_1001F67E
		test	eax, eax
		jz	short loc_1001F5AF
		mov	ecx, esi
		cmp	byte ptr [ecx],	30h
		jz	loc_1001F67E

loc_1001F5AF:				; CODE XREF: sub_1001E5A0+1002j
		dec	[ebp+var_220]
		mov	ecx, [ebp+var_220]
		mov	byte ptr [ecx],	30h
		inc	eax
		jmp	loc_1001F678
; ---------------------------------------------------------------------------

loc_1001F5C4:				; CODE XREF: sub_1001E5A0+77Dj
		mov	eax, [ebp+var_218]
		cmp	eax, 63h
		ja	loc_1001F082
		shl	eax, 4
		cmp	[ebp+var_228], edi
		jz	loc_1001EFBC
		mov	eax, [ebp+eax+var_8CC]
		mov	eax, [eax]

loc_1001F5EB:				; CODE XREF: sub_1001E5A0+793j
		test	[ebp+var_210], 810h
		mov	[ebp+var_220], eax
		jz	short loc_1001F64C
		cmp	eax, edi
		jnz	short loc_1001F60C
		mov	eax, off_1002DB84
		mov	[ebp+var_220], eax

loc_1001F60C:				; CODE XREF: sub_1001E5A0+105Fj
		mov	eax, [ebp+var_220]
		mov	[ebp+var_260], ebx
		jmp	short loc_1001F63E
; ---------------------------------------------------------------------------

loc_1001F61A:				; CODE XREF: sub_1001E5A0+A25j
		mov	dword ptr [ecx], 3

loc_1001F620:				; CODE XREF: sub_1001E5A0+813j
					; sub_1001E5A0+D40j ...
		mov	ecx, [ebp+var_210]
		mov	[ebp+eax+var_8C8], dl
		mov	[ebp+eax+var_8C4], ecx
		jmp	short loc_1001F67E
; ---------------------------------------------------------------------------

loc_1001F636:				; CODE XREF: sub_1001E5A0+10A0j
		dec	ecx
		cmp	[eax], di
		jz	short loc_1001F642
		inc	eax
		inc	eax

loc_1001F63E:				; CODE XREF: sub_1001E5A0+1078j
		cmp	ecx, edi
		jnz	short loc_1001F636

loc_1001F642:				; CODE XREF: sub_1001E5A0+109Aj
		sub	eax, [ebp+var_220]
		sar	eax, 1
		jmp	short loc_1001F678
; ---------------------------------------------------------------------------

loc_1001F64C:				; CODE XREF: sub_1001E5A0+105Bj
		cmp	[ebp+var_220], edi
		jnz	short loc_1001F65F
		mov	eax, off_1002DB80
		mov	[ebp+var_220], eax

loc_1001F65F:				; CODE XREF: sub_1001E5A0+10B2j
		mov	eax, [ebp+var_220]
		jmp	short loc_1001F66E
; ---------------------------------------------------------------------------

loc_1001F667:				; CODE XREF: sub_1001E5A0+10D0j
		dec	ecx
		cmp	byte ptr [eax],	0
		jz	short loc_1001F672
		inc	eax

loc_1001F66E:				; CODE XREF: sub_1001E5A0+10C5j
		cmp	ecx, edi
		jnz	short loc_1001F667

loc_1001F672:				; CODE XREF: sub_1001E5A0+10CBj
		sub	eax, [ebp+var_220]

loc_1001F678:				; CODE XREF: sub_1001E5A0+954j
					; sub_1001E5A0+965j ...
		mov	[ebp+var_268], eax

loc_1001F67E:				; CODE XREF: sub_1001E5A0+6CEj
					; sub_1001E5A0+7B4j ...
		cmp	[ebp+var_224], 1
		jnz	short loc_1001F694
		cmp	[ebp+var_228], 0
		jz	loc_1001F814

loc_1001F694:				; CODE XREF: sub_1001E5A0+10E5j
		cmp	[ebp+var_278], 0
		jnz	loc_1001F7F8
		mov	eax, [ebp+var_210]
		test	al, 40h
		jz	short loc_1001F6DD
		test	eax, 100h
		jz	short loc_1001F6BB
		mov	[ebp+var_248], 2Dh
		jmp	short loc_1001F6D3
; ---------------------------------------------------------------------------

loc_1001F6BB:				; CODE XREF: sub_1001E5A0+1110j
		test	al, 1
		jz	short loc_1001F6C8
		mov	[ebp+var_248], 2Bh
		jmp	short loc_1001F6D3
; ---------------------------------------------------------------------------

loc_1001F6C8:				; CODE XREF: sub_1001E5A0+111Dj
		test	al, 2
		jz	short loc_1001F6DD
		mov	[ebp+var_248], 20h

loc_1001F6D3:				; CODE XREF: sub_1001E5A0+1119j
					; sub_1001E5A0+1126j
		mov	[ebp+var_258], 1

loc_1001F6DD:				; CODE XREF: sub_1001E5A0+1109j
					; sub_1001E5A0+112Aj
		mov	ebx, [ebp+var_250]
		sub	ebx, [ebp+var_268]
		sub	ebx, [ebp+var_258]
		test	al, 0Ch
		jnz	short loc_1001F70A
		push	[ebp+var_270]
		lea	eax, [ebp+var_244]
		push	ebx
		push	20h
		call	sub_1001E518
		add	esp, 0Ch

loc_1001F70A:				; CODE XREF: sub_1001E5A0+1151j
		push	[ebp+var_258]
		mov	edi, [ebp+var_270]
		lea	eax, [ebp+var_244]
		lea	ecx, [ebp+var_248]
		call	sub_1001E53E
		test	byte ptr [ebp+var_210],	8
		pop	ecx
		jz	short loc_1001F74C
		test	byte ptr [ebp+var_210],	4
		jnz	short loc_1001F74C
		push	edi
		push	ebx
		push	30h
		lea	eax, [ebp+var_244]
		call	sub_1001E518
		add	esp, 0Ch

loc_1001F74C:				; CODE XREF: sub_1001E5A0+118Fj
					; sub_1001E5A0+1198j
		cmp	[ebp+var_260], 0
		mov	eax, [ebp+var_268]
		jz	short loc_1001F7C1
		test	eax, eax
		jle	short loc_1001F7C1
		mov	esi, [ebp+var_220]
		mov	[ebp+var_24C], eax

loc_1001F76B:				; CODE XREF: sub_1001E5A0+1214j
		movzx	eax, word ptr [esi]
		dec	[ebp+var_24C]
		push	eax		; WideCharStr
		push	6		; cbMultiByte
		lea	eax, [ebp+var_C]
		push	eax		; lpMultiByteStr
		lea	eax, [ebp+var_284]
		inc	esi
		push	eax		; int
		inc	esi
		call	sub_1001D46F
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1001F7B8
		cmp	[ebp+var_284], eax
		jz	short loc_1001F7B8
		push	[ebp+var_284]
		lea	eax, [ebp+var_244]
		lea	ecx, [ebp+var_C]
		call	sub_1001E53E
		cmp	[ebp+var_24C], 0
		pop	ecx
		jnz	short loc_1001F76B
		jmp	short loc_1001F7D4
; ---------------------------------------------------------------------------

loc_1001F7B8:				; CODE XREF: sub_1001E5A0+11EEj
					; sub_1001E5A0+11F6j
		or	[ebp+var_244], 0FFFFFFFFh
		jmp	short loc_1001F7D4
; ---------------------------------------------------------------------------

loc_1001F7C1:				; CODE XREF: sub_1001E5A0+11B9j
					; sub_1001E5A0+11BDj
		mov	ecx, [ebp+var_220]
		push	eax
		lea	eax, [ebp+var_244]
		call	sub_1001E53E
		pop	ecx

loc_1001F7D4:				; CODE XREF: sub_1001E5A0+1216j
					; sub_1001E5A0+121Fj
		cmp	[ebp+var_244], 0
		jl	short loc_1001F7F8
		test	byte ptr [ebp+var_210],	4
		jz	short loc_1001F7F8
		push	edi
		push	ebx
		push	20h
		lea	eax, [ebp+var_244]
		call	sub_1001E518
		add	esp, 0Ch

loc_1001F7F8:				; CODE XREF: sub_1001E5A0+10FBj
					; sub_1001E5A0+123Bj ...
		cmp	[ebp+lpMem], 0
		jz	short loc_1001F814
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		and	[ebp+lpMem], 0
		pop	ecx

loc_1001F814:				; CODE XREF: sub_1001E5A0+30Ej
					; sub_1001E5A0+324j ...
		mov	esi, [ebp+var_240]
		mov	al, [esi]
		mov	byte ptr [ebp+var_22C],	al
		test	al, al
		jnz	loc_1001E770
		xor	edi, edi

loc_1001F82C:				; CODE XREF: sub_1001E5A0+1E5j
		cmp	[ebp+var_264], edi
		jz	short loc_1001F841
		cmp	[ebp+var_264], 7
		jnz	loc_1001F082

loc_1001F841:				; CODE XREF: sub_1001E5A0+1292j
		cmp	[ebp+var_224], 1
		jnz	short loc_1001F8A3
		cmp	[ebp+var_228], edi
		jnz	short loc_1001F8A3
		xor	esi, esi
		cmp	[ebp+var_254], edi
		jl	short loc_1001F8A3
		mov	edx, [ebp+var_214]
		lea	eax, [ebp+var_8CC]

loc_1001F868:				; CODE XREF: sub_1001E5A0+1301j
		mov	ecx, [eax-4]
		dec	ecx
		jz	short loc_1001F88C
		dec	ecx
		jz	short loc_1001F88C
		dec	ecx
		jz	short loc_1001F88C
		dec	ecx
		jz	short loc_1001F885
		dec	ecx
		jz	short loc_1001F885
		dec	ecx
		jz	short loc_1001F88C
		dec	ecx
		dec	ecx
		jnz	loc_1001F082

loc_1001F885:				; CODE XREF: sub_1001E5A0+12D5j
					; sub_1001E5A0+12D8j
		mov	[eax], edx
		add	edx, 8
		jmp	short loc_1001F891
; ---------------------------------------------------------------------------

loc_1001F88C:				; CODE XREF: sub_1001E5A0+12CCj
					; sub_1001E5A0+12CFj ...
		mov	[eax], edx
		add	edx, 4

loc_1001F891:				; CODE XREF: sub_1001E5A0+12EAj
		inc	esi
		add	eax, 10h
		cmp	esi, [ebp+var_254]
		mov	[ebp+var_214], edx
		jle	short loc_1001F868

loc_1001F8A3:				; CODE XREF: sub_1001E5A0+1C6j
					; sub_1001E5A0+12A8j ...
		inc	[ebp+var_228]
		cmp	[ebp+var_228], 2
		jge	short loc_1001F8B9
		xor	ebx, ebx
		jmp	loc_1001E706
; ---------------------------------------------------------------------------

loc_1001F8B9:				; CODE XREF: sub_1001E5A0+175j
					; sub_1001E5A0+1310j
		cmp	[ebp+var_230], 0
		jz	short loc_1001F8CC
		mov	eax, [ebp+var_234]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1001F8CC:				; CODE XREF: sub_1001E5A0+1320j
		mov	eax, [ebp+var_244]

loc_1001F8D2:				; CODE XREF: sub_1001E5A0+A5j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1001E5A0	endp

; ---------------------------------------------------------------------------
		align 4
off_1001F8E4	dd offset loc_1001E8B6	; DATA XREF: sub_1001E5A0+2FBr
		dd offset loc_1001E8E8
		dd offset loc_1001E918
		dd offset loc_1001E975
		dd offset loc_1001EA58
		dd offset loc_1001EA63
		dd offset loc_1001EB11
		dd offset loc_1001EC3B

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001F904	proc near		; CODE XREF: sub_1001679B+11p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	dword_1002EF60,	eax
		pop	ebp
		retn
sub_1001F904	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1001F913(LPCRITICAL_SECTION	lpCriticalSection, int)
sub_1001F913	proc near		; DATA XREF: sub_1001F928:loc_1001F99Co

lpCriticalSection= dword ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+lpCriticalSection]	; lpCriticalSection
		call	ds:InitializeCriticalSection
		xor	eax, eax
		inc	eax
		pop	ebp
		retn	8
sub_1001F913	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001F928	proc near		; CODE XREF: sub_10015204+78p
					; sub_100179DC+157p ...

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	14h
		push	offset stru_1002B770
		call	__SEH_prolog4
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		push	dword_1002EF60
		call	sub_100135C4
		pop	ecx
		mov	esi, eax
		cmp	esi, ebx
		jnz	short loc_1001F9AD
		lea	eax, [ebp+var_1C]
		push	eax
		call	sub_1001653D
		pop	ecx
		cmp	eax, ebx
		jz	short loc_1001F966
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_1001F966:				; CODE XREF: sub_1001F928+2Fj
		cmp	[ebp+var_1C], 1
		jz	short loc_1001F99C
		push	offset aKernelbase_d_0 ; "kernelbase.dll"
		mov	esi, ds:GetModuleHandleW
		call	esi ; GetModuleHandleW
		mov	edi, eax
		cmp	edi, ebx
		jnz	short loc_1001F98A
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		call	esi ; GetModuleHandleW
		cmp	edi, ebx
		jz	short loc_1001F99C

loc_1001F98A:				; CODE XREF: sub_1001F928+55j
		push	offset aInitializecrit ; "InitializeCriticalSectionAndSpinCount"
		push	edi		; hModule
		call	ds:GetProcAddress
		mov	esi, eax
		cmp	esi, ebx
		jnz	short loc_1001F9A1

loc_1001F99C:				; CODE XREF: sub_1001F928+42j
					; sub_1001F928+60j
		mov	esi, offset sub_1001F913

loc_1001F9A1:				; CODE XREF: sub_1001F928+72j
		push	esi
		call	sub_10013548
		pop	ecx
		mov	dword_1002EF60,	eax

loc_1001F9AD:				; CODE XREF: sub_1001F928+21j
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	esi
		mov	[ebp+var_20], eax
		jmp	short loc_1001F9EC
; ---------------------------------------------------------------------------

loc_1001F9BD:				; DATA XREF: .rdata:stru_1002B770o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 1001F928
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_24], eax
		xor	ecx, ecx
		cmp	eax, 0C0000017h
		setz	cl
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_1001F9D4:				; DATA XREF: .rdata:stru_1002B770o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1001F928
		cmp	[ebp+var_24], 0C0000017h
		jnz	short loc_1001F9E8
		push	8		; dwErrCode
		call	ds:SetLastError

loc_1001F9E8:				; CODE XREF: sub_1001F928+B6j
		and	[ebp+var_20], 0

loc_1001F9EC:				; CODE XREF: sub_1001F928+93j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+var_20]
		call	__SEH_epilog4
		retn
sub_1001F928	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001F9FC	proc near		; CODE XREF: sub_10015128+2Dp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1001F928
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_1001F9FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001FA10	proc near		; CODE XREF: sub_10015425+2DCp
					; .text:10015C8Bp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		mov	esi, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	edi, [ebp+arg_0]
		mov	eax, ecx
		mov	edx, ecx
		add	eax, esi
		cmp	edi, esi
		jbe	short loc_1001FA30
		cmp	edi, eax
		jb	loc_1001FBD4

loc_1001FA30:				; CODE XREF: sub_1001FA10+16j
		cmp	ecx, 100h
		jb	short loc_1001FA57
		cmp	dword_1002F1CC,	0
		jz	short loc_1001FA57
		push	edi
		push	esi
		and	edi, 0Fh
		and	esi, 0Fh
		cmp	edi, esi
		pop	esi
		pop	edi
		jnz	short loc_1001FA57
		pop	esi
		pop	edi
		pop	ebp
		jmp	sub_10011A87
; ---------------------------------------------------------------------------

loc_1001FA57:				; CODE XREF: sub_1001FA10+26j
					; sub_1001FA10+2Fj ...
		test	edi, 3
		jnz	short loc_1001FA74
		shr	ecx, 2
		and	edx, 3
		cmp	ecx, 8		; switch 8 cases
		jb	short loc_1001FA94
		rep movsd		; jumptable 1001FA94 default case
		jmp	ds:off_1001FB84[edx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1001FA74:				; CODE XREF: sub_1001FA10+4Dj
		mov	eax, edi
		mov	edx, 3
		sub	ecx, 4
		jb	short loc_1001FA8C
		and	eax, 3
		add	ecx, eax
		jmp	dword ptr ds:(loc_1001FA94+4)[eax*4]
; ---------------------------------------------------------------------------

loc_1001FA8C:				; CODE XREF: sub_1001FA10+6Ej
		jmp	dword ptr ds:loc_1001FB94[ecx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1001FA94:				; CODE XREF: sub_1001FA10+58j
					; sub_1001FA10+B6j ...
		jmp	ds:off_1001FB18[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 4
		dd offset loc_1001FAA8
		dd offset loc_1001FAD4
		dd offset loc_1001FAF8
; ---------------------------------------------------------------------------

loc_1001FAA8:				; DATA XREF: sub_1001FA10+8Co
		and	edx, ecx
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	al, [esi+2]
		shr	ecx, 2
		mov	[edi+2], al
		add	esi, 3
		add	edi, 3
		cmp	ecx, 8
		jb	short loc_1001FA94
		rep movsd
		jmp	ds:off_1001FB84[edx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1001FAD4:				; DATA XREF: sub_1001FA10+90o
		and	edx, ecx
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		shr	ecx, 2
		mov	[edi+1], al
		add	esi, 2
		add	edi, 2
		cmp	ecx, 8
		jb	short loc_1001FA94
		rep movsd
		jmp	ds:off_1001FB84[edx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1001FAF8:				; DATA XREF: sub_1001FA10+94o
		and	edx, ecx
		mov	al, [esi]
		mov	[edi], al
		add	esi, 1
		shr	ecx, 2
		add	edi, 1
		cmp	ecx, 8
		jb	short loc_1001FA94
		rep movsd
		jmp	ds:off_1001FB84[edx*4]
; ---------------------------------------------------------------------------
		align 4
off_1001FB18	dd offset loc_1001FB7B	; DATA XREF: sub_1001FA10:loc_1001FA94r
		dd offset loc_1001FB68	; jump table for switch	statement
		dd offset loc_1001FB60
		dd offset loc_1001FB58
		dd offset loc_1001FB50
		dd offset loc_1001FB48
		dd offset loc_1001FB40
		dd offset loc_1001FB38
; ---------------------------------------------------------------------------

loc_1001FB38:				; CODE XREF: sub_1001FA10:loc_1001FA94j
					; DATA XREF: sub_1001FA10:off_1001FB18o
		mov	eax, [esi+ecx*4-1Ch] ; jumptable 1001FA94 case 7
		mov	[edi+ecx*4-1Ch], eax

loc_1001FB40:				; CODE XREF: sub_1001FA10:loc_1001FA94j
					; DATA XREF: sub_1001FA10:off_1001FB18o
		mov	eax, [esi+ecx*4-18h] ; jumptable 1001FA94 case 6
		mov	[edi+ecx*4-18h], eax

loc_1001FB48:				; CODE XREF: sub_1001FA10:loc_1001FA94j
					; DATA XREF: sub_1001FA10:off_1001FB18o
		mov	eax, [esi+ecx*4-14h] ; jumptable 1001FA94 case 5
		mov	[edi+ecx*4-14h], eax

loc_1001FB50:				; CODE XREF: sub_1001FA10:loc_1001FA94j
					; DATA XREF: sub_1001FA10:off_1001FB18o
		mov	eax, [esi+ecx*4-10h] ; jumptable 1001FA94 case 4
		mov	[edi+ecx*4-10h], eax

loc_1001FB58:				; CODE XREF: sub_1001FA10:loc_1001FA94j
					; DATA XREF: sub_1001FA10:off_1001FB18o
		mov	eax, [esi+ecx*4-0Ch] ; jumptable 1001FA94 case 3
		mov	[edi+ecx*4-0Ch], eax

loc_1001FB60:				; CODE XREF: sub_1001FA10:loc_1001FA94j
					; DATA XREF: sub_1001FA10:off_1001FB18o
		mov	eax, [esi+ecx*4-8] ; jumptable 1001FA94	case 2
		mov	[edi+ecx*4-8], eax

loc_1001FB68:				; CODE XREF: sub_1001FA10:loc_1001FA94j
					; DATA XREF: sub_1001FA10:off_1001FB18o
		mov	eax, [esi+ecx*4-4] ; jumptable 1001FA94	case 1
		mov	[edi+ecx*4-4], eax
		lea	eax, ds:0[ecx*4]
		add	esi, eax
		add	edi, eax

loc_1001FB7B:				; CODE XREF: sub_1001FA10:loc_1001FA94j
					; DATA XREF: sub_1001FA10:off_1001FB18o
		jmp	ds:off_1001FB84[edx*4] ; jumptable 1001FA94 case 0
; ---------------------------------------------------------------------------
		align 4
off_1001FB84	dd offset loc_1001FB94	; DATA XREF: sub_1001FA10+5Cr
					; sub_1001FA10+BAr ...
		dd offset loc_1001FB9C
		dd offset loc_1001FBA8
		dd offset loc_1001FBBC
; ---------------------------------------------------------------------------

loc_1001FB94:				; CODE XREF: sub_1001FA10+5Cj
					; sub_1001FA10+BAj ...
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1001FB9C:				; CODE XREF: sub_1001FA10+5Cj
					; sub_1001FA10+BAj ...
		mov	al, [esi]
		mov	[edi], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1001FBA8:				; CODE XREF: sub_1001FA10+5Cj
					; sub_1001FA10+BAj ...
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1001FBBC:				; CODE XREF: sub_1001FA10+5Cj
					; sub_1001FA10+BAj ...
		mov	al, [esi]
		mov	[edi], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1001FBD4:				; CODE XREF: sub_1001FA10+1Aj
		lea	esi, [ecx+esi-4]
		lea	edi, [ecx+edi-4]
		test	edi, 3
		jnz	short loc_1001FC08
		shr	ecx, 2
		and	edx, 3
		cmp	ecx, 8
		jb	short loc_1001FBFC
		std
		rep movsd
		cld
		jmp	ds:off_1001FD20[edx*4] ; jumptable 1001FC20 case 0
; ---------------------------------------------------------------------------
		align 4

loc_1001FBFC:				; CODE XREF: sub_1001FA10+1DDj
					; sub_1001FA10+238j ...
		neg	ecx
		jmp	ds:off_1001FCD0[ecx*4]
; ---------------------------------------------------------------------------
		align 4

loc_1001FC08:				; CODE XREF: sub_1001FA10+1D2j
		mov	eax, edi
		mov	edx, 3
		cmp	ecx, 4		; switch 4 cases
		jb	short loc_1001FC20
		and	eax, 3		; jumptable 1001FC20 default case
		sub	ecx, eax
		jmp	dword ptr ds:(loc_1001FC20+4)[eax*4]
; ---------------------------------------------------------------------------

loc_1001FC20:				; CODE XREF: sub_1001FA10+202j
					; DATA XREF: sub_1001FA10+209r
		jmp	ds:off_1001FD20[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 4
		dd offset loc_1001FC34
		dd offset loc_1001FC58
		dd offset loc_1001FC80
; ---------------------------------------------------------------------------

loc_1001FC34:				; DATA XREF: sub_1001FA10+218o
		mov	al, [esi+3]
		and	edx, ecx
		mov	[edi+3], al
		sub	esi, 1
		shr	ecx, 2
		sub	edi, 1
		cmp	ecx, 8
		jb	short loc_1001FBFC
		std
		rep movsd
		cld
		jmp	ds:off_1001FD20[edx*4] ; jumptable 1001FC20 case 0
; ---------------------------------------------------------------------------
		align 4

loc_1001FC58:				; DATA XREF: sub_1001FA10+21Co
		mov	al, [esi+3]
		and	edx, ecx
		mov	[edi+3], al
		mov	al, [esi+2]
		shr	ecx, 2
		mov	[edi+2], al
		sub	esi, 2
		sub	edi, 2
		cmp	ecx, 8
		jb	short loc_1001FBFC
		std
		rep movsd
		cld
		jmp	ds:off_1001FD20[edx*4] ; jumptable 1001FC20 case 0
; ---------------------------------------------------------------------------
		align 10h

loc_1001FC80:				; DATA XREF: sub_1001FA10+220o
		mov	al, [esi+3]
		and	edx, ecx
		mov	[edi+3], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	al, [esi+1]
		shr	ecx, 2
		mov	[edi+1], al
		sub	esi, 3
		sub	edi, 3
		cmp	ecx, 8
		jb	loc_1001FBFC
		std
		rep movsd
		cld
		jmp	ds:off_1001FD20[edx*4] ; jumptable 1001FC20 case 0
; ---------------------------------------------------------------------------
		align 4
		dd offset loc_1001FCD4
		dd offset loc_1001FCDC
		dd offset loc_1001FCE4
		dd offset loc_1001FCEC
		dd offset loc_1001FCF4
		dd offset loc_1001FCFC
		dd offset loc_1001FD04
off_1001FCD0	dd offset loc_1001FD17	; DATA XREF: sub_1001FA10+1EEr
; ---------------------------------------------------------------------------

loc_1001FCD4:				; DATA XREF: sub_1001FA10+2A4o
		mov	eax, [esi+ecx*4+1Ch]
		mov	[edi+ecx*4+1Ch], eax

loc_1001FCDC:				; DATA XREF: sub_1001FA10+2A8o
		mov	eax, [esi+ecx*4+18h]
		mov	[edi+ecx*4+18h], eax

loc_1001FCE4:				; DATA XREF: sub_1001FA10+2ACo
		mov	eax, [esi+ecx*4+14h]
		mov	[edi+ecx*4+14h], eax

loc_1001FCEC:				; DATA XREF: sub_1001FA10+2B0o
		mov	eax, [esi+ecx*4+10h]
		mov	[edi+ecx*4+10h], eax

loc_1001FCF4:				; DATA XREF: sub_1001FA10+2B4o
		mov	eax, [esi+ecx*4+0Ch]
		mov	[edi+ecx*4+0Ch], eax

loc_1001FCFC:				; DATA XREF: sub_1001FA10+2B8o
		mov	eax, [esi+ecx*4+8]
		mov	[edi+ecx*4+8], eax

loc_1001FD04:				; DATA XREF: sub_1001FA10+2BCo
		mov	eax, [esi+ecx*4+4]
		mov	[edi+ecx*4+4], eax
		lea	eax, ds:0[ecx*4]
		add	esi, eax
		add	edi, eax

loc_1001FD17:				; CODE XREF: sub_1001FA10+1EEj
					; DATA XREF: sub_1001FA10:off_1001FCD0o
		jmp	ds:off_1001FD20[edx*4] ; jumptable 1001FC20 case 0
; ---------------------------------------------------------------------------
		align 10h
off_1001FD20	dd offset loc_1001FD30	; DATA XREF: sub_1001FA10+1E3r
					; sub_1001FA10:loc_1001FC20r ...
					; jump table for switch	statement
		dd offset loc_1001FD38	; jumptable 1001FC20 case 1
		dd offset loc_1001FD48	; jumptable 1001FC20 case 2
		dd offset loc_1001FD5C	; jumptable 1001FC20 case 3
; ---------------------------------------------------------------------------

loc_1001FD30:				; CODE XREF: sub_1001FA10+1E3j
					; sub_1001FA10:loc_1001FC20j ...
		mov	eax, [ebp+arg_0] ; jumptable 1001FC20 case 0
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1001FD38:				; CODE XREF: sub_1001FA10+1E3j
					; sub_1001FA10:loc_1001FC20j ...
		mov	al, [esi+3]	; jumptable 1001FC20 case 1
		mov	[edi+3], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1001FD48:				; CODE XREF: sub_1001FA10+1E3j
					; sub_1001FA10:loc_1001FC20j ...
		mov	al, [esi+3]	; jumptable 1001FC20 case 2
		mov	[edi+3], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

loc_1001FD5C:				; CODE XREF: sub_1001FA10+1E3j
					; sub_1001FA10:loc_1001FC20j ...
		mov	al, [esi+3]	; jumptable 1001FC20 case 3
		mov	[edi+3], al
		mov	al, [esi+2]
		mov	[edi+2], al
		mov	al, [esi+1]
		mov	[edi+1], al
		mov	eax, [ebp+arg_0]
		pop	esi
		pop	edi
		leave
		retn
sub_1001FA10	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_1001FD75	proc near		; CODE XREF: .text:loc_1001FDBCj
					; sub_1001FDE9:loc_1001FDF3p
					; DATA XREF: ...

ms_exc		= CPPEH_RECORD ptr -18h

		push	8
		push	offset stru_1002B790
		call	__SEH_prolog4
		call	sub_10013828
		mov	eax, [eax+78h]
		test	eax, eax
		jz	short loc_1001FDA3
		and	[ebp+ms_exc.registration.TryLevel], 0
		call	eax
		jmp	short loc_1001FD9C
; ---------------------------------------------------------------------------

loc_1001FD95:				; DATA XREF: .rdata:stru_1002B790o
		xor	eax, eax	; Exception filter 0 for function 1001FD75
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001FD99:				; DATA XREF: .rdata:stru_1002B790o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1001FD75

loc_1001FD9C:				; CODE XREF: sub_1001FD75+1Ej
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1001FDA3:				; CODE XREF: sub_1001FD75+16j
		call	sub_100242C7
sub_1001FD75	endp

; ---------------------------------------------------------------------------
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------
		call	sub_10013828
		mov	eax, [eax+7Ch]
		test	eax, eax
		jz	short loc_1001FDBC
		call	eax

loc_1001FDBC:				; CODE XREF: .text:1001FDB8j
		jmp	sub_1001FD75
; ---------------------------------------------------------------------------
		push	8
		push	offset dword_1002B7B0
		call	__SEH_prolog4
		push	dword_1002EF64
		call	sub_100135C4
		pop	ecx
		test	eax, eax
		jz	short loc_1001FDF3
		and	dword ptr [ebp-4], 0
		call	eax
		jmp	short loc_1001FDEC

; =============== S U B	R O U T	I N E =======================================


sub_1001FDE5	proc near		; DATA XREF: .rdata:1002B7C4o
		xor	eax, eax
		inc	eax
		retn
sub_1001FDE5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

sub_1001FDE9	proc near		; DATA XREF: .rdata:1002B7C8o
		mov	esp, [ebp-18h]

loc_1001FDEC:				; CODE XREF: .text:1001FDE3j
		mov	dword ptr [ebp-4], 0FFFFFFFEh

loc_1001FDF3:				; CODE XREF: .text:1001FDDBj
		call	sub_1001FD75
sub_1001FDE9	endp

; ---------------------------------------------------------------------------
		db 0CCh

; =============== S U B	R O U T	I N E =======================================


sub_1001FDF9	proc near		; CODE XREF: sub_1001679B+29p
		push	offset sub_1001FD75
		call	sub_10013548
		pop	ecx
		mov	dword_1002EF64,	eax
		retn
sub_1001FDF9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001FE0A	proc near		; CODE XREF: sub_1001679B+1Dp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	dword_1002EF68,	eax
		mov	dword_1002EF6C,	eax
		mov	dword_1002EF70,	eax
		mov	dword_1002EF74,	eax
		pop	ebp
		retn
sub_1001FE0A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001FE28	proc near		; DATA XREF: .text:1002002Bo

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	10h
		push	offset stru_1002B7D0
		call	__SEH_prolog4
		xor	edi, edi
		push	edi
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		cmp	[ebp+arg_0], edi
		jnz	short loc_1001FE61
		mov	esi, offset dword_1002EF68
		push	dword_1002EF68
		call	sub_100135C4
		mov	[ebp+var_1C], eax
		mov	[ebp+var_20], 2
		jmp	short loc_1001FE7B
; ---------------------------------------------------------------------------

loc_1001FE61:				; CODE XREF: sub_1001FE28+1Bj
		mov	esi, offset dword_1002EF6C
		push	dword_1002EF6C
		call	sub_100135C4
		mov	[ebp+var_1C], eax
		mov	[ebp+var_20], 15h

loc_1001FE7B:				; CODE XREF: sub_1001FE28+37j
		pop	ecx
		cmp	eax, edi
		jz	short loc_1001FE8C
		cmp	eax, 1
		jz	short loc_1001FE8C
		call	sub_100135BB
		mov	[esi], eax

loc_1001FE8C:				; CODE XREF: sub_1001FE28+56j
					; sub_1001FE28+5Bj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1001FEA3
; ---------------------------------------------------------------------------

loc_1001FE98:				; CODE XREF: sub_1001FE28+82j
		cmp	[ebp+var_1C], edi
		jnz	short loc_1001FEAB
		xor	eax, eax
		jmp	short loc_1001FEBB
; ---------------------------------------------------------------------------

loc_1001FEA1:				; DATA XREF: .rdata:stru_1002B7D0o
		xor	edi, edi	; Finally handler 0 for	function 1001FE28

loc_1001FEA3:				; CODE XREF: sub_1001FE28+6Bj
		push	edi
		call	sub_100151D0
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001FEAB:				; CODE XREF: sub_1001FE28+73j
		cmp	[ebp+var_1C], 1
		jz	short loc_1001FEB8
		push	[ebp+var_20]
		call	[ebp+var_1C]
		pop	ecx

loc_1001FEB8:				; CODE XREF: sub_1001FE28+87j
		xor	eax, eax
		inc	eax

loc_1001FEBB:				; CODE XREF: sub_1001FE28+77j
		call	__SEH_epilog4
		retn	4
sub_1001FE28	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001FEC3	proc near		; CODE XREF: .text:1001FFC8p
					; sub_10020156+5Ap

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ecx, dword_1002DFA4
		push	esi

loc_1001FED2:				; CODE XREF: sub_1001FEC3+21j
		cmp	[eax+4], edx
		jz	short loc_1001FEE6
		mov	esi, ecx
		imul	esi, 0Ch
		add	esi, [ebp+arg_0]
		add	eax, 0Ch
		cmp	eax, esi
		jb	short loc_1001FED2

loc_1001FEE6:				; CODE XREF: sub_1001FEC3+12j
		imul	ecx, 0Ch
		add	ecx, [ebp+arg_0]
		pop	esi
		cmp	eax, ecx
		jnb	short loc_1001FEF6
		cmp	[eax+4], edx
		jz	short loc_1001FEF8

loc_1001FEF6:				; CODE XREF: sub_1001FEC3+2Cj
		xor	eax, eax

loc_1001FEF8:				; CODE XREF: sub_1001FEC3+31j
		pop	ebp
		retn
sub_1001FEC3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001FEFA	proc near		; CODE XREF: sub_100242C7:loc_100242EEp
		push	dword_1002EF70
		call	sub_100135C4
		pop	ecx
		retn
sub_1001FEFA	endp

; ---------------------------------------------------------------------------
		call	sub_10013828
		add	eax, 64h
		retn
; ---------------------------------------------------------------------------
		call	sub_10013828
		add	eax, 60h
		retn
; ---------------------------------------------------------------------------
		push	10h
		push	offset dword_1002B7F0
		call	__SEH_prolog4
		and	dword ptr [ebp-20h], 0
		mov	esi, [ebp+0Ch]
		mov	ebx, [ebp+8]
		cmp	esi, 4
		jz	loc_1002011A
		cmp	esi, 3
		jz	loc_1002011A
		push	2
		pop	edi
		cmp	ebx, edi
		jz	loc_1002000B
		cmp	ebx, 15h
		jz	loc_1002000B
		cmp	ebx, 16h
		jz	loc_1002000B
		cmp	ebx, 6
		jz	loc_1002000B
		cmp	ebx, 0Fh
		jz	loc_1002000B
		cmp	ebx, 8
		jz	short loc_1001FF83
		cmp	ebx, 4
		jz	short loc_1001FF83
		cmp	ebx, 0Bh
		jnz	loc_1002011A

loc_1001FF83:				; CODE XREF: .text:1001FF73j
					; .text:1001FF78j
		call	sub_100137AC
		mov	esi, eax
		test	esi, esi
		jz	loc_1002011A
		mov	edi, offset dword_1002DF20
		cmp	[esi+5Ch], edi
		jnz	short loc_1001FFC3
		push	dword_1002DFA0
		call	sub_1000F5A0
		pop	ecx
		mov	[esi+5Ch], eax
		test	eax, eax
		jz	loc_1002011A
		push	dword_1002DFA0
		push	edi
		push	eax
		call	sub_1000E2B0
		add	esp, 0Ch

loc_1001FFC3:				; CODE XREF: .text:1001FF9Aj
		push	dword ptr [esi+5Ch]
		mov	edx, ebx
		call	sub_1001FEC3
		pop	ecx
		test	eax, eax
		jz	loc_1002011A
		mov	edx, [eax+8]
		mov	ecx, [ebp+0Ch]
		cmp	ecx, 2
		jz	loc_1002010A
		jmp	short loc_10020001
; ---------------------------------------------------------------------------

loc_1001FFE7:				; CODE XREF: .text:10020004j
		mov	[eax+8], ecx
		add	eax, 0Ch
		mov	edi, dword_1002DFA4
		imul	edi, 0Ch
		add	edi, [esi+5Ch]
		cmp	eax, edi
		jnb	loc_1002010A

loc_10020001:				; CODE XREF: .text:1001FFE5j
		cmp	[eax+4], ebx
		jz	short loc_1001FFE7
		jmp	loc_1002010A
; ---------------------------------------------------------------------------

loc_1002000B:				; CODE XREF: .text:1001FF46j
					; .text:1001FF4Fj ...
		push	0
		call	sub_100152C7
		pop	ecx
		and	dword ptr [ebp-4], 0
		cmp	ebx, edi
		jz	short loc_10020020
		cmp	ebx, 15h
		jnz	short loc_1002005E

loc_10020020:				; CODE XREF: .text:10020019j
		cmp	dword_1002EF78,	0
		jnz	short loc_1002005E
		push	1
		push	offset sub_1001FE28
		call	ds:SetConsoleCtrlHandler
		xor	ecx, ecx
		inc	ecx
		cmp	eax, ecx
		jnz	short loc_10020045
		mov	dword_1002EF78,	ecx
		jmp	short loc_1002005E
; ---------------------------------------------------------------------------

loc_10020045:				; CODE XREF: .text:1002003Bj
		call	sub_10014C05
		mov	esi, eax
		call	ds:GetLastError
		mov	[esi], eax
		mov	dword ptr [ebp-20h], 1
		mov	esi, [ebp+0Ch]

loc_1002005E:				; CODE XREF: .text:1002001Ej
					; .text:10020027j ...
		mov	eax, ebx
		sub	eax, edi
		jz	short loc_100200D6
		sub	eax, 4
		jz	short loc_10020076
		sub	eax, 9
		jz	short loc_100200B6
		sub	eax, 6
		jz	short loc_10020096
		dec	eax
		jnz	short loc_100200F5

loc_10020076:				; CODE XREF: .text:10020067j
		push	dword_1002EF70
		call	sub_100135C4
		pop	ecx
		mov	[ebp-1Ch], eax
		cmp	esi, edi
		jz	short loc_100200F5
		push	esi
		call	sub_10013548
		mov	dword_1002EF70,	eax
		jmp	short loc_100200F4
; ---------------------------------------------------------------------------

loc_10020096:				; CODE XREF: .text:10020071j
		push	dword_1002EF6C
		call	sub_100135C4
		pop	ecx
		mov	[ebp-1Ch], eax
		cmp	esi, edi
		jz	short loc_100200F5
		push	esi
		call	sub_10013548
		mov	dword_1002EF6C,	eax
		jmp	short loc_100200F4
; ---------------------------------------------------------------------------

loc_100200B6:				; CODE XREF: .text:1002006Cj
		push	dword_1002EF74
		call	sub_100135C4
		pop	ecx
		mov	[ebp-1Ch], eax
		cmp	esi, edi
		jz	short loc_100200F5
		push	esi
		call	sub_10013548
		mov	dword_1002EF74,	eax
		jmp	short loc_100200F4
; ---------------------------------------------------------------------------

loc_100200D6:				; CODE XREF: .text:10020062j
		push	dword_1002EF68
		call	sub_100135C4
		pop	ecx
		mov	[ebp-1Ch], eax
		cmp	esi, edi
		jz	short loc_100200F5
		push	esi
		call	sub_10013548
		mov	dword_1002EF68,	eax

loc_100200F4:				; CODE XREF: .text:10020094j
					; .text:100200B4j ...
		pop	ecx

loc_100200F5:				; CODE XREF: .text:10020074j
					; .text:10020087j ...
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10020111
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_1002011A
		mov	edx, [ebp-1Ch]

loc_1002010A:				; CODE XREF: .text:1001FFDFj
					; .text:1001FFFBj ...
		mov	eax, edx
		jmp	short loc_10020150

; =============== S U B	R O U T	I N E =======================================


sub_1002010E	proc near		; DATA XREF: .rdata:1002B808o
		mov	ebx, [ebp+8]
sub_1002010E	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_10020111	proc near		; CODE XREF: .text:100200FCp
		push	0
		call	sub_100151D0
		pop	ecx
		retn
sub_10020111	endp

; ---------------------------------------------------------------------------

loc_1002011A:				; CODE XREF: .text:1001FF32j
					; .text:1001FF3Bj ...
		cmp	ebx, 1
		jz	short loc_1002014D
		cmp	ebx, 3
		jz	short loc_1002014D
		cmp	ebx, 0Dh
		jz	short loc_1002014D
		cmp	ebx, 0Fh
		jle	short loc_10020133
		cmp	ebx, 11h
		jle	short loc_1002014D

loc_10020133:				; CODE XREF: .text:1002012Cj
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014B5B
		add	esp, 14h

loc_1002014D:				; CODE XREF: .text:1002011Dj
					; .text:10020122j ...
		or	eax, 0FFFFFFFFh

loc_10020150:				; CODE XREF: .text:1002010Cj
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020156	proc near		; CODE XREF: sub_100242C7+32p

var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

; FUNCTION CHUNK AT 100202D9 SIZE 0000002D BYTES

		push	20h
		push	offset stru_1002B810
		call	__SEH_prolog4
		xor	edi, edi
		mov	[ebp+var_1C], edi
		mov	[ebp+var_28], edi
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 0Bh
		jg	short loc_100201BE
		jz	short loc_10020189
		mov	eax, ebx
		push	2
		pop	ecx
		sub	eax, ecx
		jz	short loc_1002019F
		sub	eax, ecx
		jz	short loc_10020189
		sub	eax, ecx
		jz	short loc_100201E9
		sub	eax, ecx
		jnz	short loc_100201CD

loc_10020189:				; CODE XREF: sub_10020156+1Cj
					; sub_10020156+29j
		call	sub_100137AC
		mov	edi, eax
		mov	[ebp+var_28], edi
		test	edi, edi
		jnz	short loc_100201AB

loc_10020197:				; CODE XREF: sub_10020156+91j
		or	eax, 0FFFFFFFFh
		jmp	loc_10020300
; ---------------------------------------------------------------------------

loc_1002019F:				; CODE XREF: sub_10020156+25j
		mov	esi, offset dword_1002EF68
		mov	eax, dword_1002EF68
		jmp	short loc_1002020B
; ---------------------------------------------------------------------------

loc_100201AB:				; CODE XREF: sub_10020156+3Fj
		push	dword ptr [edi+5Ch]
		mov	edx, ebx
		call	sub_1001FEC3
		mov	esi, eax
		add	esi, 8
		mov	eax, [esi]
		jmp	short loc_10020218
; ---------------------------------------------------------------------------

loc_100201BE:				; CODE XREF: sub_10020156+1Aj
		mov	eax, ebx
		sub	eax, 0Fh
		jz	short loc_10020201
		sub	eax, 6
		jz	short loc_100201F5
		dec	eax
		jz	short loc_100201E9

loc_100201CD:				; CODE XREF: sub_10020156+31j
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10020197
; ---------------------------------------------------------------------------

loc_100201E9:				; CODE XREF: sub_10020156+2Dj
					; sub_10020156+75j
		mov	esi, offset dword_1002EF70
		mov	eax, dword_1002EF70
		jmp	short loc_1002020B
; ---------------------------------------------------------------------------

loc_100201F5:				; CODE XREF: sub_10020156+72j
		mov	esi, offset dword_1002EF6C
		mov	eax, dword_1002EF6C
		jmp	short loc_1002020B
; ---------------------------------------------------------------------------

loc_10020201:				; CODE XREF: sub_10020156+6Dj
		mov	esi, offset dword_1002EF74
		mov	eax, dword_1002EF74

loc_1002020B:				; CODE XREF: sub_10020156+53j
					; sub_10020156+9Dj ...
		mov	[ebp+var_1C], 1
		push	eax
		call	sub_100135C4

loc_10020218:				; CODE XREF: sub_10020156+66j
		mov	[ebp+var_20], eax
		pop	ecx
		xor	eax, eax
		cmp	[ebp+var_20], 1
		jz	loc_10020300
		cmp	[ebp+var_20], eax
		jnz	short loc_10020234
		push	3		; uExitCode
		call	sub_10016767

loc_10020234:				; CODE XREF: sub_10020156+D5j
		cmp	[ebp+var_1C], eax
		jz	short loc_10020240
		push	eax
		call	sub_100152C7
		pop	ecx

loc_10020240:				; CODE XREF: sub_10020156+E1j
		xor	eax, eax
		mov	[ebp+ms_exc.registration.TryLevel], eax
		cmp	ebx, 8
		jz	short loc_10020254
		cmp	ebx, 0Bh
		jz	short loc_10020254
		cmp	ebx, 4
		jnz	short loc_1002026F

loc_10020254:				; CODE XREF: sub_10020156+F2j
					; sub_10020156+F7j
		mov	ecx, [edi+60h]
		mov	[ebp+var_2C], ecx
		mov	[edi+60h], eax
		cmp	ebx, 8
		jnz	short loc_100202A2
		mov	ecx, [edi+64h]
		mov	[ebp+var_30], ecx
		mov	dword ptr [edi+64h], 8Ch

loc_1002026F:				; CODE XREF: sub_10020156+FCj
		cmp	ebx, 8
		jnz	short loc_100202A2
		mov	ecx, dword_1002DF98
		mov	[ebp+var_24], ecx

loc_1002027D:				; CODE XREF: sub_10020156+14Aj
		mov	ecx, dword_1002DF9C
		mov	edx, dword_1002DF98
		add	ecx, edx
		cmp	[ebp+var_24], ecx
		jge	short loc_100202A9
		mov	ecx, [ebp+var_24]
		imul	ecx, 0Ch
		mov	edx, [edi+5Ch]
		mov	[ecx+edx+8], eax
		inc	[ebp+var_24]
		jmp	short loc_1002027D
; ---------------------------------------------------------------------------

loc_100202A2:				; CODE XREF: sub_10020156+10Aj
					; sub_10020156+11Cj
		call	sub_100135BB
		mov	[esi], eax

loc_100202A9:				; CODE XREF: sub_10020156+138j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_100202CA
; ---------------------------------------------------------------------------

loc_100202B5:				; CODE XREF: sub_10020156:loc_100202D8j
		cmp	ebx, 8
		jnz	short loc_100202D9
		push	dword ptr [edi+64h]
		push	ebx
		call	[ebp+var_20]
		pop	ecx
		jmp	short loc_100202DD
; ---------------------------------------------------------------------------

loc_100202C4:				; DATA XREF: .rdata:stru_1002B810o
		mov	ebx, [ebp+arg_0] ; Finally handler 0 for function 10020156
		mov	edi, [ebp+var_28]

loc_100202CA:				; CODE XREF: sub_10020156+15Aj
		cmp	[ebp+var_1C], 0
		jz	short loc_100202D8
		push	0
		call	sub_100151D0
		pop	ecx

loc_100202D8:				; CODE XREF: sub_10020156+178j
		retn
sub_10020156	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10020156

loc_100202D9:				; CODE XREF: sub_10020156+162j
		push	ebx
		call	[ebp+var_20]

loc_100202DD:				; CODE XREF: sub_10020156+16Cj
		pop	ecx
		cmp	ebx, 8
		jz	short loc_100202ED
		cmp	ebx, 0Bh
		jz	short loc_100202ED
		cmp	ebx, 4
		jnz	short loc_100202FE

loc_100202ED:				; CODE XREF: sub_10020156+18Bj
					; sub_10020156+190j
		mov	eax, [ebp+var_2C]
		mov	[edi+60h], eax
		cmp	ebx, 8
		jnz	short loc_100202FE
		mov	eax, [ebp+var_30]
		mov	[edi+64h], eax

loc_100202FE:				; CODE XREF: sub_10020156+195j
					; sub_10020156+1A0j
		xor	eax, eax

loc_10020300:				; CODE XREF: sub_10020156+44j
					; sub_10020156+CCj
		call	__SEH_epilog4
		retn
; END OF FUNCTION CHUNK	FOR sub_10020156

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020306	proc near		; CODE XREF: sub_100167DD+140p

lpProcName	= dword	ptr -30h
var_20		= byte ptr -20h
var_18		= byte ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		push	ebx
		push	esi
		push	edi
		call	sub_100135BB
		xor	ebx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_4], ebx
		mov	[ebp+var_8], ebx
		mov	[ebp+var_C], ebx
		cmp	dword_1002EF7C,	ebx
		jnz	loc_100203DF
		push	ebx		; dwFlags
		push	ebx		; hFile
		push	offset aUser32_dll ; "USER32.DLL"
		call	ds:LoadLibraryExA
		mov	edi, eax
		cmp	edi, ebx
		jnz	short loc_1002034A

loc_10020343:				; CODE XREF: sub_10020306+54j
		xor	eax, eax
		jmp	loc_100204A3
; ---------------------------------------------------------------------------

loc_1002034A:				; CODE XREF: sub_10020306+3Bj
		mov	esi, ds:GetProcAddress
		push	offset aMessageboxa ; "MessageBoxA"
		push	edi		; hModule
		call	esi ; GetProcAddress
		cmp	eax, ebx
		jz	short loc_10020343
		push	eax
		call	sub_10013548
		mov	[esp+30h+lpProcName], offset aGetactivewindo ; "GetActiveWindow"
		push	edi		; hModule
		mov	dword_1002EF7C,	eax
		call	esi ; GetProcAddress
		push	eax
		call	sub_10013548
		mov	[esp+30h+lpProcName], offset aGetlastactivep ; "GetLastActivePopup"
		push	edi		; hModule
		mov	dword_1002EF80,	eax
		call	esi ; GetProcAddress
		push	eax
		call	sub_10013548
		mov	dword_1002EF84,	eax
		lea	eax, [ebp+var_8]
		push	eax
		call	sub_1001653D
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_100203AD
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_100203AD:				; CODE XREF: sub_10020306+98j
		cmp	[ebp+var_8], 2
		jnz	short loc_100203DF
		push	offset aGetuserobjecti ; "GetUserObjectInformationA"
		push	edi		; hModule
		call	esi ; GetProcAddress
		push	eax
		call	sub_10013548
		pop	ecx
		mov	dword_1002EF8C,	eax
		cmp	eax, ebx
		jz	short loc_100203DF
		push	offset aGetprocesswind ; "GetProcessWindowStation"
		push	edi		; hModule
		call	esi ; GetProcAddress
		push	eax
		call	sub_10013548
		pop	ecx
		mov	dword_1002EF88,	eax

loc_100203DF:				; CODE XREF: sub_10020306+24j
					; sub_10020306+ABj ...
		mov	eax, dword_1002EF88
		mov	esi, [ebp+var_10]
		cmp	eax, esi
		jz	short loc_10020458
		cmp	dword_1002EF8C,	esi
		jz	short loc_10020458
		push	eax
		call	sub_100135C4
		pop	ecx
		call	eax
		cmp	eax, ebx
		jz	short loc_10020425
		lea	ecx, [ebp+var_14]
		push	ecx
		push	0Ch
		lea	ecx, [ebp+var_20]
		push	ecx
		push	1
		push	eax
		push	dword_1002EF8C
		call	sub_100135C4
		pop	ecx
		call	eax
		test	eax, eax
		jz	short loc_10020425
		test	[ebp+var_18], 1
		jnz	short loc_10020458

loc_10020425:				; CODE XREF: sub_10020306+F8j
					; sub_10020306+117j
		lea	eax, [ebp+var_C]
		push	eax
		call	sub_100165BA
		pop	ecx
		test	eax, eax
		jz	short loc_10020440
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10020440:				; CODE XREF: sub_10020306+12Bj
		cmp	[ebp+var_C], 4
		jb	short loc_1002044F
		or	[ebp+arg_8], 200000h
		jmp	short loc_10020489
; ---------------------------------------------------------------------------

loc_1002044F:				; CODE XREF: sub_10020306+13Ej
		or	[ebp+arg_8], 40000h
		jmp	short loc_10020489
; ---------------------------------------------------------------------------

loc_10020458:				; CODE XREF: sub_10020306+E3j
					; sub_10020306+EBj ...
		mov	eax, dword_1002EF80
		cmp	eax, esi
		jz	short loc_10020489
		push	eax
		call	sub_100135C4
		pop	ecx
		call	eax
		mov	[ebp+var_4], eax
		cmp	eax, ebx
		jz	short loc_10020489
		mov	eax, dword_1002EF84
		cmp	eax, esi
		jz	short loc_10020489
		push	[ebp+var_4]
		push	eax
		call	sub_100135C4
		pop	ecx
		call	eax
		mov	[ebp+var_4], eax

loc_10020489:				; CODE XREF: sub_10020306+147j
					; sub_10020306+150j ...
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	[ebp+var_4]
		push	dword_1002EF7C
		call	sub_100135C4
		pop	ecx
		call	eax

loc_100204A3:				; CODE XREF: sub_10020306+3Fj
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_10020306	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100204A8	proc near		; CODE XREF: sub_100167DD+31p
					; sub_100167DD+42p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		push	esi
		xor	esi, esi
		cmp	ecx, esi
		jl	short loc_100204D5
		cmp	ecx, 2
		jle	short loc_100204C8
		cmp	ecx, 3
		jnz	short loc_100204D5
		mov	eax, dword_1002E5F8
		jmp	short loc_100204F0
; ---------------------------------------------------------------------------

loc_100204C8:				; CODE XREF: sub_100204A8+12j
		mov	eax, dword_1002E5F8
		mov	dword_1002E5F8,	ecx
		jmp	short loc_100204F0
; ---------------------------------------------------------------------------

loc_100204D5:				; CODE XREF: sub_100204A8+Dj
					; sub_100204A8+17j
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh

loc_100204F0:				; CODE XREF: sub_100204A8+1Ej
					; sub_100204A8+2Bj
		pop	esi
		pop	ebp
		retn
sub_100204A8	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+8]
		call	sub_10024460
		pop	ecx
		mov	dword_1002E5FC,	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	eax, dword_1002E5FC
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002050E	proc near		; CODE XREF: sub_1002052C+6Ep
					; sub_1002052C+82p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		jmp	short loc_1002051F
; ---------------------------------------------------------------------------

loc_10020518:				; CODE XREF: sub_1002050E+13j
		dec	ecx
		cmp	byte ptr [eax],	0
		jz	short loc_10020524
		inc	eax

loc_1002051F:				; CODE XREF: sub_1002050E+8j
		test	ecx, ecx
		jnz	short loc_10020518
		dec	ecx

loc_10020524:				; CODE XREF: sub_1002050E+Ej
		mov	eax, [ebp+arg_0]
		sub	eax, ecx
		dec	eax
		pop	ebp
		retn
sub_1002050E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002052C	proc near		; CODE XREF: sub_1002089C+2Bp

cchCount1	= dword	ptr -2Ch
var_28		= dword	ptr -28h
lpMultiByteStr	= dword	ptr -24h
lpWideCharStr	= dword	ptr -20h
lpString2	= dword	ptr -1Ch
CPInfo		= _cpinfo ptr -18h
var_4		= dword	ptr -4
Locale		= dword	ptr  8
dwCmpFlags	= dword	ptr  0Ch
cbMultiByte	= dword	ptr  10h
arg_C		= dword	ptr  14h
cchCount2	= dword	ptr  18h
CodePage	= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_C]
		push	ebx
		push	esi
		push	edi
		xor	edi, edi
		mov	ebx, edx
		mov	esi, ecx
		mov	[ebp+lpMultiByteStr], ebx
		mov	[ebp+lpString2], eax
		cmp	dword_1002EF90,	edi
		jnz	short loc_10020590
		push	1		; cchCount2
		mov	eax, offset SrcStr
		push	eax		; lpString2
		push	1		; cchCount1
		push	eax		; lpString1
		push	edi		; dwCmpFlags
		push	edi		; Locale
		call	ds:CompareStringW
		test	eax, eax
		jz	short loc_1002057B
		mov	dword_1002EF90,	1
		jmp	short loc_10020590
; ---------------------------------------------------------------------------

loc_1002057B:				; CODE XREF: sub_1002052C+41j
		call	ds:GetLastError
		cmp	eax, 78h
		jnz	short loc_10020590
		mov	dword_1002EF90,	2

loc_10020590:				; CODE XREF: sub_1002052C+2Aj
					; sub_1002052C+4Dj ...
		cmp	[ebp+cbMultiByte], edi
		jle	short loc_100205BB
		push	[ebp+cbMultiByte]
		mov	eax, ebx
		call	sub_1002050E
		pop	ecx
		mov	[ebp+cbMultiByte], eax

loc_100205A3:				; CODE XREF: sub_1002052C+93j
		mov	edx, [ebp+cchCount2]
		cmp	edx, edi
		jle	short loc_100205C8
		mov	eax, [ebp+lpString2]
		push	edx
		call	sub_1002050E
		mov	edx, eax
		pop	ecx
		mov	[ebp+cchCount2], edx
		jmp	short loc_100205CD
; ---------------------------------------------------------------------------

loc_100205BB:				; CODE XREF: sub_1002052C+67j
		cmp	[ebp+cbMultiByte], 0FFFFFFFFh
		jge	short loc_100205A3

loc_100205C1:				; CODE XREF: sub_1002052C+9Fj
					; sub_1002052C+BDj ...
		xor	eax, eax
		jmp	loc_1002088A
; ---------------------------------------------------------------------------

loc_100205C8:				; CODE XREF: sub_1002052C+7Cj
		cmp	edx, 0FFFFFFFFh
		jl	short loc_100205C1

loc_100205CD:				; CODE XREF: sub_1002052C+8Dj
		mov	ecx, dword_1002EF90
		cmp	ecx, 2
		jz	loc_100207D5
		cmp	ecx, edi
		jz	loc_100207D5
		xor	eax, eax
		inc	eax
		cmp	ecx, eax
		jnz	short loc_100205C1
		mov	[ebp+var_28], edi
		cmp	[ebp+CodePage],	edi
		jnz	short loc_100205FB
		mov	ecx, [esi]
		mov	ecx, [ecx+4]
		mov	[ebp+CodePage],	ecx

loc_100205FB:				; CODE XREF: sub_1002052C+C5j
		cmp	[ebp+cbMultiByte], edi
		jz	short loc_10020608
		cmp	edx, edi
		jnz	loc_100206A2

loc_10020608:				; CODE XREF: sub_1002052C+D2j
		cmp	[ebp+cbMultiByte], edx
		jnz	short loc_10020615

loc_1002060D:				; CODE XREF: sub_1002052C+12Ej
					; sub_1002052C+167j
		push	2

loc_1002060F:				; CODE XREF: sub_1002052C+F8j
		pop	eax
		jmp	loc_1002088A
; ---------------------------------------------------------------------------

loc_10020615:				; CODE XREF: sub_1002052C+DFj
		cmp	edx, eax
		jg	loc_1002088A
		cmp	[ebp+cbMultiByte], eax
		jle	short loc_10020626

loc_10020622:				; CODE XREF: sub_1002052C+114j
					; sub_1002052C+11Dj ...
		push	3
		jmp	short loc_1002060F
; ---------------------------------------------------------------------------

loc_10020626:				; CODE XREF: sub_1002052C+F4j
		lea	eax, [ebp+CPInfo]
		push	eax		; lpCPInfo
		push	[ebp+CodePage]	; CodePage
		call	ds:GetCPInfo
		test	eax, eax
		jz	short loc_100205C1
		cmp	[ebp+cbMultiByte], edi
		jle	short loc_10020665
		cmp	[ebp+CPInfo.MaxCharSize], 2
		jb	short loc_10020622
		cmp	[ebp+CPInfo.LeadByte], 0
		lea	eax, [ebp+CPInfo.LeadByte]
		jz	short loc_10020622

loc_1002064B:				; CODE XREF: sub_1002052C+135j
		mov	dl, [eax+1]
		test	dl, dl
		jz	short loc_10020622
		mov	cl, [ebx]
		cmp	cl, [eax]
		jb	short loc_1002065C
		cmp	cl, dl
		jbe	short loc_1002060D

loc_1002065C:				; CODE XREF: sub_1002052C+12Aj
		inc	eax
		inc	eax
		cmp	byte ptr [eax],	0
		jnz	short loc_1002064B
		jmp	short loc_10020622
; ---------------------------------------------------------------------------

loc_10020665:				; CODE XREF: sub_1002052C+10Ej
		cmp	[ebp+cchCount2], edi
		jle	short loc_100206A2
		cmp	[ebp+CPInfo.MaxCharSize], 2
		jnb	short loc_10020678

loc_10020670:				; CODE XREF: sub_1002052C+153j
					; sub_1002052C+15Aj ...
		xor	eax, eax
		inc	eax
		jmp	loc_1002088A
; ---------------------------------------------------------------------------

loc_10020678:				; CODE XREF: sub_1002052C+142j
		cmp	[ebp+CPInfo.LeadByte], 0
		lea	eax, [ebp+CPInfo.LeadByte]
		jz	short loc_10020670

loc_10020681:				; CODE XREF: sub_1002052C+172j
		mov	dl, [eax+1]
		test	dl, dl
		jz	short loc_10020670
		mov	ecx, [ebp+lpString2]
		mov	cl, [ecx]
		cmp	cl, [eax]
		jb	short loc_10020699
		cmp	cl, dl
		jbe	loc_1002060D

loc_10020699:				; CODE XREF: sub_1002052C+163j
		inc	eax
		inc	eax
		cmp	byte ptr [eax],	0
		jnz	short loc_10020681
		jmp	short loc_10020670
; ---------------------------------------------------------------------------

loc_100206A2:				; CODE XREF: sub_1002052C+D6j
					; sub_1002052C+13Cj
		mov	esi, ds:MultiByteToWideChar
		push	edi		; cchWideChar
		push	edi		; lpWideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	ebx		; lpMultiByteStr
		push	9		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	esi ; MultiByteToWideChar
		mov	ebx, eax
		mov	[ebp+cchCount1], ebx
		cmp	ebx, edi
		jz	loc_100205C1
		mov	edi, 400h
		test	ebx, ebx
		jle	short loc_1002070B
		push	0FFFFFFE0h
		xor	edx, edx
		pop	eax
		div	ebx
		cmp	eax, 2
		jb	short loc_1002070B
		lea	eax, [ebx+ebx+8]
		cmp	eax, edi
		ja	short loc_100206F2
		call	__alloca_probe_16
		mov	eax, esp
		test	eax, eax
		jz	short loc_10020706
		mov	dword ptr [eax], 0CCCCh
		jmp	short loc_10020703
; ---------------------------------------------------------------------------

loc_100206F2:				; CODE XREF: sub_1002052C+1B1j
		push	eax
		call	sub_1000F5A0
		pop	ecx
		test	eax, eax
		jz	short loc_10020706
		mov	dword ptr [eax], 0DDDDh

loc_10020703:				; CODE XREF: sub_1002052C+1C4j
		add	eax, 8

loc_10020706:				; CODE XREF: sub_1002052C+1BCj
					; sub_1002052C+1CFj
		mov	[ebp+lpWideCharStr], eax
		jmp	short loc_1002070F
; ---------------------------------------------------------------------------

loc_1002070B:				; CODE XREF: sub_1002052C+19Dj
					; sub_1002052C+1A9j
		and	[ebp+lpWideCharStr], 0

loc_1002070F:				; CODE XREF: sub_1002052C+1DDj
		cmp	[ebp+lpWideCharStr], 0
		jz	loc_100205C1
		push	ebx		; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	esi ; MultiByteToWideChar
		test	eax, eax
		jz	loc_100207C4
		push	0		; cchWideChar
		push	0		; lpWideCharStr
		push	[ebp+cchCount2]	; cbMultiByte
		push	[ebp+lpString2]	; lpMultiByteStr
		push	9		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	esi ; MultiByteToWideChar
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_100207C4
		jle	short loc_1002078D
		push	0FFFFFFE0h
		xor	edx, edx
		pop	eax
		div	ebx
		cmp	eax, 2
		jb	short loc_1002078D
		lea	eax, [ebx+ebx+8]
		cmp	eax, edi
		ja	short loc_10020775
		call	__alloca_probe_16
		mov	edi, esp
		test	edi, edi
		jz	short loc_100207C4
		mov	dword ptr [edi], 0CCCCh
		add	edi, 8
		jmp	short loc_1002078F
; ---------------------------------------------------------------------------

loc_10020775:				; CODE XREF: sub_1002052C+231j
		push	eax
		call	sub_1000F5A0
		pop	ecx
		test	eax, eax
		jz	short loc_10020789
		mov	dword ptr [eax], 0DDDDh
		add	eax, 8

loc_10020789:				; CODE XREF: sub_1002052C+252j
		mov	edi, eax
		jmp	short loc_1002078F
; ---------------------------------------------------------------------------

loc_1002078D:				; CODE XREF: sub_1002052C+21Dj
					; sub_1002052C+229j
		xor	edi, edi

loc_1002078F:				; CODE XREF: sub_1002052C+247j
					; sub_1002052C+25Fj
		test	edi, edi
		jz	short loc_100207C4
		push	ebx		; cchWideChar
		push	edi		; lpWideCharStr
		push	[ebp+cchCount2]	; cbMultiByte
		push	[ebp+lpString2]	; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	esi ; MultiByteToWideChar
		test	eax, eax
		jz	short loc_100207BD
		push	ebx		; cchCount2
		push	edi		; lpString2
		push	[ebp+cchCount1]	; cchCount1
		push	[ebp+lpWideCharStr] ; lpString1
		push	[ebp+dwCmpFlags] ; dwCmpFlags
		push	[ebp+Locale]	; Locale
		call	ds:CompareStringW
		mov	[ebp+var_28], eax

loc_100207BD:				; CODE XREF: sub_1002052C+278j
		push	edi
		call	sub_10010392
		pop	ecx

loc_100207C4:				; CODE XREF: sub_1002052C+200j
					; sub_1002052C+21Bj ...
		push	[ebp+lpWideCharStr]
		call	sub_10010392
		mov	eax, [ebp+var_28]
		pop	ecx
		jmp	loc_1002088A
; ---------------------------------------------------------------------------

loc_100207D5:				; CODE XREF: sub_1002052C+AAj
					; sub_1002052C+B2j
		xor	edi, edi
		xor	ebx, ebx
		cmp	[ebp+Locale], edi
		jnz	short loc_100207E6
		mov	eax, [esi]
		mov	eax, [eax+14h]
		mov	[ebp+Locale], eax

loc_100207E6:				; CODE XREF: sub_1002052C+2B0j
		cmp	[ebp+CodePage],	edi
		jnz	short loc_100207F3
		mov	eax, [esi]
		mov	eax, [eax+4]
		mov	[ebp+CodePage],	eax

loc_100207F3:				; CODE XREF: sub_1002052C+2BDj
		push	[ebp+Locale]	; Locale
		call	sub_10021420
		mov	esi, eax
		pop	ecx
		cmp	esi, 0FFFFFFFFh
		jz	loc_100205C1
		cmp	esi, [ebp+CodePage]
		jz	short loc_1002085C
		push	0		; int
		push	0		; int
		lea	eax, [ebp+cbMultiByte]
		push	eax		; int
		push	[ebp+lpMultiByteStr] ; int
		push	esi		; UINT
		push	[ebp+CodePage]	; CodePage
		call	sub_10021469
		mov	ebx, eax
		add	esp, 18h
		test	ebx, ebx
		jz	loc_100205C1
		push	0		; int
		push	0		; int
		lea	eax, [ebp+cchCount2]
		push	eax		; int
		push	[ebp+lpString2]	; int
		push	esi		; UINT
		push	[ebp+CodePage]	; CodePage
		call	sub_10021469
		mov	edi, eax
		add	esp, 18h
		test	edi, edi
		jnz	short loc_10020856
		push	ebx		; lpMem
		call	sub_1000EE73
		pop	ecx
		jmp	loc_100205C1
; ---------------------------------------------------------------------------

loc_10020856:				; CODE XREF: sub_1002052C+31Cj
		mov	[ebp+lpMultiByteStr], ebx
		mov	[ebp+lpString2], edi

loc_1002085C:				; CODE XREF: sub_1002052C+2DEj
		push	[ebp+cchCount2]	; cchCount2
		push	[ebp+lpString2]	; lpString2
		push	[ebp+cbMultiByte] ; cchCount1
		push	[ebp+lpMultiByteStr] ; lpString1
		push	[ebp+dwCmpFlags] ; dwCmpFlags
		push	[ebp+Locale]	; Locale
		call	ds:CompareStringA
		mov	esi, eax
		test	ebx, ebx
		jz	short loc_10020888
		push	ebx		; lpMem
		call	sub_1000EE73
		push	edi		; lpMem
		call	sub_1000EE73
		pop	ecx
		pop	ecx

loc_10020888:				; CODE XREF: sub_1002052C+34Cj
		mov	eax, esi

loc_1002088A:				; CODE XREF: sub_1002052C+97j
					; sub_1002052C+E4j ...
		lea	esp, [ebp-38h]
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_1002052C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002089C	proc near		; CODE XREF: sub_100169C1+BFp
					; sub_100208DE+C0p

var_10		= byte ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		push	[ebp+arg_1C]
		mov	edx, [ebp+arg_C]
		push	[ebp+arg_18]
		lea	ecx, [ebp+var_10]
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	sub_1002052C
		add	esp, 18h
		cmp	[ebp+var_4], 0
		jz	short locret_100208DC
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_100208DC:			; CODE XREF: sub_1002089C+37j
		leave
		retn
sub_1002089C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100208DE	proc near		; CODE XREF: sub_100169C1+9Ep
					; .text:100209F7p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	[ebp+arg_C]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	edx, [ebp+arg_8]
		xor	ebx, ebx
		cmp	edx, ebx
		jnz	short loc_1002090E
		cmp	[ebp+var_4], bl
		jz	short loc_10020907
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10020907:				; CODE XREF: sub_100208DE+20j
		xor	eax, eax
		jmp	loc_100209D5
; ---------------------------------------------------------------------------

loc_1002090E:				; CODE XREF: sub_100208DE+1Bj
		cmp	[ebp+arg_0], ebx
		jnz	short loc_10020941

loc_10020913:				; CODE XREF: sub_100208DE+66j
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10020937
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10020937:				; CODE XREF: sub_100208DE+50j
		mov	eax, 7FFFFFFFh
		jmp	loc_100209D5
; ---------------------------------------------------------------------------

loc_10020941:				; CODE XREF: sub_100208DE+33j
		cmp	[ebp+arg_4], ebx
		jz	short loc_10020913
		push	esi
		mov	esi, 7FFFFFFFh
		cmp	edx, esi
		jbe	short loc_1002096A
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_100209B5
; ---------------------------------------------------------------------------

loc_1002096A:				; CODE XREF: sub_100208DE+70j
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+10h]
		cmp	ecx, ebx
		jnz	short loc_10020989
		lea	eax, [ebp+var_10]
		push	eax
		push	edx
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10023ED5
		add	esp, 10h
		jmp	short loc_100209C8
; ---------------------------------------------------------------------------

loc_10020989:				; CODE XREF: sub_100208DE+94j
		push	dword ptr [eax+8]
		lea	eax, [ebp+var_10]
		push	edx
		push	[ebp+arg_4]
		push	edx
		push	[ebp+arg_0]
		push	1001h
		push	ecx
		push	eax
		call	sub_1002089C
		add	esp, 20h
		cmp	eax, ebx
		jnz	short loc_100209C5
		call	sub_10014BF2
		mov	dword ptr [eax], 16h

loc_100209B5:				; CODE XREF: sub_100208DE+8Aj
		cmp	[ebp+var_4], bl
		jz	short loc_100209C1
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_100209C1:				; CODE XREF: sub_100208DE+DAj
		mov	eax, esi
		jmp	short loc_100209D4
; ---------------------------------------------------------------------------

loc_100209C5:				; CODE XREF: sub_100208DE+CAj
		add	eax, 0FFFFFFFEh

loc_100209C8:				; CODE XREF: sub_100208DE+A9j
		cmp	[ebp+var_4], bl
		jz	short loc_100209D4
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

loc_100209D4:				; CODE XREF: sub_100208DE+E5j
					; sub_100208DE+EDj
		pop	esi

loc_100209D5:				; CODE XREF: sub_100208DE+2Bj
					; sub_100208DE+5Ej
		pop	ebx
		leave
		retn
sub_100208DE	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_100209EC
		pop	ebp
		jmp	sub_10023FC7
; ---------------------------------------------------------------------------

loc_100209EC:				; CODE XREF: .text:100209E4j
		push	0
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_100208DE
		add	esp, 10h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020A01	proc near		; CODE XREF: sub_10020AAD+EDp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, dword_1002EB00
		jmp	short loc_10020A30
; ---------------------------------------------------------------------------

loc_10020A0F:				; CODE XREF: sub_10020A01+33j
		push	edi
		push	eax
		push	[ebp+arg_0]
		call	sub_10016AAF
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10020A2D
		mov	eax, [esi]
		mov	al, [edi+eax]
		cmp	al, 3Dh
		jz	short loc_10020A46
		test	al, al
		jz	short loc_10020A46

loc_10020A2D:				; CODE XREF: sub_10020A01+1Dj
		add	esi, 4

loc_10020A30:				; CODE XREF: sub_10020A01+Cj
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_10020A0F
		mov	eax, esi
		sub	eax, dword_1002EB00
		sar	eax, 2
		neg	eax

loc_10020A43:				; CODE XREF: sub_10020A01+50j
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10020A46:				; CODE XREF: sub_10020A01+26j
					; sub_10020A01+2Aj
		mov	eax, esi
		sub	eax, dword_1002EB00
		sar	eax, 2
		jmp	short loc_10020A43
sub_10020A01	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020A53	proc near		; CODE XREF: sub_10020AAD+6Cp

var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	edi
		mov	edi, eax
		xor	eax, eax
		mov	ecx, edi
		test	edi, edi
		jz	short loc_10020AAA
		cmp	[edi], eax
		jz	short loc_10020A71

loc_10020A68:				; CODE XREF: sub_10020A53+1Cj
		add	ecx, 4
		inc	eax
		cmp	dword ptr [ecx], 0
		jnz	short loc_10020A68

loc_10020A71:				; CODE XREF: sub_10020A53+13j
		push	esi
		inc	eax
		push	4
		push	eax
		call	sub_1000F496
		mov	esi, eax
		pop	ecx
		pop	ecx
		mov	[ebp+var_4], esi
		test	esi, esi
		jnz	short loc_10020A9E
		push	9
		call	sub_100164A2
		jmp	short loc_10020A9D
; ---------------------------------------------------------------------------

loc_10020A8F:				; CODE XREF: sub_10020A53+4Fj
		push	eax
		call	sub_1002449A
		mov	[esi], eax
		add	esi, 4
		add	edi, 4

loc_10020A9D:				; CODE XREF: sub_10020A53+3Aj
		pop	ecx

loc_10020A9E:				; CODE XREF: sub_10020A53+31j
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_10020A8F
		and	[esi], eax
		mov	eax, [ebp+var_4]
		pop	esi

loc_10020AAA:				; CODE XREF: sub_10020A53+Fj
		pop	edi
		leave
		retn
sub_10020A53	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020AAD	proc near		; CODE XREF: sub_10016AC9+5Bp

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpMem		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		push	ebx
		xor	ebx, ebx
		mov	[ebp+var_C], ebx
		cmp	eax, ebx
		jnz	short loc_10020ADF
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_10020B4D
; ---------------------------------------------------------------------------

loc_10020ADF:				; CODE XREF: sub_10020AAD+13j
		push	esi
		mov	esi, [eax]
		push	edi
		mov	[ebp+lpMem], esi
		cmp	esi, ebx
		jz	short loc_10020B3D
		push	3Dh
		push	esi
		call	sub_100245C0
		mov	edi, eax
		pop	ecx
		pop	ecx
		mov	[ebp+var_14], edi
		cmp	edi, ebx
		jz	short loc_10020B3D
		cmp	esi, edi
		jz	short loc_10020B3D
		xor	eax, eax
		cmp	[edi+1], bl
		setz	al
		mov	[ebp+var_8], eax
		mov	eax, dword_1002EB00
		cmp	eax, dword_1002EB04
		jnz	short loc_10020B23
		call	sub_10020A53
		mov	dword_1002EB00,	eax

loc_10020B23:				; CODE XREF: sub_10020AAD+6Aj
		cmp	eax, ebx
		jnz	short loc_10020B87
		cmp	[ebp+arg_4], ebx
		jz	short loc_10020B50
		cmp	dword_1002EB08,	ebx
		jz	short loc_10020B50
		call	sub_10016AC9
		test	eax, eax
		jz	short loc_10020B87

loc_10020B3D:				; CODE XREF: sub_10020AAD+3Bj
					; sub_10020AAD+4Ej ...
		call	sub_10014BF2
		mov	dword ptr [eax], 16h

loc_10020B48:				; CODE XREF: sub_10020AAD+BBj
					; sub_10020AAD+D6j ...
		or	eax, 0FFFFFFFFh

loc_10020B4B:				; CODE XREF: sub_10020AAD+251j
					; sub_10020AAD+266j
		pop	edi
		pop	esi

loc_10020B4D:				; CODE XREF: sub_10020AAD+30j
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_10020B50:				; CODE XREF: sub_10020AAD+7Dj
					; sub_10020AAD+85j
		cmp	[ebp+var_8], ebx
		jnz	loc_10020D11
		push	4
		call	sub_1000F5A0
		pop	ecx
		mov	dword_1002EB00,	eax
		cmp	eax, ebx
		jz	short loc_10020B48
		mov	[eax], ebx
		cmp	dword_1002EB08,	ebx
		jnz	short loc_10020B87
		push	4
		call	sub_1000F5A0
		pop	ecx
		mov	dword_1002EB08,	eax
		cmp	eax, ebx
		jz	short loc_10020B48
		mov	[eax], ebx

loc_10020B87:				; CODE XREF: sub_10020AAD+78j
					; sub_10020AAD+8Ej ...
		mov	esi, dword_1002EB00
		mov	[ebp+var_10], esi
		cmp	esi, ebx
		jz	short loc_10020B48
		sub	edi, [ebp+lpMem]
		push	[ebp+lpMem]
		call	sub_10020A01
		mov	edi, eax
		cmp	edi, ebx
		pop	ecx
		jl	short loc_10020C09
		cmp	[esi], ebx
		jz	short loc_10020C09
		lea	esi, [esi+edi*4]
		mov	eax, [esi]
		cmp	eax, dword_1002EB04
		jb	short loc_10020BBF
		cmp	eax, dword_1002F194
		jbe	short loc_10020BC6

loc_10020BBF:				; CODE XREF: sub_10020AAD+108j
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10020BC6:				; CODE XREF: sub_10020AAD+110j
		cmp	[ebp+var_8], ebx
		jnz	short loc_10020BE6
		mov	eax, [ebp+lpMem]
		mov	[esi], eax
		mov	eax, [ebp+arg_0]
		mov	[eax], ebx
		jmp	loc_10020C5C
; ---------------------------------------------------------------------------

loc_10020BDA:				; CODE XREF: sub_10020AAD+13Bj
		mov	eax, [esi+4]
		mov	[esi], eax
		mov	eax, [ebp+var_10]
		inc	edi
		lea	esi, [eax+edi*4]

loc_10020BE6:				; CODE XREF: sub_10020AAD+11Cj
		cmp	[esi], ebx
		jnz	short loc_10020BDA
		cmp	edi, 3FFFFFFFh
		jnb	short loc_10020C5C
		push	4		; int
		push	edi		; int
		push	dword_1002EB00	; lpMem
		call	sub_1000F32F
		add	esp, 0Ch
		cmp	eax, ebx
		jz	short loc_10020C5C
		jmp	short loc_10020C57
; ---------------------------------------------------------------------------

loc_10020C09:				; CODE XREF: sub_10020AAD+F7j
					; sub_10020AAD+FBj
		cmp	[ebp+var_8], ebx
		jnz	loc_10020D03
		cmp	edi, ebx
		jge	short loc_10020C18
		neg	edi

loc_10020C18:				; CODE XREF: sub_10020AAD+167j
		lea	eax, [edi+2]
		cmp	eax, edi
		jl	loc_10020B48
		cmp	eax, 3FFFFFFFh
		jnb	loc_10020B48
		push	eax		; int
		push	4		; int
		push	dword_1002EB00	; lpMem
		call	sub_1000F32F
		add	esp, 0Ch
		cmp	eax, ebx
		jz	loc_10020B48
		mov	edx, [ebp+lpMem]
		lea	ecx, [eax+edi*4]
		mov	[ecx], edx
		mov	[ecx+4], ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx], ebx

loc_10020C57:				; CODE XREF: sub_10020AAD+15Aj
		mov	dword_1002EB00,	eax

loc_10020C5C:				; CODE XREF: sub_10020AAD+128j
					; sub_10020AAD+143j ...
		cmp	[ebp+arg_4], ebx
		jz	loc_10020CED
		mov	edi, [ebp+lpMem]
		mov	eax, edi
		lea	edx, [eax+1]

loc_10020C6D:				; CODE XREF: sub_10020AAD+1C5j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10020C6D
		sub	eax, edx
		add	eax, 2
		push	1
		push	eax
		call	sub_1000F496
		mov	esi, eax
		pop	ecx
		pop	ecx
		cmp	esi, ebx
		jz	short loc_10020CED
		mov	eax, edi
		lea	edx, [eax+1]

loc_10020C8E:				; CODE XREF: sub_10020AAD+1E6j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10020C8E
		sub	eax, edx
		push	edi
		add	eax, 2
		push	eax
		push	esi
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10020CB6
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10020CB6:				; CODE XREF: sub_10020AAD+1FAj
		mov	ecx, [ebp+var_8]
		mov	eax, esi
		sub	eax, edi
		add	eax, [ebp+var_14]
		mov	[eax], bl
		inc	eax
		neg	ecx
		sbb	ecx, ecx
		not	ecx
		and	ecx, eax
		push	ecx		; lpValue
		push	esi		; lpName
		call	ds:SetEnvironmentVariableA
		test	eax, eax
		jnz	short loc_10020CE6
		or	[ebp+var_C], 0FFFFFFFFh
		call	sub_10014BF2
		mov	dword ptr [eax], 2Ah

loc_10020CE6:				; CODE XREF: sub_10020AAD+228j
		push	esi		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10020CED:				; CODE XREF: sub_10020AAD+1B2j
					; sub_10020AAD+1DAj
		cmp	[ebp+var_8], ebx
		jz	short loc_10020CFB
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10020CFB:				; CODE XREF: sub_10020AAD+243j
		mov	eax, [ebp+var_C]
		jmp	loc_10020B4B
; ---------------------------------------------------------------------------

loc_10020D03:				; CODE XREF: sub_10020AAD+15Fj
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		mov	eax, [ebp+arg_0]
		pop	ecx
		mov	[eax], ebx

loc_10020D11:				; CODE XREF: sub_10020AAD+A6j
		xor	eax, eax
		jmp	loc_10020B4B
sub_10020AAD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020D18(int,	int, int, DWORD	dwMoveMethod)
sub_10020D18	proc near		; CODE XREF: sub_1001838C+E0p
					; sub_10020D9D+CDp ...

lDistanceToMove	= dword	ptr -8
DistanceToMoveHigh= dword ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
dwMoveMethod	= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_4]
		push	esi
		mov	esi, [ebp+arg_0]
		mov	[ebp+lDistanceToMove], eax
		mov	eax, [ebp+arg_8]
		push	edi
		push	esi
		mov	[ebp+DistanceToMoveHigh], eax
		call	sub_1002100C
		or	edi, 0FFFFFFFFh
		pop	ecx
		cmp	eax, edi
		jnz	short loc_10020D4F
		call	sub_10014BF2
		mov	dword ptr [eax], 9

loc_10020D49:				; CODE XREF: sub_10020D18+60j
		mov	eax, edi
		mov	edx, edi
		jmp	short loc_10020D99
; ---------------------------------------------------------------------------

loc_10020D4F:				; CODE XREF: sub_10020D18+24j
		push	[ebp+dwMoveMethod] ; dwMoveMethod
		lea	ecx, [ebp+DistanceToMoveHigh]
		push	ecx		; lpDistanceToMoveHigh
		push	[ebp+lDistanceToMove] ;	lDistanceToMove
		push	eax		; hFile
		call	ds:SetFilePointer
		mov	[ebp+lDistanceToMove], eax
		cmp	eax, edi
		jnz	short loc_10020D7A
		call	ds:GetLastError
		test	eax, eax
		jz	short loc_10020D7A
		push	eax
		call	sub_10014C18
		pop	ecx
		jmp	short loc_10020D49
; ---------------------------------------------------------------------------

loc_10020D7A:				; CODE XREF: sub_10020D18+4Dj
					; sub_10020D18+57j
		mov	eax, esi
		and	esi, 1Fh
		imul	esi, 24h
		sar	eax, 5
		mov	eax, dword_1002F080[eax*4]
		lea	eax, [eax+esi+4]
		and	byte ptr [eax],	0FDh
		mov	eax, [ebp+lDistanceToMove]
		mov	edx, [ebp+DistanceToMoveHigh]

loc_10020D99:				; CODE XREF: sub_10020D18+35j
		pop	edi
		pop	esi
		leave
		retn
sub_10020D18	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020D9D(int,	int, int, DWORD	dwMoveMethod)
sub_10020D9D	proc near		; CODE XREF: sub_10016BC8+105p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
dwMoveMethod	= dword	ptr  14h

		push	14h
		push	offset stru_1002B830
		call	__SEH_prolog4
		or	esi, 0FFFFFFFFh
		mov	[ebp+var_24], esi
		mov	[ebp+var_20], esi
		mov	eax, [ebp+arg_0]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10020DD6
		call	sub_10014C05
		and	dword ptr [eax], 0
		call	sub_10014BF2
		mov	dword ptr [eax], 9

loc_10020DCD:				; CODE XREF: sub_10020D9D+66j
		mov	eax, esi
		mov	edx, esi
		jmp	loc_10020EA6
; ---------------------------------------------------------------------------

loc_10020DD6:				; CODE XREF: sub_10020D9D+1Bj
		xor	edi, edi
		cmp	eax, edi
		jl	short loc_10020DE4
		cmp	eax, uNumber
		jb	short loc_10020E05

loc_10020DE4:				; CODE XREF: sub_10020D9D+3Dj
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10020DCD
; ---------------------------------------------------------------------------

loc_10020E05:				; CODE XREF: sub_10020D9D+45j
		mov	ecx, eax
		sar	ecx, 5
		lea	ebx, dword_1002F080[ecx*4]
		mov	esi, eax
		and	esi, 1Fh
		imul	esi, 24h
		mov	ecx, [ebx]
		movsx	ecx, byte ptr [ecx+esi+4]
		and	ecx, 1
		jnz	short loc_10020E4B
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		or	edx, 0FFFFFFFFh
		mov	eax, edx
		jmp	short loc_10020EA6
; ---------------------------------------------------------------------------

loc_10020E4B:				; CODE XREF: sub_10020D9D+86j
		push	eax
		call	sub_1002109E
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebx]
		test	byte ptr [eax+esi+4], 1
		jz	short loc_10020E7A
		push	[ebp+dwMoveMethod] ; dwMoveMethod
		push	[ebp+arg_8]	; int
		push	[ebp+arg_4]	; int
		push	[ebp+arg_0]	; int
		call	sub_10020D18
		add	esp, 10h
		mov	[ebp+var_24], eax
		mov	[ebp+var_20], edx
		jmp	short loc_10020E94
; ---------------------------------------------------------------------------

loc_10020E7A:				; CODE XREF: sub_10020D9D+BFj
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		call	sub_10014C05
		mov	[eax], edi
		or	[ebp+var_24], 0FFFFFFFFh
		or	[ebp+var_20], 0FFFFFFFFh

loc_10020E94:				; CODE XREF: sub_10020D9D+DBj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10020EAC	; Finally handler 0 for	function 10020D9D
; ---------------------------------------------------------------------------

loc_10020EA0:				; CODE XREF: sub_10020D9D+118j
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]

loc_10020EA6:				; CODE XREF: sub_10020D9D+34j
					; sub_10020D9D+ACj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10020EAC:				; CODE XREF: sub_10020D9D+FEj
					; DATA XREF: .rdata:stru_1002B830o
		push	[ebp+arg_0]	; Finally handler 0 for	function 10020D9D
		call	sub_1002113F
		pop	ecx
		retn
sub_10020D9D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020EB6	proc near		; CODE XREF: sub_10016BC8+8Fp
					; sub_100178B1+5Dp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		inc	dword_1002E5E4
		push	1000h
		push	1
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+8], eax
		test	eax, eax
		jz	short loc_10020EE6
		or	dword ptr [ecx+0Ch], 8
		mov	dword ptr [ecx+18h], 1000h
		jmp	short loc_10020EFA
; ---------------------------------------------------------------------------

loc_10020EE6:				; CODE XREF: sub_10020EB6+21j
		or	dword ptr [ecx+0Ch], 4
		lea	eax, [ecx+14h]
		and	dword ptr [eax], 0
		mov	[ecx+8], eax
		mov	dword ptr [ecx+18h], 2

loc_10020EFA:				; CODE XREF: sub_10020EB6+2Ej
		mov	eax, [ecx+8]
		and	dword ptr [ecx+4], 0
		mov	[ecx], eax
		pop	ebp
		retn
sub_10020EB6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020F05(int,	HANDLE hHandle)
sub_10020F05	proc near		; CODE XREF: .text:1002139Ap
					; sub_10021F64+2BCp

arg_0		= dword	ptr  8
hHandle		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	esi
		push	edi
		test	eax, eax
		jl	short loc_10020F6C
		cmp	eax, uNumber
		jnb	short loc_10020F6C
		mov	esi, eax
		and	esi, 1Fh
		imul	esi, 24h
		mov	ecx, eax
		sar	ecx, 5
		lea	edi, dword_1002F080[ecx*4]
		mov	ecx, [edi]
		cmp	dword ptr [esi+ecx], 0FFFFFFFFh
		jnz	short loc_10020F6C
		cmp	dword_1002E5FC,	1
		push	ebx
		mov	ebx, [ebp+hHandle]
		jnz	short loc_10020F62
		sub	eax, 0
		jz	short loc_10020F59
		dec	eax
		jz	short loc_10020F54
		dec	eax
		jnz	short loc_10020F62
		push	ebx
		push	0FFFFFFF4h
		jmp	short loc_10020F5C
; ---------------------------------------------------------------------------

loc_10020F54:				; CODE XREF: sub_10020F05+45j
		push	ebx
		push	0FFFFFFF5h
		jmp	short loc_10020F5C
; ---------------------------------------------------------------------------

loc_10020F59:				; CODE XREF: sub_10020F05+42j
		push	ebx		; hHandle
		push	0FFFFFFF6h	; nStdHandle

loc_10020F5C:				; CODE XREF: sub_10020F05+4Dj
					; sub_10020F05+52j
		call	ds:SetStdHandle

loc_10020F62:				; CODE XREF: sub_10020F05+3Dj
					; sub_10020F05+48j
		mov	eax, [edi]
		mov	[esi+eax], ebx
		xor	eax, eax
		pop	ebx
		jmp	short loc_10020F82
; ---------------------------------------------------------------------------

loc_10020F6C:				; CODE XREF: sub_10020F05+Cj
					; sub_10020F05+14j ...
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		call	sub_10014C05
		and	dword ptr [eax], 0
		or	eax, 0FFFFFFFFh

loc_10020F82:				; CODE XREF: sub_10020F05+65j
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_10020F05	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020F86	proc near		; CODE XREF: sub_10016EA6+66p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		push	ebx
		xor	ebx, ebx
		cmp	ecx, ebx
		push	esi
		push	edi
		jl	short loc_10020FF2
		cmp	ecx, uNumber
		jnb	short loc_10020FF2
		mov	esi, ecx
		and	esi, 1Fh
		imul	esi, 24h
		mov	eax, ecx
		sar	eax, 5
		lea	edi, dword_1002F080[eax*4]
		mov	eax, [edi]
		add	eax, esi
		test	byte ptr [eax+4], 1
		jz	short loc_10020FF2
		cmp	dword ptr [eax], 0FFFFFFFFh
		jz	short loc_10020FF2
		cmp	dword_1002E5FC,	1
		jnz	short loc_10020FE8
		sub	ecx, ebx
		jz	short loc_10020FDF
		dec	ecx
		jz	short loc_10020FDA
		dec	ecx
		jnz	short loc_10020FE8
		push	ebx
		push	0FFFFFFF4h
		jmp	short loc_10020FE2
; ---------------------------------------------------------------------------

loc_10020FDA:				; CODE XREF: sub_10020F86+4Aj
		push	ebx
		push	0FFFFFFF5h
		jmp	short loc_10020FE2
; ---------------------------------------------------------------------------

loc_10020FDF:				; CODE XREF: sub_10020F86+47j
		push	ebx		; hHandle
		push	0FFFFFFF6h	; nStdHandle

loc_10020FE2:				; CODE XREF: sub_10020F86+52j
					; sub_10020F86+57j
		call	ds:SetStdHandle

loc_10020FE8:				; CODE XREF: sub_10020F86+43j
					; sub_10020F86+4Dj
		mov	eax, [edi]
		or	dword ptr [esi+eax], 0FFFFFFFFh
		xor	eax, eax
		jmp	short loc_10021007
; ---------------------------------------------------------------------------

loc_10020FF2:				; CODE XREF: sub_10020F86+Fj
					; sub_10020F86+17j ...
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		call	sub_10014C05
		mov	[eax], ebx
		or	eax, 0FFFFFFFFh

loc_10021007:				; CODE XREF: sub_10020F86+6Aj
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10020F86	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002100C	proc near		; CODE XREF: sub_10016EA6+Bp
					; sub_10016EA6+33p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10021029

loc_10021019:				; CODE XREF: sub_1002100C+2Aj
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10021029:				; CODE XREF: sub_1002100C+Bj
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10021038
		call	sub_10014C05
		and	dword ptr [eax], 0
		jmp	short loc_10021019
; ---------------------------------------------------------------------------

loc_10021038:				; CODE XREF: sub_1002100C+20j
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jl	short loc_10021086
		cmp	eax, uNumber
		jnb	short loc_10021086
		mov	ecx, eax
		and	eax, 1Fh
		imul	eax, 24h
		sar	ecx, 5
		mov	ecx, dword_1002F080[ecx*4]
		add	eax, ecx
		test	byte ptr [eax+4], 1
		jnz	short loc_10021082
		call	sub_10014C05
		mov	[eax], esi
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 9
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10021098
; ---------------------------------------------------------------------------

loc_10021082:				; CODE XREF: sub_1002100C+53j
		mov	eax, [eax]
		jmp	short loc_1002109B
; ---------------------------------------------------------------------------

loc_10021086:				; CODE XREF: sub_1002100C+31j
					; sub_1002100C+39j
		call	sub_10014C05
		mov	[eax], esi
		call	sub_10014BF2
		mov	dword ptr [eax], 9

loc_10021098:				; CODE XREF: sub_1002100C+74j
		or	eax, 0FFFFFFFFh

loc_1002109B:				; CODE XREF: sub_1002100C+78j
		pop	esi
		pop	ebp
		retn
sub_1002100C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002109E	proc near		; CODE XREF: sub_10016F3F+BEp
					; sub_10018A68+7Fp ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002B850
		call	__SEH_prolog4
		mov	edi, [ebp+arg_0]
		mov	eax, edi
		sar	eax, 5
		mov	esi, edi
		and	esi, 1Fh
		imul	esi, 24h
		add	esi, dword_1002F080[eax*4]
		mov	[ebp+var_1C], 1
		test	byte ptr [esi+8], 4
		jnz	short loc_10021107
		push	0Ah
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		test	byte ptr [esi+8], 4
		jnz	short loc_100210FB
		push	0FA0h
		lea	eax, [esi+0Ch]
		push	eax
		call	sub_1001F928
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_100210F7
		and	[ebp+var_1C], eax

loc_100210F7:				; CODE XREF: sub_1002109E+54j
		or	dword ptr [esi+8], 4

loc_100210FB:				; CODE XREF: sub_1002109E+40j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10021136
; ---------------------------------------------------------------------------

loc_10021107:				; CODE XREF: sub_1002109E+2Ej
					; sub_1002109E+A0j
		cmp	[ebp+var_1C], 0
		jz	short loc_1002112A
		mov	eax, edi
		sar	eax, 5
		and	edi, 1Fh
		imul	edi, 24h
		mov	eax, dword_1002F080[eax*4]
		lea	eax, [eax+edi+0Ch]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection

loc_1002112A:				; CODE XREF: sub_1002109E+6Dj
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10021133:				; DATA XREF: .rdata:stru_1002B850o
		mov	edi, [ebp+arg_0] ; Finally handler 0 for function 1002109E

loc_10021136:				; CODE XREF: sub_1002109E+64j
		push	0Ah
		call	sub_100151D0
		pop	ecx
		retn
sub_1002109E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002113F	proc near		; CODE XREF: sub_10016F3F+105p
					; sub_10018A68+D5p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ecx, eax
		and	eax, 1Fh
		imul	eax, 24h
		sar	ecx, 5
		mov	ecx, dword_1002F080[ecx*4]
		lea	eax, [ecx+eax+0Ch]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	ebp
		retn
sub_1002113F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10021166	proc near		; CODE XREF: .text:loc_10021370p
					; sub_10021F64:loc_1002215Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

; FUNCTION CHUNK AT 10021243 SIZE 000000C7 BYTES

		push	18h
		push	offset stru_1002B870
		call	__SEH_prolog4
		or	[ebp+var_1C], 0FFFFFFFFh
		xor	edi, edi
		mov	[ebp+var_24], edi
		push	0Bh
		call	sub_10015204
		pop	ecx
		test	eax, eax
		jnz	short loc_1002118F
		or	eax, 0FFFFFFFFh
		jmp	loc_100212FB
; ---------------------------------------------------------------------------

loc_1002118F:				; CODE XREF: sub_10021166+1Fj
		push	0Bh
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi

loc_1002119A:				; CODE XREF: sub_10021166+10Aj
		mov	[ebp+var_28], edi
		cmp	edi, 40h
		jge	loc_100212EC
		mov	esi, dword_1002F080[edi*4]
		test	esi, esi
		jz	loc_10021275

loc_100211B5:				; CODE XREF: sub_10021166+CCj
		mov	[ebp+var_20], esi
		mov	eax, dword_1002F080[edi*4]
		add	eax, 480h
		cmp	esi, eax
		jnb	loc_10021269
		test	byte ptr [esi+4], 1
		jnz	short loc_1002122F
		test	byte ptr [esi+8], 4
		jnz	short loc_10021212
		push	0Ah
		call	sub_100152C7
		pop	ecx
		xor	ebx, ebx
		inc	ebx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		test	byte ptr [esi+8], 4
		jnz	short loc_10021209
		push	0FA0h
		lea	eax, [esi+0Ch]
		push	eax
		call	sub_1001F928
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10021205
		mov	[ebp+var_24], ebx
		jmp	short loc_10021209
; ---------------------------------------------------------------------------

loc_10021205:				; CODE XREF: sub_10021166+98j
		or	dword ptr [esi+8], 4

loc_10021209:				; CODE XREF: sub_10021166+84j
					; sub_10021166+9Dj
		and	[ebp+ms_exc.registration.TryLevel], 0
		call	loc_1002123A
; ---------------------------------------------------------------------------

loc_10021212:				; CODE XREF: sub_10021166+70j
					; sub_10021166+DCj
		cmp	[ebp+var_24], 0
		jnz	short loc_1002122F
		lea	ebx, [esi+0Ch]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		test	byte ptr [esi+4], 1
		jz	short loc_10021243
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1002122F:				; CODE XREF: sub_10021166+6Aj
					; sub_10021166+B0j ...
		add	esi, 24h
		jmp	short loc_100211B5
; ---------------------------------------------------------------------------

loc_10021234:				; DATA XREF: .rdata:stru_1002B870o
		mov	edi, [ebp+var_28] ; Finally handler 1 for function 10021166
		mov	esi, [ebp+var_20]

loc_1002123A:				; CODE XREF: sub_10021166+A7j
		push	0Ah
		call	sub_100151D0
		pop	ecx
		retn
sub_10021166	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10021166

loc_10021243:				; CODE XREF: sub_10021166+C0j
		cmp	[ebp+var_24], 0
		jnz	short loc_1002122F
		mov	byte ptr [esi+4], 1
		or	dword ptr [esi], 0FFFFFFFFh
		mov	eax, esi
		sub	eax, dword_1002F080[edi*4]
		cdq
		push	24h
		pop	ecx
		idiv	ecx
		mov	ecx, edi
		shl	ecx, 5
		add	eax, ecx
		mov	[ebp+var_1C], eax

loc_10021269:				; CODE XREF: sub_10021166+60j
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_100212EC
		inc	edi
		jmp	loc_1002119A
; ---------------------------------------------------------------------------

loc_10021275:				; CODE XREF: sub_10021166+49j
		push	24h
		push	20h
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[ebp+var_20], eax
		test	eax, eax
		jz	short loc_100212EC
		lea	ecx, dword_1002F080[edi*4]
		mov	[ecx], eax
		add	uNumber, 20h

loc_10021297:				; CODE XREF: sub_10021166+156j
		mov	edx, [ecx]
		add	edx, 480h
		cmp	eax, edx
		jnb	short loc_100212BE
		mov	byte ptr [eax+4], 0
		or	dword ptr [eax], 0FFFFFFFFh
		mov	byte ptr [eax+5], 0Ah
		and	dword ptr [eax+8], 0
		and	dword ptr [eax+8], 0
		add	eax, 24h
		mov	[ebp+var_20], eax
		jmp	short loc_10021297
; ---------------------------------------------------------------------------

loc_100212BE:				; CODE XREF: sub_10021166+13Bj
		shl	edi, 5
		mov	[ebp+var_1C], edi
		mov	eax, edi
		sar	eax, 5
		mov	ecx, edi
		and	ecx, 1Fh
		imul	ecx, 24h
		mov	eax, dword_1002F080[eax*4]
		mov	byte ptr [eax+ecx+4], 1
		push	edi
		call	sub_1002109E
		pop	ecx
		test	eax, eax
		jnz	short loc_100212EC
		or	[ebp+var_1C], 0FFFFFFFFh

loc_100212EC:				; CODE XREF: sub_10021166+3Aj
					; sub_10021166+107j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10021301	; Finally handler 0 for	function 10021166
; ---------------------------------------------------------------------------

loc_100212F8:				; CODE XREF: sub_10021166+1A3j
		mov	eax, [ebp+var_1C]

loc_100212FB:				; CODE XREF: sub_10021166+24j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10021301:				; CODE XREF: sub_10021166+18Dj
					; DATA XREF: .rdata:stru_1002B870o
		push	0Bh		; Finally handler 0 for	function 10021166
		call	sub_100151D0
		pop	ecx
		retn
; END OF FUNCTION CHUNK	FOR sub_10021166
; ---------------------------------------------------------------------------
		push	0Ch
		push	offset dword_1002B898
		call	__SEH_prolog4
		xor	edi, edi
		mov	[ebp-1Ch], edi
		xor	bl, bl
		test	byte ptr [ebp+0Ch], 8
		jz	short loc_10021326
		add	bl, 20h

loc_10021326:				; CODE XREF: .text:10021321j
		test	dword ptr [ebp+0Ch], 4000h
		jz	short loc_10021332
		or	bl, 80h

loc_10021332:				; CODE XREF: .text:1002132Dj
		test	byte ptr [ebp+0Ch], 80h
		jz	short loc_1002133B
		or	bl, 10h

loc_1002133B:				; CODE XREF: .text:10021336j
		push	dword ptr [ebp+8]
		call	ds:GetFileType
		cmp	eax, edi
		jnz	short loc_1002135E
		call	ds:GetLastError
		push	eax
		call	sub_10014C18
		pop	ecx

loc_10021355:				; CODE XREF: .text:10021391j
					; .text:100213E6j
		or	eax, 0FFFFFFFFh

loc_10021358:				; CODE XREF: .text:100213EEj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1002135E:				; CODE XREF: .text:10021346j
		cmp	eax, 2
		jnz	short loc_10021368
		or	bl, 40h
		jmp	short loc_10021370
; ---------------------------------------------------------------------------

loc_10021368:				; CODE XREF: .text:10021361j
		cmp	eax, 3
		jnz	short loc_10021370
		or	bl, 8

loc_10021370:				; CODE XREF: .text:10021366j
					; .text:1002136Bj
		call	sub_10021166
		mov	esi, eax
		mov	[ebp+0Ch], esi
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_10021393
		call	sub_10014BF2
		mov	dword ptr [eax], 18h
		call	sub_10014C05
		mov	[eax], edi
		jmp	short loc_10021355
; ---------------------------------------------------------------------------

loc_10021393:				; CODE XREF: .text:1002137Dj
		mov	[ebp-4], edi
		push	dword ptr [ebp+8]
		push	esi
		call	sub_10020F05
		pop	ecx
		pop	ecx
		or	bl, 1
		mov	eax, esi
		sar	eax, 5
		lea	ecx, dword_1002F080[eax*4]
		mov	eax, esi
		and	eax, 1Fh
		imul	eax, 24h
		mov	edx, [ecx]
		mov	[edx+eax+4], bl
		mov	edx, [ecx]
		lea	edx, [edx+eax+8]
		and	dword ptr [edx], 0FFFFFFFCh
		mov	ecx, [ecx]
		lea	eax, [ecx+eax+8]
		and	dword ptr [eax], 0FFFFFFF7h
		mov	dword ptr [ebp-1Ch], 1
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_100213F8
		cmp	[ebp-1Ch], edi
		jz	loc_10021355
		mov	eax, esi
		jmp	loc_10021358

; =============== S U B	R O U T	I N E =======================================


sub_100213F3	proc near		; DATA XREF: .rdata:1002B8B0o
		mov	esi, [ebp+0Ch]
		xor	edi, edi
sub_100213F3	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_100213F8	proc near		; CODE XREF: .text:100213DEp
		cmp	[ebp-1Ch], edi
		jnz	short loc_10021418
		mov	eax, esi
		sar	eax, 5
		mov	ecx, esi
		and	ecx, 1Fh
		imul	ecx, 24h
		mov	eax, dword_1002F080[eax*4]
		lea	eax, [eax+ecx+4]
		and	byte ptr [eax],	0FEh

loc_10021418:				; CODE XREF: sub_100213F8+3j
		push	esi
		call	sub_1002113F
		pop	ecx
		retn
sub_100213F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021420(LCID	Locale)
sub_10021420	proc near		; CODE XREF: sub_100170CC+320p
					; sub_10019BEB+152p ...

LCData		= byte ptr -0Ch
var_6		= byte ptr -6
var_4		= dword	ptr -4
Locale		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	6		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		push	1004h		; LCType
		push	[ebp+Locale]	; Locale
		mov	[ebp+var_6], 0
		call	ds:GetLocaleInfoA
		test	eax, eax
		jnz	short loc_10021453
		or	eax, 0FFFFFFFFh
		jmp	short loc_1002145D
; ---------------------------------------------------------------------------

loc_10021453:				; CODE XREF: sub_10021420+2Cj
		lea	eax, [ebp+LCData]
		push	eax
		call	sub_10011024
		pop	ecx

loc_1002145D:				; CODE XREF: sub_10021420+31j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10021420	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021469(UINT	CodePage, UINT,	int, int, int, int)
sub_10021469	proc near		; CODE XREF: sub_100170CC+34Bp
					; sub_100170CC+43Ep ...

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpMem		= dword	ptr -20h
lpWideCharStr	= dword	ptr -1Ch
CPInfo		= _cpinfo ptr -18h
var_4		= dword	ptr -4
CodePage	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		mov	ecx, [ebp+arg_10]
		mov	[ebp+lpMultiByteStr], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_30], eax
		mov	eax, [eax]
		push	ebx
		xor	ebx, ebx
		mov	[ebp+cbMultiByte], eax
		mov	eax, [ebp+CodePage]
		push	esi
		push	edi
		mov	[ebp+var_34], ecx
		mov	[ebp+lpMem], ebx
		mov	[ebp+var_2C], ebx
		cmp	eax, [ebp+arg_4]
		jz	loc_1002160E
		mov	esi, ds:GetCPInfo
		lea	ecx, [ebp+CPInfo]
		push	ecx		; lpCPInfo
		push	eax		; CodePage
		call	esi ; GetCPInfo
		mov	edi, ds:MultiByteToWideChar
		test	eax, eax
		jz	short loc_10021524
		cmp	[ebp+CPInfo.MaxCharSize], 1
		jnz	short loc_10021524
		lea	eax, [ebp+CPInfo]
		push	eax		; lpCPInfo
		push	[ebp+arg_4]	; CodePage
		call	esi ; GetCPInfo
		test	eax, eax
		jz	short loc_10021524
		cmp	[ebp+CPInfo.MaxCharSize], 1
		jnz	short loc_10021524
		mov	esi, [ebp+cbMultiByte]
		mov	[ebp+var_2C], 1
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_100214FA
		mov	eax, [ebp+lpMultiByteStr]
		lea	edx, [eax+1]

loc_100214EE:				; CODE XREF: sub_10021469+8Aj
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_100214EE
		sub	eax, edx
		lea	esi, [eax+1]

loc_100214FA:				; CODE XREF: sub_10021469+7Dj
		cmp	esi, ebx

loc_100214FC:				; CODE XREF: sub_10021469+CEj
		jle	short loc_10021559
		cmp	esi, 7FFFFFF0h
		ja	short loc_10021559
		lea	eax, [esi+esi+8]
		cmp	eax, 400h
		ja	short loc_10021540
		call	__alloca_probe_16
		mov	eax, esp
		cmp	eax, ebx
		jz	short loc_10021554
		mov	dword ptr [eax], 0CCCCh
		jmp	short loc_10021551
; ---------------------------------------------------------------------------

loc_10021524:				; CODE XREF: sub_10021469+55j
					; sub_10021469+5Bj ...
		push	ebx		; cchWideChar
		push	ebx		; lpWideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	edi ; MultiByteToWideChar
		mov	esi, eax
		cmp	esi, ebx
		jnz	short loc_100214FC

loc_10021539:				; CODE XREF: sub_10021469+F6j
		xor	eax, eax
		jmp	loc_10021611
; ---------------------------------------------------------------------------

loc_10021540:				; CODE XREF: sub_10021469+A6j
		push	eax
		call	sub_1000F5A0
		pop	ecx
		cmp	eax, ebx
		jz	short loc_10021554
		mov	dword ptr [eax], 0DDDDh

loc_10021551:				; CODE XREF: sub_10021469+B9j
		add	eax, 8

loc_10021554:				; CODE XREF: sub_10021469+B1j
					; sub_10021469+E0j
		mov	[ebp+lpWideCharStr], eax
		jmp	short loc_1002155C
; ---------------------------------------------------------------------------

loc_10021559:				; CODE XREF: sub_10021469:loc_100214FCj
					; sub_10021469+9Bj
		mov	[ebp+lpWideCharStr], ebx

loc_1002155C:				; CODE XREF: sub_10021469+EEj
		cmp	[ebp+lpWideCharStr], ebx
		jz	short loc_10021539
		lea	eax, [esi+esi]
		push	eax
		push	ebx
		push	[ebp+lpWideCharStr]
		call	sub_1000E0F0
		add	esp, 0Ch
		push	esi		; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	1		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	edi ; MultiByteToWideChar
		test	eax, eax
		jz	short loc_10021605
		mov	edi, [ebp+var_34]
		cmp	edi, ebx
		jz	short loc_100215AA
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	[ebp+arg_14]	; cbMultiByte
		push	edi		; lpMultiByteStr
		push	esi		; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		push	ebx		; dwFlags
		push	[ebp+arg_4]	; CodePage
		call	ds:WideCharToMultiByte
		test	eax, eax
		jz	short loc_10021605
		mov	[ebp+lpMem], edi
		jmp	short loc_10021605
; ---------------------------------------------------------------------------

loc_100215AA:				; CODE XREF: sub_10021469+122j
		mov	edi, ds:WideCharToMultiByte
		cmp	[ebp+var_2C], ebx
		jnz	short loc_100215C9
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	ebx		; cbMultiByte
		push	ebx		; lpMultiByteStr
		push	esi		; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		push	ebx		; dwFlags
		push	[ebp+arg_4]	; CodePage
		call	edi ; WideCharToMultiByte
		mov	esi, eax
		cmp	esi, ebx
		jz	short loc_10021605

loc_100215C9:				; CODE XREF: sub_10021469+14Aj
		push	esi
		push	1
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[ebp+lpMem], eax
		cmp	eax, ebx
		jz	short loc_10021605
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	esi		; cbMultiByte
		push	eax		; lpMultiByteStr
		push	esi		; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		push	ebx		; dwFlags
		push	[ebp+arg_4]	; CodePage
		call	edi ; WideCharToMultiByte
		cmp	eax, ebx
		jnz	short loc_100215FA
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx
		mov	[ebp+lpMem], ebx
		jmp	short loc_10021605
; ---------------------------------------------------------------------------

loc_100215FA:				; CODE XREF: sub_10021469+181j
		cmp	[ebp+cbMultiByte], 0FFFFFFFFh
		jz	short loc_10021605
		mov	ecx, [ebp+var_30]
		mov	[ecx], eax

loc_10021605:				; CODE XREF: sub_10021469+11Bj
					; sub_10021469+13Aj ...
		push	[ebp+lpWideCharStr]
		call	sub_10010392
		pop	ecx

loc_1002160E:				; CODE XREF: sub_10021469+3Aj
		mov	eax, [ebp+lpMem]

loc_10021611:				; CODE XREF: sub_10021469+D2j
		lea	esp, [ebp-40h]
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10021469	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10021623	proc near		; CODE XREF: sub_100170CC+139p
					; sub_100170CC+23Dp ...

SystemInfo	= _SYSTEM_INFO ptr -5Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-38h
flOldProtect	= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpAddress	= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
dwSize		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 5Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		lea	eax, [ebp+var_C]
		push	edi
		xor	esi, esi
		push	eax
		mov	[ebp+var_C], esi
		call	sub_1001653D
		pop	ecx
		test	eax, eax
		jz	short loc_10021658
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014AB5
		add	esp, 14h

loc_10021658:				; CODE XREF: sub_10021623+26j
		push	4
		pop	eax
		call	__alloca_probe
		mov	[ebp+lpAddress], esp
		push	1Ch		; dwLength
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	[ebp+lpAddress]	; lpAddress
		call	ds:VirtualQuery
		test	eax, eax
		jz	loc_10021774
		mov	eax, [ebp+Buffer.AllocationBase]
		mov	[ebp+var_18], eax
		lea	eax, [ebp+SystemInfo]
		push	eax		; lpSystemInfo
		call	ds:GetSystemInfo
		mov	edi, [ebp+var_C]
		mov	ebx, [ebp+SystemInfo.dwPageSize]
		dec	edi
		neg	edi
		sbb	edi, edi
		and	edi, 103h
		inc	edi
		cmp	[ebp+var_C], 2
		mov	[ebp+dwSize], esi
		jnz	short loc_100216ED
		mov	[ebp+var_10], esi
		mov	esi, ds:GetModuleHandleW
		push	offset aKernelbase_d_0 ; "kernelbase.dll"
		call	esi ; GetModuleHandleW
		test	eax, eax
		jnz	short loc_100216C4
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		call	esi ; GetModuleHandleW
		test	eax, eax
		jz	short loc_100216ED

loc_100216C4:				; CODE XREF: sub_10021623+94j
		push	offset aSetthreadstack ; "SetThreadStackGuarantee"
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_100216ED
		and	[ebp+var_10], 0
		lea	ecx, [ebp+var_10]
		push	ecx
		call	eax
		cmp	eax, 1
		jnz	short loc_100216ED
		mov	eax, [ebp+var_10]
		test	eax, eax
		jbe	short loc_100216ED
		mov	[ebp+dwSize], eax

loc_100216ED:				; CODE XREF: sub_10021623+80j
					; sub_10021623+9Fj ...
		lea	eax, [ebp+dwSize]
		push	eax
		lea	esi, [ebx-1]
		push	esi
		push	[ebp+dwSize]
		call	sub_1001970B
		add	esp, 0Ch
		test	eax, eax
		jl	short loc_10021774
		not	esi
		and	[ebp+dwSize], esi
		jz	short loc_1002171F
		lea	eax, [ebp+dwSize]
		push	eax
		push	ebx
		push	[ebp+dwSize]
		call	sub_1001970B
		add	esp, 0Ch
		test	eax, eax
		jl	short loc_10021774

loc_1002171F:				; CODE XREF: sub_10021623+E6j
		lea	eax, [ebx+ebx]
		cmp	[ebp+dwSize], eax
		jnb	short loc_1002172A
		mov	[ebp+dwSize], eax

loc_1002172A:				; CODE XREF: sub_10021623+102j
		lea	esi, [ebx-1]
		not	esi
		and	esi, [ebp+lpAddress]
		sub	esi, [ebp+dwSize]
		cmp	[ebp+var_C], 1
		jnz	short loc_1002173E
		push	11h
		pop	ebx

loc_1002173E:				; CODE XREF: sub_10021623+116j
		mov	eax, [ebp+var_18]
		add	ebx, eax
		cmp	esi, ebx
		jb	short loc_10021774
		push	4		; flProtect
		push	1000h		; flAllocationType
		push	[ebp+dwSize]	; dwSize
		push	esi		; lpAddress
		call	ds:VirtualAlloc
		test	eax, eax
		jz	short loc_10021774
		lea	eax, [ebp+flOldProtect]
		push	eax		; lpflOldProtect
		push	edi		; flNewProtect
		push	[ebp+dwSize]	; dwSize
		push	esi		; lpAddress
		call	ds:VirtualProtect
		test	eax, eax
		jz	short loc_10021774
		xor	eax, eax
		inc	eax
		jmp	short loc_10021776
; ---------------------------------------------------------------------------

loc_10021774:				; CODE XREF: sub_10021623+51j
					; sub_10021623+DFj ...
		xor	eax, eax

loc_10021776:				; CODE XREF: sub_10021623+14Fj
		lea	esp, [ebp-68h]
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10021623	endp

; [00000048 BYTES: COLLAPSED FUNCTION __SEH_prolog4_GS]
; [0000000F BYTES: COLLAPSED FUNCTION __SEH_epilog4_GS]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100217DF	proc near		; CODE XREF: .text:10017621p
					; .text:1001764Ep ...

var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
CharType	= word ptr -4
SrcStr		= word ptr  8
arg_4		= word ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, 0FFFFh
		sub	esp, 14h
		cmp	[ebp+SrcStr], ax
		jnz	short loc_100217F8
		and	dword ptr [ebp+CharType], 0
		jmp	short loc_1002185D
; ---------------------------------------------------------------------------

loc_100217F8:				; CODE XREF: sub_100217DF+11j
		mov	eax, 100h
		cmp	[ebp+SrcStr], ax
		jnb	short loc_1002181D
		movzx	eax, [ebp+SrcStr]
		mov	ecx, off_1002DFAC
		mov	ax, [ecx+eax*2]
		and	ax, [ebp+arg_4]
		movzx	eax, ax
		mov	dword ptr [ebp+CharType], eax
		jmp	short loc_1002185D
; ---------------------------------------------------------------------------

loc_1002181D:				; CODE XREF: sub_100217DF+22j
		push	[ebp+arg_8]
		lea	ecx, [ebp+var_14]
		call	sub_1000E615
		mov	eax, [ebp+var_14]
		push	dword ptr [eax+14h] ; Locale
		push	dword ptr [eax+4] ; CodePage
		lea	eax, [ebp+CharType]
		push	eax		; lpCharType
		push	1		; cchSrc
		lea	eax, [ebp+SrcStr]
		push	eax		; lpSrcStr
		lea	eax, [ebp+var_14]
		push	1		; dwInfoType
		push	eax		; int
		call	sub_10024800
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_10021850
		and	dword ptr [ebp+CharType], eax

loc_10021850:				; CODE XREF: sub_100217DF+6Cj
		cmp	[ebp+var_8], 0
		jz	short loc_1002185D
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1002185D:				; CODE XREF: sub_100217DF+17j
					; sub_100217DF+3Cj ...
		movzx	eax, [ebp+CharType]
		movzx	ecx, [ebp+arg_4]
		and	eax, ecx
		leave
		retn
sub_100217DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10021869	proc near		; CODE XREF: .text:10017638p
					; .text:10017662p ...

CharType	= word ptr -4
SrcStr		= word ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, 0FFFFh
		cmp	[ebp+SrcStr], ax
		jnz	short loc_1002187E
		xor	eax, eax
		leave
		retn
; ---------------------------------------------------------------------------

loc_1002187E:				; CODE XREF: sub_10021869+Fj
		mov	eax, 100h
		cmp	[ebp+SrcStr], ax
		jnb	short loc_1002189F
		movzx	eax, [ebp+SrcStr]
		mov	ecx, off_1002DFAC
		movzx	eax, word ptr [ecx+eax*2]
		movzx	ecx, word ptr [ebp+arg_4]
		and	eax, ecx
		leave
		retn
; ---------------------------------------------------------------------------

loc_1002189F:				; CODE XREF: sub_10021869+1Ej
		cmp	dword_1002E61C,	0
		jnz	short loc_100218CD
		push	Locale		; Locale
		lea	eax, [ebp+CharType]
		push	CodePage	; CodePage
		push	eax		; lpCharType
		push	1		; cchSrc
		lea	eax, [ebp+SrcStr]
		push	eax		; lpSrcStr
		push	1		; dwInfoType
		push	offset off_1002DB70 ; int
		call	sub_10024800
		add	esp, 1Ch

loc_100218CD:				; CODE XREF: sub_10021869+3Dj
		push	0
		push	[ebp+arg_4]
		push	dword ptr [ebp+SrcStr]
		call	sub_100217DF
		add	esp, 0Ch
		leave
		retn
sub_10021869	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100218DF(int,	LPWSTR lpWideCharStr, DWORD nNumberOfBytesToRead)
sub_100218DF	proc near		; CODE XREF: sub_10021E88+9Ap
					; sub_10021F64+368p ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
NumberOfBytesRead= dword ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
lpBuffer	= dword	ptr -0Ch
var_8		= word ptr -8
Buffer		= byte ptr -1
arg_0		= dword	ptr  8
lpWideCharStr	= dword	ptr  0Ch
nNumberOfBytesToRead= dword ptr	 10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	edx, [ebp+nNumberOfBytesToRead]
		push	esi
		mov	esi, [ebp+arg_0]
		push	0FFFFFFFEh
		pop	eax
		mov	[ebp+var_14], eax
		mov	[ebp+var_20], edx
		cmp	esi, eax
		jnz	short loc_10021916
		call	sub_10014C05
		and	dword ptr [eax], 0
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		or	eax, 0FFFFFFFFh
		jmp	loc_10021E85
; ---------------------------------------------------------------------------

loc_10021916:				; CODE XREF: sub_100218DF+1Aj
		push	edi
		xor	edi, edi
		cmp	esi, edi
		jl	short loc_10021925
		cmp	esi, uNumber
		jb	short loc_1002194C

loc_10021925:				; CODE XREF: sub_100218DF+3Cj
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		mov	dword ptr [eax], 9
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	loc_10021E84
; ---------------------------------------------------------------------------

loc_1002194C:				; CODE XREF: sub_100218DF+44j
		mov	eax, esi
		and	esi, 1Fh
		imul	esi, 24h
		sar	eax, 5
		push	ebx
		lea	ebx, dword_1002F080[eax*4]
		mov	eax, [ebx]
		add	eax, esi
		mov	cl, [eax+4]
		test	cl, 1
		jnz	short loc_10021982
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		jmp	loc_10021AC5
; ---------------------------------------------------------------------------

loc_10021982:				; CODE XREF: sub_100218DF+8Aj
		mov	[ebp+var_10], edi
		cmp	edx, edi
		jz	loc_10021E81
		test	cl, 2
		jnz	loc_10021E81
		mov	ecx, [ebp+lpWideCharStr]
		cmp	ecx, edi
		jz	loc_10021AB3
		mov	eax, [eax+8]
		and	eax, 3
		mov	[ebp+var_1C], eax
		dec	eax
		jz	loc_10021AAB
		dec	eax
		jnz	short loc_100219C6
		mov	eax, edx
		not	eax
		test	al, 1
		jz	loc_10021AB3
		and	edx, 0FFFFFFFEh
		mov	[ebp+nNumberOfBytesToRead], edx

loc_100219C6:				; CODE XREF: sub_100218DF+D3j
		mov	[ebp+lpBuffer],	ecx

loc_100219C9:				; CODE XREF: sub_100218DF+214j
		mov	ecx, [ebx]
		mov	eax, [ebp+lpBuffer]
		lea	edi, [esi+ecx]
		test	byte ptr [edi+4], 48h
		jz	short loc_10021A4D
		mov	cl, [edi+5]
		cmp	cl, 0Ah
		jz	short loc_10021A4D
		cmp	[ebp+nNumberOfBytesToRead], 0
		jz	short loc_10021A4D
		xor	edx, edx
		mov	[eax], cl
		mov	ecx, [ebx]
		inc	edx
		inc	eax
		dec	[ebp+nNumberOfBytesToRead]
		cmp	[ebp+var_1C], 0
		mov	[ebp+var_10], edx
		mov	byte ptr [esi+ecx+5], 0Ah
		jz	short loc_10021A4D
		mov	ecx, [ebx]
		mov	cl, [esi+ecx+6]
		cmp	cl, 0Ah
		jz	short loc_10021A4D
		cmp	[ebp+nNumberOfBytesToRead], 0
		jz	short loc_10021A4D
		mov	[eax], cl
		mov	ecx, [ebx]
		inc	eax
		dec	[ebp+nNumberOfBytesToRead]
		mov	[ebp+var_10], 2
		mov	byte ptr [esi+ecx+6], 0Ah
		cmp	[ebp+var_1C], edx
		jnz	short loc_10021A4D
		mov	ecx, [ebx]
		mov	cl, [esi+ecx+7]
		cmp	cl, 0Ah
		jz	short loc_10021A4D
		cmp	[ebp+nNumberOfBytesToRead], 0
		jz	short loc_10021A4D
		mov	[eax], cl
		mov	ecx, [ebx]
		inc	eax
		dec	[ebp+nNumberOfBytesToRead]
		mov	[ebp+var_10], 3
		mov	byte ptr [esi+ecx+7], 0Ah

loc_10021A4D:				; CODE XREF: sub_100218DF+F6j
					; sub_100218DF+FEj ...
		push	0		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		push	[ebp+nNumberOfBytesToRead] ; nNumberOfBytesToRead
		push	eax		; lpBuffer
		mov	eax, [ebx]
		push	dword ptr [esi+eax] ; hFile
		call	ds:ReadFile
		test	eax, eax
		jz	loc_10021E4B
		mov	ecx, [ebp+NumberOfBytesRead]
		test	ecx, ecx
		jl	loc_10021E4B
		cmp	ecx, [ebp+nNumberOfBytesToRead]
		ja	loc_10021E4B
		mov	eax, [ebx]
		add	[ebp+var_10], ecx
		lea	eax, [esi+eax+4]
		test	byte ptr [eax],	80h
		jz	loc_10021CF1
		cmp	[ebp+var_1C], 2
		jz	loc_10021D14
		test	ecx, ecx
		jz	short loc_10021B17
		mov	ecx, [ebp+lpBuffer]
		cmp	byte ptr [ecx],	0Ah
		jnz	short loc_10021B17
		or	byte ptr [eax],	4
		jmp	short loc_10021B1A
; ---------------------------------------------------------------------------

loc_10021AAB:				; CODE XREF: sub_100218DF+CCj
		mov	eax, edx
		not	eax
		test	al, 1
		jnz	short loc_10021AD4

loc_10021AB3:				; CODE XREF: sub_100218DF+BCj
					; sub_100218DF+DBj
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		mov	dword ptr [eax], 16h

loc_10021AC5:				; CODE XREF: sub_100218DF+9Ej
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10021B0F
; ---------------------------------------------------------------------------

loc_10021AD4:				; CODE XREF: sub_100218DF+1D2j
		mov	eax, edx
		push	4
		pop	ecx
		shr	eax, 1
		mov	[ebp+nNumberOfBytesToRead], ecx
		cmp	eax, ecx
		jb	short loc_10021AE5
		mov	[ebp+nNumberOfBytesToRead], eax

loc_10021AE5:				; CODE XREF: sub_100218DF+201j
		push	[ebp+nNumberOfBytesToRead]
		call	sub_1000F5A0
		pop	ecx
		mov	[ebp+lpBuffer],	eax
		cmp	eax, edi
		jnz	loc_100219C9
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		call	sub_10014C05
		mov	dword ptr [eax], 8

loc_10021B0F:				; CODE XREF: sub_100218DF+1F3j
		or	eax, 0FFFFFFFFh
		jmp	loc_10021E83
; ---------------------------------------------------------------------------

loc_10021B17:				; CODE XREF: sub_100218DF+1BDj
					; sub_100218DF+1C5j
		and	byte ptr [eax],	0FBh

loc_10021B1A:				; CODE XREF: sub_100218DF+1CAj
		mov	edi, [ebp+lpBuffer]
		mov	eax, [ebp+var_10]
		add	eax, edi
		mov	[ebp+nNumberOfBytesToRead], edi
		mov	[ebp+var_10], eax
		cmp	edi, eax
		jnb	loc_10021C00

loc_10021B30:				; CODE XREF: sub_100218DF+304j
		mov	ecx, [ebp+nNumberOfBytesToRead]
		mov	al, [ecx]
		cmp	al, 1Ah
		jz	loc_10021BEB
		cmp	al, 0Dh
		jz	short loc_10021B4D
		mov	[edi], al
		inc	edi
		inc	ecx
		mov	[ebp+nNumberOfBytesToRead], ecx
		jmp	loc_10021BDD
; ---------------------------------------------------------------------------

loc_10021B4D:				; CODE XREF: sub_100218DF+260j
		mov	eax, [ebp+var_10]
		dec	eax
		cmp	ecx, eax
		jnb	short loc_10021B6C
		lea	eax, [ecx+1]
		cmp	byte ptr [eax],	0Ah
		jnz	short loc_10021B67
		inc	ecx
		inc	ecx
		mov	[ebp+nNumberOfBytesToRead], ecx

loc_10021B62:				; CODE XREF: sub_100218DF+2C8j
					; sub_100218DF+2E1j
		mov	byte ptr [edi],	0Ah
		jmp	short loc_10021BDC
; ---------------------------------------------------------------------------

loc_10021B67:				; CODE XREF: sub_100218DF+27Cj
		mov	[ebp+nNumberOfBytesToRead], eax
		jmp	short loc_10021BD9
; ---------------------------------------------------------------------------

loc_10021B6C:				; CODE XREF: sub_100218DF+274j
		inc	[ebp+nNumberOfBytesToRead]
		push	0		; lpOverlapped
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	1		; nNumberOfBytesToRead
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	eax, [ebx]
		push	dword ptr [esi+eax] ; hFile
		call	ds:ReadFile
		test	eax, eax
		jnz	short loc_10021B94
		call	ds:GetLastError
		test	eax, eax
		jnz	short loc_10021BD9

loc_10021B94:				; CODE XREF: sub_100218DF+2A9j
		cmp	[ebp+NumberOfBytesRead], 0
		jz	short loc_10021BD9
		mov	eax, [ebx]
		test	byte ptr [esi+eax+4], 48h
		jz	short loc_10021BB7
		cmp	[ebp+Buffer], 0Ah
		jz	short loc_10021B62
		mov	byte ptr [edi],	0Dh
		mov	eax, [ebx]
		mov	cl, [ebp+Buffer]
		mov	[esi+eax+5], cl
		jmp	short loc_10021BDC
; ---------------------------------------------------------------------------

loc_10021BB7:				; CODE XREF: sub_100218DF+2C2j
		cmp	edi, [ebp+lpBuffer]
		jnz	short loc_10021BC2
		cmp	[ebp+Buffer], 0Ah
		jz	short loc_10021B62

loc_10021BC2:				; CODE XREF: sub_100218DF+2DBj
		push	1		; dwMoveMethod
		push	0FFFFFFFFh	; int
		push	0FFFFFFFFh	; int
		push	[ebp+arg_0]	; int
		call	sub_10020D18
		add	esp, 10h
		cmp	[ebp+Buffer], 0Ah
		jz	short loc_10021BDD

loc_10021BD9:				; CODE XREF: sub_100218DF+28Bj
					; sub_100218DF+2B3j ...
		mov	byte ptr [edi],	0Dh

loc_10021BDC:				; CODE XREF: sub_100218DF+286j
					; sub_100218DF+2D6j
		inc	edi

loc_10021BDD:				; CODE XREF: sub_100218DF+269j
					; sub_100218DF+2F8j
		mov	eax, [ebp+var_10]
		cmp	[ebp+nNumberOfBytesToRead], eax
		jb	loc_10021B30
		jmp	short loc_10021C00
; ---------------------------------------------------------------------------

loc_10021BEB:				; CODE XREF: sub_100218DF+258j
		mov	eax, [ebx]
		lea	eax, [esi+eax+4]
		test	byte ptr [eax],	40h
		jnz	short loc_10021BFB
		or	byte ptr [eax],	2
		jmp	short loc_10021C00
; ---------------------------------------------------------------------------

loc_10021BFB:				; CODE XREF: sub_100218DF+315j
		mov	al, [ecx]
		mov	[edi], al
		inc	edi

loc_10021C00:				; CODE XREF: sub_100218DF+24Bj
					; sub_100218DF+30Aj ...
		mov	eax, edi
		sub	eax, [ebp+lpBuffer]
		cmp	[ebp+var_1C], 1
		mov	[ebp+var_10], eax
		jnz	loc_10021CF1
		test	eax, eax
		jz	loc_10021CF1
		dec	edi
		mov	cl, [edi]
		test	cl, cl
		js	short loc_10021C27
		inc	edi
		jmp	loc_10021CB0
; ---------------------------------------------------------------------------

loc_10021C27:				; CODE XREF: sub_100218DF+340j
		xor	eax, eax
		inc	eax
		movzx	ecx, cl
		jmp	short loc_10021C3E
; ---------------------------------------------------------------------------

loc_10021C2F:				; CODE XREF: sub_100218DF+366j
		cmp	eax, 4
		jg	short loc_10021C47
		cmp	edi, [ebp+lpBuffer]
		jb	short loc_10021C47
		dec	edi
		movzx	ecx, byte ptr [edi]
		inc	eax

loc_10021C3E:				; CODE XREF: sub_100218DF+34Ej
		cmp	byte_1002E1B0[ecx], 0
		jz	short loc_10021C2F

loc_10021C47:				; CODE XREF: sub_100218DF+353j
					; sub_100218DF+358j
		mov	dl, [edi]
		movzx	ecx, dl
		movsx	ecx, byte_1002E1B0[ecx]
		test	ecx, ecx
		jnz	short loc_10021C67
		call	sub_10014BF2
		mov	dword ptr [eax], 2Ah
		jmp	loc_10021CED
; ---------------------------------------------------------------------------

loc_10021C67:				; CODE XREF: sub_100218DF+376j
		inc	ecx
		cmp	ecx, eax
		jnz	short loc_10021C70
		add	edi, eax
		jmp	short loc_10021CB0
; ---------------------------------------------------------------------------

loc_10021C70:				; CODE XREF: sub_100218DF+38Bj
		mov	ecx, [ebx]
		add	ecx, esi
		test	byte ptr [ecx+4], 48h
		jz	short loc_10021C9E
		inc	edi
		cmp	eax, 2
		mov	[ecx+5], dl
		jl	short loc_10021C8C
		mov	dl, [edi]
		mov	ecx, [ebx]
		mov	[esi+ecx+6], dl
		inc	edi

loc_10021C8C:				; CODE XREF: sub_100218DF+3A2j
		cmp	eax, 3
		jnz	short loc_10021C9A
		mov	dl, [edi]
		mov	ecx, [ebx]
		mov	[esi+ecx+7], dl
		inc	edi

loc_10021C9A:				; CODE XREF: sub_100218DF+3B0j
		sub	edi, eax
		jmp	short loc_10021CB0
; ---------------------------------------------------------------------------

loc_10021C9E:				; CODE XREF: sub_100218DF+399j
		neg	eax
		cdq
		push	1		; dwMoveMethod
		push	edx		; int
		push	eax		; int
		push	[ebp+arg_0]	; int
		call	sub_10020D18
		add	esp, 10h

loc_10021CB0:				; CODE XREF: sub_100218DF+343j
					; sub_100218DF+38Fj ...
		mov	eax, [ebp+var_20]
		sub	edi, [ebp+lpBuffer]
		shr	eax, 1
		push	eax		; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		mov	[ebp+var_10], edi
		push	edi		; cbMultiByte
		push	[ebp+lpBuffer]	; lpMultiByteStr
		push	0		; dwFlags
		push	0FDE9h		; CodePage
		call	ds:MultiByteToWideChar
		test	eax, eax
		jz	short loc_10021CE0
		add	eax, eax
		cmp	eax, [ebp+var_20]
		ja	short loc_10021CE0
		mov	[ebp+var_10], eax
		jmp	short loc_10021CF1
; ---------------------------------------------------------------------------

loc_10021CE0:				; CODE XREF: sub_100218DF+3F3j
					; sub_100218DF+3FAj
		call	ds:GetLastError

loc_10021CE6:				; CODE XREF: sub_100218DF+593j
		push	eax
		call	sub_10014C18
		pop	ecx

loc_10021CED:				; CODE XREF: sub_100218DF+383j
					; sub_100218DF+58Bj
		or	[ebp+var_14], 0FFFFFFFFh

loc_10021CF1:				; CODE XREF: sub_100218DF+1ABj
					; sub_100218DF+32Dj ...
		mov	eax, [ebp+lpBuffer]
		cmp	eax, [ebp+lpWideCharStr]
		jz	short loc_10021D00
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10021D00:				; CODE XREF: sub_100218DF+418j
		mov	eax, [ebp+var_14]
		cmp	eax, 0FFFFFFFEh
		jnz	loc_10021E83
		mov	eax, [ebp+var_10]
		jmp	loc_10021E83
; ---------------------------------------------------------------------------

loc_10021D14:				; CODE XREF: sub_100218DF+1B5j
		test	ecx, ecx
		jz	short loc_10021D26
		mov	ecx, [ebp+lpBuffer]
		cmp	word ptr [ecx],	0Ah
		jnz	short loc_10021D26
		or	byte ptr [eax],	4
		jmp	short loc_10021D29
; ---------------------------------------------------------------------------

loc_10021D26:				; CODE XREF: sub_100218DF+437j
					; sub_100218DF+440j
		and	byte ptr [eax],	0FBh

loc_10021D29:				; CODE XREF: sub_100218DF+445j
		mov	edi, [ebp+lpBuffer]
		mov	eax, [ebp+var_10]
		add	eax, edi
		mov	[ebp+var_10], eax
		dec	eax
		mov	[ebp+nNumberOfBytesToRead], edi
		cmp	edi, eax
		jnb	loc_10021E40

loc_10021D40:				; CODE XREF: sub_100218DF+541j
		mov	eax, [ebp+nNumberOfBytesToRead]
		movzx	ecx, word ptr [eax]
		cmp	cx, 1Ah
		jz	loc_10021E28
		cmp	cx, 0Dh
		jz	short loc_10021D65
		mov	[edi], cx
		inc	edi
		inc	edi
		inc	eax
		inc	eax
		mov	[ebp+nNumberOfBytesToRead], eax
		jmp	loc_10021E19
; ---------------------------------------------------------------------------

loc_10021D65:				; CODE XREF: sub_100218DF+475j
		mov	ecx, [ebp+var_10]
		add	ecx, 0FFFFFFFEh
		cmp	eax, ecx
		jnb	short loc_10021D8D
		lea	ecx, [eax+2]
		cmp	word ptr [ecx],	0Ah
		jnz	short loc_10021D85
		add	eax, 4
		mov	[ebp+nNumberOfBytesToRead], eax

loc_10021D7E:				; CODE XREF: sub_100218DF+4EBj
					; sub_100218DF+518j
		push	0Ah
		jmp	loc_10021E13
; ---------------------------------------------------------------------------

loc_10021D85:				; CODE XREF: sub_100218DF+497j
		mov	[ebp+nNumberOfBytesToRead], ecx
		jmp	loc_10021E11
; ---------------------------------------------------------------------------

loc_10021D8D:				; CODE XREF: sub_100218DF+48Ej
		add	[ebp+nNumberOfBytesToRead], 2
		push	0		; lpOverlapped
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	2		; nNumberOfBytesToRead
		lea	eax, [ebp+var_8]
		push	eax		; lpBuffer
		mov	eax, [ebx]
		push	dword ptr [esi+eax] ; hFile
		call	ds:ReadFile
		test	eax, eax
		jnz	short loc_10021DB6
		call	ds:GetLastError
		test	eax, eax
		jnz	short loc_10021E11

loc_10021DB6:				; CODE XREF: sub_100218DF+4CBj
		cmp	[ebp+NumberOfBytesRead], 0
		jz	short loc_10021E11
		mov	eax, [ebx]
		test	byte ptr [esi+eax+4], 48h
		jz	short loc_10021DED
		cmp	[ebp+var_8], 0Ah
		jz	short loc_10021D7E
		push	0Dh
		pop	eax
		mov	[edi], ax
		mov	eax, [ebx]
		mov	cl, byte ptr [ebp+var_8]
		mov	[esi+eax+5], cl
		mov	eax, [ebx]
		mov	cl, byte ptr [ebp+var_8+1]
		mov	[esi+eax+6], cl
		mov	eax, [ebx]
		mov	byte ptr [esi+eax+7], 0Ah
		jmp	short loc_10021E17
; ---------------------------------------------------------------------------

loc_10021DED:				; CODE XREF: sub_100218DF+4E4j
		cmp	edi, [ebp+lpBuffer]
		jnz	short loc_10021DF9
		cmp	[ebp+var_8], 0Ah
		jz	short loc_10021D7E

loc_10021DF9:				; CODE XREF: sub_100218DF+511j
		push	1		; dwMoveMethod
		push	0FFFFFFFFh	; int
		push	0FFFFFFFEh	; int
		push	[ebp+arg_0]	; int
		call	sub_10020D18
		add	esp, 10h
		cmp	[ebp+var_8], 0Ah
		jz	short loc_10021E19

loc_10021E11:				; CODE XREF: sub_100218DF+4A9j
					; sub_100218DF+4D5j ...
		push	0Dh

loc_10021E13:				; CODE XREF: sub_100218DF+4A1j
		pop	eax
		mov	[edi], ax

loc_10021E17:				; CODE XREF: sub_100218DF+50Cj
		inc	edi
		inc	edi

loc_10021E19:				; CODE XREF: sub_100218DF+481j
					; sub_100218DF+530j
		mov	eax, [ebp+var_10]
		dec	eax
		cmp	[ebp+nNumberOfBytesToRead], eax
		jb	loc_10021D40
		jmp	short loc_10021E40
; ---------------------------------------------------------------------------

loc_10021E28:				; CODE XREF: sub_100218DF+46Bj
		mov	ecx, [ebx]
		lea	esi, [esi+ecx+4]
		test	byte ptr [esi],	40h
		jnz	short loc_10021E38
		or	byte ptr [esi],	2
		jmp	short loc_10021E40
; ---------------------------------------------------------------------------

loc_10021E38:				; CODE XREF: sub_100218DF+552j
		mov	ax, [eax]
		mov	[edi], ax
		inc	edi
		inc	edi

loc_10021E40:				; CODE XREF: sub_100218DF+45Bj
					; sub_100218DF+547j ...
		sub	edi, [ebp+lpBuffer]
		mov	[ebp+var_10], edi
		jmp	loc_10021CF1
; ---------------------------------------------------------------------------

loc_10021E4B:				; CODE XREF: sub_100218DF+185j
					; sub_100218DF+190j ...
		call	ds:GetLastError
		push	5
		pop	esi
		cmp	eax, esi
		jnz	short loc_10021E6F
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		call	sub_10014C05
		mov	[eax], esi
		jmp	loc_10021CED
; ---------------------------------------------------------------------------

loc_10021E6F:				; CODE XREF: sub_100218DF+577j
		cmp	eax, 6Dh
		jnz	loc_10021CE6
		and	[ebp+var_14], 0
		jmp	loc_10021CF1
; ---------------------------------------------------------------------------

loc_10021E81:				; CODE XREF: sub_100218DF+A8j
					; sub_100218DF+B1j
		xor	eax, eax

loc_10021E83:				; CODE XREF: sub_100218DF+233j
					; sub_100218DF+427j ...
		pop	ebx

loc_10021E84:				; CODE XREF: sub_100218DF+68j
		pop	edi

loc_10021E85:				; CODE XREF: sub_100218DF+32j
		pop	esi
		leave
		retn
sub_100218DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021E88(int,	LPWSTR lpWideCharStr, DWORD nNumberOfBytesToRead)
sub_10021E88	proc near		; CODE XREF: sub_100178B1+78p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
lpWideCharStr	= dword	ptr  0Ch
nNumberOfBytesToRead= dword ptr	 10h

		push	10h
		push	offset stru_1002B8B8
		call	__SEH_prolog4
		mov	eax, [ebp+arg_0]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10021EB7
		call	sub_10014C05
		and	dword ptr [eax], 0
		call	sub_10014BF2
		mov	dword ptr [eax], 9

loc_10021EAF:				; CODE XREF: sub_10021E88+5Cj
		or	eax, 0FFFFFFFFh
		jmp	loc_10021F54
; ---------------------------------------------------------------------------

loc_10021EB7:				; CODE XREF: sub_10021E88+12j
		xor	edi, edi
		cmp	eax, edi
		jl	short loc_10021EC5
		cmp	eax, uNumber
		jb	short loc_10021EE6

loc_10021EC5:				; CODE XREF: sub_10021E88+33j
					; sub_10021E88+7Cj
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10021EAF
; ---------------------------------------------------------------------------

loc_10021EE6:				; CODE XREF: sub_10021E88+3Bj
		mov	ecx, eax
		sar	ecx, 5
		lea	ebx, dword_1002F080[ecx*4]
		mov	esi, eax
		and	esi, 1Fh
		imul	esi, 24h
		mov	ecx, [ebx]
		movsx	ecx, byte ptr [ecx+esi+4]
		and	ecx, 1
		jz	short loc_10021EC5
		push	eax
		call	sub_1002109E
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebx]
		test	byte ptr [eax+esi+4], 1
		jz	short loc_10021F2F
		push	[ebp+nNumberOfBytesToRead] ; nNumberOfBytesToRead
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		push	[ebp+arg_0]	; int
		call	sub_100218DF
		add	esp, 0Ch
		mov	[ebp+var_1C], eax
		jmp	short loc_10021F45
; ---------------------------------------------------------------------------

loc_10021F2F:				; CODE XREF: sub_10021E88+8Fj
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		call	sub_10014C05
		mov	[eax], edi
		or	[ebp+var_1C], 0FFFFFFFFh

loc_10021F45:				; CODE XREF: sub_10021E88+A5j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10021F5A	; Finally handler 0 for	function 10021E88
; ---------------------------------------------------------------------------

loc_10021F51:				; CODE XREF: sub_10021E88+DBj
		mov	eax, [ebp+var_1C]

loc_10021F54:				; CODE XREF: sub_10021E88+2Aj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10021F5A:				; CODE XREF: sub_10021E88+C4j
					; DATA XREF: .rdata:stru_1002B8B8o
		push	[ebp+arg_0]	; Finally handler 0 for	function 10021E88
		call	sub_1002113F
		pop	ecx
		retn
sub_10021E88	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021F64(int,	LPCSTR lpFileName, int,	int, int)
sub_10021F64	proc near		; CODE XREF: .text:10022601p
					; sub_10022664+5Ep

SecurityAttributes= _SECURITY_ATTRIBUTES ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
dwDesiredAccess	= dword	ptr -10h
dwShareMode	= dword	ptr -0Ch
dwCreationDisposition= dword ptr -8
var_4		= byte ptr -4
WideCharStr	= word ptr -3
var_1		= byte ptr -1
arg_0		= dword	ptr  8
lpFileName	= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	ebx
		push	esi
		xor	ebx, ebx
		test	byte ptr [ebp+arg_8], 80h
		push	edi
		push	10h
		mov	esi, eax
		mov	[ebp+var_14], ebx
		mov	[ebp+var_18], ebx
		mov	byte ptr [ebp+WideCharStr+1], bl
		mov	[ebp+SecurityAttributes.nLength], 0Ch
		mov	[ebp+SecurityAttributes.lpSecurityDescriptor], ebx
		pop	edi
		jz	short loc_10021F98
		mov	[ebp+SecurityAttributes.bInheritHandle], ebx
		mov	[ebp+var_1], 10h
		jmp	short loc_10021FA2
; ---------------------------------------------------------------------------

loc_10021F98:				; CODE XREF: sub_10021F64+29j
		mov	[ebp+SecurityAttributes.bInheritHandle], 1
		mov	[ebp+var_1], bl

loc_10021FA2:				; CODE XREF: sub_10021F64+32j
		lea	eax, [ebp+var_14]
		push	eax
		call	sub_10024D54
		pop	ecx
		test	eax, eax
		jz	short loc_10021FBD
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10021FBD:				; CODE XREF: sub_10021F64+4Aj
		lea	eax, [ebp+var_18]
		push	eax
		call	sub_1001653D
		pop	ecx
		test	eax, eax
		jz	short loc_10021FD8
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10021FD8:				; CODE XREF: sub_10021F64+65j
		mov	eax, 8000h
		test	[ebp+arg_8], eax
		jnz	short loc_10021FF4
		test	[ebp+arg_8], 74000h
		jnz	short loc_10021FF0
		cmp	[ebp+var_14], eax
		jz	short loc_10021FF4

loc_10021FF0:				; CODE XREF: sub_10021F64+85j
		or	[ebp+var_1], 80h

loc_10021FF4:				; CODE XREF: sub_10021F64+7Cj
					; sub_10021F64+8Aj
		mov	eax, [ebp+arg_8]
		push	3
		pop	edx
		and	eax, edx
		sub	eax, ebx
		mov	ecx, 80000000h
		jz	short loc_10022043
		dec	eax
		jz	short loc_1002203A
		dec	eax
		jz	short loc_10022031

loc_1002200B:				; CODE XREF: sub_10021F64+F8j
					; sub_10021F64+14Fj ...
		call	sub_10014C05
		mov	[eax], ebx
		or	dword ptr [esi], 0FFFFFFFFh
		call	sub_10014BF2
		push	16h
		pop	esi
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	[eax], esi
		call	sub_10014B5B
		add	esp, 14h
		jmp	loc_100224CE
; ---------------------------------------------------------------------------

loc_10022031:				; CODE XREF: sub_10021F64+A5j
		mov	[ebp+dwDesiredAccess], 0C0000000h
		jmp	short loc_10022046
; ---------------------------------------------------------------------------

loc_1002203A:				; CODE XREF: sub_10021F64+A2j
		mov	[ebp+dwDesiredAccess], 40000000h
		jmp	short loc_10022046
; ---------------------------------------------------------------------------

loc_10022043:				; CODE XREF: sub_10021F64+9Fj
		mov	[ebp+dwDesiredAccess], ecx

loc_10022046:				; CODE XREF: sub_10021F64+D4j
					; sub_10021F64+DDj
		mov	eax, [ebp+arg_C]
		sub	eax, edi
		jz	short loc_10022080
		sub	eax, edi
		jz	short loc_10022077
		sub	eax, edi
		jz	short loc_1002206E
		sub	eax, edi
		jz	short loc_10022069
		sub	eax, 40h
		jnz	short loc_1002200B
		cmp	[ebp+dwDesiredAccess], ecx
		setz	al
		mov	[ebp+dwShareMode], eax
		jmp	short loc_10022083
; ---------------------------------------------------------------------------

loc_10022069:				; CODE XREF: sub_10021F64+F3j
		mov	[ebp+dwShareMode], edx
		jmp	short loc_10022083
; ---------------------------------------------------------------------------

loc_1002206E:				; CODE XREF: sub_10021F64+EFj
		mov	[ebp+dwShareMode], 2
		jmp	short loc_10022083
; ---------------------------------------------------------------------------

loc_10022077:				; CODE XREF: sub_10021F64+EBj
		mov	[ebp+dwShareMode], 1
		jmp	short loc_10022083
; ---------------------------------------------------------------------------

loc_10022080:				; CODE XREF: sub_10021F64+E7j
		mov	[ebp+dwShareMode], ebx

loc_10022083:				; CODE XREF: sub_10021F64+103j
					; sub_10021F64+108j ...
		mov	eax, [ebp+arg_8]
		mov	edx, 700h
		and	eax, edx
		mov	ecx, 400h
		cmp	eax, ecx
		jg	short loc_100220D4
		jz	short loc_100220CB
		cmp	eax, ebx
		jz	short loc_100220CB
		cmp	eax, 100h
		jz	short loc_100220C2
		cmp	eax, 200h
		jz	loc_10022147
		cmp	eax, 300h
		jnz	loc_1002200B
		mov	[ebp+dwCreationDisposition], 2
		jmp	short loc_100220F1
; ---------------------------------------------------------------------------

loc_100220C2:				; CODE XREF: sub_10021F64+13Dj
		mov	[ebp+dwCreationDisposition], 4
		jmp	short loc_100220F1
; ---------------------------------------------------------------------------

loc_100220CB:				; CODE XREF: sub_10021F64+132j
					; sub_10021F64+136j
		mov	[ebp+dwCreationDisposition], 3
		jmp	short loc_100220F1
; ---------------------------------------------------------------------------

loc_100220D4:				; CODE XREF: sub_10021F64+130j
		cmp	eax, 500h
		jz	short loc_100220EA
		cmp	eax, 600h
		jz	short loc_10022147
		cmp	eax, edx
		jnz	loc_1002200B

loc_100220EA:				; CODE XREF: sub_10021F64+175j
		mov	[ebp+dwCreationDisposition], 1

loc_100220F1:				; CODE XREF: sub_10021F64+15Cj
					; sub_10021F64+165j ...
		mov	ecx, [ebp+arg_8]
		mov	eax, 100h
		mov	edi, 80h
		test	eax, ecx
		jz	short loc_10022114
		mov	edx, dword_1002EADC
		not	edx
		and	edx, [ebp+arg_10]
		test	dl, dl
		js	short loc_10022114
		xor	edi, edi
		inc	edi

loc_10022114:				; CODE XREF: sub_10021F64+19Cj
					; sub_10021F64+1ABj
		test	cl, 40h
		jz	short loc_10022130
		or	[ebp+dwDesiredAccess], 10000h
		or	edi, 4000000h
		cmp	[ebp+var_18], 2
		jnz	short loc_10022130
		or	[ebp+dwShareMode], 4

loc_10022130:				; CODE XREF: sub_10021F64+1B3j
					; sub_10021F64+1C6j
		test	ecx, 1000h
		jz	short loc_1002213A
		or	edi, eax

loc_1002213A:				; CODE XREF: sub_10021F64+1D2j
		test	cl, 20h
		jz	short loc_10022150
		or	edi, 8000000h
		jmp	short loc_1002215B
; ---------------------------------------------------------------------------

loc_10022147:				; CODE XREF: sub_10021F64+144j
					; sub_10021F64+17Cj
		mov	[ebp+dwCreationDisposition], 5
		jmp	short loc_100220F1
; ---------------------------------------------------------------------------

loc_10022150:				; CODE XREF: sub_10021F64+1D9j
		test	cl, 10h
		jz	short loc_1002215B
		or	edi, 10000000h

loc_1002215B:				; CODE XREF: sub_10021F64+1E1j
					; sub_10021F64+1EFj
		call	sub_10021166
		mov	[esi], eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1002217E
		call	sub_10014C05
		mov	[eax], ebx
		or	dword ptr [esi], 0FFFFFFFFh
		call	sub_10014BF2
		mov	dword ptr [eax], 18h
		jmp	short loc_100221CE
; ---------------------------------------------------------------------------

loc_1002217E:				; CODE XREF: sub_10021F64+201j
		mov	eax, [ebp+arg_0]
		push	ebx		; hTemplateFile
		push	edi		; dwFlagsAndAttributes
		push	[ebp+dwCreationDisposition] ; dwCreationDisposition
		mov	dword ptr [eax], 1
		lea	eax, [ebp+SecurityAttributes]
		push	eax		; lpSecurityAttributes
		push	[ebp+dwShareMode] ; dwShareMode
		push	[ebp+dwDesiredAccess] ;	dwDesiredAccess
		push	[ebp+lpFileName] ; lpFileName
		call	ds:CreateFileA
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_100221DA
		mov	esi, [esi]
		mov	eax, esi
		and	esi, 1Fh
		imul	esi, 24h
		sar	eax, 5
		mov	eax, dword_1002F080[eax*4]
		lea	eax, [eax+esi+4]
		and	byte ptr [eax],	0FEh

loc_100221C1:				; CODE XREF: sub_10021F64+2A3j
		call	ds:GetLastError
		push	eax
		call	sub_10014C18

loc_100221CD:				; CODE XREF: sub_10021F64+358j
		pop	ecx

loc_100221CE:				; CODE XREF: sub_10021F64+218j
		call	sub_10014BF2
		mov	eax, [eax]
		jmp	loc_100225A9
; ---------------------------------------------------------------------------

loc_100221DA:				; CODE XREF: sub_10021F64+240j
		push	edi		; hFile
		call	ds:GetFileType
		cmp	eax, ebx
		jnz	short loc_10022209
		mov	esi, [esi]
		mov	eax, esi
		and	esi, 1Fh
		imul	esi, 24h
		sar	eax, 5
		mov	eax, dword_1002F080[eax*4]
		lea	eax, [eax+esi+4]
		and	byte ptr [eax],	0FEh
		push	edi		; hObject
		call	ds:CloseHandle
		jmp	short loc_100221C1
; ---------------------------------------------------------------------------

loc_10022209:				; CODE XREF: sub_10021F64+27Fj
		cmp	eax, 2
		jnz	short loc_10022214
		or	[ebp+var_1], 40h
		jmp	short loc_1002221D
; ---------------------------------------------------------------------------

loc_10022214:				; CODE XREF: sub_10021F64+2A8j
		cmp	eax, 3
		jnz	short loc_1002221D
		or	[ebp+var_1], 8

loc_1002221D:				; CODE XREF: sub_10021F64+2AEj
					; sub_10021F64+2B3j
		push	edi		; hHandle
		push	dword ptr [esi]	; int
		call	sub_10020F05
		pop	ecx
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1002223B
		push	edi		; hObject
		call	ds:CloseHandle
		or	eax, 0FFFFFFFFh
		jmp	loc_100225A9
; ---------------------------------------------------------------------------

loc_1002223B:				; CODE XREF: sub_10021F64+2C6j
		mov	eax, [esi]
		or	[ebp+var_1], 1
		mov	dl, [ebp+var_1]
		mov	ecx, eax
		and	eax, 1Fh
		imul	eax, 24h
		sar	ecx, 5
		mov	ecx, dword_1002F080[ecx*4]
		mov	[ecx+eax+4], dl
		mov	eax, [esi]
		mov	ecx, eax
		and	eax, 1Fh
		imul	eax, 24h
		sar	ecx, 5
		mov	ecx, dword_1002F080[ecx*4]
		lea	eax, [ecx+eax+8]
		and	dword ptr [eax], 0FFFFFFFCh
		mov	al, dl
		and	al, 48h
		mov	[ebp+var_4], al
		jnz	loc_10022302
		test	dl, 80h
		jz	loc_10022539
		test	byte ptr [ebp+arg_8], 2
		jz	short loc_10022302
		push	2		; dwMoveMethod
		or	edi, 0FFFFFFFFh
		push	edi		; lDistanceToMove
		push	dword ptr [esi]	; int
		call	sub_10024AFF
		add	esp, 0Ch
		mov	[ebp+dwShareMode], eax
		cmp	eax, edi
		jnz	short loc_100222C1
		call	sub_10014C05
		cmp	dword ptr [eax], 83h
		jz	short loc_10022302

loc_100222B5:				; CODE XREF: sub_10021F64+38Cj
					; sub_10021F64+39Cj ...
		push	dword ptr [esi]
		call	sub_10016EA6
		jmp	loc_100221CD
; ---------------------------------------------------------------------------

loc_100222C1:				; CODE XREF: sub_10021F64+342j
		push	1		; nNumberOfBytesToRead
		lea	eax, [ebp+WideCharStr]
		push	eax		; lpWideCharStr
		push	dword ptr [esi]	; int
		mov	byte ptr [ebp+WideCharStr], bl
		call	sub_100218DF
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100222F2
		cmp	byte ptr [ebp+WideCharStr], 1Ah
		jnz	short loc_100222F2
		mov	eax, [ebp+dwShareMode]
		cdq
		push	edx
		push	eax
		push	dword ptr [esi]
		call	sub_10024840
		add	esp, 0Ch
		cmp	eax, edi
		jz	short loc_100222B5

loc_100222F2:				; CODE XREF: sub_10021F64+372j
					; sub_10021F64+378j
		push	ebx		; dwMoveMethod
		push	ebx		; lDistanceToMove
		push	dword ptr [esi]	; int
		call	sub_10024AFF
		add	esp, 0Ch
		cmp	eax, edi
		jz	short loc_100222B5

loc_10022302:				; CODE XREF: sub_10021F64+318j
					; sub_10021F64+32Bj ...
		test	[ebp+var_1], 80h
		jz	loc_10022539
		mov	ecx, 74000h
		mov	edi, 4000h
		test	[ebp+arg_8], ecx
		jnz	short loc_1002232A
		mov	eax, [ebp+var_14]
		and	eax, ecx
		jnz	short loc_10022327
		or	[ebp+arg_8], edi
		jmp	short loc_1002232A
; ---------------------------------------------------------------------------

loc_10022327:				; CODE XREF: sub_10021F64+3BCj
		or	[ebp+arg_8], eax

loc_1002232A:				; CODE XREF: sub_10021F64+3B5j
					; sub_10021F64+3C1j
		mov	eax, [ebp+arg_8]
		and	eax, ecx
		cmp	eax, edi
		jz	short loc_10022377
		cmp	eax, 10000h
		jz	short loc_10022363
		cmp	eax, 14000h
		jz	short loc_10022363
		cmp	eax, 20000h
		jz	short loc_10022371
		cmp	eax, 24000h
		jz	short loc_10022371
		cmp	eax, 40000h
		jz	short loc_1002235D
		cmp	eax, 44000h
		jnz	short loc_1002237A

loc_1002235D:				; CODE XREF: sub_10021F64+3F0j
		mov	byte ptr [ebp+WideCharStr+1], 1
		jmp	short loc_1002237A
; ---------------------------------------------------------------------------

loc_10022363:				; CODE XREF: sub_10021F64+3D4j
					; sub_10021F64+3DBj
		mov	ecx, [ebp+arg_8]
		mov	eax, 301h
		and	ecx, eax
		cmp	ecx, eax
		jnz	short loc_1002237A

loc_10022371:				; CODE XREF: sub_10021F64+3E2j
					; sub_10021F64+3E9j
		mov	byte ptr [ebp+WideCharStr+1], 2
		jmp	short loc_1002237A
; ---------------------------------------------------------------------------

loc_10022377:				; CODE XREF: sub_10021F64+3CDj
		mov	byte ptr [ebp+WideCharStr+1], bl

loc_1002237A:				; CODE XREF: sub_10021F64+3F7j
					; sub_10021F64+3FDj ...
		test	[ebp+arg_8], 70000h
		jz	loc_10022539
		test	[ebp+var_1], 40h
		mov	[ebp+dwShareMode], ebx
		jnz	loc_10022539
		mov	eax, [ebp+dwDesiredAccess]
		mov	ecx, 0C0000000h
		and	eax, ecx
		cmp	eax, 40000000h
		jz	loc_10022438
		cmp	eax, 80000000h
		jz	short loc_100223FB
		cmp	eax, ecx
		jnz	loc_10022539
		cmp	[ebp+dwCreationDisposition], ebx
		jbe	loc_10022539
		cmp	[ebp+dwCreationDisposition], 2
		jbe	loc_10022457
		cmp	[ebp+dwCreationDisposition], 4
		ja	short loc_1002244D
		push	2		; dwMoveMethod
		push	ebx		; int
		push	ebx		; int
		push	dword ptr [esi]	; int
		call	sub_10020D18
		add	esp, 10h
		or	eax, edx
		jz	short loc_10022457
		push	ebx		; dwMoveMethod
		push	ebx		; int
		push	ebx		; int
		push	dword ptr [esi]	; int
		call	sub_10020D18
		and	eax, edx
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jz	loc_100222B5

loc_100223FB:				; CODE XREF: sub_10021F64+44Aj
		push	3		; nNumberOfBytesToRead
		lea	eax, [ebp+dwShareMode]
		push	eax		; lpWideCharStr
		push	dword ptr [esi]	; int
		call	sub_100218DF
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	loc_100222B5
		cmp	eax, 2
		jz	loc_100224AD
		cmp	eax, 3
		jnz	loc_100224F8
		cmp	[ebp+dwShareMode], 0BFBBEFh
		jnz	short loc_100224AD
		mov	byte ptr [ebp+WideCharStr+1], 1
		jmp	loc_10022539
; ---------------------------------------------------------------------------

loc_10022438:				; CODE XREF: sub_10021F64+43Fj
		cmp	[ebp+dwCreationDisposition], ebx
		jbe	loc_10022539
		cmp	[ebp+dwCreationDisposition], 2
		jbe	short loc_10022457
		cmp	[ebp+dwCreationDisposition], 4
		jbe	short loc_1002247E

loc_1002244D:				; CODE XREF: sub_10021F64+46Bj
		cmp	[ebp+dwCreationDisposition], 5
		jnz	loc_10022539

loc_10022457:				; CODE XREF: sub_10021F64+461j
					; sub_10021F64+47Dj ...
		movsx	eax, byte ptr [ebp+WideCharStr+1]
		xor	edi, edi
		dec	eax
		jz	loc_10022506
		dec	eax
		jnz	loc_10022539
		mov	[ebp+dwShareMode], 0FEFFh
		mov	[ebp+dwDesiredAccess], 2
		jmp	loc_10022514
; ---------------------------------------------------------------------------

loc_1002247E:				; CODE XREF: sub_10021F64+4E7j
		push	2		; dwMoveMethod
		push	ebx		; int
		push	ebx		; int
		push	dword ptr [esi]	; int
		call	sub_10020D18
		add	esp, 10h
		or	eax, edx
		jz	short loc_10022457
		push	ebx		; dwMoveMethod
		push	ebx		; int
		push	ebx		; int
		push	dword ptr [esi]	; int
		call	sub_10020D18
		add	esp, 10h
		and	eax, edx

loc_1002249F:				; CODE XREF: sub_10021F64+5A0j
		cmp	eax, 0FFFFFFFFh
		jnz	loc_10022539
		jmp	loc_100222B5
; ---------------------------------------------------------------------------

loc_100224AD:				; CODE XREF: sub_10021F64+4B3j
					; sub_10021F64+4C9j
		mov	eax, [ebp+dwShareMode]
		and	eax, 0FFFFh
		cmp	eax, 0FFFEh
		jnz	short loc_100224D5
		push	dword ptr [esi]
		call	sub_10016EA6
		pop	ecx
		call	sub_10014BF2
		push	16h
		pop	esi
		mov	[eax], esi

loc_100224CE:				; CODE XREF: sub_10021F64+C8j
		mov	eax, esi
		jmp	loc_100225A9
; ---------------------------------------------------------------------------

loc_100224D5:				; CODE XREF: sub_10021F64+556j
		cmp	eax, 0FEFFh
		jnz	short loc_100224F8
		push	ebx		; dwMoveMethod
		push	2		; lDistanceToMove
		push	dword ptr [esi]	; int
		call	sub_10024AFF
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	loc_100222B5
		mov	byte ptr [ebp+WideCharStr+1], 2
		jmp	short loc_10022539
; ---------------------------------------------------------------------------

loc_100224F8:				; CODE XREF: sub_10021F64+4BCj
					; sub_10021F64+576j
		push	ebx		; dwMoveMethod
		push	ebx		; lDistanceToMove
		push	dword ptr [esi]	; int
		call	sub_10024AFF
		add	esp, 0Ch
		jmp	short loc_1002249F
; ---------------------------------------------------------------------------

loc_10022506:				; CODE XREF: sub_10021F64+4FAj
		mov	[ebp+dwShareMode], 0BFBBEFh
		mov	[ebp+dwDesiredAccess], 3

loc_10022514:				; CODE XREF: sub_10021F64+515j
					; sub_10021F64+5D3j
		mov	eax, [ebp+dwDesiredAccess]
		sub	eax, edi
		push	eax		; nNumberOfBytesToWrite
		lea	eax, [ebp+edi+dwShareMode]
		push	eax		; int
		push	dword ptr [esi]	; int
		call	sub_10018A68
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	loc_100222B5
		add	edi, eax
		cmp	[ebp+dwDesiredAccess], edi
		jg	short loc_10022514

loc_10022539:				; CODE XREF: sub_10021F64+321j
					; sub_10021F64+3A2j ...
		mov	eax, [esi]
		mov	ecx, eax
		and	eax, 1Fh
		imul	eax, 24h
		sar	ecx, 5
		mov	ecx, dword_1002F080[ecx*4]
		lea	eax, [ecx+eax+8]
		movsx	ecx, byte ptr [ebp+WideCharStr+1]
		xor	ecx, [eax]
		and	ecx, 3
		xor	[eax], ecx
		mov	eax, [esi]
		mov	ecx, eax
		and	eax, 1Fh
		imul	eax, 24h
		sar	ecx, 5
		mov	ecx, dword_1002F080[ecx*4]
		lea	eax, [ecx+eax+8]
		mov	ecx, [ebp+arg_8]
		shr	ecx, 0Dh
		xor	ecx, [eax]
		and	ecx, 8
		xor	[eax], ecx
		cmp	[ebp+var_4], bl
		jnz	short loc_100225A7
		test	byte ptr [ebp+arg_8], 8
		jz	short loc_100225A7
		mov	esi, [esi]
		mov	eax, esi
		and	esi, 1Fh
		imul	esi, 24h
		sar	eax, 5
		mov	eax, dword_1002F080[eax*4]
		lea	eax, [eax+esi+4]
		or	byte ptr [eax],	20h

loc_100225A7:				; CODE XREF: sub_10021F64+620j
					; sub_10021F64+626j
		mov	eax, ebx

loc_100225A9:				; CODE XREF: sub_10021F64+271j
					; sub_10021F64+2D2j ...
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_10021F64	endp

; ---------------------------------------------------------------------------
		push	14h
		push	offset dword_1002B8D8
		call	__SEH_prolog4
		or	dword ptr [ebp-1Ch], 0FFFFFFFFh
		xor	esi, esi
		mov	[ebp-20h], esi
		xor	eax, eax
		cmp	[ebp+8], esi
		setnz	al
		cmp	eax, esi
		jnz	short loc_100225EC
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014B5B
		add	esp, 14h

loc_100225E7:				; CODE XREF: .text:10022626j
		or	eax, 0FFFFFFFFh
		jmp	short loc_1002265E
; ---------------------------------------------------------------------------

loc_100225EC:				; CODE XREF: .text:100225CDj
		mov	[ebp-4], esi
		push	dword ptr [ebp+10h]
		push	40h
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		lea	eax, [ebp-20h]
		push	eax
		lea	eax, [ebp-1Ch]
		call	sub_10021F64
		add	esp, 14h
		mov	[ebp-24h], eax
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_1002262A
		mov	edi, [ebp-24h]
		cmp	edi, esi
		jz	short loc_1002265B
		call	sub_10014BF2
		mov	[eax], edi
		jmp	short loc_100225E7

; =============== S U B	R O U T	I N E =======================================


sub_10022628	proc near		; DATA XREF: .rdata:1002B8F0o
		xor	esi, esi
sub_10022628	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_1002262A	proc near		; CODE XREF: .text:10022613p
		cmp	[ebp-20h], esi
		jz	short locret_1002265A
		cmp	[ebp-24h], esi
		jz	short loc_10022651
		mov	eax, [ebp-1Ch]
		sar	eax, 5
		mov	ecx, [ebp-1Ch]
		and	ecx, 1Fh
		imul	ecx, 24h
		mov	eax, dword_1002F080[eax*4]
		lea	eax, [eax+ecx+4]
		and	byte ptr [eax],	0FEh

loc_10022651:				; CODE XREF: sub_1002262A+8j
		push	dword ptr [ebp-1Ch]
		call	sub_1002113F
		pop	ecx

locret_1002265A:			; CODE XREF: sub_1002262A+3j
		retn
sub_1002262A	endp

; ---------------------------------------------------------------------------

loc_1002265B:				; CODE XREF: .text:1002261Dj
		mov	eax, [ebp-1Ch]

loc_1002265E:				; CODE XREF: .text:100225EAj
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10022664(LPCSTR lpFileName, int, int,	int, int, int)
sub_10022664	proc near		; CODE XREF: .text:10022738p
					; sub_1002274E+16p

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	10h
		push	offset stru_1002B8F8
		call	__SEH_prolog4
		xor	esi, esi
		mov	[ebp+var_1C], esi
		mov	edi, [ebp+arg_10]
		cmp	edi, esi
		jnz	short loc_10022697

loc_1002267C:				; CODE XREF: sub_10022664+39j
					; sub_10022664+47j
		call	sub_10014BF2
		push	16h
		pop	edi
		mov	[eax], edi
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, edi
		jmp	short loc_100226E3
; ---------------------------------------------------------------------------

loc_10022697:				; CODE XREF: sub_10022664+16j
		or	dword ptr [edi], 0FFFFFFFFh
		cmp	[ebp+lpFileName], esi
		jz	short loc_1002267C
		cmp	[ebp+arg_14], esi
		jz	short loc_100226AD
		test	[ebp+arg_C], 0FFFFFE7Fh
		jnz	short loc_1002267C

loc_100226AD:				; CODE XREF: sub_10022664+3Ej
		mov	[ebp+ms_exc.registration.TryLevel], esi
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	[ebp+arg_4]	; int
		push	[ebp+lpFileName] ; lpFileName
		lea	eax, [ebp+var_1C]
		push	eax		; int
		mov	eax, edi
		call	sub_10021F64
		add	esp, 14h
		mov	[ebp+var_20], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_100226EE
; ---------------------------------------------------------------------------

loc_100226D9:				; CODE XREF: sub_10022664:loc_1002271Bj
		mov	eax, [ebp+var_20]
		cmp	eax, esi
		jz	short loc_100226E3
		or	dword ptr [edi], 0FFFFFFFFh

loc_100226E3:				; CODE XREF: sub_10022664+31j
					; sub_10022664+7Aj
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_100226E9:				; DATA XREF: .rdata:stru_1002B8F8o
		xor	esi, esi	; Finally handler 0 for	function 10022664
		mov	edi, [ebp+arg_10]

loc_100226EE:				; CODE XREF: sub_10022664+70j
		cmp	[ebp+var_1C], esi
		jz	short loc_1002271B
		cmp	[ebp+var_20], esi
		jz	short loc_10022713
		mov	eax, [edi]
		mov	ecx, eax
		sar	ecx, 5
		and	eax, 1Fh
		imul	eax, 24h
		mov	ecx, dword_1002F080[ecx*4]
		lea	eax, [ecx+eax+4]
		and	byte ptr [eax],	0FEh

loc_10022713:				; CODE XREF: sub_10022664+92j
		push	dword ptr [edi]
		call	sub_1002113F
		pop	ecx

loc_1002271B:				; CODE XREF: sub_10022664+8Dj
		retn
sub_10022664	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		or	dword ptr [ebp-4], 0FFFFFFFFh
		push	0
		lea	eax, [ebp-4]
		push	eax
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10022664
		add	esp, 18h
		test	eax, eax
		jz	short loc_10022749
		or	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------

loc_10022749:				; CODE XREF: .text:10022742j
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1002274E(int,	LPCSTR lpFileName, int,	int, int)
sub_1002274E	proc near		; CODE XREF: sub_10017C64+270p

arg_0		= dword	ptr  8
lpFileName	= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1		; int
		push	[ebp+arg_0]	; int
		push	[ebp+arg_10]	; int
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	[ebp+lpFileName] ; lpFileName
		call	sub_10022664
		add	esp, 18h
		pop	ebp
		retn
sub_1002274E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002276E	proc near		; CODE XREF: sub_10022994+Dp

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
DestStr		= word ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	esi
		push	[ebp+arg_8]
		lea	ecx, [ebp+var_14]
		call	sub_1000E615
		mov	edx, [ebp+arg_0]
		xor	esi, esi
		cmp	edx, esi
		jnz	short loc_100227BA
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_8], 0
		jz	short loc_100227B0
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_100227B0:				; CODE XREF: sub_1002276E+39j
		mov	eax, 7FFFFFFFh
		jmp	loc_10022991
; ---------------------------------------------------------------------------

loc_100227BA:				; CODE XREF: sub_1002276E+1Bj
		push	ebx
		mov	ebx, [ebp+arg_4]
		cmp	ebx, esi
		jnz	short loc_100227F1
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_8], 0
		jz	short loc_100227E7
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_100227E7:				; CODE XREF: sub_1002276E+70j
		mov	eax, 7FFFFFFFh
		jmp	loc_10022990
; ---------------------------------------------------------------------------

loc_100227F1:				; CODE XREF: sub_1002276E+52j
		mov	eax, [ebp+var_10]
		cmp	[eax+8], esi
		jnz	short loc_1002281D
		lea	eax, [ebp+var_14]
		push	eax
		push	ebx
		push	edx
		call	sub_10023DAE
		add	esp, 0Ch
		cmp	[ebp+var_8], 0
		jz	loc_10022990
		mov	ecx, [ebp+var_C]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	loc_10022990
; ---------------------------------------------------------------------------

loc_1002281D:				; CODE XREF: sub_1002276E+89j
		push	edi
		mov	edi, 200h

loc_10022823:				; CODE XREF: sub_1002276E+1D9j
		movzx	cx, byte ptr [edx]
		movzx	ecx, cx
		movzx	esi, cl
		inc	edx
		test	byte ptr [esi+eax+1Dh],	4
		mov	[ebp+arg_0], edx
		jz	short loc_10022896
		cmp	byte ptr [edx],	0
		jnz	short loc_10022841
		xor	esi, esi
		jmp	short loc_100228B2
; ---------------------------------------------------------------------------

loc_10022841:				; CODE XREF: sub_1002276E+CDj
		push	1		; int
		push	dword ptr [eax+4] ; CodePage
		lea	ecx, [ebp+DestStr]
		push	2		; cchDest
		push	ecx		; lpDestStr
		push	2		; cbMultiByte
		dec	edx
		push	edx		; lpMultiByteStr
		push	edi		; dwMapFlags
		push	dword ptr [eax+0Ch] ; Locale
		lea	eax, [ebp+var_14]
		push	eax		; int
		call	sub_10017580
		add	esp, 24h
		cmp	eax, 1
		jnz	short loc_1002286C
		movzx	ax, byte ptr [ebp+DestStr]
		jmp	short loc_1002288B
; ---------------------------------------------------------------------------

loc_1002286C:				; CODE XREF: sub_1002276E+F5j
		cmp	eax, 2
		jnz	loc_1002294C
		movzx	ax, byte ptr [ebp+DestStr]
		mov	ecx, 100h
		imul	ax, cx
		movzx	cx, byte ptr [ebp+DestStr+1]
		add	ax, cx

loc_1002288B:				; CODE XREF: sub_1002276E+FCj
		inc	[ebp+arg_0]
		movzx	esi, ax
		mov	eax, [ebp+var_10]
		jmp	short loc_100228B2
; ---------------------------------------------------------------------------

loc_10022896:				; CODE XREF: sub_1002276E+C8j
		movzx	edx, cx
		lea	ecx, [edx+eax]
		test	byte ptr [ecx+1Dh], 10h
		jz	short loc_100228AF
		movzx	cx, byte ptr [ecx+11Dh]
		movzx	esi, cx
		jmp	short loc_100228B2
; ---------------------------------------------------------------------------

loc_100228AF:				; CODE XREF: sub_1002276E+132j
		movzx	esi, dx

loc_100228B2:				; CODE XREF: sub_1002276E+D1j
					; sub_1002276E+126j ...
		movzx	cx, byte ptr [ebx]
		movzx	ecx, cx
		movzx	edx, cl
		inc	ebx
		test	byte ptr [edx+eax+1Dh],	4
		jz	short loc_1002291E
		cmp	byte ptr [ebx],	0
		jnz	short loc_100228CD
		xor	ecx, ecx
		jmp	short loc_1002293A
; ---------------------------------------------------------------------------

loc_100228CD:				; CODE XREF: sub_1002276E+159j
		push	1		; int
		push	dword ptr [eax+4] ; CodePage
		lea	ecx, [ebp+DestStr]
		push	2		; cchDest
		push	ecx		; lpDestStr
		push	2		; cbMultiByte
		lea	ecx, [ebx-1]
		push	ecx		; lpMultiByteStr
		push	edi		; dwMapFlags
		push	dword ptr [eax+0Ch] ; Locale
		lea	eax, [ebp+var_14]
		push	eax		; int
		call	sub_10017580
		add	esp, 24h
		cmp	eax, 1
		jnz	short loc_100228FA
		movzx	ax, byte ptr [ebp+DestStr]
		jmp	short loc_10022915
; ---------------------------------------------------------------------------

loc_100228FA:				; CODE XREF: sub_1002276E+183j
		cmp	eax, 2
		jnz	short loc_1002294C
		movzx	ax, byte ptr [ebp+DestStr]
		mov	ecx, 100h
		imul	ax, cx
		movzx	cx, byte ptr [ebp+DestStr+1]
		add	ax, cx

loc_10022915:				; CODE XREF: sub_1002276E+18Aj
		movzx	ecx, ax
		mov	eax, [ebp+var_10]
		inc	ebx
		jmp	short loc_1002293A
; ---------------------------------------------------------------------------

loc_1002291E:				; CODE XREF: sub_1002276E+154j
		movzx	edx, cx
		lea	ecx, [edx+eax]
		test	byte ptr [ecx+1Dh], 10h
		jz	short loc_10022937
		movzx	cx, byte ptr [ecx+11Dh]
		movzx	ecx, cx
		jmp	short loc_1002293A
; ---------------------------------------------------------------------------

loc_10022937:				; CODE XREF: sub_1002276E+1BAj
		movzx	ecx, dx

loc_1002293A:				; CODE XREF: sub_1002276E+15Dj
					; sub_1002276E+1AEj ...
		cmp	cx, si
		jnz	short loc_1002296B
		test	si, si
		jz	short loc_10022980
		mov	edx, [ebp+arg_0]
		jmp	loc_10022823
; ---------------------------------------------------------------------------

loc_1002294C:				; CODE XREF: sub_1002276E+101j
					; sub_1002276E+18Fj
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		cmp	[ebp+var_8], 0
		jz	short loc_10022964
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10022964:				; CODE XREF: sub_1002276E+1EDj
		mov	eax, 7FFFFFFFh
		jmp	short loc_1002298F
; ---------------------------------------------------------------------------

loc_1002296B:				; CODE XREF: sub_1002276E+1CFj
		sbb	eax, eax
		and	eax, 2
		dec	eax
		cmp	[ebp+var_8], 0
		jz	short loc_1002298F
		mov	ecx, [ebp+var_C]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	short loc_1002298F
; ---------------------------------------------------------------------------

loc_10022980:				; CODE XREF: sub_1002276E+1D4j
		cmp	[ebp+var_8], 0
		jz	short loc_1002298D
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_1002298D:				; CODE XREF: sub_1002276E+216j
		xor	eax, eax

loc_1002298F:				; CODE XREF: sub_1002276E+1FBj
					; sub_1002276E+207j ...
		pop	edi

loc_10022990:				; CODE XREF: sub_1002276E+7Ej
					; sub_1002276E+9Dj ...
		pop	ebx

loc_10022991:				; CODE XREF: sub_1002276E+47j
		pop	esi
		leave
		retn
sub_1002276E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10022994	proc near		; CODE XREF: sub_10017C64+1E9p
					; sub_10017C64+206p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1002276E
		add	esp, 0Ch
		pop	ebp
		retn
sub_10022994	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100229AB	proc near		; CODE XREF: sub_10022B15+10p

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		xor	ebx, ebx
		cmp	[ebp+arg_8], ebx
		jnz	short loc_100229C2
		xor	eax, eax
		jmp	loc_10022A9A
; ---------------------------------------------------------------------------

loc_100229C2:				; CODE XREF: sub_100229AB+Ej
		push	edi
		push	[ebp+arg_C]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	edi, [ebp+var_C]
		cmp	[edi+8], ebx
		jnz	short loc_100229FC
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1001CFAA
		add	esp, 0Ch
		cmp	[ebp+var_4], bl
		jz	loc_10022A99
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	loc_10022A99
; ---------------------------------------------------------------------------

loc_100229FC:				; CODE XREF: sub_100229AB+29j
		cmp	[ebp+arg_0], ebx
		jnz	short loc_10022A2C
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10022A25
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10022A25:				; CODE XREF: sub_100229AB+71j
		mov	eax, 7FFFFFFFh
		jmp	short loc_10022A99
; ---------------------------------------------------------------------------

loc_10022A2C:				; CODE XREF: sub_100229AB+54j
		push	esi
		mov	esi, [ebp+arg_4]
		cmp	esi, ebx
		jnz	short loc_10022A5F
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10022A58
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10022A58:				; CODE XREF: sub_100229AB+A4j
		mov	eax, 7FFFFFFFh
		jmp	short loc_10022A98
; ---------------------------------------------------------------------------

loc_10022A5F:				; CODE XREF: sub_100229AB+87j
					; sub_100229AB+14Ej
		mov	eax, [ebp+arg_0]
		movzx	ax, byte ptr [eax]
		dec	[ebp+arg_8]
		inc	[ebp+arg_0]
		movzx	ecx, ax
		movzx	eax, cl
		test	byte ptr [eax+edi+1Dh],	4
		jz	short loc_10022ABA
		cmp	[ebp+arg_8], ebx
		jnz	short loc_10022A9D
		movzx	eax, byte ptr [esi]
		xor	ecx, ecx
		test	byte ptr [eax+edi+1Dh],	4
		jz	short loc_10022AE9

loc_10022A8A:				; CODE XREF: sub_100229AB+149j
					; sub_100229AB+154j
		cmp	[ebp+var_4], bl
		jz	short loc_10022A96
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10022A96:				; CODE XREF: sub_100229AB+E2j
		xor	eax, eax

loc_10022A98:				; CODE XREF: sub_100229AB+B2j
					; sub_100229AB+15Fj ...
		pop	esi

loc_10022A99:				; CODE XREF: sub_100229AB+3Fj
					; sub_100229AB+4Cj ...
		pop	edi

loc_10022A9A:				; CODE XREF: sub_100229AB+12j
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_10022A9D:				; CODE XREF: sub_100229AB+D1j
		mov	eax, [ebp+arg_0]
		mov	al, [eax]
		cmp	al, bl
		jnz	short loc_10022AAA
		xor	ecx, ecx
		jmp	short loc_10022ABA
; ---------------------------------------------------------------------------

loc_10022AAA:				; CODE XREF: sub_100229AB+F9j
		shl	ecx, 8
		movzx	ax, al
		or	cx, ax
		inc	[ebp+arg_0]
		movzx	ecx, cx

loc_10022ABA:				; CODE XREF: sub_100229AB+CCj
					; sub_100229AB+FDj
		movzx	ax, byte ptr [esi]
		movzx	eax, ax
		movzx	edx, al
		inc	esi
		test	byte ptr [edx+edi+1Dh],	4
		jz	short loc_10022AEC
		cmp	[ebp+arg_8], ebx
		jnz	short loc_10022AD5

loc_10022AD1:				; CODE XREF: sub_100229AB+131j
		xor	eax, eax
		jmp	short loc_10022AEC
; ---------------------------------------------------------------------------

loc_10022AD5:				; CODE XREF: sub_100229AB+124j
		mov	dl, [esi]
		dec	[ebp+arg_8]
		cmp	dl, bl
		jz	short loc_10022AD1
		movzx	dx, dl
		shl	eax, 8
		or	ax, dx
		inc	esi

loc_10022AE9:				; CODE XREF: sub_100229AB+DDj
		movzx	eax, ax

loc_10022AEC:				; CODE XREF: sub_100229AB+11Fj
					; sub_100229AB+128j
		cmp	ax, cx
		jnz	short loc_10022B01
		cmp	cx, bx
		jz	short loc_10022A8A
		cmp	[ebp+arg_8], ebx
		jnz	loc_10022A5F
		jmp	short loc_10022A8A
; ---------------------------------------------------------------------------

loc_10022B01:				; CODE XREF: sub_100229AB+144j
		sbb	eax, eax
		and	eax, 2
		dec	eax
		cmp	[ebp+var_4], bl
		jz	short loc_10022A98
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	short loc_10022A98
sub_100229AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10022B15	proc near		; CODE XREF: sub_10017C64+1D4p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100229AB
		add	esp, 10h
		pop	ebp
		retn
sub_10022B15	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		push	ebp
		push	0
		push	0
		push	offset loc_10022B48
		push	dword ptr [ebp+8]
		call	RtlUnwind

loc_10022B48:				; DATA XREF: .text:10022B3Bo
		pop	ebp
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10022B50	proc near		; DATA XREF: sub_10022B95+Bo
					; .text:10022C22o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	ecx, [esp+arg_0]
		test	dword ptr [ecx+4], 6
		mov	eax, 1
		jz	short locret_10022B94
		mov	eax, [esp+arg_10]
		mov	ecx, [eax-4]
		xor	ecx, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		push	ebp
		mov	ebp, [eax+10h]
		mov	edx, [eax+28h]
		push	edx
		mov	edx, [eax+24h]
		push	edx
		call	sub_10022B95
		add	esp, 8
		pop	ebp
		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_C]
		mov	[edx], eax
		mov	eax, 3

locret_10022B94:			; CODE XREF: sub_10022B50+10j
		retn
sub_10022B50	endp


; =============== S U B	R O U T	I N E =======================================


sub_10022B95	proc near		; CODE XREF: sub_10022B50+2Cp

var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		push	edi
		mov	eax, [esp+0Ch+arg_0]
		push	ebp
		push	eax
		push	0FFFFFFFEh
		push	offset sub_10022B50
		push	large dword ptr	fs:0
		mov	eax, ___security_cookie
		xor	eax, esp
		push	eax
		lea	eax, [esp+24h+var_20]
		mov	large fs:0, eax

loc_10022BBE:				; CODE XREF: sub_10022B95:loc_10022C05j
		mov	eax, [esp+24h+arg_0]
		mov	ebx, [eax+8]
		mov	esi, [eax+0Ch]
		cmp	esi, 0FFFFFFFFh
		jz	short loc_10022C07
		cmp	[esp+24h+arg_4], 0FFFFFFFFh
		jz	short loc_10022BDA
		cmp	esi, [esp+24h+arg_4]
		jbe	short loc_10022C07

loc_10022BDA:				; CODE XREF: sub_10022B95+3Dj
		lea	esi, [esi+esi*2]
		mov	ecx, [ebx+esi*4]
		mov	[esp+24h+var_18], ecx
		mov	[eax+0Ch], ecx
		cmp	dword ptr [ebx+esi*4+4], 0
		jnz	short loc_10022C05
		push	101h
		mov	eax, [ebx+esi*4+8]
		call	sub_10022C45
		mov	eax, [ebx+esi*4+8]
		call	sub_10022C64

loc_10022C05:				; CODE XREF: sub_10022B95+57j
		jmp	short loc_10022BBE
; ---------------------------------------------------------------------------

loc_10022C07:				; CODE XREF: sub_10022B95+36j
					; sub_10022B95+43j
		mov	ecx, [esp+24h+var_20]
		mov	large fs:0, ecx
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10022B95	endp

; ---------------------------------------------------------------------------
		xor	eax, eax
		mov	ecx, large fs:0
		cmp	dword ptr [ecx+4], offset sub_10022B50
		jnz	short locret_10022C3B
		mov	edx, [ecx+0Ch]
		mov	edx, [edx+0Ch]
		cmp	[ecx+8], edx
		jnz	short locret_10022C3B
		mov	eax, 1

locret_10022C3B:			; CODE XREF: .text:10022C29j
					; .text:10022C34j
		retn
; ---------------------------------------------------------------------------
		push	ebx
		push	ecx
		mov	ebx, offset dword_1002E2B0
		jmp	short loc_10022C50

; =============== S U B	R O U T	I N E =======================================


sub_10022C45	proc near		; CODE XREF: sub_10018030+6Ep
					; sub_10018139+8p ...

arg_0		= dword	ptr  4

		push	ebx
		push	ecx
		mov	ebx, offset dword_1002E2B0
		mov	ecx, [esp+8+arg_0]

loc_10022C50:				; CODE XREF: .text:10022C43j
		mov	[ebx+8], ecx
		mov	[ebx+4], eax
		mov	[ebx+0Ch], ebp
		push	ebp
		push	ecx
		push	eax
		pop	eax
		pop	ecx
		pop	ebp
		pop	ecx
		pop	ebx
		retn	4
sub_10022C45	endp


; =============== S U B	R O U T	I N E =======================================


sub_10022C64	proc near		; CODE XREF: sub_10018030+7Bp
					; sub_10022B95+6Bp
		call	eax
		retn
sub_10022C64	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10022C67(__int16 Buffer)
sub_10022C67	proc near		; CODE XREF: sub_1001829F+5Bp
					; sub_1001838C+2F5p ...

NumberOfCharsWritten= dword ptr	-10h
MultiByteStr	= byte ptr -0Ch
var_4		= dword	ptr -4
Buffer		= word ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		xor	esi, esi
		cmp	dword_1002E2C0,	esi
		jz	short loc_10022CD3
		cmp	hObject, 0FFFFFFFEh
		jnz	short loc_10022C92
		call	sub_10018253

loc_10022C92:				; CODE XREF: sub_10022C67+24j
		mov	eax, hObject
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10022CA3

loc_10022C9C:				; CODE XREF: sub_10022C67+59j
					; sub_10022C67+64j ...
		mov	eax, 0FFFFh
		jmp	short loc_10022D13
; ---------------------------------------------------------------------------

loc_10022CA3:				; CODE XREF: sub_10022C67+33j
		push	esi		; lpReserved
		lea	ecx, [ebp+NumberOfCharsWritten]
		push	ecx		; lpNumberOfCharsWritten
		push	1		; nNumberOfCharsToWrite
		lea	ecx, [ebp+Buffer]
		push	ecx		; lpBuffer
		push	eax		; hConsoleOutput
		call	ds:WriteConsoleW
		test	eax, eax
		jnz	short loc_10022D20
		cmp	dword_1002E2C0,	2
		jnz	short loc_10022C9C
		call	ds:GetLastError
		cmp	eax, 78h
		jnz	short loc_10022C9C
		mov	dword_1002E2C0,	esi

loc_10022CD3:				; CODE XREF: sub_10022C67+1Bj
		push	esi		; lpUsedDefaultChar
		push	esi		; lpDefaultChar
		push	5		; cbMultiByte
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpMultiByteStr
		push	1		; cchWideChar
		lea	eax, [ebp+Buffer]
		push	eax		; lpWideCharStr
		push	esi		; dwFlags
		call	ds:GetConsoleOutputCP
		push	eax		; CodePage
		call	ds:WideCharToMultiByte
		mov	ecx, hObject
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10022C9C
		push	esi		; lpReserved
		lea	edx, [ebp+NumberOfCharsWritten]
		push	edx		; lpNumberOfCharsWritten
		push	eax		; nNumberOfCharsToWrite
		lea	eax, [ebp+MultiByteStr]
		push	eax		; lpBuffer
		push	ecx		; hConsoleOutput
		call	ds:WriteConsoleA
		test	eax, eax
		jz	short loc_10022C9C

loc_10022D0F:				; CODE XREF: sub_10022C67+C3j
		mov	ax, [ebp+Buffer]

loc_10022D13:				; CODE XREF: sub_10022C67+3Aj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
; ---------------------------------------------------------------------------

loc_10022D20:				; CODE XREF: sub_10022C67+50j
		mov	dword_1002E2C0,	1
		jmp	short loc_10022D0F
sub_10022C67	endp

; ---------------------------------------------------------------------------
		push	10h
		push	offset dword_1002B918
		call	__SEH_prolog4
		xor	esi, esi
		mov	[ebp-20h], esi
		xor	eax, eax
		cmp	[ebp+8], esi
		setnz	al
		cmp	eax, esi
		jnz	short loc_10022D6D
		call	sub_10014C05
		mov	[eax], esi
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_10022DC7
; ---------------------------------------------------------------------------

loc_10022D6D:				; CODE XREF: .text:10022D47j
		mov	eax, [ebp+8]
		lea	edx, [eax+2]

loc_10022D73:				; CODE XREF: .text:10022D7Bj
		mov	cx, [eax]
		inc	eax
		inc	eax
		cmp	cx, si
		jnz	short loc_10022D73
		sub	eax, edx
		sar	eax, 1
		mov	[ebp-1Ch], eax
		push	3
		call	sub_100152C7
		pop	ecx
		mov	[ebp-4], esi

loc_10022D8F:				; CODE XREF: .text:10022DB2j
		mov	eax, [ebp-1Ch]
		dec	dword ptr [ebp-1Ch]
		test	eax, eax
		jz	short loc_10022DB8
		mov	eax, [ebp+8]
		movzx	eax, word ptr [eax]
		add	dword ptr [ebp+8], 2
		push	eax
		call	sub_10022C67
		pop	ecx
		mov	ecx, 0FFFFh
		cmp	ax, cx
		jnz	short loc_10022D8F
		or	dword ptr [ebp-20h], 0FFFFFFFFh

loc_10022DB8:				; CODE XREF: .text:10022D97j
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10022DCD
		mov	eax, [ebp-20h]

loc_10022DC7:				; CODE XREF: .text:10022D6Bj
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10022DCD	proc near		; CODE XREF: .text:10022DBFp
					; DATA XREF: .rdata:1002B930o
		push	3
		call	sub_100151D0
		pop	ecx
		retn
sub_10022DCD	endp

; ---------------------------------------------------------------------------
		push	0Ch
		push	offset dword_1002B938
		call	__SEH_prolog4
		push	3
		call	sub_100152C7
		pop	ecx
		and	dword ptr [ebp-4], 0
		push	dword ptr [ebp+8]
		call	sub_10022C67
		pop	ecx
		movzx	eax, ax
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10022E13
		mov	ax, [ebp-1Ch]
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10022E13	proc near		; CODE XREF: .text:10022E04p
					; DATA XREF: .rdata:1002B950o
		push	3
		call	sub_100151D0
		pop	ecx
		retn
sub_10022E13	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10022E1C(LPWSTR lpWideCharStr, LPCSTR	lpMultiByteStr,	int, int)
sub_10022E1C	proc near		; CODE XREF: sub_10022F33+10p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
lpWideCharStr	= dword	ptr  8
lpMultiByteStr	= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	esi
		mov	esi, [ebp+lpMultiByteStr]
		xor	ebx, ebx
		cmp	esi, ebx
		jz	short loc_10022E44
		cmp	[ebp+arg_8], ebx
		jz	short loc_10022E44
		cmp	[esi], bl
		jnz	short loc_10022E4A
		mov	eax, [ebp+lpWideCharStr]
		cmp	eax, ebx
		jz	short loc_10022E44
		xor	ecx, ecx
		mov	[eax], cx

loc_10022E44:				; CODE XREF: sub_10022E1C+11j
					; sub_10022E1C+16j ...
		xor	eax, eax

loc_10022E46:				; CODE XREF: sub_10022E1C+5Ej
					; sub_10022E1C+BFj ...
		pop	esi
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_10022E4A:				; CODE XREF: sub_10022E1C+1Aj
		push	[ebp+arg_C]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_10]
		cmp	[eax+14h], ebx
		jnz	short loc_10022E7C
		mov	eax, [ebp+lpWideCharStr]
		cmp	eax, ebx
		jz	short loc_10022E6B
		movzx	cx, byte ptr [esi]
		mov	[eax], cx

loc_10022E6B:				; CODE XREF: sub_10022E1C+46j
					; sub_10022E1C+10Fj
		cmp	[ebp+var_4], bl
		jz	short loc_10022E77
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10022E77:				; CODE XREF: sub_10022E1C+52j
		xor	eax, eax
		inc	eax
		jmp	short loc_10022E46
; ---------------------------------------------------------------------------

loc_10022E7C:				; CODE XREF: sub_10022E1C+3Fj
		lea	eax, [ebp+var_10]
		push	eax
		movzx	eax, byte ptr [esi]
		push	eax
		call	sub_100175C6
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10022F0C
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+0ACh]
		cmp	ecx, 1
		jle	short loc_10022EC2
		cmp	[ebp+arg_8], ecx
		jl	short loc_10022EC2
		xor	edx, edx
		cmp	[ebp+lpWideCharStr], ebx
		setnz	dl
		push	edx		; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		push	ecx		; cbMultiByte
		push	esi		; lpMultiByteStr
		push	9		; dwFlags
		push	dword ptr [eax+4] ; CodePage
		call	ds:MultiByteToWideChar
		test	eax, eax
		mov	eax, [ebp+var_10]
		jnz	short loc_10022ED2

loc_10022EC2:				; CODE XREF: sub_10022E1C+7Fj
					; sub_10022E1C+84j
		mov	ecx, [ebp+arg_8]
		cmp	ecx, [eax+0ACh]
		jb	short loc_10022EED
		cmp	[esi+1], bl
		jz	short loc_10022EED

loc_10022ED2:				; CODE XREF: sub_10022E1C+A4j
		mov	eax, [eax+0ACh]
		cmp	[ebp+var_4], bl
		jz	loc_10022E46
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	loc_10022E46
; ---------------------------------------------------------------------------

loc_10022EED:				; CODE XREF: sub_10022E1C+AFj
					; sub_10022E1C+B4j ...
		call	sub_10014BF2
		mov	dword ptr [eax], 2Ah
		cmp	[ebp+var_4], bl
		jz	short loc_10022F04
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10022F04:				; CODE XREF: sub_10022E1C+DFj
		or	eax, 0FFFFFFFFh
		jmp	loc_10022E46
; ---------------------------------------------------------------------------

loc_10022F0C:				; CODE XREF: sub_10022E1C+71j
		xor	eax, eax
		cmp	[ebp+lpWideCharStr], ebx
		setnz	al
		push	eax		; cchWideChar
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		mov	eax, [ebp+var_10]
		push	1		; cbMultiByte
		push	esi		; lpMultiByteStr
		push	9		; dwFlags
		push	dword ptr [eax+4] ; CodePage
		call	ds:MultiByteToWideChar
		test	eax, eax
		jnz	loc_10022E6B
		jmp	short loc_10022EED
sub_10022E1C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10022F33(LPWSTR lpWideCharStr, LPCSTR	lpMultiByteStr,	int)
sub_10022F33	proc near		; CODE XREF: sub_1001829F+4Bp
					; sub_1001838C+1AEp ...

lpWideCharStr	= dword	ptr  8
lpMultiByteStr	= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0		; int
		push	[ebp+arg_8]	; int
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	[ebp+lpWideCharStr] ; lpWideCharStr
		call	sub_10022E1C
		add	esp, 10h
		pop	ebp
		retn
sub_10022F33	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	dword_1002E2E4,	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	dword_1002E2E8,	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	dword_1002E2E0,	eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10022F7A	proc near		; CODE XREF: sub_100236AF+29p
					; .text:10023716p

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
CodePage	= dword	ptr -30h
UsedDefaultChar	= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

; FUNCTION CHUNK AT 10023253 SIZE 0000008D BYTES

		push	2Ch
		push	offset stru_1002B958
		call	__SEH_prolog4
		xor	ebx, ebx
		mov	[ebp+var_38], ebx
		mov	[ebp+var_28], ebx
		mov	[ebp+var_1C], ebx
		mov	[ebp+var_20], ebx
		mov	[ebp+var_24], ebx
		mov	[ebp+var_34], ebx
		push	7
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		mov	[ebp+var_34], offset lpMultiByteStr
		lea	eax, [ebp+var_1C]
		push	eax
		call	sub_100237E9
		pop	ecx
		cmp	eax, ebx
		jz	short loc_10022FC7
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10022FC7:				; CODE XREF: sub_10022F7A+3Ej
		lea	eax, [ebp+var_20]
		push	eax
		call	sub_10023777
		pop	ecx
		cmp	eax, ebx
		jz	short loc_10022FE2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10022FE2:				; CODE XREF: sub_10022F7A+59j
		lea	eax, [ebp+var_24]
		push	eax
		call	sub_100237B0
		pop	ecx
		cmp	eax, ebx
		jz	short loc_10022FFD
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10022FFD:				; CODE XREF: sub_10022F7A+74j
		call	sub_1001B50E
		mov	[ebp+CodePage],	eax
		mov	dword_1002F044,	ebx
		or	edi, 0FFFFFFFFh
		mov	dword_1002E2D0,	edi
		mov	dword_1002E2C4,	edi
		push	offset aTz	; "TZ"
		call	sub_1000F68E
		pop	ecx
		mov	esi, eax
		mov	[ebp+var_3C], esi
		cmp	esi, ebx
		jz	loc_100230D3
		cmp	[esi], bl
		jz	loc_100230D3
		mov	edi, dword_1002F048
		cmp	edi, ebx
		jz	short loc_1002307C
		mov	ecx, edi

loc_10023046:				; CODE XREF: sub_10022F7A+E4j
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10023064
		cmp	dl, bl
		jz	short loc_10023060
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10023064
		inc	eax
		inc	eax
		inc	ecx
		inc	ecx
		cmp	dl, bl
		jnz	short loc_10023046

loc_10023060:				; CODE XREF: sub_10022F7A+D4j
		xor	eax, eax
		jmp	short loc_10023069
; ---------------------------------------------------------------------------

loc_10023064:				; CODE XREF: sub_10022F7A+D0j
					; sub_10022F7A+DCj
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10023069:				; CODE XREF: sub_10022F7A+E8j
		cmp	eax, ebx
		jz	loc_100231BD
		cmp	edi, ebx
		jz	short loc_1002307C
		push	edi		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_1002307C:				; CODE XREF: sub_10022F7A+C8j
					; sub_10022F7A+F9j
		mov	eax, esi
		lea	edx, [eax+1]

loc_10023081:				; CODE XREF: sub_10022F7A+10Cj
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10023081
		sub	eax, edx
		inc	eax
		push	eax
		call	sub_1000F5A0
		pop	ecx
		mov	dword_1002F048,	eax
		cmp	eax, ebx
		jz	loc_100231BD
		mov	ecx, esi
		lea	edi, [ecx+1]

loc_100230A4:				; CODE XREF: sub_10022F7A+12Fj
		mov	dl, [ecx]
		inc	ecx
		cmp	dl, bl
		jnz	short loc_100230A4
		sub	ecx, edi
		push	esi
		inc	ecx
		push	ecx
		push	eax
		call	sub_10016B60
		add	esp, 0Ch
		cmp	eax, ebx
		jz	loc_100231C4
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h
		jmp	loc_100231C4
; ---------------------------------------------------------------------------

loc_100230D3:				; CODE XREF: sub_10022F7A+B2j
					; sub_10022F7A+BAj
		mov	eax, dword_1002F048
		cmp	eax, ebx
		jz	short loc_100230E9
		push	eax		; lpMem
		call	sub_1000EE73
		pop	ecx
		mov	dword_1002F048,	ebx

loc_100230E9:				; CODE XREF: sub_10022F7A+160j
		push	offset TimeZoneInformation ; lpTimeZoneInformation
		call	ds:GetTimeZoneInformation
		cmp	eax, edi
		jz	loc_100231BD
		xor	ecx, ecx
		inc	ecx
		mov	dword_1002F044,	ecx
		mov	eax, TimeZoneInformation.Bias
		imul	eax, 3Ch
		mov	[ebp+var_1C], eax
		cmp	TimeZoneInformation.StandardDate.wMonth, bx
		jz	short loc_10023127
		mov	edx, TimeZoneInformation.StandardBias
		imul	edx, 3Ch
		add	eax, edx
		mov	[ebp+var_1C], eax

loc_10023127:				; CODE XREF: sub_10022F7A+19Dj
		cmp	TimeZoneInformation.DaylightDate.wMonth, bx
		jz	short loc_1002314A
		mov	eax, TimeZoneInformation.DaylightBias
		cmp	eax, ebx
		jz	short loc_1002314A
		mov	[ebp+var_20], ecx
		sub	eax, TimeZoneInformation.StandardBias
		imul	eax, 3Ch
		mov	[ebp+var_24], eax
		jmp	short loc_10023150
; ---------------------------------------------------------------------------

loc_1002314A:				; CODE XREF: sub_10022F7A+1B4j
					; sub_10022F7A+1BDj
		mov	[ebp+var_20], ebx
		mov	[ebp+var_24], ebx

loc_10023150:				; CODE XREF: sub_10022F7A+1CEj
		lea	eax, [ebp+UsedDefaultChar]
		push	eax		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	3Fh		; cbMultiByte
		push	lpMultiByteStr	; lpMultiByteStr
		push	edi		; cchWideChar
		push	offset TimeZoneInformation.StandardName	; lpWideCharStr
		push	ebx		; dwFlags
		push	[ebp+CodePage]	; CodePage
		mov	edi, ds:WideCharToMultiByte
		call	edi ; WideCharToMultiByte
		test	eax, eax
		jz	short loc_10023182
		cmp	[ebp+UsedDefaultChar], ebx
		jnz	short loc_10023182
		mov	eax, lpMultiByteStr
		mov	[eax+3Fh], bl
		jmp	short loc_10023189
; ---------------------------------------------------------------------------

loc_10023182:				; CODE XREF: sub_10022F7A+1F7j
					; sub_10022F7A+1FCj
		mov	eax, lpMultiByteStr
		mov	[eax], bl

loc_10023189:				; CODE XREF: sub_10022F7A+206j
		lea	eax, [ebp+UsedDefaultChar]
		push	eax		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	3Fh		; cbMultiByte
		push	off_1002E374	; lpMultiByteStr
		push	0FFFFFFFFh	; cchWideChar
		push	offset TimeZoneInformation.DaylightName	; lpWideCharStr
		push	ebx		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	edi ; WideCharToMultiByte
		test	eax, eax
		jz	short loc_100231B6
		cmp	[ebp+UsedDefaultChar], ebx
		jnz	short loc_100231B6
		mov	eax, off_1002E374
		mov	[eax+3Fh], bl
		jmp	short loc_100231BD
; ---------------------------------------------------------------------------

loc_100231B6:				; CODE XREF: sub_10022F7A+22Bj
					; sub_10022F7A+230j
		mov	eax, off_1002E374
		mov	[eax], bl

loc_100231BD:				; CODE XREF: sub_10022F7A+F1j
					; sub_10022F7A+11Fj ...
		mov	[ebp+var_28], 1

loc_100231C4:				; CODE XREF: sub_10022F7A+141j
					; sub_10022F7A+154j
		mov	eax, [ebp+var_1C]
		mov	dword_1002E2E0,	eax
		mov	eax, [ebp+var_20]
		mov	dword_1002E2E4,	eax
		mov	eax, [ebp+var_24]
		mov	dword_1002E2E8,	eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1002324A
; ---------------------------------------------------------------------------

loc_100231E8:				; CODE XREF: sub_10022F7A+2D8j
		cmp	[ebp+var_28], ebx
		jnz	loc_100232DA
		push	3
		push	esi
		push	40h
		mov	edi, [ebp+var_34]
		push	dword ptr [edi]
		call	sub_10016DF1
		add	esp, 10h
		test	eax, eax
		jz	short loc_10023214
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_10023214:				; CODE XREF: sub_10022F7A+28Bj
		add	esi, 3
		cmp	byte ptr [esi],	2Dh
		jnz	short loc_10023224
		mov	[ebp+var_38], 1
		inc	esi

loc_10023224:				; CODE XREF: sub_10022F7A+2A0j
		push	esi
		call	sub_10011024
		pop	ecx
		imul	eax, 0E10h
		mov	[ebp+var_1C], eax

loc_10023234:				; CODE XREF: sub_10022F7A+2C9j
		mov	al, [esi]
		cmp	al, 2Bh
		jz	short loc_10023242
		cmp	al, 30h
		jl	short loc_10023253
		cmp	al, 39h
		jg	short loc_10023253

loc_10023242:				; CODE XREF: sub_10022F7A+2BEj
		inc	esi
		jmp	short loc_10023234
; ---------------------------------------------------------------------------

loc_10023245:				; DATA XREF: .rdata:stru_1002B958o
		xor	ebx, ebx	; Finally handler 0 for	function 10022F7A
		mov	esi, [ebp+var_3C]

loc_1002324A:				; CODE XREF: sub_10022F7A+269j
		push	7
		call	sub_100151D0
		pop	ecx
		retn
sub_10022F7A	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10022F7A

loc_10023253:				; CODE XREF: sub_10022F7A+2C2j
					; sub_10022F7A+2C6j
		cmp	byte ptr [esi],	3Ah
		jnz	short loc_10023290
		inc	esi
		push	esi
		call	sub_10011024
		pop	ecx
		imul	eax, 3Ch
		add	[ebp+var_1C], eax
		jmp	short loc_1002326D
; ---------------------------------------------------------------------------

loc_10023268:				; CODE XREF: sub_10022F7A+2F7j
		cmp	al, 39h
		jg	short loc_10023273
		inc	esi

loc_1002326D:				; CODE XREF: sub_10022F7A+2ECj
		mov	al, [esi]
		cmp	al, 30h
		jge	short loc_10023268

loc_10023273:				; CODE XREF: sub_10022F7A+2F0j
		cmp	byte ptr [esi],	3Ah
		jnz	short loc_10023290
		inc	esi
		push	esi
		call	sub_10011024
		pop	ecx
		add	[ebp+var_1C], eax
		jmp	short loc_1002328A
; ---------------------------------------------------------------------------

loc_10023285:				; CODE XREF: sub_10022F7A+314j
		cmp	al, 39h
		jg	short loc_10023290
		inc	esi

loc_1002328A:				; CODE XREF: sub_10022F7A+309j
		mov	al, [esi]
		cmp	al, 30h
		jge	short loc_10023285

loc_10023290:				; CODE XREF: sub_10022F7A+2DCj
					; sub_10022F7A+2FCj ...
		cmp	[ebp+var_38], ebx
		jz	short loc_10023298
		neg	[ebp+var_1C]

loc_10023298:				; CODE XREF: sub_10022F7A+319j
		movsx	eax, byte ptr [esi]
		mov	[ebp+var_20], eax
		cmp	eax, ebx
		jz	short loc_100232C5
		push	3
		push	esi
		push	40h
		push	dword ptr [edi+4]
		call	sub_10016DF1
		add	esp, 10h
		test	eax, eax
		jz	short loc_100232CA
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h
		jmp	short loc_100232CA
; ---------------------------------------------------------------------------

loc_100232C5:				; CODE XREF: sub_10022F7A+326j
		mov	eax, [edi+4]
		mov	[eax], bl

loc_100232CA:				; CODE XREF: sub_10022F7A+33Aj
					; sub_10022F7A+349j
		mov	eax, [ebp+var_1C]
		mov	dword_1002E2E0,	eax
		mov	eax, [ebp+var_20]
		mov	dword_1002E2E4,	eax

loc_100232DA:				; CODE XREF: sub_10022F7A+271j
		call	__SEH_epilog4
		retn
; END OF FUNCTION CHUNK	FOR sub_10022F7A

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100232E0	proc near		; CODE XREF: sub_100234D7+ADp
					; sub_100234D7+10Ap ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		and	[ebp+var_4], 0
		cmp	[ebp+arg_4], 1
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_8]
		mov	esi, eax
		mov	eax, edi
		jnz	loc_100233F9
		and	eax, 80000003h
		jns	short loc_1002330C
		dec	eax
		or	eax, 0FFFFFFFCh
		inc	eax

loc_1002330C:				; CODE XREF: sub_100232E0+25j
		mov	[ebp+var_C], eax
		jnz	short loc_1002331D
		mov	eax, edi
		push	64h
		cdq
		pop	ebx
		idiv	ebx
		test	edx, edx
		jnz	short loc_1002333C

loc_1002331D:				; CODE XREF: sub_100232E0+2Fj
		lea	eax, [edi+76Ch]
		cdq
		mov	ebx, 190h
		idiv	ebx
		test	edx, edx
		jz	short loc_1002333C
		mov	eax, esi
		shl	eax, 2
		mov	esi, dword_1002E3A8[eax]
		jmp	short loc_10023347
; ---------------------------------------------------------------------------

loc_1002333C:				; CODE XREF: sub_100232E0+3Bj
					; sub_100232E0+4Dj
		mov	eax, esi
		shl	eax, 2
		mov	esi, off_1002E374[eax]

loc_10023347:				; CODE XREF: sub_100232E0+5Aj
		mov	[ebp+arg_4], eax
		lea	eax, [edi+12Bh]
		cdq
		lea	ebx, [edi-1]
		mov	edi, 190h
		idiv	edi
		push	64h
		pop	edi
		inc	esi
		push	7
		mov	[ebp+var_8], eax
		mov	eax, ebx
		cdq
		idiv	edi
		mov	edx, [ebp+var_8]
		mov	edi, [ebp+arg_8]
		sub	edx, eax
		mov	ebx, edx
		lea	eax, [edi-1]
		cdq
		and	edx, 3
		add	eax, edx
		sar	eax, 2
		mov	edx, edi
		imul	edx, 16Dh
		add	eax, esi
		add	eax, ebx
		lea	eax, [edx+eax-63DBh]
		cdq
		pop	ebx
		idiv	ebx
		mov	eax, [ebp+arg_C]
		imul	eax, 7
		sub	eax, edx
		add	eax, [ebp+arg_10]
		cmp	edx, [ebp+arg_10]
		jg	short loc_100233AC
		lea	esi, [esi+eax-7]
		jmp	short loc_100233AE
; ---------------------------------------------------------------------------

loc_100233AC:				; CODE XREF: sub_100232E0+C4j
		add	esi, eax

loc_100233AE:				; CODE XREF: sub_100232E0+CAj
		cmp	[ebp+arg_C], 5
		jnz	loc_10023438
		cmp	[ebp+var_C], 0
		jnz	short loc_100233CA
		mov	eax, edi
		push	64h
		cdq
		pop	ebx
		idiv	ebx
		test	edx, edx
		jnz	short loc_100233E7

loc_100233CA:				; CODE XREF: sub_100232E0+DCj
		lea	eax, [edi+76Ch]
		cdq
		mov	ebx, 190h
		idiv	ebx
		test	edx, edx
		jz	short loc_100233E7
		mov	eax, [ebp+arg_4]
		mov	eax, dword_1002E3AC[eax]
		jmp	short loc_100233F0
; ---------------------------------------------------------------------------

loc_100233E7:				; CODE XREF: sub_100232E0+E8j
					; sub_100232E0+FAj
		mov	eax, [ebp+arg_4]
		mov	eax, dword_1002E378[eax]

loc_100233F0:				; CODE XREF: sub_100232E0+105j
		cmp	esi, eax
		jle	short loc_10023438
		sub	esi, 7
		jmp	short loc_10023438
; ---------------------------------------------------------------------------

loc_100233F9:				; CODE XREF: sub_100232E0+1Aj
		and	eax, 80000003h
		jns	short loc_10023405
		dec	eax
		or	eax, 0FFFFFFFCh
		inc	eax

loc_10023405:				; CODE XREF: sub_100232E0+11Ej
		jnz	short loc_10023413
		mov	eax, edi
		push	64h
		cdq
		pop	ebx
		idiv	ebx
		test	edx, edx
		jnz	short loc_1002342E

loc_10023413:				; CODE XREF: sub_100232E0:loc_10023405j
		lea	eax, [edi+76Ch]
		cdq
		mov	ebx, 190h
		idiv	ebx
		test	edx, edx
		jz	short loc_1002342E
		mov	esi, dword_1002E3A8[esi*4]
		jmp	short loc_10023435
; ---------------------------------------------------------------------------

loc_1002342E:				; CODE XREF: sub_100232E0+131j
					; sub_100232E0+143j
		mov	esi, off_1002E374[esi*4]

loc_10023435:				; CODE XREF: sub_100232E0+14Cj
		add	esi, [ebp+arg_14]

loc_10023438:				; CODE XREF: sub_100232E0+D2j
					; sub_100232E0+112j ...
		imul	ecx, 3Ch
		add	ecx, [ebp+arg_18]
		imul	ecx, 3Ch
		add	ecx, [ebp+arg_1C]
		imul	ecx, 3E8h
		add	ecx, [ebp+arg_20]
		cmp	[ebp+arg_0], 1
		jnz	short loc_10023467
		mov	dword_1002E2C8,	esi
		mov	dword_1002E2CC,	ecx
		mov	dword_1002E2C4,	edi
		jmp	short loc_100234D2
; ---------------------------------------------------------------------------

loc_10023467:				; CODE XREF: sub_100232E0+171j
		lea	eax, [ebp+var_4]
		push	eax
		mov	dword_1002E2D4,	esi
		mov	dword_1002E2D8,	ecx
		call	sub_100237B0
		pop	ecx
		test	eax, eax
		jz	short loc_10023490
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014AB5
		add	esp, 14h

loc_10023490:				; CODE XREF: sub_100232E0+19Fj
		mov	eax, [ebp+var_4]
		imul	eax, 3E8h
		add	dword_1002E2D8,	eax
		jns	short loc_100234B3
		add	dword_1002E2D8,	5265C00h
		dec	dword_1002E2D4
		jmp	short loc_100234CC
; ---------------------------------------------------------------------------

loc_100234B3:				; CODE XREF: sub_100232E0+1BFj
		mov	eax, 5265C00h
		cmp	dword_1002E2D8,	eax
		jl	short loc_100234CC
		sub	dword_1002E2D8,	eax
		inc	dword_1002E2D4

loc_100234CC:				; CODE XREF: sub_100232E0+1D1j
					; sub_100232E0+1DEj
		mov	dword_1002E2D0,	edi

loc_100234D2:				; CODE XREF: sub_100232E0+185j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_100232E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100234D7	proc near		; CODE XREF: sub_10023736+1Bp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	esi
		lea	eax, [ebp+var_4]
		xor	esi, esi
		push	eax
		mov	[ebp+var_4], esi
		call	sub_10023777
		pop	ecx
		test	eax, eax
		jz	short loc_10023500
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014AB5
		add	esp, 14h

loc_10023500:				; CODE XREF: sub_100234D7+1Aj
		cmp	[ebp+var_4], esi
		jnz	short loc_1002350C
		xor	eax, eax
		jmp	loc_10023664
; ---------------------------------------------------------------------------

loc_1002350C:				; CODE XREF: sub_100234D7+2Cj
		mov	edx, [edi+14h]
		push	ebx
		xor	ebx, ebx
		inc	ebx
		cmp	edx, dword_1002E2C4
		jnz	short loc_10023527
		cmp	edx, dword_1002E2D0
		jz	loc_1002363F

loc_10023527:				; CODE XREF: sub_100234D7+42j
		cmp	dword_1002F044,	esi
		jz	loc_100235EB
		movzx	eax, TimeZoneInformation.DaylightDate.wMilliseconds
		movzx	ecx, TimeZoneInformation.DaylightDate.wHour
		push	eax
		movzx	eax, TimeZoneInformation.DaylightDate.wSecond
		push	eax
		movzx	eax, TimeZoneInformation.DaylightDate.wMinute
		push	eax
		cmp	TimeZoneInformation.DaylightDate.wYear,	si
		jnz	short loc_10023570
		movzx	eax, TimeZoneInformation.DaylightDate.wDayOfWeek
		push	esi
		push	eax
		movzx	eax, TimeZoneInformation.DaylightDate.wDay
		push	eax
		push	edx
		push	ebx
		jmp	short loc_1002357C
; ---------------------------------------------------------------------------

loc_10023570:				; CODE XREF: sub_100234D7+82j
		movzx	eax, TimeZoneInformation.DaylightDate.wDay
		push	eax
		push	esi
		push	esi
		push	edx
		push	esi

loc_1002357C:				; CODE XREF: sub_100234D7+97j
		movzx	eax, TimeZoneInformation.DaylightDate.wMonth
		push	ebx
		call	sub_100232E0
		movzx	eax, TimeZoneInformation.StandardDate.wMilliseconds
		movzx	ecx, TimeZoneInformation.StandardDate.wHour
		add	esp, 24h
		push	eax
		movzx	eax, TimeZoneInformation.StandardDate.wSecond
		push	eax
		movzx	eax, TimeZoneInformation.StandardDate.wMinute
		push	eax
		cmp	TimeZoneInformation.StandardDate.wYear,	si
		jnz	short loc_100235CB
		movzx	eax, TimeZoneInformation.StandardDate.wDayOfWeek
		push	esi
		push	eax
		movzx	eax, TimeZoneInformation.StandardDate.wDay
		push	eax
		push	dword ptr [edi+14h]
		push	ebx
		jmp	short loc_100235D9
; ---------------------------------------------------------------------------

loc_100235CB:				; CODE XREF: sub_100234D7+DBj
		movzx	eax, TimeZoneInformation.StandardDate.wDay
		push	eax
		push	esi
		push	esi
		push	dword ptr [edi+14h]
		push	esi

loc_100235D9:				; CODE XREF: sub_100234D7+F2j
		movzx	eax, TimeZoneInformation.StandardDate.wMonth
		push	esi
		call	sub_100232E0
		add	esp, 24h
		jmp	short loc_1002363F
; ---------------------------------------------------------------------------

loc_100235EB:				; CODE XREF: sub_100234D7+56j
		cmp	edx, 6Bh
		push	3
		pop	eax
		push	2
		pop	ecx
		mov	[ebp+var_C], 0Bh
		mov	[ebp+var_8], ebx
		jge	short loc_10023613
		push	4
		pop	eax
		mov	ecx, ebx
		mov	[ebp+var_C], 0Ah
		mov	[ebp+var_8], 5

loc_10023613:				; CODE XREF: sub_100234D7+127j
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		push	ecx
		push	edx
		push	ebx
		push	ebx
		push	2
		pop	ecx
		call	sub_100232E0
		mov	eax, [ebp+var_C]
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		push	[ebp+var_8]
		push	dword ptr [edi+14h]
		push	ebx
		push	esi
		push	2
		pop	ecx
		call	sub_100232E0
		add	esp, 48h

loc_1002363F:				; CODE XREF: sub_100234D7+4Aj
					; sub_100234D7+112j
		mov	ecx, dword_1002E2C8
		mov	eax, dword_1002E2D4
		cmp	ecx, eax
		mov	edx, [edi+1Ch]
		jge	short loc_10023667
		cmp	edx, ecx
		jl	short loc_10023677
		cmp	edx, eax
		jg	short loc_10023677
		cmp	edx, ecx
		jle	short loc_1002367B
		cmp	edx, eax
		jge	short loc_1002367B

loc_10023661:				; CODE XREF: sub_100234D7+192j
					; sub_100234D7+196j
		mov	eax, ebx

loc_10023663:				; CODE XREF: sub_100234D7+1A2j
					; sub_100234D7+1D6j
		pop	ebx

loc_10023664:				; CODE XREF: sub_100234D7+30j
		pop	esi
		leave
		retn
; ---------------------------------------------------------------------------

loc_10023667:				; CODE XREF: sub_100234D7+178j
		cmp	edx, eax
		jl	short loc_10023661
		cmp	edx, ecx
		jg	short loc_10023661
		cmp	edx, eax
		jle	short loc_1002367B
		cmp	edx, ecx
		jge	short loc_1002367B

loc_10023677:				; CODE XREF: sub_100234D7+17Cj
					; sub_100234D7+180j
		xor	eax, eax
		jmp	short loc_10023663
; ---------------------------------------------------------------------------

loc_1002367B:				; CODE XREF: sub_100234D7+184j
					; sub_100234D7+188j ...
		mov	eax, [edi+8]
		imul	eax, 3Ch
		add	eax, [edi+4]
		imul	eax, 3Ch
		add	eax, [edi]
		imul	eax, 3E8h
		cmp	edx, ecx
		jnz	short loc_100236A0
		xor	ecx, ecx
		cmp	eax, dword_1002E2CC
		setnl	cl
		jmp	short loc_100236AB
; ---------------------------------------------------------------------------

loc_100236A0:				; CODE XREF: sub_100234D7+1BAj
		xor	ecx, ecx
		cmp	eax, dword_1002E2D8
		setl	cl

loc_100236AB:				; CODE XREF: sub_100234D7+1C7j
		mov	eax, ecx
		jmp	short loc_10023663
sub_100234D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100236AF	proc near		; CODE XREF: sub_10019201+16Cp
					; sub_1001BC6C:loc_1001BF7Dp

ms_exc		= CPPEH_RECORD ptr -18h

		push	8
		push	offset stru_1002B978
		call	__SEH_prolog4
		xor	esi, esi
		cmp	dword_1002F04C,	esi
		jnz	short loc_100236EF
		push	6
		call	sub_100152C7
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], esi
		cmp	dword_1002F04C,	esi
		jnz	short loc_100236E3
		call	sub_10022F7A
		inc	dword_1002F04C

loc_100236E3:				; CODE XREF: sub_100236AF+27j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_100236F5	; Finally handler 0 for	function 100236AF
; ---------------------------------------------------------------------------

loc_100236EF:				; CODE XREF: sub_100236AF+14j
					; sub_100236AF+4Ej
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_100236F5:				; CODE XREF: sub_100236AF+3Bj
					; DATA XREF: .rdata:stru_1002B978o
		push	6		; Finally handler 0 for	function 100236AF
		call	sub_100151D0
		pop	ecx
		retn
sub_100236AF	endp

; ---------------------------------------------------------------------------
		push	8
		push	offset dword_1002B998
		call	__SEH_prolog4
		push	6
		call	sub_100152C7
		pop	ecx
		and	dword ptr [ebp-4], 0
		call	sub_10022F7A
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_1002372D
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_1002372D	proc near		; CODE XREF: .text:10023722p
					; DATA XREF: .rdata:1002B9B0o
		push	6
		call	sub_100151D0
		pop	ecx
		retn
sub_1002372D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023736	proc near		; CODE XREF: sub_10019201+200p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002B9B8
		call	__SEH_prolog4
		push	6
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	edi, [ebp+arg_0]
		call	sub_100234D7
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_1002376E	; Finally handler 0 for	function 10023736
; ---------------------------------------------------------------------------

loc_10023765:				; CODE XREF: sub_10023736+40j
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_1002376E:				; CODE XREF: sub_10023736+2Aj
					; DATA XREF: .rdata:stru_1002B9B8o
		push	6		; Finally handler 0 for	function 10023736
		call	sub_100151D0
		pop	ecx
		retn
sub_10023736	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023777	proc near		; CODE XREF: sub_10019201+175p
					; sub_10022F7A+51p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jnz	short loc_100237A3
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_100237AD
; ---------------------------------------------------------------------------

loc_100237A3:				; CODE XREF: sub_10023777+Dj
		mov	ecx, dword_1002E2E4
		mov	[eax], ecx
		xor	eax, eax

loc_100237AD:				; CODE XREF: sub_10023777+2Aj
		pop	esi
		pop	ebp
		retn
sub_10023777	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100237B0	proc near		; CODE XREF: sub_10019201+192p
					; sub_10022F7A+6Cp ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jnz	short loc_100237DC
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_100237E6
; ---------------------------------------------------------------------------

loc_100237DC:				; CODE XREF: sub_100237B0+Dj
		mov	ecx, dword_1002E2E8
		mov	[eax], ecx
		xor	eax, eax

loc_100237E6:				; CODE XREF: sub_100237B0+2Aj
		pop	esi
		pop	ebp
		retn
sub_100237B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100237E9	proc near		; CODE XREF: sub_10019201+1AFp
					; sub_10022F7A+36p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jnz	short loc_10023815
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_1002381F
; ---------------------------------------------------------------------------

loc_10023815:				; CODE XREF: sub_100237E9+Dj
		mov	ecx, dword_1002E2E0
		mov	[eax], ecx
		xor	eax, eax

loc_1002381F:				; CODE XREF: sub_100237E9+2Aj
		pop	esi
		pop	ebp
		retn
sub_100237E9	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+0Ch]
		push	ebx
		xor	ebx, ebx
		push	esi
		cmp	eax, ebx
		jz	short loc_10023854
		cmp	[ebp+10h], ebx
		ja	short loc_10023859

loc_10023837:				; CODE XREF: .text:10023857j
					; .text:10023864j ...
		call	sub_10014BF2
		push	16h
		pop	esi
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	[eax], esi
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, esi

loc_10023850:				; CODE XREF: .text:10023893j
					; .text:1002389Dj ...
		pop	esi
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10023854:				; CODE XREF: .text:10023830j
		cmp	[ebp+10h], ebx
		jnz	short loc_10023837

loc_10023859:				; CODE XREF: .text:10023835j
		cmp	eax, ebx
		jz	short loc_1002385F
		mov	[eax], bl

loc_1002385F:				; CODE XREF: .text:1002385Bj
		mov	ecx, [ebp+8]
		cmp	ecx, ebx
		jz	short loc_10023837
		mov	eax, [ebp+14h]
		cmp	eax, ebx
		jz	short loc_10023872
		cmp	eax, 1
		jnz	short loc_10023837

loc_10023872:				; CODE XREF: .text:1002386Bj
		lea	esi, lpMultiByteStr[eax*4]
		mov	eax, [esi]
		push	edi
		lea	edi, [eax+1]

loc_1002387F:				; CODE XREF: .text:10023884j
		mov	dl, [eax]
		inc	eax
		cmp	dl, bl
		jnz	short loc_1002387F
		sub	eax, edi
		inc	eax
		mov	[ecx], eax
		pop	edi
		cmp	[ebp+0Ch], ebx
		jnz	short loc_10023895
		xor	eax, eax
		jmp	short loc_10023850
; ---------------------------------------------------------------------------

loc_10023895:				; CODE XREF: .text:1002388Fj
		cmp	eax, [ebp+10h]
		jbe	short loc_1002389F
		push	22h
		pop	eax
		jmp	short loc_10023850
; ---------------------------------------------------------------------------

loc_1002389F:				; CODE XREF: .text:10023898j
		push	dword ptr [esi]
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		call	sub_10016B60
		add	esp, 0Ch
		jmp	short loc_10023850
; ---------------------------------------------------------------------------
		mov	eax, offset dword_1002E2E4
		retn
; ---------------------------------------------------------------------------
		mov	eax, offset dword_1002E2E8
		retn
; ---------------------------------------------------------------------------
		mov	eax, offset dword_1002E2E0
		retn
; ---------------------------------------------------------------------------
		mov	eax, offset lpMultiByteStr
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100238C9	proc near		; CODE XREF: .text:1002392Bp
					; .text:10023943p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		movzx	eax, [ebp+arg_4]
		mov	ecx, [ebp+var_C]
		mov	dl, [ebp+arg_C]
		test	[ecx+eax+1Dh], dl
		jnz	short loc_1002390A
		cmp	[ebp+arg_8], 0
		jz	short loc_10023904
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx+0C8h]
		movzx	eax, word ptr [ecx+eax*2]
		and	eax, [ebp+arg_8]
		jmp	short loc_10023906
; ---------------------------------------------------------------------------

loc_10023904:				; CODE XREF: sub_100238C9+27j
		xor	eax, eax

loc_10023906:				; CODE XREF: sub_100238C9+39j
		test	eax, eax
		jz	short loc_1002390D

loc_1002390A:				; CODE XREF: sub_100238C9+21j
		xor	eax, eax
		inc	eax

loc_1002390D:				; CODE XREF: sub_100238C9+3Fj
		cmp	[ebp+var_4], 0
		jz	short locret_1002391A
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1002391A:			; CODE XREF: sub_100238C9+48j
		leave
		retn
sub_100238C9	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1
		push	0
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1
		push	0
		push	dword ptr [ebp+8]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	3
		push	0
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	3
		push	0
		push	dword ptr [ebp+8]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	2
		push	0
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	2
		push	0
		push	dword ptr [ebp+8]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1
		push	107h
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1
		push	107h
		push	dword ptr [ebp+8]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1
		push	103h
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	1
		push	103h
		push	dword ptr [ebp+8]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	3
		push	117h
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	3
		push	117h
		push	dword ptr [ebp+8]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	3
		push	157h
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	3
		push	157h
		push	dword ptr [ebp+8]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	2
		push	10h
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	2
		push	10h
		push	dword ptr [ebp+8]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	4
		push	0
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023AD5	proc near		; CODE XREF: sub_1001974C+70p
					; sub_1001974C+16Dp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	4
		push	0
		push	[ebp+arg_0]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
sub_10023AD5	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	8
		push	0
		push	dword ptr [ebp+8]
		push	dword ptr [ebp+0Ch]
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	8
		push	0
		push	dword ptr [ebp+8]
		push	0
		call	sub_100238C9
		add	esp, 10h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023B1E	proc near		; CODE XREF: .text:10023B7Dp

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+var_C]
		test	eax, eax
		jz	short loc_10023B62
		cmp	dword ptr [eax+4], 3A4h
		jnz	short loc_10023B62
		push	3
		push	0
		push	[ebp+arg_0]
		push	[ebp+arg_4]
		call	sub_100238C9
		add	esp, 10h
		cmp	[ebp+var_4], 0
		jz	short locret_10023B71
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		leave
		retn
; ---------------------------------------------------------------------------

loc_10023B62:				; CODE XREF: sub_10023B1E+18j
					; sub_10023B1E+21j
		cmp	[ebp+var_4], 0
		jz	short loc_10023B6F
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10023B6F:				; CODE XREF: sub_10023B1E+48j
		xor	eax, eax

locret_10023B71:			; CODE XREF: sub_10023B1E+39j
		leave
		retn
sub_10023B1E	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	dword ptr [ebp+8]
		call	sub_10023B1E
		pop	ecx
		pop	ecx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10023B86(int,	int, LCID Locale, LCTYPE LCType, int)
sub_10023B86	proc near		; CODE XREF: sub_10019E1A+38p
					; sub_10019E1A+4Cp ...

var_94		= dword	ptr -94h
cchData		= dword	ptr -90h
lpMem		= dword	ptr -8Ch
LCData		= word ptr -88h
MultiByteStr	= byte ptr -84h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
Locale		= dword	ptr  10h
LCType		= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 94h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	ebx
		mov	ebx, [ebp+arg_10]
		push	esi
		xor	esi, esi
		cmp	[ebp+arg_4], 1
		push	edi
		mov	dword ptr [ebp+LCData],	eax
		jnz	loc_10023CC5
		push	esi		; CodePage
		push	80h		; cbMultiByte
		lea	ecx, [ebp+MultiByteStr]
		push	ecx		; lpMultiByteStr
		push	[ebp+LCType]	; LCType
		mov	[ebp+lpMem], ecx
		push	[ebp+Locale]	; Locale
		mov	[ebp+var_94], esi
		push	eax		; int
		call	sub_10024FC3
		mov	edi, eax
		add	esp, 18h
		cmp	edi, esi
		jnz	short loc_10023C52
		call	ds:GetLastError
		cmp	eax, 7Ah
		jnz	loc_10023C76
		push	esi		; CodePage
		push	esi		; cbMultiByte
		push	esi		; lpMultiByteStr
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		push	dword ptr [ebp+LCData] ; int
		call	sub_10024FC3
		add	esp, 18h
		mov	[ebp+cchData], eax
		cmp	eax, esi
		jz	short loc_10023C76
		xor	edi, edi
		inc	edi
		push	edi
		push	eax
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[ebp+lpMem], eax
		cmp	eax, esi
		jz	short loc_10023C76
		push	esi		; CodePage
		push	[ebp+cchData]	; cbMultiByte
		mov	[ebp+var_94], edi
		push	eax		; lpMultiByteStr
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		push	dword ptr [ebp+LCData] ; int
		call	sub_10024FC3
		mov	edi, eax
		add	esp, 18h
		cmp	edi, esi
		jz	short loc_10023C6A

loc_10023C52:				; CODE XREF: sub_10023B86+5Cj
		push	1
		push	edi
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[ebx], eax
		cmp	eax, esi
		jnz	short loc_10023C88
		cmp	[ebp+var_94], esi
		jz	short loc_10023C76

loc_10023C6A:				; CODE XREF: sub_10023B86+CAj
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10023C76:				; CODE XREF: sub_10023B86+67j
					; sub_10023B86+8Cj ...
		or	eax, 0FFFFFFFFh

loc_10023C79:				; CODE XREF: sub_10023B86+13Dj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
; ---------------------------------------------------------------------------

loc_10023C88:				; CODE XREF: sub_10023B86+DAj
		lea	ecx, [edi-1]
		push	ecx
		push	[ebp+lpMem]
		push	edi
		push	eax
		call	sub_10016DF1
		add	esp, 10h
		test	eax, eax
		jz	short loc_10023CAD
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		call	sub_10014AB5
		add	esp, 14h

loc_10023CAD:				; CODE XREF: sub_10023B86+118j
		cmp	[ebp+var_94], esi
		jz	short loc_10023CC1
		push	[ebp+lpMem]	; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10023CC1:				; CODE XREF: sub_10023B86+12Dj
					; sub_10023B86+182j ...
		xor	eax, eax
		jmp	short loc_10023C79
; ---------------------------------------------------------------------------

loc_10023CC5:				; CODE XREF: sub_10023B86+2Aj
		cmp	[ebp+arg_4], 2
		jnz	short loc_10023D19
		mov	edi, ds:GetLocaleInfoW
		push	esi		; cchData
		push	esi		; lpLCData
		push	[ebp+LCType]	; LCType
		mov	[ebx], esi
		push	[ebp+Locale]	; Locale
		call	edi ; GetLocaleInfoW
		mov	[ebp+cchData], eax
		cmp	eax, esi
		jz	short loc_10023D0A
		push	2
		push	eax
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[ebx], eax
		cmp	eax, esi
		jz	short loc_10023D0A
		push	[ebp+cchData]	; cchData
		push	eax		; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	edi ; GetLocaleInfoW
		test	eax, eax
		jnz	short loc_10023CC1

loc_10023D0A:				; CODE XREF: sub_10023B86+15Fj
					; sub_10023B86+16Fj
		push	dword ptr [ebx]	; lpMem
		call	sub_1000EE73
		pop	ecx
		mov	[ebx], esi
		jmp	loc_10023C76
; ---------------------------------------------------------------------------

loc_10023D19:				; CODE XREF: sub_10023B86+143j
		cmp	[ebp+arg_4], esi
		jnz	loc_10023C76
		push	2		; cchData
		lea	eax, [ebp+LCData]
		push	eax		; lpLCData
		mov	eax, [ebp+LCType]
		or	eax, 20000000h
		push	eax		; LCType
		push	[ebp+Locale]	; Locale
		mov	dword ptr [ebp+LCData],	esi
		call	ds:GetLocaleInfoW
		test	eax, eax
		jz	loc_10023C76
		mov	al, byte ptr [ebp+LCData]
		mov	[ebx], al
		jmp	loc_10023CC1
sub_10023B86	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023D60	proc near		; CODE XREF: sub_1001C020+229p
					; sub_1001C020+23Fp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		mov	esi, [ebp+arg_4]
		mov	edi, [ebp+arg_0]
		mov	al, 0FFh
		mov	edi, edi

loc_10023D70:				; CODE XREF: sub_10023D60+20j
					; sub_10023D60+40j
		or	al, al
		jz	short loc_10023DA6
		mov	al, [esi]
		add	esi, 1
		mov	ah, [edi]
		add	edi, 1
		cmp	ah, al
		jz	short loc_10023D70
		sub	al, 41h
		cmp	al, 1Ah
		sbb	cl, cl
		and	cl, 20h
		add	al, cl
		add	al, 41h
		xchg	ah, al
		sub	al, 41h
		cmp	al, 1Ah
		sbb	cl, cl
		and	cl, 20h
		add	al, cl
		add	al, 41h
		cmp	al, ah
		jz	short loc_10023D70
		sbb	al, al
		sbb	al, 0FFh

loc_10023DA6:				; CODE XREF: sub_10023D60+12j
		movsx	eax, al
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
sub_10023D60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023DAE	proc near		; CODE XREF: sub_1002276E+91p
					; sub_10023E83+47p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	[ebp+arg_8]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		xor	ebx, ebx
		cmp	[ebp+arg_0], ebx
		jnz	short loc_10023DF7
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10023DED
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10023DED:				; CODE XREF: sub_10023DAE+36j
		mov	eax, 7FFFFFFFh
		jmp	loc_10023E80
; ---------------------------------------------------------------------------

loc_10023DF7:				; CODE XREF: sub_10023DAE+19j
		push	edi
		mov	edi, [ebp+arg_4]
		cmp	edi, ebx
		jnz	short loc_10023E2A
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10023E23
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10023E23:				; CODE XREF: sub_10023DAE+6Cj
		mov	eax, 7FFFFFFFh
		jmp	short loc_10023E7F
; ---------------------------------------------------------------------------

loc_10023E2A:				; CODE XREF: sub_10023DAE+4Fj
		mov	eax, [ebp+var_10]
		cmp	[eax+14h], ebx
		jnz	short loc_10023E3F
		push	edi
		push	[ebp+arg_0]
		call	sub_10023D60
		pop	ecx
		pop	ecx
		jmp	short loc_10023E73
; ---------------------------------------------------------------------------

loc_10023E3F:				; CODE XREF: sub_10023DAE+82j
		push	esi

loc_10023E40:				; CODE XREF: sub_10023DAE+BEj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		lea	ecx, [ebp+var_10]
		push	ecx
		push	eax
		call	sub_1000FD34
		inc	[ebp+arg_0]
		mov	esi, eax
		movzx	eax, byte ptr [edi]
		lea	ecx, [ebp+var_10]
		push	ecx
		push	eax
		call	sub_1000FD34
		add	esp, 10h
		inc	edi
		cmp	esi, ebx
		jz	short loc_10023E6E
		cmp	esi, eax
		jz	short loc_10023E40

loc_10023E6E:				; CODE XREF: sub_10023DAE+BAj
		sub	esi, eax
		mov	eax, esi
		pop	esi

loc_10023E73:				; CODE XREF: sub_10023DAE+8Fj
		cmp	[ebp+var_4], bl
		jz	short loc_10023E7F
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

loc_10023E7F:				; CODE XREF: sub_10023DAE+7Aj
					; sub_10023DAE+C8j
		pop	edi

loc_10023E80:				; CODE XREF: sub_10023DAE+44j
		pop	ebx
		leave
		retn
sub_10023DAE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023E83	proc near		; CODE XREF: sub_100019F0+1ACp
					; sasl_auxprop_store+1B1p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		xor	esi, esi
		cmp	dword_1002E61C,	esi
		jnz	short loc_10023EC3
		cmp	[ebp+arg_0], esi
		jnz	short loc_10023EB7

loc_10023E98:				; CODE XREF: sub_10023E83+37j
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, 7FFFFFFFh
		jmp	short loc_10023ED2
; ---------------------------------------------------------------------------

loc_10023EB7:				; CODE XREF: sub_10023E83+13j
		cmp	[ebp+arg_4], esi
		jz	short loc_10023E98
		pop	esi
		pop	ebp
		jmp	sub_10023D60
; ---------------------------------------------------------------------------

loc_10023EC3:				; CODE XREF: sub_10023E83+Ej
		push	esi
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10023DAE
		add	esp, 0Ch

loc_10023ED2:				; CODE XREF: sub_10023E83+32j
		pop	esi
		pop	ebp
		retn
sub_10023E83	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023ED5	proc near		; CODE XREF: sub_100208DE+A1p
					; sub_10023FC7+53p

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		xor	ebx, ebx
		push	esi
		push	edi
		cmp	[ebp+arg_8], ebx
		jz	loc_10023FC0
		push	[ebp+arg_C]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		cmp	[ebp+arg_0], ebx
		jnz	short loc_10023F29

loc_10023EFB:				; CODE XREF: sub_10023ED5+59j
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10023F1F
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10023F1F:				; CODE XREF: sub_10023ED5+41j
		mov	eax, 7FFFFFFFh
		jmp	loc_10023FC2
; ---------------------------------------------------------------------------

loc_10023F29:				; CODE XREF: sub_10023ED5+24j
		mov	edi, [ebp+arg_4]
		cmp	edi, ebx
		jz	short loc_10023EFB
		mov	esi, 7FFFFFFFh
		cmp	[ebp+arg_8], esi
		jbe	short loc_10023F62
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10023F5E
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10023F5E:				; CODE XREF: sub_10023ED5+80j
		mov	eax, esi
		jmp	short loc_10023FC2
; ---------------------------------------------------------------------------

loc_10023F62:				; CODE XREF: sub_10023ED5+63j
		mov	eax, [ebp+var_10]
		cmp	[eax+14h], ebx
		jnz	short loc_10023F87
		push	[ebp+arg_8]
		push	edi
		push	[ebp+arg_0]
		call	sub_10025000
		add	esp, 0Ch

loc_10023F79:				; CODE XREF: sub_10023ED5+E9j
		cmp	[ebp+var_4], bl
		jz	short loc_10023FC2
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	short loc_10023FC2
; ---------------------------------------------------------------------------

loc_10023F87:				; CODE XREF: sub_10023ED5+93j
					; sub_10023ED5+E3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		lea	ecx, [ebp+var_10]
		push	ecx
		push	eax
		call	sub_1000FD34
		inc	[ebp+arg_0]
		mov	esi, eax
		movzx	eax, byte ptr [edi]
		lea	ecx, [ebp+var_10]
		push	ecx
		push	eax
		call	sub_1000FD34
		add	esp, 10h
		inc	edi
		dec	[ebp+arg_8]
		jz	short loc_10023FBA
		cmp	esi, ebx
		jz	short loc_10023FBA
		cmp	esi, eax
		jz	short loc_10023F87

loc_10023FBA:				; CODE XREF: sub_10023ED5+DBj
					; sub_10023ED5+DFj
		sub	esi, eax
		mov	eax, esi
		jmp	short loc_10023F79
; ---------------------------------------------------------------------------

loc_10023FC0:				; CODE XREF: sub_10023ED5+10j
		xor	eax, eax

loc_10023FC2:				; CODE XREF: sub_10023ED5+4Fj
					; sub_10023ED5+8Bj ...
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_10023ED5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023FC7	proc near		; CODE XREF: .text:10003A61p
					; sub_10003A80+B5p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		xor	esi, esi
		cmp	dword_1002E61C,	esi
		jnz	short loc_10024010
		cmp	[ebp+arg_0], esi
		jnz	short loc_10023FFB

loc_10023FDC:				; CODE XREF: sub_10023FC7+37j
					; sub_10023FC7+40j
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, 7FFFFFFFh
		jmp	short loc_10024022
; ---------------------------------------------------------------------------

loc_10023FFB:				; CODE XREF: sub_10023FC7+13j
		cmp	[ebp+arg_4], esi
		jz	short loc_10023FDC
		cmp	[ebp+arg_8], 7FFFFFFFh
		ja	short loc_10023FDC
		pop	esi
		pop	ebp
		jmp	sub_10025000
; ---------------------------------------------------------------------------

loc_10024010:				; CODE XREF: sub_10023FC7+Ej
		push	esi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10023ED5
		add	esp, 10h

loc_10024022:				; CODE XREF: sub_10023FC7+32j
		pop	esi
		pop	ebp
		retn
sub_10023FC7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024025	proc near		; CODE XREF: sub_100240FC+25p
					; .text:10024148p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		mov	esi, eax
		xor	ebx, ebx
		push	edi
		cmp	esi, ebx
		jz	loc_100240DC
		cmp	[ebp+arg_4], ebx
		jbe	loc_100240DC
		xor	eax, eax
		cmp	[ebp+arg_C], ebx
		mov	[esi], bl
		setnz	al
		inc	eax
		cmp	[ebp+arg_4], eax
		ja	short loc_1002405F
		call	sub_10014BF2
		push	22h
		jmp	loc_100240E3
; ---------------------------------------------------------------------------

loc_1002405F:				; CODE XREF: sub_10024025+2Cj
		mov	eax, [ebp+arg_8]
		add	eax, 0FFFFFFFEh
		cmp	eax, 22h
		ja	short loc_100240DC
		mov	[ebp+var_4], ebx
		mov	ecx, esi
		cmp	[ebp+arg_C], ebx
		jz	short loc_10024084
		neg	[ebp+arg_0]
		mov	byte ptr [esi],	2Dh
		lea	ecx, [esi+1]
		mov	[ebp+var_4], 1

loc_10024084:				; CODE XREF: sub_10024025+4Dj
		mov	edi, ecx

loc_10024086:				; CODE XREF: sub_10024025+8Bj
		mov	eax, [ebp+arg_0]
		xor	edx, edx
		div	[ebp+arg_8]
		mov	[ebp+arg_0], eax
		cmp	edx, 9
		jbe	short loc_1002409B
		add	dl, 57h
		jmp	short loc_1002409E
; ---------------------------------------------------------------------------

loc_1002409B:				; CODE XREF: sub_10024025+6Fj
		add	dl, 30h

loc_1002409E:				; CODE XREF: sub_10024025+74j
		mov	eax, [ebp+var_4]
		mov	[ecx], dl
		inc	ecx
		inc	eax
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], ebx
		jbe	short loc_100240B2
		cmp	eax, [ebp+arg_4]
		jb	short loc_10024086

loc_100240B2:				; CODE XREF: sub_10024025+86j
		cmp	eax, [ebp+arg_4]
		jb	short loc_100240C7
		mov	[esi], bl
		call	sub_10014BF2
		push	22h
		pop	ecx
		mov	[eax], ecx
		mov	esi, ecx
		jmp	short loc_100240E6
; ---------------------------------------------------------------------------

loc_100240C7:				; CODE XREF: sub_10024025+90j
		mov	[ecx], bl
		dec	ecx

loc_100240CA:				; CODE XREF: sub_10024025+B1j
		mov	dl, [edi]
		mov	al, [ecx]
		mov	[ecx], dl
		dec	ecx
		mov	[edi], al
		inc	edi
		cmp	edi, ecx
		jb	short loc_100240CA
		xor	eax, eax
		jmp	short loc_100240F5
; ---------------------------------------------------------------------------

loc_100240DC:				; CODE XREF: sub_10024025+Fj
					; sub_10024025+18j ...
		call	sub_10014BF2
		push	16h

loc_100240E3:				; CODE XREF: sub_10024025+35j
		pop	esi
		mov	[eax], esi

loc_100240E6:				; CODE XREF: sub_10024025+A0j
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, esi

loc_100240F5:				; CODE XREF: sub_10024025+B5j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn	10h
sub_10024025	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100240FC	proc near		; CODE XREF: sub_1001CDB0+1E6p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_C], 0Ah
		jnz	short loc_10024113
		cmp	[ebp+arg_0], 0
		jge	short loc_10024113
		push	1
		push	0Ah
		jmp	short loc_10024118
; ---------------------------------------------------------------------------

loc_10024113:				; CODE XREF: sub_100240FC+9j
					; sub_100240FC+Fj
		push	0
		push	[ebp+arg_C]

loc_10024118:				; CODE XREF: sub_100240FC+15j
		push	[ebp+arg_8]
		mov	eax, [ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10024025
		pop	ebp
		retn
sub_100240FC	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		cmp	dword ptr [ebp+14h], 0Ah
		jnz	short loc_1002413B
		cmp	[ebp+8], eax
		jge	short loc_1002413B
		inc	eax

loc_1002413B:				; CODE XREF: .text:10024133j
					; .text:10024138j
		push	eax
		push	dword ptr [ebp+14h]
		mov	eax, [ebp+0Ch]
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+8]
		call	sub_10024025
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+0Ch]
		push	0
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+8]
		call	sub_10024025
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024169	proc near		; CODE XREF: .text:10024297p
					; .text:100242B6p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		xor	ebx, ebx
		push	esi
		cmp	edi, ebx
		jz	loc_1002424B
		cmp	[ebp+arg_8], ebx
		jbe	loc_1002424B
		xor	eax, eax
		cmp	[ebp+arg_10], ebx
		mov	[edi], bl
		setnz	al
		inc	eax
		cmp	[ebp+arg_8], eax
		ja	short loc_100241A2
		call	sub_10014BF2
		push	22h
		jmp	loc_10024252
; ---------------------------------------------------------------------------

loc_100241A2:				; CODE XREF: sub_10024169+2Bj
		mov	eax, [ebp+arg_C]
		add	eax, 0FFFFFFFEh
		cmp	eax, 22h
		ja	loc_1002424B
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_4], ebx
		mov	esi, edi
		cmp	[ebp+arg_10], ebx
		jz	short loc_100241D4
		neg	edx
		adc	eax, ebx
		mov	byte ptr [edi],	2Dh
		lea	esi, [edi+1]
		mov	[ebp+var_4], 1
		neg	eax

loc_100241D4:				; CODE XREF: sub_10024169+56j
		mov	[ebp+arg_10], esi
		mov	[ebp+arg_4], ebx

loc_100241DA:				; CODE XREF: sub_10024169+A9j
		push	[ebp+arg_4]
		push	[ebp+arg_C]
		push	eax
		push	edx
		call	sub_1001D510
		mov	[ebp+var_8], ebx
		mov	ebx, edx
		mov	edx, eax
		mov	eax, ebx
		cmp	ecx, 9
		jbe	short loc_100241FA
		add	cl, 57h
		jmp	short loc_100241FD
; ---------------------------------------------------------------------------

loc_100241FA:				; CODE XREF: sub_10024169+8Aj
		add	cl, 30h

loc_100241FD:				; CODE XREF: sub_10024169+8Fj
		mov	[esi], cl
		mov	ecx, [ebp+var_4]
		inc	esi
		inc	ecx
		mov	[ebp+var_4], ecx
		test	eax, eax
		ja	short loc_1002420F
		test	edx, edx
		jbe	short loc_10024217

loc_1002420F:				; CODE XREF: sub_10024169+A0j
		cmp	ecx, [ebp+arg_8]
		jb	short loc_100241DA
		mov	ecx, [ebp+var_4]

loc_10024217:				; CODE XREF: sub_10024169+A4j
		cmp	ecx, [ebp+arg_8]
		jb	short loc_1002422F
		mov	byte ptr [edi],	0
		call	sub_10014BF2
		push	22h
		pop	ecx
		mov	[eax], ecx
		mov	esi, ecx
		xor	ebx, ebx
		jmp	short loc_10024255
; ---------------------------------------------------------------------------

loc_1002422F:				; CODE XREF: sub_10024169+B1j
		mov	byte ptr [esi],	0
		dec	esi

loc_10024233:				; CODE XREF: sub_10024169+DCj
		mov	eax, [ebp+arg_10]
		mov	dl, [eax]
		mov	cl, [esi]
		mov	[esi], dl
		dec	esi
		mov	[eax], cl
		inc	eax
		mov	[ebp+arg_10], eax
		cmp	eax, esi
		jb	short loc_10024233
		xor	eax, eax
		jmp	short loc_10024264
; ---------------------------------------------------------------------------

loc_1002424B:				; CODE XREF: sub_10024169+Ej
					; sub_10024169+17j ...
		call	sub_10014BF2
		push	16h

loc_10024252:				; CODE XREF: sub_10024169+34j
		pop	esi
		mov	[eax], esi

loc_10024255:				; CODE XREF: sub_10024169+C4j
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, esi

loc_10024264:				; CODE XREF: sub_10024169+E0j
		pop	esi
		pop	ebx
		leave
		retn	14h
sub_10024169	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		xor	eax, eax
		cmp	dword ptr [ebp+18h], 0Ah
		jnz	short loc_10024286
		cmp	[ebp+0Ch], eax
		jg	short loc_10024286
		jl	short loc_10024283
		cmp	[ebp+8], eax
		jnb	short loc_10024286

loc_10024283:				; CODE XREF: .text:1002427Cj
		xor	eax, eax
		inc	eax

loc_10024286:				; CODE XREF: .text:10024275j
					; .text:1002427Aj ...
		push	edi
		mov	edi, [ebp+10h]
		push	eax
		push	dword ptr [ebp+18h]
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10024169
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	edi
		mov	edi, [ebp+10h]
		push	0
		push	dword ptr [ebp+18h]
		push	dword ptr [ebp+14h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10024169
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================


sub_100242BE	proc near		; DATA XREF: .data:off_1002E180o
					; .data:1002E184o ...
		push	2
		call	sub_100164A2
		pop	ecx
		retn
sub_100242BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_100242C7	proc near		; CODE XREF: sub_1001FD75:loc_1001FDA3p

var_328		= dword	ptr -328h
var_31C		= dword	ptr -31Ch
ExceptionInfo	= _EXCEPTION_POINTERS ptr -2D8h
var_2D0		= dword	ptr -2D0h
var_244		= word ptr -244h
var_240		= word ptr -240h
var_23C		= word ptr -23Ch
var_238		= word ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_214		= word ptr -214h
var_210		= dword	ptr -210h
var_20C		= dword	ptr -20Ch
var_208		= word ptr -208h
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 328h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		test	byte ptr dword_1002E3E0, 1
		push	esi
		jz	short loc_100242EE
		push	0Ah
		call	sub_100167DD
		pop	ecx

loc_100242EE:				; CODE XREF: sub_100242C7+1Dj
		call	sub_1001FEFA
		test	eax, eax
		jz	short loc_100242FF
		push	16h
		call	sub_10020156
		pop	ecx

loc_100242FF:				; CODE XREF: sub_100242C7+2Ej
		test	byte ptr dword_1002E3E0, 2
		jz	loc_100243D6
		mov	[ebp+var_220], eax
		mov	[ebp+var_224], ecx
		mov	[ebp+var_228], edx
		mov	[ebp+var_22C], ebx
		mov	[ebp+var_230], esi
		mov	[ebp+var_234], edi
		mov	[ebp+var_208], ss
		mov	[ebp+var_214], cs
		mov	[ebp+var_238], ds
		mov	[ebp+var_23C], es
		mov	[ebp+var_240], fs
		mov	[ebp+var_244], gs
		pushf
		pop	[ebp+var_210]
		mov	esi, [ebp+4]
		lea	eax, [ebp+4]
		mov	[ebp+var_20C], eax
		mov	[ebp+var_2D0], 10001h
		mov	[ebp+var_218], esi
		mov	eax, [eax-4]
		push	50h
		mov	[ebp+var_21C], eax
		lea	eax, [ebp+var_328]
		push	0
		push	eax
		call	sub_1000E0F0
		lea	eax, [ebp+var_328]
		add	esp, 0Ch
		mov	[ebp+ExceptionInfo.ExceptionRecord], eax
		lea	eax, [ebp+var_2D0]
		push	0		; lpTopLevelExceptionFilter
		mov	[ebp+var_328], 40000015h
		mov	[ebp+var_31C], esi
		mov	[ebp+ExceptionInfo.ContextRecord], eax
		call	ds:SetUnhandledExceptionFilter
		lea	eax, [ebp+ExceptionInfo]
		push	eax		; ExceptionInfo
		call	ds:UnhandledExceptionFilter

loc_100243D6:				; CODE XREF: sub_100242C7+3Fj
		push	3		; uExitCode
		call	sub_10016767
		int	3		; Trap to Debugger
sub_100242C7	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+0Ch]
		mov	eax, dword_1002E3E0
		mov	edx, [ebp+8]
		and	edx, [ebp+0Ch]
		not	ecx
		and	ecx, eax
		or	ecx, edx
		mov	dword_1002E3E0,	ecx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100243FF	proc near		; CODE XREF: sub_10024460+12p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002B9D8
		call	__SEH_prolog4
		xor	eax, eax
		mov	ecx, [ebp+arg_0]
		test	ecx, ecx
		jz	short loc_10024458
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10024458
		and	[ebp+ms_exc.registration.TryLevel], eax
		mov	edx, 5A4Dh
		cmp	[ecx], dx
		jnz	short loc_10024451
		mov	edx, [ecx+3Ch]
		test	edx, edx
		jl	short loc_10024451
		cmp	edx, 10000000h
		jnb	short loc_10024451
		lea	eax, [edx+ecx]
		mov	[ebp+var_1C], eax
		cmp	dword ptr [eax], 4550h
		jz	short loc_10024451
		jmp	short loc_1002444C
; ---------------------------------------------------------------------------

loc_10024445:				; DATA XREF: .rdata:stru_1002B9D8o
		xor	eax, eax	; Exception filter 0 for function 100243FF
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10024449:				; DATA XREF: .rdata:stru_1002B9D8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100243FF

loc_1002444C:				; CODE XREF: sub_100243FF+44j
		xor	eax, eax
		mov	[ebp+var_1C], eax

loc_10024451:				; CODE XREF: sub_100243FF+25j
					; sub_100243FF+2Cj ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_10024458:				; CODE XREF: sub_100243FF+13j
					; sub_100243FF+18j
		call	__SEH_epilog4
		retn	4
sub_100243FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024460	proc near		; CODE XREF: .text:100204FBp

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0		; lpModuleName
		call	ds:GetModuleHandleA
		test	eax, eax
		jz	short loc_10024495
		push	eax
		call	sub_100243FF
		test	eax, eax
		jz	short loc_10024495
		movzx	eax, word ptr [eax+5Ch]
		cmp	ax, 2
		jnz	short loc_1002448A
		push	2
		pop	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1002448A:				; CODE XREF: sub_10024460+23j
		cmp	ax, 3
		jnz	short loc_10024495
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024495:				; CODE XREF: sub_10024460+Fj
					; sub_10024460+19j ...
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_10024460	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002449A	proc near		; CODE XREF: auxprop_plugin_info+7Bp
					; sasl_client_plugin_info+82p ...

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	ebx
		xor	ebx, ebx
		cmp	eax, ebx
		jnz	short loc_100244AD
		xor	eax, eax
		jmp	short loc_100244F1
; ---------------------------------------------------------------------------

loc_100244AD:				; CODE XREF: sub_1002449A+Dj
		lea	edx, [eax+1]

loc_100244B0:				; CODE XREF: sub_1002449A+1Bj
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_100244B0
		push	esi
		sub	eax, edx
		lea	esi, [eax+1]
		push	edi
		push	esi
		call	sub_1000F5A0
		mov	edi, eax
		pop	ecx
		cmp	edi, ebx
		jz	short loc_100244ED
		push	[ebp+arg_0]
		push	esi
		push	edi
		call	sub_10016B60
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100244E9
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014AB5
		add	esp, 14h

loc_100244E9:				; CODE XREF: sub_1002449A+40j
		mov	eax, edi
		jmp	short loc_100244EF
; ---------------------------------------------------------------------------

loc_100244ED:				; CODE XREF: sub_1002449A+2Fj
		xor	eax, eax

loc_100244EF:				; CODE XREF: sub_1002449A+51j
		pop	edi
		pop	esi

loc_100244F1:				; CODE XREF: sub_1002449A+11j
		pop	ebx
		pop	ebp
		retn
sub_1002449A	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+8]
		call	sub_1002449A
		pop	ecx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024504	proc near		; CODE XREF: sub_100245C0+Dp

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	[ebp+arg_8]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	eax, [ebp+arg_0]
		xor	ebx, ebx
		cmp	eax, ebx
		jnz	short loc_10024549
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10024545
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10024545:				; CODE XREF: sub_10024504+38j
		xor	eax, eax
		jmp	short loc_100245BD
; ---------------------------------------------------------------------------

loc_10024549:				; CODE XREF: sub_10024504+1Bj
		push	esi
		mov	esi, [ebp+var_C]
		cmp	[esi+8], ebx
		jnz	short loc_1002458C
		push	[ebp+arg_4]
		push	eax
		call	sub_1000EF20
		pop	ecx
		pop	ecx
		jmp	short loc_100245A0
; ---------------------------------------------------------------------------

loc_1002455F:				; CODE XREF: sub_10024504+92j
		movzx	edx, cl
		test	byte ptr [edx+esi+1Dh],	4
		jz	short loc_10024583
		inc	eax
		mov	dl, [eax]
		cmp	dl, bl
		jz	short loc_100245AE
		movzx	ecx, cx
		movzx	edx, dl
		shl	ecx, 8
		or	ecx, edx
		cmp	[ebp+arg_4], ecx
		jnz	short loc_1002458B
		dec	eax
		jmp	short loc_100245A0
; ---------------------------------------------------------------------------

loc_10024583:				; CODE XREF: sub_10024504+63j
		movzx	edx, cx
		cmp	[ebp+arg_4], edx
		jz	short loc_10024598

loc_1002458B:				; CODE XREF: sub_10024504+7Aj
		inc	eax

loc_1002458C:				; CODE XREF: sub_10024504+4Cj
		movzx	cx, byte ptr [eax]
		movzx	ecx, cx
		cmp	cx, bx
		jnz	short loc_1002455F

loc_10024598:				; CODE XREF: sub_10024504+85j
		movzx	ecx, cx
		cmp	[ebp+arg_4], ecx
		jnz	short loc_100245AE

loc_100245A0:				; CODE XREF: sub_10024504+59j
					; sub_10024504+7Dj
		cmp	[ebp+var_4], bl
		jz	short loc_100245BC
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	short loc_100245BC
; ---------------------------------------------------------------------------

loc_100245AE:				; CODE XREF: sub_10024504+6Aj
					; sub_10024504+9Aj
		cmp	[ebp+var_4], bl
		jz	short loc_100245BA
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_100245BA:				; CODE XREF: sub_10024504+ADj
		xor	eax, eax

loc_100245BC:				; CODE XREF: sub_10024504+9Fj
					; sub_10024504+A8j
		pop	esi

loc_100245BD:				; CODE XREF: sub_10024504+43j
		pop	ebx
		leave
		retn
sub_10024504	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100245C0	proc near		; CODE XREF: sub_10020AAD+40p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10024504
		add	esp, 0Ch
		pop	ebp
		retn
sub_100245C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100245D7(int,	DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType, UINT	CodePage, LCID Locale)
sub_100245D7	proc near		; CODE XREF: sub_10024800+29p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
CharType	= word ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
dwInfoType	= dword	ptr  0Ch
lpSrcStr	= dword	ptr  10h
cchSrc		= dword	ptr  14h
lpCharType	= dword	ptr  18h
CodePage	= dword	ptr  1Ch
Locale		= dword	ptr  20h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		cmp	[ebp+cchSrc], 0FFFFFFFFh
		push	ebx
		push	esi
		push	edi
		jge	short loc_100245F9

loc_100245F2:				; CODE XREF: sub_100245D7+87j
					; sub_100245D7+DFj ...
		xor	eax, eax
		jmp	loc_100247EE
; ---------------------------------------------------------------------------

loc_100245F9:				; CODE XREF: sub_100245D7+19j
		mov	eax, dword_1002F050
		mov	esi, ds:GetStringTypeW
		xor	edi, edi
		xor	ebx, ebx
		inc	edi
		cmp	eax, ebx
		jnz	short loc_10024640
		lea	eax, [ebp+CharType]
		push	eax		; lpCharType
		push	edi		; cchSrc
		push	offset SrcStr	; lpSrcStr
		push	edi		; dwInfoType
		call	esi ; GetStringTypeW
		test	eax, eax
		jz	short loc_10024626
		mov	dword_1002F050,	edi
		jmp	short loc_10024644
; ---------------------------------------------------------------------------

loc_10024626:				; CODE XREF: sub_100245D7+45j
		call	ds:GetLastError
		cmp	eax, 78h
		jnz	short loc_1002463B
		push	2
		pop	eax
		mov	dword_1002F050,	eax
		jmp	short loc_10024640
; ---------------------------------------------------------------------------

loc_1002463B:				; CODE XREF: sub_100245D7+58j
		mov	eax, dword_1002F050

loc_10024640:				; CODE XREF: sub_100245D7+34j
					; sub_100245D7+62j
		cmp	eax, edi
		jnz	short loc_10024657

loc_10024644:				; CODE XREF: sub_100245D7+4Dj
		push	[ebp+lpCharType] ; lpCharType
		push	[ebp+cchSrc]	; cchSrc
		push	[ebp+lpSrcStr]	; lpSrcStr
		push	[ebp+dwInfoType] ; dwInfoType
		call	esi ; GetStringTypeW
		jmp	loc_100247EE
; ---------------------------------------------------------------------------

loc_10024657:				; CODE XREF: sub_100245D7+6Bj
		cmp	eax, 2
		jz	short loc_10024660
		cmp	eax, ebx
		jnz	short loc_100245F2

loc_10024660:				; CODE XREF: sub_100245D7+83j
		mov	[ebp+var_10], ebx
		cmp	[ebp+Locale], ebx
		jnz	short loc_10024673
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax+14h]
		mov	[ebp+Locale], eax

loc_10024673:				; CODE XREF: sub_100245D7+8Fj
		cmp	[ebp+CodePage],	ebx
		jnz	short loc_10024683
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax+4]
		mov	[ebp+CodePage],	eax

loc_10024683:				; CODE XREF: sub_100245D7+9Fj
		push	[ebp+Locale]	; Locale
		call	sub_10021420
		pop	ecx
		cmp	[ebp+CodePage],	eax
		jz	short loc_10024699
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10024699
		mov	[ebp+CodePage],	eax

loc_10024699:				; CODE XREF: sub_100245D7+B8j
					; sub_100245D7+BDj
		mov	edi, ds:WideCharToMultiByte
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	ebx		; cbMultiByte
		push	ebx		; lpMultiByteStr
		push	[ebp+cchSrc]	; cchWideChar
		push	[ebp+lpSrcStr]	; lpWideCharStr
		push	ebx		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	edi ; WideCharToMultiByte
		mov	esi, eax
		mov	[ebp+var_14], esi
		cmp	esi, ebx
		jz	loc_100245F2
		jle	short loc_100246F9
		cmp	esi, 0FFFFFFE0h
		ja	short loc_100246F9
		lea	eax, [esi+8]
		cmp	eax, 400h
		ja	short loc_100246E0
		call	__alloca_probe_16
		mov	eax, esp
		cmp	eax, ebx
		jz	short loc_100246F4
		mov	dword ptr [eax], 0CCCCh
		jmp	short loc_100246F1
; ---------------------------------------------------------------------------

loc_100246E0:				; CODE XREF: sub_100245D7+F4j
		push	eax
		call	sub_1000F5A0
		pop	ecx
		cmp	eax, ebx
		jz	short loc_100246F4
		mov	dword ptr [eax], 0DDDDh

loc_100246F1:				; CODE XREF: sub_100245D7+107j
		add	eax, 8

loc_100246F4:				; CODE XREF: sub_100245D7+FFj
					; sub_100245D7+112j
		mov	dword ptr [ebp+CharType], eax
		jmp	short loc_100246FC
; ---------------------------------------------------------------------------

loc_100246F9:				; CODE XREF: sub_100245D7+E5j
					; sub_100245D7+EAj
		mov	dword ptr [ebp+CharType], ebx

loc_100246FC:				; CODE XREF: sub_100245D7+120j
		cmp	dword ptr [ebp+CharType], ebx
		jz	loc_100245F2
		push	esi
		push	ebx
		push	dword ptr [ebp+CharType]
		call	sub_1000E0F0
		add	esp, 0Ch
		push	ebx		; lpUsedDefaultChar
		push	ebx		; lpDefaultChar
		push	esi		; cbMultiByte
		push	dword ptr [ebp+CharType] ; lpMultiByteStr
		push	[ebp+cchSrc]	; cchWideChar
		push	[ebp+lpSrcStr]	; lpWideCharStr
		push	ebx		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	edi ; WideCharToMultiByte
		test	eax, eax
		jz	loc_100247E2
		lea	eax, [esi+1]
		cmp	eax, ebx
		jle	short loc_10024771
		cmp	eax, 7FFFFFF0h
		ja	short loc_10024771
		lea	eax, [esi+esi+0Ah]
		cmp	eax, 400h
		ja	short loc_10024758
		call	__alloca_probe_16
		mov	eax, esp
		cmp	eax, ebx
		jz	short loc_1002476C
		mov	dword ptr [eax], 0CCCCh
		jmp	short loc_10024769
; ---------------------------------------------------------------------------

loc_10024758:				; CODE XREF: sub_100245D7+16Cj
		push	eax
		call	sub_1000F5A0
		pop	ecx
		cmp	eax, ebx
		jz	short loc_1002476C
		mov	dword ptr [eax], 0DDDDh

loc_10024769:				; CODE XREF: sub_100245D7+17Fj
		add	eax, 8

loc_1002476C:				; CODE XREF: sub_100245D7+177j
					; sub_100245D7+18Aj
		mov	[ebp+var_C], eax
		jmp	short loc_10024774
; ---------------------------------------------------------------------------

loc_10024771:				; CODE XREF: sub_100245D7+15Aj
					; sub_100245D7+161j
		mov	[ebp+var_C], ebx

loc_10024774:				; CODE XREF: sub_100245D7+198j
		mov	eax, [ebp+var_C]
		cmp	eax, ebx
		jz	short loc_100247E2
		cmp	[ebp+Locale], ebx
		jnz	short loc_1002478B
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx]
		mov	ecx, [ecx+14h]
		mov	[ebp+Locale], ecx

loc_1002478B:				; CODE XREF: sub_100245D7+1A7j
		mov	ebx, [ebp+cchSrc]
		push	eax		; lpCharType
		push	[ebp+var_14]	; cchSrc
		add	ebx, ebx
		push	dword ptr [ebp+CharType] ; lpSrcStr
		lea	esi, [ebx+eax]
		push	[ebp+dwInfoType] ; dwInfoType
		mov	edi, 0FFFFh
		push	[ebp+Locale]	; Locale
		mov	ecx, edi
		mov	[esi], cx
		mov	[esi-2], cx
		call	ds:GetStringTypeA
		mov	[ebp+var_10], eax
		mov	eax, edi
		cmp	[esi-2], ax
		jz	short loc_100247D5
		cmp	[esi], di
		jnz	short loc_100247D5
		push	ebx
		push	[ebp+var_C]
		push	[ebp+lpCharType]
		call	sub_1001FA10
		add	esp, 0Ch
		jmp	short loc_100247D9
; ---------------------------------------------------------------------------

loc_100247D5:				; CODE XREF: sub_100245D7+1E6j
					; sub_100245D7+1EBj
		and	[ebp+var_10], 0

loc_100247D9:				; CODE XREF: sub_100245D7+1FCj
		push	[ebp+var_C]
		call	sub_10010392
		pop	ecx

loc_100247E2:				; CODE XREF: sub_100245D7+14Fj
					; sub_100245D7+1A2j
		push	dword ptr [ebp+CharType]
		call	sub_10010392
		mov	eax, [ebp+var_10]
		pop	ecx

loc_100247EE:				; CODE XREF: sub_100245D7+1Dj
					; sub_100245D7+7Bj
		lea	esp, [ebp-20h]
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_100245D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10024800(int,	DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType, UINT	CodePage, LCID Locale)
sub_10024800	proc near		; CODE XREF: sub_100217DF+62p
					; sub_10021869+5Cp

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
dwInfoType	= dword	ptr  0Ch
lpSrcStr	= dword	ptr  10h
cchSrc		= dword	ptr  14h
lpCharType	= dword	ptr  18h
CodePage	= dword	ptr  1Ch
Locale		= dword	ptr  20h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		push	[ebp+Locale]	; Locale
		lea	eax, [ebp+var_10]
		push	[ebp+CodePage]	; CodePage
		push	[ebp+lpCharType] ; lpCharType
		push	[ebp+cchSrc]	; cchSrc
		push	[ebp+lpSrcStr]	; lpSrcStr
		push	[ebp+dwInfoType] ; dwInfoType
		push	eax		; int
		call	sub_100245D7
		add	esp, 1Ch
		cmp	[ebp+var_4], 0
		jz	short locret_1002483E
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_1002483E:			; CODE XREF: sub_10024800+35j
		leave
		retn
sub_10024800	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024840	proc near		; CODE XREF: sub_10021F64+382p
					; sub_100249F6+B4p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpMem		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	esi
		push	edi
		xor	ebx, ebx
		push	1		; dwMoveMethod
		push	ebx		; int
		push	ebx		; int
		push	[ebp+arg_0]	; int
		mov	[ebp+var_10], ebx
		mov	[ebp+var_C], ebx
		call	sub_10020D18
		mov	[ebp+var_18], eax
		and	eax, edx
		add	esp, 10h
		mov	[ebp+var_14], edx
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100248C8
		push	2		; dwMoveMethod
		push	ebx		; int
		push	ebx		; int
		push	[ebp+arg_0]	; int
		call	sub_10020D18
		mov	ecx, eax
		and	ecx, edx
		add	esp, 10h
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_100248C8
		mov	esi, [ebp+arg_4]
		mov	edi, [ebp+arg_8]
		sub	esi, eax
		sbb	edi, edx
		js	loc_1002495D
		jg	short loc_100248A1
		cmp	esi, ebx
		jbe	loc_1002495D

loc_100248A1:				; CODE XREF: sub_10024840+57j
		mov	ebx, 1000h
		push	ebx		; dwBytes
		push	8		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapAlloc
		mov	[ebp+lpMem], eax
		test	eax, eax
		jnz	short loc_100248D4
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch

loc_100248C8:				; CODE XREF: sub_10024840+2Dj
					; sub_10024840+45j ...
		call	sub_10014BF2
		mov	eax, [eax]

loc_100248CF:				; CODE XREF: sub_10024840+1B1j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
; ---------------------------------------------------------------------------

loc_100248D4:				; CODE XREF: sub_10024840+7Bj
		push	8000h
		push	[ebp+arg_0]
		call	sub_10024C50
		pop	ecx
		pop	ecx
		mov	[ebp+var_8], eax

loc_100248E6:				; CODE XREF: sub_10024840+D1j
					; sub_10024840+D5j
		test	edi, edi
		jl	short loc_100248F4
		jg	short loc_100248F0
		cmp	esi, ebx
		jb	short loc_100248F4

loc_100248F0:				; CODE XREF: sub_10024840+AAj
		mov	eax, ebx
		jmp	short loc_100248F6
; ---------------------------------------------------------------------------

loc_100248F4:				; CODE XREF: sub_10024840+A8j
					; sub_10024840+AEj
		mov	eax, esi

loc_100248F6:				; CODE XREF: sub_10024840+B2j
		push	eax		; nNumberOfBytesToWrite
		push	[ebp+lpMem]	; int
		push	[ebp+arg_0]	; int
		call	sub_1001838C
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10024940
		cdq
		sub	esi, eax
		sbb	edi, edx
		js	short loc_10024917
		jg	short loc_100248E6
		test	esi, esi
		ja	short loc_100248E6

loc_10024917:				; CODE XREF: sub_10024840+CFj
		mov	esi, [ebp+var_10]

loc_1002491A:				; CODE XREF: sub_10024840+11Bj
		push	[ebp+var_8]
		push	[ebp+arg_0]
		call	sub_10024C50
		pop	ecx
		pop	ecx
		push	[ebp+lpMem]	; lpMem
		push	0		; dwFlags
		call	ds:GetProcessHeap
		push	eax		; hHeap
		call	ds:HeapFree
		xor	ebx, ebx
		jmp	loc_100249C6
; ---------------------------------------------------------------------------

loc_10024940:				; CODE XREF: sub_10024840+C8j
		call	sub_10014C05
		cmp	dword ptr [eax], 5
		jnz	short loc_10024955
		call	sub_10014BF2
		mov	dword ptr [eax], 0Dh

loc_10024955:				; CODE XREF: sub_10024840+108j
		or	esi, 0FFFFFFFFh
		mov	[ebp+var_C], esi
		jmp	short loc_1002491A
; ---------------------------------------------------------------------------

loc_1002495D:				; CODE XREF: sub_10024840+51j
					; sub_10024840+5Bj
		cmp	edi, ebx
		jg	short loc_100249D2
		jl	short loc_10024967
		cmp	esi, ebx
		jnb	short loc_100249D2

loc_10024967:				; CODE XREF: sub_10024840+121j
		push	ebx		; dwMoveMethod
		push	[ebp+arg_8]	; int
		push	[ebp+arg_4]	; int
		push	[ebp+arg_0]	; int
		call	sub_10020D18
		and	eax, edx
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jz	loc_100248C8
		push	[ebp+arg_0]
		call	sub_1002100C
		pop	ecx
		push	eax		; hFile
		call	ds:SetEndOfFile
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		cdq
		mov	[ebp+var_10], eax
		and	eax, edx
		mov	[ebp+var_C], edx
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100249D2
		call	sub_10014BF2
		mov	dword ptr [eax], 0Dh
		call	sub_10014C05
		mov	esi, eax
		call	ds:GetLastError
		mov	[esi], eax
		mov	esi, [ebp+var_10]

loc_100249C6:				; CODE XREF: sub_10024840+FBj
		and	esi, [ebp+var_C]
		cmp	esi, 0FFFFFFFFh
		jz	loc_100248C8

loc_100249D2:				; CODE XREF: sub_10024840+11Fj
					; sub_10024840+125j ...
		push	ebx		; dwMoveMethod
		push	[ebp+var_14]	; int
		push	[ebp+var_18]	; int
		push	[ebp+arg_0]	; int
		call	sub_10020D18
		and	eax, edx
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jz	loc_100248C8
		xor	eax, eax
		jmp	loc_100248CF
sub_10024840	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100249F6	proc near		; CODE XREF: .text:10024AF1p

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	10h
		push	offset stru_1002B9F8
		call	__SEH_prolog4
		mov	eax, [ebp+arg_0]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10024A1A
		call	sub_10014C05
		and	dword ptr [eax], 0
		push	9
		pop	eax
		jmp	loc_10024AD3
; ---------------------------------------------------------------------------

loc_10024A1A:				; CODE XREF: sub_100249F6+12j
		xor	edi, edi
		cmp	eax, edi
		jl	short loc_10024A28
		cmp	eax, uNumber
		jb	short loc_10024A4D

loc_10024A28:				; CODE XREF: sub_100249F6+28j
					; sub_100249F6+75j
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		push	9
		pop	esi
		mov	[eax], esi

loc_10024A39:				; CODE XREF: sub_100249F6+96j
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		mov	eax, esi
		jmp	loc_10024AD3
; ---------------------------------------------------------------------------

loc_10024A4D:				; CODE XREF: sub_100249F6+30j
		mov	ecx, eax
		sar	ecx, 5
		lea	ebx, dword_1002F080[ecx*4]
		mov	esi, eax
		and	esi, 1Fh
		imul	esi, 24h
		mov	ecx, [ebx]
		movsx	ecx, byte ptr [ecx+esi+4]
		and	ecx, 1
		jz	short loc_10024A28
		cmp	[ebp+arg_8], edi
		jg	short loc_10024A8E
		jl	short loc_10024A79
		cmp	[ebp+arg_4], edi
		jnb	short loc_10024A8E

loc_10024A79:				; CODE XREF: sub_100249F6+7Cj
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		push	16h
		pop	ecx
		mov	[eax], ecx
		mov	esi, ecx
		jmp	short loc_10024A39
; ---------------------------------------------------------------------------

loc_10024A8E:				; CODE XREF: sub_100249F6+7Aj
					; sub_100249F6+81j
		push	eax
		call	sub_1002109E
		pop	ecx
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebx]
		test	byte ptr [eax+esi+4], 1
		jz	short loc_10024AB7
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10024840
		add	esp, 0Ch
		mov	[ebp+var_1C], eax
		jmp	short loc_10024AC4
; ---------------------------------------------------------------------------

loc_10024AB7:				; CODE XREF: sub_100249F6+A9j
		call	sub_10014BF2
		push	9
		pop	esi
		mov	[eax], esi
		mov	[ebp+var_1C], esi

loc_10024AC4:				; CODE XREF: sub_100249F6+BFj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10024AD9	; Finally handler 0 for	function 100249F6
; ---------------------------------------------------------------------------

loc_10024AD0:				; CODE XREF: sub_100249F6+ECj
		mov	eax, [ebp+var_1C]

loc_10024AD3:				; CODE XREF: sub_100249F6+1Fj
					; sub_100249F6+52j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10024AD9:				; CODE XREF: sub_100249F6+D5j
					; DATA XREF: .rdata:stru_1002B9F8o
		push	[ebp+arg_0]	; Finally handler 0 for	function 100249F6
		call	sub_1002113F
		pop	ecx
		retn
sub_100249F6	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+0Ch]
		cdq
		push	edx
		push	eax
		push	dword ptr [ebp+8]
		call	sub_100249F6
		add	esp, 0Ch
		neg	eax
		sbb	eax, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10024AFF(int,	LONG lDistanceToMove, DWORD dwMoveMethod)
sub_10024AFF	proc near		; CODE XREF: sub_10021F64+335p
					; sub_10021F64+392p ...

arg_0		= dword	ptr  8
lDistanceToMove	= dword	ptr  0Ch
dwMoveMethod	= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		push	esi
		call	sub_1002100C
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10024B24
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		or	eax, 0FFFFFFFFh
		jmp	short loc_10024B71
; ---------------------------------------------------------------------------

loc_10024B24:				; CODE XREF: sub_10024AFF+13j
		push	edi
		push	[ebp+dwMoveMethod] ; dwMoveMethod
		push	0		; lpDistanceToMoveHigh
		push	[ebp+lDistanceToMove] ;	lDistanceToMove
		push	eax		; hFile
		call	ds:SetFilePointer
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_10024B43
		call	ds:GetLastError
		jmp	short loc_10024B45
; ---------------------------------------------------------------------------

loc_10024B43:				; CODE XREF: sub_10024AFF+3Aj
		xor	eax, eax

loc_10024B45:				; CODE XREF: sub_10024AFF+42j
		test	eax, eax
		jz	short loc_10024B55
		push	eax
		call	sub_10014C18
		pop	ecx
		or	eax, 0FFFFFFFFh
		jmp	short loc_10024B70
; ---------------------------------------------------------------------------

loc_10024B55:				; CODE XREF: sub_10024AFF+48j
		mov	eax, esi
		and	esi, 1Fh
		imul	esi, 24h
		sar	eax, 5
		mov	eax, dword_1002F080[eax*4]
		lea	eax, [eax+esi+4]
		and	byte ptr [eax],	0FDh
		mov	eax, edi

loc_10024B70:				; CODE XREF: sub_10024AFF+54j
		pop	edi

loc_10024B71:				; CODE XREF: sub_10024AFF+23j
		pop	esi
		pop	ebp
		retn
sub_10024AFF	endp

; ---------------------------------------------------------------------------
		push	10h
		push	offset dword_1002BA18
		call	__SEH_prolog4
		mov	eax, [ebp+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10024BA3
		call	sub_10014C05
		and	dword ptr [eax], 0
		call	sub_10014BF2
		mov	dword ptr [eax], 9

loc_10024B9B:				; CODE XREF: .text:10024BD0j
		or	eax, 0FFFFFFFFh
		jmp	loc_10024C40
; ---------------------------------------------------------------------------

loc_10024BA3:				; CODE XREF: .text:10024B86j
		xor	edi, edi
		cmp	eax, edi
		jl	short loc_10024BB1
		cmp	eax, uNumber
		jb	short loc_10024BD2

loc_10024BB1:				; CODE XREF: .text:10024BA7j
					; .text:10024BF0j
		call	sub_10014C05
		mov	[eax], edi
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		push	edi
		push	edi
		push	edi
		push	edi
		push	edi
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_10024B9B
; ---------------------------------------------------------------------------

loc_10024BD2:				; CODE XREF: .text:10024BAFj
		mov	ecx, eax
		sar	ecx, 5
		lea	ebx, dword_1002F080[ecx*4]
		mov	esi, eax
		and	esi, 1Fh
		imul	esi, 24h
		mov	ecx, [ebx]
		movsx	ecx, byte ptr [ecx+esi+4]
		and	ecx, 1
		jz	short loc_10024BB1
		push	eax
		call	sub_1002109E
		pop	ecx
		mov	[ebp-4], edi
		mov	eax, [ebx]
		test	byte ptr [eax+esi+4], 1
		jz	short loc_10024C1B
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10024AFF
		add	esp, 0Ch
		mov	[ebp-1Ch], eax
		jmp	short loc_10024C31
; ---------------------------------------------------------------------------

loc_10024C1B:				; CODE XREF: .text:10024C03j
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		call	sub_10014C05
		mov	[eax], edi
		or	dword ptr [ebp-1Ch], 0FFFFFFFFh

loc_10024C31:				; CODE XREF: .text:10024C19j
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10024C46
		mov	eax, [ebp-1Ch]

loc_10024C40:				; CODE XREF: .text:10024B9Ej
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10024C46	proc near		; CODE XREF: .text:10024C38p
					; DATA XREF: .rdata:1002BA30o
		push	dword ptr [ebp+8]
		call	sub_1002113F
		pop	ecx
		retn
sub_10024C46	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024C50	proc near		; CODE XREF: sub_10024840+9Cp
					; sub_10024840+E0p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	edx, [ebp+arg_0]
		mov	eax, edx
		and	edx, 1Fh
		imul	edx, 24h
		sar	eax, 5
		push	ebx
		mov	ebx, [ebp+arg_4]
		push	esi
		lea	esi, dword_1002F080[eax*4]
		mov	eax, [esi]
		lea	ecx, [eax+edx]
		mov	eax, [ecx+8]
		push	edi
		movzx	edi, byte ptr [ecx+4]
		and	edi, 80h
		and	eax, 3
		cmp	ebx, 4000h
		jz	short loc_10024CDD
		cmp	ebx, 8000h
		jz	short loc_10024CD7
		cmp	ebx, 10000h
		jz	short loc_10024CC3
		cmp	ebx, 20000h
		jz	short loc_10024CC3
		cmp	ebx, 40000h
		jnz	short loc_10024CEA
		or	byte ptr [ecx+4], 80h
		mov	ecx, [esi]
		lea	ecx, [ecx+edx+8]
		mov	edx, [ecx]
		and	edx, 0FFFFFFFDh
		or	edx, 1

loc_10024CBF:				; CODE XREF: sub_10024C50+85j
		mov	[ecx], edx
		jmp	short loc_10024CEA
; ---------------------------------------------------------------------------

loc_10024CC3:				; CODE XREF: sub_10024C50+4Bj
					; sub_10024C50+53j
		or	byte ptr [ecx+4], 80h
		mov	ecx, [esi]
		lea	ecx, [ecx+edx+8]
		mov	edx, [ecx]
		and	edx, 0FFFFFFFEh
		or	edx, 2
		jmp	short loc_10024CBF
; ---------------------------------------------------------------------------

loc_10024CD7:				; CODE XREF: sub_10024C50+43j
		and	byte ptr [ecx+4], 7Fh
		jmp	short loc_10024CEA
; ---------------------------------------------------------------------------

loc_10024CDD:				; CODE XREF: sub_10024C50+3Bj
		or	byte ptr [ecx+4], 80h
		mov	ecx, [esi]
		lea	ecx, [ecx+edx+8]
		and	dword ptr [ecx], 0FFFFFFFCh

loc_10024CEA:				; CODE XREF: sub_10024C50+5Bj
					; sub_10024C50+71j ...
		test	edi, edi
		pop	edi
		pop	esi
		pop	ebx
		jnz	short loc_10024CF8
		mov	eax, 8000h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024CF8:				; CODE XREF: sub_10024C50+9Fj
		neg	eax
		sbb	eax, eax
		and	eax, 0C000h
		add	eax, 4000h
		pop	ebp
		retn
sub_10024C50	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, 4000h
		jz	short loc_10024D44
		cmp	eax, 8000h
		jz	short loc_10024D44
		cmp	eax, 10000h
		jz	short loc_10024D44
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024D44:				; CODE XREF: .text:10024D15j
					; .text:10024D1Cj ...
		push	eax
		push	offset dword_1002F058
		call	ds:InterlockedExchange
		xor	eax, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024D54	proc near		; CODE XREF: sub_10021F64+42p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jnz	short loc_10024D80
		call	sub_10014BF2
		push	esi
		push	esi
		push	esi
		push	esi
		push	esi
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		push	16h
		pop	eax
		jmp	short loc_10024D8A
; ---------------------------------------------------------------------------

loc_10024D80:				; CODE XREF: sub_10024D54+Dj
		mov	ecx, dword_1002F058
		mov	[eax], ecx
		xor	eax, eax

loc_10024D8A:				; CODE XREF: sub_10024D54+2Aj
		pop	esi
		pop	ebp
		retn
sub_10024D54	endp

; ---------------------------------------------------------------------------
		push	10h
		push	offset dword_1002BA38
		call	__SEH_prolog4
		mov	eax, [ebp+0Ch]
		cmp	eax, 4000h
		jz	short loc_10024DE1
		cmp	eax, 8000h
		jz	short loc_10024DE1
		cmp	eax, 10000h
		jz	short loc_10024DE1
		cmp	eax, 40000h
		jz	short loc_10024DE1
		cmp	eax, 20000h
		jz	short loc_10024DE1
		call	sub_10014BF2
		mov	dword ptr [eax], 16h
		xor	ebx, ebx

loc_10024DCC:				; CODE XREF: .text:10024E0Fj
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h

loc_10024DD9:				; CODE XREF: .text:10024DF4j
		or	eax, 0FFFFFFFFh
		jmp	loc_10024E74
; ---------------------------------------------------------------------------

loc_10024DE1:				; CODE XREF: .text:10024DA1j
					; .text:10024DA8j ...
		mov	eax, [ebp+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10024DF6
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		jmp	short loc_10024DD9
; ---------------------------------------------------------------------------

loc_10024DF6:				; CODE XREF: .text:10024DE7j
		xor	ebx, ebx
		cmp	eax, ebx
		jl	short loc_10024E04
		cmp	eax, uNumber
		jb	short loc_10024E11

loc_10024E04:				; CODE XREF: .text:10024DFAj
					; .text:10024E2Fj
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		jmp	short loc_10024DCC
; ---------------------------------------------------------------------------

loc_10024E11:				; CODE XREF: .text:10024E02j
		mov	ecx, eax
		sar	ecx, 5
		lea	edi, dword_1002F080[ecx*4]
		mov	esi, eax
		and	esi, 1Fh
		imul	esi, 24h
		mov	ecx, [edi]
		movsx	ecx, byte ptr [ecx+esi+4]
		and	ecx, 1
		jz	short loc_10024E04
		push	eax
		call	sub_1002109E
		pop	ecx
		mov	[ebp-4], ebx
		mov	eax, [edi]
		test	byte ptr [eax+esi+4], 1
		jz	short loc_10024E56
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10024C50
		pop	ecx
		pop	ecx
		mov	[ebp-1Ch], eax
		jmp	short loc_10024E65
; ---------------------------------------------------------------------------

loc_10024E56:				; CODE XREF: .text:10024E42j
		call	sub_10014BF2
		mov	dword ptr [eax], 9
		or	dword ptr [ebp-1Ch], 0FFFFFFFFh

loc_10024E65:				; CODE XREF: .text:10024E54j
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10024E7A
		mov	eax, [ebp-1Ch]

loc_10024E74:				; CODE XREF: .text:10024DDCj
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10024E7A	proc near		; CODE XREF: .text:10024E6Cp
					; DATA XREF: .rdata:1002BA50o
		push	dword ptr [ebp+8]
		call	sub_1002113F
		pop	ecx
		retn
sub_10024E7A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10024E84(int,	LCID Locale, LCTYPE LCType, LPSTR lpMultiByteStr, int cbMultiByte, UINT	CodePage)
sub_10024E84	proc near		; CODE XREF: sub_10024FC3+26p

cchData		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Locale		= dword	ptr  0Ch
LCType		= dword	ptr  10h
lpMultiByteStr	= dword	ptr  14h
cbMultiByte	= dword	ptr  18h
CodePage	= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, dword_1002F054
		push	ebx
		mov	ebx, ds:GetLocaleInfoW
		push	esi
		push	edi
		xor	edi, edi
		xor	esi, esi
		inc	edi
		cmp	eax, esi
		jnz	short loc_10024ED8
		push	esi		; cchData
		push	esi		; lpLCData
		push	edi		; LCType
		push	esi		; Locale
		call	ebx ; GetLocaleInfoW
		test	eax, eax
		jz	short loc_10024EBE
		mov	dword_1002F054,	edi
		jmp	short loc_10024EED
; ---------------------------------------------------------------------------

loc_10024EBE:				; CODE XREF: sub_10024E84+30j
		call	ds:GetLastError
		cmp	eax, 78h
		jnz	short loc_10024ED3
		push	2
		pop	eax
		mov	dword_1002F054,	eax
		jmp	short loc_10024ED8
; ---------------------------------------------------------------------------

loc_10024ED3:				; CODE XREF: sub_10024E84+43j
		mov	eax, dword_1002F054

loc_10024ED8:				; CODE XREF: sub_10024E84+26j
					; sub_10024E84+4Dj
		cmp	eax, 2
		jz	loc_10024F9F
		cmp	eax, esi
		jz	loc_10024F9F
		cmp	eax, edi
		jnz	short loc_10024F10

loc_10024EED:				; CODE XREF: sub_10024E84+38j
		cmp	[ebp+CodePage],	esi
		jnz	short loc_10024EFD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax+4]
		mov	[ebp+CodePage],	eax

loc_10024EFD:				; CODE XREF: sub_10024E84+6Cj
		push	esi		; cchData
		push	esi		; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ebx ; GetLocaleInfoW
		mov	ecx, eax
		mov	[ebp+cchData], ecx
		cmp	ecx, esi
		jnz	short loc_10024F17

loc_10024F10:				; CODE XREF: sub_10024E84+67j
					; sub_10024E84+B5j ...
		xor	eax, eax
		jmp	loc_10024FB1
; ---------------------------------------------------------------------------

loc_10024F17:				; CODE XREF: sub_10024E84+8Aj
		jle	short loc_10024F5E
		push	0FFFFFFE0h
		xor	edx, edx
		pop	eax
		div	ecx
		cmp	eax, 2
		jb	short loc_10024F5E
		lea	eax, [ecx+ecx+8]
		cmp	eax, 400h
		ja	short loc_10024F46
		call	__alloca_probe_16
		mov	edi, esp
		cmp	edi, esi
		jz	short loc_10024F10
		mov	dword ptr [edi], 0CCCCh
		add	edi, 8
		jmp	short loc_10024F60
; ---------------------------------------------------------------------------

loc_10024F46:				; CODE XREF: sub_10024E84+AAj
		push	eax
		call	sub_1000F5A0
		pop	ecx
		cmp	eax, esi
		jz	short loc_10024F5A
		mov	dword ptr [eax], 0DDDDh
		add	eax, 8

loc_10024F5A:				; CODE XREF: sub_10024E84+CBj
		mov	edi, eax
		jmp	short loc_10024F60
; ---------------------------------------------------------------------------

loc_10024F5E:				; CODE XREF: sub_10024E84:loc_10024F17j
					; sub_10024E84+9Fj
		xor	edi, edi

loc_10024F60:				; CODE XREF: sub_10024E84+C0j
					; sub_10024E84+D8j
		cmp	edi, esi
		jz	short loc_10024F10
		push	[ebp+cchData]	; cchData
		push	edi		; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ebx ; GetLocaleInfoW
		test	eax, eax
		jz	short loc_10024F94
		push	esi		; lpUsedDefaultChar
		push	esi		; lpDefaultChar
		cmp	[ebp+cbMultiByte], esi
		jnz	short loc_10024F7F
		push	esi
		push	esi
		jmp	short loc_10024F85
; ---------------------------------------------------------------------------

loc_10024F7F:				; CODE XREF: sub_10024E84+F5j
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr

loc_10024F85:				; CODE XREF: sub_10024E84+F9j
		push	0FFFFFFFFh	; cchWideChar
		push	edi		; lpWideCharStr
		push	esi		; dwFlags
		push	[ebp+CodePage]	; CodePage
		call	ds:WideCharToMultiByte
		mov	esi, eax

loc_10024F94:				; CODE XREF: sub_10024E84+EEj
		push	edi
		call	sub_10010392
		pop	ecx
		mov	eax, esi
		jmp	short loc_10024FB1
; ---------------------------------------------------------------------------

loc_10024F9F:				; CODE XREF: sub_10024E84+57j
					; sub_10024E84+5Fj
		push	[ebp+cbMultiByte] ; cchData
		push	[ebp+lpMultiByteStr] ; lpLCData
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		call	ds:GetLocaleInfoA

loc_10024FB1:				; CODE XREF: sub_10024E84+8Ej
					; sub_10024E84+119j
		lea	esp, [ebp-14h]
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10024E84	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10024FC3(int,	LCID Locale, LCTYPE LCType, LPSTR lpMultiByteStr, int cbMultiByte, UINT	CodePage)
sub_10024FC3	proc near		; CODE XREF: sub_10023B86+50p
					; sub_10023B86+7Cp ...

var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
Locale		= dword	ptr  0Ch
LCType		= dword	ptr  10h
lpMultiByteStr	= dword	ptr  14h
cbMultiByte	= dword	ptr  18h
CodePage	= dword	ptr  1Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	[ebp+arg_0]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		push	[ebp+CodePage]	; CodePage
		lea	eax, [ebp+var_10]
		push	[ebp+cbMultiByte] ; cbMultiByte
		push	[ebp+lpMultiByteStr] ; lpMultiByteStr
		push	[ebp+LCType]	; LCType
		push	[ebp+Locale]	; Locale
		push	eax		; int
		call	sub_10024E84
		add	esp, 18h
		cmp	[ebp+var_4], 0
		jz	short locret_10024FFE
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

locret_10024FFE:			; CODE XREF: sub_10024FC3+32j
		leave
		retn
sub_10024FC3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10025000	proc near		; CODE XREF: sub_10023ED5+9Cp
					; sub_10023FC7+44j

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		mov	ecx, [ebp+arg_8]
		or	ecx, ecx
		jz	short loc_1002505A
		mov	esi, [ebp+arg_0]
		mov	edi, [ebp+arg_4]
		mov	bh, 41h
		mov	bl, 5Ah
		mov	dh, 20h
		lea	ecx, [ecx+0]

loc_1002501C:				; CODE XREF: sub_10025000+49j
		mov	ah, [esi]
		or	ah, ah
		mov	al, [edi]
		jz	short loc_1002504B
		or	al, al
		jz	short loc_1002504B
		add	esi, 1
		add	edi, 1
		cmp	ah, bh
		jb	short loc_10025038
		cmp	ah, bl
		ja	short loc_10025038
		add	ah, dh

loc_10025038:				; CODE XREF: sub_10025000+30j
					; sub_10025000+34j
		cmp	al, bh
		jb	short loc_10025042
		cmp	al, bl
		ja	short loc_10025042
		add	al, dh

loc_10025042:				; CODE XREF: sub_10025000+3Aj
					; sub_10025000+3Ej
		cmp	ah, al
		jnz	short loc_10025051
		sub	ecx, 1
		jnz	short loc_1002501C

loc_1002504B:				; CODE XREF: sub_10025000+22j
					; sub_10025000+26j
		xor	ecx, ecx
		cmp	ah, al
		jz	short loc_1002505A

loc_10025051:				; CODE XREF: sub_10025000+44j
		mov	ecx, 0FFFFFFFFh
		jb	short loc_1002505A
		neg	ecx

loc_1002505A:				; CODE XREF: sub_10025000+Bj
					; sub_10025000+4Fj ...
		mov	eax, ecx
		pop	ebx
		pop	esi
		pop	edi
		leave
		retn
sub_10025000	endp

; ---------------------------------------------------------------------------
		align 2
		jmp	ds:HeapFree
; ---------------------------------------------------------------------------
		jmp	ds:HeapReAlloc
; ---------------------------------------------------------------------------
		jmp	ds:HeapAlloc
; ---------------------------------------------------------------------------
		jmp	ds:GetSystemTimeAsFileTime
; ---------------------------------------------------------------------------
		jmp	ds:InterlockedExchange
; ---------------------------------------------------------------------------
		jmp	ds:LoadLibraryExA
; ---------------------------------------------------------------------------
		jmp	ds:ReadConsoleInputA
; ---------------------------------------------------------------------------
		jmp	ds:SetConsoleMode
; ---------------------------------------------------------------------------
		jmp	ds:GetConsoleMode
; ---------------------------------------------------------------------------
		jmp	ds:PeekConsoleInputA
; ---------------------------------------------------------------------------
		jmp	ds:GetNumberOfConsoleInputEvents
; ---------------------------------------------------------------------------
		jmp	ds:EnterCriticalSection
; ---------------------------------------------------------------------------
		jmp	ds:LeaveCriticalSection
; ---------------------------------------------------------------------------
		jmp	ds:FindClose
; ---------------------------------------------------------------------------
		jmp	ds:FileTimeToSystemTime
; ---------------------------------------------------------------------------
		jmp	ds:FileTimeToLocalFileTime
; ---------------------------------------------------------------------------
		jmp	ds:FindFirstFileA
; ---------------------------------------------------------------------------
		jmp	ds:FindNextFileA
; ---------------------------------------------------------------------------
		jmp	ds:GetCommandLineA
; ---------------------------------------------------------------------------
		jmp	ds:GetCPInfo
; ---------------------------------------------------------------------------
		jmp	ds:InterlockedIncrement
; ---------------------------------------------------------------------------
		jmp	ds:InterlockedDecrement
; ---------------------------------------------------------------------------
		jmp	ds:GetACP
; ---------------------------------------------------------------------------
		jmp	ds:GetOEMCP
; ---------------------------------------------------------------------------
		jmp	ds:GetModuleHandleW
; ---------------------------------------------------------------------------
		jmp	ds:TlsGetValue
; ---------------------------------------------------------------------------
		jmp	ds:TlsAlloc
; ---------------------------------------------------------------------------
		jmp	ds:TlsSetValue
; ---------------------------------------------------------------------------
		jmp	ds:TlsFree
; ---------------------------------------------------------------------------
		jmp	ds:SetLastError
; ---------------------------------------------------------------------------
		jmp	ds:GetCurrentThreadId
; ---------------------------------------------------------------------------
		jmp	ds:GetCurrentThread
; ---------------------------------------------------------------------------
		jmp	ds:OutputDebugStringA
; ---------------------------------------------------------------------------
		jmp	ds:HeapDestroy
; ---------------------------------------------------------------------------
		jmp	ds:HeapCreate
; ---------------------------------------------------------------------------
		jmp	ds:VirtualFree
; ---------------------------------------------------------------------------
		jmp	ds:DeleteCriticalSection
; ---------------------------------------------------------------------------
		jmp	ds:FatalAppExitA
; ---------------------------------------------------------------------------
		jmp	ds:VirtualAlloc
; ---------------------------------------------------------------------------
		jmp	ds:TerminateProcess
; ---------------------------------------------------------------------------
		jmp	ds:GetCurrentProcess
; ---------------------------------------------------------------------------
		jmp	ds:UnhandledExceptionFilter
; ---------------------------------------------------------------------------
		jmp	ds:SetUnhandledExceptionFilter
; ---------------------------------------------------------------------------
		jmp	ds:GetModuleHandleA
; ---------------------------------------------------------------------------
		jmp	ds:ExitProcess
; ---------------------------------------------------------------------------
		jmp	ds:WriteFile
; ---------------------------------------------------------------------------
		jmp	ds:GetStdHandle
; ---------------------------------------------------------------------------
		jmp	ds:GetModuleFileNameA
; ---------------------------------------------------------------------------
		jmp	ds:WideCharToMultiByte
; ---------------------------------------------------------------------------
		jmp	ds:CloseHandle
; ---------------------------------------------------------------------------
		jmp	ds:LCMapStringA
; ---------------------------------------------------------------------------
		jmp	ds:MultiByteToWideChar
; ---------------------------------------------------------------------------
		jmp	ds:LCMapStringW
; ---------------------------------------------------------------------------
		jmp	ds:SetHandleCount
; ---------------------------------------------------------------------------
		jmp	ds:GetFileType
; ---------------------------------------------------------------------------
		jmp	ds:GetStartupInfoA
; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind]
; ---------------------------------------------------------------------------
		jmp	ds:CreateFileA
; ---------------------------------------------------------------------------
		jmp	ds:GetConsoleCP
; ---------------------------------------------------------------------------
		jmp	ds:FlushFileBuffers
; ---------------------------------------------------------------------------
		jmp	ds:FreeEnvironmentStringsA
; ---------------------------------------------------------------------------
		jmp	ds:GetEnvironmentStrings
; ---------------------------------------------------------------------------
		jmp	ds:FreeEnvironmentStringsW
; ---------------------------------------------------------------------------
		jmp	ds:GetEnvironmentStringsW
; ---------------------------------------------------------------------------
		jmp	ds:QueryPerformanceCounter
; ---------------------------------------------------------------------------
		jmp	ds:GetTickCount
; ---------------------------------------------------------------------------
		jmp	ds:GetCurrentProcessId
; ---------------------------------------------------------------------------
		jmp	ds:GetStringTypeA
; ---------------------------------------------------------------------------
		jmp	ds:GetStringTypeW
; ---------------------------------------------------------------------------
		jmp	ds:GetTimeFormatA
; ---------------------------------------------------------------------------
		jmp	ds:GetDateFormatA
; ---------------------------------------------------------------------------
		jmp	ds:GetUserDefaultLCID
; ---------------------------------------------------------------------------
		jmp	ds:GetLocaleInfoA
; ---------------------------------------------------------------------------
		jmp	ds:EnumSystemLocalesA
; ---------------------------------------------------------------------------
		jmp	ds:IsValidLocale
; ---------------------------------------------------------------------------
		jmp	ds:IsValidCodePage
; ---------------------------------------------------------------------------
		jmp	ds:InitializeCriticalSection
; ---------------------------------------------------------------------------
		jmp	ds:SetConsoleCtrlHandler
; ---------------------------------------------------------------------------
		jmp	ds:CompareStringA
; ---------------------------------------------------------------------------
		jmp	ds:CompareStringW
; ---------------------------------------------------------------------------
		jmp	ds:SetEnvironmentVariableA
; ---------------------------------------------------------------------------
		jmp	ds:SetFilePointer
; ---------------------------------------------------------------------------
		jmp	ds:SetStdHandle
; ---------------------------------------------------------------------------
		jmp	ds:VirtualProtect
; ---------------------------------------------------------------------------
		jmp	ds:GetSystemInfo
; ---------------------------------------------------------------------------
		jmp	ds:VirtualQuery
; ---------------------------------------------------------------------------
		jmp	ds:ReadFile
; ---------------------------------------------------------------------------
		jmp	ds:WriteConsoleA
; ---------------------------------------------------------------------------
		jmp	ds:GetConsoleOutputCP
; ---------------------------------------------------------------------------
		jmp	ds:WriteConsoleW
; ---------------------------------------------------------------------------
		jmp	ds:GetTimeZoneInformation
; ---------------------------------------------------------------------------
		jmp	ds:GetLocaleInfoW
; ---------------------------------------------------------------------------
		jmp	ds:SetEndOfFile
; ---------------------------------------------------------------------------
		jmp	ds:GetProcessHeap

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10025296	proc near		; CODE XREF: sub_10025437+34Ep

arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		movzx	eax, [ebp+arg_0]
		push	esi
		mov	esi, [ebp+arg_4]
		cmp	byte ptr [esi+1], 3Ah
		push	edi
		mov	ecx, esi
		jnz	short loc_100252AF
		lea	ecx, [esi+2]

loc_100252AF:				; CODE XREF: sub_10025296+14j
		mov	dl, [ecx]
		cmp	dl, 5Ch
		jz	short loc_100252BB
		cmp	dl, 2Fh
		jnz	short loc_100252C1

loc_100252BB:				; CODE XREF: sub_10025296+1Ej
		cmp	byte ptr [ecx+1], 0
		jz	short loc_100252CE

loc_100252C1:				; CODE XREF: sub_10025296+23j
		test	al, 10h
		jnz	short loc_100252CE
		mov	edi, 8000h
		test	dl, dl
		jnz	short loc_100252D3

loc_100252CE:				; CODE XREF: sub_10025296+29j
					; sub_10025296+2Dj
		mov	edi, 4040h

loc_100252D3:				; CODE XREF: sub_10025296+36j
		shl	eax, 7
		not	eax
		and	eax, 80h
		or	eax, 100h
		push	2Eh
		push	esi
		or	edi, eax
		call	sub_100258B6
		mov	esi, eax
		pop	ecx
		pop	ecx
		test	esi, esi
		jz	short loc_1002533B
		push	offset a_exe	; ".exe"
		push	esi
		call	sub_10022994
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10025338
		push	offset a_cmd	; ".cmd"
		push	esi
		call	sub_10022994
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10025338
		push	offset a_bat	; ".bat"
		push	esi
		call	sub_10022994
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10025338
		push	offset a_com	; ".com"
		push	esi
		call	sub_10022994
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1002533B

loc_10025338:				; CODE XREF: sub_10025296+6Dj
					; sub_10025296+7Ej ...
		or	edi, 40h

loc_1002533B:				; CODE XREF: sub_10025296+5Cj
					; sub_10025296+A0j
		mov	eax, edi
		shr	eax, 3
		and	eax, 38h
		or	edi, eax
		mov	eax, edi
		shr	eax, 6
		and	eax, 7
		or	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_10025296	endp


; =============== S U B	R O U T	I N E =======================================


sub_10025353	proc near		; CODE XREF: sub_10025437+111p
		mov	eax, ecx
		push	esi
		lea	esi, [eax+1]

loc_10025359:				; CODE XREF: sub_10025353+Bj
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_10025359
		sub	eax, esi
		pop	esi
		cmp	eax, 5
		jb	short loc_100253D4
		mov	al, [ecx]
		add	dl, 5Ch
		cmp	al, dl
		jz	short loc_10025375
		cmp	al, 2Fh
		jnz	short loc_100253D4

loc_10025375:				; CODE XREF: sub_10025353+1Cj
		mov	al, [ecx+1]
		cmp	al, dl
		jz	short loc_10025380
		cmp	al, 2Fh
		jnz	short loc_100253D4

loc_10025380:				; CODE XREF: sub_10025353+27j
		mov	al, [ecx+2]
		cmp	al, dl
		jz	short loc_100253D4
		cmp	al, 2Fh
		jz	short loc_100253D4
		lea	eax, [ecx+3]
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_100253D4

loc_10025394:				; CODE XREF: sub_10025353+4Fj
		cmp	cl, dl
		jz	short loc_100253A4
		cmp	cl, 2Fh
		jz	short loc_100253A4
		inc	eax
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_10025394

loc_100253A4:				; CODE XREF: sub_10025353+43j
					; sub_10025353+48j
		cmp	byte ptr [eax],	0
		jz	short loc_100253D4
		inc	eax
		cmp	byte ptr [eax],	0
		jz	short loc_100253D4
		mov	cl, [eax]
		test	cl, cl
		jz	short loc_100253D0

loc_100253B5:				; CODE XREF: sub_10025353+70j
		cmp	cl, dl
		jz	short loc_100253C5
		cmp	cl, 2Fh
		jz	short loc_100253C5
		inc	eax
		mov	cl, [eax]
		test	cl, cl
		jnz	short loc_100253B5

loc_100253C5:				; CODE XREF: sub_10025353+64j
					; sub_10025353+69j
		cmp	byte ptr [eax],	0
		jz	short loc_100253D0
		cmp	byte ptr [eax+1], 0
		jnz	short loc_100253D4

loc_100253D0:				; CODE XREF: sub_10025353+60j
					; sub_10025353+75j
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100253D4:				; CODE XREF: sub_10025353+13j
					; sub_10025353+20j ...
		xor	eax, eax
		retn
sub_10025353	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100253D7	proc near		; CODE XREF: sub_10025437+ECp

arg_0		= dword	ptr  8
lpFileName	= dword	ptr  0Ch
nBufferLength	= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		call	sub_10014BF2
		mov	esi, [eax]
		call	sub_10014BF2
		push	[ebp+nBufferLength] ; nBufferLength
		and	dword ptr [eax], 0
		push	[ebp+lpFileName] ; lpFileName
		push	[ebp+arg_0]	; int
		call	sub_100258CD
		add	esp, 0Ch
		mov	edi, eax
		call	sub_10014BF2
		test	edi, edi
		jz	short loc_1002540F
		mov	[eax], esi
		mov	eax, edi
		jmp	short loc_10025433
; ---------------------------------------------------------------------------

loc_1002540F:				; CODE XREF: sub_100253D7+30j
		cmp	dword ptr [eax], 22h
		jz	short loc_10025418
		xor	eax, eax
		jmp	short loc_10025433
; ---------------------------------------------------------------------------

loc_10025418:				; CODE XREF: sub_100253D7+3Bj
		call	sub_10014BF2
		push	0		; nBufferLength
		push	[ebp+lpFileName] ; lpFileName
		mov	[eax], esi
		push	0		; int
		call	sub_100258CD
		mov	ecx, [ebp+arg_C]
		add	esp, 0Ch
		mov	[ecx], eax

loc_10025433:				; CODE XREF: sub_100253D7+36j
					; sub_100253D7+3Fj
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_100253D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10025437(LPCSTR lpFileName, int)
sub_10025437	proc near		; CODE XREF: sub_100257E9+6j

var_268		= dword	ptr -268h
LocalFileTime	= _FILETIME ptr	-264h
SystemTime	= _SYSTEMTIME ptr -25Ch
hFindFile	= dword	ptr -24Ch
FindFileData	= _WIN32_FIND_DATAA ptr	-248h
var_108		= byte ptr -108h
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 268h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+lpFileName]
		xor	ebx, ebx
		mov	[ebp+LocalFileTime.dwHighDateTime], edi
		cmp	edi, ebx
		jnz	short loc_10025485

loc_10025461:				; CODE XREF: sub_10025437+50j
		call	sub_10014C05
		mov	[eax], ebx
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		jmp	loc_100257D7
; ---------------------------------------------------------------------------

loc_10025485:				; CODE XREF: sub_10025437+28j
		cmp	esi, ebx
		jz	short loc_10025461
		push	offset a?	; "?*"
		push	edi
		call	sub_10025CE0
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_100254B0

loc_1002549A:				; CODE XREF: sub_10025437+88j
					; sub_10025437+D6j ...
		call	sub_10014BF2
		push	2
		pop	esi
		mov	[eax], esi
		call	sub_10014C05
		mov	[eax], esi
		jmp	loc_100257D7
; ---------------------------------------------------------------------------

loc_100254B0:				; CODE XREF: sub_10025437+61j
		cmp	byte ptr [edi+1], 3Ah
		jnz	short loc_100254D0
		mov	al, [edi]
		cmp	al, bl
		jz	short loc_100254C1
		cmp	[edi+2], bl
		jz	short loc_1002549A

loc_100254C1:				; CODE XREF: sub_10025437+83j
		movsx	eax, al
		push	eax
		call	sub_10025C00
		pop	ecx
		sub	eax, 60h
		jmp	short loc_100254D5
; ---------------------------------------------------------------------------

loc_100254D0:				; CODE XREF: sub_10025437+7Dj
		call	sub_100259EF

loc_100254D5:				; CODE XREF: sub_10025437+97j
		mov	[ebp+var_268], eax
		lea	eax, [ebp+FindFileData]
		push	eax		; lpFindFileData
		push	edi		; lpFileName
		call	ds:FindFirstFileA
		mov	[ebp+hFindFile], eax
		cmp	eax, 0FFFFFFFFh
		jnz	loc_100255D4
		push	offset a_	; "./\\"
		push	edi
		mov	[ebp+hFindFile], ebx
		call	sub_10025CE0
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1002549A
		lea	eax, [ebp+hFindFile]
		push	eax
		push	104h
		lea	eax, [ebp+var_108]
		push	edi
		push	eax
		call	sub_100253D7
		mov	edi, eax
		add	esp, 10h
		cmp	edi, ebx
		jz	loc_100255B7
		lea	edx, [eax+1]

loc_10025538:				; CODE XREF: sub_10025437+106j
		mov	cl, [eax]
		inc	eax
		cmp	cl, bl
		jnz	short loc_10025538
		sub	eax, edx
		cmp	eax, 3
		jz	short loc_10025551
		mov	ecx, edi
		call	sub_10025353
		test	eax, eax
		jz	short loc_100255B7

loc_10025551:				; CODE XREF: sub_10025437+10Dj
		push	edi		; lpRootPathName
		call	ds:GetDriveTypeA
		cmp	eax, 1
		jbe	short loc_100255B7
		cmp	[ebp+hFindFile], ebx
		jz	short loc_10025571
		push	[ebp+hFindFile]	; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10025571:				; CODE XREF: sub_10025437+12Cj
		push	0FFFFFFFFh
		push	ebx
		push	ebx
		push	ebx
		push	1
		push	1
		push	7BCh
		mov	[ebp+FindFileData.dwFileAttributes], 10h
		mov	[ebp+FindFileData.nFileSizeHigh], ebx
		mov	[ebp+FindFileData.nFileSizeLow], ebx
		mov	[ebp+FindFileData.cFileName], bl
		call	sub_10019201
		mov	edi, [ebp+LocalFileTime.dwHighDateTime]
		add	esp, 1Ch
		mov	[esi+1Ch], eax
		mov	[esi+18h], eax
		mov	[esi+20h], eax
		jmp	loc_1002577E
; ---------------------------------------------------------------------------

loc_100255B7:				; CODE XREF: sub_10025437+F8j
					; sub_10025437+118j ...
		cmp	[ebp+hFindFile], ebx
		jz	loc_1002549A
		push	[ebp+hFindFile]	; lpMem
		call	sub_1000EE73
		pop	ecx
		jmp	loc_1002549A
; ---------------------------------------------------------------------------

loc_100255D4:				; CODE XREF: sub_10025437+BBj
		cmp	[ebp+FindFileData.ftLastWriteTime.dwLowDateTime], ebx
		jnz	short loc_100255E9
		cmp	[ebp+FindFileData.ftLastWriteTime.dwHighDateTime], ebx
		jnz	short loc_100255E9
		mov	[esi+1Ch], ebx
		jmp	short loc_1002565E
; ---------------------------------------------------------------------------

loc_100255E9:				; CODE XREF: sub_10025437+1A3j
					; sub_10025437+1ABj
		lea	eax, [ebp+LocalFileTime]
		push	eax		; lpLocalFileTime
		lea	eax, [ebp+FindFileData.ftLastWriteTime]
		push	eax		; lpFileTime
		call	ds:FileTimeToLocalFileTime
		test	eax, eax
		jz	loc_100257BE
		lea	eax, [ebp+SystemTime]
		push	eax		; lpSystemTime
		lea	eax, [ebp+LocalFileTime]
		push	eax		; lpFileTime
		call	ds:FileTimeToSystemTime
		test	eax, eax
		jz	loc_100257BE
		movzx	eax, [ebp+SystemTime.wSecond]
		push	0FFFFFFFFh
		push	eax
		movzx	eax, [ebp+SystemTime.wMinute]
		push	eax
		movzx	eax, [ebp+SystemTime.wHour]
		push	eax
		movzx	eax, [ebp+SystemTime.wDay]
		push	eax
		movzx	eax, [ebp+SystemTime.wMonth]
		push	eax
		movzx	eax, [ebp+SystemTime.wYear]
		push	eax
		call	sub_10019201
		add	esp, 1Ch
		mov	[esi+1Ch], eax

loc_1002565E:				; CODE XREF: sub_10025437+1B0j
		cmp	[ebp+FindFileData.ftLastAccessTime.dwLowDateTime], ebx
		jnz	short loc_10025673
		cmp	[ebp+FindFileData.ftLastAccessTime.dwHighDateTime], ebx
		jnz	short loc_10025673
		mov	eax, [esi+1Ch]
		jmp	short loc_100256E5
; ---------------------------------------------------------------------------

loc_10025673:				; CODE XREF: sub_10025437+22Dj
					; sub_10025437+235j
		lea	eax, [ebp+LocalFileTime]
		push	eax		; lpLocalFileTime
		lea	eax, [ebp+FindFileData.ftLastAccessTime]
		push	eax		; lpFileTime
		call	ds:FileTimeToLocalFileTime
		test	eax, eax
		jz	loc_100257BE
		lea	eax, [ebp+SystemTime]
		push	eax		; lpSystemTime
		lea	eax, [ebp+LocalFileTime]
		push	eax		; lpFileTime
		call	ds:FileTimeToSystemTime
		test	eax, eax
		jz	loc_100257BE
		movzx	eax, [ebp+SystemTime.wSecond]
		push	0FFFFFFFFh
		push	eax
		movzx	eax, [ebp+SystemTime.wMinute]
		push	eax
		movzx	eax, [ebp+SystemTime.wHour]
		push	eax
		movzx	eax, [ebp+SystemTime.wDay]
		push	eax
		movzx	eax, [ebp+SystemTime.wMonth]
		push	eax
		movzx	eax, [ebp+SystemTime.wYear]
		push	eax
		call	sub_10019201
		add	esp, 1Ch

loc_100256E5:				; CODE XREF: sub_10025437+23Aj
		mov	[esi+18h], eax
		cmp	[ebp+FindFileData.ftCreationTime.dwLowDateTime], ebx
		jnz	short loc_100256FD
		cmp	[ebp+FindFileData.ftCreationTime.dwHighDateTime], ebx
		jnz	short loc_100256FD
		mov	eax, [esi+1Ch]
		jmp	short loc_1002576F
; ---------------------------------------------------------------------------

loc_100256FD:				; CODE XREF: sub_10025437+2B7j
					; sub_10025437+2BFj
		lea	eax, [ebp+LocalFileTime]
		push	eax		; lpLocalFileTime
		lea	eax, [ebp+FindFileData.ftCreationTime]
		push	eax		; lpFileTime
		call	ds:FileTimeToLocalFileTime
		test	eax, eax
		jz	loc_100257BE
		lea	eax, [ebp+SystemTime]
		push	eax		; lpSystemTime
		lea	eax, [ebp+LocalFileTime]
		push	eax		; lpFileTime
		call	ds:FileTimeToSystemTime
		test	eax, eax
		jz	loc_100257BE
		movzx	eax, [ebp+SystemTime.wSecond]
		push	0FFFFFFFFh
		push	eax
		movzx	eax, [ebp+SystemTime.wMinute]
		push	eax
		movzx	eax, [ebp+SystemTime.wHour]
		push	eax
		movzx	eax, [ebp+SystemTime.wDay]
		push	eax
		movzx	eax, [ebp+SystemTime.wMonth]
		push	eax
		movzx	eax, [ebp+SystemTime.wYear]
		push	eax
		call	sub_10019201
		add	esp, 1Ch

loc_1002576F:				; CODE XREF: sub_10025437+2C4j
		push	[ebp+hFindFile]	; hFindFile
		mov	[esi+20h], eax
		call	ds:FindClose

loc_1002577E:				; CODE XREF: sub_10025437+17Bj
		push	edi
		push	[ebp+FindFileData.dwFileAttributes]
		call	sub_10025296
		mov	[esi+6], ax
		xor	eax, eax
		inc	eax
		mov	[esi+8], ax
		mov	eax, [ebp+FindFileData.nFileSizeLow]
		mov	[esi+14h], eax
		xor	eax, eax
		mov	[esi+4], ax
		mov	[esi+0Ch], ax
		mov	[esi+0Ah], ax
		mov	eax, [ebp+var_268]
		dec	eax
		pop	ecx
		mov	[esi], eax
		mov	[esi+10h], eax
		pop	ecx
		xor	eax, eax
		jmp	short loc_100257DA
; ---------------------------------------------------------------------------

loc_100257BE:				; CODE XREF: sub_10025437+1C8j
					; sub_10025437+1E4j ...
		call	ds:GetLastError
		push	eax
		call	sub_10014C18
		pop	ecx
		push	[ebp+hFindFile]	; hFindFile
		call	ds:FindClose

loc_100257D7:				; CODE XREF: sub_10025437+49j
					; sub_10025437+74j
		or	eax, 0FFFFFFFFh

loc_100257DA:				; CODE XREF: sub_10025437+385j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_10025437	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100257E9	proc near		; CODE XREF: sub_1000C9A0+12Ep
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	sub_10025437
sub_100257E9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100257F4	proc near		; CODE XREF: sub_100258B6+Dp

var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	ebx
		push	esi
		push	[ebp+arg_8]
		xor	ebx, ebx
		lea	ecx, [ebp+var_14]
		mov	[ebp+var_4], ebx
		call	sub_1000E615
		mov	esi, [ebp+var_10]
		cmp	[esi+8], ebx
		jnz	short loc_10025835
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100113A0
		pop	ecx
		pop	ecx
		cmp	[ebp+var_8], bl
		jz	loc_100258B2
		mov	ecx, [ebp+var_C]
		and	dword ptr [ecx+70h], 0FFFFFFFDh
		jmp	short loc_100258B2
; ---------------------------------------------------------------------------

loc_10025835:				; CODE XREF: sub_100257F4+20j
		mov	ecx, [ebp+arg_0]
		cmp	ecx, ebx
		jnz	short loc_10025864
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_8], bl
		jz	short loc_10025860
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10025860:				; CODE XREF: sub_100257F4+63j
		xor	eax, eax
		jmp	short loc_100258B2
; ---------------------------------------------------------------------------

loc_10025864:				; CODE XREF: sub_100257F4+46j
		push	edi

loc_10025865:				; CODE XREF: sub_100257F4+ACj
		mov	dl, [ecx]
		movzx	eax, dl
		movzx	edi, al
		test	byte ptr [edi+esi+1Dh],	4
		jz	short loc_10025895
		inc	ecx
		mov	dl, [ecx]
		cmp	dl, bl
		jz	short loc_10025890
		movzx	edi, dl
		shl	eax, 8
		or	eax, edi
		cmp	[ebp+arg_4], eax
		jnz	short loc_1002589D
		lea	eax, [ecx-1]
		mov	[ebp+var_4], eax
		jmp	short loc_1002589D
; ---------------------------------------------------------------------------

loc_10025890:				; CODE XREF: sub_100257F4+85j
		cmp	[ebp+var_4], ebx
		jmp	short loc_10025898
; ---------------------------------------------------------------------------

loc_10025895:				; CODE XREF: sub_100257F4+7Ej
		cmp	[ebp+arg_4], eax

loc_10025898:				; CODE XREF: sub_100257F4+9Fj
		jnz	short loc_1002589D
		mov	[ebp+var_4], ecx

loc_1002589D:				; CODE XREF: sub_100257F4+92j
					; sub_100257F4+9Aj ...
		inc	ecx
		cmp	dl, bl
		jnz	short loc_10025865
		pop	edi
		cmp	[ebp+var_8], bl
		jz	short loc_100258AF
		mov	eax, [ebp+var_C]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_100258AF:				; CODE XREF: sub_100257F4+B2j
		mov	eax, [ebp+var_4]

loc_100258B2:				; CODE XREF: sub_100257F4+32j
					; sub_100257F4+3Fj ...
		pop	esi
		pop	ebx
		leave
		retn
sub_100257F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100258B6	proc near		; CODE XREF: sub_10025296+51p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_100257F4
		add	esp, 0Ch
		pop	ebp
		retn
sub_100258B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100258CD(int,	LPCSTR lpFileName, DWORD nBufferLength)
sub_100258CD	proc near		; CODE XREF: sub_100253D7+1Fp
					; sub_100253D7+4Fp ...

FilePart	= dword	ptr -8
lpBuffer	= dword	ptr -4
arg_0		= dword	ptr  8
lpFileName	= dword	ptr  0Ch
nBufferLength	= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+lpFileName]
		push	ebx
		xor	ebx, ebx
		push	esi
		push	edi
		cmp	eax, ebx
		jz	loc_100259C5
		cmp	[eax], bl
		jz	loc_100259C5
		mov	esi, ds:GetFullPathNameA
		cmp	[ebp+arg_0], ebx
		jnz	short loc_10025952
		push	ebx		; lpFilePart
		push	ebx		; lpBuffer
		push	ebx		; nBufferLength
		push	eax		; lpFileName
		call	esi ; GetFullPathNameA
		cmp	eax, ebx
		jnz	short loc_10025914

loc_10025901:				; CODE XREF: sub_100258CD+DFj
					; sub_100258CD+EEj
		call	ds:GetLastError
		push	eax
		call	sub_10014C18
		xor	eax, eax
		jmp	loc_100259D1
; ---------------------------------------------------------------------------

loc_10025914:				; CODE XREF: sub_100258CD+32j
		mov	edi, [ebp+nBufferLength]
		cmp	edi, eax
		ja	short loc_1002591D
		mov	edi, eax

loc_1002591D:				; CODE XREF: sub_100258CD+4Cj
		cmp	edi, 0FFFFFFFFh
		jbe	short loc_10025934
		call	sub_10014BF2
		mov	dword ptr [eax], 16h

loc_1002592D:				; CODE XREF: sub_100258CD+83j
					; sub_100258CD+A4j ...
		xor	eax, eax
		jmp	loc_100259D2
; ---------------------------------------------------------------------------

loc_10025934:				; CODE XREF: sub_100258CD+53j
		push	1
		push	edi
		call	sub_1000F496
		pop	ecx
		pop	ecx
		mov	[ebp+lpBuffer],	eax
		cmp	eax, ebx
		jnz	short loc_10025979
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		jmp	short loc_1002592D
; ---------------------------------------------------------------------------

loc_10025952:				; CODE XREF: sub_100258CD+28j
		mov	edi, [ebp+nBufferLength]
		cmp	edi, ebx
		ja	short loc_10025973
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		jmp	short loc_1002592D
; ---------------------------------------------------------------------------

loc_10025973:				; CODE XREF: sub_100258CD+8Aj
		mov	eax, [ebp+arg_0]
		mov	[ebp+lpBuffer],	eax

loc_10025979:				; CODE XREF: sub_100258CD+76j
		lea	eax, [ebp+FilePart]
		push	eax		; lpFilePart
		push	[ebp+lpBuffer]	; lpBuffer
		push	edi		; nBufferLength
		push	[ebp+lpFileName] ; lpFileName
		call	esi ; GetFullPathNameA
		cmp	eax, edi
		jb	short loc_100259A5
		cmp	[ebp+arg_0], ebx
		jnz	short loc_10025998
		push	[ebp+lpBuffer]	; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10025998:				; CODE XREF: sub_100258CD+C0j
		call	sub_10014BF2
		mov	dword ptr [eax], 22h
		jmp	short loc_1002592D
; ---------------------------------------------------------------------------

loc_100259A5:				; CODE XREF: sub_100258CD+BBj
		cmp	eax, ebx
		jnz	short loc_100259C0
		cmp	[ebp+arg_0], ebx
		jnz	loc_10025901
		push	[ebp+lpBuffer]	; lpMem
		call	sub_1000EE73
		pop	ecx
		jmp	loc_10025901
; ---------------------------------------------------------------------------

loc_100259C0:				; CODE XREF: sub_100258CD+DAj
		mov	eax, [ebp+lpBuffer]
		jmp	short loc_100259D2
; ---------------------------------------------------------------------------

loc_100259C5:				; CODE XREF: sub_100258CD+11j
					; sub_100258CD+19j
		push	[ebp+nBufferLength]
		push	[ebp+arg_0]
		call	sub_10025E58
		pop	ecx

loc_100259D1:				; CODE XREF: sub_100258CD+42j
		pop	ecx

loc_100259D2:				; CODE XREF: sub_100258CD+62j
					; sub_100258CD+F6j
		pop	edi
		pop	esi
		pop	ebx
		leave
		retn
sub_100258CD	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_100258CD
		add	esp, 0Ch
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100259EF	proc near		; CODE XREF: sub_10025437:loc_100254D0p

nBufferLength	= dword	ptr -114h
var_110		= dword	ptr -110h
Buffer		= byte ptr -10Ch
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 114h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+var_110], 0
		push	ebx
		push	esi
		push	edi
		mov	edi, ds:GetCurrentDirectoryA
		lea	ebx, [ebp+Buffer]
		mov	eax, ebx
		push	eax		; lpBuffer
		push	105h		; nBufferLength
		call	edi ; GetCurrentDirectoryA
		mov	esi, eax
		cmp	esi, 104h
		jle	short loc_10025A6F
		lea	eax, [esi+1]
		push	1
		push	eax
		mov	[ebp+nBufferLength], eax
		call	sub_1000F496
		mov	ebx, eax
		pop	ecx
		pop	ecx
		test	ebx, ebx
		jnz	short loc_10025A56
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		xor	esi, esi
		jmp	short loc_10025A6F
; ---------------------------------------------------------------------------

loc_10025A56:				; CODE XREF: sub_100259EF+56j
		mov	[ebp+var_110], 1
		test	esi, esi
		jz	short loc_10025A6F
		push	ebx		; lpBuffer
		push	[ebp+nBufferLength] ; nBufferLength
		call	edi ; GetCurrentDirectoryA
		mov	esi, eax

loc_10025A6F:				; CODE XREF: sub_100259EF+3Dj
					; sub_100259EF+65j ...
		xor	edi, edi
		test	esi, esi
		jz	short loc_10025A8C
		cmp	byte ptr [ebx+1], 3Ah
		jnz	short loc_10025A97
		movzx	eax, byte ptr [ebx]
		push	eax
		call	sub_1002600E
		mov	edi, eax
		pop	ecx
		sub	edi, 40h
		jmp	short loc_10025A97
; ---------------------------------------------------------------------------

loc_10025A8C:				; CODE XREF: sub_100259EF+84j
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch

loc_10025A97:				; CODE XREF: sub_100259EF+8Aj
					; sub_100259EF+9Bj
		cmp	[ebp+var_110], 0
		jz	short loc_10025AA7
		push	ebx		; lpMem
		call	sub_1000EE73
		pop	ecx

loc_10025AA7:				; CODE XREF: sub_100259EF+AFj
		mov	ecx, [ebp+var_4]
		mov	eax, edi
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
sub_100259EF	endp

; ---------------------------------------------------------------------------
		push	10h
		push	offset dword_1002BA58
		call	__SEH_prolog4
		cmp	dword ptr [ebp+8], 1
		jl	short loc_10025AD0
		cmp	dword ptr [ebp+8], 1Fh
		jle	short loc_10025AFA

loc_10025AD0:				; CODE XREF: .text:10025AC8j
		call	sub_10014C05
		mov	dword ptr [eax], 0Fh
		call	sub_10014BF2
		mov	dword ptr [eax], 0Dh
		xor	ebx, ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		call	sub_10014B5B
		add	esp, 14h
		or	eax, 0FFFFFFFFh
		jmp	short loc_10025B4B
; ---------------------------------------------------------------------------

loc_10025AFA:				; CODE XREF: .text:10025ACEj
		push	7
		call	sub_100152C7
		pop	ecx
		xor	ebx, ebx
		mov	[ebp-4], ebx
		movsx	eax, byte ptr [ebp+8]
		add	eax, 40h
		mov	[ebp-1Ch], al
		mov	byte ptr [ebp-1Bh], 3Ah
		mov	[ebp-1Ah], bl
		lea	eax, [ebp-1Ch]
		push	eax
		call	ds:SetCurrentDirectoryA
		test	eax, eax
		jz	short loc_10025B2B
		mov	[ebp-20h], ebx
		jmp	short loc_10025B3C
; ---------------------------------------------------------------------------

loc_10025B2B:				; CODE XREF: .text:10025B24j
		call	ds:GetLastError
		push	eax
		call	sub_10014C18
		pop	ecx
		or	dword ptr [ebp-20h], 0FFFFFFFFh

loc_10025B3C:				; CODE XREF: .text:10025B29j
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10025B51
		mov	eax, [ebp-20h]

loc_10025B4B:				; CODE XREF: .text:10025AF8j
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10025B51	proc near		; CODE XREF: .text:10025B43p
					; DATA XREF: .rdata:1002BA70o
		push	7
		call	sub_100151D0
		pop	ecx
		retn
sub_10025B51	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10025B5A	proc near		; CODE XREF: sub_10025C00+Ap

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
DestStr		= word ptr -8
MultiByteStr	= byte ptr -4
var_3		= byte ptr -3
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_18]
		call	sub_1000E615
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 0FFh
		jbe	short loc_10025BDA
		mov	eax, ebx
		shr	eax, 8
		movzx	ecx, al
		mov	[ebp+MultiByteStr], al
		mov	eax, [ebp+var_14]
		mov	[ebp+var_3], bl
		test	byte ptr [ecx+eax+1Dh],	4
		jnz	short loc_10025BA2

loc_10025B91:				; CODE XREF: sub_10025B5A+6Fj
		cmp	[ebp+var_C], 0
		jz	short loc_10025B9E
		mov	eax, [ebp+var_10]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10025B9E:				; CODE XREF: sub_10025B5A+3Bj
		mov	eax, ebx
		jmp	short loc_10025BFD
; ---------------------------------------------------------------------------

loc_10025BA2:				; CODE XREF: sub_10025B5A+35j
		push	1		; int
		push	dword ptr [eax+4] ; CodePage
		lea	ecx, [ebp+DestStr]
		push	2		; cchDest
		push	ecx		; lpDestStr
		push	2		; cbMultiByte
		lea	ecx, [ebp+MultiByteStr]
		push	ecx		; lpMultiByteStr
		push	100h		; dwMapFlags
		push	dword ptr [eax+0Ch] ; Locale
		lea	eax, [ebp+var_18]
		push	eax		; int
		call	sub_10017580
		add	esp, 24h
		test	eax, eax
		jz	short loc_10025B91
		movzx	eax, byte ptr [ebp+DestStr]
		movzx	ecx, byte ptr [ebp+DestStr+1]
		shl	eax, 8
		add	eax, ecx
		jmp	short loc_10025BF0
; ---------------------------------------------------------------------------

loc_10025BDA:				; CODE XREF: sub_10025B5A+1Dj
		mov	eax, [ebp+var_14]
		add	eax, ebx
		test	byte ptr [eax+1Dh], 10h
		jz	short loc_10025BEE
		movzx	eax, byte ptr [eax+11Dh]
		jmp	short loc_10025BF0
; ---------------------------------------------------------------------------

loc_10025BEE:				; CODE XREF: sub_10025B5A+89j
		mov	eax, ebx

loc_10025BF0:				; CODE XREF: sub_10025B5A+7Ej
					; sub_10025B5A+92j
		cmp	[ebp+var_C], 0
		jz	short loc_10025BFD
		mov	ecx, [ebp+var_10]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

loc_10025BFD:				; CODE XREF: sub_10025B5A+46j
					; sub_10025B5A+9Aj
		pop	ebx
		leave
		retn
sub_10025B5A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10025C00	proc near		; CODE XREF: sub_10025437+8Ep

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_0]
		call	sub_10025B5A
		pop	ecx
		pop	ecx
		pop	ebp
		retn
sub_10025C00	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10025C13	proc near		; CODE XREF: sub_10025CE0+Dp

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	ebx
		push	esi
		push	[ebp+arg_8]
		lea	ecx, [ebp+var_10]
		call	sub_1000E615
		mov	esi, [ebp+var_C]
		xor	ebx, ebx
		cmp	[esi+8], ebx
		jnz	short loc_10025C44
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_1001D070
		pop	ecx
		pop	ecx
		jmp	loc_10025CD0
; ---------------------------------------------------------------------------

loc_10025C44:				; CODE XREF: sub_10025C13+1Dj
		mov	ecx, [ebp+arg_0]
		cmp	ecx, ebx
		jnz	short loc_10025C73

loc_10025C4B:				; CODE XREF: sub_10025C13+63j
		call	sub_10014BF2
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		push	ebx
		mov	dword ptr [eax], 16h
		call	sub_10014B5B
		add	esp, 14h
		cmp	[ebp+var_4], bl
		jz	short loc_10025C6F
		mov	eax, [ebp+var_8]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10025C6F:				; CODE XREF: sub_10025C13+53j
		xor	eax, eax
		jmp	short loc_10025CDC
; ---------------------------------------------------------------------------

loc_10025C73:				; CODE XREF: sub_10025C13+36j
		cmp	[ebp+arg_4], ebx
		jz	short loc_10025C4B
		cmp	[ecx], bl
		jz	short loc_10025CC7
		push	edi

loc_10025C7D:				; CODE XREF: sub_10025C13+B1j
		mov	eax, [ebp+arg_4]
		jmp	short loc_10025CAA
; ---------------------------------------------------------------------------

loc_10025C82:				; CODE XREF: sub_10025C13+99j
		mov	dl, [eax]
		movzx	edi, dl
		test	byte ptr [edi+esi+1Dh],	4
		jz	short loc_10025CA5
		cmp	dl, [ecx]
		jnz	short loc_10025C9A
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jz	short loc_10025CAE

loc_10025C9A:				; CODE XREF: sub_10025C13+7Dj
		lea	edx, [eax+1]
		cmp	[edx], bl
		jz	short loc_10025CAE
		mov	eax, edx
		jmp	short loc_10025CA9
; ---------------------------------------------------------------------------

loc_10025CA5:				; CODE XREF: sub_10025C13+79j
		cmp	dl, [ecx]
		jz	short loc_10025CAE

loc_10025CA9:				; CODE XREF: sub_10025C13+90j
		inc	eax

loc_10025CAA:				; CODE XREF: sub_10025C13+6Dj
		cmp	[eax], bl
		jnz	short loc_10025C82

loc_10025CAE:				; CODE XREF: sub_10025C13+85j
					; sub_10025C13+8Cj ...
		cmp	[eax], bl
		jnz	short loc_10025CC6
		movzx	eax, byte ptr [ecx]
		test	byte ptr [eax+esi+1Dh],	4
		jz	short loc_10025CC1
		inc	ecx
		cmp	[ecx], bl
		jz	short loc_10025CC6

loc_10025CC1:				; CODE XREF: sub_10025C13+A7j
		inc	ecx
		cmp	[ecx], bl
		jnz	short loc_10025C7D

loc_10025CC6:				; CODE XREF: sub_10025C13+9Dj
					; sub_10025C13+ACj
		pop	edi

loc_10025CC7:				; CODE XREF: sub_10025C13+67j
		movzx	eax, byte ptr [ecx]
		neg	eax
		sbb	eax, eax
		and	eax, ecx

loc_10025CD0:				; CODE XREF: sub_10025C13+2Cj
		cmp	[ebp+var_4], bl
		jz	short loc_10025CDC
		mov	ecx, [ebp+var_8]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

loc_10025CDC:				; CODE XREF: sub_10025C13+5Ej
					; sub_10025C13+C0j
		pop	esi
		pop	ebx
		leave
		retn
sub_10025C13	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10025CE0	proc near		; CODE XREF: sub_10025437+58p
					; sub_10025437+CDp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	0
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10025C13
		add	esp, 0Ch
		pop	ebp
		retn
sub_10025CE0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10025CF7(CHAR	RootPathName)
sub_10025CF7	proc near		; CODE XREF: sub_10025D30+23p

RootPathName	= byte ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, dword ptr [ebp+RootPathName]
		test	eax, eax
		jnz	short loc_10025D08

loc_10025D03:				; CODE XREF: sub_10025CF7+33j
		xor	eax, eax
		inc	eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10025D08:				; CODE XREF: sub_10025CF7+Aj
		add	al, 40h
		mov	[ebp+RootPathName], al
		lea	eax, [ebp+RootPathName]
		push	eax		; lpRootPathName
		mov	byte ptr [ebp+9], 3Ah
		mov	byte ptr [ebp+0Ah], 5Ch
		mov	byte ptr [ebp+0Bh], 0
		call	ds:GetDriveTypeA
		test	eax, eax
		jz	short loc_10025D2C
		cmp	eax, 1
		jnz	short loc_10025D03

loc_10025D2C:				; CODE XREF: sub_10025CF7+2Ej
		xor	eax, eax
		pop	ebp
		retn
sub_10025CF7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10025D30(CHAR	RootPathName, int, int)
sub_10025D30	proc near		; CODE XREF: sub_10025E58+20p
					; .text:10025EC2p

FilePart	= dword	ptr -114h
var_110		= dword	ptr -110h
FileName	= byte ptr -10Ch
var_10B		= byte ptr -10Bh
var_10A		= byte ptr -10Ah
var_109		= byte ptr -109h
Buffer		= byte ptr -108h
var_4		= dword	ptr -4
RootPathName	= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 114h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, dword ptr [ebp+RootPathName]
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		test	ebx, ebx
		jz	short loc_10025DC5
		push	ebx		; RootPathName
		call	sub_10025CF7
		pop	ecx
		test	eax, eax
		jnz	short loc_10025D84
		call	sub_10014C05
		mov	dword ptr [eax], 0Fh
		call	sub_10014BF2
		mov	dword ptr [eax], 0Dh

loc_10025D73:				; CODE XREF: sub_10025D30+AAj
					; sub_10025D30+AFj ...
		xor	eax, eax

loc_10025D75:				; CODE XREF: sub_10025D30+123j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		leave
		retn
; ---------------------------------------------------------------------------

loc_10025D84:				; CODE XREF: sub_10025D30+2Bj
		lea	eax, [ebp+FilePart]
		push	eax		; lpFilePart
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	esi, 104h
		push	esi		; nBufferLength
		lea	eax, [ebp+FileName]
		add	bl, 40h
		push	eax		; lpFileName
		mov	[ebp+FileName],	bl
		mov	[ebp+var_10B], 3Ah
		mov	[ebp+var_10A], 2Eh
		mov	[ebp+var_109], 0
		call	ds:GetFullPathNameA
		jmp	short loc_10025DD8
; ---------------------------------------------------------------------------

loc_10025DC5:				; CODE XREF: sub_10025D30+20j
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	esi, 104h
		push	esi		; nBufferLength
		call	ds:GetCurrentDirectoryA

loc_10025DD8:				; CODE XREF: sub_10025D30+93j
		test	eax, eax
		jz	short loc_10025D73
		inc	eax
		cmp	eax, esi
		ja	short loc_10025D73
		mov	esi, edi
		test	edi, edi
		jnz	short loc_10025E29
		cmp	eax, [ebp+arg_8]
		jle	short loc_10025DEF
		mov	[ebp+arg_8], eax

loc_10025DEF:				; CODE XREF: sub_10025D30+BAj
		lea	eax, [ebp+var_110]
		push	eax
		push	0
		push	[ebp+arg_8]
		call	sub_100196E0
		add	esp, 0Ch
		test	eax, eax
		jl	short loc_10025E19
		push	[ebp+var_110]
		call	sub_1000F5A0
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jnz	short loc_10025E3E

loc_10025E19:				; CODE XREF: sub_10025D30+D5j
		call	sub_10014BF2
		mov	dword ptr [eax], 0Ch
		jmp	loc_10025D73
; ---------------------------------------------------------------------------

loc_10025E29:				; CODE XREF: sub_10025D30+B5j
		cmp	eax, [ebp+arg_8]
		jle	short loc_10025E3E
		call	sub_10014BF2
		mov	dword ptr [eax], 22h
		jmp	loc_10025D73
; ---------------------------------------------------------------------------

loc_10025E3E:				; CODE XREF: sub_10025D30+E7j
					; sub_10025D30+FCj
		lea	eax, [ebp+Buffer]
		push	eax
		push	[ebp+arg_8]
		push	esi
		call	sub_10016B60
		add	esp, 0Ch
		mov	eax, esi
		jmp	loc_10025D75
sub_10025D30	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10025E58	proc near		; CODE XREF: sub_100258CD+FEp

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	0Ch
		push	offset stru_1002BA78
		call	__SEH_prolog4
		push	7
		call	sub_100152C7
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	[ebp+arg_4]	; int
		push	[ebp+arg_0]	; int
		push	0		; RootPathName
		call	sub_10025D30
		add	esp, 0Ch
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10025E98	; Finally handler 0 for	function 10025E58
; ---------------------------------------------------------------------------

loc_10025E8F:				; CODE XREF: sub_10025E58+48j
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10025E98:				; CODE XREF: sub_10025E58+32j
					; DATA XREF: .rdata:stru_1002BA78o
		push	7		; Finally handler 0 for	function 10025E58
		call	sub_100151D0
		pop	ecx
		retn
sub_10025E58	endp

; ---------------------------------------------------------------------------
		push	0Ch
		push	offset dword_1002BA98
		call	__SEH_prolog4
		push	7
		call	sub_100152C7
		pop	ecx
		and	dword ptr [ebp-4], 0
		push	dword ptr [ebp+10h]
		push	dword ptr [ebp+0Ch]
		push	dword ptr [ebp+8]
		call	sub_10025D30
		add	esp, 0Ch
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-4], 0FFFFFFFEh
		call	sub_10025EE2
		mov	eax, [ebp-1Ch]
		call	__SEH_epilog4
		retn

; =============== S U B	R O U T	I N E =======================================


sub_10025EE2	proc near		; CODE XREF: .text:10025ED4p
					; DATA XREF: .rdata:1002BAB0o
		push	7
		call	sub_100151D0
		pop	ecx
		retn
sub_10025EE2	endp

; ---------------------------------------------------------------------------
		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		add	eax, 0FFFFFFE0h
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10025EF8	proc near		; CODE XREF: sub_1002600E+23p

var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
DestStr		= word ptr -8
MultiByteStr	= byte ptr -4
var_3		= byte ptr -3
var_2		= byte ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_18]
		call	sub_1000E615
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 100h
		jnb	short loc_10025F6B
		mov	ecx, [ebp+var_18]
		cmp	dword ptr [ecx+0ACh], 1
		jle	short loc_10025F37
		lea	eax, [ebp+var_18]
		push	eax
		push	2
		push	ebx
		call	sub_10013BD0
		mov	ecx, [ebp+var_18]
		add	esp, 0Ch
		jmp	short loc_10025F44
; ---------------------------------------------------------------------------

loc_10025F37:				; CODE XREF: sub_10025EF8+29j
		mov	eax, [ecx+0C8h]
		movzx	eax, word ptr [eax+ebx*2]
		and	eax, 2

loc_10025F44:				; CODE XREF: sub_10025EF8+3Dj
		test	eax, eax
		jz	short loc_10025F57
		mov	eax, [ecx+0D0h]
		movzx	eax, byte ptr [eax+ebx]
		jmp	loc_10025FFE
; ---------------------------------------------------------------------------

loc_10025F57:				; CODE XREF: sub_10025EF8+4Ej
					; sub_10025EF8+EEj
		cmp	[ebp+var_C], 0
		jz	short loc_10025F64
		mov	eax, [ebp+var_10]
		and	dword ptr [eax+70h], 0FFFFFFFDh

loc_10025F64:				; CODE XREF: sub_10025EF8+63j
		mov	eax, ebx
		jmp	loc_1002600B
; ---------------------------------------------------------------------------

loc_10025F6B:				; CODE XREF: sub_10025EF8+1Dj
		mov	eax, [ebp+var_18]
		cmp	dword ptr [eax+0ACh], 1
		jle	short loc_10025FA8
		mov	[ebp+arg_0], ebx
		sar	[ebp+arg_0], 8
		lea	eax, [ebp+var_18]
		push	eax
		mov	eax, [ebp+arg_0]
		and	eax, 0FFh
		push	eax
		call	sub_100175C6
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10025FA8
		mov	al, byte ptr [ebp+arg_0]
		push	2
		mov	[ebp+MultiByteStr], al
		mov	[ebp+var_3], bl
		mov	[ebp+var_2], 0
		pop	ecx
		jmp	short loc_10025FBD
; ---------------------------------------------------------------------------

loc_10025FA8:				; CODE XREF: sub_10025EF8+7Dj
					; sub_10025EF8+9Cj
		call	sub_10014BF2
		mov	dword ptr [eax], 2Ah
		xor	ecx, ecx
		mov	[ebp+MultiByteStr], bl
		mov	[ebp+var_3], 0
		inc	ecx

loc_10025FBD:				; CODE XREF: sub_10025EF8+AEj
		mov	eax, [ebp+var_18]
		push	1		; int
		push	dword ptr [eax+4] ; CodePage
		lea	edx, [ebp+DestStr]
		push	3		; cchDest
		push	edx		; lpDestStr
		push	ecx		; cbMultiByte
		lea	ecx, [ebp+MultiByteStr]
		push	ecx		; lpMultiByteStr
		push	200h		; dwMapFlags
		push	dword ptr [eax+14h] ; Locale
		lea	eax, [ebp+var_18]
		push	eax		; int
		call	sub_10017580
		add	esp, 24h
		test	eax, eax
		jz	loc_10025F57
		cmp	eax, 1
		movzx	eax, byte ptr [ebp+DestStr]
		jz	short loc_10025FFE
		movzx	ecx, byte ptr [ebp+DestStr+1]
		shl	eax, 8
		or	eax, ecx

loc_10025FFE:				; CODE XREF: sub_10025EF8+5Aj
					; sub_10025EF8+FBj
		cmp	[ebp+var_C], 0
		jz	short loc_1002600B
		mov	ecx, [ebp+var_10]
		and	dword ptr [ecx+70h], 0FFFFFFFDh

loc_1002600B:				; CODE XREF: sub_10025EF8+6Ej
					; sub_10025EF8+10Aj
		pop	ebx
		leave
		retn
sub_10025EF8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002600E	proc near		; CODE XREF: sub_100259EF+90p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	dword_1002E61C,	0
		jnz	short loc_1002602C
		mov	eax, [ebp+arg_0]
		lea	ecx, [eax-61h]
		cmp	ecx, 19h
		ja	short loc_10026038
		add	eax, 0FFFFFFE0h
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1002602C:				; CODE XREF: sub_1002600E+Cj
		push	0
		push	[ebp+arg_0]
		call	sub_10025EF8
		pop	ecx
		pop	ecx

loc_10026038:				; CODE XREF: sub_1002600E+17j
		pop	ebp
		retn
sub_1002600E	endp

; ---------------------------------------------------------------------------
		jmp	ds:GetDriveTypeA
; ---------------------------------------------------------------------------
		jmp	ds:GetFullPathNameA
; ---------------------------------------------------------------------------
		jmp	ds:GetCurrentDirectoryA
; ---------------------------------------------------------------------------
		jmp	ds:SetCurrentDirectoryA
; ---------------------------------------------------------------------------
		align 200h
		dd 380h	dup(?)
_text		ends

; Section 2. (virtual address 00027000)
; Virtual size			: 00005C68 (  23656.)
; Section size in file		: 00005E00 (  24064.)
; Offset to raw	data for section: 00025600
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_10005C20+7Dp
					; sub_10005C20+C9p
					; DATA XREF: ...
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_10005C20+187p
					; DATA XREF: sub_10005C20+187r	...
; BOOL __stdcall GetUserNameA(LPSTR lpBuffer, LPDWORD pcbBuffer)
		extrn GetUserNameA:dword ; CODE	XREF: .text:100051E2p
					; DATA XREF: .text:100051E2r ...
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_10005C20+22p
					; DATA XREF: sub_10005C20+22r ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall SetEndOfFile(HANDLE hFile)
		extrn SetEndOfFile:dword ; CODE	XREF: sub_10024840+14Ep
					; DATA XREF: sub_10024840+14Er	...
; int __stdcall	GetLocaleInfoW(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int	cchData)
		extrn GetLocaleInfoW:dword ; CODE XREF:	sub_10023B86+155p
					; sub_10023B86+17Ep ...
; DWORD	__stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR	lpDst, DWORD nSize)
		extrn ExpandEnvironmentStringsA:dword ;	CODE XREF: sub_10005C20+134p
					; sub_10005C20+162p
					; DATA XREF: ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sasl_setpass+39Cp
					; sub_1000C8E0+3Fp ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_1000C830+5Ep
					; sub_10010272+80p ...
; HANDLE __stdcall GetProcessHeap()
		extrn GetProcessHeap:dword ; CODE XREF:	sub_10024840+69p
					; sub_10024840+ECp
					; DATA XREF: ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: sub_1000C970+16p
					; sub_1000CD60+1Dp ...
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
		extrn LocalFree:dword	; CODE XREF: .text:1000DCF8p
					; .text:1000DD0Ep
					; DATA XREF: ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	.text:1000DCCEp
					; DATA XREF: .text:1000DCCEr ...
; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA	lpVersionInformation)
		extrn GetVersionExA:dword ; CODE XREF: .text:1000DD4Fp
					; sub_10011438+34p
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: .text:1000DF3Bp
					; .text:1001D0BAp ...
; UINT __stdcall GetDriveTypeA(LPCSTR lpRootPathName)
		extrn GetDriveTypeA:dword ; CODE XREF: sub_10025437+11Bp
					; sub_10025CF7+26p
					; DATA XREF: ...
; DWORD	__stdcall GetFullPathNameA(LPCSTR lpFileName, DWORD nBufferLength, LPSTR lpBuffer, LPSTR *lpFilePart)
		extrn GetFullPathNameA:dword ; CODE XREF: sub_100258CD+2Ep
					; sub_100258CD+B7p ...
; DWORD	__stdcall GetCurrentDirectoryA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetCurrentDirectoryA:dword ; CODE	XREF: sub_100259EF+33p
					; sub_100259EF+7Cp ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_1000C8E0+35p
					; DATA XREF: sub_1000C8E0+35r ...
; LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAlloc:dword ; CODE	XREF: sub_1001573B+77p
					; sub_100157EB+54p ...
; BOOL __stdcall HeapFree(HANDLE hHeap,	DWORD dwFlags, LPVOID lpMem)
		extrn HeapFree:dword	; CODE XREF: sub_1000EE73+68p
					; sub_100150AE+3Fp ...
; LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes)
		extrn HeapReAlloc:dword	; CODE XREF: sub_1000F114+134p
					; sub_1000F114+1B5p ...
; LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes)
		extrn HeapAlloc:dword	; CODE XREF: sub_1000F114+DDp
					; sub_1000F378+BEp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_1001016B+Cp
					; sub_100101B0+Cp ...
; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
		extrn InterlockedExchange:dword	; CODE XREF: sub_10010272+D1p
					; .text:10024D4Ap
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryExA(LPCSTR lpLibFileName, HANDLE	hFile, DWORD dwFlags)
		extrn LoadLibraryExA:dword ; CODE XREF:	sub_10010272+4Fp
					; sub_10020306+31p
					; DATA XREF: ...
; BOOL __stdcall ReadConsoleInputA(HANDLE hConsoleInput, PINPUT_RECORD lpBuffer, DWORD nLength,	LPDWORD	lpNumberOfEventsRead)
		extrn ReadConsoleInputA:dword ;	CODE XREF: sub_1001048C+A0p
					; DATA XREF: sub_1001048C+5Fr ...
; BOOL __stdcall SetConsoleMode(HANDLE hConsoleHandle, DWORD dwMode)
		extrn SetConsoleMode:dword ; CODE XREF:	sub_1001048C+5Dp
					; sub_1001048C+B8p
					; DATA XREF: ...
; BOOL __stdcall GetConsoleMode(HANDLE hConsoleHandle, LPDWORD lpMode)
		extrn GetConsoleMode:dword ; CODE XREF:	sub_1001048C+49p
					; sub_1001838C+122p
					; DATA XREF: ...
; BOOL __stdcall PeekConsoleInputA(HANDLE hConsoleInput, PINPUT_RECORD lpBuffer, DWORD nLength,	LPDWORD	lpNumberOfEventsRead)
		extrn PeekConsoleInputA:dword ;	CODE XREF: sub_10010592+BEp
					; DATA XREF: sub_10010592+BEr ...
; BOOL __stdcall GetNumberOfConsoleInputEvents(HANDLE hConsoleInput, LPDWORD lpNumberOfEvents)
		extrn GetNumberOfConsoleInputEvents:dword ; CODE XREF: sub_10010592+4Bp
					; DATA XREF: sub_10010592+4Br ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_10010C50+2Dp
					; sub_10010C85+20p ...
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_10010CAD+2Dp
					; sub_10010CE2+20p ...
; BOOL __stdcall FindClose(HANDLE hFindFile)
		extrn FindClose:dword	; CODE XREF: sub_100110B0+8p
					; sub_10025437+341p ...
; BOOL __stdcall FileTimeToSystemTime(const FILETIME *lpFileTime, LPSYSTEMTIME lpSystemTime)
		extrn FileTimeToSystemTime:dword ; CODE	XREF: sub_100110D6+2Dp
					; sub_10025437+1DCp ...
; BOOL __stdcall FileTimeToLocalFileTime(const FILETIME	*lpFileTime, LPFILETIME	lpLocalFileTime)
		extrn FileTimeToLocalFileTime:dword ; CODE XREF: sub_100110D6+1Bp
					; sub_10025437+1C0p ...
; HANDLE __stdcall FindFirstFileA(LPCSTR lpFileName, LPWIN32_FIND_DATAA	lpFindFileData)
		extrn FindFirstFileA:dword ; CODE XREF:	sub_1001113C+50p
					; sub_10025437+ACp
					; DATA XREF: ...
; BOOL __stdcall FindNextFileA(HANDLE hFindFile, LPWIN32_FIND_DATAA lpFindFileData)
		extrn FindNextFileA:dword ; CODE XREF: sub_10011263+59p
					; DATA XREF: sub_10011263+59r ...
; LPSTR	__stdcall GetCommandLineA()
		extrn GetCommandLineA:dword ; CODE XREF: sub_10011438:loc_100114E4p
					; DATA XREF: sub_10011438:loc_100114E4r ...
; BOOL __stdcall GetCPInfo(UINT	CodePage, LPCPINFO lpCPInfo)
		extrn GetCPInfo:dword	; CODE XREF: sub_10011BFD+21p
					; sub_10011EB7+58p ...
; LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend)
		extrn InterlockedIncrement:dword ; CODE	XREF: sub_10011D90+72p
					; sub_100120AC+9Bp ...
; LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend)
		extrn InterlockedDecrement:dword ; CODE	XREF: sub_10011D90+47p
					; sub_100120AC+76p ...
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: sub_10011E3B+4Cp
					; DATA XREF: sub_10011E3B+4Cr ...
; UINT __stdcall GetOEMCP()
		extrn GetOEMCP:dword	; CODE XREF: sub_10011E3B+29p
					; DATA XREF: sub_10011E3B+29r ...
; HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName)
		extrn GetModuleHandleW:dword ; CODE XREF: sub_10013548+44p
					; sub_10013548+4Fp ...
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_10013548+12p
					; sub_10013548+29p ...
; DWORD	__stdcall TlsAlloc()
		extrn TlsAlloc:dword	; CODE XREF: sub_10013637p
					; sub_10013A07:loc_10013AA3p
					; DATA XREF: ...
; BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue)
		extrn TlsSetValue:dword	; CODE XREF: sub_10013660+23p
					; sub_1001398D+66p ...
; BOOL __stdcall TlsFree(DWORD dwTlsIndex)
		extrn TlsFree:dword	; CODE XREF: sub_100136A7+2Bp
					; DATA XREF: sub_100136A7+2Br ...
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn SetLastError:dword ; CODE	XREF: sub_100137AC+71p
					; sub_1001F928+BAp
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_10019B54+4Bp
					; DATA XREF: .text:100139FBr ...
; HANDLE __stdcall GetCurrentThread()
		extrn GetCurrentThread:dword ; DATA XREF: .text:10013A01r
					; .text:1002511Cr
; void __stdcall OutputDebugStringA(LPCSTR lpOutputString)
		extrn OutputDebugStringA:dword ; CODE XREF: sub_10014AB5+94p
					; DATA XREF: sub_10014AB5+94r ...
; BOOL __stdcall HeapDestroy(HANDLE hHeap)
		extrn HeapDestroy:dword	; CODE XREF: sub_1001504E+4Cp
					; sub_100150AE+66p
					; DATA XREF: ...
; HANDLE __stdcall HeapCreate(DWORD flOptions, SIZE_T dwInitialSize, SIZE_T dwMaximumSize)
		extrn HeapCreate:dword	; CODE XREF: sub_1001504E+15p
					; DATA XREF: sub_1001504E+15r ...
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: sub_100150AE+2Fp
					; sub_10015425+249p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_100136A7+1AEFp
					; sub_100136A7+1B19p ...
; void __stdcall FatalAppExitA(UINT uAction, LPCSTR lpMessageText)
		extrn FatalAppExitA:dword ; CODE XREF: .text:100151F1p
					; DATA XREF: .text:100151F1r ...
; BOOL __stdcall SetCurrentDirectoryA(LPCSTR lpPathName)
		extrn SetCurrentDirectoryA:dword ; CODE	XREF: .text:10025B1Cp
					; DATA XREF: .text:10025B1Cr ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: sub_10016319+DAp
					; DATA XREF: sub_10016319+DAr ...
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_10016319+D3p
					; DATA XREF: sub_10016319+D3r ...
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: sub_10016319+C8p
					; sub_100242C7+109p
					; DATA XREF: ...
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_10016319+BDp
					; sub_100242C7+FCp
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_100164CB+Ap
					; sub_10024460+7p
					; DATA XREF: ...
; void __stdcall __noreturn ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; CODE XREF: sub_100164F6+11p
					; DATA XREF: sub_100164F6+11r ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_100167DD+17Ap
					; sub_1001838C+241p ...
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: sub_100167DD+14Cp
					; sub_100179DC+1AEp
					; DATA XREF: ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_100167DD+A2p
					; sub_1001992E+32p
					; DATA XREF: ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_10016AC9+2Ap
					; sub_10016AC9+50p ...
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_10016EA6+4Fp
					; sub_10018272+17p ...
; int __stdcall	LCMapStringA(LCID Locale, DWORD	dwMapFlags, LPCSTR lpSrcStr, int cchSrc, LPSTR lpDestStr, int cchDest)
		extrn LCMapStringA:dword ; CODE	XREF: sub_100170CC+366p
					; sub_100170CC+41Cp ...
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_100170CC+CBp
					; sub_100170CC+17Fp ...
; int __stdcall	LCMapStringW(LCID Locale, DWORD	dwMapFlags, LPCWSTR lpSrcStr, int cchSrc, LPWSTR lpDestStr, int	cchDest)
		extrn LCMapStringW:dword ; CODE	XREF: sub_100170CC+2Ap
					; sub_100170CC+19Bp ...
; UINT __stdcall SetHandleCount(UINT uNumber)
		extrn SetHandleCount:dword ; CODE XREF:	sub_100179DC+219p
					; DATA XREF: sub_100179DC+219r	...
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: sub_100179DC+123p
					; sub_100179DC+1C0p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_100179DC+15p
					; DATA XREF: sub_100179DC+15r ...
; void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD	ExceptionRecord, PVOID ReturnValue)
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_10018234+13p
					; sub_10018253+13p ...
; UINT __stdcall GetConsoleCP()
		extrn GetConsoleCP:dword ; CODE	XREF: sub_1001838C:loc_100184CDp
					; DATA XREF: sub_1001838C:loc_100184CDr ...
; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
		extrn FlushFileBuffers:dword ; CODE XREF: sub_10018B44+8Cp
					; DATA XREF: sub_10018B44+8Cr ...
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn FreeEnvironmentStringsA:dword ; CODE XREF: sub_10019A1D+111p
					; sub_10019A1D+12Ap
					; DATA XREF: ...
; LPCH __stdcall GetEnvironmentStrings()
		extrn GetEnvironmentStrings:dword ; CODE XREF: sub_10019A1D:loc_10019AFCp
					; DATA XREF: sub_10019A1D:loc_10019AFCr ...
; BOOL __stdcall FreeEnvironmentStringsW(LPWCH)
		extrn FreeEnvironmentStringsW:dword ; CODE XREF: sub_10019A1D+CCp
					; DATA XREF: sub_10019A1D+CCr ...
; LPWCH	__stdcall GetEnvironmentStringsW()
		extrn GetEnvironmentStringsW:dword ; CODE XREF:	sub_10019A1D+1Ep
					; sub_10019A1D+59p
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_10019B54+5Fp
					; DATA XREF: sub_10019B54+5Fr ...
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_10019B54+53p
					; DATA XREF: sub_10019B54+53r ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_10019B54+43p
					; DATA XREF: sub_10019B54+43r ...
; BOOL __stdcall GetStringTypeA(LCID Locale, DWORD dwInfoType, LPCSTR lpSrcStr,	int cchSrc, LPWORD lpCharType)
		extrn GetStringTypeA:dword ; CODE XREF:	sub_10019BEB+193p
					; sub_100245D7+1D7p
					; DATA XREF: ...
; BOOL __stdcall GetStringTypeW(DWORD dwInfoType, LPCWSTR lpSrcStr, int	cchSrc,	LPWORD lpCharType)
		extrn GetStringTypeW:dword ; CODE XREF:	sub_10019BEB+2Fp
					; sub_10019BEB+11Ep ...
; int __stdcall	GetTimeFormatA(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpTime, LPCSTR lpFormat, LPSTR lpTimeStr, int cchTime)
		extrn GetTimeFormatA:dword ; DATA XREF:	sub_1001C020+56r
					; .text:10025200r
; int __stdcall	GetDateFormatA(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpDate, LPCSTR lpFormat, LPSTR lpDateStr, int cchDate)
		extrn GetDateFormatA:dword ; CODE XREF:	sub_1001C020+A9p
					; DATA XREF: sub_1001C020+4Er ...
; LCID __stdcall GetUserDefaultLCID()
		extrn GetUserDefaultLCID:dword ; CODE XREF: .text:1001C7EFp
					; sub_1001CDB0:loc_1001CE9Cp
					; DATA XREF: ...
; int __stdcall	GetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData)
		extrn GetLocaleInfoA:dword ; CODE XREF:	sub_1001C7FC+59p
					; sub_1001C8EB+46p ...
; BOOL __stdcall EnumSystemLocalesA(LOCALE_ENUMPROCA lpLocaleEnumProc, DWORD dwFlags)
		extrn EnumSystemLocalesA:dword ; CODE XREF: .text:1001CCE2p
					; sub_1001CCF3+55p ...
; BOOL __stdcall IsValidLocale(LCID Locale, DWORD dwFlags)
		extrn IsValidLocale:dword ; CODE XREF: sub_1001CDB0+152p
					; DATA XREF: sub_1001CDB0+152r	...
; BOOL __stdcall IsValidCodePage(UINT CodePage)
		extrn IsValidCodePage:dword ; CODE XREF: sub_1001CDB0+13Fp
					; DATA XREF: sub_1001CDB0+13Fr	...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_1001F913+8p
					; DATA XREF: sub_1001F913+8r ...
; BOOL __stdcall SetConsoleCtrlHandler(PHANDLER_ROUTINE	HandlerRoutine,	BOOL Add)
		extrn SetConsoleCtrlHandler:dword ; CODE XREF: .text:10020030p
					; DATA XREF: .text:10020030r ...
; int __stdcall	CompareStringA(LCID Locale, DWORD dwCmpFlags, PCNZCH lpString1,	int cchCount1, PCNZCH lpString2, int cchCount2)
		extrn CompareStringA:dword ; CODE XREF:	sub_1002052C+342p
					; DATA XREF: sub_1002052C+342r	...
; int __stdcall	CompareStringW(LCID Locale, DWORD dwCmpFlags, PCNZWCH lpString1, int cchCount1,	PCNZWCH	lpString2, int cchCount2)
		extrn CompareStringW:dword ; CODE XREF:	sub_1002052C+39p
					; sub_1002052C+288p
					; DATA XREF: ...
; BOOL __stdcall SetEnvironmentVariableA(LPCSTR	lpName,	LPCSTR lpValue)
		extrn SetEnvironmentVariableA:dword ; CODE XREF: sub_10020AAD+220p
					; DATA XREF: sub_10020AAD+220r	...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	sub_10020D18+42p
					; sub_10024AFF+2Fp
					; DATA XREF: ...
; BOOL __stdcall SetStdHandle(DWORD nStdHandle,	HANDLE hHandle)
		extrn SetStdHandle:dword ; CODE	XREF: sub_10020F05:loc_10020F5Cp
					; sub_10020F86:loc_10020FE2p
					; DATA XREF: ...
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_10021623+142p
					; DATA XREF: sub_10021623+142r	...
; void __stdcall GetSystemInfo(LPSYSTEM_INFO lpSystemInfo)
		extrn GetSystemInfo:dword ; CODE XREF: sub_10021623+61p
					; DATA XREF: sub_10021623+61r ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_10021623+49p
					; DATA XREF: sub_10021623+49r ...
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: sub_100218DF+17Dp
					; sub_100218DF+2A1p ...
; BOOL __stdcall WriteConsoleA(HANDLE hConsoleOutput, const void *lpBuffer, DWORD nNumberOfCharsToWrite, LPDWORD lpNumberOfCharsWritten, LPVOID	lpReserved)
		extrn WriteConsoleA:dword ; CODE XREF: sub_10022C67+9Ep
					; DATA XREF: sub_10022C67+9Er ...
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: sub_10022C67+7Bp
					; DATA XREF: sub_10022C67+7Br ...
; BOOL __stdcall WriteConsoleW(HANDLE hConsoleOutput, const void *lpBuffer, DWORD nNumberOfCharsToWrite, LPDWORD lpNumberOfCharsWritten, LPVOID	lpReserved)
		extrn WriteConsoleW:dword ; CODE XREF: sub_10022C67+48p
					; DATA XREF: sub_10022C67+48r ...
; DWORD	__stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)
		extrn GetTimeZoneInformation:dword ; CODE XREF:	sub_10022F7A+174p
					; DATA XREF: sub_10022F7A+174r	...

;
; Imports from WS2_32.dll
;
; int __stdcall	gethostname(char *name,	int namelen)
		extrn gethostname:dword	; CODE XREF: sub_10009420+10p
					; DATA XREF: sub_10009420+10r ...
; void __stdcall WSASetLastError(int iError)
		extrn WSASetLastError:dword ; CODE XREF: sub_10009420+A6p
					; DATA XREF: sub_10009420+A6r ...
; u_long __stdcall htonl(u_long	hostlong)
		extrn htonl:dword	; CODE XREF: sub_10008C00+5Ap
					; sub_10008C00+62p
					; DATA XREF: ...
; u_long __stdcall ntohl(u_long	netlong)
		extrn ntohl:dword	; CODE XREF: sub_100081B0+34p
					; sub_100081B0+3Dp ...
; INT __stdcall	getaddrinfo(PCSTR pNodeName, PCSTR pServiceName, const ADDRINFOA *pHints, PADDRINFOA *ppResult)
		extrn getaddrinfo:dword	; CODE XREF: sub_100057B0+EFp
					; sub_10009420+67p ...
; void __stdcall freeaddrinfo(PADDRINFOA pAddrInfo)
		extrn freeaddrinfo:dword ; CODE	XREF: sub_100057B0+12Bp
					; sub_100057B0+15Dp ...


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 100271E0h
dword_100271E0	dd 0			; DATA XREF: sub_100165FB+55o
dword_100271E4	dd 0			; DATA XREF: sub_100165FB+50o
dword_100271E8	dd 0			; DATA XREF: sub_100165FB+36o
		dd offset sub_100101B0
		dd offset sub_10010B7F
		dd offset sub_100119F3
		dd offset sub_10012246
dword_100271FC	dd 0			; DATA XREF: sub_100165FB+31o
dword_10027200	dd 0			; DATA XREF: sub_10016683+73o
		dd offset sub_10018272
		dd offset sub_10010C30
dword_1002720C	dd 0			; DATA XREF: sub_10016683:loc_100166F1o
dword_10027210	dd 0			; DATA XREF: sub_10016683+83o
dword_10027214	dd 3 dup(0)		; DATA XREF: sub_10016683:loc_10016701o
; Debug	Directory entries
		dd 0			; Characteristics
		dd 503C3F5Ah		; TimeDateStamp: Tue Aug 28 03:47:38 2012
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd 2			; Type:	IMAGE_DEBUG_TYPE_CODEVIEW
		dd 49h			; SizeOfData
		dd rva asc_1002B158	; AddressOfRawData
		dd 29758h		; PointerToRawData
aAuxpropfuncErr	db 'auxpropfunc error %s',0Ah,0 ; DATA XREF: sasl_auxprop_add_plugin+3Fo
		align 4
aCouldNotFind_0	db 'could not find auxprop plugin, was searching for ',27h,'%s',27h,0
					; DATA XREF: sub_100019F0+25Ao
		align 4
aAll		db '[all]',0            ; DATA XREF: sub_100019F0:loc_10001C3Eo
					; sasl_auxprop_store:loc_10001F10o
		align 4
aAuxprop_plug_0	db 'auxprop_plugin',0   ; DATA XREF: sub_100019F0+41o
					; sasl_auxprop_store+7Ao
		align 4
aCouldNotFindAu	db 'could not find auxprop plugin, was searching for %s',0
					; DATA XREF: sasl_auxprop_store+236o
asc_100272D8	db 0Ah,0		; DATA XREF: .text:10001FA9o
					; .text:loc_10004331o ...
		align 4
aSupportsStoreS	db 9,'supports store: %s',0Ah,0 ; DATA XREF: .text:10001F9Fo
		align 4
aNo		db 'no',0               ; DATA XREF: .text:10001F99o
					; .text:1000B5FEo
		align 4
aYes		db 'yes',0              ; DATA XREF: .text:10001F92o
					; .text:1000B5F7o
aApiVersionD	db ', ',9,'API version: %d',0Ah,0 ; DATA XREF: .text:10001F80o
					; .text:1000415Fo ...
aPluginS	db 'Plugin "%s" ',0     ; DATA XREF: .text:10001F74o
					; .text:10004148o ...
		align 10h
aListOfAuxpropP	db 'List of auxprop plugins follows',0Ah,0 ; DATA XREF: .text:10001F58o
		align 4
aParameterError	db 'Parameter error in auxprop.c near line %d',0
					; DATA XREF: sasl_auxprop_request+18o
		align 10h
aInternal	db 'INTERNAL',0         ; DATA XREF: sub_10002440+143o
					; sub_10007860+47o ...
		align 4
aDesiredCanon_u	db 'desired canon_user plugin %s not found',0 ; DATA XREF: sub_10002440+1D4o
		align 4
aCanon_user_plu	db 'canon_user_plugin',0 ; DATA XREF: sub_10002440+12Eo
		align 4
aBadPlugnamePas	db 'bad plugname passed to sasl_canonuser_add_plugin',0Ah,0
					; DATA XREF: sasl_canonuser_add_plugin:loc_10002936o
		align 4
aCanonuserPlugi	db 'canonuser plugin without either client or server side',0
					; DATA XREF: sasl_canonuser_add_plugin+71o
		align 4
aCanonuserfuncE	db 'canonuserfunc error %i',0Ah,0 ; DATA XREF: sasl_canonuser_add_plugin+4Ao
aAllWhitespaceU	db 'All-whitespace username.',0 ; DATA XREF: sub_10002950+C3o
		align 4
aAuxpropHashed	db 'auxprop-hashed',0   ; DATA XREF: .data:1002D030o
		align 4
aAuxprop	db 'auxprop',0          ; DATA XREF: sub_1000B080+BEo
					; sub_1000B080+1ADo ...
aSasldb		db 'sasldb',0           ; DATA XREF: sub_10002BC0+4Fo
		align 4
aCmusaslsecretp	db '*cmusaslsecretPLAIN',0 ; DATA XREF: sub_10002C80+29o
aUserpassword_0	db '*userPassword',0    ; DATA XREF: sub_10002C80+21o
					; sub_10002F00+Co ...
		align 4
dword_1002749C	dd 4002h, 4004h, 0	; DATA XREF: sub_10003A00+Bo
aVersionConflic	db 'version conflict in sasl_client_add_plugin for %s',0
					; DATA XREF: sasl_client_add_plugin+64o
		align 4
aEntry_pointFai	db 'entry_point failed in sasl_client_add_plugin for %s',0
					; DATA XREF: sasl_client_add_plugin+43o
aExternal	db 'EXTERNAL',0         ; DATA XREF: sasl_client_init+B5o
					; sasl_server_init+169o ...
		align 4
aSasl_canonus_0	db 'sasl_canonuser_init',0 ; DATA XREF: sasl_client_init+32o
					; sasl_server_init+3Eo
aSasl_client__1	db 'sasl_client_plug_init',0 ; DATA XREF: sasl_client_init+22o
		align 4
aNoWorthyMechsF	db 'No worthy mechs found',0 ; DATA XREF: sasl_client_new+325o
					; sasl_client_start:loc_100046F5o
		align 10h
aOutOfMemoryInS	db 'Out of memory in sasl_client_new',0 ; DATA XREF: sasl_client_new+2E3o
		align 4
aClient_mech_li	db 'client_mech_list',0 ; DATA XREF: sasl_client_new+1D2o
		align 4
aOutOfMemoryInC	db 'Out of Memory in client.c near line %d',0
					; DATA XREF: sasl_client_new:loc_1000370Bo
					; sub_10003D90+16Ao
		align 10h
aOutOfMemoryAll	db 'Out of memory allocating connection context',0
					; DATA XREF: sasl_client_new+8Do
aPlus		db '-PLUS',0            ; DATA XREF: .text:10003A5Bo
					; sub_10003A80+AFo ...
		align 4
aMechDidNotCall	db 'mech did not call canon_user for both authzid and authid',0
					; DATA XREF: sasl_client_step:loc_10003D29o
					; sasl_server_step:loc_1000AB79o
byte_1002762D	db 3 dup(0)		; DATA XREF: sasl_client_step+CAo
					; sub_10007E30+CFo ...
aAttemptingClie	db 'attempting client step after doneflag',0
					; DATA XREF: sasl_client_step+5Eo
		align 4
aParameterErr_0	db 'Parameter error in client.c near line %d',0
					; DATA XREF: sasl_client_step+32o
					; sub_10003D90:loc_10003DD1o ...
		align 4
aInternalErro_0	db 'Internal Error %d in client.c near line %d',0
					; DATA XREF: sub_10003D90+2F8o
		align 10h
asc_100276B0	db ' ',0                ; DATA XREF: sub_10003D90:loc_10003E17o
					; sub_1000AC20:loc_1000ACA7o
		align 4
aCsupports_http	db '%cSUPPORTS_HTTP',0  ; DATA XREF: .text:10004324o
					; .text:1000B809o
aCchannel_bindi	db '%cCHANNEL_BINDING',0 ; DATA XREF: .text:10004305o
					; .text:1000B7EAo
		align 4
aCgss_framing	db '%cGSS_FRAMING',0    ; DATA XREF: .text:100042E6o
					; .text:1000B7CBo
		align 4
aCneed_server_f	db '%cNEED_SERVER_FQDN',0 ; DATA XREF: .text:100042C7o
					; .text:1000B76Eo
		align 4
aCproxy_authent	db '%cPROXY_AUTHENTICATION',0 ; DATA XREF: .text:100042ABo
					; .text:1000B736o
		align 4
aCserver_first	db '%cSERVER_FIRST',0   ; DATA XREF: .text:1000428Fo
					; .text:1000B71Ao
		align 4
aCwant_client_f	db '%cWANT_CLIENT_FIRST',0 ; DATA XREF: .text:10004273o
					; .text:1000B6FEo
aFeatures	db 0Ah			; DATA XREF: .text:loc_10004259o
					; .text:loc_1000B6E4o
		db 9,'features:',0
aCmutual_auth	db '%cMUTUAL_AUTH',0    ; DATA XREF: .text:1000424Co
					; .text:1000B6D7o
		align 4
aCpass_credenti	db '%cPASS_CREDENTIALS',0 ; DATA XREF: .text:10004230o
					; .text:1000B6BBo
		align 4
aCforward_secre	db '%cFORWARD_SECRECY',0 ; DATA XREF: .text:10004214o
					; .text:1000B69Fo
		align 4
aCno_dictionary	db '%cNO_DICTIONARY',0  ; DATA XREF: .text:100041F8o
					; .text:1000B683o
aCno_active	db '%cNO_ACTIVE',0      ; DATA XREF: .text:100041DCo
					; .text:1000B667o
aCno_plaintext	db '%cNO_PLAINTEXT',0   ; DATA XREF: .text:100041C0o
					; .text:1000B64Bo
		align 4
aCno_anonymous	db '%cNO_ANONYMOUS',0   ; DATA XREF: .text:100041A4o
					; .text:1000B62Fo
		align 4
aSecurityFlags	db 9,'security flags:',0 ; DATA XREF: .text:1000418Ao
					; .text:1000B615o
		align 4
aSaslMechanismS	db 9,'SASL mechanism: %s, best SSF: %d',0Ah,0 ; DATA XREF: .text:10004180o
		align 10h
aLoaded		db '[loaded]',0         ; DATA XREF: .text:10004152o
					; .text:loc_1000B5C4o
		align 4
aListOfClientPl	db 'List of client plugins follows',0Ah,0 ; DATA XREF: .text:10004128o
aCyrusSasl	db 'Cyrus SASL',0       ; DATA XREF: .data:off_1002D040o
		align 4
aBuildLibsaslCy	db '$Build: libsasl cyrus-sasl-2.1.25 $',0
dword_1002784C	dd 4			; DATA XREF: sub_10005610:loc_1000562Fo
		dd offset sub_10005260
		align 8
a2_1_25		db '2.1.25',0           ; DATA XREF: sasl_version_info+18o
		align 10h
aOutOfMemoryI_0	db 'Out of Memory in common.c near line %d',0
					; DATA XREF: sub_100049F0:loc_10004A36o
					; sub_100049F0+114o ...
		align 4
aParameterErr_1	db 'Parameter error in common.c near line %d',0
					; DATA XREF: sasl_decode+13Co
					; sub_10005310+1B0o ...
		align 4
aInputTooLargeF	db 'input too large for default sasl_decode',0 ; DATA XREF: sasl_decode+73o
		align 10h
aCalledSasl_dec	db 'called sasl_decode with application that does not support securit'
					; DATA XREF: sasl_decode+3Eo
		db 'y layers',0
		align 4
aUndefinedError	db 'undefined error!',0 ; DATA XREF: sasl_errstring:loc_10004F4Bo
		align 10h
aChannelBinding	db 'channel binding failure',0 ; DATA XREF: sasl_errstring:loc_10004F45o
aSasl_setpassCa	db 'sasl_setpass can',27h,'t store a property because of a constraint vi'
					; DATA XREF: sasl_errstring:loc_10004F3Fo
		db 'olation',0
		align 10h
aSasl_setpassNe	db 'sasl_setpass needs old password in order to perform password chan'
					; DATA XREF: sasl_errstring:loc_10004F39o
		db 'ge',0
aUserSuppliedPa	db 'user supplied passwords are not permitted',0
					; DATA XREF: sasl_errstring:loc_10004F33o
		align 10h
aPassphraseIsTo	db 'passphrase is too weak for security policy',0
					; DATA XREF: sasl_errstring:loc_10004F2Do
		align 4
aRequestedChang	db 'requested change was not needed',0
					; DATA XREF: sasl_errstring:loc_10004F27o
aPassphraseLock	db 'passphrase locked',0 ; DATA XREF: sasl_errstring:loc_10004F21o
		align 10h
aUserExistsButN	db 'user exists, but no verifier for user',0
					; DATA XREF: sasl_errstring:loc_10004F1Bo
		align 4
aRemoteAuthenti	db 'remote authentication server unavailable',0
					; DATA XREF: sasl_errstring:loc_10004F15o
		align 4
aVersionMismatc	db 'version mismatch with plug-in',0
					; DATA XREF: sasl_errstring:loc_10004F0Fo
		align 4
aUserNotFound	db 'user not found',0   ; DATA XREF: sasl_errstring:loc_10004F09o
		align 4
aAccountDisable	db 'account disabled',0 ; DATA XREF: sasl_errstring:loc_10004F03o
		align 4
aPassphraseExpi	db 'passphrase expired, has to be reset',0
					; DATA XREF: sasl_errstring:loc_10004EFDo
		align 10h
aOneTimeUseOfAP	db 'One time use of a plaintext password will enable requested mechan'
					; DATA XREF: sasl_errstring:loc_10004EF7o
		db 'ism for user',0
		align 10h
aEncryptionNeed	db 'encryption needed to use mechanism',0
					; DATA XREF: sasl_errstring:loc_10004EF1o
		align 4
aMechanismTooWe	db 'mechanism too weak for this user',0
					; DATA XREF: sasl_errstring:loc_10004EEBo
		align 4
aAuthorizationF	db 'authorization failure',0 ; DATA XREF: sasl_errstring:loc_10004EE5o
		align 10h
aAuthentication	db 'authentication failure',0 ; DATA XREF: sasl_errstring:loc_10004EDFo
		align 4
aMechanismDoesn	db 'mechanism doesn',27h,'t support requested feature',0
					; DATA XREF: sasl_errstring:loc_10004ED9o
aServerFailedMu	db 'server failed mutual authentication step',0
					; DATA XREF: sasl_errstring:loc_10004ED3o
		align 10h
aNeedsUserInter	db 'needs user interaction',0 ; DATA XREF: sasl_errstring:loc_10004ECDo
		align 4
aSaslLibraryIsN	db 'SASL library is not initialized',0
					; DATA XREF: sasl_errstring:loc_10004EC7o
aIntegrityCheck	db 'integrity check failed',0 ; DATA XREF: sasl_errstring:loc_10004EC1o
		align 10h
aTransientFailu	db 'transient failure (e.g., weak key)',0
					; DATA XREF: sasl_errstring:loc_10004EBBo
		align 4
aInvalidParamet	db 'invalid parameter supplied',0 ; DATA XREF: sasl_errstring:loc_10004EB5o
		align 10h
aCanTRequestInf	db 'can',27h,'t request information until later in exchange',0
					; DATA XREF: sasl_errstring:loc_10004EAFo
		align 4
aBadProtocolCan	db 'bad protocol / cancel',0 ; DATA XREF: sasl_errstring:loc_10004EA9o
		align 4
aNoMechanismAva	db 'no mechanism available',0 ; DATA XREF: sasl_errstring:loc_10004EA3o
		align 4
aOverflowedBuff	db 'overflowed buffer',0 ; DATA XREF: sasl_errstring:loc_10004E9Do
		align 4
aNoMemoryAvaila	db 'no memory available',0 ; DATA XREF: sasl_errstring:loc_10004E97o
aGenericFailure	db 'generic failure',0  ; DATA XREF: sasl_errstring:loc_10004E91o
aSuccessfulResu	db 'successful result',0 ; DATA XREF: sasl_errstring:loc_10004E8Bo
		align 10h
aAnotherStepIsN	db 'another step is needed in authentication',0
					; DATA XREF: sasl_errstring:loc_10004E85o
		align 4
aEnUs		db 'en-us',0            ; DATA XREF: sasl_errstring+8o
		align 4
aUsername	db 'USERNAME',0         ; DATA XREF: .text:loc_100051A3o
		align 10h
aUser		db 'USER',0             ; DATA XREF: .text:10005176o
		align 4
aRequestedIdent	db 'Requested identity not authenticated identity',0
					; DATA XREF: .text:loc_100052E0o
		align 4
aInternalErrorD	db 'Internal Error %d in common.c near line %d',0
					; DATA XREF: sub_10005310+182o
					; sasl_encodev+A4o ...
		align 4
aUnableToFindAC	db 'Unable to find a callback: %d',0 ; DATA XREF: sub_10005310+F6o
		align 4
aNoOlist	db 'no olist',0         ; DATA XREF: sub_10005930+A1o
		align 10h
; CHAR SubKey[]
SubKey		db 'SOFTWARE\Carnegie Mellon\Project Cyrus\SASL Library',0
					; DATA XREF: sub_10005C20+16o
aNull		db '(null)',0           ; DATA XREF: sub_10005DE0+Co
					; .data:off_1002DB80o
		align 10h
aCalledSasl_enc	db 'called sasl_encode[v] with application that does not support secu'
					; DATA XREF: sasl_encodev+63o
		db 'rity layers',0
		align 10h
aInformationTha	db 'Information that was requested is not yet available.',0
					; DATA XREF: sasl_getprop:loc_100065D2o
		align 4
aUnknownParamet	db 'Unknown parameter type',0 ; DATA XREF: sasl_setprop:loc_10006CFCo
		align 10h
aTriedToSetAppl	db 'Tried to set application name on non-server connection',0
					; DATA XREF: sasl_setprop+497o
		align 4
aBadIplocalport	db 'Bad IPLOCALPORT value',0 ; DATA XREF: sasl_setprop+3ABo
		align 10h
aBadIpremotepor	db 'Bad IPREMOTEPORT value',0 ; DATA XREF: sasl_setprop+2AFo
		align 4
aAttemptToDisab	db 'Attempt to disable security layers (maxoutbuf == 0) with min_ssf '
					; DATA XREF: sasl_setprop+1D8o
		db '> 0',0
		align 10h
aTriedToSetReal	db 'Tried to set realm on non-server connection',0
					; DATA XREF: sasl_setprop+F6o
aSS		db '%s%s',0             ; DATA XREF: sasl_errdetail+C5o
		align 4
aSaslDS		db 'SASL(%d): %s: ',0   ; DATA XREF: sasl_errdetail+5Do
		align 4
; CHAR ValueName[]
ValueName	db 'SearchPath',0       ; DATA XREF: sub_10006EB0+1Eo
		align 10h
aCCmuBinSasl2	db 'C:\CMU\bin\sasl2',0 ; DATA XREF: sub_10006EB0+19o
					; sub_10006EF0+19o
		align 4
; CHAR aConffile[]
aConffile	db 'ConfFile',0         ; DATA XREF: sub_10006EF0+1Eo
		align 10h
aR		db 'r',0                ; DATA XREF: sasl_config_init+21o
					; .text:1000A30Co
		align 4
aIdExternal_cV1	db '$Id: external.c,v 1.24 2009/03/10 16:27:52 mel Exp $',0
		db 3 dup(0)
		db    0			; DATA XREF: .data:1002D0C4o
		db    0
		db    0
		db    0
aAnonymousLogin	db 'anonymous login not allowed',0 ; DATA XREF: sub_10007BF0+A9o
aAnonymous	db 'anonymous',0        ; DATA XREF: sub_10007BF0+75o
		align 4
aExternalVersio	db 'EXTERNAL version mismatch',0 ; DATA XREF: .text:10007D9Co
					; .text:10008081o
		align 4
aPleaseEnterYou	db 'Please enter your authorization name',0 ; DATA XREF: sub_10007E30+D4o
		align 4
asc_1002810C	db '--',0               ; DATA XREF: getopt+90o
		align 10h
asc_10028110	db '-',0                ; DATA XREF: getopt:loc_10009580o
		align 4
aS		db '%s',0               ; DATA XREF: getpass+6o
					; .text:1000DD61o
		align 4
aLu_Lu		db '<%lu.%lu>',0        ; DATA XREF: sasl_mkchal+B8o
		align 4
aLu_Lu@S	db '<%lu.%lu@%s>',0     ; DATA XREF: sasl_mkchal+92o
		align 4
aMutual_auth	db 'mutual_auth',0      ; DATA XREF: .data:1002D2B0o
aPass_credentia	db 'pass_credentials',0 ; DATA XREF: .data:1002D2A8o
		align 4
aNoanonymous	db 'noanonymous',0      ; DATA XREF: .data:1002D2A0o
aForward_secrec	db 'forward_secrecy',0  ; DATA XREF: .data:1002D298o
aNodictionary	db 'nodictionary',0     ; DATA XREF: .data:1002D290o
		align 10h
aNoactive	db 'noactive',0         ; DATA XREF: .data:1002D288o
		align 4
aNoplaintext	db 'noplaintext',0      ; DATA XREF: .data:off_1002D280o
aSecretNotChang	db 'secret not changed for %s: no writable auxprop plugin or setpass '
					; DATA XREF: sasl_setpass+3D3o
		db 'callback found',0
aSFailedToSet_0	db '%s: failed to set secret for %s: %z (%m)',0
					; DATA XREF: sasl_setpass+3ABo
		align 4
aSFailedToSetSe	db '%s: failed to set secret for %s: constrain violation',0
					; DATA XREF: sasl_setpass+37Bo
		align 4
aSSecretNotChan	db '%s: secret not changed for %s',0 ; DATA XREF: sasl_setpass+35Do
		align 4
aSSetSecretForS	db '%s: set secret for %s',0 ; DATA XREF: sasl_setpass+33Co
		align 4
aSetpassCallb_0	db 'setpass callback succeeded for %s',0 ; DATA XREF: sasl_setpass+298o
		align 4
aSetpassCallbac	db 'setpass callback failed for %s: %z',0 ; DATA XREF: sasl_setpass+282o
		align 4
aSetpassSucceed	db 'setpass succeeded for %s',0 ; DATA XREF: sasl_setpass+205o
		align 4
aSetpassFailedF	db 'setpass failed for %s: %z',0 ; DATA XREF: sasl_setpass+1EAo
		align 4
aNoCurrentSaslM	db 'No current SASL mechanism available',0 ; DATA XREF: sasl_setpass+FAo
aParameterErr_2	db 'Parameter error in server.c near line %d',0
					; DATA XREF: sasl_setpass+6Bo
					; sasl_setpass+ABo ...
		align 4
asc_10028354	db '*',0                ; DATA XREF: sasl_setpass+1Bo
					; sasl_setpass+1B2o
		align 4
aUserpassword	db 'userPassword',0     ; DATA XREF: sasl_setpass+6o
					; sasl_setpass+18Do
		align 4
aVersionMisma_0	db 'version mismatch on plugin: %d expected, but %d reported',0
					; DATA XREF: sasl_server_add_plugin+73o
		align 4
aServerAdd_plug	db 'server add_plugin entry_point error %z',0Ah,0
					; DATA XREF: sasl_server_add_plugin+4Fo
a_SCS_conf	db '%.*s%c%s.conf',0    ; DATA XREF: sub_1000A0F0+C9o
		align 4
aSCouldnTIdenti	db '%s: couldn',27h,'t identify flag ',27h,'%s',27h,0
					; DATA XREF: .text:1000A42Co
aTransitioningU	db 'transitioning user %s to auxprop database',0
					; DATA XREF: sub_1000A4C0+F1o
		align 4
aNoplain	db 'noplain',0          ; DATA XREF: sub_1000A4C0:loc_1000A55Co
					; sasl_server_new:loc_1000BF11o
aAuto_transitio	db 'auto_transition',0  ; DATA XREF: sub_1000A4C0+73o
					; sasl_server_new+2EDo
aN		db 'n',0                ; DATA XREF: sub_1000A4C0+Eo
					; sub_1000A4C0+8Do
		align 4
aMechSRequiresU	db 'mech %s requires unprovided secret facility',0
					; DATA XREF: sub_1000A600+27Do
aSecurityFlagsD	db 'security flags do not match required',0 ; DATA XREF: sub_1000A600+24Ao
		align 4
aNoUsersInSecre	db 'no users in secrets db',0 ; DATA XREF: sub_1000A600+1F1o
		align 10h
aTooWeak	db 'too weak',0         ; DATA XREF: sub_1000A600+1D1o
		align 4
aOutOfMemoryI_1	db 'Out of Memory in server.c near line %d',0
					; DATA XREF: sub_1000A600:loc_1000A73Do
					; sub_1000AC20+151o ...
		align 4
aMechSIsTooWeak	db 'mech %s is too weak',0 ; DATA XREF: sub_1000A600+EAo
aInternalErro_1	db 'Internal Error %d in server.c near line %d',0
					; DATA XREF: sub_1000A8D0+29o
					; sub_1000AC20+387o
		align 4
aServerRequires	db 'server requires channel binding but client provided none',0
					; DATA XREF: sasl_server_step+1CBo
		align 10h
aClientIncorrec	db 'client incorrectly assumed server had no channel binding',0
					; DATA XREF: sasl_server_step+1A1o
		align 4
aClientChannelB	db 'client channel binding %s does not match server %s',0
					; DATA XREF: sasl_server_step+17Eo
		align 10h
aClientProvided	db 'client provided channel binding but server had none',0
					; DATA XREF: sasl_server_step+12Do
aAttemptingServ	db 'attempting server step after doneflag',0
					; DATA XREF: sasl_server_step+6Co
		align 4
aCheckpassFaile	db 'checkpass failed',0 ; DATA XREF: sub_1000B080:loc_1000B294o
		align 10h
aUnknownPasswor	db 'unknown password verifier(s) %s',0 ; DATA XREF: sub_1000B080+1FEo
aPwcheck_method	db 'pwcheck_method',0   ; DATA XREF: sub_1000B080+A2o
					; sasl_user_exists+72o
		align 10h
aNoPlaintextPas	db 'no plaintext password verifier?',0
					; DATA XREF: sasl_user_exists:loc_1000B4E9o
					; sasl_user_exists+196o
aSasl_checkap_0	db 'sasl_checkapop called, but was disabled at compile time',0
					; DATA XREF: sasl_checkapop+5o
aWillBeLoadedFr	db 0Ah			; DATA XREF: .text:1000B81Eo
		db 9,'will be loaded from "%s"',0
		align 4
aCneed_getsecre	db '%cNEED_GETSECRET',0 ; DATA XREF: .text:1000B7ACo
		align 4
aCservice	db '%cSERVICE',0        ; DATA XREF: .text:1000B78Do
		align 4
aCdontuse_userp	db '%cDONTUSE_USERPASSWD',0 ; DATA XREF: .text:1000B752o
		align 4
aSaslMechanis_0	db 9,'SASL mechanism: %s, best SSF: %d, supports setpass: %s',0Ah,0
					; DATA XREF: .text:1000B60Bo
		align 4
aNoUsers	db '[no users]',0       ; DATA XREF: .text:loc_1000B5CBo
		align 4
aDelayed	db '[delayed]',0        ; DATA XREF: .text:loc_1000B5BDo
		align 10h
aUnknown	db '[unknown]',0        ; DATA XREF: .text:1000B5B6o
		align 4
aListOfServerPl	db 'List of server plugins follows',0Ah,0 ; DATA XREF: .text:1000B578o
aSasl_auxprop_p	db 'sasl_auxprop_plug_init',0 ; DATA XREF: sasl_server_init+2Eo
		align 4
; CHAR aSasl_server__1[]
aSasl_server__1	db 'sasl_server_plug_init',0 ; DATA XREF: sasl_server_init+1Eo
					; sasl_server_start+115o
		align 4
aMech_list	db 'mech_list',0        ; DATA XREF: sasl_server_new+304o
		align 4
aLog_level	db 'log_level',0        ; DATA XREF: sasl_server_new+2D3o
		align 4
aRemoteSentFirs	db 'Remote sent first but mech does not allow it.',0
					; DATA XREF: sasl_server_start+2C9o
		align 4
aGotPastMech_pe	db 'Got past mech_permitted with a disallowed mech!',0
					; DATA XREF: sasl_server_start+255o
aSSecurityParam	db '%s: security parameters don',27h,'t match mechlist file',0
					; DATA XREF: sasl_server_start+1B6o
		align 4
aCouldnTFindMec	db 'Couldn',27h,'t find mech %s',0 ; DATA XREF: sasl_server_start+A6o
		align 10h
aNoSasl_conn_tP	db 'No sasl_conn_t passed to sasl_seterror',0 ; DATA XREF: sasl_seterror+60o
		align 4
		dd 0
aNoEntrypointOu	db 'no entrypoint output pointer in _sasl_locate_entry',0
					; DATA XREF: sub_1000C830+45o
		align 10h
aNoLibraryIn_sa	db 'no library in _sasl_locate_entry',0 ; DATA XREF: sub_1000C830+26o
		align 4
aNoEntrynameIn_	db 'no entryname in _sasl_locate_entry',0 ; DATA XREF: sub_1000C830+8o
		align 4
a_sasl_plugin_l	db '_sasl_plugin_load failed on %s for plugin: %s',0Ah,0
					; DATA XREF: sub_1000C8A0+28o
		align 4
aUnableToLoadli	db 'unable to LoadLibrary %s: %s',0 ; DATA XREF: sub_1000C8E0+47o
		align 4
a_dll		db '.dll',0             ; DATA XREF: sub_1000C9A0+245o
		align 10h
dword_10028990	dd 6C642E2Ah		; DATA XREF: sub_1000C9A0+1DAr
word_10028994	dw 6Ch			; DATA XREF: sub_1000C9A0+1E0r
		align 4
aPluginSearchMa	db 'plugin search mask is too big',0 ; DATA XREF: sub_1000C9A0+1B2o
		align 4
word_100289B8	dw 5Ch			; DATA XREF: sub_1000C9A0+199r
		align 4
aParameterErr_3	db 'Parameter Error in plugin_common.c near line %d',0
					; DATA XREF: .text:1000CFF2o
					; .text:1000D031o ...
aOutOfMemoryInP	db 'Out of Memory in plugin_common.c near line %d',0
					; DATA XREF: sub_1000D0F0:loc_1000D16Bo
					; sub_1000D1C0+4Do ...
		align 4
aUnexpectedlyMi	db 'Unexpectedly missing a prompt result',0 ; DATA XREF: sub_1000D330+7Eo
					; .text:1000D4F2o ...
		align 4
aPassword	db 'Password',0         ; DATA XREF: sub_1000D720+FEo
		align 10h
aAuthenticati_0	db 'Authentication Name',0 ; DATA XREF: sub_1000D720+DFo
aAuthorizationN	db 'Authorization Name',0 ; DATA XREF: sub_1000D720+BAo
		align 4
aMake_promptsCa	db 'make_prompts() called with no actual prompts',0
					; DATA XREF: sub_1000D720+45o
		align 4
aEncodedPacketS	db 'encoded packet size too big (%d > %d)',0 ; DATA XREF: .text:1000DA1Fo
		align 10h
word_10028AD0	dw 40h			; DATA XREF: .text:1000DC48r
		align 4
aSSBuildU	db '%s %s (Build %u)',0 ; DATA XREF: .text:1000DE56o
		align 4
aWin32sOnWindow	db 'Win32s on Windows 3.1',0 ; DATA XREF: .text:loc_1000DE3Fo
		align 10h
aWindows95	db 'Windows 95',0       ; DATA XREF: .text:1000DE38o
		align 4
aWindows98	db 'Windows 98',0       ; DATA XREF: .text:1000DE29o
		align 4
aWindowsMe	db 'Windows Me',0       ; DATA XREF: .text:1000DE1Ao
		align 4
aUnknownWindo_1	db 'Unknown Windows 9X/ME series',0 ; DATA XREF: .text:1000DE0Bo
		align 4
aUnknownWindo_0	db 'Unknown Windows NT series',0 ; DATA XREF: .text:loc_1000DDEAo
		align 10h
aWindowsXp_net	db 'Windows XP/.NET',0  ; DATA XREF: .text:loc_1000DDE3o
aWindows2000	db 'Windows 2000',0     ; DATA XREF: .text:loc_1000DDDCo
		align 10h
aWindowsNt4_0	db 'Windows NT 4.0',0   ; DATA XREF: .text:loc_1000DDD5o
		align 10h
aWindowsNt3_51	db 'Windows NT 3.51',0  ; DATA XREF: .text:loc_1000DDCEo
aUnknownWindows	db 'Unknown Windows',0  ; DATA XREF: .text:1000DD4Ao
aVisualCCrtNotE	db 'Visual C++ CRT: Not enough memory to complete call to strerror.',0
					; DATA XREF: sub_1000FB67+14o
					; sub_1000FB67+37o
		dd 0
		dd 1, 2, 3, 4
; CHAR ProcName[]
ProcName	db 'SystemFunction036',0 ; DATA XREF: sub_10010272:loc_100102ECo
		align 4
; CHAR LibFileName[]
LibFileName	db 'ADVAPI32.DLL',0     ; DATA XREF: sub_10010272+4Ao
		align 4
word_10028C28	dw 1Ch			; DATA XREF: sub_100103D9:loc_100103F8r
word_10028C2A	dw 0Dh			; DATA XREF: sub_100103D9:loc_10010436o
byte_10028C2C	db 0Dh,	0		; DATA XREF: sub_100103D9+55o
word_10028C2E	dw 0Ah			; DATA XREF: sub_100103D9+48o
dword_10028C30	dd 35A600h, 3F002Fh, 0A4009500h, 47E00047h, 77E047E0h
					; DATA XREF: sub_100103D9+3Bo
		dd 489700h, 48E048E0h, 98008DE0h, 49E00049h, 86E049E0h
		dd 4B9900h, 4BE04BE0h, 9B0073E0h, 4DE0004Dh, 74E04DE0h
		dd 4F9D00h, 4FE04FE0h, 9F0075E0h, 50E00050h, 91E050E0h
		dd 51A000h, 51E051E0h, 0A10076E0h, 52E00052h, 92E052E0h
		dd 53A200h, 53E053E0h, 0A30093E0h
byte_10028CA0	db 2 dup(0)		; DATA XREF: sub_100103D9:loc_1001046Eo
word_10028CA2	dw 0			; DATA XREF: sub_100103D9+8Co
byte_10028CA4	db 2 dup(0)		; DATA XREF: sub_100103D9+7Eo
word_10028CA6	dw 0			; DATA XREF: sub_100103D9+70o
		dw 3 dup(1Bh)
		dw 100h
a1:
		unicode	0, <1!>,0
		dw 7800h
		dd 400032h, 79000300h, 230033h,	7A000000h, 240034h, 7B000000h
		dd 250035h, 7C000000h, 5E0036h,	7D00001Eh, 260037h, 7E000000h
		dd 2A0038h, 7F000000h, 280039h,	80000000h, 290030h, 81000000h
		dd 5F002Dh, 8200001Fh, 2B003Dh,	83000000h, 80008h, 0E00007Fh
		dd 0F000009h, 0F009400h, 510071h, 10000011h, 570077h, 11000017h
		dd 450065h, 12000005h, 520072h,	13000012h, 540074h, 14000014h
		dd 590079h, 15000019h, 550075h,	16000015h, 490069h, 17000009h
		dd 4F006Fh, 1800000Fh, 500070h,	19000010h, 7B005Bh, 1A00001Bh
		dd 7D005Dh, 1B00001Dh, 0D000Dh,	1C00000Ah, 2 dup(0)
		dd 410061h, 1E000001h, 530073h,	1F000013h, 440064h, 20000004h
		dd 460066h, 21000006h, 470067h,	22000007h, 480068h, 23000008h
		dd 4A006Ah, 2400000Ah, 4B006Bh,	2500000Bh, 4C006Ch, 2600000Ch
		dd 3A003Bh, 27000000h, 220027h,	28000000h, 7E0060h, 29000000h
		dd 2 dup(0)
		dd 7C005Ch, 1Ch, 5A007Ah, 2C00001Ah, 580078h, 2D000018h
		dd 430063h, 2E000003h, 560076h,	2F000016h, 420062h, 30000002h
		dd 4E006Eh, 3100000Eh, 4D006Dh,	3200000Dh, 3C002Ch, 33000000h
		dd 3E002Eh, 34000000h, 3F002Fh,	35000000h, 2 dup(0)
		dd 2Ah,	72h, 2 dup(0)
		unicode	0, <	>,0
		align 4
		dd 0
		dd 54003B00h, 68005E00h, 55003C00h, 69005F00h, 56003D00h
		dd 6A006000h, 57003E00h, 6B006100h, 58003F00h, 6C006200h
		dd 59004000h, 6D006300h, 5A004100h, 6E006400h, 5B004200h
		dd 6F006500h, 5C004300h, 70006600h, 5D004400h, 71006700h
		dd 4 dup(0)
		dd 374700h, 7700h, 384800h, 8D00h, 394900h, 8400h, 2D0000h
		dd 0
		dd 344B00h, 7300h, 350000h, 0
		dd 364D00h, 7400h, 2B0000h, 0
		dd 314F00h, 7500h, 325000h, 9100h, 335100h, 7600h, 305200h
		dd 9200h, 2E5300h, 9300h, 6 dup(0)
aRerzrirlrjrirk	db '',0
		align 4
aLc_time	db 'LC_TIME',0          ; DATA XREF: .rdata:off_10028FECo
aLc_numeric	db 'LC_NUMERIC',0       ; DATA XREF: .rdata:10028FE0o
		align 10h
aLc_monetary	db 'LC_MONETARY',0      ; DATA XREF: .rdata:10028FD4o
aLc_ctype	db 'LC_CTYPE',0         ; DATA XREF: .rdata:10028FC8o
		align 4
aLc_collate	db 'LC_COLLATE',0       ; DATA XREF: .rdata:off_10028FBCo
		align 4
aLc_all		db 'LC_ALL',0           ; DATA XREF: .rdata:10028FB0o
		align 10h
		dd offset aLc_all	; "LC_ALL"
		align 8
off_10028FB8	dd offset sub_100127AB	; DATA XREF: sub_10012D67+253r
off_10028FBC	dd offset aLc_collate	; DATA XREF: sub_10012984+3Er
					; sub_10012984+54o ...
					; "LC_COLLATE"
		dd offset dword_1002DA88
		dd offset sub_1001B58C
		dd offset aLc_ctype	; "LC_CTYPE"
		dd offset dword_1002DA88
		dd offset sub_1001B12E
		dd offset aLc_monetary	; "LC_MONETARY"
		dd offset dword_1002DA88
		dd offset sub_1001ADCB
		dd offset aLc_numeric	; "LC_NUMERIC"
		dd offset dword_1002DA88
		dd offset sub_1001AAA7
off_10028FEC	dd offset aLc_time	; DATA XREF: sub_10012984+EFo
					; sub_10013065+F2o
					; "LC_TIME"
		dd offset dword_1002DA88
		dd offset sub_1001A990
; CHAR MultiByteStr[]
MultiByteStr	dd 4030201h, 8070605h, 0C0B0A09h, 100F0E0Dh, 14131211h
					; DATA XREF: sub_10012D67+1DCo
		dd 18171615h, 1C1B1A19h, 201F1E1Dh, 24232221h, 28272625h
		dd 2C2B2A29h, 302F2E2Dh, 34333231h, 38373635h, 3C3B3A39h
		dd 403F3E3Dh, 44434241h, 48474645h, 4C4B4A49h, 504F4E4Dh
		dd 54535251h, 58575655h, 5C5B5A59h, 605F5E5Dh, 64636261h
		dd 68676665h, 6C6B6A69h, 706F6E6Dh, 74737271h, 78777675h
		dd 7C7B7A79h, 7F7E7Dh
dword_10029078	dd 2C2E5Fh		; DATA XREF: sub_100127EE:loc_10012852o
					; sub_100127EE+10Co
dword_1002907C	dd 2Eh			; DATA XREF: sub_10012917+56o
dword_10029080	dd 5Fh			; DATA XREF: sub_10012917+34o
dword_10029084	dd 3Bh			; DATA XREF: sub_10012984+5Eo
					; sub_10013065+FBo
dword_10029088	dd 3Dh			; DATA XREF: sub_10012984+39o
					; sub_10012984+CFo
dword_1002908C	dd 43h			; DATA XREF: sub_10012B19+79o
dword_10029090	dd 3B3Dh		; DATA XREF: sub_10013065:loc_100130E3o
; CHAR aEncodepointer[]
aEncodepointer	db 'EncodePointer',0    ; DATA XREF: sub_10013548:loc_1001359Do
					; sub_100136E4+40o
		align 4
; const	WCHAR aKernel32_dll_0
aKernel32_dll_0:			; DATA XREF: sub_10013548+4Ao
					; sub_100135C4+4Ao ...
		unicode	0, <KERNEL32.DLL>,0
		align 10h
; const	WCHAR ModuleName
ModuleName:				; DATA XREF: sub_10013548+3Fo
					; sub_100135C4+3Fo ...
		unicode	0, <KERNELBASE.DLL>,0
		align 10h
; CHAR aDecodepointer[]
aDecodepointer	db 'DecodePointer',0    ; DATA XREF: sub_100135C4:loc_10013619o
					; sub_100136E4+56o
		align 10h
; CHAR aFlsfree[]
aFlsfree	db 'FlsFree',0          ; DATA XREF: sub_10013A07+40o
; CHAR aFlssetvalue[]
aFlssetvalue	db 'FlsSetValue',0      ; DATA XREF: sub_10013A07+33o
; CHAR aFlsgetvalue[]
aFlsgetvalue	db 'FlsGetValue',0      ; DATA XREF: sub_10013A07+26o
; CHAR aFlsalloc[]
aFlsalloc	db 'FlsAlloc',0         ; DATA XREF: sub_10013A07+1Eo
					; sub_10013E79+19Fr
		align 4
aNull_0:				; DATA XREF: .data:off_1002DB84o
		unicode	0, <(null)>,0
		align 10h
byte_10029130	db 6			; DATA XREF: sub_10013E79:loc_10014026r
		db 2 dup(0), 6
		dd 100h, 6030010h, 10020600h, 45454504h, 5050505h, 303505h
		dd 50h,	38202800h, 8075850h, 30303700h,	75057h,	8202000h
		dd 0
		db 8,'`h````',0
dword_10029170	dd 78707800h, 8787878h,	807h, 8080007h,	8000008h, 7000800h
		dd 8, 2Fh, 2F005Ch, 0
dword_10029198	dd 5Ch,	40002h		; DATA XREF: .rdata:100291A0o
		dd offset dword_10029198
		dd 60004h
		dd offset dword_10029170+20h
		dd 40002h
		dd offset dword_10029170+1Ch
; CHAR OutputString[]
OutputString	db 'Invalid parameter passed to C runtime function.',0Ah,0
					; DATA XREF: sub_10014AB5+89o
		align 4
; struct _EXCEPTION_POINTERS ExceptionInfo
ExceptionInfo	_EXCEPTION_POINTERS <offset dword_1002E7B8, offset dword_1002E808>
					; DATA XREF: sub_10016319+C3o
; CHAR aCorexitprocess[]
aCorexitprocess	db 'CorExitProcess',0   ; DATA XREF: sub_100164CB+14o
		align 10h
; CHAR aMscoree_dll[]
aMscoree_dll	db 'mscoree.dll',0      ; DATA XREF: sub_100164CB+5o
aRuntimeError	db 'runtime error ',0   ; DATA XREF: .data:1002DEDCo
		align 4
asc_1002921C	db 0Dh,0Ah,0		; DATA XREF: .data:1002DED4o
		align 10h
aTlossError	db 'TLOSS error',0Dh,0Ah,0 ; DATA XREF: .data:1002DECCo
		align 10h
aSingError	db 'SING error',0Dh,0Ah,0 ; DATA XREF: .data:1002DEC4o
		align 10h
aDomainError	db 'DOMAIN error',0Dh,0Ah,0 ; DATA XREF: .data:1002DEBCo
		align 10h
aR6034AnApplica	db 'R6034',0Dh,0Ah      ; DATA XREF: .data:1002DEB4o
		db 'An application has made an attempt to load the C runtime library '
		db 'incorrectly.',0Ah
		db 'Please contact the application',27h,'s support team for more informa'
		db 'tion.',0Dh,0Ah,0
		align 10h
aR6033AttemptTo	db 'R6033',0Dh,0Ah      ; DATA XREF: .data:1002DEACo
		db '- Attempt to use MSIL code from this assembly during native code '
		db 'initialization',0Ah
		db 'This indicates a bug in your application. It is most likely the r'
		db 'esult of calling an MSIL-compiled (/clr) function from a native c'
		db 'onstructor or from DllMain.',0Dh,0Ah,0
		align 4
aR6032NotEnough	db 'R6032',0Dh,0Ah      ; DATA XREF: .data:1002DEA4o
		db '- not enough space for locale information',0Dh,0Ah,0
		align 10h
aR6031AttemptTo	db 'R6031',0Dh,0Ah      ; DATA XREF: .data:1002DE9Co
		db '- Attempt to initialize the CRT more than once.',0Ah
		db 'This indicates a bug in your application.',0Dh,0Ah,0
		align 4
aR6030CrtNotIni	db 'R6030',0Dh,0Ah      ; DATA XREF: .data:1002DE94o
		db '- CRT not initialized',0Dh,0Ah,0
		align 4
aR6028UnableToI	db 'R6028',0Dh,0Ah      ; DATA XREF: .data:1002DE8Co
		db '- unable to initialize heap',0Dh,0Ah,0
		align 4
aR6027NotEnough	db 'R6027',0Dh,0Ah      ; DATA XREF: .data:1002DE84o
		db '- not enough space for lowio initialization',0Dh,0Ah,0
		align 4
aR6026NotEnough	db 'R6026',0Dh,0Ah      ; DATA XREF: .data:1002DE7Co
		db '- not enough space for stdio initialization',0Dh,0Ah,0
		align 4
aR6025PureVirtu	db 'R6025',0Dh,0Ah      ; DATA XREF: .data:1002DE74o
		db '- pure virtual function call',0Dh,0Ah,0
		align 4
aR6024NotEnough	db 'R6024',0Dh,0Ah      ; DATA XREF: .data:1002DE6Co
		db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
		align 4
aR6019UnableToO	db 'R6019',0Dh,0Ah      ; DATA XREF: .data:1002DE64o
		db '- unable to open console device',0Dh,0Ah,0
		align 4
aR6018Unexpecte	db 'R6018',0Dh,0Ah      ; DATA XREF: .data:1002DE5Co
		db '- unexpected heap error',0Dh,0Ah,0
		align 4
aR6017Unexpecte	db 'R6017',0Dh,0Ah      ; DATA XREF: .data:1002DE54o
		db '- unexpected multithread lock error',0Dh,0Ah,0
		align 4
aR6016NotEnough	db 'R6016',0Dh,0Ah      ; DATA XREF: .data:1002DE4Co
		db '- not enough space for thread data',0Dh,0Ah,0
aThisApplicatio	db 0Dh,0Ah		; DATA XREF: .data:1002DE44o
		db 'This application has requested the Runtime to terminate it in an '
		db 'unusual way.',0Ah
		db 'Please contact the application',27h,'s support team for more informa'
		db 'tion.',0Dh,0Ah,0
		align 10h
aR6009NotEnough	db 'R6009',0Dh,0Ah      ; DATA XREF: .data:1002DE3Co
		db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough	db 'R6008',0Dh,0Ah      ; DATA XREF: .data:1002DE34o
		db '- not enough space for arguments',0Dh,0Ah,0
		align 4
aR6002FloatingP	db 'R6002',0Dh,0Ah      ; DATA XREF: .data:lpBuffero
		db '- floating point support not loaded',0Dh,0Ah,0
		align 4
aMicrosoftVisua	db 'Microsoft Visual C++ Runtime Library',0 ; DATA XREF: sub_100167DD+13Ao
		align 10h
asc_10029790	db 0Ah			; DATA XREF: sub_100167DD:loc_100168CDo
		db 0Ah,0
		align 4
aProgramNameUnk	db '<program name unknown>',0 ; DATA XREF: sub_100167DD+ACo
		align 4
aRuntimeErrorPr	db 'Runtime Error!',0Ah ; DATA XREF: sub_100167DD+65o
		db 0Ah
		db 'Program: ',0
		align 4
aIllegalByteSeq	db 'Illegal byte sequence',0 ; DATA XREF: .rdata:10029BA8o
		align 10h
aDirectoryNotEm	db 'Directory not empty',0 ; DATA XREF: .rdata:10029BA4o
aFunctionNotImp	db 'Function not implemented',0 ; DATA XREF: .rdata:10029BA0o
		align 10h
aNoLocksAvailab	db 'No locks available',0 ; DATA XREF: .rdata:10029B9Co
		align 4
aFilenameTooLon	db 'Filename too long',0 ; DATA XREF: .rdata:10029B98o
		align 4
aResourceDeadlo	db 'Resource deadlock avoided',0 ; DATA XREF: .rdata:10029B90o
		align 4
aResultTooLarge	db 'Result too large',0 ; DATA XREF: .rdata:10029B88o
		align 4
aDomainError_0	db 'Domain error',0     ; DATA XREF: .rdata:10029B84o
		align 4
aBrokenPipe	db 'Broken pipe',0      ; DATA XREF: .rdata:10029B80o
aTooManyLinks	db 'Too many links',0   ; DATA XREF: .rdata:10029B7Co
		align 4
aReadOnlyFileSy	db 'Read-only file system',0 ; DATA XREF: .rdata:10029B78o
		align 4
aInvalidSeek	db 'Invalid seek',0     ; DATA XREF: .rdata:10029B74o
		align 4
aNoSpaceLeftOnD	db 'No space left on device',0 ; DATA XREF: .rdata:10029B70o
aFileTooLarge	db 'File too large',0   ; DATA XREF: .rdata:10029B6Co
		align 4
aInappropriateI	db 'Inappropriate I/O control operation',0 ; DATA XREF: .rdata:10029B64o
aTooManyOpenFil	db 'Too many open files',0 ; DATA XREF: .rdata:10029B60o
aTooManyOpenF_0	db 'Too many open files in system',0 ; DATA XREF: .rdata:10029B5Co
		align 4
aInvalidArgumen	db 'Invalid argument',0 ; DATA XREF: .rdata:10029B58o
		align 10h
aIsADirectory	db 'Is a directory',0   ; DATA XREF: .rdata:10029B54o
		align 10h
aNotADirectory	db 'Not a directory',0  ; DATA XREF: .rdata:10029B50o
aNoSuchDevice	db 'No such device',0   ; DATA XREF: .rdata:10029B4Co
		align 10h
aImproperLink	db 'Improper link',0    ; DATA XREF: .rdata:10029B48o
		align 10h
aFileExists	db 'File exists',0      ; DATA XREF: .rdata:10029B44o
aResourceDevice	db 'Resource device',0  ; DATA XREF: .rdata:10029B40o
aUnknownError	db 'Unknown error',0    ; DATA XREF: .rdata:10029B3Co
					; .rdata:10029B68o ...
		align 4
aBadAddress	db 'Bad address',0      ; DATA XREF: .rdata:10029B38o
aPermissionDeni	db 'Permission denied',0 ; DATA XREF: .rdata:10029B34o
		align 4
aNotEnoughSpace	db 'Not enough space',0 ; DATA XREF: .rdata:10029B30o
		align 10h
aResourceTempor	db 'Resource temporarily unavailable',0 ; DATA XREF: .rdata:10029B2Co
		align 4
aNoChildProcess	db 'No child processes',0 ; DATA XREF: .rdata:10029B28o
		align 4
aBadFileDescrip	db 'Bad file descriptor',0 ; DATA XREF: .rdata:10029B24o
aExecFormatErro	db 'Exec format error',0 ; DATA XREF: .rdata:10029B20o
		align 10h
aArgListTooLong	db 'Arg list too long',0 ; DATA XREF: .rdata:10029B1Co
		align 4
aNoSuchDeviceOr	db 'No such device or address',0 ; DATA XREF: .rdata:10029B18o
		align 10h
aInputOutputErr	db 'Input/output error',0 ; DATA XREF: .rdata:10029B14o
		align 4
aInterruptedFun	db 'Interrupted function call',0 ; DATA XREF: .rdata:10029B10o
		align 10h
aNoSuchProcess	db 'No such process',0  ; DATA XREF: .rdata:10029B0Co
aNoSuchFileOrDi	db 'No such file or directory',0 ; DATA XREF: .rdata:10029B08o
		align 4
aOperationNotPe	db 'Operation not permitted',0 ; DATA XREF: .rdata:10029B04o
aNoError	db 'No error',0         ; DATA XREF: .rdata:off_10029B00o
		align 10h
off_10029B00	dd offset aNoError	; DATA XREF: sub_1000FB46:loc_1000FB5Er
					; .text:10016DEBo
					; "No error"
		dd offset aOperationNotPe ; "Operation not permitted"
		dd offset aNoSuchFileOrDi ; "No	such file or directory"
		dd offset aNoSuchProcess ; "No such process"
		dd offset aInterruptedFun ; "Interrupted function call"
		dd offset aInputOutputErr ; "Input/output error"
		dd offset aNoSuchDeviceOr ; "No	such device or address"
		dd offset aArgListTooLong ; "Arg list too long"
		dd offset aExecFormatErro ; "Exec format error"
		dd offset aBadFileDescrip ; "Bad file descriptor"
		dd offset aNoChildProcess ; "No	child processes"
		dd offset aResourceTempor ; "Resource temporarily unavailable"
		dd offset aNotEnoughSpace ; "Not enough	space"
		dd offset aPermissionDeni ; "Permission	denied"
		dd offset aBadAddress	; "Bad address"
		dd offset aUnknownError	; "Unknown error"
		dd offset aResourceDevice ; "Resource device"
		dd offset aFileExists	; "File	exists"
		dd offset aImproperLink	; "Improper link"
		dd offset aNoSuchDevice	; "No such device"
		dd offset aNotADirectory ; "Not	a directory"
		dd offset aIsADirectory	; "Is a	directory"
		dd offset aInvalidArgumen ; "Invalid argument"
		dd offset aTooManyOpenF_0 ; "Too many open files in system"
		dd offset aTooManyOpenFil ; "Too many open files"
		dd offset aInappropriateI ; "Inappropriate I/O control operation"
		dd offset aUnknownError	; "Unknown error"
		dd offset aFileTooLarge	; "File	too large"
		dd offset aNoSpaceLeftOnD ; "No	space left on device"
		dd offset aInvalidSeek	; "Invalid seek"
		dd offset aReadOnlyFileSy ; "Read-only file system"
		dd offset aTooManyLinks	; "Too many links"
		dd offset aBrokenPipe	; "Broken pipe"
		dd offset aDomainError_0 ; "Domain error"
		dd offset aResultTooLarge ; "Result too	large"
		dd offset aUnknownError	; "Unknown error"
		dd offset aResourceDeadlo ; "Resource deadlock avoided"
		dd offset aUnknownError	; "Unknown error"
		dd offset aFilenameTooLon ; "Filename too long"
		dd offset aNoLocksAvailab ; "No	locks available"
		dd offset aFunctionNotImp ; "Function not implemented"
		dd offset aDirectoryNotEm ; "Directory not empty"
		dd offset aIllegalByteSeq ; "Illegal byte sequence"
		dd offset aUnknownError	; "Unknown error"
dword_10029BB0	dd 2Bh			; DATA XREF: sub_1000FB46+9r
					; .text:10016DE5o
; const	WCHAR SrcStr
SrcStr		dw 0			; DATA XREF: sub_100170CC+1Fo
					; sub_10019BEB+29o ...
		align 4
aCcs		db 'ccs=',0             ; DATA XREF: sub_10017C64+1CFo
		align 10h
aUtf8		db 'UTF-8',0            ; DATA XREF: sub_10017C64+1E3o
		align 4
aUtf16le	db 'UTF-16LE',0         ; DATA XREF: sub_10017C64:loc_10017E64o
		align 4
aUnicode	db 'UNICODE',0          ; DATA XREF: sub_10017C64:loc_10017E81o
; CHAR FileName[]
FileName	db 'CONIN$',0           ; DATA XREF: sub_10018234+Eo
		align 4
; CHAR aConout[]
aConout		db 'CONOUT$',0          ; DATA XREF: sub_10018253+Eo
		dd 41h dup(0)
asc_10029CF0:				; DATA XREF: sub_1001B12E+35Eo
					; .data:off_1002DB58o ...
		unicode	0, <	     (((((		    H>
		dw 10h
		dd 7 dup(100010h), 5 dup(840084h), 3 dup(100010h), 810010h
		dd 2 dup(810081h), 10081h, 9 dup(10001h), 100001h, 2 dup(100010h)
		dd 820010h, 2 dup(820082h), 20082h, 9 dup(20002h), 100002h
		dd 100010h, 200010h, 40h dup(0)
		db 2 dup(0)
word_10029EF2	dw 20h			; DATA XREF: .data:off_1002DFACo
aHH:					; DATA XREF: .data:off_1002DA80o
		unicode	0, <	    h((((		   H>
		dd 7 dup(100010h), 840010h, 4 dup(840084h), 100084h, 3 dup(100010h)
		dd 3 dup(1810181h), 0Ah	dup(1010101h), 3 dup(100010h)
		dd 3 dup(1820182h), 0Ah	dup(1020102h), 2 dup(100010h)
		dd 10h dup(200020h), 480020h, 8	dup(100010h), 140010h
		dd 100014h, 2 dup(100010h), 100014h, 2 dup(100010h), 1010010h
		dd 0Bh dup(1010101h), 1010010h,	3 dup(1010101h), 0Ch dup(1020102h)
		dd 1020010h, 3 dup(1020102h), 1010102h,	0
		dd 83828180h, 87868584h, 8B8A8988h, 8F8E8D8Ch, 93929190h
		dd 97969594h, 9B9A9998h, 9F9E9D9Ch, 0A3A2A1A0h,	0A7A6A5A4h
		dd 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h, 0B7B6B5B4h, 0BBBAB9B8h
		dd 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h, 0CBCAC9C8h, 0CFCECDCCh
		dd 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h, 0DFDEDDDCh, 0E3E2E1E0h
		dd 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh, 0F3F2F1F0h, 0F7F6F5F4h
		dd 0FBFAF9F8h, 0FFFEFDFCh
dword_1002A178	dd 3020100h, 7060504h, 0B0A0908h, 0F0E0D0Ch, 13121110h
					; DATA XREF: sub_1001B12E+368o
					; .data:1002DB5Co
		dd 17161514h, 1B1A1918h, 1F1E1D1Ch, 23222120h, 27262524h
		dd 2B2A2928h, 2F2E2D2Ch, 33323130h, 37363534h, 3B3A3938h
		dd 3F3E3D3Ch, 63626140h, 67666564h, 6B6A6968h, 6F6E6D6Ch
		dd 73727170h, 77767574h, 5B7A7978h, 5F5E5D5Ch, 63626160h
		dd 67666564h, 6B6A6968h, 6F6E6D6Ch, 73727170h, 77767574h
		dd 7B7A7978h, 7F7E7D7Ch, 83828180h, 87868584h, 8B8A8988h
		dd 8F8E8D8Ch, 93929190h, 97969594h, 9B9A9998h, 9F9E9D9Ch
		dd 0A3A2A1A0h, 0A7A6A5A4h, 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h
		dd 0B7B6B5B4h, 0BBBAB9B8h, 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h
		dd 0CBCAC9C8h, 0CFCECDCCh, 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h
		dd 0DFDEDDDCh, 0E3E2E1E0h, 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh
		dd 0F3F2F1F0h, 0F7F6F5F4h, 0FBFAF9F8h, 0FFFEFDFCh, 83828180h
		dd 87868584h, 8B8A8988h, 8F8E8D8Ch, 93929190h, 97969594h
		dd 9B9A9998h, 9F9E9D9Ch, 0A3A2A1A0h, 0A7A6A5A4h, 0ABAAA9A8h
		dd 0AFAEADACh, 0B3B2B1B0h, 0B7B6B5B4h, 0BBBAB9B8h, 0BFBEBDBCh
		dd 0C3C2C1C0h, 0C7C6C5C4h, 0CBCAC9C8h, 0CFCECDCCh, 0D3D2D1D0h
		dd 0D7D6D5D4h, 0DBDAD9D8h, 0DFDEDDDCh, 0E3E2E1E0h, 0E7E6E5E4h
		dd 0EBEAE9E8h, 0EFEEEDECh, 0F3F2F1F0h, 0F7F6F5F4h, 0FBFAF9F8h
		dd 0FFFEFDFCh
dword_1002A2F8	dd 3020100h, 7060504h, 0B0A0908h, 0F0E0D0Ch, 13121110h
					; DATA XREF: sub_1001B12E+372o
					; .data:1002DB60o
		dd 17161514h, 1B1A1918h, 1F1E1D1Ch, 23222120h, 27262524h
		dd 2B2A2928h, 2F2E2D2Ch, 33323130h, 37363534h, 3B3A3938h
		dd 3F3E3D3Ch, 43424140h, 47464544h, 4B4A4948h, 4F4E4D4Ch
		dd 53525150h, 57565554h, 5B5A5958h, 5F5E5D5Ch, 43424160h
		dd 47464544h, 4B4A4948h, 4F4E4D4Ch, 53525150h, 57565554h
		dd 7B5A5958h, 7F7E7D7Ch, 83828180h, 87868584h, 8B8A8988h
		dd 8F8E8D8Ch, 93929190h, 97969594h, 9B9A9998h, 9F9E9D9Ch
		dd 0A3A2A1A0h, 0A7A6A5A4h, 0ABAAA9A8h, 0AFAEADACh, 0B3B2B1B0h
		dd 0B7B6B5B4h, 0BBBAB9B8h, 0BFBEBDBCh, 0C3C2C1C0h, 0C7C6C5C4h
		dd 0CBCAC9C8h, 0CFCECDCCh, 0D3D2D1D0h, 0D7D6D5D4h, 0DBDAD9D8h
		dd 0DFDEDDDCh, 0E3E2E1E0h, 0E7E6E5E4h, 0EBEAE9E8h, 0EFEEEDECh
		dd 0F3F2F1F0h, 0F7F6F5F4h, 0FBFAF9F8h, 0FFFEFDFCh, 480048h
		dd 6D003Ah, 3A006Dh, 730073h, 0
aDdddMmmmDdYyyy:			; DATA XREF: .data:1002E10Co
		unicode	0, <dddd, MMMM dd, yyyy>,0
aMmDdYy:				; DATA XREF: .data:1002E108o
		unicode	0, <MM/dd/yy>,0
		align 4
aPm:					; DATA XREF: .data:1002E104o
		unicode	0, <PM>,0
		align 10h
aAm:					; DATA XREF: .data:1002E100o
		unicode	0, <AM>,0
		align 4
aDecember:				; DATA XREF: .data:1002E0FCo
		unicode	0, <December>,0
		align 4
aNovember:				; DATA XREF: .data:1002E0F8o
		unicode	0, <November>,0
		align 10h
aOctober:				; DATA XREF: .data:1002E0F4o
		unicode	0, <October>,0
aSeptember:				; DATA XREF: .data:1002E0F0o
		unicode	0, <September>,0
aAugust:				; DATA XREF: .data:1002E0ECo
		unicode	0, <August>,0
		align 4
aJuly:					; DATA XREF: .data:1002E0E8o
		unicode	0, <July>,0
		align 10h
aJune:					; DATA XREF: .data:1002E0E4o
		unicode	0, <June>,0
		align 4
aApril:					; DATA XREF: .data:1002E0DCo
		unicode	0, <April>,0
aMarch:					; DATA XREF: .data:1002E0D8o
		unicode	0, <March>,0
aFebruary:				; DATA XREF: .data:1002E0D4o
		unicode	0, <February>,0
		align 4
aJanuary:				; DATA XREF: .data:1002E0D0o
		unicode	0, <January>,0
aDec:					; DATA XREF: .data:1002E0CCo
		unicode	0, <Dec>,0
aNov:					; DATA XREF: .data:1002E0C8o
		unicode	0, <Nov>,0
aOct:					; DATA XREF: .data:1002E0C4o
		unicode	0, <Oct>,0
aSep:					; DATA XREF: .data:1002E0C0o
		unicode	0, <Sep>,0
aAug:					; DATA XREF: .data:1002E0BCo
		unicode	0, <Aug>,0
aJul:					; DATA XREF: .data:1002E0B8o
		unicode	0, <Jul>,0
aJun:					; DATA XREF: .data:1002E0B4o
		unicode	0, <Jun>,0
aMay:					; DATA XREF: .data:1002E0B0o
					; .data:1002E0E0o
		unicode	0, <May>,0
aApr:					; DATA XREF: .data:1002E0ACo
		unicode	0, <Apr>,0
aMar:					; DATA XREF: .data:1002E0A8o
		unicode	0, <Mar>,0
aFeb:					; DATA XREF: .data:1002E0A4o
		unicode	0, <Feb>,0
aJan:					; DATA XREF: .data:1002E0A0o
		unicode	0, <Jan>,0
aSaturday:				; DATA XREF: .data:1002E09Co
		unicode	0, <Saturday>,0
		align 4
aFriday:				; DATA XREF: .data:1002E098o
		unicode	0, <Friday>,0
		align 4
aThursday:				; DATA XREF: .data:1002E094o
		unicode	0, <Thursday>,0
		align 10h
aWednesday:				; DATA XREF: .data:1002E090o
		unicode	0, <Wednesday>,0
aTuesday:				; DATA XREF: .data:1002E08Co
		unicode	0, <Tuesday>,0
aMonday:				; DATA XREF: .data:1002E088o
		unicode	0, <Monday>,0
		align 4
aSunday:				; DATA XREF: .data:1002E084o
		unicode	0, <Sunday>,0
		align 4
aSat:					; DATA XREF: .data:1002E080o
		unicode	0, <Sat>,0
aFri:					; DATA XREF: .data:1002E07Co
		unicode	0, <Fri>,0
aThu:					; DATA XREF: .data:1002E078o
		unicode	0, <Thu>,0
aWed:					; DATA XREF: .data:1002E074o
		unicode	0, <Wed>,0
aTue:					; DATA XREF: .data:1002E070o
		unicode	0, <Tue>,0
aMon:					; DATA XREF: .data:1002E06Co
		unicode	0, <Mon>,0
aSun:					; DATA XREF: .data:1002E068o
		unicode	0, <Sun>,0
aHhMmSs		db 'HH:mm:ss',0         ; DATA XREF: .data:1002E058o
		align 4
aDdddMmmmDdYy_0	db 'dddd, MMMM dd, yyyy',0 ; DATA XREF: .data:1002E054o
aMmDdYy_0	db 'MM/dd/yy',0         ; DATA XREF: .data:1002E050o
		align 4
aPm_0		db 'PM',0               ; DATA XREF: .data:1002E04Co
		align 4
aAm_0		db 'AM',0               ; DATA XREF: .data:1002E048o
		align 10h
aDecember_0	db 'December',0         ; DATA XREF: .data:1002E044o
		align 4
aNovember_0	db 'November',0         ; DATA XREF: .data:1002E040o
		align 4
aOctober_0	db 'October',0          ; DATA XREF: .data:1002E03Co
aSeptember_0	db 'September',0        ; DATA XREF: .data:1002E038o
		align 4
aAugust_0	db 'August',0           ; DATA XREF: .data:1002E034o
		align 4
aJuly_0		db 'July',0             ; DATA XREF: .data:1002E030o
		align 4
aJune_0		db 'June',0             ; DATA XREF: .data:1002E02Co
		align 4
aApril_0	db 'April',0            ; DATA XREF: .data:1002E024o
		align 4
aMarch_0	db 'March',0            ; DATA XREF: .data:1002E020o
		align 4
aFebruary_0	db 'February',0         ; DATA XREF: .data:1002E01Co
		align 10h
aJanuary_0	db 'January',0          ; DATA XREF: .data:1002E018o
aDec_0		db 'Dec',0              ; DATA XREF: .data:1002E014o
aNov_0		db 'Nov',0              ; DATA XREF: .data:1002E010o
aOct_0		db 'Oct',0              ; DATA XREF: .data:1002E00Co
aSep_0		db 'Sep',0              ; DATA XREF: .data:1002E008o
aAug_0		db 'Aug',0              ; DATA XREF: .data:1002E004o
aJul_0		db 'Jul',0              ; DATA XREF: .data:1002E000o
aJun_0		db 'Jun',0              ; DATA XREF: .data:1002DFFCo
aMay_0		db 'May',0              ; DATA XREF: .data:1002DFF8o
					; .data:1002E028o
aApr_0		db 'Apr',0              ; DATA XREF: .data:1002DFF4o
aMar_0		db 'Mar',0              ; DATA XREF: .data:1002DFF0o
aFeb_0		db 'Feb',0              ; DATA XREF: .data:1002DFECo
aJan_0		db 'Jan',0              ; DATA XREF: .data:1002DFE8o
aSaturday_0	db 'Saturday',0         ; DATA XREF: .data:1002DFE4o
		align 4
aFriday_0	db 'Friday',0           ; DATA XREF: .data:1002DFE0o
		align 4
aThursday_0	db 'Thursday',0         ; DATA XREF: .data:1002DFDCo
		align 4
aWednesday_0	db 'Wednesday',0        ; DATA XREF: .data:1002DFD8o
		align 4
aTuesday_0	db 'Tuesday',0          ; DATA XREF: .data:1002DFD4o
aMonday_0	db 'Monday',0           ; DATA XREF: .data:1002DFD0o
		align 4
aSunday_0	db 'Sunday',0           ; DATA XREF: .data:1002DFCCo
		align 4
aSat_0		db 'Sat',0              ; DATA XREF: .data:1002DFC8o
aFri_0		db 'Fri',0              ; DATA XREF: .data:1002DFC4o
aThu_0		db 'Thu',0              ; DATA XREF: .data:1002DFC0o
aWed_0		db 'Wed',0              ; DATA XREF: .data:1002DFBCo
aTue_0		db 'Tue',0              ; DATA XREF: .data:1002DFB8o
aMon_0		db 'Mon',0              ; DATA XREF: .data:1002DFB4o
aSun_0		db 'Sun',0              ; DATA XREF: .data:off_1002DFB0o
aAP		db 'a/p',0              ; DATA XREF: sub_1001C020:loc_1001C259o
aAmPm		db 'am/pm',0            ; DATA XREF: sub_1001C020:loc_1001C243o
		align 4
aUnitedStates	db 'united-states',0    ; DATA XREF: .rdata:1002AF18o
		align 4
aUnitedKingdom	db 'united-kingdom',0   ; DATA XREF: .rdata:1002AF10o
		align 4
aTrinidadTobago	db 'trinidad & tobago',0 ; DATA XREF: .rdata:1002AF00o
		align 4
aSouthKorea	db 'south-korea',0      ; DATA XREF: .rdata:1002AEF8o
aSouthAfrica	db 'south-africa',0     ; DATA XREF: .rdata:1002AEF0o
		align 4
aSouthKorea_0	db 'south korea',0      ; DATA XREF: .rdata:1002AEE8o
aSouthAfrica_0	db 'south africa',0     ; DATA XREF: .rdata:1002AEE0o
		align 10h
aSlovak		db 'slovak',0           ; DATA XREF: .rdata:1002AED8o
		align 4
aPuertoRico	db 'puerto-rico',0      ; DATA XREF: .rdata:1002AED0o
aPrChina	db 'pr-china',0         ; DATA XREF: .rdata:1002AEC8o
		align 10h
aPrChina_0	db 'pr china',0         ; DATA XREF: .rdata:1002AEC0o
		align 4
aNz		db 'nz',0               ; DATA XREF: .rdata:1002AEB8o
		align 10h
aNewZealand	db 'new-zealand',0      ; DATA XREF: .rdata:1002AEB0o
aHongKong	db 'hong-kong',0        ; DATA XREF: .rdata:1002AEA8o
		align 4
aHolland	db 'holland',0          ; DATA XREF: .rdata:1002AEA0o
aGreatBritain	db 'great britain',0    ; DATA XREF: .rdata:1002AE98o
		align 10h
aEngland	db 'england',0          ; DATA XREF: .rdata:1002AE90o
aCzech		db 'czech',0            ; DATA XREF: .rdata:1002AE88o
		align 10h
aChina		db 'china',0            ; DATA XREF: .rdata:1002AE80o
		align 4
aBritain	db 'britain',0          ; DATA XREF: .rdata:1002AE78o
aAmerica	db 'america',0          ; DATA XREF: .rdata:off_1002AE70o
aUsa		db 'usa',0              ; DATA XREF: .rdata:1002AE68o
aUs		db 'us',0               ; DATA XREF: .rdata:1002AE60o
					; .rdata:1002AF20o
		align 10h
aUk		db 'uk',0               ; DATA XREF: .rdata:1002AE58o
					; .rdata:1002AF08o
		align 4
aSwiss		db 'swiss',0            ; DATA XREF: .rdata:1002AE50o
		align 4
aSwedishFinland	db 'swedish-finland',0  ; DATA XREF: .rdata:1002AE48o
aSpanishVenezue	db 'spanish-venezuela',0 ; DATA XREF: .rdata:1002AE40o
		align 10h
aSpanishUruguay	db 'spanish-uruguay',0  ; DATA XREF: .rdata:1002AE38o
aSpanishPuertoR	db 'spanish-puerto rico',0 ; DATA XREF: .rdata:1002AE30o
aSpanishPeru	db 'spanish-peru',0     ; DATA XREF: .rdata:1002AE28o
		align 4
aSpanishParagua	db 'spanish-paraguay',0 ; DATA XREF: .rdata:1002AE20o
		align 4
aSpanishPanama	db 'spanish-panama',0   ; DATA XREF: .rdata:1002AE18o
		align 4
aSpanishNicarag	db 'spanish-nicaragua',0 ; DATA XREF: .rdata:1002AE10o
		align 4
aSpanishModern	db 'spanish-modern',0   ; DATA XREF: .rdata:1002AE08o
		align 4
aSpanishMexican	db 'spanish-mexican',0  ; DATA XREF: .rdata:1002AE00o
aSpanishHondura	db 'spanish-honduras',0 ; DATA XREF: .rdata:1002ADF8o
		align 10h
aSpanishGuatema	db 'spanish-guatemala',0 ; DATA XREF: .rdata:1002ADF0o
		align 4
aSpanishElSalva	db 'spanish-el salvador',0 ; DATA XREF: .rdata:1002ADE8o
aSpanishEcuador	db 'spanish-ecuador',0  ; DATA XREF: .rdata:1002ADE0o
aSpanishDominic	db 'spanish-dominican republic',0 ; DATA XREF: .rdata:1002ADD8o
		align 4
aSpanishCostaRi	db 'spanish-costa rica',0 ; DATA XREF: .rdata:1002ADD0o
		align 4
aSpanishColombi	db 'spanish-colombia',0 ; DATA XREF: .rdata:1002ADC8o
		align 4
aSpanishChile	db 'spanish-chile',0    ; DATA XREF: .rdata:1002ADC0o
		align 4
aSpanishBolivia	db 'spanish-bolivia',0  ; DATA XREF: .rdata:1002ADB8o
aSpanishArgenti	db 'spanish-argentina',0 ; DATA XREF: .rdata:1002ADB0o
		align 10h
aPortugueseBraz	db 'portuguese-brazilian',0 ; DATA XREF: .rdata:1002ADA8o
		align 4
aNorwegianNyn_0	db 'norwegian-nynorsk',0 ; DATA XREF: .rdata:1002ADA0o
		align 4
aNorwegianBokma	db 'norwegian-bokmal',0 ; DATA XREF: .rdata:1002AD98o
		align 10h
aNorwegian	db 'norwegian',0        ; DATA XREF: .rdata:1002AD90o
		align 4
aJa		db 'ja',0               ; DATA XREF: .rdata:1002AD88o
		align 10h
aItalianSwiss	db 'italian-swiss',0    ; DATA XREF: .rdata:1002AD80o
		align 10h
aIrishEnglish	db 'irish-english',0    ; DATA XREF: .rdata:1002AD78o
		align 10h
aGermanSwiss	db 'german-swiss',0     ; DATA XREF: .rdata:1002AD70o
		align 10h
aGermanLuxembou	db 'german-luxembourg',0 ; DATA XREF: .rdata:1002AD68o
		align 4
aGermanLichtens	db 'german-lichtenstein',0 ; DATA XREF: .rdata:1002AD60o
aGermanAustrian	db 'german-austrian',0  ; DATA XREF: .rdata:1002AD58o
aFrenchSwiss	db 'french-swiss',0     ; DATA XREF: .rdata:1002AD50o
		align 4
aFrenchLuxembou	db 'french-luxembourg',0 ; DATA XREF: .rdata:1002AD48o
		align 4
aFrenchCanadian	db 'french-canadian',0  ; DATA XREF: .rdata:1002AD40o
aFrenchBelgian	db 'french-belgian',0   ; DATA XREF: .rdata:1002AD38o
		align 4
aEnglishUsa	db 'english-usa',0      ; DATA XREF: .rdata:1002AD30o
aEnglishUs	db 'english-us',0       ; DATA XREF: .rdata:1002AD28o
		align 4
aEnglishUk	db 'english-uk',0       ; DATA XREF: .rdata:1002AD20o
		align 10h
aEnglishTrinida	db 'english-trinidad y tobago',0 ; DATA XREF: .rdata:1002AD18o
		align 4
aEnglishSouthAf	db 'english-south africa',0 ; DATA XREF: .rdata:1002AD10o
		align 4
aEnglishNz	db 'english-nz',0       ; DATA XREF: .rdata:1002AD08o
		align 10h
aEnglishJamaica	db 'english-jamaica',0  ; DATA XREF: .rdata:1002AD00o
aEnglishIre	db 'english-ire',0      ; DATA XREF: .rdata:1002ACF8o
aEnglishCaribbe	db 'english-caribbean',0 ; DATA XREF: .rdata:1002ACF0o
		align 10h
aEnglishCan	db 'english-can',0      ; DATA XREF: .rdata:1002ACE8o
aEnglishBelize	db 'english-belize',0   ; DATA XREF: .rdata:1002ACE0o
		align 4
aEnglishAus	db 'english-aus',0      ; DATA XREF: .rdata:1002ACD8o
aEnglishAmerica	db 'english-american',0 ; DATA XREF: .rdata:1002ACD0o
		align 4
aDutchBelgian	db 'dutch-belgian',0    ; DATA XREF: .rdata:1002ACC8o
		align 4
aChineseTraditi	db 'chinese-traditional',0 ; DATA XREF: .rdata:1002ACC0o
aChineseSingapo	db 'chinese-singapore',0 ; DATA XREF: .rdata:1002ACB8o
		align 4
aChineseSimplif	db 'chinese-simplified',0 ; DATA XREF: .rdata:1002ACB0o
		align 4
aChineseHongkon	db 'chinese-hongkong',0 ; DATA XREF: .rdata:1002ACA8o
		align 4
aChinese	db 'chinese',0          ; DATA XREF: .rdata:1002ACA0o
aChi		db 'chi',0              ; DATA XREF: .rdata:1002AC98o
aChh		db 'chh',0              ; DATA XREF: .rdata:1002AC90o
aCanadian	db 'canadian',0         ; DATA XREF: .rdata:1002AC88o
		align 4
aBelgian	db 'belgian',0          ; DATA XREF: .rdata:1002AC80o
aAustralian	db 'australian',0       ; DATA XREF: .rdata:1002AC78o
		align 4
aAmericanEnglis	db 'american-english',0 ; DATA XREF: .rdata:1002AC70o
		align 10h
aAmericanEngl_0	db 'american english',0 ; DATA XREF: .rdata:1002AC68o
		align 4
aAmerican	db 'american',0         ; DATA XREF: .rdata:off_1002AC60o
		align 10h
off_1002AC60	dd offset aAmerican	; DATA XREF: sub_1001CDB0+7Eo
					; "american"
		dd 554E45h
		dd offset aAmericanEngl_0 ; "american english"
		dd 554E45h
		dd offset aAmericanEnglis ; "american-english"
		dd 554E45h
		dd offset aAustralian	; "australian"
		dd 414E45h
		dd offset aBelgian	; "belgian"
		dd 424C4Eh
		dd offset aCanadian	; "canadian"
		dd 434E45h
		dd offset aChh		; "chh"
		dd 48485Ah
		dd offset aChi		; "chi"
		dd 49485Ah
		dd offset aChinese	; "chinese"
		dd 534843h
		dd offset aChineseHongkon ; "chinese-hongkong"
		dd 48485Ah
		dd offset aChineseSimplif ; "chinese-simplified"
		dd 534843h
		dd offset aChineseSingapo ; "chinese-singapore"
		dd 49485Ah
		dd offset aChineseTraditi ; "chinese-traditional"
		dd 544843h
		dd offset aDutchBelgian	; "dutch-belgian"
		dd 424C4Eh
		dd offset aEnglishAmerica ; "english-american"
		dd 554E45h
		dd offset aEnglishAus	; "english-aus"
		dd 414E45h
		dd offset aEnglishBelize ; "english-belize"
		dd 4C4E45h
		dd offset aEnglishCan	; "english-can"
		dd 434E45h
		dd offset aEnglishCaribbe ; "english-caribbean"
		dd 424E45h
		dd offset aEnglishIre	; "english-ire"
		dd 494E45h
		dd offset aEnglishJamaica ; "english-jamaica"
		dd 4A4E45h
		dd offset aEnglishNz	; "english-nz"
		dd 5A4E45h
		dd offset aEnglishSouthAf ; "english-south africa"
		dd 534E45h
		dd offset aEnglishTrinida ; "english-trinidad y	tobago"
		dd 544E45h
		dd offset aEnglishUk	; "english-uk"
		dd 474E45h
		dd offset aEnglishUs	; "english-us"
		dd 554E45h
		dd offset aEnglishUsa	; "english-usa"
		dd 554E45h
		dd offset aFrenchBelgian ; "french-belgian"
		dd 425246h
		dd offset aFrenchCanadian ; "french-canadian"
		dd 435246h
		dd offset aFrenchLuxembou ; "french-luxembourg"
		dd 4C5246h
		dd offset aFrenchSwiss	; "french-swiss"
		dd 535246h
		dd offset aGermanAustrian ; "german-austrian"
		dd 414544h
		dd offset aGermanLichtens ; "german-lichtenstein"
		dd 434544h
		dd offset aGermanLuxembou ; "german-luxembourg"
		dd 4C4544h
		dd offset aGermanSwiss	; "german-swiss"
		dd 534544h
		dd offset aIrishEnglish	; "irish-english"
		dd 494E45h
		dd offset aItalianSwiss	; "italian-swiss"
		dd 535449h
		dd offset aJa		; "ja"
		dd 4E504Ah
		dd offset aNorwegian	; "norwegian"
		dd 524F4Eh
		dd offset aNorwegianBokma ; "norwegian-bokmal"
		dd 524F4Eh
		dd offset aNorwegianNyn_0 ; "norwegian-nynorsk"
		dd 4E4F4Eh
		dd offset aPortugueseBraz ; "portuguese-brazilian"
		dd 425450h
		dd offset aSpanishArgenti ; "spanish-argentina"
		dd 535345h
		dd offset aSpanishBolivia ; "spanish-bolivia"
		dd 425345h
		dd offset aSpanishChile	; "spanish-chile"
		dd 4C5345h
		dd offset aSpanishColombi ; "spanish-colombia"
		dd 4F5345h
		dd offset aSpanishCostaRi ; "spanish-costa rica"
		dd 435345h
		dd offset aSpanishDominic ; "spanish-dominican republic"
		dd 445345h
		dd offset aSpanishEcuador ; "spanish-ecuador"
		dd 465345h
		dd offset aSpanishElSalva ; "spanish-el	salvador"
		dd 455345h
		dd offset aSpanishGuatema ; "spanish-guatemala"
		dd 475345h
		dd offset aSpanishHondura ; "spanish-honduras"
		dd 485345h
		dd offset aSpanishMexican ; "spanish-mexican"
		dd 4D5345h
		dd offset aSpanishModern ; "spanish-modern"
		dd 4E5345h
		dd offset aSpanishNicarag ; "spanish-nicaragua"
		dd 495345h
		dd offset aSpanishPanama ; "spanish-panama"
		dd 415345h
		dd offset aSpanishParagua ; "spanish-paraguay"
		dd 5A5345h
		dd offset aSpanishPeru	; "spanish-peru"
		dd 525345h
		dd offset aSpanishPuertoR ; "spanish-puerto rico"
		dd 555345h
		dd offset aSpanishUruguay ; "spanish-uruguay"
		dd 595345h
		dd offset aSpanishVenezue ; "spanish-venezuela"
		dd 565345h
		dd offset aSwedishFinland ; "swedish-finland"
		dd 465653h
		dd offset aSwiss	; "swiss"
		dd 534544h
		dd offset aUk		; "uk"
		dd 474E45h
		dd offset aUs		; "us"
		dd 554E45h
		dd offset aUsa		; "usa"
		dd 554E45h
off_1002AE70	dd offset aAmerica	; DATA XREF: sub_1001CDB0+3Eo
					; "america"
		dd 415355h
		dd offset aBritain	; "britain"
		dd 524247h
		dd offset aChina	; "china"
		dd 4E4843h
		dd offset aCzech	; "czech"
		dd 455A43h
		dd offset aEngland	; "england"
		dd 524247h
		dd offset aGreatBritain	; "great britain"
		dd 524247h
		dd offset aHolland	; "holland"
		dd 444C4Eh
		dd offset aHongKong	; "hong-kong"
		dd 474B48h
		dd offset aNewZealand	; "new-zealand"
		dd 4C5A4Eh
		dd offset aNz		; "nz"
		dd 4C5A4Eh
		dd offset aPrChina_0	; "pr china"
		dd 4E4843h
		dd offset aPrChina	; "pr-china"
		dd 4E4843h
		dd offset aPuertoRico	; "puerto-rico"
		dd 495250h
		dd offset aSlovak	; "slovak"
		dd 4B5653h
		dd offset aSouthAfrica_0 ; "south africa"
		dd 46415Ah
		dd offset aSouthKorea_0	; "south korea"
		dd 524F4Bh
		dd offset aSouthAfrica	; "south-africa"
		dd 46415Ah
		dd offset aSouthKorea	; "south-korea"
		dd 524F4Bh
		dd offset aTrinidadTobago ; "trinidad &	tobago"
		dd 4F5454h
		dd offset aUk		; "uk"
		dd 524247h
		dd offset aUnitedKingdom ; "united-kingdom"
		dd 524247h
		dd offset aUnitedStates	; "united-states"
		dd 415355h
		dd offset aUs		; "us"
		dd 415355h
word_1002AF28	dw 0C0Ch		; DATA XREF: sub_1001C878+Br
		dw 0C1Ah
		dd 4361007h, 42D080Ch, 100C0403h
byte_1002AF38	db 10h			; DATA XREF: sub_1001D746+1A6r
					; sub_1001E5A0+1F6r
		db 8, 1Dh, 8
dword_1002AF3C	dd 50434Fh		; DATA XREF: sub_1001C7FC+33o
dword_1002AF40	dd 504341h		; DATA XREF: sub_1001C7FC+23o
aNorwegianNynor	db 'Norwegian-Nynorsk',0 ; DATA XREF: sub_1001CDB0+191o
		align 4
byte_1002AF58	db 6			; DATA XREF: sub_1001D746+1B9r
					; sub_1001E5A0+20Dr
aAajaba		db '',0
		dd 86031000h, 80828680h, 45050514h, 85854545h, 585h, 50803030h
		dd 8008880h, 38272800h,	805750h, 30370007h, 88505030h
		dd 20000000h, 80888028h, 80h
aHHhhXppwpp	db '`h`hhh',8,8,7,'xppwpp',8,8,0
		dw 800h
		dd 7000800h, 8
; CHAR aInitializecrit[]
aInitializecrit	db 'InitializeCriticalSectionAndSpinCount',0
					; DATA XREF: sub_1001F928:loc_1001F98Ao
		align 4
; const	WCHAR aKernel32_dll_1
aKernel32_dll_1:			; DATA XREF: sub_1001F928+57o
					; sub_10021623+96o
		unicode	0, <kernel32.dll>,0
		align 4
; const	WCHAR aKernelbase_d_0
aKernelbase_d_0:			; DATA XREF: sub_1001F928+44o
					; sub_10021623+8Bo
		unicode	0, <kernelbase.dll>,0
		align 4
; CHAR aGetprocesswind[]
aGetprocesswind	db 'GetProcessWindowStation',0 ; DATA XREF: sub_10020306+C5o
; CHAR aGetuserobjecti[]
aGetuserobjecti	db 'GetUserObjectInformationA',0 ; DATA XREF: sub_10020306+ADo
		align 4
; CHAR aGetlastactivep[]
aGetlastactivep	db 'GetLastActivePopup',0 ; DATA XREF: sub_10020306+71o
		align 10h
; CHAR aGetactivewindo[]
aGetactivewindo	db 'GetActiveWindow',0  ; DATA XREF: sub_10020306+5Co
; CHAR aMessageboxa[]
aMessageboxa	db 'MessageBoxA',0      ; DATA XREF: sub_10020306+4Ao
; CHAR aUser32_dll[]
aUser32_dll	db 'USER32.DLL',0       ; DATA XREF: sub_10020306+2Co
		align 4
; CHAR aSetthreadstack[]
aSetthreadstack	db 'SetThreadStackGuarantee',0 ; DATA XREF: sub_10021623:loc_100216C4o
aTz		db 'TZ',0               ; DATA XREF: sub_10022F7A+A0o
		align 4
aSunmontuewedth	db 'SunMonTueWedThuFriSat',0
		align 4
aJanfebmaraprma	db 'JanFebMarAprMayJunJulAugSepOctNovDec',0
		align 4
a_com		db '.com',0             ; DATA XREF: sub_10025296+91o
		align 4
a_bat		db '.bat',0             ; DATA XREF: sub_10025296+80o
		align 4
a_cmd		db '.cmd',0             ; DATA XREF: sub_10025296+6Fo
		align 4
a_exe		db '.exe',0             ; DATA XREF: sub_10025296+5Eo
		align 4
a_		db './\',0              ; DATA XREF: sub_10025437+C1o
a?		db '?*',0               ; DATA XREF: sub_10025437+52o
		align 10h
__load_config_used dd 48h		; Size
		dd 0			; Time stamp
		dw 2 dup(0)		; Version: 0.0
		dd 0			; GlobalFlagsClear
		dd 0			; GlobalFlagsSet
		dd 0			; CriticalSectionDefaultTimeout
		dd 0			; DeCommitFreeBlockThreshold
		dd 0			; DeCommitTotalFreeThreshold
		dd 0			; LockPrefixTable
		dd 0			; MaximumAllocationSize
		dd 0			; VirtualMemoryThreshold
		dd 0			; ProcessAffinityMask
		dd 0			; ProcessHeapFlags
		dw 0			; CSDVersion
		dw 0			; Reserved1
		dd 0			; EditList
		dd offset ___security_cookie ; SecurityCookie
		dd offset ___safe_se_handler_table ; SEHandlerTable
		dd 3			; SEHandlerCount
; Debug	information (IMAGE_DEBUG_TYPE_CODEVIEW)
asc_1002B158	db 'RSDS'               ; DATA XREF: .rdata:10027234o
					; CV signature
		dd 85CC5848h		; Data1	; GUID
		dw 0D8AAh		; Data2
		dw 4824h		; Data3
		db 0A1h, 41h, 0E3h, 0CDh, 0E1h,	0BBh, 0BFh, 86h; Data4
		dd 1			; Age
		db 'c:\devel\cyrus\cyrus-sasl-2.1.25\lib\libsasl.pdb',0 ; PdbFileName
		align 10h
___safe_se_handler_table dd rva	sub_10014D30 ; DATA XREF: .rdata:1002B150o
		dd rva sub_100180C0
		dd rva sub_10022B50
		align 10h
stru_1002B1C0	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000ED67+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000ED67
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1000EDE8	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B1E0	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000EE73+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000EE73
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1000EEC9	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B200	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000F114+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000F114
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1000F252	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B220	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000F378+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000F378
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1000F46F	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B240	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000F4D7+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000F4D7
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1000F51D	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B260	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000F863+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000F863
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1000F8C5	; ScopeRecord.HandlerFunc
		align 10h
dword_1002B280	dd 0FFFFFFFEh, 0	; DATA XREF: .text:1000F8D0o
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_1000F992
		align 10h
dword_1002B2A0	dd 0FFFFFFFEh, 0	; DATA XREF: .text:1000F99Do
		dd 0FFFFFFD0h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_1000FA6F
		align 10h
stru_1002B2C0	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000FCAB+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000FCAB
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1000FD1C	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B2E0	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000FE75+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000FE75
		dd 0FFFFFFC8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1000FFF1	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B300	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000FFFD+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000FFFD
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_100100C7	; ScopeRecord.HandlerFunc
		align 10h
dword_1002B320	dd 0FFFFFFFEh, 0	; DATA XREF: .text:100106BEo
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_100106F7
		align 10h
stru_1002B340	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10010700+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10010700
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10010735	; ScopeRecord.HandlerFunc
		align 10h
dword_1002B360	dd 0FFFFFFFEh, 0	; DATA XREF: .text:10010740o
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10010773
		align 10h
dword_1002B380	dd 0FFFFFFFEh, 0	; DATA XREF: .text:1001077Eo
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_100107B1
		align 10h
stru_1002B3A0	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1001086A+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001086A
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1001093B	; ScopeRecord.HandlerFunc
		dd 0			; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10010907	; ScopeRecord.HandlerFunc
stru_1002B3C8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10010944+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10010944
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1001098D	; ScopeRecord.HandlerFunc
		align 8
stru_1002B3E8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100109A0+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100109A0
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10010AE5	; ScopeRecord.HandlerFunc
		align 8
dword_1002B408	dd 0FFFFFFFEh, 0	; DATA XREF: DllEntryPoint-249o
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh
		dd offset sub_10011657
		dd offset sub_10011668
		dd 0FFFFFFFEh
		dd offset sub_10011694
		dd offset sub_100116A5
		dd 0FFFFFFFEh
		dd offset sub_100116DA
		dd offset sub_100116EB
		dd 0FFFFFFFEh
		dd offset sub_10011722
		dd offset sub_10011733
		dd 0FFFFFFFEh
		dd offset sub_10011754
		dd offset sub_10011765
		dd 0FFFFFFFEh
		dd offset sub_1001178C
		dd offset sub_1001179D
		dd 0FFFFFFFEh
		dd offset sub_100117D1
		dd offset sub_100117E2
		dd 0FFFFFFFEh
		dd offset sub_1001181B
		dd offset sub_1001182C
stru_1002B478	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10011941+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10011941
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1001195E	; ScopeRecord.FilterFunc
		dd offset loc_1001197A	; ScopeRecord.HandlerFunc
		align 8
stru_1002B498	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10011D90+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10011D90
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10011E16	; ScopeRecord.HandlerFunc
		align 8
stru_1002B4B8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100120AC+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100120AC
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1001220D	; ScopeRecord.HandlerFunc
		align 8
stru_1002B4D8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10012545+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10012545
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1001259B	; ScopeRecord.HandlerFunc
		align 8
dword_1002B4F8	dd 0FFFFFFFEh, 0	; DATA XREF: .text:1001267Fo
		dd 0FFFFFFD8h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10012707
		align 8
dword_1002B518	dd 0FFFFFFFEh, 0	; DATA XREF: .text:10012720o
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_1001279A
		align 8
dword_1002B538	dd 0FFFFFFFEh, 0	; DATA XREF: .text:100133C4o
		dd 0FFFFFFCCh, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10013540
		dd 2 dup(0)
		dd offset sub_1001348D
		dd 2 dup(0)
		dd offset sub_1001350F
		align 10h
stru_1002B570	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100136E4+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100136E4
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_100137A3	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B590	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10013842+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013842
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10013975	; ScopeRecord.HandlerFunc
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10013981	; ScopeRecord.HandlerFunc
stru_1002B5B8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10014EBC+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10014EBC
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10014F3C	; ScopeRecord.HandlerFunc
		align 8
stru_1002B5D8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10015204+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10015204
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_100152BE	; ScopeRecord.HandlerFunc
		align 8
stru_1002B5F8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10016683+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10016683
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10016739	; ScopeRecord.HandlerFunc
		align 8
stru_1002B618	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10016F3F+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10016F3F
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10017041	; ScopeRecord.HandlerFunc
		align 8
stru_1002B638	dd 0FFFFFFE4h		; GSCookieOffset ; DATA	XREF: sub_100170CC+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100170CC
		dd 0FFFFFFB4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10017493	; ScopeRecord.FilterFunc
		dd offset loc_10017497	; ScopeRecord.HandlerFunc
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100171FE	; ScopeRecord.FilterFunc
		dd offset loc_10017202	; ScopeRecord.HandlerFunc
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10017302	; ScopeRecord.FilterFunc
		dd offset loc_10017306	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B670	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100179DC+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100179DC
		dd 0FFFFFF8Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10017BFF	; ScopeRecord.FilterFunc
		dd offset loc_10017C03	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B690	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10017F09+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10017F09
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10018023	; ScopeRecord.HandlerFunc
		align 10h
dword_1002B6B0	dd 0FFFFFFFEh, 0	; DATA XREF: .text:1001831Do
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10018354
		align 10h
stru_1002B6D0	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10018A68+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10018A68
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10018B3A	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B6F0	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10018B44+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10018B44
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10018C1B	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B710	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10018C25+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10018C25
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10018D69	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B730	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10018E30+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10018E30
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10018EC6	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B750	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1001D634+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001D634
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1001D67A	; ScopeRecord.FilterFunc
		dd offset loc_1001D68E	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B770	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1001F928+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001F928
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1001F9BD	; ScopeRecord.FilterFunc
		dd offset loc_1001F9D4	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B790	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1001FD75+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001FD75
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1001FD95	; ScopeRecord.FilterFunc
		dd offset loc_1001FD99	; ScopeRecord.HandlerFunc
		align 10h
dword_1002B7B0	dd 0FFFFFFFEh, 0	; DATA XREF: .text:1001FDC3o
		dd 0FFFFFFD8h, 0
		dd 0FFFFFFFEh
		dd offset sub_1001FDE5
		dd offset sub_1001FDE9
		align 10h
stru_1002B7D0	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1001FE28+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001FE28
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1001FEA1	; ScopeRecord.HandlerFunc
		align 10h
dword_1002B7F0	dd 0FFFFFFFEh, 0	; DATA XREF: .text:1001FF1Bo
		dd 0FFFFFFD0h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_1002010E
		align 10h
stru_1002B810	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10020156+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10020156
		dd 0FFFFFFC0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_100202C4	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B830	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10020D9D+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10020D9D
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10020EAC	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B850	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1002109E+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1002109E
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10021133	; ScopeRecord.HandlerFunc
		align 10h
stru_1002B870	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10021166+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10021166
		dd 0FFFFFFC8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10021301	; ScopeRecord.HandlerFunc
		dd 0			; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10021234	; ScopeRecord.HandlerFunc
dword_1002B898	dd 0FFFFFFFEh, 0	; DATA XREF: .text:1002130Co
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_100213F3
		align 8
stru_1002B8B8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10021E88+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10021E88
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10021F5A	; ScopeRecord.HandlerFunc
		align 8
dword_1002B8D8	dd 0FFFFFFFEh, 0	; DATA XREF: .text:100225B0o
		dd 0FFFFFFCCh, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10022628
		align 8
stru_1002B8F8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10022664+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10022664
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_100226E9	; ScopeRecord.HandlerFunc
		align 8
dword_1002B918	dd 0FFFFFFFEh, 0	; DATA XREF: .text:10022D2Eo
		dd 0FFFFFFD0h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10022DCD
		align 8
dword_1002B938	dd 0FFFFFFFEh, 0	; DATA XREF: .text:10022DD8o
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10022E13
		align 8
stru_1002B958	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10022F7A+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10022F7A
		dd 0FFFFFFB4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10023245	; ScopeRecord.HandlerFunc
		align 8
stru_1002B978	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100236AF+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100236AF
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_100236F5	; ScopeRecord.HandlerFunc
		align 8
dword_1002B998	dd 0FFFFFFFEh, 0	; DATA XREF: .text:10023700o
		dd 0FFFFFFD8h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_1002372D
		align 8
stru_1002B9B8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10023736+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10023736
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_1002376E	; ScopeRecord.HandlerFunc
		align 8
stru_1002B9D8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100243FF+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100243FF
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10024445	; ScopeRecord.FilterFunc
		dd offset loc_10024449	; ScopeRecord.HandlerFunc
		align 8
stru_1002B9F8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100249F6+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100249F6
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10024AD9	; ScopeRecord.HandlerFunc
		align 8
dword_1002BA18	dd 0FFFFFFFEh, 0	; DATA XREF: .text:10024B76o
		dd 0FFFFFFD0h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10024C46
		align 8
dword_1002BA38	dd 0FFFFFFFEh, 0	; DATA XREF: .text:10024D8Fo
		dd 0FFFFFFD0h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10024E7A
		align 8
dword_1002BA58	dd 0FFFFFFFEh, 0	; DATA XREF: .text:10025ABAo
		dd 0FFFFFFD0h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10025B51
		align 8
stru_1002BA78	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10025E58+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10025E58
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10025E98	; ScopeRecord.HandlerFunc
		align 8
dword_1002BA98	dd 0FFFFFFFEh, 0	; DATA XREF: .text:10025EA3o
		dd 0FFFFFFD4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_10025EE2
__IMPORT_DESCRIPTOR_WS2_32 dd rva dword_1002BCC8 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aWs2_32_dll	; DLL Name
		dd rva gethostname	; Import Address Table
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_1002BB18 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva SetEndOfFile	; Import Address Table
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_1002BB04 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva RegQueryValueExA	; Import Address Table
		dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_1002BB04	dd rva word_1002BDCC	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_1002BDBE
		dd rva word_1002BDAE
		dd rva word_1002BDE0
		dd 0
;
; Import names for KERNEL32.dll
;
off_1002BB18	dd rva word_1002C4C0	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_1002C4AE
		dd rva word_1002BD0E
		dd rva word_1002BD2A
		dd rva word_1002BD3A
		dd rva word_1002C4D0
		dd rva word_1002BD5C
		dd rva word_1002BD6A
		dd rva word_1002BD76
		dd rva word_1002BD88
		dd rva word_1002BD98
		dd rva word_1002C4E2
		dd rva word_1002C4F2
		dd rva word_1002C506
		dd rva word_1002BD4C
		dd rva word_1002C0AE
		dd rva word_1002BDFE
		dd rva word_1002BE0A
		dd rva word_1002BE18
		dd rva word_1002BE24
		dd rva word_1002BE3E
		dd rva word_1002BE54
		dd rva word_1002BE66
		dd rva word_1002BE7A
		dd rva word_1002BE8C
		dd rva word_1002BE9E
		dd rva word_1002BEB2
		dd rva word_1002BED2
		dd rva word_1002BEEA
		dd rva word_1002BF02
		dd rva word_1002BF0E
		dd rva word_1002BF26
		dd rva word_1002BF40
		dd rva word_1002BF52
		dd rva word_1002BF62
		dd rva word_1002BF74
		dd rva word_1002BF80
		dd rva word_1002BF98
		dd rva word_1002BFB0
		dd rva word_1002BFBA
		dd rva word_1002BFC6
		dd rva word_1002BFDA
		dd rva word_1002BFE8
		dd rva word_1002BFF4
		dd rva word_1002C002
		dd rva word_1002C00C
		dd rva word_1002C01C
		dd rva word_1002C032
		dd rva word_1002C046
		dd rva word_1002C05C
		dd rva word_1002C06A
		dd rva word_1002C078
		dd rva word_1002C086
		dd rva word_1002C09E
		dd rva word_1002C51E
		dd rva word_1002C0BE
		dd rva word_1002C0D2
		dd rva word_1002C0E6
		dd rva word_1002C102
		dd rva word_1002C120
		dd rva word_1002C134
		dd rva word_1002C142
		dd rva word_1002C14E
		dd rva word_1002C15E
		dd rva word_1002C174
		dd rva word_1002C18A
		dd rva word_1002C198
		dd rva word_1002C1A8
		dd rva word_1002C1BE
		dd rva word_1002C1CE
		dd rva word_1002C1E0
		dd rva word_1002C1EE
		dd rva word_1002C200
		dd rva word_1002C20C
		dd rva word_1002C21A
		dd rva word_1002C22A
		dd rva word_1002C23E
		dd rva word_1002C258
		dd rva word_1002C270
		dd rva word_1002C28A
		dd rva word_1002C2A4
		dd rva word_1002C2BE
		dd rva word_1002C2CE
		dd rva word_1002C2E4
		dd rva word_1002C2F6
		dd rva word_1002C308
		dd rva word_1002C31A
		dd rva word_1002C32C
		dd rva word_1002C342
		dd rva word_1002C354
		dd rva word_1002C36A
		dd rva word_1002C37A
		dd rva word_1002C38C
		dd rva word_1002C3A8
		dd rva word_1002C3C0
		dd rva word_1002C3D2
		dd rva word_1002C3E4
		dd rva word_1002C3FE
		dd rva word_1002C410
		dd rva word_1002C420
		dd rva word_1002C432
		dd rva word_1002C442
		dd rva word_1002C452
		dd rva word_1002C45E
		dd rva word_1002C46E
		dd rva word_1002C484
		dd rva word_1002C494
		dd 0
;
; Import names for WS2_32.dll
;
dword_1002BCC8	dd 80000039h		; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WS2_32o
		dd 80000070h
		dd 80000008h
		dd 8000000Eh
		dd rva word_1002BCF4
		dd rva word_1002BCE4
		dd 0
word_1002BCE4	dw 58h			; DATA XREF: .rdata:1002BCDCo
		db 'freeaddrinfo',0
		align 4
word_1002BCF4	dw 59h			; DATA XREF: .rdata:1002BCD8o
		db 'getaddrinfo',0
aWs2_32_dll	db 'WS2_32.dll',0       ; DATA XREF: .rdata:1002BAC0o
		align 2
word_1002BD0E	dw 0B9h			; DATA XREF: .rdata:1002BB20o
		db 'ExpandEnvironmentStringsA',0
word_1002BD2A	dw 168h			; DATA XREF: .rdata:1002BB24o
		db 'GetLastError',0
		align 2
word_1002BD3A	dw 198h			; DATA XREF: .rdata:1002BB28o
		db 'GetProcAddress',0
		align 4
word_1002BD4C	dw 244h			; DATA XREF: .rdata:1002BB50o
		db 'LoadLibraryA',0
		align 4
word_1002BD5C	dw 0F0h			; DATA XREF: .rdata:1002BB30o
		db 'FreeLibrary',0
word_1002BD6A	dw 24Eh			; DATA XREF: .rdata:1002BB34o
		db 'LocalFree',0
word_1002BD76	dw 0EBh			; DATA XREF: .rdata:1002BB38o
		db 'FormatMessageA',0
		align 4
word_1002BD88	dw 1DEh			; DATA XREF: .rdata:1002BB3Co
		db 'GetVersionExA',0
word_1002BD98	dw 342h			; DATA XREF: .rdata:1002BB40o
		db 'Sleep',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:1002BAD4o
		align 2
word_1002BDAE	dw 123h			; DATA XREF: .rdata:1002BB0Co
		db 'GetUserNameA',0
		align 2
word_1002BDBE	dw 1CAh			; DATA XREF: .rdata:1002BB08o
		db 'RegCloseKey',0
word_1002BDCC	dw 1EEh			; DATA XREF: .rdata:off_1002BB04o
		db 'RegQueryValueExA',0
		align 10h
word_1002BDE0	dw 1E4h			; DATA XREF: .rdata:1002BB10o
		db 'RegOpenKeyExA',0
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:1002BAE8o
		align 2
word_1002BDFE	dw 20Bh			; DATA XREF: .rdata:1002BB58o
		db 'HeapFree',0
		align 2
word_1002BE0A	dw 20Fh			; DATA XREF: .rdata:1002BB5Co
		db 'HeapReAlloc',0
word_1002BE18	dw 205h			; DATA XREF: .rdata:1002BB60o
		db 'HeapAlloc',0
word_1002BE24	dw 1C0h			; DATA XREF: .rdata:1002BB64o
		db 'GetSystemTimeAsFileTime',0
word_1002BE3E	dw 21Dh			; DATA XREF: .rdata:1002BB68o
		db 'InterlockedExchange',0
word_1002BE54	dw 245h			; DATA XREF: .rdata:1002BB6Co
		db 'LoadLibraryExA',0
		align 2
word_1002BE66	dw 29Bh			; DATA XREF: .rdata:1002BB70o
		db 'ReadConsoleInputA',0
word_1002BE7A	dw 2EDh			; DATA XREF: .rdata:1002BB74o
		db 'SetConsoleMode',0
		align 4
word_1002BE8C	dw 12Ch			; DATA XREF: .rdata:1002BB78o
		db 'GetConsoleMode',0
		align 2
word_1002BE9E	dw 280h			; DATA XREF: .rdata:1002BB7Co
		db 'PeekConsoleInputA',0
word_1002BEB2	dw 189h			; DATA XREF: .rdata:1002BB80o
		db 'GetNumberOfConsoleInputEvents',0
word_1002BED2	dw 96h			; DATA XREF: .rdata:1002BB84o
		db 'EnterCriticalSection',0
		align 2
word_1002BEEA	dw 243h			; DATA XREF: .rdata:1002BB88o
		db 'LeaveCriticalSection',0
		align 2
word_1002BF02	dw 0CCh			; DATA XREF: .rdata:1002BB8Co
		db 'FindClose',0
word_1002BF0E	dw 0C3h			; DATA XREF: .rdata:1002BB90o
		db 'FileTimeToSystemTime',0
		align 2
word_1002BF26	dw 0C2h			; DATA XREF: .rdata:1002BB94o
		db 'FileTimeToLocalFileTime',0
word_1002BF40	dw 0D0h			; DATA XREF: .rdata:1002BB98o
		db 'FindFirstFileA',0
		align 2
word_1002BF52	dw 0D9h			; DATA XREF: .rdata:1002BB9Co
		db 'FindNextFileA',0
word_1002BF62	dw 109h			; DATA XREF: .rdata:1002BBA0o
		db 'GetCommandLineA',0
word_1002BF74	dw 0FDh			; DATA XREF: .rdata:1002BBA4o
		db 'GetCPInfo',0
word_1002BF80	dw 220h			; DATA XREF: .rdata:1002BBA8o
		db 'InterlockedIncrement',0
		align 4
word_1002BF98	dw 21Ch			; DATA XREF: .rdata:1002BBACo
		db 'InterlockedDecrement',0
		align 10h
word_1002BFB0	dw 0F6h			; DATA XREF: .rdata:1002BBB0o
		db 'GetACP',0
		align 2
word_1002BFBA	dw 18Bh			; DATA XREF: .rdata:1002BBB4o
		db 'GetOEMCP',0
		align 2
word_1002BFC6	dw 179h			; DATA XREF: .rdata:1002BBB8o
		db 'GetModuleHandleW',0
		align 2
word_1002BFDA	dw 351h			; DATA XREF: .rdata:1002BBBCo
		db 'TlsGetValue',0
word_1002BFE8	dw 34Fh			; DATA XREF: .rdata:1002BBC0o
		db 'TlsAlloc',0
		align 4
word_1002BFF4	dw 352h			; DATA XREF: .rdata:1002BBC4o
		db 'TlsSetValue',0
word_1002C002	dw 350h			; DATA XREF: .rdata:1002BBC8o
		db 'TlsFree',0
word_1002C00C	dw 316h			; DATA XREF: .rdata:1002BBCCo
		db 'SetLastError',0
		align 4
word_1002C01C	dw 13Eh			; DATA XREF: .rdata:1002BBD0o
		db 'GetCurrentThreadId',0
		align 2
word_1002C032	dw 13Dh			; DATA XREF: .rdata:1002BBD4o
		db 'GetCurrentThread',0
		align 2
word_1002C046	dw 27Eh			; DATA XREF: .rdata:1002BBD8o
		db 'OutputDebugStringA',0
		align 4
word_1002C05C	dw 209h			; DATA XREF: .rdata:1002BBDCo
		db 'HeapDestroy',0
word_1002C06A	dw 207h			; DATA XREF: .rdata:1002BBE0o
		db 'HeapCreate',0
		align 4
word_1002C078	dw 371h			; DATA XREF: .rdata:1002BBE4o
		db 'VirtualFree',0
word_1002C086	dw 7Fh			; DATA XREF: .rdata:1002BBE8o
		db 'DeleteCriticalSection',0
word_1002C09E	dw 0BEh			; DATA XREF: .rdata:1002BBECo
		db 'FatalAppExitA',0
word_1002C0AE	dw 36Eh			; DATA XREF: .rdata:1002BB54o
		db 'VirtualAlloc',0
		align 2
word_1002C0BE	dw 34Ah			; DATA XREF: .rdata:1002BBF4o
		db 'TerminateProcess',0
		align 2
word_1002C0D2	dw 13Bh			; DATA XREF: .rdata:1002BBF8o
		db 'GetCurrentProcess',0
word_1002C0E6	dw 35Bh			; DATA XREF: .rdata:1002BBFCo
		db 'UnhandledExceptionFilter',0
		align 2
word_1002C102	dw 336h			; DATA XREF: .rdata:1002BC00o
		db 'SetUnhandledExceptionFilter',0
word_1002C120	dw 176h			; DATA XREF: .rdata:1002BC04o
		db 'GetModuleHandleA',0
		align 4
word_1002C134	dw 0B6h			; DATA XREF: .rdata:1002BC08o
		db 'ExitProcess',0
word_1002C142	dw 38Fh			; DATA XREF: .rdata:1002BC0Co
		db 'WriteFile',0
word_1002C14E	dw 1B0h			; DATA XREF: .rdata:1002BC10o
		db 'GetStdHandle',0
		align 2
word_1002C15E	dw 174h			; DATA XREF: .rdata:1002BC14o
		db 'GetModuleFileNameA',0
		align 4
word_1002C174	dw 382h			; DATA XREF: .rdata:1002BC18o
		db 'WideCharToMultiByte',0
word_1002C18A	dw 31h			; DATA XREF: .rdata:1002BC1Co
		db 'CloseHandle',0
word_1002C198	dw 236h			; DATA XREF: .rdata:1002BC20o
		db 'LCMapStringA',0
		align 4
word_1002C1A8	dw 267h			; DATA XREF: .rdata:1002BC24o
		db 'MultiByteToWideChar',0
word_1002C1BE	dw 237h			; DATA XREF: .rdata:1002BC28o
		db 'LCMapStringW',0
		align 2
word_1002C1CE	dw 312h			; DATA XREF: .rdata:1002BC2Co
		db 'SetHandleCount',0
		align 10h
word_1002C1E0	dw 15Eh			; DATA XREF: .rdata:1002BC30o
		db 'GetFileType',0
word_1002C1EE	dw 1AEh			; DATA XREF: .rdata:1002BC34o
		db 'GetStartupInfoA',0
word_1002C200	dw 2C7h			; DATA XREF: .rdata:1002BC38o
		db 'RtlUnwind',0
word_1002C20C	dw 4Fh			; DATA XREF: .rdata:1002BC3Co
		db 'CreateFileA',0
word_1002C21A	dw 11Bh			; DATA XREF: .rdata:1002BC40o
		db 'GetConsoleCP',0
		align 2
word_1002C22A	dw 0E6h			; DATA XREF: .rdata:1002BC44o
		db 'FlushFileBuffers',0
		align 2
word_1002C23E	dw 0EEh			; DATA XREF: .rdata:1002BC48o
		db 'FreeEnvironmentStringsA',0
word_1002C258	dw 14Dh			; DATA XREF: .rdata:1002BC4Co
		db 'GetEnvironmentStrings',0
word_1002C270	dw 0EFh			; DATA XREF: .rdata:1002BC50o
		db 'FreeEnvironmentStringsW',0
word_1002C28A	dw 14Fh			; DATA XREF: .rdata:1002BC54o
		db 'GetEnvironmentStringsW',0
		align 4
word_1002C2A4	dw 294h			; DATA XREF: .rdata:1002BC58o
		db 'QueryPerformanceCounter',0
word_1002C2BE	dw 1D4h			; DATA XREF: .rdata:1002BC5Co
		db 'GetTickCount',0
		align 2
word_1002C2CE	dw 13Ch			; DATA XREF: .rdata:1002BC60o
		db 'GetCurrentProcessId',0
word_1002C2E4	dw 1B1h			; DATA XREF: .rdata:1002BC64o
		db 'GetStringTypeA',0
		align 2
word_1002C2F6	dw 1B4h			; DATA XREF: .rdata:1002BC68o
		db 'GetStringTypeW',0
		align 4
word_1002C308	dw 1D5h			; DATA XREF: .rdata:1002BC6Co
		db 'GetTimeFormatA',0
		align 2
word_1002C31A	dw 13Fh			; DATA XREF: .rdata:1002BC70o
		db 'GetDateFormatA',0
		align 4
word_1002C32C	dw 1D8h			; DATA XREF: .rdata:1002BC74o
		db 'GetUserDefaultLCID',0
		align 2
word_1002C342	dw 16Bh			; DATA XREF: .rdata:1002BC78o
		db 'GetLocaleInfoA',0
		align 4
word_1002C354	dw 0ACh			; DATA XREF: .rdata:1002BC7Co
		db 'EnumSystemLocalesA',0
		align 2
word_1002C36A	dw 233h			; DATA XREF: .rdata:1002BC80o
		db 'IsValidLocale',0
word_1002C37A	dw 231h			; DATA XREF: .rdata:1002BC84o
		db 'IsValidCodePage',0
word_1002C38C	dw 218h			; DATA XREF: .rdata:1002BC88o
		db 'InitializeCriticalSection',0
word_1002C3A8	dw 2DEh			; DATA XREF: .rdata:1002BC8Co
		db 'SetConsoleCtrlHandler',0
word_1002C3C0	dw 37h			; DATA XREF: .rdata:1002BC90o
		db 'CompareStringA',0
		align 2
word_1002C3D2	dw 38h			; DATA XREF: .rdata:1002BC94o
		db 'CompareStringW',0
		align 4
word_1002C3E4	dw 301h			; DATA XREF: .rdata:1002BC98o
		db 'SetEnvironmentVariableA',0
word_1002C3FE	dw 309h			; DATA XREF: .rdata:1002BC9Co
		db 'SetFilePointer',0
		align 10h
word_1002C410	dw 325h			; DATA XREF: .rdata:1002BCA0o
		db 'SetStdHandle',0
		align 10h
word_1002C420	dw 374h			; DATA XREF: .rdata:1002BCA4o
		db 'VirtualProtect',0
		align 2
word_1002C432	dw 1BBh			; DATA XREF: .rdata:1002BCA8o
		db 'GetSystemInfo',0
word_1002C442	dw 376h			; DATA XREF: .rdata:1002BCACo
		db 'VirtualQuery',0
		align 2
word_1002C452	dw 2A6h			; DATA XREF: .rdata:1002BCB0o
		db 'ReadFile',0
		align 2
word_1002C45E	dw 384h			; DATA XREF: .rdata:1002BCB4o
		db 'WriteConsoleA',0
word_1002C46E	dw 12Eh			; DATA XREF: .rdata:1002BCB8o
		db 'GetConsoleOutputCP',0
		align 4
word_1002C484	dw 38Eh			; DATA XREF: .rdata:1002BCBCo
		db 'WriteConsoleW',0
word_1002C494	dw 1D7h			; DATA XREF: .rdata:1002BCC0o
		db 'GetTimeZoneInformation',0
		align 2
word_1002C4AE	dw 16Ch			; DATA XREF: .rdata:1002BB1Co
		db 'GetLocaleInfoW',0
		align 10h
word_1002C4C0	dw 300h			; DATA XREF: .rdata:off_1002BB18o
		db 'SetEndOfFile',0
		align 10h
word_1002C4D0	dw 19Ch			; DATA XREF: .rdata:1002BB2Co
		db 'GetProcessHeap',0
		align 2
word_1002C4E2	dw 14Bh			; DATA XREF: .rdata:1002BB44o
		db 'GetDriveTypeA',0
word_1002C4F2	dw 161h			; DATA XREF: .rdata:1002BB48o
		db 'GetFullPathNameA',0
		align 2
word_1002C506	dw 139h			; DATA XREF: .rdata:1002BB4Co
		db 'GetCurrentDirectoryA',0
		align 2
word_1002C51E	dw 2FAh			; DATA XREF: .rdata:1002BBF0o
		db 'SetCurrentDirectoryA',0
		align 10h
;
; Export directory for libsasl.dll
;
		dd 0			; Characteristics
		dd 503C3F5Ah		; TimeDateStamp: Tue Aug 28 03:47:38 2012
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd rva aLibsasl_dll	; Name
		dd 1			; Base
		dd 48h			; NumberOfFunctions
		dd 48h			; NumberOfNames
		dd rva off_1002C568	; AddressOfFunctions
		dd rva off_1002C688	; AddressOfNames
		dd rva word_1002C7A8	; AddressOfNameOrdinals
;
; Export Address Table for libsasl.dll
;
off_1002C568	dd rva auxprop_plugin_info, rva	getopt,	rva getpass, rva getsubopt
					; DATA XREF: .rdata:1002C55Co
		dd rva optarg, rva opterr, rva optind, rva prop_clear
		dd rva prop_dispose, rva prop_dup, rva prop_erase, rva prop_format
		dd rva prop_get, rva prop_getnames, rva	prop_new, rva prop_request
		dd rva prop_set, rva prop_setvals, rva sasl_auxprop_add_plugin
		dd rva sasl_auxprop_getctx, rva	sasl_auxprop_request, rva sasl_auxprop_store
		dd rva sasl_canonuser_add_plugin, rva sasl_checkapop, rva sasl_checkpass
		dd rva sasl_churn, rva sasl_client_add_plugin, rva sasl_client_done
		dd rva sasl_client_init, rva sasl_client_new, rva sasl_client_plugin_info
		dd rva sasl_client_start, rva sasl_client_step,	rva sasl_config_init
		dd rva sasl_decode, rva	sasl_decode64, rva sasl_dispose
		dd rva sasl_done, rva sasl_encode, rva sasl_encode64, rva sasl_encodev
		dd rva sasl_erasebuffer, rva sasl_errdetail, rva sasl_errstring
		dd rva sasl_getprop, rva sasl_global_listmech, rva sasl_global_utils
		dd rva sasl_idle, rva sasl_listmech, rva sasl_mkchal, rva sasl_rand
		dd rva sasl_randcreate,	rva sasl_randfree, rva sasl_randseed
		dd rva sasl_server_add_plugin, rva sasl_server_done, rva sasl_server_init
		dd rva sasl_server_new,	rva sasl_server_plugin_info, rva sasl_server_start
		dd rva sasl_server_step, rva sasl_set_alloc, rva sasl_set_mutex
		dd rva sasl_set_path, rva sasl_seterror, rva sasl_setpass
		dd rva sasl_setprop, rva sasl_strlower,	rva sasl_user_exists
		dd rva sasl_utf8verify,	rva sasl_version, rva sasl_version_info
;
; Export Names Table for libsasl.dll
;
off_1002C688	dd rva aAuxprop_plugin,	rva aGetopt, rva aGetpass, rva aGetsubopt
					; DATA XREF: .rdata:1002C560o
		dd rva aOptarg,	rva aOpterr, rva aOptind, rva aProp_clear ; "auxprop_plugin_info"
		dd rva aProp_dispose, rva aProp_dup, rva aProp_erase, rva aProp_format
		dd rva aProp_get, rva aProp_getnames, rva aProp_new, rva aProp_request
		dd rva aProp_set, rva aProp_setvals, rva aSasl_auxprop_a
		dd rva aSasl_auxprop_g,	rva aSasl_auxprop_r, rva aSasl_auxprop_s
		dd rva aSasl_canonuser,	rva aSasl_checkapop, rva aSasl_checkpass
		dd rva aSasl_churn, rva	aSasl_client_ad, rva aSasl_client_do
		dd rva aSasl_client_in,	rva aSasl_client_ne, rva aSasl_client_pl
		dd rva aSasl_client_st,	rva aSasl_client__0, rva aSasl_config_in
		dd rva aSasl_decode, rva aSasl_decode64, rva aSasl_dispose
		dd rva aSasl_done, rva aSasl_encode, rva aSasl_encode64
		dd rva aSasl_encodev, rva aSasl_erasebuff, rva aSasl_errdetail
		dd rva aSasl_errstring,	rva aSasl_getprop, rva aSasl_global_li
		dd rva aSasl_global_ut,	rva aSasl_idle,	rva aSasl_listmech
		dd rva aSasl_mkchal, rva aSasl_rand, rva aSasl_randcreat
		dd rva aSasl_randfree, rva aSasl_randseed, rva aSasl_server_ad
		dd rva aSasl_server_do,	rva aSasl_server_in, rva aSasl_server_ne
		dd rva aSasl_server_pl,	rva aSasl_server_st, rva aSasl_server__0
		dd rva aSasl_set_alloc,	rva aSasl_set_mutex, rva aSasl_set_path
		dd rva aSasl_seterror, rva aSasl_setpass, rva aSasl_setprop
		dd rva aSasl_strlower, rva aSasl_user_exis, rva	aSasl_utf8verif
		dd rva aSasl_version, rva aSasl_version_i
;
; Export Ordinals Table	for libsasl.dll
;
word_1002C7A8	dw 0, 1, 2, 3, 4, 5, 6,	7, 8, 9, 0Ah, 0Bh, 0Ch,	0Dh, 0Eh
					; DATA XREF: .rdata:1002C564o
		dw 0Fh,	10h, 11h, 12h, 13h, 14h, 15h, 16h, 17h,	18h, 19h
		dw 1Ah,	1Bh, 1Ch, 1Dh, 1Eh, 1Fh, 20h, 21h, 22h,	23h, 24h
		dw 25h,	26h, 27h, 28h, 29h, 2Ah, 2Bh, 2Ch, 2Dh,	2Eh, 2Fh
		dw 30h,	31h, 32h, 33h, 34h, 35h, 36h, 37h, 38h,	39h, 3Ah
		dw 3Bh,	3Ch, 3Dh, 3Eh, 3Fh, 40h, 41h, 42h, 43h,	44h, 45h
		dw 46h,	47h
aLibsasl_dll	db 'libsasl.dll',0      ; DATA XREF: .rdata:1002C54Co
aAuxprop_plugin	db 'auxprop_plugin_info',0 ; DATA XREF: .rdata:off_1002C688o
aGetopt		db 'getopt',0           ; DATA XREF: .rdata:off_1002C688o
aGetpass	db 'getpass',0          ; DATA XREF: .rdata:off_1002C688o
aGetsubopt	db 'getsubopt',0        ; DATA XREF: .rdata:off_1002C688o
aOptarg		db 'optarg',0           ; DATA XREF: .rdata:off_1002C688o
aOpterr		db 'opterr',0           ; DATA XREF: .rdata:off_1002C688o
aOptind		db 'optind',0           ; DATA XREF: .rdata:off_1002C688o
aProp_clear	db 'prop_clear',0       ; DATA XREF: .rdata:off_1002C688o
aProp_dispose	db 'prop_dispose',0     ; DATA XREF: .rdata:off_1002C688o
aProp_dup	db 'prop_dup',0         ; DATA XREF: .rdata:off_1002C688o
aProp_erase	db 'prop_erase',0       ; DATA XREF: .rdata:off_1002C688o
aProp_format	db 'prop_format',0      ; DATA XREF: .rdata:off_1002C688o
aProp_get	db 'prop_get',0         ; DATA XREF: .rdata:off_1002C688o
aProp_getnames	db 'prop_getnames',0    ; DATA XREF: .rdata:off_1002C688o
aProp_new	db 'prop_new',0         ; DATA XREF: .rdata:off_1002C688o
aProp_request	db 'prop_request',0     ; DATA XREF: .rdata:off_1002C688o
aProp_set	db 'prop_set',0         ; DATA XREF: .rdata:off_1002C688o
aProp_setvals	db 'prop_setvals',0     ; DATA XREF: .rdata:off_1002C688o
aSasl_auxprop_a	db 'sasl_auxprop_add_plugin',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_auxprop_g	db 'sasl_auxprop_getctx',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_auxprop_r	db 'sasl_auxprop_request',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_auxprop_s	db 'sasl_auxprop_store',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_canonuser	db 'sasl_canonuser_add_plugin',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_checkapop	db 'sasl_checkapop',0   ; DATA XREF: .rdata:off_1002C688o
aSasl_checkpass	db 'sasl_checkpass',0   ; DATA XREF: .rdata:off_1002C688o
aSasl_churn	db 'sasl_churn',0       ; DATA XREF: .rdata:off_1002C688o
aSasl_client_ad	db 'sasl_client_add_plugin',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_client_do	db 'sasl_client_done',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_client_in	db 'sasl_client_init',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_client_ne	db 'sasl_client_new',0  ; DATA XREF: .rdata:off_1002C688o
aSasl_client_pl	db 'sasl_client_plugin_info',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_client_st	db 'sasl_client_start',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_client__0	db 'sasl_client_step',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_config_in	db 'sasl_config_init',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_decode	db 'sasl_decode',0      ; DATA XREF: .rdata:off_1002C688o
aSasl_decode64	db 'sasl_decode64',0    ; DATA XREF: .rdata:off_1002C688o
aSasl_dispose	db 'sasl_dispose',0     ; DATA XREF: .rdata:off_1002C688o
aSasl_done	db 'sasl_done',0        ; DATA XREF: .rdata:off_1002C688o
aSasl_encode	db 'sasl_encode',0      ; DATA XREF: .rdata:off_1002C688o
aSasl_encode64	db 'sasl_encode64',0    ; DATA XREF: .rdata:off_1002C688o
aSasl_encodev	db 'sasl_encodev',0     ; DATA XREF: .rdata:off_1002C688o
aSasl_erasebuff	db 'sasl_erasebuffer',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_errdetail	db 'sasl_errdetail',0   ; DATA XREF: .rdata:off_1002C688o
aSasl_errstring	db 'sasl_errstring',0   ; DATA XREF: .rdata:off_1002C688o
aSasl_getprop	db 'sasl_getprop',0     ; DATA XREF: .rdata:off_1002C688o
aSasl_global_li	db 'sasl_global_listmech',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_global_ut	db 'sasl_global_utils',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_idle	db 'sasl_idle',0        ; DATA XREF: .rdata:off_1002C688o
aSasl_listmech	db 'sasl_listmech',0    ; DATA XREF: .rdata:off_1002C688o
aSasl_mkchal	db 'sasl_mkchal',0      ; DATA XREF: .rdata:off_1002C688o
aSasl_rand	db 'sasl_rand',0        ; DATA XREF: .rdata:off_1002C688o
aSasl_randcreat	db 'sasl_randcreate',0  ; DATA XREF: .rdata:off_1002C688o
aSasl_randfree	db 'sasl_randfree',0    ; DATA XREF: .rdata:off_1002C688o
aSasl_randseed	db 'sasl_randseed',0    ; DATA XREF: .rdata:off_1002C688o
aSasl_server_ad	db 'sasl_server_add_plugin',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_server_do	db 'sasl_server_done',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_server_in	db 'sasl_server_init',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_server_ne	db 'sasl_server_new',0  ; DATA XREF: .rdata:off_1002C688o
aSasl_server_pl	db 'sasl_server_plugin_info',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_server_st	db 'sasl_server_start',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_server__0	db 'sasl_server_step',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_set_alloc	db 'sasl_set_alloc',0   ; DATA XREF: .rdata:off_1002C688o
aSasl_set_mutex	db 'sasl_set_mutex',0   ; DATA XREF: .rdata:off_1002C688o
aSasl_set_path	db 'sasl_set_path',0    ; DATA XREF: .rdata:off_1002C688o
aSasl_seterror	db 'sasl_seterror',0    ; DATA XREF: .rdata:off_1002C688o
aSasl_setpass	db 'sasl_setpass',0     ; DATA XREF: .rdata:off_1002C688o
aSasl_setprop	db 'sasl_setprop',0     ; DATA XREF: .rdata:off_1002C688o
aSasl_strlower	db 'sasl_strlower',0    ; DATA XREF: .rdata:off_1002C688o
aSasl_user_exis	db 'sasl_user_exists',0 ; DATA XREF: .rdata:off_1002C688o
aSasl_utf8verif	db 'sasl_utf8verify',0  ; DATA XREF: .rdata:off_1002C688o
aSasl_version	db 'sasl_version',0     ; DATA XREF: .rdata:off_1002C688o
aSasl_version_i	db 'sasl_version_info',0 ; DATA XREF: .rdata:off_1002C688o
		align 400h
_rdata		ends

; Section 3. (virtual address 0002D000)
; Virtual size			: 000031E4 (  12772.)
; Section size in file		: 00001400 (   5120.)
; Offset to raw	data for section: 0002B400
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 1002D000h
dword_1002D000	dd 3 dup(0)		; DATA XREF: .text:10002BA3o
		dd offset aInternal	; "INTERNAL"
		dd 0
		dd offset sub_10002B20
		dd offset sub_10002B50
		dd 3 dup(0)
off_1002D028	dd offset aAuxprop	; DATA XREF: sub_1000B080+E8r
					; sub_1000B080+EFo ...
					; "auxprop"
		dd offset sub_10002C80
		dd offset aAuxpropHashed ; "auxprop-hashed"
		dd offset sub_10002F00
		align 10h
off_1002D040	dd offset aCyrusSasl	; DATA XREF: sasl_version+8r
					; sasl_version_info+8r
					; "Cyrus SASL"
off_1002D044	dd offset sub_1000F5A0	; DATA XREF: sub_10001000+6r
					; sub_10001050+Ar ...
off_1002D048	dd offset sub_1000F496	; DATA XREF: sasl_set_alloc+27w
					; sub_10007350+58r
off_1002D04C	dd offset sub_1000F114	; DATA XREF: .text:1000103Ar
					; prop_request+88r ...
off_1002D050	dd offset sub_1000EE73	; DATA XREF: prop_dispose+20r
					; prop_dispose+34r ...
dword_1002D054	dd 3			; DATA XREF: sub_100055B0:loc_100055CFo
off_1002D058	dd offset sub_10006EB0	; DATA XREF: sub_10005310:loc_100053CBr
					; sasl_set_path+88w
dword_1002D05C	dd 0			; DATA XREF: sub_10005310+C2r
dword_1002D060	dd 5			; DATA XREF: sub_100055E0:loc_100055FFo
off_1002D064	dd offset sub_10006EF0	; DATA XREF: sub_10005310:loc_100053E0r
					; sasl_set_path+4Bw
dword_1002D068	dd 0			; DATA XREF: sub_10005310+D8r
off_1002D06C	dd offset sub_10004890	; DATA XREF: sasl_set_mutex+1Ew
					; sub_10007350+72r ...
off_1002D070	dd offset sub_100048A0	; DATA XREF: sasl_set_mutex+27w
					; sasl_dispose+14r ...
off_1002D074	dd offset sub_100048B0	; DATA XREF: sasl_set_mutex+2Dw
					; sasl_dispose+49r ...
off_1002D078	dd offset nullsub_1	; DATA XREF: sasl_set_mutex+33w
					; sub_10006260+46r ...
off_1002D07C	dd offset aExternal	; DATA XREF: .text:10007DB5o
					; "EXTERNAL"
		dd 0
		dd 15h,	22h, 0
		dd offset sub_10007BB0
		dd offset sub_10007BF0
		dd 5 dup(0)
		dd offset sub_10007D50
		dd 0
off_1002D0B4	dd offset aExternal	; DATA XREF: .text:1000809Bo
					; "EXTERNAL"
		dd 0
		dd 15h,	22h
		dd offset unk_1002809C
		dd 0
		dd offset sub_10007DD0
		dd offset sub_10007E30
		dd offset sub_10008020
		dd 4 dup(0)
dword_1002D0E8	dd 80h,	0Fh dup(0)	; DATA XREF: sub_100089C0+65o
byte_1002D128	db 41h			; DATA XREF: sasl_encode64+59r
					; sasl_encode64+74r ...
aBcdefghijklmno	db 'BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/??'
		db '?????????????????????????????????????????????????????????????????'
		db '?????????????????????????????????????????????????????????????????'
		db '???????',0
; Exported entry   7. optind
		public optind
optind		dd 1			; DATA XREF: getopt:loc_10009548r
					; getopt+35w ...
byte_1002D1F8	db 0FFh			; DATA XREF: sasl_decode64+9Cr
					; sasl_decode64+ADr ...
		db 3 dup(0FFh)
		dd 9 dup(0FFFFFFFFh), 3EFFFFFFh, 3FFFFFFFh, 37363534h
		dd 3B3A3938h, 0FFFF3D3Ch, 0FFFFFFFFh, 20100FFh,	6050403h
		dd 0A090807h, 0E0D0C0Bh, 1211100Fh, 16151413h, 0FF191817h
		dd 0FFFFFFFFh, 1C1B1AFFh, 201F1E1Dh, 24232221h,	28272625h
		dd 2C2B2A29h, 302F2E2Dh, 0FF333231h, 0FFFFFFFFh
; Exported entry   6. opterr
		public opterr
opterr		dd 1			; DATA XREF: getopt+C7r getopt+101r ...
		align 10h
off_1002D280	dd offset aNoplaintext	; DATA XREF: .text:1000A3F3r
					; .text:1000A3FCo
					; "noplaintext"
		dd 1
		dd offset aNoactive	; "noactive"
		dd 2
		dd offset aNodictionary	; "nodictionary"
		dd 4
		dd offset aForward_secrec ; "forward_secrecy"
		dd 8
		dd offset aNoanonymous	; "noanonymous"
		dd 10h
		dd offset aPass_credentia ; "pass_credentials"
		dd 20h
		dd offset aMutual_auth	; "mutual_auth"
		dd 40h,	2 dup(0)
___security_cookie dd 0BB40E64Eh	; DATA XREF: sub_10002BC0+3r
					; sub_10002C80+3r ...
dword_1002D2C4	dd 44BF19B1h		; DATA XREF: sub_10016319+B0r
					; sub_10019B54+2Bw ...
		align 10h
dword_1002D2D0	dd 0FFFFFFFFh		; DATA XREF: sub_100103B2+Dr
					; sub_100103B2+1Bw ...
		align 8
off_1002D2D8	dd offset dword_1002F1E0 ; DATA	XREF: .text:10010B79o
					; sub_10010B7F+52o ...
		align 10h
		dd offset dword_1002F1E0
		dd 101h
dword_1002D2E8	dd 2 dup(0)		; DATA XREF: sub_10010B7F+74o
		dd 1000h, 0
dword_1002D2F8	dd 3 dup(0)		; DATA XREF: sub_1000ED67:loc_1000ED9Eo
					; sub_1000ED67:loc_1000EDE8o ...
		dd 2, 1, 3 dup(0)
dword_1002D318	dd 3 dup(0)		; DATA XREF: getpass+Bo getpass+15o ...
		dd 2 dup(2), 7 dup(0)
dword_1002D348	dd 7Ch dup(0)		; DATA XREF: sub_10010B7F+A4o
dword_1002D538	dd 8 dup(0)		; DATA XREF: sub_10010C50+11o
					; sub_10010CAD+11o
dword_1002D558	dd 2 dup(0)		; DATA XREF: sub_10010B7F+67o
; volatile LONG	Addend
Addend		dd 0			; DATA XREF: sub_10011B99+32o
					; sub_10011D90+51o ...
		dd 16h dup(0)
		dd 10100000h, 6	dup(10101010h),	0
		dd 20200000h, 6	dup(20202020h),	31h dup(0)
		dd 62610000h, 66656463h, 6A696867h, 6E6D6C6Bh, 7271706Fh
		dd 76757473h, 7A797877h, 0
		db    0
		align 2
aAbcdefghijklmn	db 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',0
		align 4
		dd 21h dup(0)
byte_1002D780	db 0			; DATA XREF: sub_100120AC+102w
		align 4
		dd 0Fh dup(0)
		dd 10100000h, 6	dup(10101010h),	0
		dd 20200000h, 6	dup(20202020h),	23h dup(0)
byte_1002D888	db 0			; DATA XREF: sub_100120AC+11Ew
		align 4
		dd 0Fh dup(0)
		dd 63626100h, 67666564h, 6B6A6968h, 6F6E6D6Ch, 73727170h
		dd 77767574h, 7A7978h, 0
		db    0
aAbcdefghijkl_0	db 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',0
		dd 21h dup(0)
; volatile LONG	*lpAddend
lpAddend	dd offset Addend	; DATA XREF: sub_1000E615+4Dr
					; sub_1000E615+89r ...
byte_1002D98C	db 1			; DATA XREF: sub_10011EB7+E5r
		db 2, 4, 8
dword_1002D990	dd 3A4h			; DATA XREF: sub_10011EB7:loc_10011EF5r
aVyv		db '`y!',0            ; DATA XREF: sub_10011EB7+12Do
		align 10h
aJ		db '',0               ; DATA XREF: sub_10011EB7+C8o
		align 8
aBe		db '',0
		align 10h
		dd 0FCE09F81h, 0
		dd 0FC807E40h, 0
		dd 3A8h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE40h, 0
		dd 3B5h, 0A3DAA3C1h, 20h, 5 dup(0)
		dd 0FE81h, 0
		dd 0FE41h, 0
		dd 3B6h, 0A2E4A2CFh, 0A2E5001Ah, 5BA2E8h, 4 dup(0)
		dd 0FE81h, 0
		dd 0FEA17E40h, 0
		dd 551h, 0DA5EDA51h, 0DA5F0020h, 32DA6Ah, 4 dup(0)
		dd 0DED8D381h, 0F9E0h, 0FE817E31h, 0
off_1002DA80	dd offset aHH		; DATA XREF: sub_10012D67+206r
					; "	   h((((		  H"
dword_1002DA84	dd 0FFFFFFFEh		; DATA XREF: sub_1000E615+3Ar
					; sub_1000E615+5Er ...
dword_1002DA88	dd 43h,	0		; DATA XREF: sub_10012270:loc_10012374o
					; sub_100123B9:loc_1001240Bo ...
dword_1002DA90	dd 1			; DATA XREF: sub_10012507+28o
					; .text:100126D6o ...
; UINT CodePage
CodePage	dd 0			; DATA XREF: sub_10021869+48r
		dd 3 dup(0)
; LCID Locale
Locale		dd 0			; DATA XREF: sub_10021869+3Fr
		dd 10h dup(0)
		dd offset dword_1002DA88
		dd 3 dup(0)
		dd offset dword_1002DA88
		dd 3 dup(0)
		dd offset dword_1002DA88
		dd 3 dup(0)
		dd offset dword_1002DA88
		dd 3 dup(0)
		dd offset dword_1002DA88
		dd 3 dup(0)
		dd 2 dup(1), 3 dup(0)
		dd offset off_1002E120
		dd 2 dup(0)
off_1002DB58	dd offset asc_10029CF0	; DATA XREF: sub_1000E71D:loc_1000E737r
					; sub_1000E7A7:loc_1000E7C1r ...
					; "	    (((((		   H"
		dd offset dword_1002A178
		dd offset dword_1002A2F8
		dd offset off_1002DFB0
off_1002DB68	dd offset dword_1002DA90 ; DATA	XREF: sub_1000E615+2Cr
					; sub_1000E615:loc_1000E697r ...
dword_1002DB6C	dd 1			; DATA XREF: sub_1001262A+1Dw
off_1002DB70	dd offset dword_1002DA90 ; DATA	XREF: sub_10010F45+1Co
					; sub_10010F93+19o ...
		dd offset Addend
; DWORD	dwTlsIndex
dwTlsIndex	dd 0FFFFFFFFh		; DATA XREF: sub_10013548+6r
					; sub_10013548+23r ...
dword_1002DB7C	dd 0FFFFFFFFh		; DATA XREF: sub_10011438+15Fr
					; sub_10013548+18r ...
off_1002DB80	dd offset aNull		; DATA XREF: sub_10013E79:loc_100144ABr
					; sub_10013E79+A04r ...
					; "(null)"
off_1002DB84	dd offset aNull_0	; DATA XREF: sub_10013E79+519r
					; sub_1001D746+52Er ...
					; "(null)"
dword_1002DB88	dd 1			; DATA XREF: sub_10014B76:loc_10014B80r
dword_1002DB8C	dd 16h			; DATA XREF: sub_10014B76:loc_10014B9Cr
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch
dword_1002DCF0	dd 0Ch			; DATA XREF: sub_10014BF2+9o
dword_1002DCF4	dd 8			; DATA XREF: sub_10014C05+9o
dword_1002DCF8	dd 10h			; DATA XREF: .text:loc_1001533Dw
					; .text:1001539Ar
		align 10h
; LPCRITICAL_SECTION lpCriticalSection
lpCriticalSection dd 0			; DATA XREF: sub_10015128+15o
					; sub_10015128:loc_1001516Dw ...
dword_1002DD04	dd 1			; DATA XREF: sub_10015128:loc_10015133r
		dd 0
		dd 1, 3	dup(0)
		dd 1, 0
		dd 1, 3	dup(0)
		dd 1, 0
		dd 1, 0
		dd 1, 3	dup(0)
		dd 1, 3	dup(0)
		dd 1, 0
		dd 1, 0
		dd 1, 3	dup(0)
		dd 1, 0
		dd 1, 0
		dd 1, 22h dup(0)
off_1002DE20	dd offset sub_10016767	; DATA XREF: sub_100136A7+1AFEo
					; sub_100136A7+1B1Eo ...
		align 8
dword_1002DE28	dd 2			; DATA XREF: sub_100167DD:loc_100167F1r
					; .text:1001696Cr
; LPCVOID lpBuffer
lpBuffer	dd offset aR6002FloatingP ; DATA XREF: sub_100167DD+113r
					; sub_100167DD+15Dr ...
					; "R6002\r\n- floating point support not l"...
		dd 8
		dd offset aR6008NotEnough ; "R6008\r\n-	not enough space for argumen"...
		dd 9
		dd offset aR6009NotEnough ; "R6009\r\n-	not enough space for environ"...
		dd 0Ah
		dd offset aThisApplicatio ; "\r\nThis application has requested	the "...
		dd 10h
		dd offset aR6016NotEnough ; "R6016\r\n-	not enough space for thread "...
		dd 11h
		dd offset aR6017Unexpecte ; "R6017\r\n-	unexpected multithread lock "...
		dd 12h
		dd offset aR6018Unexpecte ; "R6018\r\n-	unexpected heap	error\r\n"
		dd 13h
		dd offset aR6019UnableToO ; "R6019\r\n-	unable to open console devic"...
		dd 18h
		dd offset aR6024NotEnough ; "R6024\r\n-	not enough space for _onexit"...
		dd 19h
		dd offset aR6025PureVirtu ; "R6025\r\n-	pure virtual function call\r"...
		dd 1Ah
		dd offset aR6026NotEnough ; "R6026\r\n-	not enough space for stdio i"...
		dd 1Bh
		dd offset aR6027NotEnough ; "R6027\r\n-	not enough space for lowio i"...
		dd 1Ch
		dd offset aR6028UnableToI ; "R6028\r\n-	unable to initialize heap\r\"...
		dd 1Eh
		dd offset aR6030CrtNotIni ; "R6030\r\n-	CRT not	initialized\r\n"
		dd 1Fh
		dd offset aR6031AttemptTo ; "R6031\r\n-	Attempt	to initialize the CR"...
		dd 20h
		dd offset aR6032NotEnough ; "R6032\r\n-	not enough space for locale "...
		dd 21h
		dd offset aR6033AttemptTo ; "R6033\r\n-	Attempt	to use MSIL code fro"...
		dd 22h
		dd offset aR6034AnApplica ; "R6034\r\nAn application has made an att"...
		dd 78h
		dd offset aDomainError	; "DOMAIN error\r\n"
		dd 79h
		dd offset aSingError	; "SING	error\r\n"
		dd 7Ah
		dd offset aTlossError	; "TLOSS error\r\n"
		dd 0FCh
		dd offset asc_1002921C	; "\r\n"
		dd 0FFh
		dd offset aRuntimeError	; "runtime error "
dword_1002DEE0	dd 0FFFFFFFFh, 0A80h, 0Ah dup(0) ; DATA	XREF: sub_1000FE75:loc_1000FF28o
					; sub_1000FE75:loc_1000FF70o ...
; HANDLE hConsoleInput
hConsoleInput	dd 0FFFFFFFEh		; DATA XREF: sub_1001048C:loc_100104B3r
					; sub_1001048C:loc_100104C1r ...
; HANDLE hObject
hObject		dd 0FFFFFFFEh		; DATA XREF: sub_10018253+19w
					; sub_10018272r ...
		align 10h
dword_1002DF20	dd 0C0000005h, 0Bh, 0	; DATA XREF: sub_100136E4+2Do
					; sub_10013842+98o ...
		dd 0C000001Dh, 4, 0
		dd 0C0000096h, 4, 0
		dd 0C000008Dh, 8, 0
		dd 0C000008Eh, 8, 0
		dd 0C000008Fh, 8, 0
		dd 0C0000090h, 8, 0
		dd 0C0000091h, 8, 0
		dd 0C0000092h, 8, 0
		dd 0C0000093h, 8, 0
dword_1002DF98	dd 3			; DATA XREF: sub_1001944B+92r
					; sub_1001944B+B1r ...
dword_1002DF9C	dd 7			; DATA XREF: sub_1001944B+98r
					; sub_1001944B+B7r ...
dword_1002DFA0	dd 78h			; DATA XREF: .text:1001FF9Cr
					; .text:1001FFB3r
dword_1002DFA4	dd 0Ah			; DATA XREF: .text:1001941Er
					; sub_1001944B+1Ar ...
off_1002DFA8	dd offset asc_10029CF0	; DATA XREF: sub_1001262A+41w
					; "	    (((((		   H"
off_1002DFAC	dd offset word_10029EF2	; DATA XREF: .text:10019DE7r
					; sub_100217DF+28r ...
off_1002DFB0	dd offset aSun_0	; DATA XREF: sub_10012270+DCo
					; sub_1001A990+Fo ...
					; "Sun"
		dd offset aMon_0	; "Mon"
		dd offset aTue_0	; "Tue"
		dd offset aWed_0	; "Wed"
		dd offset aThu_0	; "Thu"
		dd offset aFri_0	; "Fri"
		dd offset aSat_0	; "Sat"
		dd offset aSunday_0	; "Sunday"
		dd offset aMonday_0	; "Monday"
		dd offset aTuesday_0	; "Tuesday"
		dd offset aWednesday_0	; "Wednesday"
		dd offset aThursday_0	; "Thursday"
		dd offset aFriday_0	; "Friday"
		dd offset aSaturday_0	; "Saturday"
		dd offset aJan_0	; "Jan"
		dd offset aFeb_0	; "Feb"
		dd offset aMar_0	; "Mar"
		dd offset aApr_0	; "Apr"
		dd offset aMay_0	; "May"
		dd offset aJun_0	; "Jun"
		dd offset aJul_0	; "Jul"
		dd offset aAug_0	; "Aug"
		dd offset aSep_0	; "Sep"
		dd offset aOct_0	; "Oct"
		dd offset aNov_0	; "Nov"
		dd offset aDec_0	; "Dec"
		dd offset aJanuary_0	; "January"
		dd offset aFebruary_0	; "February"
		dd offset aMarch_0	; "March"
		dd offset aApril_0	; "April"
		dd offset aMay_0	; "May"
		dd offset aJune_0	; "June"
		dd offset aJuly_0	; "July"
		dd offset aAugust_0	; "August"
		dd offset aSeptember_0	; "September"
		dd offset aOctober_0	; "October"
		dd offset aNovember_0	; "November"
		dd offset aDecember_0	; "December"
		dd offset aAm_0		; "AM"
		dd offset aPm_0		; "PM"
		dd offset aMmDdYy_0	; "MM/dd/yy"
		dd offset aDdddMmmmDdYy_0 ; "dddd, MMMM	dd, yyyy"
		dd offset aHhMmSs	; "HH:mm:ss"
		dd 409h, 1, 0
		dd offset aSun		; "Sun"
		dd offset aMon		; "Mon"
		dd offset aTue		; "Tue"
		dd offset aWed		; "Wed"
		dd offset aThu		; "Thu"
		dd offset aFri		; "Fri"
		dd offset aSat		; "Sat"
		dd offset aSunday	; "Sunday"
		dd offset aMonday	; "Monday"
		dd offset aTuesday	; "Tuesday"
		dd offset aWednesday	; "Wednesday"
		dd offset aThursday	; "Thursday"
		dd offset aFriday	; "Friday"
		dd offset aSaturday	; "Saturday"
		dd offset aJan		; "Jan"
		dd offset aFeb		; "Feb"
		dd offset aMar		; "Mar"
		dd offset aApr		; "Apr"
		dd offset aMay		; "May"
		dd offset aJun		; "Jun"
		dd offset aJul		; "Jul"
		dd offset aAug		; "Aug"
		dd offset aSep		; "Sep"
		dd offset aOct		; "Oct"
		dd offset aNov		; "Nov"
		dd offset aDec		; "Dec"
		dd offset aJanuary	; "January"
		dd offset aFebruary	; "February"
		dd offset aMarch	; "March"
		dd offset aApril	; "April"
		dd offset aMay		; "May"
		dd offset aJune		; "June"
		dd offset aJuly		; "July"
		dd offset aAugust	; "August"
		dd offset aSeptember	; "September"
		dd offset aOctober	; "October"
		dd offset aNovember	; "November"
		dd offset aDecember	; "December"
		dd offset aAm		; "AM"
		dd offset aPm		; "PM"
		dd offset aMmDdYy	; "MM/dd/yy"
		dd offset aDdddMmmmDdYyyy ; "dddd, MMMM	dd, yyyy"
		dd offset dword_1002A2F8+100h
off_1002E114	dd offset off_1002DFB0	; DATA XREF: sub_1001262A+29w
dword_1002E118	dd 2Eh			; DATA XREF: .data:off_1002E120o
dword_1002E11C	dd 2Eh			; DATA XREF: .data:off_1002E150o
off_1002E120	dd offset dword_1002E118 ; DATA	XREF: sub_10012270+17o
					; sub_1001AA3E+Fr ...
off_1002E124	dd offset dword_1002EF50 ; DATA	XREF: sub_1001AA3E+21r
					; sub_1001AAA7+161r
off_1002E128	dd offset dword_1002EF50 ; DATA	XREF: sub_1001AA3E+33r
					; sub_1001AAA7+169r
off_1002E12C	dd offset dword_1002EF50 ; DATA	XREF: sub_1001ACCD+14r
off_1002E130	dd offset dword_1002EF50 ; DATA	XREF: sub_1001ACCD+26r
off_1002E134	dd offset dword_1002EF50 ; DATA	XREF: sub_1001ACCD+38r
off_1002E138	dd offset dword_1002EF50 ; DATA	XREF: sub_1001ACCD+4Ar
off_1002E13C	dd offset dword_1002EF50 ; DATA	XREF: sub_1001ACCD+5Cr
off_1002E140	dd offset dword_1002EF50 ; DATA	XREF: sub_1001ACCD+6Er
off_1002E144	dd offset dword_1002EF50 ; DATA	XREF: sub_1001ACCD+80r
		dd 2 dup(7F7F7F7Fh)
off_1002E150	dd offset dword_1002E11C ; DATA	XREF: sub_1001AA3E+45r
					; sub_1001AAA7+171r
off_1002E154	dd offset dword_1002EF54 ; DATA	XREF: sub_1001AA3E+57r
					; sub_1001AAA7+179r
off_1002E158	dd offset dword_1002EF54 ; DATA	XREF: sub_1001ACCD+92r
off_1002E15C	dd offset dword_1002EF54 ; DATA	XREF: sub_1001ACCD+A4r
off_1002E160	dd offset dword_1002EF54 ; DATA	XREF: sub_1001ACCD+B6r
off_1002E164	dd offset dword_1002EF54 ; DATA	XREF: sub_1001ACCD+C8r
off_1002E168	dd offset dword_1002EF54 ; DATA	XREF: sub_1001ACCD+DAr
off_1002E16C	dd offset dword_1002EF54 ; DATA	XREF: sub_1001ACCD+ECr
off_1002E170	dd offset off_1002E120	; DATA XREF: sub_1001262A+35w
					; .text:loc_1001C6B8r
dword_1002E174	dd 1			; DATA XREF: sub_1001262A+4Dw
					; .text:1001D4EFr
		dd 2Eh,	1
off_1002E180	dd offset sub_100242BE	; DATA XREF: sub_1001D2A2:loc_1001D2A8o
		dd offset sub_100242BE
		dd offset sub_100242BE
		dd offset sub_100242BE
		dd offset sub_100242BE
		dd offset sub_100242BE
off_1002E198	dd offset sub_100242BE	; DATA XREF: sub_10013E79+7BFr
					; sub_1001D746+7D4r ...
		dd offset sub_100242BE
off_1002E1A0	dd offset sub_100242BE	; DATA XREF: sub_10013E79+814r
					; sub_1001D746+829r ...
off_1002E1A4	dd offset sub_100242BE	; DATA XREF: sub_10013E79+7EFr
					; sub_1001D746+804r ...
		align 10h
byte_1002E1B0	db 0			; DATA XREF: sub_100218DF:loc_10021C3Er
					; sub_100218DF+36Dr
		align 4
		dd 2Fh dup(0)
		dd 8 dup(1010101h), 4 dup(2020202h), 2 dup(3030303h), 2	dup(0)
dword_1002E2B0	dd 19930520h, 3	dup(0)	; DATA XREF: .text:10022C3Eo
					; sub_10022C45+2o
dword_1002E2C0	dd 2			; DATA XREF: sub_10022C67+15r
					; sub_10022C67+52r ...
dword_1002E2C4	dd 0FFFFFFFFh		; DATA XREF: sub_10022F7A+9Aw
					; sub_100232E0+17Fw ...
dword_1002E2C8	dd 0			; DATA XREF: sub_100232E0+173w
					; sub_100234D7:loc_1002363Fr
dword_1002E2CC	dd 0			; DATA XREF: sub_100232E0+179w
					; sub_100234D7+1BEr
dword_1002E2D0	dd 0FFFFFFFFh		; DATA XREF: sub_10022F7A+94w
					; sub_100232E0:loc_100234CCw ...
dword_1002E2D4	dd 0			; DATA XREF: sub_100232E0+18Bw
					; sub_100232E0+1CBw ...
dword_1002E2D8	dd 0			; DATA XREF: sub_100232E0+191w
					; sub_100232E0+1B9w ...
		align 10h
dword_1002E2E0	dd 7080h		; DATA XREF: .text:10022F73w
					; sub_10022F7A+24Dw ...
dword_1002E2E4	dd 1			; DATA XREF: .text:10022F55w
					; sub_10022F7A+255w ...
dword_1002E2E8	dd 0FFFFF1F0h		; DATA XREF: .text:10022F64w
					; sub_10022F7A+25Dw ...
		align 10h
dword_1002E2F0	dd 545350h, 0Fh	dup(0)	; DATA XREF: .data:lpMultiByteStro
dword_1002E330	dd 544450h, 0Fh	dup(0)	; DATA XREF: .data:off_1002E374o
; LPSTR	lpMultiByteStr
lpMultiByteStr	dd offset dword_1002E2F0 ; DATA	XREF: sub_1001BC6C+31Er
					; sub_10022F7A+2Bo ...
; LPSTR	off_1002E374
off_1002E374	dd offset dword_1002E330 ; DATA	XREF: sub_10022F7A+216r
					; sub_10022F7A+232r ...
dword_1002E378	dd 0FFFFFFFFh		; DATA XREF: sub_100232E0+10Ar
		dd 1Eh,	3Bh, 5Ah, 78h, 97h, 0B5h, 0D4h,	0F3h, 111h, 130h
		dd 14Eh
dword_1002E3A8	dd 16Dh			; DATA XREF: sub_100232E0+54r
					; sub_100232E0+145r
dword_1002E3AC	dd 0FFFFFFFFh		; DATA XREF: sub_10019201+6Fo
					; sub_100232E0+FFr
		dd 1Eh,	3Ah, 59h, 77h, 96h, 0B4h, 0D3h,	0F2h, 110h, 12Fh
		dd 14Dh, 16Ch
dword_1002E3E0	dd 3			; DATA XREF: sub_100242C7+15r
					; sub_100242C7:loc_100242FFr ...
		align 20h
; LPVOID dword_1002E400
dword_1002E400	dd ?			; DATA XREF: sasl_auxprop_add_plugin+88r
					; sasl_auxprop_add_plugin+93w ...
; LPVOID dword_1002E404
dword_1002E404	dd ?			; DATA XREF: sub_10002440:loc_1000258Cr
					; sub_10002810+1r ...
; LPVOID dword_1002E408
dword_1002E408	dd ?			; DATA XREF: .text:1000305Cr
					; sub_100030E0+1Cr ...
dword_1002E40C	dd ?			; DATA XREF: sub_100030E0r
					; sub_100030E0+14w ...
dword_1002E410	dd 20h dup(?)		; DATA XREF: .text:100051D5o
					; .text:100051ECo ...
; Exported entry  47. sasl_global_utils
		public sasl_global_utils
; LPVOID sasl_global_utils
sasl_global_utils dd ?			; DATA XREF: sasl_auxprop_add_plugin+9r
					; sub_10001930+1Br ...
; LPVOID dword_1002E494
dword_1002E494	dd ?			; DATA XREF: sub_10005930+C8r
					; sub_10005930+DBw ...
dword_1002E498	dd ?			; DATA XREF: sasl_dispose+Er
					; sasl_dispose+3Fr ...
dword_1002E49C	dd ?			; DATA XREF: sasl_client_done+7r
					; sasl_client_done+2Dw	...
dword_1002E4A0	dd ?			; DATA XREF: sasl_client_doner
					; sasl_client_done:loc_100030C3r ...
dword_1002E4A4	dd ?			; DATA XREF: sasl_client_done+28w
					; sasl_client_init+109w ...
dword_1002E4A8	dd ?			; DATA XREF: sasl_idle+8r sasl_done+Fw ...
dword_1002E4AC	dd ?			; DATA XREF: sasl_client_init+17w
					; sasl_set_allocr ...
; LPVOID dword_1002E4B0
dword_1002E4B0	dd ?			; DATA XREF: .text:loc_1000522Er
					; sasl_set_path:loc_10005EA7r ...
; LPVOID dword_1002E4B4
dword_1002E4B4	dd ?			; DATA XREF: .text:loc_1000524Er
					; sasl_set_path+1Ar ...
dword_1002E4B8	dd ?			; DATA XREF: sasl_config_init+29w
					; sasl_config_init:loc_10007A69r ...
; LPVOID dword_1002E4BC
dword_1002E4BC	dd ?			; DATA XREF: sasl_config_init+191r
					; sasl_config_init+1ACw ...
dword_1002E4C0	dd 3Fh dup(?)		; DATA XREF: getpass+22o getpass+6Ao
		db 2 dup(?)
word_1002E5BE	dw ?			; DATA XREF: getpass+36o
; Exported entry   5. optarg
		public optarg
optarg		dd ?			; DATA XREF: getopt:loc_1000956Cw
					; getopt:loc_10009616w	...
dword_1002E5C4	dd ?			; DATA XREF: getoptr getopt+18w ...
dword_1002E5C8	dd ?			; DATA XREF: .text:100097F0r
					; sasl_setpass+37r ...
; LPVOID dword_1002E5CC
dword_1002E5CC	dd ?			; DATA XREF: sasl_setpass+43r
					; .text:10009D28r ...
; LPVOID dword_1002E5D0
dword_1002E5D0	dd ?			; DATA XREF: sub_1000C8E0:loc_1000C945r
					; sub_1000C8E0+74w ...
		align 8
dword_1002E5D8	dd ?			; DATA XREF: sub_1001016B+20r
					; sub_100101B0+29w
dword_1002E5DC	dd ?			; DATA XREF: sub_1001016B+29r
					; sub_100101B0+2Ew
; volatile LONG	Target
Target		dd ?			; DATA XREF: sub_10010263+8w
					; sub_10010272+8r ...
dword_1002E5E4	dd ?			; DATA XREF: sub_10013CD1:loc_10013D03w
					; sub_10017C64+283w ...
dword_1002E5E8	dd ?			; DATA XREF: sub_10011438+EFw
					; sub_10011438+107r ...
dword_1002E5EC	dd ?			; DATA XREF: DllEntryPoint-208w
					; DllEntryPoint-4Cr
; LPVOID dword_1002E5F0
dword_1002E5F0	dd ?			; DATA XREF: sub_10011438+BCw
					; sub_100195CB:loc_100195E3r ...
		align 8
dword_1002E5F8	dd ?			; DATA XREF: sub_100204A8+19r
					; sub_100204A8:loc_100204C8r ...
dword_1002E5FC	dd ?			; DATA XREF: sub_100167DD+4Cr
					; sub_10016988+19r ...
dword_1002E600	dd ?			; DATA XREF: sub_10011E3B+14w
					; sub_10011E3B+1Fw ...
word_1002E604	dw ?			; DATA XREF: sub_100120AC+E7w
		align 10h
dword_1002E610	dd ?			; DATA XREF: sub_100120AC+C3w
dword_1002E614	dd ?			; DATA XREF: sub_100120AC+CBw
dword_1002E618	dd ?			; DATA XREF: sub_100120AC+D3w
dword_1002E61C	dd ?			; DATA XREF: sub_1000E71D+5r
					; sub_1000E7A7+5r ...
dword_1002E620	dd 6 dup(?)		; DATA XREF: .text:100134F8o
dword_1002E638	dd ?			; DATA XREF: sub_1001262A+8w
dword_1002E63C	dd ?			; DATA XREF: sub_1001262A+11w
dword_1002E640	dd ?			; DATA XREF: sub_10013A07+2Cw
					; sub_10013A07+58r ...
; LPVOID lpTlsValue
lpTlsValue	dd ?			; DATA XREF: sub_10013660+10r
					; sub_10013A07+39w ...
dword_1002E648	dd ?			; DATA XREF: sub_10011438+165r
					; .text:10013695r ...
dword_1002E64C	dd ?			; DATA XREF: sub_100136A7+Br
					; sub_10013A07+4Dw ...
dword_1002E650	dd 2 dup(?)		; DATA XREF: sub_10013CD1+43o
; HANDLE hHeap
hHeap		dd ?			; DATA XREF: sub_1000EE73+62r
					; sub_1000F114+D7r ...
		align 10h
dword_1002E660	dd 54h dup(?)		; DATA XREF: sub_10015128+6o
dword_1002E7B0	dd ?			; DATA XREF: sub_100153A7+26w
					; sub_10015425+21Er ...
		align 8
dword_1002E7B8	dd ?			; DATA XREF: sub_10016319+91w
					; .rdata:ExceptionInfoo
dword_1002E7BC	dd ?			; DATA XREF: sub_10016319+9Bw
		dd ?
dword_1002E7C4	dd ?			; DATA XREF: sub_10016319+8Cw
		dd 10h dup(?)
dword_1002E808	dd ?			; DATA XREF: sub_10016319+7Dw
					; .rdata:ExceptionInfoo
		dd 22h dup(?)
word_1002E894	dw ?			; DATA XREF: sub_10016319+51w
		align 4
word_1002E898	dw ?			; DATA XREF: sub_10016319+4Aw
		align 4
word_1002E89C	dw ?			; DATA XREF: sub_10016319+43w
		align 10h
word_1002E8A0	dw ?			; DATA XREF: sub_10016319+3Cw
		align 4
dword_1002E8A4	dd ?			; DATA XREF: sub_10016319+28w
dword_1002E8A8	dd ?			; DATA XREF: sub_10016319+22w
dword_1002E8AC	dd ?			; DATA XREF: sub_10016319+1Cw
dword_1002E8B0	dd ?			; DATA XREF: sub_10016319+16w
dword_1002E8B4	dd ?			; DATA XREF: sub_10016319+10w
dword_1002E8B8	dd ?			; DATA XREF: sub_10016319+Bw
dword_1002E8BC	dd ?			; DATA XREF: sub_10016319+62w
dword_1002E8C0	dd ?			; DATA XREF: sub_10016319+6Aw
					; sub_10016319+87r
word_1002E8C4	dw ?			; DATA XREF: sub_10016319+35w
		align 4
dword_1002E8C8	dd ?			; DATA XREF: sub_10016319+59w
dword_1002E8CC	dd ?			; DATA XREF: sub_10016319+72w
word_1002E8D0	dw ?			; DATA XREF: sub_10016319+2Ew
		align 4
		dd 80h dup(?)
dword_1002EAD4	dd ?			; DATA XREF: sub_100163FB+8w
					; sub_1001640A+Dr ...
dword_1002EAD8	dd ?			; DATA XREF: sub_1000F114+158r
					; sub_1000F114+1C1r ...
dword_1002EADC	dd ?			; DATA XREF: sub_10021F64+19Er
dword_1002EAE0	dd ?			; DATA XREF: .text:100113F5w
					; sub_10011438+66w ...
dword_1002EAE4	dd ?			; DATA XREF: .text:10011404w
					; sub_10011438+8Dw ...
dword_1002EAE8	dd ?			; DATA XREF: .text:10011413w
					; sub_10011438+7Bw
dword_1002EAEC	dd ?			; DATA XREF: .text:10011422w
					; sub_10011438+81w ...
dword_1002EAF0	dd ?			; DATA XREF: .text:10011431w
					; sub_10011438+87w
dword_1002EAF4	dd ?			; DATA XREF: sub_1001992E+D8w
dword_1002EAF8	dd ?			; DATA XREF: sub_1001992E+DDw
		align 10h
; LPVOID dword_1002EB00
dword_1002EB00	dd ?			; DATA XREF: sub_1000F68E+Dr
					; sub_1000F68E+30r ...
dword_1002EB04	dd ?			; DATA XREF: sub_100195CB+7Ew
					; sub_10020AAD+64r ...
dword_1002EB08	dd ?			; DATA XREF: sub_1000F68E+1Fr
					; sub_10016AC9+Cr ...
		align 10h
dword_1002EB10	dd ?			; DATA XREF: .text:100196D9w
					; sub_1001992E+3Dw
		align 8
byte_1002EB18	db ?			; DATA XREF: sub_10010C30+5r
					; sub_10016683+2Cw
		align 4
dword_1002EB1C	dd ?			; DATA XREF: sub_10011438+119r
					; sub_10016683+23w
dword_1002EB20	dd ?			; DATA XREF: sub_10016683+1Br
					; sub_10016683+A0w
		align 8
dword_1002EB28	dd 6 dup(?)		; DATA XREF: sub_100167DD+70o
		db ?
; CHAR Filename[260]
Filename	db 104h	dup(?)		; DATA XREF: sub_100167DD+9Ao
byte_1002EC45	db ?			; DATA XREF: sub_100167DD:loc_1001686Cw
		align 4
		dd 7Dh dup(?)
dword_1002EE3C	dd ?			; DATA XREF: sub_100170CC+11r
					; sub_100170CC+34w ...
; CHAR byte_1002EE40[260]
byte_1002EE40	db 104h	dup(?)		; DATA XREF: sub_1001992E+25o
byte_1002EF44	db ?			; DATA XREF: sub_1001992E+2Cw
		align 4
dword_1002EF48	dd ?			; DATA XREF: sub_10019A1D+5r
					; sub_10019A1D+26w ...
dword_1002EF4C	dd ?			; DATA XREF: sub_10019BEB+11r
					; sub_10019BEB+39w ...
dword_1002EF50	dd ?			; DATA XREF: .data:off_1002E124o
					; .data:off_1002E128o ...
dword_1002EF54	dd ?			; DATA XREF: .data:off_1002E154o
					; .data:off_1002E158o ...
dword_1002EF58	dd ?			; DATA XREF: .text:1001D0C6r
					; .text:1001D0DEr ...
dword_1002EF5C	dd ?			; DATA XREF: .text:1001D2D6r
					; .text:1001D2E5w ...
dword_1002EF60	dd ?			; DATA XREF: sub_1001F904+8w
					; sub_1001F928+11r ...
dword_1002EF64	dd ?			; DATA XREF: .text:1001FDCDr
					; sub_1001FDF9+Bw
dword_1002EF68	dd ?			; DATA XREF: sub_1001FE0A+8w
					; sub_1001FE28+1Do ...
dword_1002EF6C	dd ?			; DATA XREF: sub_1001FE0A+Dw
					; sub_1001FE28:loc_1001FE61o ...
dword_1002EF70	dd ?			; DATA XREF: sub_1001FE0A+12w
					; sub_1001FEFAr ...
dword_1002EF74	dd ?			; DATA XREF: sub_1001FE0A+17w
					; .text:loc_100200B6r ...
dword_1002EF78	dd ?			; DATA XREF: .text:loc_10020020r
					; .text:1002003Dw
dword_1002EF7C	dd ?			; DATA XREF: sub_10020306+1Er
					; sub_10020306+64w ...
dword_1002EF80	dd ?			; DATA XREF: sub_10020306+79w
					; sub_10020306:loc_10020458r
dword_1002EF84	dd ?			; DATA XREF: sub_10020306+86w
					; sub_10020306+16Br
dword_1002EF88	dd ?			; DATA XREF: sub_10020306+D4w
					; sub_10020306:loc_100203DFr
dword_1002EF8C	dd ?			; DATA XREF: sub_10020306+BCw
					; sub_10020306+E5r ...
dword_1002EF90	dd ?			; DATA XREF: sub_1002052C+24r
					; sub_1002052C+43w ...
dword_1002EF94	dd ?			; DATA XREF: sub_10017C64+8r
; struct _TIME_ZONE_INFORMATION	TimeZoneInformation
TimeZoneInformation _TIME_ZONE_INFORMATION <?> ; DATA XREF: sub_10022F7A:loc_100230E9o
					; sub_10022F7A+18Br ...
dword_1002F044	dd ?			; DATA XREF: sub_10022F7A+8Bw
					; sub_10022F7A+185w ...
; LPVOID dword_1002F048
dword_1002F048	dd ?			; DATA XREF: sub_10022F7A+C0r
					; sub_10022F7A+118w ...
dword_1002F04C	dd ?			; DATA XREF: sub_100236AF+Er
					; sub_100236AF+21r ...
dword_1002F050	dd ?			; DATA XREF: sub_100245D7:loc_100245F9r
					; sub_100245D7+47w ...
dword_1002F054	dd ?			; DATA XREF: sub_10024E84+11r
					; sub_10024E84+32w ...
dword_1002F058	dd ?			; DATA XREF: .text:10024D45o
					; sub_10024D54:loc_10024D80r
dword_1002F05C	dd ?			; DATA XREF: getsubopt+Fw
					; getsubopt:loc_1000CDFAw ...
dword_1002F060	dd ?			; DATA XREF: sub_10009FE0+95w
					; sub_1000A0F0:loc_1000A108r ...
dword_1002F064	dd ?			; DATA XREF: sub_10009FE0+9Fw
					; sub_1000A0F0+1r ...
		align 10h
dword_1002F070	dd ?			; DATA XREF: .text:10003050o
					; sasl_client_init+6Ew	...
dword_1002F074	dd ?			; DATA XREF: sasl_client_init+74w
; UINT uNumber
uNumber		dd ?			; DATA XREF: sub_10016F3F+50r
					; sub_100179DC+3Cw ...
		align 10h
dword_1002F080	dd ?			; DATA XREF: sub_1000FE75+98o
					; sub_1000FE75+DFo ...
		dd 3Fh dup(?)
dword_1002F180	dd ?			; DATA XREF: sub_1000F68E+5r
					; sub_10017C16+43o ...
dword_1002F184	dd ?			; DATA XREF: sub_100165FB+3Bw
					; sub_10016683+44r
dword_1002F188	dd ?			; DATA XREF: sub_100165FB+40w
					; sub_10016683+37r
dword_1002F18C	dd ?			; DATA XREF: sub_10012246r
					; sub_10012246+11w ...
dword_1002F190	dd ?			; DATA XREF: sub_100165FB+5r
					; sub_100165FB+Eo ...
dword_1002F194	dd ?			; DATA XREF: sub_100195CB+84w
					; sub_10020AAD+10Ar
		dd ?
dword_1002F19C	dd ?			; DATA XREF: sub_100165FB+5Fr
					; sub_100165FB+69o ...
		dd ?
dword_1002F1A4	dd ?			; DATA XREF: sub_100150AE+Cr
					; sub_100150AE+45r ...
; LPVOID lpMem
lpMem		dd ?			; DATA XREF: sub_100150AE+1Cr
					; sub_100150AE:loc_100150FCr ...
dword_1002F1AC	dd ?			; DATA XREF: sub_1000F114+6Cr
					; sub_1000F378+72r ...
dword_1002F1B0	dd ?			; DATA XREF: sub_100153A7+34w
					; sub_10015425+2FEw ...
dword_1002F1B4	dd ?			; DATA XREF: sub_100153A7+41w
					; sub_1001573Br ...
dword_1002F1B8	dd ?			; DATA XREF: sub_10015425+22Br
					; sub_10015425+24Br ...
dword_1002F1BC	dd ?			; DATA XREF: sub_1000EE73+13r
					; sub_1000F114:loc_1000F148r ...
dword_1002F1C0	dd ?			; DATA XREF: sub_10014D30+EAr
					; sub_10014D30+F3o ...
dword_1002F1C4	dd ?			; DATA XREF: .text:10012264r
dword_1002F1C8	dd ?			; DATA XREF: .text:1001226Ao
dword_1002F1CC	dd ?			; DATA XREF: sub_1000E0F0+1Er
					; sub_1000E2B0+28r ...
dword_1002F1D0	dd ?			; DATA XREF: sub_10011438+B2w
					; sub_1001992E+38r
dword_1002F1D4	dd ?			; DATA XREF: DllEntryPoint:loc_10011631r
					; DllEntryPoint:loc_10011770r ...
; LPVOID dword_1002F1D8
dword_1002F1D8	dd ?			; DATA XREF: sub_1001086A+30r
					; sub_1001086A+53r ...
		align 10h
dword_1002F1E0	dd 400h	dup(?)		; DATA XREF: .data:off_1002D2D8o
					; .data:1002D2E0o
dword_100301E0	dd ?			; DATA XREF: sub_1001086A+24r
					; sub_10010B7Fr ...
		align 1000h
_data		ends


		end DllEntryPoint
