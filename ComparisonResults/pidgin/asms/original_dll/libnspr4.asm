;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	BD9789799AA464038339E018B69FF723
; Input	CRC32 :	7CF9B4F0

; File Name   :	C:\compspace\compare\pidgin\dlls\original\libnspr4.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	10000000
; Section 1. (virtual address 00001000)
; Virtual size			: 000265A4 ( 157092.)
; Section size in file		: 00026600 ( 157184.)
; Offset to raw	data for section: 00000400
; Flags	60000020: Text Executable Readable
; Alignment	: default
; Exported entry 411. libVersionPoint

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 10001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public libVersionPoint
libVersionPoint	proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, offset dword_10030000
		retn
libVersionPoint	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001010	proc near		; CODE XREF: PR_AllocFileDesc+1p
					; sub_10014A90+34p ...
		push	esi
		push	edi
		xor	edi, edi
		cmp	dword_100309D8,	edi
		jnz	short loc_10001060
		mov	eax, dword_100309C8
		push	eax
		call	PR_StackPop
		add	esp, 4
		cmp	eax, edi
		jz	loc_100010BE
		sub	eax, dword_10030040
		mov	esi, eax

loc_1000103A:				; CODE XREF: sub_10001010+A9j
					; sub_10001010+CDj
		mov	ecx, [esi+4]
		push	60h		; Size
		push	edi		; Val
		push	ecx		; Dst
		mov	[esi+10h], edi
		mov	[esi+0Ch], edi
		mov	[esi+8], edi
		mov	[esi+14h], edi
		call	memset
		add	esp, 0Ch
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10001060:				; CODE XREF: sub_10001010+Aj
					; sub_10001010+A7j
		cmp	Memory,	edi
		jz	short loc_100010BE
		mov	ecx, dword_100309C4
		cmp	ecx, dword_100309D4
		jl	short loc_100010BE
		mov	edx, lpTlsValue
		push	edx
		call	PR_Lock
		mov	esi, Memory
		add	esp, 4
		cmp	esi, edi
		jz	short loc_100010A7
		mov	eax, [esi+0Ch]
		dec	dword_100309C4
		mov	Memory,	eax
		cmp	eax, edi
		jnz	short loc_100010A7
		mov	dword_100309D0,	edi

loc_100010A7:				; CODE XREF: sub_10001010+7Dj
					; sub_10001010+8Fj
		mov	eax, lpTlsValue
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	esi, edi
		jz	short loc_10001060
		jmp	loc_1000103A
; ---------------------------------------------------------------------------

loc_100010BE:				; CODE XREF: sub_10001010+1Cj
					; sub_10001010+56j ...
		push	18h		; Size
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		cmp	esi, edi
		jz	short loc_100010EC
		push	60h		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[esi+4], eax
		cmp	eax, edi
		jnz	loc_1000103A
		push	esi		; Memory
		call	PR_Free
		add	esp, 4

loc_100010EC:				; CODE XREF: sub_10001010+BCj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10001010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_FreeFileDesc_0(void *Memory)
PR_FreeFileDesc_0 proc near		; CODE XREF: PR_FreeFileDescj
					; sub_10014BD0+7p ...

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi+4]
		mov	dword ptr [esi], offset	dword_100300D8
		mov	dword ptr [esi+14h], 0FFFFFFFFh
		mov	dword ptr [eax], 11111111h
		mov	eax, dword_100309D8
		test	eax, eax
		jnz	short loc_10001139
		mov	ecx, dword_100309C8
		add	esi, 0Ch
		push	esi
		push	ecx
		call	PR_StackPush
		add	esp, 8
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001139:				; CODE XREF: PR_FreeFileDesc_0+22j
		cmp	dword_100309C4,	eax
		jle	short loc_10001155
		mov	edx, [esi+4]
		push	edx		; Memory
		call	PR_Free
		push	esi		; Memory
		call	PR_Free
		add	esp, 8
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001155:				; CODE XREF: PR_FreeFileDesc_0+3Fj
		mov	eax, lpTlsValue
		push	eax
		call	PR_Lock
		mov	eax, dword_100309D0
		add	esp, 4
		mov	dword_100309D0,	esi
		test	eax, eax
		jnz	short loc_1000117A
		mov	Memory,	esi
		jmp	short loc_1000117D
; ---------------------------------------------------------------------------

loc_1000117A:				; CODE XREF: PR_FreeFileDesc_0+70j
		mov	[eax+0Ch], esi

loc_1000117D:				; CODE XREF: PR_FreeFileDesc_0+78j
		mov	ecx, lpTlsValue
		inc	dword_100309C4
		mov	dword ptr [esi+0Ch], 0
		pop	esi
		mov	[esp+Memory], ecx ; lpTlsValue
		jmp	PR_Unlock
PR_FreeFileDesc_0 endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 326. PR_SetFDCacheSize

; =============== S U B	R O U T	I N E =======================================


		public PR_SetFDCacheSize
PR_SetFDCacheSize proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		xor	ebx, ebx
		push	esi
		push	edi
		cmp	dword_10031520,	ebx
		jnz	short loc_100011B2
		call	PR_Init

loc_100011B2:				; CODE XREF: PR_SetFDCacheSize+Bj
		mov	edi, [esp+0Ch+arg_0]
		mov	esi, [esp+0Ch+arg_4]
		cmp	edi, esi
		jle	short loc_100011C0
		mov	edi, esi

loc_100011C0:				; CODE XREF: PR_SetFDCacheSize+1Cj
		mov	eax, lpTlsValue
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	esi, ebx
		jnz	short loc_1000123B
		cmp	dword_100309D8,	ebx
		jz	loc_100012AA
		mov	eax, Memory
		mov	dword_100309D8,	ebx
		cmp	eax, ebx
		jz	short loc_10001215
		lea	ecx, [ecx+0]

loc_100011F0:				; CODE XREF: PR_SetFDCacheSize+73j
		mov	edx, dword_100309C8
		mov	ecx, [eax+0Ch]
		add	eax, 0Ch
		push	eax
		push	edx
		mov	Memory,	ecx
		call	PR_StackPush
		mov	eax, Memory
		add	esp, 8
		cmp	eax, ebx
		jnz	short loc_100011F0

loc_10001215:				; CODE XREF: PR_SetFDCacheSize+4Bj
		mov	eax, lpTlsValue
		push	eax		; lpTlsValue
		mov	dword_100309D4,	ebx
		mov	dword_100309D0,	ebx
		mov	dword_100309C4,	ebx
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000123B:				; CODE XREF: PR_SetFDCacheSize+30j
		xor	eax, eax
		cmp	dword_100309D8,	ebx
		mov	dword_100309D4,	edi
		setz	al
		mov	dword_100309D8,	esi
		cmp	eax, ebx
		jz	short loc_100012AA
		mov	eax, dword_100309C8
		push	eax
		call	PR_StackPop
		add	esp, 4
		cmp	eax, ebx
		jz	short loc_100012AA
		jmp	short loc_10001270
; ---------------------------------------------------------------------------
		align 10h

loc_10001270:				; CODE XREF: PR_SetFDCacheSize+C8j
					; PR_SetFDCacheSize+108j
		sub	eax, dword_10030040
		cmp	dword_100309D0,	ebx
		jnz	short loc_10001283
		mov	dword_100309D0,	eax

loc_10001283:				; CODE XREF: PR_SetFDCacheSize+DCj
		mov	ecx, Memory
		mov	edx, dword_100309C8
		inc	dword_100309C4
		push	edx
		mov	[eax+0Ch], ecx
		mov	Memory,	eax
		call	PR_StackPop
		add	esp, 4
		cmp	eax, ebx
		jnz	short loc_10001270

loc_100012AA:				; CODE XREF: PR_SetFDCacheSize+38j
					; PR_SetFDCacheSize+B4j ...
		mov	eax, lpTlsValue
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
PR_SetFDCacheSize endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100012C0	proc near		; CODE XREF: sub_10014A90+Bp
		push	ebx
		push	esi
		push	edi
		push	offset aNspr_fd_cache_ ; "NSPR_FD_CACHE_SIZE_LOW"
		call	PR_GetEnv
		push	offset aNspr_fd_cach_0 ; "NSPR_FD_CACHE_SIZE_HIGH"
		mov	esi, eax
		call	PR_GetEnv
		mov	ebx, ds:atoi
		mov	edi, eax
		xor	eax, eax
		xor	ecx, ecx
		add	esp, 8
		mov	dword_100309D4,	eax
		mov	dword_100309D8,	ecx
		test	esi, esi
		jz	short loc_10001308
		push	esi		; Str
		call	ebx ; atoi
		mov	ecx, dword_100309D8
		add	esp, 4
		mov	dword_100309D4,	eax

loc_10001308:				; CODE XREF: sub_100012C0+35j
		test	edi, edi
		jz	short loc_1000131F
		push	edi		; Str
		call	ebx ; atoi
		mov	ecx, eax
		mov	eax, dword_100309D4
		add	esp, 4
		mov	dword_100309D8,	ecx

loc_1000131F:				; CODE XREF: sub_100012C0+4Aj
		pop	edi
		pop	esi
		pop	ebx
		test	eax, eax
		jns	short loc_1000132A
		xor	eax, eax
		jmp	short loc_10001334
; ---------------------------------------------------------------------------

loc_1000132A:				; CODE XREF: sub_100012C0+64j
		cmp	eax, 40h
		jle	short loc_10001339
		mov	eax, 40h

loc_10001334:				; CODE XREF: sub_100012C0+68j
		mov	dword_100309D4,	eax

loc_10001339:				; CODE XREF: sub_100012C0+6Dj
		cmp	ecx, 40h
		jle	short loc_10001349
		mov	ecx, 40h
		mov	dword_100309D8,	ecx

loc_10001349:				; CODE XREF: sub_100012C0+7Cj
		cmp	ecx, eax
		jge	short loc_10001352
		mov	dword_100309D8,	eax

loc_10001352:				; CODE XREF: sub_100012C0+8Bj
		call	PR_NewLock
		push	offset aFd	; "FD"
		mov	lpTlsValue, eax
		call	PR_CreateStack
		add	esp, 4
		mov	dword_100309C8,	eax
		retn
sub_100012C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001370	proc near		; CODE XREF: sub_10014BD0+6Cj
		push	ebx
		push	esi
		mov	esi, Memory
		xor	ebx, ebx
		cmp	esi, ebx
		jz	short loc_1000139F
		push	edi
		nop

loc_10001380:				; CODE XREF: sub_10001370+2Cj
		mov	eax, [esi+4]
		mov	edi, [esi+0Ch]
		push	eax		; Memory
		call	PR_Free
		push	esi		; Memory
		mov	[esi+4], ebx
		call	PR_Free
		add	esp, 8
		mov	esi, edi
		cmp	edi, ebx
		jnz	short loc_10001380
		pop	edi

loc_1000139F:				; CODE XREF: sub_10001370+Cj
		mov	ecx, lpTlsValue
		push	ecx		; Memory
		mov	Memory,	ebx
		mov	dword_100309D0,	ebx
		mov	dword_100309C4,	ebx
		call	PR_DestroyLock
		mov	edx, dword_100309C8
		push	edx
		mov	lpTlsValue, ebx
		call	PR_StackPop
		add	esp, 8
		cmp	eax, ebx
		jz	short loc_1000140D
		jmp	short loc_100013E0
; ---------------------------------------------------------------------------
		align 10h

loc_100013E0:				; CODE XREF: sub_10001370+66j
					; sub_10001370+9Bj
		mov	esi, eax
		sub	esi, dword_10030040
		mov	eax, [esi+4]
		push	eax		; Memory
		call	PR_Free
		push	esi		; Memory
		mov	[esi+4], ebx
		call	PR_Free
		mov	ecx, dword_100309C8
		push	ecx
		call	PR_StackPop
		add	esp, 0Ch
		cmp	eax, ebx
		jnz	short loc_100013E0

loc_1000140D:				; CODE XREF: sub_10001370+64j
		mov	edx, dword_100309C8
		push	edx		; Memory
		call	PR_DestroyStack
		add	esp, 4
		pop	esi
		mov	dword_100309C8,	ebx
		pop	ebx
		retn
sub_10001370	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10001430:				; DATA XREF: sub_100015F0+46o
		mov	eax, dword_10032B20
		push	esi
		push	eax
		call	PR_Lock

loc_1000143C:				; CODE XREF: .text:100014BCj
		add	esp, 4
		nop

loc_10001440:				; CODE XREF: .text:1000145Dj
					; .text:100014AEj ...
		cmp	dword_10032B30,	offset dword_10032B30
		jnz	short loc_1000145F
		mov	ecx, dword_10032B24
		push	0FFFFFFFFh
		push	ecx
		call	PR_WaitCondVar
		add	esp, 8
		jmp	short loc_10001440
; ---------------------------------------------------------------------------

loc_1000145F:				; CODE XREF: .text:1000144Aj
		call	PR_IntervalNow
		mov	esi, dword_10032B30
		mov	ecx, [esi-10h]
		mov	edx, eax
		sub	edx, ecx
		js	short loc_100014C1
		mov	eax, [esi+4]
		mov	ecx, [esi]
		mov	[eax], ecx
		mov	edx, [esi]
		mov	eax, [esi+4]
		mov	[edx+4], eax
		mov	[esi], esi
		mov	[esi+4], esi
		mov	ecx, dword_10032B20
		push	ecx
		call	PR_Unlock
		mov	edx, [esi-8]
		mov	eax, [esi-0Ch]
		push	edx
		call	eax
		mov	ecx, dword_10032B20
		push	ecx
		call	PR_Lock
		add	esp, 0Ch
		dec	dword ptr [esi-4]
		jnz	short loc_10001440
		mov	edx, dword_10032B28
		push	edx
		call	PR_NotifyAllCondVar
		jmp	loc_1000143C
; ---------------------------------------------------------------------------

loc_100014C1:				; CODE XREF: .text:10001471j
		sub	ecx, eax
		mov	eax, dword_10032B24
		push	ecx
		push	eax
		call	PR_WaitCondVar
		add	esp, 8
		jmp	loc_10001440
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100014E0	proc near		; CODE XREF: PR_AddWaitFileDesc+13Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	18h		; Size
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10001503
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001503:				; CODE XREF: sub_100014E0+Fj
		call	PR_IntervalNow
		add	eax, [esp+4+arg_0]
		mov	ecx, [esp+4+arg_8]
		mov	[esi], eax
		mov	eax, [esp+4+arg_4]
		mov	[esi+4], eax
		mov	[esi+8], ecx
		mov	dword ptr [esi+0Ch], 2
		mov	edx, dword_10032B20
		push	edx
		call	PR_Lock
		mov	eax, dword_10032B34
		add	esp, 4
		mov	ecx, eax
		cmp	[eax+4], eax
		jz	short loc_10001551
		mov	edx, [esi]
		push	edi

loc_10001541:				; CODE XREF: sub_100014E0+6Ej
		mov	edi, edx
		sub	edi, [eax-10h]
		jns	short loc_10001550
		mov	eax, [eax+4]
		cmp	[eax+4], ecx
		jnz	short loc_10001541

loc_10001550:				; CODE XREF: sub_100014E0+66j
		pop	edi

loc_10001551:				; CODE XREF: sub_100014E0+5Cj
		mov	edx, [eax]
		lea	ecx, [esi+10h]
		mov	[ecx], edx
		mov	[esi+14h], eax
		mov	edx, [eax]
		mov	[edx+4], ecx
		mov	[eax], ecx
		mov	eax, dword_10032B24
		push	eax
		call	PR_NotifyCondVar
		mov	ecx, dword_10032B20
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
sub_100014E0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001580	proc near		; CODE XREF: PR_CancelWaitGroup+240p
					; PR_AddWaitFileDesc+212p ...
		mov	eax, dword_10032B20
		push	edi
		push	eax
		xor	edi, edi
		call	PR_Lock
		dec	dword ptr [esi+0Ch]
		mov	ecx, [esi+14h]
		mov	edx, [esi+0Ch]
		lea	eax, [esi+10h]
		add	esp, 4
		cmp	ecx, eax
		jnz	short loc_100015BF
		cmp	edx, 1
		jnz	short loc_100015D0

loc_100015A6:				; CODE XREF: sub_10001580+3Bj
		mov	ecx, dword_10032B28
		push	0FFFFFFFFh
		push	ecx
		call	PR_WaitCondVar
		add	esp, 8
		cmp	dword ptr [esi+0Ch], 1
		jz	short loc_100015A6
		jmp	short loc_100015D0
; ---------------------------------------------------------------------------

loc_100015BF:				; CODE XREF: sub_10001580+1Fj
		mov	edx, [eax]
		mov	[ecx], edx
		mov	eax, [eax]
		mov	ecx, [esi+14h]
		mov	[eax+4], ecx
		mov	edi, 1

loc_100015D0:				; CODE XREF: sub_10001580+24j
					; sub_10001580+3Dj
		mov	edx, dword_10032B20
		push	edx		; lpTlsValue
		call	PR_Unlock
		push	esi		; Memory
		call	PR_Free
		add	esp, 8
		mov	eax, edi
		pop	edi
		retn
sub_10001580	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100015F0	proc near		; CODE XREF: sub_100016A0p
		call	PR_NewLock
		mov	dword_10032B20,	eax
		test	eax, eax
		jz	short loc_10001658
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	dword_10032B24,	eax
		test	eax, eax
		jz	short loc_10001658
		mov	eax, dword_10032B20
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	dword_10032B28,	eax
		test	eax, eax
		jz	short loc_1000166A
		push	0
		push	1
		push	0
		push	1
		push	0
		mov	eax, offset dword_10032B30
		push	offset loc_10001430
		push	1
		mov	dword_10032B30,	eax
		mov	dword_10032B34,	eax
		call	PR_CreateThread
		add	esp, 1Ch
		mov	dword_10032B2C,	eax
		test	eax, eax
		jnz	short loc_10001692

loc_10001658:				; CODE XREF: sub_100015F0+Cj
					; sub_100015F0+1Ej
		mov	eax, dword_10032B28
		test	eax, eax
		jz	short loc_1000166A
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_1000166A:				; CODE XREF: sub_100015F0+35j
					; sub_100015F0+6Fj
		mov	eax, dword_10032B24
		test	eax, eax
		jz	short loc_1000167C
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_1000167C:				; CODE XREF: sub_100015F0+81j
		mov	eax, dword_10032B20
		test	eax, eax
		jz	short loc_1000168E
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4

loc_1000168E:				; CODE XREF: sub_100015F0+93j
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10001692:				; CODE XREF: sub_100015F0+66j
		xor	eax, eax
		retn
sub_100015F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100016A0	proc near		; CODE XREF: PR_Init_0+148p
		call	sub_100015F0
		call	PR_NewLock
		push	0Ch		; SizeOfElements
		push	1		; NumOfElements
		mov	dword_100309E0,	eax
		call	PR_Calloc
		push	64h
		mov	dword_100309E4,	eax
		mov	[eax], eax
		mov	[eax+4], eax
		call	PR_MillisecondsToInterval
		add	esp, 0Ch
		mov	dword_100309DC,	eax
		retn
sub_100016A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100016E0	proc near		; CODE XREF: sub_10001780+5Dp
					; PR_AddWaitFileDesc+98p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+8]
		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		mov	eax, ecx
		shr	eax, 6
		push	esi
		xor	eax, ecx
		push	edi
		movzx	edi, word ptr [ebp+2]
		shr	eax, 4
		xor	edx, edx
		div	edi
		mov	ebx, 0Bh
		xor	ecx, ecx
		mov	esi, edx
		lea	ebx, [ebx+0]

loc_10001710:				; CODE XREF: sub_100016E0+67j
		mov	eax, [ebp+esi*4+4]
		mov	edx, [esp+10h+arg_0]
		dec	ebx
		test	eax, eax
		jz	short loc_10001753
		cmp	edx, eax
		jz	short loc_10001762
		test	ecx, ecx
		jnz	short loc_1000173C
		mov	ecx, [edx+8]
		mov	eax, ecx
		shr	eax, 6
		xor	eax, ecx
		lea	ecx, [edi-2]
		shr	eax, 4
		xor	edx, edx
		div	ecx
		lea	ecx, [edx+1]

loc_1000173C:				; CODE XREF: sub_100016E0+43j
		lea	eax, [ecx+esi]
		xor	edx, edx
		div	edi
		mov	esi, edx
		test	ebx, ebx
		jg	short loc_10001710
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10001753:				; CODE XREF: sub_100016E0+3Bj
		pop	edi
		mov	[ebp+esi*4+4], edx
		inc	word ptr [ebp+0]
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10001762:				; CODE XREF: sub_100016E0+3Fj
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 2
		pop	ebx
		retn
sub_100016E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001780	proc near		; CODE XREF: PR_AddWaitFileDesc+A8p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	ebx
		push	ebp
		mov	ebp, [eax+3Ch]
		movzx	eax, word ptr [ebp+2]
		push	esi
		push	edi
		xor	ebx, ebx

loc_10001791:				; CODE XREF: sub_10001780+1Ej
		cmp	ds:dword_10028454[ebx*4], eax
		jz	short loc_100017A0
		inc	ebx
		cmp	ebx, 0Eh
		jb	short loc_10001791

loc_100017A0:				; CODE XREF: sub_10001780+18j
					; sub_10001780+9Bj
		cmp	ebx, 0Dh
		jnb	short loc_1000181D
		mov	edi, ds:dword_10028458[ebx*4]
		inc	ebx
		lea	ecx, ds:8[edi*4]
		push	ecx		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000181D
		mov	dx, [esi]
		mov	[esi+2], di
		lea	edi, [ebp+4]
		cmp	dx, [ebp+0]
		jnb	short loc_100017F5

loc_100017D5:				; CODE XREF: sub_10001780+73j
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_100017E9
		push	esi
		push	eax
		call	sub_100016E0
		add	esp, 8
		test	eax, eax
		jnz	short loc_10001812

loc_100017E9:				; CODE XREF: sub_10001780+59j
		mov	ax, [esi]
		add	edi, 4
		cmp	ax, [ebp+0]
		jb	short loc_100017D5

loc_100017F5:				; CODE XREF: sub_10001780+53j
		mov	edi, [esp+10h+arg_0]
		mov	ecx, [edi+3Ch]
		push	ecx		; Memory
		call	PR_Free
		inc	dword ptr [edi+30h]
		add	esp, 4
		mov	[edi+3Ch], esi
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10001812:				; CODE XREF: sub_10001780+67j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		jmp	short loc_100017A0
; ---------------------------------------------------------------------------

loc_1000181D:				; CODE XREF: sub_10001780+23j
					; sub_10001780+43j
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 2
		pop	ebx
		retn
sub_10001780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001840	proc near		; CODE XREF: sub_10001930+16p
					; sub_10001980+Cp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	edx, [eax+3Ch]
		mov	eax, [esp+8+arg_0]
		mov	ecx, eax
		push	ebx
		shr	ecx, 6
		xor	ecx, eax
		push	ebp
		movzx	ebp, word ptr [edx+2]
		shr	ecx, 4
		mov	[esp+10h+var_8], edx
		xor	edx, edx
		mov	eax, ecx
		div	ebp
		push	esi
		push	edi
		mov	ebx, 0Bh
		mov	[esp+18h+var_4], ebp
		xor	esi, esi
		mov	edi, edx

loc_10001873:				; CODE XREF: sub_10001840+6Aj
		mov	edx, [esp+18h+var_8]
		lea	eax, [edx+edi*4+4]
		mov	edx, [eax]
		dec	ebx
		test	edx, edx
		jz	short loc_1000188F
		mov	ebp, [esp+18h+arg_0]
		cmp	[edx+8], ebp
		jz	short loc_100018AE
		mov	ebp, [esp+18h+var_4]

loc_1000188F:				; CODE XREF: sub_10001840+40j
		test	esi, esi
		jnz	short loc_1000189F
		lea	esi, [ebp-2]
		mov	eax, ecx
		xor	edx, edx
		div	esi
		lea	esi, [edx+1]

loc_1000189F:				; CODE XREF: sub_10001840+51j
		lea	eax, [esi+edi]
		xor	edx, edx
		div	ebp
		mov	edi, edx
		test	ebx, ebx
		jg	short loc_10001873
		xor	eax, eax

loc_100018AE:				; CODE XREF: sub_10001840+49j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_10001840	endp

; ---------------------------------------------------------------------------
		align 10h

loc_100018C0:				; DATA XREF: PR_AddWaitFileDesc+134o
		mov	eax, [esp+4]
		push	esi
		mov	esi, [eax+20h]
		push	1
		push	0FFFFFFFEh
		lea	ecx, [esi+0Ch]
		push	ecx
		call	ds:InterlockedCompareExchange
		cmp	eax, 1
		jnz	short loc_10001925
		mov	edx, [esi+8]
		push	0
		push	edx
		call	PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jz	short loc_10001925
		mov	ecx, [eax+4]
		mov	dword ptr [ecx], 55555555h
		mov	edx, [eax+4]
		mov	eax, [edx+28h]
		push	eax
		call	closesocket
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10001925
		call	WSAGetLastError
		mov	ecx, ds:_iob
		push	eax
		add	ecx, 40h
		push	offset Format	; "closesocket failed: %d\n"
		push	ecx
		call	ds:fprintf
		add	esp, 0Ch

loc_10001925:				; CODE XREF: .text:100018D9j
					; .text:100018EBj ...
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001930	proc near		; CODE XREF: PR_AddWaitFileDesc+10Ep
					; PR_AddWaitFileDesc+14Fp ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, eax
		lea	ebx, [edi+40h]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esp+0Ch+arg_0]
		push	eax
		mov	eax, edi
		call	sub_10001840
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_10001965
		mov	edi, [edi+3Ch]
		mov	ecx, 0FFFFh
		add	[edi], cx
		mov	dword ptr [esi], 0

loc_10001965:				; CODE XREF: sub_10001930+22j
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, esi
		neg	eax
		sbb	eax, eax
		pop	edi
		neg	eax
		pop	esi
		dec	eax
		pop	ebx
		retn
sub_10001930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10001980	proc near		; CODE XREF: sub_1001D3C0+221p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	eax
		mov	eax, esi
		call	sub_10001840
		add	esp, 4
		test	eax, eax
		jz	short loc_100019A9
		mov	ecx, [esi+3Ch]
		mov	edx, 0FFFFh
		add	[ecx], dx
		mov	dword ptr [eax], 0

loc_100019A9:				; CODE XREF: sub_10001980+16j
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		pop	esi
		retn
sub_10001980	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  44. PR_CancelWaitFileDesc

; =============== S U B	R O U T	I N E =======================================


		public PR_CancelWaitFileDesc
PR_CancelWaitFileDesc proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		xor	ebx, ebx
		test	esi, esi
		jnz	short loc_100019EC
		mov	eax, dword_100309E4
		mov	esi, [eax+8]
		test	esi, esi
		jnz	short loc_100019EC
		push	esi
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100019EC:				; CODE XREF: PR_CancelWaitFileDesc+Aj
					; PR_CancelWaitFileDesc+16j
		mov	ecx, [esi+14h]
		push	edi
		push	ecx
		call	PR_Lock
		add	esp, 4
		cmp	[esi+10h], ebx
		jz	short loc_10001A22
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	ebx, 0FFFFFFFFh

loc_10001A10:				; CODE XREF: PR_CancelWaitFileDesc+77j
					; PR_CancelWaitFileDesc+C3j
		mov	edx, [esi+14h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10001A22:				; CODE XREF: PR_CancelWaitFileDesc+3Cj
		mov	edi, [esp+0Ch+arg_4]
		push	1		; Comperand
		push	0FFFFFFFDh	; Exchange
		lea	edx, [edi+0Ch]
		push	edx		; Destination
		call	ds:InterlockedCompareExchange
		cmp	eax, 1
		jnz	short loc_10001A10
		mov	eax, [edi+8]
		push	0
		push	eax
		call	PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_10001A6B
		push	eax
		push	0FFFFE89Dh
		call	PR_SetError
		mov	edx, [esi+14h]
		add	esp, 8
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10001A6B:				; CODE XREF: PR_CancelWaitFileDesc+89j
		mov	ecx, [eax+4]
		mov	dword ptr [ecx], 55555555h
		mov	edx, [eax+4]
		mov	eax, [edx+28h]
		push	eax		; s
		call	closesocket
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10001A10
		call	WSAGetLastError
		mov	ecx, ds:_iob
		push	eax
		add	ecx, 40h
		push	offset Format	; "closesocket failed: %d\n"
		push	ecx		; File
		call	ds:fprintf
		add	esp, 0Ch
		push	1		; Code
		call	ds:exit
PR_CancelWaitFileDesc endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  45. PR_CancelWaitGroup

; =============== S U B	R O U T	I N E =======================================


		public PR_CancelWaitGroup
PR_CancelWaitGroup proc	near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		push	edi
		mov	[esp+0Ch+var_4], 0
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	edi, [esp+0Ch+arg_0]
		mov	esi, eax
		test	edi, edi
		jnz	short loc_10001AEA
		mov	eax, dword_100309E4
		mov	edi, [eax+8]
		test	edi, edi
		jnz	short loc_10001AEA
		push	edi
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10001AEA:				; CODE XREF: PR_CancelWaitGroup+18j
					; PR_CancelWaitGroup+24j
		mov	ecx, [edi+14h]
		push	ebx
		push	ecx
		call	PR_Lock
		mov	eax, [edi+10h]
		mov	ebx, 2
		add	esp, 4
		cmp	eax, ebx
		jz	short loc_10001B48
		test	eax, eax
		jnz	short loc_10001B0E
		mov	dword ptr [edi+10h], 1

loc_10001B0E:				; CODE XREF: PR_CancelWaitGroup+55j
		xor	edx, edx
		cmp	dx, [edi+2Ch]
		jnz	short loc_10001B1B
		mov	[edi+10h], ebx
		jmp	short loc_10001B30
; ---------------------------------------------------------------------------

loc_10001B1B:				; CODE XREF: PR_CancelWaitGroup+64j
		mov	eax, [edi+20h]
		push	eax
		call	PR_NotifyAllCondVar
		mov	ecx, [edi+1Ch]
		push	ecx
		call	PR_NotifyAllCondVar
		add	esp, 8

loc_10001B30:				; CODE XREF: PR_CancelWaitGroup+69j
		cmp	[edi+10h], ebx
		jz	short loc_10001B48

loc_10001B35:				; CODE XREF: PR_CancelWaitGroup+96j
		mov	edx, [edi+24h]
		push	0FFFFFFFFh
		push	edx
		call	PR_WaitCondVar
		add	esp, 8
		cmp	[edi+10h], ebx
		jnz	short loc_10001B35

loc_10001B48:				; CODE XREF: PR_CancelWaitGroup+51j
					; PR_CancelWaitGroup+83j
		push	ebp
		lea	eax, [edi+40h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [edi+3Ch]
		movzx	ecx, word ptr [eax+2]
		lea	ebp, [eax+ecx*4+4]
		lea	ebx, [eax+4]
		cmp	ebx, ebp
		jnb	short loc_10001BBB

loc_10001B65:				; CODE XREF: PR_CancelWaitGroup+109j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_10001BB4
		push	1		; Comperand
		push	0FFFFFFFDh	; Exchange
		add	eax, 0Ch
		push	eax		; Destination
		call	ds:InterlockedCompareExchange
		cmp	eax, 1
		jnz	short loc_10001BB4
		mov	edx, [ebx]
		mov	eax, [edx+8]
		push	0
		push	eax
		call	PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jz	loc_10001C98
		mov	ecx, [eax+4]
		mov	dword ptr [ecx], 55555555h
		mov	edx, [eax+4]
		mov	eax, [edx+28h]
		push	eax		; s
		call	closesocket
		cmp	eax, 0FFFFFFFFh
		jz	loc_10001CA9

loc_10001BB4:				; CODE XREF: PR_CancelWaitGroup+B9j
					; PR_CancelWaitGroup+CCj
		add	ebx, 4
		cmp	ebx, ebp
		jb	short loc_10001B65

loc_10001BBB:				; CODE XREF: PR_CancelWaitGroup+B3j
		mov	edx, [edi+3Ch]
		cmp	word ptr [edx],	0
		jbe	loc_10001C7D
		lea	ebp, [esi+70h]
		lea	ebx, [esi+40h]
		mov	edi, edi

loc_10001BD0:				; CODE XREF: PR_CancelWaitGroup+1C7j
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	dword ptr [esi], 6
		lea	eax, [edi+58h]
		mov	[ebp+0], eax
		mov	eax, [edi+5Ch]
		mov	[esi+74h], eax
		mov	ecx, [edi+5Ch]
		mov	[ecx], ebp
		mov	[edi+5Ch], ebp
		test	byte ptr [esi+90h], 80h
		jnz	short loc_10001C32
		mov	edx, [esi+9Ch]
		mov	eax, [edx+24h]
		add	eax, 18h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		push	0FFFFFFFFh
		push	esi
		mov	dword ptr [esi+58h], 2
		call	_PR_AddSleepQ
		mov	ecx, [esi+9Ch]
		mov	edx, [ecx+24h]
		add	esp, 8
		add	edx, 18h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_10001C32:				; CODE XREF: PR_CancelWaitGroup+148j
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		lea	eax, [edi+40h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [edi+14h]
		push	eax		; lpTlsValue
		call	PR_Unlock
		push	0FFFFFFFFh
		push	esi
		call	sub_1001DB80
		mov	dword ptr [esi], 2
		mov	ecx, [edi+14h]
		push	ecx
		call	PR_Lock
		add	esp, 10h
		lea	eax, [edi+40h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [edi+3Ch]
		cmp	word ptr [edx],	0
		ja	loc_10001BD0

loc_10001C7D:				; CODE XREF: PR_CancelWaitGroup+112j
		mov	eax, [edi+8]
		lea	ecx, [edi+8]
		cmp	eax, ecx
		jnz	short loc_10001CCF
		push	0
		push	0FFFFE8D4h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_10001D02
; ---------------------------------------------------------------------------

loc_10001C98:				; CODE XREF: PR_CancelWaitGroup+E0j
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		jmp	short loc_10001D02
; ---------------------------------------------------------------------------

loc_10001CA9:				; CODE XREF: PR_CancelWaitGroup+FEj
		call	WSAGetLastError
		mov	ecx, ds:_iob
		push	eax
		add	ecx, 40h
		push	offset Format	; "closesocket failed: %d\n"
		push	ecx		; File
		call	ds:fprintf
		add	esp, 0Ch
		push	1		; Code
		call	ds:exit
; ---------------------------------------------------------------------------

loc_10001CCF:				; CODE XREF: PR_CancelWaitGroup+1D5j
		mov	ecx, [eax+4]
		mov	edx, [eax]
		mov	[ecx], edx
		mov	ecx, [eax]
		mov	edx, [eax+4]
		mov	[ecx+4], edx
		lea	ebx, [eax-18h]
		mov	[eax], eax
		mov	[eax+4], eax
		mov	esi, [ebx+28h]
		mov	ebp, [ebx+20h]
		test	esi, esi
		jz	short loc_10001CF5
		call	sub_10001580

loc_10001CF5:				; CODE XREF: PR_CancelWaitGroup+23Ej
		push	ebx		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esp+14h+var_4], ebp

loc_10001D02:				; CODE XREF: PR_CancelWaitGroup+1E6j
					; PR_CancelWaitGroup+1F7j
		lea	eax, [edi+40h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [edi+14h]
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	eax, [esp+18h+var_4]
		add	esp, 4
		pop	ebp
		pop	ebx
		pop	edi
		pop	esi
		pop	ecx
		retn
PR_CancelWaitGroup endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  75. PR_CreateWaitGroup

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateWaitGroup
PR_CreateWaitGroup proc	near		; CODE XREF: sub_10002180+Fp
					; DATA XREF: .rdata:off_1002C7C8o
		push	esi
		push	60h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10001D55
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001D55:				; CODE XREF: PR_CreateWaitGroup+11j
		call	PR_NewLock
		mov	[esi+14h], eax
		test	eax, eax
		jz	loc_10001E1C
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+18h], eax
		test	eax, eax
		jz	loc_10001E10
		mov	eax, [esi+14h]
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+1Ch], eax
		test	eax, eax
		jz	short loc_10001E04
		mov	ecx, [esi+14h]
		push	ecx
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+20h], eax
		test	eax, eax
		jz	short loc_10001DF8
		mov	edx, [esi+14h]
		push	edx
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+24h], eax
		test	eax, eax
		jz	short loc_10001DEC
		lea	eax, [esi+8]
		push	0F4h		; SizeOfElements
		push	1		; NumOfElements
		mov	[esi], esi
		mov	[esi+4], esi
		mov	[eax], eax
		mov	[esi+0Ch], eax
		call	PR_Calloc
		add	esp, 8
		mov	[esi+3Ch], eax
		test	eax, eax
		jnz	short loc_10001E29
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		mov	eax, [esi+24h]
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 0Ch

loc_10001DEC:				; CODE XREF: PR_CreateWaitGroup+80j
		mov	ecx, [esi+20h]
		push	ecx		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_10001DF8:				; CODE XREF: PR_CreateWaitGroup+6Dj
		mov	edx, [esi+1Ch]
		push	edx		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_10001E04:				; CODE XREF: PR_CreateWaitGroup+5Aj
		mov	eax, [esi+18h]
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_10001E10:				; CODE XREF: PR_CreateWaitGroup+43j
		mov	ecx, [esi+14h]
		push	ecx		; Memory
		call	PR_DestroyLock
		add	esp, 4

loc_10001E1C:				; CODE XREF: PR_CreateWaitGroup+2Fj
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001E29:				; CODE XREF: PR_CreateWaitGroup+A3j
		xor	edx, edx
		mov	[eax], dx
		mov	eax, [esi+3Ch]
		lea	edx, [esi+40h]
		mov	ecx, 3Bh
		push	edx		; lpCriticalSection
		mov	[eax+2], cx
		call	ds:InitializeCriticalSection
		lea	eax, [esi+58h]
		mov	[eax], eax
		mov	[esi+5Ch], eax
		mov	eax, dword_100309E0
		push	eax
		call	PR_Lock
		mov	eax, dword_100309E4
		mov	[esi], eax
		mov	ecx, [eax+4]
		mov	[esi+4], ecx
		mov	edx, [eax+4]
		mov	[edx], esi
		mov	[eax+4], esi
		mov	eax, dword_100309E0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
PR_CreateWaitGroup endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  94. PR_DestroyWaitGroup

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyWaitGroup(void *Memory)
		public PR_DestroyWaitGroup
PR_DestroyWaitGroup proc near		; CODE XREF: sub_10002130+26p
					; sub_10002180+50p
					; DATA XREF: ...

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		push	edi
		xor	edi, edi
		test	esi, esi
		jnz	short loc_10001E9C
		mov	eax, dword_100309E4
		mov	esi, [eax+8]
		test	esi, esi
		jz	loc_10001F90

loc_10001E9C:				; CODE XREF: PR_DestroyWaitGroup+Aj
		mov	ecx, [esi+14h]
		push	ecx
		call	PR_Lock
		add	esp, 4
		cmp	[esi+2Ch], di
		jnz	short loc_10001EC6
		mov	edx, [esi+3Ch]
		cmp	[edx], di
		jnz	short loc_10001EC6
		lea	eax, [esi+8]
		cmp	[eax], eax
		jnz	short loc_10001EC6
		mov	dword ptr [esi+10h], 2
		jmp	short loc_10001ED8
; ---------------------------------------------------------------------------

loc_10001EC6:				; CODE XREF: PR_DestroyWaitGroup+2Cj
					; PR_DestroyWaitGroup+34j ...
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	edi, 0FFFFFFFFh

loc_10001ED8:				; CODE XREF: PR_DestroyWaitGroup+44j
		mov	eax, [esi+14h]
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_10001EEE
		or	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001EEE:				; CODE XREF: PR_DestroyWaitGroup+67j
		mov	ecx, dword_100309E0
		push	ecx
		call	PR_Lock
		mov	edx, [esi+4]
		mov	eax, [esi]
		mov	[edx], eax
		mov	eax, dword_100309E0
		mov	ecx, [esi]
		mov	edx, [esi+4]
		push	eax		; lpTlsValue
		mov	[ecx+4], edx
		call	PR_Unlock
		add	esp, 8
		lea	ecx, [esi+40h]
		push	ecx		; lpCriticalSection
		call	ds:DeleteCriticalSection
		mov	edx, [esi+3Ch]
		push	edx		; Memory
		call	PR_Free
		mov	eax, [esi+34h]
		push	eax		; Memory
		mov	dword ptr [esi+3Ch], 0
		call	PR_Free
		mov	ecx, [esi+24h]
		push	ecx		; Memory
		mov	dword ptr [esi+34h], 0
		call	PR_DestroyCondVar
		mov	edx, [esi+20h]
		push	edx		; Memory
		call	PR_DestroyCondVar
		mov	eax, [esi+1Ch]
		push	eax		; Memory
		call	PR_DestroyCondVar
		mov	ecx, [esi+18h]
		push	ecx		; Memory
		call	PR_DestroyCondVar
		mov	edx, [esi+14h]
		push	edx		; Memory
		call	PR_DestroyLock
		mov	eax, dword_100309E4
		add	esp, 1Ch
		cmp	esi, [eax+8]
		jnz	short loc_10001F82
		mov	dword ptr [eax+8], 0

loc_10001F82:				; CODE XREF: PR_DestroyWaitGroup+F9j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001F90:				; CODE XREF: PR_DestroyWaitGroup+16j
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		or	edi, 0FFFFFFFFh
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	esi
		retn
PR_DestroyWaitGroup endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  64. PR_CreateMWaitEnumerator

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateMWaitEnumerator
PR_CreateMWaitEnumerator proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		push	28h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10001FD5
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001FD5:				; CODE XREF: PR_CreateMWaitEnumerator+11j
		mov	eax, [esp+4+arg_0]
		mov	[esi], eax
		mov	dword ptr [esi+8], 0EADFACEh
		mov	eax, esi
		pop	esi
		retn
PR_CreateMWaitEnumerator endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  84. PR_DestroyMWaitEnumerator

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyMWaitEnumerator(void *Memory)
		public PR_DestroyMWaitEnumerator
PR_DestroyMWaitEnumerator proc near	; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		mov	eax, [esp+Memory]
		test	eax, eax
		jz	short loc_10002014
		cmp	dword ptr [eax+8], 0EADFACEh
		jnz	short loc_10002014
		push	eax		; Memory
		mov	dword ptr [eax+8], 0
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10002014:				; CODE XREF: PR_DestroyMWaitEnumerator+6j
					; PR_DestroyMWaitEnumerator+Fj
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
PR_DestroyMWaitEnumerator endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 106. PR_EnumerateWaitGroup

; =============== S U B	R O U T	I N E =======================================


		public PR_EnumerateWaitGroup
PR_EnumerateWaitGroup proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		test	esi, esi
		jz	loc_10002119
		mov	eax, [esp+8+arg_4]
		jmp	short loc_10002050
; ---------------------------------------------------------------------------
		align 10h

loc_10002050:				; CODE XREF: PR_EnumerateWaitGroup+14j
					; PR_EnumerateWaitGroup+4Dj
		cmp	dword ptr [esi+8], 0EADFACEh
		jnz	loc_10002119
		test	eax, eax
		jz	short loc_1000207F
		call	PR_GetCurrentThread
		cmp	eax, [esi+4]
		jnz	loc_10002119
		mov	eax, [esi]
		mov	ecx, [esi+0Ch]
		cmp	ecx, [eax+30h]
		jz	short loc_100020C6
		xor	eax, eax
		xor	edi, edi
		jmp	short loc_10002050
; ---------------------------------------------------------------------------

loc_1000207F:				; CODE XREF: PR_EnumerateWaitGroup+2Fj
		cmp	dword ptr [esi], 0
		jnz	short loc_100020A6
		mov	edx, dword_100309E4
		mov	eax, [edx+8]
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_100020A6
		push	eax
		push	0FFFFE8D4h
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100020A6:				; CODE XREF: PR_EnumerateWaitGroup+52j
					; PR_EnumerateWaitGroup+61j
		mov	eax, [esi]
		mov	ecx, [eax+3Ch]
		add	ecx, 4
		mov	[esi+10h], ecx
		mov	eax, [eax+30h]
		mov	[esi+0Ch], eax
		call	PR_GetCurrentThread
		mov	[esi+4], eax
		mov	dword ptr [esi+14h], 0

loc_100020C6:				; CODE XREF: PR_EnumerateWaitGroup+47j
		mov	ecx, [esi]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [esi]
		mov	eax, [edx+3Ch]
		movzx	edx, word ptr [eax+2]
		mov	ecx, 1
		cmp	[esi+14h], edx
		jnb	short loc_10002105

loc_100020E5:				; CODE XREF: PR_EnumerateWaitGroup+D3j
		mov	eax, [esi+10h]
		add	[esi+14h], ecx
		mov	edi, [eax]
		add	eax, 4
		mov	[esi+10h], eax
		test	edi, edi
		jnz	short loc_10002108
		mov	eax, [esi]
		mov	edx, [eax+3Ch]
		movzx	eax, word ptr [edx+2]
		cmp	[esi+14h], eax
		jb	short loc_100020E5

loc_10002105:				; CODE XREF: PR_EnumerateWaitGroup+B3j
		add	[esi+14h], ecx

loc_10002108:				; CODE XREF: PR_EnumerateWaitGroup+C5j
		mov	ecx, [esi]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10002119:				; CODE XREF: PR_EnumerateWaitGroup+Aj
					; PR_EnumerateWaitGroup+27j ...
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		retn
PR_EnumerateWaitGroup endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002130	proc near		; CODE XREF: PR_Cleanup+A5p
		mov	eax, dword_100309E0
		push	eax		; Memory
		call	PR_DestroyLock
		mov	ecx, dword_100309E4
		mov	eax, [ecx+8]
		add	esp, 4
		mov	dword_100309E0,	0
		test	eax, eax
		jz	short loc_1000215E
		push	eax		; Memory
		call	PR_DestroyWaitGroup
		add	esp, 4

loc_1000215E:				; CODE XREF: sub_10002130+23j
		mov	edx, dword_100309E4
		push	edx		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword_100309E4,	0
		retn
sub_10002130	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002180	proc near		; CODE XREF: PR_AddWaitFileDesc+18p
					; PR_WaitRecvReady+26p
		mov	eax, dword_100309E4
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_100021E1
		push	esi
		push	3Bh
		call	PR_CreateWaitGroup
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_100021E0
		mov	ecx, dword_100309E0
		push	ecx
		call	PR_Lock
		mov	eax, dword_100309E4
		add	esp, 4
		cmp	dword ptr [eax+8], 0
		jnz	short loc_100021BC
		mov	[eax+8], esi
		xor	esi, esi

loc_100021BC:				; CODE XREF: sub_10002180+35j
		mov	edx, dword_100309E0
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	esi, esi
		jz	short loc_100021D8
		push	esi		; Memory
		call	PR_DestroyWaitGroup
		add	esp, 4

loc_100021D8:				; CODE XREF: sub_10002180+4Dj
		mov	eax, dword_100309E4
		mov	eax, [eax+8]

loc_100021E0:				; CODE XREF: sub_10002180+1Bj
		pop	esi

locret_100021E1:			; CODE XREF: sub_10002180+Aj
		retn
sub_10002180	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  17. PR_AddWaitFileDesc

; =============== S U B	R O U T	I N E =======================================


		public PR_AddWaitFileDesc
PR_AddWaitFileDesc proc	near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		cmp	dword_10031520,	0
		jnz	short loc_100021FF
		call	PR_Init

loc_100021FF:				; CODE XREF: PR_AddWaitFileDesc+8j
		push	edi
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jnz	short loc_10002219
		call	sub_10002180
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10002219
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10002219:				; CODE XREF: PR_AddWaitFileDesc+16j
					; PR_AddWaitFileDesc+21j
		push	ebp
		mov	ebp, [esp+0Ch+arg_4]
		mov	dword ptr [ebp+0Ch], 1
		mov	dword ptr [ebp+14h], 0
		mov	eax, [edi+14h]
		push	esi
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	dword ptr [edi+10h], 0
		jz	short loc_10002266
		push	0
		push	0FFFFE8D5h
		mov	dword ptr [ebp+0Ch], 0FFFFFFFDh
		call	PR_SetError
		mov	ecx, [edi+14h]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 0Ch
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10002266:				; CODE XREF: PR_AddWaitFileDesc+4Dj
		push	ebx
		lea	ebx, [edi+40h]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [edi+3Ch]
		xor	eax, eax
		cmp	ax, [edx]
		jnz	short loc_10002283
		call	PR_IntervalNow
		mov	[edi+38h], eax

loc_10002283:				; CODE XREF: PR_AddWaitFileDesc+89j
		mov	ecx, [edi+3Ch]
		push	ecx
		push	ebp
		call	sub_100016E0
		mov	esi, eax
		add	esp, 8
		cmp	esi, 1
		jnz	short loc_100022BA

loc_10002297:				; CODE XREF: PR_AddWaitFileDesc+C8j
		push	edi
		call	sub_10001780
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_100022BA
		mov	edx, [edi+3Ch]
		push	edx
		push	ebp
		call	sub_100016E0
		mov	esi, eax
		add	esp, 8
		cmp	esi, 1
		jz	short loc_10002297

loc_100022BA:				; CODE XREF: PR_AddWaitFileDesc+A5j
					; PR_AddWaitFileDesc+B4j
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [edi+20h]
		push	eax
		call	PR_NotifyCondVar
		mov	ecx, [edi+14h]
		neg	esi
		sbb	esi, esi
		push	ecx		; lpTlsValue
		mov	[esp+1Ch+var_4], esi
		call	PR_Unlock
		push	30h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	ebx, eax
		add	esp, 10h
		test	ebx, ebx
		jnz	short loc_1000230E
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		mov	edx, [ebp+8]
		push	edx
		mov	eax, edi
		call	sub_10001930
		add	esp, 0Ch
		pop	ebx
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000230E:				; CODE XREF: PR_AddWaitFileDesc+FBj
		mov	dword ptr [ebx+14h], 49h
		mov	[ebx+20h], ebp
		mov	[ebx+24h], edi
		mov	eax, [ebp+10h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1000236A
		push	ebx
		push	offset loc_100018C0
		push	eax
		call	sub_100014E0
		add	esp, 0Ch
		mov	[ebx+28h], eax
		test	eax, eax
		jnz	short loc_1000236A
		mov	eax, [ebp+8]
		push	eax
		mov	eax, edi
		call	sub_10001930
		push	ebx		; Memory
		call	PR_Free
		add	esp, 8
		call	ds:GetLastError
		push	eax
		push	0FFFFE8AAh
		call	PR_SetError
		add	esp, 8
		pop	ebx
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000236A:				; CODE XREF: PR_AddWaitFileDesc+131j
					; PR_AddWaitFileDesc+147j
		mov	ecx, [ebp+8]
		push	0
		push	ecx
		call	PR_GetIdentitiesLayer
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10002395
		push	eax
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	ebx
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10002395:				; CODE XREF: PR_AddWaitFileDesc+18Cj
		mov	eax, [esi+4]
		cmp	dword ptr [eax+2Ch], 0
		mov	ecx, [eax+28h]
		mov	[esp+14h+arg_0], ecx
		jnz	short loc_100023BC
		push	ecx		; FileHandle
		call	sub_1001E100
		mov	edx, [esi+4]
		mov	ecx, [esp+18h+arg_0]
		add	esp, 4
		mov	dword ptr [edx+2Ch], 1

loc_100023BC:				; CODE XREF: PR_AddWaitFileDesc+1B3j
		mov	eax, [ebp+1Ch]
		mov	edx, [ebp+18h]
		push	ebx		; lpOverlapped
		push	0		; lpNumberOfBytesRead
		push	eax		; nNumberOfBytesToRead
		push	edx		; lpBuffer
		push	ecx		; hFile
		call	ds:ReadFile
		test	eax, eax
		jnz	short loc_10002431
		call	ds:GetLastError
		mov	esi, eax
		mov	[esp+14h+arg_0], esi
		cmp	esi, 3E5h
		jz	short loc_10002431
		cmp	dword ptr [ebp+10h], 0FFFFFFFFh
		jz	short loc_1000241F
		push	1		; Comperand
		push	0FFFFFFFFh	; Exchange
		lea	eax, [ebp+0Ch]
		push	eax		; Destination
		call	ds:InterlockedCompareExchange
		cmp	eax, 1
		jnz	short loc_1000240B
		mov	esi, [ebx+28h]
		call	sub_10001580
		mov	esi, [esp+14h+arg_0]

loc_1000240B:				; CODE XREF: PR_AddWaitFileDesc+20Dj
		mov	eax, [ebp+8]
		push	eax
		mov	eax, edi
		call	sub_10001930
		push	ebx		; Memory
		call	PR_Free
		add	esp, 8

loc_1000241F:				; CODE XREF: PR_AddWaitFileDesc+1FAj
		push	esi
		call	sub_100253E0
		add	esp, 4
		pop	ebx
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10002431:				; CODE XREF: PR_AddWaitFileDesc+1E0j
					; PR_AddWaitFileDesc+1F4j
		mov	eax, [esp+14h+var_4]
		pop	ebx
		pop	esi
		pop	ebp
		pop	edi
		pop	ecx
		retn
PR_AddWaitFileDesc endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 375. PR_WaitRecvReady

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_WaitRecvReady(void *Memory)
		public PR_WaitRecvReady
PR_WaitRecvReady proc near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4
Memory		= dword	ptr  4

		push	ecx
		push	ebp
		push	esi
		xor	ebp, ebp
		push	edi
		mov	[esp+10h+var_4], ebp
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, eax
		cmp	dword_10031520,	ebp
		jnz	short loc_1000245E
		call	PR_Init

loc_1000245E:				; CODE XREF: PR_WaitRecvReady+17j
		mov	edi, [esp+10h+Memory]
		test	edi, edi
		jnz	short loc_10002475
		call	sub_10002180
		mov	edi, eax
		test	edi, edi
		jz	loc_10002671

loc_10002475:				; CODE XREF: PR_WaitRecvReady+24j
		mov	eax, [edi+14h]
		push	ebx
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	[edi+10h], ebp
		jz	short loc_1000249F
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		mov	ebx, [esp+1Ch+Memory]
		add	esp, 8
		jmp	loc_100025A9
; ---------------------------------------------------------------------------

loc_1000249F:				; CODE XREF: PR_WaitRecvReady+45j
		inc	word ptr [edi+2Ch]
		lea	eax, [edi+40h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebp, ds:LeaveCriticalSection
		lea	eax, [edi+8]
		cmp	[eax], eax
		jnz	loc_1000257A
		lea	ebx, [esi+70h]

loc_100024C1:				; CODE XREF: PR_WaitRecvReady+134j
		lea	eax, [esi+40h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	dword ptr [esi], 6
		lea	eax, [edi+58h]
		mov	[ebx], eax
		mov	ecx, [edi+5Ch]
		mov	[esi+74h], ecx
		mov	edx, [edi+5Ch]
		mov	[edx], ebx
		mov	[edi+5Ch], ebx
		test	byte ptr [esi+90h], 80h
		jnz	short loc_10002521
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		push	0FFFFFFFFh
		push	esi
		mov	dword ptr [esi+58h], 2
		call	_PR_AddSleepQ
		mov	edx, [esi+9Ch]
		mov	eax, [edx+24h]
		add	esp, 8
		add	eax, 18h
		push	eax		; lpCriticalSection
		call	ebp ; LeaveCriticalSection

loc_10002521:				; CODE XREF: PR_WaitRecvReady+ABj
		lea	eax, [esi+40h]
		push	eax		; lpCriticalSection
		call	ebp ; LeaveCriticalSection
		lea	eax, [edi+40h]
		push	eax		; lpCriticalSection
		call	ebp ; LeaveCriticalSection
		mov	ecx, [edi+14h]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		push	0FFFFFFFFh
		push	esi
		call	sub_1001DB80
		mov	dword ptr [esi], 2
		mov	edx, [edi+14h]
		push	edx
		call	PR_Lock
		add	esp, 10h
		lea	eax, [edi+40h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esi+90h]
		test	eax, 1000h
		jnz	short loc_1000256F
		test	al, 2
		jnz	loc_100025FE

loc_1000256F:				; CODE XREF: PR_WaitRecvReady+125j
		lea	eax, [edi+8]
		cmp	[eax], eax
		jz	loc_100024C1

loc_1000257A:				; CODE XREF: PR_WaitRecvReady+78j
		mov	esi, [edi+8]
		mov	ecx, [esi+4]
		mov	edx, [esi]
		mov	[ecx], edx
		mov	eax, [esi]
		mov	ecx, [esi+4]
		mov	[eax+4], ecx
		lea	eax, [edi+40h]
		push	eax		; lpCriticalSection
		call	ebp ; LeaveCriticalSection
		mov	edx, [esi+8]
		lea	ebx, [esi-18h]
		mov	[esp+14h+var_4], edx

loc_1000259C:				; CODE XREF: PR_WaitRecvReady+1F7j
		mov	ebp, [esp+14h+var_4]
		mov	eax, 0FFFFh
		add	[edi+2Ch], ax

loc_100025A9:				; CODE XREF: PR_WaitRecvReady+5Aj
		cmp	dword ptr [edi+10h], 1
		jnz	short loc_100025CA
		xor	ecx, ecx
		cmp	cx, [edi+2Ch]
		jnz	short loc_100025CA
		mov	edx, [edi+24h]
		push	edx
		mov	dword ptr [edi+10h], 2
		call	PR_NotifyCondVar
		add	esp, 4

loc_100025CA:				; CODE XREF: PR_WaitRecvReady+16Dj
					; PR_WaitRecvReady+175j
		mov	eax, [edi+14h]
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	ebp, ebp
		jz	loc_10002669
		mov	eax, [ebp+0Ch]
		cmp	eax, 0FFFFFFFDh
		jz	short loc_10002645
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1000263C
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10002654
		mov	ecx, [ebx+2Ch]
		push	ecx
		call	sub_100253E0
		add	esp, 4
		jmp	short loc_10002654
; ---------------------------------------------------------------------------

loc_100025FE:				; CODE XREF: PR_WaitRecvReady+129j
		mov	eax, [esi+74h]
		mov	ecx, [ebx]
		mov	[eax], ecx
		mov	eax, [esi+74h]
		mov	edx, [ebx]
		mov	[edx+4], eax
		lea	eax, [edi+40h]
		push	eax		; lpCriticalSection
		call	ebp ; LeaveCriticalSection
		and	dword ptr [esi+90h], 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	dword ptr [esi+0ACh], 0
		call	PR_SetError
		mov	ebx, [esp+1Ch+Memory]
		add	esp, 8
		jmp	loc_1000259C
; ---------------------------------------------------------------------------

loc_1000263C:				; CODE XREF: PR_WaitRecvReady+1A9j
		push	0
		push	0FFFFE89Ah
		jmp	short loc_1000264C
; ---------------------------------------------------------------------------

loc_10002645:				; CODE XREF: PR_WaitRecvReady+1A4j
		push	0
		push	0FFFFE897h

loc_1000264C:				; CODE XREF: PR_WaitRecvReady+203j
		call	PR_SetError
		add	esp, 8

loc_10002654:				; CODE XREF: PR_WaitRecvReady+1AEj
					; PR_WaitRecvReady+1BCj
		mov	esi, [ebx+28h]
		test	esi, esi
		jz	short loc_10002660
		call	sub_10001580

loc_10002660:				; CODE XREF: PR_WaitRecvReady+219j
		push	ebx		; Memory
		call	PR_Free
		add	esp, 4

loc_10002669:				; CODE XREF: PR_WaitRecvReady+198j
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10002671:				; CODE XREF: PR_WaitRecvReady+2Fj
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ecx
		retn
PR_WaitRecvReady endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002680	proc near		; CODE XREF: sub_100026E0+2Ep
					; sub_10002920+52p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_0]
		lea	eax, [ecx-1]
		cmp	eax, 0Fh
		ja	short loc_100026C1
		mov	eax, dword_10030048[ecx*4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100026AB
		push	0
		push	0FFFFE8B3h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100026AB:				; CODE XREF: sub_10002680+16j
		mov	edx, [esp+arg_8]
		mov	[edx], eax
		mov	eax, dword_10030090[ecx*4]
		mov	ecx, [esp+arg_4]
		mov	[ecx], eax
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100026C1:				; CODE XREF: sub_10002680+Aj
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
sub_10002680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100026E0(int,	int optlen)
sub_100026E0	proc near		; DATA XREF: .data:10030510o
					; .data:100305A0o

optname		= dword	ptr -0Ch
level		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
optlen		= dword	ptr  8

		sub	esp, 0Ch
		push	edi
		mov	edi, [esp+10h+optlen]
		mov	eax, [edi]
		test	eax, eax
		jnz	short loc_10002702
		mov	eax, [esp+10h+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+4]
		mov	[edi+8], edx
		xor	eax, eax
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002702:				; CODE XREF: sub_100026E0+Cj
		push	esi
		lea	ecx, [esp+14h+optname]
		push	ecx
		lea	edx, [esp+18h+level]
		push	edx
		push	eax
		call	sub_10002680
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	loc_100028DE	; jumptable 10002733 default case
		mov	eax, [edi]
		dec	eax
		cmp	eax, 0Fh	; switch 16 cases
		ja	loc_100028DE	; jumptable 10002733 default case
		movzx	eax, ds:byte_10002904[eax]
		jmp	ds:off_100028E8[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000273A:				; CODE XREF: sub_100026E0+53j
					; DATA XREF: .text:off_100028E8o
		mov	eax, [esp+14h+optname] ; jumptable 10002733 case 0
		lea	ecx, [esp+14h+optlen]
		push	ecx		; optlen
		mov	ecx, [esp+18h+level]
		lea	edx, [esp+18h+level]
		push	edx		; optval
		mov	edx, [esp+1Ch+arg_0]
		push	eax		; optname
		push	ecx		; level
		push	edx		; int
		mov	[esp+28h+optlen], 4
		call	sub_10020160
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_100028DE	; jumptable 10002733 default case
		cmp	word ptr [esp+14h+level], ax
		movzx	ecx, word ptr [esp+14h+level+2]
		setnz	al
		push	ecx
		mov	[edi+8], eax
		call	PR_SecondsToInterval
		add	esp, 4
		mov	[edi+0Ch], eax
		mov	eax, esi
		pop	esi
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002791:				; CODE XREF: sub_100026E0+53j
					; DATA XREF: .text:off_100028E8o
		mov	ecx, [esp+14h+optname] ; jumptable 10002733 cases 1,2,11,12,14,15
		lea	edx, [esp+14h+optlen]
		push	edx		; optlen
		mov	edx, [esp+18h+level]
		lea	eax, [esp+18h+level]
		push	eax		; optval
		mov	eax, [esp+1Ch+arg_0]
		push	ecx		; optname
		push	edx		; level
		push	eax		; int
		mov	[esp+28h+optlen], 4
		call	sub_10020160
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_100028DE	; jumptable 10002733 default case
		xor	ecx, ecx
		cmp	[esp+14h+level], ecx
		pop	esi
		setnz	cl
		mov	[edi+8], ecx
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100027D6:				; CODE XREF: sub_100026E0+53j
					; DATA XREF: .text:off_100028E8o
		mov	ecx, [esp+14h+optname] ; jumptable 10002733 cases 3,4,13
		lea	edx, [esp+14h+optlen]
		push	edx		; optlen
		mov	edx, [esp+18h+level]
		lea	eax, [esp+18h+level]
		push	eax		; optval
		mov	eax, [esp+1Ch+arg_0]
		push	ecx		; optname
		push	edx		; level
		push	eax		; int
		mov	[esp+28h+optlen], 4
		call	sub_10020160
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	loc_100028DE	; jumptable 10002733 default case
		mov	ecx, [esp+14h+level]
		pop	esi
		mov	[edi+8], ecx
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002816:				; CODE XREF: sub_100026E0+53j
					; DATA XREF: .text:off_100028E8o
		mov	eax, [esp+14h+optname] ; jumptable 10002733 cases 5,6
		mov	ecx, [esp+14h+level]
		lea	edx, [esp+14h+optlen]
		push	edx
		mov	edx, [esp+18h+arg_0]
		add	edi, 8
		push	edi
		push	eax
		push	ecx
		push	edx
		jmp	loc_100028CC
; ---------------------------------------------------------------------------

loc_10002833:				; CODE XREF: sub_100026E0+53j
					; DATA XREF: .text:off_100028E8o
		mov	edx, [esp+14h+optname] ; jumptable 10002733 case 10
		lea	eax, [esp+14h+optlen]
		push	eax		; optlen
		mov	eax, [esp+18h+level]
		lea	ecx, [esp+18h+level]
		push	ecx		; optval
		mov	ecx, [esp+1Ch+arg_0]
		push	edx		; optname
		push	eax		; level
		push	ecx		; int
		mov	[esp+28h+optlen], 4
		call	sub_10020160
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_100028DE ; jumptable 10002733	default	case
		mov	edx, [esp+14h+level]
		pop	esi
		mov	[edi+8], edx
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000286F:				; CODE XREF: sub_100026E0+53j
					; DATA XREF: .text:off_100028E8o
		mov	edx, [esp+14h+optname] ; jumptable 10002733 cases 7,8
		lea	eax, [esp+14h+optlen]
		push	eax		; optlen
		mov	eax, [esp+18h+level]
		lea	ecx, [esp+18h+level]
		push	ecx		; optval
		mov	ecx, [esp+1Ch+arg_0]
		push	edx		; optname
		push	eax		; level
		push	ecx		; int
		mov	[esp+28h+optlen], 8
		call	sub_10020160
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jnz	short loc_100028DE ; jumptable 10002733	default	case
		mov	eax, [esp+14h+var_4]
		mov	edx, [esp+14h+level]
		mov	[edi+2Ch], eax
		mov	eax, esi
		pop	esi
		mov	[edi+0Ch], edx
		pop	edi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100028B4:				; CODE XREF: sub_100026E0+53j
					; DATA XREF: .text:off_100028E8o
		mov	edx, [esp+14h+optname] ; jumptable 10002733 case 9
		mov	eax, [esp+14h+level]
		lea	ecx, [esp+14h+optlen]
		push	ecx		; optlen
		mov	ecx, [esp+18h+arg_0]
		add	edi, 0Ch
		push	edi		; optval
		push	edx		; optname
		push	eax		; level
		push	ecx		; int

loc_100028CC:				; CODE XREF: sub_100026E0+14Ej
		mov	[esp+28h+optlen], 4
		call	sub_10020160
		mov	esi, eax
		add	esp, 14h

loc_100028DE:				; CODE XREF: sub_100026E0+3Aj
					; sub_100026E0+46j ...
		mov	eax, esi	; jumptable 10002733 default case
		pop	esi
		pop	edi
		add	esp, 0Ch
		retn
sub_100026E0	endp

; ---------------------------------------------------------------------------
		align 4
off_100028E8	dd offset loc_1000273A	; DATA XREF: sub_100026E0+53r
		dd offset loc_10002791	; jump table for switch	statement
		dd offset loc_100027D6
		dd offset loc_10002816
		dd offset loc_1000286F
		dd offset loc_100028B4
		dd offset loc_10002833
byte_10002904	db	0,     1,     1,     2 ; DATA XREF: sub_100026E0+4Cr
		db	2,     3,     3,     4 ; indirect table	for switch statement
		db	4,     5,     6,     1
		db	1,     2,     1,     1
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10002920(int,	int optname)
sub_10002920	proc near		; DATA XREF: .data:10030514o
					; .data:100305A4o

level		= dword	ptr -0Ch
optval		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
optname		= dword	ptr  8

		sub	esp, 0Ch
		push	esi
		mov	esi, [esp+10h+optname]
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_10002967
		mov	eax, [esp+10h+arg_0]
		mov	eax, [eax+4]
		cmp	dword ptr [eax+2Ch], 0
		jz	short loc_1000295A
		mov	ecx, [eax+4]
		cmp	ecx, [esi+8]
		jz	short loc_1000295A
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000295A:				; CODE XREF: sub_10002920+19j
					; sub_10002920+21j
		mov	edx, [esi+8]
		mov	[eax+4], edx
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002967:				; CODE XREF: sub_10002920+Cj
		lea	ecx, [esp+10h+optname]
		push	ecx
		lea	edx, [esp+14h+level]
		push	edx
		push	eax
		call	sub_10002680
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10002AAD	; jumptable 10002995 default case
		mov	ecx, [esi]
		dec	ecx
		cmp	ecx, 0Fh	; switch 16 cases
		ja	loc_10002AAD	; jumptable 10002995 default case
		movzx	ecx, ds:byte_10002AD4[ecx]
		jmp	ds:off_10002AB4[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000299C:				; CODE XREF: sub_10002920+75j
					; DATA XREF: .text:off_10002AB4o
		mov	eax, [esi+0Ch]	; jumptable 10002995 case 0
		mov	dx, [esi+8]
		push	eax
		mov	word ptr [esp+14h+optval], dx
		call	PR_IntervalToSeconds
		mov	edx, [esp+14h+optname]
		push	4		; optlen
		lea	ecx, [esp+18h+optval]
		push	ecx		; optval
		mov	ecx, [esp+1Ch+arg_0]
		mov	word ptr [esp+1Ch+optval+2], ax
		mov	eax, [esp+1Ch+level]
		push	edx		; optname
		push	eax		; level
		push	ecx		; int
		call	sub_100201B0
		add	esp, 18h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100029D6:				; CODE XREF: sub_10002920+75j
					; DATA XREF: .text:off_10002AB4o
		xor	edx, edx	; jumptable 10002995 cases 1,2,12,14,15
		cmp	[esi+8], edx
		push	4
		setnz	dl
		lea	eax, [esp+14h+optval]
		push	eax
		mov	dword ptr [esp+18h+optval], edx
		jmp	loc_10002A96
; ---------------------------------------------------------------------------

loc_100029EE:				; CODE XREF: sub_10002920+75j
					; DATA XREF: .text:off_10002AB4o
		mov	eax, [esp+10h+optname] ; jumptable 10002995 case 11
		xor	ecx, ecx
		cmp	[esi+8], ecx
		push	4		; optlen
		setnz	cl
		lea	edx, [esp+14h+optval]
		push	edx		; optval
		mov	edx, [esp+18h+arg_0]
		push	eax		; optname
		mov	dword ptr [esp+1Ch+optval], ecx
		mov	ecx, [esp+1Ch+level]
		push	ecx		; level
		push	edx		; int
		call	sub_100201B0
		add	esp, 14h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002A1D:				; CODE XREF: sub_10002920+75j
					; DATA XREF: .text:off_10002AB4o
		mov	eax, [esi+8]	; jumptable 10002995 cases 3,4,13
		mov	edx, [esp+10h+optname]
		push	4		; optlen
		lea	ecx, [esp+14h+optval]
		push	ecx		; optval
		mov	ecx, [esp+18h+arg_0]
		mov	dword ptr [esp+18h+optval], eax
		mov	eax, [esp+18h+level]
		push	edx		; optname
		push	eax		; level
		push	ecx		; int
		call	sub_100201B0
		add	esp, 14h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002A47:				; CODE XREF: sub_10002920+75j
					; DATA XREF: .text:off_10002AB4o
		mov	edx, [esp+10h+optname] ; jumptable 10002995 cases 5,6
		mov	eax, [esp+10h+level]
		mov	ecx, [esp+10h+arg_0]
		push	4		; optlen
		add	esi, 8
		push	esi		; optval
		push	edx		; optname
		push	eax		; level
		push	ecx		; int
		call	sub_100201B0
		add	esp, 14h
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10002A69:				; CODE XREF: sub_10002920+75j
					; DATA XREF: .text:off_10002AB4o
		mov	edx, [esi+8]	; jumptable 10002995 case 10
		push	4
		lea	eax, [esp+14h+optval]
		mov	dword ptr [esp+14h+optval], edx
		push	eax
		jmp	short loc_10002A96
; ---------------------------------------------------------------------------

loc_10002A79:				; CODE XREF: sub_10002920+75j
					; DATA XREF: .text:off_10002AB4o
		mov	ecx, [esi+0Ch]	; jumptable 10002995 cases 7,8
		mov	edx, [esi+2Ch]
		push	8
		lea	eax, [esp+14h+optval]
		mov	dword ptr [esp+14h+optval], ecx
		mov	[esp+14h+var_4], edx
		push	eax
		jmp	short loc_10002A96
; ---------------------------------------------------------------------------

loc_10002A90:				; CODE XREF: sub_10002920+75j
					; DATA XREF: .text:off_10002AB4o
		push	4		; jumptable 10002995 case 9
		add	esi, 0Ch
		push	esi		; optval

loc_10002A96:				; CODE XREF: sub_10002920+C9j
					; sub_10002920+157j ...
		mov	ecx, [esp+18h+optname]
		mov	edx, [esp+18h+level]
		mov	eax, [esp+18h+arg_0]
		push	ecx		; optname
		push	edx		; level
		push	eax		; int
		call	sub_100201B0
		add	esp, 14h

loc_10002AAD:				; CODE XREF: sub_10002920+5Cj
					; sub_10002920+68j
		pop	esi		; jumptable 10002995 default case
		add	esp, 0Ch
		retn
sub_10002920	endp

; ---------------------------------------------------------------------------
		align 4
off_10002AB4	dd offset loc_1000299C	; DATA XREF: sub_10002920+75r
		dd offset loc_100029D6	; jump table for switch	statement
		dd offset loc_10002A1D
		dd offset loc_10002A47
		dd offset loc_10002A79
		dd offset loc_10002A90
		dd offset loc_10002A69
		dd offset loc_100029EE
byte_10002AD4	db	0,     1,     1,     2 ; DATA XREF: sub_10002920+6Er
		db	2,     3,     3,     4 ; indirect table	for switch statement
		db	4,     5,     6,     7
		db	1,     2,     1,     1
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002AF0	proc near		; DATA XREF: .data:100300DCo
					; .data:100300E0o ...
		push	0
		push	0FFFFE894h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
sub_10002AF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002B10	proc near		; DATA XREF: .data:100300ECo
					; .data:100300F8o ...
		push	0
		push	0FFFFE894h
		call	PR_SetError
		or	eax, 0FFFFFFFFh
		add	esp, 8
		or	edx, eax
		retn
sub_10002B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10002B30	proc near		; DATA XREF: .data:1003010Co
					; .data:1003022Co ...
		push	0
		push	0FFFFE894h
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		retn
sub_10002B30	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 147. PR_GetDescType

; =============== S U B	R O U T	I N E =======================================


		public PR_GetDescType
PR_GetDescType	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ecx]
		retn
PR_GetDescType	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  51. PR_Close

; =============== S U B	R O U T	I N E =======================================


		public PR_Close
PR_Close	proc near		; CODE XREF: PR_NewPollableEvent+DFp
					; PR_NewPollableEvent+E9p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [ecx+4]
		jmp	edx
PR_Close	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 299. PR_Read

; =============== S U B	R O U T	I N E =======================================


		public PR_Read
PR_Read		proc near		; CODE XREF: PR_WaitForPollableEvent+29p
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+8]
		jmp	eax
PR_Read		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 378. PR_Write

; =============== S U B	R O U T	I N E =======================================


		public PR_Write
PR_Write	proc near		; CODE XREF: PR_SetPollableEvent+11p
					; PR_vfprintf+32p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+0Ch]
		jmp	eax
PR_Write	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 312. PR_Seek

; =============== S U B	R O U T	I N E =======================================


		public PR_Seek
PR_Seek		proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+1Ch]
		jmp	eax
PR_Seek		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 313. PR_Seek64

; =============== S U B	R O U T	I N E =======================================


		public PR_Seek64
PR_Seek64	proc near		; CODE XREF: sub_10014140+73p
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	edx, [esp+arg_C]
		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		push	edx
		mov	edx, [esp+4+arg_8]
		push	edx
		mov	edx, [esp+8+arg_4]
		push	edx
		push	eax
		mov	eax, [ecx+20h]
		call	eax
		add	esp, 10h
		retn
PR_Seek64	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  29. PR_Available

; =============== S U B	R O U T	I N E =======================================


		public PR_Available
PR_Available	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [ecx+10h]
		jmp	edx
PR_Available	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  30. PR_Available64

; =============== S U B	R O U T	I N E =======================================


		public PR_Available64
PR_Available64	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [ecx+14h]
		jmp	edx
PR_Available64	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 173. PR_GetOpenFileInfo

; =============== S U B	R O U T	I N E =======================================


		public PR_GetOpenFileInfo
PR_GetOpenFileInfo proc	near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+24h]
		jmp	eax
PR_GetOpenFileInfo endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 174. PR_GetOpenFileInfo64

; =============== S U B	R O U T	I N E =======================================


		public PR_GetOpenFileInfo64
PR_GetOpenFileInfo64 proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+28h]
		jmp	eax
PR_GetOpenFileInfo64 endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 354. PR_Sync

; =============== S U B	R O U T	I N E =======================================


		public PR_Sync
PR_Sync		proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [ecx+18h]
		jmp	edx
PR_Sync		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  56. PR_Connect

; =============== S U B	R O U T	I N E =======================================


		public PR_Connect
PR_Connect	proc near		; CODE XREF: PR_QueueJob_Connect+10p
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+30h]
		jmp	eax
PR_Connect	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  57. PR_ConnectContinue

; =============== S U B	R O U T	I N E =======================================


		public PR_ConnectContinue
PR_ConnectContinue proc	near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+7Ch]
		jmp	eax
PR_ConnectContinue endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  13. PR_Accept

; =============== S U B	R O U T	I N E =======================================


		public PR_Accept
PR_Accept	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+34h]
		jmp	eax
PR_Accept	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  31. PR_Bind

; =============== S U B	R O U T	I N E =======================================


		public PR_Bind
PR_Bind		proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+38h]
		jmp	eax
PR_Bind		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 344. PR_Shutdown

; =============== S U B	R O U T	I N E =======================================


		public PR_Shutdown
PR_Shutdown	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+40h]
		jmp	eax
PR_Shutdown	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 228. PR_Listen

; =============== S U B	R O U T	I N E =======================================


		public PR_Listen
PR_Listen	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+3Ch]
		jmp	eax
PR_Listen	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 303. PR_Recv

; =============== S U B	R O U T	I N E =======================================


		public PR_Recv
PR_Recv		proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+44h]
		jmp	eax
PR_Recv		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 315. PR_Send

; =============== S U B	R O U T	I N E =======================================


		public PR_Send
PR_Send		proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+48h]
		jmp	eax
PR_Send		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 379. PR_Writev

; =============== S U B	R O U T	I N E =======================================


		public PR_Writev
PR_Writev	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_8]
		cmp	ecx, 10h
		jle	short loc_10002CAC
		push	0
		push	0FFFFE8B6h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10002CAC:				; CODE XREF: PR_Writev+7j
		mov	eax, [esp+arg_0]
		mov	edx, [eax]
		mov	edx, [edx+2Ch]
		push	esi
		mov	esi, [esp+4+arg_C]
		push	esi
		push	ecx
		mov	ecx, [esp+0Ch+arg_4]
		push	ecx
		push	eax
		call	edx
		add	esp, 10h
		pop	esi
		retn
PR_Writev	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 304. PR_RecvFrom

; =============== S U B	R O U T	I N E =======================================


		public PR_RecvFrom
PR_RecvFrom	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+4Ch]
		jmp	eax
PR_RecvFrom	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 317. PR_SendTo

; =============== S U B	R O U T	I N E =======================================


		public PR_SendTo
PR_SendTo	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+50h]
		jmp	eax
PR_SendTo	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 362. PR_TransmitFile

; =============== S U B	R O U T	I N E =======================================


		public PR_TransmitFile
PR_TransmitFile	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+5Ch]
		jmp	eax
PR_TransmitFile	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  14. PR_AcceptRead

; =============== S U B	R O U T	I N E =======================================


		public PR_AcceptRead
PR_AcceptRead	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+58h]
		jmp	eax
PR_AcceptRead	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 185. PR_GetSockName

; =============== S U B	R O U T	I N E =======================================


		public PR_GetSockName
PR_GetSockName	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+60h]
		jmp	eax
PR_GetSockName	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 178. PR_GetPeerName

; =============== S U B	R O U T	I N E =======================================


		public PR_GetPeerName
PR_GetPeerName	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+64h]
		jmp	eax
PR_GetPeerName	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 186. PR_GetSocketOption

; =============== S U B	R O U T	I N E =======================================


		public PR_GetSocketOption
PR_GetSocketOption proc	near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+70h]
		jmp	eax
PR_GetSocketOption endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 333. PR_SetSocketOption

; =============== S U B	R O U T	I N E =======================================


		public PR_SetSocketOption
PR_SetSocketOption proc	near		; CODE XREF: PR_NewPollableEvent+B3p
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+74h]
		jmp	eax
PR_SetSocketOption endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 316. PR_SendFile

; =============== S U B	R O U T	I N E =======================================


		public PR_SendFile
PR_SendFile	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+78h]
		jmp	eax
PR_SendFile	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  99. PR_EmulateAcceptRead

; =============== S U B	R O U T	I N E =======================================


		public PR_EmulateAcceptRead
PR_EmulateAcceptRead proc near		; DATA XREF: .rdata:off_1002C7C8o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
Src		= word ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		mov	edx, [esp+2Ch+arg_8]
		mov	eax, [esp+2Ch+arg_0]
		mov	ecx, [esp+2Ch+arg_4]
		push	ebx
		mov	ebx, [esp+30h+arg_C]
		push	esi
		mov	[esp+34h+var_28], edx
		push	0FFFFFFFFh
		lea	edx, [esp+38h+Src]
		mov	[esp+38h+var_2C], ecx
		mov	ecx, [eax]
		push	edx
		push	eax
		mov	eax, [ecx+34h]
		call	eax
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_10002DB4
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10002DB4:				; CODE XREF: PR_EmulateAcceptRead+3Ej
		mov	edx, [esp+34h+arg_14]
		mov	ecx, [esi]
		mov	eax, [ecx+44h]
		push	ebp
		mov	ebp, [esp+38h+arg_10]
		push	edi
		push	edx
		push	0
		push	ebp
		push	ebx
		push	esi
		call	eax
		mov	edi, eax
		add	esp, 14h
		test	edi, edi
		js	short loc_10002E1D
		mov	ecx, [esp+3Ch+var_28]
		xor	edx, edx
		lea	eax, [ebx+ebp+7]
		and	eax, 0FFFFFFF8h
		cmp	[esp+3Ch+Src], 2
		mov	[ecx], eax
		setnz	dl
		lea	ecx, [esp+3Ch+Src]
		dec	edx
		and	edx, 0FFFFFFF4h
		add	edx, 1Ch
		push	edx		; Size
		push	ecx		; Src
		push	eax		; Dst
		call	memcpy
		mov	edx, [esp+48h+var_2C]
		add	esp, 0Ch
		mov	eax, edi
		pop	edi
		pop	ebp
		mov	[edx], esi
		pop	esi
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10002E1D:				; CODE XREF: PR_EmulateAcceptRead+72j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		push	esi
		call	ecx
		mov	ecx, [esp+40h+var_4]
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
PR_EmulateAcceptRead endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 100. PR_EmulateSendFile

; =============== S U B	R O U T	I N E =======================================


		public PR_EmulateSendFile
PR_EmulateSendFile proc	near		; DATA XREF: .rdata:off_1002C7C8o

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
lpBaseAddress	= dword	ptr -40h
Memory		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		mov	eax, [esp+4Ch+arg_0]
		push	ebx
		mov	ebx, [esp+50h+arg_4]
		push	edi
		mov	[esp+54h+var_44], eax
		mov	eax, [ebx]
		mov	ecx, [eax]
		lea	edx, [esp+54h+var_34]
		push	edx
		xor	edi, edi
		push	eax
		mov	eax, [ecx+24h]
		mov	[esp+5Ch+Memory], edi
		mov	[esp+5Ch+lpBaseAddress], edi
		call	eax
		add	esp, 8
		test	eax, eax
		jnz	short loc_10002E9E
		mov	eax, [ebx+8]
		mov	ecx, [esp+54h+var_30]
		cmp	eax, edi
		jz	short loc_10002EBC
		mov	edx, [ebx+4]
		add	edx, eax
		cmp	ecx, edx
		jnb	short loc_10002EB2
		push	edi
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8

loc_10002E9E:				; CODE XREF: PR_EmulateSendFile+3Aj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_10002EB2:				; CODE XREF: PR_EmulateSendFile+4Ej
		cmp	eax, edi
		jz	short loc_10002EBC
		mov	[esp+54h+var_48], eax
		jmp	short loc_10002EC3
; ---------------------------------------------------------------------------

loc_10002EBC:				; CODE XREF: PR_EmulateSendFile+45j
					; PR_EmulateSendFile+74j
		sub	ecx, [ebx+4]
		mov	[esp+54h+var_48], ecx

loc_10002EC3:				; CODE XREF: PR_EmulateSendFile+7Aj
		push	esi
		call	PR_GetMemMapAlignment
		mov	ecx, [ebx+4]
		mov	esi, eax
		mov	eax, ecx
		xor	edx, edx
		div	esi
		mov	eax, [esp+58h+var_48]
		mov	esi, edx
		add	eax, esi
		sub	ecx, esi
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_4C], eax
		cmp	eax, 40000h
		jb	short loc_10002EF5
		mov	[esp+58h+var_4C], 40000h

loc_10002EF5:				; CODE XREF: PR_EmulateSendFile+ABj
		push	ebp
		mov	ebp, [esp+5Ch+var_4C]
		sub	ebp, esi
		jz	loc_10002F9C
		mov	ecx, [ebx]
		push	0		; int
		push	0		; dwMaximumSizeHigh
		push	0		; dwMaximumSizeLow
		push	ecx		; int
		call	PR_CreateFileMap
		add	esp, 10h
		mov	[esp+5Ch+Memory], eax
		test	eax, eax
		jnz	short loc_10002F31
		pop	ebp
		pop	esi
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+4Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_10002F31:				; CODE XREF: PR_EmulateSendFile+D9j
		mov	edx, [esp+5Ch+var_4C]
		mov	ecx, [esp+5Ch+var_38]
		push	edx
		push	0
		push	ecx
		push	eax
		call	PR_MemMap
		mov	ecx, eax
		add	esp, 10h
		mov	[esp+5Ch+lpBaseAddress], ecx
		test	ecx, ecx
		jnz	short loc_10002F9E

loc_10002F50:				; CODE XREF: PR_EmulateSendFile+1EAj
					; PR_EmulateSendFile+240j ...
		mov	[esp+5Ch+var_4C], 0FFFFFFFFh

loc_10002F58:				; CODE XREF: PR_EmulateSendFile+1FEj
					; PR_EmulateSendFile+28Ej ...
		mov	eax, [esp+5Ch+Memory]
		test	eax, eax
		jz	short loc_10002F69
		push	eax		; Memory
		call	PR_CloseFileMap
		add	esp, 4

loc_10002F69:				; CODE XREF: PR_EmulateSendFile+11Ej
		mov	esi, [esp+5Ch+var_4C]
		test	esi, esi
		js	short loc_10002F87
		test	[esp+5Ch+arg_8], 1
		jz	short loc_10002F87
		mov	eax, [esp+5Ch+var_44]
		mov	ecx, [eax]
		mov	edx, [ecx+4]
		push	eax
		call	edx
		add	esp, 4

loc_10002F87:				; CODE XREF: PR_EmulateSendFile+12Fj
					; PR_EmulateSendFile+136j
		mov	ecx, [esp+5Ch+var_4]
		pop	ebp
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_10002F9C:				; CODE XREF: PR_EmulateSendFile+BCj
		mov	ecx, edi

loc_10002F9E:				; CODE XREF: PR_EmulateSendFile+10Ej
		mov	eax, [ebx+10h]
		test	eax, eax
		jz	short loc_10002FB5
		mov	edx, [ebx+0Ch]
		mov	[esp+5Ch+var_1C], edx
		mov	[esp+5Ch+var_18], eax
		mov	edi, 1

loc_10002FB5:				; CODE XREF: PR_EmulateSendFile+163j
		test	ebp, ebp
		jz	short loc_10002FC4
		add	esi, ecx
		mov	[esp+edi*8+5Ch+var_1C],	esi
		mov	[esp+edi*8+5Ch+var_18],	ebp
		inc	edi

loc_10002FC4:				; CODE XREF: PR_EmulateSendFile+177j
		cmp	[esp+5Ch+var_48], ebp
		jnz	short loc_10002FDD
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	short loc_10002FDD
		mov	ecx, [ebx+14h]
		mov	[esp+edi*8+5Ch+var_1C],	ecx
		mov	[esp+edi*8+5Ch+var_18],	eax
		inc	edi

loc_10002FDD:				; CODE XREF: PR_EmulateSendFile+188j
					; PR_EmulateSendFile+18Fj
		cmp	edi, 10h
		jle	short loc_10002FF6
		push	0
		push	0FFFFE8B6h
		call	PR_SetError
		add	esp, 8
		or	esi, 0FFFFFFFFh
		jmp	short loc_10003012
; ---------------------------------------------------------------------------

loc_10002FF6:				; CODE XREF: PR_EmulateSendFile+1A0j
		mov	ecx, [esp+5Ch+arg_C]
		mov	eax, [esp+5Ch+var_44]
		mov	edx, [eax]
		mov	edx, [edx+2Ch]
		push	ecx
		push	edi
		lea	ecx, [esp+64h+var_1C]
		push	ecx
		push	eax
		call	edx
		add	esp, 10h
		mov	esi, eax

loc_10003012:				; CODE XREF: PR_EmulateSendFile+1B4j
		test	ebp, ebp
		jz	short loc_10003028
		mov	eax, [esp+5Ch+var_4C]
		mov	ecx, [esp+5Ch+lpBaseAddress]
		push	eax
		push	ecx		; lpBaseAddress
		call	PR_MemUnmap
		add	esp, 8

loc_10003028:				; CODE XREF: PR_EmulateSendFile+1D4j
		test	esi, esi
		js	loc_10002F50
		mov	edi, [esp+5Ch+var_48]
		sub	edi, ebp
		mov	[esp+5Ch+var_48], edi
		mov	[esp+5Ch+var_4C], esi
		jz	loc_10002F58
		cmp	edi, 40000h
		jl	short loc_10003053

loc_1000304C:				; CODE XREF: PR_EmulateSendFile+283j
		mov	edi, 40000h
		jmp	short loc_10003060
; ---------------------------------------------------------------------------

loc_10003053:				; CODE XREF: PR_EmulateSendFile+20Aj
		test	edi, edi
		jle	short loc_100030C9
		jmp	short loc_10003060
; ---------------------------------------------------------------------------
		align 10h

loc_10003060:				; CODE XREF: PR_EmulateSendFile+211j
					; PR_EmulateSendFile+217j ...
		mov	eax, [esp+5Ch+var_4C]
		sub	eax, [ebx+10h]
		mov	edx, [esp+5Ch+Memory]
		add	eax, [ebx+4]
		push	edi
		xor	ecx, ecx
		push	ecx
		push	eax
		push	edx
		call	PR_MemMap
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	loc_10002F50
		mov	edx, [esp+5Ch+arg_C]
		mov	eax, [esp+5Ch+var_44]
		mov	ecx, [eax]
		push	edx
		push	0
		push	edi
		push	esi
		push	eax
		mov	eax, [ecx+48h]
		call	eax
		push	edi
		push	esi		; lpBaseAddress
		mov	ebp, eax
		call	PR_MemUnmap
		add	esp, 1Ch
		test	ebp, ebp
		js	loc_10002F50
		mov	edi, [esp+5Ch+var_48]
		add	[esp+5Ch+var_4C], ebp
		sub	edi, ebp
		mov	[esp+5Ch+var_48], edi
		cmp	edi, 40000h
		jge	short loc_1000304C
		test	edi, edi
		jg	short loc_10003060

loc_100030C9:				; CODE XREF: PR_EmulateSendFile+215j
		mov	eax, [ebx+18h]
		test	eax, eax
		jz	loc_10002F58
		mov	esi, [esp+5Ch+arg_C]
		mov	ecx, [esp+5Ch+var_44]
		mov	ebx, [ebx+14h]
		mov	edx, [ecx]
		push	esi
		push	0
		push	eax
		mov	eax, [edx+48h]
		push	ebx
		push	ecx
		call	eax
		add	esp, 14h
		test	eax, eax
		js	loc_10002F50
		add	[esp+5Ch+var_4C], eax
		jmp	loc_10002F58
PR_EmulateSendFile endp


; =============== S U B	R O U T	I N E =======================================


sub_10003100	proc near		; CODE XREF: sub_100031D0+8Dp
					; sub_10003290+8Ap ...
		push	3
		push	esi
		call	PR_IsNetAddrType
		add	esp, 8
		test	eax, eax
		jz	short loc_10003126
		mov	eax, [esi+14h]
		mov	ecx, 2
		mov	[edi+4], eax
		mov	[edi], cx
		mov	dx, [esi+2]
		mov	[edi+2], dx
		retn
; ---------------------------------------------------------------------------

loc_10003126:				; CODE XREF: sub_10003100+Dj
		push	1
		push	esi
		call	PR_IsNetAddrType
		add	esp, 8
		test	eax, eax
		jz	short loc_10003139
		push	0
		jmp	short loc_1000314D
; ---------------------------------------------------------------------------

loc_10003139:				; CODE XREF: sub_10003100+33j
		push	2
		push	esi
		call	PR_IsNetAddrType
		add	esp, 8
		test	eax, eax
		jz	short loc_10003155
		push	7F000001h	; hostlong

loc_1000314D:				; CODE XREF: sub_10003100+37j
		call	htonl
		mov	[edi+4], eax

loc_10003155:				; CODE XREF: sub_10003100+46j
		mov	ecx, 2
		mov	[edi], cx
		mov	dx, [esi+2]
		mov	[edi+2], dx
		retn
sub_10003100	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003170	proc near		; CODE XREF: sub_10003420+C1p
					; sub_10003510+A8p ...
		mov	eax, 17h
		mov	[esi], ax
		mov	cx, [edi+2]
		push	0		; hostlong
		mov	[esi+2], cx
		call	htonl
		cmp	eax, [edi+4]
		jnz	short loc_100031B0
		mov	edx, ds:dword_1002A358
		mov	[esi+8], edx
		mov	eax, ds:dword_1002A35C
		mov	[esi+0Ch], eax
		mov	ecx, ds:dword_1002A360
		mov	[esi+10h], ecx
		mov	edx, ds:dword_1002A364
		mov	[esi+14h], edx
		retn
; ---------------------------------------------------------------------------

loc_100031B0:				; CODE XREF: sub_10003170+1Aj
		xor	eax, eax
		mov	[esi+8], eax
		mov	[esi+0Ch], eax
		mov	[esi+10h], ax
		or	eax, 0FFFFFFFFh
		mov	[esi+12h], ax
		mov	ecx, [edi+4]
		mov	[esi+14h], ecx
		retn
sub_10003170	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100031D0	proc near		; DATA XREF: .text:10003751o
					; .text:1000378Co

var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		mov	eax, [esp+24h+arg_0]
		push	ebx
		mov	ebx, [eax+8]
		push	esi
		mov	esi, [esp+2Ch+arg_4]
		mov	eax, 17h
		cmp	ax, [esi]
		jz	short loc_10003218
		push	0
		push	0FFFFE89Fh
		call	PR_SetError
		add	esp, 8
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10003218:				; CODE XREF: sub_100031D0+23j
		push	3
		push	esi
		call	PR_IsNetAddrType
		add	esp, 8
		test	eax, eax
		jnz	short loc_10003258
		push	1
		push	esi
		call	PR_IsNetAddrType
		add	esp, 8
		test	eax, eax
		jnz	short loc_10003258
		push	eax
		push	0FFFFE8A4h
		call	PR_SetError
		add	esp, 8
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10003258:				; CODE XREF: sub_100031D0+55j
					; sub_100031D0+64j
		push	edi
		lea	edi, [esp+30h+var_24]
		call	sub_10003100
		mov	ecx, [ebx]
		mov	eax, [ecx+38h]
		mov	edx, edi
		push	edx
		push	ebx
		call	eax
		mov	ecx, [esp+38h+var_4]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_100031D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003290	proc near		; DATA XREF: .text:10003747o
					; .text:10003782o

var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		mov	ebx, [esp+28h+arg_0]
		push	esi
		mov	esi, [esp+2Ch+arg_4]
		mov	eax, 17h
		cmp	ax, [esi]
		jz	short loc_100032D5
		push	0
		push	0FFFFE89Fh
		call	PR_SetError
		add	esp, 8
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_100032D5:				; CODE XREF: sub_10003290+20j
		push	3
		push	esi
		call	PR_IsNetAddrType
		add	esp, 8
		test	eax, eax
		jnz	short loc_10003315
		push	2
		push	esi
		call	PR_IsNetAddrType
		add	esp, 8
		test	eax, eax
		jnz	short loc_10003315
		push	eax
		push	0FFFFE8A4h
		call	PR_SetError
		add	esp, 8
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_10003315:				; CODE XREF: sub_10003290+52j
					; sub_10003290+61j
		push	edi
		lea	edi, [esp+30h+var_24]
		call	sub_10003100
		mov	edx, [esp+30h+arg_8]
		mov	eax, [ebx+8]
		mov	ecx, [eax]
		push	edx
		mov	edx, edi
		push	edx
		push	eax
		mov	eax, [ecx+30h]
		call	eax
		mov	ecx, [esp+3Ch+var_4]
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_10003290	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003350	proc near		; DATA XREF: .text:10003796o

var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		mov	ebx, [esp+28h+arg_0]
		push	ebp
		mov	ebp, [esp+2Ch+arg_4]
		push	esi
		mov	esi, [esp+30h+arg_10]
		mov	eax, 17h
		cmp	ax, [esi]
		jz	short loc_1000339B
		push	0
		push	0FFFFE89Fh
		call	PR_SetError
		add	esp, 8
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_1000339B:				; CODE XREF: sub_10003350+25j
		push	3
		push	esi
		call	PR_IsNetAddrType
		add	esp, 8
		test	eax, eax
		jnz	short loc_100033DC
		push	2
		push	esi
		call	PR_IsNetAddrType
		add	esp, 8
		test	eax, eax
		jnz	short loc_100033DC
		push	eax
		push	0FFFFE8A4h
		call	PR_SetError
		add	esp, 8
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+24h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
; ---------------------------------------------------------------------------

loc_100033DC:				; CODE XREF: sub_10003350+58j
					; sub_10003350+67j
		push	edi
		lea	edi, [esp+34h+var_24]
		call	sub_10003100
		mov	edx, [esp+34h+arg_14]
		mov	eax, [ebx+8]
		mov	ecx, [eax]
		push	edx
		mov	edx, edi
		push	edx
		mov	edx, [esp+3Ch+arg_C]
		push	edx
		mov	edx, [esp+40h+arg_8]
		push	edx
		push	ebp
		push	eax
		mov	eax, [ecx+50h]
		call	eax
		mov	ecx, [esp+4Ch+var_4]
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_10003350	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003420	proc near		; DATA XREF: .text:1000375Bo

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 28h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_4], eax
		mov	eax, [esp+28h+arg_8]
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+34h+arg_4]
		push	edi
		mov	edi, [esp+38h+arg_0]
		push	18h		; Size
		mov	[esp+3Ch+var_28], eax
		xor	ebp, ebp
		call	PR_Malloc
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_10003477
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10003477:				; CODE XREF: sub_10003420+32j
		mov	ecx, [edi]
		mov	[ebx], ecx
		mov	edx, [edi+4]
		mov	[ebx+4], edx
		mov	eax, [edi+8]
		mov	[ebx+8], eax
		mov	ecx, [edi+0Ch]
		mov	[ebx+0Ch], ecx
		mov	edx, [edi+10h]
		mov	[ebx+10h], edx
		mov	eax, [edi+14h]
		mov	[ebx+14h], eax
		test	esi, esi
		jz	short loc_100034A1
		lea	ebp, [esp+38h+var_24]

loc_100034A1:				; CODE XREF: sub_10003420+7Bj
		mov	edx, [esp+38h+var_28]
		mov	edi, [edi+8]
		mov	ecx, [edi]
		mov	eax, [ecx+34h]
		push	edx
		push	ebp
		push	edi
		call	eax
		mov	ebp, eax
		add	esp, 0Ch
		test	ebp, ebp
		jnz	short loc_100034D9
		push	ebx		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_100034D9:				; CODE XREF: sub_10003420+99j
		test	esi, esi
		jz	short loc_100034E6
		lea	edi, [esp+38h+var_24]
		call	sub_10003170

loc_100034E6:				; CODE XREF: sub_10003420+BBj
		push	ebx
		push	0FFFFFFFEh
		push	ebp
		call	PR_PushIOLayer
		mov	ecx, [esp+44h+var_4]
		add	esp, 0Ch
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
sub_10003420	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003510	proc near		; DATA XREF: .text:10003765o

var_20		= byte ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 20h
		push	ebx
		push	18h		; Size
		call	PR_Malloc
		mov	ebx, eax
		add	esp, 4
		test	ebx, ebx
		jnz	short loc_1000353A
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1000353A:				; CODE XREF: sub_10003510+12j
		mov	eax, [esp+24h+arg_0]
		mov	ecx, [eax]
		mov	[ebx], ecx
		mov	edx, [eax+4]
		mov	[ebx+4], edx
		mov	ecx, [eax+8]
		mov	[ebx+8], ecx
		mov	edx, [eax+0Ch]
		mov	[ebx+0Ch], edx
		mov	ecx, [eax+10h]
		mov	[ebx+10h], ecx
		mov	edx, [eax+14h]
		push	ebp
		mov	[ebx+14h], edx
		mov	edx, [esp+28h+arg_14]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		push	esi
		mov	esi, [esp+2Ch+arg_8]
		push	edx
		mov	edx, [esp+30h+arg_10]
		push	edx
		mov	edx, [esp+34h+arg_C]
		push	edx
		mov	edx, [esp+38h+arg_4]
		push	esi
		push	edx
		push	eax
		mov	eax, [ecx+58h]
		call	eax
		mov	ebp, eax
		add	esp, 18h
		cmp	ebp, 0FFFFFFFFh
		jnz	short loc_100035A2
		push	ebx		; Memory
		call	PR_Free
		add	esp, 4
		pop	esi
		or	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_100035A2:				; CODE XREF: sub_10003510+7Ej
		mov	eax, [esi]
		push	edi
		mov	esi, eax
		mov	ecx, 8
		lea	edi, [esp+30h+var_20]
		rep movsd
		mov	esi, eax
		lea	edi, [esp+30h+var_20]
		call	sub_10003170
		mov	ecx, [esp+30h+arg_4]
		mov	edx, [ecx]
		push	ebx
		push	0FFFFFFFEh
		push	edx
		call	PR_PushIOLayer
		add	esp, 0Ch
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 20h
		retn
sub_10003510	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100035E0	proc near		; DATA XREF: .text:1000376Fo
					; .text:100037AAo

var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		mov	eax, [esp+24h+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		push	ebx
		push	esi
		mov	esi, [esp+2Ch+arg_4]
		lea	edx, [esp+2Ch+var_24]
		push	edx
		push	eax
		mov	eax, [ecx+60h]
		call	eax
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_1000361E
		push	edi
		lea	edi, [esp+30h+var_24]
		call	sub_10003170
		mov	eax, ebx
		pop	edi

loc_1000361E:				; CODE XREF: sub_100035E0+2Fj
		mov	ecx, [esp+2Ch+var_4]
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_100035E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003630	proc near		; DATA XREF: .text:10003736o

var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		mov	eax, [esp+24h+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		push	ebx
		push	esi
		mov	esi, [esp+2Ch+arg_4]
		lea	edx, [esp+2Ch+var_24]
		push	edx
		push	eax
		mov	eax, [ecx+64h]
		call	eax
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_1000366E
		push	edi
		lea	edi, [esp+30h+var_24]
		call	sub_10003170
		mov	eax, ebx
		pop	edi

loc_1000366E:				; CODE XREF: sub_10003630+2Fj
		mov	ecx, [esp+2Ch+var_4]
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_10003630	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003680	proc near		; DATA XREF: .text:100037A0o

var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		mov	eax, [esp+24h+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [esp+24h+arg_4]
		mov	edx, [eax]
		push	ebx
		push	esi
		mov	esi, [esp+2Ch+arg_10]
		push	edi
		mov	edi, [esp+30h+arg_14]
		push	edi
		lea	edi, [esp+34h+var_24]
		push	edi
		mov	edi, [esp+38h+arg_C]
		push	edi
		mov	edi, [esp+3Ch+arg_8]
		push	edi
		push	ecx
		push	eax
		mov	eax, [edx+4Ch]
		call	eax
		mov	ebx, eax
		add	esp, 18h
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_100036D2
		lea	edi, [esp+30h+var_24]
		call	sub_10003170
		mov	eax, ebx

loc_100036D2:				; CODE XREF: sub_10003680+45j
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_10003680	endp

; ---------------------------------------------------------------------------
		align 10h

loc_100036F0:				; DATA XREF: sub_100037C0o
					; _pr_push_ipv6toipv4_layero
		call	sub_1000ED80
		test	eax, eax
		jz	short loc_100036FD
		xor	eax, eax
		jmp	short loc_10003702
; ---------------------------------------------------------------------------

loc_100036FD:				; CODE XREF: .text:100036F7j
		call	_pr_test_ipv6_socket

loc_10003702:				; CODE XREF: .text:100036FBj
		mov	dword_10030A84,	eax
		test	eax, eax
		jnz	loc_100037BB
		push	esi
		push	edi
		push	offset aIpv6_to_ipv4La ; "Ipv6_to_Ipv4 layer"
		call	PR_GetUniqueIdentity
		add	esp, 4
		mov	dword_10030B18,	eax
		call	PR_GetDefaultIOMethods
		mov	ecx, 24h
		mov	esi, eax
		mov	edi, offset dword_100309E8
		rep movsd
		mov	edx, offset sub_10003630
		mov	ecx, 24h
		mov	esi, eax
		mov	edi, offset dword_10030A88
		mov	dword_10030A18,	offset sub_10003290
		mov	dword_10030A20,	offset sub_100031D0
		mov	dword_10030A1C,	offset sub_10003420
		mov	dword_10030A40,	offset sub_10003510
		mov	dword_10030A48,	offset sub_100035E0
		mov	dword_10030A4C,	edx
		rep movsd
		pop	edi
		mov	dword_10030AB8,	offset sub_10003290
		mov	dword_10030AC0,	offset sub_100031D0
		mov	dword_10030AD8,	offset sub_10003350
		mov	dword_10030AD4,	offset sub_10003680
		mov	dword_10030AE8,	offset sub_100035E0
		mov	dword_10030AEC,	edx
		pop	esi

loc_100037BB:				; CODE XREF: .text:10003709j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100037C0	proc near		; CODE XREF: PR_GetHostByAddr+20p
					; PR_GetAddrInfoByName:loc_1000EEDAp ...
		push	offset loc_100036F0
		push	offset dword_10030A78
		call	PR_CallOnce
		add	esp, 8
		neg	eax
		sbb	eax, eax
		not	eax
		and	eax, dword_10030A84
		retn
sub_100037C0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 409. _pr_push_ipv6toipv4_layer

; =============== S U B	R O U T	I N E =======================================


		public _pr_push_ipv6toipv4_layer
_pr_push_ipv6toipv4_layer proc near	; CODE XREF: PR_Socket+ABp
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	offset loc_100036F0
		push	offset dword_10030A78
		call	PR_CallOnce
		add	esp, 8
		test	eax, eax
		jz	short loc_100037FA
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100037FA:				; CODE XREF: _pr_push_ipv6toipv4_layer+14j
		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	eax, [edi]
		cmp	dword ptr [eax], 2
		jnz	short loc_10003815
		mov	ecx, dword_10030B18
		push	offset dword_100309E8
		push	ecx
		jmp	short loc_10003821
; ---------------------------------------------------------------------------

loc_10003815:				; CODE XREF: _pr_push_ipv6toipv4_layer+25j
		mov	edx, dword_10030B18
		push	offset dword_10030A88
		push	edx

loc_10003821:				; CODE XREF: _pr_push_ipv6toipv4_layer+33j
		call	PR_CreateIOLayerStub
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10003850
		push	esi
		push	0FFFFFFFEh
		push	edi
		mov	dword ptr [esi+4], 0
		call	PR_PushIOLayer
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10003856
		mov	eax, [esi+10h]
		push	esi
		call	eax
		add	esp, 4

loc_10003850:				; CODE XREF: _pr_push_ipv6toipv4_layer+4Dj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003856:				; CODE XREF: _pr_push_ipv6toipv4_layer+65j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
_pr_push_ipv6toipv4_layer endp

; ---------------------------------------------------------------------------
		align 10h

loc_10003860:				; DATA XREF: PR_CreateIOLayerStub+40o
					; PR_CreateIOLayer+34o
		mov	eax, [esp+4]
		mov	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10003871
		mov	edx, [eax+0Ch]
		mov	[ecx+0Ch], edx

loc_10003871:				; CODE XREF: .text:10003869j
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jz	short loc_1000387E
		mov	edx, [eax+8]
		mov	[ecx+8], edx

loc_1000387E:				; CODE XREF: .text:10003876j
		mov	[esp+4], eax
		jmp	PR_Free
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003890	proc near		; DATA XREF: .data:10030170o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+8]
		jmp	eax
sub_10003890	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100038B0	proc near		; DATA XREF: .data:10030174o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+0Ch]
		jmp	eax
sub_100038B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100038D0	proc near		; DATA XREF: .data:10030178o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [ecx+10h]
		jmp	edx
sub_100038D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100038F0	proc near		; DATA XREF: .data:1003017Co

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [ecx+14h]
		jmp	edx
sub_100038F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003910	proc near		; DATA XREF: .data:10030180o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	edx, [ecx+18h]
		jmp	edx
sub_10003910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003930	proc near		; DATA XREF: .data:10030184o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+1Ch]
		jmp	eax
sub_10003930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003950	proc near		; DATA XREF: .data:10030188o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	edx, [esp+arg_C]
		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		push	edx
		mov	edx, [esp+4+arg_8]
		push	edx
		mov	edx, [esp+8+arg_4]
		push	edx
		push	eax
		mov	eax, [ecx+20h]
		call	eax
		add	esp, 10h
		retn
sub_10003950	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003980	proc near		; DATA XREF: .data:1003018Co

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+24h]
		jmp	eax
sub_10003980	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100039A0	proc near		; DATA XREF: .data:10030190o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+28h]
		jmp	eax
sub_100039A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100039C0	proc near		; DATA XREF: .data:10030194o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+2Ch]
		jmp	eax
sub_100039C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100039E0	proc near		; DATA XREF: .data:10030198o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+30h]
		jmp	eax
sub_100039E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003A00	proc near		; DATA XREF: .data:100301E4o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+7Ch]
		jmp	eax
sub_10003A00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003A20	proc near		; DATA XREF: .data:100301A0o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+38h]
		jmp	eax
sub_10003A20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003A40	proc near		; DATA XREF: .data:100301A4o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+3Ch]
		jmp	eax
sub_10003A40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003A60	proc near		; DATA XREF: .data:100301A8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+40h]
		jmp	eax
sub_10003A60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003A80	proc near		; DATA XREF: .data:100301ACo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+44h]
		jmp	eax
sub_10003A80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003AA0	proc near		; DATA XREF: .data:100301B0o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+48h]
		jmp	eax
sub_10003AA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003AC0	proc near		; DATA XREF: .data:100301B4o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+4Ch]
		jmp	eax
sub_10003AC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003AE0	proc near		; DATA XREF: .data:100301B8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+50h]
		jmp	eax
sub_10003AE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003B00	proc near		; DATA XREF: .data:100301C4o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+5Ch]
		jmp	eax
sub_10003B00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003B20	proc near		; DATA XREF: .data:100301C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+60h]
		jmp	eax
sub_10003B20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003B40	proc near		; DATA XREF: .data:100301CCo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+64h]
		jmp	eax
sub_10003B40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003B60	proc near		; DATA XREF: .data:100301D8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+70h]
		jmp	eax
sub_10003B60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003B80	proc near		; DATA XREF: .data:100301DCo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+74h]
		jmp	eax
sub_10003B80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003BA0	proc near		; DATA XREF: .data:100301E0o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+78h]
		jmp	eax
sub_10003BA0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 146. PR_GetDefaultIOMethods

; =============== S U B	R O U T	I N E =======================================


		public PR_GetDefaultIOMethods
PR_GetDefaultIOMethods proc near	; CODE XREF: .text:10003723p
					; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, offset dword_10030168
		retn
PR_GetDefaultIOMethods endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  63. PR_CreateIOLayerStub

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateIOLayerStub
PR_CreateIOLayerStub proc near		; CODE XREF: _pr_push_ipv6toipv4_layer:loc_10003821p
					; PR_NewPollableEvent+4Ep
					; DATA XREF: ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		xor	esi, esi
		test	edi, edi
		jz	short loc_10003C1B
		cmp	edi, 0FFFFFFFEh
		jz	short loc_10003C1B
		push	18h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10003C06
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003C06:				; CODE XREF: PR_CreateIOLayerStub+21j
		mov	eax, [esp+8+arg_4]
		mov	[esi+14h], edi
		mov	[esi], eax
		pop	edi
		mov	dword ptr [esi+10h], offset loc_10003860
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003C1B:				; CODE XREF: PR_CreateIOLayerStub+Aj
					; PR_CreateIOLayerStub+Fj
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_CreateIOLayerStub endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  62. PR_CreateIOLayer

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateIOLayer
PR_CreateIOLayer proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		push	18h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		xor	ecx, ecx
		add	esp, 8
		cmp	esi, ecx
		jnz	short loc_10003C57
		push	ecx
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003C57:				; CODE XREF: PR_CreateIOLayer+13j
		mov	eax, [esp+4+arg_0]
		mov	[esi+8], eax
		mov	dword ptr [esi], offset	dword_10030168
		mov	dword ptr [esi+10h], offset loc_10003860
		mov	dword ptr [esi+14h], 0FFFFFFFDh
		mov	[esi+0Ch], ecx
		mov	[eax+0Ch], esi
		mov	[eax+8], ecx
		mov	eax, esi
		pop	esi
		retn
PR_CreateIOLayer endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 205. PR_GetUniqueIdentity

; =============== S U B	R O U T	I N E =======================================


		public PR_GetUniqueIdentity
PR_GetUniqueIdentity proc near		; CODE XREF: .text:10003716p
					; .text:10005235p
					; DATA XREF: ...

Memory		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebp
		push	esi
		xor	esi, esi
		xor	ebp, ebp
		push	edi
		mov	[esp+10h+Memory], esi
		cmp	dword_10031520,	esi
		jnz	short loc_10003C99
		call	PR_Init

loc_10003C99:				; CODE XREF: PR_GetUniqueIdentity+12j
		mov	edi, [esp+10h+arg_0]
		cmp	edi, esi
		jz	short loc_10003CEA
		mov	eax, edi
		lea	edx, [eax+1]

loc_10003CA6:				; CODE XREF: PR_GetUniqueIdentity+2Bj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10003CA6
		sub	eax, edx
		inc	eax
		push	eax		; Size
		call	PR_Malloc
		mov	ebp, eax
		add	esp, 4
		cmp	ebp, esi
		jnz	short loc_10003CD5
		push	esi
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10003CD5:				; CODE XREF: PR_GetUniqueIdentity+3Dj
		mov	edx, ebp
		mov	eax, edi
		sub	edx, edi
		jmp	short loc_10003CE0
; ---------------------------------------------------------------------------
		align 10h

loc_10003CE0:				; CODE XREF: PR_GetUniqueIdentity+5Bj
					; PR_GetUniqueIdentity+68j
		mov	cl, [eax]
		mov	[edx+eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_10003CE0

loc_10003CEA:				; CODE XREF: PR_GetUniqueIdentity+1Fj
		push	ebx
		jmp	short loc_10003CF0
; ---------------------------------------------------------------------------
		align 10h

loc_10003CF0:				; CODE XREF: PR_GetUniqueIdentity+6Bj
					; PR_GetUniqueIdentity+D2j ...
		mov	eax, dword_10030B28
		mov	edi, dword_10030B24
		inc	eax
		cmp	eax, edi
		jl	short loc_10003D1B
		add	edi, 10h
		lea	ecx, ds:0[edi*4]
		push	ecx		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10003D61

loc_10003D1B:				; CODE XREF: PR_GetUniqueIdentity+7Ej
		mov	edx, dword_10030B1C
		push	edx
		call	PR_Lock
		mov	ebx, dword_10030B28
		mov	eax, dword_10030B24
		inc	ebx
		add	esp, 4
		cmp	ebx, eax
		jl	short loc_10003DB5
		test	esi, esi
		jz	short loc_10003D42
		cmp	ebx, edi
		jl	short loc_10003D86

loc_10003D42:				; CODE XREF: PR_GetUniqueIdentity+BCj
		mov	eax, dword_10030B1C
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	esi, esi
		jz	short loc_10003CF0
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	esi, esi
		jmp	short loc_10003CF0
; ---------------------------------------------------------------------------

loc_10003D61:				; CODE XREF: PR_GetUniqueIdentity+99j
		test	ebp, ebp
		jz	short loc_10003D6E
		push	ebp		; Memory
		call	PR_Free
		add	esp, 4

loc_10003D6E:				; CODE XREF: PR_GetUniqueIdentity+E3j
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	ebx
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10003D86:				; CODE XREF: PR_GetUniqueIdentity+C0j
		mov	edx, Src
		lea	ecx, ds:0[eax*4]
		push	ecx		; Size
		push	edx		; Src
		push	esi		; Dst
		call	memcpy
		mov	eax, Src
		add	esp, 0Ch
		mov	Src, esi
		mov	[esp+14h+Memory], eax
		mov	dword_10030B24,	edi
		xor	esi, esi

loc_10003DB5:				; CODE XREF: PR_GetUniqueIdentity+B8j
		test	ebp, ebp
		jz	short loc_10003DC2
		mov	ecx, Src
		mov	[ecx+ebx*4], ebp

loc_10003DC2:				; CODE XREF: PR_GetUniqueIdentity+137j
		mov	edx, dword_10030B1C
		push	edx		; lpTlsValue
		mov	dword_10030B28,	ebx
		call	PR_Unlock
		mov	eax, [esp+18h+Memory]
		add	esp, 4
		test	eax, eax
		jz	short loc_10003DE8
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_10003DE8:				; CODE XREF: PR_GetUniqueIdentity+15Dj
		test	esi, esi
		jz	short loc_10003DF5
		push	esi		; Memory
		call	PR_Free
		add	esp, 4

loc_10003DF5:				; CODE XREF: PR_GetUniqueIdentity+16Aj
		mov	eax, ebx
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
PR_GetUniqueIdentity endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 170. PR_GetNameForIdentity

; =============== S U B	R O U T	I N E =======================================


		public PR_GetNameForIdentity
PR_GetNameForIdentity proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_10003E0E
		call	PR_Init

loc_10003E0E:				; CODE XREF: PR_GetNameForIdentity+7j
		mov	eax, [esp+arg_0]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10003E1A

loc_10003E17:				; CODE XREF: PR_GetNameForIdentity+20j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10003E1A:				; CODE XREF: PR_GetNameForIdentity+15j
		cmp	eax, dword_10030B28
		jg	short loc_10003E17
		mov	ecx, Src
		mov	eax, [ecx+eax*4]
		retn
PR_GetNameForIdentity endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 164. PR_GetLayersIdentity

; =============== S U B	R O U T	I N E =======================================


		public PR_GetLayersIdentity
PR_GetLayersIdentity proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+14h]
		cmp	eax, 0FFFFFFFDh
		jnz	short locret_10003E42
		mov	eax, [ecx+8]
		mov	eax, [eax+14h]

locret_10003E42:			; CODE XREF: PR_GetLayersIdentity+Aj
		retn
PR_GetLayersIdentity endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 161. PR_GetIdentitiesLayer

; =============== S U B	R O U T	I N E =======================================


		public PR_GetIdentitiesLayer
PR_GetIdentitiesLayer proc near		; CODE XREF: .text:100018E1p
					; PR_CancelWaitFileDesc+7Fp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		cmp	edx, 0FFFFFFFEh
		jnz	short loc_10003E67
		mov	eax, [esp+arg_0]
		cmp	dword ptr [eax+14h], 0FFFFFFFDh
		jnz	short locret_10003E91
		mov	eax, [eax+8]
		retn
; ---------------------------------------------------------------------------

loc_10003E67:				; CODE XREF: PR_GetIdentitiesLayer+7j
		mov	ecx, [esp+arg_0]
		mov	eax, ecx
		test	ecx, ecx
		jz	short loc_10003E7D

loc_10003E71:				; CODE XREF: PR_GetIdentitiesLayer+2Bj
		cmp	edx, [eax+14h]
		jz	short locret_10003E91
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_10003E71

loc_10003E7D:				; CODE XREF: PR_GetIdentitiesLayer+1Fj
		mov	eax, ecx
		test	ecx, ecx
		jz	short loc_10003E8F

loc_10003E83:				; CODE XREF: PR_GetIdentitiesLayer+3Dj
		cmp	edx, [eax+14h]
		jz	short locret_10003E91
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_10003E83

loc_10003E8F:				; CODE XREF: PR_GetIdentitiesLayer+31j
		xor	eax, eax

locret_10003E91:			; CODE XREF: PR_GetIdentitiesLayer+11j
					; PR_GetIdentitiesLayer+24j ...
		retn
PR_GetIdentitiesLayer endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003EA0	proc near		; CODE XREF: PR_Init_0+E9p
		xor	eax, eax
		mov	dword_10030B1C,	eax
		mov	Src, eax
		mov	dword_10030B24,	eax
		mov	dword_10030B28,	eax
		call	PR_NewLock
		mov	dword_10030B1C,	eax
		retn
sub_10003EA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10003ED0	proc near		; CODE XREF: PR_Cleanup+165p
		mov	eax, dword_10030B1C
		test	eax, eax
		jz	short loc_10003EEC
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10030B1C,	0

loc_10003EEC:				; CODE XREF: sub_10003ED0+7j
		cmp	Src, 0
		jz	short locret_10003F40
		push	esi
		xor	esi, esi
		cmp	dword_10030B28,	esi
		jl	short loc_10003F27

loc_10003F00:				; CODE XREF: sub_10003ED0+55j
		mov	eax, Src
		mov	ecx, [eax+esi*4]
		push	ecx		; Memory
		call	PR_Free
		mov	edx, Src
		mov	dword ptr [edx+esi*4], 0
		inc	esi
		add	esp, 4
		cmp	esi, dword_10030B28
		jle	short loc_10003F00

loc_10003F27:				; CODE XREF: sub_10003ED0+2Ej
		mov	eax, Src
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	Src, 0
		pop	esi

locret_10003F40:			; CODE XREF: sub_10003ED0+23j
		retn
sub_10003ED0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 289. PR_PushIOLayer

; =============== S U B	R O U T	I N E =======================================


		public PR_PushIOLayer
PR_PushIOLayer	proc near		; CODE XREF: sub_10003420+CAp
					; sub_10003510+B7p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		sub	esp, 18h
		cmp	edx, 0FFFFFFFEh
		jnz	short loc_10003F6F
		cmp	dword ptr [ecx+14h], 0FFFFFFFDh
		jnz	short loc_10003F6B
		mov	edx, [ecx+8]
		jmp	short loc_10003FA2
; ---------------------------------------------------------------------------

loc_10003F6B:				; CODE XREF: PR_PushIOLayer+14j
		mov	edx, ecx
		jmp	short loc_10003FA2
; ---------------------------------------------------------------------------

loc_10003F6F:				; CODE XREF: PR_PushIOLayer+Ej
		mov	eax, ecx
		test	ecx, ecx
		jz	short loc_10003F85

loc_10003F75:				; CODE XREF: PR_PushIOLayer+33j
		cmp	edx, [eax+14h]
		jz	loc_10004035
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_10003F75

loc_10003F85:				; CODE XREF: PR_PushIOLayer+23j
		mov	eax, ecx
		test	ecx, ecx
		jz	short loc_10003FA0
		jmp	short loc_10003F90
; ---------------------------------------------------------------------------
		align 10h

loc_10003F90:				; CODE XREF: PR_PushIOLayer+3Bj
					; PR_PushIOLayer+4Ej
		cmp	edx, [eax+14h]
		jz	loc_10004035
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_10003F90

loc_10003FA0:				; CODE XREF: PR_PushIOLayer+39j
		xor	edx, edx

loc_10003FA2:				; CODE XREF: PR_PushIOLayer+19j
					; PR_PushIOLayer+1Dj ...
		test	ecx, ecx
		jz	loc_10004054
		mov	eax, [esp+18h+arg_8]
		test	eax, eax
		jz	loc_10004054
		test	edx, edx
		jz	loc_10004054
		cmp	ecx, edx
		jnz	short loc_1000403C
		mov	edx, [ecx]
		push	ebx
		push	ebp
		mov	ebp, [ecx+10h]
		mov	[esp+20h+var_8], ebp
		mov	ebp, [ecx+14h]
		mov	[esp+20h+var_4], ebp
		mov	ebp, [eax]
		push	esi
		mov	esi, [ecx+4]
		push	edi
		mov	edi, [ecx+8]
		mov	[ecx], ebp
		mov	ebp, [eax+4]
		mov	[ecx+4], ebp
		mov	ebp, [eax+8]
		mov	[ecx+8], ebp
		mov	ebp, [eax+0Ch]
		mov	[ecx+0Ch], ebp
		mov	ebp, [eax+10h]
		mov	[ecx+10h], ebp
		mov	ebp, [eax+14h]
		mov	[ecx+14h], ebp
		mov	[eax], edx
		mov	edx, [esp+28h+var_8]
		mov	[eax+4], esi
		mov	[eax+8], edi
		mov	[eax+10h], edx
		mov	edx, [esp+28h+var_4]
		pop	edi
		mov	[eax+14h], edx
		mov	edx, [eax+8]
		pop	esi
		pop	ebp
		mov	[eax+0Ch], ecx
		pop	ebx
		test	edx, edx
		jz	short loc_10004025
		mov	[edx+0Ch], eax

loc_10004025:				; CODE XREF: PR_PushIOLayer+D0j
		mov	[ecx+8], eax
		mov	dword ptr [ecx+0Ch], 0
		xor	eax, eax
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10004035:				; CODE XREF: PR_PushIOLayer+28j
					; PR_PushIOLayer+43j
		mov	edx, eax
		jmp	loc_10003FA2
; ---------------------------------------------------------------------------

loc_1000403C:				; CODE XREF: PR_PushIOLayer+70j
		mov	[eax+8], edx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+0Ch]
		mov	[ecx+8], eax
		mov	[edx+0Ch], eax
		xor	eax, eax
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10004054:				; CODE XREF: PR_PushIOLayer+54j
					; PR_PushIOLayer+60j ...
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		add	esp, 18h
		retn
PR_PushIOLayer	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 281. PR_PopIOLayer

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_PopIOLayer(void *Memory, int)
		public PR_PopIOLayer
PR_PopIOLayer	proc near		; CODE XREF: sub_100041C0:loc_10004202p
					; sub_10005390+9p
					; DATA XREF: ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
Memory		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		mov	eax, [esp+Memory]
		sub	esp, 18h
		push	esi
		push	edi
		xor	edi, edi
		lea	edx, [edi-3]
		cmp	ecx, 0FFFFFFFEh
		jnz	short loc_10004095
		cmp	[eax+14h], edx
		jnz	short loc_10004091
		mov	esi, [eax+8]
		jmp	short loc_100040C0
; ---------------------------------------------------------------------------

loc_10004091:				; CODE XREF: PR_PopIOLayer+1Aj
		mov	esi, eax
		jmp	short loc_100040C0
; ---------------------------------------------------------------------------

loc_10004095:				; CODE XREF: PR_PopIOLayer+15j
		mov	esi, eax
		cmp	eax, edi
		jz	short loc_100040AC
		jmp	short loc_100040A0
; ---------------------------------------------------------------------------
		align 10h

loc_100040A0:				; CODE XREF: PR_PopIOLayer+2Bj
					; PR_PopIOLayer+3Aj
		cmp	ecx, [esi+14h]
		jz	short loc_100040C0
		mov	esi, [esi+8]
		cmp	esi, edi
		jnz	short loc_100040A0

loc_100040AC:				; CODE XREF: PR_PopIOLayer+29j
		mov	esi, eax
		cmp	eax, edi
		jz	short loc_100040BE

loc_100040B2:				; CODE XREF: PR_PopIOLayer+4Cj
		cmp	ecx, [esi+14h]
		jz	short loc_100040C0
		mov	esi, [esi+0Ch]
		cmp	esi, edi
		jnz	short loc_100040B2

loc_100040BE:				; CODE XREF: PR_PopIOLayer+40j
		xor	esi, esi

loc_100040C0:				; CODE XREF: PR_PopIOLayer+1Fj
					; PR_PopIOLayer+23j ...
		cmp	eax, edi
		jz	loc_1000419C
		cmp	ecx, edi
		jz	loc_1000419C
		cmp	esi, edi
		jz	loc_1000419C
		cmp	esi, eax
		jnz	short loc_10004153
		mov	esi, [eax+10h]
		mov	edi, [eax+8]
		mov	ecx, [eax]
		mov	edx, [eax+4]
		mov	[esp+20h+var_8], esi
		mov	esi, [eax+14h]
		push	ebx
		mov	ebx, [eax+0Ch]
		push	ebp
		mov	[esp+28h+var_4], esi
		mov	esi, edi
		mov	ebp, [esi]
		mov	[eax], ebp
		mov	ebp, [esi+4]
		mov	[eax+4], ebp
		mov	ebp, [esi+8]
		mov	[eax+8], ebp
		mov	ebp, [esi+0Ch]
		mov	[eax+0Ch], ebp
		mov	ebp, [esi+10h]
		mov	[eax+10h], ebp
		mov	ebp, [esi+14h]
		mov	[eax+14h], ebp
		mov	[esi], ecx
		mov	ecx, [esp+28h+var_8]
		mov	[esi+4], edx
		mov	edx, [esp+28h+var_4]
		mov	[esi+8], edi
		mov	[esi+0Ch], ebx
		mov	[esi+10h], ecx
		mov	[esi+14h], edx
		mov	ecx, [eax+8]
		xor	edi, edi
		pop	ebp
		mov	[eax+0Ch], edi
		pop	ebx
		cmp	ecx, edi
		jz	short loc_1000418E
		mov	[ecx+0Ch], eax
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10004153:				; CODE XREF: PR_PopIOLayer+6Aj
		cmp	[eax+14h], edx
		jnz	short loc_1000417C
		cmp	esi, [eax+8]
		jnz	short loc_1000417C
		cmp	[esi+8], edi
		jnz	short loc_1000417C
		push	eax		; Memory
		mov	[eax+8], edi
		call	PR_Free
		add	esp, 4
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000417C:				; CODE XREF: PR_PopIOLayer+E6j
					; PR_PopIOLayer+EBj ...
		mov	eax, [esi+8]
		mov	ecx, [esi+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [esi+0Ch]
		mov	eax, [esi+8]
		mov	[edx+8], eax

loc_1000418E:				; CODE XREF: PR_PopIOLayer+D0j
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000419C:				; CODE XREF: PR_PopIOLayer+52j
					; PR_PopIOLayer+5Aj ...
		push	edi
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 18h
		retn
PR_PopIOLayer	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100041C0(void	*Memory)
sub_100041C0	proc near		; DATA XREF: .data:1003016Co

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	ecx, 0FFFFFFFDh
		cmp	[esi+14h], ecx
		jnz	short loc_100041EB
		mov	eax, [esi+8]
		mov	ecx, [eax]
		mov	edx, [ecx+4]
		push	edi
		push	eax
		call	edx
		push	esi		; Memory
		mov	edi, eax
		call	PR_Free
		add	esp, 8
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100041EB:				; CODE XREF: sub_100041C0+Dj
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_100041FF
		cmp	[eax+14h], ecx
		jnz	short loc_100041FF
		mov	esi, [esi+8]
		push	0FFFFFFFEh
		push	eax
		jmp	short loc_10004202
; ---------------------------------------------------------------------------

loc_100041FF:				; CODE XREF: sub_100041C0+30j
					; sub_100041C0+35j
		push	0FFFFFFFEh	; int
		push	esi		; Memory

loc_10004202:				; CODE XREF: sub_100041C0+3Dj
		call	PR_PopIOLayer
		push	eax
		mov	eax, [eax+10h]
		call	eax
		mov	ecx, [esi]
		mov	edx, [ecx+4]
		push	esi
		call	edx
		add	esp, 10h
		pop	esi
		retn
sub_100041C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10004220	proc near		; DATA XREF: .data:1003019Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	ecx, [edi+0Ch]
		mov	eax, edi
		test	ecx, ecx
		jz	short loc_10004239

loc_10004230:				; CODE XREF: sub_10004220+17j
		mov	eax, ecx
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jnz	short loc_10004230

loc_10004239:				; CODE XREF: sub_10004220+Ej
		xor	ebx, ebx
		cmp	dword ptr [eax+14h], 0FFFFFFFDh
		push	18h		; Size
		setz	bl
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10004266
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10004266:				; CODE XREF: sub_10004220+30j
		mov	eax, [edi]
		mov	[esi], eax
		mov	ecx, [edi+4]
		mov	[esi+4], ecx
		mov	edx, [edi+8]
		mov	[esi+8], edx
		mov	eax, [edi+0Ch]
		mov	[esi+0Ch], eax
		mov	ecx, [edi+10h]
		mov	[esi+10h], ecx
		mov	edx, [edi+14h]
		mov	ecx, [esp+0Ch+arg_8]
		mov	[esi+14h], edx
		mov	edi, [edi+8]
		mov	edx, [esp+0Ch+arg_4]
		mov	eax, [edi]
		mov	eax, [eax+34h]
		push	ecx
		push	edx
		push	edi
		call	eax
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_100042B5
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100042B5:				; CODE XREF: sub_10004220+84j
		test	ebx, ebx
		jz	short loc_100042C5
		mov	[esi+8], edi
		mov	[edi+0Ch], esi
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100042C5:				; CODE XREF: sub_10004220+97j
		push	esi
		push	0FFFFFFFEh
		push	edi
		call	PR_PushIOLayer
		add	esp, 0Ch
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10004220	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100042E0	proc near		; DATA XREF: .data:100301C0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	ecx, [edi+0Ch]
		mov	eax, edi
		test	ecx, ecx
		jz	short loc_100042F9

loc_100042F0:				; CODE XREF: sub_100042E0+17j
		mov	eax, ecx
		mov	ecx, [eax+0Ch]
		test	ecx, ecx
		jnz	short loc_100042F0

loc_100042F9:				; CODE XREF: sub_100042E0+Ej
		xor	ecx, ecx
		cmp	dword ptr [eax+14h], 0FFFFFFFDh
		push	18h		; Size
		setz	cl
		mov	ebp, ecx
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10004329
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10004329:				; CODE XREF: sub_100042E0+32j
		mov	edx, [edi]
		mov	[esi], edx
		mov	eax, [edi+4]
		mov	[esi+4], eax
		mov	ecx, [edi+8]
		mov	[esi+8], ecx
		mov	edx, [edi+0Ch]
		mov	[esi+0Ch], edx
		mov	eax, [edi+10h]
		mov	[esi+10h], eax
		mov	ecx, [edi+14h]
		mov	eax, [esp+0Ch+arg_14]
		push	ebx
		mov	ebx, [esp+10h+arg_4]
		mov	[esi+14h], ecx
		mov	ecx, [esp+10h+arg_10]
		mov	edi, [edi+8]
		mov	edx, [edi]
		mov	edx, [edx+58h]
		push	eax
		mov	eax, [esp+14h+arg_C]
		push	ecx
		mov	ecx, [esp+18h+arg_8]
		push	eax
		push	ecx
		push	ebx
		push	edi
		call	edx
		mov	edi, eax
		add	esp, 18h
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_1000438A
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	ebx
		or	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1000438A:				; CODE XREF: sub_100042E0+98j
		test	ebp, ebp
		jz	short loc_100043A1
		mov	eax, [ebx]
		mov	[esi+8], eax
		mov	ecx, [ebx]
		mov	[ecx+0Ch], esi
		mov	[ebx], esi
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100043A1:				; CODE XREF: sub_100042E0+ACj
		mov	edx, [ebx]
		push	esi
		push	0FFFFFFFEh
		push	edx
		call	PR_PushIOLayer
		add	esp, 0Ch
		pop	ebx
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_100042E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100043C0	proc near		; CODE XREF: PR_NewLogModule+45p

var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
Str1		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+54h+var_4], eax
		mov	eax, [esp+54h+arg_0]
		push	edi
		push	offset aNspr_log_modul ; "NSPR_LOG_MODULES"
		mov	[esp+5Ch+var_50], eax
		call	PR_GetEnv
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	loc_100044C2
		cmp	byte ptr [edi],	0
		jz	loc_100044C2
		lea	edx, [eax+1]
		lea	ebx, [ebx+0]

loc_10004400:				; CODE XREF: sub_100043C0+45j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10004400
		sub	eax, edx
		push	esi
		xor	esi, esi
		mov	[esp+5Ch+var_48], eax
		test	eax, eax
		jle	loc_100044C1
		push	ebp
		mov	ebp, ds:sscanf
		nop

loc_10004420:				; CODE XREF: sub_100043C0+FAj
		lea	ecx, [esp+60h+var_54]
		push	ecx
		lea	edx, [esp+64h+var_4C]
		push	edx
		mov	eax, ecx
		push	eax
		lea	ecx, [esp+6Ch+Str1]
		push	ecx
		lea	edx, [esi+edi]
		push	offset a63Abcdefghijkl ; "%63[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghi"...
		push	edx		; Src
		mov	[esp+78h+var_4C], 1
		mov	[esp+78h+var_54], 0
		call	ebp ; sscanf
		add	esi, [esp+78h+var_54]
		add	esp, 18h
		test	eax, eax
		jz	short loc_100044C0
		cmp	[esp+60h+var_50], 0
		jz	short loc_1000449A
		lea	eax, [esp+60h+Str1]
		push	offset Str2	; "all"
		push	eax		; Str1
		call	ds:_stricmp
		add	esp, 8
		test	eax, eax
		jz	short loc_1000448F
		mov	ecx, [esp+60h+var_50]
		mov	edx, [ecx]
		push	edx		; Str2
		lea	eax, [esp+64h+Str1]
		push	eax		; Str1
		call	ds:_stricmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000449A

loc_1000448F:				; CODE XREF: sub_100043C0+B4j
		mov	ecx, [esp+60h+var_4C]
		mov	edx, [esp+60h+var_50]
		mov	[edx+4], ecx

loc_1000449A:				; CODE XREF: sub_100043C0+9Dj
					; sub_100043C0+CDj
		lea	eax, [esp+60h+var_54]
		push	eax
		lea	ecx, [esi+edi]
		push	offset aN	; " , %n"
		push	ecx		; Src
		call	ebp ; sscanf
		add	esi, [esp+6Ch+var_54]
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100044C0
		cmp	esi, [esp+60h+var_48]
		jl	loc_10004420

loc_100044C0:				; CODE XREF: sub_100043C0+96j
					; sub_100043C0+F4j
		pop	ebp

loc_100044C1:				; CODE XREF: sub_100043C0+52j
		pop	esi

loc_100044C2:				; CODE XREF: sub_100043C0+28j
					; sub_100043C0+31j
		mov	ecx, [esp+58h+var_4]
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
sub_100043C0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 253. PR_NewLogModule

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_NewLogModule(char *Src)
		public PR_NewLogModule
PR_NewLogModule	proc near		; CODE XREF: PR_CreateCounter+2Dp
					; PR_Init_0+26p ...

Src		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_100044EE
		call	PR_Init

loc_100044EE:				; CODE XREF: PR_NewLogModule+7j
		push	esi
		push	0Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000452F
		mov	eax, [esp+4+Src]
		push	eax		; Src
		call	ds:_strdup
		mov	ecx, dword_10030B38
		push	esi
		mov	[esi], eax
		mov	dword ptr [esi+4], 0
		mov	[esi+8], ecx
		mov	dword_10030B38,	esi
		call	sub_100043C0
		add	esp, 8
		mov	eax, esi

loc_1000452F:				; CODE XREF: PR_NewLogModule+1Fj
		pop	esi
		retn
PR_NewLogModule	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 330. PR_SetLogFile

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SetLogFile(char *Filename)
		public PR_SetLogFile
PR_SetLogFile	proc near		; CODE XREF: sub_10004F10+1DCp
					; DATA XREF: .rdata:off_1002C7C8o

Filename	= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Filename]
		mov	ecx, offset aWindebug ;	"WinDebug"
		mov	eax, esi
		lea	esp, [esp+0]

loc_10004550:				; CODE XREF: PR_SetLogFile+2Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10004570
		test	dl, dl
		jz	short loc_1000456C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10004570
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10004550

loc_1000456C:				; CODE XREF: PR_SetLogFile+18j
		xor	eax, eax
		jmp	short loc_10004575
; ---------------------------------------------------------------------------

loc_10004570:				; CODE XREF: PR_SetLogFile+14j
					; PR_SetLogFile+20j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10004575:				; CODE XREF: PR_SetLogFile+2Ej
		test	eax, eax
		jnz	short loc_1000457E
		lea	esi, [eax-2]
		jmp	short loc_100045B4
; ---------------------------------------------------------------------------

loc_1000457E:				; CODE XREF: PR_SetLogFile+37j
		cmp	dword_10030B48,	0
		mov	eax, offset Mode ; "a"
		jnz	short loc_10004591
		mov	eax, offset aW	; "w"

loc_10004591:				; CODE XREF: PR_SetLogFile+4Aj
		push	eax		; Mode
		push	esi		; Filename
		call	ds:fopen
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_100045A4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100045A4:				; CODE XREF: PR_SetLogFile+60j
		push	0		; Size
		push	4		; Mode
		push	0		; Buf
		push	esi		; File
		call	ds:setvbuf
		add	esp, 10h

loc_100045B4:				; CODE XREF: PR_SetLogFile+3Cj
		mov	eax, File
		test	eax, eax
		jz	short loc_100045E0
		mov	ecx, ds:_iob
		lea	edx, [ecx+20h]
		cmp	eax, edx
		jz	short loc_100045E0
		add	ecx, 40h
		cmp	eax, ecx
		jz	short loc_100045E0
		cmp	eax, 0FFFFFFFEh
		jz	short loc_100045E0
		push	eax		; File
		call	ds:fclose
		add	esp, 4

loc_100045E0:				; CODE XREF: PR_SetLogFile+7Bj
					; PR_SetLogFile+88j ...
		mov	File, esi
		mov	eax, 1
		pop	esi
		retn
PR_SetLogFile	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 236. PR_LogFlush

; =============== S U B	R O U T	I N E =======================================


		public PR_LogFlush
PR_LogFlush	proc near		; CODE XREF: sub_100047A0+8p
					; PR_SetLogBufferingp ...

var_4		= dword	ptr -4

		push	ecx
		cmp	Str, 0
		jz	loc_10004796
		cmp	File, 0
		jz	loc_10004796
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	edi, TlsIndex
		mov	esi, eax
		test	byte ptr [esi+90h], 80h
		jnz	short loc_1000467C
		cmp	dword_1003067C,	0
		jz	short loc_1000463E
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edi*4]
		mov	ebp, [ecx+10h]
		jmp	short loc_1000464D
; ---------------------------------------------------------------------------

loc_1000463E:				; CODE XREF: PR_LogFlush+3Bj
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	ebp, eax

loc_1000464D:				; CODE XREF: PR_LogFlush+4Cj
		cmp	dword_1003067C,	0
		jz	short loc_1000466B
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edi*4]
		mov	dword ptr [ecx+10h], 1
		jmp	short loc_10004680
; ---------------------------------------------------------------------------

loc_1000466B:				; CODE XREF: PR_LogFlush+64j
		mov	edx, dwTlsIndex
		push	1		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue
		jmp	short loc_10004680
; ---------------------------------------------------------------------------

loc_1000467C:				; CODE XREF: PR_LogFlush+32j
		mov	ebp, [esp+10h+var_4]

loc_10004680:				; CODE XREF: PR_LogFlush+79j
					; PR_LogFlush+8Aj
		mov	eax, dword_10030B30
		add	eax, 1Ch
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, Dst
		mov	ecx, Str
		cmp	eax, ecx
		jbe	short loc_100046E8
		mov	edx, File
		cmp	edx, 0FFFFFFFEh
		jnz	short loc_100046C1
		push	ebx
		mov	bl, [eax]
		push	ecx		; lpOutputString
		mov	byte ptr [eax],	0
		call	ds:OutputDebugStringA
		mov	ecx, Dst
		mov	[ecx], bl
		pop	ebx
		jmp	short loc_100046DE
; ---------------------------------------------------------------------------

loc_100046C1:				; CODE XREF: PR_LogFlush+B7j
		push	edx		; File
		sub	eax, ecx
		push	eax		; Count
		push	1		; Size
		push	ecx		; Str
		call	ds:fwrite
		mov	edx, File
		push	edx		; File
		call	ds:fflush
		add	esp, 14h

loc_100046DE:				; CODE XREF: PR_LogFlush+CFj
		mov	eax, Str
		mov	Dst, eax

loc_100046E8:				; CODE XREF: PR_LogFlush+ACj
		mov	ecx, dword_10030B30
		add	ecx, 1Ch
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	byte ptr [esi+90h], 80h
		jnz	loc_10004793
		test	ebp, ebp
		jnz	short loc_10004767
		cmp	dword_1003067C,	ebp
		jz	short loc_10004723
		mov	edx, large fs:2Ch
		mov	eax, [edx+edi*4]
		mov	eax, [eax+14h]
		jmp	short loc_10004730
; ---------------------------------------------------------------------------

loc_10004723:				; CODE XREF: PR_LogFlush+11Fj
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10004730:				; CODE XREF: PR_LogFlush+131j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10004767
		cmp	dword_1003067C,	0
		jz	short loc_10004751
		mov	edx, large fs:2Ch
		mov	eax, [edx+edi*4]
		mov	eax, [eax+14h]
		jmp	short loc_1000475E
; ---------------------------------------------------------------------------

loc_10004751:				; CODE XREF: PR_LogFlush+14Dj
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1000475E:				; CODE XREF: PR_LogFlush+15Fj
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10004767:				; CODE XREF: PR_LogFlush+117j
					; PR_LogFlush+144j
		cmp	dword_1003067C,	0
		jz	short loc_10004785
		mov	edx, large fs:2Ch
		mov	eax, [edx+edi*4]
		pop	edi
		pop	esi
		mov	[eax+10h], ebp
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10004785:				; CODE XREF: PR_LogFlush+17Ej
		mov	ecx, dwTlsIndex
		push	ebp		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10004793:				; CODE XREF: PR_LogFlush+10Fj
		pop	edi
		pop	esi
		pop	ebp

loc_10004796:				; CODE XREF: PR_LogFlush+8j
					; PR_LogFlush+15j
		pop	ecx
		retn
PR_LogFlush	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100047A0	proc near		; CODE XREF: PR_Cleanup:loc_1000D4B8p
		push	ebp
		push	esi
		mov	esi, dword_10030B38
		call	PR_LogFlush
		mov	eax, File
		xor	ebp, ebp
		cmp	eax, ebp
		jz	short loc_100047DB
		mov	ecx, ds:_iob
		lea	edx, [ecx+20h]
		cmp	eax, edx
		jz	short loc_100047DB
		add	ecx, 40h
		cmp	eax, ecx
		jz	short loc_100047DB
		cmp	eax, 0FFFFFFFEh
		jz	short loc_100047DB
		push	eax		; File
		call	ds:fclose
		add	esp, 4

loc_100047DB:				; CODE XREF: sub_100047A0+16j
					; sub_100047A0+23j ...
		mov	eax, Str
		mov	File, ebp
		cmp	eax, ebp
		jz	short loc_100047F9
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	Str, ebp

loc_100047F9:				; CODE XREF: sub_100047A0+48j
		cmp	esi, ebp
		jz	short loc_1000481E
		push	ebx
		mov	ebx, ds:free
		push	edi

loc_10004805:				; CODE XREF: sub_100047A0+7Aj
		mov	eax, [esi]
		mov	edi, [esi+8]
		push	eax		; Memory
		call	ebx ; free
		push	esi		; Memory
		call	PR_Free
		add	esp, 8
		mov	esi, edi
		cmp	edi, ebp
		jnz	short loc_10004805
		pop	edi
		pop	ebx

loc_1000481E:				; CODE XREF: sub_100047A0+5Bj
		mov	eax, dword_10030B30
		mov	dword_10030B38,	ebp
		cmp	eax, ebp
		jz	short loc_1000483C
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10030B30,	ebp

loc_1000483C:				; CODE XREF: sub_100047A0+8Bj
		pop	esi
		pop	ebp
		retn
sub_100047A0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 329. PR_SetLogBuffering

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SetLogBuffering(size_t	Size)
		public PR_SetLogBuffering
PR_SetLogBuffering proc	near		; CODE XREF: sub_10004F10+1BCp
					; DATA XREF: .rdata:off_1002C7C8o

Size		= dword	ptr  4

		call	PR_LogFlush
		mov	eax, Str
		test	eax, eax
		jz	short loc_10004861
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	Str, 0

loc_10004861:				; CODE XREF: PR_SetLogBuffering+Cj
		push	esi
		mov	esi, [esp+4+Size]
		cmp	esi, 200h
		jl	short loc_10004888
		push	esi		; Size
		call	PR_Malloc
		add	esp, 4
		mov	Str, eax
		mov	Dst, eax
		add	eax, esi
		mov	dword_10030B2C,	eax

loc_10004888:				; CODE XREF: PR_SetLogBuffering+2Cj
		pop	esi
		retn
PR_SetLogBuffering endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 237. PR_LogPrint

; =============== S U B	R O U T	I N E =======================================


		public PR_LogPrint
PR_LogPrint	proc near		; CODE XREF: PR_Abort+5p PR_Assert+17p ...

lpOutputString	= dword	ptr -23Ch
lpTlsValue	= dword	ptr -238h
var_234		= dword	ptr -234h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_220		= dword	ptr -220h
var_21C		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_214		= word ptr -214h
var_205		= byte ptr -205h
OutputString	= byte ptr -204h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		sub	esp, 23Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+23Ch+var_4], eax
		push	edi
		xor	edi, edi
		cmp	dword_10031520,	edi
		jnz	short loc_100048B4
		call	PR_Init

loc_100048B4:				; CODE XREF: PR_LogPrint+1Dj
		cmp	File, edi
		jz	loc_10004E65
		cmp	dword_10030B44,	edi
		jz	short loc_1000491C
		lea	eax, [esp+240h+var_22C]
		push	eax
		push	offset PR_GMTParameters
		call	PR_Now
		push	edx
		push	eax
		call	PR_ExplodeTime
		mov	ecx, [esp+250h+var_22C]
		mov	edx, [esp+250h+var_228]
		mov	eax, [esp+250h+var_224]
		push	ecx
		mov	ecx, [esp+254h+var_220]
		push	edx
		mov	edx, [esp+258h+var_21C]
		push	eax
		mov	eax, [esp+25Ch+var_218]
		push	ecx
		movsx	ecx, [esp+260h+var_214]
		push	edx
		inc	eax
		push	eax
		push	ecx
		push	offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d.%06d UTC "...
		lea	edx, [esp+270h+OutputString]
		push	1FFh
		push	edx
		call	PR_snprintf
		add	esp, 38h
		mov	edi, eax

loc_1000491C:				; CODE XREF: PR_LogPrint+36j
		call	PR_GetCurrentThread
		test	eax, eax
		jz	short loc_1000492D
		mov	ecx, [eax+8Ch]
		jmp	short loc_1000492F
; ---------------------------------------------------------------------------

loc_1000492D:				; CODE XREF: PR_LogPrint+93j
		xor	ecx, ecx

loc_1000492F:				; CODE XREF: PR_LogPrint+9Bj
		push	ebx
		push	ebp
		push	esi
		push	eax
		push	ecx
		mov	eax, 1FFh
		push	offset aLdP	; "%ld[%p]: "
		sub	eax, edi
		push	eax
		lea	ecx, [esp+edi+25Ch+OutputString]
		push	ecx
		call	PR_snprintf
		add	edi, eax
		mov	eax, [esp+260h+arg_0]
		lea	edx, [esp+260h+arg_4]
		push	edx
		push	eax
		mov	ecx, 1FFh
		sub	ecx, edi
		lea	ebx, [esp+edi+268h+OutputString]
		push	ecx
		push	ebx
		mov	[esp+270h+var_234], ebx
		call	PR_vsnprintf
		lea	esi, [edi+eax]
		add	esp, 24h
		cmp	esi, 1FEh
		jnz	loc_10004C48
		mov	eax, [esp+24Ch+arg_0]
		lea	edx, [esp+24Ch+arg_4]
		push	edx
		push	eax
		call	PR_vsmprintf
		add	esp, 8
		mov	[esp+24Ch+lpOutputString], eax
		test	eax, eax
		jz	loc_10004C4C
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_100049B0:				; CODE XREF: PR_LogPrint+125j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100049B0
		sub	eax, edx
		mov	esi, eax
		call	PR_AssertCurrentThreadOwnsLock_0
		test	byte ptr [eax+90h], 80h
		mov	[esp+24Ch+var_230], eax
		jnz	short loc_10004A35
		cmp	dword_1003067C,	0
		jz	short loc_100049F2
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	ecx, [eax+10h]
		mov	[esp+24Ch+lpTlsValue], ecx
		jmp	short loc_10004A03
; ---------------------------------------------------------------------------

loc_100049F2:				; CODE XREF: PR_LogPrint+144j
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+24Ch+lpTlsValue], eax

loc_10004A03:				; CODE XREF: PR_LogPrint+160j
		cmp	dword_1003067C,	0
		jz	short loc_10004A27
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	dword ptr [edx+10h], 1
		jmp	short loc_10004A35
; ---------------------------------------------------------------------------

loc_10004A27:				; CODE XREF: PR_LogPrint+17Aj
		mov	eax, dwTlsIndex
		push	1		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_10004A35:				; CODE XREF: PR_LogPrint+13Bj
					; PR_LogPrint+195j
		mov	ecx, dword_10030B30
		add	ecx, 1Ch
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, Str
		mov	ebp, ds:fwrite
		test	eax, eax
		jz	short loc_10004AA8
		mov	ecx, File
		cmp	ecx, 0FFFFFFFEh
		jnz	short loc_10004A7F
		mov	ecx, Dst
		mov	bl, [ecx]
		push	eax		; lpOutputString
		mov	byte ptr [ecx],	0
		call	ds:OutputDebugStringA
		mov	edx, Dst
		mov	[edx], bl
		mov	ebx, [esp+24Ch+var_234]
		jmp	short loc_10004A9E
; ---------------------------------------------------------------------------

loc_10004A7F:				; CODE XREF: PR_LogPrint+1CDj
		push	ecx		; File
		mov	ecx, Dst
		sub	ecx, eax
		push	ecx		; Count
		push	1		; Size
		push	eax		; Str
		call	ebp ; fwrite
		mov	edx, File
		push	edx		; File
		call	ds:fflush
		add	esp, 14h

loc_10004A9E:				; CODE XREF: PR_LogPrint+1EDj
		mov	eax, Str
		mov	Dst, eax

loc_10004AA8:				; CODE XREF: PR_LogPrint+1C2j
		mov	eax, File
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10004ACA
		mov	bl, [ebx]
		mov	edi, [esp+24Ch+var_234]
		lea	ecx, [esp+24Ch+OutputString]
		push	ecx		; lpOutputString
		mov	byte ptr [edi],	0
		call	ds:OutputDebugStringA
		mov	[edi], bl
		jmp	short loc_10004AE4
; ---------------------------------------------------------------------------

loc_10004ACA:				; CODE XREF: PR_LogPrint+220j
		push	eax		; File
		push	edi		; Count
		lea	edx, [esp+254h+OutputString]
		push	1		; Size
		push	edx		; Str
		call	ebp ; fwrite
		mov	eax, File
		push	eax		; File
		call	ds:fflush
		add	esp, 14h

loc_10004AE4:				; CODE XREF: PR_LogPrint+238j
		mov	eax, File
		mov	edi, [esp+24Ch+lpOutputString]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10004B07
		mov	ecx, edi
		mov	bl, [esi+ecx]
		push	edi		; lpOutputString
		mov	byte ptr [esi+edi], 0
		call	ds:OutputDebugStringA
		mov	[esi+edi], bl
		jmp	short loc_10004B1E
; ---------------------------------------------------------------------------

loc_10004B07:				; CODE XREF: PR_LogPrint+260j
		push	eax		; File
		push	esi		; Count
		push	1		; Size
		push	edi		; Str
		call	ebp ; fwrite
		mov	edx, File
		push	edx		; File
		call	ds:fflush
		add	esp, 14h

loc_10004B1E:				; CODE XREF: PR_LogPrint+275j
		mov	al, 0Ah
		test	esi, esi
		jz	short loc_10004B2A
		cmp	[esi+edi-1], al
		jz	short loc_10004B70

loc_10004B2A:				; CODE XREF: PR_LogPrint+292j
		mov	byte ptr [esp+24Ch+lpOutputString], al
		mov	eax, File
		mov	byte ptr [esp+24Ch+lpOutputString+1], 0
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10004B54
		lea	eax, [esp+24Ch+lpOutputString]
		push	eax		; lpOutputString
		mov	byte ptr [esp+250h+lpOutputString+1], 0
		call	ds:OutputDebugStringA
		mov	byte ptr [esp+24Ch+lpOutputString+1], 0
		jmp	short loc_10004B70
; ---------------------------------------------------------------------------

loc_10004B54:				; CODE XREF: PR_LogPrint+2ABj
		push	eax		; File
		push	1		; Count
		lea	ecx, [esp+254h+lpOutputString]
		push	1		; Size
		push	ecx		; Str
		call	ebp ; fwrite
		mov	edx, File
		push	edx		; File
		call	ds:fflush
		add	esp, 14h

loc_10004B70:				; CODE XREF: PR_LogPrint+298j
					; PR_LogPrint+2C2j
		mov	eax, dword_10030B30
		add	eax, 1Ch
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [esp+24Ch+var_230]
		test	byte ptr [ecx+90h], 80h
		jnz	loc_10004C3A
		mov	esi, [esp+24Ch+lpTlsValue]
		test	esi, esi
		jnz	short loc_10004BFF
		cmp	dword_1003067C,	esi
		jz	short loc_10004BB7
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_10004BC4
; ---------------------------------------------------------------------------

loc_10004BB7:				; CODE XREF: PR_LogPrint+30Ej
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10004BC4:				; CODE XREF: PR_LogPrint+325j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10004BFF
		cmp	dword_1003067C,	0
		jz	short loc_10004BEA
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_10004BF6
; ---------------------------------------------------------------------------

loc_10004BEA:				; CODE XREF: PR_LogPrint+341j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_10004BF6:				; CODE XREF: PR_LogPrint+358j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10004BFF:				; CODE XREF: PR_LogPrint+306j
					; PR_LogPrint+338j
		cmp	dword_1003067C,	0
		jz	short loc_10004C2C
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		push	edi		; Memory
		mov	[eax+10h], esi
		call	PR_smprintf_free
		add	esp, 4
		jmp	loc_10004E5D
; ---------------------------------------------------------------------------

loc_10004C2C:				; CODE XREF: PR_LogPrint+376j
		mov	ecx, dwTlsIndex
		push	esi		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10004C3A:				; CODE XREF: PR_LogPrint+2FAj
		push	edi		; Memory
		call	PR_smprintf_free
		add	esp, 4
		jmp	loc_10004E5D
; ---------------------------------------------------------------------------

loc_10004C48:				; CODE XREF: PR_LogPrint+EFj
		test	esi, esi
		jz	short loc_10004C5E

loc_10004C4C:				; CODE XREF: PR_LogPrint+113j
		mov	al, 0Ah
		cmp	[esp+esi+24Ch+var_205],	al
		jz	short loc_10004C5E
		mov	[esp+esi+24Ch+OutputString], al
		inc	esi
		mov	[esp+esi+24Ch+OutputString], 0

loc_10004C5E:				; CODE XREF: PR_LogPrint+3BAj
					; PR_LogPrint+3C2j
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebp, eax
		test	byte ptr [ebp+90h], 80h
		jnz	short loc_10004CD6
		cmp	dword_1003067C,	0
		jz	short loc_10004C92
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	edx, [ecx+10h]
		mov	[esp+24Ch+lpTlsValue], edx
		jmp	short loc_10004CA2
; ---------------------------------------------------------------------------

loc_10004C92:				; CODE XREF: PR_LogPrint+3E5j
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+24Ch+lpTlsValue], eax

loc_10004CA2:				; CODE XREF: PR_LogPrint+400j
		cmp	dword_1003067C,	0
		jz	short loc_10004CC7
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	dword ptr [eax+10h], 1
		jmp	short loc_10004CD6
; ---------------------------------------------------------------------------

loc_10004CC7:				; CODE XREF: PR_LogPrint+419j
		mov	ecx, dwTlsIndex
		push	1		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10004CD6:				; CODE XREF: PR_LogPrint+3DCj
					; PR_LogPrint+435j
		mov	edx, dword_10030B30
		add	edx, 1Ch
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, Str
		test	eax, eax
		jnz	short loc_10004D37
		mov	eax, File
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10004D16
		mov	bl, [esp+esi+24Ch+OutputString]
		lea	esi, [esp+esi+24Ch+OutputString]
		lea	eax, [esp+24Ch+OutputString]
		push	eax		; lpOutputString
		mov	byte ptr [esi],	0
		call	ds:OutputDebugStringA
		mov	[esi], bl
		jmp	loc_10004DA2
; ---------------------------------------------------------------------------

loc_10004D16:				; CODE XREF: PR_LogPrint+467j
		push	eax		; File
		push	esi		; Count
		lea	ecx, [esp+254h+OutputString]
		push	1		; Size
		push	ecx		; Str
		call	ds:fwrite
		mov	edx, File
		push	edx		; File
		call	ds:fflush
		add	esp, 14h
		jmp	short loc_10004DA2
; ---------------------------------------------------------------------------

loc_10004D37:				; CODE XREF: PR_LogPrint+45Dj
		mov	edi, Dst
		lea	ecx, [edi+esi]
		cmp	ecx, dword_10030B2C
		jbe	short loc_10004D8B
		mov	ecx, File
		cmp	ecx, 0FFFFFFFEh
		jnz	short loc_10004D69
		mov	bl, [edi]
		push	eax		; lpOutputString
		mov	byte ptr [edi],	0
		call	ds:OutputDebugStringA
		mov	edx, Dst
		mov	[edx], bl
		jmp	short loc_10004D85
; ---------------------------------------------------------------------------

loc_10004D69:				; CODE XREF: PR_LogPrint+4C1j
		push	ecx		; File
		sub	edi, eax
		push	edi		; Count
		push	1		; Size
		push	eax		; Str
		call	ds:fwrite
		mov	eax, File
		push	eax		; File
		call	ds:fflush
		add	esp, 14h

loc_10004D85:				; CODE XREF: PR_LogPrint+4D7j
		mov	edi, Str

loc_10004D8B:				; CODE XREF: PR_LogPrint+4B6j
		push	esi		; Size
		lea	ecx, [esp+250h+OutputString]
		push	ecx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, esi
		mov	Dst, edi

loc_10004DA2:				; CODE XREF: PR_LogPrint+481j
					; PR_LogPrint+4A5j
		mov	edx, dword_10030B30
		add	edx, 1Ch
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	byte ptr [ebp+90h], 80h
		jnz	loc_10004E5D
		mov	esi, [esp+24Ch+lpTlsValue]
		test	esi, esi
		jnz	short loc_10004E2F
		cmp	dword_1003067C,	esi
		jz	short loc_10004DE6
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_10004DF2
; ---------------------------------------------------------------------------

loc_10004DE6:				; CODE XREF: PR_LogPrint+53Dj
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_10004DF2:				; CODE XREF: PR_LogPrint+554j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10004E2F
		cmp	dword_1003067C,	0
		jz	short loc_10004E19
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+14h]
		jmp	short loc_10004E26
; ---------------------------------------------------------------------------

loc_10004E19:				; CODE XREF: PR_LogPrint+56Fj
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10004E26:				; CODE XREF: PR_LogPrint+587j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10004E2F:				; CODE XREF: PR_LogPrint+535j
					; PR_LogPrint+566j
		cmp	dword_1003067C,	0
		jz	short loc_10004E4F
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	[ecx+10h], esi
		jmp	short loc_10004E5D
; ---------------------------------------------------------------------------

loc_10004E4F:				; CODE XREF: PR_LogPrint+5A6j
		mov	edx, dwTlsIndex
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10004E5D:				; CODE XREF: PR_LogPrint+397j
					; PR_LogPrint+3B3j ...
		call	PR_LogFlush
		pop	esi
		pop	ebp
		pop	ebx

loc_10004E65:				; CODE XREF: PR_LogPrint+2Aj
		mov	ecx, [esp+240h+var_4]
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 23Ch
		retn
PR_LogPrint	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  12. PR_Abort

; =============== S U B	R O U T	I N E =======================================


		public PR_Abort
PR_Abort	proc near		; CODE XREF: PR_SuspendAll:loc_1001B5F2p
					; PR_ResumeAll:loc_1001B91Dp ...
		push	offset aAborting ; "Aborting"
		call	PR_LogPrint
		add	esp, 4
		jmp	ds:abort
PR_Abort	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  19. PR_Assert

; =============== S U B	R O U T	I N E =======================================


		public PR_Assert
PR_Assert	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		mov	esi, [esp+8+arg_8]
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		push	esi
		push	edi
		push	ebx
		push	offset aAssertionFailu ; "Assertion failure: %s, at %s:%d\n"
		call	PR_LogPrint
		mov	eax, ds:_iob
		push	esi
		push	edi
		push	ebx
		add	eax, 40h
		push	offset aAssertionFailu ; "Assertion failure: %s, at %s:%d\n"
		push	eax		; File
		call	ds:fprintf
		mov	ecx, ds:_iob
		add	ecx, 40h
		push	ecx		; File
		call	ds:fflush
		add	esp, 28h
		call	ds:DebugBreak
		pop	edi
		pop	esi
		pop	ebx
		jmp	ds:abort
PR_Assert	endp

; ---------------------------------------------------------------------------
		db 1Bh dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


sub_10004F10	proc near		; CODE XREF: PR_Init_0+121p

var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
Str1		= byte ptr -44h
var_4		= dword	ptr -4

		sub	esp, 5Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+5Ch+var_4], eax
		push	esi
		call	PR_NewLock
		push	offset aNspr_log_modul ; "NSPR_LOG_MODULES"
		mov	dword_10030B30,	eax
		call	PR_GetEnv
		mov	esi, eax
		add	esp, 4
		mov	[esp+60h+var_54], esi
		test	esi, esi
		jz	loc_1000513B
		cmp	byte ptr [esi],	0
		jz	loc_1000513B
		push	ebp
		push	edi
		xor	edi, edi
		mov	[esp+68h+var_50], edi
		lea	edx, [eax+1]

loc_10004F58:				; CODE XREF: sub_10004F10+4Dj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10004F58
		sub	eax, edx
		xor	ebp, ebp
		mov	[esp+68h+var_48], eax
		mov	[esp+68h+var_4C], 4000h
		test	eax, eax
		jle	loc_100050C1
		push	ebx
		mov	ebx, ds:_stricmp
		mov	edi, edi

loc_10004F80:				; CODE XREF: sub_10004F10+1A6j
		lea	eax, [esp+6Ch+var_5C]
		push	eax
		lea	ecx, [esp+70h+var_58]
		push	ecx
		mov	edx, eax
		push	edx
		lea	eax, [esp+78h+Str1]
		push	eax
		lea	ecx, [esi+ebp]
		push	offset a63Abcdefghijkl ; "%63[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghi"...
		mov	edi, 1
		push	ecx		; Src
		mov	[esp+84h+var_58], edi
		mov	[esp+84h+var_5C], 0
		call	ds:sscanf
		add	ebp, [esp+84h+var_5C]
		add	esp, 18h
		test	eax, eax
		jz	loc_100050BC
		lea	edx, [esp+6Ch+Str1]
		push	offset aSync	; "sync"
		push	edx		; Str1
		call	ebx ; _stricmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_10004FDD
		mov	[esp+6Ch+var_50], edi
		jmp	loc_10005092
; ---------------------------------------------------------------------------

loc_10004FDD:				; CODE XREF: sub_10004F10+C2j
		lea	eax, [esp+6Ch+Str1]
		push	offset aBufsize	; "bufsize"
		push	eax		; Str1
		call	ebx ; _stricmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_10005008
		mov	eax, [esp+6Ch+var_58]
		cmp	eax, 200h
		jl	loc_10005092
		mov	[esp+6Ch+var_4C], eax
		jmp	loc_10005092
; ---------------------------------------------------------------------------

loc_10005008:				; CODE XREF: sub_10004F10+DEj
		lea	ecx, [esp+6Ch+Str1]
		push	offset aTimestamp ; "timestamp"
		push	ecx		; Str1
		call	ebx ; _stricmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_10005023
		mov	dword_10030B44,	edi
		jmp	short loc_10005092
; ---------------------------------------------------------------------------

loc_10005023:				; CODE XREF: sub_10004F10+109j
		lea	edx, [esp+6Ch+Str1]
		push	offset aAppend	; "append"
		push	edx		; Str1
		call	ebx ; _stricmp
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000503E
		mov	dword_10030B48,	edi
		jmp	short loc_10005092
; ---------------------------------------------------------------------------

loc_1000503E:				; CODE XREF: sub_10004F10+124j
		mov	edi, dword_10030B38
		lea	eax, [esp+6Ch+Str1]
		push	offset Str2	; "all"
		push	eax		; Str1
		call	ebx ; _stricmp
		add	esp, 8
		mov	esi, eax
		neg	esi
		sbb	esi, esi
		inc	esi
		test	edi, edi
		jz	short loc_1000508E
		mov	edi, edi

loc_10005060:				; CODE XREF: sub_10004F10+173j
		test	esi, esi
		jz	short loc_1000506D
		mov	ecx, [esp+6Ch+var_58]
		mov	[edi+4], ecx
		jmp	short loc_1000507E
; ---------------------------------------------------------------------------

loc_1000506D:				; CODE XREF: sub_10004F10+152j
		mov	edx, [edi]
		push	edx		; Str2
		lea	eax, [esp+70h+Str1]
		push	eax		; Str1
		call	ebx ; _stricmp
		add	esp, 8
		test	eax, eax
		jz	short loc_10005087

loc_1000507E:				; CODE XREF: sub_10004F10+15Bj
		mov	edi, [edi+8]
		test	edi, edi
		jnz	short loc_10005060
		jmp	short loc_1000508E
; ---------------------------------------------------------------------------

loc_10005087:				; CODE XREF: sub_10004F10+16Cj
		mov	ecx, [esp+6Ch+var_58]
		mov	[edi+4], ecx

loc_1000508E:				; CODE XREF: sub_10004F10+14Cj
					; sub_10004F10+175j
		mov	esi, [esp+6Ch+var_54]

loc_10005092:				; CODE XREF: sub_10004F10+C8j
					; sub_10004F10+E9j ...
		lea	edx, [esp+6Ch+var_5C]
		push	edx
		lea	eax, [esi+ebp]
		push	offset aN	; " , %n"
		push	eax		; Src
		call	ds:sscanf
		add	ebp, [esp+78h+var_5C]
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100050BC
		cmp	ebp, [esp+6Ch+var_48]
		jl	loc_10004F80

loc_100050BC:				; CODE XREF: sub_10004F10+ABj
					; sub_10004F10+1A0j
		mov	edi, [esp+6Ch+var_50]
		pop	ebx

loc_100050C1:				; CODE XREF: sub_10004F10+61j
		neg	edi
		sbb	edi, edi
		not	edi
		and	edi, [esp+68h+var_4C]
		push	edi		; Size
		call	PR_SetLogBuffering
		push	offset aNspr_log_file ;	"NSPR_LOG_FILE"
		call	PR_GetEnv
		add	esp, 8
		mov	esi, eax
		pop	edi
		pop	ebp
		test	esi, esi
		jz	short loc_1000512C
		cmp	byte ptr [esi],	0
		jz	short loc_1000512C
		push	esi		; Filename
		call	PR_SetLogFile
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000513B
		push	esi
		push	offset aUnableToCreate ; "Unable to create nspr	log file '%s'\n"
		call	PR_smprintf
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000513B
		push	esi		; lpOutputString
		call	ds:OutputDebugStringA
		push	esi		; Memory
		call	PR_smprintf_free
		add	esp, 4
		pop	esi
		mov	ecx, [esp+5Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_1000512C:				; CODE XREF: sub_10004F10+1D4j
					; sub_10004F10+1D9j
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	File, ecx

loc_1000513B:				; CODE XREF: sub_10004F10+2Ej
					; sub_10004F10+37j ...
		mov	ecx, [esp+60h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
sub_10004F10	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  61. PR_CreateFileMap

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_CreateFileMap(int, DWORD dwMaximumSizeLow, DWORD dwMaximumSizeHigh, int)
		public PR_CreateFileMap
PR_CreateFileMap proc near		; CODE XREF: PR_EmulateSendFile+CBp
					; PR_OpenAnonFileMap_0+Fp
					; DATA XREF: ...

arg_0		= dword	ptr  4
dwMaximumSizeLow= dword	ptr  8
dwMaximumSizeHigh= dword ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		push	10h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10005175
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10005175:				; CODE XREF: PR_CreateFileMap+11j
		mov	eax, [esp+4+arg_0]
		mov	edx, [esp+4+dwMaximumSizeHigh]
		mov	ecx, [esp+4+arg_C]
		mov	[esi], eax
		mov	eax, [esp+4+dwMaximumSizeLow]
		push	edx		; dwMaximumSizeHigh
		push	eax		; dwMaximumSizeLow
		push	esi		; int
		mov	[esi+4], ecx
		call	sub_1001CBE0
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1000519D
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000519D:				; CODE XREF: PR_CreateFileMap+47j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
PR_CreateFileMap endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 168. PR_GetMemMapAlignment
; [00000005 BYTES: COLLAPSED FUNCTION PR_GetMemMapAlignment]
		align 10h
; Exported entry 240. PR_MemMap

; =============== S U B	R O U T	I N E =======================================


		public PR_MemMap
PR_MemMap	proc near		; CODE XREF: PR_EmulateSendFile+FEp
					; PR_EmulateSendFile+234p
					; DATA XREF: ...

Buffer		= byte ptr  4
dwFileOffsetLow	= dword	ptr  8
dwFileOffsetHigh= dword	ptr  0Ch
dwNumberOfBytesToMap= dword ptr	 10h

		mov	eax, [esp+dwNumberOfBytesToMap]
		mov	ecx, [esp+dwFileOffsetHigh]
		mov	edx, [esp+dwFileOffsetLow]
		push	eax		; dwNumberOfBytesToMap
		mov	eax, dword ptr [esp+4+Buffer]
		push	ecx		; dwFileOffsetHigh
		push	edx		; dwFileOffsetLow
		push	eax		; Buffer
		call	sub_1001CC90
		add	esp, 10h
		retn
PR_MemMap	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 241. PR_MemUnmap
; [00000005 BYTES: COLLAPSED FUNCTION PR_MemUnmap]
		align 10h
; Exported entry  53. PR_CloseFileMap
; [00000005 BYTES: COLLAPSED FUNCTION PR_CloseFileMap]
		align 10h
; Exported entry 355. PR_SyncMemMap
; [00000005 BYTES: COLLAPSED FUNCTION PR_SyncMemMap]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005210	proc near		; DATA XREF: .data:100301BCo
					; .data:1003024Co

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [eax]
		mov	[esp+arg_0], eax
		mov	eax, [ecx+54h]
		jmp	eax
sub_10005210	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10005230:				; DATA XREF: PR_NewPollableEvent+11o
		push	offset aNsprPollableEv ; "NSPR pollable	events"
		call	PR_GetUniqueIdentity
		xor	ecx, ecx
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		setnz	cl
		mov	dword_10030B4C,	eax
		lea	eax, [ecx-1]
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry 256. PR_NewPollableEvent

; =============== S U B	R O U T	I N E =======================================


		public PR_NewPollableEvent
PR_NewPollableEvent proc near		; CODE XREF: sub_1000F8A0+79p
					; DATA XREF: .rdata:off_1002C7C8o

var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_4		= dword	ptr -4

		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+54h+var_4], eax
		push	edi
		xor	edi, edi
		push	offset loc_10005230
		push	offset dword_10030B50
		mov	[esp+60h+var_50], edi
		mov	[esp+60h+var_54], edi
		call	PR_CallOnce
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10005292
		xor	eax, eax
		pop	edi
		mov	ecx, [esp+54h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_10005292:				; CODE XREF: PR_NewPollableEvent+2Ej
		mov	eax, dword_10030B4C
		push	esi
		push	offset dword_100301F8
		push	eax
		call	PR_CreateIOLayerStub
		mov	esi, eax
		add	esp, 8
		cmp	esi, edi
		jz	short loc_10005326
		push	4		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[esi+4], eax
		cmp	eax, edi
		jnz	short loc_100052CD
		push	edi
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_10005326
; ---------------------------------------------------------------------------

loc_100052CD:				; CODE XREF: PR_NewPollableEvent+6Bj
		lea	ecx, [esp+5Ch+var_54]
		push	ecx
		call	PR_NewTCPSocketPair
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100052E9
		mov	[esp+5Ch+var_50], edi
		mov	[esp+5Ch+var_54], edi
		jmp	short loc_10005341
; ---------------------------------------------------------------------------

loc_100052E9:				; CODE XREF: PR_NewPollableEvent+8Dj
		mov	eax, [esp+5Ch+var_50]
		lea	edx, [esp+5Ch+var_4C]
		push	edx
		push	eax
		mov	[esp+64h+var_4C], 0Dh
		mov	[esp+64h+var_44], 1
		call	PR_SetSocketOption
		mov	ecx, [esi+4]
		mov	edx, [esp+64h+var_50]
		push	esi
		mov	[ecx], edx
		mov	eax, [esp+68h+var_54]
		push	0FFFFFFFEh
		push	eax
		call	PR_PushIOLayer
		add	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000536D

loc_10005326:				; CODE XREF: PR_NewPollableEvent+5Aj
					; PR_NewPollableEvent+7Bj
		mov	eax, [esp+5Ch+var_54]
		cmp	eax, edi
		jz	short loc_10005341
		push	eax
		call	PR_Close
		mov	ecx, [esp+60h+var_50]
		push	ecx
		call	PR_Close
		add	esp, 8

loc_10005341:				; CODE XREF: PR_NewPollableEvent+97j
					; PR_NewPollableEvent+DCj
		cmp	esi, edi
		jz	short loc_1000535A
		mov	edx, [esi+4]
		push	edx		; Memory
		call	PR_Free
		mov	eax, [esi+10h]
		push	esi
		mov	[esi+4], edi
		call	eax
		add	esp, 8

loc_1000535A:				; CODE XREF: PR_NewPollableEvent+F3j
		pop	esi
		xor	eax, eax
		pop	edi
		mov	ecx, [esp+54h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_1000536D:				; CODE XREF: PR_NewPollableEvent+D4j
		mov	ecx, [esp+5Ch+var_4]
		mov	eax, [esp+5Ch+var_54]
		pop	esi
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
PR_NewPollableEvent endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10005390(void	*Memory)
sub_10005390	proc near		; DATA XREF: .data:100301FCo

Memory		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+Memory]
		push	0FFFFFFFEh	; int
		push	edi		; Memory
		call	PR_PopIOLayer
		push	edi
		mov	esi, eax
		call	PR_Close
		mov	eax, [esi+4]
		mov	ecx, [eax]
		push	ecx
		call	PR_Close
		mov	edx, [esi+4]
		push	edx		; Memory
		call	PR_Free
		mov	eax, [esi+10h]
		push	esi
		mov	dword ptr [esi+4], 0
		call	eax
		add	esp, 18h
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_10005390	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  87. PR_DestroyPollableEvent

; =============== S U B	R O U T	I N E =======================================


		public PR_DestroyPollableEvent
PR_DestroyPollableEvent	proc near	; CODE XREF: sub_1000F800+90p
					; DATA XREF: .rdata:off_1002C7C8o
		jmp	PR_Close
PR_DestroyPollableEvent	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 332. PR_SetPollableEvent

; =============== S U B	R O U T	I N E =======================================


		public PR_SetPollableEvent
PR_SetPollableEvent proc near		; CODE XREF: PR_CancelJob+11Bp
					; PR_JoinThreadPool+40p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx]
		push	1
		push	offset a8	; "8"
		push	edx
		call	PR_Write
		dec	eax
		add	esp, 0Ch
		neg	eax
		sbb	eax, eax
		retn
PR_SetPollableEvent endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 373. PR_WaitForPollableEvent

; =============== S U B	R O U T	I N E =======================================


		public PR_WaitForPollableEvent
PR_WaitForPollableEvent	proc near	; CODE XREF: sub_10010080+163p
					; DATA XREF: .rdata:off_1002C7C8o

var_404		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 404h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+404h+var_4], eax
		mov	eax, [esp+404h+arg_0]
		mov	edx, [eax+8]
		push	400h
		lea	ecx, [esp+408h+var_404]
		push	ecx
		push	edx
		call	PR_Read
		mov	ecx, [esp+410h+var_4]
		inc	eax
		add	esp, 0Ch
		neg	eax
		sbb	eax, eax
		neg	eax
		xor	ecx, esp
		dec	eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 404h
		retn
PR_WaitForPollableEvent	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005450	proc near		; CODE XREF: sub_100055B0+83p
					; sub_10005650+D4p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 0Ch
		mov	al, [esp+0Ch+arg_C]
		push	ebx
		xor	ebx, ebx
		push	ebp
		xor	ebp, ebp
		test	[esp+14h+arg_8], 1
		push	edi
		mov	edi, edx
		mov	[esp+18h+var_8], ebx
		mov	[esp+18h+var_C], ebx
		mov	[esp+18h+var_4], ebx
		jnz	short loc_10005497
		test	al, 10h
		jz	short loc_1000547E
		mov	[esp+18h+arg_8], 2Dh
		jmp	short loc_10005492
; ---------------------------------------------------------------------------

loc_1000547E:				; CODE XREF: sub_10005450+25j
		test	al, 2
		jz	short loc_10005489
		mov	[esp+18h+arg_8], 2Bh
		jmp	short loc_10005492
; ---------------------------------------------------------------------------

loc_10005489:				; CODE XREF: sub_10005450+30j
		test	al, 4
		jz	short loc_10005497
		mov	[esp+18h+arg_8], 20h

loc_10005492:				; CODE XREF: sub_10005450+2Cj
					; sub_10005450+37j
		mov	ebp, 1

loc_10005497:				; CODE XREF: sub_10005450+21j
					; sub_10005450+3Bj
		mov	eax, [esp+18h+arg_4]
		add	eax, ebp
		cmp	edi, ebx
		jle	short loc_100054AF
		cmp	edi, [esp+18h+arg_4]
		jle	short loc_100054AF
		mov	ebx, edi
		sub	ebx, [esp+18h+arg_4]
		add	eax, ebx

loc_100054AF:				; CODE XREF: sub_10005450+4Fj
					; sub_10005450+55j
		mov	dl, [esp+18h+arg_C]
		test	dl, 8
		jz	short loc_100054CA
		test	edi, edi
		jns	short loc_100054CA
		cmp	ecx, eax
		jle	short loc_100054CA
		mov	edi, ecx
		sub	edi, eax
		mov	[esp+18h+var_8], edi
		add	eax, edi

loc_100054CA:				; CODE XREF: sub_10005450+66j
					; sub_10005450+6Aj ...
		test	dl, 1
		jz	loc_10005592
		cmp	ecx, eax
		jle	short loc_100054DD
		sub	ecx, eax
		mov	[esp+18h+var_4], ecx

loc_100054DD:				; CODE XREF: sub_10005450+85j
					; sub_10005450+144j
		mov	edi, [esp+18h+var_C]

loc_100054E1:				; CODE XREF: sub_10005450+14Ej
		dec	edi
		js	short loc_100054FE

loc_100054E4:				; CODE XREF: sub_10005450+ACj
		mov	ecx, [esi]
		push	1
		push	offset word_10028648
		push	esi
		call	ecx
		add	esp, 0Ch
		test	eax, eax
		js	loc_1000558B
		dec	edi
		jns	short loc_100054E4

loc_100054FE:				; CODE XREF: sub_10005450+92j
		test	ebp, ebp
		jz	short loc_10005515
		mov	eax, [esi]
		push	1
		lea	edx, [esp+1Ch+arg_8]
		push	edx
		push	esi
		call	eax
		add	esp, 0Ch
		test	eax, eax
		js	short loc_1000558B

loc_10005515:				; CODE XREF: sub_10005450+B0j
		dec	ebx
		js	short loc_10005536
		jmp	short loc_10005520
; ---------------------------------------------------------------------------
		align 10h

loc_10005520:				; CODE XREF: sub_10005450+C8j
					; sub_10005450+E4j
		mov	ecx, [esi]
		push	1
		push	offset a0	; "0"
		push	esi
		call	ecx
		add	esp, 0Ch
		test	eax, eax
		js	short loc_1000558B
		dec	ebx
		jns	short loc_10005520

loc_10005536:				; CODE XREF: sub_10005450+C6j
		mov	edi, [esp+18h+var_8]
		dec	edi
		js	short loc_10005556
		lea	ecx, [ecx+0]

loc_10005540:				; CODE XREF: sub_10005450+104j
		mov	edx, [esi]
		push	1
		push	offset a0	; "0"
		push	esi
		call	edx
		add	esp, 0Ch
		test	eax, eax
		js	short loc_1000558B
		dec	edi
		jns	short loc_10005540

loc_10005556:				; CODE XREF: sub_10005450+EBj
		mov	eax, [esp+18h+arg_4]
		mov	ecx, [esp+18h+arg_0]
		mov	edx, [esi]
		push	eax
		push	ecx
		push	esi
		call	edx
		add	esp, 0Ch
		test	eax, eax
		js	short loc_1000558B
		mov	edi, [esp+18h+var_4]
		dec	edi
		js	short loc_10005589

loc_10005573:				; CODE XREF: sub_10005450+137j
		mov	eax, [esi]
		push	1
		push	offset word_10028648
		push	esi
		call	eax
		add	esp, 0Ch
		test	eax, eax
		js	short loc_1000558B
		dec	edi
		jns	short loc_10005573

loc_10005589:				; CODE XREF: sub_10005450+121j
		xor	eax, eax

loc_1000558B:				; CODE XREF: sub_10005450+A5j
					; sub_10005450+C3j ...
		pop	edi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10005592:				; CODE XREF: sub_10005450+7Dj
		cmp	ecx, eax
		jle	loc_100054DD
		sub	ecx, eax
		mov	edi, ecx
		jmp	loc_100054E1
sub_10005450	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100055B0	proc near		; CODE XREF: sub_10005C10+440p

var_6C		= dword	ptr -6Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 6Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+6Ch+var_4], eax
		mov	eax, [esp+6Ch+arg_0]
		push	ebp
		mov	ebp, [esp+70h+arg_10]
		push	esi
		mov	esi, edx
		mov	[esp+74h+var_6C], ecx
		test	ebx, ebx
		jnz	short loc_100055EA
		test	eax, eax
		jnz	short loc_100055EA
		pop	esi
		pop	ebp
		mov	ecx, [esp+6Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 6Ch
		retn
; ---------------------------------------------------------------------------

loc_100055EA:				; CODE XREF: sub_100055B0+23j
					; sub_100055B0+27j
		push	edi
		xor	edi, edi
		lea	ecx, [esp+78h+var_4]
		test	eax, eax
		jz	short loc_1000560B

loc_100055F5:				; CODE XREF: sub_100055B0+55j
		xor	edx, edx
		div	esi
		dec	ecx
		inc	edi
		and	edx, 0Fh
		mov	dl, [edx+ebp]
		mov	[ecx], dl
		test	eax, eax
		jnz	short loc_100055F5
		test	edi, edi
		jnz	short loc_10005614

loc_1000560B:				; CODE XREF: sub_100055B0+43j
		dec	ecx
		mov	byte ptr [ecx],	30h
		mov	edi, 1

loc_10005614:				; CODE XREF: sub_100055B0+59j
		mov	eax, [esp+78h+arg_C]
		mov	edx, [esp+78h+arg_8]
		mov	esi, [esp+78h+var_6C]
		push	eax
		push	edx
		push	edi
		push	ecx
		mov	ecx, [esp+88h+arg_4]
		mov	edx, ebx
		call	sub_10005450
		mov	ecx, [esp+88h+var_4]
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 6Ch
		retn
sub_100055B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005650	proc near		; CODE XREF: sub_10005C10+4E0p

var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_6C		= dword	ptr -6Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+7Ch+var_4], eax
		cmp	[esp+7Ch+arg_10], 0
		mov	eax, [esp+7Ch+arg_0]
		mov	ecx, [esp+7Ch+arg_4]
		push	edi
		mov	edi, [esp+80h+arg_8]
		mov	[esp+80h+var_74], eax
		jnz	short loc_1000569A
		mov	edx, ecx
		or	edx, edi
		jnz	short loc_1000569A
		xor	eax, eax
		pop	edi
		mov	ecx, [esp+7Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 7Ch
		retn
; ---------------------------------------------------------------------------

loc_1000569A:				; CODE XREF: sub_10005650+30j
					; sub_10005650+36j
		mov	eax, [esp+80h+arg_14]
		cdq
		push	ebp
		mov	[esp+84h+var_7C], eax
		push	esi
		mov	eax, ecx
		xor	esi, esi
		or	eax, edi
		mov	[esp+88h+var_78], edx
		lea	ebp, [esp+88h+var_4]
		jz	short loc_100056F6
		push	ebx
		lea	esp, [esp+0]

loc_100056C0:				; CODE XREF: sub_10005650+9Fj
		mov	edx, [esp+8Ch+var_78]
		mov	eax, [esp+8Ch+var_7C]
		push	edx
		push	eax
		push	edi
		push	ecx
		dec	ebp
		call	sub_10026A10
		mov	edi, [esp+8Ch+arg_20]
		and	ecx, 0Fh
		mov	cl, [ecx+edi]
		mov	[ebp+0], cl
		mov	ecx, eax
		mov	edi, edx
		mov	edx, ecx
		inc	esi
		or	edx, edi
		mov	[esp+8Ch+var_6C], ebx
		jnz	short loc_100056C0
		pop	ebx
		test	esi, esi
		jnz	short loc_10005700

loc_100056F6:				; CODE XREF: sub_10005650+69j
		dec	ebp
		mov	byte ptr [ebp+0], 30h
		mov	esi, 1

loc_10005700:				; CODE XREF: sub_10005650+A4j
		mov	eax, [esp+88h+arg_1C]
		mov	ecx, [esp+88h+arg_18]
		mov	edx, [esp+88h+arg_10]
		push	eax
		push	ecx
		mov	ecx, [esp+90h+arg_C]
		push	esi
		mov	esi, [esp+94h+var_74]
		push	ebp
		call	sub_10005450
		mov	ecx, [esp+98h+var_4]
		add	esp, 10h
		pop	esi
		pop	ebp
		pop	edi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 7Ch
		retn
sub_10005650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_10005750@<eax>(void *Src@<ecx>, double, int)
sub_10005750	proc near		; CODE XREF: sub_10005C10+2BAp
					; sub_10005C10+2E4p

var_150		= qword	ptr -150h
Dst		= byte ptr -144h
Dest		= byte ptr -130h
var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= qword	ptr  4
arg_8		= dword	ptr  0Ch

		sub	esp, 144h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+144h+var_4], eax
		push	esi
		mov	esi, [esp+148h+arg_8]
		sub	esi, ecx
		test	esi, esi
		jle	loc_10005802
		cmp	esi, 14h
		jnb	loc_10005802
		push	esi		; Size
		push	ecx		; Src
		lea	eax, [esp+150h+Dst]
		push	eax		; Dst
		call	memcpy
		push	12Ch		; Size
		lea	ecx, [esp+158h+Dest]
		push	0		; Val
		push	ecx		; Dst
		mov	[esp+esi+160h+Dst], 0
		call	memset
		fld	[esp+160h+arg_0]
		add	esp, 10h
		fstp	[esp+150h+var_150]
		lea	edx, [esp+150h+Dst]
		push	edx		; Format
		lea	eax, [esp+154h+Dest]
		push	12Ch		; Count
		push	eax		; Dest
		call	ds:_snprintf
		lea	eax, [esp+15Ch+Dest]
		add	esp, 14h
		mov	[esp+148h+var_5], 0
		lea	edx, [eax+1]

loc_100057D5:				; CODE XREF: sub_10005750+8Aj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100057D5
		sub	eax, edx
		mov	edx, [edi]
		push	eax
		lea	ecx, [esp+14Ch+Dest]
		push	ecx
		push	edi
		call	edx
		add	esp, 0Ch
		pop	esi
		mov	ecx, [esp+144h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 144h
		retn
; ---------------------------------------------------------------------------

loc_10005802:				; CODE XREF: sub_10005750+20j
					; sub_10005750+29j
		mov	ecx, [esp+148h+var_4]
		pop	esi
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 144h
		retn
sub_10005750	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005820	proc near		; CODE XREF: sub_10005C10+567p
					; sub_10005C10+5ACp

var_1		= byte ptr -1
arg_0		= byte ptr  4

		push	ecx
		push	ebx
		push	edi
		mov	edi, eax
		mov	ebx, edx
		test	ecx, ecx
		jnz	short loc_10005831
		pop	edi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10005831:				; CODE XREF: sub_10005820+9j
		test	ebx, ebx
		jnz	short loc_1000583A
		mov	ebx, offset aNull ; "(null)"

loc_1000583A:				; CODE XREF: sub_10005820+13j
		push	ebp
		mov	eax, ebx
		test	ecx, ecx
		jle	short loc_1000584E

loc_10005841:				; CODE XREF: sub_10005820+28j
		cmp	byte ptr [eax],	0
		jz	short loc_1000584A
		inc	eax
		dec	ecx
		jnz	short loc_10005841

loc_1000584A:				; CODE XREF: sub_10005820+24j
		sub	eax, ebx
		jmp	short loc_1000585A
; ---------------------------------------------------------------------------

loc_1000584E:				; CODE XREF: sub_10005820+1Fj
		lea	edx, [eax+1]

loc_10005851:				; CODE XREF: sub_10005820+36j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10005851
		sub	eax, edx

loc_1000585A:				; CODE XREF: sub_10005820+2Cj
		mov	ebp, eax
		sub	edi, ebp
		mov	[esp+10h+var_1], 20h
		test	edi, edi
		jle	short loc_10005896
		mov	al, [esp+10h+arg_0]
		test	al, 1
		jnz	short loc_10005896
		test	al, 8
		jz	short loc_10005878
		mov	[esp+10h+var_1], 30h

loc_10005878:				; CODE XREF: sub_10005820+51j
		dec	edi
		js	short loc_10005896
		jmp	short loc_10005880
; ---------------------------------------------------------------------------
		align 10h

loc_10005880:				; CODE XREF: sub_10005820+5Bj
					; sub_10005820+74j
		mov	ecx, [esi]
		push	1
		lea	eax, [esp+14h+var_1]
		push	eax
		push	esi
		call	ecx
		add	esp, 0Ch
		test	eax, eax
		js	short loc_100058CA
		dec	edi
		jns	short loc_10005880

loc_10005896:				; CODE XREF: sub_10005820+45j
					; sub_10005820+4Dj ...
		mov	edx, [esi]
		push	ebp
		push	ebx
		push	esi
		call	edx
		add	esp, 0Ch
		test	eax, eax
		js	short loc_100058CA
		test	edi, edi
		jle	short loc_100058C8
		test	[esp+10h+arg_0], 1
		jz	short loc_100058C8
		dec	edi
		js	short loc_100058C8

loc_100058B2:				; CODE XREF: sub_10005820+A6j
		mov	ecx, [esi]
		push	1
		lea	eax, [esp+14h+var_1]
		push	eax
		push	esi
		call	ecx
		add	esp, 0Ch
		test	eax, eax
		js	short loc_100058CA
		dec	edi
		jns	short loc_100058B2

loc_100058C8:				; CODE XREF: sub_10005820+86j
					; sub_10005820+8Dj ...
		xor	eax, eax

loc_100058CA:				; CODE XREF: sub_10005820+71j
					; sub_10005820+82j ...
		pop	ebp
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_10005820	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100058D0	proc near		; CODE XREF: sub_10005C10+45p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		push	esi
		push	edi
		mov	edi, eax
		mov	eax, [esp+14h+arg_4]
		xor	ebx, ebx
		mov	[eax], ebx
		mov	al, [edi]
		xor	esi, esi
		mov	ecx, edi
		test	al, al
		jz	loc_10005B78

loc_100058F1:				; CODE XREF: sub_100058D0+5Ej
		inc	ecx
		cmp	al, 25h
		jnz	short loc_1000592A
		mov	al, [ecx]
		inc	ecx
		cmp	al, 25h
		jz	short loc_1000592A
		test	al, al
		jz	short loc_1000592A

loc_10005901:				; CODE XREF: sub_100058D0+3Ej
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	short loc_10005912
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_10005901
		jmp	short loc_1000592A
; ---------------------------------------------------------------------------

loc_10005912:				; CODE XREF: sub_100058D0+37j
		cmp	al, 24h
		jnz	short loc_10005921
		test	esi, esi
		jg	loc_10005B6E
		inc	ebx
		jmp	short loc_1000592A
; ---------------------------------------------------------------------------

loc_10005921:				; CODE XREF: sub_100058D0+44j
		test	ebx, ebx
		jg	short loc_10005965
		mov	esi, 1

loc_1000592A:				; CODE XREF: sub_100058D0+24j
					; sub_100058D0+2Bj ...
		mov	al, [ecx]
		test	al, al
		jnz	short loc_100058F1
		mov	[esp+14h+var_4], ebx
		test	ebx, ebx
		jz	loc_10005B78
		cmp	ebx, 14h
		jle	short loc_10005977
		mov	edx, ebx
		shl	edx, 4
		push	edx		; Size
		call	PR_Malloc
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000597B
		mov	eax, [esp+14h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [eax], 0FFFFFFFFh
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10005965:				; CODE XREF: sub_100058D0+53j
		mov	ecx, [esp+14h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	dword ptr [ecx], 0FFFFFFFFh
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10005977:				; CODE XREF: sub_100058D0+6Fj
		mov	eax, [esp+14h+arg_8]

loc_1000597B:				; CODE XREF: sub_100058D0+81j
		test	ebx, ebx
		jle	short loc_1000598F
		mov	ecx, eax
		mov	edx, ebx

loc_10005983:				; CODE XREF: sub_100058D0+BDj
		mov	dword ptr [ecx], 14h
		add	ecx, 10h
		dec	edx
		jnz	short loc_10005983

loc_1000598F:				; CODE XREF: sub_100058D0+ADj
		mov	cl, [edi]
		mov	edx, edi
		test	cl, cl
		jz	loc_10005AC8
		jmp	short loc_100059A0
; ---------------------------------------------------------------------------
		align 10h

loc_100059A0:				; CODE XREF: sub_100058D0+CBj
					; sub_100058D0+1F2j
		inc	edx
		cmp	cl, 25h
		jnz	loc_10005ABE
		mov	bl, [edx]
		inc	edx
		cmp	bl, cl
		jz	loc_10005ABE
		xor	ecx, ecx
		test	bl, bl
		jz	short loc_100059D6
		jmp	short loc_100059C0
; ---------------------------------------------------------------------------
		align 10h

loc_100059C0:				; CODE XREF: sub_100058D0+EBj
					; sub_100058D0+104j
		cmp	bl, 24h
		jz	short loc_100059E5
		movsx	esi, bl
		mov	bl, [edx]
		lea	ecx, [ecx+ecx*4]
		inc	edx
		lea	ecx, [esi+ecx*2-30h]
		test	bl, bl
		jnz	short loc_100059C0

loc_100059D6:				; CODE XREF: sub_100058D0+E9j
					; sub_100058D0+118j ...
		mov	ecx, [esp+14h+arg_4]
		mov	dword ptr [ecx], 0FFFFFFFFh
		jmp	loc_10005AD1
; ---------------------------------------------------------------------------

loc_100059E5:				; CODE XREF: sub_100058D0+F3j
		cmp	ecx, 1
		jl	short loc_100059D6
		cmp	ecx, [esp+14h+var_4]
		jg	short loc_100059D6
		dec	ecx
		shl	ecx, 4
		cmp	dword ptr [ecx+eax], 14h
		lea	esi, [ecx+eax]
		jnz	loc_10005ABE
		mov	cl, [edx]
		inc	edx
		cmp	cl, 2Ah
		jz	loc_10005AEC
		cmp	cl, 30h
		jl	short loc_10005A1F

loc_10005A12:				; CODE XREF: sub_100058D0+14Dj
		cmp	cl, 39h
		jg	short loc_10005A1F
		mov	cl, [edx]
		inc	edx
		cmp	cl, 30h
		jge	short loc_10005A12

loc_10005A1F:				; CODE XREF: sub_100058D0+140j
					; sub_100058D0+145j
		cmp	cl, 2Eh
		jnz	short loc_10005A3E
		mov	cl, [edx]
		inc	edx
		cmp	cl, 2Ah
		jz	short loc_100059D6
		cmp	cl, 30h
		jl	short loc_10005A3E

loc_10005A31:				; CODE XREF: sub_100058D0+16Cj
		cmp	cl, 39h
		jg	short loc_10005A3E
		mov	cl, [edx]
		inc	edx
		cmp	cl, 30h
		jge	short loc_10005A31

loc_10005A3E:				; CODE XREF: sub_100058D0+152j
					; sub_100058D0+15Fj ...
		mov	dword ptr [esi], 2
		cmp	cl, 68h
		jnz	short loc_10005A51
		mov	dword ptr [esi], 0
		jmp	short loc_10005A6F
; ---------------------------------------------------------------------------

loc_10005A51:				; CODE XREF: sub_100058D0+177j
		cmp	cl, 4Ch
		jz	short loc_10005A69
		cmp	cl, 6Ch
		jnz	short loc_10005A72
		mov	dword ptr [esi], 4
		mov	cl, [edx]
		inc	edx
		cmp	cl, 6Ch
		jnz	short loc_10005A72

loc_10005A69:				; CODE XREF: sub_100058D0+184j
		mov	dword ptr [esi], 6

loc_10005A6F:				; CODE XREF: sub_100058D0+17Fj
		mov	cl, [edx]
		inc	edx

loc_10005A72:				; CODE XREF: sub_100058D0+189j
					; sub_100058D0+197j
		movsx	ecx, cl
		add	ecx, 0FFFFFFBDh	; switch 54 cases
		cmp	ecx, 35h
		ja	short loc_10005AB3 ; jumptable 10005A84	default	case
		movzx	ecx, ds:byte_10005BA0[ecx]
		jmp	ds:off_10005B80[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10005A8B:				; CODE XREF: sub_100058D0+1B4j
					; DATA XREF: .text:off_10005B80o
		mov	dword ptr [esi], 9 ; jumptable 10005A84	cases 101-103
		jmp	short loc_10005AB9 ; jumptable 10005A84	cases 88,99,100,105,111,117,120
; ---------------------------------------------------------------------------

loc_10005A93:				; CODE XREF: sub_100058D0+1B4j
					; DATA XREF: .text:off_10005B80o
		mov	dword ptr [esi], 5 ; jumptable 10005A84	case 112
		jmp	short loc_10005AB9 ; jumptable 10005A84	cases 88,99,100,105,111,117,120
; ---------------------------------------------------------------------------

loc_10005A9B:				; CODE XREF: sub_100058D0+1B4j
					; DATA XREF: .text:off_10005B80o
		mov	dword ptr [esi], 0Bh ; jumptable 10005A84 case 83
		jmp	short loc_10005AB9 ; jumptable 10005A84	cases 88,99,100,105,111,117,120
; ---------------------------------------------------------------------------

loc_10005AA3:				; CODE XREF: sub_100058D0+1B4j
					; DATA XREF: .text:off_10005B80o
		mov	dword ptr [esi], 8 ; jumptable 10005A84	case 115
		jmp	short loc_10005AB9 ; jumptable 10005A84	cases 88,99,100,105,111,117,120
; ---------------------------------------------------------------------------

loc_10005AAB:				; CODE XREF: sub_100058D0+1B4j
					; DATA XREF: .text:off_10005B80o
		mov	dword ptr [esi], 0Ah ; jumptable 10005A84 case 110
		jmp	short loc_10005AB9 ; jumptable 10005A84	cases 88,99,100,105,111,117,120
; ---------------------------------------------------------------------------

loc_10005AB3:				; CODE XREF: sub_100058D0+1ABj
					; sub_100058D0+1B4j
					; DATA XREF: ...
		mov	dword ptr [esi], 14h ; jumptable 10005A84 default case

loc_10005AB9:				; CODE XREF: sub_100058D0+1B4j
					; sub_100058D0+1C1j ...
		cmp	dword ptr [esi], 14h ; jumptable 10005A84 cases	88,99,100,105,111,117,120
		jz	short loc_10005AEC

loc_10005ABE:				; CODE XREF: sub_100058D0+D4j
					; sub_100058D0+DFj ...
		mov	cl, [edx]
		test	cl, cl
		jnz	loc_100059A0

loc_10005AC8:				; CODE XREF: sub_100058D0+C5j
		mov	edx, [esp+14h+arg_4]
		cmp	dword ptr [edx], 0
		jge	short loc_10005AF8

loc_10005AD1:				; CODE XREF: sub_100058D0+110j
					; sub_100058D0+226j
		cmp	eax, [esp+14h+arg_8]
		jz	loc_10005B78
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10005AEC:				; CODE XREF: sub_100058D0+137j
					; sub_100058D0+1ECj
		mov	edx, [esp+14h+arg_4]
		mov	dword ptr [edx], 0FFFFFFFFh
		jmp	short loc_10005AD1
; ---------------------------------------------------------------------------

loc_10005AF8:				; CODE XREF: sub_100058D0+1FFj
		xor	ebx, ebx
		cmp	[esp+14h+var_4], ebx
		jle	short loc_10005B7A
		lea	esi, [ebp-8]
		lea	ecx, [ebp-4]
		mov	ebp, [esp+14h+var_4]
		mov	edx, eax
		lea	esp, [esp+0]

loc_10005B10:				; CODE XREF: sub_100058D0+287j
		mov	edi, [edx]
		cmp	edi, 14h
		jz	short loc_10005B51
		cmp	edi, 0Bh	; switch 12 cases
		ja	short loc_10005B5F ; jumptable 10005B1C	default	case
		jmp	ds:off_10005BD8[edi*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10005B23:				; CODE XREF: sub_100058D0+24Cj
					; DATA XREF: .text:off_10005BD8o
		mov	edi, [ecx+4]	; jumptable 10005B1C cases 0-5,8,10,11
		add	ecx, 4
		add	esi, 4
		mov	[edx+8], edi
		jmp	short loc_10005B51
; ---------------------------------------------------------------------------

loc_10005B31:				; CODE XREF: sub_100058D0+24Cj
					; DATA XREF: .text:off_10005BD8o
		mov	edi, [esi+8]	; jumptable 10005B1C cases 6,7
		add	ecx, 8
		add	esi, 8
		mov	[edx+8], edi
		mov	edi, [esi+4]
		mov	[edx+0Ch], edi
		jmp	short loc_10005B51
; ---------------------------------------------------------------------------

loc_10005B45:				; CODE XREF: sub_100058D0+24Cj
					; DATA XREF: .text:off_10005BD8o
		fld	qword ptr [esi+8] ; jumptable 10005B1C case 9
		add	ecx, 8
		add	esi, 8
		fstp	qword ptr [edx+8]

loc_10005B51:				; CODE XREF: sub_100058D0+245j
					; sub_100058D0+25Fj ...
		inc	ebx
		add	edx, 10h
		cmp	ebx, ebp
		jl	short loc_10005B10
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10005B5F:				; CODE XREF: sub_100058D0+24Aj
		cmp	eax, [esp+14h+arg_8] ; jumptable 10005B1C default case
		jz	short loc_10005B6E
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_10005B6E:				; CODE XREF: sub_100058D0+48j
					; sub_100058D0+293j
		mov	eax, [esp+14h+arg_4]
		mov	dword ptr [eax], 0FFFFFFFFh

loc_10005B78:				; CODE XREF: sub_100058D0+1Bj
					; sub_100058D0+66j ...
		xor	eax, eax

loc_10005B7A:				; CODE XREF: sub_100058D0+22Ej
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_100058D0	endp

; ---------------------------------------------------------------------------
off_10005B80	dd offset loc_10005AB3,	offset loc_10005A9B, offset loc_10005AB9
					; DATA XREF: sub_100058D0+1B4r
		dd offset loc_10005A8B,	offset loc_10005AAB, offset loc_10005A93 ; jump	table for switch statement
		dd offset loc_10005AA3,	offset loc_10005AB3
byte_10005BA0	db	0,     7,     0,     7 ; DATA XREF: sub_100058D0+1ADr
		db	0,     7,     7,     7 ; indirect table	for switch statement
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	1,     7,     7,     7
		db	7,     2,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	2,     2,     3,     3
		db	3,     7,     2,     7
		db	7,     7,     7,     4
		db	2,     5,     7,     7
		db	6,     7,     2,     7
		db	7,     2
		align 4
off_10005BD8	dd offset loc_10005B23	; DATA XREF: sub_100058D0+24Cr
		dd offset loc_10005B23	; jump table for switch	statement
		dd offset loc_10005B23
		dd offset loc_10005B23
		dd offset loc_10005B23
		dd offset loc_10005B23
		dd offset loc_10005B31
		dd offset loc_10005B31
		dd offset loc_10005B23
		dd offset loc_10005B45
		dd offset loc_10005B23
		dd offset loc_10005B23
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10005C10	proc near		; CODE XREF: PR_vsxprintf+31p
					; PR_vsmprintf+31p ...

var_1A4		= qword	ptr -1A4h
var_188		= dword	ptr -188h
lpWideCharStr	= dword	ptr -184h
var_17C		= dword	ptr -17Ch
Memory		= dword	ptr -178h
var_174		= dword	ptr -174h
var_170		= dword	ptr -170h
var_16C		= dword	ptr -16Ch
var_168		= dword	ptr -168h
var_164		= dword	ptr -164h
var_160		= dword	ptr -160h
Src		= dword	ptr -15Ch
var_158		= byte ptr -158h
var_18		= byte ptr -18h
Dst		= byte ptr -17h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 188h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+188h+var_4], eax
		mov	eax, [esp+188h+arg_4]
		push	ebx
		push	ebp
		mov	ebp, [esp+190h+arg_0]
		push	esi
		push	edi
		mov	edi, ecx
		lea	ecx, [esp+198h+var_158]
		push	ecx
		lea	edx, [esp+19Ch+var_160]
		push	edx
		mov	[esp+1A0h+var_188], eax
		push	eax
		mov	eax, ebp
		mov	[esp+1A4h+var_174], edi
		mov	[esp+1A4h+Src],	0
		call	sub_100058D0
		mov	esi, [esp+1A4h+var_160]
		add	esp, 0Ch
		mov	ebx, eax
		mov	[esp+198h+Memory], ebx
		test	esi, esi
		js	loc_1000625E
		mov	al, [ebp+0]
		test	al, al
		jz	loc_10006238
		lea	ebx, [ebx+0]

loc_10005C80:				; CODE XREF: sub_10005C10+61Aj
		inc	ebp
		cmp	al, 25h
		jz	short loc_10005C99
		push	1
		lea	eax, [ebp-1]
		push	eax
		mov	eax, [esp+1A0h+var_174]
		mov	ecx, [eax]
		push	eax
		call	ecx
		jmp	loc_1000621C
; ---------------------------------------------------------------------------

loc_10005C99:				; CODE XREF: sub_10005C10+73j
		mov	al, [ebp+0]
		lea	edx, [ebp-1]
		xor	ebx, ebx
		inc	ebp
		mov	[esp+198h+var_16C], edx
		mov	[esp+198h+var_17C], ebx
		cmp	al, 25h
		jnz	short loc_10005CC2
		push	1
		lea	eax, [ebp-1]
		push	eax
		mov	eax, [esp+1A0h+var_174]
		mov	ecx, [eax]
		push	eax
		call	ecx
		jmp	loc_1000621C
; ---------------------------------------------------------------------------

loc_10005CC2:				; CODE XREF: sub_10005C10+9Cj
		mov	ecx, [esp+198h+Memory]
		test	ecx, ecx
		jz	short loc_10005D03
		xor	edx, edx
		test	al, al
		jz	short loc_10005CE6

loc_10005CD0:				; CODE XREF: sub_10005C10+D4j
		cmp	al, 24h
		jz	short loc_10005CE6
		movsx	eax, al
		lea	edx, [edx+edx*4]
		lea	edx, [eax+edx*2-30h]
		mov	al, [ebp+0]
		inc	ebp
		test	al, al
		jnz	short loc_10005CD0

loc_10005CE6:				; CODE XREF: sub_10005C10+BEj
					; sub_10005C10+C2j
		add	edx, edx
		cmp	dword ptr [ecx+edx*8-10h], 14h
		lea	edx, [ecx+edx*8-10h]
		jz	loc_10006279
		mov	[esp+198h+var_170], edx
		mov	[esp+198h+Src],	ebp

loc_10005CFF:				; CODE XREF: sub_10005C10+10Aj
					; sub_10005C10+10Fj ...
		mov	al, [ebp+0]
		inc	ebp

loc_10005D03:				; CODE XREF: sub_10005C10+B8j
		cmp	al, 2Dh
		jz	short loc_10005D1C
		cmp	al, 2Bh
		jz	short loc_10005D21
		cmp	al, 20h
		jz	short loc_10005D17
		cmp	al, 30h
		jnz	short loc_10005D2F
		cmp	al, 20h
		jnz	short loc_10005D26

loc_10005D17:				; CODE XREF: sub_10005C10+FDj
		or	ebx, 4
		jmp	short loc_10005CFF
; ---------------------------------------------------------------------------

loc_10005D1C:				; CODE XREF: sub_10005C10+F5j
		or	ebx, 1
		jmp	short loc_10005CFF
; ---------------------------------------------------------------------------

loc_10005D21:				; CODE XREF: sub_10005C10+F9j
		or	ebx, 2
		jmp	short loc_10005CFF
; ---------------------------------------------------------------------------

loc_10005D26:				; CODE XREF: sub_10005C10+105j
		cmp	al, 30h
		jnz	short loc_10005CFF
		or	ebx, 8
		jmp	short loc_10005CFF
; ---------------------------------------------------------------------------

loc_10005D2F:				; CODE XREF: sub_10005C10+101j
		mov	[esp+198h+var_17C], ebx
		test	bl, 2
		jz	short loc_10005D3F
		and	ebx, 0FFFFFFFBh
		mov	[esp+198h+var_17C], ebx

loc_10005D3F:				; CODE XREF: sub_10005C10+126j
		test	bl, 1
		jz	short loc_10005D4B
		and	ebx, 0FFFFFFF7h
		mov	[esp+198h+var_17C], ebx

loc_10005D4B:				; CODE XREF: sub_10005C10+132j
		cmp	al, 2Ah
		jnz	short loc_10005D69
		mov	ecx, [esp+198h+var_188]
		mov	al, [ebp+0]
		inc	ebp
		add	ecx, 4
		mov	[esp+198h+var_188], ecx
		mov	ecx, [ecx-4]
		mov	[esp+198h+var_164], ecx
		mov	ebx, ecx
		jmp	short loc_10005D8D
; ---------------------------------------------------------------------------

loc_10005D69:				; CODE XREF: sub_10005C10+13Dj
		xor	ebx, ebx
		mov	[esp+198h+var_164], ebx
		cmp	al, 30h
		jl	short loc_10005D8D

loc_10005D73:				; CODE XREF: sub_10005C10+177j
		cmp	al, 39h
		jg	short loc_10005D89
		movsx	eax, al
		lea	edx, [ebx+ebx*4]
		lea	ebx, [eax+edx*2-30h]
		mov	al, [ebp+0]
		inc	ebp
		cmp	al, 30h
		jge	short loc_10005D73

loc_10005D89:				; CODE XREF: sub_10005C10+165j
		mov	[esp+198h+var_164], ebx

loc_10005D8D:				; CODE XREF: sub_10005C10+157j
					; sub_10005C10+161j
		or	edx, 0FFFFFFFFh
		mov	[esp+198h+var_168], edx
		cmp	al, 2Eh
		jnz	short loc_10005DDA
		mov	al, [ebp+0]
		inc	ebp
		cmp	al, 2Ah
		jnz	short loc_10005DB3
		mov	ecx, [esp+198h+var_188]
		mov	al, [ebp+0]
		mov	edx, [ecx]
		inc	ebp
		add	ecx, 4
		mov	[esp+198h+var_188], ecx
		jmp	short loc_10005DD6
; ---------------------------------------------------------------------------

loc_10005DB3:				; CODE XREF: sub_10005C10+18Ej
		xor	edx, edx
		mov	[esp+198h+var_168], edx
		cmp	al, 30h
		jl	short loc_10005DDA
		lea	ecx, [ecx+0]

loc_10005DC0:				; CODE XREF: sub_10005C10+1C4j
		cmp	al, 39h
		jg	short loc_10005DD6
		lea	ecx, [edx+edx*4]
		movsx	edx, al
		mov	al, [ebp+0]
		inc	ebp
		lea	edx, [edx+ecx*2-30h]
		cmp	al, 30h
		jge	short loc_10005DC0

loc_10005DD6:				; CODE XREF: sub_10005C10+1A1j
					; sub_10005C10+1B2j
		mov	[esp+198h+var_168], edx

loc_10005DDA:				; CODE XREF: sub_10005C10+186j
					; sub_10005C10+1ABj
		mov	edi, 2
		cmp	al, 68h
		jnz	short loc_10005DE7
		xor	edi, edi
		jmp	short loc_10005E01
; ---------------------------------------------------------------------------

loc_10005DE7:				; CODE XREF: sub_10005C10+1D1j
		cmp	al, 4Ch
		jz	short loc_10005DFC
		cmp	al, 6Ch
		jnz	short loc_10005E05
		mov	al, [ebp+0]
		inc	ebp
		mov	edi, 4
		cmp	al, 6Ch
		jnz	short loc_10005E05

loc_10005DFC:				; CODE XREF: sub_10005C10+1D9j
		mov	edi, 6

loc_10005E01:				; CODE XREF: sub_10005C10+1D5j
		mov	al, [ebp+0]
		inc	ebp

loc_10005E05:				; CODE XREF: sub_10005C10+1DDj
					; sub_10005C10+1EAj
		mov	ecx, off_10030288
		movsx	eax, al
		add	eax, 0FFFFFFBBh	; switch 52 cases
		mov	[esp+198h+var_160], ecx
		cmp	eax, 33h
		ja	loc_100061FA	; jumptable 10005E25 default case
		movzx	eax, ds:byte_100062C0[eax]
		jmp	ds:off_10006290[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10005E2C:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		mov	edx, 0Ah	; jumptable 10005E25 cases 100,105
		jmp	short loc_10005E3B
; ---------------------------------------------------------------------------

loc_10005E33:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		mov	edx, 8		; jumptable 10005E25 case 111

loc_10005E38:				; CODE XREF: sub_10005C10+244j
					; sub_10005C10+24Bj ...
		or	edi, 1

loc_10005E3B:				; CODE XREF: sub_10005C10+221j
		mov	[esp+198h+var_16C], edx
		cmp	edi, 7		; switch 8 cases
		ja	loc_10006225	; jumptable 10005E48 default case

loc_10005E48:				; CODE XREF: sub_10005C10+3A7j
		jmp	ds:off_100062F4[edi*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10005E4F:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		mov	edx, 0Ah	; jumptable 10005E25 case 117
		jmp	short loc_10005E38
; ---------------------------------------------------------------------------

loc_10005E56:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		mov	edx, 10h	; jumptable 10005E25 case 120
		jmp	short loc_10005E38
; ---------------------------------------------------------------------------

loc_10005E5D:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		mov	ecx, off_1003028C ; jumptable 10005E25 case 88
		mov	edx, 10h
		mov	[esp+198h+var_160], ecx
		jmp	short loc_10005E38
; ---------------------------------------------------------------------------

loc_10005E6E:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E25 cases	69,101-103
		jz	short loc_10005ED4
		mov	edx, [esp+198h+var_170]
		fld	qword ptr [edx+8]
		mov	ebx, ebp
		sub	ebx, [esp+198h+Src]
		fstp	qword ptr [esp+198h+lpWideCharStr]
		cmp	ebx, 14h
		jnb	loc_10006221
		mov	eax, [esp+198h+Src]
		push	ebx		; Size
		push	eax		; Src
		lea	ecx, [esp+1A0h+Dst]
		push	ecx		; Dst
		mov	[esp+1A4h+var_18], 25h
		call	memcpy
		fld	qword ptr [esp+1A4h+lpWideCharStr]
		mov	edi, [esp+1A4h+var_174]
		add	esp, 0Ch
		lea	edx, [esp+ebx+198h+Dst]
		push	edx		; int
		sub	esp, 8
		lea	ecx, [esp+1A4h+var_18] ; Src
		fstp	[esp+1A4h+var_1A4] ; double
		call	sub_10005750
		jmp	loc_1000621C
; ---------------------------------------------------------------------------

loc_10005ED4:				; CODE XREF: sub_10005C10+263j
		mov	eax, [esp+198h+var_188]
		fld	qword ptr [eax]
		mov	ecx, [esp+198h+var_16C]	; Src
		mov	edi, [esp+198h+var_174]
		fst	qword ptr [esp+198h+lpWideCharStr]
		add	eax, 8
		push	ebp		; int
		sub	esp, 8
		fstp	[esp+1A4h+var_1A4] ; double
		mov	[esp+1A4h+var_188], eax
		call	sub_10005750
		jmp	loc_1000621C
; ---------------------------------------------------------------------------

loc_10005EFE:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E25 case 99
		jz	short loc_10005F12
		mov	eax, [esp+198h+var_170]
		mov	cl, [eax+8]
		mov	byte ptr [esp+198h+lpWideCharStr], cl
		jmp	short loc_10005F23
; ---------------------------------------------------------------------------

loc_10005F12:				; CODE XREF: sub_10005C10+2F3j
		mov	eax, [esp+198h+var_188]
		mov	dl, [eax]
		add	eax, 4
		mov	[esp+198h+var_188], eax
		mov	byte ptr [esp+198h+lpWideCharStr], dl

loc_10005F23:				; CODE XREF: sub_10005C10+300j
		mov	edi, [esp+198h+var_17C]
		and	edi, 1
		jnz	short loc_10005F53
		cmp	ebx, 1
		jle	short loc_10005F52

loc_10005F31:				; CODE XREF: sub_10005C10+340j
		mov	eax, [esp+198h+var_174]
		push	1
		push	offset word_10028648
		push	eax
		mov	eax, [eax]
		dec	ebx
		call	eax
		add	esp, 0Ch
		test	eax, eax
		js	loc_10006260
		cmp	ebx, 1
		jg	short loc_10005F31

loc_10005F52:				; CODE XREF: sub_10005C10+31Fj
		dec	ebx

loc_10005F53:				; CODE XREF: sub_10005C10+31Aj
		mov	eax, [esp+198h+var_174]
		mov	edx, [eax]
		push	1
		lea	ecx, [esp+19Ch+lpWideCharStr]
		push	ecx
		push	eax
		call	edx
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		js	loc_1000625E
		test	edi, edi
		jz	loc_10006225	; jumptable 10005E48 default case
		cmp	ebx, 1
		jle	loc_10006225	; jumptable 10005E48 default case
		mov	edi, [esp+198h+var_174]

loc_10005F85:				; CODE XREF: sub_10005C10+392j
		mov	eax, [edi]
		push	1
		push	offset word_10028648
		push	edi
		dec	ebx
		call	eax
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		js	loc_1000625E
		cmp	ebx, 1
		jg	short loc_10005F85
		jmp	loc_10006225	; jumptable 10005E48 default case
; ---------------------------------------------------------------------------

loc_10005FA9:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		mov	edx, 10h	; jumptable 10005E25 case 112
		mov	edi, 5
		mov	[esp+198h+var_16C], edx
		jmp	loc_10005E48
; ---------------------------------------------------------------------------

loc_10005FBC:				; CODE XREF: sub_10005C10:loc_10005E48j
					; DATA XREF: .text:off_100062F4o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E48 cases	0,2,4
		jz	short loc_10005FCC
		mov	ecx, [esp+198h+var_170]
		mov	eax, [ecx+8]
		jmp	short loc_10005FDA
; ---------------------------------------------------------------------------

loc_10005FCC:				; CODE XREF: sub_10005C10+3B1j
		mov	eax, [esp+198h+var_188]
		add	eax, 4
		mov	[esp+198h+var_188], eax
		mov	eax, [eax-4]

loc_10005FDA:				; CODE XREF: sub_10005C10+3BAj
		mov	[esp+198h+lpWideCharStr], eax
		test	eax, eax
		jns	short loc_10006037
		neg	eax
		or	[esp+198h+var_17C], 10h
		jmp	short loc_10006033
; ---------------------------------------------------------------------------

loc_10005FEB:				; CODE XREF: sub_10005C10:loc_10005E48j
					; DATA XREF: .text:off_100062F4o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E48 case 1
		jz	short loc_10006000
		mov	eax, [esp+198h+var_170]
		mov	eax, [eax+8]
		and	eax, 0FFFFh
		jmp	short loc_10006033
; ---------------------------------------------------------------------------

loc_10006000:				; CODE XREF: sub_10005C10+3E0j
		mov	eax, [esp+198h+var_188]
		add	eax, 4
		mov	[esp+198h+var_188], eax
		mov	eax, [eax-4]
		and	eax, 0FFFFh
		jmp	short loc_10006033
; ---------------------------------------------------------------------------

loc_10006015:				; CODE XREF: sub_10005C10:loc_10005E48j
					; DATA XREF: .text:off_100062F4o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E48 cases	3,5
		jz	short loc_10006025
		mov	eax, [esp+198h+var_170]
		mov	eax, [eax+8]
		jmp	short loc_10006033
; ---------------------------------------------------------------------------

loc_10006025:				; CODE XREF: sub_10005C10+40Aj
		mov	eax, [esp+198h+var_188]
		add	eax, 4
		mov	[esp+198h+var_188], eax
		mov	eax, [eax-4]

loc_10006033:				; CODE XREF: sub_10005C10+3D9j
					; sub_10005C10+3EEj ...
		mov	[esp+198h+lpWideCharStr], eax

loc_10006037:				; CODE XREF: sub_10005C10+3D0j
		mov	ecx, [esp+198h+var_160]
		mov	ebx, [esp+198h+var_168]
		push	ecx
		mov	ecx, [esp+19Ch+var_17C]
		push	ecx
		mov	ecx, [esp+1A0h+var_164]
		push	edi
		push	ecx
		mov	ecx, [esp+1A8h+var_174]
		push	eax
		call	sub_100055B0
		add	esp, 14h
		jmp	loc_1000621F
; ---------------------------------------------------------------------------

loc_1000605D:				; CODE XREF: sub_10005C10:loc_10005E48j
					; DATA XREF: .text:off_100062F4o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E48 case 6
		jz	short loc_10006074
		mov	ecx, [esp+198h+var_170]
		mov	eax, [ecx+8]
		mov	[esp+198h+lpWideCharStr], eax
		mov	ecx, [ecx+0Ch]
		jmp	short loc_10006088
; ---------------------------------------------------------------------------

loc_10006074:				; CODE XREF: sub_10005C10+452j
		mov	ecx, [esp+198h+var_188]
		mov	eax, [ecx]
		add	ecx, 8
		mov	[esp+198h+var_188], ecx
		mov	ecx, [ecx-4]
		mov	[esp+198h+lpWideCharStr], eax

loc_10006088:				; CODE XREF: sub_10005C10+462j
		mov	[esp+198h+lpWideCharStr+4], ecx
		test	ecx, ecx
		jg	short loc_100060D3
		jl	short loc_10006096
		test	eax, eax
		jnb	short loc_100060D3

loc_10006096:				; CODE XREF: sub_10005C10+480j
		neg	eax
		adc	ecx, 0
		neg	ecx
		or	[esp+198h+var_17C], 10h
		jmp	short loc_100060CB
; ---------------------------------------------------------------------------

loc_100060A4:				; CODE XREF: sub_10005C10:loc_10005E48j
					; DATA XREF: .text:off_100062F4o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E48 case 7
		jz	short loc_100060BB
		mov	ecx, [esp+198h+var_170]
		mov	eax, [ecx+8]
		mov	[esp+198h+lpWideCharStr], eax
		mov	ecx, [ecx+0Ch]
		jmp	short loc_100060CF
; ---------------------------------------------------------------------------

loc_100060BB:				; CODE XREF: sub_10005C10+499j
		mov	ecx, [esp+198h+var_188]
		mov	eax, [ecx]
		add	ecx, 8
		mov	[esp+198h+var_188], ecx
		mov	ecx, [ecx-4]

loc_100060CB:				; CODE XREF: sub_10005C10+492j
		mov	[esp+198h+lpWideCharStr], eax

loc_100060CF:				; CODE XREF: sub_10005C10+4A9j
		mov	[esp+198h+lpWideCharStr+4], ecx

loc_100060D3:				; CODE XREF: sub_10005C10+47Ej
					; sub_10005C10+484j
		mov	edx, [esp+198h+var_160]
		push	edx
		mov	edx, [esp+19Ch+var_17C]
		push	edx
		mov	edx, [esp+1A0h+var_16C]
		push	edi
		push	edx
		mov	edx, [esp+1A8h+var_168]
		push	edx
		push	ebx
		push	ecx
		push	eax
		mov	eax, [esp+1B8h+var_174]
		push	eax
		call	sub_10005650
		add	esp, 24h
		jmp	loc_1000621F
; ---------------------------------------------------------------------------

loc_100060FD:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E25 case 83
		jz	short loc_1000610D
		mov	ecx, [esp+198h+var_170]
		mov	eax, [ecx+8]
		jmp	short loc_1000611B
; ---------------------------------------------------------------------------

loc_1000610D:				; CODE XREF: sub_10005C10+4F2j
		mov	eax, [esp+198h+var_188]
		add	eax, 4
		mov	[esp+198h+var_188], eax
		mov	eax, [eax-4]

loc_1000611B:				; CODE XREF: sub_10005C10+4FBj
		mov	ebx, ds:WideCharToMultiByte
		push	0		; lpUsedDefaultChar
		push	0		; lpDefaultChar
		push	0		; cbMultiByte
		push	0		; lpMultiByteStr
		push	0FFFFFFFFh	; cchWideChar
		push	eax		; lpWideCharStr
		push	0		; dwFlags
		push	0		; CodePage
		mov	[esp+1B8h+lpWideCharStr], eax
		call	ebx ; WideCharToMultiByte
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10006141
		mov	esi, 1

loc_10006141:				; CODE XREF: sub_10005C10+52Aj
		push	esi		; Size
		call	PR_Malloc
		mov	edx, [esp+19Ch+lpWideCharStr]
		add	esp, 4
		push	0		; lpUsedDefaultChar
		push	0		; lpDefaultChar
		push	esi		; cbMultiByte
		mov	edi, eax
		push	edi		; lpMultiByteStr
		push	0FFFFFFFFh	; cchWideChar
		push	edx		; lpWideCharStr
		push	0		; dwFlags
		push	0		; CodePage
		call	ebx ; WideCharToMultiByte
		mov	eax, [esp+198h+var_17C]
		mov	ecx, [esp+198h+var_168]
		mov	byte ptr [esi+edi-1], 0
		mov	esi, [esp+198h+var_174]
		push	eax
		mov	eax, [esp+19Ch+var_164]
		mov	edx, edi
		call	sub_10005820
		push	edi		; Memory
		mov	esi, eax
		call	PR_Free
		add	esp, 8
		jmp	loc_10006221
; ---------------------------------------------------------------------------

loc_1000618C:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E25 case 115
		jz	short loc_1000619C
		mov	ecx, [esp+198h+var_170]
		mov	esi, [ecx+8]
		jmp	short loc_100061A9
; ---------------------------------------------------------------------------

loc_1000619C:				; CODE XREF: sub_10005C10+581j
		mov	eax, [esp+198h+var_188]
		mov	esi, [eax]
		add	eax, 4
		mov	[esp+198h+var_188], eax

loc_100061A9:				; CODE XREF: sub_10005C10+58Aj
		mov	eax, [esp+198h+var_17C]
		mov	ecx, edx
		mov	[esp+198h+lpWideCharStr], esi
		push	eax
		mov	edx, esi
		mov	esi, [esp+19Ch+var_174]
		mov	eax, ebx
		call	sub_10005820
		add	esp, 4
		jmp	short loc_1000621F
; ---------------------------------------------------------------------------

loc_100061C6:				; CODE XREF: sub_10005C10+215j
					; DATA XREF: .text:off_10006290o
		cmp	[esp+198h+Memory], 0 ; jumptable 10005E25 case 110
		jz	short loc_100061D6
		mov	ecx, [esp+198h+var_170]
		mov	eax, [ecx+8]
		jmp	short loc_100061E4
; ---------------------------------------------------------------------------

loc_100061D6:				; CODE XREF: sub_10005C10+5BBj
		mov	eax, [esp+198h+var_188]
		add	eax, 4
		mov	[esp+198h+var_188], eax
		mov	eax, [eax-4]

loc_100061E4:				; CODE XREF: sub_10005C10+5C4j
		mov	[esp+198h+lpWideCharStr], eax
		test	eax, eax
		jz	short loc_10006225 ; jumptable 10005E48	default	case
		mov	ecx, [esp+198h+var_174]
		mov	edx, [ecx+8]
		sub	edx, [ecx+4]
		mov	[eax], edx
		jmp	short loc_10006225 ; jumptable 10005E48	default	case
; ---------------------------------------------------------------------------

loc_100061FA:				; CODE XREF: sub_10005C10+208j
					; sub_10005C10+215j
					; DATA XREF: ...
		mov	esi, [esp+198h+var_174]	; jumptable 10005E25 default case
		mov	eax, [esi]
		push	1
		push	offset asc_10028658 ; "%"
		push	esi
		call	eax
		add	esp, 0Ch
		test	eax, eax
		js	short loc_10006260
		mov	edx, [esi]
		push	1
		lea	ecx, [ebp-1]
		push	ecx
		push	esi
		call	edx

loc_1000621C:				; CODE XREF: sub_10005C10+84j
					; sub_10005C10+ADj ...
		add	esp, 0Ch

loc_1000621F:				; CODE XREF: sub_10005C10+448j
					; sub_10005C10+4E8j ...
		mov	esi, eax

loc_10006221:				; CODE XREF: sub_10005C10+279j
					; sub_10005C10+577j
		test	esi, esi
		js	short loc_1000625E

loc_10006225:				; CODE XREF: sub_10005C10+232j
					; sub_10005C10+362j ...
		mov	al, [ebp+0]	; jumptable 10005E48 default case
		test	al, al
		jnz	loc_10005C80
		mov	ebx, [esp+198h+Memory]
		mov	edi, [esp+198h+var_174]

loc_10006238:				; CODE XREF: sub_10005C10+64j
		mov	ecx, [edi]
		push	1
		push	offset dword_10028654
		push	edi
		call	ecx
		add	esp, 0Ch
		mov	esi, eax
		test	ebx, ebx
		jz	short loc_1000625E
		lea	edx, [esp+198h+var_158]
		cmp	ebx, edx
		jz	short loc_1000625E
		push	ebx		; Memory
		call	PR_Free
		add	esp, 4

loc_1000625E:				; CODE XREF: sub_10005C10+59j
					; sub_10005C10+35Aj ...
		mov	eax, esi

loc_10006260:				; CODE XREF: sub_10005C10+337j
					; sub_10005C10+5FFj ...
		mov	ecx, [esp+198h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 188h
		retn
; ---------------------------------------------------------------------------

loc_10006279:				; CODE XREF: sub_10005C10+E1j
		lea	eax, [esp+198h+var_158]
		cmp	ecx, eax
		jz	short loc_1000628A
		push	ecx		; Memory
		call	PR_Free
		add	esp, 4

loc_1000628A:				; CODE XREF: sub_10005C10+66Fj
		or	eax, 0FFFFFFFFh
		jmp	short loc_10006260
sub_10005C10	endp

; ---------------------------------------------------------------------------
		align 10h
off_10006290	dd offset loc_10005E6E,	offset loc_100060FD, offset loc_10005E5D
					; DATA XREF: sub_10005C10+215r
		dd offset loc_10005EFE,	offset loc_10005E2C, offset loc_100061C6 ; jump	table for switch statement
		dd offset loc_10005E33,	offset loc_10005FA9, offset loc_1000618C
		dd offset loc_10005E4F,	offset loc_10005E56, offset loc_100061FA
byte_100062C0	db	0,   0Bh,   0Bh,   0Bh ; DATA XREF: sub_10005C10+20Er
		db    0Bh,   0Bh,   0Bh,   0Bh ; indirect table	for switch statement
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,     1,   0Bh
		db    0Bh,   0Bh,   0Bh,     2
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,   0Bh,   0Bh
		db    0Bh,   0Bh,     3,     4
		db	0,     0,     0,   0Bh
		db	4,   0Bh,   0Bh,   0Bh
		db    0Bh,     5,     6,     7
		db    0Bh,   0Bh,     8,   0Bh
		db	9,   0Bh,   0Bh,   0Ah
off_100062F4	dd offset loc_10005FBC	; DATA XREF: sub_10005C10:loc_10005E48r
		dd offset loc_10005FEB	; jump table for switch	statement
		dd offset loc_10005FBC
		dd offset loc_10006015
		dd offset loc_10005FBC
		dd offset loc_10006015
		dd offset loc_1000605D
		dd offset loc_100060A4
		align 10h

loc_10006320:				; DATA XREF: PR_vsxprintf+21o
					; PR_sxprintf+21o
		mov	eax, [esp+8]
		push	esi
		mov	esi, [esp+8]
		mov	ecx, [esi+14h]
		mov	edx, [esi+10h]
		push	edi
		mov	edi, [esp+14h]
		push	edi
		push	eax
		push	ecx
		call	edx
		add	esp, 0Ch
		test	eax, eax
		js	short loc_10006345
		add	[esi+0Ch], edi
		xor	eax, eax

loc_10006345:				; CODE XREF: .text:1000633Ej
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry 401. PR_vsxprintf

; =============== S U B	R O U T	I N E =======================================


		public PR_vsxprintf
PR_vsxprintf	proc near		; DATA XREF: .rdata:off_1002C7C8o

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 18h
		mov	eax, [esp+18h+arg_0]
		mov	edx, [esp+18h+arg_C]
		mov	ecx, [esp+18h+arg_4]
		mov	[esp+18h+var_8], eax
		mov	eax, [esp+18h+arg_8]
		push	edx
		mov	[esp+1Ch+var_4], ecx
		push	eax
		lea	ecx, [esp+20h+var_18]
		mov	[esp+20h+var_18], offset loc_10006320
		mov	[esp+20h+var_C], 0
		call	sub_10005C10
		add	esp, 8
		test	eax, eax
		jns	short loc_10006394
		or	eax, 0FFFFFFFFh
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10006394:				; CODE XREF: PR_vsxprintf+3Bj
		mov	eax, [esp+18h+var_C]
		add	esp, 18h
		retn
PR_vsxprintf	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100063A0	proc near		; DATA XREF: PR_vsmprintf+11o
					; PR_vsprintf_append+7o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi+4]
		mov	ebx, [esi+8]
		mov	ecx, [esi+0Ch]
		push	edi
		mov	edi, [esp+10h+arg_8]
		sub	ebx, eax
		lea	edx, [ebx+edi]
		cmp	edx, ecx
		jb	short loc_100063FC
		mov	edx, edi
		cmp	edi, 20h
		ja	short loc_100063CA
		mov	edx, 20h

loc_100063CA:				; CODE XREF: sub_100063A0+23j
		lea	ebp, [ecx+edx]
		push	ebp		; NewSize
		test	eax, eax
		jz	short loc_100063DD
		push	eax		; Memory
		call	PR_Realloc
		add	esp, 8
		jmp	short loc_100063E5
; ---------------------------------------------------------------------------

loc_100063DD:				; CODE XREF: sub_100063A0+30j
		call	PR_Malloc
		add	esp, 4

loc_100063E5:				; CODE XREF: sub_100063A0+3Bj
		test	eax, eax
		jnz	short loc_100063F1
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100063F1:				; CODE XREF: sub_100063A0+47j
		mov	[esi+4], eax
		add	eax, ebx
		mov	[esi+0Ch], ebp
		mov	[esi+8], eax

loc_100063FC:				; CODE XREF: sub_100063A0+1Cj
		test	edi, edi
		jz	short loc_10006420
		mov	eax, [esp+10h+arg_4]
		mov	ecx, 1
		lea	esp, [esp+0]

loc_10006410:				; CODE XREF: sub_100063A0+7Ej
		mov	bl, [eax]
		mov	edx, [esi+8]
		mov	[edx], bl
		add	[esi+8], ecx
		add	eax, ecx
		sub	edi, ecx
		jnz	short loc_10006410

loc_10006420:				; CODE XREF: sub_100063A0+5Ej
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_100063A0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 391. PR_smprintf_free

; =============== S U B	R O U T	I N E =======================================


; void __cdecl PR_smprintf_free(void *Memory)
		public PR_smprintf_free
PR_smprintf_free proc near		; CODE XREF: PR_LogPrint+38Fp
					; PR_LogPrint+3ABp ...
		jmp	PR_Free
PR_smprintf_free endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 398. PR_vsmprintf

; =============== S U B	R O U T	I N E =======================================


		public PR_vsmprintf
PR_vsmprintf	proc near		; CODE XREF: PR_LogPrint+105p
					; PR_vfprintf+Bp ...

var_18		= dword	ptr -18h
Memory		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 18h
		mov	eax, [esp+18h+arg_4]
		mov	ecx, [esp+18h+arg_0]
		push	eax
		push	ecx
		lea	ecx, [esp+20h+var_18]
		mov	[esp+20h+var_18], offset sub_100063A0
		mov	[esp+20h+Memory], 0
		mov	[esp+20h+var_10], 0
		mov	[esp+20h+var_C], 0
		call	sub_10005C10
		add	esp, 8
		test	eax, eax
		mov	eax, [esp+18h+Memory]
		jns	short loc_10006490
		test	eax, eax
		jz	short loc_1000648E
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_1000648E:				; CODE XREF: PR_vsmprintf+43j
		xor	eax, eax

loc_10006490:				; CODE XREF: PR_vsmprintf+3Fj
		add	esp, 18h
		retn
PR_vsmprintf	endp

; ---------------------------------------------------------------------------
		align 10h

loc_100064A0:				; DATA XREF: PR_vsnprintf+29o
					; PR_snprintf+29o
		mov	eax, [esp+4]
		mov	edx, [eax+0Ch]
		add	edx, [eax+4]
		mov	ecx, [esp+0Ch]
		sub	edx, [eax+8]
		cmp	ecx, edx
		jbe	short loc_100064B7
		mov	ecx, edx

loc_100064B7:				; CODE XREF: .text:100064B3j
		test	ecx, ecx
		jz	short loc_100064D1
		push	ebx
		push	esi
		mov	esi, [esp+10h]

loc_100064C1:				; CODE XREF: .text:100064CDj
		mov	bl, [esi]
		mov	edx, [eax+8]
		mov	[edx], bl
		inc	dword ptr [eax+8]
		inc	esi
		dec	ecx
		jnz	short loc_100064C1
		pop	esi
		pop	ebx

loc_100064D1:				; CODE XREF: .text:100064B9j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry 399. PR_vsnprintf

; =============== S U B	R O U T	I N E =======================================


		public PR_vsnprintf
PR_vsnprintf	proc near		; CODE XREF: PR_LogPrint+DEp
					; sub_100173B0+25p
					; DATA XREF: ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_4]
		sub	esp, 18h
		test	ecx, ecx
		jle	short loc_1000653C
		mov	eax, [esp+18h+arg_0]
		mov	[esp+18h+var_14], eax
		mov	[esp+18h+var_10], eax
		mov	eax, [esp+18h+arg_C]
		mov	[esp+18h+var_C], ecx
		mov	ecx, [esp+18h+arg_8]
		push	eax
		push	ecx
		lea	ecx, [esp+20h+var_18]
		mov	[esp+20h+var_18], offset loc_100064A0
		call	sub_10005C10
		mov	eax, [esp+20h+var_10]
		add	esp, 8
		cmp	eax, [esp+18h+var_14]
		jz	short loc_10006531
		cmp	byte ptr [eax-1], 0
		jz	short loc_10006531
		mov	byte ptr [eax-1], 0
		mov	eax, [esp+18h+var_10]

loc_10006531:				; CODE XREF: PR_vsnprintf+41j
					; PR_vsnprintf+47j
		sub	eax, [esp+18h+var_14]
		jz	short loc_1000653C
		dec	eax
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_1000653C:				; CODE XREF: PR_vsnprintf+9j
					; PR_vsnprintf+55j
		xor	eax, eax
		add	esp, 18h
		retn
PR_vsnprintf	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 400. PR_vsprintf_append

; =============== S U B	R O U T	I N E =======================================


		public PR_vsprintf_append
PR_vsprintf_append proc	near		; CODE XREF: PR_sprintf_append+Fp
					; DATA XREF: .rdata:off_1002C7C8o

var_18		= dword	ptr -18h
Memory		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 18h
		mov	edx, [esp+18h+arg_0]
		mov	[esp+18h+var_18], offset sub_100063A0
		test	edx, edx
		jz	short loc_10006583
		mov	eax, edx
		push	esi
		lea	esi, [eax+1]

loc_10006568:				; CODE XREF: PR_vsprintf_append+1Dj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10006568
		sub	eax, esi
		lea	ecx, [eax+edx]
		mov	[esp+1Ch+Memory], edx
		mov	[esp+1Ch+var_10], ecx
		mov	[esp+1Ch+var_C], eax
		pop	esi
		jmp	short loc_1000659B
; ---------------------------------------------------------------------------

loc_10006583:				; CODE XREF: PR_vsprintf_append+10j
		mov	[esp+18h+Memory], 0
		mov	[esp+18h+var_10], 0
		mov	[esp+18h+var_C], 0

loc_1000659B:				; CODE XREF: PR_vsprintf_append+31j
		mov	edx, [esp+18h+arg_8]
		mov	eax, [esp+18h+arg_4]
		push	edx
		push	eax
		lea	ecx, [esp+20h+var_18]
		call	sub_10005C10
		add	esp, 8
		test	eax, eax
		mov	eax, [esp+18h+Memory]
		jns	short loc_100065C8
		test	eax, eax
		jz	short loc_100065C6
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_100065C6:				; CODE XREF: PR_vsprintf_append+6Bj
		xor	eax, eax

loc_100065C8:				; CODE XREF: PR_vsprintf_append+67j
		add	esp, 18h
		retn
PR_vsprintf_append endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 396. PR_sxprintf

; =============== S U B	R O U T	I N E =======================================


		public PR_sxprintf
PR_sxprintf	proc near		; DATA XREF: .rdata:off_1002C7C8o

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		sub	esp, 18h
		mov	eax, [esp+18h+arg_0]
		mov	ecx, [esp+18h+arg_4]
		lea	edx, [esp+18h+arg_C]
		mov	[esp+18h+var_8], eax
		mov	eax, [esp+18h+arg_8]
		push	edx
		mov	[esp+1Ch+var_4], ecx
		push	eax
		lea	ecx, [esp+20h+var_18]
		mov	[esp+20h+var_18], offset loc_10006320
		mov	[esp+20h+var_C], 0
		call	sub_10005C10
		add	esp, 8
		test	eax, eax
		jns	short loc_10006614
		or	eax, 0FFFFFFFFh
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10006614:				; CODE XREF: PR_sxprintf+3Bj
		mov	eax, [esp+18h+var_C]
		add	esp, 18h
		retn
PR_sxprintf	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 390. PR_smprintf

; =============== S U B	R O U T	I N E =======================================


		public PR_smprintf
PR_smprintf	proc near		; CODE XREF: sub_10004F10+1EEp
					; PR_GetLibraryName+2Cp ...

var_18		= dword	ptr -18h
Memory		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		sub	esp, 18h
		mov	ecx, [esp+18h+arg_0]
		lea	eax, [esp+18h+arg_4]
		push	eax
		push	ecx
		lea	ecx, [esp+20h+var_18]
		mov	[esp+20h+var_18], offset sub_100063A0
		mov	[esp+20h+Memory], 0
		mov	[esp+20h+var_10], 0
		mov	[esp+20h+var_C], 0
		call	sub_10005C10
		add	esp, 8
		test	eax, eax
		mov	eax, [esp+18h+Memory]
		jns	short loc_10006670
		test	eax, eax
		jz	short loc_1000666E
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_1000666E:				; CODE XREF: PR_smprintf+43j
		xor	eax, eax

loc_10006670:				; CODE XREF: PR_smprintf+3Fj
		add	esp, 18h
		retn
PR_smprintf	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 392. PR_snprintf

; =============== S U B	R O U T	I N E =======================================


		public PR_snprintf
PR_snprintf	proc near		; CODE XREF: PR_LogPrint+82p
					; PR_LogPrint+B6p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= byte ptr  10h

		mov	ecx, [esp+arg_4]
		sub	esp, 18h
		test	ecx, ecx
		jle	short loc_100066DC
		mov	eax, [esp+18h+arg_0]
		mov	[esp+18h+var_14], eax
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+var_C], ecx
		mov	ecx, [esp+18h+arg_8]
		lea	eax, [esp+18h+arg_C]
		push	eax
		push	ecx
		lea	ecx, [esp+20h+var_18]
		mov	[esp+20h+var_18], offset loc_100064A0
		call	sub_10005C10
		mov	eax, [esp+20h+var_10]
		add	esp, 8
		cmp	eax, [esp+18h+var_14]
		jz	short loc_100066D1
		cmp	byte ptr [eax-1], 0
		jz	short loc_100066D1
		mov	byte ptr [eax-1], 0
		mov	eax, [esp+18h+var_10]

loc_100066D1:				; CODE XREF: PR_snprintf+41j
					; PR_snprintf+47j
		sub	eax, [esp+18h+var_14]
		jz	short loc_100066DC
		dec	eax
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_100066DC:				; CODE XREF: PR_snprintf+9j
					; PR_snprintf+55j
		xor	eax, eax
		add	esp, 18h
		retn
PR_snprintf	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 393. PR_sprintf_append

; =============== S U B	R O U T	I N E =======================================


		public PR_sprintf_append
PR_sprintf_append proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch

		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_0]
		lea	eax, [esp+arg_8]
		push	eax
		push	ecx
		push	edx
		call	PR_vsprintf_append
		add	esp, 0Ch
		retn
PR_sprintf_append endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10006710(int,	int, size_t MaxCount)
sub_10006710	proc near		; CODE XREF: sub_100068A0+228p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
MaxCount	= dword	ptr  0Ch

		sub	esp, 14h
		push	ebx
		push	ebp
		mov	ebp, [esp+1Ch+MaxCount]
		xor	ebx, ebx
		cmp	ebp, ebx
		jl	short loc_10006729
		cmp	ebp, 1
		jz	short loc_10006729
		cmp	ebp, 10h
		jle	short loc_10006741

loc_10006729:				; CODE XREF: sub_10006710+Dj
					; sub_10006710+12j
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, ebx
		jz	short loc_10006741
		mov	ecx, [esp+1Ch+arg_0]
		mov	[eax], ecx
		pop	ebp
		xor	eax, eax
		xor	edx, edx
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10006741:				; CODE XREF: sub_10006710+17j
					; sub_10006710+1Fj
		push	esi
		mov	esi, [esp+20h+arg_0]
		movsx	edx, byte ptr [esi]
		push	edi
		mov	edi, ds:isspace
		push	edx		; C
		call	edi ; isspace
		add	esp, 4
		test	eax, eax
		jz	short loc_1000676F
		lea	ebx, [ebx+0]

loc_10006760:				; CODE XREF: sub_10006710+5Dj
		movsx	eax, byte ptr [esi+1]
		inc	esi
		push	eax		; C
		call	edi ; isspace
		add	esp, 4
		test	eax, eax
		jnz	short loc_10006760

loc_1000676F:				; CODE XREF: sub_10006710+48j
		mov	al, [esi]
		mov	[esp+24h+MaxCount], ebx
		cmp	al, 2Dh
		jnz	short loc_10006783
		mov	[esp+24h+MaxCount], 1
		jmp	short loc_10006787
; ---------------------------------------------------------------------------

loc_10006783:				; CODE XREF: sub_10006710+67j
		cmp	al, 2Bh
		jnz	short loc_10006788

loc_10006787:				; CODE XREF: sub_10006710+71j
		inc	esi

loc_10006788:				; CODE XREF: sub_10006710+75j
		cmp	ebp, 10h
		jnz	short loc_1000679F
		cmp	byte ptr [esi],	30h
		jnz	short loc_100067C9
		mov	al, [esi+1]
		cmp	al, 78h
		jz	short loc_100067C6
		cmp	al, 58h
		jnz	short loc_100067C9
		jmp	short loc_100067C6
; ---------------------------------------------------------------------------

loc_1000679F:				; CODE XREF: sub_10006710+7Bj
		cmp	ebp, ebx
		jnz	short loc_100067C9
		cmp	byte ptr [esi],	30h
		jz	short loc_100067AF
		mov	ebp, 0Ah
		jmp	short loc_100067C9
; ---------------------------------------------------------------------------

loc_100067AF:				; CODE XREF: sub_10006710+96j
		mov	al, [esi+1]
		cmp	al, 78h
		jz	short loc_100067C1
		cmp	al, 58h
		jz	short loc_100067C1
		mov	ebp, 8
		jmp	short loc_100067C9
; ---------------------------------------------------------------------------

loc_100067C1:				; CODE XREF: sub_10006710+A4j
					; sub_10006710+A8j
		mov	ebp, 10h

loc_100067C6:				; CODE XREF: sub_10006710+87j
					; sub_10006710+8Dj
		add	esi, 2

loc_100067C9:				; CODE XREF: sub_10006710+80j
					; sub_10006710+8Bj ...
		cmp	byte ptr [esi],	30h
		mov	eax, ebp
		cdq
		mov	[esp+24h+var_8], eax
		mov	[esp+24h+var_4], edx
		mov	[esp+24h+var_C], esi
		jnz	short loc_100067E6
		lea	ecx, [ecx+0]

loc_100067E0:				; CODE XREF: sub_10006710+D4j
		inc	esi
		cmp	byte ptr [esi],	30h
		jz	short loc_100067E0

loc_100067E6:				; CODE XREF: sub_10006710+CBj
		movsx	ecx, byte ptr [esi]
		push	ebp		; MaxCount
		push	ecx		; C
		xor	edi, edi
		call	ds:tolower
		add	esp, 4
		push	eax		; Val
		push	offset a0123456789ab_0 ; "0123456789abcdef"
		call	ds:memchr
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10006858
		lea	esp, [esp+0]

loc_10006810:				; CODE XREF: sub_10006710+146j
		sub	eax, offset a0123456789ab_0 ; "0123456789abcdef"
		cdq
		mov	[esp+24h+var_10], edx
		mov	edx, [esp+24h+var_4]
		push	edx
		mov	edx, [esp+28h+var_8]
		push	edx
		push	ebx
		push	edi
		mov	edi, eax
		call	sub_10026AB0
		mov	ebx, [esp+24h+var_10]
		add	edi, eax
		movsx	eax, byte ptr [esi+1]
		adc	ebx, edx
		inc	esi
		push	ebp		; MaxCount
		push	eax		; C
		call	ds:tolower
		add	esp, 4
		push	eax		; Val
		push	offset a0123456789ab_0 ; "0123456789abcdef"
		call	ds:memchr
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10006810

loc_10006858:				; CODE XREF: sub_10006710+F7j
		cmp	esi, [esp+24h+var_C]
		jnz	short loc_10006878
		mov	eax, [esp+24h+arg_4]
		test	eax, eax
		jz	short loc_1000686C
		mov	ecx, [esp+24h+arg_0]
		mov	[eax], ecx

loc_1000686C:				; CODE XREF: sub_10006710+154j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		xor	edx, edx
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10006878:				; CODE XREF: sub_10006710+14Cj
		cmp	[esp+24h+MaxCount], 0
		jz	short loc_10006886
		neg	edi
		adc	ebx, 0
		neg	ebx

loc_10006886:				; CODE XREF: sub_10006710+16Dj
		mov	eax, [esp+24h+arg_4]
		test	eax, eax
		jz	short loc_10006890
		mov	[eax], esi

loc_10006890:				; CODE XREF: sub_10006710+17Cj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		mov	edx, ebx
		pop	ebx
		add	esp, 14h
		retn
sub_10006710	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100068A0	proc near		; CODE XREF: sub_10006E30+D2p

var_2C		= dword	ptr -2Ch
MaxCount	= dword	ptr -28h
Str		= byte ptr -24h
var_23		= byte ptr -23h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		mov	eax, [esp+2Ch+arg_0]
		add	eax, 0FFFFFFA8h	; switch 33 cases
		push	ebp
		mov	[esp+30h+var_2C], 0
		cmp	eax, 20h
		ja	loc_10006B69	; jumptable 100068CE default case
		movzx	eax, ds:byte_10006B90[eax]
		jmp	ds:off_10006B7C[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100068D5:				; CODE XREF: sub_100068A0+2Ej
					; DATA XREF: .text:off_10006B7Co
		mov	ebp, 0Ah	; jumptable 100068CE cases 100,117
		jmp	short loc_100068EC
; ---------------------------------------------------------------------------

loc_100068DC:				; CODE XREF: sub_100068A0+2Ej
					; DATA XREF: .text:off_10006B7Co
		xor	ebp, ebp	; jumptable 100068CE case 105
		jmp	short loc_100068EC
; ---------------------------------------------------------------------------

loc_100068E0:				; CODE XREF: sub_100068A0+2Ej
					; DATA XREF: .text:off_10006B7Co
		mov	ebp, 10h	; jumptable 100068CE cases 88,112,120
		jmp	short loc_100068EC
; ---------------------------------------------------------------------------

loc_100068E7:				; CODE XREF: sub_100068A0+2Ej
					; DATA XREF: .text:off_10006B7Co
		mov	ebp, 8		; jumptable 100068CE case 111

loc_100068EC:				; CODE XREF: sub_100068A0+3Aj
					; sub_100068A0+3Ej ...
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_100068F8
		cmp	eax, 1Fh
		jle	short loc_100068FF

loc_100068F8:				; CODE XREF: sub_100068A0+51j
		mov	dword ptr [esi+18h], 1Fh

loc_100068FF:				; CODE XREF: sub_100068A0+56j
		dec	dword ptr [esi+18h]
		push	ebx
		push	edi
		lea	edi, [esp+38h+Str]
		js	short loc_1000691C
		mov	ecx, [esi+8]
		mov	edx, [esi]
		inc	dword ptr [esi+10h]
		push	ecx
		call	edx
		add	esp, 4
		mov	ebx, eax
		jmp	short loc_10006920
; ---------------------------------------------------------------------------

loc_1000691C:				; CODE XREF: sub_100068A0+68j
		mov	ebx, [esp+38h+var_2C]

loc_10006920:				; CODE XREF: sub_100068A0+7Aj
		mov	eax, [esi+18h]
		test	eax, eax
		js	short loc_1000694F
		cmp	ebx, 2Bh
		jz	short loc_10006931
		cmp	ebx, 2Dh
		jnz	short loc_1000694F

loc_10006931:				; CODE XREF: sub_100068A0+8Aj
		dec	eax
		mov	[esp+38h+Str], bl
		lea	edi, [esp+38h+var_23]
		mov	[esi+18h], eax
		js	short loc_1000694F
		mov	eax, [esi+8]
		mov	ecx, [esi]
		inc	dword ptr [esi+10h]
		push	eax
		call	ecx
		add	esp, 4
		mov	ebx, eax

loc_1000694F:				; CODE XREF: sub_100068A0+85j
					; sub_100068A0+8Fj ...
		mov	eax, [esi+18h]
		test	eax, eax
		js	short loc_100069D5
		cmp	ebx, 30h
		jnz	short loc_100069D5
		mov	ecx, 1
		mov	[edi], bl
		add	edi, ecx
		dec	eax
		mov	[esp+38h+var_2C], ecx
		mov	[esi+18h], eax
		js	short loc_10006983
		mov	edx, [esi+8]
		mov	eax, [esi]
		add	[esi+10h], ecx
		push	edx
		call	eax
		add	esp, 4
		mov	ebx, eax
		mov	ecx, 1

loc_10006983:				; CODE XREF: sub_100068A0+CCj
		mov	eax, [esi+18h]
		test	eax, eax
		js	short loc_100069C6
		cmp	ebx, 78h
		jz	short loc_10006994
		cmp	ebx, 58h
		jnz	short loc_100069C6

loc_10006994:				; CODE XREF: sub_100068A0+EDj
		test	ebp, ebp
		jz	short loc_1000699D
		cmp	ebp, 10h
		jnz	short loc_100069C6

loc_1000699D:				; CODE XREF: sub_100068A0+F6j
		mov	[edi], bl
		add	edi, ecx
		dec	eax
		mov	ebp, 10h
		mov	[esi+18h], eax
		js	short loc_100069BC
		add	[esi+10h], ecx
		mov	ecx, [esi+8]
		mov	edx, [esi]
		push	ecx
		call	edx
		add	esp, 4
		mov	ebx, eax

loc_100069BC:				; CODE XREF: sub_100068A0+10Aj
					; sub_100068A0+141j
		mov	[esp+38h+MaxCount], 16h
		jmp	short loc_100069F1
; ---------------------------------------------------------------------------

loc_100069C6:				; CODE XREF: sub_100068A0+E8j
					; sub_100068A0+F2j ...
		test	ebp, ebp
		jnz	short loc_100069D9
		mov	ebp, 8
		mov	[esp+38h+MaxCount], ebp
		jmp	short loc_100069F1
; ---------------------------------------------------------------------------

loc_100069D5:				; CODE XREF: sub_100068A0+B4j
					; sub_100068A0+B9j
		test	ebp, ebp
		jz	short loc_100069E9

loc_100069D9:				; CODE XREF: sub_100068A0+128j
		cmp	ebp, 0Ah
		jz	short loc_100069E9
		cmp	ebp, 8
		jnz	short loc_100069BC
		mov	[esp+38h+MaxCount], ebp
		jmp	short loc_100069F1
; ---------------------------------------------------------------------------

loc_100069E9:				; CODE XREF: sub_100068A0+137j
					; sub_100068A0+13Cj
		mov	[esp+38h+MaxCount], 0Ah

loc_100069F1:				; CODE XREF: sub_100068A0+124j
					; sub_100068A0+133j ...
		cmp	dword ptr [esi+18h], 0
		jl	short loc_10006A4B

loc_100069F7:				; CODE XREF: sub_100068A0+193j
		mov	eax, [esp+38h+MaxCount]
		push	eax		; MaxCount
		push	ebx		; Val
		push	offset a0123456789abcd ; "0123456789abcdefABCDEF"
		call	ds:memchr
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10006A35
		mov	[edi], bl
		inc	edi
		dec	dword ptr [esi+18h]
		js	short loc_10006A27
		mov	ecx, [esi+8]
		mov	edx, [esi]
		inc	dword ptr [esi+10h]
		push	ecx
		call	edx
		add	esp, 4
		mov	ebx, eax

loc_10006A27:				; CODE XREF: sub_100068A0+175j
		cmp	dword ptr [esi+18h], 0
		mov	[esp+38h+var_2C], 1
		jge	short loc_100069F7

loc_10006A35:				; CODE XREF: sub_100068A0+16Dj
		cmp	dword ptr [esi+18h], 0
		jl	short loc_10006A4B
		mov	eax, [esi+8]
		mov	ecx, [esi+4]
		dec	dword ptr [esi+10h]
		push	ebx
		push	eax
		call	ecx
		add	esp, 8

loc_10006A4B:				; CODE XREF: sub_100068A0+155j
					; sub_100068A0+199j
		cmp	[esp+38h+var_2C], 0
		jz	short loc_10006AA1
		cmp	dword ptr [esi+14h], 0
		mov	byte ptr [edi],	0
		jz	loc_10006B55
		mov	eax, [esp+38h+arg_0]
		cmp	eax, 64h
		jz	short loc_10006AB6
		cmp	eax, 69h
		jz	short loc_10006AB6
		mov	edi, 4
		push	ebp		; Radix
		push	0		; EndPtr
		cmp	[esi+1Ch], edi
		jz	short loc_10006AC3
		lea	eax, [esp+40h+Str]
		push	eax		; Str
		call	ds:strtoul
		mov	ecx, [esi+1Ch]
		add	esp, 0Ch
		test	ecx, ecx
		jz	loc_10006B43
		cmp	ecx, 1
		jz	short loc_10006B13
		cmp	ecx, 2
		jz	loc_10006B43

loc_10006AA1:				; CODE XREF: sub_100068A0+1B0j
					; sub_100068A0+29Dj
		pop	edi
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	ebp
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10006AB6:				; CODE XREF: sub_100068A0+1C6j
					; sub_100068A0+1CBj
		mov	edi, 4
		push	ebp		; MaxCount
		push	0		; int
		cmp	[esi+1Ch], edi
		jnz	short loc_10006AF9

loc_10006AC3:				; CODE XREF: sub_100068A0+1D8j
		lea	edx, [esp+40h+Str]
		push	edx		; int
		call	sub_10006710
		add	[esi+0Ch], edi
		mov	ecx, [esi+0Ch]
		mov	ecx, [ecx-4]
		add	esp, 0Ch
		pop	edi
		mov	[ecx], eax
		pop	ebx
		mov	[ecx+4], edx
		mov	dword ptr [esi+20h], 1
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10006AF9:				; CODE XREF: sub_100068A0+221j
		lea	eax, [esp+40h+Str]
		push	eax		; Str
		call	ds:strtol
		mov	ecx, [esi+1Ch]
		add	esp, 0Ch
		test	ecx, ecx
		jz	short loc_10006B43
		cmp	ecx, 1
		jnz	short loc_10006B3A

loc_10006B13:				; CODE XREF: sub_100068A0+1F6j
		add	[esi+0Ch], edi
		mov	ecx, [esi+0Ch]
		mov	edx, [ecx-4]
		pop	edi
		mov	[edx], ax
		pop	ebx
		mov	dword ptr [esi+20h], 1
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10006B3A:				; CODE XREF: sub_100068A0+271j
		cmp	ecx, 2
		jnz	loc_10006AA1

loc_10006B43:				; CODE XREF: sub_100068A0+1EDj
					; sub_100068A0+1FBj ...
		add	[esi+0Ch], edi
		mov	ecx, [esi+0Ch]
		mov	ecx, [ecx-4]
		mov	[ecx], eax
		mov	dword ptr [esi+20h], 1

loc_10006B55:				; CODE XREF: sub_100068A0+1B9j
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_10006B69:				; CODE XREF: sub_100068A0+21j
					; sub_100068A0+2Ej
					; DATA XREF: ...
		mov	ecx, [esp+30h+var_4] ; jumptable 100068CE default case
		pop	ebp
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_100068A0	endp

; ---------------------------------------------------------------------------
off_10006B7C	dd offset loc_100068E0	; DATA XREF: sub_100068A0+2Er
		dd offset loc_100068D5	; jump table for switch	statement
		dd offset loc_100068DC
		dd offset loc_100068E7
		dd offset loc_10006B69
byte_10006B90	db	0,     4,     4,     4 ; DATA XREF: sub_100068A0+27r
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     4,     4,     4
		db	1,     4,     4,     4
		db	4,     2,     4,     4
		db	4,     4,     4,     3
		db	0,     4,     4,     4
		db	4,     1,     4,     4
		db	0
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006BC0	proc near		; CODE XREF: sub_10006E30+EFp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_23		= byte ptr -23h
var_4		= dword	ptr -4

		sub	esp, 28h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		mov	eax, [esi+18h]
		push	edi
		mov	[esp+38h+var_28], 0
		test	eax, eax
		jz	short loc_10006BE8
		cmp	eax, 1Fh
		jle	short loc_10006BEF

loc_10006BE8:				; CODE XREF: sub_10006BC0+21j
		mov	dword ptr [esi+18h], 1Fh

loc_10006BEF:				; CODE XREF: sub_10006BC0+26j
		dec	dword ptr [esi+18h]
		lea	edi, [esp+38h+var_24]
		mov	ebp, 1
		js	short loc_10006C0F
		mov	eax, [esi+8]
		mov	ecx, [esi]
		add	[esi+10h], ebp
		push	eax
		call	ecx
		add	esp, 4
		mov	ebx, eax
		jmp	short loc_10006C13
; ---------------------------------------------------------------------------

loc_10006C0F:				; CODE XREF: sub_10006BC0+3Bj
		mov	ebx, [esp+38h+var_28]

loc_10006C13:				; CODE XREF: sub_10006BC0+4Dj
		mov	eax, [esi+18h]
		test	eax, eax
		js	short loc_10006C42
		cmp	ebx, 2Bh
		jz	short loc_10006C24
		cmp	ebx, 2Dh
		jnz	short loc_10006C42

loc_10006C24:				; CODE XREF: sub_10006BC0+5Dj
		dec	eax
		mov	[esp+38h+var_24], bl
		lea	edi, [esp+38h+var_23]
		mov	[esi+18h], eax
		js	short loc_10006C42
		mov	edx, [esi+8]
		mov	eax, [esi]
		add	[esi+10h], ebp
		push	edx
		call	eax
		add	esp, 4
		mov	ebx, eax

loc_10006C42:				; CODE XREF: sub_10006BC0+58j
					; sub_10006BC0+62j ...
		cmp	dword ptr [esi+18h], 0
		jl	short loc_10006C79

loc_10006C48:				; CODE XREF: sub_10006BC0+B7j
		push	ebx		; C
		call	ds:isdigit
		add	esp, 4
		test	eax, eax
		jz	short loc_10006C79
		mov	[edi], bl
		add	edi, ebp
		dec	dword ptr [esi+18h]
		js	short loc_10006C6F
		mov	ecx, [esi+8]
		mov	edx, [esi]
		add	[esi+10h], ebp
		push	ecx
		call	edx
		add	esp, 4
		mov	ebx, eax

loc_10006C6F:				; CODE XREF: sub_10006BC0+9Dj
		cmp	dword ptr [esi+18h], 0
		mov	[esp+38h+var_28], ebp
		jge	short loc_10006C48

loc_10006C79:				; CODE XREF: sub_10006BC0+86j
					; sub_10006BC0+94j
		mov	eax, [esi+18h]
		test	eax, eax
		js	short loc_10006CD6
		cmp	ebx, 2Eh
		jnz	short loc_10006CD6
		mov	[edi], bl
		add	edi, ebp
		dec	eax
		mov	[esi+18h], eax
		js	short loc_10006C9F
		mov	eax, [esi+8]
		mov	ecx, [esi]
		add	[esi+10h], ebp
		push	eax
		call	ecx
		add	esp, 4
		mov	ebx, eax

loc_10006C9F:				; CODE XREF: sub_10006BC0+CDj
		cmp	dword ptr [esi+18h], 0
		jl	short loc_10006CD6

loc_10006CA5:				; CODE XREF: sub_10006BC0+114j
		push	ebx		; C
		call	ds:isdigit
		add	esp, 4
		test	eax, eax
		jz	short loc_10006CD6
		mov	[edi], bl
		add	edi, ebp
		dec	dword ptr [esi+18h]
		js	short loc_10006CCC
		mov	edx, [esi+8]
		mov	eax, [esi]
		add	[esi+10h], ebp
		push	edx
		call	eax
		add	esp, 4
		mov	ebx, eax

loc_10006CCC:				; CODE XREF: sub_10006BC0+FAj
		cmp	dword ptr [esi+18h], 0
		mov	[esp+38h+var_28], ebp
		jge	short loc_10006CA5

loc_10006CD6:				; CODE XREF: sub_10006BC0+BEj
					; sub_10006BC0+C3j ...
		mov	eax, [esi+18h]
		test	eax, eax
		js	loc_10006D6E
		cmp	ebx, 65h
		jz	short loc_10006CEF
		cmp	ebx, 45h
		jnz	loc_10006D6E

loc_10006CEF:				; CODE XREF: sub_10006BC0+124j
		cmp	[esp+38h+var_28], 0
		jz	short loc_10006D6E
		mov	[edi], bl
		add	edi, ebp
		dec	eax
		mov	[esi+18h], eax
		js	short loc_10006D10
		mov	ecx, [esi+8]
		mov	edx, [esi]
		add	[esi+10h], ebp
		push	ecx
		call	edx
		add	esp, 4
		mov	ebx, eax

loc_10006D10:				; CODE XREF: sub_10006BC0+13Ej
		mov	eax, [esi+18h]
		test	eax, eax
		js	short loc_10006D3B
		cmp	ebx, 2Bh
		jz	short loc_10006D21
		cmp	ebx, 2Dh
		jnz	short loc_10006D3B

loc_10006D21:				; CODE XREF: sub_10006BC0+15Aj
		mov	[edi], bl
		add	edi, ebp
		dec	eax
		mov	[esi+18h], eax
		js	short loc_10006D3B
		mov	eax, [esi+8]
		mov	ecx, [esi]
		add	[esi+10h], ebp
		push	eax
		call	ecx
		add	esp, 4
		mov	ebx, eax

loc_10006D3B:				; CODE XREF: sub_10006BC0+155j
					; sub_10006BC0+15Fj ...
		cmp	dword ptr [esi+18h], 0
		jl	short loc_10006D84

loc_10006D41:				; CODE XREF: sub_10006BC0+1ACj
		push	ebx		; C
		call	ds:isdigit
		add	esp, 4
		test	eax, eax
		jz	short loc_10006D6E
		mov	[edi], bl
		add	edi, ebp
		dec	dword ptr [esi+18h]
		js	short loc_10006D68
		mov	edx, [esi+8]
		mov	eax, [esi]
		add	[esi+10h], ebp
		push	edx
		call	eax
		add	esp, 4
		mov	ebx, eax

loc_10006D68:				; CODE XREF: sub_10006BC0+196j
		cmp	dword ptr [esi+18h], 0
		jge	short loc_10006D41

loc_10006D6E:				; CODE XREF: sub_10006BC0+11Bj
					; sub_10006BC0+129j ...
		cmp	dword ptr [esi+18h], 0
		jl	short loc_10006D84
		mov	ecx, [esi+8]
		mov	edx, [esi+4]
		dec	dword ptr [esi+10h]
		push	ebx
		push	ecx
		call	edx
		add	esp, 8

loc_10006D84:				; CODE XREF: sub_10006BC0+17Fj
					; sub_10006BC0+1B2j
		cmp	[esp+38h+var_28], 0
		jnz	short loc_10006DA1
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10006DA1:				; CODE XREF: sub_10006BC0+1C9j
		cmp	dword ptr [esi+14h], 0
		mov	byte ptr [edi],	0
		jz	short loc_10006E11
		lea	eax, [esp+38h+var_24]
		push	0
		push	eax
		call	PR_strtod
		mov	eax, [esi+1Ch]
		add	dword ptr [esi+0Ch], 4
		add	esp, 8
		mov	[esi+20h], ebp
		mov	esi, [esi+0Ch]
		cmp	eax, 2
		jnz	short loc_10006DE5
		mov	ecx, [esi-4]
		pop	edi
		fstp	qword ptr [ecx]
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10006DE5:				; CODE XREF: sub_10006BC0+209j
		cmp	eax, 3
		jnz	short loc_10006E04
		mov	edx, [esi-4]
		pop	edi
		fstp	qword ptr [edx]
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10006E04:				; CODE XREF: sub_10006BC0+228j
		mov	eax, [esi-4]
		fstp	[esp+38h+var_28]
		fld	[esp+38h+var_28]
		fstp	dword ptr [eax]

loc_10006E11:				; CODE XREF: sub_10006BC0+1E8j
		mov	ecx, [esp+38h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
sub_10006BC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10006E30	proc near		; CODE XREF: sub_100071F0+FFp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		xor	ebp, ebp
		mov	ebx, eax
		mov	esi, ecx
		mov	[esi+20h], ebp
		mov	al, [ebx]
		push	edi
		mov	[esp+1Ch+var_C], ebp
		mov	[esp+1Ch+var_4], ebx
		cmp	al, 63h
		jz	short loc_10006E81
		cmp	al, 6Eh
		jz	short loc_10006E81
		cmp	al, 5Bh
		jz	short loc_10006E81

loc_10006E56:				; CODE XREF: sub_10006E30+3Fj
		mov	eax, [esi+8]
		mov	ecx, [esi]
		inc	dword ptr [esi+10h]
		push	eax
		call	ecx
		mov	edi, eax
		push	edi		; C
		call	ds:isspace
		add	esp, 8
		test	eax, eax
		jnz	short loc_10006E56
		mov	edx, [esi+8]
		mov	eax, [esi+4]
		dec	dword ptr [esi+10h]
		push	edi
		push	edx
		call	eax
		add	esp, 8

loc_10006E81:				; CODE XREF: sub_10006E30+1Cj
					; sub_10006E30+20j ...
		movsx	eax, byte ptr [ebx]
		lea	ecx, [eax-25h]	; switch 84 cases
		cmp	ecx, 53h
		ja	loc_10006F13	; jumptable 10006E97 default case
		movzx	ecx, ds:byte_10007180[ecx]
		jmp	ds:off_10007160[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10006E9E:				; CODE XREF: sub_10006E30+67j
					; DATA XREF: .text:off_10007160o
		cmp	[esi+14h], ebp	; jumptable 10006E97 case 99
		jz	short loc_10006EAF
		add	dword ptr [esi+0Ch], 4
		mov	eax, [esi+0Ch]
		mov	edx, [eax-4]
		mov	ebp, edx

loc_10006EAF:				; CODE XREF: sub_10006E30+71j
		cmp	dword ptr [esi+18h], 0
		mov	edi, 1
		jnz	short loc_10006EBF
		mov	[esi+18h], edi
		test	edi, edi

loc_10006EBF:				; CODE XREF: sub_10006E30+88j
		jle	short loc_10006EE8

loc_10006EC1:				; CODE XREF: sub_10006E30+B6j
		mov	eax, [esi+8]
		mov	ecx, [esi]
		add	[esi+10h], edi
		push	eax
		call	ecx
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10006F13 ; jumptable 10006E97	default	case
		cmp	dword ptr [esi+14h], 0
		jz	short loc_10006EDF
		mov	[ebp+0], al
		add	ebp, edi

loc_10006EDF:				; CODE XREF: sub_10006E30+A8j
		dec	dword ptr [esi+18h]
		cmp	dword ptr [esi+18h], 0
		jg	short loc_10006EC1

loc_10006EE8:				; CODE XREF: sub_10006E30:loc_10006EBFj
		cmp	dword ptr [esi+14h], 0
		jz	loc_1000712D	; jumptable 10006F3F default case
		mov	eax, [esp+1Ch+var_4]
		mov	[esi+20h], edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10006F01:				; CODE XREF: sub_10006E30+67j
					; DATA XREF: .text:off_10007160o
		push	eax		; jumptable 10006E97 cases 88,100,105,111,112,117,120
		call	sub_100068A0
		add	esp, 4

loc_10006F0A:				; CODE XREF: sub_10006E30+F4j
		cmp	eax, 0FFFFFFFFh
		jnz	loc_1000712D	; jumptable 10006F3F default case

loc_10006F13:				; CODE XREF: sub_10006E30+5Aj
					; sub_10006E30+67j ...
		pop	edi		; jumptable 10006E97 default case
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10006F1D:				; CODE XREF: sub_10006E30+67j
					; DATA XREF: .text:off_10007160o
		mov	ecx, esi	; jumptable 10006E97 cases 69,71,101-103
		call	sub_10006BC0
		jmp	short loc_10006F0A
; ---------------------------------------------------------------------------

loc_10006F26:				; CODE XREF: sub_10006E30+67j
					; DATA XREF: .text:off_10007160o
		cmp	[esi+14h], ebp	; jumptable 10006E97 case 110
		jz	loc_1000712D	; jumptable 10006F3F default case
		mov	eax, [esi+1Ch]
		mov	ecx, 4
		cmp	eax, ecx	; switch 5 cases
		ja	loc_1000712D	; jumptable 10006F3F default case
		jmp	ds:off_100071D4[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10006F46:				; CODE XREF: sub_10006E30+10Fj
					; DATA XREF: .text:off_100071D4o
		add	[esi+0Ch], ecx	; jumptable 10006F3F case 0
		mov	eax, [esi+0Ch]
		mov	edx, [eax-4]
		mov	eax, [esi+10h]
		pop	edi
		pop	esi
		pop	ebp
		mov	[edx], eax
		mov	eax, [esp+10h+var_4]
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10006F60:				; CODE XREF: sub_10006E30+10Fj
					; DATA XREF: .text:off_100071D4o
		add	[esi+0Ch], ecx	; jumptable 10006F3F case 1
		mov	eax, [esi+0Ch]
		mov	dx, [esi+10h]
		mov	ecx, [eax-4]
		mov	eax, [esp+1Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[ecx], dx
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10006F7C:				; CODE XREF: sub_10006E30+10Fj
					; DATA XREF: .text:off_100071D4o
		add	[esi+0Ch], ecx	; jumptable 10006F3F case 2
		mov	eax, [esi+0Ch]
		mov	ecx, [esi+10h]
		mov	eax, [eax-4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ecx
		mov	eax, [esp+10h+var_4]
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10006F96:				; CODE XREF: sub_10006E30+10Fj
					; DATA XREF: .text:off_100071D4o
		add	[esi+0Ch], ecx	; jumptable 10006F3F case 4
		mov	eax, [esi+10h]
		mov	ecx, [esi+0Ch]
		mov	ecx, [ecx-4]
		pop	edi
		cdq
		pop	esi
		mov	[ecx], eax
		mov	eax, [esp+14h+var_4]
		pop	ebp
		mov	[ecx+4], edx
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10006FB4:				; CODE XREF: sub_10006E30+67j
					; DATA XREF: .text:off_10007160o
		cmp	[esi+18h], ebp	; jumptable 10006E97 case 115
		jnz	short loc_10006FC0
		mov	dword ptr [esi+18h], 7FFFFFFFh

loc_10006FC0:				; CODE XREF: sub_10006E30+187j
		cmp	[esi+14h], ebp
		jz	short loc_10006FD1
		add	dword ptr [esi+0Ch], 4
		mov	eax, [esi+0Ch]
		mov	edx, [eax-4]
		mov	ebp, edx

loc_10006FD1:				; CODE XREF: sub_10006E30+193j
		cmp	dword ptr [esi+18h], 0
		jle	short loc_10007020

loc_10006FD7:				; CODE XREF: sub_10006E30+1DCj
		mov	eax, [esi+8]
		mov	ecx, [esi]
		inc	dword ptr [esi+10h]
		push	eax
		call	ecx
		mov	ebx, eax
		or	edi, 0FFFFFFFFh
		add	esp, 4
		cmp	ebx, edi
		jz	short loc_10007010
		push	ebx		; C
		call	ds:isspace
		add	esp, 4
		test	eax, eax
		jnz	short loc_10007010
		cmp	[esi+14h], eax
		jz	short loc_10007005
		mov	[ebp+0], bl
		inc	ebp

loc_10007005:				; CODE XREF: sub_10006E30+1CFj
		add	[esi+18h], edi
		cmp	dword ptr [esi+18h], 0
		jg	short loc_10006FD7
		jmp	short loc_10007020
; ---------------------------------------------------------------------------

loc_10007010:				; CODE XREF: sub_10006E30+1BCj
					; sub_10006E30+1CAj
		mov	edx, [esi+8]
		mov	eax, [esi+4]
		add	[esi+10h], edi
		push	ebx
		push	edx
		call	eax
		add	esp, 8

loc_10007020:				; CODE XREF: sub_10006E30+1A5j
					; sub_10006E30+1DEj
		cmp	dword ptr [esi+14h], 0
		jz	loc_1000712D	; jumptable 10006F3F default case
		mov	eax, [esp+1Ch+var_4]
		pop	edi
		mov	byte ptr [ebp+0], 0
		mov	dword ptr [esi+20h], 1
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10007041:				; CODE XREF: sub_10006E30+67j
					; DATA XREF: .text:off_10007160o
		mov	ecx, [esi+8]	; jumptable 10006E97 case 37
		mov	edx, [esi]
		inc	dword ptr [esi+10h]
		push	ecx
		call	edx
		add	esp, 4
		cmp	eax, 25h
		jz	loc_1000712D	; jumptable 10006F3F default case
		mov	ecx, [esi+4]
		dec	dword ptr [esi+10h]
		push	eax
		mov	eax, [esi+8]
		push	eax
		call	ecx
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10007072:				; CODE XREF: sub_10006E30+67j
					; DATA XREF: .text:off_10007160o
		cmp	byte ptr [ebx+1], 5Eh ;	jumptable 10006E97 case	91
		lea	edi, [ebx+1]
		mov	[esp+1Ch+var_8], ebp
		jnz	short loc_10007088
		mov	[esp+1Ch+var_8], 1
		inc	edi

loc_10007088:				; CODE XREF: sub_10006E30+24Dj
		cmp	byte ptr [edi],	5Dh
		lea	eax, [edi+1]
		jz	short loc_10007092
		mov	eax, edi

loc_10007092:				; CODE XREF: sub_10006E30+25Ej
		push	5Dh		; Val
		push	eax		; Str
		call	ds:strchr
		add	esp, 8
		mov	[esp+1Ch+var_4], eax
		test	eax, eax
		jz	loc_10006F13	; jumptable 10006E97 default case
		mov	ebp, eax
		sub	ebp, edi
		cmp	dword ptr [esi+18h], 0
		jnz	short loc_100070BB
		mov	dword ptr [esi+18h], 7FFFFFFFh

loc_100070BB:				; CODE XREF: sub_10006E30+282j
		cmp	dword ptr [esi+14h], 0
		jz	short loc_100070CF
		add	dword ptr [esi+0Ch], 4
		mov	ecx, [esi+0Ch]
		mov	edx, [ecx-4]
		mov	[esp+1Ch+var_C], edx

loc_100070CF:				; CODE XREF: sub_10006E30+28Fj
		cmp	dword ptr [esi+18h], 0
		jle	short loc_10007115

loc_100070D5:				; CODE XREF: sub_10006E30+325j
		mov	eax, [esi+8]
		mov	ecx, [esi]
		inc	dword ptr [esi+10h]
		push	eax
		call	ecx
		mov	ebx, eax
		add	esp, 4
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_10007101
		push	ebp		; MaxCount
		push	ebx		; Val
		push	edi		; Buf
		call	ds:memchr
		add	esp, 0Ch
		cmp	[esp+1Ch+var_8], 0
		jnz	short loc_10007139
		test	eax, eax
		jnz	short loc_1000713D

loc_10007101:				; CODE XREF: sub_10006E30+2B8j
					; sub_10006E30+30Bj
		mov	edx, [esi+8]
		mov	eax, [esi+4]
		dec	dword ptr [esi+10h]
		push	ebx
		push	edx
		call	eax
		add	esp, 8

loc_10007111:				; CODE XREF: sub_10006E30+32Bj
		mov	eax, [esp+1Ch+var_4]

loc_10007115:				; CODE XREF: sub_10006E30+2A3j
		cmp	dword ptr [esi+14h], 0
		jz	short loc_10007129
		mov	ecx, [esp+1Ch+var_C]
		mov	byte ptr [ecx],	0
		mov	dword ptr [esi+20h], 1

loc_10007129:				; CODE XREF: sub_10006E30+2E9j
		mov	[esp+1Ch+var_4], eax

loc_1000712D:				; CODE XREF: sub_10006E30+BCj
					; sub_10006E30+DDj ...
		mov	eax, [esp+1Ch+var_4] ; jumptable 10006F3F default case
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10007139:				; CODE XREF: sub_10006E30+2CBj
		test	eax, eax
		jnz	short loc_10007101

loc_1000713D:				; CODE XREF: sub_10006E30+2CFj
		cmp	dword ptr [esi+14h], 0
		jz	short loc_1000714E
		mov	eax, [esp+1Ch+var_C]
		mov	[eax], bl
		inc	eax
		mov	[esp+1Ch+var_C], eax

loc_1000714E:				; CODE XREF: sub_10006E30+311j
		dec	dword ptr [esi+18h]
		cmp	dword ptr [esi+18h], 0
		jg	loc_100070D5
		jmp	short loc_10007111
sub_10006E30	endp

; ---------------------------------------------------------------------------
		align 10h
off_10007160	dd offset loc_10007041,	offset loc_10006F1D, offset loc_10006F01
					; DATA XREF: sub_10006E30+67r
		dd offset loc_10007072,	offset loc_10006E9E, offset loc_10006F26 ; jump	table for switch statement
		dd offset loc_10006FB4,	offset loc_10006F13
byte_10007180	db	0,     7,     7,     7 ; DATA XREF: sub_10006E30+60r
		db	7,     7,     7,     7 ; indirect table	for switch statement
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	1,     7,     1,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     7
		db	7,     7,     7,     2
		db	7,     7,     3,     7
		db	7,     7,     7,     7
		db	7,     7,     4,     2
		db	1,     1,     1,     7
		db	2,     7,     7,     7
		db	7,     5,     2,     2
		db	7,     7,     6,     7
		db	2,     7,     7,     2
off_100071D4	dd offset loc_10006F46	; DATA XREF: sub_10006E30+10Fr
		dd offset loc_10006F60	; jump table for switch	statement
		dd offset loc_10006F7C
		dd offset loc_1000712D
		dd offset loc_10006F96
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100071F0	proc near		; CODE XREF: PR_sscanf+2Cp

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		xor	eax, eax
		push	ebp
		push	edi
		mov	[esp+10h+var_4], eax
		mov	[esi+10h], eax
		mov	edi, ecx
		lea	ebx, [eax+1]

loc_10007202:				; CODE XREF: sub_100071F0+60j
					; sub_100071F0+116j ...
		movsx	eax, byte ptr [edi]
		mov	ebp, ds:isspace
		push	eax		; C
		call	ebp ; isspace
		add	esp, 4
		test	eax, eax
		jz	short loc_10007252

loc_10007215:				; CODE XREF: sub_100071F0+33j
		movsx	ecx, byte ptr [edi+ebx]
		add	edi, ebx
		push	ecx		; C
		call	ebp ; isspace
		add	esp, 4
		test	eax, eax
		jnz	short loc_10007215

loc_10007225:				; CODE XREF: sub_100071F0+4Ej
		mov	edx, [esi+8]
		mov	eax, [esi]
		add	[esi+10h], ebx
		push	edx
		call	eax
		mov	ebp, eax
		push	ebp		; C
		call	ds:isspace
		add	esp, 8
		test	eax, eax
		jnz	short loc_10007225
		mov	ecx, [esi+8]
		mov	edx, [esi+4]
		dec	dword ptr [esi+10h]
		push	ebp
		push	ecx
		call	edx
		add	esp, 8
		jmp	short loc_10007202
; ---------------------------------------------------------------------------

loc_10007252:				; CODE XREF: sub_100071F0+23j
		mov	al, [edi]
		cmp	al, 25h
		jnz	loc_1000730B
		add	edi, ebx
		mov	[esi+14h], ebx
		cmp	byte ptr [edi],	2Ah
		jnz	short loc_1000726F
		add	edi, ebx
		mov	dword ptr [esi+14h], 0

loc_1000726F:				; CODE XREF: sub_100071F0+74j
		mov	ebp, ds:isdigit
		mov	dword ptr [esi+18h], 0
		movsx	eax, byte ptr [edi]
		push	eax		; C
		call	ebp ; isdigit
		add	esp, 4
		test	eax, eax
		jz	short loc_100072B0
		lea	esp, [esp+0]

loc_10007290:				; CODE XREF: sub_100071F0+BEj
		mov	eax, [esi+18h]
		movsx	edx, byte ptr [edi]
		lea	ecx, [eax+eax*4]
		lea	eax, [edx+ecx*2-30h]
		mov	[esi+18h], eax
		movsx	ecx, byte ptr [edi+ebx]
		add	edi, ebx
		push	ecx		; C
		call	ebp ; isdigit
		add	esp, 4
		test	eax, eax
		jnz	short loc_10007290

loc_100072B0:				; CODE XREF: sub_100071F0+97j
		mov	dword ptr [esi+1Ch], 0
		mov	al, [edi]
		cmp	al, 68h
		jnz	short loc_100072C2
		mov	[esi+1Ch], ebx
		jmp	short loc_100072E9
; ---------------------------------------------------------------------------

loc_100072C2:				; CODE XREF: sub_100071F0+CBj
		cmp	al, 6Ch
		jnz	short loc_100072DE
		add	edi, ebx
		cmp	[edi], al
		jnz	short loc_100072D5
		mov	dword ptr [esi+1Ch], 4
		jmp	short loc_100072E9
; ---------------------------------------------------------------------------

loc_100072D5:				; CODE XREF: sub_100071F0+DAj
		mov	dword ptr [esi+1Ch], 2
		jmp	short loc_100072EB
; ---------------------------------------------------------------------------

loc_100072DE:				; CODE XREF: sub_100071F0+D4j
		cmp	al, 4Ch
		jnz	short loc_100072EB
		mov	dword ptr [esi+1Ch], 3

loc_100072E9:				; CODE XREF: sub_100071F0+D0j
					; sub_100071F0+E3j
		add	edi, ebx

loc_100072EB:				; CODE XREF: sub_100071F0+ECj
					; sub_100071F0+F0j
		mov	eax, edi
		mov	ecx, esi
		call	sub_10006E30
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000732B
		cmp	dword ptr [esi+20h], 0
		jz	short loc_10007304
		add	[esp+10h+var_4], ebx

loc_10007304:				; CODE XREF: sub_100071F0+10Ej
		add	edi, ebx
		jmp	loc_10007202
; ---------------------------------------------------------------------------

loc_1000730B:				; CODE XREF: sub_100071F0+66j
		test	al, al
		jz	short loc_1000734B
		mov	edx, [esi+8]
		mov	eax, [esi]
		add	[esi+10h], ebx
		push	edx
		call	eax
		movsx	ecx, byte ptr [edi]
		add	esp, 4
		cmp	eax, ecx
		jnz	short loc_1000733B
		add	edi, ebx
		jmp	loc_10007202
; ---------------------------------------------------------------------------

loc_1000732B:				; CODE XREF: sub_100071F0+108j
		mov	eax, [esp+10h+var_4]
		test	eax, eax
		jg	short loc_1000734F
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000733B:				; CODE XREF: sub_100071F0+132j
		mov	edx, [esi+8]
		dec	dword ptr [esi+10h]
		push	eax
		mov	eax, [esi+4]
		push	edx
		call	eax
		add	esp, 8

loc_1000734B:				; CODE XREF: sub_100071F0+11Dj
		mov	eax, [esp+10h+var_4]

loc_1000734F:				; CODE XREF: sub_100071F0+141j
		pop	edi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_100071F0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10007360:				; DATA XREF: PR_sscanf+18o
		mov	ecx, [esp+4]
		mov	eax, [ecx]
		cmp	byte ptr [eax],	0
		jnz	short loc_1000736F
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000736F:				; CODE XREF: .text:10007369j
		lea	edx, [eax+1]
		mov	[ecx], edx
		movzx	eax, byte ptr [eax]
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10007380:				; DATA XREF: PR_sscanf+20o
		cmp	dword ptr [esp+8], 0FFFFFFFFh
		jz	short locret_1000738D
		mov	eax, [esp+4]
		dec	dword ptr [eax]

locret_1000738D:			; CODE XREF: .text:10007385j
		retn
; ---------------------------------------------------------------------------
		align 10h
; Exported entry 394. PR_sscanf

; =============== S U B	R O U T	I N E =======================================


		public PR_sscanf
PR_sscanf	proc near		; CODE XREF: PR_GetInheritedFD+A7p
					; PR_ImportFileMapFromString_0+1Dp
					; DATA XREF: ...

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch

		sub	esp, 24h
		lea	ecx, [esp+24h+arg_8]
		push	esi
		lea	eax, [esp+28h+arg_0]
		mov	[esp+28h+var_18], ecx
		mov	ecx, [esp+28h+arg_4]
		lea	esi, [esp+28h+var_24]
		mov	[esp+28h+var_24], offset loc_10007360
		mov	[esp+28h+var_20], offset loc_10007380
		mov	[esp+28h+var_1C], eax
		call	sub_100071F0
		pop	esi
		add	esp, 24h
		retn
PR_sscanf	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 397. PR_vfprintf

; =============== S U B	R O U T	I N E =======================================


		public PR_vfprintf
PR_vfprintf	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		push	esi
		push	eax
		push	ecx
		call	PR_vsmprintf
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_100073EE
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100073EE:				; CODE XREF: PR_vfprintf+17j
		lea	edx, [eax+1]

loc_100073F1:				; CODE XREF: PR_vfprintf+26j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100073F1
		push	edi
		sub	eax, edx
		mov	edx, [esp+8+arg_0]
		push	eax
		push	esi
		push	edx
		call	PR_Write
		push	esi		; Memory
		mov	edi, eax
		call	PR_Free
		add	esp, 10h
		mov	eax, edi
		pop	edi
		pop	esi
		retn
PR_vfprintf	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 383. PR_fprintf

; =============== S U B	R O U T	I N E =======================================


		public PR_fprintf
PR_fprintf	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch

		mov	ecx, [esp+arg_4]
		push	esi
		lea	eax, [esp+4+arg_8]
		push	eax
		push	ecx
		call	PR_vsmprintf
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1000743E
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000743E:				; CODE XREF: PR_fprintf+17j
		lea	edx, [eax+1]

loc_10007441:				; CODE XREF: PR_fprintf+26j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10007441
		push	edi
		sub	eax, edx
		mov	edx, [esp+8+arg_0]
		push	eax
		push	esi
		push	edx
		call	PR_Write
		push	esi		; Memory
		mov	edi, eax
		call	PR_Free
		add	esp, 10h
		mov	eax, edi
		pop	edi
		pop	esi
		retn
PR_fprintf	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007470	proc near		; CODE XREF: sub_10007620+59p
					; sub_100076F0+Cp

var_8		= dword	ptr -8
Memory		= dword	ptr -4
arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		sub	esp, 8
		push	ebp
		mov	ebp, 1
		shl	ebp, cl
		push	edi
		lea	eax, [ebp-1]
		shl	eax, 4
		add	eax, 14h
		push	eax		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_100074A3
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100074A3:				; CODE XREF: sub_10007470+28j
		push	ebx
		push	esi
		xor	esi, esi
		test	ebp, ebp
		jz	short loc_100074C3
		lea	ebx, [edi+0Ch]
		mov	edi, edi

loc_100074B0:				; CODE XREF: sub_10007470+51j
		call	PR_NewMonitor
		mov	[ebx], eax
		test	eax, eax
		jz	short loc_100074C3
		inc	esi
		add	ebx, 10h
		cmp	esi, ebp
		jb	short loc_100074B0

loc_100074C3:				; CODE XREF: sub_10007470+39j
					; sub_10007470+49j
		cmp	esi, ebp
		jz	short loc_100074F8
		test	esi, esi
		jnz	short loc_100074DF
		push	edi		; Memory
		call	PR_Free
		add	esp, 4
		pop	esi
		pop	ebx
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100074DF:				; CODE XREF: sub_10007470+59j
		lea	eax, [esi-1]
		shl	eax, 4
		add	eax, 14h
		push	eax		; NewSize
		push	edi		; Memory
		call	PR_Realloc
		add	esp, 8
		test	eax, eax
		jz	short loc_100074F8
		mov	edi, eax

loc_100074F8:				; CODE XREF: sub_10007470+55j
					; sub_10007470+84j
		lea	ecx, [esi-1]
		lea	edx, [edi+4]
		mov	eax, edx
		test	ecx, ecx
		jz	short loc_10007510
		mov	ebx, ecx

loc_10007506:				; CODE XREF: sub_10007470+9Ej
		dec	ebx
		lea	ecx, [eax+10h]
		mov	[eax], ecx
		mov	eax, ecx
		jnz	short loc_10007506

loc_10007510:				; CODE XREF: sub_10007470+92j
		mov	ecx, dword_10030B70
		add	dword_10030B60,	esi
		mov	[eax], ecx
		lea	eax, ds:0[ebp*4]
		mov	dword_10030B70,	edx
		mov	edx, dword_10030B5C
		push	eax		; SizeOfElements
		push	1		; NumOfElements
		mov	[edi], edx
		mov	dword_10030B5C,	edi
		call	PR_Calloc
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000756F
		mov	ecx, dword_10032A94
		cmp	dword ptr [ecx+4], 3
		jl	loc_10007611
		push	offset aUnableToGrowMo ; "unable to grow monitor cache hash bucke"...
		call	PR_LogPrint
		add	esp, 4
		pop	esi
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000756F:				; CODE XREF: sub_10007470+D6j
		mov	edx, dword_10030B68
		xor	ecx, ecx
		lea	ebx, [ebp-1]
		mov	dword_10030B74,	ebx
		mov	[esp+18h+Memory], edx
		mov	[esp+18h+var_8], ecx
		cmp	dword_10030B78,	ecx
		jbe	short loc_100075D0

loc_10007590:				; CODE XREF: sub_10007470+15Ej
		mov	edx, dword_10030B68
		mov	edx, [edx+ecx*4]
		test	edx, edx
		jz	short loc_100075C3
		lea	ecx, [ecx+0]

loc_100075A0:				; CODE XREF: sub_10007470+14Dj
		mov	edi, [edx+4]
		mov	esi, [edx]
		mov	ecx, edi
		shr	ecx, 8
		xor	ecx, edi
		shr	ecx, 2
		and	ecx, ebx
		mov	edi, [eax+ecx*4]
		mov	[edx], edi
		mov	[eax+ecx*4], edx
		mov	edx, esi
		test	esi, esi
		jnz	short loc_100075A0
		mov	ecx, [esp+18h+var_8]

loc_100075C3:				; CODE XREF: sub_10007470+12Bj
		inc	ecx
		mov	[esp+18h+var_8], ecx
		cmp	ecx, dword_10030B78
		jb	short loc_10007590

loc_100075D0:				; CODE XREF: sub_10007470+11Ej
		mov	ecx, [esp+18h+Memory]
		mov	dword_10030B68,	eax
		mov	eax, [esp+18h+arg_0]
		push	ecx		; Memory
		mov	dword_10030B78,	ebp
		mov	dword_10030B6C,	eax
		call	PR_Free
		mov	edx, dword_10032A94
		add	esp, 4
		cmp	dword ptr [edx+4], 4
		jl	short loc_10007611
		mov	eax, dword_10030B60
		push	ebp
		push	eax
		push	offset aExpandedMonito ; "expanded monitor cache to %d (buckets	%"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_10007611:				; CODE XREF: sub_10007470+E2j
					; sub_10007470+18Bj
		pop	esi
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		add	esp, 8
		retn
sub_10007470	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007620	proc near		; CODE XREF: PR_CEnterMonitor+1Fp

arg_0		= dword	ptr  4

		mov	eax, dword_10030B68
		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, ebp
		shr	edi, 8
		xor	edi, ebp
		shr	edi, 2
		mov	ebx, edi
		and	ebx, dword_10030B74
		mov	esi, [eax+ebx*4]
		test	esi, esi
		jz	short loc_10007655

loc_10007646:				; CODE XREF: sub_10007620+33j
		cmp	[esi+4], ebp
		jz	loc_100076DA
		mov	esi, [esi]
		test	esi, esi
		jnz	short loc_10007646

loc_10007655:				; CODE XREF: sub_10007620+24j
		cmp	dword_10030B60,	5
		jnb	short loc_1000769F
		cmp	dword_10030B7C,	0
		jnz	short loc_1000769F
		mov	ecx, dword_10030B6C
		inc	ecx
		push	ecx
		mov	dword_10030B7C,	1
		call	sub_10007470
		add	esp, 4
		mov	dword_10030B7C,	0
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10007697
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10007697:				; CODE XREF: sub_10007620+6Ej
		and	edi, dword_10030B74
		mov	ebx, edi

loc_1000769F:				; CODE XREF: sub_10007620+3Cj
					; sub_10007620+45j
		mov	esi, dword_10030B70
		mov	ecx, dword_10030B64
		mov	edx, [esi]
		dec	dword_10030B60
		mov	dword_10030B70,	edx
		test	ecx, ecx
		jz	short loc_100076CA
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_100076CA
		push	eax
		call	ecx ; dword_10030B64
		add	esp, 4

loc_100076CA:				; CODE XREF: sub_10007620+9Bj
					; sub_10007620+A2j
		mov	eax, dword_10030B68
		mov	[esi+4], ebp
		mov	ecx, [eax+ebx*4]
		mov	[esi], ecx
		mov	[eax+ebx*4], esi

loc_100076DA:				; CODE XREF: sub_10007620+29j
		inc	dword ptr [esi+0Ch]
		mov	eax, [esi+8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10007620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100076F0	proc near		; CODE XREF: PR_Init_0+10Dp
		call	PR_NewLock
		push	3
		mov	dword_10032B14,	eax
		call	sub_10007470
		pop	ecx
		retn
sub_100076F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007710	proc near		; CODE XREF: PR_Cleanup+14Bp
		mov	eax, dword_10032B14
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jz	short loc_1000772B
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10032B14,	esi

loc_1000772B:				; CODE XREF: sub_10007710+Aj
		mov	eax, dword_10030B70
		cmp	eax, esi
		jz	short loc_10007751

loc_10007734:				; CODE XREF: sub_10007710+3Fj
		mov	eax, [eax+8]
		push	eax		; Memory
		call	PR_DestroyMonitor
		mov	ecx, dword_10030B70
		mov	eax, [ecx]
		add	esp, 4
		mov	dword_10030B70,	eax
		cmp	eax, esi
		jnz	short loc_10007734

loc_10007751:				; CODE XREF: sub_10007710+22j
		mov	eax, dword_10030B5C
		mov	dword_10030B60,	esi
		cmp	eax, esi
		jz	short loc_1000777A

loc_10007760:				; CODE XREF: sub_10007710+68j
		mov	edx, [eax]
		push	eax		; Memory
		mov	dword_10030B5C,	edx
		call	PR_Free
		mov	eax, dword_10030B5C
		add	esp, 4
		cmp	eax, esi
		jnz	short loc_10007760

loc_1000777A:				; CODE XREF: sub_10007710+4Ej
		mov	eax, dword_10030B68
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword_10030B68,	esi
		mov	dword_10030B74,	esi
		mov	dword_10030B78,	esi
		mov	dword_10030B6C,	esi
		mov	dword_10030B7C,	esi
		mov	dword_10030B64,	esi
		pop	esi
		retn
sub_10007710	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  34. PR_CEnterMonitor

; =============== S U B	R O U T	I N E =======================================


		public PR_CEnterMonitor
PR_CEnterMonitor proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_100077BE
		call	PR_Init

loc_100077BE:				; CODE XREF: PR_CEnterMonitor+7j
		mov	eax, dword_10032B14
		push	esi
		push	eax
		call	PR_Lock
		mov	ecx, [esp+8+arg_0]
		push	ecx
		call	sub_10007620
		mov	edx, dword_10032B14
		push	edx		; lpTlsValue
		mov	esi, eax
		call	PR_Unlock
		add	esp, 0Ch
		test	esi, esi
		jnz	short loc_100077ED
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100077ED:				; CODE XREF: PR_CEnterMonitor+37j
		push	esi
		call	PR_EnterMonitor
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
PR_CEnterMonitor endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  35. PR_CExitMonitor

; =============== S U B	R O U T	I N E =======================================


		public PR_CExitMonitor
PR_CExitMonitor	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, dword_10032B14
		push	esi
		push	eax
		call	PR_Lock
		mov	edx, [esp+8+arg_0]
		mov	eax, dword_10030B68
		mov	ecx, edx
		shr	ecx, 8
		xor	ecx, edx
		shr	ecx, 2
		and	ecx, dword_10030B74
		add	esp, 4
		lea	ecx, [eax+ecx*4]
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_1000783E

loc_10007831:				; CODE XREF: PR_CExitMonitor+3Cj
		cmp	[eax+4], edx
		jz	short loc_10007853
		mov	ecx, eax
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_10007831

loc_1000783E:				; CODE XREF: PR_CExitMonitor+2Fj
					; PR_CExitMonitor+57j ...
		mov	eax, dword_10032B14
		push	eax		; lpTlsValue
		or	esi, 0FFFFFFFFh
		call	PR_Unlock
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007853:				; CODE XREF: PR_CExitMonitor+34j
		cmp	dword ptr [eax+0Ch], 0
		jle	short loc_1000783E
		test	ecx, ecx
		jz	short loc_1000783E
		mov	eax, [ecx]
		dec	dword ptr [eax+0Ch]
		jnz	short loc_10007882
		mov	edx, [eax]
		inc	dword_10030B60
		mov	dword ptr [eax+4], 0
		mov	[ecx], edx
		mov	ecx, dword_10030B70
		mov	[eax], ecx
		mov	dword_10030B70,	eax

loc_10007882:				; CODE XREF: PR_CExitMonitor+62j
		mov	edx, [eax+8]
		push	edx
		call	PR_ExitMonitor
		mov	esi, eax
		mov	eax, dword_10032B14
		add	esp, 4
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
PR_CExitMonitor	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  39. PR_CWait

; =============== S U B	R O U T	I N E =======================================


		public PR_CWait
PR_CWait	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, dword_10032B14
		push	esi
		push	eax
		call	PR_Lock
		mov	edx, [esp+8+arg_0]
		mov	eax, dword_10030B68
		mov	ecx, edx
		shr	ecx, 8
		xor	ecx, edx
		shr	ecx, 2
		and	ecx, dword_10030B74
		add	esp, 4
		lea	ecx, [eax+ecx*4]
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_100078EE

loc_100078E1:				; CODE XREF: PR_CWait+3Cj
		cmp	[eax+4], edx
		jz	short loc_10007908
		mov	ecx, eax
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_100078E1

loc_100078EE:				; CODE XREF: PR_CWait+2Fj PR_CWait+5Cj ...
		xor	esi, esi

loc_100078F0:				; CODE XREF: PR_CWait+67j
		mov	edx, dword_10032B14
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	esi, esi
		jnz	short loc_10007919
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007908:				; CODE XREF: PR_CWait+34j
		cmp	dword ptr [eax+0Ch], 0
		jle	short loc_100078EE
		test	ecx, ecx
		jz	short loc_100078EE
		mov	ecx, [ecx]
		mov	esi, [ecx+8]
		jmp	short loc_100078F0
; ---------------------------------------------------------------------------

loc_10007919:				; CODE XREF: PR_CWait+51j
		mov	eax, [esp+4+arg_4]
		push	eax
		push	esi
		call	PR_Wait
		add	esp, 8
		pop	esi
		retn
PR_CWait	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  36. PR_CNotify

; =============== S U B	R O U T	I N E =======================================


		public PR_CNotify
PR_CNotify	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, dword_10032B14
		push	esi
		push	eax
		call	PR_Lock
		mov	edx, [esp+8+arg_0]
		mov	eax, dword_10030B68
		mov	ecx, edx
		shr	ecx, 8
		xor	ecx, edx
		shr	ecx, 2
		and	ecx, dword_10030B74
		add	esp, 4
		lea	ecx, [eax+ecx*4]
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_1000796E

loc_10007961:				; CODE XREF: PR_CNotify+3Cj
		cmp	[eax+4], edx
		jz	short loc_10007988
		mov	ecx, eax
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_10007961

loc_1000796E:				; CODE XREF: PR_CNotify+2Fj
					; PR_CNotify+5Cj ...
		xor	esi, esi

loc_10007970:				; CODE XREF: PR_CNotify+67j
		mov	edx, dword_10032B14
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	esi, esi
		jnz	short loc_10007999
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007988:				; CODE XREF: PR_CNotify+34j
		cmp	dword ptr [eax+0Ch], 0
		jle	short loc_1000796E
		test	ecx, ecx
		jz	short loc_1000796E
		mov	ecx, [ecx]
		mov	esi, [ecx+8]
		jmp	short loc_10007970
; ---------------------------------------------------------------------------

loc_10007999:				; CODE XREF: PR_CNotify+51j
		push	esi
		call	PR_Notify
		add	esp, 4
		pop	esi
		retn
PR_CNotify	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  37. PR_CNotifyAll

; =============== S U B	R O U T	I N E =======================================


		public PR_CNotifyAll
PR_CNotifyAll	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, dword_10032B14
		push	esi
		push	eax
		call	PR_Lock
		mov	edx, [esp+8+arg_0]
		mov	eax, dword_10030B68
		mov	ecx, edx
		shr	ecx, 8
		xor	ecx, edx
		shr	ecx, 2
		and	ecx, dword_10030B74
		add	esp, 4
		lea	ecx, [eax+ecx*4]
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_100079EE

loc_100079E1:				; CODE XREF: PR_CNotifyAll+3Cj
		cmp	[eax+4], edx
		jz	short loc_10007A08
		mov	ecx, eax
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_100079E1

loc_100079EE:				; CODE XREF: PR_CNotifyAll+2Fj
					; PR_CNotifyAll+5Cj ...
		xor	esi, esi

loc_100079F0:				; CODE XREF: PR_CNotifyAll+67j
		mov	edx, dword_10032B14
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	esi, esi
		jnz	short loc_10007A19
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007A08:				; CODE XREF: PR_CNotifyAll+34j
		cmp	dword ptr [eax+0Ch], 0
		jle	short loc_100079EE
		test	ecx, ecx
		jz	short loc_100079EE
		mov	ecx, [ecx]
		mov	esi, [ecx+8]
		jmp	short loc_100079F0
; ---------------------------------------------------------------------------

loc_10007A19:				; CODE XREF: PR_CNotifyAll+51j
		push	esi
		call	PR_NotifyAll
		add	esp, 4
		pop	esi
		retn
PR_CNotifyAll	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  38. PR_CSetOnMonitorRecycle

; =============== S U B	R O U T	I N E =======================================


		public PR_CSetOnMonitorRecycle
PR_CSetOnMonitorRecycle	proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword_10030B64,	eax
		retn
PR_CSetOnMonitorRecycle	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 258. PR_NewRWLock

; =============== S U B	R O U T	I N E =======================================


		public PR_NewRWLock
PR_NewRWLock	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword_10031520,	0
		jnz	short loc_10007A4E
		call	PR_Init

loc_10007A4E:				; CODE XREF: PR_NewRWLock+7j
		push	esi
		push	20h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10007A63
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007A63:				; CODE XREF: PR_NewRWLock+1Fj
		mov	eax, [esp+4+arg_0]
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	[esi+4], eax
		test	edi, edi
		jz	short loc_10007AAF
		mov	eax, edi
		lea	edx, [eax+1]

loc_10007A78:				; CODE XREF: PR_NewRWLock+3Dj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10007A78
		sub	eax, edx
		inc	eax
		push	eax		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_10007A9F
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007A9F:				; CODE XREF: PR_NewRWLock+4Fj
		mov	ecx, edi
		mov	edx, eax

loc_10007AA3:				; CODE XREF: PR_NewRWLock+6Bj
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_10007AA3
		jmp	short loc_10007AB5
; ---------------------------------------------------------------------------

loc_10007AAF:				; CODE XREF: PR_NewRWLock+31j
		mov	dword ptr [esi], 0

loc_10007AB5:				; CODE XREF: PR_NewRWLock+6Dj
		call	PR_NewLock
		mov	[esi+8], eax
		test	eax, eax
		jz	short loc_10007AE4
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+18h], eax
		test	eax, eax
		jz	short loc_10007AE4
		mov	ecx, [esi+8]
		push	ecx
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+1Ch], eax
		test	eax, eax
		jnz	short loc_10007B1A

loc_10007AE4:				; CODE XREF: PR_NewRWLock+7Fj
					; PR_NewRWLock+8Fj
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_10007AF4
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_10007AF4:				; CODE XREF: PR_NewRWLock+A9j
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_10007B04
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4

loc_10007B04:				; CODE XREF: PR_NewRWLock+B9j
		mov	edx, [esi]
		push	edx		; Memory
		call	PR_Free
		push	esi		; Memory
		call	PR_Free
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007B1A:				; CODE XREF: PR_NewRWLock+A2j
		pop	edi
		mov	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0
		mov	dword ptr [esi+0Ch], 0
		mov	eax, esi
		pop	esi
		retn
PR_NewRWLock	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  89. PR_DestroyRWLock

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyRWLock(void *Memory)
		public PR_DestroyRWLock
PR_DestroyRWLock proc near		; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi+18h]
		push	eax		; Memory
		call	PR_DestroyCondVar
		mov	ecx, [esi+1Ch]
		push	ecx		; Memory
		call	PR_DestroyCondVar
		mov	edx, [esi+8]
		push	edx		; Memory
		call	PR_DestroyLock
		mov	eax, [esi]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10007B72
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_10007B72:				; CODE XREF: PR_DestroyRWLock+27j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	esi
		retn
PR_DestroyRWLock endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 296. PR_RWLock_Rlock

; =============== S U B	R O U T	I N E =======================================


		public PR_RWLock_Rlock
PR_RWLock_Rlock	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpTlsValue	= dword	ptr  4

		push	esi
		mov	esi, [esp+4+lpTlsValue]
		mov	eax, [esi+8]
		push	eax
		call	PR_Lock
		add	esp, 4

loc_10007B91:				; CODE XREF: PR_RWLock_Rlock+31j
		cmp	dword ptr [esi+0Ch], 0
		jl	short loc_10007B9D
		cmp	dword ptr [esi+14h], 0
		jbe	short loc_10007BB3

loc_10007B9D:				; CODE XREF: PR_RWLock_Rlock+15j
		mov	ecx, [esi+18h]
		inc	dword ptr [esi+10h]
		push	0FFFFFFFFh
		push	ecx
		call	PR_WaitCondVar
		add	esp, 8
		dec	dword ptr [esi+10h]
		jmp	short loc_10007B91
; ---------------------------------------------------------------------------

loc_10007BB3:				; CODE XREF: PR_RWLock_Rlock+1Bj
		inc	dword ptr [esi+0Ch]
		mov	edx, [esi+8]
		pop	esi
		mov	[esp+lpTlsValue], edx ;	lpTlsValue
		jmp	PR_Unlock
PR_RWLock_Rlock	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 298. PR_RWLock_Wlock

; =============== S U B	R O U T	I N E =======================================


		public PR_RWLock_Wlock
PR_RWLock_Wlock	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpTlsValue	= dword	ptr  4

		push	esi
		mov	esi, [esp+4+lpTlsValue]
		mov	eax, [esi+8]
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_10007C01

loc_10007BE7:				; CODE XREF: PR_RWLock_Wlock+2Fj
		mov	ecx, [esi+1Ch]
		inc	dword ptr [esi+14h]
		push	0FFFFFFFFh
		push	ecx
		call	PR_WaitCondVar
		dec	dword ptr [esi+14h]
		add	esp, 8
		cmp	dword ptr [esi+0Ch], 0
		jnz	short loc_10007BE7

loc_10007C01:				; CODE XREF: PR_RWLock_Wlock+15j
		dec	dword ptr [esi+0Ch]
		mov	edx, [esi+8]
		pop	esi
		mov	[esp+lpTlsValue], edx ;	lpTlsValue
		jmp	PR_Unlock
PR_RWLock_Wlock	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 297. PR_RWLock_Unlock

; =============== S U B	R O U T	I N E =======================================


		public PR_RWLock_Unlock
PR_RWLock_Unlock proc near		; DATA XREF: .rdata:off_1002C7C8o

lpTlsValue	= dword	ptr  4

		push	esi
		mov	esi, [esp+4+lpTlsValue]
		mov	eax, [esi+8]
		push	eax
		call	PR_Lock
		mov	eax, [esi+0Ch]
		add	esp, 4
		test	eax, eax
		jle	short loc_10007C5D
		dec	eax
		mov	[esi+0Ch], eax
		jnz	short loc_10007C95
		cmp	dword ptr [esi+14h], 0
		jbe	short loc_10007C95
		mov	ecx, [esi+1Ch]
		push	ecx
		call	PR_NotifyCondVar
		mov	ecx, [esi+8]
		add	esp, 4
		pop	esi
		mov	[esp+lpTlsValue], ecx ;	lpTlsValue
		jmp	PR_Unlock
; ---------------------------------------------------------------------------

loc_10007C5D:				; CODE XREF: PR_RWLock_Unlock+16j
		cmp	dword ptr [esi+14h], 0
		mov	dword ptr [esi+0Ch], 0
		jbe	short loc_10007C83
		mov	edx, [esi+1Ch]
		push	edx
		call	PR_NotifyCondVar
		mov	ecx, [esi+8]
		add	esp, 4
		pop	esi
		mov	[esp+lpTlsValue], ecx ;	lpTlsValue
		jmp	PR_Unlock
; ---------------------------------------------------------------------------

loc_10007C83:				; CODE XREF: PR_RWLock_Unlock+48j
		cmp	dword ptr [esi+10h], 0
		jbe	short loc_10007C95
		mov	eax, [esi+18h]
		push	eax
		call	PR_NotifyAllCondVar
		add	esp, 4

loc_10007C95:				; CODE XREF: PR_RWLock_Unlock+1Cj
					; PR_RWLock_Unlock+22j	...
		mov	ecx, [esi+8]
		pop	esi
		mov	[esp+lpTlsValue], ecx ;	lpTlsValue
		jmp	PR_Unlock
PR_RWLock_Unlock endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007CB0	proc near		; CODE XREF: PR_Init_0+DFp
		push	200h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		add	esp, 8
		mov	dword_10030B88,	eax
		mov	dword_10030B80,	80h
		retn
sub_10007CB0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 262. PR_NewThreadPrivateIndex

; =============== S U B	R O U T	I N E =======================================


		public PR_NewThreadPrivateIndex
PR_NewThreadPrivateIndex proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword_10031520,	0
		jnz	short loc_10007CDE
		call	PR_Init

loc_10007CDE:				; CODE XREF: PR_NewThreadPrivateIndex+7j
		push	offset dword_10030B84
		call	PR_AtomicIncrement
		dec	eax
		add	esp, 4
		cmp	eax, 80h
		jl	short loc_10007D06
		push	0
		push	0FFFFE8ACh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10007D06:				; CODE XREF: PR_NewThreadPrivateIndex+21j
		mov	ecx, [esp+arg_4]
		mov	edx, dword_10030B88
		mov	[edx+eax*4], ecx
		mov	ecx, [esp+arg_0]
		mov	[ecx], eax
		xor	eax, eax
		retn
PR_NewThreadPrivateIndex endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 340. PR_SetThreadPrivate

; =============== S U B	R O U T	I N E =======================================


		public PR_SetThreadPrivate
PR_SetThreadPrivate proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		call	PR_GetCurrentThread
		mov	edi, [esp+8+arg_0]
		mov	esi, eax
		cmp	edi, 80h
		jb	short loc_10007D4A
		push	0
		push	0FFFFE8ACh
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007D4A:				; CODE XREF: PR_SetThreadPrivate+13j
		mov	eax, [esi+24h]
		push	ebx
		test	eax, eax
		jz	short loc_10007D94
		cmp	[esi+20h], edi
		jbe	short loc_10007D94
		cmp	dword ptr [eax+edi*4], 0
		jz	loc_10007DFB
		mov	edx, dword_10030B88
		cmp	dword ptr [edx+edi*4], 0
		jz	loc_10007DFB
		mov	ecx, [eax+edi*4]
		mov	dword ptr [eax+edi*4], 0
		mov	eax, [edx+edi*4]
		push	ecx
		call	eax
		mov	ecx, [esi+24h]
		mov	edx, [esp+10h+arg_4]
		add	esp, 4
		pop	ebx
		mov	[ecx+edi*4], edx
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007D94:				; CODE XREF: PR_SetThreadPrivate+30j
					; PR_SetThreadPrivate+35j
		mov	ecx, dword_10030B80
		lea	edx, ds:0[ecx*4]
		push	edx		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	ebx, eax
		add	esp, 8
		test	ebx, ebx
		jnz	short loc_10007DC7
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	ebx
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10007DC7:				; CODE XREF: PR_SetThreadPrivate+90j
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_10007DF0
		mov	ecx, [esi+20h]
		add	ecx, ecx
		add	ecx, ecx
		push	ecx		; Size
		push	eax		; Src
		push	ebx		; Dst
		call	memcpy
		mov	edx, [esi+24h]
		push	edx		; Memory
		call	PR_Free
		add	esp, 10h
		mov	dword ptr [esi+24h], 0

loc_10007DF0:				; CODE XREF: PR_SetThreadPrivate+ACj
		mov	eax, dword_10030B80
		mov	[esi+20h], eax
		mov	[esi+24h], ebx

loc_10007DFB:				; CODE XREF: PR_SetThreadPrivate+3Bj
					; PR_SetThreadPrivate+4Bj
		mov	ecx, [esi+24h]
		mov	edx, [esp+0Ch+arg_4]
		pop	ebx
		mov	[ecx+edi*4], edx
		pop	edi
		xor	eax, eax
		pop	esi
		retn
PR_SetThreadPrivate endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 196. PR_GetThreadPrivate

; =============== S U B	R O U T	I N E =======================================


		public PR_GetThreadPrivate
PR_GetThreadPrivate proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		call	PR_GetCurrentThread
		mov	ecx, [eax+24h]
		test	ecx, ecx
		jz	short loc_10007E29
		mov	edx, [esp+arg_0]
		cmp	edx, [eax+20h]
		jnb	short loc_10007E29
		mov	eax, [ecx+edx*4]
		retn
; ---------------------------------------------------------------------------

loc_10007E29:				; CODE XREF: PR_GetThreadPrivate+Aj
					; PR_GetThreadPrivate+13j
		xor	eax, eax
		retn
PR_GetThreadPrivate endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007E30	proc near		; CODE XREF: sub_10016920+7p

arg_0		= dword	ptr  4

		push	edi
		mov	edi, [esp+4+arg_0]
		cmp	dword ptr [edi+24h], 0
		jz	short loc_10007EB2
		push	ebx
		mov	ebx, dword_10030B88
		push	ebp
		push	esi
		mov	ebp, 4
		lea	esp, [esp+0]

loc_10007E50:				; CODE XREF: sub_10007E30+67j
		xor	esi, esi
		mov	edx, 1
		cmp	[edi+20h], esi
		jbe	short loc_10007E90
		lea	esp, [esp+0]

loc_10007E60:				; CODE XREF: sub_10007E30+5Ej
		mov	eax, [edi+24h]
		mov	ecx, [eax+esi*4]
		lea	eax, [eax+esi*4]
		test	ecx, ecx
		jz	short loc_10007E8A
		cmp	dword ptr [ebx+esi*4], 0
		jz	short loc_10007E8A
		mov	dword ptr [eax], 0
		push	ecx
		mov	ecx, [ebx+esi*4]
		call	ecx
		mov	ebx, dword_10030B88
		add	esp, 4
		xor	edx, edx

loc_10007E8A:				; CODE XREF: sub_10007E30+3Bj
					; sub_10007E30+41j
		inc	esi
		cmp	esi, [edi+20h]
		jb	short loc_10007E60

loc_10007E90:				; CODE XREF: sub_10007E30+2Aj
		dec	ebp
		test	ebp, ebp
		jle	short loc_10007E99
		test	edx, edx
		jz	short loc_10007E50

loc_10007E99:				; CODE XREF: sub_10007E30+63j
		mov	edx, [edi+20h]
		mov	eax, [edi+24h]
		add	edx, edx
		add	edx, edx
		push	edx		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch
		pop	esi
		pop	ebp
		pop	ebx

loc_10007EB2:				; CODE XREF: sub_10007E30+9j
		pop	edi
		retn
sub_10007E30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007EC0	proc near		; CODE XREF: sub_100085A0+8Cp

var_18		= byte ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		mov	eax, [esp+18h+arg_0]
		push	eax
		push	offset aErrorD	; "error %d"
		lea	ecx, [esp+20h+var_18]
		push	14h
		push	ecx
		call	PR_snprintf
		lea	edx, [esp+28h+var_18]
		add	esp, 10h
		test	edx, edx
		jz	short loc_10007F0A
		mov	eax, edx
		lea	edx, [eax+1]

loc_10007EF4:				; CODE XREF: sub_10007EC0+39j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10007EF4
		lea	ecx, [esp+18h+var_18]
		sub	eax, edx
		push	ecx		; Src
		push	eax		; int
		call	PR_SetErrorText
		add	esp, 8

loc_10007F0A:				; CODE XREF: sub_10007EC0+2Dj
		mov	ecx, [esp+18h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 18h
		retn
sub_10007EC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007F20	proc near		; CODE XREF: PR_Init_0+126p
		mov	eax, dword_10030B8C
		test	eax, eax
		jnz	short loc_10007F3B
		push	offset aLinkerLock ; "linker-lock"
		call	PR_NewNamedMonitor
		add	esp, 4
		mov	dword_10030B8C,	eax

loc_10007F3B:				; CODE XREF: sub_10007F20+7j
		push	esi
		push	eax
		call	PR_EnterMonitor
		push	14h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		push	offset aExecutable ; "Executable"
		mov	esi, eax
		call	ds:_strdup
		add	esp, 10h
		push	0		; lpModuleName
		mov	[esi], eax
		call	ds:GetModuleHandleA
		mov	[esi+10h], eax
		mov	dword ptr [esi+8], 1
		mov	dword ptr [esi+0Ch], 0
		mov	eax, dword_10032AC0
		cmp	dword ptr [eax+4], 4
		mov	dword_10030B94,	esi
		mov	dword_10030B90,	esi
		jl	short loc_10007F9D
		mov	ecx, [esi]
		push	ecx
		push	offset aLoadedLibrar_1 ; "Loaded library %s (init)"
		call	PR_LogPrint
		add	esp, 8

loc_10007F9D:				; CODE XREF: sub_10007F20+6Bj
		mov	edx, dword_10030B8C
		push	edx
		call	PR_ExitMonitor
		add	esp, 4
		pop	esi
		retn
sub_10007F20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10007FB0	proc near		; CODE XREF: PR_Cleanup+D7p
		mov	eax, dword_10030B8C
		push	eax		; Memory
		call	PR_DestroyMonitor
		mov	eax, dword_10030B98
		add	esp, 4
		mov	dword_10030B8C,	0
		test	eax, eax
		jz	short locret_10007FE5
		push	eax		; Memory
		call	ds:free
		add	esp, 4
		mov	dword_10030B98,	0

locret_10007FE5:			; CODE XREF: sub_10007FB0+1Fj
		retn
sub_10007FB0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 328. PR_SetLibraryPath

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SetLibraryPath(char *Src)
		public PR_SetLibraryPath
PR_SetLibraryPath proc near		; DATA XREF: .rdata:off_1002C7C8o

Src		= dword	ptr  4

		push	esi
		xor	esi, esi
		cmp	dword_10031520,	esi
		jnz	short loc_10008000
		call	PR_Init

loc_10008000:				; CODE XREF: PR_SetLibraryPath+9j
		mov	eax, dword_10030B8C
		push	eax
		call	PR_EnterMonitor
		mov	eax, dword_10030B98
		add	esp, 4
		cmp	eax, esi
		jz	short loc_10008021
		push	eax		; Memory
		call	ds:free
		add	esp, 4

loc_10008021:				; CODE XREF: PR_SetLibraryPath+25j
		mov	eax, [esp+4+Src]
		cmp	eax, esi
		jz	short loc_10008060
		push	eax		; Src
		call	ds:_strdup
		add	esp, 4
		mov	dword_10030B98,	eax
		cmp	eax, esi
		jnz	short loc_10008066
		push	esi
		push	0FFFFE890h
		call	PR_SetError
		mov	ecx, dword_10030B8C
		add	esp, 8
		push	ecx
		or	esi, 0FFFFFFFFh
		call	PR_ExitMonitor
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008060:				; CODE XREF: PR_SetLibraryPath+37j
		mov	dword_10030B98,	esi

loc_10008066:				; CODE XREF: PR_SetLibraryPath+4Aj
		mov	ecx, dword_10030B8C
		push	ecx
		call	PR_ExitMonitor
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
PR_SetLibraryPath endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 167. PR_GetLibraryPath

; =============== S U B	R O U T	I N E =======================================


		public PR_GetLibraryPath
PR_GetLibraryPath proc near		; DATA XREF: .rdata:off_1002C7C8o
		push	edi
		xor	edi, edi
		cmp	dword_10031520,	edi
		jnz	short loc_10008090
		call	PR_Init

loc_10008090:				; CODE XREF: PR_GetLibraryPath+9j
		mov	eax, dword_10030B8C
		push	esi
		push	eax
		call	PR_EnterMonitor
		mov	eax, dword_10030B98
		mov	esi, ds:_strdup
		add	esp, 4
		test	eax, eax
		jnz	short loc_100080D4
		push	offset VarName	; "LD_LIBRARY_PATH"
		call	ds:__imp_getenv
		add	esp, 4
		test	eax, eax
		jnz	short loc_100080C5
		mov	eax, offset a_Lib ; ".;\\lib"

loc_100080C5:				; CODE XREF: PR_GetLibraryPath+3Ej
		push	eax		; Src
		call	esi ; _strdup
		add	esp, 4
		mov	dword_10030B98,	eax
		test	eax, eax
		jz	short loc_100080DC

loc_100080D4:				; CODE XREF: PR_GetLibraryPath+2Cj
		push	eax		; Src
		call	esi ; _strdup
		add	esp, 4
		mov	edi, eax

loc_100080DC:				; CODE XREF: PR_GetLibraryPath+52j
		mov	ecx, dword_10030B8C
		push	ecx
		call	PR_ExitMonitor
		add	esp, 4
		pop	esi
		test	edi, edi
		jnz	short loc_100080FF
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8

loc_100080FF:				; CODE XREF: PR_GetLibraryPath+6Ej
		mov	eax, edi
		pop	edi
		retn
PR_GetLibraryPath endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 166. PR_GetLibraryName

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetLibraryName(int, char *Str)
		public PR_GetLibraryName
PR_GetLibraryName proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
Str		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+Str]
		push	offset SubStr	; ".dll"
		push	esi		; Str
		call	ds:strstr
		add	esp, 8
		test	eax, eax
		mov	eax, [esp+4+arg_0]
		jnz	short loc_10008155
		push	offset SubStr	; ".dll"
		push	esi
		test	eax, eax
		jz	short loc_10008146
		push	eax
		push	offset aSSS	; "%s\\%s%s"
		call	PR_smprintf
		add	esp, 10h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008146:				; CODE XREF: PR_GetLibraryName+24j
		push	offset aSS	; "%s%s"
		call	PR_smprintf
		add	esp, 0Ch
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008155:				; CODE XREF: PR_GetLibraryName+1Aj
		push	esi
		test	eax, eax
		jz	short loc_1000816A
		push	eax
		push	offset aSS_0	; "%s\\%s"
		call	PR_smprintf
		add	esp, 0Ch
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000816A:				; CODE XREF: PR_GetLibraryName+48j
		push	offset aS	; "%s"
		call	PR_smprintf
		add	esp, 8
		pop	esi
		retn
PR_GetLibraryName endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 137. PR_FreeLibraryName

; =============== S U B	R O U T	I N E =======================================


		public PR_FreeLibraryName
PR_FreeLibraryName proc	near		; DATA XREF: .rdata:off_1002C7C8o
		jmp	PR_smprintf_free
PR_FreeLibraryName endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008190	proc near		; CODE XREF: sub_10008220+19Dp
					; PR_LoadStaticLibrary+24p
		push	ebx
		push	ebp
		mov	ebp, ds:strrchr
		push	esi
		mov	esi, dword_10030B90
		push	edi
		mov	ebx, eax
		push	5Ch		; Ch
		push	ebx		; Str
		call	ebp ; strrchr
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_100081B3
		inc	edi
		jmp	short loc_100081B5
; ---------------------------------------------------------------------------

loc_100081B3:				; CODE XREF: sub_10008190+1Ej
		mov	edi, ebx

loc_100081B5:				; CODE XREF: sub_10008190+21j
		test	esi, esi
		jz	short loc_100081E5
		mov	ebx, ds:_strcmpi
		nop

loc_100081C0:				; CODE XREF: sub_10008190+53j
		mov	eax, [esi]
		push	5Ch		; Ch
		push	eax		; Str
		call	ebp ; strrchr
		add	esp, 8
		test	eax, eax
		jz	short loc_100081D1
		inc	eax
		jmp	short loc_100081D3
; ---------------------------------------------------------------------------

loc_100081D1:				; CODE XREF: sub_10008190+3Cj
		mov	eax, [esi]

loc_100081D3:				; CODE XREF: sub_10008190+3Fj
		push	eax		; Str2
		push	edi		; Str1
		call	ebx ; _strcmpi
		add	esp, 8
		test	eax, eax
		jz	short loc_100081EC
		mov	esi, [esi+4]
		test	esi, esi
		jnz	short loc_100081C0

loc_100081E5:				; CODE XREF: sub_10008190+27j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100081EC:				; CODE XREF: sub_10008190+4Cj
		inc	dword ptr [esi+8]
		mov	ecx, dword_10032AC0
		cmp	dword ptr [ecx+4], 4
		mov	eax, [esi+8]
		jl	short loc_1000820F
		mov	edx, [esi]
		push	eax
		push	edx
		push	offset aSIncrDFindLib ;	"%s incr => %d (find lib)"
		call	PR_LogPrint
		add	esp, 0Ch

loc_1000820F:				; CODE XREF: sub_10008190+6Cj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10008190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_10008220@<eax>(LPCWSTR lpLibFileName@<ecx>, int)
sub_10008220	proc near		; CODE XREF: PR_LoadLibraryWithFlags+36p
					; PR_LoadLibrary+6p

var_334		= dword	ptr -334h
Memory		= dword	ptr -330h
var_32C		= dword	ptr -32Ch
var_328		= dword	ptr -328h
Src		= byte ptr -324h
var_310		= byte ptr -310h
WideCharStr	= word ptr -20Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 334h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+334h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+33Ch+arg_0]
		push	esi
		xor	esi, esi
		lea	eax, [esp+340h+var_310]
		push	edi
		mov	ebx, ecx
		mov	[esp+344h+var_334], esi
		mov	[esp+344h+Memory], esi
		mov	[esp+344h+var_328], eax
		mov	[esp+344h+var_32C], esi
		lea	edi, [esp+344h+WideCharStr]
		cmp	dword_10031520,	esi
		jnz	short loc_1000826B
		call	PR_Init

loc_1000826B:				; CODE XREF: sub_10008220+44j
		mov	ecx, dword_10030B8C
		push	ecx
		call	PR_EnterMonitor
		add	esp, 4
		test	ebp, 8000h
		jz	short loc_10008286
		mov	edi, ebx
		jmp	short loc_100082C8
; ---------------------------------------------------------------------------

loc_10008286:				; CODE XREF: sub_10008220+60j
		push	esi		; cchWideChar
		push	esi		; lpWideCharStr
		push	0FFFFFFFFh	; cbMultiByte
		push	ebx		; lpMultiByteStr
		push	esi		; dwFlags
		push	esi		; CodePage
		call	ds:MultiByteToWideChar
		mov	esi, eax
		cmp	esi, 104h
		jle	short loc_100082B3
		lea	edx, [esi+esi]
		push	edx		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[esp+344h+var_32C], eax
		mov	edi, eax
		test	eax, eax
		jz	short loc_10008300

loc_100082B3:				; CODE XREF: sub_10008220+7Bj
		push	esi		; cchWideChar
		push	edi		; lpWideCharStr
		push	0FFFFFFFFh	; cbMultiByte
		push	ebx		; lpMultiByteStr
		push	0		; dwFlags
		push	0		; CodePage
		call	ds:MultiByteToWideChar
		test	eax, eax
		jz	short loc_10008300
		xor	esi, esi

loc_100082C8:				; CODE XREF: sub_10008220+64j
		push	esi		; lpUsedDefaultChar
		push	esi		; lpDefaultChar
		push	esi		; cbMultiByte
		push	esi		; lpMultiByteStr
		push	0FFFFFFFFh	; cchWideChar
		push	edi		; lpWideCharStr
		push	esi		; dwFlags
		push	0FDE9h		; CodePage
		call	ds:WideCharToMultiByte
		mov	esi, eax
		cmp	esi, 104h
		jle	loc_10008399
		push	esi		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[esp+344h+Memory], eax
		mov	ebx, eax
		test	eax, eax
		jnz	loc_1000839D

loc_10008300:				; CODE XREF: sub_10008220+91j
					; sub_10008220+A4j ...
		call	ds:GetLastError
		mov	edi, eax

loc_10008308:				; CODE XREF: sub_10008220+1EDj
		push	edi
		push	0FFFFE8A7h
		call	PR_SetError
		push	edi
		push	offset aErrorD	; "error %d"
		lea	eax, [esp+354h+Src]
		push	14h
		push	eax
		call	PR_snprintf
		lea	ecx, [esp+35Ch+Src]
		add	esp, 18h
		test	ecx, ecx
		jz	short loc_1000834C
		mov	eax, ecx
		lea	edx, [eax+1]

loc_10008335:				; CODE XREF: sub_10008220+11Aj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10008335
		sub	eax, edx
		lea	edx, [esp+344h+Src]
		push	edx		; Src
		push	eax		; int
		call	PR_SetErrorText

loc_10008349:				; CODE XREF: sub_10008220+236j
		add	esp, 8

loc_1000834C:				; CODE XREF: sub_10008220+10Ej
					; sub_10008220+1A8j ...
		mov	eax, [esp+344h+Memory]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		test	eax, eax
		jz	short loc_10008361
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_10008361:				; CODE XREF: sub_10008220+136j
		mov	eax, [esp+334h+var_32C]
		test	eax, eax
		jz	short loc_10008372
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_10008372:				; CODE XREF: sub_10008220+147j
		mov	eax, dword_10030B8C
		push	eax
		call	PR_ExitMonitor
		mov	ecx, [esp+338h+var_4]
		mov	eax, [esp+338h+var_334]
		add	esp, 4
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 334h
		retn
; ---------------------------------------------------------------------------

loc_10008399:				; CODE XREF: sub_10008220+C3j
		mov	ebx, [esp+344h+var_328]

loc_1000839D:				; CODE XREF: sub_10008220+DAj
		push	0		; lpUsedDefaultChar
		push	0		; lpDefaultChar
		push	esi		; cbMultiByte
		push	ebx		; lpMultiByteStr
		push	0FFFFFFFFh	; cchWideChar
		push	edi		; lpWideCharStr
		push	0		; dwFlags
		push	0FDE9h		; CodePage
		call	ds:WideCharToMultiByte
		test	eax, eax
		jz	loc_10008300
		mov	eax, ebx
		call	sub_10008190
		mov	[esp+344h+var_334], eax
		test	eax, eax
		jnz	short loc_1000834C
		push	14h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_10008300
		shr	ebp, 1
		and	ebp, 8
		push	ebp		; dwFlags
		push	0		; hFile
		push	edi		; lpLibFileName
		mov	dword ptr [esi+0Ch], 0
		call	ds:LoadLibraryExW
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10008412
		call	ds:GetLastError
		push	esi		; Memory
		mov	edi, eax
		call	PR_Free
		add	esp, 4
		jmp	loc_10008308
; ---------------------------------------------------------------------------

loc_10008412:				; CODE XREF: sub_10008220+1DAj
		push	ebx		; Src
		call	ds:_strdup
		mov	ecx, dword_10030B90
		mov	[esi], eax
		mov	[esi+10h], edi
		mov	[esi+4], ecx
		mov	dword ptr [esi+8], 1
		mov	edx, dword_10032AC0
		add	esp, 4
		cmp	dword ptr [edx+4], 4
		mov	dword_10030B90,	esi
		mov	[esp+344h+var_334], esi
		jl	loc_1000834C
		push	eax
		push	offset aLoadedLibrar_0 ; "Loaded library %s (load lib)"
		call	PR_LogPrint
		jmp	loc_10008349
sub_10008220	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 366. PR_UnloadLibrary

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_UnloadLibrary(void *Memory)
		public PR_UnloadLibrary
PR_UnloadLibrary proc near		; CODE XREF: sub_1000ED80+7Bp
					; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		push	edi
		xor	edi, edi
		test	esi, esi
		jnz	short loc_10008480
		push	esi
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008480:				; CODE XREF: PR_UnloadLibrary+Aj
		mov	eax, dword_10030B8C
		push	eax
		call	PR_EnterMonitor
		mov	eax, [esi+8]
		add	esp, 4
		test	eax, eax
		jg	short loc_100084B6
		mov	ecx, dword_10030B8C
		push	ecx
		call	PR_ExitMonitor
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 0Ch
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100084B6:				; CODE XREF: PR_UnloadLibrary+33j
		dec	eax
		mov	[esi+8], eax
		test	eax, eax
		jle	short loc_100084F2
		mov	edx, dword_10032AC0
		cmp	dword ptr [edx+4], 4
		jl	loc_10008576
		push	eax
		mov	eax, [esi]
		push	eax
		push	offset aSDecrD	; "%s decr => %d"
		call	PR_LogPrint
		mov	eax, dword_10030B8C
		add	esp, 0Ch
		push	eax
		call	PR_ExitMonitor
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100084F2:				; CODE XREF: PR_UnloadLibrary+5Cj
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_10008503
		push	eax		; hLibModule
		call	ds:FreeLibrary
		mov	[esi+10h], edi

loc_10008503:				; CODE XREF: PR_UnloadLibrary+97j
		mov	eax, dword_10030B90
		cmp	eax, esi
		jnz	short loc_10008517
		mov	ecx, [eax+4]
		mov	dword_10030B90,	ecx
		jmp	short loc_10008543
; ---------------------------------------------------------------------------

loc_10008517:				; CODE XREF: PR_UnloadLibrary+AAj
		test	eax, eax
		jz	short loc_10008543
		mov	ecx, eax
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_10008531

loc_10008524:				; CODE XREF: PR_UnloadLibrary+CFj
		cmp	eax, esi
		jz	short loc_10008589
		mov	ecx, eax
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_10008524

loc_10008531:				; CODE XREF: PR_UnloadLibrary+C2j
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	edi, 0FFFFFFFFh

loc_10008543:				; CODE XREF: PR_UnloadLibrary+B5j
					; PR_UnloadLibrary+B9j	...
		mov	eax, dword_10032AC0
		cmp	dword ptr [eax+4], 4
		jl	short loc_1000855E
		mov	ecx, [esi]
		push	ecx
		push	offset aUnloadedLibrar ; "Unloaded library %s"
		call	PR_LogPrint
		add	esp, 8

loc_1000855E:				; CODE XREF: PR_UnloadLibrary+ECj
		mov	edx, [esi]
		push	edx		; Memory
		call	ds:free
		push	esi		; Memory
		mov	dword ptr [esi], 0
		call	PR_Free
		add	esp, 8

loc_10008576:				; CODE XREF: PR_UnloadLibrary+68j
		mov	eax, dword_10030B8C
		push	eax
		call	PR_ExitMonitor
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008589:				; CODE XREF: PR_UnloadLibrary+C6j
		mov	edx, [eax+4]
		mov	[ecx+4], edx
		jmp	short loc_10008543
PR_UnloadLibrary endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100085A0	proc near		; CODE XREF: PR_FindSymbol+14p
		push	esi
		push	edi
		mov	edi, eax
		mov	eax, [ecx+0Ch]
		test	eax, eax
		jz	short loc_10008602
		mov	esi, eax
		mov	ecx, [esi]
		test	ecx, ecx
		jz	short loc_100085E8

loc_100085B3:				; CODE XREF: sub_100085A0+46j
		mov	eax, edi

loc_100085B5:				; CODE XREF: sub_100085A0+2Fj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_100085D5
		test	dl, dl
		jz	short loc_100085D1
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_100085D5
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_100085B5

loc_100085D1:				; CODE XREF: sub_100085A0+1Dj
		xor	eax, eax
		jmp	short loc_100085DA
; ---------------------------------------------------------------------------

loc_100085D5:				; CODE XREF: sub_100085A0+19j
					; sub_100085A0+25j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_100085DA:				; CODE XREF: sub_100085A0+33j
		test	eax, eax
		jz	short loc_100085FC
		mov	ecx, [esi+8]
		add	esi, 8
		test	ecx, ecx
		jnz	short loc_100085B3

loc_100085E8:				; CODE XREF: sub_100085A0+11j
		push	0
		push	0FFFFE8A9h
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100085FC:				; CODE XREF: sub_100085A0+3Cj
		mov	eax, [esi+4]
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008602:				; CODE XREF: sub_100085A0+9j
		mov	eax, [ecx+10h]
		push	edi		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10008634
		mov	edi, ds:GetLastError
		call	edi ; GetLastError
		push	eax
		push	0FFFFE8A9h
		call	PR_SetError
		add	esp, 8
		call	edi ; GetLastError
		push	eax
		call	sub_10007EC0
		add	esp, 4

loc_10008634:				; CODE XREF: sub_100085A0+71j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_100085A0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 123. PR_FindFunctionSymbol
; Exported entry 129. PR_FindSymbol

; =============== S U B	R O U T	I N E =======================================


		public PR_FindSymbol
PR_FindSymbol	proc near		; CODE XREF: sub_1000ED80+39p
					; sub_1000ED80+50p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, dword_10030B8C ; PR_FindFunctionSymbol
		push	esi
		push	eax
		call	PR_EnterMonitor
		mov	eax, [esp+8+arg_4]
		mov	ecx, [esp+8+arg_0]
		call	sub_100085A0
		mov	ecx, dword_10030B8C
		push	ecx
		mov	esi, eax
		call	PR_ExitMonitor
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
PR_FindSymbol	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 130. PR_FindSymbolAndLibrary

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_FindSymbolAndLibrary(LPCSTR lpProcName, int)
		public PR_FindSymbolAndLibrary
PR_FindSymbolAndLibrary	proc near	; CODE XREF: PR_FindFunctionSymbolAndLibraryj
					; DATA XREF: .rdata:off_1002C7C8o

var_1C		= dword	ptr -1Ch
Src		= byte ptr -18h
var_4		= dword	ptr -4
lpProcName	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		mov	eax, [esp+1Ch+arg_4]
		push	ebx
		mov	ebx, [esp+20h+lpProcName]
		push	esi
		xor	esi, esi
		push	edi
		mov	[esp+28h+var_1C], eax
		cmp	dword_10031520,	esi
		jnz	short loc_1000869C
		call	PR_Init

loc_1000869C:				; CODE XREF: PR_FindSymbolAndLibrary+25j
		mov	ecx, dword_10030B8C
		push	ecx
		call	PR_EnterMonitor
		mov	eax, dword_10030B90
		add	esp, 4
		mov	edi, eax
		test	eax, eax
		jz	loc_100087B5
		push	ebp
		mov	ebp, ds:GetLastError

loc_100086C1:				; CODE XREF: PR_FindSymbolAndLibrary+112j
		mov	eax, [edi+0Ch]
		test	eax, eax
		jz	short loc_1000871D
		mov	esi, eax
		mov	ecx, [esi]
		test	ecx, ecx
		jz	short loc_10008705

loc_100086D0:				; CODE XREF: PR_FindSymbolAndLibrary+93j
		mov	eax, ebx

loc_100086D2:				; CODE XREF: PR_FindSymbolAndLibrary+7Cj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_100086F2
		test	dl, dl
		jz	short loc_100086EE
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_100086F2
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_100086D2

loc_100086EE:				; CODE XREF: PR_FindSymbolAndLibrary+6Aj
		xor	eax, eax
		jmp	short loc_100086F7
; ---------------------------------------------------------------------------

loc_100086F2:				; CODE XREF: PR_FindSymbolAndLibrary+66j
					; PR_FindSymbolAndLibrary+72j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_100086F7:				; CODE XREF: PR_FindSymbolAndLibrary+80j
		test	eax, eax
		jz	short loc_10008718
		mov	ecx, [esi+8]
		add	esi, 8
		test	ecx, ecx
		jnz	short loc_100086D0

loc_10008705:				; CODE XREF: PR_FindSymbolAndLibrary+5Ej
		push	0
		push	0FFFFE8A9h
		call	PR_SetError
		add	esp, 8
		xor	esi, esi
		jmp	short loc_1000877D
; ---------------------------------------------------------------------------

loc_10008718:				; CODE XREF: PR_FindSymbolAndLibrary+89j
		mov	esi, [esi+4]
		jmp	short loc_10008779
; ---------------------------------------------------------------------------

loc_1000871D:				; CODE XREF: PR_FindSymbolAndLibrary+56j
		mov	edx, [edi+10h]
		push	ebx		; lpProcName
		push	edx		; hModule
		call	ds:GetProcAddress
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000878A
		call	ebp ; GetLastError
		push	eax
		push	0FFFFE8A9h
		call	PR_SetError
		add	esp, 8
		call	ebp ; GetLastError
		push	eax
		push	offset aErrorD	; "error %d"
		lea	eax, [esp+34h+Src]
		push	14h
		push	eax
		call	PR_snprintf
		lea	ecx, [esp+3Ch+Src]
		add	esp, 10h
		test	ecx, ecx
		jz	short loc_10008779
		mov	eax, ecx
		lea	edx, [eax+1]

loc_10008762:				; CODE XREF: PR_FindSymbolAndLibrary+F7j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10008762
		sub	eax, edx
		lea	edx, [esp+2Ch+Src]
		push	edx		; Src
		push	eax		; int
		call	PR_SetErrorText
		add	esp, 8

loc_10008779:				; CODE XREF: PR_FindSymbolAndLibrary+ABj
					; PR_FindSymbolAndLibrary+EBj
		test	esi, esi
		jnz	short loc_1000878A

loc_1000877D:				; CODE XREF: PR_FindSymbolAndLibrary+A6j
		mov	edi, [edi+4]
		test	edi, edi
		jnz	loc_100086C1
		jmp	short loc_100087B4
; ---------------------------------------------------------------------------

loc_1000878A:				; CODE XREF: PR_FindSymbolAndLibrary+BCj
					; PR_FindSymbolAndLibrary+10Bj
		mov	eax, [esp+2Ch+var_1C]
		mov	[eax], edi
		inc	dword ptr [edi+8]
		mov	ecx, dword_10032AC0
		cmp	dword ptr [ecx+4], 4
		mov	eax, [edi+8]
		jl	short loc_100087B4
		mov	edx, [edi]
		push	ebx
		push	eax
		push	edx
		push	offset aSIncrDForS ; "%s incr => %d (for %s)"
		call	PR_LogPrint
		add	esp, 10h

loc_100087B4:				; CODE XREF: PR_FindSymbolAndLibrary+118j
					; PR_FindSymbolAndLibrary+130j
		pop	ebp

loc_100087B5:				; CODE XREF: PR_FindSymbolAndLibrary+44j
		mov	eax, dword_10030B8C
		push	eax
		call	PR_ExitMonitor
		mov	ecx, [esp+2Ch+var_4]
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
PR_FindSymbolAndLibrary	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 124. PR_FindFunctionSymbolAndLibrary

; =============== S U B	R O U T	I N E =======================================


		public PR_FindFunctionSymbolAndLibrary
PR_FindFunctionSymbolAndLibrary	proc near ; DATA XREF: .rdata:off_1002C7C8o
		jmp	PR_FindSymbolAndLibrary
PR_FindFunctionSymbolAndLibrary	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 231. PR_LoadStaticLibrary

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_LoadStaticLibrary(char	*Src, int)
		public PR_LoadStaticLibrary
PR_LoadStaticLibrary proc near		; DATA XREF: .rdata:off_1002C7C8o

Src		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword_10031520,	0
		jnz	short loc_100087FE
		call	PR_Init

loc_100087FE:				; CODE XREF: PR_LoadStaticLibrary+7j
		mov	eax, dword_10030B8C
		push	ebx
		push	edi
		push	eax
		call	PR_EnterMonitor
		mov	ebx, [esp+0Ch+Src]
		add	esp, 4
		mov	eax, ebx
		call	sub_10008190
		mov	edi, eax
		test	edi, edi
		jz	short loc_10008839
		mov	eax, dword_10030B8C
		mov	ecx, [esp+8+arg_4]
		push	eax
		mov	[edi+0Ch], ecx
		call	PR_ExitMonitor
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10008839:				; CODE XREF: PR_LoadStaticLibrary+2Dj
		push	esi
		push	14h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_100088A5
		push	ebx		; Src
		call	ds:_strdup
		mov	ecx, dword_10030B94
		add	esp, 4
		mov	[esi], eax
		mov	dword ptr [esi+8], 1
		test	ecx, ecx
		jz	short loc_1000886E
		mov	ecx, [ecx+10h]
		jmp	short loc_10008870
; ---------------------------------------------------------------------------

loc_1000886E:				; CODE XREF: PR_LoadStaticLibrary+77j
		xor	ecx, ecx

loc_10008870:				; CODE XREF: PR_LoadStaticLibrary+7Cj
		mov	edx, [esp+0Ch+arg_4]
		mov	[esi+10h], ecx
		mov	ecx, dword_10030B90
		mov	[esi+0Ch], edx
		mov	[esi+4], ecx
		mov	edx, dword_10032AC0
		cmp	dword ptr [edx+4], 4
		mov	dword_10030B90,	esi
		mov	edi, esi
		jl	short loc_100088A5
		push	eax
		push	offset aLoadedLibraryS ; "Loaded library %s (static lib)"
		call	PR_LogPrint
		add	esp, 8

loc_100088A5:				; CODE XREF: PR_LoadStaticLibrary+5Aj
					; PR_LoadStaticLibrary+A5j
		mov	eax, dword_10030B8C
		pop	esi
		push	eax
		call	PR_ExitMonitor
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	ebx
		retn
PR_LoadStaticLibrary endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 165. PR_GetLibraryFilePathname

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetLibraryFilePathname(LPCSTR lpMultiByteStr)
		public PR_GetLibraryFilePathname
PR_GetLibraryFilePathname proc near	; DATA XREF: .rdata:off_1002C7C8o

Src		= byte ptr -428h
Filename	= word ptr -414h
WideCharStr	= word ptr -20Ch
var_4		= dword	ptr -4
lpMultiByteStr	= dword	ptr  4

		sub	esp, 428h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+428h+var_4], eax
		mov	eax, [esp+428h+lpMultiByteStr]
		push	esi
		push	104h		; cchWideChar
		lea	ecx, [esp+430h+WideCharStr]
		push	ecx		; lpWideCharStr
		push	0FFFFFFFFh	; cbMultiByte
		push	eax		; lpMultiByteStr
		push	0		; dwFlags
		push	0		; CodePage
		call	ds:MultiByteToWideChar
		test	eax, eax
		jz	short loc_1000890C
		lea	edx, [esp+42Ch+WideCharStr]
		push	edx		; lpModuleName
		call	ds:GetModuleHandleW
		test	eax, eax
		jnz	short loc_10008975

loc_1000890C:				; CODE XREF: PR_GetLibraryFilePathname+38j
		mov	esi, ds:GetLastError
		call	esi ; GetLastError
		push	eax
		push	0FFFFE8DAh
		call	PR_SetError
		add	esp, 8
		call	esi ; GetLastError
		push	eax
		push	offset aErrorD	; "error %d"
		lea	eax, [esp+434h+Src]
		push	14h
		push	eax
		call	PR_snprintf
		lea	ecx, [esp+43Ch+Src]
		add	esp, 10h
		test	ecx, ecx
		jz	short loc_1000895D
		mov	eax, ecx
		lea	edx, [eax+1]

loc_10008946:				; CODE XREF: PR_GetLibraryFilePathname+8Bj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10008946
		sub	eax, edx
		lea	edx, [esp+42Ch+Src]
		push	edx		; Src
		push	eax		; int
		call	PR_SetErrorText
		add	esp, 8

loc_1000895D:				; CODE XREF: PR_GetLibraryFilePathname+7Fj
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+428h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 428h
		retn
; ---------------------------------------------------------------------------

loc_10008975:				; CODE XREF: PR_GetLibraryFilePathname+4Aj
		push	104h		; nSize
		lea	ecx, [esp+430h+Filename]
		push	ecx		; lpFilename
		push	eax		; hModule
		call	ds:GetModuleFileNameW
		test	eax, eax
		jnz	short loc_100089B1
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+428h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 428h
		retn
; ---------------------------------------------------------------------------

loc_100089B1:				; CODE XREF: PR_GetLibraryFilePathname+C8j
		push	ebx
		mov	ebx, ds:WideCharToMultiByte
		push	0		; lpUsedDefaultChar
		push	0		; lpDefaultChar
		push	0		; cbMultiByte
		push	0		; lpMultiByteStr
		push	0FFFFFFFFh	; cchWideChar
		lea	edx, [esp+444h+Filename]
		push	edx		; lpWideCharStr
		push	0		; dwFlags
		push	0		; CodePage
		call	ebx ; WideCharToMultiByte
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100089FB
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		pop	ebx
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+428h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 428h
		retn
; ---------------------------------------------------------------------------

loc_100089FB:				; CODE XREF: PR_GetLibraryFilePathname+111j
		lea	eax, [esi+esi]
		push	edi
		push	eax		; Size
		call	PR_Malloc
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	short loc_10008A21
		push	0		; lpUsedDefaultChar
		push	0		; lpDefaultChar
		push	esi		; cbMultiByte
		push	edi		; lpMultiByteStr
		push	0FFFFFFFFh	; cchWideChar
		lea	ecx, [esp+448h+Filename]
		push	ecx		; lpWideCharStr
		push	0		; dwFlags
		push	0		; CodePage
		call	ebx ; WideCharToMultiByte

loc_10008A21:				; CODE XREF: PR_GetLibraryFilePathname+14Cj
		mov	ecx, [esp+434h+var_4]
		mov	eax, edi
		pop	edi
		pop	ebx
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 428h
		retn
PR_GetLibraryFilePathname endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 230. PR_LoadLibraryWithFlags

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_LoadLibraryWithFlags(int, LPCWSTR lpLibFileName, int, int)
		public PR_LoadLibraryWithFlags
PR_LoadLibraryWithFlags	proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
lpLibFileName	= dword	ptr  8
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		test	eax, eax
		jnz	short loc_10008A4D
		mov	eax, 1

loc_10008A4D:				; CODE XREF: PR_LoadLibraryWithFlags+6j
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jz	short loc_10008A71
		cmp	ecx, 3
		jz	short loc_10008A6C
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10008A6C:				; CODE XREF: PR_LoadLibraryWithFlags+18j
		or	eax, 8000h

loc_10008A71:				; CODE XREF: PR_LoadLibraryWithFlags+13j
		mov	ecx, [esp+lpLibFileName] ; lpLibFileName
		push	eax		; int
		call	sub_10008220
		add	esp, 4
		retn
PR_LoadLibraryWithFlags	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 229. PR_LoadLibrary

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_LoadLibrary(LPCWSTR lpLibFileName)
		public PR_LoadLibrary
PR_LoadLibrary	proc near		; CODE XREF: sub_1000ED80+25p
					; DATA XREF: .rdata:off_1002C7C8o

lpLibFileName	= dword	ptr  4

		mov	ecx, [esp+lpLibFileName] ; lpLibFileName
		push	1		; int
		call	sub_10008220
		add	esp, 4
		retn
PR_LoadLibrary	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 239. PR_Malloc

; =============== S U B	R O U T	I N E =======================================


; void *__cdecl	PR_Malloc(size_t Size)
		public PR_Malloc
PR_Malloc	proc near		; CODE XREF: sub_10001010+B0p
					; sub_10001010+C0p ...
		jmp	ds:malloc
PR_Malloc	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  42. PR_Calloc

; =============== S U B	R O U T	I N E =======================================


; void *__cdecl	PR_Calloc(size_t NumOfElements,	size_t SizeOfElements)
		public PR_Calloc
PR_Calloc	proc near		; CODE XREF: sub_100016A0+13p
					; sub_10001780+37p ...
		jmp	ds:calloc
PR_Calloc	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 301. PR_Realloc

; =============== S U B	R O U T	I N E =======================================


; void *__cdecl	PR_Realloc(void	*Memory, size_t	NewSize)
		public PR_Realloc
PR_Realloc	proc near		; CODE XREF: sub_100063A0+33p
					; sub_10007470+7Ap ...
		jmp	ds:realloc
PR_Realloc	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 134. PR_Free

; =============== S U B	R O U T	I N E =======================================


; void __cdecl PR_Free(void *Memory)
		public PR_Free
PR_Free		proc near		; CODE XREF: sub_10001010+D4p
					; PR_FreeFileDesc_0+45p ...
		jmp	ds:free
PR_Free		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008AD0	proc near		; CODE XREF: PR_GetPageShift+9p
					; PR_GetPageSize+9p

var_24		= byte ptr -24h
var_20		= dword	ptr -20h

		sub	esp, 24h
		lea	eax, [esp+24h+var_24]
		push	eax		; lpSystemInfo
		call	ds:GetSystemInfo
		mov	eax, [esp+24h+var_20]
		lea	ecx, [eax-1]
		mov	dword_10032B10,	eax
		mov	dword_10032B0C,	0
		mov	edx, 1
		test	eax, ecx
		jz	short loc_10008B02
		mov	dword_10032B0C,	edx

loc_10008B02:				; CODE XREF: sub_10008AD0+2Aj
		mov	ecx, eax
		shr	ecx, 10h
		test	ecx, ecx
		jz	short loc_10008B14
		add	dword_10032B0C,	10h
		mov	eax, ecx

loc_10008B14:				; CODE XREF: sub_10008AD0+39j
		mov	ecx, eax
		shr	ecx, 8
		test	ecx, ecx
		jz	short loc_10008B26
		add	dword_10032B0C,	8
		mov	eax, ecx

loc_10008B26:				; CODE XREF: sub_10008AD0+4Bj
		mov	ecx, eax
		shr	ecx, 4
		test	ecx, ecx
		jz	short loc_10008B38
		add	dword_10032B0C,	4
		mov	eax, ecx

loc_10008B38:				; CODE XREF: sub_10008AD0+5Dj
		mov	ecx, eax
		shr	ecx, 2
		test	ecx, ecx
		jz	short loc_10008B4A
		add	dword_10032B0C,	2
		mov	eax, ecx

loc_10008B4A:				; CODE XREF: sub_10008AD0+6Fj
		test	eax, 0FFFFFFFEh
		jz	short loc_10008B57
		add	dword_10032B0C,	edx

loc_10008B57:				; CODE XREF: sub_10008AD0+7Fj
		add	esp, 24h
		retn
sub_10008AD0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 175. PR_GetPageShift

; =============== S U B	R O U T	I N E =======================================


		public PR_GetPageShift
PR_GetPageShift	proc near		; DATA XREF: .rdata:off_1002C7C8o
		cmp	dword_10032B10,	0
		jnz	short loc_10008B6E
		call	sub_10008AD0

loc_10008B6E:				; CODE XREF: PR_GetPageShift+7j
		mov	eax, dword_10032B0C
		retn
PR_GetPageShift	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 176. PR_GetPageSize

; =============== S U B	R O U T	I N E =======================================


		public PR_GetPageSize
PR_GetPageSize	proc near		; CODE XREF: PR_Init_0+1Cp
					; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, dword_10032B10
		test	eax, eax
		jnz	short locret_10008B93
		call	sub_10008AD0
		mov	eax, dword_10032B10

locret_10008B93:			; CODE XREF: PR_GetPageSize+7j
		retn
PR_GetPageSize	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 275. PR_OpenSharedMemory

; =============== S U B	R O U T	I N E =======================================


		public PR_OpenSharedMemory
PR_OpenSharedMemory proc near		; DATA XREF: .rdata:off_1002C7C8o
		cmp	dword_10031520,	0
		jnz	short loc_10008BAE
		call	PR_Init

loc_10008BAE:				; CODE XREF: PR_OpenSharedMemory+7j
		jmp	sub_10025F70
PR_OpenSharedMemory endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  26. PR_AttachSharedMemory
; [00000005 BYTES: COLLAPSED FUNCTION PR_AttachSharedMemory]
		align 10h
; Exported entry  96. PR_DetachSharedMemory
; [00000005 BYTES: COLLAPSED FUNCTION PR_DetachSharedMemory]
		align 10h
; Exported entry  55. PR_CloseSharedMemory
; [00000005 BYTES: COLLAPSED FUNCTION PR_CloseSharedMemory]
		align 10h
; Exported entry  79. PR_DeleteSharedMemory

; =============== S U B	R O U T	I N E =======================================


		public PR_DeleteSharedMemory
PR_DeleteSharedMemory proc near		; DATA XREF: .rdata:off_1002C7C8o
		cmp	dword_10031520,	0
		jnz	short loc_10008BFE
		call	PR_Init

loc_10008BFE:				; CODE XREF: PR_DeleteSharedMemory+7j
		jmp	sub_10014330
PR_DeleteSharedMemory endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 271. PR_OpenAnonFileMap
; [00000005 BYTES: COLLAPSED FUNCTION PR_OpenAnonFileMap]
		align 10h
; Exported entry  28. PR_AttachThreadGCAble
; Exported entry  65. PR_CreateOrderedLock
; Exported entry 163. PR_GetInheritedFileMap

; =============== S U B	R O U T	I N E =======================================


		public PR_GetInheritedFileMap
PR_GetInheritedFileMap proc near	; DATA XREF: .rdata:off_1002C7C8o
		push	0		; PR_AttachThreadGCAble
					; PR_CreateOrderedLock
		push	0FFFFE898h
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		retn
PR_GetInheritedFileMap endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 114. PR_ExportFileMapAsString
; [00000005 BYTES: COLLAPSED FUNCTION PR_ExportFileMapAsString]
		align 10h
; Exported entry 209. PR_ImportFileMapFromString
; [00000005 BYTES: COLLAPSED FUNCTION PR_ImportFileMapFromString]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008C60	proc near		; CODE XREF: PR_SetAlarm+4Bp
					; PR_ResetAlarm+31p

var_A		= word ptr -0Ah
var_8		= qword	ptr -8

		mov	edx, [ecx+14h]
		fild	dword ptr [ecx+14h]
		mov	eax, [ecx+1Ch]
		sub	esp, 0Ch
		test	edx, edx
		jns	short loc_10008C76
		fadd	ds:dbl_10028800

loc_10008C76:				; CODE XREF: sub_10008C60+Ej
		mov	edx, [ecx+18h]
		fild	dword ptr [ecx+18h]
		test	edx, edx
		jns	short loc_10008C86
		fadd	ds:dbl_10028800

loc_10008C86:				; CODE XREF: sub_10008C60+1Ej
		mov	edx, eax
		fdivp	st(1), st
		mov	dword ptr [esp+0Ch+var_8], edx
		fild	dword ptr [esp+0Ch+var_8]
		test	edx, edx
		jns	short loc_10008C9C
		fadd	ds:dbl_10028800

loc_10008C9C:				; CODE XREF: sub_10008C60+34j
		inc	eax
		fnstcw	[esp+0Ch+var_A]
		mov	[ecx+1Ch], eax
		fmulp	st(1), st
		mov	eax, [ecx+24h]
		mov	[ecx+28h], eax
		movzx	eax, [esp+0Ch+var_A]
		fadd	ds:dbl_100287F8
		or	eax, 0C00h
		mov	dword ptr [esp+0Ch+var_8], eax
		fldcw	word ptr [esp+0Ch+var_8]
		fistp	[esp+0Ch+var_8]
		mov	eax, dword ptr [esp+0Ch+var_8]
		mov	[ecx+24h], eax
		sub	eax, [ecx+28h]
		fldcw	[esp+0Ch+var_A]
		add	esp, 0Ch
		retn
sub_10008C60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10008CE0	proc near		; DATA XREF: PR_CreateAlarm+55o

var_8		= qword	ptr -8
arg_0		= dword	ptr  4

		sub	esp, 8
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]

loc_10008CEF:				; CODE XREF: sub_10008CE0+175j
		xor	esi, esi

loc_10008CF1:				; CODE XREF: sub_10008CE0+166j
		mov	ebx, 2

loc_10008CF6:				; CODE XREF: sub_10008CE0+17Dj
		mov	eax, [edi+8]
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	ebx, 2
		jnz	loc_10008DAE
		jmp	short loc_10008D10
; ---------------------------------------------------------------------------
		align 10h

loc_10008D10:				; CODE XREF: sub_10008CE0+2Bj
					; sub_10008CE0+A4j ...
		mov	ebx, 1
		mov	dword ptr [edi+14h], 0
		cmp	[edi+18h], ebx
		jz	loc_10008DAE
		call	PR_IntervalNow
		mov	ecx, [edi]
		cmp	ecx, edi
		jz	short loc_10008D72
		test	esi, esi
		jz	short loc_10008D61
		mov	edx, eax
		sub	edx, [esi+24h]
		lea	esp, [esp+0]

loc_10008D40:				; CODE XREF: sub_10008CE0+6Dj
		mov	ebx, eax
		sub	ebx, [ecx+24h]
		cmp	ebx, edx
		ja	short loc_10008D51
		mov	ecx, [ecx]
		cmp	ecx, edi
		jnz	short loc_10008D40
		jmp	short loc_10008D61
; ---------------------------------------------------------------------------

loc_10008D51:				; CODE XREF: sub_10008CE0+67j
		mov	[esi], edi
		mov	ecx, [edi+4]
		mov	[esi+4], ecx
		mov	edx, [edi+4]
		mov	[edx], esi
		mov	[edi+4], esi

loc_10008D61:				; CODE XREF: sub_10008CE0+52j
					; sub_10008CE0+6Fj
		mov	esi, [edi]
		mov	eax, [esi+4]
		mov	ecx, [esi]
		mov	[eax], ecx
		mov	edx, [esi]
		mov	eax, [esi+4]
		mov	[edx+4], eax

loc_10008D72:				; CODE XREF: sub_10008CE0+4Ej
		test	esi, esi
		jnz	short loc_10008D86
		mov	ecx, [edi+0Ch]
		push	0FFFFFFFFh
		push	ecx
		call	PR_WaitCondVar
		add	esp, 8
		jmp	short loc_10008D10
; ---------------------------------------------------------------------------

loc_10008D86:				; CODE XREF: sub_10008CE0+94j
		call	PR_IntervalNow
		mov	ebp, [esi+24h]
		add	ebp, [esi+20h]
		sub	ebp, eax
		test	ebp, ebp
		jle	short loc_10008DA9
		mov	edx, [edi+0Ch]
		push	ebp
		push	edx
		call	PR_WaitCondVar
		add	esp, 8
		jmp	loc_10008D10
; ---------------------------------------------------------------------------

loc_10008DA9:				; CODE XREF: sub_10008CE0+B5j
		xor	ebx, ebx
		mov	[edi+14h], esi

loc_10008DAE:				; CODE XREF: sub_10008CE0+25j
					; sub_10008CE0+3Fj
		mov	eax, [edi+8]
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	ebx, ebx
		jnz	loc_10008E5A
		mov	ecx, [esi+14h]
		fild	dword ptr [esi+14h]
		mov	eax, [esi+1Ch]
		test	ecx, ecx
		jns	short loc_10008DD5
		fadd	ds:dbl_10028800

loc_10008DD5:				; CODE XREF: sub_10008CE0+EDj
		mov	edx, [esi+18h]
		fild	dword ptr [esi+18h]
		test	edx, edx
		jns	short loc_10008DE5
		fadd	ds:dbl_10028800

loc_10008DE5:				; CODE XREF: sub_10008CE0+FDj
		mov	ecx, eax
		fdivp	st(1), st
		mov	[esp+18h+arg_0], ecx
		fild	[esp+18h+arg_0]
		test	ecx, ecx
		jns	short loc_10008DFB
		fadd	ds:dbl_10028800

loc_10008DFB:				; CODE XREF: sub_10008CE0+113j
		mov	edx, [esi+24h]
		fnstcw	word ptr [esp+18h+arg_0]
		inc	eax
		fmulp	st(1), st
		mov	[esi+1Ch], eax
		movzx	eax, word ptr [esp+18h+arg_0]
		or	eax, 0C00h
		fadd	ds:dbl_100287F8
		mov	dword ptr [esp+18h+var_8], eax
		mov	ecx, ebp
		not	ecx
		fldcw	word ptr [esp+18h+var_8]
		mov	[esi+28h], edx
		mov	edx, [esi+10h]
		push	ecx
		push	edx
		push	esi
		fistp	[esp+24h+var_8]
		mov	eax, dword ptr [esp+24h+var_8]
		mov	[esi+24h], eax
		mov	eax, [esi+0Ch]
		fldcw	word ptr [esp+24h+arg_0]
		call	eax
		add	esp, 0Ch
		test	eax, eax
		jnz	loc_10008CF1
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		jmp	loc_10008CEF
; ---------------------------------------------------------------------------

loc_10008E5A:				; CODE XREF: sub_10008CE0+DCj
		cmp	ebx, 1
		jnz	loc_10008CF6
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_10008CE0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  59. PR_CreateAlarm

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateAlarm
PR_CreateAlarm	proc near		; DATA XREF: .rdata:off_1002C7C8o
		push	esi
		push	1Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_10008F08
		call	PR_NewLock
		mov	[esi+8], eax
		test	eax, eax
		jz	short loc_10008EDB
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+0Ch], eax
		test	eax, eax
		jz	short loc_10008EDB
		push	0
		push	0
		push	0
		mov	dword ptr [esi+18h], 0
		mov	[esi], esi
		mov	[esi+4], esi
		call	PR_GetCurrentThread
		push	eax
		call	PR_GetThreadPriority
		add	esp, 4
		push	eax
		push	esi
		push	offset sub_10008CE0
		push	0
		call	PR_CreateThread
		add	esp, 1Ch
		mov	[esi+10h], eax
		test	eax, eax
		jnz	short loc_10008F08

loc_10008EDB:				; CODE XREF: PR_CreateAlarm+21j
					; PR_CreateAlarm+31j
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_10008EEB
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_10008EEB:				; CODE XREF: PR_CreateAlarm+70j
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_10008EFB
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4

loc_10008EFB:				; CODE XREF: PR_CreateAlarm+80j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008F08:				; CODE XREF: PR_CreateAlarm+11j
					; PR_CreateAlarm+69j
		mov	eax, esi
		pop	esi
		retn
PR_CreateAlarm	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  80. PR_DestroyAlarm

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyAlarm(void *Memory)
		public PR_DestroyAlarm
PR_DestroyAlarm	proc near		; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi+8]
		push	edi
		push	eax
		call	PR_Lock
		mov	ecx, [esi+0Ch]
		push	ecx
		mov	dword ptr [esi+18h], 1
		call	PR_NotifyCondVar
		mov	edx, [esi+8]
		push	edx		; lpTlsValue
		mov	edi, eax
		call	PR_Unlock
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_10008F6E
		mov	eax, [esi+10h]
		push	eax
		call	PR_JoinThread
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_10008F70
		mov	ecx, [esi+0Ch]
		push	ecx		; Memory
		call	PR_DestroyCondVar
		mov	edx, [esi+8]
		push	edx		; Memory
		call	PR_DestroyLock
		push	esi		; Memory
		call	PR_Free
		add	esp, 0Ch

loc_10008F6E:				; CODE XREF: PR_DestroyAlarm+2Fj
		mov	eax, edi

loc_10008F70:				; CODE XREF: PR_DestroyAlarm+41j
		pop	edi
		pop	esi
		retn
PR_DestroyAlarm	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 318. PR_SetAlarm

; =============== S U B	R O U T	I N E =======================================


		public PR_SetAlarm
PR_SetAlarm	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	esi
		push	2Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10008F95
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10008F95:				; CODE XREF: PR_SetAlarm+11j
		mov	eax, [esp+4+arg_C]
		mov	ecx, [esp+4+arg_10]
		mov	edx, [esp+4+arg_4]
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	[esi+0Ch], eax
		mov	eax, [esp+8+arg_8]
		mov	[esi+8], edi
		mov	[esi], esi
		mov	[esi+4], esi
		mov	[esi+10h], ecx
		mov	[esi+14h], edx
		mov	[esi+18h], eax
		call	PR_IntervalNow
		mov	ecx, esi
		mov	[esi+24h], eax
		mov	[esi+20h], eax
		call	sub_10008C60
		mov	ecx, [edi+8]
		push	ecx
		call	PR_Lock
		mov	[esi], edi
		mov	edx, [edi+4]
		mov	[esi+4], edx
		mov	eax, [edi+4]
		mov	[eax], esi
		mov	ecx, [edi+0Ch]
		push	ecx
		mov	[edi+4], esi
		call	PR_NotifyCondVar
		mov	edx, [edi+8]
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 0Ch
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_SetAlarm	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 306. PR_ResetAlarm

; =============== S U B	R O U T	I N E =======================================


		public PR_ResetAlarm
PR_ResetAlarm	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+8]
		cmp	esi, [eax+14h]
		jz	short loc_10009022
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10009022:				; CODE XREF: PR_ResetAlarm+Bj
		mov	ecx, [esp+4+arg_4]
		mov	edx, [esp+4+arg_8]
		mov	[esi+14h], ecx
		mov	[esi+18h], edx
		mov	dword ptr [esi+1Ch], 1
		call	PR_IntervalNow
		mov	ecx, esi
		mov	[esi+20h], eax
		call	sub_10008C60
		xor	eax, eax
		pop	esi
		retn
PR_ResetAlarm	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  24. PR_AtomicIncrement
; [00000005 BYTES: COLLAPSED FUNCTION PR_AtomicIncrement]
		align 10h
; Exported entry  23. PR_AtomicDecrement
; [00000005 BYTES: COLLAPSED FUNCTION PR_AtomicDecrement]
		align 10h
; Exported entry  25. PR_AtomicSet

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_AtomicSet(volatile LONG *Target, LONG Value)
		public PR_AtomicSet
PR_AtomicSet	proc near		; CODE XREF: PR_CallOnce+22p
					; PR_CallOnceWithArg+22p
					; DATA XREF: ...

Target		= dword	ptr  4
Value		= dword	ptr  8

		mov	eax, [esp+Value]
		mov	ecx, [esp+Target]
		push	eax		; Value
		push	ecx		; Target
		call	ds:InterlockedExchange
		retn
PR_AtomicSet	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  22. PR_AtomicAdd
; [00000005 BYTES: COLLAPSED FUNCTION PR_AtomicAdd]
		align 10h
; Exported entry  70. PR_CreateStack

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateStack
PR_CreateStack	proc near		; CODE XREF: sub_100012C0+A1p
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_100090AE
		call	PR_Init

loc_100090AE:				; CODE XREF: PR_CreateStack+7j
		push	esi
		push	0Ch		; Size
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_100090C1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100090C1:				; CODE XREF: PR_CreateStack+1Dj
		push	edi
		mov	edi, [esp+8+arg_0]
		test	edi, edi
		jz	short loc_10009115
		mov	eax, edi
		lea	edx, [eax+1]
		nop

loc_100090D0:				; CODE XREF: PR_CreateStack+35j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100090D0
		sub	eax, edx
		inc	eax
		push	eax		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[esi+8], eax
		test	eax, eax
		jnz	short loc_100090F8
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100090F8:				; CODE XREF: PR_CreateStack+48j
		mov	ecx, edi
		mov	edx, eax
		lea	esp, [esp+0]

loc_10009100:				; CODE XREF: PR_CreateStack+68j
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_10009100
		pop	edi
		mov	dword ptr [esi], 0
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10009115:				; CODE XREF: PR_CreateStack+28j
		pop	edi
		mov	dword ptr [esi+8], 0
		mov	dword ptr [esi], 0
		mov	eax, esi
		pop	esi
		retn
PR_CreateStack	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  92. PR_DestroyStack

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyStack(void *Memory)
		public PR_DestroyStack
PR_DestroyStack	proc near		; CODE XREF: sub_10001370+A4p
					; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		cmp	dword ptr [esi], 0
		jz	short loc_1000914E
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000914E:				; CODE XREF: PR_DestroyStack+8j
		mov	eax, [esi+8]
		test	eax, eax
		jz	short loc_1000915E
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_1000915E:				; CODE XREF: PR_DestroyStack+23j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
PR_DestroyStack	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  60. PR_CreateCounter

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateCounter
PR_CreateCounter proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10030BA0,	0
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebx, offset dword_10030BA4
		jnz	short loc_100091BD
		call	PR_NewLock
		push	offset aCounters ; "counters"
		mov	dword_10030BA0,	eax
		mov	dword_10030BA4,	ebx
		mov	dword_10030BA8,	ebx
		call	PR_NewLogModule
		add	esp, 4
		cmp	dword ptr [eax+4], 4
		mov	dword_10030B9C,	eax
		jl	short loc_100091BD
		push	offset aPr_counterInit ; "PR_Counter: Initialization complete"
		call	PR_LogPrint
		add	esp, 4

loc_100091BD:				; CODE XREF: PR_CreateCounter+10j
					; PR_CreateCounter+3Ej
		mov	eax, dword_10030BA0
		push	eax
		call	PR_Lock
		mov	edi, dword_10030BA4
		add	esp, 4
		cmp	edi, ebx
		jz	short loc_10009211

loc_100091D5:				; CODE XREF: PR_CreateCounter+9Dj
		mov	esi, [esp+10h+arg_0]
		mov	ecx, esi
		lea	eax, [edi+10h]
		mov	edi, edi

loc_100091E0:				; CODE XREF: PR_CreateCounter+8Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10009200
		test	dl, dl
		jz	short loc_100091FC
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10009200
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_100091E0

loc_100091FC:				; CODE XREF: PR_CreateCounter+78j
		xor	eax, eax
		jmp	short loc_10009205
; ---------------------------------------------------------------------------

loc_10009200:				; CODE XREF: PR_CreateCounter+74j
					; PR_CreateCounter+80j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10009205:				; CODE XREF: PR_CreateCounter+8Ej
		test	eax, eax
		jz	short loc_10009259
		mov	edi, [edi]
		cmp	edi, ebx
		jnz	short loc_100091D5
		jmp	short loc_10009215
; ---------------------------------------------------------------------------

loc_10009211:				; CODE XREF: PR_CreateCounter+63j
		mov	esi, [esp+10h+arg_0]

loc_10009215:				; CODE XREF: PR_CreateCounter+9Fj
		push	30h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	edi, eax
		lea	eax, [edi+8]
		mov	edx, edi
		add	esp, 8
		mov	[eax], eax
		mov	[edi+0Ch], eax
		mov	[edi], edi
		mov	[edi+4], edi
		mov	eax, esi
		sub	edx, esi

loc_10009236:				; CODE XREF: PR_CreateCounter+CFj
		mov	cl, [eax]
		mov	[edx+eax+10h], cl
		inc	eax
		test	cl, cl
		jnz	short loc_10009236
		mov	[edi], ebx
		mov	edx, dword_10030BA8
		mov	[edi+4], edx
		mov	eax, dword_10030BA8
		mov	[eax], edi
		mov	dword_10030BA8,	edi

loc_10009259:				; CODE XREF: PR_CreateCounter+97j
		mov	eax, [edi+8]
		lea	ebx, [edi+8]
		cmp	eax, ebx
		jz	short loc_10009269

loc_10009263:				; CODE XREF: PR_CreateCounter+F7j
		mov	eax, [eax]
		cmp	eax, ebx
		jnz	short loc_10009263

loc_10009269:				; CODE XREF: PR_CreateCounter+F1j
		push	134h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	ebp, [esp+18h+arg_4]
		mov	esi, eax
		mov	edx, esi
		add	esp, 8
		mov	[esi], esi
		mov	[esi+4], esi
		mov	eax, ebp
		sub	edx, ebp
		lea	esp, [esp+0]

loc_10009290:				; CODE XREF: PR_CreateCounter+129j
		mov	cl, [eax]
		mov	[edx+eax+14h], cl
		inc	eax
		test	cl, cl
		jnz	short loc_10009290
		mov	eax, [esp+10h+arg_8]
		mov	edx, esi
		sub	edx, eax

loc_100092A3:				; CODE XREF: PR_CreateCounter+13Cj
		mov	cl, [eax]
		mov	[edx+eax+34h], cl
		inc	eax
		test	cl, cl
		jnz	short loc_100092A3
		call	PR_NewLock
		mov	edx, dword_10030BA0
		mov	[esi+0Ch], eax
		mov	[esi], ebx
		mov	eax, [edi+0Ch]
		mov	[esi+4], eax
		mov	ecx, [edi+0Ch]
		mov	[ecx], esi
		mov	[edi+0Ch], esi
		push	edx		; lpTlsValue
		mov	[esi+8], edi
		call	PR_Unlock
		mov	eax, dword_10030B9C
		add	esp, 4
		cmp	dword ptr [eax+4], 4
		jl	short loc_100092F8
		mov	ecx, [esp+10h+arg_0]
		push	esi
		push	ebp
		push	edi
		push	ecx
		push	offset aPr_counterCrea ; "PR_Counter: Create: QName: %s	%p, RName"...
		call	PR_LogPrint
		add	esp, 14h

loc_100092F8:				; CODE XREF: PR_CreateCounter+171j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
PR_CreateCounter endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  82. PR_DestroyCounter

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyCounter(void *Memory)
		public PR_DestroyCounter
PR_DestroyCounter proc near		; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		mov	eax, dword_10030B9C
		cmp	dword ptr [eax+4], 4
		push	esi
		mov	esi, [esp+4+Memory]
		push	edi
		mov	edi, [esi+8]
		jl	short loc_10009329
		lea	ecx, [esi+14h]
		push	ecx
		lea	edx, [edi+10h]
		push	edx
		push	offset aPr_counterDele ; "PR_Counter: Deleting:	QName: %s, RName:"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_10009329:				; CODE XREF: PR_DestroyCounter+12j
		mov	eax, dword_10030BA0
		push	eax
		call	PR_Lock
		mov	ecx, dword_10030B9C
		add	esp, 4
		cmp	dword ptr [ecx+4], 4
		jl	short loc_10009355
		push	esi
		lea	edx, [esi+14h]
		push	edx
		push	offset aPr_counterDe_0 ; "PR_Counter: Deleting RName: %s, %p"
		call	PR_LogPrint
		add	esp, 0Ch

loc_10009355:				; CODE XREF: PR_DestroyCounter+41j
		mov	eax, [esi+4]
		mov	ecx, [esi]
		mov	[eax], ecx
		mov	edx, [esi]
		mov	eax, [esi+4]
		mov	[edx+4], eax
		mov	ecx, [esi+0Ch]
		push	ecx		; Memory
		call	PR_Free
		push	esi		; Memory
		call	PR_Free
		lea	eax, [edi+8]
		add	esp, 8
		cmp	[eax], eax
		jnz	short loc_100093B3
		mov	edx, dword_10030B9C
		cmp	dword ptr [edx+4], 4
		jl	short loc_1000939B
		push	edi
		lea	eax, [edi+10h]
		push	eax
		push	offset aPr_counterDe_1 ; "PR_Counter: Deleting unused QName: %s, "...
		call	PR_LogPrint
		add	esp, 0Ch

loc_1000939B:				; CODE XREF: PR_DestroyCounter+87j
		mov	ecx, [edi+4]
		mov	edx, [edi]
		mov	[ecx], edx
		mov	eax, [edi]
		mov	ecx, [edi+4]
		push	edi		; Memory
		mov	[eax+4], ecx
		call	PR_Free
		add	esp, 4

loc_100093B3:				; CODE XREF: PR_DestroyCounter+7Bj
		mov	edx, dword_10030BA0
		pop	edi
		pop	esi
		mov	[esp+Memory], edx ; lpTlsValue
		jmp	PR_Unlock
PR_DestroyCounter endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 144. PR_GetCounterNameFromHandle

; =============== S U B	R O U T	I N E =======================================


		public PR_GetCounterNameFromHandle
PR_GetCounterNameFromHandle proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+8]
		push	ebx
		mov	ebx, [esp+4+arg_C]
		push	esi
		mov	esi, [esp+8+arg_4]
		lea	edx, [ecx+10h]
		mov	[esi], edx
		push	edi
		mov	edi, [esp+0Ch+arg_8]
		lea	esi, [eax+14h]
		mov	[edi], esi
		lea	edi, [eax+34h]
		mov	[ebx], edi
		mov	ebx, dword_10030B9C
		cmp	dword ptr [ebx+4], 4
		jl	short loc_10009413
		push	edi
		push	esi
		push	edx
		push	eax
		push	ecx
		push	offset aPr_counterGetc ; "PR_Counter: GetConterNameFromHandle: QN"...
		call	PR_LogPrint
		add	esp, 18h

loc_10009413:				; CODE XREF: PR_GetCounterNameFromHandle+2Fj
		pop	edi
		pop	esi
		pop	ebx
		retn
PR_GetCounterNameFromHandle endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 213. PR_IncrementCounter

; =============== S U B	R O U T	I N E =======================================


		public PR_IncrementCounter
PR_IncrementCounter proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+0Ch]
		push	eax
		call	PR_Lock
		inc	dword ptr [esi+10h]
		mov	ecx, [esi+0Ch]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		mov	edx, dword_10030B9C
		add	esp, 8
		cmp	dword ptr [edx+4], 4
		jl	short loc_1000945B
		mov	eax, [esi+10h]
		push	eax
		push	esi
		push	offset aPr_counterIncr ; "PR_Counter: Increment: %p, %ld"
		call	PR_LogPrint
		add	esp, 0Ch

loc_1000945B:				; CODE XREF: PR_IncrementCounter+27j
		pop	esi
		retn
PR_IncrementCounter endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  76. PR_DecrementCounter

; =============== S U B	R O U T	I N E =======================================


		public PR_DecrementCounter
PR_DecrementCounter proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+0Ch]
		push	eax
		call	PR_Lock
		dec	dword ptr [esi+10h]
		mov	ecx, [esi+0Ch]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		mov	edx, dword_10030B9C
		add	esp, 8
		cmp	dword ptr [edx+4], 4
		jl	short loc_1000949B
		mov	eax, [esi+10h]
		push	eax
		push	esi
		push	offset aPr_counterDecr ; "PR_Counter: Decrement: %p, %ld"
		call	PR_LogPrint
		add	esp, 0Ch

loc_1000949B:				; CODE XREF: PR_DecrementCounter+27j
		pop	esi
		retn
PR_DecrementCounter endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  16. PR_AddToCounter

; =============== S U B	R O U T	I N E =======================================


		public PR_AddToCounter
PR_AddToCounter	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+0Ch]
		push	eax
		call	PR_Lock
		mov	ecx, [esp+8+arg_4]
		add	[esi+10h], ecx
		mov	edx, [esi+0Ch]
		push	edx		; lpTlsValue
		call	PR_Unlock
		mov	eax, dword_10030B9C
		add	esp, 8
		cmp	dword ptr [eax+4], 4
		jl	short loc_100094DE
		mov	ecx, [esi+10h]
		push	ecx
		push	esi
		push	offset aPr_counterAddt ; "PR_Counter: AddToCounter: %p,	%ld"
		call	PR_LogPrint
		add	esp, 0Ch

loc_100094DE:				; CODE XREF: PR_AddToCounter+2Aj
		pop	esi
		retn
PR_AddToCounter	endp

; Exported entry 352. PR_SubtractFromCounter

; =============== S U B	R O U T	I N E =======================================


		public PR_SubtractFromCounter
PR_SubtractFromCounter proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+0Ch]
		push	eax
		call	PR_Lock
		mov	ecx, [esp+8+arg_4]
		sub	[esi+10h], ecx
		mov	edx, [esi+0Ch]
		push	edx		; lpTlsValue
		call	PR_Unlock
		mov	eax, dword_10030B9C
		add	esp, 8
		cmp	dword ptr [eax+4], 4
		jl	short loc_1000951E
		mov	ecx, [esi+10h]
		push	ecx
		push	esi
		push	offset aPr_counterSubt ; "PR_Counter: SubtractFromCounter: %p, %l"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_1000951E:				; CODE XREF: PR_SubtractFromCounter+2Aj
		pop	esi
		retn
PR_SubtractFromCounter endp

; Exported entry 142. PR_GetCounter

; =============== S U B	R O U T	I N E =======================================


		public PR_GetCounter
PR_GetCounter	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, dword_10030B9C
		cmp	dword ptr [eax+4], 4
		jl	short loc_10009547
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	ecx, [esi+10h]
		push	ecx
		push	esi
		push	offset aPr_counterGe_0 ; "PR_Counter: GetCounter: %p, %ld"
		call	PR_LogPrint
		mov	eax, [esi+10h]
		add	esp, 0Ch
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10009547:				; CODE XREF: PR_GetCounter+9j
		mov	edx, [esp+arg_0]
		mov	eax, [edx+10h]
		retn
PR_GetCounter	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 321. PR_SetCounter

; =============== S U B	R O U T	I N E =======================================


		public PR_SetCounter
PR_SetCounter	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	edx, dword_10030B9C
		mov	[eax+10h], ecx
		cmp	dword ptr [edx+4], 4
		jl	short locret_10009579
		mov	ecx, [eax+10h]
		push	ecx
		push	eax
		push	offset aPr_counterSetc ; "PR_Counter: SetCounter: %p, %ld"
		call	PR_LogPrint
		add	esp, 0Ch

locret_10009579:			; CODE XREF: PR_SetCounter+15j
		retn
PR_SetCounter	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 125. PR_FindNextCounterQname

; =============== S U B	R O U T	I N E =======================================


		public PR_FindNextCounterQname
PR_FindNextCounterQname	proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		push	esi
		mov	esi, dword_10030BA4
		cmp	esi, offset dword_10030BA4
		jnz	short loc_10009597
		xor	esi, esi
		jmp	short loc_100095AB
; ---------------------------------------------------------------------------

loc_10009597:				; CODE XREF: PR_FindNextCounterQname+11j
		test	ecx, ecx
		jz	short loc_100095AB
		mov	eax, [ecx]
		mov	esi, eax
		sub	esi, offset dword_10030BA4
		neg	esi
		sbb	esi, esi
		and	esi, eax

loc_100095AB:				; CODE XREF: PR_FindNextCounterQname+15j
					; PR_FindNextCounterQname+19j
		mov	eax, dword_10030B9C
		cmp	dword ptr [eax+4], 4
		jl	short loc_100095C5
		push	esi
		push	ecx
		push	offset aPr_counterFind ; "PR_Counter: FindNextQname: Handle: %p, "...
		call	PR_LogPrint
		add	esp, 0Ch

loc_100095C5:				; CODE XREF: PR_FindNextCounterQname+34j
		mov	eax, esi
		pop	esi
		retn
PR_FindNextCounterQname	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 126. PR_FindNextCounterRname

; =============== S U B	R O U T	I N E =======================================


		public PR_FindNextCounterRname
PR_FindNextCounterRname	proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	esi, [edi+8]
		lea	eax, [edi+8]
		cmp	esi, eax
		jnz	short loc_100095E8
		xor	esi, esi
		jmp	short loc_100095F8
; ---------------------------------------------------------------------------

loc_100095E8:				; CODE XREF: PR_FindNextCounterRname+12j
		test	edx, edx
		jz	short loc_100095F8
		mov	ecx, [edx]
		mov	esi, ecx
		sub	esi, eax
		neg	esi
		sbb	esi, esi
		and	esi, ecx

loc_100095F8:				; CODE XREF: PR_FindNextCounterRname+16j
					; PR_FindNextCounterRname+1Aj
		mov	eax, dword_10030B9C
		cmp	dword ptr [eax+4], 4
		jl	short loc_10009613
		push	esi
		push	edi
		push	edx
		push	offset aPr_counterFi_0 ; "PR_Counter: FindNextRname: Rhandle: %p,"...
		call	PR_LogPrint
		add	esp, 10h

loc_10009613:				; CODE XREF: PR_FindNextCounterRname+31j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_FindNextCounterRname	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 143. PR_GetCounterHandleFromName

; =============== S U B	R O U T	I N E =======================================


		public PR_GetCounterHandleFromName
PR_GetCounterHandleFromName proc near	; DATA XREF: .rdata:off_1002C7C8o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		mov	eax, dword_10030B9C
		push	ebx
		push	edi
		xor	ebx, ebx
		mov	edi, 4
		mov	[esp+10h+var_4], ebx
		cmp	[eax+4], edi
		jl	short loc_10009651
		mov	ecx, [esp+10h+arg_4]
		mov	edx, [esp+10h+arg_0]
		push	ecx
		push	edx
		push	offset aPr_counterGe_1 ; "PR_Counter: GetCounterHandleFromName:\n"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_10009651:				; CODE XREF: PR_GetCounterHandleFromName+18j
		mov	eax, dword_10030BA4
		push	esi
		mov	esi, eax
		sub	esi, offset dword_10030BA4
		neg	esi
		sbb	esi, esi
		and	esi, eax
		mov	eax, dword_10030B9C
		cmp	[eax+4], edi
		jl	short loc_1000967E
		push	esi
		push	ebx
		push	offset aPr_counterFind ; "PR_Counter: FindNextQname: Handle: %p, "...
		call	PR_LogPrint
		add	esp, 0Ch

loc_1000967E:				; CODE XREF: PR_GetCounterHandleFromName+4Dj
		mov	ecx, esi
		mov	[esp+14h+var_8], ecx
		cmp	esi, ebx
		jz	loc_100097E0
		push	ebp
		jmp	short loc_10009692
; ---------------------------------------------------------------------------
		align 10h

loc_10009690:				; CODE XREF: PR_GetCounterHandleFromName+1AEj
		mov	ecx, esi

loc_10009692:				; CODE XREF: PR_GetCounterHandleFromName+6Dj
		mov	eax, [ecx+8]
		mov	edx, dword_10030B9C
		lea	ebp, [ecx+8]
		mov	esi, eax
		sub	esi, ebp
		neg	esi
		sbb	esi, esi
		and	esi, eax
		cmp	[edx+4], edi
		jl	short loc_100096BE
		push	esi
		push	ecx
		push	0
		push	offset aPr_counterFi_0 ; "PR_Counter: FindNextRname: Rhandle: %p,"...
		call	PR_LogPrint
		add	esp, 10h

loc_100096BE:				; CODE XREF: PR_GetCounterHandleFromName+8Bj
		mov	ebx, esi
		test	esi, esi
		jz	loc_1000979A
		jmp	short loc_100096D0
; ---------------------------------------------------------------------------
		align 10h

loc_100096D0:				; CODE XREF: PR_GetCounterHandleFromName+A8j
					; PR_GetCounterHandleFromName+171j
		mov	ecx, dword_10030B9C
		cmp	dword ptr [ecx+4], 4
		mov	eax, [ebx+8]
		lea	esi, [eax+10h]
		lea	edi, [ebx+14h]
		jl	short loc_100096FA
		lea	edx, [ebx+34h]
		push	edx
		push	edi
		push	esi
		push	ebx
		push	eax
		push	offset aPr_counterGetc ; "PR_Counter: GetConterNameFromHandle: QN"...
		call	PR_LogPrint
		add	esp, 18h

loc_100096FA:				; CODE XREF: PR_GetCounterHandleFromName+C3j
		mov	eax, [esp+18h+arg_0]
		mov	ecx, esi

loc_10009700:				; CODE XREF: PR_GetCounterHandleFromName+FAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10009720
		test	dl, dl
		jz	short loc_1000971C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10009720
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10009700

loc_1000971C:				; CODE XREF: PR_GetCounterHandleFromName+E8j
		xor	eax, eax
		jmp	short loc_10009725
; ---------------------------------------------------------------------------

loc_10009720:				; CODE XREF: PR_GetCounterHandleFromName+E4j
					; PR_GetCounterHandleFromName+F0j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10009725:				; CODE XREF: PR_GetCounterHandleFromName+FEj
		test	eax, eax
		jnz	short loc_10009759
		mov	eax, [esp+18h+arg_4]
		mov	ecx, edi
		nop

loc_10009730:				; CODE XREF: PR_GetCounterHandleFromName+12Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10009750
		test	dl, dl
		jz	short loc_1000974C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10009750
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10009730

loc_1000974C:				; CODE XREF: PR_GetCounterHandleFromName+118j
		xor	eax, eax
		jmp	short loc_10009755
; ---------------------------------------------------------------------------

loc_10009750:				; CODE XREF: PR_GetCounterHandleFromName+114j
					; PR_GetCounterHandleFromName+120j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10009755:				; CODE XREF: PR_GetCounterHandleFromName+12Ej
		test	eax, eax
		jz	short loc_100097D6

loc_10009759:				; CODE XREF: PR_GetCounterHandleFromName+107j
		cmp	[ebp+0], ebp
		jnz	short loc_10009762
		xor	esi, esi
		jmp	short loc_1000976E
; ---------------------------------------------------------------------------

loc_10009762:				; CODE XREF: PR_GetCounterHandleFromName+13Cj
		mov	eax, [ebx]
		mov	esi, eax
		sub	esi, ebp
		neg	esi
		sbb	esi, esi
		and	esi, eax

loc_1000976E:				; CODE XREF: PR_GetCounterHandleFromName+140j
		mov	eax, dword_10030B9C
		cmp	dword ptr [eax+4], 4
		jl	short loc_1000978D
		mov	ecx, [esp+18h+var_8]
		push	esi
		push	ecx
		push	ebx
		push	offset aPr_counterFi_0 ; "PR_Counter: FindNextRname: Rhandle: %p,"...
		call	PR_LogPrint
		add	esp, 10h

loc_1000978D:				; CODE XREF: PR_GetCounterHandleFromName+157j
		mov	ebx, esi
		test	esi, esi
		jnz	loc_100096D0
		lea	edi, [esi+4]

loc_1000979A:				; CODE XREF: PR_GetCounterHandleFromName+A2j
		mov	eax, dword_10030BA4
		mov	edx, dword_10030B9C
		mov	esi, eax
		sub	esi, offset dword_10030BA4
		neg	esi
		sbb	esi, esi
		and	esi, eax
		cmp	[edx+4], edi
		jl	short loc_100097C8
		push	esi
		push	0
		push	offset aPr_counterFind ; "PR_Counter: FindNextQname: Handle: %p, "...
		call	PR_LogPrint
		add	esp, 0Ch

loc_100097C8:				; CODE XREF: PR_GetCounterHandleFromName+196j
		mov	[esp+18h+var_8], esi
		test	esi, esi
		jnz	loc_10009690
		jmp	short loc_100097DF
; ---------------------------------------------------------------------------

loc_100097D6:				; CODE XREF: PR_GetCounterHandleFromName+137j
		mov	[esp+18h+var_4], ebx
		mov	edi, 4

loc_100097DF:				; CODE XREF: PR_GetCounterHandleFromName+1B4j
		pop	ebp

loc_100097E0:				; CODE XREF: PR_GetCounterHandleFromName+66j
		mov	eax, dword_10030B9C
		pop	esi
		cmp	[eax+4], edi
		jl	short loc_100097FD
		mov	ecx, [esp+10h+var_4]
		push	ecx
		push	offset aPr_counterGe_2 ; "PR_Counter: GetConterHandleFromName: %p"
		call	PR_LogPrint
		add	esp, 8

loc_100097FD:				; CODE XREF: PR_GetCounterHandleFromName+1C9j
		pop	edi
		mov	eax, ebx
		pop	ebx
		add	esp, 8
		retn
PR_GetCounterHandleFromName endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009810	proc near		; CODE XREF: PR_Init_0+143p
		call	PR_NewLock
		mov	dword_10030BB0,	eax
		call	PR_NewLock
		mov	dword_10030BB4,	eax
		retn
sub_10009810	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009830	proc near		; CODE XREF: PR_Cleanup+AFp
		mov	eax, dword_10030BB0
		push	eax		; Memory
		call	PR_DestroyLock
		mov	ecx, dword_10030BB4
		push	ecx		; Memory
		mov	dword_10030BB0,	0
		call	PR_DestroyLock
		add	esp, 8
		mov	dword_10030BB4,	0
		retn
sub_10009830	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009860	proc near		; CODE XREF: sub_10009960+53p
					; sub_10009A00:loc_10009A37p ...
		mov	eax, dword_10030BB0
		push	esi
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	ebx, 7
		jg	short loc_1000988A
		mov	esi, dword_10030BBC[ebx*4]
		test	esi, esi
		jz	short loc_1000988A
		mov	ecx, [esi]
		mov	dword_10030BBC[ebx*4], ecx
		jmp	short loc_100098E2
; ---------------------------------------------------------------------------

loc_1000988A:				; CODE XREF: sub_10009860+12j
					; sub_10009860+1Dj
		push	edi
		mov	edi, 1
		mov	ecx, ebx
		shl	edi, cl
		lea	eax, ds:1Bh[edi*4]
		shr	eax, 3
		cmp	ebx, 7
		jg	short loc_100098C8
		mov	esi, off_10030290
		mov	edx, esi
		sub	edx, offset dword_10030BE0
		sar	edx, 3
		add	edx, eax
		cmp	edx, 120h
		ja	short loc_100098C8
		lea	eax, [esi+eax*8]
		mov	off_10030290, eax
		jmp	short loc_100098DB
; ---------------------------------------------------------------------------

loc_100098C8:				; CODE XREF: sub_10009860+41j
					; sub_10009860+5Cj
		lea	ecx, ds:0[eax*8]
		push	ecx		; Size
		call	ds:malloc
		add	esp, 4
		mov	esi, eax

loc_100098DB:				; CODE XREF: sub_10009860+66j
		mov	[esi+8], edi
		mov	[esi+4], ebx
		pop	edi

loc_100098E2:				; CODE XREF: sub_10009860+28j
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	dword ptr [esi+10h], 0
		mov	dword ptr [esi+0Ch], 0
		mov	eax, esi
		pop	esi
		retn
sub_10009860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009910	proc near		; CODE XREF: sub_10009960+75p
					; sub_1000B720+7B7p ...
		test	esi, esi
		jz	short locret_10009952
		cmp	dword ptr [esi+4], 7
		jle	short loc_10009925
		push	esi		; Memory
		call	ds:free
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_10009925:				; CODE XREF: sub_10009910+8j
		mov	eax, dword_10030BB0
		push	eax
		call	PR_Lock
		mov	eax, [esi+4]
		mov	ecx, dword_10030BBC[eax*4]
		mov	[esi], ecx
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		mov	dword_10030BBC[eax*4], esi
		call	PR_Unlock
		add	esp, 8

locret_10009952:			; CODE XREF: sub_10009910+2j
		retn
sub_10009910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009960	proc near		; CODE XREF: sub_10009A00+61p
					; sub_10009A00+8Dp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	ebx
		push	ebp
		mov	ebp, [edx+10h]
		push	esi
		push	edi
		add	edx, 14h
		mov	esi, eax
		xor	ebx, ebx
		mov	edi, ecx

loc_10009974:				; CODE XREF: sub_10009960+40j
		mov	eax, [edx]
		movzx	ecx, ax
		imul	ecx, esi
		shr	eax, 10h
		imul	eax, esi
		add	ecx, edi
		mov	edi, ecx
		shr	edi, 10h
		add	eax, edi
		mov	edi, eax
		movzx	ecx, cx
		shl	eax, 10h
		add	eax, ecx
		mov	[edx], eax
		inc	ebx
		shr	edi, 10h
		add	edx, 4
		cmp	ebx, ebp
		jl	short loc_10009974
		test	edi, edi
		jz	short loc_100099EB
		mov	esi, [esp+10h+arg_0]
		cmp	ebp, [esi+8]
		jl	short loc_100099DC
		mov	ebx, [esi+4]
		inc	ebx
		call	sub_10009860
		mov	edx, [esi+10h]
		mov	ebx, eax
		lea	eax, ds:8[edx*4]
		push	eax		; Size
		lea	ecx, [esi+0Ch]
		push	ecx		; Src
		lea	edx, [ebx+0Ch]
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch
		call	sub_10009910
		mov	esi, ebx

loc_100099DC:				; CODE XREF: sub_10009960+4Dj
		mov	[esi+ebp*4+14h], edi
		inc	ebp
		pop	edi
		mov	[esi+10h], ebp
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100099EB:				; CODE XREF: sub_10009960+44j
		mov	eax, [esp+10h+arg_0]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10009960	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009A00	proc near		; CODE XREF: PR_strtod+522p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_4]
		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		mov	esi, eax
		add	ecx, 8
		mov	eax, 38E38E39h
		imul	ecx
		sar	edx, 1
		mov	eax, edx
		shr	eax, 1Fh
		xor	ebx, ebx
		add	eax, edx
		lea	ecx, [ebx+1]
		push	edi
		cmp	eax, ecx
		jle	short loc_10009A37
		lea	ebx, [ebx+0]

loc_10009A30:				; CODE XREF: sub_10009A00+35j
		add	ecx, ecx
		inc	ebx
		cmp	eax, ecx
		jg	short loc_10009A30

loc_10009A37:				; CODE XREF: sub_10009A00+28j
		call	sub_10009860
		mov	ecx, [esp+10h+arg_8]
		mov	edi, 9
		mov	[eax+14h], ecx
		mov	dword ptr [eax+10h], 1
		cmp	ebp, edi
		jle	short loc_10009A72
		add	esi, edi

loc_10009A55:				; CODE XREF: sub_10009A00+6Dj
		movsx	ecx, byte ptr [esi]
		push	eax
		sub	ecx, 30h
		mov	eax, 0Ah
		call	sub_10009960
		inc	edi
		add	esp, 4
		inc	esi
		cmp	edi, ebp
		jl	short loc_10009A55
		inc	esi
		jmp	short loc_10009A75
; ---------------------------------------------------------------------------

loc_10009A72:				; CODE XREF: sub_10009A00+51j
		add	esi, 0Ah

loc_10009A75:				; CODE XREF: sub_10009A00+70j
		mov	ecx, [esp+10h+arg_4]
		cmp	edi, ecx
		jge	short loc_10009A99
		sub	ecx, edi
		mov	edi, ecx

loc_10009A81:				; CODE XREF: sub_10009A00+97j
		movsx	ecx, byte ptr [esi]
		push	eax
		sub	ecx, 30h
		mov	eax, 0Ah
		call	sub_10009960
		add	esp, 4
		inc	esi
		dec	edi
		jnz	short loc_10009A81

loc_10009A99:				; CODE XREF: sub_10009A00+7Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10009A00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009AA0	proc near		; CODE XREF: sub_1000A350+157p
					; sub_1000B720+853p
		xor	eax, eax
		test	ecx, 0FFFF0000h
		jnz	short loc_10009AB2
		mov	eax, 10h
		shl	ecx, 10h

loc_10009AB2:				; CODE XREF: sub_10009AA0+8j
		test	ecx, 0FF000000h
		jnz	short loc_10009AC0
		add	eax, 8
		shl	ecx, 8

loc_10009AC0:				; CODE XREF: sub_10009AA0+18j
		test	ecx, 0F0000000h
		jnz	short loc_10009ACE
		add	eax, 4
		shl	ecx, 4

loc_10009ACE:				; CODE XREF: sub_10009AA0+26j
		test	ecx, 0C0000000h
		jnz	short loc_10009ADD
		add	ecx, ecx
		add	eax, 2
		add	ecx, ecx

loc_10009ADD:				; CODE XREF: sub_10009AA0+34j
		test	ecx, ecx
		js	short locret_10009AEF
		inc	eax
		test	ecx, 40000000h
		jnz	short locret_10009AEF
		mov	eax, 20h

locret_10009AEF:			; CODE XREF: sub_10009AA0+3Fj
					; sub_10009AA0+48j
		retn
sub_10009AA0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009AF0	proc near		; CODE XREF: sub_1000A350+BEp
					; sub_1000A350+108p
		mov	ecx, [edx]
		test	cl, 7
		jz	short loc_10009B19
		test	cl, 1
		jz	short loc_10009AFF
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10009AFF:				; CODE XREF: sub_10009AF0+Aj
		test	cl, 2
		jz	short loc_10009B0E
		shr	ecx, 1
		mov	eax, 1

loc_10009B0B:				; CODE XREF: sub_10009AF0+5Dj
					; sub_10009AF0+62j
		mov	[edx], ecx
		retn
; ---------------------------------------------------------------------------

loc_10009B0E:				; CODE XREF: sub_10009AF0+12j
		shr	ecx, 2
		mov	eax, 2
		mov	[edx], ecx
		retn
; ---------------------------------------------------------------------------

loc_10009B19:				; CODE XREF: sub_10009AF0+5j
		push	esi
		xor	eax, eax
		pop	esi
		test	cx, cx
		jnz	short loc_10009B2A
		mov	eax, 10h
		shr	ecx, 10h

loc_10009B2A:				; CODE XREF: sub_10009AF0+30j
		test	cl, cl
		jnz	short loc_10009B34
		add	eax, 8
		shr	ecx, 8

loc_10009B34:				; CODE XREF: sub_10009AF0+3Cj
		test	cl, 0Fh
		jnz	short loc_10009B3F
		add	eax, 4
		shr	ecx, 4

loc_10009B3F:				; CODE XREF: sub_10009AF0+47j
		test	cl, 3
		jnz	short loc_10009B4A
		add	eax, 2
		shr	ecx, 2

loc_10009B4A:				; CODE XREF: sub_10009AF0+52j
		test	cl, 1
		jnz	short loc_10009B0B
		inc	eax
		shr	ecx, 1
		jnz	short loc_10009B0B
		mov	eax, 20h
		retn
sub_10009AF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009B60	proc near		; CODE XREF: sub_10009D90+55p
					; PR_strtod+57Cp ...

arg_0		= dword	ptr  4

		mov	eax, dword_10030BB0
		push	esi
		push	eax
		call	PR_Lock
		mov	esi, dword_10030BC0
		add	esp, 4
		test	esi, esi
		jz	short loc_10009B83
		mov	ecx, [esi]
		mov	dword_10030BC0,	ecx
		jmp	short loc_10009BC5
; ---------------------------------------------------------------------------

loc_10009B83:				; CODE XREF: sub_10009B60+17j
		mov	eax, off_10030290
		mov	edx, eax
		sub	edx, offset dword_10030BE0
		sar	edx, 3
		add	edx, 4
		cmp	edx, 120h
		ja	short loc_10009BAA
		mov	esi, eax
		add	eax, 20h
		mov	off_10030290, eax
		jmp	short loc_10009BB7
; ---------------------------------------------------------------------------

loc_10009BAA:				; CODE XREF: sub_10009B60+3Cj
		push	20h		; Size
		call	ds:malloc
		add	esp, 4
		mov	esi, eax

loc_10009BB7:				; CODE XREF: sub_10009B60+48j
		mov	dword ptr [esi+4], 1
		mov	dword ptr [esi+8], 2

loc_10009BC5:				; CODE XREF: sub_10009B60+21j
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	ecx, [esp+8+arg_0]
		add	esp, 4
		mov	dword ptr [esi+0Ch], 0
		mov	[esi+14h], ecx
		mov	dword ptr [esi+10h], 1
		mov	eax, esi
		pop	esi
		retn
sub_10009B60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009BF0	proc near		; CODE XREF: sub_10009D90+88p
					; sub_10009D90+FAp ...

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		push	ebx
		push	ebp
		mov	ebp, [esp+24h+arg_0]
		push	esi
		mov	esi, eax
		mov	eax, [esi+10h]
		push	edi
		cmp	eax, [ebp+10h]
		jge	short loc_10009C0B
		mov	eax, esi
		mov	esi, ebp
		mov	ebp, eax

loc_10009C0B:				; CODE XREF: sub_10009BF0+13j
		mov	edi, [ebp+10h]
		mov	eax, [esi+10h]
		mov	ebx, [esi+4]
		mov	[esp+2Ch+var_14], edi
		add	edi, eax
		mov	[esp+2Ch+var_10], eax
		mov	[esp+2Ch+var_8], edi
		cmp	edi, [esi+8]
		jle	short loc_10009C28
		inc	ebx

loc_10009C28:				; CODE XREF: sub_10009BF0+35j
		call	sub_10009860
		lea	ebx, [eax+14h]
		lea	ecx, [ebx+edi*4]
		mov	[esp+2Ch+arg_0], eax
		cmp	ebx, ecx
		jnb	short loc_10009C4C
		sub	ecx, ebx
		dec	ecx
		shr	ecx, 2
		inc	ecx
		xor	eax, eax
		mov	edi, ebx
		rep stosd
		mov	edi, [esp+2Ch+var_8]

loc_10009C4C:				; CODE XREF: sub_10009BF0+49j
		mov	ecx, [esp+2Ch+var_10]
		lea	edx, [esi+14h]
		lea	eax, [edx+ecx*4]
		mov	ecx, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_10], eax
		lea	eax, [ebp+14h]
		lea	esi, [eax+ecx*4]
		mov	ecx, ebx
		mov	[esp+2Ch+var_4], esi
		cmp	eax, esi
		mov	esi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_C], edx
		mov	[esp+2Ch+var_1C], ecx
		jnb	loc_10009D66
		mov	eax, ecx
		sub	eax, esi
		add	eax, ebp
		mov	[esp+2Ch+var_18], eax

loc_10009C88:				; CODE XREF: sub_10009BF0+16Cj
		movzx	ebx, word ptr [eax]
		test	ebx, ebx
		jz	short loc_10009CF4
		mov	edi, edx
		mov	[esp+2Ch+var_14], 0
		sub	edi, ecx
		jmp	short loc_10009CA0
; ---------------------------------------------------------------------------
		align 10h

loc_10009CA0:				; CODE XREF: sub_10009BF0+ABj
					; sub_10009BF0+F0j
		mov	eax, [edi+ecx]
		mov	edx, [ecx]
		movzx	ebp, ax
		shr	eax, 10h
		imul	ebp, ebx
		add	ebp, [esp+2Ch+var_14]
		imul	eax, ebx
		movzx	esi, dx
		shr	edx, 10h
		add	eax, edx
		add	esi, ebp
		mov	edx, esi
		shr	edx, 10h
		add	eax, edx
		mov	[ecx+2], ax
		mov	[ecx], si
		add	ecx, 4
		mov	edx, eax
		shr	edx, 10h
		lea	eax, [edi+ecx]
		mov	[esp+2Ch+var_14], edx
		cmp	eax, [esp+2Ch+var_10]
		jb	short loc_10009CA0
		mov	eax, [esp+2Ch+var_18]
		mov	esi, [esp+2Ch+arg_0]
		mov	[ecx], edx
		mov	edx, [esp+2Ch+var_C]
		mov	ecx, [esp+2Ch+var_1C]

loc_10009CF4:				; CODE XREF: sub_10009BF0+9Dj
		movzx	edi, word ptr [eax+2]
		test	edi, edi
		jz	short loc_10009D4A
		mov	esi, [ecx]
		xor	ebx, ebx

loc_10009D00:				; CODE XREF: sub_10009BF0+146j
		movzx	ebp, word ptr [edx]
		movzx	eax, word ptr [ecx+2]
		imul	ebp, edi
		add	ebp, ebx
		mov	[ecx], si
		add	eax, ebp
		mov	[ecx+2], ax
		movzx	esi, word ptr [edx+2]
		movzx	ebx, word ptr [ecx+4]
		imul	esi, edi
		add	ecx, 4
		add	esi, ebx
		shr	eax, 10h
		add	esi, eax
		mov	ebx, esi
		add	edx, 4
		shr	ebx, 10h
		cmp	edx, [esp+2Ch+var_10]
		jb	short loc_10009D00
		mov	edx, [esp+2Ch+var_C]
		mov	eax, [esp+2Ch+var_18]
		mov	[ecx], esi
		mov	ecx, [esp+2Ch+var_1C]
		mov	esi, [esp+2Ch+arg_0]

loc_10009D4A:				; CODE XREF: sub_10009BF0+10Aj
		add	eax, 4
		add	ecx, 4
		mov	[esp+2Ch+var_1C], ecx
		mov	[esp+2Ch+var_18], eax
		cmp	eax, [esp+2Ch+var_4]
		jb	loc_10009C88
		mov	edi, [esp+2Ch+var_8]

loc_10009D66:				; CODE XREF: sub_10009BF0+88j
		lea	eax, [esi+edi*4+14h]
		test	edi, edi
		jle	short loc_10009D7D
		mov	edi, edi

loc_10009D70:				; CODE XREF: sub_10009BF0+18Bj
		sub	eax, 4
		cmp	dword ptr [eax], 0
		jnz	short loc_10009D7D
		dec	edi
		test	edi, edi
		jg	short loc_10009D70

loc_10009D7D:				; CODE XREF: sub_10009BF0+17Cj
					; sub_10009BF0+186j
		mov	[esi+10h], edi
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
sub_10009BF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10009D90(void	*Memory)
sub_10009D90	proc near		; CODE XREF: PR_strtod+614p
					; PR_strtod+6A1p ...

Memory		= dword	ptr  4

		push	ebx
		mov	ebx, eax
		and	eax, 3
		push	ebp
		mov	ebp, [esp+8+Memory]
		jz	short loc_10009DB1
		mov	eax, off_10030290[eax*4]
		push	ebp
		xor	ecx, ecx
		call	sub_10009960
		add	esp, 4
		mov	ebp, eax

loc_10009DB1:				; CODE XREF: sub_10009D90+Bj
		sar	ebx, 2
		test	ebx, ebx
		jz	loc_10009EB4
		push	esi
		mov	esi, dword_10030BB8
		push	edi
		test	esi, esi
		jnz	short loc_10009E10
		mov	eax, dword_10030BB4
		push	eax
		call	PR_Lock
		mov	esi, dword_10030BB8
		add	esp, 4
		test	esi, esi
		jnz	short loc_10009DFA
		push	271h
		call	sub_10009B60
		add	esp, 4
		mov	dword_10030BB8,	eax
		mov	esi, eax
		mov	dword ptr [eax], 0

loc_10009DFA:				; CODE XREF: sub_10009D90+4Ej
		mov	ecx, dword_10030BB4
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		lea	esp, [esp+0]

loc_10009E10:				; CODE XREF: sub_10009D90+36j
					; sub_10009D90+11Dj
		test	bl, 1
		jz	short loc_10009E69
		push	esi
		mov	eax, ebp
		call	sub_10009BF0
		add	esp, 4
		mov	edi, eax
		test	ebp, ebp
		jz	short loc_10009E67
		cmp	dword ptr [ebp+4], 7
		jle	short loc_10009E38
		push	ebp		; Memory
		call	ds:free
		add	esp, 4
		jmp	short loc_10009E67
; ---------------------------------------------------------------------------

loc_10009E38:				; CODE XREF: sub_10009D90+9Aj
		mov	edx, dword_10030BB0
		push	edx
		call	PR_Lock
		mov	eax, [ebp+4]
		mov	ecx, dword_10030BBC[eax*4]
		mov	[ebp+0], ecx
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		mov	dword_10030BBC[eax*4], ebp
		call	PR_Unlock
		add	esp, 8

loc_10009E67:				; CODE XREF: sub_10009D90+94j
					; sub_10009D90+A6j
		mov	ebp, edi

loc_10009E69:				; CODE XREF: sub_10009D90+83j
		sar	ebx, 1
		jz	short loc_10009EB2
		mov	edi, [esi]
		test	edi, edi
		jnz	short loc_10009EAB
		mov	eax, dword_10030BB4
		push	eax
		call	PR_Lock
		mov	edi, [esi]
		add	esp, 4
		test	edi, edi
		jnz	short loc_10009E9C
		push	esi
		mov	eax, esi
		call	sub_10009BF0
		mov	edi, eax
		mov	[esi], eax
		add	esp, 4
		mov	dword ptr [edi], 0

loc_10009E9C:				; CODE XREF: sub_10009D90+F5j
		mov	ecx, dword_10030BB4
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_10009EAB:				; CODE XREF: sub_10009D90+E1j
		mov	esi, edi
		jmp	loc_10009E10
; ---------------------------------------------------------------------------

loc_10009EB2:				; CODE XREF: sub_10009D90+DBj
		pop	edi
		pop	esi

loc_10009EB4:				; CODE XREF: sub_10009D90+26j
		mov	eax, ebp
		pop	ebp
		pop	ebx
		retn
sub_10009D90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10009EC0(void	*Memory, int)
sub_10009EC0	proc near		; CODE XREF: PR_strtod+688p
					; PR_strtod+6B7p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
Memory		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		push	ebx
		push	ebp
		mov	ebp, [esp+10h+Memory]
		mov	eax, [ebp+10h]
		mov	ebx, [ebp+4]
		push	esi
		mov	esi, [esp+14h+arg_4]
		sar	esi, 5
		push	edi
		lea	edi, [esi+eax+1]
		mov	eax, [ebp+8]
		mov	[esp+18h+var_8], edi
		cmp	edi, eax
		jle	short loc_10009EEE

loc_10009EE7:				; CODE XREF: sub_10009EC0+2Cj
		add	eax, eax
		inc	ebx
		cmp	edi, eax
		jg	short loc_10009EE7

loc_10009EEE:				; CODE XREF: sub_10009EC0+25j
		call	sub_10009860
		mov	[esp+18h+var_4], eax
		lea	edx, [eax+14h]
		test	esi, esi
		jle	short loc_10009F0D
		mov	edi, edx
		mov	ecx, esi
		xor	eax, eax
		rep stosd
		mov	edi, [esp+18h+var_8]
		lea	edx, [edx+esi*4]

loc_10009F0D:				; CODE XREF: sub_10009EC0+3Cj
		and	[esp+18h+arg_4], 1Fh
		mov	ecx, [ebp+10h]
		lea	eax, [ebp+14h]
		lea	ebx, [eax+ecx*4]
		jz	short loc_10009F80
		mov	edi, 20h
		sub	edi, [esp+18h+arg_4]
		xor	esi, esi

loc_10009F28:				; CODE XREF: sub_10009EC0+84j
		mov	ebp, [eax]
		mov	ecx, [esp+18h+arg_4]
		shl	ebp, cl
		mov	ecx, edi
		add	eax, 4
		add	edx, 4
		or	ebp, esi
		mov	[edx-4], ebp
		mov	esi, [eax-4]
		shr	esi, cl
		cmp	eax, ebx
		jb	short loc_10009F28
		mov	ebp, [esp+18h+Memory]
		mov	[edx], esi
		test	esi, esi
		jz	short loc_10009F54
		inc	[esp+18h+var_8]

loc_10009F54:				; CODE XREF: sub_10009EC0+8Ej
		mov	edi, [esp+18h+var_8]

loc_10009F58:				; CODE XREF: sub_10009EC0+CEj
		mov	esi, [esp+18h+var_4]
		dec	edi
		mov	[esi+10h], edi
		cmp	dword ptr [ebp+4], 7
		jle	short loc_10009F90
		push	ebp		; Memory
		call	ds:free
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10009F80:				; CODE XREF: sub_10009EC0+5Bj
					; sub_10009EC0+CCj
		mov	ecx, [eax]
		mov	[edx], ecx
		add	eax, 4
		add	edx, 4
		cmp	eax, ebx
		jb	short loc_10009F80
		jmp	short loc_10009F58
; ---------------------------------------------------------------------------

loc_10009F90:				; CODE XREF: sub_10009EC0+A4j
		mov	edx, dword_10030BB0
		push	edx
		call	PR_Lock
		mov	eax, [ebp+4]
		mov	ecx, dword_10030BBC[eax*4]
		mov	[ebp+0], ecx
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		mov	dword_10030BBC[eax*4], ebp
		call	PR_Unlock
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_10009EC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10009FD0	proc near		; CODE XREF: PR_strtod+BD8p
					; sub_1000B440+101p ...
		push	esi
		mov	esi, eax
		mov	ecx, [esi+10h]
		mov	eax, [edx+10h]
		sub	eax, ecx
		jnz	short loc_1000A00F
		add	edx, 14h
		lea	eax, [edx+ecx*4-4]
		lea	ecx, [esi+ecx*4+10h]
		mov	esi, [eax]
		cmp	esi, [ecx]
		jnz	short loc_1000A001
		mov	edi, edi

loc_10009FF0:				; CODE XREF: sub_10009FD0+2Fj
		cmp	eax, edx
		jbe	short loc_1000A00D
		mov	esi, [eax-4]
		sub	eax, 4
		sub	ecx, 4
		cmp	esi, [ecx]
		jz	short loc_10009FF0

loc_1000A001:				; CODE XREF: sub_10009FD0+1Cj
		mov	eax, [eax]
		cmp	eax, [ecx]
		pop	esi
		sbb	eax, eax
		and	eax, 0FFFFFFFEh
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A00D:				; CODE XREF: sub_10009FD0+22j
		xor	eax, eax

loc_1000A00F:				; CODE XREF: sub_10009FD0+Bj
		pop	esi
		retn
sub_10009FD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A020	proc near		; CODE XREF: PR_strtod+6E5p
					; sub_1000B720+A1Fp

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	esi, eax
		push	edi
		mov	edi, ecx
		mov	ecx, [esi+10h]
		mov	eax, [edi+10h]
		sub	eax, ecx
		mov	ebp, 1
		jnz	short loc_1000A06C
		lea	edx, [edi+14h]
		mov	ebx, [edx+ecx*4-4]
		cmp	ebx, [esi+ecx*4+10h]
		lea	eax, [edx+ecx*4-4]
		lea	ecx, [esi+ecx*4+10h]
		jnz	short loc_1000A061
		nop

loc_1000A050:				; CODE XREF: sub_1000A020+3Fj
		cmp	eax, edx
		jbe	short loc_1000A083
		mov	ebx, [eax-4]
		sub	eax, 4
		sub	ecx, 4
		cmp	ebx, [ecx]
		jz	short loc_1000A050

loc_1000A061:				; CODE XREF: sub_1000A020+2Dj
		mov	eax, [eax]
		cmp	eax, [ecx]
		sbb	eax, eax
		and	eax, 0FFFFFFFEh
		add	eax, ebp

loc_1000A06C:				; CODE XREF: sub_1000A020+18j
		xor	ebx, ebx
		cmp	eax, ebx
		jz	short loc_1000A085
		jge	loc_1000A104
		mov	eax, edi
		mov	edi, esi
		mov	esi, eax
		jmp	loc_1000A106
; ---------------------------------------------------------------------------

loc_1000A083:				; CODE XREF: sub_1000A020+32j
		xor	ebx, ebx

loc_1000A085:				; CODE XREF: sub_1000A020+50j
		mov	ecx, dword_10030BB0
		push	ecx
		call	PR_Lock
		mov	esi, dword_10030BBC
		add	esp, 4
		cmp	esi, ebx
		jz	short loc_1000A0A8
		mov	edx, [esi]
		mov	dword_10030BBC,	edx
		jmp	short loc_1000A0E2
; ---------------------------------------------------------------------------

loc_1000A0A8:				; CODE XREF: sub_1000A020+7Cj
		mov	eax, off_10030290
		mov	ecx, eax
		sub	ecx, offset dword_10030BE0
		sar	ecx, 3
		add	ecx, 3
		cmp	ecx, 120h
		ja	short loc_1000A0CF
		mov	esi, eax
		add	eax, 18h
		mov	off_10030290, eax
		jmp	short loc_1000A0DC
; ---------------------------------------------------------------------------

loc_1000A0CF:				; CODE XREF: sub_1000A020+A1j
		push	18h		; Size
		call	ds:malloc
		add	esp, 4
		mov	esi, eax

loc_1000A0DC:				; CODE XREF: sub_1000A020+ADj
		mov	[esi+4], ebx
		mov	[esi+8], ebp

loc_1000A0E2:				; CODE XREF: sub_1000A020+86j
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		mov	[esi+0Ch], ebx
		mov	[esi+10h], ebp
		mov	[esi+14h], ebx
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000A104:				; CODE XREF: sub_1000A020+52j
		xor	ebp, ebp

loc_1000A106:				; CODE XREF: sub_1000A020+5Ej
		mov	ebx, [edi+4]
		call	sub_10009860
		mov	[eax+0Ch], ebp
		mov	ecx, [edi+10h]
		mov	edx, [esi+10h]
		mov	[esp+24h+var_10], ecx
		add	edi, 14h
		lea	ecx, [edi+ecx*4]
		mov	[esp+24h+var_8], ecx
		lea	ecx, [esi+edx*4+14h]
		mov	[esp+24h+var_C], ecx
		lea	ecx, [eax+14h]
		mov	ebx, ecx
		sub	ebx, eax
		mov	[esp+24h+var_4], eax
		mov	[esp+24h+var_14], 0
		add	ebx, esi

loc_1000A142:				; CODE XREF: sub_1000A020+164j
		mov	edx, [edi]
		mov	eax, [ebx]
		movzx	esi, dx
		movzx	ebp, ax
		sub	esi, ebp
		sub	esi, [esp+24h+var_14]
		shr	edx, 10h
		mov	ebp, esi
		shr	ebp, 10h
		and	ebp, 1
		sub	edx, ebp
		shr	eax, 10h
		sub	edx, eax
		mov	ebp, edx
		shr	ebp, 10h
		and	ebp, 1
		mov	[ecx+2], dx
		mov	[ecx], si
		add	ebx, 4
		add	edi, 4
		add	ecx, 4
		mov	[esp+24h+var_14], ebp
		cmp	ebx, [esp+24h+var_C]
		jb	short loc_1000A142
		mov	esi, [esp+24h+var_8]
		cmp	edi, esi
		jnb	short loc_1000A1BD
		mov	edi, edi

loc_1000A190:				; CODE XREF: sub_1000A020+19Bj
		mov	eax, [edi]
		movzx	edx, ax
		sub	edx, ebp
		mov	ebx, edx
		shr	ebx, 10h
		and	ebx, 1
		shr	eax, 10h
		sub	eax, ebx
		mov	ebp, eax
		shr	ebp, 10h
		add	edi, 4
		mov	[ecx+2], ax
		mov	[ecx], dx
		and	ebp, 1
		add	ecx, 4
		cmp	edi, esi
		jb	short loc_1000A190

loc_1000A1BD:				; CODE XREF: sub_1000A020+16Cj
		mov	edx, [esp+24h+var_10]
		sub	ecx, 4
		cmp	dword ptr [ecx], 0
		jnz	short loc_1000A1D9
		lea	esp, [esp+0]

loc_1000A1D0:				; CODE XREF: sub_1000A020+1B7j
		sub	ecx, 4
		dec	edx
		cmp	dword ptr [ecx], 0
		jz	short loc_1000A1D0

loc_1000A1D9:				; CODE XREF: sub_1000A020+1A7j
		mov	eax, [esp+24h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax+10h], edx
		pop	ebx
		add	esp, 14h
		retn
sub_1000A020	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000A1F0	proc near		; CODE XREF: PR_strtod+758p
					; PR_strtod+76Ep

var_C		= dword	ptr -0Ch
var_8		= qword	ptr -8
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	ebx
		lea	ebx, [eax+14h]
		mov	eax, [eax+10h]
		push	ebp
		push	esi
		lea	esi, [ebx+eax*4-4]
		mov	eax, [esi]
		xor	edx, edx
		push	edi
		mov	[esp+1Ch+var_C], ebx
		mov	ecx, eax
		test	eax, 0FFFF0000h
		jnz	short loc_1000A21A
		mov	edx, 10h
		shl	ecx, 10h

loc_1000A21A:				; CODE XREF: sub_1000A1F0+20j
		test	ecx, 0FF000000h
		jnz	short loc_1000A228
		add	edx, 8
		shl	ecx, 8

loc_1000A228:				; CODE XREF: sub_1000A1F0+30j
		test	ecx, 0F0000000h
		jnz	short loc_1000A236
		add	edx, 4
		shl	ecx, 4

loc_1000A236:				; CODE XREF: sub_1000A1F0+3Ej
		test	ecx, 0C0000000h
		jnz	short loc_1000A245
		add	ecx, ecx
		add	edx, 2
		add	ecx, ecx

loc_1000A245:				; CODE XREF: sub_1000A1F0+4Cj
		test	ecx, ecx
		js	short loc_1000A257
		inc	edx
		test	ecx, 40000000h
		jnz	short loc_1000A257
		mov	edx, 20h

loc_1000A257:				; CODE XREF: sub_1000A1F0+57j
					; sub_1000A1F0+60j
		mov	edi, [esp+1Ch+arg_0]
		mov	ecx, 20h
		sub	ecx, edx
		mov	[edi], ecx
		cmp	edx, 0Bh
		jge	short loc_1000A2BF
		mov	edi, 0Bh
		sub	edi, edx
		mov	ebp, eax
		mov	ecx, edi
		shr	ebp, cl
		or	ebp, 3FF00000h
		mov	dword ptr [esp+1Ch+var_8+4], ebp
		cmp	esi, ebx
		jbe	short loc_1000A2A2
		mov	esi, [esi-4]
		lea	ecx, [edx+15h]
		shl	eax, cl
		mov	ecx, edi
		shr	esi, cl
		pop	edi
		or	eax, esi
		pop	esi
		mov	dword ptr [esp+14h+var_8], eax
		fld	[esp+14h+var_8]
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A2A2:				; CODE XREF: sub_1000A1F0+92j
		lea	ecx, [edx+15h]
		xor	esi, esi
		shl	eax, cl
		mov	ecx, edi
		shr	esi, cl
		pop	edi
		or	eax, esi
		pop	esi
		mov	dword ptr [esp+14h+var_8], eax
		fld	[esp+14h+var_8]
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A2BF:				; CODE XREF: sub_1000A1F0+77j
		cmp	esi, ebx
		jbe	short loc_1000A2CB
		mov	ebx, [esi-4]
		sub	esi, 4
		jmp	short loc_1000A2CD
; ---------------------------------------------------------------------------

loc_1000A2CB:				; CODE XREF: sub_1000A1F0+D1j
		xor	ebx, ebx

loc_1000A2CD:				; CODE XREF: sub_1000A1F0+D9j
		sub	edx, 0Bh
		jz	short loc_1000A32E
		mov	edi, 20h
		sub	edi, edx
		mov	ecx, edi
		mov	ebp, ebx
		shr	ebp, cl
		mov	ecx, edx
		shl	eax, cl
		or	ebp, eax
		or	ebp, 3FF00000h
		mov	dword ptr [esp+1Ch+var_8+4], ebp
		cmp	esi, [esp+1Ch+var_C]
		jbe	short loc_1000A312
		mov	esi, [esi-4]
		mov	ecx, edi
		shr	esi, cl
		mov	ecx, edx
		shl	ebx, cl
		pop	edi
		or	esi, ebx
		mov	dword ptr [esp+18h+var_8], esi
		fld	[esp+18h+var_8]
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A312:				; CODE XREF: sub_1000A1F0+103j
		xor	esi, esi
		mov	ecx, edi
		shr	esi, cl
		mov	ecx, edx
		shl	ebx, cl
		pop	edi
		or	esi, ebx
		mov	dword ptr [esp+18h+var_8], esi
		fld	[esp+18h+var_8]
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1000A32E:				; CODE XREF: sub_1000A1F0+E0j
		pop	edi
		pop	esi
		or	eax, 3FF00000h
		mov	dword ptr [esp+14h+var_8], ebx
		mov	dword ptr [esp+14h+var_8+4], eax
		fld	[esp+14h+var_8]
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000A1F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000A350(double, int,	int)
sub_1000A350	proc near		; CODE XREF: PR_strtod+571p
					; sub_1000B720+12Cp

var_4		= dword	ptr -4
arg_0		= qword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		mov	eax, dword_10030BB0
		fld	[esp+4+arg_0]
		push	ebx
		fstp	[esp+8+arg_0]
		push	esi
		push	edi
		push	eax
		call	PR_Lock
		mov	esi, dword_10030BC0
		xor	edi, edi
		add	esp, 4
		cmp	esi, edi
		jz	short loc_1000A380
		mov	ecx, [esi]
		mov	dword_10030BC0,	ecx
		jmp	short loc_1000A3C2
; ---------------------------------------------------------------------------

loc_1000A380:				; CODE XREF: sub_1000A350+24j
		mov	eax, off_10030290
		mov	edx, eax
		sub	edx, offset dword_10030BE0
		sar	edx, 3
		add	edx, 4
		cmp	edx, 120h
		ja	short loc_1000A3A7
		mov	esi, eax
		add	eax, 20h
		mov	off_10030290, eax
		jmp	short loc_1000A3B4
; ---------------------------------------------------------------------------

loc_1000A3A7:				; CODE XREF: sub_1000A350+49j
		push	20h		; Size
		call	ds:malloc
		add	esp, 4
		mov	esi, eax

loc_1000A3B4:				; CODE XREF: sub_1000A350+55j
		mov	dword ptr [esi+4], 1
		mov	dword ptr [esi+8], 2

loc_1000A3C2:				; CODE XREF: sub_1000A350+2Ej
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	eax, dword ptr [esp+14h+arg_0+4]
		mov	[esi+10h], edi
		mov	[esi+0Ch], edi
		mov	edi, eax
		and	eax, 7FFFFFFFh
		shr	eax, 14h
		and	edi, 0FFFFFh
		mov	ebx, eax
		add	esp, 4
		mov	[esp+10h+var_4], edi
		test	ebx, ebx
		jz	short loc_1000A3FE
		or	edi, 100000h
		mov	[esp+10h+var_4], edi

loc_1000A3FE:				; CODE XREF: sub_1000A350+A2j
		mov	eax, dword ptr [esp+10h+arg_0]
		mov	dword ptr [esp+10h+arg_0], eax
		test	eax, eax
		jz	short loc_1000A454
		lea	edx, [esp+10h+arg_0]
		call	sub_10009AF0
		test	eax, eax
		jz	short loc_1000A43D
		mov	ecx, 20h
		sub	ecx, eax
		mov	edx, edi
		shl	edx, cl
		mov	ecx, eax
		shr	edi, cl
		or	edx, dword ptr [esp+10h+arg_0]
		mov	[esi+14h], edx
		xor	edx, edx
		test	edi, edi
		setnz	dl
		mov	[esi+18h], edi
		inc	edx
		mov	[esi+10h], edx
		jmp	short loc_1000A473
; ---------------------------------------------------------------------------

loc_1000A43D:				; CODE XREF: sub_1000A350+C5j
		mov	ecx, dword ptr [esp+10h+arg_0]
		xor	edx, edx
		test	edi, edi
		setnz	dl
		mov	[esi+14h], ecx
		mov	[esi+18h], edi
		inc	edx
		mov	[esi+10h], edx
		jmp	short loc_1000A473
; ---------------------------------------------------------------------------

loc_1000A454:				; CODE XREF: sub_1000A350+B8j
		lea	edx, [esp+10h+var_4]
		call	sub_10009AF0
		mov	edx, [esp+10h+var_4]
		mov	[esi+14h], edx
		mov	dword ptr [esi+10h], 1
		mov	edx, 1
		add	eax, 20h

loc_1000A473:				; CODE XREF: sub_1000A350+EBj
					; sub_1000A350+102j
		test	ebx, ebx
		jz	short loc_1000A498
		mov	edx, [esp+10h+arg_8]
		lea	ecx, [eax+ebx-433h]
		mov	[edx], ecx
		mov	edx, [esp+10h+arg_C]
		mov	ecx, 35h
		sub	ecx, eax
		pop	edi
		mov	eax, esi
		pop	esi
		mov	[edx], ecx
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000A498:				; CODE XREF: sub_1000A350+125j
		mov	ecx, [esp+10h+arg_8]
		add	eax, 0FFFFFBCEh
		mov	[ecx], eax
		mov	ecx, [esi+edx*4+10h]
		call	sub_10009AA0
		shl	edx, 5
		sub	edx, eax
		mov	eax, [esp+10h+arg_C]
		pop	edi
		mov	[eax], edx
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	ecx
		retn
sub_1000A350	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 395. PR_strtod

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public PR_strtod
PR_strtod	proc near		; CODE XREF: sub_10006BC0+1F1p
					; DATA XREF: .rdata:off_1002C7C8o

var_D0		= qword	ptr -0D0h
var_98		= qword	ptr -98h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
Memory		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= qword	ptr -68h
var_60		= qword	ptr -60h
var_54		= dword	ptr -54h
var_50		= qword	ptr -50h
var_48		= qword	ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= qword	ptr -38h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= qword	ptr -28h
var_20		= qword	ptr -20h
var_14		= dword	ptr -14h
var_10		= qword	ptr -10h
var_8		= qword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFC0h
		sub	esp, 0B4h
		push	ebx
		push	esi
		xor	esi, esi
		push	edi
		cmp	dword_10031520,	esi
		jnz	short loc_1000A4DE
		call	PR_Init

loc_1000A4DE:				; CODE XREF: PR_strtod+17j
		fldz
		mov	[esp+0C0h+var_74], esi
		mov	[esp+0C0h+var_54], esi
		fst	[esp+0C0h+var_98]
		mov	esi, [ebp+arg_0]
		movsx	eax, byte ptr [esi]
		xor	ecx, ecx
		mov	[esp+0C0h+var_78], ecx
		mov	[esp+0C0h+var_8C], esi
		cmp	eax, 2Dh	; switch 46 cases
		ja	short loc_1000A51D ; jumptable 1000A508	default	case

loc_1000A501:				; CODE XREF: PR_strtod+57j
		movzx	eax, ds:byte_1000B410[eax]
		jmp	ds:off_1000B3FC[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000A50F:				; CODE XREF: PR_strtod+48j
					; DATA XREF: .text:off_1000B3FCo
		movsx	eax, byte ptr [esi+1] ;	jumptable 1000A508 cases 9-13,32
		inc	esi
		cmp	eax, 2Dh
		jbe	short loc_1000A501

loc_1000A519:				; CODE XREF: PR_strtod+48j
					; DATA XREF: .text:off_1000B3FCo
		mov	[esp+0C0h+var_8C], esi ; jumptable 1000A508 cases 1-8,14-31,33-42,44

loc_1000A51D:				; CODE XREF: PR_strtod+3Fj
					; PR_strtod+BFj
		mov	al, [esi]	; jumptable 1000A508 default case
		cmp	al, 30h
		jnz	short loc_1000A53F
		mov	[esp+0C0h+var_74], 1

loc_1000A52B:				; CODE XREF: PR_strtod+6Fj
		inc	esi
		cmp	byte ptr [esi],	30h
		jz	short loc_1000A52B
		mov	al, [esi]
		mov	[esp+0C0h+var_8C], esi
		test	al, al
		jz	loc_1000B3DD

loc_1000A53F:				; CODE XREF: PR_strtod+61j
		movsx	eax, al
		xor	edi, edi
		xor	edx, edx
		xor	ebx, ebx
		mov	[esp+0C0h+var_6C], esi
		mov	[esp+0C0h+var_7C], edx
		mov	[esp+0C0h+var_88], edi
		mov	[esp+0C0h+var_84], edi
		cmp	eax, 30h
		jl	short loc_1000A5B6

loc_1000A55D:				; CODE XREF: PR_strtod+E8j
		cmp	eax, 39h
		jg	short loc_1000A5AA
		cmp	ebx, 9
		jge	short loc_1000A593
		lea	edi, [edi+edi*4]
		lea	edi, [eax+edi*2-30h]
		jmp	short loc_1000A59F
; ---------------------------------------------------------------------------

loc_1000A570:				; CODE XREF: PR_strtod+48j
					; DATA XREF: .text:off_1000B3FCo
		mov	[esp+0C0h+var_54], 1 ; jumptable 1000A508 case 45

loc_1000A578:				; CODE XREF: PR_strtod+48j
					; DATA XREF: .text:off_1000B3FCo
		inc	esi		; jumptable 1000A508 case 43
		mov	[esp+0C0h+var_8C], esi
		cmp	[esi], cl
		jnz	short loc_1000A51D ; jumptable 1000A508	default	case

loc_1000A581:				; CODE XREF: PR_strtod+48j
					; PR_strtod+1D7j ...
		mov	esi, [ebp+arg_0] ; jumptable 1000A508 case 0
		fstp	st
		mov	[esp+0C0h+var_54], 0
		jmp	loc_1000B3DF
; ---------------------------------------------------------------------------

loc_1000A593:				; CODE XREF: PR_strtod+A5j
		cmp	ebx, 10h
		jge	short loc_1000A59F
		lea	edx, [edx+edx*4]
		lea	edx, [eax+edx*2-30h]

loc_1000A59F:				; CODE XREF: PR_strtod+AEj
					; PR_strtod+D6j
		movsx	eax, byte ptr [esi+1]
		inc	esi
		inc	ebx
		cmp	eax, 30h
		jge	short loc_1000A55D

loc_1000A5AA:				; CODE XREF: PR_strtod+A0j
		mov	[esp+0C0h+var_88], edi
		mov	[esp+0C0h+var_7C], edx
		mov	[esp+0C0h+var_8C], esi

loc_1000A5B6:				; CODE XREF: PR_strtod+9Bj
		mov	[esp+0C0h+var_70], ebx
		cmp	eax, 2Eh
		jnz	loc_1000A691
		movsx	eax, byte ptr [esi+1]
		inc	esi
		mov	[esp+0C0h+var_8C], esi
		test	ebx, ebx
		jnz	short loc_1000A600
		cmp	eax, 30h
		jnz	short loc_1000A5E8

loc_1000A5D5:				; CODE XREF: PR_strtod+11Ej
		movsx	eax, byte ptr [esi+1]
		inc	esi
		inc	ecx
		cmp	eax, 30h
		jz	short loc_1000A5D5
		mov	[esp+0C0h+var_8C], esi
		mov	[esp+0C0h+var_78], ecx

loc_1000A5E8:				; CODE XREF: PR_strtod+113j
		lea	edi, [eax-31h]
		cmp	edi, 8
		ja	loc_1000A69D
		mov	[esp+0C0h+var_84], ecx
		mov	[esp+0C0h+var_6C], esi
		xor	ecx, ecx
		jmp	short loc_1000A60C
; ---------------------------------------------------------------------------

loc_1000A600:				; CODE XREF: PR_strtod+10Ej
					; PR_strtod+1ACj ...
		lea	edi, [eax-30h]
		cmp	edi, 9
		ja	loc_1000A691

loc_1000A60C:				; CODE XREF: PR_strtod+13Ej
		inc	ecx
		sub	eax, 30h
		mov	[esp+0C0h+var_78], ecx
		jz	short loc_1000A683
		add	[esp+0C0h+var_84], ecx
		cmp	ecx, 1
		jle	short loc_1000A648
		dec	ecx

loc_1000A620:				; CODE XREF: PR_strtod+182j
		mov	edi, ebx
		inc	ebx
		cmp	edi, 9
		jge	short loc_1000A637
		mov	edi, [esp+0C0h+var_88]
		lea	edi, [edi+edi*4]
		add	edi, edi
		mov	[esp+0C0h+var_88], edi
		jmp	short loc_1000A641
; ---------------------------------------------------------------------------

loc_1000A637:				; CODE XREF: PR_strtod+166j
		cmp	ebx, 10h
		jg	short loc_1000A641
		lea	edx, [edx+edx*4]
		add	edx, edx

loc_1000A641:				; CODE XREF: PR_strtod+175j
					; PR_strtod+17Aj
		dec	ecx
		jnz	short loc_1000A620
		mov	[esp+0C0h+var_7C], edx

loc_1000A648:				; CODE XREF: PR_strtod+15Dj
		mov	ecx, ebx
		inc	ebx
		cmp	ecx, 9
		jge	short loc_1000A66E
		mov	ecx, [esp+0C0h+var_88]
		lea	ecx, [ecx+ecx*4]
		lea	eax, [eax+ecx*2]
		xor	ecx, ecx
		inc	esi
		mov	[esp+0C0h+var_88], eax
		movsx	eax, byte ptr [esi]
		mov	[esp+0C0h+var_78], ecx
		mov	[esp+0C0h+var_8C], esi
		jmp	short loc_1000A600
; ---------------------------------------------------------------------------

loc_1000A66E:				; CODE XREF: PR_strtod+18Ej
		cmp	ebx, 10h
		jg	short loc_1000A67D
		lea	ecx, [edx+edx*4]
		lea	edx, [eax+ecx*2]
		mov	[esp+0C0h+var_7C], edx

loc_1000A67D:				; CODE XREF: PR_strtod+1B1j
		xor	ecx, ecx
		mov	[esp+0C0h+var_78], ecx

loc_1000A683:				; CODE XREF: PR_strtod+154j
		movsx	eax, byte ptr [esi+1]
		inc	esi
		mov	[esp+0C0h+var_8C], esi
		jmp	loc_1000A600
; ---------------------------------------------------------------------------

loc_1000A691:				; CODE XREF: PR_strtod+FDj
					; PR_strtod+146j
		cmp	ebx, 10000h
		jg	loc_1000A581	; jumptable 1000A508 case 0

loc_1000A69D:				; CODE XREF: PR_strtod+12Ej
		xor	edi, edi
		cmp	eax, 65h
		jz	short loc_1000A6AD
		cmp	eax, 45h
		jnz	loc_1000A76B

loc_1000A6AD:				; CODE XREF: PR_strtod+1E2j
		test	ebx, ebx
		jnz	short loc_1000A6C1
		cmp	[esp+0C0h+var_78], edi
		jnz	short loc_1000A6C1
		cmp	[esp+0C0h+var_74], edi
		jz	loc_1000A581	; jumptable 1000A508 case 0

loc_1000A6C1:				; CODE XREF: PR_strtod+1EFj
					; PR_strtod+1F5j
		movsx	eax, byte ptr [esi+1]
		mov	edx, esi
		inc	esi
		mov	ecx, eax
		sub	ecx, 2Bh
		mov	[ebp+arg_0], edx
		mov	[esp+0C0h+Memory], edi
		mov	[esp+0C0h+var_8C], esi
		jz	short loc_1000A6E7
		sub	ecx, 2
		jnz	short loc_1000A6F0
		mov	[esp+0C0h+Memory], 1

loc_1000A6E7:				; CODE XREF: PR_strtod+218j
		movsx	eax, byte ptr [esi+1]
		inc	esi
		mov	[esp+0C0h+var_8C], esi

loc_1000A6F0:				; CODE XREF: PR_strtod+21Dj
		lea	ecx, [eax-30h]
		cmp	ecx, 9
		ja	short loc_1000A765
		cmp	eax, 30h
		jnz	short loc_1000A70B

loc_1000A6FD:				; CODE XREF: PR_strtod+245j
		movsx	eax, byte ptr [esi+1]
		inc	esi
		cmp	eax, 30h
		jz	short loc_1000A6FD
		mov	[esp+0C0h+var_8C], esi

loc_1000A70B:				; CODE XREF: PR_strtod+23Bj
		lea	edx, [eax-31h]
		cmp	edx, 8
		ja	short loc_1000A761
		mov	edx, esi
		inc	esi
		lea	ecx, [eax-30h]
		movsx	eax, byte ptr [esi]
		mov	[esp+0C0h+var_8C], esi
		cmp	eax, 30h
		jl	short loc_1000A73E

loc_1000A725:				; CODE XREF: PR_strtod+278j
		cmp	eax, 39h
		jg	short loc_1000A73A
		lea	ecx, [ecx+ecx*4]
		inc	esi
		lea	ecx, [eax+ecx*2-30h]
		movsx	eax, byte ptr [esi]
		cmp	eax, 30h
		jge	short loc_1000A725

loc_1000A73A:				; CODE XREF: PR_strtod+268j
		mov	[esp+0C0h+var_8C], esi

loc_1000A73E:				; CODE XREF: PR_strtod+263j
		mov	eax, esi
		sub	eax, edx
		cmp	eax, 8
		jg	short loc_1000A751
		mov	edi, ecx
		cmp	ecx, 4E1Fh
		jle	short loc_1000A756

loc_1000A751:				; CODE XREF: PR_strtod+285j
		mov	edi, 4E1Fh

loc_1000A756:				; CODE XREF: PR_strtod+28Fj
		cmp	[esp+0C0h+Memory], 0
		jz	short loc_1000A76B
		neg	edi
		jmp	short loc_1000A76B
; ---------------------------------------------------------------------------

loc_1000A761:				; CODE XREF: PR_strtod+251j
		xor	edi, edi
		jmp	short loc_1000A76B
; ---------------------------------------------------------------------------

loc_1000A765:				; CODE XREF: PR_strtod+236j
		mov	esi, edx
		mov	[esp+0C0h+var_8C], esi

loc_1000A76B:				; CODE XREF: PR_strtod+1E7j
					; PR_strtod+29Bj ...
		test	ebx, ebx
		jnz	short loc_1000A791
		fstp	st
		cmp	[esp+0C0h+var_78], ebx
		jnz	loc_1000B3DF
		cmp	[esp+0C0h+var_74], ebx
		jnz	loc_1000B3DF
		mov	esi, [ebp+arg_0]
		mov	[esp+0C0h+var_54], ebx
		jmp	loc_1000B3DF
; ---------------------------------------------------------------------------

loc_1000A791:				; CODE XREF: PR_strtod+2ADj
		sub	edi, [esp+0C0h+var_84]
		cmp	[esp+0C0h+var_70], 0
		mov	[esp+0C0h+var_40], edi
		jnz	short loc_1000A7A7
		mov	[esp+0C0h+var_70], ebx

loc_1000A7A7:				; CODE XREF: PR_strtod+2E1j
		mov	ecx, ebx
		cmp	ebx, 10h
		jl	short loc_1000A7B3
		mov	ecx, 10h

loc_1000A7B3:				; CODE XREF: PR_strtod+2ECj
		mov	edx, [esp+0C0h+var_88]
		fild	[esp+0C0h+var_88]
		test	edx, edx
		jns	short loc_1000A7C5
		fadd	ds:dbl_10028800

loc_1000A7C5:				; CODE XREF: PR_strtod+2FDj
		fst	[esp+0C0h+var_98]
		cmp	ecx, 9
		jle	short loc_1000A7ED
		mov	eax, [esp+0C0h+var_7C]
		fmul	qword ptr ds:(aPr_counterGe_2+1Ch)[ecx*8] ; "romName: %p"
		fild	[esp+0C0h+var_7C]
		test	eax, eax
		jns	short loc_1000A7E7
		fadd	ds:dbl_10028800

loc_1000A7E7:				; CODE XREF: PR_strtod+31Fj
		faddp	st(1), st
		fst	[esp+0C0h+var_98]

loc_1000A7ED:				; CODE XREF: PR_strtod+30Cj
		mov	[esp+0C0h+var_78], 0
		cmp	ebx, 0Fh
		jg	short loc_1000A864
		test	edi, edi
		jz	loc_1000B3DB
		jle	short loc_1000A844
		cmp	edi, 16h
		jg	short loc_1000A81B
		fstp	st(1)
		fmul	ds:dbl_10028AF0[edi*8]
		fstp	[esp+0C0h+var_98]
		jmp	loc_1000B3DF
; ---------------------------------------------------------------------------

loc_1000A81B:				; CODE XREF: PR_strtod+347j
		mov	eax, 0Fh
		sub	eax, ebx
		lea	edx, [eax+16h]
		cmp	edi, edx
		jg	short loc_1000A864
		fstp	st(1)
		sub	edi, eax
		fmul	ds:dbl_10028AF0[eax*8]
		fmul	ds:dbl_10028AF0[edi*8]
		fstp	[esp+0C0h+var_98]
		jmp	loc_1000B3DF
; ---------------------------------------------------------------------------

loc_1000A844:				; CODE XREF: PR_strtod+342j
		cmp	edi, 0FFFFFFEAh
		jl	short loc_1000A864
		lea	eax, ds:0[edi*8]
		fstp	st(1)
		mov	ecx, offset dbl_10028AF0
		sub	ecx, eax
		fdiv	qword ptr [ecx]
		fstp	[esp+0C0h+var_98]
		jmp	loc_1000B3DF
; ---------------------------------------------------------------------------

loc_1000A864:				; CODE XREF: PR_strtod+338j
					; PR_strtod+367j ...
		mov	eax, edi
		sub	eax, ecx
		xor	edx, edx
		add	eax, ebx
		mov	[esp+0C0h+var_7C], edx
		cmp	eax, edx
		jle	loc_1000A916
		mov	ecx, eax
		fstp	st(1)
		and	ecx, 0Fh
		jz	short loc_1000A88C
		fmul	ds:dbl_10028AF0[ecx*8]
		fst	[esp+0C0h+var_98]

loc_1000A88C:				; CODE XREF: PR_strtod+3BFj
		and	eax, 0FFFFFFF0h
		jz	loc_1000A9D1
		cmp	eax, 134h
		jg	loc_1000B22F
		sar	eax, 4
		xor	ecx, ecx
		cmp	eax, 1
		jle	short loc_1000A8C3

loc_1000A8AA:				; CODE XREF: PR_strtod+3FBj
		test	al, 1
		jz	short loc_1000A8B5
		fmul	ds:dbl_10028BA8[ecx*8]

loc_1000A8B5:				; CODE XREF: PR_strtod+3ECj
		sar	eax, 1
		inc	ecx
		cmp	eax, 1
		jg	short loc_1000A8AA
		fstp	[esp+0C0h+var_98]
		jmp	short loc_1000A8C5
; ---------------------------------------------------------------------------

loc_1000A8C3:				; CODE XREF: PR_strtod+3E8j
		fstp	st

loc_1000A8C5:				; CODE XREF: PR_strtod+401j
		fld	ds:dbl_10028BA8[ecx*8]
		mov	edx, 3500000h
		sub	dword ptr [esp+0C0h+var_98+4], edx
		fmul	[esp+0C0h+var_98]
		fstp	[esp+0C0h+var_98]
		mov	eax, dword ptr [esp+0C0h+var_98+4]
		and	eax, 7FF00000h
		cmp	eax, 7CA00000h
		ja	loc_1000B237
		cmp	eax, 7C900000h
		jbe	short loc_1000A90D
		mov	dword ptr [esp+0C0h+var_98+4], 7FEFFFFFh
		mov	dword ptr [esp+0C0h+var_98], 0FFFFFFFFh
		jmp	loc_1000A9D3
; ---------------------------------------------------------------------------

loc_1000A90D:				; CODE XREF: PR_strtod+436j
		add	dword ptr [esp+0C0h+var_98+4], edx
		jmp	loc_1000A9D3
; ---------------------------------------------------------------------------

loc_1000A916:				; CODE XREF: PR_strtod+3B2j
		jge	loc_1000A9CF
		neg	eax
		mov	ecx, eax
		and	ecx, 0Fh
		jz	short loc_1000A930
		fdiv	ds:dbl_10028AF0[ecx*8]
		fst	[esp+0C0h+var_98]

loc_1000A930:				; CODE XREF: PR_strtod+463j
		sar	eax, 4
		cmp	eax, edx
		jz	loc_1000A9CF
		cmp	eax, 20h
		jge	loc_1000B226
		test	al, 10h
		jz	short loc_1000A950
		mov	[esp+0C0h+var_7C], 6Ah

loc_1000A950:				; CODE XREF: PR_strtod+486j
		cmp	eax, edx
		jle	short loc_1000A96E
		mov	ecx, offset dword_10028BD0

loc_1000A959:				; CODE XREF: PR_strtod+4A6j
		test	al, 1
		jz	short loc_1000A95F
		fmul	qword ptr [ecx]

loc_1000A95F:				; CODE XREF: PR_strtod+49Bj
		sar	eax, 1
		add	ecx, 8
		cmp	eax, edx
		jg	short loc_1000A959
		fstp	[esp+0C0h+var_98]
		jmp	short loc_1000A970
; ---------------------------------------------------------------------------

loc_1000A96E:				; CODE XREF: PR_strtod+492j
		fstp	st

loc_1000A970:				; CODE XREF: PR_strtod+4ACj
		cmp	[esp+0C0h+var_7C], edx
		jz	short loc_1000A9BC
		mov	eax, dword ptr [esp+0C0h+var_98+4]
		shr	eax, 14h
		and	eax, 7FFh
		mov	ecx, 6Bh
		sub	ecx, eax
		cmp	ecx, edx
		jle	short loc_1000A9BC
		cmp	ecx, 20h
		jl	short loc_1000A9B3
		mov	dword ptr [esp+0C0h+var_98], edx
		cmp	ecx, 35h
		jl	short loc_1000A9A5
		mov	dword ptr [esp+0C0h+var_98+4], 3700000h
		jmp	short loc_1000A9BC
; ---------------------------------------------------------------------------

loc_1000A9A5:				; CODE XREF: PR_strtod+4D9j
		add	ecx, 0FFFFFFE0h
		or	edx, 0FFFFFFFFh
		shl	edx, cl
		and	dword ptr [esp+0C0h+var_98+4], edx
		jmp	short loc_1000A9BC
; ---------------------------------------------------------------------------

loc_1000A9B3:				; CODE XREF: PR_strtod+4D0j
		or	eax, 0FFFFFFFFh
		shl	eax, cl
		and	dword ptr [esp+0C0h+var_98], eax

loc_1000A9BC:				; CODE XREF: PR_strtod+4B4j
					; PR_strtod+4CBj ...
		fld	[esp+0C0h+var_98]
		fucompp
		fnstsw	ax
		test	ah, 44h
		jnp	loc_1000AD94
		jmp	short loc_1000A9D3
; ---------------------------------------------------------------------------

loc_1000A9CF:				; CODE XREF: PR_strtod:loc_1000A916j
					; PR_strtod+475j
		fstp	st

loc_1000A9D1:				; CODE XREF: PR_strtod+3CFj
		fstp	st

loc_1000A9D3:				; CODE XREF: PR_strtod+448j
					; PR_strtod+451j ...
		mov	ecx, [esp+0C0h+var_88]
		mov	edx, [esp+0C0h+var_70]
		mov	eax, [esp+0C0h+var_6C]
		push	ecx
		push	ebx
		push	edx
		call	sub_10009A00
		mov	esi, eax
		add	esp, 0Ch
		mov	[esp+0C0h+var_78], esi

loc_1000A9F0:				; CODE XREF: PR_strtod+B51j
					; PR_strtod+B8Ej
		mov	ebx, [esi+4]
		call	sub_10009860
		mov	ecx, [esi+10h]
		lea	edx, ds:8[ecx*4]
		push	edx		; Size
		lea	ecx, [esi+0Ch]
		mov	[esp+0C4h+var_88], eax
		push	ecx		; Src
		add	eax, 0Ch
		push	eax		; Dst
		call	memcpy
		fld	[esp+0CCh+var_98]
		add	esp, 0Ch
		lea	eax, [esp+0C0h+var_3C]
		push	eax		; int
		lea	ecx, [esp+0C4h+var_14]
		push	ecx		; int
		sub	esp, 8
		fstp	[esp+0D0h+var_D0] ; double
		call	sub_1000A350
		push	1
		mov	[esp+0D4h+Memory], eax
		call	sub_10009B60
		add	esp, 14h
		mov	[esp+0C0h+var_84], eax
		test	edi, edi
		js	short loc_1000AA58
		xor	eax, eax
		xor	esi, esi
		mov	[esp+0C0h+var_70], edi
		mov	ebx, edi
		jmp	short loc_1000AA68
; ---------------------------------------------------------------------------

loc_1000AA58:				; CODE XREF: PR_strtod+58Aj
		mov	eax, edi
		neg	eax
		mov	esi, eax
		mov	[esp+0C0h+var_70], 0
		xor	ebx, ebx

loc_1000AA68:				; CODE XREF: PR_strtod+596j
		mov	ecx, [esp+0C0h+var_14]
		test	ecx, ecx
		js	short loc_1000AA77
		add	esi, ecx
		jmp	short loc_1000AA79
; ---------------------------------------------------------------------------

loc_1000AA77:				; CODE XREF: PR_strtod+5B1j
		sub	ebx, ecx

loc_1000AA79:				; CODE XREF: PR_strtod+5B5j
		sub	ecx, [esp+0C0h+var_7C]
		mov	edx, [esp+0C0h+var_3C]
		lea	edi, [edx+ecx-1]
		mov	[esp+0C0h+var_74], esi
		cmp	edi, 0FFFFFC02h
		jge	short loc_1000AA9C
		add	ecx, 433h
		jmp	short loc_1000AAA3
; ---------------------------------------------------------------------------

loc_1000AA9C:				; CODE XREF: PR_strtod+5D2j
		mov	ecx, 36h
		sub	ecx, edx

loc_1000AAA3:				; CODE XREF: PR_strtod+5DAj
		add	esi, ecx
		add	ecx, [esp+0C0h+var_7C]
		add	ebx, ecx
		mov	ecx, esi
		cmp	esi, ebx
		jl	short loc_1000AAB3
		mov	ecx, ebx

loc_1000AAB3:				; CODE XREF: PR_strtod+5EFj
		mov	edi, [esp+0C0h+var_74]
		cmp	ecx, edi
		jle	short loc_1000AABD
		mov	ecx, edi

loc_1000AABD:				; CODE XREF: PR_strtod+5F9j
		test	ecx, ecx
		jle	short loc_1000AACB
		sub	esi, ecx
		sub	ebx, ecx
		sub	edi, ecx
		mov	[esp+0C0h+var_74], edi

loc_1000AACB:				; CODE XREF: PR_strtod+5FFj
		test	eax, eax
		jle	short loc_1000AB3E
		mov	ecx, [esp+0C0h+var_84]
		push	ecx		; Memory
		call	sub_10009D90
		mov	edi, [esp+0C4h+Memory]
		push	edi
		mov	[esp+0C8h+var_84], eax
		call	sub_10009BF0
		add	esp, 8
		mov	[esp+0C0h+Memory], eax
		test	edi, edi
		jz	short loc_1000AB32
		cmp	dword ptr [edi+4], 7
		jle	short loc_1000AB04
		push	edi		; Memory
		call	ds:free
		add	esp, 4
		jmp	short loc_1000AB32
; ---------------------------------------------------------------------------

loc_1000AB04:				; CODE XREF: PR_strtod+636j
		mov	edx, dword_10030BB0
		push	edx
		call	PR_Lock
		mov	eax, [edi+4]
		mov	ecx, dword_10030BBC[eax*4]
		mov	[edi], ecx
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		mov	dword_10030BBC[eax*4], edi
		call	PR_Unlock
		add	esp, 8

loc_1000AB32:				; CODE XREF: PR_strtod+630j
					; PR_strtod+642j
		mov	eax, [esp+0C0h+Memory]
		mov	edi, [esp+0C0h+var_74]
		mov	[esp+0C0h+Memory], eax

loc_1000AB3E:				; CODE XREF: PR_strtod+60Dj
		test	esi, esi
		jle	short loc_1000AB54
		mov	ecx, [esp+0C0h+Memory]
		push	esi		; int
		push	ecx		; Memory
		call	sub_10009EC0
		add	esp, 8
		mov	[esp+0C0h+Memory], eax

loc_1000AB54:				; CODE XREF: PR_strtod+680j
		mov	eax, [esp+0C0h+var_70]
		test	eax, eax
		jle	short loc_1000AB6D
		mov	edx, [esp+0C0h+var_88]
		push	edx		; Memory
		call	sub_10009D90
		add	esp, 4
		mov	[esp+0C0h+var_88], eax

loc_1000AB6D:				; CODE XREF: PR_strtod+69Aj
		test	ebx, ebx
		jle	short loc_1000AB83
		mov	eax, [esp+0C0h+var_88]
		push	ebx		; int
		push	eax		; Memory
		call	sub_10009EC0
		add	esp, 8
		mov	[esp+0C0h+var_88], eax

loc_1000AB83:				; CODE XREF: PR_strtod+6AFj
		test	edi, edi
		jle	short loc_1000AB99
		mov	ecx, [esp+0C0h+var_84]
		push	edi		; int
		push	ecx		; Memory
		call	sub_10009EC0
		add	esp, 8
		mov	[esp+0C0h+var_84], eax

loc_1000AB99:				; CODE XREF: PR_strtod+6C5j
		mov	eax, [esp+0C0h+var_88]
		mov	ecx, [esp+0C0h+Memory]
		mov	edi, [esp+0C0h+var_84]
		call	sub_1000A020
		mov	ebx, eax
		mov	esi, [ebx+0Ch]
		mov	eax, [ebx+10h]
		mov	dword ptr [ebx+0Ch], 0
		mov	ecx, [edi+10h]
		sub	eax, ecx
		mov	[esp+0C0h+var_74], ebx
		mov	[esp+0C0h+var_70], esi
		jnz	short loc_1000AC00
		lea	edx, [ebx+14h]
		mov	esi, [edx+ecx*4-4]
		cmp	esi, [edi+ecx*4+10h]
		lea	eax, [edx+ecx*4-4]
		lea	ecx, [edi+ecx*4+10h]
		jnz	short loc_1000ABF2

loc_1000ABDD:				; CODE XREF: PR_strtod+730j
		cmp	eax, edx
		jbe	loc_1000B0F6
		mov	esi, [eax-4]
		sub	eax, 4
		sub	ecx, 4
		cmp	esi, [ecx]
		jz	short loc_1000ABDD

loc_1000ABF2:				; CODE XREF: PR_strtod+71Bj
		mov	edx, [eax]
		cmp	edx, [ecx]
		mov	esi, [esp+0C0h+var_70]
		sbb	eax, eax
		and	eax, 0FFFFFFFEh
		inc	eax

loc_1000AC00:				; CODE XREF: PR_strtod+706j
		test	eax, eax
		js	loc_1000B053
		jz	loc_1000B0FA
		lea	eax, [esp+0C0h+var_30]
		push	eax
		mov	eax, ebx
		call	sub_1000A1F0
		fstp	[esp+0C4h+var_28]
		lea	ecx, [esp+0C4h+var_2C]
		push	ecx
		mov	eax, edi
		call	sub_1000A1F0
		fstp	[esp+0C8h+var_20]
		mov	eax, [ebx+10h]
		sub	eax, [edi+10h]
		add	esp, 8
		shl	eax, 5
		sub	eax, [esp+0C0h+var_2C]
		add	eax, [esp+0C0h+var_30]
		test	eax, eax
		jle	short loc_1000AC64
		shl	eax, 14h
		add	dword ptr [esp+0C0h+var_28+4], eax
		jmp	short loc_1000AC71
; ---------------------------------------------------------------------------

loc_1000AC64:				; CODE XREF: PR_strtod+796j
		imul	eax, 0FFF00000h
		add	dword ptr [esp+0C0h+var_20+4], eax

loc_1000AC71:				; CODE XREF: PR_strtod+7A2j
		fld	[esp+0C0h+var_28]
		fdiv	[esp+0C0h+var_20]
		fld	ds:dbl_10028C20
		fcomp	st(1)
		fnstsw	ax
		test	ah, 1
		jnz	loc_1000ADC8
		test	esi, esi
		jz	short loc_1000AC9E
		fstp	st
		fld1
		fld	st
		jmp	short loc_1000ACD3
; ---------------------------------------------------------------------------

loc_1000AC9E:				; CODE XREF: PR_strtod+7D4j
		mov	eax, dword ptr [esp+0C0h+var_98]
		test	eax, eax
		jnz	loc_1000AD82
		test	dword ptr [esp+0C0h+var_98+4], 0FFFFFh
		jnz	loc_1000ADB9
		fld1
		fcomp	st(1)
		fnstsw	ax
		test	ah, 41h
		jnz	loc_1000AD77
		fstp	st
		fld	ds:dbl_100287F8

loc_1000ACCF:				; CODE XREF: PR_strtod+8BDj
					; PR_strtod+910j
		fld	st
		fchs

loc_1000ACD3:				; CODE XREF: PR_strtod+7DCj
					; PR_strtod+903j ...
		mov	ecx, dword ptr [esp+0C0h+var_98+4]
		and	ecx, 7FF00000h
		cmp	ecx, 7FE00000h
		jnz	loc_1000ADEC
		fld	[esp+0C0h+var_98]
		sub	dword ptr [esp+0C0h+var_98+4], 3500000h
		fstp	[esp+0C0h+var_48]
		mov	dword ptr [esp+0C0h+var_10], 0
		fld	[esp+0C0h+var_98]
		fst	[esp+0C0h+var_8]
		mov	edx, dword ptr [esp+0C0h+var_8+4]
		and	edx, 7FF00000h
		sub	edx, 3400000h
		mov	dword ptr [esp+0C0h+var_10+4], edx
		fld	[esp+0C0h+var_10]
		fmulp	st(2), st
		faddp	st(1), st
		fstp	[esp+0C0h+var_98]
		mov	esi, dword ptr [esp+0C0h+var_98+4]
		mov	eax, esi
		and	eax, 7FF00000h
		cmp	eax, 7CA00000h
		jb	loc_1000ADDD
		mov	eax, 7FEFFFFFh
		fstp	st
		cmp	dword ptr [esp+0C0h+var_48+4], eax
		jnz	short loc_1000AD66
		cmp	dword ptr [esp+0C0h+var_48], 0FFFFFFFFh
		jz	loc_1000B233

loc_1000AD66:				; CODE XREF: PR_strtod+899j
		mov	dword ptr [esp+0C0h+var_98+4], eax
		mov	dword ptr [esp+0C0h+var_98], 0FFFFFFFFh
		jmp	loc_1000AF14
; ---------------------------------------------------------------------------

loc_1000AD77:				; CODE XREF: PR_strtod+801j
		fmul	ds:dbl_100287F8
		jmp	loc_1000ACCF
; ---------------------------------------------------------------------------

loc_1000AD82:				; CODE XREF: PR_strtod+7E4j
		fstp	st
		cmp	eax, 1
		jnz	short loc_1000ADBB
		cmp	dword ptr [esp+0C0h+var_98+4], 0
		jnz	short loc_1000ADBB

loc_1000AD90:				; CODE XREF: PR_strtod+CD3j
					; PR_strtod+D61j
		mov	esi, [esp+0C0h+var_8C]

loc_1000AD94:				; CODE XREF: PR_strtod+507j
					; PR_strtod+D6Aj
		fldz
		push	0
		push	0FFFFE8B8h
		fstp	[esp+0C8h+var_98]
		call	PR_SetError
		add	esp, 8
		cmp	[esp+0C0h+var_78], 0
		jnz	loc_1000B268
		jmp	loc_1000B3DF
; ---------------------------------------------------------------------------

loc_1000ADB9:				; CODE XREF: PR_strtod+7F2j
		fstp	st

loc_1000ADBB:				; CODE XREF: PR_strtod+8C7j
					; PR_strtod+8CEj
		fld1
		fld	ds:dbl_10028C18
		jmp	loc_1000ACD3
; ---------------------------------------------------------------------------

loc_1000ADC8:				; CODE XREF: PR_strtod+7CCj
		fmul	ds:dbl_100287F8
		test	esi, esi
		jz	loc_1000ACCF
		fld	st
		jmp	loc_1000ACD3
; ---------------------------------------------------------------------------

loc_1000ADDD:				; CODE XREF: PR_strtod+888j
		add	esi, 3500000h
		mov	dword ptr [esp+0C0h+var_98+4], esi
		jmp	loc_1000AE9F
; ---------------------------------------------------------------------------

loc_1000ADEC:				; CODE XREF: PR_strtod+823j
		cmp	[esp+0C0h+var_7C], 0
		jz	short loc_1000AE6D
		cmp	ecx, 6A00000h
		ja	short loc_1000AE6D
		fld	ds:dbl_10028C10
		fcomp	st(2)
		fnstsw	ax
		test	ah, 1
		jnz	short loc_1000AE51
		fnstcw	word ptr [esp+0C0h+var_6C]
		movzx	eax, word ptr [esp+0C0h+var_6C]
		fstp	st
		or	eax, 0C00h
		mov	dword ptr [esp+0C0h+var_68], eax
		fldcw	word ptr [esp+0C0h+var_68]
		fistp	[esp+0C0h+var_68]
		mov	eax, dword ptr [esp+0C0h+var_68]
		fldcw	word ptr [esp+0C0h+var_6C]
		test	eax, eax
		jnz	short loc_1000AE37
		mov	eax, 1

loc_1000AE37:				; CODE XREF: PR_strtod+970j
		mov	dword ptr [esp+0C0h+var_68], eax
		fild	dword ptr [esp+0C0h+var_68]
		test	eax, eax
		jns	short loc_1000AE49
		fadd	ds:dbl_10028800

loc_1000AE49:				; CODE XREF: PR_strtod+981j
		fld	st
		test	esi, esi
		jnz	short loc_1000AE51
		fchs

loc_1000AE51:				; CODE XREF: PR_strtod+948j
					; PR_strtod+98Dj
		mov	edx, 6B00000h
		fstp	[esp+0C0h+var_38]
		sub	edx, ecx
		add	dword ptr [esp+0C0h+var_38+4], edx
		fld	[esp+0C0h+var_38]

loc_1000AE6D:				; CODE XREF: PR_strtod+931j
					; PR_strtod+939j
		fld	[esp+0C0h+var_98]
		mov	dword ptr [esp+0C0h+var_60], 0
		fst	[esp+0C0h+var_50]
		mov	eax, dword ptr [esp+0C0h+var_50+4]
		and	eax, 7FF00000h
		sub	eax, 3400000h
		mov	dword ptr [esp+0C0h+var_60+4], eax
		fld	[esp+0C0h+var_60]
		fmulp	st(2), st
		faddp	st(1), st
		fstp	[esp+0C0h+var_98]
		mov	esi, dword ptr [esp+0C0h+var_98+4]

loc_1000AE9F:				; CODE XREF: PR_strtod+927j
		cmp	[esp+0C0h+var_7C], 0
		jnz	short loc_1000AF12
		mov	edx, esi
		and	edx, 7FF00000h
		cmp	ecx, edx
		jnz	short loc_1000AF12
		fld	st
		call	sub_100269EA
		cmp	[esp+0C0h+var_70], 0
		mov	dword ptr [esp+0C0h+var_68], eax
		fild	dword ptr [esp+0C0h+var_68]
		fsubp	st(1), st
		jnz	short loc_1000AEEC
		cmp	dword ptr [esp+0C0h+var_98], 0
		jnz	short loc_1000AEEC
		test	esi, 0FFFFFh
		jnz	short loc_1000AEEC
		fcomp	ds:dbl_10028C08
		fnstsw	ax
		test	ah, 5
		jnp	loc_1000B264
		jmp	short loc_1000AF14
; ---------------------------------------------------------------------------

loc_1000AEEC:				; CODE XREF: PR_strtod+A08j
					; PR_strtod+A0Fj ...
		fld	ds:dbl_10028C00
		fcomp	st(1)
		fnstsw	ax
		test	ah, 41h
		jz	loc_1000B262
		fcomp	ds:dbl_10028BF8
		fnstsw	ax
		test	ah, 41h
		jz	loc_1000B264
		jmp	short loc_1000AF14
; ---------------------------------------------------------------------------

loc_1000AF12:				; CODE XREF: PR_strtod+9E4j
					; PR_strtod+9F0j
		fstp	st

loc_1000AF14:				; CODE XREF: PR_strtod+8B2j
					; PR_strtod+A2Aj ...
		cmp	[esp+0C0h+Memory], 0
		mov	edi, 7
		jz	short loc_1000AF6A
		mov	eax, [esp+0C0h+Memory]
		cmp	[eax+4], edi
		jle	short loc_1000AF39
		mov	esi, ds:free
		mov	ecx, eax
		push	ecx		; Memory
		call	esi ; free
		add	esp, 4
		jmp	short loc_1000AF70
; ---------------------------------------------------------------------------

loc_1000AF39:				; CODE XREF: PR_strtod+A67j
		mov	edx, dword_10030BB0
		push	edx
		call	PR_Lock
		mov	ecx, [esp+0C4h+Memory]
		mov	eax, [ecx+4]
		mov	edx, dword_10030BBC[eax*4]
		mov	[ecx], edx
		mov	dword_10030BBC[eax*4], ecx
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8

loc_1000AF6A:				; CODE XREF: PR_strtod+A5Ej
		mov	esi, ds:free

loc_1000AF70:				; CODE XREF: PR_strtod+A77j
		mov	eax, [esp+0C0h+var_88]
		test	eax, eax
		jz	short loc_1000AFB8
		cmp	[eax+4], edi
		jle	short loc_1000AF87
		mov	ecx, eax
		push	ecx		; Memory
		call	esi ; free
		add	esp, 4
		jmp	short loc_1000AFB8
; ---------------------------------------------------------------------------

loc_1000AF87:				; CODE XREF: PR_strtod+ABBj
		mov	edx, dword_10030BB0
		push	edx
		call	PR_Lock
		mov	ecx, [esp+0C4h+var_88]
		mov	eax, [ecx+4]
		mov	edx, dword_10030BBC[eax*4]
		mov	[ecx], edx
		mov	dword_10030BBC[eax*4], ecx
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8

loc_1000AFB8:				; CODE XREF: PR_strtod+AB6j
					; PR_strtod+AC5j
		mov	ecx, [esp+0C0h+var_84]
		cmp	[ecx+4], edi
		jle	short loc_1000AFCB
		mov	edx, ecx
		push	edx		; Memory
		call	esi ; free
		add	esp, 4
		jmp	short loc_1000AFFB
; ---------------------------------------------------------------------------

loc_1000AFCB:				; CODE XREF: PR_strtod+AFFj
		mov	eax, dword_10030BB0
		push	eax
		call	PR_Lock
		mov	ecx, [esp+0C4h+var_84]
		mov	eax, [ecx+4]
		mov	edx, dword_10030BBC[eax*4]
		mov	[ecx], edx
		mov	dword_10030BBC[eax*4], ecx
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8

loc_1000AFFB:				; CODE XREF: PR_strtod+B09j
		cmp	[ebx+4], edi
		jle	short loc_1000B016
		push	ebx		; Memory
		call	esi ; free
		mov	esi, [esp+0C4h+var_78]
		mov	edi, [esp+0C4h+var_40]
		add	esp, 4
		jmp	loc_1000A9F0
; ---------------------------------------------------------------------------

loc_1000B016:				; CODE XREF: PR_strtod+B3Ej
		mov	ecx, dword_10030BB0
		push	ecx
		call	PR_Lock
		mov	eax, [ebx+4]
		mov	edx, dword_10030BBC[eax*4]
		mov	[ebx], edx
		mov	dword_10030BBC[eax*4], ebx
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	esi, [esp+0C8h+var_78]
		mov	edi, [esp+0C8h+var_40]
		add	esp, 8
		jmp	loc_1000A9F0
; ---------------------------------------------------------------------------

loc_1000B053:				; CODE XREF: PR_strtod+742j
		test	esi, esi
		jnz	short loc_1000B0A5
		cmp	dword ptr [esp+0C0h+var_98], esi
		jnz	short loc_1000B0A5
		mov	esi, dword ptr [esp+0C0h+var_98+4]
		test	esi, 0FFFFFh
		jnz	short loc_1000B0A5
		mov	ecx, esi
		and	ecx, 7FF00000h
		cmp	ecx, 6B00000h
		jbe	short loc_1000B0A5
		cmp	dword ptr [ebx+14h], 0
		jnz	short loc_1000B085
		cmp	dword ptr [ebx+10h], 1
		jle	short loc_1000B0A5

loc_1000B085:				; CODE XREF: PR_strtod+BBDj
		push	1		; int
		push	ebx		; Memory
		call	sub_10009EC0
		mov	edx, eax
		add	esp, 8
		mov	eax, edi
		mov	[esp+0C0h+var_74], edx
		call	sub_10009FD0
		test	eax, eax
		jg	loc_1000B173

loc_1000B0A5:				; CODE XREF: PR_strtod+B95j
					; PR_strtod+B9Bj ...
		cmp	[esp+0C0h+var_7C], 0
		jz	loc_1000B264
		mov	dword ptr [esp+0C0h+var_48+4], 39500000h
		mov	dword ptr [esp+0C0h+var_48], 0
		fld	[esp+0C0h+var_48]
		fmul	[esp+0C0h+var_98]
		fstp	[esp+0C0h+var_98]
		cmp	dword ptr [esp+0C0h+var_98+4], 0
		jnz	loc_1000B264
		cmp	dword ptr [esp+0C0h+var_98], 0
		jnz	loc_1000B264
		push	0
		push	0FFFFE8B8h
		call	PR_SetError
		add	esp, 8
		jmp	loc_1000B264
; ---------------------------------------------------------------------------

loc_1000B0F6:				; CODE XREF: PR_strtod+71Fj
		mov	esi, [esp+0C0h+var_70]

loc_1000B0FA:				; CODE XREF: PR_strtod+748j
		test	esi, esi
		jz	short loc_1000B160
		mov	edx, dword ptr [esp+0C0h+var_98+4]
		mov	eax, edx
		and	eax, 0FFFFFh
		cmp	eax, 0FFFFFh
		jnz	loc_1000B1B6
		cmp	[esp+0C0h+var_7C], 0
		jz	short loc_1000B13A
		mov	eax, edx
		and	eax, 7FF00000h
		cmp	eax, 6A00000h
		ja	short loc_1000B13A
		shr	eax, 14h
		mov	ecx, 6Bh
		sub	ecx, eax
		or	eax, 0FFFFFFFFh
		shl	eax, cl
		jmp	short loc_1000B13D
; ---------------------------------------------------------------------------

loc_1000B13A:				; CODE XREF: PR_strtod+C59j
					; PR_strtod+C67j
		or	eax, 0FFFFFFFFh

loc_1000B13D:				; CODE XREF: PR_strtod+C78j
		cmp	dword ptr [esp+0C0h+var_98], eax
		jnz	short loc_1000B1B6
		and	edx, 7FF00000h
		add	edx, 100000h
		mov	dword ptr [esp+0C0h+var_98+4], edx
		mov	dword ptr [esp+0C0h+var_98], 0
		jmp	loc_1000B0A5
; ---------------------------------------------------------------------------

loc_1000B160:				; CODE XREF: PR_strtod+C3Cj
		mov	esi, dword ptr [esp+0C0h+var_98+4]
		test	esi, 0FFFFFh
		jnz	short loc_1000B1B6
		cmp	dword ptr [esp+0C0h+var_98], 0
		jnz	short loc_1000B1B6

loc_1000B173:				; CODE XREF: PR_strtod+BDFj
		cmp	[esp+0C0h+var_7C], 0
		jz	short loc_1000B198
		mov	eax, esi
		and	eax, 7FF00000h
		cmp	eax, 6B00000h
		jg	short loc_1000B198
		cmp	eax, 3700000h
		jg	loc_1000B0A5
		jmp	loc_1000AD90
; ---------------------------------------------------------------------------

loc_1000B198:				; CODE XREF: PR_strtod+CB8j
					; PR_strtod+CC6j
		and	esi, 7FF00000h
		dec	esi
		or	esi, 0FFFFFh
		mov	dword ptr [esp+0C0h+var_98+4], esi
		mov	dword ptr [esp+0C0h+var_98], 0FFFFFFFFh
		jmp	loc_1000B0A5
; ---------------------------------------------------------------------------

loc_1000B1B6:				; CODE XREF: PR_strtod+C4Ej
					; PR_strtod+C81j ...
		test	byte ptr [esp+0C0h+var_98], 1
		jz	loc_1000B0A5
		fld	[esp+0C0h+var_98]
		xor	eax, eax
		fst	[esp+0C0h+var_50]
		mov	dword ptr [esp+0C0h+var_60], eax
		cmp	[esp+0C0h+var_70], eax
		jz	short loc_1000B1F6
		mov	ecx, dword ptr [esp+0C0h+var_50+4]
		and	ecx, 7FF00000h
		sub	ecx, 3400000h
		mov	dword ptr [esp+0C0h+var_60+4], ecx
		fadd	[esp+0C0h+var_60]
		fstp	[esp+0C0h+var_98]
		jmp	loc_1000B0A5
; ---------------------------------------------------------------------------

loc_1000B1F6:				; CODE XREF: PR_strtod+D13j
		mov	edx, dword ptr [esp+0C0h+var_50+4]
		and	edx, 7FF00000h
		sub	edx, 3400000h
		mov	dword ptr [esp+0C0h+var_60+4], edx
		fsub	[esp+0C0h+var_60]
		fst	[esp+0C0h+var_98]
		fldz
		fucompp
		fnstsw	ax
		test	ah, 44h
		jp	loc_1000B0A5
		jmp	loc_1000AD90
; ---------------------------------------------------------------------------

loc_1000B226:				; CODE XREF: PR_strtod+47Ej
		fstp	st
		fstp	st
		jmp	loc_1000AD94
; ---------------------------------------------------------------------------

loc_1000B22F:				; CODE XREF: PR_strtod+3DAj
		fstp	st
		jmp	short loc_1000B237
; ---------------------------------------------------------------------------

loc_1000B233:				; CODE XREF: PR_strtod+8A0j
		mov	esi, [esp+0C0h+var_8C]

loc_1000B237:				; CODE XREF: PR_strtod+42Bj
					; PR_strtod+D71j
		push	0
		push	0FFFFE8B8h
		call	PR_SetError
		add	esp, 8
		cmp	[esp+0C0h+var_78], 0
		mov	dword ptr [esp+0C0h+var_98+4], 7FF00000h
		mov	dword ptr [esp+0C0h+var_98], 0
		jnz	short loc_1000B268
		jmp	loc_1000B3DF
; ---------------------------------------------------------------------------

loc_1000B262:				; CODE XREF: PR_strtod+A39j
		fstp	st

loc_1000B264:				; CODE XREF: PR_strtod+A24j
					; PR_strtod+A4Aj ...
		mov	esi, [esp+0C0h+var_8C]

loc_1000B268:				; CODE XREF: PR_strtod+8EEj
					; PR_strtod+D9Bj
		mov	eax, [esp+0C0h+Memory]
		mov	ebx, [esp+0C0h+var_78]
		test	eax, eax
		jz	short loc_1000B2B9
		cmp	dword ptr [eax+4], 7
		jle	short loc_1000B288
		mov	edi, ds:free
		push	eax		; Memory
		call	edi ; free
		add	esp, 4
		jmp	short loc_1000B2BF
; ---------------------------------------------------------------------------

loc_1000B288:				; CODE XREF: PR_strtod+DB8j
		mov	ecx, dword_10030BB0
		push	ecx
		call	PR_Lock
		mov	ecx, [esp+0C4h+Memory]
		mov	eax, [ecx+4]
		mov	edx, dword_10030BBC[eax*4]
		mov	[ecx], edx
		mov	dword_10030BBC[eax*4], ecx
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8

loc_1000B2B9:				; CODE XREF: PR_strtod+DB2j
		mov	edi, ds:free

loc_1000B2BF:				; CODE XREF: PR_strtod+DC6j
		mov	eax, [esp+0C0h+var_88]
		test	eax, eax
		jz	short loc_1000B308
		cmp	dword ptr [eax+4], 7
		jle	short loc_1000B2D7
		mov	ecx, eax
		push	ecx		; Memory
		call	edi ; free
		add	esp, 4
		jmp	short loc_1000B308
; ---------------------------------------------------------------------------

loc_1000B2D7:				; CODE XREF: PR_strtod+E0Bj
		mov	edx, dword_10030BB0
		push	edx
		call	PR_Lock
		mov	ecx, [esp+0C4h+var_88]
		mov	eax, [ecx+4]
		mov	edx, dword_10030BBC[eax*4]
		mov	[ecx], edx
		mov	dword_10030BBC[eax*4], ecx
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8

loc_1000B308:				; CODE XREF: PR_strtod+E05j
					; PR_strtod+E15j
		mov	eax, [esp+0C0h+var_84]
		test	eax, eax
		jz	short loc_1000B351
		cmp	dword ptr [eax+4], 7
		jle	short loc_1000B320
		mov	ecx, eax
		push	ecx		; Memory
		call	edi ; free
		add	esp, 4
		jmp	short loc_1000B351
; ---------------------------------------------------------------------------

loc_1000B320:				; CODE XREF: PR_strtod+E54j
		mov	edx, dword_10030BB0
		push	edx
		call	PR_Lock
		mov	ecx, [esp+0C4h+var_84]
		mov	eax, [ecx+4]
		mov	edx, dword_10030BBC[eax*4]
		mov	[ecx], edx
		mov	dword_10030BBC[eax*4], ecx
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8

loc_1000B351:				; CODE XREF: PR_strtod+E4Ej
					; PR_strtod+E5Ej
		test	ebx, ebx
		jz	short loc_1000B390
		cmp	dword ptr [ebx+4], 7
		jle	short loc_1000B363
		push	ebx		; Memory
		call	edi ; free
		add	esp, 4
		jmp	short loc_1000B390
; ---------------------------------------------------------------------------

loc_1000B363:				; CODE XREF: PR_strtod+E99j
		mov	ecx, dword_10030BB0
		push	ecx
		call	PR_Lock
		mov	eax, [ebx+4]
		mov	edx, dword_10030BBC[eax*4]
		mov	[ebx], edx
		mov	dword_10030BBC[eax*4], ebx
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8

loc_1000B390:				; CODE XREF: PR_strtod+E93j
					; PR_strtod+EA1j
		mov	eax, [esp+0C0h+var_74]
		test	eax, eax
		jz	short loc_1000B3DF
		cmp	dword ptr [eax+4], 7
		jle	short loc_1000B3A8
		mov	ecx, eax
		push	ecx		; Memory
		call	edi ; free
		add	esp, 4
		jmp	short loc_1000B3DF
; ---------------------------------------------------------------------------

loc_1000B3A8:				; CODE XREF: PR_strtod+EDCj
		mov	edx, dword_10030BB0
		push	edx
		call	PR_Lock
		mov	ecx, [esp+0C4h+var_74]
		mov	eax, [ecx+4]
		mov	edx, dword_10030BBC[eax*4]
		mov	[ecx], edx
		mov	dword_10030BBC[eax*4], ecx
		mov	eax, dword_10030BB0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		jmp	short loc_1000B3DF
; ---------------------------------------------------------------------------

loc_1000B3DB:				; CODE XREF: PR_strtod+33Cj
		fstp	st

loc_1000B3DD:				; CODE XREF: PR_strtod+79j
		fstp	st

loc_1000B3DF:				; CODE XREF: PR_strtod+CEj
					; PR_strtod+2B5j ...
		mov	eax, [ebp+arg_4]
		test	eax, eax
		jz	short loc_1000B3E8
		mov	[eax], esi

loc_1000B3E8:				; CODE XREF: PR_strtod+F24j
		cmp	[esp+0C0h+var_54], 0
		fld	[esp+0C0h+var_98]
		jz	short loc_1000B3F5
		fchs

loc_1000B3F5:				; CODE XREF: PR_strtod+F31j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
PR_strtod	endp

; ---------------------------------------------------------------------------
off_1000B3FC	dd offset loc_1000A581	; DATA XREF: PR_strtod+48r
		dd offset loc_1000A50F	; jump table for switch	statement
		dd offset loc_1000A578
		dd offset loc_1000A570
		dd offset loc_1000A519
byte_1000B410	db	0,     4,     4,     4 ; DATA XREF: PR_strtod:loc_1000A501r
		db	4,     4,     4,     4 ; indirect table	for switch statement
		db	4,     1,     1,     1
		db	1,     1,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	1,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     2
		db	4,     3
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B440	proc near		; CODE XREF: sub_1000B720+A01p
					; sub_1000B720+BFDp

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		mov	eax, [ecx+10h]
		sub	esp, 14h
		push	esi
		mov	esi, [esp+18h+arg_0]
		cmp	[esi+10h], eax
		jge	short loc_1000B45B
		xor	eax, eax
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1000B45B:				; CODE XREF: sub_1000B440+12j
		dec	eax
		push	ebx
		mov	[esp+1Ch+var_10], eax
		add	eax, eax
		add	eax, eax
		mov	ebx, [eax+ecx+14h]
		push	ebp
		lea	edx, [eax+ecx+14h]
		push	edi
		lea	edi, [esi+14h]
		add	eax, edi
		mov	[esp+24h+var_8], edx
		mov	[esp+24h+var_4], eax
		mov	eax, [eax]
		xor	edx, edx
		inc	ebx
		div	ebx
		xor	ebp, ebp
		mov	edx, eax
		mov	[esp+24h+var_C], edx
		cmp	edx, ebp
		jz	loc_1000B53D
		mov	ebx, edi
		sub	ebx, esi
		mov	[esp+24h+var_14], ebp
		add	ebx, ecx
		jmp	short loc_1000B4A4
; ---------------------------------------------------------------------------
		align 10h

loc_1000B4A0:				; CODE XREF: sub_1000B440+BDj
		mov	edx, [esp+24h+var_C]

loc_1000B4A4:				; CODE XREF: sub_1000B440+5Dj
		mov	eax, [ebx]
		movzx	ecx, ax
		imul	ecx, edx
		add	ecx, ebp
		shr	eax, 10h
		imul	eax, edx
		mov	edx, ecx
		shr	edx, 10h
		add	eax, edx
		mov	edx, [edi]
		movzx	ecx, cx
		movzx	esi, dx
		sub	esi, ecx
		sub	esi, [esp+24h+var_14]
		mov	ebp, eax
		mov	ecx, esi
		shr	ecx, 10h
		and	ecx, 1
		shr	edx, 10h
		sub	edx, ecx
		movzx	eax, ax
		sub	edx, eax
		mov	ecx, edx
		shr	ecx, 10h
		and	ecx, 1
		mov	[edi+2], dx
		mov	[edi], si
		add	ebx, 4
		shr	ebp, 10h
		add	edi, 4
		mov	[esp+24h+var_14], ecx
		cmp	ebx, [esp+24h+var_8]
		jbe	short loc_1000B4A0
		mov	eax, [esp+24h+var_4]
		cmp	dword ptr [eax], 0
		jnz	short loc_1000B535
		mov	ecx, [esp+24h+arg_0]
		sub	eax, 4
		add	ecx, 14h
		cmp	eax, ecx
		jbe	short loc_1000B526

loc_1000B516:				; CODE XREF: sub_1000B440+E4j
		cmp	dword ptr [eax], 0
		jnz	short loc_1000B526
		dec	[esp+24h+var_10]
		sub	eax, 4
		cmp	eax, ecx
		ja	short loc_1000B516

loc_1000B526:				; CODE XREF: sub_1000B440+D4j
					; sub_1000B440+D9j
		mov	eax, [esp+24h+arg_0]
		mov	edx, [esp+24h+var_10]
		mov	[eax+10h], edx
		mov	esi, eax
		jmp	short loc_1000B539
; ---------------------------------------------------------------------------

loc_1000B535:				; CODE XREF: sub_1000B440+C6j
		mov	esi, [esp+24h+arg_0]

loc_1000B539:				; CODE XREF: sub_1000B440+F3j
		mov	ecx, [esp+24h+arg_4]

loc_1000B53D:				; CODE XREF: sub_1000B440+4Dj
		mov	eax, ecx
		mov	edx, esi
		call	sub_10009FD0
		test	eax, eax
		js	loc_1000B5E7
		inc	[esp+24h+var_C]
		lea	edi, [esi+14h]
		mov	ebx, edi
		xor	ebp, ebp
		sub	ebx, esi
		add	ebx, [esp+24h+arg_4]
		mov	[esp+24h+var_14], ebp

loc_1000B563:				; CODE XREF: sub_1000B440+176j
		mov	eax, [ebx]
		movzx	esi, ax
		add	esi, ebp
		mov	ecx, esi
		shr	ecx, 10h
		shr	eax, 10h
		add	ecx, eax
		mov	eax, [edi]
		movzx	edx, ax
		movzx	esi, si
		sub	edx, esi
		sub	edx, [esp+24h+var_14]
		mov	ebp, ecx
		mov	esi, edx
		shr	esi, 10h
		movzx	ecx, cx
		shr	eax, 10h
		and	esi, 1
		sub	eax, esi
		sub	eax, ecx
		mov	ecx, eax
		shr	ecx, 10h
		and	ecx, 1
		mov	[edi+2], ax
		mov	[edi], dx
		add	ebx, 4
		shr	ebp, 10h
		add	edi, 4
		mov	[esp+24h+var_14], ecx
		cmp	ebx, [esp+24h+var_8]
		jbe	short loc_1000B563
		mov	ecx, [esp+24h+arg_0]
		mov	edx, [esp+24h+var_10]
		add	ecx, 14h
		cmp	dword ptr [ecx+edx*4], 0
		lea	eax, [ecx+edx*4]
		jnz	short loc_1000B5E7
		sub	eax, 4
		cmp	eax, ecx
		jbe	short loc_1000B5E0

loc_1000B5D3:				; CODE XREF: sub_1000B440+19Ej
		cmp	dword ptr [eax], 0
		jnz	short loc_1000B5E0
		sub	eax, 4
		dec	edx
		cmp	eax, ecx
		ja	short loc_1000B5D3

loc_1000B5E0:				; CODE XREF: sub_1000B440+191j
					; sub_1000B440+196j
		mov	eax, [esp+24h+arg_0]
		mov	[eax+10h], edx

loc_1000B5E7:				; CODE XREF: sub_1000B440+108j
					; sub_1000B440+18Aj
		mov	eax, [esp+24h+var_C]
		pop	edi
		pop	ebp
		pop	ebx
		pop	esi
		add	esp, 14h
		retn
sub_1000B440	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000B600	proc near		; CODE XREF: sub_1000B720+6Ap
					; sub_1000B720+A1p ...
		push	esi
		xor	esi, esi
		push	edi
		mov	eax, 4
		cmp	ecx, 14h
		jb	short loc_1000B61A
		mov	edi, edi

loc_1000B610:				; CODE XREF: sub_1000B600+18j
		add	eax, eax
		lea	edx, [eax+10h]
		inc	esi
		cmp	edx, ecx
		jbe	short loc_1000B610

loc_1000B61A:				; CODE XREF: sub_1000B600+Cj
		mov	eax, dword_10030BB0
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	esi, 7
		jg	short loc_1000B643
		mov	edi, dword_10030BBC[esi*4]
		test	edi, edi
		jz	short loc_1000B643
		mov	ecx, [edi]
		mov	dword_10030BBC[esi*4], ecx
		jmp	short loc_1000B69B
; ---------------------------------------------------------------------------

loc_1000B643:				; CODE XREF: sub_1000B600+2Bj
					; sub_1000B600+36j
		push	ebx
		mov	ebx, 1
		mov	ecx, esi
		shl	ebx, cl
		lea	eax, ds:1Bh[ebx*4]
		shr	eax, 3
		cmp	esi, 7
		jg	short loc_1000B681
		mov	edi, off_10030290
		mov	edx, edi
		sub	edx, offset dword_10030BE0
		sar	edx, 3
		add	edx, eax
		cmp	edx, 120h
		ja	short loc_1000B681
		lea	eax, [edi+eax*8]
		mov	off_10030290, eax
		jmp	short loc_1000B694
; ---------------------------------------------------------------------------

loc_1000B681:				; CODE XREF: sub_1000B600+5Aj
					; sub_1000B600+75j
		lea	ecx, ds:0[eax*8]
		push	ecx		; Size
		call	ds:malloc
		add	esp, 4
		mov	edi, eax

loc_1000B694:				; CODE XREF: sub_1000B600+7Fj
		mov	[edi+8], ebx
		mov	[edi+4], esi
		pop	ebx

loc_1000B69B:				; CODE XREF: sub_1000B600+41j
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	[edi], esi
		mov	dword ptr [edi+10h], 0
		mov	dword ptr [edi+0Ch], 0
		lea	eax, [edi+4]
		pop	edi
		pop	esi
		retn
sub_1000B600	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000B6C0	proc near		; CODE XREF: PR_dtoa+86p PR_dtoa+ACp
		mov	ecx, [eax-4]
		push	esi
		lea	esi, [eax-4]
		mov	eax, 1
		shl	eax, cl
		mov	[esi+4], ecx
		mov	[esi+8], eax
		cmp	ecx, 7
		jle	short loc_1000B6E5
		push	esi		; Memory
		call	ds:free
		add	esp, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000B6E5:				; CODE XREF: sub_1000B6C0+17j
		mov	ecx, dword_10030BB0
		push	ecx
		call	PR_Lock
		mov	edx, [esi+4]
		mov	eax, dword_10030BBC[edx*4]
		mov	[esi], eax
		mov	ecx, edx
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		mov	dword_10030BBC[ecx*4], esi
		call	PR_Unlock
		add	esp, 8
		pop	esi
		retn
sub_1000B6C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000B720(void	*Memory, int, int, int,	int, int)
sub_1000B720	proc near		; CODE XREF: PR_dtoa+3Fp

var_70		= qword	ptr -70h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= qword	ptr -34h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= qword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= qword	ptr -8
Memory		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 54h
		fld	qword ptr [esp+54h+Memory]
		mov	ecx, [esp+54h+arg_10]
		push	ebx
		fst	[esp+58h+var_8]
		mov	ebx, [esp+58h+arg_14]
		push	esi
		push	edi
		mov	edi, dword ptr [esp+60h+var_8+4]
		test	edi, edi
		jns	short loc_1000B756
		and	edi, 7FFFFFFFh
		fstp	st
		mov	dword ptr [esp+60h+var_8+4], edi
		fld	[esp+60h+var_8]
		mov	dword ptr [eax], 1
		jmp	short loc_1000B75C
; ---------------------------------------------------------------------------

loc_1000B756:				; CODE XREF: sub_1000B720+1Cj
		mov	dword ptr [eax], 0

loc_1000B75C:				; CODE XREF: sub_1000B720+34j
		mov	eax, edi
		and	eax, 7FF00000h
		cmp	eax, 7FF00000h
		jnz	loc_1000B7EE
		cmp	dword ptr [esp+60h+var_8], 0
		fstp	st
		mov	dword ptr [ecx], 270Fh
		jnz	short loc_1000B7BC
		test	edi, 0FFFFFh
		jnz	short loc_1000B7BC
		mov	ecx, 8
		call	sub_1000B600
		mov	esi, offset aInfinity ;	"Infinity"
		mov	ecx, eax
		mov	byte ptr [eax],	49h
		sub	esi, eax
		jmp	short loc_1000B7A0
; ---------------------------------------------------------------------------
		align 10h

loc_1000B7A0:				; CODE XREF: sub_1000B720+7Bj
					; sub_1000B720+89j
		mov	dl, [esi+ecx+1]
		inc	ecx
		mov	[ecx], dl
		test	dl, dl
		jnz	short loc_1000B7A0
		test	ebx, ebx
		jz	loc_1000C491
		pop	edi
		pop	esi
		mov	[ebx], ecx
		pop	ebx
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_1000B7BC:				; CODE XREF: sub_1000B720+5Bj
					; sub_1000B720+63j
		mov	ecx, 3
		call	sub_1000B600
		mov	esi, offset dword_10028C60
		mov	ecx, eax
		mov	byte ptr [eax],	4Eh
		sub	esi, eax

loc_1000B7D2:				; CODE XREF: sub_1000B720+BBj
		mov	dl, [esi+ecx+1]
		inc	ecx
		mov	[ecx], dl
		test	dl, dl
		jnz	short loc_1000B7D2
		test	ebx, ebx
		jz	loc_1000C491
		pop	edi
		pop	esi
		mov	[ebx], ecx
		pop	ebx
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_1000B7EE:				; CODE XREF: sub_1000B720+48j
		fld	st
		fldz
		fucompp
		fnstsw	ax
		test	ah, 44h
		jp	short loc_1000B83C
		mov	dword ptr [ecx], 1
		fstp	st
		mov	ecx, 1
		call	sub_1000B600
		mov	esi, offset a0	; "0"
		mov	ecx, eax
		mov	byte ptr [eax],	30h
		sub	esi, eax
		lea	esp, [esp+0]

loc_1000B820:				; CODE XREF: sub_1000B720+109j
		mov	dl, [esi+ecx+1]
		inc	ecx
		mov	[ecx], dl
		test	dl, dl
		jnz	short loc_1000B820
		test	ebx, ebx
		jz	loc_1000C491
		pop	edi
		pop	esi
		mov	[ebx], ecx
		pop	ebx
		add	esp, 54h
		retn
; ---------------------------------------------------------------------------

loc_1000B83C:				; CODE XREF: sub_1000B720+D9j
		lea	ecx, [esp+60h+var_C]
		push	ecx		; int
		lea	edx, [esp+64h+var_14]
		push	edx		; int
		sub	esp, 8
		fstp	[esp+70h+var_70] ; double
		call	sub_1000A350
		mov	ebx, [esp+70h+var_C]
		mov	esi, edi
		shr	esi, 14h
		add	esp, 10h
		and	esi, 7FFh
		mov	[esp+60h+Memory], eax
		jz	short loc_1000B891
		fld	[esp+60h+var_8]
		sub	esi, 3FFh
		fstp	[esp+60h+var_1C]
		mov	eax, dword ptr [esp+60h+var_1C+4]
		and	eax, 0FFFFFh
		or	eax, 3FF00000h
		xor	edi, edi
		mov	dword ptr [esp+60h+var_1C+4], eax
		mov	[esp+60h+var_10], edi
		jmp	short loc_1000B8F4
; ---------------------------------------------------------------------------

loc_1000B891:				; CODE XREF: sub_1000B720+147j
		mov	ecx, [esp+60h+var_14]
		lea	esi, [ecx+ebx+432h]
		cmp	esi, 20h
		jle	short loc_1000B8B9
		mov	edx, dword ptr [esp+60h+var_8]
		mov	ecx, 40h
		sub	ecx, esi
		mov	eax, edi
		shl	eax, cl
		lea	ecx, [esi-20h]
		shr	edx, cl
		or	eax, edx
		jmp	short loc_1000B8C6
; ---------------------------------------------------------------------------

loc_1000B8B9:				; CODE XREF: sub_1000B720+17Fj
		mov	eax, dword ptr [esp+60h+var_8]
		mov	ecx, 20h
		sub	ecx, esi
		shl	eax, cl

loc_1000B8C6:				; CODE XREF: sub_1000B720+197j
		mov	[esp+60h+var_10], eax
		fild	[esp+60h+var_10]
		test	eax, eax
		jns	short loc_1000B8D8
		fadd	ds:dbl_10028800

loc_1000B8D8:				; CODE XREF: sub_1000B720+1B0j
		fstp	[esp+60h+var_1C]
		sub	esi, 433h
		sub	dword ptr [esp+60h+var_1C+4], 1F00000h
		mov	[esp+60h+var_10], 1
		xor	edi, edi

loc_1000B8F4:				; CODE XREF: sub_1000B720+16Fj
		fld	[esp+60h+var_1C]
		mov	[esp+60h+var_38], esi
		fsub	ds:dbl_10028C58
		push	ebp
		fmul	ds:dbl_10028C50
		fadd	ds:dbl_10028C48
		fild	[esp+64h+var_38]
		fmul	ds:dbl_10028C40
		faddp	st(1), st
		fld	st
		call	sub_100269EA
		fldz
		fcomp	st(1)
		mov	ebp, eax
		mov	[esp+64h+var_50], ebp
		fnstsw	ax
		test	ah, 41h
		jnz	short loc_1000B94D
		fild	[esp+64h+var_50]
		fucompp
		fnstsw	ax
		test	ah, 44h
		jnp	short loc_1000B94F
		mov	ecx, 1
		sub	ebp, ecx
		mov	[esp+64h+var_50], ebp
		jmp	short loc_1000B954
; ---------------------------------------------------------------------------

loc_1000B94D:				; CODE XREF: sub_1000B720+211j
		fstp	st

loc_1000B94F:				; CODE XREF: sub_1000B720+21Ej
		mov	ecx, 1

loc_1000B954:				; CODE XREF: sub_1000B720+22Bj
		mov	dword ptr [esp+64h+var_1C], ecx
		cmp	ebp, 16h
		ja	short loc_1000B979
		fld	ds:dbl_10028AF0[ebp*8]
		fcomp	[esp+64h+var_8]
		fnstsw	ax
		test	ah, 41h
		jnz	short loc_1000B975
		sub	ebp, ecx
		mov	[esp+64h+var_50], ebp

loc_1000B975:				; CODE XREF: sub_1000B720+24Dj
		mov	dword ptr [esp+64h+var_1C], edi

loc_1000B979:				; CODE XREF: sub_1000B720+23Bj
		mov	eax, ebx
		sub	eax, esi
		sub	eax, ecx
		js	short loc_1000B987
		mov	[esp+64h+var_4C], edi
		jmp	short loc_1000B98F
; ---------------------------------------------------------------------------

loc_1000B987:				; CODE XREF: sub_1000B720+25Fj
		neg	eax
		mov	[esp+64h+var_4C], eax
		xor	eax, eax

loc_1000B98F:				; CODE XREF: sub_1000B720+265j
		mov	[esp+64h+var_40], eax
		cmp	ebp, edi
		jl	short loc_1000B9A7
		add	eax, ebp
		mov	[esp+64h+var_24], edi
		mov	[esp+64h+var_20], ebp
		mov	[esp+64h+var_40], eax
		jmp	short loc_1000B9B7
; ---------------------------------------------------------------------------

loc_1000B9A7:				; CODE XREF: sub_1000B720+275j
		sub	[esp+64h+var_4C], ebp
		mov	eax, ebp
		neg	eax
		mov	[esp+64h+var_24], eax
		mov	[esp+64h+var_20], edi

loc_1000B9B7:				; CODE XREF: sub_1000B720+285j
		mov	eax, [esp+64h+arg_8]
		cmp	eax, edi
		jl	short loc_1000B9C4
		cmp	eax, 9
		jle	short loc_1000B9CA

loc_1000B9C4:				; CODE XREF: sub_1000B720+29Dj
		mov	[esp+64h+arg_8], edi
		mov	eax, edi

loc_1000B9CA:				; CODE XREF: sub_1000B720+2A2j
		mov	dword ptr [esp+64h+var_34], ecx
		cmp	eax, 5
		jle	short loc_1000B9DE
		sub	eax, 4
		mov	[esp+64h+arg_8], eax
		mov	dword ptr [esp+64h+var_34], edi

loc_1000B9DE:				; CODE XREF: sub_1000B720+2B1j
		or	ebx, 0FFFFFFFFh
		mov	[esp+64h+var_3C], ecx
		cmp	eax, 5		; switch 6 cases
		ja	short loc_1000BA4E ; jumptable 1000B9EA	default	case
		jmp	ds:off_1000C498[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000B9F1:				; CODE XREF: sub_1000B720+2CAj
					; DATA XREF: .text:off_1000C498o
		mov	[esp+64h+var_28], ebx ;	jumptable 1000B9EA cases 0,1
		mov	[esp+64h+var_48], ebx
		mov	esi, 12h
		mov	[esp+64h+arg_C], 0
		jmp	short loc_1000BA52
; ---------------------------------------------------------------------------

loc_1000BA08:				; CODE XREF: sub_1000B720+2CAj
					; DATA XREF: .text:off_1000C498o
		mov	[esp+64h+var_3C], edi ;	jumptable 1000B9EA case	2

loc_1000BA0C:				; CODE XREF: sub_1000B720+2CAj
					; DATA XREF: .text:off_1000C498o
		cmp	[esp+64h+arg_C], edi ; jumptable 1000B9EA case 4
		jg	short loc_1000BA1A
		mov	[esp+64h+arg_C], 1

loc_1000BA1A:				; CODE XREF: sub_1000B720+2F0j
		mov	esi, [esp+64h+arg_C]
		mov	ebx, esi
		mov	[esp+64h+var_28], esi
		mov	[esp+64h+var_48], ebx
		jmp	short loc_1000BA52
; ---------------------------------------------------------------------------

loc_1000BA2A:				; CODE XREF: sub_1000B720+2CAj
					; DATA XREF: .text:off_1000C498o
		mov	[esp+64h+var_3C], edi ;	jumptable 1000B9EA case	3

loc_1000BA2E:				; CODE XREF: sub_1000B720+2CAj
					; DATA XREF: .text:off_1000C498o
		mov	eax, [esp+64h+arg_C] ; jumptable 1000B9EA case 5
		lea	esi, [eax+ebp+1]
		mov	ebx, esi
		lea	ecx, [esi-1]
		mov	[esp+64h+var_48], ebx
		mov	[esp+64h+var_28], ecx
		test	esi, esi
		jg	short loc_1000BA52
		mov	esi, 1
		jmp	short loc_1000BA52
; ---------------------------------------------------------------------------

loc_1000BA4E:				; CODE XREF: sub_1000B720+2C8j
		mov	ebx, [esp+64h+var_48] ;	jumptable 1000B9EA default case

loc_1000BA52:				; CODE XREF: sub_1000B720+2E6j
					; sub_1000B720+308j ...
		mov	ecx, esi
		call	sub_1000B600
		fld	ds:dbl_10028C38
		fld	ds:dbl_10028C30
		mov	[esp+64h+var_2C], eax
		mov	edi, eax
		cmp	ebx, 0Eh
		ja	loc_1000BCFD
		cmp	dword ptr [esp+64h+var_34], 0
		jz	loc_1000BCFD
		fld	[esp+64h+var_8]
		mov	edx, 2
		fld	st
		mov	[esp+64h+var_38], ebp
		mov	[esp+64h+var_48], ebx
		mov	dword ptr [esp+64h+var_34], edx
		mov	eax, ebp
		test	ebp, ebp
		jle	short loc_1000BAE4
		and	eax, 0Fh
		fld	ds:dbl_10028AF0[eax*8]
		mov	eax, ebp
		sar	eax, 4
		test	al, 10h
		jz	short loc_1000BAC5
		fxch	st(2)
		mov	edx, 3
		fdiv	ds:dbl_10028BC8
		and	eax, 0Fh
		mov	dword ptr [esp+64h+var_34], edx
		fxch	st(2)

loc_1000BAC5:				; CODE XREF: sub_1000B720+38Dj
		test	eax, eax
		jz	short loc_1000BAE0
		mov	ecx, offset dbl_10028BA8

loc_1000BACE:				; CODE XREF: sub_1000B720+3BAj
		test	al, 1
		jz	short loc_1000BAD5
		fmul	qword ptr [ecx]
		inc	edx

loc_1000BAD5:				; CODE XREF: sub_1000B720+3B0j
		add	ecx, 8
		sar	eax, 1
		jnz	short loc_1000BACE
		mov	dword ptr [esp+64h+var_34], edx

loc_1000BAE0:				; CODE XREF: sub_1000B720+3A7j
		fdivp	st(2), st
		jmp	short loc_1000BB16
; ---------------------------------------------------------------------------

loc_1000BAE4:				; CODE XREF: sub_1000B720+37Aj
		neg	eax
		jz	short loc_1000BB16
		mov	ecx, eax
		and	ecx, 0Fh
		fld	ds:dbl_10028AF0[ecx*8]
		sar	eax, 4
		fmulp	st(2), st
		test	eax, eax
		jz	short loc_1000BB16
		mov	ecx, offset dbl_10028BA8

loc_1000BB02:				; CODE XREF: sub_1000B720+3F0j
		test	al, 1
		jz	short loc_1000BB0B
		fld	qword ptr [ecx]
		inc	edx
		fmulp	st(2), st

loc_1000BB0B:				; CODE XREF: sub_1000B720+3E4j
		add	ecx, 8
		sar	eax, 1
		jnz	short loc_1000BB02
		mov	dword ptr [esp+64h+var_34], edx

loc_1000BB16:				; CODE XREF: sub_1000B720+3C2j
					; sub_1000B720+3C6j ...
		cmp	dword ptr [esp+64h+var_1C], 0
		fld1
		jz	short loc_1000BB48
		fcom	st(2)
		fnstsw	ax
		test	ah, 41h
		jnz	short loc_1000BB48
		test	ebx, ebx
		jle	short loc_1000BB48
		mov	ebx, [esp+64h+var_28]
		test	ebx, ebx
		jle	loc_1000BCDF
		dec	ebp
		fxch	st(2)
		inc	edx
		fmul	st, st(4)
		mov	[esp+64h+var_50], ebp
		fxch	st(2)
		mov	dword ptr [esp+64h+var_34], edx

loc_1000BB48:				; CODE XREF: sub_1000B720+3FDj
					; sub_1000B720+406j ...
		fild	dword ptr [esp+64h+var_34]
		fmul	st, st(3)
		fadd	ds:dbl_10028C28
		fstp	[esp+64h+var_34]
		sub	dword ptr [esp+64h+var_34+4], 3400000h
		test	ebx, ebx
		jnz	short loc_1000BBA6
		fstp	st
		xor	ebp, ebp
		fxch	st(1)
		mov	[esp+64h+var_54], ebp
		fsub	st, st(2)
		fld	[esp+64h+var_34]
		fcom	st(1)
		fnstsw	ax
		test	ah, 5
		jnp	loc_1000C077
		fchs
		fcompp
		fnstsw	ax
		test	ah, 41h
		jnz	loc_1000BCE3
		fstp	st(2)
		fstp	st
		fstp	st

loc_1000BB96:				; CODE XREF: sub_1000B720+91Fj
					; sub_1000B720+940j
		or	eax, 0FFFFFFFFh
		sub	eax, [esp+64h+arg_C]
		mov	[esp+64h+var_50], eax
		jmp	loc_1000C2F1
; ---------------------------------------------------------------------------

loc_1000BBA6:				; CODE XREF: sub_1000B720+442j
		cmp	[esp+64h+var_3C], 0
		jz	loc_1000BC5C
		fld	ds:dbl_100287F8
		xor	esi, esi
		fdiv	qword ptr ds:(aPr_counterGe_1+34h)[ebx*8] ; "ame: %s"
		fsub	[esp+64h+var_34]
		fld	st(3)
		call	sub_100269EA
		mov	edi, [esp+64h+var_2C]
		mov	[esp+64h+var_44], eax
		fild	[esp+64h+var_44]
		add	al, 30h
		mov	[edi], al
		inc	edi
		fsubp	st(4), st
		fcom	st(3)
		fnstsw	ax
		test	ah, 41h
		jnz	short loc_1000BC1B
		fstp	st(3)

loc_1000BBE9:				; CODE XREF: sub_1000B720+53Aj
		fstp	st(2)
		fstp	st(3)

loc_1000BBED:				; CODE XREF: sub_1000B720+648j
		fstp	st
		fstp	st

loc_1000BBF1:				; CODE XREF: sub_1000B720+697j
					; sub_1000B720+D23j
		fstp	st

loc_1000BBF3:				; CODE XREF: sub_1000B720+5B8j
					; sub_1000B720+6B4j ...
		mov	esi, [esp+64h+Memory]
		pop	ebp
		test	esi, esi
		jz	loc_1000C475
		cmp	dword ptr [esi+4], 7
		jle	loc_1000C448
		push	esi		; Memory
		call	ds:free
		add	esp, 4
		jmp	loc_1000C475
; ---------------------------------------------------------------------------

loc_1000BC19:				; CODE XREF: sub_1000B720+536j
		fxch	st(3)

loc_1000BC1B:				; CODE XREF: sub_1000B720+4C5j
		fld	st(1)
		fsub	st, st(4)
		fcomp	st(1)
		fnstsw	ax
		test	ah, 5
		jnp	loc_1000BDE9
		inc	esi
		cmp	esi, ebx
		jge	loc_1000BCDD
		fmul	st, st(5)
		fxch	st(3)
		fmul	st, st(5)
		fld	st
		call	sub_100269EA
		mov	[esp+64h+var_44], eax
		fisub	[esp+64h+var_44]
		add	al, 30h
		mov	[edi], al
		inc	edi
		fcom	st(3)
		fnstsw	ax
		test	ah, 5
		jp	short loc_1000BC19
		fstp	st
		jmp	short loc_1000BBE9
; ---------------------------------------------------------------------------

loc_1000BC5C:				; CODE XREF: sub_1000B720+48Bj
		fstp	st
		mov	esi, 1
		fld	qword ptr ds:(aPr_counterGe_1+34h)[ebx*8] ; "ame: %s"
		fmul	[esp+64h+var_34]
		jmp	short loc_1000BC72
; ---------------------------------------------------------------------------

loc_1000BC70:				; CODE XREF: sub_1000B720+583j
		fxch	st(2)

loc_1000BC72:				; CODE XREF: sub_1000B720+54Ej
		fld	st(2)
		call	sub_100269EA
		mov	ecx, eax
		mov	[esp+64h+var_44], ecx
		fild	[esp+64h+var_44]
		fsubp	st(3), st
		fld	st(2)
		fldz
		fucompp
		fnstsw	ax
		test	ah, 44h
		jp	short loc_1000BC94
		mov	ebx, esi

loc_1000BC94:				; CODE XREF: sub_1000B720+570j
		add	cl, 30h
		mov	[edi], cl
		inc	edi
		cmp	esi, ebx
		jz	short loc_1000BCA5
		fxch	st(2)
		inc	esi
		fmul	st, st(4)
		jmp	short loc_1000BC70
; ---------------------------------------------------------------------------

loc_1000BCA5:				; CODE XREF: sub_1000B720+57Cj
		fld	st
		fld	ds:dbl_100287F8
		fadd	st(1), st
		fxch	st(1)
		fcomp	st(4)
		fnstsw	ax
		test	ah, 5
		jnp	loc_1000BDF3
		fsubrp	st(1), st
		fcomp	st(2)
		fnstsw	ax
		fstp	st(1)
		test	ah, 41h
		jnz	short loc_1000BCE3
		fstp	st(2)
		fstp	st
		fstp	st

loc_1000BCD1:				; CODE XREF: sub_1000B720+5B5j
		dec	edi
		cmp	byte ptr [edi],	30h
		jz	short loc_1000BCD1
		inc	edi
		jmp	loc_1000BBF3
; ---------------------------------------------------------------------------

loc_1000BCDD:				; CODE XREF: sub_1000B720+50Fj
		fstp	st(3)

loc_1000BCDF:				; CODE XREF: sub_1000B720+412j
		fstp	st(2)
		fstp	st(1)

loc_1000BCE3:				; CODE XREF: sub_1000B720+46Aj
					; sub_1000B720+5A9j
		mov	ebp, [esp+64h+var_38]
		fst	[esp+64h+var_8]
		mov	ebx, [esp+64h+var_48]
		mov	edi, [esp+64h+var_2C]
		mov	[esp+64h+var_50], ebp
		mov	[esp+64h+var_48], ebx
		jmp	short loc_1000BD01
; ---------------------------------------------------------------------------

loc_1000BCFD:				; CODE XREF: sub_1000B720+34Ej
					; sub_1000B720+359j
		fld	[esp+64h+var_8]

loc_1000BD01:				; CODE XREF: sub_1000B720+5DBj
		mov	eax, [esp+64h+var_14]
		xor	ecx, ecx
		cmp	eax, ecx
		jl	loc_1000BE31
		cmp	ebp, 0Eh
		jg	loc_1000BE31
		fld	ds:dbl_10028AF0[ebp*8]
		cmp	[esp+64h+arg_C], ecx
		jge	short loc_1000BD5A
		cmp	ebx, ecx
		jg	short loc_1000BD5A
		xor	ebp, ebp
		fstp	st(3)
		mov	[esp+64h+var_54], ebp
		cmp	ebx, ebp
		jl	loc_1000C092
		fxch	st(2)
		fmulp	st(1), st
		fcompp
		fnstsw	ax
		test	ah, 1
		jnz	loc_1000C081
		or	eax, 0FFFFFFFFh
		sub	eax, [esp+64h+arg_C]
		mov	[esp+64h+var_50], eax
		jmp	loc_1000C2F1
; ---------------------------------------------------------------------------

loc_1000BD5A:				; CODE XREF: sub_1000B720+603j
					; sub_1000B720+607j
		mov	ebx, [esp+64h+var_50]
		fstp	st(2)
		mov	esi, 1
		inc	ebx
		cmp	ebx, esi
		jl	loc_1000BBED
		fldz
		jmp	short loc_1000BD74
; ---------------------------------------------------------------------------

loc_1000BD72:				; CODE XREF: sub_1000B720+68Fj
		fxch	st(1)

loc_1000BD74:				; CODE XREF: sub_1000B720+650j
		fld	st(1)
		fdiv	st, st(3)
		call	sub_100269EA
		mov	ecx, eax
		mov	[esp+64h+var_44], ecx
		fild	[esp+64h+var_44]
		lea	edx, [ecx+30h]
		mov	[edi], dl
		inc	edi
		fmul	st, st(3)
		fsubp	st(2), st
		fld	st(1)
		fld	st(1)
		fucompp
		fnstsw	ax
		test	ah, 44h
		jnp	loc_1000C43D
		cmp	esi, [esp+64h+var_48]
		jz	short loc_1000BDBC
		inc	esi
		fxch	st(1)
		fmul	st, st(3)
		cmp	esi, ebx
		jle	short loc_1000BD72
		fstp	st
		fstp	st(1)
		fstp	st(1)
		jmp	loc_1000BBF1
; ---------------------------------------------------------------------------

loc_1000BDBC:				; CODE XREF: sub_1000B720+686j
		fstp	st(3)
		fstp	st(2)
		fld	st(1)
		faddp	st(2), st
		fcom	st(1)
		fnstsw	ax
		test	ah, 5
		jnp	short loc_1000BDE5
		fucompp
		fnstsw	ax
		test	ah, 44h
		jp	loc_1000BBF3
		test	cl, 1
		jz	loc_1000BBF3
		jmp	short loc_1000BDFF
; ---------------------------------------------------------------------------

loc_1000BDE5:				; CODE XREF: sub_1000B720+6ABj
		fstp	st(1)
		jmp	short loc_1000BDFD
; ---------------------------------------------------------------------------

loc_1000BDE9:				; CODE XREF: sub_1000B720+506j
		fstp	st(3)
		fstp	st(2)
		fstp	st(3)
		fstp	st
		jmp	short loc_1000BDFB
; ---------------------------------------------------------------------------

loc_1000BDF3:				; CODE XREF: sub_1000B720+598j
		fstp	st(3)
		fstp	st(2)
		fstp	st(1)
		fstp	st(2)

loc_1000BDFB:				; CODE XREF: sub_1000B720+6D1j
		fstp	st

loc_1000BDFD:				; CODE XREF: sub_1000B720+6C7j
		fstp	st

loc_1000BDFF:				; CODE XREF: sub_1000B720+6C3j
		dec	edi
		cmp	byte ptr [edi],	39h
		jnz	short loc_1000BE29
		mov	eax, [esp+64h+var_2C]
		lea	esp, [esp+0]

loc_1000BE10:				; CODE XREF: sub_1000B720+6F8j
		cmp	edi, eax
		jz	short loc_1000BE22
		dec	edi
		cmp	byte ptr [edi],	39h
		jz	short loc_1000BE10
		inc	byte ptr [edi]
		inc	edi
		jmp	loc_1000BBF3
; ---------------------------------------------------------------------------

loc_1000BE22:				; CODE XREF: sub_1000B720+6F2j
		inc	[esp+64h+var_50]
		mov	byte ptr [edi],	30h

loc_1000BE29:				; CODE XREF: sub_1000B720+6E3j
		inc	byte ptr [edi]
		inc	edi
		jmp	loc_1000BBF3
; ---------------------------------------------------------------------------

loc_1000BE31:				; CODE XREF: sub_1000B720+5E9j
					; sub_1000B720+5F2j
		mov	esi, [esp+64h+var_4C]
		fstp	st
		fstp	st(1)
		mov	[esp+64h+var_38], esi
		fstp	st
		mov	dword ptr [esp+64h+var_34], ecx
		mov	[esp+64h+var_54], ecx
		cmp	[esp+64h+var_3C], ecx
		jz	short loc_1000BE81
		cmp	[esp+64h+var_10], ecx
		jz	short loc_1000BE5A
		add	eax, 433h
		jmp	short loc_1000BE63
; ---------------------------------------------------------------------------

loc_1000BE5A:				; CODE XREF: sub_1000B720+731j
		mov	eax, 36h
		sub	eax, [esp+64h+var_C]

loc_1000BE63:				; CODE XREF: sub_1000B720+738j
		mov	ebp, [esp+64h+var_40]
		add	[esp+64h+var_4C], eax
		add	ebp, eax
		push	1
		mov	[esp+68h+var_40], ebp
		call	sub_10009B60
		add	esp, 4
		mov	[esp+64h+var_54], eax
		jmp	short loc_1000BE85
; ---------------------------------------------------------------------------

loc_1000BE81:				; CODE XREF: sub_1000B720+72Bj
		mov	ebp, [esp+64h+var_40]

loc_1000BE85:				; CODE XREF: sub_1000B720+75Fj
		test	esi, esi
		jle	short loc_1000BEA5
		test	ebp, ebp
		jle	short loc_1000BEA5
		mov	eax, esi
		cmp	esi, ebp
		jl	short loc_1000BE95
		mov	eax, ebp

loc_1000BE95:				; CODE XREF: sub_1000B720+771j
		sub	[esp+64h+var_4C], eax
		sub	esi, eax
		sub	ebp, eax
		mov	[esp+64h+var_38], esi
		mov	[esp+64h+var_40], ebp

loc_1000BEA5:				; CODE XREF: sub_1000B720+767j
					; sub_1000B720+76Bj
		mov	eax, [esp+64h+var_24]
		test	eax, eax
		jle	short loc_1000BEF3
		cmp	[esp+64h+var_3C], 0
		jz	short loc_1000BEE2
		mov	eax, [esp+64h+var_54]
		push	eax		; Memory
		mov	eax, [esp+68h+var_24]
		call	sub_10009D90
		mov	esi, [esp+68h+Memory]
		push	esi
		mov	[esp+6Ch+var_54], eax
		call	sub_10009BF0
		add	esp, 8
		mov	[esp+64h+Memory], eax
		call	sub_10009910
		mov	ebx, [esp+64h+var_48]
		jmp	short loc_1000BEF3
; ---------------------------------------------------------------------------

loc_1000BEE2:				; CODE XREF: sub_1000B720+792j
		mov	ecx, [esp+64h+Memory]
		push	ecx		; Memory
		call	sub_10009D90
		add	esp, 4
		mov	[esp+64h+Memory], eax

loc_1000BEF3:				; CODE XREF: sub_1000B720+78Bj
					; sub_1000B720+7C0j
		push	1
		call	sub_10009B60
		mov	ebp, eax
		mov	eax, [esp+68h+var_20]
		add	esp, 4
		mov	[esp+64h+var_44], ebp
		test	eax, eax
		jle	short loc_1000BF1A
		push	ebp		; Memory
		call	sub_10009D90
		add	esp, 4
		mov	ebp, eax
		mov	[esp+64h+var_44], eax

loc_1000BF1A:				; CODE XREF: sub_1000B720+7E9j
		cmp	[esp+64h+arg_8], 2
		mov	[esp+64h+var_C], 0
		jl	short loc_1000BF30
		cmp	[esp+64h+var_3C], 0
		jz	short loc_1000BF5D

loc_1000BF30:				; CODE XREF: sub_1000B720+807j
		cmp	dword ptr [esp+64h+var_8], 0
		jnz	short loc_1000BF5D
		mov	eax, dword ptr [esp+64h+var_8+4]
		test	eax, 0FFFFFh
		jnz	short loc_1000BF5D
		test	eax, 7FE00000h
		jz	short loc_1000BF5D
		mov	edx, [esp+64h+var_4C]
		mov	esi, [esp+64h+var_40]
		inc	edx
		inc	esi
		mov	[esp+64h+var_C], 1
		jmp	short loc_1000BF65
; ---------------------------------------------------------------------------

loc_1000BF5D:				; CODE XREF: sub_1000B720+80Ej
					; sub_1000B720+815j ...
		mov	edx, [esp+64h+var_4C]
		mov	esi, [esp+64h+var_40]

loc_1000BF65:				; CODE XREF: sub_1000B720+83Bj
		cmp	[esp+64h+var_20], 0
		jz	short loc_1000BF81
		mov	eax, [ebp+10h]
		mov	ecx, [ebp+eax*4+10h]
		call	sub_10009AA0
		mov	ecx, 20h
		sub	ecx, eax
		jmp	short loc_1000BF86
; ---------------------------------------------------------------------------

loc_1000BF81:				; CODE XREF: sub_1000B720+84Aj
		mov	ecx, 1

loc_1000BF86:				; CODE XREF: sub_1000B720+85Fj
		lea	eax, [ecx+esi]
		and	eax, 1Fh
		jz	short loc_1000BF97
		mov	ecx, 20h
		sub	ecx, eax
		mov	eax, ecx

loc_1000BF97:				; CODE XREF: sub_1000B720+86Cj
		cmp	eax, 4
		jle	short loc_1000BFA1
		sub	eax, 4
		jmp	short loc_1000BFA6
; ---------------------------------------------------------------------------

loc_1000BFA1:				; CODE XREF: sub_1000B720+87Aj
		jge	short loc_1000BFAE
		add	eax, 1Ch

loc_1000BFA6:				; CODE XREF: sub_1000B720+87Fj
		add	[esp+64h+var_38], eax
		add	edx, eax
		add	esi, eax

loc_1000BFAE:				; CODE XREF: sub_1000B720:loc_1000BFA1j
		test	edx, edx
		jle	short loc_1000BFC4
		push	edx		; int
		mov	edx, [esp+68h+Memory]
		push	edx		; Memory
		call	sub_10009EC0
		add	esp, 8
		mov	[esp+64h+Memory], eax

loc_1000BFC4:				; CODE XREF: sub_1000B720+890j
		test	esi, esi
		jle	short loc_1000BFD8
		push	esi		; int
		push	ebp		; Memory
		call	sub_10009EC0
		mov	ebp, eax
		add	esp, 8
		mov	[esp+64h+var_44], ebp

loc_1000BFD8:				; CODE XREF: sub_1000B720+8A6j
		cmp	dword ptr [esp+64h+var_1C], 0
		jz	short loc_1000C02B
		mov	esi, [esp+64h+Memory]
		mov	eax, ebp
		mov	edx, esi
		call	sub_10009FD0
		test	eax, eax
		jns	short loc_1000C02B
		dec	[esp+64h+var_50]
		xor	ecx, ecx
		push	esi
		lea	eax, [ecx+0Ah]
		call	sub_10009960
		add	esp, 4
		cmp	[esp+64h+var_3C], 0
		mov	[esp+64h+Memory], eax
		jz	short loc_1000C023
		mov	eax, [esp+64h+var_54]
		xor	ecx, ecx
		push	eax
		lea	eax, [ecx+0Ah]
		call	sub_10009960
		add	esp, 4
		mov	[esp+64h+var_54], eax

loc_1000C023:				; CODE XREF: sub_1000B720+8EBj
		mov	ebx, [esp+64h+var_28]
		mov	[esp+64h+var_48], ebx

loc_1000C02B:				; CODE XREF: sub_1000B720+8BDj
					; sub_1000B720+8CEj
		test	ebx, ebx
		jg	short loc_1000C0A8
		mov	eax, [esp+64h+arg_8]
		cmp	eax, 3
		jz	short loc_1000C03D
		cmp	eax, 5
		jnz	short loc_1000C0A8

loc_1000C03D:				; CODE XREF: sub_1000B720+916j
		test	ebx, ebx
		js	loc_1000BB96
		xor	ecx, ecx
		push	ebp
		lea	eax, [ecx+5]
		call	sub_10009960
		mov	edx, [esp+68h+Memory]
		add	esp, 4
		mov	ebp, eax
		call	sub_10009FD0
		test	eax, eax
		jle	loc_1000BB96
		mov	edi, [esp+64h+var_2C]
		mov	byte ptr [edi],	31h
		inc	edi
		inc	[esp+64h+var_50]
		jmp	loc_1000C2F1
; ---------------------------------------------------------------------------

loc_1000C077:				; CODE XREF: sub_1000B720+45Bj
		fstp	st(1)
		fstp	st
		fstp	st(2)
		fstp	st
		fstp	st

loc_1000C081:				; CODE XREF: sub_1000B720+624j
		mov	edi, [esp+64h+var_2C]
		mov	byte ptr [edi],	31h
		inc	edi
		inc	[esp+64h+var_50]
		jmp	loc_1000C2F1
; ---------------------------------------------------------------------------

loc_1000C092:				; CODE XREF: sub_1000B720+613j
		fstp	st
		or	eax, 0FFFFFFFFh
		sub	eax, [esp+64h+arg_C]
		fstp	st(1)
		fstp	st
		mov	[esp+64h+var_50], eax
		jmp	loc_1000C2F1
; ---------------------------------------------------------------------------

loc_1000C0A8:				; CODE XREF: sub_1000B720+90Dj
					; sub_1000B720+91Bj
		cmp	[esp+64h+var_3C], 0
		jz	loc_1000C312
		mov	eax, [esp+64h+var_38]
		test	eax, eax
		jle	short loc_1000C0CD
		mov	ecx, [esp+64h+var_54]
		push	eax		; int
		push	ecx		; Memory
		call	sub_10009EC0
		add	esp, 8
		mov	[esp+64h+var_54], eax

loc_1000C0CD:				; CODE XREF: sub_1000B720+999j
		cmp	[esp+64h+var_C], 0
		mov	ebp, [esp+64h+var_54]
		mov	dword ptr [esp+64h+var_34], ebp
		jz	short loc_1000C10F
		mov	edx, ebp
		mov	ebx, [edx+4]
		call	sub_10009860
		mov	esi, eax
		mov	eax, [ebp+10h]
		lea	ecx, ds:8[eax*4]
		push	ecx		; Size
		add	ebp, 0Ch
		lea	edx, [esi+0Ch]
		push	ebp		; Src
		push	edx		; Dst
		call	memcpy
		push	1		; int
		push	esi		; Memory
		call	sub_10009EC0
		add	esp, 14h
		mov	[esp+64h+var_54], eax

loc_1000C10F:				; CODE XREF: sub_1000B720+9BAj
		mov	[esp+64h+var_38], 1

loc_1000C117:				; CODE XREF: sub_1000B720+B13j
					; sub_1000B720+B3Dj
		mov	esi, [esp+64h+var_44]
		mov	ebp, [esp+64h+Memory]
		push	esi
		push	ebp
		call	sub_1000B440
		lea	ebx, [eax+30h]
		mov	eax, dword ptr [esp+6Ch+var_34]
		add	esp, 8
		mov	edx, ebp
		call	sub_10009FD0
		mov	ebp, eax
		mov	eax, [esp+64h+var_54]
		mov	ecx, esi
		call	sub_1000A020
		mov	esi, eax
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_1000C156
		mov	[esp+64h+var_C], 1
		jmp	short loc_1000C165
; ---------------------------------------------------------------------------

loc_1000C156:				; CODE XREF: sub_1000B720+A2Aj
		mov	edx, [esp+64h+Memory]
		mov	eax, esi
		call	sub_10009FD0
		mov	[esp+64h+var_C], eax

loc_1000C165:				; CODE XREF: sub_1000B720+A34j
		cmp	dword ptr [esi+4], 7
		jle	short loc_1000C177
		push	esi		; Memory
		call	ds:free
		add	esp, 4
		jmp	short loc_1000C1A4
; ---------------------------------------------------------------------------

loc_1000C177:				; CODE XREF: sub_1000B720+A49j
		mov	eax, dword_10030BB0
		push	eax
		call	PR_Lock
		mov	eax, [esi+4]
		mov	ecx, dword_10030BBC[eax*4]
		mov	[esi], ecx
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		mov	dword_10030BBC[eax*4], esi
		call	PR_Unlock
		add	esp, 8

loc_1000C1A4:				; CODE XREF: sub_1000B720+A55j
		mov	ecx, [esp+64h+var_C]
		mov	esi, 1
		test	ecx, ecx
		jnz	short loc_1000C1C2
		cmp	[esp+64h+arg_8], esi
		jz	short loc_1000C1C2
		test	byte ptr [esp+64h+var_8], 1
		jz	loc_1000C262

loc_1000C1C2:				; CODE XREF: sub_1000B720+A8Fj
					; sub_1000B720+A95j
		test	ebp, ebp
		js	loc_1000C288
		jnz	short loc_1000C1DD
		cmp	[esp+64h+arg_8], esi
		jz	short loc_1000C1DD
		test	byte ptr [esp+64h+var_8], 1
		jz	loc_1000C288

loc_1000C1DD:				; CODE XREF: sub_1000B720+AAAj
					; sub_1000B720+AB0j
		test	ecx, ecx
		jg	loc_1000C277
		mov	eax, [esp+64h+var_48]
		mov	[edi], bl
		add	edi, esi
		cmp	[esp+64h+var_38], eax
		jz	loc_1000C35C
		mov	ecx, [esp+64h+Memory]
		push	ecx
		xor	ecx, ecx
		lea	eax, [ecx+0Ah]
		call	sub_10009960
		mov	esi, [esp+68h+var_54]
		mov	[esp+68h+Memory], eax
		mov	eax, dword ptr [esp+68h+var_34]
		add	esp, 4
		xor	ecx, ecx
		cmp	eax, esi
		jnz	short loc_1000C238
		push	esi
		lea	eax, [ecx+0Ah]
		call	sub_10009960
		add	esp, 4
		inc	[esp+64h+var_38]
		mov	dword ptr [esp+64h+var_34], eax
		mov	[esp+64h+var_54], eax
		jmp	loc_1000C117
; ---------------------------------------------------------------------------

loc_1000C238:				; CODE XREF: sub_1000B720+AF9j
		push	eax
		mov	eax, 0Ah
		call	sub_10009960
		xor	ecx, ecx
		mov	dword ptr [esp+68h+var_34], eax
		push	esi
		lea	eax, [ecx+0Ah]
		call	sub_10009960
		add	esp, 8
		inc	[esp+64h+var_38]
		mov	[esp+64h+var_54], eax
		jmp	loc_1000C117
; ---------------------------------------------------------------------------

loc_1000C262:				; CODE XREF: sub_1000B720+A9Cj
		cmp	ebx, 39h
		jz	short loc_1000C2C8
		test	ebp, ebp
		jle	short loc_1000C26D
		add	ebx, esi

loc_1000C26D:				; CODE XREF: sub_1000B720+B49j
					; sub_1000B720+B75j ...
		mov	ebp, [esp+64h+var_44]
		mov	[edi], bl
		add	edi, esi
		jmp	short loc_1000C2F1
; ---------------------------------------------------------------------------

loc_1000C277:				; CODE XREF: sub_1000B720+ABFj
		cmp	ebx, 39h
		jz	short loc_1000C2C8
		mov	ebp, [esp+64h+var_44]
		inc	bl
		mov	[edi], bl
		add	edi, esi
		jmp	short loc_1000C2F1
; ---------------------------------------------------------------------------

loc_1000C288:				; CODE XREF: sub_1000B720+AA4j
					; sub_1000B720+AB7j
		mov	eax, [esp+64h+Memory]
		cmp	dword ptr [eax+14h], 0
		jnz	short loc_1000C297
		cmp	[eax+10h], esi
		jle	short loc_1000C26D

loc_1000C297:				; CODE XREF: sub_1000B720+B70j
		test	ecx, ecx
		jle	short loc_1000C26D
		push	esi		; int
		push	eax		; Memory
		call	sub_10009EC0
		mov	edx, eax
		mov	eax, [esp+6Ch+var_44]
		add	esp, 8
		mov	[esp+64h+Memory], edx
		call	sub_10009FD0
		test	eax, eax
		jg	short loc_1000C2BF
		jnz	short loc_1000C26D
		test	bl, 1
		jz	short loc_1000C26D

loc_1000C2BF:				; CODE XREF: sub_1000B720+B96j
		mov	edx, ebx
		add	ebx, esi
		cmp	edx, 39h
		jnz	short loc_1000C26D

loc_1000C2C8:				; CODE XREF: sub_1000B720+B45j
					; sub_1000B720+B5Aj
		mov	ebp, [esp+64h+var_44]
		mov	byte ptr [edi],	39h
		add	edi, esi

loc_1000C2D1:				; CODE XREF: sub_1000B720+C5Ej
					; sub_1000B720+C69j
		dec	edi
		cmp	byte ptr [edi],	39h
		jnz	short loc_1000C2EE
		mov	eax, [esp+64h+var_2C]
		jmp	short loc_1000C2E0
; ---------------------------------------------------------------------------
		align 10h

loc_1000C2E0:				; CODE XREF: sub_1000B720+BBBj
					; sub_1000B720+BCCj
		cmp	edi, eax
		jz	loc_1000C39B
		dec	edi
		cmp	byte ptr [edi],	39h
		jz	short loc_1000C2E0

loc_1000C2EE:				; CODE XREF: sub_1000B720+BB5j
		inc	byte ptr [edi]

loc_1000C2F0:				; CODE XREF: sub_1000B720+C76j
					; sub_1000B720+C82j
		inc	edi

loc_1000C2F1:				; CODE XREF: sub_1000B720+481j
					; sub_1000B720+635j ...
		test	ebp, ebp
		jz	loc_1000C3D6
		cmp	dword ptr [ebp+4], 7
		jle	loc_1000C3A7
		push	ebp		; Memory
		call	ds:free
		add	esp, 4
		jmp	loc_1000C3D6
; ---------------------------------------------------------------------------

loc_1000C312:				; CODE XREF: sub_1000B720+98Dj
		mov	esi, 1

loc_1000C317:				; CODE XREF: sub_1000B720+C3Aj
		mov	eax, [esp+64h+Memory]
		push	ebp
		push	eax
		call	sub_1000B440
		mov	ecx, [esp+6Ch+Memory]
		lea	ebx, [eax+30h]
		mov	[edi], bl
		add	esp, 8
		inc	edi
		cmp	dword ptr [ecx+14h], 0
		jnz	short loc_1000C33D
		mov	edx, ecx
		cmp	dword ptr [edx+10h], 1
		jle	short loc_1000C2F1

loc_1000C33D:				; CODE XREF: sub_1000B720+C13j
		cmp	esi, [esp+64h+var_48]
		jge	short loc_1000C35C
		mov	eax, [esp+64h+Memory]
		xor	ecx, ecx
		push	eax
		lea	eax, [ecx+0Ah]
		call	sub_10009960
		add	esp, 4
		mov	[esp+64h+Memory], eax
		inc	esi
		jmp	short loc_1000C317
; ---------------------------------------------------------------------------

loc_1000C35C:				; CODE XREF: sub_1000B720+AD1j
					; sub_1000B720+C21j
		mov	ecx, [esp+64h+Memory]
		push	1		; int
		push	ecx		; Memory
		call	sub_10009EC0
		mov	ebp, [esp+6Ch+var_44]
		mov	edx, eax
		add	esp, 8
		mov	eax, ebp
		mov	[esp+64h+Memory], edx
		call	sub_10009FD0
		test	eax, eax
		jg	loc_1000C2D1
		jnz	short loc_1000C390
		test	bl, 1
		jnz	loc_1000C2D1
		nop

loc_1000C390:				; CODE XREF: sub_1000B720+C64j
					; sub_1000B720+C74j
		dec	edi
		cmp	byte ptr [edi],	30h
		jz	short loc_1000C390
		jmp	loc_1000C2F0
; ---------------------------------------------------------------------------

loc_1000C39B:				; CODE XREF: sub_1000B720+BC2j
		inc	[esp+64h+var_50]
		mov	byte ptr [edi],	31h
		jmp	loc_1000C2F0
; ---------------------------------------------------------------------------

loc_1000C3A7:				; CODE XREF: sub_1000B720+BDDj
		mov	edx, dword_10030BB0
		push	edx
		call	PR_Lock
		mov	eax, [ebp+4]
		mov	ecx, dword_10030BBC[eax*4]
		mov	[ebp+0], ecx
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		mov	dword_10030BBC[eax*4], ebp
		call	PR_Unlock
		add	esp, 8

loc_1000C3D6:				; CODE XREF: sub_1000B720+BD3j
					; sub_1000B720+BEDj
		cmp	[esp+64h+var_54], 0
		jz	loc_1000BBF3
		mov	esi, dword ptr [esp+64h+var_34]
		mov	ebx, [esp+64h+var_54]
		test	esi, esi
		jz	short loc_1000C3F6
		cmp	esi, ebx
		jz	short loc_1000C3F6
		call	sub_10009910

loc_1000C3F6:				; CODE XREF: sub_1000B720+CCBj
					; sub_1000B720+CCFj
		cmp	dword ptr [ebx+4], 7
		jle	short loc_1000C40B
		push	ebx		; Memory
		call	ds:free
		add	esp, 4
		jmp	loc_1000BBF3
; ---------------------------------------------------------------------------

loc_1000C40B:				; CODE XREF: sub_1000B720+CDAj
		mov	eax, dword_10030BB0
		push	eax
		call	PR_Lock
		mov	eax, [ebx+4]
		mov	ecx, dword_10030BBC[eax*4]
		mov	[ebx], ecx
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		mov	dword_10030BBC[eax*4], ebx
		call	PR_Unlock
		add	esp, 8
		jmp	loc_1000BBF3
; ---------------------------------------------------------------------------

loc_1000C43D:				; CODE XREF: sub_1000B720+67Cj
		fstp	st(1)
		fstp	st(1)
		fstp	st(1)
		jmp	loc_1000BBF1
; ---------------------------------------------------------------------------

loc_1000C448:				; CODE XREF: sub_1000B720+4E4j
		mov	eax, dword_10030BB0
		push	eax
		call	PR_Lock
		mov	eax, [esi+4]
		mov	ecx, dword_10030BBC[eax*4]
		mov	[esi], ecx
		mov	edx, dword_10030BB0
		push	edx		; lpTlsValue
		mov	dword_10030BBC[eax*4], esi
		call	PR_Unlock
		add	esp, 8

loc_1000C475:				; CODE XREF: sub_1000B720+4DAj
					; sub_1000B720+4F4j
		mov	eax, [esp+60h+var_50]
		mov	ecx, [esp+60h+arg_10]
		inc	eax
		mov	byte ptr [edi],	0
		mov	[ecx], eax
		mov	eax, [esp+60h+arg_14]
		test	eax, eax
		jz	short loc_1000C48D
		mov	[eax], edi

loc_1000C48D:				; CODE XREF: sub_1000B720+D69j
		mov	eax, [esp+60h+var_2C]

loc_1000C491:				; CODE XREF: sub_1000B720+8Dj
					; sub_1000B720+BFj ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 54h
		retn
sub_1000B720	endp

; ---------------------------------------------------------------------------
off_1000C498	dd offset loc_1000B9F1	; DATA XREF: sub_1000B720+2CAr
		dd offset loc_1000B9F1	; jump table for switch	statement
		dd offset loc_1000BA08
		dd offset loc_1000BA2A
		dd offset loc_1000BA0C
		dd offset loc_1000BA2E
; Exported entry 382. PR_dtoa

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_dtoa(double, int, int,	int, int, int, void *Dst, int)
		public PR_dtoa
PR_dtoa		proc near		; CODE XREF: PR_cnvtf+58p
					; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr -24h
arg_0		= qword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
Dst		= dword	ptr  20h
arg_20		= dword	ptr  24h

		push	edi
		or	edi, 0FFFFFFFFh
		cmp	dword_10031520,	0
		jnz	short loc_1000C4C2
		call	PR_Init

loc_1000C4C2:				; CODE XREF: PR_dtoa+Bj
		mov	eax, [esp+4+arg_8]
		cmp	eax, 3
		ja	loc_1000C567
		mov	ecx, [esp+4+arg_10]
		fld	[esp+4+arg_0]
		mov	edx, [esp+4+arg_C]
		push	ebx
		mov	ebx, [esp+8+arg_18]
		push	esi
		push	ebx		; int
		push	ecx		; int
		push	edx		; int
		push	eax		; int
		mov	eax, [esp+1Ch+arg_14]
		sub	esp, 8
		fstp	qword ptr [esp+24h+Memory] ; Memory
		call	sub_1000B720
		mov	esi, eax
		add	esp, 18h
		test	esi, esi
		jnz	short loc_1000C512
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	esi
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000C512:				; CODE XREF: PR_dtoa+4Bj
		lea	edx, [eax+1]

loc_1000C515:				; CODE XREF: PR_dtoa+6Aj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000C515
		sub	eax, edx
		inc	eax
		cmp	[esp+0Ch+arg_20], eax
		jnb	short loc_1000C541
		push	0
		push	0FFFFE8B6h
		call	PR_SetError
		add	esp, 8
		mov	eax, esi
		call	sub_1000B6C0
		pop	esi
		pop	ebx
		mov	eax, edi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000C541:				; CODE XREF: PR_dtoa+73j
		mov	edi, [esp+0Ch+Dst]
		push	eax		; Size
		push	esi		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		test	ebx, ebx
		jz	short loc_1000C558
		sub	edi, esi
		add	[ebx], edi

loc_1000C558:				; CODE XREF: PR_dtoa+A2j
		mov	eax, esi
		xor	edi, edi
		call	sub_1000B6C0
		pop	esi
		pop	ebx
		mov	eax, edi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_1000C567:				; CODE XREF: PR_dtoa+19j
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
PR_dtoa		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 381. PR_cnvtf

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_cnvtf(void *Memory, size_t Size, int, int)
		public PR_cnvtf
PR_cnvtf	proc near		; DATA XREF: .rdata:off_1002C7C8o

var_44		= qword	ptr -44h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= qword	ptr -8
Memory		= dword	ptr  4
Size		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 10h
		fld	qword ptr [esp+10h+arg_C]
		push	ebx
		mov	ebx, [esp+14h+Memory]
		fstp	[esp+14h+var_8]
		push	ebp
		mov	ebp, [esp+18h+Size]
		push	esi
		push	edi
		push	ebp		; Size
		mov	esi, ebx
		call	PR_Malloc
		mov	edi, eax
		add	esp, 4
		mov	[esp+20h+Memory], edi
		test	edi, edi
		jnz	short loc_1000C5B6
		pop	edi
		pop	esi
		pop	ebp
		mov	[ebx], al
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1000C5B6:				; CODE XREF: PR_cnvtf+2Aj
		fld	qword ptr [esp+20h+arg_C]
		push	ebp		; int
		push	edi		; Dst
		lea	eax, [esp+28h+arg_C]
		push	eax		; int
		mov	eax, [esp+2Ch+arg_8]
		lea	ecx, [esp+2Ch+var_10]
		push	ecx		; int
		lea	edx, [esp+30h+var_C]
		push	edx		; int
		push	eax		; int
		push	1		; int
		sub	esp, 8
		fstp	[esp+44h+var_44] ; double
		call	PR_dtoa
		add	esp, 24h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000C5F9
		push	edi		; Memory
		mov	byte ptr [ebx],	0
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1000C5F9:				; CODE XREF: PR_cnvtf+63j
		mov	ebp, [esp+20h+arg_C]
		sub	ebp, edi
		cmp	[esp+20h+var_10], 0
		jz	short loc_1000C63A
		mov	eax, dword ptr [esp+20h+var_8+4]
		mov	ecx, dword ptr [esp+20h+var_8]
		cmp	eax, 80000000h
		jnz	short loc_1000C619
		test	ecx, ecx
		jz	short loc_1000C63A

loc_1000C619:				; CODE XREF: PR_cnvtf+93j
		mov	edx, eax
		and	edx, 7FF00000h
		cmp	edx, 7FF00000h
		jnz	short loc_1000C634
		test	ecx, ecx
		jnz	short loc_1000C63A
		test	eax, 0FFFFFh
		jnz	short loc_1000C63A

loc_1000C634:				; CODE XREF: PR_cnvtf+A7j
		mov	byte ptr [ebx],	2Dh
		lea	esi, [ebx+1]

loc_1000C63A:				; CODE XREF: PR_cnvtf+84j PR_cnvtf+97j ...
		mov	eax, [esp+20h+var_C]
		cmp	eax, 270Fh
		jnz	short loc_1000C66B
		mov	ecx, edi
		sub	ecx, esi
		lea	esp, [esp+0]

loc_1000C650:				; CODE XREF: PR_cnvtf+D8j
		mov	al, [ecx+esi]
		mov	[esi], al
		inc	esi
		test	al, al
		jnz	short loc_1000C650
		push	edi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1000C66B:				; CODE XREF: PR_cnvtf+C3j
		mov	ecx, [esp+20h+arg_8]
		inc	ecx
		cmp	eax, ecx
		jg	loc_1000C72A
		mov	edx, 1
		sub	edx, [esp+20h+arg_8]
		cmp	eax, edx
		jl	loc_1000C72A
		cmp	eax, 0FFFFFFFBh
		jl	loc_1000C72A
		test	eax, eax
		js	short loc_1000C6E6
		jnz	short loc_1000C6A0
		mov	byte ptr [esi],	30h
		inc	esi
		jmp	short loc_1000C6B5
; ---------------------------------------------------------------------------
		align 10h

loc_1000C6A0:				; CODE XREF: PR_cnvtf+116j
					; PR_cnvtf+133j
		mov	cl, [edi]
		dec	eax
		test	cl, cl
		jz	short loc_1000C6AD
		mov	[esi], cl
		inc	esi
		inc	edi
		jmp	short loc_1000C6B1
; ---------------------------------------------------------------------------

loc_1000C6AD:				; CODE XREF: PR_cnvtf+125j
		mov	byte ptr [esi],	30h
		inc	esi

loc_1000C6B1:				; CODE XREF: PR_cnvtf+12Bj
		test	eax, eax
		jnz	short loc_1000C6A0

loc_1000C6B5:				; CODE XREF: PR_cnvtf+11Cj
		cmp	byte ptr [edi],	0
		jz	short loc_1000C6CE
		mov	byte ptr [esi],	2Eh
		mov	al, [edi]
		inc	esi
		test	al, al
		jz	short loc_1000C6CE

loc_1000C6C4:				; CODE XREF: PR_cnvtf+14Cj
		inc	edi
		mov	[esi], al
		mov	al, [edi]
		inc	esi
		test	al, al
		jnz	short loc_1000C6C4

loc_1000C6CE:				; CODE XREF: PR_cnvtf+138j
					; PR_cnvtf+142j
		mov	edi, [esp+20h+Memory]
		push	edi		; Memory
		mov	byte ptr [esi],	0
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1000C6E6:				; CODE XREF: PR_cnvtf+114j
		neg	eax
		mov	ebx, eax
		push	ebx		; Size
		mov	word ptr [esi],	2E30h
		add	esi, 2
		push	30h		; Val
		push	esi		; Dst
		call	memset
		mov	eax, edi
		mov	al, [eax]
		add	esp, 0Ch
		add	esi, ebx
		test	al, al
		jz	short loc_1000C712

loc_1000C708:				; CODE XREF: PR_cnvtf+190j
		inc	edi
		mov	[esi], al
		mov	al, [edi]
		inc	esi
		test	al, al
		jnz	short loc_1000C708

loc_1000C712:				; CODE XREF: PR_cnvtf+186j
		mov	edi, [esp+20h+Memory]
		push	edi		; Memory
		mov	byte ptr [esi],	0
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1000C72A:				; CODE XREF: PR_cnvtf+F2j
					; PR_cnvtf+103j ...
		mov	cl, [edi]
		mov	[esi], cl
		inc	esi
		lea	edx, [edi+1]
		cmp	ebp, 1
		jz	short loc_1000C73B
		mov	byte ptr [esi],	2Eh
		inc	esi

loc_1000C73B:				; CODE XREF: PR_cnvtf+1B5j
		mov	cl, [edx]
		test	cl, cl
		jz	short loc_1000C74B

loc_1000C741:				; CODE XREF: PR_cnvtf+1C9j
		inc	edx
		mov	[esi], cl
		mov	cl, [edx]
		inc	esi
		test	cl, cl
		jnz	short loc_1000C741

loc_1000C74B:				; CODE XREF: PR_cnvtf+1BFj
		mov	byte ptr [esi],	65h
		inc	esi
		dec	eax
		push	eax
		sub	ebx, esi
		add	ebx, [esp+24h+Size]
		push	offset aD	; "%+d"
		push	ebx
		push	esi
		call	PR_snprintf
		add	esp, 10h
		push	edi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
PR_cnvtf	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C780	proc near		; CODE XREF: PR_Init_0+E4p
		call	PR_NewLock
		mov	dword_100314E0,	eax
		retn
sub_1000C780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C790	proc near		; CODE XREF: PR_Cleanup+16Ap
		mov	eax, dword_100314E0
		test	eax, eax
		jz	short locret_1000C7AC
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_100314E0,	0

locret_1000C7AC:			; CODE XREF: sub_1000C790+7j
		retn
sub_1000C790	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 150. PR_GetEnv

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetEnv(char *VarName)
		public PR_GetEnv
PR_GetEnv	proc near		; CODE XREF: sub_100012C0+8p
					; sub_100012C0+14p ...

VarName		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1000C7BE
		call	PR_Init

loc_1000C7BE:				; CODE XREF: PR_GetEnv+7j
		mov	eax, dword_100314E0
		test	eax, eax
		jz	short loc_1000C7D0
		push	eax
		call	PR_Lock
		add	esp, 4

loc_1000C7D0:				; CODE XREF: PR_GetEnv+15j
		mov	eax, [esp+VarName]
		push	esi
		push	eax		; VarName
		call	getenv
		mov	esi, eax
		mov	eax, dword_100314E0
		add	esp, 4
		test	eax, eax
		jz	short loc_1000C7F2
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_1000C7F2:				; CODE XREF: PR_GetEnv+37j
		mov	eax, esi
		pop	esi
		retn
PR_GetEnv	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 323. PR_SetEnv

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SetEnv(char *Str)
		public PR_SetEnv
PR_SetEnv	proc near		; DATA XREF: .rdata:off_1002C7C8o

Str		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1000C80E
		call	PR_Init

loc_1000C80E:				; CODE XREF: PR_SetEnv+7j
		push	esi
		mov	esi, [esp+4+Str]
		push	3Dh		; Val
		push	esi		; Str
		call	ds:strchr
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000C828
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000C828:				; CODE XREF: PR_SetEnv+21j
		mov	eax, dword_100314E0
		test	eax, eax
		jz	short loc_1000C83A
		push	eax
		call	PR_Lock
		add	esp, 4

loc_1000C83A:				; CODE XREF: PR_SetEnv+2Fj
		push	esi		; EnvString
		call	_putenv
		mov	esi, eax
		mov	eax, dword_100314E0
		add	esp, 4
		test	eax, eax
		jz	short loc_1000C857
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_1000C857:				; CODE XREF: PR_SetEnv+4Cj
		mov	eax, esi
		neg	eax
		sbb	eax, eax
		pop	esi
		retn
PR_SetEnv	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR PR_Init_0

loc_1000C860:				; CODE XREF: PR_Init_0+152j
		push	offset off_1002A1C0
		call	PR_ErrorInstallTable
		pop	ecx
		retn
; END OF FUNCTION CHUNK	FOR PR_Init_0
; ---------------------------------------------------------------------------
		align 10h
; Exported entry 151. PR_GetError

; =============== S U B	R O U T	I N E =======================================


		public PR_GetError
PR_GetError	proc near		; CODE XREF: sub_10010080:loc_100102C9p
					; PR_QueueJob_Connect+1Dp ...
		call	PR_GetCurrentThread
		mov	eax, [eax+28h]
		retn
PR_GetError	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 172. PR_GetOSError

; =============== S U B	R O U T	I N E =======================================


		public PR_GetOSError
PR_GetOSError	proc near		; CODE XREF: sub_100113B0+8Bp
					; sub_10015080+18Cp ...
		call	PR_GetCurrentThread
		mov	eax, [eax+2Ch]
		retn
PR_GetOSError	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 324. PR_SetError

; =============== S U B	R O U T	I N E =======================================


		public PR_SetError
PR_SetError	proc near		; CODE XREF: sub_100014E0+17p
					; sub_100016E0+89p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		call	PR_GetCurrentThread
		mov	ecx, [esp+arg_0]
		mov	edx, [esp+arg_4]
		mov	[eax+28h], ecx
		mov	[eax+2Ch], edx
		mov	dword ptr [eax+30h], 0
		retn
PR_SetError	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 325. PR_SetErrorText

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SetErrorText(int, void	*Src)
		public PR_SetErrorText
PR_SetErrorText	proc near		; CODE XREF: sub_10007EC0+42p
					; sub_10008220+124p ...

arg_0		= dword	ptr  4
Src		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_GetCurrentThread
		mov	ebx, [esp+10h+arg_0]
		xor	ebp, ebp
		mov	esi, eax
		cmp	ebx, ebp
		jnz	short loc_1000C8E3
		mov	eax, [esi+38h]
		cmp	eax, ebp
		jz	short loc_1000C8D8
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esi+38h], ebp

loc_1000C8D8:				; CODE XREF: PR_SetErrorText+1Aj
		pop	edi
		mov	[esi+34h], ebp
		mov	[esi+30h], ebx
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000C8E3:				; CODE XREF: PR_SetErrorText+13j
		lea	edi, [ebx+1Fh]
		inc	ebx
		cmp	[esi+34h], ebx
		jge	short loc_1000C91D
		mov	eax, [esi+38h]
		cmp	eax, ebp
		jz	short loc_1000C8FF
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esi+38h], ebp

loc_1000C8FF:				; CODE XREF: PR_SetErrorText+41j
		push	edi		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[esi+38h], eax
		cmp	eax, ebp
		jnz	short loc_1000C91A
		pop	edi
		mov	[esi+34h], ebp
		mov	[esi+30h], ebp
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000C91A:				; CODE XREF: PR_SetErrorText+5Dj
		mov	[esi+34h], edi

loc_1000C91D:				; CODE XREF: PR_SetErrorText+3Aj
		mov	eax, [esp+10h+Src]
		mov	ecx, [esi+38h]
		push	ebx		; Size
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	ebx, [esp+1Ch+arg_0]
		add	esp, 0Ch
		pop	edi
		mov	[esi+30h], ebx
		pop	esi
		pop	ebp
		pop	ebx
		retn
PR_SetErrorText	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 153. PR_GetErrorTextLength

; =============== S U B	R O U T	I N E =======================================


		public PR_GetErrorTextLength
PR_GetErrorTextLength proc near		; DATA XREF: .rdata:off_1002C7C8o
		call	PR_GetCurrentThread
		mov	eax, [eax+30h]
		retn
PR_GetErrorTextLength endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 152. PR_GetErrorText

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetErrorText(void *Dst)
		public PR_GetErrorText
PR_GetErrorText	proc near		; DATA XREF: .rdata:off_1002C7C8o

Dst		= dword	ptr  4

		push	esi
		call	PR_GetCurrentThread
		mov	esi, eax
		mov	eax, [esi+30h]
		test	eax, eax
		jz	short loc_1000C975
		mov	ecx, [esp+4+Dst]
		inc	eax
		push	eax		; Size
		mov	eax, [esi+38h]
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	eax, [esi+30h]
		add	esp, 0Ch

loc_1000C975:				; CODE XREF: PR_GetErrorText+Dj
		pop	esi
		retn
PR_GetErrorText	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000C980	proc near		; CODE XREF: PR_ErrorToString+B4p
		sar	edx, 8
		and	edx, 0FFFFFFh
		mov	ecx, edx
		sar	ecx, 18h
		and	ecx, 3Fh
		mov	eax, offset byte_100314E4
		jz	short loc_1000C9A8
		mov	al, ds:byte_1002A1DF[ecx]
		mov	byte_100314E4, al
		mov	eax, offset byte_100314E5

loc_1000C9A8:				; CODE XREF: sub_1000C980+16j
		push	esi
		mov	esi, edx
		sar	esi, 12h
		and	esi, 3Fh
		jz	short loc_1000C9BC
		mov	cl, ds:byte_1002A1DF[esi]
		mov	[eax], cl
		inc	eax

loc_1000C9BC:				; CODE XREF: sub_1000C980+31j
		mov	esi, edx
		sar	esi, 0Ch
		and	esi, 3Fh
		jz	short loc_1000C9CF
		mov	cl, ds:byte_1002A1DF[esi]
		mov	[eax], cl
		inc	eax

loc_1000C9CF:				; CODE XREF: sub_1000C980+44j
		mov	esi, edx
		sar	esi, 6
		and	esi, 3Fh
		jz	short loc_1000C9E2
		mov	cl, ds:byte_1002A1DF[esi]
		mov	[eax], cl
		inc	eax

loc_1000C9E2:				; CODE XREF: sub_1000C980+57j
		and	edx, 3Fh
		pop	esi
		jz	short loc_1000C9FA
		mov	dl, ds:byte_1002A1DF[edx]
		mov	[eax], dl
		mov	byte ptr [eax+1], 0
		mov	eax, offset byte_100314E4
		retn
; ---------------------------------------------------------------------------

loc_1000C9FA:				; CODE XREF: sub_1000C980+66j
		mov	byte ptr [eax],	0
		mov	eax, offset byte_100314E4
		retn
sub_1000C980	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 111. PR_ErrorToString

; =============== S U B	R O U T	I N E =======================================


		public PR_ErrorToString
PR_ErrorToString proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, dword_10031508
		test	edi, edi
		jz	short loc_1000CA38

loc_1000CA20:				; CODE XREF: PR_ErrorToString+26j
		mov	eax, [edi+4]
		cmp	[eax+8], esi
		jg	short loc_1000CA32
		mov	ecx, [eax+0Ch]
		add	ecx, [eax+8]
		cmp	ecx, esi
		jg	short loc_1000CA4D

loc_1000CA32:				; CODE XREF: PR_ErrorToString+16j
		mov	edi, [edi]
		test	edi, edi
		jnz	short loc_1000CA20

loc_1000CA38:				; CODE XREF: PR_ErrorToString+Ej
		cmp	esi, 0FFh
		ja	short loc_1000CA87
		push	esi		; int
		call	ds:strerror
		add	esp, 4
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000CA4D:				; CODE XREF: PR_ErrorToString+20j
		mov	eax, dword_10031510
		test	eax, eax
		jz	short loc_1000CA78
		mov	edx, [edi+8]
		mov	ecx, dword_1003150C
		push	edx
		mov	edx, [edi+4]
		push	ecx
		mov	ecx, [esp+10h+arg_4]
		push	edx
		push	ecx
		push	esi
		call	eax ; dword_10031510
		add	esp, 14h
		test	eax, eax
		jnz	loc_1000CB81

loc_1000CA78:				; CODE XREF: PR_ErrorToString+44j
		mov	edi, [edi+4]
		sub	esi, [edi+8]
		mov	edx, [edi]
		mov	eax, [edx+esi*8+4]
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000CA87:				; CODE XREF: PR_ErrorToString+2Ej
		mov	eax, ds:dword_1002A220
		mov	ecx, ds:dword_1002A224
		push	ebx
		mov	ebx, esi
		and	ebx, 0FFh
		mov	dword_100314EC,	eax
		mov	eax, ds:dword_1002A228
		mov	dword_100314F0,	ecx
		mov	cx, ds:word_1002A22C
		sub	esi, ebx
		mov	edx, esi
		mov	dword_100314F4,	eax
		mov	word_100314F8, cx
		jz	short loc_1000CB12
		call	sub_1000C980
		mov	esi, eax
		jmp	short loc_1000CAD0
; ---------------------------------------------------------------------------
		align 10h

loc_1000CAD0:				; CODE XREF: PR_ErrorToString+BBj
					; PR_ErrorToString+C5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CAD0
		mov	edi, offset dword_100314EC
		sub	eax, esi
		dec	edi
		nop

loc_1000CAE0:				; CODE XREF: PR_ErrorToString+D6j
		mov	cl, [edi+1]
		inc	edi
		test	cl, cl
		jnz	short loc_1000CAE0
		mov	ecx, eax
		shr	ecx, 2
		rep movsd
		mov	ecx, eax
		and	ecx, 3
		rep movsb
		mov	edi, offset dword_100314EC
		dec	edi
		lea	esp, [esp+0]

loc_1000CB00:				; CODE XREF: PR_ErrorToString+F6j
		mov	al, [edi+1]
		inc	edi
		test	al, al
		jnz	short loc_1000CB00
		mov	dx, ds:word_10028648
		mov	[edi], dx

loc_1000CB12:				; CODE XREF: PR_ErrorToString+B2j
		cmp	byte ptr dword_100314EC, 0
		mov	ecx, offset dword_100314EC
		jz	short loc_1000CB26

loc_1000CB20:				; CODE XREF: PR_ErrorToString+114j
		inc	ecx
		cmp	byte ptr [ecx],	0
		jnz	short loc_1000CB20

loc_1000CB26:				; CODE XREF: PR_ErrorToString+10Ej
		cmp	ebx, 64h
		jl	short loc_1000CB49
		mov	eax, 51EB851Fh
		imul	ebx
		sar	edx, 5
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		lea	edx, [eax+30h]
		imul	eax, -64h
		mov	[ecx], dl
		inc	ecx
		add	ebx, eax
		jmp	short loc_1000CB4E
; ---------------------------------------------------------------------------

loc_1000CB49:				; CODE XREF: PR_ErrorToString+119j
		cmp	ebx, 0Ah
		jl	short loc_1000CB72

loc_1000CB4E:				; CODE XREF: PR_ErrorToString+137j
		mov	eax, 66666667h
		imul	ebx
		sar	edx, 2
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		lea	edx, [eax+30h]
		mov	[ecx], dl
		mov	edx, eax
		neg	edx
		add	edx, edx
		add	edx, edx
		inc	ecx
		sub	edx, eax
		lea	ebx, [ebx+edx*2]

loc_1000CB72:				; CODE XREF: PR_ErrorToString+13Cj
		add	bl, 30h
		mov	[ecx], bl
		mov	byte ptr [ecx+1], 0
		mov	eax, offset dword_100314EC
		pop	ebx

loc_1000CB81:				; CODE XREF: PR_ErrorToString+62j
		pop	edi
		pop	esi
		retn
PR_ErrorToString endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 110. PR_ErrorToName

; =============== S U B	R O U T	I N E =======================================


		public PR_ErrorToName
PR_ErrorToName	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, dword_10031508
		push	esi
		test	eax, eax
		jz	short loc_1000CBB8
		mov	edx, [esp+4+arg_0]
		mov	edi, edi

loc_1000CBA0:				; CODE XREF: PR_ErrorToName+26j
		mov	ecx, [eax+4]
		cmp	[ecx+8], edx
		jg	short loc_1000CBB2
		mov	esi, [ecx+0Ch]
		add	esi, [ecx+8]
		cmp	esi, edx
		jg	short loc_1000CBBC

loc_1000CBB2:				; CODE XREF: PR_ErrorToName+16j
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_1000CBA0

loc_1000CBB8:				; CODE XREF: PR_ErrorToName+8j
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000CBBC:				; CODE XREF: PR_ErrorToName+20j
		mov	eax, ecx
		sub	edx, [eax+8]
		mov	eax, [eax]
		mov	eax, [eax+edx*8]
		pop	esi
		retn
PR_ErrorToName	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 109. PR_ErrorLanguages

; =============== S U B	R O U T	I N E =======================================


		public PR_ErrorLanguages
PR_ErrorLanguages proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, off_100302AC
		retn
PR_ErrorLanguages endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 108. PR_ErrorInstallTable

; =============== S U B	R O U T	I N E =======================================


		public PR_ErrorInstallTable
PR_ErrorInstallTable proc near		; CODE XREF: PR_Init_0-9CBp
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		push	0Ch		; Size
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000CBFB
		call	ds:_errno
		mov	eax, [eax]
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000CBFB:				; CODE XREF: PR_ErrorInstallTable+Fj
		mov	ecx, dword_10031514
		mov	eax, [esp+4+arg_0]
		mov	[esi+4], eax
		test	ecx, ecx
		jz	short loc_1000CC2D
		mov	edx, dword_1003150C
		push	edx
		push	eax
		call	ecx ; dword_10031514
		mov	[esi+8], eax
		mov	eax, dword_10031508
		add	esp, 8
		mov	[esi], eax
		mov	dword_10031508,	esi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000CC2D:				; CODE XREF: PR_ErrorInstallTable+2Aj
		mov	eax, dword_10031508
		mov	[esi], eax
		mov	dword ptr [esi+8], 0
		mov	dword_10031508,	esi
		xor	eax, eax
		pop	esi
		retn
PR_ErrorInstallTable endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 107. PR_ErrorInstallCallback

; =============== S U B	R O U T	I N E =======================================


		public PR_ErrorInstallCallback
PR_ErrorInstallCallback	proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_C]
		mov	off_100302AC, eax
		mov	eax, [esp+arg_8]
		mov	dword_10031510,	ecx
		mov	dword_10031514,	eax
		mov	dword_1003150C,	edx
		test	eax, eax
		jz	short locret_1000CCA2
		push	esi
		mov	esi, dword_10031508
		test	esi, esi
		jz	short loc_1000CCA1

loc_1000CC85:				; CODE XREF: PR_ErrorInstallCallback+4Fj
		mov	eax, dword_1003150C
		mov	ecx, [esi+4]
		push	eax
		push	ecx
		call	dword_10031514
		mov	[esi+8], eax
		mov	esi, [esi]
		add	esp, 8
		test	esi, esi
		jnz	short loc_1000CC85

loc_1000CCA1:				; CODE XREF: PR_ErrorInstallCallback+33j
		pop	esi

locret_1000CCA2:			; CODE XREF: PR_ErrorInstallCallback+28j
		retn
PR_ErrorInstallCallback	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 370. PR_VersionCheck

; =============== S U B	R O U T	I N E =======================================


		public PR_VersionCheck
PR_VersionCheck	proc near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		movsx	eax, byte ptr [esi]
		push	edi
		mov	edi, ds:isdigit
		xor	ebp, ebp
		push	eax		; C
		xor	ebx, ebx
		mov	[esp+18h+var_4], ebp
		call	edi ; isdigit
		add	esp, 4
		test	eax, eax
		jz	short loc_1000CCEE

loc_1000CCD4:				; CODE XREF: PR_VersionCheck+3Cj
		movsx	edx, byte ptr [esi]
		movsx	eax, byte ptr [esi+1]
		inc	esi
		lea	ecx, [ebp+ebp*4+0]
		push	eax		; C
		lea	ebp, [edx+ecx*2-30h]
		call	edi ; isdigit
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000CCD4

loc_1000CCEE:				; CODE XREF: PR_VersionCheck+22j
		cmp	byte ptr [esi],	2Eh
		jnz	short loc_1000CD51
		movsx	ecx, byte ptr [esi+1]
		inc	esi
		push	ecx		; C
		call	edi ; isdigit
		add	esp, 4
		test	eax, eax
		jz	short loc_1000CD1B

loc_1000CD02:				; CODE XREF: PR_VersionCheck+69j
		movsx	eax, byte ptr [esi]
		movsx	ecx, byte ptr [esi+1]
		inc	esi
		lea	edx, [ebx+ebx*4]
		push	ecx		; C
		lea	ebx, [eax+edx*2-30h]
		call	edi ; isdigit
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000CD02

loc_1000CD1B:				; CODE XREF: PR_VersionCheck+50j
		cmp	byte ptr [esi],	2Eh
		jnz	short loc_1000CD51
		movsx	edx, byte ptr [esi+1]
		inc	esi
		push	edx		; C
		call	edi ; isdigit
		add	esp, 4
		test	eax, eax
		jz	short loc_1000CD51
		nop

loc_1000CD30:				; CODE XREF: PR_VersionCheck+9Fj
		movsx	ecx, byte ptr [esi]
		mov	eax, [esp+14h+var_4]
		lea	eax, [eax+eax*4]
		lea	edx, [ecx+eax*2-30h]
		movsx	eax, byte ptr [esi+1]
		inc	esi
		push	eax		; C
		mov	[esp+18h+var_4], edx
		call	edi ; isdigit
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000CD30

loc_1000CD51:				; CODE XREF: PR_VersionCheck+41j
					; PR_VersionCheck+6Ej ...
		cmp	ebp, 4
		jz	short loc_1000CD5E

loc_1000CD56:				; CODE XREF: PR_VersionCheck+B1j
					; PR_VersionCheck+BAj
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000CD5E:				; CODE XREF: PR_VersionCheck+A4j
		cmp	ebx, 0Ah
		jg	short loc_1000CD56
		jnz	short loc_1000CD6C
		cmp	[esp+14h+var_4], 7
		jg	short loc_1000CD56

loc_1000CD6C:				; CODE XREF: PR_VersionCheck+B3j
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		pop	ecx
		retn
PR_VersionCheck	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 206. PR_GetVersion

; =============== S U B	R O U T	I N E =======================================


		public PR_GetVersion
PR_GetVersion	proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, offset a4_10_7 ; "4.10.7"
		retn
PR_GetVersion	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 217. PR_Initialized

; =============== S U B	R O U T	I N E =======================================


		public PR_Initialized
PR_Initialized	proc near		; CODE XREF: sub_10012000+6p
					; PR_LocalTimeParameters+1Ep
					; DATA XREF: ...
		mov	eax, dword_10031520
		retn
PR_Initialized	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000CDA0	proc near		; CODE XREF: PR_Init_0+17p
		push	0		; lpModuleName
		call	ds:GetModuleHandleA
		push	offset ProcName	; "nspr_native_threads_only"
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_1000CDC6
		xor	ecx, ecx
		cmp	[eax], ecx
		setnz	cl
		mov	dword_10031524,	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000CDC6:				; CODE XREF: sub_1000CDA0+16j
		push	offset aNspr_native__0 ; "NSPR_NATIVE_THREADS_ONLY"
		call	ds:__imp_getenv
		add	esp, 4
		test	eax, eax
		jz	short locret_1000CDED
		push	eax		; Str
		call	ds:atoi
		dec	eax
		add	esp, 4
		neg	eax
		sbb	eax, eax
		inc	eax
		mov	dword_10031524,	eax

locret_1000CDED:			; CODE XREF: sub_1000CDA0+36j
		retn
sub_1000CDA0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  20. PR_AssertCurrentThreadInMonitor
; Exported entry  32. PR_BlockClockInterrupts
; Exported entry  97. PR_DetachThread
; Exported entry 364. PR_UnblockClockInterrupts
; Exported entry 402. PT_FPrintStats

; =============== S U B	R O U T	I N E =======================================


		public PT_FPrintStats
PT_FPrintStats	proc near		; CODE XREF: PR_Init_0+CBp
					; PR_Init_0+D0p ...
		retn			; PR_AssertCurrentThreadInMonitor
PT_FPrintStats	endp			; PR_BlockClockInterrupts
					; PR_DetachThread
					; PR_UnblockClockInterrupts
; ---------------------------------------------------------------------------
		align 10h
; Exported entry 288. PR_ProcessExit
; [00000005 BYTES: COLLAPSED FUNCTION PR_ProcessExit]
		align 10h
; Exported entry 257. PR_NewProcessAttr

; =============== S U B	R O U T	I N E =======================================


		public PR_NewProcessAttr
PR_NewProcessAttr proc near		; DATA XREF: .rdata:off_1002C7C8o
		push	esi
		push	1Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_1000CE33
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		mov	eax, esi

loc_1000CE33:				; CODE XREF: PR_NewProcessAttr+11j
		pop	esi
		retn
PR_NewProcessAttr endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 307. PR_ResetProcessAttr

; =============== S U B	R O U T	I N E =======================================


		public PR_ResetProcessAttr
PR_ResetProcessAttr proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_1000CE5C
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword ptr [esi+0Ch], 0

loc_1000CE5C:				; CODE XREF: PR_ResetProcessAttr+Aj
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_1000CE73
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword ptr [esi+10h], 0

loc_1000CE73:				; CODE XREF: PR_ResetProcessAttr+21j
		xor	eax, eax
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	[esi+0Ch], eax
		mov	[esi+10h], eax
		mov	[esi+14h], eax
		mov	[esi+18h], eax
		pop	esi
		retn
PR_ResetProcessAttr endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  88. PR_DestroyProcessAttr

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyProcessAttr(void *Memory)
		public PR_DestroyProcessAttr
PR_DestroyProcessAttr proc near		; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_1000CEAC
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword ptr [esi+0Ch], 0

loc_1000CEAC:				; CODE XREF: PR_DestroyProcessAttr+Aj
		mov	eax, [esi+10h]
		test	eax, eax
		jz	short loc_1000CEC3
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword ptr [esi+10h], 0

loc_1000CEC3:				; CODE XREF: PR_DestroyProcessAttr+21j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	esi
		retn
PR_DestroyProcessAttr endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 287. PR_ProcessAttrSetStdioRedirect
; Exported entry 334. PR_SetStdioRedirect

; =============== S U B	R O U T	I N E =======================================


		public PR_SetStdioRedirect
PR_SetStdioRedirect proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4] ; PR_ProcessAttrSetStdioRedirect
		sub	eax, 0
		jz	short loc_1000CEF7
		dec	eax
		jz	short loc_1000CEEB
		dec	eax
		jnz	short locret_1000CF01
		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_0]
		mov	[ecx+8], eax
		retn
; ---------------------------------------------------------------------------

loc_1000CEEB:				; CODE XREF: PR_SetStdioRedirect+Aj
		mov	edx, [esp+arg_8]
		mov	eax, [esp+arg_0]
		mov	[eax+4], edx
		retn
; ---------------------------------------------------------------------------

loc_1000CEF7:				; CODE XREF: PR_SetStdioRedirect+7j
		mov	ecx, [esp+arg_8]
		mov	edx, [esp+arg_0]
		mov	[edx], ecx

locret_1000CF01:			; CODE XREF: PR_SetStdioRedirect+Dj
		retn
PR_SetStdioRedirect endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 284. PR_ProcessAttrSetCurrentDirectory

; =============== S U B	R O U T	I N E =======================================


		public PR_ProcessAttrSetCurrentDirectory
PR_ProcessAttrSetCurrentDirectory proc near ; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+0Ch]
		push	edi
		test	eax, eax
		jz	short loc_1000CF2D
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword ptr [esi+0Ch], 0

loc_1000CF2D:				; CODE XREF: PR_ProcessAttrSetCurrentDirectory+Bj
		mov	edi, [esp+8+arg_4]
		mov	eax, edi
		lea	edx, [eax+1]

loc_1000CF36:				; CODE XREF: PR_ProcessAttrSetCurrentDirectory+2Bj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CF36
		sub	eax, edx
		inc	eax
		push	eax		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[esi+0Ch], eax
		test	eax, eax
		jnz	short loc_1000CF64
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000CF64:				; CODE XREF: PR_ProcessAttrSetCurrentDirectory+3Ej
		mov	ecx, edi
		mov	edx, eax

loc_1000CF68:				; CODE XREF: PR_ProcessAttrSetCurrentDirectory+60j
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_1000CF68
		pop	edi
		xor	eax, eax
		pop	esi
		retn
PR_ProcessAttrSetCurrentDirectory endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 285. PR_ProcessAttrSetInheritableFD

; =============== S U B	R O U T	I N E =======================================


		public PR_ProcessAttrSetInheritableFD
PR_ProcessAttrSetInheritableFD proc near ; DATA	XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_4]
		cmp	dword ptr [ebx+14h], 0
		jz	short loc_1000CF9F
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000CF9F:				; CODE XREF: PR_ProcessAttrSetInheritableFD+9j
		mov	eax, [ebx+4]
		cmp	dword ptr [eax+8], 0FFFFFFFFh
		jnz	short loc_1000CFB1
		push	ebx
		call	sub_100211E0
		add	esp, 4

loc_1000CFB1:				; CODE XREF: PR_ProcessAttrSetInheritableFD+26j
		mov	ecx, [ebx+4]
		cmp	dword ptr [ecx+8], 1
		jz	short loc_1000CFCE
		push	0
		push	0FFFFE8B2h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000CFCE:				; CODE XREF: PR_ProcessAttrSetInheritableFD+38j
		mov	eax, [esp+4+arg_8]
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	ebp, [edi+10h]
		lea	edx, [eax+1]
		test	ebp, ebp
		jnz	short loc_1000CFF1

loc_1000CFE3:				; CODE XREF: PR_ProcessAttrSetInheritableFD+68j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CFE3
		sub	eax, edx
		lea	esi, [eax+1Fh]
		jmp	short loc_1000D001
; ---------------------------------------------------------------------------

loc_1000CFF1:				; CODE XREF: PR_ProcessAttrSetInheritableFD+61j
					; PR_ProcessAttrSetInheritableFD+76j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000CFF1
		sub	eax, edx
		mov	edx, [edi+18h]
		lea	esi, [edx+eax+0Fh]

loc_1000D001:				; CODE XREF: PR_ProcessAttrSetInheritableFD+6Fj
		cmp	esi, [edi+14h]
		jbe	short loc_1000D04E
		mov	eax, esi
		and	eax, 7Fh
		jz	short loc_1000D016
		mov	ecx, 80h
		sub	ecx, eax
		add	esi, ecx

loc_1000D016:				; CODE XREF: PR_ProcessAttrSetInheritableFD+8Bj
		push	esi		; NewSize
		test	ebp, ebp
		jnz	short loc_1000D025
		call	PR_Malloc
		add	esp, 4
		jmp	short loc_1000D02E
; ---------------------------------------------------------------------------

loc_1000D025:				; CODE XREF: PR_ProcessAttrSetInheritableFD+99j
		push	ebp		; Memory
		call	PR_Realloc
		add	esp, 8

loc_1000D02E:				; CODE XREF: PR_ProcessAttrSetInheritableFD+A3j
		test	eax, eax
		jnz	short loc_1000D048
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D048:				; CODE XREF: PR_ProcessAttrSetInheritableFD+B0j
		mov	[edi+10h], eax
		mov	[edi+14h], esi

loc_1000D04E:				; CODE XREF: PR_ProcessAttrSetInheritableFD+84j
		mov	edx, [edi+18h]
		mov	eax, [edi+10h]
		mov	ecx, [edi+14h]
		add	eax, edx
		sub	ecx, edx
		test	edx, edx
		mov	edx, [ebx+4]
		mov	edx, [edx+28h]
		push	edx
		mov	edx, [ebx]
		mov	edx, [edx]
		push	edx
		mov	edx, [esp+18h+arg_8]
		push	edx
		jnz	short loc_1000D089
		push	offset aNspr_inherit_f ; "NSPR_INHERIT_FDS=%s:%d:0x%lx"
		push	ecx
		push	eax
		call	PR_snprintf
		add	[edi+18h], eax
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000D089:				; CODE XREF: PR_ProcessAttrSetInheritableFD+EEj
		push	offset aSD0xLx	; ":%s:%d:0x%lx"
		push	ecx
		push	eax
		call	PR_snprintf
		add	[edi+18h], eax
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
PR_ProcessAttrSetInheritableFD endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 162. PR_GetInheritedFD

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetInheritedFD(char *Str2)
		public PR_GetInheritedFD
PR_GetInheritedFD proc near		; DATA XREF: .rdata:off_1002C7C8o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
Str2		= dword	ptr  4

		sub	esp, 8
		push	ebp
		mov	ebp, [esp+0Ch+Str2]
		mov	eax, ebp
		push	edi
		lea	edx, [eax+1]
		mov	edi, edi

loc_1000D0C0:				; CODE XREF: PR_GetInheritedFD+15j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000D0C0
		sub	eax, edx
		push	offset aNspr_inherit_0 ; "NSPR_INHERIT_FDS"
		mov	edi, eax
		call	PR_GetEnv
		add	esp, 4
		test	eax, eax
		jz	loc_1000D1B7
		cmp	byte ptr [eax],	0
		jz	loc_1000D1B7
		push	ebx
		mov	ebx, ds:strncmp
		push	esi
		mov	esi, eax

loc_1000D0F3:				; CODE XREF: PR_GetInheritedFD+91j
		cmp	byte ptr [esi+edi], 3Ah
		jnz	short loc_1000D105
		push	edi		; MaxCount
		push	ebp		; Str2
		push	esi		; Str1
		call	ebx ; strncmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000D143

loc_1000D105:				; CODE XREF: PR_GetInheritedFD+47j
		mov	al, [esi]
		xor	ecx, ecx
		test	al, al
		jz	short loc_1000D122 ; jumptable 1000D169	default	case
		lea	ecx, [ecx+0]

loc_1000D110:				; CODE XREF: PR_GetInheritedFD+70j
		cmp	al, 3Ah
		jnz	short loc_1000D11A
		inc	ecx
		cmp	ecx, 3
		jz	short loc_1000D13B

loc_1000D11A:				; CODE XREF: PR_GetInheritedFD+62j
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_1000D110

loc_1000D122:				; CODE XREF: PR_GetInheritedFD+5Bj
					; PR_GetInheritedFD+8Ej ...
		push	0		; jumptable 1000D169 default case
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		xor	eax, eax

loc_1000D133:				; CODE XREF: PR_GetInheritedFD+F3j
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000D13B:				; CODE XREF: PR_GetInheritedFD+68j
		cmp	byte ptr [esi],	0
		jz	short loc_1000D122 ; jumptable 1000D169	default	case
		inc	esi
		jmp	short loc_1000D0F3
; ---------------------------------------------------------------------------

loc_1000D143:				; CODE XREF: PR_GetInheritedFD+53j
		lea	eax, [esp+18h+var_8]
		push	eax
		lea	ecx, [esp+1Ch+var_4]
		push	ecx
		lea	edx, [esi+edi+1]
		push	offset aD0xLx	; "%d:0x%lx"
		push	edx
		call	PR_sscanf
		mov	eax, [esp+28h+var_4]
		dec	eax
		add	esp, 10h
		cmp	eax, 4		; switch 5 cases
		ja	short loc_1000D122 ; jumptable 1000D169	default	case
		jmp	ds:off_1000D1D0[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000D170:				; CODE XREF: PR_GetInheritedFD+B9j
					; DATA XREF: .text:off_1000D1D0o
		mov	eax, [esp+18h+var_8] ; jumptable 1000D169 case 0
		push	eax
		call	PR_ImportFile
		jmp	short loc_1000D19E
; ---------------------------------------------------------------------------

loc_1000D17C:				; CODE XREF: PR_GetInheritedFD+B9j
					; DATA XREF: .text:off_1000D1D0o
		mov	ecx, [esp+18h+var_8] ; jumptable 1000D169 case 4
		push	ecx
		call	PR_ImportPipe
		jmp	short loc_1000D19E
; ---------------------------------------------------------------------------

loc_1000D188:				; CODE XREF: PR_GetInheritedFD+B9j
					; DATA XREF: .text:off_1000D1D0o
		mov	edx, [esp+18h+var_8] ; jumptable 1000D169 case 1
		push	edx
		call	PR_ImportTCPSocket
		jmp	short loc_1000D19E
; ---------------------------------------------------------------------------

loc_1000D194:				; CODE XREF: PR_GetInheritedFD+B9j
					; DATA XREF: .text:off_1000D1D0o
		mov	eax, [esp+18h+var_8] ; jumptable 1000D169 case 2
		push	eax
		call	PR_ImportUDPSocket

loc_1000D19E:				; CODE XREF: PR_GetInheritedFD+CAj
					; PR_GetInheritedFD+D6j ...
		add	esp, 4
		test	eax, eax
		jz	short loc_1000D133
		mov	ecx, [eax+4]
		pop	esi
		pop	ebx
		pop	edi
		mov	dword ptr [ecx+8], 1
		pop	ebp
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000D1B7:				; CODE XREF: PR_GetInheritedFD+2Aj
					; PR_GetInheritedFD+33j
		push	0
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	ebp
		add	esp, 8
		retn
PR_GetInheritedFD endp

; ---------------------------------------------------------------------------
		align 10h
off_1000D1D0	dd offset loc_1000D170	; DATA XREF: PR_GetInheritedFD+B9r
		dd offset loc_1000D188	; jump table for switch	statement
		dd offset loc_1000D194
		dd offset loc_1000D122
		dd offset loc_1000D17C
		align 10h
; Exported entry  67. PR_CreateProcess
; [00000005 BYTES: COLLAPSED FUNCTION PR_CreateProcess]
		align 10h
; Exported entry  95. PR_DetachProcess
; [00000005 BYTES: COLLAPSED FUNCTION PR_DetachProcess]
		align 10h
; Exported entry 374. PR_WaitProcess
; [00000005 BYTES: COLLAPSED FUNCTION PR_WaitProcess]
		align 10h
; Exported entry 227. PR_KillProcess
; [00000005 BYTES: COLLAPSED FUNCTION PR_KillProcess]
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_Init_0	proc near		; CODE XREF: PR_Initj
					; PR_EnableClockInterrupts+9j ...

; FUNCTION CHUNK AT 1000C860 SIZE 0000000C BYTES

		cmp	dword_10031520,	0
		jnz	locret_1000D387
		mov	dword_10031520,	1
		call	sub_1000CDA0
		call	PR_GetPageSize
		push	offset aClock	; "clock"
		call	PR_NewLogModule
		push	offset aCmon	; "cmon"
		mov	dword_10032AFC,	eax
		call	PR_NewLogModule
		push	offset aIo	; "io"
		mov	dword_10032A94,	eax
		call	PR_NewLogModule
		push	offset aMon	; "mon"
		mov	dword_10032A98,	eax
		call	PR_NewLogModule
		push	offset aLinker	; "linker"
		mov	dword_10032A8C,	eax
		call	PR_NewLogModule
		push	offset aCvar	; "cvar"
		mov	dword_10032AC0,	eax
		call	PR_NewLogModule
		push	offset aSched	; "sched"
		mov	dword_10032B00,	eax
		call	PR_NewLogModule
		push	offset aThread	; "thread"
		mov	dword_10032AB4,	eax
		call	PR_NewLogModule
		push	offset aGc	; "gc"
		mov	dword_10032A90,	eax
		call	PR_NewLogModule
		push	offset aShm	; "shm"
		mov	dword_10032B04,	eax
		call	PR_NewLogModule
		push	offset aShma	; "shma"
		mov	dword_10032AA8,	eax
		call	PR_NewLogModule
		mov	dword_10032AA4,	eax
		call	sub_10024420
		call	PT_FPrintStats
		call	PT_FPrintStats
		call	PT_FPrintStats
		call	sub_10019840
		call	sub_10007CB0
		call	sub_1000C780
		call	sub_10003EA0
		call	j_PT_FPrintStats
		call	PR_NewLock
		push	0
		push	1
		push	0
		mov	dword_10032AA0,	eax
		call	sub_1001BD30
		call	sub_100181C0
		call	sub_100076F0
		call	sub_10014A90
		call	sub_1000DA90
		call	sub_10012060
		call	sub_10004F10
		call	sub_10007F20
		call	PR_NewLock
		push	eax
		mov	dword_10031518,	eax
		call	PR_NewCondVar
		add	esp, 3Ch
		mov	dword_1003151C,	eax
		call	sub_10009810
		call	sub_100016A0
		call	PT_FPrintStats
		jmp	loc_1000C860
; ---------------------------------------------------------------------------

locret_1000D387:			; CODE XREF: PR_Init_0+7j
		retn
PR_Init_0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 214. PR_Init
; [00000005 BYTES: COLLAPSED FUNCTION PR_Init]
		align 10h
; Exported entry  98. PR_DisableClockInterrupts
; Exported entry 101. PR_EnableClockInterrupts

; =============== S U B	R O U T	I N E =======================================


		public PR_EnableClockInterrupts
PR_EnableClockInterrupts proc near	; DATA XREF: .rdata:off_1002C7C8o
		cmp	dword_10031520,	0 ; PR_DisableClockInterrupts
		jnz	short locret_1000D3AE
		jmp	PR_Init_0
; ---------------------------------------------------------------------------

locret_1000D3AE:			; CODE XREF: PR_EnableClockInterrupts+7j
		retn
PR_EnableClockInterrupts endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  48. PR_Cleanup

; =============== S U B	R O U T	I N E =======================================


		public PR_Cleanup
PR_Cleanup	proc near		; CODE XREF: PR_Initialize+19p
					; DATA XREF: .rdata:off_1002C7C8o
		push	esi
		push	edi
		call	PR_GetCurrentThread
		mov	esi, eax
		xor	edi, edi
		cmp	esi, edi
		jz	loc_1000D54B
		test	byte ptr [esi+90h], 8
		jz	loc_1000D54B
		mov	eax, dword_10032A90
		cmp	dword ptr [eax+4], 4
		jl	short loc_1000D3E8
		push	offset aPr_cleanupShut ; "PR_Cleanup: shutting down NSPR"
		call	PR_LogPrint
		add	esp, 4

loc_1000D3E8:				; CODE XREF: PR_Cleanup+29j
		mov	ecx, dword_10032A60
		push	ecx
		mov	dword_10031598,	edi
		call	PR_Lock
		mov	edx, dword_10032AB8
		add	esp, 4
		cmp	edx, dword_10032A68
		jle	short loc_1000D42E
		jmp	short loc_1000D410
; ---------------------------------------------------------------------------
		align 10h

loc_1000D410:				; CODE XREF: PR_Cleanup+5Bj
					; PR_Cleanup+7Cj
		mov	eax, dword_10032A58
		push	0FFFFFFFFh
		push	eax
		call	PR_WaitCondVar
		mov	ecx, dword_10032AB8
		add	esp, 8
		cmp	ecx, dword_10032A68
		jg	short loc_1000D410

loc_1000D42E:				; CODE XREF: PR_Cleanup+59j
		mov	eax, 1
		test	[esi+90h], al
		jz	short loc_1000D443
		sub	dword_10032B08,	eax
		jmp	short loc_1000D449
; ---------------------------------------------------------------------------

loc_1000D443:				; CODE XREF: PR_Cleanup+89j
		sub	dword_10032AB8,	eax

loc_1000D449:				; CODE XREF: PR_Cleanup+91j
		mov	edx, dword_10032A60
		push	edx		; lpTlsValue
		call	PR_Unlock
		call	sub_10002130
		call	sub_10012070
		call	sub_10009830
		mov	eax, dword_10031518
		push	eax		; Memory
		call	PR_DestroyLock
		mov	ecx, dword_1003151C
		push	ecx		; Memory
		mov	dword_10031518,	edi
		call	PR_DestroyCondVar
		mov	dword_1003151C,	edi
		call	sub_10007FB0
		call	sub_1000DAA0
		call	sub_10014BD0
		push	esi
		call	sub_10016920
		mov	edx, dword_10032A90
		add	esp, 10h
		cmp	dword ptr [edx+4], 4
		jl	short loc_1000D4B8
		push	offset aPr_cleanupClea ; "PR_Cleanup: clean up before destroying "...
		call	PR_LogPrint
		add	esp, 4

loc_1000D4B8:				; CODE XREF: PR_Cleanup+F9j
		call	sub_100047A0
		test	byte ptr [esi+90h], 80h
		push	esi
		jz	short loc_1000D4D7
		call	sub_100247B0
		push	esi		; Memory
		call	sub_10019B50
		add	esp, 8
		jmp	short loc_1000D4F1
; ---------------------------------------------------------------------------

loc_1000D4D7:				; CODE XREF: PR_Cleanup+115j
		call	sub_10019BB0
		mov	eax, [esi+10h]
		push	eax		; Memory
		call	PR_Free
		push	esi		; Memory
		mov	[esi+10h], edi
		call	PR_Free
		add	esp, 0Ch

loc_1000D4F1:				; CODE XREF: PR_Cleanup+125j
		call	sub_10017C20
		call	sub_100198E0
		call	sub_10007710
		mov	ecx, dword_10032AA0
		push	ecx		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10032AA0,	edi
		call	sub_10003ED0
		call	sub_1000C790
		call	sub_10019850
		call	PT_FPrintStats
		mov	eax, dword_10032AF8
		cmp	eax, edi
		jz	short loc_1000D53B
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4

loc_1000D53B:				; CODE XREF: PR_Cleanup+180j
		call	sub_10024480
		mov	dword_10031520,	edi
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D54B:				; CODE XREF: PR_Cleanup+Dj
					; PR_Cleanup+1Aj
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
PR_Cleanup	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  68. PR_CreateProcessDetached

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateProcessDetached
PR_CreateProcessDetached proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		mov	edx, [esp+arg_4]
		push	esi
		push	eax
		mov	eax, [esp+8+arg_0]
		push	ecx
		push	edx
		push	eax
		call	PR_CreateProcess_0
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jz	short loc_1000D59A
		push	esi		; Memory
		call	PR_DetachProcess_0
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000D59F
		push	esi		; Memory
		call	PR_Free
		add	esp, 4

loc_1000D59A:				; CODE XREF: PR_CreateProcessDetached+21j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D59F:				; CODE XREF: PR_CreateProcessDetached+2Fj
		xor	eax, eax
		pop	esi
		retn
PR_CreateProcessDetached endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  40. PR_CallOnce

; =============== S U B	R O U T	I N E =======================================


		public PR_CallOnce
PR_CallOnce	proc near		; CODE XREF: sub_100037C0+Ap
					; _pr_push_ipv6toipv4_layer+Ap	...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword_10031520,	0
		jnz	short loc_1000D5BE
		call	PR_Init_0

loc_1000D5BE:				; CODE XREF: PR_CallOnce+7j
		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi], 0
		jnz	loc_1000D659
		lea	eax, [esi+4]
		push	1		; Value
		push	eax		; Target
		call	PR_AtomicSet
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000D616
		call	[esp+4+arg_4]
		mov	ecx, dword_10031518
		push	ecx
		mov	[esi+8], eax
		call	PR_Lock
		mov	edx, dword_1003151C
		push	edx
		mov	dword ptr [esi], 1
		call	PR_NotifyAllCondVar
		mov	eax, dword_10031518
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	eax, [esi+8]
		add	esp, 0Ch
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D616:				; CODE XREF: PR_CallOnce+2Cj
		mov	ecx, dword_10031518
		push	ecx
		call	PR_Lock
		add	esp, 4
		cmp	dword ptr [esi], 0
		jnz	short loc_1000D646
		lea	ebx, [ebx+0]

loc_1000D630:				; CODE XREF: PR_CallOnce+94j
		mov	edx, dword_1003151C
		push	0FFFFFFFFh
		push	edx
		call	PR_WaitCondVar
		add	esp, 8
		cmp	dword ptr [esi], 0
		jz	short loc_1000D630

loc_1000D646:				; CODE XREF: PR_CallOnce+78j
		mov	eax, dword_10031518
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	eax, [esi+8]
		add	esp, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D659:				; CODE XREF: PR_CallOnce+16j
		cmp	dword ptr [esi+8], 0
		jz	short loc_1000D66E
		push	0
		push	0FFFFE8DBh
		call	PR_SetError
		add	esp, 8

loc_1000D66E:				; CODE XREF: PR_CallOnce+ADj
		mov	eax, [esi+8]
		pop	esi
		retn
PR_CallOnce	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  41. PR_CallOnceWithArg

; =============== S U B	R O U T	I N E =======================================


		public PR_CallOnceWithArg
PR_CallOnceWithArg proc	near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_10031520,	0
		jnz	short loc_1000D68E
		call	PR_Init_0

loc_1000D68E:				; CODE XREF: PR_CallOnceWithArg+7j
		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi], 0
		jnz	loc_1000D729
		lea	eax, [esi+4]
		push	1		; Value
		push	eax		; Target
		call	PR_AtomicSet
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000D6EB
		mov	ecx, [esp+4+arg_8]
		push	ecx
		call	[esp+8+arg_4]
		mov	edx, dword_10031518
		push	edx
		mov	[esi+8], eax
		call	PR_Lock
		mov	eax, dword_1003151C
		push	eax
		mov	dword ptr [esi], 1
		call	PR_NotifyAllCondVar
		mov	ecx, dword_10031518
		push	ecx		; lpTlsValue
		call	PR_Unlock
		mov	eax, [esi+8]
		add	esp, 10h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D6EB:				; CODE XREF: PR_CallOnceWithArg+2Cj
		mov	edx, dword_10031518
		push	edx
		call	PR_Lock
		add	esp, 4
		cmp	dword ptr [esi], 0
		jnz	short loc_1000D715
		nop

loc_1000D700:				; CODE XREF: PR_CallOnceWithArg+93j
		mov	eax, dword_1003151C
		push	0FFFFFFFFh
		push	eax
		call	PR_WaitCondVar
		add	esp, 8
		cmp	dword ptr [esi], 0
		jz	short loc_1000D700

loc_1000D715:				; CODE XREF: PR_CallOnceWithArg+7Dj
		mov	ecx, dword_10031518
		push	ecx		; lpTlsValue
		call	PR_Unlock
		mov	eax, [esi+8]
		add	esp, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000D729:				; CODE XREF: PR_CallOnceWithArg+16j
		cmp	dword ptr [esi+8], 0
		jz	short loc_1000D73E
		push	0
		push	0FFFFE8DBh
		call	PR_SetError
		add	esp, 8

loc_1000D73E:				; CODE XREF: PR_CallOnceWithArg+ADj
		mov	eax, [esi+8]
		pop	esi
		retn
PR_CallOnceWithArg endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 215. PR_Initialize

; =============== S U B	R O U T	I N E =======================================


		public PR_Initialize
PR_Initialize	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		call	PR_Init_0
		mov	eax, [esp+4+arg_8]
		mov	ecx, [esp+4+arg_4]
		push	eax
		push	ecx
		call	[esp+0Ch+arg_0]
		add	esp, 8
		mov	esi, eax
		call	PR_Cleanup
		mov	eax, esi
		pop	esi
		retn
PR_Initialize	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000005 BYTES: COLLAPSED FUNCTION j_PT_FPrintStats]
		align 10h
; Exported entry 219. PR_IntervalNow

; =============== S U B	R O U T	I N E =======================================


		public PR_IntervalNow
PR_IntervalNow	proc near		; CODE XREF: .text:loc_1000145Fp
					; sub_100014E0:loc_10001503p ...
		cmp	dword_10031520,	0
		jnz	short loc_1000D79E
		call	PR_Init

loc_1000D79E:				; CODE XREF: PR_IntervalNow+7j
		jmp	timeGetTime
PR_IntervalNow	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 360. PR_TicksPerSecond

; =============== S U B	R O U T	I N E =======================================


		public PR_TicksPerSecond
PR_TicksPerSecond proc near		; CODE XREF: PR_Poll_0+389p
					; DATA XREF: .rdata:off_1002C7C8o
		cmp	dword_10031520,	0
		jnz	short loc_1000D7BE
		call	PR_Init

loc_1000D7BE:				; CODE XREF: PR_TicksPerSecond+7j
		jmp	sub_1001D270
PR_TicksPerSecond endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 311. PR_SecondsToInterval

; =============== S U B	R O U T	I N E =======================================


		public PR_SecondsToInterval
PR_SecondsToInterval proc near		; CODE XREF: sub_100026E0+9Ep
					; sub_1001EB70+2EBp ...

arg_0		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1000D7DE
		call	PR_Init

loc_1000D7DE:				; CODE XREF: PR_SecondsToInterval+7j
		call	sub_1001D270
		imul	eax, [esp+arg_0]
		retn
PR_SecondsToInterval endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 243. PR_MillisecondsToInterval

; =============== S U B	R O U T	I N E =======================================


		public PR_MillisecondsToInterval
PR_MillisecondsToInterval proc near	; CODE XREF: sub_100016A0+24p
					; sub_10023780+23p
					; DATA XREF: ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		cmp	dword_10031520,	edi
		jnz	short loc_1000D805
		call	PR_Init

loc_1000D805:				; CODE XREF: PR_MillisecondsToInterval+Ej
		call	sub_1001D270
		push	edi
		push	esi
		push	0
		push	eax
		call	sub_10026AB0
		push	0
		add	eax, 1F4h
		push	3E8h
		adc	edx, edi
		push	edx
		push	eax
		call	sub_10026AF0
		pop	edi
		pop	esi
		retn
PR_MillisecondsToInterval endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 242. PR_MicrosecondsToInterval

; =============== S U B	R O U T	I N E =======================================


		public PR_MicrosecondsToInterval
PR_MicrosecondsToInterval proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		xor	edi, edi
		cmp	dword_10031520,	edi
		jnz	short loc_1000D845
		call	PR_Init

loc_1000D845:				; CODE XREF: PR_MicrosecondsToInterval+Ej
		call	sub_1001D270
		push	edi
		push	esi
		push	0
		push	eax
		call	sub_10026AB0
		push	0
		add	eax, 7A120h
		push	0F4240h
		adc	edx, edi
		push	edx
		push	eax
		call	sub_10026AF0
		pop	edi
		pop	esi
		retn
PR_MicrosecondsToInterval endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 222. PR_IntervalToSeconds

; =============== S U B	R O U T	I N E =======================================


		public PR_IntervalToSeconds
PR_IntervalToSeconds proc near		; CODE XREF: sub_10002920+89p
					; sub_100229A0+1B3p ...

arg_0		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1000D87E
		call	PR_Init

loc_1000D87E:				; CODE XREF: PR_IntervalToSeconds+7j
		call	sub_1001D270
		mov	ecx, eax
		mov	eax, [esp+arg_0]
		xor	edx, edx
		div	ecx
		retn
PR_IntervalToSeconds endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 221. PR_IntervalToMilliseconds

; =============== S U B	R O U T	I N E =======================================


		public PR_IntervalToMilliseconds
PR_IntervalToMilliseconds proc near	; CODE XREF: sub_1001D3C0+F3p
					; sub_1001DB80+4Bp ...

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		xor	ebp, ebp
		push	esi
		push	edi
		cmp	dword_10031520,	ebp
		jnz	short loc_1000D8A7
		call	PR_Init

loc_1000D8A7:				; CODE XREF: PR_IntervalToMilliseconds+10j
		call	sub_1001D270
		xor	edi, edi
		push	edi
		push	3E8h
		push	ebp
		push	ebx
		mov	esi, eax
		call	sub_10026AB0
		mov	ecx, esi
		mov	ebx, edi
		shrd	ecx, ebx, 1
		push	edi
		shr	ebx, 1
		add	eax, ecx
		push	esi
		adc	edx, ebx
		push	edx
		push	eax
		call	sub_10026AF0
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
PR_IntervalToMilliseconds endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 220. PR_IntervalToMicroseconds

; =============== S U B	R O U T	I N E =======================================


		public PR_IntervalToMicroseconds
PR_IntervalToMicroseconds proc near	; CODE XREF: sub_100229A0+1D0p
					; sub_10022C00+97p ...

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		xor	ebp, ebp
		push	esi
		push	edi
		cmp	dword_10031520,	ebp
		jnz	short loc_1000D8F7
		call	PR_Init

loc_1000D8F7:				; CODE XREF: PR_IntervalToMicroseconds+10j
		call	sub_1001D270
		xor	edi, edi
		push	edi
		push	0F4240h
		push	ebp
		push	ebx
		mov	esi, eax
		call	sub_10026AB0
		mov	ecx, esi
		mov	ebx, edi
		shrd	ecx, ebx, 1
		push	edi
		shr	ebx, 1
		add	eax, ecx
		push	esi
		adc	edx, ebx
		push	edx
		push	eax
		call	sub_10026AF0
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
PR_IntervalToMicroseconds endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000D930	proc near		; CODE XREF: PR_OpenSemaphore+4Fp
					; PR_DeleteSemaphore+37p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		mov	ecx, eax
		push	esi
		lea	esi, [ecx+1]
		lea	ebx, [ebx+0]

loc_1000D940:				; CODE XREF: sub_1000D930+15j
		mov	dl, [ecx]
		inc	ecx
		test	dl, dl
		jnz	short loc_1000D940
		sub	ecx, esi
		pop	esi
		cmp	ecx, [esp+arg_8]
		jb	short loc_1000D963
		push	0
		push	0FFFFE8B6h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000D963:				; CODE XREF: sub_1000D930+1Ej
		mov	edx, [esp+arg_4]
		sub	edx, eax
		lea	esp, [esp+0]

loc_1000D970:				; CODE XREF: sub_1000D930+48j
		mov	cl, [eax]
		mov	[edx+eax], cl
		inc	eax
		test	cl, cl
		jnz	short loc_1000D970
		mov	eax, [esp+arg_C]
		sub	eax, 0
		jz	short loc_1000D999
		dec	eax
		jz	short loc_1000D999
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000D999:				; CODE XREF: sub_1000D930+51j
					; sub_1000D930+54j
		xor	eax, eax
		retn
sub_1000D930	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  46. PR_CeilingLog2

; =============== S U B	R O U T	I N E =======================================


		public PR_CeilingLog2
PR_CeilingLog2	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		lea	edx, [ecx-1]
		xor	eax, eax
		test	ecx, edx
		jz	short loc_1000D9B2
		mov	eax, 1

loc_1000D9B2:				; CODE XREF: PR_CeilingLog2+Bj
		mov	edx, ecx
		shr	edx, 10h
		test	edx, edx
		jz	short loc_1000D9C0
		add	eax, 10h
		mov	ecx, edx

loc_1000D9C0:				; CODE XREF: PR_CeilingLog2+19j
		mov	edx, ecx
		shr	edx, 8
		test	edx, edx
		jz	short loc_1000D9CE
		add	eax, 8
		mov	ecx, edx

loc_1000D9CE:				; CODE XREF: PR_CeilingLog2+27j
		mov	edx, ecx
		shr	edx, 4
		test	edx, edx
		jz	short loc_1000D9DC
		add	eax, 4
		mov	ecx, edx

loc_1000D9DC:				; CODE XREF: PR_CeilingLog2+35j
		mov	edx, ecx
		shr	edx, 2
		test	edx, edx
		jz	short loc_1000D9EA
		add	eax, 2
		mov	ecx, edx

loc_1000D9EA:				; CODE XREF: PR_CeilingLog2+43j
		test	ecx, 0FFFFFFFEh
		jz	short locret_1000D9F3
		inc	eax

locret_1000D9F3:			; CODE XREF: PR_CeilingLog2+50j
		retn
PR_CeilingLog2	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 131. PR_FloorLog2

; =============== S U B	R O U T	I N E =======================================


		public PR_FloorLog2
PR_FloorLog2	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	edx, ecx
		shr	edx, 10h
		xor	eax, eax
		test	edx, edx
		jz	short loc_1000DA16
		mov	eax, 10h
		mov	ecx, edx

loc_1000DA16:				; CODE XREF: PR_FloorLog2+Dj
		mov	edx, ecx
		shr	edx, 8
		test	edx, edx
		jz	short loc_1000DA24
		add	eax, 8
		mov	ecx, edx

loc_1000DA24:				; CODE XREF: PR_FloorLog2+1Dj
		mov	edx, ecx
		shr	edx, 4
		test	edx, edx
		jz	short loc_1000DA32
		add	eax, 4
		mov	ecx, edx

loc_1000DA32:				; CODE XREF: PR_FloorLog2+2Bj
		mov	edx, ecx
		shr	edx, 2
		test	edx, edx
		jz	short loc_1000DA40
		add	eax, 2
		mov	ecx, edx

loc_1000DA40:				; CODE XREF: PR_FloorLog2+39j
		test	ecx, 0FFFFFFFEh
		jz	short locret_1000DA49
		inc	eax

locret_1000DA49:			; CODE XREF: PR_FloorLog2+46j
		retn
PR_FloorLog2	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   5. LL_Zero

; =============== S U B	R O U T	I N E =======================================


		public LL_Zero
LL_Zero		proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, dword_10031528
		mov	edx, dword_1003152C
		retn
LL_Zero		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   2. LL_MaxInt

; =============== S U B	R O U T	I N E =======================================


		public LL_MaxInt
LL_MaxInt	proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, dword_100302C8
		mov	edx, dword_100302CC
		retn
LL_MaxInt	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   4. LL_MinInt

; =============== S U B	R O U T	I N E =======================================


		public LL_MinInt
LL_MinInt	proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, dword_100302D0
		mov	edx, dword_100302D4
		retn
LL_MinInt	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   3. LL_MaxUint

; =============== S U B	R O U T	I N E =======================================


		public LL_MaxUint
LL_MaxUint	proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, dword_100302D8
		mov	edx, dword_100302DC
		retn
LL_MaxUint	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DA90	proc near		; CODE XREF: PR_Init_0+117p
		call	PR_NewLock
		mov	dword_10031530,	eax
		retn
sub_1000DA90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DAA0	proc near		; CODE XREF: PR_Cleanup+DCp
		mov	eax, dword_10031530
		test	eax, eax
		jz	short locret_1000DABC
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10031530,	0

locret_1000DABC:			; CODE XREF: sub_1000DAA0+7j
		retn
sub_1000DAA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DAC0	proc near		; CODE XREF: PR_GetHostByName+4Ap
					; PR_GetIPNodeByName+7Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		cmp	[esp+arg_C], 0
		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		jz	short loc_1000DAEA
		cmp	word ptr [esi+8], 2
		jnz	short loc_1000DAEA
		mov	eax, [esp+0Ch+arg_10]
		mov	dword ptr [eax+8], 100017h
		jmp	short loc_1000DB18
; ---------------------------------------------------------------------------

loc_1000DAEA:				; CODE XREF: sub_1000DAC0+14j
					; sub_1000DAC0+1Bj
		movzx	eax, word ptr [esi+8]
		mov	ecx, 17h
		cmp	cx, ax
		jnz	short loc_1000DB04
		mov	eax, [esp+0Ch+arg_10]
		mov	edx, ecx
		mov	[eax+8], dx
		jmp	short loc_1000DB0C
; ---------------------------------------------------------------------------

loc_1000DB04:				; CODE XREF: sub_1000DAC0+36j
		mov	ecx, [esp+0Ch+arg_10]
		mov	[ecx+8], ax

loc_1000DB0C:				; CODE XREF: sub_1000DAC0+42j
		mov	dx, [esi+0Ah]
		mov	eax, [esp+0Ch+arg_10]
		mov	[eax+0Ah], dx

loc_1000DB18:				; CODE XREF: sub_1000DAC0+28j
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_1000DB25
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DB25:				; CODE XREF: sub_1000DAC0+5Cj
		lea	edx, [eax+1]

loc_1000DB28:				; CODE XREF: sub_1000DAC0+6Dj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000DB28
		sub	eax, edx
		mov	edx, [ebp+0]
		lea	ecx, [eax+1]
		mov	eax, [ebx]
		push	edi
		cmp	eax, ecx
		jge	short loc_1000DB42
		xor	eax, eax
		jmp	short loc_1000DB4E
; ---------------------------------------------------------------------------

loc_1000DB42:				; CODE XREF: sub_1000DAC0+7Cj
		lea	edi, [edx+ecx]
		sub	eax, ecx
		mov	[ebp+0], edi
		mov	[ebx], eax
		mov	eax, edx

loc_1000DB4E:				; CODE XREF: sub_1000DAC0+80j
		mov	edx, [esp+10h+arg_10]
		mov	[edx], eax
		test	eax, eax
		jz	loc_1000DD7F
		push	ecx		; Size
		mov	ecx, [esi]
		push	ecx		; Src
		push	eax		; Dst
		call	memcpy
		mov	eax, [esi+4]
		add	esp, 0Ch
		mov	ecx, 1
		test	eax, eax
		jz	short loc_1000DB89
		cmp	dword ptr [eax], 0
		jz	short loc_1000DB89
		lea	ebx, [ebx+0]

loc_1000DB80:				; CODE XREF: sub_1000DAC0+C7j
		add	eax, 4
		inc	ecx
		cmp	dword ptr [eax], 0
		jnz	short loc_1000DB80

loc_1000DB89:				; CODE XREF: sub_1000DAC0+B3j
					; sub_1000DAC0+B8j
		mov	eax, [ebx]
		lea	edi, ds:0[ecx*4]
		mov	ecx, [ebp+0]
		mov	esi, ecx
		and	esi, 3
		jz	short loc_1000DBAF
		mov	edx, 4
		sub	edx, esi
		cmp	eax, edx
		jge	short loc_1000DBAB
		xor	ecx, ecx
		jmp	short loc_1000DBC1
; ---------------------------------------------------------------------------

loc_1000DBAB:				; CODE XREF: sub_1000DAC0+E5j
		add	ecx, edx
		sub	eax, edx

loc_1000DBAF:				; CODE XREF: sub_1000DAC0+DAj
		cmp	eax, edi
		jge	short loc_1000DBB7
		xor	ecx, ecx
		jmp	short loc_1000DBC1
; ---------------------------------------------------------------------------

loc_1000DBB7:				; CODE XREF: sub_1000DAC0+F1j
		lea	edx, [edi+ecx]
		sub	eax, edi
		mov	[ebp+0], edx
		mov	[ebx], eax

loc_1000DBC1:				; CODE XREF: sub_1000DAC0+E9j
					; sub_1000DAC0+F5j
		mov	eax, [esp+10h+arg_10]
		mov	[eax+4], ecx
		test	ecx, ecx
		jz	loc_1000DD7F
		mov	edx, [esp+10h+arg_0]
		mov	esi, [edx+4]
		test	esi, esi
		jnz	short loc_1000DBDF
		mov	[ecx], esi
		jmp	short loc_1000DC5D
; ---------------------------------------------------------------------------

loc_1000DBDF:				; CODE XREF: sub_1000DAC0+119j
		mov	eax, [esi]
		xor	edi, edi
		test	eax, eax
		jz	short loc_1000DC4F

loc_1000DBE7:				; CODE XREF: sub_1000DAC0+18Dj
		lea	edx, [eax+1]
		lea	ebx, [ebx+0]

loc_1000DBF0:				; CODE XREF: sub_1000DAC0+135j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000DBF0
		sub	eax, edx
		mov	edx, [ebp+0]
		lea	ecx, [eax+1]
		mov	eax, [ebx]
		cmp	eax, ecx
		jge	short loc_1000DC09
		xor	edx, edx
		jmp	short loc_1000DC17
; ---------------------------------------------------------------------------

loc_1000DC09:				; CODE XREF: sub_1000DAC0+143j
		lea	ebx, [edx+ecx]
		mov	[ebp+0], ebx
		mov	ebx, [esp+10h+arg_8]
		sub	eax, ecx
		mov	[ebx], eax

loc_1000DC17:				; CODE XREF: sub_1000DAC0+147j
		mov	eax, [esp+10h+arg_10]
		mov	eax, [eax+4]
		mov	[eax+edi*4], edx
		mov	edx, [esp+10h+arg_10]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+edi*4], 0
		lea	eax, [eax+edi*4]
		jz	loc_1000DD7F
		mov	edx, [eax]
		push	ecx		; Size
		mov	ecx, [esi]
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		mov	eax, [esi+4]
		add	esi, 4
		add	esp, 0Ch
		inc	edi
		test	eax, eax
		jnz	short loc_1000DBE7

loc_1000DC4F:				; CODE XREF: sub_1000DAC0+125j
		mov	eax, [esp+10h+arg_10]
		mov	ecx, [eax+4]
		mov	dword ptr [ecx+edi*4], 0

loc_1000DC5D:				; CODE XREF: sub_1000DAC0+11Dj
		mov	edx, [esp+10h+arg_0]
		mov	eax, [edx+0Ch]
		cmp	dword ptr [eax], 0
		mov	ecx, 1
		jz	short loc_1000DC79
		mov	edi, edi

loc_1000DC70:				; CODE XREF: sub_1000DAC0+1B7j
		add	eax, 4
		inc	ecx
		cmp	dword ptr [eax], 0
		jnz	short loc_1000DC70

loc_1000DC79:				; CODE XREF: sub_1000DAC0+1ACj
		mov	eax, [ebx]
		lea	edi, ds:0[ecx*4]
		mov	ecx, [ebp+0]
		mov	esi, ecx
		and	esi, 3
		jz	short loc_1000DC9F
		mov	edx, 4
		sub	edx, esi
		cmp	eax, edx
		jge	short loc_1000DC9B
		xor	ecx, ecx
		jmp	short loc_1000DCB1
; ---------------------------------------------------------------------------

loc_1000DC9B:				; CODE XREF: sub_1000DAC0+1D5j
		add	ecx, edx
		sub	eax, edx

loc_1000DC9F:				; CODE XREF: sub_1000DAC0+1CAj
		cmp	eax, edi
		jge	short loc_1000DCA7
		xor	ecx, ecx
		jmp	short loc_1000DCB1
; ---------------------------------------------------------------------------

loc_1000DCA7:				; CODE XREF: sub_1000DAC0+1E1j
		lea	edx, [edi+ecx]
		sub	eax, edi
		mov	[ebp+0], edx
		mov	[ebx], eax

loc_1000DCB1:				; CODE XREF: sub_1000DAC0+1D9j
					; sub_1000DAC0+1E5j
		mov	eax, [esp+10h+arg_10]
		mov	[eax+0Ch], ecx
		test	ecx, ecx
		jz	loc_1000DD7F
		mov	ecx, [esp+10h+arg_0]
		mov	esi, [ecx+0Ch]
		xor	edi, edi
		cmp	[esi], edi
		jz	loc_1000DD6A

loc_1000DCD1:				; CODE XREF: sub_1000DAC0+2A4j
		mov	edx, [esp+10h+arg_10]
		movsx	ecx, word ptr [edx+0Ah]
		mov	eax, [ebx]
		mov	edx, [ebp+0]
		cmp	eax, ecx
		jge	short loc_1000DCE6
		xor	edx, edx
		jmp	short loc_1000DCF4
; ---------------------------------------------------------------------------

loc_1000DCE6:				; CODE XREF: sub_1000DAC0+220j
		lea	ebx, [edx+ecx]
		mov	[ebp+0], ebx
		mov	ebx, [esp+10h+arg_8]
		sub	eax, ecx
		mov	[ebx], eax

loc_1000DCF4:				; CODE XREF: sub_1000DAC0+224j
		mov	ecx, [esp+10h+arg_10]
		mov	eax, [ecx+0Ch]
		mov	[eax+edi*4], edx
		mov	edx, [ecx+0Ch]
		cmp	dword ptr [edx+edi*4], 0
		lea	eax, [edx+edi*4]
		jz	short loc_1000DD7F
		cmp	[esp+10h+arg_C], 0
		jz	short loc_1000DD4A
		mov	edx, [esp+10h+arg_0]
		cmp	word ptr [edx+8], 2
		jnz	short loc_1000DD4A
		mov	eax, [eax]
		mov	edx, [esi]
		xor	ecx, ecx
		cmp	[esp+10h+arg_C], 1
		mov	[eax], ecx
		mov	[eax+4], ecx
		jnz	short loc_1000DD40
		mov	[eax+8], cx
		or	ecx, 0FFFFFFFFh
		mov	[eax+0Ah], cx
		mov	edx, [edx]
		mov	[eax+0Ch], edx
		jmp	short loc_1000DD5D
; ---------------------------------------------------------------------------

loc_1000DD40:				; CODE XREF: sub_1000DAC0+26Cj
		mov	[eax+8], ecx
		mov	ecx, [edx]
		mov	[eax+0Ch], ecx
		jmp	short loc_1000DD5D
; ---------------------------------------------------------------------------

loc_1000DD4A:				; CODE XREF: sub_1000DAC0+24Fj
					; sub_1000DAC0+25Aj
		movsx	edx, word ptr [ecx+0Ah]
		mov	ecx, [esi]
		push	edx		; Size
		mov	edx, [eax]
		push	ecx		; Src
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1000DD5D:				; CODE XREF: sub_1000DAC0+27Ej
					; sub_1000DAC0+288j
		add	esi, 4
		inc	edi
		cmp	dword ptr [esi], 0
		jnz	loc_1000DCD1

loc_1000DD6A:				; CODE XREF: sub_1000DAC0+20Bj
		mov	eax, [esp+10h+arg_10]
		mov	ecx, [eax+0Ch]
		mov	dword ptr [ecx+edi*4], 0
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DD7F:				; CODE XREF: sub_1000DAC0+96j
					; sub_1000DAC0+10Aj ...
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_1000DAC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000DD90	proc near		; CODE XREF: PR_GetProtoByName+67p
					; PR_GetProtoByNumber+67p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	ebx, eax
		mov	ax, [esi+8]
		push	edi
		mov	edi, [esp+10h+arg_8]
		mov	[edi+8], ax
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_1000DDB8

loc_1000DDB0:				; CODE XREF: sub_1000DD90+4Cj
					; sub_1000DD90+B1j ...
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000DDB8:				; CODE XREF: sub_1000DD90+1Ej
		lea	edx, [eax+1]
		jmp	short loc_1000DDC0
; ---------------------------------------------------------------------------
		align 10h

loc_1000DDC0:				; CODE XREF: sub_1000DD90+2Bj
					; sub_1000DD90+35j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000DDC0
		sub	eax, edx
		inc	eax
		mov	ecx, ebx
		cmp	ebp, eax
		jge	short loc_1000DDD4
		xor	ecx, ecx
		jmp	short loc_1000DDD8
; ---------------------------------------------------------------------------

loc_1000DDD4:				; CODE XREF: sub_1000DD90+3Ej
		add	ebx, eax
		sub	ebp, eax

loc_1000DDD8:				; CODE XREF: sub_1000DD90+42j
		mov	[edi], ecx
		test	ecx, ecx
		jz	short loc_1000DDB0
		mov	edx, [esi]
		push	eax		; Size
		push	edx		; Src
		push	ecx		; Dst
		call	memcpy
		mov	eax, [esi+4]
		add	esp, 0Ch
		cmp	dword ptr [eax], 0
		mov	ecx, 1
		jz	short loc_1000DE01

loc_1000DDF8:				; CODE XREF: sub_1000DD90+6Fj
		add	eax, 4
		inc	ecx
		cmp	dword ptr [eax], 0
		jnz	short loc_1000DDF8

loc_1000DE01:				; CODE XREF: sub_1000DD90+66j
		mov	esi, ebx
		and	esi, 3
		lea	edi, ds:0[ecx*4]
		mov	edx, ebx
		mov	eax, ebp
		jz	short loc_1000DE29
		mov	ecx, 4
		sub	ecx, esi
		cmp	ebp, ecx
		jge	short loc_1000DE22
		xor	edx, edx
		jmp	short loc_1000DE38
; ---------------------------------------------------------------------------

loc_1000DE22:				; CODE XREF: sub_1000DD90+8Cj
		mov	eax, ebp
		lea	edx, [ecx+ebx]
		sub	eax, ecx

loc_1000DE29:				; CODE XREF: sub_1000DD90+81j
		cmp	eax, edi
		jge	short loc_1000DE31
		xor	edx, edx
		jmp	short loc_1000DE38
; ---------------------------------------------------------------------------

loc_1000DE31:				; CODE XREF: sub_1000DD90+9Bj
		sub	eax, edi
		lea	ebx, [edi+edx]
		mov	ebp, eax

loc_1000DE38:				; CODE XREF: sub_1000DD90+90j
					; sub_1000DD90+9Fj
		mov	eax, [esp+10h+arg_8]
		mov	[eax+4], edx
		test	edx, edx
		jz	loc_1000DDB0
		mov	ecx, [esp+10h+arg_0]
		mov	esi, [ecx+4]
		mov	eax, [esi]
		xor	edi, edi
		test	eax, eax
		jz	short loc_1000DEB0

loc_1000DE56:				; CODE XREF: sub_1000DD90+11Ej
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_1000DE60:				; CODE XREF: sub_1000DD90+D5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1000DE60
		sub	eax, edx
		inc	eax
		mov	ecx, ebx
		cmp	ebp, eax
		jge	short loc_1000DE74
		xor	ecx, ecx
		jmp	short loc_1000DE78
; ---------------------------------------------------------------------------

loc_1000DE74:				; CODE XREF: sub_1000DD90+DEj
		add	ebx, eax
		sub	ebp, eax

loc_1000DE78:				; CODE XREF: sub_1000DD90+E2j
		mov	edx, [esp+10h+arg_8]
		mov	edx, [edx+4]
		mov	[edx+edi*4], ecx
		mov	ecx, [esp+10h+arg_8]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+edi*4], 0
		lea	ecx, [edx+edi*4]
		jz	loc_1000DDB0
		mov	ecx, [ecx]
		push	eax		; Size
		mov	eax, [esi]
		push	eax		; Src
		push	ecx		; Dst
		call	memcpy
		mov	eax, [esi+4]
		add	esi, 4
		add	esp, 0Ch
		inc	edi
		test	eax, eax
		jnz	short loc_1000DE56

loc_1000DEB0:				; CODE XREF: sub_1000DD90+C4j
		mov	edx, [esp+10h+arg_8]
		mov	eax, [edx+4]
		mov	dword ptr [eax+edi*4], 0
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_1000DD90	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 159. PR_GetHostByName

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetHostByName(char *name, char, char, int)
		public PR_GetHostByName
PR_GetHostByName proc near		; CODE XREF: sub_1000EE20+3Cp
					; DATA XREF: .rdata:off_1002C7C8o

name		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= byte ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		or	esi, 0FFFFFFFFh
		cmp	dword_10031520,	0
		jnz	short loc_1000DEE2
		call	PR_Init

loc_1000DEE2:				; CODE XREF: PR_GetHostByName+Bj
		mov	eax, [esp+4+name]
		push	eax		; name
		call	gethostbyname
		test	eax, eax
		jnz	short loc_1000DF08
		call	ds:GetLastError
		push	eax
		push	0FFFFE8ABh
		call	PR_SetError
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000DF08:				; CODE XREF: PR_GetHostByName+1Ej
		mov	ecx, [esp+4+arg_C]
		push	ecx
		push	0
		lea	edx, [esp+0Ch+arg_8]
		push	edx
		lea	ecx, [esp+10h+arg_4]
		push	ecx
		push	eax
		call	sub_1000DAC0
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	short loc_1000DF39
		push	0
		push	0FFFFE8AAh
		call	PR_SetError
		mov	eax, esi
		add	esp, 8

loc_1000DF39:				; CODE XREF: PR_GetHostByName+56j
		pop	esi
		retn
PR_GetHostByName endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 160. PR_GetIPNodeByName

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetIPNodeByName(char *name, __int16, int, char, char, int)
		public PR_GetIPNodeByName
PR_GetIPNodeByName proc	near		; DATA XREF: .rdata:off_1002C7C8o

name		= dword	ptr  4
arg_4		= word ptr  8
arg_C		= byte ptr  10h
arg_10		= byte ptr  14h
arg_14		= dword	ptr  18h

		push	esi
		or	esi, 0FFFFFFFFh
		cmp	dword_10031520,	0
		push	edi
		jnz	short loc_1000DF53
		call	PR_Init

loc_1000DF53:				; CODE XREF: PR_GetIPNodeByName+Cj
		mov	di, [esp+8+arg_4]
		cmp	di, 2
		jz	short loc_1000DF79
		cmp	di, 17h
		jz	short loc_1000DF79
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000DF79:				; CODE XREF: PR_GetIPNodeByName+1Cj
					; PR_GetIPNodeByName+22j
		mov	eax, [esp+8+name]
		push	eax		; name
		call	gethostbyname
		test	eax, eax
		jnz	short loc_1000DFA0
		call	ds:GetLastError
		push	eax
		push	0FFFFE8ABh
		call	PR_SetError
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000DFA0:				; CODE XREF: PR_GetIPNodeByName+45j
		xor	ecx, ecx
		cmp	di, 17h
		jnz	short loc_1000DFAD
		mov	ecx, 1

loc_1000DFAD:				; CODE XREF: PR_GetIPNodeByName+66j
		mov	edx, [esp+8+arg_14]
		push	edx
		push	ecx
		lea	ecx, [esp+10h+arg_10]
		push	ecx
		lea	edx, [esp+14h+arg_C]
		push	edx
		push	eax
		call	sub_1000DAC0
		mov	esi, eax
		add	esp, 14h
		test	esi, esi
		jz	short loc_1000DFDB
		push	0
		push	0FFFFE8AAh
		call	PR_SetError
		add	esp, 8

loc_1000DFDB:				; CODE XREF: PR_GetIPNodeByName+8Aj
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_GetIPNodeByName endp

; Exported entry 158. PR_GetHostByAddr

; =============== S U B	R O U T	I N E =======================================


		public PR_GetHostByAddr
PR_GetHostByAddr proc near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= byte ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		push	ebp
		push	esi
		or	ebp, 0FFFFFFFFh
		cmp	dword_10031520,	0
		push	edi
		jnz	short loc_1000DFF6
		call	PR_Init

loc_1000DFF6:				; CODE XREF: PR_GetHostByAddr+Fj
		mov	esi, [esp+14h+arg_0]
		cmp	word ptr [esi],	17h
		jnz	short loc_1000E013
		call	sub_100037C0
		mov	edi, eax
		neg	edi
		sbb	edi, edi
		and	edi, 15h
		add	edi, 2
		jmp	short loc_1000E018
; ---------------------------------------------------------------------------

loc_1000E013:				; CODE XREF: PR_GetHostByAddr+1Ej
		mov	edi, 2

loc_1000E018:				; CODE XREF: PR_GetHostByAddr+31j
		cmp	word ptr [esi],	17h
		mov	bl, 0FFh
		jnz	short loc_1000E074
		cmp	edi, 17h
		jnz	short loc_1000E02D
		lea	eax, [esi+8]
		lea	ecx, [edi-7]
		jmp	short loc_1000E07C
; ---------------------------------------------------------------------------

loc_1000E02D:				; CODE XREF: PR_GetHostByAddr+43j
		cmp	dword ptr [esi+8], 0
		jnz	short loc_1000E05C
		cmp	dword ptr [esi+0Ch], 0
		jnz	short loc_1000E05C
		cmp	byte ptr [esi+10h], 0
		jnz	short loc_1000E05C
		cmp	byte ptr [esi+11h], 0
		jnz	short loc_1000E05C
		cmp	[esi+12h], bl
		jnz	short loc_1000E05C
		cmp	[esi+13h], bl
		jnz	short loc_1000E05C
		mov	eax, [esi+14h]
		mov	[esp+14h+var_4], eax
		lea	eax, [esp+14h+var_4]
		jmp	short loc_1000E077
; ---------------------------------------------------------------------------

loc_1000E05C:				; CODE XREF: PR_GetHostByAddr+51j
					; PR_GetHostByAddr+57j	...
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000E074:				; CODE XREF: PR_GetHostByAddr+3Ej
		lea	eax, [esi+4]

loc_1000E077:				; CODE XREF: PR_GetHostByAddr+7Aj
		mov	ecx, 4

loc_1000E07C:				; CODE XREF: PR_GetHostByAddr+4Bj
		push	edi		; type
		push	ecx		; len
		push	eax		; addr
		call	gethostbyaddr
		test	eax, eax
		jnz	short loc_1000E0A4
		call	ds:GetLastError
		push	eax
		push	0FFFFE8ABh
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000E0A4:				; CODE XREF: PR_GetHostByAddr+A6j
		xor	edx, edx
		cmp	word ptr [esi],	17h
		jnz	short loc_1000E0E9
		cmp	edi, 2
		jnz	short loc_1000E0E9
		mov	ecx, [esi+8]
		test	ecx, ecx
		jnz	short loc_1000E0E9
		cmp	[esi+0Ch], edx
		jnz	short loc_1000E0D6
		cmp	[esi+10h], dl
		jnz	short loc_1000E0D6
		cmp	[esi+11h], dl
		jnz	short loc_1000E0D6
		cmp	[esi+12h], bl
		jnz	short loc_1000E0D6
		cmp	[esi+13h], bl
		jnz	short loc_1000E0D6
		lea	edx, [edi-1]
		jmp	short loc_1000E0E9
; ---------------------------------------------------------------------------

loc_1000E0D6:				; CODE XREF: PR_GetHostByAddr+DBj
					; PR_GetHostByAddr+E0j	...
		test	ecx, ecx
		jnz	short loc_1000E0E9
		cmp	[esi+0Ch], edx
		jnz	short loc_1000E0E9
		cmp	[esi+10h], edx
		jnz	short loc_1000E0E9
		mov	edx, 2

loc_1000E0E9:				; CODE XREF: PR_GetHostByAddr+CAj
					; PR_GetHostByAddr+CFj	...
		mov	ecx, [esp+14h+arg_C]
		push	ecx
		push	edx
		lea	edx, [esp+1Ch+arg_8]
		push	edx
		lea	ecx, [esp+20h+arg_4]
		push	ecx
		push	eax
		call	sub_1000DAC0
		mov	ebp, eax
		add	esp, 14h
		test	ebp, ebp
		jz	short loc_1000E117
		push	0
		push	0FFFFE8AAh
		call	PR_SetError
		add	esp, 8

loc_1000E117:				; CODE XREF: PR_GetHostByAddr+126j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
PR_GetHostByAddr endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 181. PR_GetProtoByName

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetProtoByName(char *name, int, int, int)
		public PR_GetProtoByName
PR_GetProtoByName proc near		; DATA XREF: .rdata:off_1002C7C8o

name		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	dword_10031520,	0
		jnz	short loc_1000E12E
		call	PR_Init

loc_1000E12E:				; CODE XREF: PR_GetProtoByName+7j
		push	esi
		mov	esi, [esp+4+arg_8]
		cmp	esi, 400h
		jge	short loc_1000E14F
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000E14F:				; CODE XREF: PR_GetProtoByName+19j
		mov	eax, dword_10031530
		push	eax
		call	PR_Lock
		mov	ecx, [esp+8+name]
		add	esp, 4
		push	ecx		; name
		call	getprotobyname
		test	eax, eax
		jnz	short loc_1000E17C
		or	esi, 0FFFFFFFFh
		call	ds:GetLastError
		push	eax
		push	0FFFFE8ABh
		jmp	short loc_1000E19D
; ---------------------------------------------------------------------------

loc_1000E17C:				; CODE XREF: PR_GetProtoByName+49j
		mov	edx, [esp+4+arg_C]
		push	edx
		push	esi
		push	eax
		mov	eax, [esp+10h+arg_4]
		call	sub_1000DD90
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_1000E1A5
		push	0
		push	0FFFFE8AAh

loc_1000E19D:				; CODE XREF: PR_GetProtoByName+5Aj
		call	PR_SetError
		add	esp, 8

loc_1000E1A5:				; CODE XREF: PR_GetProtoByName+74j
		mov	eax, dword_10031530
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
PR_GetProtoByName endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 182. PR_GetProtoByNumber

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetProtoByNumber(int number, int, int,	int)
		public PR_GetProtoByNumber
PR_GetProtoByNumber proc near		; DATA XREF: .rdata:off_1002C7C8o

number		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	dword_10031520,	0
		jnz	short loc_1000E1CE
		call	PR_Init

loc_1000E1CE:				; CODE XREF: PR_GetProtoByNumber+7j
		push	esi
		mov	esi, [esp+4+arg_8]
		cmp	esi, 400h
		jge	short loc_1000E1EF
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000E1EF:				; CODE XREF: PR_GetProtoByNumber+19j
		mov	eax, dword_10031530
		push	eax
		call	PR_Lock
		mov	ecx, [esp+8+number]
		add	esp, 4
		push	ecx		; number
		call	getprotobynumber
		test	eax, eax
		jnz	short loc_1000E21C
		or	esi, 0FFFFFFFFh
		call	ds:GetLastError
		push	eax
		push	0FFFFE8ABh
		jmp	short loc_1000E23D
; ---------------------------------------------------------------------------

loc_1000E21C:				; CODE XREF: PR_GetProtoByNumber+49j
		mov	edx, [esp+4+arg_C]
		push	edx
		push	esi
		push	eax
		mov	eax, [esp+10h+arg_4]
		call	sub_1000DD90
		mov	esi, eax
		add	esp, 0Ch
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_1000E245
		push	0
		push	0FFFFE8AAh

loc_1000E23D:				; CODE XREF: PR_GetProtoByNumber+5Aj
		call	PR_SetError
		add	esp, 8

loc_1000E245:				; CODE XREF: PR_GetProtoByNumber+74j
		mov	eax, dword_10031530
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
PR_GetProtoByNumber endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 104. PR_EnumerateHostEnt

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_EnumerateHostEnt(int, int, u_short hostshort, int)
		public PR_EnumerateHostEnt
PR_EnumerateHostEnt proc near		; CODE XREF: PR_EnumerateAddrInfo+23p
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
hostshort	= word ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		mov	eax, [ebp+0Ch]
		push	esi
		mov	esi, [esp+0Ch+arg_C]
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	ebx, [eax+edi*4]
		xor	eax, eax
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	[esi+0Ch], eax
		mov	[esi+10h], eax
		mov	[esi+14h], eax
		mov	[esi+18h], eax
		mov	[esi+1Ch], eax
		test	ebx, ebx
		jnz	short loc_1000E298
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000E298:				; CODE XREF: PR_EnumerateHostEnt+31j
		mov	cx, [ebp+8]
		mov	edx, 17h
		mov	[esi], cx
		cmp	dx, [ebp+8]
		jnz	short loc_1000E2DA
		mov	eax, dword ptr [esp+10h+hostshort]
		push	eax		; hostshort
		call	htons
		mov	[esi+2], ax
		xor	eax, eax
		mov	[esi+4], eax
		mov	[esi+18h], eax
		movsx	ecx, word ptr [ebp+0Ah]
		push	ecx		; Size
		add	esi, 8
		push	ebx		; Src
		push	esi		; Dst
		call	memcpy
		add	esp, 0Ch
		lea	eax, [edi+1]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000E2DA:				; CODE XREF: PR_EnumerateHostEnt+48j
		mov	edx, dword ptr [esp+10h+hostshort]
		push	edx		; hostshort
		call	htons
		mov	[esi+2], ax
		movsx	eax, word ptr [ebp+0Ah]
		push	eax		; Size
		add	esi, 4
		push	ebx		; Src
		push	esi		; Dst
		call	memcpy
		add	esp, 0Ch
		lea	eax, [edi+1]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
PR_EnumerateHostEnt endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 216. PR_InitializeNetAddr

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_InitializeNetAddr(int,	u_short	hostshort, int)
		public PR_InitializeNetAddr
PR_InitializeNetAddr proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
hostshort	= word ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		xor	ebx, ebx
		push	esi
		cmp	dword_10031520,	ebx
		jnz	short loc_1000E321
		call	PR_Init

loc_1000E321:				; CODE XREF: PR_InitializeNetAddr+Aj
		mov	esi, [esp+8+arg_8]
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		test	edi, edi
		jz	short loc_1000E33B
		xor	eax, eax
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	[esi+0Ch], eax

loc_1000E33B:				; CODE XREF: PR_InitializeNetAddr+1Cj
		mov	ecx, dword ptr [esp+0Ch+hostshort]
		mov	eax, 2
		push	ecx		; hostshort
		mov	[esi], ax
		call	htons
		mov	[esi+2], ax
		mov	eax, edi
		sub	eax, 0
		pop	edi
		jz	short loc_1000E390
		dec	eax
		jz	short loc_1000E386
		dec	eax
		jz	short loc_1000E374
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000E374:				; CODE XREF: PR_InitializeNetAddr+4Dj
		push	7F000001h	; hostlong
		call	htonl
		mov	[esi+4], eax
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000E386:				; CODE XREF: PR_InitializeNetAddr+4Aj
		push	0		; hostlong
		call	htonl
		mov	[esi+4], eax

loc_1000E390:				; CODE XREF: PR_InitializeNetAddr+47j
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
PR_InitializeNetAddr endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 331. PR_SetNetAddr

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SetNetAddr(int, __int16, u_short hostshort, int)
		public PR_SetNetAddr
PR_SetNetAddr	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= word ptr  8
hostshort	= word ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		xor	ebx, ebx
		push	esi
		push	edi
		cmp	dword_10031520,	ebx
		jnz	short loc_1000E3B2
		call	PR_Init

loc_1000E3B2:				; CODE XREF: PR_SetNetAddr+Bj
		mov	cx, [esp+0Ch+arg_4]
		mov	edi, [esp+0Ch+arg_0]
		mov	esi, [esp+0Ch+arg_C]
		cmp	cx, 17h
		jnz	loc_1000E463
		cmp	edi, ebx
		jz	short loc_1000E3E6
		xor	eax, eax
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	[esi+0Ch], eax
		mov	[esi+10h], eax
		mov	[esi+14h], eax
		mov	[esi+18h], eax
		mov	[esi+1Ch], eax

loc_1000E3E6:				; CODE XREF: PR_SetNetAddr+2Bj
		mov	ecx, dword ptr [esp+0Ch+hostshort]
		mov	eax, 17h
		push	ecx		; hostshort
		mov	[esi], ax
		call	htons
		mov	[esi+2], ax
		mov	eax, edi
		sub	eax, ebx
		mov	[esi+4], ebx
		mov	[esi+18h], ebx
		jz	loc_1000E4C2
		dec	eax
		jz	short loc_1000E43B
		dec	eax
		jnz	short loc_1000E491
		mov	edx, ds:dword_1002A368
		mov	[esi+8], edx
		mov	eax, ds:dword_1002A36C
		mov	[esi+0Ch], eax
		mov	ecx, ds:dword_1002A370
		mov	[esi+10h], ecx
		mov	edx, ds:dword_1002A374
		pop	edi
		mov	[esi+14h], edx
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000E43B:				; CODE XREF: PR_SetNetAddr+6Dj
		mov	eax, ds:dword_1002A358
		mov	[esi+8], eax
		mov	ecx, ds:dword_1002A35C
		mov	[esi+0Ch], ecx
		mov	edx, ds:dword_1002A360
		mov	[esi+10h], edx
		mov	eax, ds:dword_1002A364
		pop	edi
		mov	[esi+14h], eax
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000E463:				; CODE XREF: PR_SetNetAddr+23j
		cmp	edi, ebx
		jz	short loc_1000E474
		xor	eax, eax
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	[esi+0Ch], eax

loc_1000E474:				; CODE XREF: PR_SetNetAddr+C5j
		mov	[esi], cx
		mov	ecx, dword ptr [esp+0Ch+hostshort]
		push	ecx		; hostshort
		call	htons
		mov	[esi+2], ax
		mov	eax, edi
		sub	eax, ebx
		jz	short loc_1000E4C2
		dec	eax
		jz	short loc_1000E4B9
		dec	eax
		jz	short loc_1000E4A6

loc_1000E491:				; CODE XREF: PR_SetNetAddr+70j
		push	ebx
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000E4A6:				; CODE XREF: PR_SetNetAddr+EFj
		push	7F000001h	; hostlong
		call	htonl
		pop	edi
		mov	[esi+4], eax
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000E4B9:				; CODE XREF: PR_SetNetAddr+ECj
		push	ebx		; hostlong
		call	htonl
		mov	[esi+4], eax

loc_1000E4C2:				; CODE XREF: PR_SetNetAddr+66j
					; PR_SetNetAddr+E9j
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
PR_SetNetAddr	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 223. PR_IsNetAddrType

; =============== S U B	R O U T	I N E =======================================


		public PR_IsNetAddrType
PR_IsNetAddrType proc near		; CODE XREF: sub_10003100+3p
					; sub_10003100+29p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		movzx	eax, word ptr [esi]
		cmp	eax, 17h
		jnz	loc_1000E5D7
		mov	eax, [esp+4+arg_4]
		cmp	eax, 1
		jnz	short loc_1000E552
		mov	eax, [esi+8]
		test	eax, eax
		jnz	loc_1000E60B
		cmp	[esi+0Ch], eax
		jnz	short loc_1000E504
		cmp	[esi+10h], eax
		jnz	short loc_1000E504
		cmp	[esi+14h], eax
		jz	short loc_1000E54B

loc_1000E504:				; CODE XREF: PR_IsNetAddrType+28j
					; PR_IsNetAddrType+2Dj
		test	eax, eax
		jnz	loc_1000E60B
		cmp	[esi+0Ch], eax
		jnz	loc_1000E60B
		cmp	[esi+10h], al
		jnz	loc_1000E60B
		cmp	[esi+11h], al
		jnz	loc_1000E60B
		mov	al, 0FFh
		cmp	[esi+12h], al
		jnz	loc_1000E60B
		cmp	[esi+13h], al
		jnz	loc_1000E60B
		push	0		; hostlong

loc_1000E53D:				; CODE XREF: PR_IsNetAddrType+D9j
		call	htonl
		cmp	[esi+14h], eax

loc_1000E545:				; CODE XREF: PR_IsNetAddrType+102j
					; PR_IsNetAddrType+11Fj ...
		jnz	loc_1000E60B

loc_1000E54B:				; CODE XREF: PR_IsNetAddrType+32j
					; PR_IsNetAddrType+AFj
		mov	eax, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000E552:				; CODE XREF: PR_IsNetAddrType+18j
		cmp	eax, 2
		jnz	short loc_1000E5AB
		mov	eax, [esi+8]
		test	eax, eax
		jnz	loc_1000E60B
		cmp	[esi+0Ch], eax
		jnz	short loc_1000E581
		cmp	[esi+10h], eax
		jnz	short loc_1000E581
		cmp	[esi+14h], al
		jnz	short loc_1000E581
		cmp	[esi+15h], al
		jnz	short loc_1000E581
		cmp	[esi+16h], al
		jnz	short loc_1000E581
		cmp	byte ptr [esi+17h], 1
		jz	short loc_1000E54B

loc_1000E581:				; CODE XREF: PR_IsNetAddrType+95j
					; PR_IsNetAddrType+9Aj	...
		test	eax, eax
		jnz	loc_1000E60B
		cmp	[esi+0Ch], eax
		jnz	short loc_1000E60B
		cmp	[esi+10h], al
		jnz	short loc_1000E60B
		cmp	[esi+11h], al
		jnz	short loc_1000E60B
		mov	al, 0FFh
		cmp	[esi+12h], al
		jnz	short loc_1000E60B
		cmp	[esi+13h], al
		jnz	short loc_1000E60B
		push	7F000001h
		jmp	short loc_1000E53D
; ---------------------------------------------------------------------------

loc_1000E5AB:				; CODE XREF: PR_IsNetAddrType+85j
		cmp	eax, 3
		jnz	short loc_1000E60B
		cmp	dword ptr [esi+8], 0
		jnz	short loc_1000E60B
		cmp	dword ptr [esi+0Ch], 0
		jnz	short loc_1000E60B
		cmp	byte ptr [esi+10h], 0
		jnz	short loc_1000E60B
		cmp	byte ptr [esi+11h], 0
		jnz	short loc_1000E60B
		mov	al, 0FFh
		cmp	[esi+12h], al
		jnz	short loc_1000E60B
		cmp	[esi+13h], al
		jmp	loc_1000E545
; ---------------------------------------------------------------------------

loc_1000E5D7:				; CODE XREF: PR_IsNetAddrType+Bj
		cmp	eax, 2
		jnz	short loc_1000E60B
		mov	eax, [esp+4+arg_4]
		cmp	eax, 1
		jnz	short loc_1000E5F4
		push	0		; hostlong
		call	htonl
		cmp	[esi+4], eax
		jmp	loc_1000E545
; ---------------------------------------------------------------------------

loc_1000E5F4:				; CODE XREF: PR_IsNetAddrType+113j
		cmp	eax, 2
		jnz	short loc_1000E60B
		push	7F000001h	; hostlong
		call	htonl
		cmp	[esi+4], eax
		jmp	loc_1000E545
; ---------------------------------------------------------------------------

loc_1000E60B:				; CODE XREF: PR_IsNetAddrType+1Fj
					; PR_IsNetAddrType+36j	...
		xor	eax, eax
		pop	esi
		retn
PR_IsNetAddrType endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E610	proc near		; CODE XREF: sub_1000F1C0+2Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	esi, eax
		or	ecx, 0FFFFFFFFh
		xor	edi, edi
		cmp	byte ptr [esi],	3Ah
		mov	[esp+10h+var_4], ecx
		jnz	short loc_1000E649
		cmp	byte ptr [esi+1], 3Ah
		jz	short loc_1000E635
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000E635:				; CODE XREF: sub_1000E610+1Cj
		add	esi, 2
		mov	edi, 1
		xor	eax, eax
		mov	[ebp+0], ax
		mov	[esp+10h+var_4], edi
		mov	ecx, edi

loc_1000E649:				; CODE XREF: sub_1000E610+16j
		mov	al, [esi]
		push	ebx
		mov	ebx, [esp+14h+var_4]
		test	al, al
		jz	loc_1000E6EE
		jmp	short loc_1000E660
; ---------------------------------------------------------------------------
		align 10h

loc_1000E660:				; CODE XREF: sub_1000E610+48j
					; sub_1000E610+CEj
		cmp	edi, 8
		jz	loc_1000E894
		cmp	al, 3Ah
		jnz	short loc_1000E685
		cmp	ecx, 0FFFFFFFFh
		jnz	loc_1000E894
		xor	ecx, ecx
		mov	[ebp+edi*2+0], cx
		inc	edi
		mov	[esp+14h+var_4], edi
		inc	esi
		jmp	short loc_1000E6D6
; ---------------------------------------------------------------------------

loc_1000E685:				; CODE XREF: sub_1000E610+5Bj
		xor	ebx, ebx
		xor	ecx, ecx
		lea	esp, [esp+0]

loc_1000E690:				; CODE XREF: sub_1000E610+9Aj
		movzx	edx, byte ptr [esi]
		mov	al, ds:byte_1002A378[edx]
		cmp	al, 7Fh
		jz	short loc_1000E6AC
		movzx	eax, al
		shl	ebx, 4
		inc	ecx
		add	ebx, eax
		inc	esi
		cmp	ecx, 4
		jl	short loc_1000E690

loc_1000E6AC:				; CODE XREF: sub_1000E610+8Bj
		mov	al, [esi]
		cmp	al, 2Eh
		jz	short loc_1000E6E2
		cmp	al, 3Ah
		jnz	short loc_1000E6C2
		inc	esi
		cmp	byte ptr [esi],	0
		jz	loc_1000E894
		jmp	short loc_1000E6CA
; ---------------------------------------------------------------------------

loc_1000E6C2:				; CODE XREF: sub_1000E610+A4j
		test	al, al
		jnz	loc_1000E894

loc_1000E6CA:				; CODE XREF: sub_1000E610+B0j
		push	ebx		; hostshort
		call	htons
		mov	[ebp+edi*2+0], ax
		inc	edi

loc_1000E6D6:				; CODE XREF: sub_1000E610+73j
		mov	al, [esi]
		mov	ecx, [esp+14h+var_4]
		test	al, al
		jnz	short loc_1000E660
		jmp	short loc_1000E6EE
; ---------------------------------------------------------------------------

loc_1000E6E2:				; CODE XREF: sub_1000E610+A0j
		test	ecx, ecx
		jz	loc_1000E894
		mov	ecx, [esp+14h+var_4]

loc_1000E6EE:				; CODE XREF: sub_1000E610+42j
					; sub_1000E610+D0j
		cmp	byte ptr [esi],	2Eh
		jnz	loc_1000E840
		cmp	edi, 6
		jg	loc_1000E894
		cmp	ebx, 255h
		ja	loc_1000E894
		mov	ecx, ebx
		and	ecx, 0F0h
		cmp	ecx, 90h
		ja	loc_1000E894
		mov	edx, ebx
		and	edx, 0Fh
		cmp	dl, 9
		ja	loc_1000E894
		mov	eax, ebx
		shr	eax, 8
		mov	dl, al
		add	dl, dl
		add	dl, dl
		add	al, dl
		mov	ecx, ebx
		shr	ecx, 4
		add	al, al
		and	cl, 0Fh
		add	al, cl
		mov	cl, al
		add	cl, cl
		add	cl, cl
		add	al, cl
		add	al, al
		and	bl, 0Fh
		add	al, bl
		mov	[ebp+edi*2+0], al
		movzx	edx, byte ptr [esi+1]
		movzx	eax, ds:byte_1002A378[edx]
		add	esi, 2
		cmp	eax, 9
		ja	loc_1000E894
		mov	cl, [esi]
		cmp	cl, 30h
		jb	short loc_1000E79A

loc_1000E778:				; CODE XREF: sub_1000E610+188j
		cmp	cl, 39h
		ja	short loc_1000E79A
		movzx	ecx, cl
		lea	eax, [eax+eax*4]
		lea	eax, [ecx+eax*2-30h]
		inc	esi
		cmp	eax, 0FFh
		ja	loc_1000E894
		mov	cl, [esi]
		cmp	cl, 30h
		jnb	short loc_1000E778

loc_1000E79A:				; CODE XREF: sub_1000E610+166j
					; sub_1000E610+16Bj
		cmp	byte ptr [esi],	2Eh
		jnz	loc_1000E894
		mov	[ebp+edi*2+1], al
		movzx	edx, byte ptr [esi+1]
		movzx	eax, ds:byte_1002A378[edx]
		add	esi, 2
		cmp	eax, 9
		ja	loc_1000E894
		mov	cl, [esi]
		cmp	cl, 30h
		jb	short loc_1000E7E7

loc_1000E7C5:				; CODE XREF: sub_1000E610+1D5j
		cmp	cl, 39h
		ja	short loc_1000E7E7
		movzx	ecx, cl
		lea	eax, [eax+eax*4]
		lea	eax, [ecx+eax*2-30h]
		inc	esi
		cmp	eax, 0FFh
		ja	loc_1000E894
		mov	cl, [esi]
		cmp	cl, 30h
		jnb	short loc_1000E7C5

loc_1000E7E7:				; CODE XREF: sub_1000E610+1B3j
					; sub_1000E610+1B8j
		cmp	byte ptr [esi],	2Eh
		jnz	loc_1000E894
		mov	[ebp+edi*2+2], al
		movzx	edx, byte ptr [esi+1]
		movzx	eax, ds:byte_1002A378[edx]
		add	esi, 2
		cmp	eax, 9
		ja	loc_1000E894
		mov	cl, [esi]
		cmp	cl, 30h
		jb	short loc_1000E830

loc_1000E812:				; CODE XREF: sub_1000E610+21Ej
		cmp	cl, 39h
		ja	short loc_1000E830
		movzx	ecx, cl
		lea	eax, [eax+eax*4]
		lea	eax, [ecx+eax*2-30h]
		inc	esi
		cmp	eax, 0FFh
		ja	short loc_1000E894
		mov	cl, [esi]
		cmp	cl, 30h
		jnb	short loc_1000E812

loc_1000E830:				; CODE XREF: sub_1000E610+200j
					; sub_1000E610+205j
		cmp	byte ptr [esi],	0
		jnz	short loc_1000E894
		mov	ecx, [esp+14h+var_4]
		mov	[ebp+edi*2+3], al
		add	edi, 2

loc_1000E840:				; CODE XREF: sub_1000E610+E1j
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_1000E88F
		sub	edi, ecx
		mov	edx, edi
		mov	eax, 7
		jz	short loc_1000E874
		add	ecx, edx
		lea	ecx, [ebp+ecx*2+0]
		jmp	short loc_1000E860
; ---------------------------------------------------------------------------
		align 10h

loc_1000E860:				; CODE XREF: sub_1000E610+246j
					; sub_1000E610+25Ej
		mov	si, [ecx-2]
		sub	ecx, 2
		mov	[ebp+eax*2+0], si
		dec	eax
		dec	edx
		jnz	short loc_1000E860
		mov	ecx, [esp+14h+var_4]

loc_1000E874:				; CODE XREF: sub_1000E610+23Ej
		cmp	eax, ecx
		jl	short loc_1000E884

loc_1000E878:				; CODE XREF: sub_1000E610+272j
		xor	edx, edx
		mov	[ebp+eax*2+0], dx
		dec	eax
		cmp	eax, ecx
		jge	short loc_1000E878

loc_1000E884:				; CODE XREF: sub_1000E610+266j
					; sub_1000E610+282j
		pop	ebx
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1000E88F:				; CODE XREF: sub_1000E610+233j
		cmp	edi, 8
		jz	short loc_1000E884

loc_1000E894:				; CODE XREF: sub_1000E610+53j
					; sub_1000E610+60j ...
		pop	ebx
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
sub_1000E610	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000E8A0	proc near		; CODE XREF: PR_NetAddrToString-6Dp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		push	ebx
		push	ebp
		push	esi
		or	ebx, 0FFFFFFFFh
		push	edi
		mov	esi, ecx
		mov	edi, eax
		lea	edx, [ebx+2]
		mov	[esp+18h+var_4], esi
		xor	eax, eax
		jmp	short loc_1000E8C0
; ---------------------------------------------------------------------------
		align 10h

loc_1000E8C0:				; CODE XREF: sub_1000E8A0+17j
					; sub_1000E8A0+54j
		mov	ebp, [esp+18h+arg_0]
		cmp	word ptr [ebp+eax*2+0],	0
		jnz	short loc_1000E8F0
		inc	eax
		mov	ecx, 1
		cmp	eax, 8
		jge	short loc_1000E8E6

loc_1000E8D7:				; CODE XREF: sub_1000E8A0+44j
		cmp	word ptr [ebp+eax*2+0],	0
		jnz	short loc_1000E8E6
		inc	eax
		inc	ecx
		cmp	eax, 8
		jl	short loc_1000E8D7

loc_1000E8E6:				; CODE XREF: sub_1000E8A0+35j
					; sub_1000E8A0+3Dj
		cmp	ecx, edx
		jle	short loc_1000E8F0
		mov	ebx, eax
		sub	ebx, ecx
		mov	edx, ecx

loc_1000E8F0:				; CODE XREF: sub_1000E8A0+2Aj
					; sub_1000E8A0+48j
		inc	eax
		cmp	eax, 8
		jl	short loc_1000E8C0
		xor	ebp, ebp
		mov	[esp+18h+var_8], edx
		test	ebx, ebx
		jnz	loc_1000EBD0
		cmp	edx, 6
		jz	short loc_1000E925
		cmp	edx, 5
		jnz	loc_1000EBD0
		mov	ecx, [esp+18h+arg_0]
		mov	eax, 0FFFFh
		cmp	[ecx+0Ah], ax
		jnz	loc_1000EBD0

loc_1000E925:				; CODE XREF: sub_1000E8A0+67j
		mov	eax, edi
		test	eax, eax
		jnz	short loc_1000E935

loc_1000E92B:				; CODE XREF: sub_1000E8A0+A0j
					; sub_1000E8A0+B2j ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000E935:				; CODE XREF: sub_1000E8A0+89j
		lea	ecx, [edi-1]
		sub	edi, 2
		mov	byte ptr [esi],	3Ah
		test	ecx, ecx
		jz	short loc_1000E92B
		mov	byte ptr [esi+1], 3Ah
		add	esi, 2
		cmp	edx, 5
		jnz	short loc_1000E989
		mov	edx, edi
		test	edx, edx
		jz	short loc_1000E92B
		lea	eax, [edi-1]
		mov	byte ptr [esi],	66h
		test	eax, eax
		jz	short loc_1000E92B
		lea	ecx, [edi-2]
		mov	byte ptr [esi+1], 66h
		test	ecx, ecx
		jz	short loc_1000E92B
		lea	edx, [edi-3]
		mov	byte ptr [esi+2], 66h
		test	edx, edx
		jz	short loc_1000E92B
		lea	eax, [edi-4]
		sub	edi, 5
		mov	byte ptr [esi+3], 66h
		test	eax, eax
		jz	short loc_1000E92B
		mov	byte ptr [esi+4], 3Ah
		add	esi, 5

loc_1000E989:				; CODE XREF: sub_1000E8A0+ACj
		mov	ecx, [esp+18h+arg_0]
		mov	al, [ecx+0Ch]
		cmp	al, 63h
		jbe	short loc_1000E9B4
		mov	edx, edi
		dec	edi
		test	edx, edx
		jz	short loc_1000E92B
		movzx	ecx, al
		mov	eax, 51EB851Fh
		imul	ecx
		sar	edx, 5
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		add	al, 30h
		mov	[esi], al
		inc	esi

loc_1000E9B4:				; CODE XREF: sub_1000E8A0+F2j
		mov	ecx, [esp+18h+arg_0]
		mov	al, [ecx+0Ch]
		cmp	al, 9
		jbe	short loc_1000E9EB
		mov	edx, edi
		dec	edi
		test	edx, edx
		jz	loc_1000E92B
		movzx	eax, al
		cdq
		mov	ecx, 64h
		idiv	ecx
		mov	eax, 66666667h
		imul	edx
		sar	edx, 2
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		add	al, 30h
		mov	[esi], al
		inc	esi

loc_1000E9EB:				; CODE XREF: sub_1000E8A0+11Dj
		mov	ecx, edi
		test	ecx, ecx
		jz	loc_1000E92B
		mov	ebx, [esp+18h+arg_0]
		movzx	eax, byte ptr [ebx+0Ch]
		cdq
		mov	ecx, 0Ah
		idiv	ecx
		add	dl, 30h
		mov	[esi], dl
		lea	edx, [edi-1]
		sub	edi, 2
		test	edx, edx
		jz	loc_1000E92B
		mov	byte ptr [esi+1], 2Eh
		mov	al, [ebx+0Dh]
		add	esi, 2
		cmp	al, 63h
		jbe	short loc_1000EA4A
		mov	ecx, edi
		dec	edi
		test	ecx, ecx
		jz	loc_1000E92B
		movzx	ecx, al
		mov	eax, 51EB851Fh
		imul	ecx
		sar	edx, 5
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		add	al, 30h
		mov	[esi], al
		inc	esi

loc_1000EA4A:				; CODE XREF: sub_1000E8A0+184j
		mov	al, [ebx+0Dh]
		cmp	al, 9
		jbe	short loc_1000EA7D
		mov	ecx, edi
		dec	edi
		test	ecx, ecx
		jz	loc_1000E92B
		movzx	eax, al
		cdq
		mov	ecx, 64h
		idiv	ecx
		mov	eax, 66666667h
		imul	edx
		sar	edx, 2
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		add	al, 30h
		mov	[esi], al
		inc	esi

loc_1000EA7D:				; CODE XREF: sub_1000E8A0+1AFj
		mov	ecx, edi
		test	ecx, ecx
		jz	loc_1000E92B
		movzx	eax, byte ptr [ebx+0Dh]
		cdq
		mov	ecx, 0Ah
		idiv	ecx
		add	dl, 30h
		mov	[esi], dl
		lea	edx, [edi-1]
		sub	edi, 2
		test	edx, edx
		jz	loc_1000E92B
		mov	byte ptr [esi+1], 2Eh
		mov	al, [ebx+0Eh]
		add	esi, 2
		cmp	al, 63h
		jbe	short loc_1000EAD8
		mov	ecx, edi
		dec	edi
		test	ecx, ecx
		jz	loc_1000E92B
		movzx	ecx, al
		mov	eax, 51EB851Fh
		imul	ecx
		sar	edx, 5
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		add	al, 30h
		mov	[esi], al
		inc	esi

loc_1000EAD8:				; CODE XREF: sub_1000E8A0+212j
		mov	al, [ebx+0Eh]
		cmp	al, 9
		jbe	short loc_1000EB0B
		mov	ecx, edi
		dec	edi
		test	ecx, ecx
		jz	loc_1000E92B
		movzx	eax, al
		cdq
		mov	ecx, 64h
		idiv	ecx
		mov	eax, 66666667h
		imul	edx
		sar	edx, 2
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		add	al, 30h
		mov	[esi], al
		inc	esi

loc_1000EB0B:				; CODE XREF: sub_1000E8A0+23Dj
		mov	ecx, edi
		test	ecx, ecx
		jz	loc_1000E92B
		movzx	eax, byte ptr [ebx+0Eh]
		cdq
		mov	ecx, 0Ah
		idiv	ecx
		add	dl, 30h
		mov	[esi], dl
		lea	edx, [edi-1]
		sub	edi, 2
		test	edx, edx
		jz	loc_1000E92B
		mov	byte ptr [esi+1], 2Eh
		mov	al, [ebx+0Fh]
		add	esi, 2
		cmp	al, 63h
		jbe	short loc_1000EB66
		mov	ecx, edi
		dec	edi
		test	ecx, ecx
		jz	loc_1000E92B
		movzx	ecx, al
		mov	eax, 51EB851Fh
		imul	ecx
		sar	edx, 5
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		add	al, 30h
		mov	[esi], al
		inc	esi

loc_1000EB66:				; CODE XREF: sub_1000E8A0+2A0j
		mov	al, [ebx+0Fh]
		cmp	al, 9
		jbe	short loc_1000EB99
		mov	ecx, edi
		dec	edi
		test	ecx, ecx
		jz	loc_1000E92B
		movzx	eax, al
		cdq
		mov	ecx, 64h
		idiv	ecx
		mov	eax, 66666667h
		imul	edx
		sar	edx, 2
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		add	al, 30h
		mov	[esi], al
		inc	esi

loc_1000EB99:				; CODE XREF: sub_1000E8A0+2CBj
		test	edi, edi
		jz	loc_1000E92B
		movzx	eax, byte ptr [ebx+0Fh]
		cdq
		mov	ecx, 0Ah
		idiv	ecx
		add	dl, 30h
		dec	edi
		mov	[esi], dl
		jz	loc_1000E92B
		mov	eax, [esp+18h+var_4]
		pop	edi
		mov	byte ptr [esi+1], 0
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_1000EBD0:				; CODE XREF: sub_1000E8A0+5Ej
					; sub_1000E8A0+6Cj ...
		cmp	ebp, ebx
		jnz	short loc_1000EBFF
		mov	edx, edi
		test	edx, edx
		jz	loc_1000E92B
		lea	eax, [edi-1]
		sub	edi, 2
		mov	byte ptr [esi],	3Ah
		test	eax, eax
		jz	loc_1000E92B
		mov	byte ptr [esi+1], 3Ah
		add	esi, 2
		add	ebp, [esp+18h+var_8]
		jmp	loc_1000EC9E
; ---------------------------------------------------------------------------

loc_1000EBFF:				; CODE XREF: sub_1000E8A0+332j
		mov	ecx, [esp+18h+arg_0]
		movzx	edx, word ptr [ecx+ebp*2]
		push	edx		; netshort
		call	ntohs
		mov	ecx, off_100302E0
		movzx	eax, ax
		cmp	eax, 0FFFh
		jbe	short loc_1000EC33
		mov	edx, edi
		dec	edi
		test	edx, edx
		jz	loc_1000E92B
		mov	edx, eax
		shr	edx, 0Ch
		mov	dl, [edx+ecx]
		mov	[esi], dl
		inc	esi

loc_1000EC33:				; CODE XREF: sub_1000E8A0+37Bj
		cmp	eax, 0FFh
		jbe	short loc_1000EC53
		mov	edx, edi
		dec	edi
		test	edx, edx
		jz	loc_1000E92B
		mov	edx, eax
		shr	edx, 8
		and	edx, 0Fh
		mov	dl, [edx+ecx]
		mov	[esi], dl
		inc	esi

loc_1000EC53:				; CODE XREF: sub_1000E8A0+398j
		cmp	eax, 0Fh
		jbe	short loc_1000EC71
		mov	edx, edi
		dec	edi
		test	edx, edx
		jz	loc_1000E92B
		mov	edx, eax
		shr	edx, 4
		and	edx, 0Fh
		mov	dl, [edx+ecx]
		mov	[esi], dl
		inc	esi

loc_1000EC71:				; CODE XREF: sub_1000E8A0+3B6j
		mov	edx, edi
		dec	edi
		test	edx, edx
		jz	loc_1000E92B
		and	eax, 0Fh
		mov	al, [eax+ecx]
		mov	[esi], al
		inc	ebp
		inc	esi
		cmp	ebp, 8
		jge	short loc_1000ECA7
		cmp	ebp, ebx
		jz	short loc_1000EC9E
		mov	ecx, edi
		dec	edi
		test	ecx, ecx
		jz	loc_1000E92B
		mov	byte ptr [esi],	3Ah
		inc	esi

loc_1000EC9E:				; CODE XREF: sub_1000E8A0+35Aj
					; sub_1000E8A0+3EDj
		cmp	ebp, 8
		jl	loc_1000EBD0

loc_1000ECA7:				; CODE XREF: sub_1000E8A0+3E9j
		test	edi, edi
		jz	loc_1000E92B
		mov	eax, [esp+18h+var_4]
		pop	edi
		mov	byte ptr [esi],	0
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_1000E8A0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  58. PR_ConvertIPv4AddrToIPv6

; =============== S U B	R O U T	I N E =======================================


		public PR_ConvertIPv4AddrToIPv6
PR_ConvertIPv4AddrToIPv6 proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_0]
		xor	ecx, ecx
		mov	[eax], ecx
		mov	[eax+4], ecx
		mov	[eax+8], cx
		or	ecx, 0FFFFFFFFh
		mov	[eax+0Ah], cx
		mov	[eax+0Ch], edx
		retn
PR_ConvertIPv4AddrToIPv6 endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 389. PR_ntohs

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_ntohs(u_short netshort)
		public PR_ntohs
PR_ntohs	proc near		; DATA XREF: .rdata:off_1002C7C8o

netshort	= word ptr  4

		mov	eax, dword ptr [esp+netshort]
		push	eax		; netshort
		call	ntohs
		retn
PR_ntohs	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 387. PR_ntohl

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_ntohl(u_long netlong)
		public PR_ntohl
PR_ntohl	proc near		; DATA XREF: .rdata:off_1002C7C8o

netlong		= dword	ptr  4

		mov	eax, [esp+netlong]
		push	eax		; netlong
		call	ntohl
		retn
PR_ntohl	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 386. PR_htons

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_htons(u_short hostshort)
		public PR_htons
PR_htons	proc near		; DATA XREF: .rdata:off_1002C7C8o

hostshort	= word ptr  4

		mov	eax, dword ptr [esp+hostshort]
		push	eax		; hostshort
		call	htons
		retn
PR_htons	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 384. PR_htonl

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_htonl(u_long hostlong)
		public PR_htonl
PR_htonl	proc near		; CODE XREF: sub_1000F380+12Cp
					; DATA XREF: .rdata:off_1002C7C8o

hostlong	= dword	ptr  4

		mov	eax, [esp+hostlong]
		push	eax		; hostlong
		call	htonl
		retn
PR_htonl	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 388. PR_ntohll

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_ntohll(u_long,	u_long netlong)
		public PR_ntohll
PR_ntohll	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
netlong		= dword	ptr  8

		mov	eax, [esp+netlong]
		push	esi
		mov	ecx, eax
		push	eax		; netlong
		sar	ecx, 1Fh
		call	ntohl
		mov	edx, [esp+4+arg_0]
		push	edx		; netlong
		mov	esi, eax
		call	ntohl
		mov	edx, eax
		xor	eax, eax
		xor	ecx, ecx
		add	ecx, esi
		adc	edx, eax
		mov	eax, ecx
		pop	esi
		retn
PR_ntohll	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 385. PR_htonll

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_htonll(u_long,	u_long hostlong)
		public PR_htonll
PR_htonll	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
hostlong	= dword	ptr  8

		mov	eax, [esp+hostlong]
		push	esi
		mov	ecx, eax
		push	eax		; hostlong
		sar	ecx, 1Fh
		call	htonl
		mov	edx, [esp+4+arg_0]
		push	edx		; hostlong
		mov	esi, eax
		call	htonl
		mov	edx, eax
		xor	eax, eax
		xor	ecx, ecx
		add	ecx, esi
		adc	edx, eax
		mov	eax, ecx
		pop	esi
		retn
PR_htonll	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000ED80	proc near		; CODE XREF: .text:loc_100036F0p

lpLibFileName	= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 8
		push	esi
		push	edi
		mov	[esp+10h+lpLibFileName], offset	aWs2_32_dll ; "ws2_32.dll"
		mov	[esp+10h+var_4], offset	aWship6_dll ; "wship6.dll"
		xor	edi, edi
		jmp	short loc_1000EDA0
; ---------------------------------------------------------------------------
		align 10h

loc_1000EDA0:				; CODE XREF: sub_1000ED80+17j
					; sub_1000ED80+87j
		mov	eax, [esp+edi*4+10h+lpLibFileName]
		push	eax		; lpLibFileName
		call	PR_LoadLibrary
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_1000EE03
		push	offset aGetaddrinfo ; "getaddrinfo"
		push	esi
		call	PR_FindSymbol
		add	esp, 8
		mov	dword_10031534,	eax
		test	eax, eax
		jz	short loc_1000EDFA
		push	offset aFreeaddrinfo ; "freeaddrinfo"
		push	esi
		call	PR_FindSymbol
		push	offset aGetnameinfo ; "getnameinfo"
		push	esi
		mov	dword_10031538,	eax
		call	PR_FindSymbol
		add	esp, 10h
		cmp	dword_10031538,	0
		mov	dword_1003153C,	eax
		jz	short loc_1000EDFA
		test	eax, eax
		jnz	short loc_1000EE12

loc_1000EDFA:				; CODE XREF: sub_1000ED80+48j
					; sub_1000ED80+74j
		push	esi		; Memory
		call	PR_UnloadLibrary
		add	esp, 4

loc_1000EE03:				; CODE XREF: sub_1000ED80+31j
		inc	edi
		cmp	edi, 2
		jb	short loc_1000EDA0
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1000EE12:				; CODE XREF: sub_1000ED80+78j
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
sub_1000ED80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000EE20(char	*name)
sub_1000EE20	proc near		; CODE XREF: PR_GetAddrInfoByName+5Ap

name		= dword	ptr  4

		push	esi
		push	edi
		push	414h		; Size
		mov	edi, eax
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1000EE4A
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000EE4A:				; CODE XREF: sub_1000EE20+15j
		mov	ecx, [esp+8+name]
		lea	eax, [esi+400h]
		push	eax		; int
		push	400h		; char
		push	esi		; char
		push	ecx		; name
		call	PR_GetHostByName
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000EE77
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000EE77:				; CODE XREF: sub_1000EE20+47j
		shr	edi, 0Fh
		not	edi
		and	edi, 1
		mov	[esi+410h], edi
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_1000EE20	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 139. PR_GetAddrInfoByName

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetAddrInfoByName(char	*name, int, int)
		public PR_GetAddrInfoByName
PR_GetAddrInfoByName proc near		; DATA XREF: .rdata:off_1002C7C8o

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
name		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 20h
		push	esi
		push	edi
		mov	di, word ptr [esp+28h+arg_4]
		cmp	di, 2
		jz	short loc_1000EEA5
		test	di, di
		jnz	short loc_1000EEB5

loc_1000EEA5:				; CODE XREF: PR_GetAddrInfoByName+Ej
		mov	esi, [esp+28h+arg_8]
		mov	eax, esi
		and	eax, 0FFFF7FFFh
		cmp	eax, 20h
		jz	short loc_1000EECC

loc_1000EEB5:				; CODE XREF: PR_GetAddrInfoByName+13j
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1000EECC:				; CODE XREF: PR_GetAddrInfoByName+23j
		cmp	dword_10031520,	0
		jnz	short loc_1000EEDA
		call	PR_Init

loc_1000EEDA:				; CODE XREF: PR_GetAddrInfoByName+43j
		call	sub_100037C0
		test	eax, eax
		jnz	short loc_1000EEF8
		mov	ecx, [esp+28h+name]
		push	ecx		; name
		mov	eax, esi
		call	sub_1000EE20
		add	esp, 4
		pop	edi
		pop	esi
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1000EEF8:				; CODE XREF: PR_GetAddrInfoByName+51j
		xor	eax, eax
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_18], eax
		mov	[esp+28h+var_14], eax
		mov	[esp+28h+var_10], eax
		mov	[esp+28h+var_C], eax
		mov	[esp+28h+var_8], eax
		mov	[esp+28h+var_4], eax
		test	esi, 8000h
		jnz	short loc_1000EF27
		or	[esp+28h+var_20], 2

loc_1000EF27:				; CODE XREF: PR_GetAddrInfoByName+90j
		xor	edx, edx
		cmp	di, 2
		setnz	dl
		lea	eax, [esp+28h+arg_4]
		push	eax
		lea	ecx, [esp+2Ch+var_20]
		push	ecx
		push	0
		mov	[esp+34h+var_18], 1
		dec	edx
		and	edx, 2
		mov	[esp+34h+var_1C], edx
		mov	edx, [esp+34h+name]
		push	edx
		call	dword_10031534
		test	eax, eax
		jnz	short loc_1000EF65
		mov	eax, [esp+28h+arg_4]
		pop	edi
		pop	esi
		add	esp, 20h
		retn
; ---------------------------------------------------------------------------

loc_1000EF65:				; CODE XREF: PR_GetAddrInfoByName+C9j
		push	eax
		push	0FFFFE8ABh
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 20h
		retn
PR_GetAddrInfoByName endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 135. PR_FreeAddrInfo

; =============== S U B	R O U T	I N E =======================================


		public PR_FreeAddrInfo
PR_FreeAddrInfo	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		call	sub_100037C0
		test	eax, eax
		jnz	short loc_1000EF8E
		jmp	PR_Free
; ---------------------------------------------------------------------------

loc_1000EF8E:				; CODE XREF: PR_FreeAddrInfo+7j
		mov	ecx, [esp+arg_0]
		push	ecx
		call	dword_10031538
		retn
PR_FreeAddrInfo	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 103. PR_EnumerateAddrInfo

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_EnumerateAddrInfo(int,	int, u_short hostshort,	void *Dst)
		public PR_EnumerateAddrInfo
PR_EnumerateAddrInfo proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
hostshort	= word ptr  0Ch
Dst		= dword	ptr  10h

		call	sub_100037C0
		test	eax, eax
		jnz	short loc_1000EFD6
		mov	eax, [esp+Dst]
		mov	ecx, dword ptr [esp+hostshort]
		mov	edx, [esp+arg_4]
		push	eax		; int
		mov	eax, [esp+4+arg_0]
		push	ecx		; hostshort
		add	edx, 400h
		push	edx		; int
		push	eax		; int
		call	PR_EnumerateHostEnt
		add	esp, 10h
		test	eax, eax
		jns	locret_1000F066
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1000EFD6:				; CODE XREF: PR_EnumerateAddrInfo+7j
		mov	eax, [esp+arg_0]
		push	esi
		test	eax, eax
		jz	short loc_1000EFE4
		mov	esi, [eax+1Ch]
		jmp	short loc_1000EFE8
; ---------------------------------------------------------------------------

loc_1000EFE4:				; CODE XREF: PR_EnumerateAddrInfo+3Dj
		mov	esi, [esp+4+arg_4]

loc_1000EFE8:				; CODE XREF: PR_EnumerateAddrInfo+42j
		test	esi, esi
		jz	short loc_1000F063
		push	ebx
		mov	ebx, 20h

loc_1000EFF2:				; CODE XREF: PR_EnumerateAddrInfo+5Cj
		cmp	[esi+10h], ebx
		jbe	short loc_1000F003
		mov	esi, [esi+1Ch]
		test	esi, esi
		jnz	short loc_1000EFF2
		pop	ebx
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F003:				; CODE XREF: PR_EnumerateAddrInfo+55j
		mov	ecx, [esi+10h]
		mov	edx, [esi+18h]
		push	edi
		mov	edi, [esp+0Ch+Dst]
		push	ecx		; Size
		push	edx		; Src
		push	edi		; Dst
		call	memcpy
		mov	eax, [esi+18h]
		mov	cx, [eax]
		mov	[edi], cx
		mov	eax, [esi+10h]
		add	esp, 0Ch
		cmp	eax, ebx
		jnb	short loc_1000F039
		sub	ebx, eax
		push	ebx		; Size
		add	eax, edi
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_1000F039:				; CODE XREF: PR_EnumerateAddrInfo+87j
		cmp	word ptr [edi],	2
		jnz	short loc_1000F053
		mov	edx, dword ptr [esp+0Ch+hostshort]
		push	edx		; hostshort
		call	htons
		mov	[edi+2], ax
		pop	edi
		pop	ebx
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F053:				; CODE XREF: PR_EnumerateAddrInfo+9Dj
		mov	eax, dword ptr [esp+0Ch+hostshort]
		push	eax		; hostshort
		call	htons
		mov	[edi+2], ax
		pop	edi
		pop	ebx

loc_1000F063:				; CODE XREF: PR_EnumerateAddrInfo+4Aj
		mov	eax, esi
		pop	esi

locret_1000F066:			; CODE XREF: PR_EnumerateAddrInfo+2Dj
		retn
PR_EnumerateAddrInfo endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 140. PR_GetCanonNameFromAddrInfo

; =============== S U B	R O U T	I N E =======================================


		public PR_GetCanonNameFromAddrInfo
PR_GetCanonNameFromAddrInfo proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		call	sub_100037C0
		test	eax, eax
		mov	eax, [esp+arg_0]
		jnz	short loc_1000F090
		cmp	dword ptr [eax+410h], 0
		jz	short loc_1000F08D
		mov	eax, [eax+400h]
		retn
; ---------------------------------------------------------------------------

loc_1000F08D:				; CODE XREF: PR_GetCanonNameFromAddrInfo+14j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1000F090:				; CODE XREF: PR_GetCanonNameFromAddrInfo+Bj
		mov	eax, [eax+14h]
		retn
PR_GetCanonNameFromAddrInfo endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F0A0	proc near		; CODE XREF: PR_StringToNetAddr+4Bp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
Dst		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+48h+var_4], eax
		xor	eax, eax
		push	ebx
		mov	[esp+4Ch+var_44], eax
		mov	[esp+4Ch+var_40], eax
		mov	[esp+4Ch+var_3C], eax
		mov	[esp+4Ch+var_38], eax
		mov	[esp+4Ch+var_34], eax
		mov	[esp+4Ch+var_30], eax
		mov	[esp+4Ch+var_2C], eax
		mov	[esp+4Ch+var_28], eax
		lea	eax, [esp+4Ch+var_48]
		push	eax
		lea	edx, [esp+50h+var_44]
		push	edx
		xor	ebx, ebx
		push	ebx
		push	ecx
		mov	[esp+5Ch+var_44], 4
		mov	[esp+5Ch+var_40], ebx
		mov	[esp+5Ch+var_3C], 1
		call	dword_10031534
		cmp	eax, ebx
		jz	short loc_1000F11E
		push	eax
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+48h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
; ---------------------------------------------------------------------------

loc_1000F11E:				; CODE XREF: sub_1000F0A0+5Bj
		push	ebp
		mov	ebp, [esp+50h+var_48]
		mov	eax, [ebp+10h]
		push	edi
		mov	edi, [ebp+18h]
		push	eax		; Size
		lea	ecx, [esp+58h+Dst]
		push	edi		; Src
		push	ecx		; Dst
		call	memcpy
		movzx	eax, word ptr [edi]
		mov	edx, 17h
		add	esp, 0Ch
		cmp	dx, ax
		jnz	short loc_1000F170
		mov	ecx, [esp+54h+var_1C]
		mov	eax, edx
		mov	edx, [esp+54h+var_18]
		mov	[esi+8], ecx
		mov	ecx, [esp+54h+var_10]
		mov	[esi+0Ch], edx
		mov	edx, [esp+54h+var_C]
		mov	[esi], ax
		mov	eax, [esp+54h+var_14]
		mov	[esi+10h], eax
		mov	[esi+14h], ecx
		mov	[esi+18h], edx
		jmp	short loc_1000F19E
; ---------------------------------------------------------------------------

loc_1000F170:				; CODE XREF: sub_1000F0A0+A4j
		mov	ecx, 2
		cmp	cx, ax
		jnz	short loc_1000F188
		mov	eax, [esp+54h+var_20]
		mov	edx, ecx
		mov	[esi], dx
		mov	[esi+4], eax
		jmp	short loc_1000F19E
; ---------------------------------------------------------------------------

loc_1000F188:				; CODE XREF: sub_1000F0A0+D8j
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		mov	ebp, [esp+5Ch+var_48]
		add	esp, 8
		or	ebx, 0FFFFFFFFh

loc_1000F19E:				; CODE XREF: sub_1000F0A0+CEj
					; sub_1000F0A0+E6j
		push	ebp
		call	dword_10031538
		mov	ecx, [esp+54h+var_4]
		pop	edi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 48h
		retn
sub_1000F0A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F1C0	proc near		; CODE XREF: PR_StringToNetAddr:loc_1000F255p
		push	esi
		lea	esi, [edi+4]
		push	esi
		push	ebx
		call	sub_1000F380
		add	esp, 8
		cmp	eax, 1
		jnz	short loc_1000F1DF
		mov	eax, 2
		mov	[edi], ax
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F1DF:				; CODE XREF: sub_1000F1C0+11j
		lea	ecx, [edi+8]
		push	ecx
		mov	eax, ebx
		mov	dword ptr [esi], 0
		call	sub_1000E610
		add	esp, 4
		cmp	eax, 1
		jnz	short loc_1000F204
		mov	edx, 17h
		mov	[edi], dx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F204:				; CODE XREF: sub_1000F1C0+36j
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_1000F1C0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 351. PR_StringToNetAddr

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_StringToNetAddr(char *Str, int)
		public PR_StringToNetAddr
PR_StringToNetAddr proc	near		; DATA XREF: .rdata:off_1002C7C8o

Str		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword_10031520,	0
		jnz	short loc_1000F22E
		call	PR_Init

loc_1000F22E:				; CODE XREF: PR_StringToNetAddr+7j
		push	ebx
		push	edi
		mov	edi, [esp+8+arg_4]
		test	edi, edi
		jz	short loc_1000F274
		mov	ebx, [esp+8+Str]
		test	ebx, ebx
		jz	short loc_1000F274
		cmp	byte ptr [ebx],	0
		jz	short loc_1000F274
		push	25h		; Val
		push	ebx		; Str
		call	ds:strchr
		add	esp, 8
		test	eax, eax
		jnz	short loc_1000F25D

loc_1000F255:				; CODE XREF: PR_StringToNetAddr+44j
		call	sub_1000F1C0
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F25D:				; CODE XREF: PR_StringToNetAddr+33j
		call	sub_100037C0
		test	eax, eax
		jz	short loc_1000F255
		push	esi
		mov	esi, edi
		mov	ecx, ebx
		call	sub_1000F0A0
		pop	esi
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F274:				; CODE XREF: PR_StringToNetAddr+16j
					; PR_StringToNetAddr+1Ej ...
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
PR_StringToNetAddr endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR PR_NetAddrToString

loc_1000F290:				; CODE XREF: PR_NetAddrToString+23j
		push	esi
		movzx	esi, word ptr [edx]
		push	edi
		mov	edi, 17h
		cmp	di, si
		jnz	short loc_1000F2C3
		add	edx, 8
		push	edx
		call	sub_1000E8A0
		add	esp, 4
		test	eax, eax
		jnz	short loc_1000F30A
		push	eax
		push	0FFFFE8B6h
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F2C3:				; CODE XREF: PR_NetAddrToString-73j
		cmp	eax, 10h
		jb	short loc_1000F2D2
		mov	edi, 2
		cmp	di, si
		jz	short loc_1000F2E7

loc_1000F2D2:				; CODE XREF: PR_NetAddrToString-4Aj
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F2E7:				; CODE XREF: PR_NetAddrToString-40j
		movzx	esi, byte ptr [edx+7]
		push	esi
		movzx	esi, byte ptr [edx+6]
		push	esi
		movzx	esi, byte ptr [edx+5]
		movzx	edx, byte ptr [edx+4]
		push	esi
		push	edx
		push	offset aU_U_U_U	; "%u.%u.%u.%u"
		push	eax
		push	ecx
		call	PR_snprintf
		add	esp, 1Ch

loc_1000F30A:				; CODE XREF: PR_NetAddrToString-63j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; END OF FUNCTION CHUNK	FOR PR_NetAddrToString
; ---------------------------------------------------------------------------
		align 10h
; Exported entry 250. PR_NetAddrToString

; =============== S U B	R O U T	I N E =======================================


		public PR_NetAddrToString
PR_NetAddrToString proc	near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

; FUNCTION CHUNK AT 1000F290 SIZE 0000007F BYTES

		cmp	dword_10031520,	0
		jnz	short loc_1000F31E
		call	PR_Init

loc_1000F31E:				; CODE XREF: PR_NetAddrToString+7j
		call	sub_100037C0
		test	eax, eax
		jnz	short loc_1000F338
		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_0]
		jmp	loc_1000F290
; ---------------------------------------------------------------------------

loc_1000F338:				; CODE XREF: PR_NetAddrToString+15j
		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_8]
		xor	ecx, ecx
		cmp	word ptr [eax],	2
		push	2
		setnz	cl
		push	0
		push	0
		push	edx
		mov	edx, [esp+10h+arg_4]
		push	edx
		dec	ecx
		and	ecx, 0FFFFFFF4h
		add	ecx, 1Ch
		push	ecx
		push	eax
		call	dword_1003153C
		test	eax, eax
		jz	short loc_1000F37A
		push	eax
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1000F37A:				; CODE XREF: PR_NetAddrToString+56j
		xor	eax, eax
		retn
PR_NetAddrToString endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=0FFFFFFF8h

sub_1000F380	proc near		; CODE XREF: sub_1000F1C0+6p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	ecx, [esp-4+arg_0]
		push	ebx
		push	ebp
		push	esi
		push	edi
		lea	ebp, [esp+14h]

loc_1000F38C:				; CODE XREF: sub_1000F380+A3j
		mov	al, [ecx]
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_1000F428
		xor	edx, edx
		xor	esi, esi
		lea	edi, [edx+0Ah]
		cmp	al, 30h
		jnz	short loc_1000F3C2
		mov	al, [ecx+1]
		inc	ecx
		cmp	al, 78h
		jz	short loc_1000F3B9
		cmp	al, 58h
		jz	short loc_1000F3B9
		lea	edi, [edx+8]
		lea	esi, [edx+1]
		jmp	short loc_1000F3C2
; ---------------------------------------------------------------------------

loc_1000F3B9:				; CODE XREF: sub_1000F380+2Bj
					; sub_1000F380+2Fj
		mov	edi, 10h

loc_1000F3BE:				; CODE XREF: sub_1000F380+68j
					; sub_1000F380+88j
		mov	al, [ecx+1]
		inc	ecx

loc_1000F3C2:				; CODE XREF: sub_1000F380+23j
					; sub_1000F380+37j
		lea	ebx, [eax-30h]
		cmp	bl, 9
		ja	short loc_1000F3EA
		cmp	edi, 8
		jnz	short loc_1000F3D7
		cmp	al, 38h
		jz	short loc_1000F428
		cmp	al, 39h
		jz	short loc_1000F428

loc_1000F3D7:				; CODE XREF: sub_1000F380+4Dj
		mov	esi, edi
		imul	esi, edx
		movsx	eax, al
		lea	edx, [esi+eax-30h]
		mov	esi, 1
		jmp	short loc_1000F3BE
; ---------------------------------------------------------------------------

loc_1000F3EA:				; CODE XREF: sub_1000F380+48j
		cmp	edi, 10h
		jnz	short loc_1000F40A
		movzx	ebx, al
		mov	bl, ds:byte_1002A4C8[ebx]
		cmp	bl, 7Fh
		jz	short loc_1000F40A
		movzx	eax, bl
		shl	edx, 4
		add	edx, eax
		lea	esi, [edi-0Fh]
		jmp	short loc_1000F3BE
; ---------------------------------------------------------------------------

loc_1000F40A:				; CODE XREF: sub_1000F380+6Dj
					; sub_1000F380+7Bj
		cmp	al, 2Eh
		jnz	short loc_1000F42F
		lea	eax, [esp+0Ch+arg_0+3]
		cmp	ebp, eax
		jnb	short loc_1000F428
		cmp	edx, 0FFh
		ja	short loc_1000F428
		mov	byte ptr [ebp-8+arg_0],	dl
		inc	ebp
		inc	ecx
		jmp	loc_1000F38C
; ---------------------------------------------------------------------------

loc_1000F428:				; CODE XREF: sub_1000F380+14j
					; sub_1000F380+51j ...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F42F:				; CODE XREF: sub_1000F380+8Cj
		test	al, al
		jz	short loc_1000F43F
		cmp	al, 20h
		jz	short loc_1000F43F
		cmp	al, 9
		jl	short loc_1000F428
		cmp	al, 0Dh
		jg	short loc_1000F428

loc_1000F43F:				; CODE XREF: sub_1000F380+B1j
					; sub_1000F380+B5j
		test	esi, esi
		jz	short loc_1000F428
		lea	ecx, [esp+0Ch+arg_0]
		sub	ebp, ecx
		lea	eax, [ebp-8+arg_0+1]
		sub	eax, 2
		jz	short loc_1000F499
		dec	eax
		jz	short loc_1000F47D
		dec	eax
		jnz	short loc_1000F4AB
		cmp	edx, 0FFh
		ja	short loc_1000F428
		mov	eax, [esp+0Ch+arg_0]
		movzx	ecx, al
		shl	ecx, 8
		movzx	eax, ah
		or	ecx, eax
		movzx	eax, byte ptr [esp+0Ch+arg_0+2]
		shl	ecx, 8
		or	ecx, eax
		shl	ecx, 8
		jmp	short loc_1000F4A9
; ---------------------------------------------------------------------------

loc_1000F47D:				; CODE XREF: sub_1000F380+D2j
		cmp	edx, 0FFFFh
		ja	short loc_1000F428
		mov	eax, [esp+0Ch+arg_0]
		movzx	ecx, al
		movzx	eax, ah
		shl	ecx, 8
		or	ecx, eax
		shl	ecx, 10h
		jmp	short loc_1000F4A9
; ---------------------------------------------------------------------------

loc_1000F499:				; CODE XREF: sub_1000F380+CFj
		cmp	edx, 0FFFFFFh
		ja	short loc_1000F428
		movzx	ecx, byte ptr [esp+0Ch+arg_0]
		shl	ecx, 18h

loc_1000F4A9:				; CODE XREF: sub_1000F380+FBj
					; sub_1000F380+117j
		or	edx, ecx

loc_1000F4AB:				; CODE XREF: sub_1000F380+D5j
		push	edx		; hostlong
		call	PR_htonl
		mov	edx, [esp+10h+arg_4]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	[edx], eax
		mov	eax, 1
		pop	ebx
		retn
sub_1000F380	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  86. PR_DestroyOrderedLock
; Exported entry 235. PR_LockOrderedLock

; =============== S U B	R O U T	I N E =======================================


		public PR_LockOrderedLock
PR_LockOrderedLock proc	near		; DATA XREF: .rdata:off_1002C7C8o
		push	0		; PR_DestroyOrderedLock
		push	0FFFFE898h
		call	PR_SetError
		add	esp, 8
		retn
PR_LockOrderedLock endp

; Exported entry 286. PR_ProcessAttrSetInheritableFileMap
; Exported entry 335. PR_SetSysfdTableSize
; Exported entry 369. PR_UnlockOrderedLock

; =============== S U B	R O U T	I N E =======================================


		public PR_UnlockOrderedLock
PR_UnlockOrderedLock proc near		; DATA XREF: .rdata:off_1002C7C8o
		push	0		; PR_ProcessAttrSetInheritableFileMap
					; PR_SetSysfdTableSize
		push	0FFFFE898h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
PR_UnlockOrderedLock endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 183. PR_GetRandomNoise
; [00000005 BYTES: COLLAPSED FUNCTION PR_GetRandomNoise]
		align 10h
; Exported entry 148. PR_GetDirectorySeparator
; Exported entry 149. PR_GetDirectorySepartor

; =============== S U B	R O U T	I N E =======================================


		public PR_GetDirectorySepartor
PR_GetDirectorySepartor	proc near	; DATA XREF: .rdata:off_1002C7C8o
		mov	al, 5Ch		; PR_GetDirectorySeparator
		retn
PR_GetDirectorySepartor	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 177. PR_GetPathSeparator

; =============== S U B	R O U T	I N E =======================================


		public PR_GetPathSeparator
PR_GetPathSeparator proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	al, 3Bh
		retn
PR_GetPathSeparator endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 190. PR_GetSystemInfo

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetSystemInfo(int, char *name,	int namelen)
		public PR_GetSystemInfo
PR_GetSystemInfo proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
name		= dword	ptr  8
namelen		= dword	ptr  0Ch

		push	ebx
		push	ebp
		push	esi
		xor	esi, esi
		push	edi
		cmp	dword_10031520,	esi
		jnz	short loc_1000F543
		call	PR_Init

loc_1000F543:				; CODE XREF: PR_GetSystemInfo+Cj
		mov	ebx, [esp+10h+arg_0]
		cmp	ebx, 4		; switch 5 cases
		ja	loc_1000F5EF	; jumptable 1000F550 default case
		jmp	ds:off_1000F608[ebx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000F557:				; CODE XREF: PR_GetSystemInfo+20j
					; DATA XREF: .text:off_1000F608o
		mov	ebp, [esp+10h+namelen] ; jumptable 1000F550 cases 0,4
		mov	edi, [esp+10h+name]
		push	ebp		; namelen
		push	edi		; name
		call	sub_1001C9D0
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jz	loc_1000F5FE
		cmp	ebx, 4
		jz	short loc_1000F5E8
		cmp	byte ptr [edi],	0
		jz	short loc_1000F5E8
		lea	esp, [esp+0]

loc_1000F580:				; CODE XREF: PR_GetSystemInfo+5Fj
		cmp	esi, ebp
		jnb	short loc_1000F5E8
		cmp	byte ptr [esi+edi], 2Eh
		jz	short loc_1000F598
		inc	esi
		cmp	byte ptr [esi+edi], 0
		jnz	short loc_1000F580
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F598:				; CODE XREF: PR_GetSystemInfo+58j
		mov	byte ptr [esi+edi], 0
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F5A3:				; CODE XREF: PR_GetSystemInfo+20j
					; DATA XREF: .text:off_1000F608o
		mov	eax, [esp+10h+namelen] ; jumptable 1000F550 case 1
		mov	ecx, [esp+10h+name]
		push	eax
		push	ecx
		push	1

loc_1000F5AF:				; CODE XREF: PR_GetSystemInfo+9Fj
		call	sub_1001CA00
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000F5E8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F5C3:				; CODE XREF: PR_GetSystemInfo+20j
					; DATA XREF: .text:off_1000F608o
		mov	edx, [esp+10h+namelen] ; jumptable 1000F550 case 2
		mov	eax, [esp+10h+name]
		push	edx
		push	eax
		push	2
		jmp	short loc_1000F5AF
; ---------------------------------------------------------------------------

loc_1000F5D1:				; CODE XREF: PR_GetSystemInfo+20j
					; DATA XREF: .text:off_1000F608o
		mov	ecx, [esp+10h+namelen] ; jumptable 1000F550 case 3
		mov	edx, [esp+10h+name]
		push	offset dword_1002A5C8
		push	ecx
		push	edx
		call	PR_snprintf
		add	esp, 0Ch

loc_1000F5E8:				; CODE XREF: PR_GetSystemInfo+45j
					; PR_GetSystemInfo+4Aj	...
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000F5EF:				; CODE XREF: PR_GetSystemInfo+1Aj
		push	0		; jumptable 1000F550 default case
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8

loc_1000F5FE:				; CODE XREF: PR_GetSystemInfo+3Cj
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
PR_GetSystemInfo endp

; ---------------------------------------------------------------------------
		align 4
off_1000F608	dd offset loc_1000F557	; DATA XREF: PR_GetSystemInfo+20r
		dd offset loc_1000F5A3	; jump table for switch	statement
		dd offset loc_1000F5C3
		dd offset loc_1000F5D1
		dd offset loc_1000F557
		align 10h
; Exported entry 171. PR_GetNumberOfProcessors

; =============== S U B	R O U T	I N E =======================================


		public PR_GetNumberOfProcessors
PR_GetNumberOfProcessors proc near	; DATA XREF: .rdata:off_1002C7C8o

var_24		= byte ptr -24h
var_10		= dword	ptr -10h

		sub	esp, 24h
		lea	eax, [esp+24h+var_24]
		push	eax		; lpSystemInfo
		call	ds:GetSystemInfo
		mov	eax, [esp+24h+var_10]
		add	esp, 24h
		retn
PR_GetNumberOfProcessors endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 179. PR_GetPhysicalMemorySize

; =============== S U B	R O U T	I N E =======================================


		public PR_GetPhysicalMemorySize
PR_GetPhysicalMemorySize proc near	; DATA XREF: .rdata:off_1002C7C8o

Buffer		= _MEMORYSTATUSEX ptr -44h
var_4		= dword	ptr -4

		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		push	esi
		push	edi
		lea	eax, [esp+4Ch+Buffer]
		push	eax		; lpBuffer
		xor	esi, esi
		xor	edi, edi
		mov	[esp+50h+Buffer.dwLength], 40h
		call	ds:GlobalMemoryStatusEx
		test	eax, eax
		jz	short loc_1000F684
		mov	eax, dword ptr [esp+4Ch+Buffer.ullTotalPhys]
		mov	edx, dword ptr [esp+4Ch+Buffer.ullTotalPhys+4]
		pop	edi
		pop	esi
		mov	ecx, [esp+44h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
; ---------------------------------------------------------------------------

loc_1000F684:				; CODE XREF: PR_GetPhysicalMemorySize+29j
		mov	ecx, [esp+4Ch+var_4]
		mov	edx, edi
		pop	edi
		mov	eax, esi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 44h
		retn
PR_GetPhysicalMemorySize endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 157. PR_GetGCRegisters
; [00000005 BYTES: COLLAPSED FUNCTION PR_GetGCRegisters]
		align 10h
; Exported entry 359. PR_ThreadScanStackPointers

; =============== S U B	R O U T	I N E =======================================


		public PR_ThreadScanStackPointers
PR_ThreadScanStackPointers proc	near	; CODE XREF: .text:1000F781j
					; DATA XREF: .rdata:off_1002C7C8o

var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_GetCurrentThread
		mov	esi, [esp+18h+arg_0]
		mov	edi, eax
		xor	ecx, ecx
		cmp	esi, edi
		setz	cl
		lea	eax, [esp+18h+var_8]
		push	eax
		push	ecx
		push	esi
		call	PR_GetGCRegisters_0
		mov	ebx, [esp+24h+arg_8]
		mov	edx, [esp+24h+var_8]
		mov	ebp, [esp+24h+arg_4]
		push	ebx
		push	edx
		push	eax
		push	esi
		call	ebp
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_1000F761
		cmp	esi, edi
		jnz	short loc_1000F6F8
		lea	eax, [esp+18h+var_4]
		jmp	short loc_1000F701
; ---------------------------------------------------------------------------

loc_1000F6F8:				; CODE XREF: PR_ThreadScanStackPointers+40j
		push	esi
		call	PR_GetSP
		add	esp, 4

loc_1000F701:				; CODE XREF: PR_ThreadScanStackPointers+46j
		mov	ecx, [esi+10h]
		mov	ecx, [ecx+18h]
		cmp	eax, ecx
		jnb	short loc_1000F71D
		sub	ecx, eax
		push	ebx
		sar	ecx, 2
		push	ecx
		push	eax
		push	esi
		call	ebp
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000F761

loc_1000F71D:				; CODE XREF: PR_ThreadScanStackPointers+59j
		push	ebx
		push	1
		lea	edx, [esi+14h]
		push	edx
		push	esi
		call	ebp
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000F761
		mov	edi, [esi+24h]
		mov	[esp+18h+arg_0], eax
		cmp	[esi+20h], eax
		jbe	short loc_1000F75F
		lea	ebx, [ebx+0]

loc_1000F740:				; CODE XREF: PR_ThreadScanStackPointers+ADj
		push	ebx
		push	1
		push	edi
		push	esi
		call	ebp
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1000F761
		mov	eax, [esp+18h+arg_0]
		inc	eax
		add	edi, 4
		mov	[esp+18h+arg_0], eax
		cmp	eax, [esi+20h]
		jb	short loc_1000F740

loc_1000F75F:				; CODE XREF: PR_ThreadScanStackPointers+88j
		xor	eax, eax

loc_1000F761:				; CODE XREF: PR_ThreadScanStackPointers+3Cj
					; PR_ThreadScanStackPointers+6Bj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
PR_ThreadScanStackPointers endp

; ---------------------------------------------------------------------------
		align 10h

loc_1000F770:				; DATA XREF: PR_ScanStackPointers+Fo
		mov	eax, [esp+0Ch]
		mov	ecx, [eax+4]
		mov	[esp+0Ch], ecx
		mov	edx, [eax]
		mov	[esp+8], edx
		jmp	PR_ThreadScanStackPointers
; ---------------------------------------------------------------------------
		align 10h
; Exported entry 310. PR_ScanStackPointers

; =============== S U B	R O U T	I N E =======================================


		public PR_ScanStackPointers
PR_ScanStackPointers proc near		; DATA XREF: .rdata:off_1002C7C8o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		mov	eax, [esp+8+arg_0]
		mov	ecx, [esp+8+arg_4]
		lea	edx, [esp+8+var_8]
		push	edx
		push	offset loc_1000F770
		mov	[esp+10h+var_8], eax
		mov	[esp+10h+var_4], ecx
		call	PR_EnumerateThreads
		add	esp, 10h
		retn
PR_ScanStackPointers endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 188. PR_GetStackSpaceLeft

; =============== S U B	R O U T	I N E =======================================


		public PR_GetStackSpaceLeft
PR_GetStackSpaceLeft proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		call	PR_GetCurrentThread
		mov	esi, [esp+4+arg_0]
		cmp	esi, eax
		jnz	short loc_1000F7E1
		mov	eax, [esi+10h]
		mov	edx, eax
		mov	eax, [eax+1Ch]
		sub	eax, [edx+18h]
		lea	ecx, [esp+4+arg_0]
		add	eax, ecx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F7E1:				; CODE XREF: PR_GetStackSpaceLeft+Cj
		push	esi
		call	PR_GetSP
		mov	ecx, eax
		mov	eax, [esi+10h]
		mov	edx, eax
		mov	eax, [eax+1Ch]
		sub	eax, [edx+18h]
		add	esp, 4
		add	eax, ecx
		pop	esi
		retn
PR_GetStackSpaceLeft endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F800	proc near		; CODE XREF: sub_1000F8A0:loc_1000F925p
					; PR_JoinThreadPool:loc_1000FE8Fp
		test	esi, esi
		jz	locret_1000F89F
		mov	eax, [esi+78h]
		test	eax, eax
		jz	short loc_1000F818
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_1000F818:				; CODE XREF: sub_1000F800+Dj
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_1000F828
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_1000F828:				; CODE XREF: sub_1000F800+1Dj
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_1000F838
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4

loc_1000F838:				; CODE XREF: sub_1000F800+2Dj
		mov	eax, [esi+74h]
		test	eax, eax
		jz	short loc_1000F848
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4

loc_1000F848:				; CODE XREF: sub_1000F800+3Dj
		mov	eax, [esi+64h]
		test	eax, eax
		jz	short loc_1000F858
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4

loc_1000F858:				; CODE XREF: sub_1000F800+4Dj
		mov	eax, [esi+60h]
		test	eax, eax
		jz	short loc_1000F868
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4

loc_1000F868:				; CODE XREF: sub_1000F800+5Dj
		mov	eax, [esi+44h]
		test	eax, eax
		jz	short loc_1000F878
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4

loc_1000F878:				; CODE XREF: sub_1000F800+6Dj
		mov	eax, [esi+38h]
		test	eax, eax
		jz	short loc_1000F888
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_1000F888:				; CODE XREF: sub_1000F800+7Dj
		mov	eax, [esi+4Ch]
		test	eax, eax
		jz	short loc_1000F898
		push	eax
		call	PR_DestroyPollableEvent
		add	esp, 4

loc_1000F898:				; CODE XREF: sub_1000F800+8Dj
		push	esi		; Memory
		call	PR_Free
		pop	ecx

locret_1000F89F:			; CODE XREF: sub_1000F800+2j
		retn
sub_1000F800	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F8A0	proc near		; CODE XREF: PR_CreateThreadPool+4p
		push	esi
		push	80h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000F925
		call	PR_NewLock
		mov	[esi+20h], eax
		test	eax, eax
		jz	short loc_1000F925
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+24h], eax
		test	eax, eax
		jz	short loc_1000F925
		call	PR_NewLock
		mov	[esi+74h], eax
		test	eax, eax
		jz	short loc_1000F925
		call	PR_NewLock
		mov	[esi+44h], eax
		test	eax, eax
		jz	short loc_1000F925
		call	PR_NewLock
		mov	[esi+60h], eax
		test	eax, eax
		jz	short loc_1000F925
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+64h], eax
		test	eax, eax
		jz	short loc_1000F925
		mov	eax, [esi+20h]
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+78h], eax
		test	eax, eax
		jz	short loc_1000F925
		call	PR_NewPollableEvent
		mov	[esi+4Ch], eax
		test	eax, eax
		jnz	short loc_1000F93D

loc_1000F925:				; CODE XREF: sub_1000F8A0+14j
					; sub_1000F8A0+20j ...
		call	sub_1000F800
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F93D:				; CODE XREF: sub_1000F8A0+83j
		mov	eax, esi
		pop	esi
		retn
sub_1000F8A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F950	proc near		; CODE XREF: PR_CancelJob:loc_1000FA69p
					; sub_10010770:loc_100108A4p
		test	esi, esi
		jz	short locret_1000F989
		mov	eax, [esi+18h]
		test	eax, eax
		jz	short loc_1000F96B
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	dword ptr [esi+18h], 0

loc_1000F96B:				; CODE XREF: sub_1000F950+9j
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_1000F982
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	dword ptr [esi+20h], 0

loc_1000F982:				; CODE XREF: sub_1000F950+20j
		push	esi		; Memory
		call	PR_Free
		pop	ecx

locret_1000F989:			; CODE XREF: sub_1000F950+2j
		retn
sub_1000F950	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000F990	proc near		; CODE XREF: PR_QueueJob+Cp
					; sub_10010770+Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	44h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1000F9E8
		cmp	[esp+4+arg_0], 0
		jz	short loc_1000F9FB
		mov	eax, [esp+4+arg_4]
		mov	ecx, [eax+74h]
		push	ecx
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+18h], eax
		mov	dword ptr [esi+1Ch], 1
		test	eax, eax
		jnz	short loc_1000FA02
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_1000F9DF
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	dword ptr [esi+20h], 0

loc_1000F9DF:				; CODE XREF: sub_1000F990+3Dj
		push	esi		; Memory
		call	PR_Free
		add	esp, 4

loc_1000F9E8:				; CODE XREF: sub_1000F990+11j
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F9FB:				; CODE XREF: sub_1000F990+18j
		mov	dword ptr [esi+18h], 0

loc_1000FA02:				; CODE XREF: sub_1000F990+36j
		mov	eax, esi
		pop	esi
		retn
sub_1000F990	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  43. PR_CancelJob

; =============== S U B	R O U T	I N E =======================================


		public PR_CancelJob
PR_CancelJob	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		or	ebx, 0FFFFFFFFh
		cmp	dword ptr [esi+0Ch], 0
		push	edi
		jz	loc_1000FACA
		mov	edi, [esi+28h]
		mov	eax, [edi+60h]
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	dword ptr [esi+0Ch], 0
		jz	short loc_1000FAA9
		mov	ecx, [esi+4]
		mov	edx, [esi]
		mov	dword ptr [esi+0Ch], 0
		mov	[ecx], edx
		mov	eax, [esi]
		mov	ecx, [esi+4]
		mov	[eax+4], ecx
		mov	[esi], esi
		mov	[esi+4], esi
		mov	edx, [edi+60h]
		dec	dword ptr [edi+68h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	dword ptr [esi+18h], 0
		jnz	short loc_1000FA76

loc_1000FA69:				; CODE XREF: PR_CancelJob+156j
		call	sub_1000F950
		pop	edi
		xor	ebx, ebx
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000FA76:				; CODE XREF: PR_CancelJob+57j
		mov	eax, [esi+28h]
		mov	ecx, [eax+74h]
		push	ecx
		call	PR_Lock
		mov	edx, [esi+18h]
		push	edx
		mov	dword ptr [esi+1Ch], 0
		call	PR_NotifyCondVar
		mov	eax, [esi+28h]
		mov	ecx, [eax+74h]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 0Ch
		pop	edi
		xor	ebx, ebx
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000FAA9:				; CODE XREF: PR_CancelJob+27j
		mov	edx, [edi+60h]
		push	edx		; lpTlsValue

loc_1000FAAD:				; CODE XREF: PR_CancelJob+D7j
		call	PR_Unlock
		add	esp, 4

loc_1000FAB5:				; CODE XREF: PR_CancelJob+BEj
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000FACA:				; CODE XREF: PR_CancelJob+Ej
		cmp	dword ptr [esi+8], 0
		jz	short loc_1000FAB5
		mov	edi, [esi+28h]
		mov	eax, [edi+44h]
		push	eax
		call	PR_Lock
		mov	ecx, [edi+44h]
		add	esp, 4
		cmp	dword ptr [esi+8], 0
		push	ecx
		jz	short loc_1000FAAD
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+20h], eax
		test	eax, eax
		jnz	short loc_1000FB17
		mov	edx, [edi+44h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		push	0
		push	0FFFFE8AAh
		call	PR_SetError
		add	esp, 0Ch
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1000FB17:				; CODE XREF: PR_CancelJob+E6j
		mov	dword ptr [esi+24h], 1
		mov	eax, [edi+44h]
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	ecx, [edi+4Ch]
		push	ecx
		call	PR_SetPollableEvent
		mov	edx, [edi+44h]
		push	edx
		call	PR_Lock
		add	esp, 0Ch
		cmp	dword ptr [esi+24h], 0
		jz	short loc_1000FB56

loc_1000FB42:				; CODE XREF: PR_CancelJob+144j
		mov	eax, [esi+20h]
		push	0FFFFFFFFh
		push	eax
		call	PR_WaitCondVar
		add	esp, 8
		cmp	dword ptr [esi+24h], 0
		jnz	short loc_1000FB42

loc_1000FB56:				; CODE XREF: PR_CancelJob+130j
		mov	ecx, [edi+44h]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	dword ptr [esi+18h], 0
		jz	loc_1000FA69
		mov	edx, [esi+28h]
		mov	eax, [edx+74h]
		push	eax
		call	PR_Lock
		mov	ecx, [esi+18h]
		push	ecx
		mov	dword ptr [esi+1Ch], 0
		call	PR_NotifyCondVar
		mov	edx, [esi+28h]
		mov	eax, [edx+74h]
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 0Ch
		pop	edi
		xor	ebx, ebx
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
PR_CancelJob	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 224. PR_JoinJob

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_JoinJob(void *Memory)
		public PR_JoinJob
PR_JoinJob	proc near		; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		cmp	dword ptr [esi+18h], 0
		jnz	short loc_1000FBBF
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000FBBF:				; CODE XREF: PR_JoinJob+9j
		mov	eax, [esi+28h]
		mov	ecx, [eax+74h]
		push	ecx
		call	PR_Lock
		add	esp, 4
		cmp	dword ptr [esi+1Ch], 0
		jz	short loc_1000FBE8

loc_1000FBD4:				; CODE XREF: PR_JoinJob+46j
		mov	edx, [esi+18h]
		push	0FFFFFFFFh
		push	edx
		call	PR_WaitCondVar
		add	esp, 8
		cmp	dword ptr [esi+1Ch], 0
		jnz	short loc_1000FBD4

loc_1000FBE8:				; CODE XREF: PR_JoinJob+32j
		mov	eax, [esi+28h]
		mov	ecx, [eax+74h]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		mov	eax, [esi+18h]
		add	esp, 4
		test	eax, eax
		jz	short loc_1000FC0E
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	dword ptr [esi+18h], 0

loc_1000FC0E:				; CODE XREF: PR_JoinJob+5Cj
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_1000FC25
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	dword ptr [esi+20h], 0

loc_1000FC25:				; CODE XREF: PR_JoinJob+73j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
PR_JoinJob	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 345. PR_ShutdownThreadPool

; =============== S U B	R O U T	I N E =======================================


		public PR_ShutdownThreadPool
PR_ShutdownThreadPool proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+20h]
		push	eax
		call	PR_Lock
		mov	ecx, [esi+78h]
		push	ecx
		mov	dword ptr [esi+7Ch], 1
		call	PR_NotifyAllCondVar
		mov	edx, [esi+20h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		retn
PR_ShutdownThreadPool endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 226. PR_JoinThreadPool

; =============== S U B	R O U T	I N E =======================================


		public PR_JoinThreadPool
PR_JoinThreadPool proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi+20h]
		push	edi
		push	eax
		call	PR_Lock
		xor	ebp, ebp
		add	esp, 4
		cmp	[esi+7Ch], ebp
		jnz	short loc_1000FCA3
		jmp	short loc_1000FC90
; ---------------------------------------------------------------------------
		align 10h

loc_1000FC90:				; CODE XREF: PR_JoinThreadPool+1Bj
					; PR_JoinThreadPool+31j
		mov	ecx, [esi+78h]
		push	0FFFFFFFFh
		push	ecx
		call	PR_WaitCondVar
		add	esp, 8
		cmp	[esi+7Ch], ebp
		jz	short loc_1000FC90

loc_1000FCA3:				; CODE XREF: PR_JoinThreadPool+19j
		mov	edx, [esi+24h]
		push	edx
		call	PR_NotifyAllCondVar
		mov	eax, [esi+4Ch]
		push	eax
		call	PR_SetPollableEvent
		mov	ecx, [esi+60h]
		push	ecx
		call	PR_Lock
		mov	edx, [esi+64h]
		push	edx
		call	PR_NotifyCondVar
		mov	eax, [esi+60h]
		push	eax		; lpTlsValue
		call	PR_Unlock
		lea	ebx, [esi+28h]
		add	esp, 14h
		cmp	[ebx], ebx
		jz	short loc_1000FD1E
		lea	ebx, [ebx+0]

loc_1000FCE0:				; CODE XREF: PR_JoinThreadPool+ACj
		mov	edi, [ebx]
		mov	ecx, [edi+4]
		mov	edx, [edi]
		mov	[ecx], edx
		mov	eax, [edi]
		mov	ecx, [edi+4]
		mov	[eax+4], ecx
		mov	[edi], edi
		mov	[edi+4], edi
		mov	edx, [esi+20h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		mov	eax, [edi+8]
		push	eax
		call	PR_JoinThread
		push	edi		; Memory
		call	PR_Free
		mov	ecx, [esi+20h]
		push	ecx
		call	PR_Lock
		add	esp, 10h
		cmp	[ebx], ebx
		jnz	short loc_1000FCE0

loc_1000FD1E:				; CODE XREF: PR_JoinThreadPool+68j
		mov	edx, [esi+20h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		lea	ebx, [esi+50h]
		add	esp, 4
		cmp	[ebx], ebx
		jz	short loc_1000FD5D

loc_1000FD31:				; CODE XREF: PR_JoinThreadPool+EBj
		mov	edi, [ebx]
		mov	eax, [edi+4]
		mov	ecx, [edi]
		mov	[eax], ecx
		mov	edx, [edi]
		mov	eax, [edi+4]
		mov	[edx+4], eax
		mov	ecx, [edi+8]
		push	ecx
		mov	[edi], edi
		mov	[edi+4], edi
		call	PR_JoinThread
		push	edi		; Memory
		call	PR_Free
		add	esp, 8
		cmp	[ebx], ebx
		jnz	short loc_1000FD31

loc_1000FD5D:				; CODE XREF: PR_JoinThreadPool+BFj
		lea	ebx, [esi+6Ch]
		cmp	[ebx], ebx
		jz	short loc_1000FD90

loc_1000FD64:				; CODE XREF: PR_JoinThreadPool+11Ej
		mov	edi, [ebx]
		mov	edx, [edi+4]
		mov	eax, [edi]
		mov	[edx], eax
		mov	ecx, [edi]
		mov	edx, [edi+4]
		mov	[ecx+4], edx
		mov	eax, [edi+8]
		push	eax
		mov	[edi], edi
		mov	[edi+4], edi
		call	PR_JoinThread
		push	edi		; Memory
		call	PR_Free
		add	esp, 8
		cmp	[ebx], ebx
		jnz	short loc_1000FD64

loc_1000FD90:				; CODE XREF: PR_JoinThreadPool+F2j
		lea	ebx, [esi+14h]
		cmp	[ebx], ebx
		jz	short loc_1000FDE3

loc_1000FD97:				; CODE XREF: PR_JoinThreadPool+171j
		mov	edi, [ebx]
		mov	ecx, [edi+4]
		mov	edx, [edi]
		mov	[ecx], edx
		mov	eax, [edi]
		mov	ecx, [edi+4]
		mov	[eax+4], ecx
		mov	[edi], edi
		mov	[edi+4], edi
		dec	dword ptr [esi+1Ch]
		mov	eax, [edi+18h]
		cmp	eax, ebp
		jz	short loc_1000FDC3
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[edi+18h], ebp

loc_1000FDC3:				; CODE XREF: PR_JoinThreadPool+145j
		mov	eax, [edi+20h]
		cmp	eax, ebp
		jz	short loc_1000FDD6
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[edi+20h], ebp

loc_1000FDD6:				; CODE XREF: PR_JoinThreadPool+158j
		push	edi		; Memory
		call	PR_Free
		add	esp, 4
		cmp	[ebx], ebx
		jnz	short loc_1000FD97

loc_1000FDE3:				; CODE XREF: PR_JoinThreadPool+125j
		lea	ebx, [esi+30h]
		cmp	[ebx], ebx
		jz	short loc_1000FE3C
		lea	ebx, [ebx+0]

loc_1000FDF0:				; CODE XREF: PR_JoinThreadPool+1CAj
		mov	edi, [ebx]
		mov	edx, [edi+4]
		mov	eax, [edi]
		mov	[edx], eax
		mov	ecx, [edi]
		mov	edx, [edi+4]
		mov	[ecx+4], edx
		mov	[edi], edi
		mov	[edi+4], edi
		dec	dword ptr [esi+48h]
		mov	eax, [edi+18h]
		cmp	eax, ebp
		jz	short loc_1000FE1C
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[edi+18h], ebp

loc_1000FE1C:				; CODE XREF: PR_JoinThreadPool+19Ej
		mov	eax, [edi+20h]
		cmp	eax, ebp
		jz	short loc_1000FE2F
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[edi+20h], ebp

loc_1000FE2F:				; CODE XREF: PR_JoinThreadPool+1B1j
		push	edi		; Memory
		call	PR_Free
		add	esp, 4
		cmp	[ebx], ebx
		jnz	short loc_1000FDF0

loc_1000FE3C:				; CODE XREF: PR_JoinThreadPool+178j
		lea	ebx, [esi+58h]
		cmp	[ebx], ebx
		jz	short loc_1000FE8F

loc_1000FE43:				; CODE XREF: PR_JoinThreadPool+21Dj
		mov	edi, [ebx]
		mov	eax, [edi+4]
		mov	ecx, [edi]
		mov	[eax], ecx
		mov	eax, [edi+4]
		mov	edx, [edi]
		mov	[edx+4], eax
		mov	[edi], edi
		mov	[edi+4], edi
		dec	dword ptr [esi+68h]
		mov	eax, [edi+18h]
		cmp	eax, ebp
		jz	short loc_1000FE6F
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[edi+18h], ebp

loc_1000FE6F:				; CODE XREF: PR_JoinThreadPool+1F1j
		mov	eax, [edi+20h]
		cmp	eax, ebp
		jz	short loc_1000FE82
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[edi+20h], ebp

loc_1000FE82:				; CODE XREF: PR_JoinThreadPool+204j
		push	edi		; Memory
		call	PR_Free
		add	esp, 4
		cmp	[ebx], ebx
		jnz	short loc_1000FE43

loc_1000FE8F:				; CODE XREF: PR_JoinThreadPool+1D1j
		call	sub_1000F800
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
PR_JoinThreadPool endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000FEA0	proc near		; DATA XREF: sub_1000FFC0+5Fo
					; sub_10010460+EEo ...

lpTlsValue	= dword	ptr  4

		push	ebp
		push	edi
		mov	edi, [esp+8+lpTlsValue]
		or	ebp, 0FFFFFFFFh
		cmp	dword ptr [edi+7Ch], 0
		jnz	loc_1000FF96
		push	ebx
		lea	ebx, [edi+14h]
		push	esi
		jmp	short loc_1000FEC0
; ---------------------------------------------------------------------------
		align 10h

loc_1000FEC0:				; CODE XREF: sub_1000FEA0+18j
					; sub_1000FEA0+E0j
		mov	eax, [edi+20h]
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	[ebx], ebx
		jnz	short loc_1000FEF1

loc_1000FED0:				; CODE XREF: sub_1000FEA0+4Fj
		cmp	dword ptr [edi+7Ch], 0
		jnz	loc_1000FF88
		mov	ecx, [edi+24h]
		inc	dword ptr [edi+0Ch]
		push	ebp
		push	ecx
		call	PR_WaitCondVar
		add	[edi+0Ch], ebp
		add	esp, 8
		cmp	[ebx], ebx
		jz	short loc_1000FED0

loc_1000FEF1:				; CODE XREF: sub_1000FEA0+2Ej
		cmp	dword ptr [edi+7Ch], 0
		jnz	loc_1000FF88
		mov	esi, [ebx]
		mov	edx, [esi+4]
		mov	eax, [esi]
		mov	[edx], eax
		mov	ecx, [esi]
		mov	edx, [esi+4]
		mov	[ecx+4], edx
		mov	[esi], esi
		mov	[esi+4], esi
		mov	eax, [edi+20h]
		add	[edi+1Ch], ebp
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	ecx, [esi+14h]
		mov	edx, [esi+10h]
		push	ecx
		call	edx
		add	esp, 8
		cmp	dword ptr [esi+18h], 0
		jnz	short loc_1000FF51
		mov	eax, [esi+20h]
		test	eax, eax
		jz	short loc_1000FF46
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	dword ptr [esi+20h], 0

loc_1000FF46:				; CODE XREF: sub_1000FEA0+94j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		jmp	short loc_1000FF7C
; ---------------------------------------------------------------------------

loc_1000FF51:				; CODE XREF: sub_1000FEA0+8Dj
		mov	eax, [esi+28h]
		mov	ecx, [eax+74h]
		push	ecx
		call	PR_Lock
		mov	edx, [esi+18h]
		push	edx
		mov	dword ptr [esi+1Ch], 0
		call	PR_NotifyCondVar
		mov	eax, [esi+28h]
		mov	ecx, [eax+74h]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 0Ch

loc_1000FF7C:				; CODE XREF: sub_1000FEA0+AFj
		cmp	dword ptr [edi+7Ch], 0
		jz	loc_1000FEC0
		jmp	short loc_1000FF94
; ---------------------------------------------------------------------------

loc_1000FF88:				; CODE XREF: sub_1000FEA0+34j
					; sub_1000FEA0+55j
		mov	edx, [edi+20h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_1000FF94:				; CODE XREF: sub_1000FEA0+E6j
		pop	esi
		pop	ebx

loc_1000FF96:				; CODE XREF: sub_1000FEA0+Dj
		mov	eax, [edi+20h]
		push	eax
		call	PR_Lock
		mov	ecx, [edi+20h]
		add	esp, 4
		add	[edi+8], ebp
		pop	edi
		pop	ebp
		mov	[esp+lpTlsValue], ecx ;	lpTlsValue
		jmp	PR_Unlock
sub_1000FEA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1000FFC0	proc near		; CODE XREF: sub_10010080+2FCp
					; sub_10010080+3ADp ...
		push	edi
		mov	edi, eax
		mov	eax, [esi+20h]
		push	eax
		call	PR_Lock
		lea	ecx, [esi+14h]
		mov	[edi], ecx
		mov	edx, [esi+18h]
		mov	[edi+4], edx
		mov	eax, [esi+18h]
		mov	[eax], edi
		inc	dword ptr [esi+1Ch]
		mov	eax, [esi+1Ch]
		add	esp, 4
		mov	[esi+18h], edi
		cmp	[esi+0Ch], eax
		jge	short loc_10010068
		mov	eax, [esi+8]
		cmp	eax, [esi+4]
		jge	short loc_10010068
		mov	ecx, [esi+20h]
		inc	eax
		push	ecx		; lpTlsValue
		mov	[esi+8], eax
		call	PR_Unlock
		push	0Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jz	short loc_10010040
		mov	edx, [esi+10h]
		push	edx
		push	0
		push	1
		push	1
		push	esi
		push	offset sub_1000FEA0
		push	0
		call	PR_CreateThread
		add	esp, 1Ch
		mov	[edi+8], eax
		test	eax, eax
		jnz	short loc_10010040
		push	edi		; Memory
		call	PR_Free
		add	esp, 4
		xor	edi, edi

loc_10010040:				; CODE XREF: sub_1000FFC0+52j
					; sub_1000FFC0+73j
		mov	eax, [esi+20h]
		push	eax
		call	PR_Lock
		add	esp, 4
		test	edi, edi
		jnz	short loc_10010055
		dec	dword ptr [esi+8]
		jmp	short loc_10010068
; ---------------------------------------------------------------------------

loc_10010055:				; CODE XREF: sub_1000FFC0+8Ej
		lea	ecx, [esi+28h]
		mov	[edi], ecx
		mov	edx, [esi+2Ch]
		mov	[edi+4], edx
		mov	eax, [esi+2Ch]
		mov	[eax], edi
		mov	[esi+2Ch], edi

loc_10010068:				; CODE XREF: sub_1000FFC0+2Bj
					; sub_1000FFC0+33j ...
		mov	ecx, [esi+24h]
		push	ecx
		call	PR_NotifyCondVar
		mov	edx, [esi+20h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		pop	edi
		retn
sub_1000FFC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010080	proc near		; DATA XREF: PR_CreateThreadPool+CDo

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 10h
		push	esi
		mov	esi, [esp+14h+arg_0]
		cmp	dword ptr [esi+7Ch], 0
		jnz	loc_10010451
		push	ebx
		push	ebp
		push	edi

loc_10010095:				; CODE XREF: sub_10010080+3C8j
		mov	edi, [esi+48h]
		add	edi, 0Ah
		mov	[esp+20h+var_4], edi
		cmp	edi, [esi+3Ch]
		jle	short loc_100100DC
		mov	eax, [esi+38h]
		test	eax, eax
		jz	short loc_100100B4
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_100100B4:				; CODE XREF: sub_10010080+29j
		lea	eax, [edi+edi*2]
		add	eax, eax
		add	eax, eax
		push	eax		; Size
		call	PR_Malloc
		mov	ebx, eax
		mov	[esi+38h], eax
		lea	eax, [eax+edi*8]
		add	esp, 4
		mov	[esp+20h+var_8], ebx
		mov	[esi+40h], eax
		mov	[esp+20h+arg_0], eax
		mov	[esi+3Ch], edi
		jmp	short loc_100100E0
; ---------------------------------------------------------------------------

loc_100100DC:				; CODE XREF: sub_10010080+22j
		mov	ebx, [esp+20h+var_8]

loc_100100E0:				; CODE XREF: sub_10010080+5Aj
		mov	ecx, [esi+4Ch]
		mov	[ebx], ecx
		mov	ecx, [esp+20h+arg_0]
		mov	dword ptr [ebx+4], 1
		mov	dword ptr [ecx], 0
		mov	edx, [esi+44h]
		mov	ebp, 1
		push	edx
		mov	[esp+24h+var_C], ebp
		call	PR_Lock
		mov	eax, [esi+30h]
		lea	ecx, [esi+30h]
		add	esp, 4
		cmp	eax, ecx
		jz	short loc_10010181
		lea	edi, [ebx+0Eh]

loc_10010118:				; CODE XREF: sub_10010080+F7j
		mov	ebx, [eax]
		xor	ecx, ecx
		cmp	[eax+24h], ecx
		jz	short loc_1001014A
		mov	[eax+24h], ecx
		mov	[eax+8], ecx
		mov	ecx, [eax+4]
		mov	[ecx], ebx
		mov	edx, [eax]
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		mov	[eax], eax
		mov	[eax+4], eax
		dec	dword ptr [esi+48h]
		mov	edx, [eax+20h]
		push	edx
		call	PR_NotifyCondVar
		add	esp, 4
		jmp	short loc_10010170
; ---------------------------------------------------------------------------

loc_1001014A:				; CODE XREF: sub_10010080+9Fj
		cmp	ebp, [esp+20h+var_4]
		jz	short loc_10010179
		mov	ecx, [eax+2Ch]
		mov	edx, [ecx]
		mov	[edi-6], edx
		mov	cx, [eax+34h]
		mov	[edi-2], cx
		mov	ecx, [esp+20h+arg_0]
		xor	edx, edx
		mov	[edi], dx
		mov	[ecx+ebp*4], eax
		inc	ebp
		add	edi, 8

loc_10010170:				; CODE XREF: sub_10010080+C8j
		lea	ecx, [esi+30h]
		mov	eax, ebx
		cmp	ebx, ecx
		jnz	short loc_10010118

loc_10010179:				; CODE XREF: sub_10010080+CEj
		mov	ebx, [esp+20h+var_8]
		mov	[esp+20h+var_C], ebp

loc_10010181:				; CODE XREF: sub_10010080+93j
		mov	edi, [esi+30h]
		lea	eax, [esi+30h]
		cmp	edi, eax
		jz	short loc_100101AD
		mov	eax, [edi+3Ch]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100101AD
		test	eax, eax
		jnz	short loc_1001019B
		xor	edi, edi
		jmp	short loc_100101B0
; ---------------------------------------------------------------------------

loc_1001019B:				; CODE XREF: sub_10010080+115j
		call	PR_IntervalNow
		mov	edi, [edi+40h]
		sub	edi, eax
		test	edi, edi
		jg	short loc_100101B0
		xor	edi, edi
		jmp	short loc_100101B0
; ---------------------------------------------------------------------------

loc_100101AD:				; CODE XREF: sub_10010080+109j
					; sub_10010080+111j
		or	edi, 0FFFFFFFFh

loc_100101B0:				; CODE XREF: sub_10010080+119j
					; sub_10010080+127j ...
		mov	edx, [esi+44h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		mov	eax, [esi+38h]
		push	edi
		push	ebp
		push	eax
		call	PR_Poll
		add	esp, 10h
		cmp	dword ptr [esi+7Ch], 0
		jnz	loc_1001044E
		test	eax, eax
		jle	loc_1001039F
		test	byte ptr [ebx+6], 1
		jz	short loc_100101EB
		mov	ecx, [esi+4Ch]
		push	ecx
		call	PR_WaitForPollableEvent
		add	esp, 4

loc_100101EB:				; CODE XREF: sub_10010080+15Dj
		mov	eax, 1
		mov	[esp+20h+var_4], eax
		cmp	ebp, eax
		jle	loc_1001039F
		lea	ecx, [ebx+0Ch]
		mov	[esp+20h+var_10], ecx

loc_10010203:				; CODE XREF: sub_10010080+319j
		movzx	ebx, word ptr [ecx+2]
		mov	edx, [esp+20h+arg_0]
		mov	edi, [edx+eax*4]
		mov	ebp, ebx
		and	ebp, 10h
		jnz	loc_100102E4
		test	bl, 8
		jnz	loc_100102E4
		test	byte ptr [ecx],	2
		jz	short loc_10010230
		test	bl, 20h
		jnz	loc_100102E4

loc_10010230:				; CODE XREF: sub_10010080+1A5j
		xor	ebp, ebp
		cmp	bx, bp
		jz	loc_10010381
		mov	eax, [esi+44h]
		push	eax
		call	PR_Lock
		mov	ecx, [edi+4]
		mov	edx, [edi]
		add	esp, 4
		cmp	[edi+24h], ebp
		jz	short loc_10010283
		mov	[edi+24h], ebp
		mov	[edi+8], ebp
		mov	[ecx], edx
		mov	eax, [edi]
		mov	ecx, [edi+4]
		mov	[eax+4], ecx
		mov	[edi], edi
		mov	[edi+4], edi
		dec	dword ptr [esi+48h]
		mov	edx, [edi+20h]
		push	edx
		call	PR_NotifyCondVar
		mov	eax, [esi+44h]
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		jmp	loc_10010381
; ---------------------------------------------------------------------------

loc_10010283:				; CODE XREF: sub_10010080+1CFj
		mov	[ecx], edx
		mov	eax, [edi]
		mov	ecx, [edi+4]
		mov	[eax+4], ecx
		mov	[edi], edi
		mov	[edi+4], edi
		dec	dword ptr [esi+48h]
		mov	[edi+8], ebp
		mov	edx, [esi+44h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	dword ptr [edi+30h], 2
		jnz	short loc_100102D9
		mov	eax, [esp+20h+var_10]
		add	eax, 0FFFFFFFCh
		push	eax
		call	PR_GetConnectStatus
		add	esp, 4
		test	eax, eax
		jnz	short loc_100102C9
		mov	ecx, [edi+2Ch]
		mov	[ecx+4], ebp
		jmp	loc_1001037A
; ---------------------------------------------------------------------------

loc_100102C9:				; CODE XREF: sub_10010080+23Cj
		call	PR_GetError
		mov	edx, [edi+2Ch]
		mov	[edx+4], eax
		jmp	loc_1001037A
; ---------------------------------------------------------------------------

loc_100102D9:				; CODE XREF: sub_10010080+228j
		mov	eax, [edi+2Ch]
		mov	[eax+4], ebp
		jmp	loc_1001037A
; ---------------------------------------------------------------------------

loc_100102E4:				; CODE XREF: sub_10010080+193j
					; sub_10010080+19Cj ...
		mov	ecx, [esi+44h]
		push	ecx
		call	PR_Lock
		mov	edx, [edi+4]
		xor	eax, eax
		add	esp, 4
		cmp	[edi+24h], eax
		jz	short loc_1001032B
		mov	[edi+24h], eax
		mov	[edi+8], eax
		mov	eax, [edi]
		mov	[edx], eax
		mov	ecx, [edi]
		mov	edx, [edi+4]
		mov	[ecx+4], edx
		mov	[edi], edi
		mov	[edi+4], edi
		dec	dword ptr [esi+48h]
		mov	eax, [edi+20h]
		push	eax
		call	PR_NotifyCondVar
		mov	ecx, [esi+44h]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		jmp	short loc_10010381
; ---------------------------------------------------------------------------

loc_1001032B:				; CODE XREF: sub_10010080+278j
		mov	ecx, [edi]
		mov	[edx], ecx
		mov	edx, [edi]
		mov	ecx, [edi+4]
		mov	[edx+4], ecx
		mov	[edi], edi
		mov	[edi+4], edi
		dec	dword ptr [esi+48h]
		mov	[edi+8], eax
		mov	edx, [esi+44h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	bp, bp
		jz	short loc_1001035F
		mov	eax, [edi+2Ch]
		mov	dword ptr [eax+4], 0FFFFE891h
		jmp	short loc_1001037A
; ---------------------------------------------------------------------------

loc_1001035F:				; CODE XREF: sub_10010080+2D1j
		test	bl, 20h
		jz	short loc_10010370
		mov	ecx, [edi+2Ch]
		mov	dword ptr [ecx+4], 0FFFFE8B7h
		jmp	short loc_1001037A
; ---------------------------------------------------------------------------

loc_10010370:				; CODE XREF: sub_10010080+2E2j
		mov	edx, [edi+2Ch]
		mov	dword ptr [edx+4], 0FFFFE899h

loc_1001037A:				; CODE XREF: sub_10010080+244j
					; sub_10010080+254j ...
		mov	eax, edi
		call	sub_1000FFC0

loc_10010381:				; CODE XREF: sub_10010080+1B5j
					; sub_10010080+1FEj ...
		mov	eax, [esp+20h+var_4]
		mov	ecx, [esp+20h+var_10]
		inc	eax
		add	ecx, 8
		mov	[esp+20h+var_4], eax
		mov	[esp+20h+var_10], ecx
		cmp	eax, [esp+20h+var_C]
		jl	loc_10010203

loc_1001039F:				; CODE XREF: sub_10010080+153j
					; sub_10010080+176j
		call	PR_IntervalNow
		mov	ebp, eax
		mov	eax, [esi+44h]
		push	eax
		call	PR_Lock
		mov	eax, [esi+30h]
		lea	ebx, [esi+30h]
		add	esp, 4
		cmp	eax, ebx
		jz	short loc_10010438
		lea	esp, [esp+0]

loc_100103C0:				; CODE XREF: sub_10010080+3B6j
		mov	edi, [eax]
		xor	ecx, ecx
		cmp	[eax+24h], ecx
		jz	short loc_100103F2
		mov	[eax+24h], ecx
		mov	[eax+8], ecx
		mov	ecx, [eax+4]
		mov	[ecx], edi
		mov	edx, [eax]
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		mov	[eax], eax
		mov	[eax+4], eax
		dec	dword ptr [esi+48h]
		mov	edx, [eax+20h]
		push	edx
		call	PR_NotifyCondVar
		add	esp, 4
		jmp	short loc_10010432
; ---------------------------------------------------------------------------

loc_100103F2:				; CODE XREF: sub_10010080+347j
		mov	ecx, [eax+3Ch]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10010438
		test	ecx, ecx
		jz	short loc_10010407
		mov	ecx, [eax+40h]
		sub	ecx, ebp
		test	ecx, ecx
		jg	short loc_10010438

loc_10010407:				; CODE XREF: sub_10010080+37Cj
		mov	edx, [eax+4]
		mov	[edx], edi
		mov	ecx, [eax]
		mov	edx, [eax+4]
		mov	[ecx+4], edx
		mov	[eax], eax
		mov	[eax+4], eax
		dec	dword ptr [esi+48h]
		mov	ecx, [eax+2Ch]
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ecx+4], 0FFFFE89Ah
		call	sub_1000FFC0

loc_10010432:				; CODE XREF: sub_10010080+370j
		mov	eax, edi
		cmp	edi, ebx
		jnz	short loc_100103C0

loc_10010438:				; CODE XREF: sub_10010080+33Aj
					; sub_10010080+378j ...
		mov	edx, [esi+44h]
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	dword ptr [esi+7Ch], 0
		jz	loc_10010095

loc_1001044E:				; CODE XREF: sub_10010080+14Bj
		pop	edi
		pop	ebp
		pop	ebx

loc_10010451:				; CODE XREF: sub_10010080+Cj
		pop	esi
		add	esp, 10h
		retn
sub_10010080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010460	proc near		; DATA XREF: PR_CreateThreadPool+FDo

lpTlsValue	= dword	ptr  4

		push	ebp
		push	esi
		mov	esi, [esp+8+lpTlsValue]
		xor	ebp, ebp
		cmp	[esi+7Ch], ebp
		jnz	loc_100105CA
		push	ebx
		lea	ebx, [esi+58h]
		push	edi

loc_10010476:				; CODE XREF: sub_10010460+162j
		mov	eax, [esi+60h]
		push	eax
		call	PR_Lock
		mov	edi, [ebx]
		add	esp, 4
		cmp	edi, ebx
		jnz	short loc_1001048D
		or	ecx, 0FFFFFFFFh
		jmp	short loc_1001049D
; ---------------------------------------------------------------------------

loc_1001048D:				; CODE XREF: sub_10010460+26j
		call	PR_IntervalNow
		mov	ecx, [edi+40h]
		sub	ecx, eax
		jz	short loc_100104AA
		cmp	ecx, ebp
		jz	short loc_100104AA

loc_1001049D:				; CODE XREF: sub_10010460+2Bj
		push	ecx
		mov	ecx, [esi+64h]
		push	ecx
		call	PR_WaitCondVar
		add	esp, 8

loc_100104AA:				; CODE XREF: sub_10010460+37j
					; sub_10010460+3Bj
		cmp	[esi+7Ch], ebp
		jnz	loc_100105CD
		call	PR_IntervalNow
		mov	[esp+10h+lpTlsValue], eax
		cmp	[ebx], ebx
		jz	loc_100105B3

loc_100104C4:				; CODE XREF: sub_10010460+14Dj
		mov	edi, [ebx]
		mov	edx, [edi+40h]
		sub	edx, [esp+10h+lpTlsValue]
		test	edx, edx
		jg	loc_100105B3
		mov	eax, [edi+4]
		mov	ecx, [edi]
		mov	[eax], ecx
		mov	edx, [edi]
		mov	eax, [edi+4]
		mov	[edx+4], eax
		mov	[edi], edi
		mov	[edi+4], edi
		dec	dword ptr [esi+68h]
		mov	[edi+0Ch], ebp
		mov	ecx, [esi+20h]
		push	ecx
		call	PR_Lock
		lea	edx, [esi+14h]
		mov	[edi], edx
		mov	eax, [esi+18h]
		mov	[edi+4], eax
		mov	ecx, [esi+18h]
		mov	[ecx], edi
		inc	dword ptr [esi+1Ch]
		mov	eax, [esi+1Ch]
		add	esp, 4
		mov	[esi+18h], edi
		cmp	[esi+0Ch], eax
		jge	loc_10010596
		mov	eax, [esi+8]
		cmp	eax, [esi+4]
		jge	short loc_10010596
		mov	edx, [esi+20h]
		inc	eax
		push	edx		; lpTlsValue
		mov	[esi+8], eax
		call	PR_Unlock
		push	0Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	edi, eax
		add	esp, 0Ch
		cmp	edi, ebp
		jz	short loc_1001056E
		mov	eax, [esi+10h]
		push	eax
		push	ebp
		push	1
		push	1
		push	esi
		push	offset sub_1000FEA0
		push	ebp
		call	PR_CreateThread
		add	esp, 1Ch
		mov	[edi+8], eax
		cmp	eax, ebp
		jnz	short loc_1001056E
		push	edi		; Memory
		call	PR_Free
		add	esp, 4
		xor	edi, edi

loc_1001056E:				; CODE XREF: sub_10010460+E2j
					; sub_10010460+101j
		mov	ecx, [esi+20h]
		push	ecx
		call	PR_Lock
		add	esp, 4
		cmp	edi, ebp
		jnz	short loc_10010583
		dec	dword ptr [esi+8]
		jmp	short loc_10010596
; ---------------------------------------------------------------------------

loc_10010583:				; CODE XREF: sub_10010460+11Cj
		lea	edx, [esi+28h]
		mov	[edi], edx
		mov	eax, [esi+2Ch]
		mov	[edi+4], eax
		mov	ecx, [esi+2Ch]
		mov	[ecx], edi
		mov	[esi+2Ch], edi

loc_10010596:				; CODE XREF: sub_10010460+B7j
					; sub_10010460+C3j ...
		mov	edx, [esi+24h]
		push	edx
		call	PR_NotifyCondVar
		mov	eax, [esi+20h]
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		cmp	[ebx], ebx
		jnz	loc_100104C4

loc_100105B3:				; CODE XREF: sub_10010460+5Ej
					; sub_10010460+6Fj
		mov	ecx, [esi+60h]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	[esi+7Ch], ebp
		jz	loc_10010476
		pop	edi
		pop	ebx

loc_100105CA:				; CODE XREF: sub_10010460+Bj
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100105CD:				; CODE XREF: sub_10010460+4Dj
		mov	edx, [esi+60h]
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		mov	[esp+lpTlsValue], edx ;	lpTlsValue
		jmp	PR_Unlock
sub_10010460	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  73. PR_CreateThreadPool

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateThreadPool
PR_CreateThreadPool proc near		; DATA XREF: .rdata:off_1002C7C8o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 8
		push	esi
		call	sub_1000F8A0
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100105F4
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100105F4:				; CODE XREF: PR_CreateThreadPool+Dj
		mov	eax, [esp+0Ch+arg_0]
		mov	edx, [esi+20h]
		mov	ecx, [esp+0Ch+arg_4]
		mov	[esi], eax
		lea	eax, [esi+14h]
		mov	[eax], eax
		mov	[esi+18h], eax
		push	ebx
		mov	ebx, [esp+10h+arg_8]
		lea	eax, [esi+30h]
		mov	[eax], eax
		mov	[esi+34h], eax
		push	ebp
		lea	eax, [esi+58h]
		push	edi
		mov	[eax], eax
		mov	[esi+5Ch], eax
		lea	eax, [esi+6Ch]
		lea	edi, [esi+28h]
		lea	ebp, [esi+50h]
		push	edx
		mov	[esi+4], ecx
		mov	[esi+10h], ebx
		mov	[edi], edi
		mov	[esi+2Ch], edi
		mov	[ebp+0], ebp
		mov	[esi+54h], ebp
		mov	[eax], eax
		mov	[esi+70h], eax
		mov	dword ptr [esi+7Ch], 0
		call	PR_Lock
		mov	eax, [esp+1Ch+arg_0]
		add	esp, 4
		test	eax, eax
		jle	short loc_100106A5
		mov	[esp+18h+var_8], eax
		jmp	short loc_10010660
; ---------------------------------------------------------------------------
		align 10h

loc_10010660:				; CODE XREF: PR_CreateThreadPool+7Bj
					; PR_CreateThreadPool+BFj
		push	ebx
		push	0
		push	1
		push	1
		push	esi
		push	offset sub_1000FEA0
		push	0
		call	PR_CreateThread
		push	0Ch		; SizeOfElements
		push	1		; NumOfElements
		mov	[esp+3Ch+var_4], eax
		call	PR_Calloc
		mov	ecx, [esp+3Ch+var_4]
		mov	[eax+8], ecx
		mov	[eax], edi
		mov	edx, [esi+2Ch]
		mov	[eax+4], edx
		mov	ecx, [esi+2Ch]
		add	esp, 24h
		dec	[esp+18h+var_8]
		mov	[ecx], eax
		mov	[esi+2Ch], eax
		jnz	short loc_10010660
		mov	eax, [esp+18h+arg_0]

loc_100106A5:				; CODE XREF: PR_CreateThreadPool+75j
		push	ebx
		push	0
		push	1
		push	1
		push	esi
		push	offset sub_10010080
		push	0
		mov	[esi+8], eax
		call	PR_CreateThread
		push	0Ch		; SizeOfElements
		push	1		; NumOfElements
		mov	edi, eax
		call	PR_Calloc
		push	ebx
		push	0
		push	1
		mov	[eax+8], edi
		mov	[eax], ebp
		mov	edx, [esi+54h]
		push	1
		mov	[eax+4], edx
		mov	ecx, [esi+54h]
		push	esi
		push	offset sub_10010460
		mov	[ecx], eax
		push	0
		mov	[esi+54h], eax
		call	PR_CreateThread
		add	esp, 40h
		push	0Ch		; SizeOfElements
		push	1		; NumOfElements
		mov	edi, eax
		call	PR_Calloc
		mov	[eax+8], edi
		lea	ecx, [esi+6Ch]
		mov	[eax], ecx
		mov	edx, [esi+70h]
		mov	[eax+4], edx
		mov	ecx, [esi+70h]
		mov	[ecx], eax
		mov	edx, [esi+20h]
		push	edx		; lpTlsValue
		mov	[esi+70h], eax
		call	PR_Unlock
		add	esp, 0Ch
		pop	edi
		pop	ebp
		pop	ebx
		mov	eax, esi
		pop	esi
		add	esp, 8
		retn
PR_CreateThreadPool endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 290. PR_QueueJob

; =============== S U B	R O U T	I N E =======================================


		public PR_QueueJob
PR_QueueJob	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	esi
		push	eax
		call	sub_1000F990
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_1001074D
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001074D:				; CODE XREF: PR_QueueJob+18j
		mov	ecx, [esp+8+arg_4]
		mov	edx, [esp+8+arg_8]
		mov	[edi+10h], ecx
		mov	[edi+14h], edx
		mov	[edi+28h], esi
		call	sub_1000FFC0
		mov	eax, edi
		pop	edi
		pop	esi
		retn
PR_QueueJob	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010770	proc near		; CODE XREF: PR_QueueJob_Read+19p
					; PR_QueueJob_Write+19p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_8]
		push	esi
		push	edi
		push	eax
		mov	ebx, ecx
		call	sub_1000F990
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_100108B8
		mov	ecx, [esp+0Ch+arg_0]
		mov	edx, [esp+0Ch+arg_4]
		mov	[esi+10h], ecx
		mov	[esi+14h], edx
		mov	[esi+28h], edi
		mov	[esi+2Ch], ebx
		test	ebp, ebp
		jnz	short loc_100107AD
		mov	[esi+30h], ebp
		lea	eax, [ebp+1]
		jmp	short loc_100107E4
; ---------------------------------------------------------------------------

loc_100107AD:				; CODE XREF: sub_10010770+33j
		cmp	ebp, 1
		jnz	short loc_100107C0
		mov	ecx, 2
		mov	[esi+30h], ebp
		mov	[esi+34h], cx
		jmp	short loc_100107E8
; ---------------------------------------------------------------------------

loc_100107C0:				; CODE XREF: sub_10010770+40j
		cmp	ebp, 3
		jnz	short loc_100107D3
		mov	edx, 1
		mov	[esi+30h], ebp
		mov	[esi+34h], dx
		jmp	short loc_100107E8
; ---------------------------------------------------------------------------

loc_100107D3:				; CODE XREF: sub_10010770+53j
		cmp	ebp, 2
		jnz	loc_100108A4
		mov	[esi+30h], ebp
		mov	eax, 6

loc_100107E4:				; CODE XREF: sub_10010770+3Bj
		mov	[esi+34h], ax

loc_100107E8:				; CODE XREF: sub_10010770+4Ej
					; sub_10010770+61j
		mov	ecx, [ebx+8]
		mov	[esi+3Ch], ecx
		cmp	dword ptr [ebx+8], 0FFFFFFFFh
		jz	short loc_10010809
		cmp	dword ptr [ebx+8], 0
		jz	short loc_10010809
		call	PR_IntervalNow
		mov	edx, [ebx+8]
		add	edx, eax
		mov	[esi+40h], edx
		jmp	short loc_1001080F
; ---------------------------------------------------------------------------

loc_10010809:				; CODE XREF: sub_10010770+82j
					; sub_10010770+88j
		mov	eax, [ebx+8]
		mov	[esi+40h], eax

loc_1001080F:				; CODE XREF: sub_10010770+97j
		mov	ecx, [edi+44h]
		push	ecx
		call	PR_Lock
		mov	eax, [edi+30h]
		lea	ecx, [edi+30h]
		add	esp, 4
		cmp	eax, ecx
		jz	short loc_1001086E
		mov	ebx, [ebx+8]
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_1001086E
		test	ebx, ebx
		jnz	short loc_1001083F
		mov	[esi], eax
		mov	[esi+4], ecx
		mov	edx, [ecx]
		mov	[edx+4], esi
		mov	[ecx], esi
		jmp	short loc_1001087E
; ---------------------------------------------------------------------------

loc_1001083F:				; CODE XREF: sub_10010770+BFj
		mov	eax, [edi+34h]
		cmp	eax, ecx
		jz	short loc_1001085E
		mov	edx, [esi+40h]
		lea	esp, [esp+0]

loc_10010850:				; CODE XREF: sub_10010770+ECj
		mov	ebx, edx
		sub	ebx, [eax+40h]
		jns	short loc_1001085E
		mov	eax, [eax+4]
		cmp	eax, ecx
		jnz	short loc_10010850

loc_1001085E:				; CODE XREF: sub_10010770+D4j
					; sub_10010770+E5j
		mov	ecx, [eax]
		mov	[esi], ecx
		mov	[esi+4], eax
		mov	edx, [eax]
		mov	[edx+4], esi
		mov	[eax], esi
		jmp	short loc_1001087E
; ---------------------------------------------------------------------------

loc_1001086E:				; CODE XREF: sub_10010770+B3j
					; sub_10010770+BBj
		mov	[esi], ecx
		mov	eax, [edi+34h]
		mov	[esi+4], eax
		mov	ecx, [edi+34h]
		mov	[ecx], esi
		mov	[edi+34h], esi

loc_1001087E:				; CODE XREF: sub_10010770+CDj
					; sub_10010770+FCj
		mov	eax, 1
		mov	[esi+8], eax
		mov	edx, [edi+44h]
		add	[edi+48h], eax
		push	edx		; lpTlsValue
		call	PR_Unlock
		mov	eax, [edi+4Ch]
		push	eax
		call	PR_SetPollableEvent
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100108A4:				; CODE XREF: sub_10010770+66j
		call	sub_1000F950
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8

loc_100108B8:				; CODE XREF: sub_10010770+17j
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_10010770	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 293. PR_QueueJob_Read

; =============== S U B	R O U T	I N E =======================================


		public PR_QueueJob_Read
PR_QueueJob_Read proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		push	edi
		mov	edi, [esp+4+arg_0]
		push	0
		push	eax
		mov	eax, [esp+0Ch+arg_10]
		push	ecx
		mov	ecx, [esp+10h+arg_4]
		call	sub_10010770
		add	esp, 0Ch
		pop	edi
		retn
PR_QueueJob_Read endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 295. PR_QueueJob_Write

; =============== S U B	R O U T	I N E =======================================


		public PR_QueueJob_Write
PR_QueueJob_Write proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		push	edi
		mov	edi, [esp+4+arg_0]
		push	1
		push	eax
		mov	eax, [esp+0Ch+arg_10]
		push	ecx
		mov	ecx, [esp+10h+arg_4]
		call	sub_10010770
		add	esp, 0Ch
		pop	edi
		retn
PR_QueueJob_Write endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 291. PR_QueueJob_Accept

; =============== S U B	R O U T	I N E =======================================


		public PR_QueueJob_Accept
PR_QueueJob_Accept proc	near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		push	edi
		mov	edi, [esp+4+arg_0]
		push	3
		push	eax
		mov	eax, [esp+0Ch+arg_10]
		push	ecx
		mov	ecx, [esp+10h+arg_4]
		call	sub_10010770
		add	esp, 0Ch
		pop	edi
		retn
PR_QueueJob_Accept endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 292. PR_QueueJob_Connect

; =============== S U B	R O U T	I N E =======================================


		public PR_QueueJob_Connect
PR_QueueJob_Connect proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		mov	eax, [esp+arg_8]
		push	esi
		mov	esi, [esp+4+arg_4]
		mov	ecx, [esi]
		push	edi
		push	0
		push	eax
		push	ecx
		call	PR_Connect
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001099F
		call	PR_GetError
		cmp	eax, 0FFFFE8D2h
		jnz	short loc_1001099A
		mov	edx, [esp+8+arg_10]
		mov	eax, [esp+8+arg_C]
		mov	edi, [esp+8+arg_0]
		push	2
		push	edx
		push	eax
		mov	eax, [esp+14h+arg_14]
		mov	ecx, esi
		call	sub_10010770
		add	esp, 0Ch
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001099A:				; CODE XREF: PR_QueueJob_Connect+27j
		mov	[esi+4], eax
		jmp	short loc_100109A6
; ---------------------------------------------------------------------------

loc_1001099F:				; CODE XREF: PR_QueueJob_Connect+1Bj
		mov	dword ptr [esi+4], 0

loc_100109A6:				; CODE XREF: PR_QueueJob_Connect+4Dj
		mov	esi, [esp+8+arg_0]
		mov	ecx, [esp+8+arg_14]
		push	esi
		push	ecx
		call	sub_1000F990
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_100109C1
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100109C1:				; CODE XREF: PR_QueueJob_Connect+6Cj
		mov	eax, [esp+8+arg_10]
		mov	edx, [esp+8+arg_C]
		mov	[edi+14h], eax
		mov	eax, edi
		mov	[edi+10h], edx
		mov	[edi+28h], esi
		call	sub_1000FFC0
		mov	eax, edi
		pop	edi
		pop	esi
		retn
PR_QueueJob_Connect endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 294. PR_QueueJob_Timer

; =============== S U B	R O U T	I N E =======================================


		public PR_QueueJob_Timer
PR_QueueJob_Timer proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		mov	ebx, [esp+4+arg_4]
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_100109FD
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100109FD:				; CODE XREF: PR_QueueJob_Timer+8j
		mov	eax, [esp+4+arg_10]
		push	esi
		push	edi
		test	ebx, ebx
		jnz	short loc_10010A37
		mov	esi, [esp+0Ch+arg_0]
		push	esi
		push	eax
		call	sub_1000F990
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_10010A4B
		mov	ecx, [esp+0Ch+arg_8]
		mov	edx, [esp+0Ch+arg_C]
		mov	[edi+10h], ecx
		mov	[edi+14h], edx
		mov	[edi+28h], esi
		call	sub_1000FFC0
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10010A37:				; CODE XREF: PR_QueueJob_Timer+25j
		mov	edi, [esp+0Ch+arg_0]
		push	edi
		push	eax
		call	sub_1000F990
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10010A51

loc_10010A4B:				; CODE XREF: PR_QueueJob_Timer+39j
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10010A51:				; CODE XREF: PR_QueueJob_Timer+69j
		mov	ecx, [esp+0Ch+arg_8]
		mov	edx, [esp+0Ch+arg_C]
		mov	[esi+10h], ecx
		mov	[esi+14h], edx
		mov	[esi+28h], edi
		mov	[esi+3Ch], ebx
		call	PR_IntervalNow
		add	eax, ebx
		mov	[esi+40h], eax
		mov	eax, [edi+60h]
		push	eax
		call	PR_Lock
		mov	ebx, 1
		lea	ecx, [edi+58h]
		add	esp, 4
		mov	[esi+0Ch], ebx
		cmp	[ecx], ecx
		jnz	short loc_10010A9C
		mov	[esi], ecx
		mov	ecx, [edi+5Ch]
		mov	[esi+4], ecx
		mov	edx, [edi+5Ch]
		mov	[edx], esi
		mov	[edi+5Ch], esi
		jmp	short loc_10010AC4
; ---------------------------------------------------------------------------

loc_10010A9C:				; CODE XREF: PR_QueueJob_Timer+A8j
		mov	eax, [edi+5Ch]
		cmp	eax, ecx
		jz	short loc_10010AB6
		mov	edx, [esi+40h]
		push	ebp

loc_10010AA7:				; CODE XREF: PR_QueueJob_Timer+D3j
		mov	ebp, edx
		sub	ebp, [eax+40h]
		jns	short loc_10010AB5
		mov	eax, [eax+4]
		cmp	eax, ecx
		jnz	short loc_10010AA7

loc_10010AB5:				; CODE XREF: PR_QueueJob_Timer+CCj
		pop	ebp

loc_10010AB6:				; CODE XREF: PR_QueueJob_Timer+C1j
		mov	ecx, [eax]
		mov	[esi], ecx
		mov	[esi+4], eax
		mov	edx, [eax]
		mov	[edx+4], esi
		mov	[eax], esi

loc_10010AC4:				; CODE XREF: PR_QueueJob_Timer+BAj
		mov	eax, [edi+64h]
		add	[edi+68h], ebx
		push	eax
		call	PR_NotifyCondVar
		mov	ecx, [edi+60h]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
PR_QueueJob_Timer endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010AF0	proc near		; CODE XREF: sub_10010BE0+3Dp
					; PR_SetTraceOption+37p

arg_0		= dword	ptr  4

		mov	eax, 0AAAAAAABh
		mul	[esp+arg_0]
		mov	eax, edx
		shr	eax, 5
		cdq
		sub	eax, edx
		sar	eax, 1
		push	ebx
		mov	ebx, dword_10031540
		lea	ecx, [eax+eax]
		push	esi
		lea	esi, [ecx+ecx*2]
		lea	edx, [eax+eax*2]
		shl	esi, 4
		shl	edx, 4
		cmp	dword ptr [ebx+4], 2
		mov	dword_1003156C,	2
		mov	dword_10031578,	eax
		mov	dword_10031560,	ecx
		mov	dword_10031558,	esi
		mov	dword_10031550,	edx
		jl	short loc_10010B59
		push	edx
		push	eax
		push	ecx
		push	2
		push	offset aNewtracebuffer ; "NewTraceBuffer: logSegments: %ld, logEn"...
		call	PR_LogPrint
		mov	esi, dword_10031558
		add	esp, 14h

loc_10010B59:				; CODE XREF: sub_10010AF0+4Fj
		push	esi		; Size
		call	PR_Malloc
		xor	esi, esi
		add	esp, 4
		mov	dword_1003155C,	eax
		cmp	eax, esi
		jnz	short loc_10010B87
		mov	eax, dword_10031540
		cmp	dword ptr [eax+4], 2
		jl	short loc_10010BA8
		push	offset aPrtraceFailedT ; "PRTrace: Failed to get trace buffer"
		call	PR_LogPrint
		add	esp, 4
		jmp	short loc_10010BA8
; ---------------------------------------------------------------------------

loc_10010B87:				; CODE XREF: sub_10010AF0+7Bj
		mov	ecx, dword_10031540
		cmp	dword ptr [ecx+4], 4
		jl	short loc_10010BA8
		mov	edx, dword_10031558
		push	eax
		push	edx
		push	offset aPrtraceGotTrac ; "PRTrace: Got trace buffer of size: %ld,"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_10010BA8:				; CODE XREF: sub_10010AF0+86j
					; sub_10010AF0+95j ...
		mov	eax, dword_10031560
		dec	eax
		mov	dword_10031568,	esi
		mov	dword_10031554,	eax
		mov	dword_10031544,	esi
		mov	eax, 1
		pop	esi
		mov	dword_10031548,	eax
		mov	dword_1003154C,	eax
		pop	ebx
		retn
sub_10010AF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10010BE0	proc near		; CODE XREF: PR_CreateTrace+9p
					; sub_100113B0+9p
		call	PR_NewLock
		push	eax
		mov	dword_1003157C,	eax
		call	PR_Lock
		mov	eax, offset dword_10031570
		push	offset aTrace	; "trace"
		mov	dword_10031570,	eax
		mov	dword_10031574,	eax
		call	PR_NewLogModule
		push	100000h
		mov	dword_10031540,	eax
		mov	dword_10031558,	100000h
		call	sub_10010AF0
		call	PR_NewLock
		push	eax
		mov	dword_10031580,	eax
		call	PR_NewCondVar
		mov	dword_10031564,	eax
		mov	eax, dword_1003157C
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 14h
		retn
sub_10010BE0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  74. PR_CreateTrace

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateTrace
PR_CreateTrace	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword_1003157C,	0
		jnz	short loc_10010C5E
		call	sub_10010BE0

loc_10010C5E:				; CODE XREF: PR_CreateTrace+7j
		mov	eax, dword_10031540
		cmp	dword ptr [eax+4], 4
		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	esi
		push	edi
		jl	short loc_10010C83
		mov	ecx, [esp+0Ch+arg_4]
		push	ecx
		push	ebp
		push	offset aPrtraceCreatet ; "PRTRACE: CreateTrace:	Qname: %s, RName:"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_10010C83:				; CODE XREF: PR_CreateTrace+1Ej
		mov	edx, dword_1003157C
		push	edx
		call	PR_Lock
		mov	edi, dword_10031570
		add	esp, 4
		cmp	edi, offset dword_10031570
		jz	short loc_10010CD8

loc_10010CA0:				; CODE XREF: PR_CreateTrace+86j
		mov	ecx, ebp
		lea	eax, [edi+10h]

loc_10010CA5:				; CODE XREF: PR_CreateTrace+6Fj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10010CC5
		test	dl, dl
		jz	short loc_10010CC1
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10010CC5
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10010CA5

loc_10010CC1:				; CODE XREF: PR_CreateTrace+5Dj
		xor	eax, eax
		jmp	short loc_10010CCA
; ---------------------------------------------------------------------------

loc_10010CC5:				; CODE XREF: PR_CreateTrace+59j
					; PR_CreateTrace+65j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10010CCA:				; CODE XREF: PR_CreateTrace+73j
		test	eax, eax
		jz	short loc_10010D27
		mov	edi, [edi]
		cmp	edi, offset dword_10031570
		jnz	short loc_10010CA0

loc_10010CD8:				; CODE XREF: PR_CreateTrace+4Ej
		push	30h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	edi, eax
		lea	eax, [edi+8]
		mov	edx, edi
		add	esp, 8
		mov	[eax], eax
		mov	[edi+0Ch], eax
		mov	[edi], edi
		mov	[edi+4], edi
		mov	eax, ebp
		sub	edx, ebp
		lea	esp, [esp+0]

loc_10010D00:				; CODE XREF: PR_CreateTrace+B9j
		mov	cl, [eax]
		mov	[edx+eax+10h], cl
		inc	eax
		test	cl, cl
		jnz	short loc_10010D00
		mov	dword ptr [edi], offset	dword_10031570
		mov	edx, dword_10031574
		mov	[edi+4], edx
		mov	eax, dword_10031574
		mov	[eax], edi
		mov	dword_10031574,	edi

loc_10010D27:				; CODE XREF: PR_CreateTrace+7Cj
		mov	eax, [edi+8]
		push	ebx
		lea	ebx, [edi+8]
		cmp	eax, ebx
		jz	short loc_10010D38

loc_10010D32:				; CODE XREF: PR_CreateTrace+E6j
		mov	eax, [eax]
		cmp	eax, ebx
		jnz	short loc_10010D32

loc_10010D38:				; CODE XREF: PR_CreateTrace+E0j
		push	134h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		mov	eax, [esp+18h+arg_4]
		mov	edx, esi
		add	esp, 8
		mov	[esi], esi
		mov	[esi+4], esi
		sub	edx, eax

loc_10010D56:				; CODE XREF: PR_CreateTrace+10Fj
		mov	cl, [eax]
		mov	[edx+eax+14h], cl
		inc	eax
		test	cl, cl
		jnz	short loc_10010D56
		mov	eax, [esp+10h+arg_8]
		mov	edx, esi
		sub	edx, eax
		lea	esp, [esp+0]

loc_10010D70:				; CODE XREF: PR_CreateTrace+129j
		mov	cl, [eax]
		mov	[edx+eax+34h], cl
		inc	eax
		test	cl, cl
		jnz	short loc_10010D70
		call	PR_NewLock
		mov	edx, dword_1003157C
		mov	[esi+8], eax
		mov	dword ptr [esi+10h], 1
		mov	[esi], ebx
		mov	eax, [edi+0Ch]
		mov	[esi+4], eax
		mov	ecx, [edi+0Ch]
		mov	[ecx], esi
		mov	[edi+0Ch], esi
		push	edx		; lpTlsValue
		mov	[esi+0Ch], edi
		call	PR_Unlock
		mov	eax, dword_10031540
		add	esp, 4
		cmp	dword ptr [eax+4], 4
		pop	ebx
		jl	short loc_10010DCD
		mov	ecx, [esp+0Ch+arg_4]
		push	esi
		push	ecx
		push	edi
		push	ebp
		push	offset aPrtraceCreateQ ; "PRTrace: Create: QName: %s %p, RName:	%"...
		call	PR_LogPrint
		add	esp, 14h

loc_10010DCD:				; CODE XREF: PR_CreateTrace+166j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		retn
PR_CreateTrace	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  93. PR_DestroyTrace

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyTrace(void *Memory)
		public PR_DestroyTrace
PR_DestroyTrace	proc near		; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		mov	eax, dword_10031540
		cmp	dword ptr [eax+4], 4
		push	esi
		mov	esi, [esp+4+Memory]
		push	edi
		mov	edi, [esi+0Ch]
		jl	short loc_10010E09
		lea	ecx, [esi+14h]
		push	ecx
		lea	edx, [edi+10h]
		push	edx
		push	offset aPrtraceDeletin ; "PRTrace: Deleting: QName: %s,	RName: %s"
		call	PR_LogPrint
		add	esp, 0Ch

loc_10010E09:				; CODE XREF: PR_DestroyTrace+12j
		mov	eax, dword_1003157C
		push	eax
		call	PR_Lock
		mov	ecx, dword_10031540
		add	esp, 4
		cmp	dword ptr [ecx+4], 4
		jl	short loc_10010E35
		push	esi
		lea	edx, [esi+14h]
		push	edx
		push	offset aPrtraceDelet_0 ; "PRTrace: Deleting RName: %s, %p"
		call	PR_LogPrint
		add	esp, 0Ch

loc_10010E35:				; CODE XREF: PR_DestroyTrace+41j
		mov	eax, [esi+4]
		mov	ecx, [esi]
		mov	[eax], ecx
		mov	edx, [esi]
		mov	eax, [esi+4]
		mov	[edx+4], eax
		mov	ecx, [esi+8]
		push	ecx		; Memory
		call	PR_Free
		push	esi		; Memory
		call	PR_Free
		lea	eax, [edi+8]
		add	esp, 8
		cmp	[eax], eax
		jnz	short loc_10010E93
		mov	edx, dword_10031540
		cmp	dword ptr [edx+4], 4
		jl	short loc_10010E7B
		push	edi
		lea	eax, [edi+10h]
		push	eax
		push	offset aPrtraceDelet_1 ; "PRTrace: Deleting unused QName: %s, %p"
		call	PR_LogPrint
		add	esp, 0Ch

loc_10010E7B:				; CODE XREF: PR_DestroyTrace+87j
		mov	ecx, [edi+4]
		mov	edx, [edi]
		mov	[ecx], edx
		mov	eax, [edi]
		mov	ecx, [edi+4]
		push	edi		; Memory
		mov	[eax+4], ecx
		call	PR_Free
		add	esp, 4

loc_10010E93:				; CODE XREF: PR_DestroyTrace+7Bj
		mov	edx, dword_1003157C
		pop	edi
		pop	esi
		mov	[esp+Memory], edx ; lpTlsValue
		jmp	PR_Unlock
PR_DestroyTrace	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 361. PR_Trace

; =============== S U B	R O U T	I N E =======================================


		public PR_Trace
PR_Trace	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h

		mov	eax, 2
		cmp	dword_100302E4,	eax
		jz	locret_10010FCC
		push	ebx
		mov	ebx, [esp+4+arg_0]
		cmp	[ebx+10h], eax
		jz	loc_10010FCB
		mov	eax, dword_1003157C
		push	esi
		push	edi
		push	eax
		call	PR_Lock
		mov	eax, dword_10031568
		lea	esi, [eax+eax*2]
		shl	esi, 4
		add	esi, dword_1003155C
		inc	dword_10031568
		mov	ecx, dword_10031568
		add	esp, 4
		cmp	ecx, dword_10031554
		jle	short loc_10010F0E
		mov	dword_10031568,	0

loc_10010F0E:				; CODE XREF: PR_Trace+52j
		cmp	dword_10031590,	0
		jnz	short loc_10010F2F
		mov	edx, dword_10031568
		cmp	edx, dword_1003158C
		jnz	short loc_10010F2F
		mov	dword_10031590,	1

loc_10010F2F:				; CODE XREF: PR_Trace+65j PR_Trace+73j
		mov	edi, dword_10031568
		mov	eax, dword_1003157C
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		call	PR_GetCurrentThread
		mov	[esi], eax
		mov	[esi+4], ebx
		call	PR_Now
		mov	[esi+0Ch], edx
		mov	edx, [esp+0Ch+arg_8]
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_C]
		mov	[esi+14h], edx
		mov	edx, [esp+0Ch+arg_14]
		mov	[esi+18h], eax
		mov	eax, [esp+0Ch+arg_18]
		mov	[esi+20h], edx
		mov	edx, [esp+0Ch+arg_20]
		mov	[esi+24h], eax
		mov	[esi+2Ch], edx
		mov	eax, edi
		cdq
		idiv	dword_10031578
		mov	ecx, [esp+0Ch+arg_4]
		mov	[esi+10h], ecx
		mov	ecx, [esp+0Ch+arg_10]
		mov	[esi+1Ch], ecx
		mov	ecx, [esp+0Ch+arg_1C]
		pop	edi
		mov	[esi+28h], ecx
		pop	esi
		test	edx, edx
		jnz	short loc_10010FCB
		mov	eax, dword_10031580
		push	eax
		call	PR_Lock
		mov	ecx, dword_10031564
		inc	dword_10031544
		push	ecx
		call	PR_NotifyCondVar
		mov	edx, dword_10031580
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 0Ch

loc_10010FCB:				; CODE XREF: PR_Trace+19j PR_Trace+EDj
		pop	ebx

locret_10010FCC:			; CODE XREF: PR_Trace+Bj
		retn
PR_Trace	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 342. PR_SetTraceOption

; =============== S U B	R O U T	I N E =======================================


		public PR_SetTraceOption
PR_SetTraceOption proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	eax, 9		; switch 10 cases
		ja	loc_1001121B	; jumptable 10010FDD default case
		jmp	ds:off_1001123C[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10010FE4:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	eax, dword_1003157C ; jumptable	10010FDD case 0
		push	eax
		call	PR_Lock
		mov	ecx, dword_1003155C
		push	ecx		; Memory
		call	PR_Free
		mov	edx, [esp+8+arg_4]
		mov	eax, [edx]
		push	eax
		mov	dword_10031558,	eax
		call	sub_10010AF0
		mov	eax, dword_1003157C
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	ecx, dword_10031540
		add	esp, 10h
		cmp	dword ptr [ecx+4], 4
		jl	locret_100110B8
		mov	edx, dword_10031558
		mov	[esp+arg_4], edx
		mov	[esp+arg_0], offset aPrsettraceopti ; "PRSetTraceOption: PRTraceBufSize: %ld"
		jmp	PR_LogPrint
; ---------------------------------------------------------------------------

loc_10011041:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	eax, [esp+arg_4] ; jumptable 10010FDD case 1
		mov	eax, [eax]
		mov	ecx, dword_10031540
		mov	dword ptr [eax+10h], 1
		cmp	dword ptr [ecx+4], 4
		jl	short locret_100110B8
		mov	[esp+arg_4], eax
		mov	[esp+arg_0], offset aPrsettraceop_0 ; "PRSetTraceOption: PRTraceEnable:	%p"
		jmp	PR_LogPrint
; ---------------------------------------------------------------------------

loc_1001106B:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	edx, [esp+arg_4] ; jumptable 10010FDD case 2
		mov	eax, [edx]
		mov	ecx, dword_10031540
		mov	dword ptr [eax+10h], 2
		cmp	dword ptr [ecx+4], 4
		jl	short locret_100110B8
		mov	[esp+arg_4], eax
		mov	[esp+arg_0], offset aPrsettraceop_1 ; "PRSetTraceOption: PRTraceDisable: %p"
		jmp	PR_LogPrint
; ---------------------------------------------------------------------------

loc_10011095:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	edx, dword_10031540 ; jumptable	10010FDD case 3
		cmp	dword ptr [edx+4], 4
		mov	dword_100302E4,	2
		jl	short locret_100110B8
		push	offset aPrsettraceop_2 ; "PRSetTraceOption: PRTraceSuspend"
		call	PR_LogPrint
		add	esp, 4

locret_100110B8:			; CODE XREF: PR_SetTraceOption+54j
					; PR_SetTraceOption+88j ...
		retn
; ---------------------------------------------------------------------------

loc_100110B9:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	eax, dword_10031540 ; jumptable	10010FDD case 4
		cmp	dword ptr [eax+4], 4
		mov	dword_100302E4,	1
		jl	short locret_100110B8
		push	offset aPrsettraceop_3 ; "PRSetTraceOption: PRTraceResume"
		call	PR_LogPrint
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_100110DC:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	ecx, dword_10031580 ; jumptable	10010FDD case 5
		push	ecx
		call	PR_Lock
		mov	edx, dword_10031564
		push	edx
		mov	dword_1003154C,	3
		call	PR_NotifyCondVar
		mov	eax, dword_10031580
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	ecx, dword_10031540
		add	esp, 0Ch
		cmp	dword ptr [ecx+4], 4
		jl	short locret_100110B8
		push	offset aPrsettraceop_4 ; "PRSetTraceOption: PRTraceSuspendRecordi"...
		call	PR_LogPrint
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_10011126:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	edx, dword_10031540 ; jumptable	10010FDD case 6
		cmp	dword ptr [edx+4], 4
		jl	short loc_1001113F
		push	offset aPrsettraceop_5 ; "PRSetTraceOption: PRTraceResumeRecordin"...
		call	PR_LogPrint
		add	esp, 4

loc_1001113F:				; CODE XREF: PR_SetTraceOption+160j
		cmp	dword_10031584,	3
		jnz	locret_100110B8
		mov	eax, dword_10031580
		push	eax
		call	PR_Lock
		mov	ecx, dword_10031564
		push	ecx
		mov	dword_1003154C,	4
		call	PR_NotifyCondVar
		mov	edx, dword_10031580
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001117D:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	eax, dword_10031580 ; jumptable	10010FDD case 9
		push	eax
		call	PR_Lock
		mov	ecx, dword_10031564
		push	ecx
		mov	dword_1003154C,	5
		call	PR_NotifyCondVar
		mov	edx, dword_10031580
		push	edx		; lpTlsValue
		call	PR_Unlock
		mov	eax, dword_10031540
		add	esp, 0Ch
		cmp	dword ptr [eax+4], 4
		jl	locret_100110B8
		push	offset aPrsettraceop_6 ; "PRSetTraceOption: PRTraceStopRecording"
		call	PR_LogPrint
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_100111CA:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	ecx, dword_10031540 ; jumptable	10010FDD case 7
		cmp	dword ptr [ecx+4], 4
		jl	short loc_100111E3
		push	offset aPrsettraceop_7 ; "PRSetTraceOption: PRTraceLockTraceHandl"...
		call	PR_LogPrint
		add	esp, 4

loc_100111E3:				; CODE XREF: PR_SetTraceOption+204j
		mov	edx, dword_1003157C
		push	edx
		call	PR_Lock
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_100111F3:				; CODE XREF: PR_SetTraceOption+Dj
					; DATA XREF: .text:off_1001123Co
		mov	eax, dword_10031540 ; jumptable	10010FDD case 8
		cmp	dword ptr [eax+4], 4
		jl	short loc_1001120B
		push	offset aPrsettraceop_8 ; "PRSetTraceOption: PRTraceUnLockHandles"
		call	PR_LogPrint
		add	esp, 4

loc_1001120B:				; CODE XREF: PR_SetTraceOption+22Cj
		mov	ecx, dword_1003157C
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_1001121B:				; CODE XREF: PR_SetTraceOption+7j
		mov	edx, dword_10031540 ; jumptable	10010FDD default case
		cmp	dword ptr [edx+4], 2
		jl	locret_100110B8
		mov	[esp+arg_4], eax
		mov	[esp+arg_0], offset aPrsettraceop_9 ; "PRSetTraceOption: Invalid command %ld"
		jmp	PR_LogPrint
PR_SetTraceOption endp

; ---------------------------------------------------------------------------
off_1001123C	dd offset loc_10010FE4	; DATA XREF: PR_SetTraceOption+Dr
		dd offset loc_10011041	; jump table for switch	statement
		dd offset loc_1001106B
		dd offset loc_10011095
		dd offset loc_100110B9
		dd offset loc_100110DC
		dd offset loc_10011126
		dd offset loc_100111CA
		dd offset loc_100111F3
		dd offset loc_1001117D
		align 10h
; Exported entry 203. PR_GetTraceOption

; =============== S U B	R O U T	I N E =======================================


		public PR_GetTraceOption
PR_GetTraceOption proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, dword_10031540
		test	eax, eax
		jz	short loc_10011295
		cmp	dword ptr [ecx+4], 2
		jl	short locret_100112B7
		mov	[esp+arg_4], eax
		mov	[esp+arg_0], offset aPrgettraceopti ; "PRGetTraceOption: Invalid command %ld"
		jmp	PR_LogPrint
; ---------------------------------------------------------------------------

loc_10011295:				; CODE XREF: PR_GetTraceOption+Cj
		mov	eax, dword_10031558
		mov	edx, [esp+arg_4]
		mov	[edx], eax
		cmp	dword ptr [ecx+4], 4
		jl	short locret_100112B7
		mov	[esp+arg_4], eax
		mov	[esp+arg_0], offset aPrgettraceop_0 ; "PRGetTraceOption: PRTraceBufSize: %ld"
		jmp	PR_LogPrint
; ---------------------------------------------------------------------------

locret_100112B7:			; CODE XREF: PR_GetTraceOption+12j
					; PR_GetTraceOption+34j
		retn
PR_GetTraceOption endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 202. PR_GetTraceNameFromHandle

; =============== S U B	R O U T	I N E =======================================


		public PR_GetTraceNameFromHandle
PR_GetTraceNameFromHandle proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+0Ch]
		push	ebx
		mov	ebx, [esp+4+arg_C]
		push	esi
		mov	esi, [esp+8+arg_4]
		lea	edx, [ecx+10h]
		mov	[esi], edx
		push	edi
		mov	edi, [esp+0Ch+arg_8]
		lea	esi, [eax+14h]
		mov	[edi], esi
		lea	edi, [eax+34h]
		mov	[ebx], edi
		mov	ebx, dword_10031540
		cmp	dword ptr [ebx+4], 4
		jl	short loc_10011303
		push	edi
		push	esi
		push	edx
		push	eax
		push	ecx
		push	offset aPrtraceGetcont ; "PRTrace: GetConterNameFromHandle: QNp: "...
		call	PR_LogPrint
		add	esp, 18h

loc_10011303:				; CODE XREF: PR_GetTraceNameFromHandle+2Fj
		pop	edi
		pop	esi
		pop	ebx
		retn
PR_GetTraceNameFromHandle endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 127. PR_FindNextTraceQname

; =============== S U B	R O U T	I N E =======================================


		public PR_FindNextTraceQname
PR_FindNextTraceQname proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		push	esi
		mov	esi, dword_10031570
		cmp	esi, offset dword_10031570
		jnz	short loc_10011327
		xor	esi, esi
		jmp	short loc_1001133B
; ---------------------------------------------------------------------------

loc_10011327:				; CODE XREF: PR_FindNextTraceQname+11j
		test	ecx, ecx
		jz	short loc_1001133B
		mov	eax, [ecx]
		mov	esi, eax
		sub	esi, offset dword_10031570
		neg	esi
		sbb	esi, esi
		and	esi, eax

loc_1001133B:				; CODE XREF: PR_FindNextTraceQname+15j
					; PR_FindNextTraceQname+19j
		mov	eax, dword_10031540
		cmp	dword ptr [eax+4], 4
		jl	short loc_10011355
		push	esi
		push	ecx
		push	offset aPrtraceFindnex ; "PRTrace: FindNextQname: Handle: %p, Ret"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_10011355:				; CODE XREF: PR_FindNextTraceQname+34j
		mov	eax, esi
		pop	esi
		retn
PR_FindNextTraceQname endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 128. PR_FindNextTraceRname

; =============== S U B	R O U T	I N E =======================================


		public PR_FindNextTraceRname
PR_FindNextTraceRname proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_0]
		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	esi, [edi+8]
		lea	eax, [edi+8]
		cmp	esi, eax
		jnz	short loc_10011378
		xor	esi, esi
		jmp	short loc_10011388
; ---------------------------------------------------------------------------

loc_10011378:				; CODE XREF: PR_FindNextTraceRname+12j
		test	edx, edx
		jz	short loc_10011388
		mov	ecx, [edx]
		mov	esi, ecx
		sub	esi, eax
		neg	esi
		sbb	esi, esi
		and	esi, ecx

loc_10011388:				; CODE XREF: PR_FindNextTraceRname+16j
					; PR_FindNextTraceRname+1Aj
		mov	eax, dword_10031540
		cmp	dword ptr [eax+4], 4
		jl	short loc_100113A3
		push	esi
		push	edi
		push	edx
		push	offset aPrtraceFindn_0 ; "PRTrace: FindNextRname: Rhandle: %p, QH"...
		call	PR_LogPrint
		add	esp, 10h

loc_100113A3:				; CODE XREF: PR_FindNextTraceRname+31j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_FindNextTraceRname endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100113B0	proc near		; CODE XREF: PR_RecordTraceEntries+4p
		cmp	dword_1003157C,	0
		jnz	short loc_100113BE
		call	sub_10010BE0

loc_100113BE:				; CODE XREF: sub_100113B0+7j
		mov	eax, dword_10031540
		cmp	dword ptr [eax+4], 4
		jl	short loc_100113D6
		push	offset aPr_recordtra_0 ; "PR_RecordTraceEntries: begins"
		call	PR_LogPrint
		add	esp, 4

loc_100113D6:				; CODE XREF: sub_100113B0+17j
		push	esi
		push	offset aNspr_trace_log ; "NSPR_TRACE_LOG"
		mov	dword_10031548,	0
		mov	dword_10031584,	1
		call	PR_GetEnv
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1001141B
		mov	ecx, dword_10031540
		cmp	dword ptr [ecx+4], 2
		jl	short loc_1001144F
		push	offset aRecordtraceent ; "RecordTraceEntries: Environment variabl"...
		call	PR_LogPrint
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001141B:				; CODE XREF: sub_100113B0+4Cj
		push	1B6h		; int
		push	0Ah		; int
		push	esi		; lpFileName
		call	PR_Open
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10011451
		mov	edx, dword_10031540
		cmp	dword ptr [edx+4], 2
		jl	short loc_1001144F
		call	PR_GetOSError
		push	eax
		push	esi
		push	offset aRecordtracee_0 ; "RecordTraceEntries: Cannot open %s as	t"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_1001144F:				; CODE XREF: sub_100113B0+58j
					; sub_100113B0+89j
		xor	eax, eax

loc_10011451:				; CODE XREF: sub_100113B0+7Dj
		pop	esi
		retn
sub_100113B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011460	proc near		; CODE XREF: PR_RecordTraceEntries:loc_10011695p
		mov	ecx, dword_1003154C
		lea	eax, [ecx-1]
		mov	edx, 4
		cmp	eax, edx	; switch 5 cases
		ja	loc_10011529	; jumptable 10011476 default case
		jmp	ds:off_10011544[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001147D:				; CODE XREF: sub_10011460+16j
					; DATA XREF: .text:off_10011544o
		mov	eax, dword_10031588 ; jumptable	10011476 case 0
		mov	dword_10031584,	eax
		mov	dword_1003154C,	eax
		mov	eax, dword_10031540
		cmp	[eax+4], edx
		jl	locret_10011543
		push	offset aRecordtracee_1 ; "RecordTraceEntries: LogReset"
		call	PR_LogPrint
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_100114A8:				; CODE XREF: sub_10011460+16j
					; DATA XREF: .text:off_10011544o
		mov	ecx, dword_10031540 ; jumptable	10011476 case 2
		mov	eax, 3
		mov	dword_10031584,	eax
		mov	dword_1003154C,	eax
		mov	dword_10031588,	eax
		cmp	[ecx+4], edx
		jl	short locret_10011543
		push	offset aRecordtracee_2 ; "RecordTraceEntries: LogSuspend"
		call	PR_LogPrint
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_100114D5:				; CODE XREF: sub_10011460+16j
					; DATA XREF: .text:off_10011544o
		mov	eax, 2		; jumptable 10011476 case 3
		mov	dword_10031584,	eax
		mov	dword_1003154C,	eax
		mov	dword_10031588,	eax
		mov	eax, dword_10031540
		cmp	[eax+4], edx
		jl	short locret_10011543
		push	offset aRecordtracee_3 ; "RecordTraceEntries: LogResume"
		call	PR_LogPrint
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_10011501:				; CODE XREF: sub_10011460+16j
					; DATA XREF: .text:off_10011544o
		mov	ecx, dword_10031540 ; jumptable	10011476 case 4
		mov	eax, 5
		mov	dword_10031584,	eax
		mov	dword_1003154C,	eax
		cmp	[ecx+4], edx
		jl	short locret_10011543
		push	offset aRecordtracee_4 ; "RecordTraceEntries: LogStop"
		call	PR_LogPrint
		add	esp, 4
		retn
; ---------------------------------------------------------------------------

loc_10011529:				; CODE XREF: sub_10011460+10j
					; sub_10011460+16j
					; DATA XREF: ...
		mov	edx, dword_10031540 ; jumptable	10011476 default case
		cmp	dword ptr [edx+4], 2
		jl	short locret_10011543
		push	ecx
		push	offset aRecordtracee_5 ; "RecordTraceEntries: Invalid logOrder:	%"...
		call	PR_LogPrint
		add	esp, 8

locret_10011543:			; CODE XREF: sub_10011460+34j
					; sub_10011460+65j ...
		retn
sub_10011460	endp

; ---------------------------------------------------------------------------
off_10011544	dd offset loc_1001147D	; DATA XREF: sub_10011460+16r
		dd offset loc_10011529	; jump table for switch	statement
		dd offset loc_100114A8
		dd offset loc_100114D5
		dd offset loc_10011501
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011560	proc near		; CODE XREF: PR_RecordTraceEntries+14Ep

arg_0		= dword	ptr  4

		mov	eax, dword_10031540
		cmp	dword ptr [eax+4], 2
		jl	short loc_1001157A
		push	esi
		push	edi
		push	offset aWritetracesegm ; "WriteTraceSegment: Buffer: %p, Amount: "...
		call	PR_LogPrint
		add	esp, 0Ch

loc_1001157A:				; CODE XREF: sub_10011560+9j
		mov	ecx, [esp+arg_0]
		push	esi
		push	edi
		push	ecx
		call	PR_Write
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100115AE
		mov	edx, dword_10031540
		cmp	dword ptr [edx+4], 2
		jl	short locret_100115E9
		call	PR_GetError
		push	eax
		push	offset aRecordtracee_6 ; "RecordTraceEntries: PR_Write() failed. "...
		call	PR_LogPrint
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100115AE:				; CODE XREF: sub_10011560+2Cj
		cmp	eax, esi
		jz	short loc_100115CE
		mov	ecx, dword_10031540
		cmp	dword ptr [ecx+4], 2
		jl	short locret_100115E9
		push	eax
		push	esi
		push	offset aRecordtracee_7 ; "RecordTraceEntries: PR_Write() Tried to"...
		call	PR_LogPrint
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_100115CE:				; CODE XREF: sub_10011560+50j
		mov	edx, dword_10031540
		cmp	dword ptr [edx+4], 4
		jl	short locret_100115E9
		push	esi
		push	edi
		push	offset aRecordtracee_8 ; "RecordTraceEntries: PR_Write(): Buffer:"...
		call	PR_LogPrint
		add	esp, 0Ch

locret_100115E9:			; CODE XREF: sub_10011560+38j
					; sub_10011560+5Cj ...
		retn
sub_10011560	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 302. PR_RecordTraceEntries

; =============== S U B	R O U T	I N E =======================================


		public PR_RecordTraceEntries
PR_RecordTraceEntries proc near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		xor	ebx, ebx
		call	sub_100113B0
		mov	[esp+8+var_4], eax
		test	eax, eax
		jnz	short loc_10011620
		mov	eax, dword_10031540
		cmp	dword ptr [eax+4], 4
		jl	loc_10011792
		push	offset aPr_recordtra_1 ; "PR_RecordTraceEntries: Failed	to initia"...
		call	PR_LogPrint
		add	esp, 4
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10011620:				; CODE XREF: PR_RecordTraceEntries+Fj
		cmp	dword_10031584,	5
		push	ebp
		mov	ebp, 4
		jz	loc_10011770
		push	esi
		push	edi
		mov	edi, [esp+14h+var_4]
		lea	esp, [esp+0]

loc_10011640:				; CODE XREF: PR_RecordTraceEntries+174j
		mov	ecx, dword_10031580
		push	ecx
		call	PR_Lock
		mov	eax, dword_10031544
		add	esp, 4
		test	eax, eax
		jnz	short loc_10011687
		jmp	short loc_10011660
; ---------------------------------------------------------------------------
		align 10h

loc_10011660:				; CODE XREF: PR_RecordTraceEntries+68j
					; PR_RecordTraceEntries+95j
		mov	edx, dword_1003154C
		cmp	edx, dword_10031584
		jnz	short loc_10011695
		mov	eax, dword_10031564
		push	0FFFFFFFFh
		push	eax
		call	PR_WaitCondVar
		mov	eax, dword_10031544
		add	esp, 8
		test	eax, eax
		jz	short loc_10011660

loc_10011687:				; CODE XREF: PR_RecordTraceEntries+66j
		mov	ecx, dword_1003154C
		cmp	ecx, dword_10031584
		jz	short loc_1001169F

loc_10011695:				; CODE XREF: PR_RecordTraceEntries+7Cj
		call	sub_10011460
		mov	eax, dword_10031544

loc_1001169F:				; CODE XREF: PR_RecordTraceEntries+A3j
		test	eax, eax
		jz	short loc_10011714
		mov	ecx, dword_1003156C
		mov	edx, eax
		sub	edx, ecx
		test	edx, edx
		jle	short loc_100116EC
		mov	edx, eax
		sub	edx, ecx
		add	dword_10031548,	edx
		cdq
		idiv	ecx
		mov	eax, dword_10031540
		mov	dword_10031544,	edx
		mov	ebx, edx
		cmp	[eax+4], ebp
		jl	short loc_100116F2
		mov	ecx, dword_10031548
		push	ecx
		push	offset aPr_recordtra_2 ; "PR_RecordTraceEntries: LostData segment"...
		call	PR_LogPrint
		mov	ecx, dword_1003156C
		add	esp, 8
		jmp	short loc_100116F2
; ---------------------------------------------------------------------------

loc_100116EC:				; CODE XREF: PR_RecordTraceEntries+BFj
		dec	eax
		mov	dword_10031544,	eax

loc_100116F2:				; CODE XREF: PR_RecordTraceEntries+DEj
					; PR_RecordTraceEntries+FAj
		mov	eax, dword_10031578
		imul	eax, ebx
		lea	edi, [eax+eax*2]
		shl	edi, 4
		add	edi, dword_1003155C
		inc	ebx
		cmp	ebx, ecx
		jl	short loc_1001170D
		xor	ebx, ebx

loc_1001170D:				; CODE XREF: PR_RecordTraceEntries+119j
		mov	esi, 1
		jmp	short loc_10011716
; ---------------------------------------------------------------------------

loc_10011714:				; CODE XREF: PR_RecordTraceEntries+B1j
		xor	esi, esi

loc_10011716:				; CODE XREF: PR_RecordTraceEntries+122j
		mov	edx, dword_10031580
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	esi, 1
		jnz	short loc_1001175D
		cmp	dword_10031588,	3
		jz	short loc_10011745
		mov	eax, [esp+14h+var_4]
		mov	esi, dword_10031550
		push	eax
		call	sub_10011560
		jmp	short loc_1001175A
; ---------------------------------------------------------------------------

loc_10011745:				; CODE XREF: PR_RecordTraceEntries+141j
		mov	ecx, dword_10031540
		cmp	[ecx+4], ebp
		jl	short loc_1001175D
		push	offset aRecordtracee_9 ; "RecordTraceEntries: PR_Write(): is susp"...
		call	PR_LogPrint

loc_1001175A:				; CODE XREF: PR_RecordTraceEntries+153j
		add	esp, 4

loc_1001175D:				; CODE XREF: PR_RecordTraceEntries+138j
					; PR_RecordTraceEntries+15Ej
		cmp	dword_10031584,	5
		jnz	loc_10011640
		mov	eax, [esp+14h+var_4]
		pop	edi
		pop	esi

loc_10011770:				; CODE XREF: PR_RecordTraceEntries+3Dj
		push	eax
		call	PR_Close
		mov	edx, dword_10031540
		add	esp, 4
		cmp	[edx+4], ebp
		pop	ebp
		jl	short loc_10011792
		push	offset aRecordtrace_10 ; "RecordTraceEntries: exiting"
		call	PR_LogPrint
		add	esp, 4

loc_10011792:				; CODE XREF: PR_RecordTraceEntries+1Aj
					; PR_RecordTraceEntries+193j
		pop	ebx
		pop	ecx
		retn
PR_RecordTraceEntries endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 200. PR_GetTraceEntries

; =============== S U B	R O U T	I N E =======================================


		public PR_GetTraceEntries
PR_GetTraceEntries proc	near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		mov	eax, dword_1003157C
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	eax
		xor	ebp, ebp
		call	PR_Lock
		mov	ecx, dword_10031540
		add	esp, 4
		cmp	dword ptr [ecx+4], 2
		jl	short loc_100117DB
		mov	edx, dword_1003158C
		mov	eax, dword_10031568
		push	edx
		push	eax
		push	offset aPr_gettracee_0 ; "PR_GetTraceEntries: Next: %ld, LastSeen"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_100117DB:				; CODE XREF: PR_GetTraceEntries+1Fj
		mov	ecx, dword_10031568
		mov	eax, dword_1003158C
		mov	ebx, [esp+14h+arg_4]
		cmp	eax, ecx
		jg	short loc_1001183C
		test	ebx, ebx
		jle	loc_100118E3
		mov	edx, [esp+14h+arg_0]
		lea	ebx, [ebx+0]

loc_10011800:				; CODE XREF: PR_GetTraceEntries+95j
		mov	ecx, dword_10031568
		mov	eax, dword_1003158C
		dec	ebx
		cmp	eax, ecx
		jge	loc_100118E3
		lea	esi, [eax+eax*2]
		shl	esi, 4
		add	esi, dword_1003155C
		mov	edi, edx
		inc	eax
		mov	ecx, 0Ch
		inc	ebp
		add	edx, 30h
		rep movsd
		mov	dword_1003158C,	eax
		test	ebx, ebx
		jg	short loc_10011800
		jmp	loc_100118E3
; ---------------------------------------------------------------------------

loc_1001183C:				; CODE XREF: PR_GetTraceEntries+4Cj
		test	ebx, ebx
		jle	short loc_10011878
		mov	ecx, [esp+14h+arg_0]
		lea	edx, [eax+eax*2]
		shl	edx, 4
		add	edx, dword_1003155C
		mov	[esp+14h+var_4], ecx

loc_10011854:				; CODE XREF: PR_GetTraceEntries+D6j
		dec	ebx
		cmp	eax, dword_10031554
		jg	short loc_10011879
		mov	edi, [esp+14h+var_4]
		add	[esp+14h+var_4], 30h
		mov	esi, edx
		mov	ecx, 0Ch
		inc	ebp
		inc	eax
		add	edx, 30h
		rep movsd
		test	ebx, ebx
		jg	short loc_10011854

loc_10011878:				; CODE XREF: PR_GetTraceEntries+9Ej
		dec	ebx

loc_10011879:				; CODE XREF: PR_GetTraceEntries+BBj
		mov	edx, dword_10031540
		xor	eax, eax
		cmp	dword ptr [edx+4], 2
		mov	dword_1003158C,	eax
		jl	short loc_100118A0
		push	eax
		push	ebp
		push	offset aPr_gettracee_1 ; "PR_GetTraceEntries: Copied: %ld, LastSe"...
		call	PR_LogPrint
		mov	eax, dword_1003158C
		add	esp, 0Ch

loc_100118A0:				; CODE XREF: PR_GetTraceEntries+EAj
		test	ebx, ebx
		jle	short loc_100118E3
		lea	edx, [ebp+ebp*2+0]
		shl	edx, 4
		add	edx, [esp+14h+arg_0]
		nop

loc_100118B0:				; CODE XREF: PR_GetTraceEntries+141j
		mov	ecx, dword_10031568
		mov	eax, dword_1003158C
		dec	ebx
		cmp	eax, ecx
		jge	short loc_100118E3
		lea	esi, [eax+eax*2]
		shl	esi, 4
		add	esi, dword_1003155C
		mov	edi, edx
		inc	eax
		mov	ecx, 0Ch
		inc	ebp
		add	edx, 30h
		rep movsd
		mov	dword_1003158C,	eax
		test	ebx, ebx
		jg	short loc_100118B0

loc_100118E3:				; CODE XREF: PR_GetTraceEntries+50j
					; PR_GetTraceEntries+6Ej ...
		mov	edx, dword_10031540
		cmp	dword ptr [edx+4], 2
		jl	short loc_100118FE
		push	eax
		push	ebp
		push	offset aPr_gettracee_1 ; "PR_GetTraceEntries: Copied: %ld, LastSe"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_100118FE:				; CODE XREF: PR_GetTraceEntries+14Dj
		mov	edx, dword_1003157C
		mov	eax, [esp+14h+arg_8]
		xor	ecx, ecx
		cmp	dword_10031590,	1
		push	edx		; lpTlsValue
		setz	cl
		mov	[eax], ebp
		mov	dword_10031590,	0
		mov	esi, ecx
		call	PR_Unlock
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
PR_GetTraceEntries endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 201. PR_GetTraceHandleFromName

; =============== S U B	R O U T	I N E =======================================


		public PR_GetTraceHandleFromName
PR_GetTraceHandleFromName proc near	; DATA XREF: .rdata:off_1002C7C8o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		mov	eax, dword_10031540
		push	ebx
		push	edi
		xor	ebx, ebx
		mov	edi, 4
		mov	[esp+10h+var_4], ebx
		cmp	[eax+4], edi
		jl	short loc_10011971
		mov	ecx, [esp+10h+arg_4]
		mov	edx, [esp+10h+arg_0]
		push	ecx
		push	edx
		push	offset aPrtraceGettrac ; "PRTrace: GetTraceHandleFromName:\n\tQNa"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_10011971:				; CODE XREF: PR_GetTraceHandleFromName+18j
		mov	eax, dword_10031570
		push	esi
		mov	esi, eax
		sub	esi, offset dword_10031570
		neg	esi
		sbb	esi, esi
		and	esi, eax
		mov	eax, dword_10031540
		cmp	[eax+4], edi
		jl	short loc_1001199E
		push	esi
		push	ebx
		push	offset aPrtraceFindnex ; "PRTrace: FindNextQname: Handle: %p, Ret"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_1001199E:				; CODE XREF: PR_GetTraceHandleFromName+4Dj
		mov	ecx, esi
		mov	[esp+14h+var_8], ecx
		cmp	esi, ebx
		jz	loc_10011B00
		push	ebp
		jmp	short loc_100119B2
; ---------------------------------------------------------------------------
		align 10h

loc_100119B0:				; CODE XREF: PR_GetTraceHandleFromName+1AEj
		mov	ecx, esi

loc_100119B2:				; CODE XREF: PR_GetTraceHandleFromName+6Dj
		mov	eax, [ecx+8]
		mov	edx, dword_10031540
		lea	ebp, [ecx+8]
		mov	esi, eax
		sub	esi, ebp
		neg	esi
		sbb	esi, esi
		and	esi, eax
		cmp	[edx+4], edi
		jl	short loc_100119DE
		push	esi
		push	ecx
		push	0
		push	offset aPrtraceFindn_0 ; "PRTrace: FindNextRname: Rhandle: %p, QH"...
		call	PR_LogPrint
		add	esp, 10h

loc_100119DE:				; CODE XREF: PR_GetTraceHandleFromName+8Bj
		mov	ebx, esi
		test	esi, esi
		jz	loc_10011ABA
		jmp	short loc_100119F0
; ---------------------------------------------------------------------------
		align 10h

loc_100119F0:				; CODE XREF: PR_GetTraceHandleFromName+A8j
					; PR_GetTraceHandleFromName+171j
		mov	ecx, dword_10031540
		cmp	dword ptr [ecx+4], 4
		mov	eax, [ebx+0Ch]
		lea	esi, [eax+10h]
		lea	edi, [ebx+14h]
		jl	short loc_10011A1A
		lea	edx, [ebx+34h]
		push	edx
		push	edi
		push	esi
		push	ebx
		push	eax
		push	offset aPrtraceGetcont ; "PRTrace: GetConterNameFromHandle: QNp: "...
		call	PR_LogPrint
		add	esp, 18h

loc_10011A1A:				; CODE XREF: PR_GetTraceHandleFromName+C3j
		mov	eax, [esp+18h+arg_0]
		mov	ecx, esi

loc_10011A20:				; CODE XREF: PR_GetTraceHandleFromName+FAj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10011A40
		test	dl, dl
		jz	short loc_10011A3C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10011A40
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10011A20

loc_10011A3C:				; CODE XREF: PR_GetTraceHandleFromName+E8j
		xor	eax, eax
		jmp	short loc_10011A45
; ---------------------------------------------------------------------------

loc_10011A40:				; CODE XREF: PR_GetTraceHandleFromName+E4j
					; PR_GetTraceHandleFromName+F0j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10011A45:				; CODE XREF: PR_GetTraceHandleFromName+FEj
		test	eax, eax
		jnz	short loc_10011A79
		mov	eax, [esp+18h+arg_4]
		mov	ecx, edi
		nop

loc_10011A50:				; CODE XREF: PR_GetTraceHandleFromName+12Aj
		mov	dl, [eax]
		cmp	dl, [ecx]
		jnz	short loc_10011A70
		test	dl, dl
		jz	short loc_10011A6C
		mov	dl, [eax+1]
		cmp	dl, [ecx+1]
		jnz	short loc_10011A70
		add	eax, 2
		add	ecx, 2
		test	dl, dl
		jnz	short loc_10011A50

loc_10011A6C:				; CODE XREF: PR_GetTraceHandleFromName+118j
		xor	eax, eax
		jmp	short loc_10011A75
; ---------------------------------------------------------------------------

loc_10011A70:				; CODE XREF: PR_GetTraceHandleFromName+114j
					; PR_GetTraceHandleFromName+120j
		sbb	eax, eax
		sbb	eax, 0FFFFFFFFh

loc_10011A75:				; CODE XREF: PR_GetTraceHandleFromName+12Ej
		test	eax, eax
		jz	short loc_10011AF6

loc_10011A79:				; CODE XREF: PR_GetTraceHandleFromName+107j
		cmp	[ebp+0], ebp
		jnz	short loc_10011A82
		xor	esi, esi
		jmp	short loc_10011A8E
; ---------------------------------------------------------------------------

loc_10011A82:				; CODE XREF: PR_GetTraceHandleFromName+13Cj
		mov	eax, [ebx]
		mov	esi, eax
		sub	esi, ebp
		neg	esi
		sbb	esi, esi
		and	esi, eax

loc_10011A8E:				; CODE XREF: PR_GetTraceHandleFromName+140j
		mov	eax, dword_10031540
		cmp	dword ptr [eax+4], 4
		jl	short loc_10011AAD
		mov	ecx, [esp+18h+var_8]
		push	esi
		push	ecx
		push	ebx
		push	offset aPrtraceFindn_0 ; "PRTrace: FindNextRname: Rhandle: %p, QH"...
		call	PR_LogPrint
		add	esp, 10h

loc_10011AAD:				; CODE XREF: PR_GetTraceHandleFromName+157j
		mov	ebx, esi
		test	esi, esi
		jnz	loc_100119F0
		lea	edi, [esi+4]

loc_10011ABA:				; CODE XREF: PR_GetTraceHandleFromName+A2j
		mov	eax, dword_10031570
		mov	edx, dword_10031540
		mov	esi, eax
		sub	esi, offset dword_10031570
		neg	esi
		sbb	esi, esi
		and	esi, eax
		cmp	[edx+4], edi
		jl	short loc_10011AE8
		push	esi
		push	0
		push	offset aPrtraceFindnex ; "PRTrace: FindNextQname: Handle: %p, Ret"...
		call	PR_LogPrint
		add	esp, 0Ch

loc_10011AE8:				; CODE XREF: PR_GetTraceHandleFromName+196j
		mov	[esp+18h+var_8], esi
		test	esi, esi
		jnz	loc_100119B0
		jmp	short loc_10011AFF
; ---------------------------------------------------------------------------

loc_10011AF6:				; CODE XREF: PR_GetTraceHandleFromName+137j
		mov	[esp+18h+var_4], ebx
		mov	edi, 4

loc_10011AFF:				; CODE XREF: PR_GetTraceHandleFromName+1B4j
		pop	ebp

loc_10011B00:				; CODE XREF: PR_GetTraceHandleFromName+66j
		mov	eax, dword_10031540
		pop	esi
		cmp	[eax+4], edi
		jl	short loc_10011B1D
		mov	ecx, [esp+10h+var_4]
		push	ecx
		push	offset aPr_counterGe_2 ; "PR_Counter: GetConterHandleFromName: %p"
		call	PR_LogPrint
		add	esp, 8

loc_10011B1D:				; CODE XREF: PR_GetTraceHandleFromName+1C9j
		pop	edi
		mov	eax, ebx
		pop	ebx
		add	esp, 8
		retn
PR_GetTraceHandleFromName endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011B30	proc near		; CODE XREF: sub_10011B70+86p
		movsx	ecx, cx
		mov	eax, ecx
		and	eax, 80000003h
		jns	short loc_10011B41
		dec	eax
		or	eax, 0FFFFFFFCh
		inc	eax

loc_10011B41:				; CODE XREF: sub_10011B30+Aj
		jnz	short loc_10011B53
		mov	eax, ecx
		push	esi
		cdq
		mov	esi, 64h
		idiv	esi
		pop	esi
		test	edx, edx
		jnz	short loc_10011B61

loc_10011B53:				; CODE XREF: sub_10011B30:loc_10011B41j
		mov	eax, ecx
		cdq
		mov	ecx, 190h
		idiv	ecx
		test	edx, edx
		jnz	short loc_10011B67

loc_10011B61:				; CODE XREF: sub_10011B30+21j
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_10011B67:				; CODE XREF: sub_10011B30+2Fj
		xor	eax, eax
		retn
sub_10011B30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10011B70	proc near		; CODE XREF: PR_NormalizeTime+2D8p
					; PR_USPacificTimeParameters+57p ...
		add	[esi+4], eax
		mov	eax, [esi+4]
		push	ebx
		push	edi
		mov	ebx, 0FFFFFFFFh
		js	short loc_10011B84
		cmp	eax, 3Ch
		jl	short loc_10011B9E

loc_10011B84:				; CODE XREF: sub_10011B70+Dj
		cdq
		mov	ecx, 3Ch
		idiv	ecx
		add	[esi+8], eax
		mov	[esi+4], edx
		test	edx, edx
		jns	short loc_10011B9E
		add	edx, ecx
		add	[esi+8], ebx
		mov	[esi+4], edx

loc_10011B9E:				; CODE XREF: sub_10011B70+12j
					; sub_10011B70+24j
		mov	eax, [esi+8]
		test	eax, eax
		js	short loc_10011BAA
		cmp	eax, 3Ch
		jl	short loc_10011BC4

loc_10011BAA:				; CODE XREF: sub_10011B70+33j
		cdq
		mov	ecx, 3Ch
		idiv	ecx
		add	[esi+0Ch], eax
		mov	[esi+8], edx
		test	edx, edx
		jns	short loc_10011BC4
		add	edx, ecx
		add	[esi+0Ch], ebx
		mov	[esi+8], edx

loc_10011BC4:				; CODE XREF: sub_10011B70+38j
					; sub_10011B70+4Aj
		mov	eax, [esi+0Ch]
		test	eax, eax
		jns	loc_10011C71
		add	[esi+10h], ebx
		add	[esi+1Ch], bx
		add	eax, 18h
		cmp	dword ptr [esi+10h], 1
		mov	[esi+0Ch], eax
		jge	short loc_10011C61
		add	[esi+14h], ebx
		jns	short loc_10011C13
		add	[esi+18h], bx
		movzx	ecx, word ptr [esi+18h]
		mov	dword ptr [esi+14h], 0Bh
		call	sub_10011B30
		test	eax, eax
		jz	short loc_10011C0A
		mov	edx, 16Dh
		mov	[esi+1Ch], dx
		jmp	short loc_10011C13
; ---------------------------------------------------------------------------

loc_10011C0A:				; CODE XREF: sub_10011B70+8Dj
		mov	eax, 16Ch
		mov	[esi+1Ch], ax

loc_10011C13:				; CODE XREF: sub_10011B70+75j
					; sub_10011B70+98j
		movzx	eax, word ptr [esi+18h]
		movsx	ecx, ax
		mov	edx, ecx
		and	edx, 80000003h
		jns	short loc_10011C29
		dec	edx
		or	edx, 0FFFFFFFCh
		inc	edx

loc_10011C29:				; CODE XREF: sub_10011B70+B2j
		jnz	short loc_10011C39
		mov	eax, ecx
		cdq
		mov	edi, 64h
		idiv	edi
		test	edx, edx
		jnz	short loc_10011C47

loc_10011C39:				; CODE XREF: sub_10011B70:loc_10011C29j
		mov	eax, ecx
		cdq
		mov	ecx, 190h
		idiv	ecx
		test	edx, edx
		jnz	short loc_10011C4E

loc_10011C47:				; CODE XREF: sub_10011B70+C7j
		mov	eax, 1
		jmp	short loc_10011C50
; ---------------------------------------------------------------------------

loc_10011C4E:				; CODE XREF: sub_10011B70+D5j
		xor	eax, eax

loc_10011C50:				; CODE XREF: sub_10011B70+DCj
		lea	edx, [eax+eax*2]
		mov	eax, [esi+14h]
		movsx	ecx, ds:byte_1002AEF8[eax+edx*4]
		mov	[esi+10h], ecx

loc_10011C61:				; CODE XREF: sub_10011B70+70j
		add	[esi+1Ah], bl
		jns	loc_10011D0D
		pop	edi
		mov	byte ptr [esi+1Ah], 6
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10011C71:				; CODE XREF: sub_10011B70+59j
		cmp	eax, 17h
		jle	loc_10011D0D
		movzx	edi, word ptr [esi+18h]
		movsx	ecx, di
		mov	ebx, 1
		add	[esi+10h], ebx
		add	[esi+1Ch], bx
		add	eax, 0FFFFFFE8h
		mov	edx, ecx
		and	edx, 80000003h
		push	ebp
		mov	ebp, [esi+10h]
		mov	[esi+0Ch], eax
		jns	short loc_10011CA6
		dec	edx
		or	edx, 0FFFFFFFCh
		inc	edx

loc_10011CA6:				; CODE XREF: sub_10011B70+12Fj
		jnz	short loc_10011CBB
		mov	eax, ecx
		cdq
		mov	ebx, 64h
		idiv	ebx
		mov	ebx, 1
		test	edx, edx
		jnz	short loc_10011CC9

loc_10011CBB:				; CODE XREF: sub_10011B70:loc_10011CA6j
		mov	eax, ecx
		cdq
		mov	ecx, 190h
		idiv	ecx
		test	edx, edx
		jnz	short loc_10011CCD

loc_10011CC9:				; CODE XREF: sub_10011B70+149j
		mov	ecx, ebx
		jmp	short loc_10011CCF
; ---------------------------------------------------------------------------

loc_10011CCD:				; CODE XREF: sub_10011B70+157j
		xor	ecx, ecx

loc_10011CCF:				; CODE XREF: sub_10011B70+15Bj
		mov	eax, [esi+14h]
		lea	edx, [ecx+ecx*2]
		movsx	ecx, ds:byte_1002AEF8[eax+edx*4]
		cmp	ebp, ecx
		pop	ebp
		jle	short loc_10011D00
		inc	eax
		mov	[esi+10h], ebx
		mov	[esi+14h], eax
		cmp	eax, 0Bh
		jle	short loc_10011D00
		inc	edi
		xor	edx, edx
		mov	dword ptr [esi+14h], 0
		mov	[esi+18h], di
		mov	[esi+1Ch], dx

loc_10011D00:				; CODE XREF: sub_10011B70+170j
					; sub_10011B70+17Cj
		add	[esi+1Ah], bl
		cmp	byte ptr [esi+1Ah], 6
		jle	short loc_10011D0D
		mov	byte ptr [esi+1Ah], 0

loc_10011D0D:				; CODE XREF: sub_10011B70+F4j
					; sub_10011B70+104j ...
		pop	edi
		pop	ebx
		retn
sub_10011B70	endp

; Exported entry 264. PR_NormalizeTime

; =============== S U B	R O U T	I N E =======================================


		public PR_NormalizeTime
PR_NormalizeTime proc near		; CODE XREF: PR_ImplodeTime+29p
					; PR_ParseTimeStringToExplodedTime+E8Ap
					; DATA XREF: ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		mov	eax, [esi+20h]
		add	eax, [esi+24h]
		push	edi
		sub	[esi+4], eax
		mov	eax, [esi]
		xor	edi, edi
		or	ecx, 0FFFFFFFFh
		mov	[esi+20h], edi
		mov	[esi+24h], edi
		cmp	eax, edi
		jl	short loc_10011D39
		cmp	eax, 0F4240h
		jl	short loc_10011D51

loc_10011D39:				; CODE XREF: PR_NormalizeTime+20j
		cdq
		mov	ebx, 0F4240h
		idiv	ebx
		add	[esi+4], eax
		mov	[esi], edx
		cmp	edx, edi
		jge	short loc_10011D51
		add	edx, ebx
		add	[esi+4], ecx
		mov	[esi], edx

loc_10011D51:				; CODE XREF: PR_NormalizeTime+27j
					; PR_NormalizeTime+38j
		mov	eax, [esi+4]
		cmp	eax, edi
		jl	short loc_10011D5D
		cmp	eax, 3Ch
		jl	short loc_10011D77

loc_10011D5D:				; CODE XREF: PR_NormalizeTime+46j
		cdq
		mov	ebx, 3Ch
		idiv	ebx
		add	[esi+8], eax
		mov	[esi+4], edx
		cmp	edx, edi
		jge	short loc_10011D77
		add	edx, ebx
		add	[esi+8], ecx
		mov	[esi+4], edx

loc_10011D77:				; CODE XREF: PR_NormalizeTime+4Bj
					; PR_NormalizeTime+5Dj
		mov	eax, [esi+8]
		cmp	eax, edi
		jl	short loc_10011D83
		cmp	eax, 3Ch
		jl	short loc_10011D9D

loc_10011D83:				; CODE XREF: PR_NormalizeTime+6Cj
		cdq
		mov	ebx, 3Ch
		idiv	ebx
		add	[esi+0Ch], eax
		mov	[esi+8], edx
		cmp	edx, edi
		jge	short loc_10011D9D
		add	edx, ebx
		add	[esi+0Ch], ecx
		mov	[esi+8], edx

loc_10011D9D:				; CODE XREF: PR_NormalizeTime+71j
					; PR_NormalizeTime+83j
		mov	eax, [esi+0Ch]
		cmp	eax, edi
		jl	short loc_10011DA9
		cmp	eax, 18h
		jl	short loc_10011DC3

loc_10011DA9:				; CODE XREF: PR_NormalizeTime+92j
		cdq
		mov	ebx, 18h
		idiv	ebx
		add	[esi+10h], eax
		mov	[esi+0Ch], edx
		cmp	edx, edi
		jge	short loc_10011DC3
		add	edx, ebx
		add	[esi+10h], ecx
		mov	[esi+0Ch], edx

loc_10011DC3:				; CODE XREF: PR_NormalizeTime+97j
					; PR_NormalizeTime+A9j
		mov	eax, [esi+14h]
		cmp	eax, edi
		jl	short loc_10011DCF
		cmp	eax, 0Ch
		jl	short loc_10011DEB

loc_10011DCF:				; CODE XREF: PR_NormalizeTime+B8j
		cdq
		mov	ebx, 0Ch
		idiv	ebx
		add	[esi+18h], ax
		mov	[esi+14h], edx
		cmp	edx, edi
		jge	short loc_10011DEB
		add	edx, ebx
		add	[esi+18h], cx
		mov	[esi+14h], edx

loc_10011DEB:				; CODE XREF: PR_NormalizeTime+BDj
					; PR_NormalizeTime+D0j
		mov	ebp, [esi+10h]
		cmp	ebp, 1
		jge	short loc_10011E6E
		movzx	eax, word ptr [esi+18h]
		mov	ecx, [esi+14h]
		mov	[esp+10h+arg_0], eax
		jmp	short loc_10011E04
; ---------------------------------------------------------------------------

loc_10011E00:				; CODE XREF: PR_NormalizeTime+157j
		mov	eax, [esp+10h+arg_0]

loc_10011E04:				; CODE XREF: PR_NormalizeTime+EEj
		dec	ecx
		mov	[esi+14h], ecx
		jns	short loc_10011E1B
		dec	eax
		mov	ecx, 0Bh
		mov	[esi+14h], ecx
		mov	[esp+10h+arg_0], eax
		mov	[esi+18h], ax

loc_10011E1B:				; CODE XREF: PR_NormalizeTime+F8j
		movsx	edi, ax
		mov	edx, edi
		and	edx, 80000003h
		jns	short loc_10011E2D
		dec	edx
		or	edx, 0FFFFFFFCh
		inc	edx

loc_10011E2D:				; CODE XREF: PR_NormalizeTime+116j
		jnz	short loc_10011E3D
		mov	eax, edi
		cdq
		mov	ebx, 64h
		idiv	ebx
		test	edx, edx
		jnz	short loc_10011E4B

loc_10011E3D:				; CODE XREF: PR_NormalizeTime:loc_10011E2Dj
		mov	eax, edi
		cdq
		mov	edi, 190h
		idiv	edi
		test	edx, edx
		jnz	short loc_10011E52

loc_10011E4B:				; CODE XREF: PR_NormalizeTime+12Bj
		mov	eax, 1
		jmp	short loc_10011E54
; ---------------------------------------------------------------------------

loc_10011E52:				; CODE XREF: PR_NormalizeTime+139j
		xor	eax, eax

loc_10011E54:				; CODE XREF: PR_NormalizeTime+140j
		lea	eax, [eax+eax*2]
		movsx	edx, ds:byte_1002AEF8[ecx+eax*4]
		add	ebp, edx
		mov	[esi+10h], ebp
		cmp	ebp, 1
		jl	short loc_10011E00
		jmp	loc_10011F28
; ---------------------------------------------------------------------------

loc_10011E6E:				; CODE XREF: PR_NormalizeTime+E1j
		movzx	edi, word ptr [esi+18h]
		movsx	ecx, di
		mov	eax, ecx
		and	eax, 80000003h
		jns	short loc_10011E83
		dec	eax
		or	eax, 0FFFFFFFCh
		inc	eax

loc_10011E83:				; CODE XREF: PR_NormalizeTime+16Cj
		jnz	short loc_10011E93
		mov	eax, ecx
		cdq
		mov	ebx, 64h
		idiv	ebx
		test	edx, edx
		jnz	short loc_10011EA1

loc_10011E93:				; CODE XREF: PR_NormalizeTime:loc_10011E83j
		mov	eax, ecx
		cdq
		mov	ecx, 190h
		idiv	ecx
		test	edx, edx
		jnz	short loc_10011EA8

loc_10011EA1:				; CODE XREF: PR_NormalizeTime+181j
		mov	eax, 1
		jmp	short loc_10011EAA
; ---------------------------------------------------------------------------

loc_10011EA8:				; CODE XREF: PR_NormalizeTime+18Fj
		xor	eax, eax

loc_10011EAA:				; CODE XREF: PR_NormalizeTime+196j
		mov	ecx, [esi+14h]
		lea	edx, [eax+eax*2]
		movsx	eax, ds:byte_1002AEF8[ecx+edx*4]
		cmp	ebp, eax
		jle	short loc_10011F28
		mov	ebx, edi
		jmp	short loc_10011EC4
; ---------------------------------------------------------------------------

loc_10011EC0:				; CODE XREF: PR_NormalizeTime+216j
		mov	ebp, [esp+10h+arg_0]

loc_10011EC4:				; CODE XREF: PR_NormalizeTime+1AEj
		sub	ebp, eax
		inc	ecx
		mov	[esp+10h+arg_0], ebp
		mov	[esi+10h], ebp
		mov	[esi+14h], ecx
		cmp	ecx, 0Bh
		jle	short loc_10011EE0
		xor	ecx, ecx
		inc	ebx
		mov	[esi+14h], ecx
		mov	[esi+18h], bx

loc_10011EE0:				; CODE XREF: PR_NormalizeTime+1C4j
		movsx	edi, bx
		mov	eax, edi
		and	eax, 80000003h
		jns	short loc_10011EF1
		dec	eax
		or	eax, 0FFFFFFFCh
		inc	eax

loc_10011EF1:				; CODE XREF: PR_NormalizeTime+1DAj
		jnz	short loc_10011F01
		mov	eax, edi
		cdq
		mov	ebp, 64h
		idiv	ebp
		test	edx, edx
		jnz	short loc_10011F0F

loc_10011F01:				; CODE XREF: PR_NormalizeTime:loc_10011EF1j
		mov	eax, edi
		cdq
		mov	edi, 190h
		idiv	edi
		test	edx, edx
		jnz	short loc_10011F16

loc_10011F0F:				; CODE XREF: PR_NormalizeTime+1EFj
		mov	eax, 1
		jmp	short loc_10011F18
; ---------------------------------------------------------------------------

loc_10011F16:				; CODE XREF: PR_NormalizeTime+1FDj
		xor	eax, eax

loc_10011F18:				; CODE XREF: PR_NormalizeTime+204j
		lea	edx, [eax+eax*2]
		movsx	eax, ds:byte_1002AEF8[ecx+edx*4]
		cmp	[esi+10h], eax
		jg	short loc_10011EC0

loc_10011F28:				; CODE XREF: PR_NormalizeTime+159j
					; PR_NormalizeTime+1AAj
		movzx	edi, word ptr [esi+18h]
		movsx	ecx, di
		mov	eax, ecx
		and	eax, 80000003h
		jns	short loc_10011F3D
		dec	eax
		or	eax, 0FFFFFFFCh
		inc	eax

loc_10011F3D:				; CODE XREF: PR_NormalizeTime+226j
		jnz	short loc_10011F4D
		mov	eax, ecx
		cdq
		mov	ebx, 64h
		idiv	ebx
		test	edx, edx
		jnz	short loc_10011F5B

loc_10011F4D:				; CODE XREF: PR_NormalizeTime:loc_10011F3Dj
		mov	eax, ecx
		cdq
		mov	ecx, 190h
		idiv	ecx
		test	edx, edx
		jnz	short loc_10011F62

loc_10011F5B:				; CODE XREF: PR_NormalizeTime+23Bj
		mov	eax, 1
		jmp	short loc_10011F64
; ---------------------------------------------------------------------------

loc_10011F62:				; CODE XREF: PR_NormalizeTime+249j
		xor	eax, eax

loc_10011F64:				; CODE XREF: PR_NormalizeTime+250j
		imul	eax, 0Dh
		add	eax, [esi+14h]
		movsx	edi, di
		mov	cx, word ptr ds:dword_1002AE90[eax*4]
		lea	ebp, [edi-1]
		imul	edi, 16Dh
		mov	eax, 51EB851Fh
		imul	ebp
		sar	edx, 7
		mov	ebx, edx
		add	cx, [esi+10h]
		shr	ebx, 1Fh
		add	ebx, edx
		mov	eax, 51EB851Fh
		imul	ebp
		sar	edx, 5
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		add	ebx, edi
		sub	ebx, eax
		mov	eax, ebp
		cdq
		and	edx, 3
		add	eax, edx
		sar	eax, 2
		mov	[esi+1Ch], cx
		add	ebx, eax
		movsx	ecx, cx
		lea	eax, [ebx+ecx-0AFAA3h]
		cdq
		mov	ecx, 7
		idiv	ecx
		mov	[esi+1Ah], dl
		test	dl, dl
		jns	short loc_10011FD7
		add	dl, cl
		mov	[esi+1Ah], dl

loc_10011FD7:				; CODE XREF: PR_NormalizeTime+2C0j
		push	esi
		call	[esp+14h+arg_4]
		mov	[esi+20h], eax
		add	esp, 4
		lea	eax, [edx+eax]
		mov	[esi+24h], edx
		call	sub_10011B70
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
PR_NormalizeTime endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10012000(time_t *Time, int)
sub_10012000	proc near		; CODE XREF: PR_LocalTimeParameters+FEp
					; PR_ParseTimeStringToExplodedTime+F56p

Time		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_4]
		call	PR_Initialized
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_1001201F
		mov	eax, dword_10031594
		push	eax
		call	PR_Lock
		add	esp, 4

loc_1001201F:				; CODE XREF: sub_10012000+Fj
		mov	ecx, [esp+8+Time]
		push	ecx		; Time
		call	ds:localtime
		add	esp, 4
		test	eax, eax
		jz	short loc_10012042
		push	esi
		push	edi
		mov	ecx, 9
		mov	esi, eax
		mov	edi, ebp
		rep movsd
		pop	edi
		pop	esi
		jmp	short loc_10012044
; ---------------------------------------------------------------------------

loc_10012042:				; CODE XREF: sub_10012000+2Fj
		xor	ebp, ebp

loc_10012044:				; CODE XREF: sub_10012000+40j
		test	ebx, ebx
		jz	short loc_10012057
		mov	edx, dword_10031594
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_10012057:				; CODE XREF: sub_10012000+46j
		mov	eax, ebp
		pop	ebp
		pop	ebx
		retn
sub_10012000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012060	proc near		; CODE XREF: PR_Init_0+11Cp
		call	PR_NewLock
		mov	dword_10031594,	eax
		retn
sub_10012060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012070	proc near		; CODE XREF: PR_Cleanup+AAp
		mov	eax, dword_10031594
		test	eax, eax
		jz	short locret_1001208C
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10031594,	0

locret_1001208C:			; CODE XREF: sub_10012070+7j
		retn
sub_10012070	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012090	proc near		; CODE XREF: PR_USPacificTimeParameters+118p

arg_0		= dword	ptr  4

		sub	eax, [esp+arg_0]
		push	esi
		add	eax, 6
		push	edi
		mov	edi, edx
		cdq
		mov	esi, 7
		idiv	esi
		lea	esi, [edx+1]
		test	ecx, ecx
		jns	short loc_100120C1
		sub	edi, esi
		mov	ecx, edi
		mov	eax, 92492493h
		imul	ecx
		add	edx, ecx
		sar	edx, 2
		mov	ecx, edx
		shr	ecx, 1Fh
		add	ecx, edx

loc_100120C1:				; CODE XREF: sub_10012090+18j
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		pop	edi
		add	eax, esi
		pop	esi
		retn
sub_10012090	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 363. PR_USPacificTimeParameters

; =============== S U B	R O U T	I N E =======================================


		public PR_USPacificTimeParameters
PR_USPacificTimeParameters proc	near	; DATA XREF: .rdata:off_1002C7C8o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= word ptr -10h
var_E		= byte ptr -0Eh
var_C		= word ptr -0Ch
arg_0		= dword	ptr  4

		sub	esp, 28h
		mov	eax, [esp+28h+arg_0]
		mov	ecx, [eax]
		mov	edx, [eax+4]
		mov	[esp+28h+var_28], ecx
		mov	ecx, [eax+8]
		mov	[esp+28h+var_24], edx
		mov	edx, [eax+0Ch]
		mov	[esp+28h+var_20], ecx
		mov	ecx, [eax+10h]
		mov	[esp+28h+var_1C], edx
		mov	edx, [eax+14h]
		push	ebx
		push	ebp
		mov	[esp+30h+var_18], ecx
		mov	cx, [eax+18h]
		mov	[esp+30h+var_14], edx
		mov	dl, [eax+1Ah]
		mov	ax, [eax+1Ch]
		push	esi
		mov	ebp, 0FFFF8F80h
		mov	[esp+34h+var_C], ax
		push	edi
		mov	eax, ebp
		lea	esi, [esp+38h+var_28]
		mov	[esp+38h+var_10], cx
		mov	[esp+38h+var_E], dl
		call	sub_10011B70
		mov	ecx, 7D7h
		mov	edi, offset dword_1002AF10
		cmp	[esp+38h+var_10], cx
		jl	short loc_10012142
		mov	edi, offset word_1002AF16

loc_10012142:				; CODE XREF: PR_USPacificTimeParameters+6Bj
		movsx	ecx, byte ptr [edi]
		mov	eax, [esp+38h+var_14]
		cmp	eax, ecx
		jl	loc_10012211
		jnz	short loc_100121BB
		movsx	edx, [esp+38h+var_E]
		mov	ebx, [esp+38h+var_18]
		mov	eax, ebx
		sub	eax, edx
		add	eax, 6
		cdq
		mov	esi, 7
		idiv	esi
		movsx	ecx, byte ptr [edi+1]
		lea	esi, [edx+1]
		test	ecx, ecx
		jns	short loc_1001218F
		movsx	ecx, byte ptr [edi+2]
		sub	ecx, esi
		mov	eax, 92492493h
		imul	ecx
		add	edx, ecx
		sar	edx, 2
		mov	ecx, edx
		shr	ecx, 1Fh
		add	ecx, edx

loc_1001218F:				; CODE XREF: PR_USPacificTimeParameters+A4j
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		add	eax, esi
		cmp	ebx, eax
		jl	short loc_10012211
		jnz	short loc_100121C3
		xor	edx, edx
		cmp	[esp+38h+var_1C], 2
		pop	edi
		setl	dl
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		dec	edx
		and	edx, 0E10h
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_100121BB:				; CODE XREF: PR_USPacificTimeParameters+81j
		movsx	ecx, byte ptr [edi+3]
		cmp	eax, ecx
		jge	short loc_100121D2

loc_100121C3:				; CODE XREF: PR_USPacificTimeParameters+CEj
					; PR_USPacificTimeParameters+122j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		mov	edx, 0E10h
		pop	ebx
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_100121D2:				; CODE XREF: PR_USPacificTimeParameters+F1j
		jnz	short loc_10012211
		movsx	eax, [esp+38h+var_E]
		movsx	edx, byte ptr [edi+5]
		movsx	ecx, byte ptr [edi+4]
		mov	esi, [esp+38h+var_18]
		push	eax
		mov	eax, esi
		call	sub_10012090
		add	esp, 4
		cmp	esi, eax
		jl	short loc_100121C3
		jnz	short loc_10012211
		xor	edx, edx
		cmp	[esp+38h+var_1C], 1
		pop	edi
		setnl	dl
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		dec	edx
		and	edx, 0E10h
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10012211:				; CODE XREF: PR_USPacificTimeParameters+7Bj
					; PR_USPacificTimeParameters+CCj ...
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		xor	edx, edx
		pop	ebx
		add	esp, 28h
		retn
PR_USPacificTimeParameters endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 138. PR_GMTParameters

; =============== S U B	R O U T	I N E =======================================


		public PR_GMTParameters
PR_GMTParameters proc near		; DATA XREF: PR_LogPrint+3Do
					; PR_ImplodeTime+18o ...
		xor	eax, eax
		xor	edx, edx
		retn
PR_GMTParameters endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 132. PR_FormatTime

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_FormatTime(char *Buf, size_t SizeInBytes, char	*Format, int)
		public PR_FormatTime
PR_FormatTime	proc near		; CODE XREF: PR_FormatTimeUSEnglish+4E9p
					; DATA XREF: .rdata:off_1002C7C8o

Tm		= tm ptr -28h
var_4		= dword	ptr -4
Buf		= dword	ptr  4
SizeInBytes	= dword	ptr  8
Format		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 28h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_4], eax
		mov	eax, [esp+28h+arg_C]
		push	esi
		mov	esi, [esp+2Ch+Buf]
		push	edi
		mov	edi, [esp+30h+Format]
		test	eax, eax
		jz	short loc_100122A3
		mov	edx, [eax+4]
		mov	[esp+30h+Tm.tm_sec], edx
		mov	edx, [eax+8]
		mov	[esp+30h+Tm.tm_min], edx
		mov	edx, [eax+0Ch]
		mov	[esp+30h+Tm.tm_hour], edx
		mov	edx, [eax+10h]
		mov	[esp+30h+Tm.tm_mday], edx
		mov	edx, [eax+14h]
		mov	[esp+30h+Tm.tm_mon], edx
		movsx	edx, byte ptr [eax+1Ah]
		mov	[esp+30h+Tm.tm_wday], edx
		movsx	edx, word ptr [eax+18h]
		sub	edx, 76Ch
		mov	[esp+30h+Tm.tm_year], edx
		movsx	edx, word ptr [eax+1Ch]
		mov	[esp+30h+Tm.tm_yday], edx
		xor	edx, edx
		cmp	[eax+24h], edx
		lea	ecx, [esp+30h+Tm]
		setnz	dl
		mov	[esp+30h+Tm.tm_isdst], edx
		jmp	short loc_100122A5
; ---------------------------------------------------------------------------

loc_100122A3:				; CODE XREF: PR_FormatTime+1Ej
		xor	ecx, ecx

loc_100122A5:				; CODE XREF: PR_FormatTime+71j
		push	ecx		; Tm
		push	edi		; Format
		mov	edi, [esp+38h+SizeInBytes]
		push	edi		; SizeInBytes
		push	esi		; Buf
		call	ds:strftime
		add	esp, 10h
		test	eax, eax
		jnz	short loc_100122C4
		test	esi, esi
		jz	short loc_100122C4
		test	edi, edi
		jle	short loc_100122C4
		mov	[esi], al

loc_100122C4:				; CODE XREF: PR_FormatTime+88j
					; PR_FormatTime+8Cj ...
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
PR_FormatTime	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100122E0	proc near		; CODE XREF: PR_FormatTimeUSEnglish+37Fp
					; PR_FormatTimeUSEnglish+3E0p

arg_0		= dword	ptr  4

		movsx	eax, byte ptr [ecx+1Ah]
		sub	eax, [esp+arg_0]
		jns	short loc_100122ED
		add	eax, 7

loc_100122ED:				; CODE XREF: sub_100122E0+8j
		push	esi
		movsx	esi, word ptr [ecx+1Ch]
		sub	esi, eax
		test	esi, esi
		jg	short loc_100122FC
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100122FC:				; CODE XREF: sub_100122E0+16j
		mov	eax, 92492493h
		imul	esi
		add	edx, esi
		sar	edx, 2
		mov	ecx, edx
		shr	ecx, 1Fh
		add	ecx, edx
		lea	edx, ds:0[ecx*8]
		sub	edx, ecx
		mov	eax, esi
		sub	eax, edx
		neg	eax
		sbb	eax, eax
		neg	eax
		add	eax, ecx
		pop	esi
		retn
sub_100122E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10012330	proc near		; CODE XREF: PR_ExplodeTime+Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	ebx
		push	ebp
		push	edi
		push	0
		push	0F4240h
		push	eax
		push	ecx
		call	sub_10026B60
		mov	[esp+0Ch+arg_4], ebx
		mov	[esi], ecx
		test	ecx, ecx
		jns	short loc_10012361
		add	eax, 0FFFFFFFFh
		adc	edx, 0FFFFFFFFh
		add	ecx, 0F4240h
		mov	[esi], ecx

loc_10012361:				; CODE XREF: sub_10012330+21j
		push	0
		push	15180h
		push	edx
		push	eax
		call	sub_10026B60
		mov	[esp+0Ch+arg_4], ebx
		xor	ebx, ebx
		mov	[esp+0Ch+arg_4], edx
		mov	edi, eax
		cmp	ecx, ebx
		jge	short loc_10012386
		dec	edi
		add	ecx, 15180h

loc_10012386:				; CODE XREF: sub_10012330+4Dj
		lea	eax, [edi+4]
		cdq
		mov	ebp, 7
		idiv	ebp
		mov	[esi+1Ah], dl
		cmp	dl, bl
		jge	short loc_1001239E
		add	dl, 7
		mov	[esi+1Ah], dl

loc_1001239E:				; CODE XREF: sub_10012330+66j
		mov	eax, 91A2B3C5h
		imul	ecx
		add	edx, ecx
		sar	edx, 0Bh
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		mov	[esi+0Ch], eax
		imul	eax, 0FFFFF1F0h
		add	ecx, eax
		mov	eax, 88888889h
		imul	ecx
		add	edx, ecx
		sar	edx, 5
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	[esi+8], eax
		add	edx, edx
		add	edx, edx
		sub	ecx, edx
		add	edi, 0AF93Ah
		mov	eax, 396B06BDh
		imul	edi
		sar	edx, 0Fh
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		mov	[esi+4], ecx
		mov	ecx, eax
		imul	eax, 190h
		imul	ecx, 23AB1h
		sub	edi, ecx
		mov	ecx, edi
		lea	edi, [eax+1]
		mov	eax, 0E5AC81FBh
		imul	ecx
		add	edx, ecx
		sar	edx, 0Fh
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		mov	edx, eax
		imul	edx, 0FFFF7154h
		add	ecx, edx
		mov	[esi+18h], di
		cmp	eax, 4
		jnz	short loc_1001243E
		mov	eax, 3
		mov	ecx, 8EACh

loc_1001243E:				; CODE XREF: sub_10012330+102j
		imul	eax, 64h
		add	eax, edi
		mov	[esi+18h], ax
		mov	eax, 166DB073h
		imul	ecx
		sar	edx, 7
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		mov	edx, eax
		imul	edx, 0FFFFFA4Bh
		add	eax, eax
		add	eax, eax
		add	[esi+18h], ax
		add	ecx, edx
		mov	eax, 0B38CF9B1h
		imul	ecx
		add	edx, ecx
		sar	edx, 8
		mov	eax, edx
		shr	eax, 1Fh
		add	eax, edx
		mov	edx, eax
		imul	edx, 0FFFFFE93h
		add	ecx, edx
		cmp	eax, 4
		jnz	short loc_10012496
		mov	eax, 3
		mov	ecx, 16Dh

loc_10012496:				; CODE XREF: sub_10012330+15Aj
		add	[esi+18h], ax
		movzx	eax, word ptr [esi+18h]
		movsx	edi, ax
		mov	eax, edi
		and	eax, 80000003h
		mov	[esi+1Ch], cx
		jns	short loc_100124B3
		dec	eax
		or	eax, 0FFFFFFFCh
		inc	eax

loc_100124B3:				; CODE XREF: sub_10012330+17Cj
		jnz	short loc_100124C3
		mov	eax, edi
		cdq
		mov	ebp, 64h
		idiv	ebp
		test	edx, edx
		jnz	short loc_100124D1

loc_100124C3:				; CODE XREF: sub_10012330:loc_100124B3j
		mov	eax, edi
		cdq
		mov	edi, 190h
		idiv	edi
		test	edx, edx
		jnz	short loc_100124D8

loc_100124D1:				; CODE XREF: sub_10012330+191j
		mov	edx, 1
		jmp	short loc_100124DA
; ---------------------------------------------------------------------------

loc_100124D8:				; CODE XREF: sub_10012330+19Fj
		xor	edx, edx

loc_100124DA:				; CODE XREF: sub_10012330+1A6j
		mov	edi, edx
		imul	edi, 0Dh
		movsx	ecx, cx
		mov	eax, 1
		cmp	ds:dword_1002AE94[edi*4], ecx
		jge	short loc_10012508
		movsx	ebp, word ptr [esi+1Ch]
		imul	edx, 34h
		add	edx, offset dword_1002AE94
		lea	ecx, [ecx+0]

loc_10012500:				; CODE XREF: sub_10012330+1D6j
		add	edx, 4
		inc	eax
		cmp	[edx], ebp
		jl	short loc_10012500

loc_10012508:				; CODE XREF: sub_10012330+1BEj
		dec	eax
		add	edi, eax
		mov	[esi+14h], eax
		sub	ecx, ds:dword_1002AE90[edi*4]
		pop	edi
		pop	ebp
		mov	[esi+20h], ebx
		mov	[esi+24h], ebx
		mov	[esi+10h], ecx
		pop	ebx
		retn
sub_10012330	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 113. PR_ExplodeTime

; =============== S U B	R O U T	I N E =======================================


		public PR_ExplodeTime
PR_ExplodeTime	proc near		; CODE XREF: PR_LogPrint+49p
					; PR_ParseTimeStringToExplodedTime+F27p
					; DATA XREF: ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	esi
		mov	esi, [esp+4+arg_C]
		push	eax
		push	ecx
		call	sub_10012330
		push	esi
		call	[esp+10h+arg_8]
		mov	[esi+20h], eax
		mov	eax, edx
		add	eax, [esi+20h]
		add	esp, 0Ch
		mov	[esi+24h], edx
		call	sub_10011B70
		pop	esi
		retn
PR_ExplodeTime	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 207. PR_ImplodeTime

; =============== S U B	R O U T	I N E =======================================


		public PR_ImplodeTime
PR_ImplodeTime	proc near		; CODE XREF: PR_LocalTimeParameters+99p
					; PR_ParseTimeString+33p
					; DATA XREF: ...

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= word ptr -14h
var_10		= word ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		push	esi
		mov	esi, [esp+30h+arg_0]
		push	edi
		lea	eax, [esp+34h+var_2C]
		push	offset PR_GMTParameters
		mov	ecx, 0Ah
		lea	edi, [esp+38h+var_2C]
		push	eax
		rep movsd
		call	PR_NormalizeTime
		movsx	ecx, [esp+3Ch+var_14]
		lea	esi, [ecx-1]
		imul	ecx, 16Dh
		mov	eax, 51EB851Fh
		imul	esi
		sar	edx, 7
		mov	edi, edx
		shr	edi, 1Fh
		add	edi, edx
		mov	eax, 51EB851Fh
		imul	esi
		sar	edx, 5
		add	edi, ecx
		mov	ecx, edx
		shr	ecx, 1Fh
		add	ecx, edx
		mov	eax, esi
		cdq
		and	edx, 3
		add	eax, edx
		add	esp, 8
		sar	eax, 2
		sub	edi, ecx
		push	0
		lea	eax, [edi+eax-0AFAA7h]
		cdq
		push	15180h
		push	edx
		push	eax
		call	sub_10026AB0
		mov	ecx, eax
		movsx	eax, [esp+34h+var_10]
		mov	esi, edx
		lea	edx, [eax+eax*2]
		mov	eax, [esp+34h+var_20]
		lea	eax, [eax+edx*8]
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, [esp+34h+var_24]
		lea	eax, [eax+edx*4]
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, [esp+34h+var_28]
		lea	eax, [eax+edx*4]
		cdq
		add	ecx, eax
		mov	eax, [esp+34h+var_8]
		adc	esi, edx
		cdq
		sub	ecx, eax
		mov	eax, [esp+34h+var_C]
		sbb	esi, edx
		cdq
		push	0
		sub	ecx, eax
		push	0F4240h
		sbb	esi, edx
		push	esi
		push	ecx
		call	sub_10026AB0
		mov	ecx, eax
		mov	eax, [esp+34h+var_2C]
		mov	esi, edx
		cdq
		add	eax, ecx
		mov	ecx, [esp+34h+var_4]
		pop	edi
		adc	edx, esi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
PR_ImplodeTime	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 232. PR_LocalTimeParameters

; =============== S U B	R O U T	I N E =======================================


		public PR_LocalTimeParameters
PR_LocalTimeParameters proc near	; DATA XREF: PR_ParseTimeStringToExplodedTime+F11o
					; .rdata:off_1002C7C8o

Time		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		push	ebx
		mov	ebx, [esp+30h+arg_0]
		push	ebp
		push	esi
		push	edi
		mov	[esp+3Ch+Time],	15180h
		call	PR_Initialized
		mov	ebp, eax
		test	ebp, ebp
		jz	short loc_10012697
		mov	eax, dword_10031594
		push	eax
		call	PR_Lock
		add	esp, 4

loc_10012697:				; CODE XREF: PR_LocalTimeParameters+27j
		lea	ecx, [esp+3Ch+Time]
		push	ecx		; Time
		call	ds:localtime
		add	esp, 4
		test	eax, eax
		jz	short loc_100126B6
		mov	ecx, 9
		mov	esi, eax
		lea	edi, [esp+3Ch+var_28]
		rep movsd

loc_100126B6:				; CODE XREF: PR_LocalTimeParameters+47j
		test	ebp, ebp
		jz	short loc_100126C9
		mov	edx, dword_10031594
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_100126C9:				; CODE XREF: PR_LocalTimeParameters+58j
		mov	eax, [esp+3Ch+var_1C]
		mov	ecx, [esp+3Ch+var_20]
		mov	edi, [esp+3Ch+var_8]
		lea	eax, [eax+eax*2-6]
		lea	eax, [ecx+eax*8]
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, [esp+3Ch+var_24]
		lea	eax, [eax+edx*4]
		mov	edx, [esp+3Ch+var_28]
		mov	ecx, eax
		shl	ecx, 4
		sub	ecx, eax
		push	ebx
		lea	esi, [edx+ecx*4]
		call	PR_ImplodeTime
		add	esp, 4
		test	edx, edx
		jl	short loc_10012716
		jg	short loc_1001270B
		test	eax, eax
		jb	short loc_10012716

loc_1001270B:				; CODE XREF: PR_LocalTimeParameters+A5j
		push	0
		push	0F4240h
		push	edx
		push	eax
		jmp	short loc_1001272D
; ---------------------------------------------------------------------------

loc_10012716:				; CODE XREF: PR_LocalTimeParameters+A3j
					; PR_LocalTimeParameters+A9j
		mov	ecx, 0F423Fh
		sub	ecx, eax
		push	0FFFFFFFFh
		mov	eax, 0
		push	0FFF0BDC0h
		sbb	eax, edx
		push	eax
		push	ecx

loc_1001272D:				; CODE XREF: PR_LocalTimeParameters+B4j
		call	sub_10026C40
		mov	ecx, eax
		add	ecx, 80000000h
		adc	edx, 0
		test	edx, edx
		ja	loc_1001281E
		jb	short loc_10012750
		cmp	ecx, 0FFFFFFFFh
		ja	loc_1001281E

loc_10012750:				; CODE XREF: PR_LocalTimeParameters+E5j
		lea	ecx, [esp+3Ch+var_28]
		push	ecx		; int
		lea	edx, [esp+40h+Time]
		push	edx		; Time
		mov	[esp+44h+Time],	eax
		call	sub_10012000
		add	esp, 8
		test	eax, eax
		jz	loc_1001281E
		movsx	ecx, byte ptr [ebx+1Ah]
		mov	eax, [esp+3Ch+var_10]
		sub	eax, ecx
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_10012784
		mov	eax, 1
		jmp	short loc_1001278C
; ---------------------------------------------------------------------------

loc_10012784:				; CODE XREF: PR_LocalTimeParameters+11Bj
		cmp	eax, 6
		jnz	short loc_1001278C
		or	eax, 0FFFFFFFFh

loc_1001278C:				; CODE XREF: PR_LocalTimeParameters+122j
					; PR_LocalTimeParameters+127j
		lea	eax, [eax+eax*2]
		add	eax, eax
		add	eax, eax
		add	eax, eax
		sub	eax, [ebx+0Ch]
		add	eax, [esp+3Ch+var_20]
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		add	edx, edx
		lea	eax, [edx+edx]
		sub	eax, [ebx+8]
		add	eax, [esp+3Ch+var_24]
		mov	ecx, eax
		shl	ecx, 4
		sub	ecx, eax
		add	ecx, ecx
		add	ecx, ecx
		sub	ecx, [ebx+4]
		add	ecx, [esp+3Ch+var_28]
		cmp	[esp+3Ch+var_8], 0
		jg	short loc_100127E1
		pop	edi
		pop	esi
		mov	eax, ecx
		xor	ecx, ecx
		pop	ebp
		mov	edx, ecx
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_100127E1:				; CODE XREF: PR_LocalTimeParameters+166j
		test	edi, edi
		jg	short loc_100127FE
		pop	edi
		sub	ecx, esi
		mov	eax, esi
		pop	esi
		pop	ebp
		mov	edx, ecx
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_100127FE:				; CODE XREF: PR_LocalTimeParameters+183j
		pop	edi
		pop	esi
		lea	eax, [ecx-0E10h]
		mov	ecx, 0E10h
		pop	ebp
		mov	edx, ecx
		pop	ebx
		mov	ecx, [esp+2Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_1001281E:				; CODE XREF: PR_LocalTimeParameters+DFj
					; PR_LocalTimeParameters+EAj ...
		mov	ecx, [esp+3Ch+var_4]
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	edx, edx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
PR_LocalTimeParameters endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 279. PR_ParseTimeStringToExplodedTime

; =============== S U B	R O U T	I N E =======================================


		public PR_ParseTimeStringToExplodedTime
PR_ParseTimeStringToExplodedTime proc near ; CODE XREF:	PR_ParseTimeString+22p
					; DATA XREF: .rdata:off_1002C7C8o

var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
Time		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
Tm		= tm ptr -28h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 60h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+60h+var_4], eax
		mov	ecx, [esp+60h+arg_8]
		push	ebx
		or	eax, 0FFFFFFFFh
		push	ebp
		xor	ebx, ebx
		push	esi
		mov	esi, [esp+6Ch+arg_0]
		xor	ebp, ebp
		mov	[esp+6Ch+var_2C], esi
		mov	[esp+6Ch+Time],	ecx
		mov	[esp+6Ch+var_50], ebp
		mov	[esp+6Ch+var_58], ebx
		mov	[esp+6Ch+var_60], ebx
		mov	[esp+6Ch+var_5C], eax
		mov	[esp+6Ch+var_48], ebx
		mov	[esp+6Ch+var_4C], eax
		mov	[esp+6Ch+var_54], eax
		mov	[esp+6Ch+var_38], eax
		mov	[esp+6Ch+var_3C], eax
		mov	[esp+6Ch+var_34], eax
		mov	[esp+6Ch+var_30], ebx
		cmp	esi, ebx
		jz	short loc_100128A5
		cmp	ecx, ebx
		jz	short loc_100128A5
		push	edi
		cmp	[esi], bl
		jnz	short loc_100128C4

loc_100128A1:				; CODE XREF: PR_ParseTimeStringToExplodedTime+95j
					; PR_ParseTimeStringToExplodedTime+DF5j ...
		or	eax, 0FFFFFFFFh
		pop	edi

loc_100128A5:				; CODE XREF: PR_ParseTimeStringToExplodedTime+56j
					; PR_ParseTimeStringToExplodedTime+5Aj
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------
		jmp	short loc_100128C0
; ---------------------------------------------------------------------------
		align 10h

loc_100128C0:				; CODE XREF: PR_ParseTimeStringToExplodedTime+77j
					; PR_ParseTimeStringToExplodedTime+D01j
		mov	ebp, [esp+70h+var_50]

loc_100128C4:				; CODE XREF: PR_ParseTimeStringToExplodedTime+5Fj
		mov	eax, [esp+70h+var_30]
		mov	ecx, eax
		inc	eax
		mov	[esp+70h+var_30], eax
		cmp	ecx, 3E8h
		jg	short loc_100128A1
		mov	al, [esi]
		movsx	edi, al
		lea	ecx, [edi-2Bh]	; switch 77 cases
		cmp	ecx, 4Ch
		ja	loc_10013495	; jumptable 100128EF default case
		movzx	edx, ds:byte_1001383C[ecx]
		jmp	ds:off_100137F0[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100128F6:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebx, ebx	; jumptable 100128EF cases 65,97
		jnz	short loc_1001291E
		mov	al, [esi+1]
		cmp	al, 70h
		jz	short loc_10012905
		cmp	al, 50h
		jnz	short loc_1001291E

loc_10012905:				; CODE XREF: PR_ParseTimeStringToExplodedTime+BFj
		mov	al, [esi+2]
		cmp	al, 72h
		jz	short loc_10012910
		cmp	al, 52h
		jnz	short loc_1001291E

loc_10012910:				; CODE XREF: PR_ParseTimeStringToExplodedTime+CAj
		mov	ebx, 0Bh
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_1001291E:				; CODE XREF: PR_ParseTimeStringToExplodedTime+B8j
					; PR_ParseTimeStringToExplodedTime+C3j	...
		cmp	[esp+70h+var_60], 0
		jnz	short loc_10012948
		mov	al, [esi+1]
		cmp	al, 73h
		jz	short loc_10012930
		cmp	al, 53h
		jnz	short loc_10012948

loc_10012930:				; CODE XREF: PR_ParseTimeStringToExplodedTime+EAj
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_1001293B
		cmp	al, 54h
		jnz	short loc_10012948

loc_1001293B:				; CODE XREF: PR_ParseTimeStringToExplodedTime+F5j
		mov	[esp+70h+var_60], 1Ch
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012948:				; CODE XREF: PR_ParseTimeStringToExplodedTime+E3j
					; PR_ParseTimeStringToExplodedTime+EEj	...
		test	ebx, ebx
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 75h
		jz	short loc_1001295F
		cmp	al, 55h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_1001295F:				; CODE XREF: PR_ParseTimeStringToExplodedTime+115j
		mov	al, [esi+2]
		cmp	al, 67h
		jz	short loc_1001296E
		cmp	al, 47h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_1001296E:				; CODE XREF: PR_ParseTimeStringToExplodedTime+124j
		mov	ebx, 0Fh
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_1001297C:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		cmp	[esp+70h+var_60], 0 ; jumptable	100128EF cases 66,98
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 73h
		jz	short loc_10012996
		cmp	al, 53h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012996:				; CODE XREF: PR_ParseTimeStringToExplodedTime+14Cj
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_100129A5
		cmp	al, 54h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_100129A5:				; CODE XREF: PR_ParseTimeStringToExplodedTime+15Bj
		mov	[esp+70h+var_60], 1Fh
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_100129B2:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		cmp	[esp+70h+var_60], 0 ; jumptable	100128EF cases 67,99
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 64h
		jz	short loc_100129C8
		cmp	al, 44h
		jnz	short loc_100129E2

loc_100129C8:				; CODE XREF: PR_ParseTimeStringToExplodedTime+182j
		mov	cl, [esi+2]
		cmp	cl, 74h
		jz	short loc_100129D5
		cmp	cl, 54h
		jnz	short loc_100129E2

loc_100129D5:				; CODE XREF: PR_ParseTimeStringToExplodedTime+18Ej
		mov	[esp+70h+var_60], 19h
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_100129E2:				; CODE XREF: PR_ParseTimeStringToExplodedTime+186j
					; PR_ParseTimeStringToExplodedTime+193j
		cmp	al, 73h
		jz	short loc_100129EE
		cmp	al, 53h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_100129EE:				; CODE XREF: PR_ParseTimeStringToExplodedTime+1A4j
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_100129FD
		cmp	al, 54h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_100129FD:				; CODE XREF: PR_ParseTimeStringToExplodedTime+1B3j
		mov	[esp+70h+var_60], 18h
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012A0A:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebx, ebx	; jumptable 100128EF cases 68,100
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 65h
		jz	short loc_10012A21
		cmp	al, 45h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012A21:				; CODE XREF: PR_ParseTimeStringToExplodedTime+1D7j
		mov	al, [esi+2]
		cmp	al, 63h
		jz	short loc_10012A30
		cmp	al, 43h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012A30:				; CODE XREF: PR_ParseTimeStringToExplodedTime+1E6j
		mov	ebx, 13h
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012A3E:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		cmp	[esp+70h+var_60], 0 ; jumptable	100128EF cases 69,101
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 64h
		jz	short loc_10012A54
		cmp	al, 44h
		jnz	short loc_10012A6E

loc_10012A54:				; CODE XREF: PR_ParseTimeStringToExplodedTime+20Ej
		mov	cl, [esi+2]
		cmp	cl, 74h
		jz	short loc_10012A61
		cmp	cl, 54h
		jnz	short loc_10012A6E

loc_10012A61:				; CODE XREF: PR_ParseTimeStringToExplodedTime+21Aj
		mov	[esp+70h+var_60], 1Bh
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012A6E:				; CODE XREF: PR_ParseTimeStringToExplodedTime+212j
					; PR_ParseTimeStringToExplodedTime+21Fj
		cmp	al, 65h
		jz	short loc_10012A76
		cmp	al, 45h
		jnz	short loc_10012A90

loc_10012A76:				; CODE XREF: PR_ParseTimeStringToExplodedTime+230j
		mov	cl, [esi+2]
		cmp	cl, 74h
		jz	short loc_10012A83
		cmp	cl, 54h
		jnz	short loc_10012A90

loc_10012A83:				; CODE XREF: PR_ParseTimeStringToExplodedTime+23Cj
		mov	[esp+70h+var_60], 21h
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012A90:				; CODE XREF: PR_ParseTimeStringToExplodedTime+234j
					; PR_ParseTimeStringToExplodedTime+241j
		cmp	al, 73h
		jz	short loc_10012A9C
		cmp	al, 53h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012A9C:				; CODE XREF: PR_ParseTimeStringToExplodedTime+252j
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_10012AAB
		cmp	al, 54h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012AAB:				; CODE XREF: PR_ParseTimeStringToExplodedTime+261j
		mov	[esp+70h+var_60], 1Ah
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012AB8:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebx, ebx	; jumptable 100128EF cases 70,102
		jnz	short loc_10012AE0
		mov	al, [esi+1]
		cmp	al, 65h
		jz	short loc_10012AC7
		cmp	al, 45h
		jnz	short loc_10012AE0

loc_10012AC7:				; CODE XREF: PR_ParseTimeStringToExplodedTime+281j
		mov	al, [esi+2]
		cmp	al, 62h
		jz	short loc_10012AD2
		cmp	al, 42h
		jnz	short loc_10012AE0

loc_10012AD2:				; CODE XREF: PR_ParseTimeStringToExplodedTime+28Cj
		mov	ebx, 9
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012AE0:				; CODE XREF: PR_ParseTimeStringToExplodedTime+27Aj
					; PR_ParseTimeStringToExplodedTime+285j ...
		test	ebp, ebp
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 72h
		jz	short loc_10012AF7
		cmp	al, 52h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012AF7:				; CODE XREF: PR_ParseTimeStringToExplodedTime+2ADj
		mov	al, [esi+2]
		cmp	al, 69h
		jz	short loc_10012B06
		cmp	al, 49h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012B06:				; CODE XREF: PR_ParseTimeStringToExplodedTime+2BCj
		mov	[esp+70h+var_50], 6
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012B13:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		cmp	[esp+70h+var_60], 0 ; jumptable	100128EF cases 71,103
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 6Dh
		jz	short loc_10012B2D
		cmp	al, 4Dh
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012B2D:				; CODE XREF: PR_ParseTimeStringToExplodedTime+2E3j
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_10012B3C
		cmp	al, 54h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012B3C:				; CODE XREF: PR_ParseTimeStringToExplodedTime+2F2j
		mov	[esp+70h+var_60], 1Eh
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012B49:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebx, ebx	; jumptable 100128EF cases 74,106
		jnz	short loc_10012B71
		mov	al, [esi+1]
		cmp	al, 61h
		jz	short loc_10012B58
		cmp	al, 41h
		jnz	short loc_10012B71

loc_10012B58:				; CODE XREF: PR_ParseTimeStringToExplodedTime+312j
		mov	al, [esi+2]
		cmp	al, 6Eh
		jz	short loc_10012B63
		cmp	al, 4Eh
		jnz	short loc_10012B71

loc_10012B63:				; CODE XREF: PR_ParseTimeStringToExplodedTime+31Dj
		mov	ebx, 8
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012B71:				; CODE XREF: PR_ParseTimeStringToExplodedTime+30Bj
					; PR_ParseTimeStringToExplodedTime+316j ...
		cmp	[esp+70h+var_60], 0
		jnz	short loc_10012B9B
		mov	al, [esi+1]
		cmp	al, 73h
		jz	short loc_10012B83
		cmp	al, 53h
		jnz	short loc_10012B9B

loc_10012B83:				; CODE XREF: PR_ParseTimeStringToExplodedTime+33Dj
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_10012B8E
		cmp	al, 54h
		jnz	short loc_10012B9B

loc_10012B8E:				; CODE XREF: PR_ParseTimeStringToExplodedTime+348j
		mov	[esp+70h+var_60], 22h
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012B9B:				; CODE XREF: PR_ParseTimeStringToExplodedTime+336j
					; PR_ParseTimeStringToExplodedTime+341j ...
		test	ebx, ebx
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 75h
		jz	short loc_10012BAE
		cmp	al, 55h
		jnz	short loc_10012BC9

loc_10012BAE:				; CODE XREF: PR_ParseTimeStringToExplodedTime+368j
		mov	cl, [esi+2]
		cmp	cl, 6Ch
		jz	short loc_10012BBB
		cmp	cl, 4Ch
		jnz	short loc_10012BC9

loc_10012BBB:				; CODE XREF: PR_ParseTimeStringToExplodedTime+374j
		mov	ebx, 0Eh
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012BC9:				; CODE XREF: PR_ParseTimeStringToExplodedTime+36Cj
					; PR_ParseTimeStringToExplodedTime+379j
		cmp	al, 75h
		jz	short loc_10012BD5
		cmp	al, 55h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012BD5:				; CODE XREF: PR_ParseTimeStringToExplodedTime+38Bj
		mov	al, [esi+2]
		cmp	al, 6Eh
		jz	short loc_10012BE4
		cmp	al, 4Eh
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012BE4:				; CODE XREF: PR_ParseTimeStringToExplodedTime+39Aj
		mov	ebx, 0Dh
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012BF2:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebx, ebx	; jumptable 100128EF cases 77,109
		jnz	short loc_10012C3D
		mov	al, [esi+1]
		cmp	al, 61h
		jz	short loc_10012C01
		cmp	al, 41h
		jnz	short loc_10012C1C

loc_10012C01:				; CODE XREF: PR_ParseTimeStringToExplodedTime+3BBj
		mov	cl, [esi+2]
		cmp	cl, 72h
		jz	short loc_10012C0E
		cmp	cl, 52h
		jnz	short loc_10012C1C

loc_10012C0E:				; CODE XREF: PR_ParseTimeStringToExplodedTime+3C7j
		mov	ebx, 0Ah
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012C1C:				; CODE XREF: PR_ParseTimeStringToExplodedTime+3BFj
					; PR_ParseTimeStringToExplodedTime+3CCj
		cmp	al, 61h
		jz	short loc_10012C24
		cmp	al, 41h
		jnz	short loc_10012C3D

loc_10012C24:				; CODE XREF: PR_ParseTimeStringToExplodedTime+3DEj
		mov	al, [esi+2]
		cmp	al, 79h
		jz	short loc_10012C2F
		cmp	al, 59h
		jnz	short loc_10012C3D

loc_10012C2F:				; CODE XREF: PR_ParseTimeStringToExplodedTime+3E9j
		mov	ebx, 0Ch
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012C3D:				; CODE XREF: PR_ParseTimeStringToExplodedTime+3B4j
					; PR_ParseTimeStringToExplodedTime+3E2j ...
		mov	edx, [esp+70h+var_60]
		test	edx, edx
		jnz	short loc_10012C8A
		mov	al, [esi+1]
		cmp	al, 64h
		jz	short loc_10012C50
		cmp	al, 44h
		jnz	short loc_10012C6A

loc_10012C50:				; CODE XREF: PR_ParseTimeStringToExplodedTime+40Aj
		mov	cl, [esi+2]
		cmp	cl, 74h
		jz	short loc_10012C5D
		cmp	cl, 54h
		jnz	short loc_10012C6A

loc_10012C5D:				; CODE XREF: PR_ParseTimeStringToExplodedTime+416j
		mov	[esp+70h+var_60], 17h
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012C6A:				; CODE XREF: PR_ParseTimeStringToExplodedTime+40Ej
					; PR_ParseTimeStringToExplodedTime+41Bj
		cmp	al, 65h
		jz	short loc_10012C72
		cmp	al, 45h
		jnz	short loc_10012C8A

loc_10012C72:				; CODE XREF: PR_ParseTimeStringToExplodedTime+42Cj
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_10012C7D
		cmp	al, 54h
		jnz	short loc_10012C8A

loc_10012C7D:				; CODE XREF: PR_ParseTimeStringToExplodedTime+437j
		mov	[esp+70h+var_60], 20h
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012C8A:				; CODE XREF: PR_ParseTimeStringToExplodedTime+403j
					; PR_ParseTimeStringToExplodedTime+430j ...
		test	ebp, ebp
		jnz	short loc_10012CB1
		mov	al, [esi+1]
		cmp	al, 6Fh
		jz	short loc_10012C99
		cmp	al, 4Fh
		jnz	short loc_10012CB1

loc_10012C99:				; CODE XREF: PR_ParseTimeStringToExplodedTime+453j
		mov	al, [esi+2]
		cmp	al, 6Eh
		jz	short loc_10012CA4
		cmp	al, 4Eh
		jnz	short loc_10012CB1

loc_10012CA4:				; CODE XREF: PR_ParseTimeStringToExplodedTime+45Ej
		mov	[esp+70h+var_50], 2
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012CB1:				; CODE XREF: PR_ParseTimeStringToExplodedTime+44Cj
					; PR_ParseTimeStringToExplodedTime+457j ...
		test	edx, edx
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 73h
		jz	short loc_10012CC8
		cmp	al, 53h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012CC8:				; CODE XREF: PR_ParseTimeStringToExplodedTime+47Ej
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_10012CD7
		cmp	al, 54h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012CD7:				; CODE XREF: PR_ParseTimeStringToExplodedTime+48Dj
		mov	[esp+70h+var_60], 16h
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012CE4:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebx, ebx	; jumptable 100128EF cases 78,110
		jnz	short loc_10012D0C
		mov	al, [esi+1]
		cmp	al, 6Fh
		jz	short loc_10012CF3
		cmp	al, 4Fh
		jnz	short loc_10012D0C

loc_10012CF3:				; CODE XREF: PR_ParseTimeStringToExplodedTime+4ADj
		mov	al, [esi+2]
		cmp	al, 76h
		jz	short loc_10012CFE
		cmp	al, 56h
		jnz	short loc_10012D0C

loc_10012CFE:				; CODE XREF: PR_ParseTimeStringToExplodedTime+4B8j
		mov	ebx, 12h
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012D0C:				; CODE XREF: PR_ParseTimeStringToExplodedTime+4A6j
					; PR_ParseTimeStringToExplodedTime+4B1j ...
		cmp	[esp+70h+var_60], 0
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 73h
		jz	short loc_10012D26
		cmp	al, 53h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012D26:				; CODE XREF: PR_ParseTimeStringToExplodedTime+4DCj
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_10012D35
		cmp	al, 54h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012D35:				; CODE XREF: PR_ParseTimeStringToExplodedTime+4EBj
		mov	[esp+70h+var_60], 1Dh
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012D42:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebx, ebx	; jumptable 100128EF cases 79,111
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 63h
		jz	short loc_10012D59
		cmp	al, 43h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012D59:				; CODE XREF: PR_ParseTimeStringToExplodedTime+50Fj
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_10012D68
		cmp	al, 54h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012D68:				; CODE XREF: PR_ParseTimeStringToExplodedTime+51Ej
		mov	ebx, 11h
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012D76:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		cmp	[esp+70h+var_60], 0 ; jumptable	100128EF cases 80,112
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 64h
		jz	short loc_10012D8C
		cmp	al, 44h
		jnz	short loc_10012DA6

loc_10012D8C:				; CODE XREF: PR_ParseTimeStringToExplodedTime+546j
		mov	cl, [esi+2]
		cmp	cl, 74h
		jz	short loc_10012D99
		cmp	cl, 54h
		jnz	short loc_10012DA6

loc_10012D99:				; CODE XREF: PR_ParseTimeStringToExplodedTime+552j
		mov	[esp+70h+var_60], 15h
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012DA6:				; CODE XREF: PR_ParseTimeStringToExplodedTime+54Aj
					; PR_ParseTimeStringToExplodedTime+557j
		cmp	al, 73h
		jz	short loc_10012DB2
		cmp	al, 53h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012DB2:				; CODE XREF: PR_ParseTimeStringToExplodedTime+568j
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_10012DC1
		cmp	al, 54h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012DC1:				; CODE XREF: PR_ParseTimeStringToExplodedTime+577j
		mov	[esp+70h+var_60], 14h
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012DCE:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebp, ebp	; jumptable 100128EF cases 83,115
		jnz	short loc_10012DF5
		mov	al, [esi+1]
		cmp	al, 61h
		jz	short loc_10012DDD
		cmp	al, 41h
		jnz	short loc_10012DF5

loc_10012DDD:				; CODE XREF: PR_ParseTimeStringToExplodedTime+597j
		mov	al, [esi+2]
		cmp	al, 74h
		jz	short loc_10012DE8
		cmp	al, 54h
		jnz	short loc_10012DF5

loc_10012DE8:				; CODE XREF: PR_ParseTimeStringToExplodedTime+5A2j
		mov	[esp+70h+var_50], 7
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012DF5:				; CODE XREF: PR_ParseTimeStringToExplodedTime+590j
					; PR_ParseTimeStringToExplodedTime+59Bj ...
		test	ebx, ebx
		jnz	short loc_10012E1D
		mov	al, [esi+1]
		cmp	al, 65h
		jz	short loc_10012E04
		cmp	al, 45h
		jnz	short loc_10012E1D

loc_10012E04:				; CODE XREF: PR_ParseTimeStringToExplodedTime+5BEj
		mov	al, [esi+2]
		cmp	al, 70h
		jz	short loc_10012E0F
		cmp	al, 50h
		jnz	short loc_10012E1D

loc_10012E0F:				; CODE XREF: PR_ParseTimeStringToExplodedTime+5C9j
		mov	ebx, 10h
		mov	[esp+70h+var_58], ebx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012E1D:				; CODE XREF: PR_ParseTimeStringToExplodedTime+5B7j
					; PR_ParseTimeStringToExplodedTime+5C2j ...
		test	ebp, ebp
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 75h
		jz	short loc_10012E34
		cmp	al, 55h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012E34:				; CODE XREF: PR_ParseTimeStringToExplodedTime+5EAj
		mov	al, [esi+2]
		cmp	al, 6Eh
		jz	short loc_10012E43
		cmp	al, 4Eh
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012E43:				; CODE XREF: PR_ParseTimeStringToExplodedTime+5F9j
		mov	[esp+70h+var_50], 1
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012E50:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebp, ebp	; jumptable 100128EF cases 84,116
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 68h
		jz	short loc_10012E63
		cmp	al, 48h
		jnz	short loc_10012E7D

loc_10012E63:				; CODE XREF: PR_ParseTimeStringToExplodedTime+61Dj
		mov	cl, [esi+2]
		cmp	cl, 75h
		jz	short loc_10012E70
		cmp	cl, 55h
		jnz	short loc_10012E7D

loc_10012E70:				; CODE XREF: PR_ParseTimeStringToExplodedTime+629j
		mov	[esp+70h+var_50], 5
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012E7D:				; CODE XREF: PR_ParseTimeStringToExplodedTime+621j
					; PR_ParseTimeStringToExplodedTime+62Ej
		cmp	al, 75h
		jz	short loc_10012E89
		cmp	al, 55h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012E89:				; CODE XREF: PR_ParseTimeStringToExplodedTime+63Fj
		mov	al, [esi+2]
		cmp	al, 65h
		jz	short loc_10012E98
		cmp	al, 45h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012E98:				; CODE XREF: PR_ParseTimeStringToExplodedTime+64Ej
		mov	[esp+70h+var_50], 3
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012EA5:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		cmp	[esp+70h+var_60], 0 ; jumptable	100128EF cases 85,117
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 74h
		jz	short loc_10012EBF
		cmp	al, 54h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012EBF:				; CODE XREF: PR_ParseTimeStringToExplodedTime+675j
		mov	al, [esi+2]
		cmp	al, 41h
		jl	short loc_10012ECE
		cmp	al, 5Ah
		jle	loc_10013495	; jumptable 100128EF default case

loc_10012ECE:				; CODE XREF: PR_ParseTimeStringToExplodedTime+684j
		cmp	al, 61h
		jl	short loc_10012EDA
		cmp	al, 7Ah
		jle	loc_10013495	; jumptable 100128EF default case

loc_10012EDA:				; CODE XREF: PR_ParseTimeStringToExplodedTime+690j
		mov	[esp+70h+var_60], 1Eh
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012EE7:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		test	ebp, ebp	; jumptable 100128EF cases 87,119
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	al, [esi+1]
		cmp	al, 65h
		jz	short loc_10012EFE
		cmp	al, 45h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012EFE:				; CODE XREF: PR_ParseTimeStringToExplodedTime+6B4j
		mov	al, [esi+2]
		cmp	al, 64h
		jz	short loc_10012F0D
		cmp	al, 44h
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10012F0D:				; CODE XREF: PR_ParseTimeStringToExplodedTime+6C3j
		mov	[esp+70h+var_50], 4
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012F1A:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		cmp	[esp+70h+var_5C], 0FFFFFFFFh ; jumptable 100128EF cases	43,45
		jz	short loc_10012F27
		inc	esi
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012F27:				; CODE XREF: PR_ParseTimeStringToExplodedTime+6DFj
		mov	ecx, [esp+70h+var_60]
		test	ecx, ecx
		jz	short loc_10012F3A
		cmp	ecx, 1Eh
		jz	short loc_10012F3A
		inc	esi
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012F3A:				; CODE XREF: PR_ParseTimeStringToExplodedTime+6EDj
					; PR_ParseTimeStringToExplodedTime+6F2j
		mov	dl, [esi+1]
		xor	ecx, ecx
		cmp	al, 2Bh
		setz	cl
		inc	esi
		mov	eax, esi
		lea	ecx, [ecx+ecx-1]
		mov	edi, ecx
		cmp	dl, 30h
		jl	loc_10013495	; jumptable 100128EF default case
		mov	cl, dl

loc_10012F58:				; CODE XREF: PR_ParseTimeStringToExplodedTime+724j
		cmp	cl, 39h
		jg	short loc_10012F66
		mov	cl, [eax+1]
		inc	eax
		cmp	cl, 30h
		jge	short loc_10012F58

loc_10012F66:				; CODE XREF: PR_ParseTimeStringToExplodedTime+71Bj
		cmp	esi, eax
		jz	loc_10013495	; jumptable 100128EF default case
		sub	eax, esi
		cmp	eax, 4
		jnz	short loc_10012FAE
		movsx	eax, dl
		lea	edx, [eax+eax*4]
		movsx	eax, byte ptr [esi+1]
		lea	eax, [eax+edx*2]
		movsx	edx, byte ptr [esi+2]
		lea	ecx, [eax+eax*2]
		lea	eax, [edx+ecx*2]
		movsx	ecx, byte ptr [esi+3]
		lea	eax, [eax+eax*4]
		lea	eax, [ecx+eax*2-7DD0h]
		imul	edi, eax
		mov	[esp+70h+var_5C], edi
		mov	[esp+70h+var_60], 1Eh
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012FAE:				; CODE XREF: PR_ParseTimeStringToExplodedTime+733j
		cmp	eax, 2
		jnz	short loc_10012FC6
		movsx	eax, dl
		lea	edx, [eax+eax*4]
		movsx	eax, byte ptr [esi+1]
		lea	ecx, [eax+edx*2-210h]
		jmp	short loc_10012FD5
; ---------------------------------------------------------------------------

loc_10012FC6:				; CODE XREF: PR_ParseTimeStringToExplodedTime+771j
		cmp	eax, 1
		jnz	loc_10013495	; jumptable 100128EF default case
		movsx	ecx, dl
		sub	ecx, 30h

loc_10012FD5:				; CODE XREF: PR_ParseTimeStringToExplodedTime+784j
		mov	eax, ecx
		shl	eax, 4
		sub	eax, ecx
		add	eax, eax
		add	eax, eax
		imul	edi, eax
		mov	[esp+70h+var_5C], edi
		mov	[esp+70h+var_60], 1Eh
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10012FF4:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AFj
					; DATA XREF: .text:off_100137F0o
		mov	dl, [esi+1]	; jumptable 100128EF cases 48-57
		lea	ecx, [esi+1]
		mov	[esp+70h+var_40], 0FFFFFFFFh
		cmp	dl, 30h
		jl	short loc_10013015

loc_10013007:				; CODE XREF: PR_ParseTimeStringToExplodedTime+7D3j
		cmp	dl, 39h
		jg	short loc_10013015
		mov	dl, [ecx+1]
		inc	ecx
		cmp	dl, 30h
		jge	short loc_10013007

loc_10013015:				; CODE XREF: PR_ParseTimeStringToExplodedTime+7C5j
					; PR_ParseTimeStringToExplodedTime+7CAj
		mov	dl, [ecx]
		cmp	dl, 3Ah
		jnz	loc_10013199
		cmp	[esp+70h+var_38], 0
		jl	short loc_10013032
		cmp	[esp+70h+var_3C], 0
		jge	loc_10013495	; jumptable 100128EF default case

loc_10013032:				; CODE XREF: PR_ParseTimeStringToExplodedTime+7E5j
		mov	edx, ecx
		sub	edx, esi
		cmp	edx, 2
		jg	loc_10013495	; jumptable 100128EF default case
		jnz	short loc_10013051
		movsx	eax, byte ptr [esi+1]
		lea	edx, [edi+edi*4]
		lea	edi, [eax+edx*2-210h]
		jmp	short loc_10013054
; ---------------------------------------------------------------------------

loc_10013051:				; CODE XREF: PR_ParseTimeStringToExplodedTime+7FFj
		add	edi, 0FFFFFFD0h

loc_10013054:				; CODE XREF: PR_ParseTimeStringToExplodedTime+80Fj
		mov	al, [ecx+1]
		inc	ecx
		mov	esi, ecx
		cmp	al, 30h
		jl	loc_10013495	; jumptable 100128EF default case

loc_10013062:				; CODE XREF: PR_ParseTimeStringToExplodedTime+82Cj
		cmp	al, 39h
		jg	short loc_1001306E
		mov	al, [ecx+1]
		inc	ecx
		cmp	al, 30h
		jge	short loc_10013062

loc_1001306E:				; CODE XREF: PR_ParseTimeStringToExplodedTime+824j
		cmp	ecx, esi
		jz	loc_10013495	; jumptable 100128EF default case
		mov	eax, ecx
		sub	eax, esi
		cmp	eax, 2
		jg	loc_10013495	; jumptable 100128EF default case
		jnz	short loc_10013098
		movsx	eax, byte ptr [esi]
		lea	edx, [eax+eax*4]
		movsx	eax, byte ptr [esi+1]
		lea	ebp, [eax+edx*2-210h]
		jmp	short loc_1001309E
; ---------------------------------------------------------------------------

loc_10013098:				; CODE XREF: PR_ParseTimeStringToExplodedTime+843j
		movsx	ebp, byte ptr [esi]
		sub	ebp, 30h

loc_1001309E:				; CODE XREF: PR_ParseTimeStringToExplodedTime+856j
		cmp	byte ptr [ecx],	3Ah
		mov	esi, ecx
		jnz	short loc_100130A8
		lea	esi, [ecx+1]

loc_100130A8:				; CODE XREF: PR_ParseTimeStringToExplodedTime+863j
		mov	cl, [esi]
		mov	edx, esi
		cmp	cl, 30h
		jl	short loc_100130F0
		mov	al, cl

loc_100130B3:				; CODE XREF: PR_ParseTimeStringToExplodedTime+87Dj
		cmp	al, 39h
		jg	short loc_100130BF
		mov	al, [edx+1]
		inc	edx
		cmp	al, 30h
		jge	short loc_100130B3

loc_100130BF:				; CODE XREF: PR_ParseTimeStringToExplodedTime+875j
		cmp	edx, esi
		jz	short loc_100130F0
		mov	eax, edx
		sub	eax, esi
		cmp	eax, 2
		jg	loc_10013495	; jumptable 100128EF default case
		movsx	eax, cl
		jnz	short loc_100130E9
		lea	ecx, [eax+eax*4]
		movsx	eax, byte ptr [esi+1]
		lea	ecx, [eax+ecx*2-210h]
		mov	[esp+70h+var_40], ecx
		jmp	short loc_100130F0
; ---------------------------------------------------------------------------

loc_100130E9:				; CODE XREF: PR_ParseTimeStringToExplodedTime+893j
		sub	eax, 30h
		mov	[esp+70h+var_40], eax

loc_100130F0:				; CODE XREF: PR_ParseTimeStringToExplodedTime+86Fj
					; PR_ParseTimeStringToExplodedTime+881j ...
		cmp	edi, 0Ch
		jg	loc_10013182
		mov	al, [edx]
		mov	ecx, edx
		test	al, al
		jz	short loc_10013111

loc_10013101:				; CODE XREF: PR_ParseTimeStringToExplodedTime+8CFj
		cmp	al, 20h
		jz	short loc_10013109
		cmp	al, 9
		jnz	short loc_10013111

loc_10013109:				; CODE XREF: PR_ParseTimeStringToExplodedTime+8C3j
		mov	al, [ecx+1]
		inc	ecx
		test	al, al
		jnz	short loc_10013101

loc_10013111:				; CODE XREF: PR_ParseTimeStringToExplodedTime+8BFj
					; PR_ParseTimeStringToExplodedTime+8C7j
		mov	al, [ecx]
		cmp	al, 70h
		jz	short loc_1001311B
		cmp	al, 50h
		jnz	short loc_1001312C

loc_1001311B:				; CODE XREF: PR_ParseTimeStringToExplodedTime+8D5j
		mov	bl, [ecx+1]
		cmp	bl, 6Dh
		jz	short loc_1001315F
		cmp	bl, 4Dh
		jz	short loc_1001315F
		mov	ebx, [esp+70h+var_58]

loc_1001312C:				; CODE XREF: PR_ParseTimeStringToExplodedTime+8D9j
		cmp	edi, 0Ch
		jnz	short loc_10013182
		cmp	al, 61h
		jz	short loc_10013139
		cmp	al, 41h
		jnz	short loc_10013182

loc_10013139:				; CODE XREF: PR_ParseTimeStringToExplodedTime+8F3j
		mov	cl, [ecx+1]
		cmp	cl, 6Dh
		jz	short loc_10013146
		cmp	cl, 4Dh
		jnz	short loc_10013182

loc_10013146:				; CODE XREF: PR_ParseTimeStringToExplodedTime+8FFj
		mov	eax, [esp+70h+var_40]
		xor	edi, edi
		mov	[esp+70h+var_38], edi
		mov	[esp+70h+var_3C], ebp
		mov	[esp+70h+var_34], eax
		mov	esi, edx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_1001315F:				; CODE XREF: PR_ParseTimeStringToExplodedTime+8E1j
					; PR_ParseTimeStringToExplodedTime+8E6j
		mov	ebx, [esp+70h+var_58]
		cmp	edi, 0Ch
		jnz	short loc_1001317F
		mov	eax, [esp+70h+var_40]
		mov	[esp+70h+var_38], edi
		mov	[esp+70h+var_3C], ebp
		mov	[esp+70h+var_34], eax
		mov	esi, edx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_1001317F:				; CODE XREF: PR_ParseTimeStringToExplodedTime+926j
		add	edi, 0Ch

loc_10013182:				; CODE XREF: PR_ParseTimeStringToExplodedTime+8B3j
					; PR_ParseTimeStringToExplodedTime+8EFj ...
		mov	eax, [esp+70h+var_40]
		mov	[esp+70h+var_38], edi
		mov	[esp+70h+var_3C], ebp
		mov	[esp+70h+var_34], eax
		mov	esi, edx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10013199:				; CODE XREF: PR_ParseTimeStringToExplodedTime+7DAj
		cmp	dl, 2Fh
		jz	short loc_100131A7
		cmp	dl, 2Dh
		jnz	loc_1001339B

loc_100131A7:				; CODE XREF: PR_ParseTimeStringToExplodedTime+95Cj
		mov	al, [ecx+1]
		cmp	al, 30h
		jl	loc_1001339B
		cmp	al, 39h
		jg	loc_1001339B
		test	ebx, ebx
		jnz	loc_10013495	; jumptable 100128EF default case
		mov	cl, [esi+1]
		lea	eax, [esi+1]
		add	edi, 0FFFFFFD0h
		cmp	cl, 30h
		jl	short loc_100131E0
		cmp	cl, 39h
		jg	short loc_100131E0
		movsx	ecx, cl
		lea	edx, [edi+edi*4]
		lea	edi, [ecx+edx*2-30h]
		inc	eax

loc_100131E0:				; CODE XREF: PR_ParseTimeStringToExplodedTime+98Ej
					; PR_ParseTimeStringToExplodedTime+993j
		mov	cl, [eax]
		cmp	cl, 2Fh
		jz	short loc_100131F0
		cmp	cl, 2Dh
		jnz	loc_10013495	; jumptable 100128EF default case

loc_100131F0:				; CODE XREF: PR_ParseTimeStringToExplodedTime+9A5j
		mov	cl, [eax+1]
		inc	eax
		cmp	cl, 30h
		jl	loc_10013495	; jumptable 100128EF default case
		cmp	cl, 39h
		jg	loc_10013495	; jumptable 100128EF default case
		movsx	ebp, cl
		mov	cl, [eax+1]
		inc	eax
		sub	ebp, 30h
		cmp	cl, 30h
		jl	short loc_10013226
		cmp	cl, 39h
		jg	short loc_10013226
		movsx	ecx, cl
		lea	edx, [ebp+ebp*4+0]
		lea	ebp, [ecx+edx*2-30h]
		inc	eax

loc_10013226:				; CODE XREF: PR_ParseTimeStringToExplodedTime+9D3j
					; PR_ParseTimeStringToExplodedTime+9D8j
		mov	cl, [eax]
		cmp	cl, 2Fh
		jz	short loc_10013236
		cmp	cl, 2Dh
		jnz	loc_10013495	; jumptable 100128EF default case

loc_10013236:				; CODE XREF: PR_ParseTimeStringToExplodedTime+9EBj
		mov	cl, [eax+1]
		inc	eax
		cmp	cl, 30h
		jl	loc_10013495	; jumptable 100128EF default case
		cmp	cl, 39h
		jg	loc_10013495	; jumptable 100128EF default case
		mov	dl, [eax+1]
		movsx	ecx, cl
		inc	eax
		sub	ecx, 30h
		cmp	dl, 30h
		jl	short loc_100132C8
		cmp	dl, 39h
		jg	short loc_1001326B
		movsx	edx, dl
		lea	ecx, [ecx+ecx*4]
		lea	ecx, [edx+ecx*2-30h]
		inc	eax

loc_1001326B:				; CODE XREF: PR_ParseTimeStringToExplodedTime+A1Ej
		mov	dl, [eax]
		cmp	dl, 30h
		jl	short loc_100132C8
		cmp	dl, 39h
		jg	short loc_100132B8
		movsx	edx, dl
		lea	ecx, [ecx+ecx*4]
		inc	eax
		lea	edx, [edx+ecx*2-30h]
		mov	cl, [eax]
		cmp	cl, 30h
		jl	loc_10013495	; jumptable 100128EF default case
		cmp	cl, 39h
		jg	loc_10013495	; jumptable 100128EF default case
		movsx	ecx, cl
		lea	edx, [edx+edx*4]
		inc	eax
		lea	ecx, [ecx+edx*2-30h]
		mov	dl, [eax]
		cmp	dl, 30h
		jl	short loc_100132C8
		cmp	dl, 39h
		jg	short loc_100132B8
		movsx	edx, dl
		lea	ecx, [ecx+ecx*4]
		lea	ecx, [edx+ecx*2-30h]
		inc	eax

loc_100132B8:				; CODE XREF: PR_ParseTimeStringToExplodedTime+A35j
					; PR_ParseTimeStringToExplodedTime+A6Bj
		mov	dl, [eax]
		cmp	dl, 30h
		jl	short loc_100132C8
		cmp	dl, 39h
		jle	loc_10013495	; jumptable 100128EF default case

loc_100132C8:				; CODE XREF: PR_ParseTimeStringToExplodedTime+A19j
					; PR_ParseTimeStringToExplodedTime+A30j ...
		cmp	dl, 41h
		jl	short loc_100132D6
		cmp	dl, 5Ah
		jle	loc_10013495	; jumptable 100128EF default case

loc_100132D6:				; CODE XREF: PR_ParseTimeStringToExplodedTime+A8Bj
		cmp	dl, 61h
		jl	short loc_100132E4
		cmp	dl, 7Ah
		jle	loc_10013495	; jumptable 100128EF default case

loc_100132E4:				; CODE XREF: PR_ParseTimeStringToExplodedTime+A99j
		cmp	edi, 1Fh
		jg	short loc_10013343
		test	edi, edi
		jz	short loc_10013343
		cmp	edi, 0Ch
		jle	short loc_100132FE
		cmp	ebp, 0Ch
		jle	short loc_100132FE
		mov	esi, eax
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_100132FE:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AB0j
					; PR_ParseTimeStringToExplodedTime+AB5j
		cmp	ecx, 46h
		jge	short loc_1001330B
		add	ecx, 7D0h
		jmp	short loc_10013316
; ---------------------------------------------------------------------------

loc_1001330B:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AC1j
		cmp	ecx, 64h
		jge	short loc_10013316
		add	ecx, 76Ch

loc_10013316:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AC9j
					; PR_ParseTimeStringToExplodedTime+ACEj
		mov	[esp+70h+var_54], ecx
		cmp	edi, 0Ch
		jle	short loc_10013331
		lea	ebx, [ebp+7]
		mov	[esp+70h+var_4C], edi
		mov	[esp+70h+var_58], ebx
		mov	esi, eax
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10013331:				; CODE XREF: PR_ParseTimeStringToExplodedTime+ADDj
		lea	ebx, [edi+7]
		mov	[esp+70h+var_4C], ebp
		mov	[esp+70h+var_58], ebx
		mov	esi, eax
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_10013343:				; CODE XREF: PR_ParseTimeStringToExplodedTime+AA7j
					; PR_ParseTimeStringToExplodedTime+AABj
		cmp	ebp, 0Ch
		jg	loc_10013495	; jumptable 100128EF default case
		cmp	ecx, 1Fh
		jg	loc_10013495	; jumptable 100128EF default case
		mov	[esp+70h+var_54], edi
		cmp	edi, 46h
		jge	short loc_1001337A
		add	edi, 7D0h
		lea	ebx, [ebp+7]
		mov	[esp+70h+var_54], edi
		mov	[esp+70h+var_58], ebx
		mov	[esp+70h+var_4C], ecx
		mov	esi, eax
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_1001337A:				; CODE XREF: PR_ParseTimeStringToExplodedTime+B1Cj
		cmp	edi, 64h
		jge	short loc_10013389
		add	edi, 76Ch
		mov	[esp+70h+var_54], edi

loc_10013389:				; CODE XREF: PR_ParseTimeStringToExplodedTime+B3Dj
		lea	ebx, [ebp+7]
		mov	[esp+70h+var_58], ebx
		mov	[esp+70h+var_4C], ecx
		mov	esi, eax
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_1001339B:				; CODE XREF: PR_ParseTimeStringToExplodedTime+961j
					; PR_ParseTimeStringToExplodedTime+96Cj ...
		cmp	dl, 41h
		jl	short loc_100133A9
		cmp	dl, 5Ah
		jle	loc_10013495	; jumptable 100128EF default case

loc_100133A9:				; CODE XREF: PR_ParseTimeStringToExplodedTime+B5Ej
		cmp	dl, 61h
		jl	short loc_100133B7
		cmp	dl, 7Ah
		jle	loc_10013495	; jumptable 100128EF default case

loc_100133B7:				; CODE XREF: PR_ParseTimeStringToExplodedTime+B6Cj
		sub	ecx, esi
		cmp	ecx, 5
		jnz	short loc_100133FE
		cmp	[esp+70h+var_54], 0
		jge	loc_10013495	; jumptable 100128EF default case
		movsx	ecx, byte ptr [esi+1]
		lea	eax, [edi+edi*4]
		lea	eax, [ecx+eax*2]
		lea	edx, [eax+eax*4]
		movsx	eax, byte ptr [esi+2]
		lea	eax, [eax+edx*2]
		movsx	edx, byte ptr [esi+3]
		lea	ecx, [eax+eax*4]
		lea	eax, [edx+ecx*2]
		movsx	ecx, byte ptr [esi+4]
		lea	eax, [eax+eax*4]
		lea	edx, [ecx+eax*2-82350h]
		mov	[esp+70h+var_54], edx
		jmp	loc_10013495	; jumptable 100128EF default case
; ---------------------------------------------------------------------------

loc_100133FE:				; CODE XREF: PR_ParseTimeStringToExplodedTime+B7Cj
		cmp	ecx, 4
		jnz	short loc_10013436
		cmp	[esp+70h+var_54], 0
		jge	loc_10013495	; jumptable 100128EF default case
		movsx	ecx, byte ptr [esi+1]
		lea	eax, [edi+edi*4]
		lea	eax, [ecx+eax*2]
		lea	edx, [eax+eax*4]
		movsx	eax, byte ptr [esi+2]
		lea	eax, [eax+edx*2]
		movsx	edx, byte ptr [esi+3]
		lea	ecx, [eax+eax*4]
		lea	eax, [edx+ecx*2-0D050h]

loc_10013430:				; CODE XREF: PR_ParseTimeStringToExplodedTime+C35j
		mov	[esp+70h+var_54], eax
		jmp	short loc_10013495 ; jumptable 100128EF	default	case
; ---------------------------------------------------------------------------

loc_10013436:				; CODE XREF: PR_ParseTimeStringToExplodedTime+BC1j
		cmp	ecx, 2
		jnz	short loc_10013482
		cmp	[esp+70h+var_4C], 0
		movsx	edx, byte ptr [esi+1]
		lea	ecx, [edi+edi*4]
		lea	eax, [edx+ecx*2-210h]
		jge	short loc_1001345B
		cmp	eax, 20h
		jge	short loc_1001345B
		mov	[esp+70h+var_4C], eax
		jmp	short loc_10013495 ; jumptable 100128EF	default	case
; ---------------------------------------------------------------------------

loc_1001345B:				; CODE XREF: PR_ParseTimeStringToExplodedTime+C0Ej
					; PR_ParseTimeStringToExplodedTime+C13j
		cmp	[esp+70h+var_54], 0
		jge	short loc_10013495 ; jumptable 100128EF	default	case
		cmp	eax, 46h
		jge	short loc_10013472
		add	eax, 7D0h
		mov	[esp+70h+var_54], eax
		jmp	short loc_10013495 ; jumptable 100128EF	default	case
; ---------------------------------------------------------------------------

loc_10013472:				; CODE XREF: PR_ParseTimeStringToExplodedTime+C25j
		cmp	eax, 64h
		jge	short loc_10013430
		add	eax, 76Ch
		mov	[esp+70h+var_54], eax
		jmp	short loc_10013495 ; jumptable 100128EF	default	case
; ---------------------------------------------------------------------------

loc_10013482:				; CODE XREF: PR_ParseTimeStringToExplodedTime+BF9j
		cmp	ecx, 1
		jnz	short loc_10013495 ; jumptable 100128EF	default	case
		cmp	[esp+70h+var_4C], 0
		jge	short loc_10013495 ; jumptable 100128EF	default	case
		add	edi, 0FFFFFFD0h
		mov	[esp+70h+var_4C], edi

loc_10013495:				; CODE XREF: PR_ParseTimeStringToExplodedTime+A2j
					; PR_ParseTimeStringToExplodedTime+AFj	...
		mov	al, [esi]	; jumptable 100128EF default case
		test	al, al
		jz	short loc_100134D6
		jmp	short loc_100134A0
; ---------------------------------------------------------------------------
		align 10h

loc_100134A0:				; CODE XREF: PR_ParseTimeStringToExplodedTime+C5Bj
					; PR_ParseTimeStringToExplodedTime+C92j
		cmp	al, 20h
		jz	short loc_100134D6
		cmp	al, 9
		jz	short loc_100134D6
		cmp	al, 2Ch
		jz	short loc_100134D6
		cmp	al, 3Bh
		jz	short loc_100134D6
		cmp	al, 2Dh
		jz	short loc_100134D6
		cmp	al, 2Bh
		jz	short loc_100134D6
		cmp	al, 2Fh
		jz	short loc_100134D6
		cmp	al, 28h
		jz	short loc_100134D6
		cmp	al, 29h
		jz	short loc_100134D6
		cmp	al, 5Bh
		jz	short loc_100134D6
		cmp	al, 5Dh
		jz	short loc_100134D6
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_100134A0
		jmp	short loc_1001350C
; ---------------------------------------------------------------------------

loc_100134D6:				; CODE XREF: PR_ParseTimeStringToExplodedTime+C59j
					; PR_ParseTimeStringToExplodedTime+C62j ...
		mov	al, [esi]
		test	al, al
		jz	short loc_1001350C
		lea	esp, [esp+0]

loc_100134E0:				; CODE XREF: PR_ParseTimeStringToExplodedTime+CCAj
		cmp	al, 20h
		jz	short loc_10013504
		cmp	al, 9
		jz	short loc_10013504
		cmp	al, 2Ch
		jz	short loc_10013504
		cmp	al, 3Bh
		jz	short loc_10013504
		cmp	al, 2Fh
		jz	short loc_10013504
		cmp	al, 28h
		jz	short loc_10013504
		cmp	al, 29h
		jz	short loc_10013504
		cmp	al, 5Bh
		jz	short loc_10013504
		cmp	al, 5Dh
		jnz	short loc_1001350C

loc_10013504:				; CODE XREF: PR_ParseTimeStringToExplodedTime+CA2j
					; PR_ParseTimeStringToExplodedTime+CA6j ...
		mov	al, [esi+1]
		inc	esi
		test	al, al
		jnz	short loc_100134E0

loc_1001350C:				; CODE XREF: PR_ParseTimeStringToExplodedTime+C94j
					; PR_ParseTimeStringToExplodedTime+C9Aj ...
		cmp	byte ptr [esi],	2Dh
		jnz	short loc_1001353E
		cmp	esi, [esp+70h+var_2C]
		jbe	short loc_10013530
		movzx	eax, byte ptr [esi-1]
		push	eax		; C
		call	ds:isalpha
		add	esp, 4
		test	eax, eax
		jz	short loc_10013530
		cmp	[esp+70h+var_54], 0
		jl	short loc_1001353B

loc_10013530:				; CODE XREF: PR_ParseTimeStringToExplodedTime+CD5j
					; PR_ParseTimeStringToExplodedTime+CE7j
		mov	al, [esi+1]
		cmp	al, 30h
		jl	short loc_1001353B
		cmp	al, 39h
		jle	short loc_1001353E

loc_1001353B:				; CODE XREF: PR_ParseTimeStringToExplodedTime+CEEj
					; PR_ParseTimeStringToExplodedTime+CF5j
		inc	esi
		jmp	short loc_100134D6
; ---------------------------------------------------------------------------

loc_1001353E:				; CODE XREF: PR_ParseTimeStringToExplodedTime+CCFj
					; PR_ParseTimeStringToExplodedTime+CF9j
		cmp	byte ptr [esi],	0
		jnz	loc_100128C0
		mov	eax, [esp+70h+var_60]
		xor	edi, edi
		cmp	eax, edi
		jz	loc_10013633	; jumptable 1001356C default case
		cmp	[esp+70h+var_5C], 0FFFFFFFFh
		jnz	loc_10013633	; jumptable 1001356C default case
		add	eax, 0FFFFFFECh	; switch 15 cases
		cmp	eax, 0Eh
		ja	loc_10013633	; jumptable 1001356C default case
		jmp	ds:off_1001388C[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10013573:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFE20h ; jumptable 1001356C case 20
		jmp	loc_10013633	; jumptable 1001356C default case
; ---------------------------------------------------------------------------

loc_10013580:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFE20h ; jumptable 1001356C case 21
		mov	[esp+70h+var_48], 3Ch
		jmp	loc_10013633	; jumptable 1001356C default case
; ---------------------------------------------------------------------------

loc_10013595:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFE5Ch ; jumptable 1001356C case 22
		jmp	loc_10013633	; jumptable 1001356C default case
; ---------------------------------------------------------------------------

loc_100135A2:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFE5Ch ; jumptable 1001356C case 23
		mov	[esp+70h+var_48], 3Ch
		jmp	loc_10013633	; jumptable 1001356C default case
; ---------------------------------------------------------------------------

loc_100135B7:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFE98h ; jumptable 1001356C case 24
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_100135C1:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFE98h ; jumptable 1001356C case 25
		mov	[esp+70h+var_48], 3Ch
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_100135D3:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFED4h ; jumptable 1001356C case 26
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_100135DD:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFED4h ; jumptable 1001356C case 27
		mov	[esp+70h+var_48], 3Ch
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_100135EF:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFF10h ; jumptable 1001356C case 28
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_100135F9:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 0FFFFFF2Eh ; jumptable 1001356C case 29
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_10013603:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], edi ;	jumptable 1001356C case	30
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_10013609:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], edi ;	jumptable 1001356C case	31
		mov	[esp+70h+var_48], 3Ch
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_10013617:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 3Ch ;	jumptable 1001356C case	32
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_10013621:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 78h ;	jumptable 1001356C case	33
		jmp	short loc_10013633 ; jumptable 1001356C	default	case
; ---------------------------------------------------------------------------

loc_1001362B:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D2Cj
					; DATA XREF: .text:off_1001388Co
		mov	[esp+70h+var_5C], 21Ch ; jumptable 1001356C case 34

loc_10013633:				; CODE XREF: PR_ParseTimeStringToExplodedTime+D0Fj
					; PR_ParseTimeStringToExplodedTime+D1Aj ...
		cmp	ebx, edi	; jumptable 1001356C default case
		jz	loc_100128A1
		mov	esi, [esp+70h+var_4C]
		cmp	esi, 0FFFFFFFFh
		jz	loc_100128A1
		mov	edx, [esp+70h+var_54]
		cmp	edx, 0FFFFFFFFh
		jz	loc_100128A1
		cmp	edx, 7FFFh
		jg	loc_100128A1
		mov	ecx, [esp+70h+Time]
		xor	eax, eax
		mov	[ecx], eax
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		mov	[ecx+0Ch], eax
		mov	[ecx+10h], eax
		mov	[ecx+14h], eax
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], eax
		mov	[ecx+20h], eax
		mov	[ecx+24h], eax
		mov	eax, [esp+70h+var_34]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10013690
		mov	[ecx+4], eax

loc_10013690:				; CODE XREF: PR_ParseTimeStringToExplodedTime+E4Bj
		mov	eax, [esp+70h+var_3C]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001369C
		mov	[ecx+8], eax

loc_1001369C:				; CODE XREF: PR_ParseTimeStringToExplodedTime+E57j
		mov	eax, [esp+70h+var_38]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100136A8
		mov	[ecx+0Ch], eax

loc_100136A8:				; CODE XREF: PR_ParseTimeStringToExplodedTime+E63j
		mov	eax, [esp+70h+var_50]
		add	ebx, 0FFFFFFF8h
		mov	[ecx+10h], esi
		mov	[ecx+14h], ebx
		mov	[ecx+18h], dx
		cmp	eax, edi
		jz	short loc_100136C2
		dec	al
		mov	[ecx+1Ah], al

loc_100136C2:				; CODE XREF: PR_ParseTimeStringToExplodedTime+E7Bj
		mov	esi, ecx
		push	offset PR_GMTParameters
		push	esi
		call	PR_NormalizeTime
		add	esp, 8
		cmp	[esp+70h+var_60], edi
		jnz	short loc_100136E5
		cmp	[esp+70h+arg_4], edi
		jz	short loc_100136E5
		xor	eax, eax
		jmp	loc_100137BB
; ---------------------------------------------------------------------------

loc_100136E5:				; CODE XREF: PR_ParseTimeStringToExplodedTime+E96j
					; PR_ParseTimeStringToExplodedTime+E9Cj
		mov	eax, [esp+70h+var_5C]
		cmp	eax, 0FFFFFFFFh
		jnz	loc_100137BB
		movzx	eax, word ptr [esi+18h]
		mov	ecx, 7B2h
		cmp	ax, cx
		jl	loc_10013784
		mov	ecx, [esi+8]
		mov	edx, [esi+4]
		mov	[esp+70h+Tm.tm_min], ecx
		mov	ecx, [esi+10h]
		mov	[esp+70h+Tm.tm_sec], edx
		mov	edx, [esi+0Ch]
		cwde
		mov	[esp+70h+Tm.tm_mday], ecx
		mov	[esp+70h+Tm.tm_hour], edx
		mov	edx, [esi+14h]
		lea	ecx, [esp+70h+Tm]
		sub	eax, 76Ch
		push	ecx		; Tm
		mov	[esp+74h+Tm.tm_mon], edx
		mov	[esp+74h+Tm.tm_year], eax
		mov	[esp+74h+Tm.tm_isdst], 0FFFFFFFFh
		call	ds:mktime
		add	esp, 4
		mov	[esp+70h+Time],	eax
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10013784
		push	esi
		push	offset PR_LocalTimeParameters
		push	0
		cdq
		push	0F4240h
		push	edx
		push	eax
		call	sub_10026AB0
		push	edx
		push	eax
		call	PR_ExplodeTime
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+60h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
; ---------------------------------------------------------------------------

loc_10013784:				; CODE XREF: PR_ParseTimeStringToExplodedTime+EBEj
					; PR_ParseTimeStringToExplodedTime+F0Ej
		lea	edx, [esp+70h+Tm]
		push	edx		; int
		lea	eax, [esp+74h+Time]
		push	eax		; Time
		mov	[esp+78h+Time],	15180h
		call	sub_10012000
		mov	eax, [esp+78h+Tm.tm_mday]
		mov	edx, [esp+78h+Tm.tm_hour]
		lea	ecx, [eax+eax*2-6]
		lea	eax, [edx+ecx*8]
		mov	edx, [esp+78h+Tm.tm_min]
		mov	ecx, eax
		shl	ecx, 4
		add	esp, 8
		sub	ecx, eax
		lea	eax, [edx+ecx*4]

loc_100137BB:				; CODE XREF: PR_ParseTimeStringToExplodedTime+EA0j
					; PR_ParseTimeStringToExplodedTime+EACj
		mov	ecx, eax
		shl	ecx, 4
		sub	ecx, eax
		mov	eax, [esp+70h+var_48]
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		add	ecx, ecx
		add	ecx, ecx
		add	edx, edx
		add	edx, edx
		pop	edi
		mov	[esi+20h], ecx
		mov	ecx, [esp+6Ch+var_4]
		mov	[esi+24h], edx
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 60h
		retn
PR_ParseTimeStringToExplodedTime endp

; ---------------------------------------------------------------------------
off_100137F0	dd offset loc_10012F1A,	offset loc_10012FF4, offset loc_100128F6
					; DATA XREF: PR_ParseTimeStringToExplodedTime+AFr
		dd offset loc_1001297C,	offset loc_100129B2, offset loc_10012A0A ; jump	table for switch statement
		dd offset loc_10012A3E,	offset loc_10012AB8, offset loc_10012B13
		dd offset loc_10012B49,	offset loc_10012BF2, offset loc_10012CE4
		dd offset loc_10012D42,	offset loc_10012D76, offset loc_10012DCE
		dd offset loc_10012E50,	offset loc_10012EA5, offset loc_10012EE7
		dd offset loc_10013495
byte_1001383C	db	0,   12h,     0,   12h
					; DATA XREF: PR_ParseTimeStringToExplodedTime+A8r
		db    12h,     1,     1,     1 ; indirect table	for switch statement
		db	1,     1,     1,     1
		db	1,     1,     1,   12h
		db    12h,   12h,   12h,   12h
		db    12h,   12h,     2,     3
		db	4,     5,     6,     7
		db	8,   12h,   12h,     9
		db    12h,   12h,   0Ah,   0Bh
		db    0Ch,   0Dh,   12h,   12h
		db    0Eh,   0Fh,   10h,   12h
		db    11h,   12h,   12h,   12h
		db    12h,   12h,   12h,   12h
		db    12h,   12h,     2,     3
		db	4,     5,     6,     7
		db	8,   12h,   12h,     9
		db    12h,   12h,   0Ah,   0Bh
		db    0Ch,   0Dh,   12h,   12h
		db    0Eh,   0Fh,   10h,   12h
		db    11h
		align 4
off_1001388C	dd offset loc_10013573	; DATA XREF: PR_ParseTimeStringToExplodedTime+D2Cr
		dd offset loc_10013580	; jump table for switch	statement
		dd offset loc_10013595
		dd offset loc_100135A2
		dd offset loc_100135B7
		dd offset loc_100135C1
		dd offset loc_100135D3
		dd offset loc_100135DD
		dd offset loc_100135EF
		dd offset loc_100135F9
		dd offset loc_10013603
		dd offset loc_10013609
		dd offset loc_10013617
		dd offset loc_10013621
		dd offset loc_1001362B
		align 10h
; Exported entry 278. PR_ParseTimeString

; =============== S U B	R O U T	I N E =======================================


		public PR_ParseTimeString
PR_ParseTimeString proc	near		; DATA XREF: .rdata:off_1002C7C8o

var_2C		= byte ptr -2Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		mov	edx, [esp+2Ch+arg_4]
		mov	eax, [esp+2Ch+arg_0]
		push	esi
		mov	esi, [esp+30h+arg_8]
		lea	ecx, [esp+30h+var_2C]
		push	ecx
		push	edx
		push	eax
		call	PR_ParseTimeStringToExplodedTime
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10013912
		lea	eax, [esp+30h+var_2C]
		push	eax
		call	PR_ImplodeTime
		add	esp, 4
		mov	[esi], eax
		mov	[esi+4], edx
		xor	eax, eax

loc_10013912:				; CODE XREF: PR_ParseTimeString+2Cj
		mov	ecx, [esp+30h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
PR_ParseTimeString endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 133. PR_FormatTimeUSEnglish

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_FormatTimeUSEnglish(void *Dst,	int, int, int)
		public PR_FormatTimeUSEnglish
PR_FormatTimeUSEnglish proc near	; CODE XREF: PR_FormatTimeUSEnglish+17Ap
					; PR_FormatTimeUSEnglish+439p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
Src		= byte ptr -2Ch
var_4		= dword	ptr -4
Dst		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 38h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+38h+var_4], eax
		mov	eax, [esp+38h+arg_8]
		cmp	byte ptr [eax],	0
		mov	edx, [esp+38h+Dst]
		push	ebx
		mov	ebx, [esp+3Ch+arg_C]
		push	ebp
		push	esi
		mov	esi, [esp+44h+arg_4]
		push	edi
		mov	[esp+48h+var_30], edx
		mov	[esp+48h+var_34], ebx
		mov	edi, edx
		mov	ecx, eax
		mov	[esp+48h+var_38], eax
		jz	loc_10013E65
		jmp	short loc_10013970
; ---------------------------------------------------------------------------
		align 10h

loc_10013970:				; CODE XREF: PR_FormatTimeUSEnglish+3Bj
					; PR_FormatTimeUSEnglish+52Bj
		mov	al, [ecx]
		cmp	al, 25h
		jz	short loc_10013987
		cmp	esi, 1
		jb	loc_10013E84
		mov	[edi], al
		inc	edi
		jmp	loc_10013E4E
; ---------------------------------------------------------------------------

loc_10013987:				; CODE XREF: PR_FormatTimeUSEnglish+44j
		movsx	eax, byte ptr [ecx+1]
		inc	ecx
		add	eax, 0FFFFFFDBh	; switch 85 cases
		mov	[esp+48h+var_38], ecx
		cmp	eax, 54h
		ja	loc_10013E34	; jumptable 100139A3 default case
		movzx	eax, ds:byte_10013F34[eax]
		jmp	ds:off_10013ED8[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100139AA:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		cmp	esi, 1		; jumptable 100139A3 case 37
		jb	loc_10013E84
		mov	byte ptr [edi],	25h
		inc	edi
		jmp	loc_10013E4E
; ---------------------------------------------------------------------------

loc_100139BC:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		movsx	ecx, byte ptr [ebx+1Ah]	; jumptable 100139A3 case 97
		mov	edx, off_100302E8[ecx*4]
		mov	eax, edx
		lea	ebp, [eax+1]
		lea	esp, [esp+0]

loc_100139D0:				; CODE XREF: PR_FormatTimeUSEnglish+A5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_100139D0
		sub	eax, ebp
		mov	ebp, eax
		cmp	ebp, esi
		ja	loc_10013E9D
		push	ebp		; Size
		push	edx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, ebp
		sub	esi, ebp
		jmp	loc_10013E4F
; ---------------------------------------------------------------------------

loc_100139F7:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		movsx	edx, byte ptr [ebx+1Ah]	; jumptable 100139A3 case 65
		mov	edx, off_10030304[edx*4]
		mov	eax, edx
		lea	ebp, [eax+1]

loc_10013A07:				; CODE XREF: PR_FormatTimeUSEnglish+DCj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013A07
		sub	eax, ebp
		mov	ebp, eax
		cmp	ebp, esi
		ja	loc_10013E9D
		push	ebp		; Size
		push	edx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, ebp
		sub	esi, ebp
		jmp	loc_10013E4F
; ---------------------------------------------------------------------------

loc_10013A2E:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		mov	eax, [ebx+14h]	; jumptable 100139A3 case 98
		mov	edx, off_10030320[eax*4]
		mov	eax, edx
		lea	ebp, [eax+1]
		lea	ecx, [ecx+0]

loc_10013A40:				; CODE XREF: PR_FormatTimeUSEnglish+115j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013A40
		sub	eax, ebp
		mov	ebp, eax
		cmp	ebp, esi
		ja	loc_10013E9D
		push	ebp		; Size
		push	edx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, ebp
		sub	esi, ebp
		jmp	loc_10013E4F
; ---------------------------------------------------------------------------

loc_10013A67:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		mov	ecx, [ebx+14h]	; jumptable 100139A3 case 66
		mov	edx, off_10030350[ecx*4]
		mov	eax, edx
		lea	ebp, [eax+1]

loc_10013A76:				; CODE XREF: PR_FormatTimeUSEnglish+14Bj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013A76
		sub	eax, ebp
		mov	ebp, eax
		cmp	ebp, esi
		ja	loc_10013E9D
		push	ebp		; Size
		push	edx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, ebp
		sub	esi, ebp
		jmp	loc_10013E4F
; ---------------------------------------------------------------------------

loc_10013A9D:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		push	ebx		; jumptable 100139A3 case 99
		push	offset aABDHMSY	; "%a %b %d %H:%M:%S %Y"
		lea	edx, [esp+50h+Src]
		push	28h		; int
		push	edx		; Dst
		call	PR_FormatTimeUSEnglish
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_10013AC0:				; CODE XREF: PR_FormatTimeUSEnglish+195j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013AC0

loc_10013AC7:				; CODE XREF: PR_FormatTimeUSEnglish+1E7j
					; PR_FormatTimeUSEnglish+20Fj ...
		sub	eax, edx
		mov	ebp, eax
		cmp	ebp, esi
		ja	loc_10013E9D
		push	ebp		; Size
		lea	eax, [esp+4Ch+Src]
		push	eax		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, ebp
		sub	esi, ebp
		jmp	loc_10013E4F
; ---------------------------------------------------------------------------

loc_10013AEB:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		mov	ecx, [ebx+10h]	; jumptable 100139A3 case 100
		push	ecx
		push	offset a_2ld	; "%.2ld"
		lea	edx, [esp+50h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]
		lea	ebx, [ebx+0]

loc_10013B10:				; CODE XREF: PR_FormatTimeUSEnglish+1E5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013B10
		jmp	short loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013B19:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		mov	ecx, [ebx+0Ch]	; jumptable 100139A3 case 72
		push	ecx
		push	offset a_2ld	; "%.2ld"
		lea	edx, [esp+50h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]

loc_10013B38:				; CODE XREF: PR_FormatTimeUSEnglish+20Dj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013B38
		jmp	short loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013B41:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		mov	eax, [ebx+0Ch]	; jumptable 100139A3 case 73
		cdq
		mov	ecx, 0Ch
		idiv	ecx
		test	edx, edx
		jnz	short loc_10013B52
		mov	edx, ecx

loc_10013B52:				; CODE XREF: PR_FormatTimeUSEnglish+21Ej
		push	edx
		push	offset a_2ld	; "%.2ld"
		lea	edx, [esp+50h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]
		mov	edi, edi

loc_10013B70:				; CODE XREF: PR_FormatTimeUSEnglish+245j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013B70
		jmp	loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013B7C:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		movsx	ecx, word ptr [ebx+1Ch]	; jumptable 100139A3 case 106
		inc	ecx
		push	ecx
		push	offset a_3d	; "%.3d"
		lea	edx, [esp+50h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]
		lea	ecx, [ecx+0]

loc_10013BA0:				; CODE XREF: PR_FormatTimeUSEnglish+275j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013BA0
		jmp	loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013BAC:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		mov	ecx, [ebx+14h]	; jumptable 100139A3 case 109
		inc	ecx
		push	ecx
		push	offset a_2ld	; "%.2ld"
		lea	edx, [esp+50h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_10013BD0:				; CODE XREF: PR_FormatTimeUSEnglish+2A5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013BD0
		jmp	loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013BDC:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		mov	ecx, [ebx+8]	; jumptable 100139A3 case 77
		push	ecx
		push	offset a_2ld	; "%.2ld"
		lea	edx, [esp+50h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]
		jmp	short loc_10013C00
; ---------------------------------------------------------------------------
		align 10h

loc_10013C00:				; CODE XREF: PR_FormatTimeUSEnglish+2CBj
					; PR_FormatTimeUSEnglish+2D5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013C00
		jmp	loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013C0C:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		mov	ecx, [esp+48h+var_34] ;	jumptable 100139A3 case	112
		mov	ebx, [ecx+0Ch]
		mov	eax, offset aAm	; "AM"
		cmp	ebx, 0Ch
		jl	short loc_10013C22
		mov	eax, offset aPm	; "PM"

loc_10013C22:				; CODE XREF: PR_FormatTimeUSEnglish+2EBj
		lea	edx, [eax+1]

loc_10013C25:				; CODE XREF: PR_FormatTimeUSEnglish+2FAj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013C25
		sub	eax, edx
		mov	ebp, eax
		cmp	ebp, esi
		ja	loc_10013E9D
		mov	eax, offset aAm	; "AM"
		cmp	ebx, 0Ch
		jl	short loc_10013C47
		mov	eax, offset aPm	; "PM"

loc_10013C47:				; CODE XREF: PR_FormatTimeUSEnglish+310j
		push	ebp		; Size
		push	eax		; Src
		push	edi		; Dst
		call	memcpy
		mov	ebx, [esp+54h+var_34]
		add	esp, 0Ch
		add	edi, ebp
		sub	esi, ebp
		jmp	loc_10013E4F
; ---------------------------------------------------------------------------

loc_10013C5F:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		mov	edx, [ebx+4]	; jumptable 100139A3 case 83
		push	edx
		push	offset a_2ld	; "%.2ld"
		lea	eax, [esp+50h+Src]
		push	28h
		push	eax
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]
		mov	edi, edi

loc_10013C80:				; CODE XREF: PR_FormatTimeUSEnglish+355j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013C80

loc_10013C87:				; CODE XREF: PR_FormatTimeUSEnglish+44Fj
		sub	eax, edx
		mov	ebp, eax
		cmp	ebp, esi
		ja	loc_10013E9D
		push	ebp		; Size
		lea	ecx, [esp+4Ch+Src]
		push	ecx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, ebp
		sub	esi, ebp
		jmp	loc_10013E4F
; ---------------------------------------------------------------------------

loc_10013CAB:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		push	0		; jumptable 100139A3 case 85
		mov	ecx, ebx
		call	sub_100122E0
		push	eax
		push	offset a_2d	; "%.2d"
		lea	edx, [esp+54h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+5Ch+Src]
		add	esp, 14h
		lea	edx, [eax+1]

loc_10013CD0:				; CODE XREF: PR_FormatTimeUSEnglish+3A5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013CD0
		jmp	loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013CDC:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		movsx	ecx, byte ptr [ebx+1Ah]	; jumptable 100139A3 case 119
		push	ecx
		push	offset aD_0	; "%d"
		lea	edx, [esp+50h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]
		lea	esp, [esp+0]

loc_10013D00:				; CODE XREF: PR_FormatTimeUSEnglish+3D5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013D00
		jmp	loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013D0C:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		push	1		; jumptable 100139A3 case 87
		mov	ecx, ebx
		call	sub_100122E0
		push	eax
		push	offset a_2d	; "%.2d"
		lea	ecx, [esp+54h+Src]
		push	28h
		push	ecx
		call	PR_snprintf
		lea	eax, [esp+5Ch+Src]
		add	esp, 14h
		lea	edx, [eax+1]

loc_10013D31:				; CODE XREF: PR_FormatTimeUSEnglish+406j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013D31

loc_10013D38:				; CODE XREF: PR_FormatTimeUSEnglish+4FFj
		sub	eax, edx
		mov	ebp, eax
		cmp	ebp, esi
		ja	loc_10013E9D
		push	ebp		; Size
		lea	edx, [esp+4Ch+Src]
		push	edx		; Src
		push	edi		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, ebp
		sub	esi, ebp
		jmp	loc_10013E4F
; ---------------------------------------------------------------------------

loc_10013D5C:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		push	ebx		; jumptable 100139A3 case 120
		push	offset aMDY	; "%m/%d/%y"
		lea	eax, [esp+50h+Src]
		push	28h		; int
		push	eax		; Dst
		call	PR_FormatTimeUSEnglish
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]

loc_10013D78:				; CODE XREF: PR_FormatTimeUSEnglish+44Dj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013D78
		jmp	loc_10013C87
; ---------------------------------------------------------------------------

loc_10013D84:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		push	ebx		; jumptable 100139A3 case 88
		push	offset aHMS	; "%H:%M:%S"
		lea	edx, [esp+50h+Src]
		push	28h		; int
		push	edx		; Dst
		call	PR_FormatTimeUSEnglish
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]

loc_10013DA0:				; CODE XREF: PR_FormatTimeUSEnglish+475j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013DA0
		jmp	loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013DAC:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		movsx	eax, word ptr [ebx+18h]	; jumptable 100139A3 case 121
		cdq
		mov	ecx, 64h
		idiv	ecx
		push	edx
		push	offset a_2d	; "%.2d"
		lea	edx, [esp+50h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]

loc_10013DD4:				; CODE XREF: PR_FormatTimeUSEnglish+4A9j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013DD4
		jmp	loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013DE0:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		movsx	ecx, word ptr [ebx+18h]	; jumptable 100139A3 case 89
		push	ecx
		push	offset a_4d	; "%.4d"
		lea	edx, [esp+50h+Src]
		push	28h
		push	edx
		call	PR_snprintf
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]

loc_10013E00:				; CODE XREF: PR_FormatTimeUSEnglish+4D5j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013E00
		jmp	loc_10013AC7
; ---------------------------------------------------------------------------

loc_10013E0C:				; CODE XREF: PR_FormatTimeUSEnglish+73j
					; DATA XREF: .text:off_10013ED8o
		push	ebx		; jumptable 100139A3 case 90
		push	offset dword_1002AF1C ;	Format
		lea	ecx, [esp+50h+Src]
		push	28h		; SizeInBytes
		push	ecx		; Buf
		call	PR_FormatTime
		lea	eax, [esp+58h+Src]
		add	esp, 10h
		lea	edx, [eax+1]

loc_10013E28:				; CODE XREF: PR_FormatTimeUSEnglish+4FDj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10013E28
		jmp	loc_10013D38
; ---------------------------------------------------------------------------

loc_10013E34:				; CODE XREF: PR_FormatTimeUSEnglish+66j
					; PR_FormatTimeUSEnglish+73j
					; DATA XREF: ...
		cmp	esi, 1		; jumptable 100139A3 default case
		jb	short loc_10013E84
		dec	esi
		mov	byte ptr [edi],	25h
		cmp	esi, 1
		jb	loc_10013ED2
		mov	al, [ecx]
		mov	[edi+1], al
		add	edi, 2

loc_10013E4E:				; CODE XREF: PR_FormatTimeUSEnglish+52j
					; PR_FormatTimeUSEnglish+87j
		dec	esi

loc_10013E4F:				; CODE XREF: PR_FormatTimeUSEnglish+C2j
					; PR_FormatTimeUSEnglish+F9j ...
		mov	ecx, [esp+48h+var_38]
		inc	ecx
		cmp	byte ptr [ecx],	0
		mov	[esp+48h+var_38], ecx
		jnz	loc_10013970
		mov	edx, [esp+48h+var_30]

loc_10013E65:				; CODE XREF: PR_FormatTimeUSEnglish+35j
		cmp	esi, 1
		jb	short loc_10013E84
		mov	eax, edi
		sub	eax, edx

loc_10013E6E:				; CODE XREF: PR_FormatTimeUSEnglish+5A4j
		mov	byte ptr [edi],	0
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10013E84:				; CODE XREF: PR_FormatTimeUSEnglish+49j
					; PR_FormatTimeUSEnglish+7Dj ...
		mov	byte ptr [edi-1], 0
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10013E9D:				; CODE XREF: PR_FormatTimeUSEnglish+ADj
					; PR_FormatTimeUSEnglish+E4j ...
		test	esi, esi
		jnz	short loc_10013EBA
		mov	byte ptr [edi-1], 0
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+38h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10013EBA:				; CODE XREF: PR_FormatTimeUSEnglish+56Fj
		mov	ecx, [esp+48h+var_4]
		mov	byte ptr [edi],	0
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 38h
		retn
; ---------------------------------------------------------------------------

loc_10013ED2:				; CODE XREF: PR_FormatTimeUSEnglish+510j
		xor	eax, eax
		jmp	short loc_10013E6E
PR_FormatTimeUSEnglish endp

; ---------------------------------------------------------------------------
		align 4
off_10013ED8	dd offset loc_100139AA,	offset loc_100139F7, offset loc_10013A67
					; DATA XREF: PR_FormatTimeUSEnglish+73r
		dd offset loc_10013B19,	offset loc_10013B41, offset loc_10013BDC ; jump	table for switch statement
		dd offset loc_10013C5F,	offset loc_10013CAB, offset loc_10013D0C
		dd offset loc_10013D84,	offset loc_10013DE0, offset loc_10013E0C
		dd offset loc_100139BC,	offset loc_10013A2E, offset loc_10013A9D
		dd offset loc_10013AEB,	offset loc_10013B7C, offset loc_10013BAC
		dd offset loc_10013C0C,	offset loc_10013CDC, offset loc_10013D5C
		dd offset loc_10013DAC,	offset loc_10013E34
byte_10013F34	db	0,   16h,   16h,   16h ; DATA XREF: PR_FormatTimeUSEnglish+6Cr
		db    16h,   16h,   16h,   16h ; indirect table	for switch statement
		db    16h,   16h,   16h,   16h
		db    16h,   16h,   16h,   16h
		db    16h,   16h,   16h,   16h
		db    16h,   16h,   16h,   16h
		db    16h,   16h,   16h,   16h
		db	1,     2,   16h,   16h
		db    16h,   16h,   16h,     3
		db	4,   16h,   16h,   16h
		db	5,   16h,   16h,   16h
		db    16h,   16h,     6,   16h
		db	7,   16h,     8,     9
		db    0Ah,   0Bh,   16h,   16h
		db    16h,   16h,   16h,   16h
		db    0Ch,   0Dh,   0Eh,   0Fh
		db    16h,   16h,   16h,   16h
		db    16h,   10h,   16h,   16h
		db    11h,   16h,   16h,   12h
		db    16h,   16h,   16h,   16h
		db    16h,   16h,   13h,   14h
		db    15h
		align 10h
; Exported entry 272. PR_OpenDir

; =============== S U B	R O U T	I N E =======================================


		public PR_OpenDir
PR_OpenDir	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		push	150h		; Size
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jz	short loc_10013FC6
		mov	eax, [esp+4+arg_0]
		push	eax
		lea	ecx, [esi+4]
		push	ecx
		call	sub_100212E0
		add	esp, 8
		test	eax, eax
		jz	short loc_10013FD5
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10013FC6:				; CODE XREF: PR_OpenDir+12j
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8

loc_10013FD5:				; CODE XREF: PR_OpenDir+27j
		mov	eax, esi
		pop	esi
		retn
PR_OpenDir	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 300. PR_ReadDir

; =============== S U B	R O U T	I N E =======================================


		public PR_ReadDir
PR_ReadDir	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	eax
		lea	ecx, [esi+4]
		push	ecx
		call	sub_100214D0
		mov	[esi], eax
		add	esp, 8
		neg	eax
		sbb	eax, eax
		and	eax, esi
		pop	esi
		retn
PR_ReadDir	endp

; Exported entry  52. PR_CloseDir

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_CloseDir(void *Memory)
		public PR_CloseDir
PR_CloseDir	proc near		; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		test	esi, esi
		jz	short loc_10014029
		lea	eax, [esi+4]
		push	edi
		push	eax
		call	sub_10021280
		push	esi		; Memory
		mov	edi, eax
		call	PR_Free
		add	esp, 8
		xor	eax, eax
		test	edi, edi
		setns	al
		pop	edi
		pop	esi
		dec	eax
		retn
; ---------------------------------------------------------------------------

loc_10014029:				; CODE XREF: PR_CloseDir+7j
		xor	eax, eax
		pop	esi
		retn
PR_CloseDir	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 244. PR_MkDir

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_MkDir(LPCSTR lpPathName, int)
		public PR_MkDir
PR_MkDir	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpPathName	= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+lpPathName]
		push	eax
		push	ecx		; lpPathName
		call	sub_10021BD0
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
PR_MkDir	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 238. PR_MakeDir

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_MakeDir(LPCSTR	lpPathName, int)
		public PR_MakeDir
PR_MakeDir	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpPathName	= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword_10031520,	0
		jnz	short loc_1001405E
		call	PR_Init

loc_1001405E:				; CODE XREF: PR_MakeDir+7j
		mov	eax, [esp+arg_4]
		mov	ecx, [esp+lpPathName]
		push	eax		; int
		push	ecx		; lpPathName
		call	sub_10021C00
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
PR_MakeDir	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 309. PR_RmDir

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_RmDir(LPCSTR lpPathName)
		public PR_RmDir
PR_RmDir	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpPathName	= dword	ptr  4

		mov	eax, [esp+lpPathName]
		push	eax		; lpPathName
		call	sub_10021CA0
		xor	ecx, ecx
		add	esp, 4
		test	eax, eax
		setns	cl
		lea	eax, [ecx-1]
		retn
PR_RmDir	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100140A0	proc near		; DATA XREF: .data:10030388o
					; .data:10030418o

arg_0		= dword	ptr  4
lpBuffer	= dword	ptr  8
nNumberOfBytesToRead= dword ptr	 0Ch

		push	esi
		push	edi
		xor	edi, edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, eax
		mov	eax, [esi+90h]
		test	eax, 1000h
		jnz	short loc_100140D6
		test	al, 2
		jz	short loc_100140D6
		and	eax, 0FFFFFFFDh
		push	edi
		push	0FFFFE897h
		mov	[esi+90h], eax
		call	PR_SetError
		add	esp, 8
		or	edi, 0FFFFFFFFh

loc_100140D6:				; CODE XREF: sub_100140A0+16j
					; sub_100140A0+1Aj
		cmp	dword ptr [esi+0A4h], 0
		jz	short loc_100140F4
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100140F4:				; CODE XREF: sub_100140A0+3Dj
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_100140FE
		or	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100140FE:				; CODE XREF: sub_100140A0+57j
		mov	eax, [esp+8+nNumberOfBytesToRead]
		mov	ecx, [esp+8+lpBuffer]
		mov	edx, [esp+8+arg_0]
		push	eax		; nNumberOfBytesToRead
		push	ecx		; lpBuffer
		push	edx		; int
		call	sub_100204F0
		mov	esi, eax
		mov	eax, dword_10032A98
		add	esp, 0Ch
		cmp	dword ptr [eax+4], 4
		jl	short loc_10014130
		push	esi
		push	offset aReadD	; "read	-> %d"
		call	PR_LogPrint
		add	esp, 8

loc_10014130:				; CODE XREF: sub_100140A0+80j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_100140A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014140	proc near		; DATA XREF: .data:1003038Co
					; .data:1003041Co

arg_0		= dword	ptr  4
lpBuffer	= dword	ptr  8
nNumberOfBytesToWrite= dword ptr  0Ch

		push	esi
		push	edi
		xor	edi, edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, eax
		mov	eax, [esi+90h]
		test	eax, 1000h
		jnz	short loc_10014176
		test	al, 2
		jz	short loc_10014176
		and	eax, 0FFFFFFFDh
		push	edi
		push	0FFFFE897h
		mov	[esi+90h], eax
		call	PR_SetError
		add	esp, 8
		or	edi, 0FFFFFFFFh

loc_10014176:				; CODE XREF: sub_10014140+16j
					; sub_10014140+1Aj
		cmp	dword ptr [esi+0A4h], 0
		jz	short loc_10014196
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	edi, 0FFFFFFFFh
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014196:				; CODE XREF: sub_10014140+3Dj
		test	edi, edi
		jz	short loc_1001419F
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001419F:				; CODE XREF: sub_10014140+58j
		mov	edi, [esp+8+arg_0]
		mov	eax, [edi+4]
		push	ebp
		xor	ebp, ebp
		cmp	[eax+20h], ebp
		jz	short loc_100141C8
		push	2
		push	ebp
		push	ebp
		push	edi
		call	PR_Seek64
		and	eax, edx
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100141C8
		pop	ebp
		pop	edi
		or	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100141C8:				; CODE XREF: sub_10014140+6Cj
					; sub_10014140+80j
		mov	esi, [esp+0Ch+nNumberOfBytesToWrite]
		test	esi, esi
		jle	short loc_100141FD
		push	ebx
		mov	ebx, [esp+10h+lpBuffer]

loc_100141D5:				; CODE XREF: sub_10014140+B5j
		push	esi		; nNumberOfBytesToWrite
		push	ebx		; lpBuffer
		push	edi		; int
		call	sub_10020970
		add	esp, 0Ch
		test	eax, eax
		js	short loc_100141F9
		mov	ecx, [edi+4]
		add	ebp, eax
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_100141FC
		sub	esi, eax
		add	ebx, eax
		test	esi, esi
		jg	short loc_100141D5
		jmp	short loc_100141FC
; ---------------------------------------------------------------------------

loc_100141F9:				; CODE XREF: sub_10014140+A2j
		or	ebp, 0FFFFFFFFh

loc_100141FC:				; CODE XREF: sub_10014140+ADj
					; sub_10014140+B7j
		pop	ebx

loc_100141FD:				; CODE XREF: sub_10014140+8Ej
		mov	edx, dword_10032A98
		cmp	dword ptr [edx+4], 4
		jl	short loc_10014217
		push	ebp
		push	offset aWriteD	; "write -> %d"
		call	PR_LogPrint
		add	esp, 8

loc_10014217:				; CODE XREF: sub_10014140+C7j
		mov	eax, ebp
		pop	ebp
		pop	edi
		pop	esi
		retn
sub_10014140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

; int __cdecl sub_10014220(int,	LONG lDistanceToMove, int)
sub_10014220	proc near		; DATA XREF: .data:1003039Co
		jmp	sub_10020E50
sub_10014220	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014230	proc near		; DATA XREF: .data:100303A0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_C]
		mov	ecx, [esp+arg_8]
		mov	edx, [esp+arg_4]
		push	eax
		mov	eax, [esp+4+arg_0]
		push	ecx
		push	edx
		push	eax
		call	sub_10020EE0
		add	esp, 10h
		retn
sub_10014230	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014250	proc near		; DATA XREF: .data:10030390o

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	esi
		push	edi
		push	1		; int
		push	0		; lDistanceToMove
		push	ebx		; int
		call	sub_10020E50
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		js	short loc_10014291
		push	2		; int
		push	0		; lDistanceToMove
		push	ebx		; int
		call	sub_10020E50
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		js	short loc_10014291
		push	0		; int
		push	esi		; lDistanceToMove
		push	ebx		; int
		call	sub_10020E50
		add	esp, 0Ch
		mov	eax, edi
		pop	edi
		sub	eax, esi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10014291:				; CODE XREF: sub_10014250+18j
					; sub_10014250+2Bj
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
sub_10014250	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100142A0	proc near		; DATA XREF: .data:10030394o

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		push	1
		push	0
		push	0
		push	ebx
		call	sub_10020EE0
		mov	esi, edx
		add	esp, 10h
		mov	edi, eax
		test	esi, esi
		jl	short loc_10014300
		jg	short loc_100142C5
		test	edi, edi
		jb	short loc_10014300

loc_100142C5:				; CODE XREF: sub_100142A0+1Fj
		push	2
		push	0
		push	0
		push	ebx
		call	sub_10020EE0
		mov	ebx, edx
		add	esp, 10h
		mov	ebp, eax
		test	ebx, ebx
		jl	short loc_10014300
		jg	short loc_100142E2
		test	ebp, ebp
		jb	short loc_10014300

loc_100142E2:				; CODE XREF: sub_100142A0+3Cj
		mov	eax, [esp+10h+arg_0]
		push	0
		push	esi
		push	edi
		push	eax
		call	sub_10020EE0
		add	esp, 10h
		mov	eax, ebp
		sub	eax, edi
		mov	edx, ebx
		pop	edi
		sbb	edx, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10014300:				; CODE XREF: sub_100142A0+1Dj
					; sub_100142A0+23j ...
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		or	edx, eax
		pop	ebx
		retn
sub_100142A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_10014310	proc near		; DATA XREF: .data:10030420o
		jmp	sub_10020E20
sub_10014310	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014320	proc near		; DATA XREF: .data:10030424o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_10020E20
		add	esp, 4
		cdq
		retn
sub_10014320	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014330	proc near		; CODE XREF: PR_DeleteSharedMemory:loc_10008BFEj
					; PR_Select+13p ...
		xor	eax, eax
		retn
sub_10014330	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014340	proc near		; DATA XREF: .data:100303A4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	sub_10021A70
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
sub_10014340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014360	proc near		; DATA XREF: .data:100303A8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	eax
		push	ecx
		call	sub_100219A0
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
sub_10014360	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014380	proc near		; DATA XREF: .data:10030398o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	sub_10020FA0
		xor	ecx, ecx
		add	esp, 4
		test	eax, eax
		setns	cl
		lea	eax, [ecx-1]
		retn
sub_10014380	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100143A0(void	*Memory)
sub_100143A0	proc near		; DATA XREF: .data:10030384o
					; .data:10030414o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		test	esi, esi
		jz	short loc_100143EF
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_100143EF
		mov	eax, [ecx]
		cmp	eax, 0AAAAAAAAh
		jz	short loc_100143C7
		cmp	eax, 55555555h
		jnz	short loc_100143EF
		cmp	eax, 0AAAAAAAAh
		jnz	short loc_100143E2

loc_100143C7:				; CODE XREF: sub_100143A0+17j
		mov	eax, [ecx+28h]
		push	0		; int
		push	eax		; s
		call	sub_10020FF0
		add	esp, 8
		test	eax, eax
		js	short loc_100143FE
		mov	ecx, [esi+4]
		mov	dword ptr [ecx], 55555555h

loc_100143E2:				; CODE XREF: sub_100143A0+25j
		push	esi		; Memory
		call	PR_FreeFileDesc
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100143EF:				; CODE XREF: sub_100143A0+7j
					; sub_100143A0+Ej ...
		push	0
		push	0FFFFE891h
		call	PR_SetError
		add	esp, 8

loc_100143FE:				; CODE XREF: sub_100143A0+37j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_100143A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014410	proc near		; DATA XREF: .data:100303D4o
					; .data:10030464o ...

arg_4		= word ptr  8
arg_8		= dword	ptr  0Ch

		mov	ecx, [esp+arg_8]
		xor	eax, eax
		mov	[ecx], ax
		mov	ax, [esp+arg_4]
		retn
sub_10014410	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 156. PR_GetFileMethods

; =============== S U B	R O U T	I N E =======================================


		public PR_GetFileMethods
PR_GetFileMethods proc near		; CODE XREF: sub_10014A90+4p
					; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, offset dword_10030380
		retn
PR_GetFileMethods endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 180. PR_GetPipeMethods

; =============== S U B	R O U T	I N E =======================================


		public PR_GetPipeMethods
PR_GetPipeMethods proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, offset dword_10030410
		retn
PR_GetPipeMethods endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 270. PR_Open

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_Open(LPCSTR lpFileName, int, int)
		public PR_Open
PR_Open		proc near		; CODE XREF: sub_100113B0+73p
					; DATA XREF: .rdata:off_1002C7C8o

lpFileName	= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		push	edi
		mov	edi, esi
		shr	edi, 4
		xor	ebp, ebp
		and	edi, 1
		cmp	dword_10031520,	ebp
		jnz	short loc_1001445F
		call	PR_Init

loc_1001445F:				; CODE XREF: PR_Open+18j
		mov	eax, [esp+10h+arg_8]
		mov	ecx, [esp+10h+lpFileName]
		push	eax
		push	esi		; int
		push	ecx		; lpFileName
		call	sub_10020200
		mov	ebx, eax
		add	esp, 0Ch
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_100144B5
		push	offset dword_10030380
		push	ebx
		call	PR_AllocFileDesc
		add	esp, 8
		mov	esi, eax
		push	0		; int
		test	esi, esi
		jnz	short loc_1001449F
		push	ebx		; s
		call	sub_10020FF0
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001449F:				; CODE XREF: PR_Open+4Dj
		mov	edx, [esi+4]
		push	esi
		mov	[edx+20h], edi
		call	sub_100211B0
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100144B5:				; CODE XREF: PR_Open+37j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		retn
PR_Open		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 273. PR_OpenFile

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_OpenFile(LPCSTR lpFileName, int, int)
		public PR_OpenFile
PR_OpenFile	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpFileName	= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		push	edi
		mov	edi, esi
		shr	edi, 4
		xor	ebp, ebp
		and	edi, 1
		cmp	dword_10031520,	ebp
		jnz	short loc_100144DF
		call	PR_Init

loc_100144DF:				; CODE XREF: PR_OpenFile+18j
		mov	eax, [esp+10h+arg_8]
		mov	ecx, [esp+10h+lpFileName]
		push	eax		; int
		push	esi		; int
		push	ecx		; lpFileName
		call	sub_10020340
		mov	ebx, eax
		add	esp, 0Ch
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_10014535
		push	offset dword_10030380
		push	ebx
		call	PR_AllocFileDesc
		add	esp, 8
		mov	esi, eax
		push	0		; int
		test	esi, esi
		jnz	short loc_1001451F
		push	ebx		; s
		call	sub_10020FF0
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001451F:				; CODE XREF: PR_OpenFile+4Dj
		mov	edx, [esi+4]
		push	esi
		mov	[edx+20h], edi
		call	sub_100211B0
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10014535:				; CODE XREF: PR_OpenFile+37j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		retn
PR_OpenFile	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 189. PR_GetSysfdTableMax

; =============== S U B	R O U T	I N E =======================================


		public PR_GetSysfdTableMax
PR_GetSysfdTableMax proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, 4000h
		retn
PR_GetSysfdTableMax endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  77. PR_Delete

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_Delete(LPCSTR lpFileName)
		public PR_Delete
PR_Delete	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpFileName	= dword	ptr  4

		mov	eax, [esp+lpFileName]
		push	eax		; lpFileName
		call	sub_100215E0
		xor	ecx, ecx
		add	esp, 4
		test	eax, eax
		setns	cl
		lea	eax, [ecx-1]
		retn
PR_Delete	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 154. PR_GetFileInfo

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetFileInfo(LPCSTR lpFileName,	int)
		public PR_GetFileInfo
PR_GetFileInfo	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpFileName	= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+lpFileName]
		push	eax		; int
		push	ecx		; lpFileName
		call	sub_10021930
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
PR_GetFileInfo	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 155. PR_GetFileInfo64

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetFileInfo64(LPCSTR lpFileName, int)
		public PR_GetFileInfo64
PR_GetFileInfo64 proc near		; DATA XREF: .rdata:off_1002C7C8o

lpFileName	= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword_10031520,	0
		jnz	short loc_1001459E
		call	PR_Init

loc_1001459E:				; CODE XREF: PR_GetFileInfo64+7j
		mov	eax, [esp+arg_4]
		mov	ecx, [esp+lpFileName]
		push	eax		; int
		push	ecx		; lpFileName
		call	sub_10021820
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
PR_GetFileInfo64 endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 305. PR_Rename

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_Rename(LPCSTR lpExistingFileName, LPCSTR lpNewFileName)
		public PR_Rename
PR_Rename	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpExistingFileName= dword ptr  4
lpNewFileName	= dword	ptr  8

		mov	eax, [esp+lpNewFileName]
		mov	ecx, [esp+lpExistingFileName]
		push	eax		; lpNewFileName
		push	ecx		; lpExistingFileName
		call	sub_10021B10
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
PR_Rename	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  15. PR_Access

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_Access(char *,	int)
		public PR_Access
PR_Access	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		push	eax		; int
		push	ecx		; char *
		call	sub_10021B40
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
PR_Access	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 208. PR_ImportFile

; =============== S U B	R O U T	I N E =======================================


		public PR_ImportFile
PR_ImportFile	proc near		; CODE XREF: PR_GetInheritedFD+C5p
					; DATA XREF: .rdata:off_1002C7C8o

s		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1001460E
		call	PR_Init

loc_1001460E:				; CODE XREF: PR_ImportFile+7j
		push	esi
		push	edi
		mov	edi, [esp+8+s]
		push	offset dword_10030380
		push	edi
		call	PR_AllocFileDesc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10014637
		push	eax		; int
		push	edi		; s
		call	sub_10020FF0
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014637:				; CODE XREF: PR_ImportFile+26j
		push	1
		push	esi
		call	sub_100211B0
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_ImportFile	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 210. PR_ImportPipe

; =============== S U B	R O U T	I N E =======================================


		public PR_ImportPipe
PR_ImportPipe	proc near		; CODE XREF: PR_GetInheritedFD+D1p
					; DATA XREF: .rdata:off_1002C7C8o

s		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1001465E
		call	PR_Init

loc_1001465E:				; CODE XREF: PR_ImportPipe+7j
		push	esi
		push	edi
		mov	edi, [esp+8+s]
		push	offset dword_10030410
		push	edi
		call	PR_AllocFileDesc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10014687
		push	eax		; int
		push	edi		; s
		call	sub_10020FF0
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014687:				; CODE XREF: PR_ImportPipe+26j
		push	1
		push	esi
		call	sub_100211B0
		mov	eax, [esi+4]
		add	esp, 8
		mov	dword ptr [eax+30h], 1
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_ImportPipe	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 350. PR_Stat
; [00000005 BYTES: COLLAPSED FUNCTION PR_Stat]
		align 10h
; Exported entry 234. PR_LockFile

; =============== S U B	R O U T	I N E =======================================


		public PR_LockFile
PR_LockFile	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	eax, [esi+4]
		push	edi
		xor	edi, edi
		cmp	[eax+2Ch], edi
		jnz	short loc_100146E7
		mov	eax, [eax+28h]
		push	eax		; FileHandle
		call	sub_1001E100
		mov	ecx, [esi+4]
		add	esp, 4
		mov	dword ptr [ecx+2Ch], 1

loc_100146E7:				; CODE XREF: PR_LockFile+Fj
		mov	edx, dword_10032A84
		push	edx
		call	PR_Lock
		mov	eax, [esi+4]
		or	ebx, 0FFFFFFFFh
		add	esp, 4
		cmp	[eax+10h], ebx
		jnz	short loc_10014719

loc_10014701:				; CODE XREF: PR_LockFile+57j
		mov	ecx, dword_10032A88
		push	ebx
		push	ecx
		call	PR_WaitCondVar
		mov	edx, [esi+4]
		add	esp, 8
		cmp	[edx+10h], ebx
		jz	short loc_10014701

loc_10014719:				; CODE XREF: PR_LockFile+3Fj
		mov	eax, [esi+4]
		cmp	[eax+10h], edi
		jnz	short loc_10014765
		mov	[eax+10h], ebx
		mov	eax, dword_10032A84
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	ecx, [esi+4]
		mov	edx, [ecx+28h]
		push	edx		; hFile
		call	sub_10021CD0
		mov	edi, eax
		mov	eax, dword_10032A84
		push	eax
		call	PR_Lock
		mov	edx, [esi+4]
		xor	ecx, ecx
		test	edi, edi
		setz	cl
		mov	[edx+10h], ecx
		mov	eax, dword_10032A88
		push	eax
		call	PR_NotifyAllCondVar
		add	esp, 10h
		jmp	short loc_1001476A
; ---------------------------------------------------------------------------

loc_10014765:				; CODE XREF: PR_LockFile+5Fj
		mov	esi, eax
		inc	dword ptr [esi+10h]

loc_1001476A:				; CODE XREF: PR_LockFile+A3j
		mov	ecx, dword_10032A84
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
PR_LockFile	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 356. PR_TLockFile

; =============== S U B	R O U T	I N E =======================================


		public PR_TLockFile
PR_TLockFile	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+4]
		push	edi
		xor	edi, edi
		cmp	[eax+2Ch], edi
		jnz	short loc_100147A6
		mov	eax, [eax+28h]
		push	eax		; FileHandle
		call	sub_1001E100
		mov	ecx, [esi+4]
		add	esp, 4
		mov	dword ptr [ecx+2Ch], 1

loc_100147A6:				; CODE XREF: PR_TLockFile+Ej
		mov	edx, dword_10032A84
		push	edx
		call	PR_Lock
		mov	eax, [esi+4]
		add	esp, 4
		cmp	[eax+10h], edi
		jnz	short loc_100147ED
		mov	eax, [eax+28h]
		push	eax		; hFile
		call	sub_10021FF0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_100147F2
		mov	ecx, [esi+4]
		mov	dword ptr [ecx+10h], 1
		mov	edx, dword_10032A84
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100147ED:				; CODE XREF: PR_TLockFile+3Bj
		mov	esi, eax
		inc	dword ptr [esi+10h]

loc_100147F2:				; CODE XREF: PR_TLockFile+4Dj
		mov	edx, dword_10032A84
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
PR_TLockFile	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 368. PR_UnlockFile

; =============== S U B	R O U T	I N E =======================================


		public PR_UnlockFile
PR_UnlockFile	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, dword_10032A84
		push	esi
		push	edi
		push	eax
		xor	esi, esi
		call	PR_Lock
		mov	edi, [esp+0Ch+arg_0]
		mov	eax, [edi+4]
		add	esp, 4
		cmp	dword ptr [eax+10h], 1
		jnz	short loc_1001485A
		mov	ecx, [eax+28h]
		push	ecx		; hFile
		call	sub_100223F0
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_1001485F
		mov	edx, [edi+4]
		mov	[edx+10h], eax
		mov	eax, dword_10032A84
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001485A:				; CODE XREF: PR_UnlockFile+1Dj
		mov	edi, eax
		dec	dword ptr [edi+10h]

loc_1001485F:				; CODE XREF: PR_UnlockFile+2Fj
		mov	eax, dword_10032A84
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_UnlockFile	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  66. PR_CreatePipe

; =============== S U B	R O U T	I N E =======================================


		public PR_CreatePipe
PR_CreatePipe	proc near		; DATA XREF: .rdata:off_1002C7C8o

hWritePipe	= dword	ptr -14h
hReadPipe	= dword	ptr -10h
PipeAttributes	= _SECURITY_ATTRIBUTES ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 14h
		cmp	dword_10031520,	0
		jnz	short loc_10014891
		call	PR_Init

loc_10014891:				; CODE XREF: PR_CreatePipe+Aj
		push	edi
		xor	eax, eax
		push	eax		; nSize
		mov	[esp+1Ch+PipeAttributes.nLength], eax
		mov	[esp+1Ch+PipeAttributes.bInheritHandle], eax
		mov	[esp+1Ch+PipeAttributes.lpSecurityDescriptor], eax
		lea	eax, [esp+1Ch+PipeAttributes]
		push	eax		; lpPipeAttributes
		lea	ecx, [esp+20h+hWritePipe]
		push	ecx		; hWritePipe
		lea	edx, [esp+24h+hReadPipe]
		mov	edi, 1
		push	edx		; hReadPipe
		mov	[esp+28h+PipeAttributes.nLength], 0Ch
		mov	[esp+28h+PipeAttributes.bInheritHandle], edi
		call	ds:CreatePipe
		test	eax, eax
		jnz	short loc_100148E7
		call	ds:GetLastError
		push	eax
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100148E7:				; CODE XREF: PR_CreatePipe+49j
		mov	eax, [esp+18h+hReadPipe]
		push	esi
		push	offset dword_10030410
		push	eax
		call	PR_AllocFileDesc
		mov	esi, [esp+24h+arg_0]
		add	esp, 8
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_10014921
		mov	ecx, [esp+1Ch+hReadPipe]
		mov	esi, ds:CloseHandle
		push	ecx		; hObject
		call	esi ; CloseHandle
		mov	edx, [esp+1Ch+hWritePipe]
		push	edx		; hObject
		call	esi ; CloseHandle
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10014921:				; CODE XREF: PR_CreatePipe+82j
		mov	eax, [esp+1Ch+hWritePipe]
		push	offset dword_10030410
		push	eax
		call	PR_AllocFileDesc
		mov	ecx, [esp+24h+arg_4]
		add	esp, 8
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_1001495C
		mov	ecx, [esi]
		push	ecx
		call	PR_Close
		mov	edx, [esp+20h+hWritePipe]
		add	esp, 4
		push	edx		; hObject
		call	ds:CloseHandle
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	edi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_1001495C:				; CODE XREF: PR_CreatePipe+BBj
		mov	eax, [esi]
		mov	edx, [eax+4]
		mov	[edx+30h], edi
		mov	eax, [ecx]
		mov	edx, [eax+4]
		mov	[edx+30h], edi
		mov	eax, [esi]
		mov	edx, [eax+4]
		mov	[edx+8], edi
		mov	eax, [ecx]
		mov	ecx, [eax+4]
		pop	esi
		mov	[ecx+8], edi
		xor	eax, eax
		pop	edi
		add	esp, 14h
		retn
PR_CreatePipe	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 187. PR_GetSpecialFD

; =============== S U B	R O U T	I N E =======================================


		public PR_GetSpecialFD
PR_GetSpecialFD	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		xor	esi, esi
		cmp	dword_10031520,	esi
		jnz	short loc_100149A0
		call	PR_Init

loc_100149A0:				; CODE XREF: PR_GetSpecialFD+9j
		mov	eax, [esp+4+arg_0]
		sub	eax, 0
		jz	short loc_100149D0
		dec	eax
		jz	short loc_100149C9
		dec	eax
		jz	short loc_100149C2
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100149C2:				; CODE XREF: PR_GetSpecialFD+1Dj
		mov	eax, dword_10032A9C
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100149C9:				; CODE XREF: PR_GetSpecialFD+1Aj
		mov	eax, dword_10032AAC
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100149D0:				; CODE XREF: PR_GetSpecialFD+17j
		mov	eax, dword_10032ABC
		pop	esi
		retn
PR_GetSpecialFD	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  18. PR_AllocFileDesc

; =============== S U B	R O U T	I N E =======================================


		public PR_AllocFileDesc
PR_AllocFileDesc proc near		; CODE XREF: PR_Open+3Fp
					; PR_OpenFile+3Fp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		call	sub_10001010
		mov	esi, eax
		test	esi, esi
		jz	short loc_10014A09
		mov	eax, [esp+4+arg_4]
		mov	ecx, [esi+4]
		mov	[esi], eax
		mov	eax, [esp+4+arg_0]
		mov	dword ptr [ecx], 0AAAAAAAAh
		mov	edx, [esi+4]
		mov	[edx+28h], eax
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014A09:				; CODE XREF: PR_AllocFileDesc+Aj
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
PR_AllocFileDesc endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 136. PR_FreeFileDesc
; [00000005 BYTES: COLLAPSED FUNCTION PR_FreeFileDesc]
		align 10h
; Exported entry 280. PR_Poll
; [00000005 BYTES: COLLAPSED FUNCTION PR_Poll]
		align 10h
; Exported entry 327. PR_SetFDInheritable

; =============== S U B	R O U T	I N E =======================================


		public PR_SetFDInheritable
PR_SetFDInheritable proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+14h], 0
		jz	short loc_10014A5F
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014A5F:				; CODE XREF: PR_SetFDInheritable+9j
		mov	eax, [esi+4]
		push	edi
		mov	edi, [esp+8+arg_4]
		cmp	[eax+8], edi
		jz	short loc_10014A86
		push	edi
		push	esi
		call	sub_10021140
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10014A80
		pop	edi
		or	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014A80:				; CODE XREF: PR_SetFDInheritable+39j
		mov	ecx, [esi+4]
		mov	[ecx+8], edi

loc_10014A86:				; CODE XREF: PR_SetFDInheritable+2Aj
		pop	edi
		xor	eax, eax
		pop	esi
		retn
PR_SetFDInheritable endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014A90	proc near		; CODE XREF: PR_Init_0+112p
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_GetFileMethods
		mov	edi, eax
		call	sub_100012C0
		call	PR_NewLock
		push	eax
		mov	dword_10032A84,	eax
		call	PR_NewCondVar
		mov	ebx, ds:GetStdHandle
		add	esp, 4
		push	0FFFFFFF6h	; nStdHandle
		mov	dword_10032A88,	eax
		call	ebx ; GetStdHandle
		mov	ebp, eax
		call	sub_10001010
		mov	esi, eax
		test	esi, esi
		jz	short loc_10014AE2
		mov	eax, [esi+4]
		mov	[esi], edi
		mov	dword ptr [eax], 0AAAAAAAAh
		mov	ecx, [esi+4]
		mov	[ecx+28h], ebp
		jmp	short loc_10014AF1
; ---------------------------------------------------------------------------

loc_10014AE2:				; CODE XREF: sub_10014A90+3Dj
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8

loc_10014AF1:				; CODE XREF: sub_10014A90+50j
		push	0FFFFFFF5h	; nStdHandle
		mov	dword_10032ABC,	esi
		call	ebx ; GetStdHandle
		mov	ebp, eax
		call	sub_10001010
		mov	esi, eax
		test	esi, esi
		jz	short loc_10014B1B
		mov	edx, [esi+4]
		mov	[esi], edi
		mov	dword ptr [edx], 0AAAAAAAAh
		mov	eax, [esi+4]
		mov	[eax+28h], ebp
		jmp	short loc_10014B2A
; ---------------------------------------------------------------------------

loc_10014B1B:				; CODE XREF: sub_10014A90+76j
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8

loc_10014B2A:				; CODE XREF: sub_10014A90+89j
		push	0FFFFFFF4h	; nStdHandle
		mov	dword_10032AAC,	esi
		call	ebx ; GetStdHandle
		mov	ebx, eax
		call	sub_10001010
		mov	esi, eax
		test	esi, esi
		jz	short loc_10014B54
		mov	ecx, [esi+4]
		mov	[esi], edi
		mov	dword ptr [ecx], 0AAAAAAAAh
		mov	edx, [esi+4]
		mov	[edx+28h], ebx
		jmp	short loc_10014B63
; ---------------------------------------------------------------------------

loc_10014B54:				; CODE XREF: sub_10014A90+AFj
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8

loc_10014B63:				; CODE XREF: sub_10014A90+C2j
		mov	eax, dword_10032ABC
		mov	dword_10032A9C,	esi
		mov	ecx, [eax+4]
		mov	esi, 1
		mov	[ecx+30h], esi
		mov	edx, dword_10032AAC
		mov	eax, [edx+4]
		mov	[eax+30h], esi
		mov	ecx, dword_10032A9C
		mov	edx, [ecx+4]
		mov	[edx+30h], esi
		mov	eax, dword_10032ABC
		push	esi
		push	eax
		call	sub_100211B0
		mov	ecx, dword_10032AAC
		push	esi
		push	ecx
		call	sub_100211B0
		mov	edx, dword_10032A9C
		push	esi
		push	edx
		call	sub_100211B0
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		jmp	sub_1001DFF0
sub_10014A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014BD0	proc near		; CODE XREF: PR_Cleanup+E1p
		mov	eax, dword_10032ABC
		push	esi
		push	eax		; Memory
		call	PR_FreeFileDesc_0
		mov	ecx, dword_10032AAC
		xor	esi, esi
		push	ecx		; Memory
		mov	dword_10032ABC,	esi
		call	PR_FreeFileDesc_0
		mov	edx, dword_10032A9C
		push	edx		; Memory
		mov	dword_10032AAC,	esi
		call	PR_FreeFileDesc_0
		mov	eax, dword_10032A88
		add	esp, 0Ch
		mov	dword_10032A9C,	esi
		cmp	eax, esi
		jz	short loc_10014C23
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	dword_10032A88,	esi

loc_10014C23:				; CODE XREF: sub_10014BD0+42j
		mov	eax, dword_10032A84
		cmp	eax, esi
		jz	short loc_10014C3B
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10032A84,	esi

loc_10014C3B:				; CODE XREF: sub_10014BD0+5Aj
		pop	esi
		jmp	sub_10001370
sub_10014BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014C50	proc near		; DATA XREF: .data:100304CCo
					; .data:1003055Co

var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 5Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+5Ch+var_4], eax
		mov	eax, [esp+5Ch+arg_0]
		push	ebx
		mov	ebx, [esp+60h+arg_8]
		push	ebp
		push	edi
		mov	edi, [esp+68h+arg_4]
		mov	[esp+68h+var_4C], eax
		mov	[esp+68h+var_54], ebx
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		xor	edx, edx
		xor	ebp, ebp
		mov	[esp+68h+var_5C], edx
		mov	[esp+68h+var_58], edx
		test	ecx, 1000h
		jnz	short loc_10014CC5
		test	cl, 2
		jz	short loc_10014CC5
		push	edx
		and	ecx, 0FFFFFFFDh
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+5Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_10014CC5:				; CODE XREF: sub_10014C50+42j
					; sub_10014C50+47j
		cmp	[eax+0A4h], edx
		jz	short loc_10014CF0
		push	edx
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+5Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_10014CF0:				; CODE XREF: sub_10014C50+7Bj
		push	esi
		xor	esi, esi
		xor	eax, eax
		mov	[esp+6Ch+var_50], edi
		cmp	ebx, 2
		jl	short loc_10014D23
		lea	ecx, [ebx-2]
		shr	ecx, 1
		inc	ecx
		lea	ebx, [ecx+ecx]
		lea	eax, [edi+0Ch]
		mov	[esp+6Ch+var_48], ebx
		mov	edi, edi

loc_10014D10:				; CODE XREF: sub_10014C50+C9j
		add	edx, [eax-8]
		add	esi, [eax]
		add	eax, 10h
		dec	ecx
		jnz	short loc_10014D10
		mov	ebx, [esp+6Ch+var_54]
		mov	eax, [esp+6Ch+var_48]

loc_10014D23:				; CODE XREF: sub_10014C50+ACj
		cmp	eax, ebx
		jge	short loc_10014D2F
		mov	ecx, [edi+eax*8+4]
		mov	[esp+6Ch+var_58], ecx

loc_10014D2F:				; CODE XREF: sub_10014C50+D5j
		add	esi, edx
		add	[esp+6Ch+var_58], esi
		mov	eax, ebx
		cmp	[esp+6Ch+var_58], ebp
		jle	loc_10014E14

loc_10014D41:				; CODE XREF: sub_10014C50+19Aj
					; sub_10014C50+1B7j
		mov	edx, [esp+6Ch+arg_C]
		mov	esi, [esp+6Ch+var_4C]
		push	edx
		push	eax
		mov	eax, [esp+74h+var_50]
		push	eax
		push	esi
		call	sub_1001FEB0
		add	esp, 10h
		test	eax, eax
		js	loc_10014E0C
		mov	ecx, [esi+4]
		add	[esp+6Ch+var_5C], eax
		cmp	dword ptr [ecx+4], 0
		jnz	loc_10014E14
		mov	ecx, [esp+6Ch+var_58]
		sub	ecx, eax
		mov	[esp+6Ch+var_58], ecx
		test	ecx, ecx
		jle	loc_10014E14
		mov	ebx, [esp+6Ch+var_5C]
		mov	eax, [edi+4]
		xor	esi, esi
		cmp	ebx, eax
		jl	short loc_10014D9C

loc_10014D91:				; CODE XREF: sub_10014C50+14Aj
		inc	esi
		sub	ebx, eax
		mov	eax, [edi+esi*8+4]
		cmp	ebx, eax
		jge	short loc_10014D91

loc_10014D9C:				; CODE XREF: sub_10014C50+13Fj
		cmp	[esp+6Ch+var_50], edi
		jnz	short loc_10014DCF
		mov	eax, [esp+6Ch+var_54]
		sub	eax, esi
		cmp	eax, 8
		jg	short loc_10014DB3
		lea	ebp, [esp+6Ch+var_44]
		jmp	short loc_10014DCB
; ---------------------------------------------------------------------------

loc_10014DB3:				; CODE XREF: sub_10014C50+15Bj
		lea	edx, ds:0[eax*8]
		push	edx		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	ebp, eax
		add	esp, 8
		test	ebp, ebp
		jz	short loc_10014E3C

loc_10014DCB:				; CODE XREF: sub_10014C50+161j
		mov	[esp+6Ch+var_50], ebp

loc_10014DCF:				; CODE XREF: sub_10014C50+150j
		mov	eax, [edi+esi*8]
		add	eax, ebx
		mov	[ebp+0], eax
		mov	ecx, [edi+esi*8+4]
		sub	ecx, ebx
		inc	esi
		mov	[ebp+4], ecx
		mov	eax, 1
		cmp	esi, [esp+6Ch+var_54]
		jge	loc_10014D41

loc_10014DF0:				; CODE XREF: sub_10014C50+1B5j
		mov	edx, [edi+esi*8]
		mov	[ebp+eax*8+0], edx
		mov	ecx, [edi+esi*8+4]
		mov	[ebp+eax*8+4], ecx
		inc	esi
		inc	eax
		cmp	esi, [esp+6Ch+var_54]
		jl	short loc_10014DF0
		jmp	loc_10014D41
; ---------------------------------------------------------------------------

loc_10014E0C:				; CODE XREF: sub_10014C50+10Bj
		mov	[esp+6Ch+var_5C], 0FFFFFFFFh

loc_10014E14:				; CODE XREF: sub_10014C50+EBj
					; sub_10014C50+11Cj ...
		lea	edx, [esp+6Ch+var_44]
		cmp	ebp, edx
		jz	short loc_10014E25
		push	ebp		; Memory
		call	PR_Free
		add	esp, 4

loc_10014E25:				; CODE XREF: sub_10014C50+1CAj
		mov	eax, [esp+6Ch+var_5C]
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		mov	ecx, [esp+5Ch+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_10014E3C:				; CODE XREF: sub_10014C50+179j
		push	0
		push	0FFFFE890h
		call	PR_SetError
		mov	ecx, [esp+74h+var_4]
		add	esp, 8
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		or	eax, 0FFFFFFFFh
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
sub_10014C50	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  91. PR_DestroySocketPollFd

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroySocketPollFd(void *Memory)
		public PR_DestroySocketPollFd
PR_DestroySocketPollFd proc near	; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		mov	eax, [esp+Memory]
		test	eax, eax
		jnz	short loc_10014E8A
		push	eax
		push	0FFFFE891h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10014E8A:				; CODE XREF: PR_DestroySocketPollFd+6j
		mov	ecx, [eax+4]
		push	eax		; Memory
		mov	dword ptr [ecx], 55555555h
		call	PR_FreeFileDesc_0
		add	esp, 4
		xor	eax, eax
		retn
PR_DestroySocketPollFd endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10014EA0	proc near		; DATA XREF: .data:100304D0o
					; .data:10030560o

arg_0		= dword	ptr  4
name		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_10014ED4
		test	cl, 2
		jz	short loc_10014ED4
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10014ED4:				; CODE XREF: sub_10014EA0+11j
					; sub_10014EA0+16j
		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_0]
		push	esi
		push	eax		; int
		mov	eax, [esp+8+name]
		xor	ecx, ecx
		cmp	word ptr [eax],	2
		setnz	cl
		dec	ecx
		and	ecx, 0FFFFFFF4h
		add	ecx, 1Ch
		push	ecx		; namelen
		push	eax		; name
		push	edx		; int
		call	sub_1001E190
		mov	esi, eax
		mov	eax, dword_10032A98
		add	esp, 10h
		cmp	dword ptr [eax+4], 4
		jl	short loc_10014F18
		push	esi
		push	offset aConnectD ; "connect -> %d"
		call	PR_LogPrint
		add	esp, 8

loc_10014F18:				; CODE XREF: sub_10014EA0+68j
		neg	esi
		sbb	eax, eax
		pop	esi
		retn
sub_10014EA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10014F20(int,	int optlen)
sub_10014F20	proc near		; CODE XREF: PR_GetConnectStatus+2Fp
					; DATA XREF: .data:1003051Co

optval		= byte ptr -4
arg_0		= dword	ptr  4
optlen		= dword	ptr  8

		push	ecx
		mov	cl, byte ptr [esp+4+optlen]
		test	cl, 10h
		jz	short loc_10014F3E
		push	0
		push	0FFFFE891h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10014F3E:				; CODE XREF: sub_10014F20+8j
		test	cl, 0Eh
		jnz	short loc_10014F57
		push	0
		push	0FFFFE8D2h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10014F57:				; CODE XREF: sub_10014F20+21j
		mov	eax, [esp+4+arg_0]
		mov	edx, [eax+4]
		mov	eax, [edx+28h]
		test	cl, 4
		jz	short loc_10014FC9
		lea	ecx, [esp+4+optlen]
		push	ecx		; optlen
		lea	edx, [esp+8+optval]
		push	edx		; optval
		push	1007h		; optname
		push	0FFFFh		; level
		push	eax		; s
		mov	[esp+18h+optlen], 4
		call	getsockopt
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10014FA0
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10014FA0:				; CODE XREF: sub_10014F20+6Bj
		mov	eax, dword ptr [esp+4+optval]
		test	eax, eax
		jz	short loc_10014FB5
		push	eax
		call	sub_10025460
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10014FB5:				; CODE XREF: sub_10014F20+85j
		push	0
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10014FC9:				; CODE XREF: sub_10014F20+44j
		xor	eax, eax
		pop	ecx
		retn
sub_10014F20	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 141. PR_GetConnectStatus

; =============== S U B	R O U T	I N E =======================================


		public PR_GetConnectStatus
PR_GetConnectStatus proc near		; CODE XREF: sub_10010080+232p
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi]
		push	0
		push	eax
		call	PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_10014FF9
		push	eax
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10014FF9:				; CODE XREF: PR_GetConnectStatus+14j
		movzx	ecx, word ptr [esi+6]
		push	ecx		; optlen
		push	eax		; int
		call	sub_10014F20
		add	esp, 8
		pop	esi
		retn
PR_GetConnectStatus endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10015010(int,	struct sockaddr	*name)
sub_10015010	proc near		; DATA XREF: .data:100304D8o
					; .data:10030568o

arg_0		= dword	ptr  4
name		= dword	ptr  8

		mov	eax, [esp+name]
		mov	edx, [esp+arg_0]
		xor	ecx, ecx
		cmp	word ptr [eax],	2
		setnz	cl
		dec	ecx
		and	ecx, 0FFFFFFF4h
		add	ecx, 1Ch
		push	ecx		; namelen
		push	eax		; name
		push	edx		; int
		call	sub_1001E2A0
		xor	ecx, ecx
		add	esp, 0Ch
		test	eax, eax
		setns	cl
		lea	eax, [ecx-1]
		retn
sub_10015010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10015040(int,	int backlog)
sub_10015040	proc near		; DATA XREF: .data:100304DCo
					; .data:1003056Co

arg_0		= dword	ptr  4
backlog		= dword	ptr  8

		mov	eax, [esp+backlog]
		mov	ecx, [esp+arg_0]
		push	eax		; backlog
		push	ecx		; int
		call	sub_1001FFA0
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
sub_10015040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10015060(int,	int how)
sub_10015060	proc near		; DATA XREF: .data:100304E0o
					; .data:10030570o

arg_0		= dword	ptr  4
how		= dword	ptr  8

		mov	eax, [esp+how]
		mov	ecx, [esp+arg_0]
		push	eax		; how
		push	ecx		; int
		call	sub_1001FFE0
		xor	edx, edx
		add	esp, 8
		test	eax, eax
		setns	dl
		lea	eax, [edx-1]
		retn
sub_10015060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10015080(int,	void *Dst, size_t Size,	int, int)
sub_10015080	proc near		; DATA XREF: .data:100304E4o
					; .data:10030574o

arg_0		= dword	ptr  4
Dst		= dword	ptr  8
Size		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebx, [esp+4+arg_C]
		test	ebx, ebx
		jz	short loc_100150A7
		cmp	ebx, 2
		jz	short loc_100150A7
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100150A7:				; CODE XREF: sub_10015080+Cj
					; sub_10015080+11j
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_100150D7
		test	cl, 2
		jz	short loc_100150D7
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100150D7:				; CODE XREF: sub_10015080+33j
					; sub_10015080+38j
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_100150F4
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100150F4:				; CODE XREF: sub_10015080+5Ej
		mov	eax, dword_10032A98
		cmp	dword ptr [eax+4], 4
		push	ebp
		mov	ebp, [esp+8+Dst]
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		mov	edi, [esp+10h+Size]
		jl	short loc_10015126
		mov	ecx, [esi+4]
		mov	edx, [ecx+28h]
		push	ebx
		push	edi
		push	ebp
		push	edx
		push	esi
		push	offset aRecvFdPOsfdLdB ; "recv:	fd=%p osfd=%ld buf=%p amount=%d	f"...
		call	PR_LogPrint
		add	esp, 18h

loc_10015126:				; CODE XREF: sub_10015080+8Cj
		mov	eax, [esi+4]
		mov	ecx, [eax+1Ch]
		test	ecx, ecx
		jz	short loc_1001517C
		cmp	edi, ecx
		jl	short loc_10015136
		mov	edi, ecx

loc_10015136:				; CODE XREF: sub_10015080+B2j
		mov	eax, [eax+14h]
		push	edi		; Size
		push	eax		; Src
		push	ebp		; Dst
		call	memcpy
		add	esp, 0Ch
		test	ebx, ebx
		jnz	loc_10015252
		mov	eax, [esi+4]
		sub	[eax+1Ch], edi
		mov	ecx, [esi+4]
		cmp	[ecx+1Ch], ebx
		jz	loc_10015252
		mov	esi, ecx
		mov	eax, [esi+14h]
		mov	edx, [esi+1Ch]
		push	edx		; Size
		lea	ecx, [eax+edi]
		push	ecx		; Src
		push	eax		; Dst
		call	ds:memmove
		add	esp, 0Ch
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001517C:				; CODE XREF: sub_10015080+AEj
		cmp	ebx, 2
		jnz	short loc_100151ED
		cmp	dword ptr [eax+4], 0
		jnz	short loc_100151ED
		cmp	dword ptr [eax+8], 1
		jz	short loc_100151ED
		cmp	edi, 8000h
		jle	short loc_1001519A
		mov	edi, 8000h

loc_1001519A:				; CODE XREF: sub_10015080+113j
		cmp	[eax+18h], edi
		jge	short loc_100151ED
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_100151AF
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_100151AF:				; CODE XREF: sub_10015080+124j
		mov	edx, [esi+4]
		push	edi		; Size
		mov	[edx+18h], edi
		call	PR_Malloc
		mov	ecx, [esi+4]
		mov	[ecx+14h], eax
		mov	edx, [esi+4]
		add	esp, 4
		cmp	dword ptr [edx+14h], 0
		jnz	short loc_100151ED
		mov	eax, edx
		push	0
		push	0FFFFE890h
		mov	dword ptr [eax+18h], 0
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100151ED:				; CODE XREF: sub_10015080+FFj
					; sub_10015080+105j ...
		mov	ecx, [esp+10h+arg_10]
		push	ecx		; int
		push	ebx		; int
		push	edi		; nNumberOfBytesToRead
		push	ebp		; lpBuffer
		push	esi		; int
		call	sub_1001F6C0
		mov	edx, dword_10032A98
		add	esp, 14h
		cmp	dword ptr [edx+4], 4
		mov	edi, eax
		jl	short loc_10015226
		call	PR_GetOSError
		push	eax
		call	PR_GetError
		push	eax
		push	edi
		push	offset aRecvDErrorDOsE ; "recv -> %d, error = %d, os error = %d"
		call	PR_LogPrint
		add	esp, 10h

loc_10015226:				; CODE XREF: sub_10015080+18Aj
		cmp	ebx, 2
		jnz	short loc_10015252
		mov	eax, [esi+4]
		cmp	dword ptr [eax+4], 0
		jnz	short loc_10015252
		cmp	dword ptr [eax+8], 1
		jz	short loc_10015252
		test	edi, edi
		jle	short loc_10015252
		mov	eax, [eax+14h]
		push	edi		; Size
		push	ebp		; Src
		push	eax		; Dst
		call	memcpy
		mov	ecx, [esi+4]
		mov	[ecx+1Ch], edi
		add	esp, 0Ch

loc_10015252:				; CODE XREF: sub_10015080+C6j
					; sub_10015080+D8j ...
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10015080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10015260(int,	void *Dst, size_t Size)
sub_10015260	proc near		; DATA XREF: .data:100304A8o
					; .data:10030538o

arg_0		= dword	ptr  4
Dst		= dword	ptr  8
Size		= dword	ptr  0Ch

		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_10015294
		test	cl, 2
		jz	short loc_10015294
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10015294:				; CODE XREF: sub_10015260+11j
					; sub_10015260+16j
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_100152B0
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100152B0:				; CODE XREF: sub_10015260+3Bj
		mov	eax, dword_10032A98
		cmp	dword ptr [eax+4], 4
		push	ebx
		mov	ebx, [esp+4+Dst]
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	edi, [esp+0Ch+Size]
		jl	short loc_100152E3
		mov	ecx, [esi+4]
		mov	edx, [ecx+28h]
		push	0
		push	edi
		push	ebx
		push	edx
		push	esi
		push	offset aRecvFdPOsfdLdB ; "recv:	fd=%p osfd=%ld buf=%p amount=%d	f"...
		call	PR_LogPrint
		add	esp, 18h

loc_100152E3:				; CODE XREF: sub_10015260+68j
		mov	ecx, [esi+4]
		mov	eax, [ecx+1Ch]
		test	eax, eax
		jz	short loc_1001532D
		cmp	edi, eax
		jl	short loc_100152F3
		mov	edi, eax

loc_100152F3:				; CODE XREF: sub_10015260+8Fj
		mov	eax, [ecx+14h]
		push	edi		; Size
		push	eax		; Src
		push	ebx		; Dst
		call	memcpy
		mov	eax, [esi+4]
		sub	[eax+1Ch], edi
		mov	ecx, [esi+4]
		add	esp, 0Ch
		cmp	dword ptr [ecx+1Ch], 0
		jz	short loc_10015327
		mov	esi, ecx
		mov	eax, [esi+14h]
		mov	edx, [esi+1Ch]
		push	edx		; Size
		lea	ecx, [eax+edi]
		push	ecx		; Src
		push	eax		; Dst
		call	ds:memmove
		add	esp, 0Ch

loc_10015327:				; CODE XREF: sub_10015260+AEj
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001532D:				; CODE XREF: sub_10015260+8Bj
		push	0FFFFFFFFh	; int
		push	0		; int
		push	edi		; nNumberOfBytesToRead
		push	ebx		; lpBuffer
		push	esi		; int
		call	sub_1001F6C0
		mov	edx, dword_10032A98
		add	esp, 14h
		cmp	dword ptr [edx+4], 4
		mov	esi, eax
		jl	short loc_10015364
		call	PR_GetOSError
		push	eax
		call	PR_GetError
		push	eax
		push	esi
		push	offset aRecvDErrorDOsE ; "recv -> %d, error = %d, os error = %d"
		call	PR_LogPrint
		add	esp, 10h

loc_10015364:				; CODE XREF: sub_10015260+E8j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_10015260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015370	proc near		; CODE XREF: sub_10015460+13p
					; DATA XREF: .data:100304E8o ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
lpBuffer	= dword	ptr  8
nNumberOfBytesToWrite= dword ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_100153A6
		test	cl, 2
		jz	short loc_100153A6
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100153A6:				; CODE XREF: sub_10015370+12j
					; sub_10015370+17j
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_100153C3
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100153C3:				; CODE XREF: sub_10015370+3Dj
		push	esi
		mov	esi, [esp+8+nNumberOfBytesToWrite]
		mov	[esp+8+var_4], 0
		test	esi, esi
		jle	short loc_1001543C
		push	ebx
		mov	ebx, [esp+0Ch+lpBuffer]
		push	ebp
		mov	ebp, [esp+10h+arg_10]
		push	edi
		mov	edi, [esp+14h+arg_0]

loc_100153E3:				; CODE XREF: sub_10015370+BDj
		mov	eax, dword_10032A98
		cmp	dword ptr [eax+4], 4
		jl	short loc_10015405
		mov	ecx, [edi+4]
		mov	edx, [ecx+28h]
		push	esi
		push	ebx
		push	edx
		push	edi
		push	offset aSendFdPOsfdLdB ; "send:	fd=%p osfd=%ld buf=%p amount=%d"
		call	PR_LogPrint
		add	esp, 14h

loc_10015405:				; CODE XREF: sub_10015370+7Cj
		mov	eax, [esp+14h+arg_C]
		push	ebp		; int
		push	eax		; int
		push	esi		; nNumberOfBytesToWrite
		push	ebx		; lpBuffer
		push	edi		; int
		call	sub_1001FA30
		add	esp, 14h
		test	eax, eax
		js	short loc_10015431
		mov	ecx, [edi+4]
		add	[esp+14h+var_4], eax
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_10015439
		sub	esi, eax
		add	ebx, eax
		test	esi, esi
		jg	short loc_100153E3
		jmp	short loc_10015439
; ---------------------------------------------------------------------------

loc_10015431:				; CODE XREF: sub_10015370+A8j
		mov	[esp+14h+var_4], 0FFFFFFFFh

loc_10015439:				; CODE XREF: sub_10015370+B5j
					; sub_10015370+BFj
		pop	edi
		pop	ebp
		pop	ebx

loc_1001543C:				; CODE XREF: sub_10015370+62j
		mov	edx, dword_10032A98
		cmp	dword ptr [edx+4], 4
		pop	esi
		jl	short loc_1001545A
		mov	eax, [esp+4+var_4]
		push	eax
		push	offset aSendD	; "send	-> %d"
		call	PR_LogPrint
		add	esp, 8

loc_1001545A:				; CODE XREF: sub_10015370+D7j
		mov	eax, [esp+4+var_4]
		pop	ecx
		retn
sub_10015370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015460	proc near		; DATA XREF: .data:100304ACo
					; .data:1003053Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_0]
		push	0FFFFFFFFh
		push	0
		push	eax
		push	ecx
		push	edx
		call	sub_10015370
		add	esp, 14h
		retn
sub_10015460	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10015480(void	*Memory)
sub_10015480	proc near		; DATA XREF: .data:100304A4o
					; .data:10030534o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		test	esi, esi
		jz	short loc_10015500
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10015500
		mov	eax, [ecx]
		cmp	eax, 0AAAAAAAAh
		jz	short loc_100154A7
		cmp	eax, 55555555h
		jnz	short loc_10015500
		cmp	eax, 0AAAAAAAAh
		jnz	short loc_100154C2

loc_100154A7:				; CODE XREF: sub_10015480+17j
		mov	eax, [ecx+28h]
		push	1		; int
		push	eax		; s
		call	sub_10020FF0
		add	esp, 8
		test	eax, eax
		js	short loc_1001550F
		mov	ecx, [esi+4]
		mov	dword ptr [ecx], 55555555h

loc_100154C2:				; CODE XREF: sub_10015480+25j
		mov	edx, [esi+4]
		mov	eax, [edx+14h]
		test	eax, eax
		jz	short loc_100154F3
		push	eax		; Memory
		call	PR_Free
		mov	eax, [esi+4]
		mov	dword ptr [eax+14h], 0
		mov	ecx, [esi+4]
		mov	dword ptr [ecx+18h], 0
		mov	edx, [esi+4]
		add	esp, 4
		mov	dword ptr [edx+1Ch], 0

loc_100154F3:				; CODE XREF: sub_10015480+4Aj
		push	esi		; Memory
		call	PR_FreeFileDesc
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015500:				; CODE XREF: sub_10015480+7j
					; sub_10015480+Ej ...
		push	0
		push	0FFFFE891h
		call	PR_SetError
		add	esp, 8

loc_1001550F:				; CODE XREF: sub_10015480+37j
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10015480	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015520	proc near		; DATA XREF: .data:100304B0o
					; .data:10030540o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+4]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short locret_10015537
		mov	[esp+arg_0], ecx
		jmp	sub_10020DE0
; ---------------------------------------------------------------------------

locret_10015537:			; CODE XREF: sub_10015520+Cj
		retn
sub_10015520	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015540	proc near		; DATA XREF: .data:100304B4o
					; .data:10030544o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+4]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_10015557
		push	ecx
		call	sub_10020DE0
		add	esp, 4

loc_10015557:				; CODE XREF: sub_10015540+Cj
		cdq
		retn
sub_10015540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015560	proc near		; DATA XREF: .data:10030580o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_10015596
		test	cl, 2
		jz	short loc_10015596
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10015596:				; CODE XREF: sub_10015560+12j
					; sub_10015560+17j
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_100155B3
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100155B3:				; CODE XREF: sub_10015560+3Dj
		push	edi
		mov	edi, [esp+8+arg_8]
		mov	[esp+8+var_4], 0
		test	edi, edi
		jle	short loc_10015628
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		push	ebp
		mov	ebp, [esp+10h+arg_0]
		push	esi
		mov	esi, [esp+14h+arg_10]

loc_100155D3:				; CODE XREF: sub_10015560+B1j
		mov	eax, [esp+14h+arg_14]
		mov	edx, [esp+14h+arg_C]
		xor	ecx, ecx
		cmp	word ptr [esi],	2
		push	eax
		setnz	cl
		dec	ecx
		and	ecx, 0FFFFFFF4h
		add	ecx, 1Ch
		push	ecx
		push	esi
		push	edx
		push	edi
		push	ebx
		push	ebp
		call	sub_1001FD70
		add	esp, 1Ch
		test	eax, eax
		js	short loc_1001561D
		mov	ecx, [ebp+4]
		add	[esp+14h+var_4], eax
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_10015625
		sub	edi, eax
		add	ebx, eax
		test	edi, edi
		jg	short loc_100155D3
		mov	eax, [esp+14h+var_4]
		pop	esi
		pop	ebp
		pop	ebx
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001561D:				; CODE XREF: sub_10015560+9Cj
		mov	[esp+14h+var_4], 0FFFFFFFFh

loc_10015625:				; CODE XREF: sub_10015560+A9j
		pop	esi
		pop	ebp
		pop	ebx

loc_10015628:				; CODE XREF: sub_10015560+62j
		mov	eax, [esp+8+var_4]
		pop	edi
		pop	ecx
		retn
sub_10015560	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10015630	proc near		; DATA XREF: .data:1003057Co

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_10015666
		test	cl, 2
		jz	short loc_10015666
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10015666:				; CODE XREF: sub_10015630+12j
					; sub_10015630+17j
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_10015683
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10015683:				; CODE XREF: sub_10015630+3Dj
		mov	eax, [esp+4+arg_14]
		mov	edx, [esp+4+arg_10]
		push	eax
		mov	eax, [esp+8+arg_C]
		lea	ecx, [esp+8+var_4]
		push	ecx
		mov	ecx, [esp+0Ch+arg_8]
		push	edx
		mov	edx, [esp+10h+arg_4]
		push	eax
		mov	eax, [esp+14h+arg_0]
		push	ecx
		push	edx
		push	eax
		mov	[esp+20h+var_4], 20h
		call	sub_1001FE10
		add	esp, 1Ch
		pop	ecx
		retn
sub_10015630	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 248. PR_NTFast_UpdateAcceptContext

; =============== S U B	R O U T	I N E =======================================


		public PR_NTFast_UpdateAcceptContext
PR_NTFast_UpdateAcceptContext proc near	; DATA XREF: .rdata:off_1002C7C8o

s		= dword	ptr  4
optval		= byte ptr  8

		mov	eax, dword ptr [esp+optval]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	eax, [esp+s]
		mov	ecx, [eax+4]
		mov	dword ptr [esp+optval],	edx ; optval
		mov	edx, [ecx+28h]
		mov	[esp+s], edx	; s
		jmp	sub_1001E2E0
PR_NTFast_UpdateAcceptContext endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100156F0(void	*Memory, int, int, int)
sub_100156F0	proc near		; CODE XREF: sub_100157A0+40p
					; DATA XREF: .data:10030518o

Memory		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_10015724
		test	cl, 2
		jz	short loc_10015724
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10015724:				; CODE XREF: sub_100156F0+11j
					; sub_100156F0+16j
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_10015740
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10015740:				; CODE XREF: sub_100156F0+3Bj
		push	edi
		mov	edi, [esp+4+Memory]
		mov	eax, [edi+4]
		cmp	dword ptr [eax+4], 0
		jz	short loc_10015762
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_10015762:				; CODE XREF: sub_100156F0+5Cj
		mov	ecx, [esp+4+arg_C]
		mov	edx, [esp+4+arg_4]
		push	ebx
		mov	ebx, [esp+8+arg_8]
		push	esi
		push	ecx
		push	ebx
		push	edx
		push	edi
		call	sub_1001F270
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		js	short loc_10015790
		cmp	ebx, 1
		jnz	short loc_10015790
		push	edi		; Memory
		call	PR_FreeFileDesc
		add	esp, 4

loc_10015790:				; CODE XREF: sub_100156F0+90j
					; sub_100156F0+95j
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	edi
		retn
sub_100156F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100157A0(void	*Memory, int, int, int,	int, int)
sub_100157A0	proc near		; DATA XREF: .data:100304FCo

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Memory		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+arg_8]
		mov	edx, [esp+1Ch+arg_C]
		mov	[esp+1Ch+var_1C], eax
		xor	eax, eax
		mov	[esp+1Ch+var_18], eax
		mov	[esp+1Ch+var_14], eax
		mov	[esp+1Ch+var_8], eax
		mov	[esp+1Ch+var_4], eax
		mov	eax, [esp+1Ch+arg_14]
		push	eax		; int
		mov	eax, [esp+20h+Memory]
		mov	[esp+20h+var_10], ecx
		mov	ecx, [esp+20h+arg_10]
		mov	[esp+20h+var_C], edx
		push	ecx		; int
		lea	edx, [esp+24h+var_1C]
		push	edx		; int
		push	eax		; Memory
		call	sub_100156F0
		add	esp, 2Ch
		retn
sub_100157A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100157F0(int,	struct sockaddr	*name)
sub_100157F0	proc near		; DATA XREF: .data:10030500o
					; .data:10030590o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
name		= dword	ptr  8

		push	ecx
		mov	ecx, [esp+4+name]
		mov	edx, [esp+4+arg_0]
		lea	eax, [esp+4+var_4]
		push	eax		; namelen
		push	ecx		; name
		push	edx		; int
		mov	[esp+10h+var_4], 20h
		call	sub_10020020
		xor	ecx, ecx
		test	eax, eax
		setns	cl
		lea	eax, [ecx-1]
		add	esp, 10h
		retn
sub_100157F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10015820(int,	void *Dst)
sub_10015820	proc near		; DATA XREF: .data:10030504o
					; .data:10030594o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Dst		= dword	ptr  8

		push	ecx
		mov	ecx, [esp+4+Dst]
		mov	edx, [esp+4+arg_0]
		lea	eax, [esp+4+var_4]
		push	eax		; namelen
		push	ecx		; Dst
		push	edx		; int
		mov	[esp+10h+var_4], 20h
		call	sub_10020060
		xor	ecx, ecx
		test	eax, eax
		setns	cl
		lea	eax, [ecx-1]
		add	esp, 10h
		retn
sub_10015820	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 191. PR_GetTCPMethods

; =============== S U B	R O U T	I N E =======================================


		public PR_GetTCPMethods
PR_GetTCPMethods proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, offset dword_100304A0
		retn
PR_GetTCPMethods endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 204. PR_GetUDPMethods

; =============== S U B	R O U T	I N E =======================================


		public PR_GetUDPMethods
PR_GetUDPMethods proc near		; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, offset dword_10030530
		retn
PR_GetUDPMethods endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 410. _pr_test_ipv6_socket

; =============== S U B	R O U T	I N E =======================================


		public _pr_test_ipv6_socket
_pr_test_ipv6_socket proc near		; CODE XREF: .text:loc_100036FDp
					; DATA XREF: .rdata:off_1002C7C8o
		push	0		; protocol
		push	1		; type
		push	17h		; int
		call	sub_1001E150
		add	esp, 0Ch
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10015894
		push	1		; int
		push	eax		; s
		call	sub_10020FF0
		add	esp, 8
		mov	eax, 1
		retn
; ---------------------------------------------------------------------------

loc_10015894:				; CODE XREF: _pr_test_ipv6_socket+11j
		xor	eax, eax
		retn
_pr_test_ipv6_socket endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 347. PR_Socket

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_Socket(int, int type, int protocol)
		public PR_Socket
PR_Socket	proc near		; CODE XREF: PR_NewTCPSocket+6p
					; PR_NewUDPSocket+6p ...

arg_0		= dword	ptr  4
type		= dword	ptr  8
protocol	= dword	ptr  0Ch

		cmp	dword_10031520,	0
		push	ebp
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebp, esi
		jnz	short loc_100158B6
		call	PR_Init

loc_100158B6:				; CODE XREF: PR_Socket+Fj
		cmp	esi, 2
		jz	short loc_100158E5
		cmp	esi, 17h
		jz	short loc_100158D4
		push	0
		push	0FFFFE89Fh
		call	PR_SetError
		add	esp, 8
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100158D4:				; CODE XREF: PR_Socket+1Ej
		call	sub_100037C0
		mov	esi, eax
		neg	esi
		sbb	esi, esi
		and	esi, 15h
		add	esi, 2

loc_100158E5:				; CODE XREF: PR_Socket+19j
		mov	eax, [esp+8+protocol]
		push	ebx
		push	edi
		mov	edi, [esp+10h+type]
		push	eax		; protocol
		push	edi		; type
		push	esi		; int
		call	sub_1001E150
		mov	ebx, eax
		add	esp, 0Ch
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_10015908
		pop	edi
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10015908:				; CODE XREF: PR_Socket+5Fj
		cmp	edi, 1
		jnz	short loc_10015914
		push	offset dword_100304A0
		jmp	short loc_10015919
; ---------------------------------------------------------------------------

loc_10015914:				; CODE XREF: PR_Socket+6Bj
		push	offset dword_10030530

loc_10015919:				; CODE XREF: PR_Socket+72j
		push	ebx
		call	PR_AllocFileDesc
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jz	short loc_1001596A
		push	edi
		call	sub_10022480
		push	0
		push	edi
		call	sub_100211B0
		mov	ecx, [edi+4]
		add	esp, 0Ch
		mov	[ecx+58h], si
		cmp	ebp, 17h
		jnz	short loc_10015975
		cmp	esi, 2
		jnz	short loc_10015975
		push	edi
		call	_pr_push_ipv6toipv4_layer
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10015975
		push	edi
		call	PR_Close
		add	esp, 4
		xor	edi, edi
		mov	eax, edi
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_1001596A:				; CODE XREF: PR_Socket+86j
		push	1		; int
		push	ebx		; s
		call	sub_10020FF0
		add	esp, 8

loc_10015975:				; CODE XREF: PR_Socket+A3j
					; PR_Socket+A8j ...
		mov	eax, edi
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		retn
PR_Socket	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 260. PR_NewTCPSocket

; =============== S U B	R O U T	I N E =======================================


		public PR_NewTCPSocket
PR_NewTCPSocket	proc near		; DATA XREF: .rdata:off_1002C7C8o
		push	0		; protocol
		push	1		; type
		push	2		; int
		call	PR_Socket
		add	esp, 0Ch
		retn
PR_NewTCPSocket	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 263. PR_NewUDPSocket

; =============== S U B	R O U T	I N E =======================================


		public PR_NewUDPSocket
PR_NewUDPSocket	proc near		; DATA XREF: .rdata:off_1002C7C8o
		push	0		; protocol
		push	2		; type
		push	2		; int
		call	PR_Socket
		add	esp, 0Ch
		retn
PR_NewUDPSocket	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 276. PR_OpenTCPSocket

; =============== S U B	R O U T	I N E =======================================


		public PR_OpenTCPSocket
PR_OpenTCPSocket proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	0		; protocol
		push	1		; type
		push	eax		; int
		call	PR_Socket
		add	esp, 0Ch
		retn
PR_OpenTCPSocket endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 277. PR_OpenUDPSocket

; =============== S U B	R O U T	I N E =======================================


		public PR_OpenUDPSocket
PR_OpenUDPSocket proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	0		; protocol
		push	2		; type
		push	eax		; int
		call	PR_Socket
		add	esp, 0Ch
		retn
PR_OpenUDPSocket endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 261. PR_NewTCPSocketPair

; =============== S U B	R O U T	I N E =======================================


		public PR_NewTCPSocketPair
PR_NewTCPSocketPair proc near		; CODE XREF: PR_NewPollableEvent+82p
					; DATA XREF: .rdata:off_1002C7C8o

namelen		= dword	ptr -28h
name		= sockaddr ptr -24h
addr		= sockaddr ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 28h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_4], eax
		cmp	dword_10031520,	0
		push	ebx
		push	ebp
		mov	ebp, [esp+30h+arg_0]
		push	esi
		push	edi
		jnz	short loc_10015A04
		call	PR_Init

loc_10015A04:				; CODE XREF: PR_NewTCPSocketPair+1Dj
		push	0		; protocol
		push	1		; type
		push	2		; af
		or	ebx, 0FFFFFFFFh
		or	edi, 0FFFFFFFFh
		call	socket
		mov	esi, eax
		cmp	esi, 0FFFFFFFFh
		jz	loc_10015B12
		push	7F000001h	; hostlong
		mov	dword ptr [esp+3Ch+name.sa_family], 2
		call	htonl
		push	10h		; namelen
		lea	edx, [esp+3Ch+name]
		push	edx		; name
		push	esi		; s
		mov	dword ptr [esp+44h+name.sa_data+2], eax
		mov	[esp+44h+namelen], 10h
		call	bind
		cmp	eax, 0FFFFFFFFh
		jz	loc_10015AF6
		lea	eax, [esp+38h+namelen]
		push	eax		; namelen
		lea	ecx, [esp+3Ch+name]
		push	ecx		; name
		push	esi		; s
		call	getsockname
		cmp	eax, 0FFFFFFFFh
		jz	loc_10015AF6
		push	5		; backlog
		push	esi		; s
		call	listen
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10015AF6
		push	0		; protocol
		push	1		; type
		push	2		; af
		call	socket
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jz	short loc_10015AF6
		push	7F000001h	; hostlong
		call	htonl
		mov	edx, [esp+38h+namelen]
		mov	dword ptr [esp+38h+name.sa_data+2], eax
		push	edx		; namelen
		lea	eax, [esp+3Ch+name]
		push	eax		; name
		push	edi		; s
		call	connect
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10015AF6
		lea	ecx, [esp+38h+namelen]
		push	ecx		; namelen
		lea	edx, [esp+3Ch+name]
		push	edx		; name
		push	edi		; s
		call	getsockname
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10015AF6
		lea	eax, [esp+38h+namelen]
		push	eax		; addrlen
		lea	ecx, [esp+3Ch+addr]
		push	ecx		; addr
		push	esi		; s
		call	accept
		mov	ebx, eax
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_10015AF6
		mov	dx, word ptr [esp+38h+addr.sa_data]
		cmp	dx, word ptr [esp+38h+name.sa_data]
		jz	short loc_10015B28
		push	0
		push	0FFFFE8AAh
		call	PR_SetError
		add	esp, 8

loc_10015AF6:				; CODE XREF: PR_NewTCPSocketPair+6Ej
					; PR_NewTCPSocketPair+87j ...
		push	esi		; s
		call	closesocket
		cmp	edi, 0FFFFFFFFh
		jz	short loc_10015B07
		push	edi		; s
		call	closesocket

loc_10015B07:				; CODE XREF: PR_NewTCPSocketPair+11Fj
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_10015B12
		push	ebx		; s
		call	closesocket

loc_10015B12:				; CODE XREF: PR_NewTCPSocketPair+3Aj
					; PR_NewTCPSocketPair+12Aj
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10015B28:				; CODE XREF: PR_NewTCPSocketPair+105j
		push	esi		; s
		call	closesocket
		push	offset dword_100304A0
		push	edi
		call	PR_AllocFileDesc
		add	esp, 8
		mov	[ebp+0], eax
		test	eax, eax
		jnz	short loc_10015B65
		push	edi		; s
		call	closesocket
		push	ebx		; s
		call	closesocket
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10015B65:				; CODE XREF: PR_NewTCPSocketPair+161j
		push	offset dword_100304A0
		push	ebx
		call	PR_AllocFileDesc
		add	esp, 8
		mov	[ebp+4], eax
		test	eax, eax
		jnz	short loc_10015BA2
		mov	eax, [ebp+0]
		push	eax
		call	PR_Close
		add	esp, 4
		push	ebx		; s
		call	closesocket
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10015BA2:				; CODE XREF: PR_NewTCPSocketPair+198j
		mov	ecx, [ebp+0]
		push	0
		push	ecx
		call	sub_100211B0
		mov	edx, [ebp+4]
		push	0
		push	edx
		call	sub_100211B0
		mov	ecx, [esp+48h+var_4]
		add	esp, 10h
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
PR_NewTCPSocketPair endp

; Exported entry 122. PR_FileDesc2NativeHandle

; =============== S U B	R O U T	I N E =======================================


		public PR_FileDesc2NativeHandle
PR_FileDesc2NativeHandle proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_10015BE7
		push	0
		push	eax
		call	PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jnz	short loc_10015BFA

loc_10015BE7:				; CODE XREF: PR_FileDesc2NativeHandle+6j
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10015BFA:				; CODE XREF: PR_FileDesc2NativeHandle+15j
		mov	eax, [eax+4]
		mov	eax, [eax+28h]
		retn
PR_FileDesc2NativeHandle endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  47. PR_ChangeFileDescNativeHandle

; =============== S U B	R O U T	I N E =======================================


		public PR_ChangeFileDescNativeHandle
PR_ChangeFileDescNativeHandle proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short locret_10015C22
		mov	eax, [eax+4]
		mov	ecx, [esp+arg_4]
		mov	[eax+28h], ecx

locret_10015C22:			; CODE XREF: PR_ChangeFileDescNativeHandle+6j
		retn
PR_ChangeFileDescNativeHandle endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 121. PR_FD_ZERO

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_FD_ZERO(void *Dst)
		public PR_FD_ZERO
PR_FD_ZERO	proc near		; DATA XREF: .rdata:off_1002C7C8o

Dst		= dword	ptr  4

		mov	eax, [esp+Dst]
		push	2008h		; Size
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch
		retn
PR_FD_ZERO	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 120. PR_FD_SET

; =============== S U B	R O U T	I N E =======================================


		public PR_FD_SET
PR_FD_SET	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [eax]
		mov	edx, [esp+arg_0]
		mov	[eax+ecx*4+4], edx
		inc	dword ptr [eax]
		retn
PR_FD_SET	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 115. PR_FD_CLR

; =============== S U B	R O U T	I N E =======================================


		public PR_FD_CLR
PR_FD_CLR	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		push	esi
		mov	esi, [ecx]
		xor	eax, eax
		test	esi, esi
		jz	short loc_10015CB3
		push	edi
		mov	edi, [esp+8+arg_0]
		lea	edx, [ecx+4]

loc_10015C85:				; CODE XREF: PR_FD_CLR+1Fj
		cmp	[edx], edi
		jz	short loc_10015C94
		inc	eax
		add	edx, 4
		cmp	eax, esi
		jb	short loc_10015C85
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015C94:				; CODE XREF: PR_FD_CLR+17j
		dec	esi
		mov	edx, eax
		cmp	eax, esi
		jnb	short loc_10015CB0
		lea	eax, [ecx+eax*4+4]
		nop

loc_10015CA0:				; CODE XREF: PR_FD_CLR+3Ej
		mov	esi, [eax+4]
		mov	[eax], esi
		mov	esi, [ecx]
		inc	edx
		dec	esi
		add	eax, 4
		cmp	edx, esi
		jb	short loc_10015CA0

loc_10015CB0:				; CODE XREF: PR_FD_CLR+29j
		dec	dword ptr [ecx]
		pop	edi

loc_10015CB3:				; CODE XREF: PR_FD_CLR+Bj
		pop	esi
		retn
PR_FD_CLR	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 116. PR_FD_ISSET

; =============== S U B	R O U T	I N E =======================================


		public PR_FD_ISSET
PR_FD_ISSET	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		mov	edx, [ecx]
		xor	eax, eax
		push	esi
		test	edx, edx
		jz	short loc_10015CE0
		mov	esi, [esp+4+arg_0]
		add	ecx, 4

loc_10015CD4:				; CODE XREF: PR_FD_ISSET+1Ej
		cmp	[ecx], esi
		jz	short loc_10015CE4
		inc	eax
		add	ecx, 4
		cmp	eax, edx
		jb	short loc_10015CD4

loc_10015CE0:				; CODE XREF: PR_FD_ISSET+Bj
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015CE4:				; CODE XREF: PR_FD_ISSET+16j
		mov	eax, 1
		pop	esi
		retn
PR_FD_ISSET	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 119. PR_FD_NSET

; =============== S U B	R O U T	I N E =======================================


		public PR_FD_NSET
PR_FD_NSET	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [eax+1004h]
		mov	edx, [esp+arg_0]
		mov	[eax+ecx*4+1008h], edx
		inc	dword ptr [eax+1004h]
		retn
PR_FD_NSET	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 117. PR_FD_NCLR

; =============== S U B	R O U T	I N E =======================================


		public PR_FD_NCLR
PR_FD_NCLR	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		push	esi
		mov	esi, [ecx+1004h]
		xor	eax, eax
		test	esi, esi
		jz	short loc_10015D6B
		push	edi
		mov	edi, [esp+8+arg_0]
		lea	edx, [ecx+1008h]
		lea	esp, [esp+0]

loc_10015D30:				; CODE XREF: PR_FD_NCLR+2Aj
		cmp	[edx], edi
		jz	short loc_10015D3F
		inc	eax
		add	edx, 4
		cmp	eax, esi
		jb	short loc_10015D30
		pop	edi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015D3F:				; CODE XREF: PR_FD_NCLR+22j
		dec	esi
		mov	edx, eax
		cmp	eax, esi
		jnb	short loc_10015D64
		lea	eax, [ecx+eax*4+1008h]
		lea	ecx, [ecx+0]

loc_10015D50:				; CODE XREF: PR_FD_NCLR+52j
		mov	esi, [eax+4]
		mov	[eax], esi
		mov	esi, [ecx+1004h]
		inc	edx
		dec	esi
		add	eax, 4
		cmp	edx, esi
		jb	short loc_10015D50

loc_10015D64:				; CODE XREF: PR_FD_NCLR+34j
		dec	dword ptr [ecx+1004h]
		pop	edi

loc_10015D6B:				; CODE XREF: PR_FD_NCLR+Fj
		pop	esi
		retn
PR_FD_NCLR	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 118. PR_FD_NISSET

; =============== S U B	R O U T	I N E =======================================


		public PR_FD_NISSET
PR_FD_NISSET	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_4]
		mov	edx, [ecx+1004h]
		xor	eax, eax
		push	esi
		test	edx, edx
		jz	short loc_10015D9C
		mov	esi, [esp+4+arg_0]
		add	ecx, 1008h
		jmp	short loc_10015D90
; ---------------------------------------------------------------------------
		align 10h

loc_10015D90:				; CODE XREF: PR_FD_NISSET+1Bj
					; PR_FD_NISSET+2Aj
		cmp	[ecx], esi
		jz	short loc_10015DA0
		inc	eax
		add	ecx, 4
		cmp	eax, edx
		jb	short loc_10015D90

loc_10015D9C:				; CODE XREF: PR_FD_NISSET+Fj
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10015DA0:				; CODE XREF: PR_FD_NISSET+22j
		mov	eax, 1
		pop	esi
		retn
PR_FD_NISSET	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10015DB0(int,	__int16, void *Memory)
sub_10015DB0	proc near		; CODE XREF: PR_Select+B0p
					; PR_Select+C0p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= word ptr  8
Memory		= dword	ptr  0Ch

		push	ecx
		mov	eax, [esp+4+Memory]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		mov	esi, eax
		test	ebp, ebp
		jz	loc_10015E5D
		cmp	dword ptr [ebp+0], 0
		push	ebx
		push	edi
		mov	[esp+14h+var_4], 0
		jbe	loc_10015E59
		add	ebp, 4
		lea	esp, [esp+0]

loc_10015DE0:				; CODE XREF: sub_10015DB0+A7j
		xor	edi, edi
		xor	ebx, ebx

loc_10015DE4:				; CODE XREF: sub_10015DB0+7Fj
		cmp	dword ptr [esi+edi*8], 0FFFFFFFFh
		jnz	short loc_10015E1F
		lea	eax, ds:0A8h[edi*8]
		push	eax		; NewSize
		push	esi		; Memory
		call	PR_Realloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10015E61
		push	0A0h		; Size
		lea	ecx, [ebx+esi]
		push	0		; Val
		push	ecx		; Dst
		call	memset
		add	esp, 0Ch
		mov	dword ptr [esi+edi*8+0A0h], 0FFFFFFFFh

loc_10015E1F:				; CODE XREF: sub_10015DB0+38j
		mov	eax, [esi+edi*8]
		test	eax, eax
		jz	short loc_10015E31
		cmp	eax, [ebp+0]
		jz	short loc_10015E31
		inc	edi
		add	ebx, 40h
		jmp	short loc_10015DE4
; ---------------------------------------------------------------------------

loc_10015E31:				; CODE XREF: sub_10015DB0+74j
					; sub_10015DB0+79j
		mov	edx, [ebp+0]
		mov	cx, [esp+14h+arg_4]
		or	[esi+edi*8+4], cx
		lea	eax, [esi+edi*8+4]
		mov	eax, [esp+14h+var_4]
		mov	[esi+edi*8], edx
		mov	edx, [esp+14h+arg_0]
		inc	eax
		add	ebp, 4
		mov	[esp+14h+var_4], eax
		cmp	eax, [edx]
		jb	short loc_10015DE0

loc_10015E59:				; CODE XREF: sub_10015DB0+23j
		pop	edi
		mov	eax, esi
		pop	ebx

loc_10015E5D:				; CODE XREF: sub_10015DB0+Fj
		pop	esi
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10015E61:				; CODE XREF: sub_10015DB0+4Fj
		mov	eax, [esp+14h+Memory]
		test	eax, eax
		jz	short loc_10015E72
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_10015E72:				; CODE XREF: sub_10015DB0+B7j
		pop	edi
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
sub_10015DB0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 314. PR_Select

; =============== S U B	R O U T	I N E =======================================


		public PR_Select
PR_Select	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		cmp	dword_10030650,	0
		jz	short loc_10015EA0
		push	offset aPr_poll_0 ; "PR_Poll()"
		push	offset aPr_select_0 ; "PR_Select()"
		call	sub_10014330
		add	esp, 8
		mov	dword_10030650,	eax

loc_10015EA0:				; CODE XREF: PR_Select+7j
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_4]
		xor	esi, esi
		test	edi, edi
		jz	short loc_10015EC0
		mov	eax, [edi+1004h]
		mov	ecx, [edi]
		lea	edx, [ecx+eax]
		test	edx, edx
		jz	short loc_10015EC0
		lea	esi, [ecx+eax]

loc_10015EC0:				; CODE XREF: PR_Select+2Cj
					; PR_Select+3Bj
		mov	ebx, [esp+10h+arg_8]
		test	ebx, ebx
		jz	short loc_10015EDB
		mov	ecx, [ebx]
		mov	eax, [ebx+1004h]
		mov	edx, ecx
		sub	edx, esi
		add	edx, eax
		jz	short loc_10015EDB
		lea	esi, [ecx+eax]

loc_10015EDB:				; CODE XREF: PR_Select+46j
					; PR_Select+56j
		mov	ebp, [esp+10h+arg_C]
		test	ebp, ebp
		jz	short loc_10015EF7
		mov	ecx, [ebp+0]
		mov	eax, [ebp+1004h]
		mov	edx, ecx
		sub	edx, esi
		add	edx, eax
		jz	short loc_10015EF7
		lea	esi, [ecx+eax]

loc_10015EF7:				; CODE XREF: PR_Select+61j
					; PR_Select+72j
		test	esi, esi
		jnz	short loc_10015F0F
		mov	eax, [esp+10h+arg_10]
		push	eax
		call	PR_Sleep
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10015F0F:				; CODE XREF: PR_Select+79j
		lea	ecx, [esi+14h]
		push	8		; SizeOfElements
		push	ecx		; NumOfElements
		call	PR_Calloc
		add	esp, 8
		test	eax, eax
		jz	short loc_10015F5E
		push	eax		; Memory
		push	1		; __int16
		push	edi		; int
		mov	dword ptr [eax+esi*8+98h], 0FFFFFFFFh
		call	sub_10015DB0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10015F5E
		push	eax		; Memory
		push	2		; __int16
		push	ebx		; int
		call	sub_10015DB0
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10015F5E
		push	eax		; Memory
		push	4		; __int16
		push	ebp		; int
		call	sub_10015DB0
		mov	edi, eax
		add	esp, 0Ch
		test	edi, edi
		jnz	short loc_10015F75

loc_10015F5E:				; CODE XREF: PR_Select+9Fj
					; PR_Select+BAj ...
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10015F75:				; CODE XREF: PR_Select+DCj
		mov	eax, [edi]
		xor	esi, esi
		test	eax, eax
		jz	short loc_10015F8E
		lea	ecx, [ecx+0]

loc_10015F80:				; CODE XREF: PR_Select+10Cj
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10015F8E
		mov	eax, [edi+esi*8+8]
		inc	esi
		test	eax, eax
		jnz	short loc_10015F80

loc_10015F8E:				; CODE XREF: PR_Select+FBj
					; PR_Select+103j
		mov	edx, [esp+10h+arg_10]
		push	edx
		push	esi
		push	edi
		call	PR_Poll
		xor	ecx, ecx
		add	esp, 0Ch
		mov	[esp+10h+arg_8], eax
		cmp	eax, ecx
		jle	loc_10016056
		mov	edx, [esp+10h+arg_4]
		cmp	edx, ecx
		jz	short loc_10015FBB
		mov	[edx], ecx
		mov	[edx+1004h], ecx

loc_10015FBB:				; CODE XREF: PR_Select+131j
		cmp	ebx, ecx
		jz	short loc_10015FC7
		mov	[ebx], ecx
		mov	[ebx+1004h], ecx

loc_10015FC7:				; CODE XREF: PR_Select+13Dj
		cmp	ebp, ecx
		jz	short loc_10015FD4
		mov	[ebp+0], ecx
		mov	[ebp+1004h], ecx

loc_10015FD4:				; CODE XREF: PR_Select+149j
		lea	eax, [edi+esi*8-8]
		cmp	eax, edi
		jb	short loc_10016056
		lea	esp, [esp+0]

loc_10015FE0:				; CODE XREF: PR_Select+1ABj
		movzx	ecx, word ptr [eax+6]
		test	cl, 10h
		jnz	short loc_1001603F
		test	cl, 1
		jz	short loc_10015FFC
		test	edx, edx
		jz	short loc_10015FFC
		mov	ecx, [edx]
		mov	esi, [eax]
		mov	[edx+ecx*4+4], esi
		inc	dword ptr [edx]

loc_10015FFC:				; CODE XREF: PR_Select+16Cj
					; PR_Select+170j
		test	byte ptr [eax+6], 2
		jz	short loc_10016010
		test	ebx, ebx
		jz	short loc_10016010
		mov	ecx, [ebx]
		mov	esi, [eax]
		mov	[ebx+ecx*4+4], esi
		inc	dword ptr [ebx]

loc_10016010:				; CODE XREF: PR_Select+180j
					; PR_Select+184j
		test	byte ptr [eax+6], 4
		jz	short loc_10016026
		test	ebp, ebp
		jz	short loc_10016026
		mov	ecx, [ebp+0]
		mov	esi, [eax]
		mov	[ebp+ecx*4+4], esi
		inc	dword ptr [ebp+0]

loc_10016026:				; CODE XREF: PR_Select+194j
					; PR_Select+198j
		sub	eax, 8
		cmp	eax, edi
		jnb	short loc_10015FE0
		push	edi		; Memory
		call	PR_Free
		mov	eax, [esp+14h+arg_8]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001603F:				; CODE XREF: PR_Select+167j
		push	0
		push	0FFFFE891h
		call	PR_SetError
		add	esp, 8
		mov	[esp+10h+arg_8], 0FFFFFFFFh

loc_10016056:				; CODE XREF: PR_Select+125j
					; PR_Select+15Aj
		push	edi		; Memory
		call	PR_Free
		mov	eax, [esp+14h+arg_8]
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
PR_Select	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 211. PR_ImportTCPSocket

; =============== S U B	R O U T	I N E =======================================


		public PR_ImportTCPSocket
PR_ImportTCPSocket proc	near		; CODE XREF: PR_GetInheritedFD+DDp
					; DATA XREF: .rdata:off_1002C7C8o

s		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1001607E
		call	PR_Init

loc_1001607E:				; CODE XREF: PR_ImportTCPSocket+7j
		push	esi
		push	edi
		mov	edi, [esp+8+s]
		push	offset dword_100304A0
		push	edi
		call	PR_AllocFileDesc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_100160BA
		push	esi
		call	sub_10022480
		push	1
		push	esi
		call	sub_100211B0
		mov	eax, [esi+4]
		add	esp, 0Ch
		mov	ecx, 2
		mov	[eax+58h], cx
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100160BA:				; CODE XREF: PR_ImportTCPSocket+26j
		push	1		; int
		push	edi		; s
		call	sub_10020FF0
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_ImportTCPSocket endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 212. PR_ImportUDPSocket

; =============== S U B	R O U T	I N E =======================================


		public PR_ImportUDPSocket
PR_ImportUDPSocket proc	near		; CODE XREF: PR_GetInheritedFD+E9p
					; DATA XREF: .rdata:off_1002C7C8o

s		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_100160DE
		call	PR_Init

loc_100160DE:				; CODE XREF: PR_ImportUDPSocket+7j
		push	esi
		push	edi
		mov	edi, [esp+8+s]
		push	offset dword_10030530
		push	edi
		call	PR_AllocFileDesc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1001610E
		push	esi
		call	sub_10022480
		push	1
		push	esi
		call	sub_100211B0
		add	esp, 0Ch
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001610E:				; CODE XREF: PR_ImportUDPSocket+26j
		push	1		; int
		push	edi		; s
		call	sub_10020FF0
		add	esp, 8
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_ImportUDPSocket endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  69. PR_CreateSocketPollFd

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateSocketPollFd
PR_CreateSocketPollFd proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1001612E
		call	PR_Init

loc_1001612E:				; CODE XREF: PR_CreateSocketPollFd+7j
		push	esi
		call	sub_10001010
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1001614C
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001614C:				; CODE XREF: PR_CreateSocketPollFd+18j
		mov	eax, [esi+4]
		mov	ecx, [esp+4+arg_0]
		mov	[eax+28h], ecx
		mov	edx, [esi+4]
		mov	dword ptr [edx+8], 0
		mov	eax, [esi+4]
		mov	dword ptr [eax], 0AAAAAAAAh
		mov	dword ptr [esi], offset	dword_100305C0
		mov	eax, esi
		pop	esi
		retn
PR_CreateSocketPollFd endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10016180(int,	void *Src, int)
sub_10016180	proc near		; DATA XREF: .data:100304D4o

Size		= dword	ptr -28h
var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 28h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_4], eax
		push	ebx
		mov	ebx, [esp+2Ch+arg_0]
		push	ebp
		mov	ebp, [esp+30h+Src]
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_100161DB
		test	cl, 2
		jz	short loc_100161DB
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_100161DB:				; CODE XREF: sub_10016180+29j
					; sub_10016180+2Ej
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_10016206
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10016206:				; CODE XREF: sub_10016180+62j
		test	ebp, ebp
		jnz	short loc_1001620E
		lea	ebp, [esp+30h+var_24]

loc_1001620E:				; CODE XREF: sub_10016180+88j
		mov	eax, [esp+30h+arg_8]
		push	edi
		push	0
		push	0
		push	0		; int
		push	eax		; int
		lea	ecx, [esp+44h+Size]
		push	ecx		; RemoteSockaddrLength
		push	ebp		; Dst
		push	ebx		; int
		mov	[esp+50h+Size],	20h
		call	sub_1001E300
		mov	edi, eax
		add	esp, 1Ch
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_1001624C
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1001624C:				; CODE XREF: sub_10016180+B6j
		push	esi
		push	offset dword_100304A0
		push	edi
		call	PR_AllocFileDesc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10016281
		push	1		; int
		push	edi		; s
		call	sub_10020FF0
		add	esp, 8
		pop	esi
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10016281:				; CODE XREF: sub_10016180+DFj
		mov	edx, [ebx+4]
		mov	ecx, [edx+4]
		mov	eax, [esi+4]
		mov	[eax+4], ecx
		mov	edx, [ebx+4]
		mov	ecx, [edx+8]
		mov	eax, [esi+4]
		mov	[eax+8], ecx
		mov	edx, [esi+4]
		cmp	dword ptr [edx+4], 0
		mov	ecx, 1
		jnz	short loc_100162B1
		mov	eax, edx
		cmp	[eax+8], ecx
		jz	short loc_100162B1
		mov	[eax+2Ch], ecx

loc_100162B1:				; CODE XREF: sub_10016180+125j
					; sub_10016180+12Cj
		mov	eax, [esi+4]
		mov	[eax+34h], ecx
		mov	ecx, [esp+38h+Size]
		mov	edx, [esi+4]
		push	ecx		; Size
		add	edx, 38h
		push	ebp		; Src
		push	edx		; Dst
		call	memcpy
		mov	ecx, [esp+44h+var_4]
		add	esp, 0Ch
		mov	eax, esi
		pop	esi
		pop	edi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
sub_10016180	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 245. PR_NTFast_Accept

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_NTFast_Accept(int, void *Src, int)
		public PR_NTFast_Accept
PR_NTFast_Accept proc near		; DATA XREF: .rdata:off_1002C7C8o

Size		= dword	ptr -28h
var_24		= byte ptr -24h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 28h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_4], eax
		push	ebp
		mov	ebp, [esp+2Ch+arg_0]
		push	edi
		mov	edi, [esp+30h+Src]
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_1001634B
		test	cl, 2
		jz	short loc_1001634B
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_1001634B:				; CODE XREF: PR_NTFast_Accept+29j
					; PR_NTFast_Accept+2Ej
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_10016376
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_10016376:				; CODE XREF: PR_NTFast_Accept+62j
		test	edi, edi
		jnz	short loc_1001637E
		lea	edi, [esp+30h+var_24]

loc_1001637E:				; CODE XREF: PR_NTFast_Accept+88j
		mov	ecx, [esp+30h+arg_8]
		xor	eax, eax
		cmp	word ptr [edi],	2
		push	ebx
		push	0
		setnz	al
		push	0
		push	1		; int
		push	ecx		; int
		lea	edx, [esp+44h+Size]
		push	edx		; RemoteSockaddrLength
		push	edi		; Dst
		dec	eax
		and	eax, 0FFFFFFF4h
		add	eax, 1Ch
		push	ebp		; int
		mov	[esp+50h+Size],	eax
		call	sub_1001E300
		mov	ebx, eax
		add	esp, 1Ch
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_100163C8
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_100163C8:				; CODE XREF: PR_NTFast_Accept+C2j
		push	esi
		push	offset dword_100304A0
		push	ebx
		call	PR_AllocFileDesc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_100163FD
		push	1		; int
		push	ebx		; s
		call	sub_10020FF0
		add	esp, 8
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		mov	ecx, [esp+28h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
; ---------------------------------------------------------------------------

loc_100163FD:				; CODE XREF: PR_NTFast_Accept+EBj
		mov	eax, [ebp+4]
		mov	edx, [eax+4]
		mov	ecx, [esi+4]
		mov	[ecx+4], edx
		mov	ecx, [esi+4]
		mov	eax, 1
		mov	[ecx+2Ch], eax
		mov	edx, [esi+4]
		mov	[edx+34h], eax
		mov	eax, [esp+38h+Size]
		mov	ecx, [esi+4]
		push	eax		; Size
		add	ecx, 38h
		push	edi		; Src
		push	ecx		; Dst
		call	memcpy
		mov	edx, [ebp+4]
		mov	eax, [esi+4]
		mov	cx, [edx+58h]
		add	esp, 0Ch
		mov	[eax+58h], cx
		mov	ecx, [esp+38h+var_4]
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	edi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 28h
		retn
PR_NTFast_Accept endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016460	proc near		; DATA XREF: .data:100304F8o

s		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
RemoteSockaddr	= dword	ptr  0Ch
lpOutputBuffer	= dword	ptr  10h
dwReceiveDataLength= dword ptr	14h
arg_14		= dword	ptr  18h

		sub	esp, 8
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_1001649A
		test	cl, 2
		jz	short loc_1001649A
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001649A:				; CODE XREF: sub_10016460+14j
					; sub_10016460+19j
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_100164B9
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100164B9:				; CODE XREF: sub_10016460+41j
		mov	eax, [esp+8+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+4], 0
		jz	short loc_100164DC
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100164DC:				; CODE XREF: sub_10016460+64j
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_4]
		push	edi
		mov	edi, [esp+14h+RemoteSockaddr]
		mov	dword ptr [esi], 0
		test	edi, edi
		jnz	short loc_100164F5
		lea	edi, [esp+14h+var_4]

loc_100164F5:				; CODE XREF: sub_10016460+8Fj
		mov	edx, [esp+14h+arg_14]
		mov	ecx, [esp+14h+dwReceiveDataLength]
		push	0		; int
		push	0		; int
		push	0		; int
		push	edx		; int
		mov	edx, [esp+24h+lpOutputBuffer]
		push	ecx		; dwReceiveDataLength
		push	edx		; lpOutputBuffer
		push	edi		; RemoteSockaddr
		lea	ecx, [esp+30h+s]
		push	ecx		; int
		push	eax		; int
		call	sub_1001EB70
		mov	ebx, eax
		add	esp, 24h
		test	ebx, ebx
		js	short loc_10016546
		mov	edx, [esp+14h+s]
		push	offset dword_100304A0
		push	edx
		call	PR_AllocFileDesc
		add	esp, 8
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_10016552
		mov	eax, [esp+14h+s]
		push	1		; int
		push	eax		; s
		call	sub_10020FF0
		add	esp, 8

loc_10016546:				; CODE XREF: sub_10016460+BDj
		pop	edi
		or	ebx, 0FFFFFFFFh
		pop	esi
		mov	eax, ebx
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10016552:				; CODE XREF: sub_10016460+D5j
		mov	ecx, [eax+4]
		mov	eax, 1
		mov	[ecx+2Ch], eax
		mov	edx, [esi]
		mov	ecx, [edx+4]
		mov	[ecx+34h], eax
		mov	eax, [edi]
		xor	edx, edx
		cmp	word ptr [eax],	2
		setnz	dl
		dec	edx
		and	edx, 0FFFFFFF4h
		add	edx, 1Ch
		push	edx		; Size
		push	eax		; Src
		mov	eax, [esi]
		mov	ecx, [eax+4]
		add	ecx, 38h
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		add	esp, 8
		retn
sub_10016460	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 246. PR_NTFast_AcceptRead

; =============== S U B	R O U T	I N E =======================================


		public PR_NTFast_AcceptRead
PR_NTFast_AcceptRead proc near		; DATA XREF: .rdata:off_1002C7C8o

s		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
RemoteSockaddr	= dword	ptr  0Ch
lpOutputBuffer	= dword	ptr  10h
dwReceiveDataLength= dword ptr	14h
arg_14		= dword	ptr  18h

		sub	esp, 8
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_100165DA
		test	cl, 2
		jz	short loc_100165DA
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100165DA:				; CODE XREF: PR_NTFast_AcceptRead+14j
					; PR_NTFast_AcceptRead+19j
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_100165F9
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100165F9:				; CODE XREF: PR_NTFast_AcceptRead+41j
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_4]
		push	edi
		mov	edi, [esp+18h+RemoteSockaddr]
		mov	dword ptr [esi], 0
		test	edi, edi
		jnz	short loc_10016613
		lea	edi, [esp+18h+var_4]

loc_10016613:				; CODE XREF: PR_NTFast_AcceptRead+6Dj
		mov	eax, [esp+18h+arg_14]
		mov	ecx, [esp+18h+dwReceiveDataLength]
		mov	edx, [esp+18h+lpOutputBuffer]
		mov	ebx, [esp+18h+arg_0]
		push	0		; int
		push	0		; int
		push	1		; int
		push	eax		; int
		push	ecx		; dwReceiveDataLength
		push	edx		; lpOutputBuffer
		push	edi		; RemoteSockaddr
		lea	eax, [esp+34h+s]
		push	eax		; int
		push	ebx		; int
		call	sub_1001EB70
		mov	ebp, eax
		add	esp, 24h
		test	ebp, ebp
		js	short loc_10016668
		mov	ecx, [esp+18h+s]
		push	offset dword_100304A0
		push	ecx
		call	PR_AllocFileDesc
		add	esp, 8
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_10016675
		mov	edx, [esp+18h+s]
		push	1		; int
		push	edx		; s
		call	sub_10020FF0
		add	esp, 8

loc_10016668:				; CODE XREF: PR_NTFast_AcceptRead+9Fj
		pop	edi
		or	ebp, 0FFFFFFFFh
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10016675:				; CODE XREF: PR_NTFast_AcceptRead+B7j
		mov	ecx, [eax+4]
		mov	eax, 1
		mov	[ecx+2Ch], eax
		mov	edx, [esi]
		mov	ecx, [edx+4]
		mov	[ecx+34h], eax
		mov	eax, [edi]
		xor	edx, edx
		cmp	word ptr [eax],	2
		setnz	dl
		dec	edx
		and	edx, 0FFFFFFF4h
		add	edx, 1Ch
		push	edx		; Size
		push	eax		; Src
		mov	eax, [esi]
		mov	ecx, [eax+4]
		add	ecx, 38h
		push	ecx		; Dst
		call	memcpy
		mov	eax, [esi]
		mov	edx, [ebx+4]
		mov	ecx, [eax+4]
		mov	dx, [edx+58h]
		add	esp, 0Ch
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		mov	[ecx+58h], dx
		pop	ebx
		add	esp, 8
		retn
PR_NTFast_AcceptRead endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 247. PR_NTFast_AcceptRead_WithTimeoutCallback

; =============== S U B	R O U T	I N E =======================================


		public PR_NTFast_AcceptRead_WithTimeoutCallback
PR_NTFast_AcceptRead_WithTimeoutCallback proc near ; DATA XREF:	.rdata:off_1002C7C8o

s		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
RemoteSockaddr	= dword	ptr  0Ch
lpOutputBuffer	= dword	ptr  10h
dwReceiveDataLength= dword ptr	14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 8
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		test	ecx, 1000h
		jnz	short loc_1001670A
		test	cl, 2
		jz	short loc_1001670A
		and	ecx, 0FFFFFFFDh
		push	0
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001670A:				; CODE XREF: PR_NTFast_AcceptRead_WithTimeoutCallback+14j
					; PR_NTFast_AcceptRead_WithTimeoutCallback+19j
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_10016729
		push	0
		push	0FFFFE89Bh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10016729:				; CODE XREF: PR_NTFast_AcceptRead_WithTimeoutCallback+41j
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_4]
		push	edi
		mov	edi, [esp+18h+RemoteSockaddr]
		mov	dword ptr [esi], 0
		test	edi, edi
		jnz	short loc_10016743
		lea	edi, [esp+18h+var_4]

loc_10016743:				; CODE XREF: PR_NTFast_AcceptRead_WithTimeoutCallback+6Dj
		mov	eax, [esp+18h+arg_1C]
		mov	ecx, [esp+18h+arg_18]
		mov	edx, [esp+18h+arg_14]
		mov	ebx, [esp+18h+arg_0]
		push	eax		; int
		mov	eax, [esp+1Ch+dwReceiveDataLength]
		push	ecx		; int
		mov	ecx, [esp+20h+lpOutputBuffer]
		push	1		; int
		push	edx		; int
		push	eax		; dwReceiveDataLength
		push	ecx		; lpOutputBuffer
		push	edi		; RemoteSockaddr
		lea	edx, [esp+34h+s]
		push	edx		; int
		push	ebx		; int
		call	sub_1001EB70
		mov	ebp, eax
		add	esp, 24h
		test	ebp, ebp
		js	short loc_1001679E
		mov	eax, [esp+18h+s]
		push	offset dword_100304A0
		push	eax
		call	PR_AllocFileDesc
		add	esp, 8
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_100167AB
		mov	ecx, [esp+18h+s]
		push	1		; int
		push	ecx		; s
		call	sub_10020FF0
		add	esp, 8

loc_1001679E:				; CODE XREF: PR_NTFast_AcceptRead_WithTimeoutCallback+A5j
		pop	edi
		or	ebp, 0FFFFFFFFh
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100167AB:				; CODE XREF: PR_NTFast_AcceptRead_WithTimeoutCallback+BDj
		mov	edx, [eax+4]
		mov	eax, 1
		mov	[edx+2Ch], eax
		mov	ecx, [esi]
		mov	edx, [ecx+4]
		mov	[edx+34h], eax
		mov	eax, [edi]
		mov	edx, [esi]
		xor	ecx, ecx
		cmp	word ptr [eax],	2
		setnz	cl
		dec	ecx
		and	ecx, 0FFFFFFF4h
		add	ecx, 1Ch
		push	ecx		; Size
		push	eax		; Src
		mov	eax, [edx+4]
		add	eax, 38h
		push	eax		; Dst
		call	memcpy
		mov	ecx, [ebx+4]
		mov	edx, [esi]
		mov	eax, [edx+4]
		mov	cx, [ecx+58h]
		add	esp, 0Ch
		pop	edi
		pop	esi
		mov	[eax+58h], cx
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
PR_NTFast_AcceptRead_WithTimeoutCallback endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 274. PR_OpenSemaphore

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_OpenSemaphore(int, char, int, LONG lInitialCount)
		public PR_OpenSemaphore
PR_OpenSemaphore proc near		; DATA XREF: .rdata:off_1002C7C8o

Name		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch
lInitialCount	= dword	ptr  10h

		sub	esp, 404h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+404h+var_4], eax
		cmp	dword_10031520,	0
		push	ebx
		mov	ebx, [esp+408h+arg_8]
		push	ebp
		mov	ebp, [esp+40Ch+lInitialCount]
		push	esi
		mov	esi, [esp+410h+arg_0]
		push	edi
		mov	edi, dword ptr [esp+414h+arg_4]
		jnz	short loc_10016842
		call	PR_Init

loc_10016842:				; CODE XREF: PR_OpenSemaphore+3Bj
		push	0
		push	400h
		lea	eax, [esp+41Ch+Name]
		push	eax
		push	esi
		call	sub_1000D930
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10016860
		xor	eax, eax
		jmp	short loc_10016870
; ---------------------------------------------------------------------------

loc_10016860:				; CODE XREF: PR_OpenSemaphore+5Aj
		push	ebp		; lInitialCount
		push	ebx		; int
		lea	ecx, [esp+41Ch+Name]
		push	edi		; char
		push	ecx		; lpName
		call	sub_100255F0
		add	esp, 10h

loc_10016870:				; CODE XREF: PR_OpenSemaphore+5Ej
		mov	ecx, [esp+414h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 404h
		retn
PR_OpenSemaphore endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 377. PR_WaitSemaphore
; [00000005 BYTES: COLLAPSED FUNCTION PR_WaitSemaphore]
		align 10h
; Exported entry 283. PR_PostSemaphore
; [00000005 BYTES: COLLAPSED FUNCTION PR_PostSemaphore]
		align 10h
; Exported entry  54. PR_CloseSemaphore
; [00000005 BYTES: COLLAPSED FUNCTION PR_CloseSemaphore]
		align 10h
; Exported entry  78. PR_DeleteSemaphore

; =============== S U B	R O U T	I N E =======================================


		public PR_DeleteSemaphore
PR_DeleteSemaphore proc	near		; DATA XREF: .rdata:off_1002C7C8o

var_404		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 404h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+404h+var_4], eax
		cmp	dword_10031520,	0
		push	esi
		mov	esi, [esp+408h+arg_0]
		jnz	short loc_100168EA
		call	PR_Init

loc_100168EA:				; CODE XREF: PR_DeleteSemaphore+23j
		push	0
		push	400h
		lea	eax, [esp+410h+var_404]
		push	eax
		push	esi
		call	sub_1000D930
		mov	ecx, [esp+418h+var_4]
		inc	eax
		add	esp, 10h
		neg	eax
		sbb	eax, eax
		neg	eax
		pop	esi
		xor	ecx, esp
		dec	eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 404h
		retn
PR_DeleteSemaphore endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10016920	proc near		; CODE XREF: PR_Cleanup+E7p
					; .text:10019D86p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	esi
		call	sub_10007E30
		mov	eax, [esi+1Ch]
		xor	edi, edi
		add	esp, 4
		cmp	eax, edi
		jz	short loc_10016944
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esi+1Ch], edi

loc_10016944:				; CODE XREF: sub_10016920+16j
		mov	eax, [esi+3Ch]
		push	eax		; Memory
		mov	[esi+18h], edi
		call	PR_Free
		mov	ecx, [esi+38h]
		push	ecx		; Memory
		mov	[esi+3Ch], edi
		call	PR_Free
		add	esp, 8
		mov	[esi+38h], edi
		mov	[esi+34h], edi
		mov	[esi+30h], edi
		mov	[esi+14h], edi
		pop	edi
		pop	esi
		retn
sub_10016920	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 193. PR_GetThreadID

; =============== S U B	R O U T	I N E =======================================


		public PR_GetThreadID
PR_GetThreadID	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+8Ch]
		retn
PR_GetThreadID	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 195. PR_GetThreadPriority

; =============== S U B	R O U T	I N E =======================================


		public PR_GetThreadPriority
PR_GetThreadPriority proc near		; CODE XREF: PR_CreateAlarm+4Bp
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+4]
		retn
PR_GetThreadPriority endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 145. PR_GetCurrentThread

; =============== S U B	R O U T	I N E =======================================


		public PR_GetCurrentThread
PR_GetCurrentThread proc near		; CODE XREF: PR_EnumerateWaitGroup+31p
					; PR_EnumerateWaitGroup+87p ...
		cmp	dword_10031520,	0
		jnz	short loc_1001699E
		call	PR_Init

loc_1001699E:				; CODE XREF: PR_GetCurrentThread+7j
		jmp	PR_AssertCurrentThreadOwnsLock_0
PR_GetCurrentThread endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 218. PR_Interrupt

; =============== S U B	R O U T	I N E =======================================


		public PR_Interrupt
PR_Interrupt	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpCriticalSection= dword ptr  4

		push	ebx
		push	ebp
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebp, eax
		test	byte ptr [ebp+90h], 80h
		jnz	short loc_10016A26
		cmp	dword_1003067C,	0
		jz	short loc_100169E2
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	ebx, [edx+10h]
		jmp	short loc_100169F0
; ---------------------------------------------------------------------------

loc_100169E2:				; CODE XREF: PR_Interrupt+19j
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	ebx, eax

loc_100169F0:				; CODE XREF: PR_Interrupt+30j
		cmp	dword_1003067C,	0
		jz	short loc_10016A15
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	dword ptr [eax+10h], 1
		jmp	short loc_10016A2A
; ---------------------------------------------------------------------------

loc_10016A15:				; CODE XREF: PR_Interrupt+47j
		mov	ecx, dwTlsIndex
		push	1		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue
		jmp	short loc_10016A2A
; ---------------------------------------------------------------------------

loc_10016A26:				; CODE XREF: PR_Interrupt+10j
		mov	ebx, [esp+8+lpCriticalSection]

loc_10016A2A:				; CODE XREF: PR_Interrupt+63j
					; PR_Interrupt+74j
		push	esi
		mov	esi, [esp+0Ch+lpCriticalSection]
		push	edi
		lea	edi, [esi+40h]
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		or	dword ptr [esi+90h], 2
		mov	eax, [esi]
		sub	eax, 4
		mov	ecx, [esi+90h]
		jz	short loc_10016A6C
		sub	eax, 2
		jz	short loc_10016A5C
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_10016A7D
; ---------------------------------------------------------------------------

loc_10016A5C:				; CODE XREF: PR_Interrupt+A1j
		test	ecx, 1000h
		jnz	short loc_10016A7D
		push	esi
		call	sub_1001DE40
		jmp	short loc_10016A7A
; ---------------------------------------------------------------------------

loc_10016A6C:				; CODE XREF: PR_Interrupt+9Cj
		test	ecx, 1000h
		jnz	short loc_10016A7D
		push	esi		; lpCriticalSection
		call	sub_10018390

loc_10016A7A:				; CODE XREF: PR_Interrupt+BAj
		add	esp, 4

loc_10016A7D:				; CODE XREF: PR_Interrupt+AAj
					; PR_Interrupt+B2j ...
		test	byte ptr [ebp+90h], 80h
		pop	edi
		pop	esi
		jnz	loc_10016B29
		test	ebx, ebx
		jnz	short loc_10016AF7
		cmp	dword_1003067C,	ebx
		jz	short loc_10016AAF
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_10016ABC
; ---------------------------------------------------------------------------

loc_10016AAF:				; CODE XREF: PR_Interrupt+E6j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10016ABC:				; CODE XREF: PR_Interrupt+FDj
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10016AF7
		cmp	dword_1003067C,	0
		jz	short loc_10016AE2
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_10016AEE
; ---------------------------------------------------------------------------

loc_10016AE2:				; CODE XREF: PR_Interrupt+119j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_10016AEE:				; CODE XREF: PR_Interrupt+130j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10016AF7:				; CODE XREF: PR_Interrupt+DEj
					; PR_Interrupt+110j
		cmp	dword_1003067C,	0
		jz	short loc_10016B1B
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	[eax+10h], ebx
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10016B1B:				; CODE XREF: PR_Interrupt+14Ej
		mov	ecx, dwTlsIndex
		push	ebx		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10016B29:				; CODE XREF: PR_Interrupt+D6j
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
PR_Interrupt	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  49. PR_ClearInterrupt

; =============== S U B	R O U T	I N E =======================================


		public PR_ClearInterrupt
PR_ClearInterrupt proc near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebx, ds:TlsGetValue
		mov	esi, eax
		test	byte ptr [esi+90h], 80h
		jnz	short loc_10016BAA
		cmp	dword_1003067C,	0
		jz	short loc_10016B6A
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	ebp, [edx+10h]
		jmp	short loc_10016B74
; ---------------------------------------------------------------------------

loc_10016B6A:				; CODE XREF: PR_ClearInterrupt+21j
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	ebx ; TlsGetValue
		mov	ebp, eax

loc_10016B74:				; CODE XREF: PR_ClearInterrupt+38j
		cmp	dword_1003067C,	0
		jz	short loc_10016B99
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	dword ptr [eax+10h], 1
		jmp	short loc_10016BAE
; ---------------------------------------------------------------------------

loc_10016B99:				; CODE XREF: PR_ClearInterrupt+4Bj
		mov	ecx, dwTlsIndex
		push	1		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue
		jmp	short loc_10016BAE
; ---------------------------------------------------------------------------

loc_10016BAA:				; CODE XREF: PR_ClearInterrupt+18j
		mov	ebp, [esp+10h+var_4]

loc_10016BAE:				; CODE XREF: PR_ClearInterrupt+67j
					; PR_ClearInterrupt+78j
		push	edi
		lea	edi, [esi+40h]
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		and	dword ptr [esi+90h], 0FFFFFFFDh
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	byte ptr [esi+90h], 80h
		pop	edi
		jnz	loc_10016C6A
		test	ebp, ebp
		jnz	short loc_10016C38
		cmp	dword_1003067C,	ebp
		jz	short loc_10016BF8
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_10016C01
; ---------------------------------------------------------------------------

loc_10016BF8:				; CODE XREF: PR_ClearInterrupt+AFj
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ebx ; TlsGetValue

loc_10016C01:				; CODE XREF: PR_ClearInterrupt+C6j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10016C38
		cmp	dword_1003067C,	0
		jz	short loc_10016C27
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_10016C2F
; ---------------------------------------------------------------------------

loc_10016C27:				; CODE XREF: PR_ClearInterrupt+DEj
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ebx ; TlsGetValue

loc_10016C2F:				; CODE XREF: PR_ClearInterrupt+F5j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10016C38:				; CODE XREF: PR_ClearInterrupt+A7j
					; PR_ClearInterrupt+D5j
		cmp	dword_1003067C,	0
		jz	short loc_10016C5C
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		pop	esi
		mov	[eax+10h], ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10016C5C:				; CODE XREF: PR_ClearInterrupt+10Fj
		mov	ecx, dwTlsIndex
		push	ebp		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10016C6A:				; CODE XREF: PR_ClearInterrupt+9Fj
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
PR_ClearInterrupt endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  33. PR_BlockInterrupt

; =============== S U B	R O U T	I N E =======================================


		public PR_BlockInterrupt
PR_BlockInterrupt proc near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebx, ds:TlsGetValue
		mov	esi, eax
		test	byte ptr [esi+90h], 80h
		jnz	short loc_10016CEA
		cmp	dword_1003067C,	0
		jz	short loc_10016CAA
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	ebp, [edx+10h]
		jmp	short loc_10016CB4
; ---------------------------------------------------------------------------

loc_10016CAA:				; CODE XREF: PR_BlockInterrupt+21j
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	ebx ; TlsGetValue
		mov	ebp, eax

loc_10016CB4:				; CODE XREF: PR_BlockInterrupt+38j
		cmp	dword_1003067C,	0
		jz	short loc_10016CD9
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	dword ptr [eax+10h], 1
		jmp	short loc_10016CEE
; ---------------------------------------------------------------------------

loc_10016CD9:				; CODE XREF: PR_BlockInterrupt+4Bj
		mov	ecx, dwTlsIndex
		push	1		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue
		jmp	short loc_10016CEE
; ---------------------------------------------------------------------------

loc_10016CEA:				; CODE XREF: PR_BlockInterrupt+18j
		mov	ebp, [esp+10h+var_4]

loc_10016CEE:				; CODE XREF: PR_BlockInterrupt+67j
					; PR_BlockInterrupt+78j
		push	edi
		lea	edi, [esi+40h]
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		or	dword ptr [esi+90h], 1000h
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	byte ptr [esi+90h], 80h
		pop	edi
		jnz	loc_10016DAD
		test	ebp, ebp
		jnz	short loc_10016D7B
		cmp	dword_1003067C,	ebp
		jz	short loc_10016D3B
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_10016D44
; ---------------------------------------------------------------------------

loc_10016D3B:				; CODE XREF: PR_BlockInterrupt+B2j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ebx ; TlsGetValue

loc_10016D44:				; CODE XREF: PR_BlockInterrupt+C9j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10016D7B
		cmp	dword_1003067C,	0
		jz	short loc_10016D6A
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_10016D72
; ---------------------------------------------------------------------------

loc_10016D6A:				; CODE XREF: PR_BlockInterrupt+E1j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ebx ; TlsGetValue

loc_10016D72:				; CODE XREF: PR_BlockInterrupt+F8j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10016D7B:				; CODE XREF: PR_BlockInterrupt+AAj
					; PR_BlockInterrupt+D8j
		cmp	dword_1003067C,	0
		jz	short loc_10016D9F
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		pop	esi
		mov	[eax+10h], ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10016D9F:				; CODE XREF: PR_BlockInterrupt+112j
		mov	ecx, dwTlsIndex
		push	ebp		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10016DAD:				; CODE XREF: PR_BlockInterrupt+A2j
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
PR_BlockInterrupt endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 365. PR_UnblockInterrupt

; =============== S U B	R O U T	I N E =======================================


		public PR_UnblockInterrupt
PR_UnblockInterrupt proc near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebx, ds:TlsGetValue
		mov	esi, eax
		test	byte ptr [esi+90h], 80h
		jnz	short loc_10016E3A
		cmp	dword_1003067C,	0
		jz	short loc_10016DFA
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	ebp, [edx+10h]
		jmp	short loc_10016E04
; ---------------------------------------------------------------------------

loc_10016DFA:				; CODE XREF: PR_UnblockInterrupt+21j
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	ebx ; TlsGetValue
		mov	ebp, eax

loc_10016E04:				; CODE XREF: PR_UnblockInterrupt+38j
		cmp	dword_1003067C,	0
		jz	short loc_10016E29
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	dword ptr [eax+10h], 1
		jmp	short loc_10016E3E
; ---------------------------------------------------------------------------

loc_10016E29:				; CODE XREF: PR_UnblockInterrupt+4Bj
		mov	ecx, dwTlsIndex
		push	1		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue
		jmp	short loc_10016E3E
; ---------------------------------------------------------------------------

loc_10016E3A:				; CODE XREF: PR_UnblockInterrupt+18j
		mov	ebp, [esp+10h+var_4]

loc_10016E3E:				; CODE XREF: PR_UnblockInterrupt+67j
					; PR_UnblockInterrupt+78j
		push	edi
		lea	edi, [esi+40h]
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		and	dword ptr [esi+90h], 0FFFFEFFFh
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	byte ptr [esi+90h], 80h
		pop	edi
		jnz	loc_10016EFD
		test	ebp, ebp
		jnz	short loc_10016ECB
		cmp	dword_1003067C,	ebp
		jz	short loc_10016E8B
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_10016E94
; ---------------------------------------------------------------------------

loc_10016E8B:				; CODE XREF: PR_UnblockInterrupt+B2j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ebx ; TlsGetValue

loc_10016E94:				; CODE XREF: PR_UnblockInterrupt+C9j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10016ECB
		cmp	dword_1003067C,	0
		jz	short loc_10016EBA
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_10016EC2
; ---------------------------------------------------------------------------

loc_10016EBA:				; CODE XREF: PR_UnblockInterrupt+E1j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ebx ; TlsGetValue

loc_10016EC2:				; CODE XREF: PR_UnblockInterrupt+F8j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10016ECB:				; CODE XREF: PR_UnblockInterrupt+AAj
					; PR_UnblockInterrupt+D8j
		cmp	dword_1003067C,	0
		jz	short loc_10016EEF
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		pop	esi
		mov	[eax+10h], ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10016EEF:				; CODE XREF: PR_UnblockInterrupt+112j
		mov	ecx, dwTlsIndex
		push	ebp		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10016EFD:				; CODE XREF: PR_UnblockInterrupt+A2j
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
PR_UnblockInterrupt endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 184. PR_GetSP

; =============== S U B	R O U T	I N E =======================================


		public PR_GetSP
PR_GetSP	proc near		; CODE XREF: PR_ThreadScanStackPointers+49p
					; PR_GetStackSpaceLeft+22p
					; DATA XREF: ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+120h]
		retn
PR_GetSP	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. GetExecutionEnvironment

; =============== S U B	R O U T	I N E =======================================


		public GetExecutionEnvironment
GetExecutionEnvironment	proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+14h]
		retn
GetExecutionEnvironment	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 403. SetExecutionEnvironment

; =============== S U B	R O U T	I N E =======================================


		public SetExecutionEnvironment
SetExecutionEnvironment	proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		mov	[ecx+14h], eax
		retn
SetExecutionEnvironment	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 192. PR_GetThreadAffinityMask
; [00000005 BYTES: COLLAPSED FUNCTION PR_GetThreadAffinityMask]
		align 10h
; Exported entry 336. PR_SetThreadAffinityMask
; [00000005 BYTES: COLLAPSED FUNCTION PR_SetThreadAffinityMask]
		align 10h
; Exported entry 319. PR_SetCPUAffinityMask

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SetCPUAffinityMask(DWORD_PTR dwThreadAffinityMask)
		public PR_SetCPUAffinityMask
PR_SetCPUAffinityMask proc near		; DATA XREF: .rdata:off_1002C7C8o

dwThreadAffinityMask= dword ptr	 4

		cmp	dword_10031520,	0
		jnz	short loc_10016F6E
		call	PR_Init

loc_10016F6E:				; CODE XREF: PR_SetCPUAffinityMask+7j
		push	esi
		mov	esi, off_100302C0
		push	edi
		mov	edi, [esp+8+dwThreadAffinityMask]
		mov	dwThreadAffinityMask, edi
		cmp	esi, offset off_100302C0
		jz	short loc_10016F9F

loc_10016F88:				; CODE XREF: PR_SetCPUAffinityMask+3Dj
		mov	eax, [esi+18h]
		push	edi		; dwThreadAffinityMask
		push	eax		; int
		call	PR_SetThreadAffinityMask_0
		mov	esi, [esi]
		add	esp, 8
		cmp	esi, offset off_100302C0
		jnz	short loc_10016F88

loc_10016F9F:				; CODE XREF: PR_SetCPUAffinityMask+26j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
PR_SetCPUAffinityMask endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 341. PR_SetThreadRecycleMode

; =============== S U B	R O U T	I N E =======================================


		public PR_SetThreadRecycleMode
PR_SetThreadRecycleMode	proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword_10031598,	eax
		retn
PR_SetThreadRecycleMode	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  72. PR_CreateThreadGCAble

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateThreadGCAble
PR_CreateThreadGCAble proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	eax, [esp+arg_18]
		mov	ecx, [esp+arg_14]
		mov	edx, [esp+arg_10]
		push	400h
		push	eax
		mov	eax, [esp+8+arg_C]
		push	ecx
		mov	ecx, [esp+0Ch+arg_8]
		push	edx
		mov	edx, [esp+10h+arg_4]
		push	eax
		mov	eax, [esp+14h+arg_0]
		push	ecx
		push	edx
		push	eax
		call	_PR_CreateThread
		add	esp, 20h
		retn
PR_CreateThreadGCAble endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 338. PR_SetThreadGCAble

; =============== S U B	R O U T	I N E =======================================


		public PR_SetThreadGCAble
PR_SetThreadGCAble proc	near		; DATA XREF: .rdata:off_1002C7C8o
		cmp	dword_10031520,	0
		jnz	short loc_1001700E
		call	PR_Init

loc_1001700E:				; CODE XREF: PR_SetThreadGCAble+7j
		mov	eax, dword_10032A60
		push	eax
		call	PR_Lock
		call	PR_AssertCurrentThreadOwnsLock_0
		or	dword ptr [eax+90h], 400h
		mov	ecx, dword_10032A60
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		retn
PR_SetThreadGCAble endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  50. PR_ClearThreadGCAble

; =============== S U B	R O U T	I N E =======================================


		public PR_ClearThreadGCAble
PR_ClearThreadGCAble proc near		; DATA XREF: .rdata:off_1002C7C8o
		cmp	dword_10031520,	0
		jnz	short loc_1001704E
		call	PR_Init

loc_1001704E:				; CODE XREF: PR_ClearThreadGCAble+7j
		mov	eax, dword_10032A60
		push	eax
		call	PR_Lock
		call	PR_AssertCurrentThreadOwnsLock_0
		and	dword ptr [eax+90h], 0FFFFFBFFh
		mov	ecx, dword_10032A60
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		retn
PR_ClearThreadGCAble endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 197. PR_GetThreadScope

; =============== S U B	R O U T	I N E =======================================


		public PR_GetThreadScope
PR_GetThreadScope proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1001708E
		call	PR_Init

loc_1001708E:				; CODE XREF: PR_GetThreadScope+7j
		mov	eax, [esp+arg_0]
		mov	eax, [eax+90h]
		test	al, al
		jns	short loc_100170A9
		and	eax, 800h
		neg	eax
		sbb	eax, eax
		neg	eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100170A9:				; CODE XREF: PR_GetThreadScope+1Aj
		xor	eax, eax
		retn
PR_GetThreadScope endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 199. PR_GetThreadType

; =============== S U B	R O U T	I N E =======================================


		public PR_GetThreadType
PR_GetThreadType proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+90h]
		and	eax, 1
		retn
PR_GetThreadType endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 198. PR_GetThreadState

; =============== S U B	R O U T	I N E =======================================


		public PR_GetThreadState
PR_GetThreadState proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		xor	eax, eax
		cmp	[ecx+98h], eax
		setz	al
		retn
PR_GetThreadState endp

; Exported entry 346. PR_Sleep

; =============== S U B	R O U T	I N E =======================================


		public PR_Sleep
PR_Sleep	proc near		; CODE XREF: PR_Select+80p
					; PR_Yield+22p	...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		push	edi
		mov	[esp+14h+var_4], ebp
		cmp	dword_10031520,	ebp
		jnz	short loc_100170E8
		call	PR_Init

loc_100170E8:				; CODE XREF: PR_Sleep+11j
		mov	esi, [esp+14h+arg_0]
		test	esi, esi
		jnz	loc_1001731B
		cmp	dword_10031520,	ebp
		jnz	short loc_10017101
		call	PR_Init

loc_10017101:				; CODE XREF: PR_Sleep+2Aj
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	edi, eax
		mov	ebx, [edi+4]
		cmp	dword_1003067C,	ebp
		jz	short loc_1001712A
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	esi, [edx+14h]
		jmp	short loc_10017138
; ---------------------------------------------------------------------------

loc_1001712A:				; CODE XREF: PR_Sleep+41j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	esi, eax

loc_10017138:				; CODE XREF: PR_Sleep+58j
		test	byte ptr [edi+90h], 80h
		jz	short loc_1001714E
		call	sub_100245C0
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001714E:				; CODE XREF: PR_Sleep+6Fj
		cmp	dword_1003067C,	ebp
		jz	short loc_1001716E
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	ebp, [eax+10h]
		jmp	short loc_1001717D
; ---------------------------------------------------------------------------

loc_1001716E:				; CODE XREF: PR_Sleep+84j
		mov	ecx, dwTlsIndex
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	ebp, eax

loc_1001717D:				; CODE XREF: PR_Sleep+9Cj
		cmp	dword_1003067C,	0
		jz	short loc_100171A1
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	dword ptr [ecx+10h], 1
		jmp	short loc_100171B0
; ---------------------------------------------------------------------------

loc_100171A1:				; CODE XREF: PR_Sleep+B4j
		mov	edx, dwTlsIndex
		push	1		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_100171B0:				; CODE XREF: PR_Sleep+CFj
		mov	eax, [esi+24h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esi+24h]
		mov	edx, [eax+68h]
		mov	ecx, ebx
		shr	edx, cl
		test	edx, edx
		jz	loc_1001729C
		mov	[edi+9Ch], esi
		mov	dword ptr [edi], 1
		mov	ecx, [esi+24h]
		lea	edx, [ecx+ebx*8+48h]
		mov	[edi+68h], edx
		mov	ecx, [esi+24h]
		mov	edx, [ecx+ebx*8+4Ch]
		lea	eax, [edi+68h]
		mov	[edi+6Ch], edx
		mov	ecx, [esi+24h]
		mov	edx, [ecx+ebx*8+4Ch]
		mov	[edx], eax
		mov	ecx, [esi+24h]
		mov	[ecx+ebx*8+4Ch], eax
		mov	eax, [esi+24h]
		mov	ecx, ebx
		mov	edx, 1
		shl	edx, cl
		or	[eax+68h], edx
		mov	dword ptr [edi+58h], 1
		mov	eax, [esi+24h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, dword_10032AB4
		mov	esi, 4
		cmp	[ecx+4], esi
		jl	short loc_1001723C
		push	offset aPr_yieldYieldi ; "PR_Yield: yielding"
		call	PR_LogPrint
		add	esp, 4

loc_1001723C:				; CODE XREF: PR_Sleep+15Dj
		push	edi
		call	sub_10024960
		mov	edx, dword_10032AB4
		add	esp, 4
		cmp	[edx+4], esi
		jl	short loc_1001725D
		push	offset aPr_yieldDone ; "PR_Yield: done"
		call	PR_LogPrint

loc_1001725A:				; CODE XREF: PR_Sleep+22Ej
					; PR_Sleep+246j
		add	esp, 4

loc_1001725D:				; CODE XREF: PR_Sleep+17Ej
					; PR_Sleep+1D5j ...
		cmp	dword_1003067C,	0
		jz	short loc_10017285
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [esp+14h+var_4]
		pop	edi
		pop	esi
		mov	[edx+10h], ebp
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10017285:				; CODE XREF: PR_Sleep+194j
		mov	eax, dwTlsIndex
		push	ebp		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue
		mov	eax, [esp+14h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001729C:				; CODE XREF: PR_Sleep+F6j
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	ebp, ebp
		jnz	short loc_1001725D
		cmp	dword_1003067C,	ebp
		jz	short loc_100172C7
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+14h]
		jmp	short loc_100172D4
; ---------------------------------------------------------------------------

loc_100172C7:				; CODE XREF: PR_Sleep+1DDj
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_100172D4:				; CODE XREF: PR_Sleep+1F5j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1001725D
		cmp	dword_1003067C,	0
		jz	short loc_10017303
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		push	eax
		call	sub_100190B0
		jmp	loc_1001725A
; ---------------------------------------------------------------------------

loc_10017303:				; CODE XREF: PR_Sleep+211j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		push	eax
		call	sub_100190B0
		jmp	loc_1001725A
; ---------------------------------------------------------------------------

loc_1001731B:				; CODE XREF: PR_Sleep+1Ej
		call	PR_IntervalNow
		mov	ecx, dword_10032AA0
		push	ecx
		mov	ebx, eax
		call	PR_NewCondVar
		mov	edx, dword_10032AA0
		push	edx
		mov	edi, eax
		call	PR_Lock
		add	esp, 8
		nop

loc_10017340:				; CODE XREF: PR_Sleep+28Fj
		call	PR_IntervalNow
		sub	eax, ebx
		cmp	eax, esi
		ja	short loc_10017361
		mov	ecx, esi
		sub	ecx, eax
		push	ecx
		push	edi
		call	PR_WaitCondVar
		add	esp, 8
		mov	[esp+14h+var_4], eax
		test	eax, eax
		jz	short loc_10017340

loc_10017361:				; CODE XREF: PR_Sleep+279j
		mov	edx, dword_10032AA0
		push	edx		; lpTlsValue
		call	PR_Unlock
		push	edi		; Memory
		call	PR_DestroyCondVar
		mov	eax, [esp+1Ch+var_4]
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
PR_Sleep	endp

; Exported entry 380. PR_Yield

; =============== S U B	R O U T	I N E =======================================


		public PR_Yield
PR_Yield	proc near		; DATA XREF: .rdata:off_1002C7C8o
		cmp	dword_10030654,	0
		jz	short loc_100173A0
		push	offset aPr_sleepPr_int ; "PR_Sleep(PR_INTERVAL_NO_WAIT)"
		push	offset aPr_yield_0 ; "PR_Yield()"
		call	sub_10014330
		add	esp, 8
		mov	dword_10030654,	eax

loc_100173A0:				; CODE XREF: PR_Yield+7j
		push	0
		call	PR_Sleep
		add	esp, 4
		retn
PR_Yield	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100173B0	proc near		; CODE XREF: sub_10017410+23p
					; sub_10017410+40p ...

var_68		= byte ptr -68h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch

		sub	esp, 68h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+68h+var_4], eax
		mov	ecx, [esp+68h+arg_4]
		push	esi
		push	edi
		mov	edi, [esp+70h+arg_0]
		lea	eax, [esp+70h+arg_8]
		push	eax
		push	ecx
		lea	edx, [esp+78h+var_68]
		push	64h
		push	edx
		call	PR_vsnprintf
		mov	esi, eax
		push	esi
		lea	eax, [esp+84h+var_68]
		push	eax
		push	edi
		call	PR_Write
		mov	ecx, [esp+8Ch+var_4]
		add	esp, 1Ch
		pop	edi
		mov	eax, esi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 68h
		retn
sub_100173B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017410	proc near		; CODE XREF: sub_10017580+1Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		mov	eax, [esi+90h]
		mov	ecx, [esi+4]
		mov	edx, [esi+8Ch]
		push	edi
		mov	edi, [esp+8+arg_0]
		push	eax
		push	ecx
		push	esi
		push	edx
		push	offset a05d08pPri2dFla ; "%05d[%08p] pri=%2d flags=0x%02x"
		push	edi
		call	sub_100173B0
		mov	eax, [esi]
		add	esp, 18h
		sub	eax, 3
		jz	short loc_10017478
		dec	eax
		jz	short loc_1001745A
		sub	eax, 3
		jnz	short loc_1001748D
		push	offset aSuspended ; " suspended"
		push	edi
		call	sub_100173B0
		add	esp, 8
		jmp	short loc_1001748D
; ---------------------------------------------------------------------------

loc_1001745A:				; CODE XREF: sub_10017410+33j
		mov	eax, [esi+80h]
		mov	ecx, [esi+88h]
		push	eax
		push	ecx
		push	offset aCondvarPSleepL ; " condvar=%p sleep=%lldms"
		push	edi
		call	sub_100173B0
		add	esp, 10h
		jmp	short loc_1001748D
; ---------------------------------------------------------------------------

loc_10017478:				; CODE XREF: sub_10017410+30j
		mov	edx, [esi+84h]
		push	edx
		push	offset aLockP	; " lock=%p"
		push	edi
		call	sub_100173B0
		add	esp, 0Ch

loc_1001748D:				; CODE XREF: sub_10017410+38j
					; sub_10017410+48j ...
		push	1
		push	offset asc_1002B098 ; "\n"
		push	edi
		call	PR_Write
		mov	eax, [esi+18h]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100174AF
		mov	ecx, [esi+1Ch]
		push	ecx
		push	esi
		push	edi
		call	eax
		add	esp, 0Ch

loc_100174AF:				; CODE XREF: sub_10017410+92j
		pop	edi
		pop	esi
		retn
sub_10017410	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100174C0	proc near		; CODE XREF: sub_10017580+3Fp
					; sub_10017580+6Ap ...

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		mov	ebp, [esp+8+arg_0]
		mov	ebx, [ebp+0]
		cmp	ebx, ebp
		jz	loc_1001756F
		push	esi

loc_100174D2:				; CODE XREF: sub_100174C0+A8j
		mov	eax, [ebx+28h]
		mov	ecx, [ebx-64h]
		mov	edx, [ebx+24h]
		lea	esi, [ebx-68h]
		push	eax
		push	ecx
		push	esi
		push	edx
		push	offset a05d08pPri2dFla ; "%05d[%08p] pri=%2d flags=0x%02x"
		push	edi
		call	sub_100173B0
		mov	eax, [esi]
		add	esp, 18h
		sub	eax, 3
		jz	short loc_1001752D
		dec	eax
		jz	short loc_1001750F
		sub	eax, 3
		jnz	short loc_10017542
		push	offset aSuspended ; " suspended"
		push	edi
		call	sub_100173B0
		add	esp, 8
		jmp	short loc_10017542
; ---------------------------------------------------------------------------

loc_1001750F:				; CODE XREF: sub_100174C0+38j
		mov	eax, [esi+80h]
		mov	ecx, [esi+88h]
		push	eax
		push	ecx
		push	offset aCondvarPSleepL ; " condvar=%p sleep=%lldms"
		push	edi
		call	sub_100173B0
		add	esp, 10h
		jmp	short loc_10017542
; ---------------------------------------------------------------------------

loc_1001752D:				; CODE XREF: sub_100174C0+35j
		mov	edx, [esi+84h]
		push	edx
		push	offset aLockP	; " lock=%p"
		push	edi
		call	sub_100173B0
		add	esp, 0Ch

loc_10017542:				; CODE XREF: sub_100174C0+3Dj
					; sub_100174C0+4Dj ...
		push	1
		push	offset asc_1002B098 ; "\n"
		push	edi
		call	PR_Write
		mov	eax, [esi+18h]
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10017564
		mov	ecx, [esi+1Ch]
		push	ecx
		push	esi
		push	edi
		call	eax
		add	esp, 0Ch

loc_10017564:				; CODE XREF: sub_100174C0+97j
		mov	ebx, [ebx]
		cmp	ebx, ebp
		jnz	loc_100174D2
		pop	esi

loc_1001756F:				; CODE XREF: sub_100174C0+Bj
		pop	ebp
		pop	ebx
		retn
sub_100174C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017580	proc near		; CODE XREF: PR_ShowStatus+8Ap

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		push	offset aCurrentThread ;	"Current Thread:\n"
		push	edi
		call	sub_100173B0
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebx, eax
		push	ebx
		push	edi
		call	sub_10017410
		push	offset aRunnableThread ; "Runnable Threads:\n"
		push	edi
		call	sub_100173B0
		add	esp, 18h
		mov	esi, 48h

loc_100175B3:				; CODE XREF: sub_10017580+50j
		mov	eax, [ebx+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, esi
		push	ecx
		call	sub_100174C0
		add	esi, 8
		add	esp, 4
		cmp	esi, 148h
		jl	short loc_100175B3
		push	offset aCondvarTimedWa ; "CondVar timed	wait Threads:\n"
		push	edi
		call	sub_100173B0
		mov	edx, [ebx+9Ch]
		mov	eax, [edx+24h]
		add	eax, 6Ch
		push	eax
		call	sub_100174C0
		push	offset aCondvarWaitThr ; "CondVar wait Threads:\n"
		push	edi
		call	sub_100173B0
		mov	ecx, [ebx+9Ch]
		mov	edx, [ecx+24h]
		add	edx, 78h
		push	edx
		call	sub_100174C0
		push	offset aSuspendedThrea ; "Suspended Threads:\n"
		push	edi
		call	sub_100173B0
		mov	eax, [ebx+9Ch]
		mov	ecx, [eax+24h]
		sub	ecx, 0FFFFFF80h
		push	ecx
		call	sub_100174C0
		add	esp, 24h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10017580	endp

; Exported entry 343. PR_ShowStatus

; =============== S U B	R O U T	I N E =======================================


		public PR_ShowStatus
PR_ShowStatus	proc near		; DATA XREF: .rdata:off_1002C7C8o

var_4		= dword	ptr -4

		push	ecx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	edi, TlsIndex
		mov	ebp, ds:TlsSetValue
		test	eax, eax
		jz	short loc_100176AB
		call	PR_AssertCurrentThreadOwnsLock_0
		test	byte ptr [eax+90h], 80h
		jnz	short loc_100176AB
		cmp	dword_1003067C,	0
		jz	short loc_10017671
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edi*4]
		mov	esi, [ecx+10h]
		jmp	short loc_10017680
; ---------------------------------------------------------------------------

loc_10017671:				; CODE XREF: PR_ShowStatus+2Ej
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	esi, eax

loc_10017680:				; CODE XREF: PR_ShowStatus+3Fj
		cmp	dword_1003067C,	0
		jz	short loc_1001769E
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edi*4]
		mov	dword ptr [ecx+10h], 1
		jmp	short loc_100176AF
; ---------------------------------------------------------------------------

loc_1001769E:				; CODE XREF: PR_ShowStatus+57j
		mov	edx, dwTlsIndex
		push	1		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ebp ; TlsSetValue
		jmp	short loc_100176AF
; ---------------------------------------------------------------------------

loc_100176AB:				; CODE XREF: PR_ShowStatus+17j
					; PR_ShowStatus+25j
		mov	esi, [esp+10h+var_4]

loc_100176AF:				; CODE XREF: PR_ShowStatus+6Cj
					; PR_ShowStatus+79j
		mov	eax, dword_10032A9C
		push	eax
		mov	dword_10032A80,	eax
		call	sub_10017580
		add	esp, 4
		call	PR_AssertCurrentThreadOwnsLock_0
		test	eax, eax
		jz	short loc_10017700
		call	PR_AssertCurrentThreadOwnsLock_0
		test	byte ptr [eax+90h], 80h
		jnz	short loc_10017700
		cmp	dword_1003067C,	0
		jz	short loc_100176F6
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edi*4]
		pop	edi
		mov	[ecx+10h], esi
		pop	esi
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100176F6:				; CODE XREF: PR_ShowStatus+B0j
		mov	edx, dwTlsIndex
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ebp ; TlsSetValue

loc_10017700:				; CODE XREF: PR_ShowStatus+99j
					; PR_ShowStatus+A7j
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
PR_ShowStatus	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 337. PR_SetThreadDumpProc

; =============== S U B	R O U T	I N E =======================================


		public PR_SetThreadDumpProc
PR_SetThreadDumpProc proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [esp+arg_4]
		mov	edx, [esp+arg_8]
		mov	[eax+18h], ecx
		mov	[eax+1Ch], edx
		retn
PR_SetThreadDumpProc endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017730	proc near		; CODE XREF: PR_ExitMonitor+46p
		push	esi
		mov	esi, eax
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_10017743
		push	edi
		call	PR_NotifyAllCondVar
		add	esp, 4
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017743:				; CODE XREF: sub_10017730+6j
		test	esi, esi
		jle	short loc_10017755

loc_10017747:				; CODE XREF: sub_10017730+23j
		push	edi
		dec	esi
		call	PR_NotifyCondVar
		add	esp, 4
		test	esi, esi
		jg	short loc_10017747

loc_10017755:				; CODE XREF: sub_10017730+15j
		pop	esi
		retn
sub_10017730	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 254. PR_NewMonitor

; =============== S U B	R O U T	I N E =======================================


		public PR_NewMonitor
PR_NewMonitor	proc near		; CODE XREF: sub_10007470:loc_100074B0p
					; PR_NewNamedMonitorp
					; DATA XREF: ...
		cmp	dword_10031520,	0
		jnz	short loc_1001776E
		call	PR_Init

loc_1001776E:				; CODE XREF: PR_NewMonitor+7j
		push	esi
		push	94h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jnz	short loc_10017796
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017796:				; CODE XREF: PR_NewMonitor+22j
		push	ebx
		push	edi
		lea	edi, [esi+4]
		push	edi
		call	sub_10019270
		add	esp, 4
		test	eax, eax
		jnz	short loc_100177DF
		lea	ebx, [esi+3Ch]
		push	edi
		push	ebx
		mov	[esi+38h], eax
		call	sub_10018C00
		add	esp, 8
		test	eax, eax
		jnz	short loc_100177D6
		lea	eax, [esi+64h]
		push	edi
		push	eax
		call	sub_10018C00
		add	esp, 8
		test	eax, eax
		jz	short loc_100177EE
		push	ebx
		call	sub_10018C30
		add	esp, 4

loc_100177D6:				; CODE XREF: PR_NewMonitor+5Aj
		push	edi
		call	sub_10019290
		add	esp, 4

loc_100177DF:				; CODE XREF: PR_NewMonitor+46j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	ebx
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100177EE:				; CODE XREF: PR_NewMonitor+6Bj
		pop	edi
		pop	ebx
		mov	dword ptr [esi+90h], 0
		mov	dword ptr [esi+8Ch], 0
		mov	dword ptr [esi], 0
		mov	eax, esi
		pop	esi
		retn
PR_NewMonitor	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 255. PR_NewNamedMonitor

; =============== S U B	R O U T	I N E =======================================


		public PR_NewNamedMonitor
PR_NewNamedMonitor proc	near		; CODE XREF: sub_10007F20+Ep
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		call	PR_NewMonitor
		test	eax, eax
		jz	short locret_1001781F
		mov	ecx, [esp+arg_0]
		mov	[eax], ecx

locret_1001781F:			; CODE XREF: PR_NewNamedMonitor+7j
		retn
PR_NewNamedMonitor endp

; Exported entry  85. PR_DestroyMonitor

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyMonitor(void *Memory)
		public PR_DestroyMonitor
PR_DestroyMonitor proc near		; CODE XREF: sub_10007710+28p
					; sub_10007FB0+6p
					; DATA XREF: ...

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		lea	eax, [esi+64h]
		push	eax
		call	sub_10018C30
		lea	ecx, [esi+3Ch]
		push	ecx
		call	sub_10018C30
		lea	edx, [esi+4]
		push	edx
		call	sub_10019290
		push	esi		; Memory
		call	PR_Free
		add	esp, 10h
		pop	esi
		retn
PR_DestroyMonitor endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 102. PR_EnterMonitor

; =============== S U B	R O U T	I N E =======================================


		public PR_EnterMonitor
PR_EnterMonitor	proc near		; CODE XREF: PR_CEnterMonitor+3Ep
					; sub_10007F20+1Dp ...

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, [esp+0Ch+arg_0]
		lea	ebp, [esi+4]
		push	ebp
		mov	ebx, eax
		call	PR_Lock
		add	esp, 4
		cmp	dword ptr [esi+8Ch], 0
		jz	short loc_10017895
		cmp	[esi+38h], ebx
		jz	short loc_10017898
		push	edi
		lea	edi, [esi+3Ch]
		lea	esp, [esp+0]

loc_10017880:				; CODE XREF: PR_EnterMonitor+42j
		push	0FFFFFFFFh
		push	edi
		call	PR_WaitCondVar
		add	esp, 8
		cmp	dword ptr [esi+8Ch], 0
		jnz	short loc_10017880
		pop	edi

loc_10017895:				; CODE XREF: PR_EnterMonitor+21j
		mov	[esi+38h], ebx

loc_10017898:				; CODE XREF: PR_EnterMonitor+26j
		inc	dword ptr [esi+8Ch]
		push	ebp		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ebx
		retn
PR_EnterMonitor	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 357. PR_TestAndEnterMonitor

; =============== S U B	R O U T	I N E =======================================


		public PR_TestAndEnterMonitor
PR_TestAndEnterMonitor proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, [esp+0Ch+arg_0]
		lea	edi, [esi+4]
		push	edi
		mov	ebx, eax
		call	PR_Lock
		mov	eax, [esi+8Ch]
		add	esp, 4
		test	eax, eax
		jz	short loc_100178E8
		cmp	[esi+38h], ebx
		jz	short loc_100178EB
		push	edi		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100178E8:				; CODE XREF: PR_TestAndEnterMonitor+22j
		mov	[esi+38h], ebx

loc_100178EB:				; CODE XREF: PR_TestAndEnterMonitor+27j
		inc	eax
		push	edi		; lpTlsValue
		mov	[esi+8Ch], eax
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		mov	eax, 1
		pop	ebx
		retn
PR_TestAndEnterMonitor endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 112. PR_ExitMonitor

; =============== S U B	R O U T	I N E =======================================


		public PR_ExitMonitor
PR_ExitMonitor	proc near		; CODE XREF: PR_CExitMonitor+86p
					; sub_10007F20+84p ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, [esp+0Ch+arg_0]
		lea	ebx, [esi+4]
		push	ebx
		mov	edi, eax
		call	PR_Lock
		mov	eax, [esi+8Ch]
		add	esp, 4
		test	eax, eax
		jz	short loc_10017980
		cmp	[esi+38h], edi
		jnz	short loc_10017980
		dec	eax
		mov	[esi+8Ch], eax
		jnz	short loc_10017971
		mov	eax, [esi+90h]
		mov	dword ptr [esi+38h], 0
		test	eax, eax
		jz	short loc_10017965
		lea	edi, [esi+64h]
		call	sub_10017730
		mov	dword ptr [esi+90h], 0

loc_10017965:				; CODE XREF: PR_ExitMonitor+41j
		add	esi, 3Ch
		push	esi
		call	PR_NotifyCondVar
		add	esp, 4

loc_10017971:				; CODE XREF: PR_ExitMonitor+30j
		push	ebx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10017980:				; CODE XREF: PR_ExitMonitor+22j
					; PR_ExitMonitor+27j
		push	ebx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
PR_ExitMonitor	endp

; Exported entry 169. PR_GetMonitorEntryCount

; =============== S U B	R O U T	I N E =======================================


		public PR_GetMonitorEntryCount
PR_GetMonitorEntryCount	proc near	; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, [esp+10h+arg_0]
		lea	edi, [esi+4]
		push	edi
		mov	ebp, eax
		xor	ebx, ebx
		call	PR_Lock
		add	esp, 4
		cmp	[esi+38h], ebp
		jnz	short loc_100179B8
		mov	ebx, [esi+8Ch]

loc_100179B8:				; CODE XREF: PR_GetMonitorEntryCount+20j
		push	edi		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		retn
PR_GetMonitorEntryCount	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 371. PR_Wait

; =============== S U B	R O U T	I N E =======================================


		public PR_Wait
PR_Wait		proc near		; CODE XREF: PR_CWait+6Fp
					; DATA XREF: .rdata:off_1002C7C8o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 8
		push	ebx
		push	esi
		mov	esi, [esp+10h+arg_0]
		lea	ebx, [esi+4]
		push	edi
		push	ebx
		mov	[esp+18h+arg_0], ebx
		call	PR_Lock
		mov	eax, [esi+8Ch]
		mov	ecx, [esi+38h]
		mov	edi, [esi+90h]
		add	esp, 4
		mov	[esp+14h+var_8], eax
		mov	dword ptr [esi+8Ch], 0
		mov	[esp+14h+var_4], ecx
		mov	dword ptr [esi+38h], 0
		test	edi, edi
		jz	short loc_10017A4C
		lea	ebx, [esi+64h]
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_10017A29
		push	ebx
		call	PR_NotifyAllCondVar
		add	esp, 4
		jmp	short loc_10017A3E
; ---------------------------------------------------------------------------

loc_10017A29:				; CODE XREF: PR_Wait+4Cj
		test	edi, edi
		jle	short loc_10017A3E
		lea	ecx, [ecx+0]

loc_10017A30:				; CODE XREF: PR_Wait+6Cj
		push	ebx
		dec	edi
		call	PR_NotifyCondVar
		add	esp, 4
		test	edi, edi
		jg	short loc_10017A30

loc_10017A3E:				; CODE XREF: PR_Wait+57j PR_Wait+5Bj
		mov	ebx, [esp+14h+arg_0]
		mov	dword ptr [esi+90h], 0

loc_10017A4C:				; CODE XREF: PR_Wait+44j
		lea	edi, [esi+3Ch]
		push	edi
		call	PR_NotifyCondVar
		mov	edx, [esp+18h+arg_4]
		lea	eax, [esi+64h]
		push	edx
		push	eax
		call	PR_WaitCondVar
		add	esp, 0Ch
		cmp	dword ptr [esi+8Ch], 0
		jz	short loc_10017A84
		nop

loc_10017A70:				; CODE XREF: PR_Wait+B2j
		push	0FFFFFFFFh
		push	edi
		call	PR_WaitCondVar
		add	esp, 8
		cmp	dword ptr [esi+8Ch], 0
		jnz	short loc_10017A70

loc_10017A84:				; CODE XREF: PR_Wait+9Dj
		mov	eax, [esp+14h+var_8]
		mov	ecx, [esp+14h+var_4]
		push	ebx		; lpTlsValue
		mov	[esi+8Ch], eax
		mov	[esi+38h], ecx
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 8
		retn
PR_Wait		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 265. PR_Notify

; =============== S U B	R O U T	I N E =======================================


		public PR_Notify
PR_Notify	proc near		; CODE XREF: PR_CNotify+6Ap
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, [ecx+90h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10017AC6
		inc	eax
		mov	[ecx+90h], eax

loc_10017AC6:				; CODE XREF: PR_Notify+Dj
		xor	eax, eax
		retn
PR_Notify	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 266. PR_NotifyAll

; =============== S U B	R O U T	I N E =======================================


		public PR_NotifyAll
PR_NotifyAll	proc near		; CODE XREF: PR_CNotifyAll+6Ap
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword ptr [eax+90h], 0FFFFFFFFh
		xor	eax, eax
		retn
PR_NotifyAll	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 259. PR_NewSem

; =============== S U B	R O U T	I N E =======================================


		public PR_NewSem
PR_NewSem	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		push	edi
		push	10h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10017B47
		call	PR_NewLock
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10017B1D
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017B1D:				; CODE XREF: PR_NewSem+1Dj
		push	edi
		call	PR_NewCondVar
		add	esp, 4
		test	eax, eax
		jnz	short loc_10017B3E
		push	edi		; Memory
		call	PR_DestroyLock
		push	esi		; Memory
		call	PR_Free
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10017B3E:				; CODE XREF: PR_NewSem+38j
		mov	[esi], eax
		mov	eax, [esp+8+arg_0]
		mov	[esi+4], eax

loc_10017B47:				; CODE XREF: PR_NewSem+12j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
PR_NewSem	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  90. PR_DestroySem

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroySem(void *Memory)
		public PR_DestroySem
PR_DestroySem	proc near		; DATA XREF: .rdata:off_1002C7C8o

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi]
		mov	ecx, [eax]
		push	ecx		; Memory
		call	PR_DestroyLock
		mov	edx, [esi]
		push	edx		; Memory
		call	PR_DestroyCondVar
		push	esi		; Memory
		call	PR_Free
		add	esp, 0Ch
		pop	esi
		retn
PR_DestroySem	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 376. PR_WaitSem

; =============== S U B	R O U T	I N E =======================================


		public PR_WaitSem
PR_WaitSem	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi]
		mov	ecx, [eax]
		push	edi
		push	ecx
		xor	edi, edi
		call	PR_Lock
		add	esp, 4
		cmp	[esi+4], edi
		jnz	short loc_10017BBE
		lea	ebx, [ebx+0]

loc_10017BA0:				; CODE XREF: PR_WaitSem+3Cj
		mov	edx, [esi]
		inc	dword ptr [esi+8]
		push	0FFFFFFFFh
		push	edx
		call	PR_WaitCondVar
		dec	dword ptr [esi+8]
		mov	edi, eax
		add	esp, 8
		test	edi, edi
		jnz	short loc_10017BC1
		cmp	[esi+4], eax
		jz	short loc_10017BA0

loc_10017BBE:				; CODE XREF: PR_WaitSem+18j
		dec	dword ptr [esi+4]

loc_10017BC1:				; CODE XREF: PR_WaitSem+37j
		mov	eax, [esi]
		mov	ecx, [eax]
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
PR_WaitSem	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 282. PR_PostSem

; =============== S U B	R O U T	I N E =======================================


		public PR_PostSem
PR_PostSem	proc near		; DATA XREF: .rdata:off_1002C7C8o

lpTlsValue	= dword	ptr  4

		push	esi
		mov	esi, [esp+4+lpTlsValue]
		mov	eax, [esi]
		mov	ecx, [eax]
		push	ecx
		call	PR_Lock
		add	esp, 4
		cmp	dword ptr [esi+8], 0
		jz	short loc_10017C03
		mov	edx, [esi]
		push	edx
		call	PR_NotifyCondVar
		add	esp, 4

loc_10017C03:				; CODE XREF: PR_PostSem+16j
		mov	eax, [esi]
		inc	dword ptr [esi+4]
		mov	ecx, [eax]
		pop	esi
		mov	[esp+lpTlsValue], ecx ;	lpTlsValue
		jmp	PR_Unlock
PR_PostSem	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017C20	proc near		; CODE XREF: PR_Cleanup:loc_1000D4F1p
		push	esi
		xor	esi, esi
		mov	dword_10032A7C,	1
		cmp	dword_10032A78,	esi
		jbe	short loc_10017C48

loc_10017C35:				; CODE XREF: sub_10017C20+26j
		push	0
		call	sub_1001DF20
		inc	esi
		add	esp, 4
		cmp	esi, dword_10032A78
		jb	short loc_10017C35

loc_10017C48:				; CODE XREF: sub_10017C20+13j
		mov	esi, off_100302C0
		cmp	esi, offset off_100302C0
		jz	short loc_10017C71

loc_10017C56:				; CODE XREF: sub_10017C20+4Fj
		mov	eax, [esi+18h]
		add	eax, 0B0h
		push	eax
		call	sub_10024590
		mov	esi, [esi]
		add	esp, 4
		cmp	esi, offset off_100302C0
		jnz	short loc_10017C56

loc_10017C71:				; CODE XREF: sub_10017C20+34j
		pop	esi
		retn
sub_10017C20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017C80	proc near		; CODE XREF: PR_SetConcurrency+64p
					; sub_100181C0+36p
		push	esi
		push	edi
		push	94h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	edi, ds:InitializeCriticalSection
		add	esp, 8
		mov	esi, eax
		push	esi		; lpCriticalSection
		call	edi ; InitializeCriticalSection
		lea	eax, [esi+18h]
		push	eax		; lpCriticalSection
		call	edi ; InitializeCriticalSection
		lea	ecx, [esi+30h]
		push	ecx		; lpCriticalSection
		call	edi ; InitializeCriticalSection
		lea	eax, [esi+48h]
		mov	[esi+4Ch], eax
		mov	[eax], eax
		lea	eax, [esi+50h]
		mov	[esi+54h], eax
		mov	[eax], eax
		lea	eax, [esi+58h]
		mov	[esi+5Ch], eax
		mov	[eax], eax
		lea	eax, [esi+60h]
		mov	[esi+64h], eax
		mov	[eax], eax
		lea	eax, [esi+6Ch]
		mov	[esi+70h], eax
		mov	[eax], eax
		lea	eax, [esi+78h]
		mov	[esi+7Ch], eax
		mov	[eax], eax
		lea	eax, [esi+80h]
		mov	[esi+84h], eax
		mov	[eax], eax
		lea	eax, [esi+88h]
		mov	[esi+8Ch], eax
		mov	[eax], eax
		pop	edi
		mov	dword ptr [esi+90h], 1
		mov	eax, esi
		pop	esi
		retn
sub_10017C80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_10017D10(LPVOID lpTlsValue)
sub_10017D10	proc near		; DATA XREF: sub_10017F60+43o

lpTlsValue	= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebp, [esp+10h+lpTlsValue]
		mov	edi, eax
		mov	[edi+9Ch], ebp
		xor	esi, esi
		mov	[ebp+1Ch], edi
		cmp	dword_1003067C,	esi
		jz	short loc_10017D49
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+0Ch]
		jmp	short loc_10017D55
; ---------------------------------------------------------------------------

loc_10017D49:				; CODE XREF: sub_10017D10+20j
		mov	eax, dword_100329D8
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_10017D55:				; CODE XREF: sub_10017D10+37j
		cmp	eax, esi
		jz	short loc_10017D8C
		cmp	dword_1003067C,	esi
		jz	short loc_10017D79
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+0Ch]
		jmp	short loc_10017D86
; ---------------------------------------------------------------------------

loc_10017D79:				; CODE XREF: sub_10017D10+4Fj
		mov	ecx, dword_100329D8
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10017D86:				; CODE XREF: sub_10017D10+67j
		mov	[eax+94h], esi

loc_10017D8C:				; CODE XREF: sub_10017D10+47j
		test	byte ptr [edi+90h], 80h
		jnz	short loc_10017DC2
		cmp	dword_1003067C,	esi
		jz	short loc_10017DB4
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	[ecx+10h], esi
		jmp	short loc_10017DC2
; ---------------------------------------------------------------------------

loc_10017DB4:				; CODE XREF: sub_10017D10+8Bj
		mov	edx, dwTlsIndex
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10017DC2:				; CODE XREF: sub_10017D10+83j
					; sub_10017D10+A2j
		mov	ebx, ds:LeaveCriticalSection

loc_10017DC8:				; CODE XREF: sub_10017D10+1F1j
					; sub_10017D10+208j
		test	byte ptr [edi+90h], 80h
		jnz	short loc_10017E35
		cmp	dword_1003067C,	0
		jz	short loc_10017DF1
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+10h]
		jmp	short loc_10017DFE
; ---------------------------------------------------------------------------

loc_10017DF1:				; CODE XREF: sub_10017D10+C8j
		mov	ecx, dwTlsIndex
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10017DFE:				; CODE XREF: sub_10017D10+DFj
		cmp	dword_1003067C,	0
		mov	[esp+10h+lpTlsValue], eax
		jz	short loc_10017E26
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	dword ptr [ecx+10h], 1
		jmp	short loc_10017E35
; ---------------------------------------------------------------------------

loc_10017E26:				; CODE XREF: sub_10017D10+F9j
		mov	edx, dwTlsIndex
		push	1		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10017E35:				; CODE XREF: sub_10017D10+BFj
					; sub_10017D10+114j ...
		mov	eax, [ebp+24h]
		mov	esi, ds:EnterCriticalSection
		push	eax		; lpCriticalSection
		call	esi ; EnterCriticalSection
		push	offset dword_10032A74
		call	PR_AtomicIncrement_0
		mov	ecx, [edi+9Ch]
		mov	edx, [ecx+24h]
		add	esp, 4
		cmp	dword ptr [edx+68h], 0
		jz	short loc_10017E67
		mov	eax, [ebp+24h]
		push	eax		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		xor	esi, esi
		jmp	short loc_10017E9D
; ---------------------------------------------------------------------------

loc_10017E67:				; CODE XREF: sub_10017D10+14Bj
		mov	ecx, [ebp+24h]
		push	ecx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		mov	edx, [ebp+24h]
		add	edx, 18h
		push	edx		; lpCriticalSection
		call	esi ; EnterCriticalSection
		mov	ecx, [edi+9Ch]
		mov	eax, [ecx+24h]
		add	eax, 6Ch
		cmp	[eax], eax
		jnz	short loc_10017E8B
		or	esi, 0FFFFFFFFh
		jmp	short loc_10017E94
; ---------------------------------------------------------------------------

loc_10017E8B:				; CODE XREF: sub_10017D10+174j
		mov	eax, [ecx+24h]
		mov	ecx, [eax+6Ch]
		mov	esi, [ecx+18h]

loc_10017E94:				; CODE XREF: sub_10017D10+179j
		mov	edx, [ebp+24h]
		add	edx, 18h
		push	edx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection

loc_10017E9D:				; CODE XREF: sub_10017D10+155j
		push	esi
		call	sub_1001D3C0
		add	esp, 4
		cmp	dword_10032A7C,	0
		jz	short loc_10017EB4
		call	sub_100245B0

loc_10017EB4:				; CODE XREF: sub_10017D10+19Dj
		push	offset dword_10032A74
		call	PR_AtomicDecrement_0
		call	sub_10018940
		push	edi
		mov	dword ptr [edi], 1
		call	sub_10024960
		add	esp, 8
		test	byte ptr [edi+90h], 80h
		jnz	loc_10017E35
		cmp	dword_1003067C,	0
		jz	short loc_10017F06
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [esp+10h+lpTlsValue]
		mov	[edx+10h], eax
		jmp	loc_10017DC8
; ---------------------------------------------------------------------------

loc_10017F06:				; CODE XREF: sub_10017D10+1D6j
		mov	ecx, [esp+10h+lpTlsValue]
		mov	edx, dwTlsIndex
		push	ecx		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue
		jmp	loc_10017DC8
sub_10017D10	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 407. _PR_GetPrimordialCPU

; =============== S U B	R O U T	I N E =======================================


		public _PR_GetPrimordialCPU
_PR_GetPrimordialCPU proc near		; CODE XREF: _PR_CreateThread+472p
					; DATA XREF: .rdata:off_1002C7C8o
		mov	eax, dword_100315A0
		test	eax, eax
		jnz	short locret_10017F53
		cmp	dword_1003067C,	eax
		jz	short loc_10017F47
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+14h]
		retn
; ---------------------------------------------------------------------------

loc_10017F47:				; CODE XREF: _PR_GetPrimordialCPU+Fj
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

locret_10017F53:			; CODE XREF: _PR_GetPrimordialCPU+7j
		retn
_PR_GetPrimordialCPU endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10017F60	proc near		; CODE XREF: sub_10018030+22p
		call	PR_IntervalNow
		mov	[esi+20h], eax
		cmp	dword_1003067C,	0
		jz	short loc_10017F88
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	[edx+14h], esi
		jmp	short loc_10017F95
; ---------------------------------------------------------------------------

loc_10017F88:				; CODE XREF: sub_10017F60+Fj
		mov	eax, dword_100329EC
		push	esi		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_10017F95:				; CODE XREF: sub_10017F60+26j
		push	200h
		push	0
		push	1
		push	0
		push	1
		push	esi
		push	offset sub_10017D10
		push	1
		mov	[edi+9Ch], esi
		call	_PR_CreateThread
		add	esp, 20h
		mov	[esi+1Ch], eax
		test	eax, eax
		jnz	short loc_10017FCC
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10017FCC:				; CODE XREF: sub_10017F60+5Dj
		mov	dword ptr [eax+94h], 0
		mov	[esi+18h], edi
		mov	eax, dwThreadAffinityMask
		test	eax, eax
		jz	short loc_10017FEC
		push	eax		; dwThreadAffinityMask
		push	edi		; int
		call	PR_SetThreadAffinityMask
		add	esp, 8

loc_10017FEC:				; CODE XREF: sub_10017F60+80j
		push	offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, dword_1003159C
		mov	[esi+8], eax
		mov	dword ptr [esi], offset	off_100302C0
		mov	ecx, off_100302C4
		mov	[esi+4], ecx
		mov	edx, off_100302C4
		inc	eax
		mov	[edx], esi
		push	offset CriticalSection ; lpCriticalSection
		mov	dword_1003159C,	eax
		mov	off_100302C4, esi
		call	ds:LeaveCriticalSection
		xor	eax, eax
		retn
sub_10017F60	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_10018030(LPVOID lpTlsValue)
sub_10018030	proc near		; DATA XREF: PR_SetConcurrency+89o
					; sub_100181C0+5Bo

lpTlsValue	= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	edi, eax
		push	edi		; lpTlsValue
		call	sub_100248D0
		mov	esi, [esp+14h+lpTlsValue]
		add	esp, 4
		mov	dword ptr [edi+94h], 1
		call	sub_10017F60
		and	dword ptr [edi+90h], 0FFFFFF7Fh
		cmp	dword_1003067C,	0
		mov	ebp, ds:TlsSetValue
		mov	ebx, TlsIndex
		jz	short loc_10018087
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	[ecx+14h], esi
		jmp	short loc_10018091
; ---------------------------------------------------------------------------

loc_10018087:				; CODE XREF: sub_10018030+44j
		mov	edx, dword_100329EC
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ebp ; TlsSetValue

loc_10018091:				; CODE XREF: sub_10018030+55j
		cmp	dword_1003067C,	0
		jz	short loc_100180AE
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	edx, [esi+18h]
		mov	[ecx+8], edx
		jmp	short loc_100180BB
; ---------------------------------------------------------------------------

loc_100180AE:				; CODE XREF: sub_10018030+68j
		mov	eax, [esi+18h]
		mov	ecx, dword_100329F0
		push	eax		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ebp ; TlsSetValue

loc_100180BB:				; CODE XREF: sub_10018030+7Cj
		mov	[edi+9Ch], esi
		mov	esi, ds:TlsGetValue

loc_100180C7:				; CODE XREF: sub_10018030+D7j
					; sub_10018030+EDj
		test	byte ptr [edi+90h], 80h
		jnz	short loc_10018114
		cmp	dword_1003067C,	0
		jnz	short loc_100180EB
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	esi ; TlsGetValue
		cmp	dword_1003067C,	0
		jz	short loc_10018109

loc_100180EB:				; CODE XREF: sub_10018030+A7j
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		push	edi
		mov	dword ptr [ecx+10h], 1
		call	sub_10024960
		add	esp, 4
		jmp	short loc_100180C7
; ---------------------------------------------------------------------------

loc_10018109:				; CODE XREF: sub_10018030+B9j
		mov	edx, dwTlsIndex
		push	1		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ebp ; TlsSetValue

loc_10018114:				; CODE XREF: sub_10018030+9Ej
		push	edi
		call	sub_10024960
		add	esp, 4
		jmp	short loc_100180C7
sub_10018030	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 320. PR_SetConcurrency

; =============== S U B	R O U T	I N E =======================================


		public PR_SetConcurrency
PR_SetConcurrency proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		cmp	dword_10031520,	0
		jnz	short loc_1001812E
		call	PR_Init

loc_1001812E:				; CODE XREF: PR_SetConcurrency+7j
		cmp	dword_10031524,	0
		jnz	locret_100181BD
		push	edi
		push	offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, dword_10032A78
		mov	eax, [esp+4+arg_0]
		cmp	ecx, eax
		jnb	short loc_10018160
		mov	edi, eax
		sub	edi, ecx
		mov	dword_10032A78,	eax
		jmp	short loc_10018162
; ---------------------------------------------------------------------------

loc_10018160:				; CODE XREF: PR_SetConcurrency+33j
		xor	edi, edi

loc_10018162:				; CODE XREF: PR_SetConcurrency+3Ej
		push	offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	edi, edi
		jz	short loc_100181BC
		push	esi

loc_10018172:				; CODE XREF: PR_SetConcurrency+99j
		push	2Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1001819B
		call	sub_10017C80
		mov	[esi+24h], eax
		test	eax, eax
		jnz	short loc_1001819B
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	esi, esi

loc_1001819B:				; CODE XREF: PR_SetConcurrency+62j
					; PR_SetConcurrency+6Ej
		push	200h
		push	0
		push	1
		push	1
		push	1
		push	esi
		push	offset sub_10018030
		push	1
		call	_PR_CreateThread
		add	esp, 20h
		dec	edi
		jnz	short loc_10018172
		pop	esi

loc_100181BC:				; CODE XREF: PR_SetConcurrency+4Fj
		pop	edi

locret_100181BD:			; CODE XREF: PR_SetConcurrency+15j
		retn
PR_SetConcurrency endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100181C0	proc near		; CODE XREF: PR_Init_0+108p
		call	PR_AssertCurrentThreadOwnsLock_0
		cmp	dword_10031524,	0
		jnz	short locret_1001823B
		push	esi
		push	offset CriticalSection ; lpCriticalSection
		mov	dword_1003159C,	0
		call	ds:InitializeCriticalSection
		push	2Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1001820D
		call	sub_10017C80
		mov	[esi+24h], eax
		test	eax, eax
		jnz	short loc_1001820D
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	esi, esi

loc_1001820D:				; CODE XREF: sub_100181C0+34j
					; sub_100181C0+40j
		push	200h
		push	0
		push	1
		push	1
		push	1
		push	esi
		push	offset sub_10018030
		push	1
		mov	dword_100315A0,	esi
		mov	dword_10032A78,	1
		call	_PR_CreateThread
		add	esp, 20h
		pop	esi

locret_1001823B:			; CODE XREF: sub_100181C0+Cj
		retn
sub_100181C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018240	proc near		; CODE XREF: sub_100187B0+B9p
					; PR_NotifyAllCondVar+C6p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		mov	ebp, ds:EnterCriticalSection
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		lea	edi, [esi+40h]
		push	edi		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	eax, [esi+90h]
		xor	ebx, ebx
		test	al, al
		js	loc_10018348
		cmp	[esi+88h], ebx
		jz	loc_10018381
		mov	eax, [esi+9Ch]
		mov	[esi+88h], ebx
		mov	ecx, [eax+24h]
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		push	1
		push	esi
		mov	[esi+58h], ebx
		call	_PR_DelSleepQ
		mov	edx, [esi+9Ch]
		mov	eax, [edx+24h]
		mov	ebx, ds:LeaveCriticalSection
		add	esp, 8
		add	eax, 18h
		push	eax		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		test	byte ptr [esi+90h], 40h
		jz	short loc_10018321
		mov	ecx, [esi+9Ch]
		mov	dword ptr [esi], 7
		mov	edx, [ecx+24h]
		add	edx, 30h
		push	edx		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	eax, [esi+9Ch]
		mov	dword ptr [esi+58h], 8
		mov	edx, [eax+24h]
		sub	edx, 0FFFFFF80h
		mov	[esi+68h], edx
		mov	edx, [eax+24h]
		mov	edx, [edx+84h]
		lea	ecx, [esi+68h]
		mov	[esi+6Ch], edx
		mov	eax, [eax+24h]
		mov	edx, [eax+84h]
		mov	[edx], ecx
		mov	eax, [esi+9Ch]
		mov	edx, [eax+24h]
		mov	[edx+84h], ecx
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 30h
		push	ecx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		push	edi		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10018321:				; CODE XREF: sub_10018240+6Fj
		push	edi		; lpCriticalSection
		mov	dword ptr [esi], 1
		call	ebx ; LeaveCriticalSection
		mov	edx, [esp+10h+arg_4]
		push	esi
		push	edx
		call	sub_1001BCA0
		push	esi
		call	sub_1001DF20
		add	esp, 0Ch
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10018348:				; CODE XREF: sub_10018240+1Ej
		cmp	[esi+88h], ebx
		jz	short loc_10018381
		and	al, 40h
		movzx	eax, al
		neg	eax
		sbb	eax, eax
		and	eax, 5
		add	eax, 2
		push	edi		; lpCriticalSection
		mov	[esi+88h], ebx
		mov	[esi], eax
		call	ds:LeaveCriticalSection
		push	esi
		call	sub_1001DF20
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, 1
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10018381:				; CODE XREF: sub_10018240+2Aj
					; sub_10018240+10Ej
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
sub_10018240	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10018390(LPCRITICAL_SECTION lpCriticalSection)
sub_10018390	proc near		; CODE XREF: PR_Interrupt+C5p

var_4		= dword	ptr -4
lpCriticalSection= dword ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, [esp+14h+lpCriticalSection]
		mov	ebp, [esi+88h]
		mov	ebx, ds:LeaveCriticalSection
		lea	edi, [esi+40h]
		push	edi		; lpCriticalSection
		mov	[esp+18h+var_4], eax
		mov	dword ptr [esi+88h], 0
		call	ebx ; LeaveCriticalSection
		lea	eax, [ebp+0Ch]
		mov	ebp, ds:EnterCriticalSection
		push	eax		; lpCriticalSection
		mov	[esp+18h+lpCriticalSection], eax
		call	ebp ; EnterCriticalSection
		push	edi		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	eax, [esi+90h]
		test	al, al
		js	short loc_10018421
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		push	1
		push	esi
		mov	dword ptr [esi+58h], 0
		call	_PR_DelSleepQ
		mov	edx, [esi+9Ch]
		mov	eax, [edx+24h]
		add	esp, 8
		add	eax, 18h
		push	eax		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		mov	ecx, [esp+14h+var_4]
		push	esi
		push	ecx
		mov	dword ptr [esi], 1
		call	sub_1001BCA0
		add	esp, 8
		jmp	short loc_10018432
; ---------------------------------------------------------------------------

loc_10018421:				; CODE XREF: sub_10018390+49j
		and	al, 40h
		movzx	edx, al
		neg	edx
		sbb	edx, edx
		and	edx, 5
		add	edx, 2
		mov	[esi], edx

loc_10018432:				; CODE XREF: sub_10018390+8Fj
		push	edi		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		push	esi
		call	sub_1001DF20
		mov	eax, [esp+18h+lpCriticalSection]
		add	esp, 4
		push	eax		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_10018390	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10018450(LPVOID lpTlsValue, int, int,	int)
sub_10018450	proc near		; CODE XREF: PR_WaitCondVar+1Dp
					; PRP_NakedWait+15p

lpTlsValue	= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+lpTlsValue]
		test	byte ptr [esi+90h], 80h
		push	edi
		jnz	short loc_100184C5
		cmp	dword_1003067C,	0
		jz	short loc_10018481
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+10h]
		jmp	short loc_1001848E
; ---------------------------------------------------------------------------

loc_10018481:				; CODE XREF: sub_10018450+18j
		mov	ecx, dwTlsIndex
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001848E:				; CODE XREF: sub_10018450+2Fj
		cmp	dword_1003067C,	0
		mov	[esp+10h+lpTlsValue], eax
		jz	short loc_100184B6
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	dword ptr [ecx+10h], 1
		jmp	short loc_100184C5
; ---------------------------------------------------------------------------

loc_100184B6:				; CODE XREF: sub_10018450+49j
		mov	edx, dwTlsIndex
		push	1		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_100184C5:				; CODE XREF: sub_10018450+Fj
					; sub_10018450+64j
		mov	ebp, [esp+10h+arg_4]
		lea	ebx, [ebp+0Ch]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		lea	edi, [esi+40h]
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esi+90h]
		test	eax, 1000h
		jnz	loc_100185D1
		test	al, 2
		jz	loc_100185D1
		push	0
		push	0FFFFE897h
		call	PR_SetError
		and	dword ptr [esi+90h], 0FFFFFFFDh
		add	esp, 8
		push	ebx		; lpCriticalSection
		mov	ebx, ds:LeaveCriticalSection
		call	ebx ; LeaveCriticalSection
		push	edi		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		test	byte ptr [esi+90h], 80h
		jnz	loc_100185C9
		mov	esi, [esp+10h+lpTlsValue]
		test	esi, esi
		jnz	short loc_10018595
		cmp	dword_1003067C,	esi
		jz	short loc_1001854C
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+14h]
		jmp	short loc_10018558
; ---------------------------------------------------------------------------

loc_1001854C:				; CODE XREF: sub_10018450+E3j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_10018558:				; CODE XREF: sub_10018450+FAj
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10018595
		cmp	dword_1003067C,	0
		jz	short loc_1001857F
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+14h]
		jmp	short loc_1001858C
; ---------------------------------------------------------------------------

loc_1001857F:				; CODE XREF: sub_10018450+115j
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001858C:				; CODE XREF: sub_10018450+12Dj
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10018595:				; CODE XREF: sub_10018450+DBj
					; sub_10018450+10Cj
		cmp	dword_1003067C,	0
		jz	short loc_100185BB
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		pop	edi
		mov	[ecx+10h], esi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100185BB:				; CODE XREF: sub_10018450+14Cj
		mov	edx, dwTlsIndex
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_100185C9:				; CODE XREF: sub_10018450+CFj
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100185D1:				; CODE XREF: sub_10018450+98j
					; sub_10018450+A0j
		lea	edi, [esi+70h]
		mov	dword ptr [esi], 4
		mov	[esi+88h], ebp
		lea	eax, [ebp+4]
		mov	[edi], eax
		mov	ecx, [ebp+8]
		mov	[esi+74h], ecx
		mov	edx, [ebp+8]
		mov	[edx], edi
		mov	[ebp+8], edi
		test	byte ptr [esi+90h], 80h
		jnz	short loc_10018637
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [esp+10h+arg_C]
		push	edx
		push	esi
		mov	dword ptr [esi+58h], 2
		call	_PR_AddSleepQ
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		add	esp, 8
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_10018637:				; CODE XREF: sub_10018450+1AAj
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		lea	eax, [esi+40h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	edx, [esp+10h+arg_8]
		push	edx		; lpTlsValue
		call	PR_Unlock
		mov	eax, dword_10032B00
		add	esp, 4
		cmp	dword ptr [eax+4], 4
		jl	short loc_10018673
		mov	ecx, [esp+10h+arg_C]
		push	ecx
		push	ebp
		push	offset aPr_waitCvarPWa ; "PR_Wait: cvar=%p waiting for %d"
		call	PR_LogPrint
		add	esp, 0Ch

loc_10018673:				; CODE XREF: sub_10018450+20Ej
		mov	edx, [esp+10h+arg_C]
		push	edx
		push	esi
		call	sub_1001DB80
		add	esp, 8
		push	ebx		; lpCriticalSection
		mov	[esp+14h+arg_4], eax
		call	ds:EnterCriticalSection
		mov	eax, [esi+74h]
		mov	ecx, [edi]
		mov	[eax], ecx
		mov	edx, [edi]
		mov	eax, [esi+74h]
		push	ebx		; lpCriticalSection
		mov	[edx+4], eax
		call	ds:LeaveCriticalSection
		mov	ecx, dword_10032B00
		cmp	dword ptr [ecx+4], 4
		jl	short loc_100186BC
		push	ebp
		push	offset aPr_waitCvarPDo ; "PR_Wait: cvar=%p done	waiting"
		call	PR_LogPrint
		add	esp, 8

loc_100186BC:				; CODE XREF: sub_10018450+25Cj
		test	byte ptr [esi+90h], 80h
		jnz	loc_10018767
		mov	edi, [esp+10h+lpTlsValue]
		test	edi, edi
		jnz	short loc_10018738
		cmp	dword_1003067C,	edi
		jz	short loc_100186F0
		mov	eax, large fs:2Ch
		mov	edx, TlsIndex
		mov	ecx, [eax+edx*4]
		mov	eax, [ecx+14h]
		jmp	short loc_100186FD
; ---------------------------------------------------------------------------

loc_100186F0:				; CODE XREF: sub_10018450+287j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_100186FD:				; CODE XREF: sub_10018450+29Ej
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10018738
		cmp	dword_1003067C,	0
		jz	short loc_10018723
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_1001872F
; ---------------------------------------------------------------------------

loc_10018723:				; CODE XREF: sub_10018450+2BAj
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001872F:				; CODE XREF: sub_10018450+2D1j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10018738:				; CODE XREF: sub_10018450+27Fj
					; sub_10018450+2B1j
		cmp	dword_1003067C,	0
		jz	short loc_10018759
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	[eax+10h], edi
		jmp	short loc_10018767
; ---------------------------------------------------------------------------

loc_10018759:				; CODE XREF: sub_10018450+2EFj
		mov	ecx, dwTlsIndex
		push	edi		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10018767:				; CODE XREF: sub_10018450+273j
					; sub_10018450+307j
		mov	edx, [esp+10h+arg_8]
		push	edx
		call	PR_Lock
		mov	eax, [esi+90h]
		add	esp, 4
		test	eax, 1000h
		jnz	short loc_100187A3
		test	al, 2
		jz	short loc_100187A3
		push	0
		push	0FFFFE897h
		call	PR_SetError
		and	dword ptr [esi+90h], 0FFFFFFFDh
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100187A3:				; CODE XREF: sub_10018450+32Fj
					; sub_10018450+333j
		mov	eax, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10018450	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100187B0	proc near		; CODE XREF: PR_NotifyCondVar+16p
					; PRP_NakedNotify+Bp

lpTlsValue	= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		mov	eax, [esp+4+arg_4]
		test	byte ptr [eax+90h], 80h
		jnz	short loc_10018824
		cmp	dword_1003067C,	0
		jz	short loc_100187E2
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		mov	ecx, [eax+10h]
		mov	[esp+4+lpTlsValue], ecx
		jmp	short loc_100187F2
; ---------------------------------------------------------------------------

loc_100187E2:				; CODE XREF: sub_100187B0+15j
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+4+lpTlsValue], eax

loc_100187F2:				; CODE XREF: sub_100187B0+30j
		cmp	dword_1003067C,	0
		jz	short loc_10018816
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	dword ptr [edx+10h], 1
		jmp	short loc_10018824
; ---------------------------------------------------------------------------

loc_10018816:				; CODE XREF: sub_100187B0+49j
		mov	eax, dwTlsIndex
		push	1		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_10018824:				; CODE XREF: sub_100187B0+Cj
					; sub_100187B0+64j
		push	ebx
		push	ebp
		mov	ebp, [esp+0Ch+arg_0]
		push	esi
		push	edi
		lea	ebx, [ebp+0Ch]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	esi, [ebp+4]
		lea	edi, [ebp+4]
		cmp	esi, edi
		jz	short loc_1001887C

loc_10018840:				; CODE XREF: sub_100187B0+CAj
		mov	ecx, dword_10032B00
		cmp	dword ptr [ecx+4], 4
		jl	short loc_1001885A
		push	ebp
		push	offset a_pr_notifycond ; "_PR_NotifyCondVar: cvar=%p"
		call	PR_LogPrint
		add	esp, 8

loc_1001885A:				; CODE XREF: sub_100187B0+9Aj
		cmp	dword ptr [esi+18h], 0
		jz	short loc_10018876
		mov	edx, [esp+14h+arg_4]
		push	edx
		lea	eax, [esi-70h]
		push	eax
		call	sub_10018240
		add	esp, 8
		cmp	eax, 1
		jz	short loc_1001887C

loc_10018876:				; CODE XREF: sub_100187B0+AEj
		mov	esi, [esi]
		cmp	esi, edi
		jnz	short loc_10018840

loc_1001887C:				; CODE XREF: sub_100187B0+8Ej
					; sub_100187B0+C4j
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [esp+14h+arg_4]
		test	byte ptr [ecx+90h], 80h
		jnz	loc_10018936
		mov	esi, [esp+14h+lpTlsValue]
		test	esi, esi
		jnz	short loc_10018903
		cmp	dword_1003067C,	esi
		jz	short loc_100188BB
		mov	eax, large fs:2Ch
		mov	edx, TlsIndex
		mov	ecx, [eax+edx*4]
		mov	eax, [ecx+14h]
		jmp	short loc_100188C8
; ---------------------------------------------------------------------------

loc_100188BB:				; CODE XREF: sub_100187B0+F2j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_100188C8:				; CODE XREF: sub_100187B0+109j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10018903
		cmp	dword_1003067C,	0
		jz	short loc_100188EE
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_100188FA
; ---------------------------------------------------------------------------

loc_100188EE:				; CODE XREF: sub_100187B0+125j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_100188FA:				; CODE XREF: sub_100187B0+13Cj
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10018903:				; CODE XREF: sub_100187B0+EAj
					; sub_100187B0+11Cj
		cmp	dword_1003067C,	0
		jz	short loc_10018928
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		pop	edi
		mov	[eax+10h], esi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10018928:				; CODE XREF: sub_100187B0+15Aj
		mov	ecx, dwTlsIndex
		push	esi		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10018936:				; CODE XREF: sub_100187B0+DEj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_100187B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018940	proc near		; CODE XREF: sub_10017D10+1AEp

var_C		= dword	ptr -0Ch
lpCriticalSection= dword ptr -8
var_4		= dword	ptr -4

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	edi, [eax+9Ch]
		mov	[esp+1Ch+var_4], eax
		call	PR_IntervalNow
		mov	ecx, eax
		sub	ecx, [edi+20h]
		mov	[edi+20h], eax
		mov	eax, dword_10032AFC
		cmp	dword ptr [eax+4], 4
		mov	[esp+1Ch+var_C], ecx
		jl	short loc_10018980
		push	ecx
		push	offset aExpirewaitsEla ; "ExpireWaits: elapsed=%lld usec"
		call	PR_LogPrint
		add	esp, 8

loc_10018980:				; CODE XREF: sub_10018940+30j
		mov	ebx, ds:LeaveCriticalSection
		jmp	short loc_10018990
; ---------------------------------------------------------------------------
		align 10h

loc_10018990:				; CODE XREF: sub_10018940+46j
					; sub_10018940+A2j ...
		mov	ecx, [edi+24h]
		mov	ebp, ds:EnterCriticalSection
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	ecx, [edi+24h]
		mov	esi, [ecx+6Ch]
		lea	eax, [ecx+6Ch]
		cmp	esi, eax
		jz	loc_10018BCC
		mov	eax, [esp+1Ch+var_C]
		add	esi, 0FFFFFF98h
		cmp	eax, [esi+80h]
		jb	loc_10018BDA
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		lea	eax, [esi+40h]
		push	eax		; lpCriticalSection
		mov	[esp+20h+lpCriticalSection], eax
		call	ebp ; EnterCriticalSection
		cmp	[esi+9Ch], edi
		jz	short loc_100189E4
		mov	edx, [esp+1Ch+lpCriticalSection]
		push	edx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		jmp	short loc_10018990
; ---------------------------------------------------------------------------

loc_100189E4:				; CODE XREF: sub_10018940+99j
		mov	eax, [edi+24h]
		add	eax, 18h
		push	eax		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		test	byte ptr [esi+90h], 10h
		jz	loc_10018BB8
		push	0
		push	esi
		mov	dword ptr [esi+58h], 0
		call	_PR_DelSleepQ
		mov	edx, [edi+24h]
		mov	ecx, [esi+80h]
		sub	[esp+24h+var_C], ecx
		add	esp, 8
		add	edx, 18h
		push	edx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		test	byte ptr [esi+90h], 40h
		jz	short loc_10018A87
		mov	dword ptr [esi+88h], 0
		mov	eax, [edi+24h]
		add	eax, 30h
		push	eax		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	dword ptr [esi], 7
		mov	dword ptr [esi+58h], 8
		mov	ecx, [edi+24h]
		lea	eax, [esi+68h]
		sub	ecx, 0FFFFFF80h
		mov	[eax], ecx
		mov	edx, [edi+24h]
		mov	ecx, [edx+84h]
		mov	[esi+6Ch], ecx
		mov	edx, [edi+24h]
		mov	ecx, [edx+84h]
		mov	[ecx], eax
		mov	edx, [edi+24h]
		mov	[edx+84h], eax
		mov	eax, [edi+24h]
		add	eax, 30h
		push	eax		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		add	esi, 40h
		push	esi		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		jmp	loc_10018990
; ---------------------------------------------------------------------------

loc_10018A87:				; CODE XREF: sub_10018940+E6j
		cmp	dword ptr [esi+88h], 0
		jz	loc_10018B42
		mov	ebp, [esi+4]
		mov	dword ptr [esi], 1
		mov	ecx, [edi+24h]
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [edi+24h]
		lea	ecx, [edx+ebp*8+48h]
		mov	[esi+68h], ecx
		mov	edx, [edi+24h]
		mov	ecx, [edx+ebp*8+4Ch]
		lea	eax, [esi+68h]
		mov	[esi+6Ch], ecx
		mov	edx, [edi+24h]
		mov	ecx, [edx+ebp*8+4Ch]
		mov	[ecx], eax
		mov	edx, [edi+24h]
		mov	[edx+ebp*8+4Ch], eax
		mov	eax, [edi+24h]
		mov	ecx, ebp
		mov	edx, 1
		shl	edx, cl
		or	[eax+68h], edx
		mov	dword ptr [esi+58h], 1
		mov	eax, [edi+24h]
		push	eax		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		mov	ecx, [esp+1Ch+var_4]
		cmp	ebp, [ecx+4]
		jle	short loc_10018B24
		cmp	dword_1003067C,	0
		jz	short loc_10018B13
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_10018B20
; ---------------------------------------------------------------------------

loc_10018B13:				; CODE XREF: sub_10018940+1BAj
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10018B20:				; CODE XREF: sub_10018940+1D1j
		mov	byte ptr [eax+0Fh], 1

loc_10018B24:				; CODE XREF: sub_10018940+1B1j
		push	esi
		mov	dword ptr [esi+88h], 0
		call	sub_1001DF20
		add	esp, 4
		add	esi, 40h
		push	esi		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		jmp	loc_10018990
; ---------------------------------------------------------------------------

loc_10018B42:				; CODE XREF: sub_10018940+14Ej
		mov	eax, 1
		cmp	[esi+0A4h], eax
		jnz	short loc_10018BAD
		mov	ebp, [esi+4]
		mov	[esi+0ACh], eax
		mov	[esi+128h], edi
		mov	[esi], eax
		mov	eax, [edi+24h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [edi+24h]
		lea	edx, [ecx+ebp*8+48h]
		mov	[esi+68h], edx
		mov	ecx, [edi+24h]
		mov	edx, [ecx+ebp*8+4Ch]
		lea	eax, [esi+68h]
		mov	[esi+6Ch], edx
		mov	ecx, [edi+24h]
		mov	edx, [ecx+ebp*8+4Ch]
		mov	[edx], eax
		mov	ecx, [edi+24h]
		mov	[ecx+ebp*8+4Ch], eax
		mov	eax, [edi+24h]
		mov	ecx, ebp
		mov	edx, 1
		shl	edx, cl
		or	[eax+68h], edx
		mov	dword ptr [esi+58h], 1
		mov	eax, [edi+24h]
		push	eax		; lpCriticalSection
		call	ebx ; LeaveCriticalSection

loc_10018BAD:				; CODE XREF: sub_10018940+20Dj
		add	esi, 40h
		push	esi		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		jmp	loc_10018990
; ---------------------------------------------------------------------------

loc_10018BB8:				; CODE XREF: sub_10018940+B4j
		mov	ecx, [edi+24h]
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		add	esi, 40h
		push	esi		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		jmp	loc_10018990
; ---------------------------------------------------------------------------

loc_10018BCC:				; CODE XREF: sub_10018940+6Aj
		lea	edx, [ecx+18h]
		push	edx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10018BDA:				; CODE XREF: sub_10018940+7Dj
		sub	[esi+80h], eax
		mov	ecx, [esi+9Ch]
		mov	ecx, [ecx+24h]
		sub	[ecx+74h], eax
		mov	edx, [edi+24h]
		add	edx, 18h
		push	edx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_10018940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018C00	proc near		; CODE XREF: PR_NewMonitor+50p
					; PR_NewMonitor+61p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		lea	eax, [esi+0Ch]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		mov	ecx, [esp+4+arg_4]
		lea	eax, [esi+4]
		mov	[esi+8], eax
		mov	[esi], ecx
		mov	[eax], eax
		xor	eax, eax
		pop	esi
		retn
sub_10018C00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10018C30	proc near		; CODE XREF: PR_NewMonitor+6Ep
					; PR_DestroyMonitor+9p	...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		add	eax, 0Ch
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		retn
sub_10018C30	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 372. PR_WaitCondVar

; =============== S U B	R O U T	I N E =======================================


		public PR_WaitCondVar
PR_WaitCondVar	proc near		; CODE XREF: .text:10001455p
					; .text:100014CAp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		call	PR_AssertCurrentThreadOwnsLock_0
		mov	edx, [esp+arg_0]
		mov	ecx, [edx]
		cmp	[ecx+8], eax
		jz	short loc_10018C54
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10018C54:				; CODE XREF: PR_WaitCondVar+Ej
		push	esi
		mov	esi, [esp+4+arg_4]
		push	esi		; int
		push	ecx		; int
		push	edx		; int
		push	eax		; lpTlsValue
		call	sub_10018450
		add	esp, 10h
		pop	esi
		retn
PR_WaitCondVar	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 268. PR_NotifyCondVar

; =============== S U B	R O U T	I N E =======================================


		public PR_NotifyCondVar
PR_NotifyCondVar proc near		; CODE XREF: sub_100014E0+88p
					; PR_AddWaitFileDesc+D5p ...

arg_0		= dword	ptr  4

		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [esp+arg_0]
		mov	edx, [ecx]
		cmp	[edx+8], eax
		jz	short loc_10018C84
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_10018C84:				; CODE XREF: PR_NotifyCondVar+Ej
		push	eax
		push	ecx
		call	sub_100187B0
		add	esp, 8
		xor	eax, eax
		retn
PR_NotifyCondVar endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 267. PR_NotifyAllCondVar

; =============== S U B	R O U T	I N E =======================================


		public PR_NotifyAllCondVar
PR_NotifyAllCondVar proc near		; CODE XREF: .text:100014B7p
					; PR_CancelWaitGroup+6Fp ...

lpTlsValue	= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebp
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	edi, [esp+0Ch+arg_0]
		mov	ebp, eax
		mov	eax, [edi]
		cmp	[eax+8], ebp
		jz	short loc_10018CBC
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10018CBC:				; CODE XREF: PR_NotifyAllCondVar+13j
		test	byte ptr [ebp+90h], 80h
		jnz	short loc_10018D2D
		cmp	dword_1003067C,	0
		jz	short loc_10018CEA
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		mov	ecx, [eax+10h]
		mov	[esp+0Ch+lpTlsValue], ecx
		jmp	short loc_10018CFB
; ---------------------------------------------------------------------------

loc_10018CEA:				; CODE XREF: PR_NotifyAllCondVar+2Cj
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+0Ch+lpTlsValue], eax

loc_10018CFB:				; CODE XREF: PR_NotifyAllCondVar+48j
		cmp	dword_1003067C,	0
		jz	short loc_10018D1F
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	dword ptr [edx+10h], 1
		jmp	short loc_10018D2D
; ---------------------------------------------------------------------------

loc_10018D1F:				; CODE XREF: PR_NotifyAllCondVar+62j
		mov	eax, dwTlsIndex
		push	1		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_10018D2D:				; CODE XREF: PR_NotifyAllCondVar+23j
					; PR_NotifyAllCondVar+7Dj
		push	ebx
		push	esi
		lea	ebx, [edi+0Ch]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	esi, [edi+4]
		add	edi, 4
		cmp	esi, edi
		jz	short loc_10018D74

loc_10018D43:				; CODE XREF: PR_NotifyAllCondVar+D2j
		mov	ecx, dword_10032B00
		cmp	dword ptr [ecx+4], 4
		jl	short loc_10018D61
		mov	edx, [esp+14h+arg_0]
		push	edx
		push	offset aPr_notifyallCv ; "PR_NotifyAll:	cvar=%p"
		call	PR_LogPrint
		add	esp, 8

loc_10018D61:				; CODE XREF: PR_NotifyAllCondVar+ADj
		lea	eax, [esi-70h]
		push	ebp
		push	eax
		call	sub_10018240
		mov	esi, [esi]
		add	esp, 8
		cmp	esi, edi
		jnz	short loc_10018D43

loc_10018D74:				; CODE XREF: PR_NotifyAllCondVar+A1j
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	byte ptr [ebp+90h], 80h
		jnz	loc_10018E2C
		mov	esi, [esp+14h+lpTlsValue]
		test	esi, esi
		jnz	short loc_10018DF9
		cmp	dword_1003067C,	esi
		jz	short loc_10018DB0
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		mov	eax, [eax+14h]
		jmp	short loc_10018DBD
; ---------------------------------------------------------------------------

loc_10018DB0:				; CODE XREF: PR_NotifyAllCondVar+F6j
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10018DBD:				; CODE XREF: PR_NotifyAllCondVar+10Ej
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10018DF9
		cmp	dword_1003067C,	0
		jz	short loc_10018DE3
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_10018DF0
; ---------------------------------------------------------------------------

loc_10018DE3:				; CODE XREF: PR_NotifyAllCondVar+12Aj
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10018DF0:				; CODE XREF: PR_NotifyAllCondVar+141j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10018DF9:				; CODE XREF: PR_NotifyAllCondVar+EEj
					; PR_NotifyAllCondVar+121j
		cmp	dword_1003067C,	0
		jz	short loc_10018E1F
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	[edx+10h], esi
		pop	esi
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10018E1F:				; CODE XREF: PR_NotifyAllCondVar+160j
		mov	eax, dwTlsIndex
		push	esi		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_10018E2C:				; CODE XREF: PR_NotifyAllCondVar+E2j
		pop	esi
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	ebp
		pop	ecx
		retn
PR_NotifyAllCondVar endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  10. PRP_NewNakedCondVar

; =============== S U B	R O U T	I N E =======================================


		public PRP_NewNakedCondVar
PRP_NewNakedCondVar proc near		; DATA XREF: .rdata:off_1002C7C8o
		push	esi
		push	28h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_10018E6D
		lea	eax, [esi+0Ch]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		lea	eax, [esi+4]
		mov	[eax], eax
		mov	[esi+8], eax
		mov	dword ptr [esi], 0DCE1DCE1h
		mov	eax, esi

loc_10018E6D:				; CODE XREF: PRP_NewNakedCondVar+11j
		pop	esi
		retn
PRP_NewNakedCondVar endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   9. PRP_NakedWait

; =============== S U B	R O U T	I N E =======================================


		public PRP_NakedWait
PRP_NakedWait	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [esp+arg_8]
		mov	edx, [esp+arg_4]
		push	ecx		; int
		mov	ecx, [esp+4+arg_0]
		push	edx		; int
		push	ecx		; int
		push	eax		; lpTlsValue
		call	sub_10018450
		add	esp, 10h
		retn
PRP_NakedWait	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   8. PRP_NakedNotify

; =============== S U B	R O U T	I N E =======================================


		public PRP_NakedNotify
PRP_NakedNotify	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		call	PR_AssertCurrentThreadOwnsLock_0
		push	eax
		mov	eax, [esp+4+arg_0]
		push	eax
		call	sub_100187B0
		add	esp, 8
		xor	eax, eax
		retn
PRP_NakedNotify	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   7. PRP_NakedBroadcast

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PRP_NakedBroadcast(LPCRITICAL_SECTION lpCriticalSection)
		public PRP_NakedBroadcast
PRP_NakedBroadcast proc	near		; DATA XREF: .rdata:off_1002C7C8o

lpTlsValue	= dword	ptr -4
lpCriticalSection= dword ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebp, eax
		test	byte ptr [ebp+90h], 80h
		jnz	short loc_10018F29
		cmp	dword_1003067C,	0
		jz	short loc_10018EE5
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+10h]
		jmp	short loc_10018EF2
; ---------------------------------------------------------------------------

loc_10018EE5:				; CODE XREF: PRP_NakedBroadcast+1Cj
		mov	ecx, dwTlsIndex
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10018EF2:				; CODE XREF: PRP_NakedBroadcast+33j
		cmp	dword_1003067C,	0
		mov	[esp+14h+lpTlsValue], eax
		jz	short loc_10018F1A
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	dword ptr [ecx+10h], 1
		jmp	short loc_10018F29
; ---------------------------------------------------------------------------

loc_10018F1A:				; CODE XREF: PRP_NakedBroadcast+4Dj
		mov	edx, dwTlsIndex
		push	1		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_10018F29:				; CODE XREF: PRP_NakedBroadcast+13j
					; PRP_NakedBroadcast+68j
		mov	ebx, [esp+14h+lpCriticalSection]
		lea	eax, [ebx+0Ch]
		push	eax		; lpCriticalSection
		mov	[esp+18h+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		mov	esi, [ebx+4]
		lea	edi, [ebx+4]
		cmp	esi, edi
		jz	short loc_10018F71

loc_10018F45:				; CODE XREF: PRP_NakedBroadcast+BFj
		mov	eax, dword_10032B00
		cmp	dword ptr [eax+4], 4
		jl	short loc_10018F5E
		push	ebx
		push	offset aPr_notifyallCv ; "PR_NotifyAll:	cvar=%p"
		call	PR_LogPrint
		add	esp, 8

loc_10018F5E:				; CODE XREF: PRP_NakedBroadcast+9Ej
		lea	ecx, [esi-70h]
		push	ebp
		push	ecx
		call	sub_10018240
		mov	esi, [esi]
		add	esp, 8
		cmp	esi, edi
		jnz	short loc_10018F45

loc_10018F71:				; CODE XREF: PRP_NakedBroadcast+93j
		mov	edx, [esp+14h+lpCriticalSection]
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	byte ptr [ebp+90h], 80h
		jnz	loc_1001902D
		mov	esi, [esp+14h+lpTlsValue]
		test	esi, esi
		jnz	short loc_10018FF9
		cmp	dword_1003067C,	esi
		jz	short loc_10018FB0
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+14h]
		jmp	short loc_10018FBC
; ---------------------------------------------------------------------------

loc_10018FB0:				; CODE XREF: PRP_NakedBroadcast+E7j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_10018FBC:				; CODE XREF: PRP_NakedBroadcast+FEj
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10018FF9
		cmp	dword_1003067C,	0
		jz	short loc_10018FE3
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+14h]
		jmp	short loc_10018FF0
; ---------------------------------------------------------------------------

loc_10018FE3:				; CODE XREF: PRP_NakedBroadcast+119j
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10018FF0:				; CODE XREF: PRP_NakedBroadcast+131j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10018FF9:				; CODE XREF: PRP_NakedBroadcast+DFj
					; PRP_NakedBroadcast+110j
		cmp	dword_1003067C,	0
		jz	short loc_1001901F
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		pop	edi
		mov	[ecx+10h], esi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001901F:				; CODE XREF: PRP_NakedBroadcast+150j
		mov	edx, dwTlsIndex
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001902D:				; CODE XREF: PRP_NakedBroadcast+D3j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
PRP_NakedBroadcast endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 251. PR_NewCondVar

; =============== S U B	R O U T	I N E =======================================


		public PR_NewCondVar
PR_NewCondVar	proc near		; CODE XREF: sub_100015F0+Fp
					; sub_100015F0+26p ...

arg_0		= dword	ptr  4

		push	esi
		push	28h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1001906F
		lea	eax, [esi+0Ch]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		mov	ecx, [esp+4+arg_0]
		lea	eax, [esi+4]
		mov	[esi+8], eax
		mov	[eax], eax
		mov	[esi], ecx
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001906F:				; CODE XREF: PR_NewCondVar+11j
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		mov	eax, esi
		pop	esi
		retn
PR_NewCondVar	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   6. PRP_DestroyNakedCondVar
; Exported entry  81. PR_DestroyCondVar

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyCondVar(void *Memory)
		public PR_DestroyCondVar
PR_DestroyCondVar proc near		; CODE XREF: sub_100015F0+72p
					; sub_100015F0+84p ...

Memory		= dword	ptr  4

		push	esi		; PRP_DestroyNakedCondVar
		mov	esi, [esp+4+Memory]
		lea	eax, [esi+0Ch]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	esi
		retn
PR_DestroyCondVar endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100190B0	proc near		; CODE XREF: PR_LogFlush+16Fp
					; PR_LogPrint+367p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebx, eax
		mov	eax, [esp+18h+arg_0]
		mov	ecx, 1
		lea	edi, [eax+0Ch]
		mov	[esp+18h+var_8], ecx
		mov	[esp+18h+var_4], 2

loc_100190D6:				; CODE XREF: sub_100190B0+85j
		mov	edx, [esp+18h+var_8]
		mov	[eax+10h], edx
		movzx	ebp, byte ptr [edi]
		test	ebp, ebp
		jz	short loc_1001912B
		mov	byte ptr [edi],	0
		cmp	dword_10032684,	0
		mov	esi, offset dword_10032684
		jz	short loc_1001912B

loc_100190F5:				; CODE XREF: sub_100190B0+70j
		test	[esi+4], ebp
		jz	short loc_1001911A
		mov	eax, dword_10032AB4
		cmp	dword ptr [eax+4], 4
		jl	short loc_10019115
		mov	ecx, [esi]
		push	ecx
		push	offset aIntson0SIntr ; "IntsOn[0]: %s intr"
		call	PR_LogPrint
		add	esp, 8

loc_10019115:				; CODE XREF: sub_100190B0+53j
		mov	edx, [esi+8]
		call	edx

loc_1001911A:				; CODE XREF: sub_100190B0+48j
		add	esi, 0Ch
		cmp	dword ptr [esi], 0
		jnz	short loc_100190F5
		mov	eax, [esp+18h+arg_0]
		mov	ecx, 1

loc_1001912B:				; CODE XREF: sub_100190B0+32j
					; sub_100190B0+43j
		sub	[esp+18h+var_8], ecx
		add	edi, ecx
		sub	[esp+18h+var_4], ecx
		jnz	short loc_100190D6
		cmp	byte ptr [eax+0Fh], 0
		jz	short loc_100191B5
		lea	ebp, [ebx+40h]
		push	ebp		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	esi, [ebx+9Ch]
		mov	edi, [ebx+4]
		mov	dword ptr [ebx], 1
		mov	eax, [esi+24h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [esi+24h]
		lea	edx, [ecx+edi*8+48h]
		mov	[ebx+68h], edx
		mov	ecx, [esi+24h]
		mov	edx, [ecx+edi*8+4Ch]
		lea	eax, [ebx+68h]
		mov	[ebx+6Ch], edx
		mov	ecx, [esi+24h]
		mov	edx, [ecx+edi*8+4Ch]
		mov	[edx], eax
		mov	ecx, [esi+24h]
		mov	[ecx+edi*8+4Ch], eax
		mov	eax, [esi+24h]
		mov	ecx, edi
		mov	edx, 1
		shl	edx, cl
		or	[eax+68h], edx
		mov	dword ptr [ebx+58h], 1
		mov	eax, [esi+24h]
		mov	esi, ds:LeaveCriticalSection
		push	eax		; lpCriticalSection
		call	esi ; LeaveCriticalSection
		push	ebp		; lpCriticalSection
		call	esi ; LeaveCriticalSection
		push	ebx
		call	sub_10024960
		add	esp, 4

loc_100191B5:				; CODE XREF: sub_100190B0+8Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_100190B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100191C0	proc near		; CODE XREF: PR_Unlock+F7p
					; PR_ResumeAll+1ECp

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		add	ebx, 0Ch
		push	edi
		mov	edi, [ebx]
		cmp	edi, ebx
		jz	loc_10019269
		push	ebp
		push	esi

loc_100191D5:				; CODE XREF: sub_100191C0+36j
		lea	esi, [edi-70h]
		lea	ebp, [esi+40h]
		push	ebp		; lpCriticalSection
		call	ds:EnterCriticalSection
		test	byte ptr [esi+90h], 40h
		jz	short loc_100191FD
		mov	edi, [edi]
		push	ebp		; lpCriticalSection
		call	ds:LeaveCriticalSection
		cmp	edi, ebx
		jnz	short loc_100191D5
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100191FD:				; CODE XREF: sub_100191C0+29j
		mov	eax, [esi+74h]
		mov	ecx, [esi+70h]
		mov	dword ptr [esi+84h], 0
		mov	[eax], ecx
		mov	edx, [esi+70h]
		mov	eax, [esi+74h]
		mov	[edx+4], eax
		test	byte ptr [esi+90h], 80h
		jnz	short loc_1001924E
		mov	dword ptr [esi], 1
		call	PR_AssertCurrentThreadOwnsLock_0
		push	esi
		push	eax
		call	sub_1001BCA0
		add	esp, 8
		lea	ecx, [esi+40h]
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	esi
		call	sub_1001DF20
		add	esp, 4
		pop	esi
		pop	ebp
		pop	edi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001924E:				; CODE XREF: sub_100191C0+5Fj
		lea	edx, [esi+40h]
		push	edx		; lpCriticalSection
		mov	dword ptr [esi], 2
		call	ds:LeaveCriticalSection
		push	esi
		call	sub_1001DF20
		add	esp, 4
		pop	esi
		pop	ebp

loc_10019269:				; CODE XREF: sub_100191C0+Dj
		pop	edi
		pop	ebx
		retn
sub_100191C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019270	proc near		; CODE XREF: PR_NewMonitor+3Cp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		lea	eax, [esi+1Ch]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		lea	eax, [esi+0Ch]
		mov	[esi+10h], eax
		mov	[esi], esi
		mov	[esi+4], esi
		mov	[eax], eax
		xor	eax, eax
		pop	esi
		retn
sub_10019270	endp


; =============== S U B	R O U T	I N E =======================================


sub_10019290	proc near		; CODE XREF: PR_NewMonitor+77p
					; PR_DestroyMonitor+1Bp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		add	eax, 1Ch
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		retn
sub_10019290	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 233. PR_Lock

; =============== S U B	R O U T	I N E =======================================


		public PR_Lock
PR_Lock		proc near		; CODE XREF: sub_10001010+6Dp
					; PR_FreeFileDesc_0+5Bp ...

lpTlsValue	= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		cmp	dword_10031524,	0
		mov	esi, eax
		jz	short loc_100192C8
		mov	edi, [esp+0Ch+arg_0]
		lea	eax, [edi+1Ch]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	[edi+8], esi
		pop	edi
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_100192C8:				; CODE XREF: PR_Lock+11j
		test	byte ptr [esi+90h], 80h
		jnz	short loc_10019339
		cmp	dword_1003067C,	0
		jz	short loc_100192F6
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		mov	ecx, [eax+10h]
		mov	[esp+0Ch+lpTlsValue], ecx
		jmp	short loc_10019307
; ---------------------------------------------------------------------------

loc_100192F6:				; CODE XREF: PR_Lock+38j
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+0Ch+lpTlsValue], eax

loc_10019307:				; CODE XREF: PR_Lock+54j
		cmp	dword_1003067C,	0
		jz	short loc_1001932B
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	dword ptr [edx+10h], 1
		jmp	short loc_10019339
; ---------------------------------------------------------------------------

loc_1001932B:				; CODE XREF: PR_Lock+6Ej
		mov	eax, dwTlsIndex
		push	1		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_10019339:				; CODE XREF: PR_Lock+2Fj PR_Lock+89j
		mov	edi, [esp+0Ch+arg_0]
		push	ebx
		lea	ebx, [edi+1Ch]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		cmp	dword ptr [edi+8], 0
		jz	short loc_100193CB
		push	ebp
		lea	ebp, [esi+70h]

loc_10019352:				; CODE XREF: PR_Lock+128j
		mov	eax, [edi+0Ch]
		lea	ecx, [edi+0Ch]
		cmp	eax, ecx
		jz	short loc_10019377
		mov	ecx, [edi+10h]
		mov	edx, [eax-6Ch]
		cmp	edx, [ecx-6Ch]
		jz	short loc_10019377

loc_10019367:				; CODE XREF: PR_Lock+D3j
		cmp	[esi+4], edx
		jg	short loc_1001937A
		mov	eax, [eax]
		lea	ecx, [edi+0Ch]
		cmp	eax, ecx
		jnz	short loc_10019367
		jmp	short loc_1001937A
; ---------------------------------------------------------------------------

loc_10019377:				; CODE XREF: PR_Lock+BAj PR_Lock+C5j
		lea	eax, [edi+0Ch]

loc_1001937A:				; CODE XREF: PR_Lock+CAj PR_Lock+D5j
		mov	[ebp+0], eax
		mov	ecx, [eax+4]
		mov	[esi+74h], ecx
		mov	edx, [eax+4]
		mov	[edx], ebp
		mov	[eax+4], ebp
		lea	eax, [esi+40h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		lea	eax, [esi+40h]
		push	eax		; lpCriticalSection
		mov	dword ptr [esi], 3
		mov	[esi+84h], edi
		call	ds:LeaveCriticalSection
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0FFFFFFFFh
		push	esi
		call	sub_1001DB80
		add	esp, 8
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		cmp	dword ptr [edi+8], 0
		jnz	short loc_10019352
		pop	ebp

loc_100193CB:				; CODE XREF: PR_Lock+ACj
		mov	[edi+8], esi
		mov	eax, [esi+4]
		mov	[edi+14h], eax
		lea	ecx, [esi+78h]
		mov	[edi], ecx
		mov	edx, [esi+7Ch]
		mov	[edi+4], edx
		mov	eax, [esi+7Ch]
		mov	[eax], edi
		push	ebx		; lpCriticalSection
		mov	[esi+7Ch], edi
		call	ds:LeaveCriticalSection
		test	byte ptr [esi+90h], 80h
		pop	ebx
		jnz	short loc_10019430
		cmp	dword_1003067C,	0
		jz	short loc_1001941F
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	ecx, [esp+0Ch+lpTlsValue]
		pop	edi
		mov	[eax+10h], ecx
		pop	esi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001941F:				; CODE XREF: PR_Lock+15Fj
		mov	edx, [esp+0Ch+lpTlsValue]
		mov	eax, dwTlsIndex
		push	edx		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_10019430:				; CODE XREF: PR_Lock+156j
		pop	edi
		pop	esi
		pop	ecx
		retn
PR_Lock		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 367. PR_Unlock

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_Unlock(LPVOID lpTlsValue)
		public PR_Unlock
PR_Unlock	proc near		; CODE XREF: sub_10001010+9Dp
					; PR_FreeFileDesc_0+95j ...

lpTlsValue	= dword	ptr  4

		push	ebp
		push	esi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, [esp+8+lpTlsValue]
		mov	ebp, eax
		cmp	[esi+8], ebp
		jz	short loc_10019458
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10019458:				; CODE XREF: PR_Unlock+10j
		cmp	dword_10031524,	0
		jz	short loc_10019477
		mov	dword ptr [esi+8], 0
		add	esi, 1Ch
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10019477:				; CODE XREF: PR_Unlock+1Fj
		test	byte ptr [ebp+90h], 80h
		jnz	short loc_100194E4
		cmp	dword_1003067C,	0
		jz	short loc_100194A0
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+10h]
		jmp	short loc_100194AD
; ---------------------------------------------------------------------------

loc_100194A0:				; CODE XREF: PR_Unlock+47j
		mov	ecx, dwTlsIndex
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_100194AD:				; CODE XREF: PR_Unlock+5Ej
		cmp	dword_1003067C,	0
		mov	[esp+8+lpTlsValue], eax
		jz	short loc_100194D5
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	dword ptr [ecx+10h], 1
		jmp	short loc_100194E4
; ---------------------------------------------------------------------------

loc_100194D5:				; CODE XREF: PR_Unlock+78j
		mov	edx, dwTlsIndex
		push	1		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_100194E4:				; CODE XREF: PR_Unlock+3Ej
					; PR_Unlock+93j
		push	ebx
		push	edi
		lea	ebx, [esi+1Ch]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esi+4]
		mov	ecx, [esi]
		mov	[eax], ecx
		mov	edx, [esi]
		mov	eax, [esi+4]
		mov	[edx+4], eax
		mov	ecx, [esi+14h]
		cmp	[esi+18h], ecx
		jle	short loc_1001952F
		mov	eax, [ebp+78h]
		lea	edi, [ebp+78h]
		cmp	eax, edi
		jz	short loc_10019520

loc_10019511:				; CODE XREF: PR_Unlock+DEj
		mov	edx, [eax+18h]
		cmp	edx, ecx
		jle	short loc_1001951A
		mov	ecx, edx

loc_1001951A:				; CODE XREF: PR_Unlock+D6j
		mov	eax, [eax]
		cmp	eax, edi
		jnz	short loc_10019511

loc_10019520:				; CODE XREF: PR_Unlock+CFj
		cmp	ecx, [ebp+4]
		jz	short loc_1001952F
		push	ecx		; int
		push	ebp		; lpTlsValue
		call	sub_1001A160
		add	esp, 8

loc_1001952F:				; CODE XREF: PR_Unlock+C5j
					; PR_Unlock+E3j
		lea	eax, [esi+0Ch]
		cmp	[eax], eax
		jz	short loc_1001953F
		push	esi
		call	sub_100191C0
		add	esp, 4

loc_1001953F:				; CODE XREF: PR_Unlock+F4j
		xor	edi, edi
		push	ebx		; lpCriticalSection
		mov	[esi+18h], edi
		mov	[esi+8], edi
		call	ds:LeaveCriticalSection
		test	byte ptr [ebp+90h], 80h
		jnz	loc_100195FB
		mov	esi, [esp+10h+lpTlsValue]
		cmp	esi, edi
		jnz	short loc_100195CA
		cmp	dword_1003067C,	edi
		jz	short loc_10019583
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+14h]
		jmp	short loc_10019590
; ---------------------------------------------------------------------------

loc_10019583:				; CODE XREF: PR_Unlock+129j
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10019590:				; CODE XREF: PR_Unlock+141j
		cmp	[eax+0Ch], edi
		jz	short loc_100195CA
		cmp	dword_1003067C,	edi
		jz	short loc_100195B4
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_100195C1
; ---------------------------------------------------------------------------

loc_100195B4:				; CODE XREF: PR_Unlock+15Bj
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_100195C1:				; CODE XREF: PR_Unlock+172j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_100195CA:				; CODE XREF: PR_Unlock+121j
					; PR_Unlock+153j
		cmp	dword_1003067C,	edi
		jz	short loc_100195EE
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		pop	edi
		pop	ebx
		mov	[edx+10h], esi
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100195EE:				; CODE XREF: PR_Unlock+190j
		mov	eax, dwTlsIndex
		push	esi		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_100195FB:				; CODE XREF: PR_Unlock+115j
		pop	edi
		pop	ebx
		pop	esi
		xor	eax, eax
		pop	ebp
		retn
PR_Unlock	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  21. PR_AssertCurrentThreadOwnsLock
; [00000005 BYTES: COLLAPSED FUNCTION PR_AssertCurrentThreadOwnsLock]
		align 10h
; Exported entry 358. PR_TestAndLock

; =============== S U B	R O U T	I N E =======================================


		public PR_TestAndLock
PR_TestAndLock	proc near		; CODE XREF: PRP_TryLock+5p
					; DATA XREF: .rdata:off_1002C7C8o

lpTlsValue	= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		cmp	dword_10031524,	0
		mov	edi, eax
		mov	[esp+10h+var_4], 0
		jz	short loc_10019665
		mov	esi, [esp+10h+arg_0]
		lea	eax, [esi+1Ch]
		push	eax		; lpCriticalSection
		call	ds:TryEnterCriticalSection
		test	eax, eax
		jz	short loc_1001965D
		mov	[esi+8], edi
		pop	edi
		mov	eax, 1
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001965D:				; CODE XREF: PR_TestAndLock+2Dj
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10019665:				; CODE XREF: PR_TestAndLock+1Bj
		test	byte ptr [edi+90h], 80h
		push	ebx
		mov	ebx, TlsIndex
		jnz	short loc_100196CF
		cmp	dword_1003067C,	0
		jz	short loc_10019690
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebx*4]
		mov	eax, [edx+10h]
		jmp	short loc_1001969D
; ---------------------------------------------------------------------------

loc_10019690:				; CODE XREF: PR_TestAndLock+5Cj
		mov	ecx, dwTlsIndex
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001969D:				; CODE XREF: PR_TestAndLock+6Ej
		cmp	dword_1003067C,	0
		mov	[esp+14h+lpTlsValue], eax
		jz	short loc_100196C0
		mov	edx, large fs:2Ch
		mov	eax, [edx+ebx*4]
		mov	dword ptr [eax+10h], 1
		jmp	short loc_100196CF
; ---------------------------------------------------------------------------

loc_100196C0:				; CODE XREF: PR_TestAndLock+88j
		mov	ecx, dwTlsIndex
		push	1		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_100196CF:				; CODE XREF: PR_TestAndLock+53j
					; PR_TestAndLock+9Ej
		mov	esi, [esp+14h+arg_0]
		push	ebp
		lea	ebp, [esi+1Ch]
		push	ebp		; lpCriticalSection
		call	ds:EnterCriticalSection
		cmp	dword ptr [esi+8], 0
		jnz	short loc_10019707
		mov	[esi+8], edi
		mov	edx, [edi+4]
		mov	[esi+14h], edx
		lea	eax, [edi+78h]
		mov	[esi], eax
		mov	ecx, [edi+7Ch]
		mov	[esi+4], ecx
		mov	edx, [edi+7Ch]
		mov	[edx], esi
		mov	[edi+7Ch], esi
		mov	esi, 1
		jmp	short loc_1001970B
; ---------------------------------------------------------------------------

loc_10019707:				; CODE XREF: PR_TestAndLock+C2j
		mov	esi, [esp+18h+var_4]

loc_1001970B:				; CODE XREF: PR_TestAndLock+E5j
		push	ebp		; lpCriticalSection
		call	ds:LeaveCriticalSection
		test	byte ptr [edi+90h], 80h
		pop	ebp
		jnz	loc_100197B3
		mov	edi, [esp+14h+lpTlsValue]
		test	edi, edi
		jnz	short loc_10019784
		cmp	dword_1003067C,	edi
		jz	short loc_10019741
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	eax, [ecx+14h]
		jmp	short loc_1001974E
; ---------------------------------------------------------------------------

loc_10019741:				; CODE XREF: PR_TestAndLock+10Ej
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001974E:				; CODE XREF: PR_TestAndLock+11Fj
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_10019784
		cmp	dword_1003067C,	0
		jz	short loc_1001976E
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	eax, [ecx+14h]
		jmp	short loc_1001977B
; ---------------------------------------------------------------------------

loc_1001976E:				; CODE XREF: PR_TestAndLock+13Bj
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001977B:				; CODE XREF: PR_TestAndLock+14Cj
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_10019784:				; CODE XREF: PR_TestAndLock+106j
					; PR_TestAndLock+132j
		cmp	dword_1003067C,	0
		jz	short loc_100197A5
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		pop	ebx
		mov	[ecx+10h], edi
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100197A5:				; CODE XREF: PR_TestAndLock+16Bj
		mov	edx, dwTlsIndex
		push	edi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_100197B3:				; CODE XREF: PR_TestAndLock+FAj
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 8
		retn
PR_TestAndLock	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  11. PRP_TryLock

; =============== S U B	R O U T	I N E =======================================


		public PRP_TryLock
PRP_TryLock	proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	eax
		call	PR_TestAndLock
		add	esp, 4
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		retn
PRP_TryLock	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 252. PR_NewLock

; =============== S U B	R O U T	I N E =======================================


		public PR_NewLock
PR_NewLock	proc near		; CODE XREF: sub_100012C0:loc_10001352p
					; sub_100015F0p ...
		cmp	dword_10031520,	0
		jnz	short loc_100197EE
		call	PR_Init

loc_100197EE:				; CODE XREF: PR_NewLock+7j
		push	esi
		push	34h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1001981A
		lea	eax, [esi+1Ch]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		lea	eax, [esi+0Ch]
		mov	[eax], eax
		mov	[esi+10h], eax
		mov	[esi], esi
		mov	[esi+4], esi
		mov	eax, esi

loc_1001981A:				; CODE XREF: PR_NewLock+1Fj
		pop	esi
		retn
PR_NewLock	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  83. PR_DestroyLock

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DestroyLock(void *Memory)
		public PR_DestroyLock
PR_DestroyLock	proc near		; CODE XREF: sub_10001370+48p
					; sub_100015F0+96p ...

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		lea	eax, [esi+1Ch]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	esi
		retn
PR_DestroyLock	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019840	proc near		; CODE XREF: PR_Init_0+DAp
		call	PR_NewLock
		mov	dword_10032A70,	eax
		retn
sub_10019840	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019850	proc near		; CODE XREF: PR_Cleanup+16Fp
		mov	eax, dword_10032A70
		test	eax, eax
		jz	short locret_1001986C
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10032A70,	0

locret_1001986C:			; CODE XREF: sub_10019850+7j
		retn
sub_10019850	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10019870(void	*Memory)
sub_10019870	proc near		; CODE XREF: sub_10019BB0+64j
					; .text:1001A0E7p ...

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		test	esi, esi
		jz	short loc_10019888
		test	byte ptr [esi+8], 4
		jz	short loc_1001988A
		push	esi		; Memory
		call	PR_Free
		add	esp, 4

loc_10019888:				; CODE XREF: sub_10019870+7j
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001988A:				; CODE XREF: sub_10019870+Dj
		mov	eax, dword_10032A70
		push	eax
		call	PR_Lock
		mov	ecx, off_1003065C
		mov	[esi], ecx
		mov	edx, off_1003065C
		mov	eax, [edx+4]
		mov	[esi+4], eax
		mov	ecx, off_1003065C
		mov	edx, [ecx+4]
		mov	[edx], esi
		mov	eax, off_1003065C
		mov	[eax+4], esi
		mov	ecx, dword_10032A70
		add	esp, 4
		inc	dword_10032A6C
		pop	esi
		mov	[esp+Memory], ecx ; lpTlsValue
		jmp	PR_Unlock
sub_10019870	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100198E0	proc near		; CODE XREF: PR_Cleanup+146p
		mov	eax, dword_10032AF8
		push	esi
		xor	esi, esi
		cmp	eax, esi
		jz	short loc_100198FB
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10032AF8,	esi

loc_100198FB:				; CODE XREF: sub_100198E0+Aj
		mov	eax, dword_10032A60
		cmp	eax, esi
		jz	short loc_10019913
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10032A60,	esi

loc_10019913:				; CODE XREF: sub_100198E0+22j
		mov	eax, dword_10032A58
		cmp	eax, esi
		jz	short loc_1001992B
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	dword_10032A58,	esi

loc_1001992B:				; CODE XREF: sub_100198E0+3Aj
		mov	eax, dword_10032A5C
		cmp	eax, esi
		jz	short loc_10019943
		push	eax		; Memory
		call	PR_DestroyLock
		add	esp, 4
		mov	dword_10032A5C,	esi

loc_10019943:				; CODE XREF: sub_100198E0+52j
		pop	esi
		retn
sub_100198E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019950	proc near		; CODE XREF: .text:10019D8Cp
					; .text:1001A02Bp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	dword ptr [esi+98h], 0
		jz	loc_10019A1C
		mov	eax, dword_10032AF8
		push	ebx
		push	ebp
		push	edi
		push	eax
		call	PR_Lock
		mov	edi, ds:EnterCriticalSection
		add	esp, 4
		lea	ebp, [esi+40h]
		push	ebp		; lpCriticalSection
		call	edi ; EnterCriticalSection
		test	byte ptr [esi+90h], 80h
		mov	ebx, ds:LeaveCriticalSection
		mov	dword ptr [esi], 5
		jnz	short loc_100199F4
		mov	ecx, [esi+9Ch]
		mov	edx, [ecx+24h]
		add	edx, 30h
		push	edx		; lpCriticalSection
		call	edi ; EnterCriticalSection
		mov	eax, [esi+9Ch]
		mov	dword ptr [esi+58h], 4
		mov	edx, [eax+24h]
		add	edx, 88h
		mov	[esi+68h], edx
		mov	edx, [eax+24h]
		mov	edx, [edx+8Ch]
		lea	ecx, [esi+68h]
		mov	[esi+6Ch], edx
		mov	eax, [eax+24h]
		mov	edx, [eax+8Ch]
		mov	[edx], ecx
		mov	eax, [esi+9Ch]
		mov	edx, [eax+24h]
		mov	[edx+8Ch], ecx
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 30h
		push	ecx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection

loc_100199F4:				; CODE XREF: sub_10019950+42j
		push	ebp		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		mov	edx, [esi+98h]
		push	edx
		call	PR_NotifyCondVar
		mov	eax, dword_10032AF8
		push	eax		; lpTlsValue
		call	PR_Unlock
		push	0FFFFFFFFh
		push	esi
		call	sub_1001DB80
		add	esp, 10h
		pop	edi
		pop	ebp
		pop	ebx

loc_10019A1C:				; CODE XREF: sub_10019950+Cj
		pop	esi
		retn
sub_10019950	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019A20	proc near		; CODE XREF: .text:10019DF1p
					; .text:1001A08Fp

arg_0		= dword	ptr  4

		mov	ecx, dword_10031598
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+90h]
		and	eax, 80h
		jz	short loc_10019A83
		cmp	dword_10032A3C,	ecx
		jnb	short loc_10019A83
		mov	eax, dword_10032A5C
		push	eax
		call	PR_Lock
		mov	dword ptr [esi+68h], offset dword_10032A50
		mov	ecx, dword_10032A54
		lea	eax, [esi+68h]
		mov	[esi+6Ch], ecx
		mov	edx, dword_10032A54
		mov	[edx], eax
		inc	dword_10032A3C
		mov	dword_10032A54,	eax
		mov	eax, dword_10032A5C
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10019A83:				; CODE XREF: sub_10019A20+16j
					; sub_10019A20+1Ej
		test	eax, eax
		jnz	short loc_10019AD4
		cmp	dword_10032A38,	ecx
		jnb	short loc_10019AD4
		mov	ecx, dword_10032A5C
		push	ecx
		call	PR_Lock
		mov	dword ptr [esi+68h], offset dword_10032A40
		mov	edx, dword_10032A44
		lea	eax, [esi+68h]
		mov	[esi+6Ch], edx
		mov	ecx, dword_10032A44
		mov	[ecx], eax
		mov	edx, dword_10032A5C
		inc	dword_10032A38
		push	edx		; lpTlsValue
		mov	dword_10032A44,	eax
		call	PR_Unlock
		add	esp, 8
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10019AD4:				; CODE XREF: sub_10019A20+65j
					; sub_10019A20+6Dj
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10019A20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10019AE0(LPVOID lpTlsValue)
sub_10019AE0	proc near		; CODE XREF: _PR_NativeCreateThread+173p
					; sub_1001B280+2Cp

lpTlsValue	= dword	ptr  4

		mov	eax, dword_10032A60
		push	eax
		call	PR_Lock
		mov	edx, [esp+4+lpTlsValue]
		mov	ecx, 1
		add	esp, 4
		test	[edx+90h], cl
		jz	short loc_10019B14
		sub	dword_10032B08,	ecx
		mov	ecx, dword_10032A60
		mov	[esp+lpTlsValue], ecx ;	lpTlsValue
		jmp	PR_Unlock
; ---------------------------------------------------------------------------

loc_10019B14:				; CODE XREF: sub_10019AE0+1Dj
		mov	eax, dword_10032AB8
		sub	eax, ecx
		mov	dword_10032AB8,	eax
		cmp	eax, dword_10032A68
		jnz	short loc_10019B36
		mov	eax, dword_10032A58
		push	eax
		call	PR_NotifyCondVar
		add	esp, 4

loc_10019B36:				; CODE XREF: sub_10019AE0+46j
		mov	ecx, dword_10032A60
		mov	[esp+lpTlsValue], ecx ;	lpTlsValue
		jmp	PR_Unlock
sub_10019AE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10019B50(void	*Memory)
sub_10019B50	proc near		; CODE XREF: PR_Cleanup+11Dp
					; .text:10019E15p

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi+98h]
		push	edi
		xor	edi, edi
		cmp	eax, edi
		jz	short loc_10019B71
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[esi+98h], edi

loc_10019B71:				; CODE XREF: sub_10019B50+10j
		mov	eax, [esi+24h]
		cmp	eax, edi
		jz	short loc_10019B87
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esi+24h], edi
		mov	[esi+20h], edi

loc_10019B87:				; CODE XREF: sub_10019B50+26j
		mov	eax, [esi+10h]
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		lea	ecx, [esi+40h]
		push	ecx		; lpCriticalSection
		mov	[esi+10h], edi
		call	ds:DeleteCriticalSection
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		retn
sub_10019B50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10019BB0	proc near		; CODE XREF: PR_Cleanup:loc_1000D4D7p

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi+98h]
		test	eax, eax
		jz	short loc_10019BD2
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	dword ptr [esi+98h], 0

loc_10019BD2:				; CODE XREF: sub_10019BB0+Dj
		mov	eax, [esi+24h]
		test	eax, eax
		jz	short loc_10019BF0
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword ptr [esi+24h], 0
		mov	dword ptr [esi+20h], 0

loc_10019BF0:				; CODE XREF: sub_10019BB0+27j
		lea	eax, [esi+40h]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		cmp	dword ptr [esi+0A0h], 1
		push	esi
		jnz	short loc_10019C19
		call	sub_100246E0
		mov	ecx, [esi+10h]
		add	esp, 4
		pop	esi
		mov	[esp+Memory], ecx ; Memory
		jmp	sub_10019870
; ---------------------------------------------------------------------------

loc_10019C19:				; CODE XREF: sub_10019BB0+52j
		call	sub_100246E0
		add	esp, 4
		pop	esi
		retn
sub_10019BB0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10019C30:				; DATA XREF: _PR_NativeCreateThread+129o
		cmp	dword_1003067C,	0
		push	ebx
		mov	ebx, TlsIndex
		push	esi
		mov	esi, [esp+0Ch]
		push	edi
		mov	edi, ds:TlsSetValue
		jz	short loc_10019C5D
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	[ecx+8], esi
		jmp	short loc_10019C67
; ---------------------------------------------------------------------------

loc_10019C5D:				; CODE XREF: .text:10019C4Aj
		mov	edx, dword_100329F0
		push	esi
		push	edx
		call	edi ; TlsSetValue

loc_10019C67:				; CODE XREF: .text:10019C5Bj
		cmp	dword_1003067C,	0
		jz	short loc_10019C85
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	dword ptr [ecx+14h], 0
		jmp	short loc_10019C90
; ---------------------------------------------------------------------------

loc_10019C85:				; CODE XREF: .text:10019C6Ej
		mov	edx, dword_100329EC
		push	0
		push	edx
		call	edi ; TlsSetValue

loc_10019C90:				; CODE XREF: .text:10019C83j
		mov	eax, [esi+10h]
		mov	[esp+10h], eax
		test	eax, eax
		jz	short loc_10019CD9
		cmp	dword ptr [eax+18h], 0
		jnz	short loc_10019CD9
		mov	ecx, [eax+1Ch]
		mov	[eax+10h], ecx
		mov	edx, dword_10032B10
		mov	ecx, dword_10032B0C
		lea	eax, [esp+edx+0Fh]
		sar	eax, cl
		shl	eax, cl
		mov	ecx, [esp+10h]
		mov	[ecx+0Ch], eax
		mov	eax, [esp+10h]
		mov	edx, [eax+0Ch]
		mov	[eax+18h], edx
		mov	eax, [esp+10h]
		mov	ecx, [eax+0Ch]
		sub	ecx, [eax+1Ch]
		mov	[eax+14h], ecx

loc_10019CD9:				; CODE XREF: .text:10019C99j
					; .text:10019C9Fj
		push	esi
		call	sub_100244D0
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	loc_10019E1D
		lea	edi, [esi+60h]
		mov	ebx, 1

loc_10019CF3:				; CODE XREF: .text:10019E09j
		mov	dword ptr [esi], 2
		mov	edx, dword_10032A60
		push	edx
		call	PR_Lock
		mov	dword ptr [edi], offset	off_100302B8
		mov	eax, off_100302BC
		mov	[esi+64h], eax
		mov	ecx, off_100302BC
		mov	[ecx], edi
		mov	edx, dword_10032A60
		add	dword_10032A48,	ebx
		push	edx
		mov	off_100302BC, edi
		call	PR_Unlock
		mov	eax, [esi+8]
		mov	ecx, [esi+0Ch]
		push	eax
		call	ecx
		mov	edx, dword_10032A60
		push	edx
		call	PR_Lock
		mov	eax, [esi+64h]
		mov	ecx, [edi]
		mov	[eax], ecx
		mov	edx, [edi]
		mov	eax, [esi+64h]
		mov	[edx+4], eax
		mov	ecx, dword_10032A60
		sub	dword_10032A48,	ebx
		push	ecx
		call	PR_Unlock
		mov	edx, dword_10032A90
		add	esp, 14h
		cmp	dword ptr [edx+4], 4
		jl	short loc_10019D85
		push	offset aThreadExiting ;	"thread	exiting"
		call	PR_LogPrint
		add	esp, 4

loc_10019D85:				; CODE XREF: .text:10019D76j
		push	esi
		call	sub_10016920
		push	esi
		call	sub_10019950
		mov	eax, dword_10032A60
		push	eax
		call	PR_Lock
		add	esp, 0Ch
		test	[esi+90h], bl
		jz	short loc_10019DAF
		sub	dword_10032B08,	ebx
		jmp	short loc_10019DD2
; ---------------------------------------------------------------------------

loc_10019DAF:				; CODE XREF: .text:10019DA5j
		mov	eax, dword_10032AB8
		sub	eax, ebx
		mov	dword_10032AB8,	eax
		cmp	eax, dword_10032A68
		jnz	short loc_10019DD2
		mov	ecx, dword_10032A58
		push	ecx
		call	PR_NotifyCondVar
		add	esp, 4

loc_10019DD2:				; CODE XREF: .text:10019DADj
					; .text:10019DC1j
		mov	edx, dword_10032A60
		push	edx
		call	PR_Unlock
		add	esp, 4
		mov	dword ptr [esi], 8
		cmp	dword_10031598,	0
		jz	short loc_10019E0E
		push	esi
		call	sub_10019A20
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10019E0E
		push	0FFFFFFFFh
		push	esi
		call	sub_1001DB80
		add	esp, 8
		jmp	loc_10019CF3
; ---------------------------------------------------------------------------

loc_10019E0E:				; CODE XREF: .text:10019DEEj
					; .text:10019DFCj
		push	esi
		call	sub_100247B0
		push	esi
		call	sub_10019B50
		add	esp, 8

loc_10019E1D:				; CODE XREF: .text:10019CE5j
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_10019E30:				; DATA XREF: _PR_CreateThread+385o
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		xor	edi, edi
		mov	esi, eax
		cmp	dword_1003067C,	edi
		jz	short loc_10019E5D
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+0Ch]
		jmp	short loc_10019E69
; ---------------------------------------------------------------------------

loc_10019E5D:				; CODE XREF: .text:10019E44j
		mov	eax, dword_100329D8
		push	eax
		call	ds:TlsGetValue

loc_10019E69:				; CODE XREF: .text:10019E5Bj
		cmp	eax, edi
		jz	short loc_10019EA0
		cmp	dword_1003067C,	edi
		jz	short loc_10019E8D
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+0Ch]
		jmp	short loc_10019E9A
; ---------------------------------------------------------------------------

loc_10019E8D:				; CODE XREF: .text:10019E73j
		mov	ecx, dword_100329D8
		push	ecx
		call	ds:TlsGetValue

loc_10019E9A:				; CODE XREF: .text:10019E8Bj
		mov	[eax+94h], edi

loc_10019EA0:				; CODE XREF: .text:10019E6Bj
		mov	ebx, 1
		cmp	[esi+10h], edi
		jnz	short loc_10019EFC
		push	2Ch
		push	ebx
		call	PR_Calloc
		add	esp, 8
		mov	[esi+10h], eax
		mov	[esp+10h], eax
		cmp	eax, edi
		jz	short loc_10019EFC
		cmp	[eax+18h], edi
		jnz	short loc_10019EFC
		mov	edx, [eax+1Ch]
		mov	[eax+10h], edx
		mov	eax, dword_10032B10
		mov	ecx, dword_10032B0C
		lea	edx, [esp+eax+0Fh]
		mov	eax, [esp+10h]
		sar	edx, cl
		shl	edx, cl
		mov	[eax+0Ch], edx
		mov	eax, [esp+10h]
		mov	ecx, [eax+0Ch]
		mov	[eax+18h], ecx
		mov	eax, [esp+10h]
		mov	edx, [eax+0Ch]
		sub	edx, [eax+1Ch]
		mov	[eax+14h], edx

loc_10019EFC:				; CODE XREF: .text:10019EA8j
					; .text:10019EBEj ...
		mov	ebp, ds:TlsSetValue

loc_10019F02:				; CODE XREF: .text:1001A134j
					; .text:1001A14Cj
		test	byte ptr [esi+90h], 80h
		jnz	short loc_10019F33
		cmp	dword_1003067C,	edi
		jz	short loc_10019F2A
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	[edx+10h], edi
		jmp	short loc_10019F33
; ---------------------------------------------------------------------------

loc_10019F2A:				; CODE XREF: .text:10019F11j
		mov	eax, dwTlsIndex
		push	edi
		push	eax
		call	ebp ; TlsSetValue

loc_10019F33:				; CODE XREF: .text:10019F09j
					; .text:10019F28j
		test	dword ptr [esi+90h], 200h
		jnz	short loc_10019F80
		mov	ecx, dword_10032A60
		push	ecx
		call	PR_Lock
		mov	dword ptr [esi+60h], offset off_100302B0
		mov	edx, off_100302B4
		lea	eax, [esi+60h]
		mov	[esi+64h], edx
		mov	ecx, off_100302B4
		mov	[ecx], eax
		mov	edx, dword_10032A60
		add	dword_10032A64,	ebx
		push	edx
		mov	off_100302B4, eax
		call	PR_Unlock
		add	esp, 8

loc_10019F80:				; CODE XREF: .text:10019F3Dj
		mov	eax, [esi+8]
		mov	ecx, [esi+0Ch]
		push	eax
		call	ecx
		mov	edx, dword_10032A60
		push	edx
		call	PR_Lock
		add	esp, 8
		test	dword ptr [esi+90h], 200h
		jnz	short loc_10019FBB
		mov	eax, [esi+64h]
		mov	ecx, [esi+60h]
		mov	[eax], ecx
		mov	edx, [esi+60h]
		mov	eax, [esi+64h]
		mov	[edx+4], eax
		sub	dword_10032A64,	ebx

loc_10019FBB:				; CODE XREF: .text:10019FA2j
		mov	ecx, dword_10032A60
		push	ecx
		call	PR_Unlock
		mov	edx, dword_10032A90
		add	esp, 4
		cmp	dword ptr [edx+4], 4
		jl	short loc_10019FE3
		push	offset aThreadExiting ;	"thread	exiting"
		call	PR_LogPrint
		add	esp, 4

loc_10019FE3:				; CODE XREF: .text:10019FD4j
		push	esi
		call	sub_10016920
		add	esp, 4
		cmp	dword_1003067C,	edi
		jnz	short loc_1001A008
		mov	eax, dwTlsIndex
		push	eax
		call	ds:TlsGetValue
		cmp	dword_1003067C,	edi
		jz	short loc_1001A020

loc_1001A008:				; CODE XREF: .text:10019FF2j
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	[eax+10h], ebx
		jmp	short loc_1001A02A
; ---------------------------------------------------------------------------

loc_1001A020:				; CODE XREF: .text:1001A006j
		mov	ecx, dwTlsIndex
		push	ebx
		push	ecx
		call	ebp ; TlsSetValue

loc_1001A02A:				; CODE XREF: .text:1001A01Ej
		push	esi
		call	sub_10019950
		mov	edx, dword_10032A60
		push	edx
		call	PR_Lock
		add	esp, 8
		test	[esi+90h], bl
		jz	short loc_1001A04F
		sub	dword_10032B08,	ebx
		jmp	short loc_1001A071
; ---------------------------------------------------------------------------

loc_1001A04F:				; CODE XREF: .text:1001A045j
		mov	eax, dword_10032AB8
		sub	eax, ebx
		mov	dword_10032AB8,	eax
		cmp	eax, dword_10032A68
		jnz	short loc_1001A071
		mov	eax, dword_10032A58
		push	eax
		call	PR_NotifyCondVar
		add	esp, 4

loc_1001A071:				; CODE XREF: .text:1001A04Dj
					; .text:1001A061j
		mov	ecx, dword_10032A60
		push	ecx
		call	PR_Unlock
		add	esp, 4
		mov	dword ptr [esi], 8
		cmp	dword_10031598,	edi
		jz	short loc_1001A09C
		push	esi
		call	sub_10019A20
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001A0F9

loc_1001A09C:				; CODE XREF: .text:1001A08Cj
		mov	eax, [esi+98h]
		cmp	eax, edi
		jz	short loc_1001A0B5
		push	eax
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[esi+98h], edi

loc_1001A0B5:				; CODE XREF: .text:1001A0A4j
		mov	eax, [esi+24h]
		cmp	eax, edi
		jz	short loc_1001A0CB
		push	eax
		call	PR_Free
		add	esp, 4
		mov	[esi+24h], edi
		mov	[esi+20h], edi

loc_1001A0CB:				; CODE XREF: .text:1001A0BAj
		lea	edx, [esi+40h]
		push	edx
		call	ds:DeleteCriticalSection
		push	esi
		cmp	[esi+0A0h], ebx
		jnz	short loc_1001A0F1
		call	sub_100246E0
		mov	eax, [esi+10h]
		push	eax
		call	sub_10019870
		add	esp, 8
		jmp	short loc_1001A0F9
; ---------------------------------------------------------------------------

loc_1001A0F1:				; CODE XREF: .text:1001A0DCj
		call	sub_100246E0
		add	esp, 4

loc_1001A0F9:				; CODE XREF: .text:1001A09Aj
					; .text:1001A0EFj
		cmp	dword_1003067C,	edi
		jnz	short loc_1001A116
		mov	ecx, dwTlsIndex
		push	ecx
		call	ds:TlsGetValue
		cmp	dword_1003067C,	edi
		jz	short loc_1001A139

loc_1001A116:				; CODE XREF: .text:1001A0FFj
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		push	esi
		mov	[ecx+10h], ebx
		call	sub_10024960
		add	esp, 4
		jmp	loc_10019F02
; ---------------------------------------------------------------------------

loc_1001A139:				; CODE XREF: .text:1001A114j
		mov	edx, dwTlsIndex
		push	ebx
		push	edx
		call	ebp ; TlsSetValue
		push	esi
		call	sub_10024960
		add	esp, 4
		jmp	loc_10019F02
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001A160(LPVOID lpTlsValue, int)
sub_1001A160	proc near		; CODE XREF: PR_Unlock+E7p
					; PR_SetThreadPriority+3Dj

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
lpCriticalSection= dword ptr -4
lpTlsValue	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		push	esi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, [esp+10h+lpTlsValue]
		test	byte ptr [esi+90h], 80h
		mov	[esp+10h+var_C], eax
		jz	short loc_1001A193
		mov	eax, [esp+10h+arg_4]
		push	eax
		add	esi, 0B0h
		push	esi
		call	sub_100245D0
		add	esp, 8
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001A193:				; CODE XREF: sub_1001A160+18j
		test	byte ptr [eax+90h], 80h
		jnz	short loc_1001A204
		cmp	dword_1003067C,	0
		jz	short loc_1001A1C1
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		mov	ecx, [eax+10h]
		mov	[esp+10h+lpTlsValue], ecx
		jmp	short loc_1001A1D2
; ---------------------------------------------------------------------------

loc_1001A1C1:				; CODE XREF: sub_1001A160+43j
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+10h+lpTlsValue], eax

loc_1001A1D2:				; CODE XREF: sub_1001A160+5Fj
		cmp	dword_1003067C,	0
		jz	short loc_1001A1F6
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	dword ptr [edx+10h], 1
		jmp	short loc_1001A204
; ---------------------------------------------------------------------------

loc_1001A1F6:				; CODE XREF: sub_1001A160+79j
		mov	eax, dwTlsIndex
		push	1		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001A204:				; CODE XREF: sub_1001A160+3Aj
					; sub_1001A160+94j
		push	ebx
		mov	ebx, ds:EnterCriticalSection
		lea	eax, [esi+40h]
		push	edi
		push	eax		; lpCriticalSection
		mov	[esp+1Ch+lpCriticalSection], eax
		call	ebx ; EnterCriticalSection
		mov	edi, [esp+18h+arg_4]
		cmp	edi, [esi+4]
		jz	loc_1001A391
		mov	eax, [esi]
		dec	eax
		push	ebp
		mov	ebp, [esi+9Ch]
		cmp	eax, 6		; switch 7 cases
		ja	loc_1001A390	; jumptable 1001A236 default case
		jmp	ds:off_1001A458[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001A23D:				; CODE XREF: sub_1001A160+D6j
					; DATA XREF: .text:off_1001A458o
		mov	ecx, [ebp+24h]	; jumptable 1001A236 case 1
		push	ecx		; lpCriticalSection
		call	ebx ; EnterCriticalSection
		mov	[esi+4], edi
		mov	edx, [ebp+24h]
		mov	eax, [edx+68h]
		lea	ecx, [edi+1]
		shr	eax, cl
		test	eax, eax
		jz	short loc_1001A2A4
		mov	ecx, [esp+1Ch+var_C]
		test	byte ptr [ecx+90h], 80h
		jnz	short loc_1001A2A4
		cmp	dword_1003067C,	0
		jz	short loc_1001A293
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		mov	byte ptr [eax+0Fh], 1
		mov	eax, [ebp+24h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	loc_1001A390	; jumptable 1001A236 default case
; ---------------------------------------------------------------------------

loc_1001A293:				; CODE XREF: sub_1001A160+109j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	byte ptr [eax+0Fh], 1

loc_1001A2A4:				; CODE XREF: sub_1001A160+F3j
					; sub_1001A160+100j
		mov	eax, [ebp+24h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	loc_1001A390	; jumptable 1001A236 default case
; ---------------------------------------------------------------------------

loc_1001A2B3:				; CODE XREF: sub_1001A160+D6j
					; DATA XREF: .text:off_1001A458o
		mov	ecx, [ebp+24h]	; jumptable 1001A236 case 0
		push	ecx		; lpCriticalSection
		call	ebx ; EnterCriticalSection
		mov	edx, [esi+4]
		mov	ebx, [esi+68h]
		mov	ecx, [esi+9Ch]
		mov	[esp+1Ch+var_8], edx
		mov	edx, [esi+6Ch]
		mov	[edx], ebx
		mov	edx, [esi+68h]
		mov	ebx, [esi+6Ch]
		lea	eax, [esi+68h]
		mov	[edx+4], ebx
		mov	edx, [ecx+24h]
		mov	ebx, [esp+1Ch+var_8]
		lea	edx, [edx+ebx*8+48h]
		cmp	[edx], edx
		jnz	short loc_1001A2FA
		mov	edx, [ecx+24h]
		mov	ecx, ebx
		mov	ebx, 1
		shl	ebx, cl
		not	ebx
		and	[edx+68h], ebx

loc_1001A2FA:				; CODE XREF: sub_1001A160+187j
		mov	dword ptr [esi+58h], 0
		mov	[esi+4], edi
		mov	ecx, [ebp+24h]
		lea	edx, [ecx+edi*8+48h]
		mov	[eax], edx
		mov	ecx, [ebp+24h]
		mov	edx, [ecx+edi*8+4Ch]
		mov	[esi+6Ch], edx
		mov	ecx, [ebp+24h]
		mov	edx, [ecx+edi*8+4Ch]
		mov	[edx], eax
		mov	ecx, [ebp+24h]
		mov	[ecx+edi*8+4Ch], eax
		mov	eax, [ebp+24h]
		mov	ebx, 1
		mov	ecx, edi
		mov	edx, ebx
		shl	edx, cl
		or	[eax+68h], edx
		mov	[esi+58h], ebx
		mov	eax, [ebp+24h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [esp+1Ch+var_C]
		cmp	edi, [eax+4]
		jle	short loc_1001A390 ; jumptable 1001A236	default	case
		test	byte ptr [eax+90h], 80h
		jnz	short loc_1001A390 ; jumptable 1001A236	default	case
		cmp	dword_1003067C,	0
		jz	short loc_1001A37B
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+14h]
		mov	[eax+0Fh], bl
		jmp	short loc_1001A390 ; jumptable 1001A236	default	case
; ---------------------------------------------------------------------------

loc_1001A37B:				; CODE XREF: sub_1001A160+1FEj
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[eax+0Fh], bl
		jmp	short loc_1001A390 ; jumptable 1001A236	default	case
; ---------------------------------------------------------------------------

loc_1001A38D:				; CODE XREF: sub_1001A160+D6j
					; DATA XREF: .text:off_1001A458o
		mov	[esi+4], edi	; jumptable 1001A236 cases 2,3,5,6

loc_1001A390:				; CODE XREF: sub_1001A160+D0j
					; sub_1001A160+D6j ...
		pop	ebp		; jumptable 1001A236 default case

loc_1001A391:				; CODE XREF: sub_1001A160+BDj
		mov	edx, [esp+18h+lpCriticalSection]
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [esp+18h+var_C]
		test	byte ptr [eax+90h], 80h
		pop	edi
		pop	ebx
		jnz	loc_1001A450
		mov	esi, [esp+10h+lpTlsValue]
		test	esi, esi
		jnz	short loc_1001A420
		cmp	dword_1003067C,	esi
		jz	short loc_1001A3D7
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+14h]
		jmp	short loc_1001A3E4
; ---------------------------------------------------------------------------

loc_1001A3D7:				; CODE XREF: sub_1001A160+25Dj
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001A3E4:				; CODE XREF: sub_1001A160+275j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1001A420
		cmp	dword_1003067C,	0
		jz	short loc_1001A40A
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_1001A417
; ---------------------------------------------------------------------------

loc_1001A40A:				; CODE XREF: sub_1001A160+291j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001A417:				; CODE XREF: sub_1001A160+2A8j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_1001A420:				; CODE XREF: sub_1001A160+255j
					; sub_1001A160+288j
		cmp	dword_1003067C,	0
		jz	short loc_1001A443
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	[edx+10h], esi
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_1001A443:				; CODE XREF: sub_1001A160+2C7j
		mov	eax, dwTlsIndex
		push	esi		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001A450:				; CODE XREF: sub_1001A160+249j
		pop	esi
		add	esp, 0Ch
		retn
sub_1001A160	endp

; ---------------------------------------------------------------------------
		align 4
off_1001A458	dd offset loc_1001A2B3	; DATA XREF: sub_1001A160+D6r
		dd offset loc_1001A23D	; jump table for switch	statement
		dd offset loc_1001A38D
		dd offset loc_1001A38D
		dd offset loc_1001A390
		dd offset loc_1001A38D
		dd offset loc_1001A38D
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A480	proc near		; CODE XREF: sub_10024960+10j

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 8
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		cmp	dword_1003067C,	0
		mov	[esp+18h+var_4], eax
		jz	short loc_1001A4B4
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	edi, [edx+14h]
		mov	[esp+18h+var_8], edi
		jmp	short loc_1001A4C6
; ---------------------------------------------------------------------------

loc_1001A4B4:				; CODE XREF: sub_1001A480+17j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+18h+var_8], eax
		mov	edi, eax

loc_1001A4C6:				; CODE XREF: sub_1001A480+32j
		cmp	dword_1003067C,	0
		jz	short loc_1001A4E7
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+14h]
		jmp	short loc_1001A4F4
; ---------------------------------------------------------------------------

loc_1001A4E7:				; CODE XREF: sub_1001A480+4Dj
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001A4F4:				; CODE XREF: sub_1001A480+65j
		mov	byte ptr [eax+0Fh], 0
		mov	edx, [edi+24h]
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	esi, dword_100315AC
		test	esi, esi
		jz	short loc_1001A56A
		cmp	dword ptr [esi+94h], 0
		jnz	short loc_1001A564
		cmp	dword ptr [esi], 1
		jnz	short loc_1001A564
		mov	edx, [esi+6Ch]
		mov	ebx, [esi+68h]
		mov	eax, [esi+9Ch]
		mov	ecx, [esi+4]
		mov	[edx], ebx
		mov	edx, [esi+68h]
		mov	ebx, [esi+6Ch]
		mov	[edx+4], ebx
		mov	edx, [eax+24h]
		lea	edx, [edx+ecx*8+48h]
		cmp	[edx], edx
		jnz	short loc_1001A54E
		mov	eax, [eax+24h]
		mov	edx, 1
		shl	edx, cl
		not	edx
		and	[eax+68h], edx

loc_1001A54E:				; CODE XREF: sub_1001A480+BDj
		mov	dword ptr [esi+58h], 0
		mov	eax, [edi+24h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	loc_1001A667
; ---------------------------------------------------------------------------

loc_1001A564:				; CODE XREF: sub_1001A480+93j
					; sub_1001A480+98j
		mov	ecx, [edi+24h]
		push	ecx
		jmp	short loc_1001A5CE
; ---------------------------------------------------------------------------

loc_1001A56A:				; CODE XREF: sub_1001A480+8Aj
		mov	ebx, [edi+24h]
		mov	ebp, [ebx+68h]
		test	ebp, ebp
		jnz	short loc_1001A578
		xor	eax, eax
		jmp	short loc_1001A58B
; ---------------------------------------------------------------------------

loc_1001A578:				; CODE XREF: sub_1001A480+F2j
		cmp	ebp, 2
		jnz	short loc_1001A586
		mov	eax, 1
		mov	edi, eax
		jmp	short loc_1001A58D
; ---------------------------------------------------------------------------

loc_1001A586:				; CODE XREF: sub_1001A480+FBj
		mov	eax, 3

loc_1001A58B:				; CODE XREF: sub_1001A480+F6j
		xor	edi, edi

loc_1001A58D:				; CODE XREF: sub_1001A480+104j
		mov	ecx, eax
		cmp	eax, edi
		jl	short loc_1001A5CD
		lea	edx, [ebx+eax*8+48h]

loc_1001A597:				; CODE XREF: sub_1001A480+14Bj
		mov	eax, 1
		shl	eax, cl
		test	ebp, eax
		jz	short loc_1001A5C5
		mov	eax, [edx]
		cmp	eax, edx
		jz	short loc_1001A5C5
		jmp	short loc_1001A5B0
; ---------------------------------------------------------------------------
		align 10h

loc_1001A5B0:				; CODE XREF: sub_1001A480+128j
					; sub_1001A480+143j
		cmp	dword ptr [eax+2Ch], 0
		lea	esi, [eax-68h]
		jz	short loc_1001A60D
		cmp	[esp+18h+var_4], esi
		jz	short loc_1001A60D
		mov	eax, [eax]
		cmp	eax, edx
		jnz	short loc_1001A5B0

loc_1001A5C5:				; CODE XREF: sub_1001A480+120j
					; sub_1001A480+126j
		dec	ecx
		sub	edx, 8
		cmp	ecx, edi
		jge	short loc_1001A597

loc_1001A5CD:				; CODE XREF: sub_1001A480+111j
		push	ebx		; lpCriticalSection

loc_1001A5CE:				; CODE XREF: sub_1001A480+E8j
		call	ds:LeaveCriticalSection
		mov	edx, dword_10032AB4
		cmp	dword ptr [edx+4], 4
		jl	short loc_1001A5ED
		push	offset aPausing	; "pausing"
		call	PR_LogPrint
		add	esp, 4

loc_1001A5ED:				; CODE XREF: sub_1001A480+15Ej
		cmp	dword_1003067C,	0
		jz	short loc_1001A658
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_1001A664
; ---------------------------------------------------------------------------

loc_1001A60D:				; CODE XREF: sub_1001A480+137j
					; sub_1001A480+13Dj
		mov	edx, [esi+6Ch]
		mov	edi, [esi+68h]
		mov	eax, [esi+9Ch]
		mov	ecx, [esi+4]
		mov	[edx], edi
		mov	edx, [esi+68h]
		mov	edi, [esi+6Ch]
		mov	[edx+4], edi
		mov	edx, [eax+24h]
		lea	edx, [edx+ecx*8+48h]
		cmp	[edx], edx
		jnz	short loc_1001A641
		mov	eax, [eax+24h]
		mov	edx, 1
		shl	edx, cl
		not	edx
		and	[eax+68h], edx

loc_1001A641:				; CODE XREF: sub_1001A480+1B0j
		mov	eax, [esp+18h+var_8]
		mov	dword ptr [esi+58h], 0
		mov	ecx, [eax+24h]
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001A667
; ---------------------------------------------------------------------------

loc_1001A658:				; CODE XREF: sub_1001A480+174j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001A664:				; CODE XREF: sub_1001A480+18Bj
		mov	esi, [eax+1Ch]

loc_1001A667:				; CODE XREF: sub_1001A480+DFj
					; sub_1001A480+1D6j
		mov	ecx, dword_10032AB4
		cmp	dword ptr [ecx+4], 4
		jl	short loc_1001A688
		mov	edx, [esi+8Ch]
		push	esi
		push	edx
		push	offset aSwitchingToDP ;	"switching to %d[%p]"
		call	PR_LogPrint
		add	esp, 0Ch

loc_1001A688:				; CODE XREF: sub_1001A480+1F1j
		mov	dword ptr [esi], 2
		cmp	esi, [esp+18h+var_4]
		jz	short loc_1001A69D
		push	esi		; lpTlsValue
		call	sub_10024C90
		add	esp, 4

loc_1001A69D:				; CODE XREF: sub_1001A480+212j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
sub_1001A480	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001A6B0	proc near		; CODE XREF: sub_1001AF70+90p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, eax
		cmp	edi, 3
		jle	short loc_1001A6C0
		mov	edi, 3
		jmp	short loc_1001A6C6
; ---------------------------------------------------------------------------

loc_1001A6C0:				; CODE XREF: sub_1001A6B0+7j
		test	edi, edi
		jns	short loc_1001A6C6
		xor	edi, edi

loc_1001A6C6:				; CODE XREF: sub_1001A6B0+Ej
					; sub_1001A6B0+12j
		push	14Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	short loc_1001A702
		mov	eax, [esp+8+arg_0]
		mov	[esi+10h], eax
		lea	eax, [esi+78h]
		lea	ecx, [esi+40h]
		push	ecx		; lpCriticalSection
		mov	[esi+4], edi
		mov	dword ptr [esi], 2
		mov	[eax], eax
		mov	[esi+7Ch], eax
		call	ds:InitializeCriticalSection
		pop	edi
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001A702:				; CODE XREF: sub_1001A6B0+29j
		pop	edi
		xor	eax, eax
		pop	esi
		retn
sub_1001A6B0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 408. _PR_NativeCreateThread

; =============== S U B	R O U T	I N E =======================================


		public _PR_NativeCreateThread
_PR_NativeCreateThread proc near	; CODE XREF: _PR_CreateThread+C2p
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_C]
		cmp	edi, 3
		jle	short loc_1001A724
		mov	edi, 3
		jmp	short loc_1001A72A
; ---------------------------------------------------------------------------

loc_1001A724:				; CODE XREF: _PR_NativeCreateThread+Bj
		test	edi, edi
		jns	short loc_1001A72A
		xor	edi, edi

loc_1001A72A:				; CODE XREF: _PR_NativeCreateThread+12j
					; _PR_NativeCreateThread+16j
		push	14Ch		; SizeOfElements
		mov	ebx, 1
		push	ebx		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		test	esi, esi
		jz	loc_1001A89B
		lea	eax, [esi+78h]
		lea	ebp, [esi+40h]
		push	ebp		; lpCriticalSection
		mov	[esi+4], edi
		mov	dword ptr [esi+10h], 0
		mov	dword ptr [esi], 2
		mov	[eax], eax
		mov	[esi+7Ch], eax
		call	ds:InitializeCriticalSection
		mov	eax, dword_10032A60
		push	eax
		call	PR_Lock
		mov	ecx, [esp+14h+arg_1C]
		or	ecx, 80h
		mov	[esi+90h], ecx
		mov	eax, dword_10032AB0
		add	eax, ebx
		add	esp, 4
		mov	dword_10032AB0,	eax
		mov	[esi+8Ch], eax
		cmp	[esp+10h+arg_0], ebx
		jnz	short loc_1001A7AD
		or	[esi+90h], ebx
		add	dword_10032B08,	ebx
		jmp	short loc_1001A7B3
; ---------------------------------------------------------------------------

loc_1001A7AD:				; CODE XREF: _PR_NativeCreateThread+8Dj
		add	dword_10032AB8,	ebx

loc_1001A7B3:				; CODE XREF: _PR_NativeCreateThread+9Bj
		mov	edx, dword_10032A60
		push	edx		; lpTlsValue
		call	PR_Unlock
		push	2Ch		; SizeOfElements
		push	ebx		; NumOfElements
		call	PR_Calloc
		add	esp, 0Ch
		mov	[esi+10h], eax
		test	eax, eax
		jnz	short loc_1001A7E4
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		jmp	loc_1001A882
; ---------------------------------------------------------------------------

loc_1001A7E4:				; CODE XREF: _PR_NativeCreateThread+BFj
		mov	edi, [esp+10h+arg_18]
		mov	ebx, [esp+10h+arg_14]
		mov	ecx, [esp+10h+arg_4]
		mov	edx, [esp+10h+arg_8]
		mov	[eax+1Ch], edi
		mov	eax, [esi+10h]
		mov	[eax+24h], esi
		mov	[esi+0Ch], ecx
		mov	[esi+8], edx
		test	ebx, ebx
		jnz	short loc_1001A82D
		mov	eax, dword_10032AF8
		push	eax
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+98h], eax
		test	eax, eax
		jnz	short loc_1001A82D
		mov	ecx, [esi+10h]
		push	ecx		; Memory
		call	PR_Free
		mov	[esi+10h], ebx
		jmp	short loc_1001A87F
; ---------------------------------------------------------------------------

loc_1001A82D:				; CODE XREF: _PR_NativeCreateThread+F5j
					; _PR_NativeCreateThread+10Dj
		mov	edx, [esp+10h+arg_10]
		mov	eax, [esp+10h+arg_C]
		push	edi
		push	ebx
		push	edx
		push	eax
		push	offset loc_10019C30
		push	esi
		mov	dword ptr [esi], 2
		call	sub_10024A40
		add	esp, 18h
		test	eax, eax
		jnz	short loc_1001A858
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001A858:				; CODE XREF: _PR_NativeCreateThread+13Fj
		mov	eax, [esi+98h]
		xor	edi, edi
		cmp	eax, edi
		jz	short loc_1001A873
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[esi+98h], edi

loc_1001A873:				; CODE XREF: _PR_NativeCreateThread+152j
		mov	ecx, [esi+10h]
		push	ecx		; Memory
		call	PR_Free
		mov	[esi+10h], edi

loc_1001A87F:				; CODE XREF: _PR_NativeCreateThread+11Bj
		add	esp, 4

loc_1001A882:				; CODE XREF: _PR_NativeCreateThread+CFj
		push	esi		; lpTlsValue
		call	sub_10019AE0
		add	esp, 4
		push	ebp		; lpCriticalSection
		call	ds:DeleteCriticalSection
		push	esi		; Memory
		call	PR_Free
		add	esp, 4

loc_1001A89B:				; CODE XREF: _PR_NativeCreateThread+31j
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		retn
_PR_NativeCreateThread endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 405. _PR_CreateThread

; =============== S U B	R O U T	I N E =======================================


		public _PR_CreateThread
_PR_CreateThread proc near		; CODE XREF: PR_CreateThreadGCAble+28p
					; sub_10017F60+50p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		mov	eax, [esp+arg_C]
		sub	esp, 8
		push	ebx
		push	ebp
		push	esi
		xor	ebp, ebp
		xor	esi, esi
		push	edi
		cmp	eax, 3
		jle	short loc_1001A8CE
		mov	[esp+18h+arg_C], 3
		jmp	short loc_1001A8D6
; ---------------------------------------------------------------------------

loc_1001A8CE:				; CODE XREF: _PR_CreateThread+12j
		cmp	eax, ebp
		jge	short loc_1001A8D6
		mov	[esp+18h+arg_C], ebp

loc_1001A8D6:				; CODE XREF: _PR_CreateThread+1Cj
					; _PR_CreateThread+20j
		cmp	dword_10031520,	ebp
		jnz	short loc_1001A8E3
		call	PR_Init

loc_1001A8E3:				; CODE XREF: _PR_CreateThread+2Cj
		mov	edi, [esp+18h+arg_1C]
		test	edi, 200h
		jnz	short loc_1001A8F8
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[esp+18h+var_8], eax

loc_1001A8F8:				; CODE XREF: _PR_CreateThread+3Dj
		cmp	dword_10031524,	ebp
		jz	short loc_1001A907
		mov	ebx, 1
		jmp	short loc_1001A919
; ---------------------------------------------------------------------------

loc_1001A907:				; CODE XREF: _PR_CreateThread+4Ej
		mov	ebx, [esp+18h+arg_10]
		cmp	ebx, 1
		jz	short loc_1001A919
		cmp	ebx, 2
		jnz	loc_1001AA77

loc_1001A919:				; CODE XREF: _PR_CreateThread+55j
					; _PR_CreateThread+5Ej
		and	edi, 0FFFFFDFFh
		or	edi, 80h
		cmp	dword_10032A3C,	ebp
		jbe	short loc_1001A952
		mov	eax, dword_10032A5C
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	dword_10032A3C,	ebp
		jnz	short loc_1001A984
		mov	ecx, dword_10032A5C
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_1001A952:				; CODE XREF: _PR_CreateThread+7Bj
		mov	edx, [esp+18h+arg_18]
		mov	eax, [esp+18h+arg_14]
		mov	ecx, [esp+18h+arg_C]
		push	edi
		push	edx
		mov	edx, [esp+20h+arg_8]
		push	eax
		mov	eax, [esp+24h+arg_4]
		push	ebx
		push	ecx
		mov	ecx, [esp+2Ch+arg_0]
		push	edx
		push	eax
		push	ecx
		call	_PR_NativeCreateThread
		add	esp, 20h
		pop	edi
		mov	esi, eax
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001A984:				; CODE XREF: _PR_CreateThread+91j
		mov	esi, dword_10032A50
		mov	edx, [esi+4]
		mov	eax, [esi]
		add	esi, 0FFFFFF98h
		mov	[edx], eax
		mov	ecx, [esi+68h]
		mov	edx, [esi+6Ch]
		mov	[ecx+4], edx
		mov	eax, dword_10032A5C
		mov	ebx, 1
		sub	dword_10032A3C,	ebx
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	ecx, [esp+1Ch+arg_4]
		mov	edx, [esp+1Ch+arg_8]
		lea	eax, [esi+78h]
		mov	[eax], eax
		mov	[esi+7Ch], eax
		mov	eax, edi
		or	eax, 80h
		add	esp, 4
		mov	[esi+2Ch], ebp
		mov	[esi+28h], ebp
		mov	[esi+0ACh], ebp
		mov	[esi+0A4h], ebp
		mov	[esi+14h], ebp
		mov	[esi+0Ch], ecx
		mov	[esi+8], edx
		mov	[esi+90h], eax
		cmp	[esp+18h+arg_0], ebx
		jnz	short loc_1001AA03
		or	eax, ebx
		mov	[esi+90h], eax
		push	offset dword_10032B08
		jmp	short loc_1001AA08
; ---------------------------------------------------------------------------

loc_1001AA03:				; CODE XREF: _PR_CreateThread+142j
		push	offset dword_10032AB8

loc_1001AA08:				; CODE XREF: _PR_CreateThread+151j
		call	PR_AtomicIncrement
		add	esp, 4
		cmp	[esp+18h+arg_14], ebp
		jnz	short loc_1001AA31
		cmp	[esi+98h], ebp
		jnz	short loc_1001AA4A
		mov	eax, dword_10032AF8
		push	eax
		call	PR_NewCondVar
		mov	[esi+98h], eax
		jmp	short loc_1001AA47
; ---------------------------------------------------------------------------

loc_1001AA31:				; CODE XREF: _PR_CreateThread+164j
		mov	eax, [esi+98h]
		cmp	eax, ebp
		jz	short loc_1001AA4A
		push	eax		; Memory
		call	PR_DestroyCondVar
		mov	[esi+98h], ebp

loc_1001AA47:				; CODE XREF: _PR_CreateThread+17Fj
		add	esp, 4

loc_1001AA4A:				; CODE XREF: _PR_CreateThread+16Cj
					; _PR_CreateThread+189j
		mov	eax, [esp+18h+arg_C]
		push	eax
		lea	ecx, [esi+0B0h]
		push	ecx
		mov	[esi+4], eax
		call	sub_100245D0
		push	esi
		mov	dword ptr [esi], 2
		call	sub_1001DF20
		add	esp, 0Ch
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001AA77:				; CODE XREF: _PR_CreateThread+63j
		mov	ebp, [esp+18h+arg_18]
		xor	edi, edi
		cmp	dword_10032A38,	edi
		jbe	short loc_1001AAAA
		mov	edx, dword_10032A5C
		push	edx
		call	PR_Lock
		add	esp, 4
		cmp	dword_10032A38,	edi
		jnz	short loc_1001AADF
		mov	eax, dword_10032A5C
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_1001AAAA:				; CODE XREF: _PR_CreateThread+1D3j
					; _PR_CreateThread+287j
		mov	ebx, [esp+18h+arg_8]
		mov	edi, [esp+18h+arg_4]
		push	ebx
		push	edi
		push	ebp
		call	sub_10024880
		mov	esi, eax
		add	esp, 0Ch
		test	esi, esi
		jnz	loc_1001ABBD
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001AADF:				; CODE XREF: _PR_CreateThread+1EAj
		mov	eax, dword_10032A40
		cmp	eax, offset dword_10032A40
		jz	short loc_1001AB27
		jmp	short loc_1001AAF0
; ---------------------------------------------------------------------------
		align 10h

loc_1001AAF0:				; CODE XREF: _PR_CreateThread+23Bj
					; _PR_CreateThread+25Cj
		mov	ecx, [eax-58h]
		lea	esi, [eax-68h]
		cmp	[ecx+1Ch], ebp
		jb	short loc_1001AB03
		cmp	[esi+94h], edi
		jz	short loc_1001AB10

loc_1001AB03:				; CODE XREF: _PR_CreateThread+249j
		mov	eax, [eax]
		xor	esi, esi
		cmp	eax, offset dword_10032A40
		jnz	short loc_1001AAF0
		jmp	short loc_1001AB27
; ---------------------------------------------------------------------------

loc_1001AB10:				; CODE XREF: _PR_CreateThread+251j
		mov	edx, [esi+6Ch]
		mov	eax, [esi+68h]
		mov	[edx], eax
		mov	ecx, [esi+68h]
		mov	edx, [esi+6Ch]
		mov	[ecx+4], edx
		dec	dword_10032A38

loc_1001AB27:				; CODE XREF: _PR_CreateThread+239j
					; _PR_CreateThread+25Ej
		mov	eax, dword_10032A5C
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	esi, edi
		jz	loc_1001AAAA
		mov	ecx, [esp+18h+arg_4]
		mov	edx, [esp+18h+arg_8]
		lea	eax, [esi+78h]
		mov	[eax], eax
		mov	[esi+7Ch], eax
		mov	eax, [esp+18h+arg_C]
		mov	[esi+2Ch], edi
		mov	[esi+28h], edi
		mov	[esi+0ACh], edi
		mov	[esi+0A4h], edi
		mov	[esi+14h], edi
		mov	[esi+0Ch], ecx
		mov	[esi+8], edx
		mov	[esi+4], eax
		cmp	[esp+18h+arg_14], edi
		jnz	short loc_1001AB9B
		cmp	[esi+98h], edi
		jnz	loc_1001ACAE
		mov	ecx, dword_10032AF8
		push	ecx
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+98h], eax
		jmp	loc_1001ACAE
; ---------------------------------------------------------------------------

loc_1001AB9B:				; CODE XREF: _PR_CreateThread+2C3j
		mov	eax, [esi+98h]
		cmp	eax, edi
		jz	loc_1001ACAE
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	[esi+98h], edi
		jmp	loc_1001ACAE
; ---------------------------------------------------------------------------

loc_1001ABBD:				; CODE XREF: _PR_CreateThread+211j
		mov	edx, [esp+18h+arg_C]
		xor	ebp, ebp
		lea	eax, [esi+78h]
		push	esi
		mov	[esi+0A0h], ebp
		mov	[esi+20h], ebp
		mov	[esi+24h], ebp
		mov	[esi+10h], ebp
		mov	[esi+4], edx
		mov	[esi+0Ch], edi
		mov	[esi+8], ebx
		mov	[eax], eax
		mov	[esi+7Ch], eax
		call	sub_100244D0
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001AC26
		cmp	dword ptr [esi+0A0h], 1
		jnz	short loc_1001AC05
		mov	eax, [esi+10h]
		push	eax		; Memory
		call	sub_10019870
		jmp	short loc_1001AC0B
; ---------------------------------------------------------------------------

loc_1001AC05:				; CODE XREF: _PR_CreateThread+348j
		push	esi		; Memory
		call	PR_Free

loc_1001AC0B:				; CODE XREF: _PR_CreateThread+353j
		add	esp, 4
		push	ebp
		push	0FFFFE8AAh
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001AC26:				; CODE XREF: _PR_CreateThread+33Fj
		lea	edi, [esi+40h]
		push	edi		; lpCriticalSection
		call	ds:InitializeCriticalSection
		lea	ecx, [esp+18h+var_4]
		push	ecx
		push	offset loc_10019E30
		push	ebp
		push	esi
		call	sub_10024C20
		add	esp, 10h
		cmp	[esp+18h+var_4], ebp
		jnz	short loc_1001AC8F

loc_1001AC4A:				; CODE XREF: _PR_CreateThread+3FCj
		push	edi		; lpCriticalSection
		call	ds:DeleteCriticalSection
		cmp	dword ptr [esi+0A0h], 1
		jnz	short loc_1001AC70
		mov	edx, [esi+10h]
		push	edx		; Memory
		call	sub_10019870
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001AC70:				; CODE XREF: _PR_CreateThread+3A8j
		mov	eax, [esi+24h]
		push	eax		; Memory
		call	PR_Free
		push	esi		; Memory
		mov	[esi+24h], ebp
		call	PR_Free
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001AC8F:				; CODE XREF: _PR_CreateThread+398j
		cmp	[esp+18h+arg_14], ebp
		jnz	short loc_1001ACAE
		mov	ecx, dword_10032AF8
		push	ecx
		call	PR_NewCondVar
		add	esp, 4
		mov	[esi+98h], eax
		cmp	eax, ebp
		jz	short loc_1001AC4A

loc_1001ACAE:				; CODE XREF: _PR_CreateThread+2CBj
					; _PR_CreateThread+2E6j ...
		mov	ecx, dword_10032A60
		push	ecx
		call	PR_Lock
		mov	edx, [esp+1Ch+arg_1C]
		mov	[esi+90h], edx
		mov	eax, dword_10032AB0
		mov	edi, 1
		add	eax, edi
		add	esp, 4
		mov	dword_10032AB0,	eax
		mov	[esi+8Ch], eax
		cmp	[esp+18h+arg_0], edi
		jnz	short loc_1001ACF2
		or	[esi+90h], edi
		add	dword_10032B08,	edi
		jmp	short loc_1001ACF8
; ---------------------------------------------------------------------------

loc_1001ACF2:				; CODE XREF: _PR_CreateThread+432j
		add	dword_10032AB8,	edi

loc_1001ACF8:				; CODE XREF: _PR_CreateThread+440j
		mov	[esi], edi
		mov	eax, dword_10032A60
		push	eax		; lpTlsValue
		call	PR_Unlock
		mov	ebp, 200h
		add	esp, 4
		test	[esi+90h], ebp
		jnz	short loc_1001AD29
		mov	ecx, [esp+18h+var_8]
		test	byte ptr [ecx+90h], 80h
		jz	short loc_1001AD29
		call	_PR_GetPrimordialCPU
		jmp	short loc_1001AD56
; ---------------------------------------------------------------------------

loc_1001AD29:				; CODE XREF: _PR_CreateThread+463j
					; _PR_CreateThread+470j
		cmp	dword_1003067C,	0
		jz	short loc_1001AD49
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_1001AD56
; ---------------------------------------------------------------------------

loc_1001AD49:				; CODE XREF: _PR_CreateThread+480j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001AD56:				; CODE XREF: _PR_CreateThread+477j
					; _PR_CreateThread+497j
		mov	[esi+9Ch], eax
		test	[esi+90h], ebp
		jnz	loc_1001AE4A
		mov	eax, [esp+18h+var_8]
		test	byte ptr [eax+90h], 80h
		jnz	loc_1001AE4A
		cmp	dword_1003067C,	0
		jz	short loc_1001AD9A
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	ebx, [eax+10h]
		jmp	short loc_1001ADA9
; ---------------------------------------------------------------------------

loc_1001AD9A:				; CODE XREF: _PR_CreateThread+4D0j
		mov	ecx, dwTlsIndex
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	ebx, eax

loc_1001ADA9:				; CODE XREF: _PR_CreateThread+4E8j
		cmp	dword_1003067C,	0
		jz	short loc_1001ADC9
		mov	edx, large fs:2Ch
		mov	eax, TlsIndex
		mov	ecx, [edx+eax*4]
		mov	[ecx+10h], edi
		jmp	short loc_1001ADD7
; ---------------------------------------------------------------------------

loc_1001ADC9:				; CODE XREF: _PR_CreateThread+500j
		mov	edx, dwTlsIndex
		push	edi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001ADD7:				; CODE XREF: _PR_CreateThread+517j
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esi+9Ch]
		mov	ebp, [eax+24h]
		mov	edx, [esp+18h+arg_C]
		lea	ebp, [ebp+edx*8+48h]
		mov	[esi+68h], ebp
		mov	ebp, [eax+24h]
		mov	ebp, [ebp+edx*8+4Ch]
		lea	ecx, [esi+68h]
		mov	[esi+6Ch], ebp
		mov	eax, [eax+24h]
		mov	eax, [eax+edx*8+4Ch]
		mov	[eax], ecx
		mov	eax, [esi+9Ch]
		mov	eax, [eax+24h]
		mov	[eax+edx*8+4Ch], ecx
		mov	ecx, [esi+9Ch]
		mov	eax, [ecx+24h]
		mov	ecx, edx
		mov	ebp, edi
		shl	ebp, cl
		or	[eax+68h], ebp
		mov	edx, [esi+9Ch]
		mov	[esi+58h], edi
		mov	eax, [edx+24h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ebp, 200h
		jmp	short loc_1001AE4E
; ---------------------------------------------------------------------------

loc_1001AE4A:				; CODE XREF: _PR_CreateThread+4B2j
					; _PR_CreateThread+4C3j
		mov	ebx, [esp+18h+arg_C]

loc_1001AE4E:				; CODE XREF: _PR_CreateThread+598j
		test	[esi+90h], ebp
		jz	short loc_1001AE5A
		push	0
		jmp	short loc_1001AE68
; ---------------------------------------------------------------------------

loc_1001AE5A:				; CODE XREF: _PR_CreateThread+5A4j
		mov	ecx, [esp+18h+var_8]
		test	byte ptr [ecx+90h], 80h
		jz	short loc_1001AE70
		push	esi

loc_1001AE68:				; CODE XREF: _PR_CreateThread+5A8j
		call	sub_1001DF20
		add	esp, 4

loc_1001AE70:				; CODE XREF: _PR_CreateThread+5B5j
		test	[esi+90h], ebp
		jnz	loc_1001AF2F
		mov	edx, [esp+18h+var_8]
		test	byte ptr [edx+90h], 80h
		jnz	loc_1001AF2F
		test	ebx, ebx
		jnz	short loc_1001AEF9
		cmp	dword_1003067C,	ebx
		jz	short loc_1001AEB0
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+14h]
		jmp	short loc_1001AEBC
; ---------------------------------------------------------------------------

loc_1001AEB0:				; CODE XREF: _PR_CreateThread+5E7j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001AEBC:				; CODE XREF: _PR_CreateThread+5FEj
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1001AEF9
		cmp	dword_1003067C,	0
		jz	short loc_1001AEE3
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	eax, [eax+14h]
		jmp	short loc_1001AEF0
; ---------------------------------------------------------------------------

loc_1001AEE3:				; CODE XREF: _PR_CreateThread+619j
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001AEF0:				; CODE XREF: _PR_CreateThread+631j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_1001AEF9:				; CODE XREF: _PR_CreateThread+5DFj
					; _PR_CreateThread+610j
		cmp	dword_1003067C,	0
		jz	short loc_1001AF21
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		mov	[ecx+10h], ebx
		pop	ebx
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1001AF21:				; CODE XREF: _PR_CreateThread+650j
		mov	edx, dwTlsIndex
		push	ebx		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001AF2F:				; CODE XREF: _PR_CreateThread+5C6j
					; _PR_CreateThread+5D7j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 8
		retn
_PR_CreateThread endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  71. PR_CreateThread

; =============== S U B	R O U T	I N E =======================================


		public PR_CreateThread
PR_CreateThread	proc near		; CODE XREF: sub_100015F0+57p
					; PR_CreateAlarm+5Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	eax, [esp+arg_18]
		mov	ecx, [esp+arg_14]
		mov	edx, [esp+arg_10]
		push	0
		push	eax
		mov	eax, [esp+8+arg_C]
		push	ecx
		mov	ecx, [esp+0Ch+arg_8]
		push	edx
		mov	edx, [esp+10h+arg_4]
		push	eax
		mov	eax, [esp+14h+arg_0]
		push	ecx
		push	edx
		push	eax
		call	_PR_CreateThread
		add	esp, 20h
		retn
PR_CreateThread	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001AF70	proc near		; CODE XREF: PR_AssertCurrentThreadOwnsLock_0+35p
					; StartAddress+3Dp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, TlsIndex
		push	esi
		xor	esi, esi
		cmp	dword_1003067C,	esi
		jz	short loc_1001AF94
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	eax, [ecx+8]
		jmp	short loc_1001AFA1
; ---------------------------------------------------------------------------

loc_1001AF94:				; CODE XREF: sub_1001AF70+11j
		mov	edx, dword_100329F0
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001AFA1:				; CODE XREF: sub_1001AF70+22j
		cmp	eax, esi
		jnz	loc_1001B263
		push	ebp
		mov	ebp, ds:TlsSetValue
		cmp	dword_1003067C,	esi
		jz	short loc_1001AFC9
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	[ecx+8], esi
		jmp	short loc_1001AFD3
; ---------------------------------------------------------------------------

loc_1001AFC9:				; CODE XREF: sub_1001AF70+46j
		mov	edx, dword_100329F0
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ebp ; TlsSetValue

loc_1001AFD3:				; CODE XREF: sub_1001AF70+57j
		cmp	dword_1003067C,	esi
		jz	short loc_1001AFEC
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	[ecx+14h], esi
		jmp	short loc_1001AFF6
; ---------------------------------------------------------------------------

loc_1001AFEC:				; CODE XREF: sub_1001AF70+69j
		mov	edx, dword_100329EC
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ebp ; TlsSetValue

loc_1001AFF6:				; CODE XREF: sub_1001AF70+7Aj
		mov	esi, [esp+10h+arg_8]
		mov	eax, [esp+10h+arg_4]
		push	edi
		push	esi
		call	sub_1001A6B0
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jz	loc_1001B25F
		cmp	dword_1003067C,	0
		jz	short loc_1001B02C
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	[ecx+8], edi
		jmp	short loc_1001B036
; ---------------------------------------------------------------------------

loc_1001B02C:				; CODE XREF: sub_1001AF70+A9j
		mov	edx, dword_100329F0
		push	edi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ebp ; TlsSetValue

loc_1001B036:				; CODE XREF: sub_1001AF70+BAj
		mov	eax, [esp+14h+arg_C]
		or	eax, 84h
		mov	[edi+90h], eax
		mov	ebp, 1
		test	esi, esi
		jnz	short loc_1001B06D
		push	2Ch		; SizeOfElements
		push	ebp		; NumOfElements
		call	PR_Calloc
		add	esp, 8
		mov	[edi+10h], eax
		test	eax, eax
		jnz	short loc_1001B066
		lea	ecx, [edi+40h]
		push	ecx
		jmp	short loc_1001B09A
; ---------------------------------------------------------------------------

loc_1001B066:				; CODE XREF: sub_1001AF70+EEj
		mov	dword ptr [eax+1Ch], 0

loc_1001B06D:				; CODE XREF: sub_1001AF70+DCj
		lea	eax, [edi+68h]
		push	edi
		mov	[eax], eax
		mov	[edi+6Ch], eax
		call	sub_100244D0
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001B0B1
		mov	edx, [edi+10h]
		push	edx		; Memory
		call	PR_Free
		add	esp, 4
		lea	eax, [edi+40h]
		mov	dword ptr [edi+10h], 0
		push	eax		; lpCriticalSection

loc_1001B09A:				; CODE XREF: sub_1001AF70+F4j
		call	ds:DeleteCriticalSection
		push	edi		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	ebp
		pop	esi
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001B0B1:				; CODE XREF: sub_1001AF70+111j
		cmp	dword_1003067C,	0
		jz	short loc_1001B0D0
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebx*4]
		mov	dword ptr [edx+14h], 0
		jmp	short loc_1001B0DE
; ---------------------------------------------------------------------------

loc_1001B0D0:				; CODE XREF: sub_1001AF70+148j
		mov	eax, dword_100329EC
		push	0		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001B0DE:				; CODE XREF: sub_1001AF70+15Ej
		cmp	dword_1003067C,	0
		jz	short loc_1001B0F9
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebx*4]
		mov	eax, [edx+14h]
		jmp	short loc_1001B105
; ---------------------------------------------------------------------------

loc_1001B0F9:				; CODE XREF: sub_1001AF70+175j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001B105:				; CODE XREF: sub_1001AF70+187j
		test	eax, eax
		jz	short loc_1001B17A
		cmp	dword_1003067C,	0
		jz	short loc_1001B124
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebx*4]
		mov	esi, [edx+10h]
		jmp	short loc_1001B132
; ---------------------------------------------------------------------------

loc_1001B124:				; CODE XREF: sub_1001AF70+1A0j
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	esi, eax

loc_1001B132:				; CODE XREF: sub_1001AF70+1B2j
		cmp	dword_1003067C,	0
		jz	short loc_1001B15C
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebx*4]
		mov	ecx, dword_10032A60
		push	ecx
		mov	[edx+10h], ebp
		call	PR_Lock
		add	esp, 4
		jmp	short loc_1001B17E
; ---------------------------------------------------------------------------

loc_1001B15C:				; CODE XREF: sub_1001AF70+1C9j
		mov	eax, dwTlsIndex
		push	ebp		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue
		mov	ecx, dword_10032A60
		push	ecx
		call	PR_Lock
		add	esp, 4
		jmp	short loc_1001B17E
; ---------------------------------------------------------------------------

loc_1001B17A:				; CODE XREF: sub_1001AF70+197j
		mov	esi, [esp+14h+var_4]

loc_1001B17E:				; CODE XREF: sub_1001AF70+1EAj
					; sub_1001AF70+208j
		cmp	[esp+14h+arg_0], ebp
		jnz	short loc_1001B192
		or	[edi+90h], ebp
		add	dword_10032B08,	ebp
		jmp	short loc_1001B198
; ---------------------------------------------------------------------------

loc_1001B192:				; CODE XREF: sub_1001AF70+212j
		add	dword_10032AB8,	ebp

loc_1001B198:				; CODE XREF: sub_1001AF70+220j
		cmp	dword_1003067C,	0
		mov	ebp, ds:TlsGetValue
		jz	short loc_1001B1B9
		mov	edx, large fs:2Ch
		mov	eax, [edx+ebx*4]
		mov	eax, [eax+14h]
		jmp	short loc_1001B1C2
; ---------------------------------------------------------------------------

loc_1001B1B9:				; CODE XREF: sub_1001AF70+235j
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ebp ; TlsGetValue

loc_1001B1C2:				; CODE XREF: sub_1001AF70+247j
		test	eax, eax
		jz	loc_1001B25F
		mov	edx, dword_10032A60
		push	edx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	esi, esi
		jnz	short loc_1001B231
		cmp	dword_1003067C,	esi
		jz	short loc_1001B1F6
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	eax, [ecx+14h]
		jmp	short loc_1001B1FF
; ---------------------------------------------------------------------------

loc_1001B1F6:				; CODE XREF: sub_1001AF70+273j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ebp ; TlsGetValue

loc_1001B1FF:				; CODE XREF: sub_1001AF70+284j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1001B231
		cmp	dword_1003067C,	0
		jz	short loc_1001B21F
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	eax, [ecx+14h]
		jmp	short loc_1001B228
; ---------------------------------------------------------------------------

loc_1001B21F:				; CODE XREF: sub_1001AF70+29Cj
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ebp ; TlsGetValue

loc_1001B228:				; CODE XREF: sub_1001AF70+2ADj
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_1001B231:				; CODE XREF: sub_1001AF70+26Bj
					; sub_1001AF70+293j
		cmp	dword_1003067C,	0
		jz	short loc_1001B251
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	eax, edi
		pop	edi
		pop	ebp
		mov	[ecx+10h], esi
		pop	esi
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001B251:				; CODE XREF: sub_1001AF70+2C8j
		mov	edx, dwTlsIndex
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001B25F:				; CODE XREF: sub_1001AF70+9Cj
					; sub_1001AF70+254j
		mov	eax, edi
		pop	edi
		pop	ebp

loc_1001B263:				; CODE XREF: sub_1001AF70+33j
		pop	esi
		pop	ebx
		pop	ecx
		retn
sub_1001AF70	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  27. PR_AttachThread

; =============== S U B	R O U T	I N E =======================================


		public PR_AttachThread
PR_AttachThread	proc near		; DATA XREF: .rdata:off_1002C7C8o
		jmp	PR_GetCurrentThread
PR_AttachThread	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001B280	proc near		; CODE XREF: sub_10024DD0+4Cp
		push	esi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, eax
		test	byte ptr [esi+90h], 8
		jnz	loc_1001B31D
		push	esi
		call	sub_10016920
		mov	eax, [esi+24h]
		push	eax		; Memory
		call	PR_Free
		push	esi		; lpTlsValue
		mov	dword ptr [esi+24h], 0
		call	sub_10019AE0
		push	esi
		call	sub_100246E0
		add	esp, 10h
		cmp	dword_1003067C,	0
		jz	short loc_1001B2DF
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		mov	dword ptr [eax+8], 0
		jmp	short loc_1001B2EE
; ---------------------------------------------------------------------------

loc_1001B2DF:				; CODE XREF: sub_1001B280+41j
		mov	ecx, dword_100329F0
		push	0		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001B2EE:				; CODE XREF: sub_1001B280+5Dj
		cmp	dword ptr [esi+0A0h], 0
		jnz	short loc_1001B30A
		mov	edx, [esi+10h]
		push	edx		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword ptr [esi+10h], 0

loc_1001B30A:				; CODE XREF: sub_1001B280+75j
		lea	eax, [esi+40h]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		push	esi		; Memory
		call	PR_Free
		add	esp, 4

loc_1001B31D:				; CODE XREF: sub_1001B280+Fj
		pop	esi
		retn
sub_1001B280	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 339. PR_SetThreadPriority

; =============== S U B	R O U T	I N E =======================================


		public PR_SetThreadPriority
PR_SetThreadPriority proc near		; DATA XREF: .rdata:off_1002C7C8o

lpTlsValue	= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		cmp	eax, 3
		jle	short loc_1001B330
		mov	eax, 3
		jmp	short loc_1001B336
; ---------------------------------------------------------------------------

loc_1001B330:				; CODE XREF: PR_SetThreadPriority+7j
		test	eax, eax
		jns	short loc_1001B336
		xor	eax, eax

loc_1001B336:				; CODE XREF: PR_SetThreadPriority+Ej
					; PR_SetThreadPriority+12j
		mov	ecx, [esp+lpTlsValue]
		test	byte ptr [ecx+90h], 80h
		mov	[esp+arg_4], eax ; int
		jz	short loc_1001B359
		mov	[ecx+4], eax
		add	ecx, 0B0h
		mov	[esp+lpTlsValue], ecx
		jmp	sub_100245D0
; ---------------------------------------------------------------------------

loc_1001B359:				; CODE XREF: PR_SetThreadPriority+25j
		mov	[esp+lpTlsValue], ecx ;	lpTlsValue
		jmp	sub_1001A160
PR_SetThreadPriority endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 322. PR_SetCurrentThreadName

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SetCurrentThreadName(void *Src)
		public PR_SetCurrentThreadName
PR_SetCurrentThreadName	proc near	; DATA XREF: .rdata:off_1002C7C8o

Src		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+Src]
		test	ebx, ebx
		jnz	short loc_1001B38C
		push	ebx
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001B38C:				; CODE XREF: PR_SetCurrentThreadName+7j
		push	edi
		call	PR_GetCurrentThread
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1001B39E
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001B39E:				; CODE XREF: PR_SetCurrentThreadName+26j
		mov	eax, [edi+3Ch]
		push	eax		; Memory
		call	PR_Free
		mov	eax, ebx
		add	esp, 4
		lea	edx, [eax+1]
		nop

loc_1001B3B0:				; CODE XREF: PR_SetCurrentThreadName+45j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001B3B0
		sub	eax, edx
		push	esi
		lea	esi, [eax+1]
		push	esi		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[edi+3Ch], eax
		test	eax, eax
		jnz	short loc_1001B3D4
		pop	esi
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001B3D4:				; CODE XREF: PR_SetCurrentThreadName+5Bj
		push	esi		; Size
		push	ebx		; Src
		push	eax		; Dst
		call	memcpy
		mov	ecx, [edi+3Ch]
		push	ecx
		call	sub_10024650
		add	esp, 10h
		pop	esi
		pop	edi
		xor	eax, eax
		pop	ebx
		retn
PR_SetCurrentThreadName	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 194. PR_GetThreadName

; =============== S U B	R O U T	I N E =======================================


		public PR_GetThreadName
PR_GetThreadName proc near		; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jnz	short loc_1001B3F9
		retn
; ---------------------------------------------------------------------------

loc_1001B3F9:				; CODE XREF: PR_GetThreadName+6j
		mov	eax, [eax+3Ch]
		retn
PR_GetThreadName endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 353. PR_SuspendAll

; =============== S U B	R O U T	I N E =======================================


		public PR_SuspendAll
PR_SuspendAll	proc near		; DATA XREF: .rdata:off_1002C7C8o

var_10		= dword	ptr -10h
lpTlsValue	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 10h
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	edi, eax
		mov	eax, dword_10032A60
		push	eax
		mov	[esp+1Ch+var_8], edi
		call	PR_Lock
		add	esp, 4
		mov	dword_100315A8,	1
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, off_100302B0
		mov	dword_100315AC,	eax
		mov	[esp+18h+var_10], esi
		cmp	esi, offset off_100302B0
		jz	loc_1001B6C5
		push	ebx
		mov	ebx, ds:LeaveCriticalSection
		push	ebp
		jmp	short loc_1001B456
; ---------------------------------------------------------------------------

loc_1001B452:				; CODE XREF: PR_SuspendAll+2BDj
		mov	esi, [esp+20h+var_10]

loc_1001B456:				; CODE XREF: PR_SuspendAll+50j
		lea	ecx, [esi-60h]
		cmp	edi, ecx
		jz	loc_1001B6AD
		test	dword ptr [esi+30h], 400h
		jz	loc_1001B6AD
		add	esi, 0FFFFFFA0h
		call	PR_AssertCurrentThreadOwnsLock_0
		test	byte ptr [eax+90h], 80h
		mov	[esp+20h+var_4], eax
		jnz	short loc_1001B4EB
		cmp	dword_1003067C,	0
		jz	short loc_1001B4A7
		mov	edx, TlsIndex
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edx*4]
		mov	edx, [ecx+10h]
		mov	[esp+20h+lpTlsValue], edx
		jmp	short loc_1001B4B7
; ---------------------------------------------------------------------------

loc_1001B4A7:				; CODE XREF: PR_SuspendAll+8Aj
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+20h+lpTlsValue], eax

loc_1001B4B7:				; CODE XREF: PR_SuspendAll+A5j
		cmp	dword_1003067C,	0
		jz	short loc_1001B4DC
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	dword ptr [eax+10h], 1
		jmp	short loc_1001B4EB
; ---------------------------------------------------------------------------

loc_1001B4DC:				; CODE XREF: PR_SuspendAll+BEj
		mov	ecx, dwTlsIndex
		push	1		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001B4EB:				; CODE XREF: PR_SuspendAll+81j
					; PR_SuspendAll+DAj
		mov	edi, ds:EnterCriticalSection
		lea	ebp, [esi+40h]
		push	ebp		; lpCriticalSection
		call	edi ; EnterCriticalSection
		mov	eax, [esi]
		dec	eax
		cmp	eax, 5		; switch 6 cases
		ja	loc_1001B5F2	; jumptable 1001B503 default case
		jmp	ds:off_1001B700[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001B50A:				; CODE XREF: PR_SuspendAll+103j
					; DATA XREF: .text:off_1001B700o
		test	byte ptr [esi+90h], 80h	; jumptable 1001B503 case 0
		jnz	loc_1001B5CF
		mov	edx, [esi+9Ch]
		mov	eax, [edx+24h]
		push	eax		; lpCriticalSection
		call	edi ; EnterCriticalSection
		mov	eax, [esi+6Ch]
		mov	ebx, [esi+68h]
		mov	edx, [esi+9Ch]
		mov	ecx, [esi+4]
		lea	edi, [esi+68h]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	ebx, [esi+6Ch]
		mov	[eax+4], ebx
		mov	eax, [edx+24h]
		lea	eax, [eax+ecx*8+48h]
		cmp	[eax], eax
		jnz	short loc_1001B559
		mov	edx, [edx+24h]
		mov	eax, 1
		shl	eax, cl
		not	eax
		and	[edx+68h], eax

loc_1001B559:				; CODE XREF: PR_SuspendAll+148j
		mov	ecx, [esi+9Ch]
		mov	ebx, ds:LeaveCriticalSection
		mov	dword ptr [esi+58h], 0
		mov	edx, [ecx+24h]
		push	edx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 30h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esi+9Ch]
		mov	dword ptr [esi+58h], 8
		mov	edx, [eax+24h]
		sub	edx, 0FFFFFF80h
		mov	[edi], edx
		mov	ecx, [eax+24h]
		mov	edx, [ecx+84h]
		mov	[esi+6Ch], edx
		mov	eax, [eax+24h]
		mov	ecx, [eax+84h]
		mov	[ecx], edi
		mov	edx, [esi+9Ch]
		mov	eax, [edx+24h]
		mov	[eax+84h], edi
		mov	ecx, [esi+9Ch]
		mov	edx, [ecx+24h]
		add	edx, 30h
		push	edx		; lpCriticalSection
		call	ebx ; LeaveCriticalSection

loc_1001B5CF:				; CODE XREF: PR_SuspendAll+111j
		mov	dword ptr [esi], 7
		jmp	short loc_1001B5F7 ; jumptable 1001B503	case 1
; ---------------------------------------------------------------------------

loc_1001B5D7:				; CODE XREF: PR_SuspendAll+103j
					; DATA XREF: .text:off_1001B700o
		test	byte ptr [esi+90h], 80h	; jumptable 1001B503 cases 2,3,5
		jz	short loc_1001B5E9
		push	esi
		call	sub_100249C0
		add	esp, 4

loc_1001B5E9:				; CODE XREF: PR_SuspendAll+1DEj
		or	dword ptr [esi+90h], 40h
		jmp	short loc_1001B5F7 ; jumptable 1001B503	case 1
; ---------------------------------------------------------------------------

loc_1001B5F2:				; CODE XREF: PR_SuspendAll+FDj
					; PR_SuspendAll+103j
					; DATA XREF: ...
		call	PR_Abort	; jumptable 1001B503 default case

loc_1001B5F7:				; CODE XREF: PR_SuspendAll+103j
					; PR_SuspendAll+1D5j ...
		push	ebp		; jumptable 1001B503 case 1
		call	ebx ; LeaveCriticalSection
		mov	eax, [esp+20h+var_4]
		test	byte ptr [eax+90h], 80h
		jnz	loc_1001B6A9
		mov	esi, [esp+20h+lpTlsValue]
		test	esi, esi
		jnz	short loc_1001B67C
		cmp	dword_1003067C,	esi
		jz	short loc_1001B633
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		mov	eax, [eax+14h]
		jmp	short loc_1001B640
; ---------------------------------------------------------------------------

loc_1001B633:				; CODE XREF: PR_SuspendAll+219j
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001B640:				; CODE XREF: PR_SuspendAll+231j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1001B67C
		cmp	dword_1003067C,	0
		jz	short loc_1001B666
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_1001B673
; ---------------------------------------------------------------------------

loc_1001B666:				; CODE XREF: PR_SuspendAll+24Dj
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001B673:				; CODE XREF: PR_SuspendAll+264j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_1001B67C:				; CODE XREF: PR_SuspendAll+211j
					; PR_SuspendAll+244j
		cmp	dword_1003067C,	0
		jz	short loc_1001B69C
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	[edx+10h], esi
		jmp	short loc_1001B6A9
; ---------------------------------------------------------------------------

loc_1001B69C:				; CODE XREF: PR_SuspendAll+283j
		mov	eax, dwTlsIndex
		push	esi		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001B6A9:				; CODE XREF: PR_SuspendAll+205j
					; PR_SuspendAll+29Aj
		mov	esi, [esp+20h+var_10]

loc_1001B6AD:				; CODE XREF: PR_SuspendAll+5Bj
					; PR_SuspendAll+68j
		mov	esi, [esi]
		mov	edi, [esp+20h+var_8]
		mov	[esp+20h+var_10], esi
		cmp	esi, offset off_100302B0
		jnz	loc_1001B452
		pop	ebp
		pop	ebx

loc_1001B6C5:				; CODE XREF: PR_SuspendAll+42j
		mov	esi, off_100302B8
		cmp	esi, offset off_100302B8
		jz	short loc_1001B6F9

loc_1001B6D3:				; CODE XREF: PR_SuspendAll+2F7j
		lea	ecx, [esi-60h]
		cmp	edi, ecx
		jz	short loc_1001B6EF
		test	dword ptr [esi+30h], 400h
		jz	short loc_1001B6EF
		lea	eax, [esi-60h]
		push	eax
		call	sub_100249C0
		add	esp, 4

loc_1001B6EF:				; CODE XREF: PR_SuspendAll+2D8j
					; PR_SuspendAll+2E1j
		mov	esi, [esi]
		cmp	esi, offset off_100302B8
		jnz	short loc_1001B6D3

loc_1001B6F9:				; CODE XREF: PR_SuspendAll+2D1j
		pop	edi
		pop	esi
		add	esp, 10h
		retn
PR_SuspendAll	endp

; ---------------------------------------------------------------------------
		align 10h
off_1001B700	dd offset loc_1001B50A	; DATA XREF: PR_SuspendAll+103r
		dd offset loc_1001B5F7	; jump table for switch	statement
		dd offset loc_1001B5D7
		dd offset loc_1001B5D7
		dd offset loc_1001B5F2
		dd offset loc_1001B5D7
		align 10h
; Exported entry 308. PR_ResumeAll

; =============== S U B	R O U T	I N E =======================================


		public PR_ResumeAll
PR_ResumeAll	proc near		; DATA XREF: .rdata:off_1002C7C8o

var_C		= dword	ptr -0Ch
lpTlsValue	= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 0Ch
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	esi, off_100302B0
		mov	edi, eax
		mov	[esp+14h+var_4], edi
		cmp	esi, offset off_100302B0
		jz	loc_1001B9EC
		push	ebx
		push	ebp

loc_1001B744:				; CODE XREF: PR_ResumeAll+2C4j
		lea	eax, [esi-60h]
		cmp	edi, eax
		jz	loc_1001B9D8
		test	dword ptr [esi+30h], 400h
		jz	loc_1001B9D8
		call	PR_AssertCurrentThreadOwnsLock_0
		test	byte ptr [eax+90h], 80h
		mov	[esp+1Ch+var_C], eax
		jnz	short loc_1001B7D6
		cmp	dword_1003067C,	0
		jz	short loc_1001B793
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		mov	ecx, [eax+10h]
		mov	[esp+1Ch+lpTlsValue], ecx
		jmp	short loc_1001B7A4
; ---------------------------------------------------------------------------

loc_1001B793:				; CODE XREF: PR_ResumeAll+55j
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+1Ch+lpTlsValue], eax

loc_1001B7A4:				; CODE XREF: PR_ResumeAll+71j
		cmp	dword_1003067C,	0
		jz	short loc_1001B7C8
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	dword ptr [edx+10h], 1
		jmp	short loc_1001B7D6
; ---------------------------------------------------------------------------

loc_1001B7C8:				; CODE XREF: PR_ResumeAll+8Bj
		mov	eax, dwTlsIndex
		push	1		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001B7D6:				; CODE XREF: PR_ResumeAll+4Cj
					; PR_ResumeAll+A6j
		mov	ebp, ds:EnterCriticalSection
		lea	ebx, [esi-20h]
		push	ebx		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	eax, [esi-60h]
		dec	eax
		cmp	eax, 6		; switch 7 cases
		ja	loc_1001B91D	; jumptable 1001B7EF default case
		jmp	ds:off_1001BA48[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1001B7F6:				; CODE XREF: PR_ResumeAll+CFj
					; DATA XREF: .text:off_1001BA48o
		and	dword ptr [esi+30h], 0FFFFFFBFh	; jumptable 1001B7EF case 6
		test	byte ptr [esi+30h], 80h
		mov	dword ptr [esi-60h], 1
		jnz	loc_1001B922	; jumptable 1001B7EF cases 0,1
		mov	ecx, [esi+3Ch]
		mov	edx, [ecx+24h]
		add	edx, 30h
		push	edx		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	eax, [esi+0Ch]
		mov	ecx, [esi+8]
		lea	ebp, [esi+8]
		mov	dword ptr [esi-8], 0
		mov	[eax], ecx
		mov	edx, [ebp+0]
		mov	eax, [esi+0Ch]
		mov	[edx+4], eax
		mov	ecx, [esi+3Ch]
		mov	edx, [ecx+24h]
		add	edx, 30h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [esi+3Ch]
		mov	ecx, [eax+24h]
		mov	edi, [esi-5Ch]
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esi+3Ch]
		mov	edx, [eax+24h]
		lea	ecx, [edx+edi*8+48h]
		mov	[ebp+0], ecx
		mov	edx, [eax+24h]
		mov	ecx, [edx+edi*8+4Ch]
		mov	[esi+0Ch], ecx
		mov	edx, [eax+24h]
		mov	eax, [edx+edi*8+4Ch]
		mov	[eax], ebp
		mov	ecx, [esi+3Ch]
		mov	edx, [ecx+24h]
		mov	[edx+edi*8+4Ch], ebp
		mov	eax, [esi+3Ch]
		mov	eax, [eax+24h]
		mov	ecx, edi
		mov	edx, 1
		shl	edx, cl
		or	[eax+68h], edx
		mov	eax, [esi+3Ch]
		mov	dword ptr [esi-8], 1
		mov	ecx, [eax+24h]
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		call	PR_AssertCurrentThreadOwnsLock_0
		cmp	edi, [eax+4]
		jle	short loc_1001B922 ; jumptable 1001B7EF	cases 0,1
		mov	edx, [esp+1Ch+var_C]
		test	byte ptr [edx+90h], 80h
		jnz	short loc_1001B922 ; jumptable 1001B7EF	cases 0,1
		cmp	dword_1003067C,	0
		jz	short loc_1001B8DD
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		mov	byte ptr [eax+0Fh], 1
		jmp	short loc_1001B922 ; jumptable 1001B7EF	cases 0,1
; ---------------------------------------------------------------------------

loc_1001B8DD:				; CODE XREF: PR_ResumeAll+1A0j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	byte ptr [eax+0Fh], 1
		jmp	short loc_1001B922 ; jumptable 1001B7EF	cases 0,1
; ---------------------------------------------------------------------------

loc_1001B8EF:				; CODE XREF: PR_ResumeAll+CFj
					; DATA XREF: .text:off_1001BA48o
		and	dword ptr [esi+30h], 0FFFFFFBFh	; jumptable 1001B7EF cases 3,5
		jmp	short loc_1001B922 ; jumptable 1001B7EF	cases 0,1
; ---------------------------------------------------------------------------

loc_1001B8F5:				; CODE XREF: PR_ResumeAll+CFj
					; DATA XREF: .text:off_1001BA48o
		mov	edi, [esi+24h]	; jumptable 1001B7EF case 2
		and	dword ptr [esi+30h], 0FFFFFFBFh
		add	edi, 1Ch
		push	edi		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	eax, [esi+24h]
		cmp	dword ptr [eax+8], 0
		jnz	short loc_1001B914
		push	eax
		call	sub_100191C0
		add	esp, 4

loc_1001B914:				; CODE XREF: PR_ResumeAll+1E9j
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001B922 ; jumptable 1001B7EF	cases 0,1
; ---------------------------------------------------------------------------

loc_1001B91D:				; CODE XREF: PR_ResumeAll+C9j
					; PR_ResumeAll+CFj
					; DATA XREF: ...
		call	PR_Abort	; jumptable 1001B7EF default case

loc_1001B922:				; CODE XREF: PR_ResumeAll+CFj
					; PR_ResumeAll+E5j ...
		push	ebx		; jumptable 1001B7EF cases 0,1
		call	ds:LeaveCriticalSection
		mov	ecx, [esp+1Ch+var_C]
		test	byte ptr [ecx+90h], 80h
		jnz	loc_1001B9D8
		mov	edi, [esp+1Ch+lpTlsValue]
		test	edi, edi
		jnz	short loc_1001B9A9
		cmp	dword_1003067C,	edi
		jz	short loc_1001B961
		mov	eax, TlsIndex
		mov	edx, large fs:2Ch
		mov	ecx, [edx+eax*4]
		mov	eax, [ecx+14h]
		jmp	short loc_1001B96E
; ---------------------------------------------------------------------------

loc_1001B961:				; CODE XREF: PR_ResumeAll+228j
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001B96E:				; CODE XREF: PR_ResumeAll+23Fj
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1001B9A9
		cmp	dword_1003067C,	0
		jz	short loc_1001B994
		mov	eax, large fs:2Ch
		mov	ecx, TlsIndex
		mov	edx, [eax+ecx*4]
		mov	eax, [edx+14h]
		jmp	short loc_1001B9A0
; ---------------------------------------------------------------------------

loc_1001B994:				; CODE XREF: PR_ResumeAll+25Bj
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001B9A0:				; CODE XREF: PR_ResumeAll+272j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_1001B9A9:				; CODE XREF: PR_ResumeAll+220j
					; PR_ResumeAll+252j
		cmp	dword_1003067C,	0
		jz	short loc_1001B9CA
		mov	ecx, large fs:2Ch
		mov	edx, TlsIndex
		mov	eax, [ecx+edx*4]
		mov	[eax+10h], edi
		jmp	short loc_1001B9D8
; ---------------------------------------------------------------------------

loc_1001B9CA:				; CODE XREF: PR_ResumeAll+290j
		mov	ecx, dwTlsIndex
		push	edi		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001B9D8:				; CODE XREF: PR_ResumeAll+29j
					; PR_ResumeAll+36j ...
		mov	esi, [esi]
		mov	edi, [esp+1Ch+var_4]
		cmp	esi, offset off_100302B0
		jnz	loc_1001B744
		pop	ebp
		pop	ebx

loc_1001B9EC:				; CODE XREF: PR_ResumeAll+1Cj
		mov	esi, off_100302B8
		cmp	esi, offset off_100302B8
		jz	short loc_1001BA26
		lea	ebx, [ebx+0]

loc_1001BA00:				; CODE XREF: PR_ResumeAll+304j
		lea	edx, [esi-60h]
		cmp	edi, edx
		jz	short loc_1001BA1C
		test	dword ptr [esi+30h], 400h
		jz	short loc_1001BA1C
		lea	eax, [esi-60h]
		push	eax
		call	sub_100249E0
		add	esp, 4

loc_1001BA1C:				; CODE XREF: PR_ResumeAll+2E5j
					; PR_ResumeAll+2EEj
		mov	esi, [esi]
		cmp	esi, offset off_100302B8
		jnz	short loc_1001BA00

loc_1001BA26:				; CODE XREF: PR_ResumeAll+2D8j
		xor	eax, eax
		mov	dword_100315AC,	eax
		mov	dword_100315A8,	eax
		mov	eax, dword_10032A60
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		pop	edi
		pop	esi
		add	esp, 0Ch
		retn
PR_ResumeAll	endp

; ---------------------------------------------------------------------------
		align 4
off_1001BA48	dd offset loc_1001B922	; DATA XREF: PR_ResumeAll+CFr
		dd offset loc_1001B922	; jump table for switch	statement
		dd offset loc_1001B8F5
		dd offset loc_1001B8EF
		dd offset loc_1001B91D
		dd offset loc_1001B8EF
		dd offset loc_1001B7F6
		align 10h
; Exported entry 105. PR_EnumerateThreads

; =============== S U B	R O U T	I N E =======================================


		public PR_EnumerateThreads
PR_EnumerateThreads proc near		; CODE XREF: PR_ScanStackPointers+1Cp
					; DATA XREF: .rdata:off_1002C7C8o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, off_100302B0
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		xor	esi, esi
		push	edi
		cmp	eax, offset off_100302B0
		jz	short loc_1001BAB8
		lea	ebx, [ebx+0]

loc_1001BA90:				; CODE XREF: PR_EnumerateThreads+46j
		mov	edi, [eax]
		add	eax, 0FFFFFFA0h
		test	dword ptr [eax+90h], 400h
		jz	short loc_1001BAAE
		push	ebx
		push	esi
		push	eax
		call	ebp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001BAFA
		inc	esi

loc_1001BAAE:				; CODE XREF: PR_EnumerateThreads+2Fj
		mov	eax, edi
		cmp	edi, offset off_100302B0
		jnz	short loc_1001BA90

loc_1001BAB8:				; CODE XREF: PR_EnumerateThreads+18j
		mov	eax, off_100302B8
		cmp	eax, offset off_100302B8
		jz	short loc_1001BAF8
		jmp	short loc_1001BAD0
; ---------------------------------------------------------------------------
		align 10h

loc_1001BAD0:				; CODE XREF: PR_EnumerateThreads+54j
					; PR_EnumerateThreads+86j
		mov	edi, [eax]
		add	eax, 0FFFFFFA0h
		test	dword ptr [eax+90h], 400h
		jz	short loc_1001BAEE
		push	ebx
		push	esi
		push	eax
		call	ebp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001BAFA
		inc	esi

loc_1001BAEE:				; CODE XREF: PR_EnumerateThreads+6Fj
		mov	eax, edi
		cmp	edi, offset off_100302B8
		jnz	short loc_1001BAD0

loc_1001BAF8:				; CODE XREF: PR_EnumerateThreads+52j
		xor	eax, eax

loc_1001BAFA:				; CODE XREF: PR_EnumerateThreads+3Bj
					; PR_EnumerateThreads+7Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
PR_EnumerateThreads endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 404. _PR_AddSleepQ

; =============== S U B	R O U T	I N E =======================================


		public _PR_AddSleepQ
_PR_AddSleepQ	proc near		; CODE XREF: PR_CancelWaitGroup+167p
					; PR_WaitRecvReady+CAp	...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	edx, [esp+arg_4]
		mov	eax, [ecx+9Ch]
		push	esi
		mov	esi, [eax+24h]
		cmp	edx, 0FFFFFFFFh
		jnz	short loc_1001BB46
		add	esi, 78h
		mov	[ecx+68h], esi
		mov	esi, [eax+24h]
		mov	esi, [esi+7Ch]
		lea	edx, [ecx+68h]
		mov	[ecx+6Ch], esi
		mov	eax, [eax+24h]
		mov	eax, [eax+7Ch]
		mov	[eax], edx
		mov	eax, [ecx+9Ch]
		mov	eax, [eax+24h]
		mov	[eax+7Ch], edx
		or	dword ptr [ecx+90h], 20h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001BB46:				; CODE XREF: _PR_AddSleepQ+15j
		push	edi
		cmp	edx, [esi+74h]
		jb	short loc_1001BB8D
		mov	edi, [eax+24h]
		add	edi, 6Ch
		mov	[ecx+68h], edi
		mov	edi, [eax+24h]
		mov	edi, [edi+70h]
		lea	esi, [ecx+68h]
		mov	[ecx+6Ch], edi
		mov	edi, [eax+24h]
		mov	edi, [edi+70h]
		mov	[edi], esi
		mov	edi, [eax+24h]
		mov	[edi+70h], esi
		mov	esi, [eax+24h]
		mov	edi, edx
		sub	edi, [esi+74h]
		mov	[ecx+80h], edi
		mov	eax, [eax+24h]
		pop	edi
		mov	[eax+74h], edx
		or	dword ptr [ecx+90h], 10h
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001BB8D:				; CODE XREF: _PR_AddSleepQ+4Aj
		mov	eax, [esi+6Ch]
		lea	edi, [esi+6Ch]
		cmp	eax, edi
		jz	short loc_1001BBA6

loc_1001BB97:				; CODE XREF: _PR_AddSleepQ+A4j
		mov	esi, [eax+18h]
		cmp	edx, esi
		jb	short loc_1001BBA6
		mov	eax, [eax]
		sub	edx, esi
		cmp	eax, edi
		jnz	short loc_1001BB97

loc_1001BBA6:				; CODE XREF: _PR_AddSleepQ+95j
					; _PR_AddSleepQ+9Cj
		lea	esi, [ecx+68h]
		mov	[esi], eax
		mov	[ecx+80h], edx
		mov	edi, [eax+4]
		mov	[ecx+6Ch], edi
		mov	edi, [eax+4]
		mov	[edi], esi
		mov	[eax+4], esi
		mov	esi, [esi]
		sub	[esi+18h], edx
		or	dword ptr [ecx+90h], 10h
		pop	edi
		pop	esi
		retn
_PR_AddSleepQ	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 406. _PR_DelSleepQ

; =============== S U B	R O U T	I N E =======================================


		public _PR_DelSleepQ
_PR_DelSleepQ	proc near		; CODE XREF: sub_10018240+4Bp
					; sub_10018390+64p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+90h]
		mov	edx, [eax+9Ch]
		test	cl, 30h
		jz	locret_1001BC93
		test	cl, 10h
		jz	loc_1001BC79
		mov	ecx, [eax+68h]
		push	esi
		push	edi
		mov	edi, [edx+24h]
		lea	esi, [edi+6Ch]
		cmp	ecx, esi
		jz	short loc_1001BC2C
		cmp	[esp+8+arg_4], 1
		jnz	short loc_1001BC31
		mov	edx, [eax+80h]
		add	[ecx+18h], edx
		mov	edx, [eax+6Ch]
		mov	ecx, [eax+68h]
		and	dword ptr [eax+90h], 0FFFFFFEFh
		mov	[edx], ecx
		mov	edx, [eax+68h]
		mov	eax, [eax+6Ch]
		pop	edi
		pop	esi
		mov	[edx+4], eax
		retn
; ---------------------------------------------------------------------------

loc_1001BC2C:				; CODE XREF: _PR_DelSleepQ+2Fj
		cmp	[eax+6Ch], esi
		jz	short loc_1001BC57

loc_1001BC31:				; CODE XREF: _PR_DelSleepQ+36j
		mov	ecx, [eax+80h]
		mov	edx, edi
		sub	[edx+74h], ecx
		mov	edx, [eax+6Ch]
		mov	ecx, [eax+68h]
		and	dword ptr [eax+90h], 0FFFFFFEFh
		mov	[edx], ecx
		mov	edx, [eax+68h]
		mov	eax, [eax+6Ch]
		pop	edi
		pop	esi
		mov	[edx+4], eax
		retn
; ---------------------------------------------------------------------------

loc_1001BC57:				; CODE XREF: _PR_DelSleepQ+5Fj
		mov	dword ptr [edi+74h], 0
		mov	edx, [eax+6Ch]
		mov	ecx, [eax+68h]
		and	dword ptr [eax+90h], 0FFFFFFEFh
		mov	[edx], ecx
		mov	edx, [eax+68h]
		mov	eax, [eax+6Ch]
		pop	edi
		pop	esi
		mov	[edx+4], eax
		retn
; ---------------------------------------------------------------------------

loc_1001BC79:				; CODE XREF: _PR_DelSleepQ+1Cj
		mov	edx, [eax+6Ch]
		and	ecx, 0FFFFFFDFh
		mov	[eax+90h], ecx
		mov	ecx, [eax+68h]
		mov	[edx], ecx
		mov	edx, [eax+68h]
		mov	eax, [eax+6Ch]
		mov	[edx+4], eax

locret_1001BC93:			; CODE XREF: _PR_DelSleepQ+13j
		retn
_PR_DelSleepQ	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BCA0	proc near		; CODE XREF: sub_10018240+F0p
					; sub_10018390+87p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		test	byte ptr [eax+90h], 80h
		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	esi
		mov	esi, [ebx+9Ch]
		push	edi
		mov	edi, [ebx+4]
		jnz	short loc_1001BCC5
		cmp	esi, [eax+9Ch]
		jz	short loc_1001BCCE

loc_1001BCC5:				; CODE XREF: sub_1001BCA0+1Bj
		cmp	dword ptr [ebx+128h], 0
		jz	short loc_1001BD1F

loc_1001BCCE:				; CODE XREF: sub_1001BCA0+23j
		mov	eax, [esi+24h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [esi+24h]
		lea	edx, [ecx+edi*8+48h]
		mov	[ebx+68h], edx
		mov	ecx, [esi+24h]
		mov	edx, [ecx+edi*8+4Ch]
		lea	eax, [ebx+68h]
		mov	[ebx+6Ch], edx
		mov	ecx, [esi+24h]
		mov	edx, [ecx+edi*8+4Ch]
		mov	[edx], eax
		mov	ecx, [esi+24h]
		mov	[ecx+edi*8+4Ch], eax
		mov	eax, [esi+24h]
		mov	ecx, edi
		mov	edx, 1
		shl	edx, cl
		or	[eax+68h], edx
		mov	dword ptr [ebx+58h], 1
		mov	eax, [esi+24h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1001BD1F:				; CODE XREF: sub_1001BCA0+2Cj
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_1001BCA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001BD30	proc near		; CODE XREF: PR_Init_0+103p

var_5		= byte ptr -5
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebp
		push	esi
		push	edi
		call	PR_NewLock
		mov	dword_10032AF8,	eax
		call	PR_NewLock
		push	2Ch		; SizeOfElements
		push	1		; NumOfElements
		mov	dword_10032A60,	eax
		call	PR_Calloc
		mov	edi, eax
		xor	ebp, ebp
		add	esp, 8
		cmp	edi, ebp
		jz	short loc_1001BD9F
		mov	[edi+1Ch], ebp
		mov	[esp+10h+var_4], edi
		cmp	[edi+18h], ebp
		jnz	short loc_1001BD9F
		mov	eax, ebp
		mov	[edi+10h], eax
		mov	ecx, dword_10032B10
		mov	eax, [esp+10h+var_4]
		lea	edx, [esp+ecx+10h+var_5]
		mov	ecx, dword_10032B0C
		sar	edx, cl
		shl	edx, cl
		mov	[eax+0Ch], edx
		mov	eax, [esp+10h+var_4]
		mov	ecx, [eax+0Ch]
		mov	[eax+18h], ecx
		mov	eax, [esp+10h+var_4]
		mov	edx, [eax+0Ch]
		sub	edx, [eax+1Ch]
		mov	[eax+14h], edx

loc_1001BD9F:				; CODE XREF: sub_1001BD30+2Aj
					; sub_1001BD30+36j
		push	ebx
		mov	ebx, [esp+14h+arg_4]
		cmp	ebx, 3
		jle	short loc_1001BDB0
		mov	ebx, 3
		jmp	short loc_1001BDB6
; ---------------------------------------------------------------------------

loc_1001BDB0:				; CODE XREF: sub_1001BD30+77j
		cmp	ebx, ebp
		jge	short loc_1001BDB6
		xor	ebx, ebx

loc_1001BDB6:				; CODE XREF: sub_1001BD30+7Ej
					; sub_1001BD30+82j
		push	14Ch		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebp
		jz	short loc_1001BE09
		lea	eax, [esi+78h]
		mov	[eax], eax
		mov	[esi+7Ch], eax
		lea	eax, [esi+40h]
		push	eax		; lpCriticalSection
		mov	[esi+4], ebx
		mov	[esi+10h], edi
		mov	dword ptr [esi], 2
		call	ds:InitializeCriticalSection
		cmp	dword_1003067C,	ebp
		jz	short loc_1001BE57
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		mov	[eax+8], esi
		jmp	short loc_1001BE65
; ---------------------------------------------------------------------------

loc_1001BE09:				; CODE XREF: sub_1001BD30+99j
		xor	esi, esi
		call	PR_Abort
		lea	edi, [esi+1]

loc_1001BE13:				; CODE XREF: sub_1001BD30+17Aj
		or	dword ptr [esi+90h], 88h
		push	esi
		call	sub_100244D0
		add	esp, 4
		test	byte ptr [esi+90h], 80h
		pop	ebx
		lea	eax, [esi+60h]
		jz	short loc_1001BEAF
		mov	dword ptr [eax], offset	off_100302B8
		mov	ecx, off_100302BC
		mov	[esi+64h], ecx
		mov	edx, off_100302BC
		mov	[edx], eax
		add	dword_10032A48,	edi
		mov	off_100302BC, eax
		jmp	short loc_1001BED1
; ---------------------------------------------------------------------------

loc_1001BE57:				; CODE XREF: sub_1001BD30+BFj
		mov	ecx, dword_100329F0
		push	esi		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001BE65:				; CODE XREF: sub_1001BD30+D7j
		mov	edi, 1
		cmp	[esp+14h+arg_0], edi
		jnz	short loc_1001BE84
		mov	[esi+90h], edi
		add	dword_10032B08,	edi
		mov	dword_10032A68,	ebp
		jmp	short loc_1001BE90
; ---------------------------------------------------------------------------

loc_1001BE84:				; CODE XREF: sub_1001BD30+13Ej
		add	dword_10032AB8,	edi
		mov	dword_10032A68,	edi

loc_1001BE90:				; CODE XREF: sub_1001BD30+152j
		mov	[esi+94h], edi
		mov	edx, dword_10032A60
		push	edx
		call	PR_NewCondVar
		add	esp, 4
		mov	dword_10032A58,	eax
		jmp	loc_1001BE13
; ---------------------------------------------------------------------------

loc_1001BEAF:				; CODE XREF: sub_1001BD30+101j
		mov	dword ptr [eax], offset	off_100302B0
		mov	ecx, off_100302B4
		mov	[esi+64h], ecx
		mov	edx, off_100302B4
		mov	[edx], eax
		add	dword_10032A64,	edi
		mov	off_100302B4, eax

loc_1001BED1:				; CODE XREF: sub_1001BD30+125j
		mov	dword_10031598,	ebp
		call	PR_NewLock
		mov	dword_10032A5C,	eax
		mov	eax, offset dword_10032A50
		pop	edi
		mov	dword_10032A50,	eax
		mov	dword_10032A54,	eax
		mov	eax, offset dword_10032A40
		pop	esi
		mov	dword_10032A3C,	ebp
		mov	dword_10032A38,	ebp
		mov	dword_10032A40,	eax
		mov	dword_10032A44,	eax
		pop	ebp
		pop	ecx
		retn
sub_1001BD30	endp

; Exported entry 225. PR_JoinThread

; =============== S U B	R O U T	I N E =======================================


		public PR_JoinThread
PR_JoinThread	proc near		; CODE XREF: PR_DestroyAlarm+35p
					; PR_JoinThreadPool+93p ...

lpTlsValue	= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ebx, eax
		test	byte ptr [ebx+90h], 80h
		jnz	short loc_1001BF8E
		cmp	dword_1003067C,	0
		jz	short loc_1001BF49
		mov	ebp, TlsIndex
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebp*4]
		mov	edx, [ecx+10h]
		mov	[esp+14h+lpTlsValue], edx
		jmp	short loc_1001BF5F
; ---------------------------------------------------------------------------

loc_1001BF49:				; CODE XREF: PR_JoinThread+1Cj
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	ebp, TlsIndex
		mov	[esp+14h+lpTlsValue], eax

loc_1001BF5F:				; CODE XREF: PR_JoinThread+37j
		cmp	dword_1003067C,	0
		jz	short loc_1001BF7E
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebp*4]
		mov	dword ptr [edx+10h], 1
		jmp	short loc_1001BF94
; ---------------------------------------------------------------------------

loc_1001BF7E:				; CODE XREF: PR_JoinThread+56j
		mov	eax, dwTlsIndex
		push	1		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue
		jmp	short loc_1001BF94
; ---------------------------------------------------------------------------

loc_1001BF8E:				; CODE XREF: PR_JoinThread+13j
		mov	ebp, TlsIndex

loc_1001BF94:				; CODE XREF: PR_JoinThread+6Cj
					; PR_JoinThread+7Cj
		mov	esi, [esp+14h+arg_0]
		mov	edi, [esi+98h]
		test	edi, edi
		jnz	short loc_1001BFB2
		push	edi
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		jmp	short loc_1001BFBD
; ---------------------------------------------------------------------------

loc_1001BFB2:				; CODE XREF: PR_JoinThread+90j
		lea	eax, [edi+4]
		cmp	[eax], eax
		jz	loc_1001C066

loc_1001BFBD:				; CODE XREF: PR_JoinThread+A0j
		test	byte ptr [ebx+90h], 80h
		jnz	loc_1001C05D
		mov	esi, [esp+14h+lpTlsValue]
		test	esi, esi
		jnz	short loc_1001C02E
		cmp	dword_1003067C,	esi
		jz	short loc_1001BFEC
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebp*4]
		mov	eax, [edx+14h]
		jmp	short loc_1001BFF8
; ---------------------------------------------------------------------------

loc_1001BFEC:				; CODE XREF: PR_JoinThread+C8j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001BFF8:				; CODE XREF: PR_JoinThread+DAj
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1001C02E
		cmp	dword_1003067C,	0
		jz	short loc_1001C019
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebp*4]
		mov	eax, [edx+14h]
		jmp	short loc_1001C025
; ---------------------------------------------------------------------------

loc_1001C019:				; CODE XREF: PR_JoinThread+F5j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001C025:				; CODE XREF: PR_JoinThread+107j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_1001C02E:				; CODE XREF: PR_JoinThread+C0j
					; PR_JoinThread+ECj
		cmp	dword_1003067C,	0
		jz	short loc_1001C050
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebp*4]
		pop	edi
		mov	[edx+10h], esi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C050:				; CODE XREF: PR_JoinThread+125j
		mov	eax, dwTlsIndex
		push	esi		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001C05D:				; CODE XREF: PR_JoinThread+B4j
		pop	edi
		pop	esi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C066:				; CODE XREF: PR_JoinThread+A7j
		test	byte ptr [ebx+90h], 80h
		jnz	loc_1001C108
		cmp	[esp+14h+lpTlsValue], 0
		jnz	short loc_1001C0D7
		cmp	dword_1003067C,	0
		jz	short loc_1001C095
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebp*4]
		mov	eax, [edx+14h]
		jmp	short loc_1001C0A1
; ---------------------------------------------------------------------------

loc_1001C095:				; CODE XREF: PR_JoinThread+171j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001C0A1:				; CODE XREF: PR_JoinThread+183j
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1001C0D7
		cmp	dword_1003067C,	0
		jz	short loc_1001C0C2
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebp*4]
		mov	eax, [edx+14h]
		jmp	short loc_1001C0CE
; ---------------------------------------------------------------------------

loc_1001C0C2:				; CODE XREF: PR_JoinThread+19Ej
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001C0CE:				; CODE XREF: PR_JoinThread+1B0j
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_1001C0D7:				; CODE XREF: PR_JoinThread+168j
					; PR_JoinThread+195j
		cmp	dword_1003067C,	0
		jz	short loc_1001C0F6
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebp*4]
		mov	eax, [esp+14h+lpTlsValue]
		mov	[edx+10h], eax
		jmp	short loc_1001C108
; ---------------------------------------------------------------------------

loc_1001C0F6:				; CODE XREF: PR_JoinThread+1CEj
		mov	ecx, [esp+14h+lpTlsValue]
		mov	edx, dwTlsIndex
		push	ecx		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001C108:				; CODE XREF: PR_JoinThread+15Dj
					; PR_JoinThread+1E4j
		mov	eax, dword_10032AF8
		push	eax
		call	PR_Lock
		add	esp, 4
		cmp	dword ptr [esi], 5
		jz	short loc_1001C130
		jmp	short loc_1001C120
; ---------------------------------------------------------------------------
		align 10h

loc_1001C120:				; CODE XREF: PR_JoinThread+20Bj
					; PR_JoinThread+21Ej
		push	0FFFFFFFFh
		push	edi
		call	PR_WaitCondVar
		add	esp, 8
		cmp	dword ptr [esi], 5
		jnz	short loc_1001C120

loc_1001C130:				; CODE XREF: PR_JoinThread+209j
		mov	ecx, dword_10032AF8
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		test	byte ptr [ebx+90h], 80h
		jnz	short loc_1001C1A5
		cmp	dword_1003067C,	0
		jz	short loc_1001C167
		mov	edx, large fs:2Ch
		mov	eax, [edx+ebp*4]
		mov	ecx, [eax+10h]
		mov	[esp+14h+lpTlsValue], ecx
		jmp	short loc_1001C178
; ---------------------------------------------------------------------------

loc_1001C167:				; CODE XREF: PR_JoinThread+23Fj
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[esp+14h+lpTlsValue], eax

loc_1001C178:				; CODE XREF: PR_JoinThread+255j
		cmp	dword_1003067C,	0
		jz	short loc_1001C196
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebp*4]
		mov	dword ptr [ecx+10h], 1
		jmp	short loc_1001C1A5
; ---------------------------------------------------------------------------

loc_1001C196:				; CODE XREF: PR_JoinThread+26Fj
		mov	edx, dwTlsIndex
		push	1		; lpTlsValue
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001C1A5:				; CODE XREF: PR_JoinThread+236j
					; PR_JoinThread+284j
		test	byte ptr [esi+90h], 80h
		mov	dword ptr [esi], 1
		jnz	short loc_1001C20F
		mov	ebp, ds:EnterCriticalSection
		lea	edi, [esi+40h]
		push	edi		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 30h
		push	ecx		; lpCriticalSection
		call	ebp ; EnterCriticalSection
		mov	edx, [esi+6Ch]
		mov	eax, [esi+68h]
		mov	ebp, ds:LeaveCriticalSection
		mov	dword ptr [esi+58h], 0
		mov	[edx], eax
		mov	ecx, [esi+68h]
		mov	edx, [esi+6Ch]
		mov	[ecx+4], edx
		mov	eax, [esi+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 30h
		push	ecx		; lpCriticalSection
		call	ebp ; LeaveCriticalSection
		push	esi
		push	ebx
		call	sub_1001BCA0
		add	esp, 8
		push	edi		; lpCriticalSection
		call	ebp ; LeaveCriticalSection
		mov	ebp, TlsIndex

loc_1001C20F:				; CODE XREF: PR_JoinThread+2A2j
		test	byte ptr [ebx+90h], 80h
		jnz	loc_1001C2BA
		mov	edi, [esp+14h+lpTlsValue]
		test	edi, edi
		jnz	short loc_1001C282
		cmp	dword_1003067C,	edi
		jz	short loc_1001C23E
		mov	edx, large fs:2Ch
		mov	eax, [edx+ebp*4]
		mov	eax, [eax+14h]
		jmp	short loc_1001C24B
; ---------------------------------------------------------------------------

loc_1001C23E:				; CODE XREF: PR_JoinThread+31Aj
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001C24B:				; CODE XREF: PR_JoinThread+32Cj
		cmp	dword ptr [eax+0Ch], 0
		jz	short loc_1001C282
		cmp	dword_1003067C,	0
		jz	short loc_1001C26C
		mov	edx, large fs:2Ch
		mov	eax, [edx+ebp*4]
		mov	eax, [eax+14h]
		jmp	short loc_1001C279
; ---------------------------------------------------------------------------

loc_1001C26C:				; CODE XREF: PR_JoinThread+348j
		mov	ecx, dword_100329EC
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_1001C279:				; CODE XREF: PR_JoinThread+35Aj
		push	eax
		call	sub_100190B0
		add	esp, 4

loc_1001C282:				; CODE XREF: PR_JoinThread+312j
					; PR_JoinThread+33Fj
		cmp	dword_1003067C,	0
		jz	short loc_1001C2AC
		mov	edx, large fs:2Ch
		mov	eax, [edx+ebp*4]
		push	esi
		mov	[eax+10h], edi
		call	sub_1001DF20
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C2AC:				; CODE XREF: PR_JoinThread+379j
		mov	ecx, dwTlsIndex
		push	edi		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001C2BA:				; CODE XREF: PR_JoinThread+306j
		push	esi
		call	sub_1001DF20
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
PR_JoinThread	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _putenv]
		align 10h
; Exported entry 269. PR_Now

; =============== S U B	R O U T	I N E =======================================


		public PR_Now
PR_Now		proc near		; CODE XREF: PR_LogPrint+42p
					; PR_Trace+9Dp
					; DATA XREF: ...

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
FileTime	= _FILETIME ptr	-1Ch
SystemTime	= _SYSTEMTIME ptr -14h
var_4		= dword	ptr -4

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		lea	eax, [esp+24h+SystemTime]
		push	eax		; lpSystemTime
		call	ds:GetSystemTime
		lea	ecx, [esp+24h+FileTime]
		push	ecx		; lpFileTime
		lea	edx, [esp+28h+SystemTime]
		push	edx		; lpSystemTime
		call	ds:SystemTimeToFileTime
		lea	eax, [esp+24h+var_24]
		push	eax
		lea	ecx, [esp+28h+FileTime]
		push	ecx
		call	sub_10021610
		mov	ecx, [esp+2Ch+var_4]
		mov	eax, [esp+2Ch+var_24]
		mov	edx, [esp+2Ch+var_20]
		add	esp, 8
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
PR_Now		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C350	proc near		; CODE XREF: PR_CreateProcess_0+58p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		mov	eax, [ebx]
		push	esi
		xor	ecx, ecx
		push	edi
		mov	esi, ebx
		test	eax, eax
		jz	short loc_1001C37A

loc_1001C361:				; CODE XREF: sub_1001C350+28j
		lea	edi, [eax+1]

loc_1001C364:				; CODE XREF: sub_1001C350+19j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001C364
		sub	eax, edi
		add	esi, 4
		lea	ecx, [ecx+eax*2+3]
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_1001C361

loc_1001C37A:				; CODE XREF: sub_1001C350+Fj
		push	ecx		; Size
		call	PR_Malloc
		mov	ecx, [esp+10h+arg_4]
		mov	esi, eax
		add	esp, 4
		mov	[ecx], eax
		test	esi, esi
		jnz	short loc_1001C396
		pop	edi
		pop	esi
		or	eax, 0FFFFFFFFh
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1001C396:				; CODE XREF: sub_1001C350+3Dj
		cmp	dword ptr [ebx], 0
		mov	eax, ebx
		mov	[esp+0Ch+arg_4], ebx
		jz	loc_1001C46F
		push	ebp
		jmp	short loc_1001C3AC
; ---------------------------------------------------------------------------

loc_1001C3A8:				; CODE XREF: sub_1001C350+118j
		mov	ebx, [esp+10h+arg_0]

loc_1001C3AC:				; CODE XREF: sub_1001C350+56j
		cmp	eax, ebx
		jz	short loc_1001C3B4
		mov	byte ptr [esi],	20h
		inc	esi

loc_1001C3B4:				; CODE XREF: sub_1001C350+5Ej
		mov	ebx, [eax]
		xor	edi, edi
		xor	ebp, ebp
		cmp	byte ptr [ebx],	0
		jz	short loc_1001C3D2
		push	offset Control	; " "
		push	ebx		; Str
		call	ds:strpbrk
		add	esp, 8
		test	eax, eax
		jz	short loc_1001C3DB

loc_1001C3D2:				; CODE XREF: sub_1001C350+6Dj
		mov	byte ptr [esi],	22h
		mov	ebp, 1
		inc	esi

loc_1001C3DB:				; CODE XREF: sub_1001C350+80j
		mov	al, [ebx]
		test	al, al
		jz	short loc_1001C452

loc_1001C3E1:				; CODE XREF: sub_1001C350+E4j
		cmp	al, 5Ch
		jnz	short loc_1001C3E8
		inc	edi
		jmp	short loc_1001C42E
; ---------------------------------------------------------------------------

loc_1001C3E8:				; CODE XREF: sub_1001C350+93j
		cmp	al, 22h
		jnz	short loc_1001C413
		test	edi, edi
		jz	short loc_1001C406
		add	edi, edi
		test	edi, edi
		jle	short loc_1001C404
		push	edi		; Size
		push	5Ch		; Val
		push	esi		; Dst
		call	memset
		add	esp, 0Ch
		add	esi, edi

loc_1001C404:				; CODE XREF: sub_1001C350+A4j
		xor	edi, edi

loc_1001C406:				; CODE XREF: sub_1001C350+9Ej
		mov	byte ptr [esi],	5Ch
		mov	dl, [ebx]
		mov	[esi+1], dl
		add	esi, 2
		jmp	short loc_1001C42E
; ---------------------------------------------------------------------------

loc_1001C413:				; CODE XREF: sub_1001C350+9Aj
		test	edi, edi
		jz	short loc_1001C429
		jle	short loc_1001C427
		push	edi		; Size
		push	5Ch		; Val
		push	esi		; Dst
		call	memset
		add	esp, 0Ch
		add	esi, edi

loc_1001C427:				; CODE XREF: sub_1001C350+C7j
		xor	edi, edi

loc_1001C429:				; CODE XREF: sub_1001C350+C5j
		mov	al, [ebx]
		mov	[esi], al
		inc	esi

loc_1001C42E:				; CODE XREF: sub_1001C350+96j
					; sub_1001C350+C1j
		mov	al, [ebx+1]
		inc	ebx
		test	al, al
		jnz	short loc_1001C3E1
		test	edi, edi
		jz	short loc_1001C452
		test	ebp, ebp
		jz	short loc_1001C440
		add	edi, edi

loc_1001C440:				; CODE XREF: sub_1001C350+ECj
		test	edi, edi
		jle	short loc_1001C452
		push	edi		; Size
		push	5Ch		; Val
		push	esi		; Dst
		call	memset
		add	esp, 0Ch
		add	esi, edi

loc_1001C452:				; CODE XREF: sub_1001C350+8Fj
					; sub_1001C350+E8j ...
		test	ebp, ebp
		jz	short loc_1001C45A
		mov	byte ptr [esi],	22h
		inc	esi

loc_1001C45A:				; CODE XREF: sub_1001C350+104j
		mov	eax, [esp+10h+arg_4]
		add	eax, 4
		cmp	dword ptr [eax], 0
		mov	[esp+10h+arg_4], eax
		jnz	loc_1001C3A8
		pop	ebp

loc_1001C46F:				; CODE XREF: sub_1001C350+4Fj
		pop	edi
		mov	byte ptr [esi],	0
		pop	esi
		xor	eax, eax
		pop	ebx
		retn
sub_1001C350	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001C480	proc near		; CODE XREF: PR_CreateProcess_0+179p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_0]
		test	ebx, ebx
		jnz	short loc_1001C495
		mov	eax, [esp+8+arg_4]
		mov	[eax], ebx
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C495:				; CODE XREF: sub_1001C480+8j
		push	ebp
		call	ds:GetEnvironmentStrings
		mov	[esp+0Ch+var_4], eax
		mov	ebp, eax
		mov	al, [eax]
		test	al, al
		jz	short loc_1001C4D6

loc_1001C4A8:				; CODE XREF: sub_1001C480+54j
		cmp	al, 3Dh
		jnz	short loc_1001C4BD
		cmp	byte ptr [ebp+1], 0
		jz	short loc_1001C4BD
		cmp	byte ptr [ebp+2], 3Ah
		jnz	short loc_1001C4BD
		cmp	[ebp+3], al
		jz	short loc_1001C4D6

loc_1001C4BD:				; CODE XREF: sub_1001C480+2Aj
					; sub_1001C480+30j ...
		mov	eax, ebp
		lea	edx, [eax+1]

loc_1001C4C2:				; CODE XREF: sub_1001C480+47j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001C4C2
		sub	eax, edx
		lea	ebp, [eax+ebp+1]
		mov	al, [ebp+0]
		test	al, al
		jnz	short loc_1001C4A8

loc_1001C4D6:				; CODE XREF: sub_1001C480+26j
					; sub_1001C480+3Bj
		cmp	byte ptr [ebp+0], 0
		push	edi
		mov	edi, ebp
		jz	short loc_1001C524
		mov	eax, ebp
		lea	edx, [eax+1]

loc_1001C4E4:				; CODE XREF: sub_1001C480+69j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001C4E4
		sub	eax, edx
		lea	edi, [eax+ebp+1]
		mov	al, [edi]
		test	al, al
		jz	short loc_1001C524

loc_1001C4F7:				; CODE XREF: sub_1001C480+A2j
		cmp	al, 3Dh
		jnz	short loc_1001C524
		cmp	byte ptr [edi+1], 0
		jz	short loc_1001C524
		cmp	byte ptr [edi+2], 3Ah
		jnz	short loc_1001C524
		cmp	[edi+3], al
		jnz	short loc_1001C524
		mov	eax, edi
		lea	edx, [eax+1]

loc_1001C511:				; CODE XREF: sub_1001C480+96j
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_1001C511
		sub	eax, edx
		lea	edi, [edi+eax+1]
		mov	al, [edi]
		test	al, al
		jnz	short loc_1001C4F7

loc_1001C524:				; CODE XREF: sub_1001C480+5Dj
					; sub_1001C480+75j ...
		mov	eax, [ebx]
		mov	ecx, edi
		sub	ecx, ebp
		push	esi
		mov	esi, ebx
		test	eax, eax
		jz	short loc_1001C54E

loc_1001C531:				; CODE XREF: sub_1001C480+C8j
		lea	ebx, [eax+1]

loc_1001C534:				; CODE XREF: sub_1001C480+B9j
		mov	dl, [eax]
		inc	eax
		test	dl, dl
		jnz	short loc_1001C534
		sub	eax, ebx
		add	esi, 4
		lea	ecx, [ecx+eax+1]
		mov	eax, [esi]
		test	eax, eax
		jnz	short loc_1001C531
		mov	ebx, [esp+14h+arg_0]

loc_1001C54E:				; CODE XREF: sub_1001C480+AFj
		inc	ecx
		push	ecx		; Size
		call	PR_Malloc
		mov	ecx, [esp+18h+arg_4]
		mov	esi, eax
		add	esp, 4
		mov	[ecx], eax
		test	esi, esi
		jnz	short loc_1001C578
		mov	edx, [esp+14h+var_4]
		push	edx		; LPCH
		call	ds:FreeEnvironmentStringsA
		pop	esi
		pop	edi
		pop	ebp
		or	eax, 0FFFFFFFFh
		pop	ebx
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001C578:				; CODE XREF: sub_1001C480+E2j
		mov	eax, ebp
		cmp	ebp, edi
		jnb	short loc_1001C58A
		mov	edi, edi

loc_1001C580:				; CODE XREF: sub_1001C480+108j
		mov	cl, [eax]
		mov	[esi], cl
		inc	eax
		inc	esi
		cmp	eax, edi
		jb	short loc_1001C580

loc_1001C58A:				; CODE XREF: sub_1001C480+FCj
		mov	edx, [esp+14h+var_4]
		push	edx		; LPCH
		call	ds:FreeEnvironmentStringsA
		cmp	dword ptr [ebx], 0
		mov	edx, ebx
		jz	short loc_1001C5BE
		lea	esp, [esp+0]

loc_1001C5A0:				; CODE XREF: sub_1001C480+13Cj
		mov	ecx, [edx]
		mov	al, [ecx]
		test	al, al
		jz	short loc_1001C5B2

loc_1001C5A8:				; CODE XREF: sub_1001C480+130j
		inc	ecx
		mov	[esi], al
		mov	al, [ecx]
		inc	esi
		test	al, al
		jnz	short loc_1001C5A8

loc_1001C5B2:				; CODE XREF: sub_1001C480+126j
		mov	byte ptr [esi],	0
		add	edx, 4
		inc	esi
		cmp	dword ptr [edx], 0
		jnz	short loc_1001C5A0

loc_1001C5BE:				; CODE XREF: sub_1001C480+11Aj
		mov	byte ptr [esi],	0
		pop	esi
		pop	edi
		pop	ebp
		xor	eax, eax
		pop	ebx
		pop	ecx
		retn
sub_1001C480	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PtFuncCompare(const void *, const	void *)
PtFuncCompare	proc near		; DATA XREF: PR_CreateProcess_0:loc_1001C742o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	ecx, [eax]
		mov	[esp+arg_4], ecx
		mov	edx, [esp+arg_0]
		mov	eax, [edx]
		mov	[esp+arg_0], eax
		jmp	ds:_stricmp
PtFuncCompare	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_CreateProcess_0 proc	near		; CODE XREF: PR_CreateProcessj
					; PR_CreateProcessDetached+15p

Memory		= dword	ptr -74h
var_70		= dword	ptr -70h
lpCommandLine	= dword	ptr -6Ch
var_68		= dword	ptr -68h
lpEnvironment	= dword	ptr -64h
var_60		= dword	ptr -60h
lpCurrentDirectory= dword ptr -5Ch
dwCreationFlags	= dword	ptr -58h
ProcessInformation= _PROCESS_INFORMATION ptr -54h
Dst		= dword	ptr -44h
var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 74h
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	edi, edi
		xor	esi, esi
		push	8		; Size
		mov	[esp+88h+dwCreationFlags], edi
		mov	[esp+88h+lpCommandLine], edi
		mov	[esp+88h+lpEnvironment], esi
		mov	[esp+88h+Memory], edi
		mov	[esp+88h+lpCurrentDirectory], edi
		call	PR_Malloc
		mov	ebp, eax
		add	esp, 4
		mov	[esp+84h+var_60], ebp
		cmp	ebp, edi
		jnz	short loc_1001C63B
		push	edi
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 74h
		retn
; ---------------------------------------------------------------------------

loc_1001C63B:				; CODE XREF: PR_CreateProcess_0+31j
		mov	ecx, [esp+84h+arg_4]
		lea	eax, [esp+84h+lpCommandLine]
		push	eax
		push	ecx
		call	sub_1001C350
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001C66C
		push	edi
		push	0FFFFE890h
		call	PR_SetError
		mov	ebx, [esp+8Ch+lpCommandLine]
		add	esp, 8
		jmp	loc_1001C883
; ---------------------------------------------------------------------------

loc_1001C66C:				; CODE XREF: PR_CreateProcess_0+63j
		mov	edi, [esp+84h+arg_C]
		xor	eax, eax
		cmp	edi, eax
		jz	short loc_1001C686
		mov	[esp+84h+var_70], 1
		cmp	[edi+10h], eax
		jnz	short loc_1001C68A

loc_1001C686:				; CODE XREF: PR_CreateProcess_0+87j
		mov	[esp+84h+var_70], eax

loc_1001C68A:				; CODE XREF: PR_CreateProcess_0+94j
		mov	ebx, [esp+84h+arg_8]
		cmp	ebx, eax
		jnz	short loc_1001C6AD
		cmp	[esp+84h+var_70], eax
		jz	loc_1001C75F
		mov	ebx, ds:__imp_getenv
		cmp	ebx, eax
		jz	loc_1001C75F

loc_1001C6AD:				; CODE XREF: PR_CreateProcess_0+A3j
		xor	esi, esi
		mov	[esp+84h+var_68], eax
		cmp	[ebx], eax
		jz	short loc_1001C6BD

loc_1001C6B7:				; CODE XREF: PR_CreateProcess_0+CBj
		inc	esi
		cmp	[ebx+esi*4], eax
		jnz	short loc_1001C6B7

loc_1001C6BD:				; CODE XREF: PR_CreateProcess_0+C5j
		lea	edx, ds:8[esi*4]
		push	edx		; Size
		call	PR_Malloc
		add	esp, 4
		mov	ecx, eax
		xor	ebp, ebp
		mov	[esp+84h+Memory], ecx
		test	esi, esi
		jle	short loc_1001C72D
		mov	edi, ecx
		sub	ebx, ecx
		mov	ebp, esi
		nop

loc_1001C6E0:				; CODE XREF: PR_CreateProcess_0+134j
		cmp	[esp+84h+var_70], 0
		mov	eax, [ebx+edi]
		mov	[edi], eax
		jz	short loc_1001C720
		cmp	[esp+84h+var_68], 0
		jnz	short loc_1001C720
		push	11h		; MaxCount
		push	offset aNspr_inherit_1 ; "NSPR_INHERIT_FDS="
		push	eax		; Str1
		call	ds:strncmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001C71C
		mov	eax, [esp+84h+arg_C]
		mov	ecx, [eax+10h]
		mov	[edi], ecx
		mov	[esp+84h+var_68], 1

loc_1001C71C:				; CODE XREF: PR_CreateProcess_0+116j
		mov	ecx, [esp+84h+Memory]

loc_1001C720:				; CODE XREF: PR_CreateProcess_0+FAj
					; PR_CreateProcess_0+101j
		add	edi, 4
		dec	esi
		jnz	short loc_1001C6E0
		mov	edi, [esp+84h+arg_C]

loc_1001C72D:				; CODE XREF: PR_CreateProcess_0+E7j
		cmp	[esp+84h+var_70], 0
		jz	short loc_1001C742
		cmp	[esp+84h+var_68], 0
		jnz	short loc_1001C742
		mov	edx, [edi+10h]
		mov	[ecx+ebp*4], edx
		inc	ebp

loc_1001C742:				; CODE XREF: PR_CreateProcess_0+142j
					; PR_CreateProcess_0+149j
		push	offset PtFuncCompare ; PtFuncCompare
		push	4		; SizeOfElements
		push	ebp		; NumOfElements
		push	ecx		; Base
		mov	dword ptr [ecx+ebp*4], 0
		call	ds:qsort
		mov	ebp, [esp+94h+var_60]
		add	esp, 10h

loc_1001C75F:				; CODE XREF: PR_CreateProcess_0+A9j
					; PR_CreateProcess_0+B7j
		mov	ecx, [esp+84h+Memory]
		lea	eax, [esp+84h+lpEnvironment]
		push	eax
		push	ecx
		call	sub_1001C480
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001C78F
		push	0
		push	0FFFFE890h
		call	PR_SetError
		mov	esi, [esp+8Ch+lpEnvironment]
		mov	ebx, [esp+8Ch+lpCommandLine]
		jmp	loc_1001C87E
; ---------------------------------------------------------------------------

loc_1001C78F:				; CODE XREF: PR_CreateProcess_0+184j
		push	44h		; Size
		lea	edx, [esp+88h+Dst]
		push	0		; Val
		push	edx		; Dst
		call	memset
		add	esp, 0Ch
		mov	[esp+84h+Dst], 44h
		test	edi, edi
		jz	loc_1001C83D
		mov	esi, ds:GetStdHandle
		push	0FFFFFFF6h	; nStdHandle
		xor	edi, edi
		call	esi ; GetStdHandle
		push	0FFFFFFF5h	; nStdHandle
		mov	[esp+88h+var_C], eax
		call	esi ; GetStdHandle
		push	0FFFFFFF4h	; nStdHandle
		mov	[esp+88h+var_8], eax
		call	esi ; GetStdHandle
		mov	ecx, [esp+84h+arg_C]
		mov	[esp+84h+var_4], eax
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_1001C7F2
		mov	eax, [eax+4]
		mov	edx, [eax+28h]
		mov	[esp+84h+var_C], edx
		mov	edi, 1

loc_1001C7F2:				; CODE XREF: PR_CreateProcess_0+1F1j
		mov	eax, [ecx+4]
		test	eax, eax
		jz	short loc_1001C810
		mov	eax, [eax+4]
		mov	edx, [eax+28h]
		mov	[esp+84h+var_8], edx
		mov	edi, 1
		mov	[esp+84h+dwCreationFlags], 8000000h

loc_1001C810:				; CODE XREF: PR_CreateProcess_0+207j
		mov	eax, [ecx+8]
		test	eax, eax
		jz	short loc_1001C826
		mov	eax, [eax+4]
		mov	edx, [eax+28h]
		mov	[esp+84h+var_4], edx
		jmp	short loc_1001C82A
; ---------------------------------------------------------------------------

loc_1001C826:				; CODE XREF: PR_CreateProcess_0+225j
		test	edi, edi
		jz	short loc_1001C832

loc_1001C82A:				; CODE XREF: PR_CreateProcess_0+234j
		or	[esp+84h+var_18], 100h

loc_1001C832:				; CODE XREF: PR_CreateProcess_0+238j
		mov	eax, [ecx+0Ch]
		mov	ebp, [esp+84h+var_60]
		mov	[esp+84h+lpCurrentDirectory], eax

loc_1001C83D:				; CODE XREF: PR_CreateProcess_0+1BAj
		mov	eax, [esp+84h+lpCurrentDirectory]
		mov	esi, [esp+84h+lpEnvironment]
		mov	ebx, [esp+84h+lpCommandLine]
		lea	ecx, [esp+84h+ProcessInformation]
		push	ecx		; lpProcessInformation
		mov	ecx, [esp+88h+dwCreationFlags]
		lea	edx, [esp+88h+Dst]
		push	edx		; lpStartupInfo
		push	eax		; lpCurrentDirectory
		push	esi		; lpEnvironment
		push	ecx		; dwCreationFlags
		push	1		; bInheritHandles
		push	0		; lpThreadAttributes
		push	0		; lpProcessAttributes
		push	ebx		; lpCommandLine
		push	0		; lpApplicationName
		call	ds:CreateProcessA
		test	eax, eax
		jnz	short loc_1001C8C1
		call	ds:GetLastError
		push	eax
		push	0FFFFE896h
		call	PR_SetError

loc_1001C87E:				; CODE XREF: PR_CreateProcess_0+19Aj
		add	esp, 8
		xor	edi, edi

loc_1001C883:				; CODE XREF: PR_CreateProcess_0+77j
		cmp	ebx, edi
		jz	short loc_1001C890
		push	ebx		; Memory
		call	PR_Free
		add	esp, 4

loc_1001C890:				; CODE XREF: PR_CreateProcess_0+295j
		mov	eax, [esp+84h+Memory]
		cmp	eax, edi
		jz	short loc_1001C8A1
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_1001C8A1:				; CODE XREF: PR_CreateProcess_0+2A6j
		cmp	esi, edi
		jz	short loc_1001C8AE
		push	esi		; Memory
		call	PR_Free
		add	esp, 4

loc_1001C8AE:				; CODE XREF: PR_CreateProcess_0+2B3j
		push	ebp		; Memory
		call	PR_Free
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebp
		xor	eax, eax
		pop	ebx
		add	esp, 74h
		retn
; ---------------------------------------------------------------------------

loc_1001C8C1:				; CODE XREF: PR_CreateProcess_0+27Bj
		mov	edx, [esp+84h+ProcessInformation.hThread]
		push	edx		; hObject
		call	ds:CloseHandle
		mov	eax, [esp+84h+ProcessInformation.hProcess]
		mov	[ebp+0], eax
		mov	ecx, [esp+84h+ProcessInformation.dwProcessId]
		push	ebx		; Memory
		mov	[ebp+4], ecx
		call	PR_Free
		mov	eax, [esp+88h+Memory]
		add	esp, 4
		test	eax, eax
		jz	short loc_1001C8F4
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_1001C8F4:				; CODE XREF: PR_CreateProcess_0+2F9j
		test	esi, esi
		jz	short loc_1001C901
		push	esi		; Memory
		call	PR_Free
		add	esp, 4

loc_1001C901:				; CODE XREF: PR_CreateProcess_0+306j
		pop	edi
		pop	esi
		mov	eax, ebp
		pop	ebp
		pop	ebx
		add	esp, 74h
		retn
PR_CreateProcess_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DetachProcess_0(void *Memory)
PR_DetachProcess_0 proc	near		; CODE XREF: PR_DetachProcessj
					; PR_CreateProcessDetached+24p

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi]
		push	eax		; hObject
		call	ds:CloseHandle
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
PR_DetachProcess_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_WaitProcess_0(void *Memory, LPDWORD lpExitCode)
PR_WaitProcess_0 proc near		; CODE XREF: PR_WaitProcessj

Memory		= dword	ptr  4
lpExitCode	= dword	ptr  8

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi]
		push	0FFFFFFFFh	; dwMilliseconds
		push	eax		; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001C95E

loc_1001C945:				; CODE XREF: PR_WaitProcess_0+42j
		call	ds:GetLastError
		push	eax
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001C95E:				; CODE XREF: PR_WaitProcess_0+13j
		mov	eax, [esp+4+lpExitCode]
		test	eax, eax
		jz	short loc_1001C974
		mov	ecx, [esi]
		push	eax		; lpExitCode
		push	ecx		; hProcess
		call	ds:GetExitCodeProcess
		test	eax, eax
		jz	short loc_1001C945

loc_1001C974:				; CODE XREF: PR_WaitProcess_0+34j
		mov	edx, [esi]
		push	edx		; hObject
		call	ds:CloseHandle
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
PR_WaitProcess_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_KillProcess_0 proc near		; CODE XREF: PR_KillProcessj

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		push	100h		; uExitCode
		push	ecx		; hProcess
		call	ds:TerminateProcess
		test	eax, eax
		jz	short loc_1001C9A9
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001C9A9:				; CODE XREF: PR_KillProcess_0+14j
		call	ds:GetLastError
		push	eax
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
PR_KillProcess_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001C9D0(char	*name, int namelen)
sub_1001C9D0	proc near		; CODE XREF: PR_GetSystemInfo+31p

name		= dword	ptr  4
namelen		= dword	ptr  8

		mov	eax, [esp+namelen]
		mov	ecx, [esp+name]
		push	eax		; namelen
		push	ecx		; name
		call	gethostname
		test	eax, eax
		jnz	short loc_1001C9E4
		retn
; ---------------------------------------------------------------------------

loc_1001C9E4:				; CODE XREF: sub_1001C9D0+11j
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
sub_1001C9D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CA00	proc near		; CODE XREF: PR_GetSystemInfo:loc_1000F5AFp

Dst		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_88		= dword	ptr -88h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 98h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+98h+var_4], eax
		push	esi
		mov	esi, [esp+9Ch+arg_4]
		push	94h		; Size
		lea	eax, [esp+0A0h+Dst]
		push	0		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch
		lea	ecx, [esp+9Ch+Dst]
		push	ecx		; lpVersionInformation
		mov	[esp+0A0h+Dst],	94h
		call	ds:GetVersionExA
		test	eax, eax
		jnz	short loc_1001CA6F
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		mov	ecx, [esp+98h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 98h
		retn
; ---------------------------------------------------------------------------

loc_1001CA6F:				; CODE XREF: sub_1001CA00+45j
		mov	eax, [esp+9Ch+var_88]
		dec	eax
		jz	loc_1001CB21
		dec	eax
		mov	eax, [esp+9Ch+arg_0]
		jz	short loc_1001CAC9
		cmp	eax, 1
		jnz	short loc_1001CAB7
		mov	edx, [esp+9Ch+arg_8]
		push	offset aWindows_unknow ; "Windows_Unknown"
		push	edx
		push	esi
		call	PR_snprintf
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+98h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 98h
		retn
; ---------------------------------------------------------------------------

loc_1001CAB7:				; CODE XREF: sub_1001CA00+87j
		cmp	eax, 2
		jnz	loc_1001CBC0
		push	0
		push	0
		jmp	loc_1001CBAA
; ---------------------------------------------------------------------------

loc_1001CAC9:				; CODE XREF: sub_1001CA00+82j
		cmp	eax, 1
		jnz	short loc_1001CAFC
		mov	ecx, [esp+9Ch+arg_8]
		push	offset aWindows_nt ; "Windows_NT"
		push	ecx
		push	esi
		call	PR_snprintf
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+98h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 98h
		retn
; ---------------------------------------------------------------------------

loc_1001CAFC:				; CODE XREF: sub_1001CA00+CCj
		cmp	eax, 2
		jnz	loc_1001CBC0
		mov	edx, [esp+9Ch+var_90]
		mov	eax, [esp+9Ch+var_94]
		mov	ecx, [esp+9Ch+arg_8]
		push	edx
		push	eax
		push	offset aD_D	; "%d.%d"
		push	ecx
		jmp	loc_1001CBB7
; ---------------------------------------------------------------------------

loc_1001CB21:				; CODE XREF: sub_1001CA00+74j
		mov	eax, [esp+9Ch+arg_0]
		cmp	eax, 1
		jnz	short loc_1001CB9B
		mov	eax, [esp+9Ch+var_94]
		cmp	eax, 4
		ja	short loc_1001CB6D
		jnz	short loc_1001CB3F
		cmp	[esp+9Ch+var_90], 0
		ja	short loc_1001CB6D

loc_1001CB3F:				; CODE XREF: sub_1001CA00+136j
		mov	edx, [esp+9Ch+arg_8]
		push	offset aWindows_95 ; "Windows_95"
		push	edx
		push	esi
		call	PR_snprintf
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+98h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 98h
		retn
; ---------------------------------------------------------------------------

loc_1001CB6D:				; CODE XREF: sub_1001CA00+134j
					; sub_1001CA00+13Dj
		mov	eax, [esp+9Ch+arg_8]
		push	offset aWindows_98 ; "Windows_98"
		push	eax
		push	esi
		call	PR_snprintf
		add	esp, 0Ch
		xor	eax, eax
		pop	esi
		mov	ecx, [esp+98h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 98h
		retn
; ---------------------------------------------------------------------------

loc_1001CB9B:				; CODE XREF: sub_1001CA00+12Bj
		cmp	eax, 2
		jnz	short loc_1001CBC0
		mov	ecx, [esp+9Ch+var_90]
		mov	edx, [esp+9Ch+var_94]
		push	ecx
		push	edx

loc_1001CBAA:				; CODE XREF: sub_1001CA00+C4j
		mov	eax, [esp+0A4h+arg_8]
		push	offset aD_D	; "%d.%d"
		push	eax

loc_1001CBB7:				; CODE XREF: sub_1001CA00+11Cj
		push	esi
		call	PR_snprintf
		add	esp, 14h

loc_1001CBC0:				; CODE XREF: sub_1001CA00+BAj
					; sub_1001CA00+FFj ...
		mov	ecx, [esp+9Ch+var_4]
		pop	esi
		xor	ecx, esp
		xor	eax, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 98h
		retn
sub_1001CA00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001CBE0(int,	DWORD dwMaximumSizeLow,	DWORD dwMaximumSizeHigh)
sub_1001CBE0	proc near		; CODE XREF: PR_CreateFileMap+3Dp

arg_0		= dword	ptr  4
dwMaximumSizeLow= dword	ptr  8
dwMaximumSizeHigh= dword ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi]
		push	edi
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001CBF1
		or	edx, eax
		jmp	short loc_1001CBF7
; ---------------------------------------------------------------------------

loc_1001CBF1:				; CODE XREF: sub_1001CBE0+Bj
		mov	eax, [eax+4]
		mov	edx, [eax+28h]

loc_1001CBF7:				; CODE XREF: sub_1001CBE0+Fj
		mov	eax, [esi+4]
		mov	ecx, [esp+8+dwMaximumSizeHigh]
		test	eax, eax
		jnz	short loc_1001CC10
		mov	eax, 2
		mov	dword ptr [esi+0Ch], 4
		jmp	short loc_1001CC2F
; ---------------------------------------------------------------------------

loc_1001CC10:				; CODE XREF: sub_1001CBE0+20j
		cmp	eax, 1
		jnz	short loc_1001CC23
		mov	eax, 4
		mov	dword ptr [esi+0Ch], 2
		jmp	short loc_1001CC2F
; ---------------------------------------------------------------------------

loc_1001CC23:				; CODE XREF: sub_1001CBE0+33j
		mov	eax, 8
		mov	dword ptr [esi+0Ch], 1

loc_1001CC2F:				; CODE XREF: sub_1001CBE0+2Ej
					; sub_1001CBE0+41j
		mov	edi, [esp+8+dwMaximumSizeLow]
		push	0		; lpName
		push	edi		; dwMaximumSizeLow
		push	ecx		; dwMaximumSizeHigh
		push	eax		; flProtect
		push	0		; lpFileMappingAttributes
		push	edx		; hFile
		call	ds:CreateFileMappingA
		pop	edi
		mov	[esi+8], eax
		pop	esi
		test	eax, eax
		jnz	short loc_1001CC62
		call	ds:GetLastError
		push	eax
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1001CC62:				; CODE XREF: sub_1001CBE0+68j
		xor	eax, eax
		retn
sub_1001CBE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_GetMemMapAlignment_0	proc near	; CODE XREF: PR_GetMemMapAlignmentj

var_24		= byte ptr -24h
var_8		= dword	ptr -8

		sub	esp, 24h
		lea	eax, [esp+24h+var_24]
		push	eax		; lpSystemInfo
		call	ds:GetSystemInfo
		mov	eax, [esp+24h+var_8]
		add	esp, 24h
		retn
PR_GetMemMapAlignment_0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001CC90(CHAR	Buffer,	DWORD dwFileOffsetLow, DWORD dwFileOffsetHigh, SIZE_T dwNumberOfBytesToMap)
sub_1001CC90	proc near		; CODE XREF: PR_MemMap+14p

Buffer		= byte ptr  4
dwFileOffsetLow	= dword	ptr  8
dwFileOffsetHigh= dword	ptr  0Ch
dwNumberOfBytesToMap= dword ptr	 10h

		mov	eax, [esp+dwNumberOfBytesToMap]
		mov	ecx, [esp+dwFileOffsetLow]
		mov	edx, [esp+dwFileOffsetHigh]
		push	esi
		push	eax		; dwNumberOfBytesToMap
		mov	eax, dword ptr [esp+8+Buffer]
		push	ecx		; dwFileOffsetLow
		mov	ecx, [eax+0Ch]
		push	edx		; dwFileOffsetHigh
		mov	edx, [eax+8]
		push	ecx		; dwDesiredAccess
		push	edx		; hFileMappingObject
		call	ds:MapViewOfFile
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1001CD0B
		push	edi
		mov	edi, ds:GetLastError
		push	eax		; Arguments
		push	eax		; nSize
		lea	eax, [esp+10h+Buffer]
		push	eax		; lpBuffer
		push	400h		; dwLanguageId
		call	edi ; GetLastError
		push	eax		; dwMessageId
		push	esi		; lpSource
		push	1100h		; dwFlags
		call	ds:FormatMessageA
		mov	ecx, dword_10032AA4
		cmp	dword ptr [ecx+4], 4
		jl	short loc_1001CCF8
		mov	edx, dword ptr [esp+8+Buffer]
		push	edx
		push	offset aMd_memmapS ; "md_memmap(): %s"
		call	PR_LogPrint
		add	esp, 8

loc_1001CCF8:				; CODE XREF: sub_1001CC90+54j
		call	edi ; GetLastError
		push	eax
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		mov	eax, esi
		pop	edi

loc_1001CD0B:				; CODE XREF: sub_1001CC90+26j
		pop	esi
		retn
sub_1001CC90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_MemUnmap_0(LPCVOID lpBaseAddress)
PR_MemUnmap_0	proc near		; CODE XREF: PR_MemUnmapj

lpBaseAddress	= dword	ptr  4

		mov	eax, [esp+lpBaseAddress]
		push	eax		; lpBaseAddress
		call	ds:UnmapViewOfFile
		test	eax, eax
		jz	short loc_1001CD22
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_1001CD22:				; CODE XREF: PR_MemUnmap_0+Dj
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
PR_MemUnmap_0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_CloseFileMap_0(void *Memory)
PR_CloseFileMap_0 proc near		; CODE XREF: PR_CloseFileMapj

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi+8]
		push	eax		; hObject
		call	ds:CloseHandle
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
PR_CloseFileMap_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SyncMemMap_0(int, LPCVOID lpBaseAddress, SIZE_T dwNumberOfBytesToFlush)
PR_SyncMemMap_0	proc near		; CODE XREF: PR_SyncMemMapj

arg_0		= dword	ptr  4
lpBaseAddress	= dword	ptr  8
dwNumberOfBytesToFlush=	dword ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [esp+dwNumberOfBytesToFlush]
		mov	eax, [esp+lpBaseAddress]
		push	esi
		mov	esi, [ecx+28h]
		push	edx		; dwNumberOfBytesToFlush
		push	eax		; lpBaseAddress
		call	ds:FlushViewOfFile
		test	eax, eax
		jz	short loc_1001CD8E
		push	esi		; hFile
		call	ds:FlushFileBuffers
		test	eax, eax
		jz	short loc_1001CD8E
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1001CD8E:				; CODE XREF: PR_SyncMemMap_0+1Dj
					; PR_SyncMemMap_0+28j
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
PR_SyncMemMap_0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_AtomicIncrement_0 proc near		; CODE XREF: PR_AtomicIncrementj
					; sub_10017D10+136p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, 1
		lock xadd [ecx], eax
		inc	eax
		retn
PR_AtomicIncrement_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_AtomicDecrement_0 proc near		; CODE XREF: PR_AtomicDecrementj
					; sub_10017D10+1A9p

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, 0FFFFFFFFh
		lock xadd [ecx], eax
		dec	eax
		retn
PR_AtomicDecrement_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_AtomicAdd_0	proc near		; CODE XREF: PR_AtomicAddj

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		mov	edx, eax
		lock xadd [ecx], eax
		add	eax, edx
		retn
PR_AtomicAdd_0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 349. PR_StackPush

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public PR_StackPush
PR_StackPush	proc near		; CODE XREF: PR_FreeFileDesc_0+2Fp
					; PR_SetFDCacheSize+64p
					; DATA XREF: ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]

loc_1001CDFA:				; CODE XREF: PR_StackPush+Fj
					; PR_StackPush+1Bj
		mov	eax, [ebx]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001CDFA
		mov	eax, 0FFFFFFFFh
		xchg	eax, [ebx]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001CDFA
		mov	[ecx], eax
		mov	[ebx], ecx
		pop	ebx
		pop	ebp
		retn
PR_StackPush	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 348. PR_StackPop

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public PR_StackPop
PR_StackPop	proc near		; CODE XREF: sub_10001010+12p
					; PR_SetFDCacheSize+BCp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, [ebp+arg_0]

loc_1001CE27:				; CODE XREF: PR_StackPop+Cj
					; PR_StackPop+18j
		mov	eax, [ebx]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001CE27
		mov	eax, 0FFFFFFFFh
		xchg	eax, [ebx]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1001CE27
		cmp	eax, 0
		jz	short loc_1001CE48
		mov	ecx, [eax]
		mov	[ebx], ecx
		mov	byte ptr [eax],	0
		jmp	short loc_1001CE4A
; ---------------------------------------------------------------------------

loc_1001CE48:				; CODE XREF: PR_StackPop+1Dj
		mov	[ebx], eax

loc_1001CE4A:				; CODE XREF: PR_StackPop+26j
		pop	ebx
		pop	ebp
		retn
PR_StackPop	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CE50	proc near		; CODE XREF: sub_1001DFF0+FBp

ReturnLength	= dword	ptr -414h
TokenHandle	= dword	ptr -410h
TokenInformation= dword	ptr -40Ch
pIdentifierAuthority= _SID_IDENTIFIER_AUTHORITY	ptr -0Ch
var_4		= dword	ptr -4

		sub	esp, 414h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+414h+var_4], eax
		push	ebx
		lea	eax, [esp+418h+TokenHandle]
		push	eax		; TokenHandle
		xor	ebx, ebx
		push	8		; DesiredAccess
		mov	dword ptr [esp+420h+pIdentifierAuthority.Value], ebx
		mov	word ptr [esp+420h+pIdentifierAuthority.Value+4], 100h
		mov	[esp+420h+TokenHandle],	ebx
		call	ds:GetCurrentProcess
		push	eax		; ProcessHandle
		call	ds:OpenProcessToken
		test	eax, eax
		jnz	short loc_1001CECE
		mov	ecx, dword_10032A98
		cmp	dword ptr [ecx+4], 4
		jl	loc_1001CF8A
		call	ds:GetLastError
		push	eax
		push	offset a_pr_nt_initsid ; "_PR_NT_InitSids: OpenProcessToken() fai"...
		call	PR_LogPrint
		add	esp, 8
		pop	ebx
		mov	ecx, [esp+414h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 414h
		retn
; ---------------------------------------------------------------------------

loc_1001CECE:				; CODE XREF: sub_1001CE50+42j
		mov	ecx, [esp+418h+TokenHandle]
		push	ebp
		push	esi
		mov	esi, ds:GetTokenInformation
		push	edi
		lea	edx, [esp+424h+ReturnLength]
		push	edx		; ReturnLength
		push	400h		; TokenInformationLength
		lea	eax, [esp+42Ch+TokenInformation]
		push	eax		; TokenInformation
		push	4		; TokenInformationClass
		push	ecx		; TokenHandle
		call	esi ; GetTokenInformation
		mov	edx, [esp+424h+TokenInformation]
		mov	edi, ds:GetLengthSid
		push	edx		; pSid
		call	edi ; GetLengthSid
		push	eax		; Size
		mov	[esp+428h+ReturnLength], eax
		call	PR_Malloc
		mov	ecx, [esp+428h+TokenInformation]
		mov	edx, [esp+428h+ReturnLength]
		mov	ebp, ds:CopySid
		add	esp, 4
		push	ecx		; pSourceSid
		push	eax		; pDestinationSid
		push	edx		; nDestinationSidLength
		mov	pOwner,	eax
		call	ebp ; CopySid
		mov	edx, [esp+424h+TokenHandle]
		lea	eax, [esp+424h+ReturnLength]
		push	eax		; ReturnLength
		push	400h		; TokenInformationLength
		lea	ecx, [esp+42Ch+TokenInformation]
		push	ecx		; TokenInformation
		push	5		; TokenInformationClass
		push	edx		; TokenHandle
		call	esi ; GetTokenInformation
		mov	eax, [esp+424h+TokenInformation]
		push	eax		; pSid
		call	edi ; GetLengthSid
		push	eax		; Size
		mov	[esp+428h+ReturnLength], eax
		call	PR_Malloc
		mov	ecx, [esp+428h+TokenInformation]
		mov	edx, [esp+428h+ReturnLength]
		add	esp, 4
		push	ecx		; pSourceSid
		push	eax		; pDestinationSid
		push	edx		; nDestinationSidLength
		mov	pGroup,	eax
		call	ebp ; CopySid
		mov	eax, [esp+424h+TokenHandle]
		push	eax		; hObject
		call	ds:CloseHandle
		push	offset pSid	; pSid
		push	ebx		; nSubAuthority7
		push	ebx		; nSubAuthority6
		push	ebx		; nSubAuthority5
		push	ebx		; nSubAuthority4
		push	ebx		; nSubAuthority3
		push	ebx		; nSubAuthority2
		push	ebx		; nSubAuthority1
		push	ebx		; nSubAuthority0
		push	1		; nSubAuthorityCount
		lea	ecx, [esp+44Ch+pIdentifierAuthority]
		push	ecx		; pIdentifierAuthority
		call	ds:AllocateAndInitializeSid
		pop	edi
		pop	esi
		pop	ebp

loc_1001CF8A:				; CODE XREF: sub_1001CE50+4Ej
		mov	ecx, [esp+418h+var_4]
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 414h
		retn
sub_1001CE50	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001CFA0	proc near		; CODE XREF: sub_10024480p
		mov	eax, pOwner
		test	eax, eax
		jz	short loc_1001CFB2
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_1001CFB2:				; CODE XREF: sub_1001CFA0+7j
		mov	eax, pGroup
		test	eax, eax
		jz	short loc_1001CFC4
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_1001CFC4:				; CODE XREF: sub_1001CFA0+19j
		mov	eax, pSid
		test	eax, eax
		jz	short locret_1001CFD4
		push	eax		; pSid
		call	ds:FreeSid

locret_1001CFD4:			; CODE XREF: sub_1001CFA0+2Bj
		retn
sub_1001CFA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001CFE0	proc near		; CODE XREF: sub_10020340+EAp
					; sub_10021C00+2Cp ...

pSecurityDescriptor= dword ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	edi
		xor	edi, edi
		cmp	pOwner,	edi
		jnz	short loc_1001D000
		push	edi
		push	0FFFFE898h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001D000:				; CODE XREF: sub_1001CFE0+Aj
		push	ebx
		push	ebp
		push	esi
		push	14h		; Size
		call	PR_Malloc
		mov	ebx, eax
		add	esp, 4
		mov	[esp+14h+pSecurityDescriptor], ebx
		test	ebx, ebx
		jnz	short loc_1001D02F
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		pop	esi
		pop	ebp
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001D02F:				; CODE XREF: sub_1001CFE0+35j
		push	1		; dwRevision
		push	ebx		; pSecurityDescriptor
		call	ds:InitializeSecurityDescriptor
		test	eax, eax
		jnz	short loc_1001D04D
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		jmp	loc_1001D1F2
; ---------------------------------------------------------------------------

loc_1001D04D:				; CODE XREF: sub_1001CFE0+5Aj
		mov	eax, pOwner
		push	0		; bOwnerDefaulted
		push	eax		; pOwner
		push	ebx		; pSecurityDescriptor
		call	ds:SetSecurityDescriptorOwner
		test	eax, eax
		jnz	short loc_1001D071
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		jmp	loc_1001D1F2
; ---------------------------------------------------------------------------

loc_1001D071:				; CODE XREF: sub_1001CFE0+7Ej
		mov	ecx, pGroup
		push	0		; bGroupDefaulted
		push	ecx		; pGroup
		push	ebx		; pSecurityDescriptor
		call	ds:SetSecurityDescriptorGroup
		test	eax, eax
		jnz	short loc_1001D096
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		jmp	loc_1001D1F2
; ---------------------------------------------------------------------------

loc_1001D096:				; CODE XREF: sub_1001CFE0+A3j
		mov	edx, pSid
		mov	esi, ds:GetLengthSid
		push	edx		; pSid
		call	esi ; GetLengthSid
		mov	edi, eax
		mov	eax, pGroup
		push	eax		; pSid
		call	esi ; GetLengthSid
		mov	ecx, pOwner
		push	ecx		; pSid
		add	edi, eax
		call	esi ; GetLengthSid
		lea	esi, [eax+edi+20h]
		push	esi		; Size
		call	PR_Malloc
		mov	edi, eax
		add	esp, 4
		test	edi, edi
		jnz	short loc_1001D0DE
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		jmp	loc_1001D1F2
; ---------------------------------------------------------------------------

loc_1001D0DE:				; CODE XREF: sub_1001CFE0+EBj
		push	2		; dwAclRevision
		push	esi		; nAclLength
		push	edi		; pAcl
		call	ds:InitializeAcl
		test	eax, eax
		jnz	short loc_1001D0FD
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		jmp	loc_1001D1F2
; ---------------------------------------------------------------------------

loc_1001D0FD:				; CODE XREF: sub_1001CFE0+10Aj
		mov	ebx, [esp+14h+arg_0]
		mov	esi, [esp+14h+arg_4]
		xor	eax, eax
		test	ebx, 100h
		jz	short loc_1001D111
		mov	eax, [esi]

loc_1001D111:				; CODE XREF: sub_1001CFE0+12Dj
		test	bl, bl
		jns	short loc_1001D118
		or	eax, [esi+4]

loc_1001D118:				; CODE XREF: sub_1001CFE0+133j
		test	bl, 40h
		jz	short loc_1001D120
		or	eax, [esi+8]

loc_1001D120:				; CODE XREF: sub_1001CFE0+13Bj
		mov	ebp, ds:AddAccessAllowedAce
		test	eax, eax
		jz	short loc_1001D150
		mov	edx, pOwner
		push	edx		; pSid
		push	eax		; AccessMask
		push	2		; dwAceRevision
		push	edi		; pAcl
		call	ebp ; AddAccessAllowedAce
		test	eax, eax
		jnz	short loc_1001D150
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		mov	ebx, [esp+18h+pSecurityDescriptor]
		jmp	loc_1001D1F2
; ---------------------------------------------------------------------------

loc_1001D150:				; CODE XREF: sub_1001CFE0+148j
					; sub_1001CFE0+159j
		xor	eax, eax
		test	bl, 20h
		jz	short loc_1001D159
		mov	eax, [esi]

loc_1001D159:				; CODE XREF: sub_1001CFE0+175j
		test	bl, 10h
		jz	short loc_1001D161
		or	eax, [esi+4]

loc_1001D161:				; CODE XREF: sub_1001CFE0+17Cj
		test	bl, 8
		jz	short loc_1001D169
		or	eax, [esi+8]

loc_1001D169:				; CODE XREF: sub_1001CFE0+184j
		test	eax, eax
		jz	short loc_1001D190
		mov	ecx, pGroup
		push	ecx		; pSid
		push	eax		; AccessMask
		push	2		; dwAceRevision
		push	edi		; pAcl
		call	ebp ; AddAccessAllowedAce
		test	eax, eax
		jnz	short loc_1001D190
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		mov	ebx, [esp+18h+pSecurityDescriptor]
		jmp	short loc_1001D1F2
; ---------------------------------------------------------------------------

loc_1001D190:				; CODE XREF: sub_1001CFE0+18Bj
					; sub_1001CFE0+19Cj
		xor	eax, eax
		test	bl, 4
		jz	short loc_1001D199
		mov	eax, [esi]

loc_1001D199:				; CODE XREF: sub_1001CFE0+1B5j
		test	bl, 2
		jz	short loc_1001D1A1
		or	eax, [esi+4]

loc_1001D1A1:				; CODE XREF: sub_1001CFE0+1BCj
		test	bl, 1
		jz	short loc_1001D1A9
		or	eax, [esi+8]

loc_1001D1A9:				; CODE XREF: sub_1001CFE0+1C4j
		test	eax, eax
		jz	short loc_1001D1D0
		mov	edx, pSid
		push	edx		; pSid
		push	eax		; AccessMask
		push	2		; dwAceRevision
		push	edi		; pAcl
		call	ebp ; AddAccessAllowedAce
		test	eax, eax
		jnz	short loc_1001D1D0
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		mov	ebx, [esp+18h+pSecurityDescriptor]
		jmp	short loc_1001D1F2
; ---------------------------------------------------------------------------

loc_1001D1D0:				; CODE XREF: sub_1001CFE0+1CBj
					; sub_1001CFE0+1DCj
		mov	esi, [esp+14h+pSecurityDescriptor]
		push	0		; bDaclDefaulted
		push	edi		; pDacl
		push	1		; bDaclPresent
		push	esi		; pSecurityDescriptor
		call	ds:SetSecurityDescriptorDacl
		test	eax, eax
		jnz	short loc_1001D214
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		mov	ebx, esi

loc_1001D1F2:				; CODE XREF: sub_1001CFE0+68j
					; sub_1001CFE0+8Cj ...
		add	esp, 4
		push	ebx		; Memory
		call	PR_Free
		add	esp, 4
		test	edi, edi
		jz	short loc_1001D20B
		push	edi		; Memory
		call	PR_Free
		add	esp, 4

loc_1001D20B:				; CODE XREF: sub_1001CFE0+220j
		pop	esi
		pop	ebp
		pop	ebx
		or	eax, 0FFFFFFFFh
		pop	edi
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_1001D214:				; CODE XREF: sub_1001CFE0+202j
		mov	eax, [esp+14h+arg_8]
		mov	ecx, [esp+14h+arg_C]
		mov	[eax], esi
		pop	esi
		pop	ebp
		pop	ebx
		mov	[ecx], edi
		xor	eax, eax
		pop	edi
		pop	ecx
		retn
sub_1001CFE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001D230(void	*Memory, void *)
sub_1001D230	proc near		; CODE XREF: sub_10020340+13Fp
					; sub_10021C00+71p ...

Memory		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+Memory]
		test	eax, eax
		jz	short loc_1001D241
		push	eax		; Memory
		call	PR_Free
		add	esp, 4

loc_1001D241:				; CODE XREF: sub_1001D230+6j
		mov	eax, [esp+arg_4]
		test	eax, eax
		jz	short locret_1001D250
		push	eax		; Memory
		call	PR_Free
		pop	ecx

locret_1001D250:			; CODE XREF: sub_1001D230+17j
		retn
sub_1001D230	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION timeGetTime]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_1001D270	proc near		; CODE XREF: PR_TicksPerSecond:loc_1000D7BEj
					; PR_SecondsToInterval:loc_1000D7DEp ...
		mov	eax, 3E8h
		retn
sub_1001D270	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_GetGCRegisters_0 proc near		; CODE XREF: PR_GetGCRegistersj
					; PR_ThreadScanStackPointers+20p

Context		= CONTEXT ptr -2D0h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		sub	esp, 2D0h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2D0h+var_4], eax
		push	esi
		mov	esi, [esp+2D4h+arg_0]
		test	byte ptr [esi+90h], 80h
		push	edi
		mov	edi, [esp+2D8h+arg_8]
		mov	[esp+2D8h+Context.ContextFlags], 10002h
		jz	loc_1001D345
		mov	ecx, [esi+0F8h]
		lea	eax, [esp+2D8h+Context]
		push	eax		; lpContext
		push	ecx		; hThread
		mov	[esp+2E0h+Context.ContextFlags], 10003h
		call	ds:GetThreadContext
		test	eax, eax
		jz	loc_1001D3A1
		mov	edx, [esp+2D8h+Context._Eax]
		mov	eax, [esp+2D8h+Context._Ebx]
		mov	ecx, [esp+2D8h+Context._Ecx]
		mov	[esi+108h], edx
		mov	edx, [esp+2D8h+Context._Edx]
		mov	[esi+10Ch], eax
		mov	eax, [esp+2D8h+Context._Esi]
		mov	[esi+110h], ecx
		mov	ecx, [esp+2D8h+Context._Edi]
		mov	[esi+114h], edx
		mov	edx, [esp+2D8h+Context._Esp]
		mov	[esi+118h], eax
		mov	eax, [esp+2D8h+Context._Ebp]
		mov	[esi+11Ch], ecx
		mov	[esi+120h], edx
		mov	[esi+124h], eax
		jmp	short loc_1001D39B
; ---------------------------------------------------------------------------

loc_1001D345:				; CODE XREF: PR_GetGCRegisters_0+33j
		mov	eax, [esi+134h]
		xor	ecx, ecx
		mov	[esi+108h], ecx
		mov	edx, [eax+0B8h]
		mov	[esi+10Ch], edx
		mov	[esi+110h], ecx
		mov	[esi+114h], ecx
		mov	ecx, [eax+0B4h]
		mov	[esi+118h], ecx
		mov	edx, [eax+0B0h]
		mov	[esi+11Ch], edx
		mov	ecx, [eax+0D8h]
		mov	[esi+120h], ecx
		mov	edx, [eax+0C8h]
		mov	[esi+124h], edx

loc_1001D39B:				; CODE XREF: PR_GetGCRegisters_0+C3j
		mov	dword ptr [edi], 8

loc_1001D3A1:				; CODE XREF: PR_GetGCRegisters_0+55j
		mov	ecx, [esp+2D8h+var_4]
		pop	edi
		lea	eax, [esi+108h]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2D0h
		retn
PR_GetGCRegisters_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001D3C0	proc near		; CODE XREF: sub_10017D10+18Ep

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Exchange	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Dst		= dword	ptr -20h
dwMilliseconds	= dword	ptr -1Ch
var_18		= dword	ptr -18h
NumberOfBytesTransferred= dword	ptr -14h
CompletionKey	= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
Overlapped	= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		push	esi
		mov	[ebp+var_8], 0
		cmp	dword_100329E8,	0
		jbe	loc_1001D4A0
		push	offset stru_100329C0 ; lpCriticalSection
		call	ds:EnterCriticalSection

loc_1001D3E6:				; CODE XREF: sub_1001D3C0+D0j
		cmp	dword_100329E0,	offset dword_100329E0
		jz	loc_1001D495
		mov	eax, dword_100329E0
		sub	eax, 68h
		mov	[ebp+Dst], eax

loc_1001D401:				; CODE XREF: sub_1001D3C0+60j
		mov	ecx, [ebp+Dst]
		mov	edx, [ecx+6Ch]
		mov	eax, [ebp+Dst]
		mov	ecx, [eax+68h]
		mov	[edx], ecx
		mov	edx, [ebp+Dst]
		mov	eax, [edx+68h]
		mov	ecx, [ebp+Dst]
		mov	edx, [ecx+6Ch]
		mov	[eax+4], edx
		xor	eax, eax
		jnz	short loc_1001D401
		mov	ecx, [ebp+Dst]
		mov	edx, [ecx+90h]
		and	edx, 80h
		jnz	short loc_1001D451

loc_1001D433:				; CODE XREF: sub_1001D3C0+7Fj
		mov	eax, [ebp+Dst]
		cmp	dword ptr [eax+94h], 0
		jz	short loc_1001D441
		jmp	short loc_1001D433
; ---------------------------------------------------------------------------

loc_1001D441:				; CODE XREF: sub_1001D3C0+7Dj
		mov	ecx, [ebp+Dst]
		mov	edx, [ecx+134h]
		push	edx		; lpFiber
		call	ds:DeleteFiber

loc_1001D451:				; CODE XREF: sub_1001D3C0+71j
		push	14Ch		; Size
		push	0Ah		; Val
		mov	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		add	esp, 0Ch
		mov	ecx, [ebp+Dst]
		cmp	dword ptr [ecx+0A0h], 0
		jnz	short loc_1001D483
		mov	edx, [ebp+Dst]
		push	edx		; Memory
		call	PR_Free
		add	esp, 4
		mov	[ebp+Dst], 0

loc_1001D483:				; CODE XREF: sub_1001D3C0+AEj
		mov	eax, dword_100329E8
		sub	eax, 1
		mov	dword_100329E8,	eax
		jmp	loc_1001D3E6
; ---------------------------------------------------------------------------

loc_1001D495:				; CODE XREF: sub_1001D3C0+30j
		push	offset stru_100329C0 ; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1001D4A0:				; CODE XREF: sub_1001D3C0+15j
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_1001D4AF
		mov	[ebp+dwMilliseconds], 1388h
		jmp	short loc_1001D4BE
; ---------------------------------------------------------------------------

loc_1001D4AF:				; CODE XREF: sub_1001D3C0+E4j
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	PR_IntervalToMilliseconds
		add	esp, 4
		mov	[ebp+dwMilliseconds], eax

loc_1001D4BE:				; CODE XREF: sub_1001D3C0+EDj
					; sub_1001D3C0+7AAj
		mov	edx, 1
		test	edx, edx
		jz	loc_1001DB6F
		mov	eax, [ebp+dwMilliseconds]
		push	eax		; dwMilliseconds
		lea	ecx, [ebp+Overlapped]
		push	ecx		; lpOverlapped
		lea	edx, [ebp+CompletionKey]
		push	edx		; lpCompletionKey
		lea	eax, [ebp+NumberOfBytesTransferred]
		push	eax		; lpNumberOfBytesTransferred
		mov	ecx, ExistingCompletionPort
		push	ecx		; CompletionPort
		call	ds:GetQueuedCompletionStatus
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_1001D516
		cmp	[ebp+Overlapped], 0
		jnz	short loc_1001D516
		call	ds:GetLastError
		cmp	eax, 102h
		jz	short loc_1001D50E
		or	eax, 0FFFFFFFFh
		jmp	loc_1001DB71
; ---------------------------------------------------------------------------
		jmp	short loc_1001D516
; ---------------------------------------------------------------------------

loc_1001D50E:				; CODE XREF: sub_1001D3C0+142j
		mov	eax, [ebp+var_8]
		jmp	loc_1001DB71
; ---------------------------------------------------------------------------

loc_1001D516:				; CODE XREF: sub_1001D3C0+12Fj
					; sub_1001D3C0+135j ...
		cmp	[ebp+Overlapped], 0
		jnz	short loc_1001D523
		xor	eax, eax
		jmp	loc_1001DB71
; ---------------------------------------------------------------------------

loc_1001D523:				; CODE XREF: sub_1001D3C0+15Aj
		mov	edx, [ebp+Overlapped]
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_C]
		cmp	dword ptr [eax+14h], 49h
		jnz	loc_1001D801
		mov	[ebp+var_2C], 0
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+20h]
		mov	[ebp+var_24], edx
		mov	eax, [ebp+var_18]
		neg	eax
		sbb	eax, eax
		neg	eax
		sub	eax, 1
		mov	[ebp+Exchange],	eax
		push	1		; Comperand
		mov	ecx, [ebp+Exchange]
		push	ecx		; Exchange
		mov	edx, [ebp+var_24]
		add	edx, 0Ch
		push	edx		; Destination
		call	ds:InterlockedCompareExchange
		cmp	eax, 1
		jnz	short loc_1001D58A
		cmp	[ebp+Exchange],	0
		jnz	short loc_1001D57E
		mov	eax, [ebp+var_24]
		mov	ecx, [ebp+NumberOfBytesTransferred]
		mov	[eax+14h], ecx
		jmp	short loc_1001D58A
; ---------------------------------------------------------------------------

loc_1001D57E:				; CODE XREF: sub_1001D3C0+1B1j
		call	ds:GetLastError
		mov	edx, [ebp+var_C]
		mov	[edx+2Ch], eax

loc_1001D58A:				; CODE XREF: sub_1001D3C0+1ABj
					; sub_1001D3C0+1BCj
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+24h]
		mov	[ebp+var_28], ecx
		mov	edx, [ebp+var_28]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection

loc_1001D5A0:				; CODE XREF: sub_1001D3C0+214j
		mov	eax, [ebp+var_28]
		add	eax, 8
		mov	ecx, [ebp+var_C]
		mov	[ecx+18h], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_28]
		mov	ecx, [eax+0Ch]
		mov	[edx+1Ch], ecx
		mov	edx, [ebp+var_C]
		add	edx, 18h
		mov	eax, [ebp+var_28]
		mov	ecx, [eax+0Ch]
		mov	[ecx], edx
		mov	edx, [ebp+var_C]
		add	edx, 18h
		mov	eax, [ebp+var_28]
		mov	[eax+0Ch], edx
		xor	ecx, ecx
		jnz	short loc_1001D5A0
		mov	edx, [ebp+var_24]
		mov	eax, [edx+8]
		push	eax
		mov	ecx, [ebp+var_28]
		push	ecx
		call	sub_10001980
		add	esp, 8
		mov	edx, [ebp+var_28]
		add	edx, 58h
		mov	eax, [ebp+var_28]
		cmp	[eax+58h], edx
		jz	short loc_1001D624
		mov	ecx, [ebp+var_28]
		mov	edx, [ecx+58h]
		sub	edx, 70h
		mov	[ebp+var_2C], edx

loc_1001D603:				; CODE XREF: sub_1001D3C0+262j
		mov	eax, [ebp+var_2C]
		mov	ecx, [eax+74h]
		mov	edx, [ebp+var_2C]
		mov	eax, [edx+70h]
		mov	[ecx], eax
		mov	ecx, [ebp+var_2C]
		mov	edx, [ecx+70h]
		mov	eax, [ebp+var_2C]
		mov	ecx, [eax+74h]
		mov	[edx+4], ecx
		xor	edx, edx
		jnz	short loc_1001D603

loc_1001D624:				; CODE XREF: sub_1001D3C0+235j
		mov	eax, [ebp+var_28]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		cmp	[ebp+var_2C], 0
		jz	loc_1001D7FC
		mov	ecx, [ebp+var_2C]
		mov	edx, [ecx+90h]
		and	edx, 80h
		jnz	loc_1001D7C5
		mov	eax, [ebp+var_2C]
		mov	ecx, [eax+4]
		mov	[ebp+var_34], ecx
		cmp	dword_1003067C,	0
		jz	short loc_1001D67C
		mov	edx, TlsIndex
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edx*4]
		mov	edx, [ecx+14h]
		mov	[ebp+var_48], edx
		jmp	short loc_1001D68B
; ---------------------------------------------------------------------------

loc_1001D67C:				; CODE XREF: sub_1001D3C0+2A0j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[ebp+var_48], eax

loc_1001D68B:				; CODE XREF: sub_1001D3C0+2BAj
		mov	ecx, [ebp+var_48]
		mov	[ebp+var_38], ecx
		mov	edx, [ebp+var_2C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+var_2C]
		mov	ecx, [eax+90h]
		and	ecx, 20h
		jz	loc_1001D7B6
		mov	edx, [ebp+var_2C]
		mov	eax, [edx+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_2C]
		mov	dword ptr [edx+58h], 0
		push	1
		mov	eax, [ebp+var_2C]
		push	eax
		call	_PR_DelSleepQ
		add	esp, 8
		mov	ecx, [ebp+var_2C]
		mov	edx, [ecx+9Ch]
		mov	eax, [edx+24h]
		add	eax, 18h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [ebp+var_2C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_38]
		mov	[edx+9Ch], eax
		mov	ecx, [ebp+var_2C]
		mov	dword ptr [ecx], 1

loc_1001D716:				; CODE XREF: sub_1001D3C0+365j
		mov	edx, [ebp+var_38]
		mov	eax, [edx+24h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		xor	ecx, ecx
		jnz	short loc_1001D716

loc_1001D727:				; CODE XREF: sub_1001D3C0+3B7j
					; sub_1001D3C0+3E1j
		mov	edx, [ebp+var_38]
		mov	eax, [edx+24h]
		mov	ecx, [ebp+var_34]
		lea	edx, [eax+ecx*8+48h]
		mov	eax, [ebp+var_2C]
		mov	[eax+68h], edx
		mov	ecx, [ebp+var_38]
		mov	edx, [ecx+24h]
		mov	eax, [ebp+var_2C]
		mov	ecx, [ebp+var_34]
		mov	edx, [edx+ecx*8+4Ch]
		mov	[eax+6Ch], edx
		mov	eax, [ebp+var_38]
		mov	ecx, [eax+24h]
		mov	edx, [ebp+var_34]
		mov	eax, [ecx+edx*8+4Ch]
		mov	ecx, [ebp+var_2C]
		add	ecx, 68h
		mov	[eax], ecx
		mov	edx, [ebp+var_38]
		mov	eax, [edx+24h]
		mov	ecx, [ebp+var_2C]
		add	ecx, 68h
		mov	edx, [ebp+var_34]
		mov	[eax+edx*8+4Ch], ecx
		xor	eax, eax
		jnz	short loc_1001D727
		mov	ecx, [ebp+var_38]
		mov	edx, [ecx+24h]
		mov	eax, [ebp+var_38]
		mov	eax, [eax+24h]
		mov	esi, 1
		mov	ecx, [ebp+var_34]
		shl	esi, cl
		or	esi, [eax+68h]
		mov	[edx+68h], esi
		mov	ecx, [ebp+var_2C]
		mov	dword ptr [ecx+58h], 1
		xor	edx, edx
		jnz	short loc_1001D727

loc_1001D7A3:				; CODE XREF: sub_1001D3C0+3F2j
		mov	eax, [ebp+var_38]
		mov	ecx, [eax+24h]
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		xor	edx, edx
		jnz	short loc_1001D7A3
		jmp	short loc_1001D7C3
; ---------------------------------------------------------------------------

loc_1001D7B6:				; CODE XREF: sub_1001D3C0+2EAj
		mov	eax, [ebp+var_2C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1001D7C3:				; CODE XREF: sub_1001D3C0+3F4j
		jmp	short loc_1001D7FC
; ---------------------------------------------------------------------------

loc_1001D7C5:				; CODE XREF: sub_1001D3C0+28Aj
		mov	ecx, [ebp+var_2C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_2C]
		mov	dword ptr [edx], 1
		mov	eax, [ebp+var_2C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0		; lpPreviousCount
		push	1		; lReleaseCount
		mov	ecx, [ebp+var_2C]
		mov	edx, [ecx+0E8h]
		push	edx		; hSemaphore
		call	ds:ReleaseSemaphore

loc_1001D7FC:				; CODE XREF: sub_1001D3C0+275j
					; sub_1001D3C0:loc_1001D7C3j
		jmp	loc_1001DB5A
; ---------------------------------------------------------------------------

loc_1001D801:				; CODE XREF: sub_1001D3C0+170j
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+18h]
		sub	ecx, 0B0h
		mov	[ebp+var_3C], ecx
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		mov	[edx+0ECh], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_1001D831
		call	ds:GetLastError
		mov	ecx, [ebp+var_3C]
		mov	[ecx+0F4h], eax

loc_1001D831:				; CODE XREF: sub_1001D3C0+460j
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+NumberOfBytesTransferred]
		mov	[edx+0F0h], eax
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx+90h]
		and	edx, 80h
		jnz	loc_1001DAF8
		mov	eax, [ebp+var_3C]
		mov	ecx, [eax+4]
		mov	[ebp+var_40], ecx
		cmp	dword_1003067C,	0
		jz	short loc_1001D87E
		mov	edx, TlsIndex
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edx*4]
		mov	edx, [ecx+14h]
		mov	[ebp+var_4C], edx
		jmp	short loc_1001D88D
; ---------------------------------------------------------------------------

loc_1001D87E:				; CODE XREF: sub_1001D3C0+4A2j
		mov	eax, dword_100329EC
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[ebp+var_4C], eax

loc_1001D88D:				; CODE XREF: sub_1001D3C0+4BCj
		mov	ecx, [ebp+var_4C]
		mov	[ebp+var_44], ecx
		cmp	[ebp+CompletionKey], 0BBBBBBBBh
		jnz	loc_1001D958
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_44]
		mov	[edx+9Ch], eax
		mov	ecx, [ebp+var_3C]
		mov	dword ptr [ecx], 1

loc_1001D8B5:				; CODE XREF: sub_1001D3C0+504j
		mov	edx, [ebp+var_44]
		mov	eax, [edx+24h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		xor	ecx, ecx
		jnz	short loc_1001D8B5

loc_1001D8C6:				; CODE XREF: sub_1001D3C0+556j
					; sub_1001D3C0+580j
		mov	edx, [ebp+var_44]
		mov	eax, [edx+24h]
		mov	ecx, [ebp+var_40]
		lea	edx, [eax+ecx*8+48h]
		mov	eax, [ebp+var_3C]
		mov	[eax+68h], edx
		mov	ecx, [ebp+var_44]
		mov	edx, [ecx+24h]
		mov	eax, [ebp+var_3C]
		mov	ecx, [ebp+var_40]
		mov	edx, [edx+ecx*8+4Ch]
		mov	[eax+6Ch], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [eax+24h]
		mov	edx, [ebp+var_40]
		mov	eax, [ecx+edx*8+4Ch]
		mov	ecx, [ebp+var_3C]
		add	ecx, 68h
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		mov	eax, [edx+24h]
		mov	ecx, [ebp+var_3C]
		add	ecx, 68h
		mov	edx, [ebp+var_40]
		mov	[eax+edx*8+4Ch], ecx
		xor	eax, eax
		jnz	short loc_1001D8C6
		mov	ecx, [ebp+var_44]
		mov	edx, [ecx+24h]
		mov	eax, [ebp+var_44]
		mov	eax, [eax+24h]
		mov	esi, 1
		mov	ecx, [ebp+var_40]
		shl	esi, cl
		or	esi, [eax+68h]
		mov	[edx+68h], esi
		mov	ecx, [ebp+var_3C]
		mov	dword ptr [ecx+58h], 1
		xor	edx, edx
		jnz	short loc_1001D8C6

loc_1001D942:				; CODE XREF: sub_1001D3C0+591j
		mov	eax, [ebp+var_44]
		mov	ecx, [eax+24h]
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		xor	edx, edx
		jnz	short loc_1001D942
		jmp	loc_1001DAF6
; ---------------------------------------------------------------------------

loc_1001D958:				; CODE XREF: sub_1001D3C0+4DAj
		mov	eax, [ebp+var_3C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_3C]
		mov	dword ptr [ecx+0A4h], 0
		mov	edx, [ebp+var_3C]
		cmp	dword ptr [edx+0ACh], 0
		jnz	loc_1001DAE9
		mov	eax, [ebp+var_3C]
		mov	ecx, [eax+90h]
		and	ecx, 30h
		jz	loc_1001DADA
		mov	edx, [ebp+var_3C]
		mov	eax, [edx+9Ch]
		mov	ecx, [eax+24h]
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_3C]
		mov	dword ptr [edx+58h], 0
		push	1
		mov	eax, [ebp+var_3C]
		push	eax
		call	_PR_DelSleepQ
		add	esp, 8
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx+9Ch]
		mov	eax, [edx+24h]
		add	eax, 18h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [ebp+var_3C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	edx, [ebp+var_3C]
		cmp	dword ptr [edx+128h], 0
		jnz	short loc_1001D9FD
		mov	eax, [ebp+var_3C]
		mov	ecx, [ebp+var_44]
		mov	[eax+9Ch], ecx

loc_1001D9FD:				; CODE XREF: sub_1001D3C0+62Fj
		mov	edx, [ebp+var_3C]
		mov	dword ptr [edx], 1

loc_1001DA06:				; CODE XREF: sub_1001D3C0+65Bj
		mov	eax, [ebp+var_3C]
		mov	ecx, [eax+9Ch]
		mov	edx, [ecx+24h]
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		xor	eax, eax
		jnz	short loc_1001DA06

loc_1001DA1D:				; CODE XREF: sub_1001D3C0+6C5j
					; sub_1001D3C0+6FBj
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx+9Ch]
		mov	eax, [edx+24h]
		mov	ecx, [ebp+var_40]
		lea	edx, [eax+ecx*8+48h]
		mov	eax, [ebp+var_3C]
		mov	[eax+68h], edx
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx+9Ch]
		mov	eax, [edx+24h]
		mov	ecx, [ebp+var_3C]
		mov	edx, [ebp+var_40]
		mov	eax, [eax+edx*8+4Ch]
		mov	[ecx+6Ch], eax
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx+9Ch]
		mov	eax, [edx+24h]
		mov	ecx, [ebp+var_40]
		mov	edx, [eax+ecx*8+4Ch]
		mov	eax, [ebp+var_3C]
		add	eax, 68h
		mov	[edx], eax
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx+9Ch]
		mov	eax, [edx+24h]
		mov	ecx, [ebp+var_3C]
		add	ecx, 68h
		mov	edx, [ebp+var_40]
		mov	[eax+edx*8+4Ch], ecx
		xor	eax, eax
		jnz	short loc_1001DA1D
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx+9Ch]
		mov	eax, [edx+24h]
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx+9Ch]
		mov	edx, [edx+24h]
		mov	esi, 1
		mov	ecx, [ebp+var_40]
		shl	esi, cl
		or	esi, [edx+68h]
		mov	[eax+68h], esi
		mov	eax, [ebp+var_3C]
		mov	dword ptr [eax+58h], 1
		xor	ecx, ecx
		jnz	loc_1001DA1D

loc_1001DAC1:				; CODE XREF: sub_1001D3C0+716j
		mov	edx, [ebp+var_3C]
		mov	eax, [edx+9Ch]
		mov	ecx, [eax+24h]
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		xor	edx, edx
		jnz	short loc_1001DAC1
		jmp	short loc_1001DAE7
; ---------------------------------------------------------------------------

loc_1001DADA:				; CODE XREF: sub_1001D3C0+5CEj
		mov	eax, [ebp+var_3C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1001DAE7:				; CODE XREF: sub_1001D3C0+718j
		jmp	short loc_1001DAF6
; ---------------------------------------------------------------------------

loc_1001DAE9:				; CODE XREF: sub_1001D3C0+5BCj
		mov	ecx, [ebp+var_3C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1001DAF6:				; CODE XREF: sub_1001D3C0+593j
					; sub_1001D3C0:loc_1001DAE7j
		jmp	short loc_1001DB5A
; ---------------------------------------------------------------------------

loc_1001DAF8:				; CODE XREF: sub_1001D3C0+48Cj
		mov	edx, [ebp+var_3C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+var_3C]
		mov	dword ptr [eax+0A4h], 0
		mov	ecx, [ebp+var_3C]
		cmp	dword ptr [ecx+0ACh], 0
		jnz	short loc_1001DB4D
		mov	edx, [ebp+var_3C]
		mov	dword ptr [edx], 1
		mov	eax, [ebp+var_3C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0		; lpPreviousCount
		push	1		; lReleaseCount
		mov	ecx, [ebp+var_3C]
		mov	edx, [ecx+0E8h]
		push	edx		; hSemaphore
		call	ds:ReleaseSemaphore
		mov	[ebp+var_18], eax
		jmp	short loc_1001DB5A
; ---------------------------------------------------------------------------

loc_1001DB4D:				; CODE XREF: sub_1001D3C0+75Cj
		mov	eax, [ebp+var_3C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1001DB5A:				; CODE XREF: sub_1001D3C0:loc_1001D7FCj
					; sub_1001D3C0:loc_1001DAF6j ...
		mov	ecx, [ebp+var_8]
		add	ecx, 1
		mov	[ebp+var_8], ecx
		mov	[ebp+dwMilliseconds], 0
		jmp	loc_1001D4BE
; ---------------------------------------------------------------------------

loc_1001DB6F:				; CODE XREF: sub_1001D3C0+105j
		xor	eax, eax

loc_1001DB71:				; CODE XREF: sub_1001D3C0+147j
					; sub_1001D3C0+151j ...
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001D3C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001DB80	proc near		; CODE XREF: PR_CancelWaitGroup+19Fp
					; PR_WaitRecvReady+F9p	...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
dwMilliseconds	= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword_10031524,	0
		jz	short loc_1001DBA4
		mov	eax, [ebp+arg_4]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	sub_1001DD70
		add	esp, 8
		jmp	loc_1001DD6A
; ---------------------------------------------------------------------------

loc_1001DBA4:				; CODE XREF: sub_1001DB80+Dj
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+90h]
		and	eax, 80h
		jz	loc_1001DCE9
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_1001DBC7
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_1001DBD6
; ---------------------------------------------------------------------------

loc_1001DBC7:				; CODE XREF: sub_1001DB80+3Cj
		mov	ecx, [ebp+arg_4]
		push	ecx
		call	PR_IntervalToMilliseconds
		add	esp, 4
		mov	[ebp+var_10], eax

loc_1001DBD6:				; CODE XREF: sub_1001DB80+45j
		mov	edx, [ebp+var_10]
		mov	[ebp+dwMilliseconds], edx
		mov	eax, [ebp+dwMilliseconds]
		push	eax		; dwMilliseconds
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+0E8h]
		push	edx		; hHandle
		call	ds:WaitForSingleObject
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_1001DC0D
		cmp	[ebp+var_14], 102h
		jz	short loc_1001DC19
		jmp	loc_1001DCDF
; ---------------------------------------------------------------------------

loc_1001DC0D:				; CODE XREF: sub_1001DB80+7Dj
		xor	eax, eax
		jmp	loc_1001DD6A
; ---------------------------------------------------------------------------
		jmp	loc_1001DCE7
; ---------------------------------------------------------------------------

loc_1001DC19:				; CODE XREF: sub_1001DB80+86j
		mov	ecx, [ebp+arg_0]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+arg_0]
		cmp	dword ptr [edx], 6
		jnz	short loc_1001DC83
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+0A4h], 1
		jnz	short loc_1001DC5F
		mov	ecx, [ebp+arg_0]
		mov	dword ptr [ecx], 2
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx+0ACh], 1
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001DC81
; ---------------------------------------------------------------------------

loc_1001DC5F:				; CODE XREF: sub_1001DB80+B8j
		mov	ecx, [ebp+arg_0]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0FFFFFFFFh	; dwMilliseconds
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+0E8h]
		push	eax		; hHandle
		call	ds:WaitForSingleObject
		mov	[ebp+var_4], eax

loc_1001DC81:				; CODE XREF: sub_1001DB80+DDj
		jmp	short loc_1001DCD6
; ---------------------------------------------------------------------------

loc_1001DC83:				; CODE XREF: sub_1001DB80+ACj
		mov	ecx, [ebp+arg_0]
		cmp	dword ptr [ecx+88h], 0
		jz	short loc_1001DCB4
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx+88h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 2
		mov	ecx, [ebp+arg_0]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001DCD6
; ---------------------------------------------------------------------------

loc_1001DCB4:				; CODE XREF: sub_1001DB80+10Dj
		mov	edx, [ebp+arg_0]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E8h]
		push	ecx		; hHandle
		call	ds:WaitForSingleObject
		mov	[ebp+var_4], eax

loc_1001DCD6:				; CODE XREF: sub_1001DB80:loc_1001DC81j
					; sub_1001DB80+132j
		xor	eax, eax
		jmp	loc_1001DD6A
; ---------------------------------------------------------------------------
		jmp	short loc_1001DCE7
; ---------------------------------------------------------------------------

loc_1001DCDF:				; CODE XREF: sub_1001DB80+88j
		or	eax, 0FFFFFFFFh
		jmp	loc_1001DD6A
; ---------------------------------------------------------------------------

loc_1001DCE7:				; CODE XREF: sub_1001DB80+94j
					; sub_1001DB80+15Dj
		jmp	short loc_1001DD68
; ---------------------------------------------------------------------------

loc_1001DCE9:				; CODE XREF: sub_1001DB80+32j
					; sub_1001DB80+1DAj
		cmp	dword_1003067C,	0
		jz	short loc_1001DD0C
		mov	edx, TlsIndex
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edx*4]
		mov	edx, [ecx+10h]
		mov	[ebp+var_18], edx
		jmp	short loc_1001DD1B
; ---------------------------------------------------------------------------

loc_1001DD0C:				; CODE XREF: sub_1001DB80+170j
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue
		mov	[ebp+var_18], eax

loc_1001DD1B:				; CODE XREF: sub_1001DB80+18Aj
		mov	ecx, [ebp+var_18]
		mov	[ebp+var_C], ecx

loc_1001DD21:				; CODE XREF: sub_1001DB80+1D6j
		cmp	dword_1003067C,	0
		jz	short loc_1001DD45
		mov	edx, TlsIndex
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edx*4]
		mov	dword ptr [ecx+10h], 1
		jmp	short loc_1001DD54
; ---------------------------------------------------------------------------

loc_1001DD45:				; CODE XREF: sub_1001DB80+1A8j
		push	1		; lpTlsValue
		mov	edx, dwTlsIndex
		push	edx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001DD54:				; CODE XREF: sub_1001DB80+1C3j
		xor	eax, eax
		jnz	short loc_1001DD21
		xor	ecx, ecx
		jnz	short loc_1001DCE9
		mov	edx, [ebp+arg_0]
		push	edx
		call	sub_10024960
		add	esp, 4

loc_1001DD68:				; CODE XREF: sub_1001DB80:loc_1001DCE7j
		xor	eax, eax

loc_1001DD6A:				; CODE XREF: sub_1001DB80+1Fj
					; sub_1001DB80+8Fj ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001DB80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001DD70	proc near		; CODE XREF: sub_1001DB80+17p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
dwMilliseconds	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_1001DD85
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_1001DD94
; ---------------------------------------------------------------------------

loc_1001DD85:				; CODE XREF: sub_1001DD70+Aj
		mov	eax, [ebp+arg_4]
		push	eax
		call	PR_IntervalToMilliseconds
		add	esp, 4
		mov	[ebp+var_C], eax

loc_1001DD94:				; CODE XREF: sub_1001DD70+13j
		mov	ecx, [ebp+var_C]
		mov	[ebp+dwMilliseconds], ecx
		mov	edx, [ebp+dwMilliseconds]
		push	edx		; dwMilliseconds
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E8h]
		push	ecx		; hHandle
		call	ds:WaitForSingleObject
		mov	[ebp+var_8], eax
		mov	edx, [ebp+var_8]
		mov	[ebp+var_10], edx
		cmp	[ebp+var_10], 0
		jz	short loc_1001DDC8
		cmp	[ebp+var_10], 102h
		jz	short loc_1001DDCE
		jmp	short loc_1001DE34
; ---------------------------------------------------------------------------

loc_1001DDC8:				; CODE XREF: sub_1001DD70+4Bj
		xor	eax, eax
		jmp	short loc_1001DE3B
; ---------------------------------------------------------------------------
		jmp	short loc_1001DE39
; ---------------------------------------------------------------------------

loc_1001DDCE:				; CODE XREF: sub_1001DD70+54j
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+arg_0]
		cmp	dword ptr [ecx+88h], 0
		jz	short loc_1001DE0C
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx+88h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 2
		mov	ecx, [ebp+arg_0]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001DE2E
; ---------------------------------------------------------------------------

loc_1001DE0C:				; CODE XREF: sub_1001DD70+75j
		mov	edx, [ebp+arg_0]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0FFFFFFFFh	; dwMilliseconds
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E8h]
		push	ecx		; hHandle
		call	ds:WaitForSingleObject
		mov	[ebp+var_8], eax

loc_1001DE2E:				; CODE XREF: sub_1001DD70+9Aj
		xor	eax, eax
		jmp	short loc_1001DE3B
; ---------------------------------------------------------------------------
		jmp	short loc_1001DE39
; ---------------------------------------------------------------------------

loc_1001DE34:				; CODE XREF: sub_1001DD70+56j
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001DE3B
; ---------------------------------------------------------------------------

loc_1001DE39:				; CODE XREF: sub_1001DD70+5Cj
					; sub_1001DD70+C2j
		xor	eax, eax

loc_1001DE3B:				; CODE XREF: sub_1001DD70+5Aj
					; sub_1001DD70+C0j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001DD70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001DE40	proc near		; CODE XREF: PR_Interrupt+B5p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+9Ch]
		mov	[ebp+var_4], ecx
		mov	edx, [ebp+arg_0]
		cmp	dword ptr [edx+12Ch], 1
		jnz	short loc_1001DE70
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	loc_1001DF0F
; ---------------------------------------------------------------------------

loc_1001DE70:				; CODE XREF: sub_1001DE40+1Cj
		mov	ecx, [ebp+arg_0]
		mov	dword ptr [ecx+0ACh], 1
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx], 1
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+90h]
		and	ecx, 80h
		jnz	short loc_1001DEF3
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_4]
		mov	eax, [edx+24h]
		add	eax, 18h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+arg_0]
		mov	dword ptr [ecx+58h], 0
		push	1
		mov	edx, [ebp+arg_0]
		push	edx
		call	_PR_DelSleepQ
		add	esp, 8
		mov	eax, [ebp+var_4]
		mov	ecx, [eax+24h]
		add	ecx, 18h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_4]
		mov	[edx+128h], eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		mov	edx, [ebp+var_C]
		push	edx
		call	sub_1001BCA0
		add	esp, 8

loc_1001DEF3:				; CODE XREF: sub_1001DE40+55j
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	sub_1001DF20
		add	esp, 4
		mov	[ebp+var_8], eax

loc_1001DF0F:				; CODE XREF: sub_1001DE40+2Bj
		mov	esp, ebp
		pop	ebp
		retn
sub_1001DE40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001DF20	proc near		; CODE XREF: sub_10017C20+17p
					; sub_10018240+F6p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	[ebp+arg_0], 0
		jnz	short loc_1001DF52
		push	0		; lpOverlapped
		push	0BBBBBBBBh	; dwCompletionKey
		push	0		; dwNumberOfBytesTransferred
		mov	eax, ExistingCompletionPort
		push	eax		; CompletionPort
		call	ds:PostQueuedCompletionStatus
		test	eax, eax
		jnz	short loc_1001DF4B
		or	eax, 0FFFFFFFFh
		jmp	loc_1001DFE8
; ---------------------------------------------------------------------------

loc_1001DF4B:				; CODE XREF: sub_1001DF20+21j
		xor	eax, eax
		jmp	loc_1001DFE8
; ---------------------------------------------------------------------------

loc_1001DF52:				; CODE XREF: sub_1001DF20+8j
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+90h]
		and	edx, 80h
		jz	short loc_1001DF88
		push	0		; lpPreviousCount
		push	1		; lReleaseCount
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E8h]
		push	ecx		; hSemaphore
		call	ds:ReleaseSemaphore
		test	eax, eax
		jnz	short loc_1001DF82
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001DFE8
; ---------------------------------------------------------------------------
		jmp	short loc_1001DF86
; ---------------------------------------------------------------------------

loc_1001DF82:				; CODE XREF: sub_1001DF20+59j
		xor	eax, eax
		jmp	short loc_1001DFE8
; ---------------------------------------------------------------------------

loc_1001DF86:				; CODE XREF: sub_1001DF20+60j
		jmp	short loc_1001DFE8
; ---------------------------------------------------------------------------

loc_1001DF88:				; CODE XREF: sub_1001DF20+41j
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_4], eax
		mov	edx, [ebp+var_4]
		mov	eax, [edx+90h]
		and	eax, 80h
		jnz	short loc_1001DFB4
		mov	ecx, [ebp+arg_0]
		mov	edx, [ebp+var_4]
		mov	eax, [ecx+9Ch]
		cmp	eax, [edx+9Ch]
		jz	short loc_1001DFE6

loc_1001DFB4:				; CODE XREF: sub_1001DF20+7Ej
		mov	ecx, [ebp+arg_0]
		cmp	dword ptr [ecx+128h], 0
		jnz	short loc_1001DFE6
		mov	edx, [ebp+arg_0]
		add	edx, 0B0h
		push	edx		; lpOverlapped
		push	0BBBBBBBBh	; dwCompletionKey
		push	0		; dwNumberOfBytesTransferred
		mov	eax, ExistingCompletionPort
		push	eax		; CompletionPort
		call	ds:PostQueuedCompletionStatus
		test	eax, eax
		jnz	short loc_1001DFE6
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001DFE8
; ---------------------------------------------------------------------------

loc_1001DFE6:				; CODE XREF: sub_1001DF20+92j
					; sub_1001DF20+9Ej ...
		xor	eax, eax

loc_1001DFE8:				; CODE XREF: sub_1001DF20+26j
					; sub_1001DF20+2Dj ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001DF20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001DFF0	proc near		; CODE XREF: sub_10014A90+12Ej

var_23C		= dword	ptr -23Ch
VersionInformation= _OSVERSIONINFOA ptr	-238h
var_19C		= word ptr -19Ch
WSAData		= WSAData ptr -198h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 23Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, 101h
		mov	[ebp+var_19C], ax
		lea	ecx, [ebp+WSAData]
		push	ecx		; lpWSAData
		movzx	edx, [ebp+var_19C]
		push	edx		; wVersionRequested
		call	WSAStartup
		mov	[ebp+var_23C], eax
		push	0		; NumberOfConcurrentThreads
		push	0		; CompletionKey
		push	0		; ExistingCompletionPort
		push	0FFFFFFFFh	; FileHandle
		call	ds:CreateIoCompletionPort
		mov	ExistingCompletionPort,	eax
		push	offset stru_100315E4 ; lpCriticalSection
		call	ds:InitializeCriticalSection
		push	offset stru_10032A20 ; lpCriticalSection
		call	ds:InitializeCriticalSection
		mov	[ebp+VersionInformation.dwOSVersionInfoSize], 94h
		lea	eax, [ebp+VersionInformation]
		push	eax		; lpVersionInformation
		call	ds:GetVersionExA
		test	eax, eax
		jz	short loc_1001E08A
		mov	dword_100329F4,	0
		cmp	[ebp+VersionInformation.dwMajorVersion], 4
		jb	short loc_1001E08A
		mov	dword_100329F4,	1

loc_1001E08A:				; CODE XREF: sub_1001DFF0+7Bj
					; sub_1001DFF0+8Ej
		call	sub_10022490
		mov	dword_100315D0,	0
		mov	dword_100315D8,	0
		mov	ecx, dword_100315D8
		mov	dword_100315D4,	ecx
		call	PR_NewLock
		mov	dword_100315C0,	eax
		mov	edx, dword_100315C0
		push	edx
		call	PR_NewCondVar
		add	esp, 4
		mov	dword_100315C8,	eax
		push	0
		push	0
		push	1
		push	3
		push	0
		push	offset sub_10023780
		push	1
		call	PR_CreateThread
		add	esp, 1Ch
		mov	dword_100315C4,	eax
		call	sub_1001CE50
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1001DFF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001E100(HANDLE FileHandle)
sub_1001E100	proc near		; CODE XREF: PR_AddWaitFileDesc+1B6p
					; PR_LockFile+15p ...

var_4		= dword	ptr -4
FileHandle	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	dword_10031524,	0
		jnz	short loc_1001E139
		push	0		; NumberOfConcurrentThreads
		push	0AAAAAAAAh	; CompletionKey
		mov	eax, ExistingCompletionPort
		push	eax		; ExistingCompletionPort
		mov	ecx, [ebp+FileHandle]
		push	ecx		; FileHandle
		call	ds:CreateIoCompletionPort
		mov	[ebp+var_4], eax
		mov	edx, [ebp+var_4]
		xor	eax, eax
		cmp	edx, ExistingCompletionPort
		setz	al
		jmp	short loc_1001E13E
; ---------------------------------------------------------------------------
		jmp	short loc_1001E13E
; ---------------------------------------------------------------------------

loc_1001E139:				; CODE XREF: sub_1001E100+Bj
		mov	eax, 1

loc_1001E13E:				; CODE XREF: sub_1001E100+35j
					; sub_1001E100+37j
		mov	esp, ebp
		pop	ebp
		retn
sub_1001E100	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001E150(int,	int type, int protocol)
sub_1001E150	proc near		; CODE XREF: _pr_test_ipv6_socket+6p
					; PR_Socket+52p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
type		= dword	ptr  0Ch
protocol	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+protocol]
		push	eax		; protocol
		mov	ecx, [ebp+type]
		push	ecx		; type
		mov	edx, [ebp+arg_0]
		push	edx		; af
		call	socket
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_1001E17C
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4

loc_1001E17C:				; CODE XREF: sub_1001E150+1Cj
		mov	eax, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_1001E150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001E190(int,	struct sockaddr	*name, int namelen, int)
sub_1001E190	proc near		; CODE XREF: sub_10014EA0+55p

argp		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
s		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
name		= dword	ptr  0Ch
namelen		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+4], 0
		jz	short loc_1001E209
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+2Ch], 0
		jnz	short loc_1001E1D6
		mov	ecx, [ebp+s]
		push	ecx		; s
		call	sub_1001E270
		add	esp, 4
		mov	[ebp+var_C], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		mov	dword ptr [eax+2Ch], 1

loc_1001E1D6:				; CODE XREF: sub_1001E190+28j
		mov	ecx, [ebp+namelen]
		push	ecx		; namelen
		mov	edx, [ebp+name]
		push	edx		; name
		mov	eax, [ebp+s]
		push	eax		; s
		call	connect
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_1001E204
		call	WSAGetLastError
		mov	[ebp+var_10], eax
		mov	ecx, [ebp+var_10]
		push	ecx
		call	sub_10025460
		add	esp, 4

loc_1001E204:				; CODE XREF: sub_1001E190+5Ej
		mov	eax, [ebp+var_C]
		jmp	short loc_1001E25F
; ---------------------------------------------------------------------------

loc_1001E209:				; CODE XREF: sub_1001E190+1Cj
		mov	[ebp+argp], 1
		lea	edx, [ebp+argp]
		push	edx		; argp
		push	8004667Eh	; cmd
		mov	eax, [ebp+s]
		push	eax		; s
		call	ioctlsocket
		mov	[ebp+var_C], eax
		mov	ecx, [ebp+arg_C]
		push	ecx		; int
		mov	edx, [ebp+namelen]
		push	edx		; namelen
		mov	eax, [ebp+name]
		push	eax		; name
		mov	ecx, [ebp+arg_0]
		push	ecx		; int
		call	sub_10022C00
		add	esp, 10h
		mov	[ebp+var_4], eax
		mov	[ebp+argp], 0
		lea	edx, [ebp+argp]
		push	edx		; argp
		push	8004667Eh	; cmd
		mov	eax, [ebp+s]
		push	eax		; s
		call	ioctlsocket
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_4]

loc_1001E25F:				; CODE XREF: sub_1001E190+77j
		mov	esp, ebp
		pop	ebp
		retn
sub_1001E190	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001E270(SOCKET s)
sub_1001E270	proc near		; CODE XREF: sub_1001E190+2Ep
					; sub_1001E300+42p ...

argp		= dword	ptr -8
var_4		= dword	ptr -4
s		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+argp], 1
		lea	eax, [ebp+argp]
		push	eax		; argp
		push	8004667Eh	; cmd
		mov	ecx, [ebp+s]
		push	ecx		; s
		call	ioctlsocket
		mov	[ebp+var_4], eax
		xor	eax, eax
		cmp	[ebp+var_4], 0
		setz	al
		mov	esp, ebp
		pop	ebp
		retn
sub_1001E270	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001E2A0(int,	struct sockaddr	*name, int namelen)
sub_1001E2A0	proc near		; CODE XREF: sub_10015010+1Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
name		= dword	ptr  0Ch
namelen		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+namelen]
		push	eax		; namelen
		mov	ecx, [ebp+name]
		push	ecx		; name
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		mov	ecx, [eax+28h]
		push	ecx		; s
		call	bind
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_1001E2D7
		call	WSAGetLastError
		push	eax
		call	sub_100254B0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001E2D9
; ---------------------------------------------------------------------------

loc_1001E2D7:				; CODE XREF: sub_1001E2A0+22j
		xor	eax, eax

loc_1001E2D9:				; CODE XREF: sub_1001E2A0+35j
		mov	esp, ebp
		pop	ebp
		retn
sub_1001E2A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001E2E0(SOCKET s, char optval)
sub_1001E2E0	proc near		; CODE XREF: PR_NTFast_UpdateAcceptContext+1Cj
					; sub_1001E300+40Fp ...

s		= dword	ptr  8
optval		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	4		; optlen
		lea	eax, [ebp+optval]
		push	eax		; optval
		push	700Bh		; optname
		push	0FFFFh		; level
		mov	ecx, [ebp+s]
		push	ecx		; s
		call	setsockopt
		pop	ebp
		retn
sub_1001E2E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001E300(int,	void *Dst, LPINT RemoteSockaddrLength, int, int)
sub_1001E300	proc near		; CODE XREF: sub_10016180+A9p
					; PR_NTFast_Accept+B5p

argp		= dword	ptr -28h
var_24		= dword	ptr -24h
s		= dword	ptr -20h
LocalSockaddr	= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
sListenSocket	= dword	ptr -10h
dwBytesReceived	= dword	ptr -0Ch
RemoteSockaddr	= dword	ptr -8
LocalSockaddrLength= dword ptr -4
arg_0		= dword	ptr  8
Dst		= dword	ptr  0Ch
RemoteSockaddrLength= dword ptr	 10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+sListenSocket], edx
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_1001E332
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+8], 1
		jnz	short loc_1001E3A5

loc_1001E332:				; CODE XREF: sub_1001E300+24j
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+2Ch], 0
		jnz	short loc_1001E35A
		mov	eax, [ebp+sListenSocket]
		push	eax		; s
		call	sub_1001E270
		add	esp, 4
		mov	[ebp+var_14], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	dword ptr [edx+2Ch], 1

loc_1001E35A:				; CODE XREF: sub_1001E300+3Cj
		mov	eax, [ebp+arg_C]
		push	eax		; int
		mov	ecx, [ebp+RemoteSockaddrLength]
		push	ecx		; addrlen
		mov	edx, [ebp+Dst]
		push	edx		; addr
		mov	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_100229A0
		add	esp, 10h
		mov	[ebp+s], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+4], 0
		jnz	short loc_1001E39D
		mov	[ebp+argp], 0
		lea	eax, [ebp+argp]
		push	eax		; argp
		push	8004667Eh	; cmd
		mov	ecx, [ebp+s]
		push	ecx		; s
		call	ioctlsocket
		mov	[ebp+var_14], eax

loc_1001E39D:				; CODE XREF: sub_1001E300+7Fj
		mov	eax, [ebp+s]
		jmp	loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E3A5:				; CODE XREF: sub_1001E300+30j
		mov	edx, [ebp+var_24]
		cmp	dword ptr [edx+0ACh], 0
		jz	short loc_1001E3C8
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E3C8:				; CODE XREF: sub_1001E300+AFj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+2Ch], 0
		jnz	short loc_1001E3F0
		mov	edx, [ebp+sListenSocket]
		push	edx		; FileHandle
		call	sub_1001E100
		add	esp, 4
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	dword ptr [ecx+2Ch], 1

loc_1001E3F0:				; CODE XREF: sub_1001E300+D2j
		mov	edx, [ebp+var_24]
		cmp	dword ptr [edx+0E0h], 0
		jnz	short loc_1001E432
		push	60h		; Size
		call	PR_Malloc
		add	esp, 4
		mov	ecx, [ebp+var_24]
		mov	[ecx+0E0h], eax
		mov	edx, [ebp+var_24]
		cmp	dword ptr [edx+0E0h], 0
		jnz	short loc_1001E432
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E432:				; CODE XREF: sub_1001E300+FAj
					; sub_1001E300+119j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, word ptr [ecx+58h]
		push	edx
		call	sub_1001EA90
		add	esp, 4
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jnz	short loc_1001E456
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E456:				; CODE XREF: sub_1001E300+14Cj
		xor	eax, eax
		mov	ecx, [ebp+var_24]
		add	ecx, 0B0h
		mov	[ecx], eax
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		mov	[ecx+0Ch], eax
		mov	[ecx+10h], eax
		cmp	dword_10031524,	0
		jz	short loc_1001E48A
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_24]
		mov	ecx, [eax+130h]
		mov	[edx+0C0h], ecx

loc_1001E48A:				; CODE XREF: sub_1001E300+176j
		mov	edx, [ebp+var_24]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+var_24]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_1001E4F8
		mov	edx, [ebp+var_24]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_1001E4F8
		mov	ecx, [ebp+var_24]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+var_24]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	ecx, [ebp+var_24]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	edx, [ebp+s]
		push	edx		; s
		call	closesocket
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E4F8:				; CODE XREF: sub_1001E300+1A6j
					; sub_1001E300+1B4j
		mov	eax, [ebp+var_24]
		mov	dword ptr [eax+0A4h], 1
		mov	ecx, [ebp+var_24]
		mov	dword ptr [ecx], 6
		mov	edx, [ebp+var_24]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_24]
		mov	ecx, [ebp+sListenSocket]
		mov	[eax+0A8h], ecx
		mov	edx, [ebp+var_24]
		add	edx, 0B0h
		push	edx		; lpOverlapped
		lea	eax, [ebp+dwBytesReceived]
		push	eax		; lpdwBytesReceived
		push	30h		; dwRemoteAddressLength
		push	30h		; dwLocalAddressLength
		push	0		; dwReceiveDataLength
		mov	ecx, [ebp+var_24]
		mov	edx, [ecx+0E0h]
		push	edx		; lpOutputBuffer
		mov	eax, [ebp+s]
		push	eax		; sAcceptSocket
		mov	ecx, [ebp+sListenSocket]
		push	ecx		; sListenSocket
		call	AcceptEx
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_1001E619
		call	WSAGetLastError
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 3E5h
		jz	loc_1001E619
		mov	edx, [ebp+s]
		push	edx		; s
		call	closesocket
		mov	eax, [ebp+var_24]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_24]
		mov	dword ptr [ecx+0A4h], 0
		mov	edx, [ebp+var_24]
		mov	dword ptr [edx], 2
		mov	eax, [ebp+var_24]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_1001E5F8
		mov	edx, [ebp+var_24]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_1001E5F8
		mov	ecx, [ebp+var_24]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+var_24]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	ecx, [ebp+var_24]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E5F8:				; CODE XREF: sub_1001E300+2AFj
					; sub_1001E300+2BDj
		mov	edx, [ebp+var_24]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_18]
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E619:				; CODE XREF: sub_1001E300+259j
					; sub_1001E300+26Ej
		cmp	dword_10031524,	0
		jz	short loc_1001E63E
		cmp	[ebp+var_14], 0
		jz	short loc_1001E63E
		mov	ecx, [ebp+dwBytesReceived]
		push	ecx
		mov	edx, [ebp+var_14]
		push	edx
		mov	eax, [ebp+var_24]
		push	eax
		call	sub_1001E760
		add	esp, 0Ch
		jmp	short loc_1001E664
; ---------------------------------------------------------------------------

loc_1001E63E:				; CODE XREF: sub_1001E300+320j
					; sub_1001E300+326j
		mov	ecx, [ebp+arg_C]
		push	ecx
		mov	edx, [ebp+var_24]
		push	edx
		call	sub_1001E800
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001E664
		mov	eax, [ebp+s]
		push	eax		; s
		call	closesocket
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E664:				; CODE XREF: sub_1001E300+33Cj
					; sub_1001E300+351j
		mov	ecx, [ebp+var_24]
		cmp	dword ptr [ecx+0ACh], 0
		jz	short loc_1001E6D5
		mov	edx, [ebp+s]
		push	edx		; s
		call	closesocket
		mov	eax, [ebp+var_24]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_1001E6BE
		mov	edx, [ebp+var_24]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_1001E6BE
		mov	ecx, [ebp+var_24]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+var_24]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_1001E6CD
; ---------------------------------------------------------------------------

loc_1001E6BE:				; CODE XREF: sub_1001E300+388j
					; sub_1001E300+396j
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8

loc_1001E6CD:				; CODE XREF: sub_1001E300+3BCj
		or	eax, 0FFFFFFFFh
		jmp	loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E6D5:				; CODE XREF: sub_1001E300+36Ej
		mov	ecx, [ebp+var_24]
		cmp	dword ptr [ecx+0ECh], 0
		jnz	short loc_1001E701
		mov	edx, [ebp+s]
		push	edx		; s
		call	closesocket
		mov	eax, [ebp+var_24]
		mov	ecx, [eax+0F4h]
		push	ecx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001E75B
; ---------------------------------------------------------------------------

loc_1001E701:				; CODE XREF: sub_1001E300+3DFj
		cmp	[ebp+arg_10], 0
		jnz	short loc_1001E717
		mov	edx, [ebp+sListenSocket]
		push	edx		; optval
		mov	eax, [ebp+s]
		push	eax		; s
		call	sub_1001E2E0
		add	esp, 8

loc_1001E717:				; CODE XREF: sub_1001E300+405j
		mov	ecx, [ebp+RemoteSockaddrLength]
		push	ecx		; RemoteSockaddrLength
		lea	edx, [ebp+RemoteSockaddr]
		push	edx		; RemoteSockaddr
		lea	eax, [ebp+LocalSockaddrLength]
		push	eax		; LocalSockaddrLength
		lea	ecx, [ebp+LocalSockaddr]
		push	ecx		; LocalSockaddr
		push	30h		; dwRemoteAddressLength
		push	30h		; dwLocalAddressLength
		push	0		; dwReceiveDataLength
		mov	edx, [ebp+var_24]
		mov	eax, [edx+0E0h]
		push	eax		; lpOutputBuffer
		call	GetAcceptExSockaddrs
		cmp	[ebp+Dst], 0
		jz	short loc_1001E758
		mov	ecx, [ebp+RemoteSockaddrLength]
		mov	edx, [ecx]
		push	edx		; Size
		mov	eax, [ebp+RemoteSockaddr]
		push	eax		; Src
		mov	ecx, [ebp+Dst]
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch

loc_1001E758:				; CODE XREF: sub_1001E300+440j
		mov	eax, [ebp+s]

loc_1001E75B:				; CODE XREF: sub_1001E300+A0j
					; sub_1001E300+C3j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001E300	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001E760	proc near		; CODE XREF: sub_1001E300+334p
					; sub_1001EB70+274p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+arg_0]
		cmp	dword ptr [ecx], 6
		jnz	short loc_1001E79E
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx], 2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0A4h], 0
		mov	ecx, [ebp+arg_0]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001E7CD
; ---------------------------------------------------------------------------

loc_1001E79E:				; CODE XREF: sub_1001E760+17j
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx+0A4h], 0
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0FFFFFFFFh	; dwMilliseconds
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+0E8h]
		push	edx		; hHandle
		call	ds:WaitForSingleObject
		mov	[ebp+var_4], eax

loc_1001E7CD:				; CODE XREF: sub_1001E760+3Cj
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		mov	[eax+0ECh], ecx
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+arg_8]
		mov	[edx+0F0h], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+130h]
		push	edx		; hEvent
		call	ds:ResetEvent
		mov	[ebp+var_4], eax
		mov	esp, ebp
		pop	ebp
		retn
sub_1001E760	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001E800	proc near		; CODE XREF: sub_1001E300+346p
					; sub_1001EB70+286p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	[ebp+var_4], 1
		cmp	dword_10031524,	0
		jz	short loc_1001E829
		mov	eax, [ebp+arg_4]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	sub_1001E8D0
		add	esp, 8
		jmp	loc_1001E8CA
; ---------------------------------------------------------------------------

loc_1001E829:				; CODE XREF: sub_1001E800+12j
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+90h]
		and	eax, 80h
		jnz	short loc_1001E8AE
		mov	ecx, [ebp+arg_0]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+arg_0]
		cmp	dword ptr [edx+0A4h], 1
		jnz	short loc_1001E89A
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+9Ch]
		mov	edx, [ecx+24h]
		add	edx, 18h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+58h], 2
		mov	ecx, [ebp+arg_4]
		push	ecx
		mov	edx, [ebp+arg_0]
		push	edx
		call	_PR_AddSleepQ
		add	esp, 8
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+9Ch]
		mov	edx, [ecx+24h]
		add	edx, 18h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001E8A1
; ---------------------------------------------------------------------------

loc_1001E89A:				; CODE XREF: sub_1001E800+50j
		mov	[ebp+var_4], 0

loc_1001E8A1:				; CODE XREF: sub_1001E800+98j
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1001E8AE:				; CODE XREF: sub_1001E800+37j
		cmp	[ebp+var_4], 0
		jz	short loc_1001E8C8
		mov	ecx, [ebp+arg_4]
		push	ecx
		mov	edx, [ebp+arg_0]
		push	edx
		call	sub_1001DB80
		add	esp, 8
		jmp	short loc_1001E8CA
; ---------------------------------------------------------------------------
		jmp	short loc_1001E8CA
; ---------------------------------------------------------------------------

loc_1001E8C8:				; CODE XREF: sub_1001E800+B2j
		xor	eax, eax

loc_1001E8CA:				; CODE XREF: sub_1001E800+24j
					; sub_1001E800+C4j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001E800	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001E8D0	proc near		; CODE XREF: sub_1001E800+1Cp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
NumberOfBytesTransferred= dword	ptr -10h
Handles		= dword	ptr -0Ch
var_8		= dword	ptr -8
dwMilliseconds	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_1001E8E5
		mov	[ebp+var_18], 0FFFFFFFFh
		jmp	short loc_1001E8F4
; ---------------------------------------------------------------------------

loc_1001E8E5:				; CODE XREF: sub_1001E8D0+Aj
		mov	eax, [ebp+arg_4]
		push	eax
		call	PR_IntervalToMilliseconds
		add	esp, 4
		mov	[ebp+var_18], eax

loc_1001E8F4:				; CODE XREF: sub_1001E8D0+13j
		mov	ecx, [ebp+var_18]
		mov	[ebp+dwMilliseconds], ecx
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+0E8h]
		mov	[ebp+Handles], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+130h]
		mov	[ebp+var_8], edx
		mov	eax, [ebp+dwMilliseconds]
		push	eax		; dwMilliseconds
		push	0		; bWaitAll
		lea	ecx, [ebp+Handles]
		push	ecx		; lpHandles
		push	2		; nCount
		call	ds:WaitForMultipleObjects
		mov	[ebp+var_14], eax
		mov	edx, [ebp+var_14]
		mov	[ebp+var_1C], edx
		cmp	[ebp+var_1C], 0
		jz	loc_1001EA1F
		cmp	[ebp+var_1C], 1
		jz	short loc_1001E94F
		cmp	[ebp+var_1C], 102h
		jz	loc_1001EA21
		jmp	loc_1001EA7F
; ---------------------------------------------------------------------------

loc_1001E94F:				; CODE XREF: sub_1001E8D0+6Bj
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+arg_0]
		cmp	dword ptr [ecx], 6
		jnz	short loc_1001E989
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx], 2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0A4h], 0
		mov	ecx, [ebp+arg_0]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001E9B8
; ---------------------------------------------------------------------------

loc_1001E989:				; CODE XREF: sub_1001E8D0+92j
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx+0A4h], 0
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0FFFFFFFFh	; dwMilliseconds
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+0E8h]
		push	edx		; hHandle
		call	ds:WaitForSingleObject
		mov	[ebp+var_14], eax

loc_1001E9B8:				; CODE XREF: sub_1001E8D0+B7j
		push	0		; bWait
		lea	eax, [ebp+NumberOfBytesTransferred]
		push	eax		; lpNumberOfBytesTransferred
		mov	ecx, [ebp+arg_0]
		add	ecx, 0B0h
		push	ecx		; lpOverlapped
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+0A8h]
		push	eax		; hFile
		call	ds:GetOverlappedResult
		mov	[ebp+var_14], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[ecx+0ECh], edx
		cmp	[ebp+var_14], 0
		jz	short loc_1001E9FB
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+NumberOfBytesTransferred]
		mov	[eax+0F0h], ecx
		jmp	short loc_1001EA0A
; ---------------------------------------------------------------------------

loc_1001E9FB:				; CODE XREF: sub_1001E8D0+11Bj
		call	ds:GetLastError
		mov	edx, [ebp+arg_0]
		mov	[edx+0F4h], eax

loc_1001EA0A:				; CODE XREF: sub_1001E8D0+129j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+130h]
		push	ecx		; hEvent
		call	ds:ResetEvent
		mov	[ebp+var_14], eax
		jmp	short loc_1001EA84
; ---------------------------------------------------------------------------

loc_1001EA1F:				; CODE XREF: sub_1001E8D0+61j
		jmp	short loc_1001EA84
; ---------------------------------------------------------------------------

loc_1001EA21:				; CODE XREF: sub_1001E8D0+74j
		mov	edx, [ebp+arg_0]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax], 6
		jnz	short loc_1001EA5B
		mov	ecx, [ebp+arg_0]
		mov	dword ptr [ecx], 2
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx+0ACh], 1
		mov	eax, [ebp+arg_0]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001EA7D
; ---------------------------------------------------------------------------

loc_1001EA5B:				; CODE XREF: sub_1001E8D0+164j
		mov	ecx, [ebp+arg_0]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0FFFFFFFFh	; dwMilliseconds
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+0E8h]
		push	eax		; hHandle
		call	ds:WaitForSingleObject
		mov	[ebp+var_14], eax

loc_1001EA7D:				; CODE XREF: sub_1001E8D0+189j
		jmp	short loc_1001EA84
; ---------------------------------------------------------------------------

loc_1001EA7F:				; CODE XREF: sub_1001E8D0+7Aj
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001EA86
; ---------------------------------------------------------------------------

loc_1001EA84:				; CODE XREF: sub_1001E8D0+14Dj
					; sub_1001E8D0:loc_1001EA1Fj ...
		xor	eax, eax

loc_1001EA86:				; CODE XREF: sub_1001E8D0+1B2j
		mov	esp, ebp
		pop	ebp
		retn
sub_1001E8D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001EA90	proc near		; CODE XREF: sub_1001E300+13Dp
					; sub_1001EB70+77p

s		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	offset stru_100315E4 ; lpCriticalSection
		call	ds:EnterCriticalSection
		cmp	[ebp+arg_0], 2
		jnz	short loc_1001EADE
		cmp	dword_10032600,	0
		jz	short loc_1001EADE
		mov	eax, dword_10032600
		sub	eax, 1
		mov	dword_10032600,	eax
		mov	ecx, dword_10032600
		mov	edx, dword_10031600[ecx*4]
		mov	[ebp+s], edx
		push	offset stru_100315E4 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+s]
		jmp	loc_1001EB5F
; ---------------------------------------------------------------------------

loc_1001EADE:				; CODE XREF: sub_1001EA90+13j
					; sub_1001EA90+1Cj
		cmp	[ebp+arg_0], 17h
		jnz	short loc_1001EB1A
		cmp	dword_10032604,	0
		jz	short loc_1001EB1A
		mov	eax, dword_10032604
		sub	eax, 1
		mov	dword_10032604,	eax
		mov	ecx, dword_10032604
		mov	edx, dword_10031E00[ecx*4]
		mov	[ebp+s], edx
		push	offset stru_100315E4 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+s]
		jmp	short loc_1001EB5F
; ---------------------------------------------------------------------------

loc_1001EB1A:				; CODE XREF: sub_1001EA90+52j
					; sub_1001EA90+5Bj
		push	offset stru_100315E4 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0		; protocol
		push	1		; type
		mov	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_1001E150
		add	esp, 0Ch
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jz	short loc_1001EB5C
		mov	ecx, [ebp+s]
		push	ecx		; FileHandle
		call	sub_1001E100
		add	esp, 4
		test	eax, eax
		jnz	short loc_1001EB5C
		mov	edx, [ebp+s]
		push	edx		; s
		call	closesocket
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001EB5F
; ---------------------------------------------------------------------------

loc_1001EB5C:				; CODE XREF: sub_1001EA90+ACj
					; sub_1001EA90+BCj
		mov	eax, [ebp+s]

loc_1001EB5F:				; CODE XREF: sub_1001EA90+49j
					; sub_1001EA90+88j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001EA90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001EB70(int,	int, struct sockaddr **RemoteSockaddr, PVOID lpOutputBuffer, DWORD dwReceiveDataLength,	int, int, int, int)
sub_1001EB70	proc near		; CODE XREF: sub_10016460+B1p
					; PR_NTFast_AcceptRead+93p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
optlen		= dword	ptr -30h
optval		= byte ptr -2Ch
lpTlsValue	= dword	ptr -28h
LocalSockaddr	= dword	ptr -24h
var_20		= dword	ptr -20h
RemoteSockaddrLength= dword ptr	-1Ch
var_18		= dword	ptr -18h
dwBytesReceived	= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
sListenSocket	= dword	ptr -8
LocalSockaddrLength= dword ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
RemoteSockaddr	= dword	ptr  10h
lpOutputBuffer	= dword	ptr  14h
dwReceiveDataLength= dword ptr	18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+sListenSocket], edx
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+lpTlsValue], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+lpTlsValue]
		cmp	dword ptr [eax+0ACh], 0
		jz	short loc_1001EBB4
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F020
; ---------------------------------------------------------------------------

loc_1001EBB4:				; CODE XREF: sub_1001EB70+2Bj
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+2Ch], 0
		jnz	short loc_1001EBDC
		mov	eax, [ebp+sListenSocket]
		push	eax		; FileHandle
		call	sub_1001E100
		add	esp, 4
		mov	[ebp+var_18], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	dword ptr [edx+2Ch], 1

loc_1001EBDC:				; CODE XREF: sub_1001EB70+4Ej
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, word ptr [ecx+58h]
		push	edx
		call	sub_1001EA90
		add	esp, 4
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	edx, [ebp+arg_4]
		cmp	dword ptr [edx], 0FFFFFFFFh
		jnz	short loc_1001EC04
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F020
; ---------------------------------------------------------------------------

loc_1001EC04:				; CODE XREF: sub_1001EB70+8Aj
		xor	eax, eax
		mov	ecx, [ebp+lpTlsValue]
		add	ecx, 0B0h
		mov	[ecx], eax
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		mov	[ecx+0Ch], eax
		mov	[ecx+10h], eax
		cmp	dword_10031524,	0
		jz	short loc_1001EC38
		mov	edx, [ebp+lpTlsValue]
		mov	eax, [ebp+lpTlsValue]
		mov	ecx, [eax+130h]
		mov	[edx+0C0h], ecx

loc_1001EC38:				; CODE XREF: sub_1001EB70+B4j
		mov	edx, [ebp+lpTlsValue]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+lpTlsValue]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_1001ECA8
		mov	edx, [ebp+lpTlsValue]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_1001ECA8
		mov	ecx, [ebp+lpTlsValue]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+lpTlsValue]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	ecx, [ebp+lpTlsValue]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	edx, [ebp+arg_4]
		mov	eax, [edx]
		push	eax		; s
		call	closesocket
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F020
; ---------------------------------------------------------------------------

loc_1001ECA8:				; CODE XREF: sub_1001EB70+E4j
					; sub_1001EB70+F2j
		mov	ecx, [ebp+lpTlsValue]
		mov	dword ptr [ecx+0A4h], 1
		mov	edx, [ebp+lpTlsValue]
		mov	dword ptr [edx], 6
		mov	eax, [ebp+lpTlsValue]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [ebp+lpTlsValue]
		mov	edx, [ebp+sListenSocket]
		mov	[ecx+0A8h], edx
		mov	eax, [ebp+lpTlsValue]
		add	eax, 0B0h
		push	eax		; lpOverlapped
		lea	ecx, [ebp+dwBytesReceived]
		push	ecx		; lpdwBytesReceived
		push	30h		; dwRemoteAddressLength
		push	30h		; dwLocalAddressLength
		mov	edx, [ebp+dwReceiveDataLength]
		push	edx		; dwReceiveDataLength
		mov	eax, [ebp+lpOutputBuffer]
		push	eax		; lpOutputBuffer
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx]
		push	edx		; sAcceptSocket
		mov	eax, [ebp+sListenSocket]
		push	eax		; sListenSocket
		call	AcceptEx
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_1001EDC9
		call	ds:GetLastError
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 3E5h
		jz	loc_1001EDC9
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx]
		push	edx		; s
		call	closesocket
		mov	eax, [ebp+lpTlsValue]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+lpTlsValue]
		mov	dword ptr [ecx+0A4h], 0
		mov	edx, [ebp+lpTlsValue]
		mov	dword ptr [edx], 2
		mov	eax, [ebp+lpTlsValue]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_1001EDA8
		mov	edx, [ebp+lpTlsValue]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_1001EDA8
		mov	ecx, [ebp+lpTlsValue]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+lpTlsValue]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	ecx, [ebp+lpTlsValue]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F020
; ---------------------------------------------------------------------------

loc_1001EDA8:				; CODE XREF: sub_1001EB70+1EFj
					; sub_1001EB70+1FDj
		mov	edx, [ebp+lpTlsValue]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_20]
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F020
; ---------------------------------------------------------------------------

loc_1001EDC9:				; CODE XREF: sub_1001EB70+196j
					; sub_1001EB70+1ACj
		cmp	dword_10031524,	0
		jz	short loc_1001EDEE
		cmp	[ebp+var_18], 0
		jz	short loc_1001EDEE
		mov	ecx, [ebp+dwBytesReceived]
		push	ecx
		mov	edx, [ebp+var_18]
		push	edx
		mov	eax, [ebp+lpTlsValue]
		push	eax
		call	sub_1001E760
		add	esp, 0Ch
		jmp	short loc_1001EE16
; ---------------------------------------------------------------------------

loc_1001EDEE:				; CODE XREF: sub_1001EB70+260j
					; sub_1001EB70+266j
		mov	ecx, [ebp+arg_14]
		push	ecx
		mov	edx, [ebp+lpTlsValue]
		push	edx
		call	sub_1001E800
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001EE16
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax]
		push	ecx		; s
		call	closesocket
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F020
; ---------------------------------------------------------------------------

loc_1001EE16:				; CODE XREF: sub_1001EB70+27Cj
					; sub_1001EB70+291j ...
		mov	edx, [ebp+lpTlsValue]
		cmp	dword ptr [edx+0ACh], 0
		jz	loc_1001EFB0
		mov	[ebp+optlen], 4
		lea	eax, [ebp+optlen]
		push	eax		; optlen
		lea	ecx, [ebp+optval]
		push	ecx		; optval
		push	700Ch		; optname
		push	0FFFFh		; level
		mov	edx, [ebp+arg_4]
		mov	eax, [edx]
		push	eax		; s
		call	getsockopt
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	loc_1001EF1E
		mov	ecx, dword ptr [ebp+optval]
		push	ecx
		call	PR_SecondsToInterval
		add	esp, 4
		mov	[ebp+var_38], eax
		cmp	dword ptr [ebp+optval],	0FFFFFFFFh
		jnz	short loc_1001EE75
		mov	[ebp+var_10], 0
		jmp	short loc_1001EE7C
; ---------------------------------------------------------------------------

loc_1001EE75:				; CODE XREF: sub_1001EB70+2FAj
		mov	[ebp+var_10], 1

loc_1001EE7C:				; CODE XREF: sub_1001EB70+303j
		cmp	[ebp+var_10], 0
		jnz	short loc_1001EED5
		cmp	[ebp+var_C], 0
		jnz	short loc_1001EE98
		cmp	[ebp+arg_1C], 0
		jz	short loc_1001EE98
		mov	edx, [ebp+arg_20]
		push	edx
		call	[ebp+arg_1C]
		add	esp, 4

loc_1001EE98:				; CODE XREF: sub_1001EB70+316j
					; sub_1001EB70+31Cj
		mov	[ebp+var_C], 1
		mov	eax, [ebp+lpTlsValue]
		mov	dword ptr [eax], 6
		mov	ecx, [ebp+arg_14]
		push	ecx		; int
		mov	edx, [ebp+lpTlsValue]
		push	edx		; lpTlsValue
		call	sub_1001F030
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001EED0
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax]
		push	ecx		; s
		call	closesocket
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F020
; ---------------------------------------------------------------------------

loc_1001EED0:				; CODE XREF: sub_1001EB70+34Bj
		jmp	loc_1001EE16
; ---------------------------------------------------------------------------

loc_1001EED5:				; CODE XREF: sub_1001EB70+310j
		mov	edx, [ebp+var_38]
		cmp	edx, [ebp+arg_14]
		jnb	short loc_1001EF1C
		mov	eax, [ebp+arg_14]
		sub	eax, [ebp+var_38]
		mov	[ebp+arg_14], eax
		mov	ecx, [ebp+lpTlsValue]
		mov	dword ptr [ecx], 6
		mov	edx, [ebp+arg_14]
		push	edx		; int
		mov	eax, [ebp+lpTlsValue]
		push	eax		; lpTlsValue
		call	sub_1001F030
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001EF17
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx]
		push	edx		; s
		call	closesocket
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F020
; ---------------------------------------------------------------------------

loc_1001EF17:				; CODE XREF: sub_1001EB70+392j
		jmp	loc_1001EE16
; ---------------------------------------------------------------------------

loc_1001EF1C:				; CODE XREF: sub_1001EB70+36Bj
		jmp	short loc_1001EF25
; ---------------------------------------------------------------------------

loc_1001EF1E:				; CODE XREF: sub_1001EB70+2E1j
		mov	[ebp+var_10], 0

loc_1001EF25:				; CODE XREF: sub_1001EB70:loc_1001EF1Cj
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax]
		push	ecx		; s
		call	sub_1001F110
		add	esp, 4
		mov	[ebp+var_18], eax
		mov	edx, [ebp+lpTlsValue]
		mov	dword ptr [edx+0ACh], 0
		mov	eax, [ebp+lpTlsValue]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_1001EF88
		mov	edx, [ebp+lpTlsValue]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_1001EF88
		mov	ecx, [ebp+lpTlsValue]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+lpTlsValue]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_1001EF97
; ---------------------------------------------------------------------------

loc_1001EF88:				; CODE XREF: sub_1001EB70+3E2j
					; sub_1001EB70+3F0j
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8

loc_1001EF97:				; CODE XREF: sub_1001EB70+416j
		mov	ecx, [ebp+lpTlsValue]
		mov	dword ptr [ecx], 2
		mov	edx, [ebp+arg_4]
		mov	eax, [edx]
		push	eax		; s
		call	closesocket
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001F020
; ---------------------------------------------------------------------------

loc_1001EFB0:				; CODE XREF: sub_1001EB70+2B0j
		mov	ecx, [ebp+lpTlsValue]
		cmp	dword ptr [ecx+0ECh], 0
		jnz	short loc_1001EFDE
		mov	edx, [ebp+lpTlsValue]
		mov	eax, [edx+0F4h]
		push	eax
		call	sub_100253E0
		add	esp, 4
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx]
		push	edx		; s
		call	closesocket
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001F020
; ---------------------------------------------------------------------------

loc_1001EFDE:				; CODE XREF: sub_1001EB70+44Aj
		cmp	[ebp+arg_18], 0
		jnz	short loc_1001EFF6
		mov	eax, [ebp+sListenSocket]
		push	eax		; optval
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx]
		push	edx		; s
		call	sub_1001E2E0
		add	esp, 8

loc_1001EFF6:				; CODE XREF: sub_1001EB70+472j
		lea	eax, [ebp+RemoteSockaddrLength]
		push	eax		; RemoteSockaddrLength
		mov	ecx, [ebp+RemoteSockaddr]
		push	ecx		; RemoteSockaddr
		lea	edx, [ebp+LocalSockaddrLength]
		push	edx		; LocalSockaddrLength
		lea	eax, [ebp+LocalSockaddr]
		push	eax		; LocalSockaddr
		push	30h		; dwRemoteAddressLength
		push	30h		; dwLocalAddressLength
		mov	ecx, [ebp+dwReceiveDataLength]
		push	ecx		; dwReceiveDataLength
		mov	edx, [ebp+lpOutputBuffer]
		push	edx		; lpOutputBuffer
		call	GetAcceptExSockaddrs
		mov	eax, [ebp+lpTlsValue]
		mov	eax, [eax+0F0h]

loc_1001F020:				; CODE XREF: sub_1001EB70+3Fj
					; sub_1001EB70+8Fj ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001EB70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001F030(LPVOID lpTlsValue, int)
sub_1001F030	proc near		; CODE XREF: sub_1001EB70+340p
					; sub_1001EB70+387p

var_4		= dword	ptr -4
lpTlsValue	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	[ebp+var_4], 1
		mov	eax, [ebp+lpTlsValue]
		mov	ecx, [eax+90h]
		and	ecx, 80h
		jnz	short loc_1001F082
		cmp	dword_1003067C,	0
		jz	short loc_1001F06F
		mov	edx, TlsIndex
		mov	eax, large fs:2Ch
		mov	ecx, [eax+edx*4]
		mov	edx, [ebp+lpTlsValue]
		mov	[ecx+4], edx
		jmp	short loc_1001F080
; ---------------------------------------------------------------------------

loc_1001F06F:				; CODE XREF: sub_1001F030+23j
		mov	eax, [ebp+lpTlsValue]
		push	eax		; lpTlsValue
		mov	ecx, dword_10032A18
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue

loc_1001F080:				; CODE XREF: sub_1001F030+3Dj
		jmp	short loc_1001F0BC
; ---------------------------------------------------------------------------

loc_1001F082:				; CODE XREF: sub_1001F030+1Aj
		mov	edx, [ebp+lpTlsValue]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+lpTlsValue]
		cmp	dword ptr [eax+0A4h], 0
		jnz	short loc_1001F0A2
		mov	[ebp+var_4], 0

loc_1001F0A2:				; CODE XREF: sub_1001F030+69j
		mov	ecx, [ebp+lpTlsValue]
		mov	dword ptr [ecx+0ACh], 0
		mov	edx, [ebp+lpTlsValue]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1001F0BC:				; CODE XREF: sub_1001F030:loc_1001F080j
		mov	eax, [ebp+lpTlsValue]
		mov	ecx, [ebp+arg_4]
		mov	[eax+80h], ecx
		cmp	[ebp+var_4], 0
		jz	short loc_1001F104
		mov	edx, [ebp+lpTlsValue]
		mov	eax, [edx+90h]
		and	eax, 80h
		jnz	short loc_1001F0F2
		mov	ecx, [ebp+arg_4]
		push	ecx
		mov	edx, [ebp+lpTlsValue]
		push	edx
		call	sub_1001DB80
		add	esp, 8
		jmp	short loc_1001F106
; ---------------------------------------------------------------------------
		jmp	short loc_1001F104
; ---------------------------------------------------------------------------

loc_1001F0F2:				; CODE XREF: sub_1001F030+ACj
		mov	eax, [ebp+arg_4]
		push	eax
		mov	ecx, [ebp+lpTlsValue]
		push	ecx
		call	sub_1001E800
		add	esp, 8
		jmp	short loc_1001F106
; ---------------------------------------------------------------------------

loc_1001F104:				; CODE XREF: sub_1001F030+9Cj
					; sub_1001F030+C0j
		xor	eax, eax

loc_1001F106:				; CODE XREF: sub_1001F030+BEj
					; sub_1001F030+D2j
		mov	esp, ebp
		pop	ebp
		retn
sub_1001F030	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001F110(SOCKET s)
sub_1001F110	proc near		; CODE XREF: sub_1001EB70+3BBp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
s		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+0A4h]
		mov	[ebp+var_4], edx
		cmp	[ebp+var_4], 0
		jz	short loc_1001F160
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax], 6
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx+0ACh], 0
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx+12Ch], 1

loc_1001F160:				; CODE XREF: sub_1001F110+2Bj
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		cmp	[ebp+s], 0FFFFFFFFh
		jz	short loc_1001F17F
		mov	ecx, [ebp+s]
		push	ecx		; s
		call	closesocket
		mov	[ebp+var_8], eax

loc_1001F17F:				; CODE XREF: sub_1001F110+61j
		cmp	[ebp+var_4], 0
		jz	loc_1001F246
		mov	[ebp+var_10], 0
		jmp	short loc_1001F19B
; ---------------------------------------------------------------------------

loc_1001F192:				; CODE XREF: sub_1001F110:loc_1001F20Ej
		mov	edx, [ebp+var_10]
		add	edx, 1
		mov	[ebp+var_10], edx

loc_1001F19B:				; CODE XREF: sub_1001F110+80j
		cmp	[ebp+var_4], 0
		jz	short loc_1001F210
		push	5
		call	PR_SecondsToInterval
		add	esp, 4
		push	eax
		mov	eax, [ebp+var_C]
		push	eax
		call	sub_1001E800
		add	esp, 8
		mov	ecx, [ebp+var_C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_C]
		mov	eax, [edx+0A4h]
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jz	short loc_1001F1ED
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx], 6
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx+0ACh], 0

loc_1001F1ED:				; CODE XREF: sub_1001F110+C5j
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [ebp+var_10]
		cmp	ecx, dword_1003260C
		jle	short loc_1001F20E
		mov	edx, [ebp+var_10]
		mov	dword_1003260C,	edx

loc_1001F20E:				; CODE XREF: sub_1001F110+F3j
		jmp	short loc_1001F192
; ---------------------------------------------------------------------------

loc_1001F210:				; CODE XREF: sub_1001F110+8Fj
		cmp	[ebp+var_10], 1
		jle	short loc_1001F223
		mov	eax, dword_10032608
		add	eax, 1
		mov	dword_10032608,	eax

loc_1001F223:				; CODE XREF: sub_1001F110+104j
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx+12Ch], 0
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx+0A4h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax], 2

loc_1001F246:				; CODE XREF: sub_1001F110+73j
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx+128h], 0
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx+0ACh], 0
		mov	eax, [ebp+var_8]
		mov	esp, ebp
		pop	ebp
		retn
sub_1001F110	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001F270	proc near		; CODE XREF: sub_100156F0+84p

var_10		= dword	ptr -10h
dwReserved	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 0
		jz	short loc_1001F2A1
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F618
; ---------------------------------------------------------------------------

loc_1001F2A1:				; CODE XREF: sub_1001F270+18j
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+2Ch], 0
		jnz	short loc_1001F2CF
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; FileHandle
		call	sub_1001E100
		add	esp, 4
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	dword ptr [ecx+2Ch], 1

loc_1001F2CF:				; CODE XREF: sub_1001F270+3Bj
		mov	edx, [ebp+var_10]
		cmp	dword ptr [edx+0E4h], 0
		jnz	short loc_1001F311
		push	10h		; Size
		call	PR_Malloc
		add	esp, 4
		mov	ecx, [ebp+var_10]
		mov	[ecx+0E4h], eax
		mov	edx, [ebp+var_10]
		cmp	dword ptr [edx+0E4h], 0
		jnz	short loc_1001F311
		push	0
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F618
; ---------------------------------------------------------------------------

loc_1001F311:				; CODE XREF: sub_1001F270+69j
					; sub_1001F270+88j
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+0E4h]
		mov	edx, [ebp+arg_4]
		mov	eax, [edx+0Ch]
		mov	[ecx], eax
		mov	ecx, [ebp+var_10]
		mov	edx, [ecx+0E4h]
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+10h]
		mov	[edx+4], ecx
		mov	edx, [ebp+var_10]
		mov	eax, [edx+0E4h]
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx+14h]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+0E4h]
		mov	edx, [ebp+arg_4]
		mov	eax, [edx+18h]
		mov	[ecx+0Ch], eax
		xor	ecx, ecx
		mov	edx, [ebp+var_10]
		add	edx, 0B0h
		mov	[edx], ecx
		mov	[edx+4], ecx
		mov	[edx+8], ecx
		mov	[edx+0Ch], ecx
		mov	[edx+10h], ecx
		mov	eax, [ebp+var_10]
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx+4]
		mov	[eax+0B8h], edx
		cmp	dword_10031524,	0
		jz	short loc_1001F39B
		mov	eax, [ebp+var_10]
		mov	ecx, [ebp+var_10]
		mov	edx, [ecx+130h]
		mov	[eax+0C0h], edx

loc_1001F39B:				; CODE XREF: sub_1001F270+117j
		mov	[ebp+dwReserved], 0
		mov	eax, [ebp+arg_8]
		and	eax, 1
		jz	short loc_1001F3B1
		mov	[ebp+dwReserved], 3

loc_1001F3B1:				; CODE XREF: sub_1001F270+138j
		mov	ecx, [ebp+var_10]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_10]
		mov	eax, [edx+90h]
		and	eax, 1000h
		jnz	short loc_1001F415
		mov	ecx, [ebp+var_10]
		mov	edx, [ecx+90h]
		and	edx, 2
		jz	short loc_1001F415
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+90h]
		and	ecx, 0FFFFFFFDh
		mov	edx, [ebp+var_10]
		mov	[edx+90h], ecx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	eax, [ebp+var_10]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F618
; ---------------------------------------------------------------------------

loc_1001F415:				; CODE XREF: sub_1001F270+15Cj
					; sub_1001F270+16Aj
		mov	ecx, [ebp+var_10]
		mov	dword ptr [ecx+0A4h], 1
		mov	edx, [ebp+var_10]
		mov	dword ptr [edx], 6
		mov	eax, [ebp+var_10]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	eax, [ebp+var_10]
		mov	ecx, [edx+28h]
		mov	[eax+0A8h], ecx
		mov	edx, [ebp+dwReserved]
		push	edx		; dwReserved
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+0E4h]
		push	ecx		; lpTransmitBuffers
		mov	edx, [ebp+var_10]
		add	edx, 0B0h
		push	edx		; lpOverlapped
		push	0		; nNumberOfBytesPerSend
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+8]
		push	ecx		; nNumberOfBytesToWrite
		mov	edx, [ebp+arg_4]
		mov	eax, [edx]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; hFile
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; hSocket
		call	TransmitFile
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	loc_1001F545
		call	ds:GetLastError
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 3E5h
		jz	loc_1001F545
		mov	eax, [ebp+var_10]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_10]
		mov	dword ptr [ecx+0A4h], 0
		mov	edx, [ebp+var_10]
		mov	dword ptr [edx], 2
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_1001F524
		mov	edx, [ebp+var_10]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_1001F524
		mov	ecx, [ebp+var_10]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+var_10]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	ecx, [ebp+var_10]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F618
; ---------------------------------------------------------------------------

loc_1001F524:				; CODE XREF: sub_1001F270+26Bj
					; sub_1001F270+279j
		mov	edx, [ebp+var_10]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_8]
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F618
; ---------------------------------------------------------------------------

loc_1001F545:				; CODE XREF: sub_1001F270+21Dj
					; sub_1001F270+233j
		mov	ecx, [ebp+arg_C]
		push	ecx
		mov	edx, [ebp+var_10]
		push	edx
		call	sub_1001E800
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001F562
		or	eax, 0FFFFFFFFh
		jmp	loc_1001F618
; ---------------------------------------------------------------------------

loc_1001F562:				; CODE XREF: sub_1001F270+2E8j
		mov	eax, [ebp+var_10]
		cmp	dword ptr [eax+0ACh], 0
		jz	short loc_1001F5C7
		mov	ecx, [ebp+var_10]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_1001F5B3
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_1001F5B3
		mov	edx, [ebp+var_10]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_10]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_1001F5C2
; ---------------------------------------------------------------------------

loc_1001F5B3:				; CODE XREF: sub_1001F270+30Dj
					; sub_1001F270+31Bj
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8

loc_1001F5C2:				; CODE XREF: sub_1001F270+341j
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001F618
; ---------------------------------------------------------------------------

loc_1001F5C7:				; CODE XREF: sub_1001F270+2FCj
		mov	edx, [ebp+var_10]
		cmp	dword ptr [edx+0ECh], 0
		jnz	short loc_1001F5EA
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+0F4h]
		push	ecx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001F618
; ---------------------------------------------------------------------------

loc_1001F5EA:				; CODE XREF: sub_1001F270+361j
		mov	edx, [ebp+arg_8]
		and	edx, 1
		jz	short loc_1001F60F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, word ptr [ecx+58h]
		push	edx		; int
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; s
		call	sub_1001F620
		add	esp, 8

loc_1001F60F:				; CODE XREF: sub_1001F270+380j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0F0h]

loc_1001F618:				; CODE XREF: sub_1001F270+2Cj
					; sub_1001F270+9Cj ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001F270	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001F620(SOCKET s, int)
sub_1001F620	proc near		; CODE XREF: sub_1001F270+397p

s		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	offset stru_100315E4 ; lpCriticalSection
		call	ds:EnterCriticalSection
		cmp	[ebp+arg_4], 2
		jnz	short loc_1001F66B
		cmp	dword_10032600,	200h
		jge	short loc_1001F66B
		mov	eax, dword_10032600
		mov	ecx, [ebp+s]
		mov	dword_10031600[eax*4], ecx
		mov	edx, dword_10032600
		add	edx, 1
		mov	dword_10032600,	edx
		push	offset stru_100315E4 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001F6BC
; ---------------------------------------------------------------------------

loc_1001F66B:				; CODE XREF: sub_1001F620+12j
					; sub_1001F620+1Ej
		cmp	[ebp+arg_4], 17h
		jnz	short loc_1001F6A8
		cmp	dword_10032604,	200h
		jge	short loc_1001F6A8
		mov	eax, dword_10032604
		mov	ecx, [ebp+s]
		mov	dword_10031E00[eax*4], ecx
		mov	edx, dword_10032604
		add	edx, 1
		mov	dword_10032604,	edx
		push	offset stru_100315E4 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_1001F6BC
; ---------------------------------------------------------------------------

loc_1001F6A8:				; CODE XREF: sub_1001F620+4Fj
					; sub_1001F620+5Bj
		push	offset stru_100315E4 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+s]
		push	eax		; s
		call	closesocket

loc_1001F6BC:				; CODE XREF: sub_1001F620+49j
					; sub_1001F620+86j
		pop	ebp
		retn
sub_1001F620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001F6C0(int,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, int, int)
sub_1001F6C0	proc near		; CODE XREF: sub_10015080+176p
					; sub_10015260+D4p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
hFile		= dword	ptr -8
NumberOfBytesRead= dword ptr -4
arg_0		= dword	ptr  8
lpBuffer	= dword	ptr  0Ch
nNumberOfBytesToRead= dword ptr	 10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+hFile], edx
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_1001F6F2
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+8], 1
		jnz	short loc_1001F73B

loc_1001F6F2:				; CODE XREF: sub_1001F6C0+24j
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+2Ch], 0
		jnz	short loc_1001F71A
		mov	eax, [ebp+hFile]
		push	eax		; s
		call	sub_1001E270
		add	esp, 4
		mov	[ebp+var_C], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	dword ptr [edx+2Ch], 1

loc_1001F71A:				; CODE XREF: sub_1001F6C0+3Cj
		mov	eax, [ebp+arg_10]
		push	eax		; int
		mov	ecx, [ebp+arg_C]
		push	ecx		; int
		mov	edx, [ebp+nNumberOfBytesToRead]
		push	edx		; len
		mov	eax, [ebp+lpBuffer]
		push	eax		; buf
		mov	ecx, [ebp+arg_0]
		push	ecx		; int
		call	sub_10022E30
		add	esp, 14h
		jmp	loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001F73B:				; CODE XREF: sub_1001F6C0+30j
		mov	edx, [ebp+var_14]
		cmp	dword ptr [edx+0ACh], 0
		jz	short loc_1001F75E
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001F75E:				; CODE XREF: sub_1001F6C0+85j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+2Ch], 0
		jnz	short loc_1001F786
		mov	edx, [ebp+hFile]
		push	edx		; FileHandle
		call	sub_1001E100
		add	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	dword ptr [ecx+2Ch], 1

loc_1001F786:				; CODE XREF: sub_1001F6C0+A8j
		xor	edx, edx
		mov	eax, [ebp+var_14]
		add	eax, 0B0h
		mov	[eax], edx
		mov	[eax+4], edx
		mov	[eax+8], edx
		mov	[eax+0Ch], edx
		mov	[eax+10h], edx
		cmp	dword_10031524,	0
		jz	short loc_1001F7B9
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_14]
		mov	eax, [edx+130h]
		mov	[ecx+0C0h], eax

loc_1001F7B9:				; CODE XREF: sub_1001F6C0+E5j
		mov	ecx, [ebp+var_14]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_14]
		mov	eax, [edx+90h]
		and	eax, 1000h
		jnz	short loc_1001F81D
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+90h]
		and	edx, 2
		jz	short loc_1001F81D
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+90h]
		and	ecx, 0FFFFFFFDh
		mov	edx, [ebp+var_14]
		mov	[edx+90h], ecx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	eax, [ebp+var_14]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001F81D:				; CODE XREF: sub_1001F6C0+114j
					; sub_1001F6C0+122j
		mov	ecx, [ebp+var_14]
		mov	dword ptr [ecx+0A4h], 1
		mov	edx, [ebp+var_14]
		mov	dword ptr [edx], 6
		mov	eax, [ebp+var_14]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+hFile]
		mov	[ecx+0A8h], edx
		mov	eax, [ebp+var_14]
		add	eax, 0B0h
		push	eax		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		mov	edx, [ebp+nNumberOfBytesToRead]
		push	edx		; nNumberOfBytesToRead
		mov	eax, [ebp+lpBuffer]
		push	eax		; lpBuffer
		mov	ecx, [ebp+hFile]
		push	ecx		; hFile
		call	ds:ReadFile
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_1001F93A
		call	ds:GetLastError
		cmp	eax, 3E5h
		jz	loc_1001F93A
		mov	edx, [ebp+var_14]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0A4h], 0
		mov	ecx, [ebp+var_14]
		mov	dword ptr [ecx], 2
		mov	edx, [ebp+var_14]
		mov	eax, [edx+90h]
		and	eax, 1000h
		jnz	short loc_1001F903
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+90h]
		and	edx, 2
		jz	short loc_1001F903
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+90h]
		and	ecx, 0FFFFFFFDh
		mov	edx, [ebp+var_14]
		mov	[edx+90h], ecx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	eax, [ebp+var_14]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001F903:				; CODE XREF: sub_1001F6C0+1FAj
					; sub_1001F6C0+208j
		mov	ecx, [ebp+var_14]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		call	ds:GetLastError
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 26h
		jnz	short loc_1001F926
		xor	eax, eax
		jmp	loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001F926:				; CODE XREF: sub_1001F6C0+25Dj
		mov	edx, [ebp+var_10]
		push	edx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001F93A:				; CODE XREF: sub_1001F6C0+1B2j
					; sub_1001F6C0+1C3j
		cmp	dword_10031524,	0
		jz	short loc_1001F95F
		cmp	[ebp+var_C], 0
		jz	short loc_1001F95F
		mov	eax, [ebp+NumberOfBytesRead]
		push	eax
		mov	ecx, [ebp+var_C]
		push	ecx
		mov	edx, [ebp+var_14]
		push	edx
		call	sub_1001E760
		add	esp, 0Ch
		jmp	short loc_1001F97C
; ---------------------------------------------------------------------------

loc_1001F95F:				; CODE XREF: sub_1001F6C0+281j
					; sub_1001F6C0+287j
		mov	eax, [ebp+arg_10]
		push	eax
		mov	ecx, [ebp+var_14]
		push	ecx
		call	sub_1001E800
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001F97C
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001F97C:				; CODE XREF: sub_1001F6C0+29Dj
					; sub_1001F6C0+2B2j
		mov	edx, [ebp+var_14]
		cmp	dword ptr [edx+0ACh], 0
		jz	short loc_1001F9E1
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_1001F9CD
		mov	edx, [ebp+var_14]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_1001F9CD
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+var_14]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_1001F9DC
; ---------------------------------------------------------------------------

loc_1001F9CD:				; CODE XREF: sub_1001F6C0+2D7j
					; sub_1001F6C0+2E5j
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8

loc_1001F9DC:				; CODE XREF: sub_1001F6C0+30Bj
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001F9E1:				; CODE XREF: sub_1001F6C0+2C6j
		mov	ecx, [ebp+var_14]
		cmp	dword ptr [ecx+0ECh], 0
		jnz	short loc_1001FA14
		mov	edx, [ebp+var_14]
		cmp	dword ptr [edx+0F4h], 26h
		jnz	short loc_1001F9FD
		xor	eax, eax
		jmp	short loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001F9FD:				; CODE XREF: sub_1001F6C0+337j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+0F4h]
		push	ecx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001FA1D
; ---------------------------------------------------------------------------

loc_1001FA14:				; CODE XREF: sub_1001F6C0+32Bj
		mov	edx, [ebp+var_14]
		mov	eax, [edx+0F0h]

loc_1001FA1D:				; CODE XREF: sub_1001F6C0+76j
					; sub_1001F6C0+99j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001F6C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001FA30(int,	LPCVOID	lpBuffer, DWORD	nNumberOfBytesToWrite, int, int)
sub_1001FA30	proc near		; CODE XREF: sub_10015370+9Ep
					; sub_1001FEB0+ACp

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
hFile		= dword	ptr -8
NumberOfBytesWritten= dword ptr	-4
arg_0		= dword	ptr  8
lpBuffer	= dword	ptr  0Ch
nNumberOfBytesToWrite= dword ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+hFile], edx
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_1001FA62
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+8], 1
		jnz	short loc_1001FAA7

loc_1001FA62:				; CODE XREF: sub_1001FA30+24j
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+2Ch], 0
		jnz	short loc_1001FA8A
		mov	eax, [ebp+hFile]
		push	eax		; s
		call	sub_1001E270
		add	esp, 4
		mov	[ebp+var_C], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	dword ptr [edx+2Ch], 1

loc_1001FA8A:				; CODE XREF: sub_1001FA30+3Cj
		mov	eax, [ebp+arg_10]
		push	eax		; int
		mov	ecx, [ebp+nNumberOfBytesToWrite]
		push	ecx		; len
		mov	edx, [ebp+lpBuffer]
		push	edx		; buf
		mov	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_10022FD0
		add	esp, 10h
		jmp	loc_1001FD6B
; ---------------------------------------------------------------------------

loc_1001FAA7:				; CODE XREF: sub_1001FA30+30j
		mov	ecx, [ebp+var_14]
		cmp	dword ptr [ecx+0ACh], 0
		jz	short loc_1001FACA
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FD6B
; ---------------------------------------------------------------------------

loc_1001FACA:				; CODE XREF: sub_1001FA30+81j
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+2Ch], 0
		jnz	short loc_1001FAF2
		mov	ecx, [ebp+hFile]
		push	ecx		; FileHandle
		call	sub_1001E100
		add	esp, 4
		mov	[ebp+var_C], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		mov	dword ptr [eax+2Ch], 1

loc_1001FAF2:				; CODE XREF: sub_1001FA30+A4j
		xor	ecx, ecx
		mov	edx, [ebp+var_14]
		add	edx, 0B0h
		mov	[edx], ecx
		mov	[edx+4], ecx
		mov	[edx+8], ecx
		mov	[edx+0Ch], ecx
		mov	[edx+10h], ecx
		cmp	dword_10031524,	0
		jz	short loc_1001FB26
		mov	eax, [ebp+var_14]
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+130h]
		mov	[eax+0C0h], edx

loc_1001FB26:				; CODE XREF: sub_1001FA30+E2j
		mov	eax, [ebp+var_14]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_1001FB8B
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_1001FB8B
		mov	edx, [ebp+var_14]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_14]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	edx, [ebp+var_14]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FD6B
; ---------------------------------------------------------------------------

loc_1001FB8B:				; CODE XREF: sub_1001FA30+112j
					; sub_1001FA30+120j
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0A4h], 1
		mov	ecx, [ebp+var_14]
		mov	dword ptr [ecx], 6
		mov	edx, [ebp+var_14]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_14]
		mov	ecx, [ebp+hFile]
		mov	[eax+0A8h], ecx
		mov	edx, [ebp+var_14]
		add	edx, 0B0h
		push	edx		; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		mov	ecx, [ebp+nNumberOfBytesToWrite]
		push	ecx		; nNumberOfBytesToWrite
		mov	edx, [ebp+lpBuffer]
		push	edx		; lpBuffer
		mov	eax, [ebp+hFile]
		push	eax		; hFile
		call	ds:WriteFile
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_1001FC99
		call	ds:GetLastError
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 3E5h
		jz	loc_1001FC99
		mov	ecx, [ebp+var_14]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_14]
		mov	dword ptr [edx+0A4h], 0
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax], 2
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_1001FC78
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_1001FC78
		mov	edx, [ebp+var_14]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_14]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	edx, [ebp+var_14]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FD6B
; ---------------------------------------------------------------------------

loc_1001FC78:				; CODE XREF: sub_1001FA30+1FFj
					; sub_1001FA30+20Dj
		mov	eax, [ebp+var_14]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [ebp+var_10]
		push	ecx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FD6B
; ---------------------------------------------------------------------------

loc_1001FC99:				; CODE XREF: sub_1001FA30+1B1j
					; sub_1001FA30+1C7j
		cmp	dword_10031524,	0
		jz	short loc_1001FCBE
		cmp	[ebp+var_C], 0
		jz	short loc_1001FCBE
		mov	edx, [ebp+NumberOfBytesWritten]
		push	edx
		mov	eax, [ebp+var_C]
		push	eax
		mov	ecx, [ebp+var_14]
		push	ecx
		call	sub_1001E760
		add	esp, 0Ch
		jmp	short loc_1001FCDB
; ---------------------------------------------------------------------------

loc_1001FCBE:				; CODE XREF: sub_1001FA30+270j
					; sub_1001FA30+276j
		mov	edx, [ebp+arg_10]
		push	edx
		mov	eax, [ebp+var_14]
		push	eax
		call	sub_1001E800
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001FCDB
		or	eax, 0FFFFFFFFh
		jmp	loc_1001FD6B
; ---------------------------------------------------------------------------

loc_1001FCDB:				; CODE XREF: sub_1001FA30+28Cj
					; sub_1001FA30+2A1j
		mov	ecx, [ebp+var_14]
		cmp	dword ptr [ecx+0ACh], 0
		jz	short loc_1001FD3F
		mov	edx, [ebp+var_14]
		mov	eax, [edx+90h]
		and	eax, 1000h
		jnz	short loc_1001FD2B
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+90h]
		and	edx, 2
		jz	short loc_1001FD2B
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+90h]
		and	ecx, 0FFFFFFFDh
		mov	edx, [ebp+var_14]
		mov	[edx+90h], ecx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_1001FD3A
; ---------------------------------------------------------------------------

loc_1001FD2B:				; CODE XREF: sub_1001FA30+2C5j
					; sub_1001FA30+2D3j
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8

loc_1001FD3A:				; CODE XREF: sub_1001FA30+2F9j
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001FD6B
; ---------------------------------------------------------------------------

loc_1001FD3F:				; CODE XREF: sub_1001FA30+2B5j
		mov	eax, [ebp+var_14]
		cmp	dword ptr [eax+0ECh], 0
		jnz	short loc_1001FD62
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+0F4h]
		push	edx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001FD6B
; ---------------------------------------------------------------------------

loc_1001FD62:				; CODE XREF: sub_1001FA30+319j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0F0h]

loc_1001FD6B:				; CODE XREF: sub_1001FA30+72j
					; sub_1001FA30+95j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001FA30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001FD70	proc near		; CODE XREF: sub_10015560+92p

var_8		= dword	ptr -8
s		= dword	ptr -4
arg_0		= dword	ptr  8
buf		= dword	ptr  0Ch
len		= dword	ptr  10h
flags		= dword	ptr  14h
to		= dword	ptr  18h
tolen		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+2Ch], 0
		jnz	short loc_1001FDAA
		mov	edx, [ebp+s]
		push	edx		; s
		call	sub_1001E270
		add	esp, 4
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	dword ptr [ecx+2Ch], 1

loc_1001FDAA:				; CODE XREF: sub_1001FD70+1Cj
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+4], 0
		jnz	short loc_1001FDC2
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+8], 1
		jnz	short loc_1001FDE6

loc_1001FDC2:				; CODE XREF: sub_1001FD70+44j
		mov	eax, [ebp+arg_18]
		push	eax		; int
		mov	ecx, [ebp+tolen]
		push	ecx		; tolen
		mov	edx, [ebp+to]
		push	edx		; to
		mov	eax, [ebp+len]
		push	eax		; len
		mov	ecx, [ebp+buf]
		push	ecx		; buf
		mov	edx, [ebp+arg_0]
		push	edx		; int
		call	sub_10023340
		add	esp, 18h
		jmp	short loc_1001FE0A
; ---------------------------------------------------------------------------
		jmp	short loc_1001FE0A
; ---------------------------------------------------------------------------

loc_1001FDE6:				; CODE XREF: sub_1001FD70+50j
		mov	eax, [ebp+arg_18]
		push	eax		; int
		mov	ecx, [ebp+tolen]
		push	ecx		; int
		mov	edx, [ebp+to]
		push	edx		; to
		mov	eax, [ebp+flags]
		push	eax		; flags
		mov	ecx, [ebp+len]
		push	ecx		; len
		mov	edx, [ebp+buf]
		push	edx		; buf
		mov	eax, [ebp+s]
		push	eax		; s
		call	sub_10023DE0
		add	esp, 1Ch

loc_1001FE0A:				; CODE XREF: sub_1001FD70+72j
					; sub_1001FD70+74j
		mov	esp, ebp
		pop	ebp
		retn
sub_1001FD70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001FE10	proc near		; CODE XREF: sub_10015630+7Ep

var_8		= dword	ptr -8
s		= dword	ptr -4
arg_0		= dword	ptr  8
buf		= dword	ptr  0Ch
len		= dword	ptr  10h
flags		= dword	ptr  14h
from		= dword	ptr  18h
fromlen		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+2Ch], 0
		jnz	short loc_1001FE4A
		mov	edx, [ebp+s]
		push	edx		; s
		call	sub_1001E270
		add	esp, 4
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	dword ptr [ecx+2Ch], 1

loc_1001FE4A:				; CODE XREF: sub_1001FE10+1Cj
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+4], 0
		jnz	short loc_1001FE62
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+8], 1
		jnz	short loc_1001FE86

loc_1001FE62:				; CODE XREF: sub_1001FE10+44j
		mov	eax, [ebp+arg_18]
		push	eax		; int
		mov	ecx, [ebp+fromlen]
		push	ecx		; fromlen
		mov	edx, [ebp+from]
		push	edx		; from
		mov	eax, [ebp+len]
		push	eax		; len
		mov	ecx, [ebp+buf]
		push	ecx		; buf
		mov	edx, [ebp+arg_0]
		push	edx		; int
		call	sub_100235F0
		add	esp, 18h
		jmp	short loc_1001FEAA
; ---------------------------------------------------------------------------
		jmp	short loc_1001FEAA
; ---------------------------------------------------------------------------

loc_1001FE86:				; CODE XREF: sub_1001FE10+50j
		mov	eax, [ebp+arg_18]
		push	eax		; int
		mov	ecx, [ebp+fromlen]
		push	ecx		; fromlen
		mov	edx, [ebp+from]
		push	edx		; from
		mov	eax, [ebp+flags]
		push	eax		; flags
		mov	ecx, [ebp+len]
		push	ecx		; len
		mov	edx, [ebp+buf]
		push	edx		; buf
		mov	eax, [ebp+s]
		push	eax		; s
		call	sub_100241C0
		add	esp, 1Ch

loc_1001FEAA:				; CODE XREF: sub_1001FE10+72j
					; sub_1001FE10+74j
		mov	esp, ebp
		pop	ebp
		retn
sub_1001FE10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001FEB0	proc near		; CODE XREF: sub_10014C50+101p

var_10		= dword	ptr -10h
s		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx
		mov	[ebp+var_4], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_1001FEE1
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+8], 1
		jnz	short loc_1001FF23

loc_1001FEE1:				; CODE XREF: sub_1001FEB0+23j
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+2Ch], 0
		jnz	short loc_1001FF09
		mov	eax, [ebp+s]
		push	eax		; s
		call	sub_1001E270
		add	esp, 4
		mov	[ebp+var_10], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	dword ptr [edx+2Ch], 1

loc_1001FF09:				; CODE XREF: sub_1001FEB0+3Bj
		mov	eax, [ebp+arg_C]
		push	eax
		mov	ecx, [ebp+arg_8]
		push	ecx
		mov	edx, [ebp+arg_4]
		push	edx
		mov	eax, [ebp+arg_0]
		push	eax
		call	sub_10023280
		add	esp, 10h
		jmp	short loc_1001FF9A
; ---------------------------------------------------------------------------

loc_1001FF23:				; CODE XREF: sub_1001FEB0+2Fj
		mov	[ebp+var_8], 0
		jmp	short loc_1001FF35
; ---------------------------------------------------------------------------

loc_1001FF2C:				; CODE XREF: sub_1001FEB0:loc_1001FF95j
		mov	ecx, [ebp+var_8]
		add	ecx, 1
		mov	[ebp+var_8], ecx

loc_1001FF35:				; CODE XREF: sub_1001FEB0+7Aj
		mov	edx, [ebp+var_8]
		cmp	edx, [ebp+arg_8]
		jge	short loc_1001FF97
		mov	eax, [ebp+arg_C]
		push	eax		; int
		push	0		; int
		mov	ecx, [ebp+var_8]
		mov	edx, [ebp+arg_4]
		mov	eax, [edx+ecx*8+4]
		push	eax		; nNumberOfBytesToWrite
		mov	ecx, [ebp+var_8]
		mov	edx, [ebp+arg_4]
		mov	eax, [edx+ecx*8]
		push	eax		; lpBuffer
		mov	ecx, [ebp+arg_0]
		push	ecx		; int
		call	sub_1001FA30
		add	esp, 14h
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jle	short loc_1001FF76
		mov	edx, [ebp+var_4]
		add	edx, [ebp+var_10]
		mov	[ebp+var_4], edx

loc_1001FF76:				; CODE XREF: sub_1001FEB0+BBj
		mov	eax, [ebp+var_8]
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		cmp	edx, [ecx+eax*8+4]
		jz	short loc_1001FF95
		cmp	[ebp+var_4], 0
		jg	short loc_1001FF90
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001FF9A
; ---------------------------------------------------------------------------

loc_1001FF90:				; CODE XREF: sub_1001FEB0+D9j
		or	eax, 0FFFFFFFFh
		jmp	short loc_1001FF9A
; ---------------------------------------------------------------------------

loc_1001FF95:				; CODE XREF: sub_1001FEB0+D3j
		jmp	short loc_1001FF2C
; ---------------------------------------------------------------------------

loc_1001FF97:				; CODE XREF: sub_1001FEB0+8Bj
		mov	eax, [ebp+var_4]

loc_1001FF9A:				; CODE XREF: sub_1001FEB0+71j
					; sub_1001FEB0+DEj ...
		mov	esp, ebp
		pop	ebp
		retn
sub_1001FEB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001FFA0(int,	int backlog)
sub_1001FFA0	proc near		; CODE XREF: sub_10015040+Ap

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
backlog		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+backlog]
		push	eax		; backlog
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	eax, [edx+28h]
		push	eax		; s
		call	listen
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jge	short loc_1001FFCE
		call	WSAGetLastError
		push	eax
		call	sub_10025420
		add	esp, 4

loc_1001FFCE:				; CODE XREF: sub_1001FFA0+1Ej
		mov	eax, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_1001FFA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1001FFE0(int,	int how)
sub_1001FFE0	proc near		; CODE XREF: sub_10015060+Ap

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
how		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+how]
		push	eax		; how
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	eax, [edx+28h]
		push	eax		; s
		call	shutdown
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jge	short loc_1002000E
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4

loc_1002000E:				; CODE XREF: sub_1001FFE0+1Ej
		mov	eax, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_1001FFE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020020(int,	struct sockaddr	*name, int *namelen)
sub_10020020	proc near		; CODE XREF: sub_100157F0+17p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
name		= dword	ptr  0Ch
namelen		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+namelen]
		push	eax		; namelen
		mov	ecx, [ebp+name]
		push	ecx		; name
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		mov	ecx, [eax+28h]
		push	ecx		; s
		call	getsockname
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_1002004A
		xor	eax, eax
		jmp	short loc_1002005B
; ---------------------------------------------------------------------------
		jmp	short loc_1002005B
; ---------------------------------------------------------------------------

loc_1002004A:				; CODE XREF: sub_10020020+22j
		call	WSAGetLastError
		push	eax
		call	sub_100254E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_1002005B:				; CODE XREF: sub_10020020+26j
					; sub_10020020+28j
		mov	esp, ebp
		pop	ebp
		retn
sub_10020020	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020060(int,	void *Dst, int *namelen)
sub_10020060	proc near		; CODE XREF: sub_10015820+17p

optlen		= dword	ptr -0Ch
optval		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Dst		= dword	ptr  0Ch
namelen		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+34h], 0
		jz	loc_10020117
		mov	[ebp+optlen], 4
		lea	edx, [ebp+optlen]
		push	edx		; optlen
		lea	eax, [ebp+optval]
		push	eax		; optval
		push	700Ch		; optname
		push	0FFFFh		; level
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	eax, [edx+28h]
		push	eax		; s
		call	getsockopt
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_10020102
		cmp	dword ptr [ebp+optval],	0FFFFFFFFh
		jnz	short loc_100200C4
		push	0
		push	0FFFFE8A6h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1002014E
; ---------------------------------------------------------------------------

loc_100200C4:				; CODE XREF: sub_10020060+4Bj
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		movzx	eax, word ptr [edx+38h]
		sub	eax, 2
		neg	eax
		sbb	eax, eax
		and	eax, 0Ch
		add	eax, 10h
		mov	ecx, [ebp+namelen]
		mov	[ecx], eax
		mov	edx, [ebp+namelen]
		mov	eax, [edx]
		push	eax		; Size
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		add	edx, 38h
		push	edx		; Src
		mov	eax, [ebp+Dst]
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		xor	eax, eax
		jmp	short loc_1002014E
; ---------------------------------------------------------------------------
		jmp	short loc_10020115
; ---------------------------------------------------------------------------

loc_10020102:				; CODE XREF: sub_10020060+45j
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_1002014E
; ---------------------------------------------------------------------------

loc_10020115:				; CODE XREF: sub_10020060+A0j
		jmp	short loc_1002014E
; ---------------------------------------------------------------------------

loc_10020117:				; CODE XREF: sub_10020060+10j
		mov	ecx, [ebp+namelen]
		push	ecx		; namelen
		mov	edx, [ebp+Dst]
		push	edx		; name
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; s
		call	getpeername
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_1002013D
		xor	eax, eax
		jmp	short loc_1002014E
; ---------------------------------------------------------------------------
		jmp	short loc_1002014E
; ---------------------------------------------------------------------------

loc_1002013D:				; CODE XREF: sub_10020060+D5j
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_1002014E:				; CODE XREF: sub_10020060+5Fj
					; sub_10020060+9Ej ...
		mov	esp, ebp
		pop	ebp
		retn
sub_10020060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020160(int,	int level, int optname,	char *optval, int *optlen)
sub_10020160	proc near		; CODE XREF: sub_100026E0+7Bp
					; sub_100026E0+D2p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
level		= dword	ptr  0Ch
optname		= dword	ptr  10h
optval		= dword	ptr  14h
optlen		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+optlen]
		push	eax		; optlen
		mov	ecx, [ebp+optval]
		push	ecx		; optval
		mov	edx, [ebp+optname]
		push	edx		; optname
		mov	eax, [ebp+level]
		push	eax		; level
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	eax, [edx+28h]
		push	eax		; s
		call	getsockopt
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_10020192
		xor	eax, eax
		jmp	short loc_100201A3
; ---------------------------------------------------------------------------
		jmp	short loc_100201A3
; ---------------------------------------------------------------------------

loc_10020192:				; CODE XREF: sub_10020160+2Aj
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_100201A3:				; CODE XREF: sub_10020160+2Ej
					; sub_10020160+30j
		mov	esp, ebp
		pop	ebp
		retn
sub_10020160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100201B0(int,	int level, int optname,	char *optval, int optlen)
sub_100201B0	proc near		; CODE XREF: sub_10002920+A9p
					; sub_10002920+F0p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
level		= dword	ptr  0Ch
optname		= dword	ptr  10h
optval		= dword	ptr  14h
optlen		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+optlen]
		push	eax		; optlen
		mov	ecx, [ebp+optval]
		push	ecx		; optval
		mov	edx, [ebp+optname]
		push	edx		; optname
		mov	eax, [ebp+level]
		push	eax		; level
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	eax, [edx+28h]
		push	eax		; s
		call	setsockopt
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_100201E2
		xor	eax, eax
		jmp	short loc_100201F3
; ---------------------------------------------------------------------------
		jmp	short loc_100201F3
; ---------------------------------------------------------------------------

loc_100201E2:				; CODE XREF: sub_100201B0+2Aj
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_100201F3:				; CODE XREF: sub_100201B0+2Ej
					; sub_100201B0+30j
		mov	esp, ebp
		pop	ebp
		retn
sub_100201B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020200(LPCSTR lpFileName, int)
sub_10020200	proc near		; CODE XREF: PR_Open+2Ap

dwFlagsAndAttributes= dword ptr	-10h
hFile		= dword	ptr -0Ch
dwDesiredAccess	= dword	ptr -8
dwCreationDisposition= dword ptr -4
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+dwDesiredAccess], 0
		mov	[ebp+dwCreationDisposition], 0
		mov	[ebp+dwFlagsAndAttributes], 0
		mov	eax, [ebp+arg_4]
		and	eax, 40h
		jz	short loc_1002022A
		mov	[ebp+dwFlagsAndAttributes], 80000000h

loc_1002022A:				; CODE XREF: sub_10020200+21j
		mov	ecx, [ebp+arg_4]
		and	ecx, 1
		jnz	short loc_1002023A
		mov	edx, [ebp+arg_4]
		and	edx, 4
		jz	short loc_10020245

loc_1002023A:				; CODE XREF: sub_10020200+30j
		mov	eax, [ebp+dwDesiredAccess]
		or	eax, 80000000h
		mov	[ebp+dwDesiredAccess], eax

loc_10020245:				; CODE XREF: sub_10020200+38j
		mov	ecx, [ebp+arg_4]
		and	ecx, 2
		jnz	short loc_10020255
		mov	edx, [ebp+arg_4]
		and	edx, 4
		jz	short loc_10020260

loc_10020255:				; CODE XREF: sub_10020200+4Bj
		mov	eax, [ebp+dwDesiredAccess]
		or	eax, 40000000h
		mov	[ebp+dwDesiredAccess], eax

loc_10020260:				; CODE XREF: sub_10020200+53j
		mov	ecx, [ebp+arg_4]
		and	ecx, 8
		jz	short loc_1002027C
		mov	edx, [ebp+arg_4]
		and	edx, 80h
		jz	short loc_1002027C
		mov	[ebp+dwCreationDisposition], 1
		jmp	short loc_100202B1
; ---------------------------------------------------------------------------

loc_1002027C:				; CODE XREF: sub_10020200+66j
					; sub_10020200+71j
		mov	eax, [ebp+arg_4]
		and	eax, 8
		jz	short loc_10020299
		mov	ecx, [ebp+arg_4]
		and	ecx, 20h
		neg	ecx
		sbb	ecx, ecx
		and	ecx, 0FFFFFFFEh
		add	ecx, 4
		mov	[ebp+dwCreationDisposition], ecx
		jmp	short loc_100202B1
; ---------------------------------------------------------------------------

loc_10020299:				; CODE XREF: sub_10020200+82j
		mov	edx, [ebp+arg_4]
		and	edx, 20h
		jz	short loc_100202AA
		mov	[ebp+dwCreationDisposition], 5
		jmp	short loc_100202B1
; ---------------------------------------------------------------------------

loc_100202AA:				; CODE XREF: sub_10020200+9Fj
		mov	[ebp+dwCreationDisposition], 3

loc_100202B1:				; CODE XREF: sub_10020200+7Aj
					; sub_10020200+97j ...
		mov	eax, [ebp+dwFlagsAndAttributes]
		or	eax, 40000000h
		mov	[ebp+dwFlagsAndAttributes], eax
		push	0		; hTemplateFile
		mov	ecx, [ebp+dwFlagsAndAttributes]
		push	ecx		; dwFlagsAndAttributes
		mov	edx, [ebp+dwCreationDisposition]
		push	edx		; dwCreationDisposition
		push	0		; lpSecurityAttributes
		push	3		; dwShareMode
		mov	eax, [ebp+dwDesiredAccess]
		push	eax		; dwDesiredAccess
		mov	ecx, [ebp+lpFileName]
		push	ecx		; lpFileName
		call	ds:CreateFileA
		mov	[ebp+hFile], eax
		cmp	[ebp+hFile], 0FFFFFFFFh
		jnz	short loc_100202F5
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10020333
; ---------------------------------------------------------------------------

loc_100202F5:				; CODE XREF: sub_10020200+DFj
		mov	edx, [ebp+arg_4]
		and	edx, 10h
		jz	short loc_10020330
		push	2		; dwMoveMethod
		push	0		; lpDistanceToMoveHigh
		push	0		; lDistanceToMove
		mov	eax, [ebp+hFile]
		push	eax		; hFile
		call	ds:SetFilePointer
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10020330
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		mov	ecx, [ebp+hFile]
		push	ecx		; hObject
		call	ds:CloseHandle
		or	eax, 0FFFFFFFFh
		jmp	short loc_10020333
; ---------------------------------------------------------------------------

loc_10020330:				; CODE XREF: sub_10020200+FBj
					; sub_10020200+110j
		mov	eax, [ebp+hFile]

loc_10020333:				; CODE XREF: sub_10020200+F3j
					; sub_10020200+12Ej
		mov	esp, ebp
		pop	ebp
		retn
sub_10020200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020340(LPCSTR lpFileName, int, int)
sub_10020340	proc near		; CODE XREF: PR_OpenFile+2Ap

dwFlagsAndAttributes= dword ptr	-28h
Memory		= dword	ptr -24h
lpSecurityAttributes= dword ptr	-20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
hFile		= dword	ptr -10h
dwDesiredAccess	= dword	ptr -0Ch
var_8		= dword	ptr -8
dwCreationDisposition= dword ptr -4
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+dwDesiredAccess], 0
		mov	[ebp+dwCreationDisposition], 0
		mov	[ebp+dwFlagsAndAttributes], 0
		mov	[ebp+lpSecurityAttributes], 0
		mov	[ebp+Memory], 0
		mov	[ebp+var_8], 0
		mov	eax, [ebp+arg_4]
		and	eax, 40h
		jz	short loc_1002037F
		mov	[ebp+dwFlagsAndAttributes], 80000000h

loc_1002037F:				; CODE XREF: sub_10020340+36j
		mov	ecx, [ebp+arg_4]
		and	ecx, 1
		jnz	short loc_1002038F
		mov	edx, [ebp+arg_4]
		and	edx, 4
		jz	short loc_1002039A

loc_1002038F:				; CODE XREF: sub_10020340+45j
		mov	eax, [ebp+dwDesiredAccess]
		or	eax, 80000000h
		mov	[ebp+dwDesiredAccess], eax

loc_1002039A:				; CODE XREF: sub_10020340+4Dj
		mov	ecx, [ebp+arg_4]
		and	ecx, 2
		jnz	short loc_100203AA
		mov	edx, [ebp+arg_4]
		and	edx, 4
		jz	short loc_100203B5

loc_100203AA:				; CODE XREF: sub_10020340+60j
		mov	eax, [ebp+dwDesiredAccess]
		or	eax, 40000000h
		mov	[ebp+dwDesiredAccess], eax

loc_100203B5:				; CODE XREF: sub_10020340+68j
		mov	ecx, [ebp+arg_4]
		and	ecx, 8
		jz	short loc_100203D1
		mov	edx, [ebp+arg_4]
		and	edx, 80h
		jz	short loc_100203D1
		mov	[ebp+dwCreationDisposition], 1
		jmp	short loc_10020406
; ---------------------------------------------------------------------------

loc_100203D1:				; CODE XREF: sub_10020340+7Bj
					; sub_10020340+86j
		mov	eax, [ebp+arg_4]
		and	eax, 8
		jz	short loc_100203EE
		mov	ecx, [ebp+arg_4]
		and	ecx, 20h
		neg	ecx
		sbb	ecx, ecx
		and	ecx, 0FFFFFFFEh
		add	ecx, 4
		mov	[ebp+dwCreationDisposition], ecx
		jmp	short loc_10020406
; ---------------------------------------------------------------------------

loc_100203EE:				; CODE XREF: sub_10020340+97j
		mov	edx, [ebp+arg_4]
		and	edx, 20h
		jz	short loc_100203FF
		mov	[ebp+dwCreationDisposition], 5
		jmp	short loc_10020406
; ---------------------------------------------------------------------------

loc_100203FF:				; CODE XREF: sub_10020340+B4j
		mov	[ebp+dwCreationDisposition], 3

loc_10020406:				; CODE XREF: sub_10020340+8Fj
					; sub_10020340+ACj ...
		mov	eax, [ebp+dwFlagsAndAttributes]
		or	eax, 40000000h
		mov	[ebp+dwFlagsAndAttributes], eax
		mov	ecx, [ebp+arg_4]
		and	ecx, 8
		jz	short loc_10020450
		lea	edx, [ebp+var_8]
		push	edx
		lea	eax, [ebp+Memory]
		push	eax
		push	offset dword_10030664
		mov	ecx, [ebp+arg_8]
		push	ecx
		call	sub_1001CFE0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10020450
		mov	[ebp+var_1C], 0Ch
		mov	edx, [ebp+Memory]
		mov	[ebp+var_18], edx
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_1C]
		mov	[ebp+lpSecurityAttributes], eax

loc_10020450:				; CODE XREF: sub_10020340+D7j
					; sub_10020340+F4j
		push	0		; hTemplateFile
		mov	ecx, [ebp+dwFlagsAndAttributes]
		push	ecx		; dwFlagsAndAttributes
		mov	edx, [ebp+dwCreationDisposition]
		push	edx		; dwCreationDisposition
		mov	eax, [ebp+lpSecurityAttributes]
		push	eax		; lpSecurityAttributes
		push	3		; dwShareMode
		mov	ecx, [ebp+dwDesiredAccess]
		push	ecx		; dwDesiredAccess
		mov	edx, [ebp+lpFileName]
		push	edx		; lpFileName
		call	ds:CreateFileA
		mov	[ebp+hFile], eax
		cmp	[ebp+lpSecurityAttributes], 0
		jz	short loc_10020487
		mov	eax, [ebp+var_8]
		push	eax		; void *
		mov	ecx, [ebp+Memory]
		push	ecx		; Memory
		call	sub_1001D230
		add	esp, 8

loc_10020487:				; CODE XREF: sub_10020340+135j
		cmp	[ebp+hFile], 0FFFFFFFFh
		jnz	short loc_100204A1
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_100204DF
; ---------------------------------------------------------------------------

loc_100204A1:				; CODE XREF: sub_10020340+14Bj
		mov	edx, [ebp+arg_4]
		and	edx, 10h
		jz	short loc_100204DC
		push	2		; dwMoveMethod
		push	0		; lpDistanceToMoveHigh
		push	0		; lDistanceToMove
		mov	eax, [ebp+hFile]
		push	eax		; hFile
		call	ds:SetFilePointer
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100204DC
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		mov	ecx, [ebp+hFile]
		push	ecx		; hObject
		call	ds:CloseHandle
		or	eax, 0FFFFFFFFh
		jmp	short loc_100204DF
; ---------------------------------------------------------------------------

loc_100204DC:				; CODE XREF: sub_10020340+167j
					; sub_10020340+17Cj
		mov	eax, [ebp+hFile]

loc_100204DF:				; CODE XREF: sub_10020340+15Fj
					; sub_10020340+19Aj
		mov	esp, ebp
		pop	ebp
		retn
sub_10020340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100204F0(int,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead)
sub_100204F0	proc near		; CODE XREF: sub_100140A0+6Dp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
NumberOfBytesRead= dword ptr -10h
DistanceToMoveHigh= dword ptr -0Ch
hFile		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
lpBuffer	= dword	ptr  0Ch
nNumberOfBytesToRead= dword ptr	 10h

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+hFile], edx
		mov	[ebp+DistanceToMoveHigh], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+30h], 0
		jnz	loc_10020921
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_1C], eax
		mov	edx, [ebp+var_1C]
		cmp	dword ptr [edx+0ACh], 0
		jz	short loc_10020544
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_10020544:				; CODE XREF: sub_100204F0+3Bj
		xor	eax, eax
		mov	ecx, [ebp+var_1C]
		add	ecx, 0B0h
		mov	[ecx], eax
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		mov	[ecx+0Ch], eax
		mov	[ecx+10h], eax
		push	1		; dwMoveMethod
		mov	edx, [ebp+var_1C]
		add	edx, 0BCh
		push	edx		; lpDistanceToMoveHigh
		push	0		; lDistanceToMove
		mov	eax, [ebp+hFile]
		push	eax		; hFile
		call	ds:SetFilePointer
		mov	ecx, [ebp+var_1C]
		mov	[ecx+0B8h], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+8], 1
		jnz	loc_1002065B
		mov	ecx, [ebp+var_1C]
		add	ecx, 0B0h
		push	ecx		; lpOverlapped
		lea	edx, [ebp+NumberOfBytesRead]
		push	edx		; lpNumberOfBytesRead
		mov	eax, [ebp+nNumberOfBytesToRead]
		push	eax		; nNumberOfBytesToRead
		mov	ecx, [ebp+lpBuffer]
		push	ecx		; lpBuffer
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:ReadFile
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_100205D6
		push	1		; dwMoveMethod
		lea	eax, [ebp+DistanceToMoveHigh]
		push	eax		; lpDistanceToMoveHigh
		mov	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lDistanceToMove
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:SetFilePointer
		mov	[ebp+var_4], eax
		mov	eax, [ebp+NumberOfBytesRead]
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_100205D6:				; CODE XREF: sub_100204F0+C5j
		call	ds:GetLastError
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 3E5h
		jnz	short loc_10020633
		push	1		; bWait
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesTransferred
		mov	ecx, [ebp+var_1C]
		add	ecx, 0B0h
		push	ecx		; lpOverlapped
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:GetOverlappedResult
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_1002062A
		push	1		; dwMoveMethod
		lea	eax, [ebp+DistanceToMoveHigh]
		push	eax		; lpDistanceToMoveHigh
		mov	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lDistanceToMove
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:SetFilePointer
		mov	[ebp+var_4], eax
		mov	eax, [ebp+NumberOfBytesRead]
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_1002062A:				; CODE XREF: sub_100204F0+119j
		call	ds:GetLastError
		mov	[ebp+var_18], eax

loc_10020633:				; CODE XREF: sub_100204F0+F6j
		cmp	[ebp+var_18], 26h
		jnz	short loc_10020642
		xor	eax, eax
		jmp	loc_10020969
; ---------------------------------------------------------------------------
		jmp	short loc_10020656
; ---------------------------------------------------------------------------

loc_10020642:				; CODE XREF: sub_100204F0+147j
		mov	eax, [ebp+var_18]
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_10020656:				; CODE XREF: sub_100204F0+150j
		jmp	loc_1002091F
; ---------------------------------------------------------------------------

loc_1002065B:				; CODE XREF: sub_100204F0+98j
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+2Ch], 0
		jnz	short loc_10020683
		mov	eax, [ebp+hFile]
		push	eax		; FileHandle
		call	sub_1001E100
		add	esp, 4
		mov	[ebp+var_14], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	dword ptr [edx+2Ch], 1

loc_10020683:				; CODE XREF: sub_100204F0+175j
		cmp	dword_10031524,	0
		jz	short loc_1002069E
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+var_1C]
		mov	edx, [ecx+130h]
		mov	[eax+0C0h], edx

loc_1002069E:				; CODE XREF: sub_100204F0+19Aj
		mov	eax, [ebp+var_1C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_1C]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_10020703
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_10020703
		mov	edx, [ebp+var_1C]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_1C]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	edx, [ebp+var_1C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_10020703:				; CODE XREF: sub_100204F0+1CAj
					; sub_100204F0+1D8j
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax+0A4h], 1
		mov	ecx, [ebp+var_1C]
		mov	dword ptr [ecx], 6
		mov	edx, [ebp+var_1C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+hFile]
		mov	[eax+0A8h], ecx
		mov	edx, [ebp+var_1C]
		add	edx, 0B0h
		push	edx		; lpOverlapped
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		mov	ecx, [ebp+nNumberOfBytesToRead]
		push	ecx		; nNumberOfBytesToRead
		mov	edx, [ebp+lpBuffer]
		push	edx		; lpBuffer
		mov	eax, [ebp+hFile]
		push	eax		; hFile
		call	ds:ReadFile
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_1002081E
		call	ds:GetLastError
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 3E5h
		jz	loc_1002081E
		mov	ecx, [ebp+var_1C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_1C]
		mov	dword ptr [edx+0A4h], 0
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax], 2
		mov	ecx, [ebp+var_1C]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_100207F0
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_100207F0
		mov	edx, [ebp+var_1C]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_1C]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	edx, [ebp+var_1C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_100207F0:				; CODE XREF: sub_100204F0+2B7j
					; sub_100204F0+2C5j
		mov	eax, [ebp+var_1C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		cmp	[ebp+var_18], 26h
		jnz	short loc_1002080A
		xor	eax, eax
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_1002080A:				; CODE XREF: sub_100204F0+311j
		mov	ecx, [ebp+var_18]
		push	ecx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_1002081E:				; CODE XREF: sub_100204F0+269j
					; sub_100204F0+27Fj
		cmp	dword_10031524,	0
		jz	short loc_10020843
		cmp	[ebp+var_14], 0
		jz	short loc_10020843
		mov	edx, [ebp+NumberOfBytesRead]
		push	edx
		mov	eax, [ebp+var_14]
		push	eax
		mov	ecx, [ebp+var_1C]
		push	ecx
		call	sub_1001E760
		add	esp, 0Ch
		jmp	short loc_1002085E
; ---------------------------------------------------------------------------

loc_10020843:				; CODE XREF: sub_100204F0+335j
					; sub_100204F0+33Bj
		push	0FFFFFFFFh
		mov	edx, [ebp+var_1C]
		push	edx
		call	sub_1001E800
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1002085E
		or	eax, 0FFFFFFFFh
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_1002085E:				; CODE XREF: sub_100204F0+351j
					; sub_100204F0+364j
		mov	eax, [ebp+var_1C]
		cmp	dword ptr [eax+0ACh], 0
		jz	short loc_100208C6
		mov	ecx, [ebp+var_1C]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_100208AF
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_100208AF
		mov	edx, [ebp+var_1C]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_1C]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_100208BE
; ---------------------------------------------------------------------------

loc_100208AF:				; CODE XREF: sub_100204F0+389j
					; sub_100204F0+397j
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8

loc_100208BE:				; CODE XREF: sub_100204F0+3BDj
		or	eax, 0FFFFFFFFh
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_100208C6:				; CODE XREF: sub_100204F0+378j
		mov	edx, [ebp+var_1C]
		cmp	dword ptr [edx+0ECh], 0
		jnz	short loc_100208FC
		mov	eax, [ebp+var_1C]
		cmp	dword ptr [eax+0F4h], 26h
		jnz	short loc_100208E5
		xor	eax, eax
		jmp	loc_10020969
; ---------------------------------------------------------------------------

loc_100208E5:				; CODE XREF: sub_100204F0+3ECj
		mov	ecx, [ebp+var_1C]
		mov	edx, [ecx+0F4h]
		push	edx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10020969
; ---------------------------------------------------------------------------

loc_100208FC:				; CODE XREF: sub_100204F0+3E0j
		push	1		; dwMoveMethod
		push	0		; lpDistanceToMoveHigh
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+0F0h]
		push	ecx		; lDistanceToMove
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:SetFilePointer
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0F0h]
		jmp	short loc_10020969
; ---------------------------------------------------------------------------

loc_1002091F:				; CODE XREF: sub_100204F0:loc_10020656j
		jmp	short loc_10020969
; ---------------------------------------------------------------------------

loc_10020921:				; CODE XREF: sub_100204F0+23j
		push	0		; lpOverlapped
		lea	ecx, [ebp+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		mov	edx, [ebp+nNumberOfBytesToRead]
		push	edx		; nNumberOfBytesToRead
		mov	eax, [ebp+lpBuffer]
		push	eax		; lpBuffer
		mov	ecx, [ebp+hFile]
		push	ecx		; hFile
		call	ds:ReadFile
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_10020966
		call	ds:GetLastError
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 6Dh
		jnz	short loc_10020955
		xor	eax, eax
		jmp	short loc_10020969
; ---------------------------------------------------------------------------

loc_10020955:				; CODE XREF: sub_100204F0+45Fj
		mov	edx, [ebp+var_18]
		push	edx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10020969
; ---------------------------------------------------------------------------

loc_10020966:				; CODE XREF: sub_100204F0+450j
		mov	eax, [ebp+NumberOfBytesRead]

loc_10020969:				; CODE XREF: sub_100204F0+4Fj
					; sub_100204F0+E1j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_100204F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020970(int,	LPCVOID	lpBuffer, DWORD	nNumberOfBytesToWrite)
sub_10020970	proc near		; CODE XREF: sub_10014140+98p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
NumberOfBytesWritten= dword ptr	-1Ch
lDistanceToMove	= dword	ptr -18h
var_14		= dword	ptr -14h
DistanceToMoveHigh= dword ptr -0Ch
hFile		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
lpBuffer	= dword	ptr  0Ch
nNumberOfBytesToWrite= dword ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+hFile], edx
		mov	[ebp+DistanceToMoveHigh], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+30h], 0
		jnz	loc_10020D9F
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_28], eax
		mov	edx, [ebp+var_28]
		cmp	dword ptr [edx+0ACh], 0
		jz	short loc_100209C4
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------

loc_100209C4:				; CODE XREF: sub_10020970+3Bj
		xor	eax, eax
		mov	ecx, [ebp+var_28]
		add	ecx, 0B0h
		mov	[ecx], eax
		mov	[ecx+4], eax
		mov	[ecx+8], eax
		mov	[ecx+0Ch], eax
		mov	[ecx+10h], eax
		push	1		; dwMoveMethod
		mov	edx, [ebp+var_28]
		add	edx, 0BCh
		push	edx		; lpDistanceToMoveHigh
		push	0		; lDistanceToMove
		mov	eax, [ebp+hFile]
		push	eax		; hFile
		call	ds:SetFilePointer
		mov	ecx, [ebp+var_28]
		mov	[ecx+0B8h], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+8], 1
		jnz	loc_10020ACC
		mov	ecx, [ebp+var_28]
		add	ecx, 0B0h
		push	ecx		; lpOverlapped
		lea	edx, [ebp+NumberOfBytesWritten]
		push	edx		; lpNumberOfBytesWritten
		mov	eax, [ebp+nNumberOfBytesToWrite]
		push	eax		; nNumberOfBytesToWrite
		mov	ecx, [ebp+lpBuffer]
		push	ecx		; lpBuffer
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:WriteFile
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_10020A56
		push	1		; dwMoveMethod
		lea	eax, [ebp+DistanceToMoveHigh]
		push	eax		; lpDistanceToMoveHigh
		mov	ecx, [ebp+NumberOfBytesWritten]
		push	ecx		; lDistanceToMove
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:SetFilePointer
		mov	[ebp+var_4], eax
		mov	eax, [ebp+NumberOfBytesWritten]
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020A56:				; CODE XREF: sub_10020970+C5j
		call	ds:GetLastError
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 3E5h
		jnz	short loc_10020AB3
		push	1		; bWait
		lea	eax, [ebp+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesTransferred
		mov	ecx, [ebp+var_28]
		add	ecx, 0B0h
		push	ecx		; lpOverlapped
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:GetOverlappedResult
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_10020AAA
		push	1		; dwMoveMethod
		lea	eax, [ebp+DistanceToMoveHigh]
		push	eax		; lpDistanceToMoveHigh
		mov	ecx, [ebp+NumberOfBytesWritten]
		push	ecx		; lDistanceToMove
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:SetFilePointer
		mov	[ebp+var_4], eax
		mov	eax, [ebp+NumberOfBytesWritten]
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020AAA:				; CODE XREF: sub_10020970+119j
		call	ds:GetLastError
		mov	[ebp+var_24], eax

loc_10020AB3:				; CODE XREF: sub_10020970+F6j
		mov	eax, [ebp+var_24]
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------
		jmp	loc_10020D9D
; ---------------------------------------------------------------------------

loc_10020ACC:				; CODE XREF: sub_10020970+98j
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+2Ch], 0
		jnz	short loc_10020AF4
		mov	eax, [ebp+hFile]
		push	eax		; FileHandle
		call	sub_1001E100
		add	esp, 4
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	dword ptr [edx+2Ch], 1

loc_10020AF4:				; CODE XREF: sub_10020970+166j
		cmp	dword_10031524,	0
		jz	short loc_10020B0F
		mov	eax, [ebp+var_28]
		mov	ecx, [ebp+var_28]
		mov	edx, [ecx+130h]
		mov	[eax+0C0h], edx

loc_10020B0F:				; CODE XREF: sub_10020970+18Bj
		mov	eax, [ebp+var_28]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_28]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_10020B74
		mov	eax, [ebp+var_28]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_10020B74
		mov	edx, [ebp+var_28]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_28]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	edx, [ebp+var_28]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020B74:				; CODE XREF: sub_10020970+1BBj
					; sub_10020970+1C9j
		mov	eax, [ebp+var_28]
		mov	dword ptr [eax+0A4h], 1
		mov	ecx, [ebp+var_28]
		mov	dword ptr [ecx], 6
		mov	edx, [ebp+var_28]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_28]
		mov	ecx, [ebp+hFile]
		mov	[eax+0A8h], ecx
		mov	edx, [ebp+var_28]
		add	edx, 0B0h
		push	edx		; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		mov	ecx, [ebp+nNumberOfBytesToWrite]
		push	ecx		; nNumberOfBytesToWrite
		mov	edx, [ebp+lpBuffer]
		push	edx		; lpBuffer
		mov	eax, [ebp+hFile]
		push	eax		; hFile
		call	ds:WriteFile
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	loc_10020C82
		call	ds:GetLastError
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 3E5h
		jz	loc_10020C82
		mov	ecx, [ebp+var_28]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_28]
		mov	dword ptr [edx+0A4h], 0
		mov	eax, [ebp+var_28]
		mov	dword ptr [eax], 2
		mov	ecx, [ebp+var_28]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_10020C61
		mov	eax, [ebp+var_28]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_10020C61
		mov	edx, [ebp+var_28]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_28]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	edx, [ebp+var_28]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020C61:				; CODE XREF: sub_10020970+2A8j
					; sub_10020970+2B6j
		mov	eax, [ebp+var_28]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [ebp+var_24]
		push	ecx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020C82:				; CODE XREF: sub_10020970+25Aj
					; sub_10020970+270j
		cmp	dword_10031524,	0
		jz	short loc_10020CA7
		cmp	[ebp+var_20], 0
		jz	short loc_10020CA7
		mov	edx, [ebp+NumberOfBytesWritten]
		push	edx
		mov	eax, [ebp+var_20]
		push	eax
		mov	ecx, [ebp+var_28]
		push	ecx
		call	sub_1001E760
		add	esp, 0Ch
		jmp	short loc_10020CC2
; ---------------------------------------------------------------------------

loc_10020CA7:				; CODE XREF: sub_10020970+319j
					; sub_10020970+31Fj
		push	0FFFFFFFFh
		mov	edx, [ebp+var_28]
		push	edx
		call	sub_1001E800
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10020CC2
		or	eax, 0FFFFFFFFh
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020CC2:				; CODE XREF: sub_10020970+335j
					; sub_10020970+348j
		mov	eax, [ebp+var_28]
		cmp	dword ptr [eax+0ACh], 0
		jz	short loc_10020D2A
		mov	ecx, [ebp+var_28]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_10020D13
		mov	eax, [ebp+var_28]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_10020D13
		mov	edx, [ebp+var_28]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_28]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_10020D22
; ---------------------------------------------------------------------------

loc_10020D13:				; CODE XREF: sub_10020970+36Dj
					; sub_10020970+37Bj
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8

loc_10020D22:				; CODE XREF: sub_10020970+3A1j
		or	eax, 0FFFFFFFFh
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020D2A:				; CODE XREF: sub_10020970+35Cj
		mov	edx, [ebp+var_28]
		cmp	dword ptr [edx+0ECh], 0
		jnz	short loc_10020D50
		mov	eax, [ebp+var_28]
		mov	ecx, [eax+0F4h]
		push	ecx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020D50:				; CODE XREF: sub_10020970+3C4j
		mov	edx, [ebp+var_28]
		mov	eax, [edx+0B8h]
		mov	[ebp+lDistanceToMove], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ecx+0BCh]
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_28]
		mov	eax, [eax+0F0h]
		cdq
		add	eax, [ebp+lDistanceToMove]
		adc	edx, [ebp+var_14]
		mov	[ebp+lDistanceToMove], eax
		mov	[ebp+var_14], edx
		push	0		; dwMoveMethod
		lea	ecx, [ebp+var_14]
		push	ecx		; lpDistanceToMoveHigh
		mov	edx, [ebp+lDistanceToMove]
		push	edx		; lDistanceToMove
		mov	eax, [ebp+hFile]
		push	eax		; hFile
		call	ds:SetFilePointer
		mov	ecx, [ebp+var_28]
		mov	eax, [ecx+0F0h]
		jmp	short loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020D9D:				; CODE XREF: sub_10020970+157j
		jmp	short loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020D9F:				; CODE XREF: sub_10020970+23j
		push	0		; lpOverlapped
		lea	edx, [ebp+NumberOfBytesWritten]
		push	edx		; lpNumberOfBytesWritten
		mov	eax, [ebp+nNumberOfBytesToWrite]
		push	eax		; nNumberOfBytesToWrite
		mov	ecx, [ebp+lpBuffer]
		push	ecx		; lpBuffer
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:WriteFile
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_10020DD4
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10020DD7
; ---------------------------------------------------------------------------

loc_10020DD4:				; CODE XREF: sub_10020970+44Ej
		mov	eax, [ebp+NumberOfBytesWritten]

loc_10020DD7:				; CODE XREF: sub_10020970+4Fj
					; sub_10020970+E1j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_10020970	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020DE0	proc near		; CODE XREF: sub_10015520+12j
					; sub_10015540+Fp

argp		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		lea	eax, [ebp+argp]
		push	eax		; argp
		push	4004667Fh	; cmd
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	eax, [edx+28h]
		push	eax		; s
		call	ioctlsocket
		test	eax, eax
		jge	short loc_10020E18
		call	WSAGetLastError
		push	eax
		push	0FFFFE891h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	short loc_10020E1B
; ---------------------------------------------------------------------------

loc_10020E18:				; CODE XREF: sub_10020DE0+1Ej
		mov	eax, [ebp+argp]

loc_10020E1B:				; CODE XREF: sub_10020DE0+36j
		mov	esp, ebp
		pop	ebp
		retn
sub_10020DE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020E20	proc near		; CODE XREF: sub_10014310j
					; sub_10014320+5p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jnz	short loc_10020E3A
		push	0
		push	0FFFFE891h
		call	PR_SetError
		add	esp, 8
		jmp	short loc_10020E49
; ---------------------------------------------------------------------------

loc_10020E3A:				; CODE XREF: sub_10020E20+7j
		push	0
		push	0FFFFE898h
		call	PR_SetError
		add	esp, 8

loc_10020E49:				; CODE XREF: sub_10020E20+18j
		or	eax, 0FFFFFFFFh
		pop	ebp
		retn
sub_10020E20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020E50(int,	LONG lDistanceToMove, int)
sub_10020E50	proc near		; CODE XREF: sub_10014220j
					; sub_10014250+Cp ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
dwMoveMethod	= dword	ptr -4
arg_0		= dword	ptr  8
lDistanceToMove	= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_10020E70
		cmp	[ebp+var_C], 1
		jz	short loc_10020E79
		cmp	[ebp+var_C], 2
		jz	short loc_10020E82
		jmp	short loc_10020E8B
; ---------------------------------------------------------------------------

loc_10020E70:				; CODE XREF: sub_10020E50+10j
		mov	[ebp+dwMoveMethod], 0
		jmp	short loc_10020E9F
; ---------------------------------------------------------------------------

loc_10020E79:				; CODE XREF: sub_10020E50+16j
		mov	[ebp+dwMoveMethod], 1
		jmp	short loc_10020E9F
; ---------------------------------------------------------------------------

loc_10020E82:				; CODE XREF: sub_10020E50+1Cj
		mov	[ebp+dwMoveMethod], 2
		jmp	short loc_10020E9F
; ---------------------------------------------------------------------------

loc_10020E8B:				; CODE XREF: sub_10020E50+1Ej
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	short loc_10020ED4
; ---------------------------------------------------------------------------

loc_10020E9F:				; CODE XREF: sub_10020E50+27j
					; sub_10020E50+30j ...
		mov	ecx, [ebp+dwMoveMethod]
		push	ecx		; dwMoveMethod
		push	0		; lpDistanceToMoveHigh
		mov	edx, [ebp+lDistanceToMove]
		push	edx		; lDistanceToMove
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; hFile
		call	ds:SetFilePointer
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0FFFFFFFFh
		jnz	short loc_10020ED1
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4

loc_10020ED1:				; CODE XREF: sub_10020E50+70j
		mov	eax, [ebp+var_8]

loc_10020ED4:				; CODE XREF: sub_10020E50+4Dj
		mov	esp, ebp
		pop	ebp
		retn
sub_10020E50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020EE0	proc near		; CODE XREF: sub_10014230+14p
					; sub_100142A0+Fp ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
lDistanceToMove	= dword	ptr -10h
DistanceToMoveHigh= dword ptr -0Ch
dwMoveMethod	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_10020F00
		cmp	[ebp+var_18], 1
		jz	short loc_10020F09
		cmp	[ebp+var_18], 2
		jz	short loc_10020F12
		jmp	short loc_10020F1B
; ---------------------------------------------------------------------------

loc_10020F00:				; CODE XREF: sub_10020EE0+10j
		mov	[ebp+dwMoveMethod], 0
		jmp	short loc_10020F32
; ---------------------------------------------------------------------------

loc_10020F09:				; CODE XREF: sub_10020EE0+16j
		mov	[ebp+dwMoveMethod], 1
		jmp	short loc_10020F32
; ---------------------------------------------------------------------------

loc_10020F12:				; CODE XREF: sub_10020EE0+1Cj
		mov	[ebp+dwMoveMethod], 2
		jmp	short loc_10020F32
; ---------------------------------------------------------------------------

loc_10020F1B:				; CODE XREF: sub_10020EE0+1Ej
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		or	edx, 0FFFFFFFFh
		jmp	short loc_10020F92
; ---------------------------------------------------------------------------

loc_10020F32:				; CODE XREF: sub_10020EE0+27j
					; sub_10020EE0+30j ...
		mov	ecx, [ebp+arg_4]
		mov	[ebp+lDistanceToMove], ecx
		mov	edx, [ebp+arg_8]
		mov	[ebp+DistanceToMoveHigh], edx
		mov	eax, [ebp+dwMoveMethod]
		push	eax		; dwMoveMethod
		lea	ecx, [ebp+DistanceToMoveHigh]
		push	ecx		; lpDistanceToMoveHigh
		mov	edx, [ebp+lDistanceToMove]
		push	edx		; lDistanceToMove
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; hFile
		call	ds:SetFilePointer
		mov	[ebp+lDistanceToMove], eax
		cmp	[ebp+lDistanceToMove], 0FFFFFFFFh
		jnz	short loc_10020F8C
		call	ds:GetLastError
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_10020F8C
		mov	eax, [ebp+var_14]
		push	eax
		call	sub_100253E0
		add	esp, 4
		mov	[ebp+lDistanceToMove], 0FFFFFFFFh
		mov	[ebp+DistanceToMoveHigh], 0FFFFFFFFh

loc_10020F8C:				; CODE XREF: sub_10020EE0+81j
					; sub_10020EE0+90j
		mov	eax, [ebp+lDistanceToMove]
		mov	edx, [ebp+DistanceToMoveHigh]

loc_10020F92:				; CODE XREF: sub_10020EE0+50j
		mov	esp, ebp
		pop	ebp
		retn
sub_10020EE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10020FA0	proc near		; CODE XREF: sub_10014380+5p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; hFile
		call	ds:FlushFileBuffers
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_10020FDF
		call	ds:GetLastError
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 5
		jz	short loc_10020FDF
		mov	eax, [ebp+var_8]
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10020FE1
; ---------------------------------------------------------------------------

loc_10020FDF:				; CODE XREF: sub_10020FA0+1Dj
					; sub_10020FA0+2Cj
		xor	eax, eax

loc_10020FE1:				; CODE XREF: sub_10020FA0+3Dj
		mov	esp, ebp
		pop	ebp
		retn
sub_10020FA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10020FF0(SOCKET s, int)
sub_10020FF0	proc near		; CODE XREF: sub_100143A0+2Dp
					; PR_Open+50p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
s		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_8], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_10021026
		mov	eax, [ebp+s]
		push	eax		; s
		call	closesocket
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jge	short loc_10021024
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4

loc_10021024:				; CODE XREF: sub_10020FF0+24j
		jmp	short loc_1002104D
; ---------------------------------------------------------------------------

loc_10021026:				; CODE XREF: sub_10020FF0+12j
		mov	ecx, [ebp+s]
		push	ecx		; hObject
		call	ds:CloseHandle
		neg	eax
		sbb	eax, eax
		neg	eax
		sub	eax, 1
		mov	[ebp+var_4], eax
		jns	short loc_1002104D
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4

loc_1002104D:				; CODE XREF: sub_10020FF0:loc_10021024j
					; sub_10020FF0+4Cj
		cmp	[ebp+var_4], 0
		jnz	loc_1002112D
		mov	edx, [ebp+var_8]
		cmp	dword ptr [edx+0ACh], 0
		jz	loc_1002112D
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+0A8h]
		cmp	ecx, [ebp+s]
		jnz	loc_1002112D
		mov	edx, [ebp+var_8]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+var_8]
		mov	dword ptr [eax], 6
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+0A4h]
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_8]
		mov	dword ptr [eax+0ACh], 0
		mov	ecx, [ebp+var_8]
		mov	dword ptr [ecx+12Ch], 1
		mov	edx, [ebp+var_8]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		cmp	[ebp+var_C], 0
		jz	short loc_100210D6
		push	0FFFFFFFFh
		mov	eax, [ebp+var_8]
		push	eax
		call	sub_1001E800
		add	esp, 8

loc_100210D6:				; CODE XREF: sub_10020FF0+D6j
		mov	ecx, [ebp+var_8]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_8]
		mov	dword ptr [edx+12Ch], 0
		mov	eax, [ebp+var_8]
		mov	dword ptr [eax+128h], 0
		mov	ecx, [ebp+var_8]
		mov	dword ptr [ecx+0ACh], 0
		mov	edx, [ebp+var_8]
		mov	dword ptr [edx+0A4h], 0
		mov	eax, [ebp+var_8]
		mov	dword ptr [eax], 2
		mov	ecx, [ebp+var_8]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection

loc_1002112D:				; CODE XREF: sub_10020FF0+61j
					; sub_10020FF0+71j ...
		mov	eax, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_10020FF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10021140	proc near		; CODE XREF: PR_SetFDInheritable+2Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+2Ch], 0
		jz	short loc_10021164
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	short loc_1002119F
; ---------------------------------------------------------------------------

loc_10021164:				; CODE XREF: sub_10021140+Ej
		xor	edx, edx
		cmp	[ebp+arg_4], 0
		setnz	dl
		push	edx		; dwFlags
		push	1		; dwMask
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; hObject
		call	ds:SetHandleInformation
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_1002119D
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_1002119F
; ---------------------------------------------------------------------------

loc_1002119D:				; CODE XREF: sub_10021140+47j
		xor	eax, eax

loc_1002119F:				; CODE XREF: sub_10021140+22j
					; sub_10021140+5Bj
		mov	esp, ebp
		pop	ebp
		retn
sub_10021140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100211B0	proc near		; CODE XREF: PR_Open+66p
					; PR_OpenFile+66p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_100211C8
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	dword ptr [ecx+8], 0FFFFFFFFh
		jmp	short loc_100211D5
; ---------------------------------------------------------------------------

loc_100211C8:				; CODE XREF: sub_100211B0+7j
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		mov	dword ptr [eax+8], 0

loc_100211D5:				; CODE XREF: sub_100211B0+16j
		pop	ebp
		retn
sub_100211B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100211E0	proc near		; CODE XREF: PR_ProcessAttrSetInheritableFD+29p

dwFlags		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+2Ch], 0
		jz	short loc_100211F2
		jmp	short loc_1002122E
; ---------------------------------------------------------------------------

loc_100211F2:				; CODE XREF: sub_100211E0+Ej
		lea	edx, [ebp+dwFlags]
		push	edx		; lpdwFlags
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		push	edx		; hObject
		call	ds:GetHandleInformation
		test	eax, eax
		jz	short loc_1002122E
		mov	eax, [ebp+dwFlags]
		and	eax, 1
		jz	short loc_10021221
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	dword ptr [edx+8], 1
		jmp	short loc_1002122E
; ---------------------------------------------------------------------------

loc_10021221:				; CODE XREF: sub_100211E0+30j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	dword ptr [ecx+8], 0

loc_1002122E:				; CODE XREF: sub_100211E0+10j
					; sub_100211E0+28j ...
		mov	esp, ebp
		pop	ebp
		retn
sub_100211E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021240(unsigned __int8 *, int)
sub_10021240	proc near		; CODE XREF: sub_100212E0+187p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp

loc_10021243:				; CODE XREF: sub_10021240+2Fj
		mov	eax, [ebp+arg_4]
		sub	eax, 1
		mov	[ebp+arg_4], eax
		js	short loc_10021271
		mov	ecx, [ebp+arg_0]
		movsx	edx, byte ptr [ecx]
		cmp	edx, 2Fh
		jnz	short loc_1002125F
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	5Ch

loc_1002125F:				; CODE XREF: sub_10021240+17j
		mov	ecx, [ebp+arg_0]
		push	ecx		; unsigned __int8 *
		call	ds:_mbsinc
		add	esp, 4
		mov	[ebp+arg_0], eax
		jmp	short loc_10021243
; ---------------------------------------------------------------------------

loc_10021271:				; CODE XREF: sub_10021240+Cj
		pop	ebp
		retn
sub_10021240	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10021280	proc near		; CODE XREF: PR_CloseDir+Ep

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_100212C0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		push	ecx		; hFindFile
		call	ds:FindClose
		test	eax, eax
		jz	short loc_100212AC
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx+148h], 0FFFFFFFFh
		xor	eax, eax
		jmp	short loc_100212D2
; ---------------------------------------------------------------------------
		jmp	short loc_100212C0
; ---------------------------------------------------------------------------

loc_100212AC:				; CODE XREF: sub_10021280+17j
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_100212D2
; ---------------------------------------------------------------------------

loc_100212C0:				; CODE XREF: sub_10021280+7j
					; sub_10021280+2Aj
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh

loc_100212D2:				; CODE XREF: sub_10021280+28j
					; sub_10021280+3Ej
		pop	ebp
		retn
sub_10021280	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100212E0	proc near		; CODE XREF: PR_OpenDir+1Dp

var_140		= dword	ptr -140h
var_139		= byte ptr -139h
var_138		= dword	ptr -138h
var_134		= dword	ptr -134h
var_12D		= byte ptr -12Dh
var_12C		= dword	ptr -12Ch
var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_119		= byte ptr -119h
var_118		= dword	ptr -118h
var_114		= dword	ptr -114h
FileName	= byte ptr -110h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 140h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_114], eax
		mov	ecx, [ebp+var_114]
		add	ecx, 1
		mov	[ebp+var_118], ecx

loc_1002130B:				; CODE XREF: sub_100212E0+47j
		mov	edx, [ebp+var_114]
		mov	al, [edx]
		mov	[ebp+var_119], al
		add	[ebp+var_114], 1
		cmp	[ebp+var_119], 0
		jnz	short loc_1002130B
		mov	ecx, [ebp+var_114]
		sub	ecx, [ebp+var_118]
		mov	[ebp+var_120], ecx
		mov	edx, [ebp+var_120]
		mov	[ebp+var_4], edx
		mov	eax, [ebp+var_4]
		add	eax, 5
		cmp	eax, 104h
		jle	short loc_10021368
		push	0
		push	0FFFFE8C1h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_100214C0
; ---------------------------------------------------------------------------

loc_10021368:				; CODE XREF: sub_100212E0+6Fj
		mov	ecx, [ebp+arg_4]
		mov	[ebp+var_124], ecx
		lea	edx, [ebp+FileName]
		mov	[ebp+var_128], edx
		mov	eax, [ebp+var_128]
		mov	[ebp+var_12C], eax

loc_10021389:				; CODE XREF: sub_100212E0+EAj
		mov	ecx, [ebp+var_124]
		mov	dl, [ecx]
		mov	[ebp+var_12D], dl
		mov	eax, [ebp+var_128]
		mov	cl, [ebp+var_12D]
		mov	[eax], cl
		mov	edx, [ebp+var_124]
		add	edx, 1
		mov	[ebp+var_124], edx
		mov	eax, [ebp+var_128]
		add	eax, 1
		mov	[ebp+var_128], eax
		cmp	[ebp+var_12D], 0
		jnz	short loc_10021389
		mov	ecx, [ebp+var_4]
		lea	edx, [ebp+ecx+FileName]
		push	edx		; unsigned __int8 *
		lea	eax, [ebp+FileName]
		push	eax		; unsigned __int8 *
		call	sub_100217C0
		add	esp, 8
		test	eax, eax
		jz	short loc_100213F3
		mov	ecx, [ebp+var_4]
		sub	ecx, 1
		mov	[ebp+var_4], ecx

loc_100213F3:				; CODE XREF: sub_100212E0+108j
		mov	edx, [ebp+var_4]
		lea	eax, [ebp+edx+FileName]
		mov	ecx, ds:dword_1002B2E8
		mov	[eax], ecx
		mov	dl, ds:byte_1002B2EC
		mov	[eax+4], dl
		lea	eax, [ebp+FileName]
		mov	[ebp+var_134], eax
		mov	ecx, [ebp+var_134]
		add	ecx, 1
		mov	[ebp+var_138], ecx

loc_10021429:				; CODE XREF: sub_100212E0+165j
		mov	edx, [ebp+var_134]
		mov	al, [edx]
		mov	[ebp+var_139], al
		add	[ebp+var_134], 1
		cmp	[ebp+var_139], 0
		jnz	short loc_10021429
		mov	ecx, [ebp+var_134]
		sub	ecx, [ebp+var_138]
		mov	[ebp+var_140], ecx
		mov	edx, [ebp+var_140]
		push	edx		; int
		lea	eax, [ebp+FileName]
		push	eax		; unsigned __int8 *
		call	sub_10021240
		add	esp, 8
		mov	ecx, [ebp+arg_0]
		add	ecx, 4
		push	ecx		; lpFindFileData
		lea	edx, [ebp+FileName]
		push	edx		; lpFileName
		call	ds:FindFirstFileA
		mov	ecx, [ebp+arg_0]
		mov	[ecx], eax
		mov	edx, [ebp+arg_0]
		cmp	dword ptr [edx], 0FFFFFFFFh
		jnz	short loc_100214A4
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_100214C0
; ---------------------------------------------------------------------------

loc_100214A4:				; CODE XREF: sub_100212E0+1AEj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+144h], 1
		mov	ecx, [ebp+arg_0]
		mov	dword ptr [ecx+148h], 55555555h
		xor	eax, eax

loc_100214C0:				; CODE XREF: sub_100212E0+83j
					; sub_100212E0+1C2j
		mov	ecx, [ebp+var_8]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100212E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100214D0	proc near		; CODE XREF: PR_ReadDir+Ep

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		cmp	[ebp+arg_0], 0
		jz	loc_100215C0

loc_100214E0:				; CODE XREF: sub_100214D0+84j
					; sub_100214D0+B0j ...
		mov	eax, 1
		test	eax, eax
		jz	loc_100215A7
		mov	ecx, [ebp+arg_0]
		cmp	dword ptr [ecx+144h], 0
		jz	short loc_1002150F
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx+144h], 0
		mov	[ebp+var_4], 1
		jmp	short loc_10021525
; ---------------------------------------------------------------------------

loc_1002150F:				; CODE XREF: sub_100214D0+27j
		mov	eax, [ebp+arg_0]
		add	eax, 4
		push	eax		; lpFindFileData
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx]
		push	edx		; hFindFile
		call	ds:FindNextFileA
		mov	[ebp+var_4], eax

loc_10021525:				; CODE XREF: sub_100214D0+3Dj
		cmp	[ebp+var_4], 0
		jnz	short loc_1002152D
		jmp	short loc_100215A7
; ---------------------------------------------------------------------------

loc_1002152D:				; CODE XREF: sub_100214D0+59j
		mov	eax, [ebp+arg_0]
		add	eax, 30h
		mov	[ebp+var_C], eax
		mov	ecx, [ebp+arg_4]
		and	ecx, 1
		jz	short loc_10021556
		mov	edx, [ebp+var_C]
		movsx	eax, byte ptr [edx]
		cmp	eax, 2Eh
		jnz	short loc_10021556
		mov	ecx, [ebp+var_C]
		movsx	edx, byte ptr [ecx+1]
		test	edx, edx
		jnz	short loc_10021556
		jmp	short loc_100214E0
; ---------------------------------------------------------------------------

loc_10021556:				; CODE XREF: sub_100214D0+6Cj
					; sub_100214D0+77j ...
		mov	eax, [ebp+arg_4]
		and	eax, 2
		jz	short loc_10021585
		mov	ecx, [ebp+var_C]
		movsx	edx, byte ptr [ecx]
		cmp	edx, 2Eh
		jnz	short loc_10021585
		mov	eax, [ebp+var_C]
		movsx	ecx, byte ptr [eax+1]
		cmp	ecx, 2Eh
		jnz	short loc_10021585
		mov	edx, [ebp+var_C]
		movsx	eax, byte ptr [edx+2]
		test	eax, eax
		jnz	short loc_10021585
		jmp	loc_100214E0
; ---------------------------------------------------------------------------

loc_10021585:				; CODE XREF: sub_100214D0+8Cj
					; sub_100214D0+97j ...
		mov	ecx, [ebp+arg_4]
		and	ecx, 4
		jz	short loc_1002159D
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		and	eax, 2
		jz	short loc_1002159D
		jmp	loc_100214E0
; ---------------------------------------------------------------------------

loc_1002159D:				; CODE XREF: sub_100214D0+BBj
					; sub_100214D0+C6j
		mov	eax, [ebp+var_C]
		jmp	short loc_100215D1
; ---------------------------------------------------------------------------
		jmp	loc_100214E0
; ---------------------------------------------------------------------------

loc_100215A7:				; CODE XREF: sub_100214D0+17j
					; sub_100214D0+5Bj
		call	ds:GetLastError
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+var_8]
		push	ecx
		call	sub_100253E0
		add	esp, 4
		xor	eax, eax
		jmp	short loc_100215D1
; ---------------------------------------------------------------------------

loc_100215C0:				; CODE XREF: sub_100214D0+Aj
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		xor	eax, eax

loc_100215D1:				; CODE XREF: sub_100214D0+D0j
					; sub_100214D0+EEj
		mov	esp, ebp
		pop	ebp
		retn
sub_100214D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100215E0(LPCSTR lpFileName)
sub_100215E0	proc near		; CODE XREF: PR_Delete+5p

lpFileName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+lpFileName]
		push	eax		; lpFileName
		call	ds:DeleteFileA
		test	eax, eax
		jz	short loc_100215F7
		xor	eax, eax
		jmp	short loc_10021609
; ---------------------------------------------------------------------------
		jmp	short loc_10021609
; ---------------------------------------------------------------------------

loc_100215F7:				; CODE XREF: sub_100215E0+Fj
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_10021609:				; CODE XREF: sub_100215E0+13j
					; sub_100215E0+15j
		pop	ebp
		retn
sub_100215E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10021610	proc near		; CODE XREF: PR_Now+32p
					; sub_10021820+BAp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx]
		mov	[eax], edx
		mov	ecx, [ecx+4]
		mov	[eax+4], ecx
		mov	edx, [ebp+arg_4]
		mov	eax, [edx]
		sub	eax, ds:dword_1002B238
		mov	ecx, [edx+4]
		sbb	ecx, ds:dword_1002B23C
		push	0
		push	0Ah
		push	ecx
		push	eax
		call	sub_10026C40
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		pop	ebp
		retn
sub_10021610	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl PR_Stat_0(char *,	struct stat *)
PR_Stat_0	proc near		; CODE XREF: PR_Statj

var_135		= byte ptr -135h
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_128		= dword	ptr -128h
var_121		= byte ptr -121h
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_118		= byte ptr -118h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 138h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		push	eax		; struct stat *
		mov	ecx, [ebp+arg_0]
		push	ecx		; char *
		call	ds:_stat
		add	esp, 8
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	loc_1002178A
		mov	edx, [ebp+arg_0]
		mov	[ebp+var_11C], edx
		mov	eax, [ebp+var_11C]
		add	eax, 1
		mov	[ebp+var_120], eax

loc_10021699:				; CODE XREF: PR_Stat_0+65j
		mov	ecx, [ebp+var_11C]
		mov	dl, [ecx]
		mov	[ebp+var_121], dl
		add	[ebp+var_11C], 1
		cmp	[ebp+var_121], 0
		jnz	short loc_10021699
		mov	eax, [ebp+var_11C]
		sub	eax, [ebp+var_120]
		mov	[ebp+var_128], eax
		mov	ecx, [ebp+var_128]
		mov	[ebp+var_8], ecx
		cmp	[ebp+var_8], 0
		jle	loc_1002178A
		cmp	[ebp+var_8], 104h
		jg	loc_1002178A
		mov	edx, [ebp+arg_0]
		add	edx, [ebp+var_8]
		push	edx		; unsigned __int8 *
		mov	eax, [ebp+arg_0]
		push	eax		; unsigned __int8 *
		call	sub_100217C0
		add	esp, 8
		test	eax, eax
		jz	loc_1002178A
		mov	ecx, [ebp+arg_0]
		mov	[ebp+var_12C], ecx
		lea	edx, [ebp+var_118]
		mov	[ebp+var_130], edx
		mov	eax, [ebp+var_130]
		mov	[ebp+var_134], eax

loc_10021725:				; CODE XREF: PR_Stat_0+116j
		mov	ecx, [ebp+var_12C]
		mov	dl, [ecx]
		mov	[ebp+var_135], dl
		mov	eax, [ebp+var_130]
		mov	cl, [ebp+var_135]
		mov	[eax], cl
		mov	edx, [ebp+var_12C]
		add	edx, 1
		mov	[ebp+var_12C], edx
		mov	eax, [ebp+var_130]
		add	eax, 1
		mov	[ebp+var_130], eax
		cmp	[ebp+var_135], 0
		jnz	short loc_10021725
		mov	ecx, [ebp+var_8]
		mov	byte ptr [ebp+ecx+var_11C+3], 0
		mov	edx, [ebp+arg_4]
		push	edx		; struct stat *
		lea	eax, [ebp+var_118]
		push	eax		; char *
		call	ds:_stat
		add	esp, 8
		mov	[ebp+var_4], eax

loc_1002178A:				; CODE XREF: PR_Stat_0+2Bj
					; PR_Stat_0+86j ...
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_100217A1
		call	ds:_errno
		mov	ecx, [eax]
		push	ecx
		call	sub_100253A0
		add	esp, 4

loc_100217A1:				; CODE XREF: PR_Stat_0+13Ej
		mov	eax, [ebp+var_4]
		mov	ecx, [ebp+var_C]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
PR_Stat_0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100217C0(unsigned __int8 *, unsigned __int8 *)
sub_100217C0	proc near		; CODE XREF: sub_100212E0+FEp
					; PR_Stat_0+A4p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jb	short loc_100217D2
		xor	eax, eax
		jmp	short loc_1002181A
; ---------------------------------------------------------------------------

loc_100217D2:				; CODE XREF: sub_100217C0+Cj
		mov	ecx, [ebp+arg_4]
		push	ecx		; unsigned __int8 *
		mov	edx, [ebp+arg_0]
		push	edx		; unsigned __int8 *
		call	ds:_mbsdec
		add	esp, 8
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		sub	eax, 1
		cmp	[ebp+var_4], eax
		jnz	short loc_10021810
		mov	ecx, [ebp+var_4]
		movsx	edx, byte ptr [ecx]
		cmp	edx, 2Fh
		jz	short loc_10021807
		mov	eax, [ebp+var_4]
		movsx	ecx, byte ptr [eax]
		cmp	ecx, 5Ch
		jnz	short loc_10021810

loc_10021807:				; CODE XREF: sub_100217C0+3Aj
		mov	[ebp+var_8], 1
		jmp	short loc_10021817
; ---------------------------------------------------------------------------

loc_10021810:				; CODE XREF: sub_100217C0+2Fj
					; sub_100217C0+45j
		mov	[ebp+var_8], 0

loc_10021817:				; CODE XREF: sub_100217C0+4Ej
		mov	eax, [ebp+var_8]

loc_1002181A:				; CODE XREF: sub_100217C0+10j
		mov	esp, ebp
		pop	ebp
		retn
sub_100217C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021820(LPCSTR lpFileName, int)
sub_10021820	proc near		; CODE XREF: PR_GetFileInfo64+18p
					; sub_10021930+18p

FileInformation	= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= byte ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		cmp	[ebp+lpFileName], 0
		jz	short loc_10021841
		mov	eax, [ebp+lpFileName]
		movsx	ecx, byte ptr [eax]
		test	ecx, ecx
		jnz	short loc_10021858

loc_10021841:				; CODE XREF: sub_10021820+15j
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_10021917
; ---------------------------------------------------------------------------

loc_10021858:				; CODE XREF: sub_10021820+1Fj
		lea	edx, [ebp+FileInformation]
		push	edx		; lpFileInformation
		push	0		; fInfoLevelId
		mov	eax, [ebp+lpFileName]
		push	eax		; lpFileName
		call	ds:GetFileAttributesExA
		test	eax, eax
		jnz	short loc_10021883
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10021917
; ---------------------------------------------------------------------------

loc_10021883:				; CODE XREF: sub_10021820+4Aj
		mov	ecx, [ebp+FileInformation]
		and	ecx, 10h
		jz	short loc_10021896
		mov	edx, [ebp+arg_4]
		mov	dword ptr [edx], 2
		jmp	short loc_1002189F
; ---------------------------------------------------------------------------

loc_10021896:				; CODE XREF: sub_10021820+69j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1

loc_1002189F:				; CODE XREF: sub_10021820+74j
		mov	ecx, [ebp+var_C]
		xor	edx, edx
		mov	eax, [ebp+arg_4]
		mov	[eax+8], ecx
		mov	[eax+0Ch], edx
		mov	ecx, [ebp+arg_4]
		mov	eax, [ecx+8]
		mov	edx, [ecx+0Ch]
		mov	cl, 20h
		call	sub_10026CF0
		mov	ecx, [ebp+var_8]
		xor	esi, esi
		add	eax, ecx
		adc	edx, esi
		mov	ecx, [ebp+arg_4]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	edx, [ebp+arg_4]
		add	edx, 18h
		push	edx
		lea	eax, [ebp+var_14]
		push	eax
		call	sub_10021610
		add	esp, 8
		cmp	[ebp+var_24], 0
		jnz	short loc_10021902
		cmp	[ebp+var_20], 0
		jnz	short loc_10021902
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+arg_4]
		mov	eax, [edx+18h]
		mov	[ecx+10h], eax
		mov	edx, [edx+1Ch]
		mov	[ecx+14h], edx
		jmp	short loc_10021915
; ---------------------------------------------------------------------------

loc_10021902:				; CODE XREF: sub_10021820+C6j
					; sub_10021820+CCj
		mov	eax, [ebp+arg_4]
		add	eax, 10h
		push	eax
		lea	ecx, [ebp+var_24]
		push	ecx
		call	sub_10021610
		add	esp, 8

loc_10021915:				; CODE XREF: sub_10021820+E0j
		xor	eax, eax

loc_10021917:				; CODE XREF: sub_10021820+33j
					; sub_10021820+5Ej
		pop	esi
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10021820	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021930(LPCSTR lpFileName, int)
sub_10021930	proc near		; CODE XREF: PR_GetFileInfo+Ap

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_28]
		push	eax		; int
		mov	ecx, [ebp+lpFileName]
		push	ecx		; lpFileName
		call	sub_10021820
		add	esp, 8
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_10021988
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	ecx, [ebp+var_20]
		mov	edx, [ebp+arg_4]
		mov	[edx+4], ecx
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+var_10]
		mov	[eax+10h], ecx
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+var_18]
		mov	[eax+8], ecx
		mov	edx, [ebp+var_14]
		mov	[eax+0Ch], edx

loc_10021988:				; CODE XREF: sub_10021930+27j
		mov	eax, [ebp+var_2C]
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10021930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100219A0	proc near		; CODE XREF: sub_10014360+Ap

FileInformation	= _BY_HANDLE_FILE_INFORMATION ptr -3Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		push	esi
		lea	eax, [ebp+FileInformation]
		push	eax		; lpFileInformation
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	eax, [edx+28h]
		push	eax		; hFile
		call	ds:GetFileInformationByHandle
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_100219E2
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10021A56
; ---------------------------------------------------------------------------

loc_100219E2:				; CODE XREF: sub_100219A0+2Cj
		mov	ecx, [ebp+FileInformation.dwFileAttributes]
		and	ecx, 10h
		jz	short loc_100219F5
		mov	edx, [ebp+arg_4]
		mov	dword ptr [edx], 2
		jmp	short loc_100219FE
; ---------------------------------------------------------------------------

loc_100219F5:				; CODE XREF: sub_100219A0+48j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1

loc_100219FE:				; CODE XREF: sub_100219A0+53j
		mov	ecx, [ebp+FileInformation.nFileSizeHigh]
		xor	edx, edx
		mov	eax, [ebp+arg_4]
		mov	[eax+8], ecx
		mov	[eax+0Ch], edx
		mov	ecx, [ebp+arg_4]
		mov	eax, [ecx+8]
		mov	edx, [ecx+0Ch]
		mov	cl, 20h
		call	sub_10026CF0
		mov	ecx, [ebp+FileInformation.nFileSizeLow]
		xor	esi, esi
		add	eax, ecx
		adc	edx, esi
		mov	ecx, [ebp+arg_4]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	edx, [ebp+arg_4]
		add	edx, 18h
		push	edx
		lea	eax, [ebp+FileInformation.ftLastWriteTime]
		push	eax
		call	sub_10021610
		add	esp, 8
		mov	ecx, [ebp+arg_4]
		add	ecx, 10h
		push	ecx
		lea	edx, [ebp+FileInformation.ftCreationTime]
		push	edx
		call	sub_10021610
		add	esp, 8
		xor	eax, eax

loc_10021A56:				; CODE XREF: sub_100219A0+40j
		pop	esi
		mov	ecx, [ebp+var_8]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100219A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10021A70	proc near		; CODE XREF: sub_10014340+Ap

FileInformation	= _BY_HANDLE_FILE_INFORMATION ptr -3Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		lea	eax, [ebp+FileInformation]
		push	eax		; lpFileInformation
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		mov	eax, [edx+28h]
		push	eax		; hFile
		call	ds:GetFileInformationByHandle
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jnz	short loc_10021AB1
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10021AFE
; ---------------------------------------------------------------------------

loc_10021AB1:				; CODE XREF: sub_10021A70+2Bj
		mov	ecx, [ebp+FileInformation.dwFileAttributes]
		and	ecx, 10h
		jz	short loc_10021AC4
		mov	edx, [ebp+arg_4]
		mov	dword ptr [edx], 2
		jmp	short loc_10021ACD
; ---------------------------------------------------------------------------

loc_10021AC4:				; CODE XREF: sub_10021A70+47j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1

loc_10021ACD:				; CODE XREF: sub_10021A70+52j
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+FileInformation.nFileSizeLow]
		mov	[ecx+4], edx
		mov	eax, [ebp+arg_4]
		add	eax, 10h
		push	eax
		lea	ecx, [ebp+FileInformation.ftLastWriteTime]
		push	ecx
		call	sub_10021610
		add	esp, 8
		mov	edx, [ebp+arg_4]
		add	edx, 8
		push	edx
		lea	eax, [ebp+FileInformation.ftCreationTime]
		push	eax
		call	sub_10021610
		add	esp, 8
		xor	eax, eax

loc_10021AFE:				; CODE XREF: sub_10021A70+3Fj
		mov	ecx, [ebp+var_8]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10021A70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021B10(LPCSTR lpExistingFileName, LPCSTR lpNewFileName)
sub_10021B10	proc near		; CODE XREF: PR_Rename+Ap

lpExistingFileName= dword ptr  8
lpNewFileName	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+lpNewFileName]
		push	eax		; lpNewFileName
		mov	ecx, [ebp+lpExistingFileName]
		push	ecx		; lpExistingFileName
		call	ds:MoveFileA
		test	eax, eax
		jz	short loc_10021B2B
		xor	eax, eax
		jmp	short loc_10021B3D
; ---------------------------------------------------------------------------
		jmp	short loc_10021B3D
; ---------------------------------------------------------------------------

loc_10021B2B:				; CODE XREF: sub_10021B10+13j
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_10021B3D:				; CODE XREF: sub_10021B10+17j
					; sub_10021B10+19j
		pop	ebp
		retn
sub_10021B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021B40(char	*, int)
sub_10021B40	proc near		; CODE XREF: PR_Access+Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 1
		jz	short loc_10021B88
		cmp	[ebp+var_8], 2
		jz	short loc_10021B60
		cmp	[ebp+var_8], 3
		jz	short loc_10021B74
		jmp	short loc_10021B9C
; ---------------------------------------------------------------------------

loc_10021B60:				; CODE XREF: sub_10021B40+16j
		push	2		; int
		mov	ecx, [ebp+arg_0]
		push	ecx		; char *
		call	ds:_access
		add	esp, 8
		mov	[ebp+var_4], eax
		jmp	short loc_10021BB0
; ---------------------------------------------------------------------------

loc_10021B74:				; CODE XREF: sub_10021B40+1Cj
		push	4		; int
		mov	edx, [ebp+arg_0]
		push	edx		; char *
		call	ds:_access
		add	esp, 8
		mov	[ebp+var_4], eax
		jmp	short loc_10021BB0
; ---------------------------------------------------------------------------

loc_10021B88:				; CODE XREF: sub_10021B40+10j
		push	0		; int
		mov	eax, [ebp+arg_0]
		push	eax		; char *
		call	ds:_access
		add	esp, 8
		mov	[ebp+var_4], eax
		jmp	short loc_10021BB0
; ---------------------------------------------------------------------------

loc_10021B9C:				; CODE XREF: sub_10021B40+1Ej
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	short loc_10021BCA
; ---------------------------------------------------------------------------

loc_10021BB0:				; CODE XREF: sub_10021B40+32j
					; sub_10021B40+46j ...
		cmp	[ebp+var_4], 0
		jge	short loc_10021BC7
		call	ds:_errno
		mov	ecx, [eax]
		push	ecx
		call	sub_100253A0
		add	esp, 4

loc_10021BC7:				; CODE XREF: sub_10021B40+74j
		mov	eax, [ebp+var_4]

loc_10021BCA:				; CODE XREF: sub_10021B40+6Ej
		mov	esp, ebp
		pop	ebp
		retn
sub_10021B40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021BD0(LPCSTR lpPathName)
sub_10021BD0	proc near		; CODE XREF: PR_MkDir+Ap

lpPathName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	0		; lpSecurityAttributes
		mov	eax, [ebp+lpPathName]
		push	eax		; lpPathName
		call	ds:CreateDirectoryA
		test	eax, eax
		jz	short loc_10021BE9
		xor	eax, eax
		jmp	short loc_10021BFB
; ---------------------------------------------------------------------------
		jmp	short loc_10021BFB
; ---------------------------------------------------------------------------

loc_10021BE9:				; CODE XREF: sub_10021BD0+11j
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_10021BFB:				; CODE XREF: sub_10021BD0+15j
					; sub_10021BD0+17j
		pop	ebp
		retn
sub_10021BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021C00(LPCSTR lpPathName, int)
sub_10021C00	proc near		; CODE XREF: PR_MakeDir+18p

Memory		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpSecurityAttributes= dword ptr	-14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpPathName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	[ebp+lpSecurityAttributes], 0
		mov	[ebp+Memory], 0
		mov	[ebp+var_4], 0
		lea	eax, [ebp+var_4]
		push	eax
		lea	ecx, [ebp+Memory]
		push	ecx
		push	offset dword_10030670
		mov	edx, [ebp+arg_4]
		push	edx
		call	sub_1001CFE0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_10021C52
		mov	[ebp+var_10], 0Ch
		mov	eax, [ebp+Memory]
		mov	[ebp+var_C], eax
		mov	[ebp+var_8], 0
		lea	ecx, [ebp+var_10]
		mov	[ebp+lpSecurityAttributes], ecx

loc_10021C52:				; CODE XREF: sub_10021C00+36j
		mov	edx, [ebp+lpSecurityAttributes]
		push	edx		; lpSecurityAttributes
		mov	eax, [ebp+lpPathName]
		push	eax		; lpPathName
		call	ds:CreateDirectoryA
		mov	[ebp+var_18], eax
		cmp	[ebp+lpSecurityAttributes], 0
		jz	short loc_10021C79
		mov	ecx, [ebp+var_4]
		push	ecx		; void *
		mov	edx, [ebp+Memory]
		push	edx		; Memory
		call	sub_1001D230
		add	esp, 8

loc_10021C79:				; CODE XREF: sub_10021C00+67j
		cmp	[ebp+var_18], 0
		jz	short loc_10021C85
		xor	eax, eax
		jmp	short loc_10021C97
; ---------------------------------------------------------------------------
		jmp	short loc_10021C97
; ---------------------------------------------------------------------------

loc_10021C85:				; CODE XREF: sub_10021C00+7Dj
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_10021C97:				; CODE XREF: sub_10021C00+81j
					; sub_10021C00+83j
		mov	esp, ebp
		pop	ebp
		retn
sub_10021C00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021CA0(LPCSTR lpPathName)
sub_10021CA0	proc near		; CODE XREF: PR_RmDir+5p

lpPathName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+lpPathName]
		push	eax		; lpPathName
		call	ds:RemoveDirectoryA
		test	eax, eax
		jz	short loc_10021CB7
		xor	eax, eax
		jmp	short loc_10021CC9
; ---------------------------------------------------------------------------
		jmp	short loc_10021CC9
; ---------------------------------------------------------------------------

loc_10021CB7:				; CODE XREF: sub_10021CA0+Fj
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_10021CC9:				; CODE XREF: sub_10021CA0+13j
					; sub_10021CA0+15j
		pop	ebp
		retn
sub_10021CA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021CD0(HANDLE hFile)
sub_10021CD0	proc near		; CODE XREF: PR_LockFile+76p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
hFile		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		cmp	dword ptr [eax+0ACh], 0
		jz	short loc_10021D01
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_10021FE6
; ---------------------------------------------------------------------------

loc_10021D01:				; CODE XREF: sub_10021CD0+18j
		xor	ecx, ecx
		mov	edx, [ebp+var_C]
		add	edx, 0B0h
		mov	[edx], ecx
		mov	[edx+4], ecx
		mov	[edx+8], ecx
		mov	[edx+0Ch], ecx
		mov	[edx+10h], ecx
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_10021D7F
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_10021D7F
		mov	edx, [ebp+var_C]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_C]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_10021FE6
; ---------------------------------------------------------------------------

loc_10021D7F:				; CODE XREF: sub_10021CD0+66j
					; sub_10021CD0+74j
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0A4h], 1
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx], 6
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_C]
		add	eax, 0B0h
		push	eax		; lpOverlapped
		push	0		; nNumberOfBytesToLockHigh
		push	7FFFFFFFh	; nNumberOfBytesToLockLow
		push	0		; dwReserved
		push	2		; dwFlags
		mov	ecx, [ebp+hFile]
		push	ecx		; hFile
		call	ds:LockFileEx
		mov	[ebp+var_4], eax
		cmp	dword_10031524,	0
		jz	loc_10021E81
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0A4h], 0
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx], 2
		mov	edx, [ebp+var_C]
		mov	eax, [edx+90h]
		and	eax, 1000h
		jnz	short loc_10021E4A
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+90h]
		and	edx, 2
		jz	short loc_10021E4A
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+90h]
		and	ecx, 0FFFFFFFDh
		mov	edx, [ebp+var_C]
		mov	[edx+90h], ecx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_10021FE6
; ---------------------------------------------------------------------------

loc_10021E4A:				; CODE XREF: sub_10021CD0+131j
					; sub_10021CD0+13Fj
		mov	ecx, [ebp+var_C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		cmp	[ebp+var_4], 0
		jnz	short loc_10021E7A
		call	ds:GetLastError
		mov	[ebp+var_8], eax
		mov	edx, [ebp+var_8]
		push	edx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10021FE6
; ---------------------------------------------------------------------------

loc_10021E7A:				; CODE XREF: sub_10021CD0+18Bj
		xor	eax, eax
		jmp	loc_10021FE6
; ---------------------------------------------------------------------------

loc_10021E81:				; CODE XREF: sub_10021CD0+FAj
		cmp	[ebp+var_4], 0
		jnz	loc_10021F3F
		call	ds:GetLastError
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 3E5h
		jz	loc_10021F3F
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx+0A4h], 0
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx], 2
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_10021F1C
		mov	edx, [ebp+var_C]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_10021F1C
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+var_C]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	ecx, [ebp+var_C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_10021FE6
; ---------------------------------------------------------------------------

loc_10021F1C:				; CODE XREF: sub_10021CD0+203j
					; sub_10021CD0+211j
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_8]
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10021FE6
; ---------------------------------------------------------------------------
		jmp	short loc_10021F79
; ---------------------------------------------------------------------------

loc_10021F3F:				; CODE XREF: sub_10021CD0+1B5j
					; sub_10021CD0+1CBj
		cmp	[ebp+var_4], 0
		jz	short loc_10021F79
		cmp	dword_100329F4,	0
		jnz	short loc_10021F79
		mov	ecx, [ebp+hFile]
		push	ecx		; hFile
		call	sub_100226A0
		add	esp, 4
		cmp	eax, 1
		jnz	short loc_10021F79
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx+0A4h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax], 2
		xor	eax, eax
		jmp	short loc_10021FE6
; ---------------------------------------------------------------------------

loc_10021F79:				; CODE XREF: sub_10021CD0+26Dj
					; sub_10021CD0+273j ...
		push	0FFFFFFFFh
		mov	ecx, [ebp+var_C]
		push	ecx
		call	sub_1001E800
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10021FC1
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0A4h], 0
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx], 2
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	short loc_10021FE6
; ---------------------------------------------------------------------------

loc_10021FC1:				; CODE XREF: sub_10021CD0+2BAj
		mov	eax, [ebp+var_C]
		cmp	dword ptr [eax+0ECh], 0
		jnz	short loc_10021FE4
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+0F4h]
		push	edx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10021FE6
; ---------------------------------------------------------------------------

loc_10021FE4:				; CODE XREF: sub_10021CD0+2FBj
		xor	eax, eax

loc_10021FE6:				; CODE XREF: sub_10021CD0+2Cj
					; sub_10021CD0+AAj ...
		mov	esp, ebp
		pop	ebp
		retn
sub_10021CD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10021FF0(HANDLE hFile)
sub_10021FF0	proc near		; CODE XREF: PR_TLockFile+41p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
hFile		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		cmp	dword ptr [eax+0ACh], 0
		jz	short loc_10022021
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_100223E2
; ---------------------------------------------------------------------------

loc_10022021:				; CODE XREF: sub_10021FF0+18j
		xor	ecx, ecx
		mov	edx, [ebp+var_C]
		add	edx, 0B0h
		mov	[edx], ecx
		mov	[edx+4], ecx
		mov	[edx+8], ecx
		mov	[edx+0Ch], ecx
		mov	[edx+10h], ecx
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+90h]
		and	edx, 1000h
		jnz	short loc_1002209F
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+90h]
		and	ecx, 2
		jz	short loc_1002209F
		mov	edx, [ebp+var_C]
		mov	eax, [edx+90h]
		and	eax, 0FFFFFFFDh
		mov	ecx, [ebp+var_C]
		mov	[ecx+90h], eax
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_100223E2
; ---------------------------------------------------------------------------

loc_1002209F:				; CODE XREF: sub_10021FF0+66j
					; sub_10021FF0+74j
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0A4h], 1
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx], 6
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_C]
		add	eax, 0B0h
		push	eax		; lpOverlapped
		push	0		; nNumberOfBytesToLockHigh
		push	7FFFFFFFh	; nNumberOfBytesToLockLow
		push	0		; dwReserved
		push	3		; dwFlags
		mov	ecx, [ebp+hFile]
		push	ecx		; hFile
		call	ds:LockFileEx
		mov	[ebp+var_4], eax
		cmp	dword_10031524,	0
		jz	loc_100221A1
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0A4h], 0
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx], 2
		mov	edx, [ebp+var_C]
		mov	eax, [edx+90h]
		and	eax, 1000h
		jnz	short loc_1002216A
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+90h]
		and	edx, 2
		jz	short loc_1002216A
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+90h]
		and	ecx, 0FFFFFFFDh
		mov	edx, [ebp+var_C]
		mov	[edx+90h], ecx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_100223E2
; ---------------------------------------------------------------------------

loc_1002216A:				; CODE XREF: sub_10021FF0+131j
					; sub_10021FF0+13Fj
		mov	ecx, [ebp+var_C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		cmp	[ebp+var_4], 0
		jnz	short loc_1002219A
		call	ds:GetLastError
		mov	[ebp+var_8], eax
		mov	edx, [ebp+var_8]
		push	edx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_100223E2
; ---------------------------------------------------------------------------

loc_1002219A:				; CODE XREF: sub_10021FF0+18Bj
		xor	eax, eax
		jmp	loc_100223E2
; ---------------------------------------------------------------------------

loc_100221A1:				; CODE XREF: sub_10021FF0+FAj
		cmp	[ebp+var_4], 0
		jnz	loc_10022262
		call	ds:GetLastError
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 3E5h
		jz	loc_10022262
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx+0A4h], 0
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx], 2
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_1002223C
		mov	edx, [ebp+var_C]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_1002223C
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+var_C]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	ecx, [ebp+var_C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_100223E2
; ---------------------------------------------------------------------------

loc_1002223C:				; CODE XREF: sub_10021FF0+203j
					; sub_10021FF0+211j
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [ebp+var_8]
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_100223E2
; ---------------------------------------------------------------------------
		jmp	loc_1002231C
; ---------------------------------------------------------------------------

loc_10022262:				; CODE XREF: sub_10021FF0+1B5j
					; sub_10021FF0+1CBj
		cmp	[ebp+var_4], 0
		jz	loc_1002231C
		cmp	dword_100329F4,	0
		jnz	loc_1002231C
		mov	ecx, [ebp+hFile]
		push	ecx		; hFile
		call	sub_100226A0
		add	esp, 4
		cmp	eax, 1
		jnz	loc_1002231C
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0A4h], 0
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx], 2
		mov	edx, [ebp+var_C]
		mov	eax, [edx+90h]
		and	eax, 1000h
		jnz	short loc_10022308
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+90h]
		and	edx, 2
		jz	short loc_10022308
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+90h]
		and	ecx, 0FFFFFFFDh
		mov	edx, [ebp+var_C]
		mov	[edx+90h], ecx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	loc_100223E2
; ---------------------------------------------------------------------------

loc_10022308:				; CODE XREF: sub_10021FF0+2CFj
					; sub_10021FF0+2DDj
		mov	ecx, [ebp+var_C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		xor	eax, eax
		jmp	loc_100223E2
; ---------------------------------------------------------------------------

loc_1002231C:				; CODE XREF: sub_10021FF0+26Dj
					; sub_10021FF0+276j ...
		push	0FFFFFFFFh
		mov	edx, [ebp+var_C]
		push	edx
		call	sub_1001E800
		add	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	loc_100223BD
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx+0A4h], 0
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx], 2
		mov	eax, [ebp+var_C]
		mov	ecx, [eax+90h]
		and	ecx, 1000h
		jnz	short loc_100223AB
		mov	edx, [ebp+var_C]
		mov	eax, [edx+90h]
		and	eax, 2
		jz	short loc_100223AB
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+90h]
		and	edx, 0FFFFFFFDh
		mov	eax, [ebp+var_C]
		mov	[eax+90h], edx
		push	0
		push	0FFFFE897h
		call	PR_SetError
		add	esp, 8
		mov	ecx, [ebp+var_C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	short loc_100223E2
; ---------------------------------------------------------------------------

loc_100223AB:				; CODE XREF: sub_10021FF0+375j
					; sub_10021FF0+383j
		mov	edx, [ebp+var_C]
		add	edx, 40h
		push	edx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		or	eax, 0FFFFFFFFh
		jmp	short loc_100223E2
; ---------------------------------------------------------------------------

loc_100223BD:				; CODE XREF: sub_10021FF0+33Dj
		mov	eax, [ebp+var_C]
		cmp	dword ptr [eax+0ECh], 0
		jnz	short loc_100223E0
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+0F4h]
		push	edx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_100223E2
; ---------------------------------------------------------------------------

loc_100223E0:				; CODE XREF: sub_10021FF0+3D7j
		xor	eax, eax

loc_100223E2:				; CODE XREF: sub_10021FF0+2Cj
					; sub_10021FF0+AAj ...
		mov	esp, ebp
		pop	ebp
		retn
sub_10021FF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100223F0(HANDLE hFile)
sub_100223F0	proc near		; CODE XREF: PR_UnlockFile+23p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
hFile		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		cmp	dword ptr [eax+0ACh], 0
		jz	short loc_1002241E
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	short loc_1002247A
; ---------------------------------------------------------------------------

loc_1002241E:				; CODE XREF: sub_100223F0+18j
		xor	ecx, ecx
		mov	edx, [ebp+var_8]
		add	edx, 0B0h
		mov	[edx], ecx
		mov	[edx+4], ecx
		mov	[edx+8], ecx
		mov	[edx+0Ch], ecx
		mov	[edx+10h], ecx
		mov	eax, [ebp+var_8]
		add	eax, 0B0h
		push	eax		; lpOverlapped
		push	0		; nNumberOfBytesToUnlockHigh
		push	7FFFFFFFh	; nNumberOfBytesToUnlockLow
		push	0		; dwReserved
		mov	ecx, [ebp+hFile]
		push	ecx		; hFile
		call	ds:UnlockFileEx
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jz	short loc_10022462
		xor	eax, eax
		jmp	short loc_1002247A
; ---------------------------------------------------------------------------
		jmp	short loc_1002247A
; ---------------------------------------------------------------------------

loc_10022462:				; CODE XREF: sub_100223F0+6Aj
		call	ds:GetLastError
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		push	edx
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh

loc_1002247A:				; CODE XREF: sub_100223F0+2Cj
					; sub_100223F0+6Ej ...
		mov	esp, ebp
		pop	ebp
		retn
sub_100223F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10022480	proc near		; CODE XREF: PR_Socket+89p
					; PR_ImportTCPSocket+29p ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_10022480	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10022490	proc near		; CODE XREF: sub_1001DFF0:loc_1001E08Ap

var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
VolumeSerialNumber= dword ptr -0A8h
uMode		= dword	ptr -0A4h
Buffer		= byte ptr -0A0h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
nBufferLength	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0B0h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_14], eax
		mov	[ebp+nBufferLength], 82h
		push	0		; lpBuffer
		push	0		; nBufferLength
		call	ds:GetLogicalDriveStringsA
		mov	[ebp+var_4], eax
		mov	[ebp+var_AC], 0
		mov	[ebp+var_8], 0
		mov	[ebp+uMode], 0FFFFFFFFh
		push	offset stru_10032A00 ; lpCriticalSection
		call	ds:InitializeCriticalSection
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		mov	ecx, [ebp+nBufferLength]
		push	ecx		; nBufferLength
		call	ds:GetLogicalDriveStringsA
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jz	short loc_100224FF
		mov	edx, [ebp+var_4]
		cmp	edx, [ebp+nBufferLength]
		jbe	short loc_10022506

loc_100224FF:				; CODE XREF: sub_10022490+65j
		xor	eax, eax
		jmp	loc_10022670
; ---------------------------------------------------------------------------

loc_10022506:				; CODE XREF: sub_10022490+6Dj
		mov	eax, [ebp+var_8]
		mov	dword_10032610[eax*4], 0
		push	1		; uMode
		call	ds:SetErrorMode
		mov	[ebp+uMode], eax

loc_10022522:				; CODE XREF: sub_10022490+1B6j
		mov	ecx, [ebp+var_AC]
		movsx	edx, [ebp+ecx+Buffer]
		test	edx, edx
		jz	loc_1002264B
		mov	eax, [ebp+var_AC]
		movsx	ecx, [ebp+eax+Buffer]
		cmp	ecx, 41h
		jz	short loc_1002255E
		mov	edx, [ebp+var_AC]
		movsx	eax, [ebp+edx+Buffer]
		cmp	eax, 42h
		jnz	short loc_10022563

loc_1002255E:				; CODE XREF: sub_10022490+B9j
		jmp	loc_10022622
; ---------------------------------------------------------------------------

loc_10022563:				; CODE XREF: sub_10022490+CCj
		mov	ecx, [ebp+var_AC]
		movsx	edx, [ebp+ecx+Buffer]
		sub	edx, 41h
		mov	[ebp+var_8], edx
		mov	eax, [ebp+var_AC]
		lea	ecx, [ebp+eax+Buffer]
		push	ecx		; lpRootPathName
		call	ds:GetDriveTypeA
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_10]
		mov	[ebp+var_B0], edx
		mov	eax, [ebp+var_B0]
		sub	eax, 2
		mov	[ebp+var_B0], eax
		cmp	[ebp+var_B0], 4	; switch 5 cases
		ja	short loc_100225BC ; jumptable 100225B5	default	case
		mov	ecx, [ebp+var_B0]
		jmp	ds:off_10022680[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100225BC:				; CODE XREF: sub_10022490+11Dj
					; sub_10022490+125j
					; DATA XREF: ...
		jmp	short loc_10022622 ; jumptable 100225B5	default	case
; ---------------------------------------------------------------------------

loc_100225BE:				; CODE XREF: sub_10022490+125j
					; DATA XREF: .text:off_10022680o
		mov	edx, 1		; jumptable 100225B5 cases 0,3,4
		mov	ecx, [ebp+var_8]
		shl	edx, cl
		or	edx, dword_1003267C
		mov	dword_1003267C,	edx

loc_100225D4:				; CODE XREF: sub_10022490+125j
					; DATA XREF: .text:off_10022680o
		push	0		; jumptable 100225B5 case 1
		push	0		; lpFileSystemNameBuffer
		push	0		; lpFileSystemFlags
		push	0		; lpMaximumComponentLength
		lea	eax, [ebp+VolumeSerialNumber]
		push	eax		; lpVolumeSerialNumber
		push	0		; nVolumeNameSize
		push	0		; lpVolumeNameBuffer
		mov	ecx, [ebp+var_AC]
		lea	edx, [ebp+ecx+Buffer]
		push	edx		; lpRootPathName
		call	ds:GetVolumeInformationA
		test	eax, eax
		jz	short loc_10022622
		mov	eax, dword_10032678
		cmp	eax, [ebp+var_8]
		jnb	short loc_10022612
		mov	ecx, [ebp+var_8]
		mov	dword_10032678,	ecx

loc_10022612:				; CODE XREF: sub_10022490+177j
		mov	edx, [ebp+var_8]
		mov	eax, [ebp+VolumeSerialNumber]
		mov	dword_10032610[edx*4], eax

loc_10022622:				; CODE XREF: sub_10022490:loc_1002255Ej
					; sub_10022490:loc_100225BCj ...
		mov	ecx, [ebp+var_AC]
		lea	edx, [ebp+ecx+Buffer]
		push	edx		; lpString
		call	ds:lstrlenA
		mov	ecx, [ebp+var_AC]
		lea	edx, [ecx+eax+1]
		mov	[ebp+var_AC], edx
		jmp	loc_10022522
; ---------------------------------------------------------------------------

loc_1002264B:				; CODE XREF: sub_10022490+A2j
		cmp	[ebp+uMode], 0FFFFFFFFh
		jz	short loc_1002266B
		mov	eax, [ebp+uMode]
		push	eax		; uMode
		call	ds:SetErrorMode
		mov	[ebp+uMode], 0FFFFFFFFh

loc_1002266B:				; CODE XREF: sub_10022490+1C2j
		mov	eax, 1

loc_10022670:				; CODE XREF: sub_10022490+71j
		mov	ecx, [ebp+var_14]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10022490	endp

; ---------------------------------------------------------------------------
		align 10h
off_10022680	dd offset loc_100225BE	; DATA XREF: sub_10022490+125r
		dd offset loc_100225D4	; jump table for switch	statement
		dd offset loc_100225BC
		dd offset loc_100225BE
		dd offset loc_100225BE
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100226A0(HANDLE hFile)
sub_100226A0	proc near		; CODE XREF: sub_10021CD0+282p
					; sub_10021FF0+28Dp

var_50		= dword	ptr -50h
FileInformation	= _BY_HANDLE_FILE_INFORMATION ptr -4Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
VolumeSerialNumber= dword ptr -10h
uMode		= dword	ptr -0Ch
RootPathName	= byte ptr -8
var_4		= dword	ptr -4
hFile		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 50h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_18], eax
		mov	[ebp+var_50], 0
		mov	eax, ds:dword_1002B2F0
		mov	dword ptr [ebp+RootPathName], eax
		mov	[ebp+uMode], 0FFFFFFFFh
		mov	[ebp+var_14], 2
		lea	ecx, [ebp+FileInformation]
		push	ecx		; lpFileInformation
		mov	edx, [ebp+hFile]
		push	edx		; hFile
		call	ds:GetFileInformationByHandle
		test	eax, eax
		jnz	short loc_100226E7
		or	eax, 0FFFFFFFFh
		jmp	loc_10022826
; ---------------------------------------------------------------------------

loc_100226E7:				; CODE XREF: sub_100226A0+3Dj
		push	offset stru_10032A00 ; lpCriticalSection
		call	ds:EnterCriticalSection

loc_100226F2:				; CODE XREF: sub_100226A0:loc_1002272Cj
		mov	eax, [ebp+var_50]
		cmp	eax, dword_10032678
		ja	short loc_1002272E
		mov	ecx, [ebp+var_50]
		mov	edx, dword_10032610[ecx*4]
		mov	eax, [ebp+FileInformation.dwVolumeSerialNumber]
		mov	ecx, [ebp+var_50]
		add	ecx, 1
		mov	[ebp+var_50], ecx
		cmp	edx, eax
		jnz	short loc_1002272C
		push	offset stru_10032A00 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, 1
		jmp	loc_10022826
; ---------------------------------------------------------------------------

loc_1002272C:				; CODE XREF: sub_100226A0+75j
		jmp	short loc_100226F2
; ---------------------------------------------------------------------------

loc_1002272E:				; CODE XREF: sub_100226A0+5Bj
		push	offset stru_10032A00 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	edx, dword_1003267C
		mov	[ebp+var_4], edx
		mov	[ebp+var_50], 0

loc_10022749:				; CODE XREF: sub_100226A0+17Cj
		cmp	[ebp+var_4], 0
		jz	loc_10022821

loc_10022753:				; CODE XREF: sub_100226A0+CCj
		mov	eax, [ebp+var_4]
		and	eax, 1
		jnz	short loc_1002276E
		mov	ecx, [ebp+var_50]
		add	ecx, 1
		mov	[ebp+var_50], ecx
		mov	edx, [ebp+var_4]
		shr	edx, 1
		mov	[ebp+var_4], edx
		jmp	short loc_10022753
; ---------------------------------------------------------------------------

loc_1002276E:				; CODE XREF: sub_100226A0+B9j
		movsx	eax, byte ptr [ebp+var_50]
		add	eax, 41h
		mov	[ebp+RootPathName], al
		push	1		; uMode
		call	ds:SetErrorMode
		mov	[ebp+uMode], eax
		push	0		; nFileSystemNameSize
		push	0		; lpFileSystemNameBuffer
		push	0		; lpFileSystemFlags
		push	0		; lpMaximumComponentLength
		lea	ecx, [ebp+VolumeSerialNumber]
		push	ecx		; lpVolumeSerialNumber
		push	0		; nVolumeNameSize
		push	0		; lpVolumeNameBuffer
		lea	edx, [ebp+RootPathName]
		push	edx		; lpRootPathName
		call	ds:GetVolumeInformationA
		test	eax, eax
		jz	short loc_100227E7
		mov	eax, [ebp+VolumeSerialNumber]
		cmp	eax, [ebp+FileInformation.dwVolumeSerialNumber]
		jnz	short loc_100227E7
		push	offset stru_10032A00 ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, dword_10032678
		cmp	ecx, [ebp+var_50]
		jnb	short loc_100227C8
		mov	edx, [ebp+var_50]
		mov	dword_10032678,	edx

loc_100227C8:				; CODE XREF: sub_100226A0+11Dj
		mov	eax, [ebp+var_50]
		mov	ecx, [ebp+VolumeSerialNumber]
		mov	dword_10032610[eax*4], ecx
		push	offset stru_10032A00 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	[ebp+var_14], 1

loc_100227E7:				; CODE XREF: sub_100226A0+FFj
					; sub_100226A0+107j
		cmp	[ebp+uMode], 0FFFFFFFFh
		jz	short loc_100227FE
		mov	edx, [ebp+uMode]
		push	edx		; uMode
		call	ds:SetErrorMode
		mov	[ebp+uMode], 0FFFFFFFFh

loc_100227FE:				; CODE XREF: sub_100226A0+14Bj
		cmp	[ebp+var_14], 1
		jnz	short loc_1002280B
		mov	eax, 1
		jmp	short loc_10022826
; ---------------------------------------------------------------------------

loc_1002280B:				; CODE XREF: sub_100226A0+162j
		mov	eax, [ebp+var_50]
		add	eax, 1
		mov	[ebp+var_50], eax
		mov	ecx, [ebp+var_4]
		shr	ecx, 1
		mov	[ebp+var_4], ecx
		jmp	loc_10022749
; ---------------------------------------------------------------------------

loc_10022821:				; CODE XREF: sub_100226A0+ADj
		mov	eax, 2

loc_10022826:				; CODE XREF: sub_100226A0+42j
					; sub_100226A0+87j ...
		mov	ecx, [ebp+var_18]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100226A0	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry 249. PR_NT_CancelIo

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public PR_NT_CancelIo
PR_NT_CancelIo	proc near		; DATA XREF: .rdata:off_1002C7C8o

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	[ebp+var_C], eax
		push	0
		mov	eax, [ebp+arg_0]
		push	eax
		call	PR_GetIdentitiesLayer
		add	esp, 8
		mov	[ebp+var_4], eax
		mov	ecx, [ebp+var_C]
		cmp	dword ptr [ecx+0ACh], 0
		jz	short loc_10022885
		cmp	[ebp+var_4], 0
		jz	short loc_10022885
		mov	edx, [ebp+var_4]
		mov	eax, [edx+4]
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+0A8h]
		cmp	edx, [eax+28h]
		jz	short loc_1002289C

loc_10022885:				; CODE XREF: PR_NT_CancelIo+29j
					; PR_NT_CancelIo+2Fj
		push	0
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1002298E
; ---------------------------------------------------------------------------

loc_1002289C:				; CODE XREF: PR_NT_CancelIo+43j
		mov	eax, [ebp+var_C]
		cmp	dword ptr [eax+0A4h], 0
		jz	short loc_100228D8
		mov	ecx, [ebp+var_4]
		mov	edx, [ecx+4]
		mov	eax, [edx+28h]
		push	eax		; hFile
		call	ds:CancelIo
		test	eax, eax
		jnz	short loc_100228D8
		call	ds:GetLastError
		push	eax
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_1002298E
; ---------------------------------------------------------------------------

loc_100228D8:				; CODE XREF: PR_NT_CancelIo+66j
					; PR_NT_CancelIo+7Aj
		mov	ecx, [ebp+var_C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [ebp+var_C]
		mov	eax, [edx+0A4h]
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx+0ACh], 0
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx], 6
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+12Ch], 1
		mov	ecx, [ebp+var_C]
		add	ecx, 40h
		push	ecx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		cmp	[ebp+var_8], 0
		jz	short loc_10022935
		push	0FFFFFFFFh
		mov	edx, [ebp+var_C]
		push	edx
		call	sub_1001E800
		add	esp, 8

loc_10022935:				; CODE XREF: PR_NT_CancelIo+E5j
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx+12Ch], 0
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx+128h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0ACh], 0
		mov	ecx, [ebp+var_C]
		mov	dword ptr [ecx+0A4h], 0
		mov	edx, [ebp+var_C]
		mov	dword ptr [edx], 2
		mov	eax, [ebp+var_C]
		add	eax, 40h
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		xor	eax, eax

loc_1002298E:				; CODE XREF: PR_NT_CancelIo+57j
					; PR_NT_CancelIo+93j
		mov	esp, ebp
		pop	ebp
		retn
PR_NT_CancelIo	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100229A0(int,	struct sockaddr	*addr, int *addrlen, int)
sub_100229A0	proc near		; CODE XREF: sub_1001E300+6Ap

var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
s		= dword	ptr -120h
timeout		= dword	ptr -11Ch
readfds		= fd_set ptr -118h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
addr		= dword	ptr  0Ch
addrlen		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 128h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx
		mov	[ebp+readfds.fd_count],	0

loc_100229CC:				; CODE XREF: sub_100229A0+59j
		cmp	[ebp+readfds.fd_count],	40h
		jnb	short loc_100229F7
		mov	eax, [ebp+readfds.fd_count]
		mov	ecx, [ebp+s]
		mov	[ebp+eax*4+readfds.fd_array], ecx
		mov	edx, [ebp+readfds.fd_count]
		add	edx, 1
		mov	[ebp+readfds.fd_count],	edx

loc_100229F7:				; CODE XREF: sub_100229A0+33j
		xor	eax, eax
		jnz	short loc_100229CC
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	loc_10022A98

loc_10022A05:				; CODE XREF: sub_100229A0:loc_10022A8Ej
		mov	ecx, [ebp+addrlen]
		push	ecx		; addrlen
		mov	edx, [ebp+addr]
		push	edx		; addr
		mov	eax, [ebp+s]
		push	eax		; s
		call	accept
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_10022A93
		call	WSAGetLastError
		mov	[ebp+var_128], eax
		cmp	[ebp+var_128], 2733h
		jnz	short loc_10022A7D
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+4], 0
		jnz	short loc_10022A7D
		push	0		; timeout
		push	0		; exceptfds
		push	0		; writefds
		lea	eax, [ebp+readfds]
		push	eax		; readfds
		push	0		; nfds
		call	sub_10025860
		add	esp, 14h
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	short loc_10022A7B
		call	WSAGetLastError
		push	eax
		call	sub_10025510
		add	esp, 4
		jmp	short loc_10022A93
; ---------------------------------------------------------------------------

loc_10022A7B:				; CODE XREF: sub_100229A0+C9j
		jmp	short loc_10022A8E
; ---------------------------------------------------------------------------

loc_10022A7D:				; CODE XREF: sub_100229A0+97j
					; sub_100229A0+A3j
		mov	ecx, [ebp+var_128]
		push	ecx
		call	sub_10025420
		add	esp, 4
		jmp	short loc_10022A93
; ---------------------------------------------------------------------------

loc_10022A8E:				; CODE XREF: sub_100229A0:loc_10022A7Bj
		jmp	loc_10022A05
; ---------------------------------------------------------------------------

loc_10022A93:				; CODE XREF: sub_100229A0+80j
					; sub_100229A0+D9j ...
		jmp	loc_10022BEF
; ---------------------------------------------------------------------------

loc_10022A98:				; CODE XREF: sub_100229A0+5Fj
		cmp	[ebp+arg_C], 0
		jnz	short loc_10022B03
		mov	edx, [ebp+addrlen]
		push	edx		; addrlen
		mov	eax, [ebp+addr]
		push	eax		; addr
		mov	ecx, [ebp+s]
		push	ecx		; s
		call	accept
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_10022AFE
		call	WSAGetLastError
		mov	[ebp+var_128], eax
		cmp	[ebp+var_128], 2733h
		jnz	short loc_10022AEF
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+4], 0
		jnz	short loc_10022AEF
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8
		jmp	short loc_10022AFE
; ---------------------------------------------------------------------------

loc_10022AEF:				; CODE XREF: sub_100229A0+130j
					; sub_100229A0+13Cj
		mov	ecx, [ebp+var_128]
		push	ecx
		call	sub_10025420
		add	esp, 4

loc_10022AFE:				; CODE XREF: sub_100229A0+119j
					; sub_100229A0+14Dj
		jmp	loc_10022BEF
; ---------------------------------------------------------------------------

loc_10022B03:				; CODE XREF: sub_100229A0+FCj
					; sub_100229A0+20Fj
		mov	edx, [ebp+addrlen]
		push	edx		; addrlen
		mov	eax, [ebp+addr]
		push	eax		; addr
		mov	ecx, [ebp+s]
		push	ecx		; s
		call	accept
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	loc_10022BEF
		call	WSAGetLastError
		mov	[ebp+var_128], eax
		cmp	[ebp+var_128], 2733h
		jnz	loc_10022BE0
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+4], 0
		jnz	loc_10022BE0
		mov	ecx, [ebp+arg_C]
		push	ecx
		call	PR_IntervalToSeconds
		add	esp, 4
		mov	[ebp+var_8], eax
		mov	edx, [ebp+var_8]
		push	edx
		call	PR_SecondsToInterval
		add	esp, 4
		mov	ecx, [ebp+arg_C]
		sub	ecx, eax
		push	ecx
		call	PR_IntervalToMicroseconds
		add	esp, 4
		mov	[ebp+var_4], eax
		lea	edx, [ebp+var_8]
		mov	[ebp+timeout], edx
		mov	eax, [ebp+timeout]
		push	eax		; timeout
		push	0		; exceptfds
		push	0		; writefds
		lea	ecx, [ebp+readfds]
		push	ecx		; readfds
		push	0		; nfds
		call	sub_10025860
		add	esp, 14h
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0
		jle	short loc_10022BB6
		jmp	loc_10022B03
; ---------------------------------------------------------------------------
		jmp	short loc_10022BDE
; ---------------------------------------------------------------------------

loc_10022BB6:				; CODE XREF: sub_100229A0+20Dj
		cmp	[ebp+var_124], 0
		jnz	short loc_10022BD0
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8
		jmp	short loc_10022BDE
; ---------------------------------------------------------------------------

loc_10022BD0:				; CODE XREF: sub_100229A0+21Dj
		call	WSAGetLastError
		push	eax
		call	sub_10025510
		add	esp, 4

loc_10022BDE:				; CODE XREF: sub_100229A0+214j
					; sub_100229A0+22Ej
		jmp	short loc_10022BEF
; ---------------------------------------------------------------------------

loc_10022BE0:				; CODE XREF: sub_100229A0+199j
					; sub_100229A0+1A9j
		mov	edx, [ebp+var_128]
		push	edx
		call	sub_10025420
		add	esp, 4

loc_10022BEF:				; CODE XREF: sub_100229A0:loc_10022A93j
					; sub_100229A0:loc_10022AFEj ...
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_10]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100229A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10022C00(int,	struct sockaddr	*name, int namelen, int)
sub_10022C00	proc near		; CODE XREF: sub_1001E190+A5p

optval		= byte ptr -234h
var_230		= dword	ptr -230h
s		= dword	ptr -22Ch
timeout		= dword	ptr -228h
optlen		= dword	ptr -224h
exceptfds	= fd_set ptr -220h
writefds	= fd_set ptr -118h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
name		= dword	ptr  0Ch
namelen		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 234h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx
		mov	eax, [ebp+namelen]
		push	eax		; namelen
		mov	ecx, [ebp+name]
		push	ecx		; name
		mov	edx, [ebp+s]
		push	edx		; s
		call	connect
		mov	[ebp+var_230], eax
		cmp	[ebp+var_230], 0FFFFFFFFh
		jnz	loc_10022E1A
		call	WSAGetLastError
		mov	dword ptr [ebp+optval],	eax
		cmp	dword ptr [ebp+optval],	2733h
		jnz	loc_10022E0B
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_10022C76
		mov	[ebp+timeout], 0
		jmp	short loc_10022CAB
; ---------------------------------------------------------------------------

loc_10022C76:				; CODE XREF: sub_10022C00+68j
		mov	eax, [ebp+arg_C]
		push	eax
		call	PR_IntervalToSeconds
		add	esp, 4
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+var_8]
		push	ecx
		call	PR_SecondsToInterval
		add	esp, 4
		mov	edx, [ebp+arg_C]
		sub	edx, eax
		push	edx
		call	PR_IntervalToMicroseconds
		add	esp, 4
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_8]
		mov	[ebp+timeout], eax

loc_10022CAB:				; CODE XREF: sub_10022C00+74j
		mov	[ebp+writefds.fd_count], 0
		mov	[ebp+exceptfds.fd_count], 0

loc_10022CBF:				; CODE XREF: sub_10022C00+ECj
		cmp	[ebp+writefds.fd_count], 40h
		jnb	short loc_10022CEA
		mov	ecx, [ebp+writefds.fd_count]
		mov	edx, [ebp+s]
		mov	[ebp+ecx*4+writefds.fd_array], edx
		mov	eax, [ebp+writefds.fd_count]
		add	eax, 1
		mov	[ebp+writefds.fd_count], eax

loc_10022CEA:				; CODE XREF: sub_10022C00+C6j
		xor	ecx, ecx
		jnz	short loc_10022CBF

loc_10022CEE:				; CODE XREF: sub_10022C00+11Bj
		cmp	[ebp+exceptfds.fd_count], 40h
		jnb	short loc_10022D19
		mov	edx, [ebp+exceptfds.fd_count]
		mov	eax, [ebp+s]
		mov	[ebp+edx*4+exceptfds.fd_array],	eax
		mov	ecx, [ebp+exceptfds.fd_count]
		add	ecx, 1
		mov	[ebp+exceptfds.fd_count], ecx

loc_10022D19:				; CODE XREF: sub_10022C00+F5j
		xor	edx, edx
		jnz	short loc_10022CEE
		mov	eax, [ebp+timeout]
		push	eax		; timeout
		lea	ecx, [ebp+exceptfds]
		push	ecx		; exceptfds
		lea	edx, [ebp+writefds]
		push	edx		; writefds
		push	0		; readfds
		push	0		; nfds
		call	sub_10025860
		add	esp, 14h
		mov	[ebp+var_230], eax
		cmp	[ebp+var_230], 0FFFFFFFFh
		jnz	short loc_10022D66
		call	WSAGetLastError
		push	eax
		call	sub_10025510
		add	esp, 4
		mov	eax, [ebp+var_230]
		jmp	loc_10022E20
; ---------------------------------------------------------------------------

loc_10022D66:				; CODE XREF: sub_10022C00+14Bj
		cmp	[ebp+var_230], 0
		jnz	short loc_10022D86
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_10022E20
; ---------------------------------------------------------------------------

loc_10022D86:				; CODE XREF: sub_10022C00+16Dj
		push	0		; dwMilliseconds
		call	ds:Sleep
		lea	eax, [ebp+exceptfds]
		push	eax		; fd_set *
		mov	ecx, [ebp+s]
		push	ecx		; fd
		call	__WSAFDIsSet
		test	eax, eax
		jz	short loc_10022DFF
		mov	[ebp+optlen], 4
		lea	edx, [ebp+optlen]
		push	edx		; optlen
		lea	eax, [ebp+optval]
		push	eax		; optval
		push	1007h		; optname
		push	0FFFFh		; level
		mov	ecx, [ebp+s]
		push	ecx		; s
		call	getsockopt
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10022DEB
		call	WSAGetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10022E20
; ---------------------------------------------------------------------------

loc_10022DEB:				; CODE XREF: sub_10022C00+1D6j
		mov	edx, dword ptr [ebp+optval]
		push	edx
		call	sub_10025460
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10022E20
; ---------------------------------------------------------------------------

loc_10022DFF:				; CODE XREF: sub_10022C00+1A3j
		mov	[ebp+var_230], 0
		jmp	short loc_10022E1A
; ---------------------------------------------------------------------------

loc_10022E0B:				; CODE XREF: sub_10022C00+5Ej
		mov	eax, dword ptr [ebp+optval]
		push	eax
		call	sub_10025460
		add	esp, 4

loc_10022E1A:				; CODE XREF: sub_10022C00+43j
					; sub_10022C00+209j
		mov	eax, [ebp+var_230]

loc_10022E20:				; CODE XREF: sub_10022C00+161j
					; sub_10022C00+181j ...
		mov	ecx, [ebp+var_C]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10022C00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10022E30(int,	char *buf, int len, int, int)
sub_10022E30	proc near		; CODE XREF: sub_1001F6C0+6Ep

var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
s		= dword	ptr -120h
timeout		= dword	ptr -11Ch
readfds		= fd_set ptr -118h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
flags		= dword	ptr -4
arg_0		= dword	ptr  8
buf		= dword	ptr  0Ch
len		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 128h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx
		cmp	[ebp+arg_C], 0
		jnz	short loc_10022E61
		mov	[ebp+flags], 0
		jmp	short loc_10022E68
; ---------------------------------------------------------------------------

loc_10022E61:				; CODE XREF: sub_10022E30+26j
		mov	[ebp+flags], 2

loc_10022E68:				; CODE XREF: sub_10022E30+2Fj
					; sub_10022E30:loc_10022FB2j
		mov	eax, [ebp+flags]
		push	eax		; flags
		mov	ecx, [ebp+len]
		push	ecx		; len
		mov	edx, [ebp+buf]
		push	edx		; buf
		mov	eax, [ebp+s]
		push	eax		; s
		call	recv
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	loc_10022FB7
		call	WSAGetLastError
		mov	[ebp+var_128], eax
		cmp	[ebp+var_128], 2733h
		jnz	loc_10022FA1
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+4], 0
		jnz	loc_10022FA1
		mov	[ebp+readfds.fd_count],	0

loc_10022EC8:				; CODE XREF: sub_10022E30+C5j
		cmp	[ebp+readfds.fd_count],	40h
		jnb	short loc_10022EF3
		mov	eax, [ebp+readfds.fd_count]
		mov	ecx, [ebp+s]
		mov	[ebp+eax*4+readfds.fd_array], ecx
		mov	edx, [ebp+readfds.fd_count]
		add	edx, 1
		mov	[ebp+readfds.fd_count],	edx

loc_10022EF3:				; CODE XREF: sub_10022E30+9Fj
		xor	eax, eax
		jnz	short loc_10022EC8
		cmp	[ebp+arg_10], 0FFFFFFFFh
		jnz	short loc_10022F09
		mov	[ebp+timeout], 0
		jmp	short loc_10022F3E
; ---------------------------------------------------------------------------

loc_10022F09:				; CODE XREF: sub_10022E30+CBj
		mov	ecx, [ebp+arg_10]
		push	ecx
		call	PR_IntervalToSeconds
		add	esp, 4
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		push	edx
		call	PR_SecondsToInterval
		add	esp, 4
		mov	ecx, [ebp+arg_10]
		sub	ecx, eax
		push	ecx
		call	PR_IntervalToMicroseconds
		add	esp, 4
		mov	[ebp+var_8], eax
		lea	edx, [ebp+var_C]
		mov	[ebp+timeout], edx

loc_10022F3E:				; CODE XREF: sub_10022E30+D7j
		mov	eax, [ebp+timeout]
		push	eax		; timeout
		push	0		; exceptfds
		push	0		; writefds
		lea	ecx, [ebp+readfds]
		push	ecx		; readfds
		push	0		; nfds
		call	sub_10025860
		add	esp, 14h
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	short loc_10022F7B
		call	WSAGetLastError
		push	eax
		call	sub_10025510
		add	esp, 4
		jmp	short loc_10022FB7
; ---------------------------------------------------------------------------
		jmp	short loc_10022F9F
; ---------------------------------------------------------------------------

loc_10022F7B:				; CODE XREF: sub_10022E30+137j
		cmp	[ebp+var_124], 0
		jnz	short loc_10022F9F
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8
		mov	[ebp+var_124], 0FFFFFFFFh
		jmp	short loc_10022FB7
; ---------------------------------------------------------------------------

loc_10022F9F:				; CODE XREF: sub_10022E30+149j
					; sub_10022E30+152j
		jmp	short loc_10022FB2
; ---------------------------------------------------------------------------

loc_10022FA1:				; CODE XREF: sub_10022E30+78j
					; sub_10022E30+88j
		mov	edx, [ebp+var_128]
		push	edx
		call	sub_100253E0
		add	esp, 4
		jmp	short loc_10022FB7
; ---------------------------------------------------------------------------

loc_10022FB2:				; CODE XREF: sub_10022E30:loc_10022F9Fj
		jmp	loc_10022E68
; ---------------------------------------------------------------------------

loc_10022FB7:				; CODE XREF: sub_10022E30+5Dj
					; sub_10022E30+147j ...
		mov	eax, [ebp+var_124]
		mov	ecx, [ebp+var_10]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10022E30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10022FD0(int,	char *buf, int len, int)
sub_10022FD0	proc near		; CODE XREF: sub_1001FA30+6Ap
					; sub_10023280+48p

var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
s		= dword	ptr -120h
timeout		= dword	ptr -11Ch
writefds	= fd_set ptr -118h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
buf		= dword	ptr  0Ch
len		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 128h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx
		mov	[ebp+var_C], 0

loc_10022FF9:				; CODE XREF: sub_10022FD0:loc_1002325Cj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+len]
		jge	loc_10023261

loc_10023005:				; CODE XREF: sub_10022FD0:loc_10023153j
		push	0		; flags
		mov	ecx, [ebp+len]
		push	ecx		; len
		mov	edx, [ebp+buf]
		push	edx		; buf
		mov	eax, [ebp+s]
		push	eax		; s
		call	send
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	loc_10023158
		call	WSAGetLastError
		mov	[ebp+var_128], eax
		cmp	[ebp+var_128], 2733h
		jnz	loc_1002313C
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+4]
		cmp	dword ptr [edx+4], 0
		jnz	loc_1002313C
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_1002306B
		mov	[ebp+timeout], 0
		jmp	short loc_100230A0
; ---------------------------------------------------------------------------

loc_1002306B:				; CODE XREF: sub_10022FD0+8Dj
		mov	eax, [ebp+arg_C]
		push	eax
		call	PR_IntervalToSeconds
		add	esp, 4
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+var_8]
		push	ecx
		call	PR_SecondsToInterval
		add	esp, 4
		mov	edx, [ebp+arg_C]
		sub	edx, eax
		push	edx
		call	PR_IntervalToMicroseconds
		add	esp, 4
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_8]
		mov	[ebp+timeout], eax

loc_100230A0:				; CODE XREF: sub_10022FD0+99j
		mov	[ebp+writefds.fd_count], 0

loc_100230AA:				; CODE XREF: sub_10022FD0+107j
		cmp	[ebp+writefds.fd_count], 40h
		jnb	short loc_100230D5
		mov	ecx, [ebp+writefds.fd_count]
		mov	edx, [ebp+s]
		mov	[ebp+ecx*4+writefds.fd_array], edx
		mov	eax, [ebp+writefds.fd_count]
		add	eax, 1
		mov	[ebp+writefds.fd_count], eax

loc_100230D5:				; CODE XREF: sub_10022FD0+E1j
		xor	ecx, ecx
		jnz	short loc_100230AA
		mov	edx, [ebp+timeout]
		push	edx		; timeout
		push	0		; exceptfds
		lea	eax, [ebp+writefds]
		push	eax		; writefds
		push	0		; readfds
		push	0		; nfds
		call	sub_10025860
		add	esp, 14h
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	short loc_1002311A
		call	WSAGetLastError
		push	eax
		call	sub_10025510
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10023264
; ---------------------------------------------------------------------------

loc_1002311A:				; CODE XREF: sub_10022FD0+132j
		cmp	[ebp+var_124], 0
		jnz	short loc_1002313A
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_10023264
; ---------------------------------------------------------------------------

loc_1002313A:				; CODE XREF: sub_10022FD0+151j
		jmp	short loc_10023153
; ---------------------------------------------------------------------------

loc_1002313C:				; CODE XREF: sub_10022FD0+73j
					; sub_10022FD0+83j
		mov	ecx, [ebp+var_128]
		push	ecx
		call	sub_100253F0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_10023264
; ---------------------------------------------------------------------------

loc_10023153:				; CODE XREF: sub_10022FD0:loc_1002313Aj
		jmp	loc_10023005
; ---------------------------------------------------------------------------

loc_10023158:				; CODE XREF: sub_10022FD0+58j
		mov	edx, [ebp+var_C]
		add	edx, [ebp+var_124]
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+4], 0
		jz	short loc_10023175
		jmp	loc_10023261
; ---------------------------------------------------------------------------

loc_10023175:				; CODE XREF: sub_10022FD0+19Ej
		mov	edx, [ebp+var_C]
		cmp	edx, [ebp+len]
		jge	loc_1002325C
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_10023193
		mov	[ebp+timeout], 0
		jmp	short loc_100231C8
; ---------------------------------------------------------------------------

loc_10023193:				; CODE XREF: sub_10022FD0+1B5j
		mov	eax, [ebp+arg_C]
		push	eax
		call	PR_IntervalToSeconds
		add	esp, 4
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+var_8]
		push	ecx
		call	PR_SecondsToInterval
		add	esp, 4
		mov	edx, [ebp+arg_C]
		sub	edx, eax
		push	edx
		call	PR_IntervalToMicroseconds
		add	esp, 4
		mov	[ebp+var_4], eax
		lea	eax, [ebp+var_8]
		mov	[ebp+timeout], eax

loc_100231C8:				; CODE XREF: sub_10022FD0+1C1j
		mov	[ebp+writefds.fd_count], 0

loc_100231D2:				; CODE XREF: sub_10022FD0+22Fj
		cmp	[ebp+writefds.fd_count], 40h
		jnb	short loc_100231FD
		mov	ecx, [ebp+writefds.fd_count]
		mov	edx, [ebp+s]
		mov	[ebp+ecx*4+writefds.fd_array], edx
		mov	eax, [ebp+writefds.fd_count]
		add	eax, 1
		mov	[ebp+writefds.fd_count], eax

loc_100231FD:				; CODE XREF: sub_10022FD0+209j
		xor	ecx, ecx
		jnz	short loc_100231D2
		mov	edx, [ebp+timeout]
		push	edx		; timeout
		push	0		; exceptfds
		lea	eax, [ebp+writefds]
		push	eax		; writefds
		push	0		; readfds
		push	0		; nfds
		call	sub_10025860
		add	esp, 14h
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	short loc_1002323F
		call	WSAGetLastError
		push	eax
		call	sub_10025510
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_10023264
; ---------------------------------------------------------------------------

loc_1002323F:				; CODE XREF: sub_10022FD0+25Aj
		cmp	[ebp+var_124], 0
		jnz	short loc_1002325C
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	short loc_10023264
; ---------------------------------------------------------------------------

loc_1002325C:				; CODE XREF: sub_10022FD0+1ABj
					; sub_10022FD0+276j
		jmp	loc_10022FF9
; ---------------------------------------------------------------------------

loc_10023261:				; CODE XREF: sub_10022FD0+2Fj
					; sub_10022FD0+1A0j
		mov	eax, [ebp+var_C]

loc_10023264:				; CODE XREF: sub_10022FD0+145j
					; sub_10022FD0+165j ...
		mov	ecx, [ebp+var_10]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10022FD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023280	proc near		; CODE XREF: sub_1001FEB0+69p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[ebp+var_4], 0
		mov	[ebp+var_8], 0
		jmp	short loc_1002329F
; ---------------------------------------------------------------------------

loc_10023296:				; CODE XREF: sub_10023280:loc_10023326j
		mov	eax, [ebp+var_8]
		add	eax, 1
		mov	[ebp+var_8], eax

loc_1002329F:				; CODE XREF: sub_10023280+14j
		mov	ecx, [ebp+var_8]
		cmp	ecx, [ebp+arg_8]
		jge	loc_1002332B
		mov	edx, [ebp+arg_C]
		push	edx		; int
		mov	eax, [ebp+var_8]
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx+eax*8+4]
		push	edx		; len
		mov	eax, [ebp+var_8]
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx+eax*8]
		push	edx		; buf
		mov	eax, [ebp+arg_0]
		push	eax		; int
		call	sub_10022FD0
		add	esp, 10h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jle	short loc_100232E2
		mov	ecx, [ebp+var_4]
		add	ecx, [ebp+var_C]
		mov	[ebp+var_4], ecx

loc_100232E2:				; CODE XREF: sub_10023280+57j
		mov	edx, [ebp+var_8]
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+var_C]
		cmp	ecx, [eax+edx*8+4]
		jz	short loc_10023326
		cmp	[ebp+var_C], 0
		jge	short loc_10023321
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+4], 0
		jz	short loc_1002331C
		call	PR_GetError
		cmp	eax, 0FFFFE892h
		jnz	short loc_1002331C
		cmp	[ebp+var_4], 0
		jle	short loc_1002331C
		mov	eax, [ebp+var_4]
		jmp	short loc_1002332E
; ---------------------------------------------------------------------------
		jmp	short loc_10023321
; ---------------------------------------------------------------------------

loc_1002331C:				; CODE XREF: sub_10023280+81j
					; sub_10023280+8Dj ...
		or	eax, 0FFFFFFFFh
		jmp	short loc_1002332E
; ---------------------------------------------------------------------------

loc_10023321:				; CODE XREF: sub_10023280+75j
					; sub_10023280+9Aj
		mov	eax, [ebp+var_4]
		jmp	short loc_1002332E
; ---------------------------------------------------------------------------

loc_10023326:				; CODE XREF: sub_10023280+6Fj
		jmp	loc_10023296
; ---------------------------------------------------------------------------

loc_1002332B:				; CODE XREF: sub_10023280+25j
		mov	eax, [ebp+var_4]

loc_1002332E:				; CODE XREF: sub_10023280+98j
					; sub_10023280+9Fj ...
		mov	esp, ebp
		pop	ebp
		retn
sub_10023280	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10023340(int,	char *buf, int len, struct sockaddr *to, int tolen, int)
sub_10023340	proc near		; CODE XREF: sub_1001FD70+6Ap

var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
s		= dword	ptr -120h
timeout		= dword	ptr -11Ch
writefds	= fd_set ptr -118h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
buf		= dword	ptr  0Ch
len		= dword	ptr  10h
to		= dword	ptr  14h
tolen		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 128h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx
		mov	[ebp+var_C], 0

loc_10023369:				; CODE XREF: sub_10023340:loc_100235D4j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+len]
		jge	loc_100235D9

loc_10023375:				; CODE XREF: sub_10023340:loc_100234CBj
		mov	ecx, [ebp+tolen]
		push	ecx		; tolen
		mov	edx, [ebp+to]
		push	edx		; to
		push	0		; flags
		mov	eax, [ebp+len]
		push	eax		; len
		mov	ecx, [ebp+buf]
		push	ecx		; buf
		mov	edx, [ebp+s]
		push	edx		; s
		call	sendto
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	loc_100234D0
		call	WSAGetLastError
		mov	[ebp+var_128], eax
		cmp	[ebp+var_128], 2733h
		jnz	loc_100234B4
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+4], 0
		jnz	loc_100234B4
		cmp	[ebp+arg_14], 0FFFFFFFFh
		jnz	short loc_100233E3
		mov	[ebp+timeout], 0
		jmp	short loc_10023418
; ---------------------------------------------------------------------------

loc_100233E3:				; CODE XREF: sub_10023340+95j
		mov	edx, [ebp+arg_14]
		push	edx
		call	PR_IntervalToSeconds
		add	esp, 4
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		push	eax
		call	PR_SecondsToInterval
		add	esp, 4
		mov	ecx, [ebp+arg_14]
		sub	ecx, eax
		push	ecx
		call	PR_IntervalToMicroseconds
		add	esp, 4
		mov	[ebp+var_4], eax
		lea	edx, [ebp+var_8]
		mov	[ebp+timeout], edx

loc_10023418:				; CODE XREF: sub_10023340+A1j
		mov	[ebp+writefds.fd_count], 0

loc_10023422:				; CODE XREF: sub_10023340+10Fj
		cmp	[ebp+writefds.fd_count], 40h
		jnb	short loc_1002344D
		mov	eax, [ebp+writefds.fd_count]
		mov	ecx, [ebp+s]
		mov	[ebp+eax*4+writefds.fd_array], ecx
		mov	edx, [ebp+writefds.fd_count]
		add	edx, 1
		mov	[ebp+writefds.fd_count], edx

loc_1002344D:				; CODE XREF: sub_10023340+E9j
		xor	eax, eax
		jnz	short loc_10023422
		mov	ecx, [ebp+timeout]
		push	ecx		; timeout
		push	0		; exceptfds
		lea	edx, [ebp+writefds]
		push	edx		; writefds
		push	0		; readfds
		push	0		; nfds
		call	sub_10025860
		add	esp, 14h
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	short loc_10023492
		call	WSAGetLastError
		push	eax
		call	sub_10025510
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_100235DC
; ---------------------------------------------------------------------------

loc_10023492:				; CODE XREF: sub_10023340+13Aj
		cmp	[ebp+var_124], 0
		jnz	short loc_100234B2
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	loc_100235DC
; ---------------------------------------------------------------------------

loc_100234B2:				; CODE XREF: sub_10023340+159j
		jmp	short loc_100234CB
; ---------------------------------------------------------------------------

loc_100234B4:				; CODE XREF: sub_10023340+7Bj
					; sub_10023340+8Bj
		mov	eax, [ebp+var_128]
		push	eax
		call	sub_100253F0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	loc_100235DC
; ---------------------------------------------------------------------------

loc_100234CB:				; CODE XREF: sub_10023340:loc_100234B2j
		jmp	loc_10023375
; ---------------------------------------------------------------------------

loc_100234D0:				; CODE XREF: sub_10023340+60j
		mov	ecx, [ebp+var_C]
		add	ecx, [ebp+var_124]
		mov	[ebp+var_C], ecx
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+4], 0
		jz	short loc_100234ED
		jmp	loc_100235D9
; ---------------------------------------------------------------------------

loc_100234ED:				; CODE XREF: sub_10023340+1A6j
		mov	ecx, [ebp+var_C]
		cmp	ecx, [ebp+len]
		jge	loc_100235D4
		cmp	[ebp+arg_14], 0FFFFFFFFh
		jnz	short loc_1002350B
		mov	[ebp+timeout], 0
		jmp	short loc_10023540
; ---------------------------------------------------------------------------

loc_1002350B:				; CODE XREF: sub_10023340+1BDj
		mov	edx, [ebp+arg_14]
		push	edx
		call	PR_IntervalToSeconds
		add	esp, 4
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		push	eax
		call	PR_SecondsToInterval
		add	esp, 4
		mov	ecx, [ebp+arg_14]
		sub	ecx, eax
		push	ecx
		call	PR_IntervalToMicroseconds
		add	esp, 4
		mov	[ebp+var_4], eax
		lea	edx, [ebp+var_8]
		mov	[ebp+timeout], edx

loc_10023540:				; CODE XREF: sub_10023340+1C9j
		mov	[ebp+writefds.fd_count], 0

loc_1002354A:				; CODE XREF: sub_10023340+237j
		cmp	[ebp+writefds.fd_count], 40h
		jnb	short loc_10023575
		mov	eax, [ebp+writefds.fd_count]
		mov	ecx, [ebp+s]
		mov	[ebp+eax*4+writefds.fd_array], ecx
		mov	edx, [ebp+writefds.fd_count]
		add	edx, 1
		mov	[ebp+writefds.fd_count], edx

loc_10023575:				; CODE XREF: sub_10023340+211j
		xor	eax, eax
		jnz	short loc_1002354A
		mov	ecx, [ebp+timeout]
		push	ecx		; timeout
		push	0		; exceptfds
		lea	edx, [ebp+writefds]
		push	edx		; writefds
		push	0		; readfds
		push	0		; nfds
		call	sub_10025860
		add	esp, 14h
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	short loc_100235B7
		call	WSAGetLastError
		push	eax
		call	sub_10025510
		add	esp, 4
		or	eax, 0FFFFFFFFh
		jmp	short loc_100235DC
; ---------------------------------------------------------------------------

loc_100235B7:				; CODE XREF: sub_10023340+262j
		cmp	[ebp+var_124], 0
		jnz	short loc_100235D4
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		jmp	short loc_100235DC
; ---------------------------------------------------------------------------

loc_100235D4:				; CODE XREF: sub_10023340+1B3j
					; sub_10023340+27Ej
		jmp	loc_10023369
; ---------------------------------------------------------------------------

loc_100235D9:				; CODE XREF: sub_10023340+2Fj
					; sub_10023340+1A8j
		mov	eax, [ebp+var_C]

loc_100235DC:				; CODE XREF: sub_10023340+14Dj
					; sub_10023340+16Dj ...
		mov	ecx, [ebp+var_10]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10023340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100235F0(int,	char *buf, int len, struct sockaddr *from, int *fromlen, int)
sub_100235F0	proc near		; CODE XREF: sub_1001FE10+6Ap

var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
s		= dword	ptr -120h
timeout		= dword	ptr -11Ch
readfds		= fd_set ptr -118h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
buf		= dword	ptr  0Ch
len		= dword	ptr  10h
from		= dword	ptr  14h
fromlen		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 128h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ecx+28h]
		mov	[ebp+s], edx

loc_10023612:				; CODE XREF: sub_100235F0:loc_10023762j
		mov	eax, [ebp+fromlen]
		push	eax		; fromlen
		mov	ecx, [ebp+from]
		push	ecx		; from
		push	0		; flags
		mov	edx, [ebp+len]
		push	edx		; len
		mov	eax, [ebp+buf]
		push	eax		; buf
		mov	ecx, [ebp+s]
		push	ecx		; s
		call	recvfrom
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	loc_10023767
		call	WSAGetLastError
		mov	[ebp+var_128], eax
		cmp	[ebp+var_128], 2733h
		jnz	loc_10023751
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		cmp	dword ptr [eax+4], 0
		jnz	loc_10023751
		cmp	[ebp+arg_14], 0FFFFFFFFh
		jnz	short loc_10023680
		mov	[ebp+timeout], 0
		jmp	short loc_100236B5
; ---------------------------------------------------------------------------

loc_10023680:				; CODE XREF: sub_100235F0+82j
		mov	ecx, [ebp+arg_14]
		push	ecx
		call	PR_IntervalToSeconds
		add	esp, 4
		mov	[ebp+var_8], eax
		mov	edx, [ebp+var_8]
		push	edx
		call	PR_SecondsToInterval
		add	esp, 4
		mov	ecx, [ebp+arg_14]
		sub	ecx, eax
		push	ecx
		call	PR_IntervalToMicroseconds
		add	esp, 4
		mov	[ebp+var_4], eax
		lea	edx, [ebp+var_8]
		mov	[ebp+timeout], edx

loc_100236B5:				; CODE XREF: sub_100235F0+8Ej
		mov	[ebp+readfds.fd_count],	0

loc_100236BF:				; CODE XREF: sub_100235F0+FCj
		cmp	[ebp+readfds.fd_count],	40h
		jnb	short loc_100236EA
		mov	eax, [ebp+readfds.fd_count]
		mov	ecx, [ebp+s]
		mov	[ebp+eax*4+readfds.fd_array], ecx
		mov	edx, [ebp+readfds.fd_count]
		add	edx, 1
		mov	[ebp+readfds.fd_count],	edx

loc_100236EA:				; CODE XREF: sub_100235F0+D6j
		xor	eax, eax
		jnz	short loc_100236BF
		mov	ecx, [ebp+timeout]
		push	ecx		; timeout
		push	0		; exceptfds
		push	0		; writefds
		lea	edx, [ebp+readfds]
		push	edx		; readfds
		push	0		; nfds
		call	sub_10025860
		add	esp, 14h
		mov	[ebp+var_124], eax
		cmp	[ebp+var_124], 0FFFFFFFFh
		jnz	short loc_1002372B
		call	WSAGetLastError
		push	eax
		call	sub_10025510
		add	esp, 4
		jmp	short loc_10023767
; ---------------------------------------------------------------------------
		jmp	short loc_1002374F
; ---------------------------------------------------------------------------

loc_1002372B:				; CODE XREF: sub_100235F0+127j
		cmp	[ebp+var_124], 0
		jnz	short loc_1002374F
		push	0
		push	0FFFFE89Ah
		call	PR_SetError
		add	esp, 8
		mov	[ebp+var_124], 0FFFFFFFFh
		jmp	short loc_10023767
; ---------------------------------------------------------------------------

loc_1002374F:				; CODE XREF: sub_100235F0+139j
					; sub_100235F0+142j
		jmp	short loc_10023762
; ---------------------------------------------------------------------------

loc_10023751:				; CODE XREF: sub_100235F0+68j
					; sub_100235F0+78j
		mov	eax, [ebp+var_128]
		push	eax
		call	sub_100253E0
		add	esp, 4
		jmp	short loc_10023767
; ---------------------------------------------------------------------------

loc_10023762:				; CODE XREF: sub_100235F0:loc_1002374Fj
		jmp	loc_10023612
; ---------------------------------------------------------------------------

loc_10023767:				; CODE XREF: sub_100235F0+4Dj
					; sub_100235F0+137j ...
		mov	eax, [ebp+var_124]
		mov	ecx, [ebp+var_C]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100235F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023780	proc near		; DATA XREF: sub_1001DFF0+E7o

var_35C		= word ptr -35Ch
var_358		= dword	ptr -358h
var_354		= dword	ptr -354h
var_350		= dword	ptr -350h
var_34C		= dword	ptr -34Ch
var_348		= dword	ptr -348h
var_344		= dword	ptr -344h
writefds	= fd_set ptr -340h
var_234		= dword	ptr -234h
readfds		= fd_set ptr -230h
var_124		= dword	ptr -124h
exceptfds	= fd_set ptr -120h
var_18		= dword	ptr -18h
timeout		= timeval ptr -14h
Memory		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 35Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_18], eax
		mov	[ebp+Memory], 0
		mov	[ebp+var_4], 0
		push	64h
		call	PR_MillisecondsToInterval
		add	esp, 4
		mov	[ebp+var_8], eax

loc_100237AE:				; CODE XREF: sub_10023780+2D5j
					; sub_10023780+2E3j ...
		mov	eax, 1
		test	eax, eax
		jz	loc_10023CFF
		call	PR_IntervalNow
		mov	[ebp+var_348], eax
		mov	[ebp+var_354], 0FFFFFFFFh
		mov	ecx, dword_100315C0
		push	ecx
		call	PR_Lock
		add	esp, 4

loc_100237DF:				; CODE XREF: sub_10023780:loc_10023816j
		cmp	dword_100315D4,	0
		jnz	short loc_10023818
		push	0FFFFFFFFh
		mov	edx, dword_100315C8
		push	edx
		call	PR_WaitCondVar
		add	esp, 8
		mov	[ebp+var_350], eax
		cmp	[ebp+var_350], 0FFFFFFFFh
		jnz	short loc_10023816
		call	PR_GetError
		cmp	eax, 0FFFFE897h
		jnz	short loc_10023816
		jmp	short loc_10023818
; ---------------------------------------------------------------------------

loc_10023816:				; CODE XREF: sub_10023780+86j
					; sub_10023780+92j
		jmp	short loc_100237DF
; ---------------------------------------------------------------------------

loc_10023818:				; CODE XREF: sub_10023780+66j
					; sub_10023780+94j
		mov	eax, dword_100315D0
		mov	[ebp+var_124], eax
		mov	ecx, dword_100315C0
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	[ebp+var_350], 0FFFFFFFFh
		jnz	short loc_1002384C
		call	PR_GetError
		cmp	eax, 0FFFFE897h
		jnz	short loc_1002384C
		jmp	loc_10023CFF
; ---------------------------------------------------------------------------

loc_1002384C:				; CODE XREF: sub_10023780+B9j
					; sub_10023780+C5j
		mov	[ebp+readfds.fd_count],	0
		mov	[ebp+writefds.fd_count], 0
		mov	[ebp+exceptfds.fd_count], 0
		mov	edx, [ebp+var_124]
		add	edx, 0Ah
		mov	[ebp+var_124], edx
		mov	eax, [ebp+var_124]
		cmp	eax, [ebp+var_4]
		jle	short loc_100238BB
		cmp	[ebp+Memory], 0
		jz	short loc_1002389D
		mov	ecx, [ebp+Memory]
		push	ecx		; Memory
		call	PR_Free
		add	esp, 4
		mov	[ebp+Memory], 0

loc_1002389D:				; CODE XREF: sub_10023780+108j
		mov	edx, [ebp+var_124]
		shl	edx, 3
		push	edx		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[ebp+Memory], eax
		mov	eax, [ebp+var_124]
		mov	[ebp+var_4], eax

loc_100238BB:				; CODE XREF: sub_10023780+102j
		mov	[ebp+var_234], 0
		mov	ecx, dword_100315C0
		push	ecx
		call	PR_Lock
		add	esp, 4
		mov	edx, dword_100315D4
		mov	[ebp+var_358], edx

loc_100238E0:				; CODE XREF: sub_10023780:loc_10023A39j
		cmp	[ebp+var_358], 0
		jz	loc_10023A3E
		mov	eax, [ebp+var_358]
		cmp	dword ptr [eax+30h], 2
		jnz	short loc_1002392D
		mov	ecx, [ebp+var_358]
		mov	dword ptr [ecx+28h], 0FFFFFFFFh
		mov	edx, [ebp+var_358]
		mov	dword ptr [edx+2Ch], 2714h
		mov	eax, [ebp+var_358]
		push	eax
		call	sub_10023D30
		add	esp, 4
		mov	[ebp+var_358], eax
		jmp	loc_10023A39
; ---------------------------------------------------------------------------

loc_1002392D:				; CODE XREF: sub_10023780+177j
		mov	ecx, [ebp+var_358]
		mov	dword ptr [ecx+30h], 1
		mov	edx, [ebp+var_358]
		mov	eax, [edx+24h]
		and	eax, 1
		jz	short loc_1002397A

loc_10023948:				; CODE XREF: sub_10023780+1F8j
		cmp	[ebp+readfds.fd_count],	40h
		jnb	short loc_10023976
		mov	ecx, [ebp+readfds.fd_count]
		mov	edx, [ebp+var_358]
		mov	eax, [edx+0Ch]
		mov	[ebp+ecx*4+readfds.fd_array], eax
		mov	ecx, [ebp+readfds.fd_count]
		add	ecx, 1
		mov	[ebp+readfds.fd_count],	ecx

loc_10023976:				; CODE XREF: sub_10023780+1CFj
		xor	edx, edx
		jnz	short loc_10023948

loc_1002397A:				; CODE XREF: sub_10023780+1C6j
		mov	eax, [ebp+var_358]
		mov	ecx, [eax+24h]
		and	ecx, 2
		jz	short loc_100239BA

loc_10023988:				; CODE XREF: sub_10023780+238j
		cmp	[ebp+writefds.fd_count], 40h
		jnb	short loc_100239B6
		mov	edx, [ebp+writefds.fd_count]
		mov	eax, [ebp+var_358]
		mov	ecx, [eax+0Ch]
		mov	[ebp+edx*4+writefds.fd_array], ecx
		mov	edx, [ebp+writefds.fd_count]
		add	edx, 1
		mov	[ebp+writefds.fd_count], edx

loc_100239B6:				; CODE XREF: sub_10023780+20Fj
		xor	eax, eax
		jnz	short loc_10023988

loc_100239BA:				; CODE XREF: sub_10023780+206j
		mov	ecx, [ebp+var_358]
		mov	edx, [ecx+24h]
		and	edx, 4
		jz	short loc_100239FA

loc_100239C8:				; CODE XREF: sub_10023780+278j
		cmp	[ebp+exceptfds.fd_count], 40h
		jnb	short loc_100239F6
		mov	eax, [ebp+exceptfds.fd_count]
		mov	ecx, [ebp+var_358]
		mov	edx, [ecx+0Ch]
		mov	[ebp+eax*4+exceptfds.fd_array],	edx
		mov	eax, [ebp+exceptfds.fd_count]
		add	eax, 1
		mov	[ebp+exceptfds.fd_count], eax

loc_100239F6:				; CODE XREF: sub_10023780+24Fj
		xor	ecx, ecx
		jnz	short loc_100239C8

loc_100239FA:				; CODE XREF: sub_10023780+246j
		mov	edx, [ebp+var_234]
		mov	eax, [ebp+Memory]
		mov	ecx, [ebp+var_358]
		mov	ecx, [ecx+0Ch]
		mov	[eax+edx*4], ecx
		mov	edx, [ebp+var_234]
		add	edx, 1
		mov	[ebp+var_234], edx
		mov	eax, [ebp+var_234]
		cmp	eax, [ebp+var_4]
		jnz	short loc_10023A2B
		jmp	short loc_10023A3E
; ---------------------------------------------------------------------------

loc_10023A2B:				; CODE XREF: sub_10023780+2A7j
		mov	ecx, [ebp+var_358]
		mov	edx, [ecx]
		mov	[ebp+var_358], edx

loc_10023A39:				; CODE XREF: sub_10023780+1A8j
		jmp	loc_100238E0
; ---------------------------------------------------------------------------

loc_10023A3E:				; CODE XREF: sub_10023780+167j
					; sub_10023780+2A9j
		mov	eax, dword_100315C0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		cmp	[ebp+var_358], 0
		jz	short loc_10023A5A
		jmp	loc_100237AE
; ---------------------------------------------------------------------------

loc_10023A5A:				; CODE XREF: sub_10023780+2D3j
		cmp	dword_100315D4,	0
		jnz	short loc_10023A68
		jmp	loc_100237AE
; ---------------------------------------------------------------------------

loc_10023A68:				; CODE XREF: sub_10023780+2E1j
		mov	ecx, dword_100315D4
		mov	edx, [ecx+20h]
		mov	[ebp+var_354], edx
		mov	eax, [ebp+var_354]
		cmp	eax, [ebp+var_8]
		jbe	short loc_10023A8B
		mov	ecx, [ebp+var_8]
		mov	[ebp+var_354], ecx

loc_10023A8B:				; CODE XREF: sub_10023780+300j
		mov	edx, dword_100315D4
		cmp	dword ptr [edx+20h], 0FFFFFFFFh
		jz	short loc_10023AAE
		mov	eax, dword_100315D4
		mov	ecx, [eax+20h]
		sub	ecx, [ebp+var_354]
		mov	edx, dword_100315D4
		mov	[edx+20h], ecx

loc_10023AAE:				; CODE XREF: sub_10023780+315j
		mov	eax, [ebp+var_354]
		push	eax
		call	PR_IntervalToSeconds
		add	esp, 4
		mov	[ebp+timeout.tv_sec], eax
		mov	ecx, [ebp+var_354]
		push	ecx
		call	PR_IntervalToMicroseconds
		add	esp, 4
		xor	edx, edx
		mov	ecx, 0F4240h
		div	ecx
		mov	[ebp+timeout.tv_usec], edx
		lea	edx, [ebp+timeout]
		push	edx		; timeout
		lea	eax, [ebp+exceptfds]
		push	eax		; exceptfds
		lea	ecx, [ebp+writefds]
		push	ecx		; writefds
		lea	edx, [ebp+readfds]
		push	edx		; readfds
		push	0		; nfds
		call	select
		mov	[ebp+var_34C], eax
		cmp	[ebp+var_34C], 0
		jnz	short loc_10023B7A
		mov	eax, dword_100315D4
		cmp	dword ptr [eax+20h], 0
		jnz	short loc_10023B75
		mov	ecx, dword_100315C0
		push	ecx
		call	PR_Lock
		add	esp, 4

loc_10023B24:				; CODE XREF: sub_10023780+3E5j
		mov	edx, dword_100315D4
		mov	dword ptr [edx+28h], 0FFFFFFFFh
		mov	eax, dword_100315D4
		mov	dword ptr [eax+2Ch], 274Ch
		mov	ecx, dword_100315D4
		push	ecx
		call	sub_10023D30
		add	esp, 4
		mov	[ebp+var_358], eax
		cmp	[ebp+var_358], 0
		jz	short loc_10023B67
		mov	edx, [ebp+var_358]
		cmp	dword ptr [edx+20h], 0
		jz	short loc_10023B24

loc_10023B67:				; CODE XREF: sub_10023780+3D9j
		mov	eax, dword_100315C0
		push	eax		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_10023B75:				; CODE XREF: sub_10023780+393j
		jmp	loc_100237AE
; ---------------------------------------------------------------------------

loc_10023B7A:				; CODE XREF: sub_10023780+388j
		cmp	[ebp+var_34C], 0FFFFFFFFh
		jnz	short loc_10023BA0
		call	WSAGetLastError
		cmp	eax, 2714h
		jz	short loc_10023B9B
		call	WSAGetLastError
		cmp	eax, 2734h
		jnz	short loc_10023BA0

loc_10023B9B:				; CODE XREF: sub_10023780+40Dj
		jmp	loc_100237AE
; ---------------------------------------------------------------------------

loc_10023BA0:				; CODE XREF: sub_10023780+401j
					; sub_10023780+419j
		mov	ecx, dword_100315D4
		mov	[ebp+var_358], ecx
		mov	[ebp+var_344], 0
		jmp	short loc_10023BC7
; ---------------------------------------------------------------------------

loc_10023BB8:				; CODE XREF: sub_10023780:loc_10023CF5j
		mov	edx, [ebp+var_344]
		add	edx, 1
		mov	[ebp+var_344], edx

loc_10023BC7:				; CODE XREF: sub_10023780+436j
		mov	eax, [ebp+var_344]
		cmp	eax, [ebp+var_234]
		jge	loc_10023CFA
		xor	ecx, ecx
		mov	[ebp+var_35C], cx

loc_10023BE2:				; CODE XREF: sub_10023780+487j
		mov	edx, [ebp+var_344]
		mov	eax, [ebp+Memory]
		mov	ecx, [ebp+var_358]
		mov	edx, [eax+edx*4]
		cmp	edx, [ecx+0Ch]
		jz	short loc_10023C09
		mov	eax, [ebp+var_358]
		mov	ecx, [eax]
		mov	[ebp+var_358], ecx
		jmp	short loc_10023BE2
; ---------------------------------------------------------------------------

loc_10023C09:				; CODE XREF: sub_10023780+477j
		lea	edx, [ebp+readfds]
		push	edx		; fd_set *
		mov	eax, [ebp+var_358]
		mov	ecx, [eax+0Ch]
		push	ecx		; fd
		call	__WSAFDIsSet
		test	eax, eax
		jz	short loc_10023C34
		movsx	edx, [ebp+var_35C]
		or	edx, 1
		mov	[ebp+var_35C], dx

loc_10023C34:				; CODE XREF: sub_10023780+4A1j
		lea	eax, [ebp+writefds]
		push	eax		; fd_set *
		mov	ecx, [ebp+var_358]
		mov	edx, [ecx+0Ch]
		push	edx		; fd
		call	__WSAFDIsSet
		test	eax, eax
		jz	short loc_10023C5F
		movsx	eax, [ebp+var_35C]
		or	eax, 2
		mov	[ebp+var_35C], ax

loc_10023C5F:				; CODE XREF: sub_10023780+4CCj
		lea	ecx, [ebp+exceptfds]
		push	ecx		; fd_set *
		mov	edx, [ebp+var_358]
		mov	eax, [edx+0Ch]
		push	eax		; fd
		call	__WSAFDIsSet
		test	eax, eax
		jz	short loc_10023C8A
		movsx	ecx, [ebp+var_35C]
		or	ecx, 4
		mov	[ebp+var_35C], cx

loc_10023C8A:				; CODE XREF: sub_10023780+4F7j
		movsx	edx, [ebp+var_35C]
		test	edx, edx
		jz	short loc_10023CF5
		mov	eax, [ebp+var_358]
		cmp	dword ptr [eax+30h], 1
		jnz	short loc_10023CF5
		movzx	ecx, [ebp+var_35C]
		push	ecx
		mov	edx, [ebp+var_358]
		push	edx
		mov	eax, [ebp+var_358]
		mov	ecx, [eax+8]
		call	ecx
		add	esp, 8
		test	eax, eax
		jz	short loc_10023CF5
		mov	edx, dword_100315C0
		push	edx
		call	PR_Lock
		add	esp, 4
		mov	eax, [ebp+var_358]
		push	eax
		call	sub_10023D30
		add	esp, 4
		mov	[ebp+var_358], eax
		mov	ecx, dword_100315C0
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4

loc_10023CF5:				; CODE XREF: sub_10023780+513j
					; sub_10023780+51Fj ...
		jmp	loc_10023BB8
; ---------------------------------------------------------------------------

loc_10023CFA:				; CODE XREF: sub_10023780+453j
		jmp	loc_100237AE
; ---------------------------------------------------------------------------

loc_10023CFF:				; CODE XREF: sub_10023780+35j
					; sub_10023780+C7j
		cmp	[ebp+Memory], 0
		jz	short loc_10023D18
		mov	edx, [ebp+Memory]
		push	edx		; Memory
		call	PR_Free
		add	esp, 4
		mov	[ebp+Memory], 0

loc_10023D18:				; CODE XREF: sub_10023780+583j
		mov	ecx, [ebp+var_18]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10023780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023D30	proc near		; CODE XREF: sub_10023780+19Ap
					; sub_10023780+3C4p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+4], 0
		jnz	short loc_10023D4A
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx]
		mov	dword_100315D4,	edx
		jmp	short loc_10023D57
; ---------------------------------------------------------------------------

loc_10023D4A:				; CODE XREF: sub_10023D30+Bj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ebp+arg_0]
		mov	eax, [edx]
		mov	[ecx], eax

loc_10023D57:				; CODE XREF: sub_10023D30+18j
		mov	ecx, [ebp+arg_0]
		cmp	dword ptr [ecx], 0
		jnz	short loc_10023D6C
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+4]
		mov	dword_100315D8,	eax
		jmp	short loc_10023D7A
; ---------------------------------------------------------------------------

loc_10023D6C:				; CODE XREF: sub_10023D30+2Dj
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	[edx+4], ecx

loc_10023D7A:				; CODE XREF: sub_10023D30+3Aj
		mov	edx, [ebp+arg_0]
		cmp	edx, dword_100315DC
		jnz	short loc_10023D91
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	dword_100315DC,	ecx

loc_10023D91:				; CODE XREF: sub_10023D30+53j
		mov	edx, [ebp+arg_0]
		mov	eax, [edx]
		mov	[ebp+var_4], eax
		mov	ecx, [ebp+arg_0]
		mov	dword ptr [ecx+4], 0
		mov	edx, [ebp+arg_0]
		mov	dword ptr [edx], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 3
		mov	ecx, dword_100315D0
		sub	ecx, 1
		mov	dword_100315D0,	ecx
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+34h]
		push	eax
		call	PR_NotifyCondVar
		add	esp, 4
		mov	eax, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_10023D30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10023DE0(SOCKET s, char *buf,	int len, int flags, struct sockaddr *to, int, int)
sub_10023DE0	proc near		; CODE XREF: sub_1001FD70+92p

var_44		= byte ptr -44h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
iError		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
s		= dword	ptr  8
buf		= dword	ptr  0Ch
len		= dword	ptr  10h
flags		= dword	ptr  14h
to		= dword	ptr  18h
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		mov	[ebp+var_4], 0FFFFFFFFh
		mov	[ebp+var_8], 0
		mov	eax, [ebp+to]
		movzx	ecx, word ptr [eax]
		sub	ecx, 2
		neg	ecx
		sbb	ecx, ecx
		and	ecx, 0Ch
		add	ecx, 10h
		push	ecx		; tolen
		mov	edx, [ebp+to]
		push	edx		; to
		mov	eax, [ebp+flags]
		push	eax		; flags
		mov	ecx, [ebp+len]
		push	ecx		; len
		mov	edx, [ebp+buf]
		push	edx		; buf
		mov	eax, [ebp+s]
		push	eax		; s
		call	sendto
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_10023E50
		call	WSAGetLastError
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 2733h
		jnz	short loc_10023E44
		mov	[ebp+var_8], 1
		jmp	short loc_10023E50
; ---------------------------------------------------------------------------

loc_10023E44:				; CODE XREF: sub_10023DE0+59j
		mov	ecx, [ebp+var_C]
		push	ecx
		call	sub_100253F0
		add	esp, 4

loc_10023E50:				; CODE XREF: sub_10023DE0+48j
					; sub_10023DE0+62j
		cmp	[ebp+var_8], 1
		jnz	short loc_10023EB9
		mov	edx, [ebp+s]
		mov	[ebp+var_38], edx
		mov	eax, [ebp+buf]
		mov	[ebp+var_34], eax
		mov	ecx, [ebp+len]
		mov	[ebp+var_30], ecx
		mov	edx, [ebp+flags]
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+to]
		mov	[ebp+var_28], eax
		mov	ecx, [ebp+arg_18]
		mov	[ebp+var_24], ecx
		mov	[ebp+var_1C], 0
		mov	[ebp+var_3C], offset sub_10024100
		mov	[ebp+var_20], 6
		lea	edx, [ebp+var_44]
		push	edx
		call	sub_10023EC0
		add	esp, 4
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jge	short loc_10023EB9
		mov	eax, [ebp+iError]
		push	eax		; iError
		call	WSASetLastError
		mov	ecx, [ebp+iError]
		push	ecx
		call	sub_100253F0
		add	esp, 4

loc_10023EB9:				; CODE XREF: sub_10023DE0+74j
					; sub_10023DE0+C2j
		mov	eax, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_10023DE0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023EC0	proc near		; CODE XREF: sub_10023DE0+B3p
					; sub_100241C0+9Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	ecx, dword_100315C0
		push	ecx
		call	PR_NewCondVar
		add	esp, 4
		mov	edx, [ebp+arg_0]
		mov	[edx+34h], eax
		mov	eax, dword_100315C0
		push	eax
		call	PR_Lock
		add	esp, 4
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	sub_10023F70
		add	esp, 4
		mov	edx, dword_100315C8
		push	edx
		call	PR_NotifyCondVar
		add	esp, 4

loc_10023F0C:				; CODE XREF: sub_10023EC0:loc_10023F45j
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+30h], 3
		jz	short loc_10023F47
		push	0FFFFFFFFh
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+34h]
		push	edx
		call	PR_WaitCondVar
		add	esp, 8
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_10023F45
		call	PR_GetError
		cmp	eax, 0FFFFE897h
		jnz	short loc_10023F45
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 2

loc_10023F45:				; CODE XREF: sub_10023EC0+6Dj
					; sub_10023EC0+79j
		jmp	short loc_10023F0C
; ---------------------------------------------------------------------------

loc_10023F47:				; CODE XREF: sub_10023EC0+53j
		mov	ecx, dword_100315C0
		push	ecx		; lpTlsValue
		call	PR_Unlock
		add	esp, 4
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+34h]
		push	eax		; Memory
		call	PR_DestroyCondVar
		add	esp, 4
		mov	ecx, [ebp+arg_0]
		mov	eax, [ecx+28h]
		mov	esp, ebp
		pop	ebp
		retn
sub_10023EC0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10023F70	proc near		; CODE XREF: sub_10023EC0+35p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		call	PR_IntervalNow
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+20h], 0FFFFFFFFh
		jnz	short loc_10023FA3
		mov	ecx, dword_100315D8
		mov	[ebp+var_C], ecx
		jmp	loc_10024027
; ---------------------------------------------------------------------------

loc_10023FA3:				; CODE XREF: sub_10023F70+23j
		cmp	dword_100315DC,	0
		jz	short loc_10024027
		mov	edx, dword_100315DC
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_8]
		add	ecx, [eax+20h]
		mov	[ebp+var_10], ecx
		mov	edx, [ebp+var_C]
		mov	eax, dword_100315E0
		add	eax, [edx+20h]
		mov	[ebp+var_4], eax

loc_10023FCF:				; CODE XREF: sub_10023F70+ACj
		mov	ecx, [ebp+var_10]
		sub	ecx, [ebp+var_4]
		mov	[ebp+var_14], ecx
		js	short loc_10023FF1
		mov	edx, [ebp+var_8]
		sub	edx, dword_100315E0
		mov	eax, [ebp+arg_0]
		add	edx, [eax+20h]
		mov	ecx, [ebp+arg_0]
		mov	[ecx+20h], edx
		jmp	short loc_10024027
; ---------------------------------------------------------------------------

loc_10023FF1:				; CODE XREF: sub_10023F70+68j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_4]
		sub	eax, [edx+20h]
		mov	[ebp+var_4], eax
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+4]
		mov	[ebp+var_C], edx
		cmp	[ebp+var_C], 0
		jz	short loc_10024018
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_4]
		add	ecx, [eax+20h]
		mov	[ebp+var_4], ecx

loc_10024018:				; CODE XREF: sub_10023F70+9Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_10023FCF
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+20h]
		mov	[ebp+var_14], eax

loc_10024027:				; CODE XREF: sub_10023F70+2Ej
					; sub_10023F70+3Aj ...
		cmp	[ebp+var_C], 0
		jnz	short loc_1002406B
		mov	ecx, [ebp+arg_0]
		mov	dword ptr [ecx+4], 0
		mov	edx, [ebp+arg_0]
		mov	eax, dword_100315D4
		mov	[edx], eax
		mov	ecx, [ebp+arg_0]
		mov	dword_100315D4,	ecx
		cmp	dword_100315D8,	0
		jnz	short loc_1002405E
		mov	edx, [ebp+arg_0]
		mov	dword_100315D8,	edx
		jmp	short loc_10024069
; ---------------------------------------------------------------------------

loc_1002405E:				; CODE XREF: sub_10023F70+E1j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	edx, [ebp+arg_0]
		mov	[ecx+4], edx

loc_10024069:				; CODE XREF: sub_10023F70+ECj
		jmp	short loc_100240B9
; ---------------------------------------------------------------------------

loc_1002406B:				; CODE XREF: sub_10023F70+BBj
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_C]
		mov	[eax+4], ecx
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_C]
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	edx, [ebp+arg_0]
		cmp	dword ptr [edx+4], 0
		jz	short loc_10024092
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	edx, [ebp+arg_0]
		mov	[ecx], edx

loc_10024092:				; CODE XREF: sub_10023F70+115j
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_100240A5
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx]
		mov	eax, [ebp+arg_0]
		mov	[edx+4], eax

loc_100240A5:				; CODE XREF: sub_10023F70+128j
		mov	ecx, [ebp+var_C]
		cmp	ecx, dword_100315D8
		jnz	short loc_100240B9
		mov	edx, [ebp+arg_0]
		mov	dword_100315D8,	edx

loc_100240B9:				; CODE XREF: sub_10023F70:loc_10024069j
					; sub_10023F70+13Ej
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+20h], 0FFFFFFFFh
		jz	short loc_100240E7
		cmp	dword_100315DC,	0
		jz	short loc_100240D6
		mov	ecx, [ebp+var_C]
		cmp	ecx, dword_100315DC
		jnz	short loc_100240E7

loc_100240D6:				; CODE XREF: sub_10023F70+159j
		mov	edx, [ebp+arg_0]
		mov	dword_100315DC,	edx
		mov	eax, [ebp+var_8]
		mov	dword_100315E0,	eax

loc_100240E7:				; CODE XREF: sub_10023F70+150j
					; sub_10023F70+164j
		mov	ecx, dword_100315D0
		add	ecx, 1
		mov	dword_100315D0,	ecx
		mov	esp, ebp
		pop	ebp
		retn
sub_10023F70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024100	proc near		; DATA XREF: sub_10023DE0+A1o

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	20h		; tolen
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		push	ecx		; to
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+18h]
		push	eax		; flags
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+14h]
		push	edx		; len
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		push	ecx		; buf
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+0Ch]
		push	eax		; s
		call	sendto
		mov	[ebp+var_4], eax
		call	WSAGetLastError
		mov	ecx, [ebp+arg_0]
		mov	[ecx+2Ch], eax
		cmp	[ebp+var_4], 0
		jle	short loc_1002418D
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+10h]
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+var_8]
		add	ecx, [ebp+var_4]
		mov	[ebp+var_8], ecx
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_8]
		mov	[edx+10h], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+28h]
		add	edx, [ebp+var_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+28h], edx
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+14h]
		sub	edx, [ebp+var_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	ecx, [ebp+arg_0]
		xor	eax, eax
		cmp	dword ptr [ecx+14h], 0
		setz	al
		jmp	short loc_100241B2
; ---------------------------------------------------------------------------
		jmp	short loc_100241B2
; ---------------------------------------------------------------------------

loc_1002418D:				; CODE XREF: sub_10024100+42j
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_100241A8
		mov	edx, [ebp+arg_0]
		cmp	dword ptr [edx+2Ch], 2733h
		jnz	short loc_100241A8
		mov	[ebp+var_C], 0
		jmp	short loc_100241AF
; ---------------------------------------------------------------------------

loc_100241A8:				; CODE XREF: sub_10024100+91j
					; sub_10024100+9Dj
		mov	[ebp+var_C], 1

loc_100241AF:				; CODE XREF: sub_10024100+A6j
		mov	eax, [ebp+var_C]

loc_100241B2:				; CODE XREF: sub_10024100+89j
					; sub_10024100+8Bj
		mov	esp, ebp
		pop	ebp
		retn
sub_10024100	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100241C0(SOCKET s, char *buf,	int len, int flags, struct sockaddr *from, int *fromlen, int)
sub_100241C0	proc near		; CODE XREF: sub_1001FE10+92p

var_44		= byte ptr -44h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
iError		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
s		= dword	ptr  8
buf		= dword	ptr  0Ch
len		= dword	ptr  10h
flags		= dword	ptr  14h
from		= dword	ptr  18h
fromlen		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		mov	[ebp+var_4], 0FFFFFFFFh
		mov	[ebp+var_8], 0
		mov	eax, [ebp+fromlen]
		push	eax		; fromlen
		mov	ecx, [ebp+from]
		push	ecx		; from
		mov	edx, [ebp+flags]
		push	edx		; flags
		mov	eax, [ebp+len]
		push	eax		; len
		mov	ecx, [ebp+buf]
		push	ecx		; buf
		mov	edx, [ebp+s]
		push	edx		; s
		call	recvfrom
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_10024220
		call	WSAGetLastError
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 2733h
		jnz	short loc_10024214
		mov	[ebp+var_8], 1
		jmp	short loc_10024220
; ---------------------------------------------------------------------------

loc_10024214:				; CODE XREF: sub_100241C0+49j
		mov	eax, [ebp+var_C]
		push	eax
		call	sub_100253E0
		add	esp, 4

loc_10024220:				; CODE XREF: sub_100241C0+38j
					; sub_100241C0+52j
		cmp	[ebp+var_8], 1
		jnz	short loc_10024282
		mov	ecx, [ebp+s]
		mov	[ebp+var_38], ecx
		mov	edx, [ebp+buf]
		mov	[ebp+var_34], edx
		mov	eax, [ebp+len]
		mov	[ebp+var_30], eax
		mov	ecx, [ebp+flags]
		mov	[ebp+var_2C], ecx
		mov	edx, [ebp+from]
		mov	[ebp+var_28], edx
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_24], eax
		mov	[ebp+var_3C], offset sub_10024290
		mov	[ebp+var_20], 5
		lea	ecx, [ebp+var_44]
		push	ecx
		call	sub_10023EC0
		add	esp, 4
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jge	short loc_10024282
		mov	edx, [ebp+iError]
		push	edx		; iError
		call	WSASetLastError
		mov	eax, [ebp+iError]
		push	eax
		call	sub_100253E0
		add	esp, 4

loc_10024282:				; CODE XREF: sub_100241C0+64j
					; sub_100241C0+ABj
		mov	eax, [ebp+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_100241C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024290	proc near		; DATA XREF: sub_100241C0+8Ao

var_8		= dword	ptr -8
fromlen		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	[ebp+fromlen], 20h
		lea	eax, [ebp+fromlen]
		push	eax		; fromlen
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+1Ch]
		push	edx		; from
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+18h]
		push	ecx		; flags
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+14h]
		push	eax		; len
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+10h]
		push	edx		; buf
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0Ch]
		push	ecx		; s
		call	recvfrom
		mov	edx, [ebp+arg_0]
		mov	[edx+28h], eax
		call	WSAGetLastError
		mov	ecx, [ebp+arg_0]
		mov	[ecx+2Ch], eax
		mov	edx, [ebp+arg_0]
		cmp	dword ptr [edx+28h], 0FFFFFFFFh
		jnz	short loc_100242F8
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+2Ch], 2733h
		jnz	short loc_100242F8
		mov	[ebp+var_8], 0
		jmp	short loc_100242FF
; ---------------------------------------------------------------------------

loc_100242F8:				; CODE XREF: sub_10024290+51j
					; sub_10024290+5Dj
		mov	[ebp+var_8], 1

loc_100242FF:				; CODE XREF: sub_10024290+66j
		mov	eax, [ebp+var_8]
		mov	esp, ebp
		pop	ebp
		retn
sub_10024290	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024310	proc near		; CODE XREF: StartAddress+6Fp
					; sub_10024C90+F2p

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, ds:EnterCriticalSection
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		push	edi
		lea	ebp, [esi+40h]
		push	ebp		; lpCriticalSection
		call	ebx ; EnterCriticalSection
		cmp	dword ptr [esi+0A4h], 0
		jnz	short loc_1002439D
		mov	eax, [esi+9Ch]
		mov	edi, [esi+4]
		mov	dword ptr [esi], 1
		mov	ecx, [eax+24h]
		push	ecx		; lpCriticalSection
		call	ebx ; EnterCriticalSection
		mov	eax, [esi+9Ch]
		mov	edx, [eax+24h]
		lea	edx, [edx+edi*8+48h]
		mov	[esi+68h], edx
		mov	edx, [eax+24h]
		mov	edx, [edx+edi*8+4Ch]
		lea	ecx, [esi+68h]
		mov	[esi+6Ch], edx
		mov	eax, [eax+24h]
		mov	edx, [eax+edi*8+4Ch]
		mov	[edx], ecx
		mov	eax, [esi+9Ch]
		mov	edx, [eax+24h]
		mov	[edx+edi*8+4Ch], ecx
		mov	eax, [esi+9Ch]
		mov	eax, [eax+24h]
		mov	ecx, edi
		mov	edx, 1
		shl	edx, cl
		or	[eax+68h], edx
		mov	eax, [esi+9Ch]
		mov	dword ptr [esi+58h], 1
		mov	ecx, [eax+24h]
		push	ecx
		jmp	short loc_100243D0
; ---------------------------------------------------------------------------

loc_1002439D:				; CODE XREF: sub_10024310+1Bj
		mov	edx, [esi+9Ch]
		mov	eax, [edx+24h]
		add	eax, 18h
		push	eax		; lpCriticalSection
		call	ebx ; EnterCriticalSection
		mov	ecx, [esi+80h]
		push	ecx
		push	esi
		mov	dword ptr [esi+58h], 2
		call	_PR_AddSleepQ
		mov	edx, [esi+9Ch]
		mov	eax, [edx+24h]
		add	esp, 8
		add	eax, 18h
		push	eax		; lpCriticalSection

loc_100243D0:				; CODE XREF: sub_10024310+8Bj
		mov	edi, ds:LeaveCriticalSection
		call	edi ; LeaveCriticalSection
		xor	ebx, ebx
		push	ebp		; lpCriticalSection
		mov	[esi+0ACh], ebx
		mov	[esi+128h], ebx
		call	edi ; LeaveCriticalSection
		cmp	dword_1003067C,	ebx
		jz	short loc_1002440C
		mov	ecx, TlsIndex
		mov	edx, large fs:2Ch
		mov	eax, [edx+ecx*4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax+4], ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1002440C:				; CODE XREF: sub_10024310+DFj
		mov	ecx, dword_10032A18
		push	ebx		; lpTlsValue
		push	ecx		; dwTlsIndex
		call	ds:TlsSetValue
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10024310	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024420	proc near		; CODE XREF: PR_Init_0+C6p
		push	offset stru_100329C0 ; lpCriticalSection
		call	ds:InitializeCriticalSection
		cmp	dword_1003067C,	0
		mov	eax, offset dword_100329E0
		mov	dword_100329E8,	0
		mov	dword_100329E0,	eax
		mov	dword_100329E4,	eax
		jnz	short locret_10024478
		push	esi
		mov	esi, ds:TlsAlloc
		call	esi ; TlsAlloc
		mov	dword_100329F0,	eax
		call	esi ; TlsAlloc
		mov	dword_100329D8,	eax
		call	esi ; TlsAlloc
		mov	dword_100329EC,	eax
		call	esi ; TlsAlloc
		mov	dwTlsIndex, eax
		call	esi ; TlsAlloc
		mov	dword_10032A18,	eax
		pop	esi

locret_10024478:			; CODE XREF: sub_10024420+2Bj
		retn
sub_10024420	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024480	proc near		; CODE XREF: PR_Cleanup:loc_1000D53Bp
		call	sub_1001CFA0
		call	WSACleanup
		cmp	dword_1003067C,	0
		jnz	short locret_100244C6
		mov	eax, dword_100329F0
		push	esi
		mov	esi, ds:TlsFree
		push	eax		; dwTlsIndex
		call	esi ; TlsFree
		mov	ecx, dword_100329D8
		push	ecx		; dwTlsIndex
		call	esi ; TlsFree
		mov	edx, dword_100329EC
		push	edx		; dwTlsIndex
		call	esi ; TlsFree
		mov	eax, dwTlsIndex
		push	eax		; dwTlsIndex
		call	esi ; TlsFree
		mov	ecx, dword_10032A18
		push	ecx		; dwTlsIndex
		call	esi ; TlsFree
		pop	esi

locret_100244C6:			; CODE XREF: sub_10024480+11j
		retn
sub_10024480	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100244D0	proc near		; CODE XREF: .text:10019CDAp
					; _PR_CreateThread+334p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		lea	eax, [esi+0B0h]
		mov	[esi+0C8h], eax
		mov	eax, [esi+90h]
		mov	dword ptr [esi+0C4h], 38h
		test	al, al
		jns	short loc_1002455F
		test	al, 0Ch
		jz	short loc_10024521
		push	edi
		mov	edi, ds:GetCurrentProcess
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	ecx, [esi+0F8h]
		push	ecx		; lpTargetHandle
		call	edi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		call	ds:GetCurrentThread
		push	eax		; hSourceHandle
		call	edi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		pop	edi

loc_10024521:				; CODE XREF: sub_100244D0+27j
		push	0		; lpName
		push	1		; lMaximumCount
		push	0		; lInitialCount
		push	0		; lpSemaphoreAttributes
		call	ds:CreateSemaphoreA
		mov	[esi+0E8h], eax
		test	eax, eax
		jnz	short loc_1002453E

loc_10024539:				; CODE XREF: sub_100244D0+8Dj
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1002453E:				; CODE XREF: sub_100244D0+67j
		cmp	dword_10031524,	0
		jz	short loc_1002455F
		push	0		; lpName
		push	0		; bInitialState
		push	1		; bManualReset
		push	0		; lpEventAttributes
		call	ds:CreateEventA
		mov	[esi+130h], eax
		test	eax, eax
		jz	short loc_10024539

loc_1002455F:				; CODE XREF: sub_100244D0+23j
					; sub_100244D0+75j
		xor	eax, eax
		pop	esi
		retn
sub_100244D0	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10024570:				; DATA XREF: sub_10024A40+23o
		mov	eax, [esp+4]
		push	eax
		mov	eax, [eax+148h]
		call	eax
		add	esp, 4
		xor	eax, eax
		retn	4
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024590	proc near		; CODE XREF: sub_10017C20+3Fp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+48h]
		push	0FFFFFFFFh	; dwMilliseconds
		push	ecx		; hHandle
		call	ds:WaitForSingleObject
		retn
sub_10024590	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100245B0	proc near		; CODE XREF: sub_10017D10+19Fp
		push	0
		call	ds:_endthreadex
		pop	ecx
		retn
sub_100245B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100245C0	proc near		; CODE XREF: PR_Sleep+71p
		push	0		; dwMilliseconds
		call	ds:Sleep
		retn
sub_100245C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100245D0	proc near		; CODE XREF: sub_1001A160+26p
					; _PR_CreateThread+1A9p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		test	eax, eax
		jns	short loc_100245DC
		xor	eax, eax
		jmp	short loc_100245EA
; ---------------------------------------------------------------------------

loc_100245DC:				; CODE XREF: sub_100245D0+6j
		cmp	eax, 3		; switch 4 cases
		jle	short loc_100245E8
		mov	eax, 3
		jmp	short loc_100245EA
; ---------------------------------------------------------------------------

loc_100245E8:				; CODE XREF: sub_100245D0+Fj
		ja	short loc_10024608 ; jumptable 100245EA	default	case

loc_100245EA:				; CODE XREF: sub_100245D0+Aj
					; sub_100245D0+16j
		jmp	ds:off_10024638[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_100245F1:				; CODE XREF: sub_100245D0:loc_100245EAj
					; DATA XREF: .text:off_10024638o
		or	eax, 0FFFFFFFFh	; jumptable 100245EA case 0
		jmp	short loc_1002460C
; ---------------------------------------------------------------------------

loc_100245F6:				; CODE XREF: sub_100245D0:loc_100245EAj
					; DATA XREF: .text:off_10024638o
		xor	eax, eax	; jumptable 100245EA case 1
		jmp	short loc_1002460C
; ---------------------------------------------------------------------------

loc_100245FA:				; CODE XREF: sub_100245D0:loc_100245EAj
					; DATA XREF: .text:off_10024638o
		mov	eax, 1		; jumptable 100245EA case 2
		jmp	short loc_1002460C
; ---------------------------------------------------------------------------

loc_10024601:				; CODE XREF: sub_100245D0:loc_100245EAj
					; DATA XREF: .text:off_10024638o
		mov	eax, 2		; jumptable 100245EA case 3
		jmp	short loc_1002460C
; ---------------------------------------------------------------------------

loc_10024608:				; CODE XREF: sub_100245D0:loc_100245E8j
		mov	eax, [esp+arg_4] ; jumptable 100245EA default case

loc_1002460C:				; CODE XREF: sub_100245D0+24j
					; sub_100245D0+28j ...
		push	eax		; nPriority
		mov	eax, [esp+4+arg_0]
		mov	ecx, [eax+48h]
		push	ecx		; hThread
		call	ds:SetThreadPriority
		test	eax, eax
		jnz	short locret_10024636
		mov	edx, dword_10032A90
		cmp	dword ptr [edx+4], 4
		jl	short locret_10024636
		push	offset aPr_setthread_1 ; "PR_SetThreadPriority:	can't set thread "...
		call	PR_LogPrint
		pop	ecx

locret_10024636:			; CODE XREF: sub_100245D0+4Dj
					; sub_100245D0+59j
		retn
sub_100245D0	endp

; ---------------------------------------------------------------------------
		align 4
off_10024638	dd offset loc_100245F1	; DATA XREF: sub_100245D0:loc_100245EAr
		dd offset loc_100245F6	; jump table for switch	statement
		dd offset loc_100245FA
		dd offset loc_10024601
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10024650	proc near		; CODE XREF: PR_SetCurrentThreadName+70p

Arguments	= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	0FFFFFFFEh
		push	offset stru_1002B7D8
		push	offset sub_10026D0F
		mov	eax, large fs:0
		push	eax
		sub	esp, 18h
		push	ebx
		push	esi
		push	edi
		mov	eax, ___security_cookie
		xor	[ebp+ms_exc.registration.ScopeTable], eax
		xor	eax, ebp
		push	eax
		lea	eax, [ebp+ms_exc.registration]
		mov	large fs:0, eax
		mov	[ebp+ms_exc.old_esp], esp
		call	ds:IsDebuggerPresent
		test	eax, eax
		jz	short loc_100246CB
		mov	[ebp+Arguments], 1000h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_24], eax
		mov	[ebp+var_20], 0FFFFFFFFh
		xor	eax, eax
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], eax
		lea	ecx, [ebp+Arguments]
		push	ecx		; lpArguments
		push	4		; nNumberOfArguments
		push	eax		; dwExceptionFlags
		push	406D1388h	; dwExceptionCode
		call	ds:RaiseException
		jmp	short loc_100246C4
; ---------------------------------------------------------------------------

loc_100246BD:				; DATA XREF: .rdata:stru_1002B7D8o
		or	eax, 0FFFFFFFFh	; Exception filter 0 for function 10024650
		retn
; ---------------------------------------------------------------------------

loc_100246C1:				; DATA XREF: .rdata:stru_1002B7D8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10024650

loc_100246C4:				; CODE XREF: sub_10024650+6Bj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_100246CB:				; CODE XREF: sub_10024650+3Bj
		mov	ecx, [ebp+ms_exc.registration.Next]
		mov	large fs:0, ecx
		pop	ecx
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10024650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100246E0	proc near		; CODE XREF: sub_10019BB0+54p
					; sub_10019BB0:loc_10019C19p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+0E0h]
		push	edi
		xor	edi, edi
		cmp	eax, edi
		jz	short loc_10024701
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esi+0E0h], edi

loc_10024701:				; CODE XREF: sub_100246E0+10j
		mov	eax, [esi+0E4h]
		cmp	eax, edi
		jz	short loc_1002471A
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esi+0E4h], edi

loc_1002471A:				; CODE XREF: sub_100246E0+29j
		mov	eax, [esi+0E8h]
		push	ebx
		mov	ebx, ds:CloseHandle
		cmp	eax, edi
		jz	short loc_10024734
		push	eax		; hObject
		call	ebx ; CloseHandle
		mov	[esi+0E8h], edi

loc_10024734:				; CODE XREF: sub_100246E0+49j
		cmp	dword_10031524,	edi
		jz	short loc_1002474F
		mov	eax, [esi+130h]
		cmp	eax, edi
		jz	short loc_1002474F
		push	eax		; hObject
		call	ebx ; CloseHandle
		mov	[esi+130h], edi

loc_1002474F:				; CODE XREF: sub_100246E0+5Aj
					; sub_100246E0+64j
		mov	eax, [esi+0F8h]
		cmp	eax, edi
		jz	short loc_10024762
		push	eax		; hObject
		call	ebx ; CloseHandle
		mov	[esi+0F8h], edi

loc_10024762:				; CODE XREF: sub_100246E0+77j
		test	byte ptr [esi+90h], 84h
		pop	ebx
		jnz	short loc_100247A7
		push	offset stru_100329C0 ; lpCriticalSection
		call	ds:EnterCriticalSection
		inc	dword_100329E8
		lea	eax, [esi+68h]
		mov	dword ptr [eax], offset	dword_100329E0
		mov	ecx, dword_100329E4
		mov	[esi+6Ch], ecx
		mov	edx, dword_100329E4
		mov	[edx], eax
		push	offset stru_100329C0 ; lpCriticalSection
		mov	dword_100329E4,	eax
		call	ds:LeaveCriticalSection

loc_100247A7:				; CODE XREF: sub_100246E0+8Aj
		pop	edi
		pop	esi
		retn
sub_100246E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100247B0	proc near		; CODE XREF: PR_Cleanup+117p
					; .text:10019E0Fp

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	eax, [esi+0E0h]
		push	edi
		xor	edi, edi
		cmp	eax, edi
		jz	short loc_100247D2
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esi+0E0h], edi

loc_100247D2:				; CODE XREF: sub_100247B0+11j
		mov	eax, [esi+0E4h]
		cmp	eax, edi
		jz	short loc_100247EB
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esi+0E4h], edi

loc_100247EB:				; CODE XREF: sub_100247B0+2Aj
		mov	eax, [esi+0E8h]
		mov	ebx, ds:CloseHandle
		cmp	eax, edi
		jz	short loc_10024804
		push	eax		; hObject
		call	ebx ; CloseHandle
		mov	[esi+0E8h], edi

loc_10024804:				; CODE XREF: sub_100247B0+49j
		cmp	dword_10031524,	edi
		jz	short loc_1002481F
		mov	eax, [esi+130h]
		cmp	eax, edi
		jz	short loc_1002481F
		push	eax		; hObject
		call	ebx ; CloseHandle
		mov	[esi+130h], edi

loc_1002481F:				; CODE XREF: sub_100247B0+5Aj
					; sub_100247B0+64j
		mov	eax, [esi+0F8h]
		cmp	eax, edi
		jz	short loc_10024832
		push	eax		; hObject
		call	ebx ; CloseHandle
		mov	[esi+0F8h], edi

loc_10024832:				; CODE XREF: sub_100247B0+77j
		test	byte ptr [esi+90h], 80h
		jz	short loc_10024869
		cmp	dword_1003067C,	edi
		jz	short loc_1002485C
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	[edx+8], edi
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1002485C:				; CODE XREF: sub_100247B0+91j
		mov	eax, dword_100329F0
		push	edi		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ds:TlsSetValue

loc_10024869:				; CODE XREF: sub_100247B0+89j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_100247B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl PR_ProcessExit_0(int Code)
PR_ProcessExit_0 proc near		; CODE XREF: PR_ProcessExitj

Code		= dword	ptr  4

		mov	eax, [esp+Code]
		push	eax		; Code
		call	ds:_exit
PR_ProcessExit_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024880	proc near		; CODE XREF: _PR_CreateThread+205p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	14Ch		; Size
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10024896
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024896:				; CODE XREF: sub_10024880+12j
		push	14Ch		; Size
		push	0		; Val
		push	esi		; Dst
		call	memset
		mov	eax, [esp+10h+arg_4]
		mov	ecx, [esp+10h+arg_8]
		mov	edx, [esp+10h+arg_0]
		mov	[esi+138h], eax
		add	esp, 0Ch
		mov	[esi+13Ch], ecx
		mov	[esi+140h], edx
		mov	eax, esi
		pop	esi
		retn
sub_10024880	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100248D0(LPVOID lpTlsValue)
sub_100248D0	proc near		; CODE XREF: sub_10018030+Cp

lpTlsValue	= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		push	0		; lpParameter
		call	ds:ConvertThreadToFiber
		mov	esi, [esp+0Ch+lpTlsValue]
		mov	edi, ds:TlsSetValue
		mov	ebx, TlsIndex
		mov	[esi+134h], eax
		cmp	dword_1003067C,	0
		jz	short loc_1002490B
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	[ecx+8], esi
		jmp	short loc_10024915
; ---------------------------------------------------------------------------

loc_1002490B:				; CODE XREF: sub_100248D0+28j
		mov	edx, dword_100329F0
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	edi ; TlsSetValue

loc_10024915:				; CODE XREF: sub_100248D0+39j
		cmp	dword_1003067C,	0
		jz	short loc_1002493B
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	[ecx+0Ch], esi
		pop	edi
		mov	dword ptr [esi+94h], 1
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_1002493B:				; CODE XREF: sub_100248D0+4Cj
		mov	edx, dword_100329D8
		push	esi		; lpTlsValue
		push	edx		; dwTlsIndex
		call	edi ; TlsSetValue
		pop	edi
		mov	dword ptr [esi+94h], 1
		pop	esi
		pop	ebx
		retn
sub_100248D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024960	proc near		; CODE XREF: PR_Sleep+16Dp
					; sub_10017D10+1BAp ...

arg_0		= dword	ptr  4

		call	ds:GetLastError
		mov	ecx, [esp+arg_0]
		mov	[ecx+144h], eax
		jmp	sub_1001A480
sub_10024960	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_SetThreadAffinityMask_0(int, DWORD_PTR	dwThreadAffinityMask)
PR_SetThreadAffinityMask_0 proc	near	; CODE XREF: PR_SetThreadAffinityMaskj
					; PR_SetCPUAffinityMask+2Dp

arg_0		= dword	ptr  4
dwThreadAffinityMask= dword ptr	 8

		mov	eax, [esp+dwThreadAffinityMask]
		mov	ecx, [esp+arg_0]
		mov	edx, [ecx+0F8h]
		push	eax		; dwThreadAffinityMask
		push	edx		; hThread
		call	ds:SetThreadAffinityMask
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		retn
PR_SetThreadAffinityMask_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetThreadAffinityMask_0(int, PDWORD_PTR lpProcessAffinityMask)
PR_GetThreadAffinityMask_0 proc	near	; CODE XREF: PR_GetThreadAffinityMaskj

var_4		= byte ptr -4
lpProcessAffinityMask= dword ptr  8

		push	ecx
		mov	ecx, [esp+4+lpProcessAffinityMask]
		lea	eax, [esp+4+var_4]
		push	eax		; lpSystemAffinityMask
		push	ecx		; lpProcessAffinityMask
		call	ds:GetCurrentProcess
		push	eax		; hProcess
		call	ds:GetProcessAffinityMask
		neg	eax
		sbb	eax, eax
		neg	eax
		dec	eax
		pop	ecx
		retn
PR_GetThreadAffinityMask_0 endp


; =============== S U B	R O U T	I N E =======================================


sub_100249C0	proc near		; CODE XREF: PR_SuspendAll+1E1p
					; PR_SuspendAll+2E7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	byte ptr [eax+90h], 80h
		jz	short locret_100249DA
		mov	eax, [eax+0F8h]
		push	eax		; hThread
		call	ds:SuspendThread

locret_100249DA:			; CODE XREF: sub_100249C0+Bj
		retn
sub_100249C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100249E0	proc near		; CODE XREF: PR_ResumeAll+2F4p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	byte ptr [eax+90h], 80h
		jz	short locret_100249FA
		mov	eax, [eax+0F8h]
		push	eax		; hThread
		call	ds:ResumeThread

locret_100249FA:			; CODE XREF: sub_100249E0+Bj
		retn
sub_100249E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_AssertCurrentThreadOwnsLock_0 proc near ; CODE XREF:	PR_CancelWaitGroup+Bp
					; PR_WaitRecvReady+Ap ...
		cmp	dword_1003067C,	0
		jz	short loc_10024A20
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+8]
		jmp	short loc_10024A2C
; ---------------------------------------------------------------------------

loc_10024A20:				; CODE XREF: PR_AssertCurrentThreadOwnsLock_0+7j
		mov	eax, dword_100329F0
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_10024A2C:				; CODE XREF: PR_AssertCurrentThreadOwnsLock_0+1Ej
		test	eax, eax
		jnz	short locret_10024A3D
		push	eax
		push	eax
		push	1
		push	eax
		call	sub_1001AF70
		add	esp, 10h

locret_10024A3D:			; CODE XREF: PR_AssertCurrentThreadOwnsLock_0+2Ej
		retn
PR_AssertCurrentThreadOwnsLock_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024A40	proc near		; CODE XREF: _PR_NativeCreateThread+135p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	ecx, [esi+10h]
		push	edi
		lea	edi, [esi+8Ch]
		push	edi
		push	10004h
		push	esi
		mov	[esi+148h], eax
		mov	edx, [ecx+1Ch]
		push	offset loc_10024570
		push	edx
		push	0
		call	ds:_beginthreadex
		add	esp, 18h
		mov	[esi+0F8h], eax
		test	eax, eax
		jnz	loc_10024B09
		call	ds:GetLastError
		mov	edi, ds:_errno
		mov	[esi+144h], eax
		call	edi ; _errno
		mov	eax, [eax]
		sub	eax, 0Bh
		jz	short loc_10024AF0
		dec	eax
		jz	short loc_10024AD7
		sub	eax, 0Ah
		jz	short loc_10024ABE
		mov	esi, 0FFFFE896h
		call	edi ; _errno
		mov	eax, [eax]
		push	eax
		push	esi
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024ABE:				; CODE XREF: sub_10024A40+63j
		mov	esi, 0FFFFE89Dh
		call	edi ; _errno
		mov	eax, [eax]
		push	eax
		push	esi
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024AD7:				; CODE XREF: sub_10024A40+5Ej
		mov	esi, 0FFFFE890h
		call	edi ; _errno
		mov	eax, [eax]
		push	eax
		push	esi
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024AF0:				; CODE XREF: sub_10024A40+5Bj
		mov	esi, 0FFFFE8AAh
		call	edi ; _errno
		mov	eax, [eax]
		push	eax
		push	esi
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024B09:				; CODE XREF: sub_10024A40+3Cj
		mov	eax, [esp+8+arg_8]
		mov	ecx, [edi]
		mov	[esi+0FCh], ecx
		cmp	eax, 1
		jz	short loc_10024B2A
		push	eax
		lea	edx, [esi+0B0h]
		push	edx
		call	sub_100245D0
		add	esp, 8

loc_10024B2A:				; CODE XREF: sub_10024A40+D8j
		mov	eax, [esi+0F8h]
		push	eax		; hThread
		call	ds:ResumeThread
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10024B41
		pop	edi
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10024B41:				; CODE XREF: sub_10024A40+FAj
		call	ds:GetLastError
		push	eax
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		pop	edi
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
sub_10024A40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; void __stdcall StartAddress(LPVOID lpFiberParameter)
StartAddress	proc near		; DATA XREF: sub_10024C20+11o

lpFiberParameter= dword	ptr  4

		cmp	dword_1003067C,	0
		push	ebx
		mov	ebx, TlsIndex
		push	esi
		push	edi
		mov	edi, ds:TlsGetValue
		jz	short loc_10024B89
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	esi, [ecx+8]
		jmp	short loc_10024B94
; ---------------------------------------------------------------------------

loc_10024B89:				; CODE XREF: StartAddress+16j
		mov	edx, dword_100329F0
		push	edx		; dwTlsIndex
		call	edi ; TlsGetValue
		mov	esi, eax

loc_10024B94:				; CODE XREF: StartAddress+27j
		test	esi, esi
		jnz	short loc_10024BA7
		push	esi
		push	esi
		push	1
		push	esi
		call	sub_1001AF70
		add	esp, 10h
		mov	esi, eax

loc_10024BA7:				; CODE XREF: StartAddress+36j
		cmp	dword_1003067C,	0
		jz	short loc_10024BC1
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	eax, [ecx+4]
		jmp	short loc_10024BCA
; ---------------------------------------------------------------------------

loc_10024BC1:				; CODE XREF: StartAddress+4Ej
		mov	edx, dword_10032A18
		push	edx		; dwTlsIndex
		call	edi ; TlsGetValue

loc_10024BCA:				; CODE XREF: StartAddress+5Fj
		test	eax, eax
		jz	short loc_10024BD7
		push	eax
		call	sub_10024310
		add	esp, 4

loc_10024BD7:				; CODE XREF: StartAddress+6Cj
		cmp	dword_1003067C,	0
		jz	short loc_10024BF1
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebx*4]
		mov	eax, [ecx+0Ch]
		jmp	short loc_10024BFA
; ---------------------------------------------------------------------------

loc_10024BF1:				; CODE XREF: StartAddress+7Ej
		mov	edx, dword_100329D8
		push	edx		; dwTlsIndex
		call	edi ; TlsGetValue

loc_10024BFA:				; CODE XREF: StartAddress+8Fj
		mov	dword ptr [eax+94h], 0
		mov	eax, [esi+13Ch]
		mov	ecx, [esi+138h]
		push	eax
		call	ecx
		add	esp, 4
		pop	edi
		pop	esi
		pop	ebx
		retn
StartAddress	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024C20	proc near		; CODE XREF: _PR_CreateThread+38Cp

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_8]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	ecx, [esi+140h]
		push	0		; lpParameter
		push	offset StartAddress ; lpStartAddress
		push	ecx		; dwStackSize
		mov	[esi+138h], eax
		call	ds:CreateFiber
		mov	[esi+134h], eax
		pop	esi
		test	eax, eax
		jz	short loc_10024C59
		mov	edx, [esp+arg_C]
		mov	dword ptr [edx], 1
		retn
; ---------------------------------------------------------------------------

loc_10024C59:				; CODE XREF: sub_10024C20+2Cj
		call	ds:GetLastError
		lea	ecx, [eax-8]
		neg	ecx
		sbb	ecx, ecx
		and	ecx, 6
		add	ecx, 0FFFFE890h
		push	eax
		push	ecx
		call	PR_SetError
		mov	eax, [esp+8+arg_C]
		add	esp, 8
		mov	dword ptr [eax], 0
		retn
sub_10024C20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10024C90(LPVOID lpTlsValue)
sub_10024C90	proc near		; CODE XREF: sub_1001A480+215p

lpTlsValue	= dword	ptr  4

		cmp	dword_1003067C,	0
		push	ebp
		mov	ebp, TlsIndex
		push	esi
		push	edi
		jz	short loc_10024CB3
		mov	eax, large fs:2Ch
		mov	ecx, [eax+ebp*4]
		mov	edi, [ecx+8]
		jmp	short loc_10024CC2
; ---------------------------------------------------------------------------

loc_10024CB3:				; CODE XREF: sub_10024C90+10j
		mov	edx, dword_100329F0
		push	edx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	edi, eax

loc_10024CC2:				; CODE XREF: sub_10024C90+21j
		test	edi, edi
		jnz	short loc_10024CD5
		push	edi
		push	edi
		push	1
		push	edi
		call	sub_1001AF70
		add	esp, 10h
		mov	edi, eax

loc_10024CD5:				; CODE XREF: sub_10024C90+34j
		mov	esi, [esp+0Ch+lpTlsValue]
		cmp	esi, edi
		jz	loc_10024DC8
		mov	eax, [esi+144h]
		push	ebx
		push	eax		; dwErrCode
		call	ds:SetLastError
		cmp	dword_1003067C,	0
		mov	ebx, ds:TlsSetValue
		jz	short loc_10024D10
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebp*4]
		mov	[edx+8], esi
		jmp	short loc_10024D19
; ---------------------------------------------------------------------------

loc_10024D10:				; CODE XREF: sub_10024C90+6Cj
		mov	eax, dword_100329F0
		push	esi		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ebx ; TlsSetValue

loc_10024D19:				; CODE XREF: sub_10024C90+7Ej
		cmp	dword_1003067C,	0
		jz	short loc_10024D34
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+ebp*4]
		mov	[edx+0Ch], edi
		jmp	short loc_10024D3D
; ---------------------------------------------------------------------------

loc_10024D34:				; CODE XREF: sub_10024C90+90j
		mov	eax, dword_100329D8
		push	edi		; lpTlsValue
		push	eax		; dwTlsIndex
		call	ebx ; TlsSetValue

loc_10024D3D:				; CODE XREF: sub_10024C90+A2j
		mov	ecx, [esi+134h]
		push	ecx		; lpFiber
		mov	dword ptr [esi+94h], 1
		call	ds:SwitchToFiber
		cmp	dword_1003067C,	0
		pop	ebx
		jz	short loc_10024D70
		mov	edx, large fs:2Ch
		mov	eax, [edx+ebp*4]
		mov	eax, [eax+4]
		jmp	short loc_10024D7D
; ---------------------------------------------------------------------------

loc_10024D70:				; CODE XREF: sub_10024C90+CCj
		mov	ecx, dword_10032A18
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue

loc_10024D7D:				; CODE XREF: sub_10024C90+DEj
		test	eax, eax
		jz	short loc_10024D8A
		push	eax
		call	sub_10024310
		add	esp, 4

loc_10024D8A:				; CODE XREF: sub_10024C90+EFj
		cmp	dword_1003067C,	0
		jz	short loc_10024DB1
		mov	edx, large fs:2Ch
		mov	eax, [edx+ebp*4]
		mov	eax, [eax+0Ch]
		pop	edi
		pop	esi
		mov	dword ptr [eax+94h], 0
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10024DB1:				; CODE XREF: sub_10024C90+101j
		mov	ecx, dword_100329D8
		push	ecx		; dwTlsIndex
		call	ds:TlsGetValue
		mov	dword ptr [eax+94h], 0

loc_10024DC8:				; CODE XREF: sub_10024C90+4Bj
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_10024C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10024DD0	proc near		; CODE XREF: DllEntryPoint-180p
					; DllEntryPoint-138p

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		dec	eax
		jz	short loc_10024E29
		sub	eax, 2
		jnz	short loc_10024E38
		cmp	dword_10031520,	eax
		jz	short loc_10024E38
		cmp	dword_1003067C,	eax
		jz	short loc_10024E03
		mov	eax, TlsIndex
		mov	ecx, large fs:2Ch
		mov	edx, [ecx+eax*4]
		mov	eax, [edx+8]
		jmp	short loc_10024E0F
; ---------------------------------------------------------------------------

loc_10024E03:				; CODE XREF: sub_10024DD0+1Aj
		mov	eax, dword_100329F0
		push	eax		; dwTlsIndex
		call	ds:TlsGetValue

loc_10024E0F:				; CODE XREF: sub_10024DD0+31j
		test	eax, eax
		jz	short loc_10024E38
		test	byte ptr [eax+90h], 4
		jz	short loc_10024E38
		call	sub_1001B280
		mov	eax, 1
		retn	0Ch
; ---------------------------------------------------------------------------

loc_10024E29:				; CODE XREF: sub_10024DD0+5j
		xor	ecx, ecx
		cmp	[esp+arg_8], ecx
		setnz	cl
		mov	dword_1003067C,	ecx

loc_10024E38:				; CODE XREF: sub_10024DD0+Aj
					; sub_10024DD0+12j ...
		mov	eax, 1
		retn	0Ch
sub_10024DD0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10024E40	proc near		; CODE XREF: PR_GetLibraryFilePathname+D1p
					; PR_GetLibraryFilePathname+11Ap ...

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		cmp	ecx, 1E7h
		jg	loc_10024F42
		jz	loc_10024F32	; jumptable 10024F72 cases 998,1001
					; jumptable 10025019 case 10014
		lea	eax, [ecx-2]	; switch 211 cases
		cmp	eax, 0D2h
		ja	loc_10025140	; jumptable 10024E6B default case
		movzx	eax, ds:byte_10025190[eax]
		jmp	ds:off_10025150[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10024E72:				; CODE XREF: sub_10024E40+2Bj
					; sub_10024E40+1D9j
					; DATA XREF: ...
		mov	eax, 0FFFFE8B2h	; jumptable 10024E6B cases 5,19
					; jumptable 10025019 case 10013
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024E82:				; CODE XREF: sub_10024E40+2Bj
					; DATA XREF: .text:off_10025150o
		mov	eax, 0FFFFE8C9h	; jumptable 10024E6B cases 80,183
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024E92:				; CODE XREF: sub_10024E40+2Bj
					; DATA XREF: .text:off_10025150o
		mov	eax, 0FFFFE898h	; jumptable 10024E6B case 120
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024EA2:				; CODE XREF: sub_10024E40+2Bj
					; DATA XREF: .text:off_10025150o
		mov	eax, 0FFFFE8BCh	; jumptable 10024E6B cases 39,112
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024EB2:				; CODE XREF: sub_10024E40+2Bj
					; DATA XREF: .text:off_10025150o
		mov	eax, 0FFFFE8BAh	; jumptable 10024E6B cases 108,212
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024EC2:				; CODE XREF: sub_10024E40+2Bj
					; DATA XREF: .text:off_10025150o
		mov	eax, 0FFFFE8C1h	; jumptable 10024E6B case 206
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024ED2:				; CODE XREF: sub_10024E40+2Bj
					; DATA XREF: .text:off_10025150o
		mov	eax, 0FFFFE8C2h	; jumptable 10024E6B cases 2,3
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024EE2:				; CODE XREF: sub_10024E40+2Bj
					; sub_10024E40+1D9j
					; DATA XREF: ...
		mov	eax, 0FFFFE89Dh	; jumptable 10024E6B cases 87,123
					; jumptable 10025019 cases 10022,10039,10041,10042,10044
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024EF2:				; CODE XREF: sub_10024E40+2Bj
					; sub_10024E40+1D9j
					; DATA XREF: ...
		mov	eax, 0FFFFE8B7h	; jumptable 10024E6B case 64
					; jumptable 10025019 case 10054
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024F02:				; CODE XREF: sub_10024E40+2Bj
					; DATA XREF: .text:off_10025150o
		mov	eax, 0FFFFE8CDh	; jumptable 10024E6B case 18
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024F12:				; CODE XREF: sub_10024E40+2Bj
					; DATA XREF: .text:off_10025150o
		mov	eax, 0FFFFE8D0h	; jumptable 10024E6B case 32
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024F22:				; CODE XREF: sub_10024E40+2Bj
					; DATA XREF: .text:off_10025150o
		mov	eax, 0FFFFE8AEh	; jumptable 10024E6B case 4
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024F32:				; CODE XREF: sub_10024E40+10j
					; sub_10024E40+132j ...
		mov	eax, 0FFFFE893h	; jumptable 10024F72 cases 998,1001
					; jumptable 10025019 case 10014
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024F42:				; CODE XREF: sub_10024E40+Aj
		cmp	ecx, 2719h
		jg	loc_10025003
		jz	short loc_10024F89 ; jumptable 10024E6B	case 6
					; jumptable 10024F72 case 1006
		cmp	ecx, 570h
		jg	short loc_10024FA9
		jz	short loc_10024F79 ; jumptable 10024E6B	cases 21,110,132,148
					; jumptable 10024F72 case 1127
		lea	eax, [ecx-3E3h]	; switch 133 cases
		cmp	eax, 84h
		ja	loc_10025140	; jumptable 10024E6B default case
		movzx	edx, ds:byte_10025278[eax]
		jmp	ds:off_10025264[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10024F79:				; CODE XREF: sub_10024E40+2Bj
					; sub_10024E40+118j ...
		mov	eax, 0FFFFE899h	; jumptable 10024E6B cases 21,110,132,148
					; jumptable 10024F72 case 1127
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024F89:				; CODE XREF: sub_10024E40+2Bj
					; sub_10024E40+10Ej ...
		mov	eax, 0FFFFE891h	; jumptable 10024E6B case 6
					; jumptable 10024F72 case 1006
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024F99:				; CODE XREF: sub_10024E40+132j
					; DATA XREF: .text:off_10025264o
		mov	eax, 0FFFFE8D1h	; jumptable 10024F72 case 995
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024FA9:				; CODE XREF: sub_10024E40+116j
		cmp	ecx, 718h
		jg	short loc_10024FE7
		jz	short loc_10024FD7
		cmp	ecx, 571h
		jz	short loc_10024F79 ; jumptable 10024E6B	cases 21,110,132,148
					; jumptable 10024F72 case 1127
		cmp	ecx, 6F8h
		jnz	loc_10025140	; jumptable 10024E6B default case

loc_10024FC7:				; CODE XREF: sub_10024E40+2Bj
					; sub_10024E40+1D9j
					; DATA XREF: ...
		mov	eax, 0FFFFE8AAh	; jumptable 10024E6B cases 8,14
					; jumptable 10025019 case 10055
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024FD7:				; CODE XREF: sub_10024E40+171j
		mov	eax, 0FFFFE890h
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10024FE7:				; CODE XREF: sub_10024E40+16Fj
		cmp	ecx, 961h
		jnz	loc_10025140	; jumptable 10024E6B default case
		mov	eax, 0FFFFE899h
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025003:				; CODE XREF: sub_10024E40+108j
		lea	eax, [ecx-271Dh] ; switch 53 cases
		cmp	eax, 34h
		ja	loc_10025140	; jumptable 10024E6B default case
		movzx	eax, ds:byte_10025360[eax]
		jmp	ds:off_10025300[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10025020:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8A2h	; jumptable 10025019 case 10048
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025030:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE89Eh	; jumptable 10025019 case 10049
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025040:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE89Fh	; jumptable 10025019 case 10047
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025050:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8D3h	; jumptable 10025019 case 10037
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025060:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8D8h	; jumptable 10025019 cases 10052,10053,10060
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025070:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8A3h	; jumptable 10025019 case 10061
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025080:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8D9h	; jumptable 10025019 case 10065
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025090:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8A0h	; jumptable 10025019 case 10056
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100250A0:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8ADh	; jumptable 10025019 case 10024
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100250B0:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8B6h	; jumptable 10025019 case 10040
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100250C0:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8D6h	; jumptable 10025019 case 10050
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100250D0:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8A4h	; jumptable 10025019 case 10051
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100250E0:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8A6h	; jumptable 10025019 case 10057
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100250F0:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8AFh	; jumptable 10025019 case 10038
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025100:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8B3h	; jumptable 10025019 case 10045
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025110:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8B4h	; jumptable 10025019 case 10043
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025120:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE8D7h	; jumptable 10025019 case 10058
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025130:				; CODE XREF: sub_10024E40+1D9j
					; DATA XREF: .text:off_10025300o
		mov	eax, 0FFFFE892h	; jumptable 10025019 case 10035
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025140:				; CODE XREF: sub_10024E40+1Ej
					; sub_10024E40+2Bj ...
		mov	eax, 0FFFFE896h	; jumptable 10024E6B default case
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
sub_10024E40	endp

; ---------------------------------------------------------------------------
off_10025150	dd offset loc_10024ED2,	offset loc_10024F22, offset loc_10024E72
					; DATA XREF: sub_10024E40+2Br
		dd offset loc_10024F89,	offset loc_10024FC7, offset loc_10024F02 ; jump	table for switch statement
		dd offset loc_10024F79,	offset loc_10024F12, offset loc_10024EA2
		dd offset loc_10024EF2,	offset loc_10024E82, offset loc_10024EE2
		dd offset loc_10024EB2,	offset loc_10024E92, offset loc_10024EC2
		dd offset loc_10025140
byte_10025190	db 0, 0, 1, 2, 3, 0Fh, 4, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 4, 0Fh
					; DATA XREF: sub_10024E40+24r
		db 0Fh,	0Fh, 5,	2, 0Fh,	6, 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh	; indirect table for switch statement
		db 0Fh,	0Fh, 0Fh, 0Fh, 7, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh
		db 8, 0Fh, 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 9, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Ah,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Bh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Ch, 0Fh, 6, 0Fh, 8, 0Fh, 0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Dh, 0Fh, 0Fh, 0Bh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 6, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	6, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Ah,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh,	0Fh, 0Fh
		db 0Fh,	0Eh, 0Fh, 0Fh, 0Fh, 0Fh, 0Fh, 0Ch
		align 4
off_10025264	dd offset loc_10024F99,	offset loc_10024F32, offset loc_10024F89
					; DATA XREF: sub_10024E40+132r
		dd offset loc_10024F79,	offset loc_10025140 ; jump table for switch statement
byte_10025278	db	0,     4,     4,     1 ; DATA XREF: sub_10024E40+12Br
		db	4,     4,     1,     4 ; indirect table	for switch statement
		db	4,     4,     4,     2
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	4,     4,     4,     4
		db	3
		align 10h
off_10025300	dd offset loc_10024E72,	offset loc_10024F32, offset loc_10024EE2
					; DATA XREF: sub_10024E40+1D9r
		dd offset loc_100250A0,	offset loc_10025130, offset loc_10025050 ; jump	table for switch statement
		dd offset loc_100250F0,	offset loc_100250B0, offset loc_10025110
		dd offset loc_10025100,	offset loc_10025040, offset loc_10025020
		dd offset loc_10025030,	offset loc_100250C0, offset loc_100250D0
		dd offset loc_10025060,	offset loc_10024EF2, offset loc_10024FC7
		dd offset loc_10025090,	offset loc_100250E0, offset loc_10025120
		dd offset loc_10025070,	offset loc_10025080, offset loc_10025140
byte_10025360	db	0,     1,   17h,   17h ; DATA XREF: sub_10024E40+1D2r
		db    17h,   17h,   17h,   17h ; indirect table	for switch statement
		db    17h,     2,   17h,     3
		db    17h,   17h,   17h,   17h
		db    17h,   17h,   17h,   17h
		db    17h,   17h,     4,   17h
		db	5,     6,     2,     7
		db	2,     2,     8,     2
		db	9,   17h,   0Ah,   0Bh
		db    0Ch,   0Dh,   0Eh,   0Fh
		db    0Fh,   10h,   11h,   12h
		db    13h,   14h,   17h,   0Fh
		db    15h,   17h,   17h,   17h
		db    16h
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100253A0	proc near		; CODE XREF: PR_Stat_0+149p
					; sub_10021B40+7Fp

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, ecx
		sub	eax, 2
		jz	short loc_100253D0
		sub	eax, 0Bh
		jz	short loc_100253C0
		mov	eax, 0FFFFE896h
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100253C0:				; CODE XREF: sub_100253A0+Ej
		mov	eax, 0FFFFE8B2h
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100253D0:				; CODE XREF: sub_100253A0+9j
		mov	eax, 0FFFFE8C2h
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
sub_100253A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_100253E0	proc near		; CODE XREF: PR_AddWaitFileDesc+230p
					; PR_WaitRecvReady+1B4p ...
		jmp	sub_10024E40
sub_100253E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100253F0	proc near		; CODE XREF: sub_10022FD0+173p
					; sub_10023340+17Bp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 2738h
		jz	short loc_10025404
		mov	[esp+arg_0], eax
		jmp	sub_10024E40
; ---------------------------------------------------------------------------

loc_10025404:				; CODE XREF: sub_100253F0+9j
		push	2738h
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		retn
sub_100253F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10025420	proc near		; CODE XREF: sub_1001FFA0+26p
					; sub_100229A0+E4p ...

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, ecx
		sub	eax, 2726h
		jz	short loc_1002544B
		sub	eax, 17h
		jz	short loc_1002543B
		mov	[esp+arg_0], ecx
		jmp	sub_10024E40
; ---------------------------------------------------------------------------

loc_1002543B:				; CODE XREF: sub_10025420+10j
		mov	eax, 0FFFFE8B0h
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_1002544B:				; CODE XREF: sub_10025420+Bj
		mov	eax, 0FFFFE8D5h
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
sub_10025420	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10025460	proc near		; CODE XREF: sub_10014F20+88p
					; sub_1001E190+6Cp ...

arg_0		= dword	ptr  4

		mov	ecx, [esp+arg_0]
		mov	eax, ecx
		sub	eax, 2726h
		jz	short loc_100254A0
		sub	eax, 0Dh
		jz	short loc_10025490
		sub	eax, 19h
		jz	short loc_10025480
		mov	[esp+arg_0], ecx
		jmp	sub_10024E40
; ---------------------------------------------------------------------------

loc_10025480:				; CODE XREF: sub_10025460+15j
		mov	eax, 0FFFFE89Ah
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_10025490:				; CODE XREF: sub_10025460+10j
		mov	eax, 0FFFFE8D2h
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
; ---------------------------------------------------------------------------

loc_100254A0:				; CODE XREF: sub_10025460+Bj
		mov	eax, 0FFFFE8D3h
		push	ecx
		push	eax
		call	PR_SetError
		add	esp, 8
		retn
sub_10025460	endp


; =============== S U B	R O U T	I N E =======================================


sub_100254B0	proc near		; CODE XREF: sub_1001E2A0+2Ap

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 2726h
		jz	short loc_100254C4
		mov	[esp+arg_0], eax
		jmp	sub_10024E40
; ---------------------------------------------------------------------------

loc_100254C4:				; CODE XREF: sub_100254B0+9j
		push	2726h
		push	0FFFFE8B1h
		call	PR_SetError
		add	esp, 8
		retn
sub_100254B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_100254E0	proc near		; CODE XREF: sub_10020020+30p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 2726h
		jz	short loc_100254F4
		mov	[esp+arg_0], eax
		jmp	sub_10024E40
; ---------------------------------------------------------------------------

loc_100254F4:				; CODE XREF: sub_100254E0+9j
		push	2726h
		push	0FFFFE8D5h
		call	PR_SetError
		add	esp, 8
		retn
sub_100254E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10025510	proc near		; CODE XREF: sub_100229A0+D1p
					; sub_100229A0+236p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, 2736h
		jz	short loc_10025524
		mov	[esp+arg_0], eax
		jmp	sub_10024E40
; ---------------------------------------------------------------------------

loc_10025524:				; CODE XREF: sub_10025510+9j
		push	2736h
		push	0FFFFE891h
		call	PR_SetError
		add	esp, 8
		retn
sub_10025510	endp

; ---------------------------------------------------------------------------
		align 10h

loc_10025540:				; DATA XREF: sub_10025570+2Ao
		push	esi
		mov	esi, [esp+8]
		mov	eax, [esi+4]
		mov	ecx, [esi]
		push	eax
		push	ecx
		call	ds:WaitForSingleObject
		mov	[esi+8], eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10025563
		call	ds:GetLastError
		mov	[esi+0Ch], eax

loc_10025563:				; CODE XREF: .text:10025558j
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10025570	proc near		; CODE XREF: PR_WaitSemaphore_0+Bp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
dwErrCode	= dword	ptr -4

		sub	esp, 10h
		call	PR_AssertCurrentThreadOwnsLock_0
		test	byte ptr [eax+90h], 80h
		jz	short loc_1002558D
		push	esi		; dwMilliseconds
		push	edi		; hHandle
		call	ds:WaitForSingleObject
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_1002558D:				; CODE XREF: sub_10025570+Fj
		push	0
		push	0
		push	1
		push	1
		lea	eax, [esp+20h+var_10]
		push	eax
		push	offset loc_10025540
		push	0
		mov	[esp+2Ch+var_10], edi
		mov	[esp+2Ch+var_C], esi
		call	PR_CreateThread
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_100255BC

loc_100255B5:				; CODE XREF: sub_10025570+58j
		or	eax, 0FFFFFFFFh
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_100255BC:				; CODE XREF: sub_10025570+43j
		push	eax
		call	PR_JoinThread
		add	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	short loc_100255B5
		cmp	[esp+10h+var_8], 0FFFFFFFFh
		jnz	short loc_100255DC
		mov	ecx, [esp+10h+dwErrCode]
		push	ecx		; dwErrCode
		call	ds:SetLastError

loc_100255DC:				; CODE XREF: sub_10025570+5Fj
		mov	eax, [esp+10h+var_8]
		add	esp, 10h
		retn
sub_10025570	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100255F0(LPCSTR lpName, char,	int, LONG lInitialCount)
sub_100255F0	proc near		; CODE XREF: PR_OpenSemaphore+68p

Memory		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
lpName		= dword	ptr  4
arg_4		= byte ptr  8
arg_8		= dword	ptr  0Ch
lInitialCount	= dword	ptr  10h

		sub	esp, 14h
		push	esi
		push	edi
		xor	edi, edi
		push	4		; Size
		mov	[esp+20h+Memory], edi
		mov	[esp+20h+var_10], edi
		call	PR_Malloc
		mov	esi, eax
		add	esp, 4
		test	esi, esi
		jnz	short loc_10025625
		push	eax
		push	0FFFFE890h
		call	PR_SetError
		add	esp, 8
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10025625:				; CODE XREF: sub_100255F0+1Dj
		push	ebx
		mov	bl, [esp+20h+arg_4]
		test	bl, 1
		jz	loc_100256FF
		mov	edx, [esp+20h+arg_8]
		lea	eax, [esp+20h+var_10]
		push	eax
		lea	ecx, [esp+24h+Memory]
		push	ecx
		push	offset dword_10030680
		push	edx
		call	sub_1001CFE0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1002566B
		mov	eax, [esp+20h+Memory]
		mov	[esp+20h+var_4], edi
		mov	[esp+20h+var_C], 0Ch
		mov	[esp+20h+var_8], eax
		lea	edi, [esp+20h+var_C]

loc_1002566B:				; CODE XREF: sub_100255F0+61j
		mov	ecx, [esp+20h+lpName]
		mov	edx, [esp+20h+lInitialCount]
		push	ecx		; lpName
		push	7FFFFFFFh	; lMaximumCount
		push	edx		; lInitialCount
		push	edi		; lpSemaphoreAttributes
		call	ds:CreateSemaphoreA
		mov	[esi], eax
		test	edi, edi
		jz	short loc_10025699
		mov	eax, [esp+20h+var_10]
		mov	ecx, [esp+20h+Memory]
		push	eax		; void *
		push	ecx		; Memory
		call	sub_1001D230
		add	esp, 8

loc_10025699:				; CODE XREF: sub_100255F0+95j
		cmp	dword ptr [esi], 0
		jnz	short loc_100256BC
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		push	esi		; Memory
		call	PR_Free
		add	esp, 8
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100256BC:				; CODE XREF: sub_100255F0+ACj
		test	bl, 2
		jz	loc_10025761
		call	ds:GetLastError
		cmp	eax, 0B7h
		jnz	loc_10025761
		push	eax
		push	0FFFFE8C9h
		call	PR_SetError
		mov	edx, [esi]
		add	esp, 8
		push	edx		; hObject
		call	ds:CloseHandle
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_100256FF:				; CODE XREF: sub_100255F0+3Dj
		mov	eax, [esp+20h+lpName]
		push	eax		; lpName
		push	0		; bInheritHandle
		push	100002h		; dwDesiredAccess
		call	ds:OpenSemaphoreA
		mov	[esi], eax
		test	eax, eax
		jnz	short loc_10025761
		mov	edi, ds:GetLastError
		call	edi ; GetLastError
		cmp	eax, 7Bh
		jnz	short loc_10025744
		push	eax
		push	0FFFFE8C2h
		call	PR_SetError
		add	esp, 8
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10025744:				; CODE XREF: sub_100255F0+132j
		call	edi ; GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	ebx
		pop	edi
		xor	eax, eax
		pop	esi
		add	esp, 14h
		retn
; ---------------------------------------------------------------------------

loc_10025761:				; CODE XREF: sub_100255F0+CFj
					; sub_100255F0+E0j ...
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		add	esp, 14h
		retn
sub_100255F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_WaitSemaphore_0 proc	near		; CODE XREF: PR_WaitSemaphorej

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		push	edi
		mov	edi, [eax]
		or	esi, 0FFFFFFFFh
		call	sub_10025570
		pop	edi
		pop	esi
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1002579A
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_1002579A:				; CODE XREF: PR_WaitSemaphore_0+15j
		test	eax, eax
		jz	short loc_100257B1
		push	0
		push	0FFFFE896h
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100257B1:				; CODE XREF: PR_WaitSemaphore_0+2Cj
		xor	eax, eax
		retn
PR_WaitSemaphore_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_PostSemaphore_0 proc	near		; CODE XREF: PR_PostSemaphorej

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax]
		push	0		; lpPreviousCount
		push	1		; lReleaseCount
		push	ecx		; hSemaphore
		call	ds:ReleaseSemaphore
		test	eax, eax
		jnz	short loc_100257E8
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		or	eax, 0FFFFFFFFh
		retn
; ---------------------------------------------------------------------------

loc_100257E8:				; CODE XREF: PR_PostSemaphore_0+13j
		xor	eax, eax
		retn
PR_PostSemaphore_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_CloseSemaphore_0(void *Memory)
PR_CloseSemaphore_0 proc near		; CODE XREF: PR_CloseSemaphorej

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi]
		push	eax		; hObject
		call	ds:CloseHandle
		test	eax, eax
		jnz	short loc_10025816
		call	ds:GetLastError
		push	eax
		call	sub_100253E0
		add	esp, 4
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10025816:				; CODE XREF: PR_CloseSemaphore_0+10j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
PR_CloseSemaphore_0 endp

; ---------------------------------------------------------------------------
		align 10h

loc_10025830:				; DATA XREF: sub_10025860+58o
		push	esi
		mov	esi, [esp+8]
		mov	eax, [esi+14h]
		mov	ecx, [esi+10h]
		mov	edx, [esi+0Ch]
		push	eax
		mov	eax, [esi+8]
		push	ecx
		push	edx
		push	eax
		push	0
		call	select
		mov	[esi], eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1002585B
		call	WSAGetLastError
		mov	[esi+4], eax

loc_1002585B:				; CODE XREF: .text:10025851j
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10025860(int nfds, fd_set *readfds, fd_set *writefds,	fd_set *exceptfds, struct timeval *timeout)
sub_10025860	proc near		; CODE XREF: sub_100229A0+B4p
					; sub_100229A0+1F8p ...

var_18		= dword	ptr -18h
iError		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
nfds		= dword	ptr  4
readfds		= dword	ptr  8
writefds	= dword	ptr  0Ch
exceptfds	= dword	ptr  10h
timeout		= dword	ptr  14h

		sub	esp, 18h
		push	esi
		call	PR_AssertCurrentThreadOwnsLock_0
		test	byte ptr [eax+90h], 80h
		mov	ecx, [esp+1Ch+exceptfds]
		jz	short loc_10025897
		mov	eax, [esp+1Ch+timeout]
		mov	edx, [esp+1Ch+writefds]
		push	eax		; timeout
		mov	eax, [esp+20h+readfds]
		push	ecx		; exceptfds
		mov	ecx, [esp+24h+nfds]
		push	edx		; writefds
		push	eax		; readfds
		push	ecx		; nfds
		call	select
		mov	esi, eax
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_10025897:				; CODE XREF: sub_10025860+14j
		mov	eax, [esp+1Ch+writefds]
		mov	edx, [esp+1Ch+readfds]
		xor	esi, esi
		push	esi
		push	esi
		push	1
		mov	[esp+28h+var_C], eax
		push	1
		lea	eax, [esp+2Ch+var_18]
		push	eax
		mov	[esp+30h+var_10], edx
		mov	edx, [esp+30h+timeout]
		push	offset loc_10025830
		push	esi
		mov	[esp+38h+var_18], esi
		mov	[esp+38h+iError], esi
		mov	[esp+38h+var_8], ecx
		mov	[esp+38h+var_4], edx
		call	PR_CreateThread
		add	esp, 1Ch
		cmp	eax, esi
		jnz	short loc_100258E2
		or	eax, 0FFFFFFFFh
		pop	esi
		add	esp, 18h
		retn
; ---------------------------------------------------------------------------

loc_100258E2:				; CODE XREF: sub_10025860+78j
		push	eax
		call	PR_JoinThread
		mov	eax, [esp+20h+var_18]
		add	esp, 4
		mov	esi, eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10025900
		mov	ecx, [esp+1Ch+iError]
		push	ecx		; iError
		call	WSASetLastError

loc_10025900:				; CODE XREF: sub_10025860+94j
		mov	eax, esi
		pop	esi
		add	esp, 18h
		retn
sub_10025860	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_Poll_0	proc near		; CODE XREF: PR_Pollj

var_3040	= dword	ptr -3040h
var_303C	= dword	ptr -303Ch
var_3038	= dword	ptr -3038h
var_3034	= dword	ptr -3034h
var_3030	= dword	ptr -3030h
var_302C	= dword	ptr -302Ch
optlen		= dword	ptr -3028h
optval		= byte ptr -3024h
var_3020	= dword	ptr -3020h
var_301C	= dword	ptr -301Ch
timeout		= timeval ptr -3018h
var_3010	= fd_set ptr -3010h
var_200C	= fd_set ptr -200Ch
var_1008	= fd_set ptr -1008h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, 3040h
		call	__alloca_probe
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3040h+var_4], eax
		push	ebp
		mov	ebp, [esp+3044h+arg_0]
		mov	dword ptr [esp+3044h+optval], ebp
		call	PR_AssertCurrentThreadOwnsLock_0
		mov	ecx, [eax+90h]
		xor	edx, edx
		mov	[esp+3044h+optlen], edx
		test	ecx, 1000h
		jnz	short loc_10025982
		test	cl, 2
		jz	short loc_10025982
		push	edx
		and	ecx, 0FFFFFFFDh
		push	0FFFFE897h
		mov	[eax+90h], ecx
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh
		pop	ebp
		mov	ecx, [esp+3040h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3040h
		retn
; ---------------------------------------------------------------------------

loc_10025982:				; CODE XREF: PR_Poll_0+3Bj
					; PR_Poll_0+40j
		mov	eax, [esp+3044h+arg_4]
		cmp	eax, edx
		jnz	short loc_100259B5
		mov	eax, [esp+3044h+arg_8]
		push	eax
		call	PR_Sleep
		add	esp, 4
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+3040h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3040h
		retn
; ---------------------------------------------------------------------------

loc_100259B5:				; CODE XREF: PR_Poll_0+7Bj
		push	ebx
		lea	eax, [ebp+eax*8+0]
		push	esi
		push	edi
		mov	[esp+3050h+var_3030], edx
		mov	[esp+3050h+var_303C], edx
		mov	[esp+3050h+var_3038], edx
		mov	[esp+3050h+var_200C.fd_count], edx
		mov	[esp+3050h+var_3010.fd_count], edx
		mov	[esp+3050h+var_1008.fd_count], edx
		mov	[esp+3050h+var_3040], edx
		mov	[esp+3050h+var_302C], eax
		cmp	ebp, eax
		jnb	loc_10025C3C
		lea	esi, [ebp+6]
		jmp	short loc_100259F2
; ---------------------------------------------------------------------------
		align 10h

loc_100259F0:				; CODE XREF: PR_Poll_0+2F7j
		xor	edx, edx

loc_100259F2:				; CODE XREF: PR_Poll_0+DDj
		mov	eax, [esi-6]
		xor	ebx, ebx
		mov	[esp+3050h+var_3020], edx
		mov	[esp+3050h+var_3034], edx
		mov	[esp+3050h+var_301C], edx
		cmp	eax, edx
		jz	loc_10025BF8
		movzx	ecx, word ptr [esi-2]
		xor	edi, edi
		cmp	di, cx
		jz	loc_10025BF8
		test	cl, 1
		jz	short loc_10025A3A
		mov	edx, [eax]
		lea	edi, [esp+3050h+var_3034]
		push	edi
		and	ecx, 0FFFFFFFDh
		push	ecx
		push	eax
		mov	eax, [edx+54h]
		call	eax
		mov	edx, [esp+305Ch+var_301C]
		add	esp, 0Ch
		movzx	ebx, ax

loc_10025A3A:				; CODE XREF: PR_Poll_0+10Dj
		movzx	ecx, word ptr [esi-2]
		test	cl, 2
		jz	short loc_10025A65
		mov	eax, [esi-6]
		mov	edx, [eax]
		lea	edi, [esp+3050h+var_301C]
		push	edi
		and	ecx, 0FFFFFFFEh
		push	ecx
		push	eax
		mov	eax, [edx+54h]
		call	eax
		mov	edx, [esp+305Ch+var_301C]
		movzx	ecx, ax
		add	esp, 0Ch
		mov	[esp+3050h+var_3020], ecx

loc_10025A65:				; CODE XREF: PR_Poll_0+131j
		mov	edi, [esp+3050h+var_3034]
		mov	eax, edi
		and	eax, ebx
		xor	ecx, ecx
		cmp	cx, ax
		jnz	loc_10025BCB
		mov	eax, edx
		and	eax, [esp+3050h+var_3020]
		cmp	cx, ax
		jnz	loc_10025BCB
		mov	eax, [esi-6]
		xor	edx, edx
		push	edx
		push	eax
		mov	[esi], dx
		call	PR_GetIdentitiesLayer
		add	esp, 8
		test	eax, eax
		jz	loc_10025B9B
		mov	eax, [eax+4]
		cmp	dword ptr [eax], 0AAAAAAAAh
		jnz	loc_10025B9B
		cmp	[esp+3050h+var_3040], 0
		jnz	loc_10025BFD
		mov	edi, [eax+28h]
		mov	ecx, [esp+3050h+var_200C.fd_count]
		test	bl, 1
		jz	short loc_10025AF0
		or	word ptr [esi],	1
		cmp	ecx, 400h
		jnb	short loc_10025AEC
		mov	[esp+ecx*4+3050h+var_200C.fd_array], edi
		mov	ecx, [esp+3050h+var_200C.fd_count]
		inc	ecx
		mov	[esp+3050h+var_200C.fd_count], ecx

loc_10025AEC:				; CODE XREF: PR_Poll_0+1C4j
		inc	[esp+3050h+var_3038]

loc_10025AF0:				; CODE XREF: PR_Poll_0+1B8j
		mov	eax, [esp+3050h+var_3010.fd_count]
		test	bl, 2
		jz	short loc_10025B15
		or	word ptr [esi],	2
		cmp	eax, 400h
		jnb	short loc_10025B11
		mov	[esp+eax*4+3050h+var_3010.fd_array], edi
		mov	eax, [esp+3050h+var_3010.fd_count]
		inc	eax
		mov	[esp+3050h+var_3010.fd_count], eax

loc_10025B11:				; CODE XREF: PR_Poll_0+1F2j
		inc	[esp+3050h+var_303C]

loc_10025B15:				; CODE XREF: PR_Poll_0+1E7j
		mov	dl, byte ptr [esp+3050h+var_3020]
		test	dl, 1
		jz	short loc_10025B4E
		or	word ptr [esi],	4
		cmp	ecx, 400h
		jnb	short loc_10025B43
		mov	[esp+ecx*4+3050h+var_200C.fd_array], edi
		mov	ecx, 1
		add	[esp+3050h+var_200C.fd_count], ecx
		add	[esp+3050h+var_3038], ecx
		jmp	short loc_10025B53
; ---------------------------------------------------------------------------

loc_10025B43:				; CODE XREF: PR_Poll_0+218j
		mov	ecx, 1
		add	[esp+3050h+var_3038], ecx
		jmp	short loc_10025B53
; ---------------------------------------------------------------------------

loc_10025B4E:				; CODE XREF: PR_Poll_0+20Cj
		mov	ecx, 1

loc_10025B53:				; CODE XREF: PR_Poll_0+231j
					; PR_Poll_0+23Cj
		test	dl, 2
		jz	short loc_10025B6F
		or	word ptr [esi],	8
		cmp	eax, 400h
		jnb	short loc_10025B6B
		mov	[esp+eax*4+3050h+var_3010.fd_array], edi
		add	[esp+3050h+var_3010.fd_count], ecx

loc_10025B6B:				; CODE XREF: PR_Poll_0+251j
		add	[esp+3050h+var_303C], ecx

loc_10025B6F:				; CODE XREF: PR_Poll_0+246j
		test	byte ptr [esi-2], 4
		jz	loc_10025BFD
		mov	eax, [esp+3050h+var_1008.fd_count]
		cmp	eax, 400h
		jnb	short loc_10025B95
		mov	[esp+eax*4+3050h+var_1008.fd_array], edi
		inc	[esp+3050h+var_1008.fd_count]

loc_10025B95:				; CODE XREF: PR_Poll_0+275j
		inc	[esp+3050h+var_3030]
		jmp	short loc_10025BFD
; ---------------------------------------------------------------------------

loc_10025B9B:				; CODE XREF: PR_Poll_0+18Bj
					; PR_Poll_0+19Aj
		cmp	[esp+3050h+var_3040], 0
		jnz	short loc_10025BBD
		lea	ecx, [esi-6]
		mov	eax, ebp
		cmp	ebp, ecx
		jnb	short loc_10025BBD
		jmp	short loc_10025BB0
; ---------------------------------------------------------------------------
		align 10h

loc_10025BB0:				; CODE XREF: PR_Poll_0+29Bj
					; PR_Poll_0+2ABj
		xor	edx, edx
		mov	[eax+6], dx
		add	eax, 8
		cmp	eax, ecx
		jb	short loc_10025BB0

loc_10025BBD:				; CODE XREF: PR_Poll_0+290j
					; PR_Poll_0+299j
		inc	[esp+3050h+var_3040]
		mov	eax, 10h
		mov	[esi], ax
		jmp	short loc_10025BFD
; ---------------------------------------------------------------------------

loc_10025BCB:				; CODE XREF: PR_Poll_0+162j
					; PR_Poll_0+171j
		cmp	[esp+3050h+var_3040], 0
		jnz	short loc_10025BED
		lea	ecx, [esi-6]
		mov	eax, ebp
		cmp	ebp, ecx
		jnb	short loc_10025BED
		jmp	short loc_10025BE0
; ---------------------------------------------------------------------------
		align 10h

loc_10025BE0:				; CODE XREF: PR_Poll_0+2CBj
					; PR_Poll_0+2DBj
		xor	ebx, ebx
		mov	[eax+6], bx
		add	eax, 8
		cmp	eax, ecx
		jb	short loc_10025BE0

loc_10025BED:				; CODE XREF: PR_Poll_0+2C0j
					; PR_Poll_0+2C9j
		inc	[esp+3050h+var_3040]
		or	edx, edi
		mov	[esi], dx
		jmp	short loc_10025BFD
; ---------------------------------------------------------------------------

loc_10025BF8:				; CODE XREF: PR_Poll_0+F5j
					; PR_Poll_0+104j
		xor	ecx, ecx
		mov	[esi], cx

loc_10025BFD:				; CODE XREF: PR_Poll_0+1A5j
					; PR_Poll_0+263j ...
		add	esi, 8
		lea	edx, [esi-6]
		cmp	edx, [esp+3050h+var_302C]
		jb	loc_100259F0
		mov	eax, [esp+3050h+var_3040]
		test	eax, eax
		jnz	loc_10025E46
		mov	eax, 400h
		cmp	[esp+3050h+var_3038], eax
		jg	loc_10025E34
		cmp	[esp+3050h+var_303C], eax
		jg	loc_10025E34
		cmp	[esp+3050h+var_3030], eax
		jg	loc_10025E34

loc_10025C3C:				; CODE XREF: PR_Poll_0+D4j
		mov	esi, [esp+3050h+var_3038]
		mov	edi, [esp+3050h+var_303C]
		mov	ebp, [esp+3050h+var_3030]
		neg	esi
		sbb	esi, esi
		neg	edi
		sbb	edi, edi
		lea	ecx, [esp+3050h+var_3010]
		and	edi, ecx
		neg	ebp
		sbb	ebp, ebp
		lea	edx, [esp+3050h+var_1008]
		lea	eax, [esp+3050h+var_200C]
		and	ebp, edx
		and	esi, eax
		jnz	short loc_10025C8D
		test	edi, edi
		jnz	short loc_10025C8D
		test	ebp, ebp
		jnz	short loc_10025C8D
		mov	eax, [esp+3050h+arg_8]
		push	eax
		call	PR_Sleep
		add	esp, 4
		xor	eax, eax
		jmp	loc_10025E46
; ---------------------------------------------------------------------------

loc_10025C8D:				; CODE XREF: PR_Poll_0+35Cj
					; PR_Poll_0+360j ...
		mov	ebx, [esp+3050h+arg_8]
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_10025CBD
		call	PR_TicksPerSecond
		mov	ecx, eax
		xor	edx, edx
		mov	eax, ebx
		div	ecx
		push	edx
		mov	[esp+3054h+timeout.tv_sec], eax
		call	PR_IntervalToMicroseconds
		mov	[esp+3054h+timeout.tv_usec], eax
		add	esp, 4
		lea	eax, [esp+3050h+timeout]
		jmp	short loc_10025CC1
; ---------------------------------------------------------------------------

loc_10025CBD:				; CODE XREF: PR_Poll_0+387j
		mov	eax, [esp+3050h+optlen]

loc_10025CC1:				; CODE XREF: PR_Poll_0+3ABj
		push	eax		; timeout
		push	ebp		; exceptfds
		push	edi		; writefds
		push	esi		; readfds
		push	0		; nfds
		call	sub_10025860
		mov	ebp, eax
		add	esp, 14h
		test	ebp, ebp
		jle	loc_10025D98
		mov	ecx, dword ptr [esp+3050h+optval]
		mov	eax, [esp+3050h+var_302C]
		xor	ebp, ebp
		cmp	ecx, eax
		jnb	loc_10025E30
		sub	eax, ecx
		dec	eax
		shr	eax, 3
		inc	eax
		lea	edi, [ecx+6]
		mov	[esp+3050h+var_3034], eax
		lea	esp, [esp+0]

loc_10025D00:				; CODE XREF: PR_Poll_0+47Bj
		mov	eax, [edi-6]
		xor	esi, esi
		test	eax, eax
		jz	short loc_10025D7B
		xor	ecx, ecx
		cmp	cx, [edi-2]
		jz	short loc_10025D7B
		push	ecx
		push	eax
		call	PR_GetIdentitiesLayer
		mov	edx, [eax+4]
		mov	ebx, [edx+28h]
		add	esp, 8
		lea	eax, [esp+3050h+var_200C]
		push	eax		; fd_set *
		push	ebx		; fd
		call	__WSAFDIsSet
		test	eax, eax
		jz	short loc_10025D46
		movzx	eax, word ptr [edi]
		test	al, 1
		jz	short loc_10025D3F
		mov	esi, 1

loc_10025D3F:				; CODE XREF: PR_Poll_0+428j
		test	al, 4
		jz	short loc_10025D46
		or	esi, 2

loc_10025D46:				; CODE XREF: PR_Poll_0+421j
					; PR_Poll_0+431j
		lea	ecx, [esp+3050h+var_3010]
		push	ecx		; fd_set *
		push	ebx		; fd
		call	__WSAFDIsSet
		test	eax, eax
		jz	short loc_10025D66
		movzx	eax, word ptr [edi]
		test	al, 2
		jz	short loc_10025D5F
		or	esi, 1

loc_10025D5F:				; CODE XREF: PR_Poll_0+44Aj
		test	al, 8
		jz	short loc_10025D66
		or	esi, 2

loc_10025D66:				; CODE XREF: PR_Poll_0+443j
					; PR_Poll_0+451j
		lea	edx, [esp+3050h+var_1008]
		push	edx		; fd_set *
		push	ebx		; fd
		call	__WSAFDIsSet
		test	eax, eax
		jz	short loc_10025D7B
		or	esi, 4

loc_10025D7B:				; CODE XREF: PR_Poll_0+3F7j
					; PR_Poll_0+3FFj ...
		mov	[edi], si
		test	si, si
		jz	short loc_10025D84
		inc	ebp

loc_10025D84:				; CODE XREF: PR_Poll_0+471j
		add	edi, 8
		dec	[esp+3050h+var_3034]
		jnz	loc_10025D00
		mov	eax, ebp
		jmp	loc_10025E46
; ---------------------------------------------------------------------------

loc_10025D98:				; CODE XREF: PR_Poll_0+3C3j
		cmp	ebp, 0FFFFFFFFh
		jnz	loc_10025E30
		call	WSAGetLastError
		cmp	eax, 2736h
		jnz	short loc_10025E27
		mov	esi, dword ptr [esp+3050h+optval]
		mov	edi, [esp+3050h+var_302C]
		xor	ebp, ebp
		mov	[esp+3050h+optlen], 4
		cmp	esi, edi
		jnb	short loc_10025E30

loc_10025DC3:				; CODE XREF: PR_Poll_0+511j
		xor	eax, eax
		mov	[esi+6], ax
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10025E1C
		xor	ecx, ecx
		cmp	cx, [esi+4]
		jz	short loc_10025E1C
		push	ecx
		push	eax
		call	PR_GetIdentitiesLayer
		add	esp, 8
		lea	edx, [esp+3050h+optlen]
		push	edx		; optlen
		mov	edx, [eax+4]
		mov	eax, [edx+28h]
		lea	ecx, [esp+3054h+optval]
		push	ecx		; optval
		push	1008h		; optname
		push	0FFFFh		; level
		push	eax		; s
		call	getsockopt
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10025E1C
		call	WSAGetLastError
		cmp	eax, 2736h
		jnz	short loc_10025E1C
		mov	ecx, 10h
		mov	[esi+6], cx
		inc	ebp

loc_10025E1C:				; CODE XREF: PR_Poll_0+4BDj
					; PR_Poll_0+4C5j ...
		add	esi, 8
		cmp	esi, edi
		jb	short loc_10025DC3
		mov	eax, ebp
		jmp	short loc_10025E46
; ---------------------------------------------------------------------------

loc_10025E27:				; CODE XREF: PR_Poll_0+49Bj
		push	eax
		call	sub_10025510
		add	esp, 4

loc_10025E30:				; CODE XREF: PR_Poll_0+3D5j
					; PR_Poll_0+48Bj ...
		mov	eax, ebp
		jmp	short loc_10025E46
; ---------------------------------------------------------------------------

loc_10025E34:				; CODE XREF: PR_Poll_0+312j
					; PR_Poll_0+31Cj ...
		push	0
		push	0FFFFE89Dh
		call	PR_SetError
		add	esp, 8
		or	eax, 0FFFFFFFFh

loc_10025E46:				; CODE XREF: PR_Poll_0+303j
					; PR_Poll_0+378j ...
		mov	ecx, [esp+3050h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3040h
		retn
PR_Poll_0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_GetRandomNoise_0(void *Dst, int Src)
PR_GetRandomNoise_0 proc near		; CODE XREF: PR_GetRandomNoisej

var_10		= dword	ptr -10h
Time		= dword	ptr -0Ch
PerformanceCount= LARGE_INTEGER	ptr -8
Dst		= dword	ptr  4
Src		= dword	ptr  8

		sub	esp, 10h
		push	esi
		mov	esi, [esp+14h+Src]
		test	esi, esi
		jnz	short loc_10025E73
		xor	eax, eax
		pop	esi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10025E73:				; CODE XREF: PR_GetRandomNoise_0+Aj
		lea	eax, [esp+14h+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		test	eax, eax
		jz	short loc_10025E92
		mov	ecx, dword ptr [esp+14h+PerformanceCount+4]
		mov	edx, dword ptr [esp+14h+PerformanceCount]
		mov	[esp+14h+var_10], ecx
		mov	[esp+14h+Src], edx

loc_10025E92:				; CODE XREF: PR_GetRandomNoise_0+20j
		push	edi
		mov	edi, esi
		cmp	esi, 4
		jb	short loc_10025E9F
		mov	edi, 4

loc_10025E9F:				; CODE XREF: PR_GetRandomNoise_0+38j
		push	ebp
		mov	ebp, [esp+1Ch+Dst]
		push	edi		; Size
		lea	eax, [esp+20h+Src]
		push	eax		; Src
		push	ebp		; Dst
		call	memcpy
		add	esp, 0Ch
		sub	esi, edi
		jnz	short loc_10025EC0
		pop	ebp
		mov	eax, edi
		pop	edi
		pop	esi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10025EC0:				; CODE XREF: PR_GetRandomNoise_0+55j
		push	ebx
		mov	ebx, esi
		cmp	esi, 4
		jb	short loc_10025ECD
		mov	ebx, 4

loc_10025ECD:				; CODE XREF: PR_GetRandomNoise_0+66j
		push	ebx		; Size
		lea	ecx, [esp+24h+var_10]
		push	ecx		; Src
		lea	edx, [edi+ebp]
		push	edx		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, ebx
		sub	esi, ebx
		jz	short loc_10025F13
		call	ds:GetTickCount
		mov	[esp+20h+Src], eax
		mov	ebx, esi
		cmp	esi, 4
		jb	short loc_10025EFB
		mov	ebx, 4

loc_10025EFB:				; CODE XREF: PR_GetRandomNoise_0+94j
		push	ebx		; Size
		lea	eax, [esp+24h+Src]
		push	eax		; Src
		lea	ecx, [edi+ebp]
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		add	edi, ebx
		sub	esi, ebx
		jnz	short loc_10025F1D

loc_10025F13:				; CODE XREF: PR_GetRandomNoise_0+83j
		pop	ebx
		pop	ebp
		mov	eax, edi
		pop	edi
		pop	esi
		add	esp, 10h
		retn
; ---------------------------------------------------------------------------

loc_10025F1D:				; CODE XREF: PR_GetRandomNoise_0+B1j
		lea	edx, [esp+20h+Time]
		push	edx		; Time
		call	ds:time
		add	esp, 4
		cmp	esi, 4
		jb	short loc_10025F35
		mov	esi, 4

loc_10025F35:				; CODE XREF: PR_GetRandomNoise_0+CEj
		push	esi		; Size
		lea	eax, [esp+24h+Time]
		push	eax		; Src
		lea	ecx, [edi+ebp]
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		pop	ebx
		pop	ebp
		lea	eax, [esi+edi]
		pop	edi
		pop	esi
		add	esp, 10h
		retn
PR_GetRandomNoise_0 endp

; ---------------------------------------------------------------------------
		db 1Eh dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10025F70(int,	DWORD dwMaximumSizeLow,	int, int)
sub_10025F70	proc near		; CODE XREF: PR_OpenSharedMemory:loc_10008BAEj

Memory		= dword	ptr -418h
var_414		= dword	ptr -414h
var_410		= dword	ptr -410h
var_40C		= dword	ptr -40Ch
var_408		= dword	ptr -408h
var_404		= byte ptr -404h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
dwMaximumSizeLow= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 418h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+418h+var_4], eax
		mov	eax, [esp+418h+arg_0]
		push	ebp
		push	1
		push	400h
		lea	ecx, [esp+424h+var_404]
		push	ecx
		xor	ebp, ebp
		push	eax
		mov	[esp+42Ch+Memory], ebp
		mov	[esp+42Ch+var_414], ebp
		call	sub_1000D930
		add	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10025FEF
		push	ebp
		push	0FFFFE896h
		call	PR_SetError
		mov	edx, dword_10032AA8
		add	esp, 8
		cmp	dword ptr [edx+4], 4
		jl	short loc_10025FD7
		push	offset aPr_openshare_0 ; "PR_OpenSharedMemory: name is invalid"
		call	PR_LogPrint
		add	esp, 4

loc_10025FD7:				; CODE XREF: sub_10025F70+58j
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+418h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 418h
		retn
; ---------------------------------------------------------------------------

loc_10025FEF:				; CODE XREF: sub_10025F70+3Ej
		push	esi
		push	18h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 8
		cmp	esi, ebp
		jnz	short loc_10026041
		push	ebp
		push	0FFFFE890h
		call	PR_SetError
		mov	eax, dword_10032AA8
		add	esp, 8
		cmp	dword ptr [eax+4], 4
		jl	short loc_10026028
		push	offset aPr_openshare_1 ; "PR_OpenSharedMemory: New PRSharedMemory"...
		call	PR_LogPrint
		add	esp, 4

loc_10026028:				; CODE XREF: sub_10025F70+A9j
		pop	esi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+418h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 418h
		retn
; ---------------------------------------------------------------------------

loc_10026041:				; CODE XREF: sub_10025F70+90j
		lea	eax, [esp+420h+var_404]
		lea	edx, [eax+1]

loc_10026048:				; CODE XREF: sub_10025F70+DDj
		mov	cl, [eax]
		inc	eax
		test	cl, cl
		jnz	short loc_10026048
		sub	eax, edx
		inc	eax
		push	eax		; Size
		call	PR_Malloc
		add	esp, 4
		mov	[esi], eax
		cmp	eax, ebp
		jnz	short loc_100260AA
		push	ebp
		push	0FFFFE890h
		call	PR_SetError
		mov	ecx, dword_10032AA8
		add	esp, 8
		cmp	dword ptr [ecx+4], 4
		jl	short loc_10026088
		push	offset aPr_openshare_2 ; "PR_OpenSharedMemory: New shm->ipcname	o"...
		call	PR_LogPrint
		add	esp, 4

loc_10026088:				; CODE XREF: sub_10025F70+109j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		pop	esi
		xor	eax, eax
		pop	ebp
		mov	ecx, [esp+418h+var_4]
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 418h
		retn
; ---------------------------------------------------------------------------

loc_100260AA:				; CODE XREF: sub_10025F70+EFj
		lea	ecx, [esp+420h+var_404]
		mov	edx, eax

loc_100260B0:				; CODE XREF: sub_10025F70+148j
		mov	al, [ecx]
		mov	[edx], al
		inc	ecx
		inc	edx
		test	al, al
		jnz	short loc_100260B0
		mov	eax, [esp+420h+arg_C]
		push	ebx
		mov	ebx, [esp+424h+arg_8]
		push	edi
		mov	edi, [esp+428h+dwMaximumSizeLow]
		mov	[esi+4], edi
		mov	[esi+8], eax
		mov	[esi+0Ch], ebx
		mov	dword ptr [esi+14h], 0DEADBADh
		test	bl, 1
		jz	loc_10026208
		lea	edx, [esp+428h+var_414]
		push	edx
		lea	ecx, [esp+42Ch+Memory]
		push	ecx
		push	offset dword_1003068C
		push	eax
		call	sub_1001CFE0
		add	esp, 10h
		test	eax, eax
		jnz	short loc_1002611E
		mov	edx, [esp+428h+Memory]
		mov	[esp+428h+var_408], ebp
		mov	[esp+428h+var_410], 0Ch
		mov	[esp+428h+var_40C], edx
		lea	ebp, [esp+428h+var_410]

loc_1002611E:				; CODE XREF: sub_10025F70+194j
		mov	eax, [esi]
		push	eax		; lpName
		push	edi		; dwMaximumSizeLow
		push	0		; dwMaximumSizeHigh
		mov	edi, 4
		push	edi		; flProtect
		push	ebp		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		call	ds:CreateFileMappingA
		mov	[esi+10h], eax
		test	ebp, ebp
		jz	short loc_1002614C
		mov	ecx, [esp+428h+var_414]
		mov	edx, [esp+428h+Memory]
		push	ecx		; void *
		push	edx		; Memory
		call	sub_1001D230
		add	esp, 8

loc_1002614C:				; CODE XREF: sub_10025F70+1C8j
		cmp	dword ptr [esi+10h], 0
		jnz	short loc_1002617D
		mov	eax, dword_10032AA8
		cmp	[eax+4], edi
		jl	short loc_1002616C
		mov	ecx, [esi]
		push	ecx
		push	offset aPr_openshare_3 ; "PR_OpenSharedMemory: CreateFileMapping("...
		call	PR_LogPrint
		add	esp, 8

loc_1002616C:				; CODE XREF: sub_10025F70+1EAj
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		add	esp, 4
		jmp	short loc_100261C6
; ---------------------------------------------------------------------------

loc_1002617D:				; CODE XREF: sub_10025F70+1E0j
		test	bl, 2
		jz	short loc_100261EB
		call	ds:GetLastError
		cmp	eax, 0B7h
		jnz	short loc_100261EB
		mov	edx, dword_10032AA8
		cmp	[edx+4], edi
		jl	short loc_100261AA
		mov	eax, [esi]
		push	eax
		push	offset aPr_openshare_4 ; "PR_OpenSharedMemory: Request exclusive "...
		call	PR_LogPrint
		add	esp, 8

loc_100261AA:				; CODE XREF: sub_10025F70+228j
		push	0B7h
		push	0FFFFE8C9h
		call	PR_SetError
		mov	ecx, [esi+10h]
		add	esp, 8
		push	ecx		; hObject
		call	ds:CloseHandle

loc_100261C6:				; CODE XREF: sub_10025F70+20Bj
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_100261DB
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword ptr [esi], 0

loc_100261DB:				; CODE XREF: sub_10025F70+25Aj
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		jmp	loc_10026289
; ---------------------------------------------------------------------------

loc_100261EB:				; CODE XREF: sub_10025F70+210j
					; sub_10025F70+21Dj
		mov	edx, dword_10032AA8
		cmp	[edx+4], edi
		jl	loc_10026287
		mov	eax, [esi+10h]
		mov	ecx, [esi]
		push	eax
		push	ecx
		push	offset aPr_openshare_5 ; "PR_OpenSharedMemory: CreateFileMapping("...
		jmp	short loc_1002627F
; ---------------------------------------------------------------------------

loc_10026208:				; CODE XREF: sub_10025F70+174j
		mov	edx, [esi]
		push	edx		; lpName
		push	1		; bInheritHandle
		push	2		; dwDesiredAccess
		call	ds:OpenFileMappingA
		mov	[esi+10h], eax
		test	eax, eax
		jnz	short loc_1002626A
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		mov	eax, dword_10032AA8
		add	esp, 4
		cmp	dword ptr [eax+4], 4
		jl	short loc_1002624C
		call	PR_GetOSError
		mov	ecx, [esi]
		push	eax
		push	ecx
		push	offset aPr_openshare_6 ; "PR_OpenSharedMemory: OpenFileMapping() "...
		call	PR_LogPrint
		add	esp, 0Ch

loc_1002624C:				; CODE XREF: sub_10025F70+2C4j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_1002625D
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	[esi], ebp

loc_1002625D:				; CODE XREF: sub_10025F70+2E0j
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		xor	eax, eax
		jmp	short loc_10026289
; ---------------------------------------------------------------------------

loc_1002626A:				; CODE XREF: sub_10025F70+2AAj
		mov	edx, dword_10032AA8
		cmp	dword ptr [edx+4], 4
		jl	short loc_10026287
		push	eax
		mov	eax, [esi]
		push	eax
		push	offset aPr_openshare_7 ; "PR_OpenSharedMemory: OpenFileMapping() "...

loc_1002627F:				; CODE XREF: sub_10025F70+296j
		call	PR_LogPrint
		add	esp, 0Ch

loc_10026287:				; CODE XREF: sub_10025F70+284j
					; sub_10025F70+304j
		mov	eax, esi

loc_10026289:				; CODE XREF: sub_10025F70+276j
					; sub_10025F70+2F8j
		mov	ecx, [esp+428h+var_4]
		pop	edi
		pop	ebx
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 418h
		retn
sub_10025F70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_AttachSharedMemory_0	proc near	; CODE XREF: PR_AttachSharedMemoryj

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		test	[esp+arg_4], 1
		mov	ecx, 2
		jz	short loc_100262C1
		mov	ecx, 4

loc_100262C1:				; CODE XREF: PR_AttachSharedMemory_0+Aj
		mov	eax, [esp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [eax+10h]
		push	esi
		push	edx		; dwNumberOfBytesToMap
		push	0		; dwFileOffsetLow
		push	0		; dwFileOffsetHigh
		push	ecx		; dwDesiredAccess
		push	eax		; hFileMappingObject
		call	ds:MapViewOfFile
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1002630D
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		mov	ecx, dword_10032AA8
		add	esp, 4
		cmp	dword ptr [ecx+4], 2
		jl	short loc_1002630D
		call	PR_GetOSError
		push	eax
		push	offset a_md_attachshar ; "_MD_AttachSharedMemory: MapViewOfFile()"...
		call	PR_LogPrint
		add	esp, 8

loc_1002630D:				; CODE XREF: PR_AttachSharedMemory_0+2Dj
					; PR_AttachSharedMemory_0+48j
		mov	eax, esi
		pop	esi
		retn
PR_AttachSharedMemory_0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_DetachSharedMemory_0(int, LPCVOID lpBaseAddress)
PR_DetachSharedMemory_0	proc near	; CODE XREF: PR_DetachSharedMemoryj

lpBaseAddress	= dword	ptr  8

		mov	eax, [esp+lpBaseAddress]
		push	esi
		push	eax		; lpBaseAddress
		xor	esi, esi
		call	ds:UnmapViewOfFile
		test	eax, eax
		jnz	short loc_10026365
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		mov	ecx, dword_10032AA8
		add	esp, 4
		cmp	dword ptr [ecx+4], 2
		jl	short loc_10026360
		call	PR_GetOSError
		push	eax
		push	offset a_md_detachshar ; "_MD_DetachSharedMemory: UnmapViewOfFile"...
		call	PR_LogPrint
		add	esp, 8

loc_10026360:				; CODE XREF: PR_DetachSharedMemory_0+2Bj
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10026365:				; CODE XREF: PR_DetachSharedMemory_0+10j
		mov	eax, esi
		pop	esi
		retn
PR_DetachSharedMemory_0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_CloseSharedMemory_0(void *Memory)
PR_CloseSharedMemory_0 proc near	; CODE XREF: PR_CloseSharedMemoryj

Memory		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Memory]
		mov	eax, [esi+10h]
		push	edi
		push	eax		; hObject
		xor	edi, edi
		call	ds:CloseHandle
		test	eax, eax
		jnz	short loc_100263B7
		call	ds:GetLastError
		push	eax
		call	sub_10024E40
		mov	ecx, dword_10032AA8
		add	esp, 4
		cmp	dword ptr [ecx+4], 2
		jl	short loc_100263B4
		call	PR_GetOSError
		push	eax
		push	offset a_md_closeshare ; "_MD_CloseSharedMemory: CloseHandle() fa"...
		call	PR_LogPrint
		add	esp, 8

loc_100263B4:				; CODE XREF: PR_CloseSharedMemory_0+2Fj
		or	edi, 0FFFFFFFFh

loc_100263B7:				; CODE XREF: PR_CloseSharedMemory_0+14j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_100263CC
		push	eax		; Memory
		call	PR_Free
		add	esp, 4
		mov	dword ptr [esi], 0

loc_100263CC:				; CODE XREF: PR_CloseSharedMemory_0+4Bj
		push	esi		; Memory
		call	PR_Free
		add	esp, 4
		mov	eax, edi
		pop	edi
		pop	esi
		retn
PR_CloseSharedMemory_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl PR_OpenAnonFileMap_0(int,	HANDLE TargetHandle, int)
PR_OpenAnonFileMap_0 proc near		; CODE XREF: PR_OpenAnonFileMapj

TargetHandle	= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	ecx, [esp+TargetHandle]
		push	esi
		push	eax		; int
		push	0		; dwMaximumSizeHigh
		push	ecx		; dwMaximumSizeLow
		push	0FFFFFFFFh	; int
		call	PR_CreateFileMap
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jnz	short loc_1002641E
		mov	edx, dword_10032AA4
		cmp	dword ptr [edx+4], 4
		jl	loc_10026492
		push	offset a_md_openanonfi ; "_md_OpenAnonFileMap(): PR_CreateFileMap"...
		call	PR_LogPrint
		add	esp, 4
		mov	eax, esi
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1002641E:				; CODE XREF: PR_OpenAnonFileMap_0+1Bj
		push	edi
		mov	edi, ds:GetCurrentProcess
		push	2		; dwOptions
		push	1		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [esp+14h+TargetHandle]
		push	eax		; lpTargetHandle
		call	edi ; GetCurrentProcess
		mov	ecx, [esi+8]
		push	eax		; hTargetProcessHandle
		push	ecx		; hSourceHandle
		call	edi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		pop	edi
		test	eax, eax
		jnz	short loc_1002647F
		call	ds:GetLastError
		push	eax
		push	0FFFFE896h
		call	PR_SetError
		mov	edx, dword_10032AA4
		add	esp, 8
		cmp	dword ptr [edx+4], 4
		jl	short loc_10026472
		push	offset a_md_openanon_0 ; "_md_OpenAnonFileMap(): DuplicateHandle("...
		call	PR_LogPrint
		add	esp, 4

loc_10026472:				; CODE XREF: PR_OpenAnonFileMap_0+83j
		push	esi		; Memory
		call	PR_CloseFileMap
		add	esp, 4
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1002647F:				; CODE XREF: PR_OpenAnonFileMap_0+63j
		mov	eax, [esi+8]
		push	eax		; hObject
		call	ds:CloseHandle
		mov	ecx, [esp+4+TargetHandle]
		mov	[esi+8], ecx
		mov	eax, esi

loc_10026492:				; CODE XREF: PR_OpenAnonFileMap_0+27j
		pop	esi
		retn
PR_OpenAnonFileMap_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_ExportFileMapAsString_0 proc	near	; CODE XREF: PR_ExportFileMapAsStringj

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi+0Ch]
		mov	ecx, [esi+8]
		mov	edx, [esi+4]
		push	edi
		push	eax
		mov	eax, [esp+0Ch+arg_4]
		push	ecx
		mov	ecx, [esp+10h+arg_8]
		push	edx
		push	offset aDLdLd	; "%d:%ld:%ld"
		push	eax
		push	ecx
		call	PR_snprintf
		mov	edx, dword_10032AA4
		add	esp, 18h
		cmp	dword ptr [edx+4], 4
		mov	edi, eax
		jl	short loc_100264F0
		mov	eax, [esi+0Ch]
		mov	ecx, [esi+8]
		mov	edx, [esi+4]
		push	eax
		push	ecx
		push	edx
		push	offset a_md_exportfile ; "_md_ExportFileMapAsString(): prot: %x, "...
		call	PR_LogPrint
		add	esp, 10h

loc_100264F0:				; CODE XREF: PR_ExportFileMapAsString_0+35j
		xor	eax, eax
		cmp	edi, 0FFFFFFFFh
		setnz	al
		pop	edi
		pop	esi
		dec	eax
		retn
PR_ExportFileMapAsString_0 endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


PR_ImportFileMapFromString_0 proc near	; CODE XREF: PR_ImportFileMapFromStringj

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	esi
		lea	eax, [esp+10h+var_4]
		push	eax
		mov	eax, [esp+14h+arg_0]
		lea	ecx, [esp+14h+var_8]
		push	ecx
		lea	edx, [esp+18h+var_C]
		push	edx
		push	offset aDLdLd	; "%d:%ld:%ld"
		push	eax
		call	PR_sscanf
		push	10h		; SizeOfElements
		push	1		; NumOfElements
		call	PR_Calloc
		mov	esi, eax
		add	esp, 1Ch
		test	esi, esi
		jnz	short loc_10026554
		mov	ecx, dword_10032AA4
		cmp	dword ptr [ecx+4], 4
		jl	short loc_1002654D
		push	offset a_md_importfile ; "_md_ImportFileMapFromString(): PR_NEWZA"...
		call	PR_LogPrint
		add	esp, 4

loc_1002654D:				; CODE XREF: PR_ImportFileMapFromString_0+3Ej
		xor	eax, eax
		pop	esi
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_10026554:				; CODE XREF: PR_ImportFileMapFromString_0+32j
		mov	edx, [esp+10h+var_C]
		mov	[esi+4], edx
		mov	eax, [esp+10h+var_8]
		mov	[esi+8], eax
		mov	ecx, [esp+10h+var_4]
		mov	[esi+0Ch], ecx
		mov	dword ptr [esi], 0FFFFFFFFh
		mov	edx, dword_10032AA4
		cmp	dword ptr [edx+4], 4
		jl	short loc_10026592
		mov	edx, [esp+10h+var_C]
		push	0FFFFFFFFh
		push	ecx
		push	eax
		push	edx
		push	esi
		push	offset a_md_importfi_0 ; "_md_ImportFileMapFromString(): fm: %p, "...
		call	PR_LogPrint
		add	esp, 18h

loc_10026592:				; CODE XREF: PR_ImportFileMapFromString_0+79j
		mov	eax, esi
		pop	esi
		add	esp, 0Ch
		retn
PR_ImportFileMapFromString_0 endp

; ---------------------------------------------------------------------------
		align 2
; [00000006 BYTES: COLLAPSED FUNCTION WSAGetLastError]
; [00000006 BYTES: COLLAPSED FUNCTION closesocket]
; [00000006 BYTES: COLLAPSED FUNCTION htonl]
; [00000006 BYTES: COLLAPSED FUNCTION gethostbyname]
; [00000006 BYTES: COLLAPSED FUNCTION gethostbyaddr]
; [00000006 BYTES: COLLAPSED FUNCTION getprotobyname]
; [00000006 BYTES: COLLAPSED FUNCTION getprotobynumber]
; [00000006 BYTES: COLLAPSED FUNCTION htons]
; [00000006 BYTES: COLLAPSED FUNCTION ntohs]
; [00000006 BYTES: COLLAPSED FUNCTION ntohl]
; [00000006 BYTES: COLLAPSED FUNCTION getsockopt]
; [00000006 BYTES: COLLAPSED FUNCTION accept]
; [00000006 BYTES: COLLAPSED FUNCTION connect]
; [00000006 BYTES: COLLAPSED FUNCTION listen]
; [00000006 BYTES: COLLAPSED FUNCTION getsockname]
; [00000006 BYTES: COLLAPSED FUNCTION bind]
; [00000006 BYTES: COLLAPSED FUNCTION socket]
; [00000006 BYTES: COLLAPSED FUNCTION gethostname]
; [00000006 BYTES: COLLAPSED FUNCTION WSAStartup]
; [00000006 BYTES: COLLAPSED FUNCTION ioctlsocket]
; [00000006 BYTES: COLLAPSED FUNCTION setsockopt]
; [00000006 BYTES: COLLAPSED FUNCTION GetAcceptExSockaddrs]
; [00000006 BYTES: COLLAPSED FUNCTION AcceptEx]
; [00000006 BYTES: COLLAPSED FUNCTION TransmitFile]
; [00000006 BYTES: COLLAPSED FUNCTION shutdown]
; [00000006 BYTES: COLLAPSED FUNCTION getpeername]
; [00000006 BYTES: COLLAPSED FUNCTION __WSAFDIsSet]
; [00000006 BYTES: COLLAPSED FUNCTION recv]
; [00000006 BYTES: COLLAPSED FUNCTION send]
; [00000006 BYTES: COLLAPSED FUNCTION sendto]
; [00000006 BYTES: COLLAPSED FUNCTION recvfrom]
; [00000006 BYTES: COLLAPSED FUNCTION select]
; [00000006 BYTES: COLLAPSED FUNCTION WSASetLastError]
; [00000006 BYTES: COLLAPSED FUNCTION WSACleanup]
		align 10h
; [00000010 BYTES: COLLAPSED FUNCTION __security_check_cookie(x)]

; =============== S U B	R O U T	I N E =======================================


sub_10026680	proc near		; CODE XREF: sub_10026710+2Dp
					; .text:10026766p ...

var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		mov	edx, [esp+0Ch+arg_0]
		mov	eax, [esp+0Ch+arg_4]
		mov	ecx, [esp+0Ch+arg_8]
		push	ebp
		push	edx
		push	eax
		push	ecx
		push	ecx
		push	offset sub_10026710
		push	large dword ptr	fs:0
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+28h+var_20], eax
		mov	large fs:0, esp

loc_100266B2:				; CODE XREF: sub_10026680+64j
					; sub_10026680+80j
		mov	eax, [esp+28h+arg_4]
		mov	ebx, [eax+8]
		mov	ecx, [esp+28h+arg_0]
		xor	ebx, [ecx]
		mov	esi, [eax+0Ch]
		cmp	esi, 0FFFFFFFEh
		jz	short loc_10026702
		mov	edx, [esp+28h+arg_8]
		cmp	edx, 0FFFFFFFEh
		jz	short loc_100266D4
		cmp	esi, edx
		jbe	short loc_10026702

loc_100266D4:				; CODE XREF: sub_10026680+4Ej
		lea	esi, [esi+esi*2]
		lea	ebx, [ebx+esi*4+10h]
		mov	ecx, [ebx]
		mov	[eax+0Ch], ecx
		cmp	dword ptr [ebx+4], 0
		jnz	short loc_100266B2
		push	101h
		mov	eax, [ebx+8]
		call	sub_100272B5
		mov	ecx, 1
		mov	eax, [ebx+8]
		call	sub_100272D4
		jmp	short loc_100266B2
; ---------------------------------------------------------------------------

loc_10026702:				; CODE XREF: sub_10026680+45j
					; sub_10026680+52j
		pop	large dword ptr	fs:0
		add	esp, 18h
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10026680	endp


; =============== S U B	R O U T	I N E =======================================


sub_10026710	proc near		; DATA XREF: sub_10026680+14o
					; .rdata:___safe_se_handler_tableo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		mov	ecx, [esp+arg_0]
		test	dword ptr [ecx+4], 6
		mov	eax, 1
		jz	short locret_10026755
		mov	eax, [esp+arg_4]
		mov	ecx, [eax+8]
		xor	ecx, eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		push	ebp
		mov	ebp, [eax+18h]
		push	dword ptr [eax+0Ch]
		push	dword ptr [eax+10h]
		push	dword ptr [eax+14h]
		call	sub_10026680
		add	esp, 0Ch
		pop	ebp
		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_C]
		mov	[edx], eax
		mov	eax, 3

locret_10026755:			; CODE XREF: sub_10026710+10j
		retn
sub_10026710	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ecx, [esp+8]
		mov	ebp, [ecx]
		push	dword ptr [ecx+1Ch]
		push	dword ptr [ecx+18h]
		push	dword ptr [ecx+28h]
		call	sub_10026680
		add	esp, 0Ch
		pop	ebp
		retn	4

; =============== S U B	R O U T	I N E =======================================


sub_10026772	proc near		; CODE XREF: sub_100267E0+89p
		push	ebp
		push	esi
		push	edi
		push	ebx
		mov	ebp, edx
		xor	eax, eax
		xor	ebx, ebx
		xor	edx, edx
		xor	esi, esi
		xor	edi, edi
		call	ecx
		pop	ebx
		pop	edi
		pop	esi
		pop	ebp
		retn
sub_10026772	endp


; =============== S U B	R O U T	I N E =======================================


sub_10026789	proc near		; CODE XREF: sub_100267E0+15Ep
		mov	ebp, edx
		mov	esi, ecx
		mov	eax, ecx
		push	1
		call	sub_100272B5
		xor	eax, eax
		xor	ebx, ebx
		xor	ecx, ecx
		xor	edx, edx
		xor	edi, edi
		jmp	esi
sub_10026789	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_100267A2(PVOID TargetFrame)
sub_100267A2	proc near		; CODE XREF: sub_100267E0+112p
		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		push	0		; ReturnValue
		push	0		; ExceptionRecord
		push	offset loc_100267B7 ; TargetIp
		push	ecx		; TargetFrame
		call	RtlUnwind

loc_100267B7:				; DATA XREF: sub_100267A2+Ao
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_100267A2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100267BC	proc near		; CODE XREF: sub_100267E0+128p
					; sub_100267E0+178p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	edx
		push	ecx
		push	[esp+0Ch+arg_4]
		call	sub_10026680
		add	esp, 0Ch
		pop	ebp
		retn	8
sub_100267BC	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100267E0(int,	int, int, PVOID	TargetFrame, int)
sub_100267E0	proc near		; CODE XREF: sub_10026D0F+1Bp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_1		= byte ptr -1
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
TargetFrame	= dword	ptr  14h
arg_10		= dword	ptr  18h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		push	ebx
		mov	ebx, [ebp+TargetFrame]
		push	esi
		mov	esi, [ebx+8]
		xor	esi, [eax]
		push	edi
		mov	eax, [esi]
		mov	[ebp+var_1], 0
		mov	[ebp+var_C], 1
		lea	edi, [ebx+10h]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10026816
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	[ebp+arg_4]

loc_10026816:				; CODE XREF: sub_100267E0+29j
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	[ebp+arg_4]
		mov	eax, [ebp+arg_8]
		test	byte ptr [eax+4], 66h
		jnz	loc_10026943
		lea	ecx, [ebp+var_18]
		mov	[ebx-4], ecx
		mov	ebx, [ebx+0Ch]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_14], eax
		cmp	ebx, 0FFFFFFFEh
		jz	short loc_100268A8
		jmp	short loc_10026850
; ---------------------------------------------------------------------------
		align 10h

loc_10026850:				; CODE XREF: sub_100267E0+68j
					; sub_100267E0+A0j
		lea	edx, [ebx+ebx*2]
		mov	ecx, [esi+edx*4+14h]
		lea	eax, [esi+edx*4+10h]
		mov	[ebp+var_10], eax
		mov	eax, [eax]
		mov	[ebp+var_8], eax
		test	ecx, ecx
		jz	short loc_1002687B
		mov	edx, edi
		call	sub_10026772
		mov	[ebp+var_1], 1
		test	eax, eax
		jl	short loc_100268B2
		jg	short loc_100268BB
		mov	eax, [ebp+var_8]

loc_1002687B:				; CODE XREF: sub_100267E0+85j
		mov	ebx, eax
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_10026850
		cmp	[ebp+var_1], 0
		jz	short loc_100268A8

loc_10026888:				; CODE XREF: sub_100267E0+D9j
					; sub_100267E0+17Dj
		mov	eax, [esi]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_1002689A
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	[ebp+arg_4]

loc_1002689A:				; CODE XREF: sub_100267E0+ADj
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	[ebp+arg_4]

loc_100268A8:				; CODE XREF: sub_100267E0+66j
					; sub_100267E0+A6j ...
		mov	eax, [ebp+var_C]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100268B2:				; CODE XREF: sub_100267E0+94j
		mov	[ebp+var_C], 0
		jmp	short loc_10026888
; ---------------------------------------------------------------------------

loc_100268BB:				; CODE XREF: sub_100267E0+96j
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax], 0E06D7363h
		jnz	short loc_100268EF
		cmp	dword_10032B50,	0
		jz	short loc_100268EF
		push	offset dword_10032B50
		call	sub_10027364
		add	esp, 4
		test	eax, eax
		jz	short loc_100268EF
		mov	ecx, [ebp+arg_8]
		push	1
		push	ecx
		call	dword_10032B50
		add	esp, 8

loc_100268EF:				; CODE XREF: sub_100267E0+E4j
					; sub_100267E0+EDj ...
		mov	ecx, [ebp+TargetFrame] ; TargetFrame
		call	sub_100267A2
		mov	eax, [ebp+TargetFrame]
		cmp	[eax+0Ch], ebx
		jz	short loc_10026910
		mov	edx, [ebp+arg_0]
		push	edx
		push	edi
		mov	edx, ebx
		mov	ecx, eax
		call	sub_100267BC
		mov	eax, [ebp+TargetFrame]

loc_10026910:				; CODE XREF: sub_100267E0+11Dj
		mov	ecx, [ebp+var_8]
		mov	[eax+0Ch], ecx
		mov	eax, [esi]
		cmp	eax, 0FFFFFFFEh
		jz	short loc_10026928
		mov	ecx, [esi+4]
		add	ecx, edi
		xor	ecx, [eax+edi]
		call	[ebp+arg_4]

loc_10026928:				; CODE XREF: sub_100267E0+13Bj
		mov	ecx, [esi+0Ch]
		mov	edx, [esi+8]
		add	ecx, edi
		xor	ecx, [edx+edi]
		call	[ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+8]
		mov	edx, edi
		call	sub_10026789

loc_10026943:				; CODE XREF: sub_100267E0+4Bj
		mov	edx, 0FFFFFFFEh
		cmp	[ebx+0Ch], edx
		jz	loc_100268A8
		mov	ecx, [ebp+arg_0]
		push	ecx
		push	edi
		mov	ecx, ebx
		call	sub_100267BC
		jmp	loc_10026888
sub_100267E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10026962	proc near		; CODE XREF: sub_100269EA+Dj

var_8		= qword	ptr -8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		and	esp, 0FFFFFFF8h
		fstp	[esp+8+var_8]
		cvttsd2si eax, [esp+8+var_8]
		leave
		retn
sub_10026962	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10026975	proc near		; CODE XREF: sub_100269EA+7j

var_20		= dword	ptr -20h
var_10		= qword	ptr -10h
var_8		= dword	ptr -8

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		and	esp, 0FFFFFFF0h
		fld	st
		fst	[esp+20h+var_8]
		fistp	[esp+20h+var_10]
		fild	[esp+20h+var_10]
		mov	edx, [esp+20h+var_8]
		mov	eax, dword ptr [esp+20h+var_10]
		test	eax, eax
		jz	short loc_100269D4

loc_10026998:				; CODE XREF: sub_10026975+69j
		fsubp	st(1), st
		test	edx, edx
		jns	short loc_100269BC
		fstp	[esp+20h+var_20]
		mov	ecx, [esp+20h+var_20]
		xor	ecx, 80000000h
		add	ecx, 7FFFFFFFh
		adc	eax, 0
		mov	edx, dword ptr [esp+20h+var_10+4]
		adc	edx, 0
		jmp	short locret_100269E8
; ---------------------------------------------------------------------------

loc_100269BC:				; CODE XREF: sub_10026975+27j
		fstp	[esp+20h+var_20]
		mov	ecx, [esp+20h+var_20]
		add	ecx, 7FFFFFFFh
		sbb	eax, 0
		mov	edx, dword ptr [esp+20h+var_10+4]
		sbb	edx, 0
		jmp	short locret_100269E8
; ---------------------------------------------------------------------------

loc_100269D4:				; CODE XREF: sub_10026975+21j
		mov	edx, dword ptr [esp+20h+var_10+4]
		test	edx, 7FFFFFFFh
		jnz	short loc_10026998
		fstp	[esp+20h+var_8]
		fstp	[esp+20h+var_8]

locret_100269E8:			; CODE XREF: sub_10026975+45j
					; sub_10026975+5Dj
		leave
		retn
sub_10026975	endp


; =============== S U B	R O U T	I N E =======================================


sub_100269EA	proc near		; CODE XREF: PR_strtod+9F4p
					; sub_1000B720+1FDp ...
		cmp	dword_100306B0,	0
		jz	sub_10026975
		jmp	sub_10026962
sub_100269EA	endp

; [00000006 BYTES: COLLAPSED FUNCTION memset]
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026A10	proc near		; CODE XREF: sub_10005650+7Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	esi
		mov	eax, [esp+4+arg_C]
		or	eax, eax
		jnz	short loc_10026A41
		mov	ecx, [esp+4+arg_8]
		mov	eax, [esp+4+arg_4]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+4+arg_0]
		div	ecx
		mov	esi, eax
		mov	eax, ebx
		mul	[esp+4+arg_8]
		mov	ecx, eax
		mov	eax, esi
		mul	[esp+4+arg_8]
		add	edx, ecx
		jmp	short loc_10026A88
; ---------------------------------------------------------------------------

loc_10026A41:				; CODE XREF: sub_10026A10+7j
		mov	ecx, eax
		mov	ebx, [esp+4+arg_8]
		mov	edx, [esp+4+arg_4]
		mov	eax, [esp+4+arg_0]

loc_10026A4F:				; CODE XREF: sub_10026A10+49j
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_10026A4F
		div	ebx
		mov	esi, eax
		mul	[esp+4+arg_C]
		mov	ecx, eax
		mov	eax, [esp+4+arg_8]
		mul	esi
		add	edx, ecx
		jb	short loc_10026A7D
		cmp	edx, [esp+4+arg_4]
		ja	short loc_10026A7D
		jb	short loc_10026A86
		cmp	eax, [esp+4+arg_0]
		jbe	short loc_10026A86

loc_10026A7D:				; CODE XREF: sub_10026A10+5Dj
					; sub_10026A10+63j
		dec	esi
		sub	eax, [esp+4+arg_8]
		sbb	edx, [esp+4+arg_C]

loc_10026A86:				; CODE XREF: sub_10026A10+65j
					; sub_10026A10+6Bj
		xor	ebx, ebx

loc_10026A88:				; CODE XREF: sub_10026A10+2Fj
		sub	eax, [esp+4+arg_0]
		sbb	edx, [esp+4+arg_4]
		neg	edx
		neg	eax
		sbb	edx, 0
		mov	ecx, edx
		mov	edx, ebx
		mov	ebx, ecx
		mov	ecx, eax
		mov	eax, esi
		pop	esi
		retn	10h
sub_10026A10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026AB0	proc near		; CODE XREF: sub_10006710+118p
					; PR_MillisecondsToInterval+1Fp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		mov	eax, [esp+arg_4]
		mov	ecx, [esp+arg_C]
		or	ecx, eax
		mov	ecx, [esp+arg_8]
		jnz	short loc_10026AC9
		mov	eax, [esp+arg_0]
		mul	ecx
		retn	10h
; ---------------------------------------------------------------------------

loc_10026AC9:				; CODE XREF: sub_10026AB0+Ej
		push	ebx
		mul	ecx
		mov	ebx, eax
		mov	eax, [esp+4+arg_0]
		mul	[esp+4+arg_C]
		add	ebx, eax
		mov	eax, [esp+4+arg_0]
		mul	ecx
		add	edx, ebx
		pop	ebx
		retn	10h
sub_10026AB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026AF0	proc near		; CODE XREF: PR_MillisecondsToInterval+34p
					; PR_MicrosecondsToInterval+34p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	esi
		mov	eax, [esp+8+arg_C]
		or	eax, eax
		jnz	short loc_10026B12
		mov	ecx, [esp+8+arg_8]
		mov	eax, [esp+8+arg_4]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+8+arg_0]
		div	ecx
		mov	edx, ebx
		jmp	short loc_10026B53
; ---------------------------------------------------------------------------

loc_10026B12:				; CODE XREF: sub_10026AF0+8j
		mov	ecx, eax
		mov	ebx, [esp+8+arg_8]
		mov	edx, [esp+8+arg_4]
		mov	eax, [esp+8+arg_0]

loc_10026B20:				; CODE XREF: sub_10026AF0+3Aj
		shr	ecx, 1
		rcr	ebx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ecx, ecx
		jnz	short loc_10026B20
		div	ebx
		mov	esi, eax
		mul	[esp+8+arg_C]
		mov	ecx, eax
		mov	eax, [esp+8+arg_8]
		mul	esi
		add	edx, ecx
		jb	short loc_10026B4E
		cmp	edx, [esp+8+arg_4]
		ja	short loc_10026B4E
		jb	short loc_10026B4F
		cmp	eax, [esp+8+arg_0]
		jbe	short loc_10026B4F

loc_10026B4E:				; CODE XREF: sub_10026AF0+4Ej
					; sub_10026AF0+54j
		dec	esi

loc_10026B4F:				; CODE XREF: sub_10026AF0+56j
					; sub_10026AF0+5Cj
		xor	edx, edx
		mov	eax, esi

loc_10026B53:				; CODE XREF: sub_10026AF0+20j
		pop	esi
		pop	ebx
		retn	10h
sub_10026AF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026B60	proc near		; CODE XREF: sub_10012330+14p
					; sub_10012330+3Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	edi
		push	esi
		push	ebp
		xor	edi, edi
		xor	ebp, ebp
		mov	eax, [esp+0Ch+arg_4]
		or	eax, eax
		jge	short loc_10026B84
		inc	edi
		inc	ebp
		mov	edx, [esp+0Ch+arg_0]
		neg	eax
		neg	edx
		sbb	eax, 0
		mov	[esp+0Ch+arg_4], eax
		mov	[esp+0Ch+arg_0], edx

loc_10026B84:				; CODE XREF: sub_10026B60+Dj
		mov	eax, [esp+0Ch+arg_C]
		or	eax, eax
		jge	short loc_10026BA0
		inc	edi
		mov	edx, [esp+0Ch+arg_8]
		neg	eax
		neg	edx
		sbb	eax, 0
		mov	[esp+0Ch+arg_C], eax
		mov	[esp+0Ch+arg_8], edx

loc_10026BA0:				; CODE XREF: sub_10026B60+2Aj
		or	eax, eax
		jnz	short loc_10026BCC
		mov	ecx, [esp+0Ch+arg_8]
		mov	eax, [esp+0Ch+arg_4]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+0Ch+arg_0]
		div	ecx
		mov	esi, eax
		mov	eax, ebx
		mul	[esp+0Ch+arg_8]
		mov	ecx, eax
		mov	eax, esi
		mul	[esp+0Ch+arg_8]
		add	edx, ecx
		jmp	short loc_10026C13
; ---------------------------------------------------------------------------

loc_10026BCC:				; CODE XREF: sub_10026B60+42j
		mov	ebx, eax
		mov	ecx, [esp+0Ch+arg_8]
		mov	edx, [esp+0Ch+arg_4]
		mov	eax, [esp+0Ch+arg_0]

loc_10026BDA:				; CODE XREF: sub_10026B60+84j
		shr	ebx, 1
		rcr	ecx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ebx, ebx
		jnz	short loc_10026BDA
		div	ecx
		mov	esi, eax
		mul	[esp+0Ch+arg_C]
		mov	ecx, eax
		mov	eax, [esp+0Ch+arg_8]
		mul	esi
		add	edx, ecx
		jb	short loc_10026C08
		cmp	edx, [esp+0Ch+arg_4]
		ja	short loc_10026C08
		jb	short loc_10026C11
		cmp	eax, [esp+0Ch+arg_0]
		jbe	short loc_10026C11

loc_10026C08:				; CODE XREF: sub_10026B60+98j
					; sub_10026B60+9Ej
		dec	esi
		sub	eax, [esp+0Ch+arg_8]
		sbb	edx, [esp+0Ch+arg_C]

loc_10026C11:				; CODE XREF: sub_10026B60+A0j
					; sub_10026B60+A6j
		xor	ebx, ebx

loc_10026C13:				; CODE XREF: sub_10026B60+6Aj
		sub	eax, [esp+0Ch+arg_0]
		sbb	edx, [esp+0Ch+arg_4]
		dec	ebp
		jns	short loc_10026C25
		neg	edx
		neg	eax
		sbb	edx, 0

loc_10026C25:				; CODE XREF: sub_10026B60+BCj
		mov	ecx, edx
		mov	edx, ebx
		mov	ebx, ecx
		mov	ecx, eax
		mov	eax, esi
		dec	edi
		jnz	short loc_10026C39
		neg	edx
		neg	eax
		sbb	edx, 0

loc_10026C39:				; CODE XREF: sub_10026B60+D0j
		pop	ebp
		pop	esi
		pop	edi
		retn	10h
sub_10026B60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026C40	proc near		; CODE XREF: PR_LocalTimeParameters:loc_1001272Dp
					; sub_10021610+2Dp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	edi
		push	esi
		push	ebx
		xor	edi, edi
		mov	eax, [esp+0Ch+arg_4]
		or	eax, eax
		jge	short loc_10026C61
		inc	edi
		mov	edx, [esp+0Ch+arg_0]
		neg	eax
		neg	edx
		sbb	eax, 0
		mov	[esp+0Ch+arg_4], eax
		mov	[esp+0Ch+arg_0], edx

loc_10026C61:				; CODE XREF: sub_10026C40+Bj
		mov	eax, [esp+0Ch+arg_C]
		or	eax, eax
		jge	short loc_10026C7D
		inc	edi
		mov	edx, [esp+0Ch+arg_8]
		neg	eax
		neg	edx
		sbb	eax, 0
		mov	[esp+0Ch+arg_C], eax
		mov	[esp+0Ch+arg_8], edx

loc_10026C7D:				; CODE XREF: sub_10026C40+27j
		or	eax, eax
		jnz	short loc_10026C99
		mov	ecx, [esp+0Ch+arg_8]
		mov	eax, [esp+0Ch+arg_4]
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, [esp+0Ch+arg_0]
		div	ecx
		mov	edx, ebx
		jmp	short loc_10026CDA
; ---------------------------------------------------------------------------

loc_10026C99:				; CODE XREF: sub_10026C40+3Fj
		mov	ebx, eax
		mov	ecx, [esp+0Ch+arg_8]
		mov	edx, [esp+0Ch+arg_4]
		mov	eax, [esp+0Ch+arg_0]

loc_10026CA7:				; CODE XREF: sub_10026C40+71j
		shr	ebx, 1
		rcr	ecx, 1
		shr	edx, 1
		rcr	eax, 1
		or	ebx, ebx
		jnz	short loc_10026CA7
		div	ecx
		mov	esi, eax
		mul	[esp+0Ch+arg_C]
		mov	ecx, eax
		mov	eax, [esp+0Ch+arg_8]
		mul	esi
		add	edx, ecx
		jb	short loc_10026CD5
		cmp	edx, [esp+0Ch+arg_4]
		ja	short loc_10026CD5
		jb	short loc_10026CD6
		cmp	eax, [esp+0Ch+arg_0]
		jbe	short loc_10026CD6

loc_10026CD5:				; CODE XREF: sub_10026C40+85j
					; sub_10026C40+8Bj
		dec	esi

loc_10026CD6:				; CODE XREF: sub_10026C40+8Dj
					; sub_10026C40+93j
		xor	edx, edx
		mov	eax, esi

loc_10026CDA:				; CODE XREF: sub_10026C40+57j
		dec	edi
		jnz	short loc_10026CE4
		neg	edx
		neg	eax
		sbb	edx, 0

loc_10026CE4:				; CODE XREF: sub_10026C40+9Bj
		pop	ebx
		pop	esi
		pop	edi
		retn	10h
sub_10026C40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_10026CF0	proc near		; CODE XREF: sub_10021820+98p
					; sub_100219A0+77p
		cmp	cl, 40h
		jnb	short loc_10026D0A
		cmp	cl, 20h
		jnb	short loc_10026D00
		shld	edx, eax, cl
		shl	eax, cl
		retn
; ---------------------------------------------------------------------------

loc_10026D00:				; CODE XREF: sub_10026CF0+8j
		mov	edx, eax
		xor	eax, eax
		and	cl, 1Fh
		shl	edx, cl
		retn
; ---------------------------------------------------------------------------

loc_10026D0A:				; CODE XREF: sub_10026CF0+3j
		xor	eax, eax
		xor	edx, edx
		retn
sub_10026CF0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10026D0F(int,	PVOID TargetFrame, int,	int)
sub_10026D0F	proc near		; DATA XREF: sub_10024650+Ao
					; __SEH_prolog4o ...

arg_0		= dword	ptr  8
TargetFrame	= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	[ebp+arg_C]
		push	[ebp+arg_8]	; int
		push	[ebp+TargetFrame] ; TargetFrame
		push	[ebp+arg_0]	; int
		push	offset @__security_check_cookie@4 ; int
		push	offset ___security_cookie ; int
		call	sub_100267E0
		add	esp, 18h
		pop	ebp
		retn
sub_10026D0F	endp

; ---------------------------------------------------------------------------
		align 10h
; [0000002B BYTES: COLLAPSED FUNCTION __alloca_probe]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10026D6B	proc near		; CODE XREF: sub_10026FB9+Cp
					; sub_10026FFB+Cp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, 0E06D7363h
		cmp	[ebp+arg_0], eax
		jnz	short loc_10026D87
		push	[ebp+arg_4]
		push	eax
		call	_XcptFilter
		pop	ecx
		pop	ecx
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10026D87:				; CODE XREF: sub_10026D6B+Dj
		xor	eax, eax
		pop	ebp
		retn
sub_10026D6B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10026D8B	proc near		; CODE XREF: sub_10026DD1+A5p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_0]
		xor	eax, eax
		jmp	short loc_10026DA7
; ---------------------------------------------------------------------------

loc_10026D98:				; CODE XREF: sub_10026D8B+1Fj
		test	eax, eax
		jnz	short loc_10026DAC
		mov	ecx, [esi]
		test	ecx, ecx
		jz	short loc_10026DA4
		call	ecx

loc_10026DA4:				; CODE XREF: sub_10026D8B+15j
		add	esi, 4

loc_10026DA7:				; CODE XREF: sub_10026D8B+Bj
		cmp	esi, [ebp+arg_4]
		jb	short loc_10026D98

loc_10026DAC:				; CODE XREF: sub_10026D8B+Fj
		pop	esi
		pop	ebp
		retn
sub_10026D8B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10026DAF	proc near		; DATA XREF: .rdata:10028348o
		push	80h		; Size
		call	ds:malloc
		pop	ecx
		mov	dword_10032B44,	eax
		mov	dword_10032B40,	eax
		test	eax, eax
		jnz	short loc_10026DCB
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10026DCB:				; CODE XREF: sub_10026DAF+18j
		and	dword ptr [eax], 0
		xor	eax, eax
		retn
sub_10026DAF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10026DD1	proc near		; CODE XREF: DllEntryPoint-1C3p
					; DllEntryPoint-109p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		push	ebx
		xor	eax, eax
		push	esi
		push	edi
		cmp	[ebp+arg_4], eax
		jnz	short loc_10026E06
		cmp	dword_10032694,	eax
		jle	short loc_10026DFF
		dec	dword_10032694
		mov	edi, ds:InterlockedCompareExchange
		push	eax
		mov	esi, offset Target
		jmp	loc_10026EE4
; ---------------------------------------------------------------------------

loc_10026DFF:				; CODE XREF: sub_10026DD1+15j
					; sub_10026DD1+AEj
		xor	eax, eax
		jmp	loc_10026F51
; ---------------------------------------------------------------------------

loc_10026E06:				; CODE XREF: sub_10026DD1+Dj
		cmp	[ebp+arg_4], 1
		jnz	loc_10026F4E
		mov	ecx, large fs:18h
		mov	ebx, [ecx+4]
		mov	edi, ds:InterlockedCompareExchange
		mov	[ebp+arg_4], eax
		push	eax
		mov	esi, offset Target
		jmp	short loc_10026E3C
; ---------------------------------------------------------------------------

loc_10026E2B:				; CODE XREF: sub_10026DD1+71j
		cmp	eax, ebx
		jz	short loc_10026E46
		push	3E8h		; dwMilliseconds
		call	ds:Sleep
		push	0		; Comperand

loc_10026E3C:				; CODE XREF: sub_10026DD1+58j
		push	ebx		; Exchange
		push	esi		; Destination
		call	edi ; InterlockedCompareExchange
		test	eax, eax
		jnz	short loc_10026E2B
		jmp	short loc_10026E4D
; ---------------------------------------------------------------------------

loc_10026E46:				; CODE XREF: sub_10026DD1+5Cj
		mov	[ebp+arg_4], 1

loc_10026E4D:				; CODE XREF: sub_10026DD1+73j
		mov	eax, dword_10032B38
		push	2
		pop	edi
		test	eax, eax
		jz	short loc_10026E62
		push	1Fh
		call	_amsg_exit
		jmp	short loc_10026E9B
; ---------------------------------------------------------------------------

loc_10026E62:				; CODE XREF: sub_10026DD1+86j
		push	offset dword_10028350
		push	offset dword_10028344
		mov	dword_10032B38,	1
		call	sub_10026D8B
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	loc_10026DFF
		push	offset dword_10028340
		push	offset dword_1002833C
		call	_initterm
		pop	ecx
		mov	dword_10032B38,	edi

loc_10026E9B:				; CODE XREF: sub_10026DD1+8Fj
		xor	ebx, ebx
		pop	ecx
		cmp	[ebp+arg_4], ebx
		jnz	short loc_10026EAB
		push	ebx		; Value
		push	esi		; Target
		call	ds:InterlockedExchange

loc_10026EAB:				; CODE XREF: sub_10026DD1+D0j
		cmp	dword_10032B4C,	ebx
		jz	short loc_10026ECF
		push	offset dword_10032B4C
		call	sub_10027364
		pop	ecx
		test	eax, eax
		jz	short loc_10026ECF
		push	[ebp+arg_8]
		push	edi
		push	[ebp+arg_0]
		call	dword_10032B4C

loc_10026ECF:				; CODE XREF: sub_10026DD1+E0j
					; sub_10026DD1+EFj
		inc	dword_10032694
		jmp	short loc_10026F4E
; ---------------------------------------------------------------------------

loc_10026ED7:				; CODE XREF: sub_10026DD1+11Aj
		push	3E8h		; dwMilliseconds
		call	ds:Sleep
		push	0		; Comperand

loc_10026EE4:				; CODE XREF: sub_10026DD1+29j
		push	1		; Exchange
		push	esi		; Destination
		call	edi ; InterlockedCompareExchange
		test	eax, eax
		jnz	short loc_10026ED7
		mov	eax, dword_10032B38
		cmp	eax, 2
		jz	short loc_10026F01
		push	1Fh
		call	_amsg_exit
		pop	ecx
		jmp	short loc_10026F4E
; ---------------------------------------------------------------------------

loc_10026F01:				; CODE XREF: sub_10026DD1+124j
		mov	ebx, dword_10032B44
		test	ebx, ebx
		jz	short loc_10026F3B
		mov	edi, dword_10032B40
		add	edi, 0FFFFFFFCh
		jmp	short loc_10026F21
; ---------------------------------------------------------------------------

loc_10026F16:				; CODE XREF: sub_10026DD1+152j
		mov	eax, [edi]
		test	eax, eax
		jz	short loc_10026F1E
		call	eax

loc_10026F1E:				; CODE XREF: sub_10026DD1+149j
		sub	edi, 4

loc_10026F21:				; CODE XREF: sub_10026DD1+143j
		cmp	edi, ebx
		jnb	short loc_10026F16
		push	ebx		; Memory
		call	ds:free
		and	dword_10032B40,	0
		and	dword_10032B44,	0
		pop	ecx

loc_10026F3B:				; CODE XREF: sub_10026DD1+138j
		push	0		; Value
		push	esi		; Target
		mov	dword_10032B38,	0
		call	ds:InterlockedExchange

loc_10026F4E:				; CODE XREF: sub_10026DD1+39j
					; sub_10026DD1+104j ...
		xor	eax, eax
		inc	eax

loc_10026F51:				; CODE XREF: sub_10026DD1+30j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	0Ch
sub_10026DD1	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10026F58:				; CODE XREF: DllEntryPoint+11j
		push	2Ch
		push	offset dword_1002B7F8
		call	__SEH_prolog4
		mov	ecx, [ebp+arg_4]
		xor	edx, edx
		inc	edx
		mov	[ebp+var_1C], edx
		xor	esi, esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	dword_100306B8,	ecx
		cmp	ecx, esi
		jnz	short loc_10026F8C
		cmp	dword_10032694,	esi
		jnz	short loc_10026F8C
		mov	[ebp+var_1C], esi
		jmp	loc_10027192
; ---------------------------------------------------------------------------

loc_10026F8C:				; CODE XREF: DllEntryPoint-23Aj
					; DllEntryPoint-232j
		cmp	ecx, edx
		jz	short loc_10026F99
		cmp	ecx, 2
		jnz	loc_10027026

loc_10026F99:				; CODE XREF: DllEntryPoint-226j
		mov	eax, dword_10032B48
		cmp	eax, esi
		jz	short loc_10026FD8
		mov	[ebp+ms_exc.registration.TryLevel], edx
		mov	dword_10032698,	edx
		push	[ebp+arg_8]
		push	ecx
		push	[ebp+arg_0]
		call	eax ; dword_10032B48
		mov	[ebp+var_1C], eax
		jmp	short loc_10026FD5
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10026FB9	proc near		; DATA XREF: .rdata:1002B818o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-20h], ecx
		push	eax
		push	ecx
		call	sub_10026D6B
		pop	ecx
		pop	ecx
		retn
sub_10026FB9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10026FCD	proc near		; DATA XREF: .rdata:1002B81Co
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10026FCD	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10026FD5:				; CODE XREF: DllEntryPoint-1FDj
		mov	[ebp+ms_exc.registration.TryLevel], esi

loc_10026FD8:				; CODE XREF: DllEntryPoint-214j
		cmp	[ebp+var_1C], esi
		jz	loc_10027192
		mov	[ebp+ms_exc.registration.TryLevel], 2
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10026DD1
		mov	[ebp+var_1C], eax
		jmp	short loc_10027017
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10026FFB	proc near		; DATA XREF: .rdata:1002B824o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-24h], ecx
		push	eax
		push	ecx
		call	sub_10026D6B
		pop	ecx
		pop	ecx
		retn
sub_10026FFB	endp


; =============== S U B	R O U T	I N E =======================================


sub_1002700F	proc near		; DATA XREF: .rdata:1002B828o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_1002700F	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10027017:				; CODE XREF: DllEntryPoint-1BBj
		mov	[ebp+ms_exc.registration.TryLevel], esi
		cmp	[ebp+var_1C], esi
		jz	loc_10027192
		mov	ecx, [ebp+arg_4]

loc_10027026:				; CODE XREF: DllEntryPoint-221j
		mov	[ebp+ms_exc.registration.TryLevel], 3
		push	[ebp+arg_8]
		push	ecx
		push	[ebp+arg_0]
		call	sub_10024DD0
		mov	[ebp+var_1C], eax
		jmp	short loc_1002705A
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_1002703E	proc near		; DATA XREF: .rdata:1002B830o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-28h], ecx
		push	eax
		push	ecx
		call	sub_10026D6B
		pop	ecx
		pop	ecx
		retn
sub_1002703E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10027052	proc near		; DATA XREF: .rdata:1002B834o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10027052	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1002705A:				; CODE XREF: DllEntryPoint-178j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		cmp	[ebp+arg_4], 1
		jnz	loc_10027103
		cmp	[ebp+var_1C], esi
		jnz	loc_10027103
		mov	[ebp+ms_exc.registration.TryLevel], 4
		push	esi
		push	esi
		push	[ebp+arg_0]
		call	sub_10024DD0
		jmp	short loc_1002709C
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10027083	proc near		; DATA XREF: .rdata:1002B83Co
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-2Ch], ecx
		push	eax
		push	ecx
		call	sub_10026D6B
		pop	ecx
		pop	ecx
		retn
sub_10027083	endp


; =============== S U B	R O U T	I N E =======================================


sub_10027097	proc near		; DATA XREF: .rdata:1002B840o
		mov	esp, [ebp-18h]
		xor	esi, esi
sub_10027097	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1002709C:				; CODE XREF: DllEntryPoint-133j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	[ebp+ms_exc.registration.TryLevel], 5
		push	esi
		push	esi
		push	[ebp+arg_0]
		call	sub_10026DD1
		jmp	short loc_100270CB
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100270B2	proc near		; DATA XREF: .rdata:1002B848o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-30h], ecx
		push	eax
		push	ecx
		call	sub_10026D6B
		pop	ecx
		pop	ecx
		retn
sub_100270B2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100270C6	proc near		; DATA XREF: .rdata:1002B84Co
		mov	esp, [ebp-18h]
		xor	esi, esi
sub_100270C6	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_100270CB:				; CODE XREF: DllEntryPoint-104j
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, dword_10032B48
		cmp	eax, esi
		jz	short loc_10027103
		mov	[ebp+ms_exc.registration.TryLevel], 6
		push	esi
		push	esi
		push	[ebp+arg_0]
		call	eax ; dword_10032B48
		jmp	short loc_10027100
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100270E7	proc near		; DATA XREF: .rdata:1002B854o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-34h], ecx
		push	eax
		push	ecx
		call	sub_10026D6B
		pop	ecx
		pop	ecx
		retn
sub_100270E7	endp


; =============== S U B	R O U T	I N E =======================================


sub_100270FB	proc near		; DATA XREF: .rdata:1002B858o
		mov	esp, [ebp-18h]
		xor	esi, esi
sub_100270FB	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10027100:				; CODE XREF: DllEntryPoint-CFj
		mov	[ebp+ms_exc.registration.TryLevel], esi

loc_10027103:				; CODE XREF: DllEntryPoint-153j
					; DllEntryPoint-14Aj ...
		cmp	[ebp+arg_4], esi
		jz	short loc_10027112
		cmp	[ebp+arg_4], 3
		jnz	loc_10027192

loc_10027112:				; CODE XREF: DllEntryPoint-AEj
		mov	[ebp+ms_exc.registration.TryLevel], 7
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	sub_10026DD1
		mov	[ebp+var_1C], eax
		jmp	short loc_10027148
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_1002712C	proc near		; DATA XREF: .rdata:1002B860o
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-38h], ecx
		push	eax
		push	ecx
		call	sub_10026D6B
		pop	ecx
		pop	ecx
		retn
sub_1002712C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10027140	proc near		; DATA XREF: .rdata:1002B864o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10027140	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_10027148:				; CODE XREF: DllEntryPoint-8Aj
		mov	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, dword_10032B48
		cmp	eax, esi
		jz	short loc_10027192
		cmp	dword_10032698,	esi
		jz	short loc_10027192
		mov	[ebp+ms_exc.registration.TryLevel], 8
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	eax ; dword_10032B48
		mov	[ebp+var_1C], eax
		jmp	short loc_1002718F
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_10027173	proc near		; DATA XREF: .rdata:1002B86Co
		mov	eax, [ebp-14h]
		mov	ecx, [eax]
		mov	ecx, [ecx]
		mov	[ebp-3Ch], ecx
		push	eax
		push	ecx
		call	sub_10026D6B
		pop	ecx
		pop	ecx
		retn
sub_10027173	endp


; =============== S U B	R O U T	I N E =======================================


sub_10027187	proc near		; DATA XREF: .rdata:1002B870o
		mov	esp, [ebp-18h]
		xor	esi, esi
		mov	[ebp-1Ch], esi
sub_10027187	endp ; sp-analysis failed

; START	OF FUNCTION CHUNK FOR DllEntryPoint

loc_1002718F:				; CODE XREF: DllEntryPoint-43j
		mov	[ebp+ms_exc.registration.TryLevel], esi

loc_10027192:				; CODE XREF: DllEntryPoint-22Dj
					; DllEntryPoint-1D9j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	sub_100271A9
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn	0Ch
; END OF FUNCTION CHUNK	FOR DllEntryPoint

; =============== S U B	R O U T	I N E =======================================


sub_100271A9	proc near		; CODE XREF: DllEntryPoint-1Bp
					; DATA XREF: .rdata:1002B810o
		mov	dword_100306B8,	0FFFFFFFFh
		retn
sub_100271A9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
		public DllEntryPoint
DllEntryPoint	proc near

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

; FUNCTION CHUNK AT 10026F58 SIZE 00000061 BYTES
; FUNCTION CHUNK AT 10026FD5 SIZE 00000026 BYTES
; FUNCTION CHUNK AT 10027017 SIZE 00000027 BYTES
; FUNCTION CHUNK AT 1002705A SIZE 00000029 BYTES
; FUNCTION CHUNK AT 1002709C SIZE 00000016 BYTES
; FUNCTION CHUNK AT 100270CB SIZE 0000001C BYTES
; FUNCTION CHUNK AT 10027100 SIZE 0000002C BYTES
; FUNCTION CHUNK AT 10027148 SIZE 0000002B BYTES
; FUNCTION CHUNK AT 1002718F SIZE 0000001A BYTES

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		jnz	short loc_100271C4
		call	sub_1002750D

loc_100271C4:				; CODE XREF: DllEntryPoint+9j
		pop	ebp
		jmp	loc_10026F58
DllEntryPoint	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100271CA	proc near		; CODE XREF: __security_check_cookie(x):$failure$3j

var_328		= dword	ptr -328h
var_324		= dword	ptr -324h
var_320		= dword	ptr -320h
var_s0		= dword	ptr  0
arg_0		= byte ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 328h
		mov	dword_100327A0,	eax
		mov	dword_1003279C,	ecx
		mov	dword_10032798,	edx
		mov	dword_10032794,	ebx
		mov	dword_10032790,	esi
		mov	dword_1003278C,	edi
		mov	word_100327B8, ss
		mov	word_100327AC, cs
		mov	word_10032788, ds
		mov	word_10032784, es
		mov	word_10032780, fs
		mov	word_1003277C, gs
		pushf
		pop	dword_100327B0
		mov	eax, [ebp+var_s0]
		mov	dword_100327A4,	eax
		mov	eax, [ebp+4]
		mov	dword_100327A8,	eax
		lea	eax, [ebp+arg_0]
		mov	dword_100327B4,	eax
		mov	eax, [ebp+var_320]
		mov	dword_100326F0,	10001h
		mov	eax, dword_100327A8
		mov	dword_100326AC,	eax
		mov	dword_100326A0,	0C0000409h
		mov	dword_100326A4,	1
		mov	eax, ___security_cookie
		mov	[ebp+var_328], eax
		mov	eax, dword_1003069C
		mov	[ebp+var_324], eax
		push	0		; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		push	offset ExceptionInfo ; ExceptionInfo
		call	ds:UnhandledExceptionFilter
		push	0C0000409h	; uExitCode
		call	ds:GetCurrentProcess
		push	eax		; hProcess
		call	ds:TerminateProcess
		leave
		retn
sub_100271CA	endp

; ---------------------------------------------------------------------------
		push	ebx
		push	ecx
		mov	ebx, offset dword_100306A0
		jmp	short loc_100272C0

; =============== S U B	R O U T	I N E =======================================


sub_100272B5	proc near		; CODE XREF: sub_10026680+6Ep
					; sub_10026789+8p

arg_0		= dword	ptr  4

		push	ebx
		push	ecx
		mov	ebx, offset dword_100306A0
		mov	ecx, [esp+8+arg_0]

loc_100272C0:				; CODE XREF: .text:100272B3j
		mov	[ebx+8], ecx
		mov	[ebx+4], eax
		mov	[ebx+0Ch], ebp
		push	ebp
		push	ecx
		push	eax
		pop	eax
		pop	ecx
		pop	ebp
		pop	ecx
		pop	ebx
		retn	4
sub_100272B5	endp


; =============== S U B	R O U T	I N E =======================================


sub_100272D4	proc near		; CODE XREF: sub_10026680+7Bp
		call	eax
		retn
sub_100272D4	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100272E0	proc near		; CODE XREF: sub_10027364+16p

arg_0		= dword	ptr  8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		mov	eax, 5A4Dh
		cmp	[ecx], ax
		jz	short loc_100272F6

loc_100272F2:				; CODE XREF: sub_100272E0+21j
		xor	eax, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100272F6:				; CODE XREF: sub_100272E0+10j
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		cmp	dword ptr [eax], 4550h
		jnz	short loc_100272F2
		xor	edx, edx
		mov	ecx, 10Bh
		cmp	[eax+18h], cx
		setz	dl
		mov	eax, edx
		pop	ebp
		retn
sub_100272E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10027320	proc near		; CODE XREF: sub_10027364+27p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		movzx	eax, word ptr [ecx+14h]
		push	ebx
		push	esi
		movzx	esi, word ptr [ecx+6]
		xor	edx, edx
		push	edi
		lea	eax, [eax+ecx+18h]
		test	esi, esi
		jbe	short loc_1002735D
		mov	edi, [ebp+arg_4]

loc_10027345:				; CODE XREF: sub_10027320+3Bj
		mov	ecx, [eax+0Ch]
		cmp	edi, ecx
		jb	short loc_10027355
		mov	ebx, [eax+8]
		add	ebx, ecx
		cmp	edi, ebx
		jb	short loc_1002735F

loc_10027355:				; CODE XREF: sub_10027320+2Aj
		inc	edx
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_10027345

loc_1002735D:				; CODE XREF: sub_10027320+20j
		xor	eax, eax

loc_1002735F:				; CODE XREF: sub_10027320+33j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_10027320	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10027364	proc near		; CODE XREF: sub_100267E0+F4p
					; sub_10026DD1+E7p

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	8
		push	offset stru_1002B878
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	esi, 10000000h
		push	esi
		call	sub_100272E0
		pop	ecx
		test	eax, eax
		jz	short loc_100273C1
		mov	eax, [ebp+arg_0]
		sub	eax, esi
		push	eax
		push	esi
		call	sub_10027320
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_100273C1
		mov	eax, [eax+24h]
		shr	eax, 1Fh
		not	eax
		and	eax, 1
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_100273CA
; ---------------------------------------------------------------------------

loc_100273AA:				; DATA XREF: .rdata:stru_1002B878o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 10027364
		mov	eax, [eax]
		mov	eax, [eax]
		xor	ecx, ecx
		cmp	eax, 0C0000005h
		setz	cl
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_100273BE:				; DATA XREF: .rdata:stru_1002B878o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10027364

loc_100273C1:				; CODE XREF: sub_10027364+1Ej
					; sub_10027364+30j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	eax, eax

loc_100273CA:				; CODE XREF: sub_10027364+44j
		call	__SEH_epilog4
		retn
sub_10027364	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100273D0	proc near		; CODE XREF: sub_10027420+4Fp

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	0Ch
		push	offset stru_1002B898
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		movapd	xmm0, xmm1
		mov	[ebp+var_1C], 1
		jmp	short loc_10027410
; ---------------------------------------------------------------------------

loc_100273ED:				; DATA XREF: .rdata:stru_1002B898o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 100273D0
		mov	eax, [eax]
		mov	eax, [eax]
		cmp	eax, 0C0000005h
		jz	short loc_10027405
		cmp	eax, 0C000001Dh
		jz	short loc_10027405
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10027405:				; CODE XREF: sub_100273D0+29j
					; sub_100273D0+30j
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10027409:				; DATA XREF: .rdata:stru_1002B898o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100273D0
		and	[ebp+var_1C], 0

loc_10027410:				; CODE XREF: sub_100273D0+1Bj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
sub_100273D0	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10027420	proc near		; CODE XREF: sub_10027492p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		xor	eax, eax
		push	ebx
		mov	[ebp+var_4], eax
		mov	[ebp+var_C], eax
		mov	[ebp+var_8], eax
		push	ebx
		pushf
		pop	eax
		mov	ecx, eax
		xor	eax, 200000h
		push	eax
		popf
		pushf
		pop	edx
		sub	edx, ecx
		jz	short loc_10027465
		push	ecx
		popf
		xor	eax, eax
		cpuid
		mov	[ebp+var_C], eax
		mov	[ebp+var_18], ebx
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	eax, 1
		cpuid
		mov	[ebp+var_4], edx
		mov	[ebp+var_8], eax

loc_10027465:				; CODE XREF: sub_10027420+24j
		pop	ebx
		test	[ebp+var_4], 4000000h
		jz	short loc_1002748D
		call	sub_100273D0
		test	eax, eax
		jz	short loc_1002748D
		call	ds:GetVersion
		and	eax, 0FFh
		cmp	eax, 6
		jb	short loc_1002748D
		xor	eax, eax
		inc	eax
		jmp	short loc_1002748F
; ---------------------------------------------------------------------------

loc_1002748D:				; CODE XREF: sub_10027420+4Dj
					; sub_10027420+56j ...
		xor	eax, eax

loc_1002748F:				; CODE XREF: sub_10027420+6Bj
		pop	ebx
		leave
		retn
sub_10027420	endp


; =============== S U B	R O U T	I N E =======================================


sub_10027492	proc near		; DATA XREF: .rdata:off_1002834Co
		call	sub_10027420
		mov	dword_100306B0,	eax
		xor	eax, eax
		retn
sub_10027492	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _XcptFilter]
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000045 BYTES: COLLAPSED FUNCTION __SEH_prolog4]
; [00000014 BYTES: COLLAPSED FUNCTION __SEH_epilog4]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1002750D	proc near		; CODE XREF: DllEntryPoint+Bp

PerformanceCount= LARGE_INTEGER	ptr -10h
SystemTimeAsFileTime= _FILETIME	ptr -8

		mov	edi, edi
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ___security_cookie
		and	[ebp+SystemTimeAsFileTime.dwLowDateTime], 0
		and	[ebp+SystemTimeAsFileTime.dwHighDateTime], 0
		push	ebx
		push	edi
		mov	edi, 0BB40E64Eh
		mov	ebx, 0FFFF0000h
		cmp	eax, edi
		jz	short loc_1002753F
		test	ebx, eax
		jz	short loc_1002753F
		not	eax
		mov	dword_1003069C,	eax
		jmp	short loc_1002759A
; ---------------------------------------------------------------------------

loc_1002753F:				; CODE XREF: sub_1002750D+23j
					; sub_1002750D+27j
		push	esi
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		mov	esi, [ebp+SystemTimeAsFileTime.dwHighDateTime]
		xor	esi, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		call	ds:GetCurrentProcessId
		xor	esi, eax
		call	ds:GetCurrentThreadId
		xor	esi, eax
		call	ds:GetTickCount
		xor	esi, eax
		lea	eax, [ebp+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		mov	eax, dword ptr [ebp+PerformanceCount+4]
		xor	eax, dword ptr [ebp+PerformanceCount]
		xor	esi, eax
		cmp	esi, edi
		jz	short loc_10027586
		test	___security_cookie, ebx
		jnz	short loc_1002758B

loc_10027586:				; CODE XREF: sub_1002750D+6Fj
		mov	esi, 0BB40E64Fh

loc_1002758B:				; CODE XREF: sub_1002750D+77j
		mov	___security_cookie, esi
		not	esi
		mov	dword_1003069C,	esi
		pop	esi

loc_1002759A:				; CODE XREF: sub_1002750D+30j
		pop	edi
		pop	ebx
		leave
		retn
sub_1002750D	endp

; [00000006 BYTES: COLLAPSED FUNCTION RtlUnwind]
		align 80h
		dd 280h	dup(?)
_text		ends

; Section 2. (virtual address 00028000)
; Virtual size			: 00007377 (  29559.)
; Section size in file		: 00007400 (  29696.)
; Offset to raw	data for section: 00026A00
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; BOOL __stdcall AllocateAndInitializeSid(PSID_IDENTIFIER_AUTHORITY pIdentifierAuthority, BYTE nSubAuthorityCount, DWORD nSubAuthority0, DWORD nSubAuthority1, DWORD nSubAuthority2, DWORD nSubAuthority3, DWORD nSubAuthority4, DWORD nSubAuthority5, DWORD nSubAuthority6, DWORD nSubAuthority7, PSID	*pSid)
		extrn AllocateAndInitializeSid:dword ; CODE XREF: sub_1001CE50+131p
					; DATA XREF: sub_1001CE50+131r	...
; BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid)
		extrn CopySid:dword	; CODE XREF: sub_1001CE50+CFp
					; sub_1001CE50+10Dp
					; DATA XREF: ...
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn GetLengthSid:dword ; CODE	XREF: sub_1001CE50+AAp
					; sub_1001CE50+EEp ...
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn GetTokenInformation:dword	; CODE XREF: sub_1001CE50+9Dp
					; sub_1001CE50+E7p
					; DATA XREF: ...
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: sub_1001CE50+3Ap
					; DATA XREF: sub_1001CE50+3Ar
; PVOID	__stdcall FreeSid(PSID pSid)
		extrn FreeSid:dword	; CODE XREF: sub_1001CFA0+2Ep
					; DATA XREF: sub_1001CFA0+2Er
; BOOL __stdcall SetSecurityDescriptorDacl(PSECURITY_DESCRIPTOR	pSecurityDescriptor, BOOL bDaclPresent,	PACL pDacl, BOOL bDaclDefaulted)
		extrn SetSecurityDescriptorDacl:dword ;	CODE XREF: sub_1001CFE0+1FAp
					; DATA XREF: sub_1001CFE0+1FAr
; BOOL __stdcall AddAccessAllowedAce(PACL pAcl,	DWORD dwAceRevision, DWORD AccessMask, PSID pSid)
		extrn AddAccessAllowedAce:dword	; CODE XREF: sub_1001CFE0+155p
					; sub_1001CFE0+198p ...
; BOOL __stdcall InitializeAcl(PACL pAcl, DWORD	nAclLength, DWORD dwAclRevision)
		extrn InitializeAcl:dword ; CODE XREF: sub_1001CFE0+102p
					; DATA XREF: sub_1001CFE0+102r
; BOOL __stdcall SetSecurityDescriptorGroup(PSECURITY_DESCRIPTOR pSecurityDescriptor, PSID pGroup, BOOL	bGroupDefaulted)
		extrn SetSecurityDescriptorGroup:dword ; CODE XREF: sub_1001CFE0+9Bp
					; DATA XREF: sub_1001CFE0+9Br
; BOOL __stdcall SetSecurityDescriptorOwner(PSECURITY_DESCRIPTOR pSecurityDescriptor, PSID pOwner, BOOL	bOwnerDefaulted)
		extrn SetSecurityDescriptorOwner:dword ; CODE XREF: sub_1001CFE0+76p
					; DATA XREF: sub_1001CFE0+76r
; BOOL __stdcall InitializeSecurityDescriptor(PSECURITY_DESCRIPTOR pSecurityDescriptor,	DWORD dwRevision)
		extrn InitializeSecurityDescriptor:dword ; CODE	XREF: sub_1001CFE0+52p
					; DATA XREF: sub_1001CFE0+52r

;
; Imports from KERNEL32.dll
;
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_1002750D+37p
					; DATA XREF: sub_1002750D+37r ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_1002750D+43p
					; DATA XREF: sub_1002750D+43r
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_1002750D+4Bp
					; DATA XREF: sub_1002750D+4Br
; DWORD	__stdcall GetVersion()
		extrn GetVersion:dword	; CODE XREF: sub_10027420+58p
					; DATA XREF: sub_10027420+58r
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_100271CA+BDp
					; DATA XREF: sub_100271CA+BDr
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: sub_100271CA+C8p
					; DATA XREF: sub_100271CA+C8r
; void __stdcall RtlUnwind(PVOID TargetFrame, PVOID TargetIp, PEXCEPTION_RECORD	ExceptionRecord, PVOID ReturnValue)
		extrn __imp_RtlUnwind:dword ; DATA XREF: RtlUnwindr
; HANDLE __stdcall OpenFileMappingA(DWORD dwDesiredAccess, BOOL	bInheritHandle,	LPCSTR lpName)
		extrn OpenFileMappingA:dword ; CODE XREF: sub_10025F70+29Fp
					; DATA XREF: sub_10025F70+29Fr
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: PR_GetRandomNoise_0+85p
					; sub_1002750D+53p
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: PR_GetRandomNoise_0+18p
					; sub_1002750D+5Fp
					; DATA XREF: ...
; HANDLE __stdcall OpenSemaphoreA(DWORD	dwDesiredAccess, BOOL bInheritHandle, LPCSTR lpName)
		extrn OpenSemaphoreA:dword ; CODE XREF:	sub_100255F0+11Bp
					; DATA XREF: sub_100255F0+11Br
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn SetLastError:dword ; CODE	XREF: sub_10024C90+59p
					; sub_10025570+66p
					; DATA XREF: ...
; void __stdcall SwitchToFiber(LPVOID lpFiber)
		extrn SwitchToFiber:dword ; CODE XREF: sub_10024C90+BEp
					; DATA XREF: sub_10024C90+BEr
; LPVOID __stdcall CreateFiber(SIZE_T dwStackSize, LPFIBER_START_ROUTINE lpStartAddress, LPVOID	lpParameter)
		extrn CreateFiber:dword	; CODE XREF: sub_10024C20+1Dp
					; DATA XREF: sub_10024C20+1Dr
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword ; CODE	XREF: sub_100249E0+14p
					; sub_10024A40+F1p
					; DATA XREF: ...
; DWORD	__stdcall SuspendThread(HANDLE hThread)
		extrn SuspendThread:dword ; CODE XREF: sub_100249C0+14p
					; DATA XREF: sub_100249C0+14r
; BOOL __stdcall GetProcessAffinityMask(HANDLE hProcess, PDWORD_PTR lpProcessAffinityMask, PDWORD_PTR lpSystemAffinityMask)
		extrn GetProcessAffinityMask:dword
					; CODE XREF: PR_GetThreadAffinityMask_0+11p
					; DATA XREF: PR_GetThreadAffinityMask_0+11r
; DWORD_PTR __stdcall SetThreadAffinityMask(HANDLE hThread, DWORD_PTR dwThreadAffinityMask)
		extrn SetThreadAffinityMask:dword
					; CODE XREF: PR_SetThreadAffinityMask_0+10p
					; DATA XREF: PR_SetThreadAffinityMask_0+10r
; LPVOID __stdcall ConvertThreadToFiber(LPVOID lpParameter)
		extrn ConvertThreadToFiber:dword ; CODE	XREF: sub_100248D0+5p
					; DATA XREF: sub_100248D0+5r
; BOOL __stdcall IsDebuggerPresent()
		extrn IsDebuggerPresent:dword ;	CODE XREF: sub_10024650+33p
					; DATA XREF: sub_10024650+33r
; void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments)
		extrn RaiseException:dword ; CODE XREF:	sub_10024650+65p
					; DATA XREF: sub_10024650+65r
; BOOL __stdcall SetThreadPriority(HANDLE hThread, int nPriority)
		extrn SetThreadPriority:dword ;	CODE XREF: sub_100245D0+45p
					; DATA XREF: sub_100245D0+45r
; HANDLE __stdcall GetCurrentThread()
		extrn GetCurrentThread:dword ; CODE XREF: sub_100244D0+40p
					; DATA XREF: sub_100244D0+40r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: sub_100244D0+4Ap
					; PR_OpenAnonFileMap_0+5Ap
					; DATA XREF: ...
; HANDLE __stdcall CreateEventA(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState,	LPCSTR lpName)
		extrn CreateEventA:dword ; CODE	XREF: sub_100244D0+7Fp
					; DATA XREF: sub_100244D0+7Fr
; BOOL __stdcall TlsFree(DWORD dwTlsIndex)
		extrn TlsFree:dword	; CODE XREF: sub_10024480+20p
					; sub_10024480+29p ...
; DWORD	__stdcall TlsAlloc()
		extrn TlsAlloc:dword	; CODE XREF: sub_10024420+34p
					; sub_10024420+3Bp ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_10022C00+188p
					; sub_100245C0+2p ...
; BOOL __stdcall CancelIo(HANDLE hFile)
		extrn CancelIo:dword	; CODE XREF: PR_NT_CancelIo+72p
					; DATA XREF: PR_NT_CancelIo+72r
; DWORD	__stdcall GetLogicalDriveStringsA(DWORD	nBufferLength, LPSTR lpBuffer)
		extrn GetLogicalDriveStringsA:dword ; CODE XREF: sub_10022490+1Ep
					; sub_10022490+58p
					; DATA XREF: ...
; UINT __stdcall SetErrorMode(UINT uMode)
		extrn SetErrorMode:dword ; CODE	XREF: sub_10022490+86p
					; sub_10022490+1CBp ...
; UINT __stdcall GetDriveTypeA(LPCSTR lpRootPathName)
		extrn GetDriveTypeA:dword ; CODE XREF: sub_10022490+F5p
					; DATA XREF: sub_10022490+F5r
; BOOL __stdcall GetVolumeInformationA(LPCSTR lpRootPathName, LPSTR lpVolumeNameBuffer,	DWORD nVolumeNameSize, LPDWORD lpVolumeSerialNumber, LPDWORD lpMaximumComponentLength, LPDWORD lpFileSystemFlags, LPSTR	lpFileSystemNameBuffer,	DWORD nFileSystemNameSize)
		extrn GetVolumeInformationA:dword ; CODE XREF: sub_10022490+165p
					; sub_100226A0+F7p
					; DATA XREF: ...
; int __stdcall	lstrlenA(LPCSTR	lpString)
		extrn lstrlenA:dword	; CODE XREF: sub_10022490+1A0p
					; DATA XREF: sub_10022490+1A0r
; BOOL __stdcall UnlockFileEx(HANDLE hFile, DWORD dwReserved, DWORD nNumberOfBytesToUnlockLow, DWORD nNumberOfBytesToUnlockHigh, LPOVERLAPPED lpOverlapped)
		extrn UnlockFileEx:dword ; CODE	XREF: sub_100223F0+5Dp
					; DATA XREF: sub_100223F0+5Dr
; BOOL __stdcall LockFileEx(HANDLE hFile, DWORD	dwFlags, DWORD dwReserved, DWORD nNumberOfBytesToLockLow, DWORD	nNumberOfBytesToLockHigh, LPOVERLAPPED lpOverlapped)
		extrn LockFileEx:dword	; CODE XREF: sub_10021CD0+EAp
					; sub_10021FF0+EAp
					; DATA XREF: ...
; BOOL __stdcall RemoveDirectoryA(LPCSTR lpPathName)
		extrn RemoveDirectoryA:dword ; CODE XREF: sub_10021CA0+7p
					; DATA XREF: sub_10021CA0+7r
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: sub_10021BD0+9p
					; sub_10021C00+5Ap
					; DATA XREF: ...
; BOOL __stdcall MoveFileA(LPCSTR lpExistingFileName, LPCSTR lpNewFileName)
		extrn MoveFileA:dword	; CODE XREF: sub_10021B10+Bp
					; DATA XREF: sub_10021B10+Br
; BOOL __stdcall GetFileInformationByHandle(HANDLE hFile, LPBY_HANDLE_FILE_INFORMATION lpFileInformation)
		extrn GetFileInformationByHandle:dword ; CODE XREF: sub_100219A0+1Fp
					; sub_10021A70+1Ep ...
; BOOL __stdcall GetFileAttributesExA(LPCSTR lpFileName, GET_FILEEX_INFO_LEVELS	fInfoLevelId, LPVOID lpFileInformation)
		extrn GetFileAttributesExA:dword ; CODE	XREF: sub_10021820+42p
					; DATA XREF: sub_10021820+42r
; BOOL __stdcall DeleteFileA(LPCSTR lpFileName)
		extrn DeleteFileA:dword	; CODE XREF: sub_100215E0+7p
					; DATA XREF: sub_100215E0+7r
; BOOL __stdcall FindNextFileA(HANDLE hFindFile, LPWIN32_FIND_DATAA lpFindFileData)
		extrn FindNextFileA:dword ; CODE XREF: sub_100214D0+4Cp
					; DATA XREF: sub_100214D0+4Cr
; HANDLE __stdcall FindFirstFileA(LPCSTR lpFileName, LPWIN32_FIND_DATAA	lpFindFileData)
		extrn FindFirstFileA:dword ; CODE XREF:	sub_100212E0+19Dp
					; DATA XREF: sub_100212E0+19Dr
; BOOL __stdcall FindClose(HANDLE hFindFile)
		extrn FindClose:dword	; CODE XREF: sub_10021280+Fp
					; DATA XREF: sub_10021280+Fr
; BOOL __stdcall GetHandleInformation(HANDLE hObject, LPDWORD lpdwFlags)
		extrn GetHandleInformation:dword ; CODE	XREF: sub_100211E0+20p
					; DATA XREF: sub_100211E0+20r
; BOOL __stdcall SetHandleInformation(HANDLE hObject, DWORD dwMask, DWORD dwFlags)
		extrn SetHandleInformation:dword ; CODE	XREF: sub_10021140+3Ap
					; DATA XREF: sub_10021140+3Ar
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_10020200+D2p
					; sub_10020340+128p
					; DATA XREF: ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	sub_10020200+107p
					; sub_10020340+173p ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_1001FA30+1A4p
					; sub_10020970+B8p ...
; DWORD	__stdcall WaitForMultipleObjects(DWORD nCount, const HANDLE *lpHandles,	BOOL bWaitAll, DWORD dwMilliseconds)
		extrn WaitForMultipleObjects:dword ; CODE XREF:	sub_1001E8D0+4Ep
					; DATA XREF: sub_1001E8D0+4Er
; BOOL __stdcall GetOverlappedResult(HANDLE hFile, LPOVERLAPPED	lpOverlapped, LPDWORD lpNumberOfBytesTransferred, BOOL bWait)
		extrn GetOverlappedResult:dword	; CODE XREF: sub_1001E8D0+102p
					; sub_100204F0+10Cp ...
; BOOL __stdcall ResetEvent(HANDLE hEvent)
		extrn ResetEvent:dword	; CODE XREF: sub_1001E760+8Fp
					; sub_1001E8D0+144p
					; DATA XREF: ...
; HANDLE __stdcall CreateIoCompletionPort(HANDLE FileHandle, HANDLE ExistingCompletionPort, ULONG_PTR CompletionKey, DWORD NumberOfConcurrentThreads)
		extrn CreateIoCompletionPort:dword ; CODE XREF:	sub_1001DFF0+41p
					; sub_1001E100+1Ep
					; DATA XREF: ...
; BOOL __stdcall PostQueuedCompletionStatus(HANDLE CompletionPort, DWORD dwNumberOfBytesTransferred, ULONG_PTR dwCompletionKey,	LPOVERLAPPED lpOverlapped)
		extrn PostQueuedCompletionStatus:dword ; CODE XREF: sub_1001DF20+19p
					; sub_1001DF20+B7p
					; DATA XREF: ...
; void __stdcall DeleteFiber(LPVOID lpFiber)
		extrn DeleteFiber:dword	; CODE XREF: sub_1001D3C0+8Bp
					; DATA XREF: sub_1001D3C0+8Br
; BOOL __stdcall GetQueuedCompletionStatus(HANDLE CompletionPort, LPDWORD lpNumberOfBytesTransferred, PULONG_PTR lpCompletionKey, LPOVERLAPPED *lpOverlapped, DWORD dwMilliseconds)
		extrn GetQueuedCompletionStatus:dword ;	CODE XREF: sub_1001D3C0+122p
					; DATA XREF: sub_1001D3C0+122r
; BOOL __stdcall GetThreadContext(HANDLE hThread, LPCONTEXT lpContext)
		extrn GetThreadContext:dword ; CODE XREF: PR_GetGCRegisters_0+4Dp
					; DATA XREF: PR_GetGCRegisters_0+4Dr
; BOOL __stdcall ReleaseSemaphore(HANDLE hSemaphore, LONG lReleaseCount, LPLONG	lpPreviousCount)
		extrn ReleaseSemaphore:dword ; CODE XREF: sub_1001D3C0+436p
					; sub_1001D3C0+782p ...
; HANDLE __stdcall CreateSemaphoreA(LPSECURITY_ATTRIBUTES lpSemaphoreAttributes, LONG lInitialCount, LONG lMaximumCount, LPCSTR	lpName)
		extrn CreateSemaphoreA:dword ; CODE XREF: sub_100244D0+59p
					; sub_100255F0+8Bp
					; DATA XREF: ...
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_1001CE50+33p
					; sub_100244D0+3Dp ...
; BOOL __stdcall FlushViewOfFile(LPCVOID lpBaseAddress,	SIZE_T dwNumberOfBytesToFlush)
		extrn FlushViewOfFile:dword ; CODE XREF: PR_SyncMemMap_0+15p
					; DATA XREF: PR_SyncMemMap_0+15r
; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
		extrn FlushFileBuffers:dword ; CODE XREF: PR_SyncMemMap_0+20p
					; sub_10020FA0+10p
					; DATA XREF: ...
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; CODE XREF: PR_MemUnmap_0+5p
					; PR_DetachSharedMemory_0+8p
					; DATA XREF: ...
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap)
		extrn MapViewOfFile:dword ; CODE XREF: sub_1001CC90+1Cp
					; PR_AttachSharedMemory_0+23p
					; DATA XREF: ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_1001CC90+44p
					; DATA XREF: sub_1001CC90+44r
; HANDLE __stdcall CreateFileMappingA(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCSTR lpName)
		extrn CreateFileMappingA:dword ; CODE XREF: sub_1001CBE0+5Bp
					; sub_10025F70+1BDp
					; DATA XREF: ...
; BOOL __stdcall GetVersionExA(LPOSVERSIONINFOA	lpVersionInformation)
		extrn GetVersionExA:dword ; CODE XREF: sub_1001CA00+3Dp
					; sub_1001DFF0+73p
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: PR_KillProcess_0+Cp
					; sub_100271CA+DAp
					; DATA XREF: ...
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: PR_WaitProcess_0+Ap
					; sub_1001DB80+6Ap ...
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: PR_WaitProcess_0+3Ap
					; DATA XREF: PR_WaitProcess_0+3Ar
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	PR_CreateProcess_0+273p
					; DATA XREF: PR_CreateProcess_0+273r
; LPCH __stdcall GetEnvironmentStrings()
		extrn GetEnvironmentStrings:dword ; CODE XREF: sub_1001C480+16p
					; DATA XREF: sub_1001C480+16r
; BOOL __stdcall FreeEnvironmentStringsA(LPCH)
		extrn FreeEnvironmentStringsA:dword ; CODE XREF: sub_1001C480+E9p
					; sub_1001C480+10Fp
					; DATA XREF: ...
; void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime)
		extrn GetSystemTime:dword ; CODE XREF: PR_Now+13p
					; DATA XREF: PR_Now+13r
; BOOL __stdcall SystemTimeToFileTime(const SYSTEMTIME *lpSystemTime, LPFILETIME lpFileTime)
		extrn SystemTimeToFileTime:dword ; CODE	XREF: PR_Now+23p
					; DATA XREF: PR_Now+23r
; BOOL __stdcall TryEnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn TryEnterCriticalSection:dword ; CODE XREF: PR_TestAndLock+25p
					; DATA XREF: PR_TestAndLock+25r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: sub_10014A90+30p
					; sub_10014A90+69p ...
; BOOL __stdcall CreatePipe(PHANDLE hReadPipe, PHANDLE hWritePipe, LPSECURITY_ATTRIBUTES lpPipeAttributes, DWORD nSize)
		extrn CreatePipe:dword	; CODE XREF: PR_CreatePipe+41p
					; DATA XREF: PR_CreatePipe+41r
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: PR_CreatePipe+8Fp
					; PR_CreatePipe+96p ...
; BOOL __stdcall GlobalMemoryStatusEx(LPMEMORYSTATUSEX lpBuffer)
		extrn GlobalMemoryStatusEx:dword ; CODE	XREF: PR_GetPhysicalMemorySize+21p
					; DATA XREF: PR_GetPhysicalMemorySize+21r
; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
		extrn InterlockedExchange:dword	; CODE XREF: PR_AtomicSet+Ap
					; sub_10026DD1+D4p ...
; void __stdcall GetSystemInfo(LPSYSTEM_INFO lpSystemInfo)
		extrn GetSystemInfo:dword ; CODE XREF: sub_10008AD0+7p
					; PR_GetNumberOfProcessors+7p ...
; HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName)
		extrn GetModuleHandleW:dword ; CODE XREF: PR_GetLibraryFilePathname+42p
					; DATA XREF: PR_GetLibraryFilePathname+42r
; DWORD	__stdcall GetModuleFileNameW(HMODULE hModule, LPWSTR lpFilename, DWORD nSize)
		extrn GetModuleFileNameW:dword ; CODE XREF: PR_GetLibraryFilePathname+C0p
					; DATA XREF: PR_GetLibraryFilePathname+C0r
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_100085A0+67p
					; PR_FindSymbolAndLibrary+B2p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: PR_UnloadLibrary+9Ap
					; DATA XREF: PR_UnloadLibrary+9Ar
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_10008220+6Dp
					; sub_10008220+9Cp ...
; HMODULE __stdcall LoadLibraryExW(LPCWSTR lpLibFileName, HANDLE hFile,	DWORD dwFlags)
		extrn LoadLibraryExW:dword ; CODE XREF:	sub_10008220+1D0p
					; DATA XREF: sub_10008220+1D0r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_10007F20+3Fp
					; sub_1000CDA0+2p
					; DATA XREF: ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_10005C10+524p
					; sub_10005C10+54Dp ...
; void __stdcall DebugBreak()
		extrn DebugBreak:dword	; CODE XREF: PR_Assert+46p
					; DATA XREF: PR_Assert+46r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: PR_LogFlush+55p
					; PR_LogFlush+13Ap ...
; BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue)
		extrn TlsSetValue:dword	; CODE XREF: PR_LogFlush+84p
					; PR_LogFlush+19Dp ...
; void __stdcall OutputDebugStringA(LPCSTR lpOutputString)
		extrn OutputDebugStringA:dword ; CODE XREF: PR_LogFlush+C0p
					; PR_LogPrint+1DBp ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: PR_AddWaitFileDesc+15Dp
					; PR_AddWaitFileDesc+1E2p ...
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: PR_AddWaitFileDesc+1D8p
					; sub_1001F6C0+1A5p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: PR_DestroyWaitGroup+9Bp
					; sub_10018C30+8p ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: PR_CreateWaitGroup+10Ep
					; sub_10017C80+1Ap ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_10001930+9p
					; PR_CancelWaitGroup+9Dp ...
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_10001930+36p
					; PR_CancelWaitGroup+17Cp ...
; LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination,	LONG Exchange, LONG Comperand)
		extrn InterlockedCompareExchange:dword ; CODE XREF: .text:100018D0p
					; PR_CancelWaitFileDesc+6Ep ...

;
; Imports from WINMM.dll
;
; DWORD	__stdcall timeGetTime()
		extrn __imp_timeGetTime:dword ;	DATA XREF: timeGetTimer
					; .rdata:1002B8ECo

;
; Imports from WSOCK32.dll
;
; struct hostent *__stdcall gethostbyname(const	char *name)
		extrn __imp_gethostbyname:dword	; DATA XREF: gethostbynamer
					; .rdata:1002B8D8o
; struct hostent *__stdcall gethostbyaddr(const	char *addr, int	len, int type)
		extrn __imp_gethostbyaddr:dword	; DATA XREF: gethostbyaddrr
; struct protoent *__stdcall getprotobyname(const char *name)
		extrn __imp_getprotobyname:dword ; DATA	XREF: getprotobynamer
; struct protoent *__stdcall getprotobynumber(int number)
		extrn __imp_getprotobynumber:dword ; DATA XREF:	getprotobynumberr
; u_short __stdcall htons(u_short hostshort)
		extrn __imp_htons:dword	; DATA XREF: htonsr
; u_short __stdcall ntohs(u_short netshort)
		extrn __imp_ntohs:dword	; DATA XREF: ntohsr
; u_long __stdcall ntohl(u_long	netlong)
		extrn __imp_ntohl:dword	; DATA XREF: ntohlr
; int __stdcall	getsockopt(SOCKET s, int level,	int optname, char *optval, int *optlen)
		extrn __imp_getsockopt:dword ; DATA XREF: getsockoptr
; SOCKET __stdcall accept(SOCKET s, struct sockaddr *addr, int *addrlen)
		extrn __imp_accept:dword ; DATA	XREF: acceptr
; int __stdcall	connect(SOCKET s, const	struct sockaddr	*name, int namelen)
		extrn __imp_connect:dword ; DATA XREF: connectr
; int __stdcall	listen(SOCKET s, int backlog)
		extrn __imp_listen:dword ; DATA	XREF: listenr
; int __stdcall	getsockname(SOCKET s, struct sockaddr *name, int *namelen)
		extrn __imp_getsockname:dword ;	DATA XREF: getsocknamer
; int __stdcall	bind(SOCKET s, const struct sockaddr *name, int	namelen)
		extrn __imp_bind:dword	; DATA XREF: bindr
; SOCKET __stdcall socket(int af, int type, int	protocol)
		extrn __imp_socket:dword ; DATA	XREF: socketr
; int __stdcall	gethostname(char *name,	int namelen)
		extrn __imp_gethostname:dword ;	DATA XREF: gethostnamer
; u_long __stdcall htonl(u_long	hostlong)
		extrn __imp_htonl:dword	; DATA XREF: htonlr
; int __stdcall	ioctlsocket(SOCKET s, __int32 cmd, u_long *argp)
		extrn __imp_ioctlsocket:dword ;	DATA XREF: ioctlsocketr
; int __stdcall	setsockopt(SOCKET s, int level,	int optname, const char	*optval, int optlen)
		extrn __imp_setsockopt:dword ; DATA XREF: setsockoptr
; void __stdcall GetAcceptExSockaddrs(PVOID lpOutputBuffer, DWORD dwReceiveDataLength, DWORD dwLocalAddressLength, DWORD dwRemoteAddressLength,	struct sockaddr	**LocalSockaddr, LPINT LocalSockaddrLength, struct sockaddr **RemoteSockaddr, LPINT RemoteSockaddrLength)
		extrn __imp_GetAcceptExSockaddrs:dword ; DATA XREF: GetAcceptExSockaddrsr
; BOOL __stdcall AcceptEx(SOCKET sListenSocket,	SOCKET sAcceptSocket, PVOID lpOutputBuffer, DWORD dwReceiveDataLength, DWORD dwLocalAddressLength, DWORD dwRemoteAddressLength,	LPDWORD	lpdwBytesReceived, LPOVERLAPPED	lpOverlapped)
		extrn __imp_AcceptEx:dword ; DATA XREF:	AcceptExr
; BOOL __stdcall TransmitFile(SOCKET hSocket, HANDLE hFile, DWORD nNumberOfBytesToWrite, DWORD nNumberOfBytesPerSend, LPOVERLAPPED lpOverlapped, LPTRANSMIT_FILE_BUFFERS lpTransmitBuffers, DWORD dwReserved)
		extrn __imp_TransmitFile:dword ; DATA XREF: TransmitFiler
; int __stdcall	shutdown(SOCKET	s, int how)
		extrn __imp_shutdown:dword ; DATA XREF:	shutdownr
; int __stdcall	getpeername(SOCKET s, struct sockaddr *name, int *namelen)
		extrn __imp_getpeername:dword ;	DATA XREF: getpeernamer
; int __stdcall	__WSAFDIsSet(SOCKET fd,	fd_set *)
		extrn __imp___WSAFDIsSet:dword ; DATA XREF: __WSAFDIsSetr
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn __imp_recv:dword	; DATA XREF: recvr
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn __imp_send:dword	; DATA XREF: sendr
; int __stdcall	sendto(SOCKET s, const char *buf, int len, int flags, const struct sockaddr *to, int tolen)
		extrn __imp_sendto:dword ; DATA	XREF: sendtor
; int __stdcall	recvfrom(SOCKET	s, char	*buf, int len, int flags, struct sockaddr *from, int *fromlen)
		extrn __imp_recvfrom:dword ; DATA XREF:	recvfromr
; int __stdcall	select(int nfds, fd_set	*readfds, fd_set *writefds, fd_set *exceptfds, const struct timeval *timeout)
		extrn __imp_select:dword ; DATA	XREF: selectr
; void __stdcall WSASetLastError(int iError)
		extrn __imp_WSASetLastError:dword ; DATA XREF: WSASetLastErrorr
; int __stdcall	WSACleanup()
		extrn __imp_WSACleanup:dword ; DATA XREF: WSACleanupr
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn __imp_WSAStartup:dword ; DATA XREF: WSAStartupr
; int __stdcall	WSAGetLastError()
		extrn __imp_WSAGetLastError:dword ; DATA XREF: WSAGetLastErrorr
; int __stdcall	closesocket(SOCKET s)
		extrn __imp_closesocket:dword ;	DATA XREF: closesocketr

;
; Imports from msvcrt.dll
;
; void *__cdecl	memmove(void *Dst, const void *Src, size_t Size)
		extrn memmove:dword	; CODE XREF: sub_10015080+ECp
					; sub_10015260+BEp
					; DATA XREF: ...
; int __cdecl isalpha(int C)
		extrn isalpha:dword	; CODE XREF: PR_ParseTimeStringToExplodedTime+CDCp
					; DATA XREF: PR_ParseTimeStringToExplodedTime+CDCr
; time_t __cdecl static	mktime(struct tm *Tm)
		extrn mktime:dword	; CODE XREF: PR_ParseTimeStringToExplodedTime+EFEp
					; DATA XREF: PR_ParseTimeStringToExplodedTime+EFEr
; size_t __cdecl strftime(char *Buf, size_t SizeInBytes, const char *Format, const struct tm *Tm)
		extrn strftime:dword	; CODE XREF: PR_FormatTime+7Dp
					; DATA XREF: PR_FormatTime+7Dr
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; CODE XREF: sub_10012000+24p
					; PR_LocalTimeParameters+3Cp
					; DATA XREF: ...
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn strncmp:dword	; CODE XREF: PR_GetInheritedFD+4Cp
					; PR_CreateProcess_0+10Bp
					; DATA XREF: ...
; char *__cdecl	strerror(int)
		extrn strerror:dword	; CODE XREF: PR_ErrorToString+31p
					; DATA XREF: PR_ErrorToString+31r
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn realloc:dword	; DATA XREF: PR_Reallocr
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn calloc:dword	; DATA XREF: PR_Callocr
; void *__cdecl	malloc(size_t Size)
		extrn malloc:dword	; CODE XREF: sub_10009860+70p
					; sub_10009B60+4Cp ...
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn strrchr:dword	; CODE XREF: sub_10008190+15p
					; sub_10008190+35p
					; DATA XREF: ...
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn strstr:dword	; CODE XREF: PR_GetLibraryName+Bp
					; DATA XREF: PR_GetLibraryName+Br
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; CODE	XREF: PR_GetLibraryPath+33p
					; sub_1000CDA0+2Bp
					; DATA XREF: ...
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn strchr:dword	; CODE XREF: sub_10006E30+265p
					; PR_SetEnv+16p ...
; int __cdecl isdigit(int C)
		extrn isdigit:dword	; CODE XREF: sub_10006BC0+89p
					; sub_10006BC0+E6p ...
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn strtoul:dword	; CODE XREF: sub_100068A0+1DFp
					; DATA XREF: sub_100068A0+1DFr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn strtol:dword	; CODE XREF: sub_100068A0+25Ep
					; DATA XREF: sub_100068A0+25Er
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: sub_10006710+41p
					; sub_10006710+56p ...
; int __cdecl tolower(int C)
		extrn tolower:dword	; CODE XREF: sub_10006710+DDp
					; sub_10006710+12Cp
					; DATA XREF: ...
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn memchr:dword	; CODE XREF: sub_10006710+ECp
					; sub_10006710+13Bp ...
; int snprintf(char *Dest, size_t Count, const char *Format, ...)
		extrn _snprintf:dword	; CODE XREF: sub_10005750+6Dp
					; DATA XREF: sub_10005750+6Dr
; void __cdecl abort()
		extrn abort:dword	; DATA XREF: PR_Abort+Dr PR_Assert+4Fr
; void __cdecl free(void *Memory)
		extrn free:dword	; CODE XREF: sub_100047A0+6Bp
					; sub_10007FB0+22p ...
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn strpbrk:dword	; CODE XREF: sub_1001C350+75p
					; DATA XREF: sub_1001C350+75r
; int __cdecl fflush(FILE *File)
		extrn fflush:dword	; CODE XREF: PR_LogFlush+E5p
					; PR_LogPrint+205p ...
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn fopen:dword	; CODE XREF: PR_SetLogFile+53p
					; DATA XREF: PR_SetLogFile+53r
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn setvbuf:dword	; CODE XREF: PR_SetLogFile+6Bp
					; DATA XREF: PR_SetLogFile+6Br
; int __cdecl fclose(FILE *File)
		extrn fclose:dword	; CODE XREF: PR_SetLogFile+97p
					; sub_100047A0+32p
					; DATA XREF: ...
; int sscanf(const char	*Src, const char *Format, ...)
		extrn sscanf:dword	; CODE XREF: sub_100043C0+8Bp
					; sub_100043C0+E8p ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void __cdecl __noreturn exit(int Code)
		extrn exit:dword	; CODE XREF: PR_CancelWaitFileDesc+E5p
					; PR_CancelWaitGroup+219p
					; DATA XREF: ...
; FILE iob[]
		extrn _iob:dword	; DATA XREF: .text:1000190Cr
					; PR_CancelWaitFileDesc+CAr ...
; int fprintf(FILE *File, const	char *Format, ...)
		extrn fprintf:dword	; CODE XREF: .text:1000191Cp
					; PR_CancelWaitFileDesc+DAp ...
; int __cdecl atoi(const char *Str)
		extrn atoi:dword	; CODE XREF: sub_100012C0+38p
					; sub_100012C0+4Dp ...
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: PR_ErrorInstallTable+11p
					; PR_Stat_0+140p ...
; int __cdecl stricmp(const char *Str1,	const char *Str2)
		extrn _stricmp:dword	; CODE XREF: sub_100043C0+A9p
					; sub_100043C0+C2p ...
; void __cdecl qsort(void *Base, size_t	NumOfElements, size_t SizeOfElements, int (__cdecl *PtFuncCompare)(const void *, const void *))
		extrn qsort:dword	; CODE XREF: PR_CreateProcess_0+162p
					; DATA XREF: PR_CreateProcess_0+162r
; unsigned __int8 *__cdecl mbsinc(const	unsigned __int8	*)
		extrn _mbsinc:dword	; CODE XREF: sub_10021240+23p
					; DATA XREF: sub_10021240+23r
; int __cdecl stat(const char *, struct	stat *)
		extrn _stat:dword	; CODE XREF: PR_Stat_0+1Bp
					; PR_Stat_0+12Ep
					; DATA XREF: ...
; unsigned __int8 *__cdecl mbsdec(const	unsigned __int8	*, const unsigned __int8 *)
		extrn _mbsdec:dword	; CODE XREF: sub_100217C0+1Ap
					; DATA XREF: sub_100217C0+1Ar
; int __cdecl access(const char	*, int)
		extrn _access:dword	; CODE XREF: sub_10021B40+26p
					; sub_10021B40+3Ap ...
		extrn _endthreadex:dword ; CODE	XREF: sub_100245B0+2p
					; DATA XREF: sub_100245B0+2r
; void __cdecl __noreturn exit(int Code)
		extrn _exit:dword	; CODE XREF: PR_ProcessExit_0+5p
					; DATA XREF: PR_ProcessExit_0+5r
		extrn _beginthreadex:dword ; CODE XREF:	sub_10024A40+2Bp
					; DATA XREF: sub_10024A40+2Br
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; CODE XREF: PR_GetRandomNoise_0+C2p
					; DATA XREF: PR_GetRandomNoise_0+C2r
		extrn __imp__XcptFilter:dword ;	DATA XREF: _XcptFilterr
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn fwrite:dword	; CODE XREF: PR_LogFlush+D8p
					; PR_LogPrint+1FCp ...
; char *__cdecl	strdup(const char *Src)
		extrn _strdup:dword	; CODE XREF: PR_NewLogModule+26p
					; sub_10007F20+32p ...
; int __cdecl strcmpi(const char *Str1,	const char *Str2)
		extrn _strcmpi:dword	; CODE XREF: sub_10008190+45p
					; DATA XREF: sub_10008190+29r
; int __cdecl _putenv(const char *EnvString)
		extrn __imp__putenv:dword ; DATA XREF: _putenvr


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 1002833Ch
dword_1002833C	dd 0			; DATA XREF: sub_10026DD1+B9o
dword_10028340	dd 0			; DATA XREF: sub_10026DD1+B4o
dword_10028344	dd 0			; DATA XREF: sub_10026DD1+96o
		dd offset sub_10026DAF
off_1002834C	dd offset sub_10027492	; DATA XREF: .data:100306B4o
dword_10028350	dd 2 dup(0)		; DATA XREF: sub_10026DD1:loc_10026E62o
TlsCallbacks	dd 0			; DATA XREF: .rdata:TlsCallbacks_ptro
dword_1002835C	dd 2 dup(0)		; DATA XREF: .data:10030038o
aLicenseInforma	db 'License information: http://www.mozilla.org/MPL/',0
					; DATA XREF: .data:10030034o
		align 4
aCopyrightC1998	db 'Copyright (c) 1998 Netscape Communications Corporation. All Right'
					; DATA XREF: .data:10030030o
		db 's Reserved',0
aNA		db 'N/A',0              ; DATA XREF: .data:1003002Co
aPortableRuntim	db 'Portable runtime',0 ; DATA XREF: .data:10030028o
		align 4
aLibnspr4_dll_0	db 'libnspr4.dll',0     ; DATA XREF: .data:10030024o
		align 4
a20140927210133	db '2014-09-27 21:01:33',0 ; DATA XREF: .data:10030010o
aFd		db 'FD',0               ; DATA XREF: sub_100012C0+97o
		align 4
; char aNspr_fd_cach_0[]
aNspr_fd_cach_0	db 'NSPR_FD_CACHE_SIZE_HIGH',0 ; DATA XREF: sub_100012C0+Do
; char aNspr_fd_cache_[]
aNspr_fd_cache_	db 'NSPR_FD_CACHE_SIZE_LOW',0 ; DATA XREF: sub_100012C0+3o
		align 4
dword_10028454	dd 3Bh			; DATA XREF: sub_10001780:loc_10001791r
dword_10028458	dd 0B3h			; DATA XREF: sub_10001780+25r
		dd 209h, 38Bh, 593h, 0A97h, 0F4Dh, 139Dh, 201Bh, 2D1Dh
		dd 49DFh, 6857h, 83D5h,	0AEE3h
; char Format[]
Format		db 'closesocket failed: %d',0Ah,0 ; DATA XREF: .text:10001916o
					; PR_CancelWaitFileDesc+D4o ...
aIpv6_to_ipv4La	db 'Ipv6_to_Ipv4 layer',0 ; DATA XREF: .text:10003711o
		align 4
; char aN[]
aN		db ' , %n',0            ; DATA XREF: sub_100043C0+E2o
					; sub_10004F10+18Ao
		align 10h
; char Str2[]
Str2		db 'all',0              ; DATA XREF: sub_100043C0+A3o
					; sub_10004F10+138o
		align 8
; char a63Abcdefghijkl[]
a63Abcdefghijkl	db '%63[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz012345678'
					; DATA XREF: sub_100043C0+75o
					; sub_10004F10+85o
		db '9_-]%n:%d%n',0
		align 4
; char aNspr_log_modul[]
aNspr_log_modul	db 'NSPR_LOG_MODULES',0 ; DATA XREF: sub_100043C0+13o
					; sub_10004F10+14o
		align 4
aW		db 'w',0                ; DATA XREF: PR_SetLogFile+4Co
		align 10h
; char Mode[]
Mode		db 'a',0                ; DATA XREF: PR_SetLogFile+45o
		align 4
aWindebug	db 'WinDebug',0         ; DATA XREF: PR_SetLogFile+5o
		align 10h
aLdP		db '%ld[%p]: ',0        ; DATA XREF: PR_LogPrint+A9o
		align 4
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d.%06d UTC - ',0
					; DATA XREF: PR_LogPrint+73o
		align 4
aAborting	db 'Aborting',0         ; DATA XREF: PR_Aborto
		align 4
; char aAssertionFailu[]
aAssertionFailu	db 'Assertion failure: %s, at %s:%d',0Ah,0 ; DATA XREF: PR_Assert+12o
					; PR_Assert+27o
		align 4
aUnableToCreate	db 'Unable to create nspr log file ',27h,'%s',27h,0Ah,0
					; DATA XREF: sub_10004F10+1E9o
		align 10h
; char aNspr_log_file[]
aNspr_log_file	db 'NSPR_LOG_FILE',0    ; DATA XREF: sub_10004F10+1C1o
		align 10h
; char aAppend[]
aAppend		db 'append',0           ; DATA XREF: sub_10004F10+117o
		align 4
; char aTimestamp[]
aTimestamp	db 'timestamp',0        ; DATA XREF: sub_10004F10+FCo
		align 4
; char aBufsize[]
aBufsize	db 'bufsize',0          ; DATA XREF: sub_10004F10+D1o
; char aSync[]
aSync		db 'sync',0             ; DATA XREF: sub_10004F10+B5o
a8		db '8',0                ; DATA XREF: PR_SetPollableEvent+Bo
		align 4
aNsprPollableEv	db 'NSPR pollable events',0 ; DATA XREF: .text:loc_10005230o
		align 4
a0123456789ab_2	db '0123456789ABCDEF',0 ; DATA XREF: .data:off_1003028Co
		align 10h
a0123456789ab_1	db '0123456789abcdef',0 ; DATA XREF: .data:off_10030288o
					; .data:off_100302E0o
		align 4
a0		db '0',0                ; DATA XREF: sub_10005450+D4o
					; sub_10005450+F4o ...
		align 4
word_10028648	dw 20h			; DATA XREF: sub_10005450+98o
					; sub_10005450+127o ...
		align 4
aNull		db '(null)',0           ; DATA XREF: sub_10005820+15o
		align 4
dword_10028654	dd 0			; DATA XREF: sub_10005C10+62Co
asc_10028658	db '%',0                ; DATA XREF: sub_10005C10+5F2o
		align 4
		dd 10h
a0123456789ab_0	db '0123456789abcdef',0 ; DATA XREF: sub_10006710+E7o
					; sub_10006710:loc_10006810o ...
		align 4
a0123456789abcd	db '0123456789abcdefABCDEF',0 ; DATA XREF: sub_100068A0+15Do
		align 4
aExpandedMonito	db 'expanded monitor cache to %d (buckets %d)',0
					; DATA XREF: sub_10007470+194o
		align 4
aUnableToGrowMo	db 'unable to grow monitor cache hash buckets',0
					; DATA XREF: sub_10007470+E8o
		align 4
aErrorD		db 'error %d',0         ; DATA XREF: sub_10007EC0+13o
					; sub_10008220+F4o ...
		align 10h
aLoadedLibrar_1	db 'Loaded library %s (init)',0 ; DATA XREF: sub_10007F20+70o
		align 4
; char aExecutable[]
aExecutable	db 'Executable',0       ; DATA XREF: sub_10007F20+2Bo
		align 4
aLinkerLock	db 'linker-lock',0      ; DATA XREF: sub_10007F20+9o
a_Lib		db '.;\lib',0           ; DATA XREF: PR_GetLibraryPath+40o
		align 4
; char VarName[]
VarName		db 'LD_LIBRARY_PATH',0  ; DATA XREF: PR_GetLibraryPath+2Eo
aS		db '%s',0               ; DATA XREF: PR_GetLibraryName:loc_1000816Ao
		align 10h
aSS_0		db '%s\%s',0            ; DATA XREF: PR_GetLibraryName+4Bo
		align 4
aSS		db '%s%s',0             ; DATA XREF: PR_GetLibraryName:loc_10008146o
		align 10h
aSSS		db '%s\%s%s',0          ; DATA XREF: PR_GetLibraryName+27o
; char SubStr[]
SubStr		db '.dll',0             ; DATA XREF: PR_GetLibraryName+5o
					; PR_GetLibraryName+1Co
		align 10h
aSIncrDFindLib	db '%s incr => %d (find lib)',0 ; DATA XREF: sub_10008190+72o
		align 4
aLoadedLibrar_0	db 'Loaded library %s (load lib)',0 ; DATA XREF: sub_10008220+22Co
		align 4
aUnloadedLibrar	db 'Unloaded library %s',0 ; DATA XREF: PR_UnloadLibrary+F1o
aSDecrD		db '%s decr => %d',0    ; DATA XREF: PR_UnloadLibrary+72o
		align 10h
aSIncrDForS	db '%s incr => %d (for %s)',0 ; DATA XREF: PR_FindSymbolAndLibrary+137o
		align 4
aLoadedLibraryS	db 'Loaded library %s (static lib)',0 ; DATA XREF: PR_LoadStaticLibrary+A8o
		align 4
dbl_100287F8	dq 0.5			; DATA XREF: sub_10008C60+51r
					; sub_10008CE0+132r ...
dbl_10028800	dq 4.294967296e9	; DATA XREF: sub_10008C60+10r
					; sub_10008C60+20r ...
aPr_counterInit	db 'PR_Counter: Initialization complete',0 ; DATA XREF: PR_CreateCounter+40o
; char aCounters[]
aCounters	db 'counters',0         ; DATA XREF: PR_CreateCounter+17o
		align 4
aPr_counterCrea	db 'PR_Counter: Create: QName: %s %p, RName: %s %p',0Ah
					; DATA XREF: PR_CreateCounter+17Bo
		db 9,0
		align 4
aPr_counterDe_1	db 'PR_Counter: Deleting unused QName: %s, %p',0
					; DATA XREF: PR_DestroyCounter+8Eo
		align 4
aPr_counterDe_0	db 'PR_Counter: Deleting RName: %s, %p',0 ; DATA XREF: PR_DestroyCounter+48o
		align 4
aPr_counterDele	db 'PR_Counter: Deleting: QName: %s, RName: %s',0
					; DATA XREF: PR_DestroyCounter+1Co
		align 4
aPr_counterGetc	db 'PR_Counter: GetConterNameFromHandle: QNp: %p, RNp: %p,',0Ah
					; DATA XREF: PR_GetCounterNameFromHandle+36o
					; PR_GetCounterHandleFromName+CDo
		db 9,'QName: %s, RName: %s, Desc: %s',0
		align 10h
aPr_counterIncr	db 'PR_Counter: Increment: %p, %ld',0 ; DATA XREF: PR_IncrementCounter+2Eo
		align 10h
aPr_counterDecr	db 'PR_Counter: Decrement: %p, %ld',0 ; DATA XREF: PR_DecrementCounter+2Eo
		align 10h
aPr_counterAddt	db 'PR_Counter: AddToCounter: %p, %ld',0 ; DATA XREF: PR_AddToCounter+31o
		align 4
aPr_counterSubt	db 'PR_Counter: SubtractFromCounter: %p, %ld',0
					; DATA XREF: PR_SubtractFromCounter+31o
		align 10h
aPr_counterGe_0	db 'PR_Counter: GetCounter: %p, %ld',0 ; DATA XREF: PR_GetCounter+15o
aPr_counterSetc	db 'PR_Counter: SetCounter: %p, %ld',0 ; DATA XREF: PR_SetCounter+1Co
aPr_counterFind	db 'PR_Counter: FindNextQname: Handle: %p, Returns: %p',0
					; DATA XREF: PR_FindNextCounterQname+38o
					; PR_GetCounterHandleFromName+51o ...
		align 8
aPr_counterFi_0	db 'PR_Counter: FindNextRname: Rhandle: %p, QHandle: %p, Returns: %p',0
					; DATA XREF: PR_FindNextCounterRname+36o
					; PR_GetCounterHandleFromName+91o ...
		align 4
aPr_counterGe_2	db 'PR_Counter: GetConterHandleFromName: %p',0
					; DATA XREF: PR_GetCounterHandleFromName+1D0o
					; PR_GetTraceHandleFromName+1D0o
aPr_counterGe_1	db 'PR_Counter: GetCounterHandleFromName:',0Ah
					; DATA XREF: PR_GetCounterHandleFromName+24o
		db 9,'QName: %s, RName: %s',0
dbl_10028AF0	dq 1.0			; DATA XREF: PR_strtod+34Br
					; PR_strtod+36Dr ...
		dd 0
		dd 40240000h, 0
		dd 40590000h, 0
		dd 408F4000h, 0
		dd 40C38800h, 0
		dd 40F86A00h, 0
aAd_a		db '.A',0
		align 4
		dd 416312D0h, 0
aDCa		db 'A',0
		align 4
aEA		db 'eA',0
		db 2 dup(0), 20h
		dd 4202A05Fh, 0E8000000h, 42374876h, 0A2000000h, 426D1A94h
		dd 0E5400000h, 42A2309Ch, 1E900000h, 42D6BCC4h,	26340000h
		dd 430C6BF5h, 37E08000h, 4341C379h, 85D8A000h, 43763457h
		dd 674EC800h, 43ABC16Dh, 60913D00h, 43E158E4h, 78B58C40h
		dd 4415AF1Dh, 0D6E2EF50h, 444B1AE4h, 64DD592h, 4480F0CFh
dbl_10028BA8	dq 1.0e16		; DATA XREF: PR_strtod+3EEr
					; PR_strtod:loc_1000A8C5r ...
		dd 0B5056E17h, 4693B8B5h, 0E93FF9F5h, 4D384F03h, 0F9301D32h
		dd 5A827748h
dbl_10028BC8	dq 1.0e256		; DATA XREF: sub_1000B720+396r
dword_10028BD0	dd 97D889BCh, 3C9CD2B2h, 0D5A8A733h, 3949F623h,	44F4A73Dh
					; DATA XREF: PR_strtod+494o
		dd 32A50FFDh, 0CF8C979Dh, 255BBA08h, 64AC6F43h,	11680628h
dbl_10028BF8	dq 0.5000000999999999	; DATA XREF: PR_strtod+A3Fr
dbl_10028C00	dq 0.4999999		; DATA XREF: PR_strtod:loc_1000AEECr
dbl_10028C08	dq 0.24999995		; DATA XREF: PR_strtod+A19r
dbl_10028C10	dq 2.147483647e9	; DATA XREF: PR_strtod+93Br
dbl_10028C18	dq -1.0			; DATA XREF: PR_strtod+8FDr
dbl_10028C20	dq 2.0			; DATA XREF: PR_strtod+7BFr
dbl_10028C28	dq 7.0			; DATA XREF: sub_1000B720+42Er
dbl_10028C30	dq 5.0			; DATA XREF: sub_1000B720+33Fr
dbl_10028C38	dq 10.0			; DATA XREF: sub_1000B720+339r
dbl_10028C40	dq 0.301029995663981	; DATA XREF: sub_1000B720+1F3r
dbl_10028C48	dq 0.1760912590558	; DATA XREF: sub_1000B720+1E9r
dbl_10028C50	dq 0.289529654602168	; DATA XREF: sub_1000B720+1E3r
dbl_10028C58	dq 1.5			; DATA XREF: sub_1000B720+1DCr
dword_10028C60	dd 4E614Eh		; DATA XREF: sub_1000B720+A6o
aInfinity	db 'Infinity',0         ; DATA XREF: sub_1000B720+6Fo
		align 10h
aD		db '%+d',0              ; DATA XREF: PR_cnvtf+1D7o
aPrerr		db 'prerr',0            ; DATA XREF: .rdata:1002A1C4o
		align 4
aPlaceholderFor	db 'Placeholder for the end of the list',0 ; DATA XREF: .rdata:1002A1B4o
aPr_max_error	db 'PR_MAX_ERROR',0     ; DATA XREF: .rdata:1002A1B0o
		align 10h
aTheOneTimeFunc	db 'The one-time function was previously called and failed. Its error'
					; DATA XREF: .rdata:1002A1ACo
		db ' code is no longer available',0
		align 10h
aPr_call_once_e	db 'PR_CALL_ONCE_ERROR',0 ; DATA XREF: .rdata:1002A1A8o
		align 4
aTheLibraryIsNo	db 'The library is not loaded',0 ; DATA XREF: .rdata:1002A1A4o
		align 10h
aPr_library_not	db 'PR_LIBRARY_NOT_LOADED_ERROR',0 ; DATA XREF: .rdata:1002A1A0o
aHostIsUnreacha	db 'Host is unreachable',0 ; DATA XREF: .rdata:1002A19Co
aPr_host_unreac	db 'PR_HOST_UNREACHABLE_ERROR',0 ; DATA XREF: .rdata:1002A198o
		align 4
aConnectionAbor	db 'Connection aborted',0 ; DATA XREF: .rdata:1002A194o
		align 10h
aPr_connect_abo	db 'PR_CONNECT_ABORTED_ERROR',0 ; DATA XREF: .rdata:1002A190o
		align 4
aSocketShutdown	db 'Socket shutdown',0  ; DATA XREF: .rdata:1002A18Co
aPr_socket_shut	db 'PR_SOCKET_SHUTDOWN_ERROR',0 ; DATA XREF: .rdata:1002A188o
		align 4
aNetworkIsDown	db 'Network is down',0  ; DATA XREF: .rdata:1002A184o
aPr_network_dow	db 'PR_NETWORK_DOWN_ERROR',0 ; DATA XREF: .rdata:1002A180o
		align 10h
aObjectStateImp	db 'Object state improper for request',0 ; DATA XREF: .rdata:1002A17Co
		align 4
aPr_invalid_sta	db 'PR_INVALID_STATE_ERROR',0 ; DATA XREF: .rdata:1002A178o
		align 4
aTheWaitGroupIs	db 'The wait group is empty',0 ; DATA XREF: .rdata:1002A174o
aPr_group_empty	db 'PR_GROUP_EMPTY_ERROR',0 ; DATA XREF: .rdata:1002A170o
		align 10h
aOperationHasAl	db 'Operation has already been initiated (probably a non-blocking con'
					; DATA XREF: .rdata:1002A16Co
		db 'nect)',0
		align 4
aPr_already_ini	db 'PR_ALREADY_INITIATED_ERROR',0 ; DATA XREF: .rdata:1002A168o
		align 8
aOperationIsSti	db 'Operation is still in progress (probably a non-blocking connect)',0
					; DATA XREF: .rdata:1002A164o
		align 4
aPr_in_progress	db 'PR_IN_PROGRESS_ERROR',0 ; DATA XREF: .rdata:1002A160o
		align 4
aTheIOOperation	db 'The I/O operation was aborted',0 ; DATA XREF: .rdata:1002A15Co
		align 4
aPr_operation_a	db 'PR_OPERATION_ABORTED_ERROR',0 ; DATA XREF: .rdata:1002A158o
		align 10h
aTheFileIsBusy	db 'The file is busy',0 ; DATA XREF: .rdata:1002A154o
		align 4
aPr_file_is_bus	db 'PR_FILE_IS_BUSY_ERROR',0 ; DATA XREF: .rdata:1002A150o
		align 4
aSeekError	db 'Seek error',0       ; DATA XREF: .rdata:1002A14Co
		align 4
aPr_file_seek_e	db 'PR_FILE_SEEK_ERROR',0 ; DATA XREF: .rdata:1002A148o
		align 4
aEncounteredEnd	db 'Encountered end of file',0 ; DATA XREF: .rdata:1002A144o
aPr_end_of_file	db 'PR_END_OF_FILE_ERROR',0 ; DATA XREF: .rdata:1002A140o
		align 4
aNoMoreEntriesI	db 'No more entries in the directory',0 ; DATA XREF: .rdata:1002A13Co
		align 10h
aPr_no_more_fil	db 'PR_NO_MORE_FILES_ERROR',0 ; DATA XREF: .rdata:1002A138o
		align 4
aTheDeviceIsLoc	db 'The device is locked',0 ; DATA XREF: .rdata:1002A134o
		align 10h
aPr_device_is_l	db 'PR_DEVICE_IS_LOCKED_ERROR',0 ; DATA XREF: .rdata:1002A130o
		align 4
aTheRequiredDev	db 'The required device was in an invalid state',0
					; DATA XREF: .rdata:1002A12Co
aPr_invalid_dev	db 'PR_INVALID_DEVICE_STATE_ERROR',0 ; DATA XREF: .rdata:1002A128o
		align 4
aDirectoryIsFul	db 'Directory is full.  No additional filenames may be added',0
					; DATA XREF: .rdata:1002A124o
		align 4
aPr_max_directo	db 'PR_MAX_DIRECTORY_ENTRIES_ERROR',0 ; DATA XREF: .rdata:1002A120o
		align 4
aCannotCreateOr	db 'Cannot create or rename a filename that already exists',0
					; DATA XREF: .rdata:1002A11Co
		align 4
aPr_file_exists	db 'PR_FILE_EXISTS_ERROR',0 ; DATA XREF: .rdata:1002A118o
		align 4
aTheDirectoryOb	db 'The directory object in the file system is corrupted',0
					; DATA XREF: .rdata:1002A114o
		align 4
aPr_directory_c	db 'PR_DIRECTORY_CORRUPTED_ERROR',0 ; DATA XREF: .rdata:1002A110o
		align 4
aCannotRenameAF	db 'Cannot rename a file to a file system on another device',0
					; DATA XREF: .rdata:1002A10Co
aPr_not_same_de	db 'PR_NOT_SAME_DEVICE_ERROR',0 ; DATA XREF: .rdata:1002A108o
		align 10h
aCannotDeleteOr	db 'Cannot delete or rename a file object while the file system is bu'
					; DATA XREF: .rdata:1002A104o
		db 'sy',0
aPr_filesystem_	db 'PR_FILESYSTEM_MOUNTED_ERROR',0 ; DATA XREF: .rdata:1002A100o
aCannotDeleteAD	db 'Cannot delete a directory that is not empty',0
					; DATA XREF: .rdata:1002A0FCo
aPr_directory_n	db 'PR_DIRECTORY_NOT_EMPTY_ERROR',0 ; DATA XREF: .rdata:1002A0F8o
		align 4
aCannotWriteToA	db 'Cannot write to a read-only file system',0 ; DATA XREF: .rdata:1002A0F4o
aPr_read_only_f	db 'PR_READ_ONLY_FILESYSTEM_ERROR',0 ; DATA XREF: .rdata:1002A0F0o
		align 4
aCannotPerformD	db 'Cannot perform directory operation on a normal file',0
					; DATA XREF: .rdata:1002A0ECo
aPr_not_directo	db 'PR_NOT_DIRECTORY_ERROR',0 ; DATA XREF: .rdata:1002A0E8o
		align 10h
aFileNotFound	db 'File not found',0   ; DATA XREF: .rdata:1002A0E4o
		align 10h
aPr_file_not_fo	db 'PR_FILE_NOT_FOUND_ERROR',0 ; DATA XREF: .rdata:1002A0E0o
aFileNameIsTooL	db 'File name is too long',0 ; DATA XREF: .rdata:1002A0DCo
		align 10h
aPr_name_too_lo	db 'PR_NAME_TOO_LONG_ERROR',0 ; DATA XREF: .rdata:1002A0D8o
		align 4
aSymbolicLinkLo	db 'Symbolic link loop',0 ; DATA XREF: .rdata:1002A0D4o
		align 4
aPr_loop_error	db 'PR_LOOP_ERROR',0    ; DATA XREF: .rdata:1002A0D0o
		align 4
aCannotPerformA	db 'Cannot perform a normal file operation on a directory',0
					; DATA XREF: .rdata:1002A0CCo
		align 4
aPr_is_director	db 'PR_IS_DIRECTORY_ERROR',0 ; DATA XREF: .rdata:1002A0C8o
		align 4
aPr_no_seek_dev	db 'PR_NO_SEEK_DEVICE_ERROR',0 ; DATA XREF: .rdata:1002A0C0o
aPr_pipe_error	db 'PR_PIPE_ERROR',0    ; DATA XREF: .rdata:1002A0B8o
		align 4
aTheDeviceForSt	db 'The device for storing the file is full',0 ; DATA XREF: .rdata:1002A0B4o
aPr_no_device_s	db 'PR_NO_DEVICE_SPACE_ERROR',0 ; DATA XREF: .rdata:1002A0B0o
		align 4
aWriteWouldResu	db 'Write would result in file larger than the system allows',0
					; DATA XREF: .rdata:1002A0ACo
		align 4
aPr_file_too_bi	db 'PR_FILE_TOO_BIG_ERROR',0 ; DATA XREF: .rdata:1002A0A8o
		align 4
aTheFileIsAlrea	db 'The file is already locked',0 ; DATA XREF: .rdata:1002A0A4o
		align 4
aPr_file_is_loc	db 'PR_FILE_IS_LOCKED_ERROR',0 ; DATA XREF: .rdata:1002A0A0o
aTheOperationWo	db 'The operation would have deadlocked',0 ; DATA XREF: .rdata:1002A09Co
aPr_deadlock_er	db 'PR_DEADLOCK_ERROR',0 ; DATA XREF: .rdata:1002A098o
		align 4
aUnused		db 'Unused',0           ; DATA XREF: .rdata:1002A094o
					; .rdata:1002A0BCo ...
		align 10h
aPr_range_error	db 'PR_RANGE_ERROR',0   ; DATA XREF: .rdata:1002A090o
		align 10h
aTcpConnectionR	db 'TCP connection reset by peer',0 ; DATA XREF: .rdata:1002A08Co
		align 10h
aPr_connect_res	db 'PR_CONNECT_RESET_ERROR',0 ; DATA XREF: .rdata:1002A088o
		align 4
aTheValueReques	db 'The value requested is too large to be stored in the data buffer '
					; DATA XREF: .rdata:1002A084o
		db 'provided',0
		align 4
aPr_buffer_over	db 'PR_BUFFER_OVERFLOW_ERROR',0 ; DATA XREF: .rdata:1002A080o
		align 10h
aAccessToTheRem	db 'Access to the remote file has been severed',0
					; DATA XREF: .rdata:1002A07Co
		align 4
aPr_remote_file	db 'PR_REMOTE_FILE_ERROR',0 ; DATA XREF: .rdata:1002A078o
		align 8
aTheHostOperati	db 'The host operating system does not support the protocol requested'
					; DATA XREF: .rdata:1002A074o
		db 0
		align 4
aPr_protocol_no	db 'PR_PROTOCOL_NOT_SUPPORTED_ERROR',0 ; DATA XREF: .rdata:1002A070o
aTheRequestedOp	db 'The requested operation is not supported by the platform',0
					; DATA XREF: .rdata:1002A06Co
		align 4
aPr_operation_n	db 'PR_OPERATION_NOT_SUPPORTED_ERROR',0 ; DATA XREF: .rdata:1002A068o
		align 4
aAccessDenied	db 'Access Denied',0    ; DATA XREF: .rdata:1002A064o
		align 4
aPr_no_access_r	db 'PR_NO_ACCESS_RIGHTS_ERROR',0 ; DATA XREF: .rdata:1002A060o
		align 4
aTcpFileDescrip	db 'TCP file descriptor is already bound',0 ; DATA XREF: .rdata:1002A05Co
		align 10h
aPr_socket_addr	db 'PR_SOCKET_ADDRESS_IS_BOUND_ERROR',0 ; DATA XREF: .rdata:1002A058o
		align 4
aTcpSpecificFun	db 'TCP-specific function attempted on a non-TCP file descriptor',0
					; DATA XREF: .rdata:1002A054o
		align 4
aPr_not_tcp_soc	db 'PR_NOT_TCP_SOCKET_ERROR',0 ; DATA XREF: .rdata:1002A050o
aNetworkOperati	db 'Network operation attempted on non-network file descriptor',0
					; DATA XREF: .rdata:1002A04Co
		align 4
aPr_not_socket_	db 'PR_NOT_SOCKET_ERROR',0 ; DATA XREF: .rdata:1002A048o
aSystemOpenFdTa	db 'System open FD table is full',0 ; DATA XREF: .rdata:1002A044o
		align 4
aPr_sys_desc_ta	db 'PR_SYS_DESC_TABLE_FULL_ERROR',0 ; DATA XREF: .rdata:1002A040o
		align 4
aProcessOpenFdT	db 'Process open FD table is full',0 ; DATA XREF: .rdata:1002A03Co
		align 4
aPr_proc_desc_t	db 'PR_PROC_DESC_TABLE_FULL_ERROR',0 ; DATA XREF: .rdata:1002A038o
		align 4
aAttemptToAcces	db 'Attempt to access a TPD key that is out of range',0
					; DATA XREF: .rdata:1002A034o
		align 10h
aPr_tpd_range_e	db 'PR_TPD_RANGE_ERROR',0 ; DATA XREF: .rdata:1002A030o
		align 4
aADirectoryLook	db 'A directory lookup on a network address has failed',0
					; DATA XREF: .rdata:1002A02Co
		align 4
aPr_directory_l	db 'PR_DIRECTORY_LOOKUP_ERROR',0 ; DATA XREF: .rdata:1002A028o
		align 4
aInsufficientSy	db 'Insufficient system resources',0 ; DATA XREF: .rdata:1002A024o
		align 4
aPr_insufficien	db 'PR_INSUFFICIENT_RESOURCES_ERROR',0 ; DATA XREF: .rdata:1002A020o
aSymbolNotFound	db 'Symbol not found in any of the loaded dynamic libraries',0
					; DATA XREF: .rdata:1002A01Co
aPr_find_symbol	db 'PR_FIND_SYMBOL_ERROR',0 ; DATA XREF: .rdata:1002A018o
		align 4
aFailureToUnloa	db 'Failure to unload dynamic library',0 ; DATA XREF: .rdata:1002A014o
		align 4
aPr_unload_libr	db 'PR_UNLOAD_LIBRARY_ERROR',0 ; DATA XREF: .rdata:1002A010o
aFailureToLoadD	db 'Failure to load dynamic library',0 ; DATA XREF: .rdata:1002A00Co
aPr_load_librar	db 'PR_LOAD_LIBRARY_ERROR',0 ; DATA XREF: .rdata:1002A008o
		align 4
aNetworkFileDes	db 'Network file descriptor is not connected',0
					; DATA XREF: .rdata:1002A004o
		align 4
aPr_not_connect	db 'PR_NOT_CONNECTED_ERROR',0 ; DATA XREF: .rdata:1002A000o
		align 4
aConnectionAtte	db 'Connection attempt timed out',0 ; DATA XREF: .rdata:10029FFCo
		align 4
aPr_connect_tim	db 'PR_CONNECT_TIMEOUT_ERROR',0 ; DATA XREF: .rdata:10029FF8o
		align 4
aNetworkAddress	db 'Network address is presently unreachable',0
					; DATA XREF: .rdata:10029FF4o
		align 4
aPr_network_unr	db 'PR_NETWORK_UNREACHABLE_ERROR',0 ; DATA XREF: .rdata:10029FF0o
		align 4
aConnectionRefu	db 'Connection refused by peer',0 ; DATA XREF: .rdata:10029FECo
		align 10h
aPr_connect_ref	db 'PR_CONNECT_REFUSED_ERROR',0 ; DATA XREF: .rdata:10029FE8o
		align 4
aLocalNetworkAd	db 'Local Network address is in use',0 ; DATA XREF: .rdata:10029FE4o
aPr_address_in_	db 'PR_ADDRESS_IN_USE_ERROR',0 ; DATA XREF: .rdata:10029FE0o
aNetworkAddre_0	db 'Network address is invalid',0 ; DATA XREF: .rdata:10029FDCo
		align 10h
aPr_bad_address	db 'PR_BAD_ADDRESS_ERROR',0 ; DATA XREF: .rdata:10029FD8o
		align 4
aAlreadyConnect	db 'Already connected',0 ; DATA XREF: .rdata:10029FD4o
		align 4
aPr_is_connecte	db 'PR_IS_CONNECTED_ERROR',0 ; DATA XREF: .rdata:10029FD0o
		align 4
aNetworkAddre_1	db 'Network address type not supported',0 ; DATA XREF: .rdata:10029FCCo
		align 4
aPr_address_not	db 'PR_ADDRESS_NOT_SUPPORTED_ERROR',0 ; DATA XREF: .rdata:10029FC8o
		align 4
aNetworkAddre_2	db 'Network address not available (in use?)',0 ; DATA XREF: .rdata:10029FC4o
aPr_address_n_0	db 'PR_ADDRESS_NOT_AVAILABLE_ERROR',0 ; DATA XREF: .rdata:10029FC0o
		align 10h
aInvalidFunctio	db 'Invalid function argument',0 ; DATA XREF: .rdata:10029FBCo
		align 4
aPr_invalid_arg	db 'PR_INVALID_ARGUMENT_ERROR',0 ; DATA XREF: .rdata:10029FB8o
		align 4
aTheDirectoryCo	db 'The directory could not be opened',0 ; DATA XREF: .rdata:10029FB4o
		align 4
aPr_directory_o	db 'PR_DIRECTORY_OPEN_ERROR',0 ; DATA XREF: .rdata:10029FB0o
aIOOperationOnB	db 'I/O operation on busy file descriptor',0 ; DATA XREF: .rdata:10029FACo
		align 4
aPr_io_pending_	db 'PR_IO_PENDING_ERROR',0 ; DATA XREF: .rdata:10029FA8o
aIOOperationTim	db 'I/O operation timed out',0 ; DATA XREF: .rdata:10029FA4o
aPr_io_timeout_	db 'PR_IO_TIMEOUT_ERROR',0 ; DATA XREF: .rdata:10029FA0o
aIOFunctionErro	db 'I/O function error',0 ; DATA XREF: .rdata:10029F9Co
		align 10h
aPr_io_error	db 'PR_IO_ERROR',0      ; DATA XREF: .rdata:10029F98o
aFunctionNotImp	db 'function not implemented',0 ; DATA XREF: .rdata:10029F94o
		align 4
aPr_not_impleme	db 'PR_NOT_IMPLEMENTED_ERROR',0 ; DATA XREF: .rdata:10029F90o
		align 4
aOperationInter	db 'Operation interrupted by another thread',0 ; DATA XREF: .rdata:10029F8Co
aPr_pending_int	db 'PR_PENDING_INTERRUPT_ERROR',0 ; DATA XREF: .rdata:10029F88o
		align 4
aSomeUnknownErr	db 'Some unknown error has occurred',0 ; DATA XREF: .rdata:10029F84o
aPr_unknown_err	db 'PR_UNKNOWN_ERROR',0 ; DATA XREF: .rdata:10029F80o
		align 4
aPr_illegal_acc	db 'PR_ILLEGAL_ACCESS_ERROR',0 ; DATA XREF: .rdata:10029F78o
aInvalidFunct_0	db 'Invalid function for file type',0 ; DATA XREF: .rdata:10029F74o
		align 4
aPr_invalid_met	db 'PR_INVALID_METHOD_ERROR',0 ; DATA XREF: .rdata:10029F70o
aInvalidMemoryA	db 'Invalid memory address argument',0 ; DATA XREF: .rdata:10029F6Co
					; .rdata:10029F7Co
aPr_access_faul	db 'PR_ACCESS_FAULT_ERROR',0 ; DATA XREF: .rdata:10029F68o
		align 4
aTheOperation_0	db 'The operation would have blocked',0 ; DATA XREF: .rdata:10029F64o
		align 4
aPr_would_block	db 'PR_WOULD_BLOCK_ERROR',0 ; DATA XREF: .rdata:10029F60o
		align 10h
aInvalidFileDes	db 'Invalid file descriptor',0 ; DATA XREF: .rdata:10029F5Co
aPr_bad_descrip	db 'PR_BAD_DESCRIPTOR_ERROR',0 ; DATA XREF: .rdata:10029F58o
aMemoryAllocati	db 'Memory allocation attempt failed',0 ; DATA XREF: .rdata:10029F54o
		align 4
aPr_out_of_memo	db 'PR_OUT_OF_MEMORY_ERROR',0 ; DATA XREF: .rdata:off_10029F50o
		align 10h
off_10029F50	dd offset aPr_out_of_memo ; DATA XREF: .rdata:off_1002A1C0o
					; "PR_OUT_OF_MEMORY_ERROR"
		dd offset aMemoryAllocati ; "Memory allocation attempt failed"
		dd offset aPr_bad_descrip ; "PR_BAD_DESCRIPTOR_ERROR"
		dd offset aInvalidFileDes ; "Invalid file descriptor"
		dd offset aPr_would_block ; "PR_WOULD_BLOCK_ERROR"
		dd offset aTheOperation_0 ; "The operation would have blocked"
		dd offset aPr_access_faul ; "PR_ACCESS_FAULT_ERROR"
		dd offset aInvalidMemoryA ; "Invalid memory address argument"
		dd offset aPr_invalid_met ; "PR_INVALID_METHOD_ERROR"
		dd offset aInvalidFunct_0 ; "Invalid function for file type"
		dd offset aPr_illegal_acc ; "PR_ILLEGAL_ACCESS_ERROR"
		dd offset aInvalidMemoryA ; "Invalid memory address argument"
		dd offset aPr_unknown_err ; "PR_UNKNOWN_ERROR"
		dd offset aSomeUnknownErr ; "Some unknown error	has occurred"
		dd offset aPr_pending_int ; "PR_PENDING_INTERRUPT_ERROR"
		dd offset aOperationInter ; "Operation interrupted by another thread"
		dd offset aPr_not_impleme ; "PR_NOT_IMPLEMENTED_ERROR"
		dd offset aFunctionNotImp ; "function not implemented"
		dd offset aPr_io_error	; "PR_IO_ERROR"
		dd offset aIOFunctionErro ; "I/O function error"
		dd offset aPr_io_timeout_ ; "PR_IO_TIMEOUT_ERROR"
		dd offset aIOOperationTim ; "I/O operation timed out"
		dd offset aPr_io_pending_ ; "PR_IO_PENDING_ERROR"
		dd offset aIOOperationOnB ; "I/O operation on busy file	descriptor"
		dd offset aPr_directory_o ; "PR_DIRECTORY_OPEN_ERROR"
		dd offset aTheDirectoryCo ; "The directory could not be	opened"
		dd offset aPr_invalid_arg ; "PR_INVALID_ARGUMENT_ERROR"
		dd offset aInvalidFunctio ; "Invalid function argument"
		dd offset aPr_address_n_0 ; "PR_ADDRESS_NOT_AVAILABLE_ERROR"
		dd offset aNetworkAddre_2 ; "Network address not available (in use?)"
		dd offset aPr_address_not ; "PR_ADDRESS_NOT_SUPPORTED_ERROR"
		dd offset aNetworkAddre_1 ; "Network address type not supported"
		dd offset aPr_is_connecte ; "PR_IS_CONNECTED_ERROR"
		dd offset aAlreadyConnect ; "Already connected"
		dd offset aPr_bad_address ; "PR_BAD_ADDRESS_ERROR"
		dd offset aNetworkAddre_0 ; "Network address is	invalid"
		dd offset aPr_address_in_ ; "PR_ADDRESS_IN_USE_ERROR"
		dd offset aLocalNetworkAd ; "Local Network address is in use"
		dd offset aPr_connect_ref ; "PR_CONNECT_REFUSED_ERROR"
		dd offset aConnectionRefu ; "Connection	refused	by peer"
		dd offset aPr_network_unr ; "PR_NETWORK_UNREACHABLE_ERROR"
		dd offset aNetworkAddress ; "Network address is	presently unreachabl"...
		dd offset aPr_connect_tim ; "PR_CONNECT_TIMEOUT_ERROR"
		dd offset aConnectionAtte ; "Connection	attempt	timed out"
		dd offset aPr_not_connect ; "PR_NOT_CONNECTED_ERROR"
		dd offset aNetworkFileDes ; "Network file descriptor is	not connecte"...
		dd offset aPr_load_librar ; "PR_LOAD_LIBRARY_ERROR"
		dd offset aFailureToLoadD ; "Failure to	load dynamic library"
		dd offset aPr_unload_libr ; "PR_UNLOAD_LIBRARY_ERROR"
		dd offset aFailureToUnloa ; "Failure to	unload dynamic library"
		dd offset aPr_find_symbol ; "PR_FIND_SYMBOL_ERROR"
		dd offset aSymbolNotFound ; "Symbol not	found in any of	the loaded d"...
		dd offset aPr_insufficien ; "PR_INSUFFICIENT_RESOURCES_ERROR"
		dd offset aInsufficientSy ; "Insufficient system resources"
		dd offset aPr_directory_l ; "PR_DIRECTORY_LOOKUP_ERROR"
		dd offset aADirectoryLook ; "A directory lookup	on a network address"...
		dd offset aPr_tpd_range_e ; "PR_TPD_RANGE_ERROR"
		dd offset aAttemptToAcces ; "Attempt to	access a TPD key that is out"...
		dd offset aPr_proc_desc_t ; "PR_PROC_DESC_TABLE_FULL_ERROR"
		dd offset aProcessOpenFdT ; "Process open FD table is full"
		dd offset aPr_sys_desc_ta ; "PR_SYS_DESC_TABLE_FULL_ERROR"
		dd offset aSystemOpenFdTa ; "System open FD table is full"
		dd offset aPr_not_socket_ ; "PR_NOT_SOCKET_ERROR"
		dd offset aNetworkOperati ; "Network operation attempted on non-netw"...
		dd offset aPr_not_tcp_soc ; "PR_NOT_TCP_SOCKET_ERROR"
		dd offset aTcpSpecificFun ; "TCP-specific function attempted on	a no"...
		dd offset aPr_socket_addr ; "PR_SOCKET_ADDRESS_IS_BOUND_ERROR"
		dd offset aTcpFileDescrip ; "TCP file descriptor is already bound"
		dd offset aPr_no_access_r ; "PR_NO_ACCESS_RIGHTS_ERROR"
		dd offset aAccessDenied	; "Access Denied"
		dd offset aPr_operation_n ; "PR_OPERATION_NOT_SUPPORTED_ERROR"
		dd offset aTheRequestedOp ; "The requested operation is	not supporte"...
		dd offset aPr_protocol_no ; "PR_PROTOCOL_NOT_SUPPORTED_ERROR"
		dd offset aTheHostOperati ; "The host operating	system does not	supp"...
		dd offset aPr_remote_file ; "PR_REMOTE_FILE_ERROR"
		dd offset aAccessToTheRem ; "Access to the remote file has been	seve"...
		dd offset aPr_buffer_over ; "PR_BUFFER_OVERFLOW_ERROR"
		dd offset aTheValueReques ; "The value requested is too	large to be "...
		dd offset aPr_connect_res ; "PR_CONNECT_RESET_ERROR"
		dd offset aTcpConnectionR ; "TCP connection reset by peer"
		dd offset aPr_range_error ; "PR_RANGE_ERROR"
		dd offset aUnused	; "Unused"
		dd offset aPr_deadlock_er ; "PR_DEADLOCK_ERROR"
		dd offset aTheOperationWo ; "The operation would have deadlocked"
		dd offset aPr_file_is_loc ; "PR_FILE_IS_LOCKED_ERROR"
		dd offset aTheFileIsAlrea ; "The file is already locked"
		dd offset aPr_file_too_bi ; "PR_FILE_TOO_BIG_ERROR"
		dd offset aWriteWouldResu ; "Write would result	in file	larger than "...
		dd offset aPr_no_device_s ; "PR_NO_DEVICE_SPACE_ERROR"
		dd offset aTheDeviceForSt ; "The device	for storing the	file is	full"
		dd offset aPr_pipe_error ; "PR_PIPE_ERROR"
		dd offset aUnused	; "Unused"
		dd offset aPr_no_seek_dev ; "PR_NO_SEEK_DEVICE_ERROR"
		dd offset aUnused	; "Unused"
		dd offset aPr_is_director ; "PR_IS_DIRECTORY_ERROR"
		dd offset aCannotPerformA ; "Cannot perform a normal file operation "...
		dd offset aPr_loop_error ; "PR_LOOP_ERROR"
		dd offset aSymbolicLinkLo ; "Symbolic link loop"
		dd offset aPr_name_too_lo ; "PR_NAME_TOO_LONG_ERROR"
		dd offset aFileNameIsTooL ; "File name is too long"
		dd offset aPr_file_not_fo ; "PR_FILE_NOT_FOUND_ERROR"
		dd offset aFileNotFound	; "File	not found"
		dd offset aPr_not_directo ; "PR_NOT_DIRECTORY_ERROR"
		dd offset aCannotPerformD ; "Cannot perform directory operation	on a"...
		dd offset aPr_read_only_f ; "PR_READ_ONLY_FILESYSTEM_ERROR"
		dd offset aCannotWriteToA ; "Cannot write to a read-only file system"
		dd offset aPr_directory_n ; "PR_DIRECTORY_NOT_EMPTY_ERROR"
		dd offset aCannotDeleteAD ; "Cannot delete a directory that is not e"...
		dd offset aPr_filesystem_ ; "PR_FILESYSTEM_MOUNTED_ERROR"
		dd offset aCannotDeleteOr ; "Cannot delete or rename a file object w"...
		dd offset aPr_not_same_de ; "PR_NOT_SAME_DEVICE_ERROR"
		dd offset aCannotRenameAF ; "Cannot rename a file to a file system o"...
		dd offset aPr_directory_c ; "PR_DIRECTORY_CORRUPTED_ERROR"
		dd offset aTheDirectoryOb ; "The directory object in the file system"...
		dd offset aPr_file_exists ; "PR_FILE_EXISTS_ERROR"
		dd offset aCannotCreateOr ; "Cannot create or rename a filename	that"...
		dd offset aPr_max_directo ; "PR_MAX_DIRECTORY_ENTRIES_ERROR"
		dd offset aDirectoryIsFul ; "Directory is full.	 No additional filen"...
		dd offset aPr_invalid_dev ; "PR_INVALID_DEVICE_STATE_ERROR"
		dd offset aTheRequiredDev ; "The required device was in	an invalid s"...
		dd offset aPr_device_is_l ; "PR_DEVICE_IS_LOCKED_ERROR"
		dd offset aTheDeviceIsLoc ; "The device	is locked"
		dd offset aPr_no_more_fil ; "PR_NO_MORE_FILES_ERROR"
		dd offset aNoMoreEntriesI ; "No	more entries in	the directory"
		dd offset aPr_end_of_file ; "PR_END_OF_FILE_ERROR"
		dd offset aEncounteredEnd ; "Encountered end of	file"
		dd offset aPr_file_seek_e ; "PR_FILE_SEEK_ERROR"
		dd offset aSeekError	; "Seek	error"
		dd offset aPr_file_is_bus ; "PR_FILE_IS_BUSY_ERROR"
		dd offset aTheFileIsBusy ; "The	file is	busy"
		dd offset aPr_operation_a ; "PR_OPERATION_ABORTED_ERROR"
		dd offset aTheIOOperation ; "The I/O operation was aborted"
		dd offset aPr_in_progress ; "PR_IN_PROGRESS_ERROR"
		dd offset aOperationIsSti ; "Operation is still	in progress (probabl"...
		dd offset aPr_already_ini ; "PR_ALREADY_INITIATED_ERROR"
		dd offset aOperationHasAl ; "Operation has already been	initiated (p"...
		dd offset aPr_group_empty ; "PR_GROUP_EMPTY_ERROR"
		dd offset aTheWaitGroupIs ; "The wait group is empty"
		dd offset aPr_invalid_sta ; "PR_INVALID_STATE_ERROR"
		dd offset aObjectStateImp ; "Object state improper for request"
		dd offset aPr_network_dow ; "PR_NETWORK_DOWN_ERROR"
		dd offset aNetworkIsDown ; "Network is down"
		dd offset aPr_socket_shut ; "PR_SOCKET_SHUTDOWN_ERROR"
		dd offset aSocketShutdown ; "Socket shutdown"
		dd offset aPr_connect_abo ; "PR_CONNECT_ABORTED_ERROR"
		dd offset aConnectionAbor ; "Connection	aborted"
		dd offset aPr_host_unreac ; "PR_HOST_UNREACHABLE_ERROR"
		dd offset aHostIsUnreacha ; "Host is unreachable"
		dd offset aPr_library_not ; "PR_LIBRARY_NOT_LOADED_ERROR"
		dd offset aTheLibraryIsNo ; "The library is not	loaded"
		dd offset aPr_call_once_e ; "PR_CALL_ONCE_ERROR"
		dd offset aTheOneTimeFunc ; "The one-time function was previously ca"...
		dd offset aPr_max_error	; "PR_MAX_ERROR"
		dd offset aPlaceholderFor ; "Placeholder for the end of	the list"
		align 10h
off_1002A1C0	dd offset off_10029F50	; DATA XREF: PR_Init_0:loc_1000C860o
		dd offset aPrerr	; "prerr"
dword_1002A1C8	dd 0FFFFE890h, 4Dh, 6E65h ; DATA XREF: .data:100302A4o
aIDefault	db 'i-default',0        ; DATA XREF: .data:off_100302A0o
		db 0
byte_1002A1DF	db 0			; DATA XREF: sub_1000C980+18r
					; sub_1000C980+33r ...
aAbcdefghijklmn	db 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_',0
dword_1002A220	dd 6E6B6E55h		; DATA XREF: PR_ErrorToString:loc_1000CA87r
dword_1002A224	dd 206E776Fh		; DATA XREF: PR_ErrorToString+7Cr
dword_1002A228	dd 65646F63h		; DATA XREF: PR_ErrorToString+90r
word_1002A22C	dw 20h			; DATA XREF: PR_ErrorToString+9Br
		align 10h
a4_10_7		db '4.10.7',0           ; DATA XREF: PR_GetVersiono
		align 4
; char aNspr_native__0[]
aNspr_native__0	db 'NSPR_NATIVE_THREADS_ONLY',0 ; DATA XREF: sub_1000CDA0:loc_1000CDC6o
		align 4
; CHAR ProcName[]
ProcName	db 'nspr_native_threads_only',0 ; DATA XREF: sub_1000CDA0+8o
		align 10h
aSD0xLx		db ':%s:%d:0x%lx',0     ; DATA XREF: PR_ProcessAttrSetInheritableFD:loc_1000D089o
		align 10h
aNspr_inherit_f	db 'NSPR_INHERIT_FDS=%s:%d:0x%lx',0
					; DATA XREF: PR_ProcessAttrSetInheritableFD+F0o
		align 10h
aD0xLx		db '%d:0x%lx',0         ; DATA XREF: PR_GetInheritedFD+A1o
		align 4
; char aNspr_inherit_0[]
aNspr_inherit_0	db 'NSPR_INHERIT_FDS',0 ; DATA XREF: PR_GetInheritedFD+19o
		align 10h
; char aShma[]
aShma		db 'shma',0             ; DATA XREF: PR_Init_0+B2o
		align 4
; char aShm[]
aShm		db 'shm',0              ; DATA XREF: PR_Init_0+A3o
; char aGc[]
aGc		db 'gc',0               ; DATA XREF: PR_Init_0+94o
		align 10h
; char aThread[]
aThread		db 'thread',0           ; DATA XREF: PR_Init_0+85o
		align 4
; char aSched[]
aSched		db 'sched',0            ; DATA XREF: PR_Init_0+76o
		align 10h
; char aCvar[]
aCvar		db 'cvar',0             ; DATA XREF: PR_Init_0+67o
		align 4
; char aLinker[]
aLinker		db 'linker',0           ; DATA XREF: PR_Init_0+58o
		align 10h
; char aMon[]
aMon		db 'mon',0              ; DATA XREF: PR_Init_0+49o
; char aIo[]
aIo		db 'io',0               ; DATA XREF: PR_Init_0+3Ao
		align 4
; char aCmon[]
aCmon		db 'cmon',0             ; DATA XREF: PR_Init_0+2Bo
		align 10h
; char aClock[]
aClock		db 'clock',0            ; DATA XREF: PR_Init_0+21o
		align 4
aPr_cleanupClea	db 'PR_Cleanup: clean up before destroying thread',0
					; DATA XREF: PR_Cleanup+FBo
		align 4
aPr_cleanupShut	db 'PR_Cleanup: shutting down NSPR',0 ; DATA XREF: PR_Cleanup+2Bo
		align 4
dword_1002A358	dd 0			; DATA XREF: sub_10003170+1Cr
					; PR_SetNetAddr:loc_1000E43Br
dword_1002A35C	dd 0			; DATA XREF: sub_10003170+25r
					; PR_SetNetAddr+A3r
dword_1002A360	dd 0			; DATA XREF: sub_10003170+2Dr
					; PR_SetNetAddr+ACr
dword_1002A364	dd 0			; DATA XREF: sub_10003170+36r
					; PR_SetNetAddr+B5r
dword_1002A368	dd 0			; DATA XREF: PR_SetNetAddr+72r
dword_1002A36C	dd 0			; DATA XREF: PR_SetNetAddr+7Br
dword_1002A370	dd 0			; DATA XREF: PR_SetNetAddr+83r
dword_1002A374	dd 1000000h		; DATA XREF: PR_SetNetAddr+8Cr
byte_1002A378	db 7Fh			; DATA XREF: sub_1000E610+83r
					; sub_1000E610+14Er ...
		db 3 dup(7Fh)
		dd 0Bh dup(7F7F7F7Fh), 3020100h, 7060504h, 7F7F0908h, 7F7F7F7Fh
		dd 0C0B0A7Fh, 7F0F0E0Dh, 6 dup(7F7F7F7Fh), 0C0B0A7Fh, 7F0F0E0Dh
		dd 26h dup(7F7F7F7Fh)
aGetnameinfo	db 'getnameinfo',0      ; DATA XREF: sub_1000ED80+55o
aFreeaddrinfo	db 'freeaddrinfo',0     ; DATA XREF: sub_1000ED80+4Ao
		align 4
aGetaddrinfo	db 'getaddrinfo',0      ; DATA XREF: sub_1000ED80+33o
aWship6_dll	db 'wship6.dll',0       ; DATA XREF: sub_1000ED80+Do
		align 4
aWs2_32_dll	db 'ws2_32.dll',0       ; DATA XREF: sub_1000ED80+5o
		align 4
aU_U_U_U	db '%u.%u.%u.%u',0      ; DATA XREF: PR_NetAddrToString-15o
		align 8
byte_1002A4C8	db 7Fh			; DATA XREF: sub_1000F380+72r
		db 3 dup(7Fh)
		dd 0Bh dup(7F7F7F7Fh), 3020100h, 7060504h, 7F7F0908h, 7F7F7F7Fh
		dd 0C0B0A7Fh, 7F0F0E0Dh, 6 dup(7F7F7F7Fh), 0C0B0A7Fh, 7F0F0E0Dh
		dd 26h dup(7F7F7F7Fh)
dword_1002A5C8	dd 363878h		; DATA XREF: PR_GetSystemInfo+A9o
aPrtraceGotTrac	db 'PRTrace: Got trace buffer of size: %ld, at %p',0
					; DATA XREF: sub_10010AF0+ABo
		align 4
aPrtraceFailedT	db 'PRTrace: Failed to get trace buffer',0 ; DATA XREF: sub_10010AF0+88o
aNewtracebuffer	db 'NewTraceBuffer: logSegments: %ld, logEntries: %ld, logEntriesPerS'
					; DATA XREF: sub_10010AF0+56o
		db 'egment: %ld, logSegSize: %ld',0
		align 10h
; char aTrace[]
aTrace		db 'trace',0            ; DATA XREF: sub_10010BE0+15o
		align 4
aPrtraceCreateQ	db 'PRTrace: Create: QName: %s %p, RName: %s %p',0Ah
					; DATA XREF: PR_CreateTrace+170o
		db 9,0
		align 4
aPrtraceCreatet	db 'PRTRACE: CreateTrace: Qname: %s, RName: %s',0
					; DATA XREF: PR_CreateTrace+26o
		align 4
aPrtraceDelet_1	db 'PRTrace: Deleting unused QName: %s, %p',0
					; DATA XREF: PR_DestroyTrace+8Eo
		align 4
aPrtraceDelet_0	db 'PRTrace: Deleting RName: %s, %p',0 ; DATA XREF: PR_DestroyTrace+48o
aPrtraceDeletin	db 'PRTrace: Deleting: QName: %s, RName: %s',0
					; DATA XREF: PR_DestroyTrace+1Co
aPrsettraceop_9	db 'PRSetTraceOption: Invalid command %ld',0
					; DATA XREF: PR_SetTraceOption+25Fo
		align 4
aPrsettraceop_8	db 'PRSetTraceOption: PRTraceUnLockHandles',0
					; DATA XREF: PR_SetTraceOption+22Eo
		align 4
aPrsettraceop_7	db 'PRSetTraceOption: PRTraceLockTraceHandles',0
					; DATA XREF: PR_SetTraceOption+206o
		align 10h
aPrsettraceop_6	db 'PRSetTraceOption: PRTraceStopRecording',0
					; DATA XREF: PR_SetTraceOption+1ECo
		align 4
aPrsettraceop_5	db 'PRSetTraceOption: PRTraceResumeRecording',0
					; DATA XREF: PR_SetTraceOption+162o
		align 4
aPrsettraceop_4	db 'PRSetTraceOption: PRTraceSuspendRecording',0
					; DATA XREF: PR_SetTraceOption+148o
		align 10h
aPrsettraceop_3	db 'PRSetTraceOption: PRTraceResume',0 ; DATA XREF: PR_SetTraceOption+FEo
aPrsettraceop_2	db 'PRSetTraceOption: PRTraceSuspend',0 ; DATA XREF: PR_SetTraceOption+DBo
		align 4
aPrsettraceop_1	db 'PRSetTraceOption: PRTraceDisable: %p',0
					; DATA XREF: PR_SetTraceOption+B8o
		align 4
aPrsettraceop_0	db 'PRSetTraceOption: PRTraceEnable: %p',0
					; DATA XREF: PR_SetTraceOption+8Eo
aPrsettraceopti	db 'PRSetTraceOption: PRTraceBufSize: %ld',0
					; DATA XREF: PR_SetTraceOption+64o
		align 4
aPrgettraceop_0	db 'PRGetTraceOption: PRTraceBufSize: %ld',0
					; DATA XREF: PR_GetTraceOption+3Ao
		align 10h
aPrgettraceopti	db 'PRGetTraceOption: Invalid command %ld',0
					; DATA XREF: PR_GetTraceOption+18o
		align 4
aPrtraceGetcont	db 'PRTrace: GetConterNameFromHandle: QNp: %p, RNp: %p,',0Ah
					; DATA XREF: PR_GetTraceNameFromHandle+36o
					; PR_GetTraceHandleFromName+CDo
		db 9,'QName: %s, RName: %s, Desc: %s',0
aPrtraceFindnex	db 'PRTrace: FindNextQname: Handle: %p, Returns: %p',0
					; DATA XREF: PR_FindNextTraceQname+38o
					; PR_GetTraceHandleFromName+51o ...
aPrtraceFindn_0	db 'PRTrace: FindNextRname: Rhandle: %p, QHandle: %p, Returns: %p',0
					; DATA XREF: PR_FindNextTraceRname+36o
					; PR_GetTraceHandleFromName+91o ...
		align 10h
aRecordtracee_0	db 'RecordTraceEntries: Cannot open %s as trace log file. OS error: %'
					; DATA XREF: sub_100113B0+92o
		db 'ld',0
aRecordtraceent	db 'RecordTraceEntries: Environment variable not defined. Exiting',0
					; DATA XREF: sub_100113B0+5Ao
		align 4
; char aNspr_trace_log[]
aNspr_trace_log	db 'NSPR_TRACE_LOG',0   ; DATA XREF: sub_100113B0+27o
		align 4
aPr_recordtra_0	db 'PR_RecordTraceEntries: begins',0 ; DATA XREF: sub_100113B0+19o
		align 4
aRecordtracee_5	db 'RecordTraceEntries: Invalid logOrder: %ld',0
					; DATA XREF: sub_10011460+D6o
		align 10h
aRecordtracee_4	db 'RecordTraceEntries: LogStop',0 ; DATA XREF: sub_10011460+BBo
aRecordtracee_3	db 'RecordTraceEntries: LogResume',0 ; DATA XREF: sub_10011460+93o
		align 4
aRecordtracee_2	db 'RecordTraceEntries: LogSuspend',0 ; DATA XREF: sub_10011460+67o
		align 4
aRecordtracee_1	db 'RecordTraceEntries: LogReset',0 ; DATA XREF: sub_10011460+3Ao
		align 4
aRecordtracee_8	db 'RecordTraceEntries: PR_Write(): Buffer: %p, bytes: %ld',0
					; DATA XREF: sub_10011560+7Co
		align 4
aRecordtracee_7	db 'RecordTraceEntries: PR_Write() Tried to write: %ld, Wrote: %ld',0
					; DATA XREF: sub_10011560+60o
		align 4
aRecordtracee_6	db 'RecordTraceEntries: PR_Write() failed. Error: %ld',0
					; DATA XREF: sub_10011560+40o
		align 4
aWritetracesegm	db 'WriteTraceSegment: Buffer: %p, Amount: %ld',0
					; DATA XREF: sub_10011560+Do
		align 4
aRecordtrace_10	db 'RecordTraceEntries: exiting',0 ; DATA XREF: PR_RecordTraceEntries+195o
aRecordtracee_9	db 'RecordTraceEntries: PR_Write(): is suspended',0
					; DATA XREF: PR_RecordTraceEntries+160o
		align 10h
aPr_recordtra_2	db 'PR_RecordTraceEntries: LostData segments: %ld',0
					; DATA XREF: PR_RecordTraceEntries+E7o
		align 10h
aPr_recordtra_1	db 'PR_RecordTraceEntries: Failed to initialize',0
					; DATA XREF: PR_RecordTraceEntries+20o
aPr_gettracee_1	db 'PR_GetTraceEntries: Copied: %ld, LastSeen: %ld',0
					; DATA XREF: PR_GetTraceEntries+EEo
					; PR_GetTraceEntries+151o
		align 4
aPr_gettracee_0	db 'PR_GetTraceEntries: Next: %ld, LastSeen: %ld',0
					; DATA XREF: PR_GetTraceEntries+2Eo
		align 4
aPrtraceGettrac	db 'PRTrace: GetTraceHandleFromName:',0Ah
					; DATA XREF: PR_GetTraceHandleFromName+24o
		db 9,'QName: %s, RName: %s',0
		align 4
aDecember	db 'December',0         ; DATA XREF: .data:1003037Co
		align 10h
aNovember	db 'November',0         ; DATA XREF: .data:10030378o
		align 4
aOctober	db 'October',0          ; DATA XREF: .data:10030374o
aSeptember	db 'September',0        ; DATA XREF: .data:10030370o
		align 10h
aAugust		db 'August',0           ; DATA XREF: .data:1003036Co
		align 4
aJuly		db 'July',0             ; DATA XREF: .data:10030368o
		align 10h
aJune		db 'June',0             ; DATA XREF: .data:10030364o
		align 4
aApril		db 'April',0            ; DATA XREF: .data:1003035Co
		align 10h
aMarch		db 'March',0            ; DATA XREF: .data:10030358o
		align 4
aFebruary	db 'February',0         ; DATA XREF: .data:10030354o
		align 4
aJanuary	db 'January',0          ; DATA XREF: .data:off_10030350o
aDec		db 'Dec',0              ; DATA XREF: .data:1003034Co
aNov		db 'Nov',0              ; DATA XREF: .data:10030348o
aOct		db 'Oct',0              ; DATA XREF: .data:10030344o
aSep		db 'Sep',0              ; DATA XREF: .data:10030340o
aAug		db 'Aug',0              ; DATA XREF: .data:1003033Co
aJul		db 'Jul',0              ; DATA XREF: .data:10030338o
aJun		db 'Jun',0              ; DATA XREF: .data:10030334o
aMay		db 'May',0              ; DATA XREF: .data:10030330o
					; .data:10030360o
aApr		db 'Apr',0              ; DATA XREF: .data:1003032Co
aMar		db 'Mar',0              ; DATA XREF: .data:10030328o
aFeb		db 'Feb',0              ; DATA XREF: .data:10030324o
aJan		db 'Jan',0              ; DATA XREF: .data:off_10030320o
aSaturday	db 'Saturday',0         ; DATA XREF: .data:1003031Co
		align 4
aFriday		db 'Friday',0           ; DATA XREF: .data:10030318o
		align 10h
aThursday	db 'Thursday',0         ; DATA XREF: .data:10030314o
		align 4
aWednesday	db 'Wednesday',0        ; DATA XREF: .data:10030310o
		align 4
aTuesday	db 'Tuesday',0          ; DATA XREF: .data:1003030Co
aMonday		db 'Monday',0           ; DATA XREF: .data:10030308o
		align 4
aSunday		db 'Sunday',0           ; DATA XREF: .data:off_10030304o
		align 10h
aSat		db 'Sat',0              ; DATA XREF: .data:10030300o
aFri		db 'Fri',0              ; DATA XREF: .data:100302FCo
aThu		db 'Thu',0              ; DATA XREF: .data:100302F8o
aWed		db 'Wed',0              ; DATA XREF: .data:100302F4o
aTue		db 'Tue',0              ; DATA XREF: .data:100302F0o
aMon_0		db 'Mon',0              ; DATA XREF: .data:100302ECo
aSun		db 'Sun',0              ; DATA XREF: .data:off_100302E8o
		align 10h
dword_1002AE90	dd 0FFFFFFFFh		; DATA XREF: PR_NormalizeTime+25Dr
					; sub_10012330+1DEr
dword_1002AE94	dd 1Eh			; DATA XREF: sub_10012330+1B7r
					; sub_10012330+1C7o
		dd 3Ah,	59h, 77h, 96h, 0B4h, 0D3h, 0F2h, 110h, 12Fh, 14Dh
		dd 16Ch, 0FFFFFFFFh, 1Eh, 3Bh, 5Ah, 78h, 97h, 0B5h, 0D4h
		dd 0F3h, 111h, 130h, 14Eh, 16Dh
byte_1002AEF8	db 1Fh			; DATA XREF: sub_10011B70+E6r
					; sub_10011B70+165r ...
		db 1Ch,	1Fh, 1Eh
		dd 1F1F1E1Fh, 1F1E1F1Eh, 1E1F1D1Fh, 1F1F1E1Fh, 1F1E1F1Eh
dword_1002AF10	dd 91E0003h		; DATA XREF: PR_USPacificTimeParameters+61o
		db 0FFh, 1Fh
word_1002AF16	dw 102h			; DATA XREF: PR_USPacificTimeParameters+6Do
		dd 1E000A1Fh
; char dword_1002AF1C[]
dword_1002AF1C	dd 5A25h		; DATA XREF: PR_FormatTimeUSEnglish+4DDo
a_4d		db '%.4d',0             ; DATA XREF: PR_FormatTimeUSEnglish+4B5o
		align 4
aHMS		db '%H:%M:%S',0         ; DATA XREF: PR_FormatTimeUSEnglish+455o
		align 4
aMDY		db '%m/%d/%y',0         ; DATA XREF: PR_FormatTimeUSEnglish+42Do
		align 10h
aD_0		db '%d',0               ; DATA XREF: PR_FormatTimeUSEnglish+3B1o
		align 4
a_2d		db '%.2d',0             ; DATA XREF: PR_FormatTimeUSEnglish+385o
					; PR_FormatTimeUSEnglish+3E6o ...
		align 4
aPm		db 'PM',0               ; DATA XREF: PR_FormatTimeUSEnglish+2EDo
					; PR_FormatTimeUSEnglish+312o
		align 10h
aAm		db 'AM',0               ; DATA XREF: PR_FormatTimeUSEnglish+2E3o
					; PR_FormatTimeUSEnglish+308o
		align 4
a_3d		db '%.3d',0             ; DATA XREF: PR_FormatTimeUSEnglish+252o
		align 4
a_2ld		db '%.2ld',0            ; DATA XREF: PR_FormatTimeUSEnglish+1BFo
					; PR_FormatTimeUSEnglish+1EDo ...
		align 4
aABDHMSY	db '%a %b %d %H:%M:%S %Y',0 ; DATA XREF: PR_FormatTimeUSEnglish+16Eo
		align 4
aReadD		db 'read -> %d',0       ; DATA XREF: sub_100140A0+83o
		align 4
aWriteD		db 'write -> %d',0      ; DATA XREF: sub_10014140+CAo
aConnectD	db 'connect -> %d',0    ; DATA XREF: sub_10014EA0+6Bo
		align 4
aRecvDErrorDOsE	db 'recv -> %d, error = %d, os error = %d',0 ; DATA XREF: sub_10015080+199o
					; sub_10015260+F7o
		align 4
aRecvFdPOsfdLdB	db 'recv: fd=%p osfd=%ld buf=%p amount=%d flags=%d',0
					; DATA XREF: sub_10015080+99o
					; sub_10015260+76o
		align 4
aSendD		db 'send -> %d',0       ; DATA XREF: sub_10015370+DDo
		align 4
aSendFdPOsfdLdB	db 'send: fd=%p osfd=%ld buf=%p amount=%d',0 ; DATA XREF: sub_10015370+88o
		align 10h
aPr_select_0	db 'PR_Select()',0      ; DATA XREF: PR_Select+Eo
aPr_poll_0	db 'PR_Poll()',0        ; DATA XREF: PR_Select+9o
		align 4
aPr_yieldDone	db 'PR_Yield: done',0   ; DATA XREF: PR_Sleep+180o
		align 4
aPr_yieldYieldi	db 'PR_Yield: yielding',0 ; DATA XREF: PR_Sleep+15Fo
		align 4
aPr_yield_0	db 'PR_Yield()',0       ; DATA XREF: PR_Yield+Eo
		align 4
aPr_sleepPr_int	db 'PR_Sleep(PR_INTERVAL_NO_WAIT)',0 ; DATA XREF: PR_Yield+9o
		align 4
asc_1002B098	db 0Ah,0		; DATA XREF: sub_10017410+7Fo
					; sub_100174C0+84o
		align 4
aLockP		db ' lock=%p',0         ; DATA XREF: sub_10017410+6Fo
					; sub_100174C0+74o
		align 4
aCondvarPSleepL	db ' condvar=%p sleep=%lldms',0 ; DATA XREF: sub_10017410+58o
					; sub_100174C0+5Do
		align 4
aSuspended	db ' suspended',0       ; DATA XREF: sub_10017410+3Ao
					; sub_100174C0+3Fo
		align 10h
a05d08pPri2dFla	db '%05d[%08p] pri=%2d flags=0x%02x',0 ; DATA XREF: sub_10017410+1Do
					; sub_100174C0+22o
aSuspendedThrea	db 'Suspended Threads:',0Ah,0 ; DATA XREF: sub_10017580+8Co
aCondvarWaitThr	db 'CondVar wait Threads:',0Ah,0 ; DATA XREF: sub_10017580+6Fo
		align 4
aCondvarTimedWa	db 'CondVar timed wait Threads:',0Ah,0 ; DATA XREF: sub_10017580+52o
		align 4
aRunnableThread	db 'Runnable Threads:',0Ah,0 ; DATA XREF: sub_10017580+20o
		align 10h
aCurrentThread	db 'Current Thread:',0Ah,0 ; DATA XREF: sub_10017580+7o
		align 4
aPr_waitCvarPDo	db 'PR_Wait: cvar=%p done waiting',0 ; DATA XREF: sub_10018450+25Fo
		align 4
aPr_waitCvarPWa	db 'PR_Wait: cvar=%p waiting for %d',0 ; DATA XREF: sub_10018450+216o
a_pr_notifycond	db '_PR_NotifyCondVar: cvar=%p',0 ; DATA XREF: sub_100187B0+9Do
		align 10h
aExpirewaitsEla	db 'ExpireWaits: elapsed=%lld usec',0 ; DATA XREF: sub_10018940+33o
		align 10h
aPr_notifyallCv	db 'PR_NotifyAll: cvar=%p',0 ; DATA XREF: PR_NotifyAllCondVar+B4o
					; PRP_NakedBroadcast+A1o
		align 4
aIntson0SIntr	db 'IntsOn[0]: %s intr',0 ; DATA XREF: sub_100190B0+58o
		align 4
aThreadExiting	db 'thread exiting',0   ; DATA XREF: .text:10019D78o
					; .text:10019FD6o
		align 4
aSwitchingToDP	db 'switching to %d[%p]',0 ; DATA XREF: sub_1001A480+1FBo
aPausing	db 'pausing',0          ; DATA XREF: sub_1001A480+160o
dword_1002B238	dd 0D53E8000h		; DATA XREF: sub_10021610+18r
dword_1002B23C	dd 19DB1DEh		; DATA XREF: sub_10021610+21r
		dd 0Ah,	0
; char Control[1]
Control		db ' '                  ; DATA XREF: sub_1001C350+6Fo
		db 0Ch,	0Ah, 0Dh
		dd 0B09h
; char aNspr_inherit_1[]
aNspr_inherit_1	db 'NSPR_INHERIT_FDS=',0 ; DATA XREF: PR_CreateProcess_0+105o
		align 4
aWindows_98	db 'Windows_98',0       ; DATA XREF: sub_1001CA00+174o
		align 10h
aWindows_95	db 'Windows_95',0       ; DATA XREF: sub_1001CA00+146o
		align 4
aD_D		db '%d.%d',0            ; DATA XREF: sub_1001CA00+116o
					; sub_1001CA00+1B1o
		align 4
aWindows_nt	db 'Windows_NT',0       ; DATA XREF: sub_1001CA00+D5o
		align 10h
aWindows_unknow	db 'Windows_Unknown',0  ; DATA XREF: sub_1001CA00+90o
aMd_memmapS	db 'md_memmap(): %s',0  ; DATA XREF: sub_1001CC90+5Bo
a_pr_nt_initsid	db '_PR_NT_InitSids: OpenProcessToken() failed. Error: %d',0
					; DATA XREF: sub_1001CE50+5Bo
		align 4
dword_1002B2E8	dd 2A2E2A5Ch		; DATA XREF: sub_100212E0+11Dr
byte_1002B2EC	db 0			; DATA XREF: sub_100212E0+125r
		align 10h
dword_1002B2F0	dd 5C3A43h		; DATA XREF: sub_100226A0+17r
		dd 406D1388h
aPr_setthread_1	db 'PR_SetThreadPriority: can',27h,'t set thread priority',0Ah,0
					; DATA XREF: sub_100245D0+5Bo
		align 4
aPr_openshare_7	db 'PR_OpenSharedMemory: OpenFileMapping() success: %s, handle: %d',0
					; DATA XREF: sub_10025F70+30Ao
		align 4
aPr_openshare_6	db 'PR_OpenSharedMemory: OpenFileMapping() failed: %s, error: %d',0
					; DATA XREF: sub_10025F70+2CFo
		align 10h
aPr_openshare_5	db 'PR_OpenSharedMemory: CreateFileMapping() success: %s, handle: %d',0
					; DATA XREF: sub_10025F70+291o
		align 4
aPr_openshare_4	db 'PR_OpenSharedMemory: Request exclusive & already exists',0
					; DATA XREF: sub_10025F70+22Do
aPr_openshare_3	db 'PR_OpenSharedMemory: CreateFileMapping() failed: %s',0
					; DATA XREF: sub_10025F70+1EFo
aPr_openshare_2	db 'PR_OpenSharedMemory: New shm->ipcname out of memory',0
					; DATA XREF: sub_10025F70+10Bo
aPr_openshare_1	db 'PR_OpenSharedMemory: New PRSharedMemory out of memory',0
					; DATA XREF: sub_10025F70+ABo
		align 4
aPr_openshare_0	db 'PR_OpenSharedMemory: name is invalid',0 ; DATA XREF: sub_10025F70+5Ao
		align 4
a_md_attachshar	db '_MD_AttachSharedMemory: MapViewOfFile() failed. OSerror: %d',0
					; DATA XREF: PR_AttachSharedMemory_0+50o
a_md_detachshar	db '_MD_DetachSharedMemory: UnmapViewOfFile() failed. OSerror: %d',0
					; DATA XREF: PR_DetachSharedMemory_0+33o
		align 10h
a_md_closeshare	db '_MD_CloseSharedMemory: CloseHandle() failed. OSerror: %d',0
					; DATA XREF: PR_CloseSharedMemory_0+37o
		align 4
a_md_openanon_0	db '_md_OpenAnonFileMap(): DuplicateHandle(): failed',0
					; DATA XREF: PR_OpenAnonFileMap_0+85o
		align 10h
a_md_openanonfi	db '_md_OpenAnonFileMap(): PR_CreateFileMap(): failed',0
					; DATA XREF: PR_OpenAnonFileMap_0+2Do
		align 8
a_md_exportfile	db '_md_ExportFileMapAsString(): prot: %x, hFileMap: %x, dwAccess: %x'
					; DATA XREF: PR_ExportFileMapAsString_0+43o
		db 0
		align 4
aDLdLd		db '%d:%ld:%ld',0       ; DATA XREF: PR_ExportFileMapAsString_0+1Ao
					; PR_ImportFileMapFromString_0+17o
		align 4
a_md_importfi_0	db '_md_ImportFileMapFromString(): fm: %p, prot: %d, hFileMap: %8.8x,'
					; DATA XREF: PR_ImportFileMapFromString_0+85o
		db ' dwAccess: %8.8x, fd: %x',0
		align 4
a_md_importfile	db '_md_ImportFileMapFromString(): PR_NEWZAP(): Failed',0
					; DATA XREF: PR_ImportFileMapFromString_0+40o
		align 4
		dd 0
; struct _EXCEPTION_POINTERS ExceptionInfo
ExceptionInfo	_EXCEPTION_POINTERS <offset dword_100326A0, offset dword_100326F0>
					; DATA XREF: sub_100271CA+C3o
		align 8
		dd 86808006h, 808180h, 86031000h, 80828680h, 45050514h
		dd 85854545h, 585h, 50803030h, 8008080h, 38272800h, 805750h
		dd 30370007h, 88505030h, 20000000h, 80888028h, 80h
aHhhXppwpp	db '```hhh',8,8,7,'xppwpp',8,8,0
		dw 800h
		dd 7000800h, 8,	0
__load_config_used dd 48h		; Size
		dd 0			; Time stamp
		dw 2 dup(0)		; Version: 0.0
		dd 0			; GlobalFlagsClear
		dd 0			; GlobalFlagsSet
		dd 0			; CriticalSectionDefaultTimeout
		dd 0			; DeCommitFreeBlockThreshold
		dd 0			; DeCommitTotalFreeThreshold
		dd 0			; LockPrefixTable
		dd 0			; MaximumAllocationSize
		dd 0			; VirtualMemoryThreshold
		dd 0			; ProcessAffinityMask
		dd 0			; ProcessHeapFlags
		dw 0			; CSDVersion
		dw 0			; Reserved1
		dd 0			; EditList
		dd offset ___security_cookie ; SecurityCookie
		dd offset ___safe_se_handler_table ; SEHandlerTable
		dd 2			; SEHandlerCount
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		align 10h
___safe_se_handler_table dd rva	sub_10026710 ; DATA XREF: .rdata:1002B7A8o
		dd rva sub_10026D0F
stru_1002B7D8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10024650+5o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10024650
		dd 0FFFFFFC8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100246BD	; ScopeRecord.FilterFunc
		dd offset loc_100246C1	; ScopeRecord.HandlerFunc
		align 8
dword_1002B7F8	dd 0FFFFFFFEh, 0	; DATA XREF: DllEntryPoint-25Ao
		dd 0FFFFFFB4h, 0
		dd 0FFFFFFFEh, 0
		dd offset sub_100271A9
		align 8
		dd offset sub_10026FB9
		dd offset sub_10026FCD
		dd 0
		dd offset sub_10026FFB
		dd offset sub_1002700F
		align 10h
		dd offset sub_1002703E
		dd offset sub_10027052
		dd 0
		dd offset sub_10027083
		dd offset sub_10027097
		align 8
		dd offset sub_100270B2
		dd offset sub_100270C6
		dd 0
		dd offset sub_100270E7
		dd offset sub_100270FB
		align 10h
		dd offset sub_1002712C
		dd offset sub_10027140
		dd 0
		dd offset sub_10027173
		dd offset sub_10027187
		align 8
stru_1002B878	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10027364+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10027364
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100273AA	; ScopeRecord.FilterFunc
		dd offset loc_100273BE	; ScopeRecord.HandlerFunc
		align 8
stru_1002B898	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100273D0+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100273D0
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100273ED	; ScopeRecord.FilterFunc
		dd offset loc_10027409	; ScopeRecord.HandlerFunc
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_1002B92C ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva AllocateAndInitializeSid	; Import Address Table
__IMPORT_DESCRIPTOR_WSOCK32 dd rva dword_1002BB04 ; Import Name	Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aWsock32_dll	; DLL Name
		dd rva __imp_gethostbyname ; Import Address Table
__IMPORT_DESCRIPTOR_WINMM dd rva off_1002BAFC ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aWinmm_dll	; DLL Name
		dd rva __imp_timeGetTime ; Import Address Table
__IMPORT_DESCRIPTOR_msvcrt dd rva off_1002BB90 ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcrt_dll	; DLL Name
		dd rva memmove		; Import Address Table
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_1002B960 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva GetSystemTimeAsFileTime ; Import	Address	Table
		dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_1002B92C	dd rva word_1002BC68	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_1002BC84
		dd rva word_1002BC8E
		dd rva word_1002BC9E
		dd rva word_1002BCB4
		dd rva word_1002BCC8
		dd rva word_1002BCD2
		dd rva word_1002BCEE
		dd rva word_1002BD04
		dd rva word_1002BD14
		dd rva word_1002BD32
		dd rva word_1002BD50
		dd 0
;
; Import names for KERNEL32.dll
;
off_1002B960	dd rva word_1002C74A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_1002C734
		dd rva word_1002C71E
		dd rva word_1002C710
		dd rva word_1002C6F2
		dd rva word_1002C6D6
		dd rva word_1002C6CA
		dd rva word_1002C6B6
		dd rva word_1002C6A6
		dd rva word_1002C68C
		dd rva word_1002C67A
		dd rva word_1002C66A
		dd rva word_1002C65A
		dd rva word_1002C64C
		dd rva word_1002C63C
		dd rva word_1002C62C
		dd rva word_1002C612
		dd rva word_1002C5FA
		dd rva word_1002C5E2
		dd rva word_1002C5CE
		dd rva word_1002C5BC
		dd rva word_1002C5A8
		dd rva word_1002C594
		dd rva word_1002C582
		dd rva word_1002C572
		dd rva word_1002C568
		dd rva word_1002C55C
		dd rva word_1002C554
		dd rva word_1002C548
		dd rva word_1002C52E
		dd rva word_1002C51E
		dd rva word_1002C50E
		dd rva word_1002C4F6
		dd rva word_1002C4EA
		dd rva word_1002C4DA
		dd rva word_1002C4CC
		dd rva word_1002C4B8
		dd rva word_1002C4A4
		dd rva word_1002C498
		dd rva word_1002C47A
		dd rva word_1002C462
		dd rva word_1002C454
		dd rva word_1002C444
		dd rva word_1002C432
		dd rva word_1002C426
		dd rva word_1002C40E
		dd rva word_1002C3F6
		dd rva word_1002C3E8
		dd rva word_1002C3D6
		dd rva word_1002C3CA
		dd rva word_1002C3B0
		dd rva word_1002C39A
		dd rva word_1002C38C
		dd rva word_1002C372
		dd rva word_1002C354
		dd rva word_1002C346
		dd rva word_1002C32A
		dd rva word_1002C316
		dd rva word_1002C302
		dd rva word_1002C2EE
		dd rva word_1002C2DA
		dd rva word_1002C2C8
		dd rva word_1002C2B4
		dd rva word_1002C2A2
		dd rva word_1002C292
		dd rva word_1002C280
		dd rva word_1002C26A
		dd rva word_1002C25A
		dd rva word_1002C246
		dd rva word_1002C230
		dd rva word_1002C21A
		dd rva word_1002C208
		dd rva word_1002C1F0
		dd rva word_1002C1D6
		dd rva word_1002C1C6
		dd rva word_1002C1AE
		dd rva word_1002C194
		dd rva word_1002C184
		dd rva word_1002C176
		dd rva word_1002C168
		dd rva word_1002C150
		dd rva word_1002C13A
		dd rva word_1002C12A
		dd rva word_1002C116
		dd rva word_1002C100
		dd rva word_1002C0EE
		dd rva word_1002C0E0
		dd rva word_1002C0CA
		dd rva word_1002C0B8
		dd rva word_1002C0A4
		dd rva word_1002C08E
		dd rva word_1002C080
		dd rva word_1002C072
		dd rva word_1002C064
		dd rva word_1002C04E
		dd rva word_1002C03E
		dd rva word_1002C032
		dd rva word_1002C01A
		dd rva word_1002BFFE
		dd rva word_1002BFE6
		dd rva word_1002BFCE
		dd rva word_1002BFB0
		dd 0
;
; Import names for WINMM.dll
;
off_1002BAFC	dd rva word_1002BD8A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WINMMo
		dd 0
;
; Import names for WSOCK32.dll
;
dword_1002BB04	dd 80000034h		; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WSOCK32o
		dd 80000033h
		dd 80000035h
		dd 80000036h
		dd 80000009h
		dd 8000000Fh
		dd 8000000Eh
		dd 80000007h
		dd 80000001h
		dd 80000004h
		dd 8000000Dh
		dd 80000006h
		dd 80000002h
		dd 80000017h
		dd 80000039h
		dd 80000008h
		dd 8000000Ch
		dd 80000015h
		dd 80000476h
		dd 80000475h
		dd 80000474h
		dd 80000016h
		dd 80000005h
		dd 80000097h
		dd 80000010h
		dd 80000013h
		dd 80000014h
		dd 80000011h
		dd 80000012h
		dd 80000070h
		dd 80000074h
		dd 80000073h
		dd 8000006Fh
		dd 80000003h
		dd 0
;
; Import names for msvcrt.dll
;
off_1002BB90	dd rva word_1002BEFC	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_msvcrto
		dd rva word_1002BEF2
		dd rva word_1002BEE8
		dd rva word_1002BEDC
		dd rva word_1002BED0
		dd rva word_1002BEC6
		dd rva word_1002BEBA
		dd rva word_1002BEB0
		dd rva word_1002BEA6
		dd rva word_1002BE9C
		dd rva word_1002BE92
		dd rva word_1002BE88
		dd rva word_1002BE7E
		dd rva word_1002BE74
		dd rva word_1002BE6A
		dd rva word_1002BE60
		dd rva word_1002BE56
		dd rva word_1002BE4C
		dd rva word_1002BE42
		dd rva word_1002BE38
		dd rva word_1002BE2C
		dd rva word_1002BE24
		dd rva word_1002BE1C
		dd rva word_1002BF06
		dd rva word_1002BE08
		dd rva word_1002BE00
		dd rva word_1002BDF6
		dd rva word_1002BDEC
		dd rva word_1002BDE2
		dd rva word_1002BDD8
		dd rva word_1002BDD0
		dd rva word_1002BDC8
		dd rva word_1002BDBE
		dd rva word_1002BDB6
		dd rva word_1002BDAC
		dd rva word_1002BDA2
		dd rva word_1002BF10
		dd rva word_1002BF1C
		dd rva word_1002BF24
		dd rva word_1002BF2E
		dd rva word_1002BF36
		dd rva word_1002BF40
		dd rva word_1002BF4A
		dd rva word_1002BF5A
		dd rva word_1002BF62
		dd rva word_1002BF74
		dd rva word_1002BF88
		dd rva word_1002BF96
		dd rva word_1002BFA2
		dd rva word_1002BE12
		dd rva word_1002C772
		dd rva word_1002C77C
		dd rva word_1002C788
		dd 0
word_1002BC68	dw 1Dh			; DATA XREF: .rdata:off_1002B92Co
		db 'AllocateAndInitializeSid',0
		align 4
word_1002BC84	dw 5Ah			; DATA XREF: .rdata:1002B930o
		db 'CopySid',0
word_1002BC8E	dw 0F6h			; DATA XREF: .rdata:1002B934o
		db 'GetLengthSid',0
		align 2
word_1002BC9E	dw 119h			; DATA XREF: .rdata:1002B938o
		db 'GetTokenInformation',0
word_1002BCB4	dw 1AAh			; DATA XREF: .rdata:1002B93Co
		db 'OpenProcessToken',0
		align 4
word_1002BCC8	dw 0E1h			; DATA XREF: .rdata:1002B940o
		db 'FreeSid',0
word_1002BCD2	dw 231h			; DATA XREF: .rdata:1002B944o
		db 'SetSecurityDescriptorDacl',0
word_1002BCEE	dw 10h			; DATA XREF: .rdata:1002B948o
		db 'AddAccessAllowedAce',0
word_1002BD04	dw 131h			; DATA XREF: .rdata:1002B94Co
		db 'InitializeAcl',0
word_1002BD14	dw 232h			; DATA XREF: .rdata:1002B950o
		db 'SetSecurityDescriptorGroup',0
		align 2
word_1002BD32	dw 233h			; DATA XREF: .rdata:1002B954o
		db 'SetSecurityDescriptorOwner',0
		align 10h
word_1002BD50	dw 132h			; DATA XREF: .rdata:1002B958o
		db 'InitializeSecurityDescriptor',0
		align 10h
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:1002B8C0o
		align 2
aWsock32_dll	db 'WSOCK32.dll',0      ; DATA XREF: .rdata:1002B8D4o
word_1002BD8A	dw 0A3h			; DATA XREF: .rdata:off_1002BAFCo
		db 'timeGetTime',0
aWinmm_dll	db 'WINMM.dll',0        ; DATA XREF: .rdata:1002B8E8o
word_1002BDA2	dw 156h			; DATA XREF: .rdata:1002BC1Co
		db '_errno',0
		align 4
word_1002BDAC	dw 4EEh			; DATA XREF: .rdata:1002BC18o
		db 'memset',0
		align 2
word_1002BDB6	dw 480h			; DATA XREF: .rdata:1002BC14o
		db 'atoi',0
		align 2
word_1002BDBE	dw 49Fh			; DATA XREF: .rdata:1002BC10o
		db 'fprintf',0
word_1002BDC8	dw 1DBh			; DATA XREF: .rdata:1002BC0Co
		db '_iob',0
		align 10h
word_1002BDD0	dw 48Fh			; DATA XREF: .rdata:1002BC08o
		db 'exit',0
		align 4
word_1002BDD8	dw 4EAh			; DATA XREF: .rdata:1002BC04o
		db 'memcpy',0
		align 2
word_1002BDE2	dw 50Fh			; DATA XREF: .rdata:1002BC00o
		db 'sscanf',0
		align 4
word_1002BDEC	dw 492h			; DATA XREF: .rdata:1002BBFCo
		db 'fclose',0
		align 2
word_1002BDF6	dw 507h			; DATA XREF: .rdata:1002BBF8o
		db 'setvbuf',0
word_1002BE00	dw 49Dh			; DATA XREF: .rdata:1002BBF4o
		db 'fopen',0
word_1002BE08	dw 495h			; DATA XREF: .rdata:1002BBF0o
		db 'fflush',0
		align 2
word_1002BE12	dw 4B1h			; DATA XREF: .rdata:1002BC54o
		db 'fwrite',0
		align 4
word_1002BE1C	dw 4A6h			; DATA XREF: .rdata:1002BBE8o
		db 'free',0
		align 4
word_1002BE24	dw 476h			; DATA XREF: .rdata:1002BBE4o
		db 'abort',0
word_1002BE2C	dw 32Fh			; DATA XREF: .rdata:1002BBE0o
		db '_snprintf',0
word_1002BE38	dw 4E8h			; DATA XREF: .rdata:1002BBDCo
		db 'memchr',0
		align 2
word_1002BE42	dw 539h			; DATA XREF: .rdata:1002BBD8o
		db 'tolower',0
word_1002BE4C	dw 4C6h			; DATA XREF: .rdata:1002BBD4o
		db 'isspace',0
word_1002BE56	dw 52Ah			; DATA XREF: .rdata:1002BBD0o
		db 'strtol',0
		align 10h
word_1002BE60	dw 52Bh			; DATA XREF: .rdata:1002BBCCo
		db 'strtoul',0
word_1002BE6A	dw 4C0h			; DATA XREF: .rdata:1002BBC8o
		db 'isdigit',0
word_1002BE74	dw 513h			; DATA XREF: .rdata:1002BBC4o
		db 'strchr',0
		align 2
word_1002BE7E	dw 4B6h			; DATA XREF: .rdata:1002BBC0o
		db 'getenv',0
		align 4
word_1002BE88	dw 526h			; DATA XREF: .rdata:1002BBBCo
		db 'strstr',0
		align 2
word_1002BE92	dw 524h			; DATA XREF: .rdata:1002BBB8o
		db 'strrchr',0
word_1002BE9C	dw 4DEh			; DATA XREF: .rdata:1002BBB4o
		db 'malloc',0
		align 2
word_1002BEA6	dw 485h			; DATA XREF: .rdata:1002BBB0o
		db 'calloc',0
		align 10h
word_1002BEB0	dw 4FFh			; DATA XREF: .rdata:1002BBACo
		db 'realloc',0
word_1002BEBA	dw 519h			; DATA XREF: .rdata:1002BBA8o
		db 'strerror',0
		align 2
word_1002BEC6	dw 51Fh			; DATA XREF: .rdata:1002BBA4o
		db 'strncmp',0
word_1002BED0	dw 4DAh			; DATA XREF: .rdata:1002BBA0o
		db 'localtime',0
word_1002BEDC	dw 51Bh			; DATA XREF: .rdata:1002BB9Co
		db 'strftime',0
		align 4
word_1002BEE8	dw 4EFh			; DATA XREF: .rdata:1002BB98o
		db 'mktime',0
		align 2
word_1002BEF2	dw 4BEh			; DATA XREF: .rdata:1002BB94o
		db 'isalpha',0
word_1002BEFC	dw 4ECh			; DATA XREF: .rdata:off_1002BB90o
		db 'memmove',0
word_1002BF06	dw 523h			; DATA XREF: .rdata:1002BBECo
		db 'strpbrk',0
word_1002BF10	dw 35Eh			; DATA XREF: .rdata:1002BC20o
		db '_stricmp',0
		align 4
word_1002BF1C	dw 4FAh			; DATA XREF: .rdata:1002BC24o
		db 'qsort',0
word_1002BF24	dw 284h			; DATA XREF: .rdata:1002BC28o
		db '_mbsinc',0
word_1002BF2E	dw 352h			; DATA XREF: .rdata:1002BC2Co
		db '_stat',0
word_1002BF36	dw 27Dh			; DATA XREF: .rdata:1002BC30o
		db '_mbsdec',0
word_1002BF40	dw 0E5h			; DATA XREF: .rdata:1002BC34o
		db '_access',0
word_1002BF4A	dw 153h			; DATA XREF: .rdata:1002BC38o
		db '_endthreadex',0
		align 2
word_1002BF5A	dw 162h			; DATA XREF: .rdata:1002BC3Co
		db '_exit',0
word_1002BF62	dw 10Fh			; DATA XREF: .rdata:1002BC40o
		db '_beginthreadex',0
		align 4
word_1002BF74	dw 534h			; DATA XREF: .rdata:1002BC44o
		db 'time',0
		align 4
aMsvcrt_dll	db 'msvcrt.dll',0       ; DATA XREF: .rdata:1002B8FCo
		align 4
word_1002BF88	dw 6Ah			; DATA XREF: .rdata:1002BC48o
		db '_XcptFilter',0
word_1002BF96	dw 1D5h			; DATA XREF: .rdata:1002BC4Co
		db '_initterm',0
word_1002BFA2	dw 101h			; DATA XREF: .rdata:1002BC50o
		db '_amsg_exit',0
		align 10h
word_1002BFB0	dw 21Bh			; DATA XREF: .rdata:1002BAF4o
		db 'InterlockedCompareExchange',0
		align 2
word_1002BFCE	dw 243h			; DATA XREF: .rdata:1002BAF0o
		db 'LeaveCriticalSection',0
		align 2
word_1002BFE6	dw 96h			; DATA XREF: .rdata:1002BAECo
		db 'EnterCriticalSection',0
		align 2
word_1002BFFE	dw 218h			; DATA XREF: .rdata:1002BAE8o
		db 'InitializeCriticalSection',0
word_1002C01A	dw 7Fh			; DATA XREF: .rdata:1002BAE4o
		db 'DeleteCriticalSection',0
word_1002C032	dw 2A6h			; DATA XREF: .rdata:1002BAE0o
		db 'ReadFile',0
		align 2
word_1002C03E	dw 168h			; DATA XREF: .rdata:1002BADCo
		db 'GetLastError',0
		align 2
word_1002C04E	dw 27Eh			; DATA XREF: .rdata:1002BAD8o
		db 'OutputDebugStringA',0
		align 4
word_1002C064	dw 352h			; DATA XREF: .rdata:1002BAD4o
		db 'TlsSetValue',0
word_1002C072	dw 351h			; DATA XREF: .rdata:1002BAD0o
		db 'TlsGetValue',0
word_1002C080	dw 76h			; DATA XREF: .rdata:1002BACCo
		db 'DebugBreak',0
		align 2
word_1002C08E	dw 382h			; DATA XREF: .rdata:1002BAC8o
		db 'WideCharToMultiByte',0
word_1002C0A4	dw 176h			; DATA XREF: .rdata:1002BAC4o
		db 'GetModuleHandleA',0
		align 4
word_1002C0B8	dw 246h			; DATA XREF: .rdata:1002BAC0o
		db 'LoadLibraryExW',0
		align 2
word_1002C0CA	dw 267h			; DATA XREF: .rdata:1002BABCo
		db 'MultiByteToWideChar',0
word_1002C0E0	dw 0F0h			; DATA XREF: .rdata:1002BAB8o
		db 'FreeLibrary',0
word_1002C0EE	dw 198h			; DATA XREF: .rdata:1002BAB4o
		db 'GetProcAddress',0
		align 10h
word_1002C100	dw 175h			; DATA XREF: .rdata:1002BAB0o
		db 'GetModuleFileNameW',0
		align 2
word_1002C116	dw 179h			; DATA XREF: .rdata:1002BAACo
		db 'GetModuleHandleW',0
		align 2
word_1002C12A	dw 1BBh			; DATA XREF: .rdata:1002BAA8o
		db 'GetSystemInfo',0
word_1002C13A	dw 21Dh			; DATA XREF: .rdata:1002BAA4o
		db 'InterlockedExchange',0
word_1002C150	dw 1FAh			; DATA XREF: .rdata:1002BAA0o
		db 'GlobalMemoryStatusEx',0
		align 4
word_1002C168	dw 31h			; DATA XREF: .rdata:1002BA9Co
		db 'CloseHandle',0
word_1002C176	dw 61h			; DATA XREF: .rdata:1002BA98o
		db 'CreatePipe',0
		align 4
word_1002C184	dw 1B0h			; DATA XREF: .rdata:1002BA94o
		db 'GetStdHandle',0
		align 4
word_1002C194	dw 357h			; DATA XREF: .rdata:1002BA90o
		db 'TryEnterCriticalSection',0
word_1002C1AE	dw 347h			; DATA XREF: .rdata:1002BA8Co
		db 'SystemTimeToFileTime',0
		align 2
word_1002C1C6	dw 1BEh			; DATA XREF: .rdata:1002BA88o
		db 'GetSystemTime',0
word_1002C1D6	dw 0EEh			; DATA XREF: .rdata:1002BA84o
		db 'FreeEnvironmentStringsA',0
word_1002C1F0	dw 14Dh			; DATA XREF: .rdata:1002BA80o
		db 'GetEnvironmentStrings',0
word_1002C208	dw 62h			; DATA XREF: .rdata:1002BA7Co
		db 'CreateProcessA',0
		align 2
word_1002C21A	dw 152h			; DATA XREF: .rdata:1002BA78o
		db 'GetExitCodeProcess',0
		align 10h
word_1002C230	dw 37Eh			; DATA XREF: .rdata:1002BA74o
		db 'WaitForSingleObject',0
word_1002C246	dw 34Ah			; DATA XREF: .rdata:1002BA70o
		db 'TerminateProcess',0
		align 2
word_1002C25A	dw 1DEh			; DATA XREF: .rdata:1002BA6Co
		db 'GetVersionExA',0
word_1002C26A	dw 50h			; DATA XREF: .rdata:1002BA68o
		db 'CreateFileMappingA',0
		align 10h
word_1002C280	dw 0EBh			; DATA XREF: .rdata:1002BA64o
		db 'FormatMessageA',0
		align 2
word_1002C292	dw 25Ah			; DATA XREF: .rdata:1002BA60o
		db 'MapViewOfFile',0
word_1002C2A2	dw 35Eh			; DATA XREF: .rdata:1002BA5Co
		db 'UnmapViewOfFile',0
word_1002C2B4	dw 0E6h			; DATA XREF: .rdata:1002BA58o
		db 'FlushFileBuffers',0
		align 4
word_1002C2C8	dw 0E8h			; DATA XREF: .rdata:1002BA54o
		db 'FlushViewOfFile',0
word_1002C2DA	dw 13Bh			; DATA XREF: .rdata:1002BA50o
		db 'GetCurrentProcess',0
word_1002C2EE	dw 68h			; DATA XREF: .rdata:1002BA4Co
		db 'CreateSemaphoreA',0
		align 2
word_1002C302	dw 2B4h			; DATA XREF: .rdata:1002BA48o
		db 'ReleaseSemaphore',0
		align 2
word_1002C316	dw 1CDh			; DATA XREF: .rdata:1002BA44o
		db 'GetThreadContext',0
		align 2
word_1002C32A	dw 1ABh			; DATA XREF: .rdata:1002BA40o
		db 'GetQueuedCompletionStatus',0
word_1002C346	dw 80h			; DATA XREF: .rdata:1002BA3Co
		db 'DeleteFiber',0
word_1002C354	dw 283h			; DATA XREF: .rdata:1002BA38o
		db 'PostQueuedCompletionStatus',0
		align 2
word_1002C372	dw 55h			; DATA XREF: .rdata:1002BA34o
		db 'CreateIoCompletionPort',0
		align 4
word_1002C38C	dw 2BFh			; DATA XREF: .rdata:1002BA30o
		db 'ResetEvent',0
		align 2
word_1002C39A	dw 18Ch			; DATA XREF: .rdata:1002BA2Co
		db 'GetOverlappedResult',0
word_1002C3B0	dw 37Ch			; DATA XREF: .rdata:1002BA28o
		db 'WaitForMultipleObjects',0
		align 2
word_1002C3CA	dw 38Fh			; DATA XREF: .rdata:1002BA24o
		db 'WriteFile',0
word_1002C3D6	dw 309h			; DATA XREF: .rdata:1002BA20o
		db 'SetFilePointer',0
		align 4
word_1002C3E8	dw 4Fh			; DATA XREF: .rdata:1002BA1Co
		db 'CreateFileA',0
word_1002C3F6	dw 313h			; DATA XREF: .rdata:1002BA18o
		db 'SetHandleInformation',0
		align 2
word_1002C40E	dw 166h			; DATA XREF: .rdata:1002BA14o
		db 'GetHandleInformation',0
		align 2
word_1002C426	dw 0CCh			; DATA XREF: .rdata:1002BA10o
		db 'FindClose',0
word_1002C432	dw 0D0h			; DATA XREF: .rdata:1002BA0Co
		db 'FindFirstFileA',0
		align 4
word_1002C444	dw 0D9h			; DATA XREF: .rdata:1002BA08o
		db 'FindNextFileA',0
word_1002C454	dw 81h			; DATA XREF: .rdata:1002BA04o
		db 'DeleteFileA',0
word_1002C462	dw 157h			; DATA XREF: .rdata:1002BA00o
		db 'GetFileAttributesExA',0
		align 2
word_1002C47A	dw 15Ah			; DATA XREF: .rdata:1002B9FCo
		db 'GetFileInformationByHandle',0
		align 4
word_1002C498	dw 260h			; DATA XREF: .rdata:1002B9F8o
		db 'MoveFileA',0
word_1002C4A4	dw 47h			; DATA XREF: .rdata:1002B9F4o
		db 'CreateDirectoryA',0
		align 4
word_1002C4B8	dw 2B5h			; DATA XREF: .rdata:1002B9F0o
		db 'RemoveDirectoryA',0
		align 4
word_1002C4CC	dw 256h			; DATA XREF: .rdata:1002B9ECo
		db 'LockFileEx',0
		align 2
word_1002C4DA	dw 35Dh			; DATA XREF: .rdata:1002B9E8o
		db 'UnlockFileEx',0
		align 2
word_1002C4EA	dw 3B7h			; DATA XREF: .rdata:1002B9E4o
		db 'lstrlenA',0
		align 2
word_1002C4F6	dw 1E0h			; DATA XREF: .rdata:1002B9E0o
		db 'GetVolumeInformationA',0
word_1002C50E	dw 14Bh			; DATA XREF: .rdata:1002B9DCo
		db 'GetDriveTypeA',0
word_1002C51E	dw 303h			; DATA XREF: .rdata:1002B9D8o
		db 'SetErrorMode',0
		align 2
word_1002C52E	dw 16Dh			; DATA XREF: .rdata:1002B9D4o
		db 'GetLogicalDriveStringsA',0
word_1002C548	dw 27h			; DATA XREF: .rdata:1002B9D0o
		db 'CancelIo',0
		align 4
word_1002C554	dw 342h			; DATA XREF: .rdata:1002B9CCo
		db 'Sleep',0
word_1002C55C	dw 34Fh			; DATA XREF: .rdata:1002B9C8o
		db 'TlsAlloc',0
		align 4
word_1002C568	dw 350h			; DATA XREF: .rdata:1002B9C4o
		db 'TlsFree',0
word_1002C572	dw 4Bh			; DATA XREF: .rdata:1002B9C0o
		db 'CreateEventA',0
		align 2
word_1002C582	dw 91h			; DATA XREF: .rdata:1002B9BCo
		db 'DuplicateHandle',0
word_1002C594	dw 13Dh			; DATA XREF: .rdata:1002B9B8o
		db 'GetCurrentThread',0
		align 4
word_1002C5A8	dw 331h			; DATA XREF: .rdata:1002B9B4o
		db 'SetThreadPriority',0
word_1002C5BC	dw 299h			; DATA XREF: .rdata:1002B9B0o
		db 'RaiseException',0
		align 2
word_1002C5CE	dw 22Dh			; DATA XREF: .rdata:1002B9ACo
		db 'IsDebuggerPresent',0
word_1002C5E2	dw 3Eh			; DATA XREF: .rdata:1002B9A8o
		db 'ConvertThreadToFiber',0
		align 2
word_1002C5FA	dw 32Ch			; DATA XREF: .rdata:1002B9A4o
		db 'SetThreadAffinityMask',0
word_1002C612	dw 199h			; DATA XREF: .rdata:1002B9A0o
		db 'GetProcessAffinityMask',0
		align 4
word_1002C62C	dw 344h			; DATA XREF: .rdata:1002B99Co
		db 'SuspendThread',0
word_1002C63C	dw 2C2h			; DATA XREF: .rdata:1002B998o
		db 'ResumeThread',0
		align 4
word_1002C64C	dw 4Dh			; DATA XREF: .rdata:1002B994o
		db 'CreateFiber',0
word_1002C65A	dw 345h			; DATA XREF: .rdata:1002B990o
		db 'SwitchToFiber',0
word_1002C66A	dw 316h			; DATA XREF: .rdata:1002B98Co
		db 'SetLastError',0
		align 2
word_1002C67A	dw 279h			; DATA XREF: .rdata:1002B988o
		db 'OpenSemaphoreA',0
		align 4
word_1002C68C	dw 294h			; DATA XREF: .rdata:1002B984o
		db 'QueryPerformanceCounter',0
word_1002C6A6	dw 1D4h			; DATA XREF: .rdata:1002B980o
		db 'GetTickCount',0
		align 2
word_1002C6B6	dw 271h			; DATA XREF: .rdata:1002B97Co
		db 'OpenFileMappingA',0
		align 2
word_1002C6CA	dw 2C7h			; DATA XREF: .rdata:1002B978o
		db 'RtlUnwind',0
word_1002C6D6	dw 35Bh			; DATA XREF: .rdata:1002B974o
		db 'UnhandledExceptionFilter',0
		align 2
word_1002C6F2	dw 336h			; DATA XREF: .rdata:1002B970o
		db 'SetUnhandledExceptionFilter',0
word_1002C710	dw 1DDh			; DATA XREF: .rdata:1002B96Co
		db 'GetVersion',0
		align 2
word_1002C71E	dw 13Eh			; DATA XREF: .rdata:1002B968o
		db 'GetCurrentThreadId',0
		align 4
word_1002C734	dw 13Ch			; DATA XREF: .rdata:1002B964o
		db 'GetCurrentProcessId',0
word_1002C74A	dw 1C0h			; DATA XREF: .rdata:off_1002B960o
		db 'GetSystemTimeAsFileTime',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:1002B910o
		align 2
word_1002C772	dw 35Ah			; DATA XREF: .rdata:1002BC58o
		db '_strdup',0
word_1002C77C	dw 356h			; DATA XREF: .rdata:1002BC5Co
		db '_strcmpi',0
		align 4
word_1002C788	dw 2FEh			; DATA XREF: .rdata:1002BC60o
		db '_putenv',0
		align 10h
;
; Export directory for libnspr4.dll
;
		dd 0			; Characteristics
		dd 54275DEDh		; TimeDateStamp: Sun Sep 28 01:01:33 2014
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd rva aLibnspr4_dll	; Name
		dd 1			; Base
		dd 19Bh			; NumberOfFunctions
		dd 19Bh			; NumberOfNames
		dd rva off_1002C7C8	; AddressOfFunctions
		dd rva off_1002CE34	; AddressOfNames
		dd rva word_1002D4A0	; AddressOfNameOrdinals
;
; Export Address Table for libnspr4.dll
;
off_1002C7C8	dd rva GetExecutionEnvironment,	rva LL_MaxInt, rva LL_MaxUint
					; DATA XREF: .rdata:1002C7BCo
		dd rva LL_MinInt, rva LL_Zero, rva PR_DestroyCondVar, rva PRP_NakedBroadcast
		dd rva PRP_NakedNotify,	rva PRP_NakedWait, rva PRP_NewNakedCondVar
		dd rva PRP_TryLock, rva	PR_Abort, rva PR_Accept, rva PR_AcceptRead
		dd rva PR_Access, rva PR_AddToCounter, rva PR_AddWaitFileDesc
		dd rva PR_AllocFileDesc, rva PR_Assert,	rva PT_FPrintStats
		dd rva PR_AssertCurrentThreadOwnsLock, rva PR_AtomicAdd
		dd rva PR_AtomicDecrement, rva PR_AtomicIncrement, rva PR_AtomicSet
		dd rva PR_AttachSharedMemory, rva PR_AttachThread, rva PR_GetInheritedFileMap
		dd rva PR_Available, rva PR_Available64, rva PR_Bind, rva PT_FPrintStats
		dd rva PR_BlockInterrupt, rva PR_CEnterMonitor,	rva PR_CExitMonitor
		dd rva PR_CNotify, rva PR_CNotifyAll, rva PR_CSetOnMonitorRecycle
		dd rva PR_CWait, rva PR_CallOnce, rva PR_CallOnceWithArg
		dd rva PR_Calloc, rva PR_CancelJob, rva	PR_CancelWaitFileDesc
		dd rva PR_CancelWaitGroup, rva PR_CeilingLog2, rva PR_ChangeFileDescNativeHandle
		dd rva PR_Cleanup, rva PR_ClearInterrupt, rva PR_ClearThreadGCAble
		dd rva PR_Close, rva PR_CloseDir, rva PR_CloseFileMap
		dd rva PR_CloseSemaphore, rva PR_CloseSharedMemory, rva	PR_Connect
		dd rva PR_ConnectContinue, rva PR_ConvertIPv4AddrToIPv6
		dd rva PR_CreateAlarm, rva PR_CreateCounter, rva PR_CreateFileMap
		dd rva PR_CreateIOLayer, rva PR_CreateIOLayerStub, rva PR_CreateMWaitEnumerator
		dd rva PR_GetInheritedFileMap, rva PR_CreatePipe, rva PR_CreateProcess
		dd rva PR_CreateProcessDetached, rva PR_CreateSocketPollFd
		dd rva PR_CreateStack, rva PR_CreateThread, rva	PR_CreateThreadGCAble
		dd rva PR_CreateThreadPool, rva	PR_CreateTrace,	rva PR_CreateWaitGroup
		dd rva PR_DecrementCounter, rva	PR_Delete, rva PR_DeleteSemaphore
		dd rva PR_DeleteSharedMemory, rva PR_DestroyAlarm, rva PR_DestroyCondVar
		dd rva PR_DestroyCounter, rva PR_DestroyLock, rva PR_DestroyMWaitEnumerator
		dd rva PR_DestroyMonitor, rva PR_LockOrderedLock, rva PR_DestroyPollableEvent
		dd rva PR_DestroyProcessAttr, rva PR_DestroyRWLock, rva	PR_DestroySem
		dd rva PR_DestroySocketPollFd, rva PR_DestroyStack, rva	PR_DestroyTrace
		dd rva PR_DestroyWaitGroup, rva	PR_DetachProcess, rva PR_DetachSharedMemory
		dd rva PT_FPrintStats, rva PR_EnableClockInterrupts, rva PR_EmulateAcceptRead
		dd rva PR_EmulateSendFile, rva PR_EnableClockInterrupts
		dd rva PR_EnterMonitor,	rva PR_EnumerateAddrInfo, rva PR_EnumerateHostEnt
		dd rva PR_EnumerateThreads, rva	PR_EnumerateWaitGroup
		dd rva PR_ErrorInstallCallback,	rva PR_ErrorInstallTable
		dd rva PR_ErrorLanguages, rva PR_ErrorToName, rva PR_ErrorToString
		dd rva PR_ExitMonitor, rva PR_ExplodeTime, rva PR_ExportFileMapAsString
		dd rva PR_FD_CLR, rva PR_FD_ISSET, rva PR_FD_NCLR, rva PR_FD_NISSET
		dd rva PR_FD_NSET, rva PR_FD_SET, rva PR_FD_ZERO, rva PR_FileDesc2NativeHandle
		dd rva PR_FindSymbol, rva PR_FindFunctionSymbolAndLibrary
		dd rva PR_FindNextCounterQname,	rva PR_FindNextCounterRname
		dd rva PR_FindNextTraceQname, rva PR_FindNextTraceRname
		dd rva PR_FindSymbol, rva PR_FindSymbolAndLibrary, rva PR_FloorLog2
		dd rva PR_FormatTime, rva PR_FormatTimeUSEnglish, rva PR_Free
		dd rva PR_FreeAddrInfo,	rva PR_FreeFileDesc, rva PR_FreeLibraryName
		dd rva PR_GMTParameters, rva PR_GetAddrInfoByName, rva PR_GetCanonNameFromAddrInfo
		dd rva PR_GetConnectStatus, rva	PR_GetCounter, rva PR_GetCounterHandleFromName
		dd rva PR_GetCounterNameFromHandle, rva	PR_GetCurrentThread
		dd rva PR_GetDefaultIOMethods, rva PR_GetDescType, 2 dup(rva PR_GetDirectorySepartor)
		dd rva PR_GetEnv, rva PR_GetError, rva PR_GetErrorText
		dd rva PR_GetErrorTextLength, rva PR_GetFileInfo, rva PR_GetFileInfo64
		dd rva PR_GetFileMethods, rva PR_GetGCRegisters, rva PR_GetHostByAddr
		dd rva PR_GetHostByName, rva PR_GetIPNodeByName, rva PR_GetIdentitiesLayer
		dd rva PR_GetInheritedFD, rva PR_GetInheritedFileMap, rva PR_GetLayersIdentity
		dd rva PR_GetLibraryFilePathname, rva PR_GetLibraryName
		dd rva PR_GetLibraryPath, rva PR_GetMemMapAlignment, rva PR_GetMonitorEntryCount
		dd rva PR_GetNameForIdentity, rva PR_GetNumberOfProcessors
		dd rva PR_GetOSError, rva PR_GetOpenFileInfo, rva PR_GetOpenFileInfo64
		dd rva PR_GetPageShift,	rva PR_GetPageSize, rva	PR_GetPathSeparator
		dd rva PR_GetPeerName, rva PR_GetPhysicalMemorySize, rva PR_GetPipeMethods
		dd rva PR_GetProtoByName, rva PR_GetProtoByNumber, rva PR_GetRandomNoise
		dd rva PR_GetSP, rva PR_GetSockName, rva PR_GetSocketOption
		dd rva PR_GetSpecialFD,	rva PR_GetStackSpaceLeft, rva PR_GetSysfdTableMax
		dd rva PR_GetSystemInfo, rva PR_GetTCPMethods, rva PR_GetThreadAffinityMask
		dd rva PR_GetThreadID, rva PR_GetThreadName, rva PR_GetThreadPriority
		dd rva PR_GetThreadPrivate, rva	PR_GetThreadScope, rva PR_GetThreadState
		dd rva PR_GetThreadType, rva PR_GetTraceEntries, rva PR_GetTraceHandleFromName
		dd rva PR_GetTraceNameFromHandle, rva PR_GetTraceOption
		dd rva PR_GetUDPMethods, rva PR_GetUniqueIdentity, rva PR_GetVersion
		dd rva PR_ImplodeTime, rva PR_ImportFile, rva PR_ImportFileMapFromString
		dd rva PR_ImportPipe, rva PR_ImportTCPSocket, rva PR_ImportUDPSocket
		dd rva PR_IncrementCounter, rva	PR_Init, rva PR_Initialize
		dd rva PR_InitializeNetAddr, rva PR_Initialized, rva PR_Interrupt
		dd rva PR_IntervalNow, rva PR_IntervalToMicroseconds, rva PR_IntervalToMilliseconds
		dd rva PR_IntervalToSeconds, rva PR_IsNetAddrType, rva PR_JoinJob
		dd rva PR_JoinThread, rva PR_JoinThreadPool, rva PR_KillProcess
		dd rva PR_Listen, rva PR_LoadLibrary, rva PR_LoadLibraryWithFlags
		dd rva PR_LoadStaticLibrary, rva PR_LocalTimeParameters
		dd rva PR_Lock,	rva PR_LockFile, rva PR_LockOrderedLock
		dd rva PR_LogFlush, rva	PR_LogPrint, rva PR_MakeDir, rva PR_Malloc
		dd rva PR_MemMap, rva PR_MemUnmap, rva PR_MicrosecondsToInterval
		dd rva PR_MillisecondsToInterval, rva PR_MkDir,	rva PR_NTFast_Accept
		dd rva PR_NTFast_AcceptRead, rva PR_NTFast_AcceptRead_WithTimeoutCallback
		dd rva PR_NTFast_UpdateAcceptContext, rva PR_NT_CancelIo
		dd rva PR_NetAddrToString, rva PR_NewCondVar, rva PR_NewLock
		dd rva PR_NewLogModule,	rva PR_NewMonitor, rva PR_NewNamedMonitor
		dd rva PR_NewPollableEvent, rva	PR_NewProcessAttr, rva PR_NewRWLock
		dd rva PR_NewSem, rva PR_NewTCPSocket, rva PR_NewTCPSocketPair
		dd rva PR_NewThreadPrivateIndex, rva PR_NewUDPSocket, rva PR_NormalizeTime
		dd rva PR_Notify, rva PR_NotifyAll, rva	PR_NotifyAllCondVar
		dd rva PR_NotifyCondVar, rva PR_Now, rva PR_Open, rva PR_OpenAnonFileMap
		dd rva PR_OpenDir, rva PR_OpenFile, rva	PR_OpenSemaphore
		dd rva PR_OpenSharedMemory, rva	PR_OpenTCPSocket, rva PR_OpenUDPSocket
		dd rva PR_ParseTimeString, rva PR_ParseTimeStringToExplodedTime
		dd rva PR_Poll,	rva PR_PopIOLayer, rva PR_PostSem, rva PR_PostSemaphore
		dd rva PR_ProcessAttrSetCurrentDirectory, rva PR_ProcessAttrSetInheritableFD
		dd rva PR_UnlockOrderedLock, rva PR_SetStdioRedirect, rva PR_ProcessExit
		dd rva PR_PushIOLayer, rva PR_QueueJob,	rva PR_QueueJob_Accept
		dd rva PR_QueueJob_Connect, rva	PR_QueueJob_Read, rva PR_QueueJob_Timer
		dd rva PR_QueueJob_Write, rva PR_RWLock_Rlock, rva PR_RWLock_Unlock
		dd rva PR_RWLock_Wlock,	rva PR_Read, rva PR_ReadDir, rva PR_Realloc
		dd rva PR_RecordTraceEntries, rva PR_Recv, rva PR_RecvFrom
		dd rva PR_Rename, rva PR_ResetAlarm, rva PR_ResetProcessAttr
		dd rva PR_ResumeAll, rva PR_RmDir, rva PR_ScanStackPointers
		dd rva PR_SecondsToInterval, rva PR_Seek, rva PR_Seek64
		dd rva PR_Select, rva PR_Send, rva PR_SendFile,	rva PR_SendTo
		dd rva PR_SetAlarm, rva	PR_SetCPUAffinityMask, rva PR_SetConcurrency
		dd rva PR_SetCounter, rva PR_SetCurrentThreadName, rva PR_SetEnv
		dd rva PR_SetError, rva	PR_SetErrorText, rva PR_SetFDCacheSize
		dd rva PR_SetFDInheritable, rva	PR_SetLibraryPath, rva PR_SetLogBuffering
		dd rva PR_SetLogFile, rva PR_SetNetAddr, rva PR_SetPollableEvent
		dd rva PR_SetSocketOption, rva PR_SetStdioRedirect, rva	PR_UnlockOrderedLock
		dd rva PR_SetThreadAffinityMask, rva PR_SetThreadDumpProc
		dd rva PR_SetThreadGCAble, rva PR_SetThreadPriority, rva PR_SetThreadPrivate
		dd rva PR_SetThreadRecycleMode,	rva PR_SetTraceOption
		dd rva PR_ShowStatus, rva PR_Shutdown, rva PR_ShutdownThreadPool
		dd rva PR_Sleep, rva PR_Socket,	rva PR_StackPop, rva PR_StackPush
		dd rva PR_Stat,	rva PR_StringToNetAddr,	rva PR_SubtractFromCounter
		dd rva PR_SuspendAll, rva PR_Sync, rva PR_SyncMemMap, rva PR_TLockFile
		dd rva PR_TestAndEnterMonitor, rva PR_TestAndLock, rva PR_ThreadScanStackPointers
		dd rva PR_TicksPerSecond, rva PR_Trace,	rva PR_TransmitFile
		dd rva PR_USPacificTimeParameters, rva PT_FPrintStats
		dd rva PR_UnblockInterrupt, rva	PR_UnloadLibrary, rva PR_Unlock
		dd rva PR_UnlockFile, rva PR_UnlockOrderedLock,	rva PR_VersionCheck
		dd rva PR_Wait,	rva PR_WaitCondVar, rva	PR_WaitForPollableEvent
		dd rva PR_WaitProcess, rva PR_WaitRecvReady, rva PR_WaitSem
		dd rva PR_WaitSemaphore, rva PR_Write, rva PR_Writev, rva PR_Yield
		dd rva PR_cnvtf, rva PR_dtoa, rva PR_fprintf, rva PR_htonl
		dd rva PR_htonll, rva PR_htons,	rva PR_ntohl, rva PR_ntohll
		dd rva PR_ntohs, rva PR_smprintf, rva PR_smprintf_free
		dd rva PR_snprintf, rva	PR_sprintf_append, rva PR_sscanf
		dd rva PR_strtod, rva PR_sxprintf, rva PR_vfprintf, rva	PR_vsmprintf
		dd rva PR_vsnprintf, rva PR_vsprintf_append, rva PR_vsxprintf
		dd rva PT_FPrintStats, rva SetExecutionEnvironment, rva	_PR_AddSleepQ
		dd rva _PR_CreateThread, rva _PR_DelSleepQ, rva	_PR_GetPrimordialCPU
		dd rva _PR_NativeCreateThread, rva _pr_push_ipv6toipv4_layer
		dd rva _pr_test_ipv6_socket, rva libVersionPoint
;
; Export Names Table for libnspr4.dll
;
off_1002CE34	dd rva aGetexecutionen,	rva aLl_maxint,	rva aLl_maxuint
					; DATA XREF: .rdata:1002C7C0o
		dd rva aLl_minint, rva aLl_zero, rva aPrp_destroynak, rva aPrp_nakedbroad ; "GetExecutionEnvironment"
		dd rva aPrp_nakednotif,	rva aPrp_nakedwait, rva	aPrp_newnakedco
		dd rva aPrp_trylock, rva aPr_abort, rva	aPr_accept, rva	aPr_acceptread
		dd rva aPr_access, rva aPr_addtocounte,	rva aPr_addwaitfile
		dd rva aPr_allocfilede,	rva aPr_assert,	rva aPr_assertcurre
		dd rva aPr_assertcur_0,	rva aPr_atomicadd, rva aPr_atomicdecre
		dd rva aPr_atomicincre,	rva aPr_atomicset, rva aPr_attachshare
		dd rva aPr_attachthrea,	rva aPr_attachthr_0, rva aPr_available
		dd rva aPr_available64,	rva aPr_bind, rva aPr_blockclocki
		dd rva aPr_blockinterr,	rva aPr_centermonit, rva aPr_cexitmonito
		dd rva aPr_cnotify, rva	aPr_cnotifyall,	rva aPr_csetonmonit
		dd rva aPr_cwait, rva aPr_callonce, rva	aPr_calloncewit
		dd rva aPr_calloc, rva aPr_canceljob, rva aPr_cancelwaitf
		dd rva aPr_cancelwaitg,	rva aPr_ceilinglog2, rva aPr_changefiled
		dd rva aPr_cleanup, rva	aPr_clearinterr, rva aPr_clearthread
		dd rva aPr_close, rva aPr_closedir, rva	aPr_closefilema
		dd rva aPr_closesemaph,	rva aPr_closeshared, rva aPr_connect
		dd rva aPr_connectcont,	rva aPr_convertipv4, rva aPr_createalarm
		dd rva aPr_createcount,	rva aPr_createfilem, rva aPr_createiolay
		dd rva aPr_createiol_0,	rva aPr_createmwait, rva aPr_createorder
		dd rva aPr_createpipe, rva aPr_createproce, rva	aPr_createpro_0
		dd rva aPr_createsocke,	rva aPr_createstack, rva aPr_createthrea
		dd rva aPr_createthr_0,	rva aPr_createthr_1, rva aPr_createtrace
		dd rva aPr_createwaitg,	rva aPr_decrementco, rva aPr_delete
		dd rva aPr_deletesemap,	rva aPr_deleteshare, rva aPr_destroyalar
		dd rva aPr_destroycond,	rva aPr_destroycoun, rva aPr_destroylock
		dd rva aPr_destroymwai,	rva aPr_destroymoni, rva aPr_destroyorde
		dd rva aPr_destroypoll,	rva aPr_destroyproc, rva aPr_destroyrwlo
		dd rva aPr_destroysem, rva aPr_destroysock, rva	aPr_destroystac
		dd rva aPr_destroytrac,	rva aPr_destroywait, rva aPr_detachproce
		dd rva aPr_detachshare,	rva aPr_detachthrea, rva aPr_disablecloc
		dd rva aPr_emulateacce,	rva aPr_emulatesend, rva aPr_enableclock
		dd rva aPr_entermonito,	rva aPr_enumeratead, rva aPr_enumerateho
		dd rva aPr_enumerateth,	rva aPr_enumeratewa, rva aPr_errorinstal
		dd rva aPr_errorinst_0,	rva aPr_errorlangua, rva aPr_errortoname
		dd rva aPr_errortostri,	rva aPr_exitmonitor, rva aPr_explodetime
		dd rva aPr_exportfilem,	rva aPr_fd_clr,	rva aPr_fd_isset
		dd rva aPr_fd_nclr, rva	aPr_fd_nisset, rva aPr_fd_nset
		dd rva aPr_fd_set, rva aPr_fd_zero, rva	aPr_filedesc2na
		dd rva aPr_findfunctio,	rva aPr_findfunct_0, rva aPr_findnextcou
		dd rva aPr_findnextc_0,	rva aPr_findnexttra, rva aPr_findnextt_0
		dd rva aPr_findsymbol, rva aPr_findsymbola, rva	aPr_floorlog2
		dd rva aPr_formattime, rva aPr_formattimeu, rva	aPr_free
		dd rva aPr_freeaddrinf,	rva aPr_freefiledes, rva aPr_freelibrary
		dd rva aPr_gmtparamete,	rva aPr_getaddrinfo, rva aPr_getcanonnam
		dd rva aPr_getconnects,	rva aPr_getcounter, rva	aPr_getcounterh
		dd rva aPr_getcountern,	rva aPr_getcurrentt, rva aPr_getdefaulti
		dd rva aPr_getdesctype,	rva aPr_getdirector, rva aPr_getdirect_0
		dd rva aPr_getenv, rva aPr_geterror, rva aPr_geterrortex
		dd rva aPr_geterrort_0,	rva aPr_getfileinfo, rva aPr_getfilein_0
		dd rva aPr_getfilemeth,	rva aPr_getgcregist, rva aPr_gethostbyad
		dd rva aPr_gethostbyna,	rva aPr_getipnodeby, rva aPr_getidentiti
		dd rva aPr_getinherite,	rva aPr_getinheri_0, rva aPr_getlayersid
		dd rva aPr_getlibraryf,	rva aPr_getlibraryn, rva aPr_getlibraryp
		dd rva aPr_getmemmapal,	rva aPr_getmonitore, rva aPr_getnamefori
		dd rva aPr_getnumberof,	rva aPr_getoserror, rva	aPr_getopenfile
		dd rva aPr_getopenfi_0,	rva aPr_getpageshif, rva aPr_getpagesize
		dd rva aPr_getpathsepa,	rva aPr_getpeername, rva aPr_getphysical
		dd rva aPr_getpipemeth,	rva aPr_getprotobyn, rva aPr_getprotob_0
		dd rva aPr_getrandomno,	rva aPr_getsp, rva aPr_getsockname
		dd rva aPr_getsocketop,	rva aPr_getspecialf, rva aPr_getstackspa
		dd rva aPr_getsysfdtab,	rva aPr_getsystemin, rva aPr_gettcpmetho
		dd rva aPr_getthreadaf,	rva aPr_getthreadid, rva aPr_getthreadna
		dd rva aPr_getthreadpr,	rva aPr_getthread_0, rva aPr_getthreadsc
		dd rva aPr_getthreadst,	rva aPr_getthreadty, rva aPr_gettraceent
		dd rva aPr_gettracehan,	rva aPr_gettracenam, rva aPr_gettraceopt
		dd rva aPr_getudpmetho,	rva aPr_getuniqueid, rva aPr_getversion
		dd rva aPr_implodetime,	rva aPr_importfile, rva	aPr_importfilem
		dd rva aPr_importpipe, rva aPr_importtcpso, rva	aPr_importudpso
		dd rva aPr_incrementco,	rva aPr_init, rva aPr_initialize
		dd rva aPr_initializen,	rva aPr_initialized, rva aPr_interrupt
		dd rva aPr_intervalnow,	rva aPr_intervaltom, rva aPr_intervalt_0
		dd rva aPr_intervaltos,	rva aPr_isnetaddrty, rva aPr_joinjob
		dd rva aPr_jointhread, rva aPr_jointhreadp, rva	aPr_killprocess
		dd rva aPr_listen, rva aPr_loadlibrary,	rva aPr_loadlibra_0
		dd rva aPr_loadstaticl,	rva aPr_localtimepa, rva aPr_lock
		dd rva aPr_lockfile, rva aPr_lockordered, rva aPr_logflush
		dd rva aPr_logprint, rva aPr_makedir, rva aPr_malloc, rva aPr_memmap
		dd rva aPr_memunmap, rva aPr_microsecond, rva aPr_millisecond
		dd rva aPr_mkdir, rva aPr_ntfast_acce, rva aPr_ntfast_ac_0
		dd rva aPr_ntfast_ac_1,	rva aPr_ntfast_upda, rva aPr_nt_cancelio
		dd rva aPr_netaddrtost,	rva aPr_newcondvar, rva	aPr_newlock
		dd rva aPr_newlogmodul,	rva aPr_newmonitor, rva	aPr_newnamedmon
		dd rva aPr_newpollable,	rva aPr_newprocessa, rva aPr_newrwlock
		dd rva aPr_newsem, rva aPr_newtcpsocke,	rva aPr_newtcpsoc_0
		dd rva aPr_newthreadpr,	rva aPr_newudpsocke, rva aPr_normalizeti
		dd rva aPr_notify, rva aPr_notifyall, rva aPr_notifyallco
		dd rva aPr_notifycondv,	rva aPr_now, rva aPr_open, rva aPr_openanonfil
		dd rva aPr_opendir, rva	aPr_openfile, rva aPr_opensemapho
		dd rva aPr_opensharedm,	rva aPr_opentcpsock, rva aPr_openudpsock
		dd rva aPr_parsetimest,	rva aPr_parsetime_0, rva aPr_poll
		dd rva aPr_popiolayer, rva aPr_postsem,	rva aPr_postsemapho
		dd rva aPr_processattr,	rva aPr_processat_0, rva aPr_processat_1
		dd rva aPr_processat_2,	rva aPr_processexit, rva aPr_pushiolayer
		dd rva aPr_queuejob, rva aPr_queuejob_ac, rva aPr_queuejob_co
		dd rva aPr_queuejob_re,	rva aPr_queuejob_ti, rva aPr_queuejob_wr
		dd rva aPr_rwlock_rloc,	rva aPr_rwlock_unlo, rva aPr_rwlock_wloc
		dd rva aPr_read, rva aPr_readdir, rva aPr_realloc, rva aPr_recordtrace
		dd rva aPr_recv, rva aPr_recvfrom, rva aPr_rename, rva aPr_resetalarm
		dd rva aPr_resetproces,	rva aPr_resumeall, rva aPr_rmdir
		dd rva aPr_scanstackpo,	rva aPr_secondstoin, rva aPr_seek
		dd rva aPr_seek64, rva aPr_select, rva aPr_send, rva aPr_sendfile
		dd rva aPr_sendto, rva aPr_setalarm, rva aPr_setcpuaffin
		dd rva aPr_setconcurre,	rva aPr_setcounter, rva	aPr_setcurrentt
		dd rva aPr_setenv, rva aPr_seterror, rva aPr_seterrortex
		dd rva aPr_setfdcaches,	rva aPr_setfdinheri, rva aPr_setlibraryp
		dd rva aPr_setlogbuffe,	rva aPr_setlogfile, rva	aPr_setnetaddr
		dd rva aPr_setpollable,	rva aPr_setsocketop, rva aPr_setstdiored
		dd rva aPr_setsysfdtab,	rva aPr_setthreadaf, rva aPr_setthreaddu
		dd rva aPr_setthreadgc,	rva aPr_setthreadpr, rva aPr_setthread_0
		dd rva aPr_setthreadre,	rva aPr_settraceopt, rva aPr_showstatus
		dd rva aPr_shutdown, rva aPr_shutdownthr, rva aPr_sleep
		dd rva aPr_socket, rva aPr_stackpop, rva aPr_stackpush
		dd rva aPr_stat, rva aPr_stringtonet, rva aPr_subtractfro
		dd rva aPr_suspendall, rva aPr_sync, rva aPr_syncmemmap
		dd rva aPr_tlockfile, rva aPr_testandente, rva aPr_testandlock
		dd rva aPr_threadscans,	rva aPr_tickspersec, rva aPr_trace
		dd rva aPr_transmitfil,	rva aPr_uspacificti, rva aPr_unblockcloc
		dd rva aPr_unblockinte,	rva aPr_unloadlibra, rva aPr_unlock
		dd rva aPr_unlockfile, rva aPr_unlockorder, rva	aPr_versionchec
		dd rva aPr_wait, rva aPr_waitcondvar, rva aPr_waitforpoll
		dd rva aPr_waitprocess,	rva aPr_waitrecvrea, rva aPr_waitsem
		dd rva aPr_waitsemapho,	rva aPr_write, rva aPr_writev
		dd rva aPr_yield, rva aPr_cnvtf, rva aPr_dtoa, rva aPr_fprintf
		dd rva aPr_htonl, rva aPr_htonll, rva aPr_htons, rva aPr_ntohl
		dd rva aPr_ntohll, rva aPr_ntohs, rva aPr_smprintf, rva	aPr_smprintf_fr
		dd rva aPr_snprintf, rva aPr_sprintf_app, rva aPr_sscanf
		dd rva aPr_strtod, rva aPr_sxprintf, rva aPr_vfprintf
		dd rva aPr_vsmprintf, rva aPr_vsnprintf, rva aPr_vsprintf_ap
		dd rva aPr_vsxprintf, rva aPt_fprintstats, rva aSetexecutionen
		dd rva a_pr_addsleepq, rva a_pr_createthre, rva	a_pr_delsleepq
		dd rva a_pr_getprimord,	rva a_pr_nativecrea, rva a_pr_push_ipv6t
		dd rva a_pr_test_ipv6_,	rva aLibversionpoin
;
; Export Ordinals Table	for libnspr4.dll
;
word_1002D4A0	dw 0, 1, 2, 3, 4, 5, 6,	7, 8, 9, 0Ah, 0Bh, 0Ch,	0Dh, 0Eh
					; DATA XREF: .rdata:1002C7C4o
		dw 0Fh,	10h, 11h, 12h, 13h, 14h, 15h, 16h, 17h,	18h, 19h
		dw 1Ah,	1Bh, 1Ch, 1Dh, 1Eh, 1Fh, 20h, 21h, 22h,	23h, 24h
		dw 25h,	26h, 27h, 28h, 29h, 2Ah, 2Bh, 2Ch, 2Dh,	2Eh, 2Fh
		dw 30h,	31h, 32h, 33h, 34h, 35h, 36h, 37h, 38h,	39h, 3Ah
		dw 3Bh,	3Ch, 3Dh, 3Eh, 3Fh, 40h, 41h, 42h, 43h,	44h, 45h
		dw 46h,	47h, 48h, 49h, 4Ah, 4Bh, 4Ch, 4Dh, 4Eh,	4Fh, 50h
		dw 51h,	52h, 53h, 54h, 55h, 56h, 57h, 58h, 59h,	5Ah, 5Bh
		dw 5Ch,	5Dh, 5Eh, 5Fh, 60h, 61h, 62h, 63h, 64h,	65h, 66h
		dw 67h,	68h, 69h, 6Ah, 6Bh, 6Ch, 6Dh, 6Eh, 6Fh,	70h, 71h
		dw 72h,	73h, 74h, 75h, 76h, 77h, 78h, 79h, 7Ah,	7Bh, 7Ch
		dw 7Dh,	7Eh, 7Fh, 80h, 81h, 82h, 83h, 84h, 85h,	86h, 87h
		dw 88h,	89h, 8Ah, 8Bh, 8Ch, 8Dh, 8Eh, 8Fh, 90h,	91h, 92h
		dw 93h,	94h, 95h, 96h, 97h, 98h, 99h, 9Ah, 9Bh,	9Ch, 9Dh
		dw 9Eh,	9Fh, 0A0h, 0A1h, 0A2h, 0A3h, 0A4h, 0A5h, 0A6h
		dw 0A7h, 0A8h, 0A9h, 0AAh, 0ABh, 0ACh, 0ADh, 0AEh, 0AFh
		dw 0B0h, 0B1h, 0B2h, 0B3h, 0B4h, 0B5h, 0B6h, 0B7h, 0B8h
		dw 0B9h, 0BAh, 0BBh, 0BCh, 0BDh, 0BEh, 0BFh, 0C0h, 0C1h
		dw 0C2h, 0C3h, 0C4h, 0C5h, 0C6h, 0C7h, 0C8h, 0C9h, 0CAh
		dw 0CBh, 0CCh, 0CDh, 0CEh, 0CFh, 0D0h, 0D1h, 0D2h, 0D3h
		dw 0D4h, 0D5h, 0D6h, 0D7h, 0D8h, 0D9h, 0DAh, 0DBh, 0DCh
		dw 0DDh, 0DEh, 0DFh, 0E0h, 0E1h, 0E2h, 0E3h, 0E4h, 0E5h
		dw 0E6h, 0E7h, 0E8h, 0E9h, 0EAh, 0EBh, 0ECh, 0EDh, 0EEh
		dw 0EFh, 0F0h, 0F1h, 0F2h, 0F3h, 0F4h, 0F5h, 0F6h, 0F7h
		dw 0F8h, 0F9h, 0FAh, 0FBh, 0FCh, 0FDh, 0FEh, 0FFh, 100h
		dw 101h, 102h, 103h, 104h, 105h, 106h, 107h, 108h, 109h
		dw 10Ah, 10Bh, 10Ch, 10Dh, 10Eh, 10Fh, 110h, 111h, 112h
		dw 113h, 114h, 115h, 116h, 117h, 118h, 119h, 11Ah, 11Bh
		dw 11Ch, 11Dh, 11Eh, 11Fh, 120h, 121h, 122h, 123h, 124h
		dw 125h, 126h, 127h, 128h, 129h, 12Ah, 12Bh, 12Ch, 12Dh
		dw 12Eh, 12Fh, 130h, 131h, 132h, 133h, 134h, 135h, 136h
		dw 137h, 138h, 139h, 13Ah, 13Bh, 13Ch, 13Dh, 13Eh, 13Fh
		dw 140h, 141h, 142h, 143h, 144h, 145h, 146h, 147h, 148h
		dw 149h, 14Ah, 14Bh, 14Ch, 14Dh, 14Eh, 14Fh, 150h, 151h
		dw 152h, 153h, 154h, 155h, 156h, 157h, 158h, 159h, 15Ah
		dw 15Bh, 15Ch, 15Dh, 15Eh, 15Fh, 160h, 161h, 162h, 163h
		dw 164h, 165h, 166h, 167h, 168h, 169h, 16Ah, 16Bh, 16Ch
		dw 16Dh, 16Eh, 16Fh, 170h, 171h, 172h, 173h, 174h, 175h
		dw 176h, 177h, 178h, 179h, 17Ah, 17Bh, 17Ch, 17Dh, 17Eh
		dw 17Fh, 180h, 181h, 182h, 183h, 184h, 185h, 186h, 187h
		dw 188h, 189h, 18Ah, 18Bh, 18Ch, 18Dh, 18Eh, 18Fh, 190h
		dw 191h, 192h, 193h, 194h, 195h, 196h, 197h, 198h, 199h
		dw 19Ah
aLibnspr4_dll	db 'libnspr4.dll',0     ; DATA XREF: .rdata:1002C7ACo
aGetexecutionen	db 'GetExecutionEnvironment',0 ; DATA XREF: .rdata:off_1002CE34o
aLl_maxint	db 'LL_MaxInt',0        ; DATA XREF: .rdata:off_1002CE34o
aLl_maxuint	db 'LL_MaxUint',0       ; DATA XREF: .rdata:off_1002CE34o
aLl_minint	db 'LL_MinInt',0        ; DATA XREF: .rdata:off_1002CE34o
aLl_zero	db 'LL_Zero',0          ; DATA XREF: .rdata:off_1002CE34o
aPrp_destroynak	db 'PRP_DestroyNakedCondVar',0 ; DATA XREF: .rdata:off_1002CE34o
aPrp_nakedbroad	db 'PRP_NakedBroadcast',0 ; DATA XREF: .rdata:off_1002CE34o
aPrp_nakednotif	db 'PRP_NakedNotify',0  ; DATA XREF: .rdata:off_1002CE34o
aPrp_nakedwait	db 'PRP_NakedWait',0    ; DATA XREF: .rdata:off_1002CE34o
aPrp_newnakedco	db 'PRP_NewNakedCondVar',0 ; DATA XREF: .rdata:off_1002CE34o
aPrp_trylock	db 'PRP_TryLock',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_abort	db 'PR_Abort',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_accept	db 'PR_Accept',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_acceptread	db 'PR_AcceptRead',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_access	db 'PR_Access',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_addtocounte	db 'PR_AddToCounter',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_addwaitfile	db 'PR_AddWaitFileDesc',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_allocfilede	db 'PR_AllocFileDesc',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_assert	db 'PR_Assert',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_assertcurre	db 'PR_AssertCurrentThreadInMonitor',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_assertcur_0	db 'PR_AssertCurrentThreadOwnsLock',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_atomicadd	db 'PR_AtomicAdd',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_atomicdecre	db 'PR_AtomicDecrement',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_atomicincre	db 'PR_AtomicIncrement',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_atomicset	db 'PR_AtomicSet',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_attachshare	db 'PR_AttachSharedMemory',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_attachthrea	db 'PR_AttachThread',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_attachthr_0	db 'PR_AttachThreadGCAble',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_available	db 'PR_Available',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_available64	db 'PR_Available64',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_bind	db 'PR_Bind',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_blockclocki	db 'PR_BlockClockInterrupts',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_blockinterr	db 'PR_BlockInterrupt',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_centermonit	db 'PR_CEnterMonitor',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_cexitmonito	db 'PR_CExitMonitor',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_cnotify	db 'PR_CNotify',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_cnotifyall	db 'PR_CNotifyAll',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_csetonmonit	db 'PR_CSetOnMonitorRecycle',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_cwait	db 'PR_CWait',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_callonce	db 'PR_CallOnce',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_calloncewit	db 'PR_CallOnceWithArg',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_calloc	db 'PR_Calloc',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_canceljob	db 'PR_CancelJob',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_cancelwaitf	db 'PR_CancelWaitFileDesc',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_cancelwaitg	db 'PR_CancelWaitGroup',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_ceilinglog2	db 'PR_CeilingLog2',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_changefiled	db 'PR_ChangeFileDescNativeHandle',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_cleanup	db 'PR_Cleanup',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_clearinterr	db 'PR_ClearInterrupt',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_clearthread	db 'PR_ClearThreadGCAble',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_close	db 'PR_Close',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_closedir	db 'PR_CloseDir',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_closefilema	db 'PR_CloseFileMap',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_closesemaph	db 'PR_CloseSemaphore',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_closeshared	db 'PR_CloseSharedMemory',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_connect	db 'PR_Connect',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_connectcont	db 'PR_ConnectContinue',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_convertipv4	db 'PR_ConvertIPv4AddrToIPv6',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createalarm	db 'PR_CreateAlarm',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_createcount	db 'PR_CreateCounter',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createfilem	db 'PR_CreateFileMap',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createiolay	db 'PR_CreateIOLayer',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createiol_0	db 'PR_CreateIOLayerStub',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createmwait	db 'PR_CreateMWaitEnumerator',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createorder	db 'PR_CreateOrderedLock',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createpipe	db 'PR_CreatePipe',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_createproce	db 'PR_CreateProcess',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createpro_0	db 'PR_CreateProcessDetached',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createsocke	db 'PR_CreateSocketPollFd',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createstack	db 'PR_CreateStack',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_createthrea	db 'PR_CreateThread',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_createthr_0	db 'PR_CreateThreadGCAble',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createthr_1	db 'PR_CreateThreadPool',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_createtrace	db 'PR_CreateTrace',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_createwaitg	db 'PR_CreateWaitGroup',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_decrementco	db 'PR_DecrementCounter',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_delete	db 'PR_Delete',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_deletesemap	db 'PR_DeleteSemaphore',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_deleteshare	db 'PR_DeleteSharedMemory',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroyalar	db 'PR_DestroyAlarm',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_destroycond	db 'PR_DestroyCondVar',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroycoun	db 'PR_DestroyCounter',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroylock	db 'PR_DestroyLock',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_destroymwai	db 'PR_DestroyMWaitEnumerator',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroymoni	db 'PR_DestroyMonitor',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroyorde	db 'PR_DestroyOrderedLock',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroypoll	db 'PR_DestroyPollableEvent',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroyproc	db 'PR_DestroyProcessAttr',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroyrwlo	db 'PR_DestroyRWLock',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroysem	db 'PR_DestroySem',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_destroysock	db 'PR_DestroySocketPollFd',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_destroystac	db 'PR_DestroyStack',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_destroytrac	db 'PR_DestroyTrace',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_destroywait	db 'PR_DestroyWaitGroup',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_detachproce	db 'PR_DetachProcess',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_detachshare	db 'PR_DetachSharedMemory',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_detachthrea	db 'PR_DetachThread',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_disablecloc	db 'PR_DisableClockInterrupts',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_emulateacce	db 'PR_EmulateAcceptRead',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_emulatesend	db 'PR_EmulateSendFile',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_enableclock	db 'PR_EnableClockInterrupts',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_entermonito	db 'PR_EnterMonitor',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_enumeratead	db 'PR_EnumerateAddrInfo',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_enumerateho	db 'PR_EnumerateHostEnt',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_enumerateth	db 'PR_EnumerateThreads',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_enumeratewa	db 'PR_EnumerateWaitGroup',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_errorinstal	db 'PR_ErrorInstallCallback',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_errorinst_0	db 'PR_ErrorInstallTable',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_errorlangua	db 'PR_ErrorLanguages',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_errortoname	db 'PR_ErrorToName',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_errortostri	db 'PR_ErrorToString',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_exitmonitor	db 'PR_ExitMonitor',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_explodetime	db 'PR_ExplodeTime',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_exportfilem	db 'PR_ExportFileMapAsString',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_fd_clr	db 'PR_FD_CLR',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_fd_isset	db 'PR_FD_ISSET',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_fd_nclr	db 'PR_FD_NCLR',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_fd_nisset	db 'PR_FD_NISSET',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_fd_nset	db 'PR_FD_NSET',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_fd_set	db 'PR_FD_SET',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_fd_zero	db 'PR_FD_ZERO',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_filedesc2na	db 'PR_FileDesc2NativeHandle',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_findfunctio	db 'PR_FindFunctionSymbol',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_findfunct_0	db 'PR_FindFunctionSymbolAndLibrary',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_findnextcou	db 'PR_FindNextCounterQname',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_findnextc_0	db 'PR_FindNextCounterRname',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_findnexttra	db 'PR_FindNextTraceQname',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_findnextt_0	db 'PR_FindNextTraceRname',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_findsymbol	db 'PR_FindSymbol',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_findsymbola	db 'PR_FindSymbolAndLibrary',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_floorlog2	db 'PR_FloorLog2',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_formattime	db 'PR_FormatTime',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_formattimeu	db 'PR_FormatTimeUSEnglish',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_free	db 'PR_Free',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_freeaddrinf	db 'PR_FreeAddrInfo',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_freefiledes	db 'PR_FreeFileDesc',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_freelibrary	db 'PR_FreeLibraryName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_gmtparamete	db 'PR_GMTParameters',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getaddrinfo	db 'PR_GetAddrInfoByName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getcanonnam	db 'PR_GetCanonNameFromAddrInfo',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getconnects	db 'PR_GetConnectStatus',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getcounter	db 'PR_GetCounter',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_getcounterh	db 'PR_GetCounterHandleFromName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getcountern	db 'PR_GetCounterNameFromHandle',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getcurrentt	db 'PR_GetCurrentThread',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getdefaulti	db 'PR_GetDefaultIOMethods',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getdesctype	db 'PR_GetDescType',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_getdirector	db 'PR_GetDirectorySeparator',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getdirect_0	db 'PR_GetDirectorySepartor',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getenv	db 'PR_GetEnv',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_geterror	db 'PR_GetError',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_geterrortex	db 'PR_GetErrorText',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_geterrort_0	db 'PR_GetErrorTextLength',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getfileinfo	db 'PR_GetFileInfo',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_getfilein_0	db 'PR_GetFileInfo64',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getfilemeth	db 'PR_GetFileMethods',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getgcregist	db 'PR_GetGCRegisters',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_gethostbyad	db 'PR_GetHostByAddr',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_gethostbyna	db 'PR_GetHostByName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getipnodeby	db 'PR_GetIPNodeByName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getidentiti	db 'PR_GetIdentitiesLayer',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getinherite	db 'PR_GetInheritedFD',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getinheri_0	db 'PR_GetInheritedFileMap',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getlayersid	db 'PR_GetLayersIdentity',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getlibraryf	db 'PR_GetLibraryFilePathname',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getlibraryn	db 'PR_GetLibraryName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getlibraryp	db 'PR_GetLibraryPath',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getmemmapal	db 'PR_GetMemMapAlignment',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getmonitore	db 'PR_GetMonitorEntryCount',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getnamefori	db 'PR_GetNameForIdentity',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getnumberof	db 'PR_GetNumberOfProcessors',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getoserror	db 'PR_GetOSError',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_getopenfile	db 'PR_GetOpenFileInfo',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getopenfi_0	db 'PR_GetOpenFileInfo64',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getpageshif	db 'PR_GetPageShift',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_getpagesize	db 'PR_GetPageSize',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_getpathsepa	db 'PR_GetPathSeparator',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getpeername	db 'PR_GetPeerName',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_getphysical	db 'PR_GetPhysicalMemorySize',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getpipemeth	db 'PR_GetPipeMethods',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getprotobyn	db 'PR_GetProtoByName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getprotob_0	db 'PR_GetProtoByNumber',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getrandomno	db 'PR_GetRandomNoise',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getsp	db 'PR_GetSP',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_getsockname	db 'PR_GetSockName',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_getsocketop	db 'PR_GetSocketOption',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getspecialf	db 'PR_GetSpecialFD',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_getstackspa	db 'PR_GetStackSpaceLeft',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getsysfdtab	db 'PR_GetSysfdTableMax',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getsystemin	db 'PR_GetSystemInfo',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_gettcpmetho	db 'PR_GetTCPMethods',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getthreadaf	db 'PR_GetThreadAffinityMask',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getthreadid	db 'PR_GetThreadID',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_getthreadna	db 'PR_GetThreadName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getthreadpr	db 'PR_GetThreadPriority',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getthread_0	db 'PR_GetThreadPrivate',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getthreadsc	db 'PR_GetThreadScope',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getthreadst	db 'PR_GetThreadState',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getthreadty	db 'PR_GetThreadType',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_gettraceent	db 'PR_GetTraceEntries',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_gettracehan	db 'PR_GetTraceHandleFromName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_gettracenam	db 'PR_GetTraceNameFromHandle',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_gettraceopt	db 'PR_GetTraceOption',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getudpmetho	db 'PR_GetUDPMethods',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getuniqueid	db 'PR_GetUniqueIdentity',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_getversion	db 'PR_GetVersion',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_implodetime	db 'PR_ImplodeTime',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_importfile	db 'PR_ImportFile',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_importfilem	db 'PR_ImportFileMapFromString',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_importpipe	db 'PR_ImportPipe',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_importtcpso	db 'PR_ImportTCPSocket',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_importudpso	db 'PR_ImportUDPSocket',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_incrementco	db 'PR_IncrementCounter',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_init	db 'PR_Init',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_initialize	db 'PR_Initialize',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_initializen	db 'PR_InitializeNetAddr',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_initialized	db 'PR_Initialized',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_interrupt	db 'PR_Interrupt',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_intervalnow	db 'PR_IntervalNow',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_intervaltom	db 'PR_IntervalToMicroseconds',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_intervalt_0	db 'PR_IntervalToMilliseconds',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_intervaltos	db 'PR_IntervalToSeconds',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_isnetaddrty	db 'PR_IsNetAddrType',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_joinjob	db 'PR_JoinJob',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_jointhread	db 'PR_JoinThread',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_jointhreadp	db 'PR_JoinThreadPool',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_killprocess	db 'PR_KillProcess',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_listen	db 'PR_Listen',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_loadlibrary	db 'PR_LoadLibrary',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_loadlibra_0	db 'PR_LoadLibraryWithFlags',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_loadstaticl	db 'PR_LoadStaticLibrary',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_localtimepa	db 'PR_LocalTimeParameters',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_lock	db 'PR_Lock',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_lockfile	db 'PR_LockFile',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_lockordered	db 'PR_LockOrderedLock',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_logflush	db 'PR_LogFlush',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_logprint	db 'PR_LogPrint',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_makedir	db 'PR_MakeDir',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_malloc	db 'PR_Malloc',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_memmap	db 'PR_MemMap',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_memunmap	db 'PR_MemUnmap',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_microsecond	db 'PR_MicrosecondsToInterval',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_millisecond	db 'PR_MillisecondsToInterval',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_mkdir	db 'PR_MkDir',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_ntfast_acce	db 'PR_NTFast_Accept',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_ntfast_ac_0	db 'PR_NTFast_AcceptRead',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_ntfast_ac_1	db 'PR_NTFast_AcceptRead_WithTimeoutCallback',0
					; DATA XREF: .rdata:off_1002CE34o
aPr_ntfast_upda	db 'PR_NTFast_UpdateAcceptContext',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_nt_cancelio	db 'PR_NT_CancelIo',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_netaddrtost	db 'PR_NetAddrToString',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_newcondvar	db 'PR_NewCondVar',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_newlock	db 'PR_NewLock',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_newlogmodul	db 'PR_NewLogModule',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_newmonitor	db 'PR_NewMonitor',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_newnamedmon	db 'PR_NewNamedMonitor',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_newpollable	db 'PR_NewPollableEvent',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_newprocessa	db 'PR_NewProcessAttr',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_newrwlock	db 'PR_NewRWLock',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_newsem	db 'PR_NewSem',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_newtcpsocke	db 'PR_NewTCPSocket',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_newtcpsoc_0	db 'PR_NewTCPSocketPair',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_newthreadpr	db 'PR_NewThreadPrivateIndex',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_newudpsocke	db 'PR_NewUDPSocket',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_normalizeti	db 'PR_NormalizeTime',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_notify	db 'PR_Notify',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_notifyall	db 'PR_NotifyAll',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_notifyallco	db 'PR_NotifyAllCondVar',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_notifycondv	db 'PR_NotifyCondVar',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_now		db 'PR_Now',0           ; DATA XREF: .rdata:off_1002CE34o
aPr_open	db 'PR_Open',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_openanonfil	db 'PR_OpenAnonFileMap',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_opendir	db 'PR_OpenDir',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_openfile	db 'PR_OpenFile',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_opensemapho	db 'PR_OpenSemaphore',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_opensharedm	db 'PR_OpenSharedMemory',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_opentcpsock	db 'PR_OpenTCPSocket',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_openudpsock	db 'PR_OpenUDPSocket',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_parsetimest	db 'PR_ParseTimeString',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_parsetime_0	db 'PR_ParseTimeStringToExplodedTime',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_poll	db 'PR_Poll',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_popiolayer	db 'PR_PopIOLayer',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_postsem	db 'PR_PostSem',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_postsemapho	db 'PR_PostSemaphore',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_processattr	db 'PR_ProcessAttrSetCurrentDirectory',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_processat_0	db 'PR_ProcessAttrSetInheritableFD',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_processat_1	db 'PR_ProcessAttrSetInheritableFileMap',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_processat_2	db 'PR_ProcessAttrSetStdioRedirect',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_processexit	db 'PR_ProcessExit',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_pushiolayer	db 'PR_PushIOLayer',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_queuejob	db 'PR_QueueJob',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_queuejob_ac	db 'PR_QueueJob_Accept',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_queuejob_co	db 'PR_QueueJob_Connect',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_queuejob_re	db 'PR_QueueJob_Read',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_queuejob_ti	db 'PR_QueueJob_Timer',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_queuejob_wr	db 'PR_QueueJob_Write',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_rwlock_rloc	db 'PR_RWLock_Rlock',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_rwlock_unlo	db 'PR_RWLock_Unlock',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_rwlock_wloc	db 'PR_RWLock_Wlock',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_read	db 'PR_Read',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_readdir	db 'PR_ReadDir',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_realloc	db 'PR_Realloc',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_recordtrace	db 'PR_RecordTraceEntries',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_recv	db 'PR_Recv',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_recvfrom	db 'PR_RecvFrom',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_rename	db 'PR_Rename',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_resetalarm	db 'PR_ResetAlarm',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_resetproces	db 'PR_ResetProcessAttr',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_resumeall	db 'PR_ResumeAll',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_rmdir	db 'PR_RmDir',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_scanstackpo	db 'PR_ScanStackPointers',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_secondstoin	db 'PR_SecondsToInterval',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_seek	db 'PR_Seek',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_seek64	db 'PR_Seek64',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_select	db 'PR_Select',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_send	db 'PR_Send',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_sendfile	db 'PR_SendFile',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_sendto	db 'PR_SendTo',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_setalarm	db 'PR_SetAlarm',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_setcpuaffin	db 'PR_SetCPUAffinityMask',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setconcurre	db 'PR_SetConcurrency',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setcounter	db 'PR_SetCounter',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_setcurrentt	db 'PR_SetCurrentThreadName',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setenv	db 'PR_SetEnv',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_seterror	db 'PR_SetError',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_seterrortex	db 'PR_SetErrorText',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_setfdcaches	db 'PR_SetFDCacheSize',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setfdinheri	db 'PR_SetFDInheritable',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setlibraryp	db 'PR_SetLibraryPath',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setlogbuffe	db 'PR_SetLogBuffering',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setlogfile	db 'PR_SetLogFile',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_setnetaddr	db 'PR_SetNetAddr',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_setpollable	db 'PR_SetPollableEvent',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setsocketop	db 'PR_SetSocketOption',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setstdiored	db 'PR_SetStdioRedirect',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setsysfdtab	db 'PR_SetSysfdTableSize',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setthreadaf	db 'PR_SetThreadAffinityMask',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setthreaddu	db 'PR_SetThreadDumpProc',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setthreadgc	db 'PR_SetThreadGCAble',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setthreadpr	db 'PR_SetThreadPriority',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setthread_0	db 'PR_SetThreadPrivate',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_setthreadre	db 'PR_SetThreadRecycleMode',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_settraceopt	db 'PR_SetTraceOption',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_showstatus	db 'PR_ShowStatus',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_shutdown	db 'PR_Shutdown',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_shutdownthr	db 'PR_ShutdownThreadPool',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_sleep	db 'PR_Sleep',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_socket	db 'PR_Socket',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_stackpop	db 'PR_StackPop',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_stackpush	db 'PR_StackPush',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_stat	db 'PR_Stat',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_stringtonet	db 'PR_StringToNetAddr',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_subtractfro	db 'PR_SubtractFromCounter',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_suspendall	db 'PR_SuspendAll',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_sync	db 'PR_Sync',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_syncmemmap	db 'PR_SyncMemMap',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_tlockfile	db 'PR_TLockFile',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_testandente	db 'PR_TestAndEnterMonitor',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_testandlock	db 'PR_TestAndLock',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_threadscans	db 'PR_ThreadScanStackPointers',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_tickspersec	db 'PR_TicksPerSecond',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_trace	db 'PR_Trace',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_transmitfil	db 'PR_TransmitFile',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_uspacificti	db 'PR_USPacificTimeParameters',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_unblockcloc	db 'PR_UnblockClockInterrupts',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_unblockinte	db 'PR_UnblockInterrupt',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_unloadlibra	db 'PR_UnloadLibrary',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_unlock	db 'PR_Unlock',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_unlockfile	db 'PR_UnlockFile',0    ; DATA XREF: .rdata:off_1002CE34o
aPr_unlockorder	db 'PR_UnlockOrderedLock',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_versionchec	db 'PR_VersionCheck',0  ; DATA XREF: .rdata:off_1002CE34o
aPr_wait	db 'PR_Wait',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_waitcondvar	db 'PR_WaitCondVar',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_waitforpoll	db 'PR_WaitForPollableEvent',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_waitprocess	db 'PR_WaitProcess',0   ; DATA XREF: .rdata:off_1002CE34o
aPr_waitrecvrea	db 'PR_WaitRecvReady',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_waitsem	db 'PR_WaitSem',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_waitsemapho	db 'PR_WaitSemaphore',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_write	db 'PR_Write',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_writev	db 'PR_Writev',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_yield	db 'PR_Yield',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_cnvtf	db 'PR_cnvtf',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_dtoa	db 'PR_dtoa',0          ; DATA XREF: .rdata:off_1002CE34o
aPr_fprintf	db 'PR_fprintf',0       ; DATA XREF: .rdata:off_1002CE34o
aPr_htonl	db 'PR_htonl',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_htonll	db 'PR_htonll',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_htons	db 'PR_htons',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_ntohl	db 'PR_ntohl',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_ntohll	db 'PR_ntohll',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_ntohs	db 'PR_ntohs',0         ; DATA XREF: .rdata:off_1002CE34o
aPr_smprintf	db 'PR_smprintf',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_smprintf_fr	db 'PR_smprintf_free',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_snprintf	db 'PR_snprintf',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_sprintf_app	db 'PR_sprintf_append',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_sscanf	db 'PR_sscanf',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_strtod	db 'PR_strtod',0        ; DATA XREF: .rdata:off_1002CE34o
aPr_sxprintf	db 'PR_sxprintf',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_vfprintf	db 'PR_vfprintf',0      ; DATA XREF: .rdata:off_1002CE34o
aPr_vsmprintf	db 'PR_vsmprintf',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_vsnprintf	db 'PR_vsnprintf',0     ; DATA XREF: .rdata:off_1002CE34o
aPr_vsprintf_ap	db 'PR_vsprintf_append',0 ; DATA XREF: .rdata:off_1002CE34o
aPr_vsxprintf	db 'PR_vsxprintf',0     ; DATA XREF: .rdata:off_1002CE34o
aPt_fprintstats	db 'PT_FPrintStats',0   ; DATA XREF: .rdata:off_1002CE34o
aSetexecutionen	db 'SetExecutionEnvironment',0 ; DATA XREF: .rdata:off_1002CE34o
a_pr_addsleepq	db '_PR_AddSleepQ',0    ; DATA XREF: .rdata:off_1002CE34o
a_pr_createthre	db '_PR_CreateThread',0 ; DATA XREF: .rdata:off_1002CE34o
a_pr_delsleepq	db '_PR_DelSleepQ',0    ; DATA XREF: .rdata:off_1002CE34o
a_pr_getprimord	db '_PR_GetPrimordialCPU',0 ; DATA XREF: .rdata:off_1002CE34o
a_pr_nativecrea	db '_PR_NativeCreateThread',0 ; DATA XREF: .rdata:off_1002CE34o
a_pr_push_ipv6t	db '_pr_push_ipv6toipv4_layer',0 ; DATA XREF: .rdata:off_1002CE34o
a_pr_test_ipv6_	db '_pr_test_ipv6_socket',0 ; DATA XREF: .rdata:off_1002CE34o
aLibversionpoin	db 'libVersionPoint',0  ; DATA XREF: .rdata:off_1002CE34o
		align 1000h
_rdata		ends

; Section 3. (virtual address 00030000)
; Virtual size			: 00002B54 (  11092.)
; Section size in file		: 00000A00 (   2560.)
; Offset to raw	data for section: 0002DE00
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 10030000h
dword_10030000	dd 2, 0			; DATA XREF: libVersionPointo
		dd 0B0F19540h, 50415h
		dd offset a20140927210133 ; "2014-09-27	21:01:33"
		dd 70A04h, 3 dup(0)
		dd offset aLibnspr4_dll_0 ; "libnspr4.dll"
		dd offset aPortableRuntim ; "Portable runtime"
		dd offset aNA		; "N/A"
		dd offset aCopyrightC1998 ; "Copyright (c) 1998	Netscape Communicati"...
		dd offset aLicenseInforma ; "License information: http://www.mozilla"...
		dd offset dword_1002835C+4
		align 10h
dword_10030040	dd 0Ch			; DATA XREF: sub_10001010+22r
					; PR_SetFDCacheSize:loc_10001270r ...
		align 8
dword_10030048	dd 0			; DATA XREF: sub_10002680+Cr
		dd 80h,	4, 8, 1002h, 1001h, 7, 8, 5, 6,	2, 3, 4, 1, 0FFFFFFFFh
		dd 20h,	0FFFFFFFFh, 0
dword_10030090	dd 0			; DATA XREF: sub_10002680+31r
		dd 5 dup(0FFFFh), 7 dup(0)
		dd 2 dup(6), 2 dup(0FFFFh), 0
dword_100300D8	dd 0			; DATA XREF: PR_FreeFileDesc_0+8o
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B10
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B10
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B30
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
dword_10030168	dd 4			; DATA XREF: PR_GetDefaultIOMethodso
					; PR_CreateIOLayer+2Eo
		dd offset sub_100041C0
		dd offset sub_10003890
		dd offset sub_100038B0
		dd offset sub_100038D0
		dd offset sub_100038F0
		dd offset sub_10003910
		dd offset sub_10003930
		dd offset sub_10003950
		dd offset sub_10003980
		dd offset sub_100039A0
		dd offset sub_100039C0
		dd offset sub_100039E0
		dd offset sub_10004220
		dd offset sub_10003A20
		dd offset sub_10003A40
		dd offset sub_10003A60
		dd offset sub_10003A80
		dd offset sub_10003AA0
		dd offset sub_10003AC0
		dd offset sub_10003AE0
		dd offset sub_10005210
		dd offset sub_100042E0
		dd offset sub_10003B00
		dd offset sub_10003B20
		dd offset sub_10003B40
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10003B60
		dd offset sub_10003B80
		dd offset sub_10003BA0
		dd offset sub_10003A00
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
dword_100301F8	dd 4			; DATA XREF: PR_NewPollableEvent+48o
		dd offset sub_10005390
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B10
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B10
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B30
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10005210
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
off_10030288	dd offset a0123456789ab_1 ; DATA XREF: sub_10005C10:loc_10005E05r
					; "0123456789abcdef"
off_1003028C	dd offset a0123456789ab_2 ; DATA XREF: sub_10005C10:loc_10005E5Dr
					; "0123456789ABCDEF"
off_10030290	dd offset dword_10030BE0 ; DATA	XREF: sub_10009860+43r
					; sub_10009860+61w ...
		dd 5, 19h, 7Dh
off_100302A0	dd offset aIDefault	; DATA XREF: .data:off_100302ACo
					; "i-default"
		dd offset dword_1002A1C8+8
		dd 0
off_100302AC	dd offset off_100302A0	; DATA XREF: PR_ErrorLanguagesr
					; PR_ErrorInstallCallback+Cw
off_100302B0	dd offset off_100302B0	; DATA XREF: .text:10019F4Bo
					; PR_SuspendAll+2Dr ...
off_100302B4	dd offset off_100302B0	; DATA XREF: .text:10019F52r
					; .text:10019F5Er ...
off_100302B8	dd offset off_100302B8	; DATA XREF: .text:10019D05o
					; PR_SuspendAll:loc_1001B6C5r ...
off_100302BC	dd offset off_100302B8	; DATA XREF: .text:10019D0Br
					; .text:10019D13r ...
off_100302C0	dd offset off_100302C0	; DATA XREF: PR_SetCPUAffinityMask+Fr
					; PR_SetCPUAffinityMask+20o ...
off_100302C4	dd offset off_100302C0	; DATA XREF: sub_10017F60+A5r
					; sub_10017F60+AEr ...
dword_100302C8	dd 0FFFFFFFFh		; DATA XREF: LL_MaxIntr
dword_100302CC	dd 7FFFFFFFh		; DATA XREF: LL_MaxInt+5r
dword_100302D0	dd 0			; DATA XREF: LL_MinIntr
dword_100302D4	dd 80000000h		; DATA XREF: LL_MinInt+5r
dword_100302D8	dd 0FFFFFFFFh		; DATA XREF: LL_MaxUintr
dword_100302DC	dd 0FFFFFFFFh		; DATA XREF: LL_MaxUint+5r
off_100302E0	dd offset a0123456789ab_1 ; DATA XREF: sub_1000E8A0+36Dr
					; "0123456789abcdef"
dword_100302E4	dd 1			; DATA XREF: PR_Trace+5r
					; PR_SetTraceOption+CFw ...
; void *off_100302E8
off_100302E8	dd offset aSun		; DATA XREF: PR_FormatTimeUSEnglish+90r
					; "Sun"
		dd offset aMon_0	; "Mon"
		dd offset aTue		; "Tue"
		dd offset aWed		; "Wed"
		dd offset aThu		; "Thu"
		dd offset aFri		; "Fri"
		dd offset aSat		; "Sat"
; void *off_10030304
off_10030304	dd offset aSunday	; DATA XREF: PR_FormatTimeUSEnglish+CBr
					; "Sunday"
		dd offset aMonday	; "Monday"
		dd offset aTuesday	; "Tuesday"
		dd offset aWednesday	; "Wednesday"
		dd offset aThursday	; "Thursday"
		dd offset aFriday	; "Friday"
		dd offset aSaturday	; "Saturday"
; void *off_10030320
off_10030320	dd offset aJan		; DATA XREF: PR_FormatTimeUSEnglish+101r
					; "Jan"
		dd offset aFeb		; "Feb"
		dd offset aMar		; "Mar"
		dd offset aApr		; "Apr"
		dd offset aMay		; "May"
		dd offset aJun		; "Jun"
		dd offset aJul		; "Jul"
		dd offset aAug		; "Aug"
		dd offset aSep		; "Sep"
		dd offset aOct		; "Oct"
		dd offset aNov		; "Nov"
		dd offset aDec		; "Dec"
; void *off_10030350
off_10030350	dd offset aJanuary	; DATA XREF: PR_FormatTimeUSEnglish+13Ar
					; "January"
		dd offset aFebruary	; "February"
		dd offset aMarch	; "March"
		dd offset aApril	; "April"
		dd offset aMay		; "May"
		dd offset aJune		; "June"
		dd offset aJuly		; "July"
		dd offset aAugust	; "August"
		dd offset aSeptember	; "September"
		dd offset aOctober	; "October"
		dd offset aNovember	; "November"
		dd offset aDecember	; "December"
dword_10030380	dd 1			; DATA XREF: PR_GetFileMethodso
					; PR_Open+39o ...
		dd offset sub_100143A0
		dd offset sub_100140A0
		dd offset sub_10014140
		dd offset sub_10014250
		dd offset sub_100142A0
		dd offset sub_10014380
		dd offset sub_10014220
		dd offset sub_10014230
		dd offset sub_10014340
		dd offset sub_10014360
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B30
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10014410
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
dword_10030410	dd 5			; DATA XREF: PR_GetPipeMethodso
					; PR_ImportPipe+14o ...
		dd offset sub_100143A0
		dd offset sub_100140A0
		dd offset sub_10014140
		dd offset sub_10014310
		dd offset sub_10014320
		dd offset sub_10014330
		dd offset sub_10002AF0
		dd offset sub_10002B10
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B30
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10014410
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
dword_100304A0	dd 2			; DATA XREF: PR_GetTCPMethodso
					; PR_Socket+6Do ...
		dd offset sub_10015480
		dd offset sub_10015260
		dd offset sub_10015460
		dd offset sub_10015520
		dd offset sub_10015540
		dd offset sub_10014330
		dd offset sub_10002AF0
		dd offset sub_10002B10
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10014C50
		dd offset sub_10014EA0
		dd offset sub_10016180
		dd offset sub_10015010
		dd offset sub_10015040
		dd offset sub_10015060
		dd offset sub_10015080
		dd offset sub_10015370
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10014410
		dd offset sub_10016460
		dd offset sub_100157A0
		dd offset sub_100157F0
		dd offset sub_10015820
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_100026E0
		dd offset sub_10002920
		dd offset sub_100156F0
		dd offset sub_10014F20
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
dword_10030530	dd 3			; DATA XREF: PR_GetUDPMethodso
					; PR_Socket:loc_10015914o ...
		dd offset sub_10015480
		dd offset sub_10015260
		dd offset sub_10015460
		dd offset sub_10015520
		dd offset sub_10015540
		dd offset sub_10014330
		dd offset sub_10002AF0
		dd offset sub_10002B10
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10014C50
		dd offset sub_10014EA0
		dd offset sub_10002B30
		dd offset sub_10015010
		dd offset sub_10015040
		dd offset sub_10015060
		dd offset sub_10015080
		dd offset sub_10015370
		dd offset sub_10015630
		dd offset sub_10015560
		dd offset sub_10014410
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_100157F0
		dd offset sub_10015820
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_100026E0
		dd offset sub_10002920
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
dword_100305C0	dd 0			; DATA XREF: PR_CreateSocketPollFd+49o
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B10
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B10
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002B30
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10014410
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
		dd offset sub_10002AF0
dword_10030650	dd 1			; DATA XREF: PR_Selectr PR_Select+1Bw
dword_10030654	dd 1			; DATA XREF: PR_Yieldr	PR_Yield+1Bw
off_10030658	dd offset off_10030658	; DATA XREF: .data:off_10030658o
					; .data:off_1003065Co
off_1003065C	dd offset off_10030658	; DATA XREF: sub_10019870+25r
					; sub_10019870+2Dr ...
		dd 4
dword_10030664	dd 120089h, 120116h, 1200A0h ; DATA XREF: sub_10020340+E1o
dword_10030670	dd 120089h, 120156h, 1200A0h ; DATA XREF: sub_10021C00+23o
dword_1003067C	dd 1			; DATA XREF: PR_LogFlush+34r
					; PR_LogFlush:loc_1000464Dr ...
dword_10030680	dd 0F0001h, 1F0002h, 0	; DATA XREF: sub_100255F0+51o
dword_1003068C	dd 0F001Dh, 0F001Bh, 0	; DATA XREF: sub_10025F70+184o
___security_cookie dd 0BB40E64Eh	; DATA XREF: PR_EmulateAcceptRead+3r
					; PR_EmulateSendFile+3r ...
dword_1003069C	dd 44BF19B1h		; DATA XREF: sub_100271CA+B0r
					; sub_1002750D+2Bw ...
dword_100306A0	dd 19930520h, 3	dup(0)	; DATA XREF: .text:100272AEo
					; sub_100272B5+2o
dword_100306B0	dd 0			; DATA XREF: sub_100269EAr
					; sub_10027492+5w
		dd offset off_1002834C
dword_100306B8	dd 0FFFFFFFFh		; DATA XREF: DllEntryPoint-242w
					; sub_100271A9w
		dd 0FFFFFFFFh, 400h, 0FFFFFC01h, 35h, 0Bh, 40h,	3FFh, 80h
		dd 0FFFFFF81h, 18h, 8, 20h, 7Fh, 2 dup(0)
		dd 4002A000h, 2	dup(0)
		dd 4005C800h, 2	dup(0)
		dd 4008FA00h, 2	dup(0)
		dd 400C9C40h, 2	dup(0)
		dd 400FC350h, 2	dup(0)
		dd 4012F424h, 0
		dd 80000000h, 40169896h, 0
		dd 20000000h, 4019BEBCh, 0
		dd 0C9BF0400h, 40348E1Bh, 0A1000000h, 1BCECCEDh, 404ED3C2h
		dd 0B59EF020h, 0ADA82B70h, 40699DC5h, 25FD5DD0h, 4F8E1AE5h
		dd 4083EB19h, 95D79671h, 8D050E43h, 409EAF29h, 44A0BFF9h
		dd 8F1281EDh, 40B98281h, 0A6D53CBFh, 1F49FFCFh,	40D3C278h
		dd 8CE0C66Fh, 47C980E9h, 41A893BAh, 556B85BCh, 0F78D3927h
		dd 427CE070h, 0DE8EDDBCh, 0EBFB9DF9h, 4351AA7Eh, 0E376E6A1h
		dd 2F29F2CCh, 44268184h, 0AA171028h, 0E310AEF8h, 44FAC4C5h
		dd 0F3D4A7EBh, 4AE1EBF7h, 45CF957Ah, 91C7CC65h,	0A0AEA60Eh
		dd 46A3E319h, 0C17650Dh, 75868175h, 4D48C976h, 0A7E44258h
		dd 353B3993h, 53EDB2B8h, 5DE5A74Dh, 3B5DC53Dh, 5A929E8Bh
		dd 0F0A65DFFh, 54C020A1h, 61378CA5h, 5A8BFDD1h,	5D25D88Bh
		dd 67DBF989h, 0F3F895AAh, 0C8A2BF27h, 6E80DD5Dh, 979BC94Ch
		dd 52028A20h, 7525C460h, 0
		dd 0CCCDCCCDh, 0CCCCCCCCh, 3FFBCCCCh, 0D70A3D71h, 0A3D70A3h
		dd 3FF8A3D7h, 0DF3B645Ah, 6E978D4Fh, 3FF58312h,	652CD3C3h
		dd 1758E219h, 3FF1D1B7h, 84230FD0h, 0AC471B47h,	3FEEA7C5h
		dd 69B6A640h, 0BD05AF6Ch, 3FEB8637h, 42BC3D33h,	94D5E57Ah
		dd 3FE7D6BFh, 0CEFDFDC2h, 77118461h, 3FE4ABCCh,	0E15B4C2Fh
		dd 94BEC44Dh, 3FC9E695h, 3B53C492h, 14CD4475h, 3FAF9ABEh
		dd 94BA67DEh, 1EAD4539h, 3F94CFB1h, 0E2C62324h,	313BBABCh
		dd 3F7A8B61h, 0C1595561h, 7C53B17Eh, 3F5FBB12h,	8D2FEED7h
		dd 8592BE06h, 3F44FB15h, 0E9A53F24h, 0EA27A539h, 3F2AA87Fh
		dd 0E4A1AC7Dh, 467C64BCh, 3E55DDD0h, 0CC067B63h, 83775423h
		dd 3D8191FFh, 193AFA91h, 4325637Ah, 3CACC031h, 38D18921h
		dd 0B8974782h, 3BD7FD00h, 85888DCh, 0E3E8B11Bh,	3B03A686h
		dd 424584C6h, 7599B607h, 3A2EDB37h, 0D21C7133h,	0EE32DB23h
		dd 395A9049h, 0C0BE87A6h, 82A5DA57h, 32B5A2A6h,	11B268E2h
		dd 449F52A7h, 2C10B759h, 2DE44925h, 534F3436h, 256BCEAEh
		dd 0A404598Fh, 7DC2DEC0h, 1EC6E8FBh, 5A88E79Eh,	0BF3C9157h
		dd 18228350h, 62654B4Eh, 0AF8F83FDh, 117D9406h,	9FDE2DE4h
		dd 4C8D2CEh, 0AD8A6DDh,	5 dup(0)
; void *lpTlsValue
lpTlsValue	dd 0			; DATA XREF: sub_10001010+66r
					; sub_10001010:loc_100010A7r ...
dword_100309C4	dd 0			; DATA XREF: sub_10001010+58r
					; sub_10001010+82w ...
; void *dword_100309C8
dword_100309C8	dd 0			; DATA XREF: sub_10001010+Cr
					; PR_FreeFileDesc_0+24r ...
; void *Memory
Memory		dd 0			; DATA XREF: sub_10001010:loc_10001060r
					; sub_10001010+72r ...
dword_100309D0	dd 0			; DATA XREF: sub_10001010+91w
					; PR_FreeFileDesc_0+60r ...
dword_100309D4	dd 0			; DATA XREF: sub_10001010+5Er
					; PR_SetFDCacheSize+7Bw ...
dword_100309D8	dd 0			; DATA XREF: sub_10001010+4r
					; PR_FreeFileDesc_0+1Br ...
dword_100309DC	dd 0			; DATA XREF: sub_100016A0+2Cw
; void *dword_100309E0
dword_100309E0	dd 0			; DATA XREF: sub_100016A0+Ew
					; PR_CreateWaitGroup+11Cr ...
; void *dword_100309E4
dword_100309E4	dd 0			; DATA XREF: sub_100016A0+1Aw
					; PR_CancelWaitFileDesc+Cr ...
dword_100309E8	dd 6 dup(0)		; DATA XREF: .text:1000372Fo
					; _pr_push_ipv6toipv4_layer+2Do
		dd 6 dup(?)
dword_10030A18	dd ?			; DATA XREF: .text:10003747w
dword_10030A1C	dd ?			; DATA XREF: .text:1000375Bw
dword_10030A20	dd ?			; DATA XREF: .text:10003751w
		align 20h
dword_10030A40	dd ?			; DATA XREF: .text:10003765w
		align 8
dword_10030A48	dd ?			; DATA XREF: .text:1000376Fw
dword_10030A4C	dd ?			; DATA XREF: .text:10003779w
		dd 0Ah dup(?)
dword_10030A78	dd 3 dup(?)		; DATA XREF: sub_100037C0+5o
					; _pr_push_ipv6toipv4_layer+5o
dword_10030A84	dd ?			; DATA XREF: .text:loc_10003702w
					; sub_100037C0+18r
dword_10030A88	dd 0Ch dup(?)		; DATA XREF: .text:10003742o
					; _pr_push_ipv6toipv4_layer+3Bo
dword_10030AB8	dd ?			; DATA XREF: .text:10003782w
		align 10h
dword_10030AC0	dd ?			; DATA XREF: .text:1000378Cw
		dd 4 dup(?)
dword_10030AD4	dd ?			; DATA XREF: .text:100037A0w
dword_10030AD8	dd ?			; DATA XREF: .text:10003796w
		dd 3 dup(?)
dword_10030AE8	dd ?			; DATA XREF: .text:100037AAw
dword_10030AEC	dd ?			; DATA XREF: .text:100037B4w
		dd 0Ah dup(?)
dword_10030B18	dd ?			; DATA XREF: .text:1000371Ew
					; _pr_push_ipv6toipv4_layer+27r ...
; void *dword_10030B1C
dword_10030B1C	dd ?			; DATA XREF: PR_GetUniqueIdentity:loc_10003D1Br
					; PR_GetUniqueIdentity:loc_10003D42r ...
; void *Src
Src		dd ?			; DATA XREF: PR_GetUniqueIdentity:loc_10003D86r
					; PR_GetUniqueIdentity+11Br ...
dword_10030B24	dd ?			; DATA XREF: PR_GetUniqueIdentity+75r
					; PR_GetUniqueIdentity+ADr ...
dword_10030B28	dd ?			; DATA XREF: PR_GetUniqueIdentity:loc_10003CF0r
					; PR_GetUniqueIdentity+A7r ...
dword_10030B2C	dd ?			; DATA XREF: PR_SetLogBuffering+43w
					; PR_LogPrint+4B0r
; void *dword_10030B30
dword_10030B30	dd ?			; DATA XREF: PR_LogFlush:loc_10004680r
					; PR_LogFlush:loc_100046E8r ...
; void *Dst
Dst		dd ?			; DATA XREF: PR_LogFlush+9Fr
					; PR_LogFlush+C6r ...
; void *dword_10030B38
dword_10030B38	dd ?			; DATA XREF: PR_NewLogModule+2Cr
					; PR_NewLogModule+3Fw ...
; LPCSTR Str
Str		dd ?			; DATA XREF: PR_LogFlush+1r
					; PR_LogFlush+A4r ...
; FILE *File
File		dd ?			; DATA XREF: PR_SetLogFile:loc_100045B4r
					; PR_SetLogFile:loc_100045E0w ...
dword_10030B44	dd ?			; DATA XREF: PR_LogPrint+30r
					; sub_10004F10+10Bw
dword_10030B48	dd ?			; DATA XREF: PR_SetLogFile:loc_1000457Er
					; sub_10004F10+126w
dword_10030B4C	dd ?			; DATA XREF: .text:10005245w
					; PR_NewPollableEvent:loc_10005292r
dword_10030B50	dd 3 dup(?)		; DATA XREF: PR_NewPollableEvent+16o
; void *dword_10030B5C
dword_10030B5C	dd ?			; DATA XREF: sub_10007470+BBr
					; sub_10007470+C6w ...
dword_10030B60	dd ?			; DATA XREF: sub_10007470+A6w
					; sub_10007470+18Dr ...
dword_10030B64	dd ?			; DATA XREF: sub_10007620+85r
					; sub_10007710+96w ...
; void *dword_10030B68
dword_10030B68	dd ?			; DATA XREF: sub_10007470:loc_1000756Fr
					; sub_10007470:loc_10007590r ...
dword_10030B6C	dd ?			; DATA XREF: sub_10007470+174w
					; sub_10007620+47r ...
dword_10030B70	dd ?			; DATA XREF: sub_10007470:loc_10007510r
					; sub_10007470+B5w ...
dword_10030B74	dd ?			; DATA XREF: sub_10007470+10Aw
					; sub_10007620+19r ...
dword_10030B78	dd ?			; DATA XREF: sub_10007470+118r
					; sub_10007470+158r ...
dword_10030B7C	dd ?			; DATA XREF: sub_10007620+3Er
					; sub_10007620+4Fw ...
dword_10030B80	dd ?			; DATA XREF: sub_10007CB0+14w
					; PR_SetThreadPrivate:loc_10007D94r ...
dword_10030B84	dd ?			; DATA XREF: PR_NewThreadPrivateIndex:loc_10007CDEo
dword_10030B88	dd ?			; DATA XREF: sub_10007CB0+Fw
					; PR_NewThreadPrivateIndex+3Ar	...
; void *dword_10030B8C
dword_10030B8C	dd ?			; DATA XREF: sub_10007F20r
					; sub_10007F20+16w ...
dword_10030B90	dd ?			; DATA XREF: sub_10007F20+65w
					; sub_10008190+9r ...
dword_10030B94	dd ?			; DATA XREF: sub_10007F20+5Fw
					; PR_LoadStaticLibrary+63r
; char *dword_10030B98
dword_10030B98	dd ?			; DATA XREF: sub_10007FB0+Br
					; sub_10007FB0+2Bw ...
dword_10030B9C	dd ?			; DATA XREF: PR_CreateCounter+39w
					; PR_CreateCounter+165r ...
; LPVOID dword_10030BA0
dword_10030BA0	dd ?			; DATA XREF: PR_CreateCounterr
					; PR_CreateCounter+1Cw	...
dword_10030BA4	dd ?			; DATA XREF: PR_CreateCounter+Bo
					; PR_CreateCounter+21w	...
dword_10030BA8	dd ?			; DATA XREF: PR_CreateCounter+27w
					; PR_CreateCounter+D3r	...
		align 10h
; void *dword_10030BB0
dword_10030BB0	dd ?			; DATA XREF: sub_10009810+5w
					; sub_10009830r ...
; void *dword_10030BB4
dword_10030BB4	dd ?			; DATA XREF: sub_10009810+Fw
					; sub_10009830+Br ...
dword_10030BB8	dd ?			; DATA XREF: sub_10009D90+2Dr
					; sub_10009D90+43r ...
dword_10030BBC	dd ?			; DATA XREF: sub_10009860+14r
					; sub_10009860+21w ...
dword_10030BC0	dd ?			; DATA XREF: sub_10009B60+Cr
					; sub_10009B60+1Bw ...
		align 20h
dword_10030BE0	dd 240h	dup(?)		; DATA XREF: sub_10009860+4Bo
					; sub_10009B60+2Ao ...
; void *dword_100314E0
dword_100314E0	dd ?			; DATA XREF: sub_1000C780+5w
					; sub_1000C790r ...
byte_100314E4	db ?			; DATA XREF: sub_1000C980+11o
					; sub_1000C980+1Ew ...
byte_100314E5	db 3 dup(?)		; DATA XREF: sub_1000C980+23o
		dd ?
dword_100314EC	dd ?			; DATA XREF: PR_ErrorToString+8Bw
					; PR_ErrorToString+C7o	...
dword_100314F0	dd ?			; DATA XREF: PR_ErrorToString+95w
dword_100314F4	dd ?			; DATA XREF: PR_ErrorToString+A6w
word_100314F8	dw ?			; DATA XREF: PR_ErrorToString+ABw
		align 4
		dd 3 dup(?)
dword_10031508	dd ?			; DATA XREF: PR_ErrorToString+6r
					; PR_ErrorToNamer ...
dword_1003150C	dd ?			; DATA XREF: PR_ErrorToString+49r
					; PR_ErrorInstallTable+2Cr ...
dword_10031510	dd ?			; DATA XREF: PR_ErrorToString:loc_1000CA4Dr
					; PR_ErrorInstallCallback+15w
dword_10031514	dd ?			; DATA XREF: PR_ErrorInstallTable:loc_1000CBFBr
					; PR_ErrorInstallCallback+1Bw ...
; void *dword_10031518
dword_10031518	dd ?			; DATA XREF: PR_Init_0+131w
					; PR_Cleanup+B4r ...
; void *dword_1003151C
dword_1003151C	dd ?			; DATA XREF: PR_Init_0+13Ew
					; PR_Cleanup+BFr ...
dword_10031520	dd ?			; DATA XREF: PR_SetFDCacheSize+5r
					; PR_AddWaitFileDesc+1r ...
dword_10031524	dd ?			; DATA XREF: sub_1000CDA0+1Fw
					; sub_1000CDA0+48w ...
dword_10031528	dd ?			; DATA XREF: LL_Zeror
dword_1003152C	dd ?			; DATA XREF: LL_Zero+5r
; void *dword_10031530
dword_10031530	dd ?			; DATA XREF: sub_1000DA90+5w
					; sub_1000DAA0r ...
dword_10031534	dd ?			; DATA XREF: sub_1000ED80+41w
					; PR_GetAddrInfoByName+C1r ...
dword_10031538	dd ?			; DATA XREF: sub_1000ED80+5Bw
					; sub_1000ED80+68r ...
dword_1003153C	dd ?			; DATA XREF: sub_1000ED80+6Fw
					; PR_NetAddrToString+4Er
dword_10031540	dd ?			; DATA XREF: sub_10010AF0+14r
					; sub_10010AF0+7Dr ...
dword_10031544	dd ?			; DATA XREF: sub_10010AF0+C9w
					; PR_Trace+100w ...
dword_10031548	dd ?			; DATA XREF: sub_10010AF0+D5w
					; sub_100113B0+2Cw ...
dword_1003154C	dd ?			; DATA XREF: sub_10010AF0+DAw
					; PR_SetTraceOption+11Fw ...
dword_10031550	dd ?			; DATA XREF: sub_10010AF0+49w
					; PR_RecordTraceEntries+147r
dword_10031554	dd ?			; DATA XREF: sub_10010AF0+C4w
					; PR_Trace+4Cr	...
dword_10031558	dd ?			; DATA XREF: sub_10010AF0+43w
					; sub_10010AF0+60r ...
; void *dword_1003155C
dword_1003155C	dd ?			; DATA XREF: sub_10010AF0+74w
					; PR_Trace+37r	...
dword_10031560	dd ?			; DATA XREF: sub_10010AF0+3Dw
					; sub_10010AF0:loc_10010BA8r
dword_10031564	dd ?			; DATA XREF: sub_10010BE0+52w
					; PR_Trace+FAr	...
dword_10031568	dd ?			; DATA XREF: sub_10010AF0+BEw
					; PR_Trace+2Cr	...
dword_1003156C	dd ?			; DATA XREF: sub_10010AF0+2Ew
					; PR_RecordTraceEntries+B3r ...
dword_10031570	dd ?			; DATA XREF: sub_10010BE0+10o
					; sub_10010BE0+1Aw ...
dword_10031574	dd ?			; DATA XREF: sub_10010BE0+1Fw
					; PR_CreateTrace+C1r ...
dword_10031578	dd ?			; DATA XREF: sub_10010AF0+38w
					; PR_Trace+CEr	...
; LPVOID dword_1003157C
dword_1003157C	dd ?			; DATA XREF: sub_10010BE0+6w
					; sub_10010BE0+57r ...
; LPVOID dword_10031580
dword_10031580	dd ?			; DATA XREF: sub_10010BE0+48w
					; PR_Trace+EFr	...
dword_10031584	dd ?			; DATA XREF: PR_SetTraceOption:loc_1001113Fr
					; sub_100113B0+36w ...
dword_10031588	dd ?			; DATA XREF: sub_10011460:loc_1001147Dr
					; sub_10011460+5Dw ...
dword_1003158C	dd ?			; DATA XREF: PR_Trace+6Dr
					; PR_GetTraceEntries+21r ...
dword_10031590	dd ?			; DATA XREF: PR_Trace:loc_10010F0Er
					; PR_Trace+75w	...
; void *dword_10031594
dword_10031594	dd ?			; DATA XREF: sub_10012000+11r
					; sub_10012000+48r ...
dword_10031598	dd ?			; DATA XREF: PR_Cleanup+3Fw
					; PR_SetThreadRecycleMode+4w ...
dword_1003159C	dd ?			; DATA XREF: sub_10017F60+97r
					; sub_10017F60+BCw ...
dword_100315A0	dd ?			; DATA XREF: _PR_GetPrimordialCPUr
					; sub_100181C0+62w
; DWORD_PTR dwThreadAffinityMask
dwThreadAffinityMask dd	?		; DATA XREF: PR_SetCPUAffinityMask+1Aw
					; sub_10017F60+79r
dword_100315A8	dd ?			; DATA XREF: PR_SuspendAll+1Ew
					; PR_ResumeAll+30Dw
; LPVOID dword_100315AC
dword_100315AC	dd ?			; DATA XREF: sub_1001A480+82r
					; PR_SuspendAll+33w ...
; PSID pOwner
pOwner		dd ?			; DATA XREF: sub_1001CE50+CAw
					; sub_1001CFA0r ...
; PSID pGroup
pGroup		dd ?			; DATA XREF: sub_1001CE50+108w
					; sub_1001CFA0:loc_1001CFB2r ...
; PSID pSid
pSid		dd ?			; DATA XREF: sub_1001CE50+11Ao
					; sub_1001CFA0:loc_1001CFC4r ...
		align 10h
; LPVOID dword_100315C0
dword_100315C0	dd ?			; DATA XREF: sub_1001DFF0+C4w
					; sub_1001DFF0+C9r ...
dword_100315C4	dd ?			; DATA XREF: sub_1001DFF0+F6w
dword_100315C8	dd ?			; DATA XREF: sub_1001DFF0+D8w
					; sub_10023780+6Ar ...
		align 10h
dword_100315D0	dd ?			; DATA XREF: sub_1001DFF0+9Fw
					; sub_10023780:loc_10023818r ...
dword_100315D4	dd ?			; DATA XREF: sub_1001DFF0+B9w
					; sub_10023780:loc_100237DFr ...
dword_100315D8	dd ?			; DATA XREF: sub_1001DFF0+A9w
					; sub_1001DFF0+B3r ...
dword_100315DC	dd ?			; DATA XREF: sub_10023D30+4Dr
					; sub_10023D30+5Bw ...
dword_100315E0	dd ?			; DATA XREF: sub_10023F70+54r
					; sub_10023F70+6Dr ...
; struct _RTL_CRITICAL_SECTION stru_100315E4
stru_100315E4	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_1001DFF0+4Co
					; sub_1001EA90+4o ...
; HANDLE ExistingCompletionPort
ExistingCompletionPort dd ?		; DATA XREF: sub_1001D3C0+11Br
					; sub_1001DF20+13r ...
dword_10031600	dd ?			; DATA XREF: sub_1001EA90+31r
					; sub_1001F620+28w
		dd 1FFh	dup(?)
dword_10031E00	dd ?			; DATA XREF: sub_1001EA90+70r
					; sub_1001F620+65w
		dd 1FFh	dup(?)
dword_10032600	dd ?			; DATA XREF: sub_1001EA90+15r
					; sub_1001EA90+1Er ...
dword_10032604	dd ?			; DATA XREF: sub_1001EA90+54r
					; sub_1001EA90+5Dr ...
dword_10032608	dd ?			; DATA XREF: sub_1001F110+106r
					; sub_1001F110+10Ew
dword_1003260C	dd ?			; DATA XREF: sub_1001F110+EDr
					; sub_1001F110+F8w
dword_10032610	dd ?			; DATA XREF: sub_10022490+79w
					; sub_10022490+18Bw ...
		dd 19h dup(?)
dword_10032678	dd ?			; DATA XREF: sub_10022490+16Fr
					; sub_10022490+17Cw ...
dword_1003267C	dd ?			; DATA XREF: sub_10022490+138r
					; sub_10022490+13Ew ...
		dd ?
dword_10032684	dd ?			; DATA XREF: sub_100190B0+37r
					; sub_100190B0+3Eo
		align 10h
TlsIndex	dd ?			; DATA XREF: PR_LogFlush+23r
					; PR_LogPrint+14Dr ...
dword_10032694	dd ?			; DATA XREF: sub_10026DD1+Fr
					; sub_10026DD1+17w ...
dword_10032698	dd ?			; DATA XREF: DllEntryPoint-20Fw
					; DllEntryPoint-60r
		align 10h
dword_100326A0	dd ?			; DATA XREF: sub_100271CA+91w
					; .rdata:ExceptionInfoo
dword_100326A4	dd ?			; DATA XREF: sub_100271CA+9Bw
		dd ?
dword_100326AC	dd ?			; DATA XREF: sub_100271CA+8Cw
		dd 10h dup(?)
dword_100326F0	dd ?			; DATA XREF: sub_100271CA+7Dw
					; .rdata:ExceptionInfoo
		dd 22h dup(?)
word_1003277C	dw ?			; DATA XREF: sub_100271CA+51w
		align 10h
word_10032780	dw ?			; DATA XREF: sub_100271CA+4Aw
		align 4
word_10032784	dw ?			; DATA XREF: sub_100271CA+43w
		align 4
word_10032788	dw ?			; DATA XREF: sub_100271CA+3Cw
		align 4
dword_1003278C	dd ?			; DATA XREF: sub_100271CA+28w
dword_10032790	dd ?			; DATA XREF: sub_100271CA+22w
dword_10032794	dd ?			; DATA XREF: sub_100271CA+1Cw
dword_10032798	dd ?			; DATA XREF: sub_100271CA+16w
dword_1003279C	dd ?			; DATA XREF: sub_100271CA+10w
dword_100327A0	dd ?			; DATA XREF: sub_100271CA+Bw
dword_100327A4	dd ?			; DATA XREF: sub_100271CA+62w
dword_100327A8	dd ?			; DATA XREF: sub_100271CA+6Aw
					; sub_100271CA+87r
word_100327AC	dw ?			; DATA XREF: sub_100271CA+35w
		align 10h
dword_100327B0	dd ?			; DATA XREF: sub_100271CA+59w
dword_100327B4	dd ?			; DATA XREF: sub_100271CA+72w
word_100327B8	dw ?			; DATA XREF: sub_100271CA+2Ew
		align 4
		dd 81h dup(?)
; struct _RTL_CRITICAL_SECTION stru_100329C0
stru_100329C0	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_1001D3C0+1Bo
					; sub_1001D3C0:loc_1001D495o ...
; DWORD	dword_100329D8
dword_100329D8	dd ?			; DATA XREF: sub_10017D10:loc_10017D49r
					; sub_10017D10:loc_10017D79r ...
; DWORD	dwTlsIndex
dwTlsIndex	dd ?			; DATA XREF: PR_LogFlush:loc_1000463Er
					; PR_LogFlush:loc_1000466Br ...
dword_100329E0	dd ?			; DATA XREF: sub_1001D3C0:loc_1001D3E6o
					; sub_1001D3C0+36r ...
dword_100329E4	dd ?			; DATA XREF: sub_10024420+26w
					; sub_100246E0+A6r ...
dword_100329E8	dd ?			; DATA XREF: sub_1001D3C0+Er
					; sub_1001D3C0:loc_1001D483r ...
; DWORD	dword_100329EC
dword_100329EC	dd ?			; DATA XREF: PR_LogFlush:loc_10004723r
					; PR_LogFlush:loc_10004751r ...
; DWORD	dword_100329F0
dword_100329F0	dd ?			; DATA XREF: sub_10018030+81r
					; .text:loc_10019C5Dr ...
dword_100329F4	dd ?			; DATA XREF: sub_1001DFF0+7Dw
					; sub_1001DFF0+90w ...
		align 10h
; struct _RTL_CRITICAL_SECTION stru_10032A00
stru_10032A00	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_10022490+42o
					; sub_100226A0:loc_100226E7o ...
; DWORD	dword_10032A18
dword_10032A18	dd ?			; DATA XREF: sub_1001F030+43r
					; sub_10024310:loc_1002440Cr ...
		align 10h
; struct _RTL_CRITICAL_SECTION stru_10032A20
stru_10032A20	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_1001DFF0+57o
dword_10032A38	dd ?			; DATA XREF: sub_10019A20+67r
					; sub_10019A20+9Cw ...
dword_10032A3C	dd ?			; DATA XREF: sub_10019A20+18r
					; sub_10019A20+46w ...
dword_10032A40	dd ?			; DATA XREF: sub_10019A20+7Bo
					; _PR_CreateThread:loc_1001AADFr ...
dword_10032A44	dd ?			; DATA XREF: sub_10019A20+82r
					; sub_10019A20+8Er ...
dword_10032A48	dd ?			; DATA XREF: .text:10019D21w
					; .text:10019D5Dw ...
		align 10h
dword_10032A50	dd ?			; DATA XREF: sub_10019A20+2Bo
					; _PR_CreateThread:loc_1001A984r ...
dword_10032A54	dd ?			; DATA XREF: sub_10019A20+32r
					; sub_10019A20+3Er ...
; void *dword_10032A58
dword_10032A58	dd ?			; DATA XREF: PR_Cleanup:loc_1000D410r
					; sub_100198E0:loc_10019913r ...
; void *dword_10032A5C
dword_10032A5C	dd ?			; DATA XREF: sub_100198E0:loc_1001992Br
					; sub_100198E0+5Dw ...
; void *dword_10032A60
dword_10032A60	dd ?			; DATA XREF: PR_Cleanup:loc_1000D3E8r
					; PR_Cleanup:loc_1000D449r ...
dword_10032A64	dd ?			; DATA XREF: .text:10019F6Cw
					; .text:10019FB5w ...
dword_10032A68	dd ?			; DATA XREF: PR_Cleanup+53r
					; PR_Cleanup+76r ...
dword_10032A6C	dd ?			; DATA XREF: sub_10019870+55w
; void *dword_10032A70
dword_10032A70	dd ?			; DATA XREF: sub_10019840+5w
					; sub_10019850r ...
dword_10032A74	dd ?			; DATA XREF: sub_10017D10+131o
					; sub_10017D10:loc_10017EB4o
dword_10032A78	dd ?			; DATA XREF: sub_10017C20+Dr
					; sub_10017C20+20r ...
dword_10032A7C	dd ?			; DATA XREF: sub_10017C20+3w
					; sub_10017D10+196r
dword_10032A80	dd ?			; DATA XREF: PR_ShowStatus+85w
; void *dword_10032A84
dword_10032A84	dd ?			; DATA XREF: PR_LockFile:loc_100146E7r
					; PR_LockFile+64r ...
; void *dword_10032A88
dword_10032A88	dd ?			; DATA XREF: PR_LockFile:loc_10014701r
					; PR_LockFile+95r ...
dword_10032A8C	dd ?			; DATA XREF: PR_Init_0+5Dw
dword_10032A90	dd ?			; DATA XREF: PR_Init_0+99w
					; PR_Cleanup+20r ...
dword_10032A94	dd ?			; DATA XREF: sub_10007470+D8r
					; sub_10007470+17Er ...
dword_10032A98	dd ?			; DATA XREF: PR_Init_0+4Ew
					; sub_100140A0+74r ...
; void *dword_10032A9C
dword_10032A9C	dd ?			; DATA XREF: PR_GetSpecialFD:loc_100149C2r
					; sub_10014A90+D8w ...
; void *dword_10032AA0
dword_10032AA0	dd ?			; DATA XREF: PR_Init_0+FEw
					; PR_Cleanup+150r ...
dword_10032AA4	dd ?			; DATA XREF: PR_Init_0+C1w
					; sub_1001CC90+4Ar ...
dword_10032AA8	dd ?			; DATA XREF: PR_Init_0+B7w
					; sub_10025F70+4Br ...
; void *dword_10032AAC
dword_10032AAC	dd ?			; DATA XREF: PR_GetSpecialFD:loc_100149C9r
					; sub_10014A90+9Cw ...
dword_10032AB0	dd ?			; DATA XREF: _PR_NativeCreateThread+74r
					; _PR_NativeCreateThread+7Ew ...
dword_10032AB4	dd ?			; DATA XREF: PR_Init_0+8Aw
					; PR_Sleep+14Fr ...
dword_10032AB8	dd ?			; DATA XREF: PR_Cleanup+4Ar
					; PR_Cleanup+6Dr ...
; void *dword_10032ABC
dword_10032ABC	dd ?			; DATA XREF: PR_GetSpecialFD:loc_100149D0r
					; sub_10014A90+63w ...
dword_10032AC0	dd ?			; DATA XREF: sub_10007F20+56r
					; sub_10008190+5Fr ...
		align 20h
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_10017F60:loc_10017FECo
					; sub_10017F60+B7o ...
; void *dword_10032AF8
dword_10032AF8	dd ?			; DATA XREF: PR_Cleanup+179r
					; sub_100198E0r ...
dword_10032AFC	dd ?			; DATA XREF: PR_Init_0+30w
					; sub_10018940+23r
dword_10032B00	dd ?			; DATA XREF: PR_Init_0+7Bw
					; sub_10018450+202r ...
dword_10032B04	dd ?			; DATA XREF: PR_Init_0+A8w
dword_10032B08	dd ?			; DATA XREF: PR_Cleanup+8Bw
					; sub_10019AE0+1Fw ...
dword_10032B0C	dd ?			; DATA XREF: sub_10008AD0+19w
					; sub_10008AD0+2Cw ...
dword_10032B10	dd ?			; DATA XREF: sub_10008AD0+14w
					; PR_GetPageShiftr ...
; void *dword_10032B14
dword_10032B14	dd ?			; DATA XREF: sub_100076F0+7w
					; sub_10007710r ...
		align 10h
; void *dword_10032B20
dword_10032B20	dd ?			; DATA XREF: .text:loc_10001430r
					; .text:10001487r ...
; void *dword_10032B24
dword_10032B24	dd ?			; DATA XREF: .text:1000144Cr
					; .text:100014C3r ...
; void *dword_10032B28
dword_10032B28	dd ?			; DATA XREF: .text:100014B0r
					; sub_10001580:loc_100015A6r ...
dword_10032B2C	dd ?			; DATA XREF: sub_100015F0+5Fw
dword_10032B30	dd ?			; DATA XREF: .text:loc_10001440o
					; .text:10001464r ...
dword_10032B34	dd ?			; DATA XREF: sub_100014E0+4Fr
					; sub_100015F0+52w
dword_10032B38	dd ?			; DATA XREF: sub_10026DD1:loc_10026E4Dr
					; sub_10026DD1+9Bw ...
; volatile LONG	Target
Target		dd ?			; DATA XREF: sub_10026DD1+24o
					; sub_10026DD1+53o
dword_10032B40	dd ?			; DATA XREF: sub_10026DAF+11w
					; sub_10026DD1+13Ar ...
; void *dword_10032B44
dword_10032B44	dd ?			; DATA XREF: sub_10026DAF+Cw
					; sub_10026DD1:loc_10026F01r ...
dword_10032B48	dd ?			; DATA XREF: DllEntryPoint:loc_10026F99r
					; DllEntryPoint-E6r ...
dword_10032B4C	dd ?			; DATA XREF: sub_10026DD1:loc_10026EABr
					; sub_10026DD1+E2o ...
dword_10032B50	dd ?			; DATA XREF: sub_100267E0+E6r
					; sub_100267E0+EFo ...
		align 800h
_data		ends

; Section 4. (virtual address 00033000)
; Virtual size			: 00000019 (	 25.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0002E800
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	para public 'DATA' use32
		assume cs:_tls
		;org 10033000h
TlsStart	dd 6 dup(0)		; DATA XREF: .rdata:TlsDirectoryo
TlsEnd		dd 7Ah dup(0)		; DATA XREF: .rdata:TlsEnd_ptro
		align 1000h
_tls		ends


		end DllEntryPoint
