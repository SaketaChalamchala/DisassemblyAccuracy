;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	F9EEBD27D4050E58B73BC5B5FF1B8F61
; Input	CRC32 :	E92A2BB0

; File Name   :	d:\pidgin-o\version.o
; Format      :	COFF (X386MAGIC)

		.686p
		.mmx
		.model flat
.intel_syntax noprefix

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	dword public 'CODE' use32
		assume cs:_text
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


		public _purple_version_check
_purple_version_check proc near		; DATA XREF: .debug_info:00000186o
					; .debug_info:000005CFo ...

var_10		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		mov	edx, [esp+1Ch+arg_8]
		mov	ecx, dword ptr ds:___stack_chk_guard
		mov	[esp+1Ch+var_10], ecx
		xor	ecx, ecx
		cmp	[esp+1Ch+arg_0], 2
		ja	short loc_44
		jnz	short loc_4C
		cmp	eax, 0Ah
		ja	short loc_54
		jnz	short loc_5C
		cmp	edx, 0Bh
		jbe	short loc_5C
		mov	eax, offset aLibpurpleVersi ; "libpurple version too old (micro	mismat"...

loc_31:					; CODE XREF: _purple_version_check+49j
					; _purple_version_check+51j ...
		mov	edx, [esp+1Ch+var_10]
		xor	edx, dword ptr ds:___stack_chk_guard
		jnz	short loc_60
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 4

loc_44:					; CODE XREF: _purple_version_check+1Cj
		mov	eax, offset aLibpurpleVer_0 ; "libpurple version too old (major	mismat"...
		jmp	short loc_31
; ---------------------------------------------------------------------------
		align 4

loc_4C:					; CODE XREF: _purple_version_check+1Ej
		mov	eax, offset aLibpurpleVer_1 ; "libpurple version too new (major	mismat"...
		jmp	short loc_31
; ---------------------------------------------------------------------------
		align 4

loc_54:					; CODE XREF: _purple_version_check+23j
		mov	eax, offset aLibpurpleVer_2 ; "libpurple version too old (minor	mismat"...
		jmp	short loc_31
; ---------------------------------------------------------------------------
		align 4

loc_5C:					; CODE XREF: _purple_version_check+25j
					; _purple_version_check+2Aj
		xor	eax, eax
		jmp	short loc_31
; ---------------------------------------------------------------------------

loc_60:					; CODE XREF: _purple_version_check+3Bj
		call	___stack_chk_fail
_purple_version_check endp

; ---------------------------------------------------------------------------
unk_65		db  90h	; ê		; DATA XREF: .debug_info:0000018Ao
					; .debug_info:000005D3o ...
		db  90h	; ê
unk_67		db  90h	; ê		; DATA XREF: .eh_frame:00000970o
_text		ends

; ===========================================================================

; Segment type:	Zero-length
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
_data		ends

; ===========================================================================

; Segment type:	Zero-length
; Segment permissions: Read/Write
_bss		segment	dword public 'BSS' use32
byte_6C		label byte		; DATA XREF: .debug_info:00000194o
					; .debug_info:00000331o
_bss		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 70h
aLibpurpleVer_0	db 'libpurple version too old (major mismatch)',0
					; DATA XREF: _purple_version_check:loc_44o
		align 4
aLibpurpleVer_1	db 'libpurple version too new (major mismatch)',0
					; DATA XREF: _purple_version_check:loc_4Co
		align 4
aLibpurpleVer_2	db 'libpurple version too old (minor mismatch)',0
					; DATA XREF: _purple_version_check:loc_54o
		align 4
aLibpurpleVersi	db 'libpurple version too old (micro mismatch)',0
					; DATA XREF: _purple_version_check+2Co
		align 10h
		public _purple_micro_version
_purple_micro_version db 0Bh,0		; DATA XREF: .debug_info:000006DFo
		align 4
		public _purple_minor_version
_purple_minor_version db 0Ah,0		; DATA XREF: .debug_info:000006BCo
		align 4
		public _purple_major_version
_purple_major_version dd 2		; DATA XREF: .debug_info:00000694o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_debug_info	segment	byte public 'DATA' use32
		assume cs:_debug_info
		;org 12Ch
off_12C		dd offset word_5CA	; DATA XREF: .debug_aranges:00000822o
		db 2, 0
		dd offset dword_6FC
		dw 104h
aGnuC4_7_2	db 'GNU C 4.7.2',0
		dd 72657601h, 6E6F6973h, 4300632Eh, 775C5C3Ah, 736B726Fh
		dd 65636170h, 69705C5Ch, 6E696764h, 7665642Dh, 5C5C6C65h
		dd 67646970h, 322D6E69h, 2E30312Eh, 5C5C3131h, 7062696Ch
		dd 6C707275h
		db 65h,	0
		dd offset _purple_version_check
		dd offset unk_65
		dd offset off_83C
		dw 402h
		dd offset byte_6C
		db    3
		db 1, 6, 63h
		db  68h	; h
		db 61h,	72h, 0
		db    3
		db 2, 7, 73h
aHortUnsignedIn	db 'hort unsigned int',0
		dw 403h
aUnsignedInt	db 7,'unsigned int',0
		dw 5F04h
aIobuf		db 'iobuf',0
		dw 220h
dword_1D0	dd 13181h, 705F0500h, 2007274h,	6683h, 230200h,	6E635F05h
		dd 84020074h, 131h, 5042302h, 7361625Fh, 85020065h, 66h
		dd 5082302h, 616C665Fh,	86020067h, 131h, 50C2302h, 6C69665Fh
		dd 87020065h, 131h, 5102302h, 6168635Fh, 66756272h, 31880200h
		dd 2000001h, 5F051423h,	73667562h, 2007A69h, 13189h, 18230200h
		dd 6D745F05h, 616E6670h, 200656Dh, 668Ah, 1C230200h, 5040300h
		dd 746E69h, 4C494606h, 8B020045h, 9Ah, 6C050803h, 20676E6Fh
		dd 676E6F6Ch, 746E6920h, 5040300h, 676E6F6Ch, 746E6920h
		dd 5020300h, 726F6873h,	6E692074h, 4030074h
aLongUnsignedIn	db 7,'long unsigned int',0
		db 3
		db    4
aSizetype	db 7,'sizetype',0
		db 3
		db    8
		db 4, 64h, 6Fh
aUble		db 'uble',0
		db 3, 0Ch, 4
aLongDouble	db 'long double',0
		db    3
		db 1, 6, 73h
aIgnedChar	db 'igned char',0
		db 3
		db    1
aUnsignedChar	db 8,'unsigned char',0
		db    3
aLongLongUnsign	db 8,7,'long long unsigned int',0
		dw 6706h
aUint		db 'uint',0
		db 3, 36h, 8Ah
		db    0
		db 2 dup(0), 3
		db    4
		db 4, 66h, 6Ch
		db  6Fh	; o
		db 61h,	74h, 0
		db    2
		db 4, 74h, 0
		db    0
		align 2
		dw 402h
		dd offset dword_1D0+34h
		db    7
		dd offset byte_6C
aVarenum	db 8,'VARENUM',0
		dw 504h
		db  73h	; s
		dd offset aWstr+1	; "STR"
aVt_empty	db 9,'VT_EMPTY',0
		align 10h
aVt_null	db 9,'VT_NULL',0
		db 1, 9, 56h
aT_i2		db 'T_I2',0
		db 2, 9, 56h
aT_i4		db 'T_I4',0
		db 3, 9, 56h
aT_r4		db 'T_R4',0
		db 4, 9, 56h
aT_r8		db 'T_R8',0
		db 5, 9, 56h
aT_cy		db 'T_CY',0
		db 6, 9, 56h
aT_date		db 'T_DATE',0
aVt_bstr	db 7,9,'VT_BSTR',0
aVt_dispatch	db 8,9,'VT_DISPATCH',0
aVt_error	db 9,9,'VT_ERROR',0
aVt_bool	db 0Ah
		db 9,'VT_BOOL',0
aVt_variant	db 0Bh,9,'VT_VARIANT',0
		db 0Ch,	9, 56h
aT_unknown	db 'T_UNKNOWN',0
aVt_decimal	db 0Dh,9,'VT_DECIMAL',0
		db 0Eh
aVt_i1		db 9,'VT_I1',0
		db 10h
aVt_ui1		db 9,'VT_UI1',0
		dd 54560911h, 3249555Fh, 56091200h, 49555F54h, 9130034h
		dd 495F5456h, 9140038h,	555F5456h, 15003849h, 5F545609h
		dd 544E49h, 54560916h, 4E49555Fh, 9170054h, 565F5456h
		dd 44494Fh, 54560918h, 4552485Fh, 544C5553h, 56091900h
		dd 54505F54h, 91A0052h,	535F5456h, 41454641h, 59415252h
		dd 56091B00h, 41435F54h, 59415252h, 56091C00h, 53555F54h
		dd 45445245h, 454E4946h, 91D0044h, 4C5F5456h, 52545350h
		dd 56091E00h, 504C5F54h
aWstr		db 'WSTR',0             ; DATA XREF: .debug_info:00000341o
		db 1Fh,	9, 56h
aT_record	db 'T_RECORD',0
aVt_int_ptr	db '$',9,'VT_INT_PTR',0
aVt_uint_ptr	db '%',9,'VT_UINT_PTR',0
aVt_filetime	db '&',9,'VT_FILETIME',0
		db '¿',0
aVt_blob	db 9,'VT_BLOB',0
		db '¡',0
aVt_stream	db 9,'VT_STREAM',0
		db '¬',0
aVt_storage	db 9,'VT_STORAGE',0
		db '√',0
aVt_streamed_ob	db 9,'VT_STREAMED_OBJECT',0
		db 'ƒ',0
aVt_stored_obje	db 9,'VT_STORED_OBJECT',0 ; DATA XREF: .debug_info:000005DCo
					; .debug_info:00000648o
		db '≈',0
aVt_blob_object	db 9,'VT_BLOB_OBJECT',0 ; DATA XREF: .debug_info:0000063Ao
		db '∆',0
aVt_cf		db 9,'VT_CF',0
		db '«',0
aVt_clsid	db 9,'VT_CLSID',0
		db '»',0
aVt_bstr_blob	db 9,'VT_BSTR_BLOB',0
		db 0FFh, 1Fh, 9
aVt_vector	db 'VT_VECTOR',0
aAVt_array	db 'Ä ',9,'VT_ARRAY',0
aA		db 'Ä¿',0
aVt_byref	db 9,'VT_BYREF',0
		db 80h
unk_56C		db  80h	; Ä		; DATA XREF: .debug_info:000006D8o
		db 1, 9, 56h
aT_reserved	db 'T_RESERVED',0
		db 80h
		db  80h	; Ä
		db 2, 9, 56h
aT_illegal	db 'T_ILLEGAL',0
		dw 0FFFFh
		db    3
aVt_illegalmask	db 9,'VT_ILLEGALMASKED',0
		db 0FFh
		db  1Fh
aVt_typemask	db 9,'VT_TYPEMASK',0
		dw 1FFFh
		db    0
		db 0Ah,	1, 70h
aUrple_version_	db 'urple_version_check',0 ; DATA XREF: .debug_info:00000630o
		db 1, 21h
word_5CA	dw 0FE01h		; DATA XREF: .debug_info:off_12Co
		db 1, 2	dup(0)
		dd offset _purple_version_check
		dd offset unk_65
		dd offset dword_7E4
		db 1
		dd offset aVt_stored_obje+0Dh ;	"JECT"
aRequired_major	db 0Bh,'required_major',0
		dd 1E22101h, 91020000h,	65720B00h, 72697571h, 6D5F6465h
		dd 726F6E69h, 0E2210100h, 2000001h, 720B0491h, 69757165h
		dd 5F646572h, 7263696Dh, 2101006Fh, 1E2h, 0C089102h
		dd offset unk_65
		dd offset aUrple_version_+3 ; "le_version_check"
		db    0
		db 0Dh,	38h, 1
		db    0
		align 2
		dd offset aVt_blob_object+4 ; "BLOB_OBJECT"
		dw 0Eh
		db  0Fh
a_iob		db '_iob',0
		dw 9A02h
		dd offset aVt_stored_obje+0Dh ;	"JECT"
		db    1
		db 1, 0Fh, 5Fh
a_mb_cur_max	db '_mb_cur_max',0
		db    4
		db 5Ch,	31h, 1
		db    0
		align 2
		dw 101h
		db  0Fh
a_pctype	db '_pctype',0
		db 4, 73h, 0F8h
		db    1
		db 2 dup(0), 1
		db    1
		db 10h,	70h, 75h
aRple_major_ver	db 'rple_major_version',0
		db 1
		dd 56C1Dh, 3050100h
		dd offset _purple_major_version
		db    7
		dd offset dword_1D0+12h
		db 10h,	70h, 75h
aRple_minor_ver	db 'rple_minor_version',0
		db 1
		dd 56C1Eh, 3050100h
		dd offset _purple_minor_version	; "\n"
		db  10h
aPurple_micro_v	db 'purple_micro_version',0
		dw 1F01h
		dd offset unk_56C
		db 1, 5, 3
		dd offset _purple_micro_version	; "\v"
		db 11h
		dd 735F5F01h, 6B636174h, 6B68635Fh, 6961665Fh, 101006Ch
		db 1, 0
		align 4
_debug_info	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_debug_abbrev	segment	byte public 'DATA' use32
		assume cs:_debug_abbrev
		;org 6FCh
dword_6FC	dd 25011101h, 30B1308h,	11081B08h, 10011201h, 2000006h
					; DATA XREF: .debug_info:00000132o
		dd 0B0B000Fh, 1349h, 0B002403h,	30B3E0Bh, 4000008h, 8030113h
		dd 0B3A0B0Bh, 13010B3Bh, 0D050000h, 3A080300h, 490B3B0Bh
		dd 0A3813h, 160600h, 0B3A0803h,	13490B3Bh, 26070000h, 134900h
		dd 1040800h, 0B0B0803h,	0B3B0B3Ah, 1301h, 3002809h, 0D1C08h
		dd 12E0A00h, 8030C3Fh, 0B3B0B3Ah, 13490C27h, 1120111h
		dd 42970640h, 13010Ch, 50B00h, 0B3A0803h, 13490B3Bh, 0A02h
		dd 182890Ch, 31011100h,	0D000013h, 13490101h, 1301h, 210Eh
		dd 340F00h, 0B3A0803h, 13490B3Bh, 0C3C0C3Fh, 34100000h
		dd 3A080300h, 490B3B0Bh, 20C3F13h, 1100000Ah, 0C3F002Eh
		dd 0C270803h, 0C3C0C34h
		db 3 dup(0)
		align 4
_debug_abbrev	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_debug_loc	segment	byte public 'DATA' use32
		assume cs:_debug_loc
		;org 7E4h
dword_7E4	dd 0			; DATA XREF: .debug_info:000005D7o
		dd 3, 4740002h,	3, 40h,	20740002h, 40h,	44h, 4740002h
		dd 44h,	65h, 20740002h,	2 dup(0)
_debug_loc	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_debug_aranges	segment	byte public 'DATA' use32
		assume cs:_debug_aranges
		;org 81Ch
		dd 1Ch
		db 2, 0
		dd offset off_12C
		dw 4
		dd 0
		dd offset _purple_version_check
		dd offset unk_65
		dd 2 dup(0)
_debug_aranges	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_debug_line	segment	byte public 'DATA' use32
		assume cs:_debug_line
		;org 83Ch
off_83C		dd offset aLibpurpleVersi+19h ;	DATA XREF: .debug_info:0000018Eo
					; " (micro mismatch)"
		db    2
		align 2
		dd offset aLibpurpleVer_2+1Ah ;	"(minor	mismatch)"
		dw 101h
		db 0FBh	; ˚
		db 0Eh,	0Dh, 0
		db    1
		db 3 dup(1)
		db    0
		db 2 dup(0), 1
		db    0
		align 2
		dw 6301h
aWorkspacePidgi	db ':/workspace/pidgin-devel/win32-dev/mingw-4.7.2/bin/../lib/gcc/min'
		db 'gw32/4.7.2/../../../../include',0
a____Win32DevGt	db '../../win32-dev/gtk_2_0-2.14/include/glib-2.0/glib',0
		align 4
aVersion_c	db 'version.c',0
		align 4
		dd 64747300h, 682E6F69h, 100h, 70797467h, 682E7365h, 200h
		dd 70797463h, 682E65h, 77000001h, 65707974h, 682E73h, 1
		db 0, 5, 2
		dd offset _purple_version_check
		db 3
		dd 0BBAC0121h, 5A3076h,	6010402h, 5A59062Eh, 2E087803h
		dd 4B858484h, 1000502h
		db 1
		align 10h
_debug_line	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_eh_frame	segment	dword public 'DATA' use32
		assume cs:_eh_frame
		;org 950h
		dd 14h,	0
		dd 527A01h, 1087C01h, 4040C1Bh,	188h, 18h, 1Ch
		dd offset unk_67-9D7h
		dd offset unk_65
		dd 200E4300h, 40E0A7Dh,	0B44h
_eh_frame	ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn ___stack_chk_guard:near ;	DATA XREF: _purple_version_check+Br
					; _purple_version_check+35r
		extrn ___stack_chk_fail:near ; CODE XREF: _purple_version_check:loc_60p


		end
